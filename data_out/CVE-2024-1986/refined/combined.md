=== Content from plugins.trac.wordpress.org_5baed812_20250110_141723.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fbrowser%2Fwoocommerce-jetpack%2Ftrunk%2Fincludes%2Fshortcodes%2Fclass-wcj-products-add-form-shortcodes.php)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Revision](/browser/woocommerce-jetpack/trunk/includes/shortcodes/class-wcj-products-add-form-shortcodes.php?rev=3046146 "Revision 3046146")
* Next Revision →
* [Blame](/browser/woocommerce-jetpack/trunk/includes/shortcodes/class-wcj-products-add-form-shortcodes.php?annotate=blame "Annotate each line with the last changed revision (this can be time consuming...)")
* [Revision Log](/log/woocommerce-jetpack/trunk/includes/shortcodes/class-wcj-products-add-form-shortcodes.php)

---

# [source:](/browser?order=name "Go to repository root") [woocommerce-jetpack](/browser/woocommerce-jetpack?order=name "View woocommerce-jetpack")/[trunk](/browser/woocommerce-jetpack/trunk?order=name "View trunk")/[includes](/browser/woocommerce-jetpack/trunk/includes?order=name "View includes")/[shortcodes](/browser/woocommerce-jetpack/trunk/includes/shortcodes?order=name "View shortcodes")/[class-wcj-products-add-form-shortcodes.php](/browser/woocommerce-jetpack/trunk/includes/shortcodes/class-wcj-products-add-form-shortcodes.php?order=name "View class-wcj-products-add-form-shortcodes.php")

View diff against:

View revision:

| [Last change](/changeset/3115290/woocommerce-jetpack/trunk/includes/shortcodes/class-wcj-products-add-form-shortcodes.php "View differences") on this file was [3115290](/changeset/3115290/ "View changeset 3115290"), checked in by ronyp, [6 months ago](/timeline?from=2024-07-10T06%3A28%3A56Z&precision=second "See timeline at 07/10/2024 06:28:56 AM") |
| --- |
| v7.1.2 |
| **File size:** 28.9 KB | |

| Line |  |
| --- | --- |
| [1](#L1) | <?php |
| [2](#L2) | /\*\* |
| [3](#L3) | \* Booster for WooCommerce - Shortcodes - Products Add Form |
| [4](#L4) | \* |
| [5](#L5) | \* @version 7.2.1 |
| [6](#L6) | \* @since   2.5.0 |
| [7](#L7) | \* @author  Pluggabl LLC. |
| [8](#L8) | \* @package Booster\_For\_WooCommerce/shortcodes |
| [9](#L9) | \*/ |
| [10](#L10) |  |
| [11](#L11) | if ( ! defined( 'ABSPATH' ) ) { |
| [12](#L12) | exit; |
| [13](#L13) | } |
| [14](#L14) |  |
| [15](#L15) | if ( ! class\_exists( 'WCJ\_Products\_Add\_Form\_Shortcodes' ) ) : |
| [16](#L16) | /\*\* |
| [17](#L17) | \* WCJ\_Products\_Add\_Form\_Shortcodes. |
| [18](#L18) | \*/ |
| [19](#L19) | class WCJ\_Products\_Add\_Form\_Shortcodes extends WCJ\_Shortcodes { |
| [20](#L20) |  |
| [21](#L21) | /\*\* |
| [22](#L22) | \* Constructor. |
| [23](#L23) | \* |
| [24](#L24) | \* @version 2.8.0 |
| [25](#L25) | \* @since   2.5.0 |
| [26](#L26) | \* @todo    refill image on not validated (or after successful addition); more messages options; more styling options; custom fields; |
| [27](#L27) | \* @todo    (maybe) `product\_id => ( isset( $\_GET['wcj\_edit\_product'] ) ? $\_GET['wcj\_edit\_product'] : 0 )` |
| [28](#L28) | \*/ |
| [29](#L29) | public function \_\_construct() { |
| [30](#L30) |  |
| [31](#L31) | $this->the\_shortcodes = array( |
| [32](#L32) | 'wcj\_product\_add\_new', |
| [33](#L33) | ); |
| [34](#L34) |  |
| [35](#L35) | $this->the\_atts = array( |
| [36](#L36) | 'product\_id'             => 0, |
| [37](#L37) | 'post\_status'            => wcj\_get\_option( 'wcj\_product\_by\_user\_status', 'draft' ), |
| [38](#L38) |  |
| [39](#L39) | 'desc\_enabled'           => wcj\_get\_option( 'wcj\_product\_by\_user\_desc\_enabled', 'no' ), |
| [40](#L40) | 'short\_desc\_enabled'     => wcj\_get\_option( 'wcj\_product\_by\_user\_short\_desc\_enabled', 'no' ), |
| [41](#L41) | 'regular\_price\_enabled'  => wcj\_get\_option( 'wcj\_product\_by\_user\_regular\_price\_enabled', 'no' ), |
| [42](#L42) | 'sale\_price\_enabled'     => wcj\_get\_option( 'wcj\_product\_by\_user\_sale\_price\_enabled', 'no' ), |
| [43](#L43) | 'external\_url\_enabled'   => wcj\_get\_option( 'wcj\_product\_by\_user\_external\_url\_enabled', 'no' ), |
| [44](#L44) | 'cats\_enabled'           => wcj\_get\_option( 'wcj\_product\_by\_user\_cats\_enabled', 'no' ), |
| [45](#L45) | 'tags\_enabled'           => wcj\_get\_option( 'wcj\_product\_by\_user\_tags\_enabled', 'no' ), |
| [46](#L46) | 'image\_enabled'          => apply\_filters( 'booster\_option', 'no', wcj\_get\_option( 'wcj\_product\_by\_user\_image\_enabled', 'no' ) ), |
| [47](#L47) |  |
| [48](#L48) | 'desc\_required'          => wcj\_get\_option( 'wcj\_product\_by\_user\_desc\_required', 'no' ), |
| [49](#L49) | 'short\_desc\_required'    => wcj\_get\_option( 'wcj\_product\_by\_user\_short\_desc\_required', 'no' ), |
| [50](#L50) | 'regular\_price\_required' => wcj\_get\_option( 'wcj\_product\_by\_user\_regular\_price\_required', 'no' ), |
| [51](#L51) | 'sale\_price\_required'    => wcj\_get\_option( 'wcj\_product\_by\_user\_sale\_price\_required', 'no' ), |
| [52](#L52) | 'external\_url\_required'  => wcj\_get\_option( 'wcj\_product\_by\_user\_external\_url\_required', 'no' ), |
| [53](#L53) | 'cats\_required'          => wcj\_get\_option( 'wcj\_product\_by\_user\_cats\_required', 'no' ), |
| [54](#L54) | 'tags\_required'          => wcj\_get\_option( 'wcj\_product\_by\_user\_tags\_required', 'no' ), |
| [55](#L55) | 'image\_required'         => apply\_filters( 'booster\_option', 'no', wcj\_get\_option( 'wcj\_product\_by\_user\_image\_required', 'no' ) ), |
| [56](#L56) |  |
| [57](#L57) | 'visibility'             => implode( ',', wcj\_get\_option( 'wcj\_product\_by\_user\_user\_visibility', array() ) ), |
| [58](#L58) | 'module'                 => 'product\_by\_user', |
| [59](#L59) | 'module\_name'            => \_\_( 'Product by User', 'woocommerce-jetpack' ), |
| [60](#L60) | ); |
| [61](#L61) |  |
| [62](#L62) | if ( 'external' !== wcj\_get\_option( 'wcj\_product\_by\_user\_product\_type', 'simple' ) ) { |
| [63](#L63) | $this->the\_atts['external\_url\_enabled']  = 'no'; |
| [64](#L64) | $this->the\_atts['external\_url\_required'] = 'no'; |
| [65](#L65) | } |
| [66](#L66) |  |
| [67](#L67) | $this->the\_atts['custom\_taxonomies\_total'] = apply\_filters( 'booster\_option', 1, wcj\_get\_option( 'wcj\_product\_by\_user\_custom\_taxonomies\_total', 1 ) ); |
| [68](#L68) | for ( $i = 1; $i <= $this->the\_atts['custom\_taxonomies\_total']; $i++ ) { |
| [69](#L69) | $this->the\_atts[ 'custom\_taxonomy\_' . $i . '\_enabled' ]  = wcj\_get\_option( 'wcj\_product\_by\_user\_custom\_taxonomy\_' . $i . '\_enabled', 'no' ); |
| [70](#L70) | $this->the\_atts[ 'custom\_taxonomy\_' . $i . '\_required' ] = wcj\_get\_option( 'wcj\_product\_by\_user\_custom\_taxonomy\_' . $i . '\_required', 'no' ); |
| [71](#L71) | $this->the\_atts[ 'custom\_taxonomy\_' . $i . '\_id' ]       = wcj\_get\_option( 'wcj\_product\_by\_user\_custom\_taxonomy\_' . $i . '\_id', '' ); |
| [72](#L72) | $this->the\_atts[ 'custom\_taxonomy\_' . $i . '\_title' ]    = wcj\_get\_option( 'wcj\_product\_by\_user\_custom\_taxonomy\_' . $i . '\_title', '' ); |
| [73](#L73) | } |
| [74](#L74) |  |
| [75](#L75) | parent::\_\_construct(); |
| [76](#L76) | } |
| [77](#L77) |  |
| [78](#L78) | /\*\* |
| [79](#L79) | \* Init\_atts. |
| [80](#L80) | \* |
| [81](#L81) | \* @version 7.2.1 |
| [82](#L82) | \* @param array $atts The user defined shortcode attributes. |
| [83](#L83) | \*/ |
| [84](#L84) | public function init\_atts( $atts ) { |
| [85](#L85) | $atts['product\_id']              = (int) wcj\_sanitize\_input\_attribute\_values( $atts['product\_id'] ); |
| [86](#L86) | $atts['post\_status']             = wcj\_sanitize\_input\_attribute\_values( $atts['post\_status'] ); |
| [87](#L87) | $atts['desc\_enabled']            = wcj\_sanitize\_input\_attribute\_values( $atts['desc\_enabled'] ); |
| [88](#L88) | $atts['short\_desc\_enabled']      = wcj\_sanitize\_input\_attribute\_values( $atts['short\_desc\_enabled'] ); |
| [89](#L89) | $atts['regular\_price\_enabled']   = wcj\_sanitize\_input\_attribute\_values( $atts['regular\_price\_enabled'] ); |
| [90](#L90) | $atts['sale\_price\_enabled']      = wcj\_sanitize\_input\_attribute\_values( $atts['sale\_price\_enabled'] ); |
| [91](#L91) | $atts['external\_url\_enabled']    = wcj\_sanitize\_input\_attribute\_values( $atts['external\_url\_enabled'] ); |
| [92](#L92) | $atts['cats\_enabled']            = wcj\_sanitize\_input\_attribute\_values( $atts['cats\_enabled'] ); |
| [93](#L93) | $atts['tags\_enabled']            = wcj\_sanitize\_input\_attribute\_values( $atts['tags\_enabled'] ); |
| [94](#L94) | $atts['image\_gallery\_enabled']   = wcj\_sanitize\_input\_attribute\_values( $atts['image\_gallery\_enabled'] ); |
| [95](#L95) | $atts['image\_enabled']           = wcj\_sanitize\_input\_attribute\_values( $atts['image\_enabled'] ); |
| [96](#L96) | $atts['desc\_required']           = wcj\_sanitize\_input\_attribute\_values( $atts['desc\_required'] ); |
| [97](#L97) | $atts['short\_desc\_required']     = wcj\_sanitize\_input\_attribute\_values( $atts['short\_desc\_required'] ); |
| [98](#L98) | $atts['regular\_price\_required']  = wcj\_sanitize\_input\_attribute\_values( $atts['regular\_price\_required'] ); |
| [99](#L99) | $atts['sale\_price\_required']     = wcj\_sanitize\_input\_attribute\_values( $atts['sale\_price\_required'] ); |
| [100](#L100) | $atts['external\_url\_required']   = wcj\_sanitize\_input\_attribute\_values( $atts['external\_url\_required'] ); |
| [101](#L101) | $atts['cats\_required']           = wcj\_sanitize\_input\_attribute\_values( $atts['cats\_required'] ); |
| [102](#L102) | $atts['tags\_required']           = wcj\_sanitize\_input\_attribute\_values( $atts['tags\_required'] ); |
| [103](#L103) | $atts['image\_required']          = wcj\_sanitize\_input\_attribute\_values( $atts['image\_required'] ); |
| [104](#L104) | $atts['image\_gallery\_required']  = wcj\_sanitize\_input\_attribute\_values( $atts['image\_gallery\_required'] ); |
| [105](#L105) | $atts['visibility']              = wcj\_sanitize\_input\_attribute\_values( $atts['visibility'], 'restrict\_quotes' ); |
| [106](#L106) | $atts['module']                  = wcj\_sanitize\_input\_attribute\_values( $atts['module'] ); |
| [107](#L107) | $atts['module\_name']             = wcj\_sanitize\_input\_attribute\_values( $atts['module\_name'] ); |
| [108](#L108) | $atts['custom\_taxonomies\_total'] = wcj\_sanitize\_input\_attribute\_values( $atts['custom\_taxonomies\_total'] ); |
| [109](#L109) | for ( $i = 1; $i <= $atts['custom\_taxonomies\_total']; $i++ ) { |
| [110](#L110) | $atts[ 'custom\_taxonomy\_' . $i . '\_enabled' ]  = wcj\_sanitize\_input\_attribute\_values( $atts[ 'custom\_taxonomy\_' . $i . '\_enabled' ] ); |
| [111](#L111) | $atts[ 'custom\_taxonomy\_' . $i . '\_required' ] = wcj\_sanitize\_input\_attribute\_values( $atts[ 'custom\_taxonomy\_' . $i . '\_required' ] ); |
| [112](#L112) | $atts[ 'custom\_taxonomy\_' . $i . '\_id' ]       = wcj\_sanitize\_input\_attribute\_values( $atts[ 'custom\_taxonomy\_' . $i . '\_id' ] ); |
| [113](#L113) | $atts[ 'custom\_taxonomy\_' . $i . '\_title' ]    = wcj\_sanitize\_input\_attribute\_values( $atts[ 'custom\_taxonomy\_' . $i . '\_title' ] ); |
| [114](#L114) | } |
| [115](#L115) | return $atts; |
| [116](#L116) | } |
| [117](#L117) |  |
| [118](#L118) | /\*\* |
| [119](#L119) | \* Wc\_add\_new\_product. |
| [120](#L120) | \* |
| [121](#L121) | \* @version 2.8.0 |
| [122](#L122) | \* @since   2.5.0 |
| [123](#L123) | \* @todo    image gallery: `<input type="file" multiple>` or separate `<input type="file">` for each file; `update\_post\_meta( $product\_id, '\_product\_image\_gallery', implode( ',', $attach\_ids ) );` |
| [124](#L124) | \* @param array $args The user defined shortcode args. |
| [125](#L125) | \* @param array $shortcode\_atts The user defined shortcode shortcode\_atts. |
| [126](#L126) | \*/ |
| [127](#L127) | public function wc\_add\_new\_product( $args, $shortcode\_atts ) { |
| [128](#L128) |  |
| [129](#L129) | $product\_post = array( |
| [130](#L130) | 'post\_title'   => $args['title'], |
| [131](#L131) | 'post\_content' => $args['desc'], |
| [132](#L132) | 'post\_excerpt' => $args['short\_desc'], |
| [133](#L133) | 'post\_type'    => 'product', |
| [134](#L134) | 'post\_status'  => 'draft', |
| [135](#L135) | ); |
| [136](#L136) |  |
| [137](#L137) | if ( 0 === $shortcode\_atts['product\_id'] ) { |
| [138](#L138) | $product\_id = wp\_insert\_post( $product\_post ); |
| [139](#L139) | } else { |
| [140](#L140) | $product\_id = $shortcode\_atts['product\_id']; |
| [141](#L141) | wp\_update\_post( array\_merge( array( 'ID' => $product\_id ), $product\_post ) ); |
| [142](#L142) | } |
| [143](#L143) |  |
| [144](#L144) | // Insert the post into the database. |
| [145](#L145) | if ( 0 !== $product\_id ) { |
| [146](#L146) |  |
| [147](#L147) | wp\_set\_object\_terms( $product\_id, wcj\_get\_option( 'wcj\_product\_by\_user\_product\_type', 'simple' ), 'product\_type' ); |
| [148](#L148) | wp\_set\_object\_terms( $product\_id, $args['cats'], 'product\_cat' ); |
| [149](#L149) | wp\_set\_object\_terms( $product\_id, $args['tags'], 'product\_tag' ); |
| [150](#L150) |  |
| [151](#L151) | for ( $i = 1; $i <= $this->the\_atts['custom\_taxonomies\_total']; $i++ ) { |
| [152](#L152) | if ( 'yes' === $this->the\_atts[ 'custom\_taxonomy\_' . $i . '\_enabled' ] && '' !== $this->the\_atts[ 'custom\_taxonomy\_' . $i . '\_id' ] ) { |
| [153](#L153) | wp\_set\_object\_terms( $product\_id, $args[ 'custom\_taxonomy\_' . $i ], $this->the\_atts[ 'custom\_taxonomy\_' . $i . '\_id' ] ); |
| [154](#L154) | } |
| [155](#L155) | } |
| [156](#L156) |  |
| [157](#L157) | update\_post\_meta( $product\_id, '\_regular\_price', $args['regular\_price'] ); |
| [158](#L158) | update\_post\_meta( $product\_id, '\_sale\_price', $args['sale\_price'] ); |
| [159](#L159) | if ( '' === $args['sale\_price'] ) { |
| [160](#L160) | update\_post\_meta( $product\_id, '\_price', $args['regular\_price'] ); |
| [161](#L161) | } else { |
| [162](#L162) | update\_post\_meta( $product\_id, '\_price', $args['sale\_price'] ); |
| [163](#L163) | } |
| [164](#L164) | update\_post\_meta( $product\_id, '\_visibility', 'visible' ); |
| [165](#L165) | update\_post\_meta( $product\_id, '\_stock\_status', 'instock' ); |
| [166](#L166) |  |
| [167](#L167) | if ( 'external' === wcj\_get\_option( 'wcj\_product\_by\_user\_product\_type', 'simple' ) ) { |
| [168](#L168) | update\_post\_meta( $product\_id, '\_product\_url', $args['external\_url'] ); |
| [169](#L169) | } |
| [170](#L170) |  |
| [171](#L171) | // Image. |
| [172](#L172) | if ( '' !== $args['image'] && '' !== $args['image']['tmp\_name'] ) { |
| [173](#L173) | $upload\_dir = wp\_upload\_dir(); |
| [174](#L174) | $filename   = $args['image']['name']; |
| [175](#L175) | $file       = ( wp\_mkdir\_p( $upload\_dir['path'] ) ) ? $upload\_dir['path'] : $upload\_dir['basedir']; |
| [176](#L176) | $file      .= '/' . $filename; |
| [177](#L177) |  |
| [178](#L178) | move\_uploaded\_file( $args['image']['tmp\_name'], $file ); |
| [179](#L179) |  |
| [180](#L180) | $wp\_filetype = wp\_check\_filetype( $filename, null ); |
| [181](#L181) | $attachment  = array( |
| [182](#L182) | 'post\_mime\_type' => $wp\_filetype['type'], |
| [183](#L183) | 'post\_title'     => sanitize\_file\_name( $filename ), |
| [184](#L184) | 'post\_content'   => '', |
| [185](#L185) | 'post\_status'    => 'inherit', |
| [186](#L186) | ); |
| [187](#L187) | $attach\_id   = wp\_insert\_attachment( $attachment, $file, $product\_id ); |
| [188](#L188) | require\_once ABSPATH . 'wp-admin/includes/image.php'; |
| [189](#L189) | $attach\_data = wp\_generate\_attachment\_metadata( $attach\_id, $file ); |
| [190](#L190) | wp\_update\_attachment\_metadata( $attach\_id, $attach\_data ); |
| [191](#L191) |  |
| [192](#L192) | set\_post\_thumbnail( $product\_id, $attach\_id ); |
| [193](#L193) | } |
| [194](#L194) |  |
| [195](#L195) | wp\_update\_post( |
| [196](#L196) | array( |
| [197](#L197) | 'ID'          => $product\_id, |
| [198](#L198) | 'post\_status' => $shortcode\_atts['post\_status'], |
| [199](#L199) | ) |
| [200](#L200) | ); |
| [201](#L201) | } |
| [202](#L202) |  |
| [203](#L203) | return $product\_id; |
| [204](#L204) | } |
| [205](#L205) |  |
| [206](#L206) | /\*\* |
| [207](#L207) | \* Validate\_args. |
| [208](#L208) | \* |
| [209](#L209) | \* @version 7.1.8 |
| [210](#L210) | \* @since   2.5.0 |
| [211](#L211) | \* @param array $args The user defined shortcode args. |
| [212](#L212) | \* @param array $shortcode\_atts The user defined shortcode shortcode\_atts. |
| [213](#L213) | \*/ |
| [214](#L214) | public function validate\_args( $args, $shortcode\_atts ) { |
| [215](#L215) | $errors = ''; |
| [216](#L216) | if ( '' === $args['title'] ) { |
| [217](#L217) | $errors .= '<li>' . \_\_( 'Title is required!', 'woocommerce-jetpack' ) . '</li>'; |
| [218](#L218) | } |
| [219](#L219) |  |
| [220](#L220) | if ( 'yes' === wcj\_get\_option( 'wcj\_product\_by\_user\_require\_unique\_title', 'no' ) && 0 === $shortcode\_atts['product\_id'] ) { |
| [221](#L221) | if ( ! function\_exists( 'post\_exists' ) ) { |
| [222](#L222) | require\_once ABSPATH . 'wp-admin/includes/post.php'; |
| [223](#L223) | } |
| [224](#L224) | if ( post\_exists( $args['title'] ) ) { |
| [225](#L225) | $errors .= '<li>' . \_\_( 'Product exists!', 'woocommerce-jetpack' ) . '</li>'; |
| [226](#L226) | } |
| [227](#L227) | } |
| [228](#L228) |  |
| [229](#L229) | $fields = array( |
| [230](#L230) | 'desc'          => \_\_( 'Description', 'woocommerce-jetpack' ), |
| [231](#L231) | 'short\_desc'    => \_\_( 'Short Description', 'woocommerce-jetpack' ), |
| [232](#L232) | 'image'         => \_\_( 'Image', 'woocommerce-jetpack' ), |
| [233](#L233) | 'regular\_price' => \_\_( 'Regular Price', 'woocommerce-jetpack' ), |
| [234](#L234) | 'sale\_price'    => \_\_( 'Sale Price', 'woocommerce-jetpack' ), |
| [235](#L235) | 'external\_url'  => \_\_( 'Product URL', 'woocommerce-jetpack' ), |
| [236](#L236) | 'cats'          => \_\_( 'Categories', 'woocommerce-jetpack' ), |
| [237](#L237) | 'tags'          => \_\_( 'Tags', 'woocommerce-jetpack' ), |
| [238](#L238) | ); |
| [239](#L239) | for ( $i = 1; $i <= $this->the\_atts['custom\_taxonomies\_total']; $i++ ) { |
| [240](#L240) | $fields[ 'custom\_taxonomy\_' . $i ] = $this->the\_atts[ 'custom\_taxonomy\_' . $i . '\_title' ]; |
| [241](#L241) | } |
| [242](#L242) | foreach ( $fields as $field\_id => $field\_desc ) { |
| [243](#L243) | if ( 'yes' === $shortcode\_atts[ $field\_id . '\_enabled' ] && 'yes' === $shortcode\_atts[ $field\_id . '\_required' ] ) { |
| [244](#L244) | $is\_missing = false; |
| [245](#L245) | if ( 'image' === $field\_id && ( '' === $args[ $field\_id ] || ! isset( $args[ $field\_id ]['tmp\_name'] ) || '' === $args[ $field\_id ]['tmp\_name'] ) ) { |
| [246](#L246) | $is\_missing = true; |
| [247](#L247) | } elseif ( empty( $args[ $field\_id ] ) ) { |
| [248](#L248) | $is\_missing = true; |
| [249](#L249) | } |
| [250](#L250) | if ( $is\_missing ) { |
| [251](#L251) | /\* translators: %s: translation added \*/ |
| [252](#L252) | $errors .= '<li>' . sprintf( \_\_( '%s is required!', 'woocommerce-jetpack' ), $field\_desc ) . '</li>'; |
| [253](#L253) | } |
| [254](#L254) | } |
| [255](#L255) | } |
| [256](#L256) |  |
| [257](#L257) | if ( $args['sale\_price'] > $args['regular\_price'] ) { |
| [258](#L258) | $errors .= '<li>' . \_\_( 'Sale price must be less than the regular price!', 'woocommerce-jetpack' ) . '</li>'; |
| [259](#L259) | } |
| [260](#L260) |  |
| [261](#L261) | $product\_image\_name = isset( $args['image']['name'] ) ? sanitize\_text\_field( wp\_unslash( $args['image']['name'] ) ) : ''; |
| [262](#L262) | $gallery\_images     = isset( $args['image\_gallery']['name'] ) ? array\_map( 'sanitize\_text\_field', wp\_unslash( $args['image\_gallery']['name'] ) ) : array(); |
| [263](#L263) |  |
| [264](#L264) | $allowed\_types = array( '.jpg', '.jpeg', '.png', '.webp', '.heic', '.heif', '.gif' ); // Allowed File types by WordPress https://wordpress.com/support/accepted-filetypes/. |
| [265](#L265) |  |
| [266](#L266) | // Verify and restrict Product Image. |
| [267](#L267) | if ( isset( $product\_image\_name ) && '' !== $product\_image\_name ) { |
| [268](#L268) | $file\_type = '.' . pathinfo( $product\_image\_name, PATHINFO\_EXTENSION ); |
| [269](#L269) | if ( ! in\_array( $file\_type, $allowed\_types, true ) ) { |
| [270](#L270) | $errors .= '<li>' . \_\_( 'Sorry, only JPG, JPEG, PNG, WEBP, HEIC, HEIF and GIF files are allowed', 'woocommerce-jetpack' ) . '</li>'; |
| [271](#L271) | } |
| [272](#L272) | } |
| [273](#L273) | // Verify and restrict Gallery Image. |
| [274](#L274) | if ( isset( $gallery\_images ) && ! empty( array\_filter( $gallery\_images ) ) ) { |
| [275](#L275) | $error\_encountered = false; // Flag variable to track if an error has been encountered. |
| [276](#L276) | foreach ( $gallery\_images as $gallery\_image\_name ) { |
| [277](#L277) | $gallery\_file\_type = '.' . pathinfo( $gallery\_image\_name, PATHINFO\_EXTENSION ); |
| [278](#L278) | if ( ! in\_array( $gallery\_file\_type, $allowed\_types, true ) ) { |
| [279](#L279) | if ( ! $error\_encountered && ! $errors ) { |
| [280](#L280) |  |
| [281](#L281) | $errors           .= '<li>' . \_\_( 'Sorry, only JPG, JPEG, PNG, WEBP, HEIC, HEIF and GIF files are allowed', 'woocommerce-jetpack' ) . '</li>'; |
| [282](#L282) | $error\_encountered = true; // Set the flag to true to indicate error has been encountered. |
| [283](#L283) | } |
| [284](#L284) | } |
| [285](#L285) | } |
| [286](#L286) | } |
| [287](#L287) | return ( '' === $errors ) ? true : $errors; |
| [288](#L288) | } |
| [289](#L289) |  |
| [290](#L290) | /\*\* |
| [291](#L291) | \* Maybe\_add\_taxonomy\_field. |
| [292](#L292) | \* |
| [293](#L293) | \* @version 2.8.0 |
| [294](#L294) | \* @since   2.8.0 |
| [295](#L295) | \* @param array        $atts The user defined shortcode atts. |
| [296](#L296) | \* @param array        $args The user defined shortcode args. |
| [297](#L297) | \* @param int | string $option\_id The user defined shortcode option\_id. |
| [298](#L298) | \* @param int | string $taxonomy\_id The user defined shortcode taxonomy\_id. |
| [299](#L299) | \* @param string       $title The user defined shortcode title. |
| [300](#L300) | \* @param string       $input\_style The user defined shortcode input\_style. |
| [301](#L301) | \* @param string       $required\_mark\_html\_template The user defined shortcode required\_mark\_html\_template. |
| [302](#L302) | \* @param array        $table\_data The user defined shortcode table\_data. |
| [303](#L303) | \*/ |
| [304](#L304) | public function maybe\_add\_taxonomy\_field( $atts, $args, $option\_id, $taxonomy\_id, $title, $input\_style, $required\_mark\_html\_template, $table\_data ) { |
| [305](#L305) | if ( 'yes' === $atts[ $option\_id . '\_enabled' ] ) { |
| [306](#L306) | $product\_taxonomies = get\_terms( $taxonomy\_id, 'orderby=name&hide\_empty=0' ); |
| [307](#L307) | if ( is\_wp\_error( $product\_taxonomies ) ) { |
| [308](#L308) | return $table\_data; |
| [309](#L309) | } |
| [310](#L310) | $required\_html                        = ( 'yes' === $atts[ $option\_id . '\_required' ] ) ? ' required' : ''; |
| [311](#L311) | $required\_mark\_html                   = ( 'yes' === $atts[ $option\_id . '\_required' ] ) ? $required\_mark\_html\_template : ''; |
| [312](#L312) | $current\_product\_taxonomies           = ( 0 !== $atts['product\_id'] ) ? get\_the\_terms( $atts['product\_id'], $taxonomy\_id ) : $args[ $option\_id ]; |
| [313](#L313) | $product\_taxonomies\_as\_select\_options = ''; |
| [314](#L314) | foreach ( $product\_taxonomies as $product\_taxonomy ) { |
| [315](#L315) | $selected = ''; |
| [316](#L316) | if ( ! empty( $current\_product\_taxonomies ) ) { |
| [317](#L317) | foreach ( $current\_product\_taxonomies as $current\_product\_taxonomy ) { |
| [318](#L318) | if ( is\_object( $current\_product\_taxonomy ) ) { |
| [319](#L319) | $current\_product\_taxonomy = $current\_product\_taxonomy->slug; |
| [320](#L320) | } |
| [321](#L321) | $selected .= selected( $current\_product\_taxonomy, $product\_taxonomy->slug, false ); |
| [322](#L322) | } |
| [323](#L323) | } |
| [324](#L324) | $product\_taxonomies\_as\_select\_options .= '<option value="' . $product\_taxonomy->slug . '" ' . $selected . '>' . $product\_taxonomy->name . '</option>'; |
| [325](#L325) | } |
| [326](#L326) | $table\_data[] = array( |
| [327](#L327) | '<label for="wcj\_add\_new\_product\_' . $option\_id . '">' . $title . $required\_mark\_html . '</label>', |
| [328](#L328) | '<select' . $required\_html . ' multiple style="' . $input\_style . '" id="wcj\_add\_new\_product\_' . $option\_id . '" name="wcj\_add\_new\_product\_' . $option\_id . '[]">' . |
| [329](#L329) | $product\_taxonomies\_as\_select\_options . |
| [330](#L330) | '</select>', |
| [331](#L331) | ); |
| [332](#L332) | } |
| [333](#L333) | return $table\_data; |
| [334](#L334) | } |
| [335](#L335) |  |
| [336](#L336) | /\*\* |
| [337](#L337) | \* Wcj\_product\_add\_new. |
| [338](#L338) | \* |
| [339](#L339) | \* @version 7.1.3 |
| [340](#L340) | \* @since   2.5.0 |
| [341](#L341) | \* @todo    `multipart` only if image |
| [342](#L342) | \* @param array $atts The user defined shortcode atts. |
| [343](#L343) | \*/ |
| [344](#L344) | public function wcj\_product\_add\_new( $atts ) { |
| [345](#L345) | // Allowed User-roles. |
| [346](#L346) | $allowed\_user\_roles = array( 'administrator', 'shop\_manager', 'customer' ); |
| [347](#L347) |  |
| [348](#L348) | if ( function\_exists( 'wcj\_get\_current\_user\_all\_roles' ) ) { |
| [349](#L349) | // Current user role. |
| [350](#L350) | $current\_user\_role = wcj\_get\_current\_user\_all\_roles(); |
| [351](#L351) |  |
| [352](#L352) | if ( isset( $current\_user\_role ) && ! empty( $current\_user\_role ) ) { |
| [353](#L353) | // Initialize a result array. |
| [354](#L354) | $authorized\_user = array(); |
| [355](#L355) |  |
| [356](#L356) | // Loop through the values to check. |
| [357](#L357) | foreach ( $current\_user\_role as $user\_role ) { |
| [358](#L358) | if ( in\_array( $user\_role, $allowed\_user\_roles, true ) ) { |
| [359](#L359) | // Value exists in the array. |
| [360](#L360) | $authorized\_user[] = $user\_role; |
| [361](#L361) | } |
| [362](#L362) | } |
| [363](#L363) |  |
| [364](#L364) | // Check the result. |
| [365](#L365) | if ( empty( $authorized\_user ) ) { |
| [366](#L366) | return false; |
| [367](#L367) | } |
| [368](#L368) | } else { |
| [369](#L369) | return false; // Executes if $current\_user\_role is empty. |
| [370](#L370) | } |
| [371](#L371) | } else { |
| [372](#L372) | return false; |
| [373](#L373) | } |
| [374](#L374) |  |
| [375](#L375) | $wpnonce           = isset( $\_REQUEST['wcj\_add\_new\_product-nonce'] ) ? wp\_verify\_nonce( sanitize\_key( $\_REQUEST['wcj\_add\_new\_product-nonce'] ), 'wcj\_add\_new\_product' ) : false; |
| [376](#L376) | $header\_html       = ''; |
| [377](#L377) | $notice\_html       = ''; |
| [378](#L378) | $input\_fields\_html = ''; |
| [379](#L379) | $footer\_html       = ''; |
| [380](#L380) |  |
| [381](#L381) | $args = array( |
| [382](#L382) | 'title'         => ( isset( $\_REQUEST['wcj\_add\_new\_product\_title'] ) ) ? sanitize\_text\_field( wp\_unslash( $\_REQUEST['wcj\_add\_new\_product\_title'] ) ) : '', |
| [383](#L383) | 'desc'          => isset( $\_REQUEST['wcj\_add\_new\_product\_desc'] ) ? sanitize\_text\_field( wp\_unslash( $\_REQUEST['wcj\_add\_new\_product\_desc'] ) ) : '', |
| [384](#L384) | 'short\_desc'    => isset( $\_REQUEST['wcj\_add\_new\_product\_short\_desc'] ) ? sanitize\_text\_field( wp\_unslash( $\_REQUEST['wcj\_add\_new\_product\_short\_desc'] ) ) : '', |
| [385](#L385) | 'regular\_price' => isset( $\_REQUEST['wcj\_add\_new\_product\_regular\_price'] ) ? sanitize\_text\_field( wp\_unslash( $\_REQUEST['wcj\_add\_new\_product\_regular\_price'] ) ) : '', |
| [386](#L386) | 'sale\_price'    => isset( $\_REQUEST['wcj\_add\_new\_product\_sale\_price'] ) ? sanitize\_text\_field( wp\_unslash( $\_REQUEST['wcj\_add\_new\_product\_sale\_price'] ) ) : '', |
| [387](#L387) | 'external\_url'  => isset( $\_REQUEST['wcj\_add\_new\_product\_external\_url'] ) ? sanitize\_text\_field( wp\_unslash( $\_REQUEST['wcj\_add\_new\_product\_external\_url'] ) ) : '', |
| [388](#L388) | 'cats'          => isset( $\_REQUEST['wcj\_add\_new\_product\_cats'] ) ? array\_map( 'sanitize\_text\_field', wp\_unslash( $\_REQUEST['wcj\_add\_new\_product\_cats'] ) ) : array(), |
| [389](#L389) | 'tags'          => isset( $\_REQUEST['wcj\_add\_new\_product\_tags'] ) ? sanitize\_text\_field( wp\_unslash( $\_REQUEST['wcj\_add\_new\_product\_tags'] ) ) : array(), |
| [390](#L390) | 'image'         => isset( $\_FILES['wcj\_add\_new\_product\_image'] ) ? sanitize\_text\_field( wp\_unslash( $\_FILES['wcj\_add\_new\_product\_image'] ) ) : '', |
| [391](#L391) | ); |
| [392](#L392) | for ( $i = 1; $i <= $this->the\_atts['custom\_taxonomies\_total']; $i++ ) { |
| [393](#L393) | $param\_id                        = 'wcj\_add\_new\_product\_custom\_taxonomy\_' . $i; |
| [394](#L394) | $args[ 'custom\_taxonomy\_' . $i ] = isset( $\_REQUEST[ $param\_id ] ) ? sanitize\_text\_field( wp\_unslash( $\_REQUEST[ $param\_id ] ) ) : array(); |
| [395](#L395) | } |
| [396](#L396) |  |
| [397](#L397) | if ( $wpnonce && isset( $\_REQUEST['wcj\_add\_new\_product'] ) ) { |
| [398](#L398) | $validate\_args = $this->validate\_args( $args, $atts ); |
| [399](#L399) | if ( true === ( $validate\_args ) ) { |
| [400](#L400) | $result = $this->wc\_add\_new\_product( $args, $atts ); |
| [401](#L401) | if ( 0 === $result ) { |
| [402](#L402) | // Error. |
| [403](#L403) | $notice\_html .= '<div class="woocommerce"><ul class="woocommerce-error"><li>' . \_\_( 'Error!', 'woocommerce-jetpack' ) . '</li></ul></div>'; |
| [404](#L404) | } else { |
| [405](#L405) | // Success. |
| [406](#L406) | if ( 0 === $atts['product\_id'] ) { |
| [407](#L407) | $notice\_html .= '<div class="woocommerce"><div class="woocommerce-message">' . |
| [408](#L408) | str\_replace( |
| [409](#L409) | '%product\_title%', |
| [410](#L410) | $args['title'], |
| [411](#L411) | get\_option( 'wcj\_product\_by\_user\_message\_product\_successfully\_added', \_\_( '"%product\_title%" successfully added!', 'woocommerce-jetpack' ) ) |
| [412](#L412) | ) . |
| [413](#L413) | '</div></div>'; |
| [414](#L414) | } else { |
| [415](#L415) | $notice\_html .= '<div class="woocommerce"><div class="woocommerce-message">' . |
| [416](#L416) | str\_replace( |
| [417](#L417) | '%product\_title%', |
| [418](#L418) | $args['title'], |
| [419](#L419) | get\_option( 'wcj\_product\_by\_user\_message\_product\_successfully\_edited', \_\_( '"%product\_title%" successfully edited!', 'woocommerce-jetpack' ) ) |
| [420](#L420) | ) . |
| [421](#L421) | '</div></div>'; |
| [422](#L422) | } |
| [423](#L423) | } |
| [424](#L424) | } else { |
| [425](#L425) | $notice\_html .= '<div class="woocommerce"><ul class="woocommerce-error">' . $validate\_args . '</ul></div>'; |
| [426](#L426) | } |
| [427](#L427) | } |
| [428](#L428) |  |
| [429](#L429) | if ( isset( $\_GET['wcj\_edit\_product\_image\_delete'] ) ) { |
| [430](#L430) | $product\_id     = sanitize\_text\_field( wp\_unslash( $\_GET['wcj\_edit\_product\_image\_delete'] ) ); |
| [431](#L431) | $post\_author\_id = get\_post\_field( 'post\_author', $product\_id ); |
| [432](#L432) | $user\_ID        = get\_current\_user\_id(); |
| [433](#L433) | if ( $user\_ID !== $post\_author\_id ) { |
| [434](#L434) | echo '<p>' . wp\_kses\_post( 'Wrong user ID!', 'woocommerce-jetpack' ) . '</p>'; |
| [435](#L435) | } else { |
| [436](#L436) | $image\_id = get\_post\_thumbnail\_id( $product\_id ); |
| [437](#L437) | wp\_delete\_post( $image\_id, true ); |
| [438](#L438) | } |
| [439](#L439) | } |
| [440](#L440) |  |
| [441](#L441) | if ( 0 !== $atts['product\_id'] ) { |
| [442](#L442) | $this->the\_product = wc\_get\_product( $atts['product\_id'] ); |
| [443](#L443) | } |
| [444](#L444) |  |
| [445](#L445) | $header\_html .= '<h3>'; |
| [446](#L446) | $header\_html .= ( 0 === $atts['product\_id'] ) ? \_\_( 'Add New Product', 'woocommerce-jetpack' ) : \_\_( 'Edit Product', 'woocommerce-jetpack' ); |
| [447](#L447) | $header\_html .= '</h3>'; |
| [448](#L448) | $header\_html .= '<form method="post" action="' . esc\_url( remove\_query\_arg( array( 'wcj\_edit\_product\_image\_delete', 'wcj\_delete\_product' ) ) ) . |
| [449](#L449) | '" enctype="multipart/form-data">'; |
| [450](#L450) |  |
| [451](#L451) | $required\_mark\_html\_template = '&nbsp;<abbr class="required" title="' . \_\_( 'required', 'woocommerce-jetpack' ) . '">\*</abbr>'; |
| [452](#L452) |  |
| [453](#L453) | $price\_step = sprintf( '%f', ( 1 / pow( 10, wcj\_get\_option( 'wcj\_product\_by\_user\_price\_step', wcj\_get\_option( 'woocommerce\_price\_num\_decimals', 2 ) ) ) ) ); |
| [454](#L454) |  |
| [455](#L455) | $table\_data   = array(); |
| [456](#L456) | $input\_style  = 'width:100%;'; |
| [457](#L457) | $table\_data[] = array( |
| [458](#L458) | '<label for="wcj\_add\_new\_product\_title">' . \_\_( 'Title', 'woocommerce-jetpack' ) . $required\_mark\_html\_template . '</label>', |
| [459](#L459) | '<input required type="text" style="' . $input\_style . '" id="wcj\_add\_new\_product\_title" name="wcj\_add\_new\_product\_title" value="' . ( ( 0 !== $atts['product\_id'] ) ? |
| [460](#L460) | $this->the\_product->get\_title() : $args['title'] ) . '">', |
| [461](#L461) | ); |
| [462](#L462) | if ( 'yes' === $atts['desc\_enabled'] ) { |
| [463](#L463) | $required\_html      = ( 'yes' === $atts['desc\_required'] ) ? ' required' : ''; |
| [464](#L464) | $required\_mark\_html = ( 'yes' === $atts['desc\_required'] ) ? $required\_mark\_html\_template : ''; |
| [465](#L465) | $table\_data[]       = array( |
| [466](#L466) | '<label for="wcj\_add\_new\_product\_desc">' . \_\_( 'Description', 'woocommerce-jetpack' ) . $required\_mark\_html . '</label>', |
| [467](#L467) | '<textarea' . $required\_html . ' style="' . $input\_style . '" id="wcj\_add\_new\_product\_desc" name="wcj\_add\_new\_product\_desc">' . ( ( 0 !== $atts['product\_id'] ) ? |
| [468](#L468) | get\_post\_field( 'post\_content', $atts['product\_id'] ) : $args['desc'] ) . '</textarea>', |
| [469](#L469) | ); |
| [470](#L470) | } |
| [471](#L471) | if ( 'yes' === $atts['short\_desc\_enabled'] ) { |
| [472](#L472) | $required\_html      = ( 'yes' === $atts['short\_desc\_required'] ) ? ' required' : ''; |
| [473](#L473) | $required\_mark\_html = ( 'yes' === $atts['short\_desc\_required'] ) ? $required\_mark\_html\_template : ''; |
| [474](#L474) | $table\_data[]       = array( |
| [475](#L475) | '<label for="wcj\_add\_new\_product\_short\_desc">' . \_\_( 'Short Description', 'woocommerce-jetpack' ) . $required\_mark\_html . '</label>', |
| [476](#L476) | '<textarea' . $required\_html . ' style="' . $input\_style . '" id="wcj\_add\_new\_product\_short\_desc" name="wcj\_add\_new\_product\_short\_desc">' . |
| [477](#L477) | ( ( 0 !== $atts['product\_id'] ) ? get\_post\_field( 'post\_excerpt', $atts['product\_id'] ) : $args['short\_desc'] ) . '</textarea>', |
| [478](#L478) | ); |
| [479](#L479) | } |
| [480](#L480) | if ( 'yes' === $atts['image\_enabled'] ) { |
| [481](#L481) | $required\_html      = ( 'yes' === $atts['image\_required'] ) ? ' required' : ''; |
| [482](#L482) | $required\_mark\_html = ( 'yes' === $atts['image\_required'] ) ? $required\_mark\_html\_template : ''; |
| [483](#L483) | $new\_image\_field    = '<input' . $required\_html . ' type="file" id="wcj\_add\_new\_product\_image" name="wcj\_add\_new\_product\_image" accept="image/\*">'; |
| [484](#L484) | if ( 0 !== $atts['product\_id'] ) { |
| [485](#L485) | $the\_field = ( '' === get\_post\_thumbnail\_id( $atts['product\_id'] ) ) ? |
| [486](#L486) | $new\_image\_field : |
| [487](#L487) | '<a href="' . esc\_url( add\_query\_arg( 'wcj\_edit\_product\_image\_delete', $atts['product\_id'] ) ) . '" onclick="return confirm(\'' . |
| [488](#L488) | \_\_( 'Are you sure?', 'woocommerce-jetpack' ) . '\')">' . \_\_( 'Delete', 'woocommerce-jetpack' ) . '</a><br>' . |
| [489](#L489) | get\_the\_post\_thumbnail( $atts['product\_id'], array( 50, 50 ), array( 'class' => 'alignleft' ) ); |
| [490](#L490) | } else { |
| [491](#L491) | $the\_field = $new\_image\_field; |
| [492](#L492) | } |
| [493](#L493) | $table\_data[] = array( |
| [494](#L494) | '<label for="wcj\_add\_new\_product\_image">' . \_\_( 'Image', 'woocommerce-jetpack' ) . $required\_mark\_html . '</label>', |
| [495](#L495) | $the\_field, |
| [496](#L496) | ); |
| [497](#L497) | } |
| [498](#L498) | if ( 'yes' === $atts['regular\_price\_enabled'] ) { |
| [499](#L499) | $required\_html      = ( 'yes' === $atts['regular\_price\_required'] ) ? ' required' : ''; |
| [500](#L500) | $required\_mark\_html = ( 'yes' === $atts['regular\_price\_required'] ) ? $required\_mark\_html\_template : ''; |
| [501](#L501) | $table\_data[]       = array( |
| [502](#L502) | '<label for="wcj\_add\_new\_product\_regular\_price">' . \_\_( 'Regular Price', 'woocommerce-jetpack' ) . $required\_mark\_html . '</label>', |
| [503](#L503) | '<input' . $required\_html . ' type="number" min="0" step="' . $price\_step . '" id="wcj\_add\_new\_product\_regular\_price" name="wcj\_add\_new\_product\_regular\_price" value="' . |
| [504](#L504) | ( ( 0 !== $atts['product\_id'] ) ? get\_post\_meta( $atts['product\_id'], '\_regular\_price', true ) : $args['regular\_price'] ) . '">', |
| [505](#L505) | ); |
| [506](#L506) | } |
| [507](#L507) | if ( 'yes' === $atts['sale\_price\_enabled'] ) { |
| [508](#L508) | $required\_html      = ( 'yes' === $atts['sale\_price\_required'] ) ? ' required' : ''; |
| [509](#L509) | $required\_mark\_html = ( 'yes' === $atts['sale\_price\_required'] ) ? $required\_mark\_html\_template : ''; |
| [510](#L510) | $table\_data[]       = array( |
| [511](#L511) | '<label for="wcj\_add\_new\_product\_sale\_price">' . \_\_( 'Sale Price', 'woocommerce-jetpack' ) . $required\_mark\_html . '</label>', |
| [512](#L512) | '<input' . $required\_html . ' type="number" min="0" step="' . $price\_step . '" id="wcj\_add\_new\_product\_sale\_price" name="wcj\_add\_new\_product\_sale\_price" value="' . |
| [513](#L513) | ( ( 0 !== $atts['product\_id'] ) ? get\_post\_meta( $atts['product\_id'], '\_sale\_price', true ) : $args['sale\_price'] ) . '">', |
| [514](#L514) | ); |
| [515](#L515) | } |
| [516](#L516) | if ( 'yes' === $atts['external\_url\_enabled'] ) { |
| [517](#L517) | $required\_html      = ( 'yes' === $atts['external\_url\_required'] ) ? ' required' : ''; |
| [518](#L518) | $required\_mark\_html = ( 'yes' === $atts['external\_url\_required'] ) ? $required\_mark\_html\_template : ''; |
| [519](#L519) | $table\_data[]       = array( |
| [520](#L520) | '<label for="wcj\_add\_new\_product\_external\_url">' . \_\_( 'Product URL', 'woocommerce-jetpack' ) . $required\_mark\_html\_template . '</label>', |
| [521](#L521) | '<input' . $required\_html . ' style="' . $input\_style . '" type="url" id="wcj\_add\_new\_product\_external\_url" name="wcj\_add\_new\_product\_external\_url" value="' . |
| [522](#L522) | ( ( 0 !== $atts['product\_id'] ) ? get\_post\_meta( $atts['product\_id'], '\_product\_url', true ) : $args['external\_url'] ) . '">', |
| [523](#L523) | ); |
| [524](#L524) | } |
| [525](#L525) | $table\_data = $this->maybe\_add\_taxonomy\_field( |
| [526](#L526) | $atts, |
| [527](#L527) | $args, |
| [528](#L528) | 'cats', |
| [529](#L529) | 'product\_cat', |
| [530](#L530) | \_\_( 'Categories', 'woocommerce-jetpack' ), |
| [531](#L531) | $input\_style, |
| [532](#L532) | $required\_mark\_html\_template, |
| [533](#L533) | $table\_data |
| [534](#L534) | ); |
| [535](#L535) | $table\_data = $this->maybe\_add\_taxonomy\_field( |
| [536](#L536) | $atts, |
| [537](#L537) | $args, |
| [538](#L538) | 'tags', |
| [539](#L539) | 'product\_tag', |
| [540](#L540) | \_\_( 'Tags', 'woocommerce-jetpack' ), |
| [541](#L541) | $input\_style, |
| [542](#L542) | $required\_mark\_html\_template, |
| [543](#L543) | $table\_data |
| [544](#L544) | ); |
| [545](#L545) | for ( $i = 1; $i <= $this->the\_atts['custom\_taxonomies\_total']; $i++ ) { |
| [546](#L546) | $table\_data = $this->maybe\_add\_taxonomy\_field( |
| [547](#L547) | $atts, |
| [548](#L548) | $args, |
| [549](#L549) | 'custom\_taxonomy\_' . $i, |
| [550](#L550) | $atts[ 'custom\_taxonomy\_' . $i . '\_id' ], |
| [551](#L551) | $atts[ 'custom\_taxonomy\_' . $i . '\_title' ], |
| [552](#L552) | $input\_style, |
| [553](#L553) | $required\_mark\_html\_template, |
| [554](#L554) | $table\_data |
| [555](#L555) | ); |
| [556](#L556) | } |
| [557](#L557) |  |
| [558](#L558) | $input\_fields\_html .= wcj\_get\_table\_html( |
| [559](#L559) | $table\_data, |
| [560](#L560) | array( |
| [561](#L561) | 'table\_class'        => 'widefat', |
| [562](#L562) | 'table\_heading\_type' => 'vertical', |
| [563](#L563) | ) |
| [564](#L564) | ); |
| [565](#L565) |  |
| [566](#L566) | $footer\_html .= '<input type="submit" class="button" name="wcj\_add\_new\_product" value="' . ( ( 0 === $atts['product\_id'] ) ? |
| [567](#L567) | \_\_( 'Add', 'woocommerce-jetpack' ) : \_\_( 'Edit', 'woocommerce-jetpack' ) ) . '">'; |
| [568](#L568) | $footer\_html .= wp\_nonce\_field( 'wcj\_add\_new\_product', 'wcj\_add\_new\_product-nonce', true, false ); |
| [569](#L569) | $footer\_html .= '</form>'; |
| [570](#L570) |  |
| [571](#L571) | return $notice\_html . $header\_html . $input\_fields\_html . $footer\_html; |
| [572](#L572) | } |
| [573](#L573) |  |
| [574](#L574) | } |
| [575](#L575) |  |
| [576](#L576) | endif; |
| [577](#L577) |  |
| [578](#L578) | return new WCJ\_Products\_Add\_Form\_Shortcodes(); |

**Note:** See [TracBrowser](/wiki/TracBrowser)
for help on using the repository browser.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Plain Text](/browser/woocommerce-jetpack/trunk/includes/shortcodes/class-wcj-products-add-form-shortcodes.php?format=txt)
* [Original Format](/export/3220264/woocommerce-jetpack/trunk/includes/shortcodes/class-wcj-products-add-form-shortcodes.php)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)



=== Content from wordpress.org_76e1f0fc_20250110_141726.html ===


[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Showcase](https://wordpress.org/showcase/)
* [Hosting](https://wordpress.org/hosting/)
* Extend
  + [Themes](https://wordpress.org/themes/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Blocks](https://wordpress.org/blocks/)
  + [Openverse ↗︎](https://openverse.org/)
* Learn
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* Community
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [Events](https://events.wordpress.org/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* About
  + [About WordPress](https://wordpress.org/about/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
* [Get WordPress](https://wordpress.org/download/)

Search in WordPress.org

[Get WordPress](https://wordpress.org/download/)

[WordPress.org](https://wordpress.org/)

[Plugin Directory](https://wordpress.org/plugins/)

Booster for WooCommerce

* [Submit a plugin](https://wordpress.org/plugins/developers/)
* [My favorites](https://wordpress.org/plugins/browse/favorites/)
* [Log in](https://login.wordpress.org/?redirect_to=https%3A%2F%2Fwordpress.org%2Fplugins%2Fwoocommerce-jetpack&locale=en_US)

* [Submit a plugin](https://wordpress.org/plugins/developers/)
* [My favorites](https://wordpress.org/plugins/browse/favorites/)
* [Log in](https://login.wordpress.org/?redirect_to=https%3A%2F%2Fwordpress.org%2Fplugins%2Fwoocommerce-jetpack&locale=en_US)

Search plugins

![](https://ps.w.org/woocommerce-jetpack/assets/banner-772x250.jpg?rev=1636218)
![](https://ps.w.org/woocommerce-jetpack/assets/icon-256x256.png?rev=1813426)
# Booster for WooCommerce

By [Pluggabl LLC](https://booster.io)

[Download](https://downloads.wordpress.org/plugin/woocommerce-jetpack.7.2.4.zip)

* [Details](https://wordpress.org/plugins/woocommerce-jetpack/#description)
* [Reviews](https://wordpress.org/plugins/woocommerce-jetpack/#reviews)
* [Development](https://wordpress.org/plugins/woocommerce-jetpack/#developers)

[Support](https://wordpress.org/support/plugin/woocommerce-jetpack/)

## Description

**The only WooCommerce bundle you’ll ever need.**

Replace all those WooCommerce plugins with one single plugin that does the job of them all, and then some! Booster combines everything you need to fully customize your site’s functionality into a single WooCommerce bundle, with 110 features and counting. With zero coding needed and easy setup options, Booster makes customization simple for everyone.

Discover why **100,000+ websites** rely on Booster to expand the possibilities of your website. Increase your sales with a multitude of features with the **#1 all-in-one WooCommerce plugin**. Stop relying on multiple WordPress product plugins today!

**100+ WooCommerce addons in one single package.**

Multiple WordPress WooCommerce plugins are a thing of the past! Boost the functionality of your Woocommerce website with just one plugin. Here’s what you get with Booster:

**Maximum Features:** Add customized functionality to your WooCommerce business quickly with more than one hundred modules. Create a seamless customer experience on the front end and equip yourself with robust admin and reporting tools on the backend.

**Zero Coding:** Booster is for everyone. It’s easy to set up and entirely flexible for maximum customization with just a few clicks. No coding required.

**Maximum Savings:** Save time and money by installing one plugin that will customize your website like no other. Increase your sales with a host of additional features for the perfect shopping experience.

**Zero Bloat:** Booster has a modular architecture, so you can enable only what you need. With just one plugin, you’re automatically boosting your website speed.

**Key Features of Booster for WooCommerce**

* [**PDF Invoicing and Packing slips:**](https://booster.io/woocommerce-pdf-invoicing-and-packing-slips/) Streamline WooCommerce orders and paperwork by adding professional WooCommerce PDF invoices and offline packing docs.
* [**Product Input fields:**](https://booster.io/features/woocommerce-product-input-fields/) Add additional custom input fields on all products or per product and allow customers to add more information for the perfect custom product. If you’re selling customized products, this is a must!
* [**Prices and Currencies:**](https://booster.io/category/features/prices-currencies/) Attract international customers to your site by displaying their currency with automatic exchange rates. Define price rules with WooCommerce Dynamic Pricing and offer global discounts.
* [**Cart and Checkout:**](https://booster.io/category/features/cart-checkout/) Customize the shopping cart and checkout experience for your customers. Create and add custom fields, coupons, additional fees, buttons, and more. Customize the checkout experience with WooCommerce custom fields, like VAT for EU countries, coupon codes, and checkout fees. Reduce cart abandonment with WooCommerce One Page Checkout.
* [**Product Addons:**](https://booster.io/features/woocommerce-product-addons/) Use the WooCommerce Product Addons module to customize any product, such as setting product labels and prices for each addon or creating automatic discounts. Addons can be added globally or per product.
* [**Button and Price labels:**](https://booster.io/features/woocommerce-free-price-labels/) Change price labels and create custom buttons of your choice. Add customized buttons and price labels to your products. The WooCommerce Free Price Labels module lets you set automatic prices for products with an empty price field.
* [**Payment gateways:**](https://booster.io/category/features/payment-gateways/) Set up custom WooCommerce payment gateways based on currency, shipping method, or location. Set up a multi-currency converter, and add min/max amounts for payment gateways to show up.
* [**Emails, reporting, and Administrative tools:**](https://booster.io/category/features/emails-misc/) Add custom emails, additional recipients, and basic WPML support. Generate various reports (sales, customers, etc.), track users, and include verification for increased security.Key Features of Booster for WooCommerce.

**Need more? Check out paid Booster bundles**

paid Booster bundles are paid upgrade of Booster that unlocks more functionalities. Boost your business with all the best WooCommerce features and get access to additional administrative tools and reports.

* *PDF Invoicing and Packing:* Create proforma invoices, credit notes, and packing slips
* *Cart and Checkout:* Add multiple custom fields, custom info blocks, check out file uploads.
* *Prices and Currencies:* Add an unlimited number of currencies to WooCommerce.
* *Add to Cart:* Customize add to cart messages, button labels with multiple category groups allowed.
* *Empty Cart:* Customize empty cart button text, different button positions on your cart page, and more.
* *Mini Cart:* Add more custom information options.
* *Export options:* Enable additional fields.
* *Configuration options:* Include additional payments and shipping options.

Paid Booster bundles have all of these additional features and more. Discover what Booster has to offer now:

[**Compare Booster Free and paid Booster bundles**](https://booster.io/booster-woocommerce-free-vs-plus/)

Paid Booster bundles comes with a 30-day no-questions-asked money-back guarantee. If you’re not completely satisfied, we will give you 100% of your money back!

[**Upgrade Now**](https://booster.io/buy-booster/)

### Detailed List of Features

**Due to new WordPress.org readme.txt standards, we have summarized our features and cannot be as detailed as before in identifying all paid and free features in the description. Reach out to us if you have specific questions on paid vs. free features.**

**Subscription Customization**

\* Subscriptions – Manage subscriptions, allow cancellation, change payment dates, and more. (Paid feature)

**Marketing**

\* Sales Notifications – Increase sales with proof of sales notifications. (Paid feature)

**Prices & Currencies**

\* Best Price – Customers suggest prices. (Paid feature)

\* Bulk Price Converter – Adjust prices in bulk.

\* Currencies – Add global currencies; custom currencies in free version.

\* Currency Exchange Rates – Automatic updates with multiple servers.

\* Currency for External Products – Set different currencies for external products.

\* Currency per Product – Display prices in different currencies.

\* Global Discount – Apply discounts to all products.

\* Multicurrency – Multiple currencies with a switcher; limited in free version.

\* Multicurrency Product Base Price – Set product prices in different currencies.

\* Offer Your Price – Customers suggest prices for products.

\* Price Formats – Customize price formats per currency.

\* Price based on User Role – Display prices by user role. (Paid feature)

\* Prices and Currencies by Country – Change prices and currencies by country.

\* Product Open Pricing – Customers manually enter prices.

\* Product Price by Formula – Automatic price calculation formulas.

\* Wholesale Price – Set wholesale pricing based on quantity.

**Button & Price Labels**

\* Add to Cart Button Labels – Customize Add to Cart button text.

\* Call for Price – Custom price labels for products without prices. (Paid feature)

\* Custom Price Labels – Create custom price labels.

\* Free Price Labels – Set labels for free products.

\* More Button Labels – Customize “Place order” button text.

**Products**

\* WooCommerce Product Extra Fees – Set extra fees for products.

\* Add to Cart – Custom redirect URLs; automatic add to cart; disable quantity input.

\* Add to Cart Button Visibility – Control visibility of Add to Cart button.

\* Admin Products List – Customize admin products list.

\* Bookings – Add booking products.

\* Cost of Goods – Track product costs for reports.

\* Cross-sells – Customize cross-sells display. (Paid feature)

\* Crowdfunding – Add crowdfunding products.

\* Product Addons – Add paid or free product addons.

\* Product Availability by Date/Time – Set product availability by date and time.

\* Product Bulk Meta Editor – Bulk edit product metadata.

\* Product Custom Visibility – Customize product visibility.

\* Product Images – Customize product images and thumbnails.

\* Product Info – Add extra info to category and product pages.

\* Product Input Fields – Add input fields to products.

\* Product Listings – Customize shop and category page displays.

\* Product MSRP – Display MSRP in WooCommerce.

\* Product Tabs – Add and customize product tabs.

\* Product Visibility by Country/User Role – Display products by country or user role.

\* Products XML Feeds – Generate product XML feeds.

\* Products per Page – Add selector for products per page.

\* Related Products – Customize related products display.

\* SKU – Generate and search SKUs automatically.

\* Sale Flash – Customize sale flash displays.

\* Sorting – Add, rename, and remove sorting options.

\* Stock – Manage stock display.

\* Tax Display – Customize tax display.

\* Upsells – Customize upsell products display.

\* User Products – Allow users to add products from the frontend.

\* Product Variation Swatches – Allow product variant selection.

**Cart & Checkout**

\* Cart Abandoned Reminder – Send reminders for abandoned carts.

\* Cart Custom Info – Add custom info to the cart page.

\* Cart Customization – Customize cart options.

\* Checkout Core/Custom Fields – Customize checkout fields.

\* Checkout Custom Info – Add custom info to the checkout page.

\* Checkout Customization – Customize checkout options.

\* Checkout Fees – Add fees to cart and checkout.

\* Checkout Files Upload – Allow file uploads at checkout.

\* Coupon Code Generator – Generate coupon codes.

\* Coupon by User Role – Apply coupons by user role.

\* EU VAT Number – Collect and validate EU VAT numbers.

\* Empty Cart Button – Add and customize “Empty Cart” button.

\* Mini Cart Custom Info – Add custom info to the mini cart.

\* URL Coupons – Apply coupons via URL.

\* Frequently Bought Together – Suggest frequently bought items.

\* One Page Checkout – Simplify checkout process.

\* Wishlist – Allow customers to mark favorite products.

**Payment Gateways**

\* Custom Gateways – Add custom payment gateways.

\* Gateways Currency Converter – Convert currencies for gateways.

\* Gateways Fees and Discounts – Apply fees or discounts.

\* Gateways Icons – Change or remove payment gateway icons.

\* Gateways Min/Max Amounts – Set min/max amounts for gateways.

\* Gateways by Country/Currency/Shipping/User Role – Control gateway visibility.

**Shipping & Orders**

\* Address Formats – Set address formats by country.

\* Admin Orders List – Customize admin orders list.

\* Custom Shipping – Add custom shipping methods.

\* Left to Free Shipping – Display info on free shipping eligibility.

\* Maximum Products per User – Limit items per customer.

\* Order Custom Statuses – Add custom order statuses.

\* Order Minimum Amount – Set minimum order amounts.

\* Order Numbers – Customize order numbering.

\* Order Quantities – Manage product quantities in orders.

\* Orders – Auto-complete orders and more.

\* Shipping Calculator – Customize shipping calculator.

\* Shipping Descriptions/Icons – Add descriptions and icons to shipping methods.

\* Shipping Methods by City/Date/Amount/Products/Users – Customize shipping methods visibility.

\* Shipping Options – Hide shipping when free shipping is available.

\* Shipping Time – Add delivery time estimations.

**PDF Invoicing & Packing Slips**

\* PDF Invoicing – Generate invoices, credit notes, and packing slips.

**Emails & Misc.**

\* Admin Bar – WooCommerce admin bar.

\* Admin Tools – General back-end tools.

\* Booster WPML – Basic WPML support.

\* Breadcrumbs – Customize WooCommerce breadcrumbs.

\* Custom CSS/JS/PHP – Add custom code.

\* Debug Tools – Debug and log tools.

\* Email Options – Customize email recipients and options.

\* Email Verification – Add email verification.

\* Export – Export WooCommerce data.

\* General – General front-end tools.

\* Modules By User Roles – Enable/disable modules by user roles.

\* My Account – Customize “My Account” page.

\* Old Slugs – Remove old product slugs.

\* Reports – Generate various reports.

\* Template Editor – Edit WooCommerce templates.

\* User Tracking – Track users and orders.

### Feedback

* We are open to your suggestions and feedback – thank you for using or trying out one of our plugins!
* If you have any ideas how to upgrade the plugin to make it better, or if you have ideas about the features that are missing from our plugin, please [fill the form](https://booster.io/submit-idea/).
* For support please visit the [Plugin Support Forum](https://wordpress.org/support/plugin/woocommerce-jetpack/).

## Screenshots

* [![](https://ps.w.org/woocommerce-jetpack/assets/screenshot-1.png?rev=2943485)](https://ps.w.org/woocommerce-jetpack/assets/screenshot-1.png?rev=2943485)

  Booster for WooCommerce – Dashboard.
* [![](https://ps.w.org/woocommerce-jetpack/assets/screenshot-2.png?rev=2943485)](https://ps.w.org/woocommerce-jetpack/assets/screenshot-2.png?rev=2943485)

  Booster for WooCommerce – Prices & Currencies.
* [![](https://ps.w.org/woocommerce-jetpack/assets/screenshot-3.png?rev=2943485)](https://ps.w.org/woocommerce-jetpack/assets/screenshot-3.png?rev=2943485)

  Booster for WooCommerce – Button & Price Labels.
* [![](https://ps.w.org/woocommerce-jetpack/assets/screenshot-4.png?rev=2943485)](https://ps.w.org/woocommerce-jetpack/assets/screenshot-4.png?rev=2943485)

  Booster for WooCommerce – Products.
* [![](https://ps.w.org/woocommerce-jetpack/assets/screenshot-5.png?rev=2943485)](https://ps.w.org/woocommerce-jetpack/assets/screenshot-5.png?rev=2943485)

  Booster for WooCommerce – Cart & Checkout.
* [![](https://ps.w.org/woocommerce-jetpack/assets/screenshot-6.png?rev=2943485)](https://ps.w.org/woocommerce-jetpack/assets/screenshot-6.png?rev=2943485)

  Booster for WooCommerce – Payment Gateways.
* [![](https://ps.w.org/woocommerce-jetpack/assets/screenshot-7.png?rev=2943485)](https://ps.w.org/woocommerce-jetpack/assets/screenshot-7.png?rev=2943485)

  Booster for WooCommerce – Shipping & Orders.
* [![](https://ps.w.org/woocommerce-jetpack/assets/screenshot-8.png?rev=2943485)](https://ps.w.org/woocommerce-jetpack/assets/screenshot-8.png?rev=2943485)

  Booster for WooCommerce – PDF Invoicing & Packing Slips.
* [![](https://ps.w.org/woocommerce-jetpack/assets/screenshot-9.png?rev=2943485)](https://ps.w.org/woocommerce-jetpack/assets/screenshot-9.png?rev=2943485)

  Booster for WooCommerce – Emails & Misc.

## FAQ

### How to install Booster for WooCommerce (free version)?

The easiest way to install Booster is via your site’s Dashboard. Please follow these instructions to install and connect Booster:

Log in to your site’s Dashboard (e.g. http://www.yourdomain.com/wp-admin)

Click on the “Plugins” tab in the left panel, then click “Add New”.

Search for “Booster for WooCommerce” and the latest version will appear at the top of the list of results.

Install it by clicking the “Install Now” link.

When installation finishes, click “Activate Plugin”.

You’re done!

### Do I need any coding skills to use Booster?

Absolutely not! You can configure everything Booster has to offer without any coding knowledge.

### What’s the difference between Booster and Paid Booster bundles?

The free version of Booster for WooCommerce offers 68 amazing features. But, if you’re looking for greater functionality and even more customization options – Booster Plus is the ultimate WooCommerce product bundle for you. Booster Plus is packed with 196 features and counting.

Check out our [feature comparison](https://booster.io/booster-woocommerce-free-vs-plus/) and decide which version is best for you.

### Why should I choose paid Booster bundles over other plugins?

Implementing just a few modules from the Booster paid Booster bundles suite is more cost-effective than using multiple individual plugins, often priced at $79-$99 each. Stacking your WooCommerce site with a lot of different plugins can slow it down too. All those individual plugins may not necessarily be compatible with one another.

paid Booster bundles solves all of these problems with over 100 compatible modules in a single package for easy WooCommerce integration. You get multiple custom features for the cost of one WordPress product plugin and the benefit of zero bloat.

### Do you offer refunds?

If you are not completely satisfied with paid Booster bundles, you can request a refund within the first 30 days, and we will give you 100% of your money back – no questions asked.

### How to unlock those some features settings that are locked?

To unlock all Booster for WooCommerce features, please install additional paid Booster bundles(https://booster.io/buy-booster/) plugin.

## Reviews

![](https://secure.gravatar.com/avatar/6a590d33b1013dfe0a1e08f28f3b84b6b0213fbaacd8c5a5edb21776c426cf26?s=60&d=retro&r=g)
### [Active support](https://wordpress.org/support/topic/active-support-2/)

[technicalx](https://profiles.wordpress.org/technicalx/ "Posts by technicalx")
December 17, 2024

Support will help if you can supply a lot of detail and provide a test environment.

![](https://secure.gravatar.com/avatar/6ee41b6cb02bd29b16a01e6360697285a30df7810a0785a95749e597adca9fd7?s=60&d=retro&r=g)
### [Didn’t work. Support is ignoring refund requests](https://wordpress.org/support/topic/didnt-work-support-is-ignoring-refund-requests/)

[visualindustrie2024](https://profiles.wordpress.org/visualindustrie2024/ "Posts by visualindustrie2024")
December 14, 2024

Signed up for a 5 site agency package. It didn’t do what I needed it to do. AT ALL. contacted support. Took roughly 4 days for them to finally say they were looking at it. 3 days later and no action. Requested a refund and got a response in 3 hours. They replied to the refund request saying were still looking into my issue… In spite of me having found and implemented a suitable replacement already and having asked for a refund. 24 hours later and they’ve logged into my site, deactivated the replacement plugin, reactivated their plugin and STILL haven’t fixed the problem. Have deleted their user account and FTP account (still not sure why they needed that given it was a fresh install and I’ve not needed to use FTP to manage my own site yet). Just soooo slow and straight up ignoring my instructions at this point.l causing more work for me. Not fun. In the middle of all this I got a “2023” wrap up email from their marketing comms. In December 2024. Attention to detail clearly not high.

![](https://secure.gravatar.com/avatar/819e352cc25faa11bda3036bc6caf64dbb4fd2b883422ba594f629e88a16c2b7?s=60&d=retro&r=g)
### [Good support but annoying follow up afterwards](https://wordpress.org/support/topic/good-support-but-annoying-follow-up-afterwards/)

[ellenlx](https://profiles.wordpress.org/ellenlx/ "Posts by ellenlx")
September 12, 2024

Very happy with the fast response on a problem we had with the invoice. Clear instructions and solved correctly.
However, really annoyed with the fact we got 3 mail in 3 days asking to write a review. Almost wasn’t going to happen because of this.

![](https://secure.gravatar.com/avatar/3f198b854ead992107d370b3668331b832b9763bce0162c84507e84a9c1889cd?s=60&d=retro&r=g)
### [Be aware that the support is $129.99 a year and very slow!](https://wordpress.org/support/topic/be-aware-that-the-support-is-129-99-a-year-and-very-slow/)

[SLV](https://profiles.wordpress.org/dwnl/ "Posts by SLV")
September 9, 2024
1 reply

Great plugin with a lot of options, but be aware that the support is $129.99 a year!The support reaction speed is very slow. It will take days/weeks for you to get a reaction, and they don’t really help and brush it off with, make contact via our website and pay us an extra $129.99. And even then, the speed of the support is slow of not existing.They said: We were receiving an overwhelming volume of support requests, making it impossible to maintain the high level of service our customers expect within reasonable timeframes.In my case, they have an error/bug in their plugin and I need to pay them $129.99 to be able to send a ticket and for them to maybe solve the error/bug in their plugin…Yeah, I say no.So be aware!

![](https://secure.gravatar.com/avatar/120f38df1394d3ccdece326f8c7cec847b6507b9d1ae08c1e2410b5396f64351?s=60&d=retro&r=g)
### [Maximum Products per User not reliable](https://wordpress.org/support/topic/maximum-products-per-user-not-reliable/)

[majikthyse](https://profiles.wordpress.org/majikthyse/ "Posts by majikthyse")
August 20, 2024

We don’t use many of the huge range of options, but I recently tried turning on Maximum Products per User. This was to stop our members from ordering a product more than once. It’s a lottery as to whether it works or not, and I have just had a case where it was triggered incorrectly. Needs a bit of work.
Also I have turned on payment gateways per product category, but it doesn’t do anything.

![](https://secure.gravatar.com/avatar/97ee991b1ac062258b7f641f807b45c102a60b30fad993ba76cd015e30e780cc?s=60&d=retro&r=g)
### [aide pour personnaliser les factures](https://wordpress.org/support/topic/aide-pour-personnaliser-les-factures/)

[plusdefleurs](https://profiles.wordpress.org/plusdefleurs/ "Posts by plusdefleurs")
August 7, 2024

J’ai pu en grande partie personnaliser les facture grace à la documentation mais il y avait une implémentation de code que je ne savais pas où placer. J’ai reçu ma réponse dès le lendemain. Parfait merci !

[Read all 518 reviews](https://wordpress.org/support/plugin/woocommerce-jetpack/reviews/)
## Contributors & Developers

“Booster for WooCommerce” is open source software. The following people have contributed to this plugin.

Contributors

* ![](https://secure.gravatar.com/avatar/142252ee343add2d89477553ab93349df22dfd14411c0fd3fd2ae56cf3bf3e61?s=32&d=mm&r=g) [Pluggabl](https://profiles.wordpress.org/pluggabl/)

“Booster for WooCommerce” has been translated into 12 locales. Thank you to [the translators](https://translate.wordpress.org/projects/wp-plugins/woocommerce-jetpack/contributors) for their contributions.

[Translate “Booster for WooCommerce” into your language.](https://translate.wordpress.org/projects/wp-plugins/woocommerce-jetpack)

### Interested in development?

[Browse the code](https://plugins.trac.wordpress.org/browser/woocommerce-jetpack/), check out the [SVN repository](https://plugins.svn.wordpress.org/woocommerce-jetpack/), or subscribe to the [development log](https://plugins.trac.wordpress.org/log/woocommerce-jetpack/) by [RSS](https://plugins.trac.wordpress.org/log/woocommerce-jetpack/?limit=100&mode=stop_on_copy&format=rss).

## Changelog

#### 7.2.4 13/11/2024

* FIXED – Uncaught Error: round(): Argument #2 ($precision) must be of type int, string given in includes/shortcodes/class-wcj-orders-shortcodes.php…
* FIXED – Fatal error: Call to a member function get() on null in includes/functions/wcj-functions-users.php…
* FIXED – Fatal error: Call to a member function get\_tax\_totals() on null in includes/class-wcj-eu-vat-number.php…
* FIXED – Fatal error: Call to a member function get\_customer\_ip\_address() on null in includes/functions/class-wcj-eu-vat-number.php…
* FIXED – Fatal error: Unsupported operand types: float + string in includes/reports/class-wcj-reports-stock.php…
* FIXED – Fatal error: Unsupported operand types: int + string in includes/reports/class-wcj-reports-stock.php…
* FIXED – Fix security vulnerability related to add\_query\_arg & remove\_query\_arg functions.
* FIXED – Fix security vulnerability related to get\_post\_meta() function.
* WooCommerce 9.3.3 Tested
* WordPress 6.6.2 Tested

#### 7.2.3 11/09/2024

* WooCommerce 9.2.3 Tested
* WordPress 6.6.1 Tested

#### 7.2.2 12/08/2024

* NEW FEATURE – PAYMENT GATEWAYS – Gateways Min/Max Amounts – Introduced a new feature to include tax in the cart total when comparing with minimum/maximum limits.
* FIXED – PRICES & CURRENCIES – Product Open Pricing (Name Your Price) – Resolved the issue of an empty cart page notice during reorders.
* FIXED – Fixed the cross-site scripting vulnerability issue associated with the shortcodes of the Order category.
* FIXED – Addressed cross-site scripting vulnerabilities associated with Order Items shortcode.
* WooCommerce 9.1.4 Tested
* WordPress 6.6.1 Tested

#### 7.2.1 10/07/2024

* FIXED – PRODUCTS – Tax Display – Hide the ‘wcj-button-toggle-tax-display-nonce’ nonce field to prevent it from breaking the WooCommerce REST API JSON response in certain instances.
* FIXED – Fixed the cross-site scripting vulnerability issue associated with the shortcodes of the Cart category.
* FIXED – Addressed cross-site scripting vulnerabilities associated with Product Input-field shortcodes.
* FIXED – Rectified cross-site scripting vulnerabilities linked to the Add New Product ‘[wcj\_product\_add\_new]’ shortcode.
* FIXED – PHP Fatal error: Uncaught Error: Call to a member function get\_price() on bool in… wcj-functions-price-currency.php:616.
* WooCommerce 9.0.2 Tested
* WordPress 6.5.5 Tested

#### 7.2.0 05/06/2024

* FIXED – PRODUCTS – User Products – Addressed the unauthenticated arbitrary shortcode execution vulnerability in the user product module.
* WooCommerce 8.9.1 Tested
* WordPress 6.5.3 Tested

#### 7.1.9 24/04/2024

* FIXED – SHIPPING & ORDERS – Order Numbers – Fixed the order renumbering issue that occurred with the generation of new orders.
* FIXED – SHIPPING & ORDERS – Order Numbers – Addressed the problem encountered when searching orders by their custom numbers with WooCommerce HPOS.
* FIXED – Fixed the cross-site scripting vulnerability issue associated with the shortcodes of the Product category.
* FIXED – Fixed the cross-site scripting vulnerability issue associated with the shortcodes of the General category.
* FIXED – PHP Warning: Undefined array key “srcs” in… class-wcj-invoices-shortcodes.php on line 93.
* FIXED – PHP Fatal error: Uncaught Error: Call to undefined method WC\_Order\_Item\_Fee::get\_product\_ID() in… class-wcj-order-items-shortcodes.php:523.
* WooCommerce 8.8.2 Tested
* WordPress 6.5.2 Tested

#### 7.1.8 06/03/2024

* FIXED – CART & CHECKOUT – Checkout Custom Fields – Resolved the issue causing unexpected modification of custom fields when saving orders from the admin order edit page.
* FIXED – PRODUCTS – User Products – Implemented client/server-side validation to restrict file uploads to specific types only.
* FIXED – Fixed the cross-site scripting vulnerability issue associated with the ‘[wcj\_product\_wholesale\_price\_table]’ shortcode.
* FIXED – Fixed the cross-site scripting vulnerability issue associated with the currently active tab settings.
* FIXED – Fixed the cross-site scripting vulnerability issue associated with the shortcodes of the Invoice category.
* FIXED – Fixed the cross-site scripting vulnerability issue associated with the shortcodes of the Products Crowdfunding category.
* FIXED – PHP Fatal error: Uncaught Error: Call to a member function get\_base\_country() on null in… wcj-functions-country.php on line 156.
* FIXED – PHP Fatal error: Uncaught Error: Call to a member function is\_type() on bool in… wcj-functions-products.php on line 444.
* NEW FEATURE – PRICES & CURRENCIES – Wholesale Price – Created a new feature ‘Products to Exclude forcefully’ to exclude Products forcefully.
* NEW FEATURE – PRICES & CURRENCIES – Wholesale Price – Introduced the ‘Product Categories to Exclude forcefully’ feature to enable the exclusion of specific product categories.
* WooCommerce 8.6.1 Tested
* WordPress 6.4.2 Tested

#### 7.1.7 12/02/2024

* FIXED – Fixed the cross-site scripting vulnerability issue associated with the ‘[wcj\_product\_barcode]’ shortcode.
* NEW FEATURE – PRODUCTS – Cost of Goods – Introduce a new feature labeled ‘Charge Calculation’ for differentiating charge calculation methods: percentage of product price or purchase cost (default).
* WooCommerce 8.5.2 Tested
* WordPress 6.4.2 Tested

#### 7.1.6 07/02/2024

* FIXED – Addressed PHP Deprecated errors related to the creation of dynamic properties throughout the entire plugin.
* FIXED – SHIPPING & ORDERS – Admin Orders List – Resolved the issue of orders not being filtered based on the applied filter from the “Add Presets to Admin Menu” option.
* FIXED – SHIPPING & ORDERS – Order Numbers – Addressed the problem encountered when searching for an order using a custom order number.
* FIXED – EMAILS & MISC – Admin Bar – Fixed the issue of tools not working when accessed through the admin bar.
* NEW FEATURE – PRICES & CURRENCIES – Price based on User Role – Introduced a new option called “Compatibility with Product Addon” to address compatibility issues with the Product Addon module.
* NEW FEATURE – PRODUCTS – Product Addons – Implemented a new option to filter addon prices based on user roles.
* NEW FEATURE – CART & CHECKOUT – EU VAT Number – Added a new feature named “Apply Country Code Prefix to EU VAT” to resolve the VAT verification issue.
* NEW FEATURE – CART & CHECKOUT – EU VAT Number – Added a new feature named “Preserve VAT in Base Country By Billing country” to validate the billing country against the store base country before applying for VAT exemption
* NEW FEATURE – CART & CHECKOUT – EU VAT Number – Added a new feature named “Preserve VAT in Base Country By Shipping Country”, it cross-checks the shipping country with the store base country before VAT exemption.
* WooCommerce 8.5.2 Tested
* WordPress 6.4.2 Tested

#### 7.1.5 20/12/2023

* NEW FEATURE – EMAILS & MISC – General – Introduced a new option to display order shortcodes forcefully.
* FIXED – PRICES & CURRENCIES – Multicurrency (Currency Switcher) – Hide the “wcj-currency-nonce” nonce field, as it breaks the WooCommerce Rest API JSON response in certain instances.
* FIXED – PDF INVOICING & PACKING SLIPS – PDF Invoicing – Fixed PHP Deprecated errors associated with TCPDF library.
* FIXED – PHP Deprecated: Optional parameter $isunicode declared before required parameter $currentfont is implicitly treated as a required parameter in… includes/lib/tcpdf/include/tcpdf\_fonts.php on line 1998
* FIXED – PHP Deprecated: Optional parameter $setbom declared before required parameter $currentfont is implicitly treated as a required parameter in… includes/lib/tcpdf/include/tcpdf\_fonts.php on line 2040
* FIXED – PHP Deprecated: Optional parameter $str declared before required parameter $currentfont is implicitly treated as a required parameter in… includes/lib/tcpdf/include/tcpdf\_fonts.php on line 2077
* FIXED – PHP Deprecated: Optional parameter $default\_css declared before required parameter $tagvspaces is implicitly treated as a required parameter in… includes/lib/tcpdf/include/tcpdf\_static.php on line 1139
* FIXED – PHP Deprecated: Optional parameter $tagvs declared before required parameter $tagvspaces is implicitly treated as a required parameter in… includes/lib/tcpdf/include/tcpdf\_static.php on line 1139
* FIXED – PHP Deprecated: Optional parameter $tidy\_options declared before required parameter $tagvspaces is implicitly treated as a required parameter in… includes/lib/tcpdf/include/tcpdf\_static.php on line 1139
* FIXED – PHP Deprecated: Optional parameter $points declared before required parameter $k is implicitly treated as a required parameter in… includes/lib/tcpdf/include/tcpdf\_static.php on line 2510
* FIXED – PHP Deprecated: Implicit conversion from float 2.547055555555555 to int loses precision in… includes/lib/tcpdf/tcpdf.php on line 4138
* FIXED – PHP Deprecated: Implicit conversion from float 1.961444444444444 to int loses precision in… includes/lib/tcpdf/tcpdf.php on line 4137
* WooCommerce 8.4.0 Tested
* WordPress 6.4.2 Tested

#### 7.1.4 13/12/2023

* NEW FEATURE – All the modules are now Compatible with WooCommerce HPOS.
* FIXED – PHP Warning: Trying to access array offset on value of type bool in includes/class-wcj-admin-orders-list.php… on line 141.
* FIXED – PHP Warning: Undefined variable $order\_id in includes/class-wcj-checkout-files-upload.php… on line 535.
* WooCommerce 8.3.1 Tested
* WordPress 6.4.2 Tested

#### 7.1.3 18/10/2023

* FIXED – Fixed the Cross-Site Scripting vulnerability issue associated with the ‘[wcj\_image]’ Shortcode.
* FIXED – Resolved the issue of sensitive data from orders being revealed through Shortcodes.
* FIXED – EMAILS & MISC – Custom Emails – Addressed the issue of missing Order Information for guest users.
* FIXED – PRODUCTS – User Products – Restricted access to selected user roles for security authentication.
* WooCommerce 8.2.0 Tested
* WordPress 6.3.2 Tested

#### 7.1.2 04/10/2023

* FIXED – Addressed the issue of sensitive order-related information being exposed via Shortcodes.
* FIXED – Fixed the Cross-Site Scripting vulnerability issue associated with Shortcodes.
* FIXED – Resolved the problem of Authenticated Information Disclosure via Shortcodes.
* FIXED – PRODUCTS – User Products – Rectified the problem of malicious post/page insertion/update via WordPress parse-media-shortcode AJAX action.
* WooCommerce 8.1.1 Tested
* WordPress 6.3.1 Tested

#### 7.1.1 13/09/2023

* FIXED – Rectified the issue of Authenticated Information Disclosure through Shortcodes.
* FIXED – Addressed the Cross-Site Scripting vulnerability issue associated with the Shortcodes.
* WooCommerce 8.0.3 Tested
* WordPress 6.3.1 Tested

#### 7.1.0 09/08/2023

* FIXED – Added Security vulnerability fixes.
* WooCommerce 8.0.0 tested

#### 7.0.0 26/07/2023

* FIXED – EMAILS & MISC – Admin Bar – Fixed Booster Tools not working when accessed through the admin bar.
* FIXED – BUTTON & PRICE LABELS – Add to Cart Button Labels – Fixed the Button’s text issue when the price is set to 0.
* FIXED – BUTTON & PRICE LABELS – Free Price Labels – Fixed the issue of Free Price Labels not working with variable products.
* FIXED – PRICES & CURRENCIES – Price based on User Role – Fixed the issue of the module stopping working When enabled the >> Enable Price by User role for Order Edit option.
* FIXED – PRODUCTS – Product Bulk Meta Editor Module – Fixed the meta delete option while using the Product Bulk Meta Editor Module Tool.
* FIXED – PRODUCTS – Product Availability by Time – Fixed the Product availability filter issue not working for the minutes.
* FIXED – CART & CHECKOUT – Checkout Files Upload – Fixed the HTML tag not being saved with the Order Template option.
* FIXED – SHIPPING & ORDERS – Maximum Products per User – Fixed the global qty limit should be used when the per product qty limit is set to 0.
* FIXED – SHIPPING & ORDERS – Orders – Fixed the module redirection issue After setup the >> Bulk Regenerate Download Permissions for the Orders settings option.
* FIXED – SHIPPING & ORDERS – Order Quantities – Fixed the global min/max qty limit should be called when the per product qty limit is set to 0.
* FIXED – SHIPPING & ORDERS – Order Quantities – Fixed Max quantities should be disabled when qty set to the -1 from per product section.
* FIXED – SHIPPING & ORDERS – Order Quantities – Fixed Global step limit should be used when per product step set to 0.
* FIXED – SHIPPING & ORDERS – Order Quantities – PHP Fatal error: Uncaught DivisionByZeroError: Modulo by zero in includes/class-wcj-order-quantities.php.
* FIXED – SHIPPING & ORDERS – Shipping Methods by Products – Fixed shipping method include/exclude filter issues with the variable products.
* FIXED – SHIPPING & ORDERS – Shipping Methods by Users – Fixed shipping method not filtered according to selected users.
* FIXED – PRICES & CURRENCIES – Wholesale Price – Uncaught Error: Uncaught TypeError: Unsupported operand types: string \* string in includes/class-wcj-wholesale-price.php…
* FIXED – PDF INVOICING & PACKING SLIPS – PDF Invoicing – Fixed save pdf instead of view pdf in browser option.
* FIXED – PDF INVOICING & PACKING SLIPS – PDF Invoicing – Fixed name format issue while saving the custom document.
* FIXED – PDF INVOICING & PACKING SLIPS – PDF Invoicing – Fixed the Header Content disappearing when using the background image.
* NEW FEATURE – PDF INVOICING & PACKING SLIPS – PDF Invoicing – Create a new option to control the opacity of the background image.
* NEW FEATURE – PDF INVOICING & PACKING SLIPS – PDF Invoicing – Add a new option to adjust the margin-top for the background image.
* NEW FEATURE – PDF INVOICING & PACKING SLIPS – PDF Invoicing – Add a new option to set the margin left for the background image.
* Complete overhaul of User Interface (UI), offering a modern, sleek, and intuitive design.
* Improved navigation system across 120+ modules, enabling easy and quick access to features.
* Implementation of a consistent design language across all modules for a seamless user experience.
* Enhanced user experience (UX) with interactive and optimized module interactions.
* WooCommerce 7.9.0 Tested
* WordPress 6.2.2 Tested

#### 6.0.6 24/05/2023

* FIXED – PRICES & CURRENCIES – Prices and Currencies by Country – Fixed price & currency when users apply the country from the URL.
* FIXED – CART & CHECKOUT – Checkout Files Upload – Fixed Checkout file remove option not working on thank you page and my account page.
* FIXED – SHIPPING & ORDERS – Shipping Options – Fixed the compatibility issue for the Shipping Methods by Users Module and Shipping Options Module.
* FIXED – EMAILS & MISC – Admin Tools Module – Fixed issue Product meta options for object data.
* FIXED – Uncaught Error: Object of class stdClass could not be converted to string in includes/class-wcj-admin-tools.php …
* FIXED – Fixed Manage Settings “Load Modules on Init Hook” option.
* WooCommerce 7.7.0 Tested
* WordPress 6.2.2 Tested

#### 6.0.5 29/03/2023

* NEW FEATURE – PAYMENT GATEWAYS – Gateways PDF Notes – Added new module to add PDF notes for various gateways in invoices.
* NEW FEATURE – PRICES & CURRENCIES – Price based on User Role – Added new option to allow price by user role while creating/editing order from admin.
* FIXED – PRODUCTS – Product Addons – Fixed Product addon label issue for select type.
* FIXED – PRODUCTS – Product Visibility by User Role – Fixed user role not being saved using bulk edit.
* FIXED – PRICES & CURRENCIES – Prices and Currencies by Country – Fixed price not being saved in per page product issue on variation product.
* FIXED – Uncaught Error: Call to a member function get\_id() booster-elite-for-woocommerce/includes/price-by-country/class-wcj-price-by-country-core.php …
* FIXED – Uncaught Error: Uncaught Error: Call to a member function get\_date\_created() booster-elite-for-woocommerce/includes/functions/wcj-functions-orders.php…
* WooCommerce 7.5.1 Tested
* WordPress 6.1.1 Tested

#### 6.0.4 02/03/2023

* FIXED – PDF INVOICING & PACKING SLIPS – PDF Invoicing – Fixed PDF Header and Footer issue.
* WooCommerce 7.4.0 Tested
* WordPress 6.1.1 Tested

#### 6.0.3 22/02/2023

* NEW FEATURE – Reset All options and meta after deleting the plugin.
* FIXED – EMAILS & MISC. – User Tracking – Fixed tracker not tracking countries issue.
* FIXED – PDF INVOICING & PACKING SLIPS – PDF Invoicing – Fixed shorting by invoices issue.
* FIXED – PDF INVOICING & PACKING SLIPS – PDF Invoicing – Fixed multiple pages background image issue.
* FIXED – PRODUCTS – Product Input Fields – Fixed required attribute issue on select box field.
* FIXED – PRICES & CURRENCIES – Wholesale Price – Fixed price level issue for per product option.
* FIXED – PRICES & CURRENCIES – Wholesale Price – Fixed the Wholesale discount table not showing data while the level is ‘0’ issue.
* FIXED – PDF INVOICING & PACKING SLIPS – PDF Invoicing – PHP Fatal error: Uncaught Error: Call to a member function get\_default\_template() on null in /includes/classes/class-wcj-pdf-invoice.php…
* FIXED – PDF INVOICING & PACKING SLIPS – PDF Invoicing – PHP Fatal error: Uncaught DivisionByZeroError: Division by zero in /includes/pdf-invoices/class-wcj-pdf-invoicing-report-tool.php…
* WooCommerce 7.4.0 tested
* WordPress 6.1.1 tested

#### 6.0.2 24/01/2023

* NEW FEATURE – PDF INVOICING & PACKING SLIPS – PDF Invoicing – Added a new shortcode Attribute for Tax Html Label Spaces [wcj\_order\_taxes\_html tax\_label\_spaces=”10″ ]
* NEW FEATURE – Cart & Checkout – Checkout Custom Fields – Added new option to Clear autoselected data on the checkout page.
* NEW FEATURE – PRODUCTS – Product Input Fields – Added a new feature to limit characters for the text and textarea field.
* FIXED – EMAILS & MISC. – Template Editor – Fixed fatal Error while changing any Template of wocommarce.
* FIXED – EMAILS & MISC. – Reports – Fatal error: Uncaught TypeError: array\_replace\_recursive(): Argument #2 must be of type array, string given in /includes/reports/class-wcj-reports-monthly-sales.php ..
* FIXED – SHIPPING & ORDERS – Order Custom Statuses – Fixed the case-sensitive issue for creating custom shortcodes.
* FIXED – SHIPPING & ORDERS – Admin Orders List – Fixed Shorting issue on Custom Column.
* FIXED – CART & CHECKOUT – Cart Custom Info – Fixed the shortcode issue for the “Add to Each Item Name” option.
* FIXED – PRICES & CURRENCIES – Wholesale Price – Fixed Cart message appearing on 0 discount.
* FIXED – Shortcodes – Products – `warning in`[wcj\_product\_total\_sales]`
* FIXED – Shortcodes – Fixed post object data issue for all shortcodes.
* FIXED – Widget – Fixed Issue “Error while adding Widget to site with theme customization option”
* WooCommerce 7.3.0 tested
* WordPress 6.1.1 tested

#### 6.0.1 21/12/2022

* FIXED – PRODUCTS – Product Addons – Fixed issue for Product Meta box – Label & Price textarea new line issue for “Select Box” type.
* FIXED – PRODUCTS – Price based on User Role – Fixed issue of Products Tags & Products Categories option.
* FIXED – PRODUCTS – Product Input Fields – Fixed issue of validation for Product Input Fields.
* FIXED – PRODUCTS – Tax Display – Fixed the issue of Tax incl & excl.
* FIXED – SHIPPING & ORDERS – Shipping Methods by Min/Max Order Quantity – Fixed the issue of order Min/Max for 0 value.
* FIXED – SHIPPING & ORDERS – Custom Shipping – Fixed the min & max weight conflict of custom shipping.
* FIXED – SHIPPING & ORDERS – Order Quantities – Minimum Quantity & Maximum Quantity Cart Total Quantity conflict with 0 Quantity.
* FIXED – PRICES & CURRENCIES – Wholesale Price – Fixed previously saved value disappear from “Products to Include” & Products to Exclude” after adding new value.
* FIXED – PRICES & CURRENCIES – Multicurrency (Currency Switcher) – Currency conversion issue fixed.
* FIXED – EMAILS & MISC. – Custom Emails – Fixed the issue of customer email.
* FIXED – EMAILS & MISC. – Modules By User Roles – Fixed modules conflicts.
* FIXED – EMAILS & MISC. – Export – Fixed shortcode not working in Additional Fields.
* FIXED – EMAILS & MISC. – General – Fixed CSRF issue for Booster User Roles Changer.
* FIXED – PDF INVOICING & PACKING SLIPS – PDF Invoicing – Fixed “invoice not showing to Guest users on Thank you page”.
* FIXED – Notice: Function billing\_country was called incorrectly.
* FIXED – Added Security vulnerability fixes.
* FIXED – Shortcodes – Orders – `[wcj_order_customer_user_roles]` Fixed issue for Guest user role.
* DEV – Allow iframe for all textarea input.
* WooCommerce 7.2.0 tested
* WordPress 6.1.1 tested

#### 6.0.0 30/11/2022

* FIXED – PDF INVOICING & PACKING SLIPS – PDF Invoicing – Fixed error PHP Deprecated: Function WC\_Order\_Item\_Product::offsetSet is deprecated since version…
* FIXED – PDF INVOICING & PACKING SLIPS – PDF Invoicing – Fixed calculation issue in wcj\_order\_item\_total\_refunded shortcode.
* FIXED – PRICES & CURRENCIES – Currency Exchange Rates – Fixed exchange rate issue for European Central Bank (ECB) exchange rate server response.
* FIXED – PRICES & CURRENCIES – Currency Exchange Rates – “Always Use cURL” option removed.
* FIXED – PRICES & CURRENCIES – Multicurrency (Currency Switcher) – Fixed Default Currency and Role Defaults conflict.
* FIXED – PRICES & CURRENCIES – Product Price by Formula – Fixed verify nonce issue.
* FIXED – EMAILS & MISC. – General – Added missing images for jquery-ui.css
* FIXED – Added Security vulnerability fixes – Multiple CSRF.
* FIXED – Added Security vulnerability fixes.
* WooCommerce 7.1.0 tested
* WordPress 6.1 tested

#### 5.6.8 16/11/2022

* FIXED – CART & CHECKOUT – EU VAT Number – Replace endpoint to validate EU VAT number for without soap method.
* FIXED – CART & CHECKOUT – EU VAT Number – Fixed tools UI.
* FIXED – EMAILS & MISC. – Admin Tools – Fixed admin order page issue when order item value is array.
* FIXED – EMAILS & MISC. – Reports – Fixed Product Sales (Monthly) report not highlight selected year.
* FIXED – BUTTON & PRICE LABELS – Custom Price Labels- Escape the HTML content from the “per page product meta box” value.
* FIXED – SHIPPING & ORDERS- Order Quantities – Fixed Maximum allowed quantity issue.
* FIXED – Added Security vulnerability fixes – Multiple CSRF.
* FIXED – Added Security vulnerability fixes.
* FIXED – Current timestamp issue – Created new function wcj\_get\_timestamp\_date\_from\_gmt() and replace with gmdate( ‘U’ ).
* FIXED – PHP Warning: asort() expects parameter 1 to be array, string given in …/includes/shortcodes/class-wcj-general-shortcodes.php on line 501
* WooCommerce 7.1.0 tested
* WordPress 6.1 Tested

#### 5.6.7 27/10/2022

* FIXED – PAYMENT GATEWAYS – Gateways Currency Converter – Fixed the issue of currency on the cart page.
* FIXED – CART & CHECKOUT – Checkout Files Upload – Fixed Security vulnerability for ShopManager + Arbitrary File Download.
* FIXED – CART & CHECKOUT – Checkout Files Upload – Fixed Security vulnerability for Checkout Files Deletion.
* FIXED – PRODUCTS – Product Input Fields – Fixed Security vulnerability for ShopManager + Arbitrary File Download.
* FIXED – PRODUCTS – Products per Page – Fixed “Template – Form” default text translators issue.
* FIXED – EMAILS & MISC. – Old Slugs – Fixed SQL error – syntax near ‘WHERE meta\_key = ‘\_wp\_old\_slug’….
* FIXED – PRICES & CURRENCIES – Prices and Currencies by Country – Price conversion issue by user selection with country group
* FIXED – Added CSRF Token for each “Reset settings” button of the module.
* FIXED – Added Security vulnerability fixes – Multiple CSRF.
* FIXED – Added Security vulnerability fixes.
* FIXED – PDF INVOICING & PACKING SLIPS – PDF Invoicing – Fixed order item table issue while merging multiple invoice PDFs.
* FIXED – PHP Warning: A non-numeric value encountered in …includes/functions/wcj-functions-price-currency.php on line 141
* WooCommerce 7.0.0 tested
* WordPress 6.0.3 Tested

#### 5.6.6 28/09/2022

* FIXED – CART & CHECKOUT – Checkout Core Fields – Fixed checkout form design issues.
* FIXED – PAYMENT GATEWAYS – Gateways Min/Max Amounts – Fixed showing all payment gateways notice on the checkout page.
* FIXED – BUTTON & PRICE LABELS – Custom Price Labels- Escape the HTML content from the “per page product meta box” value.
* FIXED – EMAILS & MISC. – Reports- Fixed date range filter on product sale report.
* FIXED – EMAILS & MISC. – Export – Fixed export order line break issue in this module.
* FIXED – PHP Fatal error: Uncaught TypeError: Unsupported operand types: string in /includes/class-wcj-multicurrency.php…
* WooCommerce 6.9.4 tested
* WordPress 6.0.2 Tested

#### 5.6.5 12/09/2022

* FIXED – Fatal Error: Cannot redeclare \_load\_plugin\_class()
* FIXED – Fatal Error: Uncaught TypeError: implode(): Argument #1 ($pieces)….tracking/class-plugin-usage-tracker.php:413
* FIXED – PHP Notice: Undefined index: wcj-cat in includes/admin/class-wc-settings-jetpack.php on line 203

#### 5.6.4 05/09/2022

* FIXED – CART & CHECKOUT – Checkout Files Upload – Fixed critical error on this module.
* FIXED – CART & CHECKOUT – Checkout Fees – Fixed issue with fee applicable with checkout custom field in checkout page.
* FIXED – EMAILS & MISC. – Modules By User Roles – Fixed confict with SMTP Plugins.
* FIXED – EMAILS & MISC. – Modules By User Roles – Fixed critical error in network websites.
* FIXED – PHP Warning: Undefined index “switcher\_type” in /includes/includes/widgets/class-wcj-widget-multicurrency.php…
* FIXED – PHP Fatal error : Uncaught TypeError: in /includes/exchange-rates/class-wcj-exchange-rates-crons.php…
* WooCommerce 6.8.2 tested
* WordPress 6.0.2 Tested

#### 5.6.3 31/08/2022

* NEW FEATURE – PDF INVOICING & PACKING SLIPS – PDF Invoicing – Added a new shortcode for refund total with inc./ex. tax. [wcj\_order\_item\_total\_refunded excl\_tax=”yes” ]
* FIXED – SHIPPING & ORDERS – Order Custom Statuses – Fixed custom status not displaying in order bulk action selection.
* FIXED – PRODUCTS – Product Tabs – Fixed issue with HTML tags.
* FIXED – PRODUCTS – Product Tabs – Fixed issue in some cases Jquery syntax was being shown.
* FIXED – PRODUCTS – Product Visibility by User Role – Fixed allowed user role selection on the single product edit page.
* FIXED – PRODUCTS – Product Visibility by Country – Fixed allowed country selection on the single product edit page.
* FIXED – PRODUCTS – Cost of Goods – Fixed bugs related to reporting, profit, and other bugs.
* FIXED – CART & CHECKOUT – Mini Cart Custom Info – Fixed Custom Info is not shown on the Wocommarce mini cart.
* FIXED – BUTTON & PRICE LABELS – Free Price Labels – Fixed free price Label does not show when the product price is ‘0’.
* FIXED – CART & CHECKOUT – Checkout Files Upload – Escaped the html content from the “File Upload Fields” value.
* FIXED – EMAILS & MISC. – Modules By User Roles – Fixed Enable/disable modules by user roles.
* FIXED – PRODUCTS – Product Addons – Fixed add-ons were not being saved with per product add-on.
* FIXED – PRODUCTS – Product Input Fields – Fixed issue with input type radio for per product input field.
* FIXED – PDF INVOICING & PACKING SLIPS – PDF Invoicing – Fixed Invoice report tool was showing an error while choosing the CSV option.
* FIXED – EMAILS & MISC. – My Account – Added restriction for Cross browser scripting.
* FIXED – PHP Warning: Undefined Variable “$exclude\_item\_subtotal” in /includes/shortcodes/class-wcj-shortcodes-orders.php …
* WooCommerce 6.8.2 tested
* WordPress 6.0.1 Tested

#### 5.6.2 27/07/2022

* NEW FEATURE – PDF INVOICING & PACKING SLIPS – PDF Invoicing – Added a new shortcode Attribute to exclude tax in order to refund the Total. [wcj\_order\_shipping\_price excl\_tax=”yes” ]
* FIXED – SHIPPING & ORDERS – Maximum Products per User – Remove Max product per user meta from product while duplicating Product.
* FIXED – EMAILS & MISC. – Export – Escape the html content from the “Additional Export Orders Fields” value.
* FIXED – EMAILS & MISC. – Export – Array to string conversion for the “Additional Export Products Fields” value.
* FIXED – PHP Warning: Undefined array key “path” in /includes/functions/wcj-functions-booster-core.php …
* FIXED – Added Security vulnerability fixes.
* WooCommerce 6.7.0 tested
* WordPress 6.0.1 tested

#### 5.6.1 01/07/2022

* FIXED – PRODUCTS – User Products – Fixed Fatal Error: Uncaught Error: Cannot access protected property XXX::$id.
* FIXED – PRODUCTS – Tax Display – Fixed Price displayed without taxes as default
* FIXED – PRODUCTS – Price based on User Role – Parse error: syntax error, unexpected ‘)’ in …/includes/class-wcj-price-by-user-role.php on line 417.
* FIXED – PRICES & CURRENCIES – Product Open Pricing (Name Your Price) – Allowing cents to Min, Max & Default input box
* FIXED – PRICES & CURRENCIES – Bulk Price Converter – PHP Notice: Undefined index: bulk\_change\_prices\_preview…
* FIXED – PRICES & CURRENCIES – Global Discount – Fixed Include/Exclude Product Categories, Tags, Products options
* FIXED – PHP Notice: Undefined variable: old\_option …
* FIXED – Added Security vulnerability fixes.

#### 5.6.0 29/06/2022

* FIXED – PRICES & CURRENCIES – Wholesale Price – Fixed debug.log warning.
* FIXED – PAYMENT GATEWAYS – Gateways Fees and Discounts – Updated the payment fee calculation.
* FIXED – PRODUCTS – User Products – Fixed conflict with product owner notification.
* FIXED – Added Security vulnerability fixes.
* WooCommerce 6.6.1 tested
* WordPress 6.0 tested

#### 5.5.9 31/05/2022

* FIXED – Added Security vulnerability fixes.
* WooCommerce 6.5.1 tested
* WordPress 6.0 tested

#### 5.5.8 25/05/2022

* NEW FEATURE – PRODUCTS – User Products – Send an email to the product owner when a product has been sold.
* NEW FEATURE – PAYMENT GATEWAYS – Gateways Fees and Discounts – Added a new feature to apply Payment Gateways Fees by User role.
* FIXED – PRICES & CURRENCIES – Prices and Currencies by Country – Added Compatibility with Webtofee subscription Plugin.
* FIXED – PRICES & CURRENCIES – Wholesale Price – Exclude/Include product issues that have been fixed in the Wholesale Price Module.
* FIXED – PRODUCTS – Add to Cart – Fixed an issue with default variations add to the cart module.
* WooCommerce 6.5.1 tested
* WordPress 6.0 tested

#### 5.5.7 27/04/2022

* NEW FEATURE – PDF INVOICING & PACKING SLIPS – PDF Invoicing – Added new shortcode to show 0 VAT message. [wcj\_order\_vat\_func vat\_exempt\_text=’ ‘]
* FIXED – PDF INVOICING & PACKING SLIPS – PDF Invoicing – Bulk and auto-generate number sequence issue has been fixed.
* FIXED – PRICES & CURRENCIES- Prices and Currencies by Country – Added Compatibility of B2B King wholesale prices.
* FIXED – PRODUCT- Product Tabs – WPML issue with global product tabs.
* FIXED – PAYMENT GATEWAYS – Gateways Fees and Discounts – Updated the payment fee calculation
* WooCommerce 6.4.1 tested
* WordPress 5.9.3 tested

#### 5.5.6 30/03/2022

* Fix – PRODUCTS – Product Addons – Fixed add-on issue with add-on by variation feature.
* Fix – PRICES & CURRENCIES – Prices and Currencies by Country – Fixed IP detection issue with Booster method.
* Fix – PRICES & CURRENCIES – Currency – Fixed the input field addition …

## Meta

* Version **7.2.4**
* Last updated **2 months ago**
* Active installations **40,000+**
* WordPress version **5.8 or higher**
* Tested up to **6.6.2**
* PHP version **7.2 or higher**
* Languages
  See all 13

  Close

  [Dutch](https://nl.wordpress.org/plugins/woocommerce-jetpack/), [English (Australia)](https://en-au.wordpress.org/plugins/woocommerce-jetpack/), [English (Canada)](https://en-ca.wordpress.org/plugins/woocommerce-jetpack/), [English (UK)](https://en-gb.wordpress.org/plugins/woocommerce-jetpack/), [English (US)](https://wordpress.org/plugins/woocommerce-jetpack/), [Esperanto](https://eo.wordpress.org/plugins/woocommerce-jetpack/), [Japanese](https://ja.wordpress.org/plugins/woocommerce-jetpack/), [Russian](https://ru.wordpress.org/plugins/woocommerce-jetpack/), [Spanish (Colombia)](https://es-co.wordpress.org/plugins/woocommerce-jetpack/), [Spanish (Ecuador)](https://es-ec.wordpress.org/plugins/woocommerce-jetpack/), [Spanish (Mexico)](https://es-mx.wordpress.org/plugins/woocommerce-jetpack/), [Spanish (Spain)](https://es.wordpress.org/plugins/woocommerce-jetpack/), and [Spanish (Venezuela)](https://ve.wordpress.org/plugins/woocommerce-jetpack/).

  [Translate into your language](https://translate.wordpress.org/projects/wp-plugins/woocommerce-jetpack)
* Tags [ecommerce plugin](https://wordpress.org/plugins/tags/ecommerce-plugin/)[woocommerce bundle](https://wordpress.org/plugins/tags/woocommerce-bundle/)[WooCommerce customization](https://wordpress.org/plugins/tags/woocommerce-customization/)[WooCommerce Integration](https://wordpress.org/plugins/tags/woocommerce-integration/)[woocommerce product addon](https://wordpress.org/plugins/tags/woocommerce-product-addon/)
* [Advanced View](https://wordpress.org/plugins/woocommerce-jetpack/advanced/)

## Ratings

4.6 out of 5 stars.

* [445 5-star reviews
  5 stars

  445](https://wordpress.org/support/plugin/woocommerce-jetpack/reviews/?filter=5)
* [13 4-star reviews
  4 stars

  13](https://wordpress.org/support/plugin/woocommerce-jetpack/reviews/?filter=4)
* [10 3-star reviews
  3 stars

  10](https://wordpress.org/support/plugin/woocommerce-jetpack/reviews/?filter=3)
* [15 2-star reviews
  2 stars

  15](https://wordpress.org/support/plugin/woocommerce-jetpack/reviews/?filter=2)
* [35 1-star reviews
  1 star

  35](https://wordpress.org/support/plugin/woocommerce-jetpack/reviews/?filter=1)

[Add my review](https://wordpress.org/support/plugin/woocommerce-jetpack/reviews/#new-post)

[See all reviews](https://wordpress.org/support/plugin/woocommerce-jetpack/reviews/)

## Contributors

* ![](https://secure.gravatar.com/avatar/142252ee343add2d89477553ab93349df22dfd14411c0fd3fd2ae56cf3bf3e61?s=32&d=mm&r=g) [Pluggabl](https://profiles.wordpress.org/pluggabl/)
## Support

Issues resolved in last two months:

6 out of 11

[View support forum](https://wordpress.org/support/plugin/woocommerce-jetpack/)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Privacy](https://wordpress.org/about/privacy/)

* [Showcase](https://wordpress.org/showcase/)
* [Themes](https://wordpress.org/themes/)
* [Plugins](https://wordpress.org/plugins/)
* [Patterns](https://wordpress.org/patterns/)

* [Learn](https://learn.wordpress.org/)
* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [WordPress.tv ↗](https://wordpress.tv/)

* [Get Involved](https://make.wordpress.org/)
* [Events](https://events.wordpress.org/)
* [Donate ↗](https://wordpressfoundation.org/donate/)
* [Five for the Future](https://wordpress.org/five-for-the-future/)

* [WordPress.com ↗](https://wordpress.com/?ref=wporg-footer)
* [Matt ↗](https://ma.tt/)
* [bbPress ↗](https://bbpress.org/)
* [BuddyPress ↗](https://buddypress.org/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our X (formerly Twitter) account](https://www.x.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)
* [Visit our YouTube channel](https://www.youtube.com/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)



=== Content from www.wordfence.com_813d78e6_20250110_141727.html ===


[![](https://www.wordfence.com/img/wordfence-intelligence-logo.svg)](/threat-intel/)

Have you found a vulnerability in a WordPress plugin or theme? Report vulnerabilities in WordPress plugins and themes through our [bug bounty program](https://www.wordfence.com/threat-intel/bug-bounty-program) and earn a bounty on all in-scope submissions, while we handle the responsible disclosure process on your behalf.

As a reminder, the Wordfence Intelligence Vulnerability Database API is completely free to query and utilize, both personally and commercially, and contains all the same vulnerability data as the user interface. Please review the API documentation and Webhook documentation for more information on how to query the vulnerability API endpoints and configure webhooks utilizing all the same data present in the Wordfence Intelligence user interface.

# Elite Booster for WooCommerce <= 7.1.7 - Authenticated (Subscriber+) Arbitrary File Upload

 [Wordfence Intelligence](https://www.wordfence.com/threat-intel)   >    [Vulnerability Database](https://www.wordfence.com/threat-intel/vulnerabilities)   >   Elite Booster for WooCommerce <= 7.1.7 - Authenticated (Subscriber+) Arbitrary File Upload

8.8

**Unrestricted Upload of File with Dangerous Type**
**CVSS Vector**
[CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H)

| CVE | [CVE-2024-1986](https://www.cve.org/CVERecord?id=CVE-2024-1986) |
| --- | --- |
| CVSS | 8.8 (High) |
| Publicly Published | March 7, 2024 |
| Last Updated | March 7, 2024 |
| Researcher | [Christiaan Swiers (YouGina)](https://www.wordfence.com/threat-intel/vulnerabilities/researchers/christiaan-swiers) |

### Description

The Booster Elite for WooCommerce plugin for WordPress is vulnerable to arbitrary file uploads due to missing file type validation in the wc\_add\_new\_product() function in all versions up to, and including, 7.1.7. This makes it possible for customer-level attackers, and above, to upload arbitrary files on the affected site's server which may make remote code execution possible. This is only exploitable when the user product upload functionality is enabled.

#### References

* [plugins.trac.wordpress.org](https://plugins.trac.wordpress.org/browser/woocommerce-jetpack/trunk/includes/shortcodes/class-wcj-products-add-form-shortcodes.php#L322)
* [plugins.trac.wordpress.org](https://plugins.trac.wordpress.org/browser/woocommerce-jetpack/trunk/includes/shortcodes/class-wcj-products-add-form-shortcodes.php#L333)
* [plugins.trac.wordpress.org](https://plugins.trac.wordpress.org/browser/woocommerce-jetpack/trunk/includes/shortcodes/class-wcj-products-add-form-shortcodes.php#L132)
* [plugins.trac.wordpress.org](https://plugins.trac.wordpress.org/browser/woocommerce-jetpack/trunk/includes/shortcodes/class-wcj-products-add-form-shortcodes.php#L138)
* [booster.io](https://booster.io/)
* [wordpress.org](https://wordpress.org/plugins/woocommerce-jetpack/)

#### Share

[Facebook](https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fbooster-elite-for-woocommerce%2Felite-booster-for-woocommerce-717-authenticated-subscriber-arbitrary-file-upload&t=Elite%20Booster%20for%20WooCommerce%20%20%3C%3D%207.1.7%20-%20Authenticated%20%28Subscriber%2B%29%20Arbitrary%20File%20Upload "Facebook")
[Twitter](https://twitter.com/share?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fbooster-elite-for-woocommerce%2Felite-booster-for-woocommerce-717-authenticated-subscriber-arbitrary-file-upload&text=Elite%20Booster%20for%20WooCommerce%20%20%3C%3D%207.1.7%20-%20Authenticated%20%28Subscriber%2B%29%20Arbitrary%20File%20Upload "Twitter")
[LinkedIn](https://www.linkedin.com/shareArticle?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fbooster-elite-for-woocommerce%2Felite-booster-for-woocommerce-717-authenticated-subscriber-arbitrary-file-upload "LinkedIn")
Email

## Vulnerability Details for Booster Elite for WooCommerce

#### [Booster Elite for WooCommerce](https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/booster-elite-for-woocommerce)

| Software Type | Plugin |
| --- | --- |
| Software Slug | booster-elite-for-woocommerce |
| Patched? | Yes |
| Remediation | Update to version 7.1.8, or a newer patched version |
| Affected Version | * <= 7.1.7 |
| Patched Version | * 7.1.8 |

This record contains material that is subject to copyright.

**Copyright 2012-2025 Defiant Inc.**

**License:**
Defiant hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute this software vulnerability information. Any copy of the software vulnerability information you make for such purposes is authorized provided that you include a hyperlink to this vulnerability record and reproduce Defiant's copyright designation and this license in any such copy.
**[Read more.](https://www.wordfence.com/wordfence-intelligence-terms-and-conditions/)**

**Copyright 1999-2025 The MITRE Corporation**

**License:**
CVE Usage: MITRE hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute Common Vulnerabilities and Exposures (CVE®). Any copy you make for such purposes is authorized provided that you reproduce MITRE's copyright designation and this license in any such copy.
**[Read more.](https://www.cve.org/Legal/TermsOfUse)**

Have information to add, or spot any errors? Contact us at wfi-support@wordfence.com so we can make any appropriate adjustments.

Did you know Wordfence Intelligence provides free personal and commercial API access to our comprehensive WordPress vulnerability database, along with a free webhook integration to stay on top of the latest vulnerabilities added and updated in the database? Get started today!

Learn more

Want to get notified of the latest vulnerabilities that may affect your WordPress site?
 Install Wordfence on your site today to get notified immediately if your site is affected by a vulnerability that has been added to our database.

Get Wordfence

The Wordfence Intelligence WordPress vulnerability database is completely free to access and query via API. Please review the documentation on how to access and consume the vulnerability data via API.

Documentation



=== Content from booster.io_d64b4346_20250110_141716.html ===


[0](/cart/)

Search

×

Toggle navigation

[![Booster for WooCommerce](https://booster.io/wp-content/uploads/Booster-Latest-Logo-586x100-1.webp)](https://booster.io/)

* [Features](https://booster.io/category/features/)
  + [New Features](https://booster.io/category/features/newfeatures/)
    - [Reviews for WooCommerce](https://booster.io/features/woocommerce-reviews/)
    - [Sales Notifications for WooCommerce](https://booster.io/features/woocommerce-sales-notifications/)
    - [Login to See Pricing for WooCommerce](https://booster.io/features/woocommerce-login-to-see-pricing/)
    - [Best Price for WooCommerce](https://booster.io/features/woocommerce-best-price/)
    - [Subscription Customization](https://booster.io/features/woocommerce-subscription-customization/)
    - [Abandoned Cart Recovery for WooCommerce](https://booster.io/features/woocommerce-cart-abandonment/)
    - [Product Variation Swatches for WooCommerce](https://booster.io/features/woocommerce-product-variation-swatches/)
    - [Wishlist Plugin for WooCommerce](https://booster.io/features/woocommerce-wishlist/)
    - [Frequently Bought Together](https://booster.io/features/cart-checkout/woocommerce-frequently-bought-together/)
    - [One Page Checkout](https://booster.io/features/cart-checkout/woocommerce-one-page-checkout/)
    - [Product Extra Fees](https://booster.io/features/woocommerce-product-extra-fees/)
  + [Prices & Currencies](https://booster.io/category/features/prices-currencies/)
    - [All Currencies](https://booster.io/features/woocommerce-all-currencies/)
    - [Bulk Price Converter](https://booster.io/features/woocommerce-bulk-price-converter/)
    - [Currency Exchange Rates](https://booster.io/features/woocommerce-currency-exchange-rates/)
    - [Currency for External Products](https://booster.io/features/woocommerce-currency-for-external-products/)
    - [Currency per Product](https://booster.io/features/woocommerce-currency-per-product/)
    - [Multicurrency (Currency Switcher)](https://booster.io/features/woocommerce-multicurrency-currency-switcher/)
    - [Multicurrency Product Base Price](https://booster.io/features/woocommerce-multicurrency-product-base-price/)
    - [Offer Your Price](https://booster.io/features/woocommerce-offer-your-product-price/)
    - [View All](/category/features/prices-currencies/)
  + [Button & Price Labels](https://booster.io/category/features/price-button-labels/)
    - [Add to Cart Labels](https://booster.io/features/woocommerce-add-to-cart-labels/)
    - [Call for Price](https://booster.io/features/woocommerce-call-for-price/)
    - [Custom Price Labels](https://booster.io/features/woocommerce-custom-price-labels/)
    - [Free Price Labels](https://booster.io/features/woocommerce-free-price-labels/)
    - [More Button Labels](https://booster.io/features/woocommerce-more-button-labels/)
  + [Shortcodes](https://booster.io/category/shortcodes/)
    - [Cart](https://booster.io/category/shortcodes/cart/)
    - [General](https://booster.io/category/shortcodes/general/)
    - [Invoices](https://booster.io/category/shortcodes/invoices/)
    - [WooCommerce Orders Shortcodes](https://booster.io/category/shortcodes/orders-shortcodes/)
    - [WooCommerce Products Shortcodes](https://booster.io/category/shortcodes/products-shortcodes/)
    - [Products Crowdfunding](https://booster.io/category/shortcodes/products-crowdfunding/)
  + [Products](https://booster.io/category/features/products/)
    - [Product Extra Fees](https://booster.io/features/woocommerce-product-extra-fees/)
    - [Add to Cart Button Visibility](https://booster.io/features/woocommerce-add-to-cart-button-visibility/)
    - [Admin Products List](https://booster.io/features/woocommerce-admin-products-list/)
    - [Bookings](https://booster.io/features/woocommerce-bookings/)
    - [Cost of Goods](https://booster.io/features/woocommerce-cost-of-goods/)
    - [Cross-sells](https://booster.io/features/woocommerce-cross-sells/)
    - [Crowdfunding](https://booster.io/features/woocommerce-crowdfunding/)
    - [Custom Product Tabs](https://booster.io/features/woocommerce-custom-product-tabs/)
    - [Product Add to Cart](https://booster.io/features/woocommerce-product-add-to-cart/)
    - [View All](https://booster.io/category/features/products/)
  + [Cart & Checkout](https://booster.io/category/features/cart-checkout/)
    - [Wishlist Plugin for WooCommerce](https://booster.io/features/woocommerce-wishlist/)
    - [Frequently Bought Together](https://booster.io/features/cart-checkout/woocommerce-frequently-bought-together/)
    - [One Page Checkout](https://booster.io/features/cart-checkout/woocommerce-one-page-checkout/)
    - [Cart Custom Info](https://booster.io/features/woocommerce-cart-custom-info/)
    - [Cart Customization](https://booster.io/features/woocommerce-cart-customization/)
    - [Checkout Core Fields](https://booster.io/features/woocommerce-checkout-core-fields/)
    - [Checkout Custom Fields](https://booster.io/features/woocommerce-checkout-custom-fields/)
    - [Checkout Custom Info](https://booster.io/features/woocommerce-checkout-custom-info/)
    - [Checkout Customization](https://booster.io/features/woocommerce-checkout-customization/)
    - [Checkout Fees](https://booster.io/features/woocommerce-checkout-fees/)
    - [Checkout Files Upload](https://booster.io/features/woocommerce-checkout-files-upload/)
    - [View all](https://booster.io/category/features/cart-checkout/)
  + [Payment Gateways](https://booster.io/category/features/payment-gateways/)
    - [Custom Payment Gateways](https://booster.io/features/woocommerce-custom-payment-gateways/)
    - [Payment Gateways by Country or State](https://booster.io/features/woocommerce-payment-gateways-by-country-or-state/)
    - [Payment Gateways by Currency](https://booster.io/features/woocommerce-payment-gateways-by-currency/)
    - [Payment Gateways by Shipping](https://booster.io/features/woocommerce-payment-gateways-by-shipping/)
    - [Payment Gateways by User Role](https://booster.io/features/woocommerce-payment-gateways-by-user-role/)
    - [Payment Gateways Currency Converter](https://booster.io/features/woocommerce-payment-gateways-currency-converter/)
    - [Payment Gateways Fees and Discounts](https://booster.io/features/woocommerce-payment-gateways-fees-and-discounts/)
    - [Payment Gateways Icons](https://booster.io/features/woocommerce-payment-gateways-icons/)
    - [View all](https://booster.io/category/features/payment-gateways/)
  + [Orders & Shipping](https://booster.io/category/features/orders-shipping/)
    - [Address Formats](https://booster.io/features/woocommerce-address-formats/)
    - [Admin Orders List](https://booster.io/features/woocommerce-admin-orders-list/)
    - [Custom Order Numbers](https://booster.io/features/woocommerce-custom-order-numbers/)
    - [Custom Shipping](https://booster.io/features/woocommerce-custom-shipping/)
    - [Left to Free Shipping](https://booster.io/features/woocommerce-left-to-free-shipping/)
    - [Maximum Products per User](https://booster.io/features/woocommerce-maximum-products-per-user/)
    - [Order Custom Statuses](https://booster.io/features/woocommerce-order-custom-statuses/)
    - [Order Min/Max Quantities](https://booster.io/features/woocommerce-order-min-max-quantities/)
    - [View all](https://booster.io/category/features/orders-shipping/)
  + [Emails and Additional Tools](https://booster.io/category/features/emails-misc/)
    - [Admin Bar](https://booster.io/features/woocommerce-admin-bar/)
    - [Booster Admin Tools](https://booster.io/features/woocommerce-booster-admin-tools/)
    - [Booster Custom CSS](https://booster.io/features/woocommerce-booster-custom-css/)
    - [Booster Custom JS](https://booster.io/features/woocommerce-booster-custom-js/)
    - [Booster Custom PHP](https://booster.io/features/woocommerce-booster-custom-php/)
    - [Booster Debug Tools](https://booster.io/features/woocommerce-booster-debug-tools/)
    - [Booster General Tools](https://booster.io/features/woocommerce-booster-general-tools/)
    - [Booster Modules By User Roles](https://booster.io/features/woocommerce-booster-modules-by-user-roles/)
    - [View all](https://booster.io/category/features/emails-misc/)
  + [WooCommerce PDF Invoicing](https://booster.io/woocommerce-pdf-invoicing-and-packing-slips/)
* [Blog](/blog/)
* [Testimonials](/reviews/)
* [Contact us](/contact-support/)
* [About Booster](/about/)
* [Get Booster Now](/buy-booster/)

# The all-in-one Toolkit to Supercharge your WooCommerce Site.

Booster helps 100,000+ website owners increase sales, engage visitors and more. Save time and money with ready-to-use solutions in our lighting-fast plugin!

[![Vector](/wp-content/uploads/Vector.webp)
Get Booster Now](/buy-booster/)

![30 day money back guarantee](/wp-content/uploads/30day-guarantee-1-1.webp)

30 Day Money Back Guarantee

![400+ 5-Star Reviews on WordPress.org](/wp-content/uploads/wp-logo-svg.webp)

400+ 5-Star Reviews

![Trusted by 100,000+ websites](/wp-content/uploads/trusted_icon_new-svg.webp)

Trusted by 100,000+ Websites

#### Recommended By:

* ![wpmayor](/wp-content/uploads/WP-mayor-1.webp)
* ![wpbeginner](/wp-content/uploads/logo-wpbeginner.webp)
* ![businessbloomer](/wp-content/uploads/logo-businessbloomer.webp)

* [Features](#customize-icon)
* [Reviews](#testimonial-slider)
* [Why Choose Booster?](#why-choose)
* [FAQ](#faq-section)

## Boost your WooCommerce store

Booster has over 100 features, but since it allows you to enable only what you need, customization is a breeze. And no coding is required, so you can easily run a WooCommerce website without much experience. With one plugin instead of a dozen or more, Booster stands out from the crowd!

### Ready to take your WooCommerce business to the next level?Here are the top features:

![pdf_icon](/wp-content/uploads/pdf_ic.webp)

#### PDF Invoicing and Packing Slips

Create professional WooCommerce PDF invoices and packing slips with your branding to streamline your orders [Learn more](/woocommerce-pdf-invoicing-and-packing-slips/)

![prices_currency_icon](/wp-content/uploads/price_currency.webp)

#### Prices and Currencies

Display products in different currencies with automatic exchange rates and define price rules. [Learn more](/category/features/prices-currencies/)

![addons_icon](/wp-content/uploads/addons.webp)

#### Product Addons

Use the WooCommerce Product Addons module to customize products or create automatic discounts. [Learn more](/features/woocommerce-product-addons/)

![payment-gateway_icon](/wp-content/uploads/payment-gateway.webp)

#### Payment Gateways

Customize WooCommerce payment gateways based on currency, shipping method, country. [Learn more](/category/features/payment-gateways/)

![prodcut_input_icon](/wp-content/uploads/prodcut_input.webp)

#### Product Input Fields

Enable custom input fields so customers can provide more details about their order (like gift-wrapping or different sizes). [Learn more](/features/woocommerce-product-input-fields/)

![cart_checkout_icon](/wp-content/uploads/cart_checkout.webp)

#### Cart and Checkout

Customize the checkout experience with WooCommerce custom fields, like coupon codes and checkout fees. [Learn more](/category/features/cart-checkout/)

![button_label_icon](/wp-content/uploads/button_label.webp)

#### Button and Price Labels

The Button and Price Labels module lets you add customized buttons and price labels to your products. [Learn more](/features/woocommerce-free-price-labels/)

![email_tool_icon](/wp-content/uploads/email_tool.webp)

#### Emails & Additional Tools

Add custom emails and additional recipients. Generate various reports and include verification for increased security. [Learn more](/category/features/emails-misc/)

[Get Booster Now](/buy-booster/)

## Booster does a lot... and we're just getting started!

Prices and Currencies by Country

![](/wp-content/uploads/image-two.webp)

Frequently Bought Together

![](/wp-content/uploads/image-three.webp)

Product Extra Fees

![](/wp-content/uploads/image-four.webp)

One Page Checkout

![](/wp-content/uploads/image-five.webp)

EU VAT Number

![](/wp-content/uploads/image-six.webp)

Export Tools

![](/wp-content/uploads/image-seven.webp)

Custom Order Numbers

![](/wp-content/uploads/image-eight.webp)

Left to Free Shipping

![](/wp-content/uploads/image-nine.webp)

Custom Product Tabs

![](/wp-content/uploads/image-ten.webp)

SKU

![](/wp-content/uploads/image-eleven.webp)

Crowdfunding

![](/wp-content/uploads/image-twelve.webp)

Cost of Goods

![](/wp-content/uploads/image-thirteen.webp)

Products XML Feeds

![](/wp-content/uploads/image-fourteen.webp)

Upsells

![](/wp-content/uploads/image-fifteen.webp)

Cross-sells

![](/wp-content/uploads/image-sixteen.webp)

## Here’s What Our Happy Customers Are Saying...

![](/wp-content/uploads/Ellipsetwo.webp)

![](/wp-content/uploads/Ellipsethree.webp)

![](/wp-content/uploads/Ellipseone.webp)

## laughingbuddha

I highly recommend it, it’s the first plugin I install for all WooCommerce stores.
## Lawrence M

For anyone using WooCommerce, Booster For WooCommerce is a must have plugin.
## Walter

This plugin is amazing!
## Patrick Horemans

Many modules, fast support and best of all, it does not slowdown anything!
## Rashmi

Great plugin. Package of a number of solutions. Well done !!
## GlobalAffects

nicely done - a HUGE ASSET TO MY WOOCOMMERCE TOOL KIT - especially for "non-coder" woocommerce shop cart designers! OMG - it's an awesome tool!!
## Claes

Excellent!!!
## Melania

Excellent collection of plugins, bring your WooCommerce to a super PRO level... awesome! Nice work!!

## Why Choose Booster for WooCommerce?

![why](https://booster.io/wp-content/uploads/why_two.webp)

### Easy to Set Up and Use

The Booster plugin is easy to install, configure, and learn how to use. Should you require any assistance, we provide documentation for each of the modules, plenty of video tutorials on YouTube, and an excellent, fast-responding
customer service team.

![why](https://booster.io/wp-content/uploads/why_four.webp)

### Saves Time

Because Booster for WooCommerce is so easy to use, it shortens the learning curve from having to familiarize yourself with multiple plugins, thereby reducing bottlenecks in your workflow and saving you time. , for any support issue,
you save additional time by only needing to get in touch with one instead of 10-15 vendors.
.

![why](https://booster.io/wp-content/uploads/why_seven.webp)

### Complete Compatibility with WooCommerce

Banish the slowdown woes of 10-15+ plugins by downloading a single plugin. Because all the modules are part of the same plugin, this avoids any conflict issues. And rest assured – our plugin has a 99% compatibility with other
plugins/themes.

![why](/wp-content/uploads/why_three.webp)

### Feature-Rich Plugin

Booster has been called the “Swiss Army Knife” of modules, with 100+ options to customize and extend any WooCommerce website. But are all these features really necessary? Well, because Booster has modular architecture,
you have the option to enable only what you want (so no web bloat or personal overwhelm). And we are still adding new features to our already robust plugin to make it even easier to fully customize your WooCommerce store!

![why](/wp-content/uploads/why_six.webp)

### Cost Effective

There's no need to pay for a bunch of expensive, single-function plugins that bog down your site. Typically, customers who use Booster wind up replacing 10-15 (and sometimes as many as 45!) other plugins, [saving you over $1200+](https://booster.io/wp-content/uploads/Booster-vs-Competition-Infographic-scaled.jpg)
per year for a single site, this plugin is worth every penny – and then some!

![why](/wp-content/uploads/why_five.webp)

### No Coding Required

Customizing your WooCommerce site shouldn’t require any coding knowledge. You’re a business owner, not a software developer! With this easy-to-use WooCommerce plugin, you can implement customizations quickly to get the full
functionality you want for your online store without writing a single line of code.

![why](/wp-content/uploads/why_eight.webp)

### Improving WooCommerce Since 2014

With more than 2 million downloads, 400+ 5-star reviews, and a 30-day, risk-free, money-back guarantee, Booster for WooCommerce has earned a reputation for reliability, quality, and commitment to serving our customers.
Booster outshines the competition and boasts tons of happy business owners. But don’t take our word for it – check out our [customer reviews!](https://booster.io/reviews/)

![why](/wp-content/uploads/why_one.webp)

### Top-Notch Customer Service Team

Everyone needs a little help now and again, and as a Booster customer, you'll always have the support of our world-class customer service team. When technical challenges arise, just submit a ticket to report the issue
to our team – we respond to every inquiry within 24 business hours.

"Really really good. Great, rich functionality. Very easy to configure."

[- Customer Review](https://wordpress.org/support/topic/just-found-it-and-its-excellent/)

## Transform Your WooCommerce Store with One Click. Explore Booster now!

[Get Booster](/buy-booster/)

## Frequently Asked Questions and Resources

### What’s required to use Booster ?

Booster is a WordPress plugin. In order to use Booster , you must have a self-hosted WordPress site. That’s all.

### Do I need to have coding skills to use Booster ?

Absolutely not. You can configure pretty much everything Booster has to offer without any coding knowledge.

### Will Booster slow down my website?

Absolutely not. Booster is carefully built with performance in mind.

### Do you offer refunds?

If you are not completely satisfied with Booster within the fist 30 days, you can request a refund and we will give you 100% of your money back – no questions asked.

### Can I use Booster on client sites?

Yes, you can use Booster on client sites. You can purchase the multiple sites license of Booster .

### Do you have an affiliate program?

Yes, We do have an affiliate program. [Click here](/affiliate-program/) for the details.

### Why should I choose the Booster suite over other individual plugins?

Oh, that's an easy one! Implementing just a few modules from the Booster suite is more cost-effective than using dozens of individual plugins often priced at $15-$30 each. On top of that, stacking your site with a lot of different plugins can make
it bloated and slow. What's worse, all those individual plugins don't always play nice together. But Booster is the solution to all that nonsense. The Booster suite features over 100 compatible modules that allow
you to add custom features and functionality to your WooCommerce site easily.

### What features does Booster have?

You can see all the features at  [About Booster](/about/) page.

### Company

* [About Us](/about-us/)
* [Contact Us](https://booster.io/contact-support/)
* [Reviews](/reviews/)
* [FAQs](https://booster.io/faqs/)
### Connect with us

[Get Booster Now](/buy-booster/)
### Top Features

* [Subscription Customization](https://booster.io/features/woocommerce-subscription-customization/)
* [Product Variation Swatches](https://booster.io/features/woocommerce-product-variation-swatches/)
* [Wishlist Plugin for WooCommerce](https://booster.io/features/woocommerce-wishlist/)
* [Abandoned Cart Recovery for WooCommerce](https://booster.io/features/woocommerce-cart-abandonment/)
* [PDF Invoicing & Packing Slips](https://booster.io/woocommerce-pdf-invoicing-and-packing-slips/)
* [Product Input Fields for WooCommerce](https://booster.io/features/woocommerce-product-input-fields/)
* [Prices and Currencies](/category/features/prices-currencies/)
* [Cart and Checkout](/category/features/cart-checkout/)
* [Product Addons](https://booster.io/features/woocommerce-product-addons/)
* [Button and Price labels](/features/woocommerce-free-price-labels/)
* [Payment Gateways](/category/features/payment-gateways/)
* [Emails and Additional Tools](/category/features/emails-misc/)

### Helpful Links

* [Documentation](/docs)
* [Compare Booster Bundles](https://booster.io/booster-compare-bundles/)
* [Feature Requests](https://booster.io/feature-requests/)
* [Support forum](/forums/forum/booster-plus-forum/)
* [Refund Policy](https://booster.io/refund-policy/)
* [Booster Changelog](/changelog/)

### My Account

* [My Account](https://booster.io/my-account/)
* [Cart](https://booster.io/cart/)
* [Checkout](https://booster.io/checkout/)
### Sign Up

Copyright © 2022 Pluggabl LLC. All rights reserved
Made with  in the USA.

* [Terms and Conditions](/terms-conditions/)
* [Privacy Policy](/privacy-policy/)
* [Cookie Policy](/cookie-policy/)

This site uses cookies: Find out [more.](/cookie-policy)

Okay ,Thanks



=== Content from plugins.trac.wordpress.org_812d535c_20250110_141725.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fbrowser%2Fwoocommerce-jetpack%2Ftrunk%2Fincludes%2Fshortcodes%2Fclass-wcj-products-add-form-shortcodes.php)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Revision](/browser/woocommerce-jetpack/trunk/includes/shortcodes/class-wcj-products-add-form-shortcodes.php?rev=3046146 "Revision 3046146")
* Next Revision →
* [Blame](/browser/woocommerce-jetpack/trunk/includes/shortcodes/class-wcj-products-add-form-shortcodes.php?annotate=blame "Annotate each line with the last changed revision (this can be time consuming...)")
* [Revision Log](/log/woocommerce-jetpack/trunk/includes/shortcodes/class-wcj-products-add-form-shortcodes.php)

---

# [source:](/browser?order=name "Go to repository root") [woocommerce-jetpack](/browser/woocommerce-jetpack?order=name "View woocommerce-jetpack")/[trunk](/browser/woocommerce-jetpack/trunk?order=name "View trunk")/[includes](/browser/woocommerce-jetpack/trunk/includes?order=name "View includes")/[shortcodes](/browser/woocommerce-jetpack/trunk/includes/shortcodes?order=name "View shortcodes")/[class-wcj-products-add-form-shortcodes.php](/browser/woocommerce-jetpack/trunk/includes/shortcodes/class-wcj-products-add-form-shortcodes.php?order=name "View class-wcj-products-add-form-shortcodes.php")

View diff against:

View revision:

| [Last change](/changeset/3115290/woocommerce-jetpack/trunk/includes/shortcodes/class-wcj-products-add-form-shortcodes.php "View differences") on this file was [3115290](/changeset/3115290/ "View changeset 3115290"), checked in by ronyp, [6 months ago](/timeline?from=2024-07-10T06%3A28%3A56Z&precision=second "See timeline at 07/10/2024 06:28:56 AM") |
| --- |
| v7.1.2 |
| **File size:** 28.9 KB | |

| Line |  |
| --- | --- |
| [1](#L1) | <?php |
| [2](#L2) | /\*\* |
| [3](#L3) | \* Booster for WooCommerce - Shortcodes - Products Add Form |
| [4](#L4) | \* |
| [5](#L5) | \* @version 7.2.1 |
| [6](#L6) | \* @since   2.5.0 |
| [7](#L7) | \* @author  Pluggabl LLC. |
| [8](#L8) | \* @package Booster\_For\_WooCommerce/shortcodes |
| [9](#L9) | \*/ |
| [10](#L10) |  |
| [11](#L11) | if ( ! defined( 'ABSPATH' ) ) { |
| [12](#L12) | exit; |
| [13](#L13) | } |
| [14](#L14) |  |
| [15](#L15) | if ( ! class\_exists( 'WCJ\_Products\_Add\_Form\_Shortcodes' ) ) : |
| [16](#L16) | /\*\* |
| [17](#L17) | \* WCJ\_Products\_Add\_Form\_Shortcodes. |
| [18](#L18) | \*/ |
| [19](#L19) | class WCJ\_Products\_Add\_Form\_Shortcodes extends WCJ\_Shortcodes { |
| [20](#L20) |  |
| [21](#L21) | /\*\* |
| [22](#L22) | \* Constructor. |
| [23](#L23) | \* |
| [24](#L24) | \* @version 2.8.0 |
| [25](#L25) | \* @since   2.5.0 |
| [26](#L26) | \* @todo    refill image on not validated (or after successful addition); more messages options; more styling options; custom fields; |
| [27](#L27) | \* @todo    (maybe) `product\_id => ( isset( $\_GET['wcj\_edit\_product'] ) ? $\_GET['wcj\_edit\_product'] : 0 )` |
| [28](#L28) | \*/ |
| [29](#L29) | public function \_\_construct() { |
| [30](#L30) |  |
| [31](#L31) | $this->the\_shortcodes = array( |
| [32](#L32) | 'wcj\_product\_add\_new', |
| [33](#L33) | ); |
| [34](#L34) |  |
| [35](#L35) | $this->the\_atts = array( |
| [36](#L36) | 'product\_id'             => 0, |
| [37](#L37) | 'post\_status'            => wcj\_get\_option( 'wcj\_product\_by\_user\_status', 'draft' ), |
| [38](#L38) |  |
| [39](#L39) | 'desc\_enabled'           => wcj\_get\_option( 'wcj\_product\_by\_user\_desc\_enabled', 'no' ), |
| [40](#L40) | 'short\_desc\_enabled'     => wcj\_get\_option( 'wcj\_product\_by\_user\_short\_desc\_enabled', 'no' ), |
| [41](#L41) | 'regular\_price\_enabled'  => wcj\_get\_option( 'wcj\_product\_by\_user\_regular\_price\_enabled', 'no' ), |
| [42](#L42) | 'sale\_price\_enabled'     => wcj\_get\_option( 'wcj\_product\_by\_user\_sale\_price\_enabled', 'no' ), |
| [43](#L43) | 'external\_url\_enabled'   => wcj\_get\_option( 'wcj\_product\_by\_user\_external\_url\_enabled', 'no' ), |
| [44](#L44) | 'cats\_enabled'           => wcj\_get\_option( 'wcj\_product\_by\_user\_cats\_enabled', 'no' ), |
| [45](#L45) | 'tags\_enabled'           => wcj\_get\_option( 'wcj\_product\_by\_user\_tags\_enabled', 'no' ), |
| [46](#L46) | 'image\_enabled'          => apply\_filters( 'booster\_option', 'no', wcj\_get\_option( 'wcj\_product\_by\_user\_image\_enabled', 'no' ) ), |
| [47](#L47) |  |
| [48](#L48) | 'desc\_required'          => wcj\_get\_option( 'wcj\_product\_by\_user\_desc\_required', 'no' ), |
| [49](#L49) | 'short\_desc\_required'    => wcj\_get\_option( 'wcj\_product\_by\_user\_short\_desc\_required', 'no' ), |
| [50](#L50) | 'regular\_price\_required' => wcj\_get\_option( 'wcj\_product\_by\_user\_regular\_price\_required', 'no' ), |
| [51](#L51) | 'sale\_price\_required'    => wcj\_get\_option( 'wcj\_product\_by\_user\_sale\_price\_required', 'no' ), |
| [52](#L52) | 'external\_url\_required'  => wcj\_get\_option( 'wcj\_product\_by\_user\_external\_url\_required', 'no' ), |
| [53](#L53) | 'cats\_required'          => wcj\_get\_option( 'wcj\_product\_by\_user\_cats\_required', 'no' ), |
| [54](#L54) | 'tags\_required'          => wcj\_get\_option( 'wcj\_product\_by\_user\_tags\_required', 'no' ), |
| [55](#L55) | 'image\_required'         => apply\_filters( 'booster\_option', 'no', wcj\_get\_option( 'wcj\_product\_by\_user\_image\_required', 'no' ) ), |
| [56](#L56) |  |
| [57](#L57) | 'visibility'             => implode( ',', wcj\_get\_option( 'wcj\_product\_by\_user\_user\_visibility', array() ) ), |
| [58](#L58) | 'module'                 => 'product\_by\_user', |
| [59](#L59) | 'module\_name'            => \_\_( 'Product by User', 'woocommerce-jetpack' ), |
| [60](#L60) | ); |
| [61](#L61) |  |
| [62](#L62) | if ( 'external' !== wcj\_get\_option( 'wcj\_product\_by\_user\_product\_type', 'simple' ) ) { |
| [63](#L63) | $this->the\_atts['external\_url\_enabled']  = 'no'; |
| [64](#L64) | $this->the\_atts['external\_url\_required'] = 'no'; |
| [65](#L65) | } |
| [66](#L66) |  |
| [67](#L67) | $this->the\_atts['custom\_taxonomies\_total'] = apply\_filters( 'booster\_option', 1, wcj\_get\_option( 'wcj\_product\_by\_user\_custom\_taxonomies\_total', 1 ) ); |
| [68](#L68) | for ( $i = 1; $i <= $this->the\_atts['custom\_taxonomies\_total']; $i++ ) { |
| [69](#L69) | $this->the\_atts[ 'custom\_taxonomy\_' . $i . '\_enabled' ]  = wcj\_get\_option( 'wcj\_product\_by\_user\_custom\_taxonomy\_' . $i . '\_enabled', 'no' ); |
| [70](#L70) | $this->the\_atts[ 'custom\_taxonomy\_' . $i . '\_required' ] = wcj\_get\_option( 'wcj\_product\_by\_user\_custom\_taxonomy\_' . $i . '\_required', 'no' ); |
| [71](#L71) | $this->the\_atts[ 'custom\_taxonomy\_' . $i . '\_id' ]       = wcj\_get\_option( 'wcj\_product\_by\_user\_custom\_taxonomy\_' . $i . '\_id', '' ); |
| [72](#L72) | $this->the\_atts[ 'custom\_taxonomy\_' . $i . '\_title' ]    = wcj\_get\_option( 'wcj\_product\_by\_user\_custom\_taxonomy\_' . $i . '\_title', '' ); |
| [73](#L73) | } |
| [74](#L74) |  |
| [75](#L75) | parent::\_\_construct(); |
| [76](#L76) | } |
| [77](#L77) |  |
| [78](#L78) | /\*\* |
| [79](#L79) | \* Init\_atts. |
| [80](#L80) | \* |
| [81](#L81) | \* @version 7.2.1 |
| [82](#L82) | \* @param array $atts The user defined shortcode attributes. |
| [83](#L83) | \*/ |
| [84](#L84) | public function init\_atts( $atts ) { |
| [85](#L85) | $atts['product\_id']              = (int) wcj\_sanitize\_input\_attribute\_values( $atts['product\_id'] ); |
| [86](#L86) | $atts['post\_status']             = wcj\_sanitize\_input\_attribute\_values( $atts['post\_status'] ); |
| [87](#L87) | $atts['desc\_enabled']            = wcj\_sanitize\_input\_attribute\_values( $atts['desc\_enabled'] ); |
| [88](#L88) | $atts['short\_desc\_enabled']      = wcj\_sanitize\_input\_attribute\_values( $atts['short\_desc\_enabled'] ); |
| [89](#L89) | $atts['regular\_price\_enabled']   = wcj\_sanitize\_input\_attribute\_values( $atts['regular\_price\_enabled'] ); |
| [90](#L90) | $atts['sale\_price\_enabled']      = wcj\_sanitize\_input\_attribute\_values( $atts['sale\_price\_enabled'] ); |
| [91](#L91) | $atts['external\_url\_enabled']    = wcj\_sanitize\_input\_attribute\_values( $atts['external\_url\_enabled'] ); |
| [92](#L92) | $atts['cats\_enabled']            = wcj\_sanitize\_input\_attribute\_values( $atts['cats\_enabled'] ); |
| [93](#L93) | $atts['tags\_enabled']            = wcj\_sanitize\_input\_attribute\_values( $atts['tags\_enabled'] ); |
| [94](#L94) | $atts['image\_gallery\_enabled']   = wcj\_sanitize\_input\_attribute\_values( $atts['image\_gallery\_enabled'] ); |
| [95](#L95) | $atts['image\_enabled']           = wcj\_sanitize\_input\_attribute\_values( $atts['image\_enabled'] ); |
| [96](#L96) | $atts['desc\_required']           = wcj\_sanitize\_input\_attribute\_values( $atts['desc\_required'] ); |
| [97](#L97) | $atts['short\_desc\_required']     = wcj\_sanitize\_input\_attribute\_values( $atts['short\_desc\_required'] ); |
| [98](#L98) | $atts['regular\_price\_required']  = wcj\_sanitize\_input\_attribute\_values( $atts['regular\_price\_required'] ); |
| [99](#L99) | $atts['sale\_price\_required']     = wcj\_sanitize\_input\_attribute\_values( $atts['sale\_price\_required'] ); |
| [100](#L100) | $atts['external\_url\_required']   = wcj\_sanitize\_input\_attribute\_values( $atts['external\_url\_required'] ); |
| [101](#L101) | $atts['cats\_required']           = wcj\_sanitize\_input\_attribute\_values( $atts['cats\_required'] ); |
| [102](#L102) | $atts['tags\_required']           = wcj\_sanitize\_input\_attribute\_values( $atts['tags\_required'] ); |
| [103](#L103) | $atts['image\_required']          = wcj\_sanitize\_input\_attribute\_values( $atts['image\_required'] ); |
| [104](#L104) | $atts['image\_gallery\_required']  = wcj\_sanitize\_input\_attribute\_values( $atts['image\_gallery\_required'] ); |
| [105](#L105) | $atts['visibility']              = wcj\_sanitize\_input\_attribute\_values( $atts['visibility'], 'restrict\_quotes' ); |
| [106](#L106) | $atts['module']                  = wcj\_sanitize\_input\_attribute\_values( $atts['module'] ); |
| [107](#L107) | $atts['module\_name']             = wcj\_sanitize\_input\_attribute\_values( $atts['module\_name'] ); |
| [108](#L108) | $atts['custom\_taxonomies\_total'] = wcj\_sanitize\_input\_attribute\_values( $atts['custom\_taxonomies\_total'] ); |
| [109](#L109) | for ( $i = 1; $i <= $atts['custom\_taxonomies\_total']; $i++ ) { |
| [110](#L110) | $atts[ 'custom\_taxonomy\_' . $i . '\_enabled' ]  = wcj\_sanitize\_input\_attribute\_values( $atts[ 'custom\_taxonomy\_' . $i . '\_enabled' ] ); |
| [111](#L111) | $atts[ 'custom\_taxonomy\_' . $i . '\_required' ] = wcj\_sanitize\_input\_attribute\_values( $atts[ 'custom\_taxonomy\_' . $i . '\_required' ] ); |
| [112](#L112) | $atts[ 'custom\_taxonomy\_' . $i . '\_id' ]       = wcj\_sanitize\_input\_attribute\_values( $atts[ 'custom\_taxonomy\_' . $i . '\_id' ] ); |
| [113](#L113) | $atts[ 'custom\_taxonomy\_' . $i . '\_title' ]    = wcj\_sanitize\_input\_attribute\_values( $atts[ 'custom\_taxonomy\_' . $i . '\_title' ] ); |
| [114](#L114) | } |
| [115](#L115) | return $atts; |
| [116](#L116) | } |
| [117](#L117) |  |
| [118](#L118) | /\*\* |
| [119](#L119) | \* Wc\_add\_new\_product. |
| [120](#L120) | \* |
| [121](#L121) | \* @version 2.8.0 |
| [122](#L122) | \* @since   2.5.0 |
| [123](#L123) | \* @todo    image gallery: `<input type="file" multiple>` or separate `<input type="file">` for each file; `update\_post\_meta( $product\_id, '\_product\_image\_gallery', implode( ',', $attach\_ids ) );` |
| [124](#L124) | \* @param array $args The user defined shortcode args. |
| [125](#L125) | \* @param array $shortcode\_atts The user defined shortcode shortcode\_atts. |
| [126](#L126) | \*/ |
| [127](#L127) | public function wc\_add\_new\_product( $args, $shortcode\_atts ) { |
| [128](#L128) |  |
| [129](#L129) | $product\_post = array( |
| [130](#L130) | 'post\_title'   => $args['title'], |
| [131](#L131) | 'post\_content' => $args['desc'], |
| [132](#L132) | 'post\_excerpt' => $args['short\_desc'], |
| [133](#L133) | 'post\_type'    => 'product', |
| [134](#L134) | 'post\_status'  => 'draft', |
| [135](#L135) | ); |
| [136](#L136) |  |
| [137](#L137) | if ( 0 === $shortcode\_atts['product\_id'] ) { |
| [138](#L138) | $product\_id = wp\_insert\_post( $product\_post ); |
| [139](#L139) | } else { |
| [140](#L140) | $product\_id = $shortcode\_atts['product\_id']; |
| [141](#L141) | wp\_update\_post( array\_merge( array( 'ID' => $product\_id ), $product\_post ) ); |
| [142](#L142) | } |
| [143](#L143) |  |
| [144](#L144) | // Insert the post into the database. |
| [145](#L145) | if ( 0 !== $product\_id ) { |
| [146](#L146) |  |
| [147](#L147) | wp\_set\_object\_terms( $product\_id, wcj\_get\_option( 'wcj\_product\_by\_user\_product\_type', 'simple' ), 'product\_type' ); |
| [148](#L148) | wp\_set\_object\_terms( $product\_id, $args['cats'], 'product\_cat' ); |
| [149](#L149) | wp\_set\_object\_terms( $product\_id, $args['tags'], 'product\_tag' ); |
| [150](#L150) |  |
| [151](#L151) | for ( $i = 1; $i <= $this->the\_atts['custom\_taxonomies\_total']; $i++ ) { |
| [152](#L152) | if ( 'yes' === $this->the\_atts[ 'custom\_taxonomy\_' . $i . '\_enabled' ] && '' !== $this->the\_atts[ 'custom\_taxonomy\_' . $i . '\_id' ] ) { |
| [153](#L153) | wp\_set\_object\_terms( $product\_id, $args[ 'custom\_taxonomy\_' . $i ], $this->the\_atts[ 'custom\_taxonomy\_' . $i . '\_id' ] ); |
| [154](#L154) | } |
| [155](#L155) | } |
| [156](#L156) |  |
| [157](#L157) | update\_post\_meta( $product\_id, '\_regular\_price', $args['regular\_price'] ); |
| [158](#L158) | update\_post\_meta( $product\_id, '\_sale\_price', $args['sale\_price'] ); |
| [159](#L159) | if ( '' === $args['sale\_price'] ) { |
| [160](#L160) | update\_post\_meta( $product\_id, '\_price', $args['regular\_price'] ); |
| [161](#L161) | } else { |
| [162](#L162) | update\_post\_meta( $product\_id, '\_price', $args['sale\_price'] ); |
| [163](#L163) | } |
| [164](#L164) | update\_post\_meta( $product\_id, '\_visibility', 'visible' ); |
| [165](#L165) | update\_post\_meta( $product\_id, '\_stock\_status', 'instock' ); |
| [166](#L166) |  |
| [167](#L167) | if ( 'external' === wcj\_get\_option( 'wcj\_product\_by\_user\_product\_type', 'simple' ) ) { |
| [168](#L168) | update\_post\_meta( $product\_id, '\_product\_url', $args['external\_url'] ); |
| [169](#L169) | } |
| [170](#L170) |  |
| [171](#L171) | // Image. |
| [172](#L172) | if ( '' !== $args['image'] && '' !== $args['image']['tmp\_name'] ) { |
| [173](#L173) | $upload\_dir = wp\_upload\_dir(); |
| [174](#L174) | $filename   = $args['image']['name']; |
| [175](#L175) | $file       = ( wp\_mkdir\_p( $upload\_dir['path'] ) ) ? $upload\_dir['path'] : $upload\_dir['basedir']; |
| [176](#L176) | $file      .= '/' . $filename; |
| [177](#L177) |  |
| [178](#L178) | move\_uploaded\_file( $args['image']['tmp\_name'], $file ); |
| [179](#L179) |  |
| [180](#L180) | $wp\_filetype = wp\_check\_filetype( $filename, null ); |
| [181](#L181) | $attachment  = array( |
| [182](#L182) | 'post\_mime\_type' => $wp\_filetype['type'], |
| [183](#L183) | 'post\_title'     => sanitize\_file\_name( $filename ), |
| [184](#L184) | 'post\_content'   => '', |
| [185](#L185) | 'post\_status'    => 'inherit', |
| [186](#L186) | ); |
| [187](#L187) | $attach\_id   = wp\_insert\_attachment( $attachment, $file, $product\_id ); |
| [188](#L188) | require\_once ABSPATH . 'wp-admin/includes/image.php'; |
| [189](#L189) | $attach\_data = wp\_generate\_attachment\_metadata( $attach\_id, $file ); |
| [190](#L190) | wp\_update\_attachment\_metadata( $attach\_id, $attach\_data ); |
| [191](#L191) |  |
| [192](#L192) | set\_post\_thumbnail( $product\_id, $attach\_id ); |
| [193](#L193) | } |
| [194](#L194) |  |
| [195](#L195) | wp\_update\_post( |
| [196](#L196) | array( |
| [197](#L197) | 'ID'          => $product\_id, |
| [198](#L198) | 'post\_status' => $shortcode\_atts['post\_status'], |
| [199](#L199) | ) |
| [200](#L200) | ); |
| [201](#L201) | } |
| [202](#L202) |  |
| [203](#L203) | return $product\_id; |
| [204](#L204) | } |
| [205](#L205) |  |
| [206](#L206) | /\*\* |
| [207](#L207) | \* Validate\_args. |
| [208](#L208) | \* |
| [209](#L209) | \* @version 7.1.8 |
| [210](#L210) | \* @since   2.5.0 |
| [211](#L211) | \* @param array $args The user defined shortcode args. |
| [212](#L212) | \* @param array $shortcode\_atts The user defined shortcode shortcode\_atts. |
| [213](#L213) | \*/ |
| [214](#L214) | public function validate\_args( $args, $shortcode\_atts ) { |
| [215](#L215) | $errors = ''; |
| [216](#L216) | if ( '' === $args['title'] ) { |
| [217](#L217) | $errors .= '<li>' . \_\_( 'Title is required!', 'woocommerce-jetpack' ) . '</li>'; |
| [218](#L218) | } |
| [219](#L219) |  |
| [220](#L220) | if ( 'yes' === wcj\_get\_option( 'wcj\_product\_by\_user\_require\_unique\_title', 'no' ) && 0 === $shortcode\_atts['product\_id'] ) { |
| [221](#L221) | if ( ! function\_exists( 'post\_exists' ) ) { |
| [222](#L222) | require\_once ABSPATH . 'wp-admin/includes/post.php'; |
| [223](#L223) | } |
| [224](#L224) | if ( post\_exists( $args['title'] ) ) { |
| [225](#L225) | $errors .= '<li>' . \_\_( 'Product exists!', 'woocommerce-jetpack' ) . '</li>'; |
| [226](#L226) | } |
| [227](#L227) | } |
| [228](#L228) |  |
| [229](#L229) | $fields = array( |
| [230](#L230) | 'desc'          => \_\_( 'Description', 'woocommerce-jetpack' ), |
| [231](#L231) | 'short\_desc'    => \_\_( 'Short Description', 'woocommerce-jetpack' ), |
| [232](#L232) | 'image'         => \_\_( 'Image', 'woocommerce-jetpack' ), |
| [233](#L233) | 'regular\_price' => \_\_( 'Regular Price', 'woocommerce-jetpack' ), |
| [234](#L234) | 'sale\_price'    => \_\_( 'Sale Price', 'woocommerce-jetpack' ), |
| [235](#L235) | 'external\_url'  => \_\_( 'Product URL', 'woocommerce-jetpack' ), |
| [236](#L236) | 'cats'          => \_\_( 'Categories', 'woocommerce-jetpack' ), |
| [237](#L237) | 'tags'          => \_\_( 'Tags', 'woocommerce-jetpack' ), |
| [238](#L238) | ); |
| [239](#L239) | for ( $i = 1; $i <= $this->the\_atts['custom\_taxonomies\_total']; $i++ ) { |
| [240](#L240) | $fields[ 'custom\_taxonomy\_' . $i ] = $this->the\_atts[ 'custom\_taxonomy\_' . $i . '\_title' ]; |
| [241](#L241) | } |
| [242](#L242) | foreach ( $fields as $field\_id => $field\_desc ) { |
| [243](#L243) | if ( 'yes' === $shortcode\_atts[ $field\_id . '\_enabled' ] && 'yes' === $shortcode\_atts[ $field\_id . '\_required' ] ) { |
| [244](#L244) | $is\_missing = false; |
| [245](#L245) | if ( 'image' === $field\_id && ( '' === $args[ $field\_id ] || ! isset( $args[ $field\_id ]['tmp\_name'] ) || '' === $args[ $field\_id ]['tmp\_name'] ) ) { |
| [246](#L246) | $is\_missing = true; |
| [247](#L247) | } elseif ( empty( $args[ $field\_id ] ) ) { |
| [248](#L248) | $is\_missing = true; |
| [249](#L249) | } |
| [250](#L250) | if ( $is\_missing ) { |
| [251](#L251) | /\* translators: %s: translation added \*/ |
| [252](#L252) | $errors .= '<li>' . sprintf( \_\_( '%s is required!', 'woocommerce-jetpack' ), $field\_desc ) . '</li>'; |
| [253](#L253) | } |
| [254](#L254) | } |
| [255](#L255) | } |
| [256](#L256) |  |
| [257](#L257) | if ( $args['sale\_price'] > $args['regular\_price'] ) { |
| [258](#L258) | $errors .= '<li>' . \_\_( 'Sale price must be less than the regular price!', 'woocommerce-jetpack' ) . '</li>'; |
| [259](#L259) | } |
| [260](#L260) |  |
| [261](#L261) | $product\_image\_name = isset( $args['image']['name'] ) ? sanitize\_text\_field( wp\_unslash( $args['image']['name'] ) ) : ''; |
| [262](#L262) | $gallery\_images     = isset( $args['image\_gallery']['name'] ) ? array\_map( 'sanitize\_text\_field', wp\_unslash( $args['image\_gallery']['name'] ) ) : array(); |
| [263](#L263) |  |
| [264](#L264) | $allowed\_types = array( '.jpg', '.jpeg', '.png', '.webp', '.heic', '.heif', '.gif' ); // Allowed File types by WordPress https://wordpress.com/support/accepted-filetypes/. |
| [265](#L265) |  |
| [266](#L266) | // Verify and restrict Product Image. |
| [267](#L267) | if ( isset( $product\_image\_name ) && '' !== $product\_image\_name ) { |
| [268](#L268) | $file\_type = '.' . pathinfo( $product\_image\_name, PATHINFO\_EXTENSION ); |
| [269](#L269) | if ( ! in\_array( $file\_type, $allowed\_types, true ) ) { |
| [270](#L270) | $errors .= '<li>' . \_\_( 'Sorry, only JPG, JPEG, PNG, WEBP, HEIC, HEIF and GIF files are allowed', 'woocommerce-jetpack' ) . '</li>'; |
| [271](#L271) | } |
| [272](#L272) | } |
| [273](#L273) | // Verify and restrict Gallery Image. |
| [274](#L274) | if ( isset( $gallery\_images ) && ! empty( array\_filter( $gallery\_images ) ) ) { |
| [275](#L275) | $error\_encountered = false; // Flag variable to track if an error has been encountered. |
| [276](#L276) | foreach ( $gallery\_images as $gallery\_image\_name ) { |
| [277](#L277) | $gallery\_file\_type = '.' . pathinfo( $gallery\_image\_name, PATHINFO\_EXTENSION ); |
| [278](#L278) | if ( ! in\_array( $gallery\_file\_type, $allowed\_types, true ) ) { |
| [279](#L279) | if ( ! $error\_encountered && ! $errors ) { |
| [280](#L280) |  |
| [281](#L281) | $errors           .= '<li>' . \_\_( 'Sorry, only JPG, JPEG, PNG, WEBP, HEIC, HEIF and GIF files are allowed', 'woocommerce-jetpack' ) . '</li>'; |
| [282](#L282) | $error\_encountered = true; // Set the flag to true to indicate error has been encountered. |
| [283](#L283) | } |
| [284](#L284) | } |
| [285](#L285) | } |
| [286](#L286) | } |
| [287](#L287) | return ( '' === $errors ) ? true : $errors; |
| [288](#L288) | } |
| [289](#L289) |  |
| [290](#L290) | /\*\* |
| [291](#L291) | \* Maybe\_add\_taxonomy\_field. |
| [292](#L292) | \* |
| [293](#L293) | \* @version 2.8.0 |
| [294](#L294) | \* @since   2.8.0 |
| [295](#L295) | \* @param array        $atts The user defined shortcode atts. |
| [296](#L296) | \* @param array        $args The user defined shortcode args. |
| [297](#L297) | \* @param int | string $option\_id The user defined shortcode option\_id. |
| [298](#L298) | \* @param int | string $taxonomy\_id The user defined shortcode taxonomy\_id. |
| [299](#L299) | \* @param string       $title The user defined shortcode title. |
| [300](#L300) | \* @param string       $input\_style The user defined shortcode input\_style. |
| [301](#L301) | \* @param string       $required\_mark\_html\_template The user defined shortcode required\_mark\_html\_template. |
| [302](#L302) | \* @param array        $table\_data The user defined shortcode table\_data. |
| [303](#L303) | \*/ |
| [304](#L304) | public function maybe\_add\_taxonomy\_field( $atts, $args, $option\_id, $taxonomy\_id, $title, $input\_style, $required\_mark\_html\_template, $table\_data ) { |
| [305](#L305) | if ( 'yes' === $atts[ $option\_id . '\_enabled' ] ) { |
| [306](#L306) | $product\_taxonomies = get\_terms( $taxonomy\_id, 'orderby=name&hide\_empty=0' ); |
| [307](#L307) | if ( is\_wp\_error( $product\_taxonomies ) ) { |
| [308](#L308) | return $table\_data; |
| [309](#L309) | } |
| [310](#L310) | $required\_html                        = ( 'yes' === $atts[ $option\_id . '\_required' ] ) ? ' required' : ''; |
| [311](#L311) | $required\_mark\_html                   = ( 'yes' === $atts[ $option\_id . '\_required' ] ) ? $required\_mark\_html\_template : ''; |
| [312](#L312) | $current\_product\_taxonomies           = ( 0 !== $atts['product\_id'] ) ? get\_the\_terms( $atts['product\_id'], $taxonomy\_id ) : $args[ $option\_id ]; |
| [313](#L313) | $product\_taxonomies\_as\_select\_options = ''; |
| [314](#L314) | foreach ( $product\_taxonomies as $product\_taxonomy ) { |
| [315](#L315) | $selected = ''; |
| [316](#L316) | if ( ! empty( $current\_product\_taxonomies ) ) { |
| [317](#L317) | foreach ( $current\_product\_taxonomies as $current\_product\_taxonomy ) { |
| [318](#L318) | if ( is\_object( $current\_product\_taxonomy ) ) { |
| [319](#L319) | $current\_product\_taxonomy = $current\_product\_taxonomy->slug; |
| [320](#L320) | } |
| [321](#L321) | $selected .= selected( $current\_product\_taxonomy, $product\_taxonomy->slug, false ); |
| [322](#L322) | } |
| [323](#L323) | } |
| [324](#L324) | $product\_taxonomies\_as\_select\_options .= '<option value="' . $product\_taxonomy->slug . '" ' . $selected . '>' . $product\_taxonomy->name . '</option>'; |
| [325](#L325) | } |
| [326](#L326) | $table\_data[] = array( |
| [327](#L327) | '<label for="wcj\_add\_new\_product\_' . $option\_id . '">' . $title . $required\_mark\_html . '</label>', |
| [328](#L328) | '<select' . $required\_html . ' multiple style="' . $input\_style . '" id="wcj\_add\_new\_product\_' . $option\_id . '" name="wcj\_add\_new\_product\_' . $option\_id . '[]">' . |
| [329](#L329) | $product\_taxonomies\_as\_select\_options . |
| [330](#L330) | '</select>', |
| [331](#L331) | ); |
| [332](#L332) | } |
| [333](#L333) | return $table\_data; |
| [334](#L334) | } |
| [335](#L335) |  |
| [336](#L336) | /\*\* |
| [337](#L337) | \* Wcj\_product\_add\_new. |
| [338](#L338) | \* |
| [339](#L339) | \* @version 7.1.3 |
| [340](#L340) | \* @since   2.5.0 |
| [341](#L341) | \* @todo    `multipart` only if image |
| [342](#L342) | \* @param array $atts The user defined shortcode atts. |
| [343](#L343) | \*/ |
| [344](#L344) | public function wcj\_product\_add\_new( $atts ) { |
| [345](#L345) | // Allowed User-roles. |
| [346](#L346) | $allowed\_user\_roles = array( 'administrator', 'shop\_manager', 'customer' ); |
| [347](#L347) |  |
| [348](#L348) | if ( function\_exists( 'wcj\_get\_current\_user\_all\_roles' ) ) { |
| [349](#L349) | // Current user role. |
| [350](#L350) | $current\_user\_role = wcj\_get\_current\_user\_all\_roles(); |
| [351](#L351) |  |
| [352](#L352) | if ( isset( $current\_user\_role ) && ! empty( $current\_user\_role ) ) { |
| [353](#L353) | // Initialize a result array. |
| [354](#L354) | $authorized\_user = array(); |
| [355](#L355) |  |
| [356](#L356) | // Loop through the values to check. |
| [357](#L357) | foreach ( $current\_user\_role as $user\_role ) { |
| [358](#L358) | if ( in\_array( $user\_role, $allowed\_user\_roles, true ) ) { |
| [359](#L359) | // Value exists in the array. |
| [360](#L360) | $authorized\_user[] = $user\_role; |
| [361](#L361) | } |
| [362](#L362) | } |
| [363](#L363) |  |
| [364](#L364) | // Check the result. |
| [365](#L365) | if ( empty( $authorized\_user ) ) { |
| [366](#L366) | return false; |
| [367](#L367) | } |
| [368](#L368) | } else { |
| [369](#L369) | return false; // Executes if $current\_user\_role is empty. |
| [370](#L370) | } |
| [371](#L371) | } else { |
| [372](#L372) | return false; |
| [373](#L373) | } |
| [374](#L374) |  |
| [375](#L375) | $wpnonce           = isset( $\_REQUEST['wcj\_add\_new\_product-nonce'] ) ? wp\_verify\_nonce( sanitize\_key( $\_REQUEST['wcj\_add\_new\_product-nonce'] ), 'wcj\_add\_new\_product' ) : false; |
| [376](#L376) | $header\_html       = ''; |
| [377](#L377) | $notice\_html       = ''; |
| [378](#L378) | $input\_fields\_html = ''; |
| [379](#L379) | $footer\_html       = ''; |
| [380](#L380) |  |
| [381](#L381) | $args = array( |
| [382](#L382) | 'title'         => ( isset( $\_REQUEST['wcj\_add\_new\_product\_title'] ) ) ? sanitize\_text\_field( wp\_unslash( $\_REQUEST['wcj\_add\_new\_product\_title'] ) ) : '', |
| [383](#L383) | 'desc'          => isset( $\_REQUEST['wcj\_add\_new\_product\_desc'] ) ? sanitize\_text\_field( wp\_unslash( $\_REQUEST['wcj\_add\_new\_product\_desc'] ) ) : '', |
| [384](#L384) | 'short\_desc'    => isset( $\_REQUEST['wcj\_add\_new\_product\_short\_desc'] ) ? sanitize\_text\_field( wp\_unslash( $\_REQUEST['wcj\_add\_new\_product\_short\_desc'] ) ) : '', |
| [385](#L385) | 'regular\_price' => isset( $\_REQUEST['wcj\_add\_new\_product\_regular\_price'] ) ? sanitize\_text\_field( wp\_unslash( $\_REQUEST['wcj\_add\_new\_product\_regular\_price'] ) ) : '', |
| [386](#L386) | 'sale\_price'    => isset( $\_REQUEST['wcj\_add\_new\_product\_sale\_price'] ) ? sanitize\_text\_field( wp\_unslash( $\_REQUEST['wcj\_add\_new\_product\_sale\_price'] ) ) : '', |
| [387](#L387) | 'external\_url'  => isset( $\_REQUEST['wcj\_add\_new\_product\_external\_url'] ) ? sanitize\_text\_field( wp\_unslash( $\_REQUEST['wcj\_add\_new\_product\_external\_url'] ) ) : '', |
| [388](#L388) | 'cats'          => isset( $\_REQUEST['wcj\_add\_new\_product\_cats'] ) ? array\_map( 'sanitize\_text\_field', wp\_unslash( $\_REQUEST['wcj\_add\_new\_product\_cats'] ) ) : array(), |
| [389](#L389) | 'tags'          => isset( $\_REQUEST['wcj\_add\_new\_product\_tags'] ) ? sanitize\_text\_field( wp\_unslash( $\_REQUEST['wcj\_add\_new\_product\_tags'] ) ) : array(), |
| [390](#L390) | 'image'         => isset( $\_FILES['wcj\_add\_new\_product\_image'] ) ? sanitize\_text\_field( wp\_unslash( $\_FILES['wcj\_add\_new\_product\_image'] ) ) : '', |
| [391](#L391) | ); |
| [392](#L392) | for ( $i = 1; $i <= $this->the\_atts['custom\_taxonomies\_total']; $i++ ) { |
| [393](#L393) | $param\_id                        = 'wcj\_add\_new\_product\_custom\_taxonomy\_' . $i; |
| [394](#L394) | $args[ 'custom\_taxonomy\_' . $i ] = isset( $\_REQUEST[ $param\_id ] ) ? sanitize\_text\_field( wp\_unslash( $\_REQUEST[ $param\_id ] ) ) : array(); |
| [395](#L395) | } |
| [396](#L396) |  |
| [397](#L397) | if ( $wpnonce && isset( $\_REQUEST['wcj\_add\_new\_product'] ) ) { |
| [398](#L398) | $validate\_args = $this->validate\_args( $args, $atts ); |
| [399](#L399) | if ( true === ( $validate\_args ) ) { |
| [400](#L400) | $result = $this->wc\_add\_new\_product( $args, $atts ); |
| [401](#L401) | if ( 0 === $result ) { |
| [402](#L402) | // Error. |
| [403](#L403) | $notice\_html .= '<div class="woocommerce"><ul class="woocommerce-error"><li>' . \_\_( 'Error!', 'woocommerce-jetpack' ) . '</li></ul></div>'; |
| [404](#L404) | } else { |
| [405](#L405) | // Success. |
| [406](#L406) | if ( 0 === $atts['product\_id'] ) { |
| [407](#L407) | $notice\_html .= '<div class="woocommerce"><div class="woocommerce-message">' . |
| [408](#L408) | str\_replace( |
| [409](#L409) | '%product\_title%', |
| [410](#L410) | $args['title'], |
| [411](#L411) | get\_option( 'wcj\_product\_by\_user\_message\_product\_successfully\_added', \_\_( '"%product\_title%" successfully added!', 'woocommerce-jetpack' ) ) |
| [412](#L412) | ) . |
| [413](#L413) | '</div></div>'; |
| [414](#L414) | } else { |
| [415](#L415) | $notice\_html .= '<div class="woocommerce"><div class="woocommerce-message">' . |
| [416](#L416) | str\_replace( |
| [417](#L417) | '%product\_title%', |
| [418](#L418) | $args['title'], |
| [419](#L419) | get\_option( 'wcj\_product\_by\_user\_message\_product\_successfully\_edited', \_\_( '"%product\_title%" successfully edited!', 'woocommerce-jetpack' ) ) |
| [420](#L420) | ) . |
| [421](#L421) | '</div></div>'; |
| [422](#L422) | } |
| [423](#L423) | } |
| [424](#L424) | } else { |
| [425](#L425) | $notice\_html .= '<div class="woocommerce"><ul class="woocommerce-error">' . $validate\_args . '</ul></div>'; |
| [426](#L426) | } |
| [427](#L427) | } |
| [428](#L428) |  |
| [429](#L429) | if ( isset( $\_GET['wcj\_edit\_product\_image\_delete'] ) ) { |
| [430](#L430) | $product\_id     = sanitize\_text\_field( wp\_unslash( $\_GET['wcj\_edit\_product\_image\_delete'] ) ); |
| [431](#L431) | $post\_author\_id = get\_post\_field( 'post\_author', $product\_id ); |
| [432](#L432) | $user\_ID        = get\_current\_user\_id(); |
| [433](#L433) | if ( $user\_ID !== $post\_author\_id ) { |
| [434](#L434) | echo '<p>' . wp\_kses\_post( 'Wrong user ID!', 'woocommerce-jetpack' ) . '</p>'; |
| [435](#L435) | } else { |
| [436](#L436) | $image\_id = get\_post\_thumbnail\_id( $product\_id ); |
| [437](#L437) | wp\_delete\_post( $image\_id, true ); |
| [438](#L438) | } |
| [439](#L439) | } |
| [440](#L440) |  |
| [441](#L441) | if ( 0 !== $atts['product\_id'] ) { |
| [442](#L442) | $this->the\_product = wc\_get\_product( $atts['product\_id'] ); |
| [443](#L443) | } |
| [444](#L444) |  |
| [445](#L445) | $header\_html .= '<h3>'; |
| [446](#L446) | $header\_html .= ( 0 === $atts['product\_id'] ) ? \_\_( 'Add New Product', 'woocommerce-jetpack' ) : \_\_( 'Edit Product', 'woocommerce-jetpack' ); |
| [447](#L447) | $header\_html .= '</h3>'; |
| [448](#L448) | $header\_html .= '<form method="post" action="' . esc\_url( remove\_query\_arg( array( 'wcj\_edit\_product\_image\_delete', 'wcj\_delete\_product' ) ) ) . |
| [449](#L449) | '" enctype="multipart/form-data">'; |
| [450](#L450) |  |
| [451](#L451) | $required\_mark\_html\_template = '&nbsp;<abbr class="required" title="' . \_\_( 'required', 'woocommerce-jetpack' ) . '">\*</abbr>'; |
| [452](#L452) |  |
| [453](#L453) | $price\_step = sprintf( '%f', ( 1 / pow( 10, wcj\_get\_option( 'wcj\_product\_by\_user\_price\_step', wcj\_get\_option( 'woocommerce\_price\_num\_decimals', 2 ) ) ) ) ); |
| [454](#L454) |  |
| [455](#L455) | $table\_data   = array(); |
| [456](#L456) | $input\_style  = 'width:100%;'; |
| [457](#L457) | $table\_data[] = array( |
| [458](#L458) | '<label for="wcj\_add\_new\_product\_title">' . \_\_( 'Title', 'woocommerce-jetpack' ) . $required\_mark\_html\_template . '</label>', |
| [459](#L459) | '<input required type="text" style="' . $input\_style . '" id="wcj\_add\_new\_product\_title" name="wcj\_add\_new\_product\_title" value="' . ( ( 0 !== $atts['product\_id'] ) ? |
| [460](#L460) | $this->the\_product->get\_title() : $args['title'] ) . '">', |
| [461](#L461) | ); |
| [462](#L462) | if ( 'yes' === $atts['desc\_enabled'] ) { |
| [463](#L463) | $required\_html      = ( 'yes' === $atts['desc\_required'] ) ? ' required' : ''; |
| [464](#L464) | $required\_mark\_html = ( 'yes' === $atts['desc\_required'] ) ? $required\_mark\_html\_template : ''; |
| [465](#L465) | $table\_data[]       = array( |
| [466](#L466) | '<label for="wcj\_add\_new\_product\_desc">' . \_\_( 'Description', 'woocommerce-jetpack' ) . $required\_mark\_html . '</label>', |
| [467](#L467) | '<textarea' . $required\_html . ' style="' . $input\_style . '" id="wcj\_add\_new\_product\_desc" name="wcj\_add\_new\_product\_desc">' . ( ( 0 !== $atts['product\_id'] ) ? |
| [468](#L468) | get\_post\_field( 'post\_content', $atts['product\_id'] ) : $args['desc'] ) . '</textarea>', |
| [469](#L469) | ); |
| [470](#L470) | } |
| [471](#L471) | if ( 'yes' === $atts['short\_desc\_enabled'] ) { |
| [472](#L472) | $required\_html      = ( 'yes' === $atts['short\_desc\_required'] ) ? ' required' : ''; |
| [473](#L473) | $required\_mark\_html = ( 'yes' === $atts['short\_desc\_required'] ) ? $required\_mark\_html\_template : ''; |
| [474](#L474) | $table\_data[]       = array( |
| [475](#L475) | '<label for="wcj\_add\_new\_product\_short\_desc">' . \_\_( 'Short Description', 'woocommerce-jetpack' ) . $required\_mark\_html . '</label>', |
| [476](#L476) | '<textarea' . $required\_html . ' style="' . $input\_style . '" id="wcj\_add\_new\_product\_short\_desc" name="wcj\_add\_new\_product\_short\_desc">' . |
| [477](#L477) | ( ( 0 !== $atts['product\_id'] ) ? get\_post\_field( 'post\_excerpt', $atts['product\_id'] ) : $args['short\_desc'] ) . '</textarea>', |
| [478](#L478) | ); |
| [479](#L479) | } |
| [480](#L480) | if ( 'yes' === $atts['image\_enabled'] ) { |
| [481](#L481) | $required\_html      = ( 'yes' === $atts['image\_required'] ) ? ' required' : ''; |
| [482](#L482) | $required\_mark\_html = ( 'yes' === $atts['image\_required'] ) ? $required\_mark\_html\_template : ''; |
| [483](#L483) | $new\_image\_field    = '<input' . $required\_html . ' type="file" id="wcj\_add\_new\_product\_image" name="wcj\_add\_new\_product\_image" accept="image/\*">'; |
| [484](#L484) | if ( 0 !== $atts['product\_id'] ) { |
| [485](#L485) | $the\_field = ( '' === get\_post\_thumbnail\_id( $atts['product\_id'] ) ) ? |
| [486](#L486) | $new\_image\_field : |
| [487](#L487) | '<a href="' . esc\_url( add\_query\_arg( 'wcj\_edit\_product\_image\_delete', $atts['product\_id'] ) ) . '" onclick="return confirm(\'' . |
| [488](#L488) | \_\_( 'Are you sure?', 'woocommerce-jetpack' ) . '\')">' . \_\_( 'Delete', 'woocommerce-jetpack' ) . '</a><br>' . |
| [489](#L489) | get\_the\_post\_thumbnail( $atts['product\_id'], array( 50, 50 ), array( 'class' => 'alignleft' ) ); |
| [490](#L490) | } else { |
| [491](#L491) | $the\_field = $new\_image\_field; |
| [492](#L492) | } |
| [493](#L493) | $table\_data[] = array( |
| [494](#L494) | '<label for="wcj\_add\_new\_product\_image">' . \_\_( 'Image', 'woocommerce-jetpack' ) . $required\_mark\_html . '</label>', |
| [495](#L495) | $the\_field, |
| [496](#L496) | ); |
| [497](#L497) | } |
| [498](#L498) | if ( 'yes' === $atts['regular\_price\_enabled'] ) { |
| [499](#L499) | $required\_html      = ( 'yes' === $atts['regular\_price\_required'] ) ? ' required' : ''; |
| [500](#L500) | $required\_mark\_html = ( 'yes' === $atts['regular\_price\_required'] ) ? $required\_mark\_html\_template : ''; |
| [501](#L501) | $table\_data[]       = array( |
| [502](#L502) | '<label for="wcj\_add\_new\_product\_regular\_price">' . \_\_( 'Regular Price', 'woocommerce-jetpack' ) . $required\_mark\_html . '</label>', |
| [503](#L503) | '<input' . $required\_html . ' type="number" min="0" step="' . $price\_step . '" id="wcj\_add\_new\_product\_regular\_price" name="wcj\_add\_new\_product\_regular\_price" value="' . |
| [504](#L504) | ( ( 0 !== $atts['product\_id'] ) ? get\_post\_meta( $atts['product\_id'], '\_regular\_price', true ) : $args['regular\_price'] ) . '">', |
| [505](#L505) | ); |
| [506](#L506) | } |
| [507](#L507) | if ( 'yes' === $atts['sale\_price\_enabled'] ) { |
| [508](#L508) | $required\_html      = ( 'yes' === $atts['sale\_price\_required'] ) ? ' required' : ''; |
| [509](#L509) | $required\_mark\_html = ( 'yes' === $atts['sale\_price\_required'] ) ? $required\_mark\_html\_template : ''; |
| [510](#L510) | $table\_data[]       = array( |
| [511](#L511) | '<label for="wcj\_add\_new\_product\_sale\_price">' . \_\_( 'Sale Price', 'woocommerce-jetpack' ) . $required\_mark\_html . '</label>', |
| [512](#L512) | '<input' . $required\_html . ' type="number" min="0" step="' . $price\_step . '" id="wcj\_add\_new\_product\_sale\_price" name="wcj\_add\_new\_product\_sale\_price" value="' . |
| [513](#L513) | ( ( 0 !== $atts['product\_id'] ) ? get\_post\_meta( $atts['product\_id'], '\_sale\_price', true ) : $args['sale\_price'] ) . '">', |
| [514](#L514) | ); |
| [515](#L515) | } |
| [516](#L516) | if ( 'yes' === $atts['external\_url\_enabled'] ) { |
| [517](#L517) | $required\_html      = ( 'yes' === $atts['external\_url\_required'] ) ? ' required' : ''; |
| [518](#L518) | $required\_mark\_html = ( 'yes' === $atts['external\_url\_required'] ) ? $required\_mark\_html\_template : ''; |
| [519](#L519) | $table\_data[]       = array( |
| [520](#L520) | '<label for="wcj\_add\_new\_product\_external\_url">' . \_\_( 'Product URL', 'woocommerce-jetpack' ) . $required\_mark\_html\_template . '</label>', |
| [521](#L521) | '<input' . $required\_html . ' style="' . $input\_style . '" type="url" id="wcj\_add\_new\_product\_external\_url" name="wcj\_add\_new\_product\_external\_url" value="' . |
| [522](#L522) | ( ( 0 !== $atts['product\_id'] ) ? get\_post\_meta( $atts['product\_id'], '\_product\_url', true ) : $args['external\_url'] ) . '">', |
| [523](#L523) | ); |
| [524](#L524) | } |
| [525](#L525) | $table\_data = $this->maybe\_add\_taxonomy\_field( |
| [526](#L526) | $atts, |
| [527](#L527) | $args, |
| [528](#L528) | 'cats', |
| [529](#L529) | 'product\_cat', |
| [530](#L530) | \_\_( 'Categories', 'woocommerce-jetpack' ), |
| [531](#L531) | $input\_style, |
| [532](#L532) | $required\_mark\_html\_template, |
| [533](#L533) | $table\_data |
| [534](#L534) | ); |
| [535](#L535) | $table\_data = $this->maybe\_add\_taxonomy\_field( |
| [536](#L536) | $atts, |
| [537](#L537) | $args, |
| [538](#L538) | 'tags', |
| [539](#L539) | 'product\_tag', |
| [540](#L540) | \_\_( 'Tags', 'woocommerce-jetpack' ), |
| [541](#L541) | $input\_style, |
| [542](#L542) | $required\_mark\_html\_template, |
| [543](#L543) | $table\_data |
| [544](#L544) | ); |
| [545](#L545) | for ( $i = 1; $i <= $this->the\_atts['custom\_taxonomies\_total']; $i++ ) { |
| [546](#L546) | $table\_data = $this->maybe\_add\_taxonomy\_field( |
| [547](#L547) | $atts, |
| [548](#L548) | $args, |
| [549](#L549) | 'custom\_taxonomy\_' . $i, |
| [550](#L550) | $atts[ 'custom\_taxonomy\_' . $i . '\_id' ], |
| [551](#L551) | $atts[ 'custom\_taxonomy\_' . $i . '\_title' ], |
| [552](#L552) | $input\_style, |
| [553](#L553) | $required\_mark\_html\_template, |
| [554](#L554) | $table\_data |
| [555](#L555) | ); |
| [556](#L556) | } |
| [557](#L557) |  |
| [558](#L558) | $input\_fields\_html .= wcj\_get\_table\_html( |
| [559](#L559) | $table\_data, |
| [560](#L560) | array( |
| [561](#L561) | 'table\_class'        => 'widefat', |
| [562](#L562) | 'table\_heading\_type' => 'vertical', |
| [563](#L563) | ) |
| [564](#L564) | ); |
| [565](#L565) |  |
| [566](#L566) | $footer\_html .= '<input type="submit" class="button" name="wcj\_add\_new\_product" value="' . ( ( 0 === $atts['product\_id'] ) ? |
| [567](#L567) | \_\_( 'Add', 'woocommerce-jetpack' ) : \_\_( 'Edit', 'woocommerce-jetpack' ) ) . '">'; |
| [568](#L568) | $footer\_html .= wp\_nonce\_field( 'wcj\_add\_new\_product', 'wcj\_add\_new\_product-nonce', true, false ); |
| [569](#L569) | $footer\_html .= '</form>'; |
| [570](#L570) |  |
| [571](#L571) | return $notice\_html . $header\_html . $input\_fields\_html . $footer\_html; |
| [572](#L572) | } |
| [573](#L573) |  |
| [574](#L574) | } |
| [575](#L575) |  |
| [576](#L576) | endif; |
| [577](#L577) |  |
| [578](#L578) | return new WCJ\_Products\_Add\_Form\_Shortcodes(); |

**Note:** See [TracBrowser](/wiki/TracBrowser)
for help on using the repository browser.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Plain Text](/browser/woocommerce-jetpack/trunk/includes/shortcodes/class-wcj-products-add-form-shortcodes.php?format=txt)
* [Original Format](/export/3220264/woocommerce-jetpack/trunk/includes/shortcodes/class-wcj-products-add-form-shortcodes.php)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)



=== Content from plugins.trac.wordpress.org_8f69bdd3_20250110_141722.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fbrowser%2Fwoocommerce-jetpack%2Ftrunk%2Fincludes%2Fshortcodes%2Fclass-wcj-products-add-form-shortcodes.php)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Revision](/browser/woocommerce-jetpack/trunk/includes/shortcodes/class-wcj-products-add-form-shortcodes.php?rev=3046146 "Revision 3046146")
* Next Revision →
* [Blame](/browser/woocommerce-jetpack/trunk/includes/shortcodes/class-wcj-products-add-form-shortcodes.php?annotate=blame "Annotate each line with the last changed revision (this can be time consuming...)")
* [Revision Log](/log/woocommerce-jetpack/trunk/includes/shortcodes/class-wcj-products-add-form-shortcodes.php)

---

# [source:](/browser?order=name "Go to repository root") [woocommerce-jetpack](/browser/woocommerce-jetpack?order=name "View woocommerce-jetpack")/[trunk](/browser/woocommerce-jetpack/trunk?order=name "View trunk")/[includes](/browser/woocommerce-jetpack/trunk/includes?order=name "View includes")/[shortcodes](/browser/woocommerce-jetpack/trunk/includes/shortcodes?order=name "View shortcodes")/[class-wcj-products-add-form-shortcodes.php](/browser/woocommerce-jetpack/trunk/includes/shortcodes/class-wcj-products-add-form-shortcodes.php?order=name "View class-wcj-products-add-form-shortcodes.php")

View diff against:

View revision:

| [Last change](/changeset/3115290/woocommerce-jetpack/trunk/includes/shortcodes/class-wcj-products-add-form-shortcodes.php "View differences") on this file was [3115290](/changeset/3115290/ "View changeset 3115290"), checked in by ronyp, [6 months ago](/timeline?from=2024-07-10T06%3A28%3A56Z&precision=second "See timeline at 07/10/2024 06:28:56 AM") |
| --- |
| v7.1.2 |
| **File size:** 28.9 KB | |

| Line |  |
| --- | --- |
| [1](#L1) | <?php |
| [2](#L2) | /\*\* |
| [3](#L3) | \* Booster for WooCommerce - Shortcodes - Products Add Form |
| [4](#L4) | \* |
| [5](#L5) | \* @version 7.2.1 |
| [6](#L6) | \* @since   2.5.0 |
| [7](#L7) | \* @author  Pluggabl LLC. |
| [8](#L8) | \* @package Booster\_For\_WooCommerce/shortcodes |
| [9](#L9) | \*/ |
| [10](#L10) |  |
| [11](#L11) | if ( ! defined( 'ABSPATH' ) ) { |
| [12](#L12) | exit; |
| [13](#L13) | } |
| [14](#L14) |  |
| [15](#L15) | if ( ! class\_exists( 'WCJ\_Products\_Add\_Form\_Shortcodes' ) ) : |
| [16](#L16) | /\*\* |
| [17](#L17) | \* WCJ\_Products\_Add\_Form\_Shortcodes. |
| [18](#L18) | \*/ |
| [19](#L19) | class WCJ\_Products\_Add\_Form\_Shortcodes extends WCJ\_Shortcodes { |
| [20](#L20) |  |
| [21](#L21) | /\*\* |
| [22](#L22) | \* Constructor. |
| [23](#L23) | \* |
| [24](#L24) | \* @version 2.8.0 |
| [25](#L25) | \* @since   2.5.0 |
| [26](#L26) | \* @todo    refill image on not validated (or after successful addition); more messages options; more styling options; custom fields; |
| [27](#L27) | \* @todo    (maybe) `product\_id => ( isset( $\_GET['wcj\_edit\_product'] ) ? $\_GET['wcj\_edit\_product'] : 0 )` |
| [28](#L28) | \*/ |
| [29](#L29) | public function \_\_construct() { |
| [30](#L30) |  |
| [31](#L31) | $this->the\_shortcodes = array( |
| [32](#L32) | 'wcj\_product\_add\_new', |
| [33](#L33) | ); |
| [34](#L34) |  |
| [35](#L35) | $this->the\_atts = array( |
| [36](#L36) | 'product\_id'             => 0, |
| [37](#L37) | 'post\_status'            => wcj\_get\_option( 'wcj\_product\_by\_user\_status', 'draft' ), |
| [38](#L38) |  |
| [39](#L39) | 'desc\_enabled'           => wcj\_get\_option( 'wcj\_product\_by\_user\_desc\_enabled', 'no' ), |
| [40](#L40) | 'short\_desc\_enabled'     => wcj\_get\_option( 'wcj\_product\_by\_user\_short\_desc\_enabled', 'no' ), |
| [41](#L41) | 'regular\_price\_enabled'  => wcj\_get\_option( 'wcj\_product\_by\_user\_regular\_price\_enabled', 'no' ), |
| [42](#L42) | 'sale\_price\_enabled'     => wcj\_get\_option( 'wcj\_product\_by\_user\_sale\_price\_enabled', 'no' ), |
| [43](#L43) | 'external\_url\_enabled'   => wcj\_get\_option( 'wcj\_product\_by\_user\_external\_url\_enabled', 'no' ), |
| [44](#L44) | 'cats\_enabled'           => wcj\_get\_option( 'wcj\_product\_by\_user\_cats\_enabled', 'no' ), |
| [45](#L45) | 'tags\_enabled'           => wcj\_get\_option( 'wcj\_product\_by\_user\_tags\_enabled', 'no' ), |
| [46](#L46) | 'image\_enabled'          => apply\_filters( 'booster\_option', 'no', wcj\_get\_option( 'wcj\_product\_by\_user\_image\_enabled', 'no' ) ), |
| [47](#L47) |  |
| [48](#L48) | 'desc\_required'          => wcj\_get\_option( 'wcj\_product\_by\_user\_desc\_required', 'no' ), |
| [49](#L49) | 'short\_desc\_required'    => wcj\_get\_option( 'wcj\_product\_by\_user\_short\_desc\_required', 'no' ), |
| [50](#L50) | 'regular\_price\_required' => wcj\_get\_option( 'wcj\_product\_by\_user\_regular\_price\_required', 'no' ), |
| [51](#L51) | 'sale\_price\_required'    => wcj\_get\_option( 'wcj\_product\_by\_user\_sale\_price\_required', 'no' ), |
| [52](#L52) | 'external\_url\_required'  => wcj\_get\_option( 'wcj\_product\_by\_user\_external\_url\_required', 'no' ), |
| [53](#L53) | 'cats\_required'          => wcj\_get\_option( 'wcj\_product\_by\_user\_cats\_required', 'no' ), |
| [54](#L54) | 'tags\_required'          => wcj\_get\_option( 'wcj\_product\_by\_user\_tags\_required', 'no' ), |
| [55](#L55) | 'image\_required'         => apply\_filters( 'booster\_option', 'no', wcj\_get\_option( 'wcj\_product\_by\_user\_image\_required', 'no' ) ), |
| [56](#L56) |  |
| [57](#L57) | 'visibility'             => implode( ',', wcj\_get\_option( 'wcj\_product\_by\_user\_user\_visibility', array() ) ), |
| [58](#L58) | 'module'                 => 'product\_by\_user', |
| [59](#L59) | 'module\_name'            => \_\_( 'Product by User', 'woocommerce-jetpack' ), |
| [60](#L60) | ); |
| [61](#L61) |  |
| [62](#L62) | if ( 'external' !== wcj\_get\_option( 'wcj\_product\_by\_user\_product\_type', 'simple' ) ) { |
| [63](#L63) | $this->the\_atts['external\_url\_enabled']  = 'no'; |
| [64](#L64) | $this->the\_atts['external\_url\_required'] = 'no'; |
| [65](#L65) | } |
| [66](#L66) |  |
| [67](#L67) | $this->the\_atts['custom\_taxonomies\_total'] = apply\_filters( 'booster\_option', 1, wcj\_get\_option( 'wcj\_product\_by\_user\_custom\_taxonomies\_total', 1 ) ); |
| [68](#L68) | for ( $i = 1; $i <= $this->the\_atts['custom\_taxonomies\_total']; $i++ ) { |
| [69](#L69) | $this->the\_atts[ 'custom\_taxonomy\_' . $i . '\_enabled' ]  = wcj\_get\_option( 'wcj\_product\_by\_user\_custom\_taxonomy\_' . $i . '\_enabled', 'no' ); |
| [70](#L70) | $this->the\_atts[ 'custom\_taxonomy\_' . $i . '\_required' ] = wcj\_get\_option( 'wcj\_product\_by\_user\_custom\_taxonomy\_' . $i . '\_required', 'no' ); |
| [71](#L71) | $this->the\_atts[ 'custom\_taxonomy\_' . $i . '\_id' ]       = wcj\_get\_option( 'wcj\_product\_by\_user\_custom\_taxonomy\_' . $i . '\_id', '' ); |
| [72](#L72) | $this->the\_atts[ 'custom\_taxonomy\_' . $i . '\_title' ]    = wcj\_get\_option( 'wcj\_product\_by\_user\_custom\_taxonomy\_' . $i . '\_title', '' ); |
| [73](#L73) | } |
| [74](#L74) |  |
| [75](#L75) | parent::\_\_construct(); |
| [76](#L76) | } |
| [77](#L77) |  |
| [78](#L78) | /\*\* |
| [79](#L79) | \* Init\_atts. |
| [80](#L80) | \* |
| [81](#L81) | \* @version 7.2.1 |
| [82](#L82) | \* @param array $atts The user defined shortcode attributes. |
| [83](#L83) | \*/ |
| [84](#L84) | public function init\_atts( $atts ) { |
| [85](#L85) | $atts['product\_id']              = (int) wcj\_sanitize\_input\_attribute\_values( $atts['product\_id'] ); |
| [86](#L86) | $atts['post\_status']             = wcj\_sanitize\_input\_attribute\_values( $atts['post\_status'] ); |
| [87](#L87) | $atts['desc\_enabled']            = wcj\_sanitize\_input\_attribute\_values( $atts['desc\_enabled'] ); |
| [88](#L88) | $atts['short\_desc\_enabled']      = wcj\_sanitize\_input\_attribute\_values( $atts['short\_desc\_enabled'] ); |
| [89](#L89) | $atts['regular\_price\_enabled']   = wcj\_sanitize\_input\_attribute\_values( $atts['regular\_price\_enabled'] ); |
| [90](#L90) | $atts['sale\_price\_enabled']      = wcj\_sanitize\_input\_attribute\_values( $atts['sale\_price\_enabled'] ); |
| [91](#L91) | $atts['external\_url\_enabled']    = wcj\_sanitize\_input\_attribute\_values( $atts['external\_url\_enabled'] ); |
| [92](#L92) | $atts['cats\_enabled']            = wcj\_sanitize\_input\_attribute\_values( $atts['cats\_enabled'] ); |
| [93](#L93) | $atts['tags\_enabled']            = wcj\_sanitize\_input\_attribute\_values( $atts['tags\_enabled'] ); |
| [94](#L94) | $atts['image\_gallery\_enabled']   = wcj\_sanitize\_input\_attribute\_values( $atts['image\_gallery\_enabled'] ); |
| [95](#L95) | $atts['image\_enabled']           = wcj\_sanitize\_input\_attribute\_values( $atts['image\_enabled'] ); |
| [96](#L96) | $atts['desc\_required']           = wcj\_sanitize\_input\_attribute\_values( $atts['desc\_required'] ); |
| [97](#L97) | $atts['short\_desc\_required']     = wcj\_sanitize\_input\_attribute\_values( $atts['short\_desc\_required'] ); |
| [98](#L98) | $atts['regular\_price\_required']  = wcj\_sanitize\_input\_attribute\_values( $atts['regular\_price\_required'] ); |
| [99](#L99) | $atts['sale\_price\_required']     = wcj\_sanitize\_input\_attribute\_values( $atts['sale\_price\_required'] ); |
| [100](#L100) | $atts['external\_url\_required']   = wcj\_sanitize\_input\_attribute\_values( $atts['external\_url\_required'] ); |
| [101](#L101) | $atts['cats\_required']           = wcj\_sanitize\_input\_attribute\_values( $atts['cats\_required'] ); |
| [102](#L102) | $atts['tags\_required']           = wcj\_sanitize\_input\_attribute\_values( $atts['tags\_required'] ); |
| [103](#L103) | $atts['image\_required']          = wcj\_sanitize\_input\_attribute\_values( $atts['image\_required'] ); |
| [104](#L104) | $atts['image\_gallery\_required']  = wcj\_sanitize\_input\_attribute\_values( $atts['image\_gallery\_required'] ); |
| [105](#L105) | $atts['visibility']              = wcj\_sanitize\_input\_attribute\_values( $atts['visibility'], 'restrict\_quotes' ); |
| [106](#L106) | $atts['module']                  = wcj\_sanitize\_input\_attribute\_values( $atts['module'] ); |
| [107](#L107) | $atts['module\_name']             = wcj\_sanitize\_input\_attribute\_values( $atts['module\_name'] ); |
| [108](#L108) | $atts['custom\_taxonomies\_total'] = wcj\_sanitize\_input\_attribute\_values( $atts['custom\_taxonomies\_total'] ); |
| [109](#L109) | for ( $i = 1; $i <= $atts['custom\_taxonomies\_total']; $i++ ) { |
| [110](#L110) | $atts[ 'custom\_taxonomy\_' . $i . '\_enabled' ]  = wcj\_sanitize\_input\_attribute\_values( $atts[ 'custom\_taxonomy\_' . $i . '\_enabled' ] ); |
| [111](#L111) | $atts[ 'custom\_taxonomy\_' . $i . '\_required' ] = wcj\_sanitize\_input\_attribute\_values( $atts[ 'custom\_taxonomy\_' . $i . '\_required' ] ); |
| [112](#L112) | $atts[ 'custom\_taxonomy\_' . $i . '\_id' ]       = wcj\_sanitize\_input\_attribute\_values( $atts[ 'custom\_taxonomy\_' . $i . '\_id' ] ); |
| [113](#L113) | $atts[ 'custom\_taxonomy\_' . $i . '\_title' ]    = wcj\_sanitize\_input\_attribute\_values( $atts[ 'custom\_taxonomy\_' . $i . '\_title' ] ); |
| [114](#L114) | } |
| [115](#L115) | return $atts; |
| [116](#L116) | } |
| [117](#L117) |  |
| [118](#L118) | /\*\* |
| [119](#L119) | \* Wc\_add\_new\_product. |
| [120](#L120) | \* |
| [121](#L121) | \* @version 2.8.0 |
| [122](#L122) | \* @since   2.5.0 |
| [123](#L123) | \* @todo    image gallery: `<input type="file" multiple>` or separate `<input type="file">` for each file; `update\_post\_meta( $product\_id, '\_product\_image\_gallery', implode( ',', $attach\_ids ) );` |
| [124](#L124) | \* @param array $args The user defined shortcode args. |
| [125](#L125) | \* @param array $shortcode\_atts The user defined shortcode shortcode\_atts. |
| [126](#L126) | \*/ |
| [127](#L127) | public function wc\_add\_new\_product( $args, $shortcode\_atts ) { |
| [128](#L128) |  |
| [129](#L129) | $product\_post = array( |
| [130](#L130) | 'post\_title'   => $args['title'], |
| [131](#L131) | 'post\_content' => $args['desc'], |
| [132](#L132) | 'post\_excerpt' => $args['short\_desc'], |
| [133](#L133) | 'post\_type'    => 'product', |
| [134](#L134) | 'post\_status'  => 'draft', |
| [135](#L135) | ); |
| [136](#L136) |  |
| [137](#L137) | if ( 0 === $shortcode\_atts['product\_id'] ) { |
| [138](#L138) | $product\_id = wp\_insert\_post( $product\_post ); |
| [139](#L139) | } else { |
| [140](#L140) | $product\_id = $shortcode\_atts['product\_id']; |
| [141](#L141) | wp\_update\_post( array\_merge( array( 'ID' => $product\_id ), $product\_post ) ); |
| [142](#L142) | } |
| [143](#L143) |  |
| [144](#L144) | // Insert the post into the database. |
| [145](#L145) | if ( 0 !== $product\_id ) { |
| [146](#L146) |  |
| [147](#L147) | wp\_set\_object\_terms( $product\_id, wcj\_get\_option( 'wcj\_product\_by\_user\_product\_type', 'simple' ), 'product\_type' ); |
| [148](#L148) | wp\_set\_object\_terms( $product\_id, $args['cats'], 'product\_cat' ); |
| [149](#L149) | wp\_set\_object\_terms( $product\_id, $args['tags'], 'product\_tag' ); |
| [150](#L150) |  |
| [151](#L151) | for ( $i = 1; $i <= $this->the\_atts['custom\_taxonomies\_total']; $i++ ) { |
| [152](#L152) | if ( 'yes' === $this->the\_atts[ 'custom\_taxonomy\_' . $i . '\_enabled' ] && '' !== $this->the\_atts[ 'custom\_taxonomy\_' . $i . '\_id' ] ) { |
| [153](#L153) | wp\_set\_object\_terms( $product\_id, $args[ 'custom\_taxonomy\_' . $i ], $this->the\_atts[ 'custom\_taxonomy\_' . $i . '\_id' ] ); |
| [154](#L154) | } |
| [155](#L155) | } |
| [156](#L156) |  |
| [157](#L157) | update\_post\_meta( $product\_id, '\_regular\_price', $args['regular\_price'] ); |
| [158](#L158) | update\_post\_meta( $product\_id, '\_sale\_price', $args['sale\_price'] ); |
| [159](#L159) | if ( '' === $args['sale\_price'] ) { |
| [160](#L160) | update\_post\_meta( $product\_id, '\_price', $args['regular\_price'] ); |
| [161](#L161) | } else { |
| [162](#L162) | update\_post\_meta( $product\_id, '\_price', $args['sale\_price'] ); |
| [163](#L163) | } |
| [164](#L164) | update\_post\_meta( $product\_id, '\_visibility', 'visible' ); |
| [165](#L165) | update\_post\_meta( $product\_id, '\_stock\_status', 'instock' ); |
| [166](#L166) |  |
| [167](#L167) | if ( 'external' === wcj\_get\_option( 'wcj\_product\_by\_user\_product\_type', 'simple' ) ) { |
| [168](#L168) | update\_post\_meta( $product\_id, '\_product\_url', $args['external\_url'] ); |
| [169](#L169) | } |
| [170](#L170) |  |
| [171](#L171) | // Image. |
| [172](#L172) | if ( '' !== $args['image'] && '' !== $args['image']['tmp\_name'] ) { |
| [173](#L173) | $upload\_dir = wp\_upload\_dir(); |
| [174](#L174) | $filename   = $args['image']['name']; |
| [175](#L175) | $file       = ( wp\_mkdir\_p( $upload\_dir['path'] ) ) ? $upload\_dir['path'] : $upload\_dir['basedir']; |
| [176](#L176) | $file      .= '/' . $filename; |
| [177](#L177) |  |
| [178](#L178) | move\_uploaded\_file( $args['image']['tmp\_name'], $file ); |
| [179](#L179) |  |
| [180](#L180) | $wp\_filetype = wp\_check\_filetype( $filename, null ); |
| [181](#L181) | $attachment  = array( |
| [182](#L182) | 'post\_mime\_type' => $wp\_filetype['type'], |
| [183](#L183) | 'post\_title'     => sanitize\_file\_name( $filename ), |
| [184](#L184) | 'post\_content'   => '', |
| [185](#L185) | 'post\_status'    => 'inherit', |
| [186](#L186) | ); |
| [187](#L187) | $attach\_id   = wp\_insert\_attachment( $attachment, $file, $product\_id ); |
| [188](#L188) | require\_once ABSPATH . 'wp-admin/includes/image.php'; |
| [189](#L189) | $attach\_data = wp\_generate\_attachment\_metadata( $attach\_id, $file ); |
| [190](#L190) | wp\_update\_attachment\_metadata( $attach\_id, $attach\_data ); |
| [191](#L191) |  |
| [192](#L192) | set\_post\_thumbnail( $product\_id, $attach\_id ); |
| [193](#L193) | } |
| [194](#L194) |  |
| [195](#L195) | wp\_update\_post( |
| [196](#L196) | array( |
| [197](#L197) | 'ID'          => $product\_id, |
| [198](#L198) | 'post\_status' => $shortcode\_atts['post\_status'], |
| [199](#L199) | ) |
| [200](#L200) | ); |
| [201](#L201) | } |
| [202](#L202) |  |
| [203](#L203) | return $product\_id; |
| [204](#L204) | } |
| [205](#L205) |  |
| [206](#L206) | /\*\* |
| [207](#L207) | \* Validate\_args. |
| [208](#L208) | \* |
| [209](#L209) | \* @version 7.1.8 |
| [210](#L210) | \* @since   2.5.0 |
| [211](#L211) | \* @param array $args The user defined shortcode args. |
| [212](#L212) | \* @param array $shortcode\_atts The user defined shortcode shortcode\_atts. |
| [213](#L213) | \*/ |
| [214](#L214) | public function validate\_args( $args, $shortcode\_atts ) { |
| [215](#L215) | $errors = ''; |
| [216](#L216) | if ( '' === $args['title'] ) { |
| [217](#L217) | $errors .= '<li>' . \_\_( 'Title is required!', 'woocommerce-jetpack' ) . '</li>'; |
| [218](#L218) | } |
| [219](#L219) |  |
| [220](#L220) | if ( 'yes' === wcj\_get\_option( 'wcj\_product\_by\_user\_require\_unique\_title', 'no' ) && 0 === $shortcode\_atts['product\_id'] ) { |
| [221](#L221) | if ( ! function\_exists( 'post\_exists' ) ) { |
| [222](#L222) | require\_once ABSPATH . 'wp-admin/includes/post.php'; |
| [223](#L223) | } |
| [224](#L224) | if ( post\_exists( $args['title'] ) ) { |
| [225](#L225) | $errors .= '<li>' . \_\_( 'Product exists!', 'woocommerce-jetpack' ) . '</li>'; |
| [226](#L226) | } |
| [227](#L227) | } |
| [228](#L228) |  |
| [229](#L229) | $fields = array( |
| [230](#L230) | 'desc'          => \_\_( 'Description', 'woocommerce-jetpack' ), |
| [231](#L231) | 'short\_desc'    => \_\_( 'Short Description', 'woocommerce-jetpack' ), |
| [232](#L232) | 'image'         => \_\_( 'Image', 'woocommerce-jetpack' ), |
| [233](#L233) | 'regular\_price' => \_\_( 'Regular Price', 'woocommerce-jetpack' ), |
| [234](#L234) | 'sale\_price'    => \_\_( 'Sale Price', 'woocommerce-jetpack' ), |
| [235](#L235) | 'external\_url'  => \_\_( 'Product URL', 'woocommerce-jetpack' ), |
| [236](#L236) | 'cats'          => \_\_( 'Categories', 'woocommerce-jetpack' ), |
| [237](#L237) | 'tags'          => \_\_( 'Tags', 'woocommerce-jetpack' ), |
| [238](#L238) | ); |
| [239](#L239) | for ( $i = 1; $i <= $this->the\_atts['custom\_taxonomies\_total']; $i++ ) { |
| [240](#L240) | $fields[ 'custom\_taxonomy\_' . $i ] = $this->the\_atts[ 'custom\_taxonomy\_' . $i . '\_title' ]; |
| [241](#L241) | } |
| [242](#L242) | foreach ( $fields as $field\_id => $field\_desc ) { |
| [243](#L243) | if ( 'yes' === $shortcode\_atts[ $field\_id . '\_enabled' ] && 'yes' === $shortcode\_atts[ $field\_id . '\_required' ] ) { |
| [244](#L244) | $is\_missing = false; |
| [245](#L245) | if ( 'image' === $field\_id && ( '' === $args[ $field\_id ] || ! isset( $args[ $field\_id ]['tmp\_name'] ) || '' === $args[ $field\_id ]['tmp\_name'] ) ) { |
| [246](#L246) | $is\_missing = true; |
| [247](#L247) | } elseif ( empty( $args[ $field\_id ] ) ) { |
| [248](#L248) | $is\_missing = true; |
| [249](#L249) | } |
| [250](#L250) | if ( $is\_missing ) { |
| [251](#L251) | /\* translators: %s: translation added \*/ |
| [252](#L252) | $errors .= '<li>' . sprintf( \_\_( '%s is required!', 'woocommerce-jetpack' ), $field\_desc ) . '</li>'; |
| [253](#L253) | } |
| [254](#L254) | } |
| [255](#L255) | } |
| [256](#L256) |  |
| [257](#L257) | if ( $args['sale\_price'] > $args['regular\_price'] ) { |
| [258](#L258) | $errors .= '<li>' . \_\_( 'Sale price must be less than the regular price!', 'woocommerce-jetpack' ) . '</li>'; |
| [259](#L259) | } |
| [260](#L260) |  |
| [261](#L261) | $product\_image\_name = isset( $args['image']['name'] ) ? sanitize\_text\_field( wp\_unslash( $args['image']['name'] ) ) : ''; |
| [262](#L262) | $gallery\_images     = isset( $args['image\_gallery']['name'] ) ? array\_map( 'sanitize\_text\_field', wp\_unslash( $args['image\_gallery']['name'] ) ) : array(); |
| [263](#L263) |  |
| [264](#L264) | $allowed\_types = array( '.jpg', '.jpeg', '.png', '.webp', '.heic', '.heif', '.gif' ); // Allowed File types by WordPress https://wordpress.com/support/accepted-filetypes/. |
| [265](#L265) |  |
| [266](#L266) | // Verify and restrict Product Image. |
| [267](#L267) | if ( isset( $product\_image\_name ) && '' !== $product\_image\_name ) { |
| [268](#L268) | $file\_type = '.' . pathinfo( $product\_image\_name, PATHINFO\_EXTENSION ); |
| [269](#L269) | if ( ! in\_array( $file\_type, $allowed\_types, true ) ) { |
| [270](#L270) | $errors .= '<li>' . \_\_( 'Sorry, only JPG, JPEG, PNG, WEBP, HEIC, HEIF and GIF files are allowed', 'woocommerce-jetpack' ) . '</li>'; |
| [271](#L271) | } |
| [272](#L272) | } |
| [273](#L273) | // Verify and restrict Gallery Image. |
| [274](#L274) | if ( isset( $gallery\_images ) && ! empty( array\_filter( $gallery\_images ) ) ) { |
| [275](#L275) | $error\_encountered = false; // Flag variable to track if an error has been encountered. |
| [276](#L276) | foreach ( $gallery\_images as $gallery\_image\_name ) { |
| [277](#L277) | $gallery\_file\_type = '.' . pathinfo( $gallery\_image\_name, PATHINFO\_EXTENSION ); |
| [278](#L278) | if ( ! in\_array( $gallery\_file\_type, $allowed\_types, true ) ) { |
| [279](#L279) | if ( ! $error\_encountered && ! $errors ) { |
| [280](#L280) |  |
| [281](#L281) | $errors           .= '<li>' . \_\_( 'Sorry, only JPG, JPEG, PNG, WEBP, HEIC, HEIF and GIF files are allowed', 'woocommerce-jetpack' ) . '</li>'; |
| [282](#L282) | $error\_encountered = true; // Set the flag to true to indicate error has been encountered. |
| [283](#L283) | } |
| [284](#L284) | } |
| [285](#L285) | } |
| [286](#L286) | } |
| [287](#L287) | return ( '' === $errors ) ? true : $errors; |
| [288](#L288) | } |
| [289](#L289) |  |
| [290](#L290) | /\*\* |
| [291](#L291) | \* Maybe\_add\_taxonomy\_field. |
| [292](#L292) | \* |
| [293](#L293) | \* @version 2.8.0 |
| [294](#L294) | \* @since   2.8.0 |
| [295](#L295) | \* @param array        $atts The user defined shortcode atts. |
| [296](#L296) | \* @param array        $args The user defined shortcode args. |
| [297](#L297) | \* @param int | string $option\_id The user defined shortcode option\_id. |
| [298](#L298) | \* @param int | string $taxonomy\_id The user defined shortcode taxonomy\_id. |
| [299](#L299) | \* @param string       $title The user defined shortcode title. |
| [300](#L300) | \* @param string       $input\_style The user defined shortcode input\_style. |
| [301](#L301) | \* @param string       $required\_mark\_html\_template The user defined shortcode required\_mark\_html\_template. |
| [302](#L302) | \* @param array        $table\_data The user defined shortcode table\_data. |
| [303](#L303) | \*/ |
| [304](#L304) | public function maybe\_add\_taxonomy\_field( $atts, $args, $option\_id, $taxonomy\_id, $title, $input\_style, $required\_mark\_html\_template, $table\_data ) { |
| [305](#L305) | if ( 'yes' === $atts[ $option\_id . '\_enabled' ] ) { |
| [306](#L306) | $product\_taxonomies = get\_terms( $taxonomy\_id, 'orderby=name&hide\_empty=0' ); |
| [307](#L307) | if ( is\_wp\_error( $product\_taxonomies ) ) { |
| [308](#L308) | return $table\_data; |
| [309](#L309) | } |
| [310](#L310) | $required\_html                        = ( 'yes' === $atts[ $option\_id . '\_required' ] ) ? ' required' : ''; |
| [311](#L311) | $required\_mark\_html                   = ( 'yes' === $atts[ $option\_id . '\_required' ] ) ? $required\_mark\_html\_template : ''; |
| [312](#L312) | $current\_product\_taxonomies           = ( 0 !== $atts['product\_id'] ) ? get\_the\_terms( $atts['product\_id'], $taxonomy\_id ) : $args[ $option\_id ]; |
| [313](#L313) | $product\_taxonomies\_as\_select\_options = ''; |
| [314](#L314) | foreach ( $product\_taxonomies as $product\_taxonomy ) { |
| [315](#L315) | $selected = ''; |
| [316](#L316) | if ( ! empty( $current\_product\_taxonomies ) ) { |
| [317](#L317) | foreach ( $current\_product\_taxonomies as $current\_product\_taxonomy ) { |
| [318](#L318) | if ( is\_object( $current\_product\_taxonomy ) ) { |
| [319](#L319) | $current\_product\_taxonomy = $current\_product\_taxonomy->slug; |
| [320](#L320) | } |
| [321](#L321) | $selected .= selected( $current\_product\_taxonomy, $product\_taxonomy->slug, false ); |
| [322](#L322) | } |
| [323](#L323) | } |
| [324](#L324) | $product\_taxonomies\_as\_select\_options .= '<option value="' . $product\_taxonomy->slug . '" ' . $selected . '>' . $product\_taxonomy->name . '</option>'; |
| [325](#L325) | } |
| [326](#L326) | $table\_data[] = array( |
| [327](#L327) | '<label for="wcj\_add\_new\_product\_' . $option\_id . '">' . $title . $required\_mark\_html . '</label>', |
| [328](#L328) | '<select' . $required\_html . ' multiple style="' . $input\_style . '" id="wcj\_add\_new\_product\_' . $option\_id . '" name="wcj\_add\_new\_product\_' . $option\_id . '[]">' . |
| [329](#L329) | $product\_taxonomies\_as\_select\_options . |
| [330](#L330) | '</select>', |
| [331](#L331) | ); |
| [332](#L332) | } |
| [333](#L333) | return $table\_data; |
| [334](#L334) | } |
| [335](#L335) |  |
| [336](#L336) | /\*\* |
| [337](#L337) | \* Wcj\_product\_add\_new. |
| [338](#L338) | \* |
| [339](#L339) | \* @version 7.1.3 |
| [340](#L340) | \* @since   2.5.0 |
| [341](#L341) | \* @todo    `multipart` only if image |
| [342](#L342) | \* @param array $atts The user defined shortcode atts. |
| [343](#L343) | \*/ |
| [344](#L344) | public function wcj\_product\_add\_new( $atts ) { |
| [345](#L345) | // Allowed User-roles. |
| [346](#L346) | $allowed\_user\_roles = array( 'administrator', 'shop\_manager', 'customer' ); |
| [347](#L347) |  |
| [348](#L348) | if ( function\_exists( 'wcj\_get\_current\_user\_all\_roles' ) ) { |
| [349](#L349) | // Current user role. |
| [350](#L350) | $current\_user\_role = wcj\_get\_current\_user\_all\_roles(); |
| [351](#L351) |  |
| [352](#L352) | if ( isset( $current\_user\_role ) && ! empty( $current\_user\_role ) ) { |
| [353](#L353) | // Initialize a result array. |
| [354](#L354) | $authorized\_user = array(); |
| [355](#L355) |  |
| [356](#L356) | // Loop through the values to check. |
| [357](#L357) | foreach ( $current\_user\_role as $user\_role ) { |
| [358](#L358) | if ( in\_array( $user\_role, $allowed\_user\_roles, true ) ) { |
| [359](#L359) | // Value exists in the array. |
| [360](#L360) | $authorized\_user[] = $user\_role; |
| [361](#L361) | } |
| [362](#L362) | } |
| [363](#L363) |  |
| [364](#L364) | // Check the result. |
| [365](#L365) | if ( empty( $authorized\_user ) ) { |
| [366](#L366) | return false; |
| [367](#L367) | } |
| [368](#L368) | } else { |
| [369](#L369) | return false; // Executes if $current\_user\_role is empty. |
| [370](#L370) | } |
| [371](#L371) | } else { |
| [372](#L372) | return false; |
| [373](#L373) | } |
| [374](#L374) |  |
| [375](#L375) | $wpnonce           = isset( $\_REQUEST['wcj\_add\_new\_product-nonce'] ) ? wp\_verify\_nonce( sanitize\_key( $\_REQUEST['wcj\_add\_new\_product-nonce'] ), 'wcj\_add\_new\_product' ) : false; |
| [376](#L376) | $header\_html       = ''; |
| [377](#L377) | $notice\_html       = ''; |
| [378](#L378) | $input\_fields\_html = ''; |
| [379](#L379) | $footer\_html       = ''; |
| [380](#L380) |  |
| [381](#L381) | $args = array( |
| [382](#L382) | 'title'         => ( isset( $\_REQUEST['wcj\_add\_new\_product\_title'] ) ) ? sanitize\_text\_field( wp\_unslash( $\_REQUEST['wcj\_add\_new\_product\_title'] ) ) : '', |
| [383](#L383) | 'desc'          => isset( $\_REQUEST['wcj\_add\_new\_product\_desc'] ) ? sanitize\_text\_field( wp\_unslash( $\_REQUEST['wcj\_add\_new\_product\_desc'] ) ) : '', |
| [384](#L384) | 'short\_desc'    => isset( $\_REQUEST['wcj\_add\_new\_product\_short\_desc'] ) ? sanitize\_text\_field( wp\_unslash( $\_REQUEST['wcj\_add\_new\_product\_short\_desc'] ) ) : '', |
| [385](#L385) | 'regular\_price' => isset( $\_REQUEST['wcj\_add\_new\_product\_regular\_price'] ) ? sanitize\_text\_field( wp\_unslash( $\_REQUEST['wcj\_add\_new\_product\_regular\_price'] ) ) : '', |
| [386](#L386) | 'sale\_price'    => isset( $\_REQUEST['wcj\_add\_new\_product\_sale\_price'] ) ? sanitize\_text\_field( wp\_unslash( $\_REQUEST['wcj\_add\_new\_product\_sale\_price'] ) ) : '', |
| [387](#L387) | 'external\_url'  => isset( $\_REQUEST['wcj\_add\_new\_product\_external\_url'] ) ? sanitize\_text\_field( wp\_unslash( $\_REQUEST['wcj\_add\_new\_product\_external\_url'] ) ) : '', |
| [388](#L388) | 'cats'          => isset( $\_REQUEST['wcj\_add\_new\_product\_cats'] ) ? array\_map( 'sanitize\_text\_field', wp\_unslash( $\_REQUEST['wcj\_add\_new\_product\_cats'] ) ) : array(), |
| [389](#L389) | 'tags'          => isset( $\_REQUEST['wcj\_add\_new\_product\_tags'] ) ? sanitize\_text\_field( wp\_unslash( $\_REQUEST['wcj\_add\_new\_product\_tags'] ) ) : array(), |
| [390](#L390) | 'image'         => isset( $\_FILES['wcj\_add\_new\_product\_image'] ) ? sanitize\_text\_field( wp\_unslash( $\_FILES['wcj\_add\_new\_product\_image'] ) ) : '', |
| [391](#L391) | ); |
| [392](#L392) | for ( $i = 1; $i <= $this->the\_atts['custom\_taxonomies\_total']; $i++ ) { |
| [393](#L393) | $param\_id                        = 'wcj\_add\_new\_product\_custom\_taxonomy\_' . $i; |
| [394](#L394) | $args[ 'custom\_taxonomy\_' . $i ] = isset( $\_REQUEST[ $param\_id ] ) ? sanitize\_text\_field( wp\_unslash( $\_REQUEST[ $param\_id ] ) ) : array(); |
| [395](#L395) | } |
| [396](#L396) |  |
| [397](#L397) | if ( $wpnonce && isset( $\_REQUEST['wcj\_add\_new\_product'] ) ) { |
| [398](#L398) | $validate\_args = $this->validate\_args( $args, $atts ); |
| [399](#L399) | if ( true === ( $validate\_args ) ) { |
| [400](#L400) | $result = $this->wc\_add\_new\_product( $args, $atts ); |
| [401](#L401) | if ( 0 === $result ) { |
| [402](#L402) | // Error. |
| [403](#L403) | $notice\_html .= '<div class="woocommerce"><ul class="woocommerce-error"><li>' . \_\_( 'Error!', 'woocommerce-jetpack' ) . '</li></ul></div>'; |
| [404](#L404) | } else { |
| [405](#L405) | // Success. |
| [406](#L406) | if ( 0 === $atts['product\_id'] ) { |
| [407](#L407) | $notice\_html .= '<div class="woocommerce"><div class="woocommerce-message">' . |
| [408](#L408) | str\_replace( |
| [409](#L409) | '%product\_title%', |
| [410](#L410) | $args['title'], |
| [411](#L411) | get\_option( 'wcj\_product\_by\_user\_message\_product\_successfully\_added', \_\_( '"%product\_title%" successfully added!', 'woocommerce-jetpack' ) ) |
| [412](#L412) | ) . |
| [413](#L413) | '</div></div>'; |
| [414](#L414) | } else { |
| [415](#L415) | $notice\_html .= '<div class="woocommerce"><div class="woocommerce-message">' . |
| [416](#L416) | str\_replace( |
| [417](#L417) | '%product\_title%', |
| [418](#L418) | $args['title'], |
| [419](#L419) | get\_option( 'wcj\_product\_by\_user\_message\_product\_successfully\_edited', \_\_( '"%product\_title%" successfully edited!', 'woocommerce-jetpack' ) ) |
| [420](#L420) | ) . |
| [421](#L421) | '</div></div>'; |
| [422](#L422) | } |
| [423](#L423) | } |
| [424](#L424) | } else { |
| [425](#L425) | $notice\_html .= '<div class="woocommerce"><ul class="woocommerce-error">' . $validate\_args . '</ul></div>'; |
| [426](#L426) | } |
| [427](#L427) | } |
| [428](#L428) |  |
| [429](#L429) | if ( isset( $\_GET['wcj\_edit\_product\_image\_delete'] ) ) { |
| [430](#L430) | $product\_id     = sanitize\_text\_field( wp\_unslash( $\_GET['wcj\_edit\_product\_image\_delete'] ) ); |
| [431](#L431) | $post\_author\_id = get\_post\_field( 'post\_author', $product\_id ); |
| [432](#L432) | $user\_ID        = get\_current\_user\_id(); |
| [433](#L433) | if ( $user\_ID !== $post\_author\_id ) { |
| [434](#L434) | echo '<p>' . wp\_kses\_post( 'Wrong user ID!', 'woocommerce-jetpack' ) . '</p>'; |
| [435](#L435) | } else { |
| [436](#L436) | $image\_id = get\_post\_thumbnail\_id( $product\_id ); |
| [437](#L437) | wp\_delete\_post( $image\_id, true ); |
| [438](#L438) | } |
| [439](#L439) | } |
| [440](#L440) |  |
| [441](#L441) | if ( 0 !== $atts['product\_id'] ) { |
| [442](#L442) | $this->the\_product = wc\_get\_product( $atts['product\_id'] ); |
| [443](#L443) | } |
| [444](#L444) |  |
| [445](#L445) | $header\_html .= '<h3>'; |
| [446](#L446) | $header\_html .= ( 0 === $atts['product\_id'] ) ? \_\_( 'Add New Product', 'woocommerce-jetpack' ) : \_\_( 'Edit Product', 'woocommerce-jetpack' ); |
| [447](#L447) | $header\_html .= '</h3>'; |
| [448](#L448) | $header\_html .= '<form method="post" action="' . esc\_url( remove\_query\_arg( array( 'wcj\_edit\_product\_image\_delete', 'wcj\_delete\_product' ) ) ) . |
| [449](#L449) | '" enctype="multipart/form-data">'; |
| [450](#L450) |  |
| [451](#L451) | $required\_mark\_html\_template = '&nbsp;<abbr class="required" title="' . \_\_( 'required', 'woocommerce-jetpack' ) . '">\*</abbr>'; |
| [452](#L452) |  |
| [453](#L453) | $price\_step = sprintf( '%f', ( 1 / pow( 10, wcj\_get\_option( 'wcj\_product\_by\_user\_price\_step', wcj\_get\_option( 'woocommerce\_price\_num\_decimals', 2 ) ) ) ) ); |
| [454](#L454) |  |
| [455](#L455) | $table\_data   = array(); |
| [456](#L456) | $input\_style  = 'width:100%;'; |
| [457](#L457) | $table\_data[] = array( |
| [458](#L458) | '<label for="wcj\_add\_new\_product\_title">' . \_\_( 'Title', 'woocommerce-jetpack' ) . $required\_mark\_html\_template . '</label>', |
| [459](#L459) | '<input required type="text" style="' . $input\_style . '" id="wcj\_add\_new\_product\_title" name="wcj\_add\_new\_product\_title" value="' . ( ( 0 !== $atts['product\_id'] ) ? |
| [460](#L460) | $this->the\_product->get\_title() : $args['title'] ) . '">', |
| [461](#L461) | ); |
| [462](#L462) | if ( 'yes' === $atts['desc\_enabled'] ) { |
| [463](#L463) | $required\_html      = ( 'yes' === $atts['desc\_required'] ) ? ' required' : ''; |
| [464](#L464) | $required\_mark\_html = ( 'yes' === $atts['desc\_required'] ) ? $required\_mark\_html\_template : ''; |
| [465](#L465) | $table\_data[]       = array( |
| [466](#L466) | '<label for="wcj\_add\_new\_product\_desc">' . \_\_( 'Description', 'woocommerce-jetpack' ) . $required\_mark\_html . '</label>', |
| [467](#L467) | '<textarea' . $required\_html . ' style="' . $input\_style . '" id="wcj\_add\_new\_product\_desc" name="wcj\_add\_new\_product\_desc">' . ( ( 0 !== $atts['product\_id'] ) ? |
| [468](#L468) | get\_post\_field( 'post\_content', $atts['product\_id'] ) : $args['desc'] ) . '</textarea>', |
| [469](#L469) | ); |
| [470](#L470) | } |
| [471](#L471) | if ( 'yes' === $atts['short\_desc\_enabled'] ) { |
| [472](#L472) | $required\_html      = ( 'yes' === $atts['short\_desc\_required'] ) ? ' required' : ''; |
| [473](#L473) | $required\_mark\_html = ( 'yes' === $atts['short\_desc\_required'] ) ? $required\_mark\_html\_template : ''; |
| [474](#L474) | $table\_data[]       = array( |
| [475](#L475) | '<label for="wcj\_add\_new\_product\_short\_desc">' . \_\_( 'Short Description', 'woocommerce-jetpack' ) . $required\_mark\_html . '</label>', |
| [476](#L476) | '<textarea' . $required\_html . ' style="' . $input\_style . '" id="wcj\_add\_new\_product\_short\_desc" name="wcj\_add\_new\_product\_short\_desc">' . |
| [477](#L477) | ( ( 0 !== $atts['product\_id'] ) ? get\_post\_field( 'post\_excerpt', $atts['product\_id'] ) : $args['short\_desc'] ) . '</textarea>', |
| [478](#L478) | ); |
| [479](#L479) | } |
| [480](#L480) | if ( 'yes' === $atts['image\_enabled'] ) { |
| [481](#L481) | $required\_html      = ( 'yes' === $atts['image\_required'] ) ? ' required' : ''; |
| [482](#L482) | $required\_mark\_html = ( 'yes' === $atts['image\_required'] ) ? $required\_mark\_html\_template : ''; |
| [483](#L483) | $new\_image\_field    = '<input' . $required\_html . ' type="file" id="wcj\_add\_new\_product\_image" name="wcj\_add\_new\_product\_image" accept="image/\*">'; |
| [484](#L484) | if ( 0 !== $atts['product\_id'] ) { |
| [485](#L485) | $the\_field = ( '' === get\_post\_thumbnail\_id( $atts['product\_id'] ) ) ? |
| [486](#L486) | $new\_image\_field : |
| [487](#L487) | '<a href="' . esc\_url( add\_query\_arg( 'wcj\_edit\_product\_image\_delete', $atts['product\_id'] ) ) . '" onclick="return confirm(\'' . |
| [488](#L488) | \_\_( 'Are you sure?', 'woocommerce-jetpack' ) . '\')">' . \_\_( 'Delete', 'woocommerce-jetpack' ) . '</a><br>' . |
| [489](#L489) | get\_the\_post\_thumbnail( $atts['product\_id'], array( 50, 50 ), array( 'class' => 'alignleft' ) ); |
| [490](#L490) | } else { |
| [491](#L491) | $the\_field = $new\_image\_field; |
| [492](#L492) | } |
| [493](#L493) | $table\_data[] = array( |
| [494](#L494) | '<label for="wcj\_add\_new\_product\_image">' . \_\_( 'Image', 'woocommerce-jetpack' ) . $required\_mark\_html . '</label>', |
| [495](#L495) | $the\_field, |
| [496](#L496) | ); |
| [497](#L497) | } |
| [498](#L498) | if ( 'yes' === $atts['regular\_price\_enabled'] ) { |
| [499](#L499) | $required\_html      = ( 'yes' === $atts['regular\_price\_required'] ) ? ' required' : ''; |
| [500](#L500) | $required\_mark\_html = ( 'yes' === $atts['regular\_price\_required'] ) ? $required\_mark\_html\_template : ''; |
| [501](#L501) | $table\_data[]       = array( |
| [502](#L502) | '<label for="wcj\_add\_new\_product\_regular\_price">' . \_\_( 'Regular Price', 'woocommerce-jetpack' ) . $required\_mark\_html . '</label>', |
| [503](#L503) | '<input' . $required\_html . ' type="number" min="0" step="' . $price\_step . '" id="wcj\_add\_new\_product\_regular\_price" name="wcj\_add\_new\_product\_regular\_price" value="' . |
| [504](#L504) | ( ( 0 !== $atts['product\_id'] ) ? get\_post\_meta( $atts['product\_id'], '\_regular\_price', true ) : $args['regular\_price'] ) . '">', |
| [505](#L505) | ); |
| [506](#L506) | } |
| [507](#L507) | if ( 'yes' === $atts['sale\_price\_enabled'] ) { |
| [508](#L508) | $required\_html      = ( 'yes' === $atts['sale\_price\_required'] ) ? ' required' : ''; |
| [509](#L509) | $required\_mark\_html = ( 'yes' === $atts['sale\_price\_required'] ) ? $required\_mark\_html\_template : ''; |
| [510](#L510) | $table\_data[]       = array( |
| [511](#L511) | '<label for="wcj\_add\_new\_product\_sale\_price">' . \_\_( 'Sale Price', 'woocommerce-jetpack' ) . $required\_mark\_html . '</label>', |
| [512](#L512) | '<input' . $required\_html . ' type="number" min="0" step="' . $price\_step . '" id="wcj\_add\_new\_product\_sale\_price" name="wcj\_add\_new\_product\_sale\_price" value="' . |
| [513](#L513) | ( ( 0 !== $atts['product\_id'] ) ? get\_post\_meta( $atts['product\_id'], '\_sale\_price', true ) : $args['sale\_price'] ) . '">', |
| [514](#L514) | ); |
| [515](#L515) | } |
| [516](#L516) | if ( 'yes' === $atts['external\_url\_enabled'] ) { |
| [517](#L517) | $required\_html      = ( 'yes' === $atts['external\_url\_required'] ) ? ' required' : ''; |
| [518](#L518) | $required\_mark\_html = ( 'yes' === $atts['external\_url\_required'] ) ? $required\_mark\_html\_template : ''; |
| [519](#L519) | $table\_data[]       = array( |
| [520](#L520) | '<label for="wcj\_add\_new\_product\_external\_url">' . \_\_( 'Product URL', 'woocommerce-jetpack' ) . $required\_mark\_html\_template . '</label>', |
| [521](#L521) | '<input' . $required\_html . ' style="' . $input\_style . '" type="url" id="wcj\_add\_new\_product\_external\_url" name="wcj\_add\_new\_product\_external\_url" value="' . |
| [522](#L522) | ( ( 0 !== $atts['product\_id'] ) ? get\_post\_meta( $atts['product\_id'], '\_product\_url', true ) : $args['external\_url'] ) . '">', |
| [523](#L523) | ); |
| [524](#L524) | } |
| [525](#L525) | $table\_data = $this->maybe\_add\_taxonomy\_field( |
| [526](#L526) | $atts, |
| [527](#L527) | $args, |
| [528](#L528) | 'cats', |
| [529](#L529) | 'product\_cat', |
| [530](#L530) | \_\_( 'Categories', 'woocommerce-jetpack' ), |
| [531](#L531) | $input\_style, |
| [532](#L532) | $required\_mark\_html\_template, |
| [533](#L533) | $table\_data |
| [534](#L534) | ); |
| [535](#L535) | $table\_data = $this->maybe\_add\_taxonomy\_field( |
| [536](#L536) | $atts, |
| [537](#L537) | $args, |
| [538](#L538) | 'tags', |
| [539](#L539) | 'product\_tag', |
| [540](#L540) | \_\_( 'Tags', 'woocommerce-jetpack' ), |
| [541](#L541) | $input\_style, |
| [542](#L542) | $required\_mark\_html\_template, |
| [543](#L543) | $table\_data |
| [544](#L544) | ); |
| [545](#L545) | for ( $i = 1; $i <= $this->the\_atts['custom\_taxonomies\_total']; $i++ ) { |
| [546](#L546) | $table\_data = $this->maybe\_add\_taxonomy\_field( |
| [547](#L547) | $atts, |
| [548](#L548) | $args, |
| [549](#L549) | 'custom\_taxonomy\_' . $i, |
| [550](#L550) | $atts[ 'custom\_taxonomy\_' . $i . '\_id' ], |
| [551](#L551) | $atts[ 'custom\_taxonomy\_' . $i . '\_title' ], |
| [552](#L552) | $input\_style, |
| [553](#L553) | $required\_mark\_html\_template, |
| [554](#L554) | $table\_data |
| [555](#L555) | ); |
| [556](#L556) | } |
| [557](#L557) |  |
| [558](#L558) | $input\_fields\_html .= wcj\_get\_table\_html( |
| [559](#L559) | $table\_data, |
| [560](#L560) | array( |
| [561](#L561) | 'table\_class'        => 'widefat', |
| [562](#L562) | 'table\_heading\_type' => 'vertical', |
| [563](#L563) | ) |
| [564](#L564) | ); |
| [565](#L565) |  |
| [566](#L566) | $footer\_html .= '<input type="submit" class="button" name="wcj\_add\_new\_product" value="' . ( ( 0 === $atts['product\_id'] ) ? |
| [567](#L567) | \_\_( 'Add', 'woocommerce-jetpack' ) : \_\_( 'Edit', 'woocommerce-jetpack' ) ) . '">'; |
| [568](#L568) | $footer\_html .= wp\_nonce\_field( 'wcj\_add\_new\_product', 'wcj\_add\_new\_product-nonce', true, false ); |
| [569](#L569) | $footer\_html .= '</form>'; |
| [570](#L570) |  |
| [571](#L571) | return $notice\_html . $header\_html . $input\_fields\_html . $footer\_html; |
| [572](#L572) | } |
| [573](#L573) |  |
| [574](#L574) | } |
| [575](#L575) |  |
| [576](#L576) | endif; |
| [577](#L577) |  |
| [578](#L578) | return new WCJ\_Products\_Add\_Form\_Shortcodes(); |

**Note:** See [TracBrowser](/wiki/TracBrowser)
for help on using the repository browser.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Plain Text](/browser/woocommerce-jetpack/trunk/includes/shortcodes/class-wcj-products-add-form-shortcodes.php?format=txt)
* [Original Format](/export/3220264/woocommerce-jetpack/trunk/includes/shortcodes/class-wcj-products-add-form-shortcodes.php)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)



=== Content from plugins.trac.wordpress.org_97b1ded2_20250110_141724.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fbrowser%2Fwoocommerce-jetpack%2Ftrunk%2Fincludes%2Fshortcodes%2Fclass-wcj-products-add-form-shortcodes.php)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Revision](/browser/woocommerce-jetpack/trunk/includes/shortcodes/class-wcj-products-add-form-shortcodes.php?rev=3046146 "Revision 3046146")
* Next Revision →
* [Blame](/browser/woocommerce-jetpack/trunk/includes/shortcodes/class-wcj-products-add-form-shortcodes.php?annotate=blame "Annotate each line with the last changed revision (this can be time consuming...)")
* [Revision Log](/log/woocommerce-jetpack/trunk/includes/shortcodes/class-wcj-products-add-form-shortcodes.php)

---

# [source:](/browser?order=name "Go to repository root") [woocommerce-jetpack](/browser/woocommerce-jetpack?order=name "View woocommerce-jetpack")/[trunk](/browser/woocommerce-jetpack/trunk?order=name "View trunk")/[includes](/browser/woocommerce-jetpack/trunk/includes?order=name "View includes")/[shortcodes](/browser/woocommerce-jetpack/trunk/includes/shortcodes?order=name "View shortcodes")/[class-wcj-products-add-form-shortcodes.php](/browser/woocommerce-jetpack/trunk/includes/shortcodes/class-wcj-products-add-form-shortcodes.php?order=name "View class-wcj-products-add-form-shortcodes.php")

View diff against:

View revision:

| [Last change](/changeset/3115290/woocommerce-jetpack/trunk/includes/shortcodes/class-wcj-products-add-form-shortcodes.php "View differences") on this file was [3115290](/changeset/3115290/ "View changeset 3115290"), checked in by ronyp, [6 months ago](/timeline?from=2024-07-10T06%3A28%3A56Z&precision=second "See timeline at 07/10/2024 06:28:56 AM") |
| --- |
| v7.1.2 |
| **File size:** 28.9 KB | |

| Line |  |
| --- | --- |
| [1](#L1) | <?php |
| [2](#L2) | /\*\* |
| [3](#L3) | \* Booster for WooCommerce - Shortcodes - Products Add Form |
| [4](#L4) | \* |
| [5](#L5) | \* @version 7.2.1 |
| [6](#L6) | \* @since   2.5.0 |
| [7](#L7) | \* @author  Pluggabl LLC. |
| [8](#L8) | \* @package Booster\_For\_WooCommerce/shortcodes |
| [9](#L9) | \*/ |
| [10](#L10) |  |
| [11](#L11) | if ( ! defined( 'ABSPATH' ) ) { |
| [12](#L12) | exit; |
| [13](#L13) | } |
| [14](#L14) |  |
| [15](#L15) | if ( ! class\_exists( 'WCJ\_Products\_Add\_Form\_Shortcodes' ) ) : |
| [16](#L16) | /\*\* |
| [17](#L17) | \* WCJ\_Products\_Add\_Form\_Shortcodes. |
| [18](#L18) | \*/ |
| [19](#L19) | class WCJ\_Products\_Add\_Form\_Shortcodes extends WCJ\_Shortcodes { |
| [20](#L20) |  |
| [21](#L21) | /\*\* |
| [22](#L22) | \* Constructor. |
| [23](#L23) | \* |
| [24](#L24) | \* @version 2.8.0 |
| [25](#L25) | \* @since   2.5.0 |
| [26](#L26) | \* @todo    refill image on not validated (or after successful addition); more messages options; more styling options; custom fields; |
| [27](#L27) | \* @todo    (maybe) `product\_id => ( isset( $\_GET['wcj\_edit\_product'] ) ? $\_GET['wcj\_edit\_product'] : 0 )` |
| [28](#L28) | \*/ |
| [29](#L29) | public function \_\_construct() { |
| [30](#L30) |  |
| [31](#L31) | $this->the\_shortcodes = array( |
| [32](#L32) | 'wcj\_product\_add\_new', |
| [33](#L33) | ); |
| [34](#L34) |  |
| [35](#L35) | $this->the\_atts = array( |
| [36](#L36) | 'product\_id'             => 0, |
| [37](#L37) | 'post\_status'            => wcj\_get\_option( 'wcj\_product\_by\_user\_status', 'draft' ), |
| [38](#L38) |  |
| [39](#L39) | 'desc\_enabled'           => wcj\_get\_option( 'wcj\_product\_by\_user\_desc\_enabled', 'no' ), |
| [40](#L40) | 'short\_desc\_enabled'     => wcj\_get\_option( 'wcj\_product\_by\_user\_short\_desc\_enabled', 'no' ), |
| [41](#L41) | 'regular\_price\_enabled'  => wcj\_get\_option( 'wcj\_product\_by\_user\_regular\_price\_enabled', 'no' ), |
| [42](#L42) | 'sale\_price\_enabled'     => wcj\_get\_option( 'wcj\_product\_by\_user\_sale\_price\_enabled', 'no' ), |
| [43](#L43) | 'external\_url\_enabled'   => wcj\_get\_option( 'wcj\_product\_by\_user\_external\_url\_enabled', 'no' ), |
| [44](#L44) | 'cats\_enabled'           => wcj\_get\_option( 'wcj\_product\_by\_user\_cats\_enabled', 'no' ), |
| [45](#L45) | 'tags\_enabled'           => wcj\_get\_option( 'wcj\_product\_by\_user\_tags\_enabled', 'no' ), |
| [46](#L46) | 'image\_enabled'          => apply\_filters( 'booster\_option', 'no', wcj\_get\_option( 'wcj\_product\_by\_user\_image\_enabled', 'no' ) ), |
| [47](#L47) |  |
| [48](#L48) | 'desc\_required'          => wcj\_get\_option( 'wcj\_product\_by\_user\_desc\_required', 'no' ), |
| [49](#L49) | 'short\_desc\_required'    => wcj\_get\_option( 'wcj\_product\_by\_user\_short\_desc\_required', 'no' ), |
| [50](#L50) | 'regular\_price\_required' => wcj\_get\_option( 'wcj\_product\_by\_user\_regular\_price\_required', 'no' ), |
| [51](#L51) | 'sale\_price\_required'    => wcj\_get\_option( 'wcj\_product\_by\_user\_sale\_price\_required', 'no' ), |
| [52](#L52) | 'external\_url\_required'  => wcj\_get\_option( 'wcj\_product\_by\_user\_external\_url\_required', 'no' ), |
| [53](#L53) | 'cats\_required'          => wcj\_get\_option( 'wcj\_product\_by\_user\_cats\_required', 'no' ), |
| [54](#L54) | 'tags\_required'          => wcj\_get\_option( 'wcj\_product\_by\_user\_tags\_required', 'no' ), |
| [55](#L55) | 'image\_required'         => apply\_filters( 'booster\_option', 'no', wcj\_get\_option( 'wcj\_product\_by\_user\_image\_required', 'no' ) ), |
| [56](#L56) |  |
| [57](#L57) | 'visibility'             => implode( ',', wcj\_get\_option( 'wcj\_product\_by\_user\_user\_visibility', array() ) ), |
| [58](#L58) | 'module'                 => 'product\_by\_user', |
| [59](#L59) | 'module\_name'            => \_\_( 'Product by User', 'woocommerce-jetpack' ), |
| [60](#L60) | ); |
| [61](#L61) |  |
| [62](#L62) | if ( 'external' !== wcj\_get\_option( 'wcj\_product\_by\_user\_product\_type', 'simple' ) ) { |
| [63](#L63) | $this->the\_atts['external\_url\_enabled']  = 'no'; |
| [64](#L64) | $this->the\_atts['external\_url\_required'] = 'no'; |
| [65](#L65) | } |
| [66](#L66) |  |
| [67](#L67) | $this->the\_atts['custom\_taxonomies\_total'] = apply\_filters( 'booster\_option', 1, wcj\_get\_option( 'wcj\_product\_by\_user\_custom\_taxonomies\_total', 1 ) ); |
| [68](#L68) | for ( $i = 1; $i <= $this->the\_atts['custom\_taxonomies\_total']; $i++ ) { |
| [69](#L69) | $this->the\_atts[ 'custom\_taxonomy\_' . $i . '\_enabled' ]  = wcj\_get\_option( 'wcj\_product\_by\_user\_custom\_taxonomy\_' . $i . '\_enabled', 'no' ); |
| [70](#L70) | $this->the\_atts[ 'custom\_taxonomy\_' . $i . '\_required' ] = wcj\_get\_option( 'wcj\_product\_by\_user\_custom\_taxonomy\_' . $i . '\_required', 'no' ); |
| [71](#L71) | $this->the\_atts[ 'custom\_taxonomy\_' . $i . '\_id' ]       = wcj\_get\_option( 'wcj\_product\_by\_user\_custom\_taxonomy\_' . $i . '\_id', '' ); |
| [72](#L72) | $this->the\_atts[ 'custom\_taxonomy\_' . $i . '\_title' ]    = wcj\_get\_option( 'wcj\_product\_by\_user\_custom\_taxonomy\_' . $i . '\_title', '' ); |
| [73](#L73) | } |
| [74](#L74) |  |
| [75](#L75) | parent::\_\_construct(); |
| [76](#L76) | } |
| [77](#L77) |  |
| [78](#L78) | /\*\* |
| [79](#L79) | \* Init\_atts. |
| [80](#L80) | \* |
| [81](#L81) | \* @version 7.2.1 |
| [82](#L82) | \* @param array $atts The user defined shortcode attributes. |
| [83](#L83) | \*/ |
| [84](#L84) | public function init\_atts( $atts ) { |
| [85](#L85) | $atts['product\_id']              = (int) wcj\_sanitize\_input\_attribute\_values( $atts['product\_id'] ); |
| [86](#L86) | $atts['post\_status']             = wcj\_sanitize\_input\_attribute\_values( $atts['post\_status'] ); |
| [87](#L87) | $atts['desc\_enabled']            = wcj\_sanitize\_input\_attribute\_values( $atts['desc\_enabled'] ); |
| [88](#L88) | $atts['short\_desc\_enabled']      = wcj\_sanitize\_input\_attribute\_values( $atts['short\_desc\_enabled'] ); |
| [89](#L89) | $atts['regular\_price\_enabled']   = wcj\_sanitize\_input\_attribute\_values( $atts['regular\_price\_enabled'] ); |
| [90](#L90) | $atts['sale\_price\_enabled']      = wcj\_sanitize\_input\_attribute\_values( $atts['sale\_price\_enabled'] ); |
| [91](#L91) | $atts['external\_url\_enabled']    = wcj\_sanitize\_input\_attribute\_values( $atts['external\_url\_enabled'] ); |
| [92](#L92) | $atts['cats\_enabled']            = wcj\_sanitize\_input\_attribute\_values( $atts['cats\_enabled'] ); |
| [93](#L93) | $atts['tags\_enabled']            = wcj\_sanitize\_input\_attribute\_values( $atts['tags\_enabled'] ); |
| [94](#L94) | $atts['image\_gallery\_enabled']   = wcj\_sanitize\_input\_attribute\_values( $atts['image\_gallery\_enabled'] ); |
| [95](#L95) | $atts['image\_enabled']           = wcj\_sanitize\_input\_attribute\_values( $atts['image\_enabled'] ); |
| [96](#L96) | $atts['desc\_required']           = wcj\_sanitize\_input\_attribute\_values( $atts['desc\_required'] ); |
| [97](#L97) | $atts['short\_desc\_required']     = wcj\_sanitize\_input\_attribute\_values( $atts['short\_desc\_required'] ); |
| [98](#L98) | $atts['regular\_price\_required']  = wcj\_sanitize\_input\_attribute\_values( $atts['regular\_price\_required'] ); |
| [99](#L99) | $atts['sale\_price\_required']     = wcj\_sanitize\_input\_attribute\_values( $atts['sale\_price\_required'] ); |
| [100](#L100) | $atts['external\_url\_required']   = wcj\_sanitize\_input\_attribute\_values( $atts['external\_url\_required'] ); |
| [101](#L101) | $atts['cats\_required']           = wcj\_sanitize\_input\_attribute\_values( $atts['cats\_required'] ); |
| [102](#L102) | $atts['tags\_required']           = wcj\_sanitize\_input\_attribute\_values( $atts['tags\_required'] ); |
| [103](#L103) | $atts['image\_required']          = wcj\_sanitize\_input\_attribute\_values( $atts['image\_required'] ); |
| [104](#L104) | $atts['image\_gallery\_required']  = wcj\_sanitize\_input\_attribute\_values( $atts['image\_gallery\_required'] ); |
| [105](#L105) | $atts['visibility']              = wcj\_sanitize\_input\_attribute\_values( $atts['visibility'], 'restrict\_quotes' ); |
| [106](#L106) | $atts['module']                  = wcj\_sanitize\_input\_attribute\_values( $atts['module'] ); |
| [107](#L107) | $atts['module\_name']             = wcj\_sanitize\_input\_attribute\_values( $atts['module\_name'] ); |
| [108](#L108) | $atts['custom\_taxonomies\_total'] = wcj\_sanitize\_input\_attribute\_values( $atts['custom\_taxonomies\_total'] ); |
| [109](#L109) | for ( $i = 1; $i <= $atts['custom\_taxonomies\_total']; $i++ ) { |
| [110](#L110) | $atts[ 'custom\_taxonomy\_' . $i . '\_enabled' ]  = wcj\_sanitize\_input\_attribute\_values( $atts[ 'custom\_taxonomy\_' . $i . '\_enabled' ] ); |
| [111](#L111) | $atts[ 'custom\_taxonomy\_' . $i . '\_required' ] = wcj\_sanitize\_input\_attribute\_values( $atts[ 'custom\_taxonomy\_' . $i . '\_required' ] ); |
| [112](#L112) | $atts[ 'custom\_taxonomy\_' . $i . '\_id' ]       = wcj\_sanitize\_input\_attribute\_values( $atts[ 'custom\_taxonomy\_' . $i . '\_id' ] ); |
| [113](#L113) | $atts[ 'custom\_taxonomy\_' . $i . '\_title' ]    = wcj\_sanitize\_input\_attribute\_values( $atts[ 'custom\_taxonomy\_' . $i . '\_title' ] ); |
| [114](#L114) | } |
| [115](#L115) | return $atts; |
| [116](#L116) | } |
| [117](#L117) |  |
| [118](#L118) | /\*\* |
| [119](#L119) | \* Wc\_add\_new\_product. |
| [120](#L120) | \* |
| [121](#L121) | \* @version 2.8.0 |
| [122](#L122) | \* @since   2.5.0 |
| [123](#L123) | \* @todo    image gallery: `<input type="file" multiple>` or separate `<input type="file">` for each file; `update\_post\_meta( $product\_id, '\_product\_image\_gallery', implode( ',', $attach\_ids ) );` |
| [124](#L124) | \* @param array $args The user defined shortcode args. |
| [125](#L125) | \* @param array $shortcode\_atts The user defined shortcode shortcode\_atts. |
| [126](#L126) | \*/ |
| [127](#L127) | public function wc\_add\_new\_product( $args, $shortcode\_atts ) { |
| [128](#L128) |  |
| [129](#L129) | $product\_post = array( |
| [130](#L130) | 'post\_title'   => $args['title'], |
| [131](#L131) | 'post\_content' => $args['desc'], |
| [132](#L132) | 'post\_excerpt' => $args['short\_desc'], |
| [133](#L133) | 'post\_type'    => 'product', |
| [134](#L134) | 'post\_status'  => 'draft', |
| [135](#L135) | ); |
| [136](#L136) |  |
| [137](#L137) | if ( 0 === $shortcode\_atts['product\_id'] ) { |
| [138](#L138) | $product\_id = wp\_insert\_post( $product\_post ); |
| [139](#L139) | } else { |
| [140](#L140) | $product\_id = $shortcode\_atts['product\_id']; |
| [141](#L141) | wp\_update\_post( array\_merge( array( 'ID' => $product\_id ), $product\_post ) ); |
| [142](#L142) | } |
| [143](#L143) |  |
| [144](#L144) | // Insert the post into the database. |
| [145](#L145) | if ( 0 !== $product\_id ) { |
| [146](#L146) |  |
| [147](#L147) | wp\_set\_object\_terms( $product\_id, wcj\_get\_option( 'wcj\_product\_by\_user\_product\_type', 'simple' ), 'product\_type' ); |
| [148](#L148) | wp\_set\_object\_terms( $product\_id, $args['cats'], 'product\_cat' ); |
| [149](#L149) | wp\_set\_object\_terms( $product\_id, $args['tags'], 'product\_tag' ); |
| [150](#L150) |  |
| [151](#L151) | for ( $i = 1; $i <= $this->the\_atts['custom\_taxonomies\_total']; $i++ ) { |
| [152](#L152) | if ( 'yes' === $this->the\_atts[ 'custom\_taxonomy\_' . $i . '\_enabled' ] && '' !== $this->the\_atts[ 'custom\_taxonomy\_' . $i . '\_id' ] ) { |
| [153](#L153) | wp\_set\_object\_terms( $product\_id, $args[ 'custom\_taxonomy\_' . $i ], $this->the\_atts[ 'custom\_taxonomy\_' . $i . '\_id' ] ); |
| [154](#L154) | } |
| [155](#L155) | } |
| [156](#L156) |  |
| [157](#L157) | update\_post\_meta( $product\_id, '\_regular\_price', $args['regular\_price'] ); |
| [158](#L158) | update\_post\_meta( $product\_id, '\_sale\_price', $args['sale\_price'] ); |
| [159](#L159) | if ( '' === $args['sale\_price'] ) { |
| [160](#L160) | update\_post\_meta( $product\_id, '\_price', $args['regular\_price'] ); |
| [161](#L161) | } else { |
| [162](#L162) | update\_post\_meta( $product\_id, '\_price', $args['sale\_price'] ); |
| [163](#L163) | } |
| [164](#L164) | update\_post\_meta( $product\_id, '\_visibility', 'visible' ); |
| [165](#L165) | update\_post\_meta( $product\_id, '\_stock\_status', 'instock' ); |
| [166](#L166) |  |
| [167](#L167) | if ( 'external' === wcj\_get\_option( 'wcj\_product\_by\_user\_product\_type', 'simple' ) ) { |
| [168](#L168) | update\_post\_meta( $product\_id, '\_product\_url', $args['external\_url'] ); |
| [169](#L169) | } |
| [170](#L170) |  |
| [171](#L171) | // Image. |
| [172](#L172) | if ( '' !== $args['image'] && '' !== $args['image']['tmp\_name'] ) { |
| [173](#L173) | $upload\_dir = wp\_upload\_dir(); |
| [174](#L174) | $filename   = $args['image']['name']; |
| [175](#L175) | $file       = ( wp\_mkdir\_p( $upload\_dir['path'] ) ) ? $upload\_dir['path'] : $upload\_dir['basedir']; |
| [176](#L176) | $file      .= '/' . $filename; |
| [177](#L177) |  |
| [178](#L178) | move\_uploaded\_file( $args['image']['tmp\_name'], $file ); |
| [179](#L179) |  |
| [180](#L180) | $wp\_filetype = wp\_check\_filetype( $filename, null ); |
| [181](#L181) | $attachment  = array( |
| [182](#L182) | 'post\_mime\_type' => $wp\_filetype['type'], |
| [183](#L183) | 'post\_title'     => sanitize\_file\_name( $filename ), |
| [184](#L184) | 'post\_content'   => '', |
| [185](#L185) | 'post\_status'    => 'inherit', |
| [186](#L186) | ); |
| [187](#L187) | $attach\_id   = wp\_insert\_attachment( $attachment, $file, $product\_id ); |
| [188](#L188) | require\_once ABSPATH . 'wp-admin/includes/image.php'; |
| [189](#L189) | $attach\_data = wp\_generate\_attachment\_metadata( $attach\_id, $file ); |
| [190](#L190) | wp\_update\_attachment\_metadata( $attach\_id, $attach\_data ); |
| [191](#L191) |  |
| [192](#L192) | set\_post\_thumbnail( $product\_id, $attach\_id ); |
| [193](#L193) | } |
| [194](#L194) |  |
| [195](#L195) | wp\_update\_post( |
| [196](#L196) | array( |
| [197](#L197) | 'ID'          => $product\_id, |
| [198](#L198) | 'post\_status' => $shortcode\_atts['post\_status'], |
| [199](#L199) | ) |
| [200](#L200) | ); |
| [201](#L201) | } |
| [202](#L202) |  |
| [203](#L203) | return $product\_id; |
| [204](#L204) | } |
| [205](#L205) |  |
| [206](#L206) | /\*\* |
| [207](#L207) | \* Validate\_args. |
| [208](#L208) | \* |
| [209](#L209) | \* @version 7.1.8 |
| [210](#L210) | \* @since   2.5.0 |
| [211](#L211) | \* @param array $args The user defined shortcode args. |
| [212](#L212) | \* @param array $shortcode\_atts The user defined shortcode shortcode\_atts. |
| [213](#L213) | \*/ |
| [214](#L214) | public function validate\_args( $args, $shortcode\_atts ) { |
| [215](#L215) | $errors = ''; |
| [216](#L216) | if ( '' === $args['title'] ) { |
| [217](#L217) | $errors .= '<li>' . \_\_( 'Title is required!', 'woocommerce-jetpack' ) . '</li>'; |
| [218](#L218) | } |
| [219](#L219) |  |
| [220](#L220) | if ( 'yes' === wcj\_get\_option( 'wcj\_product\_by\_user\_require\_unique\_title', 'no' ) && 0 === $shortcode\_atts['product\_id'] ) { |
| [221](#L221) | if ( ! function\_exists( 'post\_exists' ) ) { |
| [222](#L222) | require\_once ABSPATH . 'wp-admin/includes/post.php'; |
| [223](#L223) | } |
| [224](#L224) | if ( post\_exists( $args['title'] ) ) { |
| [225](#L225) | $errors .= '<li>' . \_\_( 'Product exists!', 'woocommerce-jetpack' ) . '</li>'; |
| [226](#L226) | } |
| [227](#L227) | } |
| [228](#L228) |  |
| [229](#L229) | $fields = array( |
| [230](#L230) | 'desc'          => \_\_( 'Description', 'woocommerce-jetpack' ), |
| [231](#L231) | 'short\_desc'    => \_\_( 'Short Description', 'woocommerce-jetpack' ), |
| [232](#L232) | 'image'         => \_\_( 'Image', 'woocommerce-jetpack' ), |
| [233](#L233) | 'regular\_price' => \_\_( 'Regular Price', 'woocommerce-jetpack' ), |
| [234](#L234) | 'sale\_price'    => \_\_( 'Sale Price', 'woocommerce-jetpack' ), |
| [235](#L235) | 'external\_url'  => \_\_( 'Product URL', 'woocommerce-jetpack' ), |
| [236](#L236) | 'cats'          => \_\_( 'Categories', 'woocommerce-jetpack' ), |
| [237](#L237) | 'tags'          => \_\_( 'Tags', 'woocommerce-jetpack' ), |
| [238](#L238) | ); |
| [239](#L239) | for ( $i = 1; $i <= $this->the\_atts['custom\_taxonomies\_total']; $i++ ) { |
| [240](#L240) | $fields[ 'custom\_taxonomy\_' . $i ] = $this->the\_atts[ 'custom\_taxonomy\_' . $i . '\_title' ]; |
| [241](#L241) | } |
| [242](#L242) | foreach ( $fields as $field\_id => $field\_desc ) { |
| [243](#L243) | if ( 'yes' === $shortcode\_atts[ $field\_id . '\_enabled' ] && 'yes' === $shortcode\_atts[ $field\_id . '\_required' ] ) { |
| [244](#L244) | $is\_missing = false; |
| [245](#L245) | if ( 'image' === $field\_id && ( '' === $args[ $field\_id ] || ! isset( $args[ $field\_id ]['tmp\_name'] ) || '' === $args[ $field\_id ]['tmp\_name'] ) ) { |
| [246](#L246) | $is\_missing = true; |
| [247](#L247) | } elseif ( empty( $args[ $field\_id ] ) ) { |
| [248](#L248) | $is\_missing = true; |
| [249](#L249) | } |
| [250](#L250) | if ( $is\_missing ) { |
| [251](#L251) | /\* translators: %s: translation added \*/ |
| [252](#L252) | $errors .= '<li>' . sprintf( \_\_( '%s is required!', 'woocommerce-jetpack' ), $field\_desc ) . '</li>'; |
| [253](#L253) | } |
| [254](#L254) | } |
| [255](#L255) | } |
| [256](#L256) |  |
| [257](#L257) | if ( $args['sale\_price'] > $args['regular\_price'] ) { |
| [258](#L258) | $errors .= '<li>' . \_\_( 'Sale price must be less than the regular price!', 'woocommerce-jetpack' ) . '</li>'; |
| [259](#L259) | } |
| [260](#L260) |  |
| [261](#L261) | $product\_image\_name = isset( $args['image']['name'] ) ? sanitize\_text\_field( wp\_unslash( $args['image']['name'] ) ) : ''; |
| [262](#L262) | $gallery\_images     = isset( $args['image\_gallery']['name'] ) ? array\_map( 'sanitize\_text\_field', wp\_unslash( $args['image\_gallery']['name'] ) ) : array(); |
| [263](#L263) |  |
| [264](#L264) | $allowed\_types = array( '.jpg', '.jpeg', '.png', '.webp', '.heic', '.heif', '.gif' ); // Allowed File types by WordPress https://wordpress.com/support/accepted-filetypes/. |
| [265](#L265) |  |
| [266](#L266) | // Verify and restrict Product Image. |
| [267](#L267) | if ( isset( $product\_image\_name ) && '' !== $product\_image\_name ) { |
| [268](#L268) | $file\_type = '.' . pathinfo( $product\_image\_name, PATHINFO\_EXTENSION ); |
| [269](#L269) | if ( ! in\_array( $file\_type, $allowed\_types, true ) ) { |
| [270](#L270) | $errors .= '<li>' . \_\_( 'Sorry, only JPG, JPEG, PNG, WEBP, HEIC, HEIF and GIF files are allowed', 'woocommerce-jetpack' ) . '</li>'; |
| [271](#L271) | } |
| [272](#L272) | } |
| [273](#L273) | // Verify and restrict Gallery Image. |
| [274](#L274) | if ( isset( $gallery\_images ) && ! empty( array\_filter( $gallery\_images ) ) ) { |
| [275](#L275) | $error\_encountered = false; // Flag variable to track if an error has been encountered. |
| [276](#L276) | foreach ( $gallery\_images as $gallery\_image\_name ) { |
| [277](#L277) | $gallery\_file\_type = '.' . pathinfo( $gallery\_image\_name, PATHINFO\_EXTENSION ); |
| [278](#L278) | if ( ! in\_array( $gallery\_file\_type, $allowed\_types, true ) ) { |
| [279](#L279) | if ( ! $error\_encountered && ! $errors ) { |
| [280](#L280) |  |
| [281](#L281) | $errors           .= '<li>' . \_\_( 'Sorry, only JPG, JPEG, PNG, WEBP, HEIC, HEIF and GIF files are allowed', 'woocommerce-jetpack' ) . '</li>'; |
| [282](#L282) | $error\_encountered = true; // Set the flag to true to indicate error has been encountered. |
| [283](#L283) | } |
| [284](#L284) | } |
| [285](#L285) | } |
| [286](#L286) | } |
| [287](#L287) | return ( '' === $errors ) ? true : $errors; |
| [288](#L288) | } |
| [289](#L289) |  |
| [290](#L290) | /\*\* |
| [291](#L291) | \* Maybe\_add\_taxonomy\_field. |
| [292](#L292) | \* |
| [293](#L293) | \* @version 2.8.0 |
| [294](#L294) | \* @since   2.8.0 |
| [295](#L295) | \* @param array        $atts The user defined shortcode atts. |
| [296](#L296) | \* @param array        $args The user defined shortcode args. |
| [297](#L297) | \* @param int | string $option\_id The user defined shortcode option\_id. |
| [298](#L298) | \* @param int | string $taxonomy\_id The user defined shortcode taxonomy\_id. |
| [299](#L299) | \* @param string       $title The user defined shortcode title. |
| [300](#L300) | \* @param string       $input\_style The user defined shortcode input\_style. |
| [301](#L301) | \* @param string       $required\_mark\_html\_template The user defined shortcode required\_mark\_html\_template. |
| [302](#L302) | \* @param array        $table\_data The user defined shortcode table\_data. |
| [303](#L303) | \*/ |
| [304](#L304) | public function maybe\_add\_taxonomy\_field( $atts, $args, $option\_id, $taxonomy\_id, $title, $input\_style, $required\_mark\_html\_template, $table\_data ) { |
| [305](#L305) | if ( 'yes' === $atts[ $option\_id . '\_enabled' ] ) { |
| [306](#L306) | $product\_taxonomies = get\_terms( $taxonomy\_id, 'orderby=name&hide\_empty=0' ); |
| [307](#L307) | if ( is\_wp\_error( $product\_taxonomies ) ) { |
| [308](#L308) | return $table\_data; |
| [309](#L309) | } |
| [310](#L310) | $required\_html                        = ( 'yes' === $atts[ $option\_id . '\_required' ] ) ? ' required' : ''; |
| [311](#L311) | $required\_mark\_html                   = ( 'yes' === $atts[ $option\_id . '\_required' ] ) ? $required\_mark\_html\_template : ''; |
| [312](#L312) | $current\_product\_taxonomies           = ( 0 !== $atts['product\_id'] ) ? get\_the\_terms( $atts['product\_id'], $taxonomy\_id ) : $args[ $option\_id ]; |
| [313](#L313) | $product\_taxonomies\_as\_select\_options = ''; |
| [314](#L314) | foreach ( $product\_taxonomies as $product\_taxonomy ) { |
| [315](#L315) | $selected = ''; |
| [316](#L316) | if ( ! empty( $current\_product\_taxonomies ) ) { |
| [317](#L317) | foreach ( $current\_product\_taxonomies as $current\_product\_taxonomy ) { |
| [318](#L318) | if ( is\_object( $current\_product\_taxonomy ) ) { |
| [319](#L319) | $current\_product\_taxonomy = $current\_product\_taxonomy->slug; |
| [320](#L320) | } |
| [321](#L321) | $selected .= selected( $current\_product\_taxonomy, $product\_taxonomy->slug, false ); |
| [322](#L322) | } |
| [323](#L323) | } |
| [324](#L324) | $product\_taxonomies\_as\_select\_options .= '<option value="' . $product\_taxonomy->slug . '" ' . $selected . '>' . $product\_taxonomy->name . '</option>'; |
| [325](#L325) | } |
| [326](#L326) | $table\_data[] = array( |
| [327](#L327) | '<label for="wcj\_add\_new\_product\_' . $option\_id . '">' . $title . $required\_mark\_html . '</label>', |
| [328](#L328) | '<select' . $required\_html . ' multiple style="' . $input\_style . '" id="wcj\_add\_new\_product\_' . $option\_id . '" name="wcj\_add\_new\_product\_' . $option\_id . '[]">' . |
| [329](#L329) | $product\_taxonomies\_as\_select\_options . |
| [330](#L330) | '</select>', |
| [331](#L331) | ); |
| [332](#L332) | } |
| [333](#L333) | return $table\_data; |
| [334](#L334) | } |
| [335](#L335) |  |
| [336](#L336) | /\*\* |
| [337](#L337) | \* Wcj\_product\_add\_new. |
| [338](#L338) | \* |
| [339](#L339) | \* @version 7.1.3 |
| [340](#L340) | \* @since   2.5.0 |
| [341](#L341) | \* @todo    `multipart` only if image |
| [342](#L342) | \* @param array $atts The user defined shortcode atts. |
| [343](#L343) | \*/ |
| [344](#L344) | public function wcj\_product\_add\_new( $atts ) { |
| [345](#L345) | // Allowed User-roles. |
| [346](#L346) | $allowed\_user\_roles = array( 'administrator', 'shop\_manager', 'customer' ); |
| [347](#L347) |  |
| [348](#L348) | if ( function\_exists( 'wcj\_get\_current\_user\_all\_roles' ) ) { |
| [349](#L349) | // Current user role. |
| [350](#L350) | $current\_user\_role = wcj\_get\_current\_user\_all\_roles(); |
| [351](#L351) |  |
| [352](#L352) | if ( isset( $current\_user\_role ) && ! empty( $current\_user\_role ) ) { |
| [353](#L353) | // Initialize a result array. |
| [354](#L354) | $authorized\_user = array(); |
| [355](#L355) |  |
| [356](#L356) | // Loop through the values to check. |
| [357](#L357) | foreach ( $current\_user\_role as $user\_role ) { |
| [358](#L358) | if ( in\_array( $user\_role, $allowed\_user\_roles, true ) ) { |
| [359](#L359) | // Value exists in the array. |
| [360](#L360) | $authorized\_user[] = $user\_role; |
| [361](#L361) | } |
| [362](#L362) | } |
| [363](#L363) |  |
| [364](#L364) | // Check the result. |
| [365](#L365) | if ( empty( $authorized\_user ) ) { |
| [366](#L366) | return false; |
| [367](#L367) | } |
| [368](#L368) | } else { |
| [369](#L369) | return false; // Executes if $current\_user\_role is empty. |
| [370](#L370) | } |
| [371](#L371) | } else { |
| [372](#L372) | return false; |
| [373](#L373) | } |
| [374](#L374) |  |
| [375](#L375) | $wpnonce           = isset( $\_REQUEST['wcj\_add\_new\_product-nonce'] ) ? wp\_verify\_nonce( sanitize\_key( $\_REQUEST['wcj\_add\_new\_product-nonce'] ), 'wcj\_add\_new\_product' ) : false; |
| [376](#L376) | $header\_html       = ''; |
| [377](#L377) | $notice\_html       = ''; |
| [378](#L378) | $input\_fields\_html = ''; |
| [379](#L379) | $footer\_html       = ''; |
| [380](#L380) |  |
| [381](#L381) | $args = array( |
| [382](#L382) | 'title'         => ( isset( $\_REQUEST['wcj\_add\_new\_product\_title'] ) ) ? sanitize\_text\_field( wp\_unslash( $\_REQUEST['wcj\_add\_new\_product\_title'] ) ) : '', |
| [383](#L383) | 'desc'          => isset( $\_REQUEST['wcj\_add\_new\_product\_desc'] ) ? sanitize\_text\_field( wp\_unslash( $\_REQUEST['wcj\_add\_new\_product\_desc'] ) ) : '', |
| [384](#L384) | 'short\_desc'    => isset( $\_REQUEST['wcj\_add\_new\_product\_short\_desc'] ) ? sanitize\_text\_field( wp\_unslash( $\_REQUEST['wcj\_add\_new\_product\_short\_desc'] ) ) : '', |
| [385](#L385) | 'regular\_price' => isset( $\_REQUEST['wcj\_add\_new\_product\_regular\_price'] ) ? sanitize\_text\_field( wp\_unslash( $\_REQUEST['wcj\_add\_new\_product\_regular\_price'] ) ) : '', |
| [386](#L386) | 'sale\_price'    => isset( $\_REQUEST['wcj\_add\_new\_product\_sale\_price'] ) ? sanitize\_text\_field( wp\_unslash( $\_REQUEST['wcj\_add\_new\_product\_sale\_price'] ) ) : '', |
| [387](#L387) | 'external\_url'  => isset( $\_REQUEST['wcj\_add\_new\_product\_external\_url'] ) ? sanitize\_text\_field( wp\_unslash( $\_REQUEST['wcj\_add\_new\_product\_external\_url'] ) ) : '', |
| [388](#L388) | 'cats'          => isset( $\_REQUEST['wcj\_add\_new\_product\_cats'] ) ? array\_map( 'sanitize\_text\_field', wp\_unslash( $\_REQUEST['wcj\_add\_new\_product\_cats'] ) ) : array(), |
| [389](#L389) | 'tags'          => isset( $\_REQUEST['wcj\_add\_new\_product\_tags'] ) ? sanitize\_text\_field( wp\_unslash( $\_REQUEST['wcj\_add\_new\_product\_tags'] ) ) : array(), |
| [390](#L390) | 'image'         => isset( $\_FILES['wcj\_add\_new\_product\_image'] ) ? sanitize\_text\_field( wp\_unslash( $\_FILES['wcj\_add\_new\_product\_image'] ) ) : '', |
| [391](#L391) | ); |
| [392](#L392) | for ( $i = 1; $i <= $this->the\_atts['custom\_taxonomies\_total']; $i++ ) { |
| [393](#L393) | $param\_id                        = 'wcj\_add\_new\_product\_custom\_taxonomy\_' . $i; |
| [394](#L394) | $args[ 'custom\_taxonomy\_' . $i ] = isset( $\_REQUEST[ $param\_id ] ) ? sanitize\_text\_field( wp\_unslash( $\_REQUEST[ $param\_id ] ) ) : array(); |
| [395](#L395) | } |
| [396](#L396) |  |
| [397](#L397) | if ( $wpnonce && isset( $\_REQUEST['wcj\_add\_new\_product'] ) ) { |
| [398](#L398) | $validate\_args = $this->validate\_args( $args, $atts ); |
| [399](#L399) | if ( true === ( $validate\_args ) ) { |
| [400](#L400) | $result = $this->wc\_add\_new\_product( $args, $atts ); |
| [401](#L401) | if ( 0 === $result ) { |
| [402](#L402) | // Error. |
| [403](#L403) | $notice\_html .= '<div class="woocommerce"><ul class="woocommerce-error"><li>' . \_\_( 'Error!', 'woocommerce-jetpack' ) . '</li></ul></div>'; |
| [404](#L404) | } else { |
| [405](#L405) | // Success. |
| [406](#L406) | if ( 0 === $atts['product\_id'] ) { |
| [407](#L407) | $notice\_html .= '<div class="woocommerce"><div class="woocommerce-message">' . |
| [408](#L408) | str\_replace( |
| [409](#L409) | '%product\_title%', |
| [410](#L410) | $args['title'], |
| [411](#L411) | get\_option( 'wcj\_product\_by\_user\_message\_product\_successfully\_added', \_\_( '"%product\_title%" successfully added!', 'woocommerce-jetpack' ) ) |
| [412](#L412) | ) . |
| [413](#L413) | '</div></div>'; |
| [414](#L414) | } else { |
| [415](#L415) | $notice\_html .= '<div class="woocommerce"><div class="woocommerce-message">' . |
| [416](#L416) | str\_replace( |
| [417](#L417) | '%product\_title%', |
| [418](#L418) | $args['title'], |
| [419](#L419) | get\_option( 'wcj\_product\_by\_user\_message\_product\_successfully\_edited', \_\_( '"%product\_title%" successfully edited!', 'woocommerce-jetpack' ) ) |
| [420](#L420) | ) . |
| [421](#L421) | '</div></div>'; |
| [422](#L422) | } |
| [423](#L423) | } |
| [424](#L424) | } else { |
| [425](#L425) | $notice\_html .= '<div class="woocommerce"><ul class="woocommerce-error">' . $validate\_args . '</ul></div>'; |
| [426](#L426) | } |
| [427](#L427) | } |
| [428](#L428) |  |
| [429](#L429) | if ( isset( $\_GET['wcj\_edit\_product\_image\_delete'] ) ) { |
| [430](#L430) | $product\_id     = sanitize\_text\_field( wp\_unslash( $\_GET['wcj\_edit\_product\_image\_delete'] ) ); |
| [431](#L431) | $post\_author\_id = get\_post\_field( 'post\_author', $product\_id ); |
| [432](#L432) | $user\_ID        = get\_current\_user\_id(); |
| [433](#L433) | if ( $user\_ID !== $post\_author\_id ) { |
| [434](#L434) | echo '<p>' . wp\_kses\_post( 'Wrong user ID!', 'woocommerce-jetpack' ) . '</p>'; |
| [435](#L435) | } else { |
| [436](#L436) | $image\_id = get\_post\_thumbnail\_id( $product\_id ); |
| [437](#L437) | wp\_delete\_post( $image\_id, true ); |
| [438](#L438) | } |
| [439](#L439) | } |
| [440](#L440) |  |
| [441](#L441) | if ( 0 !== $atts['product\_id'] ) { |
| [442](#L442) | $this->the\_product = wc\_get\_product( $atts['product\_id'] ); |
| [443](#L443) | } |
| [444](#L444) |  |
| [445](#L445) | $header\_html .= '<h3>'; |
| [446](#L446) | $header\_html .= ( 0 === $atts['product\_id'] ) ? \_\_( 'Add New Product', 'woocommerce-jetpack' ) : \_\_( 'Edit Product', 'woocommerce-jetpack' ); |
| [447](#L447) | $header\_html .= '</h3>'; |
| [448](#L448) | $header\_html .= '<form method="post" action="' . esc\_url( remove\_query\_arg( array( 'wcj\_edit\_product\_image\_delete', 'wcj\_delete\_product' ) ) ) . |
| [449](#L449) | '" enctype="multipart/form-data">'; |
| [450](#L450) |  |
| [451](#L451) | $required\_mark\_html\_template = '&nbsp;<abbr class="required" title="' . \_\_( 'required', 'woocommerce-jetpack' ) . '">\*</abbr>'; |
| [452](#L452) |  |
| [453](#L453) | $price\_step = sprintf( '%f', ( 1 / pow( 10, wcj\_get\_option( 'wcj\_product\_by\_user\_price\_step', wcj\_get\_option( 'woocommerce\_price\_num\_decimals', 2 ) ) ) ) ); |
| [454](#L454) |  |
| [455](#L455) | $table\_data   = array(); |
| [456](#L456) | $input\_style  = 'width:100%;'; |
| [457](#L457) | $table\_data[] = array( |
| [458](#L458) | '<label for="wcj\_add\_new\_product\_title">' . \_\_( 'Title', 'woocommerce-jetpack' ) . $required\_mark\_html\_template . '</label>', |
| [459](#L459) | '<input required type="text" style="' . $input\_style . '" id="wcj\_add\_new\_product\_title" name="wcj\_add\_new\_product\_title" value="' . ( ( 0 !== $atts['product\_id'] ) ? |
| [460](#L460) | $this->the\_product->get\_title() : $args['title'] ) . '">', |
| [461](#L461) | ); |
| [462](#L462) | if ( 'yes' === $atts['desc\_enabled'] ) { |
| [463](#L463) | $required\_html      = ( 'yes' === $atts['desc\_required'] ) ? ' required' : ''; |
| [464](#L464) | $required\_mark\_html = ( 'yes' === $atts['desc\_required'] ) ? $required\_mark\_html\_template : ''; |
| [465](#L465) | $table\_data[]       = array( |
| [466](#L466) | '<label for="wcj\_add\_new\_product\_desc">' . \_\_( 'Description', 'woocommerce-jetpack' ) . $required\_mark\_html . '</label>', |
| [467](#L467) | '<textarea' . $required\_html . ' style="' . $input\_style . '" id="wcj\_add\_new\_product\_desc" name="wcj\_add\_new\_product\_desc">' . ( ( 0 !== $atts['product\_id'] ) ? |
| [468](#L468) | get\_post\_field( 'post\_content', $atts['product\_id'] ) : $args['desc'] ) . '</textarea>', |
| [469](#L469) | ); |
| [470](#L470) | } |
| [471](#L471) | if ( 'yes' === $atts['short\_desc\_enabled'] ) { |
| [472](#L472) | $required\_html      = ( 'yes' === $atts['short\_desc\_required'] ) ? ' required' : ''; |
| [473](#L473) | $required\_mark\_html = ( 'yes' === $atts['short\_desc\_required'] ) ? $required\_mark\_html\_template : ''; |
| [474](#L474) | $table\_data[]       = array( |
| [475](#L475) | '<label for="wcj\_add\_new\_product\_short\_desc">' . \_\_( 'Short Description', 'woocommerce-jetpack' ) . $required\_mark\_html . '</label>', |
| [476](#L476) | '<textarea' . $required\_html . ' style="' . $input\_style . '" id="wcj\_add\_new\_product\_short\_desc" name="wcj\_add\_new\_product\_short\_desc">' . |
| [477](#L477) | ( ( 0 !== $atts['product\_id'] ) ? get\_post\_field( 'post\_excerpt', $atts['product\_id'] ) : $args['short\_desc'] ) . '</textarea>', |
| [478](#L478) | ); |
| [479](#L479) | } |
| [480](#L480) | if ( 'yes' === $atts['image\_enabled'] ) { |
| [481](#L481) | $required\_html      = ( 'yes' === $atts['image\_required'] ) ? ' required' : ''; |
| [482](#L482) | $required\_mark\_html = ( 'yes' === $atts['image\_required'] ) ? $required\_mark\_html\_template : ''; |
| [483](#L483) | $new\_image\_field    = '<input' . $required\_html . ' type="file" id="wcj\_add\_new\_product\_image" name="wcj\_add\_new\_product\_image" accept="image/\*">'; |
| [484](#L484) | if ( 0 !== $atts['product\_id'] ) { |
| [485](#L485) | $the\_field = ( '' === get\_post\_thumbnail\_id( $atts['product\_id'] ) ) ? |
| [486](#L486) | $new\_image\_field : |
| [487](#L487) | '<a href="' . esc\_url( add\_query\_arg( 'wcj\_edit\_product\_image\_delete', $atts['product\_id'] ) ) . '" onclick="return confirm(\'' . |
| [488](#L488) | \_\_( 'Are you sure?', 'woocommerce-jetpack' ) . '\')">' . \_\_( 'Delete', 'woocommerce-jetpack' ) . '</a><br>' . |
| [489](#L489) | get\_the\_post\_thumbnail( $atts['product\_id'], array( 50, 50 ), array( 'class' => 'alignleft' ) ); |
| [490](#L490) | } else { |
| [491](#L491) | $the\_field = $new\_image\_field; |
| [492](#L492) | } |
| [493](#L493) | $table\_data[] = array( |
| [494](#L494) | '<label for="wcj\_add\_new\_product\_image">' . \_\_( 'Image', 'woocommerce-jetpack' ) . $required\_mark\_html . '</label>', |
| [495](#L495) | $the\_field, |
| [496](#L496) | ); |
| [497](#L497) | } |
| [498](#L498) | if ( 'yes' === $atts['regular\_price\_enabled'] ) { |
| [499](#L499) | $required\_html      = ( 'yes' === $atts['regular\_price\_required'] ) ? ' required' : ''; |
| [500](#L500) | $required\_mark\_html = ( 'yes' === $atts['regular\_price\_required'] ) ? $required\_mark\_html\_template : ''; |
| [501](#L501) | $table\_data[]       = array( |
| [502](#L502) | '<label for="wcj\_add\_new\_product\_regular\_price">' . \_\_( 'Regular Price', 'woocommerce-jetpack' ) . $required\_mark\_html . '</label>', |
| [503](#L503) | '<input' . $required\_html . ' type="number" min="0" step="' . $price\_step . '" id="wcj\_add\_new\_product\_regular\_price" name="wcj\_add\_new\_product\_regular\_price" value="' . |
| [504](#L504) | ( ( 0 !== $atts['product\_id'] ) ? get\_post\_meta( $atts['product\_id'], '\_regular\_price', true ) : $args['regular\_price'] ) . '">', |
| [505](#L505) | ); |
| [506](#L506) | } |
| [507](#L507) | if ( 'yes' === $atts['sale\_price\_enabled'] ) { |
| [508](#L508) | $required\_html      = ( 'yes' === $atts['sale\_price\_required'] ) ? ' required' : ''; |
| [509](#L509) | $required\_mark\_html = ( 'yes' === $atts['sale\_price\_required'] ) ? $required\_mark\_html\_template : ''; |
| [510](#L510) | $table\_data[]       = array( |
| [511](#L511) | '<label for="wcj\_add\_new\_product\_sale\_price">' . \_\_( 'Sale Price', 'woocommerce-jetpack' ) . $required\_mark\_html . '</label>', |
| [512](#L512) | '<input' . $required\_html . ' type="number" min="0" step="' . $price\_step . '" id="wcj\_add\_new\_product\_sale\_price" name="wcj\_add\_new\_product\_sale\_price" value="' . |
| [513](#L513) | ( ( 0 !== $atts['product\_id'] ) ? get\_post\_meta( $atts['product\_id'], '\_sale\_price', true ) : $args['sale\_price'] ) . '">', |
| [514](#L514) | ); |
| [515](#L515) | } |
| [516](#L516) | if ( 'yes' === $atts['external\_url\_enabled'] ) { |
| [517](#L517) | $required\_html      = ( 'yes' === $atts['external\_url\_required'] ) ? ' required' : ''; |
| [518](#L518) | $required\_mark\_html = ( 'yes' === $atts['external\_url\_required'] ) ? $required\_mark\_html\_template : ''; |
| [519](#L519) | $table\_data[]       = array( |
| [520](#L520) | '<label for="wcj\_add\_new\_product\_external\_url">' . \_\_( 'Product URL', 'woocommerce-jetpack' ) . $required\_mark\_html\_template . '</label>', |
| [521](#L521) | '<input' . $required\_html . ' style="' . $input\_style . '" type="url" id="wcj\_add\_new\_product\_external\_url" name="wcj\_add\_new\_product\_external\_url" value="' . |
| [522](#L522) | ( ( 0 !== $atts['product\_id'] ) ? get\_post\_meta( $atts['product\_id'], '\_product\_url', true ) : $args['external\_url'] ) . '">', |
| [523](#L523) | ); |
| [524](#L524) | } |
| [525](#L525) | $table\_data = $this->maybe\_add\_taxonomy\_field( |
| [526](#L526) | $atts, |
| [527](#L527) | $args, |
| [528](#L528) | 'cats', |
| [529](#L529) | 'product\_cat', |
| [530](#L530) | \_\_( 'Categories', 'woocommerce-jetpack' ), |
| [531](#L531) | $input\_style, |
| [532](#L532) | $required\_mark\_html\_template, |
| [533](#L533) | $table\_data |
| [534](#L534) | ); |
| [535](#L535) | $table\_data = $this->maybe\_add\_taxonomy\_field( |
| [536](#L536) | $atts, |
| [537](#L537) | $args, |
| [538](#L538) | 'tags', |
| [539](#L539) | 'product\_tag', |
| [540](#L540) | \_\_( 'Tags', 'woocommerce-jetpack' ), |
| [541](#L541) | $input\_style, |
| [542](#L542) | $required\_mark\_html\_template, |
| [543](#L543) | $table\_data |
| [544](#L544) | ); |
| [545](#L545) | for ( $i = 1; $i <= $this->the\_atts['custom\_taxonomies\_total']; $i++ ) { |
| [546](#L546) | $table\_data = $this->maybe\_add\_taxonomy\_field( |
| [547](#L547) | $atts, |
| [548](#L548) | $args, |
| [549](#L549) | 'custom\_taxonomy\_' . $i, |
| [550](#L550) | $atts[ 'custom\_taxonomy\_' . $i . '\_id' ], |
| [551](#L551) | $atts[ 'custom\_taxonomy\_' . $i . '\_title' ], |
| [552](#L552) | $input\_style, |
| [553](#L553) | $required\_mark\_html\_template, |
| [554](#L554) | $table\_data |
| [555](#L555) | ); |
| [556](#L556) | } |
| [557](#L557) |  |
| [558](#L558) | $input\_fields\_html .= wcj\_get\_table\_html( |
| [559](#L559) | $table\_data, |
| [560](#L560) | array( |
| [561](#L561) | 'table\_class'        => 'widefat', |
| [562](#L562) | 'table\_heading\_type' => 'vertical', |
| [563](#L563) | ) |
| [564](#L564) | ); |
| [565](#L565) |  |
| [566](#L566) | $footer\_html .= '<input type="submit" class="button" name="wcj\_add\_new\_product" value="' . ( ( 0 === $atts['product\_id'] ) ? |
| [567](#L567) | \_\_( 'Add', 'woocommerce-jetpack' ) : \_\_( 'Edit', 'woocommerce-jetpack' ) ) . '">'; |
| [568](#L568) | $footer\_html .= wp\_nonce\_field( 'wcj\_add\_new\_product', 'wcj\_add\_new\_product-nonce', true, false ); |
| [569](#L569) | $footer\_html .= '</form>'; |
| [570](#L570) |  |
| [571](#L571) | return $notice\_html . $header\_html . $input\_fields\_html . $footer\_html; |
| [572](#L572) | } |
| [573](#L573) |  |
| [574](#L574) | } |
| [575](#L575) |  |
| [576](#L576) | endif; |
| [577](#L577) |  |
| [578](#L578) | return new WCJ\_Products\_Add\_Form\_Shortcodes(); |

**Note:** See [TracBrowser](/wiki/TracBrowser)
for help on using the repository browser.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Plain Text](/browser/woocommerce-jetpack/trunk/includes/shortcodes/class-wcj-products-add-form-shortcodes.php?format=txt)
* [Original Format](/export/3220264/woocommerce-jetpack/trunk/includes/shortcodes/class-wcj-products-add-form-shortcodes.php)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)


