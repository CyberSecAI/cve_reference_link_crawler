```
{
  "cve": "CVE-2022-21663",
  "description": "On a multisite, users with Super Admin role can bypass explicit/additional hardening under certain conditions through object injection.",
  "vulnerability_details": {
    "root_cause": "The vulnerability arises from an incorrect usage of the `unserialize()` function during database upgrades in WordPress multisite installations. Specifically, the `upgrade_280()` function directly uses `unserialize()` on option values, while the `maybe_unserialize()` function, used elsewhere in WordPress, has a check to prevent double serialization. A malicious super admin can inject a specially crafted serialized PHP object (starting with 'C' which is not checked by the `is_serialized()` function) which will bypass the `maybe_serialize` function. The injected serialized object is then unserialized during the database upgrade via `upgrade_280()`, leading to object injection.",
    "weaknesses": [
      "Object Injection",
      "Inconsistent data handling",
      "Lack of proper input validation/sanitization",
	    "Bypass of hardening mechanisms"
    ],
    "impact": "An attacker with Super Admin privileges on a WordPress multisite installation can bypass security hardening measures. By injecting a malicious PHP object, an attacker can potentially execute arbitrary code on the server if a suitable 'pop chain' is available in the application or its plugins.",
    "attack_vectors": "The attack vector involves a malicious Super Admin user crafting a specific serialized PHP object, injecting it as a WordPress option value in the database, and then manipulating the database version option to trigger the `upgrade_280()` function, which performs the vulnerable `unserialize()` call.",
    "required_capabilities": "The attacker needs Super Admin level privileges on a WordPress multisite installation to modify options and trigger the database upgrade process. This may require gaining initial access by exploiting other vulnerabilities, such as XSS."
  },
  "affected_versions": "< 5.8.3",
  "patched_versions": "5.8.3",
    "additional_notes": "The vulnerability was reported to WordPress on HackerOne in April 2019 and fixed in January 2022. The fix involved replacing the direct `unserialize()` call in `upgrade_280()` with `maybe_unserialize()`, thereby enforcing the same serialization/unserialization logic used across WordPress and preventing the object injection."
}
```