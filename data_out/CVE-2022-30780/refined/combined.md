=== Content from podalirius.net_f88cc6b6_20250108_105530.html ===

[Podalirius](https://podalirius.net/en/)

* [Articles](https://podalirius.net/en/articles/)
* [Writeups](https://podalirius.net/en/writeups/)
* [Publications](https://podalirius.net/en/publications/)
* [CVEs](https://podalirius.net/en/cves/)
* |
* [![](https://podalirius.net/en/public/flag_fr.png)](https://podalirius.net/fr/cves/2022-30780/)
* |

# CVE-2022-30780 - Lighttpd - Denial of Service

May 16, 2022

One-minute read

[Linux](https://podalirius.net/en/categories/linux/)
â¢
[CVEs](https://podalirius.net/en/categories/cves/)

* **Title** : Lighttpd - Denial of Service
* **Author** : [@podalirius\_](https://twitter.com/podalirius_)
* **CVSS** : 7.5 (High)
* **CVSS Vector** : `CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H`

## Summary

An unauthenticated attacker can send an HTTP request with an URL overflowing the maximum URL length, resulting in a denial of service.

## Vulnerable versions

The following versions of lighttpd are vulnerable:

| Software | Version | Vulnerable |
| --- | --- | --- |
| Lighttpd | [1.4.58](https://github.com/lighttpd/lighttpd1.4/releases/tag/lighttpd-1.4.58) | Yes :white\_check\_mark: |
| Lighttpd | [1.4.57](https://github.com/lighttpd/lighttpd1.4/releases/tag/lighttpd-1.4.57) | Yes :white\_check\_mark: |
| Lighttpd | [1.4.56](https://github.com/lighttpd/lighttpd1.4/releases/tag/lighttpd-1.4.56) | Yes :white\_check\_mark: |

## Exploitation

## Demonstration

## Mitigations

In order to patch this vulnerability you need to update lighttpd to a version greater than [1.4.59](https://github.com/lighttpd/lighttpd1.4/releases/tag/lighttpd-1.4.59).

## References

* <https://github.com/lighttpd/lighttpd1.4>
* <https://github.com/p0dalirius/CVE-2022-30780-lighttpd-denial-of-service>

Â©
2024
Podalirius



=== Content from redmine.lighttpd.net_9efb3b32_20250108_105530.html ===


Search

### Project

### General

### Profile

* [Sign in](/login)
* [Register](/account/register)

* [Home](/)
* [Projects](/projects)
* [Donate](/paypal_donation)
* [Help](https://www.redmine.org/guide)

[Search](/projects/lighttpd/search?scope=subprojects):

 Lighttpd[All Projects](/projects?jump=issues)
# Lighttpd

* [Overview](/projects/lighttpd)
* [Activity](/projects/lighttpd/activity)
* [Roadmap](/projects/lighttpd/roadmap)
* [Issues](/projects/lighttpd/issues)
* [News](/projects/lighttpd/news)
* [Wiki](/projects/lighttpd/wiki)
* [Forums](/projects/lighttpd/boards)
* [Repository](/projects/lighttpd/repository)
* [Blog](https://www.lighttpd.net)
* [Developer Blog](https://blog.lighttpd.net)

### Custom queries

* [lighttpd 1.4 open issues](/projects/lighttpd/issues?query_id=15)
* [Open issues without target version](/projects/lighttpd/issues?query_id=16)

Actions
Copy link
## Bug #3059

closed

### Connections stuck in Close\_Wait causing 100% cpu usage

Added by [mitd](/users/12416) [almost 4 years](/projects/lighttpd/activity?from=2021-01-19 "2021-01-19 21:25") ago.
Updated [almost 4 years](/projects/lighttpd/activity?from=2021-02-01 "2021-02-01 12:05") ago.

Status:FixedPriority:NormalCategory:coreTarget version:[1.4.59](/versions/60 "2021-02-02")
ASK QUESTIONS IN Forums:No

---

**Description**

Hello folks,

I've run into an odd issue with some of the simple web servers we run (they serve some text in index.html). Specifically, it seems like there are connections that get stuck in close\_wait and eat up 100% of CPU resources.
To note, these are 1 core VMs we run this on.

This issue started when we updated from lighttpd 1.4.55-2 to 1.4.57-1. I am going to provide full context on what was done in case it helps. Initially after this upgrade, I noticed that the service stopped starting up and saw these warnings:
2021-01-13 20:21:21: (configfile.c.2269) server.upload-dirs doesn't exist: /var/cache/lighttpd/uploads
2021-01-13 20:21:21: (plugin.c.195) dlopen() failed for: /usr/lib/lighttpd/mod\_openssl.so /usr/lib/lighttpd/mod\_openssl.so: cannot open shared object file: No such file or directory
2021-01-13 20:21:21: (server.c.1238) loading plugins finally failed

and:
2021-01-13 20:21:21: (configfile.c.253) Warning: please add "mod\_openssl" to server.modules list in lighttpd.conf. A future release of lighttpd 1.4.x **will not** automatically load mod\_openssl and lighttpd **will not** use SSL/TLS where your lighttpd.conf contains ssl.\* directives

So I went in and edited /etc/lighttpd/lighttpd.conf and added mod\_openssl and installed the lighttpd-mod-openssl package. That resolved the issue with the service not running.

After this point, the servers ran normally for a while, then we got an alert about CPU usage. Taking a look it seemed like lighttpd was constantly consuming the entire core. Luckily enough, it still seemed to be accepting connections normally (as far we we could tell from access.log and errors.log didn't show anything out of the ordinary).

At this point, looking at lsof, it showed the following (with some stuff deleted of course):
 `mitd:~$ sudo lsof -p 157648
COMMAND PID USER FD TYPE DEVICE SIZE/OFF NODE NAME
lighttpd 157648 www-data cwd DIR 254,1 4096 2 /
lighttpd 157648 www-data rtd DIR 254,1 4096 2 /
lighttpd 157648 www-data txt REG 254,1 375136 1966696 /usr/sbin/lighttpd
lighttpd 157648 www-data mem REG 254,1 23160 1967130 /usr/lib/x86_64-linux-gnu/libnss_cache.so.2.0
lighttpd 157648 www-data mem REG 254,1 51696 1968527 /usr/lib/x86_64-linux-gnu/libnss_files-2.31.so
lighttpd 157648 www-data mem REG 254,1 14408 1844237 /usr/lib/lighttpd/mod_staticfile.so
lighttpd 157648 www-data mem REG 254,1 30792 1841268 /usr/lib/lighttpd/mod_dirlisting.so
lighttpd 157648 www-data mem REG 254,1 3076960 1967430 /usr/lib/x86_64-linux-gnu/libcrypto.so.1.1
lighttpd 157648 www-data mem REG 254,1 593696 1967535 /usr/lib/x86_64-linux-gnu/libssl.so.1.1
lighttpd 157648 www-data mem REG 254,1 22600 1835392 /usr/lib/lighttpd/mod_accesslog.so
lighttpd 157648 www-data mem REG 254,1 55520 1839916 /usr/lib/lighttpd/mod_openssl.so
lighttpd 157648 www-data mem REG 254,1 14408 1843016 /usr/lib/lighttpd/mod_redirect.so
lighttpd 157648 www-data mem REG 254,1 14408 1835607 /usr/lib/lighttpd/mod_alias.so
lighttpd 157648 www-data mem REG 254,1 149608 1968567 /usr/lib/x86_64-linux-gnu/libpthread-2.31.so
lighttpd 157648 www-data mem REG 254,1 1839792 1967267 /usr/lib/x86_64-linux-gnu/libc-2.31.so
lighttpd 157648 www-data mem REG 254,1 43048 1966278 /usr/lib/x86_64-linux-gnu/libxxhash.so.0.8.0
lighttpd 157648 www-data mem REG 254,1 257528 1966472 /usr/lib/x86_64-linux-gnu/libnettle.so.8.0
lighttpd 157648 www-data mem REG 254,1 18688 1968044 /usr/lib/x86_64-linux-gnu/libdl-2.31.so
lighttpd 157648 www-data mem REG 254,1 464848 1967316 /usr/lib/x86_64-linux-gnu/libpcre.so.3.13.3
lighttpd 157648 www-data mem REG 254,1 14408 1835248 /usr/lib/lighttpd/mod_access.so
lighttpd 157648 www-data mem REG 254,1 14408 1842895 /usr/lib/lighttpd/mod_indexfile.so
lighttpd 157648 www-data mem REG 254,1 177928 1966929 /usr/lib/x86_64-linux-gnu/ld-2.31.so
lighttpd 157648 www-data 0u CHR 1,3 0t0 7949 /dev/null
lighttpd 157648 www-data 1u CHR 1,3 0t0 7949 /dev/null
lighttpd 157648 www-data 2u unix 0xffff98ddb1b31800 0t0 1393254 type=STREAM
lighttpd 157648 www-data 3w REG 0,23 7 1393271 /run/lighttpd.pid
lighttpd 157648 www-data 4u IPv4 1393272 0t0 TCP *:http (LISTEN)
lighttpd 157648 www-data 5u IPv6 1393273 0t0 TCP *:http (LISTEN)
lighttpd 157648 www-data 6u IPv4 1393274 0t0 TCP *:https (LISTEN)
lighttpd 157648 www-data 7u IPv6 1393275 0t0 TCP *:https (LISTEN)
lighttpd 157648 www-data 8w REG 254,1 3423240 3670309 /var/log/lighttpd/error.log
lighttpd 157648 www-data 9w REG 254,1 117697465 3670308 /var/log/lighttpd/access.log
lighttpd 157648 www-data 10u a_inode 0,13 0 7868 [eventpoll]
lighttpd 157648 www-data 11u IPv4 1586902 0t0 TCP #####:https->#####.com:52059 (ESTABLISHED)
lighttpd 157648 www-data 12u IPv4 1435873 0t0 TCP ME.com:https->#####.com:41960 (CLOSE_WAIT)
lighttpd 157648 www-data 13u IPv4 1586953 0t0 TCP .com:https->:59153 (ESTABLISHED)
lighttpd 157648 www-data 19u IPv4 1415541 0t0 TCP ME.com:http->***********.com:43470 (CLOSE_WAIT)
lighttpd 157648 www-data 20r REG 254,1 27 3670597 /var/www/html/index.html`

You can see 12u and 19u are both stuck in close\_wait. They stayed in that state for hours. An strace of the lighttpd process showed the similar messages to the following spammed repeated:

epoll\_ctl(10, EPOLL\_CTL\_MOD, 12, {EPOLLERR|EPOLLHUP, {u32=1349789952, u64=94078313441536}}) = 0
epoll\_ctl(10, EPOLL\_CTL\_MOD, 12, {EPOLLIN|EPOLLERR|EPOLLHUP|EPOLLRDHUP, {u32=1349789952, u64=94078313441536}}) = 0
getsockopt(21, SOL\_TCP, TCP\_INFO, "\10\0\0\0\0\4x\0\200 \5\0@\234\0\0\264\5\0\0\264\5\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\374\231c\1\0\0\0\0\30\231c\1\234\257b\1\334\5\0\0\350\301\0\0007\275\1\0\233\336\0\0\377\377\377\177\n\0\0\0\264\5\0\0\3\0\0\0\0\0\0\0\20r\0\0\0\0\0\0", [104]) = 0

At this point using the following I was able to kill the 12u and 19u specifically after which CPU usage returned to normal and strace stopped showing the previous messages:
`gdb -p pid
call (int)close(12)
call (int)close(19)
exit`

To mitigate this in the short term, I have setup a cron job to check CPU usage and restart the service if CPU usage is above a percentage.
Any help to get to the bottom of this bug would be appreciated, let me know what other info you may need.

---

**Files**

| [scan.txt](/attachments/2039) (1.7 MB) [scan.txt](/attachments/download/2039/scan.txt "Download") |  | mitd, 2021-01-26 22:45 |  |
| --- | --- | --- | --- |

* [History](/issues/3059?tab=history)
* [Notes](/issues/3059?tab=notes)
* [Property changes](/issues/3059?tab=properties)
* [Associated revisions](/issues/3059?tab=changesets)

ActionsCopy link
[#1](#note-1)
#### Updated by [gstrauss](/users/10519) [almost 4 years](/projects/lighttpd/activity?from=2021-01-19 "2021-01-19 21:50") ago

* **Category** set to *core*
* **Target version** changed from *1.4.x* to *1.4.59*

> Any help to get to the bottom of this bug would be appreciated, let me know what other info you may need.

Sharing your config (minus any passwords) would be helpful. `lighttpd -f /etc/lighttpd/lighttpd.conf -p`

A bug fix was recently pushed to lighttpd git master for a 100% spin when traffic limits are active. To run into the bug, you need to have `connection.kbytes-per-second` or `server.kbytes-per-second` configured in lighttpd.conf. See also [#3058](/issues/3058 "Bug: rare spontaneous segfaults (Fixed)"), which might be the same issue.

```

--- a/src/connections.c
+++ b/src/connections.c
@@ -523,7 +523,7 @@ static int connection_handle_write_state(request_st * const r, connection * cons
         }
     } while (r->http_version <= HTTP_VERSION_1_1
              && (!chunkqueue_is_empty(&r->write_queue)
-                 ? con->is_writable
+                 ? con->is_writable > 0 && 0 == con->traffic_limit_reached
                  : r->resp_body_finished));

     return CON_STATE_WRITE;

```

ActionsCopy link
[#2](#note-2)
#### Updated by [mitd](/users/12416) [almost 4 years](/projects/lighttpd/activity?from=2021-01-19 "2021-01-19 22:11") ago

Heres the config:
<https://pastebin.com/7vKE72zU>

And we don't have traffic limits set in our setup so don't believe that is the issue.
As for issue 3058 which you linked, I looked at journalctl -u lighttpd.service and didn't spot any stack traces. Let me know if you need me to look elsewhere.

Thanks.

ActionsCopy link
[#3](#note-3)
#### Updated by [gstrauss](/users/10519) [almost 4 years](/projects/lighttpd/activity?from=2021-01-19 "2021-01-19 22:37") ago

That's a fairly straightforward config. Thank you for sharing it.

Do you know if the stuck requests are HTTP/1.1 or HTTP/2 ?

> Let me know if you need me to look elsewhere.

If you see lighttpd at 100% CPU usage, please `pstack` or use `gdb` to get obtain a stack trace to help narrow down where I need to look.

There was a bug fixed in lighttpd 1.4.58 commit [37ae9423](/projects/lighttpd/repository/14/revisions/37ae942346dca72b89ceada9a3bb999c77df44f8 "[core] fix bug in read retry found by coverity read retry loop needs separate var for result and...") so if you can test with lighttpd 1.4.58, that would be appreciated. lighttpd 1.4.56 was a huge release of over a year of development, and unfortunately, there apparently remain some bugs to be squashed.

Unrelated: please check your `ssl.cipher-list`. I see that you include RC4 and disable AESGCM. You might have a look at [lighttpd TLS docs](/projects/lighttpd/wiki/Docs_SSL) for some recommendations.

ActionsCopy link
[#4](#note-4)
#### Updated by [mitd](/users/12416) [almost 4 years](/projects/lighttpd/activity?from=2021-01-19 "2021-01-19 22:54") ago

I will look and confirm if they are HTTP/1.1 or 2 and try and use pstack/gdb to obtain a stack trace and update this when I can.

I forgot to mention that I did in fact update to 1.4.58 but the issue does persist unfortunately.

And thank you, I'll take a look at the documentation.

Appreciate it,
Mit

ActionsCopy link
[#5](#note-5)
#### Updated by [gstrauss](/users/10519) [almost 4 years](/projects/lighttpd/activity?from=2021-01-19 "2021-01-19 23:38") ago

```
getsockopt(21, SOL_TCP, TCP_INFO, "\10\0\0\0\0\4x\0\200 \5\0@\234\0\0\264\5\0\0\264\5\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\374\231c\1\0\0\0\0\30\231c\1\234\257b\1\334\5\0\0\350\301\0\0007\275\1\0\233\336\0\0\377\377\377\177\n\0\0\0\264\5\0\0\3\0\0\0\0\0\0\0\20r\0\0\0\0\0\0", [104]) = 0
```

The call to `getsockopt()` for `SOL_TCP` `TCP_INFO` in `fdevent_is_tcp_half_closed()` tells me that lighttpd is detecting that the socket was closed (or at least half-closed). I'll dig in further to see if there is a reason why that does not result in the connection being closed soon afterwards. Once that is received, lighttpd ideally should not have to check that again for that connection (unless lighttpd has not yet drained what is in the kernel recv socket buffer for that connection).

ActionsCopy link
[#6](#note-6)
#### Updated by [gstrauss](/users/10519) [almost 4 years](/projects/lighttpd/activity?from=2021-01-20 "2021-01-20 00:00") ago

Are you able to reproduce this error with any frequency?

The code which reaches `fdevent_is_tcp_half_closed()` is fairly small. In clear-text (non-TLS), lighttpd will `read()` and recv EOF. I am wondering if the underlying TLS library might be in a state which does not handle this.

You're using `mod_openssl`. Would you be willing to upgrade or downgrade your version of `openssl`? Would you be willing to try with `mod_gnutls` or `mod_mbedtls` or `mod_wolfssl` or `mod_nss` as a substitute for `mod_openssl`? To use the alternative TLS modules, you might have to modify `ssl.cipher-list` (or comment it out and use the default in lighttpd, which is `ssl.cipher-list = "HIGH:!aNULL:!eNULL:!EXP"`, and in lighttpd 1.4.56 and later, `"MinProtocol" => "TLSv1.2"`)

ActionsCopy link
[#7](#note-7)
#### Updated by [mitd](/users/12416) [almost 4 years](/projects/lighttpd/activity?from=2021-01-20 "2021-01-20 00:52") ago

Some new info, the connections seem to be coming from one of our security scanners. So this happens each time the servers get scanned.
It uses HTTP/1.0 for the majority of the connections I saw.

Here is a pastebin of a longer strace since I had:
<https://pastebin.com/3yMKzqud>

I used `gdb` to connect to the process and ran `bt` which printed out the following:
(gdb) bt
#0 0x00007fb3b4914f1a in getsockopt () from /lib/x86\_64-linux-gnu/libc.so.6
[#1](/issues/1 "Bug: broken pipe for writev  (Fixed)") 0x000055c4b35156c8 in fdevent\_is\_tcp\_half\_closed ()
[#2](/issues/2 "Bug: Compile error in 1.3.10 on MacOS X (Fixed)") 0x000055c4b34f2762 in ?? ()
[#3](/issues/3 "Bug: $_SERVER[\"PHP_SELF\"] broken if index file is used (Fixed)") 0x000055c4b3502c9c in ?? ()
[#4](/issues/4 "Feature: Valid user support in mod_auth (Fixed)") 0x000055c4b34f0f2e in main ()

I'll attempt to use a different TLS modules tomorrow.

ActionsCopy link
[#8](#note-8)
#### Updated by [gstrauss](/users/10519) [almost 4 years](/projects/lighttpd/activity?from=2021-01-20 "2021-01-20 01:00") ago

The following patch is a worthwhile improvement, but I do not think it sufficient to address the issue here. This patch below should prevent repeated calls to `getsockopt()` after `POLLRDHUP` is received on the connection.
```

--- a/src/connections.c
+++ b/src/connections.c
@@ -1218,7 +1224,9 @@ connection_set_fdevent_interest (request_st * const r, connection * const con)
     int n = 0;
     switch(r->state) {
       case CON_STATE_READ:
-        n = FDEVENT_IN | FDEVENT_RDHUP;
+        n = FDEVENT_IN;
+        if (!(r->conf.stream_request_body & FDEVENT_STREAM_REQUEST_POLLRDHUP))
+            n |= FDEVENT_RDHUP;
         break;
       case CON_STATE_WRITE:
         if (!chunkqueue_is_empty(con->write_queue)

```

ActionsCopy link
[#9](#note-9)
#### Updated by [gstrauss](/users/10519) [almost 4 years](/projects/lighttpd/activity?from=2021-01-20 "2021-01-20 01:03") ago

That's an interesting `strace`. Thanks.
I don't see anything trying to `read()` after the event is received and need to try to track down why that is.

ActionsCopy link
[#10](#note-10)
#### Updated by [gstrauss](/users/10519) [almost 4 years](/projects/lighttpd/activity?from=2021-01-20 "2021-01-20 05:52") ago

If this is reproducible after a scan, I'd be curious what the request is.
```

debug.log-request-header = "enable"
debug.log-response-header = "enable"

```

If you can attach `gdb` to the lighttpd process using 100% CPU and `step` (repeat from `epoll_wait()` to the next `epoll_wait()`), then if you can share that result, it should help pinpoint what is going on.

ActionsCopy link
[#11](#note-11)
#### Updated by [gstrauss](/users/10519) [almost 4 years](/projects/lighttpd/activity?from=2021-01-20 "2021-01-20 22:05") ago

`debug.log-state-handling = "enable"` will generate **a lot** of noise in the error logs on a busy site, but would also be very useful to help identify where things are spinning.

ActionsCopy link
[#12](#note-12)
#### Updated by [mitd](/users/12416) [almost 4 years](/projects/lighttpd/activity?from=2021-01-21 "2021-01-21 04:03") ago

I attempted to step through using gdb today and generated the following:
<https://pastebin.com/niNTr7Ja>
I'm unsure if I did it correctly (I'm unfamiliar unfortunately).

I've added:
`debug.log-request-header = "enable"
debug.log-response-header = "enable"`
And I'll add:
`debug.log-state-handling = "enable"`
afterwards.
I'm in the process of gaining the rights necessary to run the scans on demand so I can reproduce the error state easily. Switching TLS modules will also hopefully be done soon. Once I get the rights I'll see if I can get a print of the error log around that time frame.

ActionsCopy link
[#13](#note-13)
#### Updated by [gstrauss](/users/10519) [almost 4 years](/projects/lighttpd/activity?from=2021-01-21 "2021-01-21 04:29") ago

It does not look like lighttpd was built with full debugging symbols, or maybe lighttpd has not been deployed with debugging symbols available on the system on which you are running `gdb` on `lighttpd`

The calls to `BIO_write ()` tell me that you're getting into `mod_openssl` and into the underlying `openssl` libraries. I don't know why in your `strace` we do not see a `read()` or `write()` system call from `mod_openssl`, or why `openssl` is not detecting that the connection has closed.

ActionsCopy link
[#14](#note-14)
#### Updated by [gstrauss](/users/10519) [almost 4 years](/projects/lighttpd/activity?from=2021-01-21 "2021-01-21 05:55") ago

The most recent trace that you shared shows `BIO_write()` and `write()` along with SIGPIPE, which is blocked, but the `write()` should fail with `EPIPE`

It is curious that you did not see `write()` in your original `strace`

In any case, it is still a mystery why this error is not being propagated through lighttpd. I'm still looking through the code...

ActionsCopy link
[#15](#note-15)
#### Updated by [gstrauss](/users/10519) [almost 4 years](/projects/lighttpd/activity?from=2021-01-21 "2021-01-21 06:00") ago

Only because I haven't yet asked: is there any trace in the lighttpd error log?

ActionsCopy link
[#16](#note-16)
#### Updated by [gstrauss](/users/10519) [almost 4 years](/projects/lighttpd/activity?from=2021-01-21 "2021-01-21 06:31") ago

What version of the openssl libraries are installed on your system?
`openssl version`

ActionsCopy link
[#17](#note-17)
#### Updated by [gstrauss](/users/10519) [almost 4 years](/projects/lighttpd/activity?from=2021-01-26 "2021-01-26 01:17") ago

@mitd: I am interested in helping to track this down. Do you have an estimate when you might have time to come back to this?

It would be useful to know what commands are being sent by the scanner. From your traces, two of the connections seem to end up in this problem state.

Also, please share `openssl version`. Thanks.

ActionsCopy link
[#18](#note-18)
#### Updated by [mitd](/users/12416) [almost 4 years](/projects/lighttpd/activity?from=2021-01-26 "2021-01-26 20:54") ago

Sorry about the delay, had things come up. Still looking into it.
What I've tried so far.
I've installed wolfssl and am testing now with the config changes you mentioned above.
`openssl version
OpenSSL 1.1.1i 8 Dec 2020`

I don't see a trace in the error logs. I've gotten some access to run the scans (all I can do is initiate them, not much else). But with that hopefully I can produce the calls in the access.log from the scanner. I'll reply once I get that info, I've initiated a scan now but am waiting for it to actually start.

ActionsCopy link
[#19](#note-19)
#### Updated by [gstrauss](/users/10519) [almost 4 years](/projects/lighttpd/activity?from=2021-01-26 "2021-01-26 22:17") ago

Great. Thanks. If you reproduce the `CLOSE_WAIT`, you may have to attach with `gdb` and issue `call (int)close(xxxx)` before the request will end up in the access.log, since logging occurs after the request ends. `debug.log-request-header = "enable"` shows up in the error log once the request headers are received. If they do not show up, then it is possible that things are caught up somewhere in the TLS negotiation between the scanner and lighttpd, before the HTTP request is received by lighttpd.

ActionsCopy link
[#20](#note-20)
#### Updated by [mitd](/users/12416) [almost 4 years](/projects/lighttpd/activity?from=2021-01-26 "2021-01-26 22:49") ago

* **File** [scan.txt](/attachments/2039) [scan.txt](/attachments/download/2039/scan.txt "Download") added

Seems like the issue still happens with wolfssl.
I've also attached a (very long) log file with the calls from the qualys security scanner.

Weirdly enough when I attempted to call close this time, I received $1 = -1 and it didn't close. I'm going to attempt this on another server that still has mod\_openssl installed.

ActionsCopy link
[#21](#note-21)
#### Updated by [gstrauss](/users/10519) [almost 4 years](/projects/lighttpd/activity?from=2021-01-27 "2021-01-27 06:41") ago

14561 lines of requests is, ... um ..., a lot.
Would you share your `server.feature-flags` settings, if you have set any? (I am specifically interested in `"server.h2proto"` and `"server.h2c"`)

ActionsCopy link
[#22](#note-22)
#### Updated by [mitd](/users/12416) [almost 4 years](/projects/lighttpd/activity?from=2021-01-27 "2021-01-27 16:03") ago

Unfortunately yes, it sends tons of requests.
Here are the flags:
 `server.feature-flags += ("server.h2proto" => "enable")
server.feature-flags += ("server.h2c" => "enable")`
Attempted to close the connections and here is what I got in the error log:
<https://pastebin.com/zuQAkKe8>
That was pulled a few seconds after closing the connection.

ActionsCopy link
[#23](#note-23)
#### Updated by [gstrauss](/users/10519) [almost 4 years](/projects/lighttpd/activity?from=2021-01-27 "2021-01-27 17:24") ago

In an effort to bound where the problem is, does the problem occur if you (temporarily) disable those feature flags and then trigger a scan? If it does, does the problem occur if you set only `server.feature-flags += ("server.h2c" => "disable")` and leave `server.feature-flags += ("server.h2proto" => "enable")` ?

ActionsCopy link
[#24](#note-24)
#### Updated by [mitd](/users/12416) [almost 4 years](/projects/lighttpd/activity?from=2021-01-27 "2021-01-27 18:47") ago

Looks like it still occurs with both flags disabled. Will try it with h2c `disabled` and h2proto `enabled` once this scan is finished.

ActionsCopy link
[#25](#note-25)
#### Updated by [mitd](/users/12416) [almost 4 years](/projects/lighttpd/activity?from=2021-01-27 "2021-01-27 19:46") ago

Issue persists with:
`server.feature-flags += ("server.h2c" => "disable")` and `server.feature-flags += ("server.h2proto" => "enable")`

ActionsCopy link
[#26](#note-26)
#### Updated by [gstrauss](/users/10519) [almost 4 years](/projects/lighttpd/activity?from=2021-01-28 "2021-01-28 06:29") ago

That is expected, as most of the requests in your scan access log are HTTP/1.0 with a few HTTP/1.1. There was one HTTP/2.0 "prior knowledge" request, and if the problem still happened when you disabled `"server.h2c"` and disabled `"server.h2proto"` (which also disables `"server.h2c"`), then the issue is much less likely to be in the HTTP/2 code in lighttpd.

Your the scan access log you shared has the HTTP request-line, but does not have the headers the went along with the request. Having those headers may help me to reproduce the issue.

So far, running all of the request lines against lighttpd does not trigger the issue on my test box, and I tried with and without HTTPS.

I don't have any good hunches right now. If you can temporarily run a scan without port 80 enabled, we can establish whether or not the issue occurs with HTTPS (probably does). To do so, temporary change `server.bind = 80` to `server.bind = 443` and comment out the `$SERVER["socket"] == "[::]:80"` section in your config.

If you have enabled request header logging with `debug.log-request-header = "enable"` then the error log will contain a log line with the file descriptor, followed by the request headers. When you trigger the error and the server has that fd in CLOSE\_WAIT, the last instance in the error logs which uses the fd (and the subsequent request headers) is likely the request that triggered the issue. (This is before you attach with gdb to try to `close()` the fd). That might help give us a starting point. There is a chance that a sequence of requests cause the problem, but it would still be useful to see the request that gets stuck.

ActionsCopy link
[#27](#note-27)
#### Updated by [mitd](/users/12416) [almost 4 years](/projects/lighttpd/activity?from=2021-01-28 "2021-01-28 17:43") ago

I attempted to bind to port 443 but had to comment out
`include_shell "/usr/share/lighttpd/use-ipv6.pl " + server.port`
Once that was removed I was able to start the service. However looking at the access log, it started throwing 400s. I think this is due to our anycast setup (not 100% familiar with it) and the requests themselves.

In order to continue down that route, I'll have to remove one server from the published anycast config.
That may also help clear up the access and error log to help debug. There are some steps involved to change that so I'll try and get started asap.

ActionsCopy link
[#28](#note-28)
#### Updated by [gstrauss](/users/10519) [almost 4 years](/projects/lighttpd/activity?from=2021-01-28 "2021-01-28 20:57") ago

> In order to continue down that route, I'll have to remove one server from the published anycast config.

I am not sure if that is worth the effort. You might instead modify the access log to include the server IP with `%A`

We do not yet know if the trigger for the error condition is due to a specific HTTP request or due to a TCP behavior.

I do know that it is also effort to scrub your error log before possibly sharing it.

Do you think I might be able to reproduce this using the Qualsys Community Edition?

ActionsCopy link
[#29](#note-29)
#### Updated by [mitd](/users/12416) [almost 4 years](/projects/lighttpd/activity?from=2021-01-28 "2021-01-28 21:51") ago

The community edition may work but I'm not 100%. A quick search seems to indicate that the scanning capabilities are the same between community and express lite at least (not sure which variant we use internally) so that's somewhat promising. Since the scan is initiated through an RPC call on my end, it's somewhat obfuscated, all I can tell is that it's a "default scan" which scans all plugins at a normal testing rate but no credential bruteforcing.
And I'll still look into the possibility of removing it from our anycast config just in case.

ActionsCopy link
[#30](#note-30)
#### Updated by [gstrauss](/users/10519) [almost 4 years](/projects/lighttpd/activity?from=2021-01-29 "2021-01-29 04:30") ago

* **Status** changed from *New* to *Patch Pending*

Using the Qualsys Community scanner, I was not able to reproduce the error with the patch posted last week in [#3059#note-8](/issues/3059#note-8 "Bug: Connections stuck in Close_Wait causing 100% cpu usage (Fixed)") (presumably the patch resulted in the request eventually timing out after hitting the read timeout)

However, I was able to reproduce the error once without that patch, and the problem is for oversized header requests read across multiple calls to `read()`. (I must not have tested with splitting large headers across multiple calls.) There was a typo I introduced Sep 2019 in development, which ended up part of lighttpd 1.4.56. This will be part of lighttpd 1.4.59:
```

--- a/src/connections.c
+++ b/src/connections.c
@@ -626,7 +626,7 @@ static chunk * connection_read_header_more(connection *con, chunkqueue *cq, chun

     if (cq->first != cq->last && 0 != olen) {
         const size_t clen = chunkqueue_length(cq);
-        size_t block = (olen + (16384-1)) & (16384-1);
+        size_t block = (olen + (16384-1)) & ~(16384-1);
         block += (block - olen > 1024 ? 0 : 16384);
         chunkqueue_compact_mem(cq, block > clen ? clen : block);
     }

```

Thanks for your help in tracking this down.

ActionsCopy link
[#31](#note-31)
#### Updated by [mitd](/users/12416) [almost 4 years](/projects/lighttpd/activity?from=2021-01-29 "2021-01-29 17:23") ago

Awesome, happy to hear that.

Thanks for your help and patience through this. My team and a few others will be quite happy about this as I know a few folks had just gone ahead and disabled lighttpd in the meantime.

ActionsCopy link
[#32](#note-32)
#### Updated by [gstrauss](/users/10519) [almost 4 years](/projects/lighttpd/activity?from=2021-02-01 "2021-02-01 12:05") ago

* **Status** changed from *Patch Pending* to *Fixed*

Applied in changeset [b03b86f47b0d5a553137f081fadc482b4af1372d](/projects/lighttpd/repository/14/revisions/b03b86f47b0d5a553137f081fadc482b4af1372d "[core] fix merging large headers across mult reads (fixes #3059) (thx mitd) x-ref:   \"Connectio...").

Actions
Copy link

Also available in: [Atom](/issues/3059.atom)

Powered by [Redmine](https://www.redmine.org/) © 2006-2024 Jean-Philippe Lang

Loading...



=== Content from github.com_4080c1fe_20250108_105529.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Flighttpd%2Flighttpd1.4)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Flighttpd%2Flighttpd1.4)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E&source=header-repo&source_repo=lighttpd%2Flighttpd1.4)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[lighttpd](/lighttpd)
/
**[lighttpd1.4](/lighttpd/lighttpd1.4)**
Public

* [Notifications](/login?return_to=%2Flighttpd%2Flighttpd1.4) You must be signed in to change notification settings
* [Fork
  286](/login?return_to=%2Flighttpd%2Flighttpd1.4)
* [Star
   622](/login?return_to=%2Flighttpd%2Flighttpd1.4)

lighttpd1.4 on github for easier collaboration - main repo still on lighttpd.net

[redmine.lighttpd.net/projects/lighttpd/wiki](https://redmine.lighttpd.net/projects/lighttpd/wiki "https://redmine.lighttpd.net/projects/lighttpd/wiki")

### License

[BSD-3-Clause license](/lighttpd/lighttpd1.4/blob/master/COPYING)

[622
stars](/lighttpd/lighttpd1.4/stargazers) [286
forks](/lighttpd/lighttpd1.4/forks) [Branches](/lighttpd/lighttpd1.4/branches) [Tags](/lighttpd/lighttpd1.4/tags) [Activity](/lighttpd/lighttpd1.4/activity)
 [Star](/login?return_to=%2Flighttpd%2Flighttpd1.4)

 [Notifications](/login?return_to=%2Flighttpd%2Flighttpd1.4) You must be signed in to change notification settings

* [Code](/lighttpd/lighttpd1.4)
* [Pull requests
  1](/lighttpd/lighttpd1.4/pulls)
* [Actions](/lighttpd/lighttpd1.4/actions)
* [Security](/lighttpd/lighttpd1.4/security)
* [Insights](/lighttpd/lighttpd1.4/pulse)

Additional navigation options

* [Code](/lighttpd/lighttpd1.4)
* [Pull requests](/lighttpd/lighttpd1.4/pulls)
* [Actions](/lighttpd/lighttpd1.4/actions)
* [Security](/lighttpd/lighttpd1.4/security)
* [Insights](/lighttpd/lighttpd1.4/pulse)

# lighttpd/lighttpd1.4

    master[Branches](/lighttpd/lighttpd1.4/branches)[Tags](/lighttpd/lighttpd1.4/tags)Go to fileCode
## Folders and files

| Name | | Name | Last commit message | Last commit date |
| --- | --- | --- | --- | --- |
| Latest commit History[5,385 Commits](/lighttpd/lighttpd1.4/commits/master/) | | |
| [.github](/lighttpd/lighttpd1.4/tree/master/.github ".github") | | [.github](/lighttpd/lighttpd1.4/tree/master/.github ".github") |  |  |
| [doc](/lighttpd/lighttpd1.4/tree/master/doc "doc") | | [doc](/lighttpd/lighttpd1.4/tree/master/doc "doc") |  |  |
| [scripts](/lighttpd/lighttpd1.4/tree/master/scripts "scripts") | | [scripts](/lighttpd/lighttpd1.4/tree/master/scripts "scripts") |  |  |
| [src](/lighttpd/lighttpd1.4/tree/master/src "src") | | [src](/lighttpd/lighttpd1.4/tree/master/src "src") |  |  |
| [tests](/lighttpd/lighttpd1.4/tree/master/tests "tests") | | [tests](/lighttpd/lighttpd1.4/tree/master/tests "tests") |  |  |
| [.gitattributes](/lighttpd/lighttpd1.4/blob/master/.gitattributes ".gitattributes") | | [.gitattributes](/lighttpd/lighttpd1.4/blob/master/.gitattributes ".gitattributes") |  |  |
| [.gitignore](/lighttpd/lighttpd1.4/blob/master/.gitignore ".gitignore") | | [.gitignore](/lighttpd/lighttpd1.4/blob/master/.gitignore ".gitignore") |  |  |
| [AUTHORS](/lighttpd/lighttpd1.4/blob/master/AUTHORS "AUTHORS") | | [AUTHORS](/lighttpd/lighttpd1.4/blob/master/AUTHORS "AUTHORS") |  |  |
| [CMakeLists.txt](/lighttpd/lighttpd1.4/blob/master/CMakeLists.txt "CMakeLists.txt") | | [CMakeLists.txt](/lighttpd/lighttpd1.4/blob/master/CMakeLists.txt "CMakeLists.txt") |  |  |
| [COPYING](/lighttpd/lighttpd1.4/blob/master/COPYING "COPYING") | | [COPYING](/lighttpd/lighttpd1.4/blob/master/COPYING "COPYING") |  |  |
| [INSTALL](/lighttpd/lighttpd1.4/blob/master/INSTALL "INSTALL") | | [INSTALL](/lighttpd/lighttpd1.4/blob/master/INSTALL "INSTALL") |  |  |
| [Makefile.am](/lighttpd/lighttpd1.4/blob/master/Makefile.am "Makefile.am") | | [Makefile.am](/lighttpd/lighttpd1.4/blob/master/Makefile.am "Makefile.am") |  |  |
| [NEWS](/lighttpd/lighttpd1.4/blob/master/NEWS "NEWS") | | [NEWS](/lighttpd/lighttpd1.4/blob/master/NEWS "NEWS") |  |  |
| [README](/lighttpd/lighttpd1.4/blob/master/README "README") | | [README](/lighttpd/lighttpd1.4/blob/master/README "README") |  |  |
| [README.FreeBSD](/lighttpd/lighttpd1.4/blob/master/README.FreeBSD "README.FreeBSD") | | [README.FreeBSD](/lighttpd/lighttpd1.4/blob/master/README.FreeBSD "README.FreeBSD") |  |  |
| [SConstruct](/lighttpd/lighttpd1.4/blob/master/SConstruct "SConstruct") | | [SConstruct](/lighttpd/lighttpd1.4/blob/master/SConstruct "SConstruct") |  |  |
| [autogen.sh](/lighttpd/lighttpd1.4/blob/master/autogen.sh "autogen.sh") | | [autogen.sh](/lighttpd/lighttpd1.4/blob/master/autogen.sh "autogen.sh") |  |  |
| [configure.ac](/lighttpd/lighttpd1.4/blob/master/configure.ac "configure.ac") | | [configure.ac](/lighttpd/lighttpd1.4/blob/master/configure.ac "configure.ac") |  |  |
| [meson.build](/lighttpd/lighttpd1.4/blob/master/meson.build "meson.build") | | [meson.build](/lighttpd/lighttpd1.4/blob/master/meson.build "meson.build") |  |  |
| [meson\_options.txt](/lighttpd/lighttpd1.4/blob/master/meson_options.txt "meson_options.txt") | | [meson\_options.txt](/lighttpd/lighttpd1.4/blob/master/meson_options.txt "meson_options.txt") |  |  |
| [packdist.sh](/lighttpd/lighttpd1.4/blob/master/packdist.sh "packdist.sh") | | [packdist.sh](/lighttpd/lighttpd1.4/blob/master/packdist.sh "packdist.sh") |  |  |
| View all files | | |

## Repository files navigation

* README
* BSD-3-Clause license
```

========
lighttpd
========

-------------
a light httpd
-------------

:abstract:
  lighttpd a secure, fast, compliant and very flexible web-server
  which has been optimized for high-performance environments. It has a very
  low memory footprint compared to other webservers and takes care of cpu-load.
  Its advanced feature-set (FastCGI, CGI, Auth, Output-Compression,
  URL-Rewriting and many more) make lighttpd the perfect webserver-software
  for every server that is suffering load problems.

:documentation:
  <https://redmine.lighttpd.net/projects/lighttpd/wiki/>

the naming
----------

lighttpd is a __httpd__ which is

- fast as __light__ning and
- __light__ when it comes to memory consumption and system requirements

Features
--------

Network
```````

- IPv4, IPv6

Protocols
`````````

- HTTP/2   (<https://tools.ietf.org/rfc/rfc7540.txt>)
- HTTP/1.1 (<https://tools.ietf.org/rfc/rfc2616.txt>)
- HTTP/1.0 (<https://tools.ietf.org/rfc/rfc1945.txt>)
- HTTPS (via one of openssl, BoringSSL, LibreSSL, mbedTLS, wolfSSL, GnuTLS, NSS)
- CGI/1.1 (<https://tools.ietf.org/html/rfc3875.txt>)
- FastCGI (<http://www.fastcgi.com/devkit/doc/fcgi-spec.html>)

Advanced Features
`````````````````

- load-balanced FastCGI, SCGI, reverse-proxy, socket proxy, websocket tunnel
  (one webserver distributes requests to multiple PHP-servers via FastCGI)
- streaming FastCGI, SCGI, reverse-proxy, socket proxy, websocket tunnel
- custom error pages (for Response-Code 400-599)
- virtual hosts
- directory listings
- URL-Rewriting
- HTTP-Redirection
- output-compression with transparent caching

FastCGI-Support
```````````````

- parses the Response-header and completes the HTTP-header accordingly
- Keep-Alive handling based on Content-Length header

PHP-Support
```````````

- same speed as or faster than apache + mod_php4
- handles various PHP bugs in the FastCGI SAPI
- includes a utility to spawn FastCGI processes (necessary for PHP 4.3.x)

Security features
`````````````````

- chroot(), set UID, set GID
- protecting docroot

HTTP/1.1 features
`````````````````

- Ranges (start-end, start-, -end, multiple ranges)
- HTTP/1.0 Keep-Alive + HTTP/1.1 persistent Connections
- methods: GET, HEAD, POST
- Last-Modified + If-Modified handling
- sends Content-Length if possible
- sends Transfer-Encoding: chunk, if Content-Length is not possible
- sends Content-Type
- on-the-fly output compression (deflate, gzip)
- authentication: basic and digest
  (<http://www.ietf.org/rfc/rfc2617.txt>)

HTTP/1.1 compliance
```````````````````

- Sends 206 for Range Requests
- Sends 304 for If-Modified Requests
- Sends 400 for missing Host on HTTP/1.1 requests
- Sends 400 for broken Request-Line
- Sends 411 for missing Content-Length on POST requests
- Sends 416 for "out-of-range" on Range: Header
- Sends 501 for request-method != (GET|POST|HEAD)
- Sends 505 for protocol != HTTP/1.0 or HTTP/1.1
- Sends Date: on every requests

Intended Audience
-----------------

- Ad-Server Front-Ends ("Banner-Schleuder")
  - delivering small files rapidly
- php-servers under high load
  (load-balancing the php-request over multiple PHP-servers)

Works with
----------

It has been tested to work with

- IE 6.0
- Mozilla 1.x
- Konqueror 3.1
  (for Keep-Alive/Persistent Connections, Accept-Encoding for PHP + gzip)
- wget
  (for Resuming)
- acrobat plugin
  (for multiple ranges)

Works on
--------

lighttpd has been verified to compile and work on

- Linux
- FreeBSD
- NetBSD
- OpenBSD
- Solaris 8 + 9
- SGI IRIX 6.5
- Windows (when compiled under cygwin)
(and will likely compile and run on most unix-like systems with C99 compiler)

-----------------
Starting lighttpd
-----------------

As daemon in the background: ::

  $ lighttpd -f <configfile>

or without detaching from the console: ::

  $ lighttpd -D -f <configfile>

```

## About

lighttpd1.4 on github for easier collaboration - main repo still on lighttpd.net

[redmine.lighttpd.net/projects/lighttpd/wiki](https://redmine.lighttpd.net/projects/lighttpd/wiki "https://redmine.lighttpd.net/projects/lighttpd/wiki")

### Resources

[Readme](#readme-ov-file)
### License

[BSD-3-Clause license](#BSD-3-Clause-1-ov-file)

[Activity](/lighttpd/lighttpd1.4/activity)
[Custom properties](/lighttpd/lighttpd1.4/custom-properties)
### Stars

[**622**
stars](/lighttpd/lighttpd1.4/stargazers)
### Watchers

[**40**
watching](/lighttpd/lighttpd1.4/watchers)
### Forks

[**286**
forks](/lighttpd/lighttpd1.4/forks)
[Report repository](/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2Flighttpd%2Flighttpd1.4&report=lighttpd+%28user%29)

## [Releases](/lighttpd/lighttpd1.4/releases)

[90
tags](/lighttpd/lighttpd1.4/tags)

## [Packages 0](/orgs/lighttpd/packages?repo_name=lighttpd1.4)

No packages published

## [Contributors 40](/lighttpd/lighttpd1.4/graphs/contributors)

[+ 26 contributors](/lighttpd/lighttpd1.4/graphs/contributors)

## Languages

* [C
  87.9%](/lighttpd/lighttpd1.4/search?l=c)
* [C++
  5.4%](/lighttpd/lighttpd1.4/search?l=c%2B%2B)
* [Perl
  1.8%](/lighttpd/lighttpd1.4/search?l=perl)
* [M4
  1.2%](/lighttpd/lighttpd1.4/search?l=m4)
* [CMake
  1.0%](/lighttpd/lighttpd1.4/search?l=cmake)
* [Python
  0.7%](/lighttpd/lighttpd1.4/search?l=python)
* Other
  2.0%

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_d4aacd42_20250108_144947.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fp0dalirius%2FCVE-2022-30780-lighttpd-denial-of-service)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fp0dalirius%2FCVE-2022-30780-lighttpd-denial-of-service)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E&source=header-repo&source_repo=p0dalirius%2FCVE-2022-30780-lighttpd-denial-of-service)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[p0dalirius](/p0dalirius)
/
**[CVE-2022-30780-lighttpd-denial-of-service](/p0dalirius/CVE-2022-30780-lighttpd-denial-of-service)**
Public

* [Notifications](/login?return_to=%2Fp0dalirius%2FCVE-2022-30780-lighttpd-denial-of-service) You must be signed in to change notification settings
* [Fork
  4](/login?return_to=%2Fp0dalirius%2FCVE-2022-30780-lighttpd-denial-of-service)
* [Star
   16](/login?return_to=%2Fp0dalirius%2FCVE-2022-30780-lighttpd-denial-of-service)

CVE-2022-30780 - lighttpd remote denial of service

[podalirius.net/](https://podalirius.net/ "https://podalirius.net/")

[16
stars](/p0dalirius/CVE-2022-30780-lighttpd-denial-of-service/stargazers) [4
forks](/p0dalirius/CVE-2022-30780-lighttpd-denial-of-service/forks) [Branches](/p0dalirius/CVE-2022-30780-lighttpd-denial-of-service/branches) [Tags](/p0dalirius/CVE-2022-30780-lighttpd-denial-of-service/tags) [Activity](/p0dalirius/CVE-2022-30780-lighttpd-denial-of-service/activity)
 [Star](/login?return_to=%2Fp0dalirius%2FCVE-2022-30780-lighttpd-denial-of-service)

 [Notifications](/login?return_to=%2Fp0dalirius%2FCVE-2022-30780-lighttpd-denial-of-service) You must be signed in to change notification settings

* [Code](/p0dalirius/CVE-2022-30780-lighttpd-denial-of-service)
* [Issues
  0](/p0dalirius/CVE-2022-30780-lighttpd-denial-of-service/issues)
* [Pull requests
  0](/p0dalirius/CVE-2022-30780-lighttpd-denial-of-service/pulls)
* [Actions](/p0dalirius/CVE-2022-30780-lighttpd-denial-of-service/actions)
* [Projects
  0](/p0dalirius/CVE-2022-30780-lighttpd-denial-of-service/projects)
* [Security](/p0dalirius/CVE-2022-30780-lighttpd-denial-of-service/security)
* [Insights](/p0dalirius/CVE-2022-30780-lighttpd-denial-of-service/pulse)

Additional navigation options

* [Code](/p0dalirius/CVE-2022-30780-lighttpd-denial-of-service)
* [Issues](/p0dalirius/CVE-2022-30780-lighttpd-denial-of-service/issues)
* [Pull requests](/p0dalirius/CVE-2022-30780-lighttpd-denial-of-service/pulls)
* [Actions](/p0dalirius/CVE-2022-30780-lighttpd-denial-of-service/actions)
* [Projects](/p0dalirius/CVE-2022-30780-lighttpd-denial-of-service/projects)
* [Security](/p0dalirius/CVE-2022-30780-lighttpd-denial-of-service/security)
* [Insights](/p0dalirius/CVE-2022-30780-lighttpd-denial-of-service/pulse)

# p0dalirius/CVE-2022-30780-lighttpd-denial-of-service

    master[Branches](/p0dalirius/CVE-2022-30780-lighttpd-denial-of-service/branches)[Tags](/p0dalirius/CVE-2022-30780-lighttpd-denial-of-service/tags)Go to fileCode
## Folders and files

| Name | | Name | Last commit message | Last commit date |
| --- | --- | --- | --- | --- |
| Latest commit History[5 Commits](/p0dalirius/CVE-2022-30780-lighttpd-denial-of-service/commits/master/) | | |
| [.github](/p0dalirius/CVE-2022-30780-lighttpd-denial-of-service/tree/master/.github ".github") | | [.github](/p0dalirius/CVE-2022-30780-lighttpd-denial-of-service/tree/master/.github ".github") |  |  |
| [tests](/p0dalirius/CVE-2022-30780-lighttpd-denial-of-service/tree/master/tests "tests") | | [tests](/p0dalirius/CVE-2022-30780-lighttpd-denial-of-service/tree/master/tests "tests") |  |  |
| [CVE-2022-30780-lighttpd-denial-of-service.py](/p0dalirius/CVE-2022-30780-lighttpd-denial-of-service/blob/master/CVE-2022-30780-lighttpd-denial-of-service.py "CVE-2022-30780-lighttpd-denial-of-service.py") | | [CVE-2022-30780-lighttpd-denial-of-service.py](/p0dalirius/CVE-2022-30780-lighttpd-denial-of-service/blob/master/CVE-2022-30780-lighttpd-denial-of-service.py "CVE-2022-30780-lighttpd-denial-of-service.py") |  |  |
| [README.md](/p0dalirius/CVE-2022-30780-lighttpd-denial-of-service/blob/master/README.md "README.md") | | [README.md](/p0dalirius/CVE-2022-30780-lighttpd-denial-of-service/blob/master/README.md "README.md") |  |  |
| [generate\_tests.py](/p0dalirius/CVE-2022-30780-lighttpd-denial-of-service/blob/master/generate_tests.py "generate_tests.py") | | [generate\_tests.py](/p0dalirius/CVE-2022-30780-lighttpd-denial-of-service/blob/master/generate_tests.py "generate_tests.py") |  |  |
| [vulnerable\_versions.md](/p0dalirius/CVE-2022-30780-lighttpd-denial-of-service/blob/master/vulnerable_versions.md "vulnerable_versions.md") | | [vulnerable\_versions.md](/p0dalirius/CVE-2022-30780-lighttpd-denial-of-service/blob/master/vulnerable_versions.md "vulnerable_versions.md") |  |  |
| View all files | | |

## Repository files navigation

* README
# CVE-2022-30780 - lighttpd remote denial of service

CVE-2022-30780 - lighttpd remote denial of service

[![GitHub release (latest by date)](https://camo.githubusercontent.com/41aaa5777db55ccf3bb041aa259aaa8008787592e652d9b784b8e5980c7ab37f/68747470733a2f2f696d672e736869656c64732e696f2f6769746875622f762f72656c656173652f703064616c69726975732f4356452d323032322d33303738302d6c696768747470642d64656e69616c2d6f662d73657276696365)](https://camo.githubusercontent.com/41aaa5777db55ccf3bb041aa259aaa8008787592e652d9b784b8e5980c7ab37f/68747470733a2f2f696d672e736869656c64732e696f2f6769746875622f762f72656c656173652f703064616c69726975732f4356452d323032322d33303738302d6c696768747470642d64656e69616c2d6f662d73657276696365)
[![](https://camo.githubusercontent.com/1a0ff76e97d4ea9400ad9a743a5098433a247b7074504619b0d7d1c9ce0ec71d/68747470733a2f2f696d672e736869656c64732e696f2f747769747465722f666f6c6c6f772f706f64616c69726975735f3f6c6162656c3d506f64616c6972697573267374796c653d736f6369616c)](https://twitter.com/intent/follow?screen_name=podalirius_ "Follow")
[![YouTube Channel Subscribers](https://camo.githubusercontent.com/9290a03d341de27ed6637bde62bad1eb1d8c37ea19958a2d02bfe7d0250013d5/68747470733a2f2f696d672e736869656c64732e696f2f796f75747562652f6368616e6e656c2f73756273637269626572732f5543465f78354f3743536672383241664e56544b4f765f413f7374796c653d736f6369616c)](https://www.youtube.com/c/Podalirius_?sub_confirmation=1 "Subscribe")

## Summary

An unauthenticated attacker can send an HTTP request with an URL overflowing the maximum URL length, resulting in a denial of service.

### Vulnerable versions

The following versions of lighttpd are vulnerable:

| Software | Version | Vulnerable |
| --- | --- | --- |
| Lighttpd | [1.4.58](https://api.github.com/repos/lighttpd/lighttpd1.4/zipball/refs/tags/lighttpd-1.4.58) | [Yes ✅](/p0dalirius/CVE-2022-30780-lighttpd-denial-of-service/blob/master/tests/1.4.58) |
| Lighttpd | [1.4.57](https://api.github.com/repos/lighttpd/lighttpd1.4/zipball/refs/tags/lighttpd-1.4.57) | [Yes ✅](/p0dalirius/CVE-2022-30780-lighttpd-denial-of-service/blob/master/tests/1.4.57) |
| Lighttpd | [1.4.56](https://api.github.com/repos/lighttpd/lighttpd1.4/zipball/refs/tags/lighttpd-1.4.56) | [Yes ✅](/p0dalirius/CVE-2022-30780-lighttpd-denial-of-service/blob/master/tests/1.4.56) |

## Usage

```
$ ./CVE-2022-30780-lighttpd-denial-of-service.py -h
usage: CVE-2022-30780-lighttpd-denial-of-service.py [-h] [-v] -u URL [-k] [-t THREADS]

CVE-2022-30780-lighttpd-denial-of-service

optional arguments:
  -h, --help            show this help message and exit
  -v, --verbose         Verbose mode
  -u URL, --url URL     URL to connect to.
  -k, --insecure        Allow insecure server connections when using SSL (default: False)
  -t THREADS, --threads THREADS
                        Number of threads (default: 20)

```

## Demonstration

demo.mp4

## References

* <https://github.com/lighttpd/lighttpd1.4>
* <https://podalirius.net/en/cves/2022-30780/>
* <https://redmine.lighttpd.net/issues/3059>

## About

CVE-2022-30780 - lighttpd remote denial of service

[podalirius.net/](https://podalirius.net/ "https://podalirius.net/")

### Topics

[exploit](/topics/exploit "Topic: exploit")
[service](/topics/service "Topic: service")
[remote](/topics/remote "Topic: remote")
[lighttpd](/topics/lighttpd "Topic: lighttpd")
[cve](/topics/cve "Topic: cve")
[pentest](/topics/pentest "Topic: pentest")
[denial](/topics/denial "Topic: denial")
[cve-2022-30780](/topics/cve-2022-30780 "Topic: cve-2022-30780")

### Resources

[Readme](#readme-ov-file)

[Activity](/p0dalirius/CVE-2022-30780-lighttpd-denial-of-service/activity)
### Stars

[**16**
stars](/p0dalirius/CVE-2022-30780-lighttpd-denial-of-service/stargazers)
### Watchers

[**2**
watching](/p0dalirius/CVE-2022-30780-lighttpd-denial-of-service/watchers)
### Forks

[**4**
forks](/p0dalirius/CVE-2022-30780-lighttpd-denial-of-service/forks)
[Report repository](/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2Fp0dalirius%2FCVE-2022-30780-lighttpd-denial-of-service&report=p0dalirius+%28user%29)

## [Releases 1](/p0dalirius/CVE-2022-30780-lighttpd-denial-of-service/releases)

[1.1
Latest

May 18, 2022](/p0dalirius/CVE-2022-30780-lighttpd-denial-of-service/releases/tag/1.1)

## Sponsor this project

* ![patreon](https://github.githubassets.com/assets/patreon-96b15b9db4b9.svg)
  [patreon.com/**Podalirius**](https://patreon.com/Podalirius)

[Learn more about GitHub Sponsors](/sponsors)

## Languages

* [Perl
  43.4%](/p0dalirius/CVE-2022-30780-lighttpd-denial-of-service/search?l=perl)
* [HTML
  42.8%](/p0dalirius/CVE-2022-30780-lighttpd-denial-of-service/search?l=html)
* [Shell
  5.4%](/p0dalirius/CVE-2022-30780-lighttpd-denial-of-service/search?l=shell)
* [Dockerfile
  4.0%](/p0dalirius/CVE-2022-30780-lighttpd-denial-of-service/search?l=dockerfile)
* [Makefile
  3.5%](/p0dalirius/CVE-2022-30780-lighttpd-denial-of-service/search?l=makefile)
* [Python
  0.9%](/p0dalirius/CVE-2022-30780-lighttpd-denial-of-service/search?l=python)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_d4aacd42_20250108_105530.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fp0dalirius%2FCVE-2022-30780-lighttpd-denial-of-service)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fp0dalirius%2FCVE-2022-30780-lighttpd-denial-of-service)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E&source=header-repo&source_repo=p0dalirius%2FCVE-2022-30780-lighttpd-denial-of-service)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[p0dalirius](/p0dalirius)
/
**[CVE-2022-30780-lighttpd-denial-of-service](/p0dalirius/CVE-2022-30780-lighttpd-denial-of-service)**
Public

* [Notifications](/login?return_to=%2Fp0dalirius%2FCVE-2022-30780-lighttpd-denial-of-service) You must be signed in to change notification settings
* [Fork
  4](/login?return_to=%2Fp0dalirius%2FCVE-2022-30780-lighttpd-denial-of-service)
* [Star
   16](/login?return_to=%2Fp0dalirius%2FCVE-2022-30780-lighttpd-denial-of-service)

CVE-2022-30780 - lighttpd remote denial of service

[podalirius.net/](https://podalirius.net/ "https://podalirius.net/")

[16
stars](/p0dalirius/CVE-2022-30780-lighttpd-denial-of-service/stargazers) [4
forks](/p0dalirius/CVE-2022-30780-lighttpd-denial-of-service/forks) [Branches](/p0dalirius/CVE-2022-30780-lighttpd-denial-of-service/branches) [Tags](/p0dalirius/CVE-2022-30780-lighttpd-denial-of-service/tags) [Activity](/p0dalirius/CVE-2022-30780-lighttpd-denial-of-service/activity)
 [Star](/login?return_to=%2Fp0dalirius%2FCVE-2022-30780-lighttpd-denial-of-service)

 [Notifications](/login?return_to=%2Fp0dalirius%2FCVE-2022-30780-lighttpd-denial-of-service) You must be signed in to change notification settings

* [Code](/p0dalirius/CVE-2022-30780-lighttpd-denial-of-service)
* [Issues
  0](/p0dalirius/CVE-2022-30780-lighttpd-denial-of-service/issues)
* [Pull requests
  0](/p0dalirius/CVE-2022-30780-lighttpd-denial-of-service/pulls)
* [Actions](/p0dalirius/CVE-2022-30780-lighttpd-denial-of-service/actions)
* [Projects
  0](/p0dalirius/CVE-2022-30780-lighttpd-denial-of-service/projects)
* [Security](/p0dalirius/CVE-2022-30780-lighttpd-denial-of-service/security)
* [Insights](/p0dalirius/CVE-2022-30780-lighttpd-denial-of-service/pulse)

Additional navigation options

* [Code](/p0dalirius/CVE-2022-30780-lighttpd-denial-of-service)
* [Issues](/p0dalirius/CVE-2022-30780-lighttpd-denial-of-service/issues)
* [Pull requests](/p0dalirius/CVE-2022-30780-lighttpd-denial-of-service/pulls)
* [Actions](/p0dalirius/CVE-2022-30780-lighttpd-denial-of-service/actions)
* [Projects](/p0dalirius/CVE-2022-30780-lighttpd-denial-of-service/projects)
* [Security](/p0dalirius/CVE-2022-30780-lighttpd-denial-of-service/security)
* [Insights](/p0dalirius/CVE-2022-30780-lighttpd-denial-of-service/pulse)

# p0dalirius/CVE-2022-30780-lighttpd-denial-of-service

    master[Branches](/p0dalirius/CVE-2022-30780-lighttpd-denial-of-service/branches)[Tags](/p0dalirius/CVE-2022-30780-lighttpd-denial-of-service/tags)Go to fileCode
## Folders and files

| Name | | Name | Last commit message | Last commit date |
| --- | --- | --- | --- | --- |
| Latest commit History[5 Commits](/p0dalirius/CVE-2022-30780-lighttpd-denial-of-service/commits/master/) | | |
| [.github](/p0dalirius/CVE-2022-30780-lighttpd-denial-of-service/tree/master/.github ".github") | | [.github](/p0dalirius/CVE-2022-30780-lighttpd-denial-of-service/tree/master/.github ".github") |  |  |
| [tests](/p0dalirius/CVE-2022-30780-lighttpd-denial-of-service/tree/master/tests "tests") | | [tests](/p0dalirius/CVE-2022-30780-lighttpd-denial-of-service/tree/master/tests "tests") |  |  |
| [CVE-2022-30780-lighttpd-denial-of-service.py](/p0dalirius/CVE-2022-30780-lighttpd-denial-of-service/blob/master/CVE-2022-30780-lighttpd-denial-of-service.py "CVE-2022-30780-lighttpd-denial-of-service.py") | | [CVE-2022-30780-lighttpd-denial-of-service.py](/p0dalirius/CVE-2022-30780-lighttpd-denial-of-service/blob/master/CVE-2022-30780-lighttpd-denial-of-service.py "CVE-2022-30780-lighttpd-denial-of-service.py") |  |  |
| [README.md](/p0dalirius/CVE-2022-30780-lighttpd-denial-of-service/blob/master/README.md "README.md") | | [README.md](/p0dalirius/CVE-2022-30780-lighttpd-denial-of-service/blob/master/README.md "README.md") |  |  |
| [generate\_tests.py](/p0dalirius/CVE-2022-30780-lighttpd-denial-of-service/blob/master/generate_tests.py "generate_tests.py") | | [generate\_tests.py](/p0dalirius/CVE-2022-30780-lighttpd-denial-of-service/blob/master/generate_tests.py "generate_tests.py") |  |  |
| [vulnerable\_versions.md](/p0dalirius/CVE-2022-30780-lighttpd-denial-of-service/blob/master/vulnerable_versions.md "vulnerable_versions.md") | | [vulnerable\_versions.md](/p0dalirius/CVE-2022-30780-lighttpd-denial-of-service/blob/master/vulnerable_versions.md "vulnerable_versions.md") |  |  |
| View all files | | |

## Repository files navigation

* README
# CVE-2022-30780 - lighttpd remote denial of service

CVE-2022-30780 - lighttpd remote denial of service

[![GitHub release (latest by date)](https://camo.githubusercontent.com/41aaa5777db55ccf3bb041aa259aaa8008787592e652d9b784b8e5980c7ab37f/68747470733a2f2f696d672e736869656c64732e696f2f6769746875622f762f72656c656173652f703064616c69726975732f4356452d323032322d33303738302d6c696768747470642d64656e69616c2d6f662d73657276696365)](https://camo.githubusercontent.com/41aaa5777db55ccf3bb041aa259aaa8008787592e652d9b784b8e5980c7ab37f/68747470733a2f2f696d672e736869656c64732e696f2f6769746875622f762f72656c656173652f703064616c69726975732f4356452d323032322d33303738302d6c696768747470642d64656e69616c2d6f662d73657276696365)
[![](https://camo.githubusercontent.com/1a0ff76e97d4ea9400ad9a743a5098433a247b7074504619b0d7d1c9ce0ec71d/68747470733a2f2f696d672e736869656c64732e696f2f747769747465722f666f6c6c6f772f706f64616c69726975735f3f6c6162656c3d506f64616c6972697573267374796c653d736f6369616c)](https://twitter.com/intent/follow?screen_name=podalirius_ "Follow")
[![YouTube Channel Subscribers](https://camo.githubusercontent.com/9290a03d341de27ed6637bde62bad1eb1d8c37ea19958a2d02bfe7d0250013d5/68747470733a2f2f696d672e736869656c64732e696f2f796f75747562652f6368616e6e656c2f73756273637269626572732f5543465f78354f3743536672383241664e56544b4f765f413f7374796c653d736f6369616c)](https://www.youtube.com/c/Podalirius_?sub_confirmation=1 "Subscribe")

## Summary

An unauthenticated attacker can send an HTTP request with an URL overflowing the maximum URL length, resulting in a denial of service.

### Vulnerable versions

The following versions of lighttpd are vulnerable:

| Software | Version | Vulnerable |
| --- | --- | --- |
| Lighttpd | [1.4.58](https://api.github.com/repos/lighttpd/lighttpd1.4/zipball/refs/tags/lighttpd-1.4.58) | [Yes ✅](/p0dalirius/CVE-2022-30780-lighttpd-denial-of-service/blob/master/tests/1.4.58) |
| Lighttpd | [1.4.57](https://api.github.com/repos/lighttpd/lighttpd1.4/zipball/refs/tags/lighttpd-1.4.57) | [Yes ✅](/p0dalirius/CVE-2022-30780-lighttpd-denial-of-service/blob/master/tests/1.4.57) |
| Lighttpd | [1.4.56](https://api.github.com/repos/lighttpd/lighttpd1.4/zipball/refs/tags/lighttpd-1.4.56) | [Yes ✅](/p0dalirius/CVE-2022-30780-lighttpd-denial-of-service/blob/master/tests/1.4.56) |

## Usage

```
$ ./CVE-2022-30780-lighttpd-denial-of-service.py -h
usage: CVE-2022-30780-lighttpd-denial-of-service.py [-h] [-v] -u URL [-k] [-t THREADS]

CVE-2022-30780-lighttpd-denial-of-service

optional arguments:
  -h, --help            show this help message and exit
  -v, --verbose         Verbose mode
  -u URL, --url URL     URL to connect to.
  -k, --insecure        Allow insecure server connections when using SSL (default: False)
  -t THREADS, --threads THREADS
                        Number of threads (default: 20)

```

## Demonstration

demo.mp4

## References

* <https://github.com/lighttpd/lighttpd1.4>
* <https://podalirius.net/en/cves/2022-30780/>
* <https://redmine.lighttpd.net/issues/3059>

## About

CVE-2022-30780 - lighttpd remote denial of service

[podalirius.net/](https://podalirius.net/ "https://podalirius.net/")

### Topics

[exploit](/topics/exploit "Topic: exploit")
[service](/topics/service "Topic: service")
[remote](/topics/remote "Topic: remote")
[lighttpd](/topics/lighttpd "Topic: lighttpd")
[cve](/topics/cve "Topic: cve")
[pentest](/topics/pentest "Topic: pentest")
[denial](/topics/denial "Topic: denial")
[cve-2022-30780](/topics/cve-2022-30780 "Topic: cve-2022-30780")

### Resources

[Readme](#readme-ov-file)

[Activity](/p0dalirius/CVE-2022-30780-lighttpd-denial-of-service/activity)
### Stars

[**16**
stars](/p0dalirius/CVE-2022-30780-lighttpd-denial-of-service/stargazers)
### Watchers

[**2**
watching](/p0dalirius/CVE-2022-30780-lighttpd-denial-of-service/watchers)
### Forks

[**4**
forks](/p0dalirius/CVE-2022-30780-lighttpd-denial-of-service/forks)
[Report repository](/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2Fp0dalirius%2FCVE-2022-30780-lighttpd-denial-of-service&report=p0dalirius+%28user%29)

## [Releases 1](/p0dalirius/CVE-2022-30780-lighttpd-denial-of-service/releases)

[1.1
Latest

May 18, 2022](/p0dalirius/CVE-2022-30780-lighttpd-denial-of-service/releases/tag/1.1)

## Sponsor this project

* ![patreon](https://github.githubassets.com/assets/patreon-96b15b9db4b9.svg)
  [patreon.com/**Podalirius**](https://patreon.com/Podalirius)

[Learn more about GitHub Sponsors](/sponsors)

## Languages

* [Perl
  43.4%](/p0dalirius/CVE-2022-30780-lighttpd-denial-of-service/search?l=perl)
* [HTML
  42.8%](/p0dalirius/CVE-2022-30780-lighttpd-denial-of-service/search?l=html)
* [Shell
  5.4%](/p0dalirius/CVE-2022-30780-lighttpd-denial-of-service/search?l=shell)
* [Dockerfile
  4.0%](/p0dalirius/CVE-2022-30780-lighttpd-denial-of-service/search?l=dockerfile)
* [Makefile
  3.5%](/p0dalirius/CVE-2022-30780-lighttpd-denial-of-service/search?l=makefile)
* [Python
  0.9%](/p0dalirius/CVE-2022-30780-lighttpd-denial-of-service/search?l=python)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


