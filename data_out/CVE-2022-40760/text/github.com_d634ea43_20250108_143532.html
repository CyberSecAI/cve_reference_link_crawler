
[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FSamsung%2FmTower%2Fblob%2Fefd36709306a9afcca5b4782499d01be0c7a02a5%2Fcrypto%2Flibtomcrypt%2Finclude%2Ftomcrypt_hash.h)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FSamsung%2FmTower%2Fblob%2Fefd36709306a9afcca5b4782499d01be0c7a02a5%2Fcrypto%2Flibtomcrypt%2Finclude%2Ftomcrypt_hash.h)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=Samsung%2FmTower)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[Samsung](/Samsung)
/
**[mTower](/Samsung/mTower)**
Public

* [Notifications](/login?return_to=%2FSamsung%2FmTower) You must be signed in to change notification settings
* [Fork
  17](/login?return_to=%2FSamsung%2FmTower)
* [Star
   54](/login?return_to=%2FSamsung%2FmTower)

* [Code](/Samsung/mTower)
* [Issues
  13](/Samsung/mTower/issues)
* [Pull requests
  0](/Samsung/mTower/pulls)
* [Actions](/Samsung/mTower/actions)
* [Projects
  0](/Samsung/mTower/projects)
* [Security](/Samsung/mTower/security)
* [Insights](/Samsung/mTower/pulse)

Additional navigation options

* [Code](/Samsung/mTower)
* [Issues](/Samsung/mTower/issues)
* [Pull requests](/Samsung/mTower/pulls)
* [Actions](/Samsung/mTower/actions)
* [Projects](/Samsung/mTower/projects)
* [Security](/Samsung/mTower/security)
* [Insights](/Samsung/mTower/pulse)

## Files

 efd3670
## Breadcrumbs

1. [mTower](/Samsung/mTower/tree/efd36709306a9afcca5b4782499d01be0c7a02a5)
2. /[crypto](/Samsung/mTower/tree/efd36709306a9afcca5b4782499d01be0c7a02a5/crypto)
3. /[libtomcrypt](/Samsung/mTower/tree/efd36709306a9afcca5b4782499d01be0c7a02a5/crypto/libtomcrypt)
4. /[include](/Samsung/mTower/tree/efd36709306a9afcca5b4782499d01be0c7a02a5/crypto/libtomcrypt/include)
/
# tomcrypt\_hash.h

 Blame  Blame
## Latest commit

## History

[History](/Samsung/mTower/commits/efd36709306a9afcca5b4782499d01be0c7a02a5/crypto/libtomcrypt/include/tomcrypt_hash.h)428 lines (387 loc) · 15.5 KB efd3670
## Breadcrumbs

1. [mTower](/Samsung/mTower/tree/efd36709306a9afcca5b4782499d01be0c7a02a5)
2. /[crypto](/Samsung/mTower/tree/efd36709306a9afcca5b4782499d01be0c7a02a5/crypto)
3. /[libtomcrypt](/Samsung/mTower/tree/efd36709306a9afcca5b4782499d01be0c7a02a5/crypto/libtomcrypt)
4. /[include](/Samsung/mTower/tree/efd36709306a9afcca5b4782499d01be0c7a02a5/crypto/libtomcrypt/include)
/
# tomcrypt\_hash.h

Top
## File metadata and controls

* Code
* Blame

428 lines (387 loc) · 15.5 KB[Raw](https://github.com/Samsung/mTower/raw/efd36709306a9afcca5b4782499d01be0c7a02a5/crypto/libtomcrypt/include/tomcrypt_hash.h)123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257258259260261262263264265266267268269270271272273274275276277278279280281282283284285286287288289290291292293294295296297298299300301302303304305306307308309310311312313314315316317318319320321322323324325326327328329330331332333334335336337338339340341342343344345346347348349350351352353354355356357358359360361362363364365366367368369370371372373374375376377378379380381382383384385386387388389390391392393394395396397398399400401402403404405406407408409410411412413414415416417418419420421422423424425426427428/\* SPDX-License-Identifier: BSD-2-Clause \*//\* \* Copyright (c) 2001-2007, Tom St Denis \* All rights reserved. \* \* Redistribution and use in source and binary forms, with or without \* modification, are permitted provided that the following conditions are met: \* \* 1. Redistributions of source code must retain the above copyright notice, \* this list of conditions and the following disclaimer. \* \* 2. Redistributions in binary form must reproduce the above copyright notice, \* this list of conditions and the following disclaimer in the documentation \* and/or other materials provided with the distribution. \* \* THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" \* AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE \* IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE \* ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE \* LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR \* CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF \* SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS \* INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN \* CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) \* ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE \* POSSIBILITY OF SUCH DAMAGE. \*/
/\* ---- HASH FUNCTIONS ---- \*/#ifdef LTC\_SHA512struct sha512\_state { ulong64 length, state[8]; unsigned long curlen; unsigned char buf[128];};#endif
#if defined(LTC\_SHA256) || defined(LTC\_SHA256\_ARM32\_CE)struct sha256\_state { ulong64 length; ulong32 state[8], curlen; unsigned char buf[64];};#endif
#if defined(LTC\_SHA1) || defined(LTC\_SHA1\_ARM32\_CE) || defined(LTC\_SHA1\_ARM64\_CE)struct sha1\_state { ulong64 length; ulong32 state[5], curlen; unsigned char buf[64];};#endif
#ifdef LTC\_MD5struct md5\_state { ulong64 length; ulong32 state[4], curlen; unsigned char buf[64];};#endif
#ifdef LTC\_MD4struct md4\_state { ulong64 length; ulong32 state[4], curlen; unsigned char buf[64];};#endif
#ifdef LTC\_TIGERstruct tiger\_state { ulong64 state[3], length; unsigned long curlen; unsigned char buf[64];};#endif
#ifdef LTC\_MD2struct md2\_state { unsigned char chksum[16], X[48], buf[16]; unsigned long curlen;};#endif
#ifdef LTC\_RIPEMD128struct rmd128\_state { ulong64 length; unsigned char buf[64]; ulong32 curlen, state[4];};#endif
#ifdef LTC\_RIPEMD160struct rmd160\_state { ulong64 length; unsigned char buf[64]; ulong32 curlen, state[5];};#endif
#ifdef LTC\_RIPEMD256struct rmd256\_state { ulong64 length; unsigned char buf[64]; ulong32 curlen, state[8];};#endif
#ifdef LTC\_RIPEMD320struct rmd320\_state { ulong64 length; unsigned char buf[64]; ulong32 curlen, state[10];};#endif
#ifdef LTC\_WHIRLPOOLstruct whirlpool\_state { ulong64 length, state[8]; unsigned char buf[64]; ulong32 curlen;};#endif
#ifdef LTC\_CHC\_HASHstruct chc\_state { ulong64 length; unsigned char state[MAXBLOCKSIZE], buf[MAXBLOCKSIZE]; ulong32 curlen;};#endif
typedef union Hash\_state { char dummy[1];#ifdef LTC\_CHC\_HASH struct chc\_state chc;#endif#ifdef LTC\_WHIRLPOOL struct whirlpool\_state whirlpool;#endif#ifdef LTC\_SHA512 struct sha512\_state sha512;#endif#if defined(LTC\_SHA256) || defined(LTC\_SHA256\_ARM32\_CE) struct sha256\_state sha256;#endif#if defined(LTC\_SHA1) || defined(LTC\_SHA1\_ARM32\_CE) struct sha1\_state sha1;#endif#ifdef LTC\_MD5 struct md5\_state md5;#endif#ifdef LTC\_MD4 struct md4\_state md4;#endif#ifdef LTC\_MD2 struct md2\_state md2;#endif#ifdef LTC\_TIGER struct tiger\_state tiger;#endif#ifdef LTC\_RIPEMD128 struct rmd128\_state rmd128;#endif#ifdef LTC\_RIPEMD160 struct rmd160\_state rmd160;#endif#ifdef LTC\_RIPEMD256 struct rmd256\_state rmd256;#endif#ifdef LTC\_RIPEMD320 struct rmd320\_state rmd320;#endif void \*data;} hash\_state;
/\*\* hash descriptor \*/extern const struct ltc\_hash\_descriptor { /\*\* name of hash \*/ const char \*name; /\*\* internal ID \*/ unsigned char ID; /\*\* Size of digest in octets \*/ unsigned long hashsize; /\*\* Input block size in octets \*/ unsigned long blocksize; /\*\* ASN.1 OID \*/ unsigned long OID[16]; /\*\* Length of DER encoding \*/ unsigned long OIDlen;
 /\*\* Init a hash state @param hash The hash to initialize @return CRYPT\_OK if successful \*/ int (\*init)(hash\_state \*hash); /\*\* Process a block of data  @param hash The hash state @param in The data to hash @param inlen The length of the data (octets) @return CRYPT\_OK if successful \*/ int (\*process)(hash\_state \*hash, const unsigned char \*in, unsigned long inlen); /\*\* Produce the digest and store it @param hash The hash state @param out [out] The destination of the digest @return CRYPT\_OK if successful \*/ int (\*done)(hash\_state \*hash, unsigned char \*out); /\*\* Self-test @return CRYPT\_OK if successful, CRYPT\_NOP if self-tests have been disabled \*/ int (\*test)(void);
 /\* accelerated hmac callback: if you need to-do multiple packets just use the generic hmac\_memory and provide a hash callback \*/ int (\*hmac\_block)(const unsigned char \*key, unsigned long keylen, const unsigned char \*in, unsigned long inlen,  unsigned char \*out, unsigned long \*outlen);
} \*hash\_descriptor[];
#ifdef LTC\_CHC\_HASHint chc\_register(int cipher);int chc\_init(hash\_state \* md);int chc\_process(hash\_state \* md, const unsigned char \*in, unsigned long inlen);int chc\_done(hash\_state \* md, unsigned char \*hash);int chc\_test(void);extern const struct ltc\_hash\_descriptor chc\_desc;#endif
#ifdef LTC\_WHIRLPOOLint whirlpool\_init(hash\_state \* md);int whirlpool\_process(hash\_state \* md, const unsigned char \*in, unsigned long inlen);int whirlpool\_done(hash\_state \* md, unsigned char \*hash);int whirlpool\_test(void);extern const struct ltc\_hash\_descriptor whirlpool\_desc;#endif
#ifdef LTC\_SHA512int sha512\_init(hash\_state \* md);int sha512\_process(hash\_state \* md, const unsigned char \*in, unsigned long inlen);int sha512\_done(hash\_state \* md, unsigned char \*hash);int sha512\_test(void);extern const struct ltc\_hash\_descriptor sha512\_desc;#endif
#ifdef LTC\_SHA384#ifndef LTC\_SHA512 #error LTC\_SHA512 is required for LTC\_SHA384#endifint sha384\_init(hash\_state \* md);#define sha384\_process sha512\_processint sha384\_done(hash\_state \* md, unsigned char \*hash);int sha384\_test(void);extern const struct ltc\_hash\_descriptor sha384\_desc;#endif
#if defined(LTC\_SHA256) || defined(LTC\_SHA256\_ARM32\_CE)int sha256\_init(hash\_state \* md);int sha256\_process(hash\_state \* md, const unsigned char \*in, unsigned long inlen);int sha256\_done(hash\_state \* md, unsigned char \*hash);int sha256\_test(void);extern const struct ltc\_hash\_descriptor sha256\_desc;
#ifdef LTC\_SHA224#ifndef LTC\_SHA256 #error LTC\_SHA256 is required for LTC\_SHA224#endifint sha224\_init(hash\_state \* md);#define sha224\_process sha256\_processint sha224\_done(hash\_state \* md, unsigned char \*hash);int sha224\_test(void);extern const struct ltc\_hash\_descriptor sha224\_desc;#endif#endif
#if defined(LTC\_SHA1) || defined(LTC\_SHA1\_ARM32\_CE)int sha1\_init(hash\_state \* md);int sha1\_process(hash\_state \* md, const unsigned char \*in, unsigned long inlen);int sha1\_done(hash\_state \* md, unsigned char \*hash);int sha1\_test(void);extern const struct ltc\_hash\_descriptor sha1\_desc;#endif
#ifdef LTC\_MD5int md5\_init(hash\_state \* md);int md5\_process(hash\_state \* md, const unsigned char \*in, unsigned long inlen);int md5\_done(hash\_state \* md, unsigned char \*hash);int md5\_test(void);extern const struct ltc\_hash\_descriptor md5\_desc;#endif
#ifdef LTC\_MD4int md4\_init(hash\_state \* md);int md4\_process(hash\_state \* md, const unsigned char \*in, unsigned long inlen);int md4\_done(hash\_state \* md, unsigned char \*hash);int md4\_test(void);extern const struct ltc\_hash\_descriptor md4\_desc;#endif
#ifdef LTC\_MD2int md2\_init(hash\_state \* md);int md2\_process(hash\_state \* md, const unsigned char \*in, unsigned long inlen);int md2\_done(hash\_state \* md, unsigned char \*hash);int md2\_test(void);extern const struct ltc\_hash\_descriptor md2\_desc;#endif
#ifdef LTC\_TIGERint tiger\_init(hash\_state \* md);int tiger\_process(hash\_state \* md, const unsigned char \*in, unsigned long inlen);int tiger\_done(hash\_state \* md, unsigned char \*hash);int tiger\_test(void);extern const struct ltc\_hash\_descriptor tiger\_desc;#endif
#ifdef LTC\_RIPEMD128int rmd128\_init(hash\_state \* md);int rmd128\_process(hash\_state \* md, const unsigned char \*in, unsigned long inlen);int rmd128\_done(hash\_state \* md, unsigned char \*hash);int rmd128\_test(void);extern const struct ltc\_hash\_descriptor rmd128\_desc;#endif
#ifdef LTC\_RIPEMD160int rmd160\_init(hash\_state \* md);int rmd160\_process(hash\_state \* md, const unsigned char \*in, unsigned long inlen);int rmd160\_done(hash\_state \* md, unsigned char \*hash);int rmd160\_test(void);extern const struct ltc\_hash\_descriptor rmd160\_desc;#endif
#ifdef LTC\_RIPEMD256int rmd256\_init(hash\_state \* md);int rmd256\_process(hash\_state \* md, const unsigned char \*in, unsigned long inlen);int rmd256\_done(hash\_state \* md, unsigned char \*hash);int rmd256\_test(void);extern const struct ltc\_hash\_descriptor rmd256\_desc;#endif
#ifdef LTC\_RIPEMD320int rmd320\_init(hash\_state \* md);int rmd320\_process(hash\_state \* md, const unsigned char \*in, unsigned long inlen);int rmd320\_done(hash\_state \* md, unsigned char \*hash);int rmd320\_test(void);extern const struct ltc\_hash\_descriptor rmd320\_desc;#endif
int find\_hash(const char \*name);int find\_hash\_id(unsigned char ID);int find\_hash\_oid(const unsigned long \*ID, unsigned long IDlen);int find\_hash\_any(const char \*name, int digestlen);int register\_hash(const struct ltc\_hash\_descriptor \*hash);int unregister\_hash(const struct ltc\_hash\_descriptor \*hash);int hash\_is\_valid(int idx);
LTC\_MUTEX\_PROTO(ltc\_hash\_mutex)
int hash\_memory(int hash,  const unsigned char \*in, unsigned long inlen,  unsigned char \*out, unsigned long \*outlen);int hash\_memory\_multi(int hash, unsigned char \*out, unsigned long \*outlen, const unsigned char \*in, unsigned long inlen, ...);int hash\_filehandle(int hash, FILE \*in, unsigned char \*out, unsigned long \*outlen);int hash\_file(int hash, const char \*fname, unsigned char \*out, unsigned long \*outlen);
/\* a macro for making hash "process" functions \*/#define HASH\_PROCESS\_(func\_name, compress\_name, compress\_n\_name, state\_var, block\_size) \int func\_name (hash\_state \* md, const unsigned char \*in, unsigned long inlen) \{ \ unsigned long n, blocks; \ int err; \ int (\*compress)(hash\_state \*, unsigned char \*) = compress\_name; \ int (\*compress\_n)(hash\_state \*, unsigned char \*, int) = compress\_n\_name; \ LTC\_ARGCHK(md != NULL); \ LTC\_ARGCHK(in != NULL); \ if (md-> state\_var .curlen > sizeof(md-> state\_var .buf)) { \ return CRYPT\_INVALID\_ARG; \ } \ while (inlen > 0) { \ if (md-> state\_var .curlen == 0 && inlen >= block\_size) { \ if (compress\_n) { \ blocks = inlen / block\_size; \ err = compress\_n (md, (unsigned char \*)in, blocks); \ } else { \ blocks = 1; \ err = compress (md, (unsigned char \*)in); \ } \ if (err != CRYPT\_OK) \ return err; \ md-> state\_var .length += blocks \* block\_size \* 8; \ in += blocks \* block\_size; \ inlen -= blocks \* block\_size; \ } else { \ n = MIN(inlen, (block\_size - md-> state\_var .curlen)); \ memcpy(md-> state\_var .buf + md-> state\_var.curlen, in, (size\_t)n); \ md-> state\_var .curlen += n; \ in += n; \ inlen -= n; \ if (md-> state\_var .curlen == block\_size) { \ if (compress\_n) { \ err = compress\_n (md, md-> state\_var .buf, 1); \ } else { \ err = compress (md, md-> state\_var .buf); \ } \ if (err != CRYPT\_OK) { \ return err; \ } \ md-> state\_var .length += 8\*block\_size; \ md-> state\_var .curlen = 0; \ } \ } \ } \ return CRYPT\_OK; \}
/\* define a hash "process" function based on a 1-block compress function \*/#define HASH\_PROCESS(func\_name, compress\_name, state\_var, block\_size) \ HASH\_PROCESS\_(func\_name, compress\_name, NULL, state\_var, block\_size)
/\* define a hash "process" function based on a n-block compress function \*/#define HASH\_PROCESS\_NBLOCKS(func\_name, compress\_n\_name, state\_var, block\_size) \ HASH\_PROCESS\_(func\_name, NULL, compress\_n\_name, state\_var, block\_size)
/\* $Source: /cvs/libtom/libtomcrypt/src/headers/tomcrypt\_hash.h,v $ \*//\* $Revision: 1.22 $ \*//\* $Date: 2007/05/12 14:32:35 $ \*/

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.

