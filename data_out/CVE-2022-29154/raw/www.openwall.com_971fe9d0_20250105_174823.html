<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>oss-security - CVE-2022-29154: Rsync client-side arbitrary file write vulnerability.</title>

<link href="/style.css" type="text/css" rel="stylesheet">
<style type="text/css">
.calendar { text-align: center; }
.ccell { background: #ccc; width: 5ex; padding: 2px; }

.cal_brief { text-align: center; }
.cal_brief td:first-child { background: inherit; }
.cal_brief td { background: #ccc; width: 5ex; padding: 2px; }
.cal_big { text-align: center; padding: 0; margin: 0; }
.cal_big td { padding: 0 2px; }
.cal_mon { text-align: center; }
.cal_mon th { font-size: small; padding: 0; margin: 0; }
.cal_mon td { background: #ccc; width: 5ex; height: 1.5em;
	padding: 2px; text-align: right; }
.cal_mon td[colspan] { background: inherit; }
.cal_mon sup { color: #F0F0F0; text-align: left; float: left;
	margin-top: -2pt; font-weight: bold; }
.cal_mon a { text-align: right; margin-left: -4em; float: right; }
</style>
</head>

<BODY bgcolor="#E0E0E0" text="black" link="blue" alink="red" vlink="navy">


<table bgcolor="#ffffff" width="100%" border="0" cellspacing="0" cellpadding="0">
<tr>

<td>
<a href="/"><img class="logo" src="/logo.png" border="0" width="182" height="80" alt="Openwall"></a>
<td width="100%">
<div class="nav">
<ul>
<li><a href="/">Products</a>
<ul>
<li><a href="/Owl/">Openwall GNU/*/Linux &nbsp; <i>server OS</i></a>
<li><a href="/lkrg/">Linux Kernel Runtime Guard</a>
<li><a href="/john/">John the Ripper &nbsp; <i>password cracker</i></a>
<ul>
<li><a href="/john/">Free &amp; Open Source for any platform</a>
<li><a href="/john/cloud/">in the cloud</a>
<li><a href="/john/pro/linux/">Pro for Linux</a>
<li><a href="/john/pro/macosx/">Pro for macOS</a>
</ul>
<li><a href="/wordlists/">Wordlists &nbsp; <i>for password cracking</i></a>
<li><a href="/passwdqc/">passwdqc &nbsp; <i>policy enforcement</i></a>
<ul>
<li><a href="/passwdqc/">Free &amp; Open Source for Unix</a>
<li><a href="/passwdqc/windows/">Pro for Windows (Active Directory)</a>
</ul>
<li><a href="/yescrypt/">yescrypt &nbsp; <i>KDF &amp; password hashing</i></a>
<li><a href="/yespower/">yespower &nbsp; <i>Proof-of-Work (PoW)</i></a>
<li><a href="/crypt/">crypt_blowfish &nbsp; <i>password hashing</i></a>
<li><a href="/phpass/">phpass &nbsp; <i>ditto in PHP</i></a>
<li><a href="/tcb/">tcb &nbsp; <i>better password shadowing</i></a>
<li><a href="/pam/">Pluggable Authentication Modules</a>
<li><a href="/scanlogd/">scanlogd &nbsp; <i>port scan detector</i></a>
<li><a href="/popa3d/">popa3d &nbsp; <i>tiny POP3 daemon</i></a>
<li><a href="/blists/">blists &nbsp; <i>web interface to mailing lists</i></a>
<li><a href="/msulogin/">msulogin &nbsp; <i>single user mode login</i></a>
<li><a href="/php_mt_seed/">php_mt_seed &nbsp; <i>mt_rand() cracker</i></a>
</ul>
<li><a href="/services/">Services</a>
<li id="narrow-li-1"><a>Publications</a>
<ul>
<li><a href="/articles/">Articles</a>
<li><a href="/presentations/">Presentations</a>
</ul>
<li><a>Resources</a>
<ul>
<li><a href="/lists/">Mailing lists</a>
<li><a href="https://openwall.info/wiki/">Community wiki</a>
<li><a href="https://github.com/openwall">Source code repositories (GitHub)</a>
<li><a href="https://cvsweb.openwall.com">Source code repositories (CVSweb)</a>
<li><a href="/mirrors/">File archive &amp; mirrors</a>
<li><a href="/signatures/">How to verify digital signatures</a>
<li><a href="/ove/">OVE IDs</a>
</ul>
<li id="last-li"><a href="/news">What's new</a>
</ul>
</div>


</table>


<TABLE bgcolor="#B4D0DC" width="100%" border="0" cellspacing="0" cellpadding="1">
<TR><TD>
<TABLE width="100%" border="0" cellspacing="0" cellpadding="2">
<TR><TD bgcolor="#ECF8FF">
<a href="https://twitter.com/openwall">
Follow @Openwall on Twitter for new release announcements and other news</a>

</TABLE>
</TABLE>

<a href="../../../2022/07/28/2">[&lt;prev]</a> <a href="../../../2022/08/03/1">[next&gt;]</a> <a href=".">[day]</a> <a href="..">[month]</a> <a href="../..">[year]</a> <a href="../../..">[list]</a>
<pre style="white-space: pre-wrap">
Message-ID: &lt;adf7f4c9-f388-a882-562a-f2b424f16a09&#64;prodaft.com&gt;
Date: Tue, 2 Aug 2022 11:53:25 +0300
From: EGE BALCI &lt;ege&#64;...daft.com&gt;
To: oss-security&#64;...ts.openwall.com
Subject: CVE-2022-29154: Rsync client-side arbitrary file write vulnerability.

Date reported           : July 25, 2022
CVE identifiers         : CVE-2022-29154.
------------------------------------------------------------------------
Rsync client-side arbitrary file write vulnerability. (CVE-2022-29154)
------------------------------------------------------------------------

 &gt;&gt;&gt;&gt; We have discovered a critical arbitrary file write vulnerability 
in the
 &gt;&gt;&gt;&gt; rsync utility that allows malicious remote servers to write arbitrary
 &gt;&gt;&gt;&gt; files inside the directories of connecting peers. The server chooses
 &gt;&gt;&gt;&gt; which files/directories are sent to the client. Due to the 
insufficient
 &gt;&gt;&gt;&gt; controls inside the
 &gt;&gt;&gt;&gt; [do_server_recv](
 &gt;&gt;&gt; 
<a href="https://github.com/WayneD/rsync/blob/85c56b2603d97c225889175797ffff6745a4d305/main.c#L1118" rel="nofollow">https://github.com/WayneD/rsync/blob/85c56b2603d97c225889175797ffff6745a4d305/main.c#L1118</a>
 &gt;&gt;&gt; )
 &gt;&gt;&gt;&gt; function, a malicious rysnc server (or Man-in-The-Middle attacker) can
 &gt;&gt;&gt;&gt; overwrite arbitrary files in the rsync client target directory and
 &gt;&gt;&gt;&gt; subdirectories. An attacker abusing this vulnerability can overwrite
 &gt;&gt;&gt;&gt; critical files under the target rsync directory and subdirectories 
(for
 &gt;&gt;&gt;&gt; example, to overwrite the .ssh/authorized_keys file). This issue 
is very
 &gt;&gt;&gt;&gt; similar with the
 &gt;&gt;&gt;&gt; [CVE-2019-6111](<a href="https://www.youtube.com/watch?v=fcesKgfSPq4" rel="nofollow">https://www.youtube.com/watch?v=fcesKgfSPq4</a>).
 &gt;&gt;&gt;&gt;
 &gt;&gt;&gt;&gt; Best regards, Ege BALCI, Taha HAMAD.

The vulnerability was addressed with the developer of the rsync project 
and necessary patches are made. Related commit and details can be found 
in the following links,
- <a href="https://download.samba.org/pub/rsync/NEWS" rel="nofollow">https://download.samba.org/pub/rsync/NEWS</a>
- <a href="https://download.samba.org/pub/rsync/rsync.1#MULTI-HOST_SECURITY" rel="nofollow">https://download.samba.org/pub/rsync/rsync.1#MULTI-HOST_SECURITY</a>
- 
<a href="https://github.com/WayneD/rsync/commit/b7231c7d02cfb65d291af74ff66e7d8c507ee871" rel="nofollow">https://github.com/WayneD/rsync/commit/b7231c7d02cfb65d291af74ff66e7d8c507ee871</a>

We recommend updating to the latest stable versions of rsync.

-- 
*Ege BALCI*
Threat Intelligence Team Lead

*PRODAFT Cyber Security Technologies INC.*
*CH:* Y-Parc, rue Galilée 7, 1400 Yverdon-les-Bains, Switzerland
*NL:* Wilhelmina van Pruisenweg 104, 2595 AN Den Haag, Netherlands
*E.:*ege[at]prodaft.com
*IN:*/egebalci

In case you think you’re not the designated recipient of the e-mail 
hereby; please delete it accordingly. *This e-mail may have been sent 
from a mobile device. Please contact me from my mobile, in case you 
notice an error in the content. PS. Feel free to contact me via Signal, 
Threema or Telegram; or ask for my public PGP key for high-profile cases 
that may require higher confidentiality.

<span style="font-family: times;"><strong>Content of type "</strong>text/html<strong>" skipped</strong></span>

<span style="font-family: times;"><strong>Download attachment "</strong><a href="1/1" rel="nofollow" download>OpenPGP_0xCDCA0F4B4445AA39.asc</a><strong>" of type "</strong>application/pgp-keys<strong>" (649 bytes)</strong></span>

<span style="font-family: times;"><strong>Download attachment "</strong><a href="1/2" rel="nofollow" download>OpenPGP_signature</a><strong>" of type "</strong>application/pgp-signature<strong>" (237 bytes)</strong></span>
</pre>
<p><a href="https://www.openwall.com/blists/">Powered by blists</a> - <a href="https://lists.openwall.net">more mailing lists</a>


<p>
Please check out the
<a href="https://oss-security.openwall.org/wiki/">
Open Source Software Security Wiki</a>, which is counterpart to this
<a href="https://oss-security.openwall.org/wiki/mailing-lists/oss-security">mailing list</a>.
<p>
Confused about <a href="/lists/">mailing lists</a> and their use?
<a href="https://en.wikipedia.org/wiki/Electronic_mailing_list">Read about mailing lists on Wikipedia</a>
and check out these
<a href="https://www.complang.tuwien.ac.at/anton/mail-news-errors.html">guidelines on proper formatting of your messages</a>.
<p>

</body>
</html>
