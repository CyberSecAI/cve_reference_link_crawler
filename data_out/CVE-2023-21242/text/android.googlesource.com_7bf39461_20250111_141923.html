
Commit Information:
------------------
Author: Hai Shalom  1678383873 -0800
Date: Android Build Coastguard Worker  1683830505 +0000
Bug ID: Bug: 277824547
Commit Message:
--------------
[TOFU] Validate full cert chains before displaying dialogWhen a full chain including a Root CA is provided by the server,perform a full validation of the chain before displaying theTOFU dialog.If validation passes: Display a TOFU dialog and ask the user ifthey trust this network. Saying yes means that the Root can beinstalled safely for that network. They might say no - this ispossible if an attacker creates a full chain they control whichresults in a different SHA-256 (everything else looks correct).If they say no, we stop the connection.If validation fails: Display an error message saying that thevalidation failed, we stop the connection and won't display theTOFU dialog.Use server certificate pinning for servers that send only a leafor a partial chain with no Root CA.Additionally: clean up the debug logs to reduce the noise andfocus only on the important details.Bug: 277824547Test: atest InsecureEapNetworkHandlerTest: Connect to various Enterprise networksNegative test: Confirm verification fails for invalid chains(cherry picked from https://googleplex-android-review.googlesource.com/q/commit:b0ee00ddf38bb677876a6cffb876e6f511e2c139)Merged-In: I224c80e2787497634d3e68760122dac5f177585aChange-Id: I224c80e2787497634d3e68760122dac5f177585a
