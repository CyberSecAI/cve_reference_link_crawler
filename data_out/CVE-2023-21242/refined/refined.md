```
{
  "vulnerability_details": [
    {
      "cve_id": "CVE-2023-21242",
      "root_cause": "The vulnerability arises from improper validation of full certificate chains before displaying the TOFU (Trust On First Use) dialog when connecting to a network. This issue occurs specifically when a full certificate chain, including a Root CA, is provided by the server.",
      "weaknesses": [
        "Insufficient validation of certificate chains"
      ],
      "impact": "An attacker could potentially exploit this vulnerability to elevate privileges. If a malicious full chain is crafted to look correct but with a different SHA-256, and the user trusts it, the Root CA might be installed. This could lead to the possibility of further exploitation.",
      "attack_vectors": [
        "Man-in-the-middle (MitM) attack",
        "Malicious Wi-Fi network"
      ],
      "required_attacker_capabilities": [
         "Ability to create a full certificate chain that appears legitimate to the user but has a different SHA-256 hash.",
        "Ability to perform a MitM attack on a network."
      ],
      "additional_information": "The fix involves performing a full validation of the certificate chain before displaying the TOFU dialog. If validation fails, an error message will be displayed and the connection will be stopped without presenting the TOFU dialog. The vulnerability specifically affects the handling of full certificate chains; partial chains are handled through server certificate pinning. The commit message also mentions cleaning up debug logs."
    }
  ]
}
```