Based on the provided information, this content relates to CVE-2022-40757.

**Root cause of vulnerability:**
The root cause is the lack of proper size validation of the `chunkSize`, `messageLen`, and `srcLen` arguments in the `TEE_MACUpdate`, `TEE_MACComputeFinal`, and `TEE_CipherUpdate` functions respectively. These functions receive these size parameters from a trusted application (TA) and use them without checking against the actual size of the data buffers, leading to potential buffer overflows.

**Weaknesses/vulnerabilities present:**
- **Buffer Access with Incorrect Length Value:** The vulnerability is present due to the incorrect handling of size parameters passed to the mentioned functions. The functions use these size values directly in memory copy operations (`memcpy`, `utee_cipher_update`, `utee_hash_final`), which can lead to out-of-bounds memory access.
- **Lack of Input Validation:** The core issue is that the `TEE_MACUpdate`, `TEE_MACComputeFinal`, and `TEE_CipherUpdate` do not validate if the `chunkSize`, `messageLen`, and `srcLen` arguments correspond to the actual buffer sizes leading to potential buffer overflow.

**Impact of exploitation:**
- **Denial of Service (DoS):** By providing an excessive size value for the `chunkSize`, `messageLen`, or `srcLen` parameters, an attacker can trigger a crash in the trusted execution environment (TEE) kernel due to out-of-bounds memory access. This can lead to a denial of service.

**Attack vectors:**
- The vulnerability is triggered by invoking the functions `TEE_MACUpdate`, `TEE_MACComputeFinal`, and `TEE_CipherUpdate` with an excessive `chunkSize`, `messageLen`, or `srcLen` value.

**Required attacker capabilities/position:**
- The attacker needs to be able to invoke the vulnerable functions from a trusted application.
- The attacker needs control over the size parameters passed to these functions.

**Additional details:**
- The vulnerable code is located in `/tee/lib/libutee/tee_api_objects.c` and the related operations are in `/tee/lib/libutee/tee_api_operations.c`.
- The specific vulnerable lines are within the `TEE_MACUpdate`, `TEE_MACComputeFinal`, and `TEE_CipherUpdate` functions, using `utee_hash_update`, `utee_cipher_update`, and `utee_hash_final` which do not perform length checks.
- The issue was fixed by pull request [#90](https://github.com/Samsung/mTower/pull/90).