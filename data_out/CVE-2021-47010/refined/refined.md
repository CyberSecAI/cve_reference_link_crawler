The provided content relates to CVE-2021-47010.

**Root cause of vulnerability:**
The `tcp_set_default_congestion_control()` function, while intended to be netns-safe by writing to `&net->ipv4.tcp_congestion_control`, also modifies `ca->flags |= TCP_CONG_NON_RESTRICTED`, which is not namespaced. This allows a non-init net namespace to change the global `net.ipv4.tcp_allowed_congestion_control` sysctl, even though it's designed to be read-only for non-init namespaces.

**Weaknesses/vulnerabilities present:**
- Incorrect namespacing: The `TCP_CONG_NON_RESTRICTED` flag was not namespaced, leading to a global modification from a non-init network namespace.
- Violation of intended behavior: The read-only `net.ipv4.tcp_allowed_congestion_control` sysctl could be modified by a non-init namespace, contrary to design.

**Impact of exploitation:**
A non-init network namespace could modify the system-wide default TCP congestion control algorithm, potentially leading to:
- Unexpected behavior of TCP connections across all namespaces.
- Denial-of-service by setting a disruptive congestion control algorithm.
- Other unforeseen networking issues due to unexpected congestion control changes.

**Attack vectors:**
- A user with the ability to create non-init network namespaces.
- Access to the `tcp_set_default_congestion_control()` function from within a non-init namespace.
- Exploitation requires the ability to set a TCP congestion control algorithm.

**Required attacker capabilities/position:**
- The attacker must have the ability to create network namespaces.
- The attacker needs to be able to call the `tcp_set_default_congestion_control()` function.
- They must be in a non-init network namespace.