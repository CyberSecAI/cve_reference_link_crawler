

| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=a2fd6dbc98be1105a1d8e9e31575da8873ef115c)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=a2fd6dbc98be1105a1d8e9e31575da8873ef115c)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=a2fd6dbc98be1105a1d8e9e31575da8873ef115c)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=a2fd6dbc98be1105a1d8e9e31575da8873ef115c)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Carlos Llamas <cmllamas@google.com> | 2024-03-30 19:01:14 +0000 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-04-27 17:05:28 +0200 |
| commit | [a2fd6dbc98be1105a1d8e9e31575da8873ef115c](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=a2fd6dbc98be1105a1d8e9e31575da8873ef115c) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=a2fd6dbc98be1105a1d8e9e31575da8873ef115c)) | |
| tree | [4ce1038395617be21b7f190828f05331c22f7c23](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=a2fd6dbc98be1105a1d8e9e31575da8873ef115c) | |
| parent | [0dc727a4e05400205358a22c3d01ccad2c8e1fe4](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=0dc727a4e05400205358a22c3d01ccad2c8e1fe4) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=a2fd6dbc98be1105a1d8e9e31575da8873ef115c&id2=0dc727a4e05400205358a22c3d01ccad2c8e1fe4)) | |
| download | [linux-a2fd6dbc98be1105a1d8e9e31575da8873ef115c.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-a2fd6dbc98be1105a1d8e9e31575da8873ef115c.tar.gz) | |

binder: check offset alignment in binder\_get\_object()commit aaef73821a3b0194a01bd23ca77774f704a04d40 upstream.
Commit 6d98eb95b450 ("binder: avoid potential data leakage when copying
txn") introduced changes to how binder objects are copied. In doing so,
it unintentionally removed an offset alignment check done through calls
to binder\_alloc\_copy\_from\_buffer() -> check\_buffer().
These calls were replaced in binder\_get\_object() with copy\_from\_user(),
so now an explicit offset alignment check is needed here. This avoids
later complications when unwinding the objects gets harder.
It is worth noting this check existed prior to commit 7a67a39320df
("binder: add function to copy binder object from buffer"), likely
removed due to redundancy at the time.
Fixes: 6d98eb95b450 ("binder: avoid potential data leakage when copying txn")
Cc: stable@vger.kernel.org
Signed-off-by: Carlos Llamas <cmllamas@google.com>
Acked-by: Todd Kjos <tkjos@google.com>
Link: [https://lore.kernel.org/r/20240330190115.1877819-1-cmllamas@google.com](https://lore.kernel.org/r/20240330190115.1877819-1-cmllamas%40google.com)
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=a2fd6dbc98be1105a1d8e9e31575da8873ef115c)

| -rw-r--r-- | [drivers/android/binder.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/android/binder.c?id=a2fd6dbc98be1105a1d8e9e31575da8873ef115c) | 4 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 3 insertions, 1 deletions

| diff --git a/drivers/android/binder.c b/drivers/android/binder.cindex 7547c4ed265c6f..11d65e23f1b61d 100644--- a/[drivers/android/binder.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/android/binder.c?id=0dc727a4e05400205358a22c3d01ccad2c8e1fe4)+++ b/[drivers/android/binder.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/android/binder.c?id=a2fd6dbc98be1105a1d8e9e31575da8873ef115c)@@ -1678,8 +1678,10 @@ static size\_t binder\_get\_object(struct binder\_proc \*proc, size\_t object\_size = 0;  read\_size = min\_t(size\_t, sizeof(\*object), buffer->data\_size - offset);- if (offset > buffer->data\_size || read\_size < sizeof(\*hdr))+ if (offset > buffer->data\_size || read\_size < sizeof(\*hdr) ||+ !IS\_ALIGNED(offset, sizeof(u32))) return 0;+ if (u) { if (copy\_from\_user(object, u + offset, read\_size)) return 0; |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-10 21:05:51 +0000

