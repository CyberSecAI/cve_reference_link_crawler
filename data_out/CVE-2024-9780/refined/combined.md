=== Content from www.wireshark.org_c396d01b_20250111_043604.html ===

## wnpa-sec-2024-12 Â· ITS dissector crash

## Summary

**Name:** ITS dissector crash

**Docid:** wnpa-sec-2024-12

**Date:** October 9, 2024

**Affected versions:** 4.4.0

**Fixed versions:** 4.4.1

**References:**

[Wireshark issue 20026](https://gitlab.com/wireshark/wireshark/-/issues/20026).

[CVE-2024-9780](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-9780).

## Details

### Description

The ITS dissector could crash.

## Impact

Discovered
in our internal testing environment.
We are unaware of any exploits for this issue.
It may be possible to make Wireshark
crash

by injecting a malformed packet onto the wire or
by convincing
someone to read a malformed packet trace file.

## Resolution

Upgrade to Wireshark 4.4.1 or later.



=== Content from gitlab.com_bb7c1f7a_20250111_043603.html ===


[Skip to content](#content-body)
GitLab

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

# Fuzz job crash: fuzz-2024-08-29-7609.pcap

Problems have been found with the following capture file:

<https://www.wireshark.org/download/automated/captures/fuzz-2024-08-29-7609.pcap.gz>

stderr:

```
Branch: master
Input file: /var/menagerie/menagerie/ultimate_wireshark_protocols_pcap_220213.pcap
CI job name: ASan Menagerie Fuzz, ID: 7699781981
CI job URL: https://gitlab.com/wireshark/wireshark/-/jobs/7699781981
Return value: 0
Dissector bug: 0
Date and time: Thu Aug 29 09:17:02 PM UTC 2024

Commits in the last 48 hours:
474facd7045 GitLab CI: Build on SUSE 15.6
d580663ea8a radius: merge duplicated Acct-Status-Type
65a7fa65993 E2AP: Fix a typo in some KPM OIDs
58f6fef9c80 pcap: use nanosecond resolution for hardware lcap files.
06faabf9cc9 ITS: Restore dissection of CPM v1
16f9adc2744 802.11 Radio: Add a bounds check
65188457b99 pcap: fix a function return type.
f6bd33b22e6 GSMTAP: Add the header (up to type) when the dissector table is used
5b5e506b885 epan: Don't set a libgcrypt log handler >= 1.11.0
88f8e75de17 WSUG: tweak Preferences info in popup menus
85992a3dec6 WSUG: flesh out "Decode As" documentation
d0a939f0962 WSUG: clarify command line UAT docs
5067debc74d WSUG: tweak docs around Analyze and Follow
8181ec34636 lua: Fix some dissector segfaults
1e79a1166cd Fix some spelling errors
431121dd48e Docs: Split our Qt version variable

Build host information:
Linux 6.8.0-40-generic #40~22.04.3-Ubuntu SMP PREEMPT_DYNAMIC Tue Jul 30 17:30:19 UTC 2 x86_64
Distributor ID:	Ubuntu
Description:	Ubuntu 24.04 LTS
Release:	24.04
Codename:	noble

Command and args: /builds/wireshark/wireshark/_install/bin/tshark -2 --log-fatal-domains=UTF-8  -nVxr
Running as user "root" and group "root". This could be dangerous.
 ** (tshark:186220) 21:16:57.737036 [Epan WARNING] -- Dissector bug, protocol SNMP, in packet 3780: epan/asn1.c:229: failed assertion "lenE != 4"
 ** (tshark:186220) 21:16:59.907203 [Epan WARNING] -- Dissector bug, protocol TCP, in packet 11562: epan/dissectors/packet-tcp.c:7877: failed assertion "save_desegment_offset == pinfo->desegment_offset && save_desegment_len == pinfo->desegment_len"
AddressSanitizer:DEADLYSIGNAL
=================================================================
==186220==ERROR: AddressSanitizer: SEGV on unknown address 0x000000000000 (pc 0x7371142bb99c bp 0x7ffef714d250 sp 0x7ffef714d1d0 T0)
==186220==The signal is caused by a READ memory access.
==186220==Hint: address points to the zero page.
    #0 0x7371142bb99c in dissect_dsrc_NodeOffsetPointXY /builds/wireshark/wireshark/epan/dissectors/packet-its.c:11383:75
    #1 0x73711309d1e7 in dissect_per_sequence /builds/wireshark/wireshark/epan/dissectors/packet-per.c:2009:12
    #2 0x7371142cacc8 in dissect_cpmv1_OffsetPoint /builds/wireshark/wireshark/epan/dissectors/packet-its.c:21234:12
    #3 0x73711308fb72 in dissect_per_sequence_of_helper /builds/wireshark/wireshark/epan/dissectors/packet-per.c:589:10
    #4 0x7371130956e0 in dissect_per_constrained_sequence_of /builds/wireshark/wireshark/epan/dissectors/packet-per.c:1026:9
    #5 0x7371142cae20 in dissect_cpmv1_PolyPointList /builds/wireshark/wireshark/epan/dissectors/packet-its.c:21282:12
    #6 0x73711309d1e7 in dissect_per_sequence /builds/wireshark/wireshark/epan/dissectors/packet-per.c:2009:12
    #7 0x7371142ca8d8 in dissect_cpmv1_AreaPolygon /builds/wireshark/wireshark/epan/dissectors/packet-its.c:21297:12
    #8 0x73711309c208 in dissect_per_choice /builds/wireshark/wireshark/epan/dissectors/packet-per.c:1852:13
    #9 0x7371142ca754 in dissect_cpmv1_DetectionArea /builds/wireshark/wireshark/epan/dissectors/packet-its.c:21409:12
    #10 0x73711309d1e7 in dissect_per_sequence /builds/wireshark/wireshark/epan/dissectors/packet-per.c:2009:12
    #11 0x7371142ca628 in dissect_cpmv1_SensorInformationv1 /builds/wireshark/wireshark/epan/dissectors/packet-its.c:21437:12
    #12 0x73711308fb72 in dissect_per_sequence_of_helper /builds/wireshark/wireshark/epan/dissectors/packet-per.c:589:10
    #13 0x7371130956e0 in dissect_per_constrained_sequence_of /builds/wireshark/wireshark/epan/dissectors/packet-per.c:1026:9
    #14 0x7371142c9e50 in dissect_cpmv1_SensorInformationContainerv1 /builds/wireshark/wireshark/epan/dissectors/packet-its.c:21450:12
    #15 0x73711309d1e7 in dissect_per_sequence /builds/wireshark/wireshark/epan/dissectors/packet-per.c:2009:12
    #16 0x7371142c9d08 in dissect_cpmv1_CpmParameters /builds/wireshark/wireshark/epan/dissectors/packet-its.c:22045:12
    #17 0x73711309d1e7 in dissect_per_sequence /builds/wireshark/wireshark/epan/dissectors/packet-per.c:2009:12
    #18 0x7371142c9c44 in dissect_cpmv1_CollectivePerceptionMessagev1 /builds/wireshark/wireshark/epan/dissectors/packet-its.c:22060:12
    #19 0x7371142ab377 in dissect_cpmv1_CollectivePerceptionMessagev1_PDU /builds/wireshark/wireshark/epan/dissectors/packet-its.c:22072:12
    #20 0x737114ec5aec in call_dissector_through_handle /builds/wireshark/wireshark/epan/packet.c:865:9
    #21 0x737114eb9774 in call_dissector_work /builds/wireshark/wireshark/epan/packet.c:953:9
    #22 0x737114eb90d0 in dissector_try_uint_new /builds/wireshark/wireshark/epan/packet.c:1626:8
    #23 0x737114eb9b36 in dissector_try_uint /builds/wireshark/wireshark/epan/packet.c:1650:9
    #24 0x7371142aefcf in dissect_its_ItsPduHeader /builds/wireshark/wireshark/epan/dissectors/packet-its.c:7727:21
    #25 0x7371142aebf7 in dissect_its_ItsPduHeader_PDU /builds/wireshark/wireshark/epan/dissectors/packet-its.c:8608:12
    #26 0x7371142a86eb in dissect_its_PDU /builds/wireshark/wireshark/epan/dissectors/packet-its.c:23080:10
    #27 0x737114ec5aec in call_dissector_through_handle /builds/wireshark/wireshark/epan/packet.c:865:9
    #28 0x737114eb9774 in call_dissector_work /builds/wireshark/wireshark/epan/packet.c:953:9
    #29 0x737114eb90d0 in dissector_try_uint_new /builds/wireshark/wireshark/epan/packet.c:1626:8
    #30 0x73711265669a in dissect_btpa /builds/wireshark/wireshark/epan/dissectors/packet-geonw.c:371:9
    #31 0x737114ec5aec in call_dissector_through_handle /builds/wireshark/wireshark/epan/packet.c:865:9
    #32 0x737114eb9774 in call_dissector_work /builds/wireshark/wireshark/epan/packet.c:953:9
    #33 0x737114ec2004 in call_dissector_only /builds/wireshark/wireshark/epan/packet.c:3684:8
    #34 0x737114eb5708 in call_dissector_with_data /builds/wireshark/wireshark/epan/packet.c:3697:8
    #35 0x737114ec2055 in call_dissector /builds/wireshark/wireshark/epan/packet.c:3714:9
    #36 0x73711265bdc5 in dissect_geonw_internal /builds/wireshark/wireshark/epan/dissectors/packet-geonw.c:2746:21
    #37 0x737112657b23 in dissect_geonw /builds/wireshark/wireshark/epan/dissectors/packet-geonw.c:2983:12
    #38 0x737114ec5aec in call_dissector_through_handle /builds/wireshark/wireshark/epan/packet.c:865:9
    #39 0x737114eb9774 in call_dissector_work /builds/wireshark/wireshark/epan/packet.c:953:9
    #40 0x737114eb90d0 in dissector_try_uint_new /builds/wireshark/wireshark/epan/packet.c:1626:8
    #41 0x737114eb9b36 in dissector_try_uint /builds/wireshark/wireshark/epan/packet.c:1650:9
    #42 0x73711258303c in dissect_ethertype /builds/wireshark/wireshark/epan/dissectors/packet-ethertype.c:298:21
    #43 0x737114ec5aec in call_dissector_through_handle /builds/wireshark/wireshark/epan/packet.c:865:9
    #44 0x737114eb9774 in call_dissector_work /builds/wireshark/wireshark/epan/packet.c:953:9
    #45 0x737114ec2004 in call_dissector_only /builds/wireshark/wireshark/epan/packet.c:3684:8
    #46 0x737114eb5708 in call_dissector_with_data /builds/wireshark/wireshark/epan/packet.c:3697:8
    #47 0x737112580ddc in dissect_eth_common /builds/wireshark/wireshark/epan/dissectors/packet-eth.c:648:5
    #48 0x73711257e0f2 in dissect_eth_maybefcs /builds/wireshark/wireshark/epan/dissectors/packet-eth.c:1040:3
    #49 0x737114ec5aec in call_dissector_through_handle /builds/wireshark/wireshark/epan/packet.c:865:9
    #50 0x737114eb9774 in call_dissector_work /builds/wireshark/wireshark/epan/packet.c:953:9
    #51 0x737114eb90d0 in dissector_try_uint_new /builds/wireshark/wireshark/epan/packet.c:1626:8
    #52 0x73711299f0d9 in ip_try_dissect /builds/wireshark/wireshark/epan/dissectors/packet-ip.c:1862:7
    #53 0x7371129a4a61 in dissect_ip_v4 /builds/wireshark/wireshark/epan/dissectors/packet-ip.c:2437:10
    #54 0x737114ec5aec in call_dissector_through_handle /builds/wireshark/wireshark/epan/packet.c:865:9
    #55 0x737114eb9774 in call_dissector_work /builds/wireshark/wireshark/epan/packet.c:953:9
    #56 0x737114eb90d0 in dissector_try_uint_new /builds/wireshark/wireshark/epan/packet.c:1626:8
    #57 0x737114eb9b36 in dissector_try_uint /builds/wireshark/wireshark/epan/packet.c:1650:9
    #58 0x73711258303c in dissect_ethertype /builds/wireshark/wireshark/epan/dissectors/packet-ethertype.c:298:21
    #59 0x737114ec5aec in call_dissector_through_handle /builds/wireshark/wireshark/epan/packet.c:865:9
    #60 0x737114eb9774 in call_dissector_work /builds/wireshark/wireshark/epan/packet.c:953:9
    #61 0x737114ec2004 in call_dissector_only /builds/wireshark/wireshark/epan/packet.c:3684:8
    #62 0x737114eb5708 in call_dissector_with_data /builds/wireshark/wireshark/epan/packet.c:3697:8
    #63 0x737112580ddc in dissect_eth_common /builds/wireshark/wireshark/epan/dissectors/packet-eth.c:648:5
    #64 0x73711257f123 in dissect_eth /builds/wireshark/wireshark/epan/dissectors/packet-eth.c:1014:5
    #65 0x737114ec5aec in call_dissector_through_handle /builds/wireshark/wireshark/epan/packet.c:865:9
    #66 0x737114eb9774 in call_dissector_work /builds/wireshark/wireshark/epan/packet.c:953:9
    #67 0x737114ec2004 in call_dissector_only /builds/wireshark/wireshark/epan/packet.c:3684:8
    #68 0x73711261ec52 in dissect_frame /builds/wireshark/wireshark/epan/dissectors/packet-frame.c:1291:6
    #69 0x737114ec5aec in call_dissector_through_handle /builds/wireshark/wireshark/epan/packet.c:865:9
    #70 0x737114eb9774 in call_dissector_work /builds/wireshark/wireshark/epan/packet.c:953:9
    #71 0x737114ec2004 in call_dissector_only /builds/wireshark/wireshark/epan/packet.c:3684:8
    #72 0x737114eb5708 in call_dissector_with_data /builds/wireshark/wireshark/epan/packet.c:3697:8
    #73 0x737114eb513b in dissect_record /builds/wireshark/wireshark/epan/packet.c:664:3
    #74 0x737114e7fc0c in epan_dissect_run /builds/wireshark/wireshark/epan/epan.c:649:2
    #75 0x578a7a418ef9 in process_packet_first_pass /builds/wireshark/wireshark/tshark.c:3440:9
    #76 0x578a7a416b7b in process_cap_file_first_pass /builds/wireshark/wireshark/tshark.c:3593:13
    #77 0x578a7a411def in process_cap_file /builds/wireshark/wireshark/tshark.c:4129:29
    #78 0x578a7a40bae7 in main /builds/wireshark/wireshark/tshark.c:2577:22
    #79 0x7371088cf1c9  (/lib/x86_64-linux-gnu/libc.so.6+0x2a1c9) (BuildId: 6d64b17fbac799e68da7ebd9985ddf9b5cb375e6)
    #80 0x7371088cf28a in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x2a28a) (BuildId: 6d64b17fbac799e68da7ebd9985ddf9b5cb375e6)
    #81 0x578a7a318b04 in _start (/builds/wireshark/wireshark/_install/bin/tshark+0x5cb04) (BuildId: 5f7ced89317e0f3f0337c42bdab4ebf91a83ac06)

AddressSanitizer can not provide additional info.
SUMMARY: AddressSanitizer: SEGV /builds/wireshark/wireshark/epan/dissectors/packet-its.c:11383:75 in dissect_dsrc_NodeOffsetPointXY
==186220==ABORTING

fuzz-test.sh stderr:
Running as user "root" and group "root". This could be dangerous.
capinfos: Unknown packet encapsulation 0 in frame 1 of file "/var/menagerie/menagerie/16761-suite_capture.case_dumpcap_pcapng_sections.test_dumpcap_pcapng_multi_in_multi_out.sections_rb_d31ea6_00002_20181126125927.pcapng"
capinfos: Unknown packet encapsulation 0 in frame 2 of file "/var/menagerie/menagerie/16761-suite_capture.case_dumpcap_pcapng_sections.test_dumpcap_pcapng_multi_in_multi_out.sections_rb_d31ea6_00002_20181126125927.pcapng"
capinfos: Unknown packet encapsulation 0 in frame 3 of file "/var/menagerie/menagerie/16761-suite_capture.case_dumpcap_pcapng_sections.test_dumpcap_pcapng_multi_in_multi_out.sections_rb_d31ea6_00002_20181126125927.pcapng"
capinfos: Unknown packet encapsulation 0 in frame 4 of file "/var/menagerie/menagerie/16761-suite_capture.case_dumpcap_pcapng_sections.test_dumpcap_pcapng_multi_in_multi_out.sections_rb_d31ea6_00002_20181126125927.pcapng"
capinfos: Unknown packet encapsulation 0 in frame 5 of file "/var/menagerie/menagerie/16761-suite_capture.case_dumpcap_pcapng_sections.test_dumpcap_pcapng_multi_in_multi_out.sections_rb_d31ea6_00002_20181126125927.pcapng"
capinfos: Unknown packet encapsulation 0 in frame 6 of file "/var/menagerie/menagerie/16761-suite_capture.case_dumpcap_pcapng_sections.test_dumpcap_pcapng_multi_in_multi_out.sections_rb_d31ea6_00002_20181126125927.pcapng"
capinfos: Unknown packet encapsulation 0 in frame 7 of file "/var/menagerie/menagerie/16761-suite_capture.case_dumpcap_pcapng_sections.test_dumpcap_pcapng_multi_in_multi_out.sections_rb_d31ea6_00002_20181126125927.pcapng"
capinfos: Unknown packet encapsulation 0 in frame 8 of file "/var/menagerie/menagerie/16761-suite_capture.case_dumpcap_pcapng_sections.test_dumpcap_pcapng_multi_in_multi_out.sections_rb_d31ea6_00002_20181126125927.pcapng"
capinfos: Unknown packet encapsulation 0 in frame 9 of file "/var/menagerie/menagerie/16761-suite_capture.case_dumpcap_pcapng_sections.test_dumpcap_pcapng_multi_in_multi_out.sections_rb_d31ea6_00002_20181126125927.pcapng"
capinfos: Unknown packet encapsulation 0 in frame 10 of file "/var/menagerie/menagerie/16761-suite_capture.case_dumpcap_pcapng_sections.test_dumpcap_pcapng_multi_in_multi_out.sections_rb_d31ea6_00002_20181126125927.pcapng"
capinfos: Unknown packet encapsulation 0 in frame 11 of file "/var/menagerie/menagerie/16761-suite_capture.case_dumpcap_pcapng_sections.test_dumpcap_pcapng_multi_in_multi_out.sections_rb_d31ea6_00002_20181126125927.pcapng"
capinfos: Unknown packet encapsulation 0 in frame 12 of file "/var/menagerie/menagerie/16761-suite_capture.case_dumpcap_pcapng_sections.test_dumpcap_pcapng_multi_in_multi_out.sections_rb_d31ea6_00002_20181126125927.pcapng"
capinfos: Unknown packet encapsulation 0 in frame 13 of file "/var/menagerie/menagerie/16761-suite_capture.case_dumpcap_pcapng_sections.test_dumpcap_pcapng_multi_in_multi_out.sections_rb_d31ea6_00002_20181126125927.pcapng"
capinfos: Unknown packet encapsulation 0 in frame 14 of file "/var/menagerie/menagerie/16761-suite_capture.case_dumpcap_pcapng_sections.test_dumpcap_pcapng_multi_in_multi_out.sections_rb_d31ea6_00002_20181126125927.pcapng"
capinfos: Unknown packet encapsulation 0 in frame 15 of file "/var/menagerie/menagerie/16761-suite_capture.case_dumpcap_pcapng_sections.test_dumpcap_pcapng_multi_in_multi_out.sections_rb_d31ea6_00002_20181126125927.pcapng"
capinfos: Unknown packet encapsulation 0 in frame 16 of file "/var/menagerie/menagerie/16761-suite_capture.case_dumpcap_pcapng_sections.test_dumpcap_pcapng_multi_in_multi_out.sections_rb_d31ea6_00002_20181126125927.pcapng"
capinfos: Unknown packet encapsulation 0 in frame 17 of file "/var/menagerie/menagerie/16761-suite_capture.case_dumpcap_pcapng_sections.test_dumpcap_pcapng_multi_in_multi_out.sections_rb_d31ea6_00002_20181126125927.pcapng"
capinfos: Unknown packet encapsulation 0 in frame 18 of file "/var/menagerie/menagerie/16761-suite_capture.case_dumpcap_pcapng_sections.test_dumpcap_pcapng_multi_in_multi_out.sections_rb_d31ea6_00002_20181126125927.pcapng"
capinfos: Unknown packet encapsulation 0 in frame 19 of file "/var/menagerie/menagerie/16761-suite_capture.case_dumpcap_pcapng_sections.test_dumpcap_pcapng_multi_in_multi_out.sections_rb_d31ea6_00002_20181126125927.pcapng"
capinfos: Unknown packet encapsulation 0 in frame 20 of file "/var/menagerie/menagerie/16761-suite_capture.case_dumpcap_pcapng_sections.test_dumpcap_pcapng_multi_in_multi_out.sections_rb_d31ea6_00002_20181126125927.pcapng"
```

*no debug trace*

To upload designs, you'll need to enable LFS and have an admin enable hashed storage. [More information](/help/user/project/issues/design_management.md#prerequisites)

Assignee
Loading

Time tracking
Loading

Confidentiality

Confidentiality controls have moved to the issue actions menu () at the top of the page.


