=== Content from discuss.hashicorp.com_d27c3424_20250111_042635.html ===


[HashiCorp Discuss](/)

# [HCSEC-2024-15 - Nomad Vulnerable to Allocation Directory Path Escape Through Archive Unpacking](/t/hcsec-2024-15-nomad-vulnerable-to-allocation-directory-path-escape-through-archive-unpacking/68781)

[Security](/c/security/52)

[security-nomad](https://discuss.hashicorp.com/tag/security-nomad)

[dduzgun-security](https://discuss.hashicorp.com/u/dduzgun-security)

July 22, 2024, 10:54pm

1

**Bulletin ID:** HCSEC-2024-15

**Affected Products / Versions:** Nomad and Nomad Enterprise 1.6.12 up to 1.7.9, and 1.8.1; fixed in Nomad Enterprise 1.6.13, 1.7.10, 1.8.2.

**Publication Date:** July 22, 2024

**Summary**

HashiCorp Nomad and Nomad Enterprise 1.6.12 up to 1.7.9, and 1.8.1 archive unpacking during migration is vulnerable to path escaping of the allocation directory. This vulnerability, CVE-2024-6717, is fixed in Nomad 1.6.13, 1.7.10, and 1.8.2.

**Background**

Nomad creates a [working directory](https://developer.hashicorp.com/nomad/docs/concepts/filesystem) for each [allocation](https://developer.hashicorp.com/nomad/docs/glossary#allocation) on a client. The allocation working directory is where Nomad creates task directories and directories shared between tasks, writes logs for tasks, and downloads artifacts or templates. The [artifact](https://developer.hashicorp.com/nomad/docs/job-specification/artifact) block instructs Nomad to fetch and unpack a remote resource. If these artifacts are archived (zip, tgz, bz2, xz), they are automatically unarchived before starting the task.

**Details**

Internal testing by the Product Security and Nomad R&D team identified that stream allocation directories did not properly restrict paths during unpacking, allowing malicious actors to craft an archive that would unpack to paths outside of the intended allocation directory.

**Remediation**

Customers should evaluate the risk associated with this issue and consider upgrading to Nomad 1.6.13, 1.7.10, 1.8.2 or newer.

Please refer to [Upgrading Nomad](https://developer.hashicorp.com/nomad/docs/upgrade) for general guidance and the [Upgrade Guides](https://developer.hashicorp.com/nomad/docs/upgrade/upgrade-specific) for version-specific upgrade notes.

**Acknowledgement**

This issue was identified by HashiCorpâ€™s Product Security and Nomad R&D teams.

*We deeply appreciate any effort to coordinate disclosure of security vulnerabilities. For information about security at HashiCorp and the reporting of security vulnerabilities, please see <https://hashicorp.com/security>.*

### Related topics

| Topic |  | Replies | Views | Activity |
| --- | --- | --- | --- | --- |
| [HCSEC-2024-17 - Nomad Vulnerable to Allocation Directory Escape On Non-Existing File Paths Through Archive Unpacking](https://discuss.hashicorp.com/t/hcsec-2024-17-nomad-vulnerable-to-allocation-directory-escape-on-non-existing-file-paths-through-archive-unpacking/69293)  [Security](/c/security/52) [security-nomad](https://discuss.hashicorp.com/tag/security-nomad) | 0 | 1063 | August 14, 2024 |
| [HCSEC-2022-02 - Nomad alloc Filesystem and Container Escape](https://discuss.hashicorp.com/t/hcsec-2022-02-nomad-alloc-filesystem-and-container-escape/35560)  [Security](/c/security/52) [security-nomad](https://discuss.hashicorp.com/tag/security-nomad) | 0 | 7190 | February 11, 2022 |
| [HCSEC-2024-03 - Nomad Vulnerable to Arbitrary Write Through Symlink Attack](https://discuss.hashicorp.com/t/hcsec-2024-03-nomad-vulnerable-to-arbitrary-write-through-symlink-attack/62602)  [Security](/c/security/52) [security-nomad](https://discuss.hashicorp.com/tag/security-nomad) | 0 | 6350 | February 8, 2024 |
| [HCSEC-2020-21 - Nomad File Sandbox Escape via Template and Artifact Stanzas](https://discuss.hashicorp.com/t/hcsec-2020-21-nomad-file-sandbox-escape-via-template-and-artifact-stanzas/18106)  [Security](/c/security/52) [security-nomad](https://discuss.hashicorp.com/tag/security-nomad) | 0 | 4244 | November 25, 2020 |
| [HCSEC-2023-05 - Nomad Client Vulnerable to Decompression Bombs in Artifact Block](https://discuss.hashicorp.com/t/hcsec-2023-05-nomad-client-vulnerable-to-decompression-bombs-in-artifact-block/50292)  [Security](/c/security/52) | 0 | 5178 | February 16, 2023 |

* [Home](/)
* [Categories](/categories)
* [Guidelines](/guidelines)
* [Terms of Service](/tos)
* [Privacy Policy](https://meta.discourse.org/privacy)

Powered by [Discourse](https://www.discourse.org), best viewed with JavaScript enabled


