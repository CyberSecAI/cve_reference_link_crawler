=== Content from www.varnish-cache.org_c814a8be_20250111_030816.html ===

# VSV00012 Base64 decoding vulnerability in vmod-digest[¶](#vsv00012-base64-decoding-vulnerability-in-vmod-digest "Permalink to this heading")

[CVE-2023-41104](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-41104)

Date: 2023-08-17

A base64 decoding vulnerability has been discovered in vmod-digest.

The potential outcome of the vulnerability can be both authentication
bypass and information disclosure, however the exact attack surface
will depend on the particular VCL configuration in use.

Common usage of vmod-digest is for basic HTTP authentication, in which
case it may be possible for an attacker to circumvent the
authentication check. If the decoded result string is somehow being
made visible to the attacker (for example the result of the decoding
is added to a response header), then there is the potential for
information disclosure from reading out of band workspace data.

Mitigation is possible from VCL by using vmod-blob instead of
vmod-digest for base64 decoding, or by updating to a fixed version of
vmod-digest.

Vmod-digest is a 3rd party VMOD, maintained and distributed
by Varnish Software, but since it was one of the first VMODs
and has seen very wide deployment, we consider this vulnerability
important enough to issue a VSV, even though no code maintained
by the Varnish Cache Project is involved.

Varnish Software’s description of this vulnerability can be
found at: <https://docs.varnish-software.com/security/VSV00012/>

## Versions affected[¶](#versions-affected "Permalink to this heading")

* libvmod-digest built on source code prior to 2023-08-17.

## Versions not affected[¶](#versions-not-affected "Permalink to this heading")

* libvmod-digest version 1.0.3 (released 2023-08-17)

Users of the Varnish Enterprise product from Varnish Software: See the
email you received from V-S.

## Mitigation from VCL[¶](#mitigation-from-vcl "Permalink to this heading")

If upgrading vmod-digest is not possible, it is possible to mitigate the
problem using a VCL based workaround.

Vmod-blob implements base64 decoding, and this functionality is not
affected by the issues in vmod-digest. The proposed workaround is to
change VCL configurations which use vmod-digest for base64 decoding
into using vmod-blob instead.

There are 3 affected functions in vmod-digest, each for decoding a
different variant of base64. The functions are digest.base64\_decode,
digest.base64url\_decode and digest.base64url\_nopad\_decode. Each
invocation of these functions in the VCL needs to be changed into
using the corresponding vmod-blob construct.

Please see the following examples for how to rewrite the VCL
configuration, where each commented out usage of vmod-digest is
followed by the similar construct using vmod-blob:

```
import blob;
sub vcl_recv {
    # set req.http.decoded = digest.base64_decode(req.http.encoded);
    set req.http.decoded = blob.transcode(BASE64, IDENTITY, encoded=req.http.encoded);

    # set req.http.decoded = digest.base64url_decode(req.http.encoded);
    set req.http.decoded = blob.transcode(BASE64URL, IDENTITY, encoded=req.http.encoded);

    # set req.http.decoded = digest.base64url_nopad_decode(req.http.encoded);
    set req.http.decoded = blob.transcode(BASE64URLNOPAD, IDENTITY, encoded=req.http.encoded);
}

```

[![Logo](../_static/varnish-bunny.png)](../index.html)

### Index

---

* [Download](../releases/index.html)
* [VMODS](../vmods/index.html) &
  [Extras](../extras/index.html)
* [Get help](../support/index.html)
* [Mailing Lists](/lists/mailman/listinfo)
* [Security](index.html)
* [Documentation](../docs/index.html)
* [trunk](../docs/trunk/index.html)
  | [7.6 (current)](../docs/7.6/index.html)
  | [7.5 (previous)](../docs/7.5/index.html)
  | [6.0 (supported)](../docs/6.0/index.html)
  | [other versions](../docs/index.html)
* [Varnish Book (PDF)](https://info.varnish-software.com/resources/varnish-6-by-example-book)
* [4.0](http://book.varnish-software.com/4.0/)
  | [3.0](http://book.varnish-software.com/3.0/)
* [Github project](https://github.com/varnishcache/varnish-cache)
* [Tips and tricks](../tips/index.html)
* [Tutorials](../tutorials/index.html)
* [Varnish Business](../business/index.html)
* [Project organization](../organization/index.html)
* [VTEST](/vtest)
  | [GCOV](/gcov)

### Our VM is sponsored by:

[![](../_static/NetActuate.png)](https://www.netactuate.net)
### …and:

[![](../_static/FreeBSD.gif)](https://www.freebsd.org)

©2016-2024, The Varnish Cache Contributors.
|
Powered by [Sphinx 5.3.0](https://www.sphinx-doc.org/)
& [Alabaster 0.7.16](https://alabaster.readthedocs.io)



=== Content from github.com_b4c283a0_20250111_030816.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fvarnish%2Flibvmod-digest%2Freleases%2Ftag%2Flibvmod-digest-1.0.3)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fvarnish%2Flibvmod-digest%2Freleases%2Ftag%2Flibvmod-digest-1.0.3)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Freleases%2Fshow&source=header-repo&source_repo=varnish%2Flibvmod-digest)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[varnish](/varnish)
/
**[libvmod-digest](/varnish/libvmod-digest)**
Public

* [Notifications](/login?return_to=%2Fvarnish%2Flibvmod-digest) You must be signed in to change notification settings
* [Fork
  27](/login?return_to=%2Fvarnish%2Flibvmod-digest)
* [Star
   48](/login?return_to=%2Fvarnish%2Flibvmod-digest)

* [Code](/varnish/libvmod-digest/tree/libvmod-digest-1.0.3)
* [Issues
  2](/varnish/libvmod-digest/issues)
* [Pull requests
  0](/varnish/libvmod-digest/pulls)
* [Actions](/varnish/libvmod-digest/actions)
* [Projects
  0](/varnish/libvmod-digest/projects)
* [Security](/varnish/libvmod-digest/security)
* [Insights](/varnish/libvmod-digest/pulse)

Additional navigation options

* [Code](/varnish/libvmod-digest/tree/libvmod-digest-1.0.3)
* [Issues](/varnish/libvmod-digest/issues)
* [Pull requests](/varnish/libvmod-digest/pulls)
* [Actions](/varnish/libvmod-digest/actions)
* [Projects](/varnish/libvmod-digest/projects)
* [Security](/varnish/libvmod-digest/security)
* [Insights](/varnish/libvmod-digest/pulse)

1. [Releases](/varnish/libvmod-digest/releases)
2. [libvmod-digest-1.0.3](/varnish/libvmod-digest/releases/tag/libvmod-digest-1.0.3)

# 1.0.3

[Latest](/varnish/libvmod-digest/releases/latest)

[Latest](/varnish/libvmod-digest/releases/latest)

 Compare

Choose a tag to compare

Could not load tags

Nothing to show

[{{ refName }}
default](/varnish/libvmod-digest/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...libvmod-digest-1.0.3)

 Loading

[View all tags](/varnish/libvmod-digest/tags)

![@daghf](https://avatars.githubusercontent.com/u/1662211?s=40&v=4)
[daghf](/daghf)
released this
17 Aug 07:59

[libvmod-digest-1.0.3](/varnish/libvmod-digest/tree/libvmod-digest-1.0.3)

[`e745761`](/varnish/libvmod-digest/commit/e745761469b55e83e1fca21dd0cb8eca8022935d)

This is a security release.

See <https://varnish-cache.org/security/VSV00012.html> and <https://docs.varnish-software.com/security/VSV00012/> for more information.

 Assets
3

 Loading

All reactions

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from docs.varnish-software.com_243b3cb7_20250111_030815.html ===

[![Varnish Software logo](/images/varnish_software_logo.png)](/ "Varnish Software documentation")[Search](/search)

---

# Base64 decoding vulnerability in vmod-digest [Security](/security)

* [Impact](#impact)
* [Versions affected](#versions-affected)
  + [Affected software versions](#affected-software-versions)
  + [Resolved in](#resolved-in)
* [Solution](#solution)
  + [Upgrading on RedHat and derivatives](#upgrading-on-redhat-and-derivatives)
  + [Upgrading on Ubuntu and Debian](#upgrading-on-ubuntu-and-debian)
* [Workaround](#workaround)
* [Timeline](#timeline)
* [References](#references)
Published August 17, 2023.

A base64 decoding vulnerability has been discovered in vmod-digest.

This problem was discovered by an external party and not reported responsibly to Varnish Software or the Varnish Cache project. Since we don’t know exactly how widespread the knowledge about this vulnerability is, we have acted as though it is public knowledge or at least easily available. This warranted a fast-tracked process between discovery and disclosure.

# Impact

The potential outcome of the vulnerability can be both authentication bypass and information disclosure, however the exact attack surface will depend on the particular VCL configuration in use.

Common usage of vmod-digest is for basic HTTP authentication, in which case it may be possible for an attacker to circumvent the authentication check. If the decoded result string is somehow being made visible to the attacker (for example the result of the decoding is added to a response header), then there is the potential for information disclosure from reading out-of-band workspace data.

# Versions affected

## Affected software versions

* vmod-digest shipped with Varnish Enterprise 6.0 series up to and including 6.0.11r4.
* vmod-digest for Varnish Cache 6.0 LTS built on upstream source code prior to 2023-08-17.
* vmod-digest for Varnish Cache trunk built on upstream source code prior to 2023-08-17.

Note that the vulnerability is only exploitable if vmod-digest is loaded and one of the base64 decoding functions it provides is used.

## Resolved in

* vmod-digest shipped with Varnish Enterprise 6.0.11r5 (released 2023-08-14).
* vmod-digest for Varnish Cache 6.0 LTS built on upstream source code from 2023-08-17 and later.
* vmod-digest for Varnish Cache trunk built on upstream source code from 2023-08-17 and later.

# Solution

The recommended solution is to upgrade vmod-digest to one of the versions
where this issue has been resolved and then ensure that Varnish is
restarted. For Varnish Enterprise, this is done as follows:

## Upgrading on RedHat and derivatives

You should already have configured the Varnish Enterprise repository, so a
normal upgrade will be enough:

```
$ sudo yum update varnish-plus
$ sudo systemctl restart varnish

```
## Upgrading on Ubuntu and Debian

You should already have configured the Varnish Enterprise repository, so a
normal upgrade should be enough:

```
$ sudo apt-get update
$ sudo apt-get install --only-upgrade varnish-plus
$ sudo systemctl restart varnish

```
# Workaround

If upgrading Varnish is not possible, it is possible to mitigate the vulnerability using a VCL-based workaround.

Vmod-blob implements base64 decoding and this functionality is not affected by the issue in vmod-digest. The proposed workaround is to change VCL configurations which use vmod-digest for base64 decoding into using vmod-blob instead.

There are 3 affected functions in vmod-digest, each for decoding a different variant of base64. The functions are `digest.base64_decode`, `digest.base64url_decode` and `digest.base64url_nopad_decode`. Each invocation of these functions in the VCL needs to be changed into using the corresponding vmod-blob construct.

Please see the following examples for how to rewrite the VCL configuration, where each commented out usage of vmod-digest is followed by the similar construct using vmod-blob:

```
import blob;
sub vcl_recv {
	# set req.http.decoded = digest.base64_decode(req.http.encoded);
	set req.http.decoded = blob.transcode(BASE64, IDENTITY, encoded=req.http.encoded);

	# set req.http.decoded = digest.base64url_decode(req.http.encoded);
	set req.http.decoded = blob.transcode(BASE64URL, IDENTITY, encoded=req.http.encoded);

	# set req.http.decoded = digest.base64url_nopad_decode(req.http.encoded);
	set req.http.decoded = blob.transcode(BASE64URLNOPAD, IDENTITY, encoded=req.http.encoded);
}

```
# Timeline

**2023-08-09**

* A customer let us know that they received detailed information about a “Varnish base64 vulnerability” from an external party. This information was attached to an NDA, which unfortunately made it impossible for our customer to share any details with Varnish Software or the Varnish Cache project. Based on this limited information, we started a search for a potential vulnerability.

**2023-08-10**

* A vulnerability is identified in vmod-digest.

**2023-08-11**

* Preliminary patch set to address the issue is developed.

**2023-08-14**

* Varnish Software released Varnish Enterprise version 6.0.11r5 to address the issue.

**2023-08-15**

* Varnish Software prepared patches for the various open source upstream git branches for vmod-digest.

**2023-08-16**

* We managed to establish contact with the external party that shared the information initially. We will use this opportunity to ensure that the handling of similar issues in the future are conducted according to best practices.

**2023-08-17**

* Public disclosure released and patches pushed to the vmod-digest FOSS repository.

# References

* [Varnish Cache VSV00012 announcement](https://www.varnish-cache.org/security/VSV00012.html)
* [CVE-2023-41104](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-41104)

---

**Manuals**

[Varnish Enterprise](/varnish-enterprise/)

[Varnish Cloud](/varnish-cloud/)

[Varnish Controller](/varnish-controller/)

[Varnish High Availability](/varnish-high-availability/)

[Varnish Custom Statistics](/varnish-custom-statistics/)

[Varnish WAF](/varnish-waf/)

[Varnish Broadcaster](/varnish-broadcaster/)

[Varnish Helm Chart](/varnish-helm/)

[Packages](/packages)

[Docker](/docker)

**News**

[Varnish Controller 6.6.3](/releases/varnish-controller-6.6.3/)

[Varnish Enterprise 6.0.13r10](/releases/varnish-enterprise-6.0.13r10/)

[Varnish Controller 6.6.2](/releases/varnish-controller-6.6.2/)

[Varnish Controller 6.6.1](/releases/varnish-controller-6.6.1/)

[Varnish Enterprise 6.0.13r9](/releases/varnish-enterprise-6.0.13r9/)

*[News archive](/news)*

Cookie Settings
[Privacy Policy](https://www.varnish-software.com/privacy-policy/)
[Contact Us](https://www.varnish-software.com/contact-us/)
[Press](https://www.varnish-software.com/press/)
[Branding](https://www.varnish-software.com/branding/)

®Varnish Software, Wallingatan 12, 111 60 Stockholm, Organization nr. 556805-6203


