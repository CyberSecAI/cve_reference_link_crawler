- **Root cause of vulnerability**:
    - The `php_random_bytes_throw` function used for generating a client nonce in SOAP HTTP Digest authentication was not checked for failure. If the function failed, the nonce would remain uninitialized, resulting in a stack information leak.
    - The size of the generated nonce was insufficient, making it vulnerable to collisions, which can lead to the rejection of requests by the server or can be used by an attacker to precompute a rainbow table to reverse client response.

- **Weaknesses/vulnerabilities present**:
    - **CWE-252**: Unchecked Return Value: The failure of `php_random_bytes_throw` is not checked, leading to the use of uninitialized data.
    - **CWE-334**: Insufficient Entropy: The nonce generated had insufficient randomness (31 bits), making it vulnerable to duplication, and precomputation by malicious servers for password reversal.

- **Impact of exploitation**:
    - **Stack Information Leak:** An attacker could potentially gain a stack information leak (31 bits) due to the usage of uninitialized nonce.
    - **Rejection of Requests:** The small size of the client nonce could cause the server to reject requests due to the repetition of (cnonce, nc) pair.
    - **Password Reversal:** A malicious server could precompute a rainbow table of client responses and attempt to reverse the client password.

- **Attack vectors**:
    - A malicious server can exploit the insufficient randomness to precompute responses for client nonces, increasing the chance of password reversal through the client response.
    - The missing check on `php_random_bytes_throw` return value would leak stack information to the server

- **Required attacker capabilities/position**:
    - The attacker needs to control or be the server that is used for SOAP HTTP Digest authentication.
    - The attacker needs to be able to receive the client's request including the client nonce.