```text
{
  "vulnerability": {
    "root_cause": "The vulnerability is caused by the Clang compiler optimizing a seemingly constant-time implementation of `poly_frommsg` in the Kyber reference implementation, introducing a secret-dependent branch. The compiler infers that a mask used for conditional assignment is either all-zeros or all-ones, and replaces the conditional move with a branch for performance reasons. This optimization leads to timing variations dependent on the secret message bits, which can be exploited.",
    "weaknesses": [
      "Compiler optimization leading to secret-dependent execution path",
      "Lack of compiler awareness about security implications of optimizations",
      "Use of conditional moves that are not truly constant-time in compiled code"
    ],
    "impact": "The vulnerability allows an attacker to recover the secret key of ML-KEM 512 by performing timing measurements during decapsulation. The attacker can use a plaintext-checking oracle attack by observing the timing differences. Specifically, the timing of the `poly_frommsg` function varies based on secret data, allowing the attacker to deduce the bits of the secret key.",
    "attack_vectors": [
      "Timing side-channel attack"
    ],
    "required_capabilities": "The attacker needs the ability to measure the timing of cryptographic operations. The attacker needs to be able to perform decapsulation operations and measure the time taken. Local access is likely sufficient for high-resolution attacks, but remote attacks may also be feasible depending on the environment."
  },
  "affected_software": {
    "software": "Kyber reference implementation, specifically the `poly_frommsg` function, as compiled by Clang versions 15-18 with certain optimization flags on x86 architecture",
    "configurations": [
      "x86 architecture",
      "Clang versions v15-18",
       "Compiler options: -Os, -O1, -O2 -fno-vectorize, -O3 -fno-vectorize"
    ]
  },
 "additional_notes": [
    "The vulnerability is a result of the compiler's optimization, transforming a source-level constant-time implementation into a vulnerable assembly.",
    "The attack strategy is a plaintext-checking oracle attack.",
    "The issue was discovered by PQShield and a proof-of-concept exploit has been created.",
     "A fix for the vulnerability has been implemented in the Kyber reference implementation, involving a conditional move in a separate file, and other alternatives have been suggested.",
     "Affected libraries include liboqs, aws-lc, pq-code-package, WolfSSL, PQClean and rustpq/pqcrypto.",
     "The issue might affect other libraries based on the reference implementation."
  ]
}
```