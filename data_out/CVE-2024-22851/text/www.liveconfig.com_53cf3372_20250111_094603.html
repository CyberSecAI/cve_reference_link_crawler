
[![LiveConfig](/images/liveconfig.svg)](/de/)

[Lizenzportal](/license/)
Deutsch
 [English](/en/kb/cve/cve-2024-22851/)

* Produkt
  [Produkt](/de/produkt/) [Funktionsumfang](/de/features/) [Anforderungen](/de/anforderungen/) [LiveConfig 3](/de/lc3/)
* [Demo](/de/demo/)
* Download
  [Download](/de/download/) [Ãnderungsverlauf](/de/changelog/) [Lab/Vorschau](/de/lab/) [Testlizenz](/de/testlizenz/)
* Support
  [Support](/de/support/) [Admin-Handbuch](/de/handbuch/admin/) [Benutzerhandbuch](/de/handbuch/benutzer/) [HÃ¤ufige Fragen (FAQ)](/de/faq/) [Wissensdatenbank](/de/kb/) [SSL-Check](/de/sslcheck/) [Forum](/de/forum/)
* Partner
  [Partner](/de/partner/) [Werden Sie Partner](/de/partner/partner-werden/)
* Ãber uns
  [Ãber uns](/de/ueber-uns/) [Blog/News](/de/blog/) [Kontakt](/de/kontakt/) [Veranstaltungen](/de/veranstaltungen/)
* [Shop](/de/shop/)

suchen

* [Support](/de/support/)
* [Admin-Handbuch](/de/handbuch/admin/)
* [Benutzerhandbuch](/de/handbuch/benutzer/)
* [HÃ¤ufige Fragen (FAQ)](/de/faq/)
* [Wissensdatenbank](/de/kb/)
* [SSL-Check](/de/sslcheck/)
* [Forum](/de/forum/)

# CVE-2024-22851 - Unauthenticated Path Traversal

Erstellt: 30.01.2024

### Ãbersicht

Im Rahmen eines Sicherheitsaudits fÃ¼r einen LiveConfig-Kunden entdeckte Raphael Kuhn von der [DriveByte GmbH](https://www.drive-byte.de/de/) eine sogenannte **Unauthenticated Path Traversal**-Schwachstelle in LiveConfig bis Version 2.5.1.

### Ursache

Durch den Aufruf eines speziell prÃ¤parierten Pfadnamens war es mÃ¶glich, mit den Berechtigungen des LiveConfig-Benutzers (`liveconfig`) auf Dateien des Servers zuzugreifen. Ursache war eine fehlerhafte PrÃ¼fung auf das in dem betroffenen Anwendungsfall erlaubte Basisverzeichnis.

### Risiko

Die in LiveConfig integrierte Webserver-Komponente lÃ¤uft mit den Berechtigungen des Benutzers `liveconfig`. Somit konnte serverseitig auf alle Dateien lesend zugegriffen werden, fÃ¼r welche der Benutzer `liveconfig` berechtigt ist. Auf Inhalte von Webspace-Accounts bzw. von anderen Benutzern war *kein* Zugriff mÃ¶glich, auch nicht auf den Lizenzkey (`liveconfig.key`) und das TLS-Zertifikat (`sslcert.pem`) von LiveConfig.

Wenn LiveConfig mit der voreingestellten SQLite-Datenbank betrieben wurde, war es mÃ¶glich, durch einen gezielten Angriff auch diese auszulesen. Die Datenbank konnte Kontaktdaten von Kunden enthalten (je nachdem was erfasst wurde). Alle besonders sensiblen Daten (PasswÃ¶rter, Private Keys, TLS-Zertifikate etc.) sind dort jedoch stark gehashed (PBKDF2) oder verschlÃ¼sselt (AES) gespeichert. Nicht mehr benÃ¶tigte PasswÃ¶rter (z.B. nach dem erfolgreichen Anlegen von Accounts) werden von LiveConfig unmittelbar aus der Datenbank gelÃ¶scht.

Im (unserer EinschÃ¤tzung nach) âworst caseâ wÃ¤re somit ein Auslesen der gehosteten Domainnamen, Benutzernamen (LiveConfig, FTP, etc.) und ggf. Kontaktdaten mÃ¶glich (**Information Disclosure**).

Wenn MySQL als Datenbank-Backend verwendet wurde, war **kein** Zugriff auf diese Informationen mÃ¶glich: die Konfigurationsdatei `/etc/liveconfig/liveconfig.conf` mit den MySQL-Zugangsdaten kann nicht durch den `liveconfig`-Benutzer gelesen werden.

Betroffen war LiveConfig bis einschlieÃlich Version 2.5.1. Mit Version 2.5.2 (28.11.2017) wurde die fehlerhafte Komponente ersetzt, womit diese SicherheitslÃ¼cke nicht mehr ausgenutzt werden konnte. Der Fehler kann somit seit Ã¼ber sechs Jahren als âbehobenâ betrachtet werden.

DriveByte hat einen CVSS-Score 4.0 von 7.7 (High) berechnet: [CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:H/VI:N/VA:N/SC:L/SI:N/SA:N/E:P](https://www.first.org/cvss/calculator/4.0#CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:H/VI:N/VA:N/SC:L/SI:N/SA:N/E:P).

### Analyse

Mit folgenden `grep`-Aufrufen kann geprÃ¼ft werden, ob entsprechende Zugriffe erfolgreich stattgefunden haben:

```
cd /var/log/liveconfig
grep '/\.\./' access.log access.log.1 | grep '" 200'
zgrep '/\.\./' access.log*.gz | grep '" 200'

```
### Fazit

Dieser Fehler zeigt wie wichtig es ist, Server immer auf einem aktuellen Stand zu halten. Die SicherheitslÃ¼cke ist zwar durch Zufall ans Tageslicht gekommen (auf dem untersuchten System lief tatsÃ¤chlich LiveConfig 2.2.x), allerdings ist es dem FleiÃ und der Erfahrung von DriveByte zu verdanken, dass diese LÃ¼cke dort entdeckt wurde.

Im Anschluss an die Meldung haben wir den betroffenen Code sowie Ã¤hnliche Komponenten analysiert, konnten aber keine weiteren vergleichbaren Schwachstellen mehr ausmachen.

Dennoch halten wir eine Sicherheitswarnung fÃ¼r angemessen, fÃ¼r den Fall dass noch irgendwo anders solche extrem veralteten Serverinstallationen Ã¶ffentlich erreichbar sind. Zudem werden wir unsere Anstrengungen verstÃ¤rken, dass nicht angemeldete Benutzer die genaue LiveConfig-Version nicht herausfinden kÃ¶nnen, um ein gezieltes Crawling nach bestimmten LiveConfig-Versionen zu erschweren.

### Danksagung

Wir mÃ¶chten Herrn Raphael Kuhn ([DriveByte GmbH](https://www.drive-byte.de/de/)) fÃ¼r die verantwortungsvolle VerÃ¶ffentlichung des entdeckten Sicherheitsproblems sowie fÃ¼r die freundliche und offene Kommunikation danken.

* gemeldet: 06.11.2023 09:50 GMT+1
* analysiert: 06.11.2023 11:40 GMT+1
* verÃ¶ffentlicht: 30.01.2024
* behoben: 28.11.**2017** (commit `584a11418`)
* betroffene Versionen: bis v2.5.1

* Startseite

* [Produkt](/de/produkt/)
  + [Funktionsumfang](/de/features/)
  + [Anforderungen](/de/anforderungen/)
  + [LiveConfig 3](/de/lc3/)

* [Demo](/de/demo/)

* [Download](/de/download/)
  + [Ãnderungsverlauf](/de/changelog/)
  + [Lab/Vorschau](/de/lab/)
  + [Testlizenz](/de/testlizenz/)

* [Support](/de/support/)
  + [Admin-Handbuch](/de/handbuch/admin/)
  + [Benutzerhandbuch](/de/handbuch/benutzer/)
  + [HÃ¤ufige Fragen (FAQ)](/de/faq/)
  + [Wissensdatenbank](/de/kb/)
  + [SSL-Check](/de/sslcheck/)
  + [Forum](/de/forum/)

* [Partner](/de/partner/)
  + [Werden Sie Partner](/de/partner/partner-werden/)

* [Ãber uns](/de/ueber-uns/)
  + [Blog/News](/de/blog/)
  + [Kontakt](/de/kontakt/)
  + [Veranstaltungen](/de/veranstaltungen/)

* [Shop](/de/shop/)

Copyright Â© 2008-2025 LiveConfig GmbH.

Â» [Datenschutz](/de/datenschutz/)

Â» [Impressum](/de/impressum/)

Â» [Allgemeine GeschÃ¤ftsbedingungen (AGB)](/de/agb/)

![software made in germany](/images/made-in-germany.png)  [Facebook](https://facebook.com/LiveConfig)

 [GitHub](https://github.com/LiveConfig)

