

| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=73e5984e540a76a2ee1868b91590c922da8c24c9)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=73e5984e540a76a2ee1868b91590c922da8c24c9)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=73e5984e540a76a2ee1868b91590c922da8c24c9)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=73e5984e540a76a2ee1868b91590c922da8c24c9)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Joachim Vandersmissen <git@jvdsn.com> | 2024-03-28 11:24:30 -0500 |
| --- | --- | --- |
| committer | Herbert Xu <herbert@gondor.apana.org.au> | 2024-04-05 15:46:33 +0800 |
| commit | [73e5984e540a76a2ee1868b91590c922da8c24c9](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=73e5984e540a76a2ee1868b91590c922da8c24c9) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=73e5984e540a76a2ee1868b91590c922da8c24c9)) | |
| tree | [cce68ffe94539b57ac7c87f397a052e0b28b584e](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=73e5984e540a76a2ee1868b91590c922da8c24c9) | |
| parent | [5adf213cf2d60bfa61eb1872b099a649239343d3](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=5adf213cf2d60bfa61eb1872b099a649239343d3) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=73e5984e540a76a2ee1868b91590c922da8c24c9&id2=5adf213cf2d60bfa61eb1872b099a649239343d3)) | |
| download | [linux-73e5984e540a76a2ee1868b91590c922da8c24c9.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-73e5984e540a76a2ee1868b91590c922da8c24c9.tar.gz) | |

crypto: ecdh - explicitly zeroize private\_keyprivate\_key is overwritten with the key parameter passed in by the
caller (if present), or alternatively a newly generated private key.
However, it is possible that the caller provides a key (or the newly
generated key) which is shorter than the previous key. In that
scenario, some key material from the previous key would not be
overwritten. The easiest solution is to explicitly zeroize the entire
private\_key array first.
Note that this patch slightly changes the behavior of this function:
previously, if the ecc\_gen\_privkey failed, the old private\_key would
remain. Now, the private\_key is always zeroized. This behavior is
consistent with the case where params.key is set and ecc\_is\_key\_valid
fails.
Signed-off-by: Joachim Vandersmissen <git@jvdsn.com>
Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=73e5984e540a76a2ee1868b91590c922da8c24c9)

| -rw-r--r-- | [crypto/ecdh.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/crypto/ecdh.c?id=73e5984e540a76a2ee1868b91590c922da8c24c9) | 2 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 2 insertions, 0 deletions

| diff --git a/crypto/ecdh.c b/crypto/ecdh.cindex 80afee3234fbe7..3049f147e0117b 100644--- a/[crypto/ecdh.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/crypto/ecdh.c?id=5adf213cf2d60bfa61eb1872b099a649239343d3)+++ b/[crypto/ecdh.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/crypto/ecdh.c?id=73e5984e540a76a2ee1868b91590c922da8c24c9)@@ -33,6 +33,8 @@ static int ecdh\_set\_secret(struct crypto\_kpp \*tfm, const void \*buf, params.key\_size > sizeof(u64) \* ctx->ndigits) return -EINVAL; + memset(ctx->private\_key, 0, sizeof(ctx->private\_key));+ if (!params.key || !params.key\_size) return ecc\_gen\_privkey(ctx->curve\_id, ctx->ndigits, ctx->private\_key); |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-10 15:17:18 +0000

