
[![NinTechNet](https://blog.nintechnet.com/wp-content/uploads/2018/07/nintechnet_logo.png)](https://nintechnet.com/)

[NinTechNet](https://nintechnet.com/ "Back to NinTechNet's home")

The Ninja Technologies Network

[Skip to content](#content)
[Menu](#header-menu-responsive)

* [Blog Summary](https://blog.nintechnet.com/)
* [NinTechNet’s Home](https://nintechnet.com/)

# Multiple WordPress plugins fixed CSRF vulnerabilities (part 5).

* by [Jerome Bruandet](https://blog.nintechnet.com/author/bruandet/)
* Posted on [August 16, 2021 - 12:20pm [+0700]](https://blog.nintechnet.com/multiple-wordpress-plugins-fixed-csrf-vulnerabilities-part-5/)

This is the fifth part of our “Multiple WordPress plugins fixed CSRF vulnerabilities” saga. If you missed the previous episodes, you can click on the links below:

[Multiple WordPress plugins fixed CSRF vulnerabilities (part 1)](https://blog.nintechnet.com/multiple-wordpress-plugins-fixed-csrf-vulnerabilities-part-1/).

[Multiple WordPress plugins fixed CSRF vulnerabilities (part 2)](https://blog.nintechnet.com/multiple-wordpress-plugins-fixed-csrf-vulnerabilities-part-2/).

[Multiple WordPress plugins fixed CSRF vulnerabilities (part 3)](https://blog.nintechnet.com/multiple-wordpress-plugins-fixed-csrf-vulnerabilities-part-3/).

[Multiple WordPress plugins fixed CSRF vulnerabilities (part 4)](https://blog.nintechnet.com/multiple-wordpress-plugins-fixed-csrf-vulnerabilities-part-4/).

### Vulnerable Plugins

1. [Rucy](https://wordpress.org/plugins/rucy/)

Vulnerable version: 0.4.4 and below (plugin closed)

Vulnerable nonce: inc/class-rucy-editor.php#L242

```
if(isset( $_POST['schroeder'] ) && !wp_verify_nonce( $_POST['schroeder'], plugin_basename( __FILE__ ) ) ) {
   return;
}

```

If `$_POST['schroeder']` isn’t set, the nonce won’t be checked.

---

2. [WP-Backgrounds Lite](https://wordpress.org/plugins/wp-backgrounds-lite/)

Vulnerable version: 2.3 and below (plugin closed)

Vulnerable nonce: inoplugs\_background\_plugin.php#L183

```
// verify nonce
if (isset($_POST['ino_meta_box_nonce']) && !wp_verify_nonce($_POST['ino_meta_box_nonce'], basename(__FILE__))) {
   return $post_id;
}

```

if `$_POST['ino_meta_box_nonce']` isn’t set, the nonce won’t be checked.

---

3. [WP Security Question](https://wordpress.org/plugins/wp-security-questions/)

Vulnerable version: 1.0.5 and below (plugin closed)

Vulnerable nonce: modules/settings/model.settings.php#L36

```
if ( isset( $_REQUEST['_wpnonce'] ) ) {
   $nonce = sanitize_text_field( wp_unslash( $_REQUEST['_wpnonce'] ) ); }
if ( isset( $nonce ) and ! wp_verify_nonce( $nonce, 'wpgmp-nonce' ) ) {
   die( 'Cheating...' );
}

```

If `$_REQUEST['_wpnonce']` isn’t set, the nonce won’t be checked.

---

4. [Event Espresso 4 Decaf – Event Registration Event Ticketing](https://wordpress.org/plugins/event-espresso-decaf/)

Vulnerable version: 4.10.11.decaf and below (plugin closed)

Vulnerable nonce: core/domain/services/pue/Stats.php#L194

```
// verify nonce
if (isset($_POST['nonce']) && ! wp_verify_nonce($_POST['nonce'], 'ee-data-optin')) {
   exit();
}

```

If `$_POST['nonce']` isn’t set, the nonce won’t be checked.

---

5. [WordPress Photo Gallery – Image Gallery](https://wordpress.org/plugins/photo-contest/)

Vulnerable version: 1.0.6 and below (plugin closed)

Vulnerable nonce #1: includes/view/ajax-function.php#L562

```
if (!isset($_POST['galleryImgThumbnailLoadNonce']) && !wp_verify_nonce($_POST['galleryImgThumbnailLoadNonce'], 'gallery_img_thumbnail_load_nonce')) {
   wp_die('Security check fail');
}

```

If `$_POST['galleryImgThumbnailLoadNonce']` is set, the nonce won’t be checked.

Vulnerable nonce #2: includes/admin/admin-page-galleries.php#L107

```
if (isset($_REQUEST['gallery_nonce_remove_image']) && !wp_verify_nonce($_REQUEST['gallery_nonce_remove_image'], 'gallery_nonce_remove_image' . $idfordelete)) {
   wp_die('Security check fail edit');
}

```

If `$_REQUEST['gallery_nonce_remove_image']` isn’t set, the nonce won’t be checked.

---

6. [Opal Estate](https://wordpress.org/plugins/opal-estate/)

Vulnerable version: 1.6.11 and below (plugin closed)

Vulnerable nonce #1: inc/ajax-functions.php#L183

```
if ( ! isset( $_REQUEST['nonce'] ) && ! wp_verify_nonce( $_REQUEST['nonce'], 'nonce' ) ) return;

```

If `$_REQUEST['nonce']` is set, the nonce won’t be checked.

Vulnerable nonce #2: inc/ajax-functions.php#L195

```
if ( ! isset( $_REQUEST['nonce'] ) && ! wp_verify_nonce( $_REQUEST['nonce'], 'nonce' ) ) return;

```

Same as above.

---

7. [Sync to Etsy Marketplace from WooCommerce](https://wordpress.org/plugins/exportfeed-for-woocommerce-product-to-etsy/)

Vulnerable version: 3.3.1 and below (plugin closed)

Vulnerable nonce: etsy-export-feed-manage.php#L737

```
if ( ! isset( $_GET['ETCPF_security'] ) && ! wp_verify_nonce( sanitize_text_field( wp_unslash( $_GET['ETCPF_security'] ) ), 'delete_feed' ) ) {
   if ( ! current_user_can( 'editor' ) || ! current_user_can( 'administrator' ) ) {
      return false;
   }
}

```

If `$_GET['ETCPF_security']` is set, the nonce won’t be checked (and the 2 capability checks will be bypassed as well).

---

8. [RAYS Grid](https://wordpress.org/plugins/rays-grid/)

Vulnerable version: 1.2.2 and below (plugin closed)

Vulnerable nonce: includes/class-db.php#L132

```
if ( isset( $_POST['rsgd_nonce_fields'] ) && ! wp_verify_nonce( $_POST['rsgd_nonce_fields'], 'rsgd_nonce_fields' ) && !current_user_can( 'edit_others_posts' ) ) { return; }

```

If `$_POST['rsgd_nonce_fields']` isn’t set, the nonce won’t be checked (and the capability check will be bypassed as well).

---

9. [Sell Media](https://wordpress.org/plugins/sell-media/)

Vulnerable version: 2.5.5 and below (plugin closed)

Vulnerable nonce: inc/gateways/class-sm-gateway-paypal-request.php#L85

```
//check_ajax_referer( 'sell_media_paypal_nonce', 'nonce_security' );
if (isset($_POST['_nonce']) && !wp_verify_nonce($_POST['_nonce'], 'sell_media_paypal_nonce')) {
   $_send_data['status'] = false;
   wp_send_json($_send_data);
   die();
}

```

If `$_POST['_nonce']` isn’t set, the nonce won’t be checked.

---

### Stay informed about the latest vulnerabilities

* Running WordPress? You can get [email notifications](https://blog.nintechnet.com/how-to-get-informed-about-the-latest-security-updates-in-your-wordpress-plugins-and-themes/) about vulnerabilities in the plugins or themes installed on your blog.
* On Twitter: [@nintechnet](https://twitter.com/nintechnet)

Tagged: [NinjaFirewall](https://blog.nintechnet.com/tag/ninjafirewall/), [Security](https://blog.nintechnet.com/tag/security/), [Vulnerability](https://blog.nintechnet.com/tag/vulnerability/), [WordPress](https://blog.nintechnet.com/tag/wordpress/)

* [Share on Twitter](https://twitter.com/share?text=Multiple%20WordPress%20plugins%20fixed%20CSRF%20vulnerabilities%20%28part%205%29.&url=https%3A%2F%2Fblog.nintechnet.com%2Fmultiple-wordpress-plugins-fixed-csrf-vulnerabilities-part-5%2F)
* [Share on Facebook](https://www.facebook.com/sharer.php?u=https%3A%2F%2Fblog.nintechnet.com%2Fmultiple-wordpress-plugins-fixed-csrf-vulnerabilities-part-5%2F)
* [Share on Reddit](https://www.reddit.com/submit?title=Multiple%20WordPress%20plugins%20fixed%20CSRF%20vulnerabilities%20%28part%205%29.&url=https%3A%2F%2Fblog.nintechnet.com%2Fmultiple-wordpress-plugins-fixed-csrf-vulnerabilities-part-5%2F)
* [RSS icon](https://blog.nintechnet.com/feed/)

## Post navigation

[Previous WordPress Plugins and Themes Vulnerabilities: Stats, Facts and Recommendations.](https://blog.nintechnet.com/wordpress-plugins-and-themes-vulnerabilities-stats-facts-and-recommendations/)[Next Anatomy of the EICAR Antivirus Test File.](https://blog.nintechnet.com/anatomy-of-the-eicar-antivirus-test-file/)

## Our Products

![NinjaFirewall](https://blog.nintechnet.com/wp-content/uploads/2018/09/logo-nfwp-150.png)

**NinjaFirewall WP+**

Web Application Firewall for WordPress. It will give your blog the highest level of protection it deserves.

Free Download

---

![SaferCheckout](https://blog.nintechnet.com/wp-content/uploads/safercheckout_150x150.png)

**SaferCheckout**

A powerful security plugin to protect WooCommerce stores from fraudulent transactions.

Free Download

---

![NinjaFirewall](https://blog.nintechnet.com/wp-content/uploads/2018/09/logo-nfpro-150.png)

**NinjaFirewall Pro+**

Web Application Firewall for PHP applications. It will protect your PHP site, from custom scripts to popular shopping cart and CMS applications.

Free Download

---

![Code Profiler](https://blog.nintechnet.com/wp-content/uploads/2018/09/logo-cp-150.png)

**Code Profiler**

Speed up your WordPress website by locating bottlenecks and performance issues in your plugins and themes.

Free Download

---

![NinjaScanner](https://blog.nintechnet.com/wp-content/uploads/2018/09/logo-ns-150.png)

**NinjaScanner**

A lightweight, fast and powerful malware and virus scanner for WordPress which includes many features to help you scan your blog for malware and virus.

Free Download
## Categories

Categories
Select Category
Benchmarks  (5)
Changelog  (1)
Code Profiler  (1)
HHVM  (1)
Joomla!  (2)
Magento  (1)
NinjaFirewall  (150)
NinjaScanner  (8)
Performance  (2)
Privacy  (1)
Security  (154)
   Brute-force attack  (5)
   Malware  (7)
   Phishing  (2)
   Virus  (2)
   Vulnerability  (129)
Troubleshooting  (14)
Tutorial  (26)
WooCommerce  (2)
WordPress  (149)

## Search

Search for:

Search

## Recent Posts

* [XSS / HTML injection vulnerability in WordPress Plugin Check (PCP) plugin.](https://blog.nintechnet.com/xss-html-injection-vulnerability-in-wordpress-plugin-check-pcp-plugin/)
  December 6, 2024 - 7:24pm [+0700]
* [How to debug WooCommerce Add to Cart action with Code Profiler.](https://blog.nintechnet.com/how-to-debug-woocommerce-add-to-cart-action-with-code-profiler/)
  November 28, 2024 - 7:00pm [+0700]
* [SaferCheckout: Fraud prevention plugin for WooCommerce stores.](https://blog.nintechnet.com/safercheckout-fraud-prevention-plugin-for-woocommerce-stores/)
  August 5, 2024 - 5:31pm [+0700]
* [Unauthenticated function injection vulnerability in WordPress Shortcode Addons plugin (unpatched).](https://blog.nintechnet.com/unauthenticated-function-injection-vulnerability-in-wordpress-shortcode-addons-plugin-unpatched/)
  April 22, 2024 - 11:29am [+0700]
* [Broken access control vulnerability fixed in WordPress 10Web AI Assistant plugin.](https://blog.nintechnet.com/broken-access-control-vulnerability-fixed-in-wordpress-10web-ai-assistant-plugin/)
  January 26, 2024 - 1:50pm [+0700]

© Copyright
2025 – [The Ninja Technologies Network](https://nintechnet.com/)

