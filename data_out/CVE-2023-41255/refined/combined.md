=== Content from psirt.bosch.com_aa456e9d_20250111_080425.html ===

[Skip to main](#main)

Menu

* [About us](/about-us/)
* [Process Overview](/process-overview/)
* [Report a Vulnerability](/report-a-vulnerability/)
* [Security Advisories](/security-advisories/)
* [Hall of Fame](/hall-of-fame/)
* [Bosch Responsible Disclosure Policy](/bosch-responsible-disclosure-policy/)
* [Bosch Brands](/bosch-brands/)
[EN](/about-us/)

# Multiple vulnerabilities on ctrlX HMI / WR21

BOSCH-SA-175607

## Advisory Information

* **Advisory ID:**  BOSCH-SA-175607
* **CVE Numbers and CVSS v3.1 Scores:**
  + [CVE-2023-41255](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-41255)
    - Base Score:  [8.8 (High)](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)
  + [CVE-2023-41372](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-41372)
    - Base Score:  [7.8 (High)](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H)
  + [CVE-2023-41960](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-41960)
    - Base Score:  [7.1 (High)](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:H)
  + [CVE-2023-43488](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-43488)
    - Base Score:  [7.9 (High)](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:C/C:L/I:H/A:L)
  + [CVE-2023-45220](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-45220)
    - Base Score:  [8.8 (High)](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)
  + [CVE-2023-45321](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-45321)
    - Base Score:  [8.3 (High)](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:L)
  + [CVE-2023-45844](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-45844)
    - Base Score:  [7.3 (High)](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:P/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:H)
  + [CVE-2023-45851](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-45851)
    - Base Score:  [8.8 (High)](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)
  + [CVE-2023-46102](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-46102)
    - Base Score:  [8.8 (High)](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)
* **Published:**  20 Oct 2023
* **Last Updated:**  21 Nov 2023

## Summary

The operating system of the ctrlX HMI/ WR21 before build date 20231107 has some vulnerabilities when the kiosk mode is used in conjunction with Google Chrome. Therefore, it is possible in worst case that an attacker with physical access to the device can get root access without normal authentication borders.

Additionally, the "Android Agent" application which is an onboard application of ctrlX HMI/ WR21 before build date 20231107 contains some weaknesses regarding the execution of arbitrary commands on the device. All weaknesses were eliminated in the newest firmware version which can be updated on the existing devices.

## Affected Products

| Vendor Name | Product Name | Affected versions |
| --- | --- | --- |
| Bosch Rexroth AG | ctrlX HMI Web Panel - WR21 (WR2107) | < RC7 (Build date 20231107) |
| Bosch Rexroth AG | ctrlX HMI Web Panel - WR21 (WR2110) | < RC7 (Build date 20231107) |
| Bosch Rexroth AG | ctrlX HMI Web Panel - WR21 (WR2115) | < RC7 (Build date 20231107) |

## Solution and Mitigations

### Solution

An updated firmware version is available. This version prevents that an attacker with physical access to the device might gain root access.

Furthermore, the application "Android Agent" will be removed entirely.

Please contact your sales partner for instructions on how to retrieve the update. Users are strongly advised to upgrade to the new version.

### Mitigation

Until the updated version is installed, users are strongly advised not to use Google Chrome for the Kiosk mode. As an alternative, the WebStation app may be used for this purpose.

Android Agent should not be used at all.

## Vulnerability Details

### CVE-2023-41255

CVE description: The vulnerability allows an unprivileged user with access to the subnet of the TPC-110W device to gain a root shell on the device itself abusing the lack of authentication of the âsuâ binary file installed on the device that can be accessed through the ADB (Android Debug Bridge) protocol exposed on the network.

* Problem Type:
  + [CWE-306 Missing Authentication for Critical Function](https://cwe.mitre.org/data/definitions/306.html)
* CVSS Vector String:  [CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)
  + Base Score: 8.8 (High)

### CVE-2023-41372

CVE description: The vulnerability allows an unprivileged (untrusted) third- party application to arbitrary modify the server settings of the Android Client application, inducing it to connect to an attacker - controlled malicious server.This is possible by forging a valid broadcast intent encrypted with a hardcoded RSA key pair

* Problem Type:
  + [CWE-798 Use of Hard-coded Credentials](https://cwe.mitre.org/data/definitions/798.html)
* CVSS Vector String:  [CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H)
  + Base Score: 7.8 (High)

### CVE-2023-41960

CVE description: The vulnerability allows an unprivileged(untrusted) third-party application to interact with a content-provider unsafely exposed by the Android Agent application, potentially modifying sensitive settings of the Android Client application itself.

* Problem Type:
  + [CWE-926 Improper Export of Android Application Components](https://cwe.mitre.org/data/definitions/926.html)
* CVSS Vector String:  [CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:H](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:H)
  + Base Score: 7.1 (High)

### CVE-2023-43488

CVE description: The vulnerability allows a low privileged (untrusted) application to modify a critical system property that should be denied, in order to enable the ADB (Android Debug Bridge) protocol to be exposed on the network, exploiting it to gain a privileged shell on the device without requiring the physical access through USB.

* Problem Type:
  + [CWE-862 Missing Authorization](https://cwe.mitre.org/data/definitions/862.html)
* CVSS Vector String:  [CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:C/C:L/I:H/A:L](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:C/C:L/I:H/A:L)
  + Base Score: 7.9 (High)

### CVE-2023-45220

CVE description: The Android Client application, when enrolled with the define method 1(the user manually inserts the server ip address), use HTTP protocol to retrieve sensitive information (ip address and credentials to connect to a remote MQTT broker entity) instead of HTTPS and this feature is not configurable by the user.

* Problem Type:
  + [CWE-306 Missing Authentication for Critical Function](https://cwe.mitre.org/data/definitions/306.html)
* CVSS Vector String:  [CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)
  + Base Score: 8.8 (High)

### CVE-2023-45321

CVE description: The Android Client application, when enrolled with the define method 1 (the user manually inserts the server ip address), use HTTP protocol to retrieve sensitive information (ip address and credentials to connect to a remote MQTT broker entity) instead of HTTPS and this feature is not configurable by the user. Due to the lack of encryption of HTTP,this issue allows an attacker placed in the same subnet network of the HMI device to intercept username and password necessary to authenticate to the MQTT server responsible to implement the remote management protocol.

* Problem Type:
  + [CWE-319 Cleartext Transmission of Sensitive Information](https://cwe.mitre.org/data/definitions/319.html)
* CVSS Vector String:  [CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:L](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:L)
  + Base Score: 8.3 (High)

### CVE-2023-45844

CVE description: The vulnerability allows a low privileged user that have access to the device when locked in Kiosk mode to install an arbitrary Android application and leverage it to have access to critical device settings such as the device power management or eventually the device secure settings (ADB debug).

* Problem Type:
  + [CWE-284 Improper Access Control](https://cwe.mitre.org/data/definitions/284.html)
* CVSS Vector String:  [CVSS:3.1/AV:P/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:H](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:P/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:H)
  + Base Score: 7.3 (High)

### CVE-2023-45851

CVE description: The Android Client application, when enrolled to the AppHub server,connects to an MQTT broker without enforcing any server authentication.

This issue allows an attacker to force the Android Client application to connect to a malicious MQTT broker, enabling it to send fake messages to the HMI device

* Problem Type:
  + [CWE-306 Missing Authentication for Critical Function](https://cwe.mitre.org/data/definitions/306.html)
* CVSS Vector String:  [CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)
  + Base Score: 8.8 (High)

### CVE-2023-46102

CVE description: The Android Client application, when enrolled to the AppHub server, connects to an MQTT broker to exchange messages and receive commands to execute on the HMI device. The protocol builds on top of MQTT to implement the remote management of the device is encrypted with a hard-coded DES symmetric key, that can be retrieved reversing both the Android Client application and the server-side web application.

This issue allows an attacker able to control a malicious MQTT broker on the same subnet network of the device, to craft malicious messages and send them to the HMI device, executing arbitrary commands on the device itself.

* Problem Type:
  + [CWE-798 Use of Hard-coded Credentials](https://cwe.mitre.org/data/definitions/798.html)
* CVSS Vector String:  [CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)
  + Base Score: 8.8 (High)

## Remarks

### Security Update Information

With respect to Directive (EU) 2019/770 and Directive (EU) 2019/771 and their national transposition laws, please note:

It is your responsibility to download and/or install any security updates provided by us, for example to maintain product or data security. If you fail to install a security update provided to you within a reasonable period of time, we will not be liable for any product defect solely due to the absence of such security update.

Alternatively, we are entitled to directly download and/or install security updates regardless of your settings. In these cases, we will provide you with the relevant information, e.g. in this security advisory.

### CVSS Scoring

Vulnerability classification has been performed using the  [CVSS v3.1 scoring system](https://www.first.org/cvss/)  . The CVSS environmental score is specific to each customerâs environment and should be defined by the customer to attain a final scoring.

## Additional Resources

* [1] Bosch Rexroth Advisory: <https://www.boschrexroth.com/en/dc/product-security/security-advisories/>

Please contact the Bosch PSIRT if you have feedback, comments, or additional information about this vulnerability at:  psirt@bosch.com  .

## Revision History

* 21 Nov 2023: Update as patch is available
* 25 Oct 2023: Added CVE list
* 20 Oct 2023: Initial Publication

## Appendix

### Acknowledgement

 **These vulnerabilities have been uncovered and disclosed responsibly by Diego Giubertoni from Nozomi Networks. We thank him for making a responsible disclosure with us.**

---

Â© 2022 Robert Bosch GmbH

* [Corporate information](/corporate-information.html)
* [Legal notice](/legal-notice.html)
* [CCPA PIPEDA Privacy](/ccpa-pipeda-privacy.html)
* [Data protection policy](/data-protection-policy.html)
* Privacy settings


