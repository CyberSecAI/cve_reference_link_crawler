

[![ClamAV® blog](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjWCrARLKJbEVdLWtBNSDGHk40aR4zscgMJg954NfSGe2NZWkievO-YquDFC79onrgz2lqOHUszFKH-4rhRsKctziTp1JyImh1wSk671iBPs9BM1YQ_35Bqnn6IcvLf8LyAmeAejDF2d9a1/s1600/CAVblogheader.png)](https://blog.clamav.net/)

## Wednesday, January 12, 2022

### ClamAV 0.103.5 and 0.104.2 security patch release; 0.102 past EOL

ClamAV versions 0.103.5 and 0.104.2 are now available for download on the [clamav.net Downloads page](https://www.clamav.net/downloads).

We would also like to take this opportunity to remind users that versions 0.102 and 0.101 have reached their end-of-life period. These versions exceeded our EOL dates on Jan. 3, 2022 and will soon be actively blocked from downloading signature database updates.

For additional details about ClamAV's end-of-life policy, [please see our online documentation](https://docs.clamav.net/faq/faq-eol.html).

## 0.103.5

ClamAV 0.103.5 is a critical patch release with the following fixes:

* [CVE-2022-20698](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-20698):
  Fix for invalid pointer read that may cause a crash. This issue affects 0.104.1, 0.103.4 and prior when ClamAV is compiled with libjson-c and
  the `CL_SCAN_GENERAL_COLLECT_METADATA` scan option (the `clamscan --gen-json`
  option) is enabled.

  Cisco would like to thank Laurent Delosieres of ManoMano for reporting this
  vulnerability.
* Fixed ability to disable the file size limit with libclamav C API, like this:

  ```
    cl_engine_set_num(engine, CL_ENGINE_MAX_FILESIZE, 0);
  ```

  This issue didn't affect ClamD or ClamScan which also can disable the limit by
  setting it to zero using `MaxFileSize 0` in `clamd.conf` for ClamD, or
  `clamscan --max-filesize=0` for ClamScan.

  Note: Internally, the max file size is still set to 2 GiB. Disabling the limit
  for a scan will fall back on the internal 2 GiB limitation.
* Increased the maximum line length for ClamAV config files from 512 bytes to
  1,024 bytes to allow for longer config option strings.
* SigTool: Fix insufficient buffer size for `--list-sigs` that caused a failure
  when listing a database containing one or more very long signatures.
  This fix was backported from 0.104.

Special thanks to the following for code contributions and bug reports:

* Laurent Delosieres

## 0.104.2

ClamAV 0.104.2 is a critical patch release with the following fixes:

* [CVE-2022-20698](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-20698):
  Fix for invalid pointer read that may cause a crash.
  Affects 0.104.1, 0.103.4 and prior when ClamAV is compiled with libjson-c and
  the `CL_SCAN_GENERAL_COLLECT_METADATA` scan option (the `clamscan --gen-json`
  option) is enabled.

  Cisco would like to thank Laurent Delosieres of ManoMano for reporting this
  vulnerability.
* Fixed ability to disable the file size limit with libclamav C API, like this:

  ```
    cl_engine_set_num(engine, CL_ENGINE_MAX_FILESIZE, 0);
  ```

  This issue didn't impact ClamD or ClamScan which also can disable the limit by
  setting it to zero using `MaxFileSize 0` in `clamd.conf` for ClamD, or
  `clamscan --max-filesize=0` for ClamScan.

  Note: Internally, the max file size is still set to 2 GiB. Disabling the limit
  for a scan will fall back on the internal 2 GiB limitation.
* Increased the maximum line length for ClamAV config files from 512 bytes to 1,024 bytes to allow for longer config option strings.

Special thanks to the following for code contributions and bug reports:

* Laurent Delosieres

Posted by

[Micah Snyder](https://www.blogger.com/profile/07798916006145826441 "author profile")

at

[2:11 PM](https://blog.clamav.net/2022/01/clamav-01035-and-01042-security-patch.html "permanent link")

[![](//img1.blogblog.com/img/icon18_email.gif)](https://www.blogger.com/email-post/2366689974368239573/6271294547964987039 "Email Post")

[![](//img2.blogblog.com/img/icon18_edit_allbkg.gif)](https://www.blogger.com/post-edit.g?blogID=2366689974368239573&postID=6271294547964987039&from=pencil "Edit Post")

[Email This](https://www.blogger.com/share-post.g?blogID=2366689974368239573&postID=6271294547964987039&target=email "Email This")[BlogThis!](https://www.blogger.com/share-post.g?blogID=2366689974368239573&postID=6271294547964987039&target=blog "BlogThis!")[Share to X](https://www.blogger.com/share-post.g?blogID=2366689974368239573&postID=6271294547964987039&target=twitter "Share to X")[Share to Facebook](https://www.blogger.com/share-post.g?blogID=2366689974368239573&postID=6271294547964987039&target=facebook "Share to Facebook")[Share to Pinterest](https://www.blogger.com/share-post.g?blogID=2366689974368239573&postID=6271294547964987039&target=pinterest "Share to Pinterest")

Labels:
[0.103.5](https://blog.clamav.net/search/label/0.103.5),
[0.104.2](https://blog.clamav.net/search/label/0.104.2),
[clamav](https://blog.clamav.net/search/label/clamav),
[eol](https://blog.clamav.net/search/label/eol)

[Newer Post](https://blog.clamav.net/2022/03/clamav-01050-release-candidate-now.html "Newer Post")

[Older Post](https://blog.clamav.net/2021/12/clamav-bugzilla-new-ticket-creation.html "Older Post")

[Home](https://blog.clamav.net/)

[![ClamAV](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgM6-2LQF77-JTTfuXoMyoTDdBPtWr0RXnIZKeCTlc3sWhK24-q_i5E9pJ8ZC56VEXmRPFI6YdVwiI7bOYDsvfYpXbaNhjUU22I5gf7azHIw6eu6MyA7POxbXXCEvPlNMEIhjiYzCLxcn_f/s196/blog-illustration.png)](http://clamav.net)

## Subscribe

[Subscribe to the ClamAV Blog by Email](http://feedburner.google.com/fb/a/mailverify?uri=Clamav&loc=en_US)

## Related Information:

* [ClamAV](http://www.clamav.net/)
* [ClamAV's Twitter Account](http://www.twitter.com/clamav)
* [Talos Group Blog](http://blogs.cisco.com/talos)
* [Snort.org](http://www.snort.org/)
* [Snort Blog](http://blog.snort.org/)

## Popular Posts This Week

* [ClamAV 1.4.1, 1.3.2, 1.0.7, and 0.103.12 security patch versions published](https://blog.clamav.net/2024/09/clamav-141-132-107-and-010312-security.html)
* [ClamAV 0.99.3 has been released!](https://blog.clamav.net/2018/01/clamav-0993-has-been-released.html)
* [ClamAV 0.98.7 has been released!](https://blog.clamav.net/2015/04/clamav-0987-has-been-released.html)
* [ClamAV 0.98.6 has been released!](https://blog.clamav.net/2015/01/clamav-0986-has-been-released.html)
* [![](https://lh6.googleusercontent.com/j2eBqgI6PvU-7ZTy7NKUZZtb54A6ZPUpqTRso42pOHiV05NdgczHAUorsYFwv7rRFl4jLJGI3ytHaFQDT2ED41uciEosBibjt4ej3OO_KbaI8WG6zIF1qQjbJeu0ahwp7vXRszJv=s72-c)](https://blog.clamav.net/2021/03/clamav-cvds-cdiffs-and-magic-behind.html)

  [ClamAV, CVDs, CDIFFs and the magic behind the curtain](https://blog.clamav.net/2021/03/clamav-cvds-cdiffs-and-magic-behind.html)

## Blog Archive

* ►
  [2024](https://blog.clamav.net/2024/)
  (
  8
  )
  + ►
    [September](https://blog.clamav.net/2024/09/)
    (
    1
    )
  + ►
    [August](https://blog.clamav.net/2024/08/)
    (
    2
    )
  + ►
    [May](https://blog.clamav.net/2024/05/)
    (
    1
    )
  + ►
    [April](https://blog.clamav.net/2024/04/)
    (
    1
    )
  + ►
    [February](https://blog.clamav.net/2024/02/)
    (
    1
    )
  + ►
    [January](https://blog.clamav.net/2024/01/)
    (
    2
    )

* ►
  [2023](https://blog.clamav.net/2023/)
  (
  11
  )
  + ►
    [December](https://blog.clamav.net/2023/12/)
    (
    1
    )
  + ►
    [October](https://blog.clamav.net/2023/10/)
    (
    1
    )
  + ►
    [August](https://blog.clamav.net/2023/08/)
    (
    3
    )
  + ►
    [June](https://blog.clamav.net/2023/06/)
    (
    1
    )
  + ►
    [May](https://blog.clamav.net/2023/05/)
    (
    2
    )
  + ►
    [March](https://blog.clamav.net/2023/03/)
    (
    2
    )
  + ►
    [February](https://blog.clamav.net/2023/02/)
    (
    1
    )

* ▼
  [2022](https://blog.clamav.net/2022/)
  (
  11
  )
  + ►
    [November](https://blog.clamav.net/2022/11/)
    (
    2
    )
  + ►
    [October](https://blog.clamav.net/2022/10/)
    (
    2
    )
  + ►
    [July](https://blog.clamav.net/2022/07/)
    (
    2
    )
  + ►
    [May](https://blog.clamav.net/2022/05/)
    (
    2
    )
  + ►
    [April](https://blog.clamav.net/2022/04/)
    (
    1
    )
  + ►
    [March](https://blog.clamav.net/2022/03/)
    (
    1
    )
  + ▼
    [January](https://blog.clamav.net/2022/01/)
    (
    1
    )
    - [ClamAV 0.103.5 and 0.104.2 security patch release;...](https://blog.clamav.net/2022/01/clamav-01035-and-01042-security-patch.html)

* ►
  [2021](https://blog.clamav.net/2021/)
  (
  21
  )
  + ►
    [December](https://blog.clamav.net/2021/12/)
    (
    2
    )
  + ►
    [November](https://blog.clamav.net/2021/11/)
    (
    1
    )
  + ►
    [October](https://blog.clamav.net/2021/10/)
    (
    1
    )
  + ►
    [September](https://blog.clamav.net/2021/09/)
    (
    3
    )
  + ►
    [August](https://blog.clamav.net/2021/08/)
    (
    1
    )
  + ►
    [July](https://blog.clamav.net/2021/07/)
    (
    3
    )
  + ►
    [June](https://blog.clamav.net/2021/06/)
    (
    4
    )
  + ►
    [May](https://blog.clamav.net/2021/05/)
    (
    1
    )
  + ►
    [April](https://blog.clamav.net/2021/04/)
    (
    2
    )
  + ►
    [March](https://blog.clamav.net/2021/03/)
    (
    1
    )
  + ►
    [February](https://blog.clamav.net/2021/02/)
    (
    2
    )

* ►
  [2020](https://blog.clamav.net/2020/)
  (
  10
  )
  + ►
    [September](https://blog.clamav.net/2020/09/)
    (
    2
    )
  + ►
    [August](https://blog.clamav.net/2020/08/)
    (
    1
    )
  + ►
    [July](https://blog.clamav.net/2020/07/)
    (
    3
    )
  + ►
    [June](https://blog.clamav.net/2020/06/)
    (
    1
    )
  + ►
    [May](https://blog.clamav.net/2020/05/)
    (
    1
    )
  + ►
    [February](https://blog.clamav.net/2020/02/)
    (
    2
    )

* ►
  [2019](https://blog.clamav.net/2019/)
  (
  14
  )
  + ►
    [December](https://blog.clamav.net/2019/12/)
    (
    1
    )
  + ►
    [November](https://blog.clamav.net/2019/11/)
    (
    2
    )
  + ►
    [October](https://blog.clamav.net/2019/10/)
    (
    1
    )
  + ►
    [September](https://blog.clamav.net/2019/09/)
    (
    2
    )
  + ►
    [August](https://blog.clamav.net/2019/08/)
    (
    2
    )
  + ►
    [March](https://blog.clamav.net/2019/03/)
    (
    1
    )
  + ►
    [February](https://blog.clamav.net/2019/02/)
    (
    4
    )
  + ►
    [January](https://blog.clamav.net/2019/01/)
    (
    1
    )

* ►
  [2018](https://blog.clamav.net/2018/)
  (
  21
  )
  + ►
    [December](https://blog.clamav.net/2018/12/)
    (
    2
    )
  + ►
    [November](https://blog.clamav.net/2018/11/)
    (
    1
    )
  + ►
    [October](https://blog.clamav.net/2018/10/)
    (
    2
    )
  + ►
    [September](https://blog.clamav.net/2018/09/)
    (
    2
    )
  + ►
    [July](https://blog.clamav.net/2018/07/)
    (
    2
    )
  + ►
    [April](https://blog.clamav.net/2018/04/)
    (
    2
    )
  + ►
    [March](https://blog.clamav.net/2018/03/)
    (
    4
    )
  + ►
    [February](https://blog.clamav.net/2018/02/)
    (
    2
    )
  + ►
    [January](https://blog.clamav.net/2018/01/)
    (
    4
    )

* ►
  [2017](https://blog.clamav.net/2017/)
  (
  11
  )
  + ►
    [December](https://blog.clamav.net/2017/12/)
    (
    1
    )
  + ►
    [November](https://blog.clamav.net/2017/11/)
    (
    1
    )
  + ►
    [October](https://blog.clamav.net/2017/10/)
    (
    1
    )
  + ►
    [September](https://blog.clamav.net/2017/09/)
    (
    1
    )
  + ►
    [August](https://blog.clamav.net/2017/08/)
    (
    2
    )
  + ►
    [June](https://blog.clamav.net/2017/06/)
    (
    2
    )
  + ►
    [May](https://blog.clamav.net/2017/05/)
    (
    1
    )
  + ►
    [February](https://blog.clamav.net/2017/02/)
    (
    2
    )

* ►
  [2016](https://blog.clamav.net/2016/)
  (
  23
  )
  + ►
    [December](https://blog.clamav.net/2016/12/)
    (
    1
    )
  + ►
    [November](https://blog.clamav.net/2016/11/)
    (
    2
    )
  + ►
    [October](https://blog.clamav.net/2016/10/)
    (
    1
    )
  + ►
    [August](https://blog.clamav.net/2016/08/)
    (
    2
    )
  + ►
    [July](https://blog.clamav.net/2016/07/)
    (
    2
    )
  + ►
    [June](https://blog.clamav.net/2016/06/)
    (
    4
    )
  + ►
    [May](https://blog.clamav.net/2016/05/)
    (
    3
    )
  + ►
    [April](https://blog.clamav.net/2016/04/)
    (
    1
    )
  + ►
    [March](https://blog.clamav.net/2016/03/)
    (
    6
    )
  + ►
    [February](https://blog.clamav.net/2016/02/)
    (
    1
    )

* ►
  [2015](https://blog.clamav.net/2015/)
  (
  17
  )
  + ►
    [December](https://blog.clamav.net/2015/12/)
    (
    2
    )
  + ►
    [November](https://blog.clamav.net/2015/11/)
    (
    1
    )
  + ►
    [October](https://blog.clamav.net/2015/10/)
    (
    2
    )
  + ►
    [September](https://blog.clamav.net/2015/09/)
    (
    2
    )
  + ►
    [June](https://blog.clamav.net/2015/06/)
    (
    2
    )
  + ►
    [May](https://blog.clamav.net/2015/05/)
    (
    2
    )
  + ►
    [April](https://blog.clamav.net/2015/04/)
    (
    2
    )
  + ►
    [February](https://blog.clamav.net/2015/02/)
    (
    2
    )
  + ►
    [January](https://blog.clamav.net/2015/01/)
    (
    2
    )

* ►
  [2014](https://blog.clamav.net/2014/)
  (
  26
  )
  + ►
    [December](https://blog.clamav.net/2014/12/)
    (
    1
    )
  + ►
    [November](https://blog.clamav.net/2014/11/)
    (
    5
    )
  + ►
    [October](https://blog.clamav.net/2014/10/)
    (
    1
    )
  + ►
    [August](https://blog.clamav.net/2014/08/)
    (
    1
    )
  + ►
    [July](https://blog.clamav.net/2014/07/)
    (
    3
    )
  + ►
    [June](https://blog.clamav.net/2014/06/)
    (
    1
    )
  + ►
    [May](https://blog.clamav.net/2014/05/)
    (
    2
    )
  + ►
    [April](https://blog.clamav.net/2014/04/)
    (
    1
    )
  + ►
    [March](https://blog.clamav.net/2014/03/)
    (
    2
    )
  + ►
    [February](https://blog.clamav.net/2014/02/)
    (
    7
    )
  + ►
    [January](https://blog.clamav.net/2014/01/)
    (
    2
    )

* ►
  [2013](https://blog.clamav.net/2013/)
  (
  14
  )
  + ►
    [October](https://blog.clamav.net/2013/10/)
    (
    2
    )
  + ►
    [September](https://blog.clamav.net/2013/09/)
    (
    3
    )
  + ►
    [August](https://blog.clamav.net/2013/08/)
    (
    1
    )
  + ►
    [July](https://blog.clamav.net/2013/07/)
    (
    1
    )
  + ►
    [April](https://blog.clamav.net/2013/04/)
    (
    2
    )
  + ►
    [March](https://blog.clamav.net/2013/03/)
    (
    1
    )
  + ►
    [February](https://blog.clamav.net/2013/02/)
    (
    4
    )

* ►
  [2012](https://blog.clamav.net/2012/)
  (
  18
  )
  + ►
    [November](https://blog.clamav.net/2012/11/)
    (
    1
    )
  + ►
    [October](https://blog.clamav.net/2012/10/)
    (
    1
    )
  + ►
    [September](https://blog.clamav.net/2012/09/)
    (
    4
    )
  + ►
    [July](https://blog.clamav.net/2012/07/)
    (
    1
    )
  + ►
    [June](https://blog.clamav.net/2012/06/)
    (
    4
    )
  + ►
    [May](https://blog.clamav.net/2012/05/)
    (
    2
    )
  + ►
    [April](https://blog.clamav.net/2012/04/)
    (
    1
    )
  + ►
    [March](https://blog.clamav.net/2012/03/)
    (
    2
    )
  + ►
    [February](https://blog.clamav.net/2012/02/)
    (
    1
    )
  + ►
    [January](https://blog.clamav.net/2012/01/)
    (
    1
    )

* ►
  [2011](https://blog.clamav.net/2011/)
  (
  25
  )
  + ►
    [December](https://blog.clamav.net/2011/12/)
    (
    1
    )
  + ►
    [November](https://blog.clamav.net/2011/11/)
    (
    1
    )
  + ►
    [October](https://blog.clamav.net/2011/10/)
    (
    2
    )
  + ►
    [August](https://blog.clamav.net/2011/08/)
    (
    2
    )
  + ►
    [July](https://blog.clamav.net/2011/07/)
    (
    2
    )
  + ►
    [June](https://blog.clamav.net/2011/06/)
    (
    1
    )
  + ►
    [May](https://blog.clamav.net/2011/05/)
    (
    1
    )
  + ►
    [April](https://blog.clamav.net/2011/04/)
    (
    1
    )
  + ►
    [March](https://blog.clamav.net/2011/03/)
    (
    3
    )
  + ►
    [February](https://blog.clamav.net/2011/02/)
    (
    6
    )
  + ►
    [January](https://blog.clamav.net/2011/01/)
    (
    5
    )

* ►
  [2009](https://blog.clamav.net/2009/)
  (
  1
  )
  + ►
    [January](https://blog.clamav.net/2009/01/)
    (
    1
    )

* ►
  [2008](https://blog.clamav.net/2008/)
  (
  1
  )
  + ►
    [December](https://blog.clamav.net/2008/12/)
    (
    1
    )

## Contributors

* [Alain Zidouemba](https://www.blogger.com/profile/08018656034778839583)
* [Brendan](https://www.blogger.com/profile/17505287100145023211)
* [Katherine Hill](https://www.blogger.com/profile/18355509675214744005)
* [MTaylor](https://www.blogger.com/profile/15937730432214868150)
* [Micah Snyder](https://www.blogger.com/profile/07798916006145826441)
* [Nick Herbert](https://www.blogger.com/profile/09275310733891410086)
* [Prasanth Bondalapati](https://www.blogger.com/profile/11063125019563603806)
* [Twillowkins](https://www.blogger.com/profile/11855722994118441179)

|  |  |
| --- | --- |

©2004 - 2018 Cisco and/or its affiliates. All rights reserved.
. Powered by [Blogger](https://www.blogger.com).

