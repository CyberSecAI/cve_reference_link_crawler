=== Content from sorcery.ie_0006903b_20250111_162728.html ===


Toggle navigation

[Sorcery | Cyber Security and Software Services](#home)

* [Blog](https://blog.sorcery.ie)
* [Services](#services)
* [Contact](#contact)

# Sorcery

### Cyber Security and Software Services

---

* [email](/cdn-cgi/l/email-protection#88e1e6eee7c8fbe7faebedfaf1a6e1ed)
* [twitter](https://twitter.com/SorceryIE)
* [github](https://github.com/SorceryIE)
* [trustpilot](https://www.trustpilot.com/review/sorcery.ie)

## Penetration Testing

We provide website pentesting services.
Businesses face a growing threat of being hacked. Every year cyber attacks cost trillions of dollars worldwide.
Make sure you aren’t a victim by finding your security issues before they do.

What does our pentest entail?

* Automated scanning of your websites and infrastructure
* Manual vulnerability testing
* Test logins for common and reused passwords

Services we do **NOT** provide:

* Phishing / social engineering engagements
* Malware attacks
* DDoS / network stress testing

For pricing please contact us. We can make proposals based on your specific needs.

![](img/services/hacker.webp)

## Software Development

We offer software development services in a variety of fields.

We can make utility tools, bugfixes, features on existing projects, data scrapers.

Contact us with your project/problem and we will give you a quotation and time estimate.

Experience with Python, Golang, Java, PHP, SQL, Bash, etc.

We do not offer frontend web development services.

Please read the [blog](https://blog.sorcery.ie) or check out the [github](https://github.com/SorceryIE) for examples of our work.

![](img/services/code.webp)

## Incident Response

Victim of a hack?

We can help secure your systems, find the point of entry, remove backdoors and help evict the hacker.

Where possible we can also attempt to identify the attacker.

Contact us for more information.

![](img/services/keyhole_man_clearly_IR_related.webp)

## Keep in Touch:

* [email](/cdn-cgi/l/email-protection#1e777078715e6d716c7d7b6c6730777b)
* [twitter](https://twitter.com/SorceryIE)
* [github](https://github.com/SorceryIE)

* [Home](#home)
* ⋅
* [Blog](https://blog.sorcery.ie)
* ⋅
* [Services](#services)
* ⋅
* [Contact](#contact)

Copyright © 2023 Sorcery Ltd. All Rights Reserved.



=== Content from blog.sorcery.ie_d203a2f3_20250111_162727.html ===

[Skip to main content](#main)
# [Sorcery Blog](/)

[Sorcery Ltd](https://sorcery.ie "Sorcery Ltd")

# SQLi in SimpleImportProduct Prestashop Module CVE-2023-39675

This blog post details an SQL Injection we found within SimpleImportProduct, a Prestashop module developed by [MyPrestaModules](https://myprestamodules.com).
In `modules/simpleimportproduct/send.php` there is the following code:

```
  if ( Tools::getValue('remove') == true){
    $key = Tools::getValue('key');
    $key = pSQL($key);
    Db::getInstance()->delete('simpleimport_tasks', "import_settings=$key");

```

This is vulnerable to SQL injection which allows an attacker to extract data from the database.

The `key` parameter does get sanitized by `pSQL()` but when it’s put in the query it’s not surrounded by quotes so an attacker can still manipulate the query. This is a similar situation to an [SQLi I found in a different Prestashop module](http://localhost:1313/posts/smartblog_sqli/).

Adding quotes around the key would be sufficient to patch this SQLi:

```
Db::getInstance()->delete('simpleimport_tasks', "import_settings='$key'");

```
# Proof of Concept

To test this we used SQLmap on a local Prestashop install.
Care should be taken when testing for this as it is within a DELETE SQL query and can result in records getting deleted.
SQLMap command:

```
sqlmap -u "http://localhost:8080/modules/simpleimportproduct/send.php?ajax=true&remove=true&key=1*" --threads=10 --random-agent --dbms=mysql --level=5 --risk=3 --tables

```

It’s a “blind” SQLi as it doesnt affect the contents of the page so information is extracted using SLEEP() to change the time it takes to respond.

# Timeline

| Date | Action |
| --- | --- |
| 10/07/2023 | Issue discovered during a pentest |
| 12/07/2023 | Reported issue to MyPrestaModules |
| 29/07/2023 | Requested CVE from MITRE |
| ??/08/2023 | Patch released |
| 28/08/2023 | Number [CVE-2023-39675](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-39675) assigned |
| 07/09/2023 | Blog post released |

[2023-09-08](/posts/simpleimportproduct_sqli/)

<https://blog.sorcery.ie/posts/simpleimportproduct_sqli/>
[Sorcery Ltd](https://blog.sorcery.ie/)

* [#Simpleimportproduct](https://blog.sorcery.ie/tags/simpleimportproduct/)
* [#Myprestamodules](https://blog.sorcery.ie/tags/myprestamodules/)
* [#Prestashop](https://blog.sorcery.ie/tags/prestashop/)
* [#Sqli](https://blog.sorcery.ie/tags/sqli/)
* [#CVE-2023-39675](https://blog.sorcery.ie/tags/cve-2023-39675/)

[PHPInfo Exposure in MyPrestaModules Modules CVE-2023-39677](/posts/myprestamodules_phpinfo/)

[XSS in FieldPopupNewsletter Prestashop Module CVE-2023-39676](/posts/fieldpopupnewsletter_xss/)

© Sorcery Ltd, 2024

Powered by [Hugo](https://gohugo.io/), theme [Anubis](https://github.com/mitrichius/hugo-theme-anubis).

Dark theme

[Sorcery Ltd](https://blog.sorcery.ie/)


