

[HashiCorp Discuss](/)

# [HCSEC-2024-24 - Consul Vulnerable To Reflected XSS On Content-Type Error Manipulation](/t/hcsec-2024-24-consul-vulnerable-to-reflected-xss-on-content-type-error-manipulation/71037)

[Security](/c/security/52)

[security-consul](https://discuss.hashicorp.com/tag/security-consul)

[dduzgun-security](https://discuss.hashicorp.com/u/dduzgun-security)

October 30, 2024, 9:18pm

1

**Bulletin ID:** HCSEC-2024-24

**Affected Products / Versions:**

Consul Community Edition from 1.4.1 up to 1.19.2; fixed in 1.20.0.

Consul Enterprise from 1.4.1 up to 1.19.2, 1.18.4, 1.15.14; fixed in 1.20.0, 1.19.3, 1.18.5, and 1.15.15.

**Publication Date:** October 30, 2024

**Summary**

A vulnerability was identified in Consul and Consul Enterprise such that the server response did not explicitly set a `Content-Type` HTTP header, allowing user-provided inputs to be misinterpreted and lead to reflected XSS. This vulnerability, identified as CVE-2024-10086, is fixed in Consul Community Edition 1.20.0 and Consul Enterprise 1.20.0, 1.19.3, 1.18.5, and 1.15.15.

**Background**

Consul provides an HTTP server, using Go’s [net/http package](https://pkg.go.dev/net/http), from which the Consul [API](https://developer.hashicorp.com/consul/api-docs) and [web UI](https://developer.hashicorp.com/consul/tutorials/archive/get-started-explore-the-ui) are served.

When the [Content-Type HTTP header](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Type) is not explicitly set in an HTTP response, Go’s net/http attempts to [guess and set the Content-Type](https://cs.opensource.google/go/go/%2B/master%3Asrc/net/http/fs.go;l=288;drc=959b3fd4265d7e4efb18af454cd18799ed70b8fe?q=DetectContentType&ss=go%2Fgo:src%2Fnet%2Fhttp%2F) of the HTTP response based on the HTTP request body content value.

**Details**

The Consul HTTP server response did not explicitly specify a Content-Type header, which allowed user-provided inputs to be interpreted as a different content-type. This vulnerability can be exploited by attackers to perform reflected XSS attacks, leading to potential account takeovers.

**Remediation**

Customers should evaluate the risk associated with this issue and consider upgrading to Consul 1.20.0, 1.19.3, 1.18.5, 1.15.15 or newer.

Please refer to [Upgrading Consul](https://developer.hashicorp.com/consul/docs/upgrading) for general guidance and version-specific upgrade notes.

**Acknowledgement**

This issue was identified by HashiCorp‘s external security assessment partner and Consul engineering team.

*We deeply appreciate any effort to coordinate disclosure of security vulnerabilities. For information about security at HashiCorp and the reporting of security vulnerabilities, please see <https://hashicorp.com/security>.*

### Related topics

| Topic |  | Replies | Views | Activity |
| --- | --- | --- | --- | --- |
| [HCSEC-2024-23 - Consul L7 Intentions Vulnerable To Headers Bypass](https://discuss.hashicorp.com/t/hcsec-2024-23-consul-l7-intentions-vulnerable-to-headers-bypass/71036)  [Security](/c/security/52) [security-consul](https://discuss.hashicorp.com/tag/security-consul) | 0 | 763 | October 30, 2024 |
| [HCSEC-2021-07 - Consul API KV Endpoint Vulnerable to Cross-Site Scripting](https://discuss.hashicorp.com/t/hcsec-2021-07-consul-api-kv-endpoint-vulnerable-to-cross-site-scripting/23368)  [Security](/c/security/52) [security-consul](https://discuss.hashicorp.com/tag/security-consul) | 0 | 9004 | April 19, 2021 |
| [HCSEC-2021-08 - Consul Enterprise Audit Log Bypass for HTTP Events](https://discuss.hashicorp.com/t/hcsec-2021-08-consul-enterprise-audit-log-bypass-for-http-events/23369)  [Security](/c/security/52) [security-consul](https://discuss.hashicorp.com/tag/security-consul) | 0 | 7569 | April 19, 2021 |
| [HCSEC-2021-17 - Consul’s Envoy TLS Configuration Did Not Validate Destination Service Subject Alternative Names](https://discuss.hashicorp.com/t/hcsec-2021-17-consul-s-envoy-tls-configuration-did-not-validate-destination-service-subject-alternative-names/26856)  [Security](/c/security/52) [security-consul](https://discuss.hashicorp.com/tag/security-consul) | 0 | 7739 | July 15, 2021 |
| [HCSEC-2022-10 - Consul’s HTTP Health Check May Allow Server Side Request Forgery](https://discuss.hashicorp.com/t/hcsec-2022-10-consul-s-http-health-check-may-allow-server-side-request-forgery/38393)  [Security](/c/security/52) [security-consul](https://discuss.hashicorp.com/tag/security-consul) | 0 | 10663 | April 15, 2022 |

* [Home](/)
* [Categories](/categories)
* [Guidelines](/guidelines)
* [Terms of Service](/tos)
* [Privacy Policy](https://meta.discourse.org/privacy)

Powered by [Discourse](https://www.discourse.org), best viewed with JavaScript enabled

