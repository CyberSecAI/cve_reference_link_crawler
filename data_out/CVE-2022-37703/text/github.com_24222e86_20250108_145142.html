
[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fzmanda%2Famanda%2Fissues%2F192)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fzmanda%2Famanda%2Fissues%2F192)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=zmanda%2Famanda)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[zmanda](/zmanda)
/
**[amanda](/zmanda/amanda)**
Public

* [Notifications](/login?return_to=%2Fzmanda%2Famanda) You must be signed in to change notification settings
* [Fork
  109](/login?return_to=%2Fzmanda%2Famanda)
* [Star
   233](/login?return_to=%2Fzmanda%2Famanda)

* [Code](/zmanda/amanda)
* [Issues
  58](/zmanda/amanda/issues)
* [Pull requests
  23](/zmanda/amanda/pulls)
* [Actions](/zmanda/amanda/actions)
* [Projects
  0](/zmanda/amanda/projects)
* [Security](/zmanda/amanda/security)
* [Insights](/zmanda/amanda/pulse)

Additional navigation options

* [Code](/zmanda/amanda)
* [Issues](/zmanda/amanda/issues)
* [Pull requests](/zmanda/amanda/pulls)
* [Actions](/zmanda/amanda/actions)
* [Projects](/zmanda/amanda/projects)
* [Security](/zmanda/amanda/security)
* [Insights](/zmanda/amanda/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fzmanda%2Famanda%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fzmanda%2Famanda%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# CVE-2022-37703 - directory existence disclosure via SUID calcsize binary #192

Closed

[ajakk](/ajakk) opened this issue
Sep 26, 2022
· 9 comments

Closed

# [CVE-2022-37703 - directory existence disclosure via SUID calcsize binary](#top) #192

[ajakk](/ajakk) opened this issue
Sep 26, 2022
· 9 comments

## Comments

[![@ajakk](https://avatars.githubusercontent.com/u/29188917?s=80&u=91af6311cbe2c838b9240b9b7afd099d1116d93b&v=4)](/ajakk)

Copy link

### **[ajakk](/ajakk)** commented [Sep 26, 2022](#issue-1386313820) • edited Loading

| The researcher that requested this CVE hasn't seemed to actually report to Amanda upstream, so I'm reproducing the report here to hopefully get it fixed. The [CVE's](https://nvd.nist.gov/vuln/detail/CVE-2022-37703) description:  "In Amanda 3.5.1, an information leak vulnerability was found in the calcsize SUID binary. An attacker can abuse this vulnerability to know if a directory exists or not anywhere in the fs. The binary will use `opendir()` as root directly without checking the path, letting the attacker provide an arbitrary path."  There's also a tiny bit more information in: <https://github.com/MaherAzzouzi/CVE-2022-37703> Probably most notably, `[Affected Component] Component: calcsize SUID binary. C file: calcsize.c Line: 435 if((d = opendir(dirname)) == NULL) {`.  I tried to convince the researcher to be a bit more responsible and report to upstream, but they eventually deleted the issue where I requested this and told me they'd release 2 local privilege escalation vulnerabilities, but that fortunately doesn't seem to have happened yet. More information on that in [this gist](https://gist.github.com/ajakk/f5aece4564079513f09f6066238ed6aa). |
| --- |
| The text was updated successfully, but these errors were encountered: |

All reactions

[![@vjnpavanraj](https://avatars.githubusercontent.com/u/78919731?s=40&v=4)](/vjnpavanraj)
[vjnpavanraj](/vjnpavanraj)
assigned [vjnpavanraj](/vjnpavanraj) and unassigned [vjnpavanraj](/vjnpavanraj)
[Oct 14, 2022](#event-7589910584)

[![@ajakk](https://avatars.githubusercontent.com/u/29188917?s=80&u=91af6311cbe2c838b9240b9b7afd099d1116d93b&v=4)](/ajakk)

Copy link

Author

### **[ajakk](/ajakk)** commented [Jan 1, 2023](#issuecomment-1368530331)

| These two local privilege escalation vulnerabilities appear to be [CVE-2022-37704](https://github.com/advisories/GHSA-2699-8r69-fq67 "CVE-2022-37704") and [CVE-2022-37705](https://github.com/advisories/GHSA-f6f6-98vp-w8mf "CVE-2022-37705"):  <https://github.com/MaherAzzouzi/CVE-2022-37704> <https://github.com/MaherAzzouzi/CVE-2022-37705> |
| --- |

All reactions

Sorry, something went wrong.

[![@stefangweichinger](https://avatars.githubusercontent.com/u/2673904?s=80&u=ea32de2bd2964698beae43e05d61427ad6a4fc96&v=4)](/stefangweichinger)

Copy link

Contributor

### **[stefangweichinger](/stefangweichinger)** commented [Jan 22, 2023](#issuecomment-1399428258)

| Do I understand correctly that this has not yet been reported to Betsol, the current owner of the amanda code? |
| --- |

All reactions

Sorry, something went wrong.

[![@stefangweichinger](https://avatars.githubusercontent.com/u/2673904?s=80&u=ea32de2bd2964698beae43e05d61427ad6a4fc96&v=4)](/stefangweichinger)

Copy link

Contributor

### **[stefangweichinger](/stefangweichinger)** commented [Jan 22, 2023](#issuecomment-1399429277)

| I just posted it to the 2 main amanda mailing-lists for a start. Unfortunately the project is poorly maintained in the last years. Thanks for your reporting. |
| --- |

All reactions

Sorry, something went wrong.

[![@ajakk](https://avatars.githubusercontent.com/u/29188917?s=80&u=91af6311cbe2c838b9240b9b7afd099d1116d93b&v=4)](/ajakk)

Copy link

Author

### **[ajakk](/ajakk)** commented [Jan 23, 2023](#issuecomment-1399650313)

| Do I understand correctly that this has not yet been reported to Betsol, the current owner of the amanda code?  The original "researcher" didn't originally attempt to report to upstream, no. They deleted my issue asking them to after they weren't able to figure out how to send to the mailing lists. I haven't done anything but report them here, though I wasn't aware that this might not be the best place to report them.  I just posted it to the 2 main amanda mailing-lists for a start. Unfortunately the project is poorly maintained in the last years. Thanks for your reporting.  Thank you! For any other observers, those mails seem to be the following:  <https://marc.info/?l=amanda-hackers&m=167437716918603&w=2> <https://marc.info/?l=amanda-users&m=167437611218333&w=2> |
| --- |

All reactions

Sorry, something went wrong.

[![@vjnpavanraj](https://avatars.githubusercontent.com/u/78919731?s=80&v=4)](/vjnpavanraj)

Copy link

### **[vjnpavanraj](/vjnpavanraj)** commented [Jan 23, 2023](#issuecomment-1400220541) via email

| I have reported the same to the Zmanda product team. We will prioritize these fixes. Meanwhile if any of you can share the possible solutions from your end that would be great. … On Sun, Jan 22, 2023 at 7:10 PM ajakk \*\*\*@\*\*\*.\*\*\*> wrote: Do I understand correctly that this has not yet been reported to Betsol, the current owner of the amanda code? The original "researcher" didn't originally attempt to report to upstream, no. They deleted my issue asking them to after they weren't able to figure out how to send to the mailing lists. I haven't done anything but report them here, though I wasn't aware that this might not be the best place to report them. I just posted it to the 2 main amanda mailing-lists for a start. Unfortunately the project is poorly maintained in the last years. Thanks for your reporting. Thank you! For any other observers, those mails seem to be the following: <https://marc.info/?l=amanda-hackers&m=167437716918603&w=2> <https://marc.info/?l=amanda-users&m=167437611218333&w=2> — Reply to this email directly, view it on GitHub <[#192 (comment)](https://github.com/zmanda/amanda/issues/192#issuecomment-1399650313)>, or unsubscribe <<https://github.com/notifications/unsubscribe-auth/AS2DQM5CBE6OFASJTHOF7V3WTXD6RANCNFSM6AAAAAAQV5YFNQ>> . You are receiving this because you were assigned.Message ID: \*\*\*@\*\*\*.\*\*\*> |
| --- |

All reactions

Sorry, something went wrong.

[![@prajwaltr93](https://avatars.githubusercontent.com/u/37269899?s=40&u=53589987b848023a53b5f45be800819d1cfc6cd6&v=4)](/prajwaltr93)
[prajwaltr93](/prajwaltr93)
mentioned this issue
[Feb 2, 2023](#ref-pullrequest-1567599945)

[Fixes Open Vulnerability CVE-2022-37705
#194](/zmanda/amanda/pull/194)
 Closed

[![@stefangweichinger](https://avatars.githubusercontent.com/u/2673904?s=80&u=ea32de2bd2964698beae43e05d61427ad6a4fc96&v=4)](/stefangweichinger)

Copy link

Contributor

### **[stefangweichinger](/stefangweichinger)** commented [Feb 7, 2023](#issuecomment-1420564459)

| I have reported the same to the Zmanda product team. We will prioritize these fixes. Meanwhile if any of you can share the possible solutions from your end that would be great.  Will there be a new release of amanda with the fixes then? It would be great to see that soon, along some new packages for the distros as well. |
| --- |

All reactions

Sorry, something went wrong.

[![@prajwaltr93](https://avatars.githubusercontent.com/u/37269899?s=40&u=53589987b848023a53b5f45be800819d1cfc6cd6&v=4)](/prajwaltr93)
[prajwaltr93](/prajwaltr93)
mentioned this issue
[Feb 10, 2023](#ref-pullrequest-1579146075)

[Fixes Open Vulnerability CVE-2022-37705
#196](/zmanda/amanda/pull/196)
 Merged

[![@vjnpavanraj](https://avatars.githubusercontent.com/u/78919731?s=80&v=4)](/vjnpavanraj)

Copy link

### **[vjnpavanraj](/vjnpavanraj)** commented [Feb 12, 2023](#issuecomment-1427097294) via email

| The fixes have been merged with community code base. Right now, looking at the new release with the fixes. Post that we will look at the distro specific packages. … On Tue, Feb 7, 2023 at 5:44 AM Stefan G. Weichinger < \*\*\*@\*\*\*.\*\*\*> wrote: I have reported the same to the Zmanda product team. We will prioritize these fixes. Meanwhile if any of you can share the possible solutions from your end that would be great. Will there be a new release of amanda with the fixes then? It would be great to see that soon, along some new packages for the distros as well. — Reply to this email directly, view it on GitHub <[#192 (comment)](https://github.com/zmanda/amanda/issues/192#issuecomment-1420564459)>, or unsubscribe <<https://github.com/notifications/unsubscribe-auth/AS2DQMZKC2LAAXS3RFPO7ULWWIRQ3ANCNFSM6AAAAAAQV5YFNQ>> . You are receiving this because you were assigned.Message ID: \*\*\*@\*\*\*.\*\*\*> |
| --- |

All reactions

Sorry, something went wrong.

[![@ajakk](https://avatars.githubusercontent.com/u/29188917?s=80&u=91af6311cbe2c838b9240b9b7afd099d1116d93b&v=4)](/ajakk)

Copy link

Author

### **[ajakk](/ajakk)** commented [Feb 18, 2023](#issuecomment-1435794310)

| According to <https://marc.info/?l=amanda-users&m=167628405416862&w=2>, there's PRs for fixes:  [CVE-2022-37703](https://github.com/advisories/GHSA-j9rc-2hv9-v5v8 "CVE-2022-37703"): [#198](https://github.com/zmanda/amanda/pull/198) [CVE-2022-37704](https://github.com/advisories/GHSA-2699-8r69-fq67 "CVE-2022-37704"): [#197](https://github.com/zmanda/amanda/pull/197)  And those have linked commits:  [cf01041](https://github.com/zmanda/amanda/commit/cf01041d34b830fc8bfe87346a9a1aa092d76820) [ee766ef](https://github.com/zmanda/amanda/commit/ee766efdd77acd2e08f646bf2f9028944cdb9d06) |
| --- |

All reactions

Sorry, something went wrong.

[![@prajwaltr93](https://avatars.githubusercontent.com/u/37269899?s=80&u=53589987b848023a53b5f45be800819d1cfc6cd6&v=4)](/prajwaltr93)

Copy link

Contributor

### **[prajwaltr93](/prajwaltr93)** commented [May 4, 2023](#issuecomment-1534554184)

| looks like this was fixed as part of PR raise on [#198](https://github.com/zmanda/amanda/pull/198) |
| --- |

All reactions

Sorry, something went wrong.

[![@prajwaltr93](https://avatars.githubusercontent.com/u/37269899?s=40&u=53589987b848023a53b5f45be800819d1cfc6cd6&v=4)](/prajwaltr93)
[prajwaltr93](/prajwaltr93)
closed this as [completed](/zmanda/amanda/issues?q=is%3Aissue+is%3Aclosed+archived%3Afalse+reason%3Acompleted)
[May 4, 2023](#event-9165910469)

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fzmanda%2Famanda%2Fissues%2F192)

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

No branches or pull requests

4 participants

[![@stefangweichinger](https://avatars.githubusercontent.com/u/2673904?s=52&v=4)](/stefangweichinger) [![@ajakk](https://avatars.githubusercontent.com/u/29188917?s=52&v=4)](/ajakk) [![@prajwaltr93](https://avatars.githubusercontent.com/u/37269899?s=52&v=4)](/prajwaltr93) [![@vjnpavanraj](https://avatars.githubusercontent.com/u/78919731?s=52&v=4)](/vjnpavanraj)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.

