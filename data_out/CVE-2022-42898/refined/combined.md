=== Content from github.com_89210042_20250108_124414.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fkrb5%2Fkrb5%2Fcommit%2Fea92d2f0fcceb54a70910fa32e9a0d7a5afc3583)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fkrb5%2Fkrb5%2Fcommit%2Fea92d2f0fcceb54a70910fa32e9a0d7a5afc3583)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=krb5%2Fkrb5)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[krb5](/krb5)
/
**[krb5](/krb5/krb5)**
Public

* [Notifications](/login?return_to=%2Fkrb5%2Fkrb5) You must be signed in to change notification settings
* [Fork
  381](/login?return_to=%2Fkrb5%2Fkrb5)
* [Star
   531](/login?return_to=%2Fkrb5%2Fkrb5)

* [Code](/krb5/krb5)
* [Pull requests
  34](/krb5/krb5/pulls)
* [Actions](/krb5/krb5/actions)
* [Projects
  0](/krb5/krb5/projects)
* [Security](/krb5/krb5/security)
* [Insights](/krb5/krb5/pulse)

Additional navigation options

* [Code](/krb5/krb5)
* [Pull requests](/krb5/krb5/pulls)
* [Actions](/krb5/krb5/actions)
* [Projects](/krb5/krb5/projects)
* [Security](/krb5/krb5/security)
* [Insights](/krb5/krb5/pulse)

## Commit

[Permalink](/krb5/krb5/commit/ea92d2f0fcceb54a70910fa32e9a0d7a5afc3583)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Fix integer overflows in PAC parsing

[Browse files](/krb5/krb5/tree/ea92d2f0fcceb54a70910fa32e9a0d7a5afc3583)
Browse the repository at this point in the history

```
In krb5_parse_pac(), check for buffer counts large enough to threaten
integer overflow in the header length and memory length calculations.
Avoid potential integer overflows when checking the length of each
buffer.  Credit to OSS-Fuzz for discovering one of the issues.

CVE-2022-42898:

In MIT krb5 releases 1.8 and later, an authenticated attacker may be
able to cause a KDC or kadmind process to crash by reading beyond the
bounds of allocated memory, creating a denial of service.  A
privileged attacker may similarly be able to cause a Kerberos or GSS
application service to crash.  On 32-bit platforms, an attacker can
also cause insufficient memory to be allocated for the result,
potentially leading to remote code execution in a KDC, kadmind, or GSS
or Kerberos application server process.  An attacker with the
privileges of a cross-realm KDC may be able to extract secrets from a
KDC process's memory by having them copied into the PAC of a new
ticket.

ticket: 9074 (new)
tags: pullup
target_version: 1.20-next
target_version: 1.19-next
```

* Loading branch information

[![@greghudson](https://avatars.githubusercontent.com/u/1131421?s=40&v=4)](/greghudson)

[greghudson](/krb5/krb5/commits?author=greghudson "View all commits by greghudson")
committed
Nov 3, 2022

1 parent
[fa62bd3](/krb5/krb5/commit/fa62bd33a0c0889c083999c0289ffa81a5d51e7b)

commit ea92d2f

 Show file tree

 Hide file tree

Showing
**2 changed files**
with
**25 additions**
and
**2 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* src/lib/krb5/krb

  + src/lib/krb5/krb/pac.c
    [pac.c](#diff-3d55ac988ef62053c69e7250eee0396116679f0d1327cc441c8d8f20501700b4)
  + src/lib/krb5/krb/t\_pac.c
    [t\_pac.c](#diff-0daa348b9e0dd4899e6acb1468c79c56a01a6cd8a871a03e1080197ff90e4237)

## There are no files selected for viewing

9 changes: 7 additions & 2 deletions

9
[src/lib/krb5/krb/pac.c](#diff-3d55ac988ef62053c69e7250eee0396116679f0d1327cc441c8d8f20501700b4 "src/lib/krb5/krb/pac.c")

Show comments

[View file](/krb5/krb5/blob/ea92d2f0fcceb54a70910fa32e9a0d7a5afc3583/src/lib/krb5/krb/pac.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -28,6 +28,8 @@ |
|  |  | #include "int-proto.h" |
|  |  | #include "authdata.h" |
|  |  |  |
|  |  | #define MAX\_BUFFERS 4096 |
|  |  |  |
|  |  | /\* draft-brezak-win2k-krb-authz-00 \*/ |
|  |  |  |
|  |  | /\* |
| Expand Down  Expand Up | | @@ -317,6 +319,9 @@ krb5\_pac\_parse(krb5\_context context, |
|  |  | if (version != 0) |
|  |  | return EINVAL; |
|  |  |  |
|  |  | if (cbuffers < 1 || cbuffers > MAX\_BUFFERS) |
|  |  | return ERANGE; |
|  |  |  |
|  |  | header\_len = PACTYPE\_LENGTH + (cbuffers \* PAC\_INFO\_BUFFER\_LENGTH); |
|  |  | if (len < header\_len) |
|  |  | return ERANGE; |
| Expand Down  Expand Up | | @@ -349,8 +354,8 @@ krb5\_pac\_parse(krb5\_context context, |
|  |  | krb5\_pac\_free(context, pac); |
|  |  | return EINVAL; |
|  |  | } |
|  |  | if (buffer->Offset < header\_len || |
|  |  | buffer->Offset + buffer->cbBufferSize > len) { |
|  |  | if (buffer->Offset < header\_len || buffer->Offset > len || |
|  |  | buffer->cbBufferSize > len - buffer->Offset) { |
|  |  | krb5\_pac\_free(context, pac); |
|  |  | return ERANGE; |
|  |  | } |
| Expand Down | |  |

18 changes: 18 additions & 0 deletions

18
[src/lib/krb5/krb/t\_pac.c](#diff-0daa348b9e0dd4899e6acb1468c79c56a01a6cd8a871a03e1080197ff90e4237 "src/lib/krb5/krb/t_pac.c")

Show comments

[View file](/krb5/krb5/blob/ea92d2f0fcceb54a70910fa32e9a0d7a5afc3583/src/lib/krb5/krb/t_pac.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -431,6 +431,16 @@ static const unsigned char s4u\_pac\_ent\_xrealm[] = { |
|  |  | 0x8a, 0x81, 0x9c, 0x9c, 0x00, 0x00, 0x00, 0x00 |
|  |  | }; |
|  |  |  |
|  |  | static const unsigned char fuzz1[] = { |
|  |  | 0x00, 0x00, 0x00, 0x10, 0x00, 0x00, 0x00, 0x00, |
|  |  | 0x06, 0xff, 0xff, 0xff, 0x00, 0x00, 0xf5 |
|  |  | }; |
|  |  |  |
|  |  | static const unsigned char fuzz2[] = { |
|  |  | 0x00, 0x00, 0x00, 0x20, 0x00, 0x00, 0x00, 0x00, |
|  |  | 0x20, 0x20 |
|  |  | }; |
|  |  |  |
|  |  | static const char \*s4u\_principal = "w2k8u@ACME.COM"; |
|  |  | static const char \*s4u\_enterprise = "w2k8u@abc@ACME.COM"; |
|  |  |  |
| Expand Down  Expand Up | | @@ -828,6 +838,14 @@ main(int argc, char \*\*argv) |
|  |  | krb5\_free\_principal(context, sep); |
|  |  | } |
|  |  |  |
|  |  | /\* Check problematic PACs found by fuzzing. \*/ |
|  |  | ret = krb5\_pac\_parse(context, fuzz1, sizeof(fuzz1), &pac); |
|  |  | if (!ret) |
|  |  | err(context, ret, "krb5\_pac\_parse should have failed"); |
|  |  | ret = krb5\_pac\_parse(context, fuzz2, sizeof(fuzz2), &pac); |
|  |  | if (!ret) |
|  |  | err(context, ret, "krb5\_pac\_parse should have failed"); |
|  |  |  |
|  |  | /\* |
|  |  | \* Test empty free |
|  |  | \*/ |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `ea92d2f`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fkrb5%2Fkrb5%2Fcommit%2Fea92d2f0fcceb54a70910fa32e9a0d7a5afc3583) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from web.mit.edu_01f7f53e_20250108_124416.html ===

# Kerberos Security Advisories

[MITKRB5-SA-2015-001](MITKRB5-SA-2015-001.txt)
Vulnerabilities in kadmind, libgssrpc, gss\_process\_context\_token
[MITKRB5-SA-2014-001](MITKRB5-SA-2014-001.txt)
Buffer overrun in kadmind with LDAP backend
[MITKRB5-SA-2012-001](MITKRB5-SA-2012-001.txt)
KDC heap corruption and crash vulnerabilities
[MITKRB5-SA-2011-008](MITKRB5-SA-2011-008.txt)
buffer overflow in telnet daemon and client
[MITKRB5-SA-2011-007](MITKRB5-SA-2011-007.txt)
KDC null pointer dereference in TGS handling
[MITKRB5-SA-2011-006](MITKRB5-SA-2011-006.txt)
KDC denial of service vulnerabilities
[MITKRB5-SA-2011-005](MITKRB5-SA-2011-005.txt)
FTP daemon fails to set effective group ID
[MITKRB5-SA-2011-004](MITKRB5-SA-2011-004.txt)
kadmind invalid pointer free()
[MITKRB5-SA-2011-003](MITKRB5-SA-2011-003.txt)
KDC vulnerable to double-free when PKINIT enabled
[MITKRB5-SA-2011-002](MITKRB5-SA-2011-002.txt)
KDC denial of service attacks
[MITKRB5-SA-2011-001](MITKRB5-SA-2011-001.txt)
kpropd denial of service
[MITKRB5-SA-2010-007](MITKRB5-SA-2010-007.txt)
Multiple checksum handling vulnerabilities
[MITKRB5-SA-2010-006](MITKRB5-SA-2010-006.txt)
KDC uninitialized pointer crash in authorization data handling
[MITKRB5-SA-2010-005](MITKRB5-SA-2010-005.txt)
GSS-API library null pointer dereference
[MITKRB5-SA-2010-004](MITKRB5-SA-2010-004.txt)
double free in KDC
[MITKRB5-SA-2010-003](MITKRB5-SA-2010-003.txt)
denial of service in kadmind in older krb5 releases
[MITKRB5-SA-2010-002](MITKRB5-SA-2010-002.txt)
denial of service in SPNEGO
[MITKRB5-SA-2010-001](MITKRB5-SA-2010-001.txt)
krb5-1.7 KDC denial of service
[MITKRB5-SA-2009-004](MITKRB5-SA-2009-004.txt)
integer underflow in AES and RC4 decryption
[MITKRB5-SA-2009-003](MITKRB5-SA-2009-003.txt)
KDC denial of service in cross-realm referral processing
[MITKRB5-SA-2009-002](MITKRB5-SA-2009-002.txt)
ASN.1 decoder frees uninitialized pointer
[MITKRB5-SA-2009-001](MITKRB5-SA-2009-001.txt)
multiple vulnerabilities in SPNEGO, ASN.1 decoder
[MITKRB5-SA-2008-002](MITKRB5-SA-2008-002.txt)
array overrun in RPC library used by kadmind
[MITKRB5-SA-2008-001](MITKRB5-SA-2008-001.txt)
double-free, uninitialized data vulnerabilities in krb5kdc
[MITKRB5-SA-2007-006](MITKRB5-SA-2007-006.txt)
kadmind RPC library buffer overflow, uninitialized pointer
[MITKRB5-SA-2007-005](MITKRB5-SA-2007-005.txt)
kadmind vulnerable to buffer overflow
[MITKRB5-SA-2007-004](MITKRB5-SA-2007-004.txt)
kadmind affected by multiple RPC library vulnerabilities
[MITKRB5-SA-2007-003](MITKRB5-SA-2007-003.txt)
double-free vulnerability in kadmind (via GSS-API library)
[MITKRB5-SA-2007-002](MITKRB5-SA-2007-002-syslog.txt)
KDC, kadmind stack overflow in krb5\_klog\_syslog
[MITKRB5-SA-2007-001](MITKRB5-SA-2007-001-telnetd.txt)
telnetd allows login as arbitrary user
[MITKRB5-SA-2006-003](MITKRB5-SA-2006-003-mechglue.txt)
kadmind (via GSS-API mechglue) frees uninitialized pointers
[MITKRB5-SA-2006-002](MITKRB5-SA-2006-002-rpc.txt)
kadmind (via RPC library) calls uninitialized function pointer
[MITKRB5-SA-2006-001](MITKRB5-SA-2006-001-setuid.txt)
multiple local privilege escalation vulnerabilities
[MITKRB5-SA-2005-003](MITKRB5-SA-2005-003-recvauth.txt)
double-free in krb5\_recvauth
[MITKRB5-SA-2005-002](MITKRB5-SA-2005-002-kdc.txt)
buffer overflow, heap corruption in KDC
[MITKRB5-SA-2005-001](MITKRB5-SA-2005-001-telnet.txt)
Buffer overflows in telnet client
[MITKRB5-SA-2004-004](MITKRB5-SA-2004-004-pwhist.txt)
Heap buffer overflow in libkadm5srv
[MITKRB5-SA-2004-003](MITKRB5-SA-2004-003-asn1.txt)
ASN.1 decoder denial-of-service
[MITKRB5-SA-2004-002](MITKRB5-SA-2004-002-dblfree.txt)
Double-free vulnerabilities in KDC and libraries
[MITKRB5-SA-2004-001](MITKRB5-SA-2004-001-an_to_ln.txt)
Buffer overrun in aname\_to\_localname
[MITKRB5-SA-2003-005:](MITKRB5-SA-2003-005-buf.txt)
Buffer overrun and underrun in principal name handling
[MITKRB5-SA-2003-004:](MITKRB5-SA-2003-004-krb4.txt)
Cryptographic weaknesses in Kerberos v4 protocol; KDC and
realm compromise possible.
[MITKRB5-SA-2003-003:](MITKRB5-SA-2003-003-xdr.txt)
Faulty length checks in xdrmem\_getbytes may allow kadmind DoS.
[MITKRB5-SA-2003-001:](MITKRB5-SA-2003-001-multiple.txt)
Multiple vulnerabilities, including possible KDC compromise, in
older releases (prior to 1.2.5).
[MITKRB5-SA-2002-002:](MITKRB5-SA-2002-002-kadm4.txt)
[updated 2002-10-25] Buffer overflow in kadmind4
Remote user can gain root access to KDC host.
[MITKRB5-SA-2002-001:](MITKRB5-SA-2002-001-xdr.txt)
Remote root vulnerability in MIT krb5 admin system
Remote user may be able to gain root access to a KDC host.
[Buffer overflows in telnetd](telnetd.txt)
[Buffer overflows in ftpd](ftpbuf.txt)
[Unsafe temporary file handling in krb4
code](krb4tkt.txt)
A local user may overwrite arbitrary files as root
[Remote root vulnerability in GSSFTPD](ftp.txt)
An attacker with access to a local account may gain
unauthorized root access via a krb5-1.1.x ftpd.
[Multiple denial of service
vulnerabilities in krb4 KDC](krb4kdc.txt)
A buffer overrun capable of causing a denial of service in
the krb4 KDC compat code was discovered. Additionally,
krb5-1.1.x KDCs with krb4 code enabled are vulnerable to a
separate denial of service.
[Buffer Overrun Vulnerabilities in
Kerberos 4 code](krb4buf.txt)
Serious buffer overruns exist in krb4 compatibility code.
Also, these vulnerabilities likely exist in **almost all
implementations** derived from MIT krb4.
[Login bug when compiling using
--without-krb4 in 1.1.1](withoutkrb4.txt)
Compiling remote login programs using the --without-krb4
option has disastrous side effects under 1.1 and 1.1.1
releases.
## MITKRB5-SA-2002-002-kadm4 attack signature

* [Note](2002-002-kadm4_attacksig.txt) describing
  attack signature associated with possible attacks on kadmind4.

## Patches for MITKRB5-SA-2002-002-kadm4

* [patch](2002-002-kadm4_patch.txt) for krb5-1.2.6,
  with [detached PGP
  signature](2002-002-kadm4_patch.txt.asc)

## Patches for MITKRB5-SA-2002-001-xdr

* [patch](2002-001-xdr_array_patch.txt) for
  krb5-1.2.5, with [detached
  PGP signature](2002-001-xdr_array_patch.txt.asc)

## Patches for telnetd buffer overflow vulnerability

* [Patch](telnetd_122_patch.txt) for krb5-1.2.2,
  with [detached PGP
  signature](telnetd_122_patch.txt.asc)

## Patches for ftpd buffer overflow vulnerability

* [Patch for krb5-1.2.2](ftpbuf_122_patch.txt)

## Patches for krb4 temporary file vulnerability

* [Patch for krb5-1.2.1](krb4tkt_121_patch.txt)

## Patches for gssftpd vulnerability

* [Patch for krb5-1.1.x ftpd](ftpd_111_patch.txt)

## Patches for KDC vulnerabilities

* [Patch for krb5-1.0.x
  KDCs](krb4kdc_10x_patch.txt)* [Patch for krb5-1.1.1 KDC](krb4kdc_111_patch.txt)* [Patch for CNS KDC](krb4kdc_cns_patch.txt)* [Untested patch for krb4
        Patch 10](krb4kdc_krb4p10_patch.txt)

## Patches for krb\_rd\_req() overruns:

The patches in some of the krb4 overrun original advisories
have been untabified, which causes some people to have trouble
applying them with the patch program. You may use
"patch -l" if your version of patch supports it, or you
may apply one of the patches below.

* [Patch for krb4 buffer
  overruns in 1.0.x](krb4buf10x_patch.txt)* [Patch for krb4 buffer
    overruns in 1.1.1](krb4buf111_patch.txt) (includes patch for login.c)* [Patch for bug in login.c.](login_c_patch.txt)

---

*$Id: index.html,v 1.46 2016/07/01 17:34:45 ghudson Exp $*

MIT Kerberos
[ [home](http://web.mit.edu/kerberos/) ]
[ [contact](http://web.mit.edu/kerberos/contact.html) ]



=== Content from web.mit.edu_f51c9b76_20250108_124416.html ===

# Kerberos 5 Release 1.19.4

* [Announcement](#announcement)* [README file](README-1.19.4.txt)* [Known Bugs](https://krbdev.mit.edu/rt/NoAuth/krb5-1.19/bugs-1.19.4.html)* [Documentation](doc/index.html)* [Retrieving](#fetching)

## Kerberos 5 Release 1.19.4 is now available

The MIT Kerberos Team announces the availability of the
krb5-1.19.4 release. The [detached PGP
signature](krb5-1.19.4.sig) is available without going through the download
page, if you wish to verify the authenticity of a distribution
you have obtained elsewhere.

Please see the [README file](README-1.19.4.txt) for a
more complete list of changes.

You may also see the current full
[list
of fixed bugs](https://krbdev.mit.edu/rt/NoAuth/krb5-1.19/fixed-1.19.4.html) tracked in our RT bugtracking system.
## Triple-DES transition

Beginning with the krb5-1.19 release, a warning will be issued
if initial credentials are acquired using the des3-cbc-sha1
encryption type. In future releases, this encryption type will
be disabled by default and eventually removed.

Beginning with the krb5-1.18 release, single-DES encryption
types have been removed.
## Major changes in 1.19.4 (2022-11-15)

* Fix integer overflows in PAC parsing [CVE-2022-42898].* Fix memory leak in OTP kdcpreauth module.

## Major changes in 1.19.3 (2022-03-11)

* Fix a denial of service attack against the KDC [CVE-2021-37750].

## Major changes in 1.19.2 (2021-07-22)

* Fix a denial of service attack against the KDC encrypted
  challenge code [CVE-2021-36222].* Fix a memory leak when gss\_inquire\_cred() is called without
    a credential handle.

## Major changes in 1.19.1 (2021-02-18)

* Fix a linking issue with Samba.* Better support multiple pkinit\_identities values by checking
    whether certificates can be loaded for each value.

## Major changes in 1.19 (2021-02-01)

Administrator experience

* When a client keytab is present, the GSSAPI krb5 mech
  will refresh credentials even if the current credentials
  were acquired manually.* It is now harder to accidentally delete the K/M entry from a KDB.

Developer experience

* gss\_acquire\_cred\_from() now supports the "password" and
  "verify" options, allowing credentials to be acquired via
  password and verified using a keytab key.* When an application accepts a GSS security context, the
    new GSS\_C\_CHANNEL\_BOUND\_FLAG will be set if the initiator
    and acceptor both provided matching channel bindings.* Added the GSS\_KRB5\_NT\_X509\_CERT name type, allowing
      S4U2Self requests to identify the desired client principal
      by certificate.* PKINIT certauth modules can now cause the hw-authent
        flag to be set in issued tickets.* The krb5\_init\_creds\_step() API will now issue the same
          password expiration warnings as
          krb5\_get\_init\_creds\_password().

Protocol evolution

* Added client and KDC support for Microsoft's
  Resource-Based Constrained Delegation, which allows
  cross-realm S4U2Proxy requests. A third-party database
  module is required for KDC support.* kadmin/admin is now the preferred server principal name
    for kadmin connections, and the host-based form is no
    longer created by default. The client will still try the
    host-based form as a fallback.* Added client and server support for Microsoft's
      KERB\_AP\_OPTIONS\_CBT extension, which causes channel
      bindings to be required for the initiator if the acceptor
      provided them. The client will send this option if the
      client\_aware\_gss\_bindings profile option is set.

User experience

* kinit will now issue a warning if the des3-cbc-sha1
  encryption type is used in the reply. This encryption
  type will be deprecated and removed in future releases.* Added kvno flags --out-cache, --no-store, and
    --cached-only (inspired by Heimdal's kgetcred).

## Retrieving Kerberos 5 Release 1.19.4

You may retrieve the Kerberos 5 Release 1.19.4 source from
[here](https://kerberos.org/dist/index.html).
If you need to acquire the sources from some other distribution
site, you may verify them against the [detached
PGP signature for krb5-1.19.4](krb5-1.19.4.sig).

---

*$Id: krb5-1.19.4.html,v 1.1 2022/11/15 16:43:50 ghudson Exp $*

MIT Kerberos
[ [home](http://web.mit.edu/kerberos/) ]
[ [contact](http://web.mit.edu/kerberos/contact.html) ]



=== Content from github.com_f7777a47_20250108_153852.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fheimdal%2Fheimdal%2Fpull%2F1025)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fheimdal%2Fheimdal%2Fpull%2F1025)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=heimdal%2Fheimdal)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[heimdal](/heimdal)
/
**[heimdal](/heimdal/heimdal)**
Public

* [Notifications](/login?return_to=%2Fheimdal%2Fheimdal) You must be signed in to change notification settings
* [Fork
  178](/login?return_to=%2Fheimdal%2Fheimdal)
* [Star
   331](/login?return_to=%2Fheimdal%2Fheimdal)

* [Code](/heimdal/heimdal)
* [Issues
  182](/heimdal/heimdal/issues)
* [Pull requests
  73](/heimdal/heimdal/pulls)
* [Discussions](/heimdal/heimdal/discussions)
* [Actions](/heimdal/heimdal/actions)
* [Projects
  0](/heimdal/heimdal/projects)
* [Wiki](/heimdal/heimdal/wiki)
* [Security](/heimdal/heimdal/security)
* [Insights](/heimdal/heimdal/pulse)

Additional navigation options

* [Code](/heimdal/heimdal)
* [Issues](/heimdal/heimdal/issues)
* [Pull requests](/heimdal/heimdal/pulls)
* [Discussions](/heimdal/heimdal/discussions)
* [Actions](/heimdal/heimdal/actions)
* [Projects](/heimdal/heimdal/projects)
* [Wiki](/heimdal/heimdal/wiki)
* [Security](/heimdal/heimdal/security)
* [Insights](/heimdal/heimdal/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fheimdal%2Fheimdal%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fheimdal%2Fheimdal%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# lib/krb5: fix \_krb5\_get\_int64 on 32-bit systems #1025

 Merged

[jaltman](/jaltman)
merged 2 commits into
[master](/heimdal/heimdal/tree/master "heimdal/heimdal:master")
from
[jaltman/\_krb5\_get\_int64-fix](/heimdal/heimdal/tree/jaltman/_krb5_get_int64-fix "heimdal/heimdal:jaltman/_krb5_get_int64-fix")

Nov 16, 2022

 Merged

# [lib/krb5: fix \_krb5\_get\_int64 on 32-bit systems](#top) #1025

[jaltman](/jaltman)
merged 2 commits into
[master](/heimdal/heimdal/tree/master "heimdal/heimdal:master")
from
[jaltman/\_krb5\_get\_int64-fix](/heimdal/heimdal/tree/jaltman/_krb5_get_int64-fix "heimdal/heimdal:jaltman/_krb5_get_int64-fix")

Nov 16, 2022

[Conversation
0](/heimdal/heimdal/pull/1025)
[Commits
2](/heimdal/heimdal/pull/1025/commits)
[Checks
0](/heimdal/heimdal/pull/1025/checks)
[Files changed](/heimdal/heimdal/pull/1025/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![jaltman](https://avatars.githubusercontent.com/u/206466?s=60&v=4)](/jaltman)

Copy link

Member

### @jaltman **[jaltman](/jaltman)** commented [Nov 16, 2022](#issue-1451786369)

On systems where 'unsigned long' is 32-bits and the 'size' parameter is set to 8 and the bytes are:

0x78 0x00 0x00 0x00 0x00 0x00 0x00 0x00

When 'i' becomes 4 'v' will be 0 again. As 'unsigned long' is only able to hold 4 bytes.

Change the type of 'v' from 'unsigned long' to 'uint64\_t' which matches the type of the output parameter 'value'.

Signed-off-by: Stefan Metzmacher metze@samba.org

Reviewed-by: Ralph Boehme slow@samba.org

CVE: CVE-2022-42898

Samba-BUG: <https://bugzilla.samba.org/show_bug.cgi?id=15203>

Sorry, something went wrong.

All reactions

[![@metze-samba](https://avatars.githubusercontent.com/u/17027612?s=40&v=4)](/metze-samba) [![@jaltman](https://avatars.githubusercontent.com/u/206466?s=40&v=4)](/jaltman)

`[lib/krb5: fix _krb5_get_int64 on 32-bit systems](/heimdal/heimdal/pull/1025/commits/c64684945a7f0d4d0060c04b5994c4f3ba352918 "lib/krb5: fix _krb5_get_int64 on 32-bit systems

On systems where 'unsigned long' is 32-bits and the 'size'
parameter is set to 8 and the bytes are:

  0x78 0x00 0x00 0x00 0x00 0x00 0x00 0x00

When 'i' becomes 4 'v' will be 0 again. As 'unsigned long' is only
able to hold 4 bytes.

Change the type of 'v' from 'unsigned long' to 'uint64_t' which
matches the type of the output parameter 'value'.

Signed-off-by: Stefan Metzmacher <metze@samba.org>
Reviewed-by: Ralph Boehme <slow@samba.org>
CVE: CVE-2022-42898
Samba-BUG: https://bugzilla.samba.org/show_bug.cgi?id=15203")`
 …

`[c646849](/heimdal/heimdal/pull/1025/commits/c64684945a7f0d4d0060c04b5994c4f3ba352918)`

```
On systems where 'unsigned long' is 32-bits and the 'size'
parameter is set to 8 and the bytes are:

  0x78 0x00 0x00 0x00 0x00 0x00 0x00 0x00

When 'i' becomes 4 'v' will be 0 again. As 'unsigned long' is only
able to hold 4 bytes.

Change the type of 'v' from 'unsigned long' to 'uint64_t' which
matches the type of the output parameter 'value'.

Signed-off-by: Stefan Metzmacher <metze@samba.org>
Reviewed-by: Ralph Boehme <slow@samba.org>
CVE: CVE-2022-42898
Samba-BUG: <https://bugzilla.samba.org/show_bug.cgi?id=15203>
```

[![@jaltman](https://avatars.githubusercontent.com/u/206466?s=40&v=4)](/jaltman)
[jaltman](/jaltman)
mentioned this pull request
[Nov 16, 2022](#ref-pullrequest-1451774852)

[CVE-2022-42898: lib/krb5: fix \_krb5\_get\_int64 on systems where 'unsigned long' is just 32-bit
#1024](/heimdal/heimdal/pull/1024)
 Closed

[![@jaltman](https://avatars.githubusercontent.com/u/206466?s=40&v=4)](/jaltman)

`[lib/asn1: free_type fix HEIM_FALLTHROUGH usage](/heimdal/heimdal/pull/1025/commits/f780ae31c37e6af8da3b1be50acb992d4b34ac45 "lib/asn1: free_type fix HEIM_FALLTHROUGH usage

To function HEIM_FALLTHROUGH should not be embedded in a comment.")`
 …

`[f780ae3](/heimdal/heimdal/pull/1025/commits/f780ae31c37e6af8da3b1be50acb992d4b34ac45)`

```
To function HEIM_FALLTHROUGH should not be embedded in a comment.
```

[![@jaltman](https://avatars.githubusercontent.com/u/206466?s=40&v=4)](/jaltman)
[jaltman](/jaltman)
merged commit [`a9fca33`](/heimdal/heimdal/commit/a9fca332da0f71cc3ad2d551ebbd0d08181ae4a4)
into
master

[Nov 16, 2022](https://github.com/heimdal/heimdal/pull/1025#event-7826308522)

 [![@jaltman](https://avatars.githubusercontent.com/u/206466?s=40&v=4)](/jaltman)
[jaltman](/jaltman)
deleted the
jaltman/\_krb5\_get\_int64-fix

branch
[November 16, 2022 17:23](#event-7826309355)

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fheimdal%2Fheimdal%2Fpull%2F1025)

Reviewers

No reviews

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

Successfully merging this pull request may close these issues.

2 participants

[![@jaltman](https://avatars.githubusercontent.com/u/206466?s=52&v=4)](/jaltman) [![@metze-samba](https://avatars.githubusercontent.com/u/17027612?s=52&v=4)](/metze-samba)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from security.gentoo.org_d0636a05_20250108_124414.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# Samba: Multiple Vulnerabilities — GLSA **202309-06**

Multiple vulnerabilities have been discovered in Samba, the worst of which could result in root remote code execution.

### Affected packages

| Package | **net-fs/samba** on all architectures |
| --- | --- |
| Affected versions | < **4.18.4** |
| Unaffected versions | >= **4.18.4** |

### Background

Samba is a suite of SMB and CIFS client/server programs.

### Description

Multiple vulnerabilities have been discovered in Samba. Please review the CVE identifiers referenced below for details.

### Impact

Please review the referenced CVE identifiers for details.

### Workaround

There is no known workaround at this time.

### Resolution

All Samba users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=net-fs/samba-4.18.4"

```
### References

* [CVE-2007-4559](https://nvd.nist.gov/vuln/detail/CVE-2007-4559)
* [CVE-2016-2124](https://nvd.nist.gov/vuln/detail/CVE-2016-2124)
* [CVE-2020-17049](https://nvd.nist.gov/vuln/detail/CVE-2020-17049)
* [CVE-2020-25717](https://nvd.nist.gov/vuln/detail/CVE-2020-25717)
* [CVE-2020-25718](https://nvd.nist.gov/vuln/detail/CVE-2020-25718)
* [CVE-2020-25719](https://nvd.nist.gov/vuln/detail/CVE-2020-25719)
* [CVE-2020-25721](https://nvd.nist.gov/vuln/detail/CVE-2020-25721)
* [CVE-2020-25722](https://nvd.nist.gov/vuln/detail/CVE-2020-25722)
* [CVE-2021-3670](https://nvd.nist.gov/vuln/detail/CVE-2021-3670)
* [CVE-2021-3738](https://nvd.nist.gov/vuln/detail/CVE-2021-3738)
* [CVE-2021-20251](https://nvd.nist.gov/vuln/detail/CVE-2021-20251)
* [CVE-2021-20316](https://nvd.nist.gov/vuln/detail/CVE-2021-20316)
* [CVE-2021-23192](https://nvd.nist.gov/vuln/detail/CVE-2021-23192)
* [CVE-2021-44141](https://nvd.nist.gov/vuln/detail/CVE-2021-44141)
* [CVE-2021-44142](https://nvd.nist.gov/vuln/detail/CVE-2021-44142)
* [CVE-2022-0336](https://nvd.nist.gov/vuln/detail/CVE-2022-0336)
* [CVE-2022-1615](https://nvd.nist.gov/vuln/detail/CVE-2022-1615)
* [CVE-2022-2031](https://nvd.nist.gov/vuln/detail/CVE-2022-2031)
* [CVE-2022-3437](https://nvd.nist.gov/vuln/detail/CVE-2022-3437)
* [CVE-2022-3592](https://nvd.nist.gov/vuln/detail/CVE-2022-3592)
* [CVE-2022-32742](https://nvd.nist.gov/vuln/detail/CVE-2022-32742)
* [CVE-2022-32743](https://nvd.nist.gov/vuln/detail/CVE-2022-32743)
* [CVE-2022-32744](https://nvd.nist.gov/vuln/detail/CVE-2022-32744)
* [CVE-2022-32745](https://nvd.nist.gov/vuln/detail/CVE-2022-32745)
* [CVE-2022-32746](https://nvd.nist.gov/vuln/detail/CVE-2022-32746)
* [CVE-2022-37966](https://nvd.nist.gov/vuln/detail/CVE-2022-37966)
* [CVE-2022-37967](https://nvd.nist.gov/vuln/detail/CVE-2022-37967)
* [CVE-2022-38023](https://nvd.nist.gov/vuln/detail/CVE-2022-38023)
* [CVE-2022-42898](https://nvd.nist.gov/vuln/detail/CVE-2022-42898)
* [CVE-2022-45141](https://nvd.nist.gov/vuln/detail/CVE-2022-45141)
* [CVE-2023-0225](https://nvd.nist.gov/vuln/detail/CVE-2023-0225)
* [CVE-2023-0614](https://nvd.nist.gov/vuln/detail/CVE-2023-0614)
* [CVE-2023-0922](https://nvd.nist.gov/vuln/detail/CVE-2023-0922)

**Release date**

September 17, 2023

**Latest revision**

September 17, 2023: 1

**Severity**

high

**Exploitable**

remote

**Bugzilla entries**

* [820566](https://bugs.gentoo.org/show_bug.cgi?id=820566)
* [821688](https://bugs.gentoo.org/show_bug.cgi?id=821688)
* [830983](https://bugs.gentoo.org/show_bug.cgi?id=830983)
* [832433](https://bugs.gentoo.org/show_bug.cgi?id=832433)
* [861512](https://bugs.gentoo.org/show_bug.cgi?id=861512)
* [866225](https://bugs.gentoo.org/show_bug.cgi?id=866225)
* [869122](https://bugs.gentoo.org/show_bug.cgi?id=869122)
* [878273](https://bugs.gentoo.org/show_bug.cgi?id=878273)
* [880437](https://bugs.gentoo.org/show_bug.cgi?id=880437)
* [886153](https://bugs.gentoo.org/show_bug.cgi?id=886153)
* [903621](https://bugs.gentoo.org/show_bug.cgi?id=903621)
* [905320](https://bugs.gentoo.org/show_bug.cgi?id=905320)
* [910334](https://bugs.gentoo.org/show_bug.cgi?id=910334)

### Questions or comments?

Please feel free to contact us.

**© 2001–2020 Gentoo Foundation, Inc.**



=== Content from web.mit.edu_a3a00f2e_20250108_124417.html ===
 Kerberos Version 5, Release 1.20
Release Notes
The MIT Kerberos Team
Copyright and Other Notices
---------------------------
Copyright (C) 1985-2022 by the Massachusetts Institute of Technology
and its contributors. All rights reserved.
Please see the file named NOTICE for additional notices.
Documentation
-------------
Unified documentation for Kerberos V5 is available in both HTML and
PDF formats. The table of contents of the HTML format documentation
is at doc/html/index.html, and the PDF format documentation is in the
doc/pdf directory.
Additionally, you may find copies of the HTML format documentation
online at
https://web.mit.edu/kerberos/krb5-latest/doc/
for the most recent supported release, or at
https://web.mit.edu/kerberos/krb5-devel/doc/
for the release under development.
More information about Kerberos may be found at
https://web.mit.edu/kerberos/
and at the MIT Kerberos Consortium web site
https://kerberos.org/
Building and Installing Kerberos 5
----------------------------------
Build documentation is in doc/html/build/index.html or
doc/pdf/build.pdf.
The installation guide is in doc/html/admin/install.html or
doc/pdf/install.pdf.
If you are attempting to build under Windows, please see the
src/windows/README file.
Reporting Bugs
--------------
Please report any problems/bugs/comments by sending email to
krb5-bugs@mit.edu.
You may view bug reports by visiting
https://krbdev.mit.edu/rt/
and using the "Guest Login" button. Please note that the web
interface to our bug database is read-only for guests, and the primary
way to interact with our bug database is via email.
PAC transition
--------------
Beginning with release 1.20, the KDC will include minimal PACs in
tickets instead of AD-SIGNEDPATH authdata. S4U requests (protocol
transition and constrained delegation) must now contain valid PACs in
the incoming tickets. If only some KDCs in a realm have been upgraded
across version 1.20, the upgraded KDCs will reject S4U requests
containing tickets from non-upgraded KDCs and vice versa.
Triple-DES transition
---------------------
Beginning with the krb5-1.19 release, a warning will be issued if
initial credentials are acquired using the des3-cbc-sha1 encryption
type. In future releases, this encryption type will be disabled by
default and eventually removed.
Beginning with the krb5-1.18 release, single-DES encryption types have
been removed.
Major changes in 1.20.1 (2022-11-15)
------------------------------------
This is a bug fix release.
\* Fix integer overflows in PAC parsing [CVE-2022-42898].
\* Fix null deref in KDC when decoding invalid NDR.
\* Fix memory leak in OTP kdcpreauth module.
\* Fix PKCS11 module path search.
krb5-1.20.1 changes by ticket ID
--------------------------------
9061 Fix memory leak in SPAKE kdcpreauth module
9062 Fix net-server.c when AI\_NUMERICSERV is undefined
9063 Fix memory leak in OTP kdcpreauth module
9064 Free verto context later in KDC cleanup
9065 Fix uncommon PKINIT memory leak
9067 Fix PKCS11 module path search
9073 Fix null deref in KDC when decoding invalid NDR
9074 Fix integer overflows in PAC parsing
Major changes in 1.20 (2022-05-26)
----------------------------------
Administrator experience:
\* Added a "disable\_pac" realm relation to suppress adding PAC authdata
to tickets, for realms which do not need to support S4U requests.
\* Most credential cache types will use atomic replacement when a cache
is reinitialized using kinit or refreshed from the client keytab.
\* kprop can now propagate databases with a dump size larger than 4GB,
if both the client and server are upgraded.
\* kprop can now work over NATs that change the destination IP address,
if the client is upgraded.
Developer experience:
\* Updated the KDB interface. The sign\_authdata() method is replaced
with the issue\_pac() method, allowing KDB modules to add logon info
and other buffers to the PAC issued by the KDC.
\* Host-based initiator names are better supported in the GSS krb5
mechanism.
Protocol evolution:
\* Replaced AD-SIGNEDPATH authdata with minimal PACs.
\* To avoid spurious replay errors, password change requests will not
be attempted over UDP until the attempt over TCP fails.
\* PKINIT will sign its CMS messages with SHA-256 instead of SHA-1.
Code quality:
\* Updated all code using OpenSSL to be compatible with OpenSSL 3.
\* Reorganized the libk5crypto build system to allow the OpenSSL
back-end to pull in material from the builtin back-end depending on
the OpenSSL version.
\* Simplified the PRNG logic to always use the platform PRNG.
\* Converted the remaining Tcl tests to Python.
krb5-1.20 changes by ticket ID
------------------------------
7707 Credential cache API does not support atomic reinitialization
8010 gss\_store\_cred should initialize ccache and work with collections
8970 Wrong Encryption types shown in MIT Kerberos Ticket Manager on Windows
8976 all-liblinks build target fails when symlinks not supported
8977 Allow kprop over more types of NATs
8978 Support host-based GSS initiator names
8980 Add APIs for marshalling credentials
8981 Documentation\_\_krb5.conf
8983 Infer name type when creating principals
8988 Only require one valid pkinit anchor/pool value
8990 Add KCM\_OP\_GET\_CRED\_LIST for faster iteration
8991 Fix PKINIT memory leaks
8994 Fix gss-krb5 handling of high sequence numbers
8995 KCM interop issue with KRB5\_TC\_ flags
8997 Use KCM\_OP\_RETRIEVE in KCM client
8998 Simplify krb5\_cccol\_have\_content()
8999 Add additional KRB5\_TRACE points
9000 Fix multiple UPN handling in PKINIT client certs
9002 Check for undefined kadm5 policy mask bits
9003 Add duplicate check to kadm5\_create\_policy()
9009 Update IRC pointer in resources.rst
9010 Add MAXHOSTNAME guard in Windows public header
9011 Fix some principal realm canonicalization cases
9012 Allow kinit with keytab to defer canonicalization
9013 Fix kadmin -k with fallback or referral realm
9017 Clarify and correct interposer plugin docs
9019 make check fails: OSError: AF\_UNIX path too long
9022 Potential integer overflows
9024 Find gss\_get\_mic\_iov extensions in GSS modules
9025 Use version-independent OpenLDAP links in docs
9027 Add OpenLDAP advice to princ\_dns.rst
9028 Constify name field in four plugin vtables
9031 Fix verification of RODC-issued PAC KDC signature
9032 Always use platform PRNG
9034 Use builtin MD4, RC4 for OpenSSL 3.0
9035 Avoid use after free during libkrad cleanup
9036 Support larger RADIUS attributes in libkrad
9037 Race condition in krb5\_set\_password()
9038 Issue an error from KDC on S4U2Self failures
9039 Fix PAC handling of authtimes after y2038
9040 Use 14 instead of 9 for unkeyed SHA-1 checksum
9041 Add PA-REDHAT-IDP-OAUTH2 padata type
9042 Don't fail krb5\_cc\_select() for no default realm
9043 Add PAC ticket signature APIs
9044 Replace AD-SIGNEDPATH with minimal PACs
9047 Avoid passing null for asprintf strings
9048 Pass client flag to KDB for client preauth match
9049 Add replace\_reply\_key kdcpreauth callback
9050 Implement replaced\_reply\_key input to issue\_pac()
9051 Clarify certauth interface documentation
9056 Fix iprop with fallback
9060 Read GSS configuration files with mtime 0
Acknowledgements
----------------
Past Sponsors of the MIT Kerberos Consortium:
Apple
Carnegie Mellon University
Centrify Corporation
Columbia University
Cornell University
The Department of Defense of the United States of America (DoD)
Fidelity Investments
Google
Iowa State University
MIT
Michigan State University
Microsoft
MITRE Corporation
Morgan-Stanley
The National Aeronautics and Space Administration
of the United States of America (NASA)
Network Appliance (NetApp)
Nippon Telephone and Telegraph (NTT)
US Government Office of the National Coordinator for Health
Information Technology (ONC)
Oracle
Pennsylvania State University
Red Hat
Stanford University
TeamF1, Inc.
The University of Alaska
The University of Michigan
The University of Pennsylvania
Past and present members of the Kerberos Team at MIT:
Danilo Almeida
Jeffrey Altman
Justin Anderson
Richard Basch
Mitch Berger
Jay Berkenbilt
Andrew Boardman
Bill Bryant
Steve Buckley
Joe Calzaretta
John Carr
Mark Colan
Don Davis
Sarah Day
Alexandra Ellwood
Carlos Garay
Dan Geer
Nancy Gilman
Matt Hancher
Thomas Hardjono
Sam Hartman
Paul Hill
Marc Horowitz
Eva Jacobus
Miroslav Jurisic
Barry Jaspan
Benjamin Kaduk
Geoffrey King
Kevin Koch
John Kohl
HaoQi Li
Jonathan Lin
Peter Litwack
Scott McGuire
Steve Miller
Kevin Mitchell
Cliff Neuman
Paul Park
Ezra Peisach
Chris Provenzano
Ken Raeburn
Jon Rochlis
Jeff Schiller
Jen Selby
Robert Silk
Bill Sommerfeld
Jennifer Steiner
Ralph Swick
Brad Thompson
Harry Tsai
Zhanna Tsitkova
Ted Ts'o
Marshall Vale
Taylor Yu
The following external contributors have provided code, patches, bug
reports, suggestions, and valuable resources:
Ian Abbott
Daniel Albers
Brandon Allbery
Russell Allbery
Brian Almeida
Michael B Allen
Pooja Anil
Jeffrey Arbuckle
Heinz-Ado Arnolds
Derek Atkins
Mark Bannister
David Bantz
Alex Baule
Nikhil Benesch
David Benjamin
Thomas Bernard
Adam Bernstein
Arlene Berry
Jeff Blaine
Toby Blake
Radoslav Bodo
Alexander Bokovoy
Sumit Bose
Emmanuel Bouillon
Isaac Boukris
Ulf Bremer
Pavel BÅezina
Philip Brown
Samuel Cabrero
Michael Calmer
Andrea Campi
Julien Chaffraix
Puran Chand
Ravi Channavajhala
Srinivas Cheruku
Leonardo Chiquitto
Rachit Chokshi
Seemant Choudhary
Howard Chu
Andrea Cirulli
Christopher D. Clausen
Kevin Coffman
Simon Cooper
Sylvain Cortes
Ian Crowther
Arran Cudbard-Bell
Adam Dabrowski
Jeff D'Angelo
Nalin Dahyabhai
Mark Davies
Dennis Davis
Alex Dehnert
Misty De Meo
Mark Deneen
GÃ¼nther Deschner
John Devitofranceschi
Marc Dionne
Roland Dowdeswell
Ken Dreyer
Dorian Ducournau
Viktor Dukhovni
Jason Edgecombe
Mark Eichin
Shawn M. Emery
Douglas E. Engert
Peter Eriksson
Juha ErkkilÃ¤
Gilles Espinasse
Ronni Feldt
Bill Fellows
JC Ferguson
Remi Ferrand
Paul Fertser
Fabiano FidÃªncio
Frank Filz
William Fiveash
Jacques Florent
Oliver Freyermuth
Ãkos Frohner
Sebastian Galiano
Marcus Granado
Dylan Gray
Norm Green
Scott Grizzard
Helmut Grohne
Steve Grubb
Philip Guenther
Timo Gurr
Dominic Hargreaves
Robbie Harwood
John Hascall
Jakob Haufe
Matthieu Hautreux
Jochen Hein
Paul B. Henson
Kihong Heo
Jeff Hodges
Christopher Hogan
Love HÃ¶rnquist Ãstrand
Ken Hornstein
Henry B. Hotz
Luke Howard
Jakub Hrozek
Shumon Huque
Jeffrey Hutzelman
Sergey Ilinykh
Wyllys Ingersoll
Holger Isenberg
Spencer Jackson
Diogenes S. Jesus
Mike Jetzer
Pavel Jindra
Brian Johannesmeyer
Joel Johnson
Lutz Justen
Alexander Karaivanov
Anders Kaseorg
Bar Katz
Zentaro Kavanagh
Mubashir Kazia
W. Trevor King
Patrik Kis
Martin Kittel
Thomas Klausner
Tomasz KÅoczko
Matthew Krupcale
Mikkel Kruse
Reinhard Kugler
Harshawardhan Kulkarni
Tomas Kuthan
Pierre Labastie
Andreas Ladanyi
Chris Leick
Volker Lendecke
Jan iankko Lieskovsky
Todd Lipcon
Oliver Loch
Chris Long
Kevin Longfellow
Frank Lonigro
Jon Looney
Nuno Lopes
Todd Lubin
Ryan Lynch
Glenn Machin
Roland Mainz
Sorin Manolache
Robert Marshall
Andrei Maslennikov
Michael Mattioli
Nathaniel McCallum
Greg McClement
Cameron Meadors
Vipul Mehta
Alexey Melnikov
Ivan A. Melnikov
Franklyn Mendez
Mantas MikulÄnas
Markus Moeller
Kyle Moffett
Paul Moore
Keiichi Mori
Michael Morony
Sam Morris
Zbysek Mraz
Edward Murrell
Joshua Neuheisel
Nikos Nikoleris
Demi Obenour
Felipe Ortega
Michael Osipov
Andrej Ota
Dmitri Pal
Javier Palacios
Dilyan Palauzov
Tom Parker
Eric Pauly
Leonard Peirce
Ezra Peisach
Alejandro Perez
Zoran Pericic
W. Michael Petullo
Mark Phalan
Sharwan Ram
Brett Randall
Jonathan Reams
Jonathan Reed
Robert Relyea
Tony Reix
Martin Rex
Pat Riehecky
Julien Rische
Jason Rogers
Matt Rogers
Nate Rosenblum
Solly Ross
Mike Roszkowski
Guillaume Rousse
Joshua Schaeffer
Alexander Scheel
Jens Schleusener
Ryan Schmidt
Andreas Schneider
Paul Seyfert
Tom Shaw
Jim Shi
Jerry Shipman
Peter Shoults
Richard Silverman
Cel Skeggs
Simo Sorce
Michael Spang
Michael StrÃ¶der
BjÃ¸rn Tore Sund
OndÅej SurÃ½
Joseph Sutton
Joe Travaglini
Sergei Trofimovich
Greg Troxel
Fraser Tweedale
Tim Uglow
Rathor Vipin
Denis Vlasenko
Thomas Wagner
Jorgen Wahlsten
Stef Walter
Max (Weijun) Wang
John Washington
Stef Walter
Xi Wang
Nehal J Wani
Kevin Wasserman
Margaret Wasserman
Marcus Watts
Andreas Wiese
Simon Wilkinson
Nicolas Williams
Ross Wilper
Augustin Wolf
Garrett Wollman
David Woodhouse
Tsu-Phong Wu
Xu Qiang
Neng Xue
Zhaomo Yang
Tianjiao Yin
Nickolai Zeldovich
Bean Zhang
Hanz van Zijst
Gertjan Zwartjes
The above is not an exhaustive list; many others have contributed in
various ways to the MIT Kerberos development effort over the years.
Other acknowledgments (for bug reports and patches) are in the
doc/CHANGES file.


=== Content from security.netapp.com_35fd584f_20250108_124415.html ===

[Skip to main content](#n-main-content)

* [NetApp.com](https://www.netapp.com/)
* [Support](https://mysupport.netapp.com)
* [Community](https://community.netapp.com)
* [Training](https://www.netapp.com/support-and-training/netapp-learning-services/)

* [Contact Us](https://www.netapp.com/company/contact-us/)

English
æ¥æ¬èª

[netapp-mark

NetApp

## Product Security](https://security.netapp.com)

Search

Search

* Search

Search

Search

* [Home](https://security.netapp.com/en)
* [Advisories](https://security.netapp.com/advisory/)
* [Bulletins](https://security.netapp.com/bulletins/)
* [Contact](https://security.netapp.com/contact/)
* [Policy](https://security.netapp.com/policy/)
* [Resources](https://security.netapp.com/resources/)
* [Certifications](https://security.netapp.com/certs/)

* [Home](https://security.netapp.com/en)
* [Advisory](https://security.netapp.com/advisory)
* [CVE-2022-42898 MIT Kerberos 5 Vulnerability in NetApp Products](https://security.netapp.com/advisory/ntap-20230223-0001)

## CVE-2022-42898 MIT Kerberos 5 Vulnerability in NetApp Products

circle-check-alt

This advisory should be considered the single source of current, up-to-date, authorized and accurate information from NetApp regarding Full Support products and versions.

close ×

#### Subscribe to NTAP-20230223-0001 updates

Email

Yes, please send me emails when NetApp Security Advisories are posted or updated.

 By filling and submitting this form, I understand and agree with the [NetApp privacy policy](https://www.netapp.com/company/legal/privacy-policy/ "Privacy Policy") and understand that I can unsubscribe from NetApp Security Advisory communications at any time.

Subscribe

#### Subscribe to NTAP-20230223-0001 advisory updates

OTP

Confirm

ionicons-v5-e

Confirmed your subscription to advisory alerts

close ×

#### Unsubscribe from NTAP-20230223-0001 advisory updates

Email

Unsubscribe

#### Unsubscribe from NTAP-20230223-0001 advisory updates

Email

Confirm

ionicons-v5-e

Unsubscribed successfully from advisory alerts

Subscribe to receive email updates

**Advisory ID:** NTAP-20230223-0001
**Version:**
17.0

**Last updated:**
08/30/2024

**Status:**
Final.

**CVEs:** CVE-2022-42898

Overview
#### Summary

Multiple NetApp products incorporate MIT Kerberos 5. MIT Kerberos 5 (aka krb5) versions prior to 1.19.4 and 1.20.x prior to 1.20.1 are susceptible to a vulnerability which when successfully exploited could lead to disclosure of sensitive information, addition or modification of data, or Denial of Service (DoS).

#### Impact

Successful exploitation of this vulnerability could lead to disclosure of sensitive information, addition or modification of data, or Denial of Service (DoS).

#### Vulnerability Scoring Details

| **CVE** | **Score** | **Vector** |
| --- | --- | --- |
| [CVE-2022-42898](https://nvd.nist.gov/vuln/detail/CVE-2022-42898) | 8.8 (HIGH) | CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H |

#### Exploitation and Public Announcements

NetApp is aware of public discussion of this vulnerability.

#### References

* <https://github.com/krb5/krb5/commit/ea92d2f0fcceb54a70910fa32e9a0d7a5afc3583>
* <https://web.mit.edu/kerberos/krb5-1.19/>
* <https://web.mit.edu/kerberos/krb5-1.20/README-1.20.1.txt>

Affected Products
#### Affected Products

* Management Services for Element Software and NetApp HCI
* NetApp E-Series Performance Analyzer
* ONTAP 9 (formerly Clustered Data ONTAP)
* ONTAP Select Deploy administration utility

#### Products Not Affected

* AFF BIOS - A700s
* AFF Baseboard Management Controller (BMC) - A700s
* ATTO FibreBridge - 7500N
* ATTO FibreBridge - 7600N
* Active IQ Unified Manager for Linux
* Active IQ Unified Manager for Microsoft Windows
* Active IQ Unified Manager for VMware vSphere
* Active IQ mobile app
* Astra Control Center
* Astra Control Center - NetApp Kubernetes Monitoring Operator
* Astra Trident
* Astra Trident Autosupport
* BlueXP Classification
* Brocade Fabric Operating System Firmware
* Brocade SAN Navigator (SANnav)
* Cloud Insights Acquisition Unit
* Cloud Insights Storage Workload Security Agent
* Cloud Insights Telegraf Agent
* Cloud Volumes ONTAP Mediator
* E-Series BIOS
* E-Series SANtricity OS Controller Software 11.x
* E-Series SANtricity Unified Manager and Web Services Proxy
* Element .NET SDK
* Element HealthTools
* Element JAVA SDK
* Element Plug-in for vCenter Server
* Element Powershell Tools
* Element Python SDK
* FAS/AFF BIOS - 8300/8700/A400/C400
* FAS/AFF BIOS - A250/500f/C250
* FAS/AFF BIOS - A300/8200/A200/2650/2620/C190/A220/2720/2750/A150
* FAS/AFF BIOS - A320
* FAS/AFF BIOS - A700/9000
* FAS/AFF BIOS - A800/C800
* FAS/AFF BIOS - A900/9500
* FAS/AFF Baseboard Management Controller (BMC) - 8300/8700/A400/C400
* FAS/AFF Baseboard Management Controller (BMC) - A250/500f/C250
* FAS/AFF Baseboard Management Controller (BMC) - A900/9500
* FAS/AFF Baseboard Management Controller (BMC) - C190/A150/A220/FAS2720/FAS2750
* FAS/AFF Service Processor - 2554/2552/2520
* FAS/AFF Service Processor - 8080/8060/8040/8020
* FAS/AFF Service Processor - A300/8200/A200/2650/2620
* FAS/AFF Service Processor - A700/9000
* Global File Cache
* Host Utilities - SAN for Linux
* Host Utilities - SAN for Windows
* IOM6 SAS Disk Shelf Firmware
* MetroCluster Tiebreaker for clustered Data ONTAP
* Multipath I/O (SANtricity DSM for Windows MPIO)
* NetApp BlueXP
* NetApp Converged Systems Advisor Agent
* NetApp E-Series Host Collection
* NetApp E-Series SANtricity Collection
* NetApp HCI Baseboard Management Controller (BMC) - H300S/H500S/H700S/H410S
* NetApp HCI Baseboard Management Controller (BMC) - H410C
* NetApp HCI Baseboard Management Controller (BMC) - H610C
* NetApp HCI Baseboard Management Controller (BMC) - H610S
* NetApp HCI Baseboard Management Controller (BMC) - H615C
* NetApp HCI Compute Node (Bootstrap OS)
* NetApp HCI Compute Node BIOS
* NetApp HCI Storage Node BIOS
* NetApp Kubernetes Monitoring Operator
* NetApp Manageability SDK
* NetApp NFS Plug-in for VMware VAAI
* NetApp ONTAP PowerShell Toolkit (PSTK)
* NetApp SolidFire & HCI Management Node
* NetApp SolidFire & HCI Storage Node (Element Software)
* NetApp SolidFire Plug-in for vRealize Orchestrator (SolidFire vRO)
* NetApp XCP NFS
* NetApp XCP SMB
* ONTAP Antivirus Connector
* ONTAP Mediator
* ONTAP tools for VMware vSphere 9
* OnCommand Insight
* OnCommand Workflow Automation
* SANtricity Storage Plugin for vCenter
* SRA Plugin for Linux
* SRA Plugin for Windows
* Single Mailbox Recovery
* Snap Creator Framework
* SnapCenter
* SnapCenter Plug-in for VMware vSphere/BlueXP backup and Recovery for Virtual Machine
* SnapManager for Hyper-V
* SolidFire Storage Replication Adapter
* StorageGRID (formerly StorageGRID Webscale)
* StorageGRID BIOS SG1000/SG100/SG1100/SG110
* StorageGRID BIOS SG5660/SG5612/SG5760/SG5712
* StorageGRID BIOS SG6060/SGF6024/SGF6112/SG6160
* StorageGRID Baseboard Management Controller (BMC) - SG6060/SG6160/SGF6024/SGF6112/SG100/SG110/SG1000/SG1100
* System Manager 9.x

Remediation
#### Software Versions and Fixes

NetApp's currently available patches are listed below.

| **Product** | **First Fixed in Release** |
| --- | --- |
| **Management Services for Element Software and NetApp HCI** | <https://mysupport.netapp.com/site/products/all/details/mgmtservices/downloads-tab/download/63086/2.23.64> |
| **NetApp E-Series Performance Analyzer** | NetApp E-Series Performance Analyzer has no plans to address this vulnerability. See the [EOA announcement](https://github.com/NetApp/eseries-perf-analyzer) for more information. |
| **ONTAP 9 (formerly Clustered Data ONTAP)** | <https://mysupport.netapp.com/site/products/all/details/ontap9/downloads-tab/download/62286/9.8P21> <https://mysupport.netapp.com/site/products/all/details/ontap9/downloads-tab/download/62286/9.9.1P17> <https://mysupport.netapp.com/site/products/all/details/ontap9/downloads-tab/download/62286/9.10.1P15> <https://mysupport.netapp.com/site/products/all/details/ontap9/downloads-tab/download/62286/9.11.1P12> <https://mysupport.netapp.com/site/products/all/details/ontap9/downloads-tab/download/62286/9.12.1> |
| **ONTAP Select Deploy administration utility** | <https://mysupport.netapp.com/site/products/all/details/ontapselect-deploy/downloads-tab/download/62910/9.13.1> |

#### Workarounds

None at this time.

#### Obtaining Software Fixes

Software fixes will be made available through the NetApp Support website in the Software Download section.

<https://mysupport.netapp.com/site/downloads/>

Customers who do not have access to the Support website should contact Technical Support at the number below to obtain the patches.

#### Contact Information

Check <http://mysupport.netapp.com> for further
updates.

**Technical Support**

Revision History
#### Status of This Notice

**Final.**

This advisory should be considered the single source of current, up-to-date, authorized and accurate information from NetApp regarding Full Support products and versions.

This advisory is posted at the following link:

<https://security.netapp.com/advisory/NTAP-20230223-0001>
#### Revision History

| **Revision #** | **Date** | **Comments** |
| --- | --- | --- |
| 1.0 | 20230223 | Initial Public Release |
| 2.0 | 20230228 | FAS/AFF Baseboard Management Controller (BMC) - 8300/8700/A400, AFF Baseboard Management Controller (BMC) - A700s and FAS/AFF Baseboard Management Controller (BMC) - A250/500f moved to Products Not Affected |
| 3.0 | 20230307 | OnCommand Insight and Cloud Volumes ONTAP Mediator moved to Products Not Affected, NetApp E-Series Performance Analyzer moved to Won't Fix status |
| 4.0 | 20230328 | Management Services for Element Software and NetApp HCI added to Software Versions and Fixes |
| 5.0 | 20230404 | SnapCenter Plug-in for VMware vSphere moved to Products Not Affected |
| 6.0 | 20230407 | Formatting changes |
| 7.0 | 20230420 | NetApp HCI Baseboard Management Controller (BMC) - H610C, NetApp HCI Baseboard Management Controller (BMC) - H610S and NetApp HCI Baseboard Management Controller (BMC) - H615C moved to Affected Products |
| 8.0 | 20230712 | ONTAP 9 (formerly Clustered Data ONTAP) Fix note added. |
| 9.0 | 20230802 | NetApp SolidFire & HCI Management Node moved to Products Not Affected |
| 10.0 | 20230821 | FAS/AFF BIOS - A250/500f/C250 and FAS/AFF BIOS - A700s moved to Products Not Affected |
| 11.0 | 20230822 | ONTAP 9 (formerly Clustered Data ONTAP) Fix note removed. |
| 12.0 | 20230905 | ONTAP 9 (formerly Clustered Data ONTAP) 9.9.1P17 added to Software Versions and Fixes |
| 13.0 | 20231009 | ONTAP 9.11.1P12 (formerly Clustered Data ONTAP) added to Software Versions and Fixes |
| 14.0 | 20231110 | ONTAP 9.10.1P15 (formerly Clustered Data ONTAP) added to Software Versions and Fixes |
| 15.0 | 20231207 | ONTAP 9.8P21 (formerly Clustered Data ONTAP) added to Software Versions and Fixes |
| 16.0 | 20240425 | ONTAP Select Deploy administration utility added to Software Versions and Fixes |
| 17.0 | 20240830 | NetApp HCI Baseboard Management Controller (BMC) - H610S, NetApp HCI Baseboard Management Controller (BMC) - H615C, and NetApp HCI Baseboard Management Controller (BMC) - H610C moved to Products Not Affected, Final status |

This document is provided solely for informational purposes. All information is based upon NetAppâs current knowledge and understanding of the hardware and software products tested by NetApp, and the methodology and assumptions used by NetApp. NetApp is not responsible for any errors or omissions that may be contained herein, and no warranty, representation, or other legal commitment or obligation is being provided by NetApp. Â© 2025 NetApp, Inc. All rights reserved. No portions of this document may be reproduced without prior written consent of NetApp, Inc.

 ©  NetApp

Have feedback for our website?
[Let us know](https://www.netapp.com/forms/site-feedback/)



=== Content from security.gentoo.org_27f69661_20250108_124415.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# Heimdal: Multiple Vulnerabilities — GLSA **202310-06**

Multiple vulnerabilities have been discovered in Heimdal, the worst of which could lead to remote code execution on a KDC.

### Affected packages

| Package | **app-crypt/heimdal** on all architectures |
| --- | --- |
| Affected versions | < **7.8.0-r1** |
| Unaffected versions | >= **7.8.0-r1** |

### Background

Heimdal is a free implementation of Kerberos 5.

### Description

Multiple vulnerabilities have been discovered in Heimdal, the worst of which could lead to remote code execution on a Kerberos Domain Controller.
Please review the CVE identifiers referenced below for details.

### Impact

Please review the referenced CVE identifiers for details.

### Workaround

There is no known workaround at this time.

### Resolution

All Cross-realm trust vulnerability in Heimdal users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=app-crypt/heimdal-7.8.0-r1"

```
### References

* [CVE-2019-14870](https://nvd.nist.gov/vuln/detail/CVE-2019-14870)
* [CVE-2021-44758](https://nvd.nist.gov/vuln/detail/CVE-2021-44758)
* [CVE-2022-3437](https://nvd.nist.gov/vuln/detail/CVE-2022-3437)
* [CVE-2022-3671](https://nvd.nist.gov/vuln/detail/CVE-2022-3671)
* [CVE-2022-41916](https://nvd.nist.gov/vuln/detail/CVE-2022-41916)
* [CVE-2022-42898](https://nvd.nist.gov/vuln/detail/CVE-2022-42898)
* [CVE-2022-44640](https://nvd.nist.gov/vuln/detail/CVE-2022-44640)
* [CVE-2022-44758](https://nvd.nist.gov/vuln/detail/CVE-2022-44758)
* [CVE-2022-45142](https://nvd.nist.gov/vuln/detail/CVE-2022-45142)

**Release date**

October 08, 2023

**Latest revision**

October 08, 2023: 1

**Severity**

high

**Exploitable**

remote

**Bugzilla entries**

* [881429](https://bugs.gentoo.org/show_bug.cgi?id=881429)
* [893722](https://bugs.gentoo.org/show_bug.cgi?id=893722)

### Questions or comments?

Please feel free to contact us.

**© 2001–2020 Gentoo Foundation, Inc.**



=== Content from www.samba.org_c5d61c06_20250108_124417.html ===

## CVE-2022-42898.html:

```

===========================================================
== Subject:     Samba buffer overflow vulnerabilities on 32-bit
==              systems
==
== CVE ID#:     CVE-2022-42898
==
== Versions:    All versions of Samba prior to 4.15.12, 4.16.7, 4.17.3
==
== Summary:     Samba's Kerberos libraries and AD DC failed to guard
==              against integer overflows when parsing a PAC on a 32-bit
==              system, which allowed an attacker with a forged PAC to
==              corrupt the heap.
===========================================================

===========
Description
===========

The Kerberos libraries used by Samba provide a mechanism for
authenticating a user or service by means of tickets that can contain
Privilege Attribute Certificates (PACs).

Both the Heimdal and MIT Kerberos libraries, and so the embedded
Heimdal shipped by Samba suffer from an integer multiplication
overflow when calculating how many bytes to allocate for a buffer for
the parsed PAC.

On a 32-bit system an overflow allows placement of 16-byte chunks of
entirely attacker- controlled data.

(Because the user's control over this calculation is limited to an
unsigned 32-bit value, 64-bit systems are not impacted).

The server most vulnerable is the  KDC, as it will parse an
attacker-controlled PAC in the S4U2Proxy handler.

The secondary risk is to Kerberos-enabled file server installations in
a non-AD realm.  A non-AD Heimdal KDC controlling such a realm may
pass on an attacker-controlled PAC within the service ticket.

==================
Patch Availability
==================

Patches addressing these issues have been posted to:

    https://www.samba.org/samba/security/

Additionally, Samba 4.15.12, 4.16.7, and 4.17.3 have been issued
as security releases to correct the defect. Samba administrators are
advised to upgrade to these releases or apply the patch as soon
as possible.

==================
CVSSv3 calculation
==================

CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:L/I:H/A:L (6.4)

==========================
Workaround and mitigations
==========================

* No workaround on 32-bit systems as an AD DC
* file servers are only impacted if in a non-AD domain
* 64-bit systems are not exploitable.

=======
Credits
=======

Originally reported by Greg Hudson with the aid of oss-fuzz.

Patches provided by Nicolas Williams of Heimdal and Joseph Sutton of
Catlyst and the Samba team.

Advisory by Joseph Sutton and Andrew Bartlett of Catalyst and the
Samba Team based on text and analysis by Greg Hudson.

==========================================================
== Our Code, Our Bugs, Our Responsibility.
== The Samba Team
==========================================================

```



=== Content from security.netapp.com_e151c353_20250108_124415.html ===

[Skip to main content](#n-main-content)

* [NetApp.com](https://www.netapp.com/)
* [Support](https://mysupport.netapp.com)
* [Community](https://community.netapp.com)
* [Training](https://www.netapp.com/support-and-training/netapp-learning-services/)

* [Contact Us](https://www.netapp.com/company/contact-us/)

English
æ¥æ¬èª

[netapp-mark

NetApp

## Product Security](https://security.netapp.com)

Search

Search

* Search

Search

Search

* [Home](https://security.netapp.com/en)
* [Advisories](https://security.netapp.com/advisory/)
* [Bulletins](https://security.netapp.com/bulletins/)
* [Contact](https://security.netapp.com/contact/)
* [Policy](https://security.netapp.com/policy/)
* [Resources](https://security.netapp.com/resources/)
* [Certifications](https://security.netapp.com/certs/)

* [Home](https://security.netapp.com/en)
* [Advisory](https://security.netapp.com/advisory)
* [December 2022 Heimdal Vulnerabilities in NetApp Products](https://security.netapp.com/advisory/ntap-20230216-0008)

## December 2022 Heimdal Vulnerabilities in NetApp Products

circle-check-alt

This advisory should be considered the single source of current, up-to-date, authorized and accurate information from NetApp regarding Full Support products and versions.

close ×

#### Subscribe to NTAP-20230216-0008 updates

Email

Yes, please send me emails when NetApp Security Advisories are posted or updated.

 By filling and submitting this form, I understand and agree with the [NetApp privacy policy](https://www.netapp.com/company/legal/privacy-policy/ "Privacy Policy") and understand that I can unsubscribe from NetApp Security Advisory communications at any time.

Subscribe

#### Subscribe to NTAP-20230216-0008 advisory updates

OTP

Confirm

ionicons-v5-e

Confirmed your subscription to advisory alerts

close ×

#### Unsubscribe from NTAP-20230216-0008 advisory updates

Email

Unsubscribe

#### Unsubscribe from NTAP-20230216-0008 advisory updates

Email

Confirm

ionicons-v5-e

Unsubscribed successfully from advisory alerts

Subscribe to receive email updates

**Advisory ID:** NTAP-20230216-0008
**Version:**
7.0

**Last updated:**
01/24/2024

**Status:**
Final.

**CVEs:** CVE-2022-42898, CVE-2022-3437, CVE-2022-41916, CVE-2021-44758, CVE-2021-3671, CVE-2022-44640, CVE-2019-14870

Overview
#### Summary

Multiple NetApp products incorporate Heimdal. Heimdal versions prior to 7.7.1 are susceptible to vulnerabilities which when successfully exploited could lead to disclosure of sensitive information, addition or modification of data, or Denial of Service (DoS).

#### Impact

Successful exploitation of these vulnerabilities could lead to disclosure of sensitive information, addition or modification of data, or Denial of Service (DoS).

ONTAP Select Deploy administration utility:

Affected by only CVE-2022-42898.

#### Vulnerability Scoring Details

| **CVE** | **Score** | **Vector** |
| --- | --- | --- |
| [CVE-2019-14870](https://nvd.nist.gov/vuln/detail/CVE-2019-14870) | 5.4 (MEDIUM) | CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:N |
| [CVE-2021-3671](https://nvd.nist.gov/vuln/detail/CVE-2021-3671) | 6.5 (MEDIUM) | CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H |
| [CVE-2021-44758](https://nvd.nist.gov/vuln/detail/CVE-2021-44758) | 7.5 (HIGH) | CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H |
| [CVE-2022-3437](https://nvd.nist.gov/vuln/detail/CVE-2022-3437) | 6.5 (MEDIUM) | CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H |
| [CVE-2022-41916](https://nvd.nist.gov/vuln/detail/CVE-2022-41916) | 7.5 (HIGH) | CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H |
| [CVE-2022-42898](https://nvd.nist.gov/vuln/detail/CVE-2022-42898) | 8.8 (HIGH) | CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H |
| [CVE-2022-44640](https://nvd.nist.gov/vuln/detail/CVE-2022-44640) | 9.8 (CRITICAL) | CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H |

#### Exploitation and Public Announcements

NetApp is aware of public discussion of this vulnerability.

#### References

* <https://github.com/heimdal/heimdal/releases/tag/heimdal-7.7.1>

Affected Products
#### Affected Products

* Management Services for Element Software and NetApp HCI
* NetApp E-Series Performance Analyzer
* ONTAP Select Deploy administration utility

#### Products Not Affected

* AFF Baseboard Management Controller (BMC) - A700s
* ATTO FibreBridge - 7500N
* ATTO FibreBridge - 7600N
* Active IQ Unified Manager for Linux
* Active IQ Unified Manager for Microsoft Windows
* Active IQ Unified Manager for VMware vSphere
* Active IQ mobile app
* Astra Control Center
* Astra Control Center - Cloud Insights Telegraf Agent
* Astra Control Center - NetApp Kubernetes Monitoring Operator
* Astra Trident
* Astra Trident Autosupport
* BlueXP Classification
* Brocade Fabric Operating System Firmware
* Brocade SAN Navigator (SANnav)
* Cloud Insights Acquisition Unit
* Cloud Insights Storage Workload Security Agent
* Cloud Insights Telegraf Agent
* Cloud Volumes ONTAP Mediator
* E-Series BIOS
* E-Series SANtricity OS Controller Software 11.x
* E-Series SANtricity Unified Manager and Web Services Proxy
* Element .NET SDK
* Element HealthTools
* Element JAVA SDK
* Element Plug-in for vCenter Server
* Element Powershell Tools
* Element Python SDK
* FAS/AFF BIOS - 8300/8700/A400/C400
* FAS/AFF BIOS - A250/500f/C250
* FAS/AFF BIOS - A300/8200/A200/2650/2620/C190/A220/2720/2750/A150
* FAS/AFF BIOS - A320
* FAS/AFF BIOS - A700/9000
* FAS/AFF BIOS - A700s
* FAS/AFF BIOS - A800/C800
* FAS/AFF BIOS - A900/9500
* FAS/AFF Baseboard Management Controller (BMC) - 8300/8700/A400/C400
* FAS/AFF Baseboard Management Controller (BMC) - A250/500f/C250
* FAS/AFF Baseboard Management Controller (BMC) - A900/9500
* FAS/AFF Baseboard Management Controller (BMC) - C190/A150/A220/FAS2720/FAS2750
* FAS/AFF Service Processor - A300/8200/A200/2650/2620
* FAS/AFF Service Processor - A700/9000
* Global File Cache
* Host Utilities - SAN for Linux
* Host Utilities - SAN for Windows
* IOM6 SAS Disk Shelf Firmware
* MetroCluster Tiebreaker for clustered Data ONTAP
* Multipath I/O (SANtricity DSM for Windows MPIO)
* NetApp BlueXP
* NetApp Converged Systems Advisor Agent
* NetApp E-Series Host Collection
* NetApp E-Series SANtricity Collection
* NetApp HCI Baseboard Management Controller (BMC) - H300S/H500S/H700S/H410S
* NetApp HCI Baseboard Management Controller (BMC) - H410C
* NetApp HCI Baseboard Management Controller (BMC) - H610C
* NetApp HCI Baseboard Management Controller (BMC) - H610S
* NetApp HCI Baseboard Management Controller (BMC) - H615C
* NetApp HCI Compute Node (Bootstrap OS)
* NetApp HCI Compute Node BIOS
* NetApp HCI Storage Node BIOS
* NetApp Kubernetes Monitoring Operator
* NetApp Manageability SDK
* NetApp NFS Plug-in for VMware VAAI
* NetApp ONTAP PowerShell Toolkit (PSTK)
* NetApp SolidFire & HCI Management Node
* NetApp SolidFire & HCI Storage Node (Element Software)
* NetApp SolidFire Plug-in for vRealize Orchestrator (SolidFire vRO)
* NetApp XCP NFS
* NetApp XCP SMB
* ONTAP 9 (formerly Clustered Data ONTAP)
* ONTAP Antivirus Connector
* ONTAP Mediator
* ONTAP tools for VMware vSphere 9
* OnCommand Insight
* OnCommand Workflow Automation
* SANtricity Storage Plugin for vCenter
* SRA Plugin for Linux
* SRA Plugin for Windows
* Single Mailbox Recovery
* Snap Creator Framework
* SnapCenter
* SnapCenter Plug-in for VMware vSphere/BlueXP backup and Recovery for Virtual Machine
* SnapManager for Hyper-V
* SolidFire Storage Replication Adapter
* StorageGRID (formerly StorageGRID Webscale)
* StorageGRID BIOS SG1000/SG100
* StorageGRID BIOS SG5660/SG5612/SG5760/SG5712
* StorageGRID BIOS SG6060/SGF6024
* StorageGRID Baseboard Management Controller (BMC)
* System Manager 9.x

Remediation
#### Software Versions and Fixes

NetApp's currently available patches are listed below.

| **Product** | **First Fixed in Release** |
| --- | --- |
| **Management Services for Element Software and NetApp HCI** | <https://mysupport.netapp.com/site/products/all/details/mgmtservices/downloads-tab/download/63086/2.23.64> |
| **NetApp E-Series Performance Analyzer** | NetApp E-Series Performance Analyzer has no plans to address this vulnerability. See the [EOA announcement](https://github.com/NetApp/eseries-perf-analyzer) for more information. |
| **ONTAP Select Deploy administration utility** | <https://mysupport.netapp.com/site/products/all/details/ontapselect-deploy/downloads-tab/download/62910/9.13.1> |

#### Workarounds

None at this time.

#### Obtaining Software Fixes

Software fixes will be made available through the NetApp Support website in the Software Download section.

<https://mysupport.netapp.com/site/downloads/>

Customers who do not have access to the Support website should contact Technical Support at the number below to obtain the patches.

#### Contact Information

Check <http://mysupport.netapp.com> for further
updates.

**Technical Support**

Revision History
#### Status of This Notice

**Final.**

This advisory should be considered the single source of current, up-to-date, authorized and accurate information from NetApp regarding Full Support products and versions.

This advisory is posted at the following link:

<https://security.netapp.com/advisory/NTAP-20230216-0008>
#### Revision History

| **Revision #** | **Date** | **Comments** |
| --- | --- | --- |
| 1.0 | 20230216 | Initial Public Release |
| 2.0 | 20230228 | ONTAP 9 (formerly Clustered Data ONTAP) moved to Products Not Affected |
| 3.0 | 20230307 | NetApp E-Series Performance Analyzer moved to Won't Fix status |
| 4.0 | 20230328 | Management Services for Element Software and NetApp HCI added to Software Versions and Fixes |
| 5.0 | 20230501 | NetApp SolidFire & HCI Management Node moved to Affected Products |
| 6.0 | 20231004 | NetApp SolidFire & HCI Management Node moved to Products Not Affected |
| 7.0 | 20240124 | ONTAP Select Deploy administration utility 9.13.1 added to Software Versions and Fixes, Final status |

This document is provided solely for informational purposes. All information is based upon NetAppâs current knowledge and understanding of the hardware and software products tested by NetApp, and the methodology and assumptions used by NetApp. NetApp is not responsible for any errors or omissions that may be contained herein, and no warranty, representation, or other legal commitment or obligation is being provided by NetApp. Â© 2025 NetApp, Inc. All rights reserved. No portions of this document may be reproduced without prior written consent of NetApp, Inc.

 ©  NetApp

Have feedback for our website?
[Let us know](https://www.netapp.com/forms/site-feedback/)



=== Content from github.com_4d3d9cd4_20250108_153853.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fheimdal%2Fheimdal%2Fpull%2F1024)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fheimdal%2Fheimdal%2Fpull%2F1024)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=heimdal%2Fheimdal)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[heimdal](/heimdal)
/
**[heimdal](/heimdal/heimdal)**
Public

* [Notifications](/login?return_to=%2Fheimdal%2Fheimdal) You must be signed in to change notification settings
* [Fork
  178](/login?return_to=%2Fheimdal%2Fheimdal)
* [Star
   331](/login?return_to=%2Fheimdal%2Fheimdal)

* [Code](/heimdal/heimdal)
* [Issues
  182](/heimdal/heimdal/issues)
* [Pull requests
  73](/heimdal/heimdal/pulls)
* [Discussions](/heimdal/heimdal/discussions)
* [Actions](/heimdal/heimdal/actions)
* [Projects
  0](/heimdal/heimdal/projects)
* [Wiki](/heimdal/heimdal/wiki)
* [Security](/heimdal/heimdal/security)
* [Insights](/heimdal/heimdal/pulse)

Additional navigation options

* [Code](/heimdal/heimdal)
* [Issues](/heimdal/heimdal/issues)
* [Pull requests](/heimdal/heimdal/pulls)
* [Discussions](/heimdal/heimdal/discussions)
* [Actions](/heimdal/heimdal/actions)
* [Projects](/heimdal/heimdal/projects)
* [Wiki](/heimdal/heimdal/wiki)
* [Security](/heimdal/heimdal/security)
* [Insights](/heimdal/heimdal/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fheimdal%2Fheimdal%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fheimdal%2Fheimdal%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# CVE-2022-42898: lib/krb5: fix \_krb5\_get\_int64 on systems where 'unsigned long' is just 32-bit #1024

 Closed

[metze-samba](/metze-samba)
wants to merge
1
commit into
[heimdal:master](/heimdal/heimdal/tree/master "heimdal/heimdal:master")
from
[metze-samba:heimdal-32bit](/metze-samba/heimdal/tree/heimdal-32bit "metze-samba/heimdal:heimdal-32bit")

 Closed

# [CVE-2022-42898: lib/krb5: fix \_krb5\_get\_int64 on systems where 'unsigned long' is just 32-bit](#top) #1024

[metze-samba](/metze-samba)
wants to merge
1
commit into
[heimdal:master](/heimdal/heimdal/tree/master "heimdal/heimdal:master")
from
[metze-samba:heimdal-32bit](/metze-samba/heimdal/tree/heimdal-32bit "metze-samba/heimdal:heimdal-32bit")

[Conversation
1](/heimdal/heimdal/pull/1024)
[Commits
1](/heimdal/heimdal/pull/1024/commits)
[Checks
0](/heimdal/heimdal/pull/1024/checks)
[Files changed](/heimdal/heimdal/pull/1024/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![metze-samba](https://avatars.githubusercontent.com/u/17027612?s=60&v=4)](/metze-samba)

Copy link

Contributor

### @metze-samba **[metze-samba](/metze-samba)** commented [Nov 16, 2022](#issue-1451774852)

See: <https://bugzilla.samba.org/show_bug.cgi?id=15203>

Sorry, something went wrong.

All reactions

[![@metze-samba](https://avatars.githubusercontent.com/u/17027612?s=40&v=4)](/metze-samba)

`[CVE-2022-42898: lib/krb5: fix _krb5_get_int64 on systems where 'unsig…](/heimdal/heimdal/pull/1024/commits/172b656b6738ae07f5d53427e522dab414117141 "CVE-2022-42898: lib/krb5: fix _krb5_get_int64 on systems where 'unsigned long' is just 32-bit

BUG: https://bugzilla.samba.org/show_bug.cgi?id=15203

Signed-off-by: Stefan Metzmacher <metze@samba.org>
Reviewed-by: Ralph Boehme <slow@samba.org>")`
 …

`[172b656](/heimdal/heimdal/pull/1024/commits/172b656b6738ae07f5d53427e522dab414117141)`

```
…ned long' is just 32-bit

BUG: <https://bugzilla.samba.org/show_bug.cgi?id=15203>

Signed-off-by: Stefan Metzmacher <metze@samba.org>
Reviewed-by: Ralph Boehme <slow@samba.org>
```

[![@jaltman](https://avatars.githubusercontent.com/u/206466?s=80&v=4)](/jaltman)

Copy link

Member

### **[jaltman](/jaltman)** commented [Nov 16, 2022](#issuecomment-1317187279)

| We will take [#1025](https://github.com/heimdal/heimdal/pull/1025) instead since the commit message provides additional details. Thank you for the submission. |
| --- |

All reactions

Sorry, something went wrong.

[![@jaltman](https://avatars.githubusercontent.com/u/206466?s=40&v=4)](/jaltman)
[jaltman](/jaltman)
closed this
[Nov 16, 2022](#event-7825126059)

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fheimdal%2Fheimdal%2Fpull%2F1024)

Reviewers

No reviews

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

Successfully merging this pull request may close these issues.

2 participants

[![@metze-samba](https://avatars.githubusercontent.com/u/17027612?s=52&v=4)](/metze-samba) [![@jaltman](https://avatars.githubusercontent.com/u/206466?s=52&v=4)](/jaltman)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_39249a07_20250108_124414.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fheimdal%2Fheimdal%2Fsecurity%2Fadvisories%2FGHSA-64mq-fvfj-5x3c)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fheimdal%2Fheimdal%2Fsecurity%2Fadvisories%2FGHSA-64mq-fvfj-5x3c)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=heimdal%2Fheimdal)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[heimdal](/heimdal)
/
**[heimdal](/heimdal/heimdal)**
Public

* [Notifications](/login?return_to=%2Fheimdal%2Fheimdal) You must be signed in to change notification settings
* [Fork
  178](/login?return_to=%2Fheimdal%2Fheimdal)
* [Star
   331](/login?return_to=%2Fheimdal%2Fheimdal)

* [Code](/heimdal/heimdal)
* [Issues
  182](/heimdal/heimdal/issues)
* [Pull requests
  73](/heimdal/heimdal/pulls)
* [Discussions](/heimdal/heimdal/discussions)
* [Actions](/heimdal/heimdal/actions)
* [Projects
  0](/heimdal/heimdal/projects)
* [Wiki](/heimdal/heimdal/wiki)
* [Security](/heimdal/heimdal/security)
* [Insights](/heimdal/heimdal/pulse)

Additional navigation options

* [Code](/heimdal/heimdal)
* [Issues](/heimdal/heimdal/issues)
* [Pull requests](/heimdal/heimdal/pulls)
* [Discussions](/heimdal/heimdal/discussions)
* [Actions](/heimdal/heimdal/actions)
* [Projects](/heimdal/heimdal/projects)
* [Wiki](/heimdal/heimdal/wiki)
* [Security](/heimdal/heimdal/security)
* [Insights](/heimdal/heimdal/pulse)

# PAC parse integer overflows

Moderate

[nicowilliams](/nicowilliams)
published
GHSA-64mq-fvfj-5x3c
Nov 15, 2022

## Package

heimdal

## Affected versions

<7.7.1

## Patched versions

7.7.1, 7.8

## Description

### Impact

This is a denial of service vulnerability for Heimdal KDCs and possibly Heimdal servers (e.g., via GSS-API).

### Patches

Users should upgrade to Heimdal 7.7.1 or Heimdal 7.8.

### References

<https://bugzilla.samba.org/show_bug.cgi?id=15203>

### For more information

If you have any questions or comments about this advisory:

* Open an issue in [Heimdal](https://github.com/heimdal/heimdal/issues)
* Email us at heimdal-security@heimdal.team

### Severity

Moderate

5.3

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Network

Attack complexity
Low

Privileges required
None

User interaction
None

Scope
Unchanged

Confidentiality
None

Integrity
None

Availability
Low

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L

### CVE ID

CVE-2022-42898

### Weaknesses

No CWEs

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from bugzilla.samba.org_fd351fcc_20250108_124413.html ===


The Samba-Bugzilla – Bug 15203
CVE-2022-42898 [SECURITY] krb5\_pac\_parse() buffer parsing vulnerability
Last modified: 2023-01-11 16:01:02 UTC

* [Home](./)
* | [New](enter_bug.cgi)
* | [Browse](describecomponents.cgi)
* | [Search](query.cgi)
* |

  [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
* | [Reports](report.cgi)
* |
  [Requests](request.cgi)
* |
  [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
* |
  [New Account](createaccount.cgi)
* |
  [Log In](show_bug.cgi?id=15203&GoAheadAndLogIn=1)

  [x]
* |
  [Forgot Password](show_bug.cgi?id=15203&GoAheadAndLogIn=1#forgot)
  Login:

  [x]

[**Bug 15203**](show_bug.cgi?id=15203)
(CVE-2022-42898)
- CVE-2022-42898 [SECURITY] krb5\_pac\_parse() buffer parsing vulnerability

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
CVE-2022-42898 [SECURITY] krb5\_pac\_parse() buffer parsing vulnerability

| | [Status](page.cgi?id=fields.html#bug_status): | RESOLVED FIXED | | --- | --- | |  | | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | CVE-2022-42898 | |  | | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components.") | Samba 4.1 and newer | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Unclassified | | [Component:](describecomponents.cgi?product=Samba 4.1 and newer "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | AD: LDB/DSDB/SAMDB ([show other bugs](buglist.cgi?component=AD%3A%20LDB%2FDSDB%2FSAMDB&product=Samba%204.1%20and%20newer&bug_status=__open__)) | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | 4.17.0 | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | All All | |  | | | [Importance](page.cgi?id=fields.html#importance): | P5 normal ([vote](page.cgi?id=voting/user.html&bug_id=15203#vote_15203)) | | [Target Milestone:](page.cgi?id=fields.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | --- | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Jule Anger | | [QA Contact:](page.cgi?id=fields.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") | Samba QA Contact | |  | | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Keywords:](describekeywords.cgi "You can add keywords from a defined list to bugs, in order to easily identify and group them.") |  | |  | | | [Depends on:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") |  | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") |  | |  | | Reported: | 2022-10-13 19:23 UTC by Andrew Bartlett | | --- | --- | | Modified: | 2023-01-11 16:01 UTC ([History](show_activity.cgi?id=15203)) | | CC List: | 17 users (show)  ab abartlet asn diana.della.rocchetta ghudson jaltman janger jonessyue jrische jsutton metze Muskaan.kalra nico samba-vendor seth.ellsworth slow ware | |  | | | [See Also:](page.cgi?id=fields.html#see_also "This allows you to refer to bugs in other installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with whitespace. You should normally use this field to refer to bugs in other installations. For bugs in this installation, it is better to use the Depends on and Blocks fields.") | * <https://github.com/heimdal/heimdal/pull/1024> | |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | | | | --- | --- | --- | | [**proposed patch for master v1**](attachment.cgi?id=17565 "View the content of the attachment") (17.56 KB, patch)  [2022-10-17 07:34 UTC](#attach_17565 "Go to the comment associated with the attachment"), Jennifer Sutton | *no flags* | [Details](attachment.cgi?id=17565&action=edit) | | [**proposed patch for master v2**](attachment.cgi?id=17567 "View the content of the attachment") (18.49 KB, patch)  [2022-10-18 04:33 UTC](#attach_17567 "Go to the comment associated with the attachment"), Jennifer Sutton | *no flags* | [Details](attachment.cgi?id=17567&action=edit) | | [**proposed patch for Heimdal master v2**](attachment.cgi?id=17597 "View the content of the attachment") (17.73 KB, patch)  [2022-10-21 22:55 UTC](#attach_17597 "Go to the comment associated with the attachment"), Jennifer Sutton | *no flags* | [Details](attachment.cgi?id=17597&action=edit) | | [**Nico's version of Joseph's patch for Heimdal**](attachment.cgi?id=17600 "View the content of the attachment") (34.06 KB, text/plain)  [2022-10-25 06:15 UTC](#attach_17600 "Go to the comment associated with the attachment"), nico | *no flags* | [Details](attachment.cgi?id=17600&action=edit) | | [**MIT krb5 fix**](attachment.cgi?id=17617 "View the content of the attachment") (3.44 KB, text/plain)  [2022-11-03 21:35 UTC](#attach_17617 "Go to the comment associated with the attachment"), Greg Hudson | *no flags* | [Details](attachment.cgi?id=17617&action=edit) | | [**patch for Samba master v3**](attachment.cgi?id=17618 "View the content of the attachment") (34.51 KB, patch)  [2022-11-04 02:15 UTC](#attach_17618 "Go to the comment associated with the attachment"), Jennifer Sutton | abartlet: review+  abartlet: review? (metze) jsutton: ci-passed+ | [Details](attachment.cgi?id=17618&action=edit) | | [**patch for Samba 4.17 v3**](attachment.cgi?id=17619 "View the content of the attachment") (34.51 KB, patch)  [2022-11-04 02:18 UTC](#attach_17619 "Go to the comment associated with the attachment"), Jennifer Sutton | abartlet: review+  abartlet: review? (metze) jsutton: ci-passed+ | [Details](attachment.cgi?id=17619&action=edit) | | [**patch for Samba 4.16 v3**](attachment.cgi?id=17620 "View the content of the attachment") (34.51 KB, patch)  [2022-11-04 02:18 UTC](#attach_17620 "Go to the comment associated with the attachment"), Jennifer Sutton | abartlet: review+  abartlet: review? (metze) jsutton: ci-passed+ | [Details](attachment.cgi?id=17620&action=edit) | | [**patch for Samba 4.15 v3**](attachment.cgi?id=17621 "View the content of the attachment") (40.27 KB, patch)  [2022-11-04 02:19 UTC](#attach_17621 "Go to the comment associated with the attachment"), Jennifer Sutton | abartlet: review+  abartlet: review? (metze) jsutton: ci-passed+ | [Details](attachment.cgi?id=17621&action=edit) | | [**Samba advisory v1**](attachment.cgi?id=17622 "View the content of the attachment") (2.96 KB, text/plain)  [2022-11-04 02:37 UTC](#attach_17622 "Go to the comment associated with the attachment"), Jennifer Sutton | *no flags* | [Details](attachment.cgi?id=17622&action=edit) | | [**Critical fixes to be in Heimdal 7.7.1 and 7.8**](attachment.cgi?id=17623 "View the content of the attachment") (10.65 KB, application/x-compressed)  [2022-11-04 02:42 UTC](#attach_17623 "Go to the comment associated with the attachment"), nico | *no flags* | [Details](attachment.cgi?id=17623&action=edit) | | [**All the commits from heimdal-7.7.0 to heimdal-7-7.1**](attachment.cgi?id=17624 "View the content of the attachment") (63.50 KB, application/octet-stream)  [2022-11-04 02:46 UTC](#attach_17624 "Go to the comment associated with the attachment"), nico | *no flags* | [Details](attachment.cgi?id=17624&action=edit) | | [**Advisory v2**](attachment.cgi?id=17625 "View the content of the attachment") (2.67 KB, text/plain)  [2022-11-04 08:38 UTC](#attach_17625 "Go to the comment associated with the attachment"), Andrew Bartlett | jsutton: review+  ghudson: review+ | [Details](attachment.cgi?id=17625&action=edit) | | [**Just the CVE patches for Heimdal 7.7.1**](attachment.cgi?id=17627 "View the content of the attachment") (85.32 KB, patch)  [2022-11-04 15:13 UTC](#attach_17627 "Go to the comment associated with the attachment"), nico | *no flags* | [Details](attachment.cgi?id=17627&action=edit) | | [**32-bit regression fix for 4.15**](attachment.cgi?id=17657 "View the content of the attachment") (1022 bytes, patch)  [2022-11-16 14:52 UTC](#attach_17657 "Go to the comment associated with the attachment"), Stefan Metzmacher | slow: review+ | [Details](attachment.cgi?id=17657&action=edit) | | [**32-bit regression fix for 4.16**](attachment.cgi?id=17658 "View the content of the attachment") (1.02 KB, patch)  [2022-11-16 14:53 UTC](#attach_17658 "Go to the comment associated with the attachment"), Stefan Metzmacher | slow: review+ | [Details](attachment.cgi?id=17658&action=edit) | | [**32-bit regression fix for 4.17**](attachment.cgi?id=17659 "View the content of the attachment") (1.02 KB, patch)  [2022-11-16 14:54 UTC](#attach_17659 "Go to the comment associated with the attachment"), Stefan Metzmacher | slow: review+ | [Details](attachment.cgi?id=17659&action=edit) | | [Show Obsolete](#a0) (4) [View All](attachment.cgi?bugid=15203&action=viewall&hide_obsolete=1)  [Add an attachment](attachment.cgi?bugid=15203&action=enter) (proposed patch, testcase, etc.) | | |   | Note You need to [log in](show_bug.cgi?id=15203&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. | | --- | |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=15203#c0)  Andrew Bartlett    2022-10-13 19:23:43 UTC  ``` Greg Hudson of the MIT Kerberos project has contacted the Samba security alias to report an issue that appears to be in common between Heimdal and MIT Kerberos regarding the parsing of the (initially Microsoft AD) PAC in Kerberos.  MIT has had MITRE reserved CVE-2022-42898 for the MIT krb5 vulnerability and as this is essentially the same issue, we will use that also. ```  [Comment 1](show_bug.cgi?id=15203#c1)  Andrew Bartlett    2022-10-13 19:25:30 UTC  ``` Analysis and detail from Greg Hudson (in a separate comment so we can redact this if need be or for a time when we make this public):  In the initial impact analysis, I wrote "It may be difficult to get the  KDC to do anything worse than crash" because the read and write overruns  are necessarily long.  I need to revise this analysis, because  krb5_parse_pac() will stop and return an error (after freeing the  nascent PAC) if it encounters a buffer with an invalid offset or length.  This checking makes the read overrun fairly innocuous by itself.  In the  necessarily long foray into KDC memory beyond the PAC encoding, we will  (probably quickly) run into an invalid buffer specification and stop.  In rare circumstances we might get far enough to crash.  However, the potential heap write overrun on 32-bit platforms is more  potent than I had initially thought.  The crafted PAC would presumably  contain some valid buffers containing the data the attacker wants to  deposit into the heap, and then an invalid buffer to terminate parsing  before the process crashes.  Execution would then continue with a  corrupted heap.  On 10/13/22 01:26, Greg Hudson wrote: > A fuzzer discovered that MIT libkrb5's krb5_pac_parse() will do a read > overrun on the following input: >  >      00 00 00 10 00 00 00 00 06 FF FF FF 00 00 F5 >  > That information has been made public (due to an apparent bug in the > fuzzer, which erroneously determined that the bug had been fixed).  My > analysis below has not been made public. >  > The first four bytes are the number of PAC buffers (little-endian). > krb5_pac_parse() performs a bounds check on this value as follows: >  >      header_len = PACTYPE_LENGTH + (cbuffers * PAC_INFO_BUFFER_LENGTH); >      if (len < header_len) >          return ERANGE; >  > where cbuffers is a uint32_t value read from the first four bytes and > len is the PAC encoding length.  This check is subject to an integer > overflow attack.  Heimdal libkrb5 appears to have a similar bug: >  >      header_end = PACTYPE_SIZE + (PAC_INFO_BUFFER_SIZE * p->pac->numbuffers); >      if (header_end > len) { >       ret = EINVAL; >       goto out; >      } >  > where the numbuffers field also also has type uint32_t. >  > Both implementations also appear to have an integer overflow > vulnerability where they allocate memory, on 32-bit platforms (MIT krb5 > and Heimdal respectively): >  >      pac->pac = (PACTYPE *)realloc(pac->pac, >                                    sizeof(PACTYPE) + ((cbuffers - 1) * sizeof(PAC_INFO_BUFFER))); >  >      p->pac = calloc(1, >                   sizeof(*p->pac) + (sizeof(p->pac->buffers[0]) * (tmp - 1))); >  > On 64-bit platforms there shouldn't be any possibility of overflow > during allocation because the use of sizeof() will coerce the > addition and multiplication operands to uint64_t. >  > I believe all of these lines of code have been present in their current > form for a long time (since MIT krb5 1.7, and since 2006 in Heimdal). >  > Impact analysis: >  > PACs are typically only parsed after extraction from a decrypted ticket, > so the attacker needs to produce a ticket that the victim can decrypt. > This protects services to some extent (the attacker must possess the > service key, so has the privileges of either the local KDC or the > service).  But the KDC is an easier target; likely any authenticated > attacker can print a ticket encrypted with their own long-term key and > get the KDC to parse the PAC contained within.  (The MIT krb5 KDC prior > to 1.20 and without Samba/FreeIPA integration won't try to parse PACs, > and is therefore not vulnerable.) >  > It may be difficult to get the KDC to do anything worse than crash.  If > the bounds check is defeated and (on a 32-bit platform) insufficient > space is allocated for the buffers, there will be a heap write overrun > with data partly of the attacker's choosing, but since the buffer count > must be very large, it seems likely that the KDC process will crash on > either a read or a write before returning from krb5_parse_pac(). ```  [Comment 2](show_bug.cgi?id=15203#c2)  Jennifer Sutton    2022-10-17 07:34:24 UTC  ``` Created [attachment 17565](attachment.cgi?id=17565 "proposed patch for master v1") [[details]](attachment.cgi?id=17565&action=edit "proposed patch for master v1") proposed patch for master v1 ```  [Comment 3](show_bug.cgi?id=15203#c3)  Andrew Bartlett    2022-10-18 01:34:40 UTC  ``` Joseph showed me though the code in Samba, and our initial view is that Samba and Heimdal master (eg 8.0pre) is not impacted as we can't find a code-path to krb5_parse_pac() not already encoded in a krbtgt-encrypted ticket.  It would of course be possible to attack the DC from an RODC, but for 64-bit installs, we can't see major harm from the only multiplication overflow.   So we are left with an attack from an RODC of a 32 bit full DC.  CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:U/C:L/I:H/A:L  We have not checked Heimdal 0.7 and Samba 4.15 yet, but will update this if we find anything else.  Upstream Heimdal does not support RODCs and so would not be impacted, meaning we should be free to coordinate only with MIT, allowing Heimdal to just patch in master after the embargo is lifted.   Does anybody have a counter-analysis?  Andrew, ```  [Comment 4](show_bug.cgi?id=15203#c4)  Greg Hudson    2022-10-18 02:05:38 UTC  ``` > Joseph showed me though the code in Samba, and our initial view is that Samba and Heimdal master (eg 8.0pre) is not impacted as we can't find a code-path to krb5_parse_pac() not already encoded in a krbtgt-encrypted ticket.  What about the evidence ticket in an S4U2Proxy request?  It should be encrypted in a service's key, not a krbtgt key, and its PAC should be important enough to parse.  It is also possible to submit a service ticket for renewal.  I don't think Samba considers that an interesting case but I don't know if anything prevents it in Samba, or if upstream Heimdal allows it and parses the PAC. ```  [Comment 5](show_bug.cgi?id=15203#c5)  Andrew Bartlett    2022-10-18 02:16:38 UTC  ``` Further reading of course brings up the enc_authorization_data path that is the reason why a PAC must be signed.    Thankfully in Samba we add a new PAC in front at all times (and multiple PACs are rejected at parse time), but upstream Heimdal would not get the forced-in 'real' PAC so this could be an issue.  However yes, S4U2Proxy (as attacked with the so-called Bronze Bit) looks like a valid path in, without needing an RODC:  CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:L/I:H/A:L (6.4)  (on a 32bit DC)  It looks again like this will require a coordinated release across Heimdal / Samba / MIT / FreeIPA. ```  [Comment 6](show_bug.cgi?id=15203#c6)  Jennifer Sutton    2022-10-18 02:36:25 UTC  ``` Heimdal appears to respect AS-REQ KRB5_PADATA_PA_PAC_REQUEST options when deciding whether to put a PAC in a TGT. Therefore a malicious PAC in the 'enc-authorization-data' field of a TGT renewal request could end up as the only one in the ticket, which Heimdal would parse in subsequent requests. ```  [Comment 7](show_bug.cgi?id=15203#c7)  Jennifer Sutton    2022-10-18 02:59:42 UTC  ``` (In reply to Joseph Sutton from [comment #6](show_bug.cgi?id=15203#c6)) > Heimdal appears to respect AS-REQ KRB5_PADATA_PA_PAC_REQUEST options when > deciding whether to put a PAC in a TGT.  However, it will add a PAC regardless if the server principal is the krbtgt, so the enc-authorization-data path is made more difficult to exploit in Heimdal's master branch. ```  [Comment 8](show_bug.cgi?id=15203#c8)  Jennifer Sutton    2022-10-18 04:33:46 UTC  ``` Created [attachment 17567](attachment.cgi?id=17567 "proposed patch for master v2") [[details]](attachment.cgi?id=17567&action=edit "proposed patch for master v2") proposed patch for master v2  Addressed a few more potential overflows. ```  [Comment 9](show_bug.cgi?id=15203#c9)  Jennifer Sutton    2022-10-21 22:55:34 UTC  ``` Created [attachment 17597](attachment.cgi?id=17597 "proposed patch for Heimdal master v2") [[details]](attachment.cgi?id=17597&action=edit "proposed patch for Heimdal master v2") proposed patch for Heimdal master v2 ```  [Comment 10](show_bug.cgi?id=15203#c10)  nico    2022-10-25 06:15:31 UTC  ``` Created [attachment 17600](attachment.cgi?id=17600 "Nico's version of Joseph's patch for Heimdal") [[details]](attachment.cgi?id=17600&action=edit "Nico's version of Joseph's patch for Heimdal") Nico's version of Joseph's patch for Heimdal  My version of Joseph's patch.  Heavily edited to add more checks, fix a bug in the original (not Joseph's patch), simplify some code by adding an `addend` argument to `pac_aligned_size()`, add commentary, and add tests. ```  [Comment 11](show_bug.cgi?id=15203#c11)  Greg Hudson    2022-11-03 21:35:41 UTC  ``` Created [attachment 17617](attachment.cgi?id=17617 "MIT krb5 fix") [[details]](attachment.cgi?id=17617&action=edit "MIT krb5 fix") MIT krb5 fix  I am attaching the MIT krb5 patch for the benefit of vendors when they are added to this bug. ```  [Comment 12](show_bug.cgi?id=15203#c12)  Jennifer Sutton    2022-11-04 02:15:42 UTC  ``` Created [attachment 17618](attachment.cgi?id=17618 "patch for Samba master v3") [[details]](attachment.cgi?id=17618&action=edit "patch for Samba master v3") patch for Samba master v3 ```  [Comment 13](show_bug.cgi?id=15203#c13)  Jennifer Sutton    2022-11-04 02:18:12 UTC  ``` Created [attachment 17619](attachment.cgi?id=17619 "patch for Samba 4.17 v3") [[details]](attachment.cgi?id=17619&action=edit "patch for Samba 4.17 v3") patch for Samba 4.17 v3 ```  [Comment 14](show_bug.cgi?id=15203#c14)  Jennifer Sutton    2022-11-04 02:18:53 UTC  ``` Created [attachment 17620](attachment.cgi?id=17620 "patch for Samba 4.16 v3") [[details]](attachment.cgi?id=17620&action=edit "patch for Samba 4.16 v3") patch for Samba 4.16 v3 ```  [Comment 15](show_bug.cgi?id=15203#c15)  Jennifer Sutton    2022-11-04 02:19:59 UTC  ``` Created [attachment 17621](attachment.cgi?id=17621 "patch for Samba 4.15 v3") [[details]](attachment.cgi?id=17621&action=edit "patch for Samba 4.15 v3") patch for Samba 4.15 v3 ```  [Comment 16](show_bug.cgi?id=15203#c16)  Jennifer Sutton    2022-11-04 02:23:36 UTC  ``` Nico, I made a couple of minor changes to your patch. I zero-initialised header_size in krb5_pac_parse() to avoid a maybe-uninitialized error, and I added a 'ret == 0' condition prior to the 'p->pac == NULL' check in the same function. ```  [Comment 17](show_bug.cgi?id=15203#c17)  Jennifer Sutton    2022-11-04 02:37:04 UTC  ``` Created [attachment 17622](attachment.cgi?id=17622 "Samba advisory v1") [[details]](attachment.cgi?id=17622&action=edit "Samba advisory v1") Samba advisory v1 ```  [Comment 18](show_bug.cgi?id=15203#c18)  nico    2022-11-04 02:42:05 UTC  ``` Created [attachment 17623](attachment.cgi?id=17623 "Critical fixes to be in Heimdal 7.7.1 and 7.8") [[details]](attachment.cgi?id=17623&action=edit "Critical fixes to be in Heimdal 7.7.1 and 7.8") Critical fixes to be in Heimdal 7.7.1 and 7.8  These are the critical fixes that will be in Heimdal 7.7.1 and 7.8.  These are not all the commits that will be in 7.7.1 and 7.8.  I will post a tarball of all the commits in 7.7.1 separately. ```  [Comment 19](show_bug.cgi?id=15203#c19)  nico    2022-11-04 02:43:20 UTC  ``` Please review my CVSS scoring of CVE-2022-44640 Heimdal KDC: invalid free in ASN.1 codec.  Maybe I'm being much to severe in my analysis? ```  [Comment 20](show_bug.cgi?id=15203#c20)  nico    2022-11-04 02:46:32 UTC  ``` Created [attachment 17624](attachment.cgi?id=17624 "All the commits from heimdal-7.7.0 to heimdal-7-7.1") [[details]](attachment.cgi?id=17624&action=edit "All the commits from heimdal-7.7.0 to heimdal-7-7.1") All the commits from heimdal-7.7.0 to heimdal-7-7.1  These are all the commits that will be in heimdal 7.7.1. ```  [Comment 21](show_bug.cgi?id=15203#c21)  nico    2022-11-04 02:49:24 UTC  ``` (In reply to Joseph Sutton from [comment #16](show_bug.cgi?id=15203#c16))  Which attachment is that in?  Can you post just a diff to my patch (and then I'll update the attachments I just added.)? ```  [Comment 22](show_bug.cgi?id=15203#c22)  Jennifer Sutton    2022-11-04 02:55:01 UTC  ``` (In reply to nico from [comment #21](show_bug.cgi?id=15203#c21)) I've included the changes in the patches for Samba on this bug. The diff is just this:  diff --git a/lib/krb5/pac.c b/lib/krb5/pac.c index e39ab3fd88..e6dfe2aef3 100644 --- a/lib/krb5/pac.c +++ b/lib/krb5/pac.c @@ -256,7 +256,7 @@ krb5_pac_parse(krb5_context context, const void *ptr, size_t len,      krb5_error_code ret = 0;      krb5_pac p;      krb5_storage *sp = NULL; -    uint32_t i, num_buffers, version, header_size; +    uint32_t i, num_buffers, version, header_size = 0;      uint32_t prev_start = 0;      uint32_t prev_end = 0;   @@ -289,7 +289,7 @@ krb5_pac_parse(krb5_context context, const void *ptr, size_t len,                                 N_("PAC encoding invalid, would overflow buffers", ""));      if (ret == 0)          p->pac = calloc(1, header_size); -    if (p->pac == NULL) +    if (ret == 0 && p->pac == NULL)  	ret = krb5_enomem(context);        if (ret == 0) { ```  [Comment 23](show_bug.cgi?id=15203#c23)  nico    2022-11-04 03:00:48 UTC  ``` (In reply to Joseph Sutton from [comment #22](show_bug.cgi?id=15203#c22))  Thanks.  That only affects what will be master, and eventually 8.0. ```  [Comment 24](show_bug.cgi?id=15203#c24)  Jennifer Sutton    2022-11-04 03:05:35 UTC  ``` (In reply to nico from [comment #20](show_bug.cgi?id=15203#c20)) I see the overflow fix you've posted for Heimdal 7.7.1 is quite different from the one to be applied to Heimdal master. For Samba 4.15, which uses a much older version of Heimdal, I've backported the fix for modern Heimdal versions. Should I have taken the patch for Heimdal 7.7.1 instead? ```  [Comment 25](show_bug.cgi?id=15203#c25)  nico    2022-11-04 03:14:00 UTC  ``` (In reply to Joseph Sutton from [comment #24](show_bug.cgi?id=15203#c24)) I didn't put that much effort into my backport, admittedly.  If you have a better patch I'd use it.  The delta from 7.7 to master was quite large for that file. ```  [Comment 26](show_bug.cgi?id=15203#c26)  Jennifer Sutton    2022-11-04 03:22:22 UTC  ``` (In reply to nico from [comment #25](show_bug.cgi?id=15203#c25)) The backport I did is in the attachment 'patch for Samba 4.15 v3'. It would take a bit of effort to port it back to Heimdal 7.7.0, which is somewhat newer than Samba 4.15's Heimdal version. ```  [Comment 27](show_bug.cgi?id=15203#c27)  nico    2022-11-04 04:44:12 UTC  ``` (In reply to Joseph Sutton from [comment #26](show_bug.cgi?id=15203#c26)) I'm running out of time since I have to take half of tomorrow off, unless we don't have to have the final patches tomorrow.  Also, you'll want to backport some of the other CVE fixes I attached. ```  [Comment 28](show_bug.cgi?id=15203#c28)  Jennifer Sutton    2022-11-04 05:14:26 UTC  ``` (In reply to nico from [comment #27](show_bug.cgi?id=15203#c27)) I guess you can go with the backported patch you already have, if the differences between it and the master patch are inconsequential.  I checked the patchset you uploaded containing the other CVE fixes, and I think all of the CVEs that would apply to Samba should have already been fixed. ```  [Comment 29](show_bug.cgi?id=15203#c29)  Andrew Bartlett    2022-11-04 08:38:40 UTC  ``` Created [attachment 17625](attachment.cgi?id=17625 "Advisory v2") [[details]](attachment.cgi?id=17625&action=edit "Advisory v2") Advisory v2  I've trimmed down the advisory and made it more useful to our administrators.  I've added a credit to Greg, who I understand provided the initial text this is based on.  Looking over this, I would also like our pre-announcement to specify this is only a concern to 32bit systems, to avoid scaring most folks. ```  [Comment 30](show_bug.cgi?id=15203#c30)  Andrew Bartlett    2022-11-04 09:06:59 UTC  ``` Assigning to Jule to schedule for a Samba security release.    I've asked for some additional review as the Heimdal changes are complex, but I think these are ready. ```  [Comment 31](show_bug.cgi?id=15203#c31)  nico    2022-11-04 14:45:51 UTC  ``` Keep in mind that our patches include the fix for the ASN.1 issue.  I can probably trim the 7.7.1 release commits more, but I'm a pumpkin today. ```  [Comment 32](show_bug.cgi?id=15203#c32)  nico    2022-11-04 15:13:27 UTC  ``` Created [attachment 17627](attachment.cgi?id=17627 "Just the CVE patches for Heimdal 7.7.1") [[details]](attachment.cgi?id=17627&action=edit "Just the CVE patches for Heimdal 7.7.1") Just the CVE patches for Heimdal 7.7.1  This is just the CVE patches and two more for Heimdal 7.7.0 -> 7.7.1. ```  [Comment 33](show_bug.cgi?id=15203#c33)  nico    2022-11-04 15:14:08 UTC  ``` (In reply to Andrew Bartlett from [comment #30](show_bug.cgi?id=15203#c30)) I've added a smaller set of patches for 7.7.1. ```  [Comment 34](show_bug.cgi?id=15203#c34)  Andrew Bartlett    2022-11-04 17:27:09 UTC  ``` Comment on [attachment 17618](attachment.cgi?id=17618 "patch for Samba master v3") [[details]](attachment.cgi?id=17618&action=edit "patch for Samba master v3") patch for Samba master v3  Some thoughts from overnight:   We should have an additional restriction that the number of buffers (the primary input to the multiplication) is restricted such that len / packed_buffer_size > numbuffers.  That way, the attacker has to supply as many buffers as they wish to allocate, and so the maximum packet that can be ingested restricts the size that they can force to allocate on the server.   We should also just clamp the number of buffers to 1000. ```  [Comment 35](show_bug.cgi?id=15203#c35)  Andrew Bartlett    2022-11-04 17:58:38 UTC  ``` (In reply to nico from [comment #31](show_bug.cgi?id=15203#c31)) Thankfully Samba 4.15 and older's snapshot is so old the ASN.1 use-after-free can't be accessed per our previous analysis, but we will re-check.  Samba 4.16 and later uses the new ASN.1 template mode that doesn't suffer from this issues as we understand it. ```  [Comment 36](show_bug.cgi?id=15203#c36)  Greg Hudson    2022-11-04 18:21:06 UTC  ``` (In reply to Andrew Bartlett from [comment #34](show_bug.cgi?id=15203#c34)) > We should have an additional restriction that the number of buffers (the primary input to the multiplication) is restricted such that len / packed_buffer_size > numbuffers.  The existing header_len(MIT)/header_end(Heimdal) checks should address this once overflows in those computations are prevented.  > We should also just clamp the number of buffers to 1000.  I saw this in Nico's Heimdal v2 patch, but maybe not the smaller one he plans to put in the release?  (That is, I don't see it in 0014-krb5-CVE-2022-42898-PAC-parse-integer-overflows.patch from the tarball.)  It shouldn't be strictly necessary.  The MIT patch requires the buffer count to be in [1,4096]. ```  [Comment 37](show_bug.cgi?id=15203#c37)  nico    2022-11-05 00:35:20 UTC  ``` (In reply to Greg Hudson from [comment #36](show_bug.cgi?id=15203#c36)) I'll update the pac bug fix this weekend, and I'll apply the 1000 buffers limit to it.  Unless someone does a crazy 1-SID-per-buffer extension, 1000 will be enough.  (In reply to Andrew Bartlett from [comment #35](show_bug.cgi?id=15203#c35)) Oh, hmm, the bug in the compiler goes back to 2005, but indeed, not every version of Heimdal has any support for FAST, so I should update the NEWS and announcement (which I've not yet written, and which will have to go out tomorrow). ```  [Comment 38](show_bug.cgi?id=15203#c38)  Andrew Bartlett    2022-11-05 19:08:07 UTC  ``` Opening bug to Samba vendors (and one Heimdal Vendor I'm aware of) ```  [Comment 39](show_bug.cgi?id=15203#c39)  Samba QA Contact    2022-11-15 15:41:02 UTC  ``` This bug was referenced in samba v4-17-stable (Release samba-4.17.3):  5d845feca47822677c9a0e856191b0117f8bb9e4 ```  [Comment 40](show_bug.cgi?id=15203#c40)  Samba QA Contact    2022-11-15 15:41:36 UTC  ``` This bug was referenced in samba v4-16-stable (Release samba-4.16.7):  a8ef840d4362d3ffeab13c1d5fea417511b727c2 ```  [Comment 41](show_bug.cgi?id=15203#c41)  Samba QA Contact    2022-11-15 15:42:51 UTC  ``` This bug was referenced in samba v4-15-stable (Release samba-4.15.12):  8369aee33a0b3de10485dc72223f4653585e3a79 f792d3e3906414d836d186ec279586c13a83ba8d 9c909c57ce7abacd96ba18173a9dc4ba9a7c0230 a3816433ae971830c2b16b366b10283aeb5a87b5 ```  [Comment 42](show_bug.cgi?id=15203#c42)  Jule Anger    2022-11-15 15:48:07 UTC  ``` Removing vendor CC (so that any public comments don't need to be broadcast so widely) and opening these bug to the public. If you wish to continue to be informed about any changes here please CC individually. ```  [Comment 43](show_bug.cgi?id=15203#c43)  Samba QA Contact    2022-11-15 16:03:09 UTC  ``` This bug was referenced in samba v4-15-test:  8369aee33a0b3de10485dc72223f4653585e3a79 f792d3e3906414d836d186ec279586c13a83ba8d 9c909c57ce7abacd96ba18173a9dc4ba9a7c0230 a3816433ae971830c2b16b366b10283aeb5a87b5 ```  [Comment 44](show_bug.cgi?id=15203#c44)  Samba QA Contact    2022-11-15 16:35:18 UTC  ``` This bug was referenced in samba v4-16-test:  a8ef840d4362d3ffeab13c1d5fea417511b727c2 ```  [Comment 45](show_bug.cgi?id=15203#c45)  Samba QA Contact    2022-11-15 16:35:46 UTC  ``` This bug was referenced in samba v4-17-test:  5d845feca47822677c9a0e856191b0117f8bb9e4 ```  [Comment 46](show_bug.cgi?id=15203#c46)  Samba QA Contact    2022-11-15 17:03:03 UTC  ``` This bug was referenced in samba master:  434f461e9e5a914d4e5a9141324f1705e5e50cf9 ```  [Comment 47](show_bug.cgi?id=15203#c47)  Stefan Metzmacher    2022-11-16 11:07:36 UTC  ``` There's a regression on 32-bit builds!  The error message contains something like this: PAC offset inside header: 0 120  Where offset is 0 because krb5_ret_uint64() doesn't work on 32-bit.  The fix is most likely something like this:  --- a/third_party/heimdal/lib/krb5/store-int.c +++ b/third_party/heimdal/lib/krb5/store-int.c @@ -49,7 +49,7 @@ KRB5_LIB_FUNCTION krb5_ssize_t KRB5_LIB_CALL  _krb5_get_int64(void *buffer, uint64_t *value, size_t size)  {      unsigned char *p = buffer; -    unsigned long v = 0; +    uint64_t v = 0;      size_t i;      for (i = 0; i < size; i++)         v = (v << 8) + p[i]; ```  [Comment 48](show_bug.cgi?id=15203#c48)  Jeffrey Altman    2022-11-16 13:03:31 UTC  ``` I agree with the change to _krb5_get_int64().  I'm curious, what is the value of the 'size' parameter passed from krb5_ret_int()?    Is the return value expected to be greater than MAX_UINT64? ```  [Comment 49](show_bug.cgi?id=15203#c49)  Stefan Metzmacher    2022-11-16 13:20:14 UTC  ``` (In reply to Jeffrey Altman from [comment #48](show_bug.cgi?id=15203#c48))  It's 8 and the bytes are these:  0x78 0x00 0x00 0x00 0x00 0x00 0x00 0x00  When i becomes 4 'v' will be 0 again. As 'unsigned long' is only able to hold 4 bytes. ```  [Comment 50](show_bug.cgi?id=15203#c50)  Jeffrey Altman    2022-11-16 13:24:38 UTC  ``` Do you wish to submit a pull request to Heimdal or should I submit a change in your name? ```  [Comment 51](show_bug.cgi?id=15203#c51)  Stefan Metzmacher    2022-11-16 14:49:35 UTC  ``` (In reply to Stefan Metzmacher from [comment #47](show_bug.cgi?id=15203#c47))  I just tested new packages with that simple fix and everything works again... ```  [Comment 52](show_bug.cgi?id=15203#c52)  Stefan Metzmacher    2022-11-16 14:52:36 UTC  ``` Created [attachment 17657](attachment.cgi?id=17657 "32-bit regression fix for 4.15") [[details]](attachment.cgi?id=17657&action=edit "32-bit regression fix for 4.15") 32-bit regression fix for 4.15 ```  [Comment 53](show_bug.cgi?id=15203#c53)  Stefan Metzmacher    2022-11-16 14:53:19 UTC  ``` Created [attachment 17658](attachment.cgi?id=17658 "32-bit regression fix for 4.16") [[details]](attachment.cgi?id=17658&action=edit "32-bit regression fix for 4.16") 32-bit regression fix for 4.16 ```  [Comment 54](show_bug.cgi?id=15203#c54)  Stefan Metzmacher    2022-11-16 14:54:14 UTC  ``` Created [attachment 17659](attachment.cgi?id=17659 "32-bit regression fix for 4.17") [[details]](attachment.cgi?id=17659&action=edit "32-bit regression fix for 4.17") 32-bit regression fix for 4.17 ```  [Comment 55](show_bug.cgi?id=15203#c55)  Stefan Metzmacher    2022-11-16 15:08:21 UTC  ``` (In reply to Jeffrey Altman from [comment #50](show_bug.cgi?id=15203#c50))  See <https://github.com/heimdal/heimdal/pull/1024> ```  [Comment 56](show_bug.cgi?id=15203#c56)  Jeffrey Altman    2022-11-16 15:15:32 UTC  ``` I raced with you   <https://github.com/heimdal/heimdal/pull/1025> ```  [Comment 57](show_bug.cgi?id=15203#c57)  Samba QA Contact    2022-11-23 15:59:03 UTC  ``` This bug was referenced in samba v4-16-test:  7edddbc684c8098f15063732b9bf13b089e8fae4 ```  [Comment 58](show_bug.cgi?id=15203#c58)  Samba QA Contact    2022-11-23 16:23:03 UTC  ``` This bug was referenced in samba v4-17-test:  c37b4d797ae4065e84ef52610fc1dcf009948685 ```  [Comment 59](show_bug.cgi?id=15203#c59)  Samba QA Contact    2022-11-23 18:55:03 UTC  ``` This bug was referenced in samba v4-15-test:  f3672577a8e15b7937d0067a262d04df632dade9 ```  [Comment 60](show_bug.cgi?id=15203#c60)  Samba QA Contact    2022-11-24 12:06:12 UTC  ``` This bug was referenced in samba master:  dce639f8bd75ecdca261d1dc8b97ce6a8ebb4eb0 ```  [Comment 61](show_bug.cgi?id=15203#c61)  Jule Anger    2022-12-15 09:11:11 UTC  ``` Closing out bug report.  Thanks! ```  [Comment 62](show_bug.cgi?id=15203#c62)  Samba QA Contact    2022-12-15 16:31:46 UTC  ``` This bug was referenced in samba v4-15-stable (Release samba-4.15.13):  f3672577a8e15b7937d0067a262d04df632dade9 ```  [Comment 63](show_bug.cgi?id=15203#c63)  Samba QA Contact    2022-12-15 16:33:06 UTC  ``` This bug was referenced in samba v4-17-stable (Release samba-4.17.4):  c37b4d797ae4065e84ef52610fc1dcf009948685 ```  [Comment 64](show_bug.cgi?id=15203#c64)  Samba QA Contact    2022-12-15 16:36:27 UTC  ``` This bug was referenced in samba v4-16-stable (Release samba-4.16.8):  7edddbc684c8098f15063732b9bf13b089e8fae4 ``` |  |
| --- | --- |

---

* [Format For Printing](show_bug.cgi?format=multiple&id=15203)
* - [XML](show_bug.cgi?ctype=xml&id=15203)
* - [Clone This Bug](enter_bug.cgi?cloned_bug_id=15203)
* - Top of page

* + [Home](./)
  + | [New](enter_bug.cgi)
  + | [Browse](describecomponents.cgi)
  + | [Search](query.cgi)
  + |

    [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
  + | [Reports](report.cgi)
  + |
    [Requests](request.cgi)
  + |
    [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
  + |
    [New Account](createaccount.cgi)
  + |
    [Log In](show_bug.cgi?id=15203&GoAheadAndLogIn=1)

    [x]
  + |
    [Forgot Password](show_bug.cgi?id=15203&GoAheadAndLogIn=1#forgot)
    Login:

    [x]


