=== Content from github.com_66e44c01_20250111_180605.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Frandombit%2Fbotan%2Fpull%2F4045)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Frandombit%2Fbotan%2Fpull%2F4045)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=randombit%2Fbotan)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[randombit](/randombit)
/
**[botan](/randombit/botan)**
Public

* [Notifications](/login?return_to=%2Frandombit%2Fbotan) You must be signed in to change notification settings
* [Fork
  574](/login?return_to=%2Frandombit%2Fbotan)
* [Star
   2.8k](/login?return_to=%2Frandombit%2Fbotan)

* [Code](/randombit/botan)
* [Issues
  183](/randombit/botan/issues)
* [Pull requests
  29](/randombit/botan/pulls)
* [Discussions](/randombit/botan/discussions)
* [Actions](/randombit/botan/actions)
* [Wiki](/randombit/botan/wiki)
* [Security](/randombit/botan/security)
* [Insights](/randombit/botan/pulse)

Additional navigation options

* [Code](/randombit/botan)
* [Issues](/randombit/botan/issues)
* [Pull requests](/randombit/botan/pulls)
* [Discussions](/randombit/botan/discussions)
* [Actions](/randombit/botan/actions)
* [Wiki](/randombit/botan/wiki)
* [Security](/randombit/botan/security)
* [Insights](/randombit/botan/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Frandombit%2Fbotan%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Frandombit%2Fbotan%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# During X509 path validation, return immediately if a signature is invalid #4045

 Merged

[randombit](/randombit)
merged 1 commit into
[master](/randombit/botan/tree/master "randombit/botan:master")
from
[jack/x509-path-sigs-first](/randombit/botan/tree/jack/x509-path-sigs-first "randombit/botan:jack/x509-path-sigs-first")

May 13, 2024

 Merged

# [During X509 path validation, return immediately if a signature is invalid](#top) #4045

[randombit](/randombit)
merged 1 commit into
[master](/randombit/botan/tree/master "randombit/botan:master")
from
[jack/x509-path-sigs-first](/randombit/botan/tree/jack/x509-path-sigs-first "randombit/botan:jack/x509-path-sigs-first")

May 13, 2024

[Conversation
2](/randombit/botan/pull/4045)
[Commits
1](/randombit/botan/pull/4045/commits)
[Checks
42](/randombit/botan/pull/4045/checks)
[Files changed](/randombit/botan/pull/4045/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![randombit](https://avatars.githubusercontent.com/u/469092?s=60&v=4)](/randombit)

Copy link

Owner

### @randombit **[randombit](/randombit)** commented [May 8, 2024](#issue-2285068073)

The remainder of path validation logic is still subject to attacker controlled inputs, but the range of inputs is reduced to that which a legitimate certificate authority was willing to sign.

Sorry, something went wrong.

All reactions

 [![@randombit](https://avatars.githubusercontent.com/u/469092?s=40&v=4)](/randombit)
[randombit](/randombit)
requested a review
from [reneme](/reneme)
[May 8, 2024 08:58](#event-12740655701)

 [![@randombit](https://avatars.githubusercontent.com/u/469092?s=40&v=4)](/randombit)
[randombit](/randombit)
[force-pushed](/randombit/botan/compare/9dc1afb26bb1eb0ea614fbf3b01b076e85cd4b91..e4b4ff7058ff289ed33d67b1f365d826b6285e13)
the
jack/x509-path-sigs-first

branch
from
[`9dc1afb`](/randombit/botan/commit/9dc1afb26bb1eb0ea614fbf3b01b076e85cd4b91) to
[`e4b4ff7`](/randombit/botan/commit/e4b4ff7058ff289ed33d67b1f365d826b6285e13)  [Compare](/randombit/botan/compare/9dc1afb26bb1eb0ea614fbf3b01b076e85cd4b91..e4b4ff7058ff289ed33d67b1f365d826b6285e13)
[May 8, 2024 09:08](#event-12740797054)

[![@randombit](https://avatars.githubusercontent.com/u/469092?s=40&v=4)](/randombit)

`[During X509 path validation, return immediately if a signature is inv…](/randombit/botan/pull/4045/commits/e4b4ff7058ff289ed33d67b1f365d826b6285e13 "During X509 path validation, return immediately if a signature is invalid

The remainder of path validation logic is still subject to attacker
controlled inputs, but the range of inputs is reduced to that which a
legitimate certificate authority was willing to sign.")`
 …

`[e4b4ff7](/randombit/botan/pull/4045/commits/e4b4ff7058ff289ed33d67b1f365d826b6285e13)`

```
…alid

The remainder of path validation logic is still subject to attacker
controlled inputs, but the range of inputs is reduced to that which a
legitimate certificate authority was willing to sign.
```

[![@coveralls](https://avatars.githubusercontent.com/u/2354108?s=80&v=4)](/coveralls)

Copy link

### **[coveralls](/coveralls)** commented [May 8, 2024](#issuecomment-2100170969)

| [Coverage Status](https://coveralls.io/builds/67369181)  coverage: 92.014% (-0.005%) from 92.019% when pulling **[e4b4ff7](https://github.com/randombit/botan/commit/e4b4ff7058ff289ed33d67b1f365d826b6285e13) on jack/x509-path-sigs-first** into **[8798305](https://github.com/randombit/botan/commit/8798305c102934c4c20d9e4f63b768ba7e74c6b9) on master**. |
| --- |

All reactions

Sorry, something went wrong.

[randombit](/randombit)
added a commit
that referenced
this pull request
[May 11, 2024](#ref-commit-2e18466)
[![@randombit](https://avatars.githubusercontent.com/u/469092?s=40&v=4)](/randombit)

`[During X.509 verification, first check the signatures](/randombit/botan/commit/2e18466bb273f836d43ee0ac7a35d5fb23a60107 "During X.509 verification, first check the signatures

The remainder of path validation logic is still subject to attacker
controlled inputs, but the range of inputs is reduced to that which a
legitimate certificate authority was willing to sign.

Backport of #4045")`
…

`[2e18466](/randombit/botan/commit/2e18466bb273f836d43ee0ac7a35d5fb23a60107)`

```
The remainder of path validation logic is still subject to attacker
controlled inputs, but the range of inputs is reduced to that which a
legitimate certificate authority was willing to sign.

Backport of [#4045](https://github.com/randombit/botan/pull/4045)
```

[![@randombit](https://avatars.githubusercontent.com/u/469092?s=40&v=4)](/randombit)
[randombit](/randombit)
mentioned this pull request
[May 11, 2024](#ref-pullrequest-2291023003)

[[#4045 Backport] During X.509 verification, first check the signatures
#4052](/randombit/botan/pull/4052)
 Merged

[randombit](/randombit)
added a commit
that referenced
this pull request
[May 11, 2024](#ref-commit-cbbcc93)
[![@randombit](https://avatars.githubusercontent.com/u/469092?s=40&v=4)](/randombit)

`[During X.509 verification, first check the signatures](/randombit/botan/commit/cbbcc934043a0b1fa573a0022d002fd93f40214d "During X.509 verification, first check the signatures

The remainder of path validation logic is still subject to attacker
controlled inputs, but the range of inputs is reduced to that which a
legitimate certificate authority was willing to sign.

Backport of #4045")`
…

`[cbbcc93](/randombit/botan/commit/cbbcc934043a0b1fa573a0022d002fd93f40214d)`

```
The remainder of path validation logic is still subject to attacker
controlled inputs, but the range of inputs is reduced to that which a
legitimate certificate authority was willing to sign.

Backport of [#4045](https://github.com/randombit/botan/pull/4045)
```

[![FAlbertDev](https://avatars.githubusercontent.com/u/126883116?s=60&v=4)](/FAlbertDev)

**[FAlbertDev](/FAlbertDev)**
approved these changes
[May 13, 2024](#pullrequestreview-2052077964)

 [View reviewed changes](/randombit/botan/pull/4045/files/e4b4ff7058ff289ed33d67b1f365d826b6285e13)

Copy link

Collaborator

### @FAlbertDev **[FAlbertDev](/FAlbertDev)** left a comment

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

LGTM. I agree that checking the signature chain first is very sensible.

Sorry, something went wrong.

All reactions

 Hide details
View details

[![@randombit](https://avatars.githubusercontent.com/u/469092?s=40&v=4)](/randombit)
[randombit](/randombit)
merged commit [`39535f1`](/randombit/botan/commit/39535f13c322f56aa3da2f44b2b6abb8619a82ac)
into
master

[May 13, 2024](https://github.com/randombit/botan/pull/4045#event-12785285109)
43 checks passed

 [![@randombit](https://avatars.githubusercontent.com/u/469092?s=40&v=4)](/randombit)
[randombit](/randombit)
deleted the
jack/x509-path-sigs-first

branch
[May 13, 2024 10:49](#event-12785285754)

[randombit](/randombit)
added a commit
that referenced
this pull request
[May 13, 2024](#ref-commit-477822a)
[![@randombit](https://avatars.githubusercontent.com/u/469092?s=40&v=4)](/randombit)

`[Merge pull request](/randombit/botan/commit/477822a2d10f02d8ba46c9d8a5132f25843f5cc1 "Merge pull request #4052 from randombit/jack/backport-4045

[#4045 Backport] During X.509 verification, first check the signatures") [#4052](https://github.com/randombit/botan/pull/4052) [from randombit/jack/backport-4045](/randombit/botan/commit/477822a2d10f02d8ba46c9d8a5132f25843f5cc1 "Merge pull request #4052 from randombit/jack/backport-4045

[#4045 Backport] During X.509 verification, first check the signatures")`
…

`[477822a](/randombit/botan/commit/477822a2d10f02d8ba46c9d8a5132f25843f5cc1)`

```
[[#4045](https://github.com/randombit/botan/pull/4045) Backport] During X.509 verification, first check the signatures
```

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Frandombit%2Fbotan%2Fpull%2F4045)

Reviewers

[![@FAlbertDev](https://avatars.githubusercontent.com/u/126883116?s=40&v=4)](/FAlbertDev) [FAlbertDev](/FAlbertDev)

FAlbertDev approved these changes

[![@reneme](https://avatars.githubusercontent.com/u/1562139?s=40&v=4)](/reneme) [reneme](/reneme)

 Awaiting requested review from reneme

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

Successfully merging this pull request may close these issues.

3 participants

[![@randombit](https://avatars.githubusercontent.com/u/469092?s=52&v=4)](/randombit) [![@coveralls](https://avatars.githubusercontent.com/u/2354108?s=52&v=4)](/coveralls) [![@FAlbertDev](https://avatars.githubusercontent.com/u/126883116?s=52&v=4)](/FAlbertDev)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_ec143c4f_20250111_180608.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Frandombit%2Fbotan%2Fpull%2F4186)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Frandombit%2Fbotan%2Fpull%2F4186)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=randombit%2Fbotan)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[randombit](/randombit)
/
**[botan](/randombit/botan)**
Public

* [Notifications](/login?return_to=%2Frandombit%2Fbotan) You must be signed in to change notification settings
* [Fork
  574](/login?return_to=%2Frandombit%2Fbotan)
* [Star
   2.8k](/login?return_to=%2Frandombit%2Fbotan)

* [Code](/randombit/botan)
* [Issues
  183](/randombit/botan/issues)
* [Pull requests
  29](/randombit/botan/pulls)
* [Discussions](/randombit/botan/discussions)
* [Actions](/randombit/botan/actions)
* [Wiki](/randombit/botan/wiki)
* [Security](/randombit/botan/security)
* [Insights](/randombit/botan/pulse)

Additional navigation options

* [Code](/randombit/botan)
* [Issues](/randombit/botan/issues)
* [Pull requests](/randombit/botan/pulls)
* [Discussions](/randombit/botan/discussions)
* [Actions](/randombit/botan/actions)
* [Wiki](/randombit/botan/wiki)
* [Security](/randombit/botan/security)
* [Insights](/randombit/botan/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Frandombit%2Fbotan%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Frandombit%2Fbotan%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Address denial of service in name constraints processing #4186

 Merged

[randombit](/randombit)
merged 1 commit into
[master](/randombit/botan/tree/master "randombit/botan:master")
from
[jack/fix-nc-dos](/randombit/botan/tree/jack/fix-nc-dos "randombit/botan:jack/fix-nc-dos")

Jul 8, 2024

 Merged

# [Address denial of service in name constraints processing](#top) #4186

[randombit](/randombit)
merged 1 commit into
[master](/randombit/botan/tree/master "randombit/botan:master")
from
[jack/fix-nc-dos](/randombit/botan/tree/jack/fix-nc-dos "randombit/botan:jack/fix-nc-dos")

Jul 8, 2024

[Conversation
0](/randombit/botan/pull/4186)
[Commits
1](/randombit/botan/pull/4186/commits)
[Checks
38](/randombit/botan/pull/4186/checks)
[Files changed](/randombit/botan/pull/4186/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![randombit](https://avatars.githubusercontent.com/u/469092?s=60&v=4)](/randombit)

Copy link

Owner

### @randombit **[randombit](/randombit)** commented [Jul 8, 2024](#issue-2395736394)

Checking a name constraint is quadratic to the number of names and constraints. Place a hard limit on the total number of comparisons.

This issue was discovered and reported by Bing Shi.

CVE-2024-34702

Sorry, something went wrong.

All reactions

[![@randombit](https://avatars.githubusercontent.com/u/469092?s=40&v=4)](/randombit)

`[Address denial of service in name constraints processing](/randombit/botan/pull/4186/commits/655c2be095325492f88ea0778b155e7bcedee3b3 "Address denial of service in name constraints processing

Checking a name constraint is quadratic to the number of names and
constraints. Place a hard limit on the total number of comparisons.

This issue was discovered and reported by Bing Shi.

CVE-2024-34702")`
 …

`[655c2be](/randombit/botan/pull/4186/commits/655c2be095325492f88ea0778b155e7bcedee3b3)`

```
Checking a name constraint is quadratic to the number of names and
constraints. Place a hard limit on the total number of comparisons.

This issue was discovered and reported by Bing Shi.

CVE-2024-34702
```

 [![@randombit](https://avatars.githubusercontent.com/u/469092?s=40&v=4)](/randombit)
[randombit](/randombit)
[force-pushed](/randombit/botan/compare/e5a73af6e4bbe43beaf74ca2995fe7a192c221a6..655c2be095325492f88ea0778b155e7bcedee3b3)
the
jack/fix-nc-dos

branch
from
[`e5a73af`](/randombit/botan/commit/e5a73af6e4bbe43beaf74ca2995fe7a192c221a6) to
[`655c2be`](/randombit/botan/commit/655c2be095325492f88ea0778b155e7bcedee3b3)  [Compare](/randombit/botan/compare/e5a73af6e4bbe43beaf74ca2995fe7a192c221a6..655c2be095325492f88ea0778b155e7bcedee3b3)
[July 8, 2024 14:03](#event-13424591405)

 [![@randombit](https://avatars.githubusercontent.com/u/469092?s=40&v=4)](/randombit)
[randombit](/randombit)
requested review from
[FAlbertDev](/FAlbertDev) and
[reneme](/reneme)
and removed request for
[FAlbertDev](/FAlbertDev)
[July 8, 2024 14:03](#event-13424596117)

[![FAlbertDev](https://avatars.githubusercontent.com/u/126883116?s=60&v=4)](/FAlbertDev)

**[FAlbertDev](/FAlbertDev)**
approved these changes
[Jul 8, 2024](#pullrequestreview-2163442087)

 [View reviewed changes](/randombit/botan/pull/4186/files/655c2be095325492f88ea0778b155e7bcedee3b3)

 Hide details
View details

[![@randombit](https://avatars.githubusercontent.com/u/469092?s=40&v=4)](/randombit)
[randombit](/randombit)
merged commit [`ff704b1`](/randombit/botan/commit/ff704b12e6fa351aaedd07bffdc91722e84586b8)
into
master

[Jul 8, 2024](https://github.com/randombit/botan/pull/4186#event-13425177176)
39 checks passed

 [![@randombit](https://avatars.githubusercontent.com/u/469092?s=40&v=4)](/randombit)
[randombit](/randombit)
deleted the
jack/fix-nc-dos

branch
[July 8, 2024 14:39](#event-13425177734)

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Frandombit%2Fbotan%2Fpull%2F4186)

Reviewers

[![@FAlbertDev](https://avatars.githubusercontent.com/u/126883116?s=40&v=4)](/FAlbertDev) [FAlbertDev](/FAlbertDev)

FAlbertDev approved these changes

[![@reneme](https://avatars.githubusercontent.com/u/1562139?s=40&v=4)](/reneme) [reneme](/reneme)

 Awaiting requested review from reneme

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

Successfully merging this pull request may close these issues.

2 participants

[![@randombit](https://avatars.githubusercontent.com/u/469092?s=52&v=4)](/randombit) [![@FAlbertDev](https://avatars.githubusercontent.com/u/126883116?s=52&v=4)](/FAlbertDev)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_178b7542_20250111_180602.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Frandombit%2Fbotan%2Fcommit%2Fc3264821b9f6286ee4e6e3e06826f6b7177e6d41)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Frandombit%2Fbotan%2Fcommit%2Fc3264821b9f6286ee4e6e3e06826f6b7177e6d41)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=randombit%2Fbotan)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[randombit](/randombit)
/
**[botan](/randombit/botan)**
Public

* [Notifications](/login?return_to=%2Frandombit%2Fbotan) You must be signed in to change notification settings
* [Fork
  574](/login?return_to=%2Frandombit%2Fbotan)
* [Star
   2.8k](/login?return_to=%2Frandombit%2Fbotan)

* [Code](/randombit/botan)
* [Issues
  183](/randombit/botan/issues)
* [Pull requests
  29](/randombit/botan/pulls)
* [Discussions](/randombit/botan/discussions)
* [Actions](/randombit/botan/actions)
* [Wiki](/randombit/botan/wiki)
* [Security](/randombit/botan/security)
* [Insights](/randombit/botan/pulse)

Additional navigation options

* [Code](/randombit/botan)
* [Issues](/randombit/botan/issues)
* [Pull requests](/randombit/botan/pulls)
* [Discussions](/randombit/botan/discussions)
* [Actions](/randombit/botan/actions)
* [Wiki](/randombit/botan/wiki)
* [Security](/randombit/botan/security)
* [Insights](/randombit/botan/pulse)

## Commit

[Permalink](/randombit/botan/commit/c3264821b9f6286ee4e6e3e06826f6b7177e6d41)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Merge pull request [#4047](https://github.com/randombit/botan/pull/4047) from randombit/jack/opt-name-constraints

[Browse files](/randombit/botan/tree/c3264821b9f6286ee4e6e3e06826f6b7177e6d41)
Browse the repository at this point in the history

```
Optimize name constraint matching
```

* Loading branch information

[![@randombit](https://avatars.githubusercontent.com/u/469092?s=40&v=4)](/randombit)

[randombit](/randombit/botan/commits?author=randombit "View all commits by randombit")
authored
May 14, 2024

2 parents
[39535f1](/randombit/botan/commit/39535f13c322f56aa3da2f44b2b6abb8619a82ac)
+
[6700358](/randombit/botan/commit/6700358de060858eb7f3e07201dcf50ce9c720fc)

commit c326482

 Show file tree

 Hide file tree

Showing
**10 changed files**
with
**365 additions**
and
**252 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* src/lib

  + asn1

    - src/lib/asn1/ber\_dec.cpp
      [ber\_dec.cpp](#diff-cfc36ac77d151cba1181c1790f81020250b2d30c56bf7885e7d2963af7e9fb0e)
    - src/lib/asn1/ber\_dec.h
      [ber\_dec.h](#diff-a95749a71b196de8597ae40c7d01610ef4a694141cc8b938704865230c5e836e)
  + utils

    - src/lib/utils/stl\_util.h
      [stl\_util.h](#diff-f65bd093dfd45867271799a2158ef9ea890f59eb35b37bb40baf3c834c4ecff6)
  + x509

    - src/lib/x509/alt\_name.cpp
      [alt\_name.cpp](#diff-e90c72ac08971bfafb0b5ee4d58f17667d45bbc6fe7c882f119e9f04f1c9d56a)
    - src/lib/x509/asn1\_alt\_name.cpp
      [asn1\_alt\_name.cpp](#diff-18686dd6ae0c4e555efcf0a845fdbb2772342bedeb57544c92e8ca4b201293c6)
    - src/lib/x509/name\_constraint.cpp
      [name\_constraint.cpp](#diff-c83420f0b62a5ac32bcde8adf776991a1bb720b9a0569e5d34dd56542eb9bbe4)
    - src/lib/x509/pkix\_types.h
      [pkix\_types.h](#diff-7904183f7c0dc5cfafea9cbd8c2beab1a545f1316897b0253a4297c3b131ea78)
    - src/lib/x509/x509\_ext.cpp
      [x509\_ext.cpp](#diff-0737be45a53b640db0a8a442b82180db4a21721583185d15aa0cda4894d48146)
    - src/lib/x509/x509cert.cpp
      [x509cert.cpp](#diff-07a8c06eb8f4a673bff8b1be9e939af39731e672f7ca3f587039a52b6fb2b0cd)
    - src/lib/x509/x509self.cpp
      [x509self.cpp](#diff-3ec5ff20ddd8c85aa4ecd55e570f7a3bd1dd62bebd6849c1ddf465c7c42da897)

## There are no files selected for viewing

8 changes: 8 additions & 0 deletions

8
[src/lib/asn1/ber\_dec.cpp](#diff-cfc36ac77d151cba1181c1790f81020250b2d30c56bf7885e7d2963af7e9fb0e "src/lib/asn1/ber_dec.cpp")

Show comments

[View file](/randombit/botan/blob/c3264821b9f6286ee4e6e3e06826f6b7177e6d41/src/lib/asn1/ber_dec.cpp)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -227,6 +227,14 @@ BER\_Decoder& BER\_Decoder::discard\_remaining() { |
|  |  | return (\*this); |
|  |  | } |
|  |  |  |
|  |  | const BER\_Object& BER\_Decoder::peek\_next\_object() { |
|  |  | if(!m\_pushed.is\_set()) { |
|  |  | m\_pushed = get\_next\_object(); |
|  |  | } |
|  |  |  |
|  |  | return m\_pushed; |
|  |  | } |
|  |  |  |
|  |  | /\* |
|  |  | \* Return the BER encoding of the next object |
|  |  | \*/ |
| Expand Down | |  |

28 changes: 28 additions & 0 deletions

28
[src/lib/asn1/ber\_dec.h](#diff-a95749a71b196de8597ae40c7d01610ef4a694141cc8b938704865230c5e836e "src/lib/asn1/ber_dec.h")

Show comments

[View file](/randombit/botan/blob/c3264821b9f6286ee4e6e3e06826f6b7177e6d41/src/lib/asn1/ber_dec.h)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -71,6 +71,16 @@ class BOTAN\_PUBLIC\_API(2, 0) BER\_Decoder final { |
|  |  | return (\*this); |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Peek at the next object without removing it from the stream |
|  |  | \* |
|  |  | \* If an object has been pushed, then it returns that object. |
|  |  | \* Otherwise it reads the next object and pushes it. Thus, a you |
|  |  | \* call peek\_next\_object followed by push\_back without a |
|  |  | \* subsequent read, it will fail. |
|  |  | \*/ |
|  |  | const BER\_Object& peek\_next\_object(); |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Push an object back onto the stream. Throws if another |
|  |  | \* object was previously pushed and has not been subsequently |
| Expand Down  Expand Up | | @@ -253,6 +263,11 @@ class BOTAN\_PUBLIC\_API(2, 0) BER\_Decoder final { |
|  |  | ASN1\_Type type\_tag = ASN1\_Type::Sequence, |
|  |  | ASN1\_Class class\_tag = ASN1\_Class::Universal); |
|  |  |  |
|  |  | template <typename T> |
|  |  | bool decode\_optional\_list(std::vector<T>& out, |
|  |  | ASN1\_Type type\_tag = ASN1\_Type::Sequence, |
|  |  | ASN1\_Class class\_tag = ASN1\_Class::Universal); |
|  |  |  |
|  |  | template <typename T> |
|  |  | BER\_Decoder& decode\_and\_check(const T& expected, std::string\_view error\_msg) { |
|  |  | T actual; |
| Expand Down  Expand Up | | @@ -375,6 +390,19 @@ BER\_Decoder& BER\_Decoder::decode\_list(std::vector<T>& vec, ASN1\_Type type\_tag, A |
|  |  | return (\*this); |
|  |  | } |
|  |  |  |
|  |  | /\* |
|  |  | \* Decode an optional list of homogenously typed values |
|  |  | \*/ |
|  |  | template <typename T> |
|  |  | bool BER\_Decoder::decode\_optional\_list(std::vector<T>& vec, ASN1\_Type type\_tag, ASN1\_Class class\_tag) { |
|  |  | if(peek\_next\_object().is\_a(type\_tag, class\_tag)) { |
|  |  | decode\_list(vec, type\_tag, class\_tag); |
|  |  | return true; |
|  |  | } |
|  |  |  |
|  |  | return false; |
|  |  | } |
|  |  |  |
|  |  | } // namespace Botan |
|  |  |  |
|  |  | #endif |

14 changes: 14 additions & 0 deletions

14
[src/lib/utils/stl\_util.h](#diff-f65bd093dfd45867271799a2158ef9ea890f59eb35b37bb40baf3c834c4ecff6 "src/lib/utils/stl_util.h")

Show comments

[View file](/randombit/botan/blob/c3264821b9f6286ee4e6e3e06826f6b7177e6d41/src/lib/utils/stl_util.h)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -374,6 +374,20 @@ class scoped\_cleanup { |
|  |  | std::optional<FunT> m\_cleanup; |
|  |  | }; |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Define BOTAN\_ASSERT\_IS\_SOME |
|  |  | \*/ |
|  |  | template <typename T> |
|  |  | T assert\_is\_some(std::optional<T> v, const char\* expr, const char\* func, const char\* file, int line) { |
|  |  | if(v) { |
|  |  | return \*v; |
|  |  | } else { |
|  |  | Botan::assertion\_failure(expr, "optional had value", func, file, line); |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | #define BOTAN\_ASSERT\_IS\_SOME(v) assert\_is\_some(v, #v, \_\_func\_\_, \_\_FILE\_\_, \_\_LINE\_\_) |
|  |  |  |
|  |  | } // namespace Botan |
|  |  |  |
|  |  | #endif |

43 changes: 16 additions & 27 deletions

43
[src/lib/x509/alt\_name.cpp](#diff-e90c72ac08971bfafb0b5ee4d58f17667d45bbc6fe7c882f119e9f04f1c9d56a "src/lib/x509/alt_name.cpp")

Show comments

[View file](/randombit/botan/blob/c3264821b9f6286ee4e6e3e06826f6b7177e6d41/src/lib/x509/alt_name.cpp)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -8,8 +8,10 @@ |
|  |  |  |
|  |  | #include <botan/ber\_dec.h> |
|  |  | #include <botan/der\_enc.h> |
|  |  | #include <botan/internal/int\_utils.h> |
|  |  | #include <botan/internal/loadstor.h> |
|  |  | #include <botan/internal/parsing.h> |
|  |  | #include <botan/internal/stl\_util.h> |
|  |  |  |
|  |  | namespace Botan { |
|  |  |  |
| Expand All | | @@ -27,7 +29,7 @@ void AlternativeName::add\_email(std::string\_view addr) { |
|  |  |  |
|  |  | void AlternativeName::add\_dns(std::string\_view dns) { |
|  |  | if(!dns.empty()) { |
|  |  | m\_dns.insert(std::string(dns)); |
|  |  | m\_dns.insert(tolower\_string(dns)); |
|  |  | } |
|  |  | } |
|  |  |  |
| Expand All | | @@ -39,32 +41,19 @@ void AlternativeName::add\_dn(const X509\_DN& dn) { |
|  |  | m\_dn\_names.insert(dn); |
|  |  | } |
|  |  |  |
|  |  | void AlternativeName::add\_ip\_address(std::string\_view ip) { |
|  |  | if(!ip.empty()) { |
|  |  | m\_ip\_addr.insert(std::string(ip)); |
|  |  | } |
|  |  | void AlternativeName::add\_ipv4\_address(uint32\_t ip) { |
|  |  | m\_ipv4\_addr.insert(ip); |
|  |  | } |
|  |  |  |
|  |  | size\_t AlternativeName::count() const { |
|  |  | const auto sum = checked\_add( |
|  |  | m\_dns.size(), m\_uri.size(), m\_email.size(), m\_ipv4\_addr.size(), m\_dn\_names.size(), m\_othernames.size()); |
|  |  |  |
|  |  | return BOTAN\_ASSERT\_IS\_SOME(sum); |
|  |  | } |
|  |  |  |
|  |  | bool AlternativeName::has\_items() const { |
|  |  | if(!this->dns().empty()) { |
|  |  | return true; |
|  |  | } |
|  |  | if(!this->uris().empty()) { |
|  |  | return true; |
|  |  | } |
|  |  | if(!this->email().empty()) { |
|  |  | return true; |
|  |  | } |
|  |  | if(!this->ip\_address().empty()) { |
|  |  | return true; |
|  |  | } |
|  |  | if(!this->directory\_names().empty()) { |
|  |  | return true; |
|  |  | } |
|  |  | if(!this->other\_names().empty()) { |
|  |  | return true; |
|  |  | } |
|  |  | return false; |
|  |  | return this->count() > 0; |
|  |  | } |
|  |  |  |
|  |  | void AlternativeName::encode\_into(DER\_Encoder& der) const { |
| Expand Down  Expand Up | | @@ -111,8 +100,8 @@ void AlternativeName::encode\_into(DER\_Encoder& der) const { |
|  |  | der.add\_object(ASN1\_Type(6), ASN1\_Class::ContextSpecific, str.value()); |
|  |  | } |
|  |  |  |
|  |  | for(const auto& ip : m\_ip\_addr) { |
|  |  | auto ip\_buf = store\_be(string\_to\_ipv4(ip)); |
|  |  | for(uint32\_t ip : m\_ipv4\_addr) { |
|  |  | auto ip\_buf = store\_be(ip); |
|  |  | der.add\_object(ASN1\_Type(7), ASN1\_Class::ContextSpecific, ip\_buf.data(), 4); |
|  |  | } |
|  |  |  |
| Expand Down  Expand Up | | @@ -161,7 +150,7 @@ void AlternativeName::decode\_from(BER\_Decoder& source) { |
|  |  | } else if(obj.is\_a(7, ASN1\_Class::ContextSpecific)) { |
|  |  | if(obj.length() == 4) { |
|  |  | const uint32\_t ip = load\_be<uint32\_t>(obj.bits(), 0); |
|  |  | this->add\_ip\_address(ipv4\_to\_string(ip)); |
|  |  | this->add\_ipv4\_address(ip); |
|  |  | } |
|  |  | } |
|  |  | } |
| Expand Down | |  |

15 changes: 10 additions & 5 deletions

15
[src/lib/x509/asn1\_alt\_name.cpp](#diff-18686dd6ae0c4e555efcf0a845fdbb2772342bedeb57544c92e8ca4b201293c6 "src/lib/x509/asn1_alt_name.cpp")

Show comments

[View file](/randombit/botan/blob/c3264821b9f6286ee4e6e3e06826f6b7177e6d41/src/lib/x509/asn1_alt_name.cpp)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -9,6 +9,7 @@ |
|  |  | #include <botan/pkix\_types.h> |
|  |  |  |
|  |  | #include <botan/internal/fmt.h> |
|  |  | #include <botan/internal/parsing.h> |
|  |  | #include <sstream> |
|  |  |  |
|  |  | namespace Botan { |
| Expand All | | @@ -30,7 +31,7 @@ AlternativeName::AlternativeName(std::string\_view email\_addr, |
|  |  | add\_uri(uri); |
|  |  | } |
|  |  | if(!ip.empty()) { |
|  |  | add\_ip\_address(ip); |
|  |  | add\_ipv4\_address(string\_to\_ipv4(ip)); |
|  |  | } |
|  |  | } |
|  |  |  |
| Expand All | | @@ -54,7 +55,7 @@ void AlternativeName::add\_attribute(std::string\_view type, std::string\_view valu |
|  |  | ss >> dn; |
|  |  | this->add\_dn(dn); |
|  |  | } else if(type == "IP") { |
|  |  | this->add\_ip\_address(value); |
|  |  | this->add\_ipv4\_address(string\_to\_ipv4(value)); |
|  |  | } else { |
|  |  | throw Not\_Implemented(fmt("Unknown AlternativeName name type {}", type)); |
|  |  | } |
| Expand Down  Expand Up | | @@ -88,8 +89,8 @@ std::multimap<std::string, std::string> AlternativeName::contents() const { |
|  |  | names.emplace("URI", nm); |
|  |  | } |
|  |  |  |
|  |  | for(const auto& nm : this->ip\_address()) { |
|  |  | names.emplace("IP", nm); |
|  |  | for(uint32\_t ipv4 : this->ipv4\_address()) { |
|  |  | names.emplace("IP", ipv4\_to\_string(ipv4)); |
|  |  | } |
|  |  |  |
|  |  | for(const auto& nm : this->directory\_names()) { |
| Expand Down  Expand Up | | @@ -145,7 +146,11 @@ std::vector<std::string> AlternativeName::get\_attribute(std::string\_view attr) c |
|  |  |  |
|  |  | return ret; |
|  |  | } else if(attr == "IP") { |
|  |  | return set\_to\_vector(this->ip\_address()); |
|  |  | std::vector<std::string> ip\_str; |
|  |  | for(uint32\_t ipv4 : this->ipv4\_address()) { |
|  |  | ip\_str.push\_back(ipv4\_to\_string(ipv4)); |
|  |  | } |
|  |  | return ip\_str; |
|  |  | } else { |
|  |  | return {}; |
|  |  | } |
| Expand Down | |  |

 Loading

Oops, something went wrong.
 Retry

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `c326482`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Frandombit%2Fbotan%2Fcommit%2Fc3264821b9f6286ee4e6e3e06826f6b7177e6d41) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_328451ea_20250111_180604.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Frandombit%2Fbotan%2Fpull%2F4034)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Frandombit%2Fbotan%2Fpull%2F4034)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=randombit%2Fbotan)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[randombit](/randombit)
/
**[botan](/randombit/botan)**
Public

* [Notifications](/login?return_to=%2Frandombit%2Fbotan) You must be signed in to change notification settings
* [Fork
  574](/login?return_to=%2Frandombit%2Fbotan)
* [Star
   2.8k](/login?return_to=%2Frandombit%2Fbotan)

* [Code](/randombit/botan)
* [Issues
  183](/randombit/botan/issues)
* [Pull requests
  29](/randombit/botan/pulls)
* [Discussions](/randombit/botan/discussions)
* [Actions](/randombit/botan/actions)
* [Wiki](/randombit/botan/wiki)
* [Security](/randombit/botan/security)
* [Insights](/randombit/botan/pulse)

Additional navigation options

* [Code](/randombit/botan)
* [Issues](/randombit/botan/issues)
* [Pull requests](/randombit/botan/pulls)
* [Discussions](/randombit/botan/discussions)
* [Actions](/randombit/botan/actions)
* [Wiki](/randombit/botan/wiki)
* [Security](/randombit/botan/security)
* [Insights](/randombit/botan/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Frandombit%2Fbotan%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Frandombit%2Fbotan%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Refactor AlternativeName internals #4034

 Merged

[randombit](/randombit)
merged 4 commits into
[master](/randombit/botan/tree/master "randombit/botan:master")
from
[jack/refactor-alt-name](/randombit/botan/tree/jack/refactor-alt-name "randombit/botan:jack/refactor-alt-name")

May 10, 2024

 Merged

# [Refactor AlternativeName internals](#top) #4034

[randombit](/randombit)
merged 4 commits into
[master](/randombit/botan/tree/master "randombit/botan:master")
from
[jack/refactor-alt-name](/randombit/botan/tree/jack/refactor-alt-name "randombit/botan:jack/refactor-alt-name")

May 10, 2024

[Conversation
13](/randombit/botan/pull/4034)
[Commits
4](/randombit/botan/pull/4034/commits)
[Checks
42](/randombit/botan/pull/4034/checks)
[Files changed](/randombit/botan/pull/4034/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![randombit](https://avatars.githubusercontent.com/u/469092?s=60&v=4)](/randombit)

Copy link

Owner

### @randombit **[randombit](/randombit)** commented [Apr 26, 2024](#issue-2266523862)

This provides a completely new and rather more sensible interface, with the old (now deprecated) interface being implemented in terms of the new interface.

It also resolves a performance issue when parsing certificates with many (thousands) of alternative names; previously this triggered some accidentally quadratic code when checking for duplicates.

Performance issue was reported by Bing Shi.

Sorry, something went wrong.

All reactions

 [![@randombit](https://avatars.githubusercontent.com/u/469092?s=40&v=4)](/randombit)
[randombit](/randombit)
requested review from
[reneme](/reneme) and
[FAlbertDev](/FAlbertDev)
[April 26, 2024 21:22](#event-12628584986)

 [![@randombit](https://avatars.githubusercontent.com/u/469092?s=40&v=4)](/randombit)
[randombit](/randombit)
[force-pushed](/randombit/botan/compare/76749a9bb3e9632a66d92a6ee176fd2cf509b16a..eaf35a1c47ff704db08416104da2b262e40c1e96)
the
jack/refactor-alt-name

branch
2 times, most recently
from
[`76749a9`](/randombit/botan/commit/76749a9bb3e9632a66d92a6ee176fd2cf509b16a) to
[`eaf35a1`](/randombit/botan/commit/eaf35a1c47ff704db08416104da2b262e40c1e96)  [Compare](/randombit/botan/compare/76749a9bb3e9632a66d92a6ee176fd2cf509b16a..eaf35a1c47ff704db08416104da2b262e40c1e96)
[April 26, 2024 23:24](#event-12629203579)

[![@coveralls](https://avatars.githubusercontent.com/u/2354108?s=80&v=4)](/coveralls)

Copy link

### **[coveralls](/coveralls)** commented [Apr 26, 2024](#issuecomment-2080244409) • edited Loading

| [Coverage Status](https://coveralls.io/builds/67368143)  coverage: 91.995% (-0.02%) from 92.019% when pulling **[75a0deb](https://github.com/randombit/botan/commit/75a0deb848ff326d65727fe2722e94f49981f0ef) on jack/refactor-alt-name** into **[8798305](https://github.com/randombit/botan/commit/8798305c102934c4c20d9e4f63b768ba7e74c6b9) on master**. |
| --- |

All reactions

Sorry, something went wrong.

 [![@randombit](https://avatars.githubusercontent.com/u/469092?s=40&v=4)](/randombit)
[randombit](/randombit)
[force-pushed](/randombit/botan/compare/7569eb6f94a0c6e4bf7da2f68901f0b2a5757c59..ab8597951304b0f0cb8bd23367422808913ca0c1)
the
jack/refactor-alt-name

branch
3 times, most recently
from
[`7569eb6`](/randombit/botan/commit/7569eb6f94a0c6e4bf7da2f68901f0b2a5757c59) to
[`ab85979`](/randombit/botan/commit/ab8597951304b0f0cb8bd23367422808913ca0c1)  [Compare](/randombit/botan/compare/7569eb6f94a0c6e4bf7da2f68901f0b2a5757c59..ab8597951304b0f0cb8bd23367422808913ca0c1)
[April 27, 2024 00:10](#event-12629339091)

[![FAlbertDev](https://avatars.githubusercontent.com/u/126883116?s=60&v=4)](/FAlbertDev)

**[FAlbertDev](/FAlbertDev)**
approved these changes
[Apr 30, 2024](#pullrequestreview-2030286498)

 [View reviewed changes](/randombit/botan/pull/4034/files)

Copy link

Collaborator

### @FAlbertDev **[FAlbertDev](/FAlbertDev)** left a comment

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

I admit I only worked with X509 a little, so I have no comparison to the previous version. What I see in this new version looks well structured and intuitive 👍

I didn't look into the existing tests. Do we need additional tests for the new interface?

Sorry, something went wrong.

All reactions

[src/lib/x509/alt\_name.cpp](/randombit/botan/pull/4034/files#diff-e90c72ac08971bfafb0b5ee4d58f17667d45bbc6fe7c882f119e9f04f1c9d56a)
Outdated

Show resolved

Hide resolved

[src/lib/x509/asn1\_alt\_name.cpp](/randombit/botan/pull/4034/files#diff-18686dd6ae0c4e555efcf0a845fdbb2772342bedeb57544c92e8ca4b201293c6)
Outdated

Show resolved

Hide resolved

[src/lib/x509/asn1\_alt\_name.cpp](/randombit/botan/pull/4034/files#diff-18686dd6ae0c4e555efcf0a845fdbb2772342bedeb57544c92e8ca4b201293c6)
Outdated

Show resolved

Hide resolved

[src/lib/x509/pkix\_types.h](/randombit/botan/pull/4034/files#diff-7904183f7c0dc5cfafea9cbd8c2beab1a545f1316897b0253a4297c3b131ea78)
Outdated

Show resolved

Hide resolved

[src/lib/x509/x509cert.cpp](/randombit/botan/pull/4034/files#diff-07a8c06eb8f4a673bff8b1be9e939af39731e672f7ca3f587039a52b6fb2b0cd)
Outdated

Show resolved

Hide resolved

 [![@randombit](https://avatars.githubusercontent.com/u/469092?s=40&v=4)](/randombit)
[randombit](/randombit)
[force-pushed](/randombit/botan/compare/20775f2edff3dbf0587e8b0f94a108af9b084cb5..c0eda6924a17d7b73a3676d24bc612e98b52a1ed)
the
jack/refactor-alt-name

branch
from
[`20775f2`](/randombit/botan/commit/20775f2edff3dbf0587e8b0f94a108af9b084cb5) to
[`c0eda69`](/randombit/botan/commit/c0eda6924a17d7b73a3676d24bc612e98b52a1ed)  [Compare](/randombit/botan/compare/20775f2edff3dbf0587e8b0f94a108af9b084cb5..c0eda6924a17d7b73a3676d24bc612e98b52a1ed)
[May 7, 2024 15:04](#event-12731071100)

 [randombit](/randombit)
added 4 commits
[May 7, 2024 11:04](#commits-pushed-c6cadc4)

[![@randombit](https://avatars.githubusercontent.com/u/469092?s=40&v=4)](/randombit)

`[Refactor AlternativeName internals](/randombit/botan/pull/4034/commits/c6cadc46b02b8e55cc12cbfa6a81ffbc363edd6c "Refactor AlternativeName internals

This provides a completely new and rather more sensible interface,
with the old (now deprecated) interface being implemented in terms
of the new interface.

It also resolves a performance issue when parsing certificates with
many (thousands) of alternative names; previously this triggered
some accidentally quadratic code when checking for duplicates.

Performance issue was reported by Bing Shi.")`
 …

`[c6cadc4](/randombit/botan/pull/4034/commits/c6cadc46b02b8e55cc12cbfa6a81ffbc363edd6c)`

```
This provides a completely new and rather more sensible interface,
with the old (now deprecated) interface being implemented in terms
of the new interface.

It also resolves a performance issue when parsing certificates with
many (thousands) of alternative names; previously this triggered
some accidentally quadratic code when checking for duplicates.

Performance issue was reported by Bing Shi.
```

[![@randombit](https://avatars.githubusercontent.com/u/469092?s=40&v=4)](/randombit)

`[Address some review comments](/randombit/botan/pull/4034/commits/c4ffa8844b0f108c8aee4b044736aa631258f41e "Address some review comments")`

`[c4ffa88](/randombit/botan/pull/4034/commits/c4ffa8844b0f108c8aee4b044736aa631258f41e)`

[![@randombit](https://avatars.githubusercontent.com/u/469092?s=40&v=4)](/randombit)

`[Correct encoding of DNs in SubjectAlternativeName](/randombit/botan/pull/4034/commits/c0eda6924a17d7b73a3676d24bc612e98b52a1ed "Correct encoding of DNs in SubjectAlternativeName")`

`[c0eda69](/randombit/botan/pull/4034/commits/c0eda6924a17d7b73a3676d24bc612e98b52a1ed)`

[![@randombit](https://avatars.githubusercontent.com/u/469092?s=40&v=4)](/randombit)

`[Add a test for alt DN encoding](/randombit/botan/pull/4034/commits/75a0deb848ff326d65727fe2722e94f49981f0ef "Add a test for alt DN encoding")`

`[75a0deb](/randombit/botan/pull/4034/commits/75a0deb848ff326d65727fe2722e94f49981f0ef)`

 Hide details
View details

[![@randombit](https://avatars.githubusercontent.com/u/469092?s=40&v=4)](/randombit)
[randombit](/randombit)
merged commit [`7606d70`](/randombit/botan/commit/7606d70d3a2ac7114476ec2651ca0243c4536fdf)
into
master

[May 10, 2024](https://github.com/randombit/botan/pull/4034#event-12767245623)
43 checks passed

 [![@randombit](https://avatars.githubusercontent.com/u/469092?s=40&v=4)](/randombit)
[randombit](/randombit)
deleted the
jack/refactor-alt-name

branch
[May 10, 2024 09:02](#event-12767246624)

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Frandombit%2Fbotan%2Fpull%2F4034)

Reviewers

[![@FAlbertDev](https://avatars.githubusercontent.com/u/126883116?s=40&v=4)](/FAlbertDev) [FAlbertDev](/FAlbertDev)

FAlbertDev approved these changes

[![@reneme](https://avatars.githubusercontent.com/u/1562139?s=40&v=4)](/reneme) [reneme](/reneme)

 Awaiting requested review from reneme

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

Successfully merging this pull request may close these issues.

3 participants

[![@randombit](https://avatars.githubusercontent.com/u/469092?s=52&v=4)](/randombit) [![@coveralls](https://avatars.githubusercontent.com/u/2354108?s=52&v=4)](/coveralls) [![@FAlbertDev](https://avatars.githubusercontent.com/u/126883116?s=52&v=4)](/FAlbertDev)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_f14e3711_20250111_180559.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Frandombit%2Fbotan%2Fcommit%2F21dccc8fef18c165ba3301d850ac61521f85637e)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Frandombit%2Fbotan%2Fcommit%2F21dccc8fef18c165ba3301d850ac61521f85637e)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=randombit%2Fbotan)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[randombit](/randombit)
/
**[botan](/randombit/botan)**
Public

* [Notifications](/login?return_to=%2Frandombit%2Fbotan) You must be signed in to change notification settings
* [Fork
  574](/login?return_to=%2Frandombit%2Fbotan)
* [Star
   2.8k](/login?return_to=%2Frandombit%2Fbotan)

* [Code](/randombit/botan)
* [Issues
  183](/randombit/botan/issues)
* [Pull requests
  29](/randombit/botan/pulls)
* [Discussions](/randombit/botan/discussions)
* [Actions](/randombit/botan/actions)
* [Wiki](/randombit/botan/wiki)
* [Security](/randombit/botan/security)
* [Insights](/randombit/botan/pulse)

Additional navigation options

* [Code](/randombit/botan)
* [Issues](/randombit/botan/issues)
* [Pull requests](/randombit/botan/pulls)
* [Discussions](/randombit/botan/discussions)
* [Actions](/randombit/botan/actions)
* [Wiki](/randombit/botan/wiki)
* [Security](/randombit/botan/security)
* [Insights](/randombit/botan/pulse)

## Commit

[Permalink](/randombit/botan/commit/21dccc8fef18c165ba3301d850ac61521f85637e)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Merge pull request [#4187](https://github.com/randombit/botan/pull/4187) from randombit/jack/fix-nc-dos-2x

[Browse files](/randombit/botan/tree/21dccc8fef18c165ba3301d850ac61521f85637e)
Browse the repository at this point in the history

```
Address various name constraint bugs
```

* Loading branch information

[![@randombit](https://avatars.githubusercontent.com/u/469092?s=40&v=4)](/randombit)

[randombit](/randombit/botan/commits?author=randombit "View all commits by randombit")
authored
Jul 8, 2024

2 parents
[7ca98fc](/randombit/botan/commit/7ca98fc7f9a7bdba2a63f52224ca81265e7e4c57)
+
[68338f5](/randombit/botan/commit/68338f5912534c74469f7f4e6e22b37aa5159952)

commit 21dccc8

 Show file tree

 Hide file tree

Showing
**8 changed files**
with
**401 additions**
and
**78 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* src

  + lib/x509

    - src/lib/x509/asn1\_alt\_name.cpp
      [asn1\_alt\_name.cpp](#diff-18686dd6ae0c4e555efcf0a845fdbb2772342bedeb57544c92e8ca4b201293c6)
    - src/lib/x509/name\_constraint.cpp
      [name\_constraint.cpp](#diff-c83420f0b62a5ac32bcde8adf776991a1bb720b9a0569e5d34dd56542eb9bbe4)
    - src/lib/x509/pkix\_types.h
      [pkix\_types.h](#diff-7904183f7c0dc5cfafea9cbd8c2beab1a545f1316897b0253a4297c3b131ea78)
    - src/lib/x509/x509\_ext.cpp
      [x509\_ext.cpp](#diff-0737be45a53b640db0a8a442b82180db4a21721583185d15aa0cda4894d48146)
    - src/lib/x509/x509cert.cpp
      [x509cert.cpp](#diff-07a8c06eb8f4a673bff8b1be9e939af39731e672f7ca3f587039a52b6fb2b0cd)
  + python

    - src/python/botan2.py
      [botan2.py](#diff-9f4a9769d398701a103b501a53ce0b71fcce89a3a82adbbebe89aa50e8fe8ed8)
  + scripts

    - src/scripts/test\_python.py
      [test\_python.py](#diff-62df95df8863b36cb019e5b21fe48a889b86b818a0787c18b5c1e4cdab1e42f0)
  + tests

    - src/tests/test\_name\_constraint.cpp
      [test\_name\_constraint.cpp](#diff-7ca58777f342cc7e091bf4b9a4d326ad69373872a3e3c330d48907b5ae6c8a30)

## There are no files selected for viewing

4 changes: 4 additions & 0 deletions

4
[src/lib/x509/asn1\_alt\_name.cpp](#diff-18686dd6ae0c4e555efcf0a845fdbb2772342bedeb57544c92e8ca4b201293c6 "src/lib/x509/asn1_alt_name.cpp")

Show comments

[View file](/randombit/botan/blob/21dccc8fef18c165ba3301d850ac61521f85637e/src/lib/x509/asn1_alt_name.cpp)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -257,6 +257,10 @@ void AlternativeName::decode\_from(BER\_Decoder& source) |
|  |  | const uint32\_t ip = load\_be<uint32\_t>(obj.bits(), 0); |
|  |  | add\_attribute("IP", ipv4\_to\_string(ip)); |
|  |  | } |
|  |  | else if(obj.length() != 16) |
|  |  | { |
|  |  | throw Decoding\_Error("Invalid length for IP address SAN"); |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | } |
| Expand Down | |  |

313 changes: 302 additions & 11 deletions

313
[src/lib/x509/name\_constraint.cpp](#diff-c83420f0b62a5ac32bcde8adf776991a1bb720b9a0569e5d34dd56542eb9bbe4 "src/lib/x509/name_constraint.cpp")

Show comments

[View file](/randombit/botan/blob/21dccc8fef18c165ba3301d850ac61521f85637e/src/lib/x509/name_constraint.cpp)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -163,31 +163,48 @@ GeneralName::MatchResult GeneralName::matches(const X509\_Certificate& cert) cons |
|  |  |  |
|  |  | bool GeneralName::matches\_dns(const std::string& nam) const |
|  |  | { |
|  |  | if(nam.size() == name().size()) |
|  |  | const std::string constraint = tolower\_string(name()); |
|  |  | const std::string issued = tolower\_string(nam); |
|  |  |  |
|  |  | if(nam.size() == constraint.size()) |
|  |  | { |
|  |  | return tolower\_string(nam) == tolower\_string(name()); |
|  |  | return issued == constraint; |
|  |  | } |
|  |  | else if(name().size() > nam.size()) |
|  |  | else if(constraint.size() > nam.size()) |
|  |  | { |
|  |  | // The constraint is longer than the issued name: not possibly a match |
|  |  | return false; |
|  |  | } |
|  |  | else // name.size() < nam.size() |
|  |  | else |
|  |  | { |
|  |  | // constr is suffix of nam |
|  |  | const std::string constr = name().front() == '.' ? name() : "." + name(); |
|  |  | const std::string substr = nam.substr(nam.size() - constr.size(), constr.size()); |
|  |  | return tolower\_string(constr) == tolower\_string(substr); |
|  |  | if(constraint.empty()) { |
|  |  | return true; |
|  |  | } |
|  |  |  |
|  |  | std::string substr = issued.substr(nam.size() - constraint.size(), constraint.size()); |
|  |  |  |
|  |  | if(constraint.front() == '.') { |
|  |  | return substr == constraint; |
|  |  | } else if(substr[0] == '.') { |
|  |  | return substr.substr(1) == constraint; |
|  |  | } else { |
|  |  | return substr == constraint && issued[issued.size() - constraint.size() - 1] == '.'; |
|  |  | } |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | bool GeneralName::matches\_dn(const std::string& nam) const |
|  |  | { |
|  |  | std::stringstream ss(nam); |
|  |  | std::stringstream tt(name()); |
|  |  | X509\_DN nam\_dn, my\_dn; |
|  |  |  |
|  |  | X509\_DN nam\_dn; |
|  |  | ss >> nam\_dn; |
|  |  | return matches\_dn\_obj(nam\_dn); |
|  |  | } |
|  |  |  |
|  |  | bool GeneralName::matches\_dn\_obj(const X509\_DN& nam\_dn) const |
|  |  | { |
|  |  | std::stringstream tt(name()); |
|  |  | X509\_DN my\_dn; |
|  |  | tt >> my\_dn; |
|  |  |  |
|  |  | auto attr = nam\_dn.get\_attributes(); |
| Expand Down  Expand Up | | @@ -270,4 +287,278 @@ std::ostream& operator<<(std::ostream& os, const GeneralSubtree& gs) |
|  |  | os << gs.minimum() << "," << gs.maximum() << "," << gs.base(); |
|  |  | return os; |
|  |  | } |
|  |  |  |
|  |  | NameConstraints::NameConstraints(std::vector<GeneralSubtree>&& permitted\_subtrees, |
|  |  | std::vector<GeneralSubtree>&& excluded\_subtrees) : |
|  |  | m\_permitted\_subtrees(permitted\_subtrees), m\_excluded\_subtrees(excluded\_subtrees) |
|  |  | { |
|  |  | for(const auto& c : m\_permitted\_subtrees) |
|  |  | { |
|  |  | m\_permitted\_name\_types.insert(c.base().type()); |
|  |  | } |
|  |  | for(const auto& c : m\_excluded\_subtrees) |
|  |  | { |
|  |  | m\_excluded\_name\_types.insert(c.base().type()); |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | namespace { |
|  |  |  |
|  |  | bool looks\_like\_ipv4(const std::string& s) |
|  |  | { |
|  |  | try |
|  |  | { |
|  |  | // ignores return value |
|  |  | string\_to\_ipv4(s); |
|  |  | return true; |
|  |  | } |
|  |  | catch(...) |
|  |  | { |
|  |  | return false; |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | } |
|  |  |  |
|  |  | bool NameConstraints::is\_permitted(const X509\_Certificate& cert, bool reject\_unknown) const { |
|  |  | if(permitted().empty()) { |
|  |  | return true; |
|  |  | } |
|  |  |  |
|  |  | const auto& alt\_name = cert.subject\_alt\_name(); |
|  |  |  |
|  |  | if(reject\_unknown) { |
|  |  | if(m\_permitted\_name\_types.find("URI") != m\_permitted\_name\_types.end() && !alt\_name.get\_attribute("URI").empty()) { |
|  |  | return false; |
|  |  | } |
|  |  | if(m\_permitted\_name\_types.find("RFC822") != m\_permitted\_name\_types.end() && !alt\_name.get\_attribute("RFC822").empty()) { |
|  |  | return false; |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | auto is\_permitted\_dn = [&](const X509\_DN& dn) { |
|  |  | // If no restrictions, then immediate accept |
|  |  | if(m\_permitted\_name\_types.find("DN") == m\_permitted\_name\_types.end()) { |
|  |  | return true; |
|  |  | } |
|  |  |  |
|  |  | if(dn.empty()) { |
|  |  | return true; |
|  |  | } |
|  |  |  |
|  |  | for(const auto& c : m\_permitted\_subtrees) { |
|  |  | if(c.base().type() == "DN" && c.base().matches\_dn\_obj(dn)) { |
|  |  | return true; |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | // There is at least one permitted name and we didn't match |
|  |  | return false; |
|  |  | }; |
|  |  |  |
|  |  | auto is\_permitted\_dns\_name = [&](const std::string& name) { |
|  |  | if(name.empty() || name[0] == '.') { |
|  |  | return false; |
|  |  | } |
|  |  |  |
|  |  | // If no restrictions, then immediate accept |
|  |  | if(m\_permitted\_name\_types.find("DNS") == m\_permitted\_name\_types.end()) { |
|  |  | return true; |
|  |  | } |
|  |  |  |
|  |  | for(const auto& c : m\_permitted\_subtrees) { |
|  |  | if(c.base().type() == "DNS" && c.base().matches\_dns(name)) { |
|  |  | return true; |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | // There is at least one permitted name and we didn't match |
|  |  | return false; |
|  |  | }; |
|  |  |  |
|  |  | auto is\_permitted\_ipv4 = [&](const std::string& ipv4) { |
|  |  | // If no restrictions, then immediate accept |
|  |  | if(m\_permitted\_name\_types.find("IP") == m\_permitted\_name\_types.end()) { |
|  |  | return true; |
|  |  | } |
|  |  |  |
|  |  | for(const auto& c : m\_permitted\_subtrees) { |
|  |  | if(c.base().type() == "IP" && c.base().matches\_ip(ipv4)) { |
|  |  | return true; |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | // There is at least one permitted name and we didn't match |
|  |  | return false; |
|  |  | }; |
|  |  |  |
|  |  | if(!is\_permitted\_dn(cert.subject\_dn())) { |
|  |  | return false; |
|  |  | } |
|  |  |  |
|  |  | if(!is\_permitted\_dn(alt\_name.dn())) |
|  |  | { |
|  |  | return false; |
|  |  | } |
|  |  |  |
|  |  | for(const auto& alt\_dns : alt\_name.get\_attribute("DNS")) { |
|  |  | if(!is\_permitted\_dns\_name(alt\_dns)) { |
|  |  | return false; |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | for(const auto& alt\_ipv4 : alt\_name.get\_attribute("IP")) { |
|  |  | if(!is\_permitted\_ipv4(alt\_ipv4)) { |
|  |  | return false; |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | if(!alt\_name.has\_items()) |
|  |  | { |
|  |  | for(const auto& cn : cert.subject\_info("Name")) |
|  |  | { |
|  |  | if(cn.find(".") != std::string::npos) |
|  |  | { |
|  |  | if(looks\_like\_ipv4(cn)) |
|  |  | { |
|  |  | if(!is\_permitted\_ipv4(cn)) |
|  |  | { |
|  |  | return false; |
|  |  | } |
|  |  | } |
|  |  | else |
|  |  | { |
|  |  | if(!is\_permitted\_dns\_name(cn)) |
|  |  | { |
|  |  | return false; |
|  |  | } |
|  |  | } |
|  |  | } |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | // We didn't encounter a name that doesn't have a matching constraint |
|  |  | return true; |
|  |  | } |
|  |  |  |
|  |  | bool NameConstraints::is\_excluded(const X509\_Certificate& cert, bool reject\_unknown) const { |
|  |  | if(excluded().empty()) { |
|  |  | return false; |
|  |  | } |
|  |  |  |
|  |  | const auto& alt\_name = cert.subject\_alt\_name(); |
|  |  |  |
|  |  | if(reject\_unknown) { |
|  |  | if(m\_excluded\_name\_types.find("URI") != m\_excluded\_name\_types.end() && !alt\_name.get\_attribute("URI").empty()) { |
|  |  | return false; |
|  |  | } |
|  |  | if(m\_excluded\_name\_types.find("RFC822") != m\_excluded\_name\_types.end() && !alt\_name.get\_attribute("RFC822").empty()) { |
|  |  | return false; |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | auto is\_excluded\_dn = [&](const X509\_DN& dn) { |
|  |  | // If no restrictions, then immediate accept |
|  |  | if(m\_excluded\_name\_types.find("DN") == m\_excluded\_name\_types.end()) { |
|  |  | return false; |
|  |  | } |
|  |  |  |
|  |  | if(dn.empty()) { |
|  |  | return false; |
|  |  | } |
|  |  |  |
|  |  | for(const auto& c : m\_excluded\_subtrees) { |
|  |  | if(c.base().type() == "DN" && c.base().matches\_dn\_obj(dn)) { |
|  |  | return true; |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | // There is at least one excluded name and we didn't match |
|  |  | return false; |
|  |  | }; |
|  |  |  |
|  |  | auto is\_excluded\_dns\_name = [&](const std::string& name) { |
|  |  | if(name.empty() || name[0] == '.') { |
|  |  | return true; |
|  |  | } |
|  |  |  |
|  |  | // If no restrictions, then immediate accept |
|  |  | if(m\_excluded\_name\_types.find("DNS") == m\_excluded\_name\_types.end()) { |
|  |  | return false; |
|  |  | } |
|  |  |  |
|  |  | for(const auto& c : m\_excluded\_subtrees) { |
|  |  | if(c.base().type() == "DNS" && c.base().matches\_dns(name)) { |
|  |  | return true; |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | // There is at least one excluded name and we didn't match |
|  |  | return false; |
|  |  | }; |
|  |  |  |
|  |  | auto is\_excluded\_ipv4 = [&](const std::string& ipv4) { |
|  |  | // If no restrictions, then immediate accept |
|  |  | if(m\_excluded\_name\_types.find("IP") == m\_excluded\_name\_types.end()) { |
|  |  | return false; |
|  |  | } |
|  |  |  |
|  |  | for(const auto& c : m\_excluded\_subtrees) { |
|  |  | if(c.base().type() == "IP" && c.base().matches\_ip(ipv4)) { |
|  |  | return true; |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | // There is at least one excluded name and we didn't match |
|  |  | return false; |
|  |  | }; |
|  |  |  |
|  |  | if(is\_excluded\_dn(cert.subject\_dn())) { |
|  |  | return true; |
|  |  | } |
|  |  |  |
|  |  | if(is\_excluded\_dn(alt\_name.dn())) { |
|  |  | return true; |
|  |  | } |
|  |  |  |
|  |  | for(const auto& alt\_dns : alt\_name.get\_attribute("DNS")) { |
|  |  | if(is\_excluded\_dns\_name(alt\_dns)) { |
|  |  | return true; |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | for(const auto& alt\_ipv4 : alt\_name.get\_attribute("IP")) { |
|  |  | if(is\_excluded\_ipv4(alt\_ipv4)) { |
|  |  | return true; |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | if(!alt\_name.has\_items()) |
|  |  | { |
|  |  | for(const auto& cn : cert.subject\_info("Name")) |
|  |  | { |
|  |  | if(cn.find(".") != std::string::npos) |
|  |  | { |
|  |  | if(looks\_like\_ipv4(cn)) |
|  |  | { |
|  |  | if(is\_excluded\_ipv4(cn)) |
|  |  | { |
|  |  | return true; |
|  |  | } |
|  |  | } |
|  |  | else |
|  |  | { |
|  |  | if(is\_excluded\_dns\_name(cn)) |
|  |  | { |
|  |  | return true; |
|  |  | } |
|  |  | } |
|  |  | } |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | // We didn't encounter a name that matched any prohibited name |
|  |  | return false; |
|  |  | } |
|  |  |  |
|  |  | } // namespace Botan |

 Loading

Oops, something went wrong.
 Retry

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `21dccc8`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Frandombit%2Fbotan%2Fcommit%2F21dccc8fef18c165ba3301d850ac61521f85637e) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_ffdb0f8d_20250111_180600.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Frandombit%2Fbotan%2Fcommit%2F477822a2d10f02d8ba46c9d8a5132f25843f5cc1)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Frandombit%2Fbotan%2Fcommit%2F477822a2d10f02d8ba46c9d8a5132f25843f5cc1)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=randombit%2Fbotan)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[randombit](/randombit)
/
**[botan](/randombit/botan)**
Public

* [Notifications](/login?return_to=%2Frandombit%2Fbotan) You must be signed in to change notification settings
* [Fork
  574](/login?return_to=%2Frandombit%2Fbotan)
* [Star
   2.8k](/login?return_to=%2Frandombit%2Fbotan)

* [Code](/randombit/botan)
* [Issues
  183](/randombit/botan/issues)
* [Pull requests
  29](/randombit/botan/pulls)
* [Discussions](/randombit/botan/discussions)
* [Actions](/randombit/botan/actions)
* [Wiki](/randombit/botan/wiki)
* [Security](/randombit/botan/security)
* [Insights](/randombit/botan/pulse)

Additional navigation options

* [Code](/randombit/botan)
* [Issues](/randombit/botan/issues)
* [Pull requests](/randombit/botan/pulls)
* [Discussions](/randombit/botan/discussions)
* [Actions](/randombit/botan/actions)
* [Wiki](/randombit/botan/wiki)
* [Security](/randombit/botan/security)
* [Insights](/randombit/botan/pulse)

## Commit

[Permalink](/randombit/botan/commit/477822a2d10f02d8ba46c9d8a5132f25843f5cc1)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Merge pull request [#4052](https://github.com/randombit/botan/pull/4052) from randombit/jack/backport-4045

[Browse files](/randombit/botan/tree/477822a2d10f02d8ba46c9d8a5132f25843f5cc1)
Browse the repository at this point in the history

```
[[#4045](https://github.com/randombit/botan/pull/4045) Backport] During X.509 verification, first check the signatures
```

* Loading branch information

[![@randombit](https://avatars.githubusercontent.com/u/469092?s=40&v=4)](/randombit)

[randombit](/randombit/botan/commits?author=randombit "View all commits by randombit")
authored
May 13, 2024

2 parents
[ac5e491](/randombit/botan/commit/ac5e491f860e8abe74ad1cf8d6d8c410bbd5f4ff)
+
[cbbcc93](/randombit/botan/commit/cbbcc934043a0b1fa573a0022d002fd93f40214d)

commit 477822a

Showing
**1 changed file**
with
**64 additions**
and
**33 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

## There are no files selected for viewing

97 changes: 64 additions & 33 deletions

97
[src/lib/x509/x509path.cpp](#diff-66fde5253dcd24134fca61243087f31ae8124dc3ed7e313234ebc78a0ab1675c "src/lib/x509/x509path.cpp")

Show comments

[View file](/randombit/botan/blob/477822a2d10f02d8ba46c9d8a5132f25843f5cc1/src/lib/x509/x509path.cpp)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -51,6 +51,70 @@ PKIX::check\_chain(const std::vector<std::shared\_ptr<const X509\_Certificate>>& ce |
|  |  | if(!cert\_path[0]->allowed\_usage(usage)) |
|  |  | cert\_status[0].insert(Certificate\_Status\_Code::INVALID\_USAGE); |
|  |  |  |
|  |  | for(size\_t i = 0; i != cert\_path.size(); ++i) |
|  |  | { |
|  |  | std::set<Certificate\_Status\_Code>& status = cert\_status.at(i); |
|  |  |  |
|  |  | const bool at\_self\_signed\_root = (i == cert\_path.size() - 1); |
|  |  |  |
|  |  | const std::shared\_ptr<const X509\_Certificate>& subject = cert\_path[i]; |
|  |  |  |
|  |  | const std::shared\_ptr<const X509\_Certificate>& issuer = cert\_path[at\_self\_signed\_root ? (i) : (i + 1)]; |
|  |  |  |
|  |  | std::unique\_ptr<Public\_Key> issuer\_key(issuer->subject\_public\_key()); |
|  |  |  |
|  |  | // Check the signature algorithm is known |
|  |  | if(OIDS::oid2str\_or\_empty(subject->signature\_algorithm().get\_oid()).empty()) |
|  |  | { |
|  |  | status.insert(Certificate\_Status\_Code::SIGNATURE\_ALGO\_UNKNOWN); |
|  |  | } |
|  |  | else |
|  |  | { |
|  |  | // only perform the following checks if the signature algorithm is known |
|  |  | if(!issuer\_key) |
|  |  | { |
|  |  | status.insert(Certificate\_Status\_Code::CERT\_PUBKEY\_INVALID); |
|  |  | } |
|  |  | else |
|  |  | { |
|  |  | const Certificate\_Status\_Code sig\_status = subject->verify\_signature(\*issuer\_key); |
|  |  |  |
|  |  | if(sig\_status != Certificate\_Status\_Code::VERIFIED) |
|  |  | status.insert(sig\_status); |
|  |  |  |
|  |  | if(issuer\_key->estimated\_strength() < min\_signature\_algo\_strength) |
|  |  | status.insert(Certificate\_Status\_Code::SIGNATURE\_METHOD\_TOO\_WEAK); |
|  |  | } |
|  |  |  |
|  |  | // Ignore untrusted hashes on self-signed roots |
|  |  | if(trusted\_hashes.size() > 0 && !at\_self\_signed\_root) |
|  |  | { |
|  |  | if(trusted\_hashes.count(subject->hash\_used\_for\_signature()) == 0) |
|  |  | status.insert(Certificate\_Status\_Code::UNTRUSTED\_HASH); |
|  |  | } |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  |  |
|  |  | // If any of the signatures were invalid, return immediately; we know the |
|  |  | // chain is invalid and signature failure is always considered the most |
|  |  | // critical result. This does mean other problems in the certificate (eg |
|  |  | // expired) will not be reported, but we'd have to assume any such data is |
|  |  | // anyway arbitrary considering we couldn't verify the signature chain |
|  |  |  |
|  |  | for(size\_t i = 0; i != cert\_path.size(); ++i) |
|  |  | { |
|  |  | for(auto status : cert\_status.at(i)) |
|  |  | { |
|  |  | // This ignores errors relating to the key or hash being weak since |
|  |  | // these are somewhat advisory |
|  |  | if(static\_cast<uint32\_t>(status) >= 5000) |
|  |  | { |
|  |  | return cert\_status; |
|  |  | } |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | if(cert\_path[0]->is\_CA\_cert() == false && |
|  |  | cert\_path[0]->has\_constraints(KEY\_CERT\_SIGN)) |
|  |  | { |
| Expand Down  Expand Up | | @@ -114,39 +178,6 @@ PKIX::check\_chain(const std::vector<std::shared\_ptr<const X509\_Certificate>>& ce |
|  |  | if(!issuer->is\_CA\_cert() && !self\_signed\_ee\_cert) |
|  |  | status.insert(Certificate\_Status\_Code::CA\_CERT\_NOT\_FOR\_CERT\_ISSUER); |
|  |  |  |
|  |  | std::unique\_ptr<Public\_Key> issuer\_key(issuer->subject\_public\_key()); |
|  |  |  |
|  |  | // Check the signature algorithm is known |
|  |  | if(OIDS::oid2str\_or\_empty(subject->signature\_algorithm().get\_oid()).empty()) |
|  |  | { |
|  |  | status.insert(Certificate\_Status\_Code::SIGNATURE\_ALGO\_UNKNOWN); |
|  |  | } |
|  |  | else |
|  |  | { |
|  |  | // only perform the following checks if the signature algorithm is known |
|  |  | if(!issuer\_key) |
|  |  | { |
|  |  | status.insert(Certificate\_Status\_Code::CERT\_PUBKEY\_INVALID); |
|  |  | } |
|  |  | else |
|  |  | { |
|  |  | const Certificate\_Status\_Code sig\_status = subject->verify\_signature(\*issuer\_key); |
|  |  |  |
|  |  | if(sig\_status != Certificate\_Status\_Code::VERIFIED) |
|  |  | status.insert(sig\_status); |
|  |  |  |
|  |  | if(issuer\_key->estimated\_strength() < min\_signature\_algo\_strength) |
|  |  | status.insert(Certificate\_Status\_Code::SIGNATURE\_METHOD\_TOO\_WEAK); |
|  |  | } |
|  |  |  |
|  |  | // Ignore untrusted hashes on self-signed roots |
|  |  | if(trusted\_hashes.size() > 0 && !at\_self\_signed\_root) |
|  |  | { |
|  |  | if(trusted\_hashes.count(subject->hash\_used\_for\_signature()) == 0) |
|  |  | status.insert(Certificate\_Status\_Code::UNTRUSTED\_HASH); |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | // Check cert extensions |
|  |  |  |
|  |  | if(subject->x509\_version() == 1) |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `477822a`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Frandombit%2Fbotan%2Fcommit%2F477822a2d10f02d8ba46c9d8a5132f25843f5cc1) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_25ca1c5a_20250111_180603.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Frandombit%2Fbotan%2Fcommit%2Fff704b12e6fa351aaedd07bffdc91722e84586b8)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Frandombit%2Fbotan%2Fcommit%2Fff704b12e6fa351aaedd07bffdc91722e84586b8)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=randombit%2Fbotan)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[randombit](/randombit)
/
**[botan](/randombit/botan)**
Public

* [Notifications](/login?return_to=%2Frandombit%2Fbotan) You must be signed in to change notification settings
* [Fork
  574](/login?return_to=%2Frandombit%2Fbotan)
* [Star
   2.8k](/login?return_to=%2Frandombit%2Fbotan)

* [Code](/randombit/botan)
* [Issues
  183](/randombit/botan/issues)
* [Pull requests
  29](/randombit/botan/pulls)
* [Discussions](/randombit/botan/discussions)
* [Actions](/randombit/botan/actions)
* [Wiki](/randombit/botan/wiki)
* [Security](/randombit/botan/security)
* [Insights](/randombit/botan/pulse)

Additional navigation options

* [Code](/randombit/botan)
* [Issues](/randombit/botan/issues)
* [Pull requests](/randombit/botan/pulls)
* [Discussions](/randombit/botan/discussions)
* [Actions](/randombit/botan/actions)
* [Wiki](/randombit/botan/wiki)
* [Security](/randombit/botan/security)
* [Insights](/randombit/botan/pulse)

## Commit

[Permalink](/randombit/botan/commit/ff704b12e6fa351aaedd07bffdc91722e84586b8)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Merge pull request [#4186](https://github.com/randombit/botan/pull/4186) from randombit/jack/fix-nc-dos

[Browse files](/randombit/botan/tree/ff704b12e6fa351aaedd07bffdc91722e84586b8)
Browse the repository at this point in the history

```
Address denial of service in name constraints processing
```

* Loading branch information

[![@randombit](https://avatars.githubusercontent.com/u/469092?s=40&v=4)](/randombit)

[randombit](/randombit/botan/commits?author=randombit "View all commits by randombit")
authored
Jul 8, 2024

2 parents
[76ba92a](/randombit/botan/commit/76ba92aeb40f005476a3bf16fbe6812a238b8596)
+
[655c2be](/randombit/botan/commit/655c2be095325492f88ea0778b155e7bcedee3b3)

commit ff704b1

 Show file tree

 Hide file tree

Showing
**3 changed files**
with
**32 additions**
and
**4 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* src

  + lib/x509

    - src/lib/x509/name\_constraint.cpp
      [name\_constraint.cpp](#diff-c83420f0b62a5ac32bcde8adf776991a1bb720b9a0569e5d34dd56542eb9bbe4)
    - src/lib/x509/pkix\_types.h
      [pkix\_types.h](#diff-7904183f7c0dc5cfafea9cbd8c2beab1a545f1316897b0253a4297c3b131ea78)
  + scripts

    - src/scripts/run\_limbo\_tests.py
      [run\_limbo\_tests.py](#diff-ed7eee2ea22f27547cb34ccd4619adc12b0e8084e6acf73387f63a94a0c68926)

## There are no files selected for viewing

30 changes: 30 additions & 0 deletions

30
[src/lib/x509/name\_constraint.cpp](#diff-c83420f0b62a5ac32bcde8adf776991a1bb720b9a0569e5d34dd56542eb9bbe4 "src/lib/x509/name_constraint.cpp")

Show comments

[View file](/randombit/botan/blob/ff704b12e6fa351aaedd07bffdc91722e84586b8/src/lib/x509/name_constraint.cpp)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -11,6 +11,7 @@ |
|  |  | #include <botan/ber\_dec.h> |
|  |  | #include <botan/x509cert.h> |
|  |  | #include <botan/internal/fmt.h> |
|  |  | #include <botan/internal/int\_utils.h> |
|  |  | #include <botan/internal/loadstor.h> |
|  |  | #include <botan/internal/parsing.h> |
|  |  | #include <functional> |
| Expand Down  Expand Up | | @@ -296,13 +297,38 @@ NameConstraints::NameConstraints(std::vector<GeneralSubtree>&& permitted\_subtree |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | namespace { |
|  |  |  |
|  |  | bool exceeds\_limit(size\_t dn\_count, size\_t alt\_count, size\_t constraint\_count) { |
|  |  | /\*\* |
|  |  | \* OpenSSL uses a similar limit, but applies it to the total number of |
|  |  | \* constraints, while we apply it to permitted and excluded independently. |
|  |  | \*/ |
|  |  | constexpr size\_t MAX\_NC\_CHECKS = (1 << 20); |
|  |  |  |
|  |  | if(auto names = checked\_add(dn\_count, alt\_count)) { |
|  |  | if(auto product = checked\_mul(\*names, constraint\_count)) { |
|  |  | if(\*product < MAX\_NC\_CHECKS) { |
|  |  | return false; |
|  |  | } |
|  |  | } |
|  |  | } |
|  |  | return true; |
|  |  | } |
|  |  |  |
|  |  | } // namespace |
|  |  |  |
|  |  | bool NameConstraints::is\_permitted(const X509\_Certificate& cert, bool reject\_unknown) const { |
|  |  | if(permitted().empty()) { |
|  |  | return true; |
|  |  | } |
|  |  |  |
|  |  | const auto& alt\_name = cert.subject\_alt\_name(); |
|  |  |  |
|  |  | if(exceeds\_limit(cert.subject\_dn().count(), alt\_name.count(), permitted().size())) { |
|  |  | return false; |
|  |  | } |
|  |  |  |
|  |  | if(reject\_unknown) { |
|  |  | if(m\_permitted\_name\_types.contains(GeneralName::NameType::Other) && !alt\_name.other\_names().empty()) { |
|  |  | return false; |
| Expand Down  Expand Up | | @@ -416,6 +442,10 @@ bool NameConstraints::is\_excluded(const X509\_Certificate& cert, bool reject\_unkn |
|  |  |  |
|  |  | const auto& alt\_name = cert.subject\_alt\_name(); |
|  |  |  |
|  |  | if(exceeds\_limit(cert.subject\_dn().count(), alt\_name.count(), excluded().size())) { |
|  |  | return true; |
|  |  | } |
|  |  |  |
|  |  | if(reject\_unknown) { |
|  |  | // This is one is overly broad: we should just reject if there is a name constraint |
|  |  | // with the same OID as one of the other names |
| Expand Down | |  |

2 changes: 2 additions & 0 deletions

2
[src/lib/x509/pkix\_types.h](#diff-7904183f7c0dc5cfafea9cbd8c2beab1a545f1316897b0253a4297c3b131ea78 "src/lib/x509/pkix_types.h")

Show comments

[View file](/randombit/botan/blob/ff704b12e6fa351aaedd07bffdc91722e84586b8/src/lib/x509/pkix_types.h)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -66,6 +66,8 @@ class BOTAN\_PUBLIC\_API(2, 0) X509\_DN final : public ASN1\_Object { |
|  |  |  |
|  |  | bool empty() const { return m\_rdn.empty(); } |
|  |  |  |
|  |  | size\_t count() const { return m\_rdn.size(); } |
|  |  |  |
|  |  | std::string to\_string() const; |
|  |  |  |
|  |  | const std::vector<std::pair<OID, ASN1\_String>>& dn\_info() const { return m\_rdn; } |
| Expand Down | |  |

4 changes: 0 additions & 4 deletions

4
[src/scripts/run\_limbo\_tests.py](#diff-ed7eee2ea22f27547cb34ccd4619adc12b0e8084e6acf73387f63a94a0c68926 "src/scripts/run_limbo_tests.py")

Show comments

[View file](/randombit/botan/blob/ff704b12e6fa351aaedd07bffdc91722e84586b8/src/scripts/run_limbo_tests.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -50,10 +50,6 @@ |
|  |  | 'webpki::san::wildcard-embedded-leftmost-san': 'CABF rule not RFC 5280', |
|  |  | 'webpki::ca-as-leaf': 'Not applicable outside of webpki', |
|  |  |  |
|  |  | 'pathological::nc-dos-1': 'Todo', |
|  |  | 'pathological::nc-dos-2': 'Todo', |
|  |  | 'pathological::nc-dos-3': 'Todo', |
|  |  |  |
|  |  | 'webpki::explicit-curve': 'Deprecated but not gone yet', |
|  |  | 'rfc5280::nc::invalid-dnsname-leading-period': 'Common extension', |
|  |  |  |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `ff704b1`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Frandombit%2Fbotan%2Fcommit%2Fff704b12e6fa351aaedd07bffdc91722e84586b8) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_ff427447_20250111_180601.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Frandombit%2Fbotan%2Fcommit%2F7606d70d3a2ac7114476ec2651ca0243c4536fdf)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Frandombit%2Fbotan%2Fcommit%2F7606d70d3a2ac7114476ec2651ca0243c4536fdf)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=randombit%2Fbotan)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[randombit](/randombit)
/
**[botan](/randombit/botan)**
Public

* [Notifications](/login?return_to=%2Frandombit%2Fbotan) You must be signed in to change notification settings
* [Fork
  574](/login?return_to=%2Frandombit%2Fbotan)
* [Star
   2.8k](/login?return_to=%2Frandombit%2Fbotan)

* [Code](/randombit/botan)
* [Issues
  183](/randombit/botan/issues)
* [Pull requests
  29](/randombit/botan/pulls)
* [Discussions](/randombit/botan/discussions)
* [Actions](/randombit/botan/actions)
* [Wiki](/randombit/botan/wiki)
* [Security](/randombit/botan/security)
* [Insights](/randombit/botan/pulse)

Additional navigation options

* [Code](/randombit/botan)
* [Issues](/randombit/botan/issues)
* [Pull requests](/randombit/botan/pulls)
* [Discussions](/randombit/botan/discussions)
* [Actions](/randombit/botan/actions)
* [Wiki](/randombit/botan/wiki)
* [Security](/randombit/botan/security)
* [Insights](/randombit/botan/pulse)

## Commit

[Permalink](/randombit/botan/commit/7606d70d3a2ac7114476ec2651ca0243c4536fdf)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Merge pull request [#4034](https://github.com/randombit/botan/pull/4034) from randombit/jack/refactor-alt-name

[Browse files](/randombit/botan/tree/7606d70d3a2ac7114476ec2651ca0243c4536fdf)
Browse the repository at this point in the history

```
Refactor AlternativeName internals
```

* Loading branch information

[![@randombit](https://avatars.githubusercontent.com/u/469092?s=40&v=4)](/randombit)

[randombit](/randombit/botan/commits?author=randombit "View all commits by randombit")
authored
May 10, 2024

2 parents
[8798305](/randombit/botan/commit/8798305c102934c4c20d9e4f63b768ba7e74c6b9)
+
[75a0deb](/randombit/botan/commit/75a0deb848ff326d65727fe2722e94f49981f0ef)

commit 7606d70

 Show file tree

 Hide file tree

Showing
**10 changed files**
with
**380 additions**
and
**199 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* src

  + lib

    - asn1

      * src/lib/asn1/asn1\_obj.h
        [asn1\_obj.h](#diff-130301ce5bd94e783b955f3baae374878a6bf8fda44e7ea29678dab52b9bee35)
    - x509

      * src/lib/x509/alt\_name.cpp
        [alt\_name.cpp](#diff-e90c72ac08971bfafb0b5ee4d58f17667d45bbc6fe7c882f119e9f04f1c9d56a)
      * src/lib/x509/asn1\_alt\_name.cpp
        [asn1\_alt\_name.cpp](#diff-18686dd6ae0c4e555efcf0a845fdbb2772342bedeb57544c92e8ca4b201293c6)
      * src/lib/x509/name\_constraint.cpp
        [name\_constraint.cpp](#diff-c83420f0b62a5ac32bcde8adf776991a1bb720b9a0569e5d34dd56542eb9bbe4)
      * src/lib/x509/pkcs10.cpp
        [pkcs10.cpp](#diff-43c765d69fe2c62c25fba8a34df23573fa4057c18d5c84cbc7a999d751625b59)
      * src/lib/x509/pkix\_types.h
        [pkix\_types.h](#diff-7904183f7c0dc5cfafea9cbd8c2beab1a545f1316897b0253a4297c3b131ea78)
      * src/lib/x509/x509\_ext.cpp
        [x509\_ext.cpp](#diff-0737be45a53b640db0a8a442b82180db4a21721583185d15aa0cda4894d48146)
      * src/lib/x509/x509cert.cpp
        [x509cert.cpp](#diff-07a8c06eb8f4a673bff8b1be9e939af39731e672f7ca3f587039a52b6fb2b0cd)
      * src/lib/x509/x509self.cpp
        [x509self.cpp](#diff-3ec5ff20ddd8c85aa4ecd55e570f7a3bd1dd62bebd6849c1ddf465c7c42da897)
  + tests

    - src/tests/unit\_x509.cpp
      [unit\_x509.cpp](#diff-df62a8a4a6c3410f80fc89170084c7938d1d9e7a1bfcd84a9699a91016f9810f)

## There are no files selected for viewing

2 changes: 2 additions & 0 deletions

2
[src/lib/asn1/asn1\_obj.h](#diff-130301ce5bd94e783b955f3baae374878a6bf8fda44e7ea29678dab52b9bee35 "src/lib/asn1/asn1_obj.h")

Show comments

[View file](/randombit/botan/blob/7606d70d3a2ac7114476ec2651ca0243c4536fdf/src/lib/asn1/asn1_obj.h)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -425,6 +425,8 @@ class BOTAN\_PUBLIC\_API(2, 0) ASN1\_String final : public ASN1\_Object { |
|  |  |  |
|  |  | bool operator==(const ASN1\_String& other) const { return value() == other.value(); } |
|  |  |  |
|  |  | friend bool operator<(const ASN1\_String& a, const ASN1\_String& b) { return a.value() < b.value(); } |
|  |  |  |
|  |  | explicit ASN1\_String(std::string\_view utf8 = ""); |
|  |  | ASN1\_String(std::string\_view utf8, ASN1\_Type tag); |
|  |  |  |
| Expand Down | |  |

170 changes: 170 additions & 0 deletions

170
[src/lib/x509/alt\_name.cpp](#diff-e90c72ac08971bfafb0b5ee4d58f17667d45bbc6fe7c882f119e9f04f1c9d56a "src/lib/x509/alt_name.cpp")

Show comments

[View file](/randombit/botan/blob/7606d70d3a2ac7114476ec2651ca0243c4536fdf/src/lib/x509/alt_name.cpp)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -0,0 +1,170 @@ |
|  |  | /\* |
|  |  | \* (C) 2024 Jack Lloyd |
|  |  | \* |
|  |  | \* Botan is released under the Simplified BSD License (see license.txt) |
|  |  | \*/ |
|  |  |  |
|  |  | #include <botan/pkix\_types.h> |
|  |  |  |
|  |  | #include <botan/ber\_dec.h> |
|  |  | #include <botan/der\_enc.h> |
|  |  | #include <botan/internal/loadstor.h> |
|  |  | #include <botan/internal/parsing.h> |
|  |  |  |
|  |  | namespace Botan { |
|  |  |  |
|  |  | void AlternativeName::add\_uri(std::string\_view uri) { |
|  |  | if(!uri.empty()) { |
|  |  | m\_uri.insert(std::string(uri)); |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | void AlternativeName::add\_email(std::string\_view addr) { |
|  |  | if(!addr.empty()) { |
|  |  | m\_email.insert(std::string(addr)); |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | void AlternativeName::add\_dns(std::string\_view dns) { |
|  |  | if(!dns.empty()) { |
|  |  | m\_dns.insert(std::string(dns)); |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | void AlternativeName::add\_other\_name(const OID& oid, const ASN1\_String& value) { |
|  |  | m\_othernames.insert(std::make\_pair(oid, value)); |
|  |  | } |
|  |  |  |
|  |  | void AlternativeName::add\_dn(const X509\_DN& dn) { |
|  |  | m\_dn\_names.insert(dn); |
|  |  | } |
|  |  |  |
|  |  | void AlternativeName::add\_ip\_address(std::string\_view ip) { |
|  |  | if(!ip.empty()) { |
|  |  | m\_ip\_addr.insert(std::string(ip)); |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | bool AlternativeName::has\_items() const { |
|  |  | if(!this->dns().empty()) { |
|  |  | return true; |
|  |  | } |
|  |  | if(!this->uris().empty()) { |
|  |  | return true; |
|  |  | } |
|  |  | if(!this->email().empty()) { |
|  |  | return true; |
|  |  | } |
|  |  | if(!this->ip\_address().empty()) { |
|  |  | return true; |
|  |  | } |
|  |  | if(!this->directory\_names().empty()) { |
|  |  | return true; |
|  |  | } |
|  |  | if(!this->other\_names().empty()) { |
|  |  | return true; |
|  |  | } |
|  |  | return false; |
|  |  | } |
|  |  |  |
|  |  | void AlternativeName::encode\_into(DER\_Encoder& der) const { |
|  |  | der.start\_sequence(); |
|  |  |  |
|  |  | /\* |
|  |  | GeneralName ::= CHOICE { |
|  |  | otherName [0] OtherName, |
|  |  | rfc822Name [1] IA5String, |
|  |  | dNSName [2] IA5String, |
|  |  | x400Address [3] ORAddress, |
|  |  | directoryName [4] Name, |
|  |  | ediPartyName [5] EDIPartyName, |
|  |  | uniformResourceIdentifier [6] IA5String, |
|  |  | iPAddress [7] OCTET STRING, |
|  |  | registeredID [8] OBJECT IDENTIFIER } |
|  |  | \*/ |
|  |  |  |
|  |  | for(const auto& othername : m\_othernames) { |
|  |  | der.start\_explicit(0) |
|  |  | .encode(othername.first) |
|  |  | .start\_explicit(0) |
|  |  | .encode(othername.second) |
|  |  | .end\_explicit() |
|  |  | .end\_explicit(); |
|  |  | } |
|  |  |  |
|  |  | for(const auto& name : m\_email) { |
|  |  | ASN1\_String str(name, ASN1\_Type::Ia5String); |
|  |  | der.add\_object(ASN1\_Type(1), ASN1\_Class::ContextSpecific, str.value()); |
|  |  | } |
|  |  |  |
|  |  | for(const auto& name : m\_dns) { |
|  |  | ASN1\_String str(name, ASN1\_Type::Ia5String); |
|  |  | der.add\_object(ASN1\_Type(2), ASN1\_Class::ContextSpecific, str.value()); |
|  |  | } |
|  |  |  |
|  |  | for(const auto& name : m\_dn\_names) { |
|  |  | der.add\_object(ASN1\_Type(4), ASN1\_Class::ExplicitContextSpecific, name.DER\_encode()); |
|  |  | } |
|  |  |  |
|  |  | for(const auto& name : m\_uri) { |
|  |  | ASN1\_String str(name, ASN1\_Type::Ia5String); |
|  |  | der.add\_object(ASN1\_Type(6), ASN1\_Class::ContextSpecific, str.value()); |
|  |  | } |
|  |  |  |
|  |  | for(const auto& ip : m\_ip\_addr) { |
|  |  | auto ip\_buf = store\_be(string\_to\_ipv4(ip)); |
|  |  | der.add\_object(ASN1\_Type(7), ASN1\_Class::ContextSpecific, ip\_buf.data(), 4); |
|  |  | } |
|  |  |  |
|  |  | der.end\_cons(); |
|  |  | } |
|  |  |  |
|  |  | void AlternativeName::decode\_from(BER\_Decoder& source) { |
|  |  | BER\_Decoder names = source.start\_sequence(); |
|  |  |  |
|  |  | while(names.more\_items()) { |
|  |  | BER\_Object obj = names.get\_next\_object(); |
|  |  |  |
|  |  | if(obj.is\_a(0, ASN1\_Class::ContextSpecific)) { |
|  |  | BER\_Decoder othername(obj); |
|  |  |  |
|  |  | OID oid; |
|  |  | othername.decode(oid); |
|  |  | if(othername.more\_items()) { |
|  |  | BER\_Object othername\_value\_outer = othername.get\_next\_object(); |
|  |  | othername.verify\_end(); |
|  |  |  |
|  |  | if(!othername\_value\_outer.is\_a(0, ASN1\_Class::ExplicitContextSpecific)) { |
|  |  | throw Decoding\_Error("Invalid tags on otherName value"); |
|  |  | } |
|  |  |  |
|  |  | BER\_Decoder othername\_value\_inner(othername\_value\_outer); |
|  |  |  |
|  |  | BER\_Object value = othername\_value\_inner.get\_next\_object(); |
|  |  | othername\_value\_inner.verify\_end(); |
|  |  |  |
|  |  | if(ASN1\_String::is\_string\_type(value.type()) && value.get\_class() == ASN1\_Class::Universal) { |
|  |  | add\_othername(oid, ASN1::to\_string(value), value.type()); |
|  |  | } |
|  |  | } |
|  |  | } else if(obj.is\_a(1, ASN1\_Class::ContextSpecific)) { |
|  |  | add\_email(ASN1::to\_string(obj)); |
|  |  | } else if(obj.is\_a(2, ASN1\_Class::ContextSpecific)) { |
|  |  | add\_dns(ASN1::to\_string(obj)); |
|  |  | } else if(obj.is\_a(4, ASN1\_Class::ContextSpecific | ASN1\_Class::Constructed)) { |
|  |  | BER\_Decoder dec(obj); |
|  |  | X509\_DN dn; |
|  |  | dec.decode(dn); |
|  |  | this->add\_dn(dn); |
|  |  | } else if(obj.is\_a(6, ASN1\_Class::ContextSpecific)) { |
|  |  | this->add\_uri(ASN1::to\_string(obj)); |
|  |  | } else if(obj.is\_a(7, ASN1\_Class::ContextSpecific)) { |
|  |  | if(obj.length() == 4) { |
|  |  | const uint32\_t ip = load\_be<uint32\_t>(obj.bits(), 0); |
|  |  | this->add\_ip\_address(ipv4\_to\_string(ip)); |
|  |  | } |
|  |  | } |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | } // namespace Botan |

 Loading

Oops, something went wrong.
 Retry

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `7606d70`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Frandombit%2Fbotan%2Fcommit%2F7606d70d3a2ac7114476ec2651ca0243c4536fdf) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_620dc2c0_20250111_180600.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Frandombit%2Fbotan%2Fcommit%2F39535f13c322f56aa3da2f44b2b6abb8619a82ac)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Frandombit%2Fbotan%2Fcommit%2F39535f13c322f56aa3da2f44b2b6abb8619a82ac)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=randombit%2Fbotan)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[randombit](/randombit)
/
**[botan](/randombit/botan)**
Public

* [Notifications](/login?return_to=%2Frandombit%2Fbotan) You must be signed in to change notification settings
* [Fork
  574](/login?return_to=%2Frandombit%2Fbotan)
* [Star
   2.8k](/login?return_to=%2Frandombit%2Fbotan)

* [Code](/randombit/botan)
* [Issues
  183](/randombit/botan/issues)
* [Pull requests
  29](/randombit/botan/pulls)
* [Discussions](/randombit/botan/discussions)
* [Actions](/randombit/botan/actions)
* [Wiki](/randombit/botan/wiki)
* [Security](/randombit/botan/security)
* [Insights](/randombit/botan/pulse)

Additional navigation options

* [Code](/randombit/botan)
* [Issues](/randombit/botan/issues)
* [Pull requests](/randombit/botan/pulls)
* [Discussions](/randombit/botan/discussions)
* [Actions](/randombit/botan/actions)
* [Wiki](/randombit/botan/wiki)
* [Security](/randombit/botan/security)
* [Insights](/randombit/botan/pulse)

## Commit

[Permalink](/randombit/botan/commit/39535f13c322f56aa3da2f44b2b6abb8619a82ac)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Merge pull request [#4045](https://github.com/randombit/botan/pull/4045) from randombit/jack/x509-path-sigs-first

[Browse files](/randombit/botan/tree/39535f13c322f56aa3da2f44b2b6abb8619a82ac)
Browse the repository at this point in the history

```
During X509 path validation, return immediately if a signature is invalid
```

* Loading branch information

[![@randombit](https://avatars.githubusercontent.com/u/469092?s=40&v=4)](/randombit)

[randombit](/randombit/botan/commits?author=randombit "View all commits by randombit")
authored
May 13, 2024

2 parents
[9ed7adb](/randombit/botan/commit/9ed7adbb599679c437f9bd8d7d4acf91471f78ef)
+
[e4b4ff7](/randombit/botan/commit/e4b4ff7058ff289ed33d67b1f365d826b6285e13)

commit 39535f1

Showing
**1 changed file**
with
**63 additions**
and
**33 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

## There are no files selected for viewing

96 changes: 63 additions & 33 deletions

96
[src/lib/x509/x509path.cpp](#diff-66fde5253dcd24134fca61243087f31ae8124dc3ed7e313234ebc78a0ab1675c "src/lib/x509/x509path.cpp")

Show comments

[View file](/randombit/botan/blob/39535f13c322f56aa3da2f44b2b6abb8619a82ac/src/lib/x509/x509path.cpp)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -48,6 +48,68 @@ CertificatePathStatusCodes PKIX::check\_chain(const std::vector<X509\_Certificate> |
|  |  |  |
|  |  | CertificatePathStatusCodes cert\_status(cert\_path.size()); |
|  |  |  |
|  |  | // Before anything else verify the entire chain of signatures |
|  |  | for(size\_t i = 0; i != cert\_path.size(); ++i) { |
|  |  | std::set<Certificate\_Status\_Code>& status = cert\_status.at(i); |
|  |  |  |
|  |  | const bool at\_self\_signed\_root = (i == cert\_path.size() - 1); |
|  |  |  |
|  |  | const X509\_Certificate& subject = cert\_path[i]; |
|  |  | const X509\_Certificate& issuer = cert\_path[at\_self\_signed\_root ? (i) : (i + 1)]; |
|  |  |  |
|  |  | // Check the signature algorithm is known |
|  |  | if(!subject.signature\_algorithm().oid().registered\_oid()) { |
|  |  | status.insert(Certificate\_Status\_Code::SIGNATURE\_ALGO\_UNKNOWN); |
|  |  | } else { |
|  |  | std::unique\_ptr<Public\_Key> issuer\_key; |
|  |  | try { |
|  |  | issuer\_key = issuer.subject\_public\_key(); |
|  |  | } catch(...) { |
|  |  | status.insert(Certificate\_Status\_Code::CERT\_PUBKEY\_INVALID); |
|  |  | } |
|  |  |  |
|  |  | if(issuer\_key) { |
|  |  | if(issuer\_key->estimated\_strength() < restrictions.minimum\_key\_strength()) { |
|  |  | status.insert(Certificate\_Status\_Code::SIGNATURE\_METHOD\_TOO\_WEAK); |
|  |  | } |
|  |  |  |
|  |  | const auto sig\_status = subject.verify\_signature(\*issuer\_key); |
|  |  |  |
|  |  | if(sig\_status.first != Certificate\_Status\_Code::VERIFIED) { |
|  |  | status.insert(sig\_status.first); |
|  |  | } else { |
|  |  | // Signature is valid, check if hash used was acceptable |
|  |  | const std::string hash\_used\_for\_signature = sig\_status.second; |
|  |  | BOTAN\_ASSERT\_NOMSG(!hash\_used\_for\_signature.empty()); |
|  |  | const auto& trusted\_hashes = restrictions.trusted\_hashes(); |
|  |  |  |
|  |  | // Ignore untrusted hashes on self-signed roots |
|  |  | if(!trusted\_hashes.empty() && !at\_self\_signed\_root) { |
|  |  | if(!trusted\_hashes.contains(hash\_used\_for\_signature)) { |
|  |  | status.insert(Certificate\_Status\_Code::UNTRUSTED\_HASH); |
|  |  | } |
|  |  | } |
|  |  | } |
|  |  | } |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | // If any of the signatures were invalid, return immediately; we know the |
|  |  | // chain is invalid and signature failure is always considered the most |
|  |  | // critical result. This does mean other problems in the certificate (eg |
|  |  | // expired) will not be reported, but we'd have to assume any such data is |
|  |  | // anyway arbitrary considering we couldn't verify the signature chain |
|  |  |  |
|  |  | for(size\_t i = 0; i != cert\_path.size(); ++i) { |
|  |  | for(auto status : cert\_status.at(i)) { |
|  |  | // This ignores errors relating to the key or hash being weak since |
|  |  | // these are somewhat advisory |
|  |  | if(static\_cast<uint32\_t>(status) >= 5000) { |
|  |  | return cert\_status; |
|  |  | } |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | if(!hostname.empty() && !cert\_path[0].matches\_dns\_name(hostname)) { |
|  |  | cert\_status[0].insert(Certificate\_Status\_Code::CERT\_NAME\_NOMATCH); |
|  |  | } |
| Expand Down  Expand Up | | @@ -83,6 +145,7 @@ CertificatePathStatusCodes PKIX::check\_chain(const std::vector<X509\_Certificate> |
|  |  | status.insert(Certificate\_Status\_Code::CHAIN\_LACKS\_TRUST\_ROOT); |
|  |  | } |
|  |  |  |
|  |  | // This should never happen; it indicates a bug in path building |
|  |  | if(subject.issuer\_dn() != issuer.subject\_dn()) { |
|  |  | status.insert(Certificate\_Status\_Code::CHAIN\_NAME\_MISMATCH); |
|  |  | } |
| Expand Down  Expand Up | | @@ -127,39 +190,6 @@ CertificatePathStatusCodes PKIX::check\_chain(const std::vector<X509\_Certificate> |
|  |  | status.insert(Certificate\_Status\_Code::CA\_CERT\_NOT\_FOR\_CERT\_ISSUER); |
|  |  | } |
|  |  |  |
|  |  | auto issuer\_key = issuer.subject\_public\_key(); |
|  |  |  |
|  |  | // Check the signature algorithm is known |
|  |  | if(!subject.signature\_algorithm().oid().registered\_oid()) { |
|  |  | status.insert(Certificate\_Status\_Code::SIGNATURE\_ALGO\_UNKNOWN); |
|  |  | } else { |
|  |  | // only perform the following checks if the signature algorithm is known |
|  |  | if(!issuer\_key) { |
|  |  | status.insert(Certificate\_Status\_Code::CERT\_PUBKEY\_INVALID); |
|  |  | } else { |
|  |  | const auto sig\_status = subject.verify\_signature(\*issuer\_key); |
|  |  |  |
|  |  | if(sig\_status.first == Certificate\_Status\_Code::VERIFIED) { |
|  |  | const std::string hash\_used\_for\_signature = sig\_status.second; |
|  |  | BOTAN\_ASSERT\_NOMSG(!hash\_used\_for\_signature.empty()); |
|  |  | const auto& trusted\_hashes = restrictions.trusted\_hashes(); |
|  |  |  |
|  |  | // Ignore untrusted hashes on self-signed roots |
|  |  | if(!trusted\_hashes.empty() && !at\_self\_signed\_root) { |
|  |  | if(!trusted\_hashes.contains(hash\_used\_for\_signature)) { |
|  |  | status.insert(Certificate\_Status\_Code::UNTRUSTED\_HASH); |
|  |  | } |
|  |  | } |
|  |  | } else { |
|  |  | status.insert(sig\_status.first); |
|  |  | } |
|  |  |  |
|  |  | if(issuer\_key->estimated\_strength() < restrictions.minimum\_key\_strength()) { |
|  |  | status.insert(Certificate\_Status\_Code::SIGNATURE\_METHOD\_TOO\_WEAK); |
|  |  | } |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | // Check cert extensions |
|  |  |  |
|  |  | if(subject.x509\_version() == 1) { |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `39535f1`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Frandombit%2Fbotan%2Fcommit%2F39535f13c322f56aa3da2f44b2b6abb8619a82ac) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_116aa3d4_20250111_180608.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Frandombit%2Fbotan%2Fpull%2F4052)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Frandombit%2Fbotan%2Fpull%2F4052)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=randombit%2Fbotan)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[randombit](/randombit)
/
**[botan](/randombit/botan)**
Public

* [Notifications](/login?return_to=%2Frandombit%2Fbotan) You must be signed in to change notification settings
* [Fork
  574](/login?return_to=%2Frandombit%2Fbotan)
* [Star
   2.8k](/login?return_to=%2Frandombit%2Fbotan)

* [Code](/randombit/botan)
* [Issues
  183](/randombit/botan/issues)
* [Pull requests
  29](/randombit/botan/pulls)
* [Discussions](/randombit/botan/discussions)
* [Actions](/randombit/botan/actions)
* [Wiki](/randombit/botan/wiki)
* [Security](/randombit/botan/security)
* [Insights](/randombit/botan/pulse)

Additional navigation options

* [Code](/randombit/botan)
* [Issues](/randombit/botan/issues)
* [Pull requests](/randombit/botan/pulls)
* [Discussions](/randombit/botan/discussions)
* [Actions](/randombit/botan/actions)
* [Wiki](/randombit/botan/wiki)
* [Security](/randombit/botan/security)
* [Insights](/randombit/botan/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Frandombit%2Fbotan%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Frandombit%2Fbotan%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# [#4045 Backport] During X.509 verification, first check the signatures #4052

 Merged

[randombit](/randombit)
merged 1 commit into
[release-2](/randombit/botan/tree/release-2 "randombit/botan:release-2")
from
[jack/backport-4045](/randombit/botan/tree/jack/backport-4045 "randombit/botan:jack/backport-4045")

May 13, 2024

 Merged

# [[#4045 Backport] During X.509 verification, first check the signatures](#top) #4052

[randombit](/randombit)
merged 1 commit into
[release-2](/randombit/botan/tree/release-2 "randombit/botan:release-2")
from
[jack/backport-4045](/randombit/botan/tree/jack/backport-4045 "randombit/botan:jack/backport-4045")

May 13, 2024

[Conversation
1](/randombit/botan/pull/4052)
[Commits
1](/randombit/botan/pull/4052/commits)
[Checks
19](/randombit/botan/pull/4052/checks)
[Files changed](/randombit/botan/pull/4052/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![randombit](https://avatars.githubusercontent.com/u/469092?s=60&v=4)](/randombit)

Copy link

Owner

### @randombit **[randombit](/randombit)** commented [May 11, 2024](#issue-2291023003)

The remainder of path validation logic is still subject to attacker controlled inputs, but the range of inputs is reduced to that which a legitimate certificate authority was willing to sign.

Backport of [#4045](https://github.com/randombit/botan/pull/4045)

Sorry, something went wrong.

All reactions

[![@randombit](https://avatars.githubusercontent.com/u/469092?s=40&v=4)](/randombit)
[randombit](/randombit)
changed the title
~~During X.509 verification, first check the signatures~~
[#4045 Backport] During X.509 verification, first check the signatures
[May 11, 2024](#event-12776999153)

 [![@randombit](https://avatars.githubusercontent.com/u/469092?s=40&v=4)](/randombit)
[randombit](/randombit)
[force-pushed](/randombit/botan/compare/2e18466bb273f836d43ee0ac7a35d5fb23a60107..cbbcc934043a0b1fa573a0022d002fd93f40214d)
the
jack/backport-4045

branch
from
[`2e18466`](/randombit/botan/commit/2e18466bb273f836d43ee0ac7a35d5fb23a60107) to
[`cbbcc93`](/randombit/botan/commit/cbbcc934043a0b1fa573a0022d002fd93f40214d)  [Compare](/randombit/botan/compare/2e18466bb273f836d43ee0ac7a35d5fb23a60107..cbbcc934043a0b1fa573a0022d002fd93f40214d)
[May 11, 2024 21:05](#event-12777194795)

[![@randombit](https://avatars.githubusercontent.com/u/469092?s=40&v=4)](/randombit)

`[During X.509 verification, first check the signatures](/randombit/botan/pull/4052/commits/cbbcc934043a0b1fa573a0022d002fd93f40214d "During X.509 verification, first check the signatures

The remainder of path validation logic is still subject to attacker
controlled inputs, but the range of inputs is reduced to that which a
legitimate certificate authority was willing to sign.

Backport of #4045")`
 …

`[cbbcc93](/randombit/botan/pull/4052/commits/cbbcc934043a0b1fa573a0022d002fd93f40214d)`

```
The remainder of path validation logic is still subject to attacker
controlled inputs, but the range of inputs is reduced to that which a
legitimate certificate authority was willing to sign.

Backport of [#4045](https://github.com/randombit/botan/pull/4045)
```

[![@codecov-commenter](https://avatars.githubusercontent.com/u/65553080?s=80&u=b7ee84d82e25b493051d810390e97b15f716d7ef&v=4)](/codecov-commenter)

Copy link

### **[codecov-commenter](/codecov-commenter)** commented [May 11, 2024](#issuecomment-2106035976)

|  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- |
| [Codecov](https://app.codecov.io/gh/randombit/botan/pull/4052?dropdown=coverage&src=pr&el=h1&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=Jack+Lloyd) Report Attention: Patch coverage is `95.45455%` with `1 lines` in your changes are missing coverage. Please review.  Project coverage is 91.98%. Comparing base [(`fb0a41b`)](https://app.codecov.io/gh/randombit/botan/commit/fb0a41bfa4e63b4f26302d90a2e2905e0ba2a400?dropdown=coverage&el=desc&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=Jack+Lloyd) to head [(`cbbcc93`)](https://app.codecov.io/gh/randombit/botan/pull/4052?dropdown=coverage&src=pr&el=desc&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=Jack+Lloyd). Report is 4 commits behind head on release-2.   | [Files](https://app.codecov.io/gh/randombit/botan/pull/4052?dropdown=coverage&src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=Jack+Lloyd) | Patch % | Lines | | --- | --- | --- | | [src/lib/x509/x509path.cpp](https://app.codecov.io/gh/randombit/botan/pull/4052?src=pr&el=tree&filepath=src%2Flib%2Fx509%2Fx509path.cpp&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=Jack+Lloyd#diff-c3JjL2xpYi94NTA5L3g1MDlwYXRoLmNwcA==) | 95.45% | [1 Missing ⚠️](https://app.codecov.io/gh/randombit/botan/pull/4052?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=Jack+Lloyd) |   ❗ Your organization needs to install the [Codecov GitHub app](https://github.com/apps/codecov/installations/select_target) to enable full functionality. Additional details and impacted files ``` @@            Coverage Diff             @@ ##           release-2    #4052   +/-   ## ==========================================   Coverage      91.98%   91.98%            ==========================================   Files            583      583              Lines          64254    64239   -15        Branches        6266     6272    +6      ========================================== - Hits           59103    59091   -12      + Misses          5120     5117    -3        Partials          31       31            ```   [☔ View full report in Codecov by Sentry](https://app.codecov.io/gh/randombit/botan/pull/4052?dropdown=coverage&src=pr&el=continue&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=Jack+Lloyd). 📢 Have feedback on the report? [Share it here](https://about.codecov.io/codecov-pr-comment-feedback/?utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=Jack+Lloyd). |

All reactions

Sorry, something went wrong.

 [![@randombit](https://avatars.githubusercontent.com/u/469092?s=40&v=4)](/randombit)
[randombit](/randombit)
requested a review
from [FAlbertDev](/FAlbertDev)
[May 13, 2024 10:49](#event-12785287611)

[![FAlbertDev](https://avatars.githubusercontent.com/u/126883116?s=60&v=4)](/FAlbertDev)

**[FAlbertDev](/FAlbertDev)**
approved these changes
[May 13, 2024](#pullrequestreview-2052521982)

 [View reviewed changes](/randombit/botan/pull/4052/files/cbbcc934043a0b1fa573a0022d002fd93f40214d)

 Hide details
View details

[![@randombit](https://avatars.githubusercontent.com/u/469092?s=40&v=4)](/randombit)
[randombit](/randombit)
merged commit [`477822a`](/randombit/botan/commit/477822a2d10f02d8ba46c9d8a5132f25843f5cc1)
into
release-2

[May 13, 2024](https://github.com/randombit/botan/pull/4052#event-12793620633)
21 checks passed

 [![@randombit](https://avatars.githubusercontent.com/u/469092?s=40&v=4)](/randombit)
[randombit](/randombit)
deleted the
jack/backport-4045

branch
[May 13, 2024 22:30](#event-12793620962)

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Frandombit%2Fbotan%2Fpull%2F4052)

Reviewers

[![@FAlbertDev](https://avatars.githubusercontent.com/u/126883116?s=40&v=4)](/FAlbertDev) [FAlbertDev](/FAlbertDev)

FAlbertDev approved these changes

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

Successfully merging this pull request may close these issues.

3 participants

[![@randombit](https://avatars.githubusercontent.com/u/469092?s=52&v=4)](/randombit) [![@codecov-commenter](https://avatars.githubusercontent.com/u/65553080?s=52&v=4)](/codecov-commenter) [![@FAlbertDev](https://avatars.githubusercontent.com/u/126883116?s=52&v=4)](/FAlbertDev)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_58fc09c4_20250111_180609.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Frandombit%2Fbotan%2Fsecurity%2Fadvisories%2FGHSA-5gg9-hqpr-r58j)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Frandombit%2Fbotan%2Fsecurity%2Fadvisories%2FGHSA-5gg9-hqpr-r58j)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=randombit%2Fbotan)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[randombit](/randombit)
/
**[botan](/randombit/botan)**
Public

* [Notifications](/login?return_to=%2Frandombit%2Fbotan) You must be signed in to change notification settings
* [Fork
  574](/login?return_to=%2Frandombit%2Fbotan)
* [Star
   2.8k](/login?return_to=%2Frandombit%2Fbotan)

* [Code](/randombit/botan)
* [Issues
  183](/randombit/botan/issues)
* [Pull requests
  29](/randombit/botan/pulls)
* [Discussions](/randombit/botan/discussions)
* [Actions](/randombit/botan/actions)
* [Wiki](/randombit/botan/wiki)
* [Security](/randombit/botan/security)
* [Insights](/randombit/botan/pulse)

Additional navigation options

* [Code](/randombit/botan)
* [Issues](/randombit/botan/issues)
* [Pull requests](/randombit/botan/pulls)
* [Discussions](/randombit/botan/discussions)
* [Actions](/randombit/botan/actions)
* [Wiki](/randombit/botan/wiki)
* [Security](/randombit/botan/security)
* [Insights](/randombit/botan/pulse)

# Denial of Service Due to Excessive Name Constraints

Moderate

[randombit](/randombit)
published
GHSA-5gg9-hqpr-r58j
Jul 8, 2024

## Package

botan

## Affected versions

All before 3.5.0 and 2.19.5

## Patched versions

3.5.0, 2.19.5

## Description

### Impact

Checking name constraints in X.509 certificates is quadratic in the number of names and name constraints. An attacker who presented a certificate chain which contained a very large number of names in the SubjectAlternativeName, signed by a CA certificate which contained a large number of name constraints, could cause a denial of service.

The POC used a certificate containing 32K domain names, signed by a certificate with 32K name constraints. In affected versions, verifying such a certificate could take several minutes.

### Patches

The problem has been addressed in Botan 3.5.0 in the following ways

* During path validation, the entire chain of signatures up to a trust root is checked prior to checking other parameters such as name constraints. This change requires an attacker to get a trusted CA to sign such a certificate chain. [#4045](https://github.com/randombit/botan/pull/4045)
* Optimize name constraint processing. The original implementation of name constraints was less efficient than it could have been. These optimizations reduce the cost of verifying the POC from minutes to about 3 seconds. [#4047](https://github.com/randombit/botan/pull/4047)
* Optimize SubjectAlternativeName parsing. Simply parsing the certificate with 32K names was quite expensive due to an accidentally quadratic algorithm during parsing. [#4034](https://github.com/randombit/botan/pull/4034)
* During name constraint checking, check that the product of names and name constraints is less than 2\*\*20. If this bound is exceeded, the certificate is rejected immediately. [#4186](https://github.com/randombit/botan/pull/4186)

A partial backport has also been applied and is included in Botan 2.19.5:

* [#4045](https://github.com/randombit/botan/pull/4045) was backported to `release-2` in [#4052](https://github.com/randombit/botan/pull/4052)
* The product of names and name constraints is checked. However the optimization patches could not be applied in Botan 2 as they rely on features added in C++17. As a consequence the product is limited to 2\*\*12. [#4187](https://github.com/randombit/botan/pull/4187)

If your application relies on processing or verifying X.509 certificates (this includes almost all uses of TLS) upgrading to Botan 3 is highly recommended.

### Workarounds

Prior to verifying a certificate, check the total quantity of name constraints associated with a certificate. If this seems excessive (say over 128) reject the certificate immediately.

### Credit

This issue was found and reported by Bing Shi.

### References

OpenSSL had a similar vulnerability which was addressed in [openssl/openssl@8545051](https://github.com/openssl/openssl/commit/8545051c3652bce7bb962afcb6879c4a6288bc67) using a similar check on the product of names and name constraints.

### Severity

Moderate

### CVE ID

CVE-2024-34702

### Weaknesses

[CWE-405](/advisories?query=cwe%3A405)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_d962a6e4_20250111_180609.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Frandombit%2Fbotan%2Fpull%2F4187)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Frandombit%2Fbotan%2Fpull%2F4187)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=randombit%2Fbotan)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[randombit](/randombit)
/
**[botan](/randombit/botan)**
Public

* [Notifications](/login?return_to=%2Frandombit%2Fbotan) You must be signed in to change notification settings
* [Fork
  574](/login?return_to=%2Frandombit%2Fbotan)
* [Star
   2.8k](/login?return_to=%2Frandombit%2Fbotan)

* [Code](/randombit/botan)
* [Issues
  183](/randombit/botan/issues)
* [Pull requests
  29](/randombit/botan/pulls)
* [Discussions](/randombit/botan/discussions)
* [Actions](/randombit/botan/actions)
* [Wiki](/randombit/botan/wiki)
* [Security](/randombit/botan/security)
* [Insights](/randombit/botan/pulse)

Additional navigation options

* [Code](/randombit/botan)
* [Issues](/randombit/botan/issues)
* [Pull requests](/randombit/botan/pulls)
* [Discussions](/randombit/botan/discussions)
* [Actions](/randombit/botan/actions)
* [Wiki](/randombit/botan/wiki)
* [Security](/randombit/botan/security)
* [Insights](/randombit/botan/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Frandombit%2Fbotan%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Frandombit%2Fbotan%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Address various name constraint bugs #4187

 Merged

[randombit](/randombit)
merged 1 commit into
[release-2](/randombit/botan/tree/release-2 "randombit/botan:release-2")
from
[jack/fix-nc-dos-2x](/randombit/botan/tree/jack/fix-nc-dos-2x "randombit/botan:jack/fix-nc-dos-2x")

Jul 8, 2024

 Merged

# [Address various name constraint bugs](#top) #4187

[randombit](/randombit)
merged 1 commit into
[release-2](/randombit/botan/tree/release-2 "randombit/botan:release-2")
from
[jack/fix-nc-dos-2x](/randombit/botan/tree/jack/fix-nc-dos-2x "randombit/botan:jack/fix-nc-dos-2x")

Jul 8, 2024

[Conversation
0](/randombit/botan/pull/4187)
[Commits
1](/randombit/botan/pull/4187/commits)
[Checks
19](/randombit/botan/pull/4187/checks)
[Files changed](/randombit/botan/pull/4187/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![randombit](https://avatars.githubusercontent.com/u/469092?s=60&v=4)](/randombit)

Copy link

Owner

### @randombit **[randombit](/randombit)** commented [Jul 8, 2024](#issue-2395737073)

 *No description provided.*

Sorry, something went wrong.

All reactions

 [![@randombit](https://avatars.githubusercontent.com/u/469092?s=40&v=4)](/randombit)
[randombit](/randombit)
requested review from
[FAlbertDev](/FAlbertDev) and
[reneme](/reneme)
[July 8, 2024 14:03](#event-13424598588)

[![@randombit](https://avatars.githubusercontent.com/u/469092?s=40&v=4)](/randombit)

`[Address various name constraint bugs](/randombit/botan/pull/4187/commits/68338f5912534c74469f7f4e6e22b37aa5159952 "Address various name constraint bugs")`

`[68338f5](/randombit/botan/pull/4187/commits/68338f5912534c74469f7f4e6e22b37aa5159952)`

 [![@randombit](https://avatars.githubusercontent.com/u/469092?s=40&v=4)](/randombit)
[randombit](/randombit)
[force-pushed](/randombit/botan/compare/10a9ea73896a8e7a59b2a3e1de0e8e69c4160d07..68338f5912534c74469f7f4e6e22b37aa5159952)
the
jack/fix-nc-dos-2x

branch
from
[`10a9ea7`](/randombit/botan/commit/10a9ea73896a8e7a59b2a3e1de0e8e69c4160d07) to
[`68338f5`](/randombit/botan/commit/68338f5912534c74469f7f4e6e22b37aa5159952)  [Compare](/randombit/botan/compare/10a9ea73896a8e7a59b2a3e1de0e8e69c4160d07..68338f5912534c74469f7f4e6e22b37aa5159952)
[July 8, 2024 14:08](#event-13424671583)

[![FAlbertDev](https://avatars.githubusercontent.com/u/126883116?s=60&v=4)](/FAlbertDev)

**[FAlbertDev](/FAlbertDev)**
approved these changes
[Jul 8, 2024](#pullrequestreview-2163446502)

 [View reviewed changes](/randombit/botan/pull/4187/files)

 Hide details
View details

[![@randombit](https://avatars.githubusercontent.com/u/469092?s=40&v=4)](/randombit)
[randombit](/randombit)
merged commit [`21dccc8`](/randombit/botan/commit/21dccc8fef18c165ba3301d850ac61521f85637e)
into
release-2

[Jul 8, 2024](https://github.com/randombit/botan/pull/4187#event-13425333686)
19 checks passed

 [![@randombit](https://avatars.githubusercontent.com/u/469092?s=40&v=4)](/randombit)
[randombit](/randombit)
deleted the
jack/fix-nc-dos-2x

branch
[July 8, 2024 14:50](#event-13425334376)

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Frandombit%2Fbotan%2Fpull%2F4187)

Reviewers

[![@FAlbertDev](https://avatars.githubusercontent.com/u/126883116?s=40&v=4)](/FAlbertDev) [FAlbertDev](/FAlbertDev)

FAlbertDev approved these changes

[![@reneme](https://avatars.githubusercontent.com/u/1562139?s=40&v=4)](/reneme) [reneme](/reneme)

 Awaiting requested review from reneme

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

Successfully merging this pull request may close these issues.

2 participants

[![@randombit](https://avatars.githubusercontent.com/u/469092?s=52&v=4)](/randombit) [![@FAlbertDev](https://avatars.githubusercontent.com/u/126883116?s=52&v=4)](/FAlbertDev)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_de56a950_20250111_180607.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Frandombit%2Fbotan%2Fpull%2F4047)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Frandombit%2Fbotan%2Fpull%2F4047)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=randombit%2Fbotan)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[randombit](/randombit)
/
**[botan](/randombit/botan)**
Public

* [Notifications](/login?return_to=%2Frandombit%2Fbotan) You must be signed in to change notification settings
* [Fork
  574](/login?return_to=%2Frandombit%2Fbotan)
* [Star
   2.8k](/login?return_to=%2Frandombit%2Fbotan)

* [Code](/randombit/botan)
* [Issues
  183](/randombit/botan/issues)
* [Pull requests
  29](/randombit/botan/pulls)
* [Discussions](/randombit/botan/discussions)
* [Actions](/randombit/botan/actions)
* [Wiki](/randombit/botan/wiki)
* [Security](/randombit/botan/security)
* [Insights](/randombit/botan/pulse)

Additional navigation options

* [Code](/randombit/botan)
* [Issues](/randombit/botan/issues)
* [Pull requests](/randombit/botan/pulls)
* [Discussions](/randombit/botan/discussions)
* [Actions](/randombit/botan/actions)
* [Wiki](/randombit/botan/wiki)
* [Security](/randombit/botan/security)
* [Insights](/randombit/botan/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Frandombit%2Fbotan%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Frandombit%2Fbotan%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Optimize name constraint matching #4047

 Merged

[randombit](/randombit)
merged 11 commits into
[master](/randombit/botan/tree/master "randombit/botan:master")
from
[jack/opt-name-constraints](/randombit/botan/tree/jack/opt-name-constraints "randombit/botan:jack/opt-name-constraints")

May 14, 2024

 Merged

# [Optimize name constraint matching](#top) #4047

[randombit](/randombit)
merged 11 commits into
[master](/randombit/botan/tree/master "randombit/botan:master")
from
[jack/opt-name-constraints](/randombit/botan/tree/jack/opt-name-constraints "randombit/botan:jack/opt-name-constraints")

May 14, 2024

[Conversation
7](/randombit/botan/pull/4047)
[Commits
11](/randombit/botan/pull/4047/commits)
[Checks
42](/randombit/botan/pull/4047/checks)
[Files changed](/randombit/botan/pull/4047/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![randombit](https://avatars.githubusercontent.com/u/469092?s=60&v=4)](/randombit)

Copy link

Owner

### @randombit **[randombit](/randombit)** commented [May 10, 2024](#issue-2289601420)

Previously name constraint matching worked by smashing all of the constraints and names into `std::string`, then parsing the values back out of the strings *for each match attempt*. This is all quite slow and needless. Instead store the names in their best form for matching in a `std::variant`.

Sorry, something went wrong.

All reactions

 [![@randombit](https://avatars.githubusercontent.com/u/469092?s=40&v=4)](/randombit)
[randombit](/randombit)
requested a review
from [reneme](/reneme)
[May 10, 2024 12:02](#event-12768965933)

 [![@randombit](https://avatars.githubusercontent.com/u/469092?s=40&v=4)](/randombit)
[randombit](/randombit)
[force-pushed](/randombit/botan/compare/43a4c834959b399d0b1c058fc48819d6f895ec62..0b70811b0f83ba1613ed079cf3452a606a9c8614)
the
jack/opt-name-constraints

branch
2 times, most recently
from
[`43a4c83`](/randombit/botan/commit/43a4c834959b399d0b1c058fc48819d6f895ec62) to
[`0b70811`](/randombit/botan/commit/0b70811b0f83ba1613ed079cf3452a606a9c8614)  [Compare](/randombit/botan/compare/43a4c834959b399d0b1c058fc48819d6f895ec62..0b70811b0f83ba1613ed079cf3452a606a9c8614)
[May 10, 2024 12:13](#event-12769063898)

[![@coveralls](https://avatars.githubusercontent.com/u/2354108?s=80&v=4)](/coveralls)

Copy link

### **[coveralls](/coveralls)** commented [May 10, 2024](#issuecomment-2104545016) • edited Loading

| [Coverage Status](https://coveralls.io/builds/67473957)  coverage: 91.92% (-0.07%) from 91.993% when pulling **[6700358](https://github.com/randombit/botan/commit/6700358de060858eb7f3e07201dcf50ce9c720fc) on jack/opt-name-constraints** into **[39535f1](https://github.com/randombit/botan/commit/39535f13c322f56aa3da2f44b2b6abb8619a82ac) on master**. |
| --- |

All reactions

Sorry, something went wrong.

 [![@randombit](https://avatars.githubusercontent.com/u/469092?s=40&v=4)](/randombit)
[randombit](/randombit)
[force-pushed](/randombit/botan/compare/a6ad2c2f1738d3acbae5013e8c5735b1d55046d7..deae0346416ef12559d823227d4d6d205f949019)
the
jack/opt-name-constraints

branch
from
[`a6ad2c2`](/randombit/botan/commit/a6ad2c2f1738d3acbae5013e8c5735b1d55046d7) to
[`deae034`](/randombit/botan/commit/deae0346416ef12559d823227d4d6d205f949019)  [Compare](/randombit/botan/compare/a6ad2c2f1738d3acbae5013e8c5735b1d55046d7..deae0346416ef12559d823227d4d6d205f949019)
[May 11, 2024 16:24](#event-12776791720)

[![FAlbertDev](https://avatars.githubusercontent.com/u/126883116?s=60&v=4)](/FAlbertDev)

**[FAlbertDev](/FAlbertDev)**
approved these changes
[May 13, 2024](#pullrequestreview-2052178711)

 [View reviewed changes](/randombit/botan/pull/4047/files)

Copy link

Collaborator

### @FAlbertDev **[FAlbertDev](/FAlbertDev)** left a comment

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

I like your optimizations :)

Sorry, something went wrong.

All reactions

[src/lib/x509/name\_constraint.cpp](/randombit/botan/pull/4047/files#diff-c83420f0b62a5ac32bcde8adf776991a1bb720b9a0569e5d34dd56542eb9bbe4)
Outdated

Comment on lines
265
 to
270

|  |  | m\_excluded\_contains\_unknown = false; |
| --- | --- | --- |
|  |  | for(const auto& c : m\_permitted\_subtrees) { |
|  |  | if(c.base().is\_unknown\_type()) { |
|  |  | m\_excluded\_contains\_unknown = true; |
|  |  | } |
|  |  | } |

Copy link

Collaborator

### @FAlbertDev **[FAlbertDev](/FAlbertDev)** [May 13, 2024](#discussion_r1598167643)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Suggested change

|  | m\_excluded\_contains\_unknown = false; |
| --- | --- |
|  | for(const auto& c : m\_permitted\_subtrees) { |
|  | if(c.base().is\_unknown\_type()) { |
|  | m\_excluded\_contains\_unknown = true; |
|  | } |
|  | } |
|  | m\_excluded\_contains\_unknown = false; |
|  | for(const auto& c : m\_excluded\_subtrees) { |
|  | if(c.base().is\_unknown\_type()) { |
|  | m\_excluded\_contains\_unknown = true; |
|  | } |
|  | } |

Sorry, something went wrong.

All reactions

Copy link

Owner

Author

### @randombit **[randombit](/randombit)** [May 13, 2024](#discussion_r1598578923)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

😭

Sorry, something went wrong.

All reactions

Copy link

Owner

Author

### @randombit **[randombit](/randombit)** [May 14, 2024](#discussion_r1599559908)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Fixed using a lambda

```
m_permitted_contains_unknown = contains_unknown(m_permitted_subtrees);
m_excluded_contains_unknown = contains_unknown(m_excluded_subtrees);

```

Sorry, something went wrong.

All reactions

[src/lib/x509/name\_constraint.cpp](/randombit/botan/pull/4047/files#diff-c83420f0b62a5ac32bcde8adf776991a1bb720b9a0569e5d34dd56542eb9bbe4)
Outdated

Show resolved

Hide resolved

 [randombit](/randombit)
added 4 commits
[May 14, 2024 03:45](#commits-pushed-f050272)

[![@randombit](https://avatars.githubusercontent.com/u/469092?s=40&v=4)](/randombit)

`[In AlternativeName store IPv4 address as a uint32_t](/randombit/botan/pull/4047/commits/f050272398a09e32bdb0bdc7109545da5887b478 "In AlternativeName store IPv4 address as a uint32_t")`

`[f050272](/randombit/botan/pull/4047/commits/f050272398a09e32bdb0bdc7109545da5887b478)`

[![@randombit](https://avatars.githubusercontent.com/u/469092?s=40&v=4)](/randombit)

`[Modify name constraints internal storage to use a std::variant](/randombit/botan/pull/4047/commits/27afa8514d921d318de77ebddae071c91d92656f "Modify name constraints internal storage to use a std::variant

Previously name constraints flattened everything to a std::string and
then parsed it back to the desired form during matching. This is slow.
It also bounced through a std::function for each match, which has a
surprisingly high overhead.

This commit also removes some sketchy (untested, unused within
library, unclear purpose) string constructors for GeneralName and
GeneralSubtree. Technically a SemVer break but I'm pretty sure nobody
uses these.")`
 …

`[27afa85](/randombit/botan/pull/4047/commits/27afa8514d921d318de77ebddae071c91d92656f)`

```
Previously name constraints flattened everything to a std::string and
then parsed it back to the desired form during matching. This is slow.
It also bounced through a std::function for each match, which has a
surprisingly high overhead.

This commit also removes some sketchy (untested, unused within
library, unclear purpose) string constructors for GeneralName and
GeneralSubtree. Technically a SemVer break but I'm pretty sure nobody
uses these.
```

[![@randombit](https://avatars.githubusercontent.com/u/469092?s=40&v=4)](/randombit)

`[Automatically tolower DNS names](/randombit/botan/pull/4047/commits/821f5e190af5e392e1f8003ec811197e665dc5e8 "Automatically tolower DNS names

DNS is case insensitive and forcing the DNS name to lowercase means we
don't have to tolower while comparing name constraints.")`
 …

`[821f5e1](/randombit/botan/pull/4047/commits/821f5e190af5e392e1f8003ec811197e665dc5e8)`

```
DNS is case insensitive and forcing the DNS name to lowercase means we
don't have to tolower while comparing name constraints.
```

[![@randombit](https://avatars.githubusercontent.com/u/469092?s=40&v=4)](/randombit)

`[Exit early from name constraints loop where possible](/randombit/botan/pull/4047/commits/c3cc5699879f1205949d09dc8d9e198ea1646df3 "Exit early from name constraints loop where possible

If we match on an excluded tree there is no reason to continue
checking the remainder of the constraints.")`
 …

`[c3cc569](/randombit/botan/pull/4047/commits/c3cc5699879f1205949d09dc8d9e198ea1646df3)`

```
If we match on an excluded tree there is no reason to continue
checking the remainder of the constraints.
```

 [![@randombit](https://avatars.githubusercontent.com/u/469092?s=40&v=4)](/randombit)
[randombit](/randombit)
[force-pushed](/randombit/botan/compare/f5d098f1e43da9ceb9ff5e06ca446463fb6b3a10..6700358de060858eb7f3e07201dcf50ce9c720fc)
the
jack/opt-name-constraints

branch
2 times, most recently
from
[`f5d098f`](/randombit/botan/commit/f5d098f1e43da9ceb9ff5e06ca446463fb6b3a10) to
[`6700358`](/randombit/botan/commit/6700358de060858eb7f3e07201dcf50ce9c720fc)  [Compare](/randombit/botan/compare/f5d098f1e43da9ceb9ff5e06ca446463fb6b3a10..6700358de060858eb7f3e07201dcf50ce9c720fc)
[May 14, 2024 08:01](#event-12797754986)

 [randombit](/randombit)
added 7 commits
[May 14, 2024 04:01](#commits-pushed-4ce775a)

[![@randombit](https://avatars.githubusercontent.com/u/469092?s=40&v=4)](/randombit)

`[In NameConstraints track if the trees contain any unknown names](/randombit/botan/pull/4047/commits/4ce775a6e0003a6713c87fe2c0d49b8a0eb31cca "In NameConstraints track if the trees contain any unknown names

If so we can immediately fail if the extension is critical.

Also this allows returning early from is_permitted since we don't have
to handle the case of looking for critical+unknown permitted subtrees,
which otherwise would force us to scan (and match against) the entire
list of permitted trees.")`
 …

`[4ce775a](/randombit/botan/pull/4047/commits/4ce775a6e0003a6713c87fe2c0d49b8a0eb31cca)`

```
If so we can immediately fail if the extension is critical.

Also this allows returning early from is_permitted since we don't have
to handle the case of looking for critical+unknown permitted subtrees,
which otherwise would force us to scan (and match against) the entire
list of permitted trees.
```

[![@randombit](https://avatars.githubusercontent.com/u/469092?s=40&v=4)](/randombit)

`[Optimize DNS substring matching in name constraints](/randombit/botan/pull/4047/commits/affe1dcaa459391aefa1ff13548f4b178438862e "Optimize DNS substring matching in name constraints

With the help of string_view we don't need to create any copies.")`
 …

`[affe1dc](/randombit/botan/pull/4047/commits/affe1dcaa459391aefa1ff13548f4b178438862e)`

```
With the help of string_view we don't need to create any copies.
```

[![@randombit](https://avatars.githubusercontent.com/u/469092?s=40&v=4)](/randombit)

`[Add BOTAN_ASSERT_IS_SOME](/randombit/botan/pull/4047/commits/6431c96e95e194e7185798f66f527c3b3beb3b66 "Add BOTAN_ASSERT_IS_SOME")`

`[6431c96](/randombit/botan/pull/4047/commits/6431c96e95e194e7185798f66f527c3b3beb3b66)`

[![@randombit](https://avatars.githubusercontent.com/u/469092?s=40&v=4)](/randombit)

`[Add AlternativeName::count](/randombit/botan/pull/4047/commits/4e7fe091617a22e7f73588f7a4c8b7c9d33905c0 "Add AlternativeName::count")`

`[4e7fe09](/randombit/botan/pull/4047/commits/4e7fe091617a22e7f73588f7a4c8b7c9d33905c0)`

[![@randombit](https://avatars.githubusercontent.com/u/469092?s=40&v=4)](/randombit)

`[Remove GeneralSubtree minimum and maximum](/randombit/botan/pull/4047/commits/2a8e75ce9ce82a7182664707e68fb4436903fa41 "Remove GeneralSubtree minimum and maximum

RFC 5280 states that minimum must be zero and maximum must be unset,
so keeping the fixed values in memory isn't that helpful.")`
 …

`[2a8e75c](/randombit/botan/pull/4047/commits/2a8e75ce9ce82a7182664707e68fb4436903fa41)`

```
RFC 5280 states that minimum must be zero and maximum must be unset,
so keeping the fixed values in memory isn't that helpful.
```

[![@randombit](https://avatars.githubusercontent.com/u/469092?s=40&v=4)](/randombit)

`[Clean up decoding of name constraints extension](/randombit/botan/pull/4047/commits/75b496d973e929bf9abaa722f4dab261882d9b1e "Clean up decoding of name constraints extension")`

`[75b496d](/randombit/botan/pull/4047/commits/75b496d973e929bf9abaa722f4dab261882d9b1e)`

[![@randombit](https://avatars.githubusercontent.com/u/469092?s=40&v=4)](/randombit)

`[Add named constants for the variant index](/randombit/botan/pull/4047/commits/6700358de060858eb7f3e07201dcf50ce9c720fc "Add named constants for the variant index")`

`[6700358](/randombit/botan/pull/4047/commits/6700358de060858eb7f3e07201dcf50ce9c720fc)`

 Hide details
View details

[![@randombit](https://avatars.githubusercontent.com/u/469092?s=40&v=4)](/randombit)
[randombit](/randombit)
merged commit [`c326482`](/randombit/botan/commit/c3264821b9f6286ee4e6e3e06826f6b7177e6d41)
into
master

[May 14, 2024](https://github.com/randombit/botan/pull/4047#event-12798258661)
43 checks passed

 [![@randombit](https://avatars.githubusercontent.com/u/469092?s=40&v=4)](/randombit)
[randombit](/randombit)
deleted the
jack/opt-name-constraints

branch
[May 14, 2024 08:37](#event-12798259592)

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Frandombit%2Fbotan%2Fpull%2F4047)

Reviewers

[![@FAlbertDev](https://avatars.githubusercontent.com/u/126883116?s=40&v=4)](/FAlbertDev) [FAlbertDev](/FAlbertDev)

FAlbertDev approved these changes

[![@reneme](https://avatars.githubusercontent.com/u/1562139?s=40&v=4)](/reneme) [reneme](/reneme)

 Awaiting requested review from reneme

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

Successfully merging this pull request may close these issues.

3 participants

[![@randombit](https://avatars.githubusercontent.com/u/469092?s=52&v=4)](/randombit) [![@coveralls](https://avatars.githubusercontent.com/u/2354108?s=52&v=4)](/coveralls) [![@FAlbertDev](https://avatars.githubusercontent.com/u/126883116?s=52&v=4)](/FAlbertDev)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


