
[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Frandombit%2Fbotan%2Fsecurity%2Fadvisories%2FGHSA-5gg9-hqpr-r58j)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Frandombit%2Fbotan%2Fsecurity%2Fadvisories%2FGHSA-5gg9-hqpr-r58j)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=randombit%2Fbotan)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[randombit](/randombit)
/
**[botan](/randombit/botan)**
Public

* [Notifications](/login?return_to=%2Frandombit%2Fbotan) You must be signed in to change notification settings
* [Fork
  574](/login?return_to=%2Frandombit%2Fbotan)
* [Star
   2.8k](/login?return_to=%2Frandombit%2Fbotan)

* [Code](/randombit/botan)
* [Issues
  183](/randombit/botan/issues)
* [Pull requests
  29](/randombit/botan/pulls)
* [Discussions](/randombit/botan/discussions)
* [Actions](/randombit/botan/actions)
* [Wiki](/randombit/botan/wiki)
* [Security](/randombit/botan/security)
* [Insights](/randombit/botan/pulse)

Additional navigation options

* [Code](/randombit/botan)
* [Issues](/randombit/botan/issues)
* [Pull requests](/randombit/botan/pulls)
* [Discussions](/randombit/botan/discussions)
* [Actions](/randombit/botan/actions)
* [Wiki](/randombit/botan/wiki)
* [Security](/randombit/botan/security)
* [Insights](/randombit/botan/pulse)

# Denial of Service Due to Excessive Name Constraints

Moderate

[randombit](/randombit)
published
GHSA-5gg9-hqpr-r58j
Jul 8, 2024

## Package

botan

## Affected versions

All before 3.5.0 and 2.19.5

## Patched versions

3.5.0, 2.19.5

## Description

### Impact

Checking name constraints in X.509 certificates is quadratic in the number of names and name constraints. An attacker who presented a certificate chain which contained a very large number of names in the SubjectAlternativeName, signed by a CA certificate which contained a large number of name constraints, could cause a denial of service.

The POC used a certificate containing 32K domain names, signed by a certificate with 32K name constraints. In affected versions, verifying such a certificate could take several minutes.

### Patches

The problem has been addressed in Botan 3.5.0 in the following ways

* During path validation, the entire chain of signatures up to a trust root is checked prior to checking other parameters such as name constraints. This change requires an attacker to get a trusted CA to sign such a certificate chain. [#4045](https://github.com/randombit/botan/pull/4045)
* Optimize name constraint processing. The original implementation of name constraints was less efficient than it could have been. These optimizations reduce the cost of verifying the POC from minutes to about 3 seconds. [#4047](https://github.com/randombit/botan/pull/4047)
* Optimize SubjectAlternativeName parsing. Simply parsing the certificate with 32K names was quite expensive due to an accidentally quadratic algorithm during parsing. [#4034](https://github.com/randombit/botan/pull/4034)
* During name constraint checking, check that the product of names and name constraints is less than 2\*\*20. If this bound is exceeded, the certificate is rejected immediately. [#4186](https://github.com/randombit/botan/pull/4186)

A partial backport has also been applied and is included in Botan 2.19.5:

* [#4045](https://github.com/randombit/botan/pull/4045) was backported to `release-2` in [#4052](https://github.com/randombit/botan/pull/4052)
* The product of names and name constraints is checked. However the optimization patches could not be applied in Botan 2 as they rely on features added in C++17. As a consequence the product is limited to 2\*\*12. [#4187](https://github.com/randombit/botan/pull/4187)

If your application relies on processing or verifying X.509 certificates (this includes almost all uses of TLS) upgrading to Botan 3 is highly recommended.

### Workarounds

Prior to verifying a certificate, check the total quantity of name constraints associated with a certificate. If this seems excessive (say over 128) reject the certificate immediately.

### Credit

This issue was found and reported by Bing Shi.

### References

OpenSSL had a similar vulnerability which was addressed in [openssl/openssl@8545051](https://github.com/openssl/openssl/commit/8545051c3652bce7bb962afcb6879c4a6288bc67) using a similar check on the product of names and name constraints.

### Severity

Moderate

### CVE ID

CVE-2024-34702

### Weaknesses

[CWE-405](/advisories?query=cwe%3A405)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.

