=== Content from fortiguard.fortinet.com_47cc60b5_20250110_230036.html ===


* ![search](https://filestore.fortinet.com/fortiguard/static/images/icons_white/search.svg?v=33241)
  Search

  ![search](https://filestore.fortinet.com/fortiguard/static/images/icons_white/search.svg?v=33241)

  Please select any available option

  Normal

  Exact Match

  CVE

  ID

  PSIRT

  Antispam

  Outbreak Alert

  IP/Domain/URL

[![fortiguard-logo](https://filestore.fortinet.com/fortiguard/static/images/fortiguard-logo-dark-theme.svg?v=33241)](/)

* Research
  ## Research Center

  Explore latest research and threat reports on emerging cyber threats.
  + [Outbreak Alerts](/outbreak-alert)
  + [Security Blog](https://www.fortinet.com/blog/threat-research.html)
  + [Threat Signal](/threat-signal-report)
* Services
  ## Services

  By Outbreak
  By Solution
  By Product

  ### Protect

  Counter measures across the security fabric for protecting assets, data and network.
  + [Anti-Botnet](/services/botnet)
  + [AntiMalware](/services/antivirus)
  + [AntiSpam](/services/antispam)
  + [Application Control](/services/appcontrol)
  + [Intrusion Protection](/services/ips)
  + [Operational Technology Security](/services/operational-technology-security-service)
  + [Sandbox Behavior Engine](/services/sandbox)
  + [Web Application Security](/services/ws)
  + [Web Filtering](/services/wf)
  ### Detect

  Find and correlate important information to identify an outbreak.Find and correlate
  + [Anti-Recon and Anti-Exploit](/services/arae)
  + [Cloud Threat Detection](/services/cloud-vulnerability-and-threat-detection)
  + [Endpoint Detection & Response](/services/fedr)
  + [Indicators of Compromise](/services/ioc)
  + [Outbreak Deception](/services/odcs)
  + [Outbreak Detection](/services/outbreak-detection-service)
  + [SOC Automation](/services/security-automation-service)
  ### Respond

  Develop containment techniques to mitigate impacts of security events.Develop containment
  + [Endpoint Detection and Response](https://www.fortinet.com/products/fortixdr)
  + [Endpoint Forensics](https://www.fortinet.com/products/endpoint-security/forticlient#support-services)
  + [Incident Response](https://www.fortinet.com/solutions/enterprise-midsize-business/security-as-a-service/respond)
  ### Recover

  Improve security posture and processes by implementing security awareness and training.
  + [Assessment Services](https://www.fortinet.com/solutions/enterprise-midsize-business/security-as-a-service/assess)
  + [NSE Training](https://www.fortinet.com/training/cybersecurity-professionals)
  + [Security Awareness Training](https://www.fortinet.com/training/security-awareness-training)

  ### Identify

  Identify processes and assets that need protection.Identify processes and assets that
  + [Breach Attack Simulation](/services/breach-attack-simulation)
  + [Cloud Vulnerability](/services/cloud-vulnerability-and-threat-detection)
  + [Dynamic Application Security Testing](/services/dynamic-application-security-testing)
  + [Endpoint Vulnerability](/services/ev)
  + [FortiDevSec](/services/fortidevsec)
  + [Inline-CASB Application Definitions](/updates/casb)
  + [IoT Detection](/services/dds)
  + [Pen Testing](/services/pentesting)
  + [Recon: ACI](https://www.fortinet.com/products/fortirecon)
  + [Recon: BP](https://www.fortinet.com/products/fortirecon)
  + [Recon: EASM](https://www.fortinet.com/products/fortirecon)
  + [Security Rating](/services/secr)

  + ### Network Security

    ![Network Security icon](https://filestore.fortinet.com/fortiguard/static/images/icons_white/network.svg?v=33241)
  + [Anti-Botnet](/services/botnet)
  + [Anti-Recon and Anti-Exploit](/services/arae)
  + [Cloud Vulnerability and Threat Detection](/services/cloud-vulnerability-and-threat-detection)
  + [Data Loss Prevention](/services/dlp)
  + [Indicators of Compromise](/services/ioc)
  + [Inline-CASB Application Definitions](/updates/casb)
  + [Internet Services](/services/isdb)
  + [Intrusion Protection](/services/ips)
  + [IP Geolocation](/services/ipge)
  + [Secure DNS](/services/sdns)
  + ### Endpoint Security

    ![Endpoint Security icon](https://filestore.fortinet.com/fortiguard/static/images/icons_white/contentendpoint.svg?v=33241)
  + [ANN and NDR](/services/fortindr)
  + [AntiVirus](/services/antivirus)
  + [Endpoint Detection & Response](/services/fedr)
  + [Endpoint Vulnerability](/services/ev)
  + [IoT Detection](/services/dds)
  + [Sandbox Behavior Engine](/services/sandbox)
  + ### Application Security

    ![Application Security icon](https://filestore.fortinet.com/fortiguard/static/images/icons_white/application.svg?v=33241)
  + [AntiSpam](/services/antispam)
  + [Application Control](/services/appcontrol)
  + [Client Application Firewall](/services/fct-app)
  + [Credential Stuffing Defense](/services/csd)
  + [Dynamic Application Security Testing](/services/dynamic-application-security-testing)
  + [Operational Technology Security](/services/operational-technology-security-service)
  + [Web Application Security](/services/ws)
  + [Web Filtering](/services/wf)
  + ### Security Operations

    ![Security Operations icon](https://filestore.fortinet.com/fortiguard/static/images/icons_white/response.svg?v=33241)
  + [Breach Attack Simulation](/services/breach-attack-simulation)
  + [FortiDevSec](/services/fortidevsec)
  + [Outbreak Deception](/services/odcs)
  + [Outbreak Detection](/services/outbreak-detection-service)
  + [Pen Testing](/services/pentesting)
  + [Security Rating](/services/secr)

  + ![](https://filestore.fortinet.com/fortiguard/static/images/icons_white/fortigate.svg?v=33241)
  + ![](https://filestore.fortinet.com/fortiguard/static/images/icons_white/fortianalyzer.svg?v=33241)
  + ![](https://filestore.fortinet.com/fortiguard/static/images/icons_white/forticlient.svg?v=33241)
  + ![](https://filestore.fortinet.com/fortiguard/static/images/icons_white/fortiweb.svg?v=33241)
  + ![](https://filestore.fortinet.com/fortiguard/static/images/icons_white/fadc.svg?v=33241)

    FortiADC

    ![](https://filestore.fortinet.com/fortiguard/static/images/arrow-white.svg?v=33241)
  + ![](https://filestore.fortinet.com/fortiguard/static/images/icons_white/fortiauthenticator.svg?v=33241)

    FortiAuthenticator

    ![](https://filestore.fortinet.com/fortiguard/static/images/arrow-white.svg?v=33241)
  + ![](https://filestore.fortinet.com/fortiguard/static/images/icons_white/cnp.svg?v=33241)

    FortiCNP

    ![](https://filestore.fortinet.com/fortiguard/static/images/arrow-white.svg?v=33241)
  + ![](https://filestore.fortinet.com/fortiguard/static/images/icons_white/fortiddos.svg?v=33241)

    FortiDDoS

    ![](https://filestore.fortinet.com/fortiguard/static/images/arrow-white.svg?v=33241)
  + ![](https://filestore.fortinet.com/fortiguard/static/images/icons_white/fortideceptor.svg?v=33241)

    FortiDeceptor

    ![](https://filestore.fortinet.com/fortiguard/static/images/arrow-white.svg?v=33241)
  + ![](https://filestore.fortinet.com/fortiguard/static/images/icons_white/fedr.svg?v=33241)

    FortiEDR

    ![](https://filestore.fortinet.com/fortiguard/static/images/arrow-white.svg?v=33241)
  + ![](https://filestore.fortinet.com/fortiguard/static/images/icons_white/fortimail.svg?v=33241)

    FortiMail

    ![](https://filestore.fortinet.com/fortiguard/static/images/arrow-white.svg?v=33241)
  + empty
  + ![](https://filestore.fortinet.com/fortiguard/static/images/icons_white/fortindr.svg?v=33241)

    FortiNDR

    ![](https://filestore.fortinet.com/fortiguard/static/images/arrow-white.svg?v=33241)
  + ![](https://filestore.fortinet.com/fortiguard/static/images/icons_white/fortipam.svg?v=33241)

    FortiPAM

    ![](https://filestore.fortinet.com/fortiguard/static/images/arrow-white.svg?v=33241)
  + ![](https://filestore.fortinet.com/fortiguard/static/images/icons_white/fortipolicy.svg?v=33241)

    FortiPolicy

    ![](https://filestore.fortinet.com/fortiguard/static/images/arrow-white.svg?v=33241)
  + ![](https://filestore.fortinet.com/fortiguard/static/images/icons_white/fortiproxy.svg?v=33241)

    FortiProxy

    ![](https://filestore.fortinet.com/fortiguard/static/images/arrow-white.svg?v=33241)
  + ![](https://filestore.fortinet.com/fortiguard/static/images/icons_white/fortirecon.svg?v=33241)

    FortiRecon

    ![](https://filestore.fortinet.com/fortiguard/static/images/arrow-white.svg?v=33241)
  + ![](https://filestore.fortinet.com/fortiguard/static/images/icons_white/fortisandbox.svg?v=33241)

    FortiSandBox

    ![](https://filestore.fortinet.com/fortiguard/static/images/arrow-white.svg?v=33241)
  + ![](https://filestore.fortinet.com/fortiguard/static/images/icons_white/fortisase.svg?v=33241)

    FortiSASE

    ![](https://filestore.fortinet.com/fortiguard/static/images/arrow-white.svg?v=33241)
  + ![](https://filestore.fortinet.com/fortiguard/static/images/icons_white/fortisiem.svg?v=33241)

    FortiSIEM

    ![](https://filestore.fortinet.com/fortiguard/static/images/arrow-white.svg?v=33241)
  + ![](https://filestore.fortinet.com/fortiguard/static/images/icons_white/fortitester.svg?v=33241)

    FortiTester

    ![](https://filestore.fortinet.com/fortiguard/static/images/arrow-white.svg?v=33241)
  + ![](https://filestore.fortinet.com/fortiguard/static/images/icons_white/fortidast.svg?v=33241)

    FortiDAST

    ![](https://filestore.fortinet.com/fortiguard/static/images/arrow-white.svg?v=33241)
  + ![](https://filestore.fortinet.com/fortiguard/static/images/icons_white/cnpvuln.svg?v=33241)

    FortiCNAPP

    ![](https://filestore.fortinet.com/fortiguard/static/images/arrow-white.svg?v=33241)
  + empty
  + [Anti-Botnet](/services/botnet)
  + [AntiVirus](/services/antivirus)
  + [Application Control](/services/appcontrol)
  + [Inline-CASB Application Definitions](/updates/casb)
  + [Intrusion Protection](/services/ips)
  + [IoT Detection](/services/dds)
  + [IP Geolocation](/services/ipge)
  + [Operational Technology Security](/services/operational-technology-security-service)
  + [Sandbox Behavior Engine](/services/sandbox)
  + [Secure DNS](/services/sdns)
  + [Security Rating](/services/secr)
  + [Web Filtering](/services/wf)
  + [Indicators of Compromise](/services/ioc)
  + [Outbreak Detection](/services/outbreak-detection-service)
  + [SOC Automation](/services/security-automation-service)
  + [Anti-Botnet](/services/botnet)
  + [Anti-Recon and Anti-Exploit](/services/arae)
  + [AntiVirus](/services/antivirus)
  + [Application Firewall](/services/fct-app)
  + [Credential Stuffing Defense](/services/csd)
  + [Endpoint Vulnerability](/services/ev)
  + [Intrusion Protection](/services/ips)
  + [Outbreak Detection](/services/eoap)
  + [Sandbox Behavior Engine](/services/sandbox)
  + [Web Filtering](/services/wf)
  + [Anti-Botnet](/services/botnet)
  + [AntiVirus](/services/antivirus)
  + [Application Control](/services/appcontrol)
  + [Credential Stuffing Defense](/services/csd)
  + [Fuzzy Webshell](/updates/webshell)
  + [IP Geolocation](/services/ipge)
  + [Sandbox Behavior Engine](/services/sandbox)
  + [Web Application Security](/services/ws)
  + [Anti-Botnet](/services/botnet)
  + [AntiVirus](/services/antivirus)
  + [Credential Stuffing Defense](/services/csd)
  + [Intrusion Protection](/services/ips)
  + [IP Geolocation](/services/ipge)
  + [Sandbox Behavior Engine](/services/sandbox)
  + [Web Application Security](/services/ws)
  + [Web Filtering](/services/wf)
  + [IP Geolocation](/services/ipge)
  + [Anti-Botnet](/services/botnet)
  + [Data Loss Prevention](/services/dlp)
  + [IP Geolocation](/services/ipge)
  + [Vulnerability](/services/cloud-vulnerability-and-threat-detection)
  + [Anti-Botnet](/services/botnet)
  + [Anti-Recon and Anti-Exploit](/services/arae)
  + [AntiVirus](/services/antivirus)
  + [Intrusion Protection](/services/ips)
  + [Outbreak Deception](/services/odcs)
  + [AntiVirus](/services/antivirus)
  + [EndPoint Detection and Response](/services/fedr)
  + [Endpoint Vulnerability](/services/ev)
  + [Indicators of Compromise](/services/ioc)
  + [Sandbox Behavior Engine](/services/sandbox)
  + [Web Filtering](/services/wf)
  + [AntiSpam](/services/antispam)
  + [AntiVirus](/services/antivirus)
  + [Sandbox Behavior Engine](/services/sandbox)
  + [Web Filtering](/services/wf)
  + [Network Detection and Response](/services/fortindr)
  + [Sandbox Behavior Engine](/services/sandbox)
  + [AntiVirus](/services/antivirus)
  + [Data Loss Prevention](/services/dlp)
  + [Anti-Botnet](/services/botnet)
  + [Application Control](/services/appcontrol)
  + [Anti-Botnet](/services/botnet)
  + [Application Control](/services/appcontrol)
  + [Industrial Security](/services/operational-technology-security-service)
  + [Sandbox Behavior Engine](/services/sandbox)
  + [Digital Risk Protection](https://www.fortinet.com/products/fortirecon)
  + [AntiVirus](/services/antivirus)
  + [Intrusion Protection](/services/ips)
  + [Sandbox Behavior Engine](/services/sandbox)
  + [Web Filtering](/services/wf)
  + [Anti-Botnet](/services/botnet)
  + [AntiVirus](/services/antivirus)
  + [Application Control](/services/appcontrol)
  + [Data Loss Prevention](/services/dlp)
  + [Endpoint Vulnerability](/services/ev)
  + [Intrusion Protection](/services/ips)
  + [Sandbox Behavior Engine](/services/sandbox)
  + [Secure DNS](/services/sdns)
  + [Web Filtering](/services/wf)
  + [Indicators of Compromise](/services/ioc)
  + [IP Geolocation](/services/ipge)
  + [Outbreak Detection](/services/fortisiem)
  + [Sandbox Behavior Engine](/services/sandbox)
  + [Breach Attack Simulation](/services/breach-attack-simulation)
  + [Dynamic Application Security Testing](/services/dynamic-application-security-testing)
  + [Cloud Threat Detection](/services/cloud-vulnerability-and-threat-detection)
  + [Cloud Vulnerability](/services/cloud-vulnerability-and-threat-detection)
* Threat Intelligence
  ## Threat Intelligence Center

  Browse the FortiGuard Labs extensive encyclopedia and Threat Analytics.

  + [Application Control](/appcontrol)
  + [FortiGuard Encyclopedia](/encyclopedia)
  + [Outbreak Threat Map](/threat-map)
  + [Threat Actor Encyclopedia](/threat-actor)
  + [Threat Analytics](/threat-research)
  + [Web Filtering](/webfilter)
* Support
  ## Support Center

  PSIRT
  Center

  Product
  Support

  Fortinet Product Security Incident Response Team (PSIRT) updates.

  + [Advisories](/psirt)
  + [PSIRT Blog](https://www.fortinet.com/blog/psirt-blogs)
  + [PSIRT Contact](/faq/psirt-contact)
  + [Security Vulnerability Policy](/psirt_policy)
  Get the support whenever you need it.

  + [FortiCare Support](https://www.fortinet.com/support/contact)
  + [Fortinet Community](https://community.fortinet.com/)
* Resources
  ## Resource Center

  Learn about service status, publications and other available resources.

  + [FortiGuard Sample Files](/sample-files)
  + [MITRE ATT&CK Matrix](/mitre-mapping)
  + [NIST Cybersecurity Framework](/nist-csf)
  + [Publications](/events)
  + [Security Best Practices](/security-best-practices)
* About
  ## About

  FortiGuard Labs
  Partners

  AI-Powered Threat Intelligence for an Evolving Digital World.
  + [Contact Us](/contactus)
  + [Frequently Asked Questions](/faq)
  + [Premium Services](/premium-services)
  + [RSS Feeds](/rss-feeds)
  Leveraging cyber security industry partner relationships.
  + [Cyber Threat Alliance](/cta)
  + [MITRE Engenuity](https://www.fortinet.com/corporate/about-us/product-certifications/mitre-att-ck)

[![fortiguard-logo](https://filestore.fortinet.com/fortiguard/static/images/fortiguard-logo-dark-theme.svg?v=33241)](/)
![search](https://filestore.fortinet.com/fortiguard/static/images/icons_white/search.svg?v=33241)

* Research
  + [Outbreak Alerts](/outbreak-alert)
  + [Security Blog](https://www.fortinet.com/blog/threat-research.html)
  + [Threat Signal](/threat-signal-report)
* Services
  + [Anti-Botnet](/services/botnet)
  + [Anti-Recon and Anti-Exploit](/services/arae)
  + [AntiMalware](/services/antivirus)
  + [AntiSpam](/services/antispam)
  + [Application Control](/services/appcontrol)
  + [Assessment Services](https://www.fortinet.com/solutions/enterprise-midsize-business/security-as-a-service/assess)
  + [Breach Attack Simulation](/services/breach-attack-simulation)
  + [Cloud Threat Detection](/services/cloud-vulnerability-and-threat-detection)
  + [Cloud Vulnerability](/services/cloud-vulnerability-and-threat-detection)
  + [Dynamic Application Security Testing](/services/dynamic-application-security-testing)
  + [Endpoint Detection & Response](/services/fedr)
  + [Endpoint Detection and Response](https://www.fortinet.com/products/fortixdr)
  + [Endpoint Forensics](https://www.fortinet.com/products/endpoint-security/forticlient#support-services)
  + [Endpoint Vulnerability](/services/ev)
  + [FortiDevSec](/services/fortidevsec)
  + [Incident Response](https://www.fortinet.com/solutions/enterprise-midsize-business/security-as-a-service/respond)
  + [Indicators of Compromise](/services/ioc)
  + [Inline-CASB Application Definitions](/updates/casb)
  + [Intrusion Protection](/services/ips)
  + [IoT Detection](/services/dds)
  + [NSE Training](https://www.fortinet.com/training/cybersecurity-professionals)
  + [Operational Technology Security](/services/operational-technology-security-service)
  + [Outbreak Deception](/services/odcs)
  + [Outbreak Detection](/services/outbreak-detection-service)
  + [Pen Testing](/services/pentesting)
  + [Recon: ACI](https://www.fortinet.com/products/fortirecon)
  + [Recon: BP](https://www.fortinet.com/products/fortirecon)
  + [Recon: EASM](https://www.fortinet.com/products/fortirecon)
  + [Sandbox Behavior Engine](/services/sandbox)
  + [Security Awareness Training](https://www.fortinet.com/training/security-awareness-training)
  + [Security Rating](/services/secr)
  + [SOC Automation](/services/security-automation-service)
  + [Web Application Security](/services/ws)
  + [Web Filtering](/services/wf)
* Threat Intelligence
  + [Application Control](/appcontrol)
  + [FortiGuard Encyclopedia](/encyclopedia)
  + [Outbreak Threat Map](/threat-map)
  + [Threat Actor Encyclopedia](/threat-actor)
  + [Threat Analytics](/threat-research)
  + [Web Filtering](/webfilter)
* Resources
  + [FortiGuard Sample Files](/sample-files)
  + [MITRE ATT&CK Matrix](/mitre-mapping)
  + [NIST Cybersecurity Framework](/nist-csf)
  + [Publications](/events)
  + [Security Best Practices](/security-best-practices)
* Support
  ### PSIRT Center

  + [Advisories](/psirt)
  + [PSIRT Blog](https://www.fortinet.com/blog/psirt-blogs)
  + [PSIRT Contact](/faq/psirt-contact)
  + [Security Vulnerability Policy](/psirt_policy)
  ### Product Support

  + [FortiCare Support](https://www.fortinet.com/support/contact)
  + [Fortinet Community](https://community.fortinet.com/)
* About
  ### FortiGuard Labs

  + [Contact Us](/contactus)
  + [Frequently Asked Questions](/faq)
  + [Premium Services](/premium-services)
  + [RSS Feeds](/rss-feeds)
  ### Partners

  + [Cyber Threat Alliance](/cta)
  + [MITRE Engenuity](https://www.fortinet.com/corporate/about-us/product-certifications/mitre-att-ck)
* [FORTINET](https://fortinet.com)

Normal

Exact Match

CVE

ID

PSIRT

Antispam

Outbreak Alert

IP/Domain/URL

![search](https://filestore.fortinet.com/fortiguard/static/images/icons_white/search.svg?v=33241)

[## virus logo](/psirt)
# Missing authentication in fgfmsd

### Summary

A missing authentication for critical function vulnerability [CWE-306] in FortiManager fgfmd daemon may allow a remote unauthenticated attacker to execute arbitrary code or commands via specially crafted requests.

| Version | Affected | Solution |
| --- | --- | --- |
| FortiManager 7.6 | 7.6.0 | Upgrade to 7.6.1 or above |
| FortiManager 7.4 | 7.4.0 through 7.4.4 | Upgrade to 7.4.5 or above |
| FortiManager 7.2 | 7.2.0 through 7.2.7 | Upgrade to 7.2.8 or above |
| FortiManager 7.0 | 7.0.0 through 7.0.12 | Upgrade to 7.0.13 or above |
| FortiManager 6.4 | 6.4.0 through 6.4.14 | Upgrade to 6.4.15 or above |
| FortiManager 6.2 | 6.2.0 through 6.2.12 | Upgrade to 6.2.13 or above |
| FortiManager Cloud 7.6 | Not affected | Not Applicable |
| FortiManager Cloud 7.4 | 7.4.1 through 7.4.4 | Upgrade to 7.4.5 or above |
| FortiManager Cloud 7.2 | 7.2.1 through 7.2.7 | Upgrade to 7.2.8 or above |
| FortiManager Cloud 7.0 | 7.0.1 through 7.0.12 | Upgrade to 7.0.13 or above |
| FortiManager Cloud 6.4 | 6.4 all versions | Migrate to a fixed release |

Old FortiAnalyzer models 1000E, 1000F, 2000E, 3000E, 3000F, 3000G, 3500E, 3500F, 3500G, 3700F, 3700G, 3900E with the following feature enabled (FortiManager on FortiAnalyzer):

config system global
 set fmg-status enable
end

and at least one interface with fgfm service enabled are also impacted by this vulnerability.

## Workarounds

Upgrade to a fixed version or use one of the following workarounds, depending on the version you're running:

1- For FortiManager versions 7.0.12 or above, 7.2.5 or above, 7.4.3 or above (but not 7.6.0), prevent unknown devices to attempt to register:

config system global
(global)# set fgfm-deny-unknown enable
(global)# end

Note: This is the only workaround recommended for use in FortiManager Cloud.

Warning: With this setting enabled, be aware that if a FortiGate's SN is not in the device list, FortiManager will prevent it from connecting to register upon being deployed, even when a model device with PSK is matching.

If FAZ features are enabled on FMG, block the addition of unauthorized devices via syslog:

conf system global
set detect-unregistered-log-device disable
end

If FortiGate Updates or Web Filtering are enabled, block the addition of unauthorized devices via FDS:

conf fmupdate fds-setting
set unreg-dev-option ignore
end

2- Alternatively, for FortiManager versions 7.2.0 and above, you may add local-in policies to whitelist the IP addresses of FortiGates that are allowed to connect.

Example:

config system local-in-policy
 edit 1
 set action accept
 set dport 541
 set src
 next
 edit 2
 set dport 541
 next
end

3- For 7.2.2 and above, 7.4.0 and above, 7.6.0 and above it is also possible to use a custom certificate which will mitigate the issue:

config system global
 set fgfm-ca-cert
 set fgfm-cert-exclusive enable

end

And install that certificate on FortiGates. Only this CA will be valid, this can act as a workaround, providing the attacker cannot obtain a certificate signed by this CA via an alternate channel.

NB: For FortiManager versions 6.2, 6.4, and 7.0.11 and below, please upgrade to one of the versions above and apply the above workarounds.

## Indicators of Compromise

The following are possible IoCs:

### Log entries

type=event,subtype=dvm,pri=information,desc="Device,manager,generic,information,log",user="device,...",msg="Unregistered device localhost add succeeded" device="localhost" adom="FortiManager" session\_id=0 operation="Add device" performed\_on="localhost" changes="Unregistered device localhost add succeeded"

type=event,subtype=dvm,pri=notice,desc="Device,Manager,dvm,log,at,notice,level",user="System",userfrom="",msg="" adom="root" session\_id=0 operation="Modify device" performed\_on="localhost" changes="Edited device settings (SN FMG-VMTM23017412)"

**Important note: The two entries above may keep being logged even on an up-to-date, patched system** (eg: FMG 7.4.5) - in which case they are not Indicators of Compromise anymore, but rather indicators of a (failed) attempt to compromise the system. Indeed, the fix is not meant to prevent adding unauthorized devices (which these log entries are indicative of, and which can legitimately happen in a deployment context), it is meant to prevent unauthorized devices to send exploit commands.

### IP addresses

45.32.41.202
104.238.141.143
158.247.199.37
45.32.63.2
80.66.196.199
198.199.122.22
142.93.177.233
195.85.114.78 (Not observed by Fortinet, reported by Mandiant [here](https://cloud.google.com/blog/topics/threat-intelligence/fortimanager-zero-day-exploitation-cve-2024-47575))
172.232.167.68 (Not observed by Fortinet, reported by trusted third party)

### Serial Number

FMG-VMTM23017412
FMG-VMTM19008093
FGVMEVWG8YMT3R63

### Files

/tmp/.tm
/var/tmp/.tm

Note that file IoCs may not appear in all cases.

## Risk

The identified actions of this attack in the wild have been to automate via a script the exfiltration of various files from the FortiManager which contained the IPs, credentials and configurations of the managed devices.

At this stage, we have not received reports of any low-level system installations of malware or backdoors on these compromised FortiManager systems. To the best of our knowledge, there have been no indicators of modified databases, or connections and modifications to the managed devices.

## Recovery

A FortiManager configuration backup file would not contain any OS or system-level file
changes, as these files are not included in the archive. Therefore, taking a backup from a
compromised system and then restoring it on a fresh or re-initialized one, would not carry
over and re-introduce such low-level changes. When taking this approach, be aware that the
data may have been tampered with. Careful review should be done to confirm configuration
accuracy.

The methods below assume that the managed devices (FortiGates or other) contained in the
backup have not been tampered with and that their configurations are reliable. Event log
activity verification of the FortiGates should be reviewed starting from the date of the
identified IoCs, to determine if there were any unauthorized access or configuration changes.
Since data may have been exfiltrated from the FortiManager database, we recommend that
the credentials, such as passwords and user-sensitive data, of all managed devices, be
urgently changed.
For a more detailed list, see [Best Practices for Maintaining Secure Credentials](https://community.fortinet.com/t5/FortiGate/Technical-Tip-Best-Practices-for-Maintaining-Secure-Credentials/ta-p/352677)

For VM installations, recovery can be facilitated by keeping a copy of the compromised
FortiManager in an isolated network with no Internet connection, as well as configuring it in
offline mode and closed-network mode operation (see settings below). This system can be
used to compare with the new one which will be set up in parallel.

config system admin setting
 set offline\_mode enable
end
config fmupdate publicnetwork
 set status disable
end

### Recovery Methods

#### Option 1 – Recommended Recovery Action

This method ensures that the FortiManager configuration was not tampered with. It will
require database rebuilding or device configuration resynchronizations at the Device and
Policy Package ADOM levels.

• Installing a fresh FortiManager VM or re-initializing a hardware model and
adding/discovering the devices.
• Installing a fresh FortiManager VM or re-initializing a hardware model, and restoring a
backup taken before the IoC detection.

#### Option 2 – Alternative Recovery Action

This method provides a quick recovery, where partial or no database
rebuilding/resynchronization is required. It requires that you manually verify accuracy of the
currently running FortiManager configuration

• Installing a fresh FortiManager VM or re-initializing a hardware model and
restoring/copying components or configuration sections from a compromised
FortiManager.
• Installing a fresh FortiManager VM or re-initializing a hardware model, and restoring a
backup from a compromised FortiManager.

For more info on data configuration and synchronization procedures: https://community.fortinet.com/t5/FortiManager/Technical-Tip-FortiManager-data-configuration-and/ta-p/351748

#### Managed Devices

Although we have not seen, or been made aware of devices managed by a compromised FortiManager that have been compromised, it should be assumed that this could occur. Therefore, we recommend that the credentials, such as passwords and user-sensitive data, of all managed devices be urgently changed, including those of the Managed FortiGates and FortiManager. This includes:
• Admin Users Accounts
• Certificate’s private key and password (In case of ssl offloading/deep inspection/ipsec auth)
• VPN Pre-Shared Keys
• Local user accounts
• TACACS Key
• LDAP / Active Directory Passwords
• RADIUS Secret Keys
• SNMP Secrets
• OSPF/BGP Neighbour Passwords
• Wireless SSID / Mesh Keys
• Passwords stored inside automation stitches
• PPPoE Passwords
• SMTP Passwords
• HA Pre-shared Keys Cluster Password

### Timeline

2024-10-23: Initial publication
2024-10-23: Add FortiManager Cloud fixes
2024-10-24: Added workarounds to block the addition of unauthorized devices via syslog or FDS
2024-10-24: Added 195.85.114.78 in IoCs
2024-10-25: Added note about log entries IoCs
2024-10-28: Added link to "Best Practices for Maintaining Secure Credentials"
2024-10-28: Added note in workaround 1. (FMG Cloud recommended workaround)
2024-10-30: Added IoCs (4 IP addresses and 1 SN)
2024-11-04: Removed duplicate IP addresses
2024-11-05: Added 198.199.122.22 in IoCs
2024-11-07: Added recommendation for managed devices
2024-11-15: Updated the Serial Number IOCs section
2024-11-27: Added 142.93.177.233 in IoCs

| IR Number | FG-IR-24-423 |
| --- | --- |
| Published Date | Oct 23, 2024 |
| Updated Date | Nov 27, 2024 |
| Component | OTHERS |
| Severity | Critical |
| CVSSv3 Score | [9.8](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:H/RL:U/RC:C&version=3.1) |
| Impact | Execute unauthorized code or commands |
| CVE ID | [CVE-2024-47575](https://www.cve.org/CVERecord?id=CVE-2024-47575) |
| CVRF | [Download](/psirt/cvrf/FG-IR-24-423) |

[![fortinet logo in the footer](https://filestore.fortinet.com/fortiguard/static/images/fortinet-footer-logo.svg?v=33241)](https://www.fortinet.com)

* [Contact Us](/contactus)
* [Legal](https://www.fortinet.com/corporate/about-us/legal.html)
* [Privacy](https://www.fortinet.com/corporate/about-us/privacy.html)
* [Partners](/partners)
* [Feedback](/faq/general-contact)

* [![facebook-icon-footer](https://filestore.fortinet.com/fortiguard/static/images/facebook_icon_footer.svg?v=33241)](https://www.facebook.com/FortiGuard.Labs)
* [![twitter-icon-footer](https://filestore.fortinet.com/fortiguard/static/images/x_icon_footer.svg?v=33241)](https://x.com/FortiGuardLabs)
* [![linkedin-icon-footer](https://filestore.fortinet.com/fortiguard/static/images/linkedin_icon_footer.svg?v=33241)](https://www.linkedin.com/showcase/3668640/)
* [![linkedin-icon-footer](https://filestore.fortinet.com/fortiguard/static/images/instagram_icon_footer.svg?v=33241)](https://www.instagram.com/fortinet/)
* [![rss-icon-footer](https://filestore.fortinet.com/fortiguard/static/images/rss_icon_footer.svg?v=33241)](/rss-feeds)

Copyright © 2025 Fortinet, Inc. All Rights Reserved.


