=== Content from github.com_bfbe3501_20250111_180629.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FInternationalColorConsortium%2FDemoIccMAX%2Fpull%2F66)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FInternationalColorConsortium%2FDemoIccMAX%2Fpull%2F66)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=InternationalColorConsortium%2FDemoIccMAX)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[InternationalColorConsortium](/InternationalColorConsortium)
/
**[DemoIccMAX](/InternationalColorConsortium/DemoIccMAX)**
Public

* [Notifications](/login?return_to=%2FInternationalColorConsortium%2FDemoIccMAX) You must be signed in to change notification settings
* [Fork
  37](/login?return_to=%2FInternationalColorConsortium%2FDemoIccMAX)
* [Star
   120](/login?return_to=%2FInternationalColorConsortium%2FDemoIccMAX)

* [Code](/InternationalColorConsortium/DemoIccMAX)
* [Issues
  7](/InternationalColorConsortium/DemoIccMAX/issues)
* [Pull requests
  0](/InternationalColorConsortium/DemoIccMAX/pulls)
* [Discussions](/InternationalColorConsortium/DemoIccMAX/discussions)
* [Actions](/InternationalColorConsortium/DemoIccMAX/actions)
* [Projects
  0](/InternationalColorConsortium/DemoIccMAX/projects)
* [Security](/InternationalColorConsortium/DemoIccMAX/security)
* [Insights](/InternationalColorConsortium/DemoIccMAX/pulse)

Additional navigation options

* [Code](/InternationalColorConsortium/DemoIccMAX)
* [Issues](/InternationalColorConsortium/DemoIccMAX/issues)
* [Pull requests](/InternationalColorConsortium/DemoIccMAX/pulls)
* [Discussions](/InternationalColorConsortium/DemoIccMAX/discussions)
* [Actions](/InternationalColorConsortium/DemoIccMAX/actions)
* [Projects](/InternationalColorConsortium/DemoIccMAX/projects)
* [Security](/InternationalColorConsortium/DemoIccMAX/security)
* [Insights](/InternationalColorConsortium/DemoIccMAX/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2FInternationalColorConsortium%2FDemoIccMAX%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2FInternationalColorConsortium%2FDemoIccMAX%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Update: Fix the Compile Error in IccUtil.cpp, Fix a return value in IccTagXml.cpp #66

 Merged

[maxderhak](/maxderhak)
merged 2 commits into
[InternationalColorConsortium:master](/InternationalColorConsortium/DemoIccMAX/tree/master "InternationalColorConsortium/DemoIccMAX:master")
from
xsscx:master

May 20, 2024

 Merged

# [Update: Fix the Compile Error in IccUtil.cpp, Fix a return value in IccTagXml.cpp](#top) #66

[maxderhak](/maxderhak)
merged 2 commits into
[InternationalColorConsortium:master](/InternationalColorConsortium/DemoIccMAX/tree/master "InternationalColorConsortium/DemoIccMAX:master")
from
xsscx:master

May 20, 2024

[Conversation
0](/InternationalColorConsortium/DemoIccMAX/pull/66)
[Commits
2](/InternationalColorConsortium/DemoIccMAX/pull/66/commits)
[Checks
0](/InternationalColorConsortium/DemoIccMAX/pull/66/checks)
[Files changed](/InternationalColorConsortium/DemoIccMAX/pull/66/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![xsscx](https://avatars.githubusercontent.com/u/10790582?s=60&v=4)](/xsscx)

Copy link

Collaborator

### @xsscx **[xsscx](/xsscx)** commented [May 14, 2024](#issue-2294186480) • edited Loading

Change the unconditional return statement at the end of the CIccTagXmlProfileSequenceId::ParseXml function from `false` to `true`, Fixed the Compile Error in IccUtil.cpp due to integer value 4294967295 is outside the valid range of values [0, 3] for this enumeration type.

This is the only code change proposed for this PR.

# [CVE-2024-38427](https://nvd.nist.gov/vuln/detail/CVE-2024-38427) | Incorrect Function Return Value in [`CIccTagXmlProfileSequenceId::ParseXml`](https://github.com/InternationalColorConsortium/DemoIccMAX/blob/c0ab97ddd1a0f792c8afb7a061135bc7c87f5854/IccXML/IccLibXML/IccTagXml.cpp#L4164)

## TL;DR

A logic flaw existed in the [`CIccTagXmlProfileSequenceId::ParseXml`](https://github.com/InternationalColorConsortium/DemoIccMAX/blob/c0ab97ddd1a0f792c8afb7a061135bc7c87f5854/IccXML/IccLibXML/IccTagXml.cpp#L4164) function of the DemoIccMAX Project where the function unconditionally returned [`false`](https://github.com/InternationalColorConsortium/DemoIccMAX/blame/d4770471b38d24961e09740dda166e2f342ed787/IccXML/IccLibXML/IccTagXml.cpp#L4202) has been assigned [CVE-2024-38427](https://github.com/advisories/GHSA-qqfm-9jcc-9q44 "CVE-2024-38427").

**[CVE-2024-38427](https://github.com/advisories/GHSA-qqfm-9jcc-9q44 "CVE-2024-38427")** [`CIccTagXmlProfileSequenceId::ParseXml`](https://github.com/InternationalColorConsortium/DemoIccMAX/pull/66)

**CVSS 3.1 Base Score**: `8.8 AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H`

## DemoIccMAX Project Overview

The DemoIccMAX project (formally known as RefIccMAX) provides an open-source set of libraries and tools for the interaction, manipulation, and application of iccMAX-based color management profiles based on the iccMAX profile specification, as well as legacy ICC profiles defined by earlier ICC profile specifications.

## Bug Details

* Patch Date: May 20, 2024
* Reporter: [David Hoyt](https://hoyt.net)
* Method: Manual Source Code Review
* Patch via Pull Request: [66](https://github.com/InternationalColorConsortium/DemoIccMAX/pull/66)

## Bug Type

CWE-253: Incorrect Check of Function Return Value

A logic flaw in the [`CIccTagXmlProfileSequenceId::ParseXml`](https://github.com/InternationalColorConsortium/DemoIccMAX/blob/c0ab97ddd1a0f792c8afb7a061135bc7c87f5854/IccXML/IccLibXML/IccTagXml.cpp#L4164) function of the DemoIccMAX project resulted in the unconditional return value of [`false`](https://github.com/InternationalColorConsortium/DemoIccMAX/blame/d4770471b38d24961e09740dda166e2f342ed787/IccXML/IccLibXML/IccTagXml.cpp#L4202). This flaw allowed user-controllable inputs in the XML to be processed potentially leading to arbitrary code execution in the context of the user account credential. The code for [`CIccTagXmlProfileSequenceId::ParseXml`](https://github.com/InternationalColorConsortium/DemoIccMAX/blob/c0ab97ddd1a0f792c8afb7a061135bc7c87f5854/IccXML/IccLibXML/IccTagXml.cpp#L4164) was committed in 2015 with approximately 100K lines of code (LoC) and widely reused.

## Prior Art

Over the past 3 years there have been many similar reports of color profile processing resulting in overflow conditions and memory corruption.

* [Project Zero Issue 2225](https://bugs.chromium.org/p/project-zero/issues/detail?id=2225)
* [Project Zero Issue 2226](https://bugs.chromium.org/p/project-zero/issues/detail?id=2226)
* [CVE-2022-26730](https://srd.cx/cve-2022-26730/)
* [CVE-2023-32443](https://srd.cx/cve-2023-32443/)

### PoC

[![PoC for CVE-2022](https://camo.githubusercontent.com/df022cbe1e2feceb340b811aa8d32f80b1bd511c1e6a45e4e2c597ed2442ff0d/68747470733a2f2f7372642e63782f77702d636f6e74656e742f75706c6f6164732f323032322f31312f6376652d323032322d32363730322d756e73616e6974697a65642d757365722d636f6e74726f6c6c61626c652d696e7075742d736f757263652d666c6f772d73696e6b2d657865637574652d706f632d73616d706c652e706e67)](https://camo.githubusercontent.com/df022cbe1e2feceb340b811aa8d32f80b1bd511c1e6a45e4e2c597ed2442ff0d/68747470733a2f2f7372642e63782f77702d636f6e74656e742f75706c6f6164732f323032322f31312f6376652d323032322d32363730322d756e73616e6974697a65642d757365722d636f6e74726f6c6c61626c652d696e7075742d736f757263652d666c6f772d73696e6b2d657865637574652d706f632d73616d706c652e706e67)

### Call Graph for [`CIccTagXmlProfileSequenceId::ParseXml`](https://github.com/InternationalColorConsortium/DemoIccMAX/blob/c0ab97ddd1a0f792c8afb7a061135bc7c87f5854/IccXML/IccLibXML/IccTagXml.cpp#L4164)

When the return value is set to [`false`](https://github.com/InternationalColorConsortium/DemoIccMAX/blame/d4770471b38d24961e09740dda166e2f342ed787/IccXML/IccLibXML/IccTagXml.cpp#L4202) unconditionally, the [`ParseXml`](https://github.com/InternationalColorConsortium/DemoIccMAX/blob/c0ab97ddd1a0f792c8afb7a061135bc7c87f5854/IccXML/IccLibXML/IccTagXml.cpp#L4164) helper function does not complete its intended parsing process. As a result, the ICC profile is left in an incomplete or inconsistent state. Despite this, the caller proceeds with the validation process, which can lead to erroneous validation results or crashes due to incomplete or corrupt data when processing nodes.

[![Call Graph for bool CIccTagXmlProfileSequenceId::ParseXml	(	xmlNode *	pNode, std::string &	parseStr )](https://camo.githubusercontent.com/3f9a57967b379b8de4b64f273437e1f3fa03db3899a66859dd3def8de3d7ba99/68747470733a2f2f7873732e63782f323032342f30362f31312f696d672f636c6173735f635f6963635f7461675f786d6c5f70726f66696c655f73657175656e63655f69645f6166626161656533343030313164356264303939363064363939643335326531345f6367726170682e706e67)](https://camo.githubusercontent.com/3f9a57967b379b8de4b64f273437e1f3fa03db3899a66859dd3def8de3d7ba99/68747470733a2f2f7873732e63782f323032342f30362f31312f696d672f636c6173735f635f6963635f7461675f786d6c5f70726f66696c655f73657175656e63655f69645f6166626161656533343030313164356264303939363064363939643335326531345f6367726170682e706e67)

#### Understanding the Call Graph Nodes

The nodes in the call graph represent function calls made within [CIccTagXmlProfileSequenceId::ParseXml](https://github.com/InternationalColorConsortium/DemoIccMAX/blob/c0ab97ddd1a0f792c8afb7a061135bc7c87f5854/IccXML/IccLibXML/IccTagXml.cpp#L4164).

Functions & Purposes:

* [`CIccUTF16String::c_str`](https://github.com/search?q=repo%3AInternationalColorConsortium%2FDemoIccMAX%20CIccUTF16String&type=code) Retrieves a C-style string from a UTF-16 string.
* [`icGetSigVal`](https://github.com/search?q=repo%3AInternationalColorConsortium%2FDemoIccMAX+icGetSigVa&type=code): Extracts a signature value.
* [`icXmlAttrValue`](https://github.com/search?q=repo%3AInternationalColorConsortium%2FDemoIccMAX+icXmlAttrValue&type=code): Retrieves an attribute value from an XML node.
* [`icXmlFindAttr`](https://github.com/search?q=repo%3AInternationalColorConsortium%2FDemoIccMAX+icXmlFindAttr&type=code): Finds an attribute within an XML node.
* [`icXmlFindNode`](https://github.com/search?q=repo%3AInternationalColorConsortium%2FDemoIccMAX+icXmlFindNode&type=code): Finds a child node within an XML node.
* [`icXmlGetHexData`](https://github.com/search?q=repo%3AInternationalColorConsortium%2FDemoIccMAX+icXmlGetHexData&type=code): Converts hex data from a string to a binary format.
* [`CIccTagMultiLocalizedUnicode::SetText`](https://github.com/search?q=repo%3AInternationalColorConsortium%2FDemoIccMAX+CIccTagMultiLocalizedUnicode%3A%3ASetText&type=code): Sets a localized text value.
* [`CIccLocalizedUnicode::SetText`](https://github.com/search?q=repo%3AInternationalColorConsortium%2FDemoIccMAX+CIccLocalizedUnicode%3A%3ASetText&type=code): Sets text for a localized Unicode object.

### Call Graph for [`CIccTagXmlDict::ParseXml`](https://github.com/InternationalColorConsortium/DemoIccMAX/blob/c0ab97ddd1a0f792c8afb7a061135bc7c87f5854/IccXML/IccLibXML/IccTagXml.cpp#L4267)

When [`ParseXml`](https://github.com/InternationalColorConsortium/DemoIccMAX/blob/c0ab97ddd1a0f792c8afb7a061135bc7c87f5854/IccXML/IccLibXML/IccTagXml.cpp#L4164) returns [`true`](https://github.com/InternationalColorConsortium/DemoIccMAX/pull/66) correctly, the profile is fully parsed, and tags are processed. The Validate function can assess the profile, producing meaningful warnings and errors.

[![Call Graph for bool CIccTagXmlProfileSequenceId::ParseXml	(	xmlNode *	pNode, std::string &	parseStr )](https://camo.githubusercontent.com/c3b674501764d51c3a4bac623f89b6015ebf34025bf47bc71543f5dba67a79d0/68747470733a2f2f7873732e63782f323032342f30362f31312f696d672f636c6173735f635f6963635f7461675f786d6c5f646963745f6138386332393036306339663839663862363033336463623361353335643464345f6367726170682e706e67)](https://camo.githubusercontent.com/c3b674501764d51c3a4bac623f89b6015ebf34025bf47bc71543f5dba67a79d0/68747470733a2f2f7873732e63782f323032342f30362f31312f696d672f636c6173735f635f6963635f7461675f786d6c5f646963745f6138386332393036306339663839663862363033336463623361353335643464345f6367726170682e706e67)

[DemoIccMAX Documentation](https://xss.cx/public/docs/DemoIccMAX/)

## Finding a Logical Flaw

### Manual Code Review

[Commit 889db62](https://github.com/InternationalColorConsortium/DemoIccMAX/commit/889db62ba1edc0f9e1969ef1a83835d7c593e2e4) was the entry point for code review. The codebase is approximately 100K lines of code, which is significant and requires a deep dive to understand the reference implementation.

I used basic command-line analysis tools like ctags and cscope with vim, and [Doxygen](https://doxygen.nl/) with interactive SVG images to review the source code and call graphs. Knowing that any code utilizing [`ParseXml`](https://github.com/InternationalColorConsortium/DemoIccMAX/blob/c0ab97ddd1a0f792c8afb7a061135bc7c87f5854/IccXML/IccLibXML/IccTagXml.cpp#L4164) would be [vulnerable](https://srd.cx/cve-2022-26730/), I started by setting up a ctags database using:

```
ctags -R .

```

Then setup cscope database using:

```
find . -type f \( -name "*.c" -o -name "*.cpp" -o -name "*.h" \) > cscope.files
cscope -b -k

```

Search for [[`ParseXml`](https://github.com/search?q=repo%3AInternationalColorConsortium%2FDemoIccMAX+ParseXml&type=code):

```
cscope -L -0 ParseXml > cscope_output.txt

```

Contents of cscope\_output.txt

```
...
IccXML/IccLibXML/IccMpeXml.h <global> 390 virtual bool ParseXml(xmlNode *pNode, std::string &parseStr);
IccXML/IccLibXML/IccProfileXml.h <global> 89 bool ParseXml(xmlNode *pNode, std::string &parseStr);
IccXML/IccLibXML/IccTagXml.cpp <global> 98 bool CIccTagXmlUnknown::ParseXml(xmlNode *pNode, std::string &parseStr)
IccXML/IccLibXML/IccTagXml.cpp <global> 255 bool CIccTagXmlText::ParseXml(xmlNode *pNode, std::string &parseStr)
IccXML/IccLibXML/IccTagXml.cpp <global> 266 bool CIccTagXmlUtf8Text::ParseXml(xmlNode *pNode, std::string &parseStr)
IccXML/IccLibXML/IccTagXml.cpp <global> 277 bool CIccTagXmlZipUtf8Text::ParseXml(xmlNode *pNode, std::string &parseStr)
IccXML/IccLibXML/IccTagXml.cpp <global> 302 bool CIccTagXmlZipXml::ParseXml(xmlNode *pNode, std::string &parseStr)
...

```

Functions that Indirectly Call into [`CIccTagXmlProfileSequenceId::ParseXml`](https://github.com/InternationalColorConsortium/DemoIccMAX/blob/c0ab97ddd1a0f792c8afb7a061135bc7c87f5854/IccXML/IccLibXML/IccTagXml.cpp#L4164):

```
Total .cpp and .h file references:      226
Unique .cpp and .h files:        9

File-wise occurrence count:
IccXML/IccLibXML/IccMpeXml.cpp: 30
IccXML/IccLibXML/IccMpeXml.h: 19
IccXML/IccLibXML/IccProfileXml.cpp: 4
IccXML/IccLibXML/IccProfileXml.h: 1
IccXML/IccLibXML/IccTagXml.cpp: 58
IccXML/IccLibXML/IccTagXml.h: 47
IccXML/IccLibXML/build/Release/usr/local/include/IccMpeXml.h: 19
IccXML/IccLibXML/build/Release/usr/local/include/IccProfileXml.h: 1
IccXML/IccLibXML/build/Release/usr/local/include/IccTagXml.h: 47

```
## [`CIccTagXmlProfileSequenceId::ParseXml`](https://github.com/InternationalColorConsortium/DemoIccMAX/blob/c0ab97ddd1a0f792c8afb7a061135bc7c87f5854/IccXML/IccLibXML/IccTagXml.cpp#L4202)

```
bool CIccTagXmlProfileSequenceId::ParseXml(xmlNode *pNode, std::string &parseStr)
{
  pNode = icXmlFindNode(pNode, "ProfileSequenceId");

  if (!pNode)
    return false;

  m_list->clear();

  for (pNode = icXmlFindNode(pNode->children, "ProfileIdDesc"); pNode; pNode = icXmlFindNode(pNode->next, "ProfileIdDesc")) {
    CIccProfileIdDesc desc;
    const icChar *szDesc = icXmlAttrValue(pNode, "id");

    if (szDesc && *szDesc)
      icXmlGetHexData(&desc.m_profileID, szDesc, sizeof(desc.m_profileID));

    xmlAttr *langCode;

    for (pNode = icXmlFindNode(pNode, "LocalizedText"); pNode; pNode = icXmlFindNode(pNode->next, "LocalizedText")) {
      if ((langCode = icXmlFindAttr(pNode, "languageCountry")) &&
        pNode->children) {
          xmlNode *pText;

          for (pText = pNode->children; pText && pText->type != XML_TEXT_NODE; pText = pText->next);

          if (pText) {
            icUInt32Number lc = icGetSigVal(icXmlAttrValue(langCode));
            CIccUTF16String str((const char*)pText->content);
            desc.m_desc.SetText(str.c_str(), (icLanguageCode)(lc>>16), (icCountryCode)(lc & 0xffff));
          }
          else {
            desc.m_desc.SetText("");
          }
      }
    }
    m_list->push_back(desc);
  }

  return false;
}

```

The critical point is the return [`false`](https://github.com/InternationalColorConsortium/DemoIccMAX/blame/d4770471b38d24961e09740dda166e2f342ed787/IccXML/IccLibXML/IccTagXml.cpp#L4202). This unconditional return value passes unsanitized XML to the caller, leading to potentially leading to arbitrary code execution in the context of the user credential. Let's examine how the code handles data with this unconditional return value and compare it to the corrected return value of [`true`](https://github.com/InternationalColorConsortium/DemoIccMAX/pull/66).

## Confirm [`false`](https://github.com/InternationalColorConsortium/DemoIccMAX/blame/d4770471b38d24961e09740dda166e2f342ed787/IccXML/IccLibXML/IccTagXml.cpp#L4202) is incorrect unconditional return value

Taking a look at program execution flow, this is with the function [`CIccTagXmlProfileSequenceId::ParseXml`](https://github.com/InternationalColorConsortium/DemoIccMAX/blob/c0ab97ddd1a0f792c8afb7a061135bc7c87f5854/IccXML/IccLibXML/IccTagXml.cpp#L4164) and the return value == `false` stepping thru the code in `lldb`.

```
* thread #1, queue = 'com.apple.main-thread', stop reason = step over
    frame #0: 0x000000010121a900 libIccProfLib2.2.dylib`CIccProfile::Validate(this=0x00007ff7bfefede0, sReport="Warning! - Unknown NULL: Unregistered CMM signature.\r\nWarning! - spectralViewingConditionsTag::>illuminantXYZ - XYZNumber appears to be normalized! Y value should reflect absolute luminance.\r\nWarning! - spectralViewingConditionsTag::>surroundXYZ - XYZNumber appears to be normalized! Y value should reflect absolute luminance.\r\n", sSigPath="") const at IccProfile.cpp:2818:10
   2815	    rv = icMaxStatus(rv, i->pTag->Validate(sSigPath + icGetSigPath(i->TagInfo.sig), sReport, this));
   2816	  }
   2817
-> 2818	  return rv;
   2819	}
   2820
   2821	/**

```
### Key Observations:

* Incomplete Parsing: The profile may not be fully parsed, leading to missing or partially processed tags.
* Erroneous Validation: The Validate function may produce incorrect warnings or errors because it is validating an incomplete profile.
* Potential Crashes: Incomplete data structures can lead to crashes or undefined behavior during validation.

## Changed Behavior with Correct Return Value [`true`](https://github.com/InternationalColorConsortium/DemoIccMAX/pull/66):

When [`ParseXml`](https://github.com/InternationalColorConsortium/DemoIccMAX/blob/c0ab97ddd1a0f792c8afb7a061135bc7c87f5854/IccXML/IccLibXML/IccTagXml.cpp#L4164) returns [`true`](https://github.com/InternationalColorConsortium/DemoIccMAX/pull/66) correctly:

Complete Parsing: The profile is fully parsed, and all tags are processed correctly.

Accurate Validation: The Validate function can accurately assess the profile, producing meaningful warnings and errors.

Stability: The validation process is less likely to encounter crashes due to incomplete data structures.

Reviewing the Code References now that the unconditional return value has been corrected:

```
Total .cpp and .h file references:      240
Unique .cpp and .h files:        9

File-wise occurrence count:
IccXML/IccLibXML/IccMpeXml.cpp: 37
IccXML/IccLibXML/IccMpeXml.h: 21
IccXML/IccLibXML/IccProfileXml.cpp: 4
IccXML/IccLibXML/IccProfileXml.h: 1
IccXML/IccLibXML/IccTagXml.cpp: 59
IccXML/IccLibXML/IccTagXml.h: 48
IccXML/IccLibXML/build/Release/usr/local/include/IccMpeXml.h: 21
IccXML/IccLibXML/build/Release/usr/local/include/IccProfileXml.h: 1
IccXML/IccLibXML/build/Release/usr/local/include/IccTagXml.h: 48

```

The key difference is that there are now 240 references instead of 226, indicating additional code paths are exercised with this changed return value.

## [`CIccTagXmlProfileSequenceId::ParseXml` `return true`](https://github.com/InternationalColorConsortium/DemoIccMAX/blob/c0ab97ddd1a0f792c8afb7a061135bc7c87f5854/IccXML/IccLibXML/IccTagXml.cpp#L4164)

## Confirm [`true`](https://github.com/InternationalColorConsortium/DemoIccMAX/blob/c0ab97ddd1a0f792c8afb7a061135bc7c87f5854/IccXML/IccLibXML/IccTagXml.cpp#L4202) is correct unconditional return value

The return value is corrected to `true` in [CIccTagXmlProfileSequenceId::ParseXml](https://github.com/InternationalColorConsortium/DemoIccMAX/blob/c0ab97ddd1a0f792c8afb7a061135bc7c87f5854/IccXML/IccLibXML/IccTagXml.cpp#L4202):

```
-  return false;
+  return true;

```

Stepping through the updated code with lldb confirms the fix:

```
* thread #1, queue = 'com.apple.main-thread', stop reason = instruction step over
    frame #0: 0x00000001000027cf iccFromXml`main + 927
iccFromXml`main:
->  0x1000027cf <+927>: callq  0x100002c95               ; symbol stub for: CIccProfile::Validate(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char>>&, std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char>>) const
    0x1000027d4 <+932>: movl   %eax, %r14d
    0x1000027d7 <+935>: movq   %r15, %r12
    0x1000027da <+938>: testb  $0x1, -0xc0(%rbp)

```

With the corrected return value of `true`, the ICC profile parsing, validation, and saving processes complete successfully without errors. The program performs all necessary memory cleanup operations, preventing leaks, and new parsing errors with XML data.

### Analysis of XML Unit Test Errors

There are unit test errors that indicate issues with parsing specific XML elements and types.

#### Import and File Parsing Failures

**Example:** Failed to parse import `RefEstimationImport.xml` file.

**Implication:** The parser failed to process the entire import file, which could indicate further function in the code need review and adjustments.

#### Tag Member Parsing Failures

**Example:** Failed to parse tag member `float16NumberType`.

**Implication:** The parser encountered issues while parsing specific tag members, likely due to unsupported or incorrectly defined tag types.

#### Tag Parsing Failures

**Example:** Unable to parse `float16ArrayType (float16NumberType)` tag.

**Implication:** The parser failed to handle specific tags, which may be due to missing implementations or unsupported tag types in the current parser.

#### Element Parsing Failures

**Example:** Unable to parse element `(CalculatorElement)` tag.

**Implication:** Specific elements within the XML files could not be parsed. This could indicate the inability to process element types.

#### General Parsing Failures

**Example:** Unable to parse `CMYK-3DLUTs.xml` file.

**Implication:** The parser could not process the entire XML file, possibly due to logic flaws or other memory issues.

### Sample Parser Output

```
+ ../iccFromXml LCDDisplay.xml LCDDisplay.icc
Number of items parsed: 256
Number of items parsed: 256
Number of items parsed: 256
Number of items parsed: 401
Number of items parsed: 1203
Number of items parsed: 401
Number of items parsed: 401
Number of items parsed: 1203
Number of items parsed: 401
Number of items parsed: 256
Number of items parsed: 256
Number of items parsed: 256
Number of items parsed: 9
Number of items parsed: 3
Number of items parsed: 9
Number of items parsed: 3
Number of items parsed: 1203
Number of items parsed: 401
Number of items parsed: 401
Profile parsed and saved correctly

+ ../iccFromXml LaserProjector.xml LaserProjector.icc
Number of items parsed: 256
Number of items parsed: 256
Number of items parsed: 256
Number of items parsed: 401
Number of items parsed: 2
Error parsing GridPoints.
Unable to parse element of type CIccMpeXmlEmissionCLUT
Unable to parse element (EmissionCLutElement) starting on line 131
Unable to Parse "multiProcessElementType" (multiProcessElementType) Tag on line 24

```
#### Detailed Report

1. **Import and File Parsing Failures**

   **Files Affected:**

   * `RefEstimationImport.xml`
   * `17ChanPart1.xml`
   * `17ChanWithSpots-MVIS.xml`
   * `18ChanWithSpots-MVIS.xml`
   * `CMYK-3DLUTs.xml`
   * `CMYK-3DLUTs2.xml`
   * `CMYKOGP-MVIS-Smooth.xml`
   * `ISO22028-Encoded-bg-sRGB.xml`
   * `ISO22028-Encoded-sRGB.xml`
   * `LaserProjector.xml`
   * `NamedColor.xml`
   * `RefDecC.xml`
   * `RefDecH.xml`
   * `RefIncW.xml`
   * `argbRef.xml`
   * `calcExercizeOps.xml`
   * `sRgbEncodingOverrides.xml`
   * `srgbCalc++Test.xml`
   * `srgbCalcTest.xml`
   * `srgbRef.xml`

   **Issues:**

   * Entire files could not be parsed.
   * Likely due to structural issues or format errors.
2. **Tag Member Parsing Failures**

   **Tags Affected:**

   * `float16NumberType`
   * `float32NumberType`

   **Issues:**

   * Specific tag members could not be parsed.
   * Likely due to unsupported or incorrectly defined tag types.
3. **Tag Parsing Failures**

   **Tags Affected:**

   * [float16ArrayType](https://www.color.org/specification/ICC.2-2023.pdf)
   * [float32ArrayType](https://www.color.org/specification/ICC.2-2023.pdf)
   * [multiProcessElementType](https://www.color.org/specification/ICC.2-2023.pdf)
   * [tagArrayType](https://www.color.org/specification/ICC.2-2023.pdf)
   * [tagStructType](https://www.color.org/specification/ICC.2-2023.pdf)
   * [uInt16ArrayType](https://www.color.org/specification/ICC.2-2023.pdf)

   **Issues:**

   * Specific tags could not be parsed.
   * Likely due to missing implementations or unsupported tag types in the parser.
4. **Element Parsing Failures**

   **Elements Affected:**

   * [CalculatorElement](https://www.color.org/specification/ICC.2-2023.pdf)
   * [EmissionCLutElement](https://www.color.org/specification/ICC.2-2023.pdf)
   * [CIccMpeXmlCLUT](https://xss.cx/public/docs/DemoIccMAX/df/d13/class_c_icc_mpe_xml_c_l_u_t.html)
   * [CIccMpeXmlCalculator](https://xss.cx/public/docs/DemoIccMAX/df/dd6/class_c_icc_mpe_xml_calculator.html)
   * [CIccMpeXmlEmissionCLUT](https://xss.cx/public/docs/DemoIccMAX/d3/d37/class_c_icc_mpe_xml_emission_c_l_u_t.html)
   * [CIccMpeXmlExtCLUT](https://xss.cx/public/docs/DemoIccMAX/df/d29/class_c_icc_mpe_xml_ext_c_l_u_t.html)
   * [CIccMpeXmlTintArray](https://xss.cx/public/docs/DemoIccMAX/df/dd8/class_c_icc_mpe_xml_tint_array.html)

   **Issues:**

   * Specific elements could not be parsed.
   * Likely due to structural issues or unsupported element types.

## DORKs for IccXmlLib or IccProfLib

### Finding Open Source Repositories

```
inurl:github.com "CIccTagXmlProfileSequenceId"
inurl:gitlab.com "CIccTagXmlProfileSequenceId"

```
### Identifying Web Applications and Services:

```
"ICC profile XML parsing" inurl:app
"embed ICC profile into images" inurl:service
"extract ICC profile from images" inurl:service

```
### Locating Documentation and Tutorials

```
"CIccTagXmlProfileSequenceId::ParseXml" intitle:documentation
"ICC profile parsing tutorial" intitle:guide

```
### Finding Vulnerable Instances

```
"XML parsing error" "ICC profile" inurl:log
"XML parsing failure" "ICC profile" inurl:error

```

```
intext:"libiccxml" OR intext:"iccproflib" "International Color Consortium" filetype:pdf OR filetype:txt OR filetype:md OR filetype:xml OR filetype:txt OR filetype:cpp
"Libiccxml" OR "iccproflib"
"iccxmllib" OR "iccproflib"

```
### Observations

The use of [`using convert_type = std::codecvt_utf8<wchar_t>;`](https://github.com/search?q=repo%3AInternationalColorConsortium%2FDemoIccMAX%20convert_type%20%3D%20std%3A%3Acodecvt_utf8%3Cwchar_t%3E%3B&type=code) and its related functionality in the DemoIccMAX Project is significant and potentially non-trivial to refactor comprehensively.

#### Details

File: DemoIccMAX-master/IccProfLib/IccTagDict.cpp:88:27

Code: [`using convert_type = std::codecvt_utf8<wchar_t>;`](https://github.com/search?q=repo%3AInternationalColorConsortium%2FDemoIccMAX%20convert_type%20%3D%20std%3A%3Acodecvt_utf8%3Cwchar_t%3E%3B&type=code)

File: DemoIccMAX-master/IccProfLib/IccTagDict.cpp:216:24 'convert\_type' is deprecated

Code: [`std::wstring_convert<convert_type, wchar_t> converter;`](https://github.com/search?q=repo%3AInternationalColorConsortium%2FDemoIccMAX%20std%3A%3Awstring_convert%3Cconvert_type%2C%20wchar_t%3E%20converter&type=code)

## Knowledgebase

* <https://bugs.chromium.org/p/project-zero/issues/detail?id=2225>
* <https://bugs.chromium.org/p/project-zero/issues/detail?id=2226>

## My Prior Research

* <https://srd.cx/cve-2022-26730/>
* <https://srd.cx/cve-2023-32443/>
* <https://xss.cx/2023/10/29/src/demomax-clang-static-analysis/>

### My Current CVE's for the DemoIccMAX Project

* [CVE-2023-46602](https://github.com/advisories/GHSA-2q9m-8wj3-95xg "CVE-2023-46602") <https://nvd.nist.gov/vuln/detail/CVE-2023-46602>
* [CVE-2023-46603](https://github.com/advisories/GHSA-fjc9-jw7g-7732 "CVE-2023-46603") <https://nvd.nist.gov/vuln/detail/CVE-2023-46603>
* [CVE-2023-46866](https://github.com/advisories/GHSA-8vr5-2c4m-8x5v "CVE-2023-46866") <https://nvd.nist.gov/vuln/detail/CVE-2023-46866>
* [CVE-2023-46867](https://github.com/advisories/GHSA-h35g-gh47-w446 "CVE-2023-46867") <https://nvd.nist.gov/vuln/detail/CVE-2023-46867>
* [CVE-2023-47249](https://github.com/advisories/GHSA-j8pv-hfpr-q8pc "CVE-2023-47249") <https://nvd.nist.gov/vuln/detail/CVE-2023-47249>
* [CVE-2023-48736](https://github.com/advisories/GHSA-mqjf-65x6-cv76 "CVE-2023-48736") <https://nvd.nist.gov/vuln/detail/CVE-2023-48736>
* [CVE-2024-38427](https://github.com/advisories/GHSA-qqfm-9jcc-9q44 "CVE-2024-38427") <https://nvd.nist.gov/vuln/detail/CVE-2024-38427>

Sorry, something went wrong.

All reactions

 [xsscx](/xsscx)
added 2 commits
[May 13, 2024 21:54](#commits-pushed-85ce74e)

[![@xsscx](https://avatars.githubusercontent.com/u/10790582?s=40&v=4)](/xsscx)

`[Update IccTagXml.cpp Fix return value](/InternationalColorConsortium/DemoIccMAX/pull/66/commits/85ce74ef19fb0751c7e188b06daed22fe74c332c "Update IccTagXml.cpp Fix return value

Change the unconditional return statement at the end of the CIccTagXmlProfileSequenceId::ParseXml function from false to true.")`
 …

`[85ce74e](/InternationalColorConsortium/DemoIccMAX/pull/66/commits/85ce74ef19fb0751c7e188b06daed22fe74c332c)`

```
Change the unconditional return statement at the end of the CIccTagXmlProfileSequenceId::ParseXml function from false to true.
```

[![@xsscx](https://avatars.githubusercontent.com/u/10790582?s=40&v=4)](/xsscx)

`[Update IccUtil.cpp Hoyt's PATCH for ccProfLib/IccUtil.cpp:2064:8: err…](/InternationalColorConsortium/DemoIccMAX/pull/66/commits/4d16c4f435f5149c77a891b0be7147c23f24a268 "Update IccUtil.cpp Hoyt's PATCH for ccProfLib/IccUtil.cpp:2064:8: error: integer value 4294967295 is outside the valid range

Update IccUtil.cpp Hoyt's PATCH for ccProfLib/IccUtil.cpp:2064:8: error: integer value 4294967295 is outside the valid range

Distribution Compile Error:
-----------------------------
make -j$(nproc) 2>&1 | grep 'error:'

DemoIccMAX-a9a15564e3418176d60eef88c946831779f95658/IccProfLib/IccUtil.cpp:2064:8: error: integer value 4294967295 is outside the valid range of values [0, 1] for this enumeration type [-Wenum-constexpr-conversion]
DemoIccMAX-a9a15564e3418176d60eef88c946831779f95658/IccProfLib/IccUtil.cpp:2068:5/Users/xss/Downloads/DemoIccMAX-a9a15564e3418176d60eef88c946831779f95658/IccProfLib/IccUtil.cpp:2064:8: :error:  integer value 4294967295 is outside the valid range of values [0, 1] for this enumeration type [-Wenum-constexpr-conversion]warning:
DemoIccMAX-a9a15564e3418176d60eef88c946831779f95658/IccProfLib/IccUtil.cpp:2085:8: error: integer value 4294967295 is outside the valid range of values [0, 3] for this enumeration type [-Wenum-constexpr-conversion]
DemoIccMAX-a9a15564e3418176d60eef88c946831779f95658/IccProfLib/IccUtil.cpp:2085:8: error: integer value 4294967295 is outside the valid range of values [0, 3] for this enumeration type [-Wenum-constexpr-conversion]

Hoyt's Patch
---------------
diff -u   ../IccProfLib/IccUtil.cpp.dist ../IccProfLib/IccUtil.cpp
--- ../IccProfLib/IccUtil.cpp.dist	2024-05-14 08:10:38
+++ ../IccProfLib/IccUtil.cpp	2024-05-14 08:23:25
@@ -2054,39 +2054,36 @@

 const icChar *CIccInfo::GetMeasurementFlareName(icMeasurementFlare val)
 {
-  switch ((int)val) {
+  switch (val) { // Directly switch on the enum without casting to int
   case icFlare0:
-    return \"Flare 0\";
+    return \"Flare 0\"; // Properly handle the 0% flare

   case icFlare100:
-    return \"Flare 100\";
-
-  case icMaxEnumFlare:
-    return \"Max Flare\";
+    return \"Flare 100\"; // Properly handle the 100% flare

   default:
-    sprintf(m_szStr, \"Unknown Flare '%d'\", (int)val);
+    // Handle icMaxEnumFlare explicitly here if needed
+    if (val == icMaxEnumFlare) {
+      return \"Max Flare\"; // Special handling for the max sentinel value
+    }
+    // General default case for truly unexpected values
+          std::snprintf(m_szStr, sizeof(m_szStr), \"Unknown Flare '%d'\", (int)val);
     return m_szStr;
   }
 }

+
 const icChar *CIccInfo::GetMeasurementGeometryName(icMeasurementGeometry val)
 {
-  switch ((int)val) {
+  switch (val) {  // Directly use enum type, casting is not needed
   case icGeometryUnknown:
     return \"Geometry Unknown\";
-
   case icGeometry045or450:
     return \"Geometry 0-45 or 45-0\";
-
   case icGeometry0dord0:
     return \"Geometry 0-d or d-0\";
-
-  case icMaxEnumGeometry:
-    return \"Max Geometry\";
-
-  default:
-    sprintf(m_szStr, \"Unknown Geometry '%d'\", (int)val);
+  default:
+          std::snprintf(m_szStr, sizeof(m_szStr), \"Unknown Geometry '%d'\", (int)val);
     return m_szStr;
   }
 }

Compile Result:
make -j$(nproc) 2>&1 | grep 'error:'")`
 …

`[4d16c4f](/InternationalColorConsortium/DemoIccMAX/pull/66/commits/4d16c4f435f5149c77a891b0be7147c23f24a268)`

```
…or: integer value 4294967295 is outside the valid range

Update IccUtil.cpp Hoyt's PATCH for ccProfLib/IccUtil.cpp:2064:8: error: integer value 4294967295 is outside the valid range

Distribution Compile Error:
-----------------------------
make -j$(nproc) 2>&1 | grep 'error:'

DemoIccMAX-a9a15564e3418176d60eef88c946831779f95658/IccProfLib/IccUtil.cpp:2064:8: error: integer value 4294967295 is outside the valid range of values [0, 1] for this enumeration type [-Wenum-constexpr-conversion]
DemoIccMAX-a9a15564e3418176d60eef88c946831779f95658/IccProfLib/IccUtil.cpp:2068:5/Users/xss/Downloads/DemoIccMAX-a9a15564e3418176d60eef88c946831779f95658/IccProfLib/IccUtil.cpp:2064:8: :error:  integer value 4294967295 is outside the valid range of values [0, 1] for this enumeration type [-Wenum-constexpr-conversion]warning:
DemoIccMAX-a9a15564e3418176d60eef88c946831779f95658/IccProfLib/IccUtil.cpp:2085:8: error: integer value 4294967295 is outside the valid range of values [0, 3] for this enumeration type [-Wenum-constexpr-conversion]
DemoIccMAX-a9a15564e3418176d60eef88c946831779f95658/IccProfLib/IccUtil.cpp:2085:8: error: integer value 4294967295 is outside the valid range of values [0, 3] for this enumeration type [-Wenum-constexpr-conversion]

Hoyt's Patch
---------------
diff -u   ../IccProfLib/IccUtil.cpp.dist ../IccProfLib/IccUtil.cpp
--- ../IccProfLib/IccUtil.cpp.dist	2024-05-14 08:10:38
+++ ../IccProfLib/IccUtil.cpp	2024-05-14 08:23:25
@@ -2054,39 +2054,36 @@

 const icChar *CIccInfo::GetMeasurementFlareName(icMeasurementFlare val)
 {
-  switch ((int)val) {
+  switch (val) { // Directly switch on the enum without casting to int
   case icFlare0:
-    return "Flare 0";
+    return "Flare 0"; // Properly handle the 0% flare

   case icFlare100:
-    return "Flare 100";
-
-  case icMaxEnumFlare:
-    return "Max Flare";
+    return "Flare 100"; // Properly handle the 100% flare

   default:
-    sprintf(m_szStr, "Unknown Flare '%d'", (int)val);
+    // Handle icMaxEnumFlare explicitly here if needed
+    if (val == icMaxEnumFlare) {
+      return "Max Flare"; // Special handling for the max sentinel value
+    }
+    // General default case for truly unexpected values
+          std::snprintf(m_szStr, sizeof(m_szStr), "Unknown Flare '%d'", (int)val);
     return m_szStr;
   }
 }

+
 const icChar *CIccInfo::GetMeasurementGeometryName(icMeasurementGeometry val)
 {
-  switch ((int)val) {
+  switch (val) {  // Directly use enum type, casting is not needed
   case icGeometryUnknown:
     return "Geometry Unknown";
-
   case icGeometry045or450:
     return "Geometry 0-45 or 45-0";
-
   case icGeometry0dord0:
     return "Geometry 0-d or d-0";
-
-  case icMaxEnumGeometry:
-    return "Max Geometry";
-
-  default:
-    sprintf(m_szStr, "Unknown Geometry '%d'", (int)val);
+  default:
+          std::snprintf(m_szStr, sizeof(m_szStr), "Unknown Geometry '%d'", (int)val);
     return m_szStr;
   }
 }

Compile Result:
make -j$(nproc) 2>&1 | grep 'error:'
```

[![@xsscx](https://avatars.githubusercontent.com/u/10790582?s=40&u=718c74872b8e42580879503d8763527eec54855c&v=4)](/xsscx)
[xsscx](/xsscx)
changed the title
~~Update IccTagXml.cpp Fix return value~~
Update: Fix the Compile Error in IccUtil.cpp, Fix a return value in IccTagXml.cpp
[May 14, 2024](#event-12801397478)

[![maxderhak](https://avatars.githubusercontent.com/u/14334684?s=60&v=4)](/maxderhak)

**[maxderhak](/maxderhak)**
approved these changes
[May 20, 2024](#pullrequestreview-2066573887)

 [View reviewed changes](/InternationalColorConsortium/DemoIccMAX/pull/66/files/4d16c4f435f5149c77a891b0be7147c23f24a268)

[![@maxderhak](https://avatars.githubusercontent.com/u/14334684?s=40&u=3d223542175ae6534e5eb4b49b72ec6ce7ce6de4&v=4)](/maxderhak)
[maxderhak](/maxderhak)
merged commit [`f891074`](/InternationalColorConsortium/DemoIccMAX/commit/f891074a0f1c9d61a3dfa53749265f8c14ed4ee6)
into
InternationalColorConsortium:master

[May 20, 2024](https://github.com/InternationalColorConsortium/DemoIccMAX/pull/66#event-12868459133)

This was referenced Jun 1, 2024

[Doesn't build on macOS
#62](/InternationalColorConsortium/DemoIccMAX/issues/62)

Closed

[Build Instructions, Cherry Picking Example | Compile Errors in PR 69
#77](/InternationalColorConsortium/DemoIccMAX/issues/77)

Closed

[![@xsscx](https://avatars.githubusercontent.com/u/10790582?s=40&u=718c74872b8e42580879503d8763527eec54855c&v=4)](/xsscx)
[xsscx](/xsscx)
mentioned this pull request
[Jul 13, 2024](#ref-issue-2406646852)

[make error IccCmm.h:1246:37: error: expected ‘)’ before ‘\*’ token
#82](/InternationalColorConsortium/DemoIccMAX/issues/82)

Closed

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2FInternationalColorConsortium%2FDemoIccMAX%2Fpull%2F66)

Reviewers

[![@maxderhak](https://avatars.githubusercontent.com/u/14334684?s=40&v=4)](/maxderhak) [maxderhak](/maxderhak)

maxderhak approved these changes

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

Successfully merging this pull request may close these issues.

2 participants

[![@xsscx](https://avatars.githubusercontent.com/u/10790582?s=52&v=4)](/xsscx) [![@maxderhak](https://avatars.githubusercontent.com/u/14334684?s=52&v=4)](/maxderhak)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_e766f8fd_20250111_180630.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FInternationalColorConsortium%2FDemoIccMAX%2Fpull%2F66%2Fcommits%2F85ce74ef19fb0751c7e188b06daed22fe74c332c)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FInternationalColorConsortium%2FDemoIccMAX%2Fpull%2F66%2Fcommits%2F85ce74ef19fb0751c7e188b06daed22fe74c332c)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fpull_requests%2Fshow%2Fcommits&source=header-repo&source_repo=InternationalColorConsortium%2FDemoIccMAX)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[InternationalColorConsortium](/InternationalColorConsortium)
/
**[DemoIccMAX](/InternationalColorConsortium/DemoIccMAX)**
Public

* [Notifications](/login?return_to=%2FInternationalColorConsortium%2FDemoIccMAX) You must be signed in to change notification settings
* [Fork
  37](/login?return_to=%2FInternationalColorConsortium%2FDemoIccMAX)
* [Star
   120](/login?return_to=%2FInternationalColorConsortium%2FDemoIccMAX)

* [Code](/InternationalColorConsortium/DemoIccMAX)
* [Issues
  7](/InternationalColorConsortium/DemoIccMAX/issues)
* [Pull requests
  0](/InternationalColorConsortium/DemoIccMAX/pulls)
* [Discussions](/InternationalColorConsortium/DemoIccMAX/discussions)
* [Actions](/InternationalColorConsortium/DemoIccMAX/actions)
* [Projects
  0](/InternationalColorConsortium/DemoIccMAX/projects)
* [Security](/InternationalColorConsortium/DemoIccMAX/security)
* [Insights](/InternationalColorConsortium/DemoIccMAX/pulse)

Additional navigation options

* [Code](/InternationalColorConsortium/DemoIccMAX)
* [Issues](/InternationalColorConsortium/DemoIccMAX/issues)
* [Pull requests](/InternationalColorConsortium/DemoIccMAX/pulls)
* [Discussions](/InternationalColorConsortium/DemoIccMAX/discussions)
* [Actions](/InternationalColorConsortium/DemoIccMAX/actions)
* [Projects](/InternationalColorConsortium/DemoIccMAX/projects)
* [Security](/InternationalColorConsortium/DemoIccMAX/security)
* [Insights](/InternationalColorConsortium/DemoIccMAX/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2FInternationalColorConsortium%2FDemoIccMAX%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2FInternationalColorConsortium%2FDemoIccMAX%2Fissues%2Fnew%2Fchoose)
to your account

# Update: Fix the Compile Error in IccUtil.cpp, Fix a return value in IccTagXml.cpp #66

 Merged

[maxderhak](/maxderhak)
merged 2 commits into
[InternationalColorConsortium:master](/InternationalColorConsortium/DemoIccMAX/tree/master "InternationalColorConsortium/DemoIccMAX:master")
from
xsscx:master

May 20, 2024

[Conversation
0](/InternationalColorConsortium/DemoIccMAX/pull/66)
[Commits
2](/InternationalColorConsortium/DemoIccMAX/pull/66/commits)
[Checks
0](/InternationalColorConsortium/DemoIccMAX/pull/66/checks)
[Files changed](/InternationalColorConsortium/DemoIccMAX/pull/66/files)

 Merged

# [Update: Fix the Compile Error in IccUtil.cpp, Fix a return value in IccTagXml.cpp](#top) #66

Changes from **1 commit**

Commits

[Show all changes

2 commits](/InternationalColorConsortium/DemoIccMAX/pull/66/files)
Select commit
Hold shift + click to select a range

[`85ce74e`
Update IccTagXml.cpp Fix return value

xsscx May 14, 2024](/InternationalColorConsortium/DemoIccMAX/pull/66/commits/85ce74ef19fb0751c7e188b06daed22fe74c332c)
[`4d16c4f`
Update IccUtil.cpp Hoyt's PATCH for ccProfLib/IccUtil.cpp:2064:8: err…

xsscx May 14, 2024](/InternationalColorConsortium/DemoIccMAX/pull/66/commits/4d16c4f435f5149c77a891b0be7147c23f24a268)

**File filter**

### Filter by extension

Filter by extension

.cpp
(1)

All 1 file type selected

---

Viewed files

[Clear filters](/InternationalColorConsortium/DemoIccMAX/pull/66/commits/85ce74ef19fb0751c7e188b06daed22fe74c332c)

 **Conversations**

Failed to load comments.  Retry

 Loading

 **Jump to**

Jump to file

Failed to load files.  Retry

 Loading

##### Diff view

![Unified Diff View](https://github.githubassets.com/assets/unified-6de447b07fd7.svg)

Unified

![Split Diff View](https://github.githubassets.com/assets/split-b930d4a1df45.svg)

Split

Hide whitespace

 Apply and reload

Show whitespace

##### Diff view

![Unified Diff View](https://github.githubassets.com/assets/unified-6de447b07fd7.svg)

Unified

![Split Diff View](https://github.githubassets.com/assets/split-b930d4a1df45.svg)

Split

Hide whitespace

 Apply and reload

Prev

 [Next](/InternationalColorConsortium/DemoIccMAX/pull/66/commits/4d16c4f435f5149c77a891b0be7147c23f24a268)Next commit

Update IccTagXml.cpp Fix return value

```
Change the unconditional return statement at the end of the CIccTagXmlProfileSequenceId::ParseXml function from false to true.
```

* Loading branch information

[![@xsscx](https://avatars.githubusercontent.com/u/10790582?s=40&v=4)](/xsscx)

[xsscx](/InternationalColorConsortium/DemoIccMAX/commits?author=xsscx "View all commits by xsscx")
authored
May 14, 2024

commit 85ce74ef19fb0751c7e188b06daed22fe74c332c

## There are no files selected for viewing

2 changes: 1 addition & 1 deletion

2
[IccXML/IccLibXML/IccTagXml.cpp](#diff-3f71aa64d5e023100dcbb4a7ebc94c4c601515d60e4be652805274ea58594483 "IccXML/IccLibXML/IccTagXml.cpp")

Show comments

[View file](/InternationalColorConsortium/DemoIccMAX/blob/85ce74ef19fb0751c7e188b06daed22fe74c332c/IccXML/IccLibXML/IccTagXml.cpp)
Edit file

Delete file

[Open in desktop](https://desktop.github.com)

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -4199,7 +4199,7 @@ bool CIccTagXmlProfileSequenceId::ParseXml(xmlNode \*pNode, std::string &parseStr |
|  |  | m\_list->push\_back(desc); |
|  |  | } |
|  |  |  |
|  |  | return false; |
|  |  | return true; |
|  |  | } |
|  |  |  |
|  |  |  |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


