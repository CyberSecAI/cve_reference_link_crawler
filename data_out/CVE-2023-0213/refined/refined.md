Based on the provided content, here's a breakdown of the vulnerability described:

**Root Cause of Vulnerability:**

*   The vulnerability is due to an "Uncontrolled Search Path Element" (CWE-427). This means that the M-Files software, specifically the Desktop or Admin tools, is likely searching for executable files or libraries in an insecure manner, allowing an attacker to potentially inject a malicious file that gets executed with elevated privileges.

**Weaknesses/Vulnerabilities Present:**

*   **Search Order Hijacking:** The vulnerability is classified as a search order hijacking vulnerability (CAPEC-471), meaning that an attacker can manipulate the search path to cause a malicious executable to be loaded and run instead of the legitimate one that was intended.

**Impact of Exploitation:**

*   **Elevation of Privilege:** A user with local access to a Windows machine where M-Files Desktop or Admin tools are installed can gain SYSTEM privileges. This means the attacker can execute code with the highest privileges on the local system.
*   **Lateral Movement:** The increased privileges could potentially be used to move laterally within a network to compromise other systems.
*   **No Impact on Server or Vault:** Importantly, the vulnerability does not directly grant additional access to the document vault or M-Files Server; the primary impact is on the local machine itself.

**Attack Vectors:**

*   **Local Access:** The attacker must have local access to the Windows machine where the vulnerable M-Files software is installed.
*   **Authenticated User:** The attacker must be an authenticated and logged-in user on the Windows system.

**Required Attacker Capabilities/Position:**

*   The attacker needs to be a legitimate user with local access to the Windows machine that has M-Files Desktop or Admin tools installed
*   The attacker needs to be logged-in to the system

**CVSS Score:**

*   CVSS 3.1 Score: 8.8
*   CVSS Vector: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H
    *   **AV:L (Local):** The attack requires local access.
    *   **AC:L (Low):** The attack complexity is low.
    *   **PR:L (Low):** The attack requires low privileges (a normal user can exploit this).
    *  **UI:N (None):** No user interaction is required.
    *  **S:C (Changed):** A change in system scope is present.
    *   **C:H (High):** The confidentiality impact is high.
    *   **I:H (High):** The integrity impact is high.
    *  **A:H (High):** The availability impact is high.

**Affected Products:**

*   M-Files versions prior to 22.6.