

| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=c7cff9780297d55d97ad068b68b703cfe53ef9af)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=c7cff9780297d55d97ad068b68b703cfe53ef9af)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=c7cff9780297d55d97ad068b68b703cfe53ef9af)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=c7cff9780297d55d97ad068b68b703cfe53ef9af)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Kees Cook <keescook@chromium.org> | 2024-02-27 09:51:12 -0800 |
| --- | --- | --- |
| committer | Sasha Levin <sashal@kernel.org> | 2024-03-26 18:21:21 -0400 |
| commit | [c7cff9780297d55d97ad068b68b703cfe53ef9af](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=c7cff9780297d55d97ad068b68b703cfe53ef9af) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=c7cff9780297d55d97ad068b68b703cfe53ef9af)) | |
| tree | [60e15630bbc6ed73b4a66aba0add10e5f7a0374e](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=c7cff9780297d55d97ad068b68b703cfe53ef9af) | |
| parent | [40876d07d2922df7d6c3d9f7995d969361b17a7a](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=40876d07d2922df7d6c3d9f7995d969361b17a7a) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=c7cff9780297d55d97ad068b68b703cfe53ef9af&id2=40876d07d2922df7d6c3d9f7995d969361b17a7a)) | |
| download | [linux-c7cff9780297d55d97ad068b68b703cfe53ef9af.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-c7cff9780297d55d97ad068b68b703cfe53ef9af.tar.gz) | |

x86, relocs: Ignore relocations in .notes section[ Upstream commit aaa8736370db1a78f0e8434344a484f9fd20be3b ]
When building with CONFIG\_XEN\_PV=y, .text symbols are emitted into
the .notes section so that Xen can find the "startup\_xen" entry point.
This information is used prior to booting the kernel, so relocations
are not useful. In fact, performing relocations against the .notes
section means that the KASLR base is exposed since /sys/kernel/notes
is world-readable.
To avoid leaking the KASLR base without breaking unprivileged tools that
are expecting to read /sys/kernel/notes, skip performing relocations in
the .notes section. The values readable in .notes are then identical to
those found in System.map.
Reported-by: Guixiong Wei <guixiongwei@gmail.com>
Closes: https://lore.kernel.org/all/20240218073501.54555-1-guixiongwei@gmail.com/
Fixes: 5ead97c84fa7 ("xen: Core Xen implementation")
Fixes: da1a679cde9b ("Add /sys/kernel/notes")
Reviewed-by: Juergen Gross <jgross@suse.com>
Signed-off-by: Kees Cook <keescook@chromium.org>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=c7cff9780297d55d97ad068b68b703cfe53ef9af)

| -rw-r--r-- | [arch/x86/tools/relocs.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/arch/x86/tools/relocs.c?id=c7cff9780297d55d97ad068b68b703cfe53ef9af) | 8 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 8 insertions, 0 deletions

| diff --git a/arch/x86/tools/relocs.c b/arch/x86/tools/relocs.cindex 27c82207d38781..3167228ca17469 100644--- a/[arch/x86/tools/relocs.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/arch/x86/tools/relocs.c?id=40876d07d2922df7d6c3d9f7995d969361b17a7a)+++ b/[arch/x86/tools/relocs.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/arch/x86/tools/relocs.c?id=c7cff9780297d55d97ad068b68b703cfe53ef9af)@@ -599,6 +599,14 @@ static void print\_absolute\_relocs(void) if (!(sec\_applies->shdr.sh\_flags & SHF\_ALLOC)) { continue; }+ /\*+ \* Do not perform relocations in .notes section; any+ \* values there are meant for pre-boot consumption (e.g.+ \* startup\_xen).+ \*/+ if (sec\_applies->shdr.sh\_type == SHT\_NOTE) {+ continue;+ } sh\_symtab = sec\_symtab->symtab; sym\_strtab = sec\_symtab->link->strtab; for (j = 0; j < sec->shdr.sh\_size/sizeof(Elf\_Rel); j++) { |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 04:27:44 +0000

