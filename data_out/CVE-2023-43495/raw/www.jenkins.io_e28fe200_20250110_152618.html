<!DOCTYPE html>
<html lang='en'>
<head>
<title>
Jenkins Security Advisory 2023-09-20
</title>
<meta content='text/html; charset=UTF-8' http-equiv='Content-Type'>
<meta content='Jenkins â an open source automation server which enables developers around the world to reliably build, test, and deploy their software' name='description'>
<meta charset='utf-8'>
<meta content='width=device-width, initial-scale=1' name='viewport'>
<meta content='ie=edge' http-equiv='x-ua-compatible'>
<link href='https://www.jenkins.io/security/advisory/2023-09-20/' rel='canonical'>
<!-- Favicons -->
<link href='/favicon.ico' rel='shortcut icon' type='image/x-icon'>
<link href='/apple-touch-icon.png' rel='apple-touch-icon' sizes='180x180'>
<link href='/favicon-32x32.png' rel='icon' sizes='32x32' type='image/png'>
<link href='/favicon-16x16.png' rel='icon' sizes='16x16' type='image/png'>
<link href='/site.webmanifest' rel='manifest'>
<link color='#5bbad5' href='/safari-pinned-tab.svg' rel='mask-icon'>
<meta content='#2b5797' name='msapplication-TileColor'>
<meta content='#ffffff' name='theme-color'>
<meta content='Jenkins Security Advisory 2023-09-20' name='apple-mobile-web-app-title'>
<!-- Twitter Card data -->
<meta content='summary_large_image' name='twitter:card'>
<meta content='@JenkinsCI' name='twitter:site'>
<meta content='Jenkins Security Advisory 2023-09-20' name='twitter:title'>
<meta content='Jenkins â an open source automation server which enables developers around the world to reliably build, test, and deploy their software' name='twitter:description'>
<meta content='@JenkinsCI' name='twitter:creator'>
<!-- Twitter Summary card images must be at least 120x120px -->
<meta content='/images/logo-title-opengraph.png' name='twitter:image'>
<!-- Open Graph data -->
<meta content='Jenkins Security Advisory 2023-09-20' property='og:title'>
<meta content='article' property='og:type'>
<meta content='https://www.jenkins.io/security/advisory/2023-09-20/' property='og:url'>
<meta content='Jenkins â an open source automation server which enables developers around the world to reliably build, test, and deploy their software' property='og:description'>
<meta content='Jenkins Security Advisory 2023-09-20' property='og:site_name'>
<meta content='/images/logo-title-opengraph.png' property='og:image'>
<link href='/assets/bower/bootstrap/css/bootstrap.min.css' media='screen' rel='stylesheet'>
<link href='/css/jenkins.css' media='screen' rel='stylesheet'>
<link href='/css/copy-to-clipboard.css' media='screen' rel='stylesheet'>
<link href='/stylesheets/styles.css' media='screen' rel='stylesheet'>
<!-- Non-obtrusive CSS styles -->
<link href='/css/footer.css' media='screen' rel='stylesheet'>
<link href='/css/font-awesome.min.css' media='screen' rel='stylesheet'>
<link href='https://cdn.jsdelivr.net/npm/@docsearch/css@3' rel='stylesheet'>
</head>
<body>
<script src='/assets/bower/jquery/jquery.min.js'></script>
<script src='/js/copy-to-clipboard.js'></script>
<jio-navbar class='fixed-nav' id='ji-toolbar' property='https://www.jenkins.io' showSearchBox theme='auto'></jio-navbar>

<script>
  window.addEventListener('DOMContentLoaded', function () {
    for (var i = 1 ; i <= 6 ; i ++) {
      anchors.add('.container .row .col-lg-9 h' + i);
    }
  })
</script>

<div class='container'>
<div class='row body'>
<div class='col-lg-3'>
<div class='sidebar-nav tour'>
<p>
<a href="/security/" class="">Jenkins Security Home</a>
</p>
<strong>
For Administrators
</strong>
<ul>
<li>
<a href="/security/for-administrators/" class="">Overview</a>
</li>
<li>
<a href="/security/advisories/" class="">Security Advisories</a>
</li>
<li>
<a href="/security/issues/" class="">Security Issues</a>
</li>
<li>
<a href="/security/scheduling/" class="">Advisory Schedule</a>
</li>
<li>
<a href="/security/plugins/" class="">Vulnerabilities in Plugins</a>
</li>
<li>
<a href="/security/fixing/" class="">How We Fix Security Issues</a>
</li>
</ul>
<strong>
For Reporters
</strong>
<ul>
<li>
<a href="/security/reporting/" class="">Reporting Vulnerabilities</a>
</li>
<li>
<a href="/security/cna/" class="">Jenkins CNA</a>
</li>
</ul>
<strong>
For Maintainers
</strong>
<ul>
<li>
<a href="/security/for-maintainers/" class="">Overview</a>
</li>
<li>
<a href="/security/plugins/" class="">Vulnerabilities in Plugins</a>
</li>
</ul>
<strong>
Jenkins Security Team
</strong>
<ul>
<li>
<a href="/security/team/" class="">About</a>
</li>
<li>
<a href="/security/improvements/" class="">Contributions</a>
</li>
</ul>
</div>
</div>
<div class='col-lg-9'>
<h1>
Jenkins Security Advisory 2023-09-20
</h1>
<p>
This advisory announces vulnerabilities in the following Jenkins deliverables:
</p>
<p>
<ul>
<li>
Jenkins (core)
</li>
<li>
<a href='https://plugins.jenkins.io/build-failure-analyzer'>
Build Failure Analyzer
Plugin
</a>
</li>
</ul>
</p>
<h2>
Descriptions
</h2>
<h3 id='SECURITY-3261'>
Builds can be filtered by values of sensitive build variables
</h3>
<strong>
SECURITY-3261
/
CVE-2023-43494
</strong>
<br>
<strong>
Severity (CVSS):
</strong>
<a href='https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N'>
Medium
</a>
<br>
<strong>
Description:
</strong>
<div class="paragraph">
<p>Jenkins allows filtering builds in the build history widget by specifying an expression that searches for matching builds by name, description, parameter values, etc.</p>
</div>
<div class="paragraph">
<p>Jenkins 2.50 through 2.423 (both inclusive), LTS 2.60.1 through 2.414.1 (both inclusive) does not exclude sensitive build variables (e.g., password parameter values) from this search.</p>
</div>
<div class="paragraph">
<p>This allows attackers with Item/Read permission to obtain values of sensitive variables used in builds by iteratively testing different characters until the correct sequence is discovered.</p>
</div>
<div class="paragraph">
<p>Jenkins 2.424, LTS 2.414.2 excludes sensitive variables from this search.</p>
</div>
<h3 id='SECURITY-3245'>
Stored XSS vulnerability
</h3>
<strong>
SECURITY-3245
/
CVE-2023-43495
</strong>
<br>
<strong>
Severity (CVSS):
</strong>
<a href='https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:H/I:H/A:H'>
High
</a>
<br>
<strong>
Description:
</strong>
<div class="paragraph">
<p><code>ExpandableDetailsNote</code> allows annotating build log content with additional information that can be revealed when interacted with.</p>
</div>
<div class="paragraph">
<p>Jenkins 2.423 and earlier, LTS 2.414.1 and earlier does not escape the value of the <code>caption</code> constructor parameter of <code>ExpandableDetailsNote</code>.</p>
</div>
<div class="paragraph">
<p>This results in a stored cross-site scripting (XSS) vulnerability exploitable by attackers able to provide <code>caption</code> parameter values.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
As of publication, the related API is not used within Jenkins (core), and the Jenkins security team is not aware of any affected plugins.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Jenkins 2.424, LTS 2.414.2 escapes <code>caption</code> constructor parameter values.</p>
</div>
<h3 id='SECURITY-3072'>
Temporary plugin file created with insecure permissions
</h3>
<strong>
SECURITY-3072
/
CVE-2023-43496
</strong>
<br>
<strong>
Severity (CVSS):
</strong>
<a href='https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H'>
High
</a>
<br>
<strong>
Description:
</strong>
<div class="paragraph">
<p>Jenkins creates a temporary file when a plugin is deployed directly from a URL.</p>
</div>
<div class="paragraph">
<p>Jenkins 2.423 and earlier, LTS 2.414.1 and earlier creates this temporary file in the system temporary directory with the default permissions for newly created files.</p>
</div>
<div class="paragraph">
<p>If these permissions are overly permissive, they may allow attackers with access to the Jenkins controller file system to read and write the file before it is installed in Jenkins, potentially resulting in arbitrary code execution.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
This vulnerability only affects operating systems using a shared temporary directory for all users (typically Linux).
Additionally, the default permissions for newly created files generally only allow attackers to read the temporary file, but not write to it.
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
This issue complements <a href="/security/advisory/2023-03-08/#SECURITY-2823">SECURITY-2823</a>, which affected plugins uploaded from an administrator&#8217;s computer.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Jenkins 2.424, LTS 2.414.2 creates the temporary file in a subdirectory with more restrictive permissions.</p>
</div>
<div class="paragraph">
<p>As a workaround, you can change your default temporary-file directory using the Java system property <code>java.io.tmpdir</code>, if you&#8217;re concerned about this issue but unable to immediately update Jenkins.</p>
</div>
<h3 id='SECURITY-3073'>
Temporary uploaded file created with insecure permissions
</h3>
<strong>
SECURITY-3073
/
CVE-2023-43497 (Stapler), CVE-2023-43498 (MultipartFormDataParser)
</strong>
<br>
<strong>
Severity (CVSS):
</strong>
<a href='https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:L/I:L/A:N'>
Low
</a>
<br>
<strong>
Description:
</strong>
<div class="paragraph">
<p>In Jenkins 2.423 and earlier, LTS 2.414.1 and earlier, uploaded files processed via the Stapler web framework and the Jenkins API <code>MultipartFormDataParser</code> create temporary files in the system temporary directory with the default permissions for newly created files.</p>
</div>
<div class="paragraph">
<p>If these permissions are overly permissive, attackers with access to the system temporary directory may be able to read and write the file before it is used.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
This vulnerability only affects operating systems using a shared temporary directory for all users (typically Linux).
Additionally, the default permissions for newly created files generally only allow attackers to read the temporary file, but not write to it.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Jenkins 2.424, LTS 2.414.2 creates the temporary files in a subdirectory with more restrictive permissions.</p>
</div>
<div class="paragraph">
<p>As a workaround, you can change your default temporary-file directory using the Java system property <code>java.io.tmpdir</code>, if you&#8217;re concerned about this issue but unable to immediately update Jenkins.</p>
</div>
<h3 id='SECURITY-3244'>
Stored XSS vulnerability in Build Failure Analyzer Plugin
</h3>
<strong>
SECURITY-3244
/
CVE-2023-43499
</strong>
<br>
<strong>
Severity (CVSS):
</strong>
<a href='https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:H/I:H/A:H'>
High
</a>
<br>
<strong>
Affected plugin:
<nobr>
<a href='https://plugins.jenkins.io/build-failure-analyzer'>
<code>build-failure-analyzer</code>
</a>
</nobr>
</strong>
<br>
<strong>
Description:
</strong>
<div class="paragraph">
<p>Build Failure Analyzer Plugin 2.4.1 and earlier does not escape Failure Cause names in build logs.</p>
</div>
<div class="paragraph">
<p>This results in a stored cross-site scripting (XSS) vulnerability exploitable by attackers able to create or update Failure Causes.</p>
</div>
<div class="paragraph">
<p>Build Failure Analyzer Plugin 2.4.2 escapes Failure Cause names in build logs.</p>
</div>
<h3 id='SECURITY-3226'>
CSRF vulnerability and missing permission check in Build Failure Analyzer Plugin allow SSRF
</h3>
<strong>
SECURITY-3226
/
CVE-2023-43500 (CSRF), CVE-2023-43501 (missing permission check)
</strong>
<br>
<strong>
Severity (CVSS):
</strong>
<a href='https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:N'>
Medium
</a>
<br>
<strong>
Affected plugin:
<nobr>
<a href='https://plugins.jenkins.io/build-failure-analyzer'>
<code>build-failure-analyzer</code>
</a>
</nobr>
</strong>
<br>
<strong>
Description:
</strong>
<div class="paragraph">
<p>Build Failure Analyzer Plugin 2.4.1 and earlier does not perform a permission check in a connection test HTTP endpoint.</p>
</div>
<div class="paragraph">
<p>This allows attackers with Overall/Read permission to connect to an attacker-specified hostname and port using attacker-specified username and password.</p>
</div>
<div class="paragraph">
<p>Additionally, this HTTP endpoint does not require POST requests, resulting in a cross-site request forgery (CSRF) vulnerability.</p>
</div>
<div class="paragraph">
<p>Build Failure Analyzer Plugin 2.4.2 requires POST requests and Overall/Administer permission for the affected HTTP endpoint.</p>
</div>
<h3 id='SECURITY-3239'>
CSRF vulnerability in Build Failure Analyzer Plugin allows deleting Failure Causes
</h3>
<strong>
SECURITY-3239
/
CVE-2023-43502
</strong>
<br>
<strong>
Severity (CVSS):
</strong>
<a href='https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:L/A:N'>
Medium
</a>
<br>
<strong>
Affected plugin:
<nobr>
<a href='https://plugins.jenkins.io/build-failure-analyzer'>
<code>build-failure-analyzer</code>
</a>
</nobr>
</strong>
<br>
<strong>
Description:
</strong>
<div class="paragraph">
<p>Build Failure Analyzer Plugin 2.4.1 and earlier does not require POST requests for an HTTP endpoint, resulting in a cross-site request forgery (CSRF) vulnerability.</p>
</div>
<div class="paragraph">
<p>This vulnerability allows attackers to delete Failure Causes.</p>
</div>
<div class="paragraph">
<p>Build Failure Analyzer Plugin 2.4.2 requires POST requests for the affected HTTP endpoint.</p>
</div>
<h2>
Severity
</h2>
<ul>
<li>
SECURITY-3072:
<a href='https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H'>
High
</a>
</li>
<li>
SECURITY-3073:
<a href='https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:L/I:L/A:N'>
Low
</a>
</li>
<li>
SECURITY-3226:
<a href='https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:N'>
Medium
</a>
</li>
<li>
SECURITY-3239:
<a href='https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:L/A:N'>
Medium
</a>
</li>
<li>
SECURITY-3244:
<a href='https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:H/I:H/A:H'>
High
</a>
</li>
<li>
SECURITY-3245:
<a href='https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:H/I:H/A:H'>
High
</a>
</li>
<li>
SECURITY-3261:
<a href='https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N'>
Medium
</a>
</li>
</ul>
<h2>
Affected Versions
</h2>
<ul>
<li>
<strong>
Jenkins weekly
</strong>
up to and including
2.423
</li>
<li>
<strong>
Jenkins LTS
</strong>
up to and including
2.414.1
</li>
<li>
<strong>
Build Failure Analyzer
Plugin
</strong>
up to and including
2.4.1
</li>
</ul>
<h2>
Fix
</h2>
<ul>
<li>
<strong>
Jenkins weekly
</strong>
should be updated to version
2.424
</li>
<li>
<strong>
Jenkins LTS
</strong>
should be updated to version
2.414.2
</li>
<li>
<strong>
Build Failure Analyzer
Plugin
</strong>
should be updated to version
2.4.2
</li>
</ul>
<p>
These versions include fixes to the vulnerabilities described above. All prior versions are considered to be affected by these vulnerabilities unless otherwise indicated.
</p>
<h2>
Credit
</h2>
<p>
The Jenkins project would like to thank the reporters for discovering and
<a href='/security/#reporting-vulnerabilities'>
reporting
</a>
these vulnerabilities:
<ul>
<li>
<strong>
Andrea Chiera, CloudBees, Inc.
</strong>
for
SECURITY-3226, SECURITY-3239
</li>
<li>
<strong>
Daniel Beck, CloudBees, Inc.
</strong>
for
SECURITY-3072, SECURITY-3073
</li>
<li>
<strong>
Yaroslav Afenkin, CloudBees, Inc.
</strong>
for
SECURITY-3244, SECURITY-3245
</li>
<li>
<strong>
sunita
</strong>
for
SECURITY-3261
</li>
</ul>
</p>

</div>
</div>
</div>


<script src='/assets/bower/anchor-js/anchor.min.js'></script>
<script src='/assets/bower/@popperjs/core/umd/popper.min.js'></script>
<script src='/assets/bower/bootstrap/js/bootstrap.min.js'></script>
<script src='https://cdn.jsdelivr.net/npm/lit@3.2.1/polyfill-support.js'></script>
<script src='https://cdn.jsdelivr.net/npm/@webcomponents/webcomponentsjs@2.8.0/webcomponents-loader.js'></script>
<script data='ionicons' defer='' src='https://cdnjs.cloudflare.com/ajax/libs/ionicons/7.4.0/ionicons/ionicons.esm.js' type='module'></script>
<script data='ionicons' defer='' nomodule='' src='https://cdnjs.cloudflare.com/ajax/libs/ionicons/7.4.0/ionicons/ionicons.js'></script>
<script defer='' src='https://cdn.jsdelivr.net/npm/@jenkinsci/jenkins-io-components/+esm' type='module'></script>
<script defer='' nomodule='' src='https://cdn.jsdelivr.net/npm/@jenkinsci/jenkins-io-components/'></script>
<jio-footer githubBranch='master' githubRepo='jenkins-infra/jenkins.io' property='https://www.jenkins.io' reportAProblemTemplate='4-bug.yml' sourcePath='content/security/advisory/2023-09-20.adoc'></jio-footer>
<script>
  $(function(){
    var $body = $(document.body);
    $body.on("keydown", function(){
      $body.removeClass("no-outline");
    })
  })
</script>
</body>
</html>
