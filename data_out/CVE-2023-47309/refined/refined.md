Based on the provided content, here's a breakdown of the vulnerability:

**Root Cause:**

- The root cause is the lack of proper input sanitization and output escaping in the "NKM GLS" module for PrestaShop. Specifically, user-supplied data (mobile phone number) is not validated/sanitized before being stored and is not properly escaped when displayed in the back office.

**Weaknesses/Vulnerabilities Present:**

- **Stored Cross-Site Scripting (XSS):** The module is vulnerable to a stored XSS (type 2) attack. Specifically, a malicious payload injected into the `phone_mobile` field is stored in the database and later rendered in the back office without proper escaping.

**Impact of Exploitation:**

- **Arbitrary code execution:** A successful XSS exploit can lead to the execution of malicious JavaScript code within the context of the back office user's session. This can result in:
    - **Account compromise:** Attackers can gain control over the administrator's account
    - **Data theft:** Attackers can steal sensitive information stored in the back office, including customer data, order details, and other confidential information
    - **Back office manipulation:** Attackers can make modifications to the PrestaShop configuration or settings, as well as to manipulate orders
    - **Further attacks:** The attack can be leveraged to infect other users and escalate the scope of the exploit.

**Attack Vectors:**

- **Network-based:** The attack is performed over the network, requiring a user to access a specific vulnerable web page.
- **Input via Front Office:** The XSS payload is injected through the front-office checkout process by manipulating the `gls_customer_mobile` parameter.
- **Output in Back Office:** The stored payload is executed when an admin views order details or a related screen in the back office.

**Required Attacker Capabilities/Position:**

- **Low privilege:** The attacker needs to be an authenticated customer (guest) who is able to access the front-office checkout process.
- **User interaction:** The attacker needs to create a cart, select GLS carrier, input a malicious value for the phone number, and convert this into an order. The administrator needs to then access a specific screen within the back office for the malicious payload to be executed.

**Additional Details:**

- The vulnerability occurs because the `NkmGlsCheckoutModuleFrontController::displayAjaxSavePhoneMobile` method does not properly sanitize the `gls_customer_mobile` parameter.
- The `gls_cart_carrier` table's `phone_mobile` field uses `varchar(255)`, which is large enough to accommodate XSS payloads.
- The back office template doesn't escape the value before rendering it.
- The provided patch includes input validation using `Validate::isPhoneNumber` and output escaping with `|escape:'html':'UTF-8'`.

This information is more detailed than a typical CVE description which often does not include the code examples for vulnerable functions and fixes.