=== Content from portswigger.net_7904000d_20250111_125839.html ===


[Login](/users)

Products

Solutions

[Research](/research)
[Academy](/web-security)
Support

Company

[Customers](/customers)
[About](/about)
[Blog](/blog)
[Careers](/careers)
[Legal](/legal)
[Contact](/contact)
[Resellers](/support/reseller-faqs)

[My account](/users/youraccount)
[Customers](/customers)
[About](/about)
[Blog](/blog)
[Careers](/careers)
[Legal](/legal)
[Contact](/contact)
[Resellers](/support/reseller-faqs)
[![Burp Suite Enterprise Edition](/content/images/svg/icons/enterprise.svg)
**Burp Suite Enterprise Edition**
The enterprise-enabled dynamic web vulnerability scanner.](/burp/enterprise)
[![Burp Suite Professional](/content/images/svg/icons/professional.svg)
**Burp Suite Professional**
The world's #1 web penetration testing toolkit.](/burp/pro)
[![Burp Suite Community Edition](/content/images/svg/icons/community.svg)
**Burp Suite Community Edition**
The best manual tools to start web security testing.](/burp/communitydownload)
[![Dastardly, from Burp Suite](/mega-nav/images/dastardly.svg)
**Dastardly, from Burp Suite**
Free, lightweight web application security scanning for CI/CD.](/burp/dastardly)
[View all product editions](/burp)

[**Burp Scanner**

Burp Suite's web vulnerability scanner

![Burp Suite's web vulnerability scanner'](/mega-nav/images/burp-suite-scanner.jpg)](/burp/vulnerability-scanner)

[**Attack surface visibility**
Improve security posture, prioritize manual testing, free up time.](/solutions/attack-surface-visibility)
[**CI-driven scanning**
More proactive security - find and fix vulnerabilities earlier.](/solutions/ci-driven-scanning)
[**Application security testing**
See how our software enables the world to secure the web.](/solutions)
[**DevSecOps**
Catch critical bugs; ship more secure software, more quickly.](/solutions/devsecops)
[**Penetration testing**
Accelerate penetration testing - find more bugs, more quickly.](/solutions/penetration-testing)
[**Automated scanning**
Scale dynamic scanning. Reduce risk. Save time/money.](/solutions/automated-security-testing)
[**Bug bounty hunting**
Level up your hacking and earn more bug bounties.](/solutions/bug-bounty-hunting)
[**Compliance**
Enhance security monitoring to comply with confidence.](/solutions/compliance)

[View all solutions](/solutions)

[**Product comparison**

What's the difference between Pro and Enterprise Edition?

![Burp Suite Professional vs Burp Suite Enterprise Edition](/mega-nav/images/burp-suite.jpg)](/burp/enterprise/resources/enterprise-edition-vs-professional)

[**Support Center**
Get help and advice from our experts on all things Burp.](/support)
[**Documentation**
Tutorials and guides for Burp Suite.](/burp/documentation)
[**Get Started - Professional**
Get started with Burp Suite Professional.](/burp/documentation/desktop/getting-started)
[**Get Started - Enterprise**
Get started with Burp Suite Enterprise Edition.](/burp/documentation/enterprise/getting-started)
[**User Forum**
Get your questions answered in the User Forum.](https://forum.portswigger.net/)
[**Downloads**
Download the latest version of Burp Suite.](/burp/releases)

[Visit the Support Center](/support)

[**Downloads**

Download the latest version of Burp Suite.

![The latest version of Burp Suite software for download](/mega-nav/images/latest-burp-suite-software-download.jpg)](/burp/releases)

Articles

* [Overview](/research)
* Core Topics

  [Black Hat](/research/black-hat)
  [XSS](/research/cross-site-scripting-research)
  [Request Smuggling](/research/request-smuggling)
  [Template Injection](/research/template-injection)
  [Top 10 Hacking Techniques](/research/top-10-web-hacking-techniques)
* [Articles](/research/articles)
* Meet the Researchers

  [James Kettle](/research/james-kettle)
  [Gareth Heyes](/research/gareth-heyes)
  [Martin Doyhenard](/research/martin-doyhenard)
  [Zakhar Fedotkin](/research/zakhar-fedotkin)
* [Talks](/research/talks)
* [RSS](/research/rss)

# XSS in hidden input fields

![Gareth Heyes](/content/images/profiles/callout_gareth_heyes_114px.png)
### [Gareth Heyes](/research/gareth-heyes)

Researcher

[@garethheyes](https://twitter.com/garethheyes)

* **Published:** 16 November 2015 at 11:25 UTC
* **Updated:** 14 June 2019 at 12:03 UTC

![XSS hidden input fields](/cms/images/6e/96/b9ffb03974c5-article-xss-hidden-input-field-article.png "PortSwigger Ltd")

At PortSwigger, we regularly run pre-release builds of Burp Suite against an internal testbed of popular web applications to make sure it's behaving properly. Whilst doing this recently, [Liam](https://twitter.com/MetalF0X) found a [Cross-Site Scripting](/web-security/cross-site-scripting) ([XSS](/web-security/cross-site-scripting)) vulnerability in [REDACTED], inside a hidden input element:

`<input type="hidden" name="redacted" value="default" injection="xss" />`

XSS in hidden inputs is [frequently very difficult to exploit](https://web.archive.org/web/20130724031616/http%3A//sla.ckers.org/forum/read.php?2,17217) because typical JavaScript events like onmouseover and onfocus can't be triggered due to the element being invisible.

I decided to investigate further to see if it was possible to exploit this on a modern browser. I tried a bunch of stuff like autofocus, CSS tricks and other stuff. Eventually I thought about access keys and wondered if the onclick event would be called on the hidden input when it activated via an access key. It most certainly does on Firefox! This means we can execute an XSS payload inside a hidden attribute, provided you can persuade the victim into pressing the key combination. On Firefox Windows/Linux the key combination is ALT+SHIFT+X and on OS X it is CTRL+ALT+X. You can specify a different key combination using a different key in the access key attribute. Here is the vector:

`<input type="hidden" accesskey="X" onclick="alert(1)">`

This vector isn't ideal because it involves some user interaction, but it's vastly better than expression() which only works on IE<=9. Please note if your reflection is repeated then the key combination will fail. A workaround is to then inject another attribute that breaks the second reflection. e.g. " accesskey="x" onclick="alert(1)" x='

Note: We've reported this vulnerability to the application's security team. However, they haven't responded in any way after 12 days and a couple of emails. We wanted to make people aware of this particular technique, but we won't be naming the vulnerable application concerned until a patch is available.

This [isn't the first time](https://twitter.com/LukasReschke/status/596304014502944769) that [Burp Scanner](/vulnerability-scanner/) has unearthed a vulnerability in an extremely popular web application, and we doubt it will be the last.

### Update - Now works on Chrome and link/meta and any other elements

This technique now works in Chrome! It also works in link elements that means previously unexploitable XSS bugs in link elements where you only control attributes can be exploited using this technique. For example you might have a link element with a rel attribute on canonical, if you inject the accesskey attribute with an onclick event then you have XSS.

`<link rel="canonical" accesskey="X" onclick="alert(1)" />`

[Poc using link elements](http://portswigger-labs.net/link/) (Press ALT+SHIFT+X on Windows) (CTRL+ALT+X on OS X)

Visit our Web Security Academy to [learn more about cross-site scripting (XSS)](https://portswigger.net/web-security/cross-site-scripting)

[XSS](/research/cross-site-scripting-research)

[Back to all articles](/research/articles)

This page requires JavaScript for an enhanced user experience.
## Related Research

[### Bypassing WAFs with the phantom $Version cookie

04 December 2024
Bypassing WAFs with the phantom $Version cookie](/research/bypassing-wafs-with-the-phantom-version-cookie)
[### Concealing payloads in URL credentials

23 October 2024
Concealing payloads in URL credentials](/research/concealing-payloads-in-url-credentials)
[### Exploiting XSS in hidden inputs and meta tags

11 July 2023
Exploiting XSS in hidden inputs and meta tags](/research/exploiting-xss-in-hidden-inputs-and-meta-tags)
[### Bypassing CSP via DOM clobbering

05 June 2023
Bypassing CSP via DOM clobbering](/research/bypassing-csp-via-dom-clobbering)

Burp Suite

[Web vulnerability scanner](/burp/vulnerability-scanner)
[Burp Suite Editions](/burp)
[Release Notes](/burp/releases)

Vulnerabilities

[Cross-site scripting (XSS)](/web-security/cross-site-scripting)
[SQL injection](/web-security/sql-injection)
[Cross-site request forgery](/web-security/csrf)
[XML external entity injection](/web-security/xxe)
[Directory traversal](/web-security/file-path-traversal)
[Server-side request forgery](/web-security/ssrf)

Customers

[Organizations](/organizations)
[Testers](/testers)
[Developers](/developers)

Company

[About](/about)
[Careers](/careers)
[Contact](/about/contact)
[Legal](/legal)
[Privacy Notice](/privacy)

Insights

[Web Security Academy](/web-security)
[Blog](/blog)
[Research](/research)

[![PortSwigger Logo](/content/images/logos/portswigger-logo.svg)](/)
 [Follow us](https://twitter.com/Burp_Suite)

© 2025 PortSwigger Ltd.



=== Content from www.wordfence.com_6acbfb2d_20250111_125840.html ===


[![](https://www.wordfence.com/img/wordfence-intelligence-logo.svg)](/threat-intel/)

Have you found a vulnerability in a WordPress plugin or theme? Report vulnerabilities in WordPress plugins and themes through our [bug bounty program](https://www.wordfence.com/threat-intel/bug-bounty-program) and earn a bounty on all in-scope submissions, while we handle the responsible disclosure process on your behalf.

As a reminder, the Wordfence Intelligence Vulnerability Database API is completely free to query and utilize, both personally and commercially, and contains all the same vulnerability data as the user interface. Please review the API documentation and Webhook documentation for more information on how to query the vulnerability API endpoints and configure webhooks utilizing all the same data present in the Wordfence Intelligence user interface.

# Accept Stripe Payments <= 2.0.86 - Authenticated (Contributor+) Stored Cross-Site Scripting via accept\_stripe\_payment\_ng Shortcode

 [Wordfence Intelligence](https://www.wordfence.com/threat-intel)   >    [Vulnerability Database](https://www.wordfence.com/threat-intel/vulnerabilities)   >   Accept Stripe Payments <= 2.0.86 - Authenticated (Contributor+) Stored Cross-Site Scripting via accept\_stripe\_payment\_ng Shortcode

5.4

**Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')**
**CVSS Vector**
[CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N)

| CVE | [CVE-2024-7353](https://www.cve.org/CVERecord?id=CVE-2024-7353) |
| --- | --- |
| CVSS | 5.4 (Medium) |
| Publicly Published | August 6, 2024 |
| Last Updated | August 7, 2024 |
| Researcher | [Arkadiusz Hydzik](https://www.wordfence.com/threat-intel/vulnerabilities/researchers/arkadiusz-hydzik) |

### Description

The Accept Stripe Payments plugin for WordPress is vulnerable to Stored Cross-Site Scripting via the plugin's accept\_stripe\_payment\_ng shortcode in all versions up to, and including, 2.0.86 due to insufficient input sanitization and output escaping on user supplied attributes. This makes it possible for authenticated attackers, with contributor-level access and above, to inject arbitrary web scripts in pages that will execute whenever a user accesses an injected page.

#### References

* [portswigger.net](https://portswigger.net/research/xss-in-hidden-input-fields)
* [plugins.trac.wordpress.org](https://plugins.trac.wordpress.org/browser/stripe-payments/trunk/includes/shortcodes/class-asp-shortcode-ng.php#L715)
* [wordpress.org](https://wordpress.org/plugins/stripe-payments/#developers)

#### Share

[Facebook](https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fstripe-payments%2Faccept-stripe-payments-2086-authenticated-contributor-stored-cross-site-scripting-via-accept-stripe-payment-ng-shortcode&t=Accept%20Stripe%20Payments%20%3C%3D%202.0.86%20-%20Authenticated%20%28Contributor%2B%29%20Stored%20Cross-Site%20Scripting%20via%20accept_stripe_payment_ng%20Shortcode "Facebook")
[Twitter](https://twitter.com/share?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fstripe-payments%2Faccept-stripe-payments-2086-authenticated-contributor-stored-cross-site-scripting-via-accept-stripe-payment-ng-shortcode&text=Accept%20Stripe%20Payments%20%3C%3D%202.0.86%20-%20Authenticated%20%28Contributor%2B%29%20Stored%20Cross-Site%20Scripting%20via%20accept_stripe_payment_ng%20Shortcode "Twitter")
[LinkedIn](https://www.linkedin.com/shareArticle?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fstripe-payments%2Faccept-stripe-payments-2086-authenticated-contributor-stored-cross-site-scripting-via-accept-stripe-payment-ng-shortcode "LinkedIn")
Email

## Vulnerability Details for Accept Stripe Payments

#### [Accept Stripe Payments](https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/stripe-payments)

| Software Type | Plugin |
| --- | --- |
| Software Slug | stripe-payments [(view on wordpress.org)](https://wordpress.org/plugins/stripe-payments) |
| Patched? | Yes |
| Remediation | Update to version 2.0.87, or a newer patched version |
| Affected Version | * <= 2.0.86 |
| Patched Version | * 2.0.87 |

This record contains material that is subject to copyright.

**Copyright 2012-2025 Defiant Inc.**

**License:**
Defiant hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute this software vulnerability information. Any copy of the software vulnerability information you make for such purposes is authorized provided that you include a hyperlink to this vulnerability record and reproduce Defiant's copyright designation and this license in any such copy.
**[Read more.](https://www.wordfence.com/wordfence-intelligence-terms-and-conditions/)**

**Copyright 1999-2025 The MITRE Corporation**

**License:**
CVE Usage: MITRE hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute Common Vulnerabilities and Exposures (CVE®). Any copy you make for such purposes is authorized provided that you reproduce MITRE's copyright designation and this license in any such copy.
**[Read more.](https://www.cve.org/Legal/TermsOfUse)**

Have information to add, or spot any errors? Contact us at wfi-support@wordfence.com so we can make any appropriate adjustments.

Did you know Wordfence Intelligence provides free personal and commercial API access to our comprehensive WordPress vulnerability database, along with a free webhook integration to stay on top of the latest vulnerabilities added and updated in the database? Get started today!

Learn more

Want to get notified of the latest vulnerabilities that may affect your WordPress site?
 Install Wordfence on your site today to get notified immediately if your site is affected by a vulnerability that has been added to our database.

Get Wordfence

The Wordfence Intelligence WordPress vulnerability database is completely free to access and query via API. Please review the documentation on how to access and consume the vulnerability data via API.

Documentation



=== Content from wordpress.org_4761a21f_20250111_125839.html ===


[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Showcase](https://wordpress.org/showcase/)
* [Hosting](https://wordpress.org/hosting/)
* Extend
  + [Themes](https://wordpress.org/themes/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Blocks](https://wordpress.org/blocks/)
  + [Openverse ↗︎](https://openverse.org/)
* Learn
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* Community
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [Events](https://events.wordpress.org/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* About
  + [About WordPress](https://wordpress.org/about/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
* [Get WordPress](https://wordpress.org/download/)

Search in WordPress.org

[Get WordPress](https://wordpress.org/download/)

[WordPress.org](https://wordpress.org/)

[Plugin Directory](https://wordpress.org/plugins/)

Accept Stripe Payments

* [Submit a plugin](https://wordpress.org/plugins/developers/)
* [My favorites](https://wordpress.org/plugins/browse/favorites/)
* [Log in](https://login.wordpress.org/?redirect_to=https%3A%2F%2Fwordpress.org%2Fplugins%2Fstripe-payments&locale=en_US)

* [Submit a plugin](https://wordpress.org/plugins/developers/)
* [My favorites](https://wordpress.org/plugins/browse/favorites/)
* [Log in](https://login.wordpress.org/?redirect_to=https%3A%2F%2Fwordpress.org%2Fplugins%2Fstripe-payments&locale=en_US)

Search plugins

![](https://ps.w.org/stripe-payments/assets/banner-772x250.png?rev=2705587)
![](https://ps.w.org/stripe-payments/assets/icon-128x128.png?rev=2705524)
# Accept Stripe Payments

By [Tips and Tricks HQ, wptipsntricks](https://www.tipsandtricks-hq.com/)

[Download](https://downloads.wordpress.org/plugin/stripe-payments.2.0.88.zip)

* [Details](https://wordpress.org/plugins/stripe-payments/#description)
* [Reviews](https://wordpress.org/plugins/stripe-payments/#reviews)
* [Installation](https://wordpress.org/plugins/stripe-payments/#installation)
* [Development](https://wordpress.org/plugins/stripe-payments/#developers)

[Support](https://wordpress.org/support/plugin/stripe-payments/)

## Description

The Stripe Payments plugin allows you to accept credit card payments via Stripe payment gateway on your WordPress site easily.

It has a simple shortcode that lets you put Stripe “Buy Now” buttons anywhere on your site for a product or service. You can accept donation via Stripe also.

One click payment via Stripe with a remember me feature. Responsive design so it is compatible with all devices and browsers.

Your customers will be redirected to the “Checkout Result” page after the credit card payment. This page shows them the details of the transaction (the item that they just paid for).

The transaction info is also captured in the orders menu of the plugin. You can view all the payments you received from your WordPress admin dashboard.

#### Setup and Usage Video

#### Checkout Demo Video

#### Features

* Quick installation and setup.
* Easily take payment for a service from your site via Stripe.
* Sell files, digital goods or downloads using your Stripe merchant account.
* Sell music, video, ebook, PDF or any other digital media files.
* The ultimate plugin to create simple Stripe payment buttons.
* Create buy buttons for your products or services on the fly and embed it anywhere on your site using a user-friendly shortcode.
* Ability to add multiple “Buy Now” buttons to a post/page.
* Allow users to automatically download the digital file after the purchase is complete.
* View purchase orders from your WordPress admin dashboard.
* Accept donation on your WordPress site for a cause.
* Create a stripe payment button widget and add it to your sidebar.
* Ability to collect billing and shipping address of the customer.
* Ability to specify a logo or thumbnail image for the item that will get shown in the stripe payment window.
* Ability to customize the Stripe buy now button text from the shortcode.
* Ability to customize the Stripe buy now button appearance using custom CSS code.
* Ability to specify a custom description for the item/product (this info is captured with the order).
* Option to configure a notification email to be sent to the buyer and seller after the purchase.
* There is an option to allow the customer to enter a custom price amount for your product or service (customer pays what they want).
* Option to accept custom donation amount via Stripe payment gateway.
* Option to collect tax for your products (if applicable).
* Option to collect shipping for your tangible products.
* Option to save the card data on Stripe.
* Ability to have custom thank you page on a per product basis.
* Ability to customize the message on the thank you page using tags.
* Ability to customize the price display with currency symbol.
* Ability to use a link URL to create custom payment button for your products.
* Option to send receipt email to your customers from Stripe for each transaction.
* Option to collect a custom input from your customers for products (useful if you are selling products that need special instructions from the customers).
* Stock control option. You can limit the number of quantity available for a product.
* Option to enable Alipay payments. So your customers can pay using their Alipay accounts.
* Option to enable Terms and Conditions that your customers have to accept before they can make a purchase.
* Ability to configure variable products. You can charge different amount for different options of the product.
* Ability to create “Authorize Only” products. You can hold funds on a card then capture it later.
* 3D Secure payments compatible.
* Strong Customer Authentication (SCA) Compliant.

The setup is very easy. Once you have installed the plugin, all you need to do is enter your Stripe API credentials in the plugin settings and your website will be ready to accept credit card payments.

You can run it in test mode by specifying test API keys in the plugin settings.

#### Shortcode Parameters/Attributes

This plugin offers a shortcode and a block that allows you to create a ‘Buy Now’ or ‘Pay’ button for accepting payments.

First, create a product in the plugin’s admin dashboard. Then, use the provided shortcode or block to embed a buy button for that specific product.

[Check this tutorial](https://s-plugins.com/creating-product-stripe-payments-plugin/) for step by step instructions.

#### Detailed Documentation

For detailed documentation and instructions please check the [WordPress Stripe Payments Plugin](https://s-plugins.com/stripe-payments-plugin-tutorials/) documentation page.

## Screenshots

* [![](https://ps.w.org/stripe-payments/assets/screenshot-1.png?rev=3061663)](https://ps.w.org/stripe-payments/assets/screenshot-1.png?rev=3061663)

  Stripe Plugin Settings
* [![](https://ps.w.org/stripe-payments/assets/screenshot-2.png?rev=3061663)](https://ps.w.org/stripe-payments/assets/screenshot-2.png?rev=3061663)

  Stripe Plugin Payment Page
* [![](https://ps.w.org/stripe-payments/assets/screenshot-3.png?rev=3061663)](https://ps.w.org/stripe-payments/assets/screenshot-3.png?rev=3061663)

  Stripe Plugin Orders Menu

## Blocks

This plugin provides 1 block.

* Product Block

## Installation

#### Using The WordPress Dashboard

1. Navigate to “Plugins->Add New” from your dashboard
2. Search for ‘stripe payments’
3. Click ‘Install Now’
4. Activate the plugin

#### Uploading via WordPress Dashboard

1. Navigate to the “Add New” in the plugins dashboard
2. Navigate to the “Upload” area
3. Select `stripe-payments.zip` from your computer
4. Click “Install Now”
5. Activate the plugin in the Plugin dashboard

#### Using FTP

1. Download `stripe-payments.zip`
2. Extract the `stripe-payments` directory on your computer
3. Upload the `stripe-payments` directory to the `/wp-content/plugins/` directory
4. Activate it from the Plugins dashboard

## FAQ

### Can I have multiple payment buttons on a single page?

Yes, you can have any number of buttons on a single page.

### Can I use it in a WordPress Widgets?

Yes, you can.

### Can I specify quantity of the item?

Yes, you can configure it in the product configuration interface.

### Can I change the button label?

Yes, you can specify the “button\_text” attribute in the shortcode to customize it.

### Will the customers receive an email after purchase?

Yes, you can configure the email settings options in the settings menu of the plugin.

### Is it possible to get notified if payment failed for some reason?

Yes. Go to Stripe Payments > Settings, Email Settings tab and check “Send Email On Payment Failure” option.

### Can It be tested before going live?

Yes, please visit Stripe Payments > Settings screen for options.

## Reviews

![](https://secure.gravatar.com/avatar/adee4bef7312deb45a9f1f20a18affe579bd75a4c8539ddfb0002b19b072eac1?s=60&d=retro&r=g)
### [You pay to get updates!](https://wordpress.org/support/topic/you-pay-to-get-updates/)

[Aleks](https://profiles.wordpress.org/kopchev/ "Posts by Aleks")
December 18, 2024
1 reply

The plugin itself is okay, but their policy about updates is wrong. Basically, if you want to get updates of their paid plugins, you have to pay annually. The usual policy for other paid plugins is you pay once and get free updates indefinitely, only support is paid. Imagine this situation: you have paid for a plugin, one year elapses and a security issue or another bug is found. And you are forced to pay because of their bug/security hole.
I have another complaint – they are not polite to customers. They reply in angry, accusative manner to emails when you state your discontent.

![](https://secure.gravatar.com/avatar/9246130ba1a7731f81f3e5de3ce886d85ce5e98b24b686fc80c32906e44eb7d0?s=60&d=retro&r=g)
### [Great Plugin ! I added my own invoices solution](https://wordpress.org/support/topic/great-plugin-i-added-my-own-invoices-solution/)

[murtuzamj](https://profiles.wordpress.org/murtuzamj/ "Posts by murtuzamj")
November 25, 2024
1 reply

The plugins great, it creates payments on Stripe.
I enhanced it with my own php skills to create invoices from the orders it creates and creates a good looking pdf just with a few clicks to review the customer information. I added a few reports to view paid/unpaid invoices. If any one needs the invoices module, please reach out

![](https://secure.gravatar.com/avatar/0671a3eb388c838c41b3c3b92e5835f34f8ff7b6bdbade7d321a48dbfb3400c2?s=60&d=retro&r=g)
### [Left WooCommerce after 10 years](https://wordpress.org/support/topic/left-woocommerce-after-10-years/)

[jgarrett42](https://profiles.wordpress.org/jgarrett42/ "Posts by jgarrett42")
September 14, 2024
4 replies

After starting with WooCommerce and constantly needing to buy add-ons for every new feature I wanted, the costs and complexity just became overwhelming. Switching to Accept Stripe Payments has been a game changer! I can do everything better, cheaper, and faster. The installation was a breeze, product setup is simple and straightforward, and best of all, it’s reliable. I’m never going back to WooCommerce. Highly recommend this plugin to anyone looking for an easier and more cost-effective solution!

![](https://secure.gravatar.com/avatar/6a7cffe06a13e2beda9324fe2a4f737a647ed04a4903fe1705d280dc35424174?s=60&d=retro&r=g)
### [Convenient & Intuitive](https://wordpress.org/support/topic/convenient-intuitive/)

[robin\_dean](https://profiles.wordpress.org/robin_dean/ "Posts by robin_dean")
August 27, 2024
2 replies

This plugin’s been a big help to my brand. Overall, I’m pleased.

![](https://secure.gravatar.com/avatar/cdc29c28350629cfa3a7eb0621fac0faa22eda6378a156cc398c348c53399fbd?s=60&d=retro&r=g)
### [Great Reliable Professional Service](https://wordpress.org/support/topic/great-reliable-professional-service/)

[Ahmed Abd EL Latif](https://profiles.wordpress.org/privategate777/ "Posts by Ahmed Abd EL Latif")
July 28, 2024
1 reply

Great Reliable Professional Service

![](https://secure.gravatar.com/avatar/fd678681619e83f16664f67f6e9f8a821feb4fb64b18976be5bf7d9a987ef989?s=60&d=retro&r=g)
### [Better Than PayPal!](https://wordpress.org/support/topic/better-than-paypal/)

[vgenna](https://profiles.wordpress.org/vgenna/ "Posts by vgenna")
April 24, 2024
1 reply

I am completely satisfied with Stripe payment. In fact, Stripe payment is easier to use than PayPal! I highly recommend using it.

[Read all 107 reviews](https://wordpress.org/support/plugin/stripe-payments/reviews/)
## Contributors & Developers

“Accept Stripe Payments” is open source software. The following people have contributed to this plugin.

Contributors

* ![](https://secure.gravatar.com/avatar/5b95b5333b37765fe6c9cb3969b6e146f408942663415f7309e8a4a3b90ef72c?s=32&d=mm&r=g) [Tips and Tricks HQ](https://profiles.wordpress.org/tips-and-tricks-hq/)
* ![](https://secure.gravatar.com/avatar/2a5519f6bb69050d7cba486e141895aa790ad3f974f6cdf948708b8f707508da?s=32&d=mm&r=g) [wptipsntricks](https://profiles.wordpress.org/wptipsntricks/)
* ![](https://secure.gravatar.com/avatar/50f18a7abc94a3a93b9b142886fe52890be430cbfd89a13be4a05873d118cd40?s=32&d=mm&r=g) [Alexander C.](https://profiles.wordpress.org/alexanderfoxc/)

“Accept Stripe Payments” has been translated into 6 locales. Thank you to [the translators](https://translate.wordpress.org/projects/wp-plugins/stripe-payments/contributors) for their contributions.

[Translate “Accept Stripe Payments” into your language.](https://translate.wordpress.org/projects/wp-plugins/stripe-payments)

### Interested in development?

[Browse the code](https://plugins.trac.wordpress.org/browser/stripe-payments/), check out the [SVN repository](https://plugins.svn.wordpress.org/stripe-payments/), or subscribe to the [development log](https://plugins.trac.wordpress.org/log/stripe-payments/) by [RSS](https://plugins.trac.wordpress.org/log/stripe-payments/?limit=100&mode=stop_on_copy&format=rss).

## Changelog

#### 2.0.88

* Introduced a new option in the Advanced Settings menu to display the “First Name” and “Last Name” fields as separate entries on the checkout/payment form.
* The Orders menu in the plugin now displays the customer’s name within the “Customer Details” section of each order.
* The tax amount for a transaction is now passed to Stripe via the metadata field.
* Added a new action hook ‘asp\_stripe\_process\_ipn\_error’ to allow custom handling of IPN error.
* Updated the update checker addon to be PHP 8.3 compatible.
* Fixed the incorrect use of a sanitization function for the customer name in the dynamic product shortcode.
* Added a 3rd parameter to the ‘shortcode\_atts’ function of the ‘accept\_stripe\_payment\_ng’ shortcode to allow further customization.
* The default ‘Thank You’ page shortcode has been enhanced to display additional checkout details.

#### 2.0.87

* Updated the help text of the “Send Emails in Parallel” feature to explain that this feature is not recommended for most sites as it can have conflict with some server environments.
* Minor adjustment – for trial subscriptions product, the encode function is not used on the email input field.
* Sanitization added to accept\_stripe\_payment\_ng shortcode params.

#### 2.0.86

* Added a new surcharge feature that you can use to collect a transaction surcharge. [documentation for transaction surcharge](https://s-plugins.com/transaction-surcharge-feature-collect-processing-fees-for-products/)
* Added new email merge tags {surcharge\_total\_amt} and {surcharge\_label} to show surcharge data in the email body.
* Added a new filter hook (asp\_ng\_pp\_extra\_output\_before\_closing\_body) in the payment popup window to allow adding custom HTML content before the closing body tag.

#### 2.0.85

* The order item will capture and display the username of the logged-in user, provided the user is logged in at the time of the purchase.
* Added new email merge tag {logged\_in\_user\_name} to capture logged in user’s username (if available).
* Added new filter ‘asp\_get\_logged\_in\_user\_info’ to allow customization of the logged in user info.
* Scaled down the reCAPTCHA badge size using CSS for better mobile screen compatibility.
* Updated the language translation POT file.
* Fixed a price validation bug for checkbox type variation.

#### 2.0.84

* Added a new option to customize the payment button text (in the popup window) on a per product basis.
* Added support for ‘coupon\_code’ query param to apply coupon directly in the product link url feature.
* Corrected the issue causing an error when a product is created or updated with an empty variation group.
* Regional tax variation deletion issue fixed.
* Added support for Custom Fields Addon’s new fields position feature.
* Added an API pre-submission amount validation function.

#### 2.0.83

* Fixed a recent PHP8 related change that caused an issue in the download URL function.

#### 2.0.82

* Fixed an issue with the coupon code delete function.
* Added a new utility function to retrieve the current page URL.
* New action hook in the payment popup window.

#### 2.0.81

* The currency mismatch error message won’t be displayed when the product is configured to use a variable currency.

#### 2.0.80

* Added a currency check when the create payment intent request is made.
* Added more sanitization to the billing\_details object data.

#### 2.0.79

* New shortcode to show available quantity of a product: [asp\_available\_quantity id=”123″]
* Better handling for zip/postal code (when it contains empty space character).
* Some php deprecated warnings has been fixed.
* Fixed a PHP 8.2 related warning.
* Updated the language translation POT file.

#### 2.0.78

* Refactored some lines of code to remove the use of deprecated FILTER\_SANITIZE\_STRING filter.
* PHP 8.2 compatibility.

#### 2.0.77

* Settings UI improvement: the individual captcha configuration fields are now displayed above the transaction rate limiting section.
* New option (Don’t Use Cookie) in the advanced settings menu to disable the use of cookie.

#### 2.0.76

* Improved the sorting by price option in the shop/products page.
* The coupon code option will be enabled by default for variable amount product as well. It can be disabled via the product specific coupon configuration.
* The custom field position for the legacy API option has been removed as it is no longer used.
* Added Bulgarian language option to the checkout language selection field.

#### 2.0.75

* Sorting option added in the shop/products page via shortcode parameter.
* Visitors can also sort the products in the shop page by latest, sort by title, sort by price.
* Updated the integration with Simple Membership plugin.

Full changelog available [at changelog.txt](https://plugins.svn.wordpress.org/stripe-payments/trunk/changelog.txt)

## Meta

* Version **2.0.88**
* Last updated **2 months ago**
* Active installations **20,000+**
* WordPress version **6.0 or higher**
* Tested up to **6.7.1**
* PHP version **7.4 or higher**
* Languages
  See all 7

  Close

  [English (US)](https://wordpress.org/plugins/stripe-payments/), [French (France)](https://fr.wordpress.org/plugins/stripe-payments/), [Spanish (Colombia)](https://es-co.wordpress.org/plugins/stripe-payments/), [Spanish (Ecuador)](https://es-ec.wordpress.org/plugins/stripe-payments/), [Spanish (Mexico)](https://es-mx.wordpress.org/plugins/stripe-payments/), [Spanish (Spain)](https://es.wordpress.org/plugins/stripe-payments/), and [Spanish (Venezuela)](https://ve.wordpress.org/plugins/stripe-payments/).

  [Translate into your language](https://translate.wordpress.org/projects/wp-plugins/stripe-payments)
* Tags [payment](https://wordpress.org/plugins/tags/payment/)[payments](https://wordpress.org/plugins/tags/payments/)[stripe](https://wordpress.org/plugins/tags/stripe/)[stripe gateway](https://wordpress.org/plugins/tags/stripe-gateway/)[stripe payments](https://wordpress.org/plugins/tags/stripe-payments/)
* [Advanced View](https://wordpress.org/plugins/stripe-payments/advanced/)

## Ratings

4.1 out of 5 stars.

* [74 5-star reviews
  5 stars

  74](https://wordpress.org/support/plugin/stripe-payments/reviews/?filter=5)
* [9 4-star reviews
  4 stars

  9](https://wordpress.org/support/plugin/stripe-payments/reviews/?filter=4)
* [3 3-star reviews
  3 stars

  3](https://wordpress.org/support/plugin/stripe-payments/reviews/?filter=3)
* [2 2-star reviews
  2 stars

  2](https://wordpress.org/support/plugin/stripe-payments/reviews/?filter=2)
* [19 1-star reviews
  1 star

  19](https://wordpress.org/support/plugin/stripe-payments/reviews/?filter=1)

[Add my review](https://wordpress.org/support/plugin/stripe-payments/reviews/#new-post)

[See all reviews](https://wordpress.org/support/plugin/stripe-payments/reviews/)

## Contributors

* ![](https://secure.gravatar.com/avatar/5b95b5333b37765fe6c9cb3969b6e146f408942663415f7309e8a4a3b90ef72c?s=32&d=mm&r=g) [Tips and Tricks HQ](https://profiles.wordpress.org/tips-and-tricks-hq/)
* ![](https://secure.gravatar.com/avatar/2a5519f6bb69050d7cba486e141895aa790ad3f974f6cdf948708b8f707508da?s=32&d=mm&r=g) [wptipsntricks](https://profiles.wordpress.org/wptipsntricks/)
* ![](https://secure.gravatar.com/avatar/50f18a7abc94a3a93b9b142886fe52890be430cbfd89a13be4a05873d118cd40?s=32&d=mm&r=g) [Alexander C.](https://profiles.wordpress.org/alexanderfoxc/)
## Support

Issues resolved in last two months:

8 out of 9

[View support forum](https://wordpress.org/support/plugin/stripe-payments/)

## Donate

Would you like to support the advancement of this plugin?

[Donate to this plugin](https://s-plugins.com)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Privacy](https://wordpress.org/about/privacy/)

* [Showcase](https://wordpress.org/showcase/)
* [Themes](https://wordpress.org/themes/)
* [Plugins](https://wordpress.org/plugins/)
* [Patterns](https://wordpress.org/patterns/)

* [Learn](https://learn.wordpress.org/)
* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [WordPress.tv ↗](https://wordpress.tv/)

* [Get Involved](https://make.wordpress.org/)
* [Events](https://events.wordpress.org/)
* [Donate ↗](https://wordpressfoundation.org/donate/)
* [Five for the Future](https://wordpress.org/five-for-the-future/)

* [WordPress.com ↗](https://wordpress.com/?ref=wporg-footer)
* [Matt ↗](https://ma.tt/)
* [bbPress ↗](https://bbpress.org/)
* [BuddyPress ↗](https://buddypress.org/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our X (formerly Twitter) account](https://www.x.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)
* [Visit our YouTube channel](https://www.youtube.com/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)



=== Content from plugins.trac.wordpress.org_9f095d99_20250111_125838.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fbrowser%2Fstripe-payments%2Ftrunk%2Fincludes%2Fshortcodes%2Fclass-asp-shortcode-ng.php)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Revision](/browser/stripe-payments/trunk/includes/shortcodes/class-asp-shortcode-ng.php?rev=3131301 "Revision 3131301")
* Next Revision →
* [Blame](/browser/stripe-payments/trunk/includes/shortcodes/class-asp-shortcode-ng.php?annotate=blame "Annotate each line with the last changed revision (this can be time consuming...)")
* [Revision Log](/log/stripe-payments/trunk/includes/shortcodes/class-asp-shortcode-ng.php)

---

# [source:](/browser?order=name "Go to repository root") [stripe-payments](/browser/stripe-payments?order=name "View stripe-payments")/[trunk](/browser/stripe-payments/trunk?order=name "View trunk")/[includes](/browser/stripe-payments/trunk/includes?order=name "View includes")/[shortcodes](/browser/stripe-payments/trunk/includes/shortcodes?order=name "View shortcodes")/[class-asp-shortcode-ng.php](/browser/stripe-payments/trunk/includes/shortcodes/class-asp-shortcode-ng.php?order=name "View class-asp-shortcode-ng.php")

View diff against:

View revision:

| [Last change](/changeset/3197328/stripe-payments/trunk/includes/shortcodes/class-asp-shortcode-ng.php "View differences") on this file was [3197328](/changeset/3197328/ "View changeset 3197328"), checked in by mra13, [7 weeks ago](/timeline?from=2024-11-26T10%3A56%3A07Z&precision=second "See timeline at 11/26/2024 10:56:07 AM") |
| --- |
| * Introduced a new option in the Advanced Settings menu to display the "First Name" and "Last Name" fields as separate entries on the checkout/payment form. * The Orders menu in the plugin now displays the customer's name within the "Customer Details" section of each order. * The tax amount for a transaction is now passed to Stripe via the metadata field. * Added a new action hook 'asp\_stripe\_process\_ipn\_error' to allow custom handling of IPN error. * Updated the update checker addon to be PHP 8.3 compatible. * Fixed the incorrect use of a sanitization function for the customer name in the dynamic product shortcode. * Added a 3rd parameter to the 'shortcode\_atts' function of the 'accept\_stripe\_payment\_ng' shortcode to allow further customization. * The default 'Thank You' page shortcode has been enhanced to display additional checkout details. |
| **File size:** 30.4 KB | |

| Line |  |
| --- | --- |
| [1](#L1) | <?php |
| [2](#L2) |  |
| [3](#L3) | class ASP\_Shortcode\_NG { |
| [4](#L4) |  |
| [5](#L5) | protected $asp\_main             = null; |
| [6](#L6) | protected $stripe\_css\_inserted  = false; |
| [7](#L7) | protected $product\_css\_inserted = false; |
| [8](#L8) | protected $button\_css\_inserted  = false; |
| [9](#L9) | protected $compat\_mode          = false; |
| [10](#L10) |  |
| [11](#L11) | /\*\* |
| [12](#L12) | \* Instance of this class. |
| [13](#L13) | \* |
| [14](#L14) | \* @var      object |
| [15](#L15) | \*/ |
| [16](#L16) | protected static $instance        = null; |
| [17](#L17) | protected static $payment\_buttons = array(); |
| [18](#L18) |  |
| [19](#L19) | public function \_\_construct() { |
| [20](#L20) | self::$instance = $this; |
| [21](#L21) |  |
| [22](#L22) | $this->asp\_main = AcceptStripePayments::get\_instance(); |
| [23](#L23) |  |
| [24](#L24) | $use\_old\_api = $this->asp\_main->get\_setting( 'use\_old\_checkout\_api1' ); |
| [25](#L25) | $use\_old\_api = 0; |
| [26](#L26) |  |
| [27](#L27) | add\_action( 'wp\_enqueue\_scripts', array( $this, 'enqueue\_scripts' ) ); |
| [28](#L28) |  |
| [29](#L29) | add\_shortcode( 'asp\_product\_ng', array( $this, 'shortcode\_asp\_product' ) ); |
| [30](#L30) | add\_shortcode( 'accept\_stripe\_payment\_ng', array( $this, 'shortcode\_accept\_stripe\_payment' ) ); |
| [31](#L31) | if ( ! $use\_old\_api ) { |
| [32](#L32) | add\_shortcode( 'asp\_product', array( $this, 'shortcode\_asp\_product' ) ); |
| [33](#L33) | add\_shortcode( 'accept\_stripe\_payment', array( $this, 'shortcode\_accept\_stripe\_payment' ) ); |
| [34](#L34) | add\_filter( 'the\_content', array( $this, 'filter\_post\_type\_content' ) ); |
| [35](#L35) | } |
| [36](#L36) | } |
| [37](#L37) |  |
| [38](#L38) | public function enqueue\_scripts() { |
| [39](#L39) | wp\_register\_style( 'asp-default-style', WP\_ASP\_PLUGIN\_URL . '/public/views/templates/default/style.css', array(), WP\_ASP\_PLUGIN\_VERSION ); |
| [40](#L40) |  |
| [41](#L41) | wp\_register\_style( 'asp-stripe-button-css', 'https://checkout.stripe.com/v3/checkout/button.css' ); |
| [42](#L42) | } |
| [43](#L43) |  |
| [44](#L44) | public static function filter\_post\_type\_content( $content ) { |
| [45](#L45) | global $post; |
| [46](#L46) | if ( isset( $post ) ) { |
| [47](#L47) | if ( ASPMain::$products\_slug === $post->post\_type ) { //Handle the content for product type post |
| [48](#L48) | return do\_shortcode( '[asp\_product id="' . $post->ID . '" is\_post\_tpl="1" in\_the\_loop="' . + in\_the\_loop() . '"]' ); |
| [49](#L49) | } |
| [50](#L50) | } |
| [51](#L51) | return $content; |
| [52](#L52) | } |
| [53](#L53) |  |
| [54](#L54) | /\*\* |
| [55](#L55) | \* Return an instance of this class. |
| [56](#L56) | \* |
| [57](#L57) | \* @since     1.0.0 |
| [58](#L58) | \* |
| [59](#L59) | \* @return    object    A single instance of this class. |
| [60](#L60) | \*/ |
| [61](#L61) | public static function get\_instance() { |
| [62](#L62) | // If the single instance hasn't been set, set it now. |
| [63](#L63) | if ( null === self::$instance ) { |
| [64](#L64) | self::$instance = new self(); |
| [65](#L65) | } |
| [66](#L66) |  |
| [67](#L67) | return self::$instance; |
| [68](#L68) | } |
| [69](#L69) |  |
| [70](#L70) | private function gen\_fatal\_error\_box( $msg ) { |
| [71](#L71) | $error\_msg  = '<div class="stripe\_payments\_error\_msg" style="color: red;">'; |
| [72](#L72) | $error\_msg .= $msg; |
| [73](#L73) | $error\_msg .= '</div>'; |
| [74](#L74) | return $error\_msg; |
| [75](#L75) | } |
| [76](#L76) |  |
| [77](#L77) | public function shortcode\_asp\_product( $atts ) { |
| [78](#L78) | if ( ! isset( $atts['id'] ) || ! is\_numeric( $atts['id'] ) ) { |
| [79](#L79) | $msg       = \_\_( 'Error: product ID is invalid.', 'stripe-payments' ); |
| [80](#L80) | $error\_msg = $this->gen\_fatal\_error\_box( $msg ); |
| [81](#L81) | return $error\_msg; |
| [82](#L82) | } |
| [83](#L83) |  |
| [84](#L84) | $id   = $atts['id']; |
| [85](#L85) | $item = new ASP\_Product\_Item( $id ); |
| [86](#L86) |  |
| [87](#L87) | $last\_error = $item->get\_last\_error(); |
| [88](#L88) |  |
| [89](#L89) | if ( $last\_error ) { |
| [90](#L90) | $error\_msg = $this->gen\_fatal\_error\_box( $last\_error ); |
| [91](#L91) | return $error\_msg; |
| [92](#L92) | } |
| [93](#L93) |  |
| [94](#L94) | $plan\_id = get\_post\_meta( $id, 'asp\_sub\_plan\_id', true ); |
| [95](#L95) |  |
| [96](#L96) | if ( ! empty( $plan\_id ) && ! class\_exists( 'ASPSUB\_main' ) ) { |
| [97](#L97) | //Subs addon not installed or disabled. Show corresponding error message |
| [98](#L98) | $error\_msg = $this->gen\_fatal\_error\_box( \_\_( 'This product requires Stripe Payments Subscription addon.' ) ); |
| [99](#L99) | return $error\_msg; |
| [100](#L100) | } |
| [101](#L101) |  |
| [102](#L102) | if ( ! empty( $plan\_id ) && class\_exists( 'ASPSUB\_main' ) && version\_compare( ASPSUB\_main::ADDON\_VER, '2.0.0t1' ) < 0 ) { |
| [103](#L103) | $error\_msg = $this->gen\_fatal\_error\_box( 'Stripe Subscriptions addon version 2.0.0 or newer is required.' ); |
| [104](#L104) | return $error\_msg; |
| [105](#L105) | } |
| [106](#L106) |  |
| [107](#L107) | $currency = $item->get\_currency(); |
| [108](#L108) |  |
| [109](#L109) | $button\_text = $item->get\_button\_text(); |
| [110](#L110) |  |
| [111](#L111) | //check if we have button\_text shortcode parameter. If it's not empty, this should be our button text |
| [112](#L112) | if ( isset( $atts['button\_text'] ) && ! empty( $atts['button\_text'] ) ) { |
| [113](#L113) | $button\_text = esc\_attr( $atts['button\_text'] ); |
| [114](#L114) | } |
| [115](#L115) |  |
| [116](#L116) | $thumb\_img = ''; |
| [117](#L117) | $thumb\_url = get\_post\_meta( $id, 'asp\_product\_thumbnail', true ); |
| [118](#L118) |  |
| [119](#L119) | if ( $thumb\_url ) { |
| [120](#L120) | if ( is\_ssl() ) { |
| [121](#L121) | $thumb\_url = ASP\_Utils::url\_to\_https( $thumb\_url ); |
| [122](#L122) | } |
| [123](#L123) | $thumb\_img = '<img src="' . $thumb\_url . '">'; |
| [124](#L124) | } |
| [125](#L125) |  |
| [126](#L126) | $url = get\_post\_meta( $id, 'asp\_product\_upload', true ); |
| [127](#L127) |  |
| [128](#L128) | if ( ! $url ) { |
| [129](#L129) | $url = ''; |
| [130](#L130) | } |
| [131](#L131) |  |
| [132](#L132) | $template\_name = 'default'; //this could be made configurable |
| [133](#L133) | $button\_color  = 'blue'; //this could be made configurable |
| [134](#L134) |  |
| [135](#L135) | $price = $item->get\_price(); |
| [136](#L136) | $shipping = $item->get\_shipping(); |
| [137](#L137) |  |
| [138](#L138) | $surcharge\_label = $item->get\_surcharge\_label(); |
| [139](#L139) | $surcharge\_total = $item->calculate\_total\_surcharge(); |
| [140](#L140) | //Trigger filter so addons can modify surcharge total |
| [141](#L141) | $surcharge\_total = apply\_filters('asp\_ng\_modify\_surcharge\_total', $surcharge\_total, $currency); |
| [142](#L142) |  |
| [143](#L143) | //let's apply filter so addons can change price, currency and shipping if needed |
| [144](#L144) | $price\_arr = array( |
| [145](#L145) | 'price'    => $price, |
| [146](#L146) | 'currency' => $currency, |
| [147](#L147) | 'shipping' => empty( $shipping ) ? false : $shipping, |
| [148](#L148) | ); |
| [149](#L149) | $price\_arr = apply\_filters( 'asp\_ng\_modify\_price\_currency\_shipping', $price\_arr ); |
| [150](#L150) | extract( $price\_arr, EXTR\_OVERWRITE ); |
| [151](#L151) |  |
| [152](#L152) | $buy\_btn = ''; |
| [153](#L153) |  |
| [154](#L154) | $button\_class = $item->get\_button\_class(); |
| [155](#L155) |  |
| [156](#L156) | $class = ! empty( $button\_class ) ? $button\_class : 'asp\_product\_buy\_btn ' . $button\_color; |
| [157](#L157) |  |
| [158](#L158) | $class = isset( $atts['class'] ) ? $atts['class'] : $class; |
| [159](#L159) |  |
| [160](#L160) | $custom\_field = get\_post\_meta( $id, 'asp\_product\_custom\_field', true ); |
| [161](#L161) | $cf\_enabled   = $this->asp\_main->get\_setting( 'custom\_field\_enabled' ); |
| [162](#L162) |  |
| [163](#L163) | if ( ( '' === $custom\_field ) || '2' === $custom\_field ) { |
| [164](#L164) | $custom\_field = $cf\_enabled; |
| [165](#L165) | } else { |
| [166](#L166) | $custom\_field = intval( $custom\_field ); |
| [167](#L167) | } |
| [168](#L168) |  |
| [169](#L169) | if ( ! $cf\_enabled ) { |
| [170](#L170) | $custom\_field = $cf\_enabled; |
| [171](#L171) | } |
| [172](#L172) |  |
| [173](#L173) | $thankyou\_page = empty( $atts['thankyou\_page\_url'] ) ? get\_post\_meta( $id, 'asp\_product\_thankyou\_page', true ) : $atts['thankyou\_page\_url']; |
| [174](#L174) |  |
| [175](#L175) | if ( ! $shipping ) { |
| [176](#L176) | $shipping = 0; |
| [177](#L177) | } |
| [178](#L178) |  |
| [179](#L179) | $tax = isset( $atts['tax'] ) ? $atts['tax'] : $item->get\_tax(); |
| [180](#L180) |  |
| [181](#L181) | if ( ! $tax || $tax < 0 ) { |
| [182](#L182) | $tax = 0; |
| [183](#L183) | } |
| [184](#L184) |  |
| [185](#L185) | if ( isset( $atts['tax'] ) ) { |
| [186](#L186) | //save tax overidden data to session |
| [187](#L187) | $uniq\_id = uniqid( 'asp\_button', true ); |
| [188](#L188) | $sess = ASP\_Session::get\_instance(); |
| [189](#L189) | $sess->set\_transient\_data( 'overriden\_data\_' . $uniq\_id, array( 'tax' => $tax ) ); |
| [190](#L190) | } |
| [191](#L191) |  |
| [192](#L192) | $quantity = $item->get\_quantity(); |
| [193](#L193) |  |
| [194](#L194) | $under\_price\_line = ''; |
| [195](#L195) | $tot\_price = ! empty( $quantity ) ? $price \* $quantity : $price; |
| [196](#L196) |  |
| [197](#L197) | if ( 0 !== $tax ) { |
| [198](#L198) | $tax\_str = apply\_filters( 'asp\_customize\_text\_msg', \_\_( 'Tax', 'stripe-payments' ), 'tax\_str' ); |
| [199](#L199) | if ( ! empty( $price ) ) { |
| [200](#L200) | $tax\_amount       = AcceptStripePayments::get\_tax\_amount( $tot\_price, $tax, AcceptStripePayments::is\_zero\_cents( $currency ) ); |
| [201](#L201) | $tot\_price       += $tax\_amount; |
| [202](#L202) | $under\_price\_line = '<span class="asp\_price\_tax\_section">' . AcceptStripePayments::formatted\_price( $tax\_amount, $currency ) . ' (' . strtolower( $tax\_str ) . ')</span>'; |
| [203](#L203) | } else { |
| [204](#L204) | $under\_price\_line = '<span class="asp\_price\_tax\_section">' . $tax . '% ' . lcfirst( $tax\_str ) . '</span>'; |
| [205](#L205) | } |
| [206](#L206) | } |
| [207](#L207) | if ( 0 !== $shipping ) { |
| [208](#L208) | $ship\_str = apply\_filters( 'asp\_customize\_text\_msg', \_\_( 'Shipping', 'stripe-payments' ), 'shipping\_str' ); |
| [209](#L209) | $tot\_price += $shipping; |
| [210](#L210) | $shipping\_line = AcceptStripePayments::formatted\_price( $shipping, $currency ) . ' (' . strtolower( $ship\_str ) . ')'; |
| [211](#L211) | if ( ! empty( $under\_price\_line ) ) { |
| [212](#L212) | $under\_price\_line .= '<span class="asp\_price\_shipping\_section"> + ' . $shipping\_line . '</span>'; |
| [213](#L213) | } else { |
| [214](#L214) | $under\_price\_line = '<span class="asp\_price\_shipping\_section">' . $shipping\_line . '</span>'; |
| [215](#L215) | } |
| [216](#L216) | } |
| [217](#L217) |  |
| [218](#L218) | if ( !empty( $surcharge\_total ) ){ |
| [219](#L219) | $tot\_price += $surcharge\_total; |
| [220](#L220) |  |
| [221](#L221) | $surcharge\_line = '<div class="asp\_price\_surcharge\_section">'. $surcharge\_label . ': '; |
| [222](#L222) | $surcharge\_line .= '<span class="asp\_price\_surcharge\_amount">' . AcceptStripePayments::formatted\_price( $surcharge\_total, $currency ) . '</span>'; |
| [223](#L223) | $surcharge\_line .= '</div>'; |
| [224](#L224) |  |
| [225](#L225) | $under\_price\_line .= $surcharge\_line; |
| [226](#L226) | } |
| [227](#L227) |  |
| [228](#L228) | if ( ! empty( $price ) && ! empty( $under\_price\_line ) ) { |
| [229](#L229) | $under\_price\_line .= '<div class="asp\_price\_full\_total">' . \_\_( 'Total:', 'stripe-payments' ) . ' <span class="asp\_tot\_current\_price">' . AcceptStripePayments::formatted\_price( $tot\_price, $currency ) . '</span> <span class="asp\_tot\_new\_price"></span></div>'; |
| [230](#L230) | } |
| [231](#L231) |  |
| [232](#L232) | if ( get\_post\_meta( $id, 'asp\_product\_no\_popup\_thumbnail', true ) !== 1 ) { |
| [233](#L233) | $item\_logo = ASP\_Utils::get\_small\_product\_thumb( $id ); |
| [234](#L234) | } else { |
| [235](#L235) | $item\_logo = ''; |
| [236](#L236) | } |
| [237](#L237) |  |
| [238](#L238) | $compat\_mode = isset( $atts['compat\_mode'] ) ? 1 : 0; |
| [239](#L239) |  |
| [240](#L240) | $this->compat\_mode = ( $compat\_mode ) ? true : false; |
| [241](#L241) |  |
| [242](#L242) | $billing\_address  = get\_post\_meta( $id, 'asp\_product\_collect\_billing\_addr', true ); |
| [243](#L243) | $shipping\_address = get\_post\_meta( $id, 'asp\_product\_collect\_shipping\_addr', true ); |
| [244](#L244) |  |
| [245](#L245) | if ( ! $billing\_address ) { |
| [246](#L246) | $shipping\_address = false; |
| [247](#L247) | } |
| [248](#L248) |  |
| [249](#L249) | $currency\_variable = $item->is\_currency\_variable(); |
| [250](#L250) |  |
| [251](#L251) | //Let's only output buy button if we're in the loop. Since the\_content hook could be called several times (for example, by a plugin like Yoast SEO for its purposes), we should only output the button only when it's actually needed. |
| [252](#L252) | if ( ! isset( $atts['in\_the\_loop'] ) || '1' === $atts['in\_the\_loop'] ) { |
| [253](#L253) | $sc\_params = array( |
| [254](#L254) | 'product\_id'        => $id, |
| [255](#L255) | 'name'              => $item->get\_name(), |
| [256](#L256) | 'price'             => $price, |
| [257](#L257) | 'currency'          => $currency, |
| [258](#L258) | 'currency\_variable' => $currency\_variable, |
| [259](#L259) | 'shipping'          => $shipping, |
| [260](#L260) | 'tax'               => $tax, |
| [261](#L261) | 'class'             => $class, |
| [262](#L262) | 'quantity'          => get\_post\_meta( $id, 'asp\_product\_quantity', true ), |
| [263](#L263) | 'custom\_quantity'   => get\_post\_meta( $id, 'asp\_product\_custom\_quantity', true ), |
| [264](#L264) | 'button\_text'       => $button\_text, |
| [265](#L265) | 'description'       => get\_post\_meta( $id, 'asp\_product\_description', true ), |
| [266](#L266) | 'thankyou\_page\_url' => $thankyou\_page, |
| [267](#L267) | 'item\_logo'         => $item\_logo, |
| [268](#L268) | 'billing\_address'   => $billing\_address, |
| [269](#L269) | 'shipping\_address'  => $shipping\_address, |
| [270](#L270) | 'custom\_field'      => $custom\_field, |
| [271](#L271) | 'compat\_mode'       => $compat\_mode, |
| [272](#L272) | 'button\_only'       => isset( $atts['button\_only'] ) ? intval( $atts['button\_only'] ) : null, |
| [273](#L273) | 'btn\_uniq\_id'       => isset( $uniq\_id ) ? $uniq\_id : '', |
| [274](#L274) | ); |
| [275](#L275) | //this would pass additional shortcode parameters from asp\_product shortcode |
| [276](#L276) | $sc\_params = array\_merge( $atts, $sc\_params ); |
| [277](#L277) | $buy\_btn   = $this->shortcode\_accept\_stripe\_payment( $sc\_params ); |
| [278](#L278) | } |
| [279](#L279) |  |
| [280](#L280) | if ( ! isset( $sc\_params['button\_only'] ) ) { |
| [281](#L281) | $button\_only = get\_post\_meta( $id, 'asp\_product\_button\_only', true ); |
| [282](#L282) | } else { |
| [283](#L283) | $button\_only = $sc\_params['button\_only']; |
| [284](#L284) | } |
| [285](#L285) |  |
| [286](#L286) | if ( ( isset( $atts['fancy'] ) && empty( $atts['fancy'] ) ) || $button\_only ) { |
| [287](#L287) | //Just show the stripe payment button (no fancy template) |
| [288](#L288) | $tpl = '<div class="asp\_product\_buy\_button">' . $buy\_btn . '</div>'; |
| [289](#L289) | wp\_enqueue\_style( 'asp-default-style' ); |
| [290](#L290) | if ( ! $this->compat\_mode ) { |
| [291](#L291) | $this->product\_css\_inserted = true; |
| [292](#L292) | } |
| [293](#L293) | return $tpl; |
| [294](#L294) | } |
| [295](#L295) |  |
| [296](#L296) | //Show the stripe payment button with fancy style template. |
| [297](#L297) | require\_once WP\_ASP\_PLUGIN\_PATH . 'public/views/templates/' . $template\_name . '/template.php'; |
| [298](#L298) | if ( isset( $atts['is\_post\_tpl'] ) ) { |
| [299](#L299) | $tpl = asp\_get\_post\_template( $this->product\_css\_inserted ); |
| [300](#L300) | } else { |
| [301](#L301) | $tpl = asp\_get\_template( $this->product\_css\_inserted ); |
| [302](#L302) | } |
| [303](#L303) | if ( ! $this->compat\_mode ) { |
| [304](#L304) | $this->product\_css\_inserted = true; |
| [305](#L305) | } |
| [306](#L306) |  |
| [307](#L307) | $price\_line = empty( $price ) ? '' : AcceptStripePayments::formatted\_price( $price, $currency ); |
| [308](#L308) |  |
| [309](#L309) | $qnt\_str = ''; |
| [310](#L310) | if ( $quantity && 1 > $quantity ) { |
| [311](#L311) | $qnt\_str = 'x ' . $quantity; |
| [312](#L312) | } |
| [313](#L313) |  |
| [314](#L314) | remove\_filter( 'the\_content', array( $this, 'filter\_post\_type\_content' ) ); |
| [315](#L315) | $post = get\_post( $id ); |
| [316](#L316) | setup\_postdata( $post ); |
| [317](#L317) | $GLOBALS['post'] = $post; |
| [318](#L318) | $descr           = $post->post\_content; |
| [319](#L319) | global $wp\_embed; |
| [320](#L320) | if ( isset( $wp\_embed ) && is\_object( $wp\_embed ) ) { |
| [321](#L321) | if ( method\_exists( $wp\_embed, 'autoembed' ) ) { |
| [322](#L322) | $descr = $wp\_embed->autoembed( $descr ); |
| [323](#L323) | } |
| [324](#L324) | if ( method\_exists( $wp\_embed, 'run\_shortcode' ) ) { |
| [325](#L325) | $descr = $wp\_embed->run\_shortcode( $descr ); |
| [326](#L326) | } |
| [327](#L327) | } |
| [328](#L328) | $descr = wpautop( do\_shortcode( $descr ) ); |
| [329](#L329) | wp\_reset\_postdata(); |
| [330](#L330) | add\_filter( 'the\_content', array( $this, 'filter\_post\_type\_content' ) ); |
| [331](#L331) |  |
| [332](#L332) | $product\_tags = array( |
| [333](#L333) | 'thumb\_img'        => $thumb\_img, |
| [334](#L334) | 'quantity'         => esc\_attr( $qnt\_str ), |
| [335](#L335) | 'name'             => $post->post\_title, |
| [336](#L336) | 'description'      => $descr, |
| [337](#L337) | 'price'            => esc\_attr( $price\_line ), |
| [338](#L338) | 'under\_price\_line' => wp\_kses( $under\_price\_line, ASP\_Utils::asp\_allowed\_tags() ), |
| [339](#L339) | 'buy\_btn'          => $buy\_btn, |
| [340](#L340) | ); |
| [341](#L341) |  |
| [342](#L342) | $product\_tags = apply\_filters( 'asp\_product\_tpl\_tags\_arr', $product\_tags, $id ); |
| [343](#L343) |  |
| [344](#L344) | foreach ( $product\_tags as $tag => $repl ) { |
| [345](#L345) | $tpl = str\_replace( '%\_' . $tag . '\_%', $repl, $tpl ); |
| [346](#L346) | } |
| [347](#L347) |  |
| [348](#L348) | return $tpl; |
| [349](#L349) | } |
| [350](#L350) |  |
| [351](#L351) | public function shortcode\_accept\_stripe\_payment( $atts ) { |
| [352](#L352) | //Note: It will create a product dynamically using the (ASPMain::$temp\_prod\_slug) custom post type. |
| [353](#L353) |  |
| [354](#L354) | $sc\_attrs = shortcode\_atts( |
| [355](#L355) | array( |
| [356](#L356) | 'product\_id'        => 0, |
| [357](#L357) | 'name'              => '', |
| [358](#L358) | 'class'             => 'stripe-button-el', //default Stripe button class |
| [359](#L359) | 'price'             => '0', |
| [360](#L360) | 'shipping'          => 0, |
| [361](#L361) | 'tax'               => 0, |
| [362](#L362) | 'quantity'          => '', |
| [363](#L363) | 'custom\_quantity'   => false, |
| [364](#L364) | 'description'       => '', |
| [365](#L365) | 'url'               => '', |
| [366](#L366) | 'thankyou\_page\_url' => '', |
| [367](#L367) | 'item\_logo'         => '', |
| [368](#L368) | 'billing\_address'   => '', |
| [369](#L369) | 'shipping\_address'  => '', |
| [370](#L370) | 'customer\_email'    => '', |
| [371](#L371) | 'customer\_name'     => '', |
| [372](#L372) | 'currency'          => $this->asp\_main->get\_setting( 'currency\_code' ), |
| [373](#L373) | 'currency\_variable' => false, |
| [374](#L374) | 'checkout\_lang'     => $this->asp\_main->get\_setting( 'checkout\_lang' ), |
| [375](#L375) | 'button\_text'       => $this->asp\_main->get\_setting( 'button\_text' ), |
| [376](#L376) | 'compat\_mode'       => 0, |
| [377](#L377) | ), |
| [378](#L378) | $atts, |
| [379](#L379) | 'asp\_accept\_stripe\_payment\_atts', /\* Provided for context to enable filtering \*/ |
| [380](#L380) | ); |
| [381](#L381) |  |
| [382](#L382) | $product\_id        = absint(sanitize\_text\_field( $sc\_attrs['product\_id'] )); |
| [383](#L383) | $name              = sanitize\_text\_field( $sc\_attrs['name'] ); |
| [384](#L384) | $class             = sanitize\_text\_field( $sc\_attrs['class'] ); |
| [385](#L385) | $price             = floatval(sanitize\_text\_field( $sc\_attrs['price'] )); |
| [386](#L386) | $shipping          = floatval(sanitize\_text\_field( $sc\_attrs['shipping'] )); |
| [387](#L387) | $tax               = floatval(sanitize\_text\_field( $sc\_attrs['tax'] )); |
| [388](#L388) | $quantity          = absint(sanitize\_text\_field( $sc\_attrs['quantity'] )); |
| [389](#L389) | $custom\_quantity   = sanitize\_text\_field( $sc\_attrs['custom\_quantity'] ); |
| [390](#L390) | $description       = sanitize\_text\_field( $sc\_attrs['description'] ); |
| [391](#L391) | $url               = sanitize\_url( $sc\_attrs['url'] ); |
| [392](#L392) | $thankyou\_page\_url = sanitize\_url( $sc\_attrs['thankyou\_page\_url'] ); |
| [393](#L393) | $item\_logo         = sanitize\_url( $sc\_attrs['item\_logo'] ); |
| [394](#L394) | $billing\_address   = sanitize\_text\_field( $sc\_attrs['billing\_address'] ); |
| [395](#L395) | $shipping\_address  = sanitize\_text\_field( $sc\_attrs['shipping\_address'] ); |
| [396](#L396) | $customer\_email    = sanitize\_email( $sc\_attrs['customer\_email'] ); |
| [397](#L397) | $customer\_name     = sanitize\_text\_field( $sc\_attrs['customer\_name'] ); |
| [398](#L398) | $currency          = sanitize\_text\_field( $sc\_attrs['currency'] ); |
| [399](#L399) | $currency\_variable = sanitize\_text\_field( $sc\_attrs['currency\_variable'] ); |
| [400](#L400) | $checkout\_lang     = sanitize\_text\_field( $sc\_attrs['checkout\_lang'] ); |
| [401](#L401) | $button\_text       = sanitize\_text\_field( $sc\_attrs['button\_text'] ); |
| [402](#L402) | $compat\_mode       = sanitize\_text\_field( $sc\_attrs['compat\_mode'] ); |
| [403](#L403) |  |
| [404](#L404) | $this->compat\_mode = ( $compat\_mode ) ? true : false; |
| [405](#L405) |  |
| [406](#L406) | if ( empty( $name ) ) { |
| [407](#L407) | $error\_msg  = '<div class="stripe\_payments\_error\_msg" style="color: red;">'; |
| [408](#L408) | $error\_msg .= 'There is an error in your Stripe Payments shortcode. It is missing the "name" field. '; |
| [409](#L409) | $error\_msg .= 'You must specify an item name value using the "name" parameter. This value should be unique so this item can be identified uniquely on the page.'; |
| [410](#L410) | $error\_msg .= '</div>'; |
| [411](#L411) | return $error\_msg; |
| [412](#L412) | } |
| [413](#L413) |  |
| [414](#L414) | if ( ! empty( $url ) ) { |
| [415](#L415) | $url = base64\_encode( $url ); |
| [416](#L416) | } else { |
| [417](#L417) | $url = ''; |
| [418](#L418) | } |
| [419](#L419) |  |
| [420](#L420) | if ( ! empty( $thankyou\_page\_url ) ) { |
| [421](#L421) | $thankyou\_page\_url = base64\_encode( $thankyou\_page\_url ); |
| [422](#L422) | } else { |
| [423](#L423) | $thankyou\_page\_url = ''; |
| [424](#L424) | } |
| [425](#L425) |  |
| [426](#L426) | if ( ! is\_numeric( $quantity ) ) { |
| [427](#L427) | $quantity = absint( $quantity ); |
| [428](#L428) | } |
| [429](#L429) |  |
| [430](#L430) | if ( empty( $quantity ) && '1' !== $custom\_quantity ) { |
| [431](#L431) | $quantity = 1; |
| [432](#L432) | } |
| [433](#L433) |  |
| [434](#L434) | $price                   = floatval( $price ); |
| [435](#L435) | $uniq\_id                 = count( self::$payment\_buttons ) . uniqid(); |
| [436](#L436) | $button\_id               = 'asp\_ng\_button\_' . $uniq\_id; |
| [437](#L437) | self::$payment\_buttons[] = $button\_id; |
| [438](#L438) |  |
| [439](#L439) | $item\_price     = $price; |
| [440](#L440) | $payment\_amount = $custom\_quantity ? $price : floatval( $price ) \* $quantity; |
| [441](#L441) | if ( AcceptStripePayments::is\_zero\_cents( $currency ) ) { |
| [442](#L442) | //this is zero-cents currency, amount shouldn't be multiplied by 100 |
| [443](#L443) | $price\_in\_cents = $payment\_amount; |
| [444](#L444) | } else { |
| [445](#L445) | $price\_in\_cents = $payment\_amount \* 100; |
| [446](#L446) | $item\_price     = $price \* 100; |
| [447](#L447) | } |
| [448](#L448) |  |
| [449](#L449) | if ( ! empty( $shipping ) ) { |
| [450](#L450) | $shipping\_filt = round( $shipping, 2 ); |
| [451](#L451) | if ( ! AcceptStripePayments::is\_zero\_cents( $currency ) ) { |
| [452](#L452) | $shipping = $shipping\_filt \* 100; |
| [453](#L453) | } else { |
| [454](#L454) | $shipping = $shipping\_filt; |
| [455](#L455) | } |
| [456](#L456) | } |
| [457](#L457) |  |
| [458](#L458) | if ( ! empty( $price ) ) { |
| [459](#L459) | //let's apply tax if needed |
| [460](#L460) | if ( ! empty( $tax ) ) { |
| [461](#L461) | $tax\_amount     = round( ( $price\_in\_cents \* $tax / 100 ) ); |
| [462](#L462) | $price\_in\_cents = $price\_in\_cents + $tax\_amount; |
| [463](#L463) | } |
| [464](#L464) |  |
| [465](#L465) | //let's apply shipping cost if needed |
| [466](#L466) | if ( ! empty( $shipping ) ) { |
| [467](#L467) | $price\_in\_cents = $price\_in\_cents + $shipping; |
| [468](#L468) | } |
| [469](#L469) | } |
| [470](#L470) |  |
| [471](#L471) | if ( empty( $product\_id ) ) { |
| [472](#L472) | $hash = md5( wp\_json\_encode( $atts ) ) . '5'; |
| [473](#L473) | //find temp product |
| [474](#L474) | $temp\_post = get\_posts( |
| [475](#L475) | array( |
| [476](#L476) | 'meta\_key'       => 'asp\_shortcode\_hash', |
| [477](#L477) | 'meta\_value'     => $hash, |
| [478](#L478) | 'posts\_per\_page' => 1, |
| [479](#L479) | 'offset'         => 0, |
| [480](#L480) | 'post\_type'      => ASPMain::$temp\_prod\_slug, |
| [481](#L481) | ) |
| [482](#L482) | ); |
| [483](#L483) | wp\_reset\_postdata(); |
| [484](#L484) | if ( empty( $temp\_post ) ) { |
| [485](#L485) | // no temp post found. Let's create one |
| [486](#L486) | $new\_post                = array(); |
| [487](#L487) | $new\_post['post\_type']   = ASPMain::$temp\_prod\_slug; |
| [488](#L488) | $new\_post['post\_title']  = $atts['name']; |
| [489](#L489) | $new\_post['post\_status'] = 'publish'; |
| [490](#L490) | $new\_post['meta\_input']  = array( |
| [491](#L491) | 'asp\_shortcode\_hash'                   => $hash, |
| [492](#L492) | 'asp\_product\_quantity'                 => $quantity, |
| [493](#L493) | 'asp\_product\_custom\_quantity'          => $custom\_quantity, |
| [494](#L494) | 'asp\_product\_price'                    => $price, |
| [495](#L495) | 'asp\_product\_tax'                      => $tax, |
| [496](#L496) | 'asp\_product\_shipping'                 => $shipping, |
| [497](#L497) | 'asp\_product\_currency\_variable'        => $currency\_variable, |
| [498](#L498) | 'asp\_product\_currency'                 => $currency, |
| [499](#L499) | 'asp\_product\_description'              => $description, |
| [500](#L500) | 'asp\_product\_button\_text'              => $button\_text, |
| [501](#L501) | 'asp\_product\_collect\_billing\_addr'     => $billing\_address, |
| [502](#L502) | 'asp\_product\_collect\_shipping\_addr'    => $shipping\_address, |
| [503](#L503) | 'asp\_product\_button\_class'             => $class, |
| [504](#L504) | 'asp\_product\_upload'                   => base64\_decode( $url ), |
| [505](#L505) | 'asp\_product\_thumbnail'                => $item\_logo, |
| [506](#L506) | 'asp\_product\_thankyou\_page'            => empty( $thankyou\_page\_url ) ? '' : base64\_decode( $thankyou\_page\_url ), |
| [507](#L507) | 'asp\_product\_button\_only'              => 1, |
| [508](#L508) | 'asp\_product\_custom\_field'             => 2, |
| [509](#L509) | 'asp\_product\_customer\_email\_hardcoded' => $customer\_email, |
| [510](#L510) | 'asp\_product\_customer\_name\_hardcoded'  => $customer\_name, |
| [511](#L511) | ); |
| [512](#L512) | $post\_id                 = wp\_insert\_post( $new\_post ); |
| [513](#L513) | $temp\_post               = get\_post( $post\_id ); |
| [514](#L514) | } else { |
| [515](#L515) | $temp\_post = $temp\_post[0]; |
| [516](#L516) | } |
| [517](#L517) | $atts['id'] = $temp\_post->ID; |
| [518](#L518) | $ret        = $this->shortcode\_asp\_product( $atts ); |
| [519](#L519) | return $ret; |
| [520](#L520) | } |
| [521](#L521) |  |
| [522](#L522) | $button\_key = md5( htmlspecialchars\_decode( $name ) . $price\_in\_cents ); |
| [523](#L523) |  |
| [524](#L524) | //Charge description |
| [525](#L525) | //We only generate it if it's empty and if custom qunatity and price is not used |
| [526](#L526) | //If custom quantity and\or price are used, description will be generated by javascript |
| [527](#L527) | $descr\_generated = false; |
| [528](#L528) | if ( empty( $description ) && '1' !== $custom\_quantity && ( ! empty( $price ) && 0 !== $price ) ) { |
| [529](#L529) | //Create a description using quantity, payment amount and currency |
| [530](#L530) | if ( ! empty( $tax ) || ! empty( $shipping ) ) { |
| [531](#L531) | $formatted\_amount = AcceptStripePayments::formatted\_price( AcceptStripePayments::is\_zero\_cents( $currency ) ? $price\_in\_cents : $price\_in\_cents / 100, $currency ); |
| [532](#L532) | } else { |
| [533](#L533) | $formatted\_amount = AcceptStripePayments::formatted\_price( $payment\_amount, $currency ); |
| [534](#L534) | } |
| [535](#L535) | $description     = "{$quantity} X " . $formatted\_amount; |
| [536](#L536) | $descr\_generated = true; |
| [537](#L537) | } |
| [538](#L538) |  |
| [539](#L539) | // Check if "Disable Buttons Before Javascript Loads" option is set |
| [540](#L540) | $is\_disabled = ''; |
| [541](#L541) | if ( $this->asp\_main->get\_setting( 'disable\_buttons\_before\_js\_loads' ) ) { |
| [542](#L542) | $is\_disabled = ' disabled'; |
| [543](#L543) | } |
| [544](#L544) |  |
| [545](#L545) | $button = '<div class="asp\_product\_buy\_btn\_container">'; |
| [546](#L546) | $button .= '<button id="'.esc\_attr( $button\_id ).'" type="submit" class="'.esc\_attr( $class ).'" '.$is\_disabled.'><span>'.esc\_attr( $button\_text ).'</span></button>'; |
| [547](#L547) | $button .= '</div>'; |
| [548](#L548) |  |
| [549](#L549) | $out\_of\_stock          = false; |
| [550](#L550) | $stock\_control\_enabled = false; |
| [551](#L551) | $stock\_items           = 0; |
| [552](#L552) | //check if stock enabled |
| [553](#L553) | if ( isset( $product\_id ) && get\_post\_meta( $product\_id, 'asp\_product\_enable\_stock', true ) ) { |
| [554](#L554) | //check if product is not out of stock |
| [555](#L555) | $stock\_items = get\_post\_meta( $product\_id, 'asp\_product\_stock\_items', true ); |
| [556](#L556) | if ( empty( $stock\_items ) ) { |
| [557](#L557) | $button       = '<div class="asp\_out\_of\_stock">' . \_\_( 'Out of stock', 'stripe-payments' ) . '</div>'; |
| [558](#L558) | $out\_of\_stock = true; |
| [559](#L559) | } else { |
| [560](#L560) | $stock\_control\_enabled = true; |
| [561](#L561) | $stock\_items           = $stock\_items; |
| [562](#L562) | } |
| [563](#L563) | } |
| [564](#L564) |  |
| [565](#L565) | //add message if no javascript is enabled |
| [566](#L566) | $button .= '<noscript>' . \_\_( 'Stripe Payments requires Javascript to be supported by the browser in order to operate.', 'stripe-payments' ) . '</noscript>'; |
| [567](#L567) |  |
| [568](#L568) | $checkout\_lang = empty( $checkout\_lang ) ? $this->asp\_main->get\_setting( 'checkout\_lang' ) : $checkout\_lang; |
| [569](#L569) |  |
| [570](#L570) | //Currency Display settings |
| [571](#L571) | $display\_settings      = array(); |
| [572](#L572) | $display\_settings['c'] = $this->asp\_main->get\_setting( 'price\_decimals\_num', 2 ); |
| [573](#L573) | $display\_settings['d'] = $this->asp\_main->get\_setting( 'price\_decimal\_sep' ); |
| [574](#L574) | $display\_settings['t'] = $this->asp\_main->get\_setting( 'price\_thousand\_sep' ); |
| [575](#L575) |  |
| [576](#L576) | $currencies = AcceptStripePayments::get\_currencies(); |
| [577](#L577) | if ( isset( $currencies[ $currency ] ) ) { |
| [578](#L578) | $curr\_sym = $currencies[ $currency ][1]; |
| [579](#L579) | } else { |
| [580](#L580) | //no currency code found, let's just use currency code instead of symbol |
| [581](#L581) | $curr\_sym = $currencies; |
| [582](#L582) | } |
| [583](#L583) |  |
| [584](#L584) | $curr\_pos = $this->asp\_main->get\_setting( 'price\_currency\_pos' ); |
| [585](#L585) |  |
| [586](#L586) | $display\_settings['s']   = $curr\_sym; |
| [587](#L587) | $display\_settings['pos'] = $curr\_pos; |
| [588](#L588) |  |
| [589](#L589) | $display\_str = array(); |
| [590](#L590) | $tax\_str     = apply\_filters( 'asp\_customize\_text\_msg', \_\_( 'Tax', 'stripe-payments' ), 'tax\_str' ); |
| [591](#L591) | $ship\_str    = apply\_filters( 'asp\_customize\_text\_msg', \_\_( 'Shipping', 'stripe-payments' ), 'shipping\_str' ); |
| [592](#L592) |  |
| [593](#L593) | $display\_str['tax']  = '%s (' . strtolower( $tax\_str ) . ')'; |
| [594](#L594) | $display\_str['ship'] = '%s (' . strtolower( $ship\_str ) . ')'; |
| [595](#L595) |  |
| [596](#L596) | $base\_url = ASP\_Utils::get\_base\_pp\_url(); |
| [597](#L597) |  |
| [598](#L598) | $url\_params = array( |
| [599](#L599) | 'product\_id' => $product\_id, |
| [600](#L600) | ); |
| [601](#L601) |  |
| [602](#L602) | if ( ! empty( $atts['btn\_uniq\_id'] ) ) { |
| [603](#L603) | $url\_params['btn\_uniq\_id'] = $atts['btn\_uniq\_id']; |
| [604](#L604) | } |
| [605](#L605) |  |
| [606](#L606) | $prefetch = $this->asp\_main->get\_setting( 'frontend\_prefetch\_scripts' ); |
| [607](#L607) |  |
| [608](#L608) | if ( $prefetch ) { |
| [609](#L609) | $url\_params['ckey'] = ASP\_Utils::get\_ckey(); |
| [610](#L610) | } |
| [611](#L611) |  |
| [612](#L612) | $iframe\_url = add\_query\_arg( $url\_params, $base\_url ); |
| [613](#L613) |  |
| [614](#L614) | $data = array( |
| [615](#L615) | 'is\_live'                  => $this->asp\_main->is\_live, |
| [616](#L616) | 'product\_id'               => $product\_id, |
| [617](#L617) | 'iframe\_url'               => $iframe\_url, |
| [618](#L618) | 'button\_key'               => $button\_key, |
| [619](#L619) | 'item\_price'               => isset( $item\_price ) ? $item\_price : 0, |
| [620](#L620) | 'quantity'                 => $quantity, |
| [621](#L621) | 'custom\_quantity'          => $custom\_quantity, |
| [622](#L622) | 'description'              => $description, |
| [623](#L623) | 'descrGenerated'           => $descr\_generated, |
| [624](#L624) | 'shipping'                 => $shipping, |
| [625](#L625) | 'tax'                      => $tax, |
| [626](#L626) | 'image'                    => $item\_logo, |
| [627](#L627) | 'currency'                 => $currency, |
| [628](#L628) | 'currency\_variable'        => $currency\_variable, |
| [629](#L629) | 'locale'                   => ( empty( $checkout\_lang ) ? 'auto' : $checkout\_lang ), |
| [630](#L630) | 'name'                     => htmlspecialchars\_decode( $name ), |
| [631](#L631) | 'url'                      => $url, |
| [632](#L632) | 'amount'                   => $price\_in\_cents, |
| [633](#L633) | 'billingAddress'           => ( empty( $billing\_address ) ? false : true ), |
| [634](#L634) | 'shippingAddress'          => ( empty( $shipping\_address ) ? false : true ), |
| [635](#L635) | 'customer\_email'           => $customer\_email, |
| [636](#L636) | 'uniq\_id'                  => $uniq\_id, |
| [637](#L637) | 'variable'                 => ( empty( $price ) ? true : false ), |
| [638](#L638) | 'zeroCents'                => $this->asp\_main->zeroCents, |
| [639](#L639) | 'addonHooks'               => array(), |
| [640](#L640) | 'button\_text'              => esc\_attr( $button\_text ), |
| [641](#L641) | 'out\_of\_stock'             => $out\_of\_stock, |
| [642](#L642) | 'stock\_control\_enabled'    => $stock\_control\_enabled, |
| [643](#L643) | 'stock\_items'              => $stock\_items, |
| [644](#L644) | 'currencyFormat'           => $display\_settings, |
| [645](#L645) | 'displayStr'               => $display\_str, |
| [646](#L646) | 'thankyou\_page\_url'        => $thankyou\_page\_url, |
| [647](#L647) | 'show\_custom\_amount\_input' => false, |
| [648](#L648) | ); |
| [649](#L649) |  |
| [650](#L650) | $data = apply\_filters( 'asp-button-output-data-ready', $data, $atts ); |
| [651](#L651) |  |
| [652](#L652) | $output = ''; |
| [653](#L653) |  |
| [654](#L654) | //Let's insert Stripe default stylesheet only when it's needed |
| [655](#L655) | if ( 'stripe-button-el' === $class && ! ( ! $this->compat\_mode && $this->stripe\_css\_inserted ) ) { |
| [656](#L656) | wp\_enqueue\_style( 'asp-stripe-button-css' ); |
| [657](#L657) | $this->stripe\_css\_inserted = true; |
| [658](#L658) | } |
| [659](#L659) |  |
| [660](#L660) | $output .= $this->get\_styles(); |
| [661](#L661) |  |
| [662](#L662) | $output .= '<form id="asp\_ng\_form\_'.$uniq\_id.'" class="asp-stripe-form" action=""  method="POST"> '; |
| [663](#L663) |  |
| [664](#L664) | $output .= $this->get\_button\_code\_new\_method( $data ); |
| [665](#L665) |  |
| [666](#L666) | $output .= '<div class="asp-child-hidden-fields" style="display: none !important;"></div>'; |
| [667](#L667) |  |
| [668](#L668) | $trans\_name        = 'stripe-payments-' . $button\_key; //Create key using the item name. |
| [669](#L669) | $trans['tax']      = $tax; |
| [670](#L670) | $trans['shipping'] = $shipping; |
| [671](#L671) | $trans['price']    = $price; |
| [672](#L672) | set\_transient( $trans\_name, $trans, 2 \* 3600 ); //Save the price for this item for 2 hours. |
| [673](#L673) | $output .= '</form>'; |
| [674](#L674) | //before button filter |
| [675](#L675) | if ( ! $out\_of\_stock ) { |
| [676](#L676) | $output = apply\_filters( 'asp\_ng\_button\_output\_before\_button', $output, $data, $class ); |
| [677](#L677) | } |
| [678](#L678) | $output .= '<div id="asp-all-buttons-container-' . $uniq\_id . '" class="asp\_all\_buttons\_container">'; |
| [679](#L679) | $output .= $button; |
| [680](#L680) | //after button filter |
| [681](#L681) | if ( ! $out\_of\_stock ) { |
| [682](#L682) | $output = apply\_filters( 'asp\_ng\_button\_output\_after\_button', $output, $data, $class ); |
| [683](#L683) | } |
| [684](#L684) | $output .= '</div>'; |
| [685](#L685) | $output .= '<div id="asp-btn-spinner-container-' . $uniq\_id . '" class="asp-btn-spinner-container" style="display: none !important">' |
| [686](#L686) | . '<div class="asp-btn-spinner">' |
| [687](#L687) | . '<div></div>' |
| [688](#L688) | . '<div></div>' |
| [689](#L689) | . '<div></div>' |
| [690](#L690) | . '<div></div>' |
| [691](#L691) | . '</div>' |
| [692](#L692) | . '</div>'; |
| [693](#L693) |  |
| [694](#L694) | $output .= '<script>'; |
| [695](#L695) | $output .= 'var asp\_data\_' . $uniq\_id . ' = ' . wp\_json\_encode( $data ) . ';'; |
| [696](#L696) | $output .= 'if(typeof jQuery!=="undefined") {jQuery(document).ready(function() {new stripeHandlerNG(asp\_data\_' . $uniq\_id . ');});} else { if (typeof wpaspInitOnDocReady==="undefined") {var wpaspInitOnDocReady=[];} wpaspInitOnDocReady.push(asp\_data\_' . $uniq\_id . ');}'; |
| [697](#L697) | $output .= '</script>'; |
| [698](#L698) |  |
| [699](#L699) | $prefetch = $this->asp\_main->get\_setting( 'frontend\_prefetch\_scripts' ); |
| [700](#L700) | if ( $prefetch ) { |
| [701](#L701) | $this->asp\_main->footer\_scripts .= '<link rel="prefetch" as="document" href="' . $data['iframe\_url'] . '" />'; |
| [702](#L702) |  |
| [703](#L703) | if ( empty( $this->asp\_main->sc\_scripts\_prefetched ) ) { |
| [704](#L704) | $this->asp\_main->footer\_scripts .= '<link rel="dns-prefetch" href="https://q.stripe.com" />'; |
| [705](#L705) | $this->asp\_main->footer\_scripts .= '<link rel="prefetch" href="https://js.stripe.com/v3/" />'; |
| [706](#L706) | if ( ! defined( 'WP\_ASP\_DEV\_MODE' ) ) { |
| [707](#L707) | $this->asp\_main->footer\_scripts .= '<link rel="prefetch" as="style" href="' . WP\_ASP\_PLUGIN\_URL . '/public/views/templates/default/pp-combined.min.css?ver=' . WP\_ASP\_PLUGIN\_VERSION . '" />'; |
| [708](#L708) | $this->asp\_main->footer\_scripts .= '<link rel="prefetch" as="script" href="' . WP\_ASP\_PLUGIN\_URL . '/public/assets/js/pp-handler.min.js?ver=' . WP\_ASP\_PLUGIN\_VERSION . '" />'; |
| [709](#L709) | } else { |
| [710](#L710) | $this->asp\_main->footer\_scripts .= '<link rel="prefetch" as="style" href="' . WP\_ASP\_PLUGIN\_URL . '/public/views/templates/default/pure.css?ver=' . WP\_ASP\_PLUGIN\_VERSION . '" />'; |
| [711](#L711) | $this->asp\_main->footer\_scripts .= '<link rel="prefetch" as="style" href="' . WP\_ASP\_PLUGIN\_URL . '/public/views/templates/default/pp-style.css?ver=' . WP\_ASP\_PLUGIN\_VERSION . '" />'; |
| [712](#L712) | $this->asp\_main->footer\_scripts .= '<link rel="prefetch" as="script" href="' . WP\_ASP\_PLUGIN\_URL . '/public/assets/js/pp-handler.js?ver=' . WP\_ASP\_PLUGIN\_VERSION . '" />'; |
| [713](#L713) | } |
| [714](#L714) | } |
| [715](#L715) | } |
| [716](#L716) | return $output; |
| [717](#L717) | } |
| [718](#L718) |  |
| [719](#L719) | private function get\_styles() { |
| [720](#L720) | $output = ''; |
| [721](#L721) | if ( ! $this->button\_css\_inserted || $this->compat\_mode ) { |
| [722](#L722) | ob\_start(); |
| [723](#L723) | ?> |
| [724](#L724) | <div class="asp-processing-cont" style="display:none;"><span class="asp-processing">Processing <i>.</i><i>.</i><i>.</i></span></div> |
| [725](#L725) | <?php |
| [726](#L726) | $output .= ob\_get\_clean(); |
| [727](#L727) | //remove newline symbols for compatability with some page builders |
| [728](#L728) | $output = str\_replace( array( "\r\n", "\n", "\t" ), '', $output ); |
| [729](#L729) | } |
| [730](#L730) | return $output; |
| [731](#L731) | } |
| [732](#L732) |  |
| [733](#L733) | private function get\_button\_code\_new\_method( $data ) { |
| [734](#L734) | $output = ''; |
| [735](#L735) |  |
| [736](#L736) | if ( $data ) { |
| [737](#L737) | if ( $data['product\_id'] !== 0 ) { |
| [738](#L738) | $output .= '<input type="hidden" name="asp\_product\_id" value="' . absint($data['product\_id']) .'" />'; |
| [739](#L739) | } |
| [740](#L740) | } |
| [741](#L741) |  |
| [742](#L742) | if ( $data['show\_custom\_amount\_input'] ) { |
| [743](#L743) |  |
| [744](#L744) | if ( $data['amount'] == 0 ) { //price not specified, let's add an input box for user to specify the amount |
| [745](#L745) | $str\_enter\_amount = apply\_filters( 'asp\_customize\_text\_msg', \_\_( 'Enter amount', 'stripe-payments' ), 'enter\_amount' ); |
| [746](#L746) | $output          .= '<div class="asp\_product\_item\_amount\_input\_container">'; |
| [747](#L747) | $output          .= '<input type="number" min="0.01" step="0.01" size="10" class="asp\_product\_item\_amount\_input" id="stripeAmount\_'.$data[ 'uniq\_id' ].'" value="" name="stripeAmount" placeholder="' . $str\_enter\_amount . '" required />'; |
| [748](#L748) | if ( ! $data['currency\_variable'] ) { |
| [749](#L749) | $output .= '<span class="asp\_product\_item\_amount\_currency\_label" style="margin-left: 5px; display: inline-block">'. $data[ 'currency' ] .'</span>'; |
| [750](#L750) | } |
| [751](#L751) | $output .= '<span style="display: block;" id="error\_explanation\_'.$data[ 'uniq\_id' ].'"></span>'; |
| [752](#L752) | $output .= '</div>'; |
| [753](#L753) | } |
| [754](#L754) | // if ( $data['currency\_variable'] ) { |
| [755](#L755) | //      //let's add a box where user can select currency |
| [756](#L756) | //      $output .= '<div class="asp\_product\_currency\_input\_container">'; |
| [757](#L757) | //      $output .= '<select id="stripeCurrency\_' . $data['uniq\_id'] . '" class="asp\_product\_currency\_input" name="stripeCurrency">'; |
| [758](#L758) | //      $currArr = AcceptStripePayments::get\_currencies(); |
| [759](#L759) | //      $tpl     = '<option data-asp-curr-sym="%s" value="%s"%s>%s</option>'; |
| [760](#L760) | //      foreach ( $currArr as $code => $curr ) { |
| [761](#L761) | //              if ( $code !== '' ) { |
| [762](#L762) | //                      $checked = $data['currency'] === $code ? ' selected' : ''; |
| [763](#L763) | //                      $output .= sprintf( $tpl, $curr[1], $code, $checked, $curr[0] ); |
| [764](#L764) | //              } |
| [765](#L765) | //      } |
| [766](#L766) | //      $output .= '</select>'; |
| [767](#L767) | //      $output .= '</div>'; |
| [768](#L768) | // } |
| [769](#L769) |  |
| [770](#L770) | } |
| [771](#L771) |  |
| [772](#L772) | return $output; |
| [773](#L773) | } |
| [774](#L774) |  |
| [775](#L775) | } |

**Note:** See [TracBrowser](/wiki/TracBrowser)
for help on using the repository browser.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Plain Text](/browser/stripe-payments/trunk/includes/shortcodes/class-asp-shortcode-ng.php?format=txt)
* [Original Format](/export/3220698/stripe-payments/trunk/includes/shortcodes/class-asp-shortcode-ng.php)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)


