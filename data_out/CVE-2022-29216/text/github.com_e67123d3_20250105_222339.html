
[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ftensorflow%2Ftensorflow%2Fcommit%2F8b202f08d52e8206af2bdb2112a62fafbc546ec7)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ftensorflow%2Ftensorflow%2Fcommit%2F8b202f08d52e8206af2bdb2112a62fafbc546ec7)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=tensorflow%2Ftensorflow)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[tensorflow](/tensorflow)
/
**[tensorflow](/tensorflow/tensorflow)**
Public

* [Notifications](/login?return_to=%2Ftensorflow%2Ftensorflow) You must be signed in to change notification settings
* [Fork
  74.4k](/login?return_to=%2Ftensorflow%2Ftensorflow)
* [Star
   187k](/login?return_to=%2Ftensorflow%2Ftensorflow)

* [Code](/tensorflow/tensorflow)
* [Issues
  834](/tensorflow/tensorflow/issues)
* [Pull requests
  5k+](/tensorflow/tensorflow/pulls)
* [Actions](/tensorflow/tensorflow/actions)
* [Projects
  2](/tensorflow/tensorflow/projects)
* [Security](/tensorflow/tensorflow/security)
* [Insights](/tensorflow/tensorflow/pulse)

Additional navigation options

* [Code](/tensorflow/tensorflow)
* [Issues](/tensorflow/tensorflow/issues)
* [Pull requests](/tensorflow/tensorflow/pulls)
* [Actions](/tensorflow/tensorflow/actions)
* [Projects](/tensorflow/tensorflow/projects)
* [Security](/tensorflow/tensorflow/security)
* [Insights](/tensorflow/tensorflow/pulse)

## Commit

[Permalink](/tensorflow/tensorflow/commit/8b202f08d52e8206af2bdb2112a62fafbc546ec7)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Remove use of `eval` when evaluating the input example.

[Browse files](/tensorflow/tensorflow/tree/8b202f08d52e8206af2bdb2112a62fafbc546ec7)
Browse the repository at this point in the history

```
Use `ast.eval_literal` instead which safely evaluates the expression.

PiperOrigin-RevId: 400012249
Change-Id: I5ff98608ea2d736d093aa488af723ff4f6707e02
```

* Loading branch information

[![@k-w-w](https://avatars.githubusercontent.com/u/31663267?s=40&v=4)](/k-w-w) [![@tensorflower-gardener](https://avatars.githubusercontent.com/u/17151892?s=40&v=4)](/tensorflower-gardener)

[k-w-w](/tensorflow/tensorflow/commits?author=k-w-w "View all commits by k-w-w")
authored and
[tensorflower-gardener](/tensorflow/tensorflow/commits?author=tensorflower-gardener "View all commits by tensorflower-gardener")
committed
Sep 30, 2021

1 parent
[349172c](/tensorflow/tensorflow/commit/349172cf0ac29ba1346d244a40dc4761b4600f2e)

commit 8b202f0

 Show file tree

 Hide file tree

Showing
**3 changed files**
with
**29 additions**
and
**10 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* RELEASE.md
  [RELEASE.md](#diff-2b1b69303b927a484e02c7fad9fc87d0d3ff0dc22ae1da0ecd0dc935d922a23c)
* tensorflow/python/tools

  + tensorflow/python/tools/saved\_model\_cli.py
    [saved\_model\_cli.py](#diff-3f1e0b67e6a845d6c1b25fa8775cd0fc56edeb8d3b033a3155b8478349968737)
  + tensorflow/python/tools/saved\_model\_cli\_test.py
    [saved\_model\_cli\_test.py](#diff-e5db703b90c90a31ef78d649b1a924cc086a768d7c77aa044531a633c1a321c1)

## There are no files selected for viewing

2 changes: 2 additions & 0 deletions

2
[RELEASE.md](#diff-2b1b69303b927a484e02c7fad9fc87d0d3ff0dc22ae1da0ecd0dc935d922a23c "RELEASE.md")

Show comments

[View file](/tensorflow/tensorflow/blob/8b202f08d52e8206af2bdb2112a62fafbc546ec7/RELEASE.md)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |

| Expand Up | | @@ -249,6 +249,8 @@ |
|  |  | endpoint. |
|  |  | \* TF SavedModel: |
|  |  | \* Custom gradients are now saved by default. See `tf.saved\_model.SaveOptions` to disable this. |
|  |  | \* The saved\_model\_cli's `--input\_examples` inputs are now restricted to |
|  |  | python literals to avoid code injection. |
|  |  | \* XLA: |
|  |  | \* Added a new API that allows custom call functions to signal errors. The |
|  |  | old API will be deprecated in a future release. See |
| Expand Down | |  |

26 changes: 19 additions & 7 deletions

26
[tensorflow/python/tools/saved\_model\_cli.py](#diff-3f1e0b67e6a845d6c1b25fa8775cd0fc56edeb8d3b033a3155b8478349968737 "tensorflow/python/tools/saved_model_cli.py")

Show comments

[View file](/tensorflow/tensorflow/blob/8b202f08d52e8206af2bdb2112a62fafbc546ec7/tensorflow/python/tools/saved_model_cli.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -20,6 +20,7 @@ |
|  |  | """ |
|  |  |  |
|  |  | import argparse |
|  |  | import ast |
|  |  | import os |
|  |  | import re |
|  |  | import sys |
| Expand Down  Expand Up | | @@ -521,16 +522,18 @@ def preprocess\_inputs\_arg\_string(inputs\_str): |
|  |  | return input\_dict |
|  |  |  |
|  |  |  |
|  |  | def preprocess\_input\_exprs\_arg\_string(input\_exprs\_str): |
|  |  | def preprocess\_input\_exprs\_arg\_string(input\_exprs\_str, safe=True): |
|  |  | """Parses input arg into dictionary that maps input key to python expression. |
|  |  |  |
|  |  | Parses input string in the format of 'input\_key=<python expression>' into a |
|  |  | dictionary that maps each input\_key to its python expression. |
|  |  |  |
|  |  | Args: |
|  |  | input\_exprs\_str: A string that specifies python expression for input keys. |
|  |  | Each input is separated by semicolon. For each input key: |
|  |  | Each input is separated by semicolon. For each input key: |
|  |  | 'input\_key=<python expression>' |
|  |  | safe: Whether to evaluate the python expression as literals or allow |
|  |  | arbitrary calls (e.g. numpy usage). |
|  |  |  |
|  |  | Returns: |
|  |  | A dictionary that maps input keys to their values. |
| Expand All | | @@ -545,8 +548,15 @@ def preprocess\_input\_exprs\_arg\_string(input\_exprs\_str): |
|  |  | raise RuntimeError('--input\_exprs "%s" format is incorrect. Please follow' |
|  |  | '"<input\_key>=<python expression>"' % input\_exprs\_str) |
|  |  | input\_key, expr = input\_raw.split('=', 1) |
|  |  | # ast.literal\_eval does not work with numpy expressions |
|  |  | input\_dict[input\_key] = eval(expr) # pylint: disable=eval-used |
|  |  | if safe: |
|  |  | try: |
|  |  | input\_dict[input\_key] = ast.literal\_eval(expr) |
|  |  | except: |
|  |  | raise RuntimeError( |
|  |  | f'Expression "{expr}" is not a valid python literal.') |
|  |  | else: |
|  |  | # ast.literal\_eval does not work with numpy expressions |
|  |  | input\_dict[input\_key] = eval(expr) # pylint: disable=eval-used |
|  |  | return input\_dict |
|  |  |  |
|  |  |  |
| Expand Down  Expand Up | | @@ -659,7 +669,7 @@ def load\_inputs\_from\_input\_arg\_string(inputs\_str, input\_exprs\_str, |
|  |  | tensor\_key\_feed\_dict = {} |
|  |  |  |
|  |  | inputs = preprocess\_inputs\_arg\_string(inputs\_str) |
|  |  | input\_exprs = preprocess\_input\_exprs\_arg\_string(input\_exprs\_str) |
|  |  | input\_exprs = preprocess\_input\_exprs\_arg\_string(input\_exprs\_str, safe=False) |
|  |  | input\_examples = preprocess\_input\_examples\_arg\_string(input\_examples\_str) |
|  |  |  |
|  |  | for input\_tensor\_key, (filename, variable\_name) in inputs.items(): |
| Expand Down  Expand Up | | @@ -923,8 +933,10 @@ def add\_run\_subparser(subparsers): |
|  |  | parser\_run.add\_argument('--inputs', type=str, default='', help=msg) |
|  |  | msg = ('Specifying inputs by python expressions, in the format of' |
|  |  | ' "<input\_key>=\'<python expression>\'", separated by \';\'. ' |
|  |  | 'numpy module is available as \'np\'. ' |
|  |  | 'Will override duplicate input keys from --inputs option.') |
|  |  | 'numpy module is available as \'np\'. Please note that the expression ' |
|  |  | 'will be evaluated as-is, and is susceptible to code injection. ' |
|  |  | 'When this is set, the value will override duplicate input keys from ' |
|  |  | '--inputs option.') |
|  |  | parser\_run.add\_argument('--input\_exprs', type=str, default='', help=msg) |
|  |  | msg = ( |
|  |  | 'Specifying tf.Example inputs as list of dictionaries. For example: ' |
| Expand Down | |  |

11 changes: 8 additions & 3 deletions

11
[tensorflow/python/tools/saved\_model\_cli\_test.py](#diff-e5db703b90c90a31ef78d649b1a924cc086a768d7c77aa044531a633c1a321c1 "tensorflow/python/tools/saved_model_cli_test.py")

Show comments

[View file](/tensorflow/tensorflow/blob/8b202f08d52e8206af2bdb2112a62fafbc546ec7/tensorflow/python/tools/saved_model_cli_test.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -382,7 +382,7 @@ def testInputPreProcessFormats(self): |
|  |  | input\_expr\_str = 'input3=np.zeros([2,2]);input4=[4,5]' |
|  |  | input\_dict = saved\_model\_cli.preprocess\_inputs\_arg\_string(input\_str) |
|  |  | input\_expr\_dict = saved\_model\_cli.preprocess\_input\_exprs\_arg\_string( |
|  |  | input\_expr\_str) |
|  |  | input\_expr\_str, safe=False) |
|  |  | self.assertTrue(input\_dict['input1'] == ('/path/file.txt', 'ab3')) |
|  |  | self.assertTrue(input\_dict['input2'] == ('file2', None)) |
|  |  | print(input\_expr\_dict['input3']) |
| Expand Down  Expand Up | | @@ -418,6 +418,11 @@ def testInputPreProcessExamplesWithStrAndBytes(self): |
|  |  | } |
|  |  | """, feature) |
|  |  |  |
|  |  | def testInputPreprocessExampleWithCodeInjection(self): |
|  |  | input\_examples\_str = 'inputs=os.system("echo hacked")' |
|  |  | with self.assertRaisesRegex(RuntimeError, 'not a valid python literal.'): |
|  |  | saved\_model\_cli.preprocess\_input\_examples\_arg\_string(input\_examples\_str) |
|  |  |  |
|  |  | def testInputPreProcessFileNames(self): |
|  |  | input\_str = (r'inputx=C:\Program Files\data.npz[v:0];' |
|  |  | r'input:0=c:\PROGRA~1\data.npy') |
| Expand All | | @@ -434,8 +439,8 @@ def testInputPreProcessErrorBadFormat(self): |
|  |  | with self.assertRaises(RuntimeError): |
|  |  | saved\_model\_cli.preprocess\_inputs\_arg\_string(input\_str) |
|  |  | input\_str = 'inputx:np.zeros((5))' |
|  |  | with self.assertRaises(RuntimeError): |
|  |  | saved\_model\_cli.preprocess\_input\_exprs\_arg\_string(input\_str) |
|  |  | with self.assertRaisesRegex(RuntimeError, 'format is incorrect'): |
|  |  | saved\_model\_cli.preprocess\_input\_exprs\_arg\_string(input\_str, safe=False) |
|  |  |  |
|  |  | def testInputParserNPY(self): |
|  |  | x0 = np.array([[1], [2]]) |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `8b202f0`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ftensorflow%2Ftensorflow%2Fcommit%2F8b202f08d52e8206af2bdb2112a62fafbc546ec7) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.

