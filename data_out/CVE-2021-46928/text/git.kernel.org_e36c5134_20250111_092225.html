

| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=e96373f0a5f484bc1e193f9951dcb3adf24bf3f7)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=e96373f0a5f484bc1e193f9951dcb3adf24bf3f7)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=e96373f0a5f484bc1e193f9951dcb3adf24bf3f7)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=e96373f0a5f484bc1e193f9951dcb3adf24bf3f7)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Helge Deller <deller@gmx.de> | 2021-12-08 11:06:52 +0100 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2022-01-05 12:42:33 +0100 |
| commit | [e96373f0a5f484bc1e193f9951dcb3adf24bf3f7](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=e96373f0a5f484bc1e193f9951dcb3adf24bf3f7) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=e96373f0a5f484bc1e193f9951dcb3adf24bf3f7)) | |
| tree | [6b5bc10d78fe518676b5647e7fd002cd2bd0eb75](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=e96373f0a5f484bc1e193f9951dcb3adf24bf3f7) | |
| parent | [0d76daf2013ce1da20eab5e26bd81d983e1c18fb](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=0d76daf2013ce1da20eab5e26bd81d983e1c18fb) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=e96373f0a5f484bc1e193f9951dcb3adf24bf3f7&id2=0d76daf2013ce1da20eab5e26bd81d983e1c18fb)) | |
| download | [linux-e96373f0a5f484bc1e193f9951dcb3adf24bf3f7.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-e96373f0a5f484bc1e193f9951dcb3adf24bf3f7.tar.gz) | |

parisc: Clear stale IIR value on instruction access rights trap[ Upstream commit 484730e5862f6b872dca13840bed40fd7c60fa26 ]
When a trap 7 (Instruction access rights) occurs, this means the CPU
couldn't execute an instruction due to missing execute permissions on
the memory region. In this case it seems the CPU didn't even fetched
the instruction from memory and thus did not store it in the cr19 (IIR)
register before calling the trap handler. So, the trap handler will find
some random old stale value in cr19.
This patch simply overwrites the stale IIR value with a constant magic
"bad food" value (0xbaadf00d), in the hope people don't start to try to
understand the various random IIR values in trap 7 dumps.
Noticed-by: John David Anglin <dave.anglin@bell.net>
Signed-off-by: Helge Deller <deller@gmx.de>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=e96373f0a5f484bc1e193f9951dcb3adf24bf3f7)

| -rw-r--r-- | [arch/parisc/kernel/traps.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/arch/parisc/kernel/traps.c?id=e96373f0a5f484bc1e193f9951dcb3adf24bf3f7) | 2 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 2 insertions, 0 deletions

| diff --git a/arch/parisc/kernel/traps.c b/arch/parisc/kernel/traps.cindex 747c328fb88627..197cb8480350c4 100644--- a/[arch/parisc/kernel/traps.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/arch/parisc/kernel/traps.c?id=0d76daf2013ce1da20eab5e26bd81d983e1c18fb)+++ b/[arch/parisc/kernel/traps.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/arch/parisc/kernel/traps.c?id=e96373f0a5f484bc1e193f9951dcb3adf24bf3f7)@@ -729,6 +729,8 @@ void notrace handle\_interruption(int code, struct pt\_regs \*regs) } mmap\_read\_unlock(current->mm); }+ /\* CPU could not fetch instruction, so clear stale IIR value. \*/+ regs->iir = 0xbaadf00d; fallthrough; case 27:  /\* Data memory protection ID trap \*/ |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 09:21:02 +0000

