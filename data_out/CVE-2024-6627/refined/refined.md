### Summary:

The provided content relates to CVE-2024-6627. It describes a stored cross-site scripting (XSS) vulnerability in the Happy Addons for Elementor plugin for WordPress, specifically affecting versions 3.11.2 and earlier.

### Vulnerability Details:

*   **Root Cause:** Insufficient input sanitization and output escaping on user-supplied attributes within the PDF View widget.
*   **Weaknesses:** The plugin fails to properly sanitize and escape user-provided data, allowing the injection of arbitrary web scripts.
*   **Impact:** Successful exploitation allows authenticated attackers (with Contributor-level access or higher) to inject malicious JavaScript code into pages. When a user visits an infected page, the injected scripts execute, potentially leading to:
    *   Session hijacking
    *   Malicious redirects
    *   Defacement
    *   Other client-side attacks
*   **Attack Vectors:**  The vulnerability is triggered through the PDF View widget within the Happy Addons for Elementor plugin. An attacker can inject the malicious payload through the widget's configuration options, specifically in the PDF URL or PDF Title fields.
*   **Required Attacker Capabilities/Position:**
    *   The attacker needs to be an authenticated WordPress user with at least "Contributor" level permissions. This allows them to create/edit posts and pages.
    *   The attacker needs to have access to the Elementor page builder, in order to add or modify a page with the vulnerable PDF viewer widget and modify its settings.

### Technical Details

The vulnerability is located in the `widgets/pdf-view/widget.php` file of the plugin. The code that renders the PDF viewer widget does not properly sanitize user-supplied attributes before outputting them to the page, which is located around line 629:

```php
if($settings['pdf_title']){
     echo sprintf( '<h2 class="ha-pdf-title">%s</h2>',
          esc_html( $settings['pdf_title'] )
     );
}
```

While the `pdf_title` is being sanitized with `esc_html`, the `pdf_url` is not being sanitized before being used as a download link in the PDF viewer widget around line 641:

```php
printf( '<a href="%1$s" class="ha-btn" download title="%2$s">%3$s</a>',
   esc_url($pdf_url_i),
   esc_html( $settings['pdf_title'] ),
   __('Download', 'happy-elementor-addons')
);
```

The `pdf_url_i` variable, which is extracted from the user-provided PDF URL or uploaded PDF file in lines 591-595, is sanitized with `esc_url`, however, this function only sanitizes the URL and does not prevent the use of Javascript protocols. An attacker can insert a javascript protocol inside the URL field, such as javascript:alert(1), which bypasses the `esc_url` function, allowing execution of arbitrary code when a user clicks the download link.

### Additional Notes:

*   The vulnerability was patched in version 3.11.3 of the Happy Addons for Elementor plugin.
*   The vulnerability was discovered and reported by Webbernaut.
*   Wordfence recommends updating to the latest version of the plugin to mitigate the vulnerability.