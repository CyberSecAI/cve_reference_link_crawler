
[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fapache%2Fdolphinscheduler%2Fpull%2F15758)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fapache%2Fdolphinscheduler%2Fpull%2F15758)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=apache%2Fdolphinscheduler)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[apache](/apache)
/
**[dolphinscheduler](/apache/dolphinscheduler)**
Public

* [Notifications](/login?return_to=%2Fapache%2Fdolphinscheduler) You must be signed in to change notification settings
* [Fork
  4.7k](/login?return_to=%2Fapache%2Fdolphinscheduler)
* [Star
   13.2k](/login?return_to=%2Fapache%2Fdolphinscheduler)

* [Code](/apache/dolphinscheduler)
* [Issues
  195](/apache/dolphinscheduler/issues)
* [Pull requests
  16](/apache/dolphinscheduler/pulls)
* [Discussions](/apache/dolphinscheduler/discussions)
* [Actions](/apache/dolphinscheduler/actions)
* [Projects
  1](/apache/dolphinscheduler/projects)
* [Security](/apache/dolphinscheduler/security)
* [Insights](/apache/dolphinscheduler/pulse)

Additional navigation options

* [Code](/apache/dolphinscheduler)
* [Issues](/apache/dolphinscheduler/issues)
* [Pull requests](/apache/dolphinscheduler/pulls)
* [Discussions](/apache/dolphinscheduler/discussions)
* [Actions](/apache/dolphinscheduler/actions)
* [Projects](/apache/dolphinscheduler/projects)
* [Security](/apache/dolphinscheduler/security)
* [Insights](/apache/dolphinscheduler/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fapache%2Fdolphinscheduler%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fapache%2Fdolphinscheduler%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# [Improvement] Use safe constructor with snake yaml #15758

 Merged

[ruanwenjun](/ruanwenjun)
merged 8 commits into
[apache:dev](/apache/dolphinscheduler/tree/dev "apache/dolphinscheduler:dev")
from
[EricGao888:patch-snake-yaml-load](/EricGao888/dolphinscheduler/tree/patch-snake-yaml-load "EricGao888/dolphinscheduler:patch-snake-yaml-load")

May 14, 2024

 Merged

# [[Improvement] Use safe constructor with snake yaml](#top) #15758

[ruanwenjun](/ruanwenjun)
merged 8 commits into
[apache:dev](/apache/dolphinscheduler/tree/dev "apache/dolphinscheduler:dev")
from
[EricGao888:patch-snake-yaml-load](/EricGao888/dolphinscheduler/tree/patch-snake-yaml-load "EricGao888/dolphinscheduler:patch-snake-yaml-load")

May 14, 2024

[Conversation
31](/apache/dolphinscheduler/pull/15758)
[Commits
8](/apache/dolphinscheduler/pull/15758/commits)
[Checks
63](/apache/dolphinscheduler/pull/15758/checks)
[Files changed](/apache/dolphinscheduler/pull/15758/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![EricGao888](https://avatars.githubusercontent.com/u/34905992?s=60&v=4)](/EricGao888)

Copy link

Member

### @EricGao888 **[EricGao888](/EricGao888)** commented [Mar 22, 2024](#issue-2202631554)

## Purpose of the pull request

## Brief change log

## Verify this pull request

This pull request is code cleanup without any test coverage.

*(or)*

This pull request is already covered by existing tests, such as *(please describe tests)*.

(or)

This change added tests and can be verified as follows:

(or)

If your pull request contain incompatible change, you should also add it to `docs/docs/en/guide/upgrede/incompatible.md`

Sorry, something went wrong.

All reactions

 [![@EricGao888](https://avatars.githubusercontent.com/u/34905992?s=40&u=86299fa3a4a847fa2d4477f032ebcc241164bda7&v=4)](/EricGao888)
[EricGao888](/EricGao888)
requested a review
from [kezhenxu94](/kezhenxu94)
[March 22, 2024 14:28](#event-12216574485)

[![@github-actions](https://avatars.githubusercontent.com/in/15368?s=40&v=4)](/apps/github-actions)
[github-actions](/apps/github-actions)
bot
added
the
[backend](/apache/dolphinscheduler/labels/backend)
label
[Mar 22, 2024](#event-12216576614)

[![github-advanced-security[bot]](https://avatars.githubusercontent.com/in/57789?s=60&v=4)](/apps/github-advanced-security)

**[github-advanced-security](/apps/github-advanced-security)
bot**
found potential problems
[Mar 22, 2024](#pullrequestreview-1955022191)

 [View reviewed changes](/apache/dolphinscheduler/pull/15758/files)

[...i/src/main/java/org/apache/dolphinscheduler/plugin/task/api/k8s/AbstractK8sTaskExecutor.java](/apache/dolphinscheduler/pull/15758/files#diff-9325c2b99c9a8a638f65efa970e78b4703e9073f71877d5f195be0a29087eb1d)
Fixed

Show fixed

Hide fixed

[...che/dolphinscheduler/plugin/task/api/loop/template/http/parser/HttpTaskDefinitionParser.java](/apache/dolphinscheduler/pull/15758/files#diff-6fbde372bb3e3af93e9827f6c05d3cf35af5a5b300eb0dfded7772772a5f341d)
Fixed

|  |  | @@ -60,7 +60,7 @@ | |
| --- | --- | --- | --- |
|  |  | } |
|  |  |  |
|  |  | protected @NonNull LoopTaskYamlDefinition parseYamlConfigFile(@NonNull String yamlConfigFile) throws IOException { |
|  |  | Yaml yaml = new Yaml(new Constructor(LoopTaskYamlDefinition.class)); |
|  |  | Yaml yaml = new Yaml(new SafeConstructor()); |

Check notice

Code scanning / CodeQL

Deprecated method or constructor invocation

Note

Invoking [SafeConstructor.SafeConstructor](1) should be avoided because it has been deprecated.

Copy link

Member

### @SbloodyS **[SbloodyS](/SbloodyS)** [Mar 22, 2024](#discussion_r1535741407)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Can we fix this? [@EricGao888](https://github.com/EricGao888)

Sorry, something went wrong.

All reactions

Copy link

Member

Author

### @EricGao888 **[EricGao888](/EricGao888)** [Mar 22, 2024](#discussion_r1535745383) • edited Loading

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

[@SbloodyS](https://github.com/SbloodyS) In `package org.yaml.snakeyaml.constructor;`, we could see `public class Constructor extends SafeConstructor`. Therefore I think there is no need to change it.

Sorry, something went wrong.

All reactions

Copy link

Member

### @SbloodyS **[SbloodyS](/SbloodyS)** [Mar 22, 2024](#discussion_r1535751666)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

I'm not quite sure about it....

Sorry, something went wrong.

All reactions

Copy link

Member

Author

### @EricGao888 **[EricGao888](/EricGao888)** [Mar 22, 2024](#discussion_r1535757223)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

> I'm not quite sure about it....

I just email an4er and request PR review from him / her to see if there is some extra stuff we need to handle this one.

Sorry, something went wrong.

All reactions

Copy link

Member

### @ruanwenjun **[ruanwenjun](/ruanwenjun)** [Mar 23, 2024](#discussion_r1536560981) • edited Loading

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

We can use `Yaml yaml = new Yaml(new SafeConstructor(new LoaderOptipon()));` to avoid this warning.

<https://bitbucket.org/snakeyaml/snakeyaml/src/master/src/test/java/examples/SafeConstructorExampleTest.java>

<https://bitbucket.org/snakeyaml/snakeyaml/wiki/Documentation#markdown-header-tutorial>

Sorry, something went wrong.

 ❤️
1
 EricGao888 reacted with heart emoji

All reactions

* ❤️
  1 reaction

Copy link

### @an5er **[an5er](/an5er)** [Mar 23, 2024](#discussion_r1536634212)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

First of all I think the code `Yaml yaml = new Yaml(new Constructor(LoopTaskYamlDefinition.class));` can't be changed to `Yaml yaml = new Yaml(new SafeConstructor());` .

I would suggest to introduce the class [ClassFilterConstructor.java](https://github.com/apache/skywalking/blob/master/oap-server/server-library/library-util/src/main/java/org/apache/skywalking/oap/server/library/util/yaml/ClassFilterConstructor.java#L28), and then to replace the code in `AbstractK8sTaskExecutor` to be changed to

```
import java.util.List;

Yaml yaml = new Yaml(new ClassFilterConstructor(new Class[] {
        List.class
})).

```

This is for visibility, because here we expect the user's input to be of type list, you can also remove this map as it is already defined in the SafeConstructor

```
Yaml yaml = new Yaml(new ClassFilterConstructor(new Class[] {
}));

```

I didn't test the security of the parseYamlConfigFile function, so if you want to change it, you can also change to

```
Yaml yaml = new Yaml(new ClassFilterConstructor(new Class[] {
                LoopTaskYamlDefinition.class
        }));

```

Sorry, something went wrong.

 ❤️
1
 EricGao888 reacted with heart emoji

All reactions

* ❤️
  1 reaction

Copy link

Member

Author

### @EricGao888 **[EricGao888](/EricGao888)** [Mar 23, 2024](#discussion_r1536648826) • edited Loading

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

> Can we fix this? [@EricGao888](https://github.com/EricGao888)

[@SbloodyS](https://github.com/SbloodyS) Seems I misunderstood your point. Yes, we could fix this warning.

Sorry, something went wrong.

All reactions

Copy link

Member

Author

### @EricGao888 **[EricGao888](/EricGao888)** [Mar 23, 2024](#discussion_r1536648993)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

> First of all I think the code `Yaml yaml = new Yaml(new Constructor(LoopTaskYamlDefinition.class));` can't be changed to `Yaml yaml = new Yaml(new SafeConstructor());` . I would suggest to introduce the class [ClassFilterConstructor.java](https://github.com/apache/skywalking/blob/master/oap-server/server-library/library-util/src/main/java/org/apache/skywalking/oap/server/library/util/yaml/ClassFilterConstructor.java#L28), and then to replace the code in `AbstractK8sTaskExecutor` to be changed to
>
> ```
> import java.util.List;
>
> Yaml yaml = new Yaml(new ClassFilterConstructor(new Class[] {
>         List.class
> })).
>
> ```
>
> This is for visibility, because here we expect the user's input to be of type list, you can also remove this map as it is already defined in the SafeConstructor
>
> ```
> Yaml yaml = new Yaml(new ClassFilterConstructor(new Class[] {
> }));
>
> ```
>
> I didn't test the security of the parseYamlConfigFile function, so if you want to change it, you can also change to
>
> ```
> Yaml yaml = new Yaml(new ClassFilterConstructor(new Class[] {
>                 LoopTaskYamlDefinition.class
>         }));
>
> ```

[@an5er](https://github.com/an5er) Thanks for your suggestions. It helps a lot.

Sorry, something went wrong.

All reactions

 [![@EricGao888](https://avatars.githubusercontent.com/u/34905992?s=40&u=86299fa3a4a847fa2d4477f032ebcc241164bda7&v=4)](/EricGao888)
[EricGao888](/EricGao888)
marked this pull request as ready for review
[March 22, 2024 15:02](#event-12217068472)

 [![@EricGao888](https://avatars.githubusercontent.com/u/34905992?s=40&u=86299fa3a4a847fa2d4477f032ebcc241164bda7&v=4)](/EricGao888)
[EricGao888](/EricGao888)
requested review from
[caishunfeng](/caishunfeng),
[SbloodyS](/SbloodyS) and
[zhuangchong](/zhuangchong)
as [code owners](/apache/dolphinscheduler/blob/2e169076dc565f194c11ee4f55a4ac7f65071c6a/.github/CODEOWNERS#L38)
[March 22, 2024 15:02](#event-12217068623)

[![@EricGao888](https://avatars.githubusercontent.com/u/34905992?s=40&u=86299fa3a4a847fa2d4477f032ebcc241164bda7&v=4)](/EricGao888)
[EricGao888](/EricGao888)
self-assigned this
[Mar 22, 2024](#event-12217071892)

[![@EricGao888](https://avatars.githubusercontent.com/u/34905992?s=40&u=86299fa3a4a847fa2d4477f032ebcc241164bda7&v=4)](/EricGao888)
[EricGao888](/EricGao888)
added
the
[improvement](/apache/dolphinscheduler/labels/improvement)
make more easy to user or prompt friendly
label
[Mar 22, 2024](#event-12217072792)

[![@mergeable](https://avatars.githubusercontent.com/in/11156?s=40&v=4)](/apps/mergeable)
[mergeable](/apps/mergeable)
bot
removed
the
[improvement](/apache/dolphinscheduler/labels/improvement)
make more easy to user or prompt friendly
label
[Mar 22, 2024](#event-12217111758)

[![@ruanwenjun](https://avatars.githubusercontent.com/u/22415594?s=40&u=0e5f698f478492cd504651ffe138175214ec4598&v=4)](/ruanwenjun)
[ruanwenjun](/ruanwenjun)
added
the
[3.2.2](/apache/dolphinscheduler/labels/3.2.2)
label
[Mar 23, 2024](#event-12223509562)

 [![@EricGao888](https://avatars.githubusercontent.com/u/34905992?s=40&u=86299fa3a4a847fa2d4477f032ebcc241164bda7&v=4)](/EricGao888)
[EricGao888](/EricGao888)
requested review from
[an5er](/an5er) and
[ruanwenjun](/ruanwenjun)
[March 23, 2024 15:38](#event-12224657470)

[![@codecov-commenter](https://avatars.githubusercontent.com/u/65553080?s=80&u=b7ee84d82e25b493051d810390e97b15f716d7ef&v=4)](/codecov-commenter)

Copy link

### **[codecov-commenter](/codecov-commenter)** commented [Mar 23, 2024](#issuecomment-2016529579) • edited Loading

|  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- |
| [Codecov](https://app.codecov.io/gh/apache/dolphinscheduler/pull/15758?dropdown=coverage&src=pr&el=h1&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=apache) Report Attention: Patch coverage is `25.00000%` with `9 lines` in your changes are missing coverage. Please review.  Project coverage is 40.45%. Comparing base [(`7c8fa9b`)](https://app.codecov.io/gh/apache/dolphinscheduler/commit/7c8fa9b48cc680081d34d18954cf34099c7472d0?dropdown=coverage&el=desc&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=apache) to head [(`fd251c7`)](https://app.codecov.io/gh/apache/dolphinscheduler/pull/15758?dropdown=coverage&src=pr&el=desc&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=apache). Report is 1 commits behind head on dev.  ❗ Current head [fd251c7](https://github.com/apache/dolphinscheduler/commit/fd251c7cf4237be3ae56d7f87dce880c4fdfb8f9) differs from pull request most recent head [f606e31](https://github.com/apache/dolphinscheduler/commit/f606e310893405e4a871d6085b54e127f273fee8). Consider uploading reports for the commit [f606e31](https://github.com/apache/dolphinscheduler/commit/f606e310893405e4a871d6085b54e127f273fee8) to get more accurate results   | [Files](https://app.codecov.io/gh/apache/dolphinscheduler/pull/15758?dropdown=coverage&src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=apache) | Patch % | Lines | | --- | --- | --- | | [...scheduler/common/utils/ClassFilterConstructor.java](https://app.codecov.io/gh/apache/dolphinscheduler/pull/15758?src=pr&el=tree&filepath=dolphinscheduler-common%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fdolphinscheduler%2Fcommon%2Futils%2FClassFilterConstructor.java&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=apache#diff-ZG9scGhpbnNjaGVkdWxlci1jb21tb24vc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL2RvbHBoaW5zY2hlZHVsZXIvY29tbW9uL3V0aWxzL0NsYXNzRmlsdGVyQ29uc3RydWN0b3IuamF2YQ==) | 0.00% | [9 Missing ⚠️](https://app.codecov.io/gh/apache/dolphinscheduler/pull/15758?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=apache) |   Additional details and impacted files ``` @@             Coverage Diff              @@ ##                dev   #15758      +/-   ## ============================================ - Coverage     40.46%   40.45%   -0.01%      - Complexity     5195     5196       +1      ============================================   Files          1378     1379       +1        Lines         46084    46093       +9        Branches       4923     4924       +1      ============================================ + Hits          18646    18648       +2      - Misses        25512    25518       +6      - Partials       1926     1927       +1      ```   [☔ View full report in Codecov by Sentry](https://app.codecov.io/gh/apache/dolphinscheduler/pull/15758?dropdown=coverage&src=pr&el=continue&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=apache). 📢 Have feedback on the report? [Share it here](https://about.codecov.io/codecov-pr-comment-feedback/?utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=apache). |

All reactions

Sorry, something went wrong.

[![an5er](https://avatars.githubusercontent.com/u/95564938?s=60&v=4)](/an5er)

**[an5er](/an5er)**
reviewed
[Mar 23, 2024](#pullrequestreview-1956403072)

 [View reviewed changes](/apache/dolphinscheduler/pull/15758/files)

Copy link

### @an5er **[an5er](/an5er)** left a comment

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

LGTM, please ensure that the introduction of security mechanisms does not affect the functionality of the business

Sorry, something went wrong.

All reactions

[![kezhenxu94](https://avatars.githubusercontent.com/u/15965696?s=60&v=4)](/kezhenxu94)

**[kezhenxu94](/kezhenxu94)**
reviewed
[Mar 23, 2024](#pullrequestreview-1956449489)

 [View reviewed changes](/apache/dolphinscheduler/pull/15758/files)

Copy link

Member

### @kezhenxu94 **[kezhenxu94](/kezhenxu94)** left a comment

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

This is a case where unit test is helpful and should be mandatory, to verify that the nested types can be parsed without error. Can you add some?

Sorry, something went wrong.

All reactions

[...che/dolphinscheduler/plugin/task/api/loop/template/http/parser/HttpTaskDefinitionParser.java](/apache/dolphinscheduler/pull/15758/files#diff-6fbde372bb3e3af93e9827f6c05d3cf35af5a5b300eb0dfded7772772a5f341d)
Outdated

|  |  | try (FileReader fileReader = new FileReader(yamlConfigFile)) { |
| --- | --- | --- |
|  |  | return yaml.load(fileReader); |
|  |  | return new Yaml(new ClassFilterConstructor(new Class[]{LoopTaskYamlDefinition.class})) |

Copy link

Member

### @kezhenxu94 **[kezhenxu94](/kezhenxu94)** [Mar 23, 2024](#discussion_r1536708864)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

I think, you need to add all nested types(except for the primitive types in Java), such as

[dolphinscheduler/dolphinscheduler-task-plugin/dolphinscheduler-task-api/src/main/java/org/apache/dolphinscheduler/plugin/task/api/loop/template/LoopTaskYamlDefinition.java](https://github.com/apache/dolphinscheduler/blob/2e169076dc565f194c11ee4f55a4ac7f65071c6a/dolphinscheduler-task-plugin/dolphinscheduler-task-api/src/main/java/org/apache/dolphinscheduler/plugin/task/api/loop/template/LoopTaskYamlDefinition.java#L29)

Line 29
in
[2e16907](/apache/dolphinscheduler/commit/2e169076dc565f194c11ee4f55a4ac7f65071c6a)

|  | private LoopTaskServiceYamlDefinition service; |
| --- | --- |

[dolphinscheduler/dolphinscheduler-task-plugin/dolphinscheduler-task-api/src/main/java/org/apache/dolphinscheduler/plugin/task/api/loop/template/LoopTaskYamlDefinition.java](https://github.com/apache/dolphinscheduler/blob/2e169076dc565f194c11ee4f55a4ac7f65071c6a/dolphinscheduler-task-plugin/dolphinscheduler-task-api/src/main/java/org/apache/dolphinscheduler/plugin/task/api/loop/template/LoopTaskYamlDefinition.java#L36)

Line 36
in
[2e16907](/apache/dolphinscheduler/commit/2e169076dc565f194c11ee4f55a4ac7f65071c6a)

|  | private LoopTaskAPIYamlDefinition api; |
| --- | --- |

[dolphinscheduler/dolphinscheduler-task-plugin/dolphinscheduler-task-api/src/main/java/org/apache/dolphinscheduler/plugin/task/api/loop/template/LoopTaskYamlDefinition.java](https://github.com/apache/dolphinscheduler/blob/2e169076dc565f194c11ee4f55a4ac7f65071c6a/dolphinscheduler-task-plugin/dolphinscheduler-task-api/src/main/java/org/apache/dolphinscheduler/plugin/task/api/loop/template/LoopTaskYamlDefinition.java#L42)

Line 42
in
[2e16907](/apache/dolphinscheduler/commit/2e169076dc565f194c11ee4f55a4ac7f65071c6a)

|  | private LoopTaskSubmitMethodYamlDefinition submit; |
| --- | --- |

And so on……

Sorry, something went wrong.

 👍
1
 caishunfeng reacted with thumbs up emoji

All reactions

* 👍
  1 reaction

Copy link

Member

Author

### @EricGao888 **[EricGao888](/EricGao888)** [Mar 25, 2024](#discussion_r1537009519) • edited Loading

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

[@kezhenxu94](https://github.com/kezhenxu94) In `ClassFilterConstructor`, it overrides the method `getClassForName` from its super class `Constructor` which is called in the method `getClassForNode`. The strange thing is that if you put a check point at `cl = this.getClassForName(name);`, run `HttpTaskDefinitionParserTest.parseYamlConfigFile` and you will find that `cl = this.getClassForName(name);` only gets called once, which means the fields and the fields of the fields in `LoopTaskYamlDefinition` such as `LoopTaskServiceYamlDefinition`, `LoopTaskQueryStateYamlDefinition`, etc. are not checked iteratively. I think whether to add these nested types or not does not make any difference and the nested types still bypass the check in this solution.

```
    protected Class<?> getClassForNode(Node node) {
        Class<? extends Object> classForTag = (Class)this.typeTags.get(node.getTag());
        if (classForTag == null) {
            String name = node.getTag().getClassName();

            Class cl;
            try {
                cl = this.getClassForName(name);
            } catch (ClassNotFoundException var6) {
                throw new YAMLException("Class not found: " + name);
            }

            this.typeTags.put(node.getTag(), cl);
            return cl;
        } else {
            return classForTag;
        }
    }
```

[![image](https://private-user-images.githubusercontent.com/34905992/316373126-e684ff4e-57a9-423c-bb8b-cbeb84b2952d.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1NzY3NDgsIm5iZiI6MTczNjU3NjQ0OCwicGF0aCI6Ii8zNDkwNTk5Mi8zMTYzNzMxMjYtZTY4NGZmNGUtNTdhOS00MjNjLWJiOGItY2JlYjg0YjI5NTJkLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDA2MjA0OFomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWU5YWY4MDZjNWI5Nzk2YzUwN2FiYmY0NjQwYjc1YmQyOTM5NjU1MThmZjZmNGI3OWE1ZjUxMzFkNDQ5OGFkYmYmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.TqowZe7VFdYoe2QGpKXufAzHXzvFAcYeCP8LgoSw6OM)](https://private-user-images.githubusercontent.com/34905992/316373126-e684ff4e-57a9-423c-bb8b-cbeb84b2952d.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1NzY3NDgsIm5iZiI6MTczNjU3NjQ0OCwicGF0aCI6Ii8zNDkwNTk5Mi8zMTYzNzMxMjYtZTY4NGZmNGUtNTdhOS00MjNjLWJiOGItY2JlYjg0YjI5NTJkLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDA2MjA0OFomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWU5YWY4MDZjNWI5Nzk2YzUwN2FiYmY0NjQwYjc1YmQyOTM5NjU1MThmZjZmNGI3OWE1ZjUxMzFkNDQ5OGFkYmYmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.TqowZe7VFdYoe2QGpKXufAzHXzvFAcYeCP8LgoSw6OM)

Sorry, something went wrong.

All reactions

Copy link

Member

### @kezhenxu94

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

I think the method `getClassForNode` must be called per yaml section node, it is impossible (to me) to get all nested classes types when starting to parse the root node, will check.

Sorry, something went wrong.

All reactions

[...i/src/main/java/org/apache/dolphinscheduler/plugin/task/api/k8s/AbstractK8sTaskExecutor.java](/apache/dolphinscheduler/pull/15758/files#diff-9325c2b99c9a8a638f65efa970e78b4703e9073f71877d5f195be0a29087eb1d)
Outdated

Comment on lines
41
 to
43

|  |  | this.yaml = new Yaml(new ClassFilterConstructor(new Class[]{ |
| --- | --- | --- |
|  |  | List.class |
|  |  | })); |

Copy link

Member

### @kezhenxu94 **[kezhenxu94](/kezhenxu94)** [Mar 23, 2024](#discussion_r1536709504)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Please also check this, nested non-primitive types should be added too

Sorry, something went wrong.

All reactions

Copy link

Member

Author

### @EricGao888 **[EricGao888](/EricGao888)** [May 14, 2024](#discussion_r1599317189)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

[![image](https://private-user-images.githubusercontent.com/34905992/330264227-06a6d15c-1857-492c-8837-4ee886a868fd.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1NzY3NDgsIm5iZiI6MTczNjU3NjQ0OCwicGF0aCI6Ii8zNDkwNTk5Mi8zMzAyNjQyMjctMDZhNmQxNWMtMTg1Ny00OTJjLTg4MzctNGVlODg2YTg2OGZkLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDA2MjA0OFomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTgzZTdmODczZWI2MzZmY2UxYzliYWQ1NGJhMWIyYTQzMjFhM2Y2YzU4ZmFmNmRjY2U5Yzg4NzFjZmIwZTgzOTImWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.MhrafJNDxCYsQeN4D6syt0hxW2Moh8XpfpXNaLDAwH4)](https://private-user-images.githubusercontent.com/34905992/330264227-06a6d15c-1857-492c-8837-4ee886a868fd.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1NzY3NDgsIm5iZiI6MTczNjU3NjQ0OCwicGF0aCI6Ii8zNDkwNTk5Mi8zMzAyNjQyMjctMDZhNmQxNWMtMTg1Ny00OTJjLTg4MzctNGVlODg2YTg2OGZkLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDA2MjA0OFomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTgzZTdmODczZWI2MzZmY2UxYzliYWQ1NGJhMWIyYTQzMjFhM2Y2YzU4ZmFmNmRjY2U5Yzg4NzFjZmIwZTgzOTImWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.MhrafJNDxCYsQeN4D6syt0hxW2Moh8XpfpXNaLDAwH4)

According to docs, there is only List of Strings here.

Sorry, something went wrong.

All reactions

[![@EricGao888](https://avatars.githubusercontent.com/u/34905992?s=80&u=86299fa3a4a847fa2d4477f032ebcc241164bda7&v=4)](/EricGao888)

Copy link

Member

Author

### **[EricGao888](/EricGao888)** commented [Mar 25, 2024](#issuecomment-2017096908)

| This is a case where unit test is helpful and should be mandatory, to verify that the nested types can be parsed without error. Can you add some?  Sure |
| --- |

All reactions

Sorry, something went wrong.

[![@SbloodyS](https://avatars.githubusercontent.com/u/17822915?s=40&u=2d6ee8927c1bab780b847c9717ee620ea7887899&v=4)](/SbloodyS)
[SbloodyS](/SbloodyS)
added
the
[improvement](/apache/dolphinscheduler/labels/improvement)
make more easy to user or prompt friendly
label
[Mar 25, 2024](#event-12228656737)

[![@SbloodyS](https://avatars.githubusercontent.com/u/17822915?s=40&u=2d6ee8927c1bab780b847c9717ee620ea7887899&v=4)](/SbloodyS)
[SbloodyS](/SbloodyS)
added this to the [3.2.2](/apache/dolphinscheduler/milestone/56) milestone
[Mar 25, 2024](#event-12228656898)

[![@sonarqubecloud](https://avatars.githubusercontent.com/in/12526?s=80&v=4)](/apps/sonarqubecloud)
[![SonarQubeCloud](https://avatars.githubusercontent.com/in/12526?s=40&u=ff9a5e8d4757ff6705e21d7cc3e870cc768502db&v=4)](https://github.com/apps/sonarqubecloud)

Copy link

### **[sonarqubecloud](/apps/sonarqubecloud) bot** commented [Apr 3, 2024](#issuecomment-2033450661)

| [Quality Gate Failed](https://sonarcloud.io/dashboard?id=apache-dolphinscheduler&pullRequest=15758) **Quality Gate failed** Failed conditions  [21.4% Coverage on New Code](https://sonarcloud.io/component_measures?id=apache-dolphinscheduler&pullRequest=15758&metric=new_coverage&view=list) (required ≥ 60%)  [See analysis details on SonarCloud](https://sonarcloud.io/dashboard?id=apache-dolphinscheduler&pullRequest=15758) |
| --- |

All reactions

Sorry, something went wrong.

[![@Liyw979](https://avatars.githubusercontent.com/u/16919236?s=80&v=4)](/Liyw979)

Copy link

### **[Liyw979](/Liyw979)** commented [Apr 12, 2024](#issuecomment-2050842341) • edited Loading

| I am new to DS and have a question here. Login users are allowed to exectue code on worker side by default, then do we still need to worring about security issues inside modules of `org.apache.dolphinscheduler.plugin.task`? |
| --- |

All reactions

Sorry, something went wrong.

[![@an5er](https://avatars.githubusercontent.com/u/95564938?s=80&u=d00850801c69d66def3f06e70a3ffa76e50120aa&v=4)](/an5er)

Copy link

### **[an5er](/an5er)** commented [Apr 12, 2024](#issuecomment-2051214382)

| I am new to DS and have a question here. Login users are allowed to exectue code on worker side by default, then do we still need to worring about security issues inside modules of `org.apache.dolphinscheduler.plugin.task`?  I think it's normal for the server to execute certain commands to the worker. However, security issues such as those in the `org.apache.dolphinscheduler.plugin.task` module affect the server, not the worker. |
| --- |

All reactions

Sorry, something went wrong.

[![@Liyw979](https://avatars.githubusercontent.com/u/16919236?s=80&v=4)](/Liyw979)

Copy link

### **[Liyw979](/Liyw979)** commented [Apr 12, 2024](#issuecomment-2051259453)

| Hi [@an5er](https://github.com/an5er) ,do you mean that   [dolphinscheduler/dolphinscheduler-task-plugin/dolphinscheduler-task-api/src/main/java/org/apache/dolphinscheduler/plugin/task/api/k8s/impl/K8sTaskExecutor.java](https://github.com/apache/dolphinscheduler/blob/08ac1322864edf42903c7c03942fcad62c37da35/dolphinscheduler-task-plugin/dolphinscheduler-task-api/src/main/java/org/apache/dolphinscheduler/plugin/task/api/k8s/impl/K8sTaskExecutor.java#L143-L149)  Lines 143 to 149 in [08ac132](/apache/dolphinscheduler/commit/08ac1322864edf42903c7c03942fcad62c37da35)   |  | try { | | --- | --- | |  | if (!StringUtils.isEmpty(commandString)) { | |  | commands = yaml.load(commandString.trim()); | |  | } | |  | if (!StringUtils.isEmpty(argsString)) { | |  | args = yaml.load(argsString.trim()); | |  | } |     runs on the master machine? |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |

All reactions

Sorry, something went wrong.

[![@an5er](https://avatars.githubusercontent.com/u/95564938?s=80&u=d00850801c69d66def3f06e70a3ffa76e50120aa&v=4)](/an5er)

Copy link

### **[an5er](/an5er)** commented [Apr 12, 2024](#issuecomment-2051280077)

| Hi [@an5er](https://github.com/an5er) ,do you mean that     [dolphinscheduler/dolphinscheduler-task-plugin/dolphinscheduler-task-api/src/main/java/org/apache/dolphinscheduler/plugin/task/api/k8s/impl/K8sTaskExecutor.java](https://github.com/apache/dolphinscheduler/blob/08ac1322864edf42903c7c03942fcad62c37da35/dolphinscheduler-task-plugin/dolphinscheduler-task-api/src/main/java/org/apache/dolphinscheduler/plugin/task/api/k8s/impl/K8sTaskExecutor.java#L143-L149)  Lines 143 to 149 in [08ac132](/apache/dolphinscheduler/commit/08ac1322864edf42903c7c03942fcad62c37da35)   |  | try { | | --- | --- | |  | if (!StringUtils.isEmpty(commandString)) { | |  | commands = yaml.load(commandString.trim()); | |  | } | |  | if (!StringUtils.isEmpty(argsString)) { | |  | args = yaml.load(argsString.trim()); | |  | } |      runs on the master machine?  No, it runs on the machine where the dolphinscheduler is deployed, not in the k8s cluster. |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |

All reactions

Sorry, something went wrong.

[![@caishunfeng](https://avatars.githubusercontent.com/u/11962619?s=80&u=c8311c3fd3953161ac36f6dbcfffb5b98e62a131&v=4)](/caishunfeng)

Copy link

Contributor

### **[caishunfeng](/caishunfeng)** commented [Apr 16, 2024](#issuecomment-2058554033)

| This is a case where unit test is helpful and should be mandatory, to verify that the nested types can be parsed without error. Can you add some?  Sure  [@EricGao888](https://github.com/EricGao888) will you update this pr? |
| --- |

All reactions

Sorry, something went wrong.

[![@EricGao888](https://avatars.githubusercontent.com/u/34905992?s=80&u=86299fa3a4a847fa2d4477f032ebcc241164bda7&v=4)](/EricGao888)

Copy link

Member

Author

### **[EricGao888](/EricGao888)** commented [Apr 17, 2024](#issuecomment-2060253436)

| This is a case where unit test is helpful and should be mandatory, to verify that the nested types can be parsed without error. Can you add some?  Sure  [@EricGao888](https://github.com/EricGao888) will you update this pr?  Yes, but later this week. Quite busy recently. 😢 |
| --- |

 ❤️
1
 caishunfeng reacted with heart emoji

All reactions

* ❤️
  1 reaction

Sorry, something went wrong.

 [EricGao888](/EricGao888)
added 4 commits
[May 13, 2024 22:22](#commits-pushed-0bfa7c5)

[![@EricGao888](https://avatars.githubusercontent.com/u/34905992?s=40&v=4)](/EricGao888)

`[use safe constructor with snake yaml](/apache/dolphinscheduler/pull/15758/commits/0bfa7c5ab492c1db3bca8ee587d0aaf9249890cc "use safe constructor with snake yaml")`

`[0bfa7c5](/apache/dolphinscheduler/pull/15758/commits/0bfa7c5ab492c1db3bca8ee587d0aaf9249890cc)`

[![@EricGao888](https://avatars.githubusercontent.com/u/34905992?s=40&v=4)](/EricGao888)

`[revert changes to HttpTaskDefinitionParser](/apache/dolphinscheduler/pull/15758/commits/21e1079a110bf7e5286538fea08edd0850d9ad60 "revert changes to HttpTaskDefinitionParser")`

`[21e1079](/apache/dolphinscheduler/pull/15758/commits/21e1079a110bf7e5286538fea08edd0850d9ad60)`

[![@EricGao888](https://avatars.githubusercontent.com/u/34905992?s=40&v=4)](/EricGao888)

`[introduce ClassFilterConstructor utility class](/apache/dolphinscheduler/pull/15758/commits/82692e704945ed3901666ad399202c088c14e786 "introduce ClassFilterConstructor utility class")`

`[82692e7](/apache/dolphinscheduler/pull/15758/commits/82692e704945ed3901666ad399202c088c14e786)`

[![@EricGao888](https://avatars.githubusercontent.com/u/34905992?s=40&v=4)](/EricGao888)

`[fix style error](/apache/dolphinscheduler/pull/15758/commits/614620d080efae850bb7496b35cd3fe2e0239599 "fix style error")`

`[614620d](/apache/dolphinscheduler/pull/15758/commits/614620d080efae850bb7496b35cd3fe2e0239599)`

[![@EricGao888](https://avatars.githubusercontent.com/u/34905992?s=40&v=4)](/EricGao888)

`[update](/apache/dolphinscheduler/pull/15758/commits/74787747bbf875345dd87b6b37ed606081852399 "update")`

`[7478774](/apache/dolphinscheduler/pull/15758/commits/74787747bbf875345dd87b6b37ed606081852399)`

 [![@EricGao888](https://avatars.githubusercontent.com/u/34905992?s=40&u=86299fa3a4a847fa2d4477f032ebcc241164bda7&v=4)](/EricGao888)
[EricGao888](/EricGao888)
[force-pushed](/apache/dolphinscheduler/compare/fd621d610fc17b6d413f694e061fa0a688499416..74787747bbf875345dd87b6b37ed606081852399)
the
patch-snake-yaml-load

branch
from
[`fd621d6`](/apache/dolphinscheduler/commit/fd621d610fc17b6d413f694e061fa0a688499416) to
[`7478774`](/apache/dolphinscheduler/commit/74787747bbf875345dd87b6b37ed606081852399)  [Compare](/apache/dolphinscheduler/compare/fd621d610fc17b6d413f694e061fa0a688499416..74787747bbf875345dd87b6b37ed606081852399)
[May 13, 2024 14:30](#event-12788450918)

 [EricGao888](/EricGao888)
added 3 commits
[May 14, 2024 10:31](#commits-pushed-f6544fe)

[![@EricGao888](https://avatars.githubusercontent.com/u/34905992?s=40&v=4)](/EricGao888)

`[Add classes maybe parsed recursively](/apache/dolphinscheduler/pull/15758/commits/f6544fe96fb69e9dde1e9caa1c0c52897be36563 "Add classes maybe parsed recursively")`

`[f6544fe](/apache/dolphinscheduler/pull/15758/commits/f6544fe96fb69e9dde1e9caa1c0c52897be36563)`

[![@EricGao888](https://avatars.githubusercontent.com/u/34905992?s=40&v=4)](/EricGao888)

`[Add ut cases to make sure yaml.loadXXX parse file correctly](/apache/dolphinscheduler/pull/15758/commits/0847512a389d0e7b3fc76a41f2072cd3396ee095 "Add ut cases to make sure yaml.loadXXX parse file correctly")`

`[0847512](/apache/dolphinscheduler/pull/15758/commits/0847512a389d0e7b3fc76a41f2072cd3396ee095)`

[![@EricGao888](https://avatars.githubusercontent.com/u/34905992?s=40&v=4)](/EricGao888)

`[update](/apache/dolphinscheduler/pull/15758/commits/f606e310893405e4a871d6085b54e127f273fee8 "update")`

`[f606e31](/apache/dolphinscheduler/pull/15758/commits/f606e310893405e4a871d6085b54e127f273fee8)`

[![@EricGao888](https://avatars.githubusercontent.com/u/34905992?s=80&u=86299fa3a4a847fa2d4477f032ebcc241164bda7&v=4)](/EricGao888)

Copy link

Member

Author

### **[EricGao888](/EricGao888)** commented [May 14, 2024](#issuecomment-2109190763)

| This is a case where unit test is helpful and should be mandatory, to verify that the nested types can be parsed without error. Can you add some?  Tests added. |
| --- |

All reactions

Sorry, something went wrong.

 [![@EricGao888](https://avatars.githubusercontent.com/u/34905992?s=40&u=86299fa3a4a847fa2d4477f032ebcc241164bda7&v=4)](/EricGao888)
[EricGao888](/EricGao888)
requested review from
[an5er](/an5er) and
[kezhenxu94](/kezhenxu94)
[May 14, 2024 03:07](#event-12795279469)

[![@sonarqubecloud](https://avatars.githubusercontent.com/in/12526?s=80&v=4)](/apps/sonarqubecloud)
[![SonarQubeCloud](https://avatars.githubusercontent.com/in/12526?s=40&u=ff9a5e8d4757ff6705e21d7cc3e870cc768502db&v=4)](https://github.com/apps/sonarqubecloud)

Copy link

### **[sonarqubecloud](/apps/sonarqubecloud) bot** commented [May 14, 2024](#issuecomment-2109217802)

| [Quality Gate Failed](https://sonarcloud.io/dashboard?id=apache-dolphinscheduler&pullRequest=15758) **Quality Gate failed** Failed conditions  [18.8% Coverage on New Code](https://sonarcloud.io/component_measures?id=apache-dolphinscheduler&pullRequest=15758&metric=new_coverage&view=list) (required ≥ 60%)  [See analysis details on SonarCloud](https://sonarcloud.io/dashboard?id=apache-dolphinscheduler&pullRequest=15758) |
| --- |

All reactions

Sorry, something went wrong.

[![ruanwenjun](https://avatars.githubusercontent.com/u/22415594?s=60&v=4)](/ruanwenjun)

**[ruanwenjun](/ruanwenjun)**
approved these changes
[May 14, 2024](#pullrequestreview-2054264372)

 [View reviewed changes](/apache/dolphinscheduler/pull/15758/files/f606e310893405e4a871d6085b54e127f273fee8)

Copy link

Member

### @ruanwenjun

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

LGTM

Sorry, something went wrong.

All reactions

 [![@ruanwenjun](https://avatars.githubusercontent.com/u/22415594?s=40&u=0e5f698f478492cd504651ffe138175214ec4598&v=4)](/ruanwenjun)
[ruanwenjun](/ruanwenjun)
requested review from
[Radeity](/Radeity) and
[rickchengx](/rickchengx)
and removed request for
[an5er](/an5er)
[May 14, 2024 04:40](#event-12795871761)

[![@ruanwenjun](https://avatars.githubusercontent.com/u/22415594?s=40&u=0e5f698f478492cd504651ffe138175214ec4598&v=4)](/ruanwenjun)
[ruanwenjun](/ruanwenjun)
added
the
[priority:high](/apache/dolphinscheduler/labels/priority%3Ahigh)
label
[May 14, 2024](#event-12795873403)

 [![@ruanwenjun](https://avatars.githubusercontent.com/u/22415594?s=40&u=0e5f698f478492cd504651ffe138175214ec4598&v=4)](/ruanwenjun)
[ruanwenjun](/ruanwenjun)
requested a review
from [an5er](/an5er)
[May 14, 2024 04:43](#event-12795893166)

[![an5er](https://avatars.githubusercontent.com/u/95564938?s=60&v=4)](/an5er)

**[an5er](/an5er)**
reviewed
[May 14, 2024](#pullrequestreview-2054270167)

 [View reviewed changes](/apache/dolphinscheduler/pull/15758/files/f606e310893405e4a871d6085b54e127f273fee8)

Copy link

### @an5er **[an5er](/an5er)** left a comment

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

LGTM

Sorry, something went wrong.

All reactions

[![an5er](https://avatars.githubusercontent.com/u/95564938?s=60&v=4)](/an5er)

**[an5er](/an5er)**
approved these changes
[May 14, 2024](#pullrequestreview-2054270625)

 [View reviewed changes](/apache/dolphinscheduler/pull/15758/files/f606e310893405e4a871d6085b54e127f273fee8)

[![qingwli](https://avatars.githubusercontent.com/u/20885366?s=60&v=4)](/qingwli)

**[qingwli](/qingwli)**
approved these changes
[May 14, 2024](#pullrequestreview-2054882472)

 [View reviewed changes](/apache/dolphinscheduler/pull/15758/files/f606e310893405e4a871d6085b54e127f273fee8)

Copy link

Member

### @qingwli **[qingwli](/qingwli)** left a comment

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

+1 PTAL [@SbloodyS](https://github.com/SbloodyS) [@kezhenxu94](https://github.com/kezhenxu94)

Sorry, something went wrong.

All reactions

 Hide details
View details

[![@ruanwenjun](https://avatars.githubusercontent.com/u/22415594?s=40&u=0e5f698f478492cd504651ffe138175214ec4598&v=4)](/ruanwenjun)
[ruanwenjun](/ruanwenjun)
merged commit [`dc306bf`](/apache/dolphinscheduler/commit/dc306bfa1d3ed72eb7b72b177e33a46042d2a9c3)
into
apache:dev

[May 14, 2024](https://github.com/apache/dolphinscheduler/pull/15758#event-12799488863)
61 of 63 checks passed

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fapache%2Fdolphinscheduler%2Fpull%2F15758)

Reviewers

[![@an5er](https://avatars.githubusercontent.com/u/95564938?s=40&v=4)](/an5er) [an5er](/an5er)

an5er approved these changes

[![@ruanwenjun](https://avatars.githubusercontent.com/u/22415594?s=40&v=4)](/ruanwenjun) [ruanwenjun](/ruanwenjun)

ruanwenjun approved these changes

[![@qingwli](https://avatars.githubusercontent.com/u/20885366?s=40&v=4)](/qingwli) [qingwli](/qingwli)

qingwli approved these changes

[![@caishunfeng](https://avatars.githubusercontent.com/u/11962619?s=40&v=4)](/caishunfeng) [caishunfeng](/caishunfeng)

 Awaiting requested review from caishunfeng

 caishunfeng is a code owner

[![@SbloodyS](https://avatars.githubusercontent.com/u/17822915?s=40&v=4)](/SbloodyS) [SbloodyS](/SbloodyS)

 Awaiting requested review from SbloodyS

 SbloodyS is a code owner

[![@zhuangchong](https://avatars.githubusercontent.com/u/37063904?s=40&v=4)](/zhuangchong) [zhuangchong](/zhuangchong)

 Awaiting requested review from zhuangchong

[![@kezhenxu94](https://avatars.githubusercontent.com/u/15965696?s=40&v=4)](/kezhenxu94) [kezhenxu94](/kezhenxu94)

 Awaiting requested review from kezhenxu94

[![@Radeity](https://avatars.githubusercontent.com/u/45198818?s=40&v=4)](/Radeity) [Radeity](/Radeity)

 Awaiting requested review from Radeity

[![@rickchengx](https://avatars.githubusercontent.com/u/38122586?s=40&v=4)](/rickchengx) [rickchengx](/rickchengx)

 Awaiting requested review from rickchengx

Assignees

[![@EricGao888](https://avatars.githubusercontent.com/u/34905992?s=40&v=4)](/EricGao888) [EricGao888](/EricGao888)

Labels

[3.2.2](/apache/dolphinscheduler/labels/3.2.2)
[backend](/apache/dolphinscheduler/labels/backend)
[improvement](/apache/dolphinscheduler/labels/improvement)
make more easy to user or prompt friendly
[priority:high](/apache/dolphinscheduler/labels/priority%3Ahigh)

Projects

None yet

Milestone

 [**3.2.2**](/apache/dolphinscheduler/milestone/56 "3.2.2")

Development

Successfully merging this pull request may close these issues.

9 participants

[![@EricGao888](https://avatars.githubusercontent.com/u/34905992?s=52&v=4)](/EricGao888) [![@codecov-commenter](https://avatars.githubusercontent.com/u/65553080?s=52&v=4)](/codecov-commenter) [![@Liyw979](https://avatars.githubusercontent.com/u/16919236?s=52&v=4)](/Liyw979) [![@an5er](https://avatars.githubusercontent.com/u/95564938?s=52&v=4)](/an5er) [![@caishunfeng](https://avatars.githubusercontent.com/u/11962619?s=52&v=4)](/caishunfeng) [![@kezhenxu94](https://avatars.githubusercontent.com/u/15965696?s=52&v=4)](/kezhenxu94) [![@SbloodyS](https://avatars.githubusercontent.com/u/17822915?s=52&v=4)](/SbloodyS) [![@qingwli](https://avatars.githubusercontent.com/u/20885366?s=52&v=4)](/qingwli) [![@ruanwenjun](https://avatars.githubusercontent.com/u/22415594?s=52&v=4)](/ruanwenjun)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.

