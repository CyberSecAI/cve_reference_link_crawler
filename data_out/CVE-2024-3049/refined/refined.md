```
{
  "CVE-2024-3049": {
    "description": "The Booth cluster ticket manager is vulnerable to accepting invalid HMAC due to a specially crafted hash being passed to `gcry_md_get_algo_dlen()`. This could allow unauthorized access or resource manipulation in a multi-site cluster environment.",
    "root_cause": "The vulnerability lies in the `gcry_md_get_algo_dlen()` function, which returns 0 for an unknown or specially crafted hash. This value is then used in a memcmp operation, allowing an attacker to potentially bypass the HMAC check.",
    "weaknesses": [
      "Improper validation of cryptographic hash algorithm.",
      "Use of a function that returns 0 instead of an error for an unsupported hash.",
       "Insufficient checks before performing memcmp operations using the result of a cryptographic function.",
       "Lack of proper error handling and validation of the result of gcry_md_get_algo_dlen()."
    ],
    "impact": "An attacker can bypass the HMAC authentication, potentially leading to unauthorized access and resource manipulation in a multi-site cluster environment. This could result in the cluster running resources at a wrong site, potentially causing service disruption or other critical issues.",
    "attack_vectors": "The attack vector involves sending a specially crafted hash to the Booth server. If the server doesn't properly validate the hash algorithm and uses its output in HMAC verification, an attacker can cause a zero-length comparison allowing them to forge an valid signature.",
    "required_capabilities": "The attacker needs to be able to communicate with the Booth server over the network and must have the ability to send specially crafted hashes."
  }
}
```