The provided content describes a path traversal vulnerability affecting multiple Flask applications. The vulnerability stems from the usage of `flask.send_file` with unsanitized, attacker-controlled input, often combined with the unsafe `os.path.join` function.

**Root Cause:**
- Passing untrusted input to `flask.send_file` allows attackers to specify arbitrary file paths.
-  `os.path.join` is used improperly, as when it encounters an absolute path, it ignores all preceding parameters, allowing the attacker to provide an absolute path that will bypass any intended directory restrictions.

**Vulnerabilities:**
- Path traversal vulnerability.
- Use of unsafe functions: `flask.send_file` and `os.path.join`.

**Impact of Exploitation:**
- Attackers can access arbitrary files and directories stored on the file system, including application source code, configuration files, and critical system files.
- Potential for information disclosure of sensitive data.
- Possibility of a partial denial-of-service by requesting large files, though this is a low impact.

**Attack Vectors:**
- By manipulating the `filename` parameter passed to `flask.send_file`.
- Using `../` sequences or absolute paths.
- HTTP requests with manipulated path parameters.

**Required Attacker Capabilities/Position:**
- Ability to send HTTP requests to the vulnerable application.
- No special privileges required to exploit.
- Can be done remotely over the network.

**Additional details:**
- The vulnerability was discovered using CodeQL by GitHub.
- The issue was reported to multiple projects, with fixes suggested using either `flask.safe_join` or `flask.send_from_directory`.
- The vulnerability has a CVSS v3.1 base score of 9.3, rated as critical (AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:N/A:L).
- There is discussion about the validity of CVEs for small personal projects.
- There was an initial coordinated vulnerability disclosure issue due to the public nature of the issues/PRs, but the reporter's understanding of CVD was different from GHSL's.

**Example vulnerable code (from the various references):**

```python
# Vulnerable code
# https://github.com/piaoyunsoft/bt_lnmp/blob/fa49519b04586a00e76c105e7ce1da36eadf6922/www/server/panel/BTPanel/__init__.py#L858
def download_file(filename):
    return flask.send_file(filename)

#Vulnerable Code
#https://github.com/nrlakin/homepage/blob/82ffb967f370bfe84b6e954a59022f37f4f105c1/home/frontend/views.py#L78
def download(filename):
    static = "path/to/mySafeStaticDir"
    file_path = os.path.join(static, filename)
    return flask.send_file(file_path)

#Vulnerable Code
#https://github.com/AFDudley/equanimity/blob/16862abb282f174ceb7ca297c956565fcfb188ad/server/views/frontend.py#L25
def get_js(path):
    js_dir = "server/static/js"
    file_path = os.path.join(js_dir, path)
    return flask.send_file(file_path)

#Vulnerable code
#https://github.com/ganga-devs/ganga/blob/0c0f9e33b36ee7ead0855f1464f8d4efad26bdbc/ganga/GangaGUI/gui/routes.py#L671
def browse(job_id, path):
    file_path = os.path.join(job_dir, path)
    return flask.send_file(file_path)

#Vulnerable Code
#https://github.com/HolgerGraef/MSM/blob/6dd2c9557e0285e1270c84375ebd6f8d10e422a4/app/main/views.py#L544
def get_plugin(path):
    plugin_dir = "app/plugins"
    file_path = os.path.join(plugin_dir, path)
    return flask.send_file(file_path)
```