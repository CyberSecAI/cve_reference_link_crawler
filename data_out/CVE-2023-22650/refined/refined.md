Based on the provided content, here's a breakdown of the vulnerability associated with CVE-2023-22650:

**Root Cause of Vulnerability:**
- Rancher does not automatically remove users who have been deleted, disabled, or revoked from the configured authentication provider (AP). This means that even if a user's account is no longer valid in the external system, their access privileges within Rancher may remain active.

**Weaknesses/Vulnerabilities:**
- Inconsistent user state between Rancher and the configured Authentication Provider.
- Failure to synchronize user status changes (deletion, disablement, revocation) from the AP to Rancher.
- Inactive user tokens may remain usable within Rancher.

**Impact of Exploitation:**
- Unauthorized access to Rancher resources by revoked or disabled users.
- Potential for an attacker to leverage active user privileges within Rancher, despite their invalid status on the AP, leading to unauthorized actions.

**Attack Vectors:**
- Network-based attack vector, as the attacker would need network access to interact with Rancher.
- An attacker could potentially use leaked or previously valid tokens of a user who has been removed/disabled from the AP to gain access to Rancher.

**Required Attacker Capabilities/Position:**
- The attacker needs network access to the Rancher system.
- The attacker needs to obtain and use valid tokens of a user who has been removed/disabled from the authentication provider.
- Low privileges are required to exploit the vulnerability.

**Additional Details:**
- The vulnerability affects all configurable Authentication Providers within Rancher, except the built-in User Management feature.
- The fix introduces a configurable user retention process that can disable and/or delete inactive users based on their login activity.
- The user retention process is disabled by default and needs to be enabled and configured by the user.
- The provided workaround suggests regularly auditing the APâ€™s user accounts and manually deactivating/removing them from Rancher.
- The CVSS score is 8.8, categorized as High severity.
- The attack complexity is low.
- No user interaction is required to exploit this vulnerability.