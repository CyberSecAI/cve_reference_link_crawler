[![StackHawk](data:image/svg+xml;base64...)](/)

* Product![Caret Down](data:image/svg+xml;base64...)
  ##### BLOG

  ### How Does StackHawk Work?

  StackHawk helps teams ship secure software faster and eliminate disruptive fix processes.

  [Read Now![Right Arrow Icon](data:image/svg+xml;base64...)](/blog/how-does-stackhawk-work/)
  ### Our Product

  [+ ![Explore Stackhawk](data:image/png;base64...)
    #### Explore Stackhawk

    Purpose-built for todays modern engineering teams](/product/)[+ ![Watch a Demo](data:image/png;base64...)
    #### Watch a Demo

    See StackHawk in flight](/demo/)[+ ![Getting Started](data:image/png;base64...)
    #### Getting Started

    Gain AppSec insights from expert articles and fix guides](https://docs.stackhawk.com/getting-started/)
* Solutions![Caret Down](data:image/svg+xml;base64...)![API Discovery](data:image/png;base64...)
  ### API Discovery

  Find every API in your attack surface in 15 minutes. Quickly bring them under test with automated prioritization for the most critical APIs and gain complete oversight of your attack surface.

  [Get Started for Free![Right Arrow Icon](data:image/svg+xml;base64...)](https://auth.stackhawk.com/signup)
  ### Solutions

  [+ #### API Discovery

    Discover every API in your attack surface](/solutions/api-discovery/)[+ #### Oversight

    Centralized API & Application Security Management](/solutions/oversight/)[+ #### Modern DAST

    Automate application and API security testing in CI/CD workflows](/solutions/dast/)[+ #### Getting Started With AppSec

    Test early, test often, and deliver secure applications](/solutions/getting-started-with-appsec/)[+ #### DevSecOps

    Application security at the speed of DevOps](/solutions/devsecops/)[+ #### API Security Testing

    Ship secure APIs with automated testing in CI/CD](/solutions/api-security-testing/)[+ #### Developer-First AppSec

    Scale application security through engineering](/solutions/developer-centric-application-security/)[+ #### OWASP Top 10

    Testing for OWASP top 10, automated in CI/CD](/solutions/owasp-top-10/)[+ #### GraphQL Security Testing

    Check for GraphQL vulnerabilities on every pull request](/solutions/graphql-security-testing/)[+ #### gRPC Security Testing

    Keep your gRPC services secure with automated security testing](/solutions/gRPC/)
* Integrations![Caret Down](data:image/svg+xml;base64...)
  ### Integrate with your existing tools and workflows

  Purpose-built to integrate with the third-party tools, workflows, and processes in your developer environment.

  [See all integrations![Right Arrow Icon](data:image/svg+xml;base64...)](/integrations/)
  ### Integrations

  [+ ![GitHub](data:image/png;base64...)
    #### GitHub

    Integrate security testing in developer workflows ![Right Arrow Icon](data:image/svg+xml;base64...)](/github/)[+ ![Snyk](data:image/png;base64...)
    #### Snyk

    Correlate Dynamic DAST and SAST Results ![Right Arrow Icon](data:image/svg+xml;base64...)](/snyk/)[+ ![AWS](data:image/png;base64...)
    #### AWS

    Integrate into your AWS Environment ![Right Arrow Icon](data:image/svg+xml;base64...)](/partners/aws/)[+ ![Atlassian](data:image/png;base64...)
    #### Atlassian

    StackHawk data can be viewed in the new Security tab in Jira ![Right Arrow Icon](data:image/svg+xml;base64...)](/atlassian/)[+ ![Microsoft](data:image/svg+xml;base64...)
    #### Microsoft

    Integrate security testing in your Microsoft ecosystem ![Right Arrow Icon](data:image/svg+xml;base64...)](/partners/microsoft/)
* Customers![Caret Down](data:image/svg+xml;base64...)
  ### Our Hawksome Customers

  "With StackHawk, our scanning timeframes have decreased from days and hours to minutes."

  [Read More![Right Arrow Icon](data:image/svg+xml;base64...)](/customers/)
  ### Explore Featured Stories

  [+ ![Change.org](data:image/svg+xml;base64...)

    Change.org Brings in Dev-First Security Solutions to Improve Security Posture ![Right Arrow Icon](data:image/svg+xml;base64...)](/customers/change-org/)[+ ![One Medical](data:image/svg+xml;base64...)

    One Medical Automates Application Security Testing with StackHawk ![Right Arrow Icon](data:image/svg+xml;base64...)](/customers/one-medical/)[+ ![Planetly](data:image/svg+xml;base64...)

    Planetly Selects StackHawk Over Building Internal Service ![Right Arrow Icon](data:image/svg+xml;base64...)](/customers/planetly/)[+ ![Breathe Life](data:image/svg+xml;base64...)

    Breathe Life Deploys StackHawk and Snyk for a Dev-Centric Application Security Program ![Right Arrow Icon](data:image/svg+xml;base64...)](/customers/breathe-life/)
* Docs![Caret Down](data:image/svg+xml;base64...)![StackHawk + GitHub](data:image/svg+xml;base64...)
  ### StackHawk + GitHub

  Begin your StackHawk journey to safer, faster, and more secure software.

  [Start the Tutorial![Right Arrow Icon](data:image/svg+xml;base64...)](https://docs.stackhawk.com/getting-started/javaspringvulny-gh-actions/intro.html#automate-tests-with-github-actions-tutorial)
  ### Hawkdocs

  [+ ![Getting Started](data:image/svg+xml;base64...)
    #### Getting Started

    Learn how to start scanning your application or API](https://docs.stackhawk.com/getting-started/)[+ ![StackHawk API](data:image/svg+xml;base64...)
    #### StackHawk API

    Explore the StackHawk API and start integrating today](https://apidocs.stackhawk.com/reference/createapplication)[+ ![Integrations](data:image/svg+xml;base64...)
    #### Integrations

    Integrate with the most popular developer tools](https://docs.stackhawk.com/workflow-integrations/)[+ ![StackHawk Platform](data:image/svg+xml;base64...)
    #### StackHawk Platform

    Identify, investigate, and triage security bugs in one place](https://docs.stackhawk.com/web-app/)[+ ![Authentication](data:image/svg+xml;base64...)
    #### Authentication

    Effectively scan authenticated routes and API endpoints in your application](https://docs.stackhawk.com/hawkscan/authenticated-scanning/)[Read More Docs![Right Arrow Icon](data:image/svg+xml;base64...)](https://docs.stackhawk.com/)
[* Pricing](/pricing/)* Resources![Caret Down](data:image/svg+xml;base64...)
  ##### BLOG

  ### Dynamic Application Security Testing: Overview and Tooling

  DAST is a form of testing running applications & APIs to find security bugs.

  [Read Now![Right Arrow Icon](data:image/svg+xml;base64...)](/blog/dynamic-application-security-testing-overview/)
  ### Resources

  [+ ![Maturity Model](data:image/png;base64...)
    #### Maturity Model

    The Shift-Left Maturity Model](/resources/shift-left-maturity-model/)[+ ![Watch a Demo](data:image/svg+xml;base64...)
    #### Watch a Demo

    See StackHawk in flight](/demo/)[+ ![Blog](data:image/svg+xml;base64...)
    #### Blog

    Gain AppSec insights from expert articles and fix guides](/blog/)[+ ![Getting Started](data:image/svg+xml;base64...)
    #### Getting Started

    Get up and running with StackHawk CLI and HawkScan in minutes](https://docs.stackhawk.com/getting-started/)[+ ![Press Room](data:image/svg+xml;base64...)
    #### Press Room

    Catch up on the latest news in the Nest](/press/)[+ ![About](data:image/svg+xml;base64...)
    #### About

    Kaakaww!! Meet the our Hawksome team and check out our job board](/about/)
[* Sign In](https://auth.stackhawk.com/login)[Start Free Trial](https://auth.stackhawk.com/signup)![Hamburger Icon](data:image/svg+xml;base64...)
# Rails Path Traversal Guide: Examples and Prevention

![](data:image/svg+xml;charset=utf-8...)![](data:image/png;base64...)![stackhawk]()![stackhawk](https://images.ctfassets.net/nx13ojx82pll/2tME18Zz0zJWJEELygWySD/e84e4bc45c8e5a516de565e9c48a680c/stackhawk.png?w=113&h=113&q=80&fm=png)

StackHawk|July 27, 2021

In this post, you'll learn what the path traversal vulnerability is and how to prevent it in the case of the Ruby on Rails application.

Cyberattacks are happening pretty much constantly these days. Even if you follow general security best practices, there are many language- and framework-specific vulnerabilities that attackers can try to exploit. One of these vulnerabilities is the so-called path traversal vulnerability.Â

In this post, you'll learn what the path traversal vulnerability is and how to prevent it in the case of the Ruby on Rails application.

## What's Path Traversal Vulnerability?

A path traversal vulnerability, sometimes also called a directory traversal attack, is a type of vulnerability that allows attackers to access files to which they shouldn't have access. For example, an attacker may try to access the **/etc/passwd** file on your host operating system.Â

This vulnerability happens when your web application doesn't properly validate the paths that the user is requesting. For now, we'll focus on path traversal in the context of the Rails framework.

![](data:image/svg+xml;charset=utf-8...)![](data:image/png;base64...)![Rails Path Traversal Guide: Examples and Prevention image]()![Rails Path Traversal Guide: Examples and Prevention image](https://images.ctfassets.net/nx13ojx82pll/15MMK9yDgRafrC8Wr20mXU/9b4ea4050cd72afddb19500ce01aceec/rails-path-traversal-guide-examples-and-prevention-picture-1.png?w=924&h=1164&q=80&fm=png)
## Path Traversal in Rails

In order to understand how path traversal can happen in Rails, we need to first understand how Rails handles paths in general. There are three most common ways of serving files in Rails.Â

First, we have assets pipeline files. These are all the CSS, JavaScript, and image files that Rails needs for rendering the HTML code. For example, your website logo is a good candidate to be in the assets directory. Anything that's there will have a Rails-generated path assigned. So you don't access these files directly (as in **www.example.com/assets/logo.jpg**), but you let Rails generate and use a path for you.Â

Next, we have the Rails public directory. This is a folder where you can put any file that you need to serve to clients. So, for example, if you need a **marketing1.jpg** file accessible as **www.example.com/marketing1.jpg**, you can just put it into the public directory. It's worth noting here that serving files from the public directory can be done by Rails itself but can also be offloaded to a web server (for example, [Apache](https://httpd.apache.org/) or [NGINX](https://www.nginx.com/)).Â

Lastly, we have dedicated libraries for serving images on your website. Depending on your Rails version, this could be handled by third-party libraries (such as [Paperclip](https://github.com/thoughtbot/paperclip) or [CarrierWave](https://github.com/carrierwaveuploader/carrierwave)) or, in the case of the latest Rails versions, natively by [Active Storage](https://edgeguides.rubyonrails.org/active_storage_overview.html).Â

Now, all of these different options for getting the path of a specific file will give you different results. And the possibility of a path traversal vulnerability differs for all of them. So let's get back to the topic of this post. What does the path traversal attack actually look like?

## Path Traversal

You know already that publicly available files in your Rails application are located in the same folder as the rest of your application. Our goal is to only show the users the files they're supposed to see. For instance, the contents of the public folder. But you wouldn't like users to see your Gemfile or environment configuration files.

Let's look at an example. When a user opens **www.example.com/example.jpg**, Rails looks for **example.jpg** in the **/app/public** folder. But just two directories higher is your Gemfile (**/Gemfile**).Â

So you want to avoid the situation where a user simply opens **www.example.com/../../Gemfile** and is able to see your Gemfile. That's path traversal vulnerability: the ability to manipulate a URL in order to read files that shouldn't be read. Fortunately, it's not that simple, and Rails, by default, protects you from such obvious misusages.Â

However, attackers can try different ways of forcing Rails to go up or down directories. For example, using URL-encoding characters:Â

`https://www.example.com/%2e%2e/%2e%2e/Gemfile`

**%2e** is a URL-encoded version of a dot ( . ); therefore, effectively we're asking for the same path as before: **../../Gemfile.** This is just an example. Fortunately, Rails will protect you from that too.Â

But while Rails is smart enough to protect you from most attempts, it's not bulletproof. So let's talk about preventing path traversal.

## Prevention

The good news is that because of the way Rails works (you barely write raw code but you use Rails methods and helpers), you don't need to do anything specific to protect yourself from path traversal vulnerability. As we mentioned before, commonly used methods in Rails already protect you from path traversal.Â

The problem may arise when you don't use native Rails path-generation mechanisms or you start generating paths from user input. So the most important prevention mechanism is to not build any custom path-handling logic yourself and use Rails-native methods instead.

![](data:image/svg+xml;charset=utf-8...)![](data:image/png;base64...)![Rails Path Traversal Guide: Examples and Prevention image]()![Rails Path Traversal Guide: Examples and Prevention image](https://images.ctfassets.net/nx13ojx82pll/4HAMBXzwPqitEcwWUZxBiR/6eb2291be4c6950b47c1ec94eae1fd17/rails-path-traversal-guide-examples-and-prevention-picture-2.png?w=1558&h=1038&q=80&fm=png)
### Vulnerable Rails

The bad news is some of the built-in Rails libraries or gems can have this vulnerability. One of the most common examples is [CVE](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-0130), found in actionpack.Â

On the other hand, if you're building a very custom application, you may find yourself in a situation where you need to, for example, integrate your application with some legacy system. Sometimes such integrations require you to handle files and directories on the file system in a non-Rails-native way.Â

### Watch Out for User Input

One of the best ways to create a path traversal vulnerability in your application is to directly use the user input as a variable for path generation. In many cases, this bypasses default Rails security mechanisms, allowing attackers to manipulate a path that you never intended them to.

If your use case requires getting user input for building a path, make sure to **validate and sanitize** that input before using it as a variable for path methods.

### Non-Root

Another good practice that can help you avoid a path traversal vulnerability is to run your application as a non-root user. In the case of a path traversal vulnerability, this will still allow attackers to get access to the application directory but will at least prevent them from accessing **/etc** or **/root** directories on your host machine.Â

### Gems

Last but not least: gems. We all love gems. They drastically simplify Ruby on Rails applications development. However, they can sometimes be buggy. While the most commonly used gems are safe (or at least patched quickly in case of a found vulnerability), you should be careful when installing gems that are really old or that haven't been updated for a long time and don't have much information about them on the internet. Sometimes it's better to write a little bit of extra code yourself instead of using a gem that was last updated 10 years ago.

## Summary

When it comes to the path traversal vulnerability, the bottom line is that it's a very exotic attack vector, and Rails, by default, protects you from it. However, that doesn't mean that you're safe and don't need to worry about it. By using user input without validation or when using very old Rails versions, you can still become compromised. Path traversal, in the worst-case scenario, can give an attacker full access to your machine (if, for example, they manage to read the private SSH key of the root user). Therefore, it's always a good idea to keep your Rails version up to date.Â

But even if you follow security best practices, there's always a chance that you'll leave one small vulnerable line of code or won't update your Rails in time. To avoid becoming exposed, you'd benefit from keeping security scanning as part of your CI/CD pipeline and having a continuous overview of your security posture. For that, you can use [StackHawk.](https://www.stackhawk.com/) It's a modern application security tool that can help you avoid not only path traversal but many other vulnerabilities too. And if you want to learn more about application security testing, feel free to read [this post](https://www.stackhawk.com/blog/dynamic-application-security-testing-overview/).Â

*This post was written by Dawid Ziolkowski.* [*Dawid*](https://medium.com/%40dawid.ziolkowski) *has 10 years of experience as a Network/System Engineer at the beginning, DevOps in between, Cloud Native Engineer recently. Heâs worked for an IT outsourcing company, a research institute, telco, a hosting company, and a consultancy company, so heâs gathered a lot of knowledge from different perspectives. Nowadays heâs helping companies move to cloud and/or redesign their infrastructure for a more Cloud Native approach.*

---

StackHawkÂ Â |Â Â July 27, 2021
#### Read More

[![](data:image/png;base64...)![Add AppSec to Your CircleCI Pipeline With the StackHawk Orb]()![Add AppSec to Your CircleCI Pipeline With the StackHawk Orb](https://images.ctfassets.net/nx13ojx82pll/1l6NnEXw6fDC4JMKmuMki3/516d829c0a2b15af29638cf23b814260/add-appsec-to-circle-ci-pipeline-thumbnail.png?w=704&h=252&q=100&fm=png)

Add AppSec to Your CircleCI Pipeline With the StackHawk Orb](/blog/add-appsec-to-circle-ci-pipeline/)[![](data:image/png;base64...)![Application Security is Broken. Here is How We Intend to Fix It.]()![Application Security is Broken. Here is How We Intend to Fix It.](https://images.ctfassets.net/nx13ojx82pll/6jDrn6T3XfilS5PE7D4xSD/40c9d679644758a59329957d9d898e7e/application-security-is-broken-thumbnail.png?w=704&h=252&q=100&fm=png)

Application Security is Broken. Here is How We Intend to Fix It.](/blog/application-security-is-broken/)[![](data:image/png;base64...)![Using StackHawk in GitLab Know Before You Go (Live)]()![Using StackHawk in GitLab Know Before You Go (Live)](https://images.ctfassets.net/nx13ojx82pll/7lFuyRreSjawJ34hP6T8cd/b92944668516f1cb2fc643db472b7e11/using-stackhawk-in-gitlab-know-before-you-go-live-thumbnail.png?w=704&h=252&q=100&fm=png)

Using StackHawk in GitLab Know Before You Go (Live)](/blog/using-stackhawk-in-gitlab-know-before-you-go-live/)![Open Source Stackhawk Logo](data:image/svg+xml;base64...)
#### Product

* [Overview](/product/)
* [Watch a Demo](/demo/)
* [Pricing](/pricing/)
* [Sign In](https://auth.stackhawk.com/signup)
#### Resources

* [Blog](/blog/)
* [Press Room](/press/)
* [Documentation](https://docs.stackhawk.com)
* [Getting Started](https://docs.stackhawk.com/getting-started/)
#### Company

* [Customers](/customers/)
* [Team](/about/#team)
* [Jobs](/jobs/)We're Hiring
* [Security](/security/)
#### Get In Touch

* [Contact Us](/contact/)
* hello@stackhawk.com
* StackHawk Inc.
  1580 N. Logan St Ste 660
  PMB 36969
  Denver, CO 80203
* Follow
* [Visit Stackhawk's X Account](https://twitter.com/stackhawk)[Visit Stackhawk's Linkedin Company Profile](https://www.linkedin.com/company/stackhawk/mycompany/)[Visit Stackhawk's Facebook Account](https://www.facebook.com/StackHawk/)[Visit Stackhawk's Github Account](https://github.com/kaakaww)

---

Â©2024 StackHawk Inc., All Rights Reserved

|[Terms](/terms-of-service/)|[Privacy](/privacy-policy/)|[Sitemap](/sitemap/)

Crafted in Colorado

