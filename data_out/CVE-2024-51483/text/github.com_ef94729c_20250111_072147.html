ChangeDetection.io Path Travsersal

GitHub - dgtlmoon/changedetection.io: The best and simplest free open source web page change detection, website watcher,  restock m

onitor and notification service. Restock Monitor, change detection. Designed for simplicity - Simply monitor which websites had a text chang

e for free. Free Open source web page change detection, Website defacement monitoring, Price change notification

There’s a path traversal issue in changedetection when an external webdriver is used. In this example the path traversal is retrieving the file

from the webdriver container, however in production this is likely to be deployed on the same server as changedetection or other resources

with potentially sensitive information.

The root cause is the payload  source:file:///etc/passwd passes the regex here and also passes the check here where a traditional

file:///etc/passwd  would get blocked

Setup

 Run two containers following the wiki instructions to enable a webdriver for more dynamic web pages:

1. Start WebDriver Container

1 docker run --name selenium --restart unless-stopped -p 4444:4444 --shm-size="2g"  selenium/standalone-chrome-

debug:3.141.59

2. Start changedetection.io Container

1 docker run --link selenium  -p "127.0.0.1:5000:5000"  -e WEBDRIVER_URL="http://selenium:4444/wd/hub"  -v

datastore-volume:/datastore dgtlmoon/changedetection.io

Steps to Reproduce

1. Run the setup commands

2. Visit http://127.0.0.1:5000/ in a web browser

3. Navigate to Fetch Settings and enable the WebDriver http://127.0.0.1:5000/settings#fetching

  4. Back at the main screen enter source:file:///etc/passwd in the form

5. Click Watch and wait a few seconds

6. Refresh the page and click the Preview Button, the contents of the webdriver’s /etc/passwd file is displayed

Trying with just file:///etc/passwd gets blocked

