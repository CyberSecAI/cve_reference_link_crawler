
[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsickcodes%2Fsecurity%2Fblob%2Fmaster%2Fadvisories%2FSICK-2021-011.md)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsickcodes%2Fsecurity%2Fblob%2Fmaster%2Fadvisories%2FSICK-2021-011.md)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=sickcodes%2Fsecurity)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[sickcodes](/sickcodes)
/
**[security](/sickcodes/security)**
Public

* [Notifications](/login?return_to=%2Fsickcodes%2Fsecurity) You must be signed in to change notification settings
* [Fork
  18](/login?return_to=%2Fsickcodes%2Fsecurity)
* [Star
   86](/login?return_to=%2Fsickcodes%2Fsecurity)

* [Code](/sickcodes/security)
* [Issues
  1](/sickcodes/security/issues)
* [Pull requests
  0](/sickcodes/security/pulls)
* [Actions](/sickcodes/security/actions)
* [Projects
  0](/sickcodes/security/projects)
* [Security](/sickcodes/security/security)
* [Insights](/sickcodes/security/pulse)

Additional navigation options

* [Code](/sickcodes/security)
* [Issues](/sickcodes/security/issues)
* [Pull requests](/sickcodes/security/pulls)
* [Actions](/sickcodes/security/actions)
* [Projects](/sickcodes/security/projects)
* [Security](/sickcodes/security/security)
* [Insights](/sickcodes/security/pulse)

## Files

 master
## Breadcrumbs

1. [security](/sickcodes/security/tree/master)
2. /[advisories](/sickcodes/security/tree/master/advisories)
/
# SICK-2021-011.md

 Blame  Blame
## Latest commit

## History

[History](/sickcodes/security/commits/master/advisories/SICK-2021-011.md)170 lines (108 loc) · 6.15 KB master
## Breadcrumbs

1. [security](/sickcodes/security/tree/master)
2. /[advisories](/sickcodes/security/tree/master/advisories)
/
# SICK-2021-011.md

Top
## File metadata and controls

* Preview
* Code
* Blame

170 lines (108 loc) · 6.15 KB[Raw](https://github.com/sickcodes/security/raw/refs/heads/master/advisories/SICK-2021-011.md)
### Title

netmask npm package - Improper Input Validation in netmask npm package v1.1.0 and below of octal literals results in indeterminate SSRF & RFI vulnerabilities.

### CVE ID

CVE-2021-28918

### CVSS Score

9.1

CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N

### Internal ID

SICK-2021-011

### Vendor

netmask project

### Product

netmask

### Product Versions

v1.1.0 and below

### Vulnerability Details

Improper input validation of octal strings in widely used netmask npm package v1.1.0 and below allows unautenticated remote attackers to perform indeterminate SSRF, RFI, and LFI attacks on many of the dependent packages. The netmask npm package incorrectly evaluates individual ipv4 octets that contain octal strings as left-stripped integers, leading to an inordinate attack surface on hundreds of thousands of projects that rely on netmask to filter or evaluate ipv4 block ranges, both inbound and outbound. For example, a remote unauthenticated attacker can request local resources using input data 0177.0.0.1 (127.0.0.1), which netmask evaluates as public IP 177.0.0.1. Contrastingly, a remote authenticated or unauthenticated attacker can input the data 0127.0.0.01 (87.0.0.1) as localhost, yet the input data is a public IP and potentially cause local and remote file inclusion (LFI/RFI). A remote authenticated or unauthenticated attacker can bypass packages that rely on netmask to filter IP address blocks to reach intranets, VPNs, containers, adjacent VPC instances, or LAN hosts using input data such as 012.0.0.1 (10.0.0.1), which netmask evaluates as 12.0.0.1 (public).

### Vendor Response

Fixed in version v2.0.0

### Proof of Concept

```
# cd /tmp
mkdir -p netmask_poc/node_modules
cd netmask_poc
npm i netmask@1.0.6

node <<'EOF'

var Netmask = require('netmask').Netmask

var block = new Netmask('31.0.0.0/8');
block.base;                     // 10.0.0.0
block.mask;                     // 255.240.0.0
block.bitmask;                  // 12
block.hostmask;                 // 0.15.255.255
block.broadcast;                // 10.15.255.255
block.size;                     // 1048576
block.first;                    // 10.0.0.1
block.last;                     // 10.15.255.254

console.log(block.contains('#######################'));

console.log(block.first);
console.log('thru');
console.log(block.last);

console.log('is 31.5.5.5 in that block?');
console.log(block.contains('31.5.5.5'));

console.log('is 031.5.5.5 (25.5.5.5) in that block?');
console.log(block.contains('031.5.5.5'));

console.log('is 31.5.5.5 (25.5.5.5) in that block?');
console.log(block.contains('31.5.5.5'));

console.log(block.contains('#######################'));

var block = new Netmask('127.0.0.0/8');

console.log(block.first);
console.log('thru');
console.log(block.last);

console.log('is 127.0.0.2 in that block?');
console.log(block.contains('127.0.0.2'));

console.log('is 0177.0.0.2 (127.0.0.2) in that block?');
console.log(block.contains('0177.0.0.2'));

console.log(block.contains('#######################'));

var block = new Netmask('255.0.0.1/8');

console.log(block.first);
console.log('thru');
console.log(block.last);

console.log('is 255.255.255.2 in that block?');
console.log(block.contains('255.255.255.2'));

console.log('is 0255.0.0.2 (173.0.0.2) in that block?');
console.log(block.contains('0255.0.0.2'));

console.log(block.contains('#######################'));

var block = new Netmask('10.0.0.1/8');

console.log(block.first);
console.log('thru');
console.log(block.last);

console.log('is 10.5.7.1 in that block?');
console.log(block.contains('10.5.7.1'));

console.log('is 10.0.0.255 in that block?');
console.log(block.contains('012.0.0.255'));

console.log(block.contains('#######################'));

var block = new Netmask('1.0.0.1/8');

console.log(block.first);
console.log('thru');
console.log(block.last);

console.log('is 1.2.3.4 in that block?');
console.log(block.contains('1.2.3.4'));

console.log('is 01.2.3.4 in that block?');
console.log(block.contains('01.2.3.4'));

console.log(block.contains('#######################'));

EOF
```

#### Disclosure Timeline

* **2021-03-16** - Researchers discover vulnerability
* **2021-03-17** - Vendor notified
* **2021-03-17** - CVE requested
* **2021-03-19** - CVE assigned CVE-2021-28918
* **2021-03-28** - Vulnerability published

### Links

<https://github.com/sickcodes/security/blob/master/advisories/SICK-2021-011.md>

<https://sick.codes/universal-netmask-npm-package-used-by-270000-projects-vulnerable-to-octal-input-data-server-side-request-forgery-remote-file-inclusion-local-file-inclusion-and-more-cve-2021-28918>

<https://sick.codes/sick-2021-011>

<https://www.npmjs.com/package/netmask>

<https://github.com/rs/node-netmask>

### Researchers

Victor Viale: <https://github.com/koroeskohr> || <https://twitter.com/koroeskohr>

Sick Codes: <https://github.com/sickcodes> || <https://twitter.com/sickcodes>

Kelly Kaoudis: <https://github.com/kaoudis> || <https://twitter.com/kaoudis>

John Jackson <https://www.twitter.com/johnjhacking>

Nick Sahler: <https://github.com/nicksahler> || <https://twitter.com/tensor_bodega>

Olivier Poitrey <https://github.com/rs> || <https://twitter.com/olivier_poitrey>

#### CVE Links

<https://sick.codes/sick-2021-011>

<https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-28918>

<https://nvd.nist.gov/view/vuln/detail?vulnId=CVE-2021-28918>

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.

