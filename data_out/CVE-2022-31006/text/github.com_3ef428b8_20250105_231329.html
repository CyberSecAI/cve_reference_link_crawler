
[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fhyperledger%2Findy-node%2Fcommit%2F53a2a1bf1a26cb8ba710fd6adc8bcf275186a4b3)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fhyperledger%2Findy-node%2Fcommit%2F53a2a1bf1a26cb8ba710fd6adc8bcf275186a4b3)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=hyperledger%2Findy-node)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[hyperledger](/hyperledger)
/
**[indy-node](/hyperledger/indy-node)**
Public

* [Notifications](/login?return_to=%2Fhyperledger%2Findy-node) You must be signed in to change notification settings
* [Fork
  657](/login?return_to=%2Fhyperledger%2Findy-node)
* [Star
   687](/login?return_to=%2Fhyperledger%2Findy-node)

* [Code](/hyperledger/indy-node)
* [Issues
  37](/hyperledger/indy-node/issues)
* [Pull requests
  7](/hyperledger/indy-node/pulls)
* [Actions](/hyperledger/indy-node/actions)
* [Security](/hyperledger/indy-node/security)
* [Insights](/hyperledger/indy-node/pulse)

Additional navigation options

* [Code](/hyperledger/indy-node)
* [Issues](/hyperledger/indy-node/issues)
* [Pull requests](/hyperledger/indy-node/pulls)
* [Actions](/hyperledger/indy-node/actions)
* [Security](/hyperledger/indy-node/security)
* [Insights](/hyperledger/indy-node/pulse)

## Commit

[Permalink](/hyperledger/indy-node/commit/53a2a1bf1a26cb8ba710fd6adc8bcf275186a4b3)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Merge pull request from [GHSA-x996-7qh9-7ff7](https://github.com/advisories/GHSA-x996-7qh9-7ff7 "GHSA-x996-7qh9-7ff7")

[Browse files](/hyperledger/indy-node/tree/53a2a1bf1a26cb8ba710fd6adc8bcf275186a4b3)
Browse the repository at this point in the history

```
Update setup iptables script and documentation
```

* Loading branch information

[![@WadeBarnes](https://avatars.githubusercontent.com/u/10504350?s=40&v=4)](/WadeBarnes)

[WadeBarnes](/hyperledger/indy-node/commits?author=WadeBarnes "View all commits by WadeBarnes")
authored
Sep 9, 2022

2 parents
[6a06237](/hyperledger/indy-node/commit/6a062370fff311569a62314eb79e7dc70b47c8c8)
+
[300be0b](/hyperledger/indy-node/commit/300be0b3afa17ebde078bd327b31092fa080fd54)

commit 53a2a1b

 Show file tree

 Hide file tree

Showing
**2 changed files**
with
**285 additions**
and
**75 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* docs/source

  + docs/source/setup-iptables.md
    [setup-iptables.md](#diff-13ad9becfcb80a61fef0d58babd334abeb539ccbace500a594e789b23521dc22)
* scripts

  + scripts/setup\_iptables
    [setup\_iptables](#diff-bee5fd37089e4c02259ce64e98a810309a3944488a649123ae961bca9a2e1960)

## There are no files selected for viewing

95 changes: 48 additions & 47 deletions

95
[docs/source/setup-iptables.md](#diff-13ad9becfcb80a61fef0d58babd334abeb539ccbace500a594e789b23521dc22 "docs/source/setup-iptables.md")

Show comments

[View file](/hyperledger/indy-node/blob/53a2a1bf1a26cb8ba710fd6adc8bcf275186a4b3/docs/source/setup-iptables.md)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |

|  |  | @@ -1,70 +1,71 @@ |
|  |  | # Setup iptables rules (recommended) |
|  |  |  |
|  |  | It is strongly recommended to add iptables (or some other firewall) rule that limits the number of simultaneous clients |
|  |  | connections for client port. |
|  |  | There are at least two important reasons for this: |
|  |  | - preventing the indy-node process from reaching of open file descriptors limit caused by clients connections |
|  |  | - preventing the indy-node process from large memory usage as ZeroMQ creates the separate queue for each TCP connection. |
|  |  | It is strongly recommended to add iptables (or some other firewall) rules to limit the number of simultaneous clients |
|  |  | connections to your node's client port. |
|  |  |  |
|  |  | NOTE: limitation of the number of \*simultaneous clients connections\* does not mean that we limit the |
|  |  | number of \*simultaneous clients\* the indy-node works with in any time. The IndySDK client does not keep |
|  |  | connection infinitely, it uses the same connection for request-response session with some optimisations, |
|  |  | so it's just about \*\*connections\*\*, \*\*not\*\* about \*\*clients\*\*. |
|  |  | There are at least two important reasons for this: |
|  |  | - preventing the indy-node process from exceeding the limit of open file descriptors due to an excessive number of clients connections. |
|  |  | - controlling the indy-node process's memory use, as ZeroMQ creates a separate queue for each TCP connection. |
|  |  |  |
|  |  | Also iptables can be used to deal with various DoS attacks (e.g. syn flood) but rules' parameters are not estimated yet. |
|  |  | NOTE: The limitation of the number of \*simultaneous clients connections\* does not mean that we limit the |
|  |  | number of \*simultaneous clients\* indy-node works with in any time. Connections are not left open infinitely. The same connection is used for a request-response session with some optimisations and then closed, therefore it's just about \*\*connections\*\*, \*\*not\*\* about \*\*clients\*\*. |
|  |  |  |
|  |  | NOTE: you should be a root to operate with iptables. |
|  |  | NOTE: You will need to have sudo privileges to work with iptables. |
|  |  |  |
|  |  | ## Using indy scripts |
|  |  |  |
|  |  | ## Setting up clients connections limit |
|  |  | For ease of use and for people that are not familiar with iptables we've added two scripts: |
|  |  | - [`setup\_iptables`](https://github.com/hyperledger/indy-node/blob/main/scripts/setup\_iptables): |
|  |  | - By default this scripts adds rules to iptables to limit the number of simultaneous clients connections for a specified port. |
|  |  | - To get a full list of options run `./setup\_iptables -h` from the scripts directory. |
|  |  |  |
|  |  | #### Using raw iptables command or iptables front-end |
|  |  | - [`setup\_indy\_node\_iptables`](https://github.com/hyperledger/indy-node/blob/main/scripts/setup\_indy\_node\_iptables): |
|  |  | - A wrapper around `setup\_iptables` which gets client port and connection limit settings from the `/etc/indy/indy.env` that is created by the `init\_indy\_node` script. |
|  |  |  |
|  |  | In case of deb installation the indy-node environment file /etc/indy/indy.env is created by `init\_indy\_node` script. |
|  |  | This environment file contains client port (NODE\_CLIENT\_PORT) and recommended clients connections limit (CLIENT\_CONNECTIONS\_LIMIT). |
|  |  | This parameters can be used to add the iptables rule for chain INPUT: |
|  |  | Which one you use depends on how you installed indy-node on your server. Refer to the [For deb package based installations](#for-deb-package-based-installations), and [For pip based installations](#for-pip-based-installations) sections below. |
|  |  |  |
|  |  | ``` |
|  |  | # iptables -I INPUT -p tcp --syn --dport 9702 -m connlimit --connlimit-above 500 --connlimit-mask 0 -j REJECT --reject-with tcp-reset |
|  |  | ``` |
|  |  | Some key options: |
|  |  | - --dport - a port for which limit is set |
|  |  | - --connlimit-above - connections limit, exceeding new connections will be rejected using TCP reset |
|  |  | - --connlimit-mask - group hosts using the prefix length, 0 means "all subnets" |
|  |  | ### Updating the scripts and configuration |
|  |  |  |
|  |  | Corresponding fields should be set in case of some iptables front-end usage. |
|  |  | Before you run the scripts you should ensure you are using the latest scripts and recommended settings by following these steps while logged into your node: |
|  |  |  |
|  |  | 1. Make a backup copy of the existing `setup\_iptables` script by executing the command: |
|  |  | ``` |
|  |  | sudo cp /usr/local/bin/setup\_iptables /usr/local/bin/setup\_iptables\_$(date "+%Y%m%d-%H%M%S") |
|  |  | ``` |
|  |  |  |
|  |  | #### Using indy scripts |
|  |  | 1. Update the default client connection limit to 15000 in `/etc/indy/indy.env`. |
|  |  | - NOTE: |
|  |  | - `/etc/indy/indy.env` only exists for deb package based installations. |
|  |  | - `\1` is an excape sequence `\115000` is not a typo. |
|  |  | ``` |
|  |  | sudo sed -i -re "s/(^CLIENT\_CONNECTIONS\_LIMIT=).\*$/\115000/" /etc/indy/indy.env |
|  |  | ``` |
|  |  |  |
|  |  | For ease of use and for people that are not familiar with iptables we've |
|  |  | added two scripts: |
|  |  | - setup\_iptables: adds a rule to iptables to limit the number of simultaneous |
|  |  | clients connections for specified port; |
|  |  | - setup\_indy\_node\_iptables: a wrapper for setup\_iptables script which gets client |
|  |  | port and recommended connections limit from indy-node environment file that is created by init\_indy\_node script. |
|  |  | 1. Download the latest version of the script. |
|  |  | ``` |
|  |  | sudo curl -o /usr/local/bin/setup\_iptables https://raw.githubusercontent.com/hyperledger/indy-node/main/scripts/setup\_iptables |
|  |  | ``` |
|  |  | The sha256 checksum for the current version of the script is `a0e4451cc49897dc38946091b245368c1f1360201f374a3ad121925f9aa80664` |
|  |  |  |
|  |  | Links to these scripts: |
|  |  |  |
|  |  | - https://github.com/hyperledger/indy-node/blob/master/scripts/setup\_iptables |
|  |  | - https://github.com/hyperledger/indy-node/blob/master/scripts/setup\_indy\_node\_iptables |
|  |  |  |
|  |  | NOTE: for now the iptables chain for which the rule is added is not parameterized, |
|  |  | the rule is always added for INPUT chain, we can parameterize it in future if needed. |
|  |  | ### For deb package based installations |
|  |  |  |
|  |  | ###### For deb installation |
|  |  | To setup the limit of the number of simultaneous clients connections it is enough to run the following script without parameters |
|  |  | Run: |
|  |  | ``` |
|  |  | # setup\_indy\_node\_iptables |
|  |  | setup\_indy\_node\_iptables |
|  |  | ``` |
|  |  | This script gets client port and recommended connections limit from the indy-node environment file. |
|  |  | NOTE: |
|  |  | - This script should only be called \*after\* your node has been initialized using `init\_indy\_node`, to ensure `/etc/indy/indy.env` has been created. |
|  |  |  |
|  |  | NOTE: this script should be called \*after\* `init\_indy\_node` script. |
|  |  | ### For pip based installations |
|  |  |  |
|  |  | ###### For pip installation |
|  |  | The `setup\_indy\_node\_iptables` script can not be used in case of pip installation as indy-node environment file does not exist, |
|  |  | use the `setup\_iptables` script instead (9702 is a client port, 500 is recommended limit for now) |
|  |  | For pip based installations `/etc/indy/indy.env` does not exist, therefore `setup\_indy\_node\_iptables` cannot be used. Instead you run `setup\_iptables` directly. |
|  |  |  |
|  |  | For example, if your client port is 9702, you would run: |
|  |  | ``` |
|  |  | # setup\_iptables 9702 500 |
|  |  | setup\_iptables 9702 15000 |
|  |  | ``` |
|  |  | In fact, the `setup\_indy\_node\_iptables` script is just a wrapper for the `setup\_iptables` script. |
|  |  |  |
|  |  | ## Using raw iptables command or iptables front-end |
|  |  |  |
|  |  | If you are confident with using iptables, you may add additional rules as you see fit using iptables directly. |

 Loading

Oops, something went wrong.
 Retry

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `53a2a1b`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fhyperledger%2Findy-node%2Fcommit%2F53a2a1bf1a26cb8ba710fd6adc8bcf275186a4b3) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.

