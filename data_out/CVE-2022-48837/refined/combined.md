=== Content from git.kernel.org_f93bfc35_20250111_091519.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=56b38e3ca4064041d93c1ca18828c8cedad2e16c)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=56b38e3ca4064041d93c1ca18828c8cedad2e16c)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=56b38e3ca4064041d93c1ca18828c8cedad2e16c)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=56b38e3ca4064041d93c1ca18828c8cedad2e16c)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Dan Carpenter <dan.carpenter@oracle.com> | 2022-03-01 11:04:24 +0300 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2022-03-23 09:16:43 +0100 |
| commit | [56b38e3ca4064041d93c1ca18828c8cedad2e16c](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=56b38e3ca4064041d93c1ca18828c8cedad2e16c) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=56b38e3ca4064041d93c1ca18828c8cedad2e16c)) | |
| tree | [c80c0bb1617f05d0e8583cbd320452e46ccb8fc4](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=56b38e3ca4064041d93c1ca18828c8cedad2e16c) | |
| parent | [222f5e2d7f20a8852a4f79efb353b9f8adadfa1c](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=222f5e2d7f20a8852a4f79efb353b9f8adadfa1c) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=56b38e3ca4064041d93c1ca18828c8cedad2e16c&id2=222f5e2d7f20a8852a4f79efb353b9f8adadfa1c)) | |
| download | [linux-56b38e3ca4064041d93c1ca18828c8cedad2e16c.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-56b38e3ca4064041d93c1ca18828c8cedad2e16c.tar.gz) | |

usb: gadget: rndis: prevent integer overflow in rndis\_set\_response()commit 65f3324f4b6fed78b8761c3b74615ecf0ffa81fa upstream.
If "BufOffset" is very large the "BufOffset + 8" operation can have an
integer overflow.
Cc: stable@kernel.org
Fixes: 38ea1eac7d88 ("usb: gadget: rndis: check size of RNDIS\_MSG\_SET command")
Signed-off-by: Dan Carpenter <dan.carpenter@oracle.com>
Link: [https://lore.kernel.org/r/20220301080424.GA17208@kili](https://lore.kernel.org/r/20220301080424.GA17208%40kili)
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=56b38e3ca4064041d93c1ca18828c8cedad2e16c)

| -rw-r--r-- | [drivers/usb/gadget/function/rndis.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/usb/gadget/function/rndis.c?id=56b38e3ca4064041d93c1ca18828c8cedad2e16c) | 1 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 1 insertions, 0 deletions

| diff --git a/drivers/usb/gadget/function/rndis.c b/drivers/usb/gadget/function/rndis.cindex 0f14c5291af074..4150de96b937a7 100644--- a/[drivers/usb/gadget/function/rndis.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/usb/gadget/function/rndis.c?id=222f5e2d7f20a8852a4f79efb353b9f8adadfa1c)+++ b/[drivers/usb/gadget/function/rndis.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/usb/gadget/function/rndis.c?id=56b38e3ca4064041d93c1ca18828c8cedad2e16c)@@ -640,6 +640,7 @@ static int rndis\_set\_response(struct rndis\_params \*params, BufLength = le32\_to\_cpu(buf->InformationBufferLength); BufOffset = le32\_to\_cpu(buf->InformationBufferOffset); if ((BufLength > RNDIS\_MAX\_TOTAL\_SIZE) ||+ (BufOffset > RNDIS\_MAX\_TOTAL\_SIZE) || (BufOffset + 8 >= RNDIS\_MAX\_TOTAL\_SIZE)) return -EINVAL; |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 09:13:56 +0000



=== Content from git.kernel.org_060038cc_20250111_091517.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=28bc0267399f42f987916a7174e2e32f0833cc65)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=28bc0267399f42f987916a7174e2e32f0833cc65)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=28bc0267399f42f987916a7174e2e32f0833cc65)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=28bc0267399f42f987916a7174e2e32f0833cc65)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Dan Carpenter <dan.carpenter@oracle.com> | 2022-03-01 11:04:24 +0300 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2022-03-23 09:13:29 +0100 |
| commit | [28bc0267399f42f987916a7174e2e32f0833cc65](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=28bc0267399f42f987916a7174e2e32f0833cc65) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=28bc0267399f42f987916a7174e2e32f0833cc65)) | |
| tree | [4d007a9d89c87b53e926ac8d342a68c7a71a5ea0](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=28bc0267399f42f987916a7174e2e32f0833cc65) | |
| parent | [2c010c61e614f3ae5d26bf0803797075cc649f0b](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=2c010c61e614f3ae5d26bf0803797075cc649f0b) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=28bc0267399f42f987916a7174e2e32f0833cc65&id2=2c010c61e614f3ae5d26bf0803797075cc649f0b)) | |
| download | [linux-28bc0267399f42f987916a7174e2e32f0833cc65.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-28bc0267399f42f987916a7174e2e32f0833cc65.tar.gz) | |

usb: gadget: rndis: prevent integer overflow in rndis\_set\_response()commit 65f3324f4b6fed78b8761c3b74615ecf0ffa81fa upstream.
If "BufOffset" is very large the "BufOffset + 8" operation can have an
integer overflow.
Cc: stable@kernel.org
Fixes: 38ea1eac7d88 ("usb: gadget: rndis: check size of RNDIS\_MSG\_SET command")
Signed-off-by: Dan Carpenter <dan.carpenter@oracle.com>
Link: [https://lore.kernel.org/r/20220301080424.GA17208@kili](https://lore.kernel.org/r/20220301080424.GA17208%40kili)
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=28bc0267399f42f987916a7174e2e32f0833cc65)

| -rw-r--r-- | [drivers/usb/gadget/function/rndis.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/usb/gadget/function/rndis.c?id=28bc0267399f42f987916a7174e2e32f0833cc65) | 1 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 1 insertions, 0 deletions

| diff --git a/drivers/usb/gadget/function/rndis.c b/drivers/usb/gadget/function/rndis.cindex 0f14c5291af074..4150de96b937a7 100644--- a/[drivers/usb/gadget/function/rndis.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/usb/gadget/function/rndis.c?id=2c010c61e614f3ae5d26bf0803797075cc649f0b)+++ b/[drivers/usb/gadget/function/rndis.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/usb/gadget/function/rndis.c?id=28bc0267399f42f987916a7174e2e32f0833cc65)@@ -640,6 +640,7 @@ static int rndis\_set\_response(struct rndis\_params \*params, BufLength = le32\_to\_cpu(buf->InformationBufferLength); BufOffset = le32\_to\_cpu(buf->InformationBufferOffset); if ((BufLength > RNDIS\_MAX\_TOTAL\_SIZE) ||+ (BufOffset > RNDIS\_MAX\_TOTAL\_SIZE) || (BufOffset + 8 >= RNDIS\_MAX\_TOTAL\_SIZE)) return -EINVAL; |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 09:13:55 +0000



=== Content from git.kernel.org_d779ea81_20250111_091516.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=21829376268397f9fd2c35cfa9135937b6aa3a1e)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=21829376268397f9fd2c35cfa9135937b6aa3a1e)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=21829376268397f9fd2c35cfa9135937b6aa3a1e)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=21829376268397f9fd2c35cfa9135937b6aa3a1e)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Dan Carpenter <dan.carpenter@oracle.com> | 2022-03-01 11:04:24 +0300 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2022-03-23 09:12:07 +0100 |
| commit | [21829376268397f9fd2c35cfa9135937b6aa3a1e](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=21829376268397f9fd2c35cfa9135937b6aa3a1e) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=21829376268397f9fd2c35cfa9135937b6aa3a1e)) | |
| tree | [f1ce9b1d19155fafd83d31d4781c1b14b9fdc462](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=21829376268397f9fd2c35cfa9135937b6aa3a1e) | |
| parent | [58ee8e2cb30a9dbf9138a5b10a6988a4c0719c5c](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=58ee8e2cb30a9dbf9138a5b10a6988a4c0719c5c) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=21829376268397f9fd2c35cfa9135937b6aa3a1e&id2=58ee8e2cb30a9dbf9138a5b10a6988a4c0719c5c)) | |
| download | [linux-21829376268397f9fd2c35cfa9135937b6aa3a1e.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-21829376268397f9fd2c35cfa9135937b6aa3a1e.tar.gz) | |

usb: gadget: rndis: prevent integer overflow in rndis\_set\_response()commit 65f3324f4b6fed78b8761c3b74615ecf0ffa81fa upstream.
If "BufOffset" is very large the "BufOffset + 8" operation can have an
integer overflow.
Cc: stable@kernel.org
Fixes: 38ea1eac7d88 ("usb: gadget: rndis: check size of RNDIS\_MSG\_SET command")
Signed-off-by: Dan Carpenter <dan.carpenter@oracle.com>
Link: [https://lore.kernel.org/r/20220301080424.GA17208@kili](https://lore.kernel.org/r/20220301080424.GA17208%40kili)
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=21829376268397f9fd2c35cfa9135937b6aa3a1e)

| -rw-r--r-- | [drivers/usb/gadget/function/rndis.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/usb/gadget/function/rndis.c?id=21829376268397f9fd2c35cfa9135937b6aa3a1e) | 1 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 1 insertions, 0 deletions

| diff --git a/drivers/usb/gadget/function/rndis.c b/drivers/usb/gadget/function/rndis.cindex 970ed1514f0bc1..fa0c173a0d26f9 100644--- a/[drivers/usb/gadget/function/rndis.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/usb/gadget/function/rndis.c?id=58ee8e2cb30a9dbf9138a5b10a6988a4c0719c5c)+++ b/[drivers/usb/gadget/function/rndis.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/usb/gadget/function/rndis.c?id=21829376268397f9fd2c35cfa9135937b6aa3a1e)@@ -640,6 +640,7 @@ static int rndis\_set\_response(struct rndis\_params \*params, BufLength = le32\_to\_cpu(buf->InformationBufferLength); BufOffset = le32\_to\_cpu(buf->InformationBufferOffset); if ((BufLength > RNDIS\_MAX\_TOTAL\_SIZE) ||+ (BufOffset > RNDIS\_MAX\_TOTAL\_SIZE) || (BufOffset + 8 >= RNDIS\_MAX\_TOTAL\_SIZE)) return -EINVAL; |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 09:13:53 +0000



=== Content from git.kernel.org_f0484670_20250111_091521.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=8b3e4d26bc9cd0f6373d0095b9ffd99e7da8006b)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=8b3e4d26bc9cd0f6373d0095b9ffd99e7da8006b)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=8b3e4d26bc9cd0f6373d0095b9ffd99e7da8006b)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=8b3e4d26bc9cd0f6373d0095b9ffd99e7da8006b)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Dan Carpenter <dan.carpenter@oracle.com> | 2022-03-01 11:04:24 +0300 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2022-03-23 09:00:34 +0100 |
| commit | [8b3e4d26bc9cd0f6373d0095b9ffd99e7da8006b](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=8b3e4d26bc9cd0f6373d0095b9ffd99e7da8006b) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=8b3e4d26bc9cd0f6373d0095b9ffd99e7da8006b)) | |
| tree | [f87c297df2fae658e1dc91f7b319eff368a53ae2](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=8b3e4d26bc9cd0f6373d0095b9ffd99e7da8006b) | |
| parent | [c66fcd42e88b648e77627bd94f602925df7b5aec](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=c66fcd42e88b648e77627bd94f602925df7b5aec) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=8b3e4d26bc9cd0f6373d0095b9ffd99e7da8006b&id2=c66fcd42e88b648e77627bd94f602925df7b5aec)) | |
| download | [linux-8b3e4d26bc9cd0f6373d0095b9ffd99e7da8006b.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-8b3e4d26bc9cd0f6373d0095b9ffd99e7da8006b.tar.gz) | |

usb: gadget: rndis: prevent integer overflow in rndis\_set\_response()commit 65f3324f4b6fed78b8761c3b74615ecf0ffa81fa upstream.
If "BufOffset" is very large the "BufOffset + 8" operation can have an
integer overflow.
Cc: stable@kernel.org
Fixes: 38ea1eac7d88 ("usb: gadget: rndis: check size of RNDIS\_MSG\_SET command")
Signed-off-by: Dan Carpenter <dan.carpenter@oracle.com>
Link: [https://lore.kernel.org/r/20220301080424.GA17208@kili](https://lore.kernel.org/r/20220301080424.GA17208%40kili)
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=8b3e4d26bc9cd0f6373d0095b9ffd99e7da8006b)

| -rw-r--r-- | [drivers/usb/gadget/function/rndis.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/usb/gadget/function/rndis.c?id=8b3e4d26bc9cd0f6373d0095b9ffd99e7da8006b) | 1 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 1 insertions, 0 deletions

| diff --git a/drivers/usb/gadget/function/rndis.c b/drivers/usb/gadget/function/rndis.cindex 1e5c2cbe99947c..30eeaf9bc8ecaa 100644--- a/[drivers/usb/gadget/function/rndis.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/usb/gadget/function/rndis.c?id=c66fcd42e88b648e77627bd94f602925df7b5aec)+++ b/[drivers/usb/gadget/function/rndis.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/usb/gadget/function/rndis.c?id=8b3e4d26bc9cd0f6373d0095b9ffd99e7da8006b)@@ -645,6 +645,7 @@ static int rndis\_set\_response(struct rndis\_params \*params, BufLength = le32\_to\_cpu(buf->InformationBufferLength); BufOffset = le32\_to\_cpu(buf->InformationBufferOffset); if ((BufLength > RNDIS\_MAX\_TOTAL\_SIZE) ||+ (BufOffset > RNDIS\_MAX\_TOTAL\_SIZE) || (BufOffset + 8 >= RNDIS\_MAX\_TOTAL\_SIZE)) return -EINVAL; |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 09:13:58 +0000



=== Content from git.kernel.org_93b8c153_20250111_091519.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=65f3324f4b6fed78b8761c3b74615ecf0ffa81fa)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=65f3324f4b6fed78b8761c3b74615ecf0ffa81fa)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=65f3324f4b6fed78b8761c3b74615ecf0ffa81fa)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=65f3324f4b6fed78b8761c3b74615ecf0ffa81fa)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Dan Carpenter <dan.carpenter@oracle.com> | 2022-03-01 11:04:24 +0300 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2022-03-15 15:48:57 +0100 |
| commit | [65f3324f4b6fed78b8761c3b74615ecf0ffa81fa](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=65f3324f4b6fed78b8761c3b74615ecf0ffa81fa) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=65f3324f4b6fed78b8761c3b74615ecf0ffa81fa)) | |
| tree | [b690a681262c2385e1f68e86085137d41821b824](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=65f3324f4b6fed78b8761c3b74615ecf0ffa81fa) | |
| parent | [7e57714cd0ad2d5bb90e50b5096a0e671dec1ef3](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=7e57714cd0ad2d5bb90e50b5096a0e671dec1ef3) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=65f3324f4b6fed78b8761c3b74615ecf0ffa81fa&id2=7e57714cd0ad2d5bb90e50b5096a0e671dec1ef3)) | |
| download | [linux-65f3324f4b6fed78b8761c3b74615ecf0ffa81fa.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-65f3324f4b6fed78b8761c3b74615ecf0ffa81fa.tar.gz) | |

usb: gadget: rndis: prevent integer overflow in rndis\_set\_response()If "BufOffset" is very large the "BufOffset + 8" operation can have an
integer overflow.
Cc: stable@kernel.org
Fixes: 38ea1eac7d88 ("usb: gadget: rndis: check size of RNDIS\_MSG\_SET command")
Signed-off-by: Dan Carpenter <dan.carpenter@oracle.com>
Link: [https://lore.kernel.org/r/20220301080424.GA17208@kili](https://lore.kernel.org/r/20220301080424.GA17208%40kili)
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=65f3324f4b6fed78b8761c3b74615ecf0ffa81fa)

| -rw-r--r-- | [drivers/usb/gadget/function/rndis.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/usb/gadget/function/rndis.c?id=65f3324f4b6fed78b8761c3b74615ecf0ffa81fa) | 1 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 1 insertions, 0 deletions

| diff --git a/drivers/usb/gadget/function/rndis.c b/drivers/usb/gadget/function/rndis.cindex 00b3f6b3bb31df..713efd9aefde8d 100644--- a/[drivers/usb/gadget/function/rndis.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/usb/gadget/function/rndis.c?id=7e57714cd0ad2d5bb90e50b5096a0e671dec1ef3)+++ b/[drivers/usb/gadget/function/rndis.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/usb/gadget/function/rndis.c?id=65f3324f4b6fed78b8761c3b74615ecf0ffa81fa)@@ -640,6 +640,7 @@ static int rndis\_set\_response(struct rndis\_params \*params, BufLength = le32\_to\_cpu(buf->InformationBufferLength); BufOffset = le32\_to\_cpu(buf->InformationBufferOffset); if ((BufLength > RNDIS\_MAX\_TOTAL\_SIZE) ||+ (BufOffset > RNDIS\_MAX\_TOTAL\_SIZE) || (BufOffset + 8 >= RNDIS\_MAX\_TOTAL\_SIZE)) return -EINVAL; |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 09:13:57 +0000



=== Content from git.kernel.org_32da3288_20250111_091522.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=c7953cf03a26876d676145ce5d2ae6d8c9630b90)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=c7953cf03a26876d676145ce5d2ae6d8c9630b90)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=c7953cf03a26876d676145ce5d2ae6d8c9630b90)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=c7953cf03a26876d676145ce5d2ae6d8c9630b90)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Dan Carpenter <dan.carpenter@oracle.com> | 2022-03-01 11:04:24 +0300 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2022-03-23 09:01:35 +0100 |
| commit | [c7953cf03a26876d676145ce5d2ae6d8c9630b90](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=c7953cf03a26876d676145ce5d2ae6d8c9630b90) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=c7953cf03a26876d676145ce5d2ae6d8c9630b90)) | |
| tree | [89ad696792588848a4408f22504abb0116a684c9](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=c7953cf03a26876d676145ce5d2ae6d8c9630b90) | |
| parent | [a5b9b649a96631f736adb9f532eb838c79975dde](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=a5b9b649a96631f736adb9f532eb838c79975dde) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=c7953cf03a26876d676145ce5d2ae6d8c9630b90&id2=a5b9b649a96631f736adb9f532eb838c79975dde)) | |
| download | [linux-c7953cf03a26876d676145ce5d2ae6d8c9630b90.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-c7953cf03a26876d676145ce5d2ae6d8c9630b90.tar.gz) | |

usb: gadget: rndis: prevent integer overflow in rndis\_set\_response()commit 65f3324f4b6fed78b8761c3b74615ecf0ffa81fa upstream.
If "BufOffset" is very large the "BufOffset + 8" operation can have an
integer overflow.
Cc: stable@kernel.org
Fixes: 38ea1eac7d88 ("usb: gadget: rndis: check size of RNDIS\_MSG\_SET command")
Signed-off-by: Dan Carpenter <dan.carpenter@oracle.com>
Link: [https://lore.kernel.org/r/20220301080424.GA17208@kili](https://lore.kernel.org/r/20220301080424.GA17208%40kili)
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=c7953cf03a26876d676145ce5d2ae6d8c9630b90)

| -rw-r--r-- | [drivers/usb/gadget/function/rndis.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/usb/gadget/function/rndis.c?id=c7953cf03a26876d676145ce5d2ae6d8c9630b90) | 1 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 1 insertions, 0 deletions

| diff --git a/drivers/usb/gadget/function/rndis.c b/drivers/usb/gadget/function/rndis.cindex 55be224b64a486..b6c707246dadd7 100644--- a/[drivers/usb/gadget/function/rndis.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/usb/gadget/function/rndis.c?id=a5b9b649a96631f736adb9f532eb838c79975dde)+++ b/[drivers/usb/gadget/function/rndis.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/usb/gadget/function/rndis.c?id=c7953cf03a26876d676145ce5d2ae6d8c9630b90)@@ -643,6 +643,7 @@ static int rndis\_set\_response(struct rndis\_params \*params, BufLength = le32\_to\_cpu(buf->InformationBufferLength); BufOffset = le32\_to\_cpu(buf->InformationBufferOffset); if ((BufLength > RNDIS\_MAX\_TOTAL\_SIZE) ||+ (BufOffset > RNDIS\_MAX\_TOTAL\_SIZE) || (BufOffset + 8 >= RNDIS\_MAX\_TOTAL\_SIZE)) return -EINVAL; |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 09:13:59 +0000



=== Content from git.kernel.org_cfc5cd82_20250111_091523.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=df7e088d51cdf78b1a0bf1f3d405c2593295c7b0)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=df7e088d51cdf78b1a0bf1f3d405c2593295c7b0)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=df7e088d51cdf78b1a0bf1f3d405c2593295c7b0)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=df7e088d51cdf78b1a0bf1f3d405c2593295c7b0)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Dan Carpenter <dan.carpenter@oracle.com> | 2022-03-01 11:04:24 +0300 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2022-03-23 09:18:49 +0100 |
| commit | [df7e088d51cdf78b1a0bf1f3d405c2593295c7b0](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=df7e088d51cdf78b1a0bf1f3d405c2593295c7b0) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=df7e088d51cdf78b1a0bf1f3d405c2593295c7b0)) | |
| tree | [a1365f6b6d2ebc6eac53901eb920905146f513d1](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=df7e088d51cdf78b1a0bf1f3d405c2593295c7b0) | |
| parent | [c4874bdd6e6eed6cfecf26a9a40951c1393e3d3e](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=c4874bdd6e6eed6cfecf26a9a40951c1393e3d3e) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=df7e088d51cdf78b1a0bf1f3d405c2593295c7b0&id2=c4874bdd6e6eed6cfecf26a9a40951c1393e3d3e)) | |
| download | [linux-df7e088d51cdf78b1a0bf1f3d405c2593295c7b0.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-df7e088d51cdf78b1a0bf1f3d405c2593295c7b0.tar.gz) | |

usb: gadget: rndis: prevent integer overflow in rndis\_set\_response()commit 65f3324f4b6fed78b8761c3b74615ecf0ffa81fa upstream.
If "BufOffset" is very large the "BufOffset + 8" operation can have an
integer overflow.
Cc: stable@kernel.org
Fixes: 38ea1eac7d88 ("usb: gadget: rndis: check size of RNDIS\_MSG\_SET command")
Signed-off-by: Dan Carpenter <dan.carpenter@oracle.com>
Link: [https://lore.kernel.org/r/20220301080424.GA17208@kili](https://lore.kernel.org/r/20220301080424.GA17208%40kili)
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=df7e088d51cdf78b1a0bf1f3d405c2593295c7b0)

| -rw-r--r-- | [drivers/usb/gadget/function/rndis.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/usb/gadget/function/rndis.c?id=df7e088d51cdf78b1a0bf1f3d405c2593295c7b0) | 1 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 1 insertions, 0 deletions

| diff --git a/drivers/usb/gadget/function/rndis.c b/drivers/usb/gadget/function/rndis.cindex 0f14c5291af074..4150de96b937a7 100644--- a/[drivers/usb/gadget/function/rndis.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/usb/gadget/function/rndis.c?id=c4874bdd6e6eed6cfecf26a9a40951c1393e3d3e)+++ b/[drivers/usb/gadget/function/rndis.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/usb/gadget/function/rndis.c?id=df7e088d51cdf78b1a0bf1f3d405c2593295c7b0)@@ -640,6 +640,7 @@ static int rndis\_set\_response(struct rndis\_params \*params, BufLength = le32\_to\_cpu(buf->InformationBufferLength); BufOffset = le32\_to\_cpu(buf->InformationBufferOffset); if ((BufLength > RNDIS\_MAX\_TOTAL\_SIZE) ||+ (BufOffset > RNDIS\_MAX\_TOTAL\_SIZE) || (BufOffset + 8 >= RNDIS\_MAX\_TOTAL\_SIZE)) return -EINVAL; |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 09:14:00 +0000



=== Content from git.kernel.org_eb3cd2d0_20250111_091515.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=138d4f739b35dfb40438a0d5d7054965763bfbe7)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=138d4f739b35dfb40438a0d5d7054965763bfbe7)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=138d4f739b35dfb40438a0d5d7054965763bfbe7)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=138d4f739b35dfb40438a0d5d7054965763bfbe7)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Dan Carpenter <dan.carpenter@oracle.com> | 2022-03-01 11:04:24 +0300 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2022-03-23 09:10:44 +0100 |
| commit | [138d4f739b35dfb40438a0d5d7054965763bfbe7](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=138d4f739b35dfb40438a0d5d7054965763bfbe7) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=138d4f739b35dfb40438a0d5d7054965763bfbe7)) | |
| tree | [fb98d16beee20e232a66d078ebbbad023c72af2a](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=138d4f739b35dfb40438a0d5d7054965763bfbe7) | |
| parent | [98f72cd198fac47f108fb37fe94275787368c34e](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=98f72cd198fac47f108fb37fe94275787368c34e) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=138d4f739b35dfb40438a0d5d7054965763bfbe7&id2=98f72cd198fac47f108fb37fe94275787368c34e)) | |
| download | [linux-138d4f739b35dfb40438a0d5d7054965763bfbe7.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-138d4f739b35dfb40438a0d5d7054965763bfbe7.tar.gz) | |

usb: gadget: rndis: prevent integer overflow in rndis\_set\_response()commit 65f3324f4b6fed78b8761c3b74615ecf0ffa81fa upstream.
If "BufOffset" is very large the "BufOffset + 8" operation can have an
integer overflow.
Cc: stable@kernel.org
Fixes: 38ea1eac7d88 ("usb: gadget: rndis: check size of RNDIS\_MSG\_SET command")
Signed-off-by: Dan Carpenter <dan.carpenter@oracle.com>
Link: [https://lore.kernel.org/r/20220301080424.GA17208@kili](https://lore.kernel.org/r/20220301080424.GA17208%40kili)
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=138d4f739b35dfb40438a0d5d7054965763bfbe7)

| -rw-r--r-- | [drivers/usb/gadget/function/rndis.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/usb/gadget/function/rndis.c?id=138d4f739b35dfb40438a0d5d7054965763bfbe7) | 1 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 1 insertions, 0 deletions

| diff --git a/drivers/usb/gadget/function/rndis.c b/drivers/usb/gadget/function/rndis.cindex 970ed1514f0bc1..fa0c173a0d26f9 100644--- a/[drivers/usb/gadget/function/rndis.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/usb/gadget/function/rndis.c?id=98f72cd198fac47f108fb37fe94275787368c34e)+++ b/[drivers/usb/gadget/function/rndis.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/usb/gadget/function/rndis.c?id=138d4f739b35dfb40438a0d5d7054965763bfbe7)@@ -640,6 +640,7 @@ static int rndis\_set\_response(struct rndis\_params \*params, BufLength = le32\_to\_cpu(buf->InformationBufferLength); BufOffset = le32\_to\_cpu(buf->InformationBufferOffset); if ((BufLength > RNDIS\_MAX\_TOTAL\_SIZE) ||+ (BufOffset > RNDIS\_MAX\_TOTAL\_SIZE) || (BufOffset + 8 >= RNDIS\_MAX\_TOTAL\_SIZE)) return -EINVAL; |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 09:13:52 +0000


