

[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fchangeset%2F3168433)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Changeset](/changeset/3168432 "Changeset 3168432")
* [Next Changeset](/changeset/3168434 "Changeset 3168434") →

---

# Changeset 3168433

View differences
inline
side by side

Show
lines around each change

Show the changes in full context

Ignore:

Blank lines

Case changes

White space changes

Timestamp:
10/14/2024 09:48:12 AM
([3 months](/timeline?from=2024-10-14T09%3A48%3A12Z&precision=second "See timeline at 10/14/2024 09:48:12 AM") ago)

Author:
elbanyaoui
Message:

version 1.5.8

Location:
[clover-online-orders/trunk](/browser/clover-online-orders/trunk?rev=3168433)
Files:

1 added
25 edited

* [admin/css/moo-OnlineOrders-admin.css](/browser/clover-online-orders/trunk/admin/css/moo-OnlineOrders-admin.css?rev=3168433 "Show entry in browser")
  (modified)
  ([3 diffs](#file0 "Show differences"))
* [admin/includes/class-moo-coupons-list.php](/browser/clover-online-orders/trunk/admin/includes/class-moo-coupons-list.php?rev=3168433 "Show entry in browser")
  (modified)
  ([12 diffs](#file1 "Show differences"))
* [admin/includes/class-moo-orders-list.php](/browser/clover-online-orders/trunk/admin/includes/class-moo-orders-list.php?rev=3168433 "Show entry in browser")
  (modified)
  ([3 diffs](#file2 "Show differences"))
* [admin/includes/class-moo-products-list.php](/browser/clover-online-orders/trunk/admin/includes/class-moo-products-list.php?rev=3168433 "Show entry in browser")
  (modified)
  ([21 diffs](#file3 "Show differences"))
* [admin/includes/class-wp-list-table-moo.php](/browser/clover-online-orders/trunk/admin/includes/class-wp-list-table-moo.php?rev=3168433 "Show entry in browser")
  (modified)
  ([19 diffs](#file4 "Show differences"))
* [admin/js/moo-OnlineOrders-admin.js](/browser/clover-online-orders/trunk/admin/js/moo-OnlineOrders-admin.js?rev=3168433 "Show entry in browser")
  (modified)
  ([9 diffs](#file5 "Show differences"))
* [admin/moo-OnlineOrders-admin.php](/browser/clover-online-orders/trunk/admin/moo-OnlineOrders-admin.php?rev=3168433 "Show entry in browser")
  (modified)
  ([11 diffs](#file6 "Show differences"))
* [includes/moo-OnlineOrders-Restapi.php](/browser/clover-online-orders/trunk/includes/moo-OnlineOrders-Restapi.php?rev=3168433 "Show entry in browser")
  (modified)
  ([5 diffs](#file7 "Show differences"))
* [includes/moo-OnlineOrders-activator.php](/browser/clover-online-orders/trunk/includes/moo-OnlineOrders-activator.php?rev=3168433 "Show entry in browser")
  (modified)
  ([4 diffs](#file8 "Show differences"))
* [includes/moo-OnlineOrders-helpers.php](/browser/clover-online-orders/trunk/includes/moo-OnlineOrders-helpers.php?rev=3168433 "Show entry in browser")
  (modified)
  ([2 diffs](#file9 "Show differences"))
* [includes/moo-OnlineOrders-sooapi.php](/browser/clover-online-orders/trunk/includes/moo-OnlineOrders-sooapi.php?rev=3168433 "Show entry in browser")
  (modified)
  ([4 diffs](#file10 "Show differences"))
* [includes/moo-OnlineOrders-widgets.php](/browser/clover-online-orders/trunk/includes/moo-OnlineOrders-widgets.php?rev=3168433 "Show entry in browser")
  (modified)
  ([5 diffs](#file11 "Show differences"))
* [includes/restapi/CheckoutRoutes.php](/browser/clover-online-orders/trunk/includes/restapi/CheckoutRoutes.php?rev=3168433 "Show entry in browser")
  (modified)
  ([2 diffs](#file12 "Show differences"))
* [includes/restapi/DashboardRoutes.php](/browser/clover-online-orders/trunk/includes/restapi/DashboardRoutes.php?rev=3168433 "Show entry in browser")
  (modified)
  ([16 diffs](#file13 "Show differences"))
* [includes/shortcodes/addToCartButton.php](/browser/clover-online-orders/trunk/includes/shortcodes/addToCartButton.php?rev=3168433 "Show entry in browser")
  (modified)
  ([1 diff](#file14 "Show differences"))
* [includes/shortcodes/checkoutPage.php](/browser/clover-online-orders/trunk/includes/shortcodes/checkoutPage.php?rev=3168433 "Show entry in browser")
  (modified)
  ([15 diffs](#file15 "Show differences"))
* [includes/shortcodes/storePage.php](/browser/clover-online-orders/trunk/includes/shortcodes/storePage.php?rev=3168433 "Show entry in browser")
  (modified)
  ([2 diffs](#file16 "Show differences"))
* [models/moo-OnlineOrders-Model.php](/browser/clover-online-orders/trunk/models/moo-OnlineOrders-Model.php?rev=3168433 "Show entry in browser")
  (modified)
  ([4 diffs](#file17 "Show differences"))
* [moo\_OnlineOrders.php](/browser/clover-online-orders/trunk/moo_OnlineOrders.php?rev=3168433 "Show entry in browser")
  (modified)
  ([5 diffs](#file18 "Show differences"))
* [public/css/dist/blueX2.png](/browser/clover-online-orders/trunk/public/css/dist/blueX2.png?rev=3168433 "Show entry in browser")
  (added)
* [public/css/dist/icheck-blue.min.css](/browser/clover-online-orders/trunk/public/css/dist/icheck-blue.min.css?rev=3168433 "Show entry in browser")
  (modified)
  ([1 diff](#file20 "Show differences"))
* [public/css/dist/sooCheckout-light.min.css](/browser/clover-online-orders/trunk/public/css/dist/sooCheckout-light.min.css?rev=3168433 "Show entry in browser")
  (modified)
  ([1 diff](#file21 "Show differences"))
* [public/js/dist/sooCheckout.min.js](/browser/clover-online-orders/trunk/public/js/dist/sooCheckout.min.js?rev=3168433 "Show entry in browser")
  (modified)
  ([1 diff](#file22 "Show differences"))
* [public/js/dist/sooSearchbar.min.js](/browser/clover-online-orders/trunk/public/js/dist/sooSearchbar.min.js?rev=3168433 "Show entry in browser")
  (modified)
  ([1 diff](#file23 "Show differences"))
* [readme.txt](/browser/clover-online-orders/trunk/readme.txt?rev=3168433 "Show entry in browser")
  (modified)
  ([3 diffs](#file24 "Show differences"))
* [uninstall.php](/browser/clover-online-orders/trunk/uninstall.php?rev=3168433 "Show entry in browser")
  (modified)
  ([6 diffs](#file25 "Show differences"))

### Legend:

Unmodified
Added
Removed

* ## [clover-online-orders/trunk/admin/css/moo-OnlineOrders-admin.css](/changeset/3168433/clover-online-orders/trunk/admin/css/moo-OnlineOrders-admin.css "Show the changeset 3168433 restricted to clover-online-orders/trunk/admin/css/moo-OnlineOrders-admin.css")

  | [r3142846](/browser/clover-online-orders/trunk/admin/css/moo-OnlineOrders-admin.css?rev=3142846#L401 "Show revision 3142846 of this file in browser") | [r3168433](/browser/clover-online-orders/trunk/admin/css/moo-OnlineOrders-admin.css?rev=3168433#L401 "Show revision 3168433 of this file in browser") |  |
  | --- | --- | --- |
  | 401 | 401 | } |
  | 402 | 402 |  |
  | 403 |  | #price,#price\_type,#unit\_name,#sku,#available |
  |  | 403 | #price,#price\_type,#unit\_name,#sku,#available,#visible |
  | 404 | 404 | { |
  | 405 | 405 | width: 102px; |
  | […](/browser/clover-online-orders/trunk/admin/css/moo-OnlineOrders-admin.css?rev=3142846#L407) | […](/browser/clover-online-orders/trunk/admin/css/moo-OnlineOrders-admin.css?rev=3168433#L407) |  |
  | 407 | 407 | #name |
  | 408 | 408 | { |
  | 409 |  | width: ~~20~~0px; |
  |  | 409 | width: 150px; |
  | 410 | 410 | } |
  | 411 | 411 | #outofstock,#custom\_hours |
  | […](/browser/clover-online-orders/trunk/admin/css/moo-OnlineOrders-admin.css?rev=3142846#L1191) | […](/browser/clover-online-orders/trunk/admin/css/moo-OnlineOrders-admin.css?rev=3168433#L1191) |  |
  | 1191 | 1191 | .moo\_hidden { |
  | 1192 | 1192 | display: none !important; |
  |  | 1193 | } |
  |  | 1194 | .soo-display-none { |
  |  | 1195 | display: none; |
  |  | 1196 | } |
  |  | 1197 | .soo-display-block{ |
  |  | 1198 | display: block; |
  | 1193 | 1199 | } |
  | 1194 | 1200 | /\* --- table category --- \*/ |
* ## [clover-online-orders/trunk/admin/includes/class-moo-coupons-list.php](/changeset/3168433/clover-online-orders/trunk/admin/includes/class-moo-coupons-list.php "Show the changeset 3168433 restricted to clover-online-orders/trunk/admin/includes/class-moo-coupons-list.php")

  | [r3142846](/browser/clover-online-orders/trunk/admin/includes/class-moo-coupons-list.php?rev=3142846#L2 "Show revision 3142846 of this file in browser") | [r3168433](/browser/clover-online-orders/trunk/admin/includes/class-moo-coupons-list.php?rev=3168433#L2 "Show revision 3168433 of this file in browser") |  |
  | --- | --- | --- |
  | 2 | 2 | require\_once 'class-wp-list-table-moo.php'; |
  | 3 | 3 | class Coupons\_List\_Moo extends WP\_List\_Table\_MOO { |
  |  | 4 | /\*\* |
  |  | 5 | \* @var mixed |
  |  | 6 | \*/ |
  |  | 7 | private $couponPageUrl; |
  |  | 8 |  |
  | 4 | 9 | /\*\* Class constructor \*/ |
  | 5 | 10 | public function \_\_construct() { |
  | 6 |  | parent::\_\_construct( array( |
  | 7 |  | 'singular' => \_\_( 'Order'), //singular name of the listed records |
  | 8 |  | 'plural'   => \_\_( 'Orders'), //plural name of the listed records |
  |  | 11 | $this->couponPageUrl = admin\_url('admin.php?page=moo\_coupons'); |
  |  | 12 | parent::\_\_construct( array( |
  |  | 13 | 'singular' => \_\_( 'Coupon',"moo\_OnlineOrders"), //singular name of the listed records |
  |  | 14 | 'plural'   => \_\_( 'Coupons',"moo\_OnlineOrders"), //plural name of the listed records |
  | 9 | 15 | 'ajax'     => false //should this table support ajax? |
  | 10 | 16 |  |
  | 11 | 17 | ) ); |
  | 12 |  | ~~//var\_dump('creating an Object');~~ |
  | 13 | 18 | /\*\* Process bulk action \*/ |
  | 14 | 19 | $this->process\_bulk\_action(); |
  | […](/browser/clover-online-orders/trunk/admin/includes/class-moo-coupons-list.php?rev=3142846#L23) | […](/browser/clover-online-orders/trunk/admin/includes/class-moo-coupons-list.php?rev=3168433#L28) |  |
  | 23 | 28 | \* @return mixed |
  | 24 | 29 | \*/ |
  | 25 |  | public ~~static~~ function get\_items( $per\_page = 20, $page\_number = 1 ) { |
  |  | 30 | public function get\_items( $per\_page = 20, $page\_number = 1 ) { |
  | 26 | 31 | global $wpdb; |
  | 27 | 32 | require\_once plugin\_dir\_path( dirname(\_\_FILE\_\_) )."../includes/moo-OnlineOrders-sooapi.php"; |
  | […](/browser/clover-online-orders/trunk/admin/includes/class-moo-coupons-list.php?rev=3142846#L37) | […](/browser/clover-online-orders/trunk/admin/includes/class-moo-coupons-list.php?rev=3168433#L42) |  |
  | 37 | 42 | /\*\* Text displayed when no customer data is available \*/ |
  | 38 | 43 | public function no\_items() { |
  | 39 |  | \_e( 'No Coupon available.'); |
  |  | 44 | \_e( 'No Coupon available.',"moo\_OnlineOrders"); |
  | 40 | 45 | } |
  | 41 | 46 |  |
  | […](/browser/clover-online-orders/trunk/admin/includes/class-moo-coupons-list.php?rev=3142846#L61) | […](/browser/clover-online-orders/trunk/admin/includes/class-moo-coupons-list.php?rev=3168433#L66) |  |
  | 61 | 66 | \* @return null|string |
  | 62 | 67 | \*/ |
  | 63 |  | public ~~static~~ function record\_count() { |
  |  | 68 | public function record\_count() { |
  | 64 | 69 | require\_once plugin\_dir\_path( dirname(\_\_FILE\_\_) )."../includes/moo-OnlineOrders-sooapi.php"; |
  | 65 | 70 | $api = new Moo\_OnlineOrders\_SooApi(); |
  | […](/browser/clover-online-orders/trunk/admin/includes/class-moo-coupons-list.php?rev=3142846#L129) | […](/browser/clover-online-orders/trunk/admin/includes/class-moo-coupons-list.php?rev=3168433#L134) |  |
  | 129 | 134 | $columns = array( |
  | 130 | 135 | 'cb'      => '<input type="checkbox" />', |
  | 131 |  | 'name'    => \_\_( 'Coupon Name'), |
  | 132 |  | 'code' => \_\_( 'Code'), |
  | 133 |  | 'value'    => \_\_( 'Value'), |
  | 134 |  | 'type'    => \_\_( 'Type'), |
  | 135 |  | 'minAmount'    => \_\_( 'Min Amount'), |
  | 136 |  | 'uses' => \_\_( 'Number of uses'), |
  | 137 |  | 'isEnabled' => \_\_( 'Is enabled ?'), |
  | 138 |  | 'expirationdate'    => \_\_( 'Expiry date') |
  |  | 136 | 'name'    => \_\_( 'Coupon Name',"moo\_OnlineOrders"), |
  |  | 137 | 'code' => \_\_( 'Code',"moo\_OnlineOrders"), |
  |  | 138 | 'value'    => \_\_( 'Value',"moo\_OnlineOrders"), |
  |  | 139 | 'type'    => \_\_( 'Type',"moo\_OnlineOrders"), |
  |  | 140 | 'minAmount'    => \_\_( 'Min Amount',"moo\_OnlineOrders"), |
  |  | 141 | 'uses' => \_\_( 'Number of uses',"moo\_OnlineOrders"), |
  |  | 142 | 'isEnabled' => \_\_( 'Is enabled ?',"moo\_OnlineOrders"), |
  |  | 143 | 'expirationdate'    => \_\_( 'Expiry date',"moo\_OnlineOrders") |
  | 139 | 144 | ); |
  | 140 | 145 |  |
  | […](/browser/clover-online-orders/trunk/admin/includes/class-moo-coupons-list.php?rev=3142846#L183) | […](/browser/clover-online-orders/trunk/admin/includes/class-moo-coupons-list.php?rev=3168433#L188) |  |
  | 183 | 188 | $per\_page     = $this->get\_items\_per\_page( 'moo\_items\_per\_page', 10 ); |
  | 184 | 189 | $current\_page = $this->get\_pagenum(); |
  | 185 |  | $total\_items  = ~~self::~~record\_count(); |
  |  | 190 | $total\_items  = $this->record\_count(); |
  | 186 | 191 |  |
  | 187 | 192 | $this->set\_pagination\_args( array( |
  | […](/browser/clover-online-orders/trunk/admin/includes/class-moo-coupons-list.php?rev=3142846#L191) | […](/browser/clover-online-orders/trunk/admin/includes/class-moo-coupons-list.php?rev=3168433#L196) |  |
  | 191 | 196 |  |
  | 192 | 197 |  |
  | 193 |  | $this->items = ~~self~~::get\_items( $per\_page, $current\_page ); |
  |  | 198 | $this->items = $this::get\_items( $per\_page, $current\_page ); |
  | 194 | 199 | } |
  | 195 | 200 | public function process\_bulk\_action() { |
  | […](/browser/clover-online-orders/trunk/admin/includes/class-moo-coupons-list.php?rev=3142846#L201) | […](/browser/clover-online-orders/trunk/admin/includes/class-moo-coupons-list.php?rev=3168433#L206) |  |
  | 201 | 206 | die( 'You are not permitted to perform this action' ); |
  | 202 | 207 | } else { |
  | 203 |  | $res = self::delete\_coupon(sanitize\_text\_field($\_GET['coupon'])); |
  | 204 |  | wp\_redirect( add\_query\_arg(array("deleted"=>$res),remove\_query\_arg( array('coupon', 'action')))); |
  |  | 208 | $res = $this->delete\_coupon(sanitize\_text\_field($\_GET['coupon'])); |
  |  | 209 | $redirect\_url = add\_query\_arg(array("deleted"=>$res), $this->couponPageUrl); |
  |  | 210 | wp\_safe\_redirect( $redirect\_url ); |
  | 205 | 211 | exit; |
  | 206 | 212 | } |
  | […](/browser/clover-online-orders/trunk/admin/includes/class-moo-coupons-list.php?rev=3142846#L208) | […](/browser/clover-online-orders/trunk/admin/includes/class-moo-coupons-list.php?rev=3168433#L214) |  |
  | 208 | 214 | } |
  | 209 | 215 | if ( 'enable' === $this->current\_action() ) { |
  | 210 |  | $res = self::enable\_coupon(sanitize\_text\_field($\_GET['coupon']),"1"); |
  | 211 |  | wp\_redirect( add\_query\_arg(array("enabled"=>$res),remove\_query\_arg( array('coupon', 'action')))); |
  |  | 216 | $res = $this->enable\_coupon(sanitize\_text\_field($\_GET['coupon']),"1"); |
  |  | 217 | $redirect\_url = add\_query\_arg(array("enabled"=>$res), $this->couponPageUrl); |
  |  | 218 | wp\_safe\_redirect( $redirect\_url ); |
  | 212 | 219 | exit; |
  | 213 | 220 | } |
  | 214 | 221 |  |
  | 215 | 222 | if ( 'disable' === $this->current\_action() ) { |
  | 216 |  | $res = self::enable\_coupon(sanitize\_text\_field($\_GET['coupon']),"0"); |
  | 217 |  | wp\_redirect( add\_query\_arg(array("disabled"=>$res),remove\_query\_arg( array('coupon', 'action')))); |
  |  | 223 | $res = $this->enable\_coupon(sanitize\_text\_field($\_GET['coupon']),"0"); |
  |  | 224 | $redirect\_url = add\_query\_arg(array("disabled"=>$res), $this->couponPageUrl); |
  |  | 225 | wp\_safe\_redirect( $redirect\_url ); |
  | 218 | 226 | exit; |
  | 219 | 227 | } |
  | […](/browser/clover-online-orders/trunk/admin/includes/class-moo-coupons-list.php?rev=3142846#L224) | […](/browser/clover-online-orders/trunk/admin/includes/class-moo-coupons-list.php?rev=3168433#L232) |  |
  | 224 | 232 | // loop over the array of record IDs and delete them |
  | 225 | 233 | foreach ( $codes as $code ) { |
  | 226 |  | $res = self::delete\_coupon( $code ); |
  | 227 |  | } |
  | 228 |  | wp\_redirect( add\_query\_arg(array("deleted"=>$res),remove\_query\_arg( array('coupon', 'action')))); |
  |  | 234 | $res = $this->delete\_coupon( $code ); |
  |  | 235 | } |
  |  | 236 | $redirect\_url = add\_query\_arg(array("deleted"=>$res), $this->couponPageUrl); |
  |  | 237 | wp\_safe\_redirect( $redirect\_url ); |
  | 229 | 238 | exit; |
  | 230 | 239 | } |
  | […](/browser/clover-online-orders/trunk/admin/includes/class-moo-coupons-list.php?rev=3142846#L234) | […](/browser/clover-online-orders/trunk/admin/includes/class-moo-coupons-list.php?rev=3168433#L243) |  |
  | 234 | 243 | // loop over the array of record IDs and delete them |
  | 235 | 244 | foreach ( $codes as $code ) { |
  | 236 |  | $res = self::enable\_coupon( $code, "1" ); |
  | 237 |  | } |
  | 238 |  | wp\_redirect( add\_query\_arg(array("enabled"=>$res),remove\_query\_arg( array('coupon', 'action')))); |
  |  | 245 | $res = $this->enable\_coupon( $code, "1" ); |
  |  | 246 | } |
  |  | 247 | $redirect\_url = add\_query\_arg(array("enabled"=>$res), $this->couponPageUrl); |
  |  | 248 | wp\_safe\_redirect( $redirect\_url ); |
  | 239 | 249 | exit; |
  | 240 | 250 | } |
  | […](/browser/clover-online-orders/trunk/admin/includes/class-moo-coupons-list.php?rev=3142846#L245) | […](/browser/clover-online-orders/trunk/admin/includes/class-moo-coupons-list.php?rev=3168433#L255) |  |
  | 245 | 255 | // loop over the array of record IDs and delete them |
  | 246 | 256 | foreach ( $codes as $code ) { |
  | 247 |  | $res = self::enable\_coupon( $code, "0" ); |
  | 248 |  | } |
  | 249 |  | wp\_redirect( add\_query\_arg(array("disabled"=>$res),remove\_query\_arg( array('coupon', 'action')))); |
  |  | 257 | $res = $this->enable\_coupon( $code, "0" ); |
  |  | 258 | } |
  |  | 259 | $redirect\_url = add\_query\_arg(array("disabled"=>$res), $this->couponPageUrl); |
  |  | 260 | wp\_safe\_redirect( $redirect\_url ); |
  | 250 | 261 | exit; |
  | 251 | 262 | } |
* ## [clover-online-orders/trunk/admin/includes/class-moo-orders-list.php](/changeset/3168433/clover-online-orders/trunk/admin/includes/class-moo-orders-list.php "Show the changeset 3168433 restricted to clover-online-orders/trunk/admin/includes/class-moo-orders-list.php")

  | [r2986704](/browser/clover-online-orders/trunk/admin/includes/class-moo-orders-list.php?rev=2986704#L10 "Show revision 2986704 of this file in browser") | [r3168433](/browser/clover-online-orders/trunk/admin/includes/class-moo-orders-list.php?rev=3168433#L10 "Show revision 3168433 of this file in browser") |  |
  | --- | --- | --- |
  | 10 | 10 |  |
  | 11 | 11 | parent::\_\_construct( array( |
  | 12 |  | 'singular' => \_\_( 'Order'), //singular name of the listed records |
  | 13 |  | 'plural'   => \_\_( 'Orders'), //plural name of the listed records |
  |  | 12 | 'singular' => \_\_( 'Order', "moo\_OnlineOrders"), //singular name of the listed records |
  |  | 13 | 'plural'   => \_\_( 'Orders', "moo\_OnlineOrders"), //plural name of the listed records |
  | 14 | 14 | 'ajax'     => false //should this table support ajax? |
  | 15 | 15 |  |
  | […](/browser/clover-online-orders/trunk/admin/includes/class-moo-orders-list.php?rev=2986704#L35) | […](/browser/clover-online-orders/trunk/admin/includes/class-moo-orders-list.php?rev=3168433#L35) |  |
  | 35 | 35 | /\*\* Text displayed when no customer data is available \*/ |
  | 36 | 36 | public function no\_items() { |
  | 37 |  | \_e( 'No orders available.'); |
  |  | 37 | \_e( 'No orders available.',"moo\_OnlineOrders"); |
  | 38 | 38 | } |
  | 39 | 39 |  |
  | […](/browser/clover-online-orders/trunk/admin/includes/class-moo-orders-list.php?rev=2986704#L153) | […](/browser/clover-online-orders/trunk/admin/includes/class-moo-orders-list.php?rev=3168433#L153) |  |
  | 153 | 153 | function get\_columns() { |
  | 154 | 154 | $columns = array( |
  | 155 |  | 'order\_number'    => \_\_( 'Order Number'), |
  | 156 |  | 'customer\_name' => \_\_( 'Customer Name'), |
  | 157 |  | 'order\_type\_label'    => \_\_( 'Order Type'), |
  | 158 |  | 'status' => \_\_( 'Status'), |
  | 159 |  | 'amount' => \_\_( 'Amount'), |
  | 160 |  | 'created\_at\_hf' => \_\_( 'Order Date'), |
  | 161 |  | 'source' => \_\_('Source') |
  |  | 155 | 'order\_number'    => \_\_( 'Order Number', "moo\_OnlineOrders"), |
  |  | 156 | 'customer\_name' => \_\_( 'Customer Name',"moo\_OnlineOrders"), |
  |  | 157 | 'order\_type\_label'    => \_\_( 'Order Type',"moo\_OnlineOrders"), |
  |  | 158 | 'status' => \_\_( 'Status',"moo\_OnlineOrders"), |
  |  | 159 | 'amount' => \_\_( 'Amount',"moo\_OnlineOrders"), |
  |  | 160 | 'created\_at\_hf' => \_\_( 'Order Date',"moo\_OnlineOrders"), |
  |  | 161 | 'source' => \_\_('Source',"moo\_OnlineOrders") |
  | 162 | 162 | ); |
  | 163 | 163 |  |
* ## [clover-online-orders/trunk/admin/includes/class-moo-products-list.php](/changeset/3168433/clover-online-orders/trunk/admin/includes/class-moo-products-list.php "Show the changeset 3168433 restricted to clover-online-orders/trunk/admin/includes/class-moo-products-list.php")

  | [r3142846](/browser/clover-online-orders/trunk/admin/includes/class-moo-products-list.php?rev=3142846#L8 "Show revision 3142846 of this file in browser") | [r3168433](/browser/clover-online-orders/trunk/admin/includes/class-moo-products-list.php?rev=3168433#L8 "Show revision 3168433 of this file in browser") |  |
  | --- | --- | --- |
  | 8 | 8 | protected $editIcon; |
  | 9 | 9 | protected $api; |
  |  | 10 | private $itemsPageUrl; |
  | 10 | 11 |  |
  | 11 | 12 | /\*\* Class constructor \*/ |
  | […](/browser/clover-online-orders/trunk/admin/includes/class-moo-products-list.php?rev=3142846#L13) | […](/browser/clover-online-orders/trunk/admin/includes/class-moo-products-list.php?rev=3168433#L14) |  |
  | 13 | 14 | require\_once plugin\_dir\_path( dirname(\_\_FILE\_\_) )."../includes/moo-OnlineOrders-sooapi.php"; |
  | 14 | 15 | $this->api = new Moo\_OnlineOrders\_SooApi(); |
  |  | 16 | $this->itemsPageUrl = admin\_url('admin.php?page=moo\_items'); |
  | 15 | 17 |  |
  | 16 | 18 | /\*\* Process bulk action \*/ |
  | […](/browser/clover-online-orders/trunk/admin/includes/class-moo-products-list.php?rev=3142846#L22) | […](/browser/clover-online-orders/trunk/admin/includes/class-moo-products-list.php?rev=3168433#L24) |  |
  | 22 | 24 |  |
  | 23 | 25 | parent::\_\_construct( array( |
  | 24 |  | 'singular' => \_\_( 'Item'), //singular name of the listed records |
  | 25 |  | 'plural'   => \_\_( 'Items'), //plural name of the listed records |
  |  | 26 | 'singular' => \_\_( 'Item',"moo\_OnlineOrders"), //singular name of the listed records |
  |  | 27 | 'plural'   => \_\_( 'Items',"moo\_OnlineOrders"), //plural name of the listed records |
  | 26 | 28 | 'ajax'     => false //should this table support ajax? |
  | 27 | 29 |  |
  | […](/browser/clover-online-orders/trunk/admin/includes/class-moo-products-list.php?rev=3142846#L163) | […](/browser/clover-online-orders/trunk/admin/includes/class-moo-products-list.php?rev=3168433#L165) |  |
  | 163 | 165 | /\*\* Text displayed when no customer data is available \*/ |
  | 164 | 166 | public function no\_items() { |
  | 165 |  | \_e( 'No items available.'); |
  |  | 167 | \_e( 'No items available.',"moo\_OnlineOrders"); |
  | 166 | 168 | } |
  | 167 | 169 | /\*\* |
  | […](/browser/clover-online-orders/trunk/admin/includes/class-moo-products-list.php?rev=3142846#L221) | […](/browser/clover-online-orders/trunk/admin/includes/class-moo-products-list.php?rev=3168433#L223) |  |
  | 221 | 223 | } |
  | 222 | 224 |  |
  | 223 |  | if(isset($\_GET["category"])){ |
  | 224 |  | if($item['visible']) { |
  | 225 |  | $actions = array( |
  | 226 |  | 'id' =>"ID: ".esc\_attr($item['uuid']), |
  | 227 |  | 'hide' => sprintf( '<a href="?page=%s&action=%s&item=%s&\_wpnonce=%s&category=%s&paged=%s">Hide from the Website</a>', |
  | 228 |  | 'moo\_items', 'hide',esc\_attr($item['uuid']), $hide\_nonce,esc\_attr($\_GET["category"]),$this->get\_pagenum()) |
  | 229 |  | ); |
  | 230 |  | } else { |
  | 231 |  | $actions = array( |
  | 232 |  | 'id' =>"ID: ".esc\_attr($item['uuid']), |
  | 233 |  | 'show' => sprintf( '<a href="?page=%s&action=%s&item=%s&\_wpnonce=%s&category=%s&paged=%s">Show in the Website</a>', |
  | 234 |  | 'moo\_items', 'show',esc\_attr($item['uuid']), $show\_nonce,esc\_attr($\_GET["category"]),$this->get\_pagenum()) |
  | 235 |  | ); |
  | 236 |  | } |
  | 237 |  | $actions['edit'] = sprintf( '<a href="?page=%s&action=%s&item\_uuid=%s&category=%s&paged=%s">Add / Edit Images</a>', |
  | 238 |  | 'moo\_items', 'update\_item',esc\_attr($item['uuid']),esc\_attr($\_GET["category"]),$this->get\_pagenum()); |
  | 239 |  |  |
  | 240 |  | if($item['outofstock']) { |
  | 241 |  | $actions['disable\_ot']  = sprintf( '<a href="?page=%s&action=%s&item=%s&\_wpnonce=%s&paged=%s&category=%s">Disable out of stock</a>', |
  | 242 |  | 'moo\_items', 'disable\_ot',esc\_attr($item['uuid']), $disable\_ot\_nonce,$this->get\_pagenum(),esc\_attr($\_GET["category"])); |
  | 243 |  | } else { |
  | 244 |  | $actions['enable\_ot']  = sprintf( '<a href="?page=%s&action=%s&item=%s&\_wpnonce=%s&paged=%s&category=%s">Enable out of stock</a>', |
  | 245 |  | 'moo\_items', 'enable\_ot',esc\_attr($item['uuid']), $enable\_ot\_nonce,$this->get\_pagenum(),esc\_attr($\_GET["category"])); |
  | 246 |  | } |
  | 247 |  |  |
  | 248 |  | } else { |
  | 249 |  | if($item['visible']) { |
  | 250 |  | $actions = array( |
  | 251 |  | 'id' =>"ID: ".esc\_attr($item['uuid']), |
  | 252 |  | 'hide' => sprintf( '<a href="?page=%s&action=%s&item=%s&\_wpnonce=%s&paged=%s">Hide from the Website</a>', |
  | 253 |  | 'moo\_items', 'hide',esc\_attr($item['uuid']), $hide\_nonce,$this->get\_pagenum()) |
  | 254 |  | ); |
  | 255 |  | } else { |
  | 256 |  | $actions = array( |
  | 257 |  | 'id' =>"ID: ".esc\_attr($item['uuid']), |
  | 258 |  | 'show' => sprintf( '<a href="?page=%s&action=%s&item=%s&\_wpnonce=%s&paged=%s">Show in the Website</a>', |
  | 259 |  | 'moo\_items', 'show',esc\_attr($item['uuid']), $show\_nonce,$this->get\_pagenum()) |
  | 260 |  | ); |
  | 261 |  | } |
  | 262 |  | $actions['edit'] = sprintf( '<a href="?page=%s&action=%s&item\_uuid=%s&paged=%s">Add / Edit Images</a>', |
  | 263 |  | 'moo\_items', 'update\_item',esc\_attr($item['uuid']),$this->get\_pagenum()); |
  | 264 |  |  |
  | 265 |  | if($item['outofstock']) { |
  | 266 |  | $actions['disable\_ot']  = sprintf( '<a href="?page=%s&action=%s&item=%s&\_wpnonce=%s&paged=%s">Disable out of stock</a>', |
  | 267 |  | 'moo\_items', 'disable\_ot',esc\_attr($item['uuid']), $disable\_ot\_nonce,$this->get\_pagenum()); |
  | 268 |  | } else { |
  | 269 |  | $actions['enable\_ot']  = sprintf( '<a href="?page=%s&action=%s&item=%s&\_wpnonce=%s&paged=%s">Enable out of stock</a>', |
  | 270 |  | 'moo\_items', 'enable\_ot',esc\_attr($item['uuid']), $enable\_ot\_nonce,$this->get\_pagenum()); |
  | 271 |  | } |
  | 272 |  |  |
  | 273 |  |  |
  | 274 |  | } |
  |  | 225 | $actions = array( |
  |  | 226 | 'id' =>"ID: ".esc\_attr($item['uuid']), |
  |  | 227 | ); |
  |  | 228 | if( ! empty( $\_REQUEST['filter'] )){ |
  |  | 229 | $filter = esc\_attr($\_REQUEST['filter']); |
  |  | 230 | } else { |
  |  | 231 | $filter = 'all'; |
  |  | 232 | } |
  |  | 233 |  |
  |  | 234 | if( ! empty( $\_REQUEST['category'] )) { |
  |  | 235 | $actions['edit'] = sprintf( '<a href="?page=%s&action=%s&item\_uuid=%s&category=%s&paged=%s&filter=%s">Add / Edit Images</a>', |
  |  | 236 | 'moo\_items', 'update\_item',esc\_attr($item['uuid']),esc\_attr($\_REQUEST["category"]),$this->get\_pagenum(),$filter); |
  |  | 237 | } else { |
  |  | 238 | $actions['edit'] = sprintf( '<a href="?page=%s&action=%s&item\_uuid=%s&paged=%s&filter=%s">Add / Edit Images</a>', |
  |  | 239 | 'moo\_items', 'update\_item',esc\_attr($item['uuid']),$this->get\_pagenum(),$filter); |
  |  | 240 | } |
  |  | 241 |  |
  |  | 242 | $actions['visibility']  = sprintf( '<a style="%s" id="sooHideAnItem-%s"  data-is-visible="true" href="#" onclick="moo\_changeItemVisibility(event, \'%s\')">Hide from the Website</a><a style="%s" id="sooShowAnItem-%s"  data-is-visible="false" href="#" onclick="moo\_changeItemVisibility(event, \'%s\')">Show in the Website</a>', |
  |  | 243 | (($item['visible'] == '1') ? '':'display: none;'), esc\_attr($item['uuid']), esc\_attr($item['uuid']),  (($item['visible'] == "1") ? 'display: none;':''), esc\_attr($item['uuid']), esc\_attr($item['uuid'])); |
  |  | 244 |  |
  |  | 245 | $actions['outofstock']  = sprintf( '<a style="%s" id="sooOutOfStockItem-%s"  data-is-out-of-stock="true" href="#" onclick="moo\_markItemAsOutOfStock(event, \'%s\')">Enable Out Of Stock</a><a style="%s" id="sooInStockItem-%s"  data-is-out-of-stock="false" href="#" onclick="moo\_markItemAsOutOfStock(event, \'%s\')">Disable Out Of Stock</a>', |
  |  | 246 | (empty($item['outofstock']) ? '':'display: none;'), esc\_attr($item['uuid']), esc\_attr($item['uuid']),  (empty($item['outofstock']) ? 'display: none;':''), esc\_attr($item['uuid']), esc\_attr($item['uuid'])); |
  | 275 | 247 |  |
  | 276 | 248 | $actions['edit\_description'] = sprintf( '<a class="moo-edit-description-button" href="#" onclick="moo\_editItemDescription(event,\'%s\',\'%s\')">Add / Edit description</a>', |
  | 277 |  | esc\_attr($item['uuid']), esc\_js($itemName)~~, esc\_attr($item['uuid'])~~); |
  |  | 249 | esc\_attr($item['uuid']), esc\_js($itemName)); |
  | 278 | 250 |  |
  | 279 | 251 | $actions['featured\_item']  = sprintf( '<a style="%s" id="sooMarkAsFeaturedLink-%s"  data-is-featured="true" href="#" onclick="moo\_markItemAsFeatured(event, \'%s\')">Mark as Featured</a><a style="%s" id="sooMarkAsUnFeaturedLink-%s"  data-is-featured="false" href="#" onclick="moo\_markItemAsFeatured(event, \'%s\')">Unfeature</a>', |
  | 280 | 252 | (empty($item['featured']) ? '':'display: none;'), esc\_attr($item['uuid']), esc\_attr($item['uuid']),  (empty($item['featured']) ? 'display: none;':''), esc\_attr($item['uuid']), esc\_attr($item['uuid'])); |
  |  | 253 |  |
  | 281 | 254 | return $title . $this->row\_actions( $actions ); |
  | 282 | 255 | } |
  | […](/browser/clover-online-orders/trunk/admin/includes/class-moo-products-list.php?rev=3142846#L296) | […](/browser/clover-online-orders/trunk/admin/includes/class-moo-products-list.php?rev=3168433#L269) |  |
  | 296 | 269 | case 'unit\_name': |
  | 297 | 270 | return $item[ $column\_name ]; |
  |  | 271 | case 'visible': |
  |  | 272 | if($item[ $column\_name ]) { |
  |  | 273 | return "<span id='visibility-item-{$item["uuid"]}'>No</span>"; |
  |  | 274 | } else { |
  |  | 275 | return "<span id='visibility-item-{$item["uuid"]}'>Yes</span>"; |
  |  | 276 | } |
  | 298 | 277 | case 'available': |
  |  | 278 | if($item[ $column\_name ]) { |
  |  | 279 | return "<span>Yes</span>"; |
  |  | 280 | } else { |
  |  | 281 | return "<span>No</span>"; |
  |  | 282 | } |
  | 299 | 283 | case 'outofstock': |
  | 300 |  | return intval($item[ $column\_name ])=== 1 ? "Yes" : "No" ; |
  |  | 284 | if($item[ $column\_name ]) { |
  |  | 285 | return "<span id='outofstock-item-{$item["uuid"]}'>Yes</span>"; |
  |  | 286 | } else { |
  |  | 287 | return "<span id='outofstock-item-{$item["uuid"]}'>No</span>"; |
  |  | 288 | } |
  | 301 | 289 | case 'custom\_hours': |
  | 302 | 290 | return $this->getCustomHours($item[ $column\_name ]); |
  | […](/browser/clover-online-orders/trunk/admin/includes/class-moo-products-list.php?rev=3142846#L357) | […](/browser/clover-online-orders/trunk/admin/includes/class-moo-products-list.php?rev=3168433#L345) |  |
  | 357 | 345 | 'cb'      => '<input type="checkbox" />', |
  | 358 | 346 | 'image'      => "", |
  | 359 |  | 'soo\_name'    => \_\_( 'Online Name'), |
  | 360 |  | 'name'    => \_\_( 'Clover Name'), |
  | 361 |  | 'price' => \_\_( 'Price'), |
  | 362 |  | 'price\_type' => \_\_( 'Price Type'), |
  | 363 |  | 'outofstock' => \_\_( 'Out Of Stock'), |
  | 364 |  | 'available' => \_\_( 'Available'), |
  | 365 |  | 'custom\_hours' => \_\_( 'Custom Hours'), |
  |  | 347 | 'soo\_name'    => \_\_( 'Online Name',"moo\_OnlineOrders"), |
  |  | 348 | 'name'    => \_\_( 'Clover Name',"moo\_OnlineOrders"), |
  |  | 349 | 'price' => \_\_( 'Price',"moo\_OnlineOrders"), |
  |  | 350 | 'price\_type' => \_\_( 'Price Type',"moo\_OnlineOrders"), |
  |  | 351 | 'outofstock' => \_\_( 'Out Of Stock',"moo\_OnlineOrders"), |
  |  | 352 | 'visible' => \_\_( 'is Hidden',"moo\_OnlineOrders"), |
  |  | 353 | 'available' => \_\_( 'Available',"moo\_OnlineOrders"), |
  |  | 354 | 'custom\_hours' => \_\_( 'Custom Hours',"moo\_OnlineOrders"), |
  | 366 | 355 |  |
  | 367 | 356 | ); |
  | […](/browser/clover-online-orders/trunk/admin/includes/class-moo-products-list.php?rev=3142846#L428) | […](/browser/clover-online-orders/trunk/admin/includes/class-moo-products-list.php?rev=3168433#L417) |  |
  | 428 | 417 | } |
  | 429 | 418 | public function process\_bulk\_action() { |
  | 430 |  |  |
  | 431 |  | $custom\_url  = add\_query\_arg( 'bulk-status', 'success', remove\_query\_arg( array( 'action', '\_wpnonce' ) ) ); |
  | 432 |  |  |
  |  | 419 | $queryArgs =  array('paged'=>$this->get\_pagenum()); |
  |  | 420 |  |
  |  | 421 | if( ! empty( $\_REQUEST['filter'] )){ |
  |  | 422 | $queryArgs[] = array( |
  |  | 423 | "filter" => esc\_attr($\_REQUEST['filter']) |
  |  | 424 | ); |
  |  | 425 | } |
  |  | 426 |  |
  |  | 427 | if( ! empty( $\_REQUEST['category'] )){ |
  |  | 428 | $queryArgs[] = array( |
  |  | 429 | "category" => esc\_attr($\_REQUEST['category']) |
  |  | 430 | ); |
  |  | 431 | } |
  |  | 432 | $redirect\_url  = add\_query\_arg($queryArgs, $this->itemsPageUrl ); |
  | 433 | 433 | //Detect when a single action is being triggered... |
  | 434 | 434 | if ( 'hide' === $this->current\_action() ) { |
  | […](/browser/clover-online-orders/trunk/admin/includes/class-moo-products-list.php?rev=3142846#L441) | […](/browser/clover-online-orders/trunk/admin/includes/class-moo-products-list.php?rev=3168433#L441) |  |
  | 441 | 441 | } else { |
  | 442 | 442 | $this->hide\_item(sanitize\_text\_field($\_GET['item'])); |
  | 443 |  | wp\_~~redirect($custom~~\_url); |
  |  | 443 | wp\_safe\_redirect($redirect\_url); |
  | 444 | 444 | exit; |
  | 445 | 445 | } |
  | […](/browser/clover-online-orders/trunk/admin/includes/class-moo-products-list.php?rev=3142846#L454) | […](/browser/clover-online-orders/trunk/admin/includes/class-moo-products-list.php?rev=3168433#L454) |  |
  | 454 | 454 | else { |
  | 455 | 455 | $this->show\_item(sanitize\_text\_field($\_GET['item'])); |
  | 456 |  | wp\_~~redirect($custom~~\_url); |
  |  | 456 | wp\_safe\_redirect($redirect\_url); |
  | 457 | 457 | exit; |
  | 458 | 458 | } |
  | […](/browser/clover-online-orders/trunk/admin/includes/class-moo-products-list.php?rev=3142846#L465) | […](/browser/clover-online-orders/trunk/admin/includes/class-moo-products-list.php?rev=3168433#L465) |  |
  | 465 | 465 | } else { |
  | 466 | 466 | $this->out\_of\_stock(sanitize\_text\_field($\_GET['item']),true); |
  | 467 |  | wp\_~~redirect($custom~~\_url); |
  |  | 467 | wp\_safe\_redirect($redirect\_url); |
  | 468 | 468 | exit; |
  | 469 | 469 | } |
  | […](/browser/clover-online-orders/trunk/admin/includes/class-moo-products-list.php?rev=3142846#L475) | […](/browser/clover-online-orders/trunk/admin/includes/class-moo-products-list.php?rev=3168433#L475) |  |
  | 475 | 475 | } else { |
  | 476 | 476 | $this->out\_of\_stock(sanitize\_text\_field($\_GET['item']),false); |
  | 477 |  | wp\_~~redirect($custom~~\_url); |
  |  | 477 | wp\_safe\_redirect($redirect\_url); |
  | 478 | 478 | exit; |
  | 479 | 479 | } |
  | […](/browser/clover-online-orders/trunk/admin/includes/class-moo-products-list.php?rev=3142846#L488) | […](/browser/clover-online-orders/trunk/admin/includes/class-moo-products-list.php?rev=3168433#L488) |  |
  | 488 | 488 | $this->hide\_item( esc\_sql($id) ); |
  | 489 | 489 | } |
  | 490 |  | wp\_~~redirect($custom~~\_url); |
  |  | 490 | wp\_safe\_redirect($redirect\_url); |
  | 491 | 491 | exit; |
  | 492 | 492 | } |
  | […](/browser/clover-online-orders/trunk/admin/includes/class-moo-products-list.php?rev=3142846#L499) | […](/browser/clover-online-orders/trunk/admin/includes/class-moo-products-list.php?rev=3168433#L499) |  |
  | 499 | 499 | } |
  | 500 | 500 |  |
  | 501 |  | wp\_~~redirect($custom~~\_url); |
  |  | 501 | wp\_safe\_redirect($redirect\_url); |
  | 502 | 502 | exit; |
  | 503 | 503 | } |
  | […](/browser/clover-online-orders/trunk/admin/includes/class-moo-products-list.php?rev=3142846#L509) | […](/browser/clover-online-orders/trunk/admin/includes/class-moo-products-list.php?rev=3168433#L509) |  |
  | 509 | 509 | $this->out\_of\_stock( esc\_sql($id),true); |
  | 510 | 510 | } |
  | 511 |  | wp\_~~redirect($custom~~\_url); |
  |  | 511 | wp\_safe\_redirect($redirect\_url); |
  | 512 | 512 | exit; |
  | 513 | 513 | } |
  | […](/browser/clover-online-orders/trunk/admin/includes/class-moo-products-list.php?rev=3142846#L519) | […](/browser/clover-online-orders/trunk/admin/includes/class-moo-products-list.php?rev=3168433#L519) |  |
  | 519 | 519 | $this->out\_of\_stock( esc\_sql($id),false ); |
  | 520 | 520 | } |
  | 521 |  | wp\_~~redirect($custom~~\_url); |
  |  | 521 | wp\_safe\_redirect($redirect\_url); |
  | 522 | 522 | exit; |
  | 523 | 523 | } |
  | 524 | 524 |  |
  | 525 | 525 | if ( 'bulk-feature' === $this->current\_action() ) { |
  | 526 |  |  |
  | 527 | 526 | $ids = esc\_sql( $\_POST['bulk-hideOrShow'] ); |
  | 528 | 527 | // loop over the array of record IDs and delete them |
  | […](/browser/clover-online-orders/trunk/admin/includes/class-moo-products-list.php?rev=3142846#L531) | […](/browser/clover-online-orders/trunk/admin/includes/class-moo-products-list.php?rev=3168433#L530) |  |
  | 531 | 530 | } |
  | 532 | 531 |  |
  | 533 |  | wp\_~~redirect($custom~~\_url); |
  |  | 532 | wp\_safe\_redirect($redirect\_url); |
  | 534 | 533 | exit; |
  | 535 | 534 | } |
  | […](/browser/clover-online-orders/trunk/admin/includes/class-moo-products-list.php?rev=3142846#L541) | […](/browser/clover-online-orders/trunk/admin/includes/class-moo-products-list.php?rev=3168433#L540) |  |
  | 541 | 540 | $this->markItemAsFeatured( esc\_sql($id), false ); |
  | 542 | 541 | } |
  | 543 |  | wp\_~~redirect($custom~~\_url); |
  |  | 542 | wp\_safe\_redirect($redirect\_url); |
  | 544 | 543 | exit; |
  | 545 | 544 | } |
  | […](/browser/clover-online-orders/trunk/admin/includes/class-moo-products-list.php?rev=3142846#L548) | […](/browser/clover-online-orders/trunk/admin/includes/class-moo-products-list.php?rev=3168433#L547) |  |
  | 548 | 547 | } |
  | 549 | 548 | public function single\_row( $item ) { |
  | 550 |  | if(! $item['visible']) |
  | 551 |  | echo '<tr class="item-hidden">'; |
  | 552 |  | else |
  | 553 |  | echo '<tr>'; |
  |  | 549 | if(! $item['visible']) { |
  |  | 550 | echo "<tr class='item-hidden' id='soo-item-row-{$item["uuid"]}'>"; |
  |  | 551 | } else { |
  |  | 552 | echo "<tr id='soo-item-row-{$item["uuid"]}'>"; |
  |  | 553 | } |
  | 554 | 554 | $this->single\_row\_columns( $item ); |
  | 555 | 555 | echo '</tr>'; |
  | […](/browser/clover-online-orders/trunk/admin/includes/class-moo-products-list.php?rev=3142846#L572) | […](/browser/clover-online-orders/trunk/admin/includes/class-moo-products-list.php?rev=3168433#L572) |  |
  | 572 | 572 | foreach( $cats as $cat ){ |
  | 573 | 573 | $selected = ''; |
  | 574 |  | if( $\_GET['category'] == $cat['uuid'] ){ |
  |  | 574 | if(isset($\_GET['category']) && $\_GET['category'] == $cat['uuid'] ){ |
  | 575 | 575 | $selected = ' selected = "selected"'; |
  | 576 | 576 | } |
  | 577 |  | ~~$custom\_url  = add\_query\_arg( 'category', $cat['uuid'] , remove\_query\_arg( array( 's', 'paged', 'alert' ) ));~~ |
  | 578 | 577 | ?> |
  | 579 |  | <option value="<?php echo ~~$custom\_url~~; ?>" <?php echo $selected; ?>><?php |
  |  | 578 | <option value="<?php echo esc\_attr($cat['uuid']); ?>" <?php echo $selected; ?>><?php |
  | 580 | 579 | if($cat["alternate\_name"]=="" || $cat["alternate\_name"]== null ){ |
  | 581 | 580 | echo stripslashes((string)$cat['name']); |
  | […](/browser/clover-online-orders/trunk/admin/includes/class-moo-products-list.php?rev=3142846#L607) | […](/browser/clover-online-orders/trunk/admin/includes/class-moo-products-list.php?rev=3168433#L606) |  |
  | 607 | 606 | //All Actions |
  | 608 | 607 | $class        = ( $current == 'all' ? ' class="current"' : '' ); |
  | 609 |  | $all\_url      = remove\_query\_arg( array( 'filter', 's', 'paged', 'alert', 'user' ) ); |
  | 610 |  | $views['all'] = "<a href='{$~~all\_url~~ }' {$class} >All Items</a>"; |
  |  | 608 | //$all\_url      = remove\_query\_arg( array( 'filter', 's', 'paged', 'alert', 'user' ) ); |
  |  | 609 | $views['all'] = "<a href='{$this->itemsPageUrl}' {$class} >All Items</a>"; |
  | 611 | 610 | $views\_item   = array( |
  | 612 | 611 | 'featured'   => array( "name" => "Featured Items", "featured" => 1 ) |
  | 613 | 612 | ); |
  | 614 | 613 | foreach ( $views\_item as $k => $v ) { |
  | 615 |  | $custom\_url  = add\_query\_arg( ~~'filter', $k, remove\_query\_arg( array( 's', 'paged', 'alert' ) )~~ ); |
  |  | 614 | $custom\_url  = add\_query\_arg( array('filter'=>$k), $this->itemsPageUrl ); |
  | 616 | 615 | $class       = ( $current == $k ? ' class="current"' : '' ); |
  | 617 | 616 | $views[ $k ] = "<a href='{$custom\_url}' {$class} >" . $v['name'] . "</a>"; |
* ## [clover-online-orders/trunk/admin/includes/class-wp-list-table-moo.php](/changeset/3168433/clover-online-orders/trunk/admin/includes/class-wp-list-table-moo.php "Show the changeset 3168433 restricted to clover-online-orders/trunk/admin/includes/class-wp-list-table-moo.php")

  | [r2986704](/browser/clover-online-orders/trunk/admin/includes/class-wp-list-table-moo.php?rev=2986704#L140 "Show revision 2986704 of this file in browser") | [r3168433](/browser/clover-online-orders/trunk/admin/includes/class-wp-list-table-moo.php?rev=3168433#L140 "Show revision 3168433 of this file in browser") |  |
  | --- | --- | --- |
  | 140 | 140 | if ( empty( $this->modes ) ) { |
  | 141 | 141 | $this->modes = array( |
  | 142 |  | 'list'    => \_\_( 'List View' ), |
  | 143 |  | 'excerpt' => \_\_( 'Excerpt View' ) |
  |  | 142 | 'list'    => \_\_( 'List View',"moo\_OnlineOrders" ), |
  |  | 143 | 'excerpt' => \_\_( 'Excerpt View',"moo\_OnlineOrders" ) |
  | 144 | 144 | ); |
  | 145 | 145 | } |
  | […](/browser/clover-online-orders/trunk/admin/includes/class-wp-list-table-moo.php?rev=2986704#L310) | […](/browser/clover-online-orders/trunk/admin/includes/class-wp-list-table-moo.php?rev=3168433#L310) |  |
  | 310 | 310 | \*/ |
  | 311 | 311 | public function no\_items() { |
  | 312 |  | \_e( 'No items found.' ); |
  |  | 312 | \_e( 'No items found.',"moo\_OnlineOrders" ); |
  | 313 | 313 | } |
  | 314 | 314 |  |
  | […](/browser/clover-online-orders/trunk/admin/includes/class-wp-list-table-moo.php?rev=2986704#L436) | […](/browser/clover-online-orders/trunk/admin/includes/class-wp-list-table-moo.php?rev=3168433#L436) |  |
  | 436 | 436 | return; |
  | 437 | 437 |  |
  | 438 |  | echo "<label for='bulk-action-selector-" . esc\_attr( $which ) . "' class='screen-reader-text'>" . \_\_( 'Select bulk action' ) . "</label>"; |
  |  | 438 | echo "<label for='bulk-action-selector-" . esc\_attr( $which ) . "' class='screen-reader-text'>" . \_\_( 'Select bulk action',"moo\_OnlineOrders" ) . "</label>"; |
  | 439 | 439 | echo "<select name='action$two' id='bulk-action-selector-" . esc\_attr( $which ) . "'>\n"; |
  | 440 |  | echo "<option value='-1' selected='selected'>" . \_\_( 'Bulk Actions' ) . "</option>\n"; |
  |  | 440 | echo "<option value='-1' selected='selected'>" . \_\_( 'Bulk Actions',"moo\_OnlineOrders" ) . "</option>\n"; |
  | 441 | 441 |  |
  | 442 | 442 | foreach ( $this->\_actions as $name => $title ) { |
  | […](/browser/clover-online-orders/trunk/admin/includes/class-wp-list-table-moo.php?rev=2986704#L448) | […](/browser/clover-online-orders/trunk/admin/includes/class-wp-list-table-moo.php?rev=3168433#L448) |  |
  | 448 | 448 | echo "</select>\n"; |
  | 449 | 449 |  |
  | 450 |  | submit\_button( \_\_( 'Apply' ), 'action', '', false, array( 'id' => "doaction$two" ) ); |
  |  | 450 | submit\_button( \_\_( 'Apply',"moo\_OnlineOrders" ), 'action', '', false, array( 'id' => "doaction$two" ) ); |
  | 451 | 451 | echo "\n"; |
  | 452 | 452 | } |
  | […](/browser/clover-online-orders/trunk/admin/includes/class-wp-list-table-moo.php?rev=2986704#L498) | […](/browser/clover-online-orders/trunk/admin/includes/class-wp-list-table-moo.php?rev=3168433#L498) |  |
  | 498 | 498 | $out .= '</div>'; |
  | 499 | 499 |  |
  | 500 |  | $out .= '<button type="button" class="toggle-row"><span class="screen-reader-text">' . \_\_( 'Show more details' ) . '</span></button>'; |
  |  | 500 | $out .= '<button type="button" class="toggle-row"><span class="screen-reader-text">' . \_\_( 'Show more details',"moo\_OnlineOrders" ) . '</span></button>'; |
  | 501 | 501 |  |
  | 502 | 502 | return $out; |
  | […](/browser/clover-online-orders/trunk/admin/includes/class-wp-list-table-moo.php?rev=2986704#L553) | […](/browser/clover-online-orders/trunk/admin/includes/class-wp-list-table-moo.php?rev=3168433#L553) |  |
  | 553 | 553 | $m = isset( $\_GET['m'] ) ? (int) $\_GET['m'] : 0; |
  | 554 | 554 | ?> |
  | 555 |  | <label for="filter-by-date" class="screen-reader-text"><?php \_e( 'Filter by date' ); ?></label> |
  |  | 555 | <label for="filter-by-date" class="screen-reader-text"><?php \_e( 'Filter by date',"moo\_OnlineOrders" ); ?></label> |
  | 556 | 556 | <select name="m" id="filter-by-date"> |
  | 557 |  | <option<?php selected( $m, 0 ); ?> value="0"><?php \_e( 'All dates' ); ?></option> |
  |  | 557 | <option<?php selected( $m, 0 ); ?> value="0"><?php \_e( 'All dates',"moo\_OnlineOrders" ); ?></option> |
  | 558 | 558 | <?php |
  | 559 | 559 | foreach ( $months as $arc\_row ) { |
  | […](/browser/clover-online-orders/trunk/admin/includes/class-wp-list-table-moo.php?rev=2986704#L568) | […](/browser/clover-online-orders/trunk/admin/includes/class-wp-list-table-moo.php?rev=3168433#L568) |  |
  | 568 | 568 | esc\_attr( $arc\_row->year . $month ), |
  | 569 | 569 | /\* translators: 1: month name, 2: 4-digit year \*/ |
  | 570 |  | sprintf( \_\_( '%1$s %2$d' ), $wp\_locale->get\_month( $month ), $year ) |
  |  | 570 | sprintf( \_\_( '%1$s %2$d',"moo\_OnlineOrders" ), $wp\_locale->get\_month( $month ), $year ) |
  | 571 | 571 | ); |
  | 572 | 572 | } |
  | […](/browser/clover-online-orders/trunk/admin/includes/class-wp-list-table-moo.php?rev=2986704#L619) | […](/browser/clover-online-orders/trunk/admin/includes/class-wp-list-table-moo.php?rev=3168433#L619) |  |
  | 619 | 619 | $approved\_comments\_number = number\_format\_i18n( $approved\_comments ); |
  | 620 | 620 | $pending\_comments\_number = number\_format\_i18n( $pending\_comments ); |
  | 621 |  |  |
  | 622 |  | $approved\_only\_phrase = sprintf( \_n( '%s comment', '%s comments', $approved\_comments ), $approved\_comments\_number ); |
  | 623 |  | $approved\_phrase = sprintf( \_n( '%s approved comment', '%s approved comments', $approved\_comments ), $approved\_comments\_number ); |
  | 624 |  | $pending\_phrase = sprintf( \_n( '%s pending comment', '%s pending comments', $pending\_comments ), $pending\_comments\_number ); |
  |  | 621 | /\* translators: Nb Of comments \*/ |
  |  | 622 | $approved\_only\_phrase = sprintf( \_n( '%s comment', '%s comments', $approved\_comments,"moo\_OnlineOrders" ), $approved\_comments\_number ); |
  |  | 623 | /\* translators: Nb Of approved comments \*/ |
  |  | 624 | $approved\_phrase = sprintf( \_n( '%s approved comment', '%s approved comments', $approved\_comments,"moo\_OnlineOrders" ), $approved\_comments\_number ); |
  |  | 625 | /\* translators: Nb Of Pending comments \*/ |
  |  | 626 | $pending\_phrase = sprintf( \_n( '%s pending comment', '%s pending comments', $pending\_comments,"moo\_OnlineOrders" ), $pending\_comments\_number ); |
  | 625 | 627 |  |
  | 626 | 628 | // No comments at all. |
  | 627 | 629 | if ( ! $approved\_comments && ! $pending\_comments ) { |
  | 628 | 630 | printf( '<span aria-hidden="true">—</span><span class="screen-reader-text">%s</span>', |
  | 629 |  | \_\_( 'No comments' ) |
  |  | 631 | \_\_( 'No comments',"moo\_OnlineOrders" ) |
  | 630 | 632 | ); |
  | 631 | 633 | // Approved comments have different display depending on some conditions. |
  | […](/browser/clover-online-orders/trunk/admin/includes/class-wp-list-table-moo.php?rev=2986704#L639) | […](/browser/clover-online-orders/trunk/admin/includes/class-wp-list-table-moo.php?rev=3168433#L641) |  |
  | 639 | 641 | printf( '<span class="post-com-count post-com-count-no-comments"><span class="comment-count comment-count-no-comments" aria-hidden="true">%s</span><span class="screen-reader-text">%s</span></span>', |
  | 640 | 642 | $approved\_comments\_number, |
  | 641 |  | $pending\_comments ? \_\_( 'No approved comments'~~) : \_\_( 'No comments'~~ ) |
  |  | 643 | $pending\_comments ? \_\_( 'No approved comments',"moo\_OnlineOrders" ) : \_\_( 'No comments',"moo\_OnlineOrders" ) |
  | 642 | 644 | ); |
  | 643 | 645 | } |
  | […](/browser/clover-online-orders/trunk/admin/includes/class-wp-list-table-moo.php?rev=2986704#L719) | […](/browser/clover-online-orders/trunk/admin/includes/class-wp-list-table-moo.php?rev=3168433#L721) |  |
  | 719 | 721 | $infinite\_scroll = $this->\_pagination\_args['infinite\_scroll']; |
  | 720 | 722 | } |
  | 721 |  |  |
  | 722 |  | $output = '<span class="displaying-num">' . sprintf( \_n( '%s item', '%s items', $total\_items ), number\_format\_i18n( $total\_items ) ) . '</span>'; |
  |  | 723 | /\* translators: Nb of Items \*/ |
  |  | 724 | $output = '<span class="displaying-num">' . sprintf( \_n( '%s item', '%s items', $total\_items,"moo\_OnlineOrders" ), number\_format\_i18n( $total\_items ) ) . '</span>'; |
  | 723 | 725 |  |
  | 724 | 726 | $current = $this->get\_pagenum(); |
  | […](/browser/clover-online-orders/trunk/admin/includes/class-wp-list-table-moo.php?rev=2986704#L755) | […](/browser/clover-online-orders/trunk/admin/includes/class-wp-list-table-moo.php?rev=3168433#L757) |  |
  | 755 | 757 | $page\_links[] = sprintf( "<a class='first-page' href='%s'><span class='screen-reader-text'>%s</span><span aria-hidden='true'>%s</span></a>", |
  | 756 | 758 | esc\_url( remove\_query\_arg( 'paged', $current\_url ) ), |
  | 757 |  | \_\_( 'First page' ), |
  |  | 759 | \_\_( 'First page',"moo\_OnlineOrders" ), |
  | 758 | 760 | '&laquo;' |
  | 759 | 761 | ); |
  | […](/browser/clover-online-orders/trunk/admin/includes/class-wp-list-table-moo.php?rev=2986704#L765) | […](/browser/clover-online-orders/trunk/admin/includes/class-wp-list-table-moo.php?rev=3168433#L767) |  |
  | 765 | 767 | $page\_links[] = sprintf( "<a class='prev-page' href='%s'><span class='screen-reader-text'>%s</span><span aria-hidden='true'>%s</span></a>", |
  | 766 | 768 | esc\_url( add\_query\_arg( 'paged', max( 1, $current-1 ), $current\_url ) ), |
  | 767 |  | \_\_( 'Previous page' ), |
  |  | 769 | \_\_( 'Previous page',"moo\_OnlineOrders" ), |
  | 768 | 770 | '&lsaquo;' |
  | 769 | 771 | ); |
  | […](/browser/clover-online-orders/trunk/admin/includes/class-wp-list-table-moo.php?rev=2986704#L772) | […](/browser/clover-online-orders/trunk/admin/includes/class-wp-list-table-moo.php?rev=3168433#L774) |  |
  | 772 | 774 | if ( 'bottom' == $which ) { |
  | 773 | 775 | $html\_current\_page  = $current; |
  | 774 |  | $total\_pages\_before = '<span class="screen-reader-text">' . \_\_( 'Current Page' ) . '</span><span id="table-paging" class="paging-input">'; |
  |  | 776 | $total\_pages\_before = '<span class="screen-reader-text">' . \_\_( 'Current Page',"moo\_OnlineOrders" ) . '</span><span id="table-paging" class="paging-input">'; |
  | 775 | 777 | } else { |
  | 776 | 778 | $html\_current\_page = sprintf( "%s<input class='current-page' id='current-page-selector' type='text' name='paged' value='%s' size='%d' aria-describedby='table-paging' />", |
  | 777 |  | '<label for="current-page-selector" class="screen-reader-text">' . \_\_( 'Current Page' ) . '</label>', |
  |  | 779 | '<label for="current-page-selector" class="screen-reader-text">' . \_\_( 'Current Page',"moo\_OnlineOrders" ) . '</label>', |
  | 778 | 780 | $current, |
  | 779 | 781 | strlen( $total\_pages ) |
  | […](/browser/clover-online-orders/trunk/admin/includes/class-wp-list-table-moo.php?rev=2986704#L781) | […](/browser/clover-online-orders/trunk/admin/includes/class-wp-list-table-moo.php?rev=3168433#L783) |  |
  | 781 | 783 | } |
  | 782 | 784 | $html\_total\_pages = sprintf( "<span class='total-pages'>%s</span>", number\_format\_i18n( $total\_pages ) ); |
  | 783 |  | $page\_links[] = $total\_pages\_before . sprintf( \_x( '%1$s of %2$s', 'paging' ), $html\_current\_page, $html\_total\_pages ) . $total\_pages\_after; |
  |  | 785 | /\* translators: Nb of pages \*/ |
  |  | 786 | $page\_links[] = $total\_pages\_before . sprintf( \_x( '%1$s of %2$s', 'paging',"moo\_OnlineOrders" ), $html\_current\_page, $html\_total\_pages ) . $total\_pages\_after; |
  | 784 | 787 |  |
  | 785 | 788 | if ( $disable\_next ) { |
  | […](/browser/clover-online-orders/trunk/admin/includes/class-wp-list-table-moo.php?rev=2986704#L788) | […](/browser/clover-online-orders/trunk/admin/includes/class-wp-list-table-moo.php?rev=3168433#L791) |  |
  | 788 | 791 | $page\_links[] = sprintf( "<a class='next-page' href='%s'><span class='screen-reader-text'>%s</span><span aria-hidden='true'>%s</span></a>", |
  | 789 | 792 | esc\_url( add\_query\_arg( 'paged', min( $total\_pages, $current+1 ), $current\_url ) ), |
  | 790 |  | \_\_( 'Next page' ), |
  |  | 793 | \_\_( 'Next page',"moo\_OnlineOrders" ), |
  | 791 | 794 | '&rsaquo;' |
  | 792 | 795 | ); |
  | […](/browser/clover-online-orders/trunk/admin/includes/class-wp-list-table-moo.php?rev=2986704#L798) | […](/browser/clover-online-orders/trunk/admin/includes/class-wp-list-table-moo.php?rev=3168433#L801) |  |
  | 798 | 801 | $page\_links[] = sprintf( "<a class='last-page' href='%s'><span class='screen-reader-text'>%s</span><span aria-hidden='true'>%s</span></a>", |
  | 799 | 802 | esc\_url( add\_query\_arg( 'paged', $total\_pages, $current\_url ) ), |
  | 800 |  | \_\_( 'Last page' ), |
  |  | 803 | \_\_( 'Last page',"moo\_OnlineOrders" ), |
  | 801 | 804 | '&raquo;' |
  | 802 | 805 | ); |
  | […](/browser/clover-online-orders/trunk/admin/includes/class-wp-list-table-moo.php?rev=2986704#L1001) | […](/browser/clover-online-orders/trunk/admin/includes/class-wp-list-table-moo.php?rev=3168433#L1004) |  |
  | 1001 | 1004 | if ( ! empty( $columns['cb'] ) ) { |
  | 1002 | 1005 | static $cb\_counter = 1; |
  | 1003 |  | $columns['cb'] = '<label class="screen-reader-text" for="cb-select-all-' . $cb\_counter . '">' . \_\_( 'Select All' ) . '</label>' |
  |  | 1006 | $columns['cb'] = '<label class="screen-reader-text" for="cb-select-all-' . $cb\_counter . '">' . \_\_( 'Select All',"moo\_OnlineOrders" ) . '</label>' |
  | 1004 | 1007 | . '<input id="cb-select-all-' . $cb\_counter . '" type="checkbox" />'; |
  | 1005 | 1008 | $cb\_counter++; |
  | […](/browser/clover-online-orders/trunk/admin/includes/class-wp-list-table-moo.php?rev=2986704#L1252) | […](/browser/clover-online-orders/trunk/admin/includes/class-wp-list-table-moo.php?rev=3168433#L1255) |  |
  | 1252 | 1255 | \*/ |
  | 1253 | 1256 | protected function handle\_row\_actions( $item, $column\_name, $primary ) { |
  | 1254 |  | return $column\_name == $primary ? '<button type="button" class="toggle-row"><span class="screen-reader-text">' . \_\_( 'Show more details' ) . '</span></button>' : ''; |
  |  | 1257 | return $column\_name == $primary ? '<button type="button" class="toggle-row"><span class="screen-reader-text">' . \_\_( 'Show more details',"moo\_OnlineOrders" ) . '</span></button>' : ''; |
  | 1255 | 1258 | } |
  | 1256 | 1259 |  |
  | […](/browser/clover-online-orders/trunk/admin/includes/class-wp-list-table-moo.php?rev=2986704#L1276) | […](/browser/clover-online-orders/trunk/admin/includes/class-wp-list-table-moo.php?rev=3168433#L1279) |  |
  | 1276 | 1279 |  |
  | 1277 | 1280 | if ( isset( $this->\_pagination\_args['total\_items'] ) ) { |
  | 1278 |  | $response['total\_items\_i18n'] = sprintf( |
  | 1279 |  | \_n( '%s item', '%s items', $this->\_pagination\_args['total\_items'] ), |
  | 1280 |  | number\_format\_i18n( $this->\_pagination\_args['total\_items'] ) |
  | 1281 |  | ); |
  |  | 1281 | /\* translators: Nb Of items \*/ |
  |  | 1282 | $str = \_n( '%s item', '%s items', $this->\_pagination\_args['total\_items'],"moo\_OnlineOrders" ); |
  |  | 1283 | $response['total\_items\_i18n'] = sprintf($str, number\_format\_i18n( $this->\_pagination\_args['total\_items'] )); |
  | 1282 | 1284 | } |
  | 1283 | 1285 | if ( isset( $this->\_pagination\_args['total\_pages'] ) ) { |
* ## [clover-online-orders/trunk/admin/js/moo-OnlineOrders-admin.js](/changeset/3168433/clover-online-orders/trunk/admin/js/moo-OnlineOrders-admin.js "Show the changeset 3168433 restricted to clover-online-orders/trunk/admin/js/moo-OnlineOrders-admin.js")

  | [r3142846](/browser/clover-online-orders/trunk/admin/js/moo-OnlineOrders-admin.js?rev=3142846#L2468 "Show revision 3142846 of this file in browser") | [r3168433](/browser/clover-online-orders/trunk/admin/js/moo-OnlineOrders-admin.js?rev=3168433#L2468 "Show revision 3168433 of this file in browser") |  |
  | --- | --- | --- |
  | 2468 | 2468 | { |
  | 2469 | 2469 | e.preventDefault(); |
  | 2470 |  | var url = jQuery('#moo\_cat\_filter').val(); |
  | 2471 |  |  |
  | 2472 |  | if(url && url != '') { |
  | 2473 |  | document.location.href = url |
  |  | 2470 | var catUuid = jQuery('#moo\_cat\_filter').val(); |
  |  | 2471 | if(catUuid && catUuid !== '') { |
  |  | 2472 | document.location.href = 'admin.php?page=moo\_items&category='+catUuid; |
  | 2474 | 2473 | } else { |
  | 2475 | 2474 | document.location.href = 'admin.php?page=moo\_items'; |
  | 2476 | 2475 | } |
  | 2477 | 2476 | } |
  | 2478 |  | function moo\_markItemAsFeatured(e,item\_uuid~~, isFeaturedOld~~) { |
  |  | 2477 | function moo\_markItemAsFeatured(e,item\_uuid) { |
  | 2479 | 2478 | e.preventDefault(); |
  | 2480 | 2479 | swal({ |
  | […](/browser/clover-online-orders/trunk/admin/js/moo-OnlineOrders-admin.js?rev=3142846#L2520) | […](/browser/clover-online-orders/trunk/admin/js/moo-OnlineOrders-admin.js?rev=3168433#L2519) |  |
  | 2520 | 2519 | }); |
  | 2521 | 2520 | } |
  |  | 2521 | } else { |
  |  | 2522 | swal({ |
  |  | 2523 | title: "Error", |
  |  | 2524 | text: 'Try again', |
  |  | 2525 | type: "error", |
  |  | 2526 | confirmButtonText: "ok" |
  |  | 2527 | }); |
  |  | 2528 | } |
  |  | 2529 | }); |
  |  | 2530 | } |
  |  | 2531 | function moo\_markItemAsOutOfStock(e,item\_uuid) { |
  |  | 2532 | e.preventDefault(); |
  |  | 2533 | swal({ |
  |  | 2534 | title: 'Please wait ..', |
  |  | 2535 | showConfirmButton: false |
  |  | 2536 | }); |
  |  | 2537 | const isOutOfStock = jQuery(e.target).data('isOutOfStock'); |
  |  | 2538 | jQuery.ajax({ |
  |  | 2539 | type: 'POST', |
  |  | 2540 | url: moo\_RestUrl+"moo-clover/v1/dashboard/out\_of\_stock\_items", |
  |  | 2541 | contentType: 'application/json; charset=UTF-8', |
  |  | 2542 | beforeSend: function(jqXhr) { |
  |  | 2543 | jqXhr.setRequestHeader('X-WP-Nonce', moo\_params.nonce) |
  |  | 2544 | }, |
  |  | 2545 | data: JSON.stringify({"itemUuid":item\_uuid,"isOutOfStock":isOutOfStock}) |
  |  | 2546 | }).fail(function (data) { |
  |  | 2547 | //Change butn text |
  |  | 2548 | swal({ |
  |  | 2549 | title: "Error", |
  |  | 2550 | text: 'An has occurred, please refresh the page or contact us', |
  |  | 2551 | type: "error", |
  |  | 2552 | confirmButtonText: "ok" |
  |  | 2553 | }); |
  |  | 2554 | }).done(function (data) { |
  |  | 2555 | if(data.status === "success"){ |
  |  | 2556 | if (isOutOfStock){ |
  |  | 2557 | jQuery('#sooOutOfStockItem-'+item\_uuid).hide(); |
  |  | 2558 | jQuery('#sooInStockItem-'+item\_uuid).show(); |
  |  | 2559 | jQuery('#outofstock-item-'+item\_uuid).text("Yes"); |
  |  | 2560 | swal({ |
  |  | 2561 | title: "Done!", |
  |  | 2562 | text: 'The item has been marked as out of stock', |
  |  | 2563 | type: "success", |
  |  | 2564 | confirmButtonText: "ok" |
  |  | 2565 | }); |
  |  | 2566 | } else { |
  |  | 2567 | jQuery('#sooOutOfStockItem-'+item\_uuid).show(); |
  |  | 2568 | jQuery('#sooInStockItem-'+item\_uuid).hide(); |
  |  | 2569 | jQuery('#outofstock-item-'+item\_uuid).text("No"); |
  |  | 2570 | swal({ |
  |  | 2571 | title: "Done!", |
  |  | 2572 | text: 'The item has been marked as in stock', |
  |  | 2573 | type: "success", |
  |  | 2574 | confirmButtonText: "ok" |
  |  | 2575 | }); |
  |  | 2576 | } |
  |  | 2577 | } else { |
  |  | 2578 | swal({ |
  |  | 2579 | title: "Error", |
  |  | 2580 | text: 'Try again', |
  |  | 2581 | type: "error", |
  |  | 2582 | confirmButtonText: "ok" |
  |  | 2583 | }); |
  |  | 2584 | } |
  |  | 2585 | }); |
  |  | 2586 | } |
  |  | 2587 | function moo\_changeItemVisibility(e,item\_uuid) { |
  |  | 2588 | e.preventDefault(); |
  |  | 2589 | swal({ |
  |  | 2590 | title: 'Please wait ..', |
  |  | 2591 | showConfirmButton: false |
  |  | 2592 | }); |
  |  | 2593 | const isVisible = jQuery(e.target).data('is-visible'); |
  |  | 2594 | jQuery.ajax({ |
  |  | 2595 | type: 'POST', |
  |  | 2596 | url: moo\_RestUrl+"moo-clover/v1/dashboard/showhide\_items", |
  |  | 2597 | contentType: 'application/json; charset=UTF-8', |
  |  | 2598 | beforeSend: function(jqXhr) { |
  |  | 2599 | jqXhr.setRequestHeader('X-WP-Nonce', moo\_params.nonce) |
  |  | 2600 | }, |
  |  | 2601 | data: JSON.stringify({"itemUuid":item\_uuid,"visibility":!isVisible}) |
  |  | 2602 | }).fail(function (data) { |
  |  | 2603 | //Change butn text |
  |  | 2604 | swal({ |
  |  | 2605 | title: "Error", |
  |  | 2606 | text: 'An has occurred, please refresh the page or contact us', |
  |  | 2607 | type: "error", |
  |  | 2608 | confirmButtonText: "ok" |
  |  | 2609 | }); |
  |  | 2610 | }).done(function (data) { |
  |  | 2611 | if(data.status === "success") { |
  |  | 2612 | if (!isVisible){ |
  |  | 2613 | jQuery('#sooShowAnItem-'+item\_uuid).hide(); |
  |  | 2614 | jQuery('#sooHideAnItem-'+item\_uuid).show(); |
  |  | 2615 | jQuery('#visibility-item-'+item\_uuid).text("No"); |
  |  | 2616 | swal({ |
  |  | 2617 | title: "Done!", |
  |  | 2618 | text: 'The item has been marked as visible', |
  |  | 2619 | type: "success", |
  |  | 2620 | confirmButtonText: "ok" |
  |  | 2621 | }); |
  |  | 2622 | } else { |
  |  | 2623 | jQuery('#sooShowAnItem-'+item\_uuid).show(); |
  |  | 2624 | jQuery('#sooHideAnItem-'+item\_uuid).hide(); |
  |  | 2625 | jQuery('#visibility-item-'+item\_uuid).text("Yes"); |
  |  | 2626 | swal({ |
  |  | 2627 | title: "Done!", |
  |  | 2628 | text: 'The item has been marked as hidden', |
  |  | 2629 | type: "success", |
  |  | 2630 | confirmButtonText: "ok" |
  |  | 2631 | }); |
  |  | 2632 | } |
  |  | 2633 | jQuery('#soo-item-row-'+item\_uuid).toggleClass( "item-hidden" ); |
  | 2522 | 2634 | } else { |
  | 2523 | 2635 | swal({ |
  | […](/browser/clover-online-orders/trunk/admin/js/moo-OnlineOrders-admin.js?rev=3142846#L2906) | […](/browser/clover-online-orders/trunk/admin/js/moo-OnlineOrders-admin.js?rev=3168433#L3018) |  |
  | 2906 | 3018 | }) |
  | 2907 | 3019 | } |
  |  | 3020 |  |
  |  | 3021 | /\* |
  |  | 3022 | \* Repair the database issues |
  |  | 3023 | \* @version 1.5.8 |
  |  | 3024 | \*/ |
  |  | 3025 |  |
  |  | 3026 | function sooRepairDatabase(e) |
  |  | 3027 | { |
  |  | 3028 | e.preventDefault(); |
  |  | 3029 | swal({ |
  |  | 3030 | title: 'Repairing your database', |
  |  | 3031 | text: 'Please wait...', |
  |  | 3032 | showConfirmButton: false |
  |  | 3033 | }); |
  |  | 3034 | jQuery.ajax({ |
  |  | 3035 | type: 'GET', |
  |  | 3036 | url: moo\_RestUrl+"moo-clover/v1/tools/repair\_database", |
  |  | 3037 | beforeSend: function(jqXhr) { |
  |  | 3038 | jqXhr.setRequestHeader('X-WP-Nonce', moo\_params.nonce) |
  |  | 3039 | } |
  |  | 3040 | }).fail(function (data) { |
  |  | 3041 | //Change butn text |
  |  | 3042 | swal({ |
  |  | 3043 | title: "Error", |
  |  | 3044 | text: 'An has occurred, please refresh the page or contact us', |
  |  | 3045 | type: "error", |
  |  | 3046 | confirmButtonText: "ok" |
  |  | 3047 | }); |
  |  | 3048 | }).done(function (data) { |
  |  | 3049 | if(data.status === "success"){ |
  |  | 3050 | swal({ |
  |  | 3051 | title: "All Done!", |
  |  | 3052 | text: 'Your database has been repaired.', |
  |  | 3053 | type: "success", |
  |  | 3054 | confirmButtonText: "ok" |
  |  | 3055 | }); |
  |  | 3056 | } else { |
  |  | 3057 | swal({ |
  |  | 3058 | title: "Error", |
  |  | 3059 | text: 'Database repair was not completed successfully. Please verify your data or contact support if the issue persists', |
  |  | 3060 | type: "error", |
  |  | 3061 | confirmButtonText: "ok" |
  |  | 3062 | }); |
  |  | 3063 | } |
  |  | 3064 | }); |
  |  | 3065 | } |
  | 2908 | 3066 | /\* |
  | 2909 | 3067 | \* This function to Clean the inventory, we set teh typOfdate wich may take (order\_tyes,tax\_rates,categories,items..) |
  | […](/browser/clover-online-orders/trunk/admin/js/moo-OnlineOrders-admin.js?rev=3142846#L3114) | […](/browser/clover-online-orders/trunk/admin/js/moo-OnlineOrders-admin.js?rev=3168433#L3272) |  |
  | 3114 | 3272 | }); |
  | 3115 | 3273 | } |
  | 3116 |  | function enableOrDisable~~New~~Checkout() { |
  | 3117 |  | const enable = jQuery('#soo~~New~~CheckoutPage').is(":checked"); |
  |  | 3274 | function enableOrDisableOldCheckout() { |
  |  | 3275 | const enable = jQuery('#sooOldCheckoutPage').is(":checked"); |
  | 3118 | 3276 | if(enable){ |
  | 3119 | 3277 | swal({ |
  | 3120 |  | title: 'Enabling the ~~new~~ Checkout page...', |
  |  | 3278 | title: 'Enabling the old Checkout page...', |
  | 3121 | 3279 | showConfirmButton: false |
  | 3122 | 3280 | }); |
  | […](/browser/clover-online-orders/trunk/admin/js/moo-OnlineOrders-admin.js?rev=3142846#L3128) | […](/browser/clover-online-orders/trunk/admin/js/moo-OnlineOrders-admin.js?rev=3168433#L3286) |  |
  | 3128 | 3286 | } |
  | 3129 | 3287 |  |
  | 3130 |  | let endpoint = moo\_RestUrl+'moo-clover/v2/dash/enable-new-checkout'; |
  | 3131 |  |  |
  |  | 3288 | let endpoint = moo\_RestUrl+'moo-clover/v2/dash/enable-old-checkout'; |
  | 3132 | 3289 | if(moo\_RestUrl.indexOf("?rest\_route") !== -1){ |
  | 3133 | 3290 | endpoint += '&\_wpnonce='+ moo\_params.nonce; |
  | […](/browser/clover-online-orders/trunk/admin/js/moo-OnlineOrders-admin.js?rev=3142846#L3135) | […](/browser/clover-online-orders/trunk/admin/js/moo-OnlineOrders-admin.js?rev=3168433#L3292) |  |
  | 3135 | 3292 | endpoint += '?\_wpnonce='+ moo\_params.nonce; |
  | 3136 | 3293 | } |
  | 3137 |  |  |
  | 3138 | 3294 | var data = { |
  | 3139 | 3295 | "status":enable |
  | […](/browser/clover-online-orders/trunk/admin/js/moo-OnlineOrders-admin.js?rev=3142846#L3145) | […](/browser/clover-online-orders/trunk/admin/js/moo-OnlineOrders-admin.js?rev=3168433#L3301) |  |
  | 3145 | 3301 | swal({ |
  | 3146 | 3302 | type:"success", |
  | 3147 |  | title:"New Checkout Page is Now Live", |
  |  | 3303 | title:"Old Checkout Page is Enabled", |
  |  | 3304 | text:"Checkout beta enabled, Google Pay and DoorDash Drive Integration is available with this feature reach out to support@zaytech.com for instructions on how to get started." |
  |  | 3305 | }); |
  |  | 3306 | jQuery('#sooAdditionalPaymentMethods').hide(); |
  |  | 3307 | // Show Google Recaptcha |
  |  | 3308 | } else { |
  |  | 3309 | swal({ |
  |  | 3310 | type:"success", |
  |  | 3311 | title:"Old Checkout Page is Disabled", |
  | 3148 | 3312 | text:"Checkout beta enabled, Google Pay and DoorDash Drive Integration is available with this feature reach out to support@zaytech.com for instructions on how to get started." |
  | 3149 | 3313 | }); |
  | 3150 | 3314 | jQuery('#sooAdditionalPaymentMethods').show(); |
  | 3151 |  | ~~// Show Google Recaptcha~~ |
  | 3152 |  | ~~} else {~~ |
  | 3153 |  | ~~swal({~~ |
  | 3154 |  | ~~type:"warning",~~ |
  | 3155 |  | ~~title:'Change to Previous Version Confirmed',~~ |
  | 3156 |  | ~~text:'Reverting back to the previous version, if you have experienced any issues please provide an image and description of the issue to support@zaytech.com'~~ |
  | 3157 |  | ~~});~~ |
  | 3158 |  | ~~jQuery('#sooAdditionalPaymentMethods').hide();~~ |
  | 3159 | 3315 | // Hide Google Recaptcha |
  | 3160 | 3316 | } |
  | 3161 | 3317 | } else { |
  | 3162 |  | jQuery('#soo~~New~~CheckoutPage').prop('checked',!enable) |
  |  | 3318 | jQuery('#sooOldCheckoutPage').prop('checked',!enable) |
  | 3163 | 3319 | swal({ |
  | 3164 | 3320 | type:"error", |
  | […](/browser/clover-online-orders/trunk/admin/js/moo-OnlineOrders-admin.js?rev=3142846#L3168) | […](/browser/clover-online-orders/trunk/admin/js/moo-OnlineOrders-admin.js?rev=3168433#L3324) |  |
  | 3168 | 3324 |  |
  | 3169 | 3325 | }).fail(function (response) { |
  | 3170 |  | jQuery('#soo~~New~~CheckoutPage').prop('checked',!enable) |
  |  | 3326 | jQuery('#sooOldCheckoutPage').prop('checked',!enable) |
  | 3171 | 3327 | swal({ |
  | 3172 | 3328 | text: 'Error Occurred: Please Refresh and Retry' |
  | […](/browser/clover-online-orders/trunk/admin/js/moo-OnlineOrders-admin.js?rev=3142846#L3282) | […](/browser/clover-online-orders/trunk/admin/js/moo-OnlineOrders-admin.js?rev=3168433#L3438) |  |
  | 3282 | 3438 | function mooShowWaitMessage() { |
  | 3283 | 3439 | swal({ |
  | 3284 |  | title: 'Saving your changes~~, please wait~~ ..', |
  |  | 3440 | title: 'Saving your changes ..', |
  | 3285 | 3441 | showConfirmButton: false |
  | 3286 | 3442 | }); |
* ## [clover-online-orders/trunk/admin/moo-OnlineOrders-admin.php](/changeset/3168433/clover-online-orders/trunk/admin/moo-OnlineOrders-admin.php "Show the changeset 3168433 restricted to clover-online-orders/trunk/admin/moo-OnlineOrders-admin.php")

  | [r3142846](/browser/clover-online-orders/trunk/admin/moo-OnlineOrders-admin.php?rev=3142846#L87 "Show revision 3142846 of this file in browser") | [r3168433](/browser/clover-online-orders/trunk/admin/moo-OnlineOrders-admin.php?rev=3168433#L87 "Show revision 3168433 of this file in browser") |  |
  | --- | --- | --- |
  | 87 | 87 | $products->prepare\_items(); |
  | 88 | 88 | $model = $this->model; |
  | 89 |  | if(isset($\_GET['action']) && $\_GET['action'] == 'update\_item')  { |
  | 90 |  | if(isset($\_GET['item\_uuid']) && $\_GET['item\_uuid'] != '') { |
  |  | 89 | if(isset($\_GET['action']) && $\_GET['action'] == 'update\_item'  && !empty($\_GET['item\_uuid']))  { |
  | 91 | 90 | $item\_uuid = esc\_attr($\_GET['item\_uuid']); |
  | 92 | 91 | $item = $model->getItem($item\_uuid); |
  | […](/browser/clover-online-orders/trunk/admin/moo-OnlineOrders-admin.php?rev=3142846#L99) | […](/browser/clover-online-orders/trunk/admin/moo-OnlineOrders-admin.php?rev=3168433#L98) |  |
  | 99 | 98 | $customHours = $this->api->getMerchantCustomHours("categories"); |
  | 100 | 99 |  |
  | 101 |  | if(~~isset($\_GET['paged']) && $\_GET['paged'] != ''~~){ |
  | 102 |  | $goBackLink = 'admin.php?page=moo\_items&paged='.~~intval~~($\_GET['paged']); |
  |  | 100 | if(!empty($\_GET['paged'])){ |
  |  | 101 | $goBackLink = 'admin.php?page=moo\_items&paged='.esc\_attr($\_GET['paged']); |
  | 103 | 102 | } else { |
  | 104 | 103 | $goBackLink = 'admin.php?page=moo\_items'; |
  | 105 | 104 | } |
  | 106 |  | if(isset($\_GET['category']) && $\_GET['category'] != ''){ |
  | 107 |  | $goBackLink = $goBackLink . '&category='. sanitize\_text\_field($\_GET['category']); |
  |  | 105 | if(!empty($\_GET['category'])){ |
  |  | 106 | $goBackLink = $goBackLink . '&category='. esc\_attr($\_GET['category']); |
  |  | 107 | } |
  |  | 108 | if(!empty($\_GET['filter'])){ |
  |  | 109 | $goBackLink = $goBackLink . '&filter='. esc\_attr($\_GET['filter']); |
  | 108 | 110 | } |
  | 109 | 111 |  |
  | […](/browser/clover-online-orders/trunk/admin/moo-OnlineOrders-admin.php?rev=3142846#L168) | […](/browser/clover-online-orders/trunk/admin/moo-OnlineOrders-admin.php?rev=3168433#L170) |  |
  | 168 | 170 |  |
  | 169 | 171 | <?php |
  | 170 |  | } |
  |  | 172 |  |
  | 171 | 173 | } else { |
  | 172 | 174 | ?> |
  | […](/browser/clover-online-orders/trunk/admin/moo-OnlineOrders-admin.php?rev=3142846#L475) | […](/browser/clover-online-orders/trunk/admin/moo-OnlineOrders-admin.php?rev=3168433#L477) |  |
  | 475 | 477 | <?php if($message!="") echo $message; ?> |
  | 476 | 478 | <h1 style="float: left;">List of coupons</h1> |
  | 477 |  | <a href="<?php echo add\_query\_arg(array("action"=>"add\_coupon"),remove\_query\_arg( array('coupon', 'paged'))); ?>" class="page-title-action" style="float: left;top: 11px;margin-left: 18px;">Add Coupon</a> |
  |  | 479 | <a href="<?php |
  |  | 480 | echo add\_query\_arg(array("action"=>"add\_coupon"),admin\_url('admin.php?page=moo\_coupons')); |
  |  | 481 | ?>" class="page-title-action" style="float: left;top: 11px;margin-left: 18px;">Add Coupon</a> |
  | 478 | 482 | <div id="poststuff"> |
  | 479 | 483 | <div id="post-body" class="metabox-holder"> |
  | […](/browser/clover-online-orders/trunk/admin/moo-OnlineOrders-admin.php?rev=3142846#L940) | […](/browser/clover-online-orders/trunk/admin/moo-OnlineOrders-admin.php?rev=3168433#L944) |  |
  | 940 | 944 | <p class="moo-merchant-address"></p> |
  | 941 | 945 | <?php |
  | 942 |  | $link = esc\_url(add\_query\_arg(~~'moo\_section', 'update\_address',(admin\_url('admin.php?page=moo\_index')~~))); |
  |  | 946 | $link = esc\_url(add\_query\_arg(array('moo\_section'=>'update\_address'),admin\_url('admin.php?page=moo\_index'))); |
  | 943 | 947 | if($mooOptions['lat'] === null || $mooOptions['lng'] === null){ |
  | 944 | 948 | echo '<a href="'.$link.'">Click here to localize the address on map to calulcate delivery fees correctly</a>'; |
  | […](/browser/clover-online-orders/trunk/admin/moo-OnlineOrders-admin.php?rev=3142846#L992) | […](/browser/clover-online-orders/trunk/admin/moo-OnlineOrders-admin.php?rev=3168433#L996) |  |
  | 992 | 996 | </div> |
  | 993 | 997 | <?php } ?> |
  | 994 |  | ~~<div class="moo-row moo-subSection">~~ |
  | 995 |  | ~~<div class="moo-col-md-2 moo-centred">~~ |
  | 996 |  | ~~<img  width="80px" src="<?php echo plugin\_dir\_url(dirname(\_\_FILE\_\_))."admin/img/iconSooNew.svg";?>" alt=""/>~~ |
  | 997 |  | ~~</div>~~ |
  | 998 |  | ~~<div class="moo-col-md-8">~~ |
  | 999 |  | ~~<?php~~ |
  | 1000 |  | ~~$newCheckoutEnabled = get\_option('moo\_new\_checkout\_enabled') === 'yes';~~ |
  | 1001 |  | ~~echo "<h3>New (Beta) Checkout Page</h3>";~~ |
  | 1002 |  | ~~echo "<p>Will allow customers to earn Loyalty Points when Ordering from the Website. For even more convenience, we recommend getting the Branded App to give customers even more control.</p>";~~ |
  | 1003 |  | ~~?>~~ |
  | 1004 |  | ~~</div>~~ |
  | 1005 |  | ~~<div class="moo-col-md-2">~~ |
  | 1006 |  | ~~<div class="soo-onoffswitch" title="Enable or disable the new checkout" style="float: right;margin-top: 38px;margin-right: 20px;">~~ |
  | 1007 |  | ~~<input type="checkbox" name="sooNewCheckoutPage" id="sooNewCheckoutPage" class="soo-onoffswitch-checkbox" onchange="enableOrDisableNewCheckout()" <?php  echo $newCheckoutEnabled?'checked':''; ?> >~~ |
  | 1008 |  | ~~<label class="soo-onoffswitch-label" for="sooNewCheckoutPage">~~ |
  | 1009 |  | ~~<span class="soo-onoffswitch-inner"></span>~~ |
  | 1010 |  | ~~<span class="soo-onoffswitch-switch"></span>~~ |
  | 1011 |  | ~~</label>~~ |
  | 1012 |  | ~~</div>~~ |
  | 1013 |  | ~~</div>~~ |
  | 1014 |  | ~~</div>~~ |
  | 1015 | 998 | <div class="moo-row moo-subSection"> |
  | 1016 | 999 | <div class="moo-col-md-12"> |
  | […](/browser/clover-online-orders/trunk/admin/moo-OnlineOrders-admin.php?rev=3142846#L1197) | […](/browser/clover-online-orders/trunk/admin/moo-OnlineOrders-admin.php?rev=3168433#L1180) |  |
  | 1197 | 1180 | <div class="Moo\_option-item"> |
  | 1198 | 1181 | <div class="button\_center"> |
  | 1199 |  | <a href="#" onclick="MooPanel\_CleanInventory(event)" class="button button-secondary"  style="margin: 0 auto">Clean Inventory</a> |
  |  | 1182 | <a href="#" onclick="MooPanel\_CleanInventory(event)" class="button button-secondary moo-form-inline"  style="margin: 0 auto">Clean Inventory</a> |
  |  | 1183 | </div> |
  |  | 1184 | </div> |
  |  | 1185 |  |
  |  | 1186 | </div> |
  |  | 1187 | <div class="MooPanelItem"> |
  |  | 1188 | <h3>Repair Database</h3> |
  |  | 1189 | <p> |
  |  | 1190 | If you encounter issues with importing your inventory or syncing, it may be due to upgrading from an older version without the database updating correctly. In this case, use the "Repair Database" button to resolve all database issues. If the problem persists, contact us at [ support@zaytech.com ] for further assistance. |
  |  | 1191 | </p> |
  |  | 1192 | <div id="moo\_progressbar\_container"></div> |
  |  | 1193 | <div class="Moo\_option-item"> |
  |  | 1194 | <div class="button\_center"> |
  |  | 1195 | <a href="#" onclick="sooRepairDatabase(event)" class="button button-secondary"  style="margin: 0 auto">Repair Database</a> |
  | 1200 | 1196 | </div> |
  | 1201 | 1197 |  |
  | […](/browser/clover-online-orders/trunk/admin/moo-OnlineOrders-admin.php?rev=3142846#L1602) | […](/browser/clover-online-orders/trunk/admin/moo-OnlineOrders-admin.php?rev=3168433#L1598) |  |
  | 1602 | 1598 | </span> |
  | 1603 | 1599 | </div> |
  | 1604 |  | <div ~~id="sooAdditionalPaymentMethods" style="display: <?php echo get\_option('moo\_new\_checkout\_enabled') === 'yes' ? 'block':'none~~'; ?>"> |
  | 1605 |  | <div class="Moo\_option-item~~" style="display:<?php echo (!empty(SOO\_ACCEPT\_GIFTCARDS))?"block":"none"; ?>"~~> |
  |  | 1600 | <div  id="sooAdditionalPaymentMethods" class="<?php echo get\_option('moo\_old\_checkout\_enabled') === 'yes' ? 'soo-display-none':'soo-display-block'; ?>"> |
  |  | 1601 | <div class="Moo\_option-item <?php echo (!empty(SOO\_ACCEPT\_GIFTCARDS))?"soo-display-block":"soo-display-none"; ?>" > |
  | 1606 | 1602 | <div style="margin-bottom: 14px;" class="label">Accept Clover Gift Cards</div> |
  | 1607 | 1603 | <div class="moo-onoffswitch"  title="Accept Clover Gift Cards"> |
  | […](/browser/clover-online-orders/trunk/admin/moo-OnlineOrders-admin.php?rev=3142846#L1870) | […](/browser/clover-online-orders/trunk/admin/moo-OnlineOrders-admin.php?rev=3168433#L1866) |  |
  | 1870 | 1866 | <label id="MooTextUnderSI" >Your text</label> |
  | 1871 | 1867 | </div> |
  | 1872 |  | <div class="iwl\_input\_holder"><input name="moo\_settings[text\_under\_special\_instructions]" id="MooTextUnderSI" type="text" value="<?php echo $mooOptions['text\_under\_special\_instructions']?>" /></div> |
  |  | 1868 | <div class="iwl\_input\_holder"> |
  |  | 1869 | <textarea name="moo\_settings[text\_under\_special\_instructions]"  id="MooTextUnderSI" type="text"><?php echo $mooOptions['text\_under\_special\_instructions']?></textarea> |
  |  | 1870 | </div> |
  | 1873 | 1871 | </div> |
  | 1874 | 1872 | </div> |
  | […](/browser/clover-online-orders/trunk/admin/moo-OnlineOrders-admin.php?rev=3142846#L1889) | […](/browser/clover-online-orders/trunk/admin/moo-OnlineOrders-admin.php?rev=3168433#L1887) |  |
  | 1889 | 1887 |  |
  | 1890 | 1888 | </div> |
  | 1891 |  | <!-- Thank you page --> |
  |  | 1889 | <!-- Thank you page --> |
  | 1892 | 1890 | <div class="MooPanelItem MooPanelItemExpanded"> |
  | 1893 | 1891 | <h3 onclick="expandSection(this)">Thank you page</h3> |
  | […](/browser/clover-online-orders/trunk/admin/moo-OnlineOrders-admin.php?rev=3142846#L1919) | […](/browser/clover-online-orders/trunk/admin/moo-OnlineOrders-admin.php?rev=3168433#L1917) |  |
  | 1919 | 1917 | <div class="iwl\_holder"><div class="iwl\_label\_holder"><label id="MooDefaultMerchantEmail" >Or Enter The Full URL</label></div> |
  | 1920 | 1918 | <div class="iwl\_input\_holder"><input name="moo\_settings[thanks\_page]" id="MooDefaultMerchantEmail" type="text" value="<?php echo $mooOptions['thanks\_page']?>" placeholder="https://" /></div> |
  |  | 1919 | </div> |
  |  | 1920 | </div> |
  |  | 1921 | </div> |
  |  | 1922 | <!-- Enable old Checkout back in case if issues --> |
  |  | 1923 | <div class="MooPanelItem MooPanelItemExpanded"> |
  |  | 1924 | <?php |
  |  | 1925 | $oldCheckoutEnabled = get\_option('moo\_old\_checkout\_enabled') === 'yes'; |
  |  | 1926 | ?> |
  |  | 1927 | <h3 onclick="expandSection(this)">Return to Previous Checkout</h3> |
  |  | 1928 | <div class="Moo\_option-item" > |
  |  | 1929 | <div class="normal\_text"> |
  |  | 1930 | Reverting back to the previous version of checkout page, if you have experienced any issues please provide an image and description of the issue to support@zaytech.com. The previous version is available for a limited time. |
  |  | 1931 | </div> |
  |  | 1932 | </div> |
  |  | 1933 | <div class="Moo\_option-item" > |
  |  | 1934 | <div class="normal\_text"> |
  |  | 1935 | <div class="soo-onoffswitch" title="Enable or disable the new checkout" style="float: right;margin-top: 38px;margin-right: 20px;"> |
  |  | 1936 | <input type="checkbox" name="sooOldCheckoutPage" id="sooOldCheckoutPage" class="soo-onoffswitch-checkbox" onchange="enableOrDisableOldCheckout()" <?php  echo $oldCheckoutEnabled?'checked':''; ?> > |
  |  | 1937 | <label class="soo-onoffswitch-label" for="sooOldCheckoutPage"> |
  |  | 1938 | <span class="soo-onoffswitch-inner"></span> |
  |  | 1939 | <span class="soo-onoffswitch-switch"></span> |
  |  | 1940 | </label> |
  |  | 1941 | </div> |
  | 1921 | 1942 | </div> |
  | 1922 | 1943 | </div> |
* ## [clover-online-orders/trunk/includes/moo-OnlineOrders-Restapi.php](/changeset/3168433/clover-online-orders/trunk/includes/moo-OnlineOrders-Restapi.php "Show the changeset 3168433 restricted to clover-online-orders/trunk/includes/moo-OnlineOrders-Restapi.php")

  | [r3142846](/browser/clover-online-orders/trunk/includes/moo-OnlineOrders-Restapi.php?rev=3142846#L318 "Show revision 3142846 of this file in browser") | [r3168433](/browser/clover-online-orders/trunk/includes/moo-OnlineOrders-Restapi.php?rev=3168433#L318 "Show revision 3168433 of this file in browser") |  |
  | --- | --- | --- |
  | 318 | 318 | ) ); |
  | 319 | 319 |  |
  | 320 |  | // Get Fresh version for blackout times |
  |  | 320 | // Get a Fresh version for blackout times |
  | 321 | 321 | register\_rest\_route( $this->namespace, '/tools/update\_blackouts', array( |
  | 322 | 322 | array( |
  | […](/browser/clover-online-orders/trunk/includes/moo-OnlineOrders-Restapi.php?rev=3142846#L324) | […](/browser/clover-online-orders/trunk/includes/moo-OnlineOrders-Restapi.php?rev=3168433#L324) |  |
  | 324 | 324 | 'callback'  => array( $this, 'updateBlackouts' ), |
  | 325 | 325 | 'permission\_callback' => '\_\_return\_true' |
  |  | 326 | ) |
  |  | 327 | ) ); |
  |  | 328 |  |
  |  | 329 | register\_rest\_route( $this->namespace, '/tools/repair\_database', array( |
  |  | 330 | array( |
  |  | 331 | 'methods'   => 'GET', |
  |  | 332 | 'callback'  => array( $this, 'repairDatabase' ), |
  |  | 333 | 'permission\_callback' => array( $this, 'permissionCheck' ) |
  | 326 | 334 | ) |
  | 327 | 335 | ) ); |
  | […](/browser/clover-online-orders/trunk/includes/moo-OnlineOrders-Restapi.php?rev=3142846#L429) | […](/browser/clover-online-orders/trunk/includes/moo-OnlineOrders-Restapi.php?rev=3168433#L437) |  |
  | 429 | 437 | ) |
  | 430 | 438 | ) ); |
  |  | 439 |  |
  |  | 440 | register\_rest\_route( $this->namespace, '/dashboard/out\_of\_stock\_items', array( |
  |  | 441 | array( |
  |  | 442 | 'methods'   => 'POST', |
  |  | 443 | 'callback'  => array( $this, 'markItemAsOutOfStock' ), |
  |  | 444 | 'permission\_callback' => array( $this, 'permissionCheck' ) |
  |  | 445 | ) |
  |  | 446 | ) ); |
  |  | 447 |  |
  |  | 448 | register\_rest\_route( $this->namespace, '/dashboard/showhide\_items', array( |
  |  | 449 | array( |
  |  | 450 | 'methods'   => 'POST', |
  |  | 451 | 'callback'  => array( $this, 'showHideAnItem' ), |
  |  | 452 | 'permission\_callback' => array( $this, 'permissionCheck' ) |
  |  | 453 | ) |
  |  | 454 | ) ); |
  |  | 455 |  |
  | 431 | 456 |  |
  | 432 | 457 | //Customer account functions |
  | […](/browser/clover-online-orders/trunk/includes/moo-OnlineOrders-Restapi.php?rev=3142846#L1807) | […](/browser/clover-online-orders/trunk/includes/moo-OnlineOrders-Restapi.php?rev=3168433#L1832) |  |
  | 1807 | 1832 | } |
  | 1808 | 1833 | } |
  |  | 1834 | public function markItemAsOutOfStock($request) { |
  |  | 1835 | $request\_body   = json\_decode($request->get\_body(),true); |
  |  | 1836 | $itemUuid    = sanitize\_text\_field($request\_body['itemUuid']); |
  |  | 1837 | $isOutOfStock    = boolval($request\_body['isOutOfStock']); |
  |  | 1838 |  |
  |  | 1839 | if( ! empty($itemUuid) ) { |
  |  | 1840 | $res = $this->model->updateItem(["outofstock"=>$isOutOfStock, "uuid"=>$itemUuid,], true); |
  |  | 1841 | if ($res){ |
  |  | 1842 | $this->api->sendEvent([ |
  |  | 1843 | "event"=>'updated-items' |
  |  | 1844 | ]); |
  |  | 1845 | } |
  |  | 1846 | return array( |
  |  | 1847 | 'status'    => $res ? 'success' :  'failed' |
  |  | 1848 | ); |
  |  | 1849 | } else { |
  |  | 1850 | return array( |
  |  | 1851 | 'status'    => 'failed' |
  |  | 1852 | ); |
  |  | 1853 | } |
  |  | 1854 | } |
  |  | 1855 | public function showHideAnItem($request) { |
  |  | 1856 | $request\_body   = json\_decode($request->get\_body(),true); |
  |  | 1857 | $itemUuid    = sanitize\_text\_field($request\_body['itemUuid']); |
  |  | 1858 | $visibility    = boolval($request\_body['visibility']); |
  |  | 1859 |  |
  |  | 1860 | if( ! empty($itemUuid) ) { |
  |  | 1861 | $res = $this->model->updateItem(["visible"=>$visibility, "uuid"=>$itemUuid,], true); |
  |  | 1862 | if ($res){ |
  |  | 1863 | $this->api->sendEvent([ |
  |  | 1864 | "event"=>'updated-items' |
  |  | 1865 | ]); |
  |  | 1866 | } |
  |  | 1867 | return array( |
  |  | 1868 | 'status'    => $res ? 'success' :  'failed' |
  |  | 1869 | ); |
  |  | 1870 | } else { |
  |  | 1871 | return array( |
  |  | 1872 | 'status'    => 'failed' |
  |  | 1873 | ); |
  |  | 1874 | } |
  |  | 1875 | } |
  | 1809 | 1876 | public function changeApiKey($request) { |
  | 1810 | 1877 | $request\_body   = json\_decode($request->get\_body(),true); |
  | […](/browser/clover-online-orders/trunk/includes/moo-OnlineOrders-Restapi.php?rev=3142846#L1865) | […](/browser/clover-online-orders/trunk/includes/moo-OnlineOrders-Restapi.php?rev=3168433#L1932) |  |
  | 1865 | 1932 | "status"=>'success', |
  | 1866 | 1933 | ); |
  |  | 1934 | } |
  |  | 1935 | public function repairDatabase( $request ){ |
  |  | 1936 | try { |
  |  | 1937 | if (! class\_exists( 'Moo\_OnlineOrders\_Helpers' ) ){ |
  |  | 1938 | require\_once SOO\_PLUGIN\_PATH ."/includes/moo-OnlineOrders-helpers.php"; |
  |  | 1939 | } |
  |  | 1940 |  |
  |  | 1941 | Moo\_OnlineOrders\_Helpers::upgradeDatabaseToVersion136(); |
  |  | 1942 | Moo\_OnlineOrders\_Helpers::upgradeDatabaseToVersion150(); |
  |  | 1943 | Moo\_OnlineOrders\_Helpers::upgradeDatabaseToVersion158(); |
  |  | 1944 |  |
  |  | 1945 | return array( |
  |  | 1946 | "status"=>'success', |
  |  | 1947 | ); |
  |  | 1948 |  |
  |  | 1949 | } catch (Exception $e) { |
  |  | 1950 | return array( |
  |  | 1951 | "status"=>'error', |
  |  | 1952 | ); |
  |  | 1953 | } |
  | 1867 | 1954 | } |
  | 1868 | 1955 |  |
* ## [clover-online-orders/trunk/includes/moo-OnlineOrders-activator.php](/changeset/3168433/clover-online-orders/trunk/includes/moo-OnlineOrders-activator.php "Show the changeset 3168433 restricted to clover-online-orders/trunk/includes/moo-OnlineOrders-activator.php")

  | [r3142846](/browser/clover-online-orders/trunk/includes/moo-OnlineOrders-activator.php?rev=3142846#L486 "Show revision 3142846 of this file in browser") | [r3168433](/browser/clover-online-orders/trunk/includes/moo-OnlineOrders-activator.php?rev=3168433#L486 "Show revision 3168433 of this file in browser") |  |
  | --- | --- | --- |
  | 486 | 486 | ) |
  | 487 | 487 | ); |
  | 488 |  | $~~defaul~~tOptions = (array)get\_option( 'moo\_settings' ); |
  | 489 |  |  |
  | 490 |  | if(!isset($~~defaultOptions['store\_page']) || $defaul~~tOptions['store\_page'] == "" ) |
  |  | 488 | $currentOptions = (array)get\_option( 'moo\_settings' ); |
  |  | 489 |  |
  |  | 490 | if(!isset($currentOptions['store\_page']) || $currentOptions['store\_page'] == "" ) |
  | 491 | 491 | { |
  | 492 | 492 | $store\_page\_id =  wp\_insert\_post( $pages['store'], false ); |
  | 493 |  | $~~defaul~~tOptions['store\_page'] = $store\_page\_id ; |
  |  | 493 | $currentOptions['store\_page'] = $store\_page\_id ; |
  | 494 | 494 | } |
  | 495 |  | if(!isset($~~defaultOptions['checkout\_page']) || $defaul~~tOptions['checkout\_page'] == "") |
  |  | 495 | if(!isset($currentOptions['checkout\_page']) || $currentOptions['checkout\_page'] == "") |
  | 496 | 496 | { |
  | 497 | 497 | $checkout\_page\_id =  wp\_insert\_post( $pages['checkout'], false ); |
  | 498 |  | $~~defaul~~tOptions['checkout\_page'] =  $checkout\_page\_id; |
  |  | 498 | $currentOptions['checkout\_page'] =  $checkout\_page\_id; |
  | 499 | 499 | } |
  | 500 |  | if(!isset($~~defaultOptions['cart\_page']) || $defaul~~tOptions['cart\_page'] == "") |
  |  | 500 | if(!isset($currentOptions['cart\_page']) || $currentOptions['cart\_page'] == "") |
  | 501 | 501 | { |
  | 502 | 502 | $cart\_page\_id  =  wp\_insert\_post( $pages['cart'], false ); |
  | 503 |  | $~~defaul~~tOptions['cart\_page'] = $cart\_page\_id ; |
  |  | 503 | $currentOptions['cart\_page'] = $cart\_page\_id ; |
  | 504 | 504 | } |
  | 505 |  | if(!isset($~~defaultOptions['my\_account\_page']) || $defaul~~tOptions['my\_account\_page'] == "") |
  |  | 505 | if(!isset($currentOptions['my\_account\_page']) || $currentOptions['my\_account\_page'] == "") |
  | 506 | 506 | { |
  | 507 | 507 | $login\_page\_id  =  wp\_insert\_post( $pages['my\_account\_page'], false ); |
  | 508 |  | $~~defaul~~tOptions['my\_account\_page'] = $login\_page\_id ; |
  |  | 508 | $currentOptions['my\_account\_page'] = $login\_page\_id ; |
  | 509 | 509 | } |
  | 510 | 510 |  |
  | […](/browser/clover-online-orders/trunk/includes/moo-OnlineOrders-activator.php?rev=3142846#L513) | […](/browser/clover-online-orders/trunk/includes/moo-OnlineOrders-activator.php?rev=3168433#L513) |  |
  | 513 | 513 |  |
  | 514 | 514 | // Enable the new checkout |
  | 515 |  | update\_option("moo\_~~new\_checkout\_enabled",'yes~~'); |
  | 516 |  |  |
  | 517 |  | ~~$defaultOptions = self::applyDefaultOptions($defaultOptions);~~ |
  | 518 |  |  |
  | 519 |  | update\_option('moo\_settings', $defaultOptions ); |
  |  | 515 | update\_option("moo\_old\_checkout\_enabled",'no'); |
  |  | 516 |  |
  |  | 517 | //Apply default options |
  |  | 518 | Moo\_OnlineOrders\_Helpers::applyDefaultOptions($currentOptions); |
  |  | 519 |  |
  | 520 | 520 | } |
  | 521 |  | public static function applyDefaultOptions($MooOptions) { |
  |  | 521 | public static function applyDefaultOptionsOld($MooOptions) { |
  | 522 | 522 | $default\_options = array( |
  | 523 | 523 | array("name"=>"api\_key","value"=>""), |
  | […](/browser/clover-online-orders/trunk/includes/moo-OnlineOrders-activator.php?rev=3142846#L537) | […](/browser/clover-online-orders/trunk/includes/moo-OnlineOrders-activator.php?rev=3168433#L537) |  |
  | 537 | 537 | array("name"=>"custom\_sa\_title","value"=>""), |
  | 538 | 538 | array("name"=>"custom\_sa\_onCheckoutPage","value"=>"off"), |
  | 539 |  | array("name"=>"copyrights","value"=>'Powered by <a href="https://wordpress.org/plugins/clover-online-orders/" target="\_blank" title="Online Orders for Clover POS v 1.5.~~7~~">Smart Online Order</a>'), |
  |  | 539 | array("name"=>"copyrights","value"=>'Powered by <a href="https://wordpress.org/plugins/clover-online-orders/" target="\_blank" title="Online Orders for Clover POS v 1.5.8">Smart Online Order</a>'), |
  | 540 | 540 | array("name"=>"default\_style","value"=>"onePage"), |
  | 541 | 541 | array("name"=>"track\_stock","value"=>""), |
  | […](/browser/clover-online-orders/trunk/includes/moo-OnlineOrders-activator.php?rev=3142846#L545) | […](/browser/clover-online-orders/trunk/includes/moo-OnlineOrders-activator.php?rev=3168433#L545) |  |
  | 545 | 545 | array("name"=>"payment\_creditcard","value"=>"off"), |
  | 546 | 546 | array("name"=>"clover\_payment\_form","value"=>"on"), |
  | 547 |  | array("name"=>"payment\_cash","value"=>"on"), |
  | 548 |  | array("name"=>"payment\_cash\_delivery","value"=>"on"), |
  |  | 547 | array("name"=>"clover\_googlepay","value"=>"on"), |
  |  | 548 | array("name"=>"clover\_applepay","value"=>"on"), |
  |  | 549 | array("name"=>"clover\_giftcards","value"=>"off"), |
  |  | 550 | array("name"=>"payment\_cash","value"=>"off"), |
  |  | 551 | array("name"=>"payment\_cash\_delivery","value"=>"off"), |
  | 549 | 552 | array("name"=>"scp","value"=>"off"), |
  | 550 | 553 | array("name"=>"merchant\_phone","value"=>""), |
* ## [clover-online-orders/trunk/includes/moo-OnlineOrders-helpers.php](/changeset/3168433/clover-online-orders/trunk/includes/moo-OnlineOrders-helpers.php "Show the changeset 3168433 restricted to clover-online-orders/trunk/includes/moo-OnlineOrders-helpers.php")

  | [r3142846](/browser/clover-online-orders/trunk/includes/moo-OnlineOrders-helpers.php?rev=3142846#L20 "Show revision 3142846 of this file in browser") | [r3168433](/browser/clover-online-orders/trunk/includes/moo-OnlineOrders-helpers.php?rev=3168433#L20 "Show revision 3168433 of this file in browser") |  |
  | --- | --- | --- |
  | 20 | 20 | return $wpdb->charset; |
  | 21 | 21 | } |
  |  | 22 | public static function getEngineOfDbTable($table\_name) { |
  |  | 23 | global $wpdb; |
  |  | 24 | $result = $wpdb->get\_row("SHOW CREATE TABLE `{$wpdb->prefix}$table\_name`",'ARRAY\_A'); |
  |  | 25 | if (isset($result["Create Table"])){ |
  |  | 26 | preg\_match('/ENGINE=([^\s]+)/', $result['Create Table'], $matches); |
  |  | 27 | if (isset($matches[0])){ |
  |  | 28 | $matches = explode('=',$matches[0]); |
  |  | 29 | if (isset($matches[1])){ |
  |  | 30 | return $matches[1]; |
  |  | 31 | } |
  |  | 32 | } |
  |  | 33 | } |
  |  | 34 | return $wpdb->engine; |
  |  | 35 | } |
  | 22 | 36 | public static function getCharsetOfDbColumn($table\_name,$column\_name) { |
  | 23 | 37 | global $wpdb; |
  | […](/browser/clover-online-orders/trunk/includes/moo-OnlineOrders-helpers.php?rev=3142846#L32) | […](/browser/clover-online-orders/trunk/includes/moo-OnlineOrders-helpers.php?rev=3168433#L46) |  |
  | 32 | 46 | return $wpdb->collate; |
  | 33 | 47 | } |
  |  | 48 |  |
  |  | 49 | public static function upgradeDatabaseToVersion136($hideErrors = true) |
  |  | 50 | { |
  |  | 51 | global $wpdb; |
  |  | 52 | if($hideErrors){ |
  |  | 53 | $wpdb->hide\_errors(); |
  |  | 54 | } |
  |  | 55 | //Adding new fields in category table |
  |  | 56 | @$wpdb->query("ALTER TABLE `{$wpdb->prefix}moo\_category` ADD `image\_url` VARCHAR(255) NULL"); |
  |  | 57 | @$wpdb->query("ALTER TABLE `{$wpdb->prefix}moo\_category` ADD `alternate\_name` VARCHAR(100) NULL"); |
  |  | 58 | @$wpdb->query("ALTER TABLE `{$wpdb->prefix}moo\_modifier` ADD `sort\_order` INT NULL"); |
  |  | 59 | @$wpdb->query("ALTER TABLE `{$wpdb->prefix}moo\_modifier` ADD `show\_by\_default` INT NOT NULL DEFAULT '1'"); |
  |  | 60 | @$wpdb->query("ALTER TABLE `{$wpdb->prefix}moo\_modifier\_group` ADD `sort\_order` INT NULL"); |
  |  | 61 | @$wpdb->query("ALTER TABLE `{$wpdb->prefix}moo\_order\_types` ADD `type` INT(1) NULL"); |
  |  | 62 | @$wpdb->query("ALTER TABLE `{$wpdb->prefix}moo\_item` ADD `sort\_order` INT NULL"); |
  |  | 63 | @$wpdb->query("ALTER TABLE `{$wpdb->prefix}moo\_order\_types` ADD `sort\_order` INT NULL"); |
  |  | 64 | @$wpdb->query("CREATE TABLE IF NOT EXISTS `{$wpdb->prefix}moo\_item\_order` ( |
  |  | 65 | `\_id` INT NOT NULL AUTO\_INCREMENT, |
  |  | 66 | `item\_uuid` VARCHAR(100) NOT NULL, |
  |  | 67 | `order\_uuid` VARCHAR(100) NOT NULL, |
  |  | 68 | `quantity` VARCHAR(100) NOT NULL, |
  |  | 69 | `modifiers` TEXT NOT NULL, |
  |  | 70 | `special\_ins` VARCHAR(255) NOT NULL, |
  |  | 71 | PRIMARY KEY (`\_id`, `item\_uuid`, `order\_uuid`) |
  |  | 72 | );"); |
  |  | 73 | //add description to items |
  |  | 74 | @$wpdb->query("ALTER TABLE `{$wpdb->prefix}moo\_item` CHANGE `description` `description` TEXT "); |
  |  | 75 | @$wpdb->query("ALTER TABLE `{$wpdb->prefix}moo\_order\_types` ADD `minAmount` VARCHAR(100) NULL DEFAULT '0' "); |
  |  | 76 |  |
  |  | 77 | } |
  |  | 78 | public static function upgradeDatabaseToVersion150($hideErrors = true) |
  |  | 79 | { |
  |  | 80 | global $wpdb; |
  |  | 81 | if($hideErrors){ |
  |  | 82 | $wpdb->hide\_errors(); |
  |  | 83 | } |
  |  | 84 | @$wpdb->query("ALTER TABLE `{$wpdb->prefix}moo\_category` ADD `description` TEXT NULL"); |
  |  | 85 | @$wpdb->query("ALTER TABLE `{$wpdb->prefix}moo\_category` ADD `custom\_hours` VARCHAR(100) NULL"); |
  |  | 86 | @$wpdb->query("ALTER TABLE `{$wpdb->prefix}moo\_category` ADD `time\_availability` VARCHAR(10) NULL"); |
  |  | 87 | @$wpdb->query("ALTER TABLE `{$wpdb->prefix}moo\_item` CHANGE `description` `description` TEXT "); |
  |  | 88 | @$wpdb->query("ALTER TABLE `{$wpdb->prefix}moo\_order\_types` ADD `minAmount` VARCHAR(100) NULL DEFAULT '0' "); |
  |  | 89 | @$wpdb->query("ALTER TABLE `{$wpdb->prefix}moo\_order\_types` ADD `custom\_hours` VARCHAR(100) NULL"); |
  |  | 90 | @$wpdb->query("ALTER TABLE `{$wpdb->prefix}moo\_order\_types` ADD `time\_availability` VARCHAR(10) DEFAULT 1"); |
  |  | 91 | @$wpdb->query("ALTER TABLE `{$wpdb->prefix}moo\_order\_types` ADD `use\_coupons` INT(1) NULL DEFAULT 1"); |
  |  | 92 | @$wpdb->query("ALTER TABLE `{$wpdb->prefix}moo\_order\_types` ADD `custom\_message` VARCHAR(255) NULL DEFAULT 'Not available yet'"); |
  |  | 93 | @$wpdb->query("ALTER TABLE `{$wpdb->prefix}moo\_order\_types` ADD `allow\_service\_fee` INT(1) NULL DEFAULT 1"); |
  |  | 94 | @$wpdb->query("ALTER TABLE `{$wpdb->prefix}moo\_order\_types` ADD `allow\_sc\_order` INT(1) NULL DEFAULT 1 "); |
  |  | 95 | @$wpdb->query("ALTER TABLE `{$wpdb->prefix}moo\_order\_types` ADD `maxAmount` VARCHAR(100) NULL DEFAULT '' "); |
  |  | 96 | @$wpdb->query("ALTER TABLE `{$wpdb->prefix}moo\_item` ADD `category\_uuid` VARCHAR(45) NULL"); |
  |  | 97 | @$wpdb->query("ALTER TABLE `{$wpdb->prefix}moo\_item` ADD `custom\_hours` VARCHAR(45) NULL"); |
  |  | 98 | @$wpdb->query("ALTER TABLE `{$wpdb->prefix}moo\_item` ADD `soo\_name` VARCHAR(255) NULL"); |
  |  | 99 | @$wpdb->query("ALTER TABLE `{$wpdb->prefix}moo\_item` ADD `available` INT(1) NULL DEFAULT 1"); |
  |  | 100 | } |
  |  | 101 | public static function upgradeDatabaseToVersion158($hideErrors = true) |
  |  | 102 | { |
  |  | 103 | global $wpdb; |
  |  | 104 | if($hideErrors){ |
  |  | 105 | $wpdb->hide\_errors(); |
  |  | 106 | } |
  |  | 107 | // Get current charset |
  |  | 108 | $itemTableCharset = self::getCharsetOfDbTable("moo\_item"); |
  |  | 109 | $itemTableEngine = self::getEngineOfDbTable("moo\_item"); |
  |  | 110 | $itemUuidColumnCollate = self::getCharsetOfDbColumn("moo\_item","uuid"); |
  |  | 111 |  |
  |  | 112 |  |
  |  | 113 | @$wpdb->query("ALTER TABLE `{$wpdb->prefix}moo\_item` ADD `featured` INT(1) NULL DEFAULT 0"); |
  |  | 114 | @$wpdb->query("ALTER TABLE `{$wpdb->prefix}moo\_modifier` ADD `is\_pre\_selected` INT(1) NULL DEFAULT 0"); |
  |  | 115 | // Add new fields to tax rate |
  |  | 116 | @$wpdb->query("ALTER TABLE `{$wpdb->prefix}moo\_tax\_rate` ADD `taxAmount` INT NULL"); |
  |  | 117 | @$wpdb->query("ALTER TABLE `{$wpdb->prefix}moo\_tax\_rate` ADD `taxType` VARCHAR(100) NULL"); |
  |  | 118 |  |
  |  | 119 | //Add a flag to the category table |
  |  | 120 | @$wpdb->query("ALTER TABLE `{$wpdb->prefix}moo\_category` ADD `items\_imported` INT(1) NOT NULL DEFAULT 0"); |
  |  | 121 |  |
  |  | 122 |  |
  |  | 123 | //Create a new table for items\_categories (many to many) |
  |  | 124 | $res = @$wpdb->query("CREATE TABLE IF NOT EXISTS `{$wpdb->prefix}moo\_items\_categories` ( |
  |  | 125 | `item\_uuid` VARCHAR(45) NOT NULL, |
  |  | 126 | `category\_uuid` VARCHAR(100) NOT NULL, |
  |  | 127 | `sort\_order` INT NULL, |
  |  | 128 | PRIMARY KEY (`item\_uuid`, `category\_uuid`), |
  |  | 129 | INDEX `idx\_item\_has\_categories` (`item\_uuid` ASC) , |
  |  | 130 | INDEX `idx\_category\_has\_items` (`category\_uuid` ASC)  , |
  |  | 131 | CONSTRAINT `{$wpdb->prefix}fk\_item\_has\_categories` |
  |  | 132 | FOREIGN KEY (`item\_uuid`) |
  |  | 133 | REFERENCES `{$wpdb->prefix}moo\_item` (`uuid`) |
  |  | 134 | ON DELETE CASCADE |
  |  | 135 | ON UPDATE CASCADE, |
  |  | 136 | CONSTRAINT `{$wpdb->prefix}fk\_category\_has\_items` |
  |  | 137 | FOREIGN KEY (`category\_uuid`) |
  |  | 138 | REFERENCES `{$wpdb->prefix}moo\_category` (`uuid`) |
  |  | 139 | ON DELETE CASCADE |
  |  | 140 | ON UPDATE CASCADE, |
  |  | 141 | UNIQUE(`item\_uuid`,`category\_uuid`)) ENGINE=$itemTableEngine DEFAULT CHARACTER SET $itemTableCharset COLLATE $itemUuidColumnCollate" |
  |  | 142 | ); |
  |  | 143 | //Remove CONSTRAINT if table not created |
  |  | 144 | if (!$res) { |
  |  | 145 | @$wpdb->query("CREATE TABLE IF NOT EXISTS `{$wpdb->prefix}moo\_items\_categories` ( |
  |  | 146 | `item\_uuid` VARCHAR(45) NOT NULL, |
  |  | 147 | `category\_uuid` VARCHAR(100) NOT NULL, |
  |  | 148 | `sort\_order` INT NULL, |
  |  | 149 | PRIMARY KEY (`item\_uuid`, `category\_uuid`), |
  |  | 150 | INDEX `idx\_item\_has\_categories` (`item\_uuid` ASC) , |
  |  | 151 | INDEX `idx\_category\_has\_items` (`category\_uuid` ASC)  , |
  |  | 152 | UNIQUE(`item\_uuid`,`category\_uuid`) |
  |  | 153 | ) ENGINE=$itemTableEngine DEFAULT CHARACTER SET $itemTableCharset COLLATE $itemUuidColumnCollate" |
  |  | 154 | ); |
  |  | 155 | } |
  |  | 156 | } |
  |  | 157 | public static function getDefaultOptions() { |
  |  | 158 | return array( |
  |  | 159 | array("name"=>"api\_key","value"=>""), |
  |  | 160 | array("name"=>"store\_page","value"=>""), |
  |  | 161 | array("name"=>"checkout\_page","value"=>""), |
  |  | 162 | array("name"=>"cart\_page","value"=>""), |
  |  | 163 | array("name"=>"lat","value"=>""), |
  |  | 164 | array("name"=>"lng","value"=>""), |
  |  | 165 | array("name"=>"hours","value"=>"all"), |
  |  | 166 | array("name"=>"closing\_msg","value"=>""), |
  |  | 167 | array("name"=>"merchant\_email","value"=>""), |
  |  | 168 | array("name"=>"thanks\_page","value"=>""), |
  |  | 169 | array("name"=>"my\_account\_page","value"=>""), |
  |  | 170 | array("name"=>"fb\_appid","value"=>""), |
  |  | 171 | array("name"=>"use\_coupons","value"=>"disabled"), |
  |  | 172 | array("name"=>"use\_sms\_verification","value"=>"enabled"), |
  |  | 173 | array("name"=>"custom\_css","value"=>""), |
  |  | 174 | array("name"=>"custom\_js","value"=>""), |
  |  | 175 | array("name"=>"custom\_sa\_content","value"=>""), |
  |  | 176 | array("name"=>"custom\_sa\_title","value"=>""), |
  |  | 177 | array("name"=>"custom\_sa\_onCheckoutPage","value"=>"off"), |
  |  | 178 | array("name"=>"copyrights","value"=>'Powered by <a href="https://wordpress.org/plugins/clover-online-orders/" target="\_blank" title="Online Orders for Clover POS v 1.5.8">Smart Online Order</a>'), |
  |  | 179 | array("name"=>"default\_style","value"=>"onePage"), |
  |  | 180 | array("name"=>"track\_stock","value"=>""), |
  |  | 181 | array("name"=>"track\_stock\_hide\_items","value"=>"off"), |
  |  | 182 | array("name"=>"checkout\_login","value"=>"enabled"), |
  |  | 183 | array("name"=>"tips","value"=>"enabled"), |
  |  | 184 | array("name"=>"payment\_creditcard","value"=>"off"), |
  |  | 185 | array("name"=>"clover\_payment\_form","value"=>"on"), |
  |  | 186 | array("name"=>"clover\_googlepay","value"=>"on"), |
  |  | 187 | array("name"=>"clover\_applepay","value"=>"on"), |
  |  | 188 | array("name"=>"clover\_giftcards","value"=>"off"), |
  |  | 189 | array("name"=>"payment\_cash","value"=>"off"), |
  |  | 190 | array("name"=>"payment\_cash\_delivery","value"=>"off"), |
  |  | 191 | array("name"=>"scp","value"=>"off"), |
  |  | 192 | array("name"=>"merchant\_phone","value"=>""), |
  |  | 193 | array("name"=>"order\_later","value"=>"on"), |
  |  | 194 | array("name"=>"order\_later\_mandatory","value"=>"off"), |
  |  | 195 | array("name"=>"order\_later\_days","value"=>"4"), |
  |  | 196 | array("name"=>"order\_later\_minutes","value"=>"20"), |
  |  | 197 | array("name"=>"order\_later\_days\_delivery","value"=>"4"), |
  |  | 198 | array("name"=>"order\_later\_minutes\_delivery","value"=>"60"), |
  |  | 199 | array("name"=>"order\_later\_asap\_for\_p","value"=>"off"), |
  |  | 200 | array("name"=>"order\_later\_asap\_for\_d","value"=>"off"), |
  |  | 201 | array("name"=>"free\_delivery","value"=>""), |
  |  | 202 | array("name"=>"fixed\_delivery","value"=>""), |
  |  | 203 | array("name"=>"other\_zones\_delivery","value"=>""), |
  |  | 204 | array("name"=>"delivery\_fees\_name","value"=>"Delivery Charge"), |
  |  | 205 | array("name"=>"delivery\_errorMsg","value"=>"Sorry, zone not supported. We do not deliver to this address at this time"), |
  |  | 206 | array("name"=>"zones\_json","value"=>""), |
  |  | 207 | array("name"=>"hide\_menu","value"=>""), |
  |  | 208 | array("name"=>"hide\_menu\_w\_closed","value"=>"off"), |
  |  | 209 | array("name"=>"accept\_orders\_w\_closed","value"=>"on"), |
  |  | 210 | array("name"=>"show\_categories\_images","value"=>false), |
  |  | 211 | array("name"=>"save\_cards","value"=>"disabled"), |
  |  | 212 | array("name"=>"save\_cards\_fees","value"=>"disabled"), |
  |  | 213 | array("name"=>"service\_fees","value"=>"0.99"), |
  |  | 214 | array("name"=>"service\_fees\_name","value"=>"Service Charge"), |
  |  | 215 | array("name"=>"service\_fees\_type","value"=>"amount"), |
  |  | 216 | array("name"=>"use\_special\_instructions","value"=>"enabled"), |
  |  | 217 | array("name"=>"onePage\_fontFamily","value"=>"Oswald,sans-serif"), |
  |  | 218 | array("name"=>"onePage\_categoriesTopMargin","value"=>"0"), |
  |  | 219 | array("name"=>"onePage\_width","value"=>"1024"), |
  |  | 220 | array("name"=>"onePage\_categoriesFontColor","value"=>"#ffffff"), |
  |  | 221 | array("name"=>"onePage\_categoriesBackgroundColor","value"=>"#282b2e"), |
  |  | 222 | array("name"=>"onePage\_qtyWindow","value"=>"on"), |
  |  | 223 | array("name"=>"onePage\_qtyWindowForModifiers","value"=>"on"), |
  |  | 224 | array("name"=>"onePage\_backToTop","value"=>"off"), |
  |  | 225 | array("name"=>"onePage\_show\_more\_button","value"=>"on"), |
  |  | 226 | array("name"=>"jTheme\_width","value"=>"1024"), |
  |  | 227 | array("name"=>"jTheme\_qtyWindow","value"=>"on"), |
  |  | 228 | array("name"=>"jTheme\_qtyWindowForModifiers","value"=>"on"), |
  |  | 229 | array("name"=>"style1\_width","value"=>"1024"), |
  |  | 230 | array("name"=>"style2\_width","value"=>"1024"), |
  |  | 231 | array("name"=>"style3\_width","value"=>"1024"), |
  |  | 232 | array("name"=>"mg\_settings\_displayInline","value"=>"disabled"), |
  |  | 233 | array("name"=>"mg\_settings\_qty\_for\_all","value"=>"enabled"), |
  |  | 234 | array("name"=>"mg\_settings\_qty\_for\_zeroPrice","value"=>"disabled"), |
  |  | 235 | array("name"=>"text\_under\_special\_instructions","value"=>"\*additional charges may apply and not all changes are possible"), |
  |  | 236 | array("name"=>"special\_instructions\_required","value"=>"no"), |
  |  | 237 | array("name"=>"use\_couponsApp","value"=>"off"), |
  |  | 238 | array("name"=>"accept\_orders","value"=>"enabled"), |
  |  | 239 | array("name"=>"onePage\_askforspecialinstruction","value"=>"off"), |
  |  | 240 | array("name"=>"onePage\_messageforspecialinstruction","value"=>"Type your instructions here, additional charges may apply and not all changes are possible"), |
  |  | 241 | array("name"=>"jTheme\_askforspecialinstruction","value"=>"off"), |
  |  | 242 | array("name"=>"jTheme\_messageforspecialinstruction","value"=>"Type your instructions here, additional charges may apply and not all changes are possible"), |
  |  | 243 | array("name"=>"style2\_askforspecialinstruction","value"=>"off"), |
  |  | 244 | array("name"=>"style2\_messageforspecialinstruction","value"=>"Type your instructions here, additional charges may apply and not all changes are possible"), |
  |  | 245 | array("name"=>"useAlternateNames","value"=>"enabled"), |
  |  | 246 | array("name"=>"hide\_category\_ifnotavailable","value"=>"off"), |
  |  | 247 | array("name"=>"show\_order\_number","value"=>"off"), |
  |  | 248 | array("name"=>"mg\_settings\_minimized","value"=>"off"), |
  |  | 249 | array("name"=>"tips\_selection","value"=>"10,15,20,25"), |
  |  | 250 | array("name"=>"tips\_default","value"=>""), |
  |  | 251 | array("name"=>"rollout\_order\_number","value"=>"on"), |
  |  | 252 | array("name"=>"rollout\_order\_number\_max","value"=>"999"), |
  |  | 253 | array("name"=>"thanks\_page\_wp","value"=>""), |
  |  | 254 | array("name"=>"cdn\_for\_images","value"=>"off"), |
  |  | 255 | array("name"=>"cdn\_url","value"=>""), |
  |  | 256 | ); |
  |  | 257 | } |
  |  | 258 |  |
  |  | 259 | public static function applyDefaultOptions($currentOptions) { |
  |  | 260 | $defaultOptions = self::getDefaultOptions(); |
  |  | 261 | foreach ($defaultOptions as $default\_option) { |
  |  | 262 | if(!isset($currentOptions[$default\_option["name"]])) { |
  |  | 263 | $currentOptions[$default\_option["name"]]=$default\_option["value"]; |
  |  | 264 | } |
  |  | 265 | } |
  |  | 266 | update\_option('moo\_settings', $currentOptions ); |
  |  | 267 | } |
  | 34 | 268 | } |
* ## [clover-online-orders/trunk/includes/moo-OnlineOrders-sooapi.php](/changeset/3168433/clover-online-orders/trunk/includes/moo-OnlineOrders-sooapi.php "Show the changeset 3168433 restricted to clover-online-orders/trunk/includes/moo-OnlineOrders-sooapi.php")

  | [r3142846](/browser/clover-online-orders/trunk/includes/moo-OnlineOrders-sooapi.php?rev=3142846#L249 "Show revision 3142846 of this file in browser") | [r3168433](/browser/clover-online-orders/trunk/includes/moo-OnlineOrders-sooapi.php?rev=3168433#L249 "Show revision 3168433 of this file in browser") |  |
  | --- | --- | --- |
  | 249 | 249 | } |
  | 250 | 250 | //Functions to call the API for make Orders and payments |
  | 251 |  | ~~public function getPayKey() {~~ |
  | 252 |  | ~~return $this->callApi("paykey", $this->apiKey);~~ |
  | 253 |  | ~~}~~ |
  | 254 | 251 | public function getPakmsKey(){ |
  | 255 | 252 | //Get it locally when it's not found get it from Clover |
  | […](/browser/clover-online-orders/trunk/includes/moo-OnlineOrders-sooapi.php?rev=3142846#L346) | […](/browser/clover-online-orders/trunk/includes/moo-OnlineOrders-sooapi.php?rev=3168433#L343) |  |
  | 346 | 343 | $startTime = ($time["start"] != 0) ? substr\_replace(((strlen($time["start"]) == 4) ? $time["start"] : ((strlen($time["start"]) == 2) ? '00' . $time["start"] : '0' . $time["start"])), ':', 2, 0) : '00:00'; |
  | 347 | 344 | $endTime = ($time["end"] != 2400) ? substr\_replace(((strlen($time["end"]) == 4) ? $time["end"] : ((strlen($time["end"]) == 2) ? '00' . $time["end"] : '0' . $time["end"])), ':', 2, 0) : '24:00'; |
  | 348 |  | $string .= ~~date('h:i a', strtotime($startTime)) . ' to ' .~~ date('h:i a', strtotime($endTime)) . ' AND '; |
  | 349 |  | $result[ucfirst($days\_name)][] = ~~date('h:i a', strtotime($startTime)) . ' to ' .~~ date('h:i a', strtotime($endTime)); |
  |  | 345 | $string .= gmdate('h:i a', strtotime($startTime)) . ' to ' . gmdate('h:i a', strtotime($endTime)) . ' AND '; |
  |  | 346 | $result[ucfirst($days\_name)][] = gmdate('h:i a', strtotime($startTime)) . ' to ' . gmdate('h:i a', strtotime($endTime)); |
  | 350 | 347 | //$result[ucfirst($days\_name)] = substr($string, 0, -5); |
  | 351 | 348 | } |
  | […](/browser/clover-online-orders/trunk/includes/moo-OnlineOrders-sooapi.php?rev=3142846#L1510) | […](/browser/clover-online-orders/trunk/includes/moo-OnlineOrders-sooapi.php?rev=3168433#L1507) |  |
  | 1510 | 1507 |  |
  | 1511 | 1508 | if ($orderFromServer->order->date != "") { |
  | 1512 |  | $result['date\_order'] = date('m/d/Y', $orderFromServer->order->date / 1000); |
  |  | 1509 | $result['date\_order'] = gmdate('m/d/Y', $orderFromServer->order->date / 1000); |
  | 1513 | 1510 | } |
  | 1514 | 1511 | if ($orderFromServer->order->taxRemoved == "1") { |
  | […](/browser/clover-online-orders/trunk/includes/moo-OnlineOrders-sooapi.php?rev=3142846#L1946) | […](/browser/clover-online-orders/trunk/includes/moo-OnlineOrders-sooapi.php?rev=3168433#L1943) |  |
  | 1946 | 1943 |  |
  | 1947 | 1944 | private function callApi($url, $accesstoken) { |
  | 1948 |  |  |
  | 1949 |  | $headr = array(); |
  | 1950 |  | $headr[] = 'Accept: application/json'; |
  | 1951 |  | $headr[] = 'X-Authorization: ' . $accesstoken; |
  | 1952 |  | $url = $this->url\_api . $url; |
  | 1953 |  | //cURL starts |
  | 1954 |  | $crl = curl\_init(); |
  | 1955 |  | curl\_setopt($crl, CURLOPT\_URL, $url); |
  | 1956 |  | curl\_setopt($crl, CURLOPT\_HTTPHEADER, $headr); |
  | 1957 |  | curl\_setopt($crl, CURLOPT\_RETURNTRANSFER, true); |
  | 1958 |  | curl\_setopt($crl, CURLOPT\_HTTPGET, true); |
  | 1959 |  | curl\_setopt($crl, CURLOPT\_FOLLOWLOCATION, true); |
  | 1960 |  | curl\_setopt($crl, CURLOPT\_SSL\_VERIFYPEER, (get\_option('soo\_ssl\_verify','true') === 'true')); |
  | 1961 |  | //curl\_setopt($crl, CURLOPT\_TIMEOUT, 1); |
  | 1962 |  | $reply = curl\_exec($crl); |
  | 1963 |  | //error handling for cURL |
  | 1964 |  | if ($reply === false) { |
  | 1965 |  | if(curl\_error($crl) === 'SSL certificate problem: certificate has expired'){ |
  | 1966 |  | //Expired WordPress certificate |
  | 1967 |  | update\_option('soo\_ssl\_verify','false'); |
  | 1968 |  | } |
  | 1969 |  | if ($this->debugMode){ |
  | 1970 |  | print\_r('Curl error: ' . curl\_error($crl) . ' URL : '. $url); |
  | 1971 |  | } |
  | 1972 |  | return false; |
  | 1973 |  | } |
  | 1974 |  | $info = curl\_getinfo($crl); |
  | 1975 |  | curl\_close($crl); |
  | 1976 |  | if ($this->debugMode) { |
  | 1977 |  | echo "GET :: " . $url . " <<"; |
  | 1978 |  | echo ">> "; |
  | 1979 |  | } |
  | 1980 |  | if ($info['http\_code'] == 200) return $reply; |
  |  | 1945 | $args = array( |
  |  | 1946 | "headers"=> array( |
  |  | 1947 | 'X\_CLIENT\_IP' => $this->getClientIp(), |
  |  | 1948 | 'Accept' => "application/json", |
  |  | 1949 | 'X-Authorization' => $accesstoken |
  |  | 1950 | ), |
  |  | 1951 | ); |
  |  | 1952 | $endpoint = $this->url\_api . $url; |
  |  | 1953 | $response = $this->sendHttpRequest($endpoint,"GET",$args); |
  |  | 1954 | if($response && is\_array($response)) { |
  |  | 1955 | if($response["httpCode"] === 200 || $response["httpCode"] === 404 ){ |
  |  | 1956 | return $response["responseContent"]; |
  |  | 1957 | } |
  |  | 1958 | } |
  | 1981 | 1959 | return false; |
  | 1982 | 1960 | } |
* ## [clover-online-orders/trunk/includes/moo-OnlineOrders-widgets.php](/changeset/3168433/clover-online-orders/trunk/includes/moo-OnlineOrders-widgets.php "Show the changeset 3168433 restricted to clover-online-orders/trunk/includes/moo-OnlineOrders-widgets.php")

  | [r3142846](/browser/clover-online-orders/trunk/includes/moo-OnlineOrders-widgets.php?rev=3142846#L20 "Show revision 3142846 of this file in browser") | [r3168433](/browser/clover-online-orders/trunk/includes/moo-OnlineOrders-widgets.php?rev=3168433#L20 "Show revision 3168433 of this file in browser") |  |
  | --- | --- | --- |
  | 20 | 20 | $title = apply\_filters( 'widget\_title', $instance['title'] ); |
  | 21 | 21 | echo $args['before\_widget']; |
  | 22 |  | if ( ! empty( $title ) ) |
  |  | 22 | if ( ! empty( $title ) ) { |
  | 23 | 23 | echo $args['before\_title'] . $title . $args['after\_title']; |
  |  | 24 | } |
  | 24 | 25 | /\* -------- \*/ |
  | 25 | 26 | require\_once plugin\_dir\_path(dirname(\_\_FILE\_\_)) . "includes/moo-OnlineOrders-sooapi.php"; |
  | […](/browser/clover-online-orders/trunk/includes/moo-OnlineOrders-widgets.php?rev=3142846#L29) | […](/browser/clover-online-orders/trunk/includes/moo-OnlineOrders-widgets.php?rev=3168433#L30) |  |
  | 29 | 30 |  |
  | 30 | 31 | echo '<div style="padding-left:15px">'; |
  | 31 |  | if(@count($current\_hours)>0 && $current\_hours~~!=~~"Please setup you business hours on Clover") |
  |  | 32 | if(@count($current\_hours)>0 && $current\_hours != "Please setup you business hours on Clover") |
  | 32 | 33 | { |
  | 33 | 34 | foreach ($current\_hours as $key=>$value) { |
  | 34 |  | ~~$value = str\_replace('AND',"<br/>",$value);~~ |
  | 35 | 35 | echo '<strong><dt>'.$key.'</dt></strong>'; |
  | 36 |  | echo '<dd>'.$value.'</dd>'; |
  |  | 36 | if (is\_array($value)){ |
  |  | 37 | foreach ($value as $key1 => $value1) { |
  |  | 38 | echo '<dd>'.strtoupper($value1).'</dd>'; |
  |  | 39 | } |
  |  | 40 | } else { |
  |  | 41 | echo '<dd>'.strtoupper($value).'</dd>'; |
  |  | 42 | } |
  |  | 43 |  |
  | 37 | 44 | } |
  | 38 | 45 | } |
  | […](/browser/clover-online-orders/trunk/includes/moo-OnlineOrders-widgets.php?rev=3142846#L54) | […](/browser/clover-online-orders/trunk/includes/moo-OnlineOrders-widgets.php?rev=3168433#L61) |  |
  | 54 | 61 | ?> |
  | 55 | 62 | <p> |
  | 56 |  | <label for="<?php echo $this->get\_field\_id( 'title' ); ?>"><?php \_e( 'Title:' ); ?></label> |
  |  | 63 | <label for="<?php echo $this->get\_field\_id( 'title' ); ?>"><?php \_e( 'Title:',"moo\_OnlineOrders" ); ?></label> |
  | 57 | 64 | <input class="widefat" id="<?php echo $this->get\_field\_id( 'title' ); ?>" name="<?php echo $this->get\_field\_name( 'title' ); ?>" type="text" value="<?php echo esc\_attr( $title ); ?>" /> |
  | 58 | 65 | </p> |
  | […](/browser/clover-online-orders/trunk/includes/moo-OnlineOrders-widgets.php?rev=3142846#L121) | […](/browser/clover-online-orders/trunk/includes/moo-OnlineOrders-widgets.php?rev=3168433#L128) |  |
  | 121 | 128 | ?> |
  | 122 | 129 | <p> |
  | 123 |  | <label for="<?php echo $this->get\_field\_id( 'title' ); ?>"><?php \_e( 'Title:' ); ?></label> |
  |  | 130 | <label for="<?php echo $this->get\_field\_id( 'title' ); ?>"><?php \_e( 'Title:',"moo\_OnlineOrders" ); ?></label> |
  | 124 | 131 | <input class="widefat" id="<?php echo $this->get\_field\_id( 'title' ); ?>" name="<?php echo $this->get\_field\_name( 'title' ); ?>" type="text" value="<?php echo esc\_attr( $title ); ?>" /> |
  | 125 | 132 | </p> |
  | 126 | 133 |  |
  | 127 | 134 | <p> |
  | 128 |  | <label for="<?php echo $this->get\_field\_id( 'nb\_product' ); ?>"><?php \_e( 'Number of products:' ); ?></label> |
  |  | 135 | <label for="<?php echo $this->get\_field\_id( 'nb\_product' ); ?>"><?php \_e( 'Number of products:',"moo\_OnlineOrders" ); ?></label> |
  | 129 | 136 | <input class="widefat" id="<?php echo $this->get\_field\_id( 'nb\_product' ); ?>" name="<?php echo $this->get\_field\_name( 'nb\_product' ); ?>" type="number" value="<?php echo esc\_attr( $nb\_product ); ?>" /> |
  | 130 | 137 | </p> |
  | […](/browser/clover-online-orders/trunk/includes/moo-OnlineOrders-widgets.php?rev=3142846#L185) | […](/browser/clover-online-orders/trunk/includes/moo-OnlineOrders-widgets.php?rev=3168433#L192) |  |
  | 185 | 192 | ?> |
  | 186 | 193 | <p> |
  | 187 |  | <label for="<?php echo $this->get\_field\_id( 'title' ); ?>"><?php \_e( 'Title:' ); ?></label> |
  |  | 194 | <label for="<?php echo $this->get\_field\_id( 'title' ); ?>"><?php \_e( 'Title:',"moo\_OnlineOrders" ); ?></label> |
  | 188 | 195 | <input class="widefat" id="<?php echo $this->get\_field\_id( 'title' ); ?>" name="<?php echo $this->get\_field\_name( 'title' ); ?>" type="text" value="<?php echo esc\_attr( $title ); ?>" /> |
  | 189 | 196 | </p> |
* ## [clover-online-orders/trunk/includes/restapi/CheckoutRoutes.php](/changeset/3168433/clover-online-orders/trunk/includes/restapi/CheckoutRoutes.php "Show the changeset 3168433 restricted to clover-online-orders/trunk/includes/restapi/CheckoutRoutes.php")

  | [r3142846](/browser/clover-online-orders/trunk/includes/restapi/CheckoutRoutes.php?rev=3142846#L454 "Show revision 3142846 of this file in browser") | [r3168433](/browser/clover-online-orders/trunk/includes/restapi/CheckoutRoutes.php?rev=3168433#L454 "Show revision 3168433 of this file in browser") |  |
  | --- | --- | --- |
  | 454 | 454 | $googleReCAPTCHADisabled =  (bool) get\_option('sooDisableGoogleReCAPTCHA',false); |
  | 455 | 455 |  |
  | 456 |  | if (get\_option('moo\_~~new\_checkout\_enabled') !~~== 'yes'){ |
  |  | 456 | if (get\_option('moo\_old\_checkout\_enabled') === 'yes'){ |
  | 457 | 457 | $googleReCAPTCHADisabled = true; |
  | 458 | 458 | } |
  | 459 | 459 |  |
  | 460 | 460 | //Check Google recaptcha |
  | 461 |  | if (!$googleReCAPTCHADisabled && !empty($this->pluginSettings['reCAPTCHA\_site\_key']) && !empty($this->pluginSettings['reCAPTCHA\_secret\_key'])){ |
  |  | 461 | if (!$googleReCAPTCHADisabled && !empty($this->pluginSettings['reCAPTCHA\_site\_key']) && !empty($this->pluginSettings['reCAPTCHA\_secret\_key'])) { |
  | 462 | 462 | $reCaptchaErrorMessage = "Oops! It seems there was an issue with the reCAPTCHA. Don't worry, these things happen. Please try submitting the form again. We apologize for any inconvenience caused."; |
  | 463 | 463 | $args = array( |
  | […](/browser/clover-online-orders/trunk/includes/restapi/CheckoutRoutes.php?rev=3142846#L783) | […](/browser/clover-online-orders/trunk/includes/restapi/CheckoutRoutes.php?rev=3168433#L783) |  |
  | 783 | 783 | } |
  | 784 | 784 |  |
  | 785 |  |  |
  | 786 | 785 | //show Order number |
  | 787 | 786 | if(isset($this->pluginSettings["show\_order\_number"]) && $this->pluginSettings["show\_order\_number"] === "on") { |
* ## [clover-online-orders/trunk/includes/restapi/DashboardRoutes.php](/changeset/3168433/clover-online-orders/trunk/includes/restapi/DashboardRoutes.php "Show the changeset 3168433 restricted to clover-online-orders/trunk/includes/restapi/DashboardRoutes.php")

  | [r3142846](/browser/clover-online-orders/trunk/includes/restapi/DashboardRoutes.php?rev=3142846#L110 "Show revision 3142846 of this file in browser") | [r3168433](/browser/clover-online-orders/trunk/includes/restapi/DashboardRoutes.php?rev=3168433#L110 "Show revision 3168433 of this file in browser") |  |
  | --- | --- | --- |
  | 110 | 110 | )); |
  | 111 | 111 | // Enable the new Checkout |
  | 112 |  | register\_rest\_route($this->namespace, '/dash/enable-~~new~~-checkout', array( |
  |  | 112 | register\_rest\_route($this->namespace, '/dash/enable-old-checkout', array( |
  | 113 | 113 | // Here we register the readable endpoint for collections. |
  | 114 | 114 | array( |
  | 115 | 115 | 'methods' => 'POST', |
  | 116 |  | 'callback' => array($this, 'enable~~New~~Checkout'), |
  |  | 116 | 'callback' => array($this, 'enableOldCheckout'), |
  | 117 | 117 | 'permission\_callback' => array( $this, 'permissionCheck' ) |
  | 118 | 118 | ) |
  | […](/browser/clover-online-orders/trunk/includes/restapi/DashboardRoutes.php?rev=3142846#L532) | […](/browser/clover-online-orders/trunk/includes/restapi/DashboardRoutes.php?rev=3168433#L532) |  |
  | 532 | 532 | $wpdb->query("DELETE FROM `{$wpdb->prefix}moo\_item\_tax\_rate` ;"); |
  | 533 | 533 | // -- Table `modifier\_group` -- |
  | 534 |  | $wpdb->query("DELETE FROM `{$wpdb->prefix}moo\_item\_order` ;"); |
  |  | 534 | @$wpdb->query("DELETE FROM `{$wpdb->prefix}moo\_item\_order` ;"); |
  | 535 | 535 | //\*-- Table `item\_tag` -- |
  | 536 | 536 | $wpdb->query("DELETE FROM `{$wpdb->prefix}moo\_item\_tag` ;"); |
  | […](/browser/clover-online-orders/trunk/includes/restapi/DashboardRoutes.php?rev=3142846#L589) | […](/browser/clover-online-orders/trunk/includes/restapi/DashboardRoutes.php?rev=3168433#L589) |  |
  | 589 | 589 | } |
  | 590 | 590 | } |
  | 591 |  | function enable~~New~~Checkout( $request ) { |
  |  | 591 | function enableOldCheckout( $request ) { |
  | 592 | 592 |  |
  | 593 | 593 | if (empty( $request["status"] )) { |
  | […](/browser/clover-online-orders/trunk/includes/restapi/DashboardRoutes.php?rev=3142846#L596) | […](/browser/clover-online-orders/trunk/includes/restapi/DashboardRoutes.php?rev=3168433#L596) |  |
  | 596 | 596 | $status = rest\_sanitize\_boolean($request["status"]); |
  | 597 | 597 | if($status){ |
  | 598 |  | update\_option("moo\_~~new~~\_checkout\_enabled",'yes'); |
  | 599 |  | } else { |
  | 600 |  | update\_option("moo\_~~new~~\_checkout\_enabled",'no'); |
  |  | 598 | update\_option("moo\_old\_checkout\_enabled",'yes'); |
  |  | 599 | } else { |
  |  | 600 | update\_option("moo\_old\_checkout\_enabled",'no'); |
  | 601 | 601 | } |
  | 602 | 602 | //Save on Cloud |
  | 603 | 603 | try { |
  | 604 |  | $this->api->saveMerchantSettings("~~new~~\_checkout", $status); |
  |  | 604 | $this->api->saveMerchantSettings("old\_checkout", $status); |
  | 605 | 605 | } catch (Exception $e){ |
  | 606 | 606 | // Silence is golden |
  | […](/browser/clover-online-orders/trunk/includes/restapi/DashboardRoutes.php?rev=3142846#L1245) | […](/browser/clover-online-orders/trunk/includes/restapi/DashboardRoutes.php?rev=3168433#L1245) |  |
  | 1245 | 1245 | } |
  | 1246 | 1246 | } |
  | 1247 |  |  |
  | 1248 | 1247 | function dashImportCustomHours( $request ){ |
  | 1249 | 1248 | $files = $request->get\_file\_params(); |
  | […](/browser/clover-online-orders/trunk/includes/restapi/DashboardRoutes.php?rev=3142846#L1290) | […](/browser/clover-online-orders/trunk/includes/restapi/DashboardRoutes.php?rev=3168433#L1289) |  |
  | 1290 | 1289 | $upload\_dir = wp\_upload\_dir(); |
  | 1291 | 1290 | $permittedExtension = 'json'; |
  | 1292 |  | //Get Data from file or J~~son~~ Body |
  |  | 1291 | //Get Data from file or JSON Body |
  | 1293 | 1292 | $files = $request->get\_file\_params(); |
  | 1294 |  | if (~~!isset( $files['file'] ) || empty( $files['file'] )~~ ) { |
  |  | 1293 | if (empty( $files['file'] )) { |
  | 1295 | 1294 | $data = json\_decode($request->get\_body(),true); |
  | 1296 | 1295 | //Get Data from json |
  | 1297 | 1296 | if ( isset( $data["cloneImages"] ) ) { |
  | 1298 |  | $cloneImages = $data["cloneImages"]; |
  |  | 1297 | $cloneImages = $data["cloneImages"] !== 'false'; |
  | 1299 | 1298 | } else { |
  | 1300 | 1299 | $cloneImages = true; |
  | […](/browser/clover-online-orders/trunk/includes/restapi/DashboardRoutes.php?rev=3142846#L1302) | […](/browser/clover-online-orders/trunk/includes/restapi/DashboardRoutes.php?rev=3168433#L1301) |  |
  | 1302 | 1301 |  |
  | 1303 | 1302 | if ( isset( $data["skipWhenImageExist"] ) ) { |
  | 1304 |  | $skipWhenImageExist = $data["skipWhenImageExist"]; |
  |  | 1303 | $skipWhenImageExist = $data["skipWhenImageExist"] !== 'false'; |
  | 1305 | 1304 | } else { |
  | 1306 | 1305 | $skipWhenImageExist = false; |
  | […](/browser/clover-online-orders/trunk/includes/restapi/DashboardRoutes.php?rev=3142846#L1336) | […](/browser/clover-online-orders/trunk/includes/restapi/DashboardRoutes.php?rev=3168433#L1335) |  |
  | 1336 | 1335 | } |
  | 1337 | 1336 |  |
  | 1338 |  | if(isset($data["items"]) && is\_array($data["items"])){ |
  |  | 1337 | if(isset($data["items"]) && is\_array($data["items"])) { |
  | 1339 | 1338 | foreach ($data["items"] as $item) { |
  | 1340 | 1339 | if(isset($item["url"])){ |
  | 1341 |  | //get item uuid based on name and uuid |
  |  | 1340 | //get item uuid based on name and uuid |
  | 1342 | 1341 | $name = esc\_sql($item["name"]); |
  | 1343 | 1342 | $sql = "SELECT \* FROM `{$wpdb->prefix}moo\_item` |
  | […](/browser/clover-online-orders/trunk/includes/restapi/DashboardRoutes.php?rev=3142846#L1356) | […](/browser/clover-online-orders/trunk/includes/restapi/DashboardRoutes.php?rev=3168433#L1355) |  |
  | 1356 | 1355 |  |
  | 1357 | 1356 | if($cloneImages){ |
  | 1358 |  | try{ |
  |  | 1357 | try { |
  | 1359 | 1358 | $link = $this->uploadFileByUrl($item["url"]); |
  | 1360 | 1359 | if($link){ |
  | 1361 | 1360 | $link\_image = $link; |
  | 1362 |  | } else{ |
  |  | 1361 | } else { |
  | 1363 | 1362 | throw new Exception(); |
  | 1364 | 1363 | } |
  | […](/browser/clover-online-orders/trunk/includes/restapi/DashboardRoutes.php?rev=3142846#L1393) | […](/browser/clover-online-orders/trunk/includes/restapi/DashboardRoutes.php?rev=3168433#L1392) |  |
  | 1393 | 1392 | } |
  | 1394 | 1393 |  |
  | 1395 |  | if(isset($data["categories"]) && is\_array($data["categories"])){ |
  |  | 1394 | if(isset($data["categories"]) && is\_array($data["categories"])) { |
  | 1396 | 1395 | foreach ($data["categories"] as $category) { |
  | 1397 | 1396 | if(isset($category["uuid"]) || isset($category["name"])){ |
  | […](/browser/clover-online-orders/trunk/includes/restapi/DashboardRoutes.php?rev=3142846#L1463) | […](/browser/clover-online-orders/trunk/includes/restapi/DashboardRoutes.php?rev=3168433#L1462) |  |
  | 1463 | 1462 | "skipWhenImageExist"=>$skipWhenImageExist, |
  | 1464 | 1463 | "skippedItems"=>$skippedItems, |
  | 1465 |  | "skippedCatego~~e~~ries"=>$skippedCategories, |
  |  | 1464 | "skippedCategories"=>$skippedCategories, |
  | 1466 | 1465 | ], |
  | 1467 | 1466 | "errors"=>$errors |
  | […](/browser/clover-online-orders/trunk/includes/restapi/DashboardRoutes.php?rev=3142846#L1556) | […](/browser/clover-online-orders/trunk/includes/restapi/DashboardRoutes.php?rev=3168433#L1555) |  |
  | 1556 | 1555 | } |
  | 1557 | 1556 |  |
  | 1558 |  | private function uploadFileByUrl( $image\_url ) { |
  | 1559 |  |  |
  | 1560 |  | // it allows us to use download\_url() and wp\_handle\_sideload() functions |
  | 1561 |  | require\_once( ABSPATH . 'wp-admin/includes/file.php' ); |
  |  | 1557 | /\*\* |
  |  | 1558 | \* @throws Exception |
  |  | 1559 | \*/ |
  |  | 1560 | private function uploadFileByUrl($image\_url ) { |
  |  | 1561 |  |
  |  | 1562 | // If the function it's not available, require it. |
  |  | 1563 | if ( ! function\_exists( 'download\_url' ) ) { |
  |  | 1564 | // it allows us to use download\_url() and wp\_handle\_sideload() functions |
  |  | 1565 | require\_once ABSPATH . '/wp-admin/includes/file.php'; |
  |  | 1566 | } |
  | 1562 | 1567 |  |
  | 1563 | 1568 | // download to temp dir |
  | […](/browser/clover-online-orders/trunk/includes/restapi/DashboardRoutes.php?rev=3142846#L1568) | […](/browser/clover-online-orders/trunk/includes/restapi/DashboardRoutes.php?rev=3168433#L1573) |  |
  | 1568 | 1573 | } |
  | 1569 | 1574 | $filetype = wp\_check\_filetype( $temp\_file ); |
  |  | 1575 |  |
  | 1570 | 1576 |  |
  | 1571 | 1577 | // move the temp file into the uploads directory |
  | […](/browser/clover-online-orders/trunk/includes/restapi/DashboardRoutes.php?rev=3142846#L1585) | […](/browser/clover-online-orders/trunk/includes/restapi/DashboardRoutes.php?rev=3168433#L1591) |  |
  | 1585 | 1591 |  |
  | 1586 | 1592 | if( ! empty( $sideload[ 'error' ] ) ) { |
  | 1587 |  | // you may return error message if you want |
  |  | 1593 | // you may return an error message if you want |
  | 1588 | 1594 | throw new Exception($sideload[ 'error' ]); |
  | 1589 | 1595 | } |
  | […](/browser/clover-online-orders/trunk/includes/restapi/DashboardRoutes.php?rev=3142846#L1605) | […](/browser/clover-online-orders/trunk/includes/restapi/DashboardRoutes.php?rev=3168433#L1611) |  |
  | 1605 | 1611 | } |
  | 1606 | 1612 |  |
  | 1607 |  | // update me~~dat~~ata, regenerate image sizes |
  |  | 1613 | // update metadata, regenerate image sizes |
  | 1608 | 1614 | require\_once( ABSPATH . 'wp-admin/includes/image.php' ); |
  | 1609 | 1615 |  |
  | […](/browser/clover-online-orders/trunk/includes/restapi/DashboardRoutes.php?rev=3142846#L1613) | […](/browser/clover-online-orders/trunk/includes/restapi/DashboardRoutes.php?rev=3168433#L1619) |  |
  | 1613 | 1619 | ); |
  | 1614 | 1620 |  |
  |  | 1621 | @unlink( $temp\_file ); |
  |  | 1622 |  |
  | 1615 | 1623 | return $sideload[ 'url' ]; |
  | 1616 | 1624 |  |
* ## [clover-online-orders/trunk/includes/shortcodes/addToCartButton.php](/changeset/3168433/clover-online-orders/trunk/includes/shortcodes/addToCartButton.php "Show the changeset 3168433 restricted to clover-online-orders/trunk/includes/shortcodes/addToCartButton.php")

  | [r3142846](/browser/clover-online-orders/trunk/includes/shortcodes/addToCartButton.php?rev=3142846#L48 "Show revision 3142846 of this file in browser") | [r3168433](/browser/clover-online-orders/trunk/includes/shortcodes/addToCartButton.php?rev=3168433#L48 "Show revision 3168433 of this file in browser") |  |
  | --- | --- | --- |
  | 48 | 48 | private function enqueueStylesAndScripts() |
  | 49 | 49 | { |
  | 50 |  |  |
  | 51 | 50 | $this->enqueueCssGrid(); |
  | 52 | 51 |  |
* ## [clover-online-orders/trunk/includes/shortcodes/checkoutPage.php](/changeset/3168433/clover-online-orders/trunk/includes/shortcodes/checkoutPage.php "Show the changeset 3168433 restricted to clover-online-orders/trunk/includes/shortcodes/checkoutPage.php")

  | [r3142846](/browser/clover-online-orders/trunk/includes/shortcodes/checkoutPage.php?rev=3142846#L446 "Show revision 3142846 of this file in browser") | [r3168433](/browser/clover-online-orders/trunk/includes/shortcodes/checkoutPage.php?rev=3168433#L446 "Show revision 3168433 of this file in browser") |  |
  | --- | --- | --- |
  | 446 | 446 | <?php |
  | 447 | 447 | /\* translators: %s represent our tos link \*/ |
  | 448 |  | printf(\_\_('By clicking the button below you agree to our <a href="%s" target="\_blank">Terms Of Service</a>', 'moo\_OnlineOrders'), "https://www.zaytech.com/zaytech-eula"); |
  |  | 448 | printf(\_\_('By clicking the button below, you agree to our <a href="%s" target="\_blank">Terms Of Service</a>', 'moo\_OnlineOrders'), "https://www.zaytech.com/zaytech-eula"); |
  | 449 | 449 | ?> |
  | 450 | 450 | </p> |
  | […](/browser/clover-online-orders/trunk/includes/shortcodes/checkoutPage.php?rev=3142846#L554) | […](/browser/clover-online-orders/trunk/includes/shortcodes/checkoutPage.php?rev=3168433#L554) |  |
  | 554 | 554 | <?php \_e("contact", "moo\_OnlineOrders"); ?> |
  | 555 | 555 | <span class="moo-checkout-edit-icon" onclick="moo\_checkout\_edit\_contact()"> |
  | 556 |  | <img src="<?php echo  ~~plugin\_dir\_url(dirname(\_\_FILE\_\_))."..~~/public/img/edit-pen.png"?>" alt="edit"> |
  |  | 556 | <img src="<?php echo  SOO\_PLUGIN\_PATH."/public/img/edit-pen.png"?>" alt="edit"> |
  | 557 | 557 | </span> |
  | 558 | 558 | </div> |
  | […](/browser/clover-online-orders/trunk/includes/shortcodes/checkoutPage.php?rev=3142846#L594) | […](/browser/clover-online-orders/trunk/includes/shortcodes/checkoutPage.php?rev=3168433#L594) |  |
  | 594 | 594 | echo '<div class="moo-checkout-form-ordertypes-option">'; |
  | 595 | 595 | if (isset($ot->available) && $ot->available === false) { |
  | 596 |  | echo '<input class="moo-checkout-form-ordertypes-input" type="radio" name="ordertype" value="'.~~$ot->ot\_uuid.'" id="moo-checkout-form-ordertypes-'.$ot->ot\_uuid~~.'" disabled>'; |
  | 597 |  | echo '<label for="moo-checkout-form-ordertypes-'.~~$ot->ot\_uuid.'" style="display: inline;margin-left:15px;font-size: 16px; vertical-align: sub;">'.stripslashes((string)$ot->label).' ( '.stripslashes((string)$ot->custom\_message~~).' )</label></div>'; |
  |  | 596 | echo '<input class="moo-checkout-form-ordertypes-input" type="radio" name="ordertype" value="'.esc\_attr($ot->ot\_uuid).'" id="moo-checkout-form-ordertypes-'.esc\_attr($ot->ot\_uuid).'" disabled>'; |
  |  | 597 | echo '<label for="moo-checkout-form-ordertypes-'.esc\_attr($ot->ot\_uuid).'" style="display: inline;margin-left:15px;font-size: 16px; vertical-align: sub;">'.wp\_kses\_post(wp\_unslash($ot->label)).' ( '.wp\_kses\_post(wp\_unslash($ot->custom\_message)).' )</label></div>'; |
  | 598 | 598 | } else { |
  | 599 |  | echo '<input class="moo-checkout-form-ordertypes-input" type="radio" name="ordertype" value="'.~~$ot->ot\_uuid.'" id="moo-checkout-form-ordertypes-'.$ot->ot\_uuid~~.'">'; |
  | 600 |  | echo '<label for="moo-checkout-form-ordertypes-'.~~$ot->ot\_uuid.'" style="display: inline;margin-left:15px;font-size: 16px; vertical-align: sub;">'.stripslashes((string)$ot->label~~).'</label></div>'; |
  |  | 599 | echo '<input class="moo-checkout-form-ordertypes-input" type="radio" name="ordertype" value="'.esc\_attr($ot->ot\_uuid).'" id="moo-checkout-form-ordertypes-'.esc\_attr($ot->ot\_uuid).'">'; |
  |  | 600 | echo '<label for="moo-checkout-form-ordertypes-'.esc\_attr($ot->ot\_uuid).'" style="display: inline;margin-left:15px;font-size: 16px; vertical-align: sub;">'.wp\_kses\_post(wp\_unslash($ot->label)).'</label></div>'; |
  | 601 | 601 | } |
  | 602 | 602 | } |
  | […](/browser/clover-online-orders/trunk/includes/shortcodes/checkoutPage.php?rev=3142846#L622) | […](/browser/clover-online-orders/trunk/includes/shortcodes/checkoutPage.php?rev=3168433#L622) |  |
  | 622 | 622 | <?php |
  | 623 | 623 | foreach ($oppening\_status["pickup\_time"] as $key => $val) { |
  | 624 |  | echo '<option value="'.~~$key.'">'.$key~~.'</option>'; |
  |  | 624 | echo '<option value="'.esc\_attr($key).'">'.esc\_attr($key).'</option>'; |
  | 625 | 625 | } |
  | 626 | 626 | ?> |
  | […](/browser/clover-online-orders/trunk/includes/shortcodes/checkoutPage.php?rev=3142846#L635) | […](/browser/clover-online-orders/trunk/includes/shortcodes/checkoutPage.php?rev=3168433#L635) |  |
  | 635 | 635 | foreach ($oppening\_status["pickup\_time"] as $val) { |
  | 636 | 636 | foreach ($val as $h) { |
  | 637 |  | echo '<option value="'.~~$h.'">'.$h~~.'</option>'; |
  |  | 637 | echo '<option value="'.esc\_attr($h).'">'.esc\_attr($h).'</option>'; |
  | 638 | 638 | } |
  | 639 | 639 | break; |
  | […](/browser/clover-online-orders/trunk/includes/shortcodes/checkoutPage.php?rev=3142846#L672) | […](/browser/clover-online-orders/trunk/includes/shortcodes/checkoutPage.php?rev=3168433#L672) |  |
  | 672 | 672 | <div id="moo\_cashPanel"> |
  | 673 | 673 | <div class="moo-row"  id="moo\_verifPhone\_verified"> |
  | 674 |  | <img src="<?php echo  ~~plugin\_dir\_url(dirname(\_\_FILE\_\_))."..~~/public/img/check.png"?>" width="60px" style="display: inline-block;" alt=""> |
  |  | 674 | <img src="<?php echo  SOO\_PLUGIN\_URL ."/public/img/check.png"?>" width="60px" style="display: inline-block;" alt=""> |
  | 675 | 675 | <p> |
  | 676 | 676 | <?php \_e("Your phone number has been verified", "moo\_OnlineOrders"); ?> |
  | […](/browser/clover-online-orders/trunk/includes/shortcodes/checkoutPage.php?rev=3142846#L772) | […](/browser/clover-online-orders/trunk/includes/shortcodes/checkoutPage.php?rev=3168433#L772) |  |
  | 772 | 772 | <div class="moo-col-md-8"> |
  | 773 | 773 | <div class="moo-form-group"> |
  | 774 |  | <p style="font-size: 20px" id="moo\_remove\_coupon\_code"><?php if ($coupon != null) { |
  | 775 |  | echo $coupon['code']; |
  | 776 |  | }?></p> |
  |  | 774 | <p style="font-size: 20px" id="moo\_remove\_coupon\_code"> |
  |  | 775 | <?php |
  |  | 776 | if ($coupon != null) { |
  |  | 777 | echo sanitize\_text\_field($coupon['code']); |
  |  | 778 | } |
  |  | 779 | ?></p> |
  | 777 | 780 | </div> |
  | 778 | 781 | </div> |
  | […](/browser/clover-online-orders/trunk/includes/shortcodes/checkoutPage.php?rev=3142846#L799) | […](/browser/clover-online-orders/trunk/includes/shortcodes/checkoutPage.php?rev=3168433#L802) |  |
  | 799 | 802 | $modifiers\_price = 0; |
  | 800 | 803 | if (isset($line['item']->soo\_name) && !empty($line['item']->soo\_name)) { |
  | 801 |  | $item\_name=~~stripslashes~~((string)$line['item']->soo\_name); |
  |  | 804 | $item\_name=wp\_unslash((string)$line['item']->soo\_name); |
  | 802 | 805 | } else { |
  | 803 | 806 | if ($this->useAlternateNames && isset($line['item']->alternate\_name) && $line['item']->alternate\_name!=="") { |
  | 804 |  | $item\_name=~~stripslashes~~((string)$line['item']->alternate\_name); |
  |  | 807 | $item\_name=wp\_unslash((string)$line['item']->alternate\_name); |
  | 805 | 808 | } else { |
  | 806 |  | $item\_name=~~stripslashes~~((string)$line['item']->name); |
  |  | 809 | $item\_name=wp\_unslash((string)$line['item']->name); |
  | 807 | 810 | } |
  | 808 | 811 | } |
  | 809 | 812 |  |
  | 810 | 813 | ?> |
  | 811 |  | <div class="moo-product" tabindex="0" aria-label="<?php echo ~~$line['quantity']~~." of ".$line['item']->name."" ?>"> |
  |  | 814 | <div class="moo-product" tabindex="0" aria-label="<?php echo sanitize\_text\_field($line['quantity'])." of ".$line['item']->name."" ?>"> |
  | 812 | 815 | <div class="moo-product-quantity" style="width: 20%"> |
  | 813 |  | <strong><?php echo ~~$line['quantity']~~?></strong> |
  |  | 816 | <strong><?php echo sanitize\_text\_field($line['quantity']); ?></strong> |
  | 814 | 817 | </div> |
  | 815 | 818 | <div class="moo-product-details moo-product-details-checkout" style="width: 60%"> |
  | […](/browser/clover-online-orders/trunk/includes/shortcodes/checkoutPage.php?rev=3142846#L820) | […](/browser/clover-online-orders/trunk/includes/shortcodes/checkoutPage.php?rev=3168433#L823) |  |
  | 820 | 823 | $modifier\_name = ""; |
  | 821 | 824 | if ($this->useAlternateNames && isset($modifier["alternate\_name"]) && $modifier["alternate\_name"]!=="") { |
  | 822 |  | $modifier\_name =~~stripslashes~~((string)$modifier["alternate\_name"]); |
  |  | 825 | $modifier\_name =wp\_unslash((string)$modifier["alternate\_name"]); |
  | 823 | 826 | } else { |
  | 824 |  | $modifier\_name =~~stripslashes~~((string)$modifier["name"]); |
  |  | 827 | $modifier\_name =wp\_unslash((string)$modifier["name"]); |
  | 825 | 828 | } |
  | 826 | 829 | if (isset($modifier['qty']) && intval($modifier['qty'])>0) { |
  | […](/browser/clover-online-orders/trunk/includes/shortcodes/checkoutPage.php?rev=3142846#L839) | […](/browser/clover-online-orders/trunk/includes/shortcodes/checkoutPage.php?rev=3168433#L842) |  |
  | 839 | 842 | } |
  | 840 | 843 | if ($line['special\_ins'] != "") { |
  | 841 |  | echo '<span tabindex="0" aria-label="your special instructions">SI:<span><span tabindex="0"> '.~~$line['special\_ins']~~."<span>"; |
  |  | 844 | echo '<span tabindex="0" aria-label="your special instructions">SI:<span><span tabindex="0"> '.sanitize\_text\_field($line['special\_ins'])."<span>"; |
  | 842 | 845 | } |
  | 843 | 846 | ?> |
  | […](/browser/clover-online-orders/trunk/includes/shortcodes/checkoutPage.php?rev=3142846#L1648) | […](/browser/clover-online-orders/trunk/includes/shortcodes/checkoutPage.php?rev=3168433#L1651) |  |
  | 1648 | 1651 | echo '<div class="soo-checkout-radio-input-option">'; |
  | 1649 | 1652 | if (isset($ot['available']) && $ot['available'] === false) { |
  | 1650 |  | echo '<input class="soo-checkout-radio-input" type="radio" name="ordertype" value="'.~~$ot['ot\_uuid'].'" id="moo-checkout-form-ordertypes-'.$ot['ot\_uuid']~~.'" disabled>'; |
  | 1651 |  | echo '<label for="moo-checkout-form-ordertypes-'.~~$ot['ot\_uuid'].'" class="moo-checkout-radio-input-label">'.stripslashes((string)$ot['label']).' ( '.stripslashes((string)$ot['custom\_message']~~).' )</label></div>'; |
  |  | 1653 | echo '<input class="soo-checkout-radio-input" type="radio" name="ordertype" value="'.esc\_attr($ot['ot\_uuid']).'" id="moo-checkout-form-ordertypes-'.esc\_attr($ot['ot\_uuid']).'" disabled>'; |
  |  | 1654 | echo '<label for="moo-checkout-form-ordertypes-'.esc\_attr($ot['ot\_uuid']).'" class="moo-checkout-radio-input-label">'.wp\_kses\_post(wp\_unslash($ot['label'])).' ( '.wp\_kses\_post(wp\_unslash($ot['custom\_message'])).' )</label></div>'; |
  | 1652 | 1655 | } else { |
  | 1653 |  | echo '<input onchange="mooCheckout.orderTypeChanged()" class="soo-checkout-radio-input" type="radio" name="ordertype" value="'.~~$ot['ot\_uuid'].'" id="moo-checkout-form-ordertypes-'.$ot['ot\_uuid']~~.'">'; |
  | 1654 |  | echo '<label for="moo-checkout-form-ordertypes-'.~~$ot['ot\_uuid'].'" class="moo-checkout-radio-input-label">'.stripslashes((string)$ot['label']~~).'</label></div>'; |
  |  | 1656 | echo '<input onchange="mooCheckout.orderTypeChanged()" class="soo-checkout-radio-input" type="radio" name="ordertype" value="'.esc\_attr($ot['ot\_uuid']).'" id="moo-checkout-form-ordertypes-'.esc\_attr($ot['ot\_uuid']).'">'; |
  |  | 1657 | echo '<label for="moo-checkout-form-ordertypes-'.esc\_attr($ot['ot\_uuid']).'" class="moo-checkout-radio-input-label">'.wp\_kses\_post(wp\_unslash($ot['label'])).'</label></div>'; |
  | 1655 | 1658 | } |
  | 1656 | 1659 | } |
  | […](/browser/clover-online-orders/trunk/includes/shortcodes/checkoutPage.php?rev=3142846#L1998) | […](/browser/clover-online-orders/trunk/includes/shortcodes/checkoutPage.php?rev=3168433#L2001) |  |
  | 1998 | 2001 | public function render($atts, $content) |
  | 1999 | 2002 | { |
  | 2000 |  | if (get\_option('moo\_~~new~~\_checkout\_enabled') === 'yes') { |
  | 2001 |  | return $this->~~advance~~dCheckout($atts, $content); |
  | 2002 |  | } |
  | 2003 |  | return $this->~~standar~~dCheckout($atts, $content); |
  |  | 2003 | if (get\_option('moo\_old\_checkout\_enabled') === 'yes') { |
  |  | 2004 | return $this->standardCheckout($atts, $content); |
  |  | 2005 | } |
  |  | 2006 | return $this->advancedCheckout($atts, $content); |
  | 2004 | 2007 | } |
  | 2005 | 2008 |  |
  | […](/browser/clover-online-orders/trunk/includes/shortcodes/checkoutPage.php?rev=3142846#L2013) | […](/browser/clover-online-orders/trunk/includes/shortcodes/checkoutPage.php?rev=3168433#L2016) |  |
  | 2013 | 2016 | $defaultText = \_\_("Click Here", "moo\_OnlineOrders"); |
  | 2014 | 2017 | $defaultTitle = \_\_("Click Here", "moo\_OnlineOrders"); |
  | 2015 |  | $linkText = (~~isset($atts['text']) && !empty($atts['text'])) ? sanitize\_text\_field~~($atts['text']) : $defaultText; |
  | 2016 |  | $linkTitle = (~~isset($atts['title']) && !empty($atts['title'])) ? sanitize\_text\_field~~($atts['title']) : $defaultTitle; |
  | 2017 |  | $orderId = (~~isset($\_GET['order\_id']) && !empty($\_GET['order\_id'])) ? sanitize\_text\_field~~($\_GET['order\_id']) : null; |
  |  | 2018 | $linkText = (!empty($atts['text'])) ? esc\_attr($atts['text']) : $defaultText; |
  |  | 2019 | $linkTitle = (!empty($atts['title'])) ? esc\_attr($atts['title']) : $defaultTitle; |
  |  | 2020 | $orderId = (!empty($\_GET['order\_id'])) ? esc\_attr($\_GET['order\_id']) : null; |
  | 2018 | 2021 | if ($orderId) { |
  | 2019 | 2022 | if (defined('SOO\_ENV') && SOO\_ENV === 'DEV') { |
  | […](/browser/clover-online-orders/trunk/includes/shortcodes/checkoutPage.php?rev=3142846#L2335) | […](/browser/clover-online-orders/trunk/includes/shortcodes/checkoutPage.php?rev=3168433#L2338) |  |
  | 2335 | 2338 | $use = \_\_("Use ", "moo\_OnlineOrders"). $label; |
  | 2336 | 2339 | $dontUse = \_\_("Remove ", "moo\_OnlineOrders"). $label; |
  | 2337 |  | $imgLink = ~~plugin\_dir\_url(dirname(\_\_FILE\_\_))."..~~/public/img/loyaltyIcon.svg"; |
  |  | 2340 | $imgLink = SOO\_PLUGIN\_URL . "/public/img/loyaltyIcon.svg"; |
  | 2338 | 2341 | $html = <<<HTML |
  | 2339 | 2342 | <div id="moo-checkout-form-loyalty"> |
  | […](/browser/clover-online-orders/trunk/includes/shortcodes/checkoutPage.php?rev=3142846#L2616) | […](/browser/clover-online-orders/trunk/includes/shortcodes/checkoutPage.php?rev=3168433#L2619) |  |
  | 2616 | 2619 | $html .= '<div class="moo-checkout-bloc-content">'; |
  | 2617 | 2620 | if (isset($this->pluginSettings['text\_under\_special\_instructions']) && $this->pluginSettings['text\_under\_special\_instructions']!=='') { |
  | 2618 |  | $html .= '<div class="moo-special-instruction-title">'.~~$this->pluginSettings['text\_under\_special\_instructions']~~.'</div>'; |
  |  | 2621 | $html .= '<div class="moo-special-instruction-title">'.wp\_kses\_post(wp\_unslash($this->pluginSettings['text\_under\_special\_instructions'])).'</div>'; |
  | 2619 | 2622 | } |
  | 2620 | 2623 | if (isset($this->pluginSettings['special\_instructions\_required']) && $this->pluginSettings['special\_instructions\_required']==='yes') { |
* ## [clover-online-orders/trunk/includes/shortcodes/storePage.php](/changeset/3168433/clover-online-orders/trunk/includes/shortcodes/storePage.php "Show the changeset 3168433 restricted to clover-online-orders/trunk/includes/shortcodes/storePage.php")

  | [r3142846](/browser/clover-online-orders/trunk/includes/shortcodes/storePage.php?rev=3142846#L184 "Show revision 3142846 of this file in browser") | [r3168433](/browser/clover-online-orders/trunk/includes/shortcodes/storePage.php?rev=3168433#L184 "Show revision 3168433 of this file in browser") |  |
  | --- | --- | --- |
  | 184 | 184 | $categories = array(); |
  | 185 | 185 | if(!empty($atts["categories"])){ |
  | 186 |  | $categoriesIds = ~~sanitize\_text\_field~~($atts["categories"]); |
  |  | 186 | $categoriesIds = esc\_attr($atts["categories"]); |
  | 187 | 187 | $categories = explode(",",strtoupper($categoriesIds)); |
  | 188 | 188 | } |
  | 189 | 189 |  |
  | 190 | 190 | if(!empty($atts["force\_theme"])){ |
  | 191 |  | $theme\_id = ~~sanitize\_text\_field~~($atts["force\_theme"]); |
  |  | 191 | $theme\_id = esc\_attr($atts["force\_theme"]); |
  | 192 | 192 | } |
  | 193 | 193 |  |
  | […](/browser/clover-online-orders/trunk/includes/shortcodes/storePage.php?rev=3142846#L239) | […](/browser/clover-online-orders/trunk/includes/shortcodes/storePage.php?rev=3168433#L239) |  |
  | 239 | 239 |  |
  | 240 | 240 | if(!empty($atts["categories"])){ |
  | 241 |  | $categoriesIds = ~~sanitize\_text\_field~~($atts["categories"]); |
  |  | 241 | $categoriesIds = esc\_attr($atts["categories"]); |
  | 242 | 242 | $categories = explode(",",strtoupper($categoriesIds)); |
  | 243 | 243 | } |
* ## [clover-online-orders/trunk/models/moo-OnlineOrders-Model.php](/changeset/3168433/clover-online-orders/trunk/models/moo-OnlineOrders-Model.php "Show the changeset 3168433 restricted to clover-online-orders/trunk/models/moo-OnlineOrders-Model.php")

  | [r3142846](/browser/clover-online-orders/trunk/models/moo-OnlineOrders-Model.php?rev=3142846#L410 "Show revision 3142846 of this file in browser") | [r3168433](/browser/clover-online-orders/trunk/models/moo-OnlineOrders-Model.php?rev=3168433#L410 "Show revision 3168433 of this file in browser") |  |
  | --- | --- | --- |
  | 410 | 410 | function updateOrderType($uuid,$name,$enable,$taxable,$type,$minAmount,$maxAmount,$customHours,$useCoupons,$customMessage,$allowScOrders,$allowServiceFee) |
  | 411 | 411 | { |
  | 412 |  | $uuid = esc\_sql($uuid); |
  | 413 |  | // $label = esc\_sql($name); |
  |  | 412 |  |
  |  | 413 | $uuid = sanitize\_text\_field($uuid); |
  |  | 414 | $label = wp\_kses\_post(wp\_unslash($name)); |
  | 414 | 415 | $taxable = esc\_sql($taxable); |
  | 415 | 416 | $status = esc\_sql($enable); |
  | […](/browser/clover-online-orders/trunk/models/moo-OnlineOrders-Model.php?rev=3142846#L421) | […](/browser/clover-online-orders/trunk/models/moo-OnlineOrders-Model.php?rev=3168433#L422) |  |
  | 421 | 422 | $allowScOrders = esc\_sql($allowScOrders); |
  | 422 | 423 | $allowServiceFee = esc\_sql($allowServiceFee); |
  | 423 |  | ~~// $customMessage = esc\_sql($customMessage~~); |
  |  | 424 | $customMessage = wp\_kses\_post(wp\_unslash($customMessage)); |
  | 424 | 425 |  |
  | 425 | 426 | return $this->db->update("{$this->db->prefix}moo\_order\_types", |
  | 426 | 427 | array( |
  | 427 |  | 'label' => $~~name~~, |
  |  | 428 | 'label' => $label, |
  | 428 | 429 | 'taxable' => $taxable, |
  | 429 | 430 | 'status' => $status, |
  | […](/browser/clover-online-orders/trunk/models/moo-OnlineOrders-Model.php?rev=3142846#L625) | […](/browser/clover-online-orders/trunk/models/moo-OnlineOrders-Model.php?rev=3168433#L626) |  |
  | 625 | 626 | $customer\_lng    = esc\_sql($customer\_lng); |
  | 626 | 627 |  |
  | 627 |  | $date = date('Y/m/d H:i:s', $datetime); |
  |  | 628 | $date = gmdate('Y/m/d H:i:s', $datetime); |
  | 628 | 629 | $this->db->insert( |
  | 629 | 630 | "{$this->db->prefix}moo\_order", |
  | […](/browser/clover-online-orders/trunk/models/moo-OnlineOrders-Model.php?rev=3142846#L902) | […](/browser/clover-online-orders/trunk/models/moo-OnlineOrders-Model.php?rev=3168433#L903) |  |
  | 902 | 903 | if ( isset($item["featured"]) ){ |
  | 903 | 904 | $fields["featured"] = $item["featured"]; |
  |  | 905 | } |
  |  | 906 | if ( isset($item["outofstock"]) ){ |
  |  | 907 | $fields["outofstock"] = $item["outofstock"]; |
  |  | 908 | } |
  |  | 909 | if ( isset($item["visible"]) ){ |
  |  | 910 | $fields["visible"] = $item["visible"]; |
  | 904 | 911 | } |
  | 905 | 912 | if (count($fields)>0){ |
* ## [clover-online-orders/trunk/moo\_OnlineOrders.php](/changeset/3168433/clover-online-orders/trunk/moo_OnlineOrders.php "Show the changeset 3168433 restricted to clover-online-orders/trunk/moo_OnlineOrders.php")

  | [r3142846](/browser/clover-online-orders/trunk/moo_OnlineOrders.php?rev=3142846#L17 "Show revision 3142846 of this file in browser") | [r3168433](/browser/clover-online-orders/trunk/moo_OnlineOrders.php?rev=3168433#L17 "Show revision 3168433 of this file in browser") |  |
  | --- | --- | --- |
  | 17 | 17 | \* Plugin URI:        https://www.zaytech.com |
  | 18 | 18 | \* Description:       Start taking orders from your Wordpress website and have them sent to your Clover Station |
  | 19 |  | \* Version:           1.5.~~7~~ |
  |  | 19 | \* Version:           1.5.8 |
  | 20 | 20 | \* Author:            Zaytech |
  | 21 | 21 | \* Author URI:        https://www.zaytech.com |
  | 22 |  | \* License:           ~~Clover app~~ |
  | 23 |  | \* License URI:       http~~s://www.zaytech.com~~ |
  |  | 22 | \* License:           GPLv2 or later |
  |  | 23 | \* License URI:       http://www.gnu.org/licenses/gpl-2.0.html |
  | 24 | 24 | \* Text Domain:       moo\_OnlineOrders |
  | 25 | 25 | \* Domain Path:       /languages |
  | […](/browser/clover-online-orders/trunk/moo_OnlineOrders.php?rev=3142846#L38) | […](/browser/clover-online-orders/trunk/moo_OnlineOrders.php?rev=3168433#L38) |  |
  | 38 | 38 | define('SOO\_ENV', 'PROD'); |
  | 39 | 39 | define('SOO\_DEFAULT\_CDN', false); |
  | 40 |  | define('SOO\_VERSION', "1.5.~~7~~"); |
  |  | 40 | define('SOO\_VERSION', "1.5.8-beta"); |
  | 41 | 41 | define('SOO\_G\_RECAPTCHA\_URL', 'https://www.google.com/recaptcha/api/siteverify'); |
  | 42 | 42 | define('SOO\_ACCEPT\_GIFTCARDS', true); |
  | […](/browser/clover-online-orders/trunk/moo_OnlineOrders.php?rev=3142846#L120) | […](/browser/clover-online-orders/trunk/moo_OnlineOrders.php?rev=3168433#L120) |  |
  | 120 | 120 |  |
  | 121 | 121 | function moo\_OnlineOrders\_shortcodes\_categorymsg($atts, $content) { |
  | 122 |  | if (isset($atts["cat\_id"]) && ~~$atts["message"]~~) { |
  |  | 122 | if (isset($atts["cat\_id"]) && !empty($atts["message"])) { |
  | 123 | 123 | if (isset($\_GET["category"]) && $\_GET["category"] == $atts["cat\_id"]) { |
  | 124 |  | if (~~isset($atts["css-class"]) && $atts["css-class"]!=""~~) { |
  | 125 |  | return "<div class='".~~$atts["css-class"]~~."'>".esc\_attr($atts["message"])."</div>"; |
  |  | 124 | if (!empty($atts["css-class"])) { |
  |  | 125 | return "<div class='".esc\_attr($atts["css-class"])."'>".esc\_attr($atts["message"])."</div>"; |
  | 126 | 126 | } else { |
  | 127 |  | return ~~sanitize\_text\_field~~($atts["message"]); |
  |  | 127 | return esc\_attr($atts["message"]); |
  | 128 | 128 | } |
  | 129 | 129 | } |
  | […](/browser/clover-online-orders/trunk/moo_OnlineOrders.php?rev=3142846#L214) | […](/browser/clover-online-orders/trunk/moo_OnlineOrders.php?rev=3168433#L214) |  |
  | 214 | 214 | add\_action('admin\_init', 'moo\_deactivateAndClean'); |
  | 215 | 215 |  |
  | 216 |  | if (get\_option('moo\_onlineOrders\_version') != '15~~7~~') { |
  |  | 216 | if (get\_option('moo\_onlineOrders\_version') != '158') { |
  | 217 | 217 | add\_action('plugins\_loaded', 'moo\_onlineOrders\_check\_version'); |
  | 218 | 218 | } |
  | […](/browser/clover-online-orders/trunk/moo_OnlineOrders.php?rev=3142846#L224) | […](/browser/clover-online-orders/trunk/moo_OnlineOrders.php?rev=3168433#L224) |  |
  | 224 | 224 | \* @since v 1.1.2 |
  | 225 | 225 | \*/ |
  | 226 |  | function moo\_onlineOrders\_check\_version() |
  | 227 |  | { |
  | 228 |  | global $wpdb; |
  | 229 |  | $wpdb->hide\_errors(); |
  |  | 226 | function moo\_onlineOrders\_check\_version() { |
  | 230 | 227 | $version = get\_option('moo\_onlineOrders\_version'); |
  |  | 228 | if (empty($version)) { |
  |  | 229 | $version = 120; |
  |  | 230 | } else { |
  |  | 231 | $version = intval($version); |
  |  | 232 | } |
  |  | 233 |  |
  |  | 234 | if (! class\_exists( 'Moo\_OnlineOrders\_Helpers' ) ){ |
  |  | 235 | require\_once SOO\_PLUGIN\_PATH ."/includes/moo-OnlineOrders-helpers.php"; |
  |  | 236 | } |
  |  | 237 | //Upgrade Database |
  |  | 238 | if ($version <= 136 ) { |
  |  | 239 | Moo\_OnlineOrders\_Helpers::upgradeDatabaseToVersion136(); |
  |  | 240 | } |
  |  | 241 | if ( $version <= 150 ) { |
  |  | 242 | Moo\_OnlineOrders\_Helpers::upgradeDatabaseToVersion150(); |
  |  | 243 | } |
  |  | 244 | if ( $version <= 158 ) { |
  |  | 245 | Moo\_OnlineOrders\_Helpers::upgradeDatabaseToVersion158(); |
  |  | 246 | } |
  |  | 247 |  |
  |  | 248 | //Apply default options |
  | 231 | 249 | $defaultOptions = get\_option('moo\_settings'); |
  | 232 |  | if (empty($version)) { |
  | 233 |  | $version="120"; |
  | 234 |  | } |
  | 235 |  | switch ($version) { |
  | 236 |  | case '120': |
  | 237 |  | //Adding new fields in category table |
  | 238 |  | @$wpdb->query("ALTER TABLE `{$wpdb->prefix}moo\_category` ADD `image\_url` VARCHAR(255) NULL"); |
  | 239 |  | @$wpdb->query("ALTER TABLE `{$wpdb->prefix}moo\_category` ADD `alternate\_name` VARCHAR(100) NULL"); |
  | 240 |  |  |
  | 241 |  | case '121': |
  | 242 |  | @$wpdb->query("ALTER TABLE `{$wpdb->prefix}moo\_modifier` ADD `sort\_order` INT NULL"); |
  | 243 |  | @$wpdb->query("ALTER TABLE `{$wpdb->prefix}moo\_modifier` ADD `show\_by\_default` INT NOT NULL DEFAULT '1'"); |
  | 244 |  | @$wpdb->query("ALTER TABLE `{$wpdb->prefix}moo\_modifier\_group` ADD `sort\_order` INT NULL"); |
  | 245 |  | case '122': |
  | 246 |  | @$wpdb->query("ALTER TABLE `{$wpdb->prefix}moo\_order\_types` ADD `type` INT(1) NULL"); |
  | 247 |  | case '123': |
  | 248 |  | @$wpdb->query("ALTER TABLE `{$wpdb->prefix}moo\_item` ADD `sort\_order` INT NULL"); |
  | 249 |  | case '124': |
  | 250 |  | @$wpdb->query("ALTER TABLE `{$wpdb->prefix}moo\_order\_types` ADD `sort\_order` INT NULL"); |
  | 251 |  | @$wpdb->query("CREATE TABLE IF NOT EXISTS `{$wpdb->prefix}moo\_item\_order` ( |
  | 252 |  | `\_id` INT NOT NULL AUTO\_INCREMENT, |
  | 253 |  | `item\_uuid` VARCHAR(100) NOT NULL, |
  | 254 |  | `order\_uuid` VARCHAR(100) NOT NULL, |
  | 255 |  | `quantity` VARCHAR(100) NOT NULL, |
  | 256 |  | `modifiers` TEXT NOT NULL, |
  | 257 |  | `special\_ins` VARCHAR(255) NOT NULL, |
  | 258 |  | PRIMARY KEY (`\_id`, `item\_uuid`, `order\_uuid`) |
  | 259 |  | );"); |
  | 260 |  |  |
  | 261 |  | //Change where pages are saved |
  | 262 |  | $store\_page     = get\_option('moo\_store\_page'); |
  | 263 |  | $checkout\_page  = get\_option('moo\_checkout\_page'); |
  | 264 |  | $cart\_page      = get\_option('moo\_cart\_page'); |
  | 265 |  | if (!isset($defaultOptions["store\_page"]) || $defaultOptions["store\_page"] == "") { |
  | 266 |  | $defaultOptions["store\_page"] = $store\_page; |
  | 267 |  | } |
  | 268 |  | if (!isset($defaultOptions["checkout\_page"]) || $defaultOptions["checkout\_page"] == "") { |
  | 269 |  | $defaultOptions["checkout\_page"] = $checkout\_page; |
  | 270 |  | } |
  | 271 |  | if (!isset($defaultOptions["cart\_page"]) || $defaultOptions["cart\_page"] == "") { |
  | 272 |  | $defaultOptions["cart\_page"] = $cart\_page; |
  | 273 |  | } |
  | 274 |  | if (!isset($defaultOptions["checkout\_login"]) || $defaultOptions["checkout\_login"] == "") { |
  | 275 |  | $defaultOptions["checkout\_login"] = "enabled"; |
  | 276 |  | } |
  | 277 |  | case '125': |
  | 278 |  | //add description to items |
  | 279 |  | @$wpdb->query("ALTER TABLE `{$wpdb->prefix}moo\_item` CHANGE `description` `description` TEXT "); |
  | 280 |  | @$wpdb->query("ALTER TABLE `{$wpdb->prefix}moo\_order\_types` ADD `minAmount` VARCHAR(100) NULL DEFAULT '0' "); |
  | 281 |  | //add default options for coupons feature |
  | 282 |  | if (!isset($defaultOptions["use\_coupons"]) || $defaultOptions["use\_coupons"] == "") { |
  | 283 |  | $defaultOptions["use\_coupons"] = "disabled"; |
  | 284 |  | } |
  | 285 |  | case '126': |
  | 286 |  | if (!isset($defaultOptions["use\_special\_instructions"]) || $defaultOptions["use\_special\_instructions"] == "") { |
  | 287 |  | $defaultOptions["use\_special\_instructions"] = "enabled"; |
  | 288 |  | } |
  | 289 |  | if (!isset($defaultOptions["save\_cards"]) || $defaultOptions["save\_cards"] == "") { |
  | 290 |  | $defaultOptions["save\_cards"] = "disabled"; |
  | 291 |  | } |
  | 292 |  | if (!isset($defaultOptions["save\_cards\_fees"]) || $defaultOptions["save\_cards\_fees"] == "") { |
  | 293 |  | $defaultOptions["save\_cards\_fees"] = "disabled"; |
  | 294 |  | } |
  | 295 |  | if (!isset($defaultOptions["service\_fees\_name"]) || $defaultOptions["service\_fees\_name"] == "") { |
  | 296 |  | $defaultOptions["service\_fees\_name"] = "Service Charge"; |
  | 297 |  | } |
  | 298 |  | if (!isset($defaultOptions["service\_fees\_type"]) || $defaultOptions["service\_fees\_type"] == "") { |
  | 299 |  | $defaultOptions["service\_fees\_type"] = "amount"; |
  | 300 |  | } |
  | 301 |  | if (!isset($defaultOptions["delivery\_fees\_name"]) || $defaultOptions["delivery\_fees\_name"] == "") { |
  | 302 |  | $defaultOptions["delivery\_fees\_name"] = "Delivery Charge"; |
  | 303 |  | } |
  | 304 |  | if (!isset($defaultOptions["order\_later\_minutes\_delivery"]) || $defaultOptions["order\_later\_minutes\_delivery"] == "") { |
  | 305 |  | $defaultOptions["order\_later\_minutes\_delivery"] = "60"; |
  | 306 |  | } |
  | 307 |  | if (!isset($defaultOptions["order\_later\_days\_delivery"]) || $defaultOptions["order\_later\_days\_delivery"] == "") { |
  | 308 |  | $defaultOptions["order\_later\_days\_delivery"] = "4"; |
  | 309 |  | } |
  | 310 |  | if (!isset($defaultOptions["copyrights"]) || $defaultOptions["copyrights"] == "") { |
  | 311 |  | $defaultOptions["copyrights"] = 'Powered by <a href="https://wordpress.org/plugins/clover-online-orders/" target="\_blank" title="Online Orders for Clover POS v 1.2.8">Smart Online Order</a>'; |
  | 312 |  | } |
  | 313 |  | case '127': |
  | 314 |  | $default\_options = array( |
  | 315 |  | array("name"=>"onePage\_fontFamily","value"=>"Oswald,sans-serif"), |
  | 316 |  | array("name"=>"onePage\_categoriesTopMargin","value"=>"0"), |
  | 317 |  | array("name"=>"onePage\_width","value"=>"1024"), |
  | 318 |  | array("name"=>"onePage\_categoriesFontColor","value"=>"#ffffff"), |
  | 319 |  | array("name"=>"onePage\_categoriesBackgroundColor","value"=>"#282b2e"), |
  | 320 |  | array("name"=>"onePage\_qtyWindow","value"=>"on"), |
  | 321 |  | array("name"=>"onePage\_qtyWindowForModifiers","value"=>"on"), |
  | 322 |  | array("name"=>"onePage\_backToTop","value"=>"off"), |
  | 323 |  | array("name"=>"order\_later\_asap\_for\_p","value"=>"off"), |
  | 324 |  | array("name"=>"order\_later\_asap\_for\_d","value"=>"off"), |
  | 325 |  | array("name"=>"mg\_settings\_displayInline","value"=>"disabled"), |
  | 326 |  | array("name"=>"mg\_settings\_qty\_for\_all","value"=>"enabled"), |
  | 327 |  | array("name"=>"mg\_settings\_qty\_for\_zeroPrice","value"=>"enabled"), |
  | 328 |  | ); |
  | 329 |  |  |
  | 330 |  | foreach ($default\_options as $default\_option) { |
  | 331 |  | if (!isset($defaultOptions[$default\_option["name"]])) { |
  | 332 |  | $defaultOptions[$default\_option["name"]]=$default\_option["value"]; |
  | 333 |  | } |
  | 334 |  | } |
  | 335 |  |  |
  | 336 |  | case '128': |
  | 337 |  | case '130': |
  | 338 |  | case '131': |
  | 339 |  | if (!isset($defaultOptions['onePage\_show\_more\_button'])) { |
  | 340 |  | $defaultOptions['onePage\_show\_more\_button']='on'; |
  | 341 |  | } |
  | 342 |  | $defaultOptions['payment\_creditcard'] = 'off'; |
  | 343 |  | $defaultOptions['use\_sms\_verification'] = 'enabled'; |
  | 344 |  | case '132': |
  | 345 |  | if (!isset($defaultOptions['my\_account\_page'])) { |
  | 346 |  | $defaultOptions['my\_account\_page']=''; |
  | 347 |  | } |
  | 348 |  | if (!isset($defaultOptions['text\_under\_special\_instructions'])) { |
  | 349 |  | $defaultOptions['text\_under\_special\_instructions']='\*additional charges may apply and not all changes are possible'; |
  | 350 |  | } |
  | 351 |  | if (!isset($defaultOptions['use\_couponsApp'])) { |
  | 352 |  | $defaultOptions['use\_couponsApp']= "off"; |
  | 353 |  | } |
  | 354 |  | if (!isset($defaultOptions['custom\_sa\_content'])) { |
  | 355 |  | $defaultOptions['custom\_sa\_content']= ""; |
  | 356 |  | } |
  | 357 |  | if (!isset($defaultOptions['custom\_sa\_title'])) { |
  | 358 |  | $defaultOptions['custom\_sa\_title']= ""; |
  | 359 |  | } |
  | 360 |  | if (!isset($defaultOptions['custom\_sa\_onCheckoutPage'])) { |
  | 361 |  | $defaultOptions['custom\_sa\_onCheckoutPage']= "off"; |
  | 362 |  | } |
  | 363 |  | if (!isset($defaultOptions['closing\_msg'])) { |
  | 364 |  | $defaultOptions['closing\_msg']= ""; |
  | 365 |  | } |
  | 366 |  | case '133': |
  | 367 |  | if (!isset($defaultOptions['accept\_orders'])) { |
  | 368 |  | $defaultOptions['accept\_orders']= "enabled"; |
  | 369 |  | } |
  | 370 |  | if (!isset($defaultOptions['onePage\_askforspecialinstruction'])) { |
  | 371 |  | $defaultOptions['onePage\_askforspecialinstruction'] = 'off'; |
  | 372 |  | } |
  | 373 |  | if (!isset($defaultOptions['onePage\_messageforspecialinstruction'])) { |
  | 374 |  | $defaultOptions['onePage\_messageforspecialinstruction'] = 'Type your instructions here, additional charges may apply and not all changes are possible'; |
  | 375 |  | } |
  | 376 |  | if (!isset($defaultOptions['jTheme\_askforspecialinstruction'])) { |
  | 377 |  | $defaultOptions['jTheme\_askforspecialinstruction'] = 'off'; |
  | 378 |  | } |
  | 379 |  | if (!isset($defaultOptions['jTheme\_messageforspecialinstruction'])) { |
  | 380 |  | $defaultOptions['jTheme\_messageforspecialinstruction'] = 'Type your instructions here, additional charges may apply and not all changes are possible'; |
  | 381 |  | } |
  | 382 |  | if (!isset($defaultOptions['style2\_askforspecialinstruction'])) { |
  | 383 |  | $defaultOptions['style2\_askforspecialinstruction'] = 'off'; |
  | 384 |  | } |
  | 385 |  | if (!isset($defaultOptions['style2\_messageforspecialinstruction'])) { |
  | 386 |  | $defaultOptions['style2\_messageforspecialinstruction'] = 'Type your instructions here, additional charges may apply and not all changes are possible'; |
  | 387 |  | } |
  | 388 |  |  |
  | 389 |  | case '136': |
  | 390 |  | case '137': |
  | 391 |  | @$wpdb->query("ALTER TABLE `{$wpdb->prefix}moo\_category` ADD `description` TEXT NULL"); |
  | 392 |  | @$wpdb->query("ALTER TABLE `{$wpdb->prefix}moo\_category` ADD `custom\_hours` VARCHAR(100) NULL"); |
  | 393 |  | @$wpdb->query("ALTER TABLE `{$wpdb->prefix}moo\_category` ADD `time\_availability` VARCHAR(10) NULL"); |
  | 394 |  | @$wpdb->query("ALTER TABLE `{$wpdb->prefix}moo\_item` CHANGE `description` `description` TEXT "); |
  | 395 |  | @$wpdb->query("ALTER TABLE `{$wpdb->prefix}moo\_order\_types` ADD `minAmount` VARCHAR(100) NULL DEFAULT '0' "); |
  | 396 |  | @$wpdb->query("ALTER TABLE `{$wpdb->prefix}moo\_order\_types` ADD `custom\_hours` VARCHAR(100) NULL"); |
  | 397 |  | @$wpdb->query("ALTER TABLE `{$wpdb->prefix}moo\_order\_types` ADD `time\_availability` VARCHAR(10) DEFAULT 1"); |
  | 398 |  | @$wpdb->query("ALTER TABLE `{$wpdb->prefix}moo\_order\_types` ADD `use\_coupons` INT(1) NULL DEFAULT 1"); |
  | 399 |  | @$wpdb->query("ALTER TABLE `{$wpdb->prefix}moo\_order\_types` ADD `custom\_message` VARCHAR(255) NULL DEFAULT 'Not available yet'"); |
  | 400 |  | case '138': |
  | 401 |  | case '139': |
  | 402 |  | @$wpdb->query("ALTER TABLE `{$wpdb->prefix}moo\_order\_types` ADD `allow\_sc\_order` INT(1) NULL DEFAULT 1 "); |
  | 403 |  | @$wpdb->query("ALTER TABLE `{$wpdb->prefix}moo\_order\_types` ADD `maxAmount` VARCHAR(100) NULL DEFAULT '' "); |
  | 404 |  | $defaultOptions["mg\_settings\_minimized"] = "off"; |
  | 405 |  | $defaultOptions["scp"] = "off"; |
  | 406 |  | $defaultOptions["tips\_selection"] = "10,15,20,25"; |
  | 407 |  | $defaultOptions["tips\_default"] = ""; |
  | 408 |  | $defaultOptions["rollout\_order\_number"] = "on"; |
  | 409 |  | $defaultOptions["rollout\_order\_number\_max"] = "999"; |
  | 410 |  | $defaultOptions["thanks\_page\_wp"] = ""; |
  | 411 |  | case '140': |
  | 412 |  | case '141': |
  | 413 |  | case '142': |
  | 414 |  | case '143': |
  | 415 |  | case '144': |
  | 416 |  | set\_transient('moo\_blackout', false, 1); |
  | 417 |  | if (!isset($defaultOptions["delivery\_errorMsg"]) || $defaultOptions["delivery\_errorMsg"] == "") { |
  | 418 |  | $defaultOptions["delivery\_errorMsg"] = "Sorry, zone not supported. We do not deliver to this address at this time"; |
  | 419 |  | } |
  | 420 |  | $defaultOptions["special\_instructions\_required"] = "no"; |
  | 421 |  | case '145': |
  | 422 |  | case '146': |
  | 423 |  | case '147': |
  | 424 |  | case '148': |
  | 425 |  | case '149': |
  | 426 |  | if (isset($defaultOptions["payment\_creditcard"]) &&  $defaultOptions["payment\_creditcard"] === "on") { |
  | 427 |  | $defaultOptions["payment\_creditcard"] = "off"; |
  | 428 |  | $defaultOptions["clover\_payment\_form"] = "on"; |
  | 429 |  | } |
  | 430 |  | case '150': |
  | 431 |  | @$wpdb->query("ALTER TABLE `{$wpdb->prefix}moo\_order\_types` ADD `allow\_service\_fee` INT(1) NULL DEFAULT 1"); |
  | 432 |  | @$wpdb->query("ALTER TABLE `{$wpdb->prefix}moo\_item` ADD `category\_uuid` VARCHAR(45) NULL"); |
  | 433 |  | @$wpdb->query("ALTER TABLE `{$wpdb->prefix}moo\_item` ADD `custom\_hours` VARCHAR(45) NULL"); |
  | 434 |  | @$wpdb->query("ALTER TABLE `{$wpdb->prefix}moo\_item` ADD `soo\_name` VARCHAR(255) NULL after name"); |
  | 435 |  | @$wpdb->query("ALTER TABLE `{$wpdb->prefix}moo\_item` ADD `available` INT(1) NULL DEFAULT 1 after visible"); |
  | 436 |  | update\_option("moo\_settings", $defaultOptions); |
  | 437 |  | case '151': |
  | 438 |  | case '152': |
  | 439 |  | case '153': |
  | 440 |  | case '154': |
  | 441 |  | @$wpdb->query("ALTER TABLE `{$wpdb->prefix}moo\_item` ADD `featured` INT(1) NULL DEFAULT 0 after available"); |
  | 442 |  | case '155': |
  | 443 |  | case '156': |
  | 444 |  | @$wpdb->query("ALTER TABLE `{$wpdb->prefix}moo\_modifier` ADD `is\_pre\_selected` INT(1) NULL DEFAULT 0"); |
  | 445 |  | case '157': |
  | 446 |  | // Get current charset |
  | 447 |  | $itemTableCharset = Moo\_OnlineOrders\_Helpers::getCharsetOfDbTable("moo\_item"); |
  | 448 |  | $itemUuidColumnCollate = Moo\_OnlineOrders\_Helpers::getCharsetOfDbColumn("moo\_item","uuid"); |
  | 449 |  |  |
  | 450 |  | // Add new fields to tax rate |
  | 451 |  | @$wpdb->query("ALTER TABLE `{$wpdb->prefix}moo\_tax\_rate` ADD `taxAmount` INT NULL"); |
  | 452 |  | @$wpdb->query("ALTER TABLE `{$wpdb->prefix}moo\_tax\_rate` ADD `taxType` VARCHAR(100) NULL"); |
  | 453 |  |  |
  | 454 |  | //Add a flag to the category table |
  | 455 |  | @$wpdb->query("ALTER TABLE `{$wpdb->prefix}moo\_category` ADD `items\_imported` INT(1) NOT NULL DEFAULT 0"); |
  | 456 |  |  |
  | 457 |  | //Create a new table for items\_categories (many to many) |
  | 458 |  | @$wpdb->query("CREATE TABLE IF NOT EXISTS `{$wpdb->prefix}moo\_items\_categories` ( |
  | 459 |  | `item\_uuid` VARCHAR(45) NOT NULL, |
  | 460 |  | `category\_uuid` VARCHAR(100) NOT NULL, |
  | 461 |  | `sort\_order` INT NULL, |
  | 462 |  | PRIMARY KEY (`item\_uuid`, `category\_uuid`), |
  | 463 |  | INDEX `idx\_item\_has\_categories` (`item\_uuid` ASC) , |
  | 464 |  | INDEX `idx\_category\_has\_items` (`category\_uuid` ASC)  , |
  | 465 |  | CONSTRAINT `{$wpdb->prefix}fk\_item\_has\_categories` |
  | 466 |  | FOREIGN KEY (`item\_uuid`) |
  | 467 |  | REFERENCES `{$wpdb->prefix}moo\_item` (`uuid`) |
  | 468 |  | ON DELETE CASCADE |
  | 469 |  | ON UPDATE CASCADE, |
  | 470 |  | CONSTRAINT `{$wpdb->prefix}fk\_category\_has\_items` |
  | 471 |  | FOREIGN KEY (`category\_uuid`) |
  | 472 |  | REFERENCES `{$wpdb->prefix}moo\_category` (`uuid`) |
  | 473 |  | ON DELETE CASCADE |
  | 474 |  | ON UPDATE CASCADE, |
  | 475 |  | UNIQUE(`item\_uuid`,`category\_uuid`)) DEFAULT CHARACTER SET $itemTableCharset COLLATE $itemUuidColumnCollate"); |
  | 476 |  | update\_option('moo\_onlineOrders\_version', '157'); |
  | 477 |  | break; |
  | 478 |  | } |
  |  | 250 | Moo\_OnlineOrders\_Helpers::applyDefaultOptions($defaultOptions); |
  |  | 251 | update\_option("moo\_settings", $defaultOptions); |
  |  | 252 | //Upgrade version |
  |  | 253 | update\_option('moo\_onlineOrders\_version', '158'); |
  | 479 | 254 | } |
  | 480 | 255 |  |
* ## [clover-online-orders/trunk/public/css/dist/icheck-blue.min.css](/changeset/3168433/clover-online-orders/trunk/public/css/dist/icheck-blue.min.css "Show the changeset 3168433 restricted to clover-online-orders/trunk/public/css/dist/icheck-blue.min.css")

  | [r2936448](/browser/clover-online-orders/trunk/public/css/dist/icheck-blue.min.css?rev=2936448#L1 "Show revision 2936448 of this file in browser") | [r3168433](/browser/clover-online-orders/trunk/public/css/dist/icheck-blue.min.css?rev=3168433#L1 "Show revision 3168433 of this file in browser") |  |
  | --- | --- | --- |
  | 1 |  | .icheckbox\_square-blue,.iradio\_square-blue{display:inline-block;vertical-align:middle;margin:0;padding:0;width:22px;height:22px;background:url(blue~~.png) no-repeat;border:none;cursor:pointer;margin-left:25px}.icheckbox\_square-blue{background-position:0 0}.icheckbox\_square-blue.hover{background-position:-24px 0}.icheckbox\_square-blue.checked{background-position:-48px 0}.icheckbox\_square-blue.disabled{background-position:-72px 0;cursor:default}.icheckbox\_square-blue.checked.disabled{background-position:-96px 0}.iradio\_square-blue{background-position:-120px 0}.iradio\_square-blue.hover{background-position:-144px 0}.iradio\_square-blue.checked{background-position:-168px 0}.iradio\_square-blue.disabled{background-position:-192px 0;cursor:default}.iradio\_square-blue.checked.disabled{background-position:-216px 0}@media (-o-min-device-pixel-ratio:5/4),(-webkit-min-device-pixel-ratio:1.25),(min-resolution:120dpi),(min-resolution:1.25dppx){.icheckbox\_square-blue,.iradio\_square-blue{background-image:url(blue@2x~~.png);-webkit-background-size:240px 24px;background-size:240px 24px}} |
  |  | 1 | .icheckbox\_square-blue,.iradio\_square-blue{display:inline-block;vertical-align:middle;margin:0;padding:0;width:22px;height:22px;background:url(blueX2.png) no-repeat;border:none;cursor:pointer;margin-left:25px}.icheckbox\_square-blue{background-position:0 0}.icheckbox\_square-blue.hover{background-position:-24px 0}.icheckbox\_square-blue.checked{background-position:-48px 0}.icheckbox\_square-blue.disabled{background-position:-72px 0;cursor:default}.icheckbox\_square-blue.checked.disabled{background-position:-96px 0}.iradio\_square-blue{background-position:-120px 0}.iradio\_square-blue.hover{background-position:-144px 0}.iradio\_square-blue.checked{background-position:-168px 0}.iradio\_square-blue.disabled{background-position:-192px 0;cursor:default}.iradio\_square-blue.checked.disabled{background-position:-216px 0}@media (-o-min-device-pixel-ratio:5/4),(-webkit-min-device-pixel-ratio:1.25),(min-resolution:120dpi),(min-resolution:1.25dppx){.icheckbox\_square-blue,.iradio\_square-blue{background-image:url(blue.png);-webkit-background-size:240px 24px;background-size:240px 24px}} |
* ## [clover-online-orders/trunk/public/css/dist/sooCheckout-light.min.css](/changeset/3168433/clover-online-orders/trunk/public/css/dist/sooCheckout-light.min.css "Show the changeset 3168433 restricted to clover-online-orders/trunk/public/css/dist/sooCheckout-light.min.css")

  | [r3038387](/browser/clover-online-orders/trunk/public/css/dist/sooCheckout-light.min.css?rev=3038387#L1 "Show revision 3038387 of this file in browser") | [r3168433](/browser/clover-online-orders/trunk/public/css/dist/sooCheckout-light.min.css?rev=3168433#L1 "Show revision 3168433 of this file in browser") |  |
  | --- | --- | --- |
  | 1 |  | @font-face{font-display:swap;font-family:Soo DM Sans;font-style:normal;font-weight:400;src:url(https://fonts.gstatic.com/s/dmsans/v11/rP2Hp2ywxg089UriOZQ.ttf) format("truetype")}@font-face{font-display:swap;font-family:Soo DM Sans;font-style:normal;font-weight:500;src:url(https://fonts.gstatic.com/s/dmsans/v11/rP2Cp2ywxg089UriAWCrOB8.ttf) format("truetype")}@font-face{font-display:swap;font-family:Soo DM Sans;font-style:normal;font-weight:700;src:url(https://fonts.gstatic.com/s/dmsans/v11/rP2Cp2ywxg089UriASitOB8.ttf) format("truetype")}#moo\_CheckoutContainer,.moo\_CheckoutContainer{color:#000;font-size:14px;line-height:25px;margin:0 auto 60px;max-width:1200px;text-align:left}#moo\_CheckoutContainer .moo-error-section,.moo\_CheckoutContainer .moo-error-section{color:red}#moo\_CheckoutContainer .moo-has-error,#moo\_CheckoutContainer .moo-has-error>input,.moo\_CheckoutContainer .moo-has-error,.moo\_CheckoutContainer .moo-has-error>input{border-color:red!important;color:red!important}#moo\_CheckoutContainer #moo-checkout-form,#moo\_CheckoutContainer #moo-forgotpassword-section,#moo\_CheckoutContainer #moo-signing-section,#moo\_CheckoutContainer .moo-error-section,.moo\_CheckoutContainer #moo-checkout-form,.moo\_CheckoutContainer #moo-forgotpassword-section,.moo\_CheckoutContainer #moo-signing-section,.moo\_CheckoutContainer .moo-error-section{display:none}#moo\_CheckoutContainer .sooCheckoutTextInput,.moo\_CheckoutContainer .sooCheckoutTextInput{background:#fff none;border:.7px solid #b8b8b8;border-radius:3px;display:block;font-size:14px;height:39px;padding-left:5px;width:100%}#moo\_CheckoutContainer .sooCheckoutTextInput:focus,.moo\_CheckoutContainer .sooCheckoutTextInput:focus{border-color:#1565d8;box-shadow:none;outline:none}#moo\_CheckoutContainer .sooCheckoutTextInput[disabled],.moo\_CheckoutContainer .sooCheckoutTextInput[disabled]{background:#ececec none;border-color:#ececec;box-shadow:none}#moo\_CheckoutContainer .sooCheckoutPrimaryButtonInput,.moo\_CheckoutContainer .sooCheckoutPrimaryButtonInput{background:linear-gradient(0deg,#004fac,#004fac),linear-gradient(0deg,#cdcdcd,#cdcdcd);border:1px solid #004fac;border-radius:5px;color:#fff;cursor:pointer;font-family:Soo DM Sans,sans-serif;font-size:16px;font-weight:400;height:40px;letter-spacing:0;line-height:18px;margin-top:15px;min-height:40px;padding:10px 20px;text-align:center}#moo\_CheckoutContainer .sooCheckoutSecondaryButtonInput,.moo\_CheckoutContainer .sooCheckoutSecondaryButtonInput{background:#fff;border:1px solid #004fac;border-radius:5px;color:#004fac;cursor:pointer;font-family:Soo DM Sans,sans-serif;font-size:16px;font-weight:500;height:40px;letter-spacing:0;line-height:18px;margin-top:15px;padding:10px 20px;text-align:center}#moo\_CheckoutContainer .sooCheckoutPrimaryButtonInput:focus,#moo\_CheckoutContainer .sooCheckoutSecondaryButtonInput:focus,.moo\_CheckoutContainer .sooCheckoutPrimaryButtonInput:focus,.moo\_CheckoutContainer .sooCheckoutSecondaryButtonInput:focus{outline:none}#moo\_CheckoutContainer .soo-text-right,.moo\_CheckoutContainer .soo-text-right{text-align:right}#moo\_CheckoutContainer .soo-margin-bottom-10,.moo\_CheckoutContainer .soo-margin-bottom-10{margin-bottom:10px}#moo\_CheckoutContainer .sooBorderedArea,.moo\_CheckoutContainer .sooBorderedArea{background-color:#fff;border:.7px solid #b8b8b8;border-radius:10px;padding:25px}#moo\_CheckoutContainer #moo-checkout-form,.moo\_CheckoutContainer #moo-checkout-form{overflow:hidden}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside{background-color:#fff;border:.7px solid #b8b8b8;border-radius:10px;margin-bottom:10px;padding-bottom:15px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-customer,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-customer{min-height:130px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-customer #moo-checkout-contact-content,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-customer #moo-checkout-contact-content{display:none}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-customer #moo-checkout-contact-content .soo-contact-info,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-customer #moo-checkout-contact-content .soo-contact-info{border:.7px solid #b8b8b8;border-radius:10px;margin:8px;padding:10px 5px 5px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-customer #moo-checkout-contact-content .soo-contact-info .soo-contact-info-name,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-customer #moo-checkout-contact-content .soo-contact-info .soo-contact-info-name{color:#000;font-family:Soo DM Sans,sans-serif;font-size:16px;font-style:normal;font-weight:500;line-height:21px;padding-bottom:5px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-customer #moo-checkout-contact-content .soo-contact-info .soo-contact-info-email,#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-customer #moo-checkout-contact-content .soo-contact-info .soo-contact-info-phone,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-customer #moo-checkout-contact-content .soo-contact-info .soo-contact-info-email,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-customer #moo-checkout-contact-content .soo-contact-info .soo-contact-info-phone{color:#727272;font-family:Soo DM Sans,sans-serif;font-size:14px;font-style:normal;font-weight:400;line-height:18px;padding-bottom:5px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-customer #moo-checkout-contact-content .soo-contact-info .soo-contact-edit,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-customer #moo-checkout-contact-content .soo-contact-info .soo-contact-edit{color:#0e84e5;cursor:pointer;font-family:Soo DM Sans,sans-serif;font-size:14px;font-style:normal;font-weight:400;line-height:18px;padding-top:5px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-customer #moo-checkout-contact-content .soo-contact-info .soo-contact-logout,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-customer #moo-checkout-contact-content .soo-contact-info .soo-contact-logout{color:#0e84e5;cursor:pointer;font-family:Soo DM Sans,sans-serif;font-size:14px;font-style:normal;font-weight:400;line-height:18px;padding:5px;text-align:right}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-customer #moo-checkout-contact-form,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-customer #moo-checkout-contact-form{color:#000;display:none}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-customer #moo-checkout-contact-form .soo-contact-loginButtonContainer,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-customer #moo-checkout-contact-form .soo-contact-loginButtonContainer{margin-bottom:20px;margin-top:-40px;text-align:right}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-customer #moo-checkout-contact-form .soo-contact-login,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-customer #moo-checkout-contact-form .soo-contact-login{color:#004fac;cursor:pointer}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-customer .moo-form-group,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-customer .moo-form-group{margin-bottom:10px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes,#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments{margin-top:10px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .moo-checkout-radio-input-option,#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments .moo-checkout-radio-input-option,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .moo-checkout-radio-input-option,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments .moo-checkout-radio-input-option{padding-left:15px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .moo-checkout-radio-input,#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments .moo-checkout-radio-input,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .moo-checkout-radio-input,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments .moo-checkout-radio-input{background-color:#fff;height:25px;margin-top:8px;vertical-align:bottom;width:25px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .moo-checkout-radio-input:focus,#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments .moo-checkout-radio-input:focus,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .moo-checkout-radio-input:focus,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments .moo-checkout-radio-input:focus{outline:none}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .moo-checkout-radio-input-label,#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments .moo-checkout-radio-input-label,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .moo-checkout-radio-input-label,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments .moo-checkout-radio-input-label{color:#000;cursor:pointer;display:inline;font-family:Soo DM Sans,sans-serif;font-size:17px;font-weight:400;letter-spacing:0;line-height:20px;padding-left:7px;text-align:left;vertical-align:middle}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-checkout-radio-input-option,#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments .soo-checkout-radio-input-option,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-checkout-radio-input-option,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments .soo-checkout-radio-input-option{padding-left:15px;padding-top:7px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-checkout-radio-input,#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments .soo-checkout-radio-input,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-checkout-radio-input,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments .soo-checkout-radio-input{-webkit-appearance:none;appearance:none;background:#fff no-repeat 50%;border:1px solid #000;border-radius:50%;height:26px;margin:calc(.75em - 11px) .25rem 0 0;padding:0;vertical-align:top;width:26px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-checkout-radio-input:focus,#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments .soo-checkout-radio-input:focus,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-checkout-radio-input:focus,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments .soo-checkout-radio-input:focus{border-color:#ddd;outline:none}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-checkout-radio-input:disabled,#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments .soo-checkout-radio-input:disabled,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-checkout-radio-input:disabled,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments .soo-checkout-radio-input:disabled{background:#eee}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-checkout-radio-input:checked,#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments .soo-checkout-radio-input:checked,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-checkout-radio-input:checked,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments .soo-checkout-radio-input:checked{background-image:url(radio.svg);border:2px solid #004fac}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-add-delivery-address-form,#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-add-delivery-address-form,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses{display:none}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-add-delivery-address-form,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-add-delivery-address-form{border:.7px solid #b8b8b8;border-radius:10px;margin-top:15px;padding:20px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-add-delivery-address-form .sooCheckoutPrimaryButtonInput,#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-add-delivery-address-form .sooCheckoutSecondaryButtonInput,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-add-delivery-address-form .sooCheckoutPrimaryButtonInput,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-add-delivery-address-form .sooCheckoutSecondaryButtonInput{width:100px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses{border:.7px solid #b8b8b8;border-radius:10px;margin-top:15px;padding:20px 20px 10px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses .soo-addresses-wrapper,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses .soo-addresses-wrapper{position:relative}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses .soo-addresses-wrapper .soo-estimate-loader,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses .soo-addresses-wrapper .soo-estimate-loader{background-color:#fff;display:none;height:100%;opacity:0;position:absolute;width:100%}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses .soo-addresses-wrapper .soo-addresses-title,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses .soo-addresses-wrapper .soo-addresses-title{color:#000;font-weight:600;padding-bottom:8px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses .soo-addresses-wrapper .soo-one-address,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses .soo-addresses-wrapper .soo-one-address{border:.7px solid #b8b8b8;border-radius:5px;color:#727272;cursor:pointer;font-family:Soo DM Sans,sans-serif;font-size:14px;font-style:normal;font-weight:400;line-height:18px;margin-bottom:5px;padding:15px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses .soo-addresses-wrapper .soo-one-address .soo-one-address-name,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses .soo-addresses-wrapper .soo-one-address .soo-one-address-name{color:#000;font-weight:500}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses .soo-addresses-wrapper .soo-one-address .soo-one-address-line1,#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses .soo-addresses-wrapper .soo-one-address .soo-one-address-line2,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses .soo-addresses-wrapper .soo-one-address .soo-one-address-line1,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses .soo-addresses-wrapper .soo-one-address .soo-one-address-line2{width:90%}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses .soo-addresses-wrapper .soo-one-address .soo-address-error,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses .soo-addresses-wrapper .soo-one-address .soo-address-error{color:red;font-weight:500;margin-top:10px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses .soo-addresses-wrapper .soo-one-address .soo-delivery-amount,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses .soo-addresses-wrapper .soo-one-address .soo-delivery-amount{color:#004fac;font-weight:500;height:0;position:relative;text-align:right;top:-38px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses .soo-addresses-wrapper .soo-one-address .soo-delivery-amount>svg,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses .soo-addresses-wrapper .soo-one-address .soo-delivery-amount>svg{fill:#004fac;animation:sooAnmRotate .6s linear infinite}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses .soo-addresses-wrapper .soo-selected,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses .soo-addresses-wrapper .soo-selected{background:#f0f5fc;border:.7px solid #1565d887}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses .soo-addresses-wrapper .soo-selected-warning,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses .soo-addresses-wrapper .soo-selected-warning{background-color:#ffc!important;border:.7px solid #ccc;color:#000!important}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses .soo-addresses-wrapper .soo-selected-error,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses .soo-addresses-wrapper .soo-selected-error{background-color:#fdd!important;border:.7px solid #ccc;color:#000!important}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses .soo-add-new-address-button,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses .soo-add-new-address-button{color:#004fac;font-family:Soo DM Sans,sans-serif;font-size:14px;font-style:normal;font-weight:400;line-height:18px;padding-top:20px;text-align:right}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses .soo-add-new-address-button>span,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses .soo-add-new-address-button>span{cursor:pointer}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-orderdate,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-orderdate{margin-top:10px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments .clover-error,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments .clover-error{color:red}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments #moo-cloverCreditCardPanel,#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments #moo-cloverGiftCardPanel,#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments #mooGooglePaySection,#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments #moo\_cashPanel,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments #moo-cloverCreditCardPanel,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments #moo-cloverGiftCardPanel,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments #mooGooglePaySection,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments #moo\_cashPanel{border:.7px solid #b8b8b8;border-radius:10px;display:none;margin-top:15px;padding:20px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments #moo-cloverCreditCardPanel,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments #moo-cloverCreditCardPanel{padding-bottom:10px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments #moo-cloverCreditCardPanel #moo\_CloverCardCvv,#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments #moo-cloverCreditCardPanel #moo\_CloverCardDate,#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments #moo-cloverCreditCardPanel #moo\_CloverCardNumber,#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments #moo-cloverCreditCardPanel #moo\_CloverCardZip,#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments #moo-cloverCreditCardPanel #moo\_CloverStreetAddress,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments #moo-cloverCreditCardPanel #moo\_CloverCardCvv,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments #moo-cloverCreditCardPanel #moo\_CloverCardDate,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments #moo-cloverCreditCardPanel #moo\_CloverCardNumber,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments #moo-cloverCreditCardPanel #moo\_CloverCardZip,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments #moo-cloverCreditCardPanel #moo\_CloverStreetAddress{border-radius:5px;height:45px;margin-bottom:10px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments #moo-cloverGiftCardPanel,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments #moo-cloverGiftCardPanel{border:none;padding:0}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments #moo-cloverGiftCardPanel #moo\_CloverGiftCard,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments #moo-cloverGiftCardPanel #moo\_CloverGiftCard{min-height:100px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments #moo\_cashPanel .soo-phone-verif-title,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments #moo\_cashPanel .soo-phone-verif-title{color:#000;margin-bottom:10px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments #moo\_cashPanel .soo-phone-input,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments #moo\_cashPanel .soo-phone-input{display:none}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments #moo\_cashPanel .soo-phone-input>input,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments #moo\_cashPanel .soo-phone-input>input{float:left;width:70%}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments #moo\_cashPanel .soo-phone-input>button,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments #moo\_cashPanel .soo-phone-input>button{clear:both;margin:0 0 0 10px;width:25%}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments #moo\_cashPanel .soo-phone-button,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments #moo\_cashPanel .soo-phone-button{text-align:center}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments #moo\_cashPanel .soo-phone-button>button,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments #moo\_cashPanel .soo-phone-button>button{width:70%}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-coupon,#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-instruction,#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-tips,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-coupon,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-instruction,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-tips{margin-top:10px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-coupon div.moo-checkout-bloc-content>div>div.moo-col-xs-3,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-coupon div.moo-checkout-bloc-content>div>div.moo-col-xs-3{padding:0 10px 0 0}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-coupon div.moo-checkout-bloc-content>div>div>div>button,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-coupon div.moo-checkout-bloc-content>div>div>div>button{margin:0;padding:10px 12px;width:100%}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-coupon div>button.sooDeleteCouponButton.sooCheckoutPrimaryButtonInput,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-coupon div>button.sooDeleteCouponButton.sooCheckoutPrimaryButtonInput{display:none;width:100%}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty{margin-top:10px;min-height:135px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty>div.moo-checkout-bloc-content,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty>div.moo-checkout-bloc-content{margin-top:23px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .sooRemovePointsButton,#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .usePointsInput,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .sooRemovePointsButton,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .usePointsInput{display:none}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .usePointsInput,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .usePointsInput{margin-top:30px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .usePointsInput .moo-error-section,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .usePointsInput .moo-error-section{margin-top:7px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .usePointsInput .sooToPayInfo,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .usePointsInput .sooToPayInfo{margin-top:8px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .usePointsInput .sooValidatePoints,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .usePointsInput .sooValidatePoints{padding:0}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .usePointsInput .sooValidatePoints .sooEditPointsButton,#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .usePointsInput .sooValidatePoints .sooValidatePointsButton,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .usePointsInput .sooValidatePoints .sooEditPointsButton,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .usePointsInput .sooValidatePoints .sooValidatePointsButton{font-size:16px;line-height:16px;margin:0;min-height:15px;padding:10px;width:70%}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .usePointsInput .sooValidatePoints .sooEditPointsButton,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .usePointsInput .sooValidatePoints .sooEditPointsButton{display:none}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .usePointsInput .sooValidatePoints .sooLoyaltyDetailsButton svg,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .usePointsInput .sooValidatePoints .sooLoyaltyDetailsButton svg{cursor:pointer;height:30px;vertical-align:middle;width:30px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .usePointsInput #sooSelectedPointsValue,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .usePointsInput #sooSelectedPointsValue{padding-left:10px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .loyaltyIcon>img,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .loyaltyIcon>img{width:50px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .loyaltyButtons,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .loyaltyButtons{padding:0 10px 0 0;text-align:right}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .loyaltyButtons .sooRemovePointsButton,#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .loyaltyButtons .sooUsePointsButton,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .loyaltyButtons .sooRemovePointsButton,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .loyaltyButtons .sooUsePointsButton{font-weight:400;margin:0;padding:10px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .loyaltyButtons .sooRemovePointsButton,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .loyaltyButtons .sooRemovePointsButton{font-size:13px;padding:7px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .loyaltyBalance,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .loyaltyBalance{padding:0}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .loyaltyBalance .balance,#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .loyaltyBalance .balanceTitle,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .loyaltyBalance .balance,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .loyaltyBalance .balanceTitle{color:rgba(0,0,0,.63);font-family:Soo DM Sans,sans-serif;font-size:14px;font-weight:400;letter-spacing:0;line-height:18px;text-align:left}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .loyaltyBalance .balance,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .loyaltyBalance .balance{color:#000}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .loyaltyBalance .balance>.balancePoints,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .loyaltyBalance .balance>.balancePoints{font-size:18px;font-weight:500;line-height:23px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .loyaltyBalance .loyaltyButtons,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .loyaltyBalance .loyaltyButtons{font-weight:400;text-align:right}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside .moo-checkout-bloc-title,#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside .moo-checkout-bloc-title>label,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside .moo-checkout-bloc-title,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside .moo-checkout-bloc-title>label{color:#000;font-family:Soo DM Sans,sans-serif;font-size:18px;font-style:normal;font-weight:500;line-height:30px;margin-bottom:10px;margin-top:10px;text-transform:none}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside .moo\_checkout\_border\_bottom,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside .moo\_checkout\_border\_bottom{border-bottom:1px solid #eee;margin-left:-15px;margin-right:-15px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-cart,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-cart{background-color:#fff;border:.7px solid #b8b8b8;border-radius:10px;color:#000;font-family:Soo DM Sans,sans-serif;font-size:15px;padding:0}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-cart .moo-shopping-cart-title,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-cart .moo-shopping-cart-title{border-bottom:.7px solid #b8b8b8;color:#000;font-family:Soo DM Sans,sans-serif;font-size:18px;font-style:normal;font-weight:500;line-height:30px;padding:13px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-cart .moo-shopping-cart-line,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-cart .moo-shopping-cart-line{margin-bottom:5px;margin-top:5px;padding-left:10px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-cart .moo-shopping-cart-line .moo-scl-qty,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-cart .moo-shopping-cart-line .moo-scl-qty{text-align:center}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-cart .moo-shopping-cart-line .moo-scl-item,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-cart .moo-shopping-cart-line .moo-scl-item{padding:0}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-cart .moo-shopping-cart-line .moo-scl-item .moo-scl-itemName,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-cart .moo-shopping-cart-line .moo-scl-item .moo-scl-itemName{font-family:Soo DM Sans,sans-serif;font-size:16px;font-weight:400;letter-spacing:0;line-height:20px;margin-top:3px;text-align:left}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-cart .moo-shopping-cart-line .moo-scl-item .moo-scl-itemModifiers,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-cart .moo-shopping-cart-line .moo-scl-item .moo-scl-itemModifiers{font-family:Soo DM Sans,sans-serif;font-size:15px;font-weight:400;letter-spacing:0;line-height:16px;text-align:left}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-cart .moo-shopping-cart-line .moo-scl-itemPrice,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-cart .moo-shopping-cart-line .moo-scl-itemPrice{padding-left:0;padding-right:20px;text-align:right}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-cart .moo-totals,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-cart .moo-totals{border-top:.7px solid #b8b8b8;color:#000;font-family:Soo DM Sans,sans-serif;font-size:13px;font-weight:400;letter-spacing:0;overflow:auto;padding:10px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-cart .moo-totals .moo-totals-item,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-cart .moo-totals .moo-totals-item{clear:both;float:right;margin-bottom:0;width:100%}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-cart .moo-totals .moo-totals-item .moo-totals-value,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-cart .moo-totals .moo-totals-item .moo-totals-value{float:right;text-align:right;width:30%}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-cart .moo-totals .moo-totals-item label,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-cart .moo-totals .moo-totals-item label{clear:both;float:left;text-align:right;width:70%}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-cart .moo-totals #sooCouponTotalSection,#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-cart .moo-totals #sooDeliveryFeeTotalSection,#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-cart .moo-totals #sooPointsTotalSection,#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-cart .moo-totals #sooServiceFeeTotalSection,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-cart .moo-totals #sooCouponTotalSection,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-cart .moo-totals #sooDeliveryFeeTotalSection,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-cart .moo-totals #sooPointsTotalSection,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-cart .moo-totals #sooServiceFeeTotalSection{display:none}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-links a,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-links a{color:#004fac;font-size:12px;text-align:center;text-decoration:none}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-links a:visited,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-links a:visited{color:#004fac}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-links a:focus,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-links a:focus{outline:none}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-links .moo-checkoutText-updateCart,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-links .moo-checkoutText-updateCart{float:left}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-links .moo-checkoutText-continueShopping,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-links .moo-checkoutText-continueShopping{float:right}#moo\_CheckoutContainer #moo-checkout-form #moo-checkout-form-btnActions #moo-cloverGooglePay,.moo\_CheckoutContainer #moo-checkout-form #moo-checkout-form-btnActions #moo-cloverGooglePay{display:none;height:45px;min-width:90px}#moo\_CheckoutContainer #moo-checkout-form #moo-checkout-form-btnActions .moo-finalize-order-btn,.moo\_CheckoutContainer #moo-checkout-form #moo-checkout-form-btnActions .moo-finalize-order-btn{width:100%}#moo\_CheckoutContainer #moo-checkout-form .soo-sticky-cart,.moo\_CheckoutContainer #moo-checkout-form .soo-sticky-cart{position:sticky;top:0}#moo\_CheckoutContainer .moo-edit-profile-form,.moo\_CheckoutContainer .moo-edit-profile-form{text-align:left}#moo\_CheckoutContainer .moo-edit-profile-form>div,.moo\_CheckoutContainer .moo-edit-profile-form>div{margin-bottom:10px}#moo\_CheckoutContainer .dot-flashing-2,.moo\_CheckoutContainer .dot-flashing-2{--\_g:no-repeat radial-gradient(circle closest-side,#000 90%,#0000);animation:sooDotFlashing2 1s linear infinite;aspect-ratio:2;background:var(--\_g) 0 50%,var(--\_g) 50% 50%,var(--\_g) 100% 50%;background-size:33.33333% 50%;margin:0 auto;width:60px}#moo\_CheckoutContainer .dot-flashing,.moo\_CheckoutContainer .dot-flashing{animation:sooDotFlashing .8s linear infinite alternate;animation-delay:.3s;background-color:#fff;border-radius:2.8px;color:#fff;height:6px;margin:0 auto;position:relative;width:6px}#moo\_CheckoutContainer .dot-flashing:after,#moo\_CheckoutContainer .dot-flashing:before,.moo\_CheckoutContainer .dot-flashing:after,.moo\_CheckoutContainer .dot-flashing:before{content:"";display:inline-block;position:absolute;top:0}#moo\_CheckoutContainer .dot-flashing:before,.moo\_CheckoutContainer .dot-flashing:before{animation:sooDotFlashing .8s infinite alternate;animation-delay:0s;background-color:#fff;border-radius:2.8px;color:#fff;height:6px;left:-15px;width:6px}#moo\_CheckoutContainer .dot-flashing:after,.moo\_CheckoutContainer .dot-flashing:after{animation:sooDotFlashing .8s infinite alternate;animation-delay:.8s;background-color:#fff;border-radius:2.8px;color:#fff;height:6px;left:15px;width:6px}@keyframes sooDotFlashing{0%{background-color:#fff}50%,to{background-color:hsla(0,0%,100%,.4)}}@keyframes sooDotFlashing2{20%{background-position:0 0,50% 50%,100% 50%}40%{background-position:0 100%,50% 0,100% 50%}60%{background-position:0 50%,50% 100%,100% 0}80%{background-position:0 50%,50% 50%,100% 100%}}#moo\_CheckoutContainer form,.moo\_CheckoutContainer form{margin:0}.sooMyOrders{margin-top:60px}.soo-loyalty-conditions{font-family:Soo DM Sans,sans-serif;font-size:16px;overflow:hidden;text-align:left}.soo-loyalty-conditions ul{list-style:none}.swal2-html-container{margin:15px 0 0;overflow-x:hidden}.swal2-container .swal2-center>.swal2-popup{padding:0 25px 25px}.swal2-container .fontSizeLg{font-size:1.2em}.moo-fade-in{animation:fadeIn .5s ease infinite;-webkit-animation:fadeIn .5s ease infinite;-moz-animation:fadeIn .5s ease infinite;-o-animation:fadeIn .5s ease infinite;-ms-animation:fadeIn .5s ease infinite}@keyframes sooAnmRotate{to{transform:rotate(1turn)}}@keyframes fadeIn{0%{opacity:0}to{opacity:1}}@-moz-keyframes fadeIn{0%{opacity:0}to{opacity:1}}@-webkit-keyframes fadeIn{0%{opacity:0}to{opacity:1}}@-o-keyframes fadeIn{0%{opacity:0}to{opacity:1}}@-ms-keyframes fadeIn{0%{opacity:0}to{opacity:1}} |
  |  | 1 | @font-face{font-display:swap;font-family:Soo DM Sans;font-style:normal;font-weight:400;src:url(https://fonts.gstatic.com/s/dmsans/v11/rP2Hp2ywxg089UriOZQ.ttf) format("truetype")}@font-face{font-display:swap;font-family:Soo DM Sans;font-style:normal;font-weight:500;src:url(https://fonts.gstatic.com/s/dmsans/v11/rP2Cp2ywxg089UriAWCrOB8.ttf) format("truetype")}@font-face{font-display:swap;font-family:Soo DM Sans;font-style:normal;font-weight:700;src:url(https://fonts.gstatic.com/s/dmsans/v11/rP2Cp2ywxg089UriASitOB8.ttf) format("truetype")}#moo\_CheckoutContainer,.moo\_CheckoutContainer{color:#000;font-size:14px;line-height:25px;margin:0 auto 60px;max-width:1200px;text-align:left}#moo\_CheckoutContainer .moo-error-section,.moo\_CheckoutContainer .moo-error-section{color:red}#moo\_CheckoutContainer .moo-has-error,#moo\_CheckoutContainer .moo-has-error>input,.moo\_CheckoutContainer .moo-has-error,.moo\_CheckoutContainer .moo-has-error>input{border-color:red!important;color:red!important}#moo\_CheckoutContainer #moo-checkout-form,#moo\_CheckoutContainer #moo-forgotpassword-section,#moo\_CheckoutContainer #moo-signing-section,#moo\_CheckoutContainer .moo-error-section,.moo\_CheckoutContainer #moo-checkout-form,.moo\_CheckoutContainer #moo-forgotpassword-section,.moo\_CheckoutContainer #moo-signing-section,.moo\_CheckoutContainer .moo-error-section{display:none}#moo\_CheckoutContainer .sooCheckoutTextInput,.moo\_CheckoutContainer .sooCheckoutTextInput{background:#fff none;border:.7px solid #b8b8b8;border-radius:3px;display:block;font-size:14px;height:39px;padding-left:5px;width:100%}#moo\_CheckoutContainer .sooCheckoutTextInput:focus,.moo\_CheckoutContainer .sooCheckoutTextInput:focus{border-color:#1565d8;box-shadow:none;outline:none}#moo\_CheckoutContainer .sooCheckoutTextInput[disabled],.moo\_CheckoutContainer .sooCheckoutTextInput[disabled]{background:#ececec none;border-color:#ececec;box-shadow:none}#moo\_CheckoutContainer .sooCheckoutPrimaryButtonInput,.moo\_CheckoutContainer .sooCheckoutPrimaryButtonInput{background:linear-gradient(0deg,#004fac,#004fac),linear-gradient(0deg,#cdcdcd,#cdcdcd);border:1px solid #004fac;border-radius:5px;color:#fff;cursor:pointer;font-family:Soo DM Sans,sans-serif;font-size:16px;font-weight:400;height:40px;letter-spacing:0;line-height:18px;margin-top:15px;min-height:40px;padding:10px 20px;text-align:center}#moo\_CheckoutContainer .sooCheckoutSecondaryButtonInput,.moo\_CheckoutContainer .sooCheckoutSecondaryButtonInput{background:#fff;border:1px solid #004fac;border-radius:5px;color:#004fac;cursor:pointer;font-family:Soo DM Sans,sans-serif;font-size:16px;font-weight:500;height:40px;letter-spacing:0;line-height:18px;margin-top:15px;padding:10px 20px;text-align:center}#moo\_CheckoutContainer .sooCheckoutPrimaryButtonInput:focus,#moo\_CheckoutContainer .sooCheckoutSecondaryButtonInput:focus,.moo\_CheckoutContainer .sooCheckoutPrimaryButtonInput:focus,.moo\_CheckoutContainer .sooCheckoutSecondaryButtonInput:focus{outline:none}#moo\_CheckoutContainer .soo-text-right,.moo\_CheckoutContainer .soo-text-right{text-align:right}#moo\_CheckoutContainer .soo-margin-bottom-10,.moo\_CheckoutContainer .soo-margin-bottom-10{margin-bottom:10px}#moo\_CheckoutContainer .sooBorderedArea,.moo\_CheckoutContainer .sooBorderedArea{background-color:#fff;border:.7px solid #b8b8b8;border-radius:10px;padding:25px}#moo\_CheckoutContainer #moo-checkout-form,.moo\_CheckoutContainer #moo-checkout-form{overflow:hidden}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside{background-color:#fff;border:.7px solid #b8b8b8;border-radius:10px;margin-bottom:10px;padding-bottom:15px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-customer,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-customer{min-height:130px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-customer #moo-checkout-contact-content,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-customer #moo-checkout-contact-content{display:none}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-customer #moo-checkout-contact-content .soo-contact-info,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-customer #moo-checkout-contact-content .soo-contact-info{border:.7px solid #b8b8b8;border-radius:10px;margin:8px;padding:10px 5px 5px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-customer #moo-checkout-contact-content .soo-contact-info .soo-contact-info-name,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-customer #moo-checkout-contact-content .soo-contact-info .soo-contact-info-name{color:#000;font-family:Soo DM Sans,sans-serif;font-size:16px;font-style:normal;font-weight:500;line-height:21px;padding-bottom:5px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-customer #moo-checkout-contact-content .soo-contact-info .soo-contact-info-email,#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-customer #moo-checkout-contact-content .soo-contact-info .soo-contact-info-phone,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-customer #moo-checkout-contact-content .soo-contact-info .soo-contact-info-email,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-customer #moo-checkout-contact-content .soo-contact-info .soo-contact-info-phone{color:#727272;font-family:Soo DM Sans,sans-serif;font-size:14px;font-style:normal;font-weight:400;line-height:18px;padding-bottom:5px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-customer #moo-checkout-contact-content .soo-contact-info .soo-contact-edit,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-customer #moo-checkout-contact-content .soo-contact-info .soo-contact-edit{color:#0e84e5;cursor:pointer;font-family:Soo DM Sans,sans-serif;font-size:14px;font-style:normal;font-weight:400;line-height:18px;padding-top:5px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-customer #moo-checkout-contact-content .soo-contact-info .soo-contact-logout,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-customer #moo-checkout-contact-content .soo-contact-info .soo-contact-logout{color:#0e84e5;cursor:pointer;font-family:Soo DM Sans,sans-serif;font-size:14px;font-style:normal;font-weight:400;line-height:18px;padding:5px;text-align:right}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-customer #moo-checkout-contact-form,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-customer #moo-checkout-contact-form{color:#000;display:none}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-customer #moo-checkout-contact-form .soo-contact-loginButtonContainer,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-customer #moo-checkout-contact-form .soo-contact-loginButtonContainer{margin-bottom:20px;margin-top:-40px;text-align:right}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-customer #moo-checkout-contact-form .soo-contact-login,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-customer #moo-checkout-contact-form .soo-contact-login{color:#004fac;cursor:pointer}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-customer .moo-form-group,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-customer .moo-form-group{margin-bottom:10px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes,#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments{margin-top:10px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .moo-checkout-radio-input-option,#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments .moo-checkout-radio-input-option,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .moo-checkout-radio-input-option,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments .moo-checkout-radio-input-option{padding-left:15px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .moo-checkout-radio-input,#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments .moo-checkout-radio-input,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .moo-checkout-radio-input,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments .moo-checkout-radio-input{background-color:#fff;height:25px;margin-top:8px;vertical-align:bottom;width:25px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .moo-checkout-radio-input:focus,#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments .moo-checkout-radio-input:focus,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .moo-checkout-radio-input:focus,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments .moo-checkout-radio-input:focus{outline:none}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .moo-checkout-radio-input-label,#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments .moo-checkout-radio-input-label,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .moo-checkout-radio-input-label,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments .moo-checkout-radio-input-label{color:#000;cursor:pointer;display:inline;font-family:Soo DM Sans,sans-serif;font-size:17px;font-weight:400;letter-spacing:0;line-height:20px;padding-left:7px;text-align:left;vertical-align:middle}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-checkout-radio-input-option,#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments .soo-checkout-radio-input-option,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-checkout-radio-input-option,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments .soo-checkout-radio-input-option{padding-left:15px;padding-top:7px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-checkout-radio-input,#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments .soo-checkout-radio-input,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-checkout-radio-input,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments .soo-checkout-radio-input{-webkit-appearance:none;appearance:none;background:#fff no-repeat 50%;border:1px solid #000;border-radius:50%;cursor:pointer;height:26px;margin:calc(.75em - 11px) .25rem 0 0;padding:0;vertical-align:top;width:26px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-checkout-radio-input:focus,#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments .soo-checkout-radio-input:focus,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-checkout-radio-input:focus,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments .soo-checkout-radio-input:focus{border-color:#ddd;outline:none}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-checkout-radio-input:disabled,#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments .soo-checkout-radio-input:disabled,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-checkout-radio-input:disabled,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments .soo-checkout-radio-input:disabled{background:#eee}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-checkout-radio-input:checked,#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments .soo-checkout-radio-input:checked,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-checkout-radio-input:checked,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments .soo-checkout-radio-input:checked{background-image:url(radio.svg);border:2px solid #004fac}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-add-delivery-address-form,#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-add-delivery-address-form,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses{display:none}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-add-delivery-address-form,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-add-delivery-address-form{border:.7px solid #b8b8b8;border-radius:10px;margin-top:15px;padding:20px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-add-delivery-address-form .sooCheckoutPrimaryButtonInput,#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-add-delivery-address-form .sooCheckoutSecondaryButtonInput,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-add-delivery-address-form .sooCheckoutPrimaryButtonInput,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-add-delivery-address-form .sooCheckoutSecondaryButtonInput{width:100px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses{border:.7px solid #b8b8b8;border-radius:10px;margin-top:15px;padding:20px 20px 10px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses .soo-addresses-wrapper,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses .soo-addresses-wrapper{position:relative}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses .soo-addresses-wrapper .soo-estimate-loader,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses .soo-addresses-wrapper .soo-estimate-loader{background-color:#fff;display:none;height:100%;opacity:0;position:absolute;width:100%}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses .soo-addresses-wrapper .soo-addresses-title,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses .soo-addresses-wrapper .soo-addresses-title{color:#000;font-weight:600;padding-bottom:8px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses .soo-addresses-wrapper .soo-one-address,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses .soo-addresses-wrapper .soo-one-address{border:.7px solid #b8b8b8;border-radius:5px;color:#727272;cursor:pointer;font-family:Soo DM Sans,sans-serif;font-size:14px;font-style:normal;font-weight:400;line-height:18px;margin-bottom:5px;padding:15px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses .soo-addresses-wrapper .soo-one-address .soo-one-address-name,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses .soo-addresses-wrapper .soo-one-address .soo-one-address-name{color:#000;font-weight:500}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses .soo-addresses-wrapper .soo-one-address .soo-one-address-line1,#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses .soo-addresses-wrapper .soo-one-address .soo-one-address-line2,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses .soo-addresses-wrapper .soo-one-address .soo-one-address-line1,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses .soo-addresses-wrapper .soo-one-address .soo-one-address-line2{width:90%}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses .soo-addresses-wrapper .soo-one-address .soo-address-error,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses .soo-addresses-wrapper .soo-one-address .soo-address-error{color:red;font-weight:500;margin-top:10px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses .soo-addresses-wrapper .soo-one-address .soo-delivery-amount,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses .soo-addresses-wrapper .soo-one-address .soo-delivery-amount{color:#004fac;font-weight:500;height:0;position:relative;text-align:right;top:-38px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses .soo-addresses-wrapper .soo-one-address .soo-delivery-amount>svg,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses .soo-addresses-wrapper .soo-one-address .soo-delivery-amount>svg{fill:#004fac;animation:sooAnmRotate .6s linear infinite}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses .soo-addresses-wrapper .soo-selected,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses .soo-addresses-wrapper .soo-selected{background:#f0f5fc;border:.7px solid #1565d887}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses .soo-addresses-wrapper .soo-selected-warning,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses .soo-addresses-wrapper .soo-selected-warning{background-color:#ffc!important;border:.7px solid #ccc;color:#000!important}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses .soo-addresses-wrapper .soo-selected-error,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses .soo-addresses-wrapper .soo-selected-error{background-color:#fdd!important;border:.7px solid #ccc;color:#000!important}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses .soo-add-new-address-button,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses .soo-add-new-address-button{color:#004fac;font-family:Soo DM Sans,sans-serif;font-size:14px;font-style:normal;font-weight:400;line-height:18px;padding-top:20px;text-align:right}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses .soo-add-new-address-button>span,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses .soo-add-new-address-button>span{cursor:pointer}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-orderdate,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-orderdate{margin-top:10px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments .clover-error,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments .clover-error{color:red}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments #moo-cloverCreditCardPanel,#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments #moo-cloverGiftCardPanel,#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments #mooGooglePaySection,#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments #moo\_cashPanel,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments #moo-cloverCreditCardPanel,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments #moo-cloverGiftCardPanel,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments #mooGooglePaySection,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments #moo\_cashPanel{border:.7px solid #b8b8b8;border-radius:10px;display:none;margin-top:15px;padding:20px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments #moo-cloverCreditCardPanel,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments #moo-cloverCreditCardPanel{padding-bottom:10px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments #moo-cloverCreditCardPanel #moo\_CloverCardCvv,#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments #moo-cloverCreditCardPanel #moo\_CloverCardDate,#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments #moo-cloverCreditCardPanel #moo\_CloverCardNumber,#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments #moo-cloverCreditCardPanel #moo\_CloverCardZip,#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments #moo-cloverCreditCardPanel #moo\_CloverStreetAddress,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments #moo-cloverCreditCardPanel #moo\_CloverCardCvv,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments #moo-cloverCreditCardPanel #moo\_CloverCardDate,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments #moo-cloverCreditCardPanel #moo\_CloverCardNumber,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments #moo-cloverCreditCardPanel #moo\_CloverCardZip,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments #moo-cloverCreditCardPanel #moo\_CloverStreetAddress{border-radius:5px;height:45px;margin-bottom:10px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments #moo-cloverGiftCardPanel,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments #moo-cloverGiftCardPanel{border:none;padding:0}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments #moo-cloverGiftCardPanel #moo\_CloverGiftCard,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments #moo-cloverGiftCardPanel #moo\_CloverGiftCard{min-height:100px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments #moo\_cashPanel .soo-phone-verif-title,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments #moo\_cashPanel .soo-phone-verif-title{color:#000;margin-bottom:10px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments #moo\_cashPanel .soo-phone-input,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments #moo\_cashPanel .soo-phone-input{display:none}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments #moo\_cashPanel .soo-phone-input>input,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments #moo\_cashPanel .soo-phone-input>input{float:left;width:70%}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments #moo\_cashPanel .soo-phone-input>button,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments #moo\_cashPanel .soo-phone-input>button{clear:both;margin:0 0 0 10px;width:25%}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments #moo\_cashPanel .soo-phone-button,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments #moo\_cashPanel .soo-phone-button{text-align:center}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments #moo\_cashPanel .soo-phone-button>button,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments #moo\_cashPanel .soo-phone-button>button{width:70%}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-coupon,#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-instruction,#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-tips,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-coupon,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-instruction,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-tips{margin-top:10px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-coupon div.moo-checkout-bloc-content>div>div.moo-col-xs-3,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-coupon div.moo-checkout-bloc-content>div>div.moo-col-xs-3{padding:0 10px 0 0}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-coupon div.moo-checkout-bloc-content>div>div>div>button,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-coupon div.moo-checkout-bloc-content>div>div>div>button{margin:0;padding:10px 12px;width:100%}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-coupon div>button.sooDeleteCouponButton.sooCheckoutPrimaryButtonInput,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-coupon div>button.sooDeleteCouponButton.sooCheckoutPrimaryButtonInput{display:none;width:100%}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty{margin-top:10px;min-height:135px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty>div.moo-checkout-bloc-content,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty>div.moo-checkout-bloc-content{margin-top:23px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .sooRemovePointsButton,#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .usePointsInput,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .sooRemovePointsButton,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .usePointsInput{display:none}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .usePointsInput,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .usePointsInput{margin-top:30px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .usePointsInput .moo-error-section,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .usePointsInput .moo-error-section{margin-top:7px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .usePointsInput .sooToPayInfo,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .usePointsInput .sooToPayInfo{margin-top:8px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .usePointsInput .sooValidatePoints,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .usePointsInput .sooValidatePoints{padding:0}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .usePointsInput .sooValidatePoints .sooEditPointsButton,#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .usePointsInput .sooValidatePoints .sooValidatePointsButton,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .usePointsInput .sooValidatePoints .sooEditPointsButton,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .usePointsInput .sooValidatePoints .sooValidatePointsButton{font-size:16px;line-height:16px;margin:0;min-height:15px;padding:10px;width:70%}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .usePointsInput .sooValidatePoints .sooEditPointsButton,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .usePointsInput .sooValidatePoints .sooEditPointsButton{display:none}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .usePointsInput .sooValidatePoints .sooLoyaltyDetailsButton svg,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .usePointsInput .sooValidatePoints .sooLoyaltyDetailsButton svg{cursor:pointer;height:30px;vertical-align:middle;width:30px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .usePointsInput #sooSelectedPointsValue,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .usePointsInput #sooSelectedPointsValue{padding-left:10px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .loyaltyIcon>img,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .loyaltyIcon>img{width:50px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .loyaltyButtons,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .loyaltyButtons{padding:0 10px 0 0;text-align:right}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .loyaltyButtons .sooRemovePointsButton,#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .loyaltyButtons .sooUsePointsButton,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .loyaltyButtons .sooRemovePointsButton,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .loyaltyButtons .sooUsePointsButton{font-weight:400;margin:0;padding:10px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .loyaltyButtons .sooRemovePointsButton,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .loyaltyButtons .sooRemovePointsButton{font-size:13px;padding:7px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .loyaltyBalance,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .loyaltyBalance{padding:0}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .loyaltyBalance .balance,#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .loyaltyBalance .balanceTitle,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .loyaltyBalance .balance,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .loyaltyBalance .balanceTitle{color:rgba(0,0,0,.63);font-family:Soo DM Sans,sans-serif;font-size:14px;font-weight:400;letter-spacing:0;line-height:18px;text-align:left}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .loyaltyBalance .balance,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .loyaltyBalance .balance{color:#000}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .loyaltyBalance .balance>.balancePoints,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .loyaltyBalance .balance>.balancePoints{font-size:18px;font-weight:500;line-height:23px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .loyaltyBalance .loyaltyButtons,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .loyaltyBalance .loyaltyButtons{font-weight:400;text-align:right}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside .moo-checkout-bloc-title,#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside .moo-checkout-bloc-title>label,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside .moo-checkout-bloc-title,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside .moo-checkout-bloc-title>label{color:#000;font-family:Soo DM Sans,sans-serif;font-size:18px;font-style:normal;font-weight:500;line-height:30px;margin-bottom:10px;margin-top:10px;text-transform:none}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside .moo\_checkout\_border\_bottom,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside .moo\_checkout\_border\_bottom{border-bottom:1px solid #eee;margin-left:-15px;margin-right:-15px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-cart,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-cart{background-color:#fff;border:.7px solid #b8b8b8;border-radius:10px;color:#000;font-family:Soo DM Sans,sans-serif;font-size:15px;padding:0}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-cart .moo-shopping-cart-title,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-cart .moo-shopping-cart-title{border-bottom:.7px solid #b8b8b8;color:#000;font-family:Soo DM Sans,sans-serif;font-size:18px;font-style:normal;font-weight:500;line-height:30px;padding:13px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-cart .moo-shopping-cart-line,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-cart .moo-shopping-cart-line{margin-bottom:5px;margin-top:5px;padding-left:10px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-cart .moo-shopping-cart-line .moo-scl-qty,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-cart .moo-shopping-cart-line .moo-scl-qty{text-align:center}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-cart .moo-shopping-cart-line .moo-scl-item,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-cart .moo-shopping-cart-line .moo-scl-item{padding:0}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-cart .moo-shopping-cart-line .moo-scl-item .moo-scl-itemName,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-cart .moo-shopping-cart-line .moo-scl-item .moo-scl-itemName{font-family:Soo DM Sans,sans-serif;font-size:16px;font-weight:400;letter-spacing:0;line-height:20px;margin-top:3px;text-align:left}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-cart .moo-shopping-cart-line .moo-scl-item .moo-scl-itemModifiers,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-cart .moo-shopping-cart-line .moo-scl-item .moo-scl-itemModifiers{font-family:Soo DM Sans,sans-serif;font-size:15px;font-weight:400;letter-spacing:0;line-height:16px;text-align:left}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-cart .moo-shopping-cart-line .moo-scl-itemPrice,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-cart .moo-shopping-cart-line .moo-scl-itemPrice{padding-left:0;padding-right:20px;text-align:right}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-cart .moo-totals,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-cart .moo-totals{border-top:.7px solid #b8b8b8;color:#000;font-family:Soo DM Sans,sans-serif;font-size:13px;font-weight:400;letter-spacing:0;overflow:auto;padding:10px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-cart .moo-totals .moo-totals-item,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-cart .moo-totals .moo-totals-item{clear:both;float:right;margin-bottom:0;width:100%}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-cart .moo-totals .moo-totals-item .moo-totals-value,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-cart .moo-totals .moo-totals-item .moo-totals-value{float:right;text-align:right;width:30%}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-cart .moo-totals .moo-totals-item label,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-cart .moo-totals .moo-totals-item label{clear:both;float:left;text-align:right;width:70%}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-cart .moo-totals #sooCouponTotalSection,#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-cart .moo-totals #sooDeliveryFeeTotalSection,#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-cart .moo-totals #sooPointsTotalSection,#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-cart .moo-totals #sooServiceFeeTotalSection,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-cart .moo-totals #sooCouponTotalSection,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-cart .moo-totals #sooDeliveryFeeTotalSection,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-cart .moo-totals #sooPointsTotalSection,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-cart .moo-totals #sooServiceFeeTotalSection{display:none}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-links a,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-links a{color:#004fac;font-size:12px;text-align:center;text-decoration:none}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-links a:visited,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-links a:visited{color:#004fac}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-links a:focus,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-links a:focus{outline:none}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-links .moo-checkoutText-updateCart,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-links .moo-checkoutText-updateCart{float:left}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-links .moo-checkoutText-continueShopping,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-links .moo-checkoutText-continueShopping{float:right}#moo\_CheckoutContainer #moo-checkout-form #moo-checkout-form-btnActions #moo-cloverGooglePay,.moo\_CheckoutContainer #moo-checkout-form #moo-checkout-form-btnActions #moo-cloverGooglePay{display:none;height:45px;min-width:90px}#moo\_CheckoutContainer #moo-checkout-form #moo-checkout-form-btnActions .moo-finalize-order-btn,.moo\_CheckoutContainer #moo-checkout-form #moo-checkout-form-btnActions .moo-finalize-order-btn{width:100%}#moo\_CheckoutContainer #moo-checkout-form .soo-sticky-cart,.moo\_CheckoutContainer #moo-checkout-form .soo-sticky-cart{position:sticky;top:0}#moo\_CheckoutContainer .moo-edit-profile-form,.moo\_CheckoutContainer .moo-edit-profile-form{text-align:left}#moo\_CheckoutContainer .moo-edit-profile-form>div,.moo\_CheckoutContainer .moo-edit-profile-form>div{margin-bottom:10px}#moo\_CheckoutContainer .dot-flashing-2,.moo\_CheckoutContainer .dot-flashing-2{--\_g:no-repeat radial-gradient(circle closest-side,#000 90%,#0000);animation:sooDotFlashing2 1s linear infinite;aspect-ratio:2;background:var(--\_g) 0 50%,var(--\_g) 50% 50%,var(--\_g) 100% 50%;background-size:33.33333% 50%;margin:0 auto;width:60px}#moo\_CheckoutContainer .dot-flashing,.moo\_CheckoutContainer .dot-flashing{animation:sooDotFlashing .8s linear infinite alternate;animation-delay:.3s;background-color:#fff;border-radius:2.8px;color:#fff;height:6px;margin:0 auto;position:relative;width:6px}#moo\_CheckoutContainer .dot-flashing:after,#moo\_CheckoutContainer .dot-flashing:before,.moo\_CheckoutContainer .dot-flashing:after,.moo\_CheckoutContainer .dot-flashing:before{content:"";display:inline-block;position:absolute;top:0}#moo\_CheckoutContainer .dot-flashing:before,.moo\_CheckoutContainer .dot-flashing:before{animation:sooDotFlashing .8s infinite alternate;animation-delay:0s;background-color:#fff;border-radius:2.8px;color:#fff;height:6px;left:-15px;width:6px}#moo\_CheckoutContainer .dot-flashing:after,.moo\_CheckoutContainer .dot-flashing:after{animation:sooDotFlashing .8s infinite alternate;animation-delay:.8s;background-color:#fff;border-radius:2.8px;color:#fff;height:6px;left:15px;width:6px}@keyframes sooDotFlashing{0%{background-color:#fff}50%,to{background-color:hsla(0,0%,100%,.4)}}@keyframes sooDotFlashing2{20%{background-position:0 0,50% 50%,100% 50%}40%{background-position:0 100%,50% 0,100% 50%}60%{background-position:0 50%,50% 100%,100% 0}80%{background-position:0 50%,50% 50%,100% 100%}}#moo\_CheckoutContainer form,.moo\_CheckoutContainer form{margin:0}.sooMyOrders{margin-top:60px}.soo-loyalty-conditions{font-family:Soo DM Sans,sans-serif;font-size:16px;overflow:hidden;text-align:left}.soo-loyalty-conditions ul{list-style:none}.swal2-html-container{margin:15px 0 0;overflow-x:hidden}.swal2-container .swal2-center>.swal2-popup{padding:0 25px 25px}.swal2-container .fontSizeLg{font-size:1.2em}.moo-fade-in{animation:fadeIn .5s ease infinite;-webkit-animation:fadeIn .5s ease infinite;-moz-animation:fadeIn .5s ease infinite;-o-animation:fadeIn .5s ease infinite;-ms-animation:fadeIn .5s ease infinite}@keyframes sooAnmRotate{to{transform:rotate(1turn)}}@keyframes fadeIn{0%{opacity:0}to{opacity:1}}@-moz-keyframes fadeIn{0%{opacity:0}to{opacity:1}}@-webkit-keyframes fadeIn{0%{opacity:0}to{opacity:1}}@-o-keyframes fadeIn{0%{opacity:0}to{opacity:1}}@-ms-keyframes fadeIn{0%{opacity:0}to{opacity:1}} |
* ## [clover-online-orders/trunk/public/js/dist/sooCheckout.min.js](/changeset/3168433/clover-online-orders/trunk/public/js/dist/sooCheckout.min.js "Show the changeset 3168433 restricted to clover-online-orders/trunk/public/js/dist/sooCheckout.min.js")

  | [r2986704](/browser/clover-online-orders/trunk/public/js/dist/sooCheckout.min.js?rev=2986704#L27 "Show revision 2986704 of this file in browser") | [r3168433](/browser/clover-online-orders/trunk/public/js/dist/sooCheckout.min.js?rev=3168433#L27 "Show revision 3168433 of this file in browser") |  |
  | --- | --- | --- |
  | 27 | 27 | </div> |
  | 28 | 28 | </div> |
  | 29 |  | </div></div>`;Swal.fire({title:"Edit Your Profile",html:form,showCancelButton:true,cancelButtonText:mooObjectL10n.cancel,confirmButtonText:mooObjectL10n.edit,showLoaderOnConfirm:true,preConfirm:()=>{const firstName=Swal.getPopup().querySelector("#sooContactFirstName").value;const lastName=Swal.getPopup().querySelector("#sooContactLastName").value;const email=Swal.getPopup().querySelector("#sooContactEmail").value;const phone=Swal.getPopup().querySelector("#sooContactPhone").value;if(firstName===""){Swal.showValidationMessage("Your name is required");return}if(email===""){Swal.showValidationMessage("Your email is required");return}if(phone===""){Swal.showValidationMessage("Your phone is required");return}const token=localStorage.getItem("customerJwtToken");return fetch(sooCheckout.options.restApiUrl+"moo-clover/v2/customers/me",{method:"POST",mode:"cors",cache:"no-cache",credentials:"same-origin",headers:{"Content-Type":"application/json",Authorization:"Bearer "+token},redirect:"follow",referrerPolicy:"no-referrer",body:JSON.stringify({email:email,first\_name:firstName,last\_name:lastName,phone:phone})}).then(response=>{return response.json()}).then(data=>{if(data.message){throw new Error(data.message)}else{if(data===false){throw new Error(mooObjectL10n.anErrorOccurred)}return data}}).catch(error=>{Swal.showValidationMessage(error)})},allowOutsideClick:false}).then(function(data){if(data.value){localStorage.setItem("loggedInCustomer",JSON.stringify(data.value));mooCheckout.loggedInCustomer=data.value;mooCheckout.fillCustomerInfo()}},function(data){if(data.dismiss==="cancel"){Swal.close()}})},logout:function(e){e.preventDefault();mooCheckout.loggedInCustomer=null;mooCheckout.loggedInCustomer=null;localStorage.removeItem("customerJwtToken");localStorage.removeItem("loggedInCustomer");this.uncheckSelectedOrderingMethod();this.uncheckSelectedPaymentMethod();this.updateTotals();this.showLoginSection();return false},continueAsGuest:function(e){e.preventDefault();mooGlobalParams.isGuest=true;history.pushState({},"Checkout");this.showCheckoutDetails();return false},hideLoadingCheckout(){$("#moo-checkout>#moo-login-section > div.sooOverlayLoader").hide()},showOrHideASection(section,show){$("div.moo-section").hide();const elem=$("#moo-"+section);if(show){elem.show()}else{elem.hide()}},showLoginSection(section,show){$("#sooAuthSection").show();$("div.moo-section").hide();$("#moo-login-section").show()},isCustomerLoggedIn(){return localStorage.getItem("customerJwtToken")!==null},getLoggedInCustomer(){if(localStorage.getItem("loggedInCustomer")){let customer=JSON.parse(localStorage.getItem("loggedInCustomer"));mooCheckout.loggedInCustomer=customer;return customer}return null},getGuestInfo(){const firstName=$("#MooContactFirstName").val();const lastName=$("#MooContactLastName").val();const email=$("#MooContactEmail").val();const phone=$("#MooContactPhone").val();return{first\_name:firstName.trim(),last\_name:lastName.trim(),email:email.trim(),phone:phone.trim(),isPhoneVerified:mooGlobalParams.isGuestPhoneVerified,address:this.getSelectedAddress(),full\_address:this.getSelectedAddressAsString()}},syncLoggedInCustomerProfile(){this.getCustomerProfile().then(async function(response){if(!response.ok){const message=`An error has occured: ${response.status}`;throw new Error(message)}return await response.json()}).then(data=>{localStorage.setItem("loggedInCustomer",JSON.stringify(data));mooCheckout.loggedInCustomer=data}).catch(error=>{console.log(error)})},getCustomerProfile(){let token=localStorage.getItem("customerJwtToken");return fetch(sooCheckout.options.restApiUrl+"moo-clover/v2/customers/me",{method:"GET",mode:"cors",cache:"no-cache",headers:{"Content-Type":"application/json",Authorization:"Bearer "+token},redirect:"follow",referrerPolicy:"no-referrer"})},fillCustomerInfo(){if(mooGlobalParams.isGuest){$("#moo-checkout-contact-form").show();$("#moo-checkout-contact-content").hide()}else{let customer=this.getLoggedInCustomer();if(customer){let name=null;if(customer.first\_name){name=customer.first\_name}if(customer.last\_name){name+=" "+customer.last\_name}if(!name){name=" "+customer.full\_name}$("#moo-checkout-contact-content .soo-contact-info-name").text(name);if(customer.is\_email\_verified){$("#moo-checkout-contact-content .soo-contact-info-email").text(customer.email+" ✓ ")}else{$("#moo-checkout-contact-content .soo-contact-info-email").text(customer.email)}if(customer.is\_phone\_verified){$("#moo-checkout-contact-content .soo-contact-info-phone").text(customer.phone+" ✓ ")}else{if(customer.phone===""){$("#moo-checkout-contact-content .soo-contact-info-phone").text("Phone not provided")}else{$("#moo-checkout-contact-content .soo-contact-info-phone").text(customer.phone)}}$("#moo-checkout-contact-form").hide();$("#moo-checkout-contact-content").show()}else{console.log("Can't get the customer, he must login again");this.showLoginSection()}}},fillCustomerPointsBalance(){let customer=this.getLoggedInCustomer();if(customer){let balance=0;let balanceUsdValue=0;if(customer.point\_count){balance=customer.point\_count;balanceUsdValue=this.getValueOfPoints(balance)}$("#moo-checkout-form-loyalty .loyaltyBalance > div.balance > span.balancePoints").text(balance+" "+mooGlobalParams.pointsLabel);$("#moo-checkout-form-loyalty .loyaltyBalance > div.balance > span.balanceAmount").text(this.formatPrice(balanceUsdValue));if(balance<=0){$("#moo-checkout-form-loyalty .loyaltyButtons > button.sooUsePointsButton").html("Loyalty Conditions").attr("onclick","mooCheckout.openLoyaltyDetails()").css("padding","2px");$("#moo-checkout-form-loyalty .loyaltyButtons").removeClass("moo-col-xs-4").addClass("moo-col-xs-6");$("#moo-checkout-form-loyalty .loyaltyBalance").removeClass("moo-col-xs-6").addClass("moo-col-xs-4")}}else{console.log("Can't get the customer, he must login again")}},shouldVerifyPhone:function(){if(!sooCheckout.options.useSmsVerification){return false}else{if(mooGlobalParams.isGuest){return mooGlobalParams.isGuestPhoneVerified===false}else{const customer=this.getLoggedInCustomer();if(customer){return customer.is\_phone\_verified===false}else{this.syncLoggedInCustomerProfile();return true}}}},loggedInCustomerPhoneIsVerified:function(){const customer=this.getLoggedInCustomer();if(customer){return customer.is\_phone\_verified}else{this.syncLoggedInCustomerProfile();return false}},isMobile:function(){if(/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)){return true}return false},getSelectedPaymentMethod:function(){var elm=$('#moo-checkout-form-payments input[name="paymentMethod"]:checked');if(elm.length>0&&elm.val()!==""){return elm.val()}return null},getSelectedOrderingMethod:function(){var elm=$('#moo-checkout-form-ordertypes input[name="ordertype"]:checked');if(elm.length){return elm.val()}return null},countAvailableOrderingMethods:function(){const elmOrderingMethods=$('#moo-checkout-form-ordertypes input[name="ordertype"]');const elmDisabledOrderingMethods=$('#moo-checkout-form-ordertypes input[name="ordertype"]:disabled');if(elmOrderingMethods.length){if(elmDisabledOrderingMethods.length){return elmOrderingMethods.length-elmDisabledOrderingMethods.length}else{return elmOrderingMethods.length}}else{return 0}},countAvailablePaymentMethods:function(){const elmPaymentMethods=$('#moo-checkout-form-payments input[name="paymentMethod"]');if(elmPaymentMethods.length){return elmPaymentMethods.length}else{return 0}},uncheckSelectedOrderingMethod:function(){const elm=$('#moo-checkout-form-ordertypes input[name="ordertype"]:checked');if(elm.length){elm.removeAttr("checked")}mooGlobalParams.selectedOrderType=null;mooGlobalParams.selectedAddress=null;mooGlobalParams.deliveryFees=null;mooGlobalParams.isDeliveryOrder=false;this.hideAddressSection();this.hideDeliveryAmount()},uncheckSelectedPaymentMethod:function(){const elm=$('#moo-checkout-form-payments input[name="paymentMethod"]:checked');if(elm.length){elm.removeAttr("checked")}this.hidePhoneVerificationSection();$("#moo-cloverCreditCardPanel").hide()},getCustomer:function(){if(mooGlobalParams.isGuest){return this.getGuestInfo()}else{const customer=this.getLoggedInCustomer();return{first\_name:customer.first\_name,last\_name:customer.last\_name,email:customer.email,phone:customer.phone,isPhoneVerified:customer.is\_phone\_verified,address:this.getSelectedAddress(),full\_address:this.getSelectedAddressAsString()}}},getTipAmount:function(){if(isNaN(mooGlobalParams.tipAmount)||mooCheckout.getSelectedPaymentMethod()==="cash"){return 0}return mooGlobalParams.tipAmount},getSelectedAddress:function(){return mooGlobalParams.selectedAddress},getSelectedAddressAsString:function(){var address=this.getSelectedAddress();var address\_string="";if(address){if(address.address)address\_string+=address.address+" ";if(address.line2)address\_string+=address.line2+" ";if(address.city)address\_string+=address.city+", ";if(address.state)address\_string+=address.state+" ";if(address.zipcode)address\_string+=address.zipcode}return address\_string},addNewAddress:function(e){e.preventDefault();if(mooCheckout.addAddressForm.data("submitted")===true){return false}else{mooCheckout.startSubmitingAform(mooCheckout.addAddressForm)}const formElements={fullNameInput:mooCheckout.addAddressForm.find("#sooAddAddressName"),addressInput:mooCheckout.addAddressForm.find("#sooAddAddressLine1"),line2Input:mooCheckout.addAddressForm.find("#sooAddAddressLine2"),cityInput:mooCheckout.addAddressForm.find("#sooAddAddressCity"),stateInput:mooCheckout.addAddressForm.find("#sooAddAddressState"),zipCodeInput:mooCheckout.addAddressForm.find("#sooAddAddressZipCode")};const requiredField=["addressInput","cityInput","stateInput","zipCodeInput"];for(const el in formElements){if(requiredField.includes(el)&&!formElements[el].val()){formElements[el].parent().addClass("moo-has-error");formElements[el].next().show();formElements[el].focus();mooCheckout.finishSubmitingAform(mooCheckout.addAddressForm);return}}mooGlobalParams.selectedAddress={full\_name:formElements.fullNameInput.val().trim(),address:formElements.addressInput.val().trim(),line2:formElements.line2Input.val().trim(),city:formElements.cityInput.val().trim(),state:formElements.stateInput.val().trim(),zipcode:formElements.zipCodeInput.val().trim()};if(mooGlobalParams.isGuest){if(mooGlobalParams.selectedOrderType){if(mooGlobalParams.selectedOrderType.ot\_uuid==="onDemandDelivery"){mooCheckout.finishSubmitingAform(mooCheckout.addAddressForm);mooCheckout.showListOfAddresses()}else{$.ajax({type:"POST",cache:false,url:sooCheckout.options.restApiUrl+"moo-clover/v3/geocode-address",headers:{"Content-Type":"application/json"},data:JSON.stringify(mooGlobalParams.selectedAddress)}).done(function(response){mooGlobalParams.selectedAddress.lat=response.lat;mooGlobalParams.selectedAddress.lng=response.lng;mooCheckout.finishSubmitingAform(mooCheckout.addAddressForm);const res=mooCheckout.calculateDeliveryFees(mooGlobalParams.selectedAddress.lat,mooGlobalParams.selectedAddress.lng);if(res.result==="zone\_error"){mooCheckout.showErrorAlert(res.message,"")}else{mooCheckout.showListOfAddresses()}}).fail(function(response){mooCheckout.finishSubmitingAform(mooCheckout.addAddressForm);let errorMsg="";if(response.responseJSON&&response.responseJSON.message){errorMsg=response.responseJSON.message}else{errorMsg=mooObjectL10n.anErrorOccurred}mooCheckout.showErrorAlert(errorMsg,mooObjectL10n.tryAgain);mooGlobalParams.selectedAddress=null})}}else{mooCheckout.showErrorAlert(mooObjectL10n.error,"Select an Ordering Method")}}else{let token=localStorage.getItem("customerJwtToken");if(!token){console.log("token not found")}$.ajax({type:"POST",cache:false,url:sooCheckout.options.restApiUrl+"moo-clover/v3/customers/addresses",headers:{"Content-Type":"application/json",Authorization:"Bearer "+token},data:JSON.stringify(mooGlobalParams.selectedAddress)}).done(function(address){if(address.id){mooCheckout.finishSubmitingAform(mooCheckout.addAddressForm);if(mooCheckout.loggedInCustomer.addresses.length>0){mooCheckout.loggedInCustomer.addresses.push(address)}else{mooCheckout.loggedInCustomer.addresses=[address]}mooCheckout.showListOfAddresses()}else{mooCheckout.showErrorAlert(mooObjectL10n.anErrorOccurred,"")}}).fail(function(data){mooCheckout.finishSubmitingAform(mooCheckout.addAddressForm);let errorMsg="";if(data.responseJSON&&data.responseJSON.message){errorMsg=data.responseJSON.message}else{errorMsg=mooObjectL10n.anErrorOccurred}mooCheckout.showErrorAlert(errorMsg,mooObjectL10n.tryAgain)})}},fillAddressToEdit:function(){if(mooGlobalParams.selectedAddress){const formElements={fullNameInput:mooCheckout.addAddressForm.find("#sooAddAddressName"),addressInput:mooCheckout.addAddressForm.find("#sooAddAddressLine1"),line2Input:mooCheckout.addAddressForm.find("#sooAddAddressLine2"),cityInput:mooCheckout.addAddressForm.find("#sooAddAddressCity"),stateInput:mooCheckout.addAddressForm.find("#sooAddAddressState"),zipCodeInput:mooCheckout.addAddressForm.find("#sooAddAddressZipCode")};if(mooGlobalParams.selectedAddress.full\_name){formElements.fullNameInput.val(mooGlobalParams.selectedAddress.full\_name)}if(mooGlobalParams.selectedAddress.address){formElements.addressInput.val(mooGlobalParams.selectedAddress.address)}if(mooGlobalParams.selectedAddress.line2){formElements.line2Input.val(mooGlobalParams.selectedAddress.line2)}if(mooGlobalParams.selectedAddress.city){formElements.cityInput.val(mooGlobalParams.selectedAddress.city)}if(mooGlobalParams.selectedAddress.state){formElements.stateInput.val(mooGlobalParams.selectedAddress.state)}if(mooGlobalParams.selectedAddress.zipcode){formElements.zipCodeInput.val(mooGlobalParams.selectedAddress.zipcode)}}},setAddress:function(address){localStorage.setItem("selectedAddress",JSON.stringify(address))},isPhoneVerificationActivated:function(){return sooCheckout.options.useSmsVerification},orderTypeChanged:function(){if(mooGlobalParams.selectedOrderType&&mooCheckout.getSelectedOrderingMethod()===mooGlobalParams.selectedOrderType.ot\_uuid){console.log("order type not changed");return}mooGlobalParams.selectedOrderType=mooCheckout.getOneOrderType(mooCheckout.getSelectedOrderingMethod());if(mooGlobalParams.selectedOrderType){const orderType=mooGlobalParams.selectedOrderType;mooGlobalParams.deliveryFees=0;if(this.isTrue(mooGlobalParams.selectedOrderType.allow\_sc\_order)&&sooCheckout.options.allowScOrder){mooGlobalParams.allowScOrders=true;this.showOrderingTime()}else{mooGlobalParams.allowScOrders=false;this.hideOrderingTime()}if(this.isTrue(mooGlobalParams.selectedOrderType.show\_sa)){mooGlobalParams.isDeliveryOrder=true;this.showListOfAddresses();this.showDeliveryAmount();if(mooGlobalParams.allowScOrders){this.changeOrderingTimes("delivery")}if(sooCheckout.options.cashUponDelivery&&orderType.ot\_uuid!=="onDemandDelivery"){$("#moo-checkout-form-payincash-label").text(mooObjectL10n.payUponDelivery);this.showCashPayment()}else{this.hideCashPayment()}}else{mooGlobalParams.isDeliveryOrder=false;mooGlobalParams.deliveryFees=0;mooGlobalParams.selectedAddress=null;this.hideAddressSection();this.hideDeliveryAmount();if(mooGlobalParams.allowScOrders){this.changeOrderingTimes("pickup")}if(sooCheckout.options.cashInStore){$("#moo-checkout-form-payincash-label").text(mooObjectL10n.payAtlocation);this.showCashPayment()}else{this.hideCashPayment()}}if(this.isTrue(mooGlobalParams.selectedOrderType.use\_coupons)){this.showCouponsSection()}else{this.hideCouponsSection()}this.updateTotals()}else{console.log("No OrderType found")}},paymentMethodChanged:function(){const selectedPaymentMethod=mooCheckout.getSelectedPaymentMethod();if(selectedPaymentMethod==="cash"){this.hideTipSection();$("#moo-cloverCreditCardPanel").hide();$("#moo-cloverGiftCardPanel").hide();if(this.shouldVerifyPhone()){this.showPhoneVerificationSection()}$("#moo\_btn\_submit\_order").show();$("#moo-cloverGooglePay").hide();$("#mooGooglePaySection").hide()}if(selectedPaymentMethod==="clover"){this.showTipSection();this.hidePhoneVerificationSection();$("#moo-cloverGiftCardPanel").hide();$("#moo\_btn\_submit\_order").show();$("#moo-cloverGooglePay").hide();$("#mooGooglePaySection").hide();$("#moo-cloverCreditCardPanel").show()}if(selectedPaymentMethod==="giftcard"){this.showTipSection();$("#moo-cloverCreditCardPanel").hide();this.hidePhoneVerificationSection();$("#moo-cloverGiftCardPanel").show();$("#moo\_btn\_submit\_order").show();$("#moo-cloverGooglePay").hide();$("#mooGooglePaySection").hide()}if(selectedPaymentMethod==="googlepay"){this.showTipSection();$("#moo-cloverCreditCardPanel").hide();this.hidePhoneVerificationSection();$("#moo-cloverGiftCardPanel").hide();$("#moo\_btn\_submit\_order").hide();$("#moo-cloverGooglePay").show();$("#mooGooglePaySection").show()}this.updateTotalsSection(sooCheckout.options.totals)},orderingTimeChanged:function(element){this.updateSelectedTime()},orderingDayChanged:function(element){let html="";const theDay=$(element).val();const times=mooGlobalParams.isDeliveryOrder?sooCheckout.options.deliveryTimes[theDay]:sooCheckout.options.pickupTimes[theDay];if(!(typeof times==="undefined")){html+='<option value="Select a time">Select a time</option>';for(let i in times){html+='<option value="'+times[i]+'">'+times[i]+"</option>"}}else{html=""}$("#moo\_pickup\_hour").html(html);this.updateSelectedTime()},tipPercentageChanged:function(){const selectedPercentAmount=$("#moo\_tips\_select").val();if(selectedPercentAmount&&selectedPercentAmount!=="cash"&&selectedPercentAmount!=="other"){const calculatedAmount=sooCheckout.options.totals.sub\_total\*selectedPercentAmount/100;mooGlobalParams.tipAmount=Math.round(parseInt(calculatedAmount))}else{mooGlobalParams.tipAmount=0;if(selectedPercentAmount==="other"){$("#moo\_tips").select()}}$("#moo\_tips").val(this.formatPrice(mooGlobalParams.tipAmount));this.updateTotalsSection(sooCheckout.options.totals)},tipAmountChanged:function(){const calculatedAmount=parseInt(Math.ceil(parseFloat($("#moo\_tips").val())\*100));const amount=Math.round(calculatedAmount);if(!isNaN(amount)&&amount>0){mooGlobalParams.tipAmount=amount;$("#moo\_tips").val(this.formatPrice(mooGlobalParams.tipAmount))}else{mooGlobalParams.tipAmount=0;$("#moo\_tips").val("0.00")}this.updateTotalsSection(sooCheckout.options.totals)},showListOfAddresses:function(){$("#moo-checkout-form-ordertypes .soo-address-section .soo-add-delivery-address-form").hide();var listAddrElm=$("#moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses");listAddrElm.show();listAddrElm.html("<div  class='soo-addresses-wrapper'><div class='soo-addresses-title'>Loading your addresses...</div></div>");let html="<div  class='soo-addresses-wrapper'>";html+="<div class='soo-estimate-loader'></div>";let addressesProcessed=0;let nbOfAddresses=0;let addresses=[];let cssClasses="";if(mooGlobalParams.isGuest){if(mooGlobalParams.selectedAddress){nbOfAddresses=1;addresses=[mooGlobalParams.selectedAddress]}else{mooCheckout.showAddAddressForm();$("#soo-add-address-form > div > div > button.sooCheckoutSecondaryButtonInput").hide();return}}else{if(mooCheckout.loggedInCustomer){addresses=mooCheckout.loggedInCustomer.addresses;nbOfAddresses=addresses?addresses.length:0}}if(nbOfAddresses===1){mooGlobalParams.selectedAddress=addresses[0];cssClasses="soo-selected";html+="<div class='soo-addresses-title'>Delivery to :</div>"}else{html+="<div class='soo-addresses-title'>Choose a delivery address</div>"}if(nbOfAddresses>0){addresses.forEach(element=>{if(mooGlobalParams.selectedAddress&&mooGlobalParams.selectedAddress.id===element.id){cssClasses="soo-selected"}else{cssClasses=""}html+="<div class='soo-one-address "+cssClasses+"' id='soo-address-"+element.id+"' onclick='mooCheckout.selectAnAddress("+element.id+")'>";if(typeof element.full\_name!=="undefined"&&element.full\_name!==null){html+="<div class='soo-one-address-name'>"+element.full\_name+"</div>"}html+="<div class='soo-one-address-line1'>"+element.address+"</div>";if(element.line2){html+="<div class='soo-one-address-line2'>"+element.line2+"</div>"}html+="<div class='soo-one-address-line2'>"+element.city+" "+element.state+", "+element.zipcode+"</div>";html+="<div class='soo-address-error'></div>";html+="<div class='soo-delivery-amount'></div>";html+="</div>";addressesProcessed++;if(addressesProcessed>=nbOfAddresses){if(mooGlobalParams.isGuest){html+="</div><div class='soo-add-new-address-button'><span onclick='mooCheckout.showEditAddressForm()'>Edit Address</span></div>"}else{html+="</div><div class='soo-add-new-address-button'><span onclick='mooCheckout.showAddAddressForm()'>Add New Address</span></div>"}listAddrElm.html(html);mooCheckout.syncDeliveryFee()}})}else{mooCheckout.showAddAddressForm()}},showAddAddressForm:function(){$("#moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses").hide();$("#moo-checkout-form-ordertypes .soo-address-section .soo-add-delivery-address-form").show();$("#soo-add-address-form > div > div > button.sooCheckoutSecondaryButtonInput").show()},showEditAddressForm:function(){this.showAddAddressForm();if(mooGlobalParams.selectedAddress){this.fillAddressToEdit()}},hideAddressSection:function(){$("#moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses").hide();$("#moo-checkout-form-ordertypes .soo-address-section .soo-add-delivery-address-form").hide()},hideCouponsSection:function(){$("#moo-checkout-form-coupon").hide()},showCouponsSection:function(){$("#moo-checkout-form-coupon").show()},showDeliveryAmount:function(){$("#sooDeliveryFeeTotalSection").show()},hideDeliveryAmount:function(){$("#sooDeliveryFeeTotalSection").hide()},showServiceFeeAmount:function(){$("#sooServiceFeeTotalSection").show()},hideServiceFeeAmount:function(){$("#sooServiceFeeTotalSection").hide()},showTipSection:function(){$("#sooTipsTotalSection").show();$("#moo-checkout-form-tips").show()},hideTipSection:function(){$("#sooTipsTotalSection").hide();$("#moo-checkout-form-tips").hide()},showCashPayment:function(){$(".moo-checkout-form-payments-cash-container").show();$("#moo-checkout-form-payments-cash").val("cash")},hideCashPayment:function(){$(".moo-checkout-form-payments-cash-container").hide();$("#moo\_cashPanel").hide();$("#moo-checkout-form-payments-cash").val("");if(this.getSelectedPaymentMethod()==="cash"){this.uncheckSelectedPaymentMethod()}},hidePhoneVerificationSection:function(){$("#moo\_cashPanel").hide()},showPhoneVerificationSection:function(){clearInterval(mooGlobalParams.timer);$("#moo\_cashPanel").show();const seconds=120;if(mooGlobalParams.isOtpCodeSent){this.changeElemVisibility("#moo\_cashPanel > div.soo-phone-button","hide");this.changeElemVisibility("#moo\_cashPanel > div.soo-phone-input","show");$("#moo\_cashPanel > div.soo-phone-verif-title").text("Sent sms verification to: "+this.getPhoneNumber());$("#moo\_cashPanel > div.soo-phone-verif-footer").html("Resend code in <span class='timer'>"+seconds+"</span> seconds");mooGlobalParams.timer=setInterval(this.countDown,1e3)}else{this.changeElemVisibility("#moo\_cashPanel > div.soo-phone-button","show");this.changeElemVisibility("#moo\_cashPanel > div.soo-phone-input","hide");$("#moo\_cashPanel > div.soo-phone-verif-title").text("We will send a verification code via SMS to your number");$("#moo\_cashPanel > div.soo-phone-verif-footer").html("")}},selectAnAddress:function(id){if(!mooGlobalParams.isGuest){$("#moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses .soo-one-address").removeClass("soo-selected soo-selected-error soo-selected-warning");$("#moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses .soo-one-address .soo-address-error").text("");$("#moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses .soo-one-address .soo-delivery-amount").text("");$("#moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses #soo-address-"+id).addClass("soo-selected");mooGlobalParams.selectedAddress=this.getAddressById(id);this.syncDeliveryFee()}},unSelectAddress:function(id){$("#moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses .soo-one-address").removeClass("soo-selected soo-selected-error soo-selected-warning");$("#moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses .soo-one-address .soo-address-error").text("");$("#moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses .soo-one-address .soo-delivery-amount").text("")},syncDeliveryFee:function(){if(mooGlobalParams.selectedAddress){const addrElm=$("#moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses #soo-address-"+mooGlobalParams.selectedAddress.id);const amountPos=-1/2\*parseFloat(addrElm.css("height"))+6;if(mooGlobalParams.selectedOrderType&&mooGlobalParams.selectedOrderType.ot\_uuid==="onDemandDelivery"){$(".soo-delivery-amount",addrElm).css("top",amountPos+"px");this.createOnDemandDeliveryEstimate()}else{const res=this.calculateDeliveryFees(mooGlobalParams.selectedAddress.lat,mooGlobalParams.selectedAddress.lng);if(res.result==="success"){mooGlobalParams.selectedAddress.isValid=true;let deliveryAmount;if(!isNaN(res.amount)&&res.amount>0){mooGlobalParams.deliveryFees=res.amount;deliveryAmount=parseFloat(res.amount/100).toFixed(2);deliveryAmount="+ $"+deliveryAmount}else{mooGlobalParams.deliveryFees=0;deliveryAmount="Free"}$(".soo-delivery-amount",addrElm).text(deliveryAmount).css("top",amountPos+"px")}else{mooGlobalParams.selectedAddress.isValid=false}if(res.result==="zone\_error"){addrElm.addClass("soo-selected-error");$(".soo-address-error",addrElm).text(res.message);mooGlobalParams.deliveryFees=null}if(res.result==="min\_error"){addrElm.addClass("soo-selected-warning");$(".soo-address-error",addrElm).text(res.message);mooGlobalParams.deliveryFees=null}mooCheckout.updateTotals()}}},getAddressById:function(id){if(mooCheckout.loggedInCustomer){for(var i=0;i<mooCheckout.loggedInCustomer.addresses.length;i++){if(mooCheckout.loggedInCustomer.addresses[i].id===id)return mooCheckout.loggedInCustomer.addresses[i]}}return null},getOneOrderType:function(orderTypeUuid){if(typeof sooCheckout.options.orderTypes!=="undefined"){for(var i in sooCheckout.options.orderTypes){if(orderTypeUuid===sooCheckout.options.orderTypes[i].ot\_uuid){return sooCheckout.options.orderTypes[i]}}}return null},changeElemVisibility:function(selector,showOrHide){if(showOrHide==="show"){$(selector).show()}if(showOrHide==="hide"){$(selector).hide()}},hideOrderingTime:function(){this.changeElemVisibility("#moo-checkout-form-orderdate","hide")},showOrderingTime:function(){this.changeElemVisibility("#moo-checkout-form-orderdate","show")},getPhoneNumber:function(){if(mooGlobalParams.isGuest){const customer=this.getGuestInfo();return customer.phone}else{const customer=this.getLoggedInCustomer();return customer.phone}},sendCodeToVerifyPhone:function(){const btnSend=$("#moo\_cashPanel > div.soo-phone-button > button");const btnSendTxt=btnSend.html();const phone=this.getPhoneNumber();const seconds=120;if(phone===""){mooCheckout.showErrorAlert(mooObjectL10n.enterYourPhone,"");return}btnSend.html('<div class="dot-flashing"></div>');let token=localStorage.getItem("customerJwtToken");if(!token&&!mooGlobalParams.isGuest){return}const url=mooGlobalParams.isGuest?"moo-clover/v2/guests/send-code":"moo-clover/v2/customers/send-code";fetch(sooCheckout.options.restApiUrl+url,{method:"POST",mode:"cors",cache:"no-cache",credentials:"same-origin",headers:{"Content-Type":"application/json",Authorization:"Bearer "+token},redirect:"follow",referrerPolicy:"no-referrer",body:JSON.stringify({phone:phone})}).then(response=>{if(!response.ok){return response.json()}else{mooGlobalParams.isOtpCodeSent=true;this.showPhoneVerificationSection();btnSend.html(btnSendTxt);return response.json()}}).then(data=>{btnSend.html(btnSendTxt);if(typeof data!=="undefined"&&data.message){if(data.message==="You just sent the verification code please try later"){mooGlobalParams.isOtpCodeSent=true;this.showPhoneVerificationSection()}else{Swal.fire({icon:"success",title:data.message})}}else{if(data===false){throw mooObjectL10n.anErrorOccurred}}}).catch(error=>{btnSend.html(btnSendTxt);mooCheckout.showErrorAlert(error,"")})},verifyCodeSentToPhone:function(){const btn=$("#moo\_cashPanel > div.soo-phone-input > button");const btnTxt=btn.html();const numReg=/^\d+\.?\d\*$/;const phone=this.getPhoneNumber();const code=$("#moo\_cashPanel > div.soo-phone-input > input").val();const seconds=120;if(code.length!==6||!numReg.test(code)){mooCheckout.showErrorAlert(mooObjectL10n.codeInvalid,mooObjectL10n.codeInvalidDetails);return}btn.html('<div class="dot-flashing"></div>');let token=localStorage.getItem("customerJwtToken");if(!token&&!mooGlobalParams.isGuest){return}const url=mooGlobalParams.isGuest?"moo-clover/v2/guests/check-code":"moo-clover/v2/customers/check-code";fetch(sooCheckout.options.restApiUrl+url,{method:"POST",mode:"cors",cache:"no-cache",credentials:"same-origin",headers:{"Content-Type":"application/json",Authorization:"Bearer "+token},redirect:"follow",referrerPolicy:"no-referrer",body:JSON.stringify({code:code,phone:phone})}).then(response=>{if(!response.ok){return response.json()}else{btn.html(btnTxt);clearInterval(mooGlobalParams.timer);mooCheckout.showSuccessAlert(mooObjectL10n.phoneVerified,mooObjectL10n.phoneVerifiedDetails);mooGlobalParams.isOtpCodeSent=false;this.hidePhoneVerificationSection();if(mooGlobalParams.isGuest){mooGlobalParams.isGuestPhoneVerified=true}else{this.getCustomerProfile().then(async function(response){if(!response.ok){const message=`An error has occured: ${response.status}`;throw new Error(message)}return await response.json()}).then(data=>{localStorage.setItem("loggedInCustomer",JSON.stringify(data));mooCheckout.loggedInCustomer=data;mooCheckout.fillCustomerInfo()}).catch(error=>{console.log(error)})}}}).then(data=>{btn.html(btnTxt);if(typeof data!=="undefined"&&data.message){throw data.message}else{if(data===false){throw mooObjectL10n.anErrorOccurred}}}).catch(error=>{btn.html(btnTxt);mooCheckout.showErrorAlert(error,"")})},countDown:function(){let sec=parseInt($("#moo\_cashPanel > div.soo-phone-verif-footer>.timer").text());$("#moo\_cashPanel > div.soo-phone-verif-footer>.timer").text(--sec);if(sec<=0){$("#moo\_cashPanel > div.soo-phone-verif-footer").html("<div onclick='mooCheckout.sendCodeToVerifyPhone()'>Resend code</div>");clearInterval(mooGlobalParams.timer)}},finalizeOrder:function(e){e.preventDefault();$("#moo\_btn\_submit\_order").hide();$("#moo\_checkout\_loading").show();$("#moo-checkout .errors-section").html("");try{window.mooCheckout.getCheckoutForm()}catch(e){console.log(e);window.mooCheckout.stopLoading();window.mooCheckout.showErrorAlert(mooObjectL10n.anErrorOccurred)}},verifyCheckoutForm:function(form){var regex\_exp={email:/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)\*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/};var message\_errors={};const selectedOrderType=mooGlobalParams.selectedOrderType;if(form.customer.first\_name===""&&form.customer.last\_name===""){mooCheckout.showErrorAlert(mooObjectL10n.enterYourName,"","#MooContactFirstName");return false}if(form.customer.email===""||!regex\_exp.email.test(form.customer.email)){mooCheckout.showErrorAlert(mooObjectL10n.enterYourEmail,mooObjectL10n.enterYourEmailReason,"#MooContactEmail");return false}if(form.customer.phone===""){mooCheckout.showErrorAlert(mooObjectL10n.enterYourPhone,mooObjectL10n.enterYourPhoneReason,"#MooContactPhone");return false}if(document.getElementById("moo-checkout-form-ordertypes")){if(typeof form.order\_type==="undefined"||form.order\_type===""){mooCheckout.showErrorAlert(mooObjectL10n.chooseOrderingMethod,mooObjectL10n.chooseOrderingMethodReason,"#moo-checkout-form-ordertypes");return false}}if(selectedOrderType){var minAmount=parseFloat(selectedOrderType.minAmount);var maxAmount=parseFloat(selectedOrderType.maxAmount);if(!isNaN(minAmount)){minAmount=minAmount\*100;minAmount=Math.round(minAmount\*100)/100;if(minAmount>0&&minAmount>sooCheckout.options.totals.sub\_total){this.stopLoading();Swal.fire({title:mooObjectL10n.YouDidNotMeetMinimum,text:mooObjectL10n.orderingMethodSubtotalGreaterThan+mooformatCentPrice(minAmount),icon:"warning",showCancelButton:true,confirmButtonColor:"#DD6B55",confirmButtonClass:"fontSizeLg",confirmButtonText:mooObjectL10n.continueToCheckout,cancelButtonText:mooObjectL10n.continueShopping}).then(data=>{if(data.dismiss&&data.dismiss==="cancel"){if(sooCheckout.options.storeLink){window.location.href=sooCheckout.options.storeLink}}});return false}}if(!isNaN(maxAmount)){maxAmount=maxAmount\*100;maxAmount=Math.round(maxAmount\*100)/100;if(maxAmount&&maxAmount<sooCheckout.options.totals.sub\_total){this.stopLoading();Swal.fire({title:mooObjectL10n.reachedMaximumPurchaseAmount,text:mooObjectL10n.orderingMethodSubtotalLessThan+mooformatCentPrice(maxAmount),icon:"warning",showCancelButton:true,confirmButtonColor:"#DD6B55",confirmButtonText:mooObjectL10n.updateCart,cancelButtonText:mooObjectL10n.checkout,closeOnConfirm:false}).then(function(data){if(data.value){Swal.close();window.location.href=moo\_params.cartPage}});return false}}if(mooCheckout.isTrue(selectedOrderType.show\_sa)){if(mooGlobalParams.selectedAddress){if(!mooGlobalParams.selectedAddress.isValid){mooCheckout.showErrorAlert(mooObjectL10n.verifyYourAddress,"Sorry, we are unable to deliver to this address. Please provide a different address or kindly get in touch with us if you feel are within the delivery range.","#moo-checkout-form-ordertypes>.moo-checkout-bloc-message");return false}}else{mooCheckout.showErrorAlert(mooObjectL10n.addDeliveryAddress,mooObjectL10n.addDeliveryAddressReason,"#moo-checkout-form-ordertypes>.moo-checkout-bloc-message .MooSimplButon");return false}}}if(mooGlobalParams.allowScOrders){if(sooCheckout.options.orderingTimeRequired){if(form.pickup\_hour===""||form.pickup\_hour==="Select a time"){mooCheckout.showErrorAlert(mooObjectL10n.chooseTime,"","#moo-checkout-form-orderdate");return false}}}if(sooCheckout.options.specialInstructionsRequired){if(typeof form.special\_instructions==="undefined"||form.special\_instructions===""){mooCheckout.showErrorAlert(mooObjectL10n.SpecialInstructionsRequired,"","#moo-checkout-form-instruction");return false}}if(form.tip\_amount>0&&this.getOrderTotal()===0){mooCheckout.showErrorAlert("Unable to Include Tips for $0 Orders","To enhance your experience, kindly note that we are unable to include tips when the Order Total is $0. However, you have the option to show your appreciation by providing a tip upon order pickup or delivery. We appreciate your understanding.","#moo-checkout-form-tips");return false}if(typeof form.payment\_method==="undefined"||form.payment\_method===""){mooCheckout.showErrorAlert(mooObjectL10n.choosePaymentMethod,"","#moo-checkout-form-payments");return false}else{if(form.payment\_method==="cash"){if(mooCheckout.shouldVerifyPhone()){if(mooGlobalParams.isGuest&&!mooGlobalParams.isGuestPhoneVerified||!mooGlobalParams.isGuest&&!mooCheckout.loggedInCustomerPhoneIsVerified()){mooCheckout.showPhoneVerificationSection();mooCheckout.showErrorAlert(mooObjectL10n.verifyYourPhone,mooObjectL10n.verifyYourPhoneReason,"#moo-checkout-form-payments");return false}}this.submitForm(form)}if(form.payment\_method==="clover"){if(window.cloverCardIsValid){window.clover.createToken().then(function(response){if(response.token){form.token=response.token;form.card=response.card;window.mooCheckout.submitForm(form)}else{mooCheckout.showErrorAlert(mooObjectL10n.verifyYourCreditCard,"","#moo-checkout-form-payments");return false}})}else{mooCheckout.showErrorAlert(mooObjectL10n.verifyYourCreditCard,window.cloverCardErrorMsg,"#moo-checkout-form-payments");return false}}if(form.payment\_method==="giftcard"){if(window.cloverGiftCardIsValid){try{const timeoutId=setTimeout(()=>{mooCheckout.showErrorAlert("Please verify the gift card information","","#moo-checkout-form-payments")},1e4);window.clover.createGiftCardToken().then(function(response){clearTimeout(timeoutId);if(response.token){form.payment\_method="clover";form.selected\_payment\_method="giftcard";form.token=response.token;window.mooCheckout.submitForm(form)}else{mooCheckout.showErrorAlert("Please verify the gift card information","","#moo-checkout-form-payments");return false}})}catch(err){console.log(err)}}else{mooCheckout.showErrorAlert("Please verify the gift card information","","#moo-checkout-form-payments");return false}}if(form.payment\_method==="googlepay"){if(window.googlePayToken){try{form.payment\_method="clover";form.token=window.googlePayToken.token;form.selected\_payment\_method="googlepay";form.googledata=window.googlePayToken;window.mooCheckout.submitForm(form)}catch(err){console.log(err)}}else{mooCheckout.showErrorAlert("Please Try Again","","#moo-checkout-form-payments");return false}}}},getCheckoutForm:function(){var form={channel:"website",customer:null,metainfo:[{name:"source\_url",value:window.location.href},{name:"checkout\_version",value:"new"}]};form.customer=mooCheckout.getCustomer();form.tip\_amount=mooCheckout.getTipAmount();form.special\_instructions=$("#Mooinstructions").val();form.pickup\_day=$("#moo\_pickup\_day").val();form.pickup\_hour=$("#moo\_pickup\_hour").val();form.orderingTime=mooGlobalParams.selectedTime;if(document.getElementById("moo-checkout-form-ordertypes")){form.order\_type=$('input[name="ordertype"]:checked').val()}form.payment\_method=$('#moo-checkout-form-payments input[name="paymentMethod"]:checked').val();form.delivery\_amount=mooCheckout.getDeliveryFees();form.service\_fee=mooCheckout.getServiceFees();if(this.canAcceptCoupons()){form.coupon={code:mooGlobalParams.couponCode}}if(this.canAcceptPoints()){form.use\_points=parseInt(mooGlobalParams.points)}form.totals=mooCheckout.getTotals();this.verifyCheckoutForm(form)},submitForm:function(form){if(form.order\_type==="onDemandDelivery"){let deliveryTime=(new Date).toISOString();if(mooGlobalParams.selectedTime){deliveryTime=mooGlobalParams.selectedTime}this.createDeliveryEstimate().then(response=>{if(!response.ok){throw new Error(mooObjectL10n.anErrorOccurred)}else{return response.json()}}).then(res=>{if(res.status==="success"){form.delivery\_estimate=res;form.delivery\_time=deliveryTime;this.createOrder(form)}else{throw new Error(res.message)}}).catch(err=>{this.showErrorAlert(err.message,"")})}else{this.createOrder(form)}},createOrder:function(form){if(sooCheckout.options.reCAPTCHA\_site\_key){grecaptcha.ready(function(){grecaptcha.execute(sooCheckout.options.reCAPTCHA\_site\_key,{action:"createOrder"}).then(token=>{console.log(token);form.reCAPTCHA\_token=token;mooCheckout.sendCreateOrder(form)})})}else{mooCheckout.sendCreateOrder(form)}return;let headers={"Content-Type":"application/json"};if(this.isCustomerLoggedIn()){form.customer\_token=localStorage.getItem("customerJwtToken")}$.ajax({type:"POST",cache:false,url:sooCheckout.options.restApiUrl+"moo-clover/v2/checkout",headers:headers,data:JSON.stringify(form)}).done(function(data){if(typeof data=="object"){if(data.status==="success"){mooCheckout.trackConversion(true,form);mooCheckout.successfulOrder(data.id)}else{mooCheckout.trackConversion(false,form);mooCheckout.failedOrder(data.message)}}else{if(data.indexOf('"status":"success"')!==-1){mooCheckout.trackConversion(true,form);mooCheckout.successfulOrder("")}else{mooCheckout.trackConversion(false,form);mooCheckout.failedOrder("")}}}).fail(function(data){console.log("FAIL");console.log(data.responseText);if(data.responseText.indexOf('"status":"success"')!==-1){mooCheckout.trackConversion(true,form);mooCheckout.successfulOrder("")}else{mooCheckout.trackConversion(false,form);mooCheckout.failedOrder("")}})},sendCreateOrder:function(form){let headers={"Content-Type":"application/json"};if(this.isCustomerLoggedIn()){form.customer\_token=localStorage.getItem("customerJwtToken")}$.ajax({type:"POST",cache:false,url:sooCheckout.options.restApiUrl+"moo-clover/v2/checkout",headers:headers,data:JSON.stringify(form)}).done(function(data){if(typeof data=="object"){if(data.status==="success"){mooCheckout.trackConversion(true,form);mooCheckout.successfulOrder(data.id)}else{mooCheckout.trackConversion(false,form);mooCheckout.failedOrder(data.message)}}else{if(data.indexOf('"status":"success"')!==-1){mooCheckout.trackConversion(true,form);mooCheckout.successfulOrder("")}else{mooCheckout.trackConversion(false,form);mooCheckout.failedOrder("")}}}).fail(function(data){console.log("FAIL");console.log(data.responseText);if(data.responseText.indexOf('"status":"success"')!==-1){mooCheckout.trackConversion(true,form);mooCheckout.successfulOrder("")}else{mooCheckout.trackConversion(false,form);mooCheckout.failedOrder("")}})},successfulOrder:function(orderId){if(sooCheckout.options.thanksPage&&sooCheckout.options.thanksPage!==""){window.location.href=sooCheckout.options.thanksPage+"?order\_id="+orderId}else{let html='<div class="moo-alert moo-alert-success" role="alert" style="font-size: 20px;text-align: center">';html+=mooObjectL10n.thanksForOrder;html+="<br/>";html+=mooObjectL10n.orderBeingPrepared;if(orderId!==""){html+="<br>";html+=mooObjectL10n.seeReceipt;html+=sooCheckout.options.isSandbox?' <a href="https://sandbox.dev.clover.com/r/'+orderId+'" target="\_blank">':' <a href="https://www.clover.com/r/'+orderId+'" target="\_blank">';html+=mooObjectL10n.here;html+="</a>"}html+="</div>";$("#moo\_checkout\_msg").remove();$("#moo-checkout").html("");if(sooCheckout.delivery.moo\_merchantAddress!==""){$("#moo-checkout").parent().prepend("<div style='text-align: center'><p style='font-size: 21px;'>"+mooObjectL10n.ourAddress+" : </p>"+sooCheckout.delivery.moo\_merchantAddress+"</div>")}$("#moo-checkout").parent().prepend(html);$("html, body").animate({scrollTop:0},600)}},failedOrder:function(failureMessage){let html="";this.stopLoading();if(failureMessage&&failureMessage!==""&&failureMessage!==undefined){html='<div class="moo-alert moo-alert-danger" role="alert" id="moo\_checkout\_msg">'+failureMessage+"</div>"}else{html='<div class="moo-alert moo-alert-warning" role="alert" id="moo\_checkout\_msg"><strong>';html+=mooObjectL10n.cannotSendEntireOrder;html+="</strong></div>"}$("#moo-checkout .errors-section").html(html);$("html, body").animate({scrollTop:0},600)},getCustomerSelectedAddress:function(){return{}},getDeliveryFees:function(){return mooGlobalParams.deliveryFees},getServiceFees:function(){let fee=sooCheckout.options.feeAmount;if(fee){if(mooGlobalParams.selectedOrderType){if(mooCheckout.isTrue(mooGlobalParams.selectedOrderType.allow\_service\_fee)){if(sooCheckout.options.feeType==="amount"){return fee}else{return Math.round(fee\*sooCheckout.options.totals.sub\_total/100)}}}else{if($("#sooServiceFeeTotalSection").css("display")==="block"){if(sooCheckout.options.feeType==="amount"){return fee}else{return Math.round(fee\*sooCheckout.options.totals.sub\_total/100)}}}}return 0},createOnDemandDeliveryEstimate:function(){if(mooGlobalParams.selectedAddress){const addrElm=$("#moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses #soo-address-"+mooGlobalParams.selectedAddress.id);const loader=$("#moo-checkout-form-ordertypes div.soo-address-section > div.soo-list-of-addresses > div.soo-addresses-wrapper>.soo-estimate-loader");$("#moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses .soo-one-address").removeClass("soo-selected-error soo-selected-warning");$("#moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses .soo-one-address .soo-address-error").text("");$("#moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses .soo-one-address .soo-delivery-amount").text("");$(".soo-delivery-amount",addrElm).html('<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" class="BpkSpinner\_bpk-spinner\_\_NjNlZ BpkSpinner\_bpk-spinner--primary\_\_YTQxN"><rect width="4" height="2" y="7" opacity=".45" rx="1"></rect><rect width="4" height="2" x="12" y="7" rx="1"></rect><rect width="4" height="2" x="7" y="16" opacity=".3" rx="1" transform="rotate(-90 7 16)"></rect><rect width="4" height="2" x="7" y="4" opacity=".65" rx="1" transform="rotate(-90 7 4)"></rect><rect width="4" height="2" x="11.134" y="15.428" opacity=".25" rx="1" transform="rotate(-120 11.134 15.428)"></rect><rect width="4" height="2" x="5.134" y="5.036" opacity=".55" rx="1" transform="rotate(-120 5.134 5.036)"></rect><rect width="4" height="2" x="14.428" y="12.866" opacity=".2" rx="1" transform="rotate(-150 14.428 12.866)"></rect><rect width="4" height="2" x="4.036" y="6.866" opacity=".5" rx="1" transform="rotate(-150 4.036 6.866)"></rect><rect width="4" height="2" x="15.428" y="4.866" opacity=".85" rx="1" transform="rotate(150 15.428 4.866)"></rect><rect width="4" height="2" x="5.036" y="10.866" opacity=".4" rx="1" transform="rotate(150 5.036 10.866)"></rect><rect width="4" height="2" x="12.866" y="1.572" opacity=".75" rx="1" transform="rotate(120 12.866 1.572)"></rect><rect width="4" height="2" x="6.866" y="11.964" opacity=".35" rx="1" transform="rotate(120 6.866 11.964)"></rect></svg>');loader.show();let deliveryTime=(new Date).toISOString();if(mooGlobalParams.selectedTime){deliveryTime=mooGlobalParams.selectedTime}this.createDeliveryEstimate().then(response=>{if(!response.ok){$(".soo-delivery-amount",addrElm).text("");loader.hide();mooCheckout.unSelectAddress();if(mooGlobalParams.selectedAddress){mooGlobalParams.selectedAddress.isValid=false}throw new Error(mooObjectL10n.anErrorOccurred)}else{return response.json()}}).then(res=>this.displayDeliveryAmountForAddress(res)).catch(err=>{mooCheckout.showErrorAlert(err.message,"")})}},calculateDeliveryFees:function(lat,lng){var order\_total=parseFloat(sooCheckout.options.totals.sub\_total);const delivery\_free\_after=Math.round(parseFloat(sooCheckout.delivery.free\_amount)\*100);const delivery\_fixed\_amount=Math.round(parseFloat(sooCheckout.delivery.fixed\_amount)\*100);const delivery\_for\_other\_zone=Math.round(parseFloat(sooCheckout.delivery.other\_zone\_fee)\*100);let moo\_delivery\_areas=null;try{moo\_delivery\_areas=JSON.parse(sooCheckout.delivery.zones)}catch(e){console.log("Parsing error: moo\_delivery\_areas")}if(!isNaN(delivery\_fixed\_amount)){return{result:"success",amount:delivery\_fixed\_amount,message:null}}if(!(lat!==""&&lng!=="")){return{result:"zone\_error",amount:null,message:mooObjectL10n.deliveryZoneNotSupported}}else{var zones\_contain\_point=[];for(const i in moo\_delivery\_areas){var zone=moo\_delivery\_areas[i];if(zone.feeType==="percent"){zone.fee=parseFloat(zone.fee)}else{zone.fee=Math.round(parseFloat(zone.fee)\*100)}zone.minAmount=Math.round(parseFloat(zone.minAmount)\*100);if(zone.type==="polygon"){if(google.maps.geometry.poly.containsLocation(new google.maps.LatLng(parseFloat(lat),parseFloat(lng)),new google.maps.Polygon({paths:zone.path}))){zones\_contain\_point.push({zone\_id:zone.id,zone\_fee:zone.fee,feeType:zone.feeType,minAmount:zone.minAmount})}}if(zone.type==="circle"){var point=new google.maps.LatLng(parseFloat(lat),parseFloat(lng));var center=new google.maps.LatLng(parseFloat(zone.center.lat),parseFloat(zone.center.lng));if(google.maps.geometry.spherical.computeDistanceBetween(point,center)<=zone.radius){zones\_contain\_point.push({zone\_id:zone.id,zone\_fee:zone.fee,feeType:zone.feeType,minAmount:zone.minAmount})}}}if(zones\_contain\_point.length>=1){var delivery\_final\_amount=zones\_contain\_point[0].feeType==="percent"?zones\_contain\_point[0].zone\_fee\*order\_total/100:zones\_contain\_point[0].zone\_fee;var delivery\_zone\_id=zones\_contain\_point[0].zone\_id;var delivery\_zone\_minAmount=zones\_contain\_point[0].minAmount;for(const i in zones\_contain\_point){if(zones\_contain\_point[i].feeType==="percent"){const amount=parseFloat(zones\_contain\_point[i].zone\_fee)\*order\_total/100;if(delivery\_final\_amount>=amount){delivery\_final\_amount=amount;delivery\_zone\_id=zones\_contain\_point[i].zone\_id;delivery\_zone\_minAmount=zones\_contain\_point[i].minAmount}}else{if(delivery\_final\_amount>=zones\_contain\_point[i].zone\_fee){delivery\_final\_amount=zones\_contain\_point[i].zone\_fee;delivery\_zone\_id=zones\_contain\_point[i].zone\_id;delivery\_zone\_minAmount=zones\_contain\_point[i].minAmount}}}if(!isNaN(delivery\_zone\_minAmount)){if(delivery\_zone\_minAmount>sooCheckout.options.totals.sub\_total){return{result:"min\_error",amount:null,message:mooObjectL10n.minimumForDeliveryZone+parseFloat(delivery\_zone\_minAmount/100).toFixed(2)}}}if(isNaN(delivery\_free\_after)){return{result:"success",amount:delivery\_final\_amount,message:null}}else{var amountToAdd=delivery\_free\_after-order\_total;if(amountToAdd<=0){return{result:"success",amount:0,message:null}}else{Swal.fire({title:mooObjectL10n.spend+parseFloat(delivery\_free\_after/100).toFixed(2)+" "+mooObjectL10n.toGetFreeDelivery,text:"Add $"+parseFloat(amountToAdd/100).toFixed(2)+" to your order to enjoy free delivery",icon:"warning",showCancelButton:true,confirmButtonColor:"#6e7881",confirmButtonClass:"fontSizeLg",cancelButtonColor:"#DD6B55",confirmButtonText:mooObjectL10n.continueToCheckout,cancelButtonText:mooObjectL10n.continueShopping}).then(data=>{if(data.dismiss&&data.dismiss==="cancel"){if(sooCheckout.options.storeLink){window.location.href=sooCheckout.options.storeLink}else{window.history.back()}}});if(amountToAdd>0&&amountToAdd<delivery\_final\_amount){delivery\_final\_amount=amountToAdd}return{result:"success",amount:delivery\_final\_amount,message:null}}}}else{if(isNaN(delivery\_for\_other\_zone)){return{result:"zone\_error",amount:null,message:mooObjectL10n.deliveryZoneNotSupported}}else{return{result:"success",amount:delivery\_for\_other\_zone,message:null}}}}},formatPrice:function(priceInCentes){var p=priceInCentes/100;p=p.toFixed(2);return p.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,")},updateTotals:function(){const totals=sooCheckout.options.totals;if(totals===false){return}const deliveryAmount=this.getDeliveryFees();const serviceFee=this.getServiceFees();const discounts=this.getDiscountedAmount();this.startLoadingDeliveryFee();this.getOrderTotals(deliveryAmount+serviceFee,discounts,this.updateTotalsSection)},getTotals:function(){return{tipAmount:mooCheckout.getTipAmount(),deliveryAmount:mooCheckout.getDeliveryFees(),serviceFee:this.getServiceFees(),discounts:this.getDiscountedAmount(),couponAmount:mooGlobalParams.couponAmount,pointsAmount:mooGlobalParams.pointsAmount,grandTotal:mooGlobalParams.grandTotal,orderTaxable:mooCheckout.isOrderTaxable()}},updateTotalsSection:function(totals){mooGlobalParams.grandTotal=0;const tips\_amount=mooCheckout.getTipAmount();const delivery\_amount=mooCheckout.getDeliveryFees();const service\_fee=mooCheckout.getServiceFees();const discounts=mooCheckout.getDiscountedAmount();const orderTaxable=mooCheckout.isOrderTaxable();if(service\_fee===0){mooCheckout.hideServiceFeeAmount()}else{mooCheckout.showServiceFeeAmount();$("#sooServiceFeeTotalSection > .moo-totals-value").text(" $"+mooCheckout.formatPrice(service\_fee))}mooCheckout.stopLoadingDeliveryFee();if(discounts===0){$("#sooCouponTotalSection").hide();$("#sooPointsTotalSection").hide()}else{if(mooCheckout.canAcceptCoupons()&&mooGlobalParams.couponAmount){$("#sooCouponTotalSection").show();$("#sooCouponName").text(mooGlobalParams.couponName);$("#sooCouponValue").text(" -$"+mooCheckout.formatPrice(mooGlobalParams.couponAmount))}else{$("#sooCouponTotalSection").hide()}if(mooCheckout.canAcceptPoints()&&mooGlobalParams.pointsAmount){$("#sooPointsTotalSection").show();$("#sooPointslabel").text(mooGlobalParams.points+" "+mooGlobalParams.pointsLabel);$("#sooPointsValue").text(" -$"+mooCheckout.formatPrice(mooGlobalParams.pointsAmount))}else{$("#sooPointsTotalSection").hide()}}$(".moo-totals-value").fadeOut(300,function(){$("#moo-cart-subtotal").html("$"+mooCheckout.formatPrice(totals.sub\_total));$("#moo-cart-tip").html("$"+mooCheckout.formatPrice(tips\_amount));$("#moo-cart-delivery-fee").html("$"+mooCheckout.formatPrice(delivery\_amount));if(orderTaxable){if(discounts===0){mooGlobalParams.grandTotal=totals.sub\_total+totals.taxes+tips\_amount+delivery\_amount+service\_fee;$("#moo-cart-tax").html("$"+mooCheckout.formatPrice(totals.taxes));$("#moo-cart-total").html("$"+mooCheckout.formatPrice(mooGlobalParams.grandTotal))}else{mooGlobalParams.grandTotal=totals.sub\_total+totals.taxes\_after\_discount+tips\_amount+delivery\_amount+service\_fee-discounts;$("#moo-cart-tax").html("$"+mooCheckout.formatPrice(totals.taxes\_after\_discount));$("#moo-cart-total").html("$"+mooCheckout.formatPrice(mooGlobalParams.grandTotal))}}else{mooGlobalParams.grandTotal=totals.sub\_total+tips\_amount+delivery\_amount+service\_fee-discounts;$("#moo-cart-tax").html("0.00");$("#moo-cart-total").html("$"+mooCheckout.formatPrice(mooGlobalParams.grandTotal))}$(".moo-totals-value").fadeIn(300)})},getOrderTotals:function(charges,discounts,callback){$.ajax({type:"POST",cache:false,url:sooCheckout.options.restApiUrl+"moo-clover/v3/checkout/order\_totals",contentType:"application/json; charset=UTF-8",data:JSON.stringify({charges:charges,discounts:discounts})}).done(function(data){sooCheckout.options.totals=data;callback(data)}).fail(function(data){console.log("FAIL");console.log(data.responseText)})},showErrorAlert:function(title,message,focusOnElem=null){this.stopLoading();if(focusOnElem){Swal.fire({title:title,text:message,icon:"error"}).then(function(){setTimeout(function(){$(focusOnElem).focus()},500)})}else{Swal.fire({title:title,text:message,icon:"error"})}},showSuccessAlert:function(title,message,focusOnElem=null){this.stopLoading();if(focusOnElem){Swal.fire(title,message,"success").then(function(){setTimeout(function(){$(focusOnElem).focus()},500)})}else{Swal.fire(title,message,"success")}},stopLoading:function(){if(this.getSelectedPaymentMethod()==="googlepay"){$("#moo\_checkout\_loading").hide();$("#moo-cloverGooglePay").show()}else{$("#moo\_checkout\_loading").hide();$("#moo\_btn\_submit\_order").show()}},startLoadingDeliveryFee:function(){$("#sooDeliveryFeeTotalSection").addClass("moo-fade-in");$(".moo-totals-item-total").addClass("moo-fade-in")},stopLoadingDeliveryFee:function(){$("#sooDeliveryFeeTotalSection").removeClass("moo-fade-in");$(".moo-totals-item-total").removeClass("moo-fade-in")},trackConversion:function(status,form){if(typeof dataLayer!=="undefined"){try{if(status){dataLayer.push({event:"OrderCreated",amount:sooCheckout.options.totals.total/100,taxes:sooCheckout.options.totals.total\_of\_taxes/100,tips:form.tip\_amount/100,nbOfItems:sooCheckout.options.totals.nb\_items})}else{dataLayer.push({event:"OrderNotCreated",amount:sooCheckout.options.totals.total/100,taxes:sooCheckout.options.totals.total\_of\_taxes/100,tips:form.tip\_amount/100,nbOfItems:sooCheckout.options.totals.nb\_items})}}catch(e){console.log(e)}}},isTrue:function(param){return param===true||param===1||param==="1"||param==="true"},changeOrderingTimes:function(type){var dayInput=$("#moo\_pickup\_day");var hoursInput=$("#moo\_pickup\_hour");var html\_days="";var html\_hours="";let times=null;if(type==="pickup"){if(sooCheckout.options.pickupTimes===null){$("#moo-checkout-form-orderdate .extra-info").html("There are no time slots available. Please try again later. Thank you for your understanding and patience.");return}for(let i in sooCheckout.options.pickupTimes){html\_days+='<option value="'+i+'">'+i+"</option>"}times=sooCheckout.options.pickupTimes[Object.keys(sooCheckout.options.pickupTimes)[0]]}if(type==="delivery"){if(sooCheckout.options.deliveryTimes===null){$("#moo-checkout-form-orderdate .extra-info").html("There are no time slots available. Please try again later. Thank you for your understanding and patience.");return}for(var i in sooCheckout.options.deliveryTimes){html\_days+='<option value="'+i+'">'+i+"</option>"}times=sooCheckout.options.deliveryTimes[Object.keys(sooCheckout.options.deliveryTimes)[0]]}if(times){html\_hours+='<option value="Select a time">Select a time</option>';for(let i in times){html\_hours+='<option value="'+times[i]+'">'+times[i]+"</option>"}}else{html\_hours=""}hoursInput.html(html\_hours);dayInput.html(html\_days)},updateSelectedTime:function(){const day=$("#moo\_pickup\_day").val();let time=$("#moo\_pickup\_hour").val();if(day!==""){if(time==="ASAP"){}if(time!==""&&time!=="Select a time"){const today=new Date;let str="";if(day==="Today"){str=today.toDateString()}else{str=day+" "+today.getFullYear()}if(time==="ASAP"){time=today.toTimeString()}str+=" "+time.substring(0,time.length-2)+":00 "+time.substring(time.length-2,time.length);~~console.log(str);~~let selectedDay=new Date(str);mooGlobalParams.selectedTime=selectedDay;if(mooGlobalParams.selectedOrderType&&mooGlobalParams.selectedOrderType.ot\_uuid==="onDemandDelivery"){this.createOnDemandDeliveryEstimate()}return}}mooGlobalParams.selectedTime=null},getDiscountedAmount:function(){let discounts=0;if(this.canAcceptCoupons()&&mooGlobalParams.couponAmount){discounts+=mooGlobalParams.couponAmount}if(this.canAcceptPoints()&&mooGlobalParams.pointsAmount){discounts+=mooGlobalParams.pointsAmount}return discounts},createDeliveryEstimate:function(){let deliveryTime=(new Date).toISOString();if(mooGlobalParams.selectedTime){deliveryTime=mooGlobalParams.selectedTime}const url=sooCheckout.options.restApiUrl+"moo-clover/v3/delivery-estimate";return fetch(url,{method:"POST",mode:"cors",cache:"no-cache",credentials:"same-origin",headers:{"Content-Type":"application/json"},redirect:"follow",referrerPolicy:"no-referrer",body:JSON.stringify({dropoff\_address:{street:mooGlobalParams.selectedAddress.address,unit:mooGlobalParams.selectedAddress.line2,city:mooGlobalParams.selectedAddress.city,state:mooGlobalParams.selectedAddress.state,zip\_code:mooGlobalParams.selectedAddress.zipcode},order\_value:sooCheckout.options.totals.sub\_total,delivery\_time:deliveryTime})})},displayDeliveryAmountForAddress:function(res){if(!mooGlobalParams.selectedAddress){return}$("#moo-checkout-form-ordertypes div.soo-address-section > div.soo-list-of-addresses > div.soo-addresses-wrapper>.soo-estimate-loader").hide();const addrElm=$("#moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses #soo-address-"+mooGlobalParams.selectedAddress.id);$(".soo-delivery-amount",addrElm).text("");if(res.status==="success"){$(addrElm).addClass("soo-selected");let deliveryAmount;mooGlobalParams.selectedAddress.isValid=true;if(res.minAmount&&res.minAmount>0&&res.minAmount>sooCheckout.options.totals.sub\_total){const message=mooObjectL10n.minimumForDeliveryZone+parseFloat(res.minAmount/100).toFixed(2);mooCheckout.unSelectAddress();addrElm.addClass("soo-selected-warning");$(".soo-address-error",addrElm).text(message);mooGlobalParams.deliveryFees=null}if(res.freeAfter&&res.freeAfter>0&&res.freeAfter<=sooCheckout.options.totals.sub\_total){mooGlobalParams.deliveryFees=0;deliveryAmount="Free"}else{if(res.fee>0){mooGlobalParams.deliveryFees=res.fee;deliveryAmount=parseFloat(res.fee/100).toFixed(2);deliveryAmount="+ $"+deliveryAmount}else{mooGlobalParams.deliveryFees=0;deliveryAmount="Free"}}$(".soo-delivery-amount",addrElm).text(deliveryAmount)}else{mooGlobalParams.selectedAddress.isValid=false;mooCheckout.unSelectAddress()}if(res.status==="failed"){if(res.code==="zone\_not\_supported"){addrElm.addClass("soo-selected-error");$(".soo-address-error",addrElm).text(res.message);mooGlobalParams.deliveryFees=null}if(["min\_amount\_not\_valid","delivery\_time\_not\_valid"].includes(res.code)){addrElm.addClass("soo-selected-warning");$(".soo-address-error",addrElm).text(res.message);mooGlobalParams.deliveryFees=null}}mooCheckout.updateTotals()},applyCoupon:function(showError=true){const btnRemove=$("#moo-checkout-form-coupon div > button.sooDeleteCouponButton.sooCheckoutPrimaryButtonInput");const btn=$("#moo-checkout-form-coupon div > button.sooApplyCouponButton.sooCheckoutPrimaryButtonInput");const btnTxt=btn.html();btn.html('<div class="dot-flashing"></div>');mooGlobalParams.couponCode=$("#moo\_coupon").val();if(mooGlobalParams.couponCode){mooGlobalParams.couponCode=mooGlobalParams.couponCode.trim();this.getCouponByCode(mooGlobalParams.couponCode).then(res=>{if(res.ok){return res.json()}throw new Error(mooObjectL10n.anErrorOccurred)}).then(res=>{if(res.status==="success"&&res.coupon){let discountAmount=0;const minValue=Math.round(parseFloat(res.coupon.minAmount)\*100);const maxValue=Math.round(parseFloat(res.coupon.maxValue)\*100);if(sooCheckout.options.totals.sub\_total<=0||typeof sooCheckout.options.totals.sub\_total===undefined){throw new Error(mooObjectL10n.cartEmpty)}else{if(!isNaN(minValue)){if(sooCheckout.options.totals.sub\_total<minValue){throw new Error("Minimum order amount to use this coupon is $"+this.formatPrice(minValue))}}}if(res.coupon.type.toUpperCase()==="AMOUNT"){discountAmount=Math.round(parseFloat(res.coupon.value)\*100);mooGlobalParams.couponName=res.coupon.name}else{discountAmount=Math.round(parseFloat(res.coupon.value)\*sooCheckout.options.totals.sub\_total/100);mooGlobalParams.couponName=res.coupon.name}mooGlobalParams.couponAmount=Math.min(sooCheckout.options.totals.sub\_total,discountAmount);if(!isNaN(maxValue)){if(mooGlobalParams.couponAmount>maxValue){mooGlobalParams.couponAmount=maxValue}}this.updateTotals();if(this.canAcceptPoints()&&mooGlobalParams.points>0){if(this.getOrderTotal()<0){this.clickOnRemovePoints();const additionalMsg=` and your previously used loyalty ${mooGlobalParams.pointsLabel} have been reset. Please take a moment to use review them again`;const txt=mooObjectL10n.receivedDiscountUSD+this.formatPrice(mooGlobalParams.couponAmount)+additionalMsg;this.showSuccessAlert(mooObjectL10n.couponApplied,txt)}}else{const txt=mooObjectL10n.receivedDiscountUSD+this.formatPrice(mooGlobalParams.couponAmount);this.showSuccessAlert(mooObjectL10n.couponApplied,txt)}btn.html(btnTxt).hide();$("#moo\_coupon").attr("readonly",true).attr("disabled",true);btnRemove.show()}else{if(showError){throw new Error(res.message)}else{$("#moo\_coupon").val("");btn.html(btnTxt)}}}).catch(err=>{this.showErrorAlert(mooObjectL10n.error,err.message);btn.html(btnTxt)})}else{this.showErrorAlert(mooObjectL10n.error,mooObjectL10n.enterCouponCode,"#moo\_coupon");btn.html(btnTxt)}},removeCoupon:function(){const btnApply=$("#moo-checkout-form-coupon div > button.sooApplyCouponButton.sooCheckoutPrimaryButtonInput");const btn=$("#moo-checkout-form-coupon div > button.sooDeleteCouponButton.sooCheckoutPrimaryButtonInput");const btnTxt=btn.html();btn.html('<div class="dot-flashing"></div>');mooGlobalParams.couponCode=null;mooGlobalParams.couponAmount=null;mooGlobalParams.couponName=null;this.updateTotals();btn.html(btnTxt);btn.hide();btnApply.show();$("#moo\_coupon").val("").attr("readonly",false).attr("disabled",false)},clickOnUsePoints:function(){$("#moo-checkout-form-loyalty .loyaltyButtons > .sooUsePointsButton").hide();$("#moo-checkout-form-loyalty .loyaltyButtons > .sooRemovePointsButton").show();$("#moo-checkout-form-loyalty .usePointsInput").show();this.setLoyaltyError("");$("#moo-checkout-form-loyalty .usePointsInput .sooValidatePoints .sooValidatePointsButton").show();$("#moo-checkout-form-loyalty .usePointsInput .sooValidatePoints .sooEditPointsButton").hide();$("#sooSelectedPointsValue").attr("disabled",false).attr("readonly",false)},clickOnRemovePoints:function(){this.removePoints();$("#moo-checkout-form-loyalty .loyaltyButtons > .sooUsePointsButton").show();$("#moo-checkout-form-loyalty .loyaltyButtons > .sooRemovePointsButton").hide();$("#moo-checkout-form-loyalty .usePointsInput").hide();this.updateTotalsSection(sooCheckout.options.totals)},changePointsValue:function(){this.setLoyaltyError("");const points=$("#sooSelectedPointsValue").val();if(points.match(/^[0-9]+$/)&&points>0){const maxAllowed=this.getMaxPointsAllowed();const amount=this.getValueOfPoints(points);if(amount>0){const elm=$("#moo-checkout-form-loyalty > div.moo-checkout-bloc-content > div.moo-row.usePointsInput  .sooToPayInfo > .sooToPayAmount");elm.html("$"+this.formatPrice(amount))}if(maxAllowed<points){if(maxAllowed===0){this.setLoyaltyError(`${mooGlobalParams.pointsLabel} can't be used for this order.`)}else{this.setLoyaltyError("The maximum number of "+mooGlobalParams.pointsLabel+" that can be used is "+maxAllowed)}}}else{this.setLoyaltyError("Not a valid number")}},usePoints:function(){this.setLoyaltyError("");const points=$("#sooSelectedPointsValue").val();if(points.match(/^[0-9]+$/)&&points>0){const customer=this.getLoggedInCustomer();const settings=this.getLoyaltySettings();const maxAllowed=this.getMaxPointsAllowed();if(!customer||!settings){this.setLoyaltyError("Your session has been expired, please refresh the page");return}if(customer.point\_count<points){this.setLoyaltyError("Insufficient balance");return}if(settings.min\_points\_to\_order&&settings.min\_points\_to\_order>points){this.setLoyaltyError("The store owner has set a minimum requirement of "+settings.min\_points\_to\_order+" "+mooGlobalParams.pointsLabel+" per order.");return}if(settings.min\_amount\_to\_up&&settings.min\_amount\_to\_up>sooCheckout.options.totals.sub\_total){this.setLoyaltyError("Minimum order amount to use points is $"+this.formatPrice(settings.min\_amount\_to\_up));return}if(maxAllowed<points){if(maxAllowed===0){this.setLoyaltyError(`${mooGlobalParams.pointsLabel} can't be used for this order.`)}else{this.setLoyaltyError("The maximum number of "+mooGlobalParams.pointsLabel+" that can be used is "+maxAllowed)}return}mooGlobalParams.points=points;mooGlobalParams.pointsAmount=Math.min(this.getValueOfPoints(points),this.getSubTotalWithoutCoupons());this.updateTotals();$("#moo-checkout-form-loyalty .usePointsInput .sooValidatePoints .sooValidatePointsButton").hide();$("#moo-checkout-form-loyalty .usePointsInput .sooValidatePoints .sooEditPointsButton").show();$("#sooSelectedPointsValue").attr("disabled",true).attr("readonly",true)}else{this.setLoyaltyError("Not a valid number")}},editPoints:function(){mooGlobalParams.points=null;mooGlobalParams.pointsAmount=null;this.setLoyaltyError("");$("#moo-checkout-form-loyalty .usePointsInput .sooValidatePoints .sooValidatePointsButton").show();$("#moo-checkout-form-loyalty .usePointsInput .sooValidatePoints .sooEditPointsButton").hide();$("#sooSelectedPointsValue").attr("disabled",false).attr("readonly",false);this.updateTotalsSection(sooCheckout.options.totals)},setLoyaltyError:function(err){$("#moo-checkout-form-loyalty > div.moo-checkout-bloc-content > div.moo-row.usePointsInput .moo-error-section").html(err).show()},openLoyaltyDetails:function(){const settings=this.getLoyaltySettings();const maxPointsAllowed=this.getMaxPointsAllowed();const earningMsg=this.getEarningMessage();if(!settings){this.showErrorAlert(mooObjectL10n.error,mooObjectL10n.anErrorOccurred);return}let htmlDiv='<div class="soo-loyalty-conditions"><div class="moo-row"><div class="moo-col-md-12"><ul>';htmlDiv+=`<li>- Get $${this.formatPrice(settings.per\_x\_usd)} discount when redeeming ${settings.nb\_points} ${mooGlobalParams.pointsLabel}</li>`;if(settings.purchase\_usd\_value){if(settings.calc\_method==="subtotal"){htmlDiv+=`<li>- Earn ${settings.purchase\_usd\_value} ${mooGlobalParams.pointsLabel} for every dollar spent (based on Subtotal).</li>`}else{htmlDiv+=`<li>- Earn ${settings.purchase\_usd\_value} ${mooGlobalParams.pointsLabel} for every dollar spent.</li>`}}else{htmlDiv+=`<li>- Earn ${settings.purchase\_fixed\_points} ${mooGlobalParams.pointsLabel} on each order placed.</li>`}if(settings.order\_source.website===false){htmlDiv+=`<li>- ${mooGlobalParams.pointsLabel} not earned for purchases made through our website, try our Mobile App.</li>`}if(settings.max\_points\_per\_order){htmlDiv+=`<li>- Maximum of ${settings.max\_points\_per\_order} ${mooGlobalParams.pointsLabel} can be earned per order.</li>`}if(settings.min\_points\_to\_order){htmlDiv+=`<li>- Minimum requirement of ${settings.min\_points\_to\_order} ${mooGlobalParams.pointsLabel} should be used per order.</li>`}if(settings.min\_amount\_to\_up){htmlDiv+=`<li>- Minimum order amount required to use ${mooGlobalParams.pointsLabel} is $${this.formatPrice(settings.min\_amount\_to\_up)}</li>`}const subTotalWithoutCoupons=this.getSubTotalWithoutCoupons();const maxPercent=settings.percent\_to\_cover?settings.percent\_to\_cover:100;htmlDiv+=`<li>- ${mooGlobalParams.pointsLabel} can cover up to ${maxPercent}% of $${this.formatPrice(subTotalWithoutCoupons)} (Subtotal - Coupon)</li>`;if(maxPointsAllowed>0){htmlDiv+=`<li>- Maximum of ${maxPointsAllowed} ${mooGlobalParams.pointsLabel} can be used for this order.</li>`}else{htmlDiv+=`<li>- ${mooGlobalParams.pointsLabel} can't be used for this order.</li>`}htmlDiv+=`<li>- <b>${earningMsg}</b></li>`;htmlDiv+="</ul></div></div></div>";Swal.fire({imageUrl:null,title:"Loyalty Conditions",html:htmlDiv,showCancelButton:false,allowOutsideClick:true}).then(function(){setTimeout(p=>$(".sooLoyaltyDetailsButton").focus(),500)})},removePoints:function(){mooGlobalParams.points=null;mooGlobalParams.pointsAmount=null;this.setLoyaltyError("");$("#sooSelectedPointsValue").val(0);$("#moo-checkout-form-loyalty > div.moo-checkout-bloc-content > div.moo-row.usePointsInput .sooToPayInfo > .sooToPayAmount").html("$0.00");this.updateTotalsSection(sooCheckout.options.totals)},getCouponByCode:function(code){const url=sooCheckout.options.restApiUrl+"moo-clover/v2/checkout/check\_coupon";return fetch(url,{method:"POST",mode:"cors",cache:"no-cache",credentials:"same-origin",headers:{"Content-Type":"application/json"},redirect:"follow",referrerPolicy:"no-referrer",body:JSON.stringify({code:code})})},canAcceptCoupons:function(){if(mooGlobalParams.selectedOrderType){return this.isTrue(mooGlobalParams.selectedOrderType.use\_coupons)}return true},canAcceptPoints:function(){if(mooGlobalParams.isGuest){return false}return sooCheckout.options.loyaltySetting!==null},isOrderTaxable:function(){if(mooGlobalParams.selectedOrderType&&!mooCheckout.isTrue(mooGlobalParams.selectedOrderType.taxable)){return false}return true},showCheckoutDetails:function(){this.changeElemVisibility("#sooAuthSection","hide");this.showOrHideASection("checkout-form",true);this.fillCustomerInfo();if(this.canAcceptPoints()){this.changeElemVisibility("#moo-checkout-form-loyalty","show");this.fillCustomerPointsBalance()}else{this.changeElemVisibility("#moo-checkout-form-loyalty","hide")}if(this.countAvailableOrderingMethods()===1){$('#moo-checkout-form-ordertypes input[name="ordertype"]:not(:disabled)').prop("checked",true);this.orderTypeChanged()}if(this.countAvailablePaymentMethods()===1){$('#moo-checkout-form-payments input[name="paymentMethod"]:not(:disabled)').prop("checked",true);this.paymentMethodChanged()}this.tipPercentageChanged();if(localStorage.getItem("soo-coupon")){$("#moo\_coupon").val(localStorage.getItem("soo-coupon"));mooCheckout.applyCoupon(false)}},getValueOfPoints:function(points){const settings=this.getLoyaltySettings();if(settings){return Math.round(points\*settings.per\_x\_usd/settings.nb\_points)}return 0},getLoyaltySettings:function(){return sooCheckout.options.loyaltySetting},getMaxPointsAllowed:function(){let customer=this.getLoggedInCustomer();if(customer){let percentAmount=100;const subTotalWithoutCoupons=this.getSubTotalWithoutCoupons();const settings=this.getLoyaltySettings();if(settings){if(!isNaN(parseInt(settings.percent\_to\_cover))){percentAmount=parseInt(settings.percent\_to\_cover)}}else{return 0}const amountToCover=subTotalWithoutCoupons\*percentAmount/100;const requiredPoints=Math.ceil(amountToCover\*settings.nb\_points/settings.per\_x\_usd);return Math.min(requiredPoints,customer.point\_count)}return 0},getEarningMessage:function(){let willBeEarned=0;const orderAmount=this.getOrderTotal();const settings=this.getLoyaltySettings();if(settings){if(settings.order\_source.website!==false){if(settings.purchase\_usd\_value){if(settings.calc\_method==="subtotal"){willBeEarned=Math.round(settings.purchase\_usd\_value\*sooCheckout.options.totals.sub\_total/100)}else{willBeEarned=Math.round(settings.purchase\_usd\_value\*orderAmount/100)}}else{willBeEarned=settings.purchase\_fixed\_points}if(!settings.earn\_on\_all\_order){if(mooGlobalParams.points>0){willBeEarned=0}}}if(willBeEarned>0){return`By placing this order you will earn ${willBeEarned} ${mooGlobalParams.pointsLabel}.`}else{return`No ${mooGlobalParams.pointsLabel} will be earned for this order.`}}else{return`<li>${mooGlobalParams.pointsLabel} can't be earned for this order.</li>`}},getSubTotalWithoutCoupons:function(){if(this.canAcceptCoupons()&&mooGlobalParams.couponAmount){return sooCheckout.options.totals.sub\_total-mooGlobalParams.couponAmount}else{return sooCheckout.options.totals.sub\_total}},getOrderTotal:function(){const cartTotals=sooCheckout.options.totals;const totals=mooCheckout.getTotals();let taxAmount=0;if(totals.orderTaxable){if(totals.discounts===0){taxAmount=cartTotals.taxes}else{taxAmount=cartTotals.taxes\_after\_discount}}return cartTotals.sub\_total+taxAmount+totals.deliveryAmount+totals.serviceFee-totals.discounts}};window.moo\_clover\_gateway={mountElements:function(){if(sooCheckout.options.creditCard){if($("#moo\_CloverCardNumber").length){window.clover\_card.mount("#moo\_CloverCardNumber");window.clover\_exp.mount("#moo\_CloverCardDate");window.clover\_cvc.mount("#moo\_CloverCardCvv");window.clover\_zip.mount("#moo\_CloverCardZip");if(window.clover\_streetAddress){window.clover\_streetAddress.mount("#moo\_CloverStreetAddress")}}}if(sooCheckout.options.giftCards){if($("#moo\_CloverGiftCard").length){window.clover\_giftCard.mount("#moo\_CloverGiftCard")}}if(sooCheckout.options.googlePay){if($("#moo-cloverGooglePay").length){window.clover\_googlepay.mount("#moo-cloverGooglePay")}}},createElements:function(){const elementStyles={input:{color:"#31325F",height:"30px","::placeholder":{color:"#CFD7E0"}}};if(sooCheckout.options.creditCard){window.clover\_card=window.elements.create("CARD\_NUMBER",elementStyles);window.clover\_exp=window.elements.create("CARD\_DATE",elementStyles);window.clover\_cvc=window.elements.create("CARD\_CVV",elementStyles);window.clover\_zip=window.elements.create("CARD\_POSTAL\_CODE",elementStyles);window.clover\_card.addEventListener("change",function(event){moo\_clover\_gateway.onCCFormChange();$(document.body).trigger("cloverError",event)});window.clover\_exp.addEventListener("change",function(event){moo\_clover\_gateway.onCCFormChange();$(document.body).trigger("cloverError",event)});window.clover\_cvc.addEventListener("change",function(event){moo\_clover\_gateway.onCCFormChange();$(document.body).trigger("cloverError",event)});window.clover\_zip.addEventListener("change",function(event){moo\_clover\_gateway.onCCFormChange();$(document.body).trigger("cloverError",event)});if(sooCheckout.options.showStreetAddressField){window.clover\_streetAddress=window.elements.create("CARD\_STREET\_ADDRESS",elementStyles);window.clover\_streetAddress.addEventListener("change",function(event){moo\_clover\_gateway.onCCFormChange();$(document.body).trigger("cloverError",event)})}}if(sooCheckout.options.giftCards){const giftCardStyles={input:{"border-radius":"5px",height:"45px",padding:"10px",color:"#31325F",border:"1px solid #ccc","::placeholder":{color:"#CFD7E0"}},body:{margin:"0;",border:"0.7px solid #B8B8B8FF;","border-radius":"10px;",padding:"10px;",width:"96%;","overflow-x":" hidden;"},".fieldError input":{"border-color":"red",color:"red"},".errorMessage":{color:"red","min-height":"10px;"},".sectionHeader":{display:"none"}};window.clover\_giftCard=window.elements.create("GIFT\_CARD\_ELEMENTS",giftCardStyles);window.clover\_giftCard.addEventListener("change",function(event){moo\_clover\_gateway.onGiftCardChange(event);$(document.body).trigger("cloverGiftCardError",event)})}if(sooCheckout.options.googlePay){const paymentReqData={total:{label:"Online Order",amount:sooCheckout.options.totals.sub\_total},options:{button:{buttonType:"long"}}};window.clover\_googlepay=window.elements.create("PAYMENT\_REQUEST\_BUTTON",{paymentReqData:paymentReqData});window.clover\_googlepay.addEventListener("paymentMethod",function(tokenData){window.googlePayToken=tokenData;try{$("#moo-cloverGooglePay").hide();$("#moo\_checkout\_loading").show();$("#moo-checkout .errors-section").html("");window.mooCheckout.getCheckoutForm()}catch(e){console.log(e);window.mooCheckout.showErrorAlert(mooObjectL10n.anErrorOccurred)}})}window.moo\_clover\_gateway.mountElements()},init:function(){$(document).on("cloverError",this.onError).on("cloverGiftCardError",this.onGiftCardError).on("checkout\_error",this.reset);moo\_clover\_gateway.createElements()},isMobile:function(){if(/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)){return true}return false},getSelectedPaymentElement:function(){return $('.payment\_methods input[name="payment\_method"]:checked')},createSource:function(){return clover.createToken().then(moo\_clover\_gateway.sourceResponse)},sourceResponse:function(response){if(response.error){return $(document.body).trigger("cloverError",response)}moo\_clover\_gateway.reset();$("#moo-CloverToken").val(response.token)},onCCFormChange:function(){},onGiftCardChange:function(e){console.log("onGiftCardChange");console.log(e)},reset:function(){if(!$("#moo-checkout-form-payments #moo-cloverCreditCardPanel .clover-error").length){}},onError:function(e,result){var hasError=false;var errorMessage="";if(result.CARD\_NUMBER.error){errorMessage=result.CARD\_NUMBER.error;hasError=true}else{if(result.CARD\_DATE.error){errorMessage=result.CARD\_DATE.error;hasError=true}else{if(result.CARD\_CVV.error){errorMessage=result.CARD\_CVV.error;hasError=true}else{if(result.CARD\_STREET\_ADDRESS&&result.CARD\_STREET\_ADDRESS.error){errorMessage=result.CARD\_STREET\_ADDRESS.error;hasError=true}else{if(result.CARD\_POSTAL\_CODE.error){errorMessage=result.CARD\_POSTAL\_CODE.error;hasError=true}}}}}window.cloverCardIsValid=!hasError;window.cloverCardErrorMsg=errorMessage;try{if(errorMessage===""){errorMessage=!result.CARD\_NUMBER.touched?mooObjectL10n.CardNumberRequired:!result.CARD\_DATE.touched?mooObjectL10n.CardDateRequired:!result.CARD\_CVV.touched?"Card Cvv is required":result.CARD\_STREET\_ADDRESS&&!result.CARD\_STREET\_ADDRESS.touched?mooObjectL10n.CardStreetAddressRequired:!result.CARD\_POSTAL\_CODE.touched?mooObjectL10n.CardZipRequired:window.cloverCardErrorMsg}if(errorMessage!==window.cloverCardErrorMsg){window.cloverCardIsValid=false;window.cloverCardErrorMsg=errorMessage}}catch(e){console.log(e)}},onGiftCardError:function(e,result){console.log(result);window.cloverGiftCardIsValid=result?.GIFT\_CARD\_ELEMENTS?.isFormValid;console.log(window.cloverGiftCardIsValid)},submitError:function(error\_message){}};$(document).ready(function(){window.mooCheckout.init();if(sooCheckout.options.pakmsKey){try{window.clover=new Clover(sooCheckout.options.pakmsKey,{locale:sooCheckout.options.locale});window.elements=window.clover.elements();window.cloverCardIsValid=false;window.cloverGiftCardIsValid=false;window.cloverCardErrorMsg=mooObjectL10n.CardNumberRequired;window.moo\_clover\_gateway.init()}catch(error){console.log(error)}}})}); |
  |  | 29 | </div></div>`;Swal.fire({title:"Edit Your Profile",html:form,showCancelButton:true,cancelButtonText:mooObjectL10n.cancel,confirmButtonText:mooObjectL10n.edit,showLoaderOnConfirm:true,preConfirm:()=>{const firstName=Swal.getPopup().querySelector("#sooContactFirstName").value;const lastName=Swal.getPopup().querySelector("#sooContactLastName").value;const email=Swal.getPopup().querySelector("#sooContactEmail").value;const phone=Swal.getPopup().querySelector("#sooContactPhone").value;if(firstName===""){Swal.showValidationMessage("Your name is required");return}if(email===""){Swal.showValidationMessage("Your email is required");return}if(phone===""){Swal.showValidationMessage("Your phone is required");return}const token=localStorage.getItem("customerJwtToken");return fetch(sooCheckout.options.restApiUrl+"moo-clover/v2/customers/me",{method:"POST",mode:"cors",cache:"no-cache",credentials:"same-origin",headers:{"Content-Type":"application/json",Authorization:"Bearer "+token},redirect:"follow",referrerPolicy:"no-referrer",body:JSON.stringify({email:email,first\_name:firstName,last\_name:lastName,phone:phone})}).then(response=>{return response.json()}).then(data=>{if(data.message){throw new Error(data.message)}else{if(data===false){throw new Error(mooObjectL10n.anErrorOccurred)}return data}}).catch(error=>{Swal.showValidationMessage(error)})},allowOutsideClick:false}).then(function(data){if(data.value){localStorage.setItem("loggedInCustomer",JSON.stringify(data.value));mooCheckout.loggedInCustomer=data.value;mooCheckout.fillCustomerInfo()}},function(data){if(data.dismiss==="cancel"){Swal.close()}})},logout:function(e){e.preventDefault();mooCheckout.loggedInCustomer=null;mooCheckout.loggedInCustomer=null;localStorage.removeItem("customerJwtToken");localStorage.removeItem("loggedInCustomer");this.uncheckSelectedOrderingMethod();this.uncheckSelectedPaymentMethod();this.updateTotals();this.showLoginSection();return false},continueAsGuest:function(e){e.preventDefault();mooGlobalParams.isGuest=true;history.pushState({},"Checkout");this.showCheckoutDetails();return false},hideLoadingCheckout(){$("#moo-checkout>#moo-login-section > div.sooOverlayLoader").hide()},showOrHideASection(section,show){$("div.moo-section").hide();const elem=$("#moo-"+section);if(show){elem.show()}else{elem.hide()}},showLoginSection(section,show){$("#sooAuthSection").show();$("div.moo-section").hide();$("#moo-login-section").show()},isCustomerLoggedIn(){return localStorage.getItem("customerJwtToken")!==null},getLoggedInCustomer(){if(localStorage.getItem("loggedInCustomer")){let customer=JSON.parse(localStorage.getItem("loggedInCustomer"));mooCheckout.loggedInCustomer=customer;return customer}return null},getGuestInfo(){const firstName=$("#MooContactFirstName").val();const lastName=$("#MooContactLastName").val();const email=$("#MooContactEmail").val();const phone=$("#MooContactPhone").val();return{first\_name:firstName.trim(),last\_name:lastName.trim(),email:email.trim(),phone:phone.trim(),isPhoneVerified:mooGlobalParams.isGuestPhoneVerified,address:this.getSelectedAddress(),full\_address:this.getSelectedAddressAsString()}},syncLoggedInCustomerProfile(){this.getCustomerProfile().then(async function(response){if(!response.ok){const message=`An error has occured: ${response.status}`;throw new Error(message)}return await response.json()}).then(data=>{localStorage.setItem("loggedInCustomer",JSON.stringify(data));mooCheckout.loggedInCustomer=data}).catch(error=>{console.log(error)})},getCustomerProfile(){let token=localStorage.getItem("customerJwtToken");return fetch(sooCheckout.options.restApiUrl+"moo-clover/v2/customers/me",{method:"GET",mode:"cors",cache:"no-cache",headers:{"Content-Type":"application/json",Authorization:"Bearer "+token},redirect:"follow",referrerPolicy:"no-referrer"})},fillCustomerInfo(){if(mooGlobalParams.isGuest){$("#moo-checkout-contact-form").show();$("#moo-checkout-contact-content").hide()}else{let customer=this.getLoggedInCustomer();if(customer){let name=null;if(customer.first\_name){name=customer.first\_name}if(customer.last\_name){name+=" "+customer.last\_name}if(!name){name=" "+customer.full\_name}$("#moo-checkout-contact-content .soo-contact-info-name").text(name);if(customer.is\_email\_verified){$("#moo-checkout-contact-content .soo-contact-info-email").text(customer.email+" ✓ ")}else{$("#moo-checkout-contact-content .soo-contact-info-email").text(customer.email)}if(customer.is\_phone\_verified){$("#moo-checkout-contact-content .soo-contact-info-phone").text(customer.phone+" ✓ ")}else{if(customer.phone===""){$("#moo-checkout-contact-content .soo-contact-info-phone").text("Phone not provided")}else{$("#moo-checkout-contact-content .soo-contact-info-phone").text(customer.phone)}}$("#moo-checkout-contact-form").hide();$("#moo-checkout-contact-content").show()}else{console.log("Can't get the customer, he must login again");this.showLoginSection()}}},fillCustomerPointsBalance(){let customer=this.getLoggedInCustomer();if(customer){let balance=0;let balanceUsdValue=0;if(customer.point\_count){balance=customer.point\_count;balanceUsdValue=this.getValueOfPoints(balance)}$("#moo-checkout-form-loyalty .loyaltyBalance > div.balance > span.balancePoints").text(balance+" "+mooGlobalParams.pointsLabel);$("#moo-checkout-form-loyalty .loyaltyBalance > div.balance > span.balanceAmount").text(this.formatPrice(balanceUsdValue));if(balance<=0){$("#moo-checkout-form-loyalty .loyaltyButtons > button.sooUsePointsButton").html("Loyalty Conditions").attr("onclick","mooCheckout.openLoyaltyDetails()").css("padding","2px");$("#moo-checkout-form-loyalty .loyaltyButtons").removeClass("moo-col-xs-4").addClass("moo-col-xs-6");$("#moo-checkout-form-loyalty .loyaltyBalance").removeClass("moo-col-xs-6").addClass("moo-col-xs-4")}}else{console.log("Can't get the customer, he must login again")}},shouldVerifyPhone:function(){if(!sooCheckout.options.useSmsVerification){return false}else{if(mooGlobalParams.isGuest){return mooGlobalParams.isGuestPhoneVerified===false}else{const customer=this.getLoggedInCustomer();if(customer){return customer.is\_phone\_verified===false}else{this.syncLoggedInCustomerProfile();return true}}}},loggedInCustomerPhoneIsVerified:function(){const customer=this.getLoggedInCustomer();if(customer){return customer.is\_phone\_verified}else{this.syncLoggedInCustomerProfile();return false}},isMobile:function(){if(/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)){return true}return false},getSelectedPaymentMethod:function(){var elm=$('#moo-checkout-form-payments input[name="paymentMethod"]:checked');if(elm.length>0&&elm.val()!==""){return elm.val()}return null},getSelectedOrderingMethod:function(){var elm=$('#moo-checkout-form-ordertypes input[name="ordertype"]:checked');if(elm.length){return elm.val()}return null},countAvailableOrderingMethods:function(){const elmOrderingMethods=$('#moo-checkout-form-ordertypes input[name="ordertype"]');const elmDisabledOrderingMethods=$('#moo-checkout-form-ordertypes input[name="ordertype"]:disabled');if(elmOrderingMethods.length){if(elmDisabledOrderingMethods.length){return elmOrderingMethods.length-elmDisabledOrderingMethods.length}else{return elmOrderingMethods.length}}else{return 0}},countAvailablePaymentMethods:function(){const elmPaymentMethods=$('#moo-checkout-form-payments input[name="paymentMethod"]');if(elmPaymentMethods.length){return elmPaymentMethods.length}else{return 0}},uncheckSelectedOrderingMethod:function(){const elm=$('#moo-checkout-form-ordertypes input[name="ordertype"]:checked');if(elm.length){elm.removeAttr("checked")}mooGlobalParams.selectedOrderType=null;mooGlobalParams.selectedAddress=null;mooGlobalParams.deliveryFees=null;mooGlobalParams.isDeliveryOrder=false;this.hideAddressSection();this.hideDeliveryAmount()},uncheckSelectedPaymentMethod:function(){const elm=$('#moo-checkout-form-payments input[name="paymentMethod"]:checked');if(elm.length){elm.removeAttr("checked")}this.hidePhoneVerificationSection();$("#moo-cloverCreditCardPanel").hide()},getCustomer:function(){if(mooGlobalParams.isGuest){return this.getGuestInfo()}else{const customer=this.getLoggedInCustomer();return{first\_name:customer.first\_name,last\_name:customer.last\_name,email:customer.email,phone:customer.phone,isPhoneVerified:customer.is\_phone\_verified,address:this.getSelectedAddress(),full\_address:this.getSelectedAddressAsString()}}},getTipAmount:function(){if(isNaN(mooGlobalParams.tipAmount)||mooCheckout.getSelectedPaymentMethod()==="cash"){return 0}return mooGlobalParams.tipAmount},getSelectedAddress:function(){return mooGlobalParams.selectedAddress},getSelectedAddressAsString:function(){var address=this.getSelectedAddress();var address\_string="";if(address){if(address.address)address\_string+=address.address+" ";if(address.line2)address\_string+=address.line2+" ";if(address.city)address\_string+=address.city+", ";if(address.state)address\_string+=address.state+" ";if(address.zipcode)address\_string+=address.zipcode}return address\_string},addNewAddress:function(e){e.preventDefault();if(mooCheckout.addAddressForm.data("submitted")===true){return false}else{mooCheckout.startSubmitingAform(mooCheckout.addAddressForm)}const formElements={fullNameInput:mooCheckout.addAddressForm.find("#sooAddAddressName"),addressInput:mooCheckout.addAddressForm.find("#sooAddAddressLine1"),line2Input:mooCheckout.addAddressForm.find("#sooAddAddressLine2"),cityInput:mooCheckout.addAddressForm.find("#sooAddAddressCity"),stateInput:mooCheckout.addAddressForm.find("#sooAddAddressState"),zipCodeInput:mooCheckout.addAddressForm.find("#sooAddAddressZipCode")};const requiredField=["addressInput","cityInput","stateInput","zipCodeInput"];for(const el in formElements){if(requiredField.includes(el)&&!formElements[el].val()){formElements[el].parent().addClass("moo-has-error");formElements[el].next().show();formElements[el].focus();mooCheckout.finishSubmitingAform(mooCheckout.addAddressForm);return}}mooGlobalParams.selectedAddress={full\_name:formElements.fullNameInput.val().trim(),address:formElements.addressInput.val().trim(),line2:formElements.line2Input.val().trim(),city:formElements.cityInput.val().trim(),state:formElements.stateInput.val().trim(),zipcode:formElements.zipCodeInput.val().trim()};if(mooGlobalParams.isGuest){if(mooGlobalParams.selectedOrderType){if(mooGlobalParams.selectedOrderType.ot\_uuid==="onDemandDelivery"){mooCheckout.finishSubmitingAform(mooCheckout.addAddressForm);mooCheckout.showListOfAddresses()}else{$.ajax({type:"POST",cache:false,url:sooCheckout.options.restApiUrl+"moo-clover/v3/geocode-address",headers:{"Content-Type":"application/json"},data:JSON.stringify(mooGlobalParams.selectedAddress)}).done(function(response){mooGlobalParams.selectedAddress.lat=response.lat;mooGlobalParams.selectedAddress.lng=response.lng;mooCheckout.finishSubmitingAform(mooCheckout.addAddressForm);const res=mooCheckout.calculateDeliveryFees(mooGlobalParams.selectedAddress.lat,mooGlobalParams.selectedAddress.lng);if(res.result==="zone\_error"){mooCheckout.showErrorAlert(res.message,"")}else{mooCheckout.showListOfAddresses()}}).fail(function(response){mooCheckout.finishSubmitingAform(mooCheckout.addAddressForm);let errorMsg="";if(response.responseJSON&&response.responseJSON.message){errorMsg=response.responseJSON.message}else{errorMsg=mooObjectL10n.anErrorOccurred}mooCheckout.showErrorAlert(errorMsg,mooObjectL10n.tryAgain);mooGlobalParams.selectedAddress=null})}}else{mooCheckout.showErrorAlert(mooObjectL10n.error,"Select an Ordering Method")}}else{let token=localStorage.getItem("customerJwtToken");if(!token){console.log("token not found")}$.ajax({type:"POST",cache:false,url:sooCheckout.options.restApiUrl+"moo-clover/v3/customers/addresses",headers:{"Content-Type":"application/json",Authorization:"Bearer "+token},data:JSON.stringify(mooGlobalParams.selectedAddress)}).done(function(address){if(address.id){mooCheckout.finishSubmitingAform(mooCheckout.addAddressForm);if(mooCheckout.loggedInCustomer.addresses.length>0){mooCheckout.loggedInCustomer.addresses.push(address)}else{mooCheckout.loggedInCustomer.addresses=[address]}mooCheckout.showListOfAddresses()}else{mooCheckout.showErrorAlert(mooObjectL10n.anErrorOccurred,"")}}).fail(function(data){mooCheckout.finishSubmitingAform(mooCheckout.addAddressForm);let errorMsg="";if(data.responseJSON&&data.responseJSON.message){errorMsg=data.responseJSON.message}else{errorMsg=mooObjectL10n.anErrorOccurred}mooCheckout.showErrorAlert(errorMsg,mooObjectL10n.tryAgain)})}},fillAddressToEdit:function(){if(mooGlobalParams.selectedAddress){const formElements={fullNameInput:mooCheckout.addAddressForm.find("#sooAddAddressName"),addressInput:mooCheckout.addAddressForm.find("#sooAddAddressLine1"),line2Input:mooCheckout.addAddressForm.find("#sooAddAddressLine2"),cityInput:mooCheckout.addAddressForm.find("#sooAddAddressCity"),stateInput:mooCheckout.addAddressForm.find("#sooAddAddressState"),zipCodeInput:mooCheckout.addAddressForm.find("#sooAddAddressZipCode")};if(mooGlobalParams.selectedAddress.full\_name){formElements.fullNameInput.val(mooGlobalParams.selectedAddress.full\_name)}if(mooGlobalParams.selectedAddress.address){formElements.addressInput.val(mooGlobalParams.selectedAddress.address)}if(mooGlobalParams.selectedAddress.line2){formElements.line2Input.val(mooGlobalParams.selectedAddress.line2)}if(mooGlobalParams.selectedAddress.city){formElements.cityInput.val(mooGlobalParams.selectedAddress.city)}if(mooGlobalParams.selectedAddress.state){formElements.stateInput.val(mooGlobalParams.selectedAddress.state)}if(mooGlobalParams.selectedAddress.zipcode){formElements.zipCodeInput.val(mooGlobalParams.selectedAddress.zipcode)}}},setAddress:function(address){localStorage.setItem("selectedAddress",JSON.stringify(address))},isPhoneVerificationActivated:function(){return sooCheckout.options.useSmsVerification},orderTypeChanged:function(){if(mooGlobalParams.selectedOrderType&&mooCheckout.getSelectedOrderingMethod()===mooGlobalParams.selectedOrderType.ot\_uuid){console.log("order type not changed");return}mooGlobalParams.selectedOrderType=mooCheckout.getOneOrderType(mooCheckout.getSelectedOrderingMethod());if(mooGlobalParams.selectedOrderType){const orderType=mooGlobalParams.selectedOrderType;mooGlobalParams.deliveryFees=0;if(this.isTrue(mooGlobalParams.selectedOrderType.allow\_sc\_order)&&sooCheckout.options.allowScOrder){mooGlobalParams.allowScOrders=true;this.showOrderingTime()}else{mooGlobalParams.allowScOrders=false;this.hideOrderingTime()}if(this.isTrue(mooGlobalParams.selectedOrderType.show\_sa)){mooGlobalParams.isDeliveryOrder=true;this.showListOfAddresses();this.showDeliveryAmount();if(mooGlobalParams.allowScOrders){this.changeOrderingTimes("delivery")}if(sooCheckout.options.cashUponDelivery&&orderType.ot\_uuid!=="onDemandDelivery"){$("#moo-checkout-form-payincash-label").text(mooObjectL10n.payUponDelivery);this.showCashPayment()}else{this.hideCashPayment()}}else{mooGlobalParams.isDeliveryOrder=false;mooGlobalParams.deliveryFees=0;mooGlobalParams.selectedAddress=null;this.hideAddressSection();this.hideDeliveryAmount();if(mooGlobalParams.allowScOrders){this.changeOrderingTimes("pickup")}if(sooCheckout.options.cashInStore){$("#moo-checkout-form-payincash-label").text(mooObjectL10n.payAtlocation);this.showCashPayment()}else{this.hideCashPayment()}}if(this.isTrue(mooGlobalParams.selectedOrderType.use\_coupons)){this.showCouponsSection()}else{this.hideCouponsSection()}this.updateTotals()}else{console.log("No OrderType found")}},paymentMethodChanged:function(){const selectedPaymentMethod=mooCheckout.getSelectedPaymentMethod();if(selectedPaymentMethod==="cash"){this.hideTipSection();$("#moo-cloverCreditCardPanel").hide();$("#moo-cloverGiftCardPanel").hide();if(this.shouldVerifyPhone()){this.showPhoneVerificationSection()}$("#moo\_btn\_submit\_order").show();$("#moo-cloverGooglePay").hide();$("#mooGooglePaySection").hide()}if(selectedPaymentMethod==="clover"){this.showTipSection();this.hidePhoneVerificationSection();$("#moo-cloverGiftCardPanel").hide();$("#moo\_btn\_submit\_order").show();$("#moo-cloverGooglePay").hide();$("#mooGooglePaySection").hide();$("#moo-cloverCreditCardPanel").show()}if(selectedPaymentMethod==="giftcard"){this.showTipSection();$("#moo-cloverCreditCardPanel").hide();this.hidePhoneVerificationSection();$("#moo-cloverGiftCardPanel").show();$("#moo\_btn\_submit\_order").show();$("#moo-cloverGooglePay").hide();$("#mooGooglePaySection").hide()}if(selectedPaymentMethod==="googlepay"){this.showTipSection();$("#moo-cloverCreditCardPanel").hide();this.hidePhoneVerificationSection();$("#moo-cloverGiftCardPanel").hide();$("#moo\_btn\_submit\_order").hide();$("#moo-cloverGooglePay").show();$("#mooGooglePaySection").show()}this.updateTotalsSection(sooCheckout.options.totals)},orderingTimeChanged:function(element){this.updateSelectedTime()},orderingDayChanged:function(element){let html="";const theDay=$(element).val();const times=mooGlobalParams.isDeliveryOrder?sooCheckout.options.deliveryTimes[theDay]:sooCheckout.options.pickupTimes[theDay];if(!(typeof times==="undefined")){html+='<option value="Select a time">Select a time</option>';for(let i in times){html+='<option value="'+times[i]+'">'+times[i]+"</option>"}}else{html=""}$("#moo\_pickup\_hour").html(html);this.updateSelectedTime()},tipPercentageChanged:function(){const selectedPercentAmount=$("#moo\_tips\_select").val();if(selectedPercentAmount&&selectedPercentAmount!=="cash"&&selectedPercentAmount!=="other"){const calculatedAmount=sooCheckout.options.totals.sub\_total\*selectedPercentAmount/100;mooGlobalParams.tipAmount=Math.round(parseInt(calculatedAmount))}else{mooGlobalParams.tipAmount=0;if(selectedPercentAmount==="other"){$("#moo\_tips").select()}}$("#moo\_tips").val(this.formatPrice(mooGlobalParams.tipAmount));this.updateTotalsSection(sooCheckout.options.totals)},tipAmountChanged:function(){const calculatedAmount=parseInt(Math.ceil(parseFloat($("#moo\_tips").val())\*100));const amount=Math.round(calculatedAmount);if(!isNaN(amount)&&amount>0){mooGlobalParams.tipAmount=amount;$("#moo\_tips").val(this.formatPrice(mooGlobalParams.tipAmount))}else{mooGlobalParams.tipAmount=0;$("#moo\_tips").val("0.00")}this.updateTotalsSection(sooCheckout.options.totals)},showListOfAddresses:function(){$("#moo-checkout-form-ordertypes .soo-address-section .soo-add-delivery-address-form").hide();var listAddrElm=$("#moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses");listAddrElm.show();listAddrElm.html("<div  class='soo-addresses-wrapper'><div class='soo-addresses-title'>Loading your addresses...</div></div>");let html="<div  class='soo-addresses-wrapper'>";html+="<div class='soo-estimate-loader'></div>";let addressesProcessed=0;let nbOfAddresses=0;let addresses=[];let cssClasses="";if(mooGlobalParams.isGuest){if(mooGlobalParams.selectedAddress){nbOfAddresses=1;addresses=[mooGlobalParams.selectedAddress]}else{mooCheckout.showAddAddressForm();$("#soo-add-address-form > div > div > button.sooCheckoutSecondaryButtonInput").hide();return}}else{if(mooCheckout.loggedInCustomer){addresses=mooCheckout.loggedInCustomer.addresses;nbOfAddresses=addresses?addresses.length:0}}if(nbOfAddresses===1){mooGlobalParams.selectedAddress=addresses[0];cssClasses="soo-selected";html+="<div class='soo-addresses-title'>Delivery to :</div>"}else{html+="<div class='soo-addresses-title'>Choose a delivery address</div>"}if(nbOfAddresses>0){addresses.forEach(element=>{if(mooGlobalParams.selectedAddress&&mooGlobalParams.selectedAddress.id===element.id){cssClasses="soo-selected"}else{cssClasses=""}html+="<div class='soo-one-address "+cssClasses+"' id='soo-address-"+element.id+"' onclick='mooCheckout.selectAnAddress("+element.id+")'>";if(typeof element.full\_name!=="undefined"&&element.full\_name!==null){html+="<div class='soo-one-address-name'>"+element.full\_name+"</div>"}html+="<div class='soo-one-address-line1'>"+element.address+"</div>";if(element.line2){html+="<div class='soo-one-address-line2'>"+element.line2+"</div>"}html+="<div class='soo-one-address-line2'>"+element.city+" "+element.state+", "+element.zipcode+"</div>";html+="<div class='soo-address-error'></div>";html+="<div class='soo-delivery-amount'></div>";html+="</div>";addressesProcessed++;if(addressesProcessed>=nbOfAddresses){if(mooGlobalParams.isGuest){html+="</div><div class='soo-add-new-address-button'><span onclick='mooCheckout.showEditAddressForm()'>Edit Address</span></div>"}else{html+="</div><div class='soo-add-new-address-button'><span onclick='mooCheckout.showAddAddressForm()'>Add New Address</span></div>"}listAddrElm.html(html);mooCheckout.syncDeliveryFee()}})}else{mooCheckout.showAddAddressForm()}},showAddAddressForm:function(){$("#moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses").hide();$("#moo-checkout-form-ordertypes .soo-address-section .soo-add-delivery-address-form").show();$("#soo-add-address-form > div > div > button.sooCheckoutSecondaryButtonInput").show()},showEditAddressForm:function(){this.showAddAddressForm();if(mooGlobalParams.selectedAddress){this.fillAddressToEdit()}},hideAddressSection:function(){$("#moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses").hide();$("#moo-checkout-form-ordertypes .soo-address-section .soo-add-delivery-address-form").hide()},hideCouponsSection:function(){$("#moo-checkout-form-coupon").hide()},showCouponsSection:function(){$("#moo-checkout-form-coupon").show()},showDeliveryAmount:function(){$("#sooDeliveryFeeTotalSection").show()},hideDeliveryAmount:function(){$("#sooDeliveryFeeTotalSection").hide()},showServiceFeeAmount:function(){$("#sooServiceFeeTotalSection").show()},hideServiceFeeAmount:function(){$("#sooServiceFeeTotalSection").hide()},showTipSection:function(){$("#sooTipsTotalSection").show();$("#moo-checkout-form-tips").show()},hideTipSection:function(){$("#sooTipsTotalSection").hide();$("#moo-checkout-form-tips").hide()},showCashPayment:function(){$(".moo-checkout-form-payments-cash-container").show();$("#moo-checkout-form-payments-cash").val("cash")},hideCashPayment:function(){$(".moo-checkout-form-payments-cash-container").hide();$("#moo\_cashPanel").hide();$("#moo-checkout-form-payments-cash").val("");if(this.getSelectedPaymentMethod()==="cash"){this.uncheckSelectedPaymentMethod()}},hidePhoneVerificationSection:function(){$("#moo\_cashPanel").hide()},showPhoneVerificationSection:function(){clearInterval(mooGlobalParams.timer);$("#moo\_cashPanel").show();const seconds=120;if(mooGlobalParams.isOtpCodeSent){this.changeElemVisibility("#moo\_cashPanel > div.soo-phone-button","hide");this.changeElemVisibility("#moo\_cashPanel > div.soo-phone-input","show");$("#moo\_cashPanel > div.soo-phone-verif-title").text("Sent sms verification to: "+this.getPhoneNumber());$("#moo\_cashPanel > div.soo-phone-verif-footer").html("Resend code in <span class='timer'>"+seconds+"</span> seconds");mooGlobalParams.timer=setInterval(this.countDown,1e3)}else{this.changeElemVisibility("#moo\_cashPanel > div.soo-phone-button","show");this.changeElemVisibility("#moo\_cashPanel > div.soo-phone-input","hide");$("#moo\_cashPanel > div.soo-phone-verif-title").text("We will send a verification code via SMS to your number");$("#moo\_cashPanel > div.soo-phone-verif-footer").html("")}},selectAnAddress:function(id){if(!mooGlobalParams.isGuest){$("#moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses .soo-one-address").removeClass("soo-selected soo-selected-error soo-selected-warning");$("#moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses .soo-one-address .soo-address-error").text("");$("#moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses .soo-one-address .soo-delivery-amount").text("");$("#moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses #soo-address-"+id).addClass("soo-selected");mooGlobalParams.selectedAddress=this.getAddressById(id);this.syncDeliveryFee()}},unSelectAddress:function(id){$("#moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses .soo-one-address").removeClass("soo-selected soo-selected-error soo-selected-warning");$("#moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses .soo-one-address .soo-address-error").text("");$("#moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses .soo-one-address .soo-delivery-amount").text("")},syncDeliveryFee:function(){if(mooGlobalParams.selectedAddress){const addrElm=$("#moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses #soo-address-"+mooGlobalParams.selectedAddress.id);const amountPos=-1/2\*parseFloat(addrElm.css("height"))+6;if(mooGlobalParams.selectedOrderType&&mooGlobalParams.selectedOrderType.ot\_uuid==="onDemandDelivery"){$(".soo-delivery-amount",addrElm).css("top",amountPos+"px");this.createOnDemandDeliveryEstimate()}else{const res=this.calculateDeliveryFees(mooGlobalParams.selectedAddress.lat,mooGlobalParams.selectedAddress.lng);if(res.result==="success"){mooGlobalParams.selectedAddress.isValid=true;let deliveryAmount;if(!isNaN(res.amount)&&res.amount>0){mooGlobalParams.deliveryFees=res.amount;deliveryAmount=parseFloat(res.amount/100).toFixed(2);deliveryAmount="+ $"+deliveryAmount}else{mooGlobalParams.deliveryFees=0;deliveryAmount="Free"}$(".soo-delivery-amount",addrElm).text(deliveryAmount).css("top",amountPos+"px")}else{mooGlobalParams.selectedAddress.isValid=false}if(res.result==="zone\_error"){addrElm.addClass("soo-selected-error");$(".soo-address-error",addrElm).text(res.message);mooGlobalParams.deliveryFees=null}if(res.result==="min\_error"){addrElm.addClass("soo-selected-warning");$(".soo-address-error",addrElm).text(res.message);mooGlobalParams.deliveryFees=null}mooCheckout.updateTotals()}}},getAddressById:function(id){if(mooCheckout.loggedInCustomer){for(var i=0;i<mooCheckout.loggedInCustomer.addresses.length;i++){if(mooCheckout.loggedInCustomer.addresses[i].id===id)return mooCheckout.loggedInCustomer.addresses[i]}}return null},getOneOrderType:function(orderTypeUuid){if(typeof sooCheckout.options.orderTypes!=="undefined"){for(var i in sooCheckout.options.orderTypes){if(orderTypeUuid===sooCheckout.options.orderTypes[i].ot\_uuid){return sooCheckout.options.orderTypes[i]}}}return null},changeElemVisibility:function(selector,showOrHide){if(showOrHide==="show"){$(selector).show()}if(showOrHide==="hide"){$(selector).hide()}},hideOrderingTime:function(){this.changeElemVisibility("#moo-checkout-form-orderdate","hide")},showOrderingTime:function(){this.changeElemVisibility("#moo-checkout-form-orderdate","show")},getPhoneNumber:function(){if(mooGlobalParams.isGuest){const customer=this.getGuestInfo();return customer.phone}else{const customer=this.getLoggedInCustomer();return customer.phone}},sendCodeToVerifyPhone:function(){const btnSend=$("#moo\_cashPanel > div.soo-phone-button > button");const btnSendTxt=btnSend.html();const phone=this.getPhoneNumber();const seconds=120;if(phone===""){mooCheckout.showErrorAlert(mooObjectL10n.enterYourPhone,"");return}btnSend.html('<div class="dot-flashing"></div>');let token=localStorage.getItem("customerJwtToken");if(!token&&!mooGlobalParams.isGuest){return}const url=mooGlobalParams.isGuest?"moo-clover/v2/guests/send-code":"moo-clover/v2/customers/send-code";fetch(sooCheckout.options.restApiUrl+url,{method:"POST",mode:"cors",cache:"no-cache",credentials:"same-origin",headers:{"Content-Type":"application/json",Authorization:"Bearer "+token},redirect:"follow",referrerPolicy:"no-referrer",body:JSON.stringify({phone:phone})}).then(response=>{if(!response.ok){return response.json()}else{mooGlobalParams.isOtpCodeSent=true;this.showPhoneVerificationSection();btnSend.html(btnSendTxt);return response.json()}}).then(data=>{btnSend.html(btnSendTxt);if(typeof data!=="undefined"&&data.message){if(data.message==="You just sent the verification code please try later"){mooGlobalParams.isOtpCodeSent=true;this.showPhoneVerificationSection()}else{Swal.fire({icon:"success",title:data.message})}}else{if(data===false){throw mooObjectL10n.anErrorOccurred}}}).catch(error=>{btnSend.html(btnSendTxt);mooCheckout.showErrorAlert(error,"")})},verifyCodeSentToPhone:function(){const btn=$("#moo\_cashPanel > div.soo-phone-input > button");const btnTxt=btn.html();const numReg=/^\d+\.?\d\*$/;const phone=this.getPhoneNumber();const code=$("#moo\_cashPanel > div.soo-phone-input > input").val();const seconds=120;if(code.length!==6||!numReg.test(code)){mooCheckout.showErrorAlert(mooObjectL10n.codeInvalid,mooObjectL10n.codeInvalidDetails);return}btn.html('<div class="dot-flashing"></div>');let token=localStorage.getItem("customerJwtToken");if(!token&&!mooGlobalParams.isGuest){return}const url=mooGlobalParams.isGuest?"moo-clover/v2/guests/check-code":"moo-clover/v2/customers/check-code";fetch(sooCheckout.options.restApiUrl+url,{method:"POST",mode:"cors",cache:"no-cache",credentials:"same-origin",headers:{"Content-Type":"application/json",Authorization:"Bearer "+token},redirect:"follow",referrerPolicy:"no-referrer",body:JSON.stringify({code:code,phone:phone})}).then(response=>{if(!response.ok){return response.json()}else{btn.html(btnTxt);clearInterval(mooGlobalParams.timer);mooCheckout.showSuccessAlert(mooObjectL10n.phoneVerified,mooObjectL10n.phoneVerifiedDetails);mooGlobalParams.isOtpCodeSent=false;this.hidePhoneVerificationSection();if(mooGlobalParams.isGuest){mooGlobalParams.isGuestPhoneVerified=true}else{this.getCustomerProfile().then(async function(response){if(!response.ok){const message=`An error has occured: ${response.status}`;throw new Error(message)}return await response.json()}).then(data=>{localStorage.setItem("loggedInCustomer",JSON.stringify(data));mooCheckout.loggedInCustomer=data;mooCheckout.fillCustomerInfo()}).catch(error=>{console.log(error)})}}}).then(data=>{btn.html(btnTxt);if(typeof data!=="undefined"&&data.message){throw data.message}else{if(data===false){throw mooObjectL10n.anErrorOccurred}}}).catch(error=>{btn.html(btnTxt);mooCheckout.showErrorAlert(error,"")})},countDown:function(){let sec=parseInt($("#moo\_cashPanel > div.soo-phone-verif-footer>.timer").text());$("#moo\_cashPanel > div.soo-phone-verif-footer>.timer").text(--sec);if(sec<=0){$("#moo\_cashPanel > div.soo-phone-verif-footer").html("<div onclick='mooCheckout.sendCodeToVerifyPhone()'>Resend code</div>");clearInterval(mooGlobalParams.timer)}},finalizeOrder:function(e){e.preventDefault();$("#moo\_btn\_submit\_order").hide();$("#moo\_checkout\_loading").show();$("#moo-checkout .errors-section").html("");try{window.mooCheckout.getCheckoutForm()}catch(e){console.log(e);window.mooCheckout.stopLoading();window.mooCheckout.showErrorAlert(mooObjectL10n.anErrorOccurred)}},verifyCheckoutForm:function(form){var regex\_exp={email:/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)\*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/};var message\_errors={};const selectedOrderType=mooGlobalParams.selectedOrderType;if(form.customer.first\_name===""&&form.customer.last\_name===""){mooCheckout.showErrorAlert(mooObjectL10n.enterYourName,"","#MooContactFirstName");return false}if(form.customer.email===""||!regex\_exp.email.test(form.customer.email)){mooCheckout.showErrorAlert(mooObjectL10n.enterYourEmail,mooObjectL10n.enterYourEmailReason,"#MooContactEmail");return false}if(form.customer.phone===""){mooCheckout.showErrorAlert(mooObjectL10n.enterYourPhone,mooObjectL10n.enterYourPhoneReason,"#MooContactPhone");return false}if(document.getElementById("moo-checkout-form-ordertypes")){if(typeof form.order\_type==="undefined"||form.order\_type===""){mooCheckout.showErrorAlert(mooObjectL10n.chooseOrderingMethod,mooObjectL10n.chooseOrderingMethodReason,"#moo-checkout-form-ordertypes");return false}}if(selectedOrderType){var minAmount=parseFloat(selectedOrderType.minAmount);var maxAmount=parseFloat(selectedOrderType.maxAmount);if(!isNaN(minAmount)){minAmount=minAmount\*100;minAmount=Math.round(minAmount\*100)/100;if(minAmount>0&&minAmount>sooCheckout.options.totals.sub\_total){this.stopLoading();Swal.fire({title:mooObjectL10n.YouDidNotMeetMinimum,text:mooObjectL10n.orderingMethodSubtotalGreaterThan+mooformatCentPrice(minAmount),icon:"warning",showCancelButton:true,confirmButtonColor:"#DD6B55",confirmButtonClass:"fontSizeLg",confirmButtonText:mooObjectL10n.continueToCheckout,cancelButtonText:mooObjectL10n.continueShopping}).then(data=>{if(data.dismiss&&data.dismiss==="cancel"){if(sooCheckout.options.storeLink){window.location.href=sooCheckout.options.storeLink}}});return false}}if(!isNaN(maxAmount)){maxAmount=maxAmount\*100;maxAmount=Math.round(maxAmount\*100)/100;if(maxAmount&&maxAmount<sooCheckout.options.totals.sub\_total){this.stopLoading();Swal.fire({title:mooObjectL10n.reachedMaximumPurchaseAmount,text:mooObjectL10n.orderingMethodSubtotalLessThan+mooformatCentPrice(maxAmount),icon:"warning",showCancelButton:true,confirmButtonColor:"#DD6B55",confirmButtonText:mooObjectL10n.updateCart,cancelButtonText:mooObjectL10n.checkout,closeOnConfirm:false}).then(function(data){if(data.value){Swal.close();window.location.href=moo\_params.cartPage}});return false}}if(mooCheckout.isTrue(selectedOrderType.show\_sa)){if(mooGlobalParams.selectedAddress){if(!mooGlobalParams.selectedAddress.isValid){mooCheckout.showErrorAlert(mooObjectL10n.verifyYourAddress,"Sorry, we are unable to deliver to this address. Please provide a different address or kindly get in touch with us if you feel are within the delivery range.","#moo-checkout-form-ordertypes>.moo-checkout-bloc-message");return false}}else{mooCheckout.showErrorAlert(mooObjectL10n.addDeliveryAddress,mooObjectL10n.addDeliveryAddressReason,"#moo-checkout-form-ordertypes>.moo-checkout-bloc-message .MooSimplButon");return false}}}if(mooGlobalParams.allowScOrders){if(sooCheckout.options.orderingTimeRequired){if(form.pickup\_hour===""||form.pickup\_hour==="Select a time"){mooCheckout.showErrorAlert(mooObjectL10n.chooseTime,"","#moo-checkout-form-orderdate");return false}}}if(sooCheckout.options.specialInstructionsRequired){if(typeof form.special\_instructions==="undefined"||form.special\_instructions===""){mooCheckout.showErrorAlert(mooObjectL10n.SpecialInstructionsRequired,"","#moo-checkout-form-instruction");return false}}if(form.tip\_amount>0&&this.getOrderTotal()===0){mooCheckout.showErrorAlert("Unable to Include Tips for $0 Orders","To enhance your experience, kindly note that we are unable to include tips when the Order Total is $0. However, you have the option to show your appreciation by providing a tip upon order pickup or delivery. We appreciate your understanding.","#moo-checkout-form-tips");return false}if(typeof form.payment\_method==="undefined"||form.payment\_method===""){mooCheckout.showErrorAlert(mooObjectL10n.choosePaymentMethod,"","#moo-checkout-form-payments");return false}else{if(form.payment\_method==="cash"){if(mooCheckout.shouldVerifyPhone()){if(mooGlobalParams.isGuest&&!mooGlobalParams.isGuestPhoneVerified||!mooGlobalParams.isGuest&&!mooCheckout.loggedInCustomerPhoneIsVerified()){mooCheckout.showPhoneVerificationSection();mooCheckout.showErrorAlert(mooObjectL10n.verifyYourPhone,mooObjectL10n.verifyYourPhoneReason,"#moo-checkout-form-payments");return false}}this.submitForm(form)}if(form.payment\_method==="clover"){if(window.cloverCardIsValid){window.clover.createToken().then(function(response){if(response.token){form.token=response.token;form.card=response.card;window.mooCheckout.submitForm(form)}else{mooCheckout.showErrorAlert(mooObjectL10n.verifyYourCreditCard,"","#moo-checkout-form-payments");return false}})}else{mooCheckout.showErrorAlert(mooObjectL10n.verifyYourCreditCard,window.cloverCardErrorMsg,"#moo-checkout-form-payments");return false}}if(form.payment\_method==="giftcard"){if(window.cloverGiftCardIsValid){try{const timeoutId=setTimeout(()=>{mooCheckout.showErrorAlert("Please verify the gift card information","","#moo-checkout-form-payments")},1e4);window.clover.createGiftCardToken().then(function(response){clearTimeout(timeoutId);if(response.token){form.payment\_method="clover";form.selected\_payment\_method="giftcard";form.token=response.token;window.mooCheckout.submitForm(form)}else{mooCheckout.showErrorAlert("Please verify the gift card information","","#moo-checkout-form-payments");return false}})}catch(err){console.log(err)}}else{mooCheckout.showErrorAlert("Please verify the gift card information","","#moo-checkout-form-payments");return false}}if(form.payment\_method==="googlepay"){if(window.googlePayToken){try{form.payment\_method="clover";form.token=window.googlePayToken.token;form.selected\_payment\_method="googlepay";form.googledata=window.googlePayToken;window.mooCheckout.submitForm(form)}catch(err){console.log(err)}}else{mooCheckout.showErrorAlert("Please Try Again","","#moo-checkout-form-payments");return false}}}},getCheckoutForm:function(){var form={channel:"website",customer:null,metainfo:[{name:"source\_url",value:window.location.href},{name:"checkout\_version",value:"new"}]};form.customer=mooCheckout.getCustomer();form.tip\_amount=mooCheckout.getTipAmount();form.special\_instructions=$("#Mooinstructions").val();form.pickup\_day=$("#moo\_pickup\_day").val();form.pickup\_hour=$("#moo\_pickup\_hour").val();form.orderingTime=mooGlobalParams.selectedTime;if(document.getElementById("moo-checkout-form-ordertypes")){form.order\_type=$('input[name="ordertype"]:checked').val()}form.payment\_method=$('#moo-checkout-form-payments input[name="paymentMethod"]:checked').val();form.delivery\_amount=mooCheckout.getDeliveryFees();form.service\_fee=mooCheckout.getServiceFees();if(this.canAcceptCoupons()){form.coupon={code:mooGlobalParams.couponCode}}if(this.canAcceptPoints()){form.use\_points=parseInt(mooGlobalParams.points)}form.totals=mooCheckout.getTotals();this.verifyCheckoutForm(form)},submitForm:function(form){if(form.order\_type==="onDemandDelivery"){let deliveryTime=(new Date).toISOString();if(mooGlobalParams.selectedTime){deliveryTime=mooGlobalParams.selectedTime}this.createDeliveryEstimate().then(response=>{if(!response.ok){throw new Error(mooObjectL10n.anErrorOccurred)}else{return response.json()}}).then(res=>{if(res.status==="success"){form.delivery\_estimate=res;form.delivery\_time=deliveryTime;this.createOrder(form)}else{throw new Error(res.message)}}).catch(err=>{this.showErrorAlert(err.message,"")})}else{this.createOrder(form)}},createOrder:function(form){if(sooCheckout.options.reCAPTCHA\_site\_key){grecaptcha.ready(function(){grecaptcha.execute(sooCheckout.options.reCAPTCHA\_site\_key,{action:"createOrder"}).then(token=>{console.log(token);form.reCAPTCHA\_token=token;mooCheckout.sendCreateOrder(form)})})}else{mooCheckout.sendCreateOrder(form)}return;let headers={"Content-Type":"application/json"};if(this.isCustomerLoggedIn()){form.customer\_token=localStorage.getItem("customerJwtToken")}$.ajax({type:"POST",cache:false,url:sooCheckout.options.restApiUrl+"moo-clover/v2/checkout",headers:headers,data:JSON.stringify(form)}).done(function(data){if(typeof data=="object"){if(data.status==="success"){mooCheckout.trackConversion(true,form);mooCheckout.successfulOrder(data.id)}else{mooCheckout.trackConversion(false,form);mooCheckout.failedOrder(data.message)}}else{if(data.indexOf('"status":"success"')!==-1){mooCheckout.trackConversion(true,form);mooCheckout.successfulOrder("")}else{mooCheckout.trackConversion(false,form);mooCheckout.failedOrder("")}}}).fail(function(data){console.log("FAIL");console.log(data.responseText);if(data.responseText.indexOf('"status":"success"')!==-1){mooCheckout.trackConversion(true,form);mooCheckout.successfulOrder("")}else{mooCheckout.trackConversion(false,form);mooCheckout.failedOrder("")}})},sendCreateOrder:function(form){let headers={"Content-Type":"application/json"};if(this.isCustomerLoggedIn()){form.customer\_token=localStorage.getItem("customerJwtToken")}$.ajax({type:"POST",cache:false,url:sooCheckout.options.restApiUrl+"moo-clover/v2/checkout",headers:headers,data:JSON.stringify(form)}).done(function(data){if(typeof data=="object"){if(data.status==="success"){mooCheckout.trackConversion(true,form);mooCheckout.successfulOrder(data.id)}else{mooCheckout.trackConversion(false,form);mooCheckout.failedOrder(data.message)}}else{if(data.indexOf('"status":"success"')!==-1){mooCheckout.trackConversion(true,form);mooCheckout.successfulOrder("")}else{mooCheckout.trackConversion(false,form);mooCheckout.failedOrder("")}}}).fail(function(data){console.log("FAIL");console.log(data.responseText);if(data.responseText.indexOf('"status":"success"')!==-1){mooCheckout.trackConversion(true,form);mooCheckout.successfulOrder("")}else{mooCheckout.trackConversion(false,form);mooCheckout.failedOrder("")}})},successfulOrder:function(orderId){if(sooCheckout.options.thanksPage&&sooCheckout.options.thanksPage!==""){window.location.href=sooCheckout.options.thanksPage+"?order\_id="+orderId}else{let html='<div class="moo-alert moo-alert-success" role="alert" style="font-size: 20px;text-align: center">';html+=mooObjectL10n.thanksForOrder;html+="<br/>";html+=mooObjectL10n.orderBeingPrepared;if(orderId!==""){html+="<br>";html+=mooObjectL10n.seeReceipt;html+=sooCheckout.options.isSandbox?' <a href="https://sandbox.dev.clover.com/r/'+orderId+'" target="\_blank">':' <a href="https://www.clover.com/r/'+orderId+'" target="\_blank">';html+=mooObjectL10n.here;html+="</a>"}html+="</div>";$("#moo\_checkout\_msg").remove();$("#moo-checkout").html("");if(sooCheckout.delivery.moo\_merchantAddress!==""){$("#moo-checkout").parent().prepend("<div style='text-align: center'><p style='font-size: 21px;'>"+mooObjectL10n.ourAddress+" : </p>"+sooCheckout.delivery.moo\_merchantAddress+"</div>")}$("#moo-checkout").parent().prepend(html);$("html, body").animate({scrollTop:0},600)}},failedOrder:function(failureMessage){let html="";this.stopLoading();if(failureMessage&&failureMessage!==""&&failureMessage!==undefined){html='<div class="moo-alert moo-alert-danger" role="alert" id="moo\_checkout\_msg">'+failureMessage+"</div>"}else{html='<div class="moo-alert moo-alert-warning" role="alert" id="moo\_checkout\_msg"><strong>';html+=mooObjectL10n.cannotSendEntireOrder;html+="</strong></div>"}$("#moo-checkout .errors-section").html(html);$("html, body").animate({scrollTop:0},600)},getCustomerSelectedAddress:function(){return{}},getDeliveryFees:function(){return mooGlobalParams.deliveryFees},getServiceFees:function(){let fee=sooCheckout.options.feeAmount;if(fee){if(mooGlobalParams.selectedOrderType){if(mooCheckout.isTrue(mooGlobalParams.selectedOrderType.allow\_service\_fee)){if(sooCheckout.options.feeType==="amount"){return fee}else{return Math.round(fee\*sooCheckout.options.totals.sub\_total/100)}}}else{if($("#sooServiceFeeTotalSection").css("display")==="block"){if(sooCheckout.options.feeType==="amount"){return fee}else{return Math.round(fee\*sooCheckout.options.totals.sub\_total/100)}}}}return 0},createOnDemandDeliveryEstimate:function(){if(mooGlobalParams.selectedAddress){const addrElm=$("#moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses #soo-address-"+mooGlobalParams.selectedAddress.id);const loader=$("#moo-checkout-form-ordertypes div.soo-address-section > div.soo-list-of-addresses > div.soo-addresses-wrapper>.soo-estimate-loader");$("#moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses .soo-one-address").removeClass("soo-selected-error soo-selected-warning");$("#moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses .soo-one-address .soo-address-error").text("");$("#moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses .soo-one-address .soo-delivery-amount").text("");$(".soo-delivery-amount",addrElm).html('<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" class="BpkSpinner\_bpk-spinner\_\_NjNlZ BpkSpinner\_bpk-spinner--primary\_\_YTQxN"><rect width="4" height="2" y="7" opacity=".45" rx="1"></rect><rect width="4" height="2" x="12" y="7" rx="1"></rect><rect width="4" height="2" x="7" y="16" opacity=".3" rx="1" transform="rotate(-90 7 16)"></rect><rect width="4" height="2" x="7" y="4" opacity=".65" rx="1" transform="rotate(-90 7 4)"></rect><rect width="4" height="2" x="11.134" y="15.428" opacity=".25" rx="1" transform="rotate(-120 11.134 15.428)"></rect><rect width="4" height="2" x="5.134" y="5.036" opacity=".55" rx="1" transform="rotate(-120 5.134 5.036)"></rect><rect width="4" height="2" x="14.428" y="12.866" opacity=".2" rx="1" transform="rotate(-150 14.428 12.866)"></rect><rect width="4" height="2" x="4.036" y="6.866" opacity=".5" rx="1" transform="rotate(-150 4.036 6.866)"></rect><rect width="4" height="2" x="15.428" y="4.866" opacity=".85" rx="1" transform="rotate(150 15.428 4.866)"></rect><rect width="4" height="2" x="5.036" y="10.866" opacity=".4" rx="1" transform="rotate(150 5.036 10.866)"></rect><rect width="4" height="2" x="12.866" y="1.572" opacity=".75" rx="1" transform="rotate(120 12.866 1.572)"></rect><rect width="4" height="2" x="6.866" y="11.964" opacity=".35" rx="1" transform="rotate(120 6.866 11.964)"></rect></svg>');loader.show();let deliveryTime=(new Date).toISOString();if(mooGlobalParams.selectedTime){deliveryTime=mooGlobalParams.selectedTime}this.createDeliveryEstimate().then(response=>{if(!response.ok){$(".soo-delivery-amount",addrElm).text("");loader.hide();mooCheckout.unSelectAddress();if(mooGlobalParams.selectedAddress){mooGlobalParams.selectedAddress.isValid=false}throw new Error(mooObjectL10n.anErrorOccurred)}else{return response.json()}}).then(res=>this.displayDeliveryAmountForAddress(res)).catch(err=>{mooCheckout.showErrorAlert(err.message,"")})}},calculateDeliveryFees:function(lat,lng){var order\_total=parseFloat(sooCheckout.options.totals.sub\_total);const delivery\_free\_after=Math.round(parseFloat(sooCheckout.delivery.free\_amount)\*100);const delivery\_fixed\_amount=Math.round(parseFloat(sooCheckout.delivery.fixed\_amount)\*100);const delivery\_for\_other\_zone=Math.round(parseFloat(sooCheckout.delivery.other\_zone\_fee)\*100);let moo\_delivery\_areas=null;try{moo\_delivery\_areas=JSON.parse(sooCheckout.delivery.zones)}catch(e){console.log("Parsing error: moo\_delivery\_areas")}if(!isNaN(delivery\_fixed\_amount)){return{result:"success",amount:delivery\_fixed\_amount,message:null}}if(!(lat!==""&&lng!=="")){return{result:"zone\_error",amount:null,message:mooObjectL10n.deliveryZoneNotSupported}}else{var zones\_contain\_point=[];for(const i in moo\_delivery\_areas){var zone=moo\_delivery\_areas[i];if(zone.feeType==="percent"){zone.fee=parseFloat(zone.fee)}else{zone.fee=Math.round(parseFloat(zone.fee)\*100)}zone.minAmount=Math.round(parseFloat(zone.minAmount)\*100);if(zone.type==="polygon"){if(google.maps.geometry.poly.containsLocation(new google.maps.LatLng(parseFloat(lat),parseFloat(lng)),new google.maps.Polygon({paths:zone.path}))){zones\_contain\_point.push({zone\_id:zone.id,zone\_fee:zone.fee,feeType:zone.feeType,minAmount:zone.minAmount})}}if(zone.type==="circle"){var point=new google.maps.LatLng(parseFloat(lat),parseFloat(lng));var center=new google.maps.LatLng(parseFloat(zone.center.lat),parseFloat(zone.center.lng));if(google.maps.geometry.spherical.computeDistanceBetween(point,center)<=zone.radius){zones\_contain\_point.push({zone\_id:zone.id,zone\_fee:zone.fee,feeType:zone.feeType,minAmount:zone.minAmount})}}}if(zones\_contain\_point.length>=1){var delivery\_final\_amount=zones\_contain\_point[0].feeType==="percent"?zones\_contain\_point[0].zone\_fee\*order\_total/100:zones\_contain\_point[0].zone\_fee;var delivery\_zone\_id=zones\_contain\_point[0].zone\_id;var delivery\_zone\_minAmount=zones\_contain\_point[0].minAmount;for(const i in zones\_contain\_point){if(zones\_contain\_point[i].feeType==="percent"){const amount=parseFloat(zones\_contain\_point[i].zone\_fee)\*order\_total/100;if(delivery\_final\_amount>=amount){delivery\_final\_amount=amount;delivery\_zone\_id=zones\_contain\_point[i].zone\_id;delivery\_zone\_minAmount=zones\_contain\_point[i].minAmount}}else{if(delivery\_final\_amount>=zones\_contain\_point[i].zone\_fee){delivery\_final\_amount=zones\_contain\_point[i].zone\_fee;delivery\_zone\_id=zones\_contain\_point[i].zone\_id;delivery\_zone\_minAmount=zones\_contain\_point[i].minAmount}}}if(!isNaN(delivery\_zone\_minAmount)){if(delivery\_zone\_minAmount>sooCheckout.options.totals.sub\_total){return{result:"min\_error",amount:null,message:mooObjectL10n.minimumForDeliveryZone+parseFloat(delivery\_zone\_minAmount/100).toFixed(2)}}}if(isNaN(delivery\_free\_after)){return{result:"success",amount:delivery\_final\_amount,message:null}}else{var amountToAdd=delivery\_free\_after-order\_total;if(amountToAdd<=0){return{result:"success",amount:0,message:null}}else{Swal.fire({title:mooObjectL10n.spend+parseFloat(delivery\_free\_after/100).toFixed(2)+" "+mooObjectL10n.toGetFreeDelivery,text:"Add $"+parseFloat(amountToAdd/100).toFixed(2)+" to your order to enjoy free delivery",icon:"warning",showCancelButton:true,confirmButtonColor:"#6e7881",confirmButtonClass:"fontSizeLg",cancelButtonColor:"#DD6B55",confirmButtonText:mooObjectL10n.continueToCheckout,cancelButtonText:mooObjectL10n.continueShopping}).then(data=>{if(data.dismiss&&data.dismiss==="cancel"){if(sooCheckout.options.storeLink){window.location.href=sooCheckout.options.storeLink}else{window.history.back()}}});if(amountToAdd>0&&amountToAdd<delivery\_final\_amount){delivery\_final\_amount=amountToAdd}return{result:"success",amount:delivery\_final\_amount,message:null}}}}else{if(isNaN(delivery\_for\_other\_zone)){return{result:"zone\_error",amount:null,message:mooObjectL10n.deliveryZoneNotSupported}}else{return{result:"success",amount:delivery\_for\_other\_zone,message:null}}}}},formatPrice:function(priceInCentes){var p=priceInCentes/100;p=p.toFixed(2);return p.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,")},updateTotals:function(){const totals=sooCheckout.options.totals;if(totals===false){return}const deliveryAmount=this.getDeliveryFees();const serviceFee=this.getServiceFees();const discounts=this.getDiscountedAmount();this.startLoadingDeliveryFee();this.getOrderTotals(deliveryAmount+serviceFee,discounts,this.updateTotalsSection)},getTotals:function(){return{tipAmount:mooCheckout.getTipAmount(),deliveryAmount:mooCheckout.getDeliveryFees(),serviceFee:this.getServiceFees(),discounts:this.getDiscountedAmount(),couponAmount:mooGlobalParams.couponAmount,pointsAmount:mooGlobalParams.pointsAmount,grandTotal:mooGlobalParams.grandTotal,orderTaxable:mooCheckout.isOrderTaxable()}},updateTotalsSection:function(totals){mooGlobalParams.grandTotal=0;const tips\_amount=mooCheckout.getTipAmount();const delivery\_amount=mooCheckout.getDeliveryFees();const service\_fee=mooCheckout.getServiceFees();const discounts=mooCheckout.getDiscountedAmount();const orderTaxable=mooCheckout.isOrderTaxable();if(service\_fee===0){mooCheckout.hideServiceFeeAmount()}else{mooCheckout.showServiceFeeAmount();$("#sooServiceFeeTotalSection > .moo-totals-value").text(" $"+mooCheckout.formatPrice(service\_fee))}mooCheckout.stopLoadingDeliveryFee();if(discounts===0){$("#sooCouponTotalSection").hide();$("#sooPointsTotalSection").hide()}else{if(mooCheckout.canAcceptCoupons()&&mooGlobalParams.couponAmount){$("#sooCouponTotalSection").show();$("#sooCouponName").text(mooGlobalParams.couponName);$("#sooCouponValue").text(" -$"+mooCheckout.formatPrice(mooGlobalParams.couponAmount))}else{$("#sooCouponTotalSection").hide()}if(mooCheckout.canAcceptPoints()&&mooGlobalParams.pointsAmount){$("#sooPointsTotalSection").show();$("#sooPointslabel").text(mooGlobalParams.points+" "+mooGlobalParams.pointsLabel);$("#sooPointsValue").text(" -$"+mooCheckout.formatPrice(mooGlobalParams.pointsAmount))}else{$("#sooPointsTotalSection").hide()}}$(".moo-totals-value").fadeOut(300,function(){$("#moo-cart-subtotal").html("$"+mooCheckout.formatPrice(totals.sub\_total));$("#moo-cart-tip").html("$"+mooCheckout.formatPrice(tips\_amount));$("#moo-cart-delivery-fee").html("$"+mooCheckout.formatPrice(delivery\_amount));if(orderTaxable){if(discounts===0){mooGlobalParams.grandTotal=totals.sub\_total+totals.taxes+tips\_amount+delivery\_amount+service\_fee;$("#moo-cart-tax").html("$"+mooCheckout.formatPrice(totals.taxes));$("#moo-cart-total").html("$"+mooCheckout.formatPrice(mooGlobalParams.grandTotal))}else{mooGlobalParams.grandTotal=totals.sub\_total+totals.taxes\_after\_discount+tips\_amount+delivery\_amount+service\_fee-discounts;$("#moo-cart-tax").html("$"+mooCheckout.formatPrice(totals.taxes\_after\_discount));$("#moo-cart-total").html("$"+mooCheckout.formatPrice(mooGlobalParams.grandTotal))}}else{mooGlobalParams.grandTotal=totals.sub\_total+tips\_amount+delivery\_amount+service\_fee-discounts;$("#moo-cart-tax").html("0.00");$("#moo-cart-total").html("$"+mooCheckout.formatPrice(mooGlobalParams.grandTotal))}$(".moo-totals-value").fadeIn(300)})},getOrderTotals:function(charges,discounts,callback){$.ajax({type:"POST",cache:false,url:sooCheckout.options.restApiUrl+"moo-clover/v3/checkout/order\_totals",contentType:"application/json; charset=UTF-8",data:JSON.stringify({charges:charges,discounts:discounts})}).done(function(data){sooCheckout.options.totals=data;callback(data)}).fail(function(data){console.log("FAIL");console.log(data.responseText)})},showErrorAlert:function(title,message,focusOnElem=null){this.stopLoading();if(focusOnElem){Swal.fire({title:title,text:message,icon:"error"}).then(function(){setTimeout(function(){$(focusOnElem).focus()},500)})}else{Swal.fire({title:title,text:message,icon:"error"})}},showSuccessAlert:function(title,message,focusOnElem=null){this.stopLoading();if(focusOnElem){Swal.fire(title,message,"success").then(function(){setTimeout(function(){$(focusOnElem).focus()},500)})}else{Swal.fire(title,message,"success")}},stopLoading:function(){if(this.getSelectedPaymentMethod()==="googlepay"){$("#moo\_checkout\_loading").hide();$("#moo-cloverGooglePay").show()}else{$("#moo\_checkout\_loading").hide();$("#moo\_btn\_submit\_order").show()}},startLoadingDeliveryFee:function(){$("#sooDeliveryFeeTotalSection").addClass("moo-fade-in");$(".moo-totals-item-total").addClass("moo-fade-in")},stopLoadingDeliveryFee:function(){$("#sooDeliveryFeeTotalSection").removeClass("moo-fade-in");$(".moo-totals-item-total").removeClass("moo-fade-in")},trackConversion:function(status,form){if(typeof dataLayer!=="undefined"){try{if(status){dataLayer.push({event:"OrderCreated",amount:sooCheckout.options.totals.total/100,taxes:sooCheckout.options.totals.total\_of\_taxes/100,tips:form.tip\_amount/100,nbOfItems:sooCheckout.options.totals.nb\_items})}else{dataLayer.push({event:"OrderNotCreated",amount:sooCheckout.options.totals.total/100,taxes:sooCheckout.options.totals.total\_of\_taxes/100,tips:form.tip\_amount/100,nbOfItems:sooCheckout.options.totals.nb\_items})}}catch(e){console.log(e)}}},isTrue:function(param){return param===true||param===1||param==="1"||param==="true"},changeOrderingTimes:function(type){var dayInput=$("#moo\_pickup\_day");var hoursInput=$("#moo\_pickup\_hour");var html\_days="";var html\_hours="";let times=null;if(type==="pickup"){if(sooCheckout.options.pickupTimes===null){$("#moo-checkout-form-orderdate .extra-info").html("There are no time slots available. Please try again later. Thank you for your understanding and patience.");return}for(let i in sooCheckout.options.pickupTimes){html\_days+='<option value="'+i+'">'+i+"</option>"}times=sooCheckout.options.pickupTimes[Object.keys(sooCheckout.options.pickupTimes)[0]]}if(type==="delivery"){if(sooCheckout.options.deliveryTimes===null){$("#moo-checkout-form-orderdate .extra-info").html("There are no time slots available. Please try again later. Thank you for your understanding and patience.");return}for(var i in sooCheckout.options.deliveryTimes){html\_days+='<option value="'+i+'">'+i+"</option>"}times=sooCheckout.options.deliveryTimes[Object.keys(sooCheckout.options.deliveryTimes)[0]]}if(times){html\_hours+='<option value="Select a time">Select a time</option>';for(let i in times){html\_hours+='<option value="'+times[i]+'">'+times[i]+"</option>"}}else{html\_hours=""}hoursInput.html(html\_hours);dayInput.html(html\_days)},updateSelectedTime:function(){const day=$("#moo\_pickup\_day").val();let time=$("#moo\_pickup\_hour").val();if(day!==""){if(time==="ASAP"){}if(time!==""&&time!=="Select a time"){const today=new Date;let str="";if(day==="Today"){str=today.toDateString()}else{str=day+" "+today.getFullYear()}if(time==="ASAP"){time=today.toTimeString()}str+=" "+time.substring(0,time.length-2)+":00 "+time.substring(time.length-2,time.length);let selectedDay=new Date(str);mooGlobalParams.selectedTime=selectedDay;if(mooGlobalParams.selectedOrderType&&mooGlobalParams.selectedOrderType.ot\_uuid==="onDemandDelivery"){this.createOnDemandDeliveryEstimate()}return}}mooGlobalParams.selectedTime=null},getDiscountedAmount:function(){let discounts=0;if(this.canAcceptCoupons()&&mooGlobalParams.couponAmount){discounts+=mooGlobalParams.couponAmount}if(this.canAcceptPoints()&&mooGlobalParams.pointsAmount){discounts+=mooGlobalParams.pointsAmount}return discounts},createDeliveryEstimate:function(){let deliveryTime=(new Date).toISOString();if(mooGlobalParams.selectedTime){deliveryTime=mooGlobalParams.selectedTime}const url=sooCheckout.options.restApiUrl+"moo-clover/v3/delivery-estimate";return fetch(url,{method:"POST",mode:"cors",cache:"no-cache",credentials:"same-origin",headers:{"Content-Type":"application/json"},redirect:"follow",referrerPolicy:"no-referrer",body:JSON.stringify({dropoff\_address:{street:mooGlobalParams.selectedAddress.address,unit:mooGlobalParams.selectedAddress.line2,city:mooGlobalParams.selectedAddress.city,state:mooGlobalParams.selectedAddress.state,zip\_code:mooGlobalParams.selectedAddress.zipcode},order\_value:sooCheckout.options.totals.sub\_total,delivery\_time:deliveryTime})})},displayDeliveryAmountForAddress:function(res){if(!mooGlobalParams.selectedAddress){return}$("#moo-checkout-form-ordertypes div.soo-address-section > div.soo-list-of-addresses > div.soo-addresses-wrapper>.soo-estimate-loader").hide();const addrElm=$("#moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses #soo-address-"+mooGlobalParams.selectedAddress.id);$(".soo-delivery-amount",addrElm).text("");if(res.status==="success"){$(addrElm).addClass("soo-selected");let deliveryAmount;mooGlobalParams.selectedAddress.isValid=true;if(res.minAmount&&res.minAmount>0&&res.minAmount>sooCheckout.options.totals.sub\_total){const message=mooObjectL10n.minimumForDeliveryZone+parseFloat(res.minAmount/100).toFixed(2);mooCheckout.unSelectAddress();addrElm.addClass("soo-selected-warning");$(".soo-address-error",addrElm).text(message);mooGlobalParams.deliveryFees=null}if(res.freeAfter&&res.freeAfter>0&&res.freeAfter<=sooCheckout.options.totals.sub\_total){mooGlobalParams.deliveryFees=0;deliveryAmount="Free"}else{if(res.fee>0){mooGlobalParams.deliveryFees=res.fee;deliveryAmount=parseFloat(res.fee/100).toFixed(2);deliveryAmount="+ $"+deliveryAmount}else{mooGlobalParams.deliveryFees=0;deliveryAmount="Free"}}$(".soo-delivery-amount",addrElm).text(deliveryAmount)}else{mooGlobalParams.selectedAddress.isValid=false;mooCheckout.unSelectAddress()}if(res.status==="failed"){if(res.code==="zone\_not\_supported"){addrElm.addClass("soo-selected-error");$(".soo-address-error",addrElm).text(res.message);mooGlobalParams.deliveryFees=null}if(["min\_amount\_not\_valid","delivery\_time\_not\_valid"].includes(res.code)){addrElm.addClass("soo-selected-warning");$(".soo-address-error",addrElm).text(res.message);mooGlobalParams.deliveryFees=null}}mooCheckout.updateTotals()},applyCoupon:function(showError=true){const btnRemove=$("#moo-checkout-form-coupon div > button.sooDeleteCouponButton.sooCheckoutPrimaryButtonInput");const btn=$("#moo-checkout-form-coupon div > button.sooApplyCouponButton.sooCheckoutPrimaryButtonInput");const btnTxt=btn.html();btn.html('<div class="dot-flashing"></div>');mooGlobalParams.couponCode=$("#moo\_coupon").val();if(mooGlobalParams.couponCode){mooGlobalParams.couponCode=mooGlobalParams.couponCode.trim();this.getCouponByCode(mooGlobalParams.couponCode).then(res=>{if(res.ok){return res.json()}throw new Error(mooObjectL10n.anErrorOccurred)}).then(res=>{if(res.status==="success"&&res.coupon){let discountAmount=0;const minValue=Math.round(parseFloat(res.coupon.minAmount)\*100);const maxValue=Math.round(parseFloat(res.coupon.maxValue)\*100);if(sooCheckout.options.totals.sub\_total<=0||typeof sooCheckout.options.totals.sub\_total===undefined){throw new Error(mooObjectL10n.cartEmpty)}else{if(!isNaN(minValue)){if(sooCheckout.options.totals.sub\_total<minValue){throw new Error("Minimum order amount to use this coupon is $"+this.formatPrice(minValue))}}}if(res.coupon.type.toUpperCase()==="AMOUNT"){discountAmount=Math.round(parseFloat(res.coupon.value)\*100);mooGlobalParams.couponName=res.coupon.name}else{discountAmount=Math.round(parseFloat(res.coupon.value)\*sooCheckout.options.totals.sub\_total/100);mooGlobalParams.couponName=res.coupon.name}mooGlobalParams.couponAmount=Math.min(sooCheckout.options.totals.sub\_total,discountAmount);if(!isNaN(maxValue)){if(mooGlobalParams.couponAmount>maxValue){mooGlobalParams.couponAmount=maxValue}}this.updateTotals();if(this.canAcceptPoints()&&mooGlobalParams.points>0){if(this.getOrderTotal()<0){this.clickOnRemovePoints();const additionalMsg=` and your previously used loyalty ${mooGlobalParams.pointsLabel} have been reset. Please take a moment to use review them again`;const txt=mooObjectL10n.receivedDiscountUSD+this.formatPrice(mooGlobalParams.couponAmount)+additionalMsg;this.showSuccessAlert(mooObjectL10n.couponApplied,txt)}}else{const txt=mooObjectL10n.receivedDiscountUSD+this.formatPrice(mooGlobalParams.couponAmount);this.showSuccessAlert(mooObjectL10n.couponApplied,txt)}btn.html(btnTxt).hide();$("#moo\_coupon").attr("readonly",true).attr("disabled",true);btnRemove.show()}else{if(showError){throw new Error(res.message)}else{$("#moo\_coupon").val("");btn.html(btnTxt)}}}).catch(err=>{this.showErrorAlert(mooObjectL10n.error,err.message);btn.html(btnTxt)})}else{this.showErrorAlert(mooObjectL10n.error,mooObjectL10n.enterCouponCode,"#moo\_coupon");btn.html(btnTxt)}},removeCoupon:function(){const btnApply=$("#moo-checkout-form-coupon div > button.sooApplyCouponButton.sooCheckoutPrimaryButtonInput");const btn=$("#moo-checkout-form-coupon div > button.sooDeleteCouponButton.sooCheckoutPrimaryButtonInput");const btnTxt=btn.html();btn.html('<div class="dot-flashing"></div>');mooGlobalParams.couponCode=null;mooGlobalParams.couponAmount=null;mooGlobalParams.couponName=null;this.updateTotals();btn.html(btnTxt);btn.hide();btnApply.show();$("#moo\_coupon").val("").attr("readonly",false).attr("disabled",false)},clickOnUsePoints:function(){$("#moo-checkout-form-loyalty .loyaltyButtons > .sooUsePointsButton").hide();$("#moo-checkout-form-loyalty .loyaltyButtons > .sooRemovePointsButton").show();$("#moo-checkout-form-loyalty .usePointsInput").show();this.setLoyaltyError("");$("#moo-checkout-form-loyalty .usePointsInput .sooValidatePoints .sooValidatePointsButton").show();$("#moo-checkout-form-loyalty .usePointsInput .sooValidatePoints .sooEditPointsButton").hide();$("#sooSelectedPointsValue").attr("disabled",false).attr("readonly",false)},clickOnRemovePoints:function(){this.removePoints();$("#moo-checkout-form-loyalty .loyaltyButtons > .sooUsePointsButton").show();$("#moo-checkout-form-loyalty .loyaltyButtons > .sooRemovePointsButton").hide();$("#moo-checkout-form-loyalty .usePointsInput").hide();this.updateTotalsSection(sooCheckout.options.totals)},changePointsValue:function(){this.setLoyaltyError("");const points=$("#sooSelectedPointsValue").val();if(points.match(/^[0-9]+$/)&&points>0){const maxAllowed=this.getMaxPointsAllowed();const amount=this.getValueOfPoints(points);if(amount>0){const elm=$("#moo-checkout-form-loyalty > div.moo-checkout-bloc-content > div.moo-row.usePointsInput  .sooToPayInfo > .sooToPayAmount");elm.html("$"+this.formatPrice(amount))}if(maxAllowed<points){if(maxAllowed===0){this.setLoyaltyError(`${mooGlobalParams.pointsLabel} can't be used for this order.`)}else{this.setLoyaltyError("The maximum number of "+mooGlobalParams.pointsLabel+" that can be used is "+maxAllowed)}}}else{this.setLoyaltyError("Not a valid number")}},usePoints:function(){this.setLoyaltyError("");const points=$("#sooSelectedPointsValue").val();if(points.match(/^[0-9]+$/)&&points>0){const customer=this.getLoggedInCustomer();const settings=this.getLoyaltySettings();const maxAllowed=this.getMaxPointsAllowed();if(!customer||!settings){this.setLoyaltyError("Your session has been expired, please refresh the page");return}if(customer.point\_count<points){this.setLoyaltyError("Insufficient balance");return}if(settings.min\_points\_to\_order&&settings.min\_points\_to\_order>points){this.setLoyaltyError("The store owner has set a minimum requirement of "+settings.min\_points\_to\_order+" "+mooGlobalParams.pointsLabel+" per order.");return}if(settings.min\_amount\_to\_up&&settings.min\_amount\_to\_up>sooCheckout.options.totals.sub\_total){this.setLoyaltyError("Minimum order amount to use points is $"+this.formatPrice(settings.min\_amount\_to\_up));return}if(maxAllowed<points){if(maxAllowed===0){this.setLoyaltyError(`${mooGlobalParams.pointsLabel} can't be used for this order.`)}else{this.setLoyaltyError("The maximum number of "+mooGlobalParams.pointsLabel+" that can be used is "+maxAllowed)}return}mooGlobalParams.points=points;mooGlobalParams.pointsAmount=Math.min(this.getValueOfPoints(points),this.getSubTotalWithoutCoupons());this.updateTotals();$("#moo-checkout-form-loyalty .usePointsInput .sooValidatePoints .sooValidatePointsButton").hide();$("#moo-checkout-form-loyalty .usePointsInput .sooValidatePoints .sooEditPointsButton").show();$("#sooSelectedPointsValue").attr("disabled",true).attr("readonly",true)}else{this.setLoyaltyError("Not a valid number")}},editPoints:function(){mooGlobalParams.points=null;mooGlobalParams.pointsAmount=null;this.setLoyaltyError("");$("#moo-checkout-form-loyalty .usePointsInput .sooValidatePoints .sooValidatePointsButton").show();$("#moo-checkout-form-loyalty .usePointsInput .sooValidatePoints .sooEditPointsButton").hide();$("#sooSelectedPointsValue").attr("disabled",false).attr("readonly",false);this.updateTotalsSection(sooCheckout.options.totals)},setLoyaltyError:function(err){$("#moo-checkout-form-loyalty > div.moo-checkout-bloc-content > div.moo-row.usePointsInput .moo-error-section").html(err).show()},openLoyaltyDetails:function(){const settings=this.getLoyaltySettings();const maxPointsAllowed=this.getMaxPointsAllowed();const earningMsg=this.getEarningMessage();if(!settings){this.showErrorAlert(mooObjectL10n.error,mooObjectL10n.anErrorOccurred);return}let htmlDiv='<div class="soo-loyalty-conditions"><div class="moo-row"><div class="moo-col-md-12"><ul>';htmlDiv+=`<li>- Get $${this.formatPrice(settings.per\_x\_usd)} discount when redeeming ${settings.nb\_points} ${mooGlobalParams.pointsLabel}</li>`;if(settings.purchase\_usd\_value){if(settings.calc\_method==="subtotal"){htmlDiv+=`<li>- Earn ${settings.purchase\_usd\_value} ${mooGlobalParams.pointsLabel} for every dollar spent (based on Subtotal).</li>`}else{htmlDiv+=`<li>- Earn ${settings.purchase\_usd\_value} ${mooGlobalParams.pointsLabel} for every dollar spent.</li>`}}else{htmlDiv+=`<li>- Earn ${settings.purchase\_fixed\_points} ${mooGlobalParams.pointsLabel} on each order placed.</li>`}if(settings.order\_source.website===false){htmlDiv+=`<li>- ${mooGlobalParams.pointsLabel} not earned for purchases made through our website, try our Mobile App.</li>`}if(settings.max\_points\_per\_order){htmlDiv+=`<li>- Maximum of ${settings.max\_points\_per\_order} ${mooGlobalParams.pointsLabel} can be earned per order.</li>`}if(settings.min\_points\_to\_order){htmlDiv+=`<li>- Minimum requirement of ${settings.min\_points\_to\_order} ${mooGlobalParams.pointsLabel} should be used per order.</li>`}if(settings.min\_amount\_to\_up){htmlDiv+=`<li>- Minimum order amount required to use ${mooGlobalParams.pointsLabel} is $${this.formatPrice(settings.min\_amount\_to\_up)}</li>`}const subTotalWithoutCoupons=this.getSubTotalWithoutCoupons();const maxPercent=settings.percent\_to\_cover?settings.percent\_to\_cover:100;htmlDiv+=`<li>- ${mooGlobalParams.pointsLabel} can cover up to ${maxPercent}% of $${this.formatPrice(subTotalWithoutCoupons)} (Subtotal - Coupon)</li>`;if(maxPointsAllowed>0){htmlDiv+=`<li>- Maximum of ${maxPointsAllowed} ${mooGlobalParams.pointsLabel} can be used for this order.</li>`}else{htmlDiv+=`<li>- ${mooGlobalParams.pointsLabel} can't be used for this order.</li>`}htmlDiv+=`<li>- <b>${earningMsg}</b></li>`;htmlDiv+="</ul></div></div></div>";Swal.fire({imageUrl:null,title:"Loyalty Conditions",html:htmlDiv,showCancelButton:false,allowOutsideClick:true}).then(function(){setTimeout(p=>$(".sooLoyaltyDetailsButton").focus(),500)})},removePoints:function(){mooGlobalParams.points=null;mooGlobalParams.pointsAmount=null;this.setLoyaltyError("");$("#sooSelectedPointsValue").val(0);$("#moo-checkout-form-loyalty > div.moo-checkout-bloc-content > div.moo-row.usePointsInput .sooToPayInfo > .sooToPayAmount").html("$0.00");this.updateTotalsSection(sooCheckout.options.totals)},getCouponByCode:function(code){const url=sooCheckout.options.restApiUrl+"moo-clover/v2/checkout/check\_coupon";return fetch(url,{method:"POST",mode:"cors",cache:"no-cache",credentials:"same-origin",headers:{"Content-Type":"application/json"},redirect:"follow",referrerPolicy:"no-referrer",body:JSON.stringify({code:code})})},canAcceptCoupons:function(){if(mooGlobalParams.selectedOrderType){return this.isTrue(mooGlobalParams.selectedOrderType.use\_coupons)}return true},canAcceptPoints:function(){if(mooGlobalParams.isGuest){return false}return sooCheckout.options.loyaltySetting!==null},isOrderTaxable:function(){if(mooGlobalParams.selectedOrderType&&!mooCheckout.isTrue(mooGlobalParams.selectedOrderType.taxable)){return false}return true},showCheckoutDetails:function(){this.changeElemVisibility("#sooAuthSection","hide");this.showOrHideASection("checkout-form",true);this.fillCustomerInfo();if(this.canAcceptPoints()){this.changeElemVisibility("#moo-checkout-form-loyalty","show");this.fillCustomerPointsBalance()}else{this.changeElemVisibility("#moo-checkout-form-loyalty","hide")}if(this.countAvailableOrderingMethods()===1){$('#moo-checkout-form-ordertypes input[name="ordertype"]:not(:disabled)').prop("checked",true);this.orderTypeChanged()}if(this.countAvailablePaymentMethods()===1){$('#moo-checkout-form-payments input[name="paymentMethod"]:not(:disabled)').prop("checked",true);this.paymentMethodChanged()}this.tipPercentageChanged();if(localStorage.getItem("soo-coupon")){$("#moo\_coupon").val(localStorage.getItem("soo-coupon"));mooCheckout.applyCoupon(false)}},getValueOfPoints:function(points){const settings=this.getLoyaltySettings();if(settings){return Math.round(points\*settings.per\_x\_usd/settings.nb\_points)}return 0},getLoyaltySettings:function(){return sooCheckout.options.loyaltySetting},getMaxPointsAllowed:function(){let customer=this.getLoggedInCustomer();if(customer){let percentAmount=100;const subTotalWithoutCoupons=this.getSubTotalWithoutCoupons();const settings=this.getLoyaltySettings();if(settings){if(!isNaN(parseInt(settings.percent\_to\_cover))){percentAmount=parseInt(settings.percent\_to\_cover)}}else{return 0}const amountToCover=subTotalWithoutCoupons\*percentAmount/100;const requiredPoints=Math.ceil(amountToCover\*settings.nb\_points/settings.per\_x\_usd);return Math.min(requiredPoints,customer.point\_count)}return 0},getEarningMessage:function(){let willBeEarned=0;const orderAmount=this.getOrderTotal();const settings=this.getLoyaltySettings();if(settings){if(settings.order\_source.website!==false){if(settings.purchase\_usd\_value){if(settings.calc\_method==="subtotal"){willBeEarned=Math.round(settings.purchase\_usd\_value\*sooCheckout.options.totals.sub\_total/100)}else{willBeEarned=Math.round(settings.purchase\_usd\_value\*orderAmount/100)}}else{willBeEarned=settings.purchase\_fixed\_points}if(!settings.earn\_on\_all\_order){if(mooGlobalParams.points>0){willBeEarned=0}}}if(willBeEarned>0){return`By placing this order you will earn ${willBeEarned} ${mooGlobalParams.pointsLabel}.`}else{return`No ${mooGlobalParams.pointsLabel} will be earned for this order.`}}else{return`<li>${mooGlobalParams.pointsLabel} can't be earned for this order.</li>`}},getSubTotalWithoutCoupons:function(){if(this.canAcceptCoupons()&&mooGlobalParams.couponAmount){return sooCheckout.options.totals.sub\_total-mooGlobalParams.couponAmount}else{return sooCheckout.options.totals.sub\_total}},getOrderTotal:function(){const cartTotals=sooCheckout.options.totals;const totals=mooCheckout.getTotals();let taxAmount=0;if(totals.orderTaxable){if(totals.discounts===0){taxAmount=cartTotals.taxes}else{taxAmount=cartTotals.taxes\_after\_discount}}return cartTotals.sub\_total+taxAmount+totals.deliveryAmount+totals.serviceFee-totals.discounts}};window.moo\_clover\_gateway={mountElements:function(){if(sooCheckout.options.creditCard){if($("#moo\_CloverCardNumber").length){window.clover\_card.mount("#moo\_CloverCardNumber");window.clover\_exp.mount("#moo\_CloverCardDate");window.clover\_cvc.mount("#moo\_CloverCardCvv");window.clover\_zip.mount("#moo\_CloverCardZip");if(window.clover\_streetAddress){window.clover\_streetAddress.mount("#moo\_CloverStreetAddress")}}}if(sooCheckout.options.giftCards){if($("#moo\_CloverGiftCard").length){window.clover\_giftCard.mount("#moo\_CloverGiftCard")}}if(sooCheckout.options.googlePay){if($("#moo-cloverGooglePay").length){window.clover\_googlepay.mount("#moo-cloverGooglePay")}}},createElements:function(){const elementStyles={input:{color:"#31325F",height:"30px","::placeholder":{color:"#CFD7E0"}}};if(sooCheckout.options.creditCard){window.clover\_card=window.elements.create("CARD\_NUMBER",elementStyles);window.clover\_exp=window.elements.create("CARD\_DATE",elementStyles);window.clover\_cvc=window.elements.create("CARD\_CVV",elementStyles);window.clover\_zip=window.elements.create("CARD\_POSTAL\_CODE",elementStyles);window.clover\_card.addEventListener("change",function(event){moo\_clover\_gateway.onCCFormChange();$(document.body).trigger("cloverError",event)});window.clover\_exp.addEventListener("change",function(event){moo\_clover\_gateway.onCCFormChange();$(document.body).trigger("cloverError",event)});window.clover\_cvc.addEventListener("change",function(event){moo\_clover\_gateway.onCCFormChange();$(document.body).trigger("cloverError",event)});window.clover\_zip.addEventListener("change",function(event){moo\_clover\_gateway.onCCFormChange();$(document.body).trigger("cloverError",event)});if(sooCheckout.options.showStreetAddressField){window.clover\_streetAddress=window.elements.create("CARD\_STREET\_ADDRESS",elementStyles);window.clover\_streetAddress.addEventListener("change",function(event){moo\_clover\_gateway.onCCFormChange();$(document.body).trigger("cloverError",event)})}}if(sooCheckout.options.giftCards){const giftCardStyles={input:{"border-radius":"5px",height:"45px",padding:"10px",color:"#31325F",border:"1px solid #ccc","::placeholder":{color:"#CFD7E0"}},body:{margin:"0;",border:"0.7px solid #B8B8B8FF;","border-radius":"10px;",padding:"10px;",width:"96%;","overflow-x":" hidden;"},".fieldError input":{"border-color":"red",color:"red"},".errorMessage":{color:"red","min-height":"10px;"},".sectionHeader":{display:"none"}};window.clover\_giftCard=window.elements.create("GIFT\_CARD\_ELEMENTS",giftCardStyles);window.clover\_giftCard.addEventListener("change",function(event){moo\_clover\_gateway.onGiftCardChange(event);$(document.body).trigger("cloverGiftCardError",event)})}if(sooCheckout.options.googlePay){const paymentReqData={total:{label:"Online Order",amount:sooCheckout.options.totals.sub\_total},options:{button:{buttonType:"long"}}};window.clover\_googlepay=window.elements.create("PAYMENT\_REQUEST\_BUTTON",{paymentReqData:paymentReqData});window.clover\_googlepay.addEventListener("paymentMethod",function(tokenData){window.googlePayToken=tokenData;try{$("#moo-cloverGooglePay").hide();$("#moo\_checkout\_loading").show();$("#moo-checkout .errors-section").html("");window.mooCheckout.getCheckoutForm()}catch(e){console.log(e);window.mooCheckout.showErrorAlert(mooObjectL10n.anErrorOccurred)}})}window.moo\_clover\_gateway.mountElements()},init:function(){$(document).on("cloverError",this.onError).on("cloverGiftCardError",this.onGiftCardError).on("checkout\_error",this.reset);moo\_clover\_gateway.createElements()},isMobile:function(){if(/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)){return true}return false},getSelectedPaymentElement:function(){return $('.payment\_methods input[name="payment\_method"]:checked')},createSource:function(){return clover.createToken().then(moo\_clover\_gateway.sourceResponse)},sourceResponse:function(response){if(response.error){return $(document.body).trigger("cloverError",response)}moo\_clover\_gateway.reset();$("#moo-CloverToken").val(response.token)},onCCFormChange:function(){},onGiftCardChange:function(e){console.log("onGiftCardChange");console.log(e)},reset:function(){if(!$("#moo-checkout-form-payments #moo-cloverCreditCardPanel .clover-error").length){}},onError:function(e,result){var hasError=false;var errorMessage="";if(result.CARD\_NUMBER.error){errorMessage=result.CARD\_NUMBER.error;hasError=true}else{if(result.CARD\_DATE.error){errorMessage=result.CARD\_DATE.error;hasError=true}else{if(result.CARD\_CVV.error){errorMessage=result.CARD\_CVV.error;hasError=true}else{if(result.CARD\_STREET\_ADDRESS&&result.CARD\_STREET\_ADDRESS.error){errorMessage=result.CARD\_STREET\_ADDRESS.error;hasError=true}else{if(result.CARD\_POSTAL\_CODE.error){errorMessage=result.CARD\_POSTAL\_CODE.error;hasError=true}}}}}window.cloverCardIsValid=!hasError;window.cloverCardErrorMsg=errorMessage;try{if(errorMessage===""){errorMessage=!result.CARD\_NUMBER.touched?mooObjectL10n.CardNumberRequired:!result.CARD\_DATE.touched?mooObjectL10n.CardDateRequired:!result.CARD\_CVV.touched?"Card Cvv is required":result.CARD\_STREET\_ADDRESS&&!result.CARD\_STREET\_ADDRESS.touched?mooObjectL10n.CardStreetAddressRequired:!result.CARD\_POSTAL\_CODE.touched?mooObjectL10n.CardZipRequired:window.cloverCardErrorMsg}if(errorMessage!==window.cloverCardErrorMsg){window.cloverCardIsValid=false;window.cloverCardErrorMsg=errorMessage}}catch(e){console.log(e)}},onGiftCardError:function(e,result){console.log(result);window.cloverGiftCardIsValid=result?.GIFT\_CARD\_ELEMENTS?.isFormValid;console.log(window.cloverGiftCardIsValid)},submitError:function(error\_message){}};$(document).ready(function(){window.mooCheckout.init();if(sooCheckout.options.pakmsKey){try{window.clover=new Clover(sooCheckout.options.pakmsKey,{locale:sooCheckout.options.locale});window.elements=window.clover.elements();window.cloverCardIsValid=false;window.cloverGiftCardIsValid=false;window.cloverCardErrorMsg=mooObjectL10n.CardNumberRequired;window.moo\_clover\_gateway.init()}catch(error){console.log(error)}}})}); |
* ## [clover-online-orders/trunk/public/js/dist/sooSearchbar.min.js](/changeset/3168433/clover-online-orders/trunk/public/js/dist/sooSearchbar.min.js "Show the changeset 3168433 restricted to clover-online-orders/trunk/public/js/dist/sooSearchbar.min.js")

  | [r2936448](/browser/clover-online-orders/trunk/public/js/dist/sooSearchbar.min.js?rev=2936448#L1 "Show revision 2936448 of this file in browser") | [r3168433](/browser/clover-online-orders/trunk/public/js/dist/sooSearchbar.min.js?rev=3168433#L1 "Show revision 3168433 of this file in browser") |  |
  | --- | --- | --- |
  | 1 |  | jQuery(document).ready(function(){window.moo\_RestUrl=moo\_params.moo\_RestUrl;window.moo\_theme\_setings=[];window.moo\_mg\_setings={};~~console.log(window.moo\_nbItemsPerLine);if(!window.moo\_nbItemsPerLine){window.moo\_nbItemsPerLine=jQuery("#moo-search-bar-container").width()<1e3?3:4}console.log(window.moo\_nbItemsPerLine);~~jQuery.get(moo\_RestUrl+"moo-clover/v1/theme\_settings/default",function(data){if(data!==null&&data.settings!==null){window.moo\_theme\_setings=data.settings;window.nb\_items\_in\_cart=data.nb\_items}});jQuery.get(moo\_RestUrl+"moo-clover/v1/mg\_settings",function(data){if(data!==null&&data.settings!==null){window.moo\_mg\_setings=data.settings}})});function mooClickonSearchButton(e){e.preventDefault();var keyword=jQuery(".moo-search-field").val();if(keyword.length>0){mooShowLoadingForSearch();jQuery.get(moo\_RestUrl+"moo-clover/v1/search/"+keyword,function(data){if(data.items!==null&&data.items.length>0){mooRenderItemsForSearch(data.items)}else{jQuery(".moo-search-result").html("Sorry, we don't find any item")}}).fail(function(){jQuery(".moo-search-result").html("Sorry, we don't find any item")})}}function mooShowSearchResultContainer(){jQuery(".moo-search-result").slideDown()}function mooHideSearchResultContainer(){jQuery(".moo-search-result").slideUp()}function mooShowLoadingForSearch(){jQuery(".moo-search-result").html("<div id='MooLoading'></div>");mooShowSearchResultContainer()}function moohideLoadingForSearch(){mooHideSearchResultContainer();jQuery(".moo-search-result").html("")}function mooRenderItemsForSearch(items){var html='<div class="moo-row">';for(var i in items){var item=items[i];var item\_price=parseFloat(item.price);item\_price=item\_price/100;item\_price=item\_price.toFixed(2);if(item.price>0&&item.price\_type==="PER\_UNIT")item\_price+="/"+item.unit\_name;if(i%window.moo\_nbItemsPerLine===0){html+='<div class="moo-col-md-'+12/window.moo\_nbItemsPerLine+'" style="clear: both">'}else{html+='<div class="moo-col-md-'+12/window.moo\_nbItemsPerLine+'">'}html+='<a title="'+item.description+'" class="link" href="#item-'+item.uuid.toLowerCase()+'" data-item-id="'+item.uuid.toLowerCase()+'" onclick="MooClickOnItem(event,this)">';if(item.image!==null&&item.image.url!==null&&item.image.url!==""){html+='<div class="image-wrapper" style="background: url('+item.image.url+') no-repeat center;background-size:100%;"></div>'}else{html+='<div class="image-wrapper">'+'<img class="moo-image" alt="" data-image-vertical="1" width="100%" height="100%" src="'+moo\_params["plugin\_img"]+'/noImg.png" />'+"</div>"}html+='<h2 class="title"><span class="brand "></span>'+'<span class="name">'+item.name+"</span>"+"</h2>"+'<div class="price-container clearfix">'+'<div class="price-box">'+'<span class="price">';if(parseFloat(item.price)===0){html+="<span></span>"}else{html+="<span>$"+item\_price+"</span>"}html+="</span>"+"</div>"+"</div>"+'<div class="btn-wrapper"><span class="moo-category-name">';if(item.stockCount==="out\_of\_stock"){html+='<button class="osh-btn"><span class="label">OUT OF STOCK</span></button>'}else{if(window.moo\_theme\_setings.onePage\_qtyWindow!==null&&window.moo\_theme\_setings.jTheme\_qtyWindow==="on"){if(item.has\_modifiers){if(window.moo\_theme\_setings.jTheme\_qtyWindowForModifiers!==null&&window.moo\_theme\_setings.jTheme\_qtyWindowForModifiers==="on")html+='<button class="osh-btn" onclick="mooOpenQtyWindow(event,\''+item.uuid+"','"+item.stockCount+'\',moo\_clickOnOrderBtnFIWM)"><span class="label">Choose Qty & Options</span></button>';else html+='<button class="osh-btn" onclick="moo\_clickOnOrderBtnFIWM(event,\''+item.uuid+'\',1)"><span class="label">Choose Options & Qty</span></button>'}else{html+='<button class="osh-btn" onclick="mooOpenQtyWindow(event,\''+item.uuid+"','"+item.stockCount+'\',moo\_clickOnOrderBtn)"><span class="label">Add to cart</span></button>'}}else{if(item.has\_modifiers)html+='<button class="osh-btn" onclick="moo\_clickOnOrderBtnFIWM(event,\''+item.uuid+'\',1)"><span class="label"> Choose Options & Qty </span></button>';else html+='<button class="osh-btn" onclick="moo\_clickOnOrderBtn(event,\''+item.uuid+'\',1)"><span class="label">Add to cart</span> </button>'}}html+="</span></div></a></div>"}html+="</div>";html+='<div class="moo-back-to-categories"><button class="osh-btn" onclick="mooHideSearchResultContainer()">'+'<span class="label">Close Search</span>'+"</button></div>";jQuery(".moo-search-result").html(html).promise().done(function(){console.log("Search done")})}function MooClickOnItem(event,elm){event.preventDefault();var item\_id=jQuery(elm).attr("data-item-id")}function mooOpenQtyWindow(event,item\_id,stockCount,callback){event.preventDefault();var inputOptions=new Promise(function(resolve){if(stockCount=="not\_tracking\_stock"||stockCount=="tracking\_stock"){resolve({1:"1",2:"2",3:"3",4:"4",5:"5",6:"6",7:"7",8:"8",9:"9",10:"10",custom:"Custom Quantity"})}else{var options={};var QtyMax=parseInt(stockCount)>10?10:parseInt(stockCount);var count=QtyMax;for(var $i=1;$i<=QtyMax;$i++){options[$i.toString()]=$i.toString();if(!--count){options["custom"]="Custom Quantity";resolve(options)}}}});swal({title:"Select the quantity",showLoaderOnConfirm:true,confirmButtonText:"Add",input:"select",inputClass:"moo-form-control",inputOptions:inputOptions,showCancelButton:true,preConfirm:function(value){return new Promise(function(resolve,reject){if(value=="custom")mooOpenCustomQtyWindow(event,item\_id,callback);else callback(event,item\_id,value)})}}).then(function(){},function(dismiss){})}function mooOpenCustomQtyWindow(event,item\_id,callback){swal({title:"Enter the quantity",input:"text",showCancelButton:true,showLoaderOnConfirm:true,inputValidator:function(value){return new Promise(function(resolve,reject){if(value!=""&&parseInt(value)>0){callback(event,item\_id,parseInt(value))}else{reject("You need to write a number")}})}}).then(function(){},function(){})}function moo\_clickOnOrderBtn(event,item\_id,qty){var body={item\_uuid:item\_id,item\_qty:qty,item\_modifiers:{}};jQuery.post(moo\_RestUrl+"moo-clover/v1/cart",body,function(data){if(data!=null){if(data.status=="error"){swal({title:data.message,type:"error"})}else{swal({title:data.name,text:"Added to cart",timer:3e3,type:"success"})}}else{swal({title:"Item not added, try again",type:"error"})}}).fail(function(data){swal({title:"Item not added, try again",text:"Check your internet connection or contact us",type:"error"});console.log(data)}).done(function(data){if(typeof data.nb\_items!="undefined")jQuery("#moo-cartNbItems").text(data.nb\_items)})}function moo\_clickOnOrderBtnFIWM(event,item\_id,qty){event.preventDefault();var target=event.target;var old\_text=jQuery(target).text();jQuery(target).text("Loading options");jQuery.get(moo\_RestUrl+"moo-clover/v1/items/"+item\_id,function(data){jQuery(target).text(old\_text);if(data!=null){if(data.modifier\_groups.length>0){if(typeof mooBuildModifiersPanel=="function"){if(Object.keys(window.moo\_mg\_setings).length>0){mooBuildModifiersPanel(data.modifier\_groups,item\_id,qty,window.moo\_mg\_setings)}else{mooBuildModifiersPanel(data.modifier\_groups,item\_id,qty)}}else{swal("Try again","Please refresh the page, An error has occurred","error")}}else moo\_clickOnOrderBtn(event,item\_id,qty)}else{jQuery(target).text(old\_text);swal({title:"Error",text:"We cannot Load the options for this item, please refresh the page or contact us",type:"error",confirmButtonText:"ok"})}}).fail(function(data){jQuery(target).text(old\_text);swal({title:"Error",text:"We cannot Load the options for this item, please refresh the page or contact us",type:"error",confirmButtonText:"ok"})})} |
  |  | 1 | jQuery(document).ready(function(){window.moo\_RestUrl=moo\_params.moo\_RestUrl;window.moo\_theme\_setings=[];window.moo\_mg\_setings={};if(!window.moo\_nbItemsPerLine){window.moo\_nbItemsPerLine=jQuery("#moo-search-bar-container").width()<1e3?3:4}jQuery.get(moo\_RestUrl+"moo-clover/v1/theme\_settings/default",function(data){if(data!==null&&data.settings!==null){window.moo\_theme\_setings=data.settings;window.nb\_items\_in\_cart=data.nb\_items}});jQuery.get(moo\_RestUrl+"moo-clover/v1/mg\_settings",function(data){if(data!==null&&data.settings!==null){window.moo\_mg\_setings=data.settings}})});function mooClickonSearchButton(e){e.preventDefault();var keyword=jQuery(".moo-search-field").val();if(keyword.length>0){mooShowLoadingForSearch();jQuery.get(moo\_RestUrl+"moo-clover/v1/search/"+keyword,function(data){if(data.items!==null&&data.items.length>0){mooRenderItemsForSearch(data.items)}else{jQuery(".moo-search-result").html("Sorry, we don't find any item")}}).fail(function(){jQuery(".moo-search-result").html("Sorry, we don't find any item")})}}function mooShowSearchResultContainer(){jQuery(".moo-search-result").slideDown()}function mooHideSearchResultContainer(){jQuery(".moo-search-result").slideUp()}function mooShowLoadingForSearch(){jQuery(".moo-search-result").html("<div id='MooLoading'></div>");mooShowSearchResultContainer()}function moohideLoadingForSearch(){mooHideSearchResultContainer();jQuery(".moo-search-result").html("")}function mooRenderItemsForSearch(items){var html='<div class="moo-row">';for(var i in items){var item=items[i];var item\_price=parseFloat(item.price);item\_price=item\_price/100;item\_price=item\_price.toFixed(2);if(item.price>0&&item.price\_type==="PER\_UNIT")item\_price+="/"+item.unit\_name;if(i%window.moo\_nbItemsPerLine===0){html+='<div class="moo-col-md-'+12/window.moo\_nbItemsPerLine+'" style="clear: both">'}else{html+='<div class="moo-col-md-'+12/window.moo\_nbItemsPerLine+'">'}html+='<a title="'+item.description+'" class="link" href="#item-'+item.uuid.toLowerCase()+'" data-item-id="'+item.uuid.toLowerCase()+'" onclick="MooClickOnItem(event,this)">';if(item.image!==null&&item.image.url!==null&&item.image.url!==""){html+='<div class="image-wrapper" style="background: url('+item.image.url+') no-repeat center;background-size:100%;"></div>'}else{html+='<div class="image-wrapper">'+'<img class="moo-image" alt="" data-image-vertical="1" width="100%" height="100%" src="'+moo\_params["plugin\_img"]+'/noImg.png" />'+"</div>"}html+='<h2 class="title"><span class="brand "></span>'+'<span class="name">'+item.name+"</span>"+"</h2>"+'<div class="price-container clearfix">'+'<div class="price-box">'+'<span class="price">';if(parseFloat(item.price)===0){html+="<span></span>"}else{html+="<span>$"+item\_price+"</span>"}html+="</span>"+"</div>"+"</div>"+'<div class="btn-wrapper"><span class="moo-category-name">';if(item.stockCount==="out\_of\_stock"){html+='<button class="osh-btn"><span class="label">OUT OF STOCK</span></button>'}else{if(window.moo\_theme\_setings.onePage\_qtyWindow!==null&&window.moo\_theme\_setings.jTheme\_qtyWindow==="on"){if(item.has\_modifiers){if(window.moo\_theme\_setings.jTheme\_qtyWindowForModifiers!==null&&window.moo\_theme\_setings.jTheme\_qtyWindowForModifiers==="on")html+='<button class="osh-btn" onclick="mooOpenQtyWindow(event,\''+item.uuid+"','"+item.stockCount+'\',moo\_clickOnOrderBtnFIWM)"><span class="label">Choose Qty & Options</span></button>';else html+='<button class="osh-btn" onclick="moo\_clickOnOrderBtnFIWM(event,\''+item.uuid+'\',1)"><span class="label">Choose Options & Qty</span></button>'}else{html+='<button class="osh-btn" onclick="mooOpenQtyWindow(event,\''+item.uuid+"','"+item.stockCount+'\',moo\_clickOnOrderBtn)"><span class="label">Add to cart</span></button>'}}else{if(item.has\_modifiers)html+='<button class="osh-btn" onclick="moo\_clickOnOrderBtnFIWM(event,\''+item.uuid+'\',1)"><span class="label"> Choose Options & Qty </span></button>';else html+='<button class="osh-btn" onclick="moo\_clickOnOrderBtn(event,\''+item.uuid+'\',1)"><span class="label">Add to cart</span> </button>'}}html+="</span></div></a></div>"}html+="</div>";html+='<div class="moo-back-to-categories"><button class="osh-btn" onclick="mooHideSearchResultContainer()">'+'<span class="label">Close Search</span>'+"</button></div>";jQuery(".moo-search-result").html(html).promise().done(function(){console.log("Search done")})}function MooClickOnItem(event,elm){event.preventDefault();var item\_id=jQuery(elm).attr("data-item-id")}function mooOpenQtyWindow(event,item\_id,stockCount,callback){event.preventDefault();var inputOptions=new Promise(function(resolve){if(stockCount=="not\_tracking\_stock"||stockCount=="tracking\_stock"){resolve({1:"1",2:"2",3:"3",4:"4",5:"5",6:"6",7:"7",8:"8",9:"9",10:"10",custom:"Custom Quantity"})}else{var options={};var QtyMax=parseInt(stockCount)>10?10:parseInt(stockCount);var count=QtyMax;for(var $i=1;$i<=QtyMax;$i++){options[$i.toString()]=$i.toString();if(!--count){options["custom"]="Custom Quantity";resolve(options)}}}});swal({title:"Select the quantity",showLoaderOnConfirm:true,confirmButtonText:"Add",input:"select",inputClass:"moo-form-control",inputOptions:inputOptions,showCancelButton:true,preConfirm:function(value){return new Promise(function(resolve,reject){if(value=="custom")mooOpenCustomQtyWindow(event,item\_id,callback);else callback(event,item\_id,value)})}}).then(function(){},function(dismiss){})}function mooOpenCustomQtyWindow(event,item\_id,callback){swal({title:"Enter the quantity",input:"text",showCancelButton:true,showLoaderOnConfirm:true,inputValidator:function(value){return new Promise(function(resolve,reject){if(value!=""&&parseInt(value)>0){callback(event,item\_id,parseInt(value))}else{reject("You need to write a number")}})}}).then(function(){},function(){})}function moo\_clickOnOrderBtn(event,item\_id,qty){var body={item\_uuid:item\_id,item\_qty:qty,item\_modifiers:{}};jQuery.post(moo\_RestUrl+"moo-clover/v1/cart",body,function(data){if(data!=null){if(data.status=="error"){swal({title:data.message,type:"error"})}else{swal({title:data.name,text:"Added to cart",timer:3e3,type:"success"})}}else{swal({title:"Item not added, try again",type:"error"})}}).fail(function(data){swal({title:"Item not added, try again",text:"Check your internet connection or contact us",type:"error"});console.log(data)}).done(function(data){if(typeof data.nb\_items!="undefined")jQuery("#moo-cartNbItems").text(data.nb\_items)})}function moo\_clickOnOrderBtnFIWM(event,item\_id,qty){event.preventDefault();var target=event.target;var old\_text=jQuery(target).text();jQuery(target).text("Loading options");jQuery.get(moo\_RestUrl+"moo-clover/v1/items/"+item\_id,function(data){jQuery(target).text(old\_text);if(data!=null){if(data.modifier\_groups.length>0){if(typeof mooBuildModifiersPanel=="function"){if(Object.keys(window.moo\_mg\_setings).length>0){mooBuildModifiersPanel(data.modifier\_groups,item\_id,qty,window.moo\_mg\_setings)}else{mooBuildModifiersPanel(data.modifier\_groups,item\_id,qty)}}else{swal("Try again","Please refresh the page, An error has occurred","error")}}else moo\_clickOnOrderBtn(event,item\_id,qty)}else{jQuery(target).text(old\_text);swal({title:"Error",text:"We cannot Load the options for this item, please refresh the page or contact us",type:"error",confirmButtonText:"ok"})}}).fail(function(data){jQuery(target).text(old\_text);swal({title:"Error",text:"We cannot Load the options for this item, please refresh the page or contact us",type:"error",confirmButtonText:"ok"})})} |
* ## [clover-online-orders/trunk/readme.txt](/changeset/3168433/clover-online-orders/trunk/readme.txt "Show the changeset 3168433 restricted to clover-online-orders/trunk/readme.txt")

  | [r3142846](/browser/clover-online-orders/trunk/readme.txt?rev=3142846#L1 "Show revision 3142846 of this file in browser") | [r3168433](/browser/clover-online-orders/trunk/readme.txt?rev=3168433#L1 "Show revision 3168433 of this file in browser") |  |
  | --- | --- | --- |
  | 1 |  | ~~﻿~~=== Smart Online Order for Clover === |
  |  | 1 | === Smart Online Order for Clover === |
  | 2 | 2 | Contributors: elbanyaoui, khalid995 |
  | 3 | 3 | Donate link: http://www.zaytech.com/ |
  | 4 |  | Tags: clover,online orders for clover,~~zaytech online orders,Clover online orders, Online orders for Clover, Wordpress and Clover,Clover, online ordering for clover, online order for clover pos, Online ordering for Clover POS,c~~lover POS |
  |  | 4 | Tags: clover,online orders for clover, Online orders for Clover, Wordpress and Clover, Online ordering for Clover POS |
  | 5 | 5 | Requires at least: 4.7.1 |
  | 6 |  | Tested up to: 6.6.~~1~~ |
  |  | 6 | Tested up to: 6.6.2 |
  | 7 | 7 | Requires PHP: 5.2.0 |
  | 8 |  | Stable tag: 1.5.~~7~~ |
  |  | 8 | Stable tag: 1.5.8 |
  | 9 | 9 | License: GPLv2 or later |
  | 10 | 10 | License URI: http://www.gnu.org/licenses/gpl-2.0.html |
  | […](/browser/clover-online-orders/trunk/readme.txt?rev=3142846#L150) | […](/browser/clover-online-orders/trunk/readme.txt?rev=3168433#L150) |  |
  | 150 | 150 | == Changelog == |
  | 151 | 151 |  |
  |  | 152 | = 1.5.8 = |
  |  | 153 | \* Enhanced compatibility with the latest WordPress version. |
  |  | 154 | \* Updated and refined the item list. |
  |  | 155 | \* Set the new checkout as the default option. |
  |  | 156 | \* Added integration with DoorDash. |
  |  | 157 | \* Various other improvements to enhance user experience. |
  |  | 158 |  |
  | 152 | 159 | = 1.5.7 = |
  | 153 | 160 | \* Improved compatibility with the latest version of Wordpress. |
  | […](/browser/clover-online-orders/trunk/readme.txt?rev=3142846#L181) | […](/browser/clover-online-orders/trunk/readme.txt?rev=3168433#L188) |  |
  | 181 | 188 | \* Fixed issue when modifier qty was manually entered |
  | 182 | 189 | \* Improved the design of the list of orders |
  | 183 |  | \* Orders now show where the source of the order originated from. For example, if you have Branded App, then you will see: Web, IOS, or Android. |
  |  | 190 | \* Orders now show where the source of the order originated from. For example, if you have a Branded App, then you will see: Web, IOS, or Android. |
  | 184 | 191 | \* Improved Order Details |
  | 185 | 192 | \* Added ability to use shortcode to display receipt link on a separate “Thank You” page, [moo\_receipt\_link] or [moo\_receipt\_link text="click here"] |
  | 186 |  | \* Other General Improvements and compatibility with ~~latest version of Wordp~~ress |
  |  | 193 | \* Other General Improvements and compatibility with a latest version of WordPress |
  | 187 | 194 |  |
  | 188 | 195 | = 1.5.2 = |
* ## [clover-online-orders/trunk/uninstall.php](/changeset/3168433/clover-online-orders/trunk/uninstall.php "Show the changeset 3168433 restricted to clover-online-orders/trunk/uninstall.php")

  | [r2936448](/browser/clover-online-orders/trunk/uninstall.php?rev=2936448#L48 "Show revision 2936448 of this file in browser") | [r3168433](/browser/clover-online-orders/trunk/uninstall.php?rev=3168433#L48 "Show revision 3168433 of this file in browser") |  |
  | --- | --- | --- |
  | 48 | 48 | if($my\_account\_page\_id) wp\_delete\_post($my\_account\_page\_id,true); |
  | 49 | 49 |  |
  |  | 50 | // @codingStandardsIgnoreStart |
  | 50 | 51 |  |
  | 51 | 52 | /\*-- Table `item\_option`--\*/ |
  | 52 |  | $wpdb->query("DROP TABLE IF EXISTS `{$wpdb->prefix}moo\_item\_option` ;"); |
  |  | 53 | $wpdb->query("DROP TABLE IF EXISTS `{$wpdb->prefix}moo\_item\_option` ;"); //db call ok |
  | 53 | 54 |  |
  | 54 | 55 | /\*-- Table `item\_tax\_rate` --\*/ |
  | 55 |  | $wpdb->query("DROP TABLE IF EXISTS `{$wpdb->prefix}moo\_item\_tax\_rate` ;"); |
  |  | 56 | $wpdb->query("DROP TABLE IF EXISTS `{$wpdb->prefix}moo\_item\_tax\_rate` ;"); //db call ok |
  | 56 | 57 |  |
  | 57 | 58 | /\* -- Table `modifier\_group` -- \*/ |
  | 58 |  | $wpdb->query("DROP TABLE IF EXISTS `{$wpdb->prefix}moo\_item\_order` ;"); |
  |  | 59 | $wpdb->query("DROP TABLE IF EXISTS `{$wpdb->prefix}moo\_item\_order` ;"); //db call ok; no-cache ok |
  | 59 | 60 |  |
  | 60 | 61 | /\*-- Table `item\_tag` --\*/ |
  | 61 |  | $wpdb->query("DROP TABLE IF EXISTS `{$wpdb->prefix}moo\_item\_tag` ;"); |
  |  | 62 | $wpdb->query("DROP TABLE IF EXISTS `{$wpdb->prefix}moo\_item\_tag` ;"); // db call ok |
  | 62 | 63 |  |
  | 63 | 64 | /\*-- Table `item\_modifier\_group` --\*/ |
  | 64 |  | $wpdb->query("DROP TABLE IF EXISTS `{$wpdb->prefix}moo\_item\_modifier\_group` ;"); |
  |  | 65 | $wpdb->query("DROP TABLE IF EXISTS `{$wpdb->prefix}moo\_item\_modifier\_group` ;"); // db call ok |
  | 65 | 66 |  |
  | 66 | 67 | /\* -- Table `order\_types -- \*/ |
  | 67 |  | $wpdb->query("DROP TABLE IF EXISTS `{$wpdb->prefix}moo\_images` ;"); |
  |  | 68 | $wpdb->query("DROP TABLE IF EXISTS `{$wpdb->prefix}moo\_images` ;"); // db call ok |
  | 68 | 69 |  |
  | 69 | 70 | /\* -- Table `item` -- \*/ |
  | 70 |  | $wpdb->query("DROP TABLE IF EXISTS `{$wpdb->prefix}moo\_item` ;"); |
  |  | 71 | $wpdb->query("DROP TABLE IF EXISTS `{$wpdb->prefix}moo\_item` ;"); // db call ok |
  | 71 | 72 |  |
  | 72 | 73 | /\* -- Table `orders` -- \*/ |
  | 73 |  | $wpdb->query("DROP TABLE IF EXISTS `{$wpdb->prefix}moo\_order` ;"); |
  |  | 74 | $wpdb->query("DROP TABLE IF EXISTS `{$wpdb->prefix}moo\_order` ;"); // db call ok |
  | 74 | 75 |  |
  | 75 | 76 | /\*-- Table `option`--\*/ |
  | 76 |  | $wpdb->query("DROP TABLE IF EXISTS `{$wpdb->prefix}moo\_option` ;"); |
  |  | 77 | $wpdb->query("DROP TABLE IF EXISTS `{$wpdb->prefix}moo\_option` ;"); // db call ok |
  | 77 | 78 |  |
  | 78 | 79 | /\* -- Table `tag` --\*/ |
  | 79 |  | $wpdb->query("DROP TABLE IF EXISTS `{$wpdb->prefix}moo\_tag` ;"); |
  |  | 80 | $wpdb->query("DROP TABLE IF EXISTS `{$wpdb->prefix}moo\_tag` ;"); // db call ok |
  | 80 | 81 |  |
  | 81 | 82 | /\* -- Table `tax\_rate` --\*/ |
  | 82 |  | $wpdb->query("DROP TABLE IF EXISTS `{$wpdb->prefix}moo\_tax\_rate` ;"); |
  |  | 83 | $wpdb->query("DROP TABLE IF EXISTS `{$wpdb->prefix}moo\_tax\_rate` ;"); // db call ok |
  | 83 | 84 |  |
  | 84 | 85 | /\* -- Table `modifier` --\*/ |
  | […](/browser/clover-online-orders/trunk/uninstall.php?rev=2936448#L100) | […](/browser/clover-online-orders/trunk/uninstall.php?rev=3168433#L101) |  |
  | 100 | 101 | $wpdb->query("DROP TABLE IF EXISTS `{$wpdb->prefix}moo\_order\_types` ;"); |
  | 101 | 102 |  |
  |  | 103 | // @codingStandardsIgnoreEnd |
  |  | 104 |  |
  | 102 | 105 | update\_option( 'moo\_settings',''); |
  | 103 | 106 | update\_option( 'moo\_pakms\_key', ''); |
  | […](/browser/clover-online-orders/trunk/uninstall.php?rev=2936448#L107) | […](/browser/clover-online-orders/trunk/uninstall.php?rev=3168433#L110) |  |
  | 107 | 110 | update\_option( 'moo\_slug', ''); |
  | 108 | 111 | update\_option( 'moo\_new\_checkout\_enabled', ''); |
  |  | 112 | update\_option( 'moo\_old\_checkout\_enabled', ''); |
  | 109 | 113 | } |
  | 110 | 114 | switch\_to\_blog($old\_blog); |
  | […](/browser/clover-online-orders/trunk/uninstall.php?rev=2936448#L120) | […](/browser/clover-online-orders/trunk/uninstall.php?rev=3168433#L124) |  |
  | 120 | 124 | if($cart\_page\_id) wp\_delete\_post($cart\_page\_id,true); |
  | 121 | 125 | if($my\_account\_page\_id) wp\_delete\_post($my\_account\_page\_id,true); |
  |  | 126 |  |
  |  | 127 | // @codingStandardsIgnoreStart |
  | 122 | 128 |  |
  | 123 | 129 | /\*-- Table `item\_option`--\*/ |
  | […](/browser/clover-online-orders/trunk/uninstall.php?rev=2936448#L172) | […](/browser/clover-online-orders/trunk/uninstall.php?rev=3168433#L178) |  |
  | 172 | 178 | $wpdb->query("DROP TABLE IF EXISTS `{$wpdb->prefix}moo\_order\_types` ;"); |
  | 173 | 179 |  |
  |  | 180 | // @codingStandardsIgnoreEnd |
  |  | 181 |  |
  | 174 | 182 | update\_option( 'moo\_settings', ''); |
  | 175 | 183 | update\_option( 'moo\_pakms\_key', ''); |
  | […](/browser/clover-online-orders/trunk/uninstall.php?rev=2936448#L179) | […](/browser/clover-online-orders/trunk/uninstall.php?rev=3168433#L187) |  |
  | 179 | 187 | update\_option( 'moo\_slug', ''); |
  | 180 | 188 | update\_option( 'moo\_new\_checkout\_enabled', ''); |
  |  | 189 | update\_option( 'moo\_old\_checkout\_enabled', ''); |
  | 181 | 190 | } |
  | 182 | 191 | } |

**Note:** See [TracChangeset](/wiki/TracChangeset)
for help on using the changeset viewer.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Unified Diff](?format=diff&new=3168433)
* [Zip Archive](?format=zip&new=3168433)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)

