=== Content from www.wordfence.com_3b76c343_20250110_221738.html ===


[![](https://www.wordfence.com/img/wordfence-intelligence-logo.svg)](/threat-intel/)

Have you found a vulnerability in a WordPress plugin or theme? Report vulnerabilities in WordPress plugins and themes through our [bug bounty program](https://www.wordfence.com/threat-intel/bug-bounty-program) and earn a bounty on all in-scope submissions, while we handle the responsible disclosure process on your behalf.

As a reminder, the Wordfence Intelligence Vulnerability Database API is completely free to query and utilize, both personally and commercially, and contains all the same vulnerability data as the user interface. Please review the API documentation and Webhook documentation for more information on how to query the vulnerability API endpoints and configure webhooks utilizing all the same data present in the Wordfence Intelligence user interface.

# Smart Online Order for Clover <= 1.5.7 - Authenticated (Contributor+) Stored Cross-Site Scripting via moo\_receipt\_link Shortcode

 [Wordfence Intelligence](https://www.wordfence.com/threat-intel)   >    [Vulnerability Database](https://www.wordfence.com/threat-intel/vulnerabilities)   >   Smart Online Order for Clover <= 1.5.7 - Authenticated (Contributor+) Stored Cross-Site Scripting via moo\_receipt\_link Shortcode

6.4

**Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')**
**CVSS Vector**
[CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:N)

| CVE | [CVE-2024-9895](https://www.cve.org/CVERecord?id=CVE-2024-9895) |
| --- | --- |
| CVSS | 6.4 (Medium) |
| Publicly Published | October 14, 2024 |
| Last Updated | October 15, 2024 |
| Researcher | [Peter Thaleikis](https://www.wordfence.com/threat-intel/vulnerabilities/researchers/spek) |

### Description

The Smart Online Order for Clover plugin for WordPress is vulnerable to Stored Cross-Site Scripting via the plugin's moo\_receipt\_link shortcode in all versions up to, and including, 1.5.7 due to insufficient input sanitization and output escaping on user supplied attributes. This makes it possible for authenticated attackers, with contributor-level access and above, to inject arbitrary web scripts in pages that will execute whenever a user accesses an injected page.

#### References

* [wordpress.org](https://wordpress.org/plugins/clover-online-orders/#developers)
* [plugins.trac.wordpress.org](https://plugins.trac.wordpress.org/browser/clover-online-orders/trunk/moo_OnlineOrders.php#L171)
* [plugins.trac.wordpress.org](https://plugins.trac.wordpress.org/browser/clover-online-orders/trunk/moo_OnlineOrders.php#L90)
* [plugins.trac.wordpress.org](https://plugins.trac.wordpress.org/browser/clover-online-orders/trunk/includes/shortcodes/checkoutPage.php#L2011)
* [plugins.trac.wordpress.org](https://plugins.trac.wordpress.org/changeset/3168433/)

#### Share

[Facebook](https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fclover-online-orders%2Fsmart-online-order-for-clover-157-authenticated-contributor-stored-cross-site-scripting-via-moo-receipt-link-shortcode&t=Smart%20Online%20Order%20for%20Clover%20%3C%3D%201.5.7%20-%20Authenticated%20%28Contributor%2B%29%20Stored%20Cross-Site%20Scripting%20via%20moo_receipt_link%20Shortcode "Facebook")
[Twitter](https://twitter.com/share?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fclover-online-orders%2Fsmart-online-order-for-clover-157-authenticated-contributor-stored-cross-site-scripting-via-moo-receipt-link-shortcode&text=Smart%20Online%20Order%20for%20Clover%20%3C%3D%201.5.7%20-%20Authenticated%20%28Contributor%2B%29%20Stored%20Cross-Site%20Scripting%20via%20moo_receipt_link%20Shortcode "Twitter")
[LinkedIn](https://www.linkedin.com/shareArticle?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fclover-online-orders%2Fsmart-online-order-for-clover-157-authenticated-contributor-stored-cross-site-scripting-via-moo-receipt-link-shortcode "LinkedIn")
Email

## Vulnerability Details for Smart Online Order for Clover

#### [Smart Online Order for Clover](https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/clover-online-orders)

| Software Type | Plugin |
| --- | --- |
| Software Slug | clover-online-orders [(view on wordpress.org)](https://wordpress.org/plugins/clover-online-orders) |
| Patched? | Yes |
| Remediation | Update to version 1.5.8, or a newer patched version |
| Affected Version | * <= 1.5.7 |
| Patched Version | * 1.5.8 |

This record contains material that is subject to copyright.

**Copyright 2012-2025 Defiant Inc.**

**License:**
Defiant hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute this software vulnerability information. Any copy of the software vulnerability information you make for such purposes is authorized provided that you include a hyperlink to this vulnerability record and reproduce Defiant's copyright designation and this license in any such copy.
**[Read more.](https://www.wordfence.com/wordfence-intelligence-terms-and-conditions/)**

**Copyright 1999-2025 The MITRE Corporation**

**License:**
CVE Usage: MITRE hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute Common Vulnerabilities and Exposures (CVE®). Any copy you make for such purposes is authorized provided that you reproduce MITRE's copyright designation and this license in any such copy.
**[Read more.](https://www.cve.org/Legal/TermsOfUse)**

Have information to add, or spot any errors? Contact us at wfi-support@wordfence.com so we can make any appropriate adjustments.

Did you know Wordfence Intelligence provides free personal and commercial API access to our comprehensive WordPress vulnerability database, along with a free webhook integration to stay on top of the latest vulnerabilities added and updated in the database? Get started today!

Learn more

Want to get notified of the latest vulnerabilities that may affect your WordPress site?
 Install Wordfence on your site today to get notified immediately if your site is affected by a vulnerability that has been added to our database.

Get Wordfence

The Wordfence Intelligence WordPress vulnerability database is completely free to access and query via API. Please review the documentation on how to access and consume the vulnerability data via API.

Documentation



=== Content from plugins.trac.wordpress.org_8fb07c6e_20250110_221730.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fbrowser%2Fclover-online-orders%2Ftrunk%2Fmoo_OnlineOrders.php)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Revision](/browser/clover-online-orders/trunk/moo_OnlineOrders.php?rev=3168433 "Revision 3168433")
* Next Revision →
* [Blame](/browser/clover-online-orders/trunk/moo_OnlineOrders.php?annotate=blame "Annotate each line with the last changed revision (this can be time consuming...)")
* [Revision Log](/log/clover-online-orders/trunk/moo_OnlineOrders.php)

---

# [source:](/browser?order=name "Go to repository root") [clover-online-orders](/browser/clover-online-orders?order=name "View clover-online-orders")/[trunk](/browser/clover-online-orders/trunk?order=name "View trunk")/[moo\_OnlineOrders.php](/browser/clover-online-orders/trunk/moo_OnlineOrders.php?order=name "View moo_OnlineOrders.php")

View diff against:

View revision:

| [Last change](/changeset/3209744/clover-online-orders/trunk/moo_OnlineOrders.php "View differences") on this file was [3209744](/changeset/3209744/ "View changeset 3209744"), checked in by elbanyaoui, [3 weeks ago](/timeline?from=2024-12-18T10%3A01%3A14Z&precision=second "See timeline at 12/18/2024 10:01:14 AM") |
| --- |
| version 1.5.9 |
| **File size:** 10.0 KB | |

| Line |  |
| --- | --- |
| [1](#L1) | <?php |
| [2](#L2) |  |
| [3](#L3) | /\*\* |
| [4](#L4) | \* The plugin bootstrap file |
| [5](#L5) | \* |
| [6](#L6) | \* This file is read by WordPress to generate the plugin information in the plugin |
| [7](#L7) | \* admin area. This file also includes all of the dependencies used by the plugin, |
| [8](#L8) | \* registers the activation and deactivation functions, and defines a function |
| [9](#L9) | \* that starts the plugin. |
| [10](#L10) | \* |
| [11](#L11) | \* @link              https://www.zaytech.com |
| [12](#L12) | \* @since             1.0.0 |
| [13](#L13) | \* @package           Wordpress\_Integration |
| [14](#L14) | \* |
| [15](#L15) | \* @wordpress-plugin |
| [16](#L16) | \* Plugin Name:       Smart Online Order for Clover |
| [17](#L17) | \* Plugin URI:        https://www.zaytech.com |
| [18](#L18) | \* Description:       Start taking orders from your Wordpress website and have them sent to your Clover Station |
| [19](#L19) | \* Version:           1.5.9 |
| [20](#L20) | \* Author:            Zaytech |
| [21](#L21) | \* Author URI:        https://www.zaytech.com |
| [22](#L22) | \* License:           GPLv2 or later |
| [23](#L23) | \* License URI:       http://www.gnu.org/licenses/gpl-2.0.html |
| [24](#L24) | \* Text Domain:       moo\_OnlineOrders |
| [25](#L25) | \* Domain Path:       /languages |
| [26](#L26) | \*/ |
| [27](#L27) |  |
| [28](#L28) | // If this file is called directly, abort. |
| [29](#L29) | if (! defined('WPINC')) { |
| [30](#L30) | die; |
| [31](#L31) | } |
| [32](#L32) |  |
| [33](#L33) | define( |
| [34](#L34) | 'SOO\_PLUGIN\_URL', |
| [35](#L35) | untrailingslashit(plugins\_url(basename(plugin\_dir\_path(\_\_FILE\_\_)), basename(\_\_FILE\_\_))) |
| [36](#L36) | ); |
| [37](#L37) | define('SOO\_PLUGIN\_PATH', untrailingslashit(plugin\_dir\_path(\_\_FILE\_\_))); |
| [38](#L38) | define('SOO\_ENV', 'PROD'); |
| [39](#L39) | define('SOO\_DEFAULT\_CDN', false); |
| [40](#L40) | define('SOO\_VERSION', "1.5.9"); |
| [41](#L41) | define('SOO\_G\_RECAPTCHA\_URL', 'https://www.google.com/recaptcha/api/siteverify'); |
| [42](#L42) | define('SOO\_DEBUG', false); |
| [43](#L43) |  |
| [44](#L44) | /\*\* |
| [45](#L45) | \* The core plugin class that is used to define internationalization, |
| [46](#L46) | \* admin-specific hooks, and public-facing site hooks. |
| [47](#L47) | \*/ |
| [48](#L48) | require plugin\_dir\_path(\_\_FILE\_\_) . 'includes/moo-OnlineOrders.php'; |
| [49](#L49) |  |
| [50](#L50) | /\*\* |
| [51](#L51) | \* Helper functions |
| [52](#L52) | \*/ |
| [53](#L53) | require plugin\_dir\_path(\_\_FILE\_\_) . 'includes/moo-OnlineOrders-helpers.php'; |
| [54](#L54) |  |
| [55](#L55) | require plugin\_dir\_path(\_\_FILE\_\_) . 'includes/moo-OnlineOrders-deactivator.php'; |
| [56](#L56) | //Moo\_OnlineOrders\_Deactivator::onlyClean(); |
| [57](#L57) |  |
| [58](#L58) | /\*\* |
| [59](#L59) | \* The code that runs during plugin activation. |
| [60](#L60) | \* This action is documented in includes/moo-OnlineOrders-activator.php |
| [61](#L61) | \*/ |
| [62](#L62) | function activate\_moo\_OnlineOrders($network\_wide) { |
| [63](#L63) | require\_once plugin\_dir\_path(\_\_FILE\_\_) . 'includes/moo-OnlineOrders-activator.php'; |
| [64](#L64) | if (function\_exists('is\_multisite') && is\_multisite() && $network\_wide) { |
| [65](#L65) | Moo\_OnlineOrders\_Activator::activateOnNetwork(); |
| [66](#L66) | return; |
| [67](#L67) | } |
| [68](#L68) | Moo\_OnlineOrders\_Activator::activate(); |
| [69](#L69) | } |
| [70](#L70) |  |
| [71](#L71) | /\*\* |
| [72](#L72) | \* The code that runs during plugin deactivation. |
| [73](#L73) | \* This action is documented in includes/moo-OnlineOrders-deactivator.php |
| [74](#L74) | \*/ |
| [75](#L75) | function deactivate\_moo\_OnlineOrders() { |
| [76](#L76) | require\_once plugin\_dir\_path(\_\_FILE\_\_) . 'includes/moo-OnlineOrders-deactivator.php'; |
| [77](#L77) | Moo\_OnlineOrders\_Deactivator::deactivate(); |
| [78](#L78) | } |
| [79](#L79) | function moo\_OnlineOrders\_shortcodes\_allitems($atts, $content) { |
| [80](#L80) | require\_once plugin\_dir\_path(\_\_FILE\_\_) . 'includes/shortcodes/storePage.php'; |
| [81](#L81) | $shortCode = new storePage(); |
| [82](#L82) | return $shortCode->render($atts, $content); |
| [83](#L83) | } |
| [84](#L84) | function moo\_OnlineOrders\_shortcodes\_checkoutPage($atts, $content) { |
| [85](#L85) | require\_once plugin\_dir\_path(\_\_FILE\_\_) . 'includes/shortcodes/checkoutPage.php'; |
| [86](#L86) | $checkoutPage = new CheckoutPage(); |
| [87](#L87) | return $checkoutPage->render($atts, $content); |
| [88](#L88) | } |
| [89](#L89) | function moo\_OnlineOrders\_shortcodes\_receiptLinkInThanksPage($atts, $content) { |
| [90](#L90) | require\_once plugin\_dir\_path(\_\_FILE\_\_) . 'includes/shortcodes/checkoutPage.php'; |
| [91](#L91) | $checkoutPage = new CheckoutPage(); |
| [92](#L92) | return $checkoutPage->renderReceiptLink($atts, $content); |
| [93](#L93) | } |
| [94](#L94) | function moo\_OnlineOrders\_shortcodes\_buybutton($atts, $content) { |
| [95](#L95) | require\_once plugin\_dir\_path(\_\_FILE\_\_) . 'includes/shortcodes/addToCartButton.php'; |
| [96](#L96) | $shortCode = new addToCartButton(); |
| [97](#L97) | return $shortCode->render($atts, $content); |
| [98](#L98) | } |
| [99](#L99) | function moo\_OnlineOrders\_shortcodes\_thecart($atts, $content) { |
| [100](#L100) | require\_once plugin\_dir\_path(\_\_FILE\_\_) . 'includes/shortcodes/cartPage.php'; |
| [101](#L101) | $cartPage = new CartPage(); |
| [102](#L102) | return $cartPage->render($atts, $content); |
| [103](#L103) | } |
| [104](#L104) | function moo\_OnlineOrders\_shortcodes\_giftcards\_balance($atts, $content) { |
| [105](#L105) | require\_once plugin\_dir\_path(\_\_FILE\_\_) . 'includes/shortcodes/GiftCardBalance.php'; |
| [106](#L106) | $cartPage = new giftCardBalance(); |
| [107](#L107) | return $cartPage->render($atts, $content); |
| [108](#L108) | } |
| [109](#L109) | function moo\_OnlineOrders\_shortcodes\_searchBar($atts, $content) { |
| [110](#L110) | require\_once plugin\_dir\_path(\_\_FILE\_\_) . 'includes/shortcodes/searchBar.php'; |
| [111](#L111) | $shortCode = new searchBar(); |
| [112](#L112) | return $shortCode->render($atts, $content); |
| [113](#L113) | } |
| [114](#L114) | function moo\_OnlineOrders\_shortcodes\_customerAccount($atts, $content) { |
| [115](#L115) | require\_once plugin\_dir\_path(\_\_FILE\_\_) . 'includes/shortcodes/myOrdersPage.php'; |
| [116](#L116) | $shortCode = new myOrdersPage(); |
| [117](#L117) | return $shortCode->render($atts, $content); |
| [118](#L118) | } |
| [119](#L119) |  |
| [120](#L120) | function moo\_OnlineOrders\_shortcodes\_categorymsg($atts, $content) { |
| [121](#L121) | if (isset($atts["cat\_id"]) && !empty($atts["message"])) { |
| [122](#L122) | if (isset($\_GET["category"]) && $\_GET["category"] == $atts["cat\_id"]) { |
| [123](#L123) | if (!empty($atts["css-class"])) { |
| [124](#L124) | return "<div class='".esc\_attr($atts["css-class"])."'>".esc\_attr($atts["message"])."</div>"; |
| [125](#L125) | } else { |
| [126](#L126) | return esc\_attr($atts["message"]); |
| [127](#L127) | } |
| [128](#L128) | } |
| [129](#L129) | } else { |
| [130](#L130) | return "Please enter the category id (cat\_id) and the message"; |
| [131](#L131) | } |
| [132](#L132) | } |
| [133](#L133) |  |
| [134](#L134) |  |
| [135](#L135) | /\* |
| [136](#L136) | \* Widgets Contents |
| [137](#L137) | \*/ |
| [138](#L138) | function moo\_OnlineOrders\_widget\_opening\_hours() { |
| [139](#L139) | require\_once plugin\_dir\_path(\_\_FILE\_\_) . 'includes/moo-OnlineOrders-widgets.php'; |
| [140](#L140) | register\_widget('Moo\_OnlineOrders\_Widgets\_Opening\_hours'); |
| [141](#L141) | } |
| [142](#L142) | function moo\_OnlineOrders\_widget\_best\_selling() { |
| [143](#L143) | require\_once plugin\_dir\_path(\_\_FILE\_\_) . 'includes/moo-OnlineOrders-widgets.php'; |
| [144](#L144) | register\_widget('Moo\_OnlineOrders\_Widgets\_best\_selling'); |
| [145](#L145) | } |
| [146](#L146) | function Moo\_OnlineOrders\_Widgets\_categories() { |
| [147](#L147) | require\_once plugin\_dir\_path(\_\_FILE\_\_) . 'includes/moo-OnlineOrders-widgets.php'; |
| [148](#L148) | register\_widget('Moo\_OnlineOrders\_Widgets\_categories'); |
| [149](#L149) | } |
| [150](#L150) |  |
| [151](#L151) | function moo\_OnlineOrders\_RestAPI() { |
| [152](#L152) | require\_once plugin\_dir\_path(\_\_FILE\_\_) . 'includes/moo-OnlineOrders-Restapi.php'; |
| [153](#L153) | $rest\_api = new Moo\_OnlineOrders\_Restapi(); |
| [154](#L154) | $rest\_api->register\_routes(); |
| [155](#L155) | } |
| [156](#L156) |  |
| [157](#L157) | /\* Activate and deactivate hooks\*/ |
| [158](#L158) | register\_activation\_hook(\_\_FILE\_\_, 'activate\_moo\_OnlineOrders'); |
| [159](#L159) | register\_deactivation\_hook(\_\_FILE\_\_, 'deactivate\_moo\_OnlineOrders'); |
| [160](#L160) |  |
| [161](#L161) | /\* adding shortcodes \*/ |
| [162](#L162) | add\_shortcode('moo\_all\_items', 'moo\_OnlineOrders\_shortcodes\_allitems'); |
| [163](#L163) | add\_shortcode('moo\_cart', 'moo\_OnlineOrders\_shortcodes\_thecart'); |
| [164](#L164) | add\_shortcode('moo\_checkout', 'moo\_OnlineOrders\_shortcodes\_checkoutPage'); |
| [165](#L165) | add\_shortcode('moo\_my\_account', 'moo\_OnlineOrders\_shortcodes\_customerAccount'); |
| [166](#L166) |  |
| [167](#L167) | add\_shortcode('moo\_buy\_button', 'moo\_OnlineOrders\_shortcodes\_buybutton'); |
| [168](#L168) | add\_shortcode('moo\_category\_msg', 'moo\_OnlineOrders\_shortcodes\_categorymsg'); |
| [169](#L169) | add\_shortcode('moo\_search', 'moo\_OnlineOrders\_shortcodes\_searchBar'); |
| [170](#L170) | add\_shortcode('moo\_receipt\_link', 'moo\_OnlineOrders\_shortcodes\_receiptLinkInThanksPage'); |
| [171](#L171) |  |
| [172](#L172) | //Gift Cards Shortcodes |
| [173](#L173) | add\_shortcode('moo\_giftcards\_balance', 'moo\_OnlineOrders\_shortcodes\_giftcards\_balance'); |
| [174](#L174) |  |
| [175](#L175) | /\* adding widgets\*/ |
| [176](#L176) | add\_action('widgets\_init', 'moo\_OnlineOrders\_widget\_opening\_hours'); |
| [177](#L177) | add\_action('widgets\_init', 'moo\_OnlineOrders\_widget\_best\_selling'); |
| [178](#L178) | add\_action('widgets\_init', 'Moo\_OnlineOrders\_Widgets\_categories'); |
| [179](#L179) |  |
| [180](#L180) | /\* Rest Api \*/ |
| [181](#L181) | add\_action('rest\_api\_init', 'moo\_OnlineOrders\_RestAPI'); |
| [182](#L182) |  |
| [183](#L183) | // add links to plugin |
| [184](#L184) |  |
| [185](#L185) | add\_filter('plugin\_action\_links\_' . plugin\_basename(\_\_FILE\_\_), 'moo\_add\_action\_links'); |
| [186](#L186) |  |
| [187](#L187) | function moo\_add\_action\_links($links) |
| [188](#L188) | { |
| [189](#L189) | $plugin\_links\_1 = array( |
| [190](#L190) | '<a href="admin.php?page=moo\_index">Settings</a>', |
| [191](#L191) | '<a href="https://docs.zaytech.com/">Docs</a>', |
| [192](#L192) | '<a href="https://zaytech.com/support/">Support</a>', |
| [193](#L193) | ); |
| [194](#L194) |  |
| [195](#L195) | return array\_merge($plugin\_links\_1, $links); |
| [196](#L196) | } |
| [197](#L197) | function moo\_deactivateAndClean() { |
| [198](#L198) | if (current\_user\_can( 'manage\_options' ) && isset($\_GET['page']) &&  $\_GET['page'] === 'moo\_deactivateAndClean') { |
| [199](#L199) | require\_once plugin\_dir\_path(\_\_FILE\_\_)."/includes/moo-OnlineOrders-deactivator.php"; |
| [200](#L200) |  |
| [201](#L201) | if (function\_exists("is\_plugin\_active\_for\_network") && !is\_plugin\_active\_for\_network(plugin\_basename(\_\_FILE\_\_))) { |
| [202](#L202) | Moo\_OnlineOrders\_Deactivator::deactivateAndClean(); |
| [203](#L203) | deactivate\_plugins(plugin\_basename(\_\_FILE\_\_), true); |
| [204](#L204) | } else { |
| [205](#L205) | Moo\_OnlineOrders\_Deactivator::onlyClean(); |
| [206](#L206) | } |
| [207](#L207) |  |
| [208](#L208) | $url = admin\_url('plugins.php?deactivate=true'); |
| [209](#L209) | header("Location: $url"); |
| [210](#L210) | die(); |
| [211](#L211) | } |
| [212](#L212) | } |
| [213](#L213) | add\_action('admin\_init', 'moo\_deactivateAndClean'); |
| [214](#L214) |  |
| [215](#L215) | if (get\_option('moo\_onlineOrders\_version') != '159') { |
| [216](#L216) | add\_action('plugins\_loaded', 'moo\_onlineOrders\_check\_version'); |
| [217](#L217) | add\_action('plugins\_loaded', 'moo\_schedule\_cron\_tasks'); |
| [218](#L218) | } |
| [219](#L219) |  |
| [220](#L220) |  |
| [221](#L221) |  |
| [222](#L222) | /\* |
| [223](#L223) | \* This function for updating the database structure when the version changed and updated it automatically |
| [224](#L224) | \* |
| [225](#L225) | \* @since v 1.1.2 |
| [226](#L226) | \*/ |
| [227](#L227) | function moo\_onlineOrders\_check\_version() { |
| [228](#L228) | $version = get\_option('moo\_onlineOrders\_version'); |
| [229](#L229) | if (empty($version)) { |
| [230](#L230) | $version = 120; |
| [231](#L231) | } else { |
| [232](#L232) | $version = intval($version); |
| [233](#L233) | } |
| [234](#L234) |  |
| [235](#L235) | if (! class\_exists( 'Moo\_OnlineOrders\_Helpers' ) ){ |
| [236](#L236) | require\_once SOO\_PLUGIN\_PATH ."/includes/moo-OnlineOrders-helpers.php"; |
| [237](#L237) | } |
| [238](#L238) | try { |
| [239](#L239) | //Upgrade Database |
| [240](#L240) | if ($version <= 136 ) { |
| [241](#L241) | Moo\_OnlineOrders\_Helpers::upgradeDatabaseToVersion136(); |
| [242](#L242) | } |
| [243](#L243) | if ( $version <= 150 ) { |
| [244](#L244) | Moo\_OnlineOrders\_Helpers::upgradeDatabaseToVersion150(); |
| [245](#L245) | } |
| [246](#L246) | if ( $version <= 158 ) { |
| [247](#L247) | Moo\_OnlineOrders\_Helpers::upgradeDatabaseToVersion158(); |
| [248](#L248) | } |
| [249](#L249) | } catch (Exception $e){} |
| [250](#L250) |  |
| [251](#L251) |  |
| [252](#L252) | //Apply default options |
| [253](#L253) | $defaultOptions = get\_option('moo\_settings'); |
| [254](#L254) | Moo\_OnlineOrders\_Helpers::applyDefaultOptions($defaultOptions); |
| [255](#L255) | update\_option("moo\_settings", $defaultOptions); |
| [256](#L256) | //Upgrade version |
| [257](#L257) | update\_option('moo\_onlineOrders\_version', '159'); |
| [258](#L258) | } |
| [259](#L259) |  |
| [260](#L260) | function moo\_schedule\_cron\_tasks() { |
| [261](#L261) | require\_once plugin\_dir\_path(\_\_FILE\_\_) . 'includes/moo-OnlineOrders-activator.php'; |
| [262](#L262) | Moo\_OnlineOrders\_Activator::scheduleCronTasks(); |
| [263](#L263) | } |
| [264](#L264) |  |
| [265](#L265) | /\*\* |
| [266](#L266) | \* Begins execution of the plugin. |
| [267](#L267) | \* |
| [268](#L268) | \* Since everything within the plugin is registered via hooks, |
| [269](#L269) | \* then kicking off the plugin from this point in the file does |
| [270](#L270) | \* not affect the page life cycle. |
| [271](#L271) | \* |
| [272](#L272) | \* @since    1.0.0 |
| [273](#L273) | \*/ |
| [274](#L274) | function run\_moo\_OnlineOrders() |
| [275](#L275) | { |
| [276](#L276) | $plugin = new moo\_OnlineOrders(); |
| [277](#L277) | $plugin->run(); |
| [278](#L278) | } |
| [279](#L279) | run\_moo\_OnlineOrders(); |

**Note:** See [TracBrowser](/wiki/TracBrowser)
for help on using the repository browser.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Plain Text](/browser/clover-online-orders/trunk/moo_OnlineOrders.php?format=txt)
* [Original Format](/export/3220478/clover-online-orders/trunk/moo_OnlineOrders.php)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)



=== Content from wordpress.org_0a447d61_20250110_221737.html ===


[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Showcase](https://wordpress.org/showcase/)
* [Hosting](https://wordpress.org/hosting/)
* Extend
  + [Themes](https://wordpress.org/themes/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Blocks](https://wordpress.org/blocks/)
  + [Openverse ↗︎](https://openverse.org/)
* Learn
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* Community
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [Events](https://events.wordpress.org/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* About
  + [About WordPress](https://wordpress.org/about/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
* [Get WordPress](https://wordpress.org/download/)

Search in WordPress.org

[Get WordPress](https://wordpress.org/download/)

[WordPress.org](https://wordpress.org/)

[Plugin Directory](https://wordpress.org/plugins/)

Smart Online Order for Clover

* [Submit a plugin](https://wordpress.org/plugins/developers/)
* [My favorites](https://wordpress.org/plugins/browse/favorites/)
* [Log in](https://login.wordpress.org/?redirect_to=https%3A%2F%2Fwordpress.org%2Fplugins%2Fclover-online-orders&locale=en_US)

* [Submit a plugin](https://wordpress.org/plugins/developers/)
* [My favorites](https://wordpress.org/plugins/browse/favorites/)
* [Log in](https://login.wordpress.org/?redirect_to=https%3A%2F%2Fwordpress.org%2Fplugins%2Fclover-online-orders&locale=en_US)

Search plugins

![](https://ps.w.org/clover-online-orders/assets/banner-772x250.png?rev=1376194)
![](https://ps.w.org/clover-online-orders/assets/icon-256x256.png?rev=2046750)
# Smart Online Order for Clover

By [Zaytech](https://www.zaytech.com)

[Download](https://downloads.wordpress.org/plugin/clover-online-orders.1.5.9.zip)

* [Details](https://wordpress.org/plugins/clover-online-orders/#description)
* [Reviews](https://wordpress.org/plugins/clover-online-orders/#reviews)
* [Installation](https://wordpress.org/plugins/clover-online-orders/#installation)
* [Development](https://wordpress.org/plugins/clover-online-orders/#developers)

[Support](https://wordpress.org/support/plugin/clover-online-orders/)

## Description

**NOTE:** This plugin requires a Clover POS & our Clover marketplace application “Smart Online Order + WordPress” (subscription required). — Please contact us at support@zaytech.com if you need help installing or setting up the plugin and application.

With **Smart Online Order for Clover** you can easily integrate and import your Clover inventory to show on your website in real-time. This will allow you to accept Online Orders from your website.

All you need is a Clover POS to easily display your menu on your website.

Allow customers to place orders from your website and then have the orders print to your Clover POS.

All orders can either automatically print or you can have the orders manually print. View all orders from your Clover POS. View daily/weekly/monthly reports from your Clover. This plugin is the ideal solution to get your business on-line in less than 10 minutes.

It’s also easy to do it yourself, if you get stuck, there are step by step instructions on You Tube – Search “Smart Online Order” on YouTube.

#### How it works

After installing the Smart Online Order for Clover plugin, add the pages “Order Online”, “Checkout” and “My Orders” by going to Appearance then Menu from the WordPress Dashboard. Then sync your website with your Clover POS using “Import inventory”.

There are also shortcodes that you can use. You would simply add the short-codes in a new post/page or an existing one.

If you already spent lots of time building out your Shop page using Woo-Commerce and would like to use your current Woo-Commerce inventory and then have those orders sent to the Clover – then, no worries we also have a solution for that. It is called **Woo-Commerce Payment Gateway for Clover**. You would still use the same app from the Clover App market “Smart Online Order” to receive your Woo-Commerce orders.

[Click here to use Woo-Commerce payment integration](https://wordpress.org/plugins/woo-clover-gateway-by-zaytech/)

[Click Here to compare the difference of whether to use your Clover Inventory or Woo-Commerce Inventory. You can also visit smartonlineorder.com](https://smartonlineorder.com/)

For Non-Wordpress websites, (we can create the online order page using WordPress and then you would link it to your website.

The main difference of having a WordPress website is that the Online Ordering can be up and running in less than 10 minutes. Give us a call or send us an email

if you don’t have a WordPress website so we can create for you the Online Ordering page so you can link it to your website.

If you don’t have any kind of website and don’t know where to start, give us a call or send us an email as we can make you a website with Online Ordering.

Below are just a few websites currently using Smart Online Order with their Clover POS.

[Bahia Bowls](https://bahiabowls.com)

[Hawaiian Style Grill](https://hawaiianstylegrill.smartonlineorder.com)

[Rocco’s Italian Deli](https://www.roccosdetroit.com)

[DA REGGAE CAFE](https://dareggaecafe.com)

[CAFE NUNE](https://www.cafenune.com/)

[Full Service Restaurant](https://www.theoriginalturkey.com)

[Island Smoothie Cafe](https://www.islandsmoothiecafe.com)

[Pizza shop Example 1](https://pomodoropizzafl.com/store)

[Pizza shop Example 2](http://www.fastpizzaonline.com)

[Pizza shop Example 3](https://www.zifaros.com)

[Oasis Grill](https://oasisgrill.com)

[Cake Shop](https://nolandscakes.com)

[Pizza Shop Example 4](https://villaromarestaurant.net)

[Pizza Shop Example 5](https://venuspizzeriafl.com)

[Coffee Shop Example 2](https://www.teabocoffee.com)

[Another Cafe Example](https://misskellyscafe.com)

[Indian Food Example](https://www.himalayanfusiononline.com)

[Cookie Store Example](https://rucookiemunchers.com/)

[Minami](https://minamisushi.com/)

[HANA TEA](https://hanatea8088.smartonlineorder.com)

[ACME SMOKED FISH](https://acmesmokedfish.smartonlineorder.com/)

Some websites we built, other websites were built by the merchant themselves or developers they hired.

## Screenshots

* [![](https://ps.w.org/clover-online-orders/assets/screenshot-1.png?rev=2188471)](https://ps.w.org/clover-online-orders/assets/screenshot-1.png?rev=2188471)
* [![](https://ps.w.org/clover-online-orders/assets/screenshot-2.png?rev=2046750)](https://ps.w.org/clover-online-orders/assets/screenshot-2.png?rev=2046750)
* [![](https://ps.w.org/clover-online-orders/assets/screenshot-3.png?rev=2046750)](https://ps.w.org/clover-online-orders/assets/screenshot-3.png?rev=2046750)
* [![](https://ps.w.org/clover-online-orders/assets/screenshot-4.png?rev=2188471)](https://ps.w.org/clover-online-orders/assets/screenshot-4.png?rev=2188471)
* [![](https://ps.w.org/clover-online-orders/assets/screenshot-5.png?rev=2188471)](https://ps.w.org/clover-online-orders/assets/screenshot-5.png?rev=2188471)
* [![](https://ps.w.org/clover-online-orders/assets/screenshot-6.png?rev=2046750)](https://ps.w.org/clover-online-orders/assets/screenshot-6.png?rev=2046750)
* [![](https://ps.w.org/clover-online-orders/assets/screenshot-7.png?rev=2046750)](https://ps.w.org/clover-online-orders/assets/screenshot-7.png?rev=2046750)
* [![](https://ps.w.org/clover-online-orders/assets/screenshot-8.png?rev=2046750)](https://ps.w.org/clover-online-orders/assets/screenshot-8.png?rev=2046750)
* [![](https://ps.w.org/clover-online-orders/assets/screenshot-9.png?rev=2588406)](https://ps.w.org/clover-online-orders/assets/screenshot-9.png?rev=2588406)
* [![](https://ps.w.org/clover-online-orders/assets/screenshot-10.png?rev=2046750)](https://ps.w.org/clover-online-orders/assets/screenshot-10.png?rev=2046750)

## Installation

Here is what you need to do:

1. Install the app by Zaytech called “[Smart Online Order + WordPress](https://www.clover.com/appmarket/apps/6MWGRRXJD5HMW?clientCountry=US)” to your Clover POS – Clover Station, Clover Mini, etc.
2. Install this Plugin – From WordPress Plugin – search “Clover” or “Smart Online Order”
3. Enter the Api-Key in the Smart Online Order Plugin in WordPress. The Api Key is found by going to Clover.com and opening Smart Online Order-Wordpress
4. Then enter Api Key and press save. Import Your Inventory by pressing import inventory in the Smart Online Order WordPress Plugin – You can also Search Youtube for “Smart Online Order” for tutorials
5. A new page is automatically created for you. Just put /store after your domain name to see the Online Order page. For example: If your website name is mysushi.com enter mysushi.com/store to see the online order page

You can also add your menu in a new post/page or an existing one using this shortcode

```
[moo_all_items]

```

You can ask your web-developer if he recommends to showcase your Online Order page on a different page of your website.

Below are additional shortcodes :

Cart Page

```
[moo_cart]

```

Checkout page

```
[moo_checkout]

```

My Orders page

```
[moo_my_account]

```

You can also display only some categories by adding the attribute categories to the shortcode, so you can create different pages each page with specific categories (pickup and catering for example)

```
[moo_all_items categories="6QW02M6CY9MHJ,9KS5GJYMJBD3T"]

```

To display a search bar use this shortcode

```
[moo_search]

```

And to add only “add to cart button” useful if you want create new sections like Popular Items

```
[moo_buy_button id='6PJNZJVEHF0XE']

```
#### VIDEO

Search Youtube “Smart Online Order” for Tutorial Videos

## FAQ

### What is a Clover POS

Please visit Clover.com to learn more about the Clover POS.

### Will this Plug-in work if I don’t have a Clover POS

No, this plugin requires that you have an activated merchant account with a Clover POS.

### Is there a fee associated with the Online Ordering for WordPress App found in the App Market

While this Plug-in is free. Yes, there is a fee associated with the Online Ordering for WordPress App found in the App Market.

### If i have difficulty installing this plug-in or the app, is there support or help

Yes, Please call 925-234-5554 for any questions you may have. You may also e-mail us at: support@zaytech.com or visit https://docs.zaytech.com or search Youtube for “Smart Online Order”

### Did Clover make this plug-in

No, this plug-in is not by Clover. It is from Zaytech. Both this plug-in and Smart Online Order for WordPress is by Zaytech.

### I like this plug-in but I need some additional features

Please let us know so we can implement additional features.support@zaytech.com

### How can I report security bugs?

You can report security bugs through the Patchstack Vulnerability Disclosure Program. The Patchstack team help validate, triage and handle any security vulnerabilities. [Report a security vulnerability.](https://patchstack.com/database/vdp/clover-online-orders)

## Reviews

![](https://secure.gravatar.com/avatar/b2ffd4bd98ce3a5e508b7ee5670e5e459694ade3f50fe1ee262114de6e82b013?s=60&d=retro&r=g)
### [Fixed my issue QUICKLY](https://wordpress.org/support/topic/fixed-my-issue-quickly/)

[chanman5297](https://profiles.wordpress.org/chanman5297/ "Posts by chanman5297")
September 10, 2023

Super fast with the response and helped me fix my issue within seconds. Been using Smart Online Order for over 4 years now. Our business has gone through many changes and this ordering system has remained as the BEST option. Allowing us to upgrade the looks to match our brand, no other options are as cohesive. Awesome company and great products.

![](https://secure.gravatar.com/avatar/6b363d587b9652b6ebee57f4e73fea60cdec28a713cdb75a1c24d1f903470420?s=60&d=retro&r=g)
### [Del Campo Empanadas](https://wordpress.org/support/topic/del-campo-empanadas/)

[delcampoempanadas](https://profiles.wordpress.org/delcampoempanadas/ "Posts by delcampoempanadas")
February 15, 2023

Smart Online Order is a fantastic online ordering plugin that is easy to use and very effective. It has a wide range of features that make it an essential tool for any restaurant that wants to provide its customers with an easy and efficient way to order food online.
One of the standout features of Smart Online Order is its customizable menu. You can easily add, edit, or remove items from your menu to keep it up-to-date and tailored to your customers’ needs. The plugin also allows you to customize the appearance of your online ordering page to match your restaurant’s branding, giving your customers a seamless experience.
Smart Online Order is also very user-friendly for both restaurant staff and customers. The interface is intuitive and easy to navigate, and the ordering process is straightforward and streamlined. Customers can easily browse your menu, select their items, and pay online, all in just a few clicks.
In addition to its ease of use, Smart Online Order also provides excellent customer support. The developers are very responsive and helpful, and they are always available to answer any questions or address any issues that may arise.
Overall, I highly recommend Smart Online Order for any restaurant looking to improve its online ordering system. It is a powerful, user-friendly tool that can help you increase your sales and provide your customers with a top-notch ordering experience.

![](https://secure.gravatar.com/avatar/b439f16daeafc48f72d32ec8cc41ac8289f35324c03c8a88f4d436de919ce59b?s=60&d=retro&r=g)
### [Great Plugin with Excellent Support!](https://wordpress.org/support/topic/great-plugin-with-excellent-support-107/)

[acanolli](https://profiles.wordpress.org/acanolli/ "Posts by acanolli")
February 3, 2023

Great plugin with excellent support! The plugin is user-friendly and you also have access to training and guides. If you have any questions or issues you need resolved the support team are available and very helpful.

![](https://secure.gravatar.com/avatar/a8279bb76da333fde5f986dd1deeacc77e088dbb36aa666ff46ec3c750538120?s=60&d=retro&r=g)
### [Great plugin and even better support](https://wordpress.org/support/topic/great-plugin-and-even-better-support-75/)

[Simone](https://profiles.wordpress.org/simonttz/ "Posts by Simone")
December 18, 2020

Seriously, their support is second to none. They really go above and beyond for you and understand the importance of customer service. If anyone is making a restaurant online order system, these guys can help!

![](https://secure.gravatar.com/avatar/4bf173650a2942f8d8459e8d377b3e048209f37b80285ca2e021ce86a41fcc23?s=60&d=retro&r=g)
### [Excellent Service!](https://wordpress.org/support/topic/excellent-service-166/)

[sakyiemms](https://profiles.wordpress.org/sakyiemms/ "Posts by sakyiemms")
April 23, 2020

I decided to go with Smart Online order for my clients’ website because it easily syncs with Clover POS. I was pleasantly surprised by the great lengths Khalid himself will go to make sure subscribers understand the plug in and mitigating any issues that may come up. He responds to messages very quickly, has a plethora of informative videos and articles. I could not be happier with this plug in!

![](https://secure.gravatar.com/avatar/91118f435792a71cad04adc171aefd737ad11a8cbb143f49d641621313093d93?s=60&d=retro&r=g)
### [Great plugin and integration](https://wordpress.org/support/topic/great-plugin-and-integration/)

[11bravoleads](https://profiles.wordpress.org/11bravoleads/ "Posts by 11bravoleads")
April 23, 2020

Setup was 95% fast and painless. I submitted a support email regarding the last couple of settings I could not figure out, and Khalid called me himself and straightened things out in a few minutes.
That is amazing support I have not experienced for a plugin before
Andy Norcia

[Read all 34 reviews](https://wordpress.org/support/plugin/clover-online-orders/reviews/)
## Contributors & Developers

“Smart Online Order for Clover” is open source software. The following people have contributed to this plugin.

Contributors

* ![](https://secure.gravatar.com/avatar/9347bc0fd5a2c4de2e0f3e9efbeb2200b8e1360f1f5ae7457f5c4b8bdc0cf6c5?s=32&d=mm&r=g) [ZAYTECH](https://profiles.wordpress.org/elbanyaoui/)
* ![](https://secure.gravatar.com/avatar/220ca36a9ef763aba5a87bb10b3f9f6f602d769759cdee74c02fd7e994c88bab?s=32&d=mm&r=g) [khalid995](https://profiles.wordpress.org/khalid995/)

“Smart Online Order for Clover” has been translated into 1 locale. Thank you to [the translators](https://translate.wordpress.org/projects/wp-plugins/clover-online-orders/contributors) for their contributions.

[Translate “Smart Online Order for Clover” into your language.](https://translate.wordpress.org/projects/wp-plugins/clover-online-orders)

### Interested in development?

[Browse the code](https://plugins.trac.wordpress.org/browser/clover-online-orders/), check out the [SVN repository](https://plugins.svn.wordpress.org/clover-online-orders/), or subscribe to the [development log](https://plugins.trac.wordpress.org/log/clover-online-orders/) by [RSS](https://plugins.trac.wordpress.org/log/clover-online-orders/?limit=100&mode=stop_on_copy&format=rss).

## Changelog

#### 1.5.9

* Added support for Apple Pay.
* Enhanced auto-sync functionality for better performance.
* Introduced the ability to import images and descriptions from Clover for new merchants.
* Improved product listing by displaying the “Shown on POS” attribute for greater clarity.
* Optimized compatibility with the latest version of WordPress.
* Implemented various other enhancements to improve the overall user experience.

#### 1.5.8

* Enhanced compatibility with the latest WordPress version.
* Updated and refined the item list.
* Set the new checkout as the default option.
* Added integration with DoorDash.
* Various other improvements to enhance user experience.

#### 1.5.7

* Improved compatibility with the latest version of WordPress.
* fixed bulk delete for coupons
* Other improvements and user experience

#### 1.5.6

* Improved compatibility with the latest version of WordPress.
* Implemented various improvements to enhance user experience.
* Introduced the option to select pre-selected modifiers for increased customization.
* Addressed and fixed a specific issue related to coupon deletion.

#### 1.5.5

* Improved compatibility with the latest version of WordPress.

#### 1.5.4

* Improved/fixed reordering of Modifiers
* Improved compatibility with the latest version of WordPress
* Improved compatibility with PHP 8.1
* Revamped code and organized for a faster output of PHP 8.1 compatible experience with thorough testing of the plugin’s necessity.
* Revamped store interfaces by using relevant user data to eliminate outdated Store Interfaces.
* Ability to mark an item as a featured item
* Ability to accept Google Pay
* Improved “Go to Checkout” button after adding featured item to cart
* Improved Responsiveness
* Some designs have been improved and enhanced
* Added more clarity to understand whether Online Ordering was paused or Closed from Clover Device or from Web Dashboard
* Other improvements and user experience

#### 1.5.3

* Fixed issue when modifier qty was manually entered
* Improved the design of the list of orders
* Orders now show where the source of the order originated from. For example, if you have a Branded App, then you will see: Web, IOS, or Android.
* Improved Order Details
* Added ability to use shortcode to display receipt link on a separate “Thank You” page, [moo\_receipt\_link] or [moo\_receipt\_link text=”click here”]
* Other General Improvements and compatibility with a latest version of WordPress

#### 1.5.2

* This update includes updates and improvements.

#### 1.5.1

* Improved the auto sync for items, modifiers, modifier groups and categories
* Added Ability to Enable and Disable service fees based on Order Types
* Added Shortcut to access Loyalty Dashboard for Branded App Customers
* Improved Custom Hours for Categories
* Support of new language (Français du Canada) translated SI4, Cart and Checkout
* Added Street Address field to the payment form, as a dynamic field when enabled from Clover Dashboard, Account Setup, Fraud Tools
* Fixed compatibility issues for WordPress 6.0 and PHP 8.0

#### 1.5.0

* Fixed compatibility issues for WordPress 6.0 and PHP 8.0
* Prevent coupon code from working when an item is removed from cart during checkout that no longer meets minimum order amount requirement
* Improved how the Minimum Amount of Coupons are Validated
* Bug Fixes and performance improvements

#### 1.4.9

* Update to new E-Commerce Api
* Fixed and improved Coupon Discounts
* Bug Fixes and performance improvements

#### 1.4.8

* Fixed tax issues when coupon code is used
* Fixed tip amount issue in the list of orders
* Added new hooks and filters

#### 1.4.7

* Fixed compatibility issues for WordPress 5.8.1

#### 1.4.6

* Fixed compatibility issues for WordPress 5.8
* Fixed an issue with the shortcode add to cart button
* Improved Facebook Login
* General updates and improvements

#### 1.4.5

* Fixed issue with display/hide show more in store interface 6
* Improved Auto-Sync for items
* Added ability to serve categories and items images using the CDN
* Added ability to use coupons automatically using the query param “soocoupon”
* Improved PHP 8 Compatibility
* Changed Date format in Orders to local timezone instead of UTC
* Improved Store interface 4 and added more customization options
* Improved the ability to add images and descriptions easier to items
* Added ability to see original modifier names after name change
* Fixed issue to go back to same category after adding images
* Add ability to require scheduled orders when the store is closed
* Added announcement section inside Smart Online Order
* Added ability to make “Special Instructions” Required
* Added ability to use CDN for images
* General updates and improvements

#### 1.4.4

* Updated payment options
* Minor improvements and updates

#### 1.4.2

* Improved the new payment method (secured by Clover)
* Other Improvements

#### 1.4.1

* Improved the new payment method (secured by Clover)

#### 1.4.0

* Added option to choose either to display regular names or alternate names
* Improved re-ordering items\* Improved css of store interface 4 for iPad
* Improved descriptions for items to accept HTML
* Improved search feature
* Added new payment method (secured by Clover)
* Added the ability to put a maximum order amount per Order Type
* Added new feedback/ticket system based on email
* Added customer text message notifications. Ability to text customers
* Added option so out of stock items can become hidden when it reaches Zero count.
* Added ability to hide category when it is not available when custom hours is used
* Added option to include order number on the order receipts
* Added ability to import and show more than 100 items per category
* Added ability to offer different tip amounts and to choose a default amount
* Added more options to store interface 4 customization
* Added ability to show modifier display as a minimized version
* Added ability to hide special instruction for store interfaces 3,4,5,6 on individual item basis
* Added ability to choose ‘Thank You Page’ from local WordPress Pages
* Changed the documentation link to: https://docs.zaytech.com
* Added chatbot feature to help answer questions using knowledge base
* When an item is hidden, it is now shown in gray color under categories and items
* Improved a feature so hidden items cannot be re-ordered
* Other Improvements

#### 1.3.9

* Fixed rounding float for percentage – for services fees
* Improved ordering method with iPads and Apple Pencil
* Improved the process of how an address is applied towards Delivery Orders
* Improved the accessibility – We are committed to accessibility for all users
* Added link to helpful articles to search answers to common questions
* Clarified how fixed delivery fees work by highlighting the text in red

#### 1.3.8

* Fixed Avada theme compatibility
* Fixed issue when disable order types

#### 1.3.7

* Fixed issue when saving delivery settings

#### 1.3.6

* Added new Store Interface Six. This is a fun and interactive store interface with categories at the top
* Added ability to have Custom Hours for Categories. For example, you can have specific hours that your lunch menu is available for Online Ordering
* Added ability to have Custom Hours for Order Types. For example, you can have specific hours of when you would like to do delivery or pick-up order
* Improved Clean Inventory feature for all items
* Improved Search Feature [moo\_search] by pressing “enter” to quickly list items
* Added ability to quickly close the Order Online Page from the store settings. You can still close the store from clover.com and then putting closed on the business hours
* Added ability to add description to categories
* Added ability to display default message “Not Available Yet” when customer tries to purchase a category outside of ordering hours. Default Message can also be changed
* Fixed some broken “help / documentation” links. Thanks Chris! for letting us know!
* Added One Click Install feature that creates a Smart Online Order Page using the Clover Inventory. Great for those that don’t have a WordPress Website. Hence, a user can use any website on any platform and simply link to the Order Online Page
* Added optional ability to have special instructions pop-up after item/modifier is added, but just before item is added to cart. This feature was requested by merchants that wanted their customers names or any special instructions for each sandwich, especially when a lot of sandwiches were ordered.
* Added ability to sync inventory while searching through the categories
* Added ability to search for modifiers by name

#### 1.3.5

* Full support of WordPress Network (Subdomains & Subdirectories)
* Integration with Perfect Coupons App by Zaytech. It’s now possible to create and print coupons on your Clover POS device and then allow customers to redeem the the coupon online
* Fixed an issue where a comma was converting to a forward slash for item descriptions
* Added “Trending” items the “My Orders” or “My Account” Page. This allows customers to see their most purchased orders as well as most purchased items by all customers.
* Added the ability to change text under special Instruction in Checkout Page
* Added more customization options to store interface 3 & 4 & 5
* Added the ability the display different categories in different pages, (add the attribute categories to the shortcode for example [moo\_all\_items categories=’K05C3JC47FHY6,1QKMPCAN4GVF4′] )
* Added the ability to choose a custom message when store is closed
* Added the ability to display a store announcement (Pop-Up) when customers visit the Order Online Page
* Added changes to page settings to facilitate navigation
* Fixed import items issue when there are more than 1000 items
* Other improvements and fixes

#### 1.3.2

* Fixed modifiers manual sync issue when there are more than 1000 modifiers
* Fixed and Improved Categories and Items sync
* Added Tax Sync Feature
* Improved Store Interfaces System and added new features for third party developmers to create Store Interfaces
* Fixed and improved issues in Store Interfaces 3 and 4
* Added Start Date for Coupons
* Updated fontawesome to latest version
* Added a new Shortcode [moo\_my\_account] for customers panel (allows customers to see previous orders and re-order) It will start to save orders once the plugin is updated to this version. Deleting and reinstalling the plugin will remove previously saved orders
* Added more customization options for store interface 4
* Improved Custom css section (added ability to override original css )
* Added the possibility to hide ‘show more’ in store interface 4
* Added the ability to disable sms verification when orders are not paid with credit card
* Added the ability to disable online payment and accept only pay at location/pay upon delivery
* Improved ability to update order types by improving sync functionality with the clover account

#### 1.3.1

* Fixed printing issues
* Fixed order note not changed
* Added the receipt link to the text messages
* Added ‘PAID’ to order title if the order was paid

#### 1.3.0

* Added new Store Interface “Store Interface 5”
* Added reports feature
* Fixed issue where the store interface wasn’t appearing correctly on Internet Explorer and Microsoft edge browsers
* Fixed issue where ‘$’ symbol would cut off remaining text on printed receipt
* Fixed issue where for new installs the address on map would point to New York instead of actual location
* Added additional FAQ
* Added the following shortcode to be used with Store Interface 4 so it can load on iPhone Apps [moo\_all\_items js\_loading=’false’ interface=”si4″]
* Other various fixes and improvements

#### 1.2.80

* Added the clean inventory feature
* Improved the store interface 4 to accept direct links to a specif category
* Added the ability for customer to reply to the emails and get the response in their own inbox
* Added the quantity window to add to cart shortcode
* Added the ability to add css class to add to cart shortcode
* Fixed reordering issue for categories, items and modifiers
* Added customization options for store interface 4 like changing colors and page width or font familty
* Improved Cart Icon by adding the number of items and changed it to a small button
* Added the ability to show or hide the quantity selection window for the 4th store interface
* Added the ability to disable modifier groups panel and add it on the same page to avoid scroll issues
* Added the ability to show or hide the qty for all modifiers or for modifiers without price
* Changed add to cart button on store interface 4 and added the number of items in cart
* Ability to hide quantity selection from modifiers with prices or modifiers with no prices for store interface 4
* Ability to show modifiers as a pop-up or directly underneath the item for store interface 4

#### 1.2.7

* Added two new store interfaces
* Store interface 3 has a beautiful interface that allows images to be uploaded for items in a vertical format
* Store interface 4 is an elegant interface that is great for restaurants or any business that wants a vertical format that may only want to upload images for categories. If the items you are uploading are very similar to the category images, then you can just upload a category image to cover all of the individual items. It also allows you to upload images for items in case the individual items are different from the category image
* Created a new setting called checkout settings
* Moved “Login to Checkout” from Store settings to Checkout settings
* Moved “Payment Options” from Store settings to Checkout settings
* Moved “Coupons” from Store settings to Checkout settings
* Moved “Tips” from Store settings to Checkout settings
* Moved “Thank You Page” forwarding from Store settings to Checkout Settings
* Ability to charge service fees on all order types; both percentage and a flat fee
* Ability to charge delivery fees based on percentage of subtotal
* Ability to change the name of the delivery fee and how it appears on the receipt
* Fixed issue when order type was saved not to show delivery address, it would show delivery address
* Ability to choose more than 1 quantity of the same modifier
* Customer is notified in real time if they exceed the maximum modifier selection
* Ability to hide special instructions on the checkout page
* Ability to add additional text in the description fields
* Changed “Pay in cash” to “Pay at location”
* Ability to manually enter a radius without having to draw a zone
* Improved image layout and upload quality
* Improved the add to cart button (shortcode) for individual items
* Ability to choose different scheduled order times for delivery and pickup

#### 1.2.6

* Added a new feature called coupon codes
* Fixed issue where duplicate cart pages were being created
* Added a widget so it displays business hours during checkout
* Added support for additional themes
* Increased the speed of the checkout page
* Fixed various bugs and other improvements
* Added script to send print command multiple times to merchants that experienced poor wifi connectivity
* Improved the functionality of how delivery fees are registered on the receipt

#### 1.2.5

* Added login/signup feature
* Ability to save customer address for future purchases
* Improved the checkout process
* Added order details
* Ability to re-arrange the order types
* Improved order types and functionality
* Improved e-mail receipt with more attention to detail
* Ability to track inventory count
* Fixed duplicated pages issue
* Improved feedback section
* Improved delivery fee calculation
* Improved layout so more description can be added
* Fixed various bugs and made improvements

#### 1.2.4

* Improved process to make adding descriptions easier
* Ability to rearrange items
* In edit items page (filter by category)
* Dropdown menu in modifiers when one modifier is required
* All prices with $0.00 will be hidden
* Fixed taxes for delivery
* Added price per unit in store interface one
* Added the short-code [moo\_all \_items category=’uuid’] for store interface 1. This allows to place categories on different pages by using the short code. Also possible for store interface 2
* Fixed partial payment issue
* Fixed other bugs and made improvements

#### 1.2.3

* Improved and increased font size for required modifier
* Updated email receipts with more information
* Shows special instructions on checkout page and on email receipt
* Ability to show item description for store interface 1
* Fixed various bugs and other issues

#### 1.2.2

* Ability to rearrange modifiers & modifiers group
* Ability to change modifiers names

#### 1.2.1

* Prevent customer from ordering outside of business hours and days
* Option to add image to any category
* Ability to rearrange categories
* Added multiple images for item
* Improved order later
* Improved manually sync

#### 1.2.0

* Added Out of stock feature
* Improved checkout feature
* New design for plugin’s dashboard
* Improved the exiting styles

#### 1.1.9

* Added Order for later
* Added SMS notification for merchants and customers

#### 1.1.8

* Pickup without paying
* Manually Sync
* Add to cart button

#### 1.1.7

* Improved The CART CSS
* remove qty limit
* Removed Style 2
* fixed empty map in checkout

#### 1.1.6

* Added delivery area
* Added tips
* Added required modifiers

#### 1.1.4

* Fixed Modifier issues

#### 1.1.3

* Added image for products
* Fixed more than one checkout page issue
* The Cart in new page
* Added order information in checkout page

#### 1.1.1

* Display the items without category
* Min and Max Modifier allowed in group modifier

#### 1.1.0

* Fixed bulk show/hide items
* Added show/hide category
* Change category’s name

#### 1.0.9

* Fixed cart’s color
* Fixed the shortcode issue

#### 1.0.8

* Added a video

#### 1.0.7

#### Added :

* Store’s hours
* Business address
* Show/Hide shipping address for an order type
* Sync with your Clover POS
* Item’s notes

#### Fixed :

* Partially paid
* Changing the quantify of an item in the cart

#### 1.0.6

Fix issues

#### 1.0.5

#### Added :

* Change name of Modifier group
* Show/hide Modifier group

#### 1.0.4

Fix issues

#### 1.0.2

Change the UI for Modifiers

#### 1.0.1

Update Frequently Asked Questions

#### 1.0.0

First Release

## Meta

* Version **1.5.9**
* Last updated **3 weeks ago**
* Active installations **1,000+**
* WordPress version **4.7.1 or higher**
* Tested up to **6.7.1**
* PHP version **5.2.0 or higher**
* Languages
  See all 2

  Close

  [English (US)](https://wordpress.org/plugins/clover-online-orders/) and [Swedish](https://sv.wordpress.org/plugins/clover-online-orders/).

  [Translate into your language](https://translate.wordpress.org/projects/wp-plugins/clover-online-orders)
* Tags [clover](https://wordpress.org/plugins/tags/clover/)[online orders for clover](https://wordpress.org/plugins/tags/online-orders-for-clover/)
* [Advanced View](https://wordpress.org/plugins/clover-online-orders/advanced/)

## Ratings

4.9 out of 5 stars.

* [33 5-star reviews
  5 stars

  33](https://wordpress.org/support/plugin/clover-online-orders/reviews/?filter=5)
* [0 4-star reviews
  4 stars

  0](https://wordpress.org/support/plugin/clover-online-orders/reviews/?filter=4)
* [0 3-star reviews
  3 stars

  0](https://wordpress.org/support/plugin/clover-online-orders/reviews/?filter=3)
* [1 2-star review
  2 stars

  1](https://wordpress.org/support/plugin/clover-online-orders/reviews/?filter=2)
* [0 1-star reviews
  1 star

  0](https://wordpress.org/support/plugin/clover-online-orders/reviews/?filter=1)

[Add my review](https://wordpress.org/support/plugin/clover-online-orders/reviews/#new-post)

[See all reviews](https://wordpress.org/support/plugin/clover-online-orders/reviews/)

## Contributors

* ![](https://secure.gravatar.com/avatar/9347bc0fd5a2c4de2e0f3e9efbeb2200b8e1360f1f5ae7457f5c4b8bdc0cf6c5?s=32&d=mm&r=g) [ZAYTECH](https://profiles.wordpress.org/elbanyaoui/)
* ![](https://secure.gravatar.com/avatar/220ca36a9ef763aba5a87bb10b3f9f6f602d769759cdee74c02fd7e994c88bab?s=32&d=mm&r=g) [khalid995](https://profiles.wordpress.org/khalid995/)
## Support

Got something to say? Need help?

[View support forum](https://wordpress.org/support/plugin/clover-online-orders/)

## Donate

Would you like to support the advancement of this plugin?

[Donate to this plugin](http://www.zaytech.com/)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Privacy](https://wordpress.org/about/privacy/)

* [Showcase](https://wordpress.org/showcase/)
* [Themes](https://wordpress.org/themes/)
* [Plugins](https://wordpress.org/plugins/)
* [Patterns](https://wordpress.org/patterns/)

* [Learn](https://learn.wordpress.org/)
* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [WordPress.tv ↗](https://wordpress.tv/)

* [Get Involved](https://make.wordpress.org/)
* [Events](https://events.wordpress.org/)
* [Donate ↗](https://wordpressfoundation.org/donate/)
* [Five for the Future](https://wordpress.org/five-for-the-future/)

* [WordPress.com ↗](https://wordpress.com/?ref=wporg-footer)
* [Matt ↗](https://ma.tt/)
* [bbPress ↗](https://bbpress.org/)
* [BuddyPress ↗](https://buddypress.org/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our X (formerly Twitter) account](https://www.x.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)
* [Visit our YouTube channel](https://www.youtube.com/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)



=== Content from plugins.trac.wordpress.org_3ba97440_20250110_221728.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fbrowser%2Fclover-online-orders%2Ftrunk%2Fincludes%2Fshortcodes%2FcheckoutPage.php)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Revision](/browser/clover-online-orders/trunk/includes/shortcodes/checkoutPage.php?rev=3168433 "Revision 3168433")
* Next Revision →
* [Blame](/browser/clover-online-orders/trunk/includes/shortcodes/checkoutPage.php?annotate=blame "Annotate each line with the last changed revision (this can be time consuming...)")
* [Revision Log](/log/clover-online-orders/trunk/includes/shortcodes/checkoutPage.php)

---

# [source:](/browser?order=name "Go to repository root") [clover-online-orders](/browser/clover-online-orders?order=name "View clover-online-orders")/[trunk](/browser/clover-online-orders/trunk?order=name "View trunk")/[includes](/browser/clover-online-orders/trunk/includes?order=name "View includes")/[shortcodes](/browser/clover-online-orders/trunk/includes/shortcodes?order=name "View shortcodes")/[checkoutPage.php](/browser/clover-online-orders/trunk/includes/shortcodes/checkoutPage.php?order=name "View checkoutPage.php")

View diff against:

View revision:

| [Last change](/changeset/3209744/clover-online-orders/trunk/includes/shortcodes/checkoutPage.php "View differences") on this file was [3209744](/changeset/3209744/ "View changeset 3209744"), checked in by elbanyaoui, [3 weeks ago](/timeline?from=2024-12-18T10%3A01%3A14Z&precision=second "See timeline at 12/18/2024 10:01:14 AM") |
| --- |
| version 1.5.9 |
| **File size:** 176.7 KB | |

| Line |  |
| --- | --- |
| [1](#L1) | <?php |
| [2](#L2) |  |
| [3](#L3) | require\_once "sooShortCode.php"; |
| [4](#L4) |  |
| [5](#L5) | class checkoutPage extends sooShortCode |
| [6](#L6) | { |
| [7](#L7) | /\*\* |
| [8](#L8) | \* Display or not the header in checkoutPage |
| [9](#L9) | \*  Change this to false if you want to hide our header that contains information about the benefits of using an account |
| [10](#L10) | \* @var bool |
| [11](#L11) | \*/ |
| [12](#L12) | private $displayPageHeader = true; |
| [13](#L13) |  |
| [14](#L14) | /\*\* |
| [15](#L15) | \* use or not alternateNames |
| [16](#L16) | \* @var bool |
| [17](#L17) | \*/ |
| [18](#L18) | private $showStreetAddressFieldOnPaymentForm; |
| [19](#L19) |  |
| [20](#L20) |  |
| [21](#L21) | public function standardCheckout($atts, $content) |
| [22](#L22) | { |
| [23](#L23) | $this->enqueueStyles(); |
| [24](#L24) | $this->enqueueScripts(); |
| [25](#L25) |  |
| [26](#L26) | ob\_start(); |
| [27](#L27) | $session = MOO\_SESSION::instance(); |
| [28](#L28) | //check store availibilty |
| [29](#L29) |  |
| [30](#L30) | if (isset($this->pluginSettings['accept\_orders']) && $this->pluginSettings['accept\_orders'] === "disabled") { |
| [31](#L31) | if (isset($this->pluginSettings["closing\_msg"]) && $this->pluginSettings["closing\_msg"] !== '') { |
| [32](#L32) | $oppening\_msg = '<div class="moo-alert moo-alert-danger" role="alert" id="moo\_checkout\_msg">'.$this->pluginSettings["closing\_msg"].'</div>'; |
| [33](#L33) | } else { |
| [34](#L34) | $oppening\_msg = '<div class="moo-alert moo-alert-danger" role="alert" id="moo\_checkout\_msg">'.\_\_("We are currently closed and will open again soon", "moo\_OnlineOrders").'</div>'; |
| [35](#L35) | } |
| [36](#L36) | return '<div id="moo\_CheckoutContainer" >'.$oppening\_msg.'</div>'; |
| [37](#L37) | } |
| [38](#L38) |  |
| [39](#L39) | //Get blackout status |
| [40](#L40) | $blackoutStatusResponse = $this->api->getBlackoutStatus(); |
| [41](#L41) | if (isset($blackoutStatusResponse["status"]) && $blackoutStatusResponse["status"] === "close") { |
| [42](#L42) | if (isset($blackoutStatusResponse["custom\_message"]) && !empty($blackoutStatusResponse["custom\_message"])) { |
| [43](#L43) | $oppening\_msg = '<div class="moo-alert moo-alert-danger" role="alert" id="moo\_checkout\_msg">'.$blackoutStatusResponse["custom\_message"].'</div>'; |
| [44](#L44) | } else { |
| [45](#L45) | $oppening\_msg = '<div class="moo-alert moo-alert-danger" role="alert" id="moo\_checkout\_msg">'.\_\_("We are currently closed and will open again soon", "moo\_OnlineOrders").'</div>'; |
| [46](#L46) | } |
| [47](#L47) | return '<div id="moo\_CheckoutContainer" >'.$oppening\_msg.'</div>'; |
| [48](#L48) | } |
| [49](#L49) |  |
| [50](#L50) | $orderTypes = $this->model->getVisibleOrderTypes(); |
| [51](#L51) | if (!is\_array($orderTypes)) { |
| [52](#L52) | $orderTypes = array(); |
| [53](#L53) | } |
| [54](#L54) | // Get ordertypes times |
| [55](#L55) | $counter = $this->model->getOrderTypesWithCustomHours(); |
| [56](#L56) | if (isset($counter->nb) && $counter->nb > 0) { |
| [57](#L57) | $HoursResponse = $this->api->getMerchantCustomHoursStatus("ordertypes"); |
| [58](#L58) | if ($HoursResponse) { |
| [59](#L59) | $merchantCustomHoursStatus = $HoursResponse; |
| [60](#L60) | $merchantCustomHours = array\_keys($HoursResponse); |
| [61](#L61) | } else { |
| [62](#L62) | $merchantCustomHoursStatus = array(); |
| [63](#L63) | $merchantCustomHours = array(); |
| [64](#L64) | } |
| [65](#L65) | } else { |
| [66](#L66) | $merchantCustomHoursStatus = array(); |
| [67](#L67) | $merchantCustomHours = array(); |
| [68](#L68) | } |
| [69](#L69) |  |
| [70](#L70) | $nbOfOrderTypes = count($orderTypes); |
| [71](#L71) | $nbOfUnvailableOrderTypes = null; |
| [72](#L72) | if (@count($merchantCustomHours) > 0 && $nbOfOrderTypes > 0) { |
| [73](#L73) | $nbOfUnvailableOrderTypes = 0; |
| [74](#L74) | for ($i=0; $i<$nbOfOrderTypes; $i++) { |
| [75](#L75) | $orderType  = $orderTypes[$i]; |
| [76](#L76) | $orderTypes[$i]->available = true; |
| [77](#L77) | if (isset($orderType->custom\_hours) && !empty($orderType->custom\_hours)) { |
| [78](#L78) | if (in\_array($orderType->custom\_hours, $merchantCustomHours)) { |
| [79](#L79) | $isNotAvailable = $merchantCustomHoursStatus[$orderType->custom\_hours] === "close"; |
| [80](#L80) | if ($isNotAvailable) { |
| [81](#L81) | //unset($orderTypes[$i]); |
| [82](#L82) | $orderTypes[$i]->available = false; |
| [83](#L83) | $nbOfUnvailableOrderTypes++; |
| [84](#L84) | } |
| [85](#L85) | } |
| [86](#L86) | } |
| [87](#L87) | } |
| [88](#L88) | } |
| [89](#L89) | /\* |
| [90](#L90) | if($nbOfOrderTypes === $nbOfUnvailableOrderTypes ){ |
| [91](#L91) | echo '<div id="moo\_checkout\_msg">This store cannot accept orders right now, please come back later</div>'; |
| [92](#L92) | return ob\_get\_clean(); |
| [93](#L93) | } |
| [94](#L94) | \*/ |
| [95](#L95) |  |
| [96](#L96) | //Force disabling payment\_creditcard payment method |
| [97](#L97) | if (isset($this->pluginSettings["payment\_creditcard"]) && $this->pluginSettings["payment\_creditcard"] == "on") { |
| [98](#L98) | $this->pluginSettings["clover\_payment\_form"] = "on"; |
| [99](#L99) | $this->pluginSettings["payment\_creditcard"] = "off"; |
| [100](#L100) | } |
| [101](#L101) |  |
| [102](#L102) |  |
| [103](#L103) | if (isset($this->pluginSettings["clover\_payment\_form"]) && $this->pluginSettings["clover\_payment\_form"] == "on") { |
| [104](#L104) | $cloverPakmsKey = $this->api->getPakmsKey(); |
| [105](#L105) | if ($cloverPakmsKey) { |
| [106](#L106) | $cloverCodeExist = true; |
| [107](#L107) | } else { |
| [108](#L108) | $cloverPakmsKey = null; |
| [109](#L109) | } |
| [110](#L110) | } else { |
| [111](#L111) | $cloverPakmsKey = null; |
| [112](#L112) | } |
| [113](#L113) |  |
| [114](#L114) | $custom\_js  = $this->pluginSettings["custom\_js"]; |
| [115](#L115) |  |
| [116](#L116) |  |
| [117](#L117) | if (is\_double($this->pluginSettings['fixed\_delivery']) && $this->pluginSettings['fixed\_delivery'] > 0) { |
| [118](#L118) | $fixedDeliveryFees = floatval($this->pluginSettings['fixed\_delivery']) \* 100; |
| [119](#L119) | } else { |
| [120](#L120) | $fixedDeliveryFees = 0; |
| [121](#L121) | } |
| [122](#L122) |  |
| [123](#L123) | if (isset($this->pluginSettings['service\_fees'])  && floatval($this->pluginSettings['service\_fees']) > 0) { |
| [124](#L124) | if (isset($this->pluginSettings['service\_fees\_type']) && $this->pluginSettings['service\_fees\_type'] === "percent") { |
| [125](#L125) | $serviceFees = floatval($this->pluginSettings['service\_fees']); |
| [126](#L126) | $serviceFeesType = "percent"; |
| [127](#L127) | } else { |
| [128](#L128) | $serviceFees = intval(round(floatval($this->pluginSettings['service\_fees']) \* 100)); |
| [129](#L129) | $serviceFeesType = "amount"; |
| [130](#L130) | } |
| [131](#L131) | } else { |
| [132](#L132) | $serviceFees = 0; |
| [133](#L133) | $serviceFeesType = "amount"; |
| [134](#L134) | } |
| [135](#L135) |  |
| [136](#L136) |  |
| [137](#L137) | $totals = $session->getTotals($fixedDeliveryFees, $serviceFees, $serviceFeesType); |
| [138](#L138) |  |
| [139](#L139) | $merchant\_proprites = (json\_decode($this->api->getMerchantProprietes())) ; |
| [140](#L140) |  |
| [141](#L141) | //Coupons |
| [142](#L142) | if (!$session->isEmpty("coupon")) { |
| [143](#L143) | $coupon = $session->get("coupon"); |
| [144](#L144) | if ($coupon['minAmount']>$totals['sub\_total']) { |
| [145](#L145) | $coupon = null; |
| [146](#L146) | } |
| [147](#L147) | } else { |
| [148](#L148) | $coupon = null; |
| [149](#L149) | } |
| [150](#L150) |  |
| [151](#L151) | if ($this->pluginSettings["order\_later"] == "on") { |
| [152](#L152) | $inserted\_nb\_days = $this->pluginSettings["order\_later\_days"]; |
| [153](#L153) | $inserted\_nb\_mins = $this->pluginSettings["order\_later\_minutes"]; |
| [154](#L154) |  |
| [155](#L155) | $inserted\_nb\_days\_d = $this->pluginSettings["order\_later\_days\_delivery"]; |
| [156](#L156) | $inserted\_nb\_mins\_d = $this->pluginSettings["order\_later\_minutes\_delivery"]; |
| [157](#L157) |  |
| [158](#L158) | if ($inserted\_nb\_days === "") { |
| [159](#L159) | $nb\_days = 4; |
| [160](#L160) | } else { |
| [161](#L161) | $nb\_days = intval($inserted\_nb\_days); |
| [162](#L162) | } |
| [163](#L163) |  |
| [164](#L164) | if ($inserted\_nb\_mins === "") { |
| [165](#L165) | $nb\_minutes = 20; |
| [166](#L166) | } else { |
| [167](#L167) | $nb\_minutes = intval($inserted\_nb\_mins); |
| [168](#L168) | } |
| [169](#L169) |  |
| [170](#L170) | if ($inserted\_nb\_days\_d === "") { |
| [171](#L171) | $nb\_days\_d = 4; |
| [172](#L172) | } else { |
| [173](#L173) | $nb\_days\_d = intval($inserted\_nb\_days\_d); |
| [174](#L174) | } |
| [175](#L175) |  |
| [176](#L176) | if ($inserted\_nb\_mins\_d === "") { |
| [177](#L177) | $nb\_minutes\_d = 60; |
| [178](#L178) | } else { |
| [179](#L179) | $nb\_minutes\_d = intval($inserted\_nb\_mins\_d); |
| [180](#L180) | } |
| [181](#L181) | } else { |
| [182](#L182) | $nb\_days = 0; |
| [183](#L183) | $nb\_minutes = 0; |
| [184](#L184) | $nb\_days\_d = 0; |
| [185](#L185) | $nb\_minutes\_d = 0; |
| [186](#L186) | } |
| [187](#L187) |  |
| [188](#L188) |  |
| [189](#L189) | $oppening\_status = $this->api->getOpeningStatus($nb\_days, $nb\_minutes); |
| [190](#L190) | $this->showStreetAddressFieldOnPaymentForm = $this->checkCloverFraudTools($oppening\_status); |
| [191](#L191) |  |
| [192](#L192) | if ($nb\_days != $nb\_days\_d || $nb\_minutes != $nb\_minutes\_d) { |
| [193](#L193) | $oppening\_status\_d = $this->api->getOpeningStatus($nb\_days\_d, $nb\_minutes\_d); |
| [194](#L194) | } else { |
| [195](#L195) | $oppening\_status\_d = $oppening\_status; |
| [196](#L196) | } |
| [197](#L197) |  |
| [198](#L198) | $oppening\_msg = $this->getOpeningMessage($oppening\_status); |
| [199](#L199) |  |
| [200](#L200) | //Adding asap to pickup time |
| [201](#L201) | if (isset($oppening\_status["pickup\_time"])) { |
| [202](#L202) | if (isset($this->pluginSettings['order\_later\_asap\_for\_p']) && $this->pluginSettings['order\_later\_asap\_for\_p'] == 'on') { |
| [203](#L203) | if (isset($oppening\_status["pickup\_time"]["Today"])) { |
| [204](#L204) | array\_unshift($oppening\_status["pickup\_time"]["Today"], 'ASAP'); |
| [205](#L205) | } |
| [206](#L206) | } |
| [207](#L207) | if (isset($oppening\_status["pickup\_time"]["Today"])) { |
| [208](#L208) | array\_unshift($oppening\_status["pickup\_time"]["Today"], \_\_("Select a time", "moo\_OnlineOrders")); |
| [209](#L209) | } |
| [210](#L210) | } |
| [211](#L211) |  |
| [212](#L212) | if (isset($oppening\_status\_d["pickup\_time"])) { |
| [213](#L213) | if (isset($this->pluginSettings['order\_later\_asap\_for\_d']) && $this->pluginSettings['order\_later\_asap\_for\_d'] == 'on') { |
| [214](#L214) | if (isset($oppening\_status\_d["pickup\_time"]["Today"])) { |
| [215](#L215) | array\_unshift($oppening\_status\_d["pickup\_time"]["Today"], 'ASAP'); |
| [216](#L216) | } |
| [217](#L217) | } |
| [218](#L218) | if (isset($oppening\_status\_d["pickup\_time"]["Today"])) { |
| [219](#L219) | array\_unshift($oppening\_status\_d["pickup\_time"]["Today"], \_\_("Select a time", "moo\_OnlineOrders")); |
| [220](#L220) | } |
| [221](#L221) | } |
| [222](#L222) |  |
| [223](#L223) | if ($this->pluginSettings['hours'] != 'all' && $this->pluginSettings['accept\_orders\_w\_closed'] != 'on' && $oppening\_msg != "") { |
| [224](#L224) | echo '<div id="moo\_CheckoutContainer">'.$oppening\_msg.'</div>'; |
| [225](#L225) | return ob\_get\_clean(); |
| [226](#L226) | } |
| [227](#L227) |  |
| [228](#L228) | //show or hide the choose time section |
| [229](#L229) | if (isset($this->pluginSettings['order\_later']) && $this->pluginSettings['order\_later'] == 'on') { |
| [230](#L230) | if (is\_array($oppening\_status["pickup\_time"]) && @count($oppening\_status["pickup\_time"])>0) { |
| [231](#L231) | $showTimeSection = true; |
| [232](#L232) | } else { |
| [233](#L233) | if (isset($this->pluginSettings['order\_later\_mandatory']) && $this->pluginSettings['order\_later\_mandatory'] === "on") { |
| [234](#L234) | $showTimeSection = true; |
| [235](#L235) | } else { |
| [236](#L236) | $showTimeSection = false; |
| [237](#L237) | } |
| [238](#L238) | } |
| [239](#L239) | } else { |
| [240](#L240) | $showTimeSection = false; |
| [241](#L241) | } |
| [242](#L242) |  |
| [243](#L243) |  |
| [244](#L244) |  |
| [245](#L245) | $merchant\_address =  $this->api->getMerchantAddress(); |
| [246](#L246) | $store\_page\_id     = $this->pluginSettings['store\_page']; |
| [247](#L247) | $cart\_page\_id     = $this->pluginSettings['cart\_page']; |
| [248](#L248) | $checkout\_page\_id     = $this->pluginSettings['checkout\_page']; |
| [249](#L249) |  |
| [250](#L250) | $store\_page\_url    =  get\_page\_link($store\_page\_id); |
| [251](#L251) | $cart\_page\_url    =  get\_page\_link($cart\_page\_id); |
| [252](#L252) | $checkout\_page\_url    =  get\_page\_link($checkout\_page\_id); |
| [253](#L253) |  |
| [254](#L254) | if (isset($this->pluginSettings['thanks\_page\_wp']) && !empty($this->pluginSettings['thanks\_page\_wp'])) { |
| [255](#L255) | $this->pluginSettings['thanks\_page'] = get\_page\_link($this->pluginSettings['thanks\_page\_wp']); |
| [256](#L256) | } |
| [257](#L257) |  |
| [258](#L258) | if (!isset($this->pluginSettings['save\_cards'])) { |
| [259](#L259) | $this->pluginSettings['save\_cards'] = null; |
| [260](#L260) | } |
| [261](#L261) | if (!isset($this->pluginSettings['save\_cards\_fees'])) { |
| [262](#L262) | $this->pluginSettings['save\_cards\_fees'] = null; |
| [263](#L263) | } |
| [264](#L264) | if (!isset($this->pluginSettings['delivery\_errorMsg']) || empty($this->pluginSettings['delivery\_errorMsg'])) { |
| [265](#L265) | $this->pluginSettings['delivery\_errorMsg'] = \_\_("Sorry, zone not supported. We do not deliver to this address at this time", "moo\_OnlineOrders"); |
| [266](#L266) | } |
| [267](#L267) | if (!isset($this->pluginSettings['special\_instructions\_required']) || empty($this->pluginSettings['special\_instructions\_required'])) { |
| [268](#L268) | $this->pluginSettings['special\_instructions\_required'] = false; |
| [269](#L269) | } |
| [270](#L270) | $mooCheckoutJsOptions = array( |
| [271](#L271) | 'moo\_RestUrl' =>  get\_rest\_url(), |
| [272](#L272) | "moo\_OrderTypes"=>$orderTypes, |
| [273](#L273) | "totals"=>$totals, |
| [274](#L274) | "moo\_Key"=>array(), |
| [275](#L275) | "moo\_thanks\_page"=>$this->pluginSettings['thanks\_page'], |
| [276](#L276) | "moo\_cash\_upon\_delivery"=>$this->pluginSettings['payment\_cash\_delivery'], |
| [277](#L277) | "moo\_cash\_in\_store"=>$this->pluginSettings['payment\_cash'], |
| [278](#L278) | "moo\_pay\_online"=>$this->pluginSettings['payment\_creditcard'], |
| [279](#L279) | "moo\_pickup\_time"=>$oppening\_status["pickup\_time"], |
| [280](#L280) | "moo\_pickup\_time\_for\_delivery"=>$oppening\_status\_d["pickup\_time"], |
| [281](#L281) | "moo\_fb\_app\_id"=>$this->pluginSettings['fb\_appid'], |
| [282](#L282) | "moo\_scp"=>$this->pluginSettings['scp'], |
| [283](#L283) | "moo\_use\_sms\_verification"=>$this->pluginSettings['use\_sms\_verification'], |
| [284](#L284) | "moo\_checkout\_login"=>$this->pluginSettings['checkout\_login'], |
| [285](#L285) | "moo\_save\_cards"=>$this->pluginSettings['save\_cards'], |
| [286](#L286) | "moo\_save\_cards\_fees"=>$this->pluginSettings['save\_cards\_fees'], |
| [287](#L287) | "moo\_clover\_payment\_form"=>$this->pluginSettings['clover\_payment\_form'], |
| [288](#L288) | "moo\_clover\_key"=>$cloverPakmsKey, |
| [289](#L289) | "special\_instructions\_required"=>$this->pluginSettings['special\_instructions\_required'], |
| [290](#L290) | "locale"=>str\_replace("\_", "-", get\_locale()), |
| [291](#L291) | "showStreetAddressField"=>$this->showStreetAddressFieldOnPaymentForm, |
| [292](#L292) | ); |
| [293](#L293) | $mooDeliveryJsOptions = array( |
| [294](#L294) | "moo\_merchantLat"=>$this->pluginSettings['lat'], |
| [295](#L295) | "moo\_merchantLng"=>$this->pluginSettings['lng'], |
| [296](#L296) | "moo\_merchantAddress"=>$merchant\_address, |
| [297](#L297) | "zones"=>$this->pluginSettings['zones\_json'], |
| [298](#L298) | "other\_zone\_fee"=>$this->pluginSettings['other\_zones\_delivery'], |
| [299](#L299) | "free\_amount"=>$this->pluginSettings['free\_delivery'], |
| [300](#L300) | "fixed\_amount"=>$this->pluginSettings['fixed\_delivery'], |
| [301](#L301) | "errorMsg"=>$this->pluginSettings['delivery\_errorMsg'] |
| [302](#L302) | ); |
| [303](#L303) |  |
| [304](#L304) |  |
| [305](#L305) |  |
| [306](#L306) | wp\_localize\_script("sooCheckoutScript", "mooCheckoutOptions", $mooCheckoutJsOptions); |
| [307](#L307) | wp\_localize\_script("sooCheckoutScript", "mooDeliveryOptions", $mooDeliveryJsOptions); |
| [308](#L308) |  |
| [309](#L309) |  |
| [310](#L310) | if ($totals === false || !isset($totals['nb\_items']) || $totals['nb\_items'] < 1) { |
| [311](#L311) | return $this->cartIsEmpty(); |
| [312](#L312) | }; |
| [313](#L313) |  |
| [314](#L314) | if ((isset($\_GET['logout']) && $\_GET['logout'])) { |
| [315](#L315) | $session->delete("moo\_customer\_token"); |
| [316](#L316) | wp\_redirect($checkout\_page\_url); |
| [317](#L317) | } |
| [318](#L318) | if ($this->pluginSettings['checkout\_login'] == "disabled") { |
| [319](#L319) | $session->delete("moo\_customer\_token"); |
| [320](#L320) | } |
| [321](#L321) | ?> |
| [322](#L322) |  |
| [323](#L323) | <div id="moo\_CheckoutContainer"> |
| [324](#L324) | <div class="moo-row" id="moo-checkout"> |
| [325](#L325) | <div class="errors-section"></div> |
| [326](#L326) | <?php echo $oppening\_msg; ?> |
| [327](#L327) | <div id="moo\_merchantmap"></div> |
| [328](#L328) | <!--            login               --> |
| [329](#L329) | <div id="moo-login-form" <?php if ((!$session->isEmpty("moo\_customer\_token"))) { |
| [330](#L330) | echo 'style="display:none;"'; |
| [331](#L331) | }?> class="moo-col-md-12 "> |
| [332](#L332) | <?php if ($this->displayPageHeader) { ?> |
| [333](#L333) | <div class="moo-row login-top-section" tabindex="-1"> |
| [334](#L334) | <div class="login-header" > |
| [335](#L335) | <?php |
| [336](#L336) | /\* translators: %s represent our link \*/ |
| [337](#L337) | $t = \_\_("Why create a <a href='%s' target='\_blank'>Smart Online Order</a> account?", 'moo\_OnlineOrders'); |
| [338](#L338) | printf($t, "https://www.smartonlineorder.com"); |
| [339](#L339) | ?> |
| [340](#L340) | </div> |
| [341](#L341) | <div class="moo-col-md-6"> |
| [342](#L342) | <ul> |
| [343](#L343) | <li><?php \_e("Save your address", "moo\_OnlineOrders"); ?></li> |
| [344](#L344) | <li><?php \_e("Faster Checkout!", "moo\_OnlineOrders"); ?></li> |
| [345](#L345) | </ul> |
| [346](#L346) | </div> |
| [347](#L347) | <div class="moo-col-md-6"> |
| [348](#L348) | <ul> |
| [349](#L349) | <li><?php \_e("View your past orders", "moo\_OnlineOrders"); ?></li> |
| [350](#L350) | <li><?php \_e("Get exclusive deals and coupons", "moo\_OnlineOrders"); ?></li> |
| [351](#L351) | </ul> |
| [352](#L352) | </div> |
| [353](#L353) | </div> |
| [354](#L354) | <?php } ?> |
| [355](#L355) | <div class="moo-col-md-6" tabindex="0"> |
| [356](#L356) | <div class="moo-row login-social-section"> |
| [357](#L357) | <?php if (!empty($this->pluginSettings['fb\_appid'])) { ?> |
| [358](#L358) | <p> |
| [359](#L359) |  |
| [360](#L360) | <strong><?php \_e("Sign in with your social account", "moo\_OnlineOrders"); ?></strong> |
| [361](#L361) | <br /> |
| [362](#L362) | <small><?php \_e("No posts on your behalf, promise!", "moo\_OnlineOrders"); ?></small> |
| [363](#L363) | </p> |
| [364](#L364) | <div class="moo-row"> |
| [365](#L365) | <div class="moo-col-xs-12 moo-col-sm-6 moo-col-md-7 moo-col-md-offset-3 moo-col-sm-offset-3" > |
| [366](#L366) | <a href="#" class="moo-btn moo-btn-lg moo-btn-primary moo-btn-block" onclick="moo\_loginViaFacebook(event)" style="margin-top: 12px;" tabindex="0" aria-label="Sign in with your Facebook account">Facebook</a> |
| [367](#L367) | </div> |
| [368](#L368) | <div class="moo-col-xs-12 moo-col-sm-12 moo-col-md-7 moo-col-md-offset-3" tabindex="0"> |
| [369](#L369) | <div class="login-or"> |
| [370](#L370) | <hr class="hr-or"> |
| [371](#L371) | <span class="span-or"><?php \_e("or", "moo\_OnlineOrders"); ?></span> |
| [372](#L372) | </div> |
| [373](#L373) | <a role="button" class="moo-btn moo-btn-danger" onclick="moo\_loginAsguest(event)" tabindex="0"> |
| [374](#L374) | <?php \_e("Continue As Guest", "moo\_OnlineOrders"); ?> |
| [375](#L375) | </a> |
| [376](#L376) | </div> |
| [377](#L377) | </div> |
| [378](#L378) | <?php } else { ?> |
| [379](#L379) | <p> |
| [380](#L380) | <?php \_e("Don't want an account?", "moo\_OnlineOrders"); ?> |
| [381](#L381) | <br /> |
| [382](#L382) | <small><?php \_e("You can checkout without registering", "moo\_OnlineOrders"); ?></small> |
| [383](#L383) | </p> |
| [384](#L384) | <div class="moo-row"> |
| [385](#L385) | <div class="moo-col-xs-12 moo-col-sm-6 moo-col-md-9 moo-col-md-offset-2 moo-col-sm-offset-3"> |
| [386](#L386) | <a  role="button" tabindex="0" href="#" class="moo-btn moo-btn-lg moo-btn-primary moo-btn-block" onclick="moo\_loginAsguest(event)" style="margin-top: 12px;"> <?php \_e("Continue As Guest", "moo\_OnlineOrders"); ?></a> |
| [387](#L387) | </div> |
| [388](#L388) | <div class="moo-col-xs-12 moo-col-sm-12 moo-col-md-9 moo-col-md-offset-2"> |
| [389](#L389) | <div class="login-or"> |
| [390](#L390) | <hr class="hr-or"> |
| [391](#L391) | <span class="span-or"><?php \_e("or", "moo\_OnlineOrders"); ?></span> |
| [392](#L392) | </div> |
| [393](#L393) | <a  class="moo-btn moo-btn-danger" onclick="moo\_show\_sigupform(event)"> |
| [394](#L394) | <?php \_e("Create An Account", "moo\_OnlineOrders"); ?> |
| [395](#L395) | </a> |
| [396](#L396) | </div> |
| [397](#L397) | </div> |
| [398](#L398) | <?php  } ?> |
| [399](#L399) | </div> |
| [400](#L400) | <div class="login-separator moo-hidden-xs moo-hidden-sm"> |
| [401](#L401) | <div class="separator"> |
| [402](#L402) | <span><?php \_e("or", "moo\_OnlineOrders"); ?></span> |
| [403](#L403) | </div> |
| [404](#L404) | </div> |
| [405](#L405) | </div> |
| [406](#L406) | <div class="moo-col-md-6" tabindex="0" > |
| [407](#L407) | <form action="#" method="post" onsubmit="moo\_login(event)" aria-label="Sign in with your account"> |
| [408](#L408) | <div class="form-group"> |
| [409](#L409) | <label for="inputEmail"><?php \_e("Email", "moo\_OnlineOrders"); ?></label> |
| [410](#L410) | <input type="text" id="inputEmail" class="moo-form-control" autocomplete="email" aria-label="your email"> |
| [411](#L411) | </div> |
| [412](#L412) | <div class="moo-form-group"> |
| [413](#L413) | <label for="inputPassword"><?php \_e("Password", "moo\_OnlineOrders"); ?></label> |
| [414](#L414) | <input type="password"  id="inputPassword" class="moo-form-control" autocomplete="current-password" aria-label="your password"> |
| [415](#L415) | <a class="pull-right" href="#" onclick="moo\_show\_forgotpasswordform(event)" aria-label="Click here if you forgotten your password"><?php \_e("Forgot password?", "moo\_OnlineOrders"); ?></a> |
| [416](#L416) | </div> |
| [417](#L417) | <button id="mooButonLogin" class="moo-btn" onclick="moo\_login(event)" aria-label="log in"> |
| [418](#L418) | <?php \_e("Log In", "moo\_OnlineOrders"); ?> |
| [419](#L419) | </button> |
| [420](#L420) | <p style="padding: 10px;"> <?php \_e("Don't have an account", "moo\_OnlineOrders"); ?><a href="#" onclick="moo\_show\_sigupform(event)" aria-label="Don't have an account Sign-up"> <?php \_e("Sign-up", "moo\_OnlineOrders"); ?></a> </p> |
| [421](#L421) | </form> |
| [422](#L422) | </div> |
| [423](#L423) | </div> |
| [424](#L424) | <!--            Register            --> |
| [425](#L425) | <div id="moo-signing-form" class="moo-col-md-12"> |
| [426](#L426) | <div class="moo-col-md-8 moo-col-md-offset-2"> |
| [427](#L427) | <form action="#" method="post" onsubmit="moo\_signin(event)"> |
| [428](#L428) | <div class="moo-form-group"> |
| [429](#L429) | <label for="inputMooFullName"><?php \_e("Full Name", "moo\_OnlineOrders"); ?></label> |
| [430](#L430) | <input type="text" class="moo-form-control" id="inputMooFullName" autocomplete="fullName"> |
| [431](#L431) | </div> |
| [432](#L432) |  |
| [433](#L433) | <div class="moo-form-group"> |
| [434](#L434) | <label for="inputMooEmail"><?php \_e("Email", "moo\_OnlineOrders"); ?></label> |
| [435](#L435) | <input type="text" class="moo-form-control" id="inputMooEmail" autocomplete="email"> |
| [436](#L436) | </div> |
| [437](#L437) | <div class="moo-form-group"> |
| [438](#L438) | <label for="inputMooPhone"><?php \_e("Phone number", "moo\_OnlineOrders"); ?></label> |
| [439](#L439) | <input type="text" class="moo-form-control" id="inputMooPhone" autocomplete="phone"> |
| [440](#L440) | </div> |
| [441](#L441) | <div class="moo-form-group"> |
| [442](#L442) | <label for="inputMooPassword"><?php \_e("Password", "moo\_OnlineOrders"); ?></label> |
| [443](#L443) | <input type="password" class="moo-form-control" id="inputMooPassword" autocomplete="current-password"> |
| [444](#L444) | </div> |
| [445](#L445) | <p> |
| [446](#L446) | <?php |
| [447](#L447) | /\* translators: %s represent our tos link \*/ |
| [448](#L448) | printf(\_\_('By clicking the button below, you agree to our <a href="%s" target="\_blank">Terms Of Service</a>', 'moo\_OnlineOrders'), "https://www.zaytech.com/zaytech-eula"); |
| [449](#L449) | ?> |
| [450](#L450) | </p> |
| [451](#L451) | <button class="moo-btn moo-btn-primary" onclick="moo\_signin(event)"> |
| [452](#L452) | <?php \_e("Submit", "moo\_OnlineOrders"); ?> |
| [453](#L453) | </button> |
| [454](#L454) | <p style="padding: 10px;"> <?php \_e("Have an account already?", "moo\_OnlineOrders"); ?><a href="#" onclick="moo\_show\_loginform()">  <?php \_e("Click here", "moo\_OnlineOrders"); ?></a> </p> |
| [455](#L455) | </form> |
| [456](#L456) | </div> |
| [457](#L457) |  |
| [458](#L458) | </div> |
| [459](#L459) | <!--            Reset Password      --> |
| [460](#L460) | <div   id="moo-forgotpassword-form" class="moo-col-md-12"> |
| [461](#L461) | <div class="moo-col-md-8 moo-col-md-offset-2"> |
| [462](#L462) | <form action="#" method="post" onsubmit="moo\_resetpassword(event)"> |
| [463](#L463) | <div class="moo-form-group"> |
| [464](#L464) | <label for="inputEmail4Reset"><?php \_e("Email", "moo\_OnlineOrders"); ?></label> |
| [465](#L465) | <input type="text" class="moo-form-control" id="inputEmail4Reset"> |
| [466](#L466) | </div> |
| [467](#L467) | <button class="moo-btn moo-btn-primary" onclick="moo\_resetpassword(event)"> |
| [468](#L468) | <?php \_e("Reset", "moo\_OnlineOrders"); ?> |
| [469](#L469) | </button> |
| [470](#L470) | <button class="moo-btn moo-btn-default" onclick="moo\_cancel\_resetpassword(event)"> |
| [471](#L471) | <?php \_e("Cancel", "moo\_OnlineOrders"); ?> |
| [472](#L472) | </button> |
| [473](#L473) | </form> |
| [474](#L474) | </div> |
| [475](#L475) | </div> |
| [476](#L476) | <!--            Choose address      --> |
| [477](#L477) | <div id="moo-chooseaddress-form" class="moo-col-md-12"> |
| [478](#L478) | <div id="moo-chooseaddress-formContent" class="moo-row"> |
| [479](#L479) | </div> |
| [480](#L480) | <div class="MooAddressBtnActions"> |
| [481](#L481) | <a class="MooSimplButon" href="#" onclick="moo\_show\_form\_adding\_address()"> |
| [482](#L482) | <?php \_e("Add Another Address", "moo\_OnlineOrders"); ?> |
| [483](#L483) | </a> |
| [484](#L484) | <a class="MooSimplButon" href="#" onclick="moo\_pickup\_the\_order(event)"> |
| [485](#L485) | <?php \_e("Click here if this Order is for Pick Up", "moo\_OnlineOrders"); ?> |
| [486](#L486) | </a> |
| [487](#L487) | </div> |
| [488](#L488) | </div> |
| [489](#L489) | <!--            Add new address      --> |
| [490](#L490) | <div id="moo-addaddress-form" class="moo-col-md-12"> |
| [491](#L491) | <form method="post" onsubmit="moo\_addAddress(event)"> |
| [492](#L492) | <h1 tabindex="0" aria-level="1"> |
| [493](#L493) | <?php \_e("Add new Address to your account", "moo\_OnlineOrders"); ?> |
| [494](#L494) | </h1> |
| [495](#L495) | <div class="moo-col-md-8 moo-col-md-offset-2"> |
| [496](#L496) | <div class="mooFormAddingAddress"> |
| [497](#L497) | <div class="moo-form-group"> |
| [498](#L498) | <label for="inputMooAddress"><?php \_e("Address", "moo\_OnlineOrders"); ?></label> |
| [499](#L499) | <input type="text" class="moo-form-control" id="inputMooAddress"> |
| [500](#L500) | </div> |
| [501](#L501) | <div class="moo-form-group"> |
| [502](#L502) | <label for="inputMooAddress2"><?php \_e("Suite / Apt #", "moo\_OnlineOrders"); ?></label> |
| [503](#L503) | <input type="text" class="moo-form-control" id="inputMooAddress2"> |
| [504](#L504) | </div> |
| [505](#L505) | <div class="moo-form-group"> |
| [506](#L506) | <label for="inputMooCity"><?php \_e("City", "moo\_OnlineOrders"); ?></label> |
| [507](#L507) | <input type="text" class="moo-form-control" id="inputMooCity"> |
| [508](#L508) | </div> |
| [509](#L509) | <div class="moo-form-group"> |
| [510](#L510) | <label for="inputMooState"><?php \_e("State", "moo\_OnlineOrders"); ?></label> |
| [511](#L511) | <input type="text" class="moo-form-control" id="inputMooState"> |
| [512](#L512) | </div> |
| [513](#L513) | <div class="moo-form-group"> |
| [514](#L514) | <label for="inputMooZipcode"><?php \_e("Zip code", "moo\_OnlineOrders"); ?></label> |
| [515](#L515) | <input type="text" class="moo-form-control" id="inputMooZipcode"> |
| [516](#L516) | </div> |
| [517](#L517) | <p class="moo-centred"> |
| [518](#L518) | <button href="#" class="moo-btn moo-btn-warning" onclick="moo\_ConfirmAddressOnMap(event)"><?php \_e("Next", "moo\_OnlineOrders"); ?></button> |
| [519](#L519) | </p> |
| [520](#L520) | </div> |
| [521](#L521) | <div class="mooFormConfirmingAddress"> |
| [522](#L522) | <div id="MooMapAddingAddress" tabindex="-1"> |
| [523](#L523) | <p style="margin-top: 150px;"><?php \_e("Loading the MAP...", "moo\_OnlineOrders"); ?></p> |
| [524](#L524) | </div> |
| [525](#L525) | <input type="hidden" class="moo-form-control" id="inputMooLat"> |
| [526](#L526) | <input type="hidden" class="moo-form-control" id="inputMooLng"> |
| [527](#L527) | <div class="form-group"> |
| [528](#L528) | <button id="mooButonAddAddress" onclick="moo\_addAddress(event)" aria-label="Confirm and add address"> |
| [529](#L529) | <?php \_e("Confirm and add address", "moo\_OnlineOrders"); ?> |
| [530](#L530) | </button> |
| [531](#L531) | <button id="mooButonChangeAddress" onclick="moo\_changeAddress(event)" aria-label="Change address"> |
| [532](#L532) | <?php \_e("Change address", "moo\_OnlineOrders"); ?> |
| [533](#L533) | </button> |
| [534](#L534) | </div> |
| [535](#L535) | </div> |
| [536](#L536) | <p style="padding: 10px;"> |
| [537](#L537) | <?php \_e("If you want to skip this step and add your address later ", "moo\_OnlineOrders"); ?> |
| [538](#L538) | <a role="button" href="#" onclick="moo\_pickup\_the\_order(event)" style="color:blue"> |
| [539](#L539) | <?php \_e("Click here", "moo\_OnlineOrders"); ?> |
| [540](#L540) | </a> |
| [541](#L541) | </p> |
| [542](#L542) | </div> |
| [543](#L543) | </form> |
| [544](#L544) | </div> |
| [545](#L545) | <!--            Checkout form        --> |
| [546](#L546) | <div id="moo-checkout-form" class="moo-col-md-12" <?php if ($this->pluginSettings['checkout\_login']=="disabled") { |
| [547](#L547) | echo 'style="display:block;"'; |
| [548](#L548) | }?>> |
| [549](#L549) | <form action="#" method="post" onsubmit="moo\_finalize\_order(event)"> |
| [550](#L550) | <!--            Checkout form - Informaton section       --> |
| [551](#L551) | <div class="moo-col-md-7 moo-checkout-form-leftside" tabindex="0" aria-label="the checkout form"> |
| [552](#L552) | <div id="moo-checkout-form-customer" tabindex="0" aria-label="your information"> |
| [553](#L553) | <div class="moo-checkout-bloc-title moo-checkoutText-contact"> |
| [554](#L554) | <?php \_e("contact", "moo\_OnlineOrders"); ?> |
| [555](#L555) | <span class="moo-checkout-edit-icon" onclick="moo\_checkout\_edit\_contact()"> |
| [556](#L556) | <img src="<?php echo  SOO\_PLUGIN\_PATH."/public/img/edit-pen.png"?>" alt="edit"> |
| [557](#L557) | </span> |
| [558](#L558) | </div> |
| [559](#L559) | <div class="moo-checkout-bloc-content"> |
| [560](#L560) | <div id="moo-checkout-contact-content"> |
| [561](#L561) | </div> |
| [562](#L562) | <div id="moo-checkout-contact-form"> |
| [563](#L563) | <div class="moo-row"> |
| [564](#L564) | <div class="moo-form-group"> |
| [565](#L565) | <label for="MooContactName" class="moo-checkoutText-fullName"><?php \_e("Full Name", "moo\_OnlineOrders"); ?>:\*</label> |
| [566](#L566) | <input class="moo-form-control" name="name" id="MooContactName" autocomplete="name"> |
| [567](#L567) | </div> |
| [568](#L568) | </div> |
| [569](#L569) | <div class="moo-row"> |
| [570](#L570) | <div class="moo-form-group"> |
| [571](#L571) | <label for="MooContactEmail" class="moo-checkoutText-email"><?php \_e("Email", "moo\_OnlineOrders"); ?>:\*</label> |
| [572](#L572) | <input class="moo-form-control" id="MooContactEmail" autocomplete="email"> |
| [573](#L573) | </div> |
| [574](#L574) | </div> |
| [575](#L575) | <div class="moo-row"> |
| [576](#L576) | <div class="moo-form-group"> |
| [577](#L577) | <label for="MooContactPhone" class="moo-checkoutText-phoneNumber"><?php \_e("Phone number", "moo\_OnlineOrders"); ?>:\*</label> |
| [578](#L578) | <input class="moo-form-control" name="phone" id="MooContactPhone" onchange="moo\_phone\_changed()" autocomplete="phone"> |
| [579](#L579) | </div> |
| [580](#L580) | </div> |
| [581](#L581) | <?php wp\_nonce\_field('moo-checkout-form');?> |
| [582](#L582) | </div> |
| [583](#L583) | </div> |
| [584](#L584) | </div> |
| [585](#L585) | <div class="moo\_checkout\_border\_bottom"></div> |
| [586](#L586) | <?php if (count($orderTypes)>0) {?> |
| [587](#L587) | <div id="moo-checkout-form-ordertypes" tabindex="0" aria-label="the ordering method"> |
| [588](#L588) | <div class="moo-checkout-bloc-title moo-checkoutText-orderingMethod"> |
| [589](#L589) | <?php \_e("ORDERING METHOD", "moo\_OnlineOrders"); ?>\* |
| [590](#L590) | </div> |
| [591](#L591) | <div class="moo-checkout-bloc-content"> |
| [592](#L592) | <?php |
| [593](#L593) | foreach ($orderTypes as $ot) { |
| [594](#L594) | echo '<div class="moo-checkout-form-ordertypes-option">'; |
| [595](#L595) | if (isset($ot->available) && $ot->available === false) { |
| [596](#L596) | echo '<input class="moo-checkout-form-ordertypes-input" type="radio" name="ordertype" value="'.esc\_attr($ot->ot\_uuid).'" id="moo-checkout-form-ordertypes-'.esc\_attr($ot->ot\_uuid).'" disabled>'; |
| [597](#L597) | echo '<label for="moo-checkout-form-ordertypes-'.esc\_attr($ot->ot\_uuid).'" style="display: inline;margin-left:15px;font-size: 16px; vertical-align: sub;">'.wp\_kses\_post(wp\_unslash($ot->label)).' ( '.wp\_kses\_post(wp\_unslash($ot->custom\_message)).' )</label></div>'; |
| [598](#L598) | } else { |
| [599](#L599) | echo '<input class="moo-checkout-form-ordertypes-input" type="radio" name="ordertype" value="'.esc\_attr($ot->ot\_uuid).'" id="moo-checkout-form-ordertypes-'.esc\_attr($ot->ot\_uuid).'">'; |
| [600](#L600) | echo '<label for="moo-checkout-form-ordertypes-'.esc\_attr($ot->ot\_uuid).'" style="display: inline;margin-left:15px;font-size: 16px; vertical-align: sub;">'.wp\_kses\_post(wp\_unslash($ot->label)).'</label></div>'; |
| [601](#L601) | } |
| [602](#L602) | } |
| [603](#L603) | ?> |
| [604](#L604) | </div> |
| [605](#L605) | <div class="moo-checkout-bloc-message" id="moo-checkout-form-ordertypes-message"> |
| [606](#L606) | </div> |
| [607](#L607) | </div> |
| [608](#L608) | <div class="moo\_checkout\_border\_bottom"></div> |
| [609](#L609) | <?php  } ?> |
| [610](#L610) | <?php |
| [611](#L611) | if ($showTimeSection) {?> |
| [612](#L612) | <div id="moo-checkout-form-orderdate" tabindex="0" aria-label="Choose a time if you want schedule the order"> |
| [613](#L613) | <div class="moo-checkout-bloc-title moo-checkoutText-ChooseATime"> |
| [614](#L614) | <?php \_e("CHOOSE A TIME", "moo\_OnlineOrders"); ?> |
| [615](#L615) | </div> |
| [616](#L616) | <div class="moo-checkout-bloc-content"> |
| [617](#L617) | <div class="moo-row"> |
| [618](#L618) | <div class="moo-col-md-6"> |
| [619](#L619) | <div class="moo-form-group"> |
| [620](#L620) | <label for="moo\_pickup\_day"></label> |
| [621](#L621) | <select class="moo-form-control" name="moo\_pickup\_day" id="moo\_pickup\_day" onchange="moo\_pickup\_day\_changed(this)"> |
| [622](#L622) | <?php |
| [623](#L623) | foreach ($oppening\_status["pickup\_time"] as $key => $val) { |
| [624](#L624) | echo '<option value="'.esc\_attr($key).'">'.esc\_attr($key).'</option>'; |
| [625](#L625) | } |
| [626](#L626) | ?> |
| [627](#L627) | </select> |
| [628](#L628) | </div> |
| [629](#L629) | </div> |
| [630](#L630) | <div class="moo-col-md-6"> |
| [631](#L631) | <div class="moo-form-group"> |
| [632](#L632) | <label for="moo\_pickup\_hour"></label> |
| [633](#L633) | <select class="moo-form-control" name="moo\_pickup\_hour" id="moo\_pickup\_hour" > |
| [634](#L634) | <?php |
| [635](#L635) | foreach ($oppening\_status["pickup\_time"] as $val) { |
| [636](#L636) | foreach ($val as $h) { |
| [637](#L637) | echo '<option value="'.esc\_attr($h).'">'.esc\_attr($h).'</option>'; |
| [638](#L638) | } |
| [639](#L639) | break; |
| [640](#L640) | } |
| [641](#L641) | ?> |
| [642](#L642) | </select> |
| [643](#L643) | </div> |
| [644](#L644) | </div> |
| [645](#L645) | </div> |
| [646](#L646) | <?php if ($oppening\_status["store\_time"] != '') { ?> |
| [647](#L647) | <div class="moo-row"> |
| [648](#L648) | <div class="moo-col-md-12"> |
| [649](#L649) | <?php \_e("Today's Online Ordering Hours", "moo\_OnlineOrders"); ?> : <?php echo $oppening\_status["store\_time"]  ?> |
| [650](#L650) | </div> |
| [651](#L651) | </div> |
| [652](#L652) | <?php } ?> |
| [653](#L653) | </div> |
| [654](#L654) | </div> |
| [655](#L655) | <div class="moo\_checkout\_border\_bottom"></div> |
| [656](#L656) | <?php } ?> |
| [657](#L657) | <div id="moo-checkout-form-payments" tabindex="0" aria-label="the payments method"> |
| [658](#L658) | <div class="moo-checkout-bloc-title moo-checkoutText-payment" > |
| [659](#L659) | <?php \_e("PAYMENT METHOD", "moo\_OnlineOrders"); ?>\* |
| [660](#L660) | </div> |
| [661](#L661) | <div class="moo-checkout-bloc-content"> |
| [662](#L662) | <?php if (isset($cloverCodeExist) && $cloverCodeExist && isset($this->pluginSettings['clover\_payment\_form']) && $this->pluginSettings['clover\_payment\_form'] == 'on') { |
| [663](#L663) | $this->creditCardSelectorOld(); |
| [664](#L664) | } |
| [665](#L665) | if ($this->pluginSettings['payment\_cash'] == 'on' || $this->pluginSettings['payment\_cash\_delivery'] == 'on') { |
| [666](#L666) | $this->cashSelectorOld(); |
| [667](#L667) | } |
| [668](#L668) | if (isset($cloverCodeExist) && $cloverCodeExist  && isset($this->pluginSettings['clover\_payment\_form']) && $this->pluginSettings['clover\_payment\_form'] == 'on') { |
| [669](#L669) | $this->cloverCardSectionOld(); |
| [670](#L670) | } |
| [671](#L671) | if ($this->pluginSettings['payment\_cash'] == 'on' || $this->pluginSettings['payment\_cash\_delivery'] == 'on') { ?> |
| [672](#L672) | <div id="moo\_cashPanel"> |
| [673](#L673) | <div class="moo-row"  id="moo\_verifPhone\_verified"> |
| [674](#L674) | <img src="<?php echo  SOO\_PLUGIN\_URL ."/public/img/check.png"?>" width="60px" style="display: inline-block;" alt=""> |
| [675](#L675) | <p> |
| [676](#L676) | <?php \_e("Your phone number has been verified", "moo\_OnlineOrders"); ?> |
| [677](#L677) | <br/> |
| [678](#L678) | <?php \_e("Please finalize your order below", "moo\_OnlineOrders"); ?> |
| [679](#L679) | </p> |
| [680](#L680) | </div> |
| [681](#L681) | <div class="moo-row" id="moo\_verifPhone\_sending"> |
| [682](#L682) | <div class="moo-form-group moo-form-inline"> |
| [683](#L683) | <label for="Moo\_PhoneToVerify moo-checkoutText-yourPhone"><?php \_e("Your Phone", "moo\_OnlineOrders"); ?></label> |
| [684](#L684) | <input class="moo-form-control" id="Moo\_PhoneToVerify" style="margin-bottom: 10px" onchange="moo\_phone\_to\_verif\_changed()"/> |
| [685](#L685) | <a class="moo-btn moo-btn-primary" href="#" style="margin-bottom: 10px" onclick="moo\_verifyPhone(event)"> |
| [686](#L686) | <?php \_e("Verify via SMS", "moo\_OnlineOrders"); ?> |
| [687](#L687) | </a> |
| [688](#L688) | <label for="Moo\_PhoneToVerify" class="error" style="display: none;"></label> |
| [689](#L689) | </div> |
| [690](#L690) | <p> |
| [691](#L691) | <?php \_e("We will send a verification code via SMS to number above", "moo\_OnlineOrders"); ?> |
| [692](#L692) | </p> |
| [693](#L693) | </div> |
| [694](#L694) | <div class="moo-row" id="moo\_verifPhone\_verificatonCode"> |
| [695](#L695) | <p style='font-size:18px;color:green'> |
| [696](#L696) | <?php \_e("Please enter the verification that was sent to your phone, if you didn't receive a code,", "moo\_OnlineOrders"); ?> |
| [697](#L697) | <a href="#" onclick="moo\_verifyCodeTryAgain(event)"> |
| [698](#L698) | <?php \_e("click here to try again", "moo\_OnlineOrders"); ?> |
| [699](#L699) | </a> |
| [700](#L700) | </p> |
| [701](#L701) | <div class="moo-form-group moo-form-inline"> |
| [702](#L702) | <input class="moo-form-control" id="Moo\_VerificationCode" style="margin-bottom: 10px" autocomplete="off" /> |
| [703](#L703) | <a class="moo-btn moo-btn-primary" href="#" style="margin-bottom: 10px" onclick="moo\_verifyCode(event)"> |
| [704](#L704) | <?php \_e("Submit", "moo\_OnlineOrders"); ?> |
| [705](#L705) | </a> |
| [706](#L706) | <label for="Moo\_VerificationCode" class="error" style="display: none;"></label> |
| [707](#L707) | </div> |
| [708](#L708) | </div> |
| [709](#L709) | </div> |
| [710](#L710) | <?php } ?> |
| [711](#L711) | </div> |
| [712](#L712) | </div> |
| [713](#L713) | <div class="moo\_checkout\_border\_bottom"></div> |
| [714](#L714) |  |
| [715](#L715) | <?php |
| [716](#L716) | if ($this->pluginSettings['tips'] == 'enabled' && isset($merchant\_proprites->tipsEnabled) && $merchant\_proprites->tipsEnabled) { |
| [717](#L717) | $this->tipsSectionOld(); |
| [718](#L718) | $this->borderBottom(); |
| [719](#L719) | } |
| [720](#L720) | if ($this->pluginSettings['use\_special\_instructions']=="enabled") { |
| [721](#L721) | ?> |
| [722](#L722) | <div id="moo-checkout-form-instruction"> |
| [723](#L723) | <div class="moo-checkout-bloc-title moo-checkoutText-instructions"> |
| [724](#L724) | <label for="Mooinstructions"> |
| [725](#L725) | <?php \_e("Special instructions", "moo\_OnlineOrders"); ?> |
| [726](#L726) | </label> |
| [727](#L727) | </div> |
| [728](#L728) | <div class="moo-checkout-bloc-content"> |
| [729](#L729) | <?php |
| [730](#L730) | if (isset($this->pluginSettings['text\_under\_special\_instructions']) && $this->pluginSettings['text\_under\_special\_instructions']!=='') { |
| [731](#L731) | echo '<div class="moo-special-instruction-title">'.wp\_kses\_post(wp\_unslash($this->pluginSettings['text\_under\_special\_instructions'])).'</div>'; |
| [732](#L732) | } |
| [733](#L733) | if (isset($this->pluginSettings['special\_instructions\_required']) && $this->pluginSettings['special\_instructions\_required']==='yes') { |
| [734](#L734) | echo '<textarea class="moo-form-control" cols="100%" rows="5" id="Mooinstructions" required></textarea>'; |
| [735](#L735) | } else { |
| [736](#L736) | echo '<textarea class="moo-form-control" cols="100%" rows="5" id="Mooinstructions"></textarea>'; |
| [737](#L737) | } |
| [738](#L738) | ?> |
| [739](#L739) | </div> |
| [740](#L740) | </div> |
| [741](#L741) | <?php |
| [742](#L742) | } |
| [743](#L743) | //Check if coupons are enabled |
| [744](#L744) | if ($this->pluginSettings['use\_coupons'] == "enabled" ) { |
| [745](#L745) | ?> |
| [746](#L746) | <div class="moo\_checkout\_border\_bottom"></div> |
| [747](#L747) | <div id="moo-checkout-form-coupon"> |
| [748](#L748) | <div class="moo-checkout-bloc-title moo-checkoutText-couponCode"> |
| [749](#L749) | <label for="moo\_coupon"> |
| [750](#L750) | <?php \_e("Coupon code", "moo\_OnlineOrders"); ?> |
| [751](#L751) | </label> |
| [752](#L752) | </div> |
| [753](#L753) | <div class="moo-checkout-bloc-content" id="moo\_enter\_coupon" style="<?php if ($coupon !== null) { |
| [754](#L754) | echo 'display:none'; |
| [755](#L755) | }?>"> |
| [756](#L756) | <div class="moo-col-md-8"> |
| [757](#L757) | <div class="moo-form-group"> |
| [758](#L758) | <input onchange="mooCouponValueChanged(event)" type="text" class="moo-form-control" id="moo\_coupon" style="background-color: #ffffff"> |
| [759](#L759) | </div> |
| [760](#L760) | </div> |
| [761](#L761) | <div class="moo-col-md-4"> |
| [762](#L762) | <div class="moo-form-group"> |
| [763](#L763) | <a href="#" class="moo-btn moo-btn-primary" onclick="mooCouponApply(event)" style="height: 40px;line-height: 24px;"> |
| [764](#L764) | <?php \_e("Apply", "moo\_OnlineOrders"); ?> |
| [765](#L765) | </a> |
| [766](#L766) | </div> |
| [767](#L767) | </div> |
| [768](#L768) | </div> |
| [769](#L769) | <div class="moo-checkout-bloc-content" id="moo\_remove\_coupon" style="<?php if ($coupon === null) { |
| [770](#L770) | echo 'display:none'; |
| [771](#L771) | } ?>"> |
| [772](#L772) | <div class="moo-col-md-8"> |
| [773](#L773) | <div class="moo-form-group"> |
| [774](#L774) | <p style="font-size: 20px" id="moo\_remove\_coupon\_code"> |
| [775](#L775) | <?php |
| [776](#L776) | if ($coupon != null) { |
| [777](#L777) | echo sanitize\_text\_field($coupon['code']); |
| [778](#L778) | } |
| [779](#L779) | ?></p> |
| [780](#L780) | </div> |
| [781](#L781) | </div> |
| [782](#L782) | <div class="moo-col-md-4"> |
| [783](#L783) | <div class="moo-form-group"> |
| [784](#L784) | <a href="#" class="moo-btn moo-btn-primary" onclick="mooCouponRemove(event)"> |
| [785](#L785) | <?php \_e("Remove", "moo\_OnlineOrders"); ?> |
| [786](#L786) | </a> |
| [787](#L787) | </div> |
| [788](#L788) | </div> |
| [789](#L789) | </div> |
| [790](#L790) | </div> |
| [791](#L791) | <?php  }?> |
| [792](#L792) | </div> |
| [793](#L793) | <!--            Checkout form - Cart section       --> |
| [794](#L794) | <div class="moo-col-md-5 moo-checkout-cart"> |
| [795](#L795) | <div class="moo-shopping-cart MooCartInCheckout" tabindex="0" aria-label="the cart"> |
| [796](#L796) | <div class="moo-column-labels-checkout"> |
| [797](#L797) | <label class="moo-product-quantity moo-product-quantity-checkou moo-checkoutText-qtyt" style="width: 20%"><?php \_e("Qty", "moo\_OnlineOrders"); ?></label> |
| [798](#L798) | <label class="moo-product-details moo-product-details-checkout moo-checkoutText-product" style="width: 60%"><?php \_e("Product", "moo\_OnlineOrders"); ?></label> |
| [799](#L799) | <label class="moo-product-price moo-product-price-checkout moo-checkoutText-price" style="width: 20%"><?php \_e("Price", "moo\_OnlineOrders"); ?></label> |
| [800](#L800) | </div> |
| [801](#L801) | <?php foreach ($session->get("items") as $key => $line) { |
| [802](#L802) | $modifiers\_price = 0; |
| [803](#L803) | if (isset($line['item']->soo\_name) && !empty($line['item']->soo\_name)) { |
| [804](#L804) | $item\_name=wp\_unslash((string)$line['item']->soo\_name); |
| [805](#L805) | } else { |
| [806](#L806) | if ($this->useAlternateNames && isset($line['item']->alternate\_name) && $line['item']->alternate\_name!=="") { |
| [807](#L807) | $item\_name=wp\_unslash((string)$line['item']->alternate\_name); |
| [808](#L808) | } else { |
| [809](#L809) | $item\_name=wp\_unslash((string)$line['item']->name); |
| [810](#L810) | } |
| [811](#L811) | } |
| [812](#L812) |  |
| [813](#L813) | ?> |
| [814](#L814) | <div class="moo-product" tabindex="0" aria-label="<?php echo sanitize\_text\_field($line['quantity'])." of ".$line['item']->name."" ?>"> |
| [815](#L815) | <div class="moo-product-quantity" style="width: 20%"> |
| [816](#L816) | <strong><?php echo sanitize\_text\_field($line['quantity']); ?></strong> |
| [817](#L817) | </div> |
| [818](#L818) | <div class="moo-product-details moo-product-details-checkout" style="width: 60%"> |
| [819](#L819) | <div class="moo-product-title"><strong><?php echo $item\_name; ?></strong></div> |
| [820](#L820) | <p class="moo-product-description"> |
| [821](#L821) | <?php |
| [822](#L822) | foreach ($line['modifiers'] as $modifier) { |
| [823](#L823) | $modifier\_name = ""; |
| [824](#L824) | if ($this->useAlternateNames && isset($modifier["alternate\_name"]) && $modifier["alternate\_name"]!=="") { |
| [825](#L825) | $modifier\_name =wp\_unslash((string)$modifier["alternate\_name"]); |
| [826](#L826) | } else { |
| [827](#L827) | $modifier\_name =wp\_unslash((string)$modifier["name"]); |
| [828](#L828) | } |
| [829](#L829) | if (isset($modifier['qty']) && intval($modifier['qty'])>0) { |
| [830](#L830) | echo '<small tabindex="0">'.$modifier['qty'].'x '; |
| [831](#L831) | $modifiers\_price += $modifier['price']\*$modifier['qty']; |
| [832](#L832) | } else { |
| [833](#L833) | echo '<small tabindex="0">1x '; |
| [834](#L834) | $modifiers\_price += $modifier['price']; |
| [835](#L835) | } |
| [836](#L836) |  |
| [837](#L837) | if ($modifier['price']>0) { |
| [838](#L838) | echo ''.$modifier\_name.'- $'.number\_format(($modifier['price']/100), 2)."</small><br/>"; |
| [839](#L839) | } else { |
| [840](#L840) | echo ''.$modifier\_name."</small><br/>"; |
| [841](#L841) | } |
| [842](#L842) | } |
| [843](#L843) | if ($line['special\_ins'] != "") { |
| [844](#L844) | echo '<span tabindex="0" aria-label="your special instructions">SI:<span><span tabindex="0"> '.sanitize\_text\_field($line['special\_ins'])."<span>"; |
| [845](#L845) | } |
| [846](#L846) | ?> |
| [847](#L847) | </p> |
| [848](#L848) | </div> |
| [849](#L849) | <?php $line\_price = $line['item']->price+$modifiers\_price;?> |
| [850](#L850) | <div class="moo-product-line-price" tabindex="0"><strong>$<?php echo number\_format(($line\_price\*$line['quantity']/100), 2)?></strong></div> |
| [851](#L851) | </div> |
| [852](#L852) | <?php } ?> |
| [853](#L853) |  |
| [854](#L854) | <div class="moo-totals" style="padding-right: 10px;"> |
| [855](#L855) | <div class="moo-totals-item"> |
| [856](#L856) | <label class="moo-checkoutText-subtotal"  tabindex="0"><?php \_e("Subtotal", "moo\_OnlineOrders"); ?></label> |
| [857](#L857) | <div class="moo-totals-value" id="moo-cart-subtotal"  tabindex="0"> |
| [858](#L858) | <?php echo number\_format(($totals['sub\_total']/100), 2)?> |
| [859](#L859) | </div> |
| [860](#L860) | </div> |
| [861](#L861) | <?php if ($this->pluginSettings['use\_coupons']=="enabled") { //check if coupons are enabled ?> |
| [862](#L862) | <div class="moo-totals-item" id="MooCouponInTotalsSection" style="<?php if ($totals['coupon\_value'] === 0) { |
| [863](#L863) | echo 'display:none;'; |
| [864](#L864) | }?>;color: green;"> |
| [865](#L865) | <label id="mooCouponName" tabindex="0"><?php echo $totals['coupon\_name'];?></label> |
| [866](#L866) | <div class="moo-totals-value" id="mooCouponValue" tabindex="0"> |
| [867](#L867) | <?php  echo '- $'.number\_format($totals['coupon\_value']/100, 2); ?> |
| [868](#L868) | </div> |
| [869](#L869) | </div> |
| [870](#L870) | <?php } ?> |
| [871](#L871) | <div class="moo-totals-item"> |
| [872](#L872) | <label class="moo-checkoutText-tax"  tabindex="0" ><?php \_e("Tax", "moo\_OnlineOrders"); ?></label> |
| [873](#L873) | <div class="moo-totals-value" id="moo-cart-tax"  tabindex="0"> |
| [874](#L874) | <?php |
| [875](#L875) | if ($totals['coupon\_value'] === 0) { |
| [876](#L876) | echo  '$'.number\_format($totals['total\_of\_taxes\_without\_discounts']/100, 2); |
| [877](#L877) | } else { |
| [878](#L878) | echo  '$'.number\_format($totals['total\_of\_taxes']/100, 2); |
| [879](#L879) | } |
| [880](#L880) | ?> |
| [881](#L881) | </div> |
| [882](#L882) | </div> |
| [883](#L883) | <div class="moo-totals-item" id="MooDeliveryfeesInTotalsSection"> |
| [884](#L884) | <label class="moo-checkoutText-deliveryFees"  tabindex="0"> |
| [885](#L885) | <?php echo ($this->pluginSettings["delivery\_fees\_name"] === "")?"Delivery Charge":$this->pluginSettings["delivery\_fees\_name"];?> |
| [886](#L886) | </label> |
| [887](#L887) | <div class="moo-totals-value" id="moo-cart-delivery-fee"  tabindex="0"> |
| [888](#L888) | <?php |
| [889](#L889) | echo '$'.number\_format(($totals['delivery\_charges']/100), 2); |
| [890](#L890) | ?> |
| [891](#L891) | </div> |
| [892](#L892) | </div> |
| [893](#L893) | <div class="moo-totals-item" id="MooServiceChargesInTotalsSection"  style="<?php if ($totals['service\_fee'] <= 0) { |
| [894](#L894) | echo 'display:none;'; |
| [895](#L895) | }?>"> |
| [896](#L896) | <label id="MooServiceChargesName" tabindex="0"> |
| [897](#L897) | <?php |
| [898](#L898) | if (isset($this->pluginSettings['service\_fees\_name']) && !empty($this->pluginSettings['service\_fees\_name'])) { |
| [899](#L899) | echo $this->pluginSettings['service\_fees\_name']; |
| [900](#L900) | } else { |
| [901](#L901) | echo "Service Fees"; |
| [902](#L902) | } |
| [903](#L903) | ?> |
| [904](#L904) | </label> |
| [905](#L905) | <div class="moo-totals-value" id="moo-cart-service-fee"  tabindex="0"> |
| [906](#L906) | <?php |
| [907](#L907) | echo '$'.number\_format($totals['service\_fee']/100, 2); |
| [908](#L908) | ?> |
| [909](#L909) | </div> |
| [910](#L910) | </div> |
| [911](#L911) | <?php if ($this->pluginSettings['tips']=='enabled') {?> |
| [912](#L912) | <div class="moo-totals-item" id="MooTipsInTotalsSection"> |
| [913](#L913) | <label class="moo-checkoutText-tipAmount" tabindex="0" ><?php \_e("Tip", "moo\_OnlineOrders"); ?></label> |
| [914](#L914) | <div class="moo-totals-value" id="moo-cart-tip" tabindex="0"> |
| [915](#L915) | $0.00 |
| [916](#L916) | </div> |
| [917](#L917) | </div> |
| [918](#L918) | <?php } ?> |
| [919](#L919) | <div class="moo-totals-item moo-totals-item-total" style="font-weight: 700;" > |
| [920](#L920) | <label class="moo-checkoutText-grandTotal" tabindex="0" ><?php \_e("Total", "moo\_OnlineOrders"); ?></label> |
| [921](#L921) | <div class="moo-totals-value" id="moo-cart-total" tabindex="0" > |
| [922](#L922) | <?php |
| [923](#L923) | if ($totals['coupon\_value'] === 0) { |
| [924](#L924) | $grandTotal = $totals['total'] + $totals['service\_fee'] + $totals['delivery\_charges']; |
| [925](#L925) | } else { |
| [926](#L926) | $grandTotal = $totals['total\_without\_discounts'] + $totals['service\_fee'] + $totals['delivery\_charges'] - $totals['coupon\_value']; |
| [927](#L927) | } |
| [928](#L928) | echo '$'.number\_format($grandTotal/100, 2); |
| [929](#L929) | ?> |
| [930](#L930) | </div> |
| [931](#L931) | </div> |
| [932](#L932) | </div> |
| [933](#L933) | </div> |
| [934](#L934) | <!--   Checkout form - Link section     --> |
| [935](#L935) | <div style="text-align: center;text-decoration: none;"> |
| [936](#L936) | <a href="<?php echo $cart\_page\_url?>" class="moo-checkoutText-updateCart"> |
| [937](#L937) | <?php \_e("Update cart", "moo\_OnlineOrders"); ?> |
| [938](#L938) | </a> |
| [939](#L939) | <a href="<?php echo $store\_page\_url?>" class="moo-checkoutText-continueShopping"> |
| [940](#L940) | <?php \_e("Continue shopping", "moo\_OnlineOrders"); ?> |
| [941](#L941) | </a> |
| [942](#L942) | </div> |
| [943](#L943) | </div> |
| [944](#L944) |  |
| [945](#L945) | <!--            Checkout form - Buttons section       --> |
| [946](#L946) | <div id="moo-checkout-form-btnActions"> |
| [947](#L947) | <div id="moo\_checkout\_loading" style="display: none; width: 100%;text-align: center"> |
| [948](#L948) | <svg xmlns="http://www.w3.org/2000/svg" width="44px" height="44px" viewBox="0 0 100 100" |
| [949](#L949) | preserveAspectRatio="xMidYMid" class="uil-default"> |
| [950](#L950) | <rect x="0" y="0" width="100" height="100" fill="none" class="bk"></rect> |
| [951](#L951) | <rect x="46.5" y="40" width="7" height="20" rx="5" ry="5" fill="#00b2ff" |
| [952](#L952) | transform="rotate(0 50 50) translate(0 -30)"> |
| [953](#L953) | <animate attributeName="opacity" from="1" to="0" dur="1s" begin="0s" |
| [954](#L954) | repeatCount="indefinite"></animate> |
| [955](#L955) | </rect> |
| [956](#L956) | <rect x="46.5" y="40" width="7" height="20" rx="5" ry="5" fill="#00b2ff" |
| [957](#L957) | transform="rotate(30 50 50) translate(0 -30)"> |
| [958](#L958) | <animate attributeName="opacity" from="1" to="0" dur="1s" |
| [959](#L959) | begin="0.08333333333333333s" repeatCount="indefinite"></animate> |
| [960](#L960) | </rect> |
| [961](#L961) | <rect x="46.5" y="40" width="7" height="20" rx="5" ry="5" fill="#00b2ff" |
| [962](#L962) | transform="rotate(60 50 50) translate(0 -30)"> |
| [963](#L963) | <animate attributeName="opacity" from="1" to="0" dur="1s" |
| [964](#L964) | begin="0.16666666666666666s" repeatCount="indefinite"></animate> |
| [965](#L965) | </rect> |
| [966](#L966) | <rect x="46.5" y="40" width="7" height="20" rx="5" ry="5" fill="#00b2ff" |
| [967](#L967) | transform="rotate(90 50 50) translate(0 -30)"> |
| [968](#L968) | <animate attributeName="opacity" from="1" to="0" dur="1s" begin="0.25s" |
| [969](#L969) | repeatCount="indefinite"></animate> |
| [970](#L970) | </rect> |
| [971](#L971) | <rect x="46.5" y="40" width="7" height="20" rx="5" ry="5" fill="#00b2ff" |
| [972](#L972) | transform="rotate(120 50 50) translate(0 -30)"> |
| [973](#L973) | <animate attributeName="opacity" from="1" to="0" dur="1s" |
| [974](#L974) | begin="0.3333333333333333s" repeatCount="indefinite"></animate> |
| [975](#L975) | </rect> |
| [976](#L976) | <rect x="46.5" y="40" width="7" height="20" rx="5" ry="5" fill="#00b2ff" |
| [977](#L977) | transform="rotate(150 50 50) translate(0 -30)"> |
| [978](#L978) | <animate attributeName="opacity" from="1" to="0" dur="1s" |
| [979](#L979) | begin="0.4166666666666667s" repeatCount="indefinite"></animate> |
| [980](#L980) | </rect> |
| [981](#L981) | <rect x="46.5" y="40" width="7" height="20" rx="5" ry="5" fill="#00b2ff" |
| [982](#L982) | transform="rotate(180 50 50) translate(0 -30)"> |
| [983](#L983) | <animate attributeName="opacity" from="1" to="0" dur="1s" begin="0.5s" |
| [984](#L984) | repeatCount="indefinite"></animate> |
| [985](#L985) | </rect> |
| [986](#L986) | <rect x="46.5" y="40" width="7" height="20" rx="5" ry="5" fill="#00b2ff" |
| [987](#L987) | transform="rotate(210 50 50) translate(0 -30)"> |
| [988](#L988) | <animate attributeName="opacity" from="1" to="0" dur="1s" |
| [989](#L989) | begin="0.5833333333333334s" repeatCount="indefinite"></animate> |
| [990](#L990) | </rect> |
| [991](#L991) | <rect x="46.5" y="40" width="7" height="20" rx="5" ry="5" fill="#00b2ff" |
| [992](#L992) | transform="rotate(240 50 50) translate(0 -30)"> |
| [993](#L993) | <animate attributeName="opacity" from="1" to="0" dur="1s" |
| [994](#L994) | begin="0.6666666666666666s" repeatCount="indefinite"></animate> |
| [995](#L995) | </rect> |
| [996](#L996) | <rect x="46.5" y="40" width="7" height="20" rx="5" ry="5" fill="#00b2ff" |
| [997](#L997) | transform="rotate(270 50 50) translate(0 -30)"> |
| [998](#L998) | <animate attributeName="opacity" from="1" to="0" dur="1s" begin="0.75s" |
| [999](#L999) | repeatCount="indefinite"></animate> |
| [1000](#L1000) | </rect> |
| [1001](#L1001) | <rect x="46.5" y="40" width="7" height="20" rx="5" ry="5" fill="#00b2ff" |
| [1002](#L1002) | transform="rotate(300 50 50) translate(0 -30)"> |
| [1003](#L1003) | <animate attributeName="opacity" from="1" to="0" dur="1s" |
| [1004](#L1004) | begin="0.8333333333333334s" repeatCount="indefinite"></animate> |
| [1005](#L1005) | </rect> |
| [1006](#L1006) | <rect x="46.5" y="40" width="7" height="20" rx="5" ry="5" fill="#00b2ff" |
| [1007](#L1007) | transform="rotate(330 50 50) translate(0 -30)"> |
| [1008](#L1008) | <animate attributeName="opacity" from="1" to="0" dur="1s" |
| [1009](#L1009) | begin="0.9166666666666666s" repeatCount="indefinite"></animate> |
| [1010](#L1010) | </rect> |
| [1011](#L1011) | </svg> |
| [1012](#L1012) | </div> |
| [1013](#L1013) | <button type="submit"  id="moo\_btn\_submit\_order" onclick="moo\_finalize\_order(event)" class="moo-btn moo-btn-primary moo-finalize-order-btn moo-checkoutText-finalizeOrder"> |
| [1014](#L1014) | <?php \_e("FINALIZE ORDER", "moo\_OnlineOrders"); ?> |
| [1015](#L1015) | </button> |
| [1016](#L1016) | </div> |
| [1017](#L1017) | </form> |
| [1018](#L1018) | </div> |
| [1019](#L1019) | <!--            Logout Button      --> |
| [1020](#L1020) | <div class="moologoutButton moo-col-md-12" <?php if (($session->isEmpty("moo\_customer\_token"))) { |
| [1021](#L1021) | echo 'style="display:none;"'; |
| [1022](#L1022) | }?> > |
| [1023](#L1023) | <a class="moologoutlabel" href="?logout=true"> |
| [1024](#L1024) | <?php \_e("Logout", "moo\_OnlineOrders"); ?> |
| [1025](#L1025) | </a> |
| [1026](#L1026) | </div> |
| [1027](#L1027) | </div> |
| [1028](#L1028) | </div> |
| [1029](#L1029) | <?php |
| [1030](#L1030) | if ($custom\_js != null) { |
| [1031](#L1031) | echo '<script type="text/javascript">'.$custom\_js.'</script>'; |
| [1032](#L1032) | } |
| [1033](#L1033) | if (!$session->isEmpty("moo\_customer\_token")) { |
| [1034](#L1034) | echo '<script type="text/javascript"> jQuery( document ).ready(function() { moo\_show\_chooseaddressform() });</script>'; |
| [1035](#L1035) | } |
| [1036](#L1036) |  |
| [1037](#L1037) | return ob\_get\_clean(); |
| [1038](#L1038) | } |
| [1039](#L1039) |  |
| [1040](#L1040) | public function advancedCheckout($atts, $content) |
| [1041](#L1041) | { |
| [1042](#L1042) |  |
| [1043](#L1043) | $this->enqueueStyles(true); |
| [1044](#L1044) | $this->enqueueScripts(true); |
| [1045](#L1045) |  |
| [1046](#L1046) | ob\_start(); |
| [1047](#L1047) |  |
| [1048](#L1048) | if (! $this->checkOpenning() ){ |
| [1049](#L1049) | return ob\_get\_clean(); |
| [1050](#L1050) | } |
| [1051](#L1051) |  |
| [1052](#L1052) | if (! $this->checkBlackout() ){ |
| [1053](#L1053) | return ob\_get\_clean(); |
| [1054](#L1054) | } |
| [1055](#L1055) |  |
| [1056](#L1056) | //Get Session |
| [1057](#L1057) | $session = MOO\_SESSION::instance(); |
| [1058](#L1058) | $counter  = 0; |
| [1059](#L1059) | $showServiceFee  = true; |
| [1060](#L1060) | $serviceFeeAmount  = 0; |
| [1061](#L1061) | $nbOfOrderTypes = 0; |
| [1062](#L1062) | $nbOfUnvailableOrderTypes = null; |
| [1063](#L1063) |  |
| [1064](#L1064) | //Get Settings And Cart Total |
| [1065](#L1065) | $businessSettings = $this->api->getBusinessSettings(); |
| [1066](#L1066) |  |
| [1067](#L1067) |  |
| [1068](#L1068) | //Get Totals |
| [1069](#L1069) | $totals = $session->getTotalsV2(0, 0); |
| [1070](#L1070) |  |
| [1071](#L1071) |  |
| [1072](#L1072) | $orderTypes = $this->model->getVisibleOrderTypes(true); |
| [1073](#L1073) | if (!is\_array($orderTypes)) { |
| [1074](#L1074) | $orderTypes = array(); |
| [1075](#L1075) | } |
| [1076](#L1076) | $nbOfOrderTypes = count($orderTypes); |
| [1077](#L1077) | //Check onDemandDelivery |
| [1078](#L1078) | if (isset($businessSettings['onDemandDeliveriesEnabled']) && $businessSettings['onDemandDeliveriesEnabled']) { |
| [1079](#L1079) | $onDemandDeliveryOrderType = [ |
| [1080](#L1080) | "ot\_uuid" => 'onDemandDelivery', |
| [1081](#L1081) | "label" => $businessSettings['onDemandDeliveriesLabel'], |
| [1082](#L1082) | "allow\_sc\_order" => true, |
| [1083](#L1083) | "allow\_service\_fee" => true, |
| [1084](#L1084) | "custom\_hours" => null, |
| [1085](#L1085) | "custom\_message" => null, |
| [1086](#L1086) | "minAmount" => null, |
| [1087](#L1087) | "maxAmount" => null, |
| [1088](#L1088) | "show\_sa" => true, |
| [1089](#L1089) | "sort\_order" => 99, |
| [1090](#L1090) | "status" => true, |
| [1091](#L1091) | "taxable" => true, |
| [1092](#L1092) | "time\_availability" => null, |
| [1093](#L1093) | "type" => null, |
| [1094](#L1094) | "use\_coupons" => true, |
| [1095](#L1095) | ]; |
| [1096](#L1096) | $orderTypes[] = apply\_filters('moo\_filter\_on\_demand\_delivery', $onDemandDeliveryOrderType); |
| [1097](#L1097) | } |
| [1098](#L1098) |  |
| [1099](#L1099) | foreach ($orderTypes as $oneOrderType) { |
| [1100](#L1100) | if (isset($oneOrderType["custom\_hours"]) && !empty($oneOrderType["custom\_hours"])) { |
| [1101](#L1101) | $counter++; |
| [1102](#L1102) | } |
| [1103](#L1103) | if (isset($oneOrderType["allow\_service\_fee"]) && intval($oneOrderType["allow\_service\_fee"]) !== 1) { |
| [1104](#L1104) | $showServiceFee =  false; |
| [1105](#L1105) | } |
| [1106](#L1106) | } |
| [1107](#L1107) |  |
| [1108](#L1108) | // Get ordertypes times |
| [1109](#L1109) | if ($counter > 0) { |
| [1110](#L1110) | $HoursResponse = $this->api->getMerchantCustomHoursStatus("ordertypes"); |
| [1111](#L1111) | if ($HoursResponse) { |
| [1112](#L1112) | $merchantCustomHoursStatus = $HoursResponse; |
| [1113](#L1113) | $merchantCustomHours = array\_keys($HoursResponse); |
| [1114](#L1114) | if (@count($merchantCustomHours) > 0 && $nbOfOrderTypes > 0) { |
| [1115](#L1115) | $nbOfUnvailableOrderTypes = 0; |
| [1116](#L1116) | for ($i=0; $i<$nbOfOrderTypes; $i++) { |
| [1117](#L1117) | $orderType  = $orderTypes[$i]; |
| [1118](#L1118) | $orderTypes[$i]['available'] = true; |
| [1119](#L1119) | if (isset($orderType['custom\_hours']) && !empty($orderType['custom\_hours'])) { |
| [1120](#L1120) | if (in\_array($orderType['custom\_hours'], $merchantCustomHours)) { |
| [1121](#L1121) | $isNotAvailable = $merchantCustomHoursStatus[$orderType['custom\_hours']] === "close"; |
| [1122](#L1122) | if ($isNotAvailable) { |
| [1123](#L1123) | $orderTypes[$i]['available'] = false; |
| [1124](#L1124) | $nbOfUnvailableOrderTypes++; |
| [1125](#L1125) | } |
| [1126](#L1126) | } |
| [1127](#L1127) | } |
| [1128](#L1128) | } |
| [1129](#L1129) | } |
| [1130](#L1130) | } |
| [1131](#L1131) | } |
| [1132](#L1132) |  |
| [1133](#L1133) | if($nbOfOrderTypes === $nbOfUnvailableOrderTypes ) { |
| [1134](#L1134) | echo '<div class="moo-alert moo-alert-danger" role="alert" id="moo\_checkout\_msg">This store cannot accept orders right now, please come back later</div>'; |
| [1135](#L1135) | return ob\_get\_clean(); |
| [1136](#L1136) | } |
| [1137](#L1137) |  |
| [1138](#L1138) | if (isset($this->pluginSettings["clover\_payment\_form"]) && $this->pluginSettings["clover\_payment\_form"] == "on") { |
| [1139](#L1139) | $cloverPakmsKey = $this->api->getPakmsKey(); |
| [1140](#L1140) | } else { |
| [1141](#L1141) | $cloverPakmsKey = null; |
| [1142](#L1142) | } |
| [1143](#L1143) |  |
| [1144](#L1144) | $custom\_js  = $this->pluginSettings["custom\_js"]; |
| [1145](#L1145) |  |
| [1146](#L1146) | //Calc Service Fess |
| [1147](#L1147) | if (isset($this->pluginSettings['service\_fees'])  && floatval($this->pluginSettings['service\_fees']) > 0) { |
| [1148](#L1148) | if (isset($this->pluginSettings['service\_fees\_type']) && $this->pluginSettings['service\_fees\_type'] === "percent") { |
| [1149](#L1149) | $serviceFees = floatval($this->pluginSettings['service\_fees']); |
| [1150](#L1150) | $serviceFeesType = "percent"; |
| [1151](#L1151) | $serviceFeeAmount =  intval(round($totals['sub\_total'] \* $serviceFees / 100)); |
| [1152](#L1152) |  |
| [1153](#L1153) | } else { |
| [1154](#L1154) | $serviceFees = intval(round(floatval($this->pluginSettings['service\_fees']) \* 100)); |
| [1155](#L1155) | $serviceFeesType = "amount"; |
| [1156](#L1156) | $serviceFeeAmount =  $serviceFees; |
| [1157](#L1157) | } |
| [1158](#L1158) | } else { |
| [1159](#L1159) | $serviceFees = 0; |
| [1160](#L1160) | $serviceFeesType = "amount"; |
| [1161](#L1161) | $showServiceFee = false; |
| [1162](#L1162) | } |
| [1163](#L1163) |  |
| [1164](#L1164) | // $merchant\_proprites = (json\_decode($this->api->getMerchantProprietes())) ; |
| [1165](#L1165) |  |
| [1166](#L1166) | //Coupons |
| [1167](#L1167) | if (!$session->isEmpty("coupon")) { |
| [1168](#L1168) | $coupon = $session->get("coupon"); |
| [1169](#L1169) | if ($coupon['minAmount']>$totals['sub\_total']) { |
| [1170](#L1170) | $coupon = null; |
| [1171](#L1171) | } |
| [1172](#L1172) | } else { |
| [1173](#L1173) | $coupon = null; |
| [1174](#L1174) | } |
| [1175](#L1175) |  |
| [1176](#L1176) | if ($this->pluginSettings["order\_later"] == "on") { |
| [1177](#L1177) | $inserted\_nb\_days = $this->pluginSettings["order\_later\_days"]; |
| [1178](#L1178) | $inserted\_nb\_mins = $this->pluginSettings["order\_later\_minutes"]; |
| [1179](#L1179) |  |
| [1180](#L1180) | $inserted\_nb\_days\_d = $this->pluginSettings["order\_later\_days\_delivery"]; |
| [1181](#L1181) | $inserted\_nb\_mins\_d = $this->pluginSettings["order\_later\_minutes\_delivery"]; |
| [1182](#L1182) |  |
| [1183](#L1183) | if ($inserted\_nb\_days === "") { |
| [1184](#L1184) | $nb\_days = 4; |
| [1185](#L1185) | } else { |
| [1186](#L1186) | $nb\_days = intval($inserted\_nb\_days); |
| [1187](#L1187) | } |
| [1188](#L1188) |  |
| [1189](#L1189) | if ($inserted\_nb\_mins === "") { |
| [1190](#L1190) | $nb\_minutes = 20; |
| [1191](#L1191) | } else { |
| [1192](#L1192) | $nb\_minutes = intval($inserted\_nb\_mins); |
| [1193](#L1193) | } |
| [1194](#L1194) |  |
| [1195](#L1195) | if ($inserted\_nb\_days\_d === "") { |
| [1196](#L1196) | $nb\_days\_d = 4; |
| [1197](#L1197) | } else { |
| [1198](#L1198) | $nb\_days\_d = intval($inserted\_nb\_days\_d); |
| [1199](#L1199) | } |
| [1200](#L1200) |  |
| [1201](#L1201) | if ($inserted\_nb\_mins\_d === "") { |
| [1202](#L1202) | $nb\_minutes\_d = 60; |
| [1203](#L1203) | } else { |
| [1204](#L1204) | $nb\_minutes\_d = intval($inserted\_nb\_mins\_d); |
| [1205](#L1205) | } |
| [1206](#L1206) | } else { |
| [1207](#L1207) | $nb\_days = 0; |
| [1208](#L1208) | $nb\_minutes = 0; |
| [1209](#L1209) | $nb\_days\_d = 0; |
| [1210](#L1210) | $nb\_minutes\_d = 0; |
| [1211](#L1211) | } |
| [1212](#L1212) |  |
| [1213](#L1213) |  |
| [1214](#L1214) | $oppening\_status = $this->api->getOpeningStatus($nb\_days, $nb\_minutes); |
| [1215](#L1215) |  |
| [1216](#L1216) |  |
| [1217](#L1217) |  |
| [1218](#L1218) | $this->showStreetAddressFieldOnPaymentForm = $this->checkCloverFraudTools($oppening\_status); |
| [1219](#L1219) |  |
| [1220](#L1220) |  |
| [1221](#L1221) | if ($nb\_days != $nb\_days\_d || $nb\_minutes != $nb\_minutes\_d) { |
| [1222](#L1222) | $oppening\_status\_d = $this->api->getOpeningStatus($nb\_days\_d, $nb\_minutes\_d); |
| [1223](#L1223) | } else { |
| [1224](#L1224) | $oppening\_status\_d = $oppening\_status; |
| [1225](#L1225) | } |
| [1226](#L1226) |  |
| [1227](#L1227) | $oppening\_msg = $this->getOpeningMessage($oppening\_status); |
| [1228](#L1228) |  |
| [1229](#L1229) | //Adding asap to pickup time |
| [1230](#L1230) | if (isset($oppening\_status["pickup\_time"])) { |
| [1231](#L1231) | if (isset($this->pluginSettings['order\_later\_asap\_for\_p']) && $this->pluginSettings['order\_later\_asap\_for\_p'] == 'on') { |
| [1232](#L1232) | if (isset($oppening\_status["pickup\_time"]["Today"])) { |
| [1233](#L1233) | array\_unshift($oppening\_status["pickup\_time"]["Today"], 'ASAP'); |
| [1234](#L1234) | } |
| [1235](#L1235) | } |
| [1236](#L1236) | } |
| [1237](#L1237) |  |
| [1238](#L1238) | if (isset($oppening\_status\_d["pickup\_time"])) { |
| [1239](#L1239) | if (isset($this->pluginSettings['order\_later\_asap\_for\_d']) && $this->pluginSettings['order\_later\_asap\_for\_d'] == 'on') { |
| [1240](#L1240) | if (isset($oppening\_status\_d["pickup\_time"]["Today"])) { |
| [1241](#L1241) | array\_unshift($oppening\_status\_d["pickup\_time"]["Today"], 'ASAP'); |
| [1242](#L1242) | } |
| [1243](#L1243) | } |
| [1244](#L1244) | } |
| [1245](#L1245) |  |
| [1246](#L1246) | if ($this->pluginSettings['hours'] != 'all' && $oppening\_msg != "") { |
| [1247](#L1247) | if ($this->pluginSettings['accept\_orders\_w\_closed'] != 'on' || (!empty($oppening\_status["status"] ) && $oppening\_status["status"] === 'not\_found')){ |
| [1248](#L1248) | echo '<div id="moo\_CheckoutContainer">'.$oppening\_msg.'</div>'; |
| [1249](#L1249) | return ob\_get\_clean(); |
| [1250](#L1250) | } |
| [1251](#L1251) | } |
| [1252](#L1252) |  |
| [1253](#L1253) |  |
| [1254](#L1254) | $merchant\_address =  $this->api->getMerchantAddress(); |
| [1255](#L1255) | $store\_page\_id     = $this->pluginSettings['store\_page']; |
| [1256](#L1256) | $cart\_page\_id     = $this->pluginSettings['cart\_page']; |
| [1257](#L1257) | $checkout\_page\_id     = $this->pluginSettings['checkout\_page']; |
| [1258](#L1258) |  |
| [1259](#L1259) | $store\_page\_url    =  get\_page\_link($store\_page\_id); |
| [1260](#L1260) | $cart\_page\_url    =  get\_page\_link($cart\_page\_id); |
| [1261](#L1261) | $checkout\_page\_url    =  get\_page\_link($checkout\_page\_id); |
| [1262](#L1262) |  |
| [1263](#L1263) | if (isset($this->pluginSettings['thanks\_page\_wp']) && !empty($this->pluginSettings['thanks\_page\_wp'])) { |
| [1264](#L1264) | $this->pluginSettings['thanks\_page'] = get\_page\_link($this->pluginSettings['thanks\_page\_wp']); |
| [1265](#L1265) | } |
| [1266](#L1266) |  |
| [1267](#L1267) | if (!isset($this->pluginSettings['save\_cards'])) { |
| [1268](#L1268) | $this->pluginSettings['save\_cards'] = null; |
| [1269](#L1269) | } |
| [1270](#L1270) | if (!isset($this->pluginSettings['save\_cards\_fees'])) { |
| [1271](#L1271) | $this->pluginSettings['save\_cards\_fees'] = null; |
| [1272](#L1272) | } |
| [1273](#L1273) | if (!isset($this->pluginSettings['delivery\_errorMsg']) || empty($this->pluginSettings['delivery\_errorMsg'])) { |
| [1274](#L1274) | $this->pluginSettings['delivery\_errorMsg'] = \_\_("Sorry, zone not supported. We do not deliver to this address at this time", "moo\_OnlineOrders"); |
| [1275](#L1275) | } |
| [1276](#L1276) | if (!isset($this->pluginSettings['special\_instructions\_required']) || empty($this->pluginSettings['special\_instructions\_required'])) { |
| [1277](#L1277) | $this->pluginSettings['special\_instructions\_required'] = false; |
| [1278](#L1278) | } |
| [1279](#L1279) | $jsOptions = array( |
| [1280](#L1280) | 'restApiUrl' =>  get\_rest\_url(), |
| [1281](#L1281) | "orderTypes"=>$orderTypes, |
| [1282](#L1282) | "totals"=>$totals, |
| [1283](#L1283) | "thanksPage"=>$this->pluginSettings['thanks\_page'], |
| [1284](#L1284) | "cashUponDelivery"=>$this->pluginSettings['payment\_cash\_delivery'] === 'on', |
| [1285](#L1285) | "cashInStore"=>$this->pluginSettings['payment\_cash'] === 'on', |
| [1286](#L1286) | "creditCard"=>$this->pluginSettings['clover\_payment\_form'] === 'on', |
| [1287](#L1287) | "giftCards"=>(!empty($this->pluginSettings['clover\_giftcards']) && $this->pluginSettings['clover\_giftcards'] === 'on'), |
| [1288](#L1288) | "googlePay"=>(!empty($this->pluginSettings['clover\_googlepay']) && $this->pluginSettings['clover\_googlepay'] === 'on'), |
| [1289](#L1289) | "applePay"=> $this->isApplePayEnabled(), |
| [1290](#L1290) | "merchantUuid"=> $this->getMerchantUuid(), |
| [1291](#L1291) | "pickupTimes"=>(!empty($oppening\_status["pickup\_time"])) ? $oppening\_status["pickup\_time"]:null, |
| [1292](#L1292) | "deliveryTimes"=>(!empty($oppening\_status\_d["pickup\_time"])) ? $oppening\_status\_d["pickup\_time"] : null, |
| [1293](#L1293) | "fbAppId"=>$this->pluginSettings['fb\_appid'], |
| [1294](#L1294) | "useSmsVerification"=>$this->pluginSettings['use\_sms\_verification'] === 'enabled', |
| [1295](#L1295) | "feeType"=>$serviceFeesType, |
| [1296](#L1296) | "feeAmount"=>$serviceFees, |
| [1297](#L1297) | "calculatedFeeAmount"=>$serviceFeeAmount, |
| [1298](#L1298) | "pakmsKey"=>$cloverPakmsKey, |
| [1299](#L1299) | "specialInstructionsRequired"=>$this->pluginSettings['special\_instructions\_required'] === 'yes', |
| [1300](#L1300) | "locale"=>str\_replace("\_", "-", get\_locale()), |
| [1301](#L1301) | "showStreetAddressField"=>$this->showStreetAddressFieldOnPaymentForm, |
| [1302](#L1302) | "allowScOrder"=>$this->pluginSettings['order\_later'] === 'on', |
| [1303](#L1303) | "orderingTimeRequired"=>$this->pluginSettings['order\_later\_mandatory'] === "on" && $this->pluginSettings['order\_later'] === 'on', |
| [1304](#L1304) | "loyaltySetting"=>(isset($businessSettings) && isset($businessSettings['loyaltySetting']) ) ? $businessSettings['loyaltySetting'] : null, |
| [1305](#L1305) | "isSandbox"=>defined('SOO\_ENV') && (SOO\_ENV === "DEV"), |
| [1306](#L1306) | "storeLink"=>$this->getOrderingPageLink(), |
| [1307](#L1307) | "reCAPTCHA\_site\_key"=>false, |
| [1308](#L1308) | ); |
| [1309](#L1309) | $deliveryJsOptions = array( |
| [1310](#L1310) | "moo\_merchantLat"=>$this->pluginSettings['lat'], |
| [1311](#L1311) | "moo\_merchantLng"=>$this->pluginSettings['lng'], |
| [1312](#L1312) | "moo\_merchantAddress"=>$merchant\_address, |
| [1313](#L1313) | "zones"=>$this->pluginSettings['zones\_json'], |
| [1314](#L1314) | "other\_zone\_fee"=>$this->pluginSettings['other\_zones\_delivery'], |
| [1315](#L1315) | "free\_amount"=>$this->pluginSettings['free\_delivery'], |
| [1316](#L1316) | "fixed\_amount"=>$this->pluginSettings['fixed\_delivery'], |
| [1317](#L1317) | "errorMsg"=>$this->pluginSettings['delivery\_errorMsg'] |
| [1318](#L1318) | ); |
| [1319](#L1319) |  |
| [1320](#L1320) | $googleReCAPTCHADisabled = (bool) get\_option('sooDisableGoogleReCAPTCHA',false); |
| [1321](#L1321) |  |
| [1322](#L1322) | //Add Google reCAPTCHA |
| [1323](#L1323) | if ( $googleReCAPTCHADisabled === false && !empty($this->pluginSettings['reCAPTCHA\_site\_key']) && !empty($this->pluginSettings['reCAPTCHA\_secret\_key'])){ |
| [1324](#L1324) | $jsOptions['reCAPTCHA\_site\_key'] = $this->pluginSettings['reCAPTCHA\_site\_key']; |
| [1325](#L1325) | } |
| [1326](#L1326) | //If Store is closed, make time required |
| [1327](#L1327) | if(!empty($oppening\_status["status"])){ |
| [1328](#L1328) | if ($oppening\_status["status"] === 'close'){ |
| [1329](#L1329) | $jsOptions['orderingTimeRequired'] = true; |
| [1330](#L1330) | } |
| [1331](#L1331) | } |
| [1332](#L1332) |  |
| [1333](#L1333) | $checkoutJsOptions  = [ |
| [1334](#L1334) | "options"=>$jsOptions, |
| [1335](#L1335) | "delivery"=>$deliveryJsOptions, |
| [1336](#L1336) | ]; |
| [1337](#L1337) |  |
| [1338](#L1338) | $authOptionsJsOptions  = [ |
| [1339](#L1339) | 'restApiUrl' =>  get\_rest\_url(), |
| [1340](#L1340) | "fbAppId"=>$this->pluginSettings['fb\_appid'] |
| [1341](#L1341) | ]; |
| [1342](#L1342) |  |
| [1343](#L1343) |  |
| [1344](#L1344) | wp\_localize\_script("sooCheckoutScript", "sooCheckout", $checkoutJsOptions); |
| [1345](#L1345) | wp\_localize\_script("sooAuthScript", "sooAuthOptions", $authOptionsJsOptions); |
| [1346](#L1346) |  |
| [1347](#L1347) |  |
| [1348](#L1348) | if ($totals === false || !isset($totals['nb\_items']) || $totals['nb\_items'] < 1) { |
| [1349](#L1349) | return $this->cartIsEmpty(); |
| [1350](#L1350) | }; |
| [1351](#L1351) |  |
| [1352](#L1352) | if ((isset($\_GET['logout']) && $\_GET['logout'])) { |
| [1353](#L1353) | $session->delete("moo\_customer\_token"); |
| [1354](#L1354) | wp\_redirect($checkout\_page\_url); |
| [1355](#L1355) | } |
| [1356](#L1356) |  |
| [1357](#L1357) | ?> |
| [1358](#L1358) |  |
| [1359](#L1359) | <div id="moo\_CheckoutContainer"> |
| [1360](#L1360) | <div class="moo-row" id="moo-checkout"> |
| [1361](#L1361) | <div class="errors-section"></div> |
| [1362](#L1362) | <?php echo $oppening\_msg; ?> |
| [1363](#L1363) | <div id="moo\_merchantmap"></div> |
| [1364](#L1364) | <!--   Accounts Function (login, signUp, reset password)   --> |
| [1365](#L1365) | <div id="sooAuthSection" data-soo-auth-page="checkout"> |
| [1366](#L1366) | <div class="sooAuthContainer"> |
| [1367](#L1367) | <!--   login   --> |
| [1368](#L1368) | <div id="moo-login-section" class="moo-col-md-12 moo-section" style="min-height: 300px;"> |
| [1369](#L1369) | <!--   Loading Section   --> |
| [1370](#L1370) | <div class="sooOverlayLoader" style="background-color: #fff;position: absolute;height: 100%;width: 100%;z-index: 10000000;"> |
| [1371](#L1371) | <div class="dot-flashing-2"></div> |
| [1372](#L1372) | </div> |
| [1373](#L1373) | <div class="moo-row login-top-section" tabindex="-1"> |
| [1374](#L1374) | <div class="login-header" style="padding-left: 15px;"> |
| [1375](#L1375) | <?php |
| [1376](#L1376) | printf("Why create a <a href='%s' target='\_blank'>Smart Online Order</a> account?", "https://www.smartonlineorder.com"); |
| [1377](#L1377) | ?> |
| [1378](#L1378) | </div> |
| [1379](#L1379) | <div class="moo-col-md-6"> |
| [1380](#L1380) | <ul> |
| [1381](#L1381) | <li><?php \_e("Save your address", "moo\_OnlineOrders"); ?></li> |
| [1382](#L1382) | <li><?php \_e("Faster Checkout!", "moo\_OnlineOrders"); ?></li> |
| [1383](#L1383) | </ul> |
| [1384](#L1384) | </div> |
| [1385](#L1385) | <div class="moo-col-md-6"> |
| [1386](#L1386) | <ul> |
| [1387](#L1387) | <li><?php \_e("View your past orders", "moo\_OnlineOrders"); ?></li> |
| [1388](#L1388) | <li><?php \_e("Get exclusive deals and coupons", "moo\_OnlineOrders"); ?></li> |
| [1389](#L1389) | </ul> |
| [1390](#L1390) | </div> |
| [1391](#L1391) | </div> |
| [1392](#L1392) | <div class="moo-col-md-6" tabindex="0"> |
| [1393](#L1393) | <div class="moo-row login-social-section"> |
| [1394](#L1394) | <?php if ( !empty($this->pluginSettings['fb\_appid']) && !empty($this->pluginSettings['fb\_appsecret']) ) { ?> |
| [1395](#L1395) | <p> |
| [1396](#L1396) | <?php \_e("Sign in with your Facebook account", "moo\_OnlineOrders"); ?> |
| [1397](#L1397) | <br /> |
| [1398](#L1398) | <small><?php \_e("No posts on your behalf, promise!", "moo\_OnlineOrders"); ?></small> |
| [1399](#L1399) | </p> |
| [1400](#L1400) | <div class="moo-row"> |
| [1401](#L1401) | <div class="moo-col-xs-12" > |
| [1402](#L1402) | <button class="sooFbLoginButton" onclick="sooAuth.loginViaFacebook()" tabindex="0" aria-label="Sign in with your Facebook account"> |
| [1403](#L1403) | <span class="fbIconSvg"> |
| [1404](#L1404) | <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0,0,256,256" width="20px" height="20px" fill-rule="nonzero"><g fill="#ffffff" fill-rule="nonzero" stroke="none" stroke-width="1" stroke-linecap="butt" stroke-linejoin="miter" stroke-miterlimit="10" stroke-dasharray="" stroke-dashoffset="0" font-family="none" font-weight="none" font-size="none" text-anchor="none" style="mix-blend-mode: normal"><g transform="scale(5.12,5.12)"><path d="M25,3c-12.15,0 -22,9.85 -22,22c0,11.03 8.125,20.137 18.712,21.728v-15.897h-5.443v-5.783h5.443v-3.848c0,-6.371 3.104,-9.168 8.399,-9.168c2.536,0 3.877,0.188 4.512,0.274v5.048h-3.612c-2.248,0 -3.033,2.131 -3.033,4.533v3.161h6.588l-0.894,5.783h-5.694v15.944c10.738,-1.457 19.022,-10.638 19.022,-21.775c0,-12.15 -9.85,-22 -22,-22z"></path></g></g></svg> |
| [1405](#L1405) | </span> |
| [1406](#L1406) | <span>Continue with Facebook</span> |
| [1407](#L1407) | </button> |
| [1408](#L1408) | </div> |
| [1409](#L1409) | <div class="moo-col-xs-12" tabindex="0"> |
| [1410](#L1410) | <div class="login-or"> |
| [1411](#L1411) | <hr class="hr-or"> |
| [1412](#L1412) | <span class="span-or"><?php \_e("or", "moo\_OnlineOrders"); ?></span> |
| [1413](#L1413) | </div> |
| [1414](#L1414) | <button class="sooCheckoutSecondaryButtonInput" onclick="mooCheckout.continueAsGuest(event)" tabindex="0"> |
| [1415](#L1415) | <?php \_e("Continue As Guest", "moo\_OnlineOrders"); ?> |
| [1416](#L1416) | </button> |
| [1417](#L1417) | </div> |
| [1418](#L1418) | </div> |
| [1419](#L1419) | <?php } else { ?> |
| [1420](#L1420) | <p> |
| [1421](#L1421) | <?php \_e("Don't want an account?", "moo\_OnlineOrders"); ?> |
| [1422](#L1422) | <br /> |
| [1423](#L1423) | <small><?php \_e("You can checkout without registering", "moo\_OnlineOrders"); ?></small> |
| [1424](#L1424) | </p> |
| [1425](#L1425) | <div class="moo-row" id="moo-login-left"> |
| [1426](#L1426) | <div class="moo-col-xs-12"> |
| [1427](#L1427) | <button  role="button" tabindex="0" href="#" class="sooContinueAsGuestButton" onclick="mooCheckout.continueAsGuest(event)" style="margin-top: 12px;"> |
| [1428](#L1428) | <?php \_e("Continue As Guest", "moo\_OnlineOrders"); ?> |
| [1429](#L1429) | </button> |
| [1430](#L1430) | </div> |
| [1431](#L1431) | <div class="moo-col-xs-12"> |
| [1432](#L1432) | <div class="login-or"> |
| [1433](#L1433) | <hr class="hr-or"> |
| [1434](#L1434) | <span class="span-or"><?php \_e("or", "moo\_OnlineOrders"); ?></span> |
| [1435](#L1435) | </div> |
| [1436](#L1436) | <button  class="sooCreateAnAccountButton" onclick="sooAuth.showOrHideASection('signing-section',true)"> |
| [1437](#L1437) | <?php \_e("Create An Account", "moo\_OnlineOrders"); ?> |
| [1438](#L1438) | </button> |
| [1439](#L1439) | </div> |
| [1440](#L1440) | </div> |
| [1441](#L1441) | <?php  } ?> |
| [1442](#L1442) | </div> |
| [1443](#L1443) | <div class="login-separator moo-hidden-xs moo-hidden-sm"> |
| [1444](#L1444) | <div class="separator"> |
| [1445](#L1445) | <span><?php \_e("or", "moo\_OnlineOrders"); ?></span> |
| [1446](#L1446) | </div> |
| [1447](#L1447) | </div> |
| [1448](#L1448) | </div> |
| [1449](#L1449) | <div class="moo-col-md-6" tabindex="0" > |
| [1450](#L1450) | <div class="sooLoginTitle moo-hidden-md moo-hidden-lg"> |
| [1451](#L1451) | <div>Log in</div> |
| [1452](#L1452) | </div> |
| [1453](#L1453) | <form id="moo-login-form" action="#" method="post" autocomplete="on" aria-label="Sign in with your account"> |
| [1454](#L1454) | <div class="moo-form-group"> |
| [1455](#L1455) | <label for="sooInputEmail"><?php \_e("Email", "moo\_OnlineOrders"); ?></label> |
| [1456](#L1456) | <input type="email" id="sooInputEmail" class="moo-form-control sooCheckoutTextInput" autocomplete="email" aria-label="your email" onkeyup="sooAuth.onInputChange(this)"> |
| [1457](#L1457) | <span class="moo-error-section"> |
| [1458](#L1458) | <?php \_e("Please enter your email", "moo\_OnlineOrders"); ?> |
| [1459](#L1459) | </span> |
| [1460](#L1460) | </div> |
| [1461](#L1461) | <div class="moo-form-group"> |
| [1462](#L1462) | <label for="sooInputPassword"><?php \_e("Password", "moo\_OnlineOrders"); ?></label> |
| [1463](#L1463) | <input type="password"  id="sooInputPassword" class="moo-form-control  sooCheckoutTextInput" autocomplete="current-password" aria-label="your password" onkeyup="sooAuth.onInputChange(this)"> |
| [1464](#L1464) | <span class="moo-error-section"> |
| [1465](#L1465) | <?php \_e("Please enter your password", "moo\_OnlineOrders"); ?> |
| [1466](#L1466) | </span> |
| [1467](#L1467) | <a class="pull-right sooForgetPasswordButton" href="#" onclick="sooAuth.showOrHideASection('forgotpassword-section',true)" aria-label="Click here if you forgotten your password"><?php \_e("Forgot password?", "moo\_OnlineOrders"); ?></a> |
| [1468](#L1468) | </div> |
| [1469](#L1469) | <div class="moo-form-group"> |
| [1470](#L1470) | <button class="sooLoginButton" type="submit" aria-label="<?php \_e("Log In", "moo\_OnlineOrders"); ?>"> |
| [1471](#L1471) | <?php \_e("Log In", "moo\_OnlineOrders"); ?> |
| [1472](#L1472) | </button> |
| [1473](#L1473) | </div> |
| [1474](#L1474) | <?php if ( !empty($this->pluginSettings['fb\_appid']) && !empty($this->pluginSettings['fb\_appsecret']) ) { ?> |
| [1475](#L1475) | <p style="padding: 10px"> <?php \_e("Don't have an account", "moo\_OnlineOrders"); ?><a class="sooSignUpLinkButton" href="#" onclick="sooAuth.showOrHideASection('signing-section',true)" aria-label="Don't have an account Sign-up"> <?php \_e("Sign-up", "moo\_OnlineOrders"); ?></a> </p> |
| [1476](#L1476) | <?php } ?> |
| [1477](#L1477) | </form> |
| [1478](#L1478) | </div> |
| [1479](#L1479) | </div> |
| [1480](#L1480) | <!--   Register   --> |
| [1481](#L1481) | <div id="moo-signing-section" class="moo-col-md-12 moo-section" style="display: none"> |
| [1482](#L1482) | <div class="moo-col-md-8 moo-col-md-offset-2 sooBorderedArea"> |
| [1483](#L1483) | <form id="moo-signup-form" action="#" method="post" aria-label="Create an account"> |
| [1484](#L1484) | <div class="moo-row"> |
| [1485](#L1485) | <div class="moo-col-md-6"> |
| [1486](#L1486) | <div class="moo-form-group"> |
| [1487](#L1487) | <label for="sooSignupInputFirstName"><?php \_e("First Name", "moo\_OnlineOrders"); ?></label> |
| [1488](#L1488) | <input type="text" class="moo-form-control sooCheckoutTextInput" id="sooSignupInputFirstName" autocomplete="firstName" onkeyup="sooAuth.onInputChange(this)"> |
| [1489](#L1489) | <span class="moo-error-section"> |
| [1490](#L1490) | <?php \_e("Please enter your first name", "moo\_OnlineOrders"); ?> |
| [1491](#L1491) | </span> |
| [1492](#L1492) | </div> |
| [1493](#L1493) | </div> |
| [1494](#L1494) | <div class="moo-col-md-6"> |
| [1495](#L1495) | <div class="moo-form-group"> |
| [1496](#L1496) | <label for="sooSignupInputLastName"><?php \_e("Last Name", "moo\_OnlineOrders"); ?></label> |
| [1497](#L1497) | <input type="text" class="moo-form-control sooCheckoutTextInput" id="sooSignupInputLastName" autocomplete="lastName" onkeyup="sooAuth.onInputChange(this)"> |
| [1498](#L1498) | <span class="moo-error-section"> |
| [1499](#L1499) | <?php \_e("Please enter your last name", "moo\_OnlineOrders"); ?> |
| [1500](#L1500) | </span> |
| [1501](#L1501) | </div> |
| [1502](#L1502) | </div> |
| [1503](#L1503) | </div> |
| [1504](#L1504) | <div class="moo-form-group"> |
| [1505](#L1505) | <label for="sooSignupInputPhone"><?php \_e("Phone number", "moo\_OnlineOrders"); ?></label> |
| [1506](#L1506) | <input type="text" class="moo-form-control sooCheckoutTextInput" id="sooSignupInputPhone" autocomplete="phone" onkeyup="sooAuth.onInputChange(this)"> |
| [1507](#L1507) | <span class="moo-error-section"> |
| [1508](#L1508) | <?php \_e("Please enter your phone", "moo\_OnlineOrders"); ?> |
| [1509](#L1509) | </span> |
| [1510](#L1510) | </div> |
| [1511](#L1511) |  |
| [1512](#L1512) | <div class="moo-form-group"> |
| [1513](#L1513) | <label for="sooSignupInputEmail"><?php \_e("Email", "moo\_OnlineOrders"); ?></label> |
| [1514](#L1514) | <input type="email" class="moo-form-control sooCheckoutTextInput" id="sooSignupInputEmail" autocomplete="email" onkeyup="sooAuth.onInputChange(this)"> |
| [1515](#L1515) | <span class="moo-error-section"> |
| [1516](#L1516) | <?php \_e("Please enter your email", "moo\_OnlineOrders"); ?> |
| [1517](#L1517) | </span> |
| [1518](#L1518) | </div> |
| [1519](#L1519) | <div class="moo-form-group"> |
| [1520](#L1520) | <label for="sooSignupInputPassword"><?php \_e("Password", "moo\_OnlineOrders"); ?></label> |
| [1521](#L1521) | <input type="password" class="moo-form-control sooCheckoutTextInput" id="sooSignupInputPassword" autocomplete="new-password" onkeyup="sooAuth.onInputChange(this)"> |
| [1522](#L1522) | <span class="moo-error-section"><?php \_e("Please choose a password", "moo\_OnlineOrders"); ?></span> |
| [1523](#L1523) | </div> |
| [1524](#L1524) | <div class="moo-form-group"> |
| [1525](#L1525) | <label for="sooSignupInputConfirmPassword"><?php \_e("Password Confirmation", "moo\_OnlineOrders"); ?></label> |
| [1526](#L1526) | <input type="password" class="moo-form-control sooCheckoutTextInput" id="sooSignupInputConfirmPassword" autocomplete="new-password" onkeyup="sooAuth.onInputChange(this)"> |
| [1527](#L1527) | <span class="moo-error-section"> |
| [1528](#L1528) | <?php \_e("Please confirm your password", "moo\_OnlineOrders"); ?> |
| [1529](#L1529) | </span> |
| [1530](#L1530) | </div> |
| [1531](#L1531) |  |
| [1532](#L1532) | <button class="sooCheckoutPrimaryButtonInput sooSignupButton" type="submit" aria-label="<?php \_e("Submit", "moo\_OnlineOrders"); ?>"> |
| [1533](#L1533) | <?php \_e("Submit", "moo\_OnlineOrders"); ?> |
| [1534](#L1534) | </button> |
| [1535](#L1535) | <br /> |
| [1536](#L1536) | <p style="padding-top: 10px;"> |
| [1537](#L1537) | <?php |
| [1538](#L1538) | /\* translators: %s represent our tos link \*/ |
| [1539](#L1539) | printf(\_\_('By creating an account and placing orders, you indicate your agreement to our <a class="sooTosLinkButton" href="%s" target="\_blank">Terms Of Service</a>', 'moo\_OnlineOrders'), "https://www.zaytech.com/zaytech-eula"); |
| [1540](#L1540) | ?> |
| [1541](#L1541) | </p> |
| [1542](#L1542) | <p><?php \_e("Have an account already?", "moo\_OnlineOrders"); ?><a class="sooLoginLinkButton" href="#" onclick="sooAuth.showOrHideASection('login-section',true)">  <?php \_e("Click here", "moo\_OnlineOrders"); ?></a> </p> |
| [1543](#L1543) | </form> |
| [1544](#L1544) | </div> |
| [1545](#L1545) |  |
| [1546](#L1546) | </div> |
| [1547](#L1547) | <!--   Reset Password   --> |
| [1548](#L1548) | <div  id="moo-forgotpassword-section" class="moo-col-md-12 moo-section" style="display: none"> |
| [1549](#L1549) | <div class="moo-col-md-8 moo-col-md-offset-2 sooBorderedArea"> |
| [1550](#L1550) | <form  id="moo-resetPassword-form" action="#" method="post" aria-label="reset your password"> |
| [1551](#L1551) | <div class="moo-form-group moo-min-height-80"> |
| [1552](#L1552) | <label for="sooInputEmail4Reset"><?php \_e("Email", "moo\_OnlineOrders"); ?></label> |
| [1553](#L1553) | <input type="text" class="moo-form-control sooCheckoutTextInput" id="sooInputEmail4Reset" onkeyup="sooAuth.onInputChange(this)"> |
| [1554](#L1554) | <span class="moo-error-section"> |
| [1555](#L1555) | <?php \_e("Please enter your email", "moo\_OnlineOrders"); ?> |
| [1556](#L1556) | </span> |
| [1557](#L1557) | </div> |
| [1558](#L1558) |  |
| [1559](#L1559) | <button name="submit" class="sooResetPasswordButton sooCheckoutPrimaryButtonInput" type="submit" aria-label="<?php \_e("Reset", "moo\_OnlineOrders"); ?>"> |
| [1560](#L1560) | <?php \_e("Reset", "moo\_OnlineOrders"); ?> |
| [1561](#L1561) | </button> |
| [1562](#L1562) |  |
| [1563](#L1563) | <button name="cancel" class="sooCheckoutSecondaryButtonInput" onclick="sooAuth.cancelResetPassword(event)"> |
| [1564](#L1564) | <?php \_e("Cancel", "moo\_OnlineOrders"); ?> |
| [1565](#L1565) | </button> |
| [1566](#L1566) | </form> |
| [1567](#L1567) | </div> |
| [1568](#L1568) | </div> |
| [1569](#L1569) | </div> |
| [1570](#L1570) | </div> |
| [1571](#L1571) | <!--   Checkout form   --> |
| [1572](#L1572) | <div id="moo-checkout-form" class="moo-col-md-12 moo-section" style="display: none"> |
| [1573](#L1573) | <div class="moo-row"> |
| [1574](#L1574) | <!--            Checkout form - information section       --> |
| [1575](#L1575) | <div class="moo-col-sm-7 moo-checkout-form-leftside" tabindex="0" aria-label="the checkout form"> |
| [1576](#L1576) | <div id="moo-checkout-form-customer" tabindex="0" aria-label="your information"> |
| [1577](#L1577) | <div class="moo-checkout-bloc-title moo-checkoutText-contact"> |
| [1578](#L1578) | <?php \_e("Contact", "moo\_OnlineOrders"); ?> |
| [1579](#L1579) | </div> |
| [1580](#L1580) | <div class="moo-checkout-bloc-content"> |
| [1581](#L1581) | <div id="moo-checkout-contact-content"> |
| [1582](#L1582) | <div class="moo-row soo-contact-info"> |
| [1583](#L1583) | <div class="moo-col-xs-9"> |
| [1584](#L1584) | <div class="soo-contact-info-name"></div> |
| [1585](#L1585) | <div class="soo-contact-info-email"></div> |
| [1586](#L1586) | <div class="soo-contact-info-phone"></div> |
| [1587](#L1587) | <div class="soo-contact-edit" onclick="mooCheckout.editCustomerInfo(this)"> |
| [1588](#L1588) | Edit |
| [1589](#L1589) | </div> |
| [1590](#L1590) | </div> |
| [1591](#L1591) | <div class="moo-col-xs-3 soo-contact-logout" onclick="mooCheckout.logout(event)"> |
| [1592](#L1592) | Logout |
| [1593](#L1593) | </div> |
| [1594](#L1594) | </div> |
| [1595](#L1595) | </div> |
| [1596](#L1596) | <div id="moo-checkout-contact-form"> |
| [1597](#L1597) | <div class="moo-row"> |
| [1598](#L1598) | <div class="moo-col-md-12 soo-contact-loginButtonContainer"> |
| [1599](#L1599) | <span class="soo-contact-login" onclick="mooCheckout.showLoginSection()">Login</span> |
| [1600](#L1600) | </div> |
| [1601](#L1601) | </div> |
| [1602](#L1602) | <div class="moo-row"> |
| [1603](#L1603) | <div class="moo-form-group moo-col-md-6"> |
| [1604](#L1604) | <label for="MooContactFirstName" class="moo-checkoutText-fullName"> |
| [1605](#L1605) | <?php \_e("First Name", "moo\_OnlineOrders"); ?>:\* |
| [1606](#L1606) | </label> |
| [1607](#L1607) | <input type="text" class="moo-form-control sooCheckoutTextInput" name="name" id="MooContactFirstName" autocomplete="first\_name" onkeyup="mooCheckout.onInputChange(this)"> |
| [1608](#L1608) | <span class="moo-error-section"> |
| [1609](#L1609) | <?php \_e("Please enter your first name", "moo\_OnlineOrders"); ?> |
| [1610](#L1610) | </span> |
| [1611](#L1611) | </div> |
| [1612](#L1612) | <div class="moo-form-group moo-col-md-6"> |
| [1613](#L1613) | <label for="MooContactLastName" class="moo-checkoutText-fullName"> |
| [1614](#L1614) | <?php \_e("Last Name", "moo\_OnlineOrders"); ?>:\* |
| [1615](#L1615) | </label> |
| [1616](#L1616) | <input type="text" class="moo-form-control sooCheckoutTextInput" name="name" id="MooContactLastName" autocomplete="last\_name" onkeyup="mooCheckout.onInputChange(this)"> |
| [1617](#L1617) | <span class="moo-error-section"> |
| [1618](#L1618) | <?php \_e("Please enter your last name", "moo\_OnlineOrders"); ?> |
| [1619](#L1619) | </span> |
| [1620](#L1620) | </div> |
| [1621](#L1621) | </div> |
| [1622](#L1622) | <div class="moo-row"> |
| [1623](#L1623) | <div class="moo-form-group moo-col-md-12"> |
| [1624](#L1624) | <label for="MooContactEmail" class="moo-checkoutText-email"><?php \_e("Email", "moo\_OnlineOrders"); ?>:\*</label> |
| [1625](#L1625) | <input type="email" class="moo-form-control sooCheckoutTextInput" id="MooContactEmail" autocomplete="email" onkeyup="mooCheckout.onInputChange(this)"> |
| [1626](#L1626) | <span class="moo-error-section"> |
| [1627](#L1627) | <?php \_e("Please enter your Email", "moo\_OnlineOrders"); ?> |
| [1628](#L1628) | </span> |
| [1629](#L1629) | </div> |
| [1630](#L1630) | </div> |
| [1631](#L1631) | <div class="moo-row"> |
| [1632](#L1632) | <div class="moo-form-group moo-col-md-12"> |
| [1633](#L1633) | <label for="MooContactPhone" class="moo-checkoutText-phoneNumber"><?php \_e("Phone number", "moo\_OnlineOrders"); ?>:\*</label> |
| [1634](#L1634) | <input type="text" class="moo-form-control sooCheckoutTextInput" name="phone" id="MooContactPhone" onkeyup="mooCheckout.onInputChange(this)" autocomplete="phone"> |
| [1635](#L1635) | <span class="moo-error-section"> |
| [1636](#L1636) | <?php \_e("Please enter your phone", "moo\_OnlineOrders"); ?> |
| [1637](#L1637) | </span> |
| [1638](#L1638) | </div> |
| [1639](#L1639) | </div> |
| [1640](#L1640) | <?php wp\_nonce\_field('moo-checkout-form');?> |
| [1641](#L1641) | </div> |
| [1642](#L1642) | </div> |
| [1643](#L1643) | </div> |
| [1644](#L1644) | <?php if (count($orderTypes)>0) {?> |
| [1645](#L1645) | <div id="moo-checkout-form-ordertypes" tabindex="0" aria-label="the ordering method"> |
| [1646](#L1646) | <div class="moo\_checkout\_border\_bottom"></div> |
| [1647](#L1647) | <div class="moo-checkout-bloc-title moo-checkoutText-orderingMethod"> |
| [1648](#L1648) | <?php \_e("Ordering Method", "moo\_OnlineOrders"); ?>s |
| [1649](#L1649) | </div> |
| [1650](#L1650) | <div class="moo-checkout-bloc-content"> |
| [1651](#L1651) | <?php |
| [1652](#L1652) | foreach ($orderTypes as $ot) { |
| [1653](#L1653) | echo '<div class="soo-checkout-radio-input-option">'; |
| [1654](#L1654) | if (isset($ot['available']) && $ot['available'] === false) { |
| [1655](#L1655) | echo '<input class="soo-checkout-radio-input" type="radio" name="ordertype" value="'.esc\_attr($ot['ot\_uuid']).'" id="moo-checkout-form-ordertypes-'.esc\_attr($ot['ot\_uuid']).'" disabled>'; |
| [1656](#L1656) | echo '<label for="moo-checkout-form-ordertypes-'.esc\_attr($ot['ot\_uuid']).'" class="moo-checkout-radio-input-label">'.wp\_kses\_post(wp\_unslash($ot['label'])).' ( '.wp\_kses\_post(wp\_unslash($ot['custom\_message'])).' )</label></div>'; |
| [1657](#L1657) | } else { |
| [1658](#L1658) | echo '<input onchange="mooCheckout.orderTypeChanged()" class="soo-checkout-radio-input" type="radio" name="ordertype" value="'.esc\_attr($ot['ot\_uuid']).'" id="moo-checkout-form-ordertypes-'.esc\_attr($ot['ot\_uuid']).'">'; |
| [1659](#L1659) | echo '<label for="moo-checkout-form-ordertypes-'.esc\_attr($ot['ot\_uuid']).'" class="moo-checkout-radio-input-label">'.wp\_kses\_post(wp\_unslash($ot['label'])).'</label></div>'; |
| [1660](#L1660) | } |
| [1661](#L1661) | } |
| [1662](#L1662) | ?> |
| [1663](#L1663) | <div class="soo-address-section"> |
| [1664](#L1664) | <div class="soo-add-delivery-address-form"> |
| [1665](#L1665) | <div class="soo-add-address-wrapper"> |
| [1666](#L1666) | <form id="soo-add-address-form" action="#" method="post" onsubmit="mooCheckout.addNewAddress(event)"> |
| [1667](#L1667) | <div class="moo-row"> |
| [1668](#L1668) | <div class="moo-form-group moo-col-md-12 soo-margin-bottom-10"> |
| [1669](#L1669) | <label for="sooAddAddressName"><?php \_e("Full Name", "moo\_OnlineOrders"); ?></label> |
| [1670](#L1670) | <input type="text" class="sooCheckoutTextInput" id="sooAddAddressName" onkeyup="mooCheckout.onInputChange(this)"> |
| [1671](#L1671) | <span class="moo-error-section"> |
| [1672](#L1672) | <?php \_e("Please enter the name of who will receive the order", "moo\_OnlineOrders"); ?> |
| [1673](#L1673) | </span> |
| [1674](#L1674) | </div> |
| [1675](#L1675) | </div> |
| [1676](#L1676) | <div class="moo-row"> |
| [1677](#L1677) | <div class="moo-form-group moo-col-md-12 soo-margin-bottom-10"> |
| [1678](#L1678) | <label for="sooAddAddressLine1"><?php \_e("Address", "moo\_OnlineOrders"); ?></label> |
| [1679](#L1679) | <input type="text" class="sooCheckoutTextInput" id="sooAddAddressLine1" onkeyup="mooCheckout.onInputChange(this)"> |
| [1680](#L1680) | <span class="moo-error-section"> |
| [1681](#L1681) | <?php \_e("Please enter your address", "moo\_OnlineOrders"); ?> |
| [1682](#L1682) | </span> |
| [1683](#L1683) | </div> |
| [1684](#L1684) | </div> |
| [1685](#L1685) | <div class="moo-row"> |
| [1686](#L1686) | <div class="moo-form-group moo-col-md-12 soo-margin-bottom-10"> |
| [1687](#L1687) | <label for="sooAddAddressLine2"><?php \_e("Suite / Apt #", "moo\_OnlineOrders"); ?></label> |
| [1688](#L1688) | <input type="text" class="sooCheckoutTextInput" id="sooAddAddressLine2" onkeyup="mooCheckout.onInputChange(this)"> |
| [1689](#L1689) | <span class="moo-error-section"> |
| [1690](#L1690) | <?php \_e("Please enter your Suite or Apt Number", "moo\_OnlineOrders"); ?> |
| [1691](#L1691) | </span> |
| [1692](#L1692) | </div> |
| [1693](#L1693) | </div> |
| [1694](#L1694) | <div class="moo-row"> |
| [1695](#L1695) | <div class="moo-form-group moo-col-md-12 soo-margin-bottom-10"> |
| [1696](#L1696) | <label for="sooAddAddressCity"><?php \_e("City", "moo\_OnlineOrders"); ?></label> |
| [1697](#L1697) | <input type="text" class="sooCheckoutTextInput" id="sooAddAddressCity" onkeyup="mooCheckout.onInputChange(this)"> |
| [1698](#L1698) | <span class="moo-error-section"> |
| [1699](#L1699) | <?php \_e("Please enter your City", "moo\_OnlineOrders"); ?> |
| [1700](#L1700) | </span> |
| [1701](#L1701) | </div> |
| [1702](#L1702) | </div> |
| [1703](#L1703) | <div class="moo-row"> |
| [1704](#L1704) | <div class="moo-form-group moo-col-md-6"> |
| [1705](#L1705) | <label for="sooAddAddressState"><?php \_e("State", "moo\_OnlineOrders"); ?></label> |
| [1706](#L1706) | <input type="text" class="sooCheckoutTextInput" id="sooAddAddressState" onkeyup="mooCheckout.onInputChange(this)"> |
| [1707](#L1707) | <span class="moo-error-section"> |
| [1708](#L1708) | <?php \_e("Please enter your State", "moo\_OnlineOrders"); ?> |
| [1709](#L1709) | </span> |
| [1710](#L1710) | </div> |
| [1711](#L1711) | <div class="moo-form-group moo-col-md-6"> |
| [1712](#L1712) | <label for="sooAddAddressZipCode"><?php \_e("Zip Code", "moo\_OnlineOrders"); ?></label> |
| [1713](#L1713) | <input type="text" class="sooCheckoutTextInput" id="sooAddAddressZipCode" onkeyup="mooCheckout.onInputChange(this)"> |
| [1714](#L1714) | <span class="moo-error-section"> |
| [1715](#L1715) | <?php \_e("Please enter your Zip Code", "moo\_OnlineOrders"); ?> |
| [1716](#L1716) | </span> |
| [1717](#L1717) | </div> |
| [1718](#L1718) | </div> |
| [1719](#L1719) | <div class="moo-row"> |
| [1720](#L1720) | <div class="moo-col-md-12 soo-text-right"> |
| [1721](#L1721) | <button class="sooCheckoutPrimaryButtonInput" type="submit" aria-label="<?php \_e("Add", "moo\_OnlineOrders"); ?>"> |
| [1722](#L1722) | <?php \_e("Add", "moo\_OnlineOrders"); ?> |
| [1723](#L1723) | </button> |
| [1724](#L1724) | <button  type="reset" class="sooCheckoutSecondaryButtonInput" onclick="mooCheckout.showListOfAddresses()"> |
| [1725](#L1725) | <?php \_e("Cancel", "moo\_OnlineOrders"); ?> |
| [1726](#L1726) | </button> |
| [1727](#L1727) | </div> |
| [1728](#L1728) |  |
| [1729](#L1729) | </div> |
| [1730](#L1730) | </form> |
| [1731](#L1731) | </div> |
| [1732](#L1732) | </div> |
| [1733](#L1733) | <div class="soo-list-of-addresses"> |
| [1734](#L1734) | List Of Addresses |
| [1735](#L1735) | </div> |
| [1736](#L1736) | </div> |
| [1737](#L1737) | </div> |
| [1738](#L1738) | <div class="moo-checkout-bloc-message" id="moo-checkout-form-ordertypes-message"></div> |
| [1739](#L1739) | </div> |
| [1740](#L1740) | <?php |
| [1741](#L1741) | } |
| [1742](#L1742) | //Ordering Time Section |
| [1743](#L1743) | if (isset($this->pluginSettings['order\_later']) && $this->pluginSettings['order\_later'] === 'on') { |
| [1744](#L1744) | $this->orderingTimesSection($oppening\_status); |
| [1745](#L1745) | } |
| [1746](#L1746) | //Payment Methods Section |
| [1747](#L1747) | $this->paymentMethodsSection($cloverPakmsKey); |
| [1748](#L1748) |  |
| [1749](#L1749) | //Loyalty Section |
| [1750](#L1750) | if (isset($businessSettings['loyaltySetting'])) { |
| [1751](#L1751) | $this->loyaltySection($businessSettings['loyaltySetting']['label']); |
| [1752](#L1752) | } |
| [1753](#L1753) | //Tips Section |
| [1754](#L1754) | if ($this->pluginSettings['tips'] == 'enabled') { |
| [1755](#L1755) | $this->tipsSection(); |
| [1756](#L1756) | } |
| [1757](#L1757) | //Special Instructions |
| [1758](#L1758) | if ($this->pluginSettings['use\_special\_instructions'] === "enabled") { |
| [1759](#L1759) | $this->specialInstructionsSection(); |
| [1760](#L1760) | } |
| [1761](#L1761) | //Coupons |
| [1762](#L1762) | if ($this->pluginSettings['use\_coupons']  === "enabled") { |
| [1763](#L1763) | $this->couponsSection(); |
| [1764](#L1764) | } |
| [1765](#L1765) |  |
| [1766](#L1766) | ?> |
| [1767](#L1767) | </div> |
| [1768](#L1768) | <!--            Checkout form - Cart section       --> |
| [1769](#L1769) | <div class="moo-col-sm-5 moo-checkout-cart soo-sticky-cart"> |
| [1770](#L1770) | <div class="cartContainer"> |
| [1771](#L1771) | <div class="moo-shopping-cart sooCartInCheckout" tabindex="0" aria-label="the cart"> |
| [1772](#L1772) | <div class="moo-shopping-cart-title"> |
| [1773](#L1773) | <?php \_e("Order Summary", "moo\_OnlineOrders"); ?> |
| [1774](#L1774) | </div> |
| [1775](#L1775) | <?php foreach ($session->get("items") as $key => $line) { |
| [1776](#L1776) | $modifiers\_price = 0; |
| [1777](#L1777) | if (isset($line['item']->soo\_name) && !empty($line['item']->soo\_name)) { |
| [1778](#L1778) | $item\_name=stripslashes((string)$line['item']->soo\_name); |
| [1779](#L1779) | } else { |
| [1780](#L1780) | if ($this->useAlternateNames && isset($line['item']->alternate\_name) && $line['item']->alternate\_name!=="") { |
| [1781](#L1781) | $item\_name=stripslashes((string)$line['item']->alternate\_name); |
| [1782](#L1782) | } else { |
| [1783](#L1783) | $item\_name=stripslashes((string)$line['item']->name); |
| [1784](#L1784) | } |
| [1785](#L1785) | } |
| [1786](#L1786) |  |
| [1787](#L1787) | ?> |
| [1788](#L1788) | <div class="moo-row moo-shopping-cart-line" tabindex="0" aria-label="<?php echo $line['quantity']." of ".$line['item']->name; ?>"> |
| [1789](#L1789) | <div class="moo-scl-qty moo-col-xs-2"> |
| [1790](#L1790) | <?php echo $line['quantity']?> |
| [1791](#L1791) | </div> |
| [1792](#L1792) | <div class="moo-scl-item moo-col-xs-7"> |
| [1793](#L1793) | <div class="moo-scl-itemName"><?php echo $item\_name; ?></div> |
| [1794](#L1794) | <p class="moo-scl-itemModifiers"> |
| [1795](#L1795) | <?php |
| [1796](#L1796) | foreach ($line['modifiers'] as $modifier) { |
| [1797](#L1797) | $modifier\_name = ""; |
| [1798](#L1798) | if ($this->useAlternateNames && isset($modifier["alternate\_name"]) && $modifier["alternate\_name"]!=="") { |
| [1799](#L1799) | $modifier\_name =stripslashes((string)$modifier["alternate\_name"]); |
| [1800](#L1800) | } else { |
| [1801](#L1801) | $modifier\_name =stripslashes((string)$modifier["name"]); |
| [1802](#L1802) | } |
| [1803](#L1803) | if (isset($modifier['qty']) && intval($modifier['qty'])>0) { |
| [1804](#L1804) | echo '<small tabindex="0">'.$modifier['qty'].'<small>x</small> '; |
| [1805](#L1805) | $modifiers\_price += $modifier['price']\*$modifier['qty']; |
| [1806](#L1806) | } else { |
| [1807](#L1807) | echo '<small tabindex="0">1x '; |
| [1808](#L1808) | $modifiers\_price += $modifier['price']; |
| [1809](#L1809) | } |
| [1810](#L1810) |  |
| [1811](#L1811) | if ($modifier['price']>0) { |
| [1812](#L1812) | echo ''.$modifier\_name.'- $'.number\_format(($modifier['price']/100), 2)."</small><br/>"; |
| [1813](#L1813) | } else { |
| [1814](#L1814) | echo ''.$modifier\_name."</small><br/>"; |
| [1815](#L1815) | } |
| [1816](#L1816) | } |
| [1817](#L1817) | if ($line['special\_ins'] != "") { |
| [1818](#L1818) | echo '<span tabindex="0" aria-label="your special instructions">SI:<span><span tabindex="0"> '.$line['special\_ins']."<span>"; |
| [1819](#L1819) | } |
| [1820](#L1820) | ?> |
| [1821](#L1821) | </p> |
| [1822](#L1822) | </div> |
| [1823](#L1823) | <?php $line\_price = $line['item']->price+$modifiers\_price; ?> |
| [1824](#L1824) | <div class="moo-scl-itemPrice moo-col-xs-3" tabindex="0"><strong>$<?php echo number\_format(($line\_price\*$line['quantity']/100), 2)?></strong></div> |
| [1825](#L1825) | </div> |
| [1826](#L1826) | <?php } ?> |
| [1827](#L1827) | <div class="moo-totals" style="padding-right: 10px;"> |
| [1828](#L1828) | <div class="moo-totals-item"> |
| [1829](#L1829) | <label class="moo-checkoutText-subtotal"  tabindex="0"><?php \_e("Subtotal", "moo\_OnlineOrders"); ?></label> |
| [1830](#L1830) | <div class="moo-totals-value" id="moo-cart-subtotal"  tabindex="0"> |
| [1831](#L1831) | <?php echo '$'.number\_format(($totals['sub\_total']/100), 2)?> |
| [1832](#L1832) | </div> |
| [1833](#L1833) | </div> |
| [1834](#L1834) | <div class="moo-totals-item" id="sooCouponTotalSection" style="color: green;"> |
| [1835](#L1835) | <label id="sooCouponName" tabindex="0" for="sooCouponValue"></label> |
| [1836](#L1836) | <div id="sooCouponValue" class="moo-totals-value"  tabindex="0"></div> |
| [1837](#L1837) | </div> |
| [1838](#L1838) | <div class="moo-totals-item" id="sooPointsTotalSection" style="color: green;"> |
| [1839](#L1839) | <label id="sooPointslabel" tabindex="0" for="sooPointsValue"></label> |
| [1840](#L1840) | <div id="sooPointsValue" class="moo-totals-value" tabindex="0"></div> |
| [1841](#L1841) | </div> |
| [1842](#L1842) | <div class="moo-totals-item"> |
| [1843](#L1843) | <label class="moo-checkoutText-tax"  tabindex="0" ><?php \_e("Tax", "moo\_OnlineOrders"); ?></label> |
| [1844](#L1844) | <div class="moo-totals-value" id="moo-cart-tax"  tabindex="0"> |
| [1845](#L1845) | <?php |
| [1846](#L1846) | echo  '$'.number\_format($totals['taxes']/100, 2); |
| [1847](#L1847) | ?> |
| [1848](#L1848) | </div> |
| [1849](#L1849) | </div> |
| [1850](#L1850) | <div class="moo-totals-item" id="sooServiceFeeTotalSection" |
| [1851](#L1851) | style="<?php echo ($showServiceFee) ? 'display:block;' : '' ; ?>"> |
| [1852](#L1852) | <label id="MooServiceChargesName" tabindex="0"> |
| [1853](#L1853) | <?php |
| [1854](#L1854) | if (isset($this->pluginSettings['service\_fees\_name']) && !empty($this->pluginSettings['service\_fees\_name'])) { |
| [1855](#L1855) | echo $this->pluginSettings['service\_fees\_name']; |
| [1856](#L1856) | } else { |
| [1857](#L1857) | echo "Service Fees"; |
| [1858](#L1858) | } |
| [1859](#L1859) | ?> |
| [1860](#L1860) | </label> |
| [1861](#L1861) | <div class="moo-totals-value" id="moo-cart-service-fee"  tabindex="0"> |
| [1862](#L1862) | <?php |
| [1863](#L1863) | echo '$'. number\_format($serviceFeeAmount/100,2); |
| [1864](#L1864) | ?> |
| [1865](#L1865) | </div> |
| [1866](#L1866) | </div> |
| [1867](#L1867) |  |
| [1868](#L1868) | <div class="moo-totals-item" id="sooDeliveryFeeTotalSection"> |
| [1869](#L1869) | <label class="moo-checkoutText-deliveryFees"  tabindex="0"> |
| [1870](#L1870) | <?php echo ($this->pluginSettings["delivery\_fees\_name"] === "")?"Delivery Charge":$this->pluginSettings["delivery\_fees\_name"];?> |
| [1871](#L1871) | </label> |
| [1872](#L1872) | <div class="moo-totals-value" id="moo-cart-delivery-fee"  tabindex="0"></div> |
| [1873](#L1873) | </div> |
| [1874](#L1874) |  |
| [1875](#L1875) | <?php if ($this->pluginSettings['tips'] === 'enabled') {?> |
| [1876](#L1876) | <div class="moo-totals-item" id="sooTipsTotalSection"> |
| [1877](#L1877) | <label class="moo-checkoutText-tipAmount" tabindex="0" ><?php \_e("Tip", "moo\_OnlineOrders"); ?></label> |
| [1878](#L1878) | <div class="moo-totals-value" id="moo-cart-tip" tabindex="0"> |
| [1879](#L1879) | $0.00 |
| [1880](#L1880) | </div> |
| [1881](#L1881) | </div> |
| [1882](#L1882) | <?php } ?> |
| [1883](#L1883) | <div class="moo-totals-item moo-totals-item-total" style="font-weight: 700;" > |
| [1884](#L1884) | <label class="moo-checkoutText-grandTotal" tabindex="0" ><?php \_e("Total", "moo\_OnlineOrders"); ?></label> |
| [1885](#L1885) | <div class="moo-totals-value" id="moo-cart-total" tabindex="0" > |
| [1886](#L1886) | <?php |
| [1887](#L1887) | $grandTotal = $totals['sub\_total'] + $totals['taxes']; |
| [1888](#L1888) |  |
| [1889](#L1889) | if ($showServiceFee) { |
| [1890](#L1890) | $grandTotal += $serviceFeeAmount; |
| [1891](#L1891) | } |
| [1892](#L1892) |  |
| [1893](#L1893) |  |
| [1894](#L1894) | echo '$'.number\_format($grandTotal/100, 2); |
| [1895](#L1895) | ?> |
| [1896](#L1896) | </div> |
| [1897](#L1897) | </div> |
| [1898](#L1898) | </div> |
| [1899](#L1899) | </div> |
| [1900](#L1900) | <div class="moo-shopping-links" style="text-align: center;text-decoration: none;"> |
| [1901](#L1901) | <a href="<?php echo $cart\_page\_url?>" class="moo-checkoutText-updateCart"> |
| [1902](#L1902) | <?php \_e("Update cart", "moo\_OnlineOrders"); ?> |
| [1903](#L1903) | </a> |
| [1904](#L1904) | <a href="<?php echo $store\_page\_url?>" class="moo-checkoutText-continueShopping"> |
| [1905](#L1905) | <?php \_e("Continue shopping", "moo\_OnlineOrders"); ?> |
| [1906](#L1906) | </a> |
| [1907](#L1907) | </div> |
| [1908](#L1908) | </div> |
| [1909](#L1909) |  |
| [1910](#L1910) | </div> |
| [1911](#L1911) | </div> |
| [1912](#L1912) | <div class="moo-row"> |
| [1913](#L1913) | <!--  Checkout form - Buttons section     --> |
| [1914](#L1914) | <div class="moo-col-sm-7" id="moo-checkout-form-btnActions"> |
| [1915](#L1915) | <div id="moo\_checkout\_loading" style="display: none; width: 100%;text-align: center"> |
| [1916](#L1916) | <svg xmlns="http://www.w3.org/2000/svg" width="44px" height="44px" viewBox="0 0 100 100" |
| [1917](#L1917) | preserveAspectRatio="xMidYMid" class="uil-default"> |
| [1918](#L1918) | <rect x="0" y="0" width="100" height="100" fill="none" class="bk"></rect> |
| [1919](#L1919) | <rect x="46.5" y="40" width="7" height="20" rx="5" ry="5" fill="#00b2ff" |
| [1920](#L1920) | transform="rotate(0 50 50) translate(0 -30)"> |
| [1921](#L1921) | <animate attributeName="opacity" from="1" to="0" dur="1s" begin="0s" |
| [1922](#L1922) | repeatCount="indefinite"></animate> |
| [1923](#L1923) | </rect> |
| [1924](#L1924) | <rect x="46.5" y="40" width="7" height="20" rx="5" ry="5" fill="#00b2ff" |
| [1925](#L1925) | transform="rotate(30 50 50) translate(0 -30)"> |
| [1926](#L1926) | <animate attributeName="opacity" from="1" to="0" dur="1s" |
| [1927](#L1927) | begin="0.08333333333333333s" repeatCount="indefinite"></animate> |
| [1928](#L1928) | </rect> |
| [1929](#L1929) | <rect x="46.5" y="40" width="7" height="20" rx="5" ry="5" fill="#00b2ff" |
| [1930](#L1930) | transform="rotate(60 50 50) translate(0 -30)"> |
| [1931](#L1931) | <animate attributeName="opacity" from="1" to="0" dur="1s" |
| [1932](#L1932) | begin="0.16666666666666666s" repeatCount="indefinite"></animate> |
| [1933](#L1933) | </rect> |
| [1934](#L1934) | <rect x="46.5" y="40" width="7" height="20" rx="5" ry="5" fill="#00b2ff" |
| [1935](#L1935) | transform="rotate(90 50 50) translate(0 -30)"> |
| [1936](#L1936) | <animate attributeName="opacity" from="1" to="0" dur="1s" begin="0.25s" |
| [1937](#L1937) | repeatCount="indefinite"></animate> |
| [1938](#L1938) | </rect> |
| [1939](#L1939) | <rect x="46.5" y="40" width="7" height="20" rx="5" ry="5" fill="#00b2ff" |
| [1940](#L1940) | transform="rotate(120 50 50) translate(0 -30)"> |
| [1941](#L1941) | <animate attributeName="opacity" from="1" to="0" dur="1s" |
| [1942](#L1942) | begin="0.3333333333333333s" repeatCount="indefinite"></animate> |
| [1943](#L1943) | </rect> |
| [1944](#L1944) | <rect x="46.5" y="40" width="7" height="20" rx="5" ry="5" fill="#00b2ff" |
| [1945](#L1945) | transform="rotate(150 50 50) translate(0 -30)"> |
| [1946](#L1946) | <animate attributeName="opacity" from="1" to="0" dur="1s" |
| [1947](#L1947) | begin="0.4166666666666667s" repeatCount="indefinite"></animate> |
| [1948](#L1948) | </rect> |
| [1949](#L1949) | <rect x="46.5" y="40" width="7" height="20" rx="5" ry="5" fill="#00b2ff" |
| [1950](#L1950) | transform="rotate(180 50 50) translate(0 -30)"> |
| [1951](#L1951) | <animate attributeName="opacity" from="1" to="0" dur="1s" begin="0.5s" |
| [1952](#L1952) | repeatCount="indefinite"></animate> |
| [1953](#L1953) | </rect> |
| [1954](#L1954) | <rect x="46.5" y="40" width="7" height="20" rx="5" ry="5" fill="#00b2ff" |
| [1955](#L1955) | transform="rotate(210 50 50) translate(0 -30)"> |
| [1956](#L1956) | <animate attributeName="opacity" from="1" to="0" dur="1s" |
| [1957](#L1957) | begin="0.5833333333333334s" repeatCount="indefinite"></animate> |
| [1958](#L1958) | </rect> |
| [1959](#L1959) | <rect x="46.5" y="40" width="7" height="20" rx="5" ry="5" fill="#00b2ff" |
| [1960](#L1960) | transform="rotate(240 50 50) translate(0 -30)"> |
| [1961](#L1961) | <animate attributeName="opacity" from="1" to="0" dur="1s" |
| [1962](#L1962) | begin="0.6666666666666666s" repeatCount="indefinite"></animate> |
| [1963](#L1963) | </rect> |
| [1964](#L1964) | <rect x="46.5" y="40" width="7" height="20" rx="5" ry="5" fill="#00b2ff" |
| [1965](#L1965) | transform="rotate(270 50 50) translate(0 -30)"> |
| [1966](#L1966) | <animate attributeName="opacity" from="1" to="0" dur="1s" begin="0.75s" |
| [1967](#L1967) | repeatCount="indefinite"></animate> |
| [1968](#L1968) | </rect> |
| [1969](#L1969) | <rect x="46.5" y="40" width="7" height="20" rx="5" ry="5" fill="#00b2ff" |
| [1970](#L1970) | transform="rotate(300 50 50) translate(0 -30)"> |
| [1971](#L1971) | <animate attributeName="opacity" from="1" to="0" dur="1s" |
| [1972](#L1972) | begin="0.8333333333333334s" repeatCount="indefinite"></animate> |
| [1973](#L1973) | </rect> |
| [1974](#L1974) | <rect x="46.5" y="40" width="7" height="20" rx="5" ry="5" fill="#00b2ff" |
| [1975](#L1975) | transform="rotate(330 50 50) translate(0 -30)"> |
| [1976](#L1976) | <animate attributeName="opacity" from="1" to="0" dur="1s" |
| [1977](#L1977) | begin="0.9166666666666666s" repeatCount="indefinite"></animate> |
| [1978](#L1978) | </rect> |
| [1979](#L1979) | </svg> |
| [1980](#L1980) | </div> |
| [1981](#L1981) | <div id="moo-cloverGooglePay" class=""></div> |
| [1982](#L1982) | <div id="moo-cloverApplePay" class="moo-col-md-12"></div> |
| [1983](#L1983) | <button type="submit"  id="moo\_btn\_submit\_order" onclick="mooCheckout.finalizeOrder(event);" class="sooCheckoutPrimaryButtonInput moo-finalize-order-btn moo-checkoutText-finalizeOrder"> |
| [1984](#L1984) | <?php \_e("FINALIZE ORDER", "moo\_OnlineOrders"); ?> |
| [1985](#L1985) | </button> |
| [1986](#L1986) | <div style="margin-top: 10px"> |
| [1987](#L1987) | <div class="moo-row"><div class="moo-col-md-12"><span style="font-size: 12px">All transactions are encrypted and secure</span></div></div> |
| [1988](#L1988) | <div class="moo-row"><div class="moo-col-md-12"><img style="height: 15px;margin-top: 5px;" src="<?php echo SOO\_PLUGIN\_URL .'/public/img/cards-icons.png'; ?>"  alt="Visa, MC, Amex"/></div></div> |
| [1989](#L1989) | </div> |
| [1990](#L1990) | </div> |
| [1991](#L1991) | </div> |
| [1992](#L1992) | </div> |
| [1993](#L1993) | </div> |
| [1994](#L1994) | </div> |
| [1995](#L1995) | <?php |
| [1996](#L1996) |  |
| [1997](#L1997) | if ($custom\_js != null) { |
| [1998](#L1998) | echo '<script type="text/javascript">'.$custom\_js.'</script>'; |
| [1999](#L1999) | } |
| [2000](#L2000) |  |
| [2001](#L2001) | return ob\_get\_clean(); |
| [2002](#L2002) | } |
| [2003](#L2003) | /\*\* |
| [2004](#L2004) | \* @param $atts |
| [2005](#L2005) | \* @param $content |
| [2006](#L2006) | \* @return string |
| [2007](#L2007) | \*/ |
| [2008](#L2008) | public function render($atts, $content) |
| [2009](#L2009) | { |
| [2010](#L2010) | if (get\_option('moo\_old\_checkout\_enabled') === 'yes') { |
| [2011](#L2011) | return $this->standardCheckout($atts, $content); |
| [2012](#L2012) | } |
| [2013](#L2013) | return $this->advancedCheckout($atts, $content); |
| [2014](#L2014) | } |
| [2015](#L2015) |  |
| [2016](#L2016) | /\*\* |
| [2017](#L2017) | \* @param $atts |
| [2018](#L2018) | \* @param $content |
| [2019](#L2019) | \* @return string |
| [2020](#L2020) | \*/ |
| [2021](#L2021) | public function renderReceiptLink($atts, $content) |
| [2022](#L2022) | { |
| [2023](#L2023) | $defaultText = \_\_("Click Here", "moo\_OnlineOrders"); |
| [2024](#L2024) | $defaultTitle = \_\_("Click Here", "moo\_OnlineOrders"); |
| [2025](#L2025) | $linkText = (!empty($atts['text'])) ? esc\_attr($atts['text']) : $defaultText; |
| [2026](#L2026) | $linkTitle = (!empty($atts['title'])) ? esc\_attr($atts['title']) : $defaultTitle; |
| [2027](#L2027) | $orderId = (!empty($\_GET['order\_id'])) ? esc\_attr($\_GET['order\_id']) : null; |
| [2028](#L2028) | if ($orderId) { |
| [2029](#L2029) | if (defined('SOO\_ENV') && SOO\_ENV === 'DEV') { |
| [2030](#L2030) | $html = '<a href="https://dev.clover.com/r/'; |
| [2031](#L2031) | } else { |
| [2032](#L2032) | $html = '<a href="https://www.clover.com/r/'; |
| [2033](#L2033) | } |
| [2034](#L2034) | $html .= $orderId.'" target="\_blank" title="'.$linkTitle.'">'; |
| [2035](#L2035) | $html .= $linkText; |
| [2036](#L2036) | $html .= '</a>'; |
| [2037](#L2037) | $html = apply\_filters('moo\_filter\_receipt\_link', $html); |
| [2038](#L2038) | return  $html; |
| [2039](#L2039) | } |
| [2040](#L2040) | return null; |
| [2041](#L2041) | } |
| [2042](#L2042) |  |
| [2043](#L2043) | private function checkOpenning(){ |
| [2044](#L2044) | //check store availability |
| [2045](#L2045) | if (isset($this->pluginSettings['accept\_orders']) && $this->pluginSettings['accept\_orders'] === "disabled") { |
| [2046](#L2046) | if (isset($this->pluginSettings["closing\_msg"]) && $this->pluginSettings["closing\_msg"] !== '') { |
| [2047](#L2047) | $oppening\_msg = '<div class="moo-alert moo-alert-danger" role="alert" id="moo\_checkout\_msg">'.$this->pluginSettings["closing\_msg"].'</div>'; |
| [2048](#L2048) | } else { |
| [2049](#L2049) | $oppening\_msg = '<div class="moo-alert moo-alert-danger" role="alert" id="moo\_checkout\_msg">'.\_\_("We are currently closed and will open again soon", "moo\_OnlineOrders").'</div>'; |
| [2050](#L2050) | } |
| [2051](#L2051) | echo '<div id="moo\_CheckoutContainer" >'.$oppening\_msg.'</div>'; |
| [2052](#L2052) | return false; |
| [2053](#L2053) | } |
| [2054](#L2054) | return true; |
| [2055](#L2055) | } |
| [2056](#L2056) | private function checkBlackout(){ |
| [2057](#L2057) | //Get blackout status |
| [2058](#L2058) | $blackoutStatusResponse = $this->api->getBlackoutStatus(); |
| [2059](#L2059) | if (isset($blackoutStatusResponse["status"]) && $blackoutStatusResponse["status"] === "close") { |
| [2060](#L2060) | if (isset($blackoutStatusResponse["custom\_message"]) && !empty($blackoutStatusResponse["custom\_message"])) { |
| [2061](#L2061) | $oppening\_msg = '<div class="moo-alert moo-alert-danger" role="alert" id="moo\_checkout\_msg">'.$blackoutStatusResponse["custom\_message"].'</div>'; |
| [2062](#L2062) | } else { |
| [2063](#L2063) | $oppening\_msg = '<div class="moo-alert moo-alert-danger" role="alert" id="moo\_checkout\_msg">'.\_\_("We are currently closed and will open again soon", "moo\_OnlineOrders").'</div>'; |
| [2064](#L2064) | } |
| [2065](#L2065) | echo '<div id="moo\_CheckoutContainer" >'.$oppening\_msg.'</div>'; |
| [2066](#L2066) | return false; |
| [2067](#L2067) | } |
| [2068](#L2068) | return true; |
| [2069](#L2069) | } |
| [2070](#L2070) | private function enqueueStyles($isAdvancedCheckout = false) |
| [2071](#L2071) | { |
| [2072](#L2072) |  |
| [2073](#L2073) | $this->enqueueCssGrid(); |
| [2074](#L2074) |  |
| [2075](#L2075) |  |
| [2076](#L2076) | if ($isAdvancedCheckout) { |
| [2077](#L2077) |  |
| [2078](#L2078) | // $this->enqueueSweetAlerts11Css(); |
| [2079](#L2079) |  |
| [2080](#L2080) | $this->enqueuePublicCss(); |
| [2081](#L2081) |  |
| [2082](#L2082) | wp\_register\_style('sooAuthStyles', SOO\_PLUGIN\_URL . '/public/css/dist/sooAuth-light.min.css', array(), SOO\_VERSION); |
| [2083](#L2083) | wp\_enqueue\_style('sooAuthStyles'); |
| [2084](#L2084) |  |
| [2085](#L2085) | wp\_register\_style('sooCheckoutStyles', SOO\_PLUGIN\_URL . '/public/css/dist/sooCheckout-light.min.css', array(), SOO\_VERSION); |
| [2086](#L2086) | wp\_enqueue\_style('sooCheckoutStyles',array('sooAuthStyles')); |
| [2087](#L2087) |  |
| [2088](#L2088) |  |
| [2089](#L2089) |  |
| [2090](#L2090) | } else { |
| [2091](#L2091) |  |
| [2092](#L2092) | $this->enqueueFontAwesome(); |
| [2093](#L2093) |  |
| [2094](#L2094) | $this->enqueueSweetAlerts(); |
| [2095](#L2095) |  |
| [2096](#L2096) | $this->enqueuePublicCss(); |
| [2097](#L2097) |  |
| [2098](#L2098) | wp\_register\_style('sooCheckoutStyles', SOO\_PLUGIN\_URL . '/public/css/dist/mooCheckoutSd.min.css', array(), SOO\_VERSION); |
| [2099](#L2099) | wp\_enqueue\_style('sooCheckoutStyles'); |
| [2100](#L2100) |  |
| [2101](#L2101) | wp\_register\_style('moo-icheck-css', SOO\_PLUGIN\_URL . '/public/css/dist/icheck-blue.min.css', array(), SOO\_VERSION); |
| [2102](#L2102) | wp\_enqueue\_style('moo-icheck-css'); |
| [2103](#L2103) |  |
| [2104](#L2104) | wp\_register\_style( 'sooCart-css', SOO\_PLUGIN\_URL . '/public/css/dist/sooCartStyle.min.css',array(), SOO\_VERSION ); |
| [2105](#L2105) | wp\_enqueue\_style('sooCart-css'); |
| [2106](#L2106) | } |
| [2107](#L2107) |  |
| [2108](#L2108) | if (!empty($this->pluginSettings["custom\_css"])){ |
| [2109](#L2109) | //Include custom css |
| [2110](#L2110) | wp\_add\_inline\_style( "sooCheckoutStyles", $this->pluginSettings["custom\_css"] ); |
| [2111](#L2111) | } |
| [2112](#L2112) | } |
| [2113](#L2113) | private function enqueueScripts($isAdvancedCheckout = false) |
| [2114](#L2114) | { |
| [2115](#L2115) | $cloverSkd = (defined('SOO\_ENV') && (SOO\_ENV === "DEV"))? 'https://checkout.sandbox.dev.clover.com/sdk.js' : 'https://checkout.clover.com/sdk.js'; |
| [2116](#L2116) | //Clover iframe SDK |
| [2117](#L2117) | wp\_register\_script('sooCloverSdk', $cloverSkd, array('jquery')); |
| [2118](#L2118) | wp\_enqueue\_script('sooCloverSdk'); |
| [2119](#L2119) |  |
| [2120](#L2120) | if ($isAdvancedCheckout) { |
| [2121](#L2121) |  |
| [2122](#L2122) | $this->enqueueSweetAlerts11Js(); |
| [2123](#L2123) |  |
| [2124](#L2124) | //New Checkout JS |
| [2125](#L2125) | wp\_register\_script('sooCheckoutScript', SOO\_PLUGIN\_URL . '/public/js/dist/sooCheckout.min.js', array('jquery','sooCloverSdk','SooSweetalerts'), SOO\_VERSION); |
| [2126](#L2126) | wp\_enqueue\_script('sooCheckoutScript'); |
| [2127](#L2127) |  |
| [2128](#L2128) | //Soo Auth Module |
| [2129](#L2129) | wp\_register\_script('sooAuthScript', SOO\_PLUGIN\_URL . '/public/js/dist/sooAuth.min.js', array('jquery','sooCheckoutScript'), SOO\_VERSION); |
| [2130](#L2130) | wp\_enqueue\_script('sooAuthScript'); |
| [2131](#L2131) |  |
| [2132](#L2132) | //Add Google reCAPTCHA |
| [2133](#L2133) | $googleReCAPTCHADisabled = (bool) get\_option('sooDisableGoogleReCAPTCHA',false); |
| [2134](#L2134) | if ($googleReCAPTCHADisabled === false && !empty($this->pluginSettings['reCAPTCHA\_site\_key']) && !empty($this->pluginSettings['reCAPTCHA\_secret\_key'])){ |
| [2135](#L2135) | $this->enqueueRecaptchaJs($this->pluginSettings['reCAPTCHA\_site\_key']); |
| [2136](#L2136) | } |
| [2137](#L2137) |  |
| [2138](#L2138) | } else { |
| [2139](#L2139) | //Checkout JS |
| [2140](#L2140) | wp\_register\_script('sooCheckoutScript', SOO\_PLUGIN\_URL . '/public/js/dist/moo\_checkout.min.js', array('jquery','sooCloverSdk'), SOO\_VERSION); |
| [2141](#L2141) | wp\_enqueue\_script('sooCheckoutScript'); |
| [2142](#L2142) |  |
| [2143](#L2143) | wp\_register\_script('moo-icheck-js', SOO\_PLUGIN\_URL . '/public/js/dist/icheck.min.js', array('jquery'), SOO\_VERSION); |
| [2144](#L2144) | wp\_enqueue\_script('moo-icheck-js'); |
| [2145](#L2145) | } |
| [2146](#L2146) |  |
| [2147](#L2147) | //Google Maps |
| [2148](#L2148) | wp\_register\_script('moo-google-map', 'https://maps.googleapis.com/maps/api/js?libraries=geometry&key=AIzaSyBv1TkdxvWkbFaDz2r0Yx7xvlNKe-2uyRc',array('jquery')); |
| [2149](#L2149) | wp\_enqueue\_script('moo-google-map'); |
| [2150](#L2150) |  |
| [2151](#L2151) | wp\_register\_script('display-merchant-map', SOO\_PLUGIN\_URL . '/public/js/dist/moo\_map.min.js',array('jquery'), SOO\_VERSION); |
| [2152](#L2152) | wp\_enqueue\_script('display-merchant-map'); |
| [2153](#L2153) | } |
| [2154](#L2154) |  |
| [2155](#L2155) | private function cartIsEmpty() |
| [2156](#L2156) | { |
| [2157](#L2157) | $message =  '<div class="moo\_emptycart"><p>'; |
| [2158](#L2158) | $message .=  \_\_("Your cart is empty", "moo\_OnlineOrders"); |
| [2159](#L2159) | $message .=  '</p><span><a class="moo-btn moo-btn-default" href="'.get\_page\_link($this->pluginSettings['store\_page']).'" style="margin-top: 30px;">'; |
| [2160](#L2160) | $message .=  \_\_("Back to Main Menu", "moo\_OnlineOrders"); |
| [2161](#L2161) | $message .=  '</a></span></div>'; |
| [2162](#L2162) | return $message; |
| [2163](#L2163) | } |
| [2164](#L2164) | private function paymentMethodsSection($cloverPakmsKey) |
| [2165](#L2165) | { |
| [2166](#L2166) |  |
| [2167](#L2167) | $cacheNotAvailable = true; |
| [2168](#L2168) | $ccNotAvailable = true; |
| [2169](#L2169) | $giftCardNotAvailable = true; |
| [2170](#L2170) | $googlePayNotAvailable = true; |
| [2171](#L2171) | $applePayNotAvailable = true; |
| [2172](#L2172) |  |
| [2173](#L2173) | $html = '<div id="moo-checkout-form-payments" tabindex="0" aria-label="the payments method">'; |
| [2174](#L2174) | $html .=  '<div class="moo\_checkout\_border\_bottom"></div>'; |
| [2175](#L2175) | $html .=  '<div class="moo-checkout-bloc-title moo-checkoutText-payment" >'; |
| [2176](#L2176) | $html .=  \_\_("Payment Methods", "moo\_OnlineOrders"); |
| [2177](#L2177) | $html .=  '</div>'; |
| [2178](#L2178) | $html .=  '<div class="moo-checkout-bloc-content">'; |
| [2179](#L2179) | $html .=  ''; |
| [2180](#L2180) |  |
| [2181](#L2181) | if ($this->isApplePayEnabled()) { |
| [2182](#L2182) | $html .=  $this->applePaySelector(); |
| [2183](#L2183) | $applePayNotAvailable = false; |
| [2184](#L2184) | } |
| [2185](#L2185) |  |
| [2186](#L2186) | if (isset($cloverPakmsKey) && isset($this->pluginSettings['clover\_googlepay']) && $this->pluginSettings['clover\_googlepay'] == 'on') { |
| [2187](#L2187) | $html .=  $this->googlePaySelector(); |
| [2188](#L2188) | $googlePayNotAvailable = false; |
| [2189](#L2189) | } |
| [2190](#L2190) |  |
| [2191](#L2191) | if (isset($cloverPakmsKey) && isset($this->pluginSettings['clover\_payment\_form']) && $this->pluginSettings['clover\_payment\_form'] == 'on') { |
| [2192](#L2192) | $html .=  $this->creditCardSelector(); |
| [2193](#L2193) | $ccNotAvailable = false; |
| [2194](#L2194) | } |
| [2195](#L2195) |  |
| [2196](#L2196) | if (isset($cloverPakmsKey) && isset($this->pluginSettings['clover\_giftcards']) && $this->pluginSettings['clover\_giftcards'] == 'on') { |
| [2197](#L2197) | $html .=  $this->giftCardSelector(); |
| [2198](#L2198) | $giftCardNotAvailable = false; |
| [2199](#L2199) | } |
| [2200](#L2200) |  |
| [2201](#L2201) | if ($this->pluginSettings['payment\_cash'] == 'on' || $this->pluginSettings['payment\_cash\_delivery'] == 'on') { |
| [2202](#L2202) | $html .= $this->cashSelector(); |
| [2203](#L2203) | $cacheNotAvailable = false; |
| [2204](#L2204) | } |
| [2205](#L2205) | if ( !$ccNotAvailable ) { |
| [2206](#L2206) | $html .= $this->cloverCardSection(); |
| [2207](#L2207) | } |
| [2208](#L2208) | if ( !$giftCardNotAvailable ) { |
| [2209](#L2209) | $html .= $this->giftCardSection(); |
| [2210](#L2210) | } |
| [2211](#L2211) | if ( !$cacheNotAvailable ) { |
| [2212](#L2212) | $html .= $this->cashSection(); |
| [2213](#L2213) | } |
| [2214](#L2214) | if ( !$googlePayNotAvailable ) { |
| [2215](#L2215) | $html .= $this->googlePaySection(); |
| [2216](#L2216) | } |
| [2217](#L2217) | if ( !$applePayNotAvailable ) { |
| [2218](#L2218) | $html .= $this->applePaySection(); |
| [2219](#L2219) | } |
| [2220](#L2220) | if( $ccNotAvailable && $cacheNotAvailable && $giftCardNotAvailable && $googlePayNotAvailable&& $applePayNotAvailable){ |
| [2221](#L2221) | $html .=  '<div>There are no payment methods available. Please try again later. Thank you for your understanding and patience.</div>'; |
| [2222](#L2222) | } |
| [2223](#L2223) | $html .=  '</div></div>'; |
| [2224](#L2224) | $html = apply\_filters('moo\_filter\_checkout\_paymentMethodsSection', $html); |
| [2225](#L2225) | echo  $html; |
| [2226](#L2226) | } |
| [2227](#L2227) | private function orderingTimesSection($oppening\_status) |
| [2228](#L2228) | { |
| [2229](#L2229) | if (!$oppening\_status){ |
| [2230](#L2230) | return; |
| [2231](#L2231) | } |
| [2232](#L2232) | //Start Checkout Ordering time Section |
| [2233](#L2233) | $html  =  '<div id="moo-checkout-form-orderdate" tabindex="0" aria-label="Choose a time if you want schedule the order">'; |
| [2234](#L2234) | $html .=  '<div class="moo\_checkout\_border\_bottom"></div>'; |
| [2235](#L2235) |  |
| [2236](#L2236) |  |
| [2237](#L2237) | //Start Title Section |
| [2238](#L2238) | $html .=  '<div class="moo-checkout-bloc-title moo-checkoutText-chooseTime" >'; |
| [2239](#L2239) | $html .=  \_\_("Choose a time", "moo\_OnlineOrders"); |
| [2240](#L2240) | $html .=  '</div>'; |
| [2241](#L2241) | //End Title Section |
| [2242](#L2242) |  |
| [2243](#L2243) | $html .=  '<div class="moo-checkout-bloc-content">';//Start Bloc Content |
| [2244](#L2244) | $html .=  '<div class="moo-row">';//Start Container |
| [2245](#L2245) |  |
| [2246](#L2246) | //Start Day Selector |
| [2247](#L2247) | $html .=  '<div class="moo-col-xs-6"><div class="moo-form-group">'; |
| [2248](#L2248) | $html .=  '<select class="moo-form-control sooCheckoutTextInput" name="moo\_pickup\_day" id="moo\_pickup\_day" onchange="mooCheckout.orderingDayChanged(this)">'; |
| [2249](#L2249) | foreach ($oppening\_status["pickup\_time"] as $key => $val) { |
| [2250](#L2250) | $html .= '<option value="'.$key.'">'.$key.'</option>'; |
| [2251](#L2251) | } |
| [2252](#L2252) | $html .=  '</select>'; |
| [2253](#L2253) | $html .=  '</div></div>'; |
| [2254](#L2254) | //End Day Selector |
| [2255](#L2255) |  |
| [2256](#L2256) | //Start Time Selector |
| [2257](#L2257) | $html .=  '<div class="moo-col-xs-6"><div class="moo-form-group">'; |
| [2258](#L2258) | $html .=  ''; |
| [2259](#L2259) | $html .=  '<select class="moo-form-control sooCheckoutTextInput" name="moo\_pickup\_hour" id="moo\_pickup\_hour" onchange="mooCheckout.orderingTimeChanged(this)">'; |
| [2260](#L2260) | foreach ($oppening\_status["pickup\_time"] as $val) { |
| [2261](#L2261) | $html .= '<option value="Select a time">Select a time</option>'; |
| [2262](#L2262) | foreach ($val as $h) { |
| [2263](#L2263) | $html .= '<option value="'.$h.'">'.$h.'</option>'; |
| [2264](#L2264) | } |
| [2265](#L2265) | break; |
| [2266](#L2266) | } |
| [2267](#L2267) | $html .=  '</select>'; |
| [2268](#L2268) | $html .=  '</div></div>'; |
| [2269](#L2269) | //End Time Selector |
| [2270](#L2270) |  |
| [2271](#L2271) | //Opening Hours |
| [2272](#L2272) | if ($oppening\_status["store\_time"] !== '') { |
| [2273](#L2273) | $html .=  '<div class="moo-col-xs-12" style="margin-top: 10px">'; |
| [2274](#L2274) | $html .= \_\_("Today's Online Ordering Hours", "moo\_OnlineOrders"); |
| [2275](#L2275) | $html .=  ' : '; |
| [2276](#L2276) | $html .=  $oppening\_status["store\_time"]; |
| [2277](#L2277) | $html .= '</div>'; |
| [2278](#L2278) | } |
| [2279](#L2279) |  |
| [2280](#L2280) | $html .=  '<div class="moo-col-xs-12 extra-info" style="color:red;margin-top: 10px"></div>'; |
| [2281](#L2281) |  |
| [2282](#L2282) | $html .=  '</div">';//End Container |
| [2283](#L2283) | $html .=  '</div>';//Start Bloc Content |
| [2284](#L2284) |  |
| [2285](#L2285) | $html .=  '</div>';//Start Bloc Content |
| [2286](#L2286) |  |
| [2287](#L2287) | //End Checkout Ordering time Section |
| [2288](#L2288) | $html .=  '</div>'; |
| [2289](#L2289) |  |
| [2290](#L2290) | $html = apply\_filters('moo\_filter\_checkout\_orderingTimesSection', $html); |
| [2291](#L2291) | echo  $html; |
| [2292](#L2292) | } |
| [2293](#L2293) | private function tipsSection() |
| [2294](#L2294) | { |
| [2295](#L2295) | $tipString = \_\_("Tip", "moo\_OnlineOrders"); |
| [2296](#L2296) | $addtipString = \_\_("Add a tip to this order", "moo\_OnlineOrders"); |
| [2297](#L2297) | $html = <<<HTML |
| [2298](#L2298) | <div id="moo-checkout-form-tips"> |
| [2299](#L2299) | <div class="moo\_checkout\_border\_bottom"></div> |
| [2300](#L2300) | <div class="moo-checkout-bloc-title moo-checkoutText-tip"> |
| [2301](#L2301) | $tipString |
| [2302](#L2302) | </div> |
| [2303](#L2303) | <div class="moo-checkout-bloc-content"> |
| [2304](#L2304) | <div class="moo-row"  style="margin-top: 13px;"> |
| [2305](#L2305) | <div class="moo-col-xs-6"> |
| [2306](#L2306) | <div class="moo-form-group"> |
| [2307](#L2307) | <select class="moo-form-control sooCheckoutTextInput" name="moo\_tips\_select" id="moo\_tips\_select" onchange="mooCheckout.tipPercentageChanged()" aria-label="list of tips"> |
| [2308](#L2308) | <option value="cash">$addtipString</option> |
| [2309](#L2309) | HTML; |
| [2310](#L2310) | if (isset($this->pluginSettings["tips\_default"]) && !empty($this->pluginSettings["tips\_default"])) { |
| [2311](#L2311) | $defaultTips = floatval(trim($this->pluginSettings["tips\_default"])); |
| [2312](#L2312) | } else { |
| [2313](#L2313) | $defaultTips = null; |
| [2314](#L2314) | } |
| [2315](#L2315) | if (isset($this->pluginSettings["tips\_selection"]) && !empty($this->pluginSettings["tips\_selection"])) { |
| [2316](#L2316) | $vals = explode(",", $this->pluginSettings["tips\_selection"]); |
| [2317](#L2317) | if (is\_array($vals) && count($vals) > 0) { |
| [2318](#L2318) | foreach ($vals as $k => $v) { |
| [2319](#L2319) | if (floatval(trim($v)) === $defaultTips) { |
| [2320](#L2320) | $html.= '<option value="'.floatval(trim($v)).'" selected>'. floatval(trim($v)) .'%</option>'; |
| [2321](#L2321) | } else { |
| [2322](#L2322) | $html.= '<option value="'.floatval(trim($v)).'">'. floatval(trim($v)) .'%</option>'; |
| [2323](#L2323) | } |
| [2324](#L2324) | } |
| [2325](#L2325) | } |
| [2326](#L2326) | } else { |
| [2327](#L2327) | $html.= '<option value="10" '.(($defaultTips == 10)?"selected":"").'>10%</option>'; |
| [2328](#L2328) | $html.= '<option value="15" '.(($defaultTips == 15)?"selected":"").'>15%</option>'; |
| [2329](#L2329) | $html.= '<option value="20" '.(($defaultTips == 20)?"selected":"").'>20%</option>'; |
| [2330](#L2330) | $html.= '<option value="25" '.(($defaultTips == 25)?"selected":"").'>25%</option>'; |
| [2331](#L2331) | } |
| [2332](#L2332) | $html .= <<<HTML |
| [2333](#L2333) | <option value="other">Custom $</option> |
| [2334](#L2334) | </select> |
| [2335](#L2335) | </div> |
| [2336](#L2336) | </div> |
| [2337](#L2337) | <div class="moo-col-xs-6"> |
| [2338](#L2338) | <div class="moo-form-group"> |
| [2339](#L2339) | <input class="moo-form-control sooCheckoutTextInput" name="tip" id="moo\_tips" value="0" onchange="mooCheckout.tipAmountChanged()"> |
| [2340](#L2340) | </div> |
| [2341](#L2341) | </div> |
| [2342](#L2342) | </div> |
| [2343](#L2343) | </div> |
| [2344](#L2344) | </div> |
| [2345](#L2345) | HTML; |
| [2346](#L2346) | $html = apply\_filters('moo\_filter\_checkout\_tipsSection', $html); |
| [2347](#L2347) | echo  $html; |
| [2348](#L2348) | } |
| [2349](#L2349) | private function loyaltySection($label = 'points') |
| [2350](#L2350) | { |
| [2351](#L2351) | $tipString = \_\_("Loyalty", "moo\_OnlineOrders"); |
| [2352](#L2352) | $balance = \_\_("Balance", "moo\_OnlineOrders"); |
| [2353](#L2353) | $use = \_\_("Use ", "moo\_OnlineOrders"). $label; |
| [2354](#L2354) | $dontUse = \_\_("Remove ", "moo\_OnlineOrders"). $label; |
| [2355](#L2355) | $imgLink = SOO\_PLUGIN\_URL . "/public/img/loyaltyIcon.svg"; |
| [2356](#L2356) | $html = <<<HTML |
| [2357](#L2357) | <div id="moo-checkout-form-loyalty"> |
| [2358](#L2358) | <div class="moo\_checkout\_border\_bottom"></div> |
| [2359](#L2359) | <div class="moo-checkout-bloc-title moo-checkoutText-tip"> |
| [2360](#L2360) | $tipString |
| [2361](#L2361) | </div> |
| [2362](#L2362) | <div class="moo-checkout-bloc-content"> |
| [2363](#L2363) | <div class="moo-row" style="margin-top: 13px;"> |
| [2364](#L2364) | <div class="moo-col-xs-2 loyaltyIcon"> |
| [2365](#L2365) | <img src="$imgLink" alt="Loyalty"> |
| [2366](#L2366) | </div> |
| [2367](#L2367) | <div class="moo-col-xs-6 loyaltyBalance"> |
| [2368](#L2368) | <div class="balanceTitle">$balance</div> |
| [2369](#L2369) | <div class="balance"> |
| [2370](#L2370) | <span class="balancePoints"></span> = $<span class="balanceAmount"></span> |
| [2371](#L2371) | <div class="canUseUpTo"></div> |
| [2372](#L2372) | </div> |
| [2373](#L2373) | </div> |
| [2374](#L2374) | <div class="moo-col-xs-4 loyaltyButtons"> |
| [2375](#L2375) | <button class="sooUsePointsButton sooCheckoutSecondaryButtonInput" onclick="mooCheckout.clickOnUsePoints()"> |
| [2376](#L2376) | $use |
| [2377](#L2377) | </button> |
| [2378](#L2378) | <button class="sooRemovePointsButton sooCheckoutSecondaryButtonInput" onclick="mooCheckout.clickOnRemovePoints()"> |
| [2379](#L2379) | $dontUse |
| [2380](#L2380) | </button> |
| [2381](#L2381) | </div> |
| [2382](#L2382) | </div> |
| [2383](#L2383) | <div class="moo-row usePointsInput"> |
| [2384](#L2384) | <div class="moo-col-md-9 moo-col-xs-6"> |
| [2385](#L2385) | <div class="moo-row"> |
| [2386](#L2386) | <div class="moo-col-md-9 moo-col-xs-12"> |
| [2387](#L2387) | <input id="sooSelectedPointsValue" type="number" class="sooCheckoutTextInput" onchange="mooCheckout.changePointsValue()"> |
| [2388](#L2388) | </div> |
| [2389](#L2389) | <div class="moo-col-md-3 moo-col-xs-12 sooToPayInfo">To Pay: <span class="sooToPayAmount">$0.00</span></div> |
| [2390](#L2390) | </div> |
| [2391](#L2391) | </div> |
| [2392](#L2392) | <div class="moo-col-md-3 moo-col-xs-6 sooValidatePoints"> |
| [2393](#L2393) | <button class="sooValidatePointsButton sooCheckoutPrimaryButtonInput" onclick="mooCheckout.usePoints()">Use</button> |
| [2394](#L2394) | <button class="sooEditPointsButton sooCheckoutPrimaryButtonInput" onclick="mooCheckout.editPoints()">Edit</button> |
| [2395](#L2395) | <span class="sooLoyaltyDetailsButton" > |
| [2396](#L2396) | <svg onclick="mooCheckout.openLoyaltyDetails()" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg"><path \_ngcontent-vfa-c105="" d="M9.99984 5.83342C9.77883 5.83342 9.56687 5.92121 9.41059 6.07749C9.25431 6.23377 9.16651 6.44573 9.16651 6.66675V10.0001C9.16651 10.2211 9.25431 10.4331 9.41059 10.5893C9.56687 10.7456 9.77883 10.8334 9.99984 10.8334C10.2209 10.8334 10.4328 10.7456 10.5891 10.5893C10.7454 10.4331 10.8332 10.2211 10.8332 10.0001V6.66675C10.8332 6.44573 10.7454 6.23377 10.5891 6.07749C10.4328 5.92121 10.2209 5.83342 9.99984 5.83342ZM10.7665 13.0167C10.7483 12.9636 10.723 12.9132 10.6915 12.8667L10.5915 12.7417C10.4743 12.6261 10.3255 12.5478 10.1639 12.5166C10.0022 12.4855 9.83493 12.5029 9.68317 12.5667C9.58219 12.6089 9.48918 12.6681 9.40817 12.7417C9.33094 12.8196 9.26984 12.912 9.22837 13.0135C9.18689 13.115 9.16587 13.2237 9.16651 13.3334C9.16782 13.4423 9.19047 13.5499 9.23317 13.6501C9.2706 13.7535 9.33031 13.8474 9.40808 13.9252C9.48584 14.0029 9.57976 14.0627 9.68317 14.1001C9.78292 14.1442 9.89078 14.1669 9.99984 14.1669C10.1089 14.1669 10.2168 14.1442 10.3165 14.1001C10.4199 14.0627 10.5138 14.0029 10.5916 13.9252C10.6694 13.8474 10.7291 13.7535 10.7665 13.6501C10.8092 13.5499 10.8319 13.4423 10.8332 13.3334C10.8373 13.2779 10.8373 13.2222 10.8332 13.1667C10.8188 13.1136 10.7963 13.063 10.7665 13.0167ZM9.99984 1.66675C8.35166 1.66675 6.7405 2.15549 5.37009 3.07117C3.99968 3.98685 2.93158 5.28834 2.30084 6.81105C1.67011 8.33377 1.50509 10.0093 1.82663 11.6258C2.14817 13.2423 2.94185 14.7272 4.10728 15.8926C5.27272 17.0581 6.75758 17.8517 8.37409 18.1733C9.9906 18.4948 11.6662 18.3298 13.1889 17.6991C14.7116 17.0683 16.0131 16.0002 16.9288 14.6298C17.8444 13.2594 18.3332 11.6483 18.3332 10.0001C18.3332 8.90573 18.1176 7.8221 17.6988 6.81105C17.28 5.80001 16.6662 4.88135 15.8924 4.10752C15.1186 3.3337 14.1999 2.71987 13.1889 2.30109C12.1778 1.8823 11.0942 1.66675 9.99984 1.66675ZM9.99984 16.6667C8.6813 16.6667 7.39237 16.2758 6.29604 15.5432C5.19971 14.8107 4.34523 13.7695 3.84064 12.5513C3.33606 11.3331 3.20404 9.99269 3.46127 8.69948C3.71851 7.40627 4.35345 6.21839 5.2858 5.28604C6.21815 4.35369 7.40603 3.71875 8.69924 3.46151C9.99245 3.20428 11.3329 3.3363 12.5511 3.84088C13.7692 4.34547 14.8104 5.19995 15.543 6.29628C16.2755 7.39261 16.6665 8.68154 16.6665 10.0001C16.6665 11.7682 15.9641 13.4639 14.7139 14.7141C13.4636 15.9644 11.768 16.6667 9.99984 16.6667Z" fill="#BFBFBF" class="ng-tns-c105-44"></path></svg> |
| [2397](#L2397) | </span> |
| [2398](#L2398) | </div> |
| [2399](#L2399) | <div class="moo-col-xs-12 moo-error-section"></div> |
| [2400](#L2400) | </div> |
| [2401](#L2401) | <div class="moo-row sooEarningSection"> |
| [2402](#L2402) | <div class="moo-col-xs-12"></div> |
| [2403](#L2403) | </div> |
| [2404](#L2404) | </div> |
| [2405](#L2405) | </div> |
| [2406](#L2406) | HTML; |
| [2407](#L2407) | $html = apply\_filters('moo\_filter\_checkout\_loyaltySection', $html); |
| [2408](#L2408) | echo  $html; |
| [2409](#L2409) | } |
| [2410](#L2410) | private function tipsSectionOld() |
| [2411](#L2411) | { |
| [2412](#L2412) | $tipString = \_\_("Tip", "moo\_OnlineOrders"); |
| [2413](#L2413) | $addtipString = \_\_("Add a tip to this order", "moo\_OnlineOrders"); |
| [2414](#L2414) | $html = <<<HTML |
| [2415](#L2415) | <div id="moo-checkout-form-tips"> |
| [2416](#L2416) | <div class="moo\_checkout\_border\_bottom"></div> |
| [2417](#L2417) | <div class="moo-checkout-bloc-title moo-checkoutText-tip"> |
| [2418](#L2418) | $tipString |
| [2419](#L2419) | </div> |
| [2420](#L2420) | <div class="moo-checkout-bloc-content"> |
| [2421](#L2421) | <div class="moo-row"  style="margin-top: 13px;"> |
| [2422](#L2422) | <div class="moo-col-md-6"> |
| [2423](#L2423) | <div class="moo-form-group"> |
| [2424](#L2424) | <select class="moo-form-control" name="moo\_tips\_select" id="moo\_tips\_select" onchange="moo\_tips\_select\_changed()" aria-label="list of tips"> |
| [2425](#L2425) | <option value="cash">$addtipString</option> |
| [2426](#L2426) | HTML; |
| [2427](#L2427) | if (isset($this->pluginSettings["tips\_default"]) && !empty($this->pluginSettings["tips\_default"])) { |
| [2428](#L2428) | $defaultTips = floatval(trim($this->pluginSettings["tips\_default"])); |
| [2429](#L2429) | } else { |
| [2430](#L2430) | $defaultTips = null; |
| [2431](#L2431) | } |
| [2432](#L2432) | if (isset($this->pluginSettings["tips\_selection"]) && !empty($this->pluginSettings["tips\_selection"])) { |
| [2433](#L2433) | $vals = explode(",", $this->pluginSettings["tips\_selection"]); |
| [2434](#L2434) | if (is\_array($vals) && count($vals) > 0) { |
| [2435](#L2435) | foreach ($vals as $k => $v) { |
| [2436](#L2436) | if (floatval(trim($v)) === $defaultTips) { |
| [2437](#L2437) | $html.= '<option value="'.floatval(trim($v)).'" selected>'. floatval(trim($v)) .'%</option>'; |
| [2438](#L2438) | } else { |
| [2439](#L2439) | $html.= '<option value="'.floatval(trim($v)).'">'. floatval(trim($v)) .'%</option>'; |
| [2440](#L2440) | } |
| [2441](#L2441) | } |
| [2442](#L2442) | } |
| [2443](#L2443) | } else { |
| [2444](#L2444) | $html.= '<option value="10" '.(($defaultTips == 10)?"selected":"").'>10%</option>'; |
| [2445](#L2445) | $html.= '<option value="15" '.(($defaultTips == 15)?"selected":"").'>15%</option>'; |
| [2446](#L2446) | $html.= '<option value="20" '.(($defaultTips == 20)?"selected":"").'>20%</option>'; |
| [2447](#L2447) | $html.= '<option value="25" '.(($defaultTips == 25)?"selected":"").'>25%</option>'; |
| [2448](#L2448) | } |
| [2449](#L2449) | $html .= <<<HTML |
| [2450](#L2450) | <option value="other">Custom $</option> |
| [2451](#L2451) | </select> |
| [2452](#L2452) | </div> |
| [2453](#L2453) | </div> |
| [2454](#L2454) | <div class="moo-col-md-6"> |
| [2455](#L2455) | <div class="moo-form-group"> |
| [2456](#L2456) | <input class="moo-form-control" name="tip" id="moo\_tips" value="0" onchange="moo\_tips\_amount\_changed()"> |
| [2457](#L2457) | </div> |
| [2458](#L2458) | </div> |
| [2459](#L2459) | </div> |
| [2460](#L2460) | </div> |
| [2461](#L2461) | </div> |
| [2462](#L2462) | HTML; |
| [2463](#L2463) | $html = apply\_filters('moo\_filter\_checkout\_tips', $html); |
| [2464](#L2464) | echo  $html; |
| [2465](#L2465) | } |
| [2466](#L2466) | private function cloverCardSection() |
| [2467](#L2467) | { |
| [2468](#L2468) | $htmBegin   = '<div id="moo-cloverCreditCardPanel"><input type="hidden" name="cloverToken" id="moo-CloverToken">'; |
| [2469](#L2469) | $htmEnd     = ' <div class="clover-errors"></div></div>'; |
| [2470](#L2470) | $cardNumber = '<div class="moo-row"><div class="moo-col-md-12"><div class="moo-form-group"><div class="moo-form-control" id="moo\_CloverCardNumber"></div><div class="card-number-error"><div class="clover-error"></div></div></div></div></div>'; |
| [2471](#L2471) | $dateAndCvv = '<div class="moo-row"><div class="moo-col-md-6"><div class="moo-form-group"><div class="moo-form-control" id="moo\_CloverCardDate"></div><div class="date-error"><div class="clover-error"></div></div></div></div><div class="moo-col-md-6"><div class="moo-form-group"><div class="moo-form-control" id="moo\_CloverCardCvv"></div><div class="cvv-error"><div class="clover-error"></div></div></div></div></div>'; |
| [2472](#L2472) | $address    = '<div class="moo-row"><div class="moo-col-md-12"><div class="moo-form-group"><div class="moo-form-control" id="moo\_CloverStreetAddress"></div><div class="streetAddress-error"><div class="clover-error"></div></div></div></div></div>'; |
| [2473](#L2473) | $zip        = '<div class="moo-row"><div class="moo-col-md-12"><div class="moo-form-group"><div class="moo-form-control" id="moo\_CloverCardZip"></div><div class="zip-error"><div class="clover-error"></div></div></div></div></div>'; |
| [2474](#L2474) | $encrypted  = '<div class="moo-row"><div class="moo-col-md-12"><span>All transactions are encrypted and secure</span></div></div>'; |
| [2475](#L2475) | $cardsIcons  = '<div class="moo-row"><div class="moo-col-md-12"><img style="height: 25px;margin-top: 5px;" src="'. SOO\_PLUGIN\_URL .'/public/img/cards-icons.png"  alt="Visa, MC, Amex"/></div></div>'; |
| [2476](#L2476) |  |
| [2477](#L2477) | $html = $htmBegin; |
| [2478](#L2478) | $html .= $cardNumber . $dateAndCvv; |
| [2479](#L2479) | if ($this->showStreetAddressFieldOnPaymentForm) { |
| [2480](#L2480) | $html .= $address; |
| [2481](#L2481) | } |
| [2482](#L2482) | $html .= $zip; |
| [2483](#L2483) | //$html .= $encrypted; |
| [2484](#L2484) | //$html .= $cardsIcons; |
| [2485](#L2485) | $html .= $htmEnd; |
| [2486](#L2486) | $html = apply\_filters('moo\_filter\_checkout\_cloverCardSection', $html); |
| [2487](#L2487) | return $html; |
| [2488](#L2488) | } |
| [2489](#L2489) | private function giftCardSection() |
| [2490](#L2490) | { |
| [2491](#L2491) | $htmBegin   = '<div id="moo-cloverGiftCardPanel"><input type="hidden" name="cloverToken" id="moo-CloverToken">'; |
| [2492](#L2492) | $htmEnd     = ' <div class="clover-errors"></div></div>'; |
| [2493](#L2493) | $giftCard   = '<div class="moo-row"><div class="moo-col-md-12"><div class="moo-form-group"><div id="moo\_CloverGiftCard"></div><div class="giftCard-error"><div class="clover-error"></div></div></div></div></div>'; |
| [2494](#L2494) | $html = $htmBegin . $giftCard . $htmEnd; |
| [2495](#L2495) | $html = apply\_filters('moo\_filter\_giftCardSection', $html); |
| [2496](#L2496) | return $html; |
| [2497](#L2497) | } |
| [2498](#L2498) | private function cashSection() |
| [2499](#L2499) | { |
| [2500](#L2500) | $html    = '<div id="moo\_cashPanel">'; |
| [2501](#L2501) | $html    .= ' <div class="soo-phone-verif-title">We will send a verification code via SMS to your number</div>'; |
| [2502](#L2502) | $html    .= ' <div class="soo-phone-input"><input class="sooCheckoutTextInput" type="text" placeholder="Enter 6-digit code"><button onclick="mooCheckout.verifyCodeSentToPhone()" class="sooCheckoutPrimaryButtonInput">Verify</button></div>'; |
| [2503](#L2503) | $html    .= ' <div class="soo-phone-button"><button class="sooCheckoutPrimaryButtonInput"  onclick="mooCheckout.sendCodeToVerifyPhone()">Send</button></div>'; |
| [2504](#L2504) | $html    .= ' <div class="soo-phone-verif-footer"></div>'; |
| [2505](#L2505) | $html    .= '</div>'; |
| [2506](#L2506) | return apply\_filters('moo\_filter\_checkout\_cashPanel', $html); |
| [2507](#L2507) | } |
| [2508](#L2508) | private function googlePaySection() |
| [2509](#L2509) | { |
| [2510](#L2510) | $html    = '<div id="mooGooglePaySection">'; |
| [2511](#L2511) | $html    .= ' <div class="mooGooglePaySectionText">Fast and easy checkout with Google! Simply scroll to the bottom to complete your payment</div>'; |
| [2512](#L2512) | $html    .= '</div>'; |
| [2513](#L2513) | return apply\_filters('moo\_filter\_checkout\_googlePaySection', $html); |
| [2514](#L2514) | } |
| [2515](#L2515) | private function applePaySection() |
| [2516](#L2516) | { |
| [2517](#L2517) | $html    = '<div id="mooApplePaySection">'; |
| [2518](#L2518) | $html    .= ' <div class="mooApplePaySectionText">Fast and easy checkout with Apple! Simply scroll to the bottom to complete your payment</div>'; |
| [2519](#L2519) | $html    .= '</div>'; |
| [2520](#L2520) | return apply\_filters('moo\_filter\_checkout\_applePaySection', $html); |
| [2521](#L2521) | } |
| [2522](#L2522) | private function creditCardSelector() |
| [2523](#L2523) | { |
| [2524](#L2524) | $payString = \_\_("Credit / Debit Card", "moo\_OnlineOrders"); |
| [2525](#L2525) | $html = <<<HTML |
| [2526](#L2526) | <div class="soo-checkout-radio-input-option"> |
| [2527](#L2527) | <input onchange="mooCheckout.paymentMethodChanged()" class="soo-checkout-radio-input" type="radio" name="paymentMethod" value="clover" id="moo-checkout-form-payments-clover"> |
| [2528](#L2528) | <label for="moo-checkout-form-payments-clover" class="moo-checkout-radio-input-label" >$payString</label> |
| [2529](#L2529) | </div> |
| [2530](#L2530) | HTML; |
| [2531](#L2531) | $html = apply\_filters('moo\_filter\_checkout\_creditCardSelector', $html); |
| [2532](#L2532) | return  $html; |
| [2533](#L2533) | } |
| [2534](#L2534) | private function cashSelector() |
| [2535](#L2535) | { |
| [2536](#L2536) | $payString = \_\_("Pay at location", "moo\_OnlineOrders"); |
| [2537](#L2537) | $html = <<<HTML |
| [2538](#L2538) | <div class="soo-checkout-radio-input-option moo-checkout-form-payments-cash-container"> |
| [2539](#L2539) | <input onchange="mooCheckout.paymentMethodChanged()" class="soo-checkout-radio-input" type="radio" name="paymentMethod" value="cash" id="moo-checkout-form-payments-cash"> |
| [2540](#L2540) | <label for="moo-checkout-form-payments-cash" class="moo-checkout-radio-input-label" id="moo-checkout-form-payincash-label">$payString</label> |
| [2541](#L2541) | </div> |
| [2542](#L2542) | HTML; |
| [2543](#L2543) | $html = apply\_filters('moo\_filter\_checkout\_cashSelector', $html); |
| [2544](#L2544) | return $html; |
| [2545](#L2545) | } |
| [2546](#L2546) | private function giftCardSelector() |
| [2547](#L2547) | { |
| [2548](#L2548) | $payString = \_\_("Pay Using Gift Card", "moo\_OnlineOrders"); |
| [2549](#L2549) | $html = <<<HTML |
| [2550](#L2550) | <div class="soo-checkout-radio-input-option"> |
| [2551](#L2551) | <input onchange="mooCheckout.paymentMethodChanged()" class="soo-checkout-radio-input" type="radio" name="paymentMethod" value="giftcard" id="moo-checkout-form-payments-giftcard"> |
| [2552](#L2552) | <label for="moo-checkout-form-payments-giftcard" class="moo-checkout-radio-input-label" id="moo-checkout-form-payments-giftcard-label">$payString</label> |
| [2553](#L2553) | </div> |
| [2554](#L2554) | HTML; |
| [2555](#L2555) | $html = apply\_filters('moo\_filter\_checkout\_giftCardSelector', $html); |
| [2556](#L2556) | return $html; |
| [2557](#L2557) | } |
| [2558](#L2558) | private function googlePaySelector() |
| [2559](#L2559) | { |
| [2560](#L2560) | $payString = \_\_("Google Pay", "moo\_OnlineOrders"); |
| [2561](#L2561) | $html = <<<HTML |
| [2562](#L2562) | <div class="soo-checkout-radio-input-option"> |
| [2563](#L2563) | <input onchange="mooCheckout.paymentMethodChanged()" class="soo-checkout-radio-input" type="radio" name="paymentMethod" value="googlepay" id="moo-checkout-form-payments-google"> |
| [2564](#L2564) | <label for="moo-checkout-form-payments-google" class="moo-checkout-radio-input-label" id="moo-checkout-form-paywithgoogle-label">$payString</label> |
| [2565](#L2565) | </div> |
| [2566](#L2566) | HTML; |
| [2567](#L2567) | $html = apply\_filters('moo\_filter\_checkout\_googlePaySelector', $html); |
| [2568](#L2568) | return  $html; |
| [2569](#L2569) | } |
| [2570](#L2570) | private function applePaySelector() |
| [2571](#L2571) | { |
| [2572](#L2572) | $payString = \_\_("Apple Pay", "moo\_OnlineOrders"); |
| [2573](#L2573) | $html = <<<HTML |
| [2574](#L2574) | <div class="soo-checkout-radio-input-option" id="soo-applepay-selector"> |
| [2575](#L2575) | <input onchange="mooCheckout.paymentMethodChanged()" class="soo-checkout-radio-input" type="radio" name="paymentMethod" value="applepay" id="moo-checkout-form-payments-applepay"> |
| [2576](#L2576) | <label for="moo-checkout-form-payments-applepay" class="moo-checkout-radio-input-label" id="moo-checkout-form-applepay-label">$payString</label> |
| [2577](#L2577) | </div> |
| [2578](#L2578) | HTML; |
| [2579](#L2579) | $html = apply\_filters('moo\_filter\_checkout\_applePaySelector', $html); |
| [2580](#L2580) | return  $html; |
| [2581](#L2581) | } |
| [2582](#L2582) | private function couponsSection() |
| [2583](#L2583) | { |
| [2584](#L2584) | $titleTxt = \_\_("Coupon code", "moo\_OnlineOrders"); |
| [2585](#L2585) | $applyTxt = \_\_("Apply", "moo\_OnlineOrders"); |
| [2586](#L2586) | $removeTxt = \_\_("Remove", "moo\_OnlineOrders"); |
| [2587](#L2587) | $html = ''; |
| [2588](#L2588) | $html .= ''; |
| [2589](#L2589) |  |
| [2590](#L2590) | $html  =  '<div id="moo-checkout-form-coupon">'; |
| [2591](#L2591) | $html  .= '<div class="moo\_checkout\_border\_bottom"></div>'; |
| [2592](#L2592) | $html  .=  '<div class="moo-checkout-bloc-title moo-checkoutText-couponCod"><label for="moo\_coupon">'; |
| [2593](#L2593) | $html  .=  \_\_("Coupon code", "moo\_OnlineOrders"); |
| [2594](#L2594) | $html  .=  '</label></div>'; |
| [2595](#L2595) | $html .= '<div class="moo-checkout-bloc-content">'; |
| [2596](#L2596) | $html .= '<div class="moo-row">'; |
| [2597](#L2597) | $html .= '<div class="moo-col-xs-9">'; |
| [2598](#L2598) | $html .= '<div class="moo-form-group">'; |
| [2599](#L2599) | $html .= '<input type="text" class="moo-form-control sooCheckoutTextInput" id="moo\_coupon">'; |
| [2600](#L2600) | $html .= '</div>'; |
| [2601](#L2601) | $html .= '</div>'; |
| [2602](#L2602) | $html .= '<div class="moo-col-xs-3">'; |
| [2603](#L2603) | $html .= '<div class="moo-form-group">'; |
| [2604](#L2604) | $html .= '<button class="sooApplyCouponButton sooCheckoutPrimaryButtonInput" onclick="mooCheckout.applyCoupon()">'.$applyTxt.'</button>'; |
| [2605](#L2605) | $html .= '<button class="sooDeleteCouponButton sooCheckoutPrimaryButtonInput" onclick="mooCheckout.removeCoupon()">'.$removeTxt.'</button>'; |
| [2606](#L2606) | $html .= '</div>'; |
| [2607](#L2607) | $html .= '</div>'; |
| [2608](#L2608) | $html .= '</div>'; |
| [2609](#L2609) | $html .=  '</div></div>'; |
| [2610](#L2610) | $html = apply\_filters('moo\_filter\_checkout\_couponsSection', $html); |
| [2611](#L2611) | echo  $html; |
| [2612](#L2612) | $html = <<<HTML |
| [2613](#L2613) | <div id="moo-checkout-form-coupon"> |
| [2614](#L2614) | <div class="moo\_checkout\_border\_bottom"></div> |
| [2615](#L2615) | <div class="moo-checkout-bloc-title moo-checkoutText-couponCode"> |
| [2616](#L2616) | <label for="moo\_coupon">$titleTxt</label> |
| [2617](#L2617) | </div> |
| [2618](#L2618) | <div class="moo-checkout-bloc-content" id="moo\_enter\_coupon"> |
| [2619](#L2619) | <div class="moo-col-md-8"> |
| [2620](#L2620) | <div class="moo-form-group"> |
| [2621](#L2621) | <input onchange="mooCouponValueChanged(event)" type="text" class="moo-form-control sooCheckoutTextInput" id="moo\_coupon"> |
| [2622](#L2622) | </div> |
| [2623](#L2623) | </div> |
| [2624](#L2624) | <div class="moo-col-md-4"> |
| [2625](#L2625) | <div class="moo-form-group"> |
| [2626](#L2626) | <a href="#" class="moo-btn moo-btn-primary" onclick="mooCouponApply(event)" style="height: 40px;line-height: 24px;"> |
| [2627](#L2627) | $applyTxt |
| [2628](#L2628) | </a> |
| [2629](#L2629) | </div> |
| [2630](#L2630) | </div> |
| [2631](#L2631) | </div> |
| [2632](#L2632) | <div class="moo-checkout-bloc-content" id="moo\_remove\_coupon" style="display:none"> |
| [2633](#L2633) | <div class="moo-col-md-8"> |
| [2634](#L2634) | <div class="moo-form-group"> |
| [2635](#L2635) | <p style="font-size: 20px" id="moo\_remove\_coupon\_code"></p> |
| [2636](#L2636) | </div> |
| [2637](#L2637) | </div> |
| [2638](#L2638) | <div class="moo-col-md-4"> |
| [2639](#L2639) | <div class="moo-form-group"> |
| [2640](#L2640) | <a href="#" class="moo-btn moo-btn-primary" onclick="mooCouponRemove(event)"> |
| [2641](#L2641) | $removeTxt |
| [2642](#L2642) | </a> |
| [2643](#L2643) | </div> |
| [2644](#L2644) | </div> |
| [2645](#L2645) | </div> |
| [2646](#L2646) | </div> |
| [2647](#L2647) | HTML; |
| [2648](#L2648) |  |
| [2649](#L2649) | } |
| [2650](#L2650) | private function specialInstructionsSection() |
| [2651](#L2651) | { |
| [2652](#L2652) | $html  =  '<div id="moo-checkout-form-instruction">'; |
| [2653](#L2653) | $html  .= '<div class="moo\_checkout\_border\_bottom"></div>'; |
| [2654](#L2654) | $html  .=  '<div class="moo-checkout-bloc-title moo-checkoutText-instructions"><label for="Mooinstructions">'; |
| [2655](#L2655) | $html  .=  \_\_("Special Instructions", "moo\_OnlineOrders"); |
| [2656](#L2656) | $html  .=  '</label></div>'; |
| [2657](#L2657) |  |
| [2658](#L2658) | $html .= '<div class="moo-checkout-bloc-content">'; |
| [2659](#L2659) | if (isset($this->pluginSettings['text\_under\_special\_instructions']) && $this->pluginSettings['text\_under\_special\_instructions']!=='') { |
| [2660](#L2660) | $html .= '<div class="moo-special-instruction-title">'.wp\_kses\_post(wp\_unslash($this->pluginSettings['text\_under\_special\_instructions'])).'</div>'; |
| [2661](#L2661) | } |
| [2662](#L2662) | if (isset($this->pluginSettings['special\_instructions\_required']) && $this->pluginSettings['special\_instructions\_required']==='yes') { |
| [2663](#L2663) | $html .= '<textarea class="moo-form-control sooCheckoutTextInput" cols="100%" rows="5" id="Mooinstructions" style="height: 80px;" required></textarea>'; |
| [2664](#L2664) | } else { |
| [2665](#L2665) | $html .= '<textarea class="moo-form-control sooCheckoutTextInput" cols="100%" rows="5" id="Mooinstructions" style="height: 80px;"></textarea>'; |
| [2666](#L2666) | } |
| [2667](#L2667) |  |
| [2668](#L2668) | $html .=  '</div></div>'; |
| [2669](#L2669) | $html = apply\_filters('moo\_filter\_checkout\_specialInstructionsSection', $html); |
| [2670](#L2670) | echo  $html; |
| [2671](#L2671) | } |
| [2672](#L2672) |  |
| [2673](#L2673) | private function cloverCardSectionOld() |
| [2674](#L2674) | { |
| [2675](#L2675) | $htmBegin   = '<div id="moo-cloverCreditCardPanel"><input type="hidden" name="cloverToken" id="moo-CloverToken">'; |
| [2676](#L2676) | $htmEnd     = ' <div class="clover-errors"></div></div>'; |
| [2677](#L2677) | $cardNumber = '<div class="moo-row"><div class="moo-col-md-12"><div class="moo-form-group"><div class="moo-form-control" id="moo\_CloverCardNumber"></div><div class="card-number-error"><div class="clover-error"></div></div></div></div></div>'; |
| [2678](#L2678) | $dateAndCvv = '<div class="moo-row"><div class="moo-col-md-6"><div class="moo-form-group"><div class="moo-form-control" id="moo\_CloverCardDate"></div><div class="date-error"><div class="clover-error"></div></div></div></div><div class="moo-col-md-6"><div class="moo-form-group"><div class="moo-form-control" id="moo\_CloverCardCvv"></div><div class="cvv-error"><div class="clover-error"></div></div></div></div></div>'; |
| [2679](#L2679) | $address    = '<div class="moo-row"><div class="moo-col-md-12"><div class="moo-form-group"><div class="moo-form-control" id="moo\_CloverStreetAddress"></div><div class="streetAddress-error"><div class="clover-error"></div></div></div></div></div>'; |
| [2680](#L2680) | $zip        = '<div class="moo-row"><div class="moo-col-md-12"><div class="moo-form-group"><div class="moo-form-control" id="moo\_CloverCardZip"></div><div class="zip-error"><div class="clover-error"></div></div></div></div></div>'; |
| [2681](#L2681) | $html = $htmBegin . $cardNumber . $dateAndCvv; |
| [2682](#L2682) | if ($this->showStreetAddressFieldOnPaymentForm) { |
| [2683](#L2683) | $html .= $address; |
| [2684](#L2684) | } |
| [2685](#L2685) | $html .= $zip . $htmEnd; |
| [2686](#L2686) | $html = apply\_filters('moo\_filter\_checkout\_cloverCard', $html); |
| [2687](#L2687) | echo  $html; |
| [2688](#L2688) | } |
| [2689](#L2689) | private function creditCardSelectorOld() |
| [2690](#L2690) | { |
| [2691](#L2691) | $payString = \_\_("Pay now with Credit Card", "moo\_OnlineOrders"); |
| [2692](#L2692) | $html = <<<HTML |
| [2693](#L2693) | <div class="moo-checkout-form-payments-option"> |
| [2694](#L2694) | <input class="moo-checkout-form-payments-input" type="radio" name="payments" value="clover" id="moo-checkout-form-payments-clover"> |
| [2695](#L2695) | <label for="moo-checkout-form-payments-clover" style="display: inline;margin-left:15px;font-size: 16px; vertical-align: sub;">$payString</label> |
| [2696](#L2696) | </div> |
| [2697](#L2697) | HTML; |
| [2698](#L2698) | $html = apply\_filters('moo\_filter\_checkout\_creditCardSelector', $html); |
| [2699](#L2699) | echo  $html; |
| [2700](#L2700) | } |
| [2701](#L2701) | private function cashSelectorOld() |
| [2702](#L2702) | { |
| [2703](#L2703) | $payString = \_\_("Pay at location", "moo\_OnlineOrders"); |
| [2704](#L2704) | $html = <<<HTML |
| [2705](#L2705) | <div class="moo-checkout-form-payments-option moo-checkout-form-payments-cash-container"> |
| [2706](#L2706) | <input class="moo-checkout-form-payments-input" type="radio" name="payments" value="cash" id="moo-checkout-form-payments-cash"> |
| [2707](#L2707) | <label for="moo-checkout-form-payments-cash" style="display: inline;margin-left:15px;font-size: 16px; vertical-align: sub;" id="moo-checkout-form-payincash-label">$payString</label> |
| [2708](#L2708) | </div> |
| [2709](#L2709) | HTML; |
| [2710](#L2710) | $html = apply\_filters('moo\_filter\_checkout\_cashSelector', $html); |
| [2711](#L2711) | echo  $html; |
| [2712](#L2712) | } |
| [2713](#L2713) |  |
| [2714](#L2714) | private function borderBottom() |
| [2715](#L2715) | { |
| [2716](#L2716) | echo '<div class="moo\_checkout\_border\_bottom"></div>'; |
| [2717](#L2717) | } |
| [2718](#L2718) | private function checkCloverFraudTools($openingHours) |
| [2719](#L2719) | { |
| [2720](#L2720) | if (isset($openingHours["fraudTools"]) && |
| [2721](#L2721) | isset($openingHours["fraudTools"]["validateStreetAddressMatch"]) && |
| [2722](#L2722) | isset($openingHours["fraudTools"]["validateStreetAddressProvided"]) && |
| [2723](#L2723) | isset($openingHours["fraudTools"]["validateStreetAddressVerified"]) |
| [2724](#L2724) | ) { |
| [2725](#L2725) | return $openingHours["fraudTools"]["validateStreetAddressMatch"] || $openingHours["fraudTools"]["validateStreetAddressProvided"] || $openingHours["fraudTools"]["validateStreetAddressVerified"]; |
| [2726](#L2726) | } |
| [2727](#L2727) | return false; |
| [2728](#L2728) | } |
| [2729](#L2729) |  |
| [2730](#L2730) | private function getOpeningMessage($oppening\_status) |
| [2731](#L2731) | { |
| [2732](#L2732) | $oppening\_msg = ""; |
| [2733](#L2733) | if ($this->pluginSettings['hours'] != 'all' ) { |
| [2734](#L2734) | if(!$oppening\_status || $oppening\_status["status"] == 'close'){ |
| [2735](#L2735) | if (isset($this->pluginSettings["closing\_msg"]) && $this->pluginSettings["closing\_msg"] !== '') { |
| [2736](#L2736) | $oppening\_msg = '<div class="moo-alert moo-alert-danger" role="alert" id="moo\_checkout\_msg">'.$this->pluginSettings["closing\_msg"].'</div>'; |
| [2737](#L2737) | } else { |
| [2738](#L2738) | $oppening\_msg = '<div class="moo-alert moo-alert-danger" role="alert" id="moo\_checkout\_msg">'; |
| [2739](#L2739) | if (!empty($oppening\_status["store\_time"])) { |
| [2740](#L2740) | $oppening\_msg .= "<strong>".\_\_("Today's Online Ordering Hours", "moo\_OnlineOrders")."</strong><br/> ".$oppening\_status["store\_time"]."<br/> "; |
| [2741](#L2741) | } |
| [2742](#L2742) | $oppening\_msg .= \_\_("Online Ordering Currently Closed", "moo\_OnlineOrders"); |
| [2743](#L2743) | if (isset($this->pluginSettings['accept\_orders\_w\_closed']) && $this->pluginSettings['accept\_orders\_w\_closed'] == 'on') { |
| [2744](#L2744) | $oppening\_msg .= "<br/><p style='color: #006b00'>"; |
| [2745](#L2745) | $oppening\_msg .= \_\_("You may schedule your order in advance", "moo\_OnlineOrders"); |
| [2746](#L2746) | $oppening\_msg .= "</p>"; |
| [2747](#L2747) | } |
| [2748](#L2748) | $oppening\_msg .= '</div>'; |
| [2749](#L2749) | } |
| [2750](#L2750) | } |
| [2751](#L2751) | if (!empty($oppening\_status["status"]) && $oppening\_status["status"] === 'not\_found'){ |
| [2752](#L2752) | $oppening\_msg .= '<div class="moo-alert moo-alert-danger" role="alert" id="moo\_checkout\_msg">Please contact the Store to update their Online Ordering Hours</div>'; |
| [2753](#L2753) | } |
| [2754](#L2754) |  |
| [2755](#L2755) | } |
| [2756](#L2756) | return $oppening\_msg; |
| [2757](#L2757) | } |
| [2758](#L2758) |  |
| [2759](#L2759) | private function getOrderingPageLink() { |
| [2760](#L2760) | if (!empty( $this->pluginSettings['store\_page'] )){ |
| [2761](#L2761) | return get\_page\_link($this->pluginSettings['store\_page']); |
| [2762](#L2762) | } |
| [2763](#L2763) | return null; |
| [2764](#L2764) | } |
| [2765](#L2765) | private function getCartPageLink() { |
| [2766](#L2766) | if (!empty( $this->pluginSettings['cart\_page'] )){ |
| [2767](#L2767) | return get\_page\_link($this->pluginSettings['cart\_page']); |
| [2768](#L2768) | } |
| [2769](#L2769) | return null; |
| [2770](#L2770) | } |
| [2771](#L2771) |  |
| [2772](#L2772) | private function isApplePayEnabled() |
| [2773](#L2773) | { |
| [2774](#L2774) | return (bool) get\_option("moo\_apple\_pay\_enabled",false); |
| [2775](#L2775) | } |
| [2776](#L2776) |  |
| [2777](#L2777) | private function getMerchantUuid() { |
| [2778](#L2778) | if ($this->isApplePayEnabled()) { |
| [2779](#L2779) | return $this->api->getMerchantUuid(); |
| [2780](#L2780) | } |
| [2781](#L2781) | return null; |
| [2782](#L2782) | } |
| [2783](#L2783) | } |

**Note:** See [TracBrowser](/wiki/TracBrowser)
for help on using the repository browser.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Plain Text](/browser/clover-online-orders/trunk/includes/shortcodes/checkoutPage.php?format=txt)
* [Original Format](/export/3220478/clover-online-orders/trunk/includes/shortcodes/checkoutPage.php)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)



=== Content from plugins.trac.wordpress.org_b86a4ad0_20250110_221730.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fbrowser%2Fclover-online-orders%2Ftrunk%2Fmoo_OnlineOrders.php)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Revision](/browser/clover-online-orders/trunk/moo_OnlineOrders.php?rev=3168433 "Revision 3168433")
* Next Revision →
* [Blame](/browser/clover-online-orders/trunk/moo_OnlineOrders.php?annotate=blame "Annotate each line with the last changed revision (this can be time consuming...)")
* [Revision Log](/log/clover-online-orders/trunk/moo_OnlineOrders.php)

---

# [source:](/browser?order=name "Go to repository root") [clover-online-orders](/browser/clover-online-orders?order=name "View clover-online-orders")/[trunk](/browser/clover-online-orders/trunk?order=name "View trunk")/[moo\_OnlineOrders.php](/browser/clover-online-orders/trunk/moo_OnlineOrders.php?order=name "View moo_OnlineOrders.php")

View diff against:

View revision:

| [Last change](/changeset/3209744/clover-online-orders/trunk/moo_OnlineOrders.php "View differences") on this file was [3209744](/changeset/3209744/ "View changeset 3209744"), checked in by elbanyaoui, [3 weeks ago](/timeline?from=2024-12-18T10%3A01%3A14Z&precision=second "See timeline at 12/18/2024 10:01:14 AM") |
| --- |
| version 1.5.9 |
| **File size:** 10.0 KB | |

| Line |  |
| --- | --- |
| [1](#L1) | <?php |
| [2](#L2) |  |
| [3](#L3) | /\*\* |
| [4](#L4) | \* The plugin bootstrap file |
| [5](#L5) | \* |
| [6](#L6) | \* This file is read by WordPress to generate the plugin information in the plugin |
| [7](#L7) | \* admin area. This file also includes all of the dependencies used by the plugin, |
| [8](#L8) | \* registers the activation and deactivation functions, and defines a function |
| [9](#L9) | \* that starts the plugin. |
| [10](#L10) | \* |
| [11](#L11) | \* @link              https://www.zaytech.com |
| [12](#L12) | \* @since             1.0.0 |
| [13](#L13) | \* @package           Wordpress\_Integration |
| [14](#L14) | \* |
| [15](#L15) | \* @wordpress-plugin |
| [16](#L16) | \* Plugin Name:       Smart Online Order for Clover |
| [17](#L17) | \* Plugin URI:        https://www.zaytech.com |
| [18](#L18) | \* Description:       Start taking orders from your Wordpress website and have them sent to your Clover Station |
| [19](#L19) | \* Version:           1.5.9 |
| [20](#L20) | \* Author:            Zaytech |
| [21](#L21) | \* Author URI:        https://www.zaytech.com |
| [22](#L22) | \* License:           GPLv2 or later |
| [23](#L23) | \* License URI:       http://www.gnu.org/licenses/gpl-2.0.html |
| [24](#L24) | \* Text Domain:       moo\_OnlineOrders |
| [25](#L25) | \* Domain Path:       /languages |
| [26](#L26) | \*/ |
| [27](#L27) |  |
| [28](#L28) | // If this file is called directly, abort. |
| [29](#L29) | if (! defined('WPINC')) { |
| [30](#L30) | die; |
| [31](#L31) | } |
| [32](#L32) |  |
| [33](#L33) | define( |
| [34](#L34) | 'SOO\_PLUGIN\_URL', |
| [35](#L35) | untrailingslashit(plugins\_url(basename(plugin\_dir\_path(\_\_FILE\_\_)), basename(\_\_FILE\_\_))) |
| [36](#L36) | ); |
| [37](#L37) | define('SOO\_PLUGIN\_PATH', untrailingslashit(plugin\_dir\_path(\_\_FILE\_\_))); |
| [38](#L38) | define('SOO\_ENV', 'PROD'); |
| [39](#L39) | define('SOO\_DEFAULT\_CDN', false); |
| [40](#L40) | define('SOO\_VERSION', "1.5.9"); |
| [41](#L41) | define('SOO\_G\_RECAPTCHA\_URL', 'https://www.google.com/recaptcha/api/siteverify'); |
| [42](#L42) | define('SOO\_DEBUG', false); |
| [43](#L43) |  |
| [44](#L44) | /\*\* |
| [45](#L45) | \* The core plugin class that is used to define internationalization, |
| [46](#L46) | \* admin-specific hooks, and public-facing site hooks. |
| [47](#L47) | \*/ |
| [48](#L48) | require plugin\_dir\_path(\_\_FILE\_\_) . 'includes/moo-OnlineOrders.php'; |
| [49](#L49) |  |
| [50](#L50) | /\*\* |
| [51](#L51) | \* Helper functions |
| [52](#L52) | \*/ |
| [53](#L53) | require plugin\_dir\_path(\_\_FILE\_\_) . 'includes/moo-OnlineOrders-helpers.php'; |
| [54](#L54) |  |
| [55](#L55) | require plugin\_dir\_path(\_\_FILE\_\_) . 'includes/moo-OnlineOrders-deactivator.php'; |
| [56](#L56) | //Moo\_OnlineOrders\_Deactivator::onlyClean(); |
| [57](#L57) |  |
| [58](#L58) | /\*\* |
| [59](#L59) | \* The code that runs during plugin activation. |
| [60](#L60) | \* This action is documented in includes/moo-OnlineOrders-activator.php |
| [61](#L61) | \*/ |
| [62](#L62) | function activate\_moo\_OnlineOrders($network\_wide) { |
| [63](#L63) | require\_once plugin\_dir\_path(\_\_FILE\_\_) . 'includes/moo-OnlineOrders-activator.php'; |
| [64](#L64) | if (function\_exists('is\_multisite') && is\_multisite() && $network\_wide) { |
| [65](#L65) | Moo\_OnlineOrders\_Activator::activateOnNetwork(); |
| [66](#L66) | return; |
| [67](#L67) | } |
| [68](#L68) | Moo\_OnlineOrders\_Activator::activate(); |
| [69](#L69) | } |
| [70](#L70) |  |
| [71](#L71) | /\*\* |
| [72](#L72) | \* The code that runs during plugin deactivation. |
| [73](#L73) | \* This action is documented in includes/moo-OnlineOrders-deactivator.php |
| [74](#L74) | \*/ |
| [75](#L75) | function deactivate\_moo\_OnlineOrders() { |
| [76](#L76) | require\_once plugin\_dir\_path(\_\_FILE\_\_) . 'includes/moo-OnlineOrders-deactivator.php'; |
| [77](#L77) | Moo\_OnlineOrders\_Deactivator::deactivate(); |
| [78](#L78) | } |
| [79](#L79) | function moo\_OnlineOrders\_shortcodes\_allitems($atts, $content) { |
| [80](#L80) | require\_once plugin\_dir\_path(\_\_FILE\_\_) . 'includes/shortcodes/storePage.php'; |
| [81](#L81) | $shortCode = new storePage(); |
| [82](#L82) | return $shortCode->render($atts, $content); |
| [83](#L83) | } |
| [84](#L84) | function moo\_OnlineOrders\_shortcodes\_checkoutPage($atts, $content) { |
| [85](#L85) | require\_once plugin\_dir\_path(\_\_FILE\_\_) . 'includes/shortcodes/checkoutPage.php'; |
| [86](#L86) | $checkoutPage = new CheckoutPage(); |
| [87](#L87) | return $checkoutPage->render($atts, $content); |
| [88](#L88) | } |
| [89](#L89) | function moo\_OnlineOrders\_shortcodes\_receiptLinkInThanksPage($atts, $content) { |
| [90](#L90) | require\_once plugin\_dir\_path(\_\_FILE\_\_) . 'includes/shortcodes/checkoutPage.php'; |
| [91](#L91) | $checkoutPage = new CheckoutPage(); |
| [92](#L92) | return $checkoutPage->renderReceiptLink($atts, $content); |
| [93](#L93) | } |
| [94](#L94) | function moo\_OnlineOrders\_shortcodes\_buybutton($atts, $content) { |
| [95](#L95) | require\_once plugin\_dir\_path(\_\_FILE\_\_) . 'includes/shortcodes/addToCartButton.php'; |
| [96](#L96) | $shortCode = new addToCartButton(); |
| [97](#L97) | return $shortCode->render($atts, $content); |
| [98](#L98) | } |
| [99](#L99) | function moo\_OnlineOrders\_shortcodes\_thecart($atts, $content) { |
| [100](#L100) | require\_once plugin\_dir\_path(\_\_FILE\_\_) . 'includes/shortcodes/cartPage.php'; |
| [101](#L101) | $cartPage = new CartPage(); |
| [102](#L102) | return $cartPage->render($atts, $content); |
| [103](#L103) | } |
| [104](#L104) | function moo\_OnlineOrders\_shortcodes\_giftcards\_balance($atts, $content) { |
| [105](#L105) | require\_once plugin\_dir\_path(\_\_FILE\_\_) . 'includes/shortcodes/GiftCardBalance.php'; |
| [106](#L106) | $cartPage = new giftCardBalance(); |
| [107](#L107) | return $cartPage->render($atts, $content); |
| [108](#L108) | } |
| [109](#L109) | function moo\_OnlineOrders\_shortcodes\_searchBar($atts, $content) { |
| [110](#L110) | require\_once plugin\_dir\_path(\_\_FILE\_\_) . 'includes/shortcodes/searchBar.php'; |
| [111](#L111) | $shortCode = new searchBar(); |
| [112](#L112) | return $shortCode->render($atts, $content); |
| [113](#L113) | } |
| [114](#L114) | function moo\_OnlineOrders\_shortcodes\_customerAccount($atts, $content) { |
| [115](#L115) | require\_once plugin\_dir\_path(\_\_FILE\_\_) . 'includes/shortcodes/myOrdersPage.php'; |
| [116](#L116) | $shortCode = new myOrdersPage(); |
| [117](#L117) | return $shortCode->render($atts, $content); |
| [118](#L118) | } |
| [119](#L119) |  |
| [120](#L120) | function moo\_OnlineOrders\_shortcodes\_categorymsg($atts, $content) { |
| [121](#L121) | if (isset($atts["cat\_id"]) && !empty($atts["message"])) { |
| [122](#L122) | if (isset($\_GET["category"]) && $\_GET["category"] == $atts["cat\_id"]) { |
| [123](#L123) | if (!empty($atts["css-class"])) { |
| [124](#L124) | return "<div class='".esc\_attr($atts["css-class"])."'>".esc\_attr($atts["message"])."</div>"; |
| [125](#L125) | } else { |
| [126](#L126) | return esc\_attr($atts["message"]); |
| [127](#L127) | } |
| [128](#L128) | } |
| [129](#L129) | } else { |
| [130](#L130) | return "Please enter the category id (cat\_id) and the message"; |
| [131](#L131) | } |
| [132](#L132) | } |
| [133](#L133) |  |
| [134](#L134) |  |
| [135](#L135) | /\* |
| [136](#L136) | \* Widgets Contents |
| [137](#L137) | \*/ |
| [138](#L138) | function moo\_OnlineOrders\_widget\_opening\_hours() { |
| [139](#L139) | require\_once plugin\_dir\_path(\_\_FILE\_\_) . 'includes/moo-OnlineOrders-widgets.php'; |
| [140](#L140) | register\_widget('Moo\_OnlineOrders\_Widgets\_Opening\_hours'); |
| [141](#L141) | } |
| [142](#L142) | function moo\_OnlineOrders\_widget\_best\_selling() { |
| [143](#L143) | require\_once plugin\_dir\_path(\_\_FILE\_\_) . 'includes/moo-OnlineOrders-widgets.php'; |
| [144](#L144) | register\_widget('Moo\_OnlineOrders\_Widgets\_best\_selling'); |
| [145](#L145) | } |
| [146](#L146) | function Moo\_OnlineOrders\_Widgets\_categories() { |
| [147](#L147) | require\_once plugin\_dir\_path(\_\_FILE\_\_) . 'includes/moo-OnlineOrders-widgets.php'; |
| [148](#L148) | register\_widget('Moo\_OnlineOrders\_Widgets\_categories'); |
| [149](#L149) | } |
| [150](#L150) |  |
| [151](#L151) | function moo\_OnlineOrders\_RestAPI() { |
| [152](#L152) | require\_once plugin\_dir\_path(\_\_FILE\_\_) . 'includes/moo-OnlineOrders-Restapi.php'; |
| [153](#L153) | $rest\_api = new Moo\_OnlineOrders\_Restapi(); |
| [154](#L154) | $rest\_api->register\_routes(); |
| [155](#L155) | } |
| [156](#L156) |  |
| [157](#L157) | /\* Activate and deactivate hooks\*/ |
| [158](#L158) | register\_activation\_hook(\_\_FILE\_\_, 'activate\_moo\_OnlineOrders'); |
| [159](#L159) | register\_deactivation\_hook(\_\_FILE\_\_, 'deactivate\_moo\_OnlineOrders'); |
| [160](#L160) |  |
| [161](#L161) | /\* adding shortcodes \*/ |
| [162](#L162) | add\_shortcode('moo\_all\_items', 'moo\_OnlineOrders\_shortcodes\_allitems'); |
| [163](#L163) | add\_shortcode('moo\_cart', 'moo\_OnlineOrders\_shortcodes\_thecart'); |
| [164](#L164) | add\_shortcode('moo\_checkout', 'moo\_OnlineOrders\_shortcodes\_checkoutPage'); |
| [165](#L165) | add\_shortcode('moo\_my\_account', 'moo\_OnlineOrders\_shortcodes\_customerAccount'); |
| [166](#L166) |  |
| [167](#L167) | add\_shortcode('moo\_buy\_button', 'moo\_OnlineOrders\_shortcodes\_buybutton'); |
| [168](#L168) | add\_shortcode('moo\_category\_msg', 'moo\_OnlineOrders\_shortcodes\_categorymsg'); |
| [169](#L169) | add\_shortcode('moo\_search', 'moo\_OnlineOrders\_shortcodes\_searchBar'); |
| [170](#L170) | add\_shortcode('moo\_receipt\_link', 'moo\_OnlineOrders\_shortcodes\_receiptLinkInThanksPage'); |
| [171](#L171) |  |
| [172](#L172) | //Gift Cards Shortcodes |
| [173](#L173) | add\_shortcode('moo\_giftcards\_balance', 'moo\_OnlineOrders\_shortcodes\_giftcards\_balance'); |
| [174](#L174) |  |
| [175](#L175) | /\* adding widgets\*/ |
| [176](#L176) | add\_action('widgets\_init', 'moo\_OnlineOrders\_widget\_opening\_hours'); |
| [177](#L177) | add\_action('widgets\_init', 'moo\_OnlineOrders\_widget\_best\_selling'); |
| [178](#L178) | add\_action('widgets\_init', 'Moo\_OnlineOrders\_Widgets\_categories'); |
| [179](#L179) |  |
| [180](#L180) | /\* Rest Api \*/ |
| [181](#L181) | add\_action('rest\_api\_init', 'moo\_OnlineOrders\_RestAPI'); |
| [182](#L182) |  |
| [183](#L183) | // add links to plugin |
| [184](#L184) |  |
| [185](#L185) | add\_filter('plugin\_action\_links\_' . plugin\_basename(\_\_FILE\_\_), 'moo\_add\_action\_links'); |
| [186](#L186) |  |
| [187](#L187) | function moo\_add\_action\_links($links) |
| [188](#L188) | { |
| [189](#L189) | $plugin\_links\_1 = array( |
| [190](#L190) | '<a href="admin.php?page=moo\_index">Settings</a>', |
| [191](#L191) | '<a href="https://docs.zaytech.com/">Docs</a>', |
| [192](#L192) | '<a href="https://zaytech.com/support/">Support</a>', |
| [193](#L193) | ); |
| [194](#L194) |  |
| [195](#L195) | return array\_merge($plugin\_links\_1, $links); |
| [196](#L196) | } |
| [197](#L197) | function moo\_deactivateAndClean() { |
| [198](#L198) | if (current\_user\_can( 'manage\_options' ) && isset($\_GET['page']) &&  $\_GET['page'] === 'moo\_deactivateAndClean') { |
| [199](#L199) | require\_once plugin\_dir\_path(\_\_FILE\_\_)."/includes/moo-OnlineOrders-deactivator.php"; |
| [200](#L200) |  |
| [201](#L201) | if (function\_exists("is\_plugin\_active\_for\_network") && !is\_plugin\_active\_for\_network(plugin\_basename(\_\_FILE\_\_))) { |
| [202](#L202) | Moo\_OnlineOrders\_Deactivator::deactivateAndClean(); |
| [203](#L203) | deactivate\_plugins(plugin\_basename(\_\_FILE\_\_), true); |
| [204](#L204) | } else { |
| [205](#L205) | Moo\_OnlineOrders\_Deactivator::onlyClean(); |
| [206](#L206) | } |
| [207](#L207) |  |
| [208](#L208) | $url = admin\_url('plugins.php?deactivate=true'); |
| [209](#L209) | header("Location: $url"); |
| [210](#L210) | die(); |
| [211](#L211) | } |
| [212](#L212) | } |
| [213](#L213) | add\_action('admin\_init', 'moo\_deactivateAndClean'); |
| [214](#L214) |  |
| [215](#L215) | if (get\_option('moo\_onlineOrders\_version') != '159') { |
| [216](#L216) | add\_action('plugins\_loaded', 'moo\_onlineOrders\_check\_version'); |
| [217](#L217) | add\_action('plugins\_loaded', 'moo\_schedule\_cron\_tasks'); |
| [218](#L218) | } |
| [219](#L219) |  |
| [220](#L220) |  |
| [221](#L221) |  |
| [222](#L222) | /\* |
| [223](#L223) | \* This function for updating the database structure when the version changed and updated it automatically |
| [224](#L224) | \* |
| [225](#L225) | \* @since v 1.1.2 |
| [226](#L226) | \*/ |
| [227](#L227) | function moo\_onlineOrders\_check\_version() { |
| [228](#L228) | $version = get\_option('moo\_onlineOrders\_version'); |
| [229](#L229) | if (empty($version)) { |
| [230](#L230) | $version = 120; |
| [231](#L231) | } else { |
| [232](#L232) | $version = intval($version); |
| [233](#L233) | } |
| [234](#L234) |  |
| [235](#L235) | if (! class\_exists( 'Moo\_OnlineOrders\_Helpers' ) ){ |
| [236](#L236) | require\_once SOO\_PLUGIN\_PATH ."/includes/moo-OnlineOrders-helpers.php"; |
| [237](#L237) | } |
| [238](#L238) | try { |
| [239](#L239) | //Upgrade Database |
| [240](#L240) | if ($version <= 136 ) { |
| [241](#L241) | Moo\_OnlineOrders\_Helpers::upgradeDatabaseToVersion136(); |
| [242](#L242) | } |
| [243](#L243) | if ( $version <= 150 ) { |
| [244](#L244) | Moo\_OnlineOrders\_Helpers::upgradeDatabaseToVersion150(); |
| [245](#L245) | } |
| [246](#L246) | if ( $version <= 158 ) { |
| [247](#L247) | Moo\_OnlineOrders\_Helpers::upgradeDatabaseToVersion158(); |
| [248](#L248) | } |
| [249](#L249) | } catch (Exception $e){} |
| [250](#L250) |  |
| [251](#L251) |  |
| [252](#L252) | //Apply default options |
| [253](#L253) | $defaultOptions = get\_option('moo\_settings'); |
| [254](#L254) | Moo\_OnlineOrders\_Helpers::applyDefaultOptions($defaultOptions); |
| [255](#L255) | update\_option("moo\_settings", $defaultOptions); |
| [256](#L256) | //Upgrade version |
| [257](#L257) | update\_option('moo\_onlineOrders\_version', '159'); |
| [258](#L258) | } |
| [259](#L259) |  |
| [260](#L260) | function moo\_schedule\_cron\_tasks() { |
| [261](#L261) | require\_once plugin\_dir\_path(\_\_FILE\_\_) . 'includes/moo-OnlineOrders-activator.php'; |
| [262](#L262) | Moo\_OnlineOrders\_Activator::scheduleCronTasks(); |
| [263](#L263) | } |
| [264](#L264) |  |
| [265](#L265) | /\*\* |
| [266](#L266) | \* Begins execution of the plugin. |
| [267](#L267) | \* |
| [268](#L268) | \* Since everything within the plugin is registered via hooks, |
| [269](#L269) | \* then kicking off the plugin from this point in the file does |
| [270](#L270) | \* not affect the page life cycle. |
| [271](#L271) | \* |
| [272](#L272) | \* @since    1.0.0 |
| [273](#L273) | \*/ |
| [274](#L274) | function run\_moo\_OnlineOrders() |
| [275](#L275) | { |
| [276](#L276) | $plugin = new moo\_OnlineOrders(); |
| [277](#L277) | $plugin->run(); |
| [278](#L278) | } |
| [279](#L279) | run\_moo\_OnlineOrders(); |

**Note:** See [TracBrowser](/wiki/TracBrowser)
for help on using the repository browser.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Plain Text](/browser/clover-online-orders/trunk/moo_OnlineOrders.php?format=txt)
* [Original Format](/export/3220478/clover-online-orders/trunk/moo_OnlineOrders.php)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)



=== Content from plugins.trac.wordpress.org_c37eec32_20250110_221736.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fchangeset%2F3168433)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Changeset](/changeset/3168432 "Changeset 3168432")
* [Next Changeset](/changeset/3168434 "Changeset 3168434") →

---

# Changeset 3168433

View differences
inline
side by side

Show
lines around each change

Show the changes in full context

Ignore:

Blank lines

Case changes

White space changes

Timestamp:
10/14/2024 09:48:12 AM
([3 months](/timeline?from=2024-10-14T09%3A48%3A12Z&precision=second "See timeline at 10/14/2024 09:48:12 AM") ago)

Author:
elbanyaoui
Message:

version 1.5.8

Location:
[clover-online-orders/trunk](/browser/clover-online-orders/trunk?rev=3168433)
Files:

1 added
25 edited

* [admin/css/moo-OnlineOrders-admin.css](/browser/clover-online-orders/trunk/admin/css/moo-OnlineOrders-admin.css?rev=3168433 "Show entry in browser")
  (modified)
  ([3 diffs](#file0 "Show differences"))
* [admin/includes/class-moo-coupons-list.php](/browser/clover-online-orders/trunk/admin/includes/class-moo-coupons-list.php?rev=3168433 "Show entry in browser")
  (modified)
  ([12 diffs](#file1 "Show differences"))
* [admin/includes/class-moo-orders-list.php](/browser/clover-online-orders/trunk/admin/includes/class-moo-orders-list.php?rev=3168433 "Show entry in browser")
  (modified)
  ([3 diffs](#file2 "Show differences"))
* [admin/includes/class-moo-products-list.php](/browser/clover-online-orders/trunk/admin/includes/class-moo-products-list.php?rev=3168433 "Show entry in browser")
  (modified)
  ([21 diffs](#file3 "Show differences"))
* [admin/includes/class-wp-list-table-moo.php](/browser/clover-online-orders/trunk/admin/includes/class-wp-list-table-moo.php?rev=3168433 "Show entry in browser")
  (modified)
  ([19 diffs](#file4 "Show differences"))
* [admin/js/moo-OnlineOrders-admin.js](/browser/clover-online-orders/trunk/admin/js/moo-OnlineOrders-admin.js?rev=3168433 "Show entry in browser")
  (modified)
  ([9 diffs](#file5 "Show differences"))
* [admin/moo-OnlineOrders-admin.php](/browser/clover-online-orders/trunk/admin/moo-OnlineOrders-admin.php?rev=3168433 "Show entry in browser")
  (modified)
  ([11 diffs](#file6 "Show differences"))
* [includes/moo-OnlineOrders-Restapi.php](/browser/clover-online-orders/trunk/includes/moo-OnlineOrders-Restapi.php?rev=3168433 "Show entry in browser")
  (modified)
  ([5 diffs](#file7 "Show differences"))
* [includes/moo-OnlineOrders-activator.php](/browser/clover-online-orders/trunk/includes/moo-OnlineOrders-activator.php?rev=3168433 "Show entry in browser")
  (modified)
  ([4 diffs](#file8 "Show differences"))
* [includes/moo-OnlineOrders-helpers.php](/browser/clover-online-orders/trunk/includes/moo-OnlineOrders-helpers.php?rev=3168433 "Show entry in browser")
  (modified)
  ([2 diffs](#file9 "Show differences"))
* [includes/moo-OnlineOrders-sooapi.php](/browser/clover-online-orders/trunk/includes/moo-OnlineOrders-sooapi.php?rev=3168433 "Show entry in browser")
  (modified)
  ([4 diffs](#file10 "Show differences"))
* [includes/moo-OnlineOrders-widgets.php](/browser/clover-online-orders/trunk/includes/moo-OnlineOrders-widgets.php?rev=3168433 "Show entry in browser")
  (modified)
  ([5 diffs](#file11 "Show differences"))
* [includes/restapi/CheckoutRoutes.php](/browser/clover-online-orders/trunk/includes/restapi/CheckoutRoutes.php?rev=3168433 "Show entry in browser")
  (modified)
  ([2 diffs](#file12 "Show differences"))
* [includes/restapi/DashboardRoutes.php](/browser/clover-online-orders/trunk/includes/restapi/DashboardRoutes.php?rev=3168433 "Show entry in browser")
  (modified)
  ([16 diffs](#file13 "Show differences"))
* [includes/shortcodes/addToCartButton.php](/browser/clover-online-orders/trunk/includes/shortcodes/addToCartButton.php?rev=3168433 "Show entry in browser")
  (modified)
  ([1 diff](#file14 "Show differences"))
* [includes/shortcodes/checkoutPage.php](/browser/clover-online-orders/trunk/includes/shortcodes/checkoutPage.php?rev=3168433 "Show entry in browser")
  (modified)
  ([15 diffs](#file15 "Show differences"))
* [includes/shortcodes/storePage.php](/browser/clover-online-orders/trunk/includes/shortcodes/storePage.php?rev=3168433 "Show entry in browser")
  (modified)
  ([2 diffs](#file16 "Show differences"))
* [models/moo-OnlineOrders-Model.php](/browser/clover-online-orders/trunk/models/moo-OnlineOrders-Model.php?rev=3168433 "Show entry in browser")
  (modified)
  ([4 diffs](#file17 "Show differences"))
* [moo\_OnlineOrders.php](/browser/clover-online-orders/trunk/moo_OnlineOrders.php?rev=3168433 "Show entry in browser")
  (modified)
  ([5 diffs](#file18 "Show differences"))
* [public/css/dist/blueX2.png](/browser/clover-online-orders/trunk/public/css/dist/blueX2.png?rev=3168433 "Show entry in browser")
  (added)
* [public/css/dist/icheck-blue.min.css](/browser/clover-online-orders/trunk/public/css/dist/icheck-blue.min.css?rev=3168433 "Show entry in browser")
  (modified)
  ([1 diff](#file20 "Show differences"))
* [public/css/dist/sooCheckout-light.min.css](/browser/clover-online-orders/trunk/public/css/dist/sooCheckout-light.min.css?rev=3168433 "Show entry in browser")
  (modified)
  ([1 diff](#file21 "Show differences"))
* [public/js/dist/sooCheckout.min.js](/browser/clover-online-orders/trunk/public/js/dist/sooCheckout.min.js?rev=3168433 "Show entry in browser")
  (modified)
  ([1 diff](#file22 "Show differences"))
* [public/js/dist/sooSearchbar.min.js](/browser/clover-online-orders/trunk/public/js/dist/sooSearchbar.min.js?rev=3168433 "Show entry in browser")
  (modified)
  ([1 diff](#file23 "Show differences"))
* [readme.txt](/browser/clover-online-orders/trunk/readme.txt?rev=3168433 "Show entry in browser")
  (modified)
  ([3 diffs](#file24 "Show differences"))
* [uninstall.php](/browser/clover-online-orders/trunk/uninstall.php?rev=3168433 "Show entry in browser")
  (modified)
  ([6 diffs](#file25 "Show differences"))

### Legend:

Unmodified
Added
Removed

* ## [clover-online-orders/trunk/admin/css/moo-OnlineOrders-admin.css](/changeset/3168433/clover-online-orders/trunk/admin/css/moo-OnlineOrders-admin.css "Show the changeset 3168433 restricted to clover-online-orders/trunk/admin/css/moo-OnlineOrders-admin.css")

  | [r3142846](/browser/clover-online-orders/trunk/admin/css/moo-OnlineOrders-admin.css?rev=3142846#L401 "Show revision 3142846 of this file in browser") | [r3168433](/browser/clover-online-orders/trunk/admin/css/moo-OnlineOrders-admin.css?rev=3168433#L401 "Show revision 3168433 of this file in browser") |  |
  | --- | --- | --- |
  | 401 | 401 | } |
  | 402 | 402 |  |
  | 403 |  | #price,#price\_type,#unit\_name,#sku,#available |
  |  | 403 | #price,#price\_type,#unit\_name,#sku,#available,#visible |
  | 404 | 404 | { |
  | 405 | 405 | width: 102px; |
  | […](/browser/clover-online-orders/trunk/admin/css/moo-OnlineOrders-admin.css?rev=3142846#L407) | […](/browser/clover-online-orders/trunk/admin/css/moo-OnlineOrders-admin.css?rev=3168433#L407) |  |
  | 407 | 407 | #name |
  | 408 | 408 | { |
  | 409 |  | width: ~~20~~0px; |
  |  | 409 | width: 150px; |
  | 410 | 410 | } |
  | 411 | 411 | #outofstock,#custom\_hours |
  | […](/browser/clover-online-orders/trunk/admin/css/moo-OnlineOrders-admin.css?rev=3142846#L1191) | […](/browser/clover-online-orders/trunk/admin/css/moo-OnlineOrders-admin.css?rev=3168433#L1191) |  |
  | 1191 | 1191 | .moo\_hidden { |
  | 1192 | 1192 | display: none !important; |
  |  | 1193 | } |
  |  | 1194 | .soo-display-none { |
  |  | 1195 | display: none; |
  |  | 1196 | } |
  |  | 1197 | .soo-display-block{ |
  |  | 1198 | display: block; |
  | 1193 | 1199 | } |
  | 1194 | 1200 | /\* --- table category --- \*/ |
* ## [clover-online-orders/trunk/admin/includes/class-moo-coupons-list.php](/changeset/3168433/clover-online-orders/trunk/admin/includes/class-moo-coupons-list.php "Show the changeset 3168433 restricted to clover-online-orders/trunk/admin/includes/class-moo-coupons-list.php")

  | [r3142846](/browser/clover-online-orders/trunk/admin/includes/class-moo-coupons-list.php?rev=3142846#L2 "Show revision 3142846 of this file in browser") | [r3168433](/browser/clover-online-orders/trunk/admin/includes/class-moo-coupons-list.php?rev=3168433#L2 "Show revision 3168433 of this file in browser") |  |
  | --- | --- | --- |
  | 2 | 2 | require\_once 'class-wp-list-table-moo.php'; |
  | 3 | 3 | class Coupons\_List\_Moo extends WP\_List\_Table\_MOO { |
  |  | 4 | /\*\* |
  |  | 5 | \* @var mixed |
  |  | 6 | \*/ |
  |  | 7 | private $couponPageUrl; |
  |  | 8 |  |
  | 4 | 9 | /\*\* Class constructor \*/ |
  | 5 | 10 | public function \_\_construct() { |
  | 6 |  | parent::\_\_construct( array( |
  | 7 |  | 'singular' => \_\_( 'Order'), //singular name of the listed records |
  | 8 |  | 'plural'   => \_\_( 'Orders'), //plural name of the listed records |
  |  | 11 | $this->couponPageUrl = admin\_url('admin.php?page=moo\_coupons'); |
  |  | 12 | parent::\_\_construct( array( |
  |  | 13 | 'singular' => \_\_( 'Coupon',"moo\_OnlineOrders"), //singular name of the listed records |
  |  | 14 | 'plural'   => \_\_( 'Coupons',"moo\_OnlineOrders"), //plural name of the listed records |
  | 9 | 15 | 'ajax'     => false //should this table support ajax? |
  | 10 | 16 |  |
  | 11 | 17 | ) ); |
  | 12 |  | ~~//var\_dump('creating an Object');~~ |
  | 13 | 18 | /\*\* Process bulk action \*/ |
  | 14 | 19 | $this->process\_bulk\_action(); |
  | […](/browser/clover-online-orders/trunk/admin/includes/class-moo-coupons-list.php?rev=3142846#L23) | […](/browser/clover-online-orders/trunk/admin/includes/class-moo-coupons-list.php?rev=3168433#L28) |  |
  | 23 | 28 | \* @return mixed |
  | 24 | 29 | \*/ |
  | 25 |  | public ~~static~~ function get\_items( $per\_page = 20, $page\_number = 1 ) { |
  |  | 30 | public function get\_items( $per\_page = 20, $page\_number = 1 ) { |
  | 26 | 31 | global $wpdb; |
  | 27 | 32 | require\_once plugin\_dir\_path( dirname(\_\_FILE\_\_) )."../includes/moo-OnlineOrders-sooapi.php"; |
  | […](/browser/clover-online-orders/trunk/admin/includes/class-moo-coupons-list.php?rev=3142846#L37) | […](/browser/clover-online-orders/trunk/admin/includes/class-moo-coupons-list.php?rev=3168433#L42) |  |
  | 37 | 42 | /\*\* Text displayed when no customer data is available \*/ |
  | 38 | 43 | public function no\_items() { |
  | 39 |  | \_e( 'No Coupon available.'); |
  |  | 44 | \_e( 'No Coupon available.',"moo\_OnlineOrders"); |
  | 40 | 45 | } |
  | 41 | 46 |  |
  | […](/browser/clover-online-orders/trunk/admin/includes/class-moo-coupons-list.php?rev=3142846#L61) | […](/browser/clover-online-orders/trunk/admin/includes/class-moo-coupons-list.php?rev=3168433#L66) |  |
  | 61 | 66 | \* @return null|string |
  | 62 | 67 | \*/ |
  | 63 |  | public ~~static~~ function record\_count() { |
  |  | 68 | public function record\_count() { |
  | 64 | 69 | require\_once plugin\_dir\_path( dirname(\_\_FILE\_\_) )."../includes/moo-OnlineOrders-sooapi.php"; |
  | 65 | 70 | $api = new Moo\_OnlineOrders\_SooApi(); |
  | […](/browser/clover-online-orders/trunk/admin/includes/class-moo-coupons-list.php?rev=3142846#L129) | […](/browser/clover-online-orders/trunk/admin/includes/class-moo-coupons-list.php?rev=3168433#L134) |  |
  | 129 | 134 | $columns = array( |
  | 130 | 135 | 'cb'      => '<input type="checkbox" />', |
  | 131 |  | 'name'    => \_\_( 'Coupon Name'), |
  | 132 |  | 'code' => \_\_( 'Code'), |
  | 133 |  | 'value'    => \_\_( 'Value'), |
  | 134 |  | 'type'    => \_\_( 'Type'), |
  | 135 |  | 'minAmount'    => \_\_( 'Min Amount'), |
  | 136 |  | 'uses' => \_\_( 'Number of uses'), |
  | 137 |  | 'isEnabled' => \_\_( 'Is enabled ?'), |
  | 138 |  | 'expirationdate'    => \_\_( 'Expiry date') |
  |  | 136 | 'name'    => \_\_( 'Coupon Name',"moo\_OnlineOrders"), |
  |  | 137 | 'code' => \_\_( 'Code',"moo\_OnlineOrders"), |
  |  | 138 | 'value'    => \_\_( 'Value',"moo\_OnlineOrders"), |
  |  | 139 | 'type'    => \_\_( 'Type',"moo\_OnlineOrders"), |
  |  | 140 | 'minAmount'    => \_\_( 'Min Amount',"moo\_OnlineOrders"), |
  |  | 141 | 'uses' => \_\_( 'Number of uses',"moo\_OnlineOrders"), |
  |  | 142 | 'isEnabled' => \_\_( 'Is enabled ?',"moo\_OnlineOrders"), |
  |  | 143 | 'expirationdate'    => \_\_( 'Expiry date',"moo\_OnlineOrders") |
  | 139 | 144 | ); |
  | 140 | 145 |  |
  | […](/browser/clover-online-orders/trunk/admin/includes/class-moo-coupons-list.php?rev=3142846#L183) | […](/browser/clover-online-orders/trunk/admin/includes/class-moo-coupons-list.php?rev=3168433#L188) |  |
  | 183 | 188 | $per\_page     = $this->get\_items\_per\_page( 'moo\_items\_per\_page', 10 ); |
  | 184 | 189 | $current\_page = $this->get\_pagenum(); |
  | 185 |  | $total\_items  = ~~self::~~record\_count(); |
  |  | 190 | $total\_items  = $this->record\_count(); |
  | 186 | 191 |  |
  | 187 | 192 | $this->set\_pagination\_args( array( |
  | […](/browser/clover-online-orders/trunk/admin/includes/class-moo-coupons-list.php?rev=3142846#L191) | […](/browser/clover-online-orders/trunk/admin/includes/class-moo-coupons-list.php?rev=3168433#L196) |  |
  | 191 | 196 |  |
  | 192 | 197 |  |
  | 193 |  | $this->items = ~~self~~::get\_items( $per\_page, $current\_page ); |
  |  | 198 | $this->items = $this::get\_items( $per\_page, $current\_page ); |
  | 194 | 199 | } |
  | 195 | 200 | public function process\_bulk\_action() { |
  | […](/browser/clover-online-orders/trunk/admin/includes/class-moo-coupons-list.php?rev=3142846#L201) | […](/browser/clover-online-orders/trunk/admin/includes/class-moo-coupons-list.php?rev=3168433#L206) |  |
  | 201 | 206 | die( 'You are not permitted to perform this action' ); |
  | 202 | 207 | } else { |
  | 203 |  | $res = self::delete\_coupon(sanitize\_text\_field($\_GET['coupon'])); |
  | 204 |  | wp\_redirect( add\_query\_arg(array("deleted"=>$res),remove\_query\_arg( array('coupon', 'action')))); |
  |  | 208 | $res = $this->delete\_coupon(sanitize\_text\_field($\_GET['coupon'])); |
  |  | 209 | $redirect\_url = add\_query\_arg(array("deleted"=>$res), $this->couponPageUrl); |
  |  | 210 | wp\_safe\_redirect( $redirect\_url ); |
  | 205 | 211 | exit; |
  | 206 | 212 | } |
  | […](/browser/clover-online-orders/trunk/admin/includes/class-moo-coupons-list.php?rev=3142846#L208) | […](/browser/clover-online-orders/trunk/admin/includes/class-moo-coupons-list.php?rev=3168433#L214) |  |
  | 208 | 214 | } |
  | 209 | 215 | if ( 'enable' === $this->current\_action() ) { |
  | 210 |  | $res = self::enable\_coupon(sanitize\_text\_field($\_GET['coupon']),"1"); |
  | 211 |  | wp\_redirect( add\_query\_arg(array("enabled"=>$res),remove\_query\_arg( array('coupon', 'action')))); |
  |  | 216 | $res = $this->enable\_coupon(sanitize\_text\_field($\_GET['coupon']),"1"); |
  |  | 217 | $redirect\_url = add\_query\_arg(array("enabled"=>$res), $this->couponPageUrl); |
  |  | 218 | wp\_safe\_redirect( $redirect\_url ); |
  | 212 | 219 | exit; |
  | 213 | 220 | } |
  | 214 | 221 |  |
  | 215 | 222 | if ( 'disable' === $this->current\_action() ) { |
  | 216 |  | $res = self::enable\_coupon(sanitize\_text\_field($\_GET['coupon']),"0"); |
  | 217 |  | wp\_redirect( add\_query\_arg(array("disabled"=>$res),remove\_query\_arg( array('coupon', 'action')))); |
  |  | 223 | $res = $this->enable\_coupon(sanitize\_text\_field($\_GET['coupon']),"0"); |
  |  | 224 | $redirect\_url = add\_query\_arg(array("disabled"=>$res), $this->couponPageUrl); |
  |  | 225 | wp\_safe\_redirect( $redirect\_url ); |
  | 218 | 226 | exit; |
  | 219 | 227 | } |
  | […](/browser/clover-online-orders/trunk/admin/includes/class-moo-coupons-list.php?rev=3142846#L224) | […](/browser/clover-online-orders/trunk/admin/includes/class-moo-coupons-list.php?rev=3168433#L232) |  |
  | 224 | 232 | // loop over the array of record IDs and delete them |
  | 225 | 233 | foreach ( $codes as $code ) { |
  | 226 |  | $res = self::delete\_coupon( $code ); |
  | 227 |  | } |
  | 228 |  | wp\_redirect( add\_query\_arg(array("deleted"=>$res),remove\_query\_arg( array('coupon', 'action')))); |
  |  | 234 | $res = $this->delete\_coupon( $code ); |
  |  | 235 | } |
  |  | 236 | $redirect\_url = add\_query\_arg(array("deleted"=>$res), $this->couponPageUrl); |
  |  | 237 | wp\_safe\_redirect( $redirect\_url ); |
  | 229 | 238 | exit; |
  | 230 | 239 | } |
  | […](/browser/clover-online-orders/trunk/admin/includes/class-moo-coupons-list.php?rev=3142846#L234) | […](/browser/clover-online-orders/trunk/admin/includes/class-moo-coupons-list.php?rev=3168433#L243) |  |
  | 234 | 243 | // loop over the array of record IDs and delete them |
  | 235 | 244 | foreach ( $codes as $code ) { |
  | 236 |  | $res = self::enable\_coupon( $code, "1" ); |
  | 237 |  | } |
  | 238 |  | wp\_redirect( add\_query\_arg(array("enabled"=>$res),remove\_query\_arg( array('coupon', 'action')))); |
  |  | 245 | $res = $this->enable\_coupon( $code, "1" ); |
  |  | 246 | } |
  |  | 247 | $redirect\_url = add\_query\_arg(array("enabled"=>$res), $this->couponPageUrl); |
  |  | 248 | wp\_safe\_redirect( $redirect\_url ); |
  | 239 | 249 | exit; |
  | 240 | 250 | } |
  | […](/browser/clover-online-orders/trunk/admin/includes/class-moo-coupons-list.php?rev=3142846#L245) | […](/browser/clover-online-orders/trunk/admin/includes/class-moo-coupons-list.php?rev=3168433#L255) |  |
  | 245 | 255 | // loop over the array of record IDs and delete them |
  | 246 | 256 | foreach ( $codes as $code ) { |
  | 247 |  | $res = self::enable\_coupon( $code, "0" ); |
  | 248 |  | } |
  | 249 |  | wp\_redirect( add\_query\_arg(array("disabled"=>$res),remove\_query\_arg( array('coupon', 'action')))); |
  |  | 257 | $res = $this->enable\_coupon( $code, "0" ); |
  |  | 258 | } |
  |  | 259 | $redirect\_url = add\_query\_arg(array("disabled"=>$res), $this->couponPageUrl); |
  |  | 260 | wp\_safe\_redirect( $redirect\_url ); |
  | 250 | 261 | exit; |
  | 251 | 262 | } |
* ## [clover-online-orders/trunk/admin/includes/class-moo-orders-list.php](/changeset/3168433/clover-online-orders/trunk/admin/includes/class-moo-orders-list.php "Show the changeset 3168433 restricted to clover-online-orders/trunk/admin/includes/class-moo-orders-list.php")

  | [r2986704](/browser/clover-online-orders/trunk/admin/includes/class-moo-orders-list.php?rev=2986704#L10 "Show revision 2986704 of this file in browser") | [r3168433](/browser/clover-online-orders/trunk/admin/includes/class-moo-orders-list.php?rev=3168433#L10 "Show revision 3168433 of this file in browser") |  |
  | --- | --- | --- |
  | 10 | 10 |  |
  | 11 | 11 | parent::\_\_construct( array( |
  | 12 |  | 'singular' => \_\_( 'Order'), //singular name of the listed records |
  | 13 |  | 'plural'   => \_\_( 'Orders'), //plural name of the listed records |
  |  | 12 | 'singular' => \_\_( 'Order', "moo\_OnlineOrders"), //singular name of the listed records |
  |  | 13 | 'plural'   => \_\_( 'Orders', "moo\_OnlineOrders"), //plural name of the listed records |
  | 14 | 14 | 'ajax'     => false //should this table support ajax? |
  | 15 | 15 |  |
  | […](/browser/clover-online-orders/trunk/admin/includes/class-moo-orders-list.php?rev=2986704#L35) | […](/browser/clover-online-orders/trunk/admin/includes/class-moo-orders-list.php?rev=3168433#L35) |  |
  | 35 | 35 | /\*\* Text displayed when no customer data is available \*/ |
  | 36 | 36 | public function no\_items() { |
  | 37 |  | \_e( 'No orders available.'); |
  |  | 37 | \_e( 'No orders available.',"moo\_OnlineOrders"); |
  | 38 | 38 | } |
  | 39 | 39 |  |
  | […](/browser/clover-online-orders/trunk/admin/includes/class-moo-orders-list.php?rev=2986704#L153) | […](/browser/clover-online-orders/trunk/admin/includes/class-moo-orders-list.php?rev=3168433#L153) |  |
  | 153 | 153 | function get\_columns() { |
  | 154 | 154 | $columns = array( |
  | 155 |  | 'order\_number'    => \_\_( 'Order Number'), |
  | 156 |  | 'customer\_name' => \_\_( 'Customer Name'), |
  | 157 |  | 'order\_type\_label'    => \_\_( 'Order Type'), |
  | 158 |  | 'status' => \_\_( 'Status'), |
  | 159 |  | 'amount' => \_\_( 'Amount'), |
  | 160 |  | 'created\_at\_hf' => \_\_( 'Order Date'), |
  | 161 |  | 'source' => \_\_('Source') |
  |  | 155 | 'order\_number'    => \_\_( 'Order Number', "moo\_OnlineOrders"), |
  |  | 156 | 'customer\_name' => \_\_( 'Customer Name',"moo\_OnlineOrders"), |
  |  | 157 | 'order\_type\_label'    => \_\_( 'Order Type',"moo\_OnlineOrders"), |
  |  | 158 | 'status' => \_\_( 'Status',"moo\_OnlineOrders"), |
  |  | 159 | 'amount' => \_\_( 'Amount',"moo\_OnlineOrders"), |
  |  | 160 | 'created\_at\_hf' => \_\_( 'Order Date',"moo\_OnlineOrders"), |
  |  | 161 | 'source' => \_\_('Source',"moo\_OnlineOrders") |
  | 162 | 162 | ); |
  | 163 | 163 |  |
* ## [clover-online-orders/trunk/admin/includes/class-moo-products-list.php](/changeset/3168433/clover-online-orders/trunk/admin/includes/class-moo-products-list.php "Show the changeset 3168433 restricted to clover-online-orders/trunk/admin/includes/class-moo-products-list.php")

  | [r3142846](/browser/clover-online-orders/trunk/admin/includes/class-moo-products-list.php?rev=3142846#L8 "Show revision 3142846 of this file in browser") | [r3168433](/browser/clover-online-orders/trunk/admin/includes/class-moo-products-list.php?rev=3168433#L8 "Show revision 3168433 of this file in browser") |  |
  | --- | --- | --- |
  | 8 | 8 | protected $editIcon; |
  | 9 | 9 | protected $api; |
  |  | 10 | private $itemsPageUrl; |
  | 10 | 11 |  |
  | 11 | 12 | /\*\* Class constructor \*/ |
  | […](/browser/clover-online-orders/trunk/admin/includes/class-moo-products-list.php?rev=3142846#L13) | […](/browser/clover-online-orders/trunk/admin/includes/class-moo-products-list.php?rev=3168433#L14) |  |
  | 13 | 14 | require\_once plugin\_dir\_path( dirname(\_\_FILE\_\_) )."../includes/moo-OnlineOrders-sooapi.php"; |
  | 14 | 15 | $this->api = new Moo\_OnlineOrders\_SooApi(); |
  |  | 16 | $this->itemsPageUrl = admin\_url('admin.php?page=moo\_items'); |
  | 15 | 17 |  |
  | 16 | 18 | /\*\* Process bulk action \*/ |
  | […](/browser/clover-online-orders/trunk/admin/includes/class-moo-products-list.php?rev=3142846#L22) | […](/browser/clover-online-orders/trunk/admin/includes/class-moo-products-list.php?rev=3168433#L24) |  |
  | 22 | 24 |  |
  | 23 | 25 | parent::\_\_construct( array( |
  | 24 |  | 'singular' => \_\_( 'Item'), //singular name of the listed records |
  | 25 |  | 'plural'   => \_\_( 'Items'), //plural name of the listed records |
  |  | 26 | 'singular' => \_\_( 'Item',"moo\_OnlineOrders"), //singular name of the listed records |
  |  | 27 | 'plural'   => \_\_( 'Items',"moo\_OnlineOrders"), //plural name of the listed records |
  | 26 | 28 | 'ajax'     => false //should this table support ajax? |
  | 27 | 29 |  |
  | […](/browser/clover-online-orders/trunk/admin/includes/class-moo-products-list.php?rev=3142846#L163) | […](/browser/clover-online-orders/trunk/admin/includes/class-moo-products-list.php?rev=3168433#L165) |  |
  | 163 | 165 | /\*\* Text displayed when no customer data is available \*/ |
  | 164 | 166 | public function no\_items() { |
  | 165 |  | \_e( 'No items available.'); |
  |  | 167 | \_e( 'No items available.',"moo\_OnlineOrders"); |
  | 166 | 168 | } |
  | 167 | 169 | /\*\* |
  | […](/browser/clover-online-orders/trunk/admin/includes/class-moo-products-list.php?rev=3142846#L221) | […](/browser/clover-online-orders/trunk/admin/includes/class-moo-products-list.php?rev=3168433#L223) |  |
  | 221 | 223 | } |
  | 222 | 224 |  |
  | 223 |  | if(isset($\_GET["category"])){ |
  | 224 |  | if($item['visible']) { |
  | 225 |  | $actions = array( |
  | 226 |  | 'id' =>"ID: ".esc\_attr($item['uuid']), |
  | 227 |  | 'hide' => sprintf( '<a href="?page=%s&action=%s&item=%s&\_wpnonce=%s&category=%s&paged=%s">Hide from the Website</a>', |
  | 228 |  | 'moo\_items', 'hide',esc\_attr($item['uuid']), $hide\_nonce,esc\_attr($\_GET["category"]),$this->get\_pagenum()) |
  | 229 |  | ); |
  | 230 |  | } else { |
  | 231 |  | $actions = array( |
  | 232 |  | 'id' =>"ID: ".esc\_attr($item['uuid']), |
  | 233 |  | 'show' => sprintf( '<a href="?page=%s&action=%s&item=%s&\_wpnonce=%s&category=%s&paged=%s">Show in the Website</a>', |
  | 234 |  | 'moo\_items', 'show',esc\_attr($item['uuid']), $show\_nonce,esc\_attr($\_GET["category"]),$this->get\_pagenum()) |
  | 235 |  | ); |
  | 236 |  | } |
  | 237 |  | $actions['edit'] = sprintf( '<a href="?page=%s&action=%s&item\_uuid=%s&category=%s&paged=%s">Add / Edit Images</a>', |
  | 238 |  | 'moo\_items', 'update\_item',esc\_attr($item['uuid']),esc\_attr($\_GET["category"]),$this->get\_pagenum()); |
  | 239 |  |  |
  | 240 |  | if($item['outofstock']) { |
  | 241 |  | $actions['disable\_ot']  = sprintf( '<a href="?page=%s&action=%s&item=%s&\_wpnonce=%s&paged=%s&category=%s">Disable out of stock</a>', |
  | 242 |  | 'moo\_items', 'disable\_ot',esc\_attr($item['uuid']), $disable\_ot\_nonce,$this->get\_pagenum(),esc\_attr($\_GET["category"])); |
  | 243 |  | } else { |
  | 244 |  | $actions['enable\_ot']  = sprintf( '<a href="?page=%s&action=%s&item=%s&\_wpnonce=%s&paged=%s&category=%s">Enable out of stock</a>', |
  | 245 |  | 'moo\_items', 'enable\_ot',esc\_attr($item['uuid']), $enable\_ot\_nonce,$this->get\_pagenum(),esc\_attr($\_GET["category"])); |
  | 246 |  | } |
  | 247 |  |  |
  | 248 |  | } else { |
  | 249 |  | if($item['visible']) { |
  | 250 |  | $actions = array( |
  | 251 |  | 'id' =>"ID: ".esc\_attr($item['uuid']), |
  | 252 |  | 'hide' => sprintf( '<a href="?page=%s&action=%s&item=%s&\_wpnonce=%s&paged=%s">Hide from the Website</a>', |
  | 253 |  | 'moo\_items', 'hide',esc\_attr($item['uuid']), $hide\_nonce,$this->get\_pagenum()) |
  | 254 |  | ); |
  | 255 |  | } else { |
  | 256 |  | $actions = array( |
  | 257 |  | 'id' =>"ID: ".esc\_attr($item['uuid']), |
  | 258 |  | 'show' => sprintf( '<a href="?page=%s&action=%s&item=%s&\_wpnonce=%s&paged=%s">Show in the Website</a>', |
  | 259 |  | 'moo\_items', 'show',esc\_attr($item['uuid']), $show\_nonce,$this->get\_pagenum()) |
  | 260 |  | ); |
  | 261 |  | } |
  | 262 |  | $actions['edit'] = sprintf( '<a href="?page=%s&action=%s&item\_uuid=%s&paged=%s">Add / Edit Images</a>', |
  | 263 |  | 'moo\_items', 'update\_item',esc\_attr($item['uuid']),$this->get\_pagenum()); |
  | 264 |  |  |
  | 265 |  | if($item['outofstock']) { |
  | 266 |  | $actions['disable\_ot']  = sprintf( '<a href="?page=%s&action=%s&item=%s&\_wpnonce=%s&paged=%s">Disable out of stock</a>', |
  | 267 |  | 'moo\_items', 'disable\_ot',esc\_attr($item['uuid']), $disable\_ot\_nonce,$this->get\_pagenum()); |
  | 268 |  | } else { |
  | 269 |  | $actions['enable\_ot']  = sprintf( '<a href="?page=%s&action=%s&item=%s&\_wpnonce=%s&paged=%s">Enable out of stock</a>', |
  | 270 |  | 'moo\_items', 'enable\_ot',esc\_attr($item['uuid']), $enable\_ot\_nonce,$this->get\_pagenum()); |
  | 271 |  | } |
  | 272 |  |  |
  | 273 |  |  |
  | 274 |  | } |
  |  | 225 | $actions = array( |
  |  | 226 | 'id' =>"ID: ".esc\_attr($item['uuid']), |
  |  | 227 | ); |
  |  | 228 | if( ! empty( $\_REQUEST['filter'] )){ |
  |  | 229 | $filter = esc\_attr($\_REQUEST['filter']); |
  |  | 230 | } else { |
  |  | 231 | $filter = 'all'; |
  |  | 232 | } |
  |  | 233 |  |
  |  | 234 | if( ! empty( $\_REQUEST['category'] )) { |
  |  | 235 | $actions['edit'] = sprintf( '<a href="?page=%s&action=%s&item\_uuid=%s&category=%s&paged=%s&filter=%s">Add / Edit Images</a>', |
  |  | 236 | 'moo\_items', 'update\_item',esc\_attr($item['uuid']),esc\_attr($\_REQUEST["category"]),$this->get\_pagenum(),$filter); |
  |  | 237 | } else { |
  |  | 238 | $actions['edit'] = sprintf( '<a href="?page=%s&action=%s&item\_uuid=%s&paged=%s&filter=%s">Add / Edit Images</a>', |
  |  | 239 | 'moo\_items', 'update\_item',esc\_attr($item['uuid']),$this->get\_pagenum(),$filter); |
  |  | 240 | } |
  |  | 241 |  |
  |  | 242 | $actions['visibility']  = sprintf( '<a style="%s" id="sooHideAnItem-%s"  data-is-visible="true" href="#" onclick="moo\_changeItemVisibility(event, \'%s\')">Hide from the Website</a><a style="%s" id="sooShowAnItem-%s"  data-is-visible="false" href="#" onclick="moo\_changeItemVisibility(event, \'%s\')">Show in the Website</a>', |
  |  | 243 | (($item['visible'] == '1') ? '':'display: none;'), esc\_attr($item['uuid']), esc\_attr($item['uuid']),  (($item['visible'] == "1") ? 'display: none;':''), esc\_attr($item['uuid']), esc\_attr($item['uuid'])); |
  |  | 244 |  |
  |  | 245 | $actions['outofstock']  = sprintf( '<a style="%s" id="sooOutOfStockItem-%s"  data-is-out-of-stock="true" href="#" onclick="moo\_markItemAsOutOfStock(event, \'%s\')">Enable Out Of Stock</a><a style="%s" id="sooInStockItem-%s"  data-is-out-of-stock="false" href="#" onclick="moo\_markItemAsOutOfStock(event, \'%s\')">Disable Out Of Stock</a>', |
  |  | 246 | (empty($item['outofstock']) ? '':'display: none;'), esc\_attr($item['uuid']), esc\_attr($item['uuid']),  (empty($item['outofstock']) ? 'display: none;':''), esc\_attr($item['uuid']), esc\_attr($item['uuid'])); |
  | 275 | 247 |  |
  | 276 | 248 | $actions['edit\_description'] = sprintf( '<a class="moo-edit-description-button" href="#" onclick="moo\_editItemDescription(event,\'%s\',\'%s\')">Add / Edit description</a>', |
  | 277 |  | esc\_attr($item['uuid']), esc\_js($itemName)~~, esc\_attr($item['uuid'])~~); |
  |  | 249 | esc\_attr($item['uuid']), esc\_js($itemName)); |
  | 278 | 250 |  |
  | 279 | 251 | $actions['featured\_item']  = sprintf( '<a style="%s" id="sooMarkAsFeaturedLink-%s"  data-is-featured="true" href="#" onclick="moo\_markItemAsFeatured(event, \'%s\')">Mark as Featured</a><a style="%s" id="sooMarkAsUnFeaturedLink-%s"  data-is-featured="false" href="#" onclick="moo\_markItemAsFeatured(event, \'%s\')">Unfeature</a>', |
  | 280 | 252 | (empty($item['featured']) ? '':'display: none;'), esc\_attr($item['uuid']), esc\_attr($item['uuid']),  (empty($item['featured']) ? 'display: none;':''), esc\_attr($item['uuid']), esc\_attr($item['uuid'])); |
  |  | 253 |  |
  | 281 | 254 | return $title . $this->row\_actions( $actions ); |
  | 282 | 255 | } |
  | […](/browser/clover-online-orders/trunk/admin/includes/class-moo-products-list.php?rev=3142846#L296) | […](/browser/clover-online-orders/trunk/admin/includes/class-moo-products-list.php?rev=3168433#L269) |  |
  | 296 | 269 | case 'unit\_name': |
  | 297 | 270 | return $item[ $column\_name ]; |
  |  | 271 | case 'visible': |
  |  | 272 | if($item[ $column\_name ]) { |
  |  | 273 | return "<span id='visibility-item-{$item["uuid"]}'>No</span>"; |
  |  | 274 | } else { |
  |  | 275 | return "<span id='visibility-item-{$item["uuid"]}'>Yes</span>"; |
  |  | 276 | } |
  | 298 | 277 | case 'available': |
  |  | 278 | if($item[ $column\_name ]) { |
  |  | 279 | return "<span>Yes</span>"; |
  |  | 280 | } else { |
  |  | 281 | return "<span>No</span>"; |
  |  | 282 | } |
  | 299 | 283 | case 'outofstock': |
  | 300 |  | return intval($item[ $column\_name ])=== 1 ? "Yes" : "No" ; |
  |  | 284 | if($item[ $column\_name ]) { |
  |  | 285 | return "<span id='outofstock-item-{$item["uuid"]}'>Yes</span>"; |
  |  | 286 | } else { |
  |  | 287 | return "<span id='outofstock-item-{$item["uuid"]}'>No</span>"; |
  |  | 288 | } |
  | 301 | 289 | case 'custom\_hours': |
  | 302 | 290 | return $this->getCustomHours($item[ $column\_name ]); |
  | […](/browser/clover-online-orders/trunk/admin/includes/class-moo-products-list.php?rev=3142846#L357) | […](/browser/clover-online-orders/trunk/admin/includes/class-moo-products-list.php?rev=3168433#L345) |  |
  | 357 | 345 | 'cb'      => '<input type="checkbox" />', |
  | 358 | 346 | 'image'      => "", |
  | 359 |  | 'soo\_name'    => \_\_( 'Online Name'), |
  | 360 |  | 'name'    => \_\_( 'Clover Name'), |
  | 361 |  | 'price' => \_\_( 'Price'), |
  | 362 |  | 'price\_type' => \_\_( 'Price Type'), |
  | 363 |  | 'outofstock' => \_\_( 'Out Of Stock'), |
  | 364 |  | 'available' => \_\_( 'Available'), |
  | 365 |  | 'custom\_hours' => \_\_( 'Custom Hours'), |
  |  | 347 | 'soo\_name'    => \_\_( 'Online Name',"moo\_OnlineOrders"), |
  |  | 348 | 'name'    => \_\_( 'Clover Name',"moo\_OnlineOrders"), |
  |  | 349 | 'price' => \_\_( 'Price',"moo\_OnlineOrders"), |
  |  | 350 | 'price\_type' => \_\_( 'Price Type',"moo\_OnlineOrders"), |
  |  | 351 | 'outofstock' => \_\_( 'Out Of Stock',"moo\_OnlineOrders"), |
  |  | 352 | 'visible' => \_\_( 'is Hidden',"moo\_OnlineOrders"), |
  |  | 353 | 'available' => \_\_( 'Available',"moo\_OnlineOrders"), |
  |  | 354 | 'custom\_hours' => \_\_( 'Custom Hours',"moo\_OnlineOrders"), |
  | 366 | 355 |  |
  | 367 | 356 | ); |
  | […](/browser/clover-online-orders/trunk/admin/includes/class-moo-products-list.php?rev=3142846#L428) | […](/browser/clover-online-orders/trunk/admin/includes/class-moo-products-list.php?rev=3168433#L417) |  |
  | 428 | 417 | } |
  | 429 | 418 | public function process\_bulk\_action() { |
  | 430 |  |  |
  | 431 |  | $custom\_url  = add\_query\_arg( 'bulk-status', 'success', remove\_query\_arg( array( 'action', '\_wpnonce' ) ) ); |
  | 432 |  |  |
  |  | 419 | $queryArgs =  array('paged'=>$this->get\_pagenum()); |
  |  | 420 |  |
  |  | 421 | if( ! empty( $\_REQUEST['filter'] )){ |
  |  | 422 | $queryArgs[] = array( |
  |  | 423 | "filter" => esc\_attr($\_REQUEST['filter']) |
  |  | 424 | ); |
  |  | 425 | } |
  |  | 426 |  |
  |  | 427 | if( ! empty( $\_REQUEST['category'] )){ |
  |  | 428 | $queryArgs[] = array( |
  |  | 429 | "category" => esc\_attr($\_REQUEST['category']) |
  |  | 430 | ); |
  |  | 431 | } |
  |  | 432 | $redirect\_url  = add\_query\_arg($queryArgs, $this->itemsPageUrl ); |
  | 433 | 433 | //Detect when a single action is being triggered... |
  | 434 | 434 | if ( 'hide' === $this->current\_action() ) { |
  | […](/browser/clover-online-orders/trunk/admin/includes/class-moo-products-list.php?rev=3142846#L441) | […](/browser/clover-online-orders/trunk/admin/includes/class-moo-products-list.php?rev=3168433#L441) |  |
  | 441 | 441 | } else { |
  | 442 | 442 | $this->hide\_item(sanitize\_text\_field($\_GET['item'])); |
  | 443 |  | wp\_~~redirect($custom~~\_url); |
  |  | 443 | wp\_safe\_redirect($redirect\_url); |
  | 444 | 444 | exit; |
  | 445 | 445 | } |
  | […](/browser/clover-online-orders/trunk/admin/includes/class-moo-products-list.php?rev=3142846#L454) | […](/browser/clover-online-orders/trunk/admin/includes/class-moo-products-list.php?rev=3168433#L454) |  |
  | 454 | 454 | else { |
  | 455 | 455 | $this->show\_item(sanitize\_text\_field($\_GET['item'])); |
  | 456 |  | wp\_~~redirect($custom~~\_url); |
  |  | 456 | wp\_safe\_redirect($redirect\_url); |
  | 457 | 457 | exit; |
  | 458 | 458 | } |
  | […](/browser/clover-online-orders/trunk/admin/includes/class-moo-products-list.php?rev=3142846#L465) | […](/browser/clover-online-orders/trunk/admin/includes/class-moo-products-list.php?rev=3168433#L465) |  |
  | 465 | 465 | } else { |
  | 466 | 466 | $this->out\_of\_stock(sanitize\_text\_field($\_GET['item']),true); |
  | 467 |  | wp\_~~redirect($custom~~\_url); |
  |  | 467 | wp\_safe\_redirect($redirect\_url); |
  | 468 | 468 | exit; |
  | 469 | 469 | } |
  | […](/browser/clover-online-orders/trunk/admin/includes/class-moo-products-list.php?rev=3142846#L475) | […](/browser/clover-online-orders/trunk/admin/includes/class-moo-products-list.php?rev=3168433#L475) |  |
  | 475 | 475 | } else { |
  | 476 | 476 | $this->out\_of\_stock(sanitize\_text\_field($\_GET['item']),false); |
  | 477 |  | wp\_~~redirect($custom~~\_url); |
  |  | 477 | wp\_safe\_redirect($redirect\_url); |
  | 478 | 478 | exit; |
  | 479 | 479 | } |
  | […](/browser/clover-online-orders/trunk/admin/includes/class-moo-products-list.php?rev=3142846#L488) | […](/browser/clover-online-orders/trunk/admin/includes/class-moo-products-list.php?rev=3168433#L488) |  |
  | 488 | 488 | $this->hide\_item( esc\_sql($id) ); |
  | 489 | 489 | } |
  | 490 |  | wp\_~~redirect($custom~~\_url); |
  |  | 490 | wp\_safe\_redirect($redirect\_url); |
  | 491 | 491 | exit; |
  | 492 | 492 | } |
  | […](/browser/clover-online-orders/trunk/admin/includes/class-moo-products-list.php?rev=3142846#L499) | […](/browser/clover-online-orders/trunk/admin/includes/class-moo-products-list.php?rev=3168433#L499) |  |
  | 499 | 499 | } |
  | 500 | 500 |  |
  | 501 |  | wp\_~~redirect($custom~~\_url); |
  |  | 501 | wp\_safe\_redirect($redirect\_url); |
  | 502 | 502 | exit; |
  | 503 | 503 | } |
  | […](/browser/clover-online-orders/trunk/admin/includes/class-moo-products-list.php?rev=3142846#L509) | […](/browser/clover-online-orders/trunk/admin/includes/class-moo-products-list.php?rev=3168433#L509) |  |
  | 509 | 509 | $this->out\_of\_stock( esc\_sql($id),true); |
  | 510 | 510 | } |
  | 511 |  | wp\_~~redirect($custom~~\_url); |
  |  | 511 | wp\_safe\_redirect($redirect\_url); |
  | 512 | 512 | exit; |
  | 513 | 513 | } |
  | […](/browser/clover-online-orders/trunk/admin/includes/class-moo-products-list.php?rev=3142846#L519) | […](/browser/clover-online-orders/trunk/admin/includes/class-moo-products-list.php?rev=3168433#L519) |  |
  | 519 | 519 | $this->out\_of\_stock( esc\_sql($id),false ); |
  | 520 | 520 | } |
  | 521 |  | wp\_~~redirect($custom~~\_url); |
  |  | 521 | wp\_safe\_redirect($redirect\_url); |
  | 522 | 522 | exit; |
  | 523 | 523 | } |
  | 524 | 524 |  |
  | 525 | 525 | if ( 'bulk-feature' === $this->current\_action() ) { |
  | 526 |  |  |
  | 527 | 526 | $ids = esc\_sql( $\_POST['bulk-hideOrShow'] ); |
  | 528 | 527 | // loop over the array of record IDs and delete them |
  | […](/browser/clover-online-orders/trunk/admin/includes/class-moo-products-list.php?rev=3142846#L531) | […](/browser/clover-online-orders/trunk/admin/includes/class-moo-products-list.php?rev=3168433#L530) |  |
  | 531 | 530 | } |
  | 532 | 531 |  |
  | 533 |  | wp\_~~redirect($custom~~\_url); |
  |  | 532 | wp\_safe\_redirect($redirect\_url); |
  | 534 | 533 | exit; |
  | 535 | 534 | } |
  | […](/browser/clover-online-orders/trunk/admin/includes/class-moo-products-list.php?rev=3142846#L541) | […](/browser/clover-online-orders/trunk/admin/includes/class-moo-products-list.php?rev=3168433#L540) |  |
  | 541 | 540 | $this->markItemAsFeatured( esc\_sql($id), false ); |
  | 542 | 541 | } |
  | 543 |  | wp\_~~redirect($custom~~\_url); |
  |  | 542 | wp\_safe\_redirect($redirect\_url); |
  | 544 | 543 | exit; |
  | 545 | 544 | } |
  | […](/browser/clover-online-orders/trunk/admin/includes/class-moo-products-list.php?rev=3142846#L548) | […](/browser/clover-online-orders/trunk/admin/includes/class-moo-products-list.php?rev=3168433#L547) |  |
  | 548 | 547 | } |
  | 549 | 548 | public function single\_row( $item ) { |
  | 550 |  | if(! $item['visible']) |
  | 551 |  | echo '<tr class="item-hidden">'; |
  | 552 |  | else |
  | 553 |  | echo '<tr>'; |
  |  | 549 | if(! $item['visible']) { |
  |  | 550 | echo "<tr class='item-hidden' id='soo-item-row-{$item["uuid"]}'>"; |
  |  | 551 | } else { |
  |  | 552 | echo "<tr id='soo-item-row-{$item["uuid"]}'>"; |
  |  | 553 | } |
  | 554 | 554 | $this->single\_row\_columns( $item ); |
  | 555 | 555 | echo '</tr>'; |
  | […](/browser/clover-online-orders/trunk/admin/includes/class-moo-products-list.php?rev=3142846#L572) | […](/browser/clover-online-orders/trunk/admin/includes/class-moo-products-list.php?rev=3168433#L572) |  |
  | 572 | 572 | foreach( $cats as $cat ){ |
  | 573 | 573 | $selected = ''; |
  | 574 |  | if( $\_GET['category'] == $cat['uuid'] ){ |
  |  | 574 | if(isset($\_GET['category']) && $\_GET['category'] == $cat['uuid'] ){ |
  | 575 | 575 | $selected = ' selected = "selected"'; |
  | 576 | 576 | } |
  | 577 |  | ~~$custom\_url  = add\_query\_arg( 'category', $cat['uuid'] , remove\_query\_arg( array( 's', 'paged', 'alert' ) ));~~ |
  | 578 | 577 | ?> |
  | 579 |  | <option value="<?php echo ~~$custom\_url~~; ?>" <?php echo $selected; ?>><?php |
  |  | 578 | <option value="<?php echo esc\_attr($cat['uuid']); ?>" <?php echo $selected; ?>><?php |
  | 580 | 579 | if($cat["alternate\_name"]=="" || $cat["alternate\_name"]== null ){ |
  | 581 | 580 | echo stripslashes((string)$cat['name']); |
  | […](/browser/clover-online-orders/trunk/admin/includes/class-moo-products-list.php?rev=3142846#L607) | […](/browser/clover-online-orders/trunk/admin/includes/class-moo-products-list.php?rev=3168433#L606) |  |
  | 607 | 606 | //All Actions |
  | 608 | 607 | $class        = ( $current == 'all' ? ' class="current"' : '' ); |
  | 609 |  | $all\_url      = remove\_query\_arg( array( 'filter', 's', 'paged', 'alert', 'user' ) ); |
  | 610 |  | $views['all'] = "<a href='{$~~all\_url~~ }' {$class} >All Items</a>"; |
  |  | 608 | //$all\_url      = remove\_query\_arg( array( 'filter', 's', 'paged', 'alert', 'user' ) ); |
  |  | 609 | $views['all'] = "<a href='{$this->itemsPageUrl}' {$class} >All Items</a>"; |
  | 611 | 610 | $views\_item   = array( |
  | 612 | 611 | 'featured'   => array( "name" => "Featured Items", "featured" => 1 ) |
  | 613 | 612 | ); |
  | 614 | 613 | foreach ( $views\_item as $k => $v ) { |
  | 615 |  | $custom\_url  = add\_query\_arg( ~~'filter', $k, remove\_query\_arg( array( 's', 'paged', 'alert' ) )~~ ); |
  |  | 614 | $custom\_url  = add\_query\_arg( array('filter'=>$k), $this->itemsPageUrl ); |
  | 616 | 615 | $class       = ( $current == $k ? ' class="current"' : '' ); |
  | 617 | 616 | $views[ $k ] = "<a href='{$custom\_url}' {$class} >" . $v['name'] . "</a>"; |
* ## [clover-online-orders/trunk/admin/includes/class-wp-list-table-moo.php](/changeset/3168433/clover-online-orders/trunk/admin/includes/class-wp-list-table-moo.php "Show the changeset 3168433 restricted to clover-online-orders/trunk/admin/includes/class-wp-list-table-moo.php")

  | [r2986704](/browser/clover-online-orders/trunk/admin/includes/class-wp-list-table-moo.php?rev=2986704#L140 "Show revision 2986704 of this file in browser") | [r3168433](/browser/clover-online-orders/trunk/admin/includes/class-wp-list-table-moo.php?rev=3168433#L140 "Show revision 3168433 of this file in browser") |  |
  | --- | --- | --- |
  | 140 | 140 | if ( empty( $this->modes ) ) { |
  | 141 | 141 | $this->modes = array( |
  | 142 |  | 'list'    => \_\_( 'List View' ), |
  | 143 |  | 'excerpt' => \_\_( 'Excerpt View' ) |
  |  | 142 | 'list'    => \_\_( 'List View',"moo\_OnlineOrders" ), |
  |  | 143 | 'excerpt' => \_\_( 'Excerpt View',"moo\_OnlineOrders" ) |
  | 144 | 144 | ); |
  | 145 | 145 | } |
  | […](/browser/clover-online-orders/trunk/admin/includes/class-wp-list-table-moo.php?rev=2986704#L310) | […](/browser/clover-online-orders/trunk/admin/includes/class-wp-list-table-moo.php?rev=3168433#L310) |  |
  | 310 | 310 | \*/ |
  | 311 | 311 | public function no\_items() { |
  | 312 |  | \_e( 'No items found.' ); |
  |  | 312 | \_e( 'No items found.',"moo\_OnlineOrders" ); |
  | 313 | 313 | } |
  | 314 | 314 |  |
  | […](/browser/clover-online-orders/trunk/admin/includes/class-wp-list-table-moo.php?rev=2986704#L436) | […](/browser/clover-online-orders/trunk/admin/includes/class-wp-list-table-moo.php?rev=3168433#L436) |  |
  | 436 | 436 | return; |
  | 437 | 437 |  |
  | 438 |  | echo "<label for='bulk-action-selector-" . esc\_attr( $which ) . "' class='screen-reader-text'>" . \_\_( 'Select bulk action' ) . "</label>"; |
  |  | 438 | echo "<label for='bulk-action-selector-" . esc\_attr( $which ) . "' class='screen-reader-text'>" . \_\_( 'Select bulk action',"moo\_OnlineOrders" ) . "</label>"; |
  | 439 | 439 | echo "<select name='action$two' id='bulk-action-selector-" . esc\_attr( $which ) . "'>\n"; |
  | 440 |  | echo "<option value='-1' selected='selected'>" . \_\_( 'Bulk Actions' ) . "</option>\n"; |
  |  | 440 | echo "<option value='-1' selected='selected'>" . \_\_( 'Bulk Actions',"moo\_OnlineOrders" ) . "</option>\n"; |
  | 441 | 441 |  |
  | 442 | 442 | foreach ( $this->\_actions as $name => $title ) { |
  | […](/browser/clover-online-orders/trunk/admin/includes/class-wp-list-table-moo.php?rev=2986704#L448) | […](/browser/clover-online-orders/trunk/admin/includes/class-wp-list-table-moo.php?rev=3168433#L448) |  |
  | 448 | 448 | echo "</select>\n"; |
  | 449 | 449 |  |
  | 450 |  | submit\_button( \_\_( 'Apply' ), 'action', '', false, array( 'id' => "doaction$two" ) ); |
  |  | 450 | submit\_button( \_\_( 'Apply',"moo\_OnlineOrders" ), 'action', '', false, array( 'id' => "doaction$two" ) ); |
  | 451 | 451 | echo "\n"; |
  | 452 | 452 | } |
  | […](/browser/clover-online-orders/trunk/admin/includes/class-wp-list-table-moo.php?rev=2986704#L498) | […](/browser/clover-online-orders/trunk/admin/includes/class-wp-list-table-moo.php?rev=3168433#L498) |  |
  | 498 | 498 | $out .= '</div>'; |
  | 499 | 499 |  |
  | 500 |  | $out .= '<button type="button" class="toggle-row"><span class="screen-reader-text">' . \_\_( 'Show more details' ) . '</span></button>'; |
  |  | 500 | $out .= '<button type="button" class="toggle-row"><span class="screen-reader-text">' . \_\_( 'Show more details',"moo\_OnlineOrders" ) . '</span></button>'; |
  | 501 | 501 |  |
  | 502 | 502 | return $out; |
  | […](/browser/clover-online-orders/trunk/admin/includes/class-wp-list-table-moo.php?rev=2986704#L553) | […](/browser/clover-online-orders/trunk/admin/includes/class-wp-list-table-moo.php?rev=3168433#L553) |  |
  | 553 | 553 | $m = isset( $\_GET['m'] ) ? (int) $\_GET['m'] : 0; |
  | 554 | 554 | ?> |
  | 555 |  | <label for="filter-by-date" class="screen-reader-text"><?php \_e( 'Filter by date' ); ?></label> |
  |  | 555 | <label for="filter-by-date" class="screen-reader-text"><?php \_e( 'Filter by date',"moo\_OnlineOrders" ); ?></label> |
  | 556 | 556 | <select name="m" id="filter-by-date"> |
  | 557 |  | <option<?php selected( $m, 0 ); ?> value="0"><?php \_e( 'All dates' ); ?></option> |
  |  | 557 | <option<?php selected( $m, 0 ); ?> value="0"><?php \_e( 'All dates',"moo\_OnlineOrders" ); ?></option> |
  | 558 | 558 | <?php |
  | 559 | 559 | foreach ( $months as $arc\_row ) { |
  | […](/browser/clover-online-orders/trunk/admin/includes/class-wp-list-table-moo.php?rev=2986704#L568) | […](/browser/clover-online-orders/trunk/admin/includes/class-wp-list-table-moo.php?rev=3168433#L568) |  |
  | 568 | 568 | esc\_attr( $arc\_row->year . $month ), |
  | 569 | 569 | /\* translators: 1: month name, 2: 4-digit year \*/ |
  | 570 |  | sprintf( \_\_( '%1$s %2$d' ), $wp\_locale->get\_month( $month ), $year ) |
  |  | 570 | sprintf( \_\_( '%1$s %2$d',"moo\_OnlineOrders" ), $wp\_locale->get\_month( $month ), $year ) |
  | 571 | 571 | ); |
  | 572 | 572 | } |
  | […](/browser/clover-online-orders/trunk/admin/includes/class-wp-list-table-moo.php?rev=2986704#L619) | […](/browser/clover-online-orders/trunk/admin/includes/class-wp-list-table-moo.php?rev=3168433#L619) |  |
  | 619 | 619 | $approved\_comments\_number = number\_format\_i18n( $approved\_comments ); |
  | 620 | 620 | $pending\_comments\_number = number\_format\_i18n( $pending\_comments ); |
  | 621 |  |  |
  | 622 |  | $approved\_only\_phrase = sprintf( \_n( '%s comment', '%s comments', $approved\_comments ), $approved\_comments\_number ); |
  | 623 |  | $approved\_phrase = sprintf( \_n( '%s approved comment', '%s approved comments', $approved\_comments ), $approved\_comments\_number ); |
  | 624 |  | $pending\_phrase = sprintf( \_n( '%s pending comment', '%s pending comments', $pending\_comments ), $pending\_comments\_number ); |
  |  | 621 | /\* translators: Nb Of comments \*/ |
  |  | 622 | $approved\_only\_phrase = sprintf( \_n( '%s comment', '%s comments', $approved\_comments,"moo\_OnlineOrders" ), $approved\_comments\_number ); |
  |  | 623 | /\* translators: Nb Of approved comments \*/ |
  |  | 624 | $approved\_phrase = sprintf( \_n( '%s approved comment', '%s approved comments', $approved\_comments,"moo\_OnlineOrders" ), $approved\_comments\_number ); |
  |  | 625 | /\* translators: Nb Of Pending comments \*/ |
  |  | 626 | $pending\_phrase = sprintf( \_n( '%s pending comment', '%s pending comments', $pending\_comments,"moo\_OnlineOrders" ), $pending\_comments\_number ); |
  | 625 | 627 |  |
  | 626 | 628 | // No comments at all. |
  | 627 | 629 | if ( ! $approved\_comments && ! $pending\_comments ) { |
  | 628 | 630 | printf( '<span aria-hidden="true">—</span><span class="screen-reader-text">%s</span>', |
  | 629 |  | \_\_( 'No comments' ) |
  |  | 631 | \_\_( 'No comments',"moo\_OnlineOrders" ) |
  | 630 | 632 | ); |
  | 631 | 633 | // Approved comments have different display depending on some conditions. |
  | […](/browser/clover-online-orders/trunk/admin/includes/class-wp-list-table-moo.php?rev=2986704#L639) | […](/browser/clover-online-orders/trunk/admin/includes/class-wp-list-table-moo.php?rev=3168433#L641) |  |
  | 639 | 641 | printf( '<span class="post-com-count post-com-count-no-comments"><span class="comment-count comment-count-no-comments" aria-hidden="true">%s</span><span class="screen-reader-text">%s</span></span>', |
  | 640 | 642 | $approved\_comments\_number, |
  | 641 |  | $pending\_comments ? \_\_( 'No approved comments'~~) : \_\_( 'No comments'~~ ) |
  |  | 643 | $pending\_comments ? \_\_( 'No approved comments',"moo\_OnlineOrders" ) : \_\_( 'No comments',"moo\_OnlineOrders" ) |
  | 642 | 644 | ); |
  | 643 | 645 | } |
  | […](/browser/clover-online-orders/trunk/admin/includes/class-wp-list-table-moo.php?rev=2986704#L719) | […](/browser/clover-online-orders/trunk/admin/includes/class-wp-list-table-moo.php?rev=3168433#L721) |  |
  | 719 | 721 | $infinite\_scroll = $this->\_pagination\_args['infinite\_scroll']; |
  | 720 | 722 | } |
  | 721 |  |  |
  | 722 |  | $output = '<span class="displaying-num">' . sprintf( \_n( '%s item', '%s items', $total\_items ), number\_format\_i18n( $total\_items ) ) . '</span>'; |
  |  | 723 | /\* translators: Nb of Items \*/ |
  |  | 724 | $output = '<span class="displaying-num">' . sprintf( \_n( '%s item', '%s items', $total\_items,"moo\_OnlineOrders" ), number\_format\_i18n( $total\_items ) ) . '</span>'; |
  | 723 | 725 |  |
  | 724 | 726 | $current = $this->get\_pagenum(); |
  | […](/browser/clover-online-orders/trunk/admin/includes/class-wp-list-table-moo.php?rev=2986704#L755) | […](/browser/clover-online-orders/trunk/admin/includes/class-wp-list-table-moo.php?rev=3168433#L757) |  |
  | 755 | 757 | $page\_links[] = sprintf( "<a class='first-page' href='%s'><span class='screen-reader-text'>%s</span><span aria-hidden='true'>%s</span></a>", |
  | 756 | 758 | esc\_url( remove\_query\_arg( 'paged', $current\_url ) ), |
  | 757 |  | \_\_( 'First page' ), |
  |  | 759 | \_\_( 'First page',"moo\_OnlineOrders" ), |
  | 758 | 760 | '&laquo;' |
  | 759 | 761 | ); |
  | […](/browser/clover-online-orders/trunk/admin/includes/class-wp-list-table-moo.php?rev=2986704#L765) | […](/browser/clover-online-orders/trunk/admin/includes/class-wp-list-table-moo.php?rev=3168433#L767) |  |
  | 765 | 767 | $page\_links[] = sprintf( "<a class='prev-page' href='%s'><span class='screen-reader-text'>%s</span><span aria-hidden='true'>%s</span></a>", |
  | 766 | 768 | esc\_url( add\_query\_arg( 'paged', max( 1, $current-1 ), $current\_url ) ), |
  | 767 |  | \_\_( 'Previous page' ), |
  |  | 769 | \_\_( 'Previous page',"moo\_OnlineOrders" ), |
  | 768 | 770 | '&lsaquo;' |
  | 769 | 771 | ); |
  | […](/browser/clover-online-orders/trunk/admin/includes/class-wp-list-table-moo.php?rev=2986704#L772) | […](/browser/clover-online-orders/trunk/admin/includes/class-wp-list-table-moo.php?rev=3168433#L774) |  |
  | 772 | 774 | if ( 'bottom' == $which ) { |
  | 773 | 775 | $html\_current\_page  = $current; |
  | 774 |  | $total\_pages\_before = '<span class="screen-reader-text">' . \_\_( 'Current Page' ) . '</span><span id="table-paging" class="paging-input">'; |
  |  | 776 | $total\_pages\_before = '<span class="screen-reader-text">' . \_\_( 'Current Page',"moo\_OnlineOrders" ) . '</span><span id="table-paging" class="paging-input">'; |
  | 775 | 777 | } else { |
  | 776 | 778 | $html\_current\_page = sprintf( "%s<input class='current-page' id='current-page-selector' type='text' name='paged' value='%s' size='%d' aria-describedby='table-paging' />", |
  | 777 |  | '<label for="current-page-selector" class="screen-reader-text">' . \_\_( 'Current Page' ) . '</label>', |
  |  | 779 | '<label for="current-page-selector" class="screen-reader-text">' . \_\_( 'Current Page',"moo\_OnlineOrders" ) . '</label>', |
  | 778 | 780 | $current, |
  | 779 | 781 | strlen( $total\_pages ) |
  | […](/browser/clover-online-orders/trunk/admin/includes/class-wp-list-table-moo.php?rev=2986704#L781) | […](/browser/clover-online-orders/trunk/admin/includes/class-wp-list-table-moo.php?rev=3168433#L783) |  |
  | 781 | 783 | } |
  | 782 | 784 | $html\_total\_pages = sprintf( "<span class='total-pages'>%s</span>", number\_format\_i18n( $total\_pages ) ); |
  | 783 |  | $page\_links[] = $total\_pages\_before . sprintf( \_x( '%1$s of %2$s', 'paging' ), $html\_current\_page, $html\_total\_pages ) . $total\_pages\_after; |
  |  | 785 | /\* translators: Nb of pages \*/ |
  |  | 786 | $page\_links[] = $total\_pages\_before . sprintf( \_x( '%1$s of %2$s', 'paging',"moo\_OnlineOrders" ), $html\_current\_page, $html\_total\_pages ) . $total\_pages\_after; |
  | 784 | 787 |  |
  | 785 | 788 | if ( $disable\_next ) { |
  | […](/browser/clover-online-orders/trunk/admin/includes/class-wp-list-table-moo.php?rev=2986704#L788) | […](/browser/clover-online-orders/trunk/admin/includes/class-wp-list-table-moo.php?rev=3168433#L791) |  |
  | 788 | 791 | $page\_links[] = sprintf( "<a class='next-page' href='%s'><span class='screen-reader-text'>%s</span><span aria-hidden='true'>%s</span></a>", |
  | 789 | 792 | esc\_url( add\_query\_arg( 'paged', min( $total\_pages, $current+1 ), $current\_url ) ), |
  | 790 |  | \_\_( 'Next page' ), |
  |  | 793 | \_\_( 'Next page',"moo\_OnlineOrders" ), |
  | 791 | 794 | '&rsaquo;' |
  | 792 | 795 | ); |
  | […](/browser/clover-online-orders/trunk/admin/includes/class-wp-list-table-moo.php?rev=2986704#L798) | […](/browser/clover-online-orders/trunk/admin/includes/class-wp-list-table-moo.php?rev=3168433#L801) |  |
  | 798 | 801 | $page\_links[] = sprintf( "<a class='last-page' href='%s'><span class='screen-reader-text'>%s</span><span aria-hidden='true'>%s</span></a>", |
  | 799 | 802 | esc\_url( add\_query\_arg( 'paged', $total\_pages, $current\_url ) ), |
  | 800 |  | \_\_( 'Last page' ), |
  |  | 803 | \_\_( 'Last page',"moo\_OnlineOrders" ), |
  | 801 | 804 | '&raquo;' |
  | 802 | 805 | ); |
  | […](/browser/clover-online-orders/trunk/admin/includes/class-wp-list-table-moo.php?rev=2986704#L1001) | […](/browser/clover-online-orders/trunk/admin/includes/class-wp-list-table-moo.php?rev=3168433#L1004) |  |
  | 1001 | 1004 | if ( ! empty( $columns['cb'] ) ) { |
  | 1002 | 1005 | static $cb\_counter = 1; |
  | 1003 |  | $columns['cb'] = '<label class="screen-reader-text" for="cb-select-all-' . $cb\_counter . '">' . \_\_( 'Select All' ) . '</label>' |
  |  | 1006 | $columns['cb'] = '<label class="screen-reader-text" for="cb-select-all-' . $cb\_counter . '">' . \_\_( 'Select All',"moo\_OnlineOrders" ) . '</label>' |
  | 1004 | 1007 | . '<input id="cb-select-all-' . $cb\_counter . '" type="checkbox" />'; |
  | 1005 | 1008 | $cb\_counter++; |
  | […](/browser/clover-online-orders/trunk/admin/includes/class-wp-list-table-moo.php?rev=2986704#L1252) | […](/browser/clover-online-orders/trunk/admin/includes/class-wp-list-table-moo.php?rev=3168433#L1255) |  |
  | 1252 | 1255 | \*/ |
  | 1253 | 1256 | protected function handle\_row\_actions( $item, $column\_name, $primary ) { |
  | 1254 |  | return $column\_name == $primary ? '<button type="button" class="toggle-row"><span class="screen-reader-text">' . \_\_( 'Show more details' ) . '</span></button>' : ''; |
  |  | 1257 | return $column\_name == $primary ? '<button type="button" class="toggle-row"><span class="screen-reader-text">' . \_\_( 'Show more details',"moo\_OnlineOrders" ) . '</span></button>' : ''; |
  | 1255 | 1258 | } |
  | 1256 | 1259 |  |
  | […](/browser/clover-online-orders/trunk/admin/includes/class-wp-list-table-moo.php?rev=2986704#L1276) | […](/browser/clover-online-orders/trunk/admin/includes/class-wp-list-table-moo.php?rev=3168433#L1279) |  |
  | 1276 | 1279 |  |
  | 1277 | 1280 | if ( isset( $this->\_pagination\_args['total\_items'] ) ) { |
  | 1278 |  | $response['total\_items\_i18n'] = sprintf( |
  | 1279 |  | \_n( '%s item', '%s items', $this->\_pagination\_args['total\_items'] ), |
  | 1280 |  | number\_format\_i18n( $this->\_pagination\_args['total\_items'] ) |
  | 1281 |  | ); |
  |  | 1281 | /\* translators: Nb Of items \*/ |
  |  | 1282 | $str = \_n( '%s item', '%s items', $this->\_pagination\_args['total\_items'],"moo\_OnlineOrders" ); |
  |  | 1283 | $response['total\_items\_i18n'] = sprintf($str, number\_format\_i18n( $this->\_pagination\_args['total\_items'] )); |
  | 1282 | 1284 | } |
  | 1283 | 1285 | if ( isset( $this->\_pagination\_args['total\_pages'] ) ) { |
* ## [clover-online-orders/trunk/admin/js/moo-OnlineOrders-admin.js](/changeset/3168433/clover-online-orders/trunk/admin/js/moo-OnlineOrders-admin.js "Show the changeset 3168433 restricted to clover-online-orders/trunk/admin/js/moo-OnlineOrders-admin.js")

  | [r3142846](/browser/clover-online-orders/trunk/admin/js/moo-OnlineOrders-admin.js?rev=3142846#L2468 "Show revision 3142846 of this file in browser") | [r3168433](/browser/clover-online-orders/trunk/admin/js/moo-OnlineOrders-admin.js?rev=3168433#L2468 "Show revision 3168433 of this file in browser") |  |
  | --- | --- | --- |
  | 2468 | 2468 | { |
  | 2469 | 2469 | e.preventDefault(); |
  | 2470 |  | var url = jQuery('#moo\_cat\_filter').val(); |
  | 2471 |  |  |
  | 2472 |  | if(url && url != '') { |
  | 2473 |  | document.location.href = url |
  |  | 2470 | var catUuid = jQuery('#moo\_cat\_filter').val(); |
  |  | 2471 | if(catUuid && catUuid !== '') { |
  |  | 2472 | document.location.href = 'admin.php?page=moo\_items&category='+catUuid; |
  | 2474 | 2473 | } else { |
  | 2475 | 2474 | document.location.href = 'admin.php?page=moo\_items'; |
  | 2476 | 2475 | } |
  | 2477 | 2476 | } |
  | 2478 |  | function moo\_markItemAsFeatured(e,item\_uuid~~, isFeaturedOld~~) { |
  |  | 2477 | function moo\_markItemAsFeatured(e,item\_uuid) { |
  | 2479 | 2478 | e.preventDefault(); |
  | 2480 | 2479 | swal({ |
  | […](/browser/clover-online-orders/trunk/admin/js/moo-OnlineOrders-admin.js?rev=3142846#L2520) | […](/browser/clover-online-orders/trunk/admin/js/moo-OnlineOrders-admin.js?rev=3168433#L2519) |  |
  | 2520 | 2519 | }); |
  | 2521 | 2520 | } |
  |  | 2521 | } else { |
  |  | 2522 | swal({ |
  |  | 2523 | title: "Error", |
  |  | 2524 | text: 'Try again', |
  |  | 2525 | type: "error", |
  |  | 2526 | confirmButtonText: "ok" |
  |  | 2527 | }); |
  |  | 2528 | } |
  |  | 2529 | }); |
  |  | 2530 | } |
  |  | 2531 | function moo\_markItemAsOutOfStock(e,item\_uuid) { |
  |  | 2532 | e.preventDefault(); |
  |  | 2533 | swal({ |
  |  | 2534 | title: 'Please wait ..', |
  |  | 2535 | showConfirmButton: false |
  |  | 2536 | }); |
  |  | 2537 | const isOutOfStock = jQuery(e.target).data('isOutOfStock'); |
  |  | 2538 | jQuery.ajax({ |
  |  | 2539 | type: 'POST', |
  |  | 2540 | url: moo\_RestUrl+"moo-clover/v1/dashboard/out\_of\_stock\_items", |
  |  | 2541 | contentType: 'application/json; charset=UTF-8', |
  |  | 2542 | beforeSend: function(jqXhr) { |
  |  | 2543 | jqXhr.setRequestHeader('X-WP-Nonce', moo\_params.nonce) |
  |  | 2544 | }, |
  |  | 2545 | data: JSON.stringify({"itemUuid":item\_uuid,"isOutOfStock":isOutOfStock}) |
  |  | 2546 | }).fail(function (data) { |
  |  | 2547 | //Change butn text |
  |  | 2548 | swal({ |
  |  | 2549 | title: "Error", |
  |  | 2550 | text: 'An has occurred, please refresh the page or contact us', |
  |  | 2551 | type: "error", |
  |  | 2552 | confirmButtonText: "ok" |
  |  | 2553 | }); |
  |  | 2554 | }).done(function (data) { |
  |  | 2555 | if(data.status === "success"){ |
  |  | 2556 | if (isOutOfStock){ |
  |  | 2557 | jQuery('#sooOutOfStockItem-'+item\_uuid).hide(); |
  |  | 2558 | jQuery('#sooInStockItem-'+item\_uuid).show(); |
  |  | 2559 | jQuery('#outofstock-item-'+item\_uuid).text("Yes"); |
  |  | 2560 | swal({ |
  |  | 2561 | title: "Done!", |
  |  | 2562 | text: 'The item has been marked as out of stock', |
  |  | 2563 | type: "success", |
  |  | 2564 | confirmButtonText: "ok" |
  |  | 2565 | }); |
  |  | 2566 | } else { |
  |  | 2567 | jQuery('#sooOutOfStockItem-'+item\_uuid).show(); |
  |  | 2568 | jQuery('#sooInStockItem-'+item\_uuid).hide(); |
  |  | 2569 | jQuery('#outofstock-item-'+item\_uuid).text("No"); |
  |  | 2570 | swal({ |
  |  | 2571 | title: "Done!", |
  |  | 2572 | text: 'The item has been marked as in stock', |
  |  | 2573 | type: "success", |
  |  | 2574 | confirmButtonText: "ok" |
  |  | 2575 | }); |
  |  | 2576 | } |
  |  | 2577 | } else { |
  |  | 2578 | swal({ |
  |  | 2579 | title: "Error", |
  |  | 2580 | text: 'Try again', |
  |  | 2581 | type: "error", |
  |  | 2582 | confirmButtonText: "ok" |
  |  | 2583 | }); |
  |  | 2584 | } |
  |  | 2585 | }); |
  |  | 2586 | } |
  |  | 2587 | function moo\_changeItemVisibility(e,item\_uuid) { |
  |  | 2588 | e.preventDefault(); |
  |  | 2589 | swal({ |
  |  | 2590 | title: 'Please wait ..', |
  |  | 2591 | showConfirmButton: false |
  |  | 2592 | }); |
  |  | 2593 | const isVisible = jQuery(e.target).data('is-visible'); |
  |  | 2594 | jQuery.ajax({ |
  |  | 2595 | type: 'POST', |
  |  | 2596 | url: moo\_RestUrl+"moo-clover/v1/dashboard/showhide\_items", |
  |  | 2597 | contentType: 'application/json; charset=UTF-8', |
  |  | 2598 | beforeSend: function(jqXhr) { |
  |  | 2599 | jqXhr.setRequestHeader('X-WP-Nonce', moo\_params.nonce) |
  |  | 2600 | }, |
  |  | 2601 | data: JSON.stringify({"itemUuid":item\_uuid,"visibility":!isVisible}) |
  |  | 2602 | }).fail(function (data) { |
  |  | 2603 | //Change butn text |
  |  | 2604 | swal({ |
  |  | 2605 | title: "Error", |
  |  | 2606 | text: 'An has occurred, please refresh the page or contact us', |
  |  | 2607 | type: "error", |
  |  | 2608 | confirmButtonText: "ok" |
  |  | 2609 | }); |
  |  | 2610 | }).done(function (data) { |
  |  | 2611 | if(data.status === "success") { |
  |  | 2612 | if (!isVisible){ |
  |  | 2613 | jQuery('#sooShowAnItem-'+item\_uuid).hide(); |
  |  | 2614 | jQuery('#sooHideAnItem-'+item\_uuid).show(); |
  |  | 2615 | jQuery('#visibility-item-'+item\_uuid).text("No"); |
  |  | 2616 | swal({ |
  |  | 2617 | title: "Done!", |
  |  | 2618 | text: 'The item has been marked as visible', |
  |  | 2619 | type: "success", |
  |  | 2620 | confirmButtonText: "ok" |
  |  | 2621 | }); |
  |  | 2622 | } else { |
  |  | 2623 | jQuery('#sooShowAnItem-'+item\_uuid).show(); |
  |  | 2624 | jQuery('#sooHideAnItem-'+item\_uuid).hide(); |
  |  | 2625 | jQuery('#visibility-item-'+item\_uuid).text("Yes"); |
  |  | 2626 | swal({ |
  |  | 2627 | title: "Done!", |
  |  | 2628 | text: 'The item has been marked as hidden', |
  |  | 2629 | type: "success", |
  |  | 2630 | confirmButtonText: "ok" |
  |  | 2631 | }); |
  |  | 2632 | } |
  |  | 2633 | jQuery('#soo-item-row-'+item\_uuid).toggleClass( "item-hidden" ); |
  | 2522 | 2634 | } else { |
  | 2523 | 2635 | swal({ |
  | […](/browser/clover-online-orders/trunk/admin/js/moo-OnlineOrders-admin.js?rev=3142846#L2906) | […](/browser/clover-online-orders/trunk/admin/js/moo-OnlineOrders-admin.js?rev=3168433#L3018) |  |
  | 2906 | 3018 | }) |
  | 2907 | 3019 | } |
  |  | 3020 |  |
  |  | 3021 | /\* |
  |  | 3022 | \* Repair the database issues |
  |  | 3023 | \* @version 1.5.8 |
  |  | 3024 | \*/ |
  |  | 3025 |  |
  |  | 3026 | function sooRepairDatabase(e) |
  |  | 3027 | { |
  |  | 3028 | e.preventDefault(); |
  |  | 3029 | swal({ |
  |  | 3030 | title: 'Repairing your database', |
  |  | 3031 | text: 'Please wait...', |
  |  | 3032 | showConfirmButton: false |
  |  | 3033 | }); |
  |  | 3034 | jQuery.ajax({ |
  |  | 3035 | type: 'GET', |
  |  | 3036 | url: moo\_RestUrl+"moo-clover/v1/tools/repair\_database", |
  |  | 3037 | beforeSend: function(jqXhr) { |
  |  | 3038 | jqXhr.setRequestHeader('X-WP-Nonce', moo\_params.nonce) |
  |  | 3039 | } |
  |  | 3040 | }).fail(function (data) { |
  |  | 3041 | //Change butn text |
  |  | 3042 | swal({ |
  |  | 3043 | title: "Error", |
  |  | 3044 | text: 'An has occurred, please refresh the page or contact us', |
  |  | 3045 | type: "error", |
  |  | 3046 | confirmButtonText: "ok" |
  |  | 3047 | }); |
  |  | 3048 | }).done(function (data) { |
  |  | 3049 | if(data.status === "success"){ |
  |  | 3050 | swal({ |
  |  | 3051 | title: "All Done!", |
  |  | 3052 | text: 'Your database has been repaired.', |
  |  | 3053 | type: "success", |
  |  | 3054 | confirmButtonText: "ok" |
  |  | 3055 | }); |
  |  | 3056 | } else { |
  |  | 3057 | swal({ |
  |  | 3058 | title: "Error", |
  |  | 3059 | text: 'Database repair was not completed successfully. Please verify your data or contact support if the issue persists', |
  |  | 3060 | type: "error", |
  |  | 3061 | confirmButtonText: "ok" |
  |  | 3062 | }); |
  |  | 3063 | } |
  |  | 3064 | }); |
  |  | 3065 | } |
  | 2908 | 3066 | /\* |
  | 2909 | 3067 | \* This function to Clean the inventory, we set teh typOfdate wich may take (order\_tyes,tax\_rates,categories,items..) |
  | […](/browser/clover-online-orders/trunk/admin/js/moo-OnlineOrders-admin.js?rev=3142846#L3114) | […](/browser/clover-online-orders/trunk/admin/js/moo-OnlineOrders-admin.js?rev=3168433#L3272) |  |
  | 3114 | 3272 | }); |
  | 3115 | 3273 | } |
  | 3116 |  | function enableOrDisable~~New~~Checkout() { |
  | 3117 |  | const enable = jQuery('#soo~~New~~CheckoutPage').is(":checked"); |
  |  | 3274 | function enableOrDisableOldCheckout() { |
  |  | 3275 | const enable = jQuery('#sooOldCheckoutPage').is(":checked"); |
  | 3118 | 3276 | if(enable){ |
  | 3119 | 3277 | swal({ |
  | 3120 |  | title: 'Enabling the ~~new~~ Checkout page...', |
  |  | 3278 | title: 'Enabling the old Checkout page...', |
  | 3121 | 3279 | showConfirmButton: false |
  | 3122 | 3280 | }); |
  | […](/browser/clover-online-orders/trunk/admin/js/moo-OnlineOrders-admin.js?rev=3142846#L3128) | […](/browser/clover-online-orders/trunk/admin/js/moo-OnlineOrders-admin.js?rev=3168433#L3286) |  |
  | 3128 | 3286 | } |
  | 3129 | 3287 |  |
  | 3130 |  | let endpoint = moo\_RestUrl+'moo-clover/v2/dash/enable-new-checkout'; |
  | 3131 |  |  |
  |  | 3288 | let endpoint = moo\_RestUrl+'moo-clover/v2/dash/enable-old-checkout'; |
  | 3132 | 3289 | if(moo\_RestUrl.indexOf("?rest\_route") !== -1){ |
  | 3133 | 3290 | endpoint += '&\_wpnonce='+ moo\_params.nonce; |
  | […](/browser/clover-online-orders/trunk/admin/js/moo-OnlineOrders-admin.js?rev=3142846#L3135) | […](/browser/clover-online-orders/trunk/admin/js/moo-OnlineOrders-admin.js?rev=3168433#L3292) |  |
  | 3135 | 3292 | endpoint += '?\_wpnonce='+ moo\_params.nonce; |
  | 3136 | 3293 | } |
  | 3137 |  |  |
  | 3138 | 3294 | var data = { |
  | 3139 | 3295 | "status":enable |
  | […](/browser/clover-online-orders/trunk/admin/js/moo-OnlineOrders-admin.js?rev=3142846#L3145) | […](/browser/clover-online-orders/trunk/admin/js/moo-OnlineOrders-admin.js?rev=3168433#L3301) |  |
  | 3145 | 3301 | swal({ |
  | 3146 | 3302 | type:"success", |
  | 3147 |  | title:"New Checkout Page is Now Live", |
  |  | 3303 | title:"Old Checkout Page is Enabled", |
  |  | 3304 | text:"Checkout beta enabled, Google Pay and DoorDash Drive Integration is available with this feature reach out to support@zaytech.com for instructions on how to get started." |
  |  | 3305 | }); |
  |  | 3306 | jQuery('#sooAdditionalPaymentMethods').hide(); |
  |  | 3307 | // Show Google Recaptcha |
  |  | 3308 | } else { |
  |  | 3309 | swal({ |
  |  | 3310 | type:"success", |
  |  | 3311 | title:"Old Checkout Page is Disabled", |
  | 3148 | 3312 | text:"Checkout beta enabled, Google Pay and DoorDash Drive Integration is available with this feature reach out to support@zaytech.com for instructions on how to get started." |
  | 3149 | 3313 | }); |
  | 3150 | 3314 | jQuery('#sooAdditionalPaymentMethods').show(); |
  | 3151 |  | ~~// Show Google Recaptcha~~ |
  | 3152 |  | ~~} else {~~ |
  | 3153 |  | ~~swal({~~ |
  | 3154 |  | ~~type:"warning",~~ |
  | 3155 |  | ~~title:'Change to Previous Version Confirmed',~~ |
  | 3156 |  | ~~text:'Reverting back to the previous version, if you have experienced any issues please provide an image and description of the issue to support@zaytech.com'~~ |
  | 3157 |  | ~~});~~ |
  | 3158 |  | ~~jQuery('#sooAdditionalPaymentMethods').hide();~~ |
  | 3159 | 3315 | // Hide Google Recaptcha |
  | 3160 | 3316 | } |
  | 3161 | 3317 | } else { |
  | 3162 |  | jQuery('#soo~~New~~CheckoutPage').prop('checked',!enable) |
  |  | 3318 | jQuery('#sooOldCheckoutPage').prop('checked',!enable) |
  | 3163 | 3319 | swal({ |
  | 3164 | 3320 | type:"error", |
  | […](/browser/clover-online-orders/trunk/admin/js/moo-OnlineOrders-admin.js?rev=3142846#L3168) | […](/browser/clover-online-orders/trunk/admin/js/moo-OnlineOrders-admin.js?rev=3168433#L3324) |  |
  | 3168 | 3324 |  |
  | 3169 | 3325 | }).fail(function (response) { |
  | 3170 |  | jQuery('#soo~~New~~CheckoutPage').prop('checked',!enable) |
  |  | 3326 | jQuery('#sooOldCheckoutPage').prop('checked',!enable) |
  | 3171 | 3327 | swal({ |
  | 3172 | 3328 | text: 'Error Occurred: Please Refresh and Retry' |
  | […](/browser/clover-online-orders/trunk/admin/js/moo-OnlineOrders-admin.js?rev=3142846#L3282) | […](/browser/clover-online-orders/trunk/admin/js/moo-OnlineOrders-admin.js?rev=3168433#L3438) |  |
  | 3282 | 3438 | function mooShowWaitMessage() { |
  | 3283 | 3439 | swal({ |
  | 3284 |  | title: 'Saving your changes~~, please wait~~ ..', |
  |  | 3440 | title: 'Saving your changes ..', |
  | 3285 | 3441 | showConfirmButton: false |
  | 3286 | 3442 | }); |
* ## [clover-online-orders/trunk/admin/moo-OnlineOrders-admin.php](/changeset/3168433/clover-online-orders/trunk/admin/moo-OnlineOrders-admin.php "Show the changeset 3168433 restricted to clover-online-orders/trunk/admin/moo-OnlineOrders-admin.php")

  | [r3142846](/browser/clover-online-orders/trunk/admin/moo-OnlineOrders-admin.php?rev=3142846#L87 "Show revision 3142846 of this file in browser") | [r3168433](/browser/clover-online-orders/trunk/admin/moo-OnlineOrders-admin.php?rev=3168433#L87 "Show revision 3168433 of this file in browser") |  |
  | --- | --- | --- |
  | 87 | 87 | $products->prepare\_items(); |
  | 88 | 88 | $model = $this->model; |
  | 89 |  | if(isset($\_GET['action']) && $\_GET['action'] == 'update\_item')  { |
  | 90 |  | if(isset($\_GET['item\_uuid']) && $\_GET['item\_uuid'] != '') { |
  |  | 89 | if(isset($\_GET['action']) && $\_GET['action'] == 'update\_item'  && !empty($\_GET['item\_uuid']))  { |
  | 91 | 90 | $item\_uuid = esc\_attr($\_GET['item\_uuid']); |
  | 92 | 91 | $item = $model->getItem($item\_uuid); |
  | […](/browser/clover-online-orders/trunk/admin/moo-OnlineOrders-admin.php?rev=3142846#L99) | […](/browser/clover-online-orders/trunk/admin/moo-OnlineOrders-admin.php?rev=3168433#L98) |  |
  | 99 | 98 | $customHours = $this->api->getMerchantCustomHours("categories"); |
  | 100 | 99 |  |
  | 101 |  | if(~~isset($\_GET['paged']) && $\_GET['paged'] != ''~~){ |
  | 102 |  | $goBackLink = 'admin.php?page=moo\_items&paged='.~~intval~~($\_GET['paged']); |
  |  | 100 | if(!empty($\_GET['paged'])){ |
  |  | 101 | $goBackLink = 'admin.php?page=moo\_items&paged='.esc\_attr($\_GET['paged']); |
  | 103 | 102 | } else { |
  | 104 | 103 | $goBackLink = 'admin.php?page=moo\_items'; |
  | 105 | 104 | } |
  | 106 |  | if(isset($\_GET['category']) && $\_GET['category'] != ''){ |
  | 107 |  | $goBackLink = $goBackLink . '&category='. sanitize\_text\_field($\_GET['category']); |
  |  | 105 | if(!empty($\_GET['category'])){ |
  |  | 106 | $goBackLink = $goBackLink . '&category='. esc\_attr($\_GET['category']); |
  |  | 107 | } |
  |  | 108 | if(!empty($\_GET['filter'])){ |
  |  | 109 | $goBackLink = $goBackLink . '&filter='. esc\_attr($\_GET['filter']); |
  | 108 | 110 | } |
  | 109 | 111 |  |
  | […](/browser/clover-online-orders/trunk/admin/moo-OnlineOrders-admin.php?rev=3142846#L168) | […](/browser/clover-online-orders/trunk/admin/moo-OnlineOrders-admin.php?rev=3168433#L170) |  |
  | 168 | 170 |  |
  | 169 | 171 | <?php |
  | 170 |  | } |
  |  | 172 |  |
  | 171 | 173 | } else { |
  | 172 | 174 | ?> |
  | […](/browser/clover-online-orders/trunk/admin/moo-OnlineOrders-admin.php?rev=3142846#L475) | […](/browser/clover-online-orders/trunk/admin/moo-OnlineOrders-admin.php?rev=3168433#L477) |  |
  | 475 | 477 | <?php if($message!="") echo $message; ?> |
  | 476 | 478 | <h1 style="float: left;">List of coupons</h1> |
  | 477 |  | <a href="<?php echo add\_query\_arg(array("action"=>"add\_coupon"),remove\_query\_arg( array('coupon', 'paged'))); ?>" class="page-title-action" style="float: left;top: 11px;margin-left: 18px;">Add Coupon</a> |
  |  | 479 | <a href="<?php |
  |  | 480 | echo add\_query\_arg(array("action"=>"add\_coupon"),admin\_url('admin.php?page=moo\_coupons')); |
  |  | 481 | ?>" class="page-title-action" style="float: left;top: 11px;margin-left: 18px;">Add Coupon</a> |
  | 478 | 482 | <div id="poststuff"> |
  | 479 | 483 | <div id="post-body" class="metabox-holder"> |
  | […](/browser/clover-online-orders/trunk/admin/moo-OnlineOrders-admin.php?rev=3142846#L940) | […](/browser/clover-online-orders/trunk/admin/moo-OnlineOrders-admin.php?rev=3168433#L944) |  |
  | 940 | 944 | <p class="moo-merchant-address"></p> |
  | 941 | 945 | <?php |
  | 942 |  | $link = esc\_url(add\_query\_arg(~~'moo\_section', 'update\_address',(admin\_url('admin.php?page=moo\_index')~~))); |
  |  | 946 | $link = esc\_url(add\_query\_arg(array('moo\_section'=>'update\_address'),admin\_url('admin.php?page=moo\_index'))); |
  | 943 | 947 | if($mooOptions['lat'] === null || $mooOptions['lng'] === null){ |
  | 944 | 948 | echo '<a href="'.$link.'">Click here to localize the address on map to calulcate delivery fees correctly</a>'; |
  | […](/browser/clover-online-orders/trunk/admin/moo-OnlineOrders-admin.php?rev=3142846#L992) | […](/browser/clover-online-orders/trunk/admin/moo-OnlineOrders-admin.php?rev=3168433#L996) |  |
  | 992 | 996 | </div> |
  | 993 | 997 | <?php } ?> |
  | 994 |  | ~~<div class="moo-row moo-subSection">~~ |
  | 995 |  | ~~<div class="moo-col-md-2 moo-centred">~~ |
  | 996 |  | ~~<img  width="80px" src="<?php echo plugin\_dir\_url(dirname(\_\_FILE\_\_))."admin/img/iconSooNew.svg";?>" alt=""/>~~ |
  | 997 |  | ~~</div>~~ |
  | 998 |  | ~~<div class="moo-col-md-8">~~ |
  | 999 |  | ~~<?php~~ |
  | 1000 |  | ~~$newCheckoutEnabled = get\_option('moo\_new\_checkout\_enabled') === 'yes';~~ |
  | 1001 |  | ~~echo "<h3>New (Beta) Checkout Page</h3>";~~ |
  | 1002 |  | ~~echo "<p>Will allow customers to earn Loyalty Points when Ordering from the Website. For even more convenience, we recommend getting the Branded App to give customers even more control.</p>";~~ |
  | 1003 |  | ~~?>~~ |
  | 1004 |  | ~~</div>~~ |
  | 1005 |  | ~~<div class="moo-col-md-2">~~ |
  | 1006 |  | ~~<div class="soo-onoffswitch" title="Enable or disable the new checkout" style="float: right;margin-top: 38px;margin-right: 20px;">~~ |
  | 1007 |  | ~~<input type="checkbox" name="sooNewCheckoutPage" id="sooNewCheckoutPage" class="soo-onoffswitch-checkbox" onchange="enableOrDisableNewCheckout()" <?php  echo $newCheckoutEnabled?'checked':''; ?> >~~ |
  | 1008 |  | ~~<label class="soo-onoffswitch-label" for="sooNewCheckoutPage">~~ |
  | 1009 |  | ~~<span class="soo-onoffswitch-inner"></span>~~ |
  | 1010 |  | ~~<span class="soo-onoffswitch-switch"></span>~~ |
  | 1011 |  | ~~</label>~~ |
  | 1012 |  | ~~</div>~~ |
  | 1013 |  | ~~</div>~~ |
  | 1014 |  | ~~</div>~~ |
  | 1015 | 998 | <div class="moo-row moo-subSection"> |
  | 1016 | 999 | <div class="moo-col-md-12"> |
  | […](/browser/clover-online-orders/trunk/admin/moo-OnlineOrders-admin.php?rev=3142846#L1197) | […](/browser/clover-online-orders/trunk/admin/moo-OnlineOrders-admin.php?rev=3168433#L1180) |  |
  | 1197 | 1180 | <div class="Moo\_option-item"> |
  | 1198 | 1181 | <div class="button\_center"> |
  | 1199 |  | <a href="#" onclick="MooPanel\_CleanInventory(event)" class="button button-secondary"  style="margin: 0 auto">Clean Inventory</a> |
  |  | 1182 | <a href="#" onclick="MooPanel\_CleanInventory(event)" class="button button-secondary moo-form-inline"  style="margin: 0 auto">Clean Inventory</a> |
  |  | 1183 | </div> |
  |  | 1184 | </div> |
  |  | 1185 |  |
  |  | 1186 | </div> |
  |  | 1187 | <div class="MooPanelItem"> |
  |  | 1188 | <h3>Repair Database</h3> |
  |  | 1189 | <p> |
  |  | 1190 | If you encounter issues with importing your inventory or syncing, it may be due to upgrading from an older version without the database updating correctly. In this case, use the "Repair Database" button to resolve all database issues. If the problem persists, contact us at [ support@zaytech.com ] for further assistance. |
  |  | 1191 | </p> |
  |  | 1192 | <div id="moo\_progressbar\_container"></div> |
  |  | 1193 | <div class="Moo\_option-item"> |
  |  | 1194 | <div class="button\_center"> |
  |  | 1195 | <a href="#" onclick="sooRepairDatabase(event)" class="button button-secondary"  style="margin: 0 auto">Repair Database</a> |
  | 1200 | 1196 | </div> |
  | 1201 | 1197 |  |
  | […](/browser/clover-online-orders/trunk/admin/moo-OnlineOrders-admin.php?rev=3142846#L1602) | […](/browser/clover-online-orders/trunk/admin/moo-OnlineOrders-admin.php?rev=3168433#L1598) |  |
  | 1602 | 1598 | </span> |
  | 1603 | 1599 | </div> |
  | 1604 |  | <div ~~id="sooAdditionalPaymentMethods" style="display: <?php echo get\_option('moo\_new\_checkout\_enabled') === 'yes' ? 'block':'none~~'; ?>"> |
  | 1605 |  | <div class="Moo\_option-item~~" style="display:<?php echo (!empty(SOO\_ACCEPT\_GIFTCARDS))?"block":"none"; ?>"~~> |
  |  | 1600 | <div  id="sooAdditionalPaymentMethods" class="<?php echo get\_option('moo\_old\_checkout\_enabled') === 'yes' ? 'soo-display-none':'soo-display-block'; ?>"> |
  |  | 1601 | <div class="Moo\_option-item <?php echo (!empty(SOO\_ACCEPT\_GIFTCARDS))?"soo-display-block":"soo-display-none"; ?>" > |
  | 1606 | 1602 | <div style="margin-bottom: 14px;" class="label">Accept Clover Gift Cards</div> |
  | 1607 | 1603 | <div class="moo-onoffswitch"  title="Accept Clover Gift Cards"> |
  | […](/browser/clover-online-orders/trunk/admin/moo-OnlineOrders-admin.php?rev=3142846#L1870) | […](/browser/clover-online-orders/trunk/admin/moo-OnlineOrders-admin.php?rev=3168433#L1866) |  |
  | 1870 | 1866 | <label id="MooTextUnderSI" >Your text</label> |
  | 1871 | 1867 | </div> |
  | 1872 |  | <div class="iwl\_input\_holder"><input name="moo\_settings[text\_under\_special\_instructions]" id="MooTextUnderSI" type="text" value="<?php echo $mooOptions['text\_under\_special\_instructions']?>" /></div> |
  |  | 1868 | <div class="iwl\_input\_holder"> |
  |  | 1869 | <textarea name="moo\_settings[text\_under\_special\_instructions]"  id="MooTextUnderSI" type="text"><?php echo $mooOptions['text\_under\_special\_instructions']?></textarea> |
  |  | 1870 | </div> |
  | 1873 | 1871 | </div> |
  | 1874 | 1872 | </div> |
  | […](/browser/clover-online-orders/trunk/admin/moo-OnlineOrders-admin.php?rev=3142846#L1889) | […](/browser/clover-online-orders/trunk/admin/moo-OnlineOrders-admin.php?rev=3168433#L1887) |  |
  | 1889 | 1887 |  |
  | 1890 | 1888 | </div> |
  | 1891 |  | <!-- Thank you page --> |
  |  | 1889 | <!-- Thank you page --> |
  | 1892 | 1890 | <div class="MooPanelItem MooPanelItemExpanded"> |
  | 1893 | 1891 | <h3 onclick="expandSection(this)">Thank you page</h3> |
  | […](/browser/clover-online-orders/trunk/admin/moo-OnlineOrders-admin.php?rev=3142846#L1919) | […](/browser/clover-online-orders/trunk/admin/moo-OnlineOrders-admin.php?rev=3168433#L1917) |  |
  | 1919 | 1917 | <div class="iwl\_holder"><div class="iwl\_label\_holder"><label id="MooDefaultMerchantEmail" >Or Enter The Full URL</label></div> |
  | 1920 | 1918 | <div class="iwl\_input\_holder"><input name="moo\_settings[thanks\_page]" id="MooDefaultMerchantEmail" type="text" value="<?php echo $mooOptions['thanks\_page']?>" placeholder="https://" /></div> |
  |  | 1919 | </div> |
  |  | 1920 | </div> |
  |  | 1921 | </div> |
  |  | 1922 | <!-- Enable old Checkout back in case if issues --> |
  |  | 1923 | <div class="MooPanelItem MooPanelItemExpanded"> |
  |  | 1924 | <?php |
  |  | 1925 | $oldCheckoutEnabled = get\_option('moo\_old\_checkout\_enabled') === 'yes'; |
  |  | 1926 | ?> |
  |  | 1927 | <h3 onclick="expandSection(this)">Return to Previous Checkout</h3> |
  |  | 1928 | <div class="Moo\_option-item" > |
  |  | 1929 | <div class="normal\_text"> |
  |  | 1930 | Reverting back to the previous version of checkout page, if you have experienced any issues please provide an image and description of the issue to support@zaytech.com. The previous version is available for a limited time. |
  |  | 1931 | </div> |
  |  | 1932 | </div> |
  |  | 1933 | <div class="Moo\_option-item" > |
  |  | 1934 | <div class="normal\_text"> |
  |  | 1935 | <div class="soo-onoffswitch" title="Enable or disable the new checkout" style="float: right;margin-top: 38px;margin-right: 20px;"> |
  |  | 1936 | <input type="checkbox" name="sooOldCheckoutPage" id="sooOldCheckoutPage" class="soo-onoffswitch-checkbox" onchange="enableOrDisableOldCheckout()" <?php  echo $oldCheckoutEnabled?'checked':''; ?> > |
  |  | 1937 | <label class="soo-onoffswitch-label" for="sooOldCheckoutPage"> |
  |  | 1938 | <span class="soo-onoffswitch-inner"></span> |
  |  | 1939 | <span class="soo-onoffswitch-switch"></span> |
  |  | 1940 | </label> |
  |  | 1941 | </div> |
  | 1921 | 1942 | </div> |
  | 1922 | 1943 | </div> |
* ## [clover-online-orders/trunk/includes/moo-OnlineOrders-Restapi.php](/changeset/3168433/clover-online-orders/trunk/includes/moo-OnlineOrders-Restapi.php "Show the changeset 3168433 restricted to clover-online-orders/trunk/includes/moo-OnlineOrders-Restapi.php")

  | [r3142846](/browser/clover-online-orders/trunk/includes/moo-OnlineOrders-Restapi.php?rev=3142846#L318 "Show revision 3142846 of this file in browser") | [r3168433](/browser/clover-online-orders/trunk/includes/moo-OnlineOrders-Restapi.php?rev=3168433#L318 "Show revision 3168433 of this file in browser") |  |
  | --- | --- | --- |
  | 318 | 318 | ) ); |
  | 319 | 319 |  |
  | 320 |  | // Get Fresh version for blackout times |
  |  | 320 | // Get a Fresh version for blackout times |
  | 321 | 321 | register\_rest\_route( $this->namespace, '/tools/update\_blackouts', array( |
  | 322 | 322 | array( |
  | […](/browser/clover-online-orders/trunk/includes/moo-OnlineOrders-Restapi.php?rev=3142846#L324) | […](/browser/clover-online-orders/trunk/includes/moo-OnlineOrders-Restapi.php?rev=3168433#L324) |  |
  | 324 | 324 | 'callback'  => array( $this, 'updateBlackouts' ), |
  | 325 | 325 | 'permission\_callback' => '\_\_return\_true' |
  |  | 326 | ) |
  |  | 327 | ) ); |
  |  | 328 |  |
  |  | 329 | register\_rest\_route( $this->namespace, '/tools/repair\_database', array( |
  |  | 330 | array( |
  |  | 331 | 'methods'   => 'GET', |
  |  | 332 | 'callback'  => array( $this, 'repairDatabase' ), |
  |  | 333 | 'permission\_callback' => array( $this, 'permissionCheck' ) |
  | 326 | 334 | ) |
  | 327 | 335 | ) ); |
  | […](/browser/clover-online-orders/trunk/includes/moo-OnlineOrders-Restapi.php?rev=3142846#L429) | […](/browser/clover-online-orders/trunk/includes/moo-OnlineOrders-Restapi.php?rev=3168433#L437) |  |
  | 429 | 437 | ) |
  | 430 | 438 | ) ); |
  |  | 439 |  |
  |  | 440 | register\_rest\_route( $this->namespace, '/dashboard/out\_of\_stock\_items', array( |
  |  | 441 | array( |
  |  | 442 | 'methods'   => 'POST', |
  |  | 443 | 'callback'  => array( $this, 'markItemAsOutOfStock' ), |
  |  | 444 | 'permission\_callback' => array( $this, 'permissionCheck' ) |
  |  | 445 | ) |
  |  | 446 | ) ); |
  |  | 447 |  |
  |  | 448 | register\_rest\_route( $this->namespace, '/dashboard/showhide\_items', array( |
  |  | 449 | array( |
  |  | 450 | 'methods'   => 'POST', |
  |  | 451 | 'callback'  => array( $this, 'showHideAnItem' ), |
  |  | 452 | 'permission\_callback' => array( $this, 'permissionCheck' ) |
  |  | 453 | ) |
  |  | 454 | ) ); |
  |  | 455 |  |
  | 431 | 456 |  |
  | 432 | 457 | //Customer account functions |
  | […](/browser/clover-online-orders/trunk/includes/moo-OnlineOrders-Restapi.php?rev=3142846#L1807) | […](/browser/clover-online-orders/trunk/includes/moo-OnlineOrders-Restapi.php?rev=3168433#L1832) |  |
  | 1807 | 1832 | } |
  | 1808 | 1833 | } |
  |  | 1834 | public function markItemAsOutOfStock($request) { |
  |  | 1835 | $request\_body   = json\_decode($request->get\_body(),true); |
  |  | 1836 | $itemUuid    = sanitize\_text\_field($request\_body['itemUuid']); |
  |  | 1837 | $isOutOfStock    = boolval($request\_body['isOutOfStock']); |
  |  | 1838 |  |
  |  | 1839 | if( ! empty($itemUuid) ) { |
  |  | 1840 | $res = $this->model->updateItem(["outofstock"=>$isOutOfStock, "uuid"=>$itemUuid,], true); |
  |  | 1841 | if ($res){ |
  |  | 1842 | $this->api->sendEvent([ |
  |  | 1843 | "event"=>'updated-items' |
  |  | 1844 | ]); |
  |  | 1845 | } |
  |  | 1846 | return array( |
  |  | 1847 | 'status'    => $res ? 'success' :  'failed' |
  |  | 1848 | ); |
  |  | 1849 | } else { |
  |  | 1850 | return array( |
  |  | 1851 | 'status'    => 'failed' |
  |  | 1852 | ); |
  |  | 1853 | } |
  |  | 1854 | } |
  |  | 1855 | public function showHideAnItem($request) { |
  |  | 1856 | $request\_body   = json\_decode($request->get\_body(),true); |
  |  | 1857 | $itemUuid    = sanitize\_text\_field($request\_body['itemUuid']); |
  |  | 1858 | $visibility    = boolval($request\_body['visibility']); |
  |  | 1859 |  |
  |  | 1860 | if( ! empty($itemUuid) ) { |
  |  | 1861 | $res = $this->model->updateItem(["visible"=>$visibility, "uuid"=>$itemUuid,], true); |
  |  | 1862 | if ($res){ |
  |  | 1863 | $this->api->sendEvent([ |
  |  | 1864 | "event"=>'updated-items' |
  |  | 1865 | ]); |
  |  | 1866 | } |
  |  | 1867 | return array( |
  |  | 1868 | 'status'    => $res ? 'success' :  'failed' |
  |  | 1869 | ); |
  |  | 1870 | } else { |
  |  | 1871 | return array( |
  |  | 1872 | 'status'    => 'failed' |
  |  | 1873 | ); |
  |  | 1874 | } |
  |  | 1875 | } |
  | 1809 | 1876 | public function changeApiKey($request) { |
  | 1810 | 1877 | $request\_body   = json\_decode($request->get\_body(),true); |
  | […](/browser/clover-online-orders/trunk/includes/moo-OnlineOrders-Restapi.php?rev=3142846#L1865) | […](/browser/clover-online-orders/trunk/includes/moo-OnlineOrders-Restapi.php?rev=3168433#L1932) |  |
  | 1865 | 1932 | "status"=>'success', |
  | 1866 | 1933 | ); |
  |  | 1934 | } |
  |  | 1935 | public function repairDatabase( $request ){ |
  |  | 1936 | try { |
  |  | 1937 | if (! class\_exists( 'Moo\_OnlineOrders\_Helpers' ) ){ |
  |  | 1938 | require\_once SOO\_PLUGIN\_PATH ."/includes/moo-OnlineOrders-helpers.php"; |
  |  | 1939 | } |
  |  | 1940 |  |
  |  | 1941 | Moo\_OnlineOrders\_Helpers::upgradeDatabaseToVersion136(); |
  |  | 1942 | Moo\_OnlineOrders\_Helpers::upgradeDatabaseToVersion150(); |
  |  | 1943 | Moo\_OnlineOrders\_Helpers::upgradeDatabaseToVersion158(); |
  |  | 1944 |  |
  |  | 1945 | return array( |
  |  | 1946 | "status"=>'success', |
  |  | 1947 | ); |
  |  | 1948 |  |
  |  | 1949 | } catch (Exception $e) { |
  |  | 1950 | return array( |
  |  | 1951 | "status"=>'error', |
  |  | 1952 | ); |
  |  | 1953 | } |
  | 1867 | 1954 | } |
  | 1868 | 1955 |  |
* ## [clover-online-orders/trunk/includes/moo-OnlineOrders-activator.php](/changeset/3168433/clover-online-orders/trunk/includes/moo-OnlineOrders-activator.php "Show the changeset 3168433 restricted to clover-online-orders/trunk/includes/moo-OnlineOrders-activator.php")

  | [r3142846](/browser/clover-online-orders/trunk/includes/moo-OnlineOrders-activator.php?rev=3142846#L486 "Show revision 3142846 of this file in browser") | [r3168433](/browser/clover-online-orders/trunk/includes/moo-OnlineOrders-activator.php?rev=3168433#L486 "Show revision 3168433 of this file in browser") |  |
  | --- | --- | --- |
  | 486 | 486 | ) |
  | 487 | 487 | ); |
  | 488 |  | $~~defaul~~tOptions = (array)get\_option( 'moo\_settings' ); |
  | 489 |  |  |
  | 490 |  | if(!isset($~~defaultOptions['store\_page']) || $defaul~~tOptions['store\_page'] == "" ) |
  |  | 488 | $currentOptions = (array)get\_option( 'moo\_settings' ); |
  |  | 489 |  |
  |  | 490 | if(!isset($currentOptions['store\_page']) || $currentOptions['store\_page'] == "" ) |
  | 491 | 491 | { |
  | 492 | 492 | $store\_page\_id =  wp\_insert\_post( $pages['store'], false ); |
  | 493 |  | $~~defaul~~tOptions['store\_page'] = $store\_page\_id ; |
  |  | 493 | $currentOptions['store\_page'] = $store\_page\_id ; |
  | 494 | 494 | } |
  | 495 |  | if(!isset($~~defaultOptions['checkout\_page']) || $defaul~~tOptions['checkout\_page'] == "") |
  |  | 495 | if(!isset($currentOptions['checkout\_page']) || $currentOptions['checkout\_page'] == "") |
  | 496 | 496 | { |
  | 497 | 497 | $checkout\_page\_id =  wp\_insert\_post( $pages['checkout'], false ); |
  | 498 |  | $~~defaul~~tOptions['checkout\_page'] =  $checkout\_page\_id; |
  |  | 498 | $currentOptions['checkout\_page'] =  $checkout\_page\_id; |
  | 499 | 499 | } |
  | 500 |  | if(!isset($~~defaultOptions['cart\_page']) || $defaul~~tOptions['cart\_page'] == "") |
  |  | 500 | if(!isset($currentOptions['cart\_page']) || $currentOptions['cart\_page'] == "") |
  | 501 | 501 | { |
  | 502 | 502 | $cart\_page\_id  =  wp\_insert\_post( $pages['cart'], false ); |
  | 503 |  | $~~defaul~~tOptions['cart\_page'] = $cart\_page\_id ; |
  |  | 503 | $currentOptions['cart\_page'] = $cart\_page\_id ; |
  | 504 | 504 | } |
  | 505 |  | if(!isset($~~defaultOptions['my\_account\_page']) || $defaul~~tOptions['my\_account\_page'] == "") |
  |  | 505 | if(!isset($currentOptions['my\_account\_page']) || $currentOptions['my\_account\_page'] == "") |
  | 506 | 506 | { |
  | 507 | 507 | $login\_page\_id  =  wp\_insert\_post( $pages['my\_account\_page'], false ); |
  | 508 |  | $~~defaul~~tOptions['my\_account\_page'] = $login\_page\_id ; |
  |  | 508 | $currentOptions['my\_account\_page'] = $login\_page\_id ; |
  | 509 | 509 | } |
  | 510 | 510 |  |
  | […](/browser/clover-online-orders/trunk/includes/moo-OnlineOrders-activator.php?rev=3142846#L513) | […](/browser/clover-online-orders/trunk/includes/moo-OnlineOrders-activator.php?rev=3168433#L513) |  |
  | 513 | 513 |  |
  | 514 | 514 | // Enable the new checkout |
  | 515 |  | update\_option("moo\_~~new\_checkout\_enabled",'yes~~'); |
  | 516 |  |  |
  | 517 |  | ~~$defaultOptions = self::applyDefaultOptions($defaultOptions);~~ |
  | 518 |  |  |
  | 519 |  | update\_option('moo\_settings', $defaultOptions ); |
  |  | 515 | update\_option("moo\_old\_checkout\_enabled",'no'); |
  |  | 516 |  |
  |  | 517 | //Apply default options |
  |  | 518 | Moo\_OnlineOrders\_Helpers::applyDefaultOptions($currentOptions); |
  |  | 519 |  |
  | 520 | 520 | } |
  | 521 |  | public static function applyDefaultOptions($MooOptions) { |
  |  | 521 | public static function applyDefaultOptionsOld($MooOptions) { |
  | 522 | 522 | $default\_options = array( |
  | 523 | 523 | array("name"=>"api\_key","value"=>""), |
  | […](/browser/clover-online-orders/trunk/includes/moo-OnlineOrders-activator.php?rev=3142846#L537) | […](/browser/clover-online-orders/trunk/includes/moo-OnlineOrders-activator.php?rev=3168433#L537) |  |
  | 537 | 537 | array("name"=>"custom\_sa\_title","value"=>""), |
  | 538 | 538 | array("name"=>"custom\_sa\_onCheckoutPage","value"=>"off"), |
  | 539 |  | array("name"=>"copyrights","value"=>'Powered by <a href="https://wordpress.org/plugins/clover-online-orders/" target="\_blank" title="Online Orders for Clover POS v 1.5.~~7~~">Smart Online Order</a>'), |
  |  | 539 | array("name"=>"copyrights","value"=>'Powered by <a href="https://wordpress.org/plugins/clover-online-orders/" target="\_blank" title="Online Orders for Clover POS v 1.5.8">Smart Online Order</a>'), |
  | 540 | 540 | array("name"=>"default\_style","value"=>"onePage"), |
  | 541 | 541 | array("name"=>"track\_stock","value"=>""), |
  | […](/browser/clover-online-orders/trunk/includes/moo-OnlineOrders-activator.php?rev=3142846#L545) | […](/browser/clover-online-orders/trunk/includes/moo-OnlineOrders-activator.php?rev=3168433#L545) |  |
  | 545 | 545 | array("name"=>"payment\_creditcard","value"=>"off"), |
  | 546 | 546 | array("name"=>"clover\_payment\_form","value"=>"on"), |
  | 547 |  | array("name"=>"payment\_cash","value"=>"on"), |
  | 548 |  | array("name"=>"payment\_cash\_delivery","value"=>"on"), |
  |  | 547 | array("name"=>"clover\_googlepay","value"=>"on"), |
  |  | 548 | array("name"=>"clover\_applepay","value"=>"on"), |
  |  | 549 | array("name"=>"clover\_giftcards","value"=>"off"), |
  |  | 550 | array("name"=>"payment\_cash","value"=>"off"), |
  |  | 551 | array("name"=>"payment\_cash\_delivery","value"=>"off"), |
  | 549 | 552 | array("name"=>"scp","value"=>"off"), |
  | 550 | 553 | array("name"=>"merchant\_phone","value"=>""), |
* ## [clover-online-orders/trunk/includes/moo-OnlineOrders-helpers.php](/changeset/3168433/clover-online-orders/trunk/includes/moo-OnlineOrders-helpers.php "Show the changeset 3168433 restricted to clover-online-orders/trunk/includes/moo-OnlineOrders-helpers.php")

  | [r3142846](/browser/clover-online-orders/trunk/includes/moo-OnlineOrders-helpers.php?rev=3142846#L20 "Show revision 3142846 of this file in browser") | [r3168433](/browser/clover-online-orders/trunk/includes/moo-OnlineOrders-helpers.php?rev=3168433#L20 "Show revision 3168433 of this file in browser") |  |
  | --- | --- | --- |
  | 20 | 20 | return $wpdb->charset; |
  | 21 | 21 | } |
  |  | 22 | public static function getEngineOfDbTable($table\_name) { |
  |  | 23 | global $wpdb; |
  |  | 24 | $result = $wpdb->get\_row("SHOW CREATE TABLE `{$wpdb->prefix}$table\_name`",'ARRAY\_A'); |
  |  | 25 | if (isset($result["Create Table"])){ |
  |  | 26 | preg\_match('/ENGINE=([^\s]+)/', $result['Create Table'], $matches); |
  |  | 27 | if (isset($matches[0])){ |
  |  | 28 | $matches = explode('=',$matches[0]); |
  |  | 29 | if (isset($matches[1])){ |
  |  | 30 | return $matches[1]; |
  |  | 31 | } |
  |  | 32 | } |
  |  | 33 | } |
  |  | 34 | return $wpdb->engine; |
  |  | 35 | } |
  | 22 | 36 | public static function getCharsetOfDbColumn($table\_name,$column\_name) { |
  | 23 | 37 | global $wpdb; |
  | […](/browser/clover-online-orders/trunk/includes/moo-OnlineOrders-helpers.php?rev=3142846#L32) | […](/browser/clover-online-orders/trunk/includes/moo-OnlineOrders-helpers.php?rev=3168433#L46) |  |
  | 32 | 46 | return $wpdb->collate; |
  | 33 | 47 | } |
  |  | 48 |  |
  |  | 49 | public static function upgradeDatabaseToVersion136($hideErrors = true) |
  |  | 50 | { |
  |  | 51 | global $wpdb; |
  |  | 52 | if($hideErrors){ |
  |  | 53 | $wpdb->hide\_errors(); |
  |  | 54 | } |
  |  | 55 | //Adding new fields in category table |
  |  | 56 | @$wpdb->query("ALTER TABLE `{$wpdb->prefix}moo\_category` ADD `image\_url` VARCHAR(255) NULL"); |
  |  | 57 | @$wpdb->query("ALTER TABLE `{$wpdb->prefix}moo\_category` ADD `alternate\_name` VARCHAR(100) NULL"); |
  |  | 58 | @$wpdb->query("ALTER TABLE `{$wpdb->prefix}moo\_modifier` ADD `sort\_order` INT NULL"); |
  |  | 59 | @$wpdb->query("ALTER TABLE `{$wpdb->prefix}moo\_modifier` ADD `show\_by\_default` INT NOT NULL DEFAULT '1'"); |
  |  | 60 | @$wpdb->query("ALTER TABLE `{$wpdb->prefix}moo\_modifier\_group` ADD `sort\_order` INT NULL"); |
  |  | 61 | @$wpdb->query("ALTER TABLE `{$wpdb->prefix}moo\_order\_types` ADD `type` INT(1) NULL"); |
  |  | 62 | @$wpdb->query("ALTER TABLE `{$wpdb->prefix}moo\_item` ADD `sort\_order` INT NULL"); |
  |  | 63 | @$wpdb->query("ALTER TABLE `{$wpdb->prefix}moo\_order\_types` ADD `sort\_order` INT NULL"); |
  |  | 64 | @$wpdb->query("CREATE TABLE IF NOT EXISTS `{$wpdb->prefix}moo\_item\_order` ( |
  |  | 65 | `\_id` INT NOT NULL AUTO\_INCREMENT, |
  |  | 66 | `item\_uuid` VARCHAR(100) NOT NULL, |
  |  | 67 | `order\_uuid` VARCHAR(100) NOT NULL, |
  |  | 68 | `quantity` VARCHAR(100) NOT NULL, |
  |  | 69 | `modifiers` TEXT NOT NULL, |
  |  | 70 | `special\_ins` VARCHAR(255) NOT NULL, |
  |  | 71 | PRIMARY KEY (`\_id`, `item\_uuid`, `order\_uuid`) |
  |  | 72 | );"); |
  |  | 73 | //add description to items |
  |  | 74 | @$wpdb->query("ALTER TABLE `{$wpdb->prefix}moo\_item` CHANGE `description` `description` TEXT "); |
  |  | 75 | @$wpdb->query("ALTER TABLE `{$wpdb->prefix}moo\_order\_types` ADD `minAmount` VARCHAR(100) NULL DEFAULT '0' "); |
  |  | 76 |  |
  |  | 77 | } |
  |  | 78 | public static function upgradeDatabaseToVersion150($hideErrors = true) |
  |  | 79 | { |
  |  | 80 | global $wpdb; |
  |  | 81 | if($hideErrors){ |
  |  | 82 | $wpdb->hide\_errors(); |
  |  | 83 | } |
  |  | 84 | @$wpdb->query("ALTER TABLE `{$wpdb->prefix}moo\_category` ADD `description` TEXT NULL"); |
  |  | 85 | @$wpdb->query("ALTER TABLE `{$wpdb->prefix}moo\_category` ADD `custom\_hours` VARCHAR(100) NULL"); |
  |  | 86 | @$wpdb->query("ALTER TABLE `{$wpdb->prefix}moo\_category` ADD `time\_availability` VARCHAR(10) NULL"); |
  |  | 87 | @$wpdb->query("ALTER TABLE `{$wpdb->prefix}moo\_item` CHANGE `description` `description` TEXT "); |
  |  | 88 | @$wpdb->query("ALTER TABLE `{$wpdb->prefix}moo\_order\_types` ADD `minAmount` VARCHAR(100) NULL DEFAULT '0' "); |
  |  | 89 | @$wpdb->query("ALTER TABLE `{$wpdb->prefix}moo\_order\_types` ADD `custom\_hours` VARCHAR(100) NULL"); |
  |  | 90 | @$wpdb->query("ALTER TABLE `{$wpdb->prefix}moo\_order\_types` ADD `time\_availability` VARCHAR(10) DEFAULT 1"); |
  |  | 91 | @$wpdb->query("ALTER TABLE `{$wpdb->prefix}moo\_order\_types` ADD `use\_coupons` INT(1) NULL DEFAULT 1"); |
  |  | 92 | @$wpdb->query("ALTER TABLE `{$wpdb->prefix}moo\_order\_types` ADD `custom\_message` VARCHAR(255) NULL DEFAULT 'Not available yet'"); |
  |  | 93 | @$wpdb->query("ALTER TABLE `{$wpdb->prefix}moo\_order\_types` ADD `allow\_service\_fee` INT(1) NULL DEFAULT 1"); |
  |  | 94 | @$wpdb->query("ALTER TABLE `{$wpdb->prefix}moo\_order\_types` ADD `allow\_sc\_order` INT(1) NULL DEFAULT 1 "); |
  |  | 95 | @$wpdb->query("ALTER TABLE `{$wpdb->prefix}moo\_order\_types` ADD `maxAmount` VARCHAR(100) NULL DEFAULT '' "); |
  |  | 96 | @$wpdb->query("ALTER TABLE `{$wpdb->prefix}moo\_item` ADD `category\_uuid` VARCHAR(45) NULL"); |
  |  | 97 | @$wpdb->query("ALTER TABLE `{$wpdb->prefix}moo\_item` ADD `custom\_hours` VARCHAR(45) NULL"); |
  |  | 98 | @$wpdb->query("ALTER TABLE `{$wpdb->prefix}moo\_item` ADD `soo\_name` VARCHAR(255) NULL"); |
  |  | 99 | @$wpdb->query("ALTER TABLE `{$wpdb->prefix}moo\_item` ADD `available` INT(1) NULL DEFAULT 1"); |
  |  | 100 | } |
  |  | 101 | public static function upgradeDatabaseToVersion158($hideErrors = true) |
  |  | 102 | { |
  |  | 103 | global $wpdb; |
  |  | 104 | if($hideErrors){ |
  |  | 105 | $wpdb->hide\_errors(); |
  |  | 106 | } |
  |  | 107 | // Get current charset |
  |  | 108 | $itemTableCharset = self::getCharsetOfDbTable("moo\_item"); |
  |  | 109 | $itemTableEngine = self::getEngineOfDbTable("moo\_item"); |
  |  | 110 | $itemUuidColumnCollate = self::getCharsetOfDbColumn("moo\_item","uuid"); |
  |  | 111 |  |
  |  | 112 |  |
  |  | 113 | @$wpdb->query("ALTER TABLE `{$wpdb->prefix}moo\_item` ADD `featured` INT(1) NULL DEFAULT 0"); |
  |  | 114 | @$wpdb->query("ALTER TABLE `{$wpdb->prefix}moo\_modifier` ADD `is\_pre\_selected` INT(1) NULL DEFAULT 0"); |
  |  | 115 | // Add new fields to tax rate |
  |  | 116 | @$wpdb->query("ALTER TABLE `{$wpdb->prefix}moo\_tax\_rate` ADD `taxAmount` INT NULL"); |
  |  | 117 | @$wpdb->query("ALTER TABLE `{$wpdb->prefix}moo\_tax\_rate` ADD `taxType` VARCHAR(100) NULL"); |
  |  | 118 |  |
  |  | 119 | //Add a flag to the category table |
  |  | 120 | @$wpdb->query("ALTER TABLE `{$wpdb->prefix}moo\_category` ADD `items\_imported` INT(1) NOT NULL DEFAULT 0"); |
  |  | 121 |  |
  |  | 122 |  |
  |  | 123 | //Create a new table for items\_categories (many to many) |
  |  | 124 | $res = @$wpdb->query("CREATE TABLE IF NOT EXISTS `{$wpdb->prefix}moo\_items\_categories` ( |
  |  | 125 | `item\_uuid` VARCHAR(45) NOT NULL, |
  |  | 126 | `category\_uuid` VARCHAR(100) NOT NULL, |
  |  | 127 | `sort\_order` INT NULL, |
  |  | 128 | PRIMARY KEY (`item\_uuid`, `category\_uuid`), |
  |  | 129 | INDEX `idx\_item\_has\_categories` (`item\_uuid` ASC) , |
  |  | 130 | INDEX `idx\_category\_has\_items` (`category\_uuid` ASC)  , |
  |  | 131 | CONSTRAINT `{$wpdb->prefix}fk\_item\_has\_categories` |
  |  | 132 | FOREIGN KEY (`item\_uuid`) |
  |  | 133 | REFERENCES `{$wpdb->prefix}moo\_item` (`uuid`) |
  |  | 134 | ON DELETE CASCADE |
  |  | 135 | ON UPDATE CASCADE, |
  |  | 136 | CONSTRAINT `{$wpdb->prefix}fk\_category\_has\_items` |
  |  | 137 | FOREIGN KEY (`category\_uuid`) |
  |  | 138 | REFERENCES `{$wpdb->prefix}moo\_category` (`uuid`) |
  |  | 139 | ON DELETE CASCADE |
  |  | 140 | ON UPDATE CASCADE, |
  |  | 141 | UNIQUE(`item\_uuid`,`category\_uuid`)) ENGINE=$itemTableEngine DEFAULT CHARACTER SET $itemTableCharset COLLATE $itemUuidColumnCollate" |
  |  | 142 | ); |
  |  | 143 | //Remove CONSTRAINT if table not created |
  |  | 144 | if (!$res) { |
  |  | 145 | @$wpdb->query("CREATE TABLE IF NOT EXISTS `{$wpdb->prefix}moo\_items\_categories` ( |
  |  | 146 | `item\_uuid` VARCHAR(45) NOT NULL, |
  |  | 147 | `category\_uuid` VARCHAR(100) NOT NULL, |
  |  | 148 | `sort\_order` INT NULL, |
  |  | 149 | PRIMARY KEY (`item\_uuid`, `category\_uuid`), |
  |  | 150 | INDEX `idx\_item\_has\_categories` (`item\_uuid` ASC) , |
  |  | 151 | INDEX `idx\_category\_has\_items` (`category\_uuid` ASC)  , |
  |  | 152 | UNIQUE(`item\_uuid`,`category\_uuid`) |
  |  | 153 | ) ENGINE=$itemTableEngine DEFAULT CHARACTER SET $itemTableCharset COLLATE $itemUuidColumnCollate" |
  |  | 154 | ); |
  |  | 155 | } |
  |  | 156 | } |
  |  | 157 | public static function getDefaultOptions() { |
  |  | 158 | return array( |
  |  | 159 | array("name"=>"api\_key","value"=>""), |
  |  | 160 | array("name"=>"store\_page","value"=>""), |
  |  | 161 | array("name"=>"checkout\_page","value"=>""), |
  |  | 162 | array("name"=>"cart\_page","value"=>""), |
  |  | 163 | array("name"=>"lat","value"=>""), |
  |  | 164 | array("name"=>"lng","value"=>""), |
  |  | 165 | array("name"=>"hours","value"=>"all"), |
  |  | 166 | array("name"=>"closing\_msg","value"=>""), |
  |  | 167 | array("name"=>"merchant\_email","value"=>""), |
  |  | 168 | array("name"=>"thanks\_page","value"=>""), |
  |  | 169 | array("name"=>"my\_account\_page","value"=>""), |
  |  | 170 | array("name"=>"fb\_appid","value"=>""), |
  |  | 171 | array("name"=>"use\_coupons","value"=>"disabled"), |
  |  | 172 | array("name"=>"use\_sms\_verification","value"=>"enabled"), |
  |  | 173 | array("name"=>"custom\_css","value"=>""), |
  |  | 174 | array("name"=>"custom\_js","value"=>""), |
  |  | 175 | array("name"=>"custom\_sa\_content","value"=>""), |
  |  | 176 | array("name"=>"custom\_sa\_title","value"=>""), |
  |  | 177 | array("name"=>"custom\_sa\_onCheckoutPage","value"=>"off"), |
  |  | 178 | array("name"=>"copyrights","value"=>'Powered by <a href="https://wordpress.org/plugins/clover-online-orders/" target="\_blank" title="Online Orders for Clover POS v 1.5.8">Smart Online Order</a>'), |
  |  | 179 | array("name"=>"default\_style","value"=>"onePage"), |
  |  | 180 | array("name"=>"track\_stock","value"=>""), |
  |  | 181 | array("name"=>"track\_stock\_hide\_items","value"=>"off"), |
  |  | 182 | array("name"=>"checkout\_login","value"=>"enabled"), |
  |  | 183 | array("name"=>"tips","value"=>"enabled"), |
  |  | 184 | array("name"=>"payment\_creditcard","value"=>"off"), |
  |  | 185 | array("name"=>"clover\_payment\_form","value"=>"on"), |
  |  | 186 | array("name"=>"clover\_googlepay","value"=>"on"), |
  |  | 187 | array("name"=>"clover\_applepay","value"=>"on"), |
  |  | 188 | array("name"=>"clover\_giftcards","value"=>"off"), |
  |  | 189 | array("name"=>"payment\_cash","value"=>"off"), |
  |  | 190 | array("name"=>"payment\_cash\_delivery","value"=>"off"), |
  |  | 191 | array("name"=>"scp","value"=>"off"), |
  |  | 192 | array("name"=>"merchant\_phone","value"=>""), |
  |  | 193 | array("name"=>"order\_later","value"=>"on"), |
  |  | 194 | array("name"=>"order\_later\_mandatory","value"=>"off"), |
  |  | 195 | array("name"=>"order\_later\_days","value"=>"4"), |
  |  | 196 | array("name"=>"order\_later\_minutes","value"=>"20"), |
  |  | 197 | array("name"=>"order\_later\_days\_delivery","value"=>"4"), |
  |  | 198 | array("name"=>"order\_later\_minutes\_delivery","value"=>"60"), |
  |  | 199 | array("name"=>"order\_later\_asap\_for\_p","value"=>"off"), |
  |  | 200 | array("name"=>"order\_later\_asap\_for\_d","value"=>"off"), |
  |  | 201 | array("name"=>"free\_delivery","value"=>""), |
  |  | 202 | array("name"=>"fixed\_delivery","value"=>""), |
  |  | 203 | array("name"=>"other\_zones\_delivery","value"=>""), |
  |  | 204 | array("name"=>"delivery\_fees\_name","value"=>"Delivery Charge"), |
  |  | 205 | array("name"=>"delivery\_errorMsg","value"=>"Sorry, zone not supported. We do not deliver to this address at this time"), |
  |  | 206 | array("name"=>"zones\_json","value"=>""), |
  |  | 207 | array("name"=>"hide\_menu","value"=>""), |
  |  | 208 | array("name"=>"hide\_menu\_w\_closed","value"=>"off"), |
  |  | 209 | array("name"=>"accept\_orders\_w\_closed","value"=>"on"), |
  |  | 210 | array("name"=>"show\_categories\_images","value"=>false), |
  |  | 211 | array("name"=>"save\_cards","value"=>"disabled"), |
  |  | 212 | array("name"=>"save\_cards\_fees","value"=>"disabled"), |
  |  | 213 | array("name"=>"service\_fees","value"=>"0.99"), |
  |  | 214 | array("name"=>"service\_fees\_name","value"=>"Service Charge"), |
  |  | 215 | array("name"=>"service\_fees\_type","value"=>"amount"), |
  |  | 216 | array("name"=>"use\_special\_instructions","value"=>"enabled"), |
  |  | 217 | array("name"=>"onePage\_fontFamily","value"=>"Oswald,sans-serif"), |
  |  | 218 | array("name"=>"onePage\_categoriesTopMargin","value"=>"0"), |
  |  | 219 | array("name"=>"onePage\_width","value"=>"1024"), |
  |  | 220 | array("name"=>"onePage\_categoriesFontColor","value"=>"#ffffff"), |
  |  | 221 | array("name"=>"onePage\_categoriesBackgroundColor","value"=>"#282b2e"), |
  |  | 222 | array("name"=>"onePage\_qtyWindow","value"=>"on"), |
  |  | 223 | array("name"=>"onePage\_qtyWindowForModifiers","value"=>"on"), |
  |  | 224 | array("name"=>"onePage\_backToTop","value"=>"off"), |
  |  | 225 | array("name"=>"onePage\_show\_more\_button","value"=>"on"), |
  |  | 226 | array("name"=>"jTheme\_width","value"=>"1024"), |
  |  | 227 | array("name"=>"jTheme\_qtyWindow","value"=>"on"), |
  |  | 228 | array("name"=>"jTheme\_qtyWindowForModifiers","value"=>"on"), |
  |  | 229 | array("name"=>"style1\_width","value"=>"1024"), |
  |  | 230 | array("name"=>"style2\_width","value"=>"1024"), |
  |  | 231 | array("name"=>"style3\_width","value"=>"1024"), |
  |  | 232 | array("name"=>"mg\_settings\_displayInline","value"=>"disabled"), |
  |  | 233 | array("name"=>"mg\_settings\_qty\_for\_all","value"=>"enabled"), |
  |  | 234 | array("name"=>"mg\_settings\_qty\_for\_zeroPrice","value"=>"disabled"), |
  |  | 235 | array("name"=>"text\_under\_special\_instructions","value"=>"\*additional charges may apply and not all changes are possible"), |
  |  | 236 | array("name"=>"special\_instructions\_required","value"=>"no"), |
  |  | 237 | array("name"=>"use\_couponsApp","value"=>"off"), |
  |  | 238 | array("name"=>"accept\_orders","value"=>"enabled"), |
  |  | 239 | array("name"=>"onePage\_askforspecialinstruction","value"=>"off"), |
  |  | 240 | array("name"=>"onePage\_messageforspecialinstruction","value"=>"Type your instructions here, additional charges may apply and not all changes are possible"), |
  |  | 241 | array("name"=>"jTheme\_askforspecialinstruction","value"=>"off"), |
  |  | 242 | array("name"=>"jTheme\_messageforspecialinstruction","value"=>"Type your instructions here, additional charges may apply and not all changes are possible"), |
  |  | 243 | array("name"=>"style2\_askforspecialinstruction","value"=>"off"), |
  |  | 244 | array("name"=>"style2\_messageforspecialinstruction","value"=>"Type your instructions here, additional charges may apply and not all changes are possible"), |
  |  | 245 | array("name"=>"useAlternateNames","value"=>"enabled"), |
  |  | 246 | array("name"=>"hide\_category\_ifnotavailable","value"=>"off"), |
  |  | 247 | array("name"=>"show\_order\_number","value"=>"off"), |
  |  | 248 | array("name"=>"mg\_settings\_minimized","value"=>"off"), |
  |  | 249 | array("name"=>"tips\_selection","value"=>"10,15,20,25"), |
  |  | 250 | array("name"=>"tips\_default","value"=>""), |
  |  | 251 | array("name"=>"rollout\_order\_number","value"=>"on"), |
  |  | 252 | array("name"=>"rollout\_order\_number\_max","value"=>"999"), |
  |  | 253 | array("name"=>"thanks\_page\_wp","value"=>""), |
  |  | 254 | array("name"=>"cdn\_for\_images","value"=>"off"), |
  |  | 255 | array("name"=>"cdn\_url","value"=>""), |
  |  | 256 | ); |
  |  | 257 | } |
  |  | 258 |  |
  |  | 259 | public static function applyDefaultOptions($currentOptions) { |
  |  | 260 | $defaultOptions = self::getDefaultOptions(); |
  |  | 261 | foreach ($defaultOptions as $default\_option) { |
  |  | 262 | if(!isset($currentOptions[$default\_option["name"]])) { |
  |  | 263 | $currentOptions[$default\_option["name"]]=$default\_option["value"]; |
  |  | 264 | } |
  |  | 265 | } |
  |  | 266 | update\_option('moo\_settings', $currentOptions ); |
  |  | 267 | } |
  | 34 | 268 | } |
* ## [clover-online-orders/trunk/includes/moo-OnlineOrders-sooapi.php](/changeset/3168433/clover-online-orders/trunk/includes/moo-OnlineOrders-sooapi.php "Show the changeset 3168433 restricted to clover-online-orders/trunk/includes/moo-OnlineOrders-sooapi.php")

  | [r3142846](/browser/clover-online-orders/trunk/includes/moo-OnlineOrders-sooapi.php?rev=3142846#L249 "Show revision 3142846 of this file in browser") | [r3168433](/browser/clover-online-orders/trunk/includes/moo-OnlineOrders-sooapi.php?rev=3168433#L249 "Show revision 3168433 of this file in browser") |  |
  | --- | --- | --- |
  | 249 | 249 | } |
  | 250 | 250 | //Functions to call the API for make Orders and payments |
  | 251 |  | ~~public function getPayKey() {~~ |
  | 252 |  | ~~return $this->callApi("paykey", $this->apiKey);~~ |
  | 253 |  | ~~}~~ |
  | 254 | 251 | public function getPakmsKey(){ |
  | 255 | 252 | //Get it locally when it's not found get it from Clover |
  | […](/browser/clover-online-orders/trunk/includes/moo-OnlineOrders-sooapi.php?rev=3142846#L346) | […](/browser/clover-online-orders/trunk/includes/moo-OnlineOrders-sooapi.php?rev=3168433#L343) |  |
  | 346 | 343 | $startTime = ($time["start"] != 0) ? substr\_replace(((strlen($time["start"]) == 4) ? $time["start"] : ((strlen($time["start"]) == 2) ? '00' . $time["start"] : '0' . $time["start"])), ':', 2, 0) : '00:00'; |
  | 347 | 344 | $endTime = ($time["end"] != 2400) ? substr\_replace(((strlen($time["end"]) == 4) ? $time["end"] : ((strlen($time["end"]) == 2) ? '00' . $time["end"] : '0' . $time["end"])), ':', 2, 0) : '24:00'; |
  | 348 |  | $string .= ~~date('h:i a', strtotime($startTime)) . ' to ' .~~ date('h:i a', strtotime($endTime)) . ' AND '; |
  | 349 |  | $result[ucfirst($days\_name)][] = ~~date('h:i a', strtotime($startTime)) . ' to ' .~~ date('h:i a', strtotime($endTime)); |
  |  | 345 | $string .= gmdate('h:i a', strtotime($startTime)) . ' to ' . gmdate('h:i a', strtotime($endTime)) . ' AND '; |
  |  | 346 | $result[ucfirst($days\_name)][] = gmdate('h:i a', strtotime($startTime)) . ' to ' . gmdate('h:i a', strtotime($endTime)); |
  | 350 | 347 | //$result[ucfirst($days\_name)] = substr($string, 0, -5); |
  | 351 | 348 | } |
  | […](/browser/clover-online-orders/trunk/includes/moo-OnlineOrders-sooapi.php?rev=3142846#L1510) | […](/browser/clover-online-orders/trunk/includes/moo-OnlineOrders-sooapi.php?rev=3168433#L1507) |  |
  | 1510 | 1507 |  |
  | 1511 | 1508 | if ($orderFromServer->order->date != "") { |
  | 1512 |  | $result['date\_order'] = date('m/d/Y', $orderFromServer->order->date / 1000); |
  |  | 1509 | $result['date\_order'] = gmdate('m/d/Y', $orderFromServer->order->date / 1000); |
  | 1513 | 1510 | } |
  | 1514 | 1511 | if ($orderFromServer->order->taxRemoved == "1") { |
  | […](/browser/clover-online-orders/trunk/includes/moo-OnlineOrders-sooapi.php?rev=3142846#L1946) | […](/browser/clover-online-orders/trunk/includes/moo-OnlineOrders-sooapi.php?rev=3168433#L1943) |  |
  | 1946 | 1943 |  |
  | 1947 | 1944 | private function callApi($url, $accesstoken) { |
  | 1948 |  |  |
  | 1949 |  | $headr = array(); |
  | 1950 |  | $headr[] = 'Accept: application/json'; |
  | 1951 |  | $headr[] = 'X-Authorization: ' . $accesstoken; |
  | 1952 |  | $url = $this->url\_api . $url; |
  | 1953 |  | //cURL starts |
  | 1954 |  | $crl = curl\_init(); |
  | 1955 |  | curl\_setopt($crl, CURLOPT\_URL, $url); |
  | 1956 |  | curl\_setopt($crl, CURLOPT\_HTTPHEADER, $headr); |
  | 1957 |  | curl\_setopt($crl, CURLOPT\_RETURNTRANSFER, true); |
  | 1958 |  | curl\_setopt($crl, CURLOPT\_HTTPGET, true); |
  | 1959 |  | curl\_setopt($crl, CURLOPT\_FOLLOWLOCATION, true); |
  | 1960 |  | curl\_setopt($crl, CURLOPT\_SSL\_VERIFYPEER, (get\_option('soo\_ssl\_verify','true') === 'true')); |
  | 1961 |  | //curl\_setopt($crl, CURLOPT\_TIMEOUT, 1); |
  | 1962 |  | $reply = curl\_exec($crl); |
  | 1963 |  | //error handling for cURL |
  | 1964 |  | if ($reply === false) { |
  | 1965 |  | if(curl\_error($crl) === 'SSL certificate problem: certificate has expired'){ |
  | 1966 |  | //Expired WordPress certificate |
  | 1967 |  | update\_option('soo\_ssl\_verify','false'); |
  | 1968 |  | } |
  | 1969 |  | if ($this->debugMode){ |
  | 1970 |  | print\_r('Curl error: ' . curl\_error($crl) . ' URL : '. $url); |
  | 1971 |  | } |
  | 1972 |  | return false; |
  | 1973 |  | } |
  | 1974 |  | $info = curl\_getinfo($crl); |
  | 1975 |  | curl\_close($crl); |
  | 1976 |  | if ($this->debugMode) { |
  | 1977 |  | echo "GET :: " . $url . " <<"; |
  | 1978 |  | echo ">> "; |
  | 1979 |  | } |
  | 1980 |  | if ($info['http\_code'] == 200) return $reply; |
  |  | 1945 | $args = array( |
  |  | 1946 | "headers"=> array( |
  |  | 1947 | 'X\_CLIENT\_IP' => $this->getClientIp(), |
  |  | 1948 | 'Accept' => "application/json", |
  |  | 1949 | 'X-Authorization' => $accesstoken |
  |  | 1950 | ), |
  |  | 1951 | ); |
  |  | 1952 | $endpoint = $this->url\_api . $url; |
  |  | 1953 | $response = $this->sendHttpRequest($endpoint,"GET",$args); |
  |  | 1954 | if($response && is\_array($response)) { |
  |  | 1955 | if($response["httpCode"] === 200 || $response["httpCode"] === 404 ){ |
  |  | 1956 | return $response["responseContent"]; |
  |  | 1957 | } |
  |  | 1958 | } |
  | 1981 | 1959 | return false; |
  | 1982 | 1960 | } |
* ## [clover-online-orders/trunk/includes/moo-OnlineOrders-widgets.php](/changeset/3168433/clover-online-orders/trunk/includes/moo-OnlineOrders-widgets.php "Show the changeset 3168433 restricted to clover-online-orders/trunk/includes/moo-OnlineOrders-widgets.php")

  | [r3142846](/browser/clover-online-orders/trunk/includes/moo-OnlineOrders-widgets.php?rev=3142846#L20 "Show revision 3142846 of this file in browser") | [r3168433](/browser/clover-online-orders/trunk/includes/moo-OnlineOrders-widgets.php?rev=3168433#L20 "Show revision 3168433 of this file in browser") |  |
  | --- | --- | --- |
  | 20 | 20 | $title = apply\_filters( 'widget\_title', $instance['title'] ); |
  | 21 | 21 | echo $args['before\_widget']; |
  | 22 |  | if ( ! empty( $title ) ) |
  |  | 22 | if ( ! empty( $title ) ) { |
  | 23 | 23 | echo $args['before\_title'] . $title . $args['after\_title']; |
  |  | 24 | } |
  | 24 | 25 | /\* -------- \*/ |
  | 25 | 26 | require\_once plugin\_dir\_path(dirname(\_\_FILE\_\_)) . "includes/moo-OnlineOrders-sooapi.php"; |
  | […](/browser/clover-online-orders/trunk/includes/moo-OnlineOrders-widgets.php?rev=3142846#L29) | […](/browser/clover-online-orders/trunk/includes/moo-OnlineOrders-widgets.php?rev=3168433#L30) |  |
  | 29 | 30 |  |
  | 30 | 31 | echo '<div style="padding-left:15px">'; |
  | 31 |  | if(@count($current\_hours)>0 && $current\_hours~~!=~~"Please setup you business hours on Clover") |
  |  | 32 | if(@count($current\_hours)>0 && $current\_hours != "Please setup you business hours on Clover") |
  | 32 | 33 | { |
  | 33 | 34 | foreach ($current\_hours as $key=>$value) { |
  | 34 |  | ~~$value = str\_replace('AND',"<br/>",$value);~~ |
  | 35 | 35 | echo '<strong><dt>'.$key.'</dt></strong>'; |
  | 36 |  | echo '<dd>'.$value.'</dd>'; |
  |  | 36 | if (is\_array($value)){ |
  |  | 37 | foreach ($value as $key1 => $value1) { |
  |  | 38 | echo '<dd>'.strtoupper($value1).'</dd>'; |
  |  | 39 | } |
  |  | 40 | } else { |
  |  | 41 | echo '<dd>'.strtoupper($value).'</dd>'; |
  |  | 42 | } |
  |  | 43 |  |
  | 37 | 44 | } |
  | 38 | 45 | } |
  | […](/browser/clover-online-orders/trunk/includes/moo-OnlineOrders-widgets.php?rev=3142846#L54) | […](/browser/clover-online-orders/trunk/includes/moo-OnlineOrders-widgets.php?rev=3168433#L61) |  |
  | 54 | 61 | ?> |
  | 55 | 62 | <p> |
  | 56 |  | <label for="<?php echo $this->get\_field\_id( 'title' ); ?>"><?php \_e( 'Title:' ); ?></label> |
  |  | 63 | <label for="<?php echo $this->get\_field\_id( 'title' ); ?>"><?php \_e( 'Title:',"moo\_OnlineOrders" ); ?></label> |
  | 57 | 64 | <input class="widefat" id="<?php echo $this->get\_field\_id( 'title' ); ?>" name="<?php echo $this->get\_field\_name( 'title' ); ?>" type="text" value="<?php echo esc\_attr( $title ); ?>" /> |
  | 58 | 65 | </p> |
  | […](/browser/clover-online-orders/trunk/includes/moo-OnlineOrders-widgets.php?rev=3142846#L121) | […](/browser/clover-online-orders/trunk/includes/moo-OnlineOrders-widgets.php?rev=3168433#L128) |  |
  | 121 | 128 | ?> |
  | 122 | 129 | <p> |
  | 123 |  | <label for="<?php echo $this->get\_field\_id( 'title' ); ?>"><?php \_e( 'Title:' ); ?></label> |
  |  | 130 | <label for="<?php echo $this->get\_field\_id( 'title' ); ?>"><?php \_e( 'Title:',"moo\_OnlineOrders" ); ?></label> |
  | 124 | 131 | <input class="widefat" id="<?php echo $this->get\_field\_id( 'title' ); ?>" name="<?php echo $this->get\_field\_name( 'title' ); ?>" type="text" value="<?php echo esc\_attr( $title ); ?>" /> |
  | 125 | 132 | </p> |
  | 126 | 133 |  |
  | 127 | 134 | <p> |
  | 128 |  | <label for="<?php echo $this->get\_field\_id( 'nb\_product' ); ?>"><?php \_e( 'Number of products:' ); ?></label> |
  |  | 135 | <label for="<?php echo $this->get\_field\_id( 'nb\_product' ); ?>"><?php \_e( 'Number of products:',"moo\_OnlineOrders" ); ?></label> |
  | 129 | 136 | <input class="widefat" id="<?php echo $this->get\_field\_id( 'nb\_product' ); ?>" name="<?php echo $this->get\_field\_name( 'nb\_product' ); ?>" type="number" value="<?php echo esc\_attr( $nb\_product ); ?>" /> |
  | 130 | 137 | </p> |
  | […](/browser/clover-online-orders/trunk/includes/moo-OnlineOrders-widgets.php?rev=3142846#L185) | […](/browser/clover-online-orders/trunk/includes/moo-OnlineOrders-widgets.php?rev=3168433#L192) |  |
  | 185 | 192 | ?> |
  | 186 | 193 | <p> |
  | 187 |  | <label for="<?php echo $this->get\_field\_id( 'title' ); ?>"><?php \_e( 'Title:' ); ?></label> |
  |  | 194 | <label for="<?php echo $this->get\_field\_id( 'title' ); ?>"><?php \_e( 'Title:',"moo\_OnlineOrders" ); ?></label> |
  | 188 | 195 | <input class="widefat" id="<?php echo $this->get\_field\_id( 'title' ); ?>" name="<?php echo $this->get\_field\_name( 'title' ); ?>" type="text" value="<?php echo esc\_attr( $title ); ?>" /> |
  | 189 | 196 | </p> |
* ## [clover-online-orders/trunk/includes/restapi/CheckoutRoutes.php](/changeset/3168433/clover-online-orders/trunk/includes/restapi/CheckoutRoutes.php "Show the changeset 3168433 restricted to clover-online-orders/trunk/includes/restapi/CheckoutRoutes.php")

  | [r3142846](/browser/clover-online-orders/trunk/includes/restapi/CheckoutRoutes.php?rev=3142846#L454 "Show revision 3142846 of this file in browser") | [r3168433](/browser/clover-online-orders/trunk/includes/restapi/CheckoutRoutes.php?rev=3168433#L454 "Show revision 3168433 of this file in browser") |  |
  | --- | --- | --- |
  | 454 | 454 | $googleReCAPTCHADisabled =  (bool) get\_option('sooDisableGoogleReCAPTCHA',false); |
  | 455 | 455 |  |
  | 456 |  | if (get\_option('moo\_~~new\_checkout\_enabled') !~~== 'yes'){ |
  |  | 456 | if (get\_option('moo\_old\_checkout\_enabled') === 'yes'){ |
  | 457 | 457 | $googleReCAPTCHADisabled = true; |
  | 458 | 458 | } |
  | 459 | 459 |  |
  | 460 | 460 | //Check Google recaptcha |
  | 461 |  | if (!$googleReCAPTCHADisabled && !empty($this->pluginSettings['reCAPTCHA\_site\_key']) && !empty($this->pluginSettings['reCAPTCHA\_secret\_key'])){ |
  |  | 461 | if (!$googleReCAPTCHADisabled && !empty($this->pluginSettings['reCAPTCHA\_site\_key']) && !empty($this->pluginSettings['reCAPTCHA\_secret\_key'])) { |
  | 462 | 462 | $reCaptchaErrorMessage = "Oops! It seems there was an issue with the reCAPTCHA. Don't worry, these things happen. Please try submitting the form again. We apologize for any inconvenience caused."; |
  | 463 | 463 | $args = array( |
  | […](/browser/clover-online-orders/trunk/includes/restapi/CheckoutRoutes.php?rev=3142846#L783) | […](/browser/clover-online-orders/trunk/includes/restapi/CheckoutRoutes.php?rev=3168433#L783) |  |
  | 783 | 783 | } |
  | 784 | 784 |  |
  | 785 |  |  |
  | 786 | 785 | //show Order number |
  | 787 | 786 | if(isset($this->pluginSettings["show\_order\_number"]) && $this->pluginSettings["show\_order\_number"] === "on") { |
* ## [clover-online-orders/trunk/includes/restapi/DashboardRoutes.php](/changeset/3168433/clover-online-orders/trunk/includes/restapi/DashboardRoutes.php "Show the changeset 3168433 restricted to clover-online-orders/trunk/includes/restapi/DashboardRoutes.php")

  | [r3142846](/browser/clover-online-orders/trunk/includes/restapi/DashboardRoutes.php?rev=3142846#L110 "Show revision 3142846 of this file in browser") | [r3168433](/browser/clover-online-orders/trunk/includes/restapi/DashboardRoutes.php?rev=3168433#L110 "Show revision 3168433 of this file in browser") |  |
  | --- | --- | --- |
  | 110 | 110 | )); |
  | 111 | 111 | // Enable the new Checkout |
  | 112 |  | register\_rest\_route($this->namespace, '/dash/enable-~~new~~-checkout', array( |
  |  | 112 | register\_rest\_route($this->namespace, '/dash/enable-old-checkout', array( |
  | 113 | 113 | // Here we register the readable endpoint for collections. |
  | 114 | 114 | array( |
  | 115 | 115 | 'methods' => 'POST', |
  | 116 |  | 'callback' => array($this, 'enable~~New~~Checkout'), |
  |  | 116 | 'callback' => array($this, 'enableOldCheckout'), |
  | 117 | 117 | 'permission\_callback' => array( $this, 'permissionCheck' ) |
  | 118 | 118 | ) |
  | […](/browser/clover-online-orders/trunk/includes/restapi/DashboardRoutes.php?rev=3142846#L532) | […](/browser/clover-online-orders/trunk/includes/restapi/DashboardRoutes.php?rev=3168433#L532) |  |
  | 532 | 532 | $wpdb->query("DELETE FROM `{$wpdb->prefix}moo\_item\_tax\_rate` ;"); |
  | 533 | 533 | // -- Table `modifier\_group` -- |
  | 534 |  | $wpdb->query("DELETE FROM `{$wpdb->prefix}moo\_item\_order` ;"); |
  |  | 534 | @$wpdb->query("DELETE FROM `{$wpdb->prefix}moo\_item\_order` ;"); |
  | 535 | 535 | //\*-- Table `item\_tag` -- |
  | 536 | 536 | $wpdb->query("DELETE FROM `{$wpdb->prefix}moo\_item\_tag` ;"); |
  | […](/browser/clover-online-orders/trunk/includes/restapi/DashboardRoutes.php?rev=3142846#L589) | […](/browser/clover-online-orders/trunk/includes/restapi/DashboardRoutes.php?rev=3168433#L589) |  |
  | 589 | 589 | } |
  | 590 | 590 | } |
  | 591 |  | function enable~~New~~Checkout( $request ) { |
  |  | 591 | function enableOldCheckout( $request ) { |
  | 592 | 592 |  |
  | 593 | 593 | if (empty( $request["status"] )) { |
  | […](/browser/clover-online-orders/trunk/includes/restapi/DashboardRoutes.php?rev=3142846#L596) | […](/browser/clover-online-orders/trunk/includes/restapi/DashboardRoutes.php?rev=3168433#L596) |  |
  | 596 | 596 | $status = rest\_sanitize\_boolean($request["status"]); |
  | 597 | 597 | if($status){ |
  | 598 |  | update\_option("moo\_~~new~~\_checkout\_enabled",'yes'); |
  | 599 |  | } else { |
  | 600 |  | update\_option("moo\_~~new~~\_checkout\_enabled",'no'); |
  |  | 598 | update\_option("moo\_old\_checkout\_enabled",'yes'); |
  |  | 599 | } else { |
  |  | 600 | update\_option("moo\_old\_checkout\_enabled",'no'); |
  | 601 | 601 | } |
  | 602 | 602 | //Save on Cloud |
  | 603 | 603 | try { |
  | 604 |  | $this->api->saveMerchantSettings("~~new~~\_checkout", $status); |
  |  | 604 | $this->api->saveMerchantSettings("old\_checkout", $status); |
  | 605 | 605 | } catch (Exception $e){ |
  | 606 | 606 | // Silence is golden |
  | […](/browser/clover-online-orders/trunk/includes/restapi/DashboardRoutes.php?rev=3142846#L1245) | […](/browser/clover-online-orders/trunk/includes/restapi/DashboardRoutes.php?rev=3168433#L1245) |  |
  | 1245 | 1245 | } |
  | 1246 | 1246 | } |
  | 1247 |  |  |
  | 1248 | 1247 | function dashImportCustomHours( $request ){ |
  | 1249 | 1248 | $files = $request->get\_file\_params(); |
  | […](/browser/clover-online-orders/trunk/includes/restapi/DashboardRoutes.php?rev=3142846#L1290) | […](/browser/clover-online-orders/trunk/includes/restapi/DashboardRoutes.php?rev=3168433#L1289) |  |
  | 1290 | 1289 | $upload\_dir = wp\_upload\_dir(); |
  | 1291 | 1290 | $permittedExtension = 'json'; |
  | 1292 |  | //Get Data from file or J~~son~~ Body |
  |  | 1291 | //Get Data from file or JSON Body |
  | 1293 | 1292 | $files = $request->get\_file\_params(); |
  | 1294 |  | if (~~!isset( $files['file'] ) || empty( $files['file'] )~~ ) { |
  |  | 1293 | if (empty( $files['file'] )) { |
  | 1295 | 1294 | $data = json\_decode($request->get\_body(),true); |
  | 1296 | 1295 | //Get Data from json |
  | 1297 | 1296 | if ( isset( $data["cloneImages"] ) ) { |
  | 1298 |  | $cloneImages = $data["cloneImages"]; |
  |  | 1297 | $cloneImages = $data["cloneImages"] !== 'false'; |
  | 1299 | 1298 | } else { |
  | 1300 | 1299 | $cloneImages = true; |
  | […](/browser/clover-online-orders/trunk/includes/restapi/DashboardRoutes.php?rev=3142846#L1302) | […](/browser/clover-online-orders/trunk/includes/restapi/DashboardRoutes.php?rev=3168433#L1301) |  |
  | 1302 | 1301 |  |
  | 1303 | 1302 | if ( isset( $data["skipWhenImageExist"] ) ) { |
  | 1304 |  | $skipWhenImageExist = $data["skipWhenImageExist"]; |
  |  | 1303 | $skipWhenImageExist = $data["skipWhenImageExist"] !== 'false'; |
  | 1305 | 1304 | } else { |
  | 1306 | 1305 | $skipWhenImageExist = false; |
  | […](/browser/clover-online-orders/trunk/includes/restapi/DashboardRoutes.php?rev=3142846#L1336) | […](/browser/clover-online-orders/trunk/includes/restapi/DashboardRoutes.php?rev=3168433#L1335) |  |
  | 1336 | 1335 | } |
  | 1337 | 1336 |  |
  | 1338 |  | if(isset($data["items"]) && is\_array($data["items"])){ |
  |  | 1337 | if(isset($data["items"]) && is\_array($data["items"])) { |
  | 1339 | 1338 | foreach ($data["items"] as $item) { |
  | 1340 | 1339 | if(isset($item["url"])){ |
  | 1341 |  | //get item uuid based on name and uuid |
  |  | 1340 | //get item uuid based on name and uuid |
  | 1342 | 1341 | $name = esc\_sql($item["name"]); |
  | 1343 | 1342 | $sql = "SELECT \* FROM `{$wpdb->prefix}moo\_item` |
  | […](/browser/clover-online-orders/trunk/includes/restapi/DashboardRoutes.php?rev=3142846#L1356) | […](/browser/clover-online-orders/trunk/includes/restapi/DashboardRoutes.php?rev=3168433#L1355) |  |
  | 1356 | 1355 |  |
  | 1357 | 1356 | if($cloneImages){ |
  | 1358 |  | try{ |
  |  | 1357 | try { |
  | 1359 | 1358 | $link = $this->uploadFileByUrl($item["url"]); |
  | 1360 | 1359 | if($link){ |
  | 1361 | 1360 | $link\_image = $link; |
  | 1362 |  | } else{ |
  |  | 1361 | } else { |
  | 1363 | 1362 | throw new Exception(); |
  | 1364 | 1363 | } |
  | […](/browser/clover-online-orders/trunk/includes/restapi/DashboardRoutes.php?rev=3142846#L1393) | […](/browser/clover-online-orders/trunk/includes/restapi/DashboardRoutes.php?rev=3168433#L1392) |  |
  | 1393 | 1392 | } |
  | 1394 | 1393 |  |
  | 1395 |  | if(isset($data["categories"]) && is\_array($data["categories"])){ |
  |  | 1394 | if(isset($data["categories"]) && is\_array($data["categories"])) { |
  | 1396 | 1395 | foreach ($data["categories"] as $category) { |
  | 1397 | 1396 | if(isset($category["uuid"]) || isset($category["name"])){ |
  | […](/browser/clover-online-orders/trunk/includes/restapi/DashboardRoutes.php?rev=3142846#L1463) | […](/browser/clover-online-orders/trunk/includes/restapi/DashboardRoutes.php?rev=3168433#L1462) |  |
  | 1463 | 1462 | "skipWhenImageExist"=>$skipWhenImageExist, |
  | 1464 | 1463 | "skippedItems"=>$skippedItems, |
  | 1465 |  | "skippedCatego~~e~~ries"=>$skippedCategories, |
  |  | 1464 | "skippedCategories"=>$skippedCategories, |
  | 1466 | 1465 | ], |
  | 1467 | 1466 | "errors"=>$errors |
  | […](/browser/clover-online-orders/trunk/includes/restapi/DashboardRoutes.php?rev=3142846#L1556) | […](/browser/clover-online-orders/trunk/includes/restapi/DashboardRoutes.php?rev=3168433#L1555) |  |
  | 1556 | 1555 | } |
  | 1557 | 1556 |  |
  | 1558 |  | private function uploadFileByUrl( $image\_url ) { |
  | 1559 |  |  |
  | 1560 |  | // it allows us to use download\_url() and wp\_handle\_sideload() functions |
  | 1561 |  | require\_once( ABSPATH . 'wp-admin/includes/file.php' ); |
  |  | 1557 | /\*\* |
  |  | 1558 | \* @throws Exception |
  |  | 1559 | \*/ |
  |  | 1560 | private function uploadFileByUrl($image\_url ) { |
  |  | 1561 |  |
  |  | 1562 | // If the function it's not available, require it. |
  |  | 1563 | if ( ! function\_exists( 'download\_url' ) ) { |
  |  | 1564 | // it allows us to use download\_url() and wp\_handle\_sideload() functions |
  |  | 1565 | require\_once ABSPATH . '/wp-admin/includes/file.php'; |
  |  | 1566 | } |
  | 1562 | 1567 |  |
  | 1563 | 1568 | // download to temp dir |
  | […](/browser/clover-online-orders/trunk/includes/restapi/DashboardRoutes.php?rev=3142846#L1568) | […](/browser/clover-online-orders/trunk/includes/restapi/DashboardRoutes.php?rev=3168433#L1573) |  |
  | 1568 | 1573 | } |
  | 1569 | 1574 | $filetype = wp\_check\_filetype( $temp\_file ); |
  |  | 1575 |  |
  | 1570 | 1576 |  |
  | 1571 | 1577 | // move the temp file into the uploads directory |
  | […](/browser/clover-online-orders/trunk/includes/restapi/DashboardRoutes.php?rev=3142846#L1585) | […](/browser/clover-online-orders/trunk/includes/restapi/DashboardRoutes.php?rev=3168433#L1591) |  |
  | 1585 | 1591 |  |
  | 1586 | 1592 | if( ! empty( $sideload[ 'error' ] ) ) { |
  | 1587 |  | // you may return error message if you want |
  |  | 1593 | // you may return an error message if you want |
  | 1588 | 1594 | throw new Exception($sideload[ 'error' ]); |
  | 1589 | 1595 | } |
  | […](/browser/clover-online-orders/trunk/includes/restapi/DashboardRoutes.php?rev=3142846#L1605) | […](/browser/clover-online-orders/trunk/includes/restapi/DashboardRoutes.php?rev=3168433#L1611) |  |
  | 1605 | 1611 | } |
  | 1606 | 1612 |  |
  | 1607 |  | // update me~~dat~~ata, regenerate image sizes |
  |  | 1613 | // update metadata, regenerate image sizes |
  | 1608 | 1614 | require\_once( ABSPATH . 'wp-admin/includes/image.php' ); |
  | 1609 | 1615 |  |
  | […](/browser/clover-online-orders/trunk/includes/restapi/DashboardRoutes.php?rev=3142846#L1613) | […](/browser/clover-online-orders/trunk/includes/restapi/DashboardRoutes.php?rev=3168433#L1619) |  |
  | 1613 | 1619 | ); |
  | 1614 | 1620 |  |
  |  | 1621 | @unlink( $temp\_file ); |
  |  | 1622 |  |
  | 1615 | 1623 | return $sideload[ 'url' ]; |
  | 1616 | 1624 |  |
* ## [clover-online-orders/trunk/includes/shortcodes/addToCartButton.php](/changeset/3168433/clover-online-orders/trunk/includes/shortcodes/addToCartButton.php "Show the changeset 3168433 restricted to clover-online-orders/trunk/includes/shortcodes/addToCartButton.php")

  | [r3142846](/browser/clover-online-orders/trunk/includes/shortcodes/addToCartButton.php?rev=3142846#L48 "Show revision 3142846 of this file in browser") | [r3168433](/browser/clover-online-orders/trunk/includes/shortcodes/addToCartButton.php?rev=3168433#L48 "Show revision 3168433 of this file in browser") |  |
  | --- | --- | --- |
  | 48 | 48 | private function enqueueStylesAndScripts() |
  | 49 | 49 | { |
  | 50 |  |  |
  | 51 | 50 | $this->enqueueCssGrid(); |
  | 52 | 51 |  |
* ## [clover-online-orders/trunk/includes/shortcodes/checkoutPage.php](/changeset/3168433/clover-online-orders/trunk/includes/shortcodes/checkoutPage.php "Show the changeset 3168433 restricted to clover-online-orders/trunk/includes/shortcodes/checkoutPage.php")

  | [r3142846](/browser/clover-online-orders/trunk/includes/shortcodes/checkoutPage.php?rev=3142846#L446 "Show revision 3142846 of this file in browser") | [r3168433](/browser/clover-online-orders/trunk/includes/shortcodes/checkoutPage.php?rev=3168433#L446 "Show revision 3168433 of this file in browser") |  |
  | --- | --- | --- |
  | 446 | 446 | <?php |
  | 447 | 447 | /\* translators: %s represent our tos link \*/ |
  | 448 |  | printf(\_\_('By clicking the button below you agree to our <a href="%s" target="\_blank">Terms Of Service</a>', 'moo\_OnlineOrders'), "https://www.zaytech.com/zaytech-eula"); |
  |  | 448 | printf(\_\_('By clicking the button below, you agree to our <a href="%s" target="\_blank">Terms Of Service</a>', 'moo\_OnlineOrders'), "https://www.zaytech.com/zaytech-eula"); |
  | 449 | 449 | ?> |
  | 450 | 450 | </p> |
  | […](/browser/clover-online-orders/trunk/includes/shortcodes/checkoutPage.php?rev=3142846#L554) | […](/browser/clover-online-orders/trunk/includes/shortcodes/checkoutPage.php?rev=3168433#L554) |  |
  | 554 | 554 | <?php \_e("contact", "moo\_OnlineOrders"); ?> |
  | 555 | 555 | <span class="moo-checkout-edit-icon" onclick="moo\_checkout\_edit\_contact()"> |
  | 556 |  | <img src="<?php echo  ~~plugin\_dir\_url(dirname(\_\_FILE\_\_))."..~~/public/img/edit-pen.png"?>" alt="edit"> |
  |  | 556 | <img src="<?php echo  SOO\_PLUGIN\_PATH."/public/img/edit-pen.png"?>" alt="edit"> |
  | 557 | 557 | </span> |
  | 558 | 558 | </div> |
  | […](/browser/clover-online-orders/trunk/includes/shortcodes/checkoutPage.php?rev=3142846#L594) | […](/browser/clover-online-orders/trunk/includes/shortcodes/checkoutPage.php?rev=3168433#L594) |  |
  | 594 | 594 | echo '<div class="moo-checkout-form-ordertypes-option">'; |
  | 595 | 595 | if (isset($ot->available) && $ot->available === false) { |
  | 596 |  | echo '<input class="moo-checkout-form-ordertypes-input" type="radio" name="ordertype" value="'.~~$ot->ot\_uuid.'" id="moo-checkout-form-ordertypes-'.$ot->ot\_uuid~~.'" disabled>'; |
  | 597 |  | echo '<label for="moo-checkout-form-ordertypes-'.~~$ot->ot\_uuid.'" style="display: inline;margin-left:15px;font-size: 16px; vertical-align: sub;">'.stripslashes((string)$ot->label).' ( '.stripslashes((string)$ot->custom\_message~~).' )</label></div>'; |
  |  | 596 | echo '<input class="moo-checkout-form-ordertypes-input" type="radio" name="ordertype" value="'.esc\_attr($ot->ot\_uuid).'" id="moo-checkout-form-ordertypes-'.esc\_attr($ot->ot\_uuid).'" disabled>'; |
  |  | 597 | echo '<label for="moo-checkout-form-ordertypes-'.esc\_attr($ot->ot\_uuid).'" style="display: inline;margin-left:15px;font-size: 16px; vertical-align: sub;">'.wp\_kses\_post(wp\_unslash($ot->label)).' ( '.wp\_kses\_post(wp\_unslash($ot->custom\_message)).' )</label></div>'; |
  | 598 | 598 | } else { |
  | 599 |  | echo '<input class="moo-checkout-form-ordertypes-input" type="radio" name="ordertype" value="'.~~$ot->ot\_uuid.'" id="moo-checkout-form-ordertypes-'.$ot->ot\_uuid~~.'">'; |
  | 600 |  | echo '<label for="moo-checkout-form-ordertypes-'.~~$ot->ot\_uuid.'" style="display: inline;margin-left:15px;font-size: 16px; vertical-align: sub;">'.stripslashes((string)$ot->label~~).'</label></div>'; |
  |  | 599 | echo '<input class="moo-checkout-form-ordertypes-input" type="radio" name="ordertype" value="'.esc\_attr($ot->ot\_uuid).'" id="moo-checkout-form-ordertypes-'.esc\_attr($ot->ot\_uuid).'">'; |
  |  | 600 | echo '<label for="moo-checkout-form-ordertypes-'.esc\_attr($ot->ot\_uuid).'" style="display: inline;margin-left:15px;font-size: 16px; vertical-align: sub;">'.wp\_kses\_post(wp\_unslash($ot->label)).'</label></div>'; |
  | 601 | 601 | } |
  | 602 | 602 | } |
  | […](/browser/clover-online-orders/trunk/includes/shortcodes/checkoutPage.php?rev=3142846#L622) | […](/browser/clover-online-orders/trunk/includes/shortcodes/checkoutPage.php?rev=3168433#L622) |  |
  | 622 | 622 | <?php |
  | 623 | 623 | foreach ($oppening\_status["pickup\_time"] as $key => $val) { |
  | 624 |  | echo '<option value="'.~~$key.'">'.$key~~.'</option>'; |
  |  | 624 | echo '<option value="'.esc\_attr($key).'">'.esc\_attr($key).'</option>'; |
  | 625 | 625 | } |
  | 626 | 626 | ?> |
  | […](/browser/clover-online-orders/trunk/includes/shortcodes/checkoutPage.php?rev=3142846#L635) | […](/browser/clover-online-orders/trunk/includes/shortcodes/checkoutPage.php?rev=3168433#L635) |  |
  | 635 | 635 | foreach ($oppening\_status["pickup\_time"] as $val) { |
  | 636 | 636 | foreach ($val as $h) { |
  | 637 |  | echo '<option value="'.~~$h.'">'.$h~~.'</option>'; |
  |  | 637 | echo '<option value="'.esc\_attr($h).'">'.esc\_attr($h).'</option>'; |
  | 638 | 638 | } |
  | 639 | 639 | break; |
  | […](/browser/clover-online-orders/trunk/includes/shortcodes/checkoutPage.php?rev=3142846#L672) | […](/browser/clover-online-orders/trunk/includes/shortcodes/checkoutPage.php?rev=3168433#L672) |  |
  | 672 | 672 | <div id="moo\_cashPanel"> |
  | 673 | 673 | <div class="moo-row"  id="moo\_verifPhone\_verified"> |
  | 674 |  | <img src="<?php echo  ~~plugin\_dir\_url(dirname(\_\_FILE\_\_))."..~~/public/img/check.png"?>" width="60px" style="display: inline-block;" alt=""> |
  |  | 674 | <img src="<?php echo  SOO\_PLUGIN\_URL ."/public/img/check.png"?>" width="60px" style="display: inline-block;" alt=""> |
  | 675 | 675 | <p> |
  | 676 | 676 | <?php \_e("Your phone number has been verified", "moo\_OnlineOrders"); ?> |
  | […](/browser/clover-online-orders/trunk/includes/shortcodes/checkoutPage.php?rev=3142846#L772) | […](/browser/clover-online-orders/trunk/includes/shortcodes/checkoutPage.php?rev=3168433#L772) |  |
  | 772 | 772 | <div class="moo-col-md-8"> |
  | 773 | 773 | <div class="moo-form-group"> |
  | 774 |  | <p style="font-size: 20px" id="moo\_remove\_coupon\_code"><?php if ($coupon != null) { |
  | 775 |  | echo $coupon['code']; |
  | 776 |  | }?></p> |
  |  | 774 | <p style="font-size: 20px" id="moo\_remove\_coupon\_code"> |
  |  | 775 | <?php |
  |  | 776 | if ($coupon != null) { |
  |  | 777 | echo sanitize\_text\_field($coupon['code']); |
  |  | 778 | } |
  |  | 779 | ?></p> |
  | 777 | 780 | </div> |
  | 778 | 781 | </div> |
  | […](/browser/clover-online-orders/trunk/includes/shortcodes/checkoutPage.php?rev=3142846#L799) | […](/browser/clover-online-orders/trunk/includes/shortcodes/checkoutPage.php?rev=3168433#L802) |  |
  | 799 | 802 | $modifiers\_price = 0; |
  | 800 | 803 | if (isset($line['item']->soo\_name) && !empty($line['item']->soo\_name)) { |
  | 801 |  | $item\_name=~~stripslashes~~((string)$line['item']->soo\_name); |
  |  | 804 | $item\_name=wp\_unslash((string)$line['item']->soo\_name); |
  | 802 | 805 | } else { |
  | 803 | 806 | if ($this->useAlternateNames && isset($line['item']->alternate\_name) && $line['item']->alternate\_name!=="") { |
  | 804 |  | $item\_name=~~stripslashes~~((string)$line['item']->alternate\_name); |
  |  | 807 | $item\_name=wp\_unslash((string)$line['item']->alternate\_name); |
  | 805 | 808 | } else { |
  | 806 |  | $item\_name=~~stripslashes~~((string)$line['item']->name); |
  |  | 809 | $item\_name=wp\_unslash((string)$line['item']->name); |
  | 807 | 810 | } |
  | 808 | 811 | } |
  | 809 | 812 |  |
  | 810 | 813 | ?> |
  | 811 |  | <div class="moo-product" tabindex="0" aria-label="<?php echo ~~$line['quantity']~~." of ".$line['item']->name."" ?>"> |
  |  | 814 | <div class="moo-product" tabindex="0" aria-label="<?php echo sanitize\_text\_field($line['quantity'])." of ".$line['item']->name."" ?>"> |
  | 812 | 815 | <div class="moo-product-quantity" style="width: 20%"> |
  | 813 |  | <strong><?php echo ~~$line['quantity']~~?></strong> |
  |  | 816 | <strong><?php echo sanitize\_text\_field($line['quantity']); ?></strong> |
  | 814 | 817 | </div> |
  | 815 | 818 | <div class="moo-product-details moo-product-details-checkout" style="width: 60%"> |
  | […](/browser/clover-online-orders/trunk/includes/shortcodes/checkoutPage.php?rev=3142846#L820) | […](/browser/clover-online-orders/trunk/includes/shortcodes/checkoutPage.php?rev=3168433#L823) |  |
  | 820 | 823 | $modifier\_name = ""; |
  | 821 | 824 | if ($this->useAlternateNames && isset($modifier["alternate\_name"]) && $modifier["alternate\_name"]!=="") { |
  | 822 |  | $modifier\_name =~~stripslashes~~((string)$modifier["alternate\_name"]); |
  |  | 825 | $modifier\_name =wp\_unslash((string)$modifier["alternate\_name"]); |
  | 823 | 826 | } else { |
  | 824 |  | $modifier\_name =~~stripslashes~~((string)$modifier["name"]); |
  |  | 827 | $modifier\_name =wp\_unslash((string)$modifier["name"]); |
  | 825 | 828 | } |
  | 826 | 829 | if (isset($modifier['qty']) && intval($modifier['qty'])>0) { |
  | […](/browser/clover-online-orders/trunk/includes/shortcodes/checkoutPage.php?rev=3142846#L839) | […](/browser/clover-online-orders/trunk/includes/shortcodes/checkoutPage.php?rev=3168433#L842) |  |
  | 839 | 842 | } |
  | 840 | 843 | if ($line['special\_ins'] != "") { |
  | 841 |  | echo '<span tabindex="0" aria-label="your special instructions">SI:<span><span tabindex="0"> '.~~$line['special\_ins']~~."<span>"; |
  |  | 844 | echo '<span tabindex="0" aria-label="your special instructions">SI:<span><span tabindex="0"> '.sanitize\_text\_field($line['special\_ins'])."<span>"; |
  | 842 | 845 | } |
  | 843 | 846 | ?> |
  | […](/browser/clover-online-orders/trunk/includes/shortcodes/checkoutPage.php?rev=3142846#L1648) | […](/browser/clover-online-orders/trunk/includes/shortcodes/checkoutPage.php?rev=3168433#L1651) |  |
  | 1648 | 1651 | echo '<div class="soo-checkout-radio-input-option">'; |
  | 1649 | 1652 | if (isset($ot['available']) && $ot['available'] === false) { |
  | 1650 |  | echo '<input class="soo-checkout-radio-input" type="radio" name="ordertype" value="'.~~$ot['ot\_uuid'].'" id="moo-checkout-form-ordertypes-'.$ot['ot\_uuid']~~.'" disabled>'; |
  | 1651 |  | echo '<label for="moo-checkout-form-ordertypes-'.~~$ot['ot\_uuid'].'" class="moo-checkout-radio-input-label">'.stripslashes((string)$ot['label']).' ( '.stripslashes((string)$ot['custom\_message']~~).' )</label></div>'; |
  |  | 1653 | echo '<input class="soo-checkout-radio-input" type="radio" name="ordertype" value="'.esc\_attr($ot['ot\_uuid']).'" id="moo-checkout-form-ordertypes-'.esc\_attr($ot['ot\_uuid']).'" disabled>'; |
  |  | 1654 | echo '<label for="moo-checkout-form-ordertypes-'.esc\_attr($ot['ot\_uuid']).'" class="moo-checkout-radio-input-label">'.wp\_kses\_post(wp\_unslash($ot['label'])).' ( '.wp\_kses\_post(wp\_unslash($ot['custom\_message'])).' )</label></div>'; |
  | 1652 | 1655 | } else { |
  | 1653 |  | echo '<input onchange="mooCheckout.orderTypeChanged()" class="soo-checkout-radio-input" type="radio" name="ordertype" value="'.~~$ot['ot\_uuid'].'" id="moo-checkout-form-ordertypes-'.$ot['ot\_uuid']~~.'">'; |
  | 1654 |  | echo '<label for="moo-checkout-form-ordertypes-'.~~$ot['ot\_uuid'].'" class="moo-checkout-radio-input-label">'.stripslashes((string)$ot['label']~~).'</label></div>'; |
  |  | 1656 | echo '<input onchange="mooCheckout.orderTypeChanged()" class="soo-checkout-radio-input" type="radio" name="ordertype" value="'.esc\_attr($ot['ot\_uuid']).'" id="moo-checkout-form-ordertypes-'.esc\_attr($ot['ot\_uuid']).'">'; |
  |  | 1657 | echo '<label for="moo-checkout-form-ordertypes-'.esc\_attr($ot['ot\_uuid']).'" class="moo-checkout-radio-input-label">'.wp\_kses\_post(wp\_unslash($ot['label'])).'</label></div>'; |
  | 1655 | 1658 | } |
  | 1656 | 1659 | } |
  | […](/browser/clover-online-orders/trunk/includes/shortcodes/checkoutPage.php?rev=3142846#L1998) | […](/browser/clover-online-orders/trunk/includes/shortcodes/checkoutPage.php?rev=3168433#L2001) |  |
  | 1998 | 2001 | public function render($atts, $content) |
  | 1999 | 2002 | { |
  | 2000 |  | if (get\_option('moo\_~~new~~\_checkout\_enabled') === 'yes') { |
  | 2001 |  | return $this->~~advance~~dCheckout($atts, $content); |
  | 2002 |  | } |
  | 2003 |  | return $this->~~standar~~dCheckout($atts, $content); |
  |  | 2003 | if (get\_option('moo\_old\_checkout\_enabled') === 'yes') { |
  |  | 2004 | return $this->standardCheckout($atts, $content); |
  |  | 2005 | } |
  |  | 2006 | return $this->advancedCheckout($atts, $content); |
  | 2004 | 2007 | } |
  | 2005 | 2008 |  |
  | […](/browser/clover-online-orders/trunk/includes/shortcodes/checkoutPage.php?rev=3142846#L2013) | […](/browser/clover-online-orders/trunk/includes/shortcodes/checkoutPage.php?rev=3168433#L2016) |  |
  | 2013 | 2016 | $defaultText = \_\_("Click Here", "moo\_OnlineOrders"); |
  | 2014 | 2017 | $defaultTitle = \_\_("Click Here", "moo\_OnlineOrders"); |
  | 2015 |  | $linkText = (~~isset($atts['text']) && !empty($atts['text'])) ? sanitize\_text\_field~~($atts['text']) : $defaultText; |
  | 2016 |  | $linkTitle = (~~isset($atts['title']) && !empty($atts['title'])) ? sanitize\_text\_field~~($atts['title']) : $defaultTitle; |
  | 2017 |  | $orderId = (~~isset($\_GET['order\_id']) && !empty($\_GET['order\_id'])) ? sanitize\_text\_field~~($\_GET['order\_id']) : null; |
  |  | 2018 | $linkText = (!empty($atts['text'])) ? esc\_attr($atts['text']) : $defaultText; |
  |  | 2019 | $linkTitle = (!empty($atts['title'])) ? esc\_attr($atts['title']) : $defaultTitle; |
  |  | 2020 | $orderId = (!empty($\_GET['order\_id'])) ? esc\_attr($\_GET['order\_id']) : null; |
  | 2018 | 2021 | if ($orderId) { |
  | 2019 | 2022 | if (defined('SOO\_ENV') && SOO\_ENV === 'DEV') { |
  | […](/browser/clover-online-orders/trunk/includes/shortcodes/checkoutPage.php?rev=3142846#L2335) | […](/browser/clover-online-orders/trunk/includes/shortcodes/checkoutPage.php?rev=3168433#L2338) |  |
  | 2335 | 2338 | $use = \_\_("Use ", "moo\_OnlineOrders"). $label; |
  | 2336 | 2339 | $dontUse = \_\_("Remove ", "moo\_OnlineOrders"). $label; |
  | 2337 |  | $imgLink = ~~plugin\_dir\_url(dirname(\_\_FILE\_\_))."..~~/public/img/loyaltyIcon.svg"; |
  |  | 2340 | $imgLink = SOO\_PLUGIN\_URL . "/public/img/loyaltyIcon.svg"; |
  | 2338 | 2341 | $html = <<<HTML |
  | 2339 | 2342 | <div id="moo-checkout-form-loyalty"> |
  | […](/browser/clover-online-orders/trunk/includes/shortcodes/checkoutPage.php?rev=3142846#L2616) | […](/browser/clover-online-orders/trunk/includes/shortcodes/checkoutPage.php?rev=3168433#L2619) |  |
  | 2616 | 2619 | $html .= '<div class="moo-checkout-bloc-content">'; |
  | 2617 | 2620 | if (isset($this->pluginSettings['text\_under\_special\_instructions']) && $this->pluginSettings['text\_under\_special\_instructions']!=='') { |
  | 2618 |  | $html .= '<div class="moo-special-instruction-title">'.~~$this->pluginSettings['text\_under\_special\_instructions']~~.'</div>'; |
  |  | 2621 | $html .= '<div class="moo-special-instruction-title">'.wp\_kses\_post(wp\_unslash($this->pluginSettings['text\_under\_special\_instructions'])).'</div>'; |
  | 2619 | 2622 | } |
  | 2620 | 2623 | if (isset($this->pluginSettings['special\_instructions\_required']) && $this->pluginSettings['special\_instructions\_required']==='yes') { |
* ## [clover-online-orders/trunk/includes/shortcodes/storePage.php](/changeset/3168433/clover-online-orders/trunk/includes/shortcodes/storePage.php "Show the changeset 3168433 restricted to clover-online-orders/trunk/includes/shortcodes/storePage.php")

  | [r3142846](/browser/clover-online-orders/trunk/includes/shortcodes/storePage.php?rev=3142846#L184 "Show revision 3142846 of this file in browser") | [r3168433](/browser/clover-online-orders/trunk/includes/shortcodes/storePage.php?rev=3168433#L184 "Show revision 3168433 of this file in browser") |  |
  | --- | --- | --- |
  | 184 | 184 | $categories = array(); |
  | 185 | 185 | if(!empty($atts["categories"])){ |
  | 186 |  | $categoriesIds = ~~sanitize\_text\_field~~($atts["categories"]); |
  |  | 186 | $categoriesIds = esc\_attr($atts["categories"]); |
  | 187 | 187 | $categories = explode(",",strtoupper($categoriesIds)); |
  | 188 | 188 | } |
  | 189 | 189 |  |
  | 190 | 190 | if(!empty($atts["force\_theme"])){ |
  | 191 |  | $theme\_id = ~~sanitize\_text\_field~~($atts["force\_theme"]); |
  |  | 191 | $theme\_id = esc\_attr($atts["force\_theme"]); |
  | 192 | 192 | } |
  | 193 | 193 |  |
  | […](/browser/clover-online-orders/trunk/includes/shortcodes/storePage.php?rev=3142846#L239) | […](/browser/clover-online-orders/trunk/includes/shortcodes/storePage.php?rev=3168433#L239) |  |
  | 239 | 239 |  |
  | 240 | 240 | if(!empty($atts["categories"])){ |
  | 241 |  | $categoriesIds = ~~sanitize\_text\_field~~($atts["categories"]); |
  |  | 241 | $categoriesIds = esc\_attr($atts["categories"]); |
  | 242 | 242 | $categories = explode(",",strtoupper($categoriesIds)); |
  | 243 | 243 | } |
* ## [clover-online-orders/trunk/models/moo-OnlineOrders-Model.php](/changeset/3168433/clover-online-orders/trunk/models/moo-OnlineOrders-Model.php "Show the changeset 3168433 restricted to clover-online-orders/trunk/models/moo-OnlineOrders-Model.php")

  | [r3142846](/browser/clover-online-orders/trunk/models/moo-OnlineOrders-Model.php?rev=3142846#L410 "Show revision 3142846 of this file in browser") | [r3168433](/browser/clover-online-orders/trunk/models/moo-OnlineOrders-Model.php?rev=3168433#L410 "Show revision 3168433 of this file in browser") |  |
  | --- | --- | --- |
  | 410 | 410 | function updateOrderType($uuid,$name,$enable,$taxable,$type,$minAmount,$maxAmount,$customHours,$useCoupons,$customMessage,$allowScOrders,$allowServiceFee) |
  | 411 | 411 | { |
  | 412 |  | $uuid = esc\_sql($uuid); |
  | 413 |  | // $label = esc\_sql($name); |
  |  | 412 |  |
  |  | 413 | $uuid = sanitize\_text\_field($uuid); |
  |  | 414 | $label = wp\_kses\_post(wp\_unslash($name)); |
  | 414 | 415 | $taxable = esc\_sql($taxable); |
  | 415 | 416 | $status = esc\_sql($enable); |
  | […](/browser/clover-online-orders/trunk/models/moo-OnlineOrders-Model.php?rev=3142846#L421) | […](/browser/clover-online-orders/trunk/models/moo-OnlineOrders-Model.php?rev=3168433#L422) |  |
  | 421 | 422 | $allowScOrders = esc\_sql($allowScOrders); |
  | 422 | 423 | $allowServiceFee = esc\_sql($allowServiceFee); |
  | 423 |  | ~~// $customMessage = esc\_sql($customMessage~~); |
  |  | 424 | $customMessage = wp\_kses\_post(wp\_unslash($customMessage)); |
  | 424 | 425 |  |
  | 425 | 426 | return $this->db->update("{$this->db->prefix}moo\_order\_types", |
  | 426 | 427 | array( |
  | 427 |  | 'label' => $~~name~~, |
  |  | 428 | 'label' => $label, |
  | 428 | 429 | 'taxable' => $taxable, |
  | 429 | 430 | 'status' => $status, |
  | […](/browser/clover-online-orders/trunk/models/moo-OnlineOrders-Model.php?rev=3142846#L625) | […](/browser/clover-online-orders/trunk/models/moo-OnlineOrders-Model.php?rev=3168433#L626) |  |
  | 625 | 626 | $customer\_lng    = esc\_sql($customer\_lng); |
  | 626 | 627 |  |
  | 627 |  | $date = date('Y/m/d H:i:s', $datetime); |
  |  | 628 | $date = gmdate('Y/m/d H:i:s', $datetime); |
  | 628 | 629 | $this->db->insert( |
  | 629 | 630 | "{$this->db->prefix}moo\_order", |
  | […](/browser/clover-online-orders/trunk/models/moo-OnlineOrders-Model.php?rev=3142846#L902) | […](/browser/clover-online-orders/trunk/models/moo-OnlineOrders-Model.php?rev=3168433#L903) |  |
  | 902 | 903 | if ( isset($item["featured"]) ){ |
  | 903 | 904 | $fields["featured"] = $item["featured"]; |
  |  | 905 | } |
  |  | 906 | if ( isset($item["outofstock"]) ){ |
  |  | 907 | $fields["outofstock"] = $item["outofstock"]; |
  |  | 908 | } |
  |  | 909 | if ( isset($item["visible"]) ){ |
  |  | 910 | $fields["visible"] = $item["visible"]; |
  | 904 | 911 | } |
  | 905 | 912 | if (count($fields)>0){ |
* ## [clover-online-orders/trunk/moo\_OnlineOrders.php](/changeset/3168433/clover-online-orders/trunk/moo_OnlineOrders.php "Show the changeset 3168433 restricted to clover-online-orders/trunk/moo_OnlineOrders.php")

  | [r3142846](/browser/clover-online-orders/trunk/moo_OnlineOrders.php?rev=3142846#L17 "Show revision 3142846 of this file in browser") | [r3168433](/browser/clover-online-orders/trunk/moo_OnlineOrders.php?rev=3168433#L17 "Show revision 3168433 of this file in browser") |  |
  | --- | --- | --- |
  | 17 | 17 | \* Plugin URI:        https://www.zaytech.com |
  | 18 | 18 | \* Description:       Start taking orders from your Wordpress website and have them sent to your Clover Station |
  | 19 |  | \* Version:           1.5.~~7~~ |
  |  | 19 | \* Version:           1.5.8 |
  | 20 | 20 | \* Author:            Zaytech |
  | 21 | 21 | \* Author URI:        https://www.zaytech.com |
  | 22 |  | \* License:           ~~Clover app~~ |
  | 23 |  | \* License URI:       http~~s://www.zaytech.com~~ |
  |  | 22 | \* License:           GPLv2 or later |
  |  | 23 | \* License URI:       http://www.gnu.org/licenses/gpl-2.0.html |
  | 24 | 24 | \* Text Domain:       moo\_OnlineOrders |
  | 25 | 25 | \* Domain Path:       /languages |
  | […](/browser/clover-online-orders/trunk/moo_OnlineOrders.php?rev=3142846#L38) | […](/browser/clover-online-orders/trunk/moo_OnlineOrders.php?rev=3168433#L38) |  |
  | 38 | 38 | define('SOO\_ENV', 'PROD'); |
  | 39 | 39 | define('SOO\_DEFAULT\_CDN', false); |
  | 40 |  | define('SOO\_VERSION', "1.5.~~7~~"); |
  |  | 40 | define('SOO\_VERSION', "1.5.8-beta"); |
  | 41 | 41 | define('SOO\_G\_RECAPTCHA\_URL', 'https://www.google.com/recaptcha/api/siteverify'); |
  | 42 | 42 | define('SOO\_ACCEPT\_GIFTCARDS', true); |
  | […](/browser/clover-online-orders/trunk/moo_OnlineOrders.php?rev=3142846#L120) | […](/browser/clover-online-orders/trunk/moo_OnlineOrders.php?rev=3168433#L120) |  |
  | 120 | 120 |  |
  | 121 | 121 | function moo\_OnlineOrders\_shortcodes\_categorymsg($atts, $content) { |
  | 122 |  | if (isset($atts["cat\_id"]) && ~~$atts["message"]~~) { |
  |  | 122 | if (isset($atts["cat\_id"]) && !empty($atts["message"])) { |
  | 123 | 123 | if (isset($\_GET["category"]) && $\_GET["category"] == $atts["cat\_id"]) { |
  | 124 |  | if (~~isset($atts["css-class"]) && $atts["css-class"]!=""~~) { |
  | 125 |  | return "<div class='".~~$atts["css-class"]~~."'>".esc\_attr($atts["message"])."</div>"; |
  |  | 124 | if (!empty($atts["css-class"])) { |
  |  | 125 | return "<div class='".esc\_attr($atts["css-class"])."'>".esc\_attr($atts["message"])."</div>"; |
  | 126 | 126 | } else { |
  | 127 |  | return ~~sanitize\_text\_field~~($atts["message"]); |
  |  | 127 | return esc\_attr($atts["message"]); |
  | 128 | 128 | } |
  | 129 | 129 | } |
  | […](/browser/clover-online-orders/trunk/moo_OnlineOrders.php?rev=3142846#L214) | […](/browser/clover-online-orders/trunk/moo_OnlineOrders.php?rev=3168433#L214) |  |
  | 214 | 214 | add\_action('admin\_init', 'moo\_deactivateAndClean'); |
  | 215 | 215 |  |
  | 216 |  | if (get\_option('moo\_onlineOrders\_version') != '15~~7~~') { |
  |  | 216 | if (get\_option('moo\_onlineOrders\_version') != '158') { |
  | 217 | 217 | add\_action('plugins\_loaded', 'moo\_onlineOrders\_check\_version'); |
  | 218 | 218 | } |
  | […](/browser/clover-online-orders/trunk/moo_OnlineOrders.php?rev=3142846#L224) | […](/browser/clover-online-orders/trunk/moo_OnlineOrders.php?rev=3168433#L224) |  |
  | 224 | 224 | \* @since v 1.1.2 |
  | 225 | 225 | \*/ |
  | 226 |  | function moo\_onlineOrders\_check\_version() |
  | 227 |  | { |
  | 228 |  | global $wpdb; |
  | 229 |  | $wpdb->hide\_errors(); |
  |  | 226 | function moo\_onlineOrders\_check\_version() { |
  | 230 | 227 | $version = get\_option('moo\_onlineOrders\_version'); |
  |  | 228 | if (empty($version)) { |
  |  | 229 | $version = 120; |
  |  | 230 | } else { |
  |  | 231 | $version = intval($version); |
  |  | 232 | } |
  |  | 233 |  |
  |  | 234 | if (! class\_exists( 'Moo\_OnlineOrders\_Helpers' ) ){ |
  |  | 235 | require\_once SOO\_PLUGIN\_PATH ."/includes/moo-OnlineOrders-helpers.php"; |
  |  | 236 | } |
  |  | 237 | //Upgrade Database |
  |  | 238 | if ($version <= 136 ) { |
  |  | 239 | Moo\_OnlineOrders\_Helpers::upgradeDatabaseToVersion136(); |
  |  | 240 | } |
  |  | 241 | if ( $version <= 150 ) { |
  |  | 242 | Moo\_OnlineOrders\_Helpers::upgradeDatabaseToVersion150(); |
  |  | 243 | } |
  |  | 244 | if ( $version <= 158 ) { |
  |  | 245 | Moo\_OnlineOrders\_Helpers::upgradeDatabaseToVersion158(); |
  |  | 246 | } |
  |  | 247 |  |
  |  | 248 | //Apply default options |
  | 231 | 249 | $defaultOptions = get\_option('moo\_settings'); |
  | 232 |  | if (empty($version)) { |
  | 233 |  | $version="120"; |
  | 234 |  | } |
  | 235 |  | switch ($version) { |
  | 236 |  | case '120': |
  | 237 |  | //Adding new fields in category table |
  | 238 |  | @$wpdb->query("ALTER TABLE `{$wpdb->prefix}moo\_category` ADD `image\_url` VARCHAR(255) NULL"); |
  | 239 |  | @$wpdb->query("ALTER TABLE `{$wpdb->prefix}moo\_category` ADD `alternate\_name` VARCHAR(100) NULL"); |
  | 240 |  |  |
  | 241 |  | case '121': |
  | 242 |  | @$wpdb->query("ALTER TABLE `{$wpdb->prefix}moo\_modifier` ADD `sort\_order` INT NULL"); |
  | 243 |  | @$wpdb->query("ALTER TABLE `{$wpdb->prefix}moo\_modifier` ADD `show\_by\_default` INT NOT NULL DEFAULT '1'"); |
  | 244 |  | @$wpdb->query("ALTER TABLE `{$wpdb->prefix}moo\_modifier\_group` ADD `sort\_order` INT NULL"); |
  | 245 |  | case '122': |
  | 246 |  | @$wpdb->query("ALTER TABLE `{$wpdb->prefix}moo\_order\_types` ADD `type` INT(1) NULL"); |
  | 247 |  | case '123': |
  | 248 |  | @$wpdb->query("ALTER TABLE `{$wpdb->prefix}moo\_item` ADD `sort\_order` INT NULL"); |
  | 249 |  | case '124': |
  | 250 |  | @$wpdb->query("ALTER TABLE `{$wpdb->prefix}moo\_order\_types` ADD `sort\_order` INT NULL"); |
  | 251 |  | @$wpdb->query("CREATE TABLE IF NOT EXISTS `{$wpdb->prefix}moo\_item\_order` ( |
  | 252 |  | `\_id` INT NOT NULL AUTO\_INCREMENT, |
  | 253 |  | `item\_uuid` VARCHAR(100) NOT NULL, |
  | 254 |  | `order\_uuid` VARCHAR(100) NOT NULL, |
  | 255 |  | `quantity` VARCHAR(100) NOT NULL, |
  | 256 |  | `modifiers` TEXT NOT NULL, |
  | 257 |  | `special\_ins` VARCHAR(255) NOT NULL, |
  | 258 |  | PRIMARY KEY (`\_id`, `item\_uuid`, `order\_uuid`) |
  | 259 |  | );"); |
  | 260 |  |  |
  | 261 |  | //Change where pages are saved |
  | 262 |  | $store\_page     = get\_option('moo\_store\_page'); |
  | 263 |  | $checkout\_page  = get\_option('moo\_checkout\_page'); |
  | 264 |  | $cart\_page      = get\_option('moo\_cart\_page'); |
  | 265 |  | if (!isset($defaultOptions["store\_page"]) || $defaultOptions["store\_page"] == "") { |
  | 266 |  | $defaultOptions["store\_page"] = $store\_page; |
  | 267 |  | } |
  | 268 |  | if (!isset($defaultOptions["checkout\_page"]) || $defaultOptions["checkout\_page"] == "") { |
  | 269 |  | $defaultOptions["checkout\_page"] = $checkout\_page; |
  | 270 |  | } |
  | 271 |  | if (!isset($defaultOptions["cart\_page"]) || $defaultOptions["cart\_page"] == "") { |
  | 272 |  | $defaultOptions["cart\_page"] = $cart\_page; |
  | 273 |  | } |
  | 274 |  | if (!isset($defaultOptions["checkout\_login"]) || $defaultOptions["checkout\_login"] == "") { |
  | 275 |  | $defaultOptions["checkout\_login"] = "enabled"; |
  | 276 |  | } |
  | 277 |  | case '125': |
  | 278 |  | //add description to items |
  | 279 |  | @$wpdb->query("ALTER TABLE `{$wpdb->prefix}moo\_item` CHANGE `description` `description` TEXT "); |
  | 280 |  | @$wpdb->query("ALTER TABLE `{$wpdb->prefix}moo\_order\_types` ADD `minAmount` VARCHAR(100) NULL DEFAULT '0' "); |
  | 281 |  | //add default options for coupons feature |
  | 282 |  | if (!isset($defaultOptions["use\_coupons"]) || $defaultOptions["use\_coupons"] == "") { |
  | 283 |  | $defaultOptions["use\_coupons"] = "disabled"; |
  | 284 |  | } |
  | 285 |  | case '126': |
  | 286 |  | if (!isset($defaultOptions["use\_special\_instructions"]) || $defaultOptions["use\_special\_instructions"] == "") { |
  | 287 |  | $defaultOptions["use\_special\_instructions"] = "enabled"; |
  | 288 |  | } |
  | 289 |  | if (!isset($defaultOptions["save\_cards"]) || $defaultOptions["save\_cards"] == "") { |
  | 290 |  | $defaultOptions["save\_cards"] = "disabled"; |
  | 291 |  | } |
  | 292 |  | if (!isset($defaultOptions["save\_cards\_fees"]) || $defaultOptions["save\_cards\_fees"] == "") { |
  | 293 |  | $defaultOptions["save\_cards\_fees"] = "disabled"; |
  | 294 |  | } |
  | 295 |  | if (!isset($defaultOptions["service\_fees\_name"]) || $defaultOptions["service\_fees\_name"] == "") { |
  | 296 |  | $defaultOptions["service\_fees\_name"] = "Service Charge"; |
  | 297 |  | } |
  | 298 |  | if (!isset($defaultOptions["service\_fees\_type"]) || $defaultOptions["service\_fees\_type"] == "") { |
  | 299 |  | $defaultOptions["service\_fees\_type"] = "amount"; |
  | 300 |  | } |
  | 301 |  | if (!isset($defaultOptions["delivery\_fees\_name"]) || $defaultOptions["delivery\_fees\_name"] == "") { |
  | 302 |  | $defaultOptions["delivery\_fees\_name"] = "Delivery Charge"; |
  | 303 |  | } |
  | 304 |  | if (!isset($defaultOptions["order\_later\_minutes\_delivery"]) || $defaultOptions["order\_later\_minutes\_delivery"] == "") { |
  | 305 |  | $defaultOptions["order\_later\_minutes\_delivery"] = "60"; |
  | 306 |  | } |
  | 307 |  | if (!isset($defaultOptions["order\_later\_days\_delivery"]) || $defaultOptions["order\_later\_days\_delivery"] == "") { |
  | 308 |  | $defaultOptions["order\_later\_days\_delivery"] = "4"; |
  | 309 |  | } |
  | 310 |  | if (!isset($defaultOptions["copyrights"]) || $defaultOptions["copyrights"] == "") { |
  | 311 |  | $defaultOptions["copyrights"] = 'Powered by <a href="https://wordpress.org/plugins/clover-online-orders/" target="\_blank" title="Online Orders for Clover POS v 1.2.8">Smart Online Order</a>'; |
  | 312 |  | } |
  | 313 |  | case '127': |
  | 314 |  | $default\_options = array( |
  | 315 |  | array("name"=>"onePage\_fontFamily","value"=>"Oswald,sans-serif"), |
  | 316 |  | array("name"=>"onePage\_categoriesTopMargin","value"=>"0"), |
  | 317 |  | array("name"=>"onePage\_width","value"=>"1024"), |
  | 318 |  | array("name"=>"onePage\_categoriesFontColor","value"=>"#ffffff"), |
  | 319 |  | array("name"=>"onePage\_categoriesBackgroundColor","value"=>"#282b2e"), |
  | 320 |  | array("name"=>"onePage\_qtyWindow","value"=>"on"), |
  | 321 |  | array("name"=>"onePage\_qtyWindowForModifiers","value"=>"on"), |
  | 322 |  | array("name"=>"onePage\_backToTop","value"=>"off"), |
  | 323 |  | array("name"=>"order\_later\_asap\_for\_p","value"=>"off"), |
  | 324 |  | array("name"=>"order\_later\_asap\_for\_d","value"=>"off"), |
  | 325 |  | array("name"=>"mg\_settings\_displayInline","value"=>"disabled"), |
  | 326 |  | array("name"=>"mg\_settings\_qty\_for\_all","value"=>"enabled"), |
  | 327 |  | array("name"=>"mg\_settings\_qty\_for\_zeroPrice","value"=>"enabled"), |
  | 328 |  | ); |
  | 329 |  |  |
  | 330 |  | foreach ($default\_options as $default\_option) { |
  | 331 |  | if (!isset($defaultOptions[$default\_option["name"]])) { |
  | 332 |  | $defaultOptions[$default\_option["name"]]=$default\_option["value"]; |
  | 333 |  | } |
  | 334 |  | } |
  | 335 |  |  |
  | 336 |  | case '128': |
  | 337 |  | case '130': |
  | 338 |  | case '131': |
  | 339 |  | if (!isset($defaultOptions['onePage\_show\_more\_button'])) { |
  | 340 |  | $defaultOptions['onePage\_show\_more\_button']='on'; |
  | 341 |  | } |
  | 342 |  | $defaultOptions['payment\_creditcard'] = 'off'; |
  | 343 |  | $defaultOptions['use\_sms\_verification'] = 'enabled'; |
  | 344 |  | case '132': |
  | 345 |  | if (!isset($defaultOptions['my\_account\_page'])) { |
  | 346 |  | $defaultOptions['my\_account\_page']=''; |
  | 347 |  | } |
  | 348 |  | if (!isset($defaultOptions['text\_under\_special\_instructions'])) { |
  | 349 |  | $defaultOptions['text\_under\_special\_instructions']='\*additional charges may apply and not all changes are possible'; |
  | 350 |  | } |
  | 351 |  | if (!isset($defaultOptions['use\_couponsApp'])) { |
  | 352 |  | $defaultOptions['use\_couponsApp']= "off"; |
  | 353 |  | } |
  | 354 |  | if (!isset($defaultOptions['custom\_sa\_content'])) { |
  | 355 |  | $defaultOptions['custom\_sa\_content']= ""; |
  | 356 |  | } |
  | 357 |  | if (!isset($defaultOptions['custom\_sa\_title'])) { |
  | 358 |  | $defaultOptions['custom\_sa\_title']= ""; |
  | 359 |  | } |
  | 360 |  | if (!isset($defaultOptions['custom\_sa\_onCheckoutPage'])) { |
  | 361 |  | $defaultOptions['custom\_sa\_onCheckoutPage']= "off"; |
  | 362 |  | } |
  | 363 |  | if (!isset($defaultOptions['closing\_msg'])) { |
  | 364 |  | $defaultOptions['closing\_msg']= ""; |
  | 365 |  | } |
  | 366 |  | case '133': |
  | 367 |  | if (!isset($defaultOptions['accept\_orders'])) { |
  | 368 |  | $defaultOptions['accept\_orders']= "enabled"; |
  | 369 |  | } |
  | 370 |  | if (!isset($defaultOptions['onePage\_askforspecialinstruction'])) { |
  | 371 |  | $defaultOptions['onePage\_askforspecialinstruction'] = 'off'; |
  | 372 |  | } |
  | 373 |  | if (!isset($defaultOptions['onePage\_messageforspecialinstruction'])) { |
  | 374 |  | $defaultOptions['onePage\_messageforspecialinstruction'] = 'Type your instructions here, additional charges may apply and not all changes are possible'; |
  | 375 |  | } |
  | 376 |  | if (!isset($defaultOptions['jTheme\_askforspecialinstruction'])) { |
  | 377 |  | $defaultOptions['jTheme\_askforspecialinstruction'] = 'off'; |
  | 378 |  | } |
  | 379 |  | if (!isset($defaultOptions['jTheme\_messageforspecialinstruction'])) { |
  | 380 |  | $defaultOptions['jTheme\_messageforspecialinstruction'] = 'Type your instructions here, additional charges may apply and not all changes are possible'; |
  | 381 |  | } |
  | 382 |  | if (!isset($defaultOptions['style2\_askforspecialinstruction'])) { |
  | 383 |  | $defaultOptions['style2\_askforspecialinstruction'] = 'off'; |
  | 384 |  | } |
  | 385 |  | if (!isset($defaultOptions['style2\_messageforspecialinstruction'])) { |
  | 386 |  | $defaultOptions['style2\_messageforspecialinstruction'] = 'Type your instructions here, additional charges may apply and not all changes are possible'; |
  | 387 |  | } |
  | 388 |  |  |
  | 389 |  | case '136': |
  | 390 |  | case '137': |
  | 391 |  | @$wpdb->query("ALTER TABLE `{$wpdb->prefix}moo\_category` ADD `description` TEXT NULL"); |
  | 392 |  | @$wpdb->query("ALTER TABLE `{$wpdb->prefix}moo\_category` ADD `custom\_hours` VARCHAR(100) NULL"); |
  | 393 |  | @$wpdb->query("ALTER TABLE `{$wpdb->prefix}moo\_category` ADD `time\_availability` VARCHAR(10) NULL"); |
  | 394 |  | @$wpdb->query("ALTER TABLE `{$wpdb->prefix}moo\_item` CHANGE `description` `description` TEXT "); |
  | 395 |  | @$wpdb->query("ALTER TABLE `{$wpdb->prefix}moo\_order\_types` ADD `minAmount` VARCHAR(100) NULL DEFAULT '0' "); |
  | 396 |  | @$wpdb->query("ALTER TABLE `{$wpdb->prefix}moo\_order\_types` ADD `custom\_hours` VARCHAR(100) NULL"); |
  | 397 |  | @$wpdb->query("ALTER TABLE `{$wpdb->prefix}moo\_order\_types` ADD `time\_availability` VARCHAR(10) DEFAULT 1"); |
  | 398 |  | @$wpdb->query("ALTER TABLE `{$wpdb->prefix}moo\_order\_types` ADD `use\_coupons` INT(1) NULL DEFAULT 1"); |
  | 399 |  | @$wpdb->query("ALTER TABLE `{$wpdb->prefix}moo\_order\_types` ADD `custom\_message` VARCHAR(255) NULL DEFAULT 'Not available yet'"); |
  | 400 |  | case '138': |
  | 401 |  | case '139': |
  | 402 |  | @$wpdb->query("ALTER TABLE `{$wpdb->prefix}moo\_order\_types` ADD `allow\_sc\_order` INT(1) NULL DEFAULT 1 "); |
  | 403 |  | @$wpdb->query("ALTER TABLE `{$wpdb->prefix}moo\_order\_types` ADD `maxAmount` VARCHAR(100) NULL DEFAULT '' "); |
  | 404 |  | $defaultOptions["mg\_settings\_minimized"] = "off"; |
  | 405 |  | $defaultOptions["scp"] = "off"; |
  | 406 |  | $defaultOptions["tips\_selection"] = "10,15,20,25"; |
  | 407 |  | $defaultOptions["tips\_default"] = ""; |
  | 408 |  | $defaultOptions["rollout\_order\_number"] = "on"; |
  | 409 |  | $defaultOptions["rollout\_order\_number\_max"] = "999"; |
  | 410 |  | $defaultOptions["thanks\_page\_wp"] = ""; |
  | 411 |  | case '140': |
  | 412 |  | case '141': |
  | 413 |  | case '142': |
  | 414 |  | case '143': |
  | 415 |  | case '144': |
  | 416 |  | set\_transient('moo\_blackout', false, 1); |
  | 417 |  | if (!isset($defaultOptions["delivery\_errorMsg"]) || $defaultOptions["delivery\_errorMsg"] == "") { |
  | 418 |  | $defaultOptions["delivery\_errorMsg"] = "Sorry, zone not supported. We do not deliver to this address at this time"; |
  | 419 |  | } |
  | 420 |  | $defaultOptions["special\_instructions\_required"] = "no"; |
  | 421 |  | case '145': |
  | 422 |  | case '146': |
  | 423 |  | case '147': |
  | 424 |  | case '148': |
  | 425 |  | case '149': |
  | 426 |  | if (isset($defaultOptions["payment\_creditcard"]) &&  $defaultOptions["payment\_creditcard"] === "on") { |
  | 427 |  | $defaultOptions["payment\_creditcard"] = "off"; |
  | 428 |  | $defaultOptions["clover\_payment\_form"] = "on"; |
  | 429 |  | } |
  | 430 |  | case '150': |
  | 431 |  | @$wpdb->query("ALTER TABLE `{$wpdb->prefix}moo\_order\_types` ADD `allow\_service\_fee` INT(1) NULL DEFAULT 1"); |
  | 432 |  | @$wpdb->query("ALTER TABLE `{$wpdb->prefix}moo\_item` ADD `category\_uuid` VARCHAR(45) NULL"); |
  | 433 |  | @$wpdb->query("ALTER TABLE `{$wpdb->prefix}moo\_item` ADD `custom\_hours` VARCHAR(45) NULL"); |
  | 434 |  | @$wpdb->query("ALTER TABLE `{$wpdb->prefix}moo\_item` ADD `soo\_name` VARCHAR(255) NULL after name"); |
  | 435 |  | @$wpdb->query("ALTER TABLE `{$wpdb->prefix}moo\_item` ADD `available` INT(1) NULL DEFAULT 1 after visible"); |
  | 436 |  | update\_option("moo\_settings", $defaultOptions); |
  | 437 |  | case '151': |
  | 438 |  | case '152': |
  | 439 |  | case '153': |
  | 440 |  | case '154': |
  | 441 |  | @$wpdb->query("ALTER TABLE `{$wpdb->prefix}moo\_item` ADD `featured` INT(1) NULL DEFAULT 0 after available"); |
  | 442 |  | case '155': |
  | 443 |  | case '156': |
  | 444 |  | @$wpdb->query("ALTER TABLE `{$wpdb->prefix}moo\_modifier` ADD `is\_pre\_selected` INT(1) NULL DEFAULT 0"); |
  | 445 |  | case '157': |
  | 446 |  | // Get current charset |
  | 447 |  | $itemTableCharset = Moo\_OnlineOrders\_Helpers::getCharsetOfDbTable("moo\_item"); |
  | 448 |  | $itemUuidColumnCollate = Moo\_OnlineOrders\_Helpers::getCharsetOfDbColumn("moo\_item","uuid"); |
  | 449 |  |  |
  | 450 |  | // Add new fields to tax rate |
  | 451 |  | @$wpdb->query("ALTER TABLE `{$wpdb->prefix}moo\_tax\_rate` ADD `taxAmount` INT NULL"); |
  | 452 |  | @$wpdb->query("ALTER TABLE `{$wpdb->prefix}moo\_tax\_rate` ADD `taxType` VARCHAR(100) NULL"); |
  | 453 |  |  |
  | 454 |  | //Add a flag to the category table |
  | 455 |  | @$wpdb->query("ALTER TABLE `{$wpdb->prefix}moo\_category` ADD `items\_imported` INT(1) NOT NULL DEFAULT 0"); |
  | 456 |  |  |
  | 457 |  | //Create a new table for items\_categories (many to many) |
  | 458 |  | @$wpdb->query("CREATE TABLE IF NOT EXISTS `{$wpdb->prefix}moo\_items\_categories` ( |
  | 459 |  | `item\_uuid` VARCHAR(45) NOT NULL, |
  | 460 |  | `category\_uuid` VARCHAR(100) NOT NULL, |
  | 461 |  | `sort\_order` INT NULL, |
  | 462 |  | PRIMARY KEY (`item\_uuid`, `category\_uuid`), |
  | 463 |  | INDEX `idx\_item\_has\_categories` (`item\_uuid` ASC) , |
  | 464 |  | INDEX `idx\_category\_has\_items` (`category\_uuid` ASC)  , |
  | 465 |  | CONSTRAINT `{$wpdb->prefix}fk\_item\_has\_categories` |
  | 466 |  | FOREIGN KEY (`item\_uuid`) |
  | 467 |  | REFERENCES `{$wpdb->prefix}moo\_item` (`uuid`) |
  | 468 |  | ON DELETE CASCADE |
  | 469 |  | ON UPDATE CASCADE, |
  | 470 |  | CONSTRAINT `{$wpdb->prefix}fk\_category\_has\_items` |
  | 471 |  | FOREIGN KEY (`category\_uuid`) |
  | 472 |  | REFERENCES `{$wpdb->prefix}moo\_category` (`uuid`) |
  | 473 |  | ON DELETE CASCADE |
  | 474 |  | ON UPDATE CASCADE, |
  | 475 |  | UNIQUE(`item\_uuid`,`category\_uuid`)) DEFAULT CHARACTER SET $itemTableCharset COLLATE $itemUuidColumnCollate"); |
  | 476 |  | update\_option('moo\_onlineOrders\_version', '157'); |
  | 477 |  | break; |
  | 478 |  | } |
  |  | 250 | Moo\_OnlineOrders\_Helpers::applyDefaultOptions($defaultOptions); |
  |  | 251 | update\_option("moo\_settings", $defaultOptions); |
  |  | 252 | //Upgrade version |
  |  | 253 | update\_option('moo\_onlineOrders\_version', '158'); |
  | 479 | 254 | } |
  | 480 | 255 |  |
* ## [clover-online-orders/trunk/public/css/dist/icheck-blue.min.css](/changeset/3168433/clover-online-orders/trunk/public/css/dist/icheck-blue.min.css "Show the changeset 3168433 restricted to clover-online-orders/trunk/public/css/dist/icheck-blue.min.css")

  | [r2936448](/browser/clover-online-orders/trunk/public/css/dist/icheck-blue.min.css?rev=2936448#L1 "Show revision 2936448 of this file in browser") | [r3168433](/browser/clover-online-orders/trunk/public/css/dist/icheck-blue.min.css?rev=3168433#L1 "Show revision 3168433 of this file in browser") |  |
  | --- | --- | --- |
  | 1 |  | .icheckbox\_square-blue,.iradio\_square-blue{display:inline-block;vertical-align:middle;margin:0;padding:0;width:22px;height:22px;background:url(blue~~.png) no-repeat;border:none;cursor:pointer;margin-left:25px}.icheckbox\_square-blue{background-position:0 0}.icheckbox\_square-blue.hover{background-position:-24px 0}.icheckbox\_square-blue.checked{background-position:-48px 0}.icheckbox\_square-blue.disabled{background-position:-72px 0;cursor:default}.icheckbox\_square-blue.checked.disabled{background-position:-96px 0}.iradio\_square-blue{background-position:-120px 0}.iradio\_square-blue.hover{background-position:-144px 0}.iradio\_square-blue.checked{background-position:-168px 0}.iradio\_square-blue.disabled{background-position:-192px 0;cursor:default}.iradio\_square-blue.checked.disabled{background-position:-216px 0}@media (-o-min-device-pixel-ratio:5/4),(-webkit-min-device-pixel-ratio:1.25),(min-resolution:120dpi),(min-resolution:1.25dppx){.icheckbox\_square-blue,.iradio\_square-blue{background-image:url(blue@2x~~.png);-webkit-background-size:240px 24px;background-size:240px 24px}} |
  |  | 1 | .icheckbox\_square-blue,.iradio\_square-blue{display:inline-block;vertical-align:middle;margin:0;padding:0;width:22px;height:22px;background:url(blueX2.png) no-repeat;border:none;cursor:pointer;margin-left:25px}.icheckbox\_square-blue{background-position:0 0}.icheckbox\_square-blue.hover{background-position:-24px 0}.icheckbox\_square-blue.checked{background-position:-48px 0}.icheckbox\_square-blue.disabled{background-position:-72px 0;cursor:default}.icheckbox\_square-blue.checked.disabled{background-position:-96px 0}.iradio\_square-blue{background-position:-120px 0}.iradio\_square-blue.hover{background-position:-144px 0}.iradio\_square-blue.checked{background-position:-168px 0}.iradio\_square-blue.disabled{background-position:-192px 0;cursor:default}.iradio\_square-blue.checked.disabled{background-position:-216px 0}@media (-o-min-device-pixel-ratio:5/4),(-webkit-min-device-pixel-ratio:1.25),(min-resolution:120dpi),(min-resolution:1.25dppx){.icheckbox\_square-blue,.iradio\_square-blue{background-image:url(blue.png);-webkit-background-size:240px 24px;background-size:240px 24px}} |
* ## [clover-online-orders/trunk/public/css/dist/sooCheckout-light.min.css](/changeset/3168433/clover-online-orders/trunk/public/css/dist/sooCheckout-light.min.css "Show the changeset 3168433 restricted to clover-online-orders/trunk/public/css/dist/sooCheckout-light.min.css")

  | [r3038387](/browser/clover-online-orders/trunk/public/css/dist/sooCheckout-light.min.css?rev=3038387#L1 "Show revision 3038387 of this file in browser") | [r3168433](/browser/clover-online-orders/trunk/public/css/dist/sooCheckout-light.min.css?rev=3168433#L1 "Show revision 3168433 of this file in browser") |  |
  | --- | --- | --- |
  | 1 |  | @font-face{font-display:swap;font-family:Soo DM Sans;font-style:normal;font-weight:400;src:url(https://fonts.gstatic.com/s/dmsans/v11/rP2Hp2ywxg089UriOZQ.ttf) format("truetype")}@font-face{font-display:swap;font-family:Soo DM Sans;font-style:normal;font-weight:500;src:url(https://fonts.gstatic.com/s/dmsans/v11/rP2Cp2ywxg089UriAWCrOB8.ttf) format("truetype")}@font-face{font-display:swap;font-family:Soo DM Sans;font-style:normal;font-weight:700;src:url(https://fonts.gstatic.com/s/dmsans/v11/rP2Cp2ywxg089UriASitOB8.ttf) format("truetype")}#moo\_CheckoutContainer,.moo\_CheckoutContainer{color:#000;font-size:14px;line-height:25px;margin:0 auto 60px;max-width:1200px;text-align:left}#moo\_CheckoutContainer .moo-error-section,.moo\_CheckoutContainer .moo-error-section{color:red}#moo\_CheckoutContainer .moo-has-error,#moo\_CheckoutContainer .moo-has-error>input,.moo\_CheckoutContainer .moo-has-error,.moo\_CheckoutContainer .moo-has-error>input{border-color:red!important;color:red!important}#moo\_CheckoutContainer #moo-checkout-form,#moo\_CheckoutContainer #moo-forgotpassword-section,#moo\_CheckoutContainer #moo-signing-section,#moo\_CheckoutContainer .moo-error-section,.moo\_CheckoutContainer #moo-checkout-form,.moo\_CheckoutContainer #moo-forgotpassword-section,.moo\_CheckoutContainer #moo-signing-section,.moo\_CheckoutContainer .moo-error-section{display:none}#moo\_CheckoutContainer .sooCheckoutTextInput,.moo\_CheckoutContainer .sooCheckoutTextInput{background:#fff none;border:.7px solid #b8b8b8;border-radius:3px;display:block;font-size:14px;height:39px;padding-left:5px;width:100%}#moo\_CheckoutContainer .sooCheckoutTextInput:focus,.moo\_CheckoutContainer .sooCheckoutTextInput:focus{border-color:#1565d8;box-shadow:none;outline:none}#moo\_CheckoutContainer .sooCheckoutTextInput[disabled],.moo\_CheckoutContainer .sooCheckoutTextInput[disabled]{background:#ececec none;border-color:#ececec;box-shadow:none}#moo\_CheckoutContainer .sooCheckoutPrimaryButtonInput,.moo\_CheckoutContainer .sooCheckoutPrimaryButtonInput{background:linear-gradient(0deg,#004fac,#004fac),linear-gradient(0deg,#cdcdcd,#cdcdcd);border:1px solid #004fac;border-radius:5px;color:#fff;cursor:pointer;font-family:Soo DM Sans,sans-serif;font-size:16px;font-weight:400;height:40px;letter-spacing:0;line-height:18px;margin-top:15px;min-height:40px;padding:10px 20px;text-align:center}#moo\_CheckoutContainer .sooCheckoutSecondaryButtonInput,.moo\_CheckoutContainer .sooCheckoutSecondaryButtonInput{background:#fff;border:1px solid #004fac;border-radius:5px;color:#004fac;cursor:pointer;font-family:Soo DM Sans,sans-serif;font-size:16px;font-weight:500;height:40px;letter-spacing:0;line-height:18px;margin-top:15px;padding:10px 20px;text-align:center}#moo\_CheckoutContainer .sooCheckoutPrimaryButtonInput:focus,#moo\_CheckoutContainer .sooCheckoutSecondaryButtonInput:focus,.moo\_CheckoutContainer .sooCheckoutPrimaryButtonInput:focus,.moo\_CheckoutContainer .sooCheckoutSecondaryButtonInput:focus{outline:none}#moo\_CheckoutContainer .soo-text-right,.moo\_CheckoutContainer .soo-text-right{text-align:right}#moo\_CheckoutContainer .soo-margin-bottom-10,.moo\_CheckoutContainer .soo-margin-bottom-10{margin-bottom:10px}#moo\_CheckoutContainer .sooBorderedArea,.moo\_CheckoutContainer .sooBorderedArea{background-color:#fff;border:.7px solid #b8b8b8;border-radius:10px;padding:25px}#moo\_CheckoutContainer #moo-checkout-form,.moo\_CheckoutContainer #moo-checkout-form{overflow:hidden}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside{background-color:#fff;border:.7px solid #b8b8b8;border-radius:10px;margin-bottom:10px;padding-bottom:15px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-customer,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-customer{min-height:130px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-customer #moo-checkout-contact-content,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-customer #moo-checkout-contact-content{display:none}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-customer #moo-checkout-contact-content .soo-contact-info,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-customer #moo-checkout-contact-content .soo-contact-info{border:.7px solid #b8b8b8;border-radius:10px;margin:8px;padding:10px 5px 5px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-customer #moo-checkout-contact-content .soo-contact-info .soo-contact-info-name,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-customer #moo-checkout-contact-content .soo-contact-info .soo-contact-info-name{color:#000;font-family:Soo DM Sans,sans-serif;font-size:16px;font-style:normal;font-weight:500;line-height:21px;padding-bottom:5px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-customer #moo-checkout-contact-content .soo-contact-info .soo-contact-info-email,#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-customer #moo-checkout-contact-content .soo-contact-info .soo-contact-info-phone,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-customer #moo-checkout-contact-content .soo-contact-info .soo-contact-info-email,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-customer #moo-checkout-contact-content .soo-contact-info .soo-contact-info-phone{color:#727272;font-family:Soo DM Sans,sans-serif;font-size:14px;font-style:normal;font-weight:400;line-height:18px;padding-bottom:5px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-customer #moo-checkout-contact-content .soo-contact-info .soo-contact-edit,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-customer #moo-checkout-contact-content .soo-contact-info .soo-contact-edit{color:#0e84e5;cursor:pointer;font-family:Soo DM Sans,sans-serif;font-size:14px;font-style:normal;font-weight:400;line-height:18px;padding-top:5px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-customer #moo-checkout-contact-content .soo-contact-info .soo-contact-logout,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-customer #moo-checkout-contact-content .soo-contact-info .soo-contact-logout{color:#0e84e5;cursor:pointer;font-family:Soo DM Sans,sans-serif;font-size:14px;font-style:normal;font-weight:400;line-height:18px;padding:5px;text-align:right}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-customer #moo-checkout-contact-form,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-customer #moo-checkout-contact-form{color:#000;display:none}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-customer #moo-checkout-contact-form .soo-contact-loginButtonContainer,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-customer #moo-checkout-contact-form .soo-contact-loginButtonContainer{margin-bottom:20px;margin-top:-40px;text-align:right}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-customer #moo-checkout-contact-form .soo-contact-login,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-customer #moo-checkout-contact-form .soo-contact-login{color:#004fac;cursor:pointer}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-customer .moo-form-group,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-customer .moo-form-group{margin-bottom:10px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes,#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments{margin-top:10px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .moo-checkout-radio-input-option,#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments .moo-checkout-radio-input-option,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .moo-checkout-radio-input-option,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments .moo-checkout-radio-input-option{padding-left:15px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .moo-checkout-radio-input,#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments .moo-checkout-radio-input,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .moo-checkout-radio-input,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments .moo-checkout-radio-input{background-color:#fff;height:25px;margin-top:8px;vertical-align:bottom;width:25px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .moo-checkout-radio-input:focus,#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments .moo-checkout-radio-input:focus,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .moo-checkout-radio-input:focus,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments .moo-checkout-radio-input:focus{outline:none}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .moo-checkout-radio-input-label,#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments .moo-checkout-radio-input-label,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .moo-checkout-radio-input-label,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments .moo-checkout-radio-input-label{color:#000;cursor:pointer;display:inline;font-family:Soo DM Sans,sans-serif;font-size:17px;font-weight:400;letter-spacing:0;line-height:20px;padding-left:7px;text-align:left;vertical-align:middle}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-checkout-radio-input-option,#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments .soo-checkout-radio-input-option,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-checkout-radio-input-option,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments .soo-checkout-radio-input-option{padding-left:15px;padding-top:7px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-checkout-radio-input,#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments .soo-checkout-radio-input,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-checkout-radio-input,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments .soo-checkout-radio-input{-webkit-appearance:none;appearance:none;background:#fff no-repeat 50%;border:1px solid #000;border-radius:50%;height:26px;margin:calc(.75em - 11px) .25rem 0 0;padding:0;vertical-align:top;width:26px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-checkout-radio-input:focus,#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments .soo-checkout-radio-input:focus,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-checkout-radio-input:focus,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments .soo-checkout-radio-input:focus{border-color:#ddd;outline:none}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-checkout-radio-input:disabled,#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments .soo-checkout-radio-input:disabled,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-checkout-radio-input:disabled,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments .soo-checkout-radio-input:disabled{background:#eee}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-checkout-radio-input:checked,#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments .soo-checkout-radio-input:checked,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-checkout-radio-input:checked,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments .soo-checkout-radio-input:checked{background-image:url(radio.svg);border:2px solid #004fac}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-add-delivery-address-form,#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-add-delivery-address-form,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses{display:none}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-add-delivery-address-form,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-add-delivery-address-form{border:.7px solid #b8b8b8;border-radius:10px;margin-top:15px;padding:20px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-add-delivery-address-form .sooCheckoutPrimaryButtonInput,#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-add-delivery-address-form .sooCheckoutSecondaryButtonInput,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-add-delivery-address-form .sooCheckoutPrimaryButtonInput,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-add-delivery-address-form .sooCheckoutSecondaryButtonInput{width:100px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses{border:.7px solid #b8b8b8;border-radius:10px;margin-top:15px;padding:20px 20px 10px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses .soo-addresses-wrapper,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses .soo-addresses-wrapper{position:relative}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses .soo-addresses-wrapper .soo-estimate-loader,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses .soo-addresses-wrapper .soo-estimate-loader{background-color:#fff;display:none;height:100%;opacity:0;position:absolute;width:100%}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses .soo-addresses-wrapper .soo-addresses-title,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses .soo-addresses-wrapper .soo-addresses-title{color:#000;font-weight:600;padding-bottom:8px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses .soo-addresses-wrapper .soo-one-address,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses .soo-addresses-wrapper .soo-one-address{border:.7px solid #b8b8b8;border-radius:5px;color:#727272;cursor:pointer;font-family:Soo DM Sans,sans-serif;font-size:14px;font-style:normal;font-weight:400;line-height:18px;margin-bottom:5px;padding:15px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses .soo-addresses-wrapper .soo-one-address .soo-one-address-name,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses .soo-addresses-wrapper .soo-one-address .soo-one-address-name{color:#000;font-weight:500}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses .soo-addresses-wrapper .soo-one-address .soo-one-address-line1,#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses .soo-addresses-wrapper .soo-one-address .soo-one-address-line2,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses .soo-addresses-wrapper .soo-one-address .soo-one-address-line1,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses .soo-addresses-wrapper .soo-one-address .soo-one-address-line2{width:90%}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses .soo-addresses-wrapper .soo-one-address .soo-address-error,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses .soo-addresses-wrapper .soo-one-address .soo-address-error{color:red;font-weight:500;margin-top:10px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses .soo-addresses-wrapper .soo-one-address .soo-delivery-amount,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses .soo-addresses-wrapper .soo-one-address .soo-delivery-amount{color:#004fac;font-weight:500;height:0;position:relative;text-align:right;top:-38px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses .soo-addresses-wrapper .soo-one-address .soo-delivery-amount>svg,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses .soo-addresses-wrapper .soo-one-address .soo-delivery-amount>svg{fill:#004fac;animation:sooAnmRotate .6s linear infinite}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses .soo-addresses-wrapper .soo-selected,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses .soo-addresses-wrapper .soo-selected{background:#f0f5fc;border:.7px solid #1565d887}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses .soo-addresses-wrapper .soo-selected-warning,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses .soo-addresses-wrapper .soo-selected-warning{background-color:#ffc!important;border:.7px solid #ccc;color:#000!important}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses .soo-addresses-wrapper .soo-selected-error,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses .soo-addresses-wrapper .soo-selected-error{background-color:#fdd!important;border:.7px solid #ccc;color:#000!important}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses .soo-add-new-address-button,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses .soo-add-new-address-button{color:#004fac;font-family:Soo DM Sans,sans-serif;font-size:14px;font-style:normal;font-weight:400;line-height:18px;padding-top:20px;text-align:right}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses .soo-add-new-address-button>span,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses .soo-add-new-address-button>span{cursor:pointer}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-orderdate,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-orderdate{margin-top:10px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments .clover-error,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments .clover-error{color:red}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments #moo-cloverCreditCardPanel,#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments #moo-cloverGiftCardPanel,#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments #mooGooglePaySection,#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments #moo\_cashPanel,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments #moo-cloverCreditCardPanel,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments #moo-cloverGiftCardPanel,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments #mooGooglePaySection,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments #moo\_cashPanel{border:.7px solid #b8b8b8;border-radius:10px;display:none;margin-top:15px;padding:20px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments #moo-cloverCreditCardPanel,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments #moo-cloverCreditCardPanel{padding-bottom:10px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments #moo-cloverCreditCardPanel #moo\_CloverCardCvv,#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments #moo-cloverCreditCardPanel #moo\_CloverCardDate,#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments #moo-cloverCreditCardPanel #moo\_CloverCardNumber,#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments #moo-cloverCreditCardPanel #moo\_CloverCardZip,#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments #moo-cloverCreditCardPanel #moo\_CloverStreetAddress,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments #moo-cloverCreditCardPanel #moo\_CloverCardCvv,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments #moo-cloverCreditCardPanel #moo\_CloverCardDate,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments #moo-cloverCreditCardPanel #moo\_CloverCardNumber,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments #moo-cloverCreditCardPanel #moo\_CloverCardZip,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments #moo-cloverCreditCardPanel #moo\_CloverStreetAddress{border-radius:5px;height:45px;margin-bottom:10px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments #moo-cloverGiftCardPanel,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments #moo-cloverGiftCardPanel{border:none;padding:0}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments #moo-cloverGiftCardPanel #moo\_CloverGiftCard,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments #moo-cloverGiftCardPanel #moo\_CloverGiftCard{min-height:100px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments #moo\_cashPanel .soo-phone-verif-title,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments #moo\_cashPanel .soo-phone-verif-title{color:#000;margin-bottom:10px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments #moo\_cashPanel .soo-phone-input,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments #moo\_cashPanel .soo-phone-input{display:none}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments #moo\_cashPanel .soo-phone-input>input,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments #moo\_cashPanel .soo-phone-input>input{float:left;width:70%}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments #moo\_cashPanel .soo-phone-input>button,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments #moo\_cashPanel .soo-phone-input>button{clear:both;margin:0 0 0 10px;width:25%}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments #moo\_cashPanel .soo-phone-button,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments #moo\_cashPanel .soo-phone-button{text-align:center}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments #moo\_cashPanel .soo-phone-button>button,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments #moo\_cashPanel .soo-phone-button>button{width:70%}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-coupon,#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-instruction,#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-tips,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-coupon,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-instruction,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-tips{margin-top:10px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-coupon div.moo-checkout-bloc-content>div>div.moo-col-xs-3,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-coupon div.moo-checkout-bloc-content>div>div.moo-col-xs-3{padding:0 10px 0 0}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-coupon div.moo-checkout-bloc-content>div>div>div>button,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-coupon div.moo-checkout-bloc-content>div>div>div>button{margin:0;padding:10px 12px;width:100%}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-coupon div>button.sooDeleteCouponButton.sooCheckoutPrimaryButtonInput,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-coupon div>button.sooDeleteCouponButton.sooCheckoutPrimaryButtonInput{display:none;width:100%}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty{margin-top:10px;min-height:135px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty>div.moo-checkout-bloc-content,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty>div.moo-checkout-bloc-content{margin-top:23px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .sooRemovePointsButton,#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .usePointsInput,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .sooRemovePointsButton,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .usePointsInput{display:none}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .usePointsInput,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .usePointsInput{margin-top:30px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .usePointsInput .moo-error-section,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .usePointsInput .moo-error-section{margin-top:7px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .usePointsInput .sooToPayInfo,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .usePointsInput .sooToPayInfo{margin-top:8px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .usePointsInput .sooValidatePoints,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .usePointsInput .sooValidatePoints{padding:0}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .usePointsInput .sooValidatePoints .sooEditPointsButton,#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .usePointsInput .sooValidatePoints .sooValidatePointsButton,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .usePointsInput .sooValidatePoints .sooEditPointsButton,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .usePointsInput .sooValidatePoints .sooValidatePointsButton{font-size:16px;line-height:16px;margin:0;min-height:15px;padding:10px;width:70%}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .usePointsInput .sooValidatePoints .sooEditPointsButton,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .usePointsInput .sooValidatePoints .sooEditPointsButton{display:none}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .usePointsInput .sooValidatePoints .sooLoyaltyDetailsButton svg,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .usePointsInput .sooValidatePoints .sooLoyaltyDetailsButton svg{cursor:pointer;height:30px;vertical-align:middle;width:30px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .usePointsInput #sooSelectedPointsValue,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .usePointsInput #sooSelectedPointsValue{padding-left:10px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .loyaltyIcon>img,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .loyaltyIcon>img{width:50px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .loyaltyButtons,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .loyaltyButtons{padding:0 10px 0 0;text-align:right}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .loyaltyButtons .sooRemovePointsButton,#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .loyaltyButtons .sooUsePointsButton,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .loyaltyButtons .sooRemovePointsButton,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .loyaltyButtons .sooUsePointsButton{font-weight:400;margin:0;padding:10px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .loyaltyButtons .sooRemovePointsButton,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .loyaltyButtons .sooRemovePointsButton{font-size:13px;padding:7px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .loyaltyBalance,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .loyaltyBalance{padding:0}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .loyaltyBalance .balance,#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .loyaltyBalance .balanceTitle,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .loyaltyBalance .balance,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .loyaltyBalance .balanceTitle{color:rgba(0,0,0,.63);font-family:Soo DM Sans,sans-serif;font-size:14px;font-weight:400;letter-spacing:0;line-height:18px;text-align:left}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .loyaltyBalance .balance,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .loyaltyBalance .balance{color:#000}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .loyaltyBalance .balance>.balancePoints,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .loyaltyBalance .balance>.balancePoints{font-size:18px;font-weight:500;line-height:23px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .loyaltyBalance .loyaltyButtons,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .loyaltyBalance .loyaltyButtons{font-weight:400;text-align:right}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside .moo-checkout-bloc-title,#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside .moo-checkout-bloc-title>label,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside .moo-checkout-bloc-title,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside .moo-checkout-bloc-title>label{color:#000;font-family:Soo DM Sans,sans-serif;font-size:18px;font-style:normal;font-weight:500;line-height:30px;margin-bottom:10px;margin-top:10px;text-transform:none}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside .moo\_checkout\_border\_bottom,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside .moo\_checkout\_border\_bottom{border-bottom:1px solid #eee;margin-left:-15px;margin-right:-15px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-cart,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-cart{background-color:#fff;border:.7px solid #b8b8b8;border-radius:10px;color:#000;font-family:Soo DM Sans,sans-serif;font-size:15px;padding:0}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-cart .moo-shopping-cart-title,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-cart .moo-shopping-cart-title{border-bottom:.7px solid #b8b8b8;color:#000;font-family:Soo DM Sans,sans-serif;font-size:18px;font-style:normal;font-weight:500;line-height:30px;padding:13px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-cart .moo-shopping-cart-line,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-cart .moo-shopping-cart-line{margin-bottom:5px;margin-top:5px;padding-left:10px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-cart .moo-shopping-cart-line .moo-scl-qty,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-cart .moo-shopping-cart-line .moo-scl-qty{text-align:center}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-cart .moo-shopping-cart-line .moo-scl-item,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-cart .moo-shopping-cart-line .moo-scl-item{padding:0}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-cart .moo-shopping-cart-line .moo-scl-item .moo-scl-itemName,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-cart .moo-shopping-cart-line .moo-scl-item .moo-scl-itemName{font-family:Soo DM Sans,sans-serif;font-size:16px;font-weight:400;letter-spacing:0;line-height:20px;margin-top:3px;text-align:left}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-cart .moo-shopping-cart-line .moo-scl-item .moo-scl-itemModifiers,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-cart .moo-shopping-cart-line .moo-scl-item .moo-scl-itemModifiers{font-family:Soo DM Sans,sans-serif;font-size:15px;font-weight:400;letter-spacing:0;line-height:16px;text-align:left}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-cart .moo-shopping-cart-line .moo-scl-itemPrice,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-cart .moo-shopping-cart-line .moo-scl-itemPrice{padding-left:0;padding-right:20px;text-align:right}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-cart .moo-totals,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-cart .moo-totals{border-top:.7px solid #b8b8b8;color:#000;font-family:Soo DM Sans,sans-serif;font-size:13px;font-weight:400;letter-spacing:0;overflow:auto;padding:10px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-cart .moo-totals .moo-totals-item,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-cart .moo-totals .moo-totals-item{clear:both;float:right;margin-bottom:0;width:100%}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-cart .moo-totals .moo-totals-item .moo-totals-value,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-cart .moo-totals .moo-totals-item .moo-totals-value{float:right;text-align:right;width:30%}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-cart .moo-totals .moo-totals-item label,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-cart .moo-totals .moo-totals-item label{clear:both;float:left;text-align:right;width:70%}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-cart .moo-totals #sooCouponTotalSection,#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-cart .moo-totals #sooDeliveryFeeTotalSection,#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-cart .moo-totals #sooPointsTotalSection,#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-cart .moo-totals #sooServiceFeeTotalSection,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-cart .moo-totals #sooCouponTotalSection,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-cart .moo-totals #sooDeliveryFeeTotalSection,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-cart .moo-totals #sooPointsTotalSection,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-cart .moo-totals #sooServiceFeeTotalSection{display:none}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-links a,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-links a{color:#004fac;font-size:12px;text-align:center;text-decoration:none}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-links a:visited,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-links a:visited{color:#004fac}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-links a:focus,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-links a:focus{outline:none}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-links .moo-checkoutText-updateCart,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-links .moo-checkoutText-updateCart{float:left}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-links .moo-checkoutText-continueShopping,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-links .moo-checkoutText-continueShopping{float:right}#moo\_CheckoutContainer #moo-checkout-form #moo-checkout-form-btnActions #moo-cloverGooglePay,.moo\_CheckoutContainer #moo-checkout-form #moo-checkout-form-btnActions #moo-cloverGooglePay{display:none;height:45px;min-width:90px}#moo\_CheckoutContainer #moo-checkout-form #moo-checkout-form-btnActions .moo-finalize-order-btn,.moo\_CheckoutContainer #moo-checkout-form #moo-checkout-form-btnActions .moo-finalize-order-btn{width:100%}#moo\_CheckoutContainer #moo-checkout-form .soo-sticky-cart,.moo\_CheckoutContainer #moo-checkout-form .soo-sticky-cart{position:sticky;top:0}#moo\_CheckoutContainer .moo-edit-profile-form,.moo\_CheckoutContainer .moo-edit-profile-form{text-align:left}#moo\_CheckoutContainer .moo-edit-profile-form>div,.moo\_CheckoutContainer .moo-edit-profile-form>div{margin-bottom:10px}#moo\_CheckoutContainer .dot-flashing-2,.moo\_CheckoutContainer .dot-flashing-2{--\_g:no-repeat radial-gradient(circle closest-side,#000 90%,#0000);animation:sooDotFlashing2 1s linear infinite;aspect-ratio:2;background:var(--\_g) 0 50%,var(--\_g) 50% 50%,var(--\_g) 100% 50%;background-size:33.33333% 50%;margin:0 auto;width:60px}#moo\_CheckoutContainer .dot-flashing,.moo\_CheckoutContainer .dot-flashing{animation:sooDotFlashing .8s linear infinite alternate;animation-delay:.3s;background-color:#fff;border-radius:2.8px;color:#fff;height:6px;margin:0 auto;position:relative;width:6px}#moo\_CheckoutContainer .dot-flashing:after,#moo\_CheckoutContainer .dot-flashing:before,.moo\_CheckoutContainer .dot-flashing:after,.moo\_CheckoutContainer .dot-flashing:before{content:"";display:inline-block;position:absolute;top:0}#moo\_CheckoutContainer .dot-flashing:before,.moo\_CheckoutContainer .dot-flashing:before{animation:sooDotFlashing .8s infinite alternate;animation-delay:0s;background-color:#fff;border-radius:2.8px;color:#fff;height:6px;left:-15px;width:6px}#moo\_CheckoutContainer .dot-flashing:after,.moo\_CheckoutContainer .dot-flashing:after{animation:sooDotFlashing .8s infinite alternate;animation-delay:.8s;background-color:#fff;border-radius:2.8px;color:#fff;height:6px;left:15px;width:6px}@keyframes sooDotFlashing{0%{background-color:#fff}50%,to{background-color:hsla(0,0%,100%,.4)}}@keyframes sooDotFlashing2{20%{background-position:0 0,50% 50%,100% 50%}40%{background-position:0 100%,50% 0,100% 50%}60%{background-position:0 50%,50% 100%,100% 0}80%{background-position:0 50%,50% 50%,100% 100%}}#moo\_CheckoutContainer form,.moo\_CheckoutContainer form{margin:0}.sooMyOrders{margin-top:60px}.soo-loyalty-conditions{font-family:Soo DM Sans,sans-serif;font-size:16px;overflow:hidden;text-align:left}.soo-loyalty-conditions ul{list-style:none}.swal2-html-container{margin:15px 0 0;overflow-x:hidden}.swal2-container .swal2-center>.swal2-popup{padding:0 25px 25px}.swal2-container .fontSizeLg{font-size:1.2em}.moo-fade-in{animation:fadeIn .5s ease infinite;-webkit-animation:fadeIn .5s ease infinite;-moz-animation:fadeIn .5s ease infinite;-o-animation:fadeIn .5s ease infinite;-ms-animation:fadeIn .5s ease infinite}@keyframes sooAnmRotate{to{transform:rotate(1turn)}}@keyframes fadeIn{0%{opacity:0}to{opacity:1}}@-moz-keyframes fadeIn{0%{opacity:0}to{opacity:1}}@-webkit-keyframes fadeIn{0%{opacity:0}to{opacity:1}}@-o-keyframes fadeIn{0%{opacity:0}to{opacity:1}}@-ms-keyframes fadeIn{0%{opacity:0}to{opacity:1}} |
  |  | 1 | @font-face{font-display:swap;font-family:Soo DM Sans;font-style:normal;font-weight:400;src:url(https://fonts.gstatic.com/s/dmsans/v11/rP2Hp2ywxg089UriOZQ.ttf) format("truetype")}@font-face{font-display:swap;font-family:Soo DM Sans;font-style:normal;font-weight:500;src:url(https://fonts.gstatic.com/s/dmsans/v11/rP2Cp2ywxg089UriAWCrOB8.ttf) format("truetype")}@font-face{font-display:swap;font-family:Soo DM Sans;font-style:normal;font-weight:700;src:url(https://fonts.gstatic.com/s/dmsans/v11/rP2Cp2ywxg089UriASitOB8.ttf) format("truetype")}#moo\_CheckoutContainer,.moo\_CheckoutContainer{color:#000;font-size:14px;line-height:25px;margin:0 auto 60px;max-width:1200px;text-align:left}#moo\_CheckoutContainer .moo-error-section,.moo\_CheckoutContainer .moo-error-section{color:red}#moo\_CheckoutContainer .moo-has-error,#moo\_CheckoutContainer .moo-has-error>input,.moo\_CheckoutContainer .moo-has-error,.moo\_CheckoutContainer .moo-has-error>input{border-color:red!important;color:red!important}#moo\_CheckoutContainer #moo-checkout-form,#moo\_CheckoutContainer #moo-forgotpassword-section,#moo\_CheckoutContainer #moo-signing-section,#moo\_CheckoutContainer .moo-error-section,.moo\_CheckoutContainer #moo-checkout-form,.moo\_CheckoutContainer #moo-forgotpassword-section,.moo\_CheckoutContainer #moo-signing-section,.moo\_CheckoutContainer .moo-error-section{display:none}#moo\_CheckoutContainer .sooCheckoutTextInput,.moo\_CheckoutContainer .sooCheckoutTextInput{background:#fff none;border:.7px solid #b8b8b8;border-radius:3px;display:block;font-size:14px;height:39px;padding-left:5px;width:100%}#moo\_CheckoutContainer .sooCheckoutTextInput:focus,.moo\_CheckoutContainer .sooCheckoutTextInput:focus{border-color:#1565d8;box-shadow:none;outline:none}#moo\_CheckoutContainer .sooCheckoutTextInput[disabled],.moo\_CheckoutContainer .sooCheckoutTextInput[disabled]{background:#ececec none;border-color:#ececec;box-shadow:none}#moo\_CheckoutContainer .sooCheckoutPrimaryButtonInput,.moo\_CheckoutContainer .sooCheckoutPrimaryButtonInput{background:linear-gradient(0deg,#004fac,#004fac),linear-gradient(0deg,#cdcdcd,#cdcdcd);border:1px solid #004fac;border-radius:5px;color:#fff;cursor:pointer;font-family:Soo DM Sans,sans-serif;font-size:16px;font-weight:400;height:40px;letter-spacing:0;line-height:18px;margin-top:15px;min-height:40px;padding:10px 20px;text-align:center}#moo\_CheckoutContainer .sooCheckoutSecondaryButtonInput,.moo\_CheckoutContainer .sooCheckoutSecondaryButtonInput{background:#fff;border:1px solid #004fac;border-radius:5px;color:#004fac;cursor:pointer;font-family:Soo DM Sans,sans-serif;font-size:16px;font-weight:500;height:40px;letter-spacing:0;line-height:18px;margin-top:15px;padding:10px 20px;text-align:center}#moo\_CheckoutContainer .sooCheckoutPrimaryButtonInput:focus,#moo\_CheckoutContainer .sooCheckoutSecondaryButtonInput:focus,.moo\_CheckoutContainer .sooCheckoutPrimaryButtonInput:focus,.moo\_CheckoutContainer .sooCheckoutSecondaryButtonInput:focus{outline:none}#moo\_CheckoutContainer .soo-text-right,.moo\_CheckoutContainer .soo-text-right{text-align:right}#moo\_CheckoutContainer .soo-margin-bottom-10,.moo\_CheckoutContainer .soo-margin-bottom-10{margin-bottom:10px}#moo\_CheckoutContainer .sooBorderedArea,.moo\_CheckoutContainer .sooBorderedArea{background-color:#fff;border:.7px solid #b8b8b8;border-radius:10px;padding:25px}#moo\_CheckoutContainer #moo-checkout-form,.moo\_CheckoutContainer #moo-checkout-form{overflow:hidden}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside{background-color:#fff;border:.7px solid #b8b8b8;border-radius:10px;margin-bottom:10px;padding-bottom:15px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-customer,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-customer{min-height:130px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-customer #moo-checkout-contact-content,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-customer #moo-checkout-contact-content{display:none}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-customer #moo-checkout-contact-content .soo-contact-info,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-customer #moo-checkout-contact-content .soo-contact-info{border:.7px solid #b8b8b8;border-radius:10px;margin:8px;padding:10px 5px 5px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-customer #moo-checkout-contact-content .soo-contact-info .soo-contact-info-name,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-customer #moo-checkout-contact-content .soo-contact-info .soo-contact-info-name{color:#000;font-family:Soo DM Sans,sans-serif;font-size:16px;font-style:normal;font-weight:500;line-height:21px;padding-bottom:5px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-customer #moo-checkout-contact-content .soo-contact-info .soo-contact-info-email,#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-customer #moo-checkout-contact-content .soo-contact-info .soo-contact-info-phone,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-customer #moo-checkout-contact-content .soo-contact-info .soo-contact-info-email,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-customer #moo-checkout-contact-content .soo-contact-info .soo-contact-info-phone{color:#727272;font-family:Soo DM Sans,sans-serif;font-size:14px;font-style:normal;font-weight:400;line-height:18px;padding-bottom:5px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-customer #moo-checkout-contact-content .soo-contact-info .soo-contact-edit,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-customer #moo-checkout-contact-content .soo-contact-info .soo-contact-edit{color:#0e84e5;cursor:pointer;font-family:Soo DM Sans,sans-serif;font-size:14px;font-style:normal;font-weight:400;line-height:18px;padding-top:5px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-customer #moo-checkout-contact-content .soo-contact-info .soo-contact-logout,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-customer #moo-checkout-contact-content .soo-contact-info .soo-contact-logout{color:#0e84e5;cursor:pointer;font-family:Soo DM Sans,sans-serif;font-size:14px;font-style:normal;font-weight:400;line-height:18px;padding:5px;text-align:right}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-customer #moo-checkout-contact-form,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-customer #moo-checkout-contact-form{color:#000;display:none}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-customer #moo-checkout-contact-form .soo-contact-loginButtonContainer,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-customer #moo-checkout-contact-form .soo-contact-loginButtonContainer{margin-bottom:20px;margin-top:-40px;text-align:right}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-customer #moo-checkout-contact-form .soo-contact-login,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-customer #moo-checkout-contact-form .soo-contact-login{color:#004fac;cursor:pointer}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-customer .moo-form-group,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-customer .moo-form-group{margin-bottom:10px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes,#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments{margin-top:10px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .moo-checkout-radio-input-option,#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments .moo-checkout-radio-input-option,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .moo-checkout-radio-input-option,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments .moo-checkout-radio-input-option{padding-left:15px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .moo-checkout-radio-input,#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments .moo-checkout-radio-input,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .moo-checkout-radio-input,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments .moo-checkout-radio-input{background-color:#fff;height:25px;margin-top:8px;vertical-align:bottom;width:25px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .moo-checkout-radio-input:focus,#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments .moo-checkout-radio-input:focus,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .moo-checkout-radio-input:focus,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments .moo-checkout-radio-input:focus{outline:none}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .moo-checkout-radio-input-label,#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments .moo-checkout-radio-input-label,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .moo-checkout-radio-input-label,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments .moo-checkout-radio-input-label{color:#000;cursor:pointer;display:inline;font-family:Soo DM Sans,sans-serif;font-size:17px;font-weight:400;letter-spacing:0;line-height:20px;padding-left:7px;text-align:left;vertical-align:middle}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-checkout-radio-input-option,#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments .soo-checkout-radio-input-option,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-checkout-radio-input-option,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments .soo-checkout-radio-input-option{padding-left:15px;padding-top:7px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-checkout-radio-input,#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments .soo-checkout-radio-input,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-checkout-radio-input,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments .soo-checkout-radio-input{-webkit-appearance:none;appearance:none;background:#fff no-repeat 50%;border:1px solid #000;border-radius:50%;cursor:pointer;height:26px;margin:calc(.75em - 11px) .25rem 0 0;padding:0;vertical-align:top;width:26px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-checkout-radio-input:focus,#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments .soo-checkout-radio-input:focus,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-checkout-radio-input:focus,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments .soo-checkout-radio-input:focus{border-color:#ddd;outline:none}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-checkout-radio-input:disabled,#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments .soo-checkout-radio-input:disabled,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-checkout-radio-input:disabled,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments .soo-checkout-radio-input:disabled{background:#eee}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-checkout-radio-input:checked,#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments .soo-checkout-radio-input:checked,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-checkout-radio-input:checked,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments .soo-checkout-radio-input:checked{background-image:url(radio.svg);border:2px solid #004fac}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-add-delivery-address-form,#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-add-delivery-address-form,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses{display:none}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-add-delivery-address-form,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-add-delivery-address-form{border:.7px solid #b8b8b8;border-radius:10px;margin-top:15px;padding:20px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-add-delivery-address-form .sooCheckoutPrimaryButtonInput,#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-add-delivery-address-form .sooCheckoutSecondaryButtonInput,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-add-delivery-address-form .sooCheckoutPrimaryButtonInput,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-add-delivery-address-form .sooCheckoutSecondaryButtonInput{width:100px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses{border:.7px solid #b8b8b8;border-radius:10px;margin-top:15px;padding:20px 20px 10px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses .soo-addresses-wrapper,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses .soo-addresses-wrapper{position:relative}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses .soo-addresses-wrapper .soo-estimate-loader,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses .soo-addresses-wrapper .soo-estimate-loader{background-color:#fff;display:none;height:100%;opacity:0;position:absolute;width:100%}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses .soo-addresses-wrapper .soo-addresses-title,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses .soo-addresses-wrapper .soo-addresses-title{color:#000;font-weight:600;padding-bottom:8px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses .soo-addresses-wrapper .soo-one-address,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses .soo-addresses-wrapper .soo-one-address{border:.7px solid #b8b8b8;border-radius:5px;color:#727272;cursor:pointer;font-family:Soo DM Sans,sans-serif;font-size:14px;font-style:normal;font-weight:400;line-height:18px;margin-bottom:5px;padding:15px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses .soo-addresses-wrapper .soo-one-address .soo-one-address-name,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses .soo-addresses-wrapper .soo-one-address .soo-one-address-name{color:#000;font-weight:500}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses .soo-addresses-wrapper .soo-one-address .soo-one-address-line1,#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses .soo-addresses-wrapper .soo-one-address .soo-one-address-line2,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses .soo-addresses-wrapper .soo-one-address .soo-one-address-line1,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses .soo-addresses-wrapper .soo-one-address .soo-one-address-line2{width:90%}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses .soo-addresses-wrapper .soo-one-address .soo-address-error,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses .soo-addresses-wrapper .soo-one-address .soo-address-error{color:red;font-weight:500;margin-top:10px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses .soo-addresses-wrapper .soo-one-address .soo-delivery-amount,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses .soo-addresses-wrapper .soo-one-address .soo-delivery-amount{color:#004fac;font-weight:500;height:0;position:relative;text-align:right;top:-38px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses .soo-addresses-wrapper .soo-one-address .soo-delivery-amount>svg,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses .soo-addresses-wrapper .soo-one-address .soo-delivery-amount>svg{fill:#004fac;animation:sooAnmRotate .6s linear infinite}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses .soo-addresses-wrapper .soo-selected,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses .soo-addresses-wrapper .soo-selected{background:#f0f5fc;border:.7px solid #1565d887}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses .soo-addresses-wrapper .soo-selected-warning,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses .soo-addresses-wrapper .soo-selected-warning{background-color:#ffc!important;border:.7px solid #ccc;color:#000!important}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses .soo-addresses-wrapper .soo-selected-error,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses .soo-addresses-wrapper .soo-selected-error{background-color:#fdd!important;border:.7px solid #ccc;color:#000!important}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses .soo-add-new-address-button,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses .soo-add-new-address-button{color:#004fac;font-family:Soo DM Sans,sans-serif;font-size:14px;font-style:normal;font-weight:400;line-height:18px;padding-top:20px;text-align:right}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses .soo-add-new-address-button>span,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses .soo-add-new-address-button>span{cursor:pointer}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-orderdate,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-orderdate{margin-top:10px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments .clover-error,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments .clover-error{color:red}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments #moo-cloverCreditCardPanel,#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments #moo-cloverGiftCardPanel,#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments #mooGooglePaySection,#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments #moo\_cashPanel,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments #moo-cloverCreditCardPanel,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments #moo-cloverGiftCardPanel,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments #mooGooglePaySection,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments #moo\_cashPanel{border:.7px solid #b8b8b8;border-radius:10px;display:none;margin-top:15px;padding:20px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments #moo-cloverCreditCardPanel,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments #moo-cloverCreditCardPanel{padding-bottom:10px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments #moo-cloverCreditCardPanel #moo\_CloverCardCvv,#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments #moo-cloverCreditCardPanel #moo\_CloverCardDate,#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments #moo-cloverCreditCardPanel #moo\_CloverCardNumber,#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments #moo-cloverCreditCardPanel #moo\_CloverCardZip,#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments #moo-cloverCreditCardPanel #moo\_CloverStreetAddress,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments #moo-cloverCreditCardPanel #moo\_CloverCardCvv,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments #moo-cloverCreditCardPanel #moo\_CloverCardDate,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments #moo-cloverCreditCardPanel #moo\_CloverCardNumber,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments #moo-cloverCreditCardPanel #moo\_CloverCardZip,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments #moo-cloverCreditCardPanel #moo\_CloverStreetAddress{border-radius:5px;height:45px;margin-bottom:10px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments #moo-cloverGiftCardPanel,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments #moo-cloverGiftCardPanel{border:none;padding:0}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments #moo-cloverGiftCardPanel #moo\_CloverGiftCard,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments #moo-cloverGiftCardPanel #moo\_CloverGiftCard{min-height:100px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments #moo\_cashPanel .soo-phone-verif-title,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments #moo\_cashPanel .soo-phone-verif-title{color:#000;margin-bottom:10px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments #moo\_cashPanel .soo-phone-input,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments #moo\_cashPanel .soo-phone-input{display:none}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments #moo\_cashPanel .soo-phone-input>input,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments #moo\_cashPanel .soo-phone-input>input{float:left;width:70%}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments #moo\_cashPanel .soo-phone-input>button,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments #moo\_cashPanel .soo-phone-input>button{clear:both;margin:0 0 0 10px;width:25%}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments #moo\_cashPanel .soo-phone-button,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments #moo\_cashPanel .soo-phone-button{text-align:center}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments #moo\_cashPanel .soo-phone-button>button,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-payments #moo\_cashPanel .soo-phone-button>button{width:70%}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-coupon,#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-instruction,#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-tips,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-coupon,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-instruction,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-tips{margin-top:10px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-coupon div.moo-checkout-bloc-content>div>div.moo-col-xs-3,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-coupon div.moo-checkout-bloc-content>div>div.moo-col-xs-3{padding:0 10px 0 0}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-coupon div.moo-checkout-bloc-content>div>div>div>button,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-coupon div.moo-checkout-bloc-content>div>div>div>button{margin:0;padding:10px 12px;width:100%}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-coupon div>button.sooDeleteCouponButton.sooCheckoutPrimaryButtonInput,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-coupon div>button.sooDeleteCouponButton.sooCheckoutPrimaryButtonInput{display:none;width:100%}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty{margin-top:10px;min-height:135px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty>div.moo-checkout-bloc-content,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty>div.moo-checkout-bloc-content{margin-top:23px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .sooRemovePointsButton,#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .usePointsInput,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .sooRemovePointsButton,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .usePointsInput{display:none}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .usePointsInput,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .usePointsInput{margin-top:30px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .usePointsInput .moo-error-section,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .usePointsInput .moo-error-section{margin-top:7px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .usePointsInput .sooToPayInfo,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .usePointsInput .sooToPayInfo{margin-top:8px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .usePointsInput .sooValidatePoints,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .usePointsInput .sooValidatePoints{padding:0}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .usePointsInput .sooValidatePoints .sooEditPointsButton,#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .usePointsInput .sooValidatePoints .sooValidatePointsButton,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .usePointsInput .sooValidatePoints .sooEditPointsButton,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .usePointsInput .sooValidatePoints .sooValidatePointsButton{font-size:16px;line-height:16px;margin:0;min-height:15px;padding:10px;width:70%}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .usePointsInput .sooValidatePoints .sooEditPointsButton,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .usePointsInput .sooValidatePoints .sooEditPointsButton{display:none}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .usePointsInput .sooValidatePoints .sooLoyaltyDetailsButton svg,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .usePointsInput .sooValidatePoints .sooLoyaltyDetailsButton svg{cursor:pointer;height:30px;vertical-align:middle;width:30px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .usePointsInput #sooSelectedPointsValue,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .usePointsInput #sooSelectedPointsValue{padding-left:10px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .loyaltyIcon>img,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .loyaltyIcon>img{width:50px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .loyaltyButtons,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .loyaltyButtons{padding:0 10px 0 0;text-align:right}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .loyaltyButtons .sooRemovePointsButton,#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .loyaltyButtons .sooUsePointsButton,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .loyaltyButtons .sooRemovePointsButton,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .loyaltyButtons .sooUsePointsButton{font-weight:400;margin:0;padding:10px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .loyaltyButtons .sooRemovePointsButton,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .loyaltyButtons .sooRemovePointsButton{font-size:13px;padding:7px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .loyaltyBalance,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .loyaltyBalance{padding:0}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .loyaltyBalance .balance,#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .loyaltyBalance .balanceTitle,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .loyaltyBalance .balance,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .loyaltyBalance .balanceTitle{color:rgba(0,0,0,.63);font-family:Soo DM Sans,sans-serif;font-size:14px;font-weight:400;letter-spacing:0;line-height:18px;text-align:left}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .loyaltyBalance .balance,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .loyaltyBalance .balance{color:#000}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .loyaltyBalance .balance>.balancePoints,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .loyaltyBalance .balance>.balancePoints{font-size:18px;font-weight:500;line-height:23px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .loyaltyBalance .loyaltyButtons,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside #moo-checkout-form-loyalty .loyaltyBalance .loyaltyButtons{font-weight:400;text-align:right}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside .moo-checkout-bloc-title,#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside .moo-checkout-bloc-title>label,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside .moo-checkout-bloc-title,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside .moo-checkout-bloc-title>label{color:#000;font-family:Soo DM Sans,sans-serif;font-size:18px;font-style:normal;font-weight:500;line-height:30px;margin-bottom:10px;margin-top:10px;text-transform:none}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside .moo\_checkout\_border\_bottom,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-form-leftside .moo\_checkout\_border\_bottom{border-bottom:1px solid #eee;margin-left:-15px;margin-right:-15px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-cart,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-cart{background-color:#fff;border:.7px solid #b8b8b8;border-radius:10px;color:#000;font-family:Soo DM Sans,sans-serif;font-size:15px;padding:0}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-cart .moo-shopping-cart-title,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-cart .moo-shopping-cart-title{border-bottom:.7px solid #b8b8b8;color:#000;font-family:Soo DM Sans,sans-serif;font-size:18px;font-style:normal;font-weight:500;line-height:30px;padding:13px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-cart .moo-shopping-cart-line,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-cart .moo-shopping-cart-line{margin-bottom:5px;margin-top:5px;padding-left:10px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-cart .moo-shopping-cart-line .moo-scl-qty,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-cart .moo-shopping-cart-line .moo-scl-qty{text-align:center}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-cart .moo-shopping-cart-line .moo-scl-item,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-cart .moo-shopping-cart-line .moo-scl-item{padding:0}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-cart .moo-shopping-cart-line .moo-scl-item .moo-scl-itemName,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-cart .moo-shopping-cart-line .moo-scl-item .moo-scl-itemName{font-family:Soo DM Sans,sans-serif;font-size:16px;font-weight:400;letter-spacing:0;line-height:20px;margin-top:3px;text-align:left}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-cart .moo-shopping-cart-line .moo-scl-item .moo-scl-itemModifiers,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-cart .moo-shopping-cart-line .moo-scl-item .moo-scl-itemModifiers{font-family:Soo DM Sans,sans-serif;font-size:15px;font-weight:400;letter-spacing:0;line-height:16px;text-align:left}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-cart .moo-shopping-cart-line .moo-scl-itemPrice,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-cart .moo-shopping-cart-line .moo-scl-itemPrice{padding-left:0;padding-right:20px;text-align:right}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-cart .moo-totals,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-cart .moo-totals{border-top:.7px solid #b8b8b8;color:#000;font-family:Soo DM Sans,sans-serif;font-size:13px;font-weight:400;letter-spacing:0;overflow:auto;padding:10px}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-cart .moo-totals .moo-totals-item,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-cart .moo-totals .moo-totals-item{clear:both;float:right;margin-bottom:0;width:100%}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-cart .moo-totals .moo-totals-item .moo-totals-value,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-cart .moo-totals .moo-totals-item .moo-totals-value{float:right;text-align:right;width:30%}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-cart .moo-totals .moo-totals-item label,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-cart .moo-totals .moo-totals-item label{clear:both;float:left;text-align:right;width:70%}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-cart .moo-totals #sooCouponTotalSection,#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-cart .moo-totals #sooDeliveryFeeTotalSection,#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-cart .moo-totals #sooPointsTotalSection,#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-cart .moo-totals #sooServiceFeeTotalSection,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-cart .moo-totals #sooCouponTotalSection,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-cart .moo-totals #sooDeliveryFeeTotalSection,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-cart .moo-totals #sooPointsTotalSection,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-cart .moo-totals #sooServiceFeeTotalSection{display:none}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-links a,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-links a{color:#004fac;font-size:12px;text-align:center;text-decoration:none}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-links a:visited,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-links a:visited{color:#004fac}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-links a:focus,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-links a:focus{outline:none}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-links .moo-checkoutText-updateCart,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-links .moo-checkoutText-updateCart{float:left}#moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-links .moo-checkoutText-continueShopping,.moo\_CheckoutContainer #moo-checkout-form .moo-checkout-cart .cartContainer .moo-shopping-links .moo-checkoutText-continueShopping{float:right}#moo\_CheckoutContainer #moo-checkout-form #moo-checkout-form-btnActions #moo-cloverGooglePay,.moo\_CheckoutContainer #moo-checkout-form #moo-checkout-form-btnActions #moo-cloverGooglePay{display:none;height:45px;min-width:90px}#moo\_CheckoutContainer #moo-checkout-form #moo-checkout-form-btnActions .moo-finalize-order-btn,.moo\_CheckoutContainer #moo-checkout-form #moo-checkout-form-btnActions .moo-finalize-order-btn{width:100%}#moo\_CheckoutContainer #moo-checkout-form .soo-sticky-cart,.moo\_CheckoutContainer #moo-checkout-form .soo-sticky-cart{position:sticky;top:0}#moo\_CheckoutContainer .moo-edit-profile-form,.moo\_CheckoutContainer .moo-edit-profile-form{text-align:left}#moo\_CheckoutContainer .moo-edit-profile-form>div,.moo\_CheckoutContainer .moo-edit-profile-form>div{margin-bottom:10px}#moo\_CheckoutContainer .dot-flashing-2,.moo\_CheckoutContainer .dot-flashing-2{--\_g:no-repeat radial-gradient(circle closest-side,#000 90%,#0000);animation:sooDotFlashing2 1s linear infinite;aspect-ratio:2;background:var(--\_g) 0 50%,var(--\_g) 50% 50%,var(--\_g) 100% 50%;background-size:33.33333% 50%;margin:0 auto;width:60px}#moo\_CheckoutContainer .dot-flashing,.moo\_CheckoutContainer .dot-flashing{animation:sooDotFlashing .8s linear infinite alternate;animation-delay:.3s;background-color:#fff;border-radius:2.8px;color:#fff;height:6px;margin:0 auto;position:relative;width:6px}#moo\_CheckoutContainer .dot-flashing:after,#moo\_CheckoutContainer .dot-flashing:before,.moo\_CheckoutContainer .dot-flashing:after,.moo\_CheckoutContainer .dot-flashing:before{content:"";display:inline-block;position:absolute;top:0}#moo\_CheckoutContainer .dot-flashing:before,.moo\_CheckoutContainer .dot-flashing:before{animation:sooDotFlashing .8s infinite alternate;animation-delay:0s;background-color:#fff;border-radius:2.8px;color:#fff;height:6px;left:-15px;width:6px}#moo\_CheckoutContainer .dot-flashing:after,.moo\_CheckoutContainer .dot-flashing:after{animation:sooDotFlashing .8s infinite alternate;animation-delay:.8s;background-color:#fff;border-radius:2.8px;color:#fff;height:6px;left:15px;width:6px}@keyframes sooDotFlashing{0%{background-color:#fff}50%,to{background-color:hsla(0,0%,100%,.4)}}@keyframes sooDotFlashing2{20%{background-position:0 0,50% 50%,100% 50%}40%{background-position:0 100%,50% 0,100% 50%}60%{background-position:0 50%,50% 100%,100% 0}80%{background-position:0 50%,50% 50%,100% 100%}}#moo\_CheckoutContainer form,.moo\_CheckoutContainer form{margin:0}.sooMyOrders{margin-top:60px}.soo-loyalty-conditions{font-family:Soo DM Sans,sans-serif;font-size:16px;overflow:hidden;text-align:left}.soo-loyalty-conditions ul{list-style:none}.swal2-html-container{margin:15px 0 0;overflow-x:hidden}.swal2-container .swal2-center>.swal2-popup{padding:0 25px 25px}.swal2-container .fontSizeLg{font-size:1.2em}.moo-fade-in{animation:fadeIn .5s ease infinite;-webkit-animation:fadeIn .5s ease infinite;-moz-animation:fadeIn .5s ease infinite;-o-animation:fadeIn .5s ease infinite;-ms-animation:fadeIn .5s ease infinite}@keyframes sooAnmRotate{to{transform:rotate(1turn)}}@keyframes fadeIn{0%{opacity:0}to{opacity:1}}@-moz-keyframes fadeIn{0%{opacity:0}to{opacity:1}}@-webkit-keyframes fadeIn{0%{opacity:0}to{opacity:1}}@-o-keyframes fadeIn{0%{opacity:0}to{opacity:1}}@-ms-keyframes fadeIn{0%{opacity:0}to{opacity:1}} |
* ## [clover-online-orders/trunk/public/js/dist/sooCheckout.min.js](/changeset/3168433/clover-online-orders/trunk/public/js/dist/sooCheckout.min.js "Show the changeset 3168433 restricted to clover-online-orders/trunk/public/js/dist/sooCheckout.min.js")

  | [r2986704](/browser/clover-online-orders/trunk/public/js/dist/sooCheckout.min.js?rev=2986704#L27 "Show revision 2986704 of this file in browser") | [r3168433](/browser/clover-online-orders/trunk/public/js/dist/sooCheckout.min.js?rev=3168433#L27 "Show revision 3168433 of this file in browser") |  |
  | --- | --- | --- |
  | 27 | 27 | </div> |
  | 28 | 28 | </div> |
  | 29 |  | </div></div>`;Swal.fire({title:"Edit Your Profile",html:form,showCancelButton:true,cancelButtonText:mooObjectL10n.cancel,confirmButtonText:mooObjectL10n.edit,showLoaderOnConfirm:true,preConfirm:()=>{const firstName=Swal.getPopup().querySelector("#sooContactFirstName").value;const lastName=Swal.getPopup().querySelector("#sooContactLastName").value;const email=Swal.getPopup().querySelector("#sooContactEmail").value;const phone=Swal.getPopup().querySelector("#sooContactPhone").value;if(firstName===""){Swal.showValidationMessage("Your name is required");return}if(email===""){Swal.showValidationMessage("Your email is required");return}if(phone===""){Swal.showValidationMessage("Your phone is required");return}const token=localStorage.getItem("customerJwtToken");return fetch(sooCheckout.options.restApiUrl+"moo-clover/v2/customers/me",{method:"POST",mode:"cors",cache:"no-cache",credentials:"same-origin",headers:{"Content-Type":"application/json",Authorization:"Bearer "+token},redirect:"follow",referrerPolicy:"no-referrer",body:JSON.stringify({email:email,first\_name:firstName,last\_name:lastName,phone:phone})}).then(response=>{return response.json()}).then(data=>{if(data.message){throw new Error(data.message)}else{if(data===false){throw new Error(mooObjectL10n.anErrorOccurred)}return data}}).catch(error=>{Swal.showValidationMessage(error)})},allowOutsideClick:false}).then(function(data){if(data.value){localStorage.setItem("loggedInCustomer",JSON.stringify(data.value));mooCheckout.loggedInCustomer=data.value;mooCheckout.fillCustomerInfo()}},function(data){if(data.dismiss==="cancel"){Swal.close()}})},logout:function(e){e.preventDefault();mooCheckout.loggedInCustomer=null;mooCheckout.loggedInCustomer=null;localStorage.removeItem("customerJwtToken");localStorage.removeItem("loggedInCustomer");this.uncheckSelectedOrderingMethod();this.uncheckSelectedPaymentMethod();this.updateTotals();this.showLoginSection();return false},continueAsGuest:function(e){e.preventDefault();mooGlobalParams.isGuest=true;history.pushState({},"Checkout");this.showCheckoutDetails();return false},hideLoadingCheckout(){$("#moo-checkout>#moo-login-section > div.sooOverlayLoader").hide()},showOrHideASection(section,show){$("div.moo-section").hide();const elem=$("#moo-"+section);if(show){elem.show()}else{elem.hide()}},showLoginSection(section,show){$("#sooAuthSection").show();$("div.moo-section").hide();$("#moo-login-section").show()},isCustomerLoggedIn(){return localStorage.getItem("customerJwtToken")!==null},getLoggedInCustomer(){if(localStorage.getItem("loggedInCustomer")){let customer=JSON.parse(localStorage.getItem("loggedInCustomer"));mooCheckout.loggedInCustomer=customer;return customer}return null},getGuestInfo(){const firstName=$("#MooContactFirstName").val();const lastName=$("#MooContactLastName").val();const email=$("#MooContactEmail").val();const phone=$("#MooContactPhone").val();return{first\_name:firstName.trim(),last\_name:lastName.trim(),email:email.trim(),phone:phone.trim(),isPhoneVerified:mooGlobalParams.isGuestPhoneVerified,address:this.getSelectedAddress(),full\_address:this.getSelectedAddressAsString()}},syncLoggedInCustomerProfile(){this.getCustomerProfile().then(async function(response){if(!response.ok){const message=`An error has occured: ${response.status}`;throw new Error(message)}return await response.json()}).then(data=>{localStorage.setItem("loggedInCustomer",JSON.stringify(data));mooCheckout.loggedInCustomer=data}).catch(error=>{console.log(error)})},getCustomerProfile(){let token=localStorage.getItem("customerJwtToken");return fetch(sooCheckout.options.restApiUrl+"moo-clover/v2/customers/me",{method:"GET",mode:"cors",cache:"no-cache",headers:{"Content-Type":"application/json",Authorization:"Bearer "+token},redirect:"follow",referrerPolicy:"no-referrer"})},fillCustomerInfo(){if(mooGlobalParams.isGuest){$("#moo-checkout-contact-form").show();$("#moo-checkout-contact-content").hide()}else{let customer=this.getLoggedInCustomer();if(customer){let name=null;if(customer.first\_name){name=customer.first\_name}if(customer.last\_name){name+=" "+customer.last\_name}if(!name){name=" "+customer.full\_name}$("#moo-checkout-contact-content .soo-contact-info-name").text(name);if(customer.is\_email\_verified){$("#moo-checkout-contact-content .soo-contact-info-email").text(customer.email+" ✓ ")}else{$("#moo-checkout-contact-content .soo-contact-info-email").text(customer.email)}if(customer.is\_phone\_verified){$("#moo-checkout-contact-content .soo-contact-info-phone").text(customer.phone+" ✓ ")}else{if(customer.phone===""){$("#moo-checkout-contact-content .soo-contact-info-phone").text("Phone not provided")}else{$("#moo-checkout-contact-content .soo-contact-info-phone").text(customer.phone)}}$("#moo-checkout-contact-form").hide();$("#moo-checkout-contact-content").show()}else{console.log("Can't get the customer, he must login again");this.showLoginSection()}}},fillCustomerPointsBalance(){let customer=this.getLoggedInCustomer();if(customer){let balance=0;let balanceUsdValue=0;if(customer.point\_count){balance=customer.point\_count;balanceUsdValue=this.getValueOfPoints(balance)}$("#moo-checkout-form-loyalty .loyaltyBalance > div.balance > span.balancePoints").text(balance+" "+mooGlobalParams.pointsLabel);$("#moo-checkout-form-loyalty .loyaltyBalance > div.balance > span.balanceAmount").text(this.formatPrice(balanceUsdValue));if(balance<=0){$("#moo-checkout-form-loyalty .loyaltyButtons > button.sooUsePointsButton").html("Loyalty Conditions").attr("onclick","mooCheckout.openLoyaltyDetails()").css("padding","2px");$("#moo-checkout-form-loyalty .loyaltyButtons").removeClass("moo-col-xs-4").addClass("moo-col-xs-6");$("#moo-checkout-form-loyalty .loyaltyBalance").removeClass("moo-col-xs-6").addClass("moo-col-xs-4")}}else{console.log("Can't get the customer, he must login again")}},shouldVerifyPhone:function(){if(!sooCheckout.options.useSmsVerification){return false}else{if(mooGlobalParams.isGuest){return mooGlobalParams.isGuestPhoneVerified===false}else{const customer=this.getLoggedInCustomer();if(customer){return customer.is\_phone\_verified===false}else{this.syncLoggedInCustomerProfile();return true}}}},loggedInCustomerPhoneIsVerified:function(){const customer=this.getLoggedInCustomer();if(customer){return customer.is\_phone\_verified}else{this.syncLoggedInCustomerProfile();return false}},isMobile:function(){if(/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)){return true}return false},getSelectedPaymentMethod:function(){var elm=$('#moo-checkout-form-payments input[name="paymentMethod"]:checked');if(elm.length>0&&elm.val()!==""){return elm.val()}return null},getSelectedOrderingMethod:function(){var elm=$('#moo-checkout-form-ordertypes input[name="ordertype"]:checked');if(elm.length){return elm.val()}return null},countAvailableOrderingMethods:function(){const elmOrderingMethods=$('#moo-checkout-form-ordertypes input[name="ordertype"]');const elmDisabledOrderingMethods=$('#moo-checkout-form-ordertypes input[name="ordertype"]:disabled');if(elmOrderingMethods.length){if(elmDisabledOrderingMethods.length){return elmOrderingMethods.length-elmDisabledOrderingMethods.length}else{return elmOrderingMethods.length}}else{return 0}},countAvailablePaymentMethods:function(){const elmPaymentMethods=$('#moo-checkout-form-payments input[name="paymentMethod"]');if(elmPaymentMethods.length){return elmPaymentMethods.length}else{return 0}},uncheckSelectedOrderingMethod:function(){const elm=$('#moo-checkout-form-ordertypes input[name="ordertype"]:checked');if(elm.length){elm.removeAttr("checked")}mooGlobalParams.selectedOrderType=null;mooGlobalParams.selectedAddress=null;mooGlobalParams.deliveryFees=null;mooGlobalParams.isDeliveryOrder=false;this.hideAddressSection();this.hideDeliveryAmount()},uncheckSelectedPaymentMethod:function(){const elm=$('#moo-checkout-form-payments input[name="paymentMethod"]:checked');if(elm.length){elm.removeAttr("checked")}this.hidePhoneVerificationSection();$("#moo-cloverCreditCardPanel").hide()},getCustomer:function(){if(mooGlobalParams.isGuest){return this.getGuestInfo()}else{const customer=this.getLoggedInCustomer();return{first\_name:customer.first\_name,last\_name:customer.last\_name,email:customer.email,phone:customer.phone,isPhoneVerified:customer.is\_phone\_verified,address:this.getSelectedAddress(),full\_address:this.getSelectedAddressAsString()}}},getTipAmount:function(){if(isNaN(mooGlobalParams.tipAmount)||mooCheckout.getSelectedPaymentMethod()==="cash"){return 0}return mooGlobalParams.tipAmount},getSelectedAddress:function(){return mooGlobalParams.selectedAddress},getSelectedAddressAsString:function(){var address=this.getSelectedAddress();var address\_string="";if(address){if(address.address)address\_string+=address.address+" ";if(address.line2)address\_string+=address.line2+" ";if(address.city)address\_string+=address.city+", ";if(address.state)address\_string+=address.state+" ";if(address.zipcode)address\_string+=address.zipcode}return address\_string},addNewAddress:function(e){e.preventDefault();if(mooCheckout.addAddressForm.data("submitted")===true){return false}else{mooCheckout.startSubmitingAform(mooCheckout.addAddressForm)}const formElements={fullNameInput:mooCheckout.addAddressForm.find("#sooAddAddressName"),addressInput:mooCheckout.addAddressForm.find("#sooAddAddressLine1"),line2Input:mooCheckout.addAddressForm.find("#sooAddAddressLine2"),cityInput:mooCheckout.addAddressForm.find("#sooAddAddressCity"),stateInput:mooCheckout.addAddressForm.find("#sooAddAddressState"),zipCodeInput:mooCheckout.addAddressForm.find("#sooAddAddressZipCode")};const requiredField=["addressInput","cityInput","stateInput","zipCodeInput"];for(const el in formElements){if(requiredField.includes(el)&&!formElements[el].val()){formElements[el].parent().addClass("moo-has-error");formElements[el].next().show();formElements[el].focus();mooCheckout.finishSubmitingAform(mooCheckout.addAddressForm);return}}mooGlobalParams.selectedAddress={full\_name:formElements.fullNameInput.val().trim(),address:formElements.addressInput.val().trim(),line2:formElements.line2Input.val().trim(),city:formElements.cityInput.val().trim(),state:formElements.stateInput.val().trim(),zipcode:formElements.zipCodeInput.val().trim()};if(mooGlobalParams.isGuest){if(mooGlobalParams.selectedOrderType){if(mooGlobalParams.selectedOrderType.ot\_uuid==="onDemandDelivery"){mooCheckout.finishSubmitingAform(mooCheckout.addAddressForm);mooCheckout.showListOfAddresses()}else{$.ajax({type:"POST",cache:false,url:sooCheckout.options.restApiUrl+"moo-clover/v3/geocode-address",headers:{"Content-Type":"application/json"},data:JSON.stringify(mooGlobalParams.selectedAddress)}).done(function(response){mooGlobalParams.selectedAddress.lat=response.lat;mooGlobalParams.selectedAddress.lng=response.lng;mooCheckout.finishSubmitingAform(mooCheckout.addAddressForm);const res=mooCheckout.calculateDeliveryFees(mooGlobalParams.selectedAddress.lat,mooGlobalParams.selectedAddress.lng);if(res.result==="zone\_error"){mooCheckout.showErrorAlert(res.message,"")}else{mooCheckout.showListOfAddresses()}}).fail(function(response){mooCheckout.finishSubmitingAform(mooCheckout.addAddressForm);let errorMsg="";if(response.responseJSON&&response.responseJSON.message){errorMsg=response.responseJSON.message}else{errorMsg=mooObjectL10n.anErrorOccurred}mooCheckout.showErrorAlert(errorMsg,mooObjectL10n.tryAgain);mooGlobalParams.selectedAddress=null})}}else{mooCheckout.showErrorAlert(mooObjectL10n.error,"Select an Ordering Method")}}else{let token=localStorage.getItem("customerJwtToken");if(!token){console.log("token not found")}$.ajax({type:"POST",cache:false,url:sooCheckout.options.restApiUrl+"moo-clover/v3/customers/addresses",headers:{"Content-Type":"application/json",Authorization:"Bearer "+token},data:JSON.stringify(mooGlobalParams.selectedAddress)}).done(function(address){if(address.id){mooCheckout.finishSubmitingAform(mooCheckout.addAddressForm);if(mooCheckout.loggedInCustomer.addresses.length>0){mooCheckout.loggedInCustomer.addresses.push(address)}else{mooCheckout.loggedInCustomer.addresses=[address]}mooCheckout.showListOfAddresses()}else{mooCheckout.showErrorAlert(mooObjectL10n.anErrorOccurred,"")}}).fail(function(data){mooCheckout.finishSubmitingAform(mooCheckout.addAddressForm);let errorMsg="";if(data.responseJSON&&data.responseJSON.message){errorMsg=data.responseJSON.message}else{errorMsg=mooObjectL10n.anErrorOccurred}mooCheckout.showErrorAlert(errorMsg,mooObjectL10n.tryAgain)})}},fillAddressToEdit:function(){if(mooGlobalParams.selectedAddress){const formElements={fullNameInput:mooCheckout.addAddressForm.find("#sooAddAddressName"),addressInput:mooCheckout.addAddressForm.find("#sooAddAddressLine1"),line2Input:mooCheckout.addAddressForm.find("#sooAddAddressLine2"),cityInput:mooCheckout.addAddressForm.find("#sooAddAddressCity"),stateInput:mooCheckout.addAddressForm.find("#sooAddAddressState"),zipCodeInput:mooCheckout.addAddressForm.find("#sooAddAddressZipCode")};if(mooGlobalParams.selectedAddress.full\_name){formElements.fullNameInput.val(mooGlobalParams.selectedAddress.full\_name)}if(mooGlobalParams.selectedAddress.address){formElements.addressInput.val(mooGlobalParams.selectedAddress.address)}if(mooGlobalParams.selectedAddress.line2){formElements.line2Input.val(mooGlobalParams.selectedAddress.line2)}if(mooGlobalParams.selectedAddress.city){formElements.cityInput.val(mooGlobalParams.selectedAddress.city)}if(mooGlobalParams.selectedAddress.state){formElements.stateInput.val(mooGlobalParams.selectedAddress.state)}if(mooGlobalParams.selectedAddress.zipcode){formElements.zipCodeInput.val(mooGlobalParams.selectedAddress.zipcode)}}},setAddress:function(address){localStorage.setItem("selectedAddress",JSON.stringify(address))},isPhoneVerificationActivated:function(){return sooCheckout.options.useSmsVerification},orderTypeChanged:function(){if(mooGlobalParams.selectedOrderType&&mooCheckout.getSelectedOrderingMethod()===mooGlobalParams.selectedOrderType.ot\_uuid){console.log("order type not changed");return}mooGlobalParams.selectedOrderType=mooCheckout.getOneOrderType(mooCheckout.getSelectedOrderingMethod());if(mooGlobalParams.selectedOrderType){const orderType=mooGlobalParams.selectedOrderType;mooGlobalParams.deliveryFees=0;if(this.isTrue(mooGlobalParams.selectedOrderType.allow\_sc\_order)&&sooCheckout.options.allowScOrder){mooGlobalParams.allowScOrders=true;this.showOrderingTime()}else{mooGlobalParams.allowScOrders=false;this.hideOrderingTime()}if(this.isTrue(mooGlobalParams.selectedOrderType.show\_sa)){mooGlobalParams.isDeliveryOrder=true;this.showListOfAddresses();this.showDeliveryAmount();if(mooGlobalParams.allowScOrders){this.changeOrderingTimes("delivery")}if(sooCheckout.options.cashUponDelivery&&orderType.ot\_uuid!=="onDemandDelivery"){$("#moo-checkout-form-payincash-label").text(mooObjectL10n.payUponDelivery);this.showCashPayment()}else{this.hideCashPayment()}}else{mooGlobalParams.isDeliveryOrder=false;mooGlobalParams.deliveryFees=0;mooGlobalParams.selectedAddress=null;this.hideAddressSection();this.hideDeliveryAmount();if(mooGlobalParams.allowScOrders){this.changeOrderingTimes("pickup")}if(sooCheckout.options.cashInStore){$("#moo-checkout-form-payincash-label").text(mooObjectL10n.payAtlocation);this.showCashPayment()}else{this.hideCashPayment()}}if(this.isTrue(mooGlobalParams.selectedOrderType.use\_coupons)){this.showCouponsSection()}else{this.hideCouponsSection()}this.updateTotals()}else{console.log("No OrderType found")}},paymentMethodChanged:function(){const selectedPaymentMethod=mooCheckout.getSelectedPaymentMethod();if(selectedPaymentMethod==="cash"){this.hideTipSection();$("#moo-cloverCreditCardPanel").hide();$("#moo-cloverGiftCardPanel").hide();if(this.shouldVerifyPhone()){this.showPhoneVerificationSection()}$("#moo\_btn\_submit\_order").show();$("#moo-cloverGooglePay").hide();$("#mooGooglePaySection").hide()}if(selectedPaymentMethod==="clover"){this.showTipSection();this.hidePhoneVerificationSection();$("#moo-cloverGiftCardPanel").hide();$("#moo\_btn\_submit\_order").show();$("#moo-cloverGooglePay").hide();$("#mooGooglePaySection").hide();$("#moo-cloverCreditCardPanel").show()}if(selectedPaymentMethod==="giftcard"){this.showTipSection();$("#moo-cloverCreditCardPanel").hide();this.hidePhoneVerificationSection();$("#moo-cloverGiftCardPanel").show();$("#moo\_btn\_submit\_order").show();$("#moo-cloverGooglePay").hide();$("#mooGooglePaySection").hide()}if(selectedPaymentMethod==="googlepay"){this.showTipSection();$("#moo-cloverCreditCardPanel").hide();this.hidePhoneVerificationSection();$("#moo-cloverGiftCardPanel").hide();$("#moo\_btn\_submit\_order").hide();$("#moo-cloverGooglePay").show();$("#mooGooglePaySection").show()}this.updateTotalsSection(sooCheckout.options.totals)},orderingTimeChanged:function(element){this.updateSelectedTime()},orderingDayChanged:function(element){let html="";const theDay=$(element).val();const times=mooGlobalParams.isDeliveryOrder?sooCheckout.options.deliveryTimes[theDay]:sooCheckout.options.pickupTimes[theDay];if(!(typeof times==="undefined")){html+='<option value="Select a time">Select a time</option>';for(let i in times){html+='<option value="'+times[i]+'">'+times[i]+"</option>"}}else{html=""}$("#moo\_pickup\_hour").html(html);this.updateSelectedTime()},tipPercentageChanged:function(){const selectedPercentAmount=$("#moo\_tips\_select").val();if(selectedPercentAmount&&selectedPercentAmount!=="cash"&&selectedPercentAmount!=="other"){const calculatedAmount=sooCheckout.options.totals.sub\_total\*selectedPercentAmount/100;mooGlobalParams.tipAmount=Math.round(parseInt(calculatedAmount))}else{mooGlobalParams.tipAmount=0;if(selectedPercentAmount==="other"){$("#moo\_tips").select()}}$("#moo\_tips").val(this.formatPrice(mooGlobalParams.tipAmount));this.updateTotalsSection(sooCheckout.options.totals)},tipAmountChanged:function(){const calculatedAmount=parseInt(Math.ceil(parseFloat($("#moo\_tips").val())\*100));const amount=Math.round(calculatedAmount);if(!isNaN(amount)&&amount>0){mooGlobalParams.tipAmount=amount;$("#moo\_tips").val(this.formatPrice(mooGlobalParams.tipAmount))}else{mooGlobalParams.tipAmount=0;$("#moo\_tips").val("0.00")}this.updateTotalsSection(sooCheckout.options.totals)},showListOfAddresses:function(){$("#moo-checkout-form-ordertypes .soo-address-section .soo-add-delivery-address-form").hide();var listAddrElm=$("#moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses");listAddrElm.show();listAddrElm.html("<div  class='soo-addresses-wrapper'><div class='soo-addresses-title'>Loading your addresses...</div></div>");let html="<div  class='soo-addresses-wrapper'>";html+="<div class='soo-estimate-loader'></div>";let addressesProcessed=0;let nbOfAddresses=0;let addresses=[];let cssClasses="";if(mooGlobalParams.isGuest){if(mooGlobalParams.selectedAddress){nbOfAddresses=1;addresses=[mooGlobalParams.selectedAddress]}else{mooCheckout.showAddAddressForm();$("#soo-add-address-form > div > div > button.sooCheckoutSecondaryButtonInput").hide();return}}else{if(mooCheckout.loggedInCustomer){addresses=mooCheckout.loggedInCustomer.addresses;nbOfAddresses=addresses?addresses.length:0}}if(nbOfAddresses===1){mooGlobalParams.selectedAddress=addresses[0];cssClasses="soo-selected";html+="<div class='soo-addresses-title'>Delivery to :</div>"}else{html+="<div class='soo-addresses-title'>Choose a delivery address</div>"}if(nbOfAddresses>0){addresses.forEach(element=>{if(mooGlobalParams.selectedAddress&&mooGlobalParams.selectedAddress.id===element.id){cssClasses="soo-selected"}else{cssClasses=""}html+="<div class='soo-one-address "+cssClasses+"' id='soo-address-"+element.id+"' onclick='mooCheckout.selectAnAddress("+element.id+")'>";if(typeof element.full\_name!=="undefined"&&element.full\_name!==null){html+="<div class='soo-one-address-name'>"+element.full\_name+"</div>"}html+="<div class='soo-one-address-line1'>"+element.address+"</div>";if(element.line2){html+="<div class='soo-one-address-line2'>"+element.line2+"</div>"}html+="<div class='soo-one-address-line2'>"+element.city+" "+element.state+", "+element.zipcode+"</div>";html+="<div class='soo-address-error'></div>";html+="<div class='soo-delivery-amount'></div>";html+="</div>";addressesProcessed++;if(addressesProcessed>=nbOfAddresses){if(mooGlobalParams.isGuest){html+="</div><div class='soo-add-new-address-button'><span onclick='mooCheckout.showEditAddressForm()'>Edit Address</span></div>"}else{html+="</div><div class='soo-add-new-address-button'><span onclick='mooCheckout.showAddAddressForm()'>Add New Address</span></div>"}listAddrElm.html(html);mooCheckout.syncDeliveryFee()}})}else{mooCheckout.showAddAddressForm()}},showAddAddressForm:function(){$("#moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses").hide();$("#moo-checkout-form-ordertypes .soo-address-section .soo-add-delivery-address-form").show();$("#soo-add-address-form > div > div > button.sooCheckoutSecondaryButtonInput").show()},showEditAddressForm:function(){this.showAddAddressForm();if(mooGlobalParams.selectedAddress){this.fillAddressToEdit()}},hideAddressSection:function(){$("#moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses").hide();$("#moo-checkout-form-ordertypes .soo-address-section .soo-add-delivery-address-form").hide()},hideCouponsSection:function(){$("#moo-checkout-form-coupon").hide()},showCouponsSection:function(){$("#moo-checkout-form-coupon").show()},showDeliveryAmount:function(){$("#sooDeliveryFeeTotalSection").show()},hideDeliveryAmount:function(){$("#sooDeliveryFeeTotalSection").hide()},showServiceFeeAmount:function(){$("#sooServiceFeeTotalSection").show()},hideServiceFeeAmount:function(){$("#sooServiceFeeTotalSection").hide()},showTipSection:function(){$("#sooTipsTotalSection").show();$("#moo-checkout-form-tips").show()},hideTipSection:function(){$("#sooTipsTotalSection").hide();$("#moo-checkout-form-tips").hide()},showCashPayment:function(){$(".moo-checkout-form-payments-cash-container").show();$("#moo-checkout-form-payments-cash").val("cash")},hideCashPayment:function(){$(".moo-checkout-form-payments-cash-container").hide();$("#moo\_cashPanel").hide();$("#moo-checkout-form-payments-cash").val("");if(this.getSelectedPaymentMethod()==="cash"){this.uncheckSelectedPaymentMethod()}},hidePhoneVerificationSection:function(){$("#moo\_cashPanel").hide()},showPhoneVerificationSection:function(){clearInterval(mooGlobalParams.timer);$("#moo\_cashPanel").show();const seconds=120;if(mooGlobalParams.isOtpCodeSent){this.changeElemVisibility("#moo\_cashPanel > div.soo-phone-button","hide");this.changeElemVisibility("#moo\_cashPanel > div.soo-phone-input","show");$("#moo\_cashPanel > div.soo-phone-verif-title").text("Sent sms verification to: "+this.getPhoneNumber());$("#moo\_cashPanel > div.soo-phone-verif-footer").html("Resend code in <span class='timer'>"+seconds+"</span> seconds");mooGlobalParams.timer=setInterval(this.countDown,1e3)}else{this.changeElemVisibility("#moo\_cashPanel > div.soo-phone-button","show");this.changeElemVisibility("#moo\_cashPanel > div.soo-phone-input","hide");$("#moo\_cashPanel > div.soo-phone-verif-title").text("We will send a verification code via SMS to your number");$("#moo\_cashPanel > div.soo-phone-verif-footer").html("")}},selectAnAddress:function(id){if(!mooGlobalParams.isGuest){$("#moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses .soo-one-address").removeClass("soo-selected soo-selected-error soo-selected-warning");$("#moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses .soo-one-address .soo-address-error").text("");$("#moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses .soo-one-address .soo-delivery-amount").text("");$("#moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses #soo-address-"+id).addClass("soo-selected");mooGlobalParams.selectedAddress=this.getAddressById(id);this.syncDeliveryFee()}},unSelectAddress:function(id){$("#moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses .soo-one-address").removeClass("soo-selected soo-selected-error soo-selected-warning");$("#moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses .soo-one-address .soo-address-error").text("");$("#moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses .soo-one-address .soo-delivery-amount").text("")},syncDeliveryFee:function(){if(mooGlobalParams.selectedAddress){const addrElm=$("#moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses #soo-address-"+mooGlobalParams.selectedAddress.id);const amountPos=-1/2\*parseFloat(addrElm.css("height"))+6;if(mooGlobalParams.selectedOrderType&&mooGlobalParams.selectedOrderType.ot\_uuid==="onDemandDelivery"){$(".soo-delivery-amount",addrElm).css("top",amountPos+"px");this.createOnDemandDeliveryEstimate()}else{const res=this.calculateDeliveryFees(mooGlobalParams.selectedAddress.lat,mooGlobalParams.selectedAddress.lng);if(res.result==="success"){mooGlobalParams.selectedAddress.isValid=true;let deliveryAmount;if(!isNaN(res.amount)&&res.amount>0){mooGlobalParams.deliveryFees=res.amount;deliveryAmount=parseFloat(res.amount/100).toFixed(2);deliveryAmount="+ $"+deliveryAmount}else{mooGlobalParams.deliveryFees=0;deliveryAmount="Free"}$(".soo-delivery-amount",addrElm).text(deliveryAmount).css("top",amountPos+"px")}else{mooGlobalParams.selectedAddress.isValid=false}if(res.result==="zone\_error"){addrElm.addClass("soo-selected-error");$(".soo-address-error",addrElm).text(res.message);mooGlobalParams.deliveryFees=null}if(res.result==="min\_error"){addrElm.addClass("soo-selected-warning");$(".soo-address-error",addrElm).text(res.message);mooGlobalParams.deliveryFees=null}mooCheckout.updateTotals()}}},getAddressById:function(id){if(mooCheckout.loggedInCustomer){for(var i=0;i<mooCheckout.loggedInCustomer.addresses.length;i++){if(mooCheckout.loggedInCustomer.addresses[i].id===id)return mooCheckout.loggedInCustomer.addresses[i]}}return null},getOneOrderType:function(orderTypeUuid){if(typeof sooCheckout.options.orderTypes!=="undefined"){for(var i in sooCheckout.options.orderTypes){if(orderTypeUuid===sooCheckout.options.orderTypes[i].ot\_uuid){return sooCheckout.options.orderTypes[i]}}}return null},changeElemVisibility:function(selector,showOrHide){if(showOrHide==="show"){$(selector).show()}if(showOrHide==="hide"){$(selector).hide()}},hideOrderingTime:function(){this.changeElemVisibility("#moo-checkout-form-orderdate","hide")},showOrderingTime:function(){this.changeElemVisibility("#moo-checkout-form-orderdate","show")},getPhoneNumber:function(){if(mooGlobalParams.isGuest){const customer=this.getGuestInfo();return customer.phone}else{const customer=this.getLoggedInCustomer();return customer.phone}},sendCodeToVerifyPhone:function(){const btnSend=$("#moo\_cashPanel > div.soo-phone-button > button");const btnSendTxt=btnSend.html();const phone=this.getPhoneNumber();const seconds=120;if(phone===""){mooCheckout.showErrorAlert(mooObjectL10n.enterYourPhone,"");return}btnSend.html('<div class="dot-flashing"></div>');let token=localStorage.getItem("customerJwtToken");if(!token&&!mooGlobalParams.isGuest){return}const url=mooGlobalParams.isGuest?"moo-clover/v2/guests/send-code":"moo-clover/v2/customers/send-code";fetch(sooCheckout.options.restApiUrl+url,{method:"POST",mode:"cors",cache:"no-cache",credentials:"same-origin",headers:{"Content-Type":"application/json",Authorization:"Bearer "+token},redirect:"follow",referrerPolicy:"no-referrer",body:JSON.stringify({phone:phone})}).then(response=>{if(!response.ok){return response.json()}else{mooGlobalParams.isOtpCodeSent=true;this.showPhoneVerificationSection();btnSend.html(btnSendTxt);return response.json()}}).then(data=>{btnSend.html(btnSendTxt);if(typeof data!=="undefined"&&data.message){if(data.message==="You just sent the verification code please try later"){mooGlobalParams.isOtpCodeSent=true;this.showPhoneVerificationSection()}else{Swal.fire({icon:"success",title:data.message})}}else{if(data===false){throw mooObjectL10n.anErrorOccurred}}}).catch(error=>{btnSend.html(btnSendTxt);mooCheckout.showErrorAlert(error,"")})},verifyCodeSentToPhone:function(){const btn=$("#moo\_cashPanel > div.soo-phone-input > button");const btnTxt=btn.html();const numReg=/^\d+\.?\d\*$/;const phone=this.getPhoneNumber();const code=$("#moo\_cashPanel > div.soo-phone-input > input").val();const seconds=120;if(code.length!==6||!numReg.test(code)){mooCheckout.showErrorAlert(mooObjectL10n.codeInvalid,mooObjectL10n.codeInvalidDetails);return}btn.html('<div class="dot-flashing"></div>');let token=localStorage.getItem("customerJwtToken");if(!token&&!mooGlobalParams.isGuest){return}const url=mooGlobalParams.isGuest?"moo-clover/v2/guests/check-code":"moo-clover/v2/customers/check-code";fetch(sooCheckout.options.restApiUrl+url,{method:"POST",mode:"cors",cache:"no-cache",credentials:"same-origin",headers:{"Content-Type":"application/json",Authorization:"Bearer "+token},redirect:"follow",referrerPolicy:"no-referrer",body:JSON.stringify({code:code,phone:phone})}).then(response=>{if(!response.ok){return response.json()}else{btn.html(btnTxt);clearInterval(mooGlobalParams.timer);mooCheckout.showSuccessAlert(mooObjectL10n.phoneVerified,mooObjectL10n.phoneVerifiedDetails);mooGlobalParams.isOtpCodeSent=false;this.hidePhoneVerificationSection();if(mooGlobalParams.isGuest){mooGlobalParams.isGuestPhoneVerified=true}else{this.getCustomerProfile().then(async function(response){if(!response.ok){const message=`An error has occured: ${response.status}`;throw new Error(message)}return await response.json()}).then(data=>{localStorage.setItem("loggedInCustomer",JSON.stringify(data));mooCheckout.loggedInCustomer=data;mooCheckout.fillCustomerInfo()}).catch(error=>{console.log(error)})}}}).then(data=>{btn.html(btnTxt);if(typeof data!=="undefined"&&data.message){throw data.message}else{if(data===false){throw mooObjectL10n.anErrorOccurred}}}).catch(error=>{btn.html(btnTxt);mooCheckout.showErrorAlert(error,"")})},countDown:function(){let sec=parseInt($("#moo\_cashPanel > div.soo-phone-verif-footer>.timer").text());$("#moo\_cashPanel > div.soo-phone-verif-footer>.timer").text(--sec);if(sec<=0){$("#moo\_cashPanel > div.soo-phone-verif-footer").html("<div onclick='mooCheckout.sendCodeToVerifyPhone()'>Resend code</div>");clearInterval(mooGlobalParams.timer)}},finalizeOrder:function(e){e.preventDefault();$("#moo\_btn\_submit\_order").hide();$("#moo\_checkout\_loading").show();$("#moo-checkout .errors-section").html("");try{window.mooCheckout.getCheckoutForm()}catch(e){console.log(e);window.mooCheckout.stopLoading();window.mooCheckout.showErrorAlert(mooObjectL10n.anErrorOccurred)}},verifyCheckoutForm:function(form){var regex\_exp={email:/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)\*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/};var message\_errors={};const selectedOrderType=mooGlobalParams.selectedOrderType;if(form.customer.first\_name===""&&form.customer.last\_name===""){mooCheckout.showErrorAlert(mooObjectL10n.enterYourName,"","#MooContactFirstName");return false}if(form.customer.email===""||!regex\_exp.email.test(form.customer.email)){mooCheckout.showErrorAlert(mooObjectL10n.enterYourEmail,mooObjectL10n.enterYourEmailReason,"#MooContactEmail");return false}if(form.customer.phone===""){mooCheckout.showErrorAlert(mooObjectL10n.enterYourPhone,mooObjectL10n.enterYourPhoneReason,"#MooContactPhone");return false}if(document.getElementById("moo-checkout-form-ordertypes")){if(typeof form.order\_type==="undefined"||form.order\_type===""){mooCheckout.showErrorAlert(mooObjectL10n.chooseOrderingMethod,mooObjectL10n.chooseOrderingMethodReason,"#moo-checkout-form-ordertypes");return false}}if(selectedOrderType){var minAmount=parseFloat(selectedOrderType.minAmount);var maxAmount=parseFloat(selectedOrderType.maxAmount);if(!isNaN(minAmount)){minAmount=minAmount\*100;minAmount=Math.round(minAmount\*100)/100;if(minAmount>0&&minAmount>sooCheckout.options.totals.sub\_total){this.stopLoading();Swal.fire({title:mooObjectL10n.YouDidNotMeetMinimum,text:mooObjectL10n.orderingMethodSubtotalGreaterThan+mooformatCentPrice(minAmount),icon:"warning",showCancelButton:true,confirmButtonColor:"#DD6B55",confirmButtonClass:"fontSizeLg",confirmButtonText:mooObjectL10n.continueToCheckout,cancelButtonText:mooObjectL10n.continueShopping}).then(data=>{if(data.dismiss&&data.dismiss==="cancel"){if(sooCheckout.options.storeLink){window.location.href=sooCheckout.options.storeLink}}});return false}}if(!isNaN(maxAmount)){maxAmount=maxAmount\*100;maxAmount=Math.round(maxAmount\*100)/100;if(maxAmount&&maxAmount<sooCheckout.options.totals.sub\_total){this.stopLoading();Swal.fire({title:mooObjectL10n.reachedMaximumPurchaseAmount,text:mooObjectL10n.orderingMethodSubtotalLessThan+mooformatCentPrice(maxAmount),icon:"warning",showCancelButton:true,confirmButtonColor:"#DD6B55",confirmButtonText:mooObjectL10n.updateCart,cancelButtonText:mooObjectL10n.checkout,closeOnConfirm:false}).then(function(data){if(data.value){Swal.close();window.location.href=moo\_params.cartPage}});return false}}if(mooCheckout.isTrue(selectedOrderType.show\_sa)){if(mooGlobalParams.selectedAddress){if(!mooGlobalParams.selectedAddress.isValid){mooCheckout.showErrorAlert(mooObjectL10n.verifyYourAddress,"Sorry, we are unable to deliver to this address. Please provide a different address or kindly get in touch with us if you feel are within the delivery range.","#moo-checkout-form-ordertypes>.moo-checkout-bloc-message");return false}}else{mooCheckout.showErrorAlert(mooObjectL10n.addDeliveryAddress,mooObjectL10n.addDeliveryAddressReason,"#moo-checkout-form-ordertypes>.moo-checkout-bloc-message .MooSimplButon");return false}}}if(mooGlobalParams.allowScOrders){if(sooCheckout.options.orderingTimeRequired){if(form.pickup\_hour===""||form.pickup\_hour==="Select a time"){mooCheckout.showErrorAlert(mooObjectL10n.chooseTime,"","#moo-checkout-form-orderdate");return false}}}if(sooCheckout.options.specialInstructionsRequired){if(typeof form.special\_instructions==="undefined"||form.special\_instructions===""){mooCheckout.showErrorAlert(mooObjectL10n.SpecialInstructionsRequired,"","#moo-checkout-form-instruction");return false}}if(form.tip\_amount>0&&this.getOrderTotal()===0){mooCheckout.showErrorAlert("Unable to Include Tips for $0 Orders","To enhance your experience, kindly note that we are unable to include tips when the Order Total is $0. However, you have the option to show your appreciation by providing a tip upon order pickup or delivery. We appreciate your understanding.","#moo-checkout-form-tips");return false}if(typeof form.payment\_method==="undefined"||form.payment\_method===""){mooCheckout.showErrorAlert(mooObjectL10n.choosePaymentMethod,"","#moo-checkout-form-payments");return false}else{if(form.payment\_method==="cash"){if(mooCheckout.shouldVerifyPhone()){if(mooGlobalParams.isGuest&&!mooGlobalParams.isGuestPhoneVerified||!mooGlobalParams.isGuest&&!mooCheckout.loggedInCustomerPhoneIsVerified()){mooCheckout.showPhoneVerificationSection();mooCheckout.showErrorAlert(mooObjectL10n.verifyYourPhone,mooObjectL10n.verifyYourPhoneReason,"#moo-checkout-form-payments");return false}}this.submitForm(form)}if(form.payment\_method==="clover"){if(window.cloverCardIsValid){window.clover.createToken().then(function(response){if(response.token){form.token=response.token;form.card=response.card;window.mooCheckout.submitForm(form)}else{mooCheckout.showErrorAlert(mooObjectL10n.verifyYourCreditCard,"","#moo-checkout-form-payments");return false}})}else{mooCheckout.showErrorAlert(mooObjectL10n.verifyYourCreditCard,window.cloverCardErrorMsg,"#moo-checkout-form-payments");return false}}if(form.payment\_method==="giftcard"){if(window.cloverGiftCardIsValid){try{const timeoutId=setTimeout(()=>{mooCheckout.showErrorAlert("Please verify the gift card information","","#moo-checkout-form-payments")},1e4);window.clover.createGiftCardToken().then(function(response){clearTimeout(timeoutId);if(response.token){form.payment\_method="clover";form.selected\_payment\_method="giftcard";form.token=response.token;window.mooCheckout.submitForm(form)}else{mooCheckout.showErrorAlert("Please verify the gift card information","","#moo-checkout-form-payments");return false}})}catch(err){console.log(err)}}else{mooCheckout.showErrorAlert("Please verify the gift card information","","#moo-checkout-form-payments");return false}}if(form.payment\_method==="googlepay"){if(window.googlePayToken){try{form.payment\_method="clover";form.token=window.googlePayToken.token;form.selected\_payment\_method="googlepay";form.googledata=window.googlePayToken;window.mooCheckout.submitForm(form)}catch(err){console.log(err)}}else{mooCheckout.showErrorAlert("Please Try Again","","#moo-checkout-form-payments");return false}}}},getCheckoutForm:function(){var form={channel:"website",customer:null,metainfo:[{name:"source\_url",value:window.location.href},{name:"checkout\_version",value:"new"}]};form.customer=mooCheckout.getCustomer();form.tip\_amount=mooCheckout.getTipAmount();form.special\_instructions=$("#Mooinstructions").val();form.pickup\_day=$("#moo\_pickup\_day").val();form.pickup\_hour=$("#moo\_pickup\_hour").val();form.orderingTime=mooGlobalParams.selectedTime;if(document.getElementById("moo-checkout-form-ordertypes")){form.order\_type=$('input[name="ordertype"]:checked').val()}form.payment\_method=$('#moo-checkout-form-payments input[name="paymentMethod"]:checked').val();form.delivery\_amount=mooCheckout.getDeliveryFees();form.service\_fee=mooCheckout.getServiceFees();if(this.canAcceptCoupons()){form.coupon={code:mooGlobalParams.couponCode}}if(this.canAcceptPoints()){form.use\_points=parseInt(mooGlobalParams.points)}form.totals=mooCheckout.getTotals();this.verifyCheckoutForm(form)},submitForm:function(form){if(form.order\_type==="onDemandDelivery"){let deliveryTime=(new Date).toISOString();if(mooGlobalParams.selectedTime){deliveryTime=mooGlobalParams.selectedTime}this.createDeliveryEstimate().then(response=>{if(!response.ok){throw new Error(mooObjectL10n.anErrorOccurred)}else{return response.json()}}).then(res=>{if(res.status==="success"){form.delivery\_estimate=res;form.delivery\_time=deliveryTime;this.createOrder(form)}else{throw new Error(res.message)}}).catch(err=>{this.showErrorAlert(err.message,"")})}else{this.createOrder(form)}},createOrder:function(form){if(sooCheckout.options.reCAPTCHA\_site\_key){grecaptcha.ready(function(){grecaptcha.execute(sooCheckout.options.reCAPTCHA\_site\_key,{action:"createOrder"}).then(token=>{console.log(token);form.reCAPTCHA\_token=token;mooCheckout.sendCreateOrder(form)})})}else{mooCheckout.sendCreateOrder(form)}return;let headers={"Content-Type":"application/json"};if(this.isCustomerLoggedIn()){form.customer\_token=localStorage.getItem("customerJwtToken")}$.ajax({type:"POST",cache:false,url:sooCheckout.options.restApiUrl+"moo-clover/v2/checkout",headers:headers,data:JSON.stringify(form)}).done(function(data){if(typeof data=="object"){if(data.status==="success"){mooCheckout.trackConversion(true,form);mooCheckout.successfulOrder(data.id)}else{mooCheckout.trackConversion(false,form);mooCheckout.failedOrder(data.message)}}else{if(data.indexOf('"status":"success"')!==-1){mooCheckout.trackConversion(true,form);mooCheckout.successfulOrder("")}else{mooCheckout.trackConversion(false,form);mooCheckout.failedOrder("")}}}).fail(function(data){console.log("FAIL");console.log(data.responseText);if(data.responseText.indexOf('"status":"success"')!==-1){mooCheckout.trackConversion(true,form);mooCheckout.successfulOrder("")}else{mooCheckout.trackConversion(false,form);mooCheckout.failedOrder("")}})},sendCreateOrder:function(form){let headers={"Content-Type":"application/json"};if(this.isCustomerLoggedIn()){form.customer\_token=localStorage.getItem("customerJwtToken")}$.ajax({type:"POST",cache:false,url:sooCheckout.options.restApiUrl+"moo-clover/v2/checkout",headers:headers,data:JSON.stringify(form)}).done(function(data){if(typeof data=="object"){if(data.status==="success"){mooCheckout.trackConversion(true,form);mooCheckout.successfulOrder(data.id)}else{mooCheckout.trackConversion(false,form);mooCheckout.failedOrder(data.message)}}else{if(data.indexOf('"status":"success"')!==-1){mooCheckout.trackConversion(true,form);mooCheckout.successfulOrder("")}else{mooCheckout.trackConversion(false,form);mooCheckout.failedOrder("")}}}).fail(function(data){console.log("FAIL");console.log(data.responseText);if(data.responseText.indexOf('"status":"success"')!==-1){mooCheckout.trackConversion(true,form);mooCheckout.successfulOrder("")}else{mooCheckout.trackConversion(false,form);mooCheckout.failedOrder("")}})},successfulOrder:function(orderId){if(sooCheckout.options.thanksPage&&sooCheckout.options.thanksPage!==""){window.location.href=sooCheckout.options.thanksPage+"?order\_id="+orderId}else{let html='<div class="moo-alert moo-alert-success" role="alert" style="font-size: 20px;text-align: center">';html+=mooObjectL10n.thanksForOrder;html+="<br/>";html+=mooObjectL10n.orderBeingPrepared;if(orderId!==""){html+="<br>";html+=mooObjectL10n.seeReceipt;html+=sooCheckout.options.isSandbox?' <a href="https://sandbox.dev.clover.com/r/'+orderId+'" target="\_blank">':' <a href="https://www.clover.com/r/'+orderId+'" target="\_blank">';html+=mooObjectL10n.here;html+="</a>"}html+="</div>";$("#moo\_checkout\_msg").remove();$("#moo-checkout").html("");if(sooCheckout.delivery.moo\_merchantAddress!==""){$("#moo-checkout").parent().prepend("<div style='text-align: center'><p style='font-size: 21px;'>"+mooObjectL10n.ourAddress+" : </p>"+sooCheckout.delivery.moo\_merchantAddress+"</div>")}$("#moo-checkout").parent().prepend(html);$("html, body").animate({scrollTop:0},600)}},failedOrder:function(failureMessage){let html="";this.stopLoading();if(failureMessage&&failureMessage!==""&&failureMessage!==undefined){html='<div class="moo-alert moo-alert-danger" role="alert" id="moo\_checkout\_msg">'+failureMessage+"</div>"}else{html='<div class="moo-alert moo-alert-warning" role="alert" id="moo\_checkout\_msg"><strong>';html+=mooObjectL10n.cannotSendEntireOrder;html+="</strong></div>"}$("#moo-checkout .errors-section").html(html);$("html, body").animate({scrollTop:0},600)},getCustomerSelectedAddress:function(){return{}},getDeliveryFees:function(){return mooGlobalParams.deliveryFees},getServiceFees:function(){let fee=sooCheckout.options.feeAmount;if(fee){if(mooGlobalParams.selectedOrderType){if(mooCheckout.isTrue(mooGlobalParams.selectedOrderType.allow\_service\_fee)){if(sooCheckout.options.feeType==="amount"){return fee}else{return Math.round(fee\*sooCheckout.options.totals.sub\_total/100)}}}else{if($("#sooServiceFeeTotalSection").css("display")==="block"){if(sooCheckout.options.feeType==="amount"){return fee}else{return Math.round(fee\*sooCheckout.options.totals.sub\_total/100)}}}}return 0},createOnDemandDeliveryEstimate:function(){if(mooGlobalParams.selectedAddress){const addrElm=$("#moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses #soo-address-"+mooGlobalParams.selectedAddress.id);const loader=$("#moo-checkout-form-ordertypes div.soo-address-section > div.soo-list-of-addresses > div.soo-addresses-wrapper>.soo-estimate-loader");$("#moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses .soo-one-address").removeClass("soo-selected-error soo-selected-warning");$("#moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses .soo-one-address .soo-address-error").text("");$("#moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses .soo-one-address .soo-delivery-amount").text("");$(".soo-delivery-amount",addrElm).html('<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" class="BpkSpinner\_bpk-spinner\_\_NjNlZ BpkSpinner\_bpk-spinner--primary\_\_YTQxN"><rect width="4" height="2" y="7" opacity=".45" rx="1"></rect><rect width="4" height="2" x="12" y="7" rx="1"></rect><rect width="4" height="2" x="7" y="16" opacity=".3" rx="1" transform="rotate(-90 7 16)"></rect><rect width="4" height="2" x="7" y="4" opacity=".65" rx="1" transform="rotate(-90 7 4)"></rect><rect width="4" height="2" x="11.134" y="15.428" opacity=".25" rx="1" transform="rotate(-120 11.134 15.428)"></rect><rect width="4" height="2" x="5.134" y="5.036" opacity=".55" rx="1" transform="rotate(-120 5.134 5.036)"></rect><rect width="4" height="2" x="14.428" y="12.866" opacity=".2" rx="1" transform="rotate(-150 14.428 12.866)"></rect><rect width="4" height="2" x="4.036" y="6.866" opacity=".5" rx="1" transform="rotate(-150 4.036 6.866)"></rect><rect width="4" height="2" x="15.428" y="4.866" opacity=".85" rx="1" transform="rotate(150 15.428 4.866)"></rect><rect width="4" height="2" x="5.036" y="10.866" opacity=".4" rx="1" transform="rotate(150 5.036 10.866)"></rect><rect width="4" height="2" x="12.866" y="1.572" opacity=".75" rx="1" transform="rotate(120 12.866 1.572)"></rect><rect width="4" height="2" x="6.866" y="11.964" opacity=".35" rx="1" transform="rotate(120 6.866 11.964)"></rect></svg>');loader.show();let deliveryTime=(new Date).toISOString();if(mooGlobalParams.selectedTime){deliveryTime=mooGlobalParams.selectedTime}this.createDeliveryEstimate().then(response=>{if(!response.ok){$(".soo-delivery-amount",addrElm).text("");loader.hide();mooCheckout.unSelectAddress();if(mooGlobalParams.selectedAddress){mooGlobalParams.selectedAddress.isValid=false}throw new Error(mooObjectL10n.anErrorOccurred)}else{return response.json()}}).then(res=>this.displayDeliveryAmountForAddress(res)).catch(err=>{mooCheckout.showErrorAlert(err.message,"")})}},calculateDeliveryFees:function(lat,lng){var order\_total=parseFloat(sooCheckout.options.totals.sub\_total);const delivery\_free\_after=Math.round(parseFloat(sooCheckout.delivery.free\_amount)\*100);const delivery\_fixed\_amount=Math.round(parseFloat(sooCheckout.delivery.fixed\_amount)\*100);const delivery\_for\_other\_zone=Math.round(parseFloat(sooCheckout.delivery.other\_zone\_fee)\*100);let moo\_delivery\_areas=null;try{moo\_delivery\_areas=JSON.parse(sooCheckout.delivery.zones)}catch(e){console.log("Parsing error: moo\_delivery\_areas")}if(!isNaN(delivery\_fixed\_amount)){return{result:"success",amount:delivery\_fixed\_amount,message:null}}if(!(lat!==""&&lng!=="")){return{result:"zone\_error",amount:null,message:mooObjectL10n.deliveryZoneNotSupported}}else{var zones\_contain\_point=[];for(const i in moo\_delivery\_areas){var zone=moo\_delivery\_areas[i];if(zone.feeType==="percent"){zone.fee=parseFloat(zone.fee)}else{zone.fee=Math.round(parseFloat(zone.fee)\*100)}zone.minAmount=Math.round(parseFloat(zone.minAmount)\*100);if(zone.type==="polygon"){if(google.maps.geometry.poly.containsLocation(new google.maps.LatLng(parseFloat(lat),parseFloat(lng)),new google.maps.Polygon({paths:zone.path}))){zones\_contain\_point.push({zone\_id:zone.id,zone\_fee:zone.fee,feeType:zone.feeType,minAmount:zone.minAmount})}}if(zone.type==="circle"){var point=new google.maps.LatLng(parseFloat(lat),parseFloat(lng));var center=new google.maps.LatLng(parseFloat(zone.center.lat),parseFloat(zone.center.lng));if(google.maps.geometry.spherical.computeDistanceBetween(point,center)<=zone.radius){zones\_contain\_point.push({zone\_id:zone.id,zone\_fee:zone.fee,feeType:zone.feeType,minAmount:zone.minAmount})}}}if(zones\_contain\_point.length>=1){var delivery\_final\_amount=zones\_contain\_point[0].feeType==="percent"?zones\_contain\_point[0].zone\_fee\*order\_total/100:zones\_contain\_point[0].zone\_fee;var delivery\_zone\_id=zones\_contain\_point[0].zone\_id;var delivery\_zone\_minAmount=zones\_contain\_point[0].minAmount;for(const i in zones\_contain\_point){if(zones\_contain\_point[i].feeType==="percent"){const amount=parseFloat(zones\_contain\_point[i].zone\_fee)\*order\_total/100;if(delivery\_final\_amount>=amount){delivery\_final\_amount=amount;delivery\_zone\_id=zones\_contain\_point[i].zone\_id;delivery\_zone\_minAmount=zones\_contain\_point[i].minAmount}}else{if(delivery\_final\_amount>=zones\_contain\_point[i].zone\_fee){delivery\_final\_amount=zones\_contain\_point[i].zone\_fee;delivery\_zone\_id=zones\_contain\_point[i].zone\_id;delivery\_zone\_minAmount=zones\_contain\_point[i].minAmount}}}if(!isNaN(delivery\_zone\_minAmount)){if(delivery\_zone\_minAmount>sooCheckout.options.totals.sub\_total){return{result:"min\_error",amount:null,message:mooObjectL10n.minimumForDeliveryZone+parseFloat(delivery\_zone\_minAmount/100).toFixed(2)}}}if(isNaN(delivery\_free\_after)){return{result:"success",amount:delivery\_final\_amount,message:null}}else{var amountToAdd=delivery\_free\_after-order\_total;if(amountToAdd<=0){return{result:"success",amount:0,message:null}}else{Swal.fire({title:mooObjectL10n.spend+parseFloat(delivery\_free\_after/100).toFixed(2)+" "+mooObjectL10n.toGetFreeDelivery,text:"Add $"+parseFloat(amountToAdd/100).toFixed(2)+" to your order to enjoy free delivery",icon:"warning",showCancelButton:true,confirmButtonColor:"#6e7881",confirmButtonClass:"fontSizeLg",cancelButtonColor:"#DD6B55",confirmButtonText:mooObjectL10n.continueToCheckout,cancelButtonText:mooObjectL10n.continueShopping}).then(data=>{if(data.dismiss&&data.dismiss==="cancel"){if(sooCheckout.options.storeLink){window.location.href=sooCheckout.options.storeLink}else{window.history.back()}}});if(amountToAdd>0&&amountToAdd<delivery\_final\_amount){delivery\_final\_amount=amountToAdd}return{result:"success",amount:delivery\_final\_amount,message:null}}}}else{if(isNaN(delivery\_for\_other\_zone)){return{result:"zone\_error",amount:null,message:mooObjectL10n.deliveryZoneNotSupported}}else{return{result:"success",amount:delivery\_for\_other\_zone,message:null}}}}},formatPrice:function(priceInCentes){var p=priceInCentes/100;p=p.toFixed(2);return p.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,")},updateTotals:function(){const totals=sooCheckout.options.totals;if(totals===false){return}const deliveryAmount=this.getDeliveryFees();const serviceFee=this.getServiceFees();const discounts=this.getDiscountedAmount();this.startLoadingDeliveryFee();this.getOrderTotals(deliveryAmount+serviceFee,discounts,this.updateTotalsSection)},getTotals:function(){return{tipAmount:mooCheckout.getTipAmount(),deliveryAmount:mooCheckout.getDeliveryFees(),serviceFee:this.getServiceFees(),discounts:this.getDiscountedAmount(),couponAmount:mooGlobalParams.couponAmount,pointsAmount:mooGlobalParams.pointsAmount,grandTotal:mooGlobalParams.grandTotal,orderTaxable:mooCheckout.isOrderTaxable()}},updateTotalsSection:function(totals){mooGlobalParams.grandTotal=0;const tips\_amount=mooCheckout.getTipAmount();const delivery\_amount=mooCheckout.getDeliveryFees();const service\_fee=mooCheckout.getServiceFees();const discounts=mooCheckout.getDiscountedAmount();const orderTaxable=mooCheckout.isOrderTaxable();if(service\_fee===0){mooCheckout.hideServiceFeeAmount()}else{mooCheckout.showServiceFeeAmount();$("#sooServiceFeeTotalSection > .moo-totals-value").text(" $"+mooCheckout.formatPrice(service\_fee))}mooCheckout.stopLoadingDeliveryFee();if(discounts===0){$("#sooCouponTotalSection").hide();$("#sooPointsTotalSection").hide()}else{if(mooCheckout.canAcceptCoupons()&&mooGlobalParams.couponAmount){$("#sooCouponTotalSection").show();$("#sooCouponName").text(mooGlobalParams.couponName);$("#sooCouponValue").text(" -$"+mooCheckout.formatPrice(mooGlobalParams.couponAmount))}else{$("#sooCouponTotalSection").hide()}if(mooCheckout.canAcceptPoints()&&mooGlobalParams.pointsAmount){$("#sooPointsTotalSection").show();$("#sooPointslabel").text(mooGlobalParams.points+" "+mooGlobalParams.pointsLabel);$("#sooPointsValue").text(" -$"+mooCheckout.formatPrice(mooGlobalParams.pointsAmount))}else{$("#sooPointsTotalSection").hide()}}$(".moo-totals-value").fadeOut(300,function(){$("#moo-cart-subtotal").html("$"+mooCheckout.formatPrice(totals.sub\_total));$("#moo-cart-tip").html("$"+mooCheckout.formatPrice(tips\_amount));$("#moo-cart-delivery-fee").html("$"+mooCheckout.formatPrice(delivery\_amount));if(orderTaxable){if(discounts===0){mooGlobalParams.grandTotal=totals.sub\_total+totals.taxes+tips\_amount+delivery\_amount+service\_fee;$("#moo-cart-tax").html("$"+mooCheckout.formatPrice(totals.taxes));$("#moo-cart-total").html("$"+mooCheckout.formatPrice(mooGlobalParams.grandTotal))}else{mooGlobalParams.grandTotal=totals.sub\_total+totals.taxes\_after\_discount+tips\_amount+delivery\_amount+service\_fee-discounts;$("#moo-cart-tax").html("$"+mooCheckout.formatPrice(totals.taxes\_after\_discount));$("#moo-cart-total").html("$"+mooCheckout.formatPrice(mooGlobalParams.grandTotal))}}else{mooGlobalParams.grandTotal=totals.sub\_total+tips\_amount+delivery\_amount+service\_fee-discounts;$("#moo-cart-tax").html("0.00");$("#moo-cart-total").html("$"+mooCheckout.formatPrice(mooGlobalParams.grandTotal))}$(".moo-totals-value").fadeIn(300)})},getOrderTotals:function(charges,discounts,callback){$.ajax({type:"POST",cache:false,url:sooCheckout.options.restApiUrl+"moo-clover/v3/checkout/order\_totals",contentType:"application/json; charset=UTF-8",data:JSON.stringify({charges:charges,discounts:discounts})}).done(function(data){sooCheckout.options.totals=data;callback(data)}).fail(function(data){console.log("FAIL");console.log(data.responseText)})},showErrorAlert:function(title,message,focusOnElem=null){this.stopLoading();if(focusOnElem){Swal.fire({title:title,text:message,icon:"error"}).then(function(){setTimeout(function(){$(focusOnElem).focus()},500)})}else{Swal.fire({title:title,text:message,icon:"error"})}},showSuccessAlert:function(title,message,focusOnElem=null){this.stopLoading();if(focusOnElem){Swal.fire(title,message,"success").then(function(){setTimeout(function(){$(focusOnElem).focus()},500)})}else{Swal.fire(title,message,"success")}},stopLoading:function(){if(this.getSelectedPaymentMethod()==="googlepay"){$("#moo\_checkout\_loading").hide();$("#moo-cloverGooglePay").show()}else{$("#moo\_checkout\_loading").hide();$("#moo\_btn\_submit\_order").show()}},startLoadingDeliveryFee:function(){$("#sooDeliveryFeeTotalSection").addClass("moo-fade-in");$(".moo-totals-item-total").addClass("moo-fade-in")},stopLoadingDeliveryFee:function(){$("#sooDeliveryFeeTotalSection").removeClass("moo-fade-in");$(".moo-totals-item-total").removeClass("moo-fade-in")},trackConversion:function(status,form){if(typeof dataLayer!=="undefined"){try{if(status){dataLayer.push({event:"OrderCreated",amount:sooCheckout.options.totals.total/100,taxes:sooCheckout.options.totals.total\_of\_taxes/100,tips:form.tip\_amount/100,nbOfItems:sooCheckout.options.totals.nb\_items})}else{dataLayer.push({event:"OrderNotCreated",amount:sooCheckout.options.totals.total/100,taxes:sooCheckout.options.totals.total\_of\_taxes/100,tips:form.tip\_amount/100,nbOfItems:sooCheckout.options.totals.nb\_items})}}catch(e){console.log(e)}}},isTrue:function(param){return param===true||param===1||param==="1"||param==="true"},changeOrderingTimes:function(type){var dayInput=$("#moo\_pickup\_day");var hoursInput=$("#moo\_pickup\_hour");var html\_days="";var html\_hours="";let times=null;if(type==="pickup"){if(sooCheckout.options.pickupTimes===null){$("#moo-checkout-form-orderdate .extra-info").html("There are no time slots available. Please try again later. Thank you for your understanding and patience.");return}for(let i in sooCheckout.options.pickupTimes){html\_days+='<option value="'+i+'">'+i+"</option>"}times=sooCheckout.options.pickupTimes[Object.keys(sooCheckout.options.pickupTimes)[0]]}if(type==="delivery"){if(sooCheckout.options.deliveryTimes===null){$("#moo-checkout-form-orderdate .extra-info").html("There are no time slots available. Please try again later. Thank you for your understanding and patience.");return}for(var i in sooCheckout.options.deliveryTimes){html\_days+='<option value="'+i+'">'+i+"</option>"}times=sooCheckout.options.deliveryTimes[Object.keys(sooCheckout.options.deliveryTimes)[0]]}if(times){html\_hours+='<option value="Select a time">Select a time</option>';for(let i in times){html\_hours+='<option value="'+times[i]+'">'+times[i]+"</option>"}}else{html\_hours=""}hoursInput.html(html\_hours);dayInput.html(html\_days)},updateSelectedTime:function(){const day=$("#moo\_pickup\_day").val();let time=$("#moo\_pickup\_hour").val();if(day!==""){if(time==="ASAP"){}if(time!==""&&time!=="Select a time"){const today=new Date;let str="";if(day==="Today"){str=today.toDateString()}else{str=day+" "+today.getFullYear()}if(time==="ASAP"){time=today.toTimeString()}str+=" "+time.substring(0,time.length-2)+":00 "+time.substring(time.length-2,time.length);~~console.log(str);~~let selectedDay=new Date(str);mooGlobalParams.selectedTime=selectedDay;if(mooGlobalParams.selectedOrderType&&mooGlobalParams.selectedOrderType.ot\_uuid==="onDemandDelivery"){this.createOnDemandDeliveryEstimate()}return}}mooGlobalParams.selectedTime=null},getDiscountedAmount:function(){let discounts=0;if(this.canAcceptCoupons()&&mooGlobalParams.couponAmount){discounts+=mooGlobalParams.couponAmount}if(this.canAcceptPoints()&&mooGlobalParams.pointsAmount){discounts+=mooGlobalParams.pointsAmount}return discounts},createDeliveryEstimate:function(){let deliveryTime=(new Date).toISOString();if(mooGlobalParams.selectedTime){deliveryTime=mooGlobalParams.selectedTime}const url=sooCheckout.options.restApiUrl+"moo-clover/v3/delivery-estimate";return fetch(url,{method:"POST",mode:"cors",cache:"no-cache",credentials:"same-origin",headers:{"Content-Type":"application/json"},redirect:"follow",referrerPolicy:"no-referrer",body:JSON.stringify({dropoff\_address:{street:mooGlobalParams.selectedAddress.address,unit:mooGlobalParams.selectedAddress.line2,city:mooGlobalParams.selectedAddress.city,state:mooGlobalParams.selectedAddress.state,zip\_code:mooGlobalParams.selectedAddress.zipcode},order\_value:sooCheckout.options.totals.sub\_total,delivery\_time:deliveryTime})})},displayDeliveryAmountForAddress:function(res){if(!mooGlobalParams.selectedAddress){return}$("#moo-checkout-form-ordertypes div.soo-address-section > div.soo-list-of-addresses > div.soo-addresses-wrapper>.soo-estimate-loader").hide();const addrElm=$("#moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses #soo-address-"+mooGlobalParams.selectedAddress.id);$(".soo-delivery-amount",addrElm).text("");if(res.status==="success"){$(addrElm).addClass("soo-selected");let deliveryAmount;mooGlobalParams.selectedAddress.isValid=true;if(res.minAmount&&res.minAmount>0&&res.minAmount>sooCheckout.options.totals.sub\_total){const message=mooObjectL10n.minimumForDeliveryZone+parseFloat(res.minAmount/100).toFixed(2);mooCheckout.unSelectAddress();addrElm.addClass("soo-selected-warning");$(".soo-address-error",addrElm).text(message);mooGlobalParams.deliveryFees=null}if(res.freeAfter&&res.freeAfter>0&&res.freeAfter<=sooCheckout.options.totals.sub\_total){mooGlobalParams.deliveryFees=0;deliveryAmount="Free"}else{if(res.fee>0){mooGlobalParams.deliveryFees=res.fee;deliveryAmount=parseFloat(res.fee/100).toFixed(2);deliveryAmount="+ $"+deliveryAmount}else{mooGlobalParams.deliveryFees=0;deliveryAmount="Free"}}$(".soo-delivery-amount",addrElm).text(deliveryAmount)}else{mooGlobalParams.selectedAddress.isValid=false;mooCheckout.unSelectAddress()}if(res.status==="failed"){if(res.code==="zone\_not\_supported"){addrElm.addClass("soo-selected-error");$(".soo-address-error",addrElm).text(res.message);mooGlobalParams.deliveryFees=null}if(["min\_amount\_not\_valid","delivery\_time\_not\_valid"].includes(res.code)){addrElm.addClass("soo-selected-warning");$(".soo-address-error",addrElm).text(res.message);mooGlobalParams.deliveryFees=null}}mooCheckout.updateTotals()},applyCoupon:function(showError=true){const btnRemove=$("#moo-checkout-form-coupon div > button.sooDeleteCouponButton.sooCheckoutPrimaryButtonInput");const btn=$("#moo-checkout-form-coupon div > button.sooApplyCouponButton.sooCheckoutPrimaryButtonInput");const btnTxt=btn.html();btn.html('<div class="dot-flashing"></div>');mooGlobalParams.couponCode=$("#moo\_coupon").val();if(mooGlobalParams.couponCode){mooGlobalParams.couponCode=mooGlobalParams.couponCode.trim();this.getCouponByCode(mooGlobalParams.couponCode).then(res=>{if(res.ok){return res.json()}throw new Error(mooObjectL10n.anErrorOccurred)}).then(res=>{if(res.status==="success"&&res.coupon){let discountAmount=0;const minValue=Math.round(parseFloat(res.coupon.minAmount)\*100);const maxValue=Math.round(parseFloat(res.coupon.maxValue)\*100);if(sooCheckout.options.totals.sub\_total<=0||typeof sooCheckout.options.totals.sub\_total===undefined){throw new Error(mooObjectL10n.cartEmpty)}else{if(!isNaN(minValue)){if(sooCheckout.options.totals.sub\_total<minValue){throw new Error("Minimum order amount to use this coupon is $"+this.formatPrice(minValue))}}}if(res.coupon.type.toUpperCase()==="AMOUNT"){discountAmount=Math.round(parseFloat(res.coupon.value)\*100);mooGlobalParams.couponName=res.coupon.name}else{discountAmount=Math.round(parseFloat(res.coupon.value)\*sooCheckout.options.totals.sub\_total/100);mooGlobalParams.couponName=res.coupon.name}mooGlobalParams.couponAmount=Math.min(sooCheckout.options.totals.sub\_total,discountAmount);if(!isNaN(maxValue)){if(mooGlobalParams.couponAmount>maxValue){mooGlobalParams.couponAmount=maxValue}}this.updateTotals();if(this.canAcceptPoints()&&mooGlobalParams.points>0){if(this.getOrderTotal()<0){this.clickOnRemovePoints();const additionalMsg=` and your previously used loyalty ${mooGlobalParams.pointsLabel} have been reset. Please take a moment to use review them again`;const txt=mooObjectL10n.receivedDiscountUSD+this.formatPrice(mooGlobalParams.couponAmount)+additionalMsg;this.showSuccessAlert(mooObjectL10n.couponApplied,txt)}}else{const txt=mooObjectL10n.receivedDiscountUSD+this.formatPrice(mooGlobalParams.couponAmount);this.showSuccessAlert(mooObjectL10n.couponApplied,txt)}btn.html(btnTxt).hide();$("#moo\_coupon").attr("readonly",true).attr("disabled",true);btnRemove.show()}else{if(showError){throw new Error(res.message)}else{$("#moo\_coupon").val("");btn.html(btnTxt)}}}).catch(err=>{this.showErrorAlert(mooObjectL10n.error,err.message);btn.html(btnTxt)})}else{this.showErrorAlert(mooObjectL10n.error,mooObjectL10n.enterCouponCode,"#moo\_coupon");btn.html(btnTxt)}},removeCoupon:function(){const btnApply=$("#moo-checkout-form-coupon div > button.sooApplyCouponButton.sooCheckoutPrimaryButtonInput");const btn=$("#moo-checkout-form-coupon div > button.sooDeleteCouponButton.sooCheckoutPrimaryButtonInput");const btnTxt=btn.html();btn.html('<div class="dot-flashing"></div>');mooGlobalParams.couponCode=null;mooGlobalParams.couponAmount=null;mooGlobalParams.couponName=null;this.updateTotals();btn.html(btnTxt);btn.hide();btnApply.show();$("#moo\_coupon").val("").attr("readonly",false).attr("disabled",false)},clickOnUsePoints:function(){$("#moo-checkout-form-loyalty .loyaltyButtons > .sooUsePointsButton").hide();$("#moo-checkout-form-loyalty .loyaltyButtons > .sooRemovePointsButton").show();$("#moo-checkout-form-loyalty .usePointsInput").show();this.setLoyaltyError("");$("#moo-checkout-form-loyalty .usePointsInput .sooValidatePoints .sooValidatePointsButton").show();$("#moo-checkout-form-loyalty .usePointsInput .sooValidatePoints .sooEditPointsButton").hide();$("#sooSelectedPointsValue").attr("disabled",false).attr("readonly",false)},clickOnRemovePoints:function(){this.removePoints();$("#moo-checkout-form-loyalty .loyaltyButtons > .sooUsePointsButton").show();$("#moo-checkout-form-loyalty .loyaltyButtons > .sooRemovePointsButton").hide();$("#moo-checkout-form-loyalty .usePointsInput").hide();this.updateTotalsSection(sooCheckout.options.totals)},changePointsValue:function(){this.setLoyaltyError("");const points=$("#sooSelectedPointsValue").val();if(points.match(/^[0-9]+$/)&&points>0){const maxAllowed=this.getMaxPointsAllowed();const amount=this.getValueOfPoints(points);if(amount>0){const elm=$("#moo-checkout-form-loyalty > div.moo-checkout-bloc-content > div.moo-row.usePointsInput  .sooToPayInfo > .sooToPayAmount");elm.html("$"+this.formatPrice(amount))}if(maxAllowed<points){if(maxAllowed===0){this.setLoyaltyError(`${mooGlobalParams.pointsLabel} can't be used for this order.`)}else{this.setLoyaltyError("The maximum number of "+mooGlobalParams.pointsLabel+" that can be used is "+maxAllowed)}}}else{this.setLoyaltyError("Not a valid number")}},usePoints:function(){this.setLoyaltyError("");const points=$("#sooSelectedPointsValue").val();if(points.match(/^[0-9]+$/)&&points>0){const customer=this.getLoggedInCustomer();const settings=this.getLoyaltySettings();const maxAllowed=this.getMaxPointsAllowed();if(!customer||!settings){this.setLoyaltyError("Your session has been expired, please refresh the page");return}if(customer.point\_count<points){this.setLoyaltyError("Insufficient balance");return}if(settings.min\_points\_to\_order&&settings.min\_points\_to\_order>points){this.setLoyaltyError("The store owner has set a minimum requirement of "+settings.min\_points\_to\_order+" "+mooGlobalParams.pointsLabel+" per order.");return}if(settings.min\_amount\_to\_up&&settings.min\_amount\_to\_up>sooCheckout.options.totals.sub\_total){this.setLoyaltyError("Minimum order amount to use points is $"+this.formatPrice(settings.min\_amount\_to\_up));return}if(maxAllowed<points){if(maxAllowed===0){this.setLoyaltyError(`${mooGlobalParams.pointsLabel} can't be used for this order.`)}else{this.setLoyaltyError("The maximum number of "+mooGlobalParams.pointsLabel+" that can be used is "+maxAllowed)}return}mooGlobalParams.points=points;mooGlobalParams.pointsAmount=Math.min(this.getValueOfPoints(points),this.getSubTotalWithoutCoupons());this.updateTotals();$("#moo-checkout-form-loyalty .usePointsInput .sooValidatePoints .sooValidatePointsButton").hide();$("#moo-checkout-form-loyalty .usePointsInput .sooValidatePoints .sooEditPointsButton").show();$("#sooSelectedPointsValue").attr("disabled",true).attr("readonly",true)}else{this.setLoyaltyError("Not a valid number")}},editPoints:function(){mooGlobalParams.points=null;mooGlobalParams.pointsAmount=null;this.setLoyaltyError("");$("#moo-checkout-form-loyalty .usePointsInput .sooValidatePoints .sooValidatePointsButton").show();$("#moo-checkout-form-loyalty .usePointsInput .sooValidatePoints .sooEditPointsButton").hide();$("#sooSelectedPointsValue").attr("disabled",false).attr("readonly",false);this.updateTotalsSection(sooCheckout.options.totals)},setLoyaltyError:function(err){$("#moo-checkout-form-loyalty > div.moo-checkout-bloc-content > div.moo-row.usePointsInput .moo-error-section").html(err).show()},openLoyaltyDetails:function(){const settings=this.getLoyaltySettings();const maxPointsAllowed=this.getMaxPointsAllowed();const earningMsg=this.getEarningMessage();if(!settings){this.showErrorAlert(mooObjectL10n.error,mooObjectL10n.anErrorOccurred);return}let htmlDiv='<div class="soo-loyalty-conditions"><div class="moo-row"><div class="moo-col-md-12"><ul>';htmlDiv+=`<li>- Get $${this.formatPrice(settings.per\_x\_usd)} discount when redeeming ${settings.nb\_points} ${mooGlobalParams.pointsLabel}</li>`;if(settings.purchase\_usd\_value){if(settings.calc\_method==="subtotal"){htmlDiv+=`<li>- Earn ${settings.purchase\_usd\_value} ${mooGlobalParams.pointsLabel} for every dollar spent (based on Subtotal).</li>`}else{htmlDiv+=`<li>- Earn ${settings.purchase\_usd\_value} ${mooGlobalParams.pointsLabel} for every dollar spent.</li>`}}else{htmlDiv+=`<li>- Earn ${settings.purchase\_fixed\_points} ${mooGlobalParams.pointsLabel} on each order placed.</li>`}if(settings.order\_source.website===false){htmlDiv+=`<li>- ${mooGlobalParams.pointsLabel} not earned for purchases made through our website, try our Mobile App.</li>`}if(settings.max\_points\_per\_order){htmlDiv+=`<li>- Maximum of ${settings.max\_points\_per\_order} ${mooGlobalParams.pointsLabel} can be earned per order.</li>`}if(settings.min\_points\_to\_order){htmlDiv+=`<li>- Minimum requirement of ${settings.min\_points\_to\_order} ${mooGlobalParams.pointsLabel} should be used per order.</li>`}if(settings.min\_amount\_to\_up){htmlDiv+=`<li>- Minimum order amount required to use ${mooGlobalParams.pointsLabel} is $${this.formatPrice(settings.min\_amount\_to\_up)}</li>`}const subTotalWithoutCoupons=this.getSubTotalWithoutCoupons();const maxPercent=settings.percent\_to\_cover?settings.percent\_to\_cover:100;htmlDiv+=`<li>- ${mooGlobalParams.pointsLabel} can cover up to ${maxPercent}% of $${this.formatPrice(subTotalWithoutCoupons)} (Subtotal - Coupon)</li>`;if(maxPointsAllowed>0){htmlDiv+=`<li>- Maximum of ${maxPointsAllowed} ${mooGlobalParams.pointsLabel} can be used for this order.</li>`}else{htmlDiv+=`<li>- ${mooGlobalParams.pointsLabel} can't be used for this order.</li>`}htmlDiv+=`<li>- <b>${earningMsg}</b></li>`;htmlDiv+="</ul></div></div></div>";Swal.fire({imageUrl:null,title:"Loyalty Conditions",html:htmlDiv,showCancelButton:false,allowOutsideClick:true}).then(function(){setTimeout(p=>$(".sooLoyaltyDetailsButton").focus(),500)})},removePoints:function(){mooGlobalParams.points=null;mooGlobalParams.pointsAmount=null;this.setLoyaltyError("");$("#sooSelectedPointsValue").val(0);$("#moo-checkout-form-loyalty > div.moo-checkout-bloc-content > div.moo-row.usePointsInput .sooToPayInfo > .sooToPayAmount").html("$0.00");this.updateTotalsSection(sooCheckout.options.totals)},getCouponByCode:function(code){const url=sooCheckout.options.restApiUrl+"moo-clover/v2/checkout/check\_coupon";return fetch(url,{method:"POST",mode:"cors",cache:"no-cache",credentials:"same-origin",headers:{"Content-Type":"application/json"},redirect:"follow",referrerPolicy:"no-referrer",body:JSON.stringify({code:code})})},canAcceptCoupons:function(){if(mooGlobalParams.selectedOrderType){return this.isTrue(mooGlobalParams.selectedOrderType.use\_coupons)}return true},canAcceptPoints:function(){if(mooGlobalParams.isGuest){return false}return sooCheckout.options.loyaltySetting!==null},isOrderTaxable:function(){if(mooGlobalParams.selectedOrderType&&!mooCheckout.isTrue(mooGlobalParams.selectedOrderType.taxable)){return false}return true},showCheckoutDetails:function(){this.changeElemVisibility("#sooAuthSection","hide");this.showOrHideASection("checkout-form",true);this.fillCustomerInfo();if(this.canAcceptPoints()){this.changeElemVisibility("#moo-checkout-form-loyalty","show");this.fillCustomerPointsBalance()}else{this.changeElemVisibility("#moo-checkout-form-loyalty","hide")}if(this.countAvailableOrderingMethods()===1){$('#moo-checkout-form-ordertypes input[name="ordertype"]:not(:disabled)').prop("checked",true);this.orderTypeChanged()}if(this.countAvailablePaymentMethods()===1){$('#moo-checkout-form-payments input[name="paymentMethod"]:not(:disabled)').prop("checked",true);this.paymentMethodChanged()}this.tipPercentageChanged();if(localStorage.getItem("soo-coupon")){$("#moo\_coupon").val(localStorage.getItem("soo-coupon"));mooCheckout.applyCoupon(false)}},getValueOfPoints:function(points){const settings=this.getLoyaltySettings();if(settings){return Math.round(points\*settings.per\_x\_usd/settings.nb\_points)}return 0},getLoyaltySettings:function(){return sooCheckout.options.loyaltySetting},getMaxPointsAllowed:function(){let customer=this.getLoggedInCustomer();if(customer){let percentAmount=100;const subTotalWithoutCoupons=this.getSubTotalWithoutCoupons();const settings=this.getLoyaltySettings();if(settings){if(!isNaN(parseInt(settings.percent\_to\_cover))){percentAmount=parseInt(settings.percent\_to\_cover)}}else{return 0}const amountToCover=subTotalWithoutCoupons\*percentAmount/100;const requiredPoints=Math.ceil(amountToCover\*settings.nb\_points/settings.per\_x\_usd);return Math.min(requiredPoints,customer.point\_count)}return 0},getEarningMessage:function(){let willBeEarned=0;const orderAmount=this.getOrderTotal();const settings=this.getLoyaltySettings();if(settings){if(settings.order\_source.website!==false){if(settings.purchase\_usd\_value){if(settings.calc\_method==="subtotal"){willBeEarned=Math.round(settings.purchase\_usd\_value\*sooCheckout.options.totals.sub\_total/100)}else{willBeEarned=Math.round(settings.purchase\_usd\_value\*orderAmount/100)}}else{willBeEarned=settings.purchase\_fixed\_points}if(!settings.earn\_on\_all\_order){if(mooGlobalParams.points>0){willBeEarned=0}}}if(willBeEarned>0){return`By placing this order you will earn ${willBeEarned} ${mooGlobalParams.pointsLabel}.`}else{return`No ${mooGlobalParams.pointsLabel} will be earned for this order.`}}else{return`<li>${mooGlobalParams.pointsLabel} can't be earned for this order.</li>`}},getSubTotalWithoutCoupons:function(){if(this.canAcceptCoupons()&&mooGlobalParams.couponAmount){return sooCheckout.options.totals.sub\_total-mooGlobalParams.couponAmount}else{return sooCheckout.options.totals.sub\_total}},getOrderTotal:function(){const cartTotals=sooCheckout.options.totals;const totals=mooCheckout.getTotals();let taxAmount=0;if(totals.orderTaxable){if(totals.discounts===0){taxAmount=cartTotals.taxes}else{taxAmount=cartTotals.taxes\_after\_discount}}return cartTotals.sub\_total+taxAmount+totals.deliveryAmount+totals.serviceFee-totals.discounts}};window.moo\_clover\_gateway={mountElements:function(){if(sooCheckout.options.creditCard){if($("#moo\_CloverCardNumber").length){window.clover\_card.mount("#moo\_CloverCardNumber");window.clover\_exp.mount("#moo\_CloverCardDate");window.clover\_cvc.mount("#moo\_CloverCardCvv");window.clover\_zip.mount("#moo\_CloverCardZip");if(window.clover\_streetAddress){window.clover\_streetAddress.mount("#moo\_CloverStreetAddress")}}}if(sooCheckout.options.giftCards){if($("#moo\_CloverGiftCard").length){window.clover\_giftCard.mount("#moo\_CloverGiftCard")}}if(sooCheckout.options.googlePay){if($("#moo-cloverGooglePay").length){window.clover\_googlepay.mount("#moo-cloverGooglePay")}}},createElements:function(){const elementStyles={input:{color:"#31325F",height:"30px","::placeholder":{color:"#CFD7E0"}}};if(sooCheckout.options.creditCard){window.clover\_card=window.elements.create("CARD\_NUMBER",elementStyles);window.clover\_exp=window.elements.create("CARD\_DATE",elementStyles);window.clover\_cvc=window.elements.create("CARD\_CVV",elementStyles);window.clover\_zip=window.elements.create("CARD\_POSTAL\_CODE",elementStyles);window.clover\_card.addEventListener("change",function(event){moo\_clover\_gateway.onCCFormChange();$(document.body).trigger("cloverError",event)});window.clover\_exp.addEventListener("change",function(event){moo\_clover\_gateway.onCCFormChange();$(document.body).trigger("cloverError",event)});window.clover\_cvc.addEventListener("change",function(event){moo\_clover\_gateway.onCCFormChange();$(document.body).trigger("cloverError",event)});window.clover\_zip.addEventListener("change",function(event){moo\_clover\_gateway.onCCFormChange();$(document.body).trigger("cloverError",event)});if(sooCheckout.options.showStreetAddressField){window.clover\_streetAddress=window.elements.create("CARD\_STREET\_ADDRESS",elementStyles);window.clover\_streetAddress.addEventListener("change",function(event){moo\_clover\_gateway.onCCFormChange();$(document.body).trigger("cloverError",event)})}}if(sooCheckout.options.giftCards){const giftCardStyles={input:{"border-radius":"5px",height:"45px",padding:"10px",color:"#31325F",border:"1px solid #ccc","::placeholder":{color:"#CFD7E0"}},body:{margin:"0;",border:"0.7px solid #B8B8B8FF;","border-radius":"10px;",padding:"10px;",width:"96%;","overflow-x":" hidden;"},".fieldError input":{"border-color":"red",color:"red"},".errorMessage":{color:"red","min-height":"10px;"},".sectionHeader":{display:"none"}};window.clover\_giftCard=window.elements.create("GIFT\_CARD\_ELEMENTS",giftCardStyles);window.clover\_giftCard.addEventListener("change",function(event){moo\_clover\_gateway.onGiftCardChange(event);$(document.body).trigger("cloverGiftCardError",event)})}if(sooCheckout.options.googlePay){const paymentReqData={total:{label:"Online Order",amount:sooCheckout.options.totals.sub\_total},options:{button:{buttonType:"long"}}};window.clover\_googlepay=window.elements.create("PAYMENT\_REQUEST\_BUTTON",{paymentReqData:paymentReqData});window.clover\_googlepay.addEventListener("paymentMethod",function(tokenData){window.googlePayToken=tokenData;try{$("#moo-cloverGooglePay").hide();$("#moo\_checkout\_loading").show();$("#moo-checkout .errors-section").html("");window.mooCheckout.getCheckoutForm()}catch(e){console.log(e);window.mooCheckout.showErrorAlert(mooObjectL10n.anErrorOccurred)}})}window.moo\_clover\_gateway.mountElements()},init:function(){$(document).on("cloverError",this.onError).on("cloverGiftCardError",this.onGiftCardError).on("checkout\_error",this.reset);moo\_clover\_gateway.createElements()},isMobile:function(){if(/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)){return true}return false},getSelectedPaymentElement:function(){return $('.payment\_methods input[name="payment\_method"]:checked')},createSource:function(){return clover.createToken().then(moo\_clover\_gateway.sourceResponse)},sourceResponse:function(response){if(response.error){return $(document.body).trigger("cloverError",response)}moo\_clover\_gateway.reset();$("#moo-CloverToken").val(response.token)},onCCFormChange:function(){},onGiftCardChange:function(e){console.log("onGiftCardChange");console.log(e)},reset:function(){if(!$("#moo-checkout-form-payments #moo-cloverCreditCardPanel .clover-error").length){}},onError:function(e,result){var hasError=false;var errorMessage="";if(result.CARD\_NUMBER.error){errorMessage=result.CARD\_NUMBER.error;hasError=true}else{if(result.CARD\_DATE.error){errorMessage=result.CARD\_DATE.error;hasError=true}else{if(result.CARD\_CVV.error){errorMessage=result.CARD\_CVV.error;hasError=true}else{if(result.CARD\_STREET\_ADDRESS&&result.CARD\_STREET\_ADDRESS.error){errorMessage=result.CARD\_STREET\_ADDRESS.error;hasError=true}else{if(result.CARD\_POSTAL\_CODE.error){errorMessage=result.CARD\_POSTAL\_CODE.error;hasError=true}}}}}window.cloverCardIsValid=!hasError;window.cloverCardErrorMsg=errorMessage;try{if(errorMessage===""){errorMessage=!result.CARD\_NUMBER.touched?mooObjectL10n.CardNumberRequired:!result.CARD\_DATE.touched?mooObjectL10n.CardDateRequired:!result.CARD\_CVV.touched?"Card Cvv is required":result.CARD\_STREET\_ADDRESS&&!result.CARD\_STREET\_ADDRESS.touched?mooObjectL10n.CardStreetAddressRequired:!result.CARD\_POSTAL\_CODE.touched?mooObjectL10n.CardZipRequired:window.cloverCardErrorMsg}if(errorMessage!==window.cloverCardErrorMsg){window.cloverCardIsValid=false;window.cloverCardErrorMsg=errorMessage}}catch(e){console.log(e)}},onGiftCardError:function(e,result){console.log(result);window.cloverGiftCardIsValid=result?.GIFT\_CARD\_ELEMENTS?.isFormValid;console.log(window.cloverGiftCardIsValid)},submitError:function(error\_message){}};$(document).ready(function(){window.mooCheckout.init();if(sooCheckout.options.pakmsKey){try{window.clover=new Clover(sooCheckout.options.pakmsKey,{locale:sooCheckout.options.locale});window.elements=window.clover.elements();window.cloverCardIsValid=false;window.cloverGiftCardIsValid=false;window.cloverCardErrorMsg=mooObjectL10n.CardNumberRequired;window.moo\_clover\_gateway.init()}catch(error){console.log(error)}}})}); |
  |  | 29 | </div></div>`;Swal.fire({title:"Edit Your Profile",html:form,showCancelButton:true,cancelButtonText:mooObjectL10n.cancel,confirmButtonText:mooObjectL10n.edit,showLoaderOnConfirm:true,preConfirm:()=>{const firstName=Swal.getPopup().querySelector("#sooContactFirstName").value;const lastName=Swal.getPopup().querySelector("#sooContactLastName").value;const email=Swal.getPopup().querySelector("#sooContactEmail").value;const phone=Swal.getPopup().querySelector("#sooContactPhone").value;if(firstName===""){Swal.showValidationMessage("Your name is required");return}if(email===""){Swal.showValidationMessage("Your email is required");return}if(phone===""){Swal.showValidationMessage("Your phone is required");return}const token=localStorage.getItem("customerJwtToken");return fetch(sooCheckout.options.restApiUrl+"moo-clover/v2/customers/me",{method:"POST",mode:"cors",cache:"no-cache",credentials:"same-origin",headers:{"Content-Type":"application/json",Authorization:"Bearer "+token},redirect:"follow",referrerPolicy:"no-referrer",body:JSON.stringify({email:email,first\_name:firstName,last\_name:lastName,phone:phone})}).then(response=>{return response.json()}).then(data=>{if(data.message){throw new Error(data.message)}else{if(data===false){throw new Error(mooObjectL10n.anErrorOccurred)}return data}}).catch(error=>{Swal.showValidationMessage(error)})},allowOutsideClick:false}).then(function(data){if(data.value){localStorage.setItem("loggedInCustomer",JSON.stringify(data.value));mooCheckout.loggedInCustomer=data.value;mooCheckout.fillCustomerInfo()}},function(data){if(data.dismiss==="cancel"){Swal.close()}})},logout:function(e){e.preventDefault();mooCheckout.loggedInCustomer=null;mooCheckout.loggedInCustomer=null;localStorage.removeItem("customerJwtToken");localStorage.removeItem("loggedInCustomer");this.uncheckSelectedOrderingMethod();this.uncheckSelectedPaymentMethod();this.updateTotals();this.showLoginSection();return false},continueAsGuest:function(e){e.preventDefault();mooGlobalParams.isGuest=true;history.pushState({},"Checkout");this.showCheckoutDetails();return false},hideLoadingCheckout(){$("#moo-checkout>#moo-login-section > div.sooOverlayLoader").hide()},showOrHideASection(section,show){$("div.moo-section").hide();const elem=$("#moo-"+section);if(show){elem.show()}else{elem.hide()}},showLoginSection(section,show){$("#sooAuthSection").show();$("div.moo-section").hide();$("#moo-login-section").show()},isCustomerLoggedIn(){return localStorage.getItem("customerJwtToken")!==null},getLoggedInCustomer(){if(localStorage.getItem("loggedInCustomer")){let customer=JSON.parse(localStorage.getItem("loggedInCustomer"));mooCheckout.loggedInCustomer=customer;return customer}return null},getGuestInfo(){const firstName=$("#MooContactFirstName").val();const lastName=$("#MooContactLastName").val();const email=$("#MooContactEmail").val();const phone=$("#MooContactPhone").val();return{first\_name:firstName.trim(),last\_name:lastName.trim(),email:email.trim(),phone:phone.trim(),isPhoneVerified:mooGlobalParams.isGuestPhoneVerified,address:this.getSelectedAddress(),full\_address:this.getSelectedAddressAsString()}},syncLoggedInCustomerProfile(){this.getCustomerProfile().then(async function(response){if(!response.ok){const message=`An error has occured: ${response.status}`;throw new Error(message)}return await response.json()}).then(data=>{localStorage.setItem("loggedInCustomer",JSON.stringify(data));mooCheckout.loggedInCustomer=data}).catch(error=>{console.log(error)})},getCustomerProfile(){let token=localStorage.getItem("customerJwtToken");return fetch(sooCheckout.options.restApiUrl+"moo-clover/v2/customers/me",{method:"GET",mode:"cors",cache:"no-cache",headers:{"Content-Type":"application/json",Authorization:"Bearer "+token},redirect:"follow",referrerPolicy:"no-referrer"})},fillCustomerInfo(){if(mooGlobalParams.isGuest){$("#moo-checkout-contact-form").show();$("#moo-checkout-contact-content").hide()}else{let customer=this.getLoggedInCustomer();if(customer){let name=null;if(customer.first\_name){name=customer.first\_name}if(customer.last\_name){name+=" "+customer.last\_name}if(!name){name=" "+customer.full\_name}$("#moo-checkout-contact-content .soo-contact-info-name").text(name);if(customer.is\_email\_verified){$("#moo-checkout-contact-content .soo-contact-info-email").text(customer.email+" ✓ ")}else{$("#moo-checkout-contact-content .soo-contact-info-email").text(customer.email)}if(customer.is\_phone\_verified){$("#moo-checkout-contact-content .soo-contact-info-phone").text(customer.phone+" ✓ ")}else{if(customer.phone===""){$("#moo-checkout-contact-content .soo-contact-info-phone").text("Phone not provided")}else{$("#moo-checkout-contact-content .soo-contact-info-phone").text(customer.phone)}}$("#moo-checkout-contact-form").hide();$("#moo-checkout-contact-content").show()}else{console.log("Can't get the customer, he must login again");this.showLoginSection()}}},fillCustomerPointsBalance(){let customer=this.getLoggedInCustomer();if(customer){let balance=0;let balanceUsdValue=0;if(customer.point\_count){balance=customer.point\_count;balanceUsdValue=this.getValueOfPoints(balance)}$("#moo-checkout-form-loyalty .loyaltyBalance > div.balance > span.balancePoints").text(balance+" "+mooGlobalParams.pointsLabel);$("#moo-checkout-form-loyalty .loyaltyBalance > div.balance > span.balanceAmount").text(this.formatPrice(balanceUsdValue));if(balance<=0){$("#moo-checkout-form-loyalty .loyaltyButtons > button.sooUsePointsButton").html("Loyalty Conditions").attr("onclick","mooCheckout.openLoyaltyDetails()").css("padding","2px");$("#moo-checkout-form-loyalty .loyaltyButtons").removeClass("moo-col-xs-4").addClass("moo-col-xs-6");$("#moo-checkout-form-loyalty .loyaltyBalance").removeClass("moo-col-xs-6").addClass("moo-col-xs-4")}}else{console.log("Can't get the customer, he must login again")}},shouldVerifyPhone:function(){if(!sooCheckout.options.useSmsVerification){return false}else{if(mooGlobalParams.isGuest){return mooGlobalParams.isGuestPhoneVerified===false}else{const customer=this.getLoggedInCustomer();if(customer){return customer.is\_phone\_verified===false}else{this.syncLoggedInCustomerProfile();return true}}}},loggedInCustomerPhoneIsVerified:function(){const customer=this.getLoggedInCustomer();if(customer){return customer.is\_phone\_verified}else{this.syncLoggedInCustomerProfile();return false}},isMobile:function(){if(/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)){return true}return false},getSelectedPaymentMethod:function(){var elm=$('#moo-checkout-form-payments input[name="paymentMethod"]:checked');if(elm.length>0&&elm.val()!==""){return elm.val()}return null},getSelectedOrderingMethod:function(){var elm=$('#moo-checkout-form-ordertypes input[name="ordertype"]:checked');if(elm.length){return elm.val()}return null},countAvailableOrderingMethods:function(){const elmOrderingMethods=$('#moo-checkout-form-ordertypes input[name="ordertype"]');const elmDisabledOrderingMethods=$('#moo-checkout-form-ordertypes input[name="ordertype"]:disabled');if(elmOrderingMethods.length){if(elmDisabledOrderingMethods.length){return elmOrderingMethods.length-elmDisabledOrderingMethods.length}else{return elmOrderingMethods.length}}else{return 0}},countAvailablePaymentMethods:function(){const elmPaymentMethods=$('#moo-checkout-form-payments input[name="paymentMethod"]');if(elmPaymentMethods.length){return elmPaymentMethods.length}else{return 0}},uncheckSelectedOrderingMethod:function(){const elm=$('#moo-checkout-form-ordertypes input[name="ordertype"]:checked');if(elm.length){elm.removeAttr("checked")}mooGlobalParams.selectedOrderType=null;mooGlobalParams.selectedAddress=null;mooGlobalParams.deliveryFees=null;mooGlobalParams.isDeliveryOrder=false;this.hideAddressSection();this.hideDeliveryAmount()},uncheckSelectedPaymentMethod:function(){const elm=$('#moo-checkout-form-payments input[name="paymentMethod"]:checked');if(elm.length){elm.removeAttr("checked")}this.hidePhoneVerificationSection();$("#moo-cloverCreditCardPanel").hide()},getCustomer:function(){if(mooGlobalParams.isGuest){return this.getGuestInfo()}else{const customer=this.getLoggedInCustomer();return{first\_name:customer.first\_name,last\_name:customer.last\_name,email:customer.email,phone:customer.phone,isPhoneVerified:customer.is\_phone\_verified,address:this.getSelectedAddress(),full\_address:this.getSelectedAddressAsString()}}},getTipAmount:function(){if(isNaN(mooGlobalParams.tipAmount)||mooCheckout.getSelectedPaymentMethod()==="cash"){return 0}return mooGlobalParams.tipAmount},getSelectedAddress:function(){return mooGlobalParams.selectedAddress},getSelectedAddressAsString:function(){var address=this.getSelectedAddress();var address\_string="";if(address){if(address.address)address\_string+=address.address+" ";if(address.line2)address\_string+=address.line2+" ";if(address.city)address\_string+=address.city+", ";if(address.state)address\_string+=address.state+" ";if(address.zipcode)address\_string+=address.zipcode}return address\_string},addNewAddress:function(e){e.preventDefault();if(mooCheckout.addAddressForm.data("submitted")===true){return false}else{mooCheckout.startSubmitingAform(mooCheckout.addAddressForm)}const formElements={fullNameInput:mooCheckout.addAddressForm.find("#sooAddAddressName"),addressInput:mooCheckout.addAddressForm.find("#sooAddAddressLine1"),line2Input:mooCheckout.addAddressForm.find("#sooAddAddressLine2"),cityInput:mooCheckout.addAddressForm.find("#sooAddAddressCity"),stateInput:mooCheckout.addAddressForm.find("#sooAddAddressState"),zipCodeInput:mooCheckout.addAddressForm.find("#sooAddAddressZipCode")};const requiredField=["addressInput","cityInput","stateInput","zipCodeInput"];for(const el in formElements){if(requiredField.includes(el)&&!formElements[el].val()){formElements[el].parent().addClass("moo-has-error");formElements[el].next().show();formElements[el].focus();mooCheckout.finishSubmitingAform(mooCheckout.addAddressForm);return}}mooGlobalParams.selectedAddress={full\_name:formElements.fullNameInput.val().trim(),address:formElements.addressInput.val().trim(),line2:formElements.line2Input.val().trim(),city:formElements.cityInput.val().trim(),state:formElements.stateInput.val().trim(),zipcode:formElements.zipCodeInput.val().trim()};if(mooGlobalParams.isGuest){if(mooGlobalParams.selectedOrderType){if(mooGlobalParams.selectedOrderType.ot\_uuid==="onDemandDelivery"){mooCheckout.finishSubmitingAform(mooCheckout.addAddressForm);mooCheckout.showListOfAddresses()}else{$.ajax({type:"POST",cache:false,url:sooCheckout.options.restApiUrl+"moo-clover/v3/geocode-address",headers:{"Content-Type":"application/json"},data:JSON.stringify(mooGlobalParams.selectedAddress)}).done(function(response){mooGlobalParams.selectedAddress.lat=response.lat;mooGlobalParams.selectedAddress.lng=response.lng;mooCheckout.finishSubmitingAform(mooCheckout.addAddressForm);const res=mooCheckout.calculateDeliveryFees(mooGlobalParams.selectedAddress.lat,mooGlobalParams.selectedAddress.lng);if(res.result==="zone\_error"){mooCheckout.showErrorAlert(res.message,"")}else{mooCheckout.showListOfAddresses()}}).fail(function(response){mooCheckout.finishSubmitingAform(mooCheckout.addAddressForm);let errorMsg="";if(response.responseJSON&&response.responseJSON.message){errorMsg=response.responseJSON.message}else{errorMsg=mooObjectL10n.anErrorOccurred}mooCheckout.showErrorAlert(errorMsg,mooObjectL10n.tryAgain);mooGlobalParams.selectedAddress=null})}}else{mooCheckout.showErrorAlert(mooObjectL10n.error,"Select an Ordering Method")}}else{let token=localStorage.getItem("customerJwtToken");if(!token){console.log("token not found")}$.ajax({type:"POST",cache:false,url:sooCheckout.options.restApiUrl+"moo-clover/v3/customers/addresses",headers:{"Content-Type":"application/json",Authorization:"Bearer "+token},data:JSON.stringify(mooGlobalParams.selectedAddress)}).done(function(address){if(address.id){mooCheckout.finishSubmitingAform(mooCheckout.addAddressForm);if(mooCheckout.loggedInCustomer.addresses.length>0){mooCheckout.loggedInCustomer.addresses.push(address)}else{mooCheckout.loggedInCustomer.addresses=[address]}mooCheckout.showListOfAddresses()}else{mooCheckout.showErrorAlert(mooObjectL10n.anErrorOccurred,"")}}).fail(function(data){mooCheckout.finishSubmitingAform(mooCheckout.addAddressForm);let errorMsg="";if(data.responseJSON&&data.responseJSON.message){errorMsg=data.responseJSON.message}else{errorMsg=mooObjectL10n.anErrorOccurred}mooCheckout.showErrorAlert(errorMsg,mooObjectL10n.tryAgain)})}},fillAddressToEdit:function(){if(mooGlobalParams.selectedAddress){const formElements={fullNameInput:mooCheckout.addAddressForm.find("#sooAddAddressName"),addressInput:mooCheckout.addAddressForm.find("#sooAddAddressLine1"),line2Input:mooCheckout.addAddressForm.find("#sooAddAddressLine2"),cityInput:mooCheckout.addAddressForm.find("#sooAddAddressCity"),stateInput:mooCheckout.addAddressForm.find("#sooAddAddressState"),zipCodeInput:mooCheckout.addAddressForm.find("#sooAddAddressZipCode")};if(mooGlobalParams.selectedAddress.full\_name){formElements.fullNameInput.val(mooGlobalParams.selectedAddress.full\_name)}if(mooGlobalParams.selectedAddress.address){formElements.addressInput.val(mooGlobalParams.selectedAddress.address)}if(mooGlobalParams.selectedAddress.line2){formElements.line2Input.val(mooGlobalParams.selectedAddress.line2)}if(mooGlobalParams.selectedAddress.city){formElements.cityInput.val(mooGlobalParams.selectedAddress.city)}if(mooGlobalParams.selectedAddress.state){formElements.stateInput.val(mooGlobalParams.selectedAddress.state)}if(mooGlobalParams.selectedAddress.zipcode){formElements.zipCodeInput.val(mooGlobalParams.selectedAddress.zipcode)}}},setAddress:function(address){localStorage.setItem("selectedAddress",JSON.stringify(address))},isPhoneVerificationActivated:function(){return sooCheckout.options.useSmsVerification},orderTypeChanged:function(){if(mooGlobalParams.selectedOrderType&&mooCheckout.getSelectedOrderingMethod()===mooGlobalParams.selectedOrderType.ot\_uuid){console.log("order type not changed");return}mooGlobalParams.selectedOrderType=mooCheckout.getOneOrderType(mooCheckout.getSelectedOrderingMethod());if(mooGlobalParams.selectedOrderType){const orderType=mooGlobalParams.selectedOrderType;mooGlobalParams.deliveryFees=0;if(this.isTrue(mooGlobalParams.selectedOrderType.allow\_sc\_order)&&sooCheckout.options.allowScOrder){mooGlobalParams.allowScOrders=true;this.showOrderingTime()}else{mooGlobalParams.allowScOrders=false;this.hideOrderingTime()}if(this.isTrue(mooGlobalParams.selectedOrderType.show\_sa)){mooGlobalParams.isDeliveryOrder=true;this.showListOfAddresses();this.showDeliveryAmount();if(mooGlobalParams.allowScOrders){this.changeOrderingTimes("delivery")}if(sooCheckout.options.cashUponDelivery&&orderType.ot\_uuid!=="onDemandDelivery"){$("#moo-checkout-form-payincash-label").text(mooObjectL10n.payUponDelivery);this.showCashPayment()}else{this.hideCashPayment()}}else{mooGlobalParams.isDeliveryOrder=false;mooGlobalParams.deliveryFees=0;mooGlobalParams.selectedAddress=null;this.hideAddressSection();this.hideDeliveryAmount();if(mooGlobalParams.allowScOrders){this.changeOrderingTimes("pickup")}if(sooCheckout.options.cashInStore){$("#moo-checkout-form-payincash-label").text(mooObjectL10n.payAtlocation);this.showCashPayment()}else{this.hideCashPayment()}}if(this.isTrue(mooGlobalParams.selectedOrderType.use\_coupons)){this.showCouponsSection()}else{this.hideCouponsSection()}this.updateTotals()}else{console.log("No OrderType found")}},paymentMethodChanged:function(){const selectedPaymentMethod=mooCheckout.getSelectedPaymentMethod();if(selectedPaymentMethod==="cash"){this.hideTipSection();$("#moo-cloverCreditCardPanel").hide();$("#moo-cloverGiftCardPanel").hide();if(this.shouldVerifyPhone()){this.showPhoneVerificationSection()}$("#moo\_btn\_submit\_order").show();$("#moo-cloverGooglePay").hide();$("#mooGooglePaySection").hide()}if(selectedPaymentMethod==="clover"){this.showTipSection();this.hidePhoneVerificationSection();$("#moo-cloverGiftCardPanel").hide();$("#moo\_btn\_submit\_order").show();$("#moo-cloverGooglePay").hide();$("#mooGooglePaySection").hide();$("#moo-cloverCreditCardPanel").show()}if(selectedPaymentMethod==="giftcard"){this.showTipSection();$("#moo-cloverCreditCardPanel").hide();this.hidePhoneVerificationSection();$("#moo-cloverGiftCardPanel").show();$("#moo\_btn\_submit\_order").show();$("#moo-cloverGooglePay").hide();$("#mooGooglePaySection").hide()}if(selectedPaymentMethod==="googlepay"){this.showTipSection();$("#moo-cloverCreditCardPanel").hide();this.hidePhoneVerificationSection();$("#moo-cloverGiftCardPanel").hide();$("#moo\_btn\_submit\_order").hide();$("#moo-cloverGooglePay").show();$("#mooGooglePaySection").show()}this.updateTotalsSection(sooCheckout.options.totals)},orderingTimeChanged:function(element){this.updateSelectedTime()},orderingDayChanged:function(element){let html="";const theDay=$(element).val();const times=mooGlobalParams.isDeliveryOrder?sooCheckout.options.deliveryTimes[theDay]:sooCheckout.options.pickupTimes[theDay];if(!(typeof times==="undefined")){html+='<option value="Select a time">Select a time</option>';for(let i in times){html+='<option value="'+times[i]+'">'+times[i]+"</option>"}}else{html=""}$("#moo\_pickup\_hour").html(html);this.updateSelectedTime()},tipPercentageChanged:function(){const selectedPercentAmount=$("#moo\_tips\_select").val();if(selectedPercentAmount&&selectedPercentAmount!=="cash"&&selectedPercentAmount!=="other"){const calculatedAmount=sooCheckout.options.totals.sub\_total\*selectedPercentAmount/100;mooGlobalParams.tipAmount=Math.round(parseInt(calculatedAmount))}else{mooGlobalParams.tipAmount=0;if(selectedPercentAmount==="other"){$("#moo\_tips").select()}}$("#moo\_tips").val(this.formatPrice(mooGlobalParams.tipAmount));this.updateTotalsSection(sooCheckout.options.totals)},tipAmountChanged:function(){const calculatedAmount=parseInt(Math.ceil(parseFloat($("#moo\_tips").val())\*100));const amount=Math.round(calculatedAmount);if(!isNaN(amount)&&amount>0){mooGlobalParams.tipAmount=amount;$("#moo\_tips").val(this.formatPrice(mooGlobalParams.tipAmount))}else{mooGlobalParams.tipAmount=0;$("#moo\_tips").val("0.00")}this.updateTotalsSection(sooCheckout.options.totals)},showListOfAddresses:function(){$("#moo-checkout-form-ordertypes .soo-address-section .soo-add-delivery-address-form").hide();var listAddrElm=$("#moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses");listAddrElm.show();listAddrElm.html("<div  class='soo-addresses-wrapper'><div class='soo-addresses-title'>Loading your addresses...</div></div>");let html="<div  class='soo-addresses-wrapper'>";html+="<div class='soo-estimate-loader'></div>";let addressesProcessed=0;let nbOfAddresses=0;let addresses=[];let cssClasses="";if(mooGlobalParams.isGuest){if(mooGlobalParams.selectedAddress){nbOfAddresses=1;addresses=[mooGlobalParams.selectedAddress]}else{mooCheckout.showAddAddressForm();$("#soo-add-address-form > div > div > button.sooCheckoutSecondaryButtonInput").hide();return}}else{if(mooCheckout.loggedInCustomer){addresses=mooCheckout.loggedInCustomer.addresses;nbOfAddresses=addresses?addresses.length:0}}if(nbOfAddresses===1){mooGlobalParams.selectedAddress=addresses[0];cssClasses="soo-selected";html+="<div class='soo-addresses-title'>Delivery to :</div>"}else{html+="<div class='soo-addresses-title'>Choose a delivery address</div>"}if(nbOfAddresses>0){addresses.forEach(element=>{if(mooGlobalParams.selectedAddress&&mooGlobalParams.selectedAddress.id===element.id){cssClasses="soo-selected"}else{cssClasses=""}html+="<div class='soo-one-address "+cssClasses+"' id='soo-address-"+element.id+"' onclick='mooCheckout.selectAnAddress("+element.id+")'>";if(typeof element.full\_name!=="undefined"&&element.full\_name!==null){html+="<div class='soo-one-address-name'>"+element.full\_name+"</div>"}html+="<div class='soo-one-address-line1'>"+element.address+"</div>";if(element.line2){html+="<div class='soo-one-address-line2'>"+element.line2+"</div>"}html+="<div class='soo-one-address-line2'>"+element.city+" "+element.state+", "+element.zipcode+"</div>";html+="<div class='soo-address-error'></div>";html+="<div class='soo-delivery-amount'></div>";html+="</div>";addressesProcessed++;if(addressesProcessed>=nbOfAddresses){if(mooGlobalParams.isGuest){html+="</div><div class='soo-add-new-address-button'><span onclick='mooCheckout.showEditAddressForm()'>Edit Address</span></div>"}else{html+="</div><div class='soo-add-new-address-button'><span onclick='mooCheckout.showAddAddressForm()'>Add New Address</span></div>"}listAddrElm.html(html);mooCheckout.syncDeliveryFee()}})}else{mooCheckout.showAddAddressForm()}},showAddAddressForm:function(){$("#moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses").hide();$("#moo-checkout-form-ordertypes .soo-address-section .soo-add-delivery-address-form").show();$("#soo-add-address-form > div > div > button.sooCheckoutSecondaryButtonInput").show()},showEditAddressForm:function(){this.showAddAddressForm();if(mooGlobalParams.selectedAddress){this.fillAddressToEdit()}},hideAddressSection:function(){$("#moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses").hide();$("#moo-checkout-form-ordertypes .soo-address-section .soo-add-delivery-address-form").hide()},hideCouponsSection:function(){$("#moo-checkout-form-coupon").hide()},showCouponsSection:function(){$("#moo-checkout-form-coupon").show()},showDeliveryAmount:function(){$("#sooDeliveryFeeTotalSection").show()},hideDeliveryAmount:function(){$("#sooDeliveryFeeTotalSection").hide()},showServiceFeeAmount:function(){$("#sooServiceFeeTotalSection").show()},hideServiceFeeAmount:function(){$("#sooServiceFeeTotalSection").hide()},showTipSection:function(){$("#sooTipsTotalSection").show();$("#moo-checkout-form-tips").show()},hideTipSection:function(){$("#sooTipsTotalSection").hide();$("#moo-checkout-form-tips").hide()},showCashPayment:function(){$(".moo-checkout-form-payments-cash-container").show();$("#moo-checkout-form-payments-cash").val("cash")},hideCashPayment:function(){$(".moo-checkout-form-payments-cash-container").hide();$("#moo\_cashPanel").hide();$("#moo-checkout-form-payments-cash").val("");if(this.getSelectedPaymentMethod()==="cash"){this.uncheckSelectedPaymentMethod()}},hidePhoneVerificationSection:function(){$("#moo\_cashPanel").hide()},showPhoneVerificationSection:function(){clearInterval(mooGlobalParams.timer);$("#moo\_cashPanel").show();const seconds=120;if(mooGlobalParams.isOtpCodeSent){this.changeElemVisibility("#moo\_cashPanel > div.soo-phone-button","hide");this.changeElemVisibility("#moo\_cashPanel > div.soo-phone-input","show");$("#moo\_cashPanel > div.soo-phone-verif-title").text("Sent sms verification to: "+this.getPhoneNumber());$("#moo\_cashPanel > div.soo-phone-verif-footer").html("Resend code in <span class='timer'>"+seconds+"</span> seconds");mooGlobalParams.timer=setInterval(this.countDown,1e3)}else{this.changeElemVisibility("#moo\_cashPanel > div.soo-phone-button","show");this.changeElemVisibility("#moo\_cashPanel > div.soo-phone-input","hide");$("#moo\_cashPanel > div.soo-phone-verif-title").text("We will send a verification code via SMS to your number");$("#moo\_cashPanel > div.soo-phone-verif-footer").html("")}},selectAnAddress:function(id){if(!mooGlobalParams.isGuest){$("#moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses .soo-one-address").removeClass("soo-selected soo-selected-error soo-selected-warning");$("#moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses .soo-one-address .soo-address-error").text("");$("#moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses .soo-one-address .soo-delivery-amount").text("");$("#moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses #soo-address-"+id).addClass("soo-selected");mooGlobalParams.selectedAddress=this.getAddressById(id);this.syncDeliveryFee()}},unSelectAddress:function(id){$("#moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses .soo-one-address").removeClass("soo-selected soo-selected-error soo-selected-warning");$("#moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses .soo-one-address .soo-address-error").text("");$("#moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses .soo-one-address .soo-delivery-amount").text("")},syncDeliveryFee:function(){if(mooGlobalParams.selectedAddress){const addrElm=$("#moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses #soo-address-"+mooGlobalParams.selectedAddress.id);const amountPos=-1/2\*parseFloat(addrElm.css("height"))+6;if(mooGlobalParams.selectedOrderType&&mooGlobalParams.selectedOrderType.ot\_uuid==="onDemandDelivery"){$(".soo-delivery-amount",addrElm).css("top",amountPos+"px");this.createOnDemandDeliveryEstimate()}else{const res=this.calculateDeliveryFees(mooGlobalParams.selectedAddress.lat,mooGlobalParams.selectedAddress.lng);if(res.result==="success"){mooGlobalParams.selectedAddress.isValid=true;let deliveryAmount;if(!isNaN(res.amount)&&res.amount>0){mooGlobalParams.deliveryFees=res.amount;deliveryAmount=parseFloat(res.amount/100).toFixed(2);deliveryAmount="+ $"+deliveryAmount}else{mooGlobalParams.deliveryFees=0;deliveryAmount="Free"}$(".soo-delivery-amount",addrElm).text(deliveryAmount).css("top",amountPos+"px")}else{mooGlobalParams.selectedAddress.isValid=false}if(res.result==="zone\_error"){addrElm.addClass("soo-selected-error");$(".soo-address-error",addrElm).text(res.message);mooGlobalParams.deliveryFees=null}if(res.result==="min\_error"){addrElm.addClass("soo-selected-warning");$(".soo-address-error",addrElm).text(res.message);mooGlobalParams.deliveryFees=null}mooCheckout.updateTotals()}}},getAddressById:function(id){if(mooCheckout.loggedInCustomer){for(var i=0;i<mooCheckout.loggedInCustomer.addresses.length;i++){if(mooCheckout.loggedInCustomer.addresses[i].id===id)return mooCheckout.loggedInCustomer.addresses[i]}}return null},getOneOrderType:function(orderTypeUuid){if(typeof sooCheckout.options.orderTypes!=="undefined"){for(var i in sooCheckout.options.orderTypes){if(orderTypeUuid===sooCheckout.options.orderTypes[i].ot\_uuid){return sooCheckout.options.orderTypes[i]}}}return null},changeElemVisibility:function(selector,showOrHide){if(showOrHide==="show"){$(selector).show()}if(showOrHide==="hide"){$(selector).hide()}},hideOrderingTime:function(){this.changeElemVisibility("#moo-checkout-form-orderdate","hide")},showOrderingTime:function(){this.changeElemVisibility("#moo-checkout-form-orderdate","show")},getPhoneNumber:function(){if(mooGlobalParams.isGuest){const customer=this.getGuestInfo();return customer.phone}else{const customer=this.getLoggedInCustomer();return customer.phone}},sendCodeToVerifyPhone:function(){const btnSend=$("#moo\_cashPanel > div.soo-phone-button > button");const btnSendTxt=btnSend.html();const phone=this.getPhoneNumber();const seconds=120;if(phone===""){mooCheckout.showErrorAlert(mooObjectL10n.enterYourPhone,"");return}btnSend.html('<div class="dot-flashing"></div>');let token=localStorage.getItem("customerJwtToken");if(!token&&!mooGlobalParams.isGuest){return}const url=mooGlobalParams.isGuest?"moo-clover/v2/guests/send-code":"moo-clover/v2/customers/send-code";fetch(sooCheckout.options.restApiUrl+url,{method:"POST",mode:"cors",cache:"no-cache",credentials:"same-origin",headers:{"Content-Type":"application/json",Authorization:"Bearer "+token},redirect:"follow",referrerPolicy:"no-referrer",body:JSON.stringify({phone:phone})}).then(response=>{if(!response.ok){return response.json()}else{mooGlobalParams.isOtpCodeSent=true;this.showPhoneVerificationSection();btnSend.html(btnSendTxt);return response.json()}}).then(data=>{btnSend.html(btnSendTxt);if(typeof data!=="undefined"&&data.message){if(data.message==="You just sent the verification code please try later"){mooGlobalParams.isOtpCodeSent=true;this.showPhoneVerificationSection()}else{Swal.fire({icon:"success",title:data.message})}}else{if(data===false){throw mooObjectL10n.anErrorOccurred}}}).catch(error=>{btnSend.html(btnSendTxt);mooCheckout.showErrorAlert(error,"")})},verifyCodeSentToPhone:function(){const btn=$("#moo\_cashPanel > div.soo-phone-input > button");const btnTxt=btn.html();const numReg=/^\d+\.?\d\*$/;const phone=this.getPhoneNumber();const code=$("#moo\_cashPanel > div.soo-phone-input > input").val();const seconds=120;if(code.length!==6||!numReg.test(code)){mooCheckout.showErrorAlert(mooObjectL10n.codeInvalid,mooObjectL10n.codeInvalidDetails);return}btn.html('<div class="dot-flashing"></div>');let token=localStorage.getItem("customerJwtToken");if(!token&&!mooGlobalParams.isGuest){return}const url=mooGlobalParams.isGuest?"moo-clover/v2/guests/check-code":"moo-clover/v2/customers/check-code";fetch(sooCheckout.options.restApiUrl+url,{method:"POST",mode:"cors",cache:"no-cache",credentials:"same-origin",headers:{"Content-Type":"application/json",Authorization:"Bearer "+token},redirect:"follow",referrerPolicy:"no-referrer",body:JSON.stringify({code:code,phone:phone})}).then(response=>{if(!response.ok){return response.json()}else{btn.html(btnTxt);clearInterval(mooGlobalParams.timer);mooCheckout.showSuccessAlert(mooObjectL10n.phoneVerified,mooObjectL10n.phoneVerifiedDetails);mooGlobalParams.isOtpCodeSent=false;this.hidePhoneVerificationSection();if(mooGlobalParams.isGuest){mooGlobalParams.isGuestPhoneVerified=true}else{this.getCustomerProfile().then(async function(response){if(!response.ok){const message=`An error has occured: ${response.status}`;throw new Error(message)}return await response.json()}).then(data=>{localStorage.setItem("loggedInCustomer",JSON.stringify(data));mooCheckout.loggedInCustomer=data;mooCheckout.fillCustomerInfo()}).catch(error=>{console.log(error)})}}}).then(data=>{btn.html(btnTxt);if(typeof data!=="undefined"&&data.message){throw data.message}else{if(data===false){throw mooObjectL10n.anErrorOccurred}}}).catch(error=>{btn.html(btnTxt);mooCheckout.showErrorAlert(error,"")})},countDown:function(){let sec=parseInt($("#moo\_cashPanel > div.soo-phone-verif-footer>.timer").text());$("#moo\_cashPanel > div.soo-phone-verif-footer>.timer").text(--sec);if(sec<=0){$("#moo\_cashPanel > div.soo-phone-verif-footer").html("<div onclick='mooCheckout.sendCodeToVerifyPhone()'>Resend code</div>");clearInterval(mooGlobalParams.timer)}},finalizeOrder:function(e){e.preventDefault();$("#moo\_btn\_submit\_order").hide();$("#moo\_checkout\_loading").show();$("#moo-checkout .errors-section").html("");try{window.mooCheckout.getCheckoutForm()}catch(e){console.log(e);window.mooCheckout.stopLoading();window.mooCheckout.showErrorAlert(mooObjectL10n.anErrorOccurred)}},verifyCheckoutForm:function(form){var regex\_exp={email:/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)\*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/};var message\_errors={};const selectedOrderType=mooGlobalParams.selectedOrderType;if(form.customer.first\_name===""&&form.customer.last\_name===""){mooCheckout.showErrorAlert(mooObjectL10n.enterYourName,"","#MooContactFirstName");return false}if(form.customer.email===""||!regex\_exp.email.test(form.customer.email)){mooCheckout.showErrorAlert(mooObjectL10n.enterYourEmail,mooObjectL10n.enterYourEmailReason,"#MooContactEmail");return false}if(form.customer.phone===""){mooCheckout.showErrorAlert(mooObjectL10n.enterYourPhone,mooObjectL10n.enterYourPhoneReason,"#MooContactPhone");return false}if(document.getElementById("moo-checkout-form-ordertypes")){if(typeof form.order\_type==="undefined"||form.order\_type===""){mooCheckout.showErrorAlert(mooObjectL10n.chooseOrderingMethod,mooObjectL10n.chooseOrderingMethodReason,"#moo-checkout-form-ordertypes");return false}}if(selectedOrderType){var minAmount=parseFloat(selectedOrderType.minAmount);var maxAmount=parseFloat(selectedOrderType.maxAmount);if(!isNaN(minAmount)){minAmount=minAmount\*100;minAmount=Math.round(minAmount\*100)/100;if(minAmount>0&&minAmount>sooCheckout.options.totals.sub\_total){this.stopLoading();Swal.fire({title:mooObjectL10n.YouDidNotMeetMinimum,text:mooObjectL10n.orderingMethodSubtotalGreaterThan+mooformatCentPrice(minAmount),icon:"warning",showCancelButton:true,confirmButtonColor:"#DD6B55",confirmButtonClass:"fontSizeLg",confirmButtonText:mooObjectL10n.continueToCheckout,cancelButtonText:mooObjectL10n.continueShopping}).then(data=>{if(data.dismiss&&data.dismiss==="cancel"){if(sooCheckout.options.storeLink){window.location.href=sooCheckout.options.storeLink}}});return false}}if(!isNaN(maxAmount)){maxAmount=maxAmount\*100;maxAmount=Math.round(maxAmount\*100)/100;if(maxAmount&&maxAmount<sooCheckout.options.totals.sub\_total){this.stopLoading();Swal.fire({title:mooObjectL10n.reachedMaximumPurchaseAmount,text:mooObjectL10n.orderingMethodSubtotalLessThan+mooformatCentPrice(maxAmount),icon:"warning",showCancelButton:true,confirmButtonColor:"#DD6B55",confirmButtonText:mooObjectL10n.updateCart,cancelButtonText:mooObjectL10n.checkout,closeOnConfirm:false}).then(function(data){if(data.value){Swal.close();window.location.href=moo\_params.cartPage}});return false}}if(mooCheckout.isTrue(selectedOrderType.show\_sa)){if(mooGlobalParams.selectedAddress){if(!mooGlobalParams.selectedAddress.isValid){mooCheckout.showErrorAlert(mooObjectL10n.verifyYourAddress,"Sorry, we are unable to deliver to this address. Please provide a different address or kindly get in touch with us if you feel are within the delivery range.","#moo-checkout-form-ordertypes>.moo-checkout-bloc-message");return false}}else{mooCheckout.showErrorAlert(mooObjectL10n.addDeliveryAddress,mooObjectL10n.addDeliveryAddressReason,"#moo-checkout-form-ordertypes>.moo-checkout-bloc-message .MooSimplButon");return false}}}if(mooGlobalParams.allowScOrders){if(sooCheckout.options.orderingTimeRequired){if(form.pickup\_hour===""||form.pickup\_hour==="Select a time"){mooCheckout.showErrorAlert(mooObjectL10n.chooseTime,"","#moo-checkout-form-orderdate");return false}}}if(sooCheckout.options.specialInstructionsRequired){if(typeof form.special\_instructions==="undefined"||form.special\_instructions===""){mooCheckout.showErrorAlert(mooObjectL10n.SpecialInstructionsRequired,"","#moo-checkout-form-instruction");return false}}if(form.tip\_amount>0&&this.getOrderTotal()===0){mooCheckout.showErrorAlert("Unable to Include Tips for $0 Orders","To enhance your experience, kindly note that we are unable to include tips when the Order Total is $0. However, you have the option to show your appreciation by providing a tip upon order pickup or delivery. We appreciate your understanding.","#moo-checkout-form-tips");return false}if(typeof form.payment\_method==="undefined"||form.payment\_method===""){mooCheckout.showErrorAlert(mooObjectL10n.choosePaymentMethod,"","#moo-checkout-form-payments");return false}else{if(form.payment\_method==="cash"){if(mooCheckout.shouldVerifyPhone()){if(mooGlobalParams.isGuest&&!mooGlobalParams.isGuestPhoneVerified||!mooGlobalParams.isGuest&&!mooCheckout.loggedInCustomerPhoneIsVerified()){mooCheckout.showPhoneVerificationSection();mooCheckout.showErrorAlert(mooObjectL10n.verifyYourPhone,mooObjectL10n.verifyYourPhoneReason,"#moo-checkout-form-payments");return false}}this.submitForm(form)}if(form.payment\_method==="clover"){if(window.cloverCardIsValid){window.clover.createToken().then(function(response){if(response.token){form.token=response.token;form.card=response.card;window.mooCheckout.submitForm(form)}else{mooCheckout.showErrorAlert(mooObjectL10n.verifyYourCreditCard,"","#moo-checkout-form-payments");return false}})}else{mooCheckout.showErrorAlert(mooObjectL10n.verifyYourCreditCard,window.cloverCardErrorMsg,"#moo-checkout-form-payments");return false}}if(form.payment\_method==="giftcard"){if(window.cloverGiftCardIsValid){try{const timeoutId=setTimeout(()=>{mooCheckout.showErrorAlert("Please verify the gift card information","","#moo-checkout-form-payments")},1e4);window.clover.createGiftCardToken().then(function(response){clearTimeout(timeoutId);if(response.token){form.payment\_method="clover";form.selected\_payment\_method="giftcard";form.token=response.token;window.mooCheckout.submitForm(form)}else{mooCheckout.showErrorAlert("Please verify the gift card information","","#moo-checkout-form-payments");return false}})}catch(err){console.log(err)}}else{mooCheckout.showErrorAlert("Please verify the gift card information","","#moo-checkout-form-payments");return false}}if(form.payment\_method==="googlepay"){if(window.googlePayToken){try{form.payment\_method="clover";form.token=window.googlePayToken.token;form.selected\_payment\_method="googlepay";form.googledata=window.googlePayToken;window.mooCheckout.submitForm(form)}catch(err){console.log(err)}}else{mooCheckout.showErrorAlert("Please Try Again","","#moo-checkout-form-payments");return false}}}},getCheckoutForm:function(){var form={channel:"website",customer:null,metainfo:[{name:"source\_url",value:window.location.href},{name:"checkout\_version",value:"new"}]};form.customer=mooCheckout.getCustomer();form.tip\_amount=mooCheckout.getTipAmount();form.special\_instructions=$("#Mooinstructions").val();form.pickup\_day=$("#moo\_pickup\_day").val();form.pickup\_hour=$("#moo\_pickup\_hour").val();form.orderingTime=mooGlobalParams.selectedTime;if(document.getElementById("moo-checkout-form-ordertypes")){form.order\_type=$('input[name="ordertype"]:checked').val()}form.payment\_method=$('#moo-checkout-form-payments input[name="paymentMethod"]:checked').val();form.delivery\_amount=mooCheckout.getDeliveryFees();form.service\_fee=mooCheckout.getServiceFees();if(this.canAcceptCoupons()){form.coupon={code:mooGlobalParams.couponCode}}if(this.canAcceptPoints()){form.use\_points=parseInt(mooGlobalParams.points)}form.totals=mooCheckout.getTotals();this.verifyCheckoutForm(form)},submitForm:function(form){if(form.order\_type==="onDemandDelivery"){let deliveryTime=(new Date).toISOString();if(mooGlobalParams.selectedTime){deliveryTime=mooGlobalParams.selectedTime}this.createDeliveryEstimate().then(response=>{if(!response.ok){throw new Error(mooObjectL10n.anErrorOccurred)}else{return response.json()}}).then(res=>{if(res.status==="success"){form.delivery\_estimate=res;form.delivery\_time=deliveryTime;this.createOrder(form)}else{throw new Error(res.message)}}).catch(err=>{this.showErrorAlert(err.message,"")})}else{this.createOrder(form)}},createOrder:function(form){if(sooCheckout.options.reCAPTCHA\_site\_key){grecaptcha.ready(function(){grecaptcha.execute(sooCheckout.options.reCAPTCHA\_site\_key,{action:"createOrder"}).then(token=>{console.log(token);form.reCAPTCHA\_token=token;mooCheckout.sendCreateOrder(form)})})}else{mooCheckout.sendCreateOrder(form)}return;let headers={"Content-Type":"application/json"};if(this.isCustomerLoggedIn()){form.customer\_token=localStorage.getItem("customerJwtToken")}$.ajax({type:"POST",cache:false,url:sooCheckout.options.restApiUrl+"moo-clover/v2/checkout",headers:headers,data:JSON.stringify(form)}).done(function(data){if(typeof data=="object"){if(data.status==="success"){mooCheckout.trackConversion(true,form);mooCheckout.successfulOrder(data.id)}else{mooCheckout.trackConversion(false,form);mooCheckout.failedOrder(data.message)}}else{if(data.indexOf('"status":"success"')!==-1){mooCheckout.trackConversion(true,form);mooCheckout.successfulOrder("")}else{mooCheckout.trackConversion(false,form);mooCheckout.failedOrder("")}}}).fail(function(data){console.log("FAIL");console.log(data.responseText);if(data.responseText.indexOf('"status":"success"')!==-1){mooCheckout.trackConversion(true,form);mooCheckout.successfulOrder("")}else{mooCheckout.trackConversion(false,form);mooCheckout.failedOrder("")}})},sendCreateOrder:function(form){let headers={"Content-Type":"application/json"};if(this.isCustomerLoggedIn()){form.customer\_token=localStorage.getItem("customerJwtToken")}$.ajax({type:"POST",cache:false,url:sooCheckout.options.restApiUrl+"moo-clover/v2/checkout",headers:headers,data:JSON.stringify(form)}).done(function(data){if(typeof data=="object"){if(data.status==="success"){mooCheckout.trackConversion(true,form);mooCheckout.successfulOrder(data.id)}else{mooCheckout.trackConversion(false,form);mooCheckout.failedOrder(data.message)}}else{if(data.indexOf('"status":"success"')!==-1){mooCheckout.trackConversion(true,form);mooCheckout.successfulOrder("")}else{mooCheckout.trackConversion(false,form);mooCheckout.failedOrder("")}}}).fail(function(data){console.log("FAIL");console.log(data.responseText);if(data.responseText.indexOf('"status":"success"')!==-1){mooCheckout.trackConversion(true,form);mooCheckout.successfulOrder("")}else{mooCheckout.trackConversion(false,form);mooCheckout.failedOrder("")}})},successfulOrder:function(orderId){if(sooCheckout.options.thanksPage&&sooCheckout.options.thanksPage!==""){window.location.href=sooCheckout.options.thanksPage+"?order\_id="+orderId}else{let html='<div class="moo-alert moo-alert-success" role="alert" style="font-size: 20px;text-align: center">';html+=mooObjectL10n.thanksForOrder;html+="<br/>";html+=mooObjectL10n.orderBeingPrepared;if(orderId!==""){html+="<br>";html+=mooObjectL10n.seeReceipt;html+=sooCheckout.options.isSandbox?' <a href="https://sandbox.dev.clover.com/r/'+orderId+'" target="\_blank">':' <a href="https://www.clover.com/r/'+orderId+'" target="\_blank">';html+=mooObjectL10n.here;html+="</a>"}html+="</div>";$("#moo\_checkout\_msg").remove();$("#moo-checkout").html("");if(sooCheckout.delivery.moo\_merchantAddress!==""){$("#moo-checkout").parent().prepend("<div style='text-align: center'><p style='font-size: 21px;'>"+mooObjectL10n.ourAddress+" : </p>"+sooCheckout.delivery.moo\_merchantAddress+"</div>")}$("#moo-checkout").parent().prepend(html);$("html, body").animate({scrollTop:0},600)}},failedOrder:function(failureMessage){let html="";this.stopLoading();if(failureMessage&&failureMessage!==""&&failureMessage!==undefined){html='<div class="moo-alert moo-alert-danger" role="alert" id="moo\_checkout\_msg">'+failureMessage+"</div>"}else{html='<div class="moo-alert moo-alert-warning" role="alert" id="moo\_checkout\_msg"><strong>';html+=mooObjectL10n.cannotSendEntireOrder;html+="</strong></div>"}$("#moo-checkout .errors-section").html(html);$("html, body").animate({scrollTop:0},600)},getCustomerSelectedAddress:function(){return{}},getDeliveryFees:function(){return mooGlobalParams.deliveryFees},getServiceFees:function(){let fee=sooCheckout.options.feeAmount;if(fee){if(mooGlobalParams.selectedOrderType){if(mooCheckout.isTrue(mooGlobalParams.selectedOrderType.allow\_service\_fee)){if(sooCheckout.options.feeType==="amount"){return fee}else{return Math.round(fee\*sooCheckout.options.totals.sub\_total/100)}}}else{if($("#sooServiceFeeTotalSection").css("display")==="block"){if(sooCheckout.options.feeType==="amount"){return fee}else{return Math.round(fee\*sooCheckout.options.totals.sub\_total/100)}}}}return 0},createOnDemandDeliveryEstimate:function(){if(mooGlobalParams.selectedAddress){const addrElm=$("#moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses #soo-address-"+mooGlobalParams.selectedAddress.id);const loader=$("#moo-checkout-form-ordertypes div.soo-address-section > div.soo-list-of-addresses > div.soo-addresses-wrapper>.soo-estimate-loader");$("#moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses .soo-one-address").removeClass("soo-selected-error soo-selected-warning");$("#moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses .soo-one-address .soo-address-error").text("");$("#moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses .soo-one-address .soo-delivery-amount").text("");$(".soo-delivery-amount",addrElm).html('<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" class="BpkSpinner\_bpk-spinner\_\_NjNlZ BpkSpinner\_bpk-spinner--primary\_\_YTQxN"><rect width="4" height="2" y="7" opacity=".45" rx="1"></rect><rect width="4" height="2" x="12" y="7" rx="1"></rect><rect width="4" height="2" x="7" y="16" opacity=".3" rx="1" transform="rotate(-90 7 16)"></rect><rect width="4" height="2" x="7" y="4" opacity=".65" rx="1" transform="rotate(-90 7 4)"></rect><rect width="4" height="2" x="11.134" y="15.428" opacity=".25" rx="1" transform="rotate(-120 11.134 15.428)"></rect><rect width="4" height="2" x="5.134" y="5.036" opacity=".55" rx="1" transform="rotate(-120 5.134 5.036)"></rect><rect width="4" height="2" x="14.428" y="12.866" opacity=".2" rx="1" transform="rotate(-150 14.428 12.866)"></rect><rect width="4" height="2" x="4.036" y="6.866" opacity=".5" rx="1" transform="rotate(-150 4.036 6.866)"></rect><rect width="4" height="2" x="15.428" y="4.866" opacity=".85" rx="1" transform="rotate(150 15.428 4.866)"></rect><rect width="4" height="2" x="5.036" y="10.866" opacity=".4" rx="1" transform="rotate(150 5.036 10.866)"></rect><rect width="4" height="2" x="12.866" y="1.572" opacity=".75" rx="1" transform="rotate(120 12.866 1.572)"></rect><rect width="4" height="2" x="6.866" y="11.964" opacity=".35" rx="1" transform="rotate(120 6.866 11.964)"></rect></svg>');loader.show();let deliveryTime=(new Date).toISOString();if(mooGlobalParams.selectedTime){deliveryTime=mooGlobalParams.selectedTime}this.createDeliveryEstimate().then(response=>{if(!response.ok){$(".soo-delivery-amount",addrElm).text("");loader.hide();mooCheckout.unSelectAddress();if(mooGlobalParams.selectedAddress){mooGlobalParams.selectedAddress.isValid=false}throw new Error(mooObjectL10n.anErrorOccurred)}else{return response.json()}}).then(res=>this.displayDeliveryAmountForAddress(res)).catch(err=>{mooCheckout.showErrorAlert(err.message,"")})}},calculateDeliveryFees:function(lat,lng){var order\_total=parseFloat(sooCheckout.options.totals.sub\_total);const delivery\_free\_after=Math.round(parseFloat(sooCheckout.delivery.free\_amount)\*100);const delivery\_fixed\_amount=Math.round(parseFloat(sooCheckout.delivery.fixed\_amount)\*100);const delivery\_for\_other\_zone=Math.round(parseFloat(sooCheckout.delivery.other\_zone\_fee)\*100);let moo\_delivery\_areas=null;try{moo\_delivery\_areas=JSON.parse(sooCheckout.delivery.zones)}catch(e){console.log("Parsing error: moo\_delivery\_areas")}if(!isNaN(delivery\_fixed\_amount)){return{result:"success",amount:delivery\_fixed\_amount,message:null}}if(!(lat!==""&&lng!=="")){return{result:"zone\_error",amount:null,message:mooObjectL10n.deliveryZoneNotSupported}}else{var zones\_contain\_point=[];for(const i in moo\_delivery\_areas){var zone=moo\_delivery\_areas[i];if(zone.feeType==="percent"){zone.fee=parseFloat(zone.fee)}else{zone.fee=Math.round(parseFloat(zone.fee)\*100)}zone.minAmount=Math.round(parseFloat(zone.minAmount)\*100);if(zone.type==="polygon"){if(google.maps.geometry.poly.containsLocation(new google.maps.LatLng(parseFloat(lat),parseFloat(lng)),new google.maps.Polygon({paths:zone.path}))){zones\_contain\_point.push({zone\_id:zone.id,zone\_fee:zone.fee,feeType:zone.feeType,minAmount:zone.minAmount})}}if(zone.type==="circle"){var point=new google.maps.LatLng(parseFloat(lat),parseFloat(lng));var center=new google.maps.LatLng(parseFloat(zone.center.lat),parseFloat(zone.center.lng));if(google.maps.geometry.spherical.computeDistanceBetween(point,center)<=zone.radius){zones\_contain\_point.push({zone\_id:zone.id,zone\_fee:zone.fee,feeType:zone.feeType,minAmount:zone.minAmount})}}}if(zones\_contain\_point.length>=1){var delivery\_final\_amount=zones\_contain\_point[0].feeType==="percent"?zones\_contain\_point[0].zone\_fee\*order\_total/100:zones\_contain\_point[0].zone\_fee;var delivery\_zone\_id=zones\_contain\_point[0].zone\_id;var delivery\_zone\_minAmount=zones\_contain\_point[0].minAmount;for(const i in zones\_contain\_point){if(zones\_contain\_point[i].feeType==="percent"){const amount=parseFloat(zones\_contain\_point[i].zone\_fee)\*order\_total/100;if(delivery\_final\_amount>=amount){delivery\_final\_amount=amount;delivery\_zone\_id=zones\_contain\_point[i].zone\_id;delivery\_zone\_minAmount=zones\_contain\_point[i].minAmount}}else{if(delivery\_final\_amount>=zones\_contain\_point[i].zone\_fee){delivery\_final\_amount=zones\_contain\_point[i].zone\_fee;delivery\_zone\_id=zones\_contain\_point[i].zone\_id;delivery\_zone\_minAmount=zones\_contain\_point[i].minAmount}}}if(!isNaN(delivery\_zone\_minAmount)){if(delivery\_zone\_minAmount>sooCheckout.options.totals.sub\_total){return{result:"min\_error",amount:null,message:mooObjectL10n.minimumForDeliveryZone+parseFloat(delivery\_zone\_minAmount/100).toFixed(2)}}}if(isNaN(delivery\_free\_after)){return{result:"success",amount:delivery\_final\_amount,message:null}}else{var amountToAdd=delivery\_free\_after-order\_total;if(amountToAdd<=0){return{result:"success",amount:0,message:null}}else{Swal.fire({title:mooObjectL10n.spend+parseFloat(delivery\_free\_after/100).toFixed(2)+" "+mooObjectL10n.toGetFreeDelivery,text:"Add $"+parseFloat(amountToAdd/100).toFixed(2)+" to your order to enjoy free delivery",icon:"warning",showCancelButton:true,confirmButtonColor:"#6e7881",confirmButtonClass:"fontSizeLg",cancelButtonColor:"#DD6B55",confirmButtonText:mooObjectL10n.continueToCheckout,cancelButtonText:mooObjectL10n.continueShopping}).then(data=>{if(data.dismiss&&data.dismiss==="cancel"){if(sooCheckout.options.storeLink){window.location.href=sooCheckout.options.storeLink}else{window.history.back()}}});if(amountToAdd>0&&amountToAdd<delivery\_final\_amount){delivery\_final\_amount=amountToAdd}return{result:"success",amount:delivery\_final\_amount,message:null}}}}else{if(isNaN(delivery\_for\_other\_zone)){return{result:"zone\_error",amount:null,message:mooObjectL10n.deliveryZoneNotSupported}}else{return{result:"success",amount:delivery\_for\_other\_zone,message:null}}}}},formatPrice:function(priceInCentes){var p=priceInCentes/100;p=p.toFixed(2);return p.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,")},updateTotals:function(){const totals=sooCheckout.options.totals;if(totals===false){return}const deliveryAmount=this.getDeliveryFees();const serviceFee=this.getServiceFees();const discounts=this.getDiscountedAmount();this.startLoadingDeliveryFee();this.getOrderTotals(deliveryAmount+serviceFee,discounts,this.updateTotalsSection)},getTotals:function(){return{tipAmount:mooCheckout.getTipAmount(),deliveryAmount:mooCheckout.getDeliveryFees(),serviceFee:this.getServiceFees(),discounts:this.getDiscountedAmount(),couponAmount:mooGlobalParams.couponAmount,pointsAmount:mooGlobalParams.pointsAmount,grandTotal:mooGlobalParams.grandTotal,orderTaxable:mooCheckout.isOrderTaxable()}},updateTotalsSection:function(totals){mooGlobalParams.grandTotal=0;const tips\_amount=mooCheckout.getTipAmount();const delivery\_amount=mooCheckout.getDeliveryFees();const service\_fee=mooCheckout.getServiceFees();const discounts=mooCheckout.getDiscountedAmount();const orderTaxable=mooCheckout.isOrderTaxable();if(service\_fee===0){mooCheckout.hideServiceFeeAmount()}else{mooCheckout.showServiceFeeAmount();$("#sooServiceFeeTotalSection > .moo-totals-value").text(" $"+mooCheckout.formatPrice(service\_fee))}mooCheckout.stopLoadingDeliveryFee();if(discounts===0){$("#sooCouponTotalSection").hide();$("#sooPointsTotalSection").hide()}else{if(mooCheckout.canAcceptCoupons()&&mooGlobalParams.couponAmount){$("#sooCouponTotalSection").show();$("#sooCouponName").text(mooGlobalParams.couponName);$("#sooCouponValue").text(" -$"+mooCheckout.formatPrice(mooGlobalParams.couponAmount))}else{$("#sooCouponTotalSection").hide()}if(mooCheckout.canAcceptPoints()&&mooGlobalParams.pointsAmount){$("#sooPointsTotalSection").show();$("#sooPointslabel").text(mooGlobalParams.points+" "+mooGlobalParams.pointsLabel);$("#sooPointsValue").text(" -$"+mooCheckout.formatPrice(mooGlobalParams.pointsAmount))}else{$("#sooPointsTotalSection").hide()}}$(".moo-totals-value").fadeOut(300,function(){$("#moo-cart-subtotal").html("$"+mooCheckout.formatPrice(totals.sub\_total));$("#moo-cart-tip").html("$"+mooCheckout.formatPrice(tips\_amount));$("#moo-cart-delivery-fee").html("$"+mooCheckout.formatPrice(delivery\_amount));if(orderTaxable){if(discounts===0){mooGlobalParams.grandTotal=totals.sub\_total+totals.taxes+tips\_amount+delivery\_amount+service\_fee;$("#moo-cart-tax").html("$"+mooCheckout.formatPrice(totals.taxes));$("#moo-cart-total").html("$"+mooCheckout.formatPrice(mooGlobalParams.grandTotal))}else{mooGlobalParams.grandTotal=totals.sub\_total+totals.taxes\_after\_discount+tips\_amount+delivery\_amount+service\_fee-discounts;$("#moo-cart-tax").html("$"+mooCheckout.formatPrice(totals.taxes\_after\_discount));$("#moo-cart-total").html("$"+mooCheckout.formatPrice(mooGlobalParams.grandTotal))}}else{mooGlobalParams.grandTotal=totals.sub\_total+tips\_amount+delivery\_amount+service\_fee-discounts;$("#moo-cart-tax").html("0.00");$("#moo-cart-total").html("$"+mooCheckout.formatPrice(mooGlobalParams.grandTotal))}$(".moo-totals-value").fadeIn(300)})},getOrderTotals:function(charges,discounts,callback){$.ajax({type:"POST",cache:false,url:sooCheckout.options.restApiUrl+"moo-clover/v3/checkout/order\_totals",contentType:"application/json; charset=UTF-8",data:JSON.stringify({charges:charges,discounts:discounts})}).done(function(data){sooCheckout.options.totals=data;callback(data)}).fail(function(data){console.log("FAIL");console.log(data.responseText)})},showErrorAlert:function(title,message,focusOnElem=null){this.stopLoading();if(focusOnElem){Swal.fire({title:title,text:message,icon:"error"}).then(function(){setTimeout(function(){$(focusOnElem).focus()},500)})}else{Swal.fire({title:title,text:message,icon:"error"})}},showSuccessAlert:function(title,message,focusOnElem=null){this.stopLoading();if(focusOnElem){Swal.fire(title,message,"success").then(function(){setTimeout(function(){$(focusOnElem).focus()},500)})}else{Swal.fire(title,message,"success")}},stopLoading:function(){if(this.getSelectedPaymentMethod()==="googlepay"){$("#moo\_checkout\_loading").hide();$("#moo-cloverGooglePay").show()}else{$("#moo\_checkout\_loading").hide();$("#moo\_btn\_submit\_order").show()}},startLoadingDeliveryFee:function(){$("#sooDeliveryFeeTotalSection").addClass("moo-fade-in");$(".moo-totals-item-total").addClass("moo-fade-in")},stopLoadingDeliveryFee:function(){$("#sooDeliveryFeeTotalSection").removeClass("moo-fade-in");$(".moo-totals-item-total").removeClass("moo-fade-in")},trackConversion:function(status,form){if(typeof dataLayer!=="undefined"){try{if(status){dataLayer.push({event:"OrderCreated",amount:sooCheckout.options.totals.total/100,taxes:sooCheckout.options.totals.total\_of\_taxes/100,tips:form.tip\_amount/100,nbOfItems:sooCheckout.options.totals.nb\_items})}else{dataLayer.push({event:"OrderNotCreated",amount:sooCheckout.options.totals.total/100,taxes:sooCheckout.options.totals.total\_of\_taxes/100,tips:form.tip\_amount/100,nbOfItems:sooCheckout.options.totals.nb\_items})}}catch(e){console.log(e)}}},isTrue:function(param){return param===true||param===1||param==="1"||param==="true"},changeOrderingTimes:function(type){var dayInput=$("#moo\_pickup\_day");var hoursInput=$("#moo\_pickup\_hour");var html\_days="";var html\_hours="";let times=null;if(type==="pickup"){if(sooCheckout.options.pickupTimes===null){$("#moo-checkout-form-orderdate .extra-info").html("There are no time slots available. Please try again later. Thank you for your understanding and patience.");return}for(let i in sooCheckout.options.pickupTimes){html\_days+='<option value="'+i+'">'+i+"</option>"}times=sooCheckout.options.pickupTimes[Object.keys(sooCheckout.options.pickupTimes)[0]]}if(type==="delivery"){if(sooCheckout.options.deliveryTimes===null){$("#moo-checkout-form-orderdate .extra-info").html("There are no time slots available. Please try again later. Thank you for your understanding and patience.");return}for(var i in sooCheckout.options.deliveryTimes){html\_days+='<option value="'+i+'">'+i+"</option>"}times=sooCheckout.options.deliveryTimes[Object.keys(sooCheckout.options.deliveryTimes)[0]]}if(times){html\_hours+='<option value="Select a time">Select a time</option>';for(let i in times){html\_hours+='<option value="'+times[i]+'">'+times[i]+"</option>"}}else{html\_hours=""}hoursInput.html(html\_hours);dayInput.html(html\_days)},updateSelectedTime:function(){const day=$("#moo\_pickup\_day").val();let time=$("#moo\_pickup\_hour").val();if(day!==""){if(time==="ASAP"){}if(time!==""&&time!=="Select a time"){const today=new Date;let str="";if(day==="Today"){str=today.toDateString()}else{str=day+" "+today.getFullYear()}if(time==="ASAP"){time=today.toTimeString()}str+=" "+time.substring(0,time.length-2)+":00 "+time.substring(time.length-2,time.length);let selectedDay=new Date(str);mooGlobalParams.selectedTime=selectedDay;if(mooGlobalParams.selectedOrderType&&mooGlobalParams.selectedOrderType.ot\_uuid==="onDemandDelivery"){this.createOnDemandDeliveryEstimate()}return}}mooGlobalParams.selectedTime=null},getDiscountedAmount:function(){let discounts=0;if(this.canAcceptCoupons()&&mooGlobalParams.couponAmount){discounts+=mooGlobalParams.couponAmount}if(this.canAcceptPoints()&&mooGlobalParams.pointsAmount){discounts+=mooGlobalParams.pointsAmount}return discounts},createDeliveryEstimate:function(){let deliveryTime=(new Date).toISOString();if(mooGlobalParams.selectedTime){deliveryTime=mooGlobalParams.selectedTime}const url=sooCheckout.options.restApiUrl+"moo-clover/v3/delivery-estimate";return fetch(url,{method:"POST",mode:"cors",cache:"no-cache",credentials:"same-origin",headers:{"Content-Type":"application/json"},redirect:"follow",referrerPolicy:"no-referrer",body:JSON.stringify({dropoff\_address:{street:mooGlobalParams.selectedAddress.address,unit:mooGlobalParams.selectedAddress.line2,city:mooGlobalParams.selectedAddress.city,state:mooGlobalParams.selectedAddress.state,zip\_code:mooGlobalParams.selectedAddress.zipcode},order\_value:sooCheckout.options.totals.sub\_total,delivery\_time:deliveryTime})})},displayDeliveryAmountForAddress:function(res){if(!mooGlobalParams.selectedAddress){return}$("#moo-checkout-form-ordertypes div.soo-address-section > div.soo-list-of-addresses > div.soo-addresses-wrapper>.soo-estimate-loader").hide();const addrElm=$("#moo-checkout-form-ordertypes .soo-address-section .soo-list-of-addresses #soo-address-"+mooGlobalParams.selectedAddress.id);$(".soo-delivery-amount",addrElm).text("");if(res.status==="success"){$(addrElm).addClass("soo-selected");let deliveryAmount;mooGlobalParams.selectedAddress.isValid=true;if(res.minAmount&&res.minAmount>0&&res.minAmount>sooCheckout.options.totals.sub\_total){const message=mooObjectL10n.minimumForDeliveryZone+parseFloat(res.minAmount/100).toFixed(2);mooCheckout.unSelectAddress();addrElm.addClass("soo-selected-warning");$(".soo-address-error",addrElm).text(message);mooGlobalParams.deliveryFees=null}if(res.freeAfter&&res.freeAfter>0&&res.freeAfter<=sooCheckout.options.totals.sub\_total){mooGlobalParams.deliveryFees=0;deliveryAmount="Free"}else{if(res.fee>0){mooGlobalParams.deliveryFees=res.fee;deliveryAmount=parseFloat(res.fee/100).toFixed(2);deliveryAmount="+ $"+deliveryAmount}else{mooGlobalParams.deliveryFees=0;deliveryAmount="Free"}}$(".soo-delivery-amount",addrElm).text(deliveryAmount)}else{mooGlobalParams.selectedAddress.isValid=false;mooCheckout.unSelectAddress()}if(res.status==="failed"){if(res.code==="zone\_not\_supported"){addrElm.addClass("soo-selected-error");$(".soo-address-error",addrElm).text(res.message);mooGlobalParams.deliveryFees=null}if(["min\_amount\_not\_valid","delivery\_time\_not\_valid"].includes(res.code)){addrElm.addClass("soo-selected-warning");$(".soo-address-error",addrElm).text(res.message);mooGlobalParams.deliveryFees=null}}mooCheckout.updateTotals()},applyCoupon:function(showError=true){const btnRemove=$("#moo-checkout-form-coupon div > button.sooDeleteCouponButton.sooCheckoutPrimaryButtonInput");const btn=$("#moo-checkout-form-coupon div > button.sooApplyCouponButton.sooCheckoutPrimaryButtonInput");const btnTxt=btn.html();btn.html('<div class="dot-flashing"></div>');mooGlobalParams.couponCode=$("#moo\_coupon").val();if(mooGlobalParams.couponCode){mooGlobalParams.couponCode=mooGlobalParams.couponCode.trim();this.getCouponByCode(mooGlobalParams.couponCode).then(res=>{if(res.ok){return res.json()}throw new Error(mooObjectL10n.anErrorOccurred)}).then(res=>{if(res.status==="success"&&res.coupon){let discountAmount=0;const minValue=Math.round(parseFloat(res.coupon.minAmount)\*100);const maxValue=Math.round(parseFloat(res.coupon.maxValue)\*100);if(sooCheckout.options.totals.sub\_total<=0||typeof sooCheckout.options.totals.sub\_total===undefined){throw new Error(mooObjectL10n.cartEmpty)}else{if(!isNaN(minValue)){if(sooCheckout.options.totals.sub\_total<minValue){throw new Error("Minimum order amount to use this coupon is $"+this.formatPrice(minValue))}}}if(res.coupon.type.toUpperCase()==="AMOUNT"){discountAmount=Math.round(parseFloat(res.coupon.value)\*100);mooGlobalParams.couponName=res.coupon.name}else{discountAmount=Math.round(parseFloat(res.coupon.value)\*sooCheckout.options.totals.sub\_total/100);mooGlobalParams.couponName=res.coupon.name}mooGlobalParams.couponAmount=Math.min(sooCheckout.options.totals.sub\_total,discountAmount);if(!isNaN(maxValue)){if(mooGlobalParams.couponAmount>maxValue){mooGlobalParams.couponAmount=maxValue}}this.updateTotals();if(this.canAcceptPoints()&&mooGlobalParams.points>0){if(this.getOrderTotal()<0){this.clickOnRemovePoints();const additionalMsg=` and your previously used loyalty ${mooGlobalParams.pointsLabel} have been reset. Please take a moment to use review them again`;const txt=mooObjectL10n.receivedDiscountUSD+this.formatPrice(mooGlobalParams.couponAmount)+additionalMsg;this.showSuccessAlert(mooObjectL10n.couponApplied,txt)}}else{const txt=mooObjectL10n.receivedDiscountUSD+this.formatPrice(mooGlobalParams.couponAmount);this.showSuccessAlert(mooObjectL10n.couponApplied,txt)}btn.html(btnTxt).hide();$("#moo\_coupon").attr("readonly",true).attr("disabled",true);btnRemove.show()}else{if(showError){throw new Error(res.message)}else{$("#moo\_coupon").val("");btn.html(btnTxt)}}}).catch(err=>{this.showErrorAlert(mooObjectL10n.error,err.message);btn.html(btnTxt)})}else{this.showErrorAlert(mooObjectL10n.error,mooObjectL10n.enterCouponCode,"#moo\_coupon");btn.html(btnTxt)}},removeCoupon:function(){const btnApply=$("#moo-checkout-form-coupon div > button.sooApplyCouponButton.sooCheckoutPrimaryButtonInput");const btn=$("#moo-checkout-form-coupon div > button.sooDeleteCouponButton.sooCheckoutPrimaryButtonInput");const btnTxt=btn.html();btn.html('<div class="dot-flashing"></div>');mooGlobalParams.couponCode=null;mooGlobalParams.couponAmount=null;mooGlobalParams.couponName=null;this.updateTotals();btn.html(btnTxt);btn.hide();btnApply.show();$("#moo\_coupon").val("").attr("readonly",false).attr("disabled",false)},clickOnUsePoints:function(){$("#moo-checkout-form-loyalty .loyaltyButtons > .sooUsePointsButton").hide();$("#moo-checkout-form-loyalty .loyaltyButtons > .sooRemovePointsButton").show();$("#moo-checkout-form-loyalty .usePointsInput").show();this.setLoyaltyError("");$("#moo-checkout-form-loyalty .usePointsInput .sooValidatePoints .sooValidatePointsButton").show();$("#moo-checkout-form-loyalty .usePointsInput .sooValidatePoints .sooEditPointsButton").hide();$("#sooSelectedPointsValue").attr("disabled",false).attr("readonly",false)},clickOnRemovePoints:function(){this.removePoints();$("#moo-checkout-form-loyalty .loyaltyButtons > .sooUsePointsButton").show();$("#moo-checkout-form-loyalty .loyaltyButtons > .sooRemovePointsButton").hide();$("#moo-checkout-form-loyalty .usePointsInput").hide();this.updateTotalsSection(sooCheckout.options.totals)},changePointsValue:function(){this.setLoyaltyError("");const points=$("#sooSelectedPointsValue").val();if(points.match(/^[0-9]+$/)&&points>0){const maxAllowed=this.getMaxPointsAllowed();const amount=this.getValueOfPoints(points);if(amount>0){const elm=$("#moo-checkout-form-loyalty > div.moo-checkout-bloc-content > div.moo-row.usePointsInput  .sooToPayInfo > .sooToPayAmount");elm.html("$"+this.formatPrice(amount))}if(maxAllowed<points){if(maxAllowed===0){this.setLoyaltyError(`${mooGlobalParams.pointsLabel} can't be used for this order.`)}else{this.setLoyaltyError("The maximum number of "+mooGlobalParams.pointsLabel+" that can be used is "+maxAllowed)}}}else{this.setLoyaltyError("Not a valid number")}},usePoints:function(){this.setLoyaltyError("");const points=$("#sooSelectedPointsValue").val();if(points.match(/^[0-9]+$/)&&points>0){const customer=this.getLoggedInCustomer();const settings=this.getLoyaltySettings();const maxAllowed=this.getMaxPointsAllowed();if(!customer||!settings){this.setLoyaltyError("Your session has been expired, please refresh the page");return}if(customer.point\_count<points){this.setLoyaltyError("Insufficient balance");return}if(settings.min\_points\_to\_order&&settings.min\_points\_to\_order>points){this.setLoyaltyError("The store owner has set a minimum requirement of "+settings.min\_points\_to\_order+" "+mooGlobalParams.pointsLabel+" per order.");return}if(settings.min\_amount\_to\_up&&settings.min\_amount\_to\_up>sooCheckout.options.totals.sub\_total){this.setLoyaltyError("Minimum order amount to use points is $"+this.formatPrice(settings.min\_amount\_to\_up));return}if(maxAllowed<points){if(maxAllowed===0){this.setLoyaltyError(`${mooGlobalParams.pointsLabel} can't be used for this order.`)}else{this.setLoyaltyError("The maximum number of "+mooGlobalParams.pointsLabel+" that can be used is "+maxAllowed)}return}mooGlobalParams.points=points;mooGlobalParams.pointsAmount=Math.min(this.getValueOfPoints(points),this.getSubTotalWithoutCoupons());this.updateTotals();$("#moo-checkout-form-loyalty .usePointsInput .sooValidatePoints .sooValidatePointsButton").hide();$("#moo-checkout-form-loyalty .usePointsInput .sooValidatePoints .sooEditPointsButton").show();$("#sooSelectedPointsValue").attr("disabled",true).attr("readonly",true)}else{this.setLoyaltyError("Not a valid number")}},editPoints:function(){mooGlobalParams.points=null;mooGlobalParams.pointsAmount=null;this.setLoyaltyError("");$("#moo-checkout-form-loyalty .usePointsInput .sooValidatePoints .sooValidatePointsButton").show();$("#moo-checkout-form-loyalty .usePointsInput .sooValidatePoints .sooEditPointsButton").hide();$("#sooSelectedPointsValue").attr("disabled",false).attr("readonly",false);this.updateTotalsSection(sooCheckout.options.totals)},setLoyaltyError:function(err){$("#moo-checkout-form-loyalty > div.moo-checkout-bloc-content > div.moo-row.usePointsInput .moo-error-section").html(err).show()},openLoyaltyDetails:function(){const settings=this.getLoyaltySettings();const maxPointsAllowed=this.getMaxPointsAllowed();const earningMsg=this.getEarningMessage();if(!settings){this.showErrorAlert(mooObjectL10n.error,mooObjectL10n.anErrorOccurred);return}let htmlDiv='<div class="soo-loyalty-conditions"><div class="moo-row"><div class="moo-col-md-12"><ul>';htmlDiv+=`<li>- Get $${this.formatPrice(settings.per\_x\_usd)} discount when redeeming ${settings.nb\_points} ${mooGlobalParams.pointsLabel}</li>`;if(settings.purchase\_usd\_value){if(settings.calc\_method==="subtotal"){htmlDiv+=`<li>- Earn ${settings.purchase\_usd\_value} ${mooGlobalParams.pointsLabel} for every dollar spent (based on Subtotal).</li>`}else{htmlDiv+=`<li>- Earn ${settings.purchase\_usd\_value} ${mooGlobalParams.pointsLabel} for every dollar spent.</li>`}}else{htmlDiv+=`<li>- Earn ${settings.purchase\_fixed\_points} ${mooGlobalParams.pointsLabel} on each order placed.</li>`}if(settings.order\_source.website===false){htmlDiv+=`<li>- ${mooGlobalParams.pointsLabel} not earned for purchases made through our website, try our Mobile App.</li>`}if(settings.max\_points\_per\_order){htmlDiv+=`<li>- Maximum of ${settings.max\_points\_per\_order} ${mooGlobalParams.pointsLabel} can be earned per order.</li>`}if(settings.min\_points\_to\_order){htmlDiv+=`<li>- Minimum requirement of ${settings.min\_points\_to\_order} ${mooGlobalParams.pointsLabel} should be used per order.</li>`}if(settings.min\_amount\_to\_up){htmlDiv+=`<li>- Minimum order amount required to use ${mooGlobalParams.pointsLabel} is $${this.formatPrice(settings.min\_amount\_to\_up)}</li>`}const subTotalWithoutCoupons=this.getSubTotalWithoutCoupons();const maxPercent=settings.percent\_to\_cover?settings.percent\_to\_cover:100;htmlDiv+=`<li>- ${mooGlobalParams.pointsLabel} can cover up to ${maxPercent}% of $${this.formatPrice(subTotalWithoutCoupons)} (Subtotal - Coupon)</li>`;if(maxPointsAllowed>0){htmlDiv+=`<li>- Maximum of ${maxPointsAllowed} ${mooGlobalParams.pointsLabel} can be used for this order.</li>`}else{htmlDiv+=`<li>- ${mooGlobalParams.pointsLabel} can't be used for this order.</li>`}htmlDiv+=`<li>- <b>${earningMsg}</b></li>`;htmlDiv+="</ul></div></div></div>";Swal.fire({imageUrl:null,title:"Loyalty Conditions",html:htmlDiv,showCancelButton:false,allowOutsideClick:true}).then(function(){setTimeout(p=>$(".sooLoyaltyDetailsButton").focus(),500)})},removePoints:function(){mooGlobalParams.points=null;mooGlobalParams.pointsAmount=null;this.setLoyaltyError("");$("#sooSelectedPointsValue").val(0);$("#moo-checkout-form-loyalty > div.moo-checkout-bloc-content > div.moo-row.usePointsInput .sooToPayInfo > .sooToPayAmount").html("$0.00");this.updateTotalsSection(sooCheckout.options.totals)},getCouponByCode:function(code){const url=sooCheckout.options.restApiUrl+"moo-clover/v2/checkout/check\_coupon";return fetch(url,{method:"POST",mode:"cors",cache:"no-cache",credentials:"same-origin",headers:{"Content-Type":"application/json"},redirect:"follow",referrerPolicy:"no-referrer",body:JSON.stringify({code:code})})},canAcceptCoupons:function(){if(mooGlobalParams.selectedOrderType){return this.isTrue(mooGlobalParams.selectedOrderType.use\_coupons)}return true},canAcceptPoints:function(){if(mooGlobalParams.isGuest){return false}return sooCheckout.options.loyaltySetting!==null},isOrderTaxable:function(){if(mooGlobalParams.selectedOrderType&&!mooCheckout.isTrue(mooGlobalParams.selectedOrderType.taxable)){return false}return true},showCheckoutDetails:function(){this.changeElemVisibility("#sooAuthSection","hide");this.showOrHideASection("checkout-form",true);this.fillCustomerInfo();if(this.canAcceptPoints()){this.changeElemVisibility("#moo-checkout-form-loyalty","show");this.fillCustomerPointsBalance()}else{this.changeElemVisibility("#moo-checkout-form-loyalty","hide")}if(this.countAvailableOrderingMethods()===1){$('#moo-checkout-form-ordertypes input[name="ordertype"]:not(:disabled)').prop("checked",true);this.orderTypeChanged()}if(this.countAvailablePaymentMethods()===1){$('#moo-checkout-form-payments input[name="paymentMethod"]:not(:disabled)').prop("checked",true);this.paymentMethodChanged()}this.tipPercentageChanged();if(localStorage.getItem("soo-coupon")){$("#moo\_coupon").val(localStorage.getItem("soo-coupon"));mooCheckout.applyCoupon(false)}},getValueOfPoints:function(points){const settings=this.getLoyaltySettings();if(settings){return Math.round(points\*settings.per\_x\_usd/settings.nb\_points)}return 0},getLoyaltySettings:function(){return sooCheckout.options.loyaltySetting},getMaxPointsAllowed:function(){let customer=this.getLoggedInCustomer();if(customer){let percentAmount=100;const subTotalWithoutCoupons=this.getSubTotalWithoutCoupons();const settings=this.getLoyaltySettings();if(settings){if(!isNaN(parseInt(settings.percent\_to\_cover))){percentAmount=parseInt(settings.percent\_to\_cover)}}else{return 0}const amountToCover=subTotalWithoutCoupons\*percentAmount/100;const requiredPoints=Math.ceil(amountToCover\*settings.nb\_points/settings.per\_x\_usd);return Math.min(requiredPoints,customer.point\_count)}return 0},getEarningMessage:function(){let willBeEarned=0;const orderAmount=this.getOrderTotal();const settings=this.getLoyaltySettings();if(settings){if(settings.order\_source.website!==false){if(settings.purchase\_usd\_value){if(settings.calc\_method==="subtotal"){willBeEarned=Math.round(settings.purchase\_usd\_value\*sooCheckout.options.totals.sub\_total/100)}else{willBeEarned=Math.round(settings.purchase\_usd\_value\*orderAmount/100)}}else{willBeEarned=settings.purchase\_fixed\_points}if(!settings.earn\_on\_all\_order){if(mooGlobalParams.points>0){willBeEarned=0}}}if(willBeEarned>0){return`By placing this order you will earn ${willBeEarned} ${mooGlobalParams.pointsLabel}.`}else{return`No ${mooGlobalParams.pointsLabel} will be earned for this order.`}}else{return`<li>${mooGlobalParams.pointsLabel} can't be earned for this order.</li>`}},getSubTotalWithoutCoupons:function(){if(this.canAcceptCoupons()&&mooGlobalParams.couponAmount){return sooCheckout.options.totals.sub\_total-mooGlobalParams.couponAmount}else{return sooCheckout.options.totals.sub\_total}},getOrderTotal:function(){const cartTotals=sooCheckout.options.totals;const totals=mooCheckout.getTotals();let taxAmount=0;if(totals.orderTaxable){if(totals.discounts===0){taxAmount=cartTotals.taxes}else{taxAmount=cartTotals.taxes\_after\_discount}}return cartTotals.sub\_total+taxAmount+totals.deliveryAmount+totals.serviceFee-totals.discounts}};window.moo\_clover\_gateway={mountElements:function(){if(sooCheckout.options.creditCard){if($("#moo\_CloverCardNumber").length){window.clover\_card.mount("#moo\_CloverCardNumber");window.clover\_exp.mount("#moo\_CloverCardDate");window.clover\_cvc.mount("#moo\_CloverCardCvv");window.clover\_zip.mount("#moo\_CloverCardZip");if(window.clover\_streetAddress){window.clover\_streetAddress.mount("#moo\_CloverStreetAddress")}}}if(sooCheckout.options.giftCards){if($("#moo\_CloverGiftCard").length){window.clover\_giftCard.mount("#moo\_CloverGiftCard")}}if(sooCheckout.options.googlePay){if($("#moo-cloverGooglePay").length){window.clover\_googlepay.mount("#moo-cloverGooglePay")}}},createElements:function(){const elementStyles={input:{color:"#31325F",height:"30px","::placeholder":{color:"#CFD7E0"}}};if(sooCheckout.options.creditCard){window.clover\_card=window.elements.create("CARD\_NUMBER",elementStyles);window.clover\_exp=window.elements.create("CARD\_DATE",elementStyles);window.clover\_cvc=window.elements.create("CARD\_CVV",elementStyles);window.clover\_zip=window.elements.create("CARD\_POSTAL\_CODE",elementStyles);window.clover\_card.addEventListener("change",function(event){moo\_clover\_gateway.onCCFormChange();$(document.body).trigger("cloverError",event)});window.clover\_exp.addEventListener("change",function(event){moo\_clover\_gateway.onCCFormChange();$(document.body).trigger("cloverError",event)});window.clover\_cvc.addEventListener("change",function(event){moo\_clover\_gateway.onCCFormChange();$(document.body).trigger("cloverError",event)});window.clover\_zip.addEventListener("change",function(event){moo\_clover\_gateway.onCCFormChange();$(document.body).trigger("cloverError",event)});if(sooCheckout.options.showStreetAddressField){window.clover\_streetAddress=window.elements.create("CARD\_STREET\_ADDRESS",elementStyles);window.clover\_streetAddress.addEventListener("change",function(event){moo\_clover\_gateway.onCCFormChange();$(document.body).trigger("cloverError",event)})}}if(sooCheckout.options.giftCards){const giftCardStyles={input:{"border-radius":"5px",height:"45px",padding:"10px",color:"#31325F",border:"1px solid #ccc","::placeholder":{color:"#CFD7E0"}},body:{margin:"0;",border:"0.7px solid #B8B8B8FF;","border-radius":"10px;",padding:"10px;",width:"96%;","overflow-x":" hidden;"},".fieldError input":{"border-color":"red",color:"red"},".errorMessage":{color:"red","min-height":"10px;"},".sectionHeader":{display:"none"}};window.clover\_giftCard=window.elements.create("GIFT\_CARD\_ELEMENTS",giftCardStyles);window.clover\_giftCard.addEventListener("change",function(event){moo\_clover\_gateway.onGiftCardChange(event);$(document.body).trigger("cloverGiftCardError",event)})}if(sooCheckout.options.googlePay){const paymentReqData={total:{label:"Online Order",amount:sooCheckout.options.totals.sub\_total},options:{button:{buttonType:"long"}}};window.clover\_googlepay=window.elements.create("PAYMENT\_REQUEST\_BUTTON",{paymentReqData:paymentReqData});window.clover\_googlepay.addEventListener("paymentMethod",function(tokenData){window.googlePayToken=tokenData;try{$("#moo-cloverGooglePay").hide();$("#moo\_checkout\_loading").show();$("#moo-checkout .errors-section").html("");window.mooCheckout.getCheckoutForm()}catch(e){console.log(e);window.mooCheckout.showErrorAlert(mooObjectL10n.anErrorOccurred)}})}window.moo\_clover\_gateway.mountElements()},init:function(){$(document).on("cloverError",this.onError).on("cloverGiftCardError",this.onGiftCardError).on("checkout\_error",this.reset);moo\_clover\_gateway.createElements()},isMobile:function(){if(/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)){return true}return false},getSelectedPaymentElement:function(){return $('.payment\_methods input[name="payment\_method"]:checked')},createSource:function(){return clover.createToken().then(moo\_clover\_gateway.sourceResponse)},sourceResponse:function(response){if(response.error){return $(document.body).trigger("cloverError",response)}moo\_clover\_gateway.reset();$("#moo-CloverToken").val(response.token)},onCCFormChange:function(){},onGiftCardChange:function(e){console.log("onGiftCardChange");console.log(e)},reset:function(){if(!$("#moo-checkout-form-payments #moo-cloverCreditCardPanel .clover-error").length){}},onError:function(e,result){var hasError=false;var errorMessage="";if(result.CARD\_NUMBER.error){errorMessage=result.CARD\_NUMBER.error;hasError=true}else{if(result.CARD\_DATE.error){errorMessage=result.CARD\_DATE.error;hasError=true}else{if(result.CARD\_CVV.error){errorMessage=result.CARD\_CVV.error;hasError=true}else{if(result.CARD\_STREET\_ADDRESS&&result.CARD\_STREET\_ADDRESS.error){errorMessage=result.CARD\_STREET\_ADDRESS.error;hasError=true}else{if(result.CARD\_POSTAL\_CODE.error){errorMessage=result.CARD\_POSTAL\_CODE.error;hasError=true}}}}}window.cloverCardIsValid=!hasError;window.cloverCardErrorMsg=errorMessage;try{if(errorMessage===""){errorMessage=!result.CARD\_NUMBER.touched?mooObjectL10n.CardNumberRequired:!result.CARD\_DATE.touched?mooObjectL10n.CardDateRequired:!result.CARD\_CVV.touched?"Card Cvv is required":result.CARD\_STREET\_ADDRESS&&!result.CARD\_STREET\_ADDRESS.touched?mooObjectL10n.CardStreetAddressRequired:!result.CARD\_POSTAL\_CODE.touched?mooObjectL10n.CardZipRequired:window.cloverCardErrorMsg}if(errorMessage!==window.cloverCardErrorMsg){window.cloverCardIsValid=false;window.cloverCardErrorMsg=errorMessage}}catch(e){console.log(e)}},onGiftCardError:function(e,result){console.log(result);window.cloverGiftCardIsValid=result?.GIFT\_CARD\_ELEMENTS?.isFormValid;console.log(window.cloverGiftCardIsValid)},submitError:function(error\_message){}};$(document).ready(function(){window.mooCheckout.init();if(sooCheckout.options.pakmsKey){try{window.clover=new Clover(sooCheckout.options.pakmsKey,{locale:sooCheckout.options.locale});window.elements=window.clover.elements();window.cloverCardIsValid=false;window.cloverGiftCardIsValid=false;window.cloverCardErrorMsg=mooObjectL10n.CardNumberRequired;window.moo\_clover\_gateway.init()}catch(error){console.log(error)}}})}); |
* ## [clover-online-orders/trunk/public/js/dist/sooSearchbar.min.js](/changeset/3168433/clover-online-orders/trunk/public/js/dist/sooSearchbar.min.js "Show the changeset 3168433 restricted to clover-online-orders/trunk/public/js/dist/sooSearchbar.min.js")

  | [r2936448](/browser/clover-online-orders/trunk/public/js/dist/sooSearchbar.min.js?rev=2936448#L1 "Show revision 2936448 of this file in browser") | [r3168433](/browser/clover-online-orders/trunk/public/js/dist/sooSearchbar.min.js?rev=3168433#L1 "Show revision 3168433 of this file in browser") |  |
  | --- | --- | --- |
  | 1 |  | jQuery(document).ready(function(){window.moo\_RestUrl=moo\_params.moo\_RestUrl;window.moo\_theme\_setings=[];window.moo\_mg\_setings={};~~console.log(window.moo\_nbItemsPerLine);if(!window.moo\_nbItemsPerLine){window.moo\_nbItemsPerLine=jQuery("#moo-search-bar-container").width()<1e3?3:4}console.log(window.moo\_nbItemsPerLine);~~jQuery.get(moo\_RestUrl+"moo-clover/v1/theme\_settings/default",function(data){if(data!==null&&data.settings!==null){window.moo\_theme\_setings=data.settings;window.nb\_items\_in\_cart=data.nb\_items}});jQuery.get(moo\_RestUrl+"moo-clover/v1/mg\_settings",function(data){if(data!==null&&data.settings!==null){window.moo\_mg\_setings=data.settings}})});function mooClickonSearchButton(e){e.preventDefault();var keyword=jQuery(".moo-search-field").val();if(keyword.length>0){mooShowLoadingForSearch();jQuery.get(moo\_RestUrl+"moo-clover/v1/search/"+keyword,function(data){if(data.items!==null&&data.items.length>0){mooRenderItemsForSearch(data.items)}else{jQuery(".moo-search-result").html("Sorry, we don't find any item")}}).fail(function(){jQuery(".moo-search-result").html("Sorry, we don't find any item")})}}function mooShowSearchResultContainer(){jQuery(".moo-search-result").slideDown()}function mooHideSearchResultContainer(){jQuery(".moo-search-result").slideUp()}function mooShowLoadingForSearch(){jQuery(".moo-search-result").html("<div id='MooLoading'></div>");mooShowSearchResultContainer()}function moohideLoadingForSearch(){mooHideSearchResultContainer();jQuery(".moo-search-result").html("")}function mooRenderItemsForSearch(items){var html='<div class="moo-row">';for(var i in items){var item=items[i];var item\_price=parseFloat(item.price);item\_price=item\_price/100;item\_price=item\_price.toFixed(2);if(item.price>0&&item.price\_type==="PER\_UNIT")item\_price+="/"+item.unit\_name;if(i%window.moo\_nbItemsPerLine===0){html+='<div class="moo-col-md-'+12/window.moo\_nbItemsPerLine+'" style="clear: both">'}else{html+='<div class="moo-col-md-'+12/window.moo\_nbItemsPerLine+'">'}html+='<a title="'+item.description+'" class="link" href="#item-'+item.uuid.toLowerCase()+'" data-item-id="'+item.uuid.toLowerCase()+'" onclick="MooClickOnItem(event,this)">';if(item.image!==null&&item.image.url!==null&&item.image.url!==""){html+='<div class="image-wrapper" style="background: url('+item.image.url+') no-repeat center;background-size:100%;"></div>'}else{html+='<div class="image-wrapper">'+'<img class="moo-image" alt="" data-image-vertical="1" width="100%" height="100%" src="'+moo\_params["plugin\_img"]+'/noImg.png" />'+"</div>"}html+='<h2 class="title"><span class="brand "></span>'+'<span class="name">'+item.name+"</span>"+"</h2>"+'<div class="price-container clearfix">'+'<div class="price-box">'+'<span class="price">';if(parseFloat(item.price)===0){html+="<span></span>"}else{html+="<span>$"+item\_price+"</span>"}html+="</span>"+"</div>"+"</div>"+'<div class="btn-wrapper"><span class="moo-category-name">';if(item.stockCount==="out\_of\_stock"){html+='<button class="osh-btn"><span class="label">OUT OF STOCK</span></button>'}else{if(window.moo\_theme\_setings.onePage\_qtyWindow!==null&&window.moo\_theme\_setings.jTheme\_qtyWindow==="on"){if(item.has\_modifiers){if(window.moo\_theme\_setings.jTheme\_qtyWindowForModifiers!==null&&window.moo\_theme\_setings.jTheme\_qtyWindowForModifiers==="on")html+='<button class="osh-btn" onclick="mooOpenQtyWindow(event,\''+item.uuid+"','"+item.stockCount+'\',moo\_clickOnOrderBtnFIWM)"><span class="label">Choose Qty & Options</span></button>';else html+='<button class="osh-btn" onclick="moo\_clickOnOrderBtnFIWM(event,\''+item.uuid+'\',1)"><span class="label">Choose Options & Qty</span></button>'}else{html+='<button class="osh-btn" onclick="mooOpenQtyWindow(event,\''+item.uuid+"','"+item.stockCount+'\',moo\_clickOnOrderBtn)"><span class="label">Add to cart</span></button>'}}else{if(item.has\_modifiers)html+='<button class="osh-btn" onclick="moo\_clickOnOrderBtnFIWM(event,\''+item.uuid+'\',1)"><span class="label"> Choose Options & Qty </span></button>';else html+='<button class="osh-btn" onclick="moo\_clickOnOrderBtn(event,\''+item.uuid+'\',1)"><span class="label">Add to cart</span> </button>'}}html+="</span></div></a></div>"}html+="</div>";html+='<div class="moo-back-to-categories"><button class="osh-btn" onclick="mooHideSearchResultContainer()">'+'<span class="label">Close Search</span>'+"</button></div>";jQuery(".moo-search-result").html(html).promise().done(function(){console.log("Search done")})}function MooClickOnItem(event,elm){event.preventDefault();var item\_id=jQuery(elm).attr("data-item-id")}function mooOpenQtyWindow(event,item\_id,stockCount,callback){event.preventDefault();var inputOptions=new Promise(function(resolve){if(stockCount=="not\_tracking\_stock"||stockCount=="tracking\_stock"){resolve({1:"1",2:"2",3:"3",4:"4",5:"5",6:"6",7:"7",8:"8",9:"9",10:"10",custom:"Custom Quantity"})}else{var options={};var QtyMax=parseInt(stockCount)>10?10:parseInt(stockCount);var count=QtyMax;for(var $i=1;$i<=QtyMax;$i++){options[$i.toString()]=$i.toString();if(!--count){options["custom"]="Custom Quantity";resolve(options)}}}});swal({title:"Select the quantity",showLoaderOnConfirm:true,confirmButtonText:"Add",input:"select",inputClass:"moo-form-control",inputOptions:inputOptions,showCancelButton:true,preConfirm:function(value){return new Promise(function(resolve,reject){if(value=="custom")mooOpenCustomQtyWindow(event,item\_id,callback);else callback(event,item\_id,value)})}}).then(function(){},function(dismiss){})}function mooOpenCustomQtyWindow(event,item\_id,callback){swal({title:"Enter the quantity",input:"text",showCancelButton:true,showLoaderOnConfirm:true,inputValidator:function(value){return new Promise(function(resolve,reject){if(value!=""&&parseInt(value)>0){callback(event,item\_id,parseInt(value))}else{reject("You need to write a number")}})}}).then(function(){},function(){})}function moo\_clickOnOrderBtn(event,item\_id,qty){var body={item\_uuid:item\_id,item\_qty:qty,item\_modifiers:{}};jQuery.post(moo\_RestUrl+"moo-clover/v1/cart",body,function(data){if(data!=null){if(data.status=="error"){swal({title:data.message,type:"error"})}else{swal({title:data.name,text:"Added to cart",timer:3e3,type:"success"})}}else{swal({title:"Item not added, try again",type:"error"})}}).fail(function(data){swal({title:"Item not added, try again",text:"Check your internet connection or contact us",type:"error"});console.log(data)}).done(function(data){if(typeof data.nb\_items!="undefined")jQuery("#moo-cartNbItems").text(data.nb\_items)})}function moo\_clickOnOrderBtnFIWM(event,item\_id,qty){event.preventDefault();var target=event.target;var old\_text=jQuery(target).text();jQuery(target).text("Loading options");jQuery.get(moo\_RestUrl+"moo-clover/v1/items/"+item\_id,function(data){jQuery(target).text(old\_text);if(data!=null){if(data.modifier\_groups.length>0){if(typeof mooBuildModifiersPanel=="function"){if(Object.keys(window.moo\_mg\_setings).length>0){mooBuildModifiersPanel(data.modifier\_groups,item\_id,qty,window.moo\_mg\_setings)}else{mooBuildModifiersPanel(data.modifier\_groups,item\_id,qty)}}else{swal("Try again","Please refresh the page, An error has occurred","error")}}else moo\_clickOnOrderBtn(event,item\_id,qty)}else{jQuery(target).text(old\_text);swal({title:"Error",text:"We cannot Load the options for this item, please refresh the page or contact us",type:"error",confirmButtonText:"ok"})}}).fail(function(data){jQuery(target).text(old\_text);swal({title:"Error",text:"We cannot Load the options for this item, please refresh the page or contact us",type:"error",confirmButtonText:"ok"})})} |
  |  | 1 | jQuery(document).ready(function(){window.moo\_RestUrl=moo\_params.moo\_RestUrl;window.moo\_theme\_setings=[];window.moo\_mg\_setings={};if(!window.moo\_nbItemsPerLine){window.moo\_nbItemsPerLine=jQuery("#moo-search-bar-container").width()<1e3?3:4}jQuery.get(moo\_RestUrl+"moo-clover/v1/theme\_settings/default",function(data){if(data!==null&&data.settings!==null){window.moo\_theme\_setings=data.settings;window.nb\_items\_in\_cart=data.nb\_items}});jQuery.get(moo\_RestUrl+"moo-clover/v1/mg\_settings",function(data){if(data!==null&&data.settings!==null){window.moo\_mg\_setings=data.settings}})});function mooClickonSearchButton(e){e.preventDefault();var keyword=jQuery(".moo-search-field").val();if(keyword.length>0){mooShowLoadingForSearch();jQuery.get(moo\_RestUrl+"moo-clover/v1/search/"+keyword,function(data){if(data.items!==null&&data.items.length>0){mooRenderItemsForSearch(data.items)}else{jQuery(".moo-search-result").html("Sorry, we don't find any item")}}).fail(function(){jQuery(".moo-search-result").html("Sorry, we don't find any item")})}}function mooShowSearchResultContainer(){jQuery(".moo-search-result").slideDown()}function mooHideSearchResultContainer(){jQuery(".moo-search-result").slideUp()}function mooShowLoadingForSearch(){jQuery(".moo-search-result").html("<div id='MooLoading'></div>");mooShowSearchResultContainer()}function moohideLoadingForSearch(){mooHideSearchResultContainer();jQuery(".moo-search-result").html("")}function mooRenderItemsForSearch(items){var html='<div class="moo-row">';for(var i in items){var item=items[i];var item\_price=parseFloat(item.price);item\_price=item\_price/100;item\_price=item\_price.toFixed(2);if(item.price>0&&item.price\_type==="PER\_UNIT")item\_price+="/"+item.unit\_name;if(i%window.moo\_nbItemsPerLine===0){html+='<div class="moo-col-md-'+12/window.moo\_nbItemsPerLine+'" style="clear: both">'}else{html+='<div class="moo-col-md-'+12/window.moo\_nbItemsPerLine+'">'}html+='<a title="'+item.description+'" class="link" href="#item-'+item.uuid.toLowerCase()+'" data-item-id="'+item.uuid.toLowerCase()+'" onclick="MooClickOnItem(event,this)">';if(item.image!==null&&item.image.url!==null&&item.image.url!==""){html+='<div class="image-wrapper" style="background: url('+item.image.url+') no-repeat center;background-size:100%;"></div>'}else{html+='<div class="image-wrapper">'+'<img class="moo-image" alt="" data-image-vertical="1" width="100%" height="100%" src="'+moo\_params["plugin\_img"]+'/noImg.png" />'+"</div>"}html+='<h2 class="title"><span class="brand "></span>'+'<span class="name">'+item.name+"</span>"+"</h2>"+'<div class="price-container clearfix">'+'<div class="price-box">'+'<span class="price">';if(parseFloat(item.price)===0){html+="<span></span>"}else{html+="<span>$"+item\_price+"</span>"}html+="</span>"+"</div>"+"</div>"+'<div class="btn-wrapper"><span class="moo-category-name">';if(item.stockCount==="out\_of\_stock"){html+='<button class="osh-btn"><span class="label">OUT OF STOCK</span></button>'}else{if(window.moo\_theme\_setings.onePage\_qtyWindow!==null&&window.moo\_theme\_setings.jTheme\_qtyWindow==="on"){if(item.has\_modifiers){if(window.moo\_theme\_setings.jTheme\_qtyWindowForModifiers!==null&&window.moo\_theme\_setings.jTheme\_qtyWindowForModifiers==="on")html+='<button class="osh-btn" onclick="mooOpenQtyWindow(event,\''+item.uuid+"','"+item.stockCount+'\',moo\_clickOnOrderBtnFIWM)"><span class="label">Choose Qty & Options</span></button>';else html+='<button class="osh-btn" onclick="moo\_clickOnOrderBtnFIWM(event,\''+item.uuid+'\',1)"><span class="label">Choose Options & Qty</span></button>'}else{html+='<button class="osh-btn" onclick="mooOpenQtyWindow(event,\''+item.uuid+"','"+item.stockCount+'\',moo\_clickOnOrderBtn)"><span class="label">Add to cart</span></button>'}}else{if(item.has\_modifiers)html+='<button class="osh-btn" onclick="moo\_clickOnOrderBtnFIWM(event,\''+item.uuid+'\',1)"><span class="label"> Choose Options & Qty </span></button>';else html+='<button class="osh-btn" onclick="moo\_clickOnOrderBtn(event,\''+item.uuid+'\',1)"><span class="label">Add to cart</span> </button>'}}html+="</span></div></a></div>"}html+="</div>";html+='<div class="moo-back-to-categories"><button class="osh-btn" onclick="mooHideSearchResultContainer()">'+'<span class="label">Close Search</span>'+"</button></div>";jQuery(".moo-search-result").html(html).promise().done(function(){console.log("Search done")})}function MooClickOnItem(event,elm){event.preventDefault();var item\_id=jQuery(elm).attr("data-item-id")}function mooOpenQtyWindow(event,item\_id,stockCount,callback){event.preventDefault();var inputOptions=new Promise(function(resolve){if(stockCount=="not\_tracking\_stock"||stockCount=="tracking\_stock"){resolve({1:"1",2:"2",3:"3",4:"4",5:"5",6:"6",7:"7",8:"8",9:"9",10:"10",custom:"Custom Quantity"})}else{var options={};var QtyMax=parseInt(stockCount)>10?10:parseInt(stockCount);var count=QtyMax;for(var $i=1;$i<=QtyMax;$i++){options[$i.toString()]=$i.toString();if(!--count){options["custom"]="Custom Quantity";resolve(options)}}}});swal({title:"Select the quantity",showLoaderOnConfirm:true,confirmButtonText:"Add",input:"select",inputClass:"moo-form-control",inputOptions:inputOptions,showCancelButton:true,preConfirm:function(value){return new Promise(function(resolve,reject){if(value=="custom")mooOpenCustomQtyWindow(event,item\_id,callback);else callback(event,item\_id,value)})}}).then(function(){},function(dismiss){})}function mooOpenCustomQtyWindow(event,item\_id,callback){swal({title:"Enter the quantity",input:"text",showCancelButton:true,showLoaderOnConfirm:true,inputValidator:function(value){return new Promise(function(resolve,reject){if(value!=""&&parseInt(value)>0){callback(event,item\_id,parseInt(value))}else{reject("You need to write a number")}})}}).then(function(){},function(){})}function moo\_clickOnOrderBtn(event,item\_id,qty){var body={item\_uuid:item\_id,item\_qty:qty,item\_modifiers:{}};jQuery.post(moo\_RestUrl+"moo-clover/v1/cart",body,function(data){if(data!=null){if(data.status=="error"){swal({title:data.message,type:"error"})}else{swal({title:data.name,text:"Added to cart",timer:3e3,type:"success"})}}else{swal({title:"Item not added, try again",type:"error"})}}).fail(function(data){swal({title:"Item not added, try again",text:"Check your internet connection or contact us",type:"error"});console.log(data)}).done(function(data){if(typeof data.nb\_items!="undefined")jQuery("#moo-cartNbItems").text(data.nb\_items)})}function moo\_clickOnOrderBtnFIWM(event,item\_id,qty){event.preventDefault();var target=event.target;var old\_text=jQuery(target).text();jQuery(target).text("Loading options");jQuery.get(moo\_RestUrl+"moo-clover/v1/items/"+item\_id,function(data){jQuery(target).text(old\_text);if(data!=null){if(data.modifier\_groups.length>0){if(typeof mooBuildModifiersPanel=="function"){if(Object.keys(window.moo\_mg\_setings).length>0){mooBuildModifiersPanel(data.modifier\_groups,item\_id,qty,window.moo\_mg\_setings)}else{mooBuildModifiersPanel(data.modifier\_groups,item\_id,qty)}}else{swal("Try again","Please refresh the page, An error has occurred","error")}}else moo\_clickOnOrderBtn(event,item\_id,qty)}else{jQuery(target).text(old\_text);swal({title:"Error",text:"We cannot Load the options for this item, please refresh the page or contact us",type:"error",confirmButtonText:"ok"})}}).fail(function(data){jQuery(target).text(old\_text);swal({title:"Error",text:"We cannot Load the options for this item, please refresh the page or contact us",type:"error",confirmButtonText:"ok"})})} |
* ## [clover-online-orders/trunk/readme.txt](/changeset/3168433/clover-online-orders/trunk/readme.txt "Show the changeset 3168433 restricted to clover-online-orders/trunk/readme.txt")

  | [r3142846](/browser/clover-online-orders/trunk/readme.txt?rev=3142846#L1 "Show revision 3142846 of this file in browser") | [r3168433](/browser/clover-online-orders/trunk/readme.txt?rev=3168433#L1 "Show revision 3168433 of this file in browser") |  |
  | --- | --- | --- |
  | 1 |  | ~~﻿~~=== Smart Online Order for Clover === |
  |  | 1 | === Smart Online Order for Clover === |
  | 2 | 2 | Contributors: elbanyaoui, khalid995 |
  | 3 | 3 | Donate link: http://www.zaytech.com/ |
  | 4 |  | Tags: clover,online orders for clover,~~zaytech online orders,Clover online orders, Online orders for Clover, Wordpress and Clover,Clover, online ordering for clover, online order for clover pos, Online ordering for Clover POS,c~~lover POS |
  |  | 4 | Tags: clover,online orders for clover, Online orders for Clover, Wordpress and Clover, Online ordering for Clover POS |
  | 5 | 5 | Requires at least: 4.7.1 |
  | 6 |  | Tested up to: 6.6.~~1~~ |
  |  | 6 | Tested up to: 6.6.2 |
  | 7 | 7 | Requires PHP: 5.2.0 |
  | 8 |  | Stable tag: 1.5.~~7~~ |
  |  | 8 | Stable tag: 1.5.8 |
  | 9 | 9 | License: GPLv2 or later |
  | 10 | 10 | License URI: http://www.gnu.org/licenses/gpl-2.0.html |
  | […](/browser/clover-online-orders/trunk/readme.txt?rev=3142846#L150) | […](/browser/clover-online-orders/trunk/readme.txt?rev=3168433#L150) |  |
  | 150 | 150 | == Changelog == |
  | 151 | 151 |  |
  |  | 152 | = 1.5.8 = |
  |  | 153 | \* Enhanced compatibility with the latest WordPress version. |
  |  | 154 | \* Updated and refined the item list. |
  |  | 155 | \* Set the new checkout as the default option. |
  |  | 156 | \* Added integration with DoorDash. |
  |  | 157 | \* Various other improvements to enhance user experience. |
  |  | 158 |  |
  | 152 | 159 | = 1.5.7 = |
  | 153 | 160 | \* Improved compatibility with the latest version of Wordpress. |
  | […](/browser/clover-online-orders/trunk/readme.txt?rev=3142846#L181) | […](/browser/clover-online-orders/trunk/readme.txt?rev=3168433#L188) |  |
  | 181 | 188 | \* Fixed issue when modifier qty was manually entered |
  | 182 | 189 | \* Improved the design of the list of orders |
  | 183 |  | \* Orders now show where the source of the order originated from. For example, if you have Branded App, then you will see: Web, IOS, or Android. |
  |  | 190 | \* Orders now show where the source of the order originated from. For example, if you have a Branded App, then you will see: Web, IOS, or Android. |
  | 184 | 191 | \* Improved Order Details |
  | 185 | 192 | \* Added ability to use shortcode to display receipt link on a separate “Thank You” page, [moo\_receipt\_link] or [moo\_receipt\_link text="click here"] |
  | 186 |  | \* Other General Improvements and compatibility with ~~latest version of Wordp~~ress |
  |  | 193 | \* Other General Improvements and compatibility with a latest version of WordPress |
  | 187 | 194 |  |
  | 188 | 195 | = 1.5.2 = |
* ## [clover-online-orders/trunk/uninstall.php](/changeset/3168433/clover-online-orders/trunk/uninstall.php "Show the changeset 3168433 restricted to clover-online-orders/trunk/uninstall.php")

  | [r2936448](/browser/clover-online-orders/trunk/uninstall.php?rev=2936448#L48 "Show revision 2936448 of this file in browser") | [r3168433](/browser/clover-online-orders/trunk/uninstall.php?rev=3168433#L48 "Show revision 3168433 of this file in browser") |  |
  | --- | --- | --- |
  | 48 | 48 | if($my\_account\_page\_id) wp\_delete\_post($my\_account\_page\_id,true); |
  | 49 | 49 |  |
  |  | 50 | // @codingStandardsIgnoreStart |
  | 50 | 51 |  |
  | 51 | 52 | /\*-- Table `item\_option`--\*/ |
  | 52 |  | $wpdb->query("DROP TABLE IF EXISTS `{$wpdb->prefix}moo\_item\_option` ;"); |
  |  | 53 | $wpdb->query("DROP TABLE IF EXISTS `{$wpdb->prefix}moo\_item\_option` ;"); //db call ok |
  | 53 | 54 |  |
  | 54 | 55 | /\*-- Table `item\_tax\_rate` --\*/ |
  | 55 |  | $wpdb->query("DROP TABLE IF EXISTS `{$wpdb->prefix}moo\_item\_tax\_rate` ;"); |
  |  | 56 | $wpdb->query("DROP TABLE IF EXISTS `{$wpdb->prefix}moo\_item\_tax\_rate` ;"); //db call ok |
  | 56 | 57 |  |
  | 57 | 58 | /\* -- Table `modifier\_group` -- \*/ |
  | 58 |  | $wpdb->query("DROP TABLE IF EXISTS `{$wpdb->prefix}moo\_item\_order` ;"); |
  |  | 59 | $wpdb->query("DROP TABLE IF EXISTS `{$wpdb->prefix}moo\_item\_order` ;"); //db call ok; no-cache ok |
  | 59 | 60 |  |
  | 60 | 61 | /\*-- Table `item\_tag` --\*/ |
  | 61 |  | $wpdb->query("DROP TABLE IF EXISTS `{$wpdb->prefix}moo\_item\_tag` ;"); |
  |  | 62 | $wpdb->query("DROP TABLE IF EXISTS `{$wpdb->prefix}moo\_item\_tag` ;"); // db call ok |
  | 62 | 63 |  |
  | 63 | 64 | /\*-- Table `item\_modifier\_group` --\*/ |
  | 64 |  | $wpdb->query("DROP TABLE IF EXISTS `{$wpdb->prefix}moo\_item\_modifier\_group` ;"); |
  |  | 65 | $wpdb->query("DROP TABLE IF EXISTS `{$wpdb->prefix}moo\_item\_modifier\_group` ;"); // db call ok |
  | 65 | 66 |  |
  | 66 | 67 | /\* -- Table `order\_types -- \*/ |
  | 67 |  | $wpdb->query("DROP TABLE IF EXISTS `{$wpdb->prefix}moo\_images` ;"); |
  |  | 68 | $wpdb->query("DROP TABLE IF EXISTS `{$wpdb->prefix}moo\_images` ;"); // db call ok |
  | 68 | 69 |  |
  | 69 | 70 | /\* -- Table `item` -- \*/ |
  | 70 |  | $wpdb->query("DROP TABLE IF EXISTS `{$wpdb->prefix}moo\_item` ;"); |
  |  | 71 | $wpdb->query("DROP TABLE IF EXISTS `{$wpdb->prefix}moo\_item` ;"); // db call ok |
  | 71 | 72 |  |
  | 72 | 73 | /\* -- Table `orders` -- \*/ |
  | 73 |  | $wpdb->query("DROP TABLE IF EXISTS `{$wpdb->prefix}moo\_order` ;"); |
  |  | 74 | $wpdb->query("DROP TABLE IF EXISTS `{$wpdb->prefix}moo\_order` ;"); // db call ok |
  | 74 | 75 |  |
  | 75 | 76 | /\*-- Table `option`--\*/ |
  | 76 |  | $wpdb->query("DROP TABLE IF EXISTS `{$wpdb->prefix}moo\_option` ;"); |
  |  | 77 | $wpdb->query("DROP TABLE IF EXISTS `{$wpdb->prefix}moo\_option` ;"); // db call ok |
  | 77 | 78 |  |
  | 78 | 79 | /\* -- Table `tag` --\*/ |
  | 79 |  | $wpdb->query("DROP TABLE IF EXISTS `{$wpdb->prefix}moo\_tag` ;"); |
  |  | 80 | $wpdb->query("DROP TABLE IF EXISTS `{$wpdb->prefix}moo\_tag` ;"); // db call ok |
  | 80 | 81 |  |
  | 81 | 82 | /\* -- Table `tax\_rate` --\*/ |
  | 82 |  | $wpdb->query("DROP TABLE IF EXISTS `{$wpdb->prefix}moo\_tax\_rate` ;"); |
  |  | 83 | $wpdb->query("DROP TABLE IF EXISTS `{$wpdb->prefix}moo\_tax\_rate` ;"); // db call ok |
  | 83 | 84 |  |
  | 84 | 85 | /\* -- Table `modifier` --\*/ |
  | […](/browser/clover-online-orders/trunk/uninstall.php?rev=2936448#L100) | […](/browser/clover-online-orders/trunk/uninstall.php?rev=3168433#L101) |  |
  | 100 | 101 | $wpdb->query("DROP TABLE IF EXISTS `{$wpdb->prefix}moo\_order\_types` ;"); |
  | 101 | 102 |  |
  |  | 103 | // @codingStandardsIgnoreEnd |
  |  | 104 |  |
  | 102 | 105 | update\_option( 'moo\_settings',''); |
  | 103 | 106 | update\_option( 'moo\_pakms\_key', ''); |
  | […](/browser/clover-online-orders/trunk/uninstall.php?rev=2936448#L107) | […](/browser/clover-online-orders/trunk/uninstall.php?rev=3168433#L110) |  |
  | 107 | 110 | update\_option( 'moo\_slug', ''); |
  | 108 | 111 | update\_option( 'moo\_new\_checkout\_enabled', ''); |
  |  | 112 | update\_option( 'moo\_old\_checkout\_enabled', ''); |
  | 109 | 113 | } |
  | 110 | 114 | switch\_to\_blog($old\_blog); |
  | […](/browser/clover-online-orders/trunk/uninstall.php?rev=2936448#L120) | […](/browser/clover-online-orders/trunk/uninstall.php?rev=3168433#L124) |  |
  | 120 | 124 | if($cart\_page\_id) wp\_delete\_post($cart\_page\_id,true); |
  | 121 | 125 | if($my\_account\_page\_id) wp\_delete\_post($my\_account\_page\_id,true); |
  |  | 126 |  |
  |  | 127 | // @codingStandardsIgnoreStart |
  | 122 | 128 |  |
  | 123 | 129 | /\*-- Table `item\_option`--\*/ |
  | […](/browser/clover-online-orders/trunk/uninstall.php?rev=2936448#L172) | […](/browser/clover-online-orders/trunk/uninstall.php?rev=3168433#L178) |  |
  | 172 | 178 | $wpdb->query("DROP TABLE IF EXISTS `{$wpdb->prefix}moo\_order\_types` ;"); |
  | 173 | 179 |  |
  |  | 180 | // @codingStandardsIgnoreEnd |
  |  | 181 |  |
  | 174 | 182 | update\_option( 'moo\_settings', ''); |
  | 175 | 183 | update\_option( 'moo\_pakms\_key', ''); |
  | […](/browser/clover-online-orders/trunk/uninstall.php?rev=2936448#L179) | […](/browser/clover-online-orders/trunk/uninstall.php?rev=3168433#L187) |  |
  | 179 | 187 | update\_option( 'moo\_slug', ''); |
  | 180 | 188 | update\_option( 'moo\_new\_checkout\_enabled', ''); |
  |  | 189 | update\_option( 'moo\_old\_checkout\_enabled', ''); |
  | 181 | 190 | } |
  | 182 | 191 | } |

**Note:** See [TracChangeset](/wiki/TracChangeset)
for help on using the changeset viewer.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Unified Diff](?format=diff&new=3168433)
* [Zip Archive](?format=zip&new=3168433)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)


