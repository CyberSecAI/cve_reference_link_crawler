- **Root cause of vulnerability**: The vulnerability is triggered by a memory allocation failure in SumatraPDF when opening two large text files. Specifically, the `EnsureCap` function attempts to allocate or reallocate memory for a string buffer. If the allocation fails, the function calls the `CrashAlwaysIf` macro which then intentionally crashes the program by dereferencing a null pointer via the `CrashMe` function.
- **Weaknesses/vulnerabilities present**: Improper error handling during memory allocation within the `EnsureCap` function leads to an intentional crash if memory allocation fails. The `CrashAlwaysIf` macro, intended as a debugging tool, can be triggered by a denial of service attack causing an unrecoverable crash.
- **Impact of exploitation**: A successful exploitation results in a denial of service (DoS). The application crashes and becomes unusable when attempting to open two large text files.
- **Attack vectors**: The attack vector is through the loading of two specifically crafted large text files (`first.txt` and `second.txt`) as command-line arguments to SumatraPDF, which causes the memory allocation failure and subsequent crash.
- **Required attacker capabilities/position**: The attacker must be able to provide two large text files as inputs to the SumatraPDF application, either through command-line arguments or by manually opening them in the application. This requires the attacker to be able to execute the SumatraPDF application with controlled input files.