- **Root cause of vulnerability**: The vulnerability was caused by the lack of proper sanitization of the output of the `getFullURL()` function in `include.cdn.php` when it's used in javascript context.
- **Weaknesses/vulnerabilities present**: Cross-Site Scripting (XSS) vulnerability. The `getFullURL()` function's output, which likely comes from user-controlled input, was directly embedded into JavaScript without proper encoding.
- **Impact of exploitation**: An attacker could inject arbitrary JavaScript code which would be executed in the context of the victim's browser, potentially leading to session hijacking, defacement, or redirection to malicious sites.
- **Attack vectors**: The attack vector is through user-controlled input that impacts the output of the `getFullURL()` function.
- **Required attacker capabilities/position**: The attacker needs to be able to influence the value returned by the `getFullURL()` function.

**Changes:**
The commit fixes the vulnerability by applying `htmlspecialchars()` with `ENT_QUOTES` on the output of `getFullURL()` in the javascript context to properly encode the data, preventing the XSS vulnerability.
```diff
--- a/include.cdn.php
+++ b/include.cdn.php
@@ -16,7 +16,7 @@
 window.AS_APP = '<?php echo AS_APP; ?>';
 
 function getFullURL() {
-  return '<?php echo trim( getFullURL(), '/'); ?>';
- return '<?php echo trim( htmlspecialchars( getFullURL(), ENT_QUOTES ), '/'); ?>';
+    return '<?php echo trim( htmlspecialchars( getFullURL(), ENT_QUOTES ), '/'); ?>';
 }
 
 function getBaseURL() {

```