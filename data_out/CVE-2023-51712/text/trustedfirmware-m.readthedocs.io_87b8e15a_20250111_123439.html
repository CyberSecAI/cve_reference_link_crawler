
[Trusted Firmware-M
![Logo](../../_static/tf_logo_white.png)](../../index.html)
Unknown

Overview

* [Introduction](../../introduction/index.html)
* [Getting Started](../../getting_started/index.html)
* [Security](../index.html)
  + [Threat Model](../threat_models/index.html)
    - [Threat model](../threat_models/generic_threat_model.html)
  + [Security Advisories](index.html)
    - [Advisory TFMV-1](stack_seal_vulnerability.html)
    - [Advisory TFMV-2](svc_caller_sp_fetching_vulnerability.html)
    - [Advisory TFMV-3](crypto_multi_part_ops_abort_fail.html)
    - [Advisory TFMV-4](profile_small_key_id_encoding_vulnerability.html)
    - [Advisory TFMV-5](fwu_write_vulnerability.html)
    - [Advisory TFMV-6](cc3xx_partial_tag_compare_on_chacha20_poly1305.html)
    - Advisory TFMV-7
    - [Advisory TFMV-8](user_pointers_mailbox_vectors_vulnerability.html)
* [Releases](../../releases/index.html)
  + [v2.1.1](../../releases/2.1.1.html)
  + [v2.1.0](../../releases/2.1.0.html)
  + [v2.0.0](../../releases/2.0.0.html)
  + [v1.8.1](../../releases/1.8.1.html)
  + [v1.8.0](../../releases/1.8.0.html)
  + [Release Cadence and Process](../../releases/release_process.html)
* [Roadmap](../../roadmap.html)
* [Glossary](../../glossary.html)

Development

* [Platforms](../../platform/index.html)
  + [Arm](../../platform/arm/index.html)
    - [Corstone-1000](../../platform/arm/corstone1000/readme.html)
    - [Corstone-300 FPGA (AN547 and AN552) and FVP](../../platform/arm/mps3/corstone300/README.html)
    - [Corstone-310 FPGA (AN555) and FVP](../../platform/arm/mps3/corstone310/README.html)
    - [Corstone-315 FVP](../../platform/arm/mps4/corstone315/README.html)
    - [Corstone-320 FVP](../../platform/arm/mps4/corstone320/README.html)
    - [Musca-B1](../../platform/arm/musca_b1/readme.html)
    - [Musca-S1](../../platform/arm/musca_s1/readme.html)
    - [Runtime Security Engine](../../platform/arm/rse/index.html)
  + [ArmChina](../../platform/armchina/index.html)
    - [Alcor FPGA (AN557)](../../platform/armchina/mps3/alcor/README.html)
  + [Cypress](../../platform/cypress/index.html)
    - [PSoC64](../../platform/cypress/psoc64/index.html)
  + [Laird Connectivity](../../platform/lairdconnectivity/index.html)
    - [BL5340](../../platform/lairdconnectivity/bl5340_dvk_cpuapp/README.html)
  + [Nordic](../../platform/nordic_nrf/index.html)
    - [nRF5340](../../platform/nordic_nrf/nrf5340dk_nrf5340_cpuapp/README.html)
    - [nRF9160](../../platform/nordic_nrf/nrf9160dk_nrf9160/README.html)
    - [nRF9161](../../platform/nordic_nrf/nrf9161dk_nrf9161/README.html)
  + [Nuvoton](../../platform/nuvoton/index.html)
    - [NuMaker-PFM-M2351](../../platform/nuvoton/m2351/README.html)
    - [NuMaker-PFM-M2354](../../platform/nuvoton/m2354/README.html)
  + [NXP](../../platform/nxp/index.html)
    - [LPCXpresso55S69](../../platform/nxp/lpcxpresso55s69/README.html)
  + [Raspberry Pi](../../platform/rpi/index.html)
    - [RP2350](../../platform/rpi/rp2350/readme.html)
  + [STMICROELECTRONICS](../../platform/stm/index.html)
    - [STM32H5](../../platform/stm/common/stm32h5xx/readme.html)
    - [STM32L5](../../platform/stm/common/stm32l5xx/readme.html)
    - [STM32U5](../../platform/stm/common/stm32u5xx/readme.html)
    - [NUCLEO\_L552ZE\_Q](../../platform/stm/nucleo_l552ze_q/readme.html)
    - [STM32H573I\_DK](../../platform/stm/stm32h573i_dk/readme.html)
    - [STM32L562E\_DK](../../platform/stm/stm32l562e_dk/readme.html)
    - [B\_U585I\_IOT02A](../../platform/stm/b_u585i_iot02a/readme.html)
* [Build instructions](../../building/tfm_build_instruction.html)
  + [Build Tests](../../building/tests_build_instruction.html)
  + [Run TF-M tests and applications](../../building/run_tfm_examples_on_arm_platforms.html)
  + [Building the documentation](../../building/documentation_generation.html)
  + [IAR toolchain](../../building/tfm_build_instruction_iar.html)
* [Configuration](../../configuration/index.html)
  + [Build configuration](../../configuration/build_configuration.html)
  + [Component configuration](../../configuration/header_file_system.html)
  + [Kconfig](../../configuration/kconfig_system.html)
  + [Profiles](../../configuration/profiles/index.html)
    - [Small](../../configuration/profiles/tfm_profile_small.html)
    - [ARoT-less](../../configuration/profiles/tfm_profile_medium_arot-less.html)
    - [Medium](../../configuration/profiles/tfm_profile_medium.html)
    - [Large](../../configuration/profiles/tfm_profile_large.html)
  + [Tests configuration](../../configuration/test_configuration.html)
* [Integration Guide](../../integration_guide/index.html)
  + [Source Structure](../../integration_guide/source_structure/source_structure.html)
    - [Details for the /platform folder](../../integration_guide/source_structure/platform_folder.html)
    - [Details for the /platform/ext folder](../../integration_guide/source_structure/platform_ext_folder.html)
  + [SPM Backends](../../integration_guide/spm_backends.html)
  + [NS client integration](../../integration_guide/non-secure_client_extension_integration_guide.html)
  + [OS migration to Armv8-M](../../integration_guide/os_migration_guide_armv8m.html)
  + [Floating-Point Support](../../integration_guide/tfm_fpu_support.html)
  + [Secure Interrupt](../../integration_guide/tfm_secure_irq_integration_guide.html)
  + [Platform Provisioning](../../integration_guide/platform_provisioning.html)
  + [Branch Protection](../../integration_guide/branch_protection.html)
  + [Adding a new platform](../../integration_guide/platform/index.html)
    - [Porting TF-M to a New Hardware](../../integration_guide/platform/porting_tfm_to_a_new_hardware.html)
    - [Platform Documentation](../../integration_guide/platform/documenting_platform.html)
    - [Platform deprecation and removal](../../integration_guide/platform/platform_deprecation.html)
  + [Services](../../integration_guide/services/index.html)
    - [Initial Attestation](../../integration_guide/services/tfm_attestation_integration_guide.html)
    - [Crypto](../../integration_guide/services/tfm_crypto_integration_guide.html)
    - [Internal Trusted Storage](../../integration_guide/services/tfm_its_integration_guide.html)
    - [Platform](../../integration_guide/services/tfm_platform_integration_guide.html)
    - [Protected Storage](../../integration_guide/services/tfm_ps_integration_guide.html)
    - [Adding a New Secure Partition](../../integration_guide/services/tfm_secure_partition_addition.html)
    - [Manifest Tool](../../integration_guide/services/tfm_manifest_tool_user_guide.html)
    - [ADAC](../../integration_guide/services/tfm_adac_integration_guide.html)
* [Design Documents](../../design_docs/index.html)
  + [Secure Boot](../../design_docs/booting/tfm_secure_boot.html)
    - [BL1 Immutable bootloader](../../design_docs/booting/bl1.html)
    - [Rollback Protection](../../design_docs/booting/secure_boot_rollback_protection.html)
    - [HW Key integration](../../design_docs/booting/secure_boot_hw_key_integration.html)
  + [Dual CPU](../../design_docs/dual-cpu/index.html)
    - [Booting](../../design_docs/dual-cpu/booting_a_dual_core_system.html)
    - [SPE - NSPE communication](../../design_docs/dual-cpu/communication_prototype_between_nspe_and_spe_in_dual_core_systems.html)
    - [Mailbox](../../design_docs/dual-cpu/mailbox_design_on_dual_core_system.html)
    - [Mailbox update](../../design_docs/dual-cpu/mailbox_ns_agent_update.html)
    - [Memory Access Check](../../design_docs/dual-cpu/tfm_multi_core_access_check.html)
  + [Secure Services](../../design_docs/services/index.html)
    - [Secure Partition Manager](../../design_docs/services/secure_partition_manager.html)
    - [Secure Partition RTL](../../design_docs/services/secure_partition_runtime_library.html)
    - [Inter-Process Communication](../../design_docs/services/tfm_psa_inter_process_communication.html)
    - [Stateless Services](../../design_docs/services/stateless_rot_service.html)
    - [Service Signing](../../design_docs/services/tfm_uniform_secure_service_signature.html)
    - [Crypto](../../design_docs/services/tfm_crypto_design.html)
    - [Initial Attestation](../../design_docs/services/symmetric_initial_attest.html)
    - [Internal Trusted Storage](../../design_docs/services/tfm_its_service.html)
    - [Firmware Update](../../design_docs/services/tfm_fwu_service.html)
    - [PS Key Management](../../design_docs/services/ps_key_management.html)
  + [Software Design](../../design_docs/software/index.html)
    - [Code Sharing](../../design_docs/software/code_sharing.html)
    - [Hardware Abstraction Layer](../../design_docs/software/hardware_abstraction_layer.html)
    - [Cooperative Scheduling](../../design_docs/software/tfm_cooperative_scheduling_rules.html)
    - [Code Templates](../../design_docs/software/tfm_code_generation_with_jinja2.html)
    - [Implicit Typecasting](../../design_docs/software/enum_implicit_casting.html)
  + [Isolation Rules](../../design_docs/ff_isolation.html)
  + [Builtin Keys](../../design_docs/tfm_builtin_keys.html)
  + [Logging system](../../design_docs/tfm_log_system_design_document.html)
  + [Physical Attack Mitigation](../../design_docs/tfm_physical_attack_mitigation.html)

Contribution

* [Guidelines](../../contributing/index.html)
  + [The process](../../contributing/contributing_process.html)
  + [Code review](../../contributing/code_review_guide.html)
  + [Maintainers](../../contributing/maintainers.html)
  + [Code owners](../../contributing/maintainers.html#code-owners)
  + [Issue tracking](../../contributing/issue_tracking.html)
  + [Yet another coding standard :)](../../contributing/coding_guide.html)
  + [Documentation](../../contributing/doc_guidelines.html)
  + [Design proposal](../../contributing/tfm_design_proposal_guideline.html)
* [License](../../contributing/lic.html)
* [DCO](../../contributing/dco.html)

Links

* [TF-M Tests](https://trustedfirmware-m.readthedocs.io/projects/tf-m-tests/en/latest/)
* [TF-M Tools](https://trustedfirmware-m.readthedocs.io/projects/tf-m-tools/en/latest/)
* [TF-M Extras](https://trustedfirmware-m.readthedocs.io/projects/tf-m-extras/en/latest/)
* [API Reference](https://ci.trustedfirmware.org/job/tf-m-build-docs-nightly/lastSuccessfulBuild/artifact/trusted-firmware-m/build/docs/reference_manual/html/index.html)
* [Security Center](https://developer.trustedfirmware.org/w/collaboration/security_center)
* [PSA](https://www.arm.com/architecture/security-features/platform-security)

[Trusted Firmware-M](../../index.html)

* [Security](../index.html)
* [Security Advisories](index.html)
* Advisory TFMV-7

---

# Advisory TFMV-7[](#advisory-tfmv-7 "Permalink to this heading")

| Title | ARoT can access PRoT data via debug logging functionality |
| --- | --- |
| CVE ID | [CVE-2023-51712](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-51712) |
| Public Disclosure Date | The issue was publicly reported on 2023.12.04 |
| Versions Affected | All version up to TF-M v2.0.0 inclusive |
| Configurations | IPC mode with TFM\_SP\_LOG\_RAW\_ENABLED=1 |
| Impact | A malicious ARoT partition can expose any part of memory via stdio interface if TFM\_SP\_LOG\_RAW\_ENABLED is set |
| Fix Version | TBD |
| Credit | Roman Mazurak, Infineon |

## Background[](#background "Permalink to this heading")

TF-M log subsystem if enabled by `TFM_SP_LOG_RAW_ENABLED` config option,
uses a SVC call to print logging messages on the stdio output interface.
Since the SVC handler has the highest privilege level and full memory
access, this communication channel can be exploited to expose any memory content
to stdout device, usually UART.
The logging subsystem is available to the secure side only but in isolation
level 2 and higher PSA Root of Trust partitions (PRoT) shall be protected
from an access from Application Root of Trust (ARoT) partitions. Although
a direct call of `tfm_hal_output_sp_log()` from ARoT partition will be
blocked by MPU raising the `MemoryManagement()` exception, a malicious
ARoT partition can create an alternative SVC call to output any memory
data like this:

```
static int tfm_output_unpriv_string(const unsigned char *str, size_t len)
{
    __ASM volatile("SVC %0         \n"
                   "BX LR          \n"
                    : : "I" (2));
}

```

## Impact[](#impact "Permalink to this heading")

In IPC mode with PSA isolation level 2 and higher and `TFM_SP_LOG_RAW_ENABLED`
option enabled an ARoT partition can expose to the stdout device any memory
data using TF-M logging subsystem via SVC call.

## Mitigation[](#mitigation "Permalink to this heading")

Ensure that data sent for logging belongs to the current partition. For that purpose
`tfm_hal_memory_check(curr_partition->boundary, data, size, TFM_HAL_ACCESS_READABLE)`
is added to the logging function of the SVC handler. If the check fails
then `tfm_core_panic()` is invoked and system halts.

---

*Copyright (c) 2024, Arm Limited. All rights reserved.*

---

