=== Content from xeiaso.net_26a13132_20250111_074153.html ===


[Xe](/)

[Blog](/blog/)

[Contact](/contact/)

[Resume](/resume/)

[Talks](/talks/)

[Xecast](/xecast/)

[Signalboost](/signalboost/)

# CVE-2023-36325: Attackers can de-anonymize i2p hidden services with a message replay attack

Published on 07/30/2023, 704 words, 3 minutes to read

![An image of 1girl, green hair, high ponytail, long hair, black bodysuit, blindfold, space needle, outside, skirt, heels](https://cdn.xeiaso.net/file/christine-static/hero/chibi-attacker.jpg)
1girl, green hair, high ponytail, long hair, black bodysuit, blindfold, space needle, outside, skirt, heels - SCMix+YoRHa

tl;dr: If you host eepsites with Java i2p and are running older than
i2p 2.3.0, update it as soon as possible. More details below.

A sufficiently determined attacker may be able to de-anonymize the
public IPv4 and IPv6 addresses of i2p hidden services (eepsites) by
using a combination of brute-forcing the entire i2p router set with a
replayed message. This is CVE-2023-36325.

This issue was originally discovered by a user with the identifier
`hbapm6le75xwc342hnkltwfnnmt4ccafr5wyf7b6jhw6jxn3fwqa.b32.i2p`, which
I will refer to as "hbapm6". While hbapm6 was working on a custom
version of i2p, they found that replaying messages sent down client
tunnels to target i2p routers could cause the i2p software to drop the
packet instead of sending a "wrong destination" response. This can
lead to de-anonymization of a given eepsite by being able to correlate
the public IPv4 or IPv6 address of the contacted router with packets
being dropped.

This is fixed in i2p 2.3.0 by adding a unique identifier to every
message ID and separating out bloom filters and other datastores so
that such correlation attacks are harder to pull off in the future.
These changes are protocol-compatible and all users are encouraged to
apply them as soon as possible.

There is insufficent data as to what versions of i2p are vulnerable,
but we are certain that 2.2.1 is vulnerable. It is likely that older
versions of i2p are also vulnerable. Assume so.

This attack takes days to complete and requires a fairly detailed
amount of knowledge of the i2p protocol in order to successfully
de-anonymize target eepsites.

Users of i2pd are not affected.

With this understood, here is the CVSS score breakdown for this
attack:

| Overall CVSS Score | 3.4 |
| --- | --- |
| CVSS Base Score | 5.3 |
| Impact Subscore | 1.4 |
| Exploitability Subscore | 3.9 |
| CVSS Temporal Score | 4.8 |
| CVSS Environmental Score | 3.4 |
| Modified Impact Subscore | 1.4 |

AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N/E:P/RL:O/RC:C/CR:M/IR:X/AR:X/MAV:N/MAC:H/MPR:N/MUI:N/MS:U/MC:L/MI:N/MA:N

Affected users should update to i2p 2.3.0 as soon as it is available.

The vulnerability has been mitigated by a refactor of the relevant
codepaths involved with message parsing. Additionally, the network
information database was sharded off with the hope of preventing
future attacks.

---

On a side note, I have been very impressed with the i2p projects
handling of the circumstances surrounding hbapm6 of the issues
tracked as CVE-2023-36325. For an unknown reason, hbapm6
decided that the best way to get attention for these issues was to
impersonate me. I was contacted by the i2p project due to
hbapm6 acting very strange (IE: claiming to have a vuln and
refusing to show proof of it or how they triggered it, if you have a
de-anonymization attack for such a network, just share your code and
demonstrate it when asked, it will save so much time for everyone
involved), and after a month or two of cajoling, hbapm6 eventually
managed to de-anonymize a throwaway VPS that was acting as an i2p
router. This confirmed the vuln and lead to me filing this CVE.

I guess this is part of my threat profile now. Fun.

At the very least I got to have a conversation that was like (names
have been changed to protect the innocent):

> (hbapm6); Why all the snooping? [...] What is this, a game of
> Among Us?
>
> (Me) <link to my website to an ascii art of an amogus with proof
> that I am the actual Xe Iaso>

I still have no idea why that person impersonated me. If you're out
there and reading this and I wronged you somehow, I'm sorry and would
like to know what I fucked up so I can change for the better.

---

There's some other vulnerabilities that are related to this, but none
of them have viable attacks. Most of the changes being done are just
various hardening to the pokey edges of the network database and other
things. I expect that these are fairly minor issues and when the patch
comes out you should probably update.

---

Copyright 2012-2025 Xe Iaso. Any and all opinions listed here are my own and
not representative of any of my employers, past, future, and/or present.

Like what you see? Donate on [Patreon](https://patreon.com/cadey) like [these awesome people](/patrons)!

Served by xesite v4 (/app/xesite) with site version
[e84fe911](https://github.com/Xe/site/commit/e84fe91132dbe75e6f2e8cdb4aa956e0a69f91cd)
, source code available [here](https://github.com/Xe/site).



=== Content from geti2p.net_5d3c5def_20250111_074146.html ===

[Skip navigation](#content "Skip navigation")
[![I2P Logo](/_static/styles/duck/images/i2plogo.png "The Invisible Internet Project (I2P)")](/en/)
# I2P Release 2.3.0 - Blog

* [![](/_static/images/flags/en.png)English](/en/blog/post/2023/06/25/new_release_2.3.0)
* [![](/_static/images/flags/de.png)Deutsch](/de/blog/post/2023/06/25/new_release_2.3.0)
* [![](/_static/images/flags/es.png)Castellano](/es/blog/post/2023/06/25/new_release_2.3.0)
* [![](/_static/images/flags/fr.png)Français](/fr/blog/post/2023/06/25/new_release_2.3.0)
* [![](/_static/images/flags/ru.png)Russian Русский язык](/ru/blog/post/2023/06/25/new_release_2.3.0)
* [![](/_static/images/flags/zh.png)Chinese 中文](/zh/blog/post/2023/06/25/new_release_2.3.0)
* [![](/_static/images/flags/ar.png)Arabic العربية](/ar/blog/post/2023/06/25/new_release_2.3.0)
* [![](/_static/images/flags/id.png)Bahasa Indonesia](/id/blog/post/2023/06/25/new_release_2.3.0)
* [![](/_static/images/flags/zh_TW.png)Chinese 中文 (繁體中文, 台灣)](/zh-tw/blog/post/2023/06/25/new_release_2.3.0)
* [![](/_static/images/flags/el.png)Greek Ελληνικά](/el/blog/post/2023/06/25/new_release_2.3.0)
* [![](/_static/images/flags/he.png)Hebrew עברית](/he/blog/post/2023/06/25/new_release_2.3.0)
* [![](/_static/images/flags/hu.png)Hungarian](/hu/blog/post/2023/06/25/new_release_2.3.0)
* [![](/_static/images/flags/it.png)Italiano](/it/blog/post/2023/06/25/new_release_2.3.0)
* [![](/_static/images/flags/ja.png)Japanese 日本語](/ja/blog/post/2023/06/25/new_release_2.3.0)
* [![](/_static/images/flags/ko.png)Korean 한국말](/ko/blog/post/2023/06/25/new_release_2.3.0)
* [![](/_static/images/flags/mg.png)Fiteny Malagasy](/mg/blog/post/2023/06/25/new_release_2.3.0)
* [![](/_static/images/flags/nl.png)Nederlands](/nl/blog/post/2023/06/25/new_release_2.3.0)
* [![](/_static/images/flags/fa.png)Persian فارسی](/fa/blog/post/2023/06/25/new_release_2.3.0)
* [![](/_static/images/flags/pl.png)Polski](/pl/blog/post/2023/06/25/new_release_2.3.0)
* [![](/_static/images/flags/pt.png)Português](/pt/blog/post/2023/06/25/new_release_2.3.0)
* [![](/_static/images/flags/pt_BR.png)Português do Brasil](/pt-br/blog/post/2023/06/25/new_release_2.3.0)
* [![](/_static/images/flags/ro.png)Română](/ro/blog/post/2023/06/25/new_release_2.3.0)
* [![](/_static/images/flags/fi.png)Suomi](/fi/blog/post/2023/06/25/new_release_2.3.0)
* [![](/_static/images/flags/sv.png)Svenska](/sv/blog/post/2023/06/25/new_release_2.3.0)
* [![](/_static/images/flags/tr.png)Türkçe](/tr/blog/post/2023/06/25/new_release_2.3.0)
* [![](/_static/images/flags/uk.png)Ukrainian Українська](/uk/blog/post/2023/06/25/new_release_2.3.0)

* [Download](/en/download)
* About
  + [Introduction to I2P](/en/about/intro)
  + Guide to I2P Software
    - [What is Included](/en/about/software)- - [How to browse I2P](/en/about/browser-config)
        - [FAQ](/en/faq)
        - Applications
          * [Bittorrent](/en/docs/applications/bittorrent)
          * [GitLab](/en/docs/applications/gitlab)
          * [Git](/en/docs/applications/git)
          * [git+Bittorrent](/en/docs/applications/git-bundle)
          * [IRC](/en/docs/applications/irc)
  + Help
    - [Glossary](/en/about/glossary)
    - [Performance](/en/about/performance)
    - Comparisons
      * [Tor](/en/comparison/tor)
      * [Freenet](/en/comparison/freenet)
      * [Other anonymous networks](/en/comparison/other-networks)
    - Verify I2P
      * [Release signing keys](/en/get-involved/develop/release-signing-key)
      * [Signed keys](/en/get-involved/develop/signed-keys)
      * [Developers keys](/en/get-involved/develop/developers-keys)
    - [Contact us](/en/contact)
  + Contributor Guides
    - [Get involved!](/en/get-involved)- - Develop Software
          * [New developers](/en/get-involved/guides/new-developers)
          * [Using an IDE with I2P](/en/get-involved/guides/ides)
          * [Developer guidelines and coding style](/en/get-involved/guides/dev-guidelines)
          * [Git](/en/docs/applications/git)
        - [Translate I2P into more Languages](/en/get-involved/guides/new-translators)
        - Hosting Services
          * [Reseed](/en/docs/reseed)
          * [GitLab](/en/docs/applications/gitlab)
  + [Contact and Team](/en/contact)* Community
    + [Forums](http://i2pforum.net/)
    + [Reddit](https://reddit.com/r/i2p)
    + Research
      - Research
        * [Academic research](/en/research)
        * [Open research questions](/en/research/questions)
        * [Vulnerability Response Process](/en/research/vrp)- [Academic papers and peer review](/en/papers/)
      - Presentations, tutorials and articles
        * [Media](/en/about/media)
        * [I2PCon](/en/about/i2pcon)
      - [Impressum](/en/impressum)
      - [I2P Metrics](https://i2p-metrics.np-tokumei.net/)
  * Develop
    + [Gitlab](https://i2pgit.org)
    + Docs
      - [Documentation index](/en/docs)
      - How does it work?
        * [Gentle intro](/en/docs/how/intro)
        * [Tech intro](/en/docs/how/tech-intro)
        * [Threat model](/en/docs/how/threat-model)
        * [Garlic routing](/en/docs/how/garlic-routing)
        * [Network database](/en/docs/how/network-database)
        * [Tunnel routing](/en/docs/how/tunnel-routing)
        * [Peer selection](/en/docs/how/peer-selection)
        * [Cryptography](/en/docs/how/cryptography)
        * [ElGamal/AES+SessionTags](/en/docs/how/elgamal-aes)
      - [Specifications](/spec)
      - [Proposals](/spec/proposals)
      - API
        * [I2PTunnel](/en/docs/api/i2ptunnel)
        * [SOCKS](/en/docs/api/socks)
        * [SAM v3](/en/docs/api/samv3)
        * [BOB](/en/docs/api/bob)
        * [Streaming library](/en/docs/api/streaming)
        * [Datagrams](/en/docs/api/datagrams)
        * [I2PControl](/en/docs/api/i2pcontrol)
      - Protocols
        * [Protocol stack](/en/docs/protocol)
        * [I2CP](/en/docs/protocol/i2cp)
        * [I2NP](/en/docs/protocol/i2np)
      - Transports
        * [Transport layer overview](/en/docs/transport)
        * [NTCP](/en/docs/transport/ntcp)
        * [NTCP2](/spec/ntcp2)
        * [SSU](/en/docs/transport/ssu)
        * [SSU2(Proposal 159)](/spec/proposals/159-ssu2)
      - Tunnels
        * [Tunnel implementation](/en/docs/tunnels/implementation)
        * [Unidirectional tunnels](/en/docs/tunnels/unidirectional)
        * [Old implementation](/en/docs/tunnels/old-implementation)
      - [Naming and Address Book](/en/docs/naming)
      - [Plugins](/en/docs/plugins)
      - [Strict Countries](/en/about/restrictive-countries)
    + API
      - [I2PTunnel](/en/docs/api/i2ptunnel)
      - [SOCKS](/en/docs/api/socks)
      - [SAM v3](/en/docs/api/samv3)
      - [BOB](/en/docs/api/bob)
      - [Streaming library](/en/docs/api/streaming)
      - [Datagrams](/en/docs/api/datagrams)
      - [I2PControl](/en/docs/api/i2pcontrol)
    + License
      - [Applications](/en/get-involved/develop/applications)
      - [Licenses](/en/get-involved/develop/licenses)
    + Meetings, Roadmap
      - [Meeting Logs](/en/meetings/)
      - [Project Roadmap](/en/get-involved/roadmap)
      - [Task list](/en/get-involved/todo)
    + [Bug tracker](http://trac.i2p2.de/)
  * People
    + [Contact us](/en/contact)

- [Blog](/en/blog/)
- ![](/_static/images/flags/en.png) Language
  * [![](/_static/images/flags/en.png)English](/en/blog/post/2023/06/25/new_release_2.3.0)
  * [![](/_static/images/flags/de.png)Deutsch](/de/blog/post/2023/06/25/new_release_2.3.0)
  * [![](/_static/images/flags/es.png)Castellano](/es/blog/post/2023/06/25/new_release_2.3.0)
  * [![](/_static/images/flags/fr.png)Français](/fr/blog/post/2023/06/25/new_release_2.3.0)
  * [![](/_static/images/flags/ru.png)Russian Русский язык](/ru/blog/post/2023/06/25/new_release_2.3.0)
  * [![](/_static/images/flags/zh.png)Chinese 中文](/zh/blog/post/2023/06/25/new_release_2.3.0)
  * [![](/_static/images/flags/ar.png)Arabic العربية](/ar/blog/post/2023/06/25/new_release_2.3.0)
  * [![](/_static/images/flags/id.png)Bahasa Indonesia](/id/blog/post/2023/06/25/new_release_2.3.0)
  * [![](/_static/images/flags/zh_TW.png)Chinese 中文 (繁體中文, 台灣)](/zh-tw/blog/post/2023/06/25/new_release_2.3.0)
  * [![](/_static/images/flags/el.png)Greek Ελληνικά](/el/blog/post/2023/06/25/new_release_2.3.0)
  * [![](/_static/images/flags/he.png)Hebrew עברית](/he/blog/post/2023/06/25/new_release_2.3.0)
  * [![](/_static/images/flags/hu.png)Hungarian](/hu/blog/post/2023/06/25/new_release_2.3.0)
  * [![](/_static/images/flags/it.png)Italiano](/it/blog/post/2023/06/25/new_release_2.3.0)
  * [![](/_static/images/flags/ja.png)Japanese 日本語](/ja/blog/post/2023/06/25/new_release_2.3.0)
  * [![](/_static/images/flags/ko.png)Korean 한국말](/ko/blog/post/2023/06/25/new_release_2.3.0)
  * [![](/_static/images/flags/mg.png)Fiteny Malagasy](/mg/blog/post/2023/06/25/new_release_2.3.0)
  * [![](/_static/images/flags/nl.png)Nederlands](/nl/blog/post/2023/06/25/new_release_2.3.0)
  * [![](/_static/images/flags/fa.png)Persian فارسی](/fa/blog/post/2023/06/25/new_release_2.3.0)
  * [![](/_static/images/flags/pl.png)Polski](/pl/blog/post/2023/06/25/new_release_2.3.0)
  * [![](/_static/images/flags/pt.png)Português](/pt/blog/post/2023/06/25/new_release_2.3.0)
  * [![](/_static/images/flags/pt_BR.png)Português do Brasil](/pt-br/blog/post/2023/06/25/new_release_2.3.0)
  * [![](/_static/images/flags/ro.png)Română](/ro/blog/post/2023/06/25/new_release_2.3.0)
  * [![](/_static/images/flags/fi.png)Suomi](/fi/blog/post/2023/06/25/new_release_2.3.0)
  * [![](/_static/images/flags/sv.png)Svenska](/sv/blog/post/2023/06/25/new_release_2.3.0)
  * [![](/_static/images/flags/tr.png)Türkçe](/tr/blog/post/2023/06/25/new_release_2.3.0)
  * [![](/_static/images/flags/uk.png)Ukrainian Українська](/uk/blog/post/2023/06/25/new_release_2.3.0)

# I2P Release 2.3.0 - Blog

* Posted: 2023-06-25
* Author: idk
* Posted in [release](/en/blog/category/release)

This release contains fixes for CVE-2023-36325.
CVE-2023-36325 is a context-confusion bug which occurred in the bloom filter.
An attacker crafts an I2NP message containing a unique messageID, and sends that messageID to a client.
The message, after passing through the bloom filter, is not allowed to be re-used in a second message.
The attacker then sends the same message directly to the router.
The router passes the message to the bloom filter, and is dropped.
This leaks the information that the messageID has been seen before, giving the attacker a strong reason to believe that the router is hosting the client.
This has been fixed by separting the bloom filter's functionality into different contexts based on whether a message came down a client tunnel, an exploratory tunnel, was sent to the router directly.
Under normal circumstances, this attack takes several days to perform successfully and may be confounded by several factors such as routers restarting during the attack phase and sensitivity to false-positives.
Users of Java I2P are recommended to update immediately to avoid the attack.

In the course of fixing this context confusion bug, we have revised some of our strategies to code defensively, against these types of leaks.
This includes tweaks to the netDb, the rate-limiting mechanisms, and the behavior of floodfill routers.

This release adds not\_bob as a second default hosts provider, and adds [notbob.i2p](http://notbob.i2p) and [ramble.i2p](http://ramble.i2p) to the console homepage.

This release also contains a tweakable blocklist.
Blocklisting is semi-permanent, each blocked IP address is normally blocked until the router is restarted.
Users who observe explosive blocklist growth during sybil attacks may opt-in to shorter timeouts by configuring the blocklist to expire entries at an interval.
This feature is off-by-default and is only recommended for advanced users at this time.

This release also includes an API for plugins to modify with the Desktop GUI(DTG).
It is now possible to add menu items to the system tray, enabling more intuitive launching of plugins which use native application interfaces.

As usual, we recommend that you update to this release.
The best way to maintain security and help the network is to run the latest release.

**DETAILS**

*Changes*

* netDb: Throttle bursts of netDB lookups
* Sybil/Blocklist: Allow users to override blocklist expiration with an interval
* DTG: Provide an API for extending DTG with a plugin
* Addressbook: add notbob's main addressbook to the default subscriptions.
* Console: Add Ramble and notbob to console homepage

*Bug Fixes*

* Fix replay attack: CVE-2023-36325
* Implement handling of multihomed routers in the netDb
* Fully copy new leaseSets when a leaseSet recievedAsPublished overwrites a leaseSet recievedAsReply

Full list of fixed bugs: <http://git.idk.i2p/i2p-hackers/i2p.i2p/-/issues?scope=all&state=closed&milestone_title=2.3.0>

* [![](/_static/images/social/contact.png)Mastodon](https://mastodon.social/%40i2p)
* [![](/_static/images/social/reddit-alien-brands.png)Reddit](https://reddit.com/r/i2p)
* [![](/_static/images/social/twitter-brands.png)Twitter](https://twitter.com/i2p)

* [Official Forums](http://i2pforum.net/)
* [Contact](/en/contact)
* [Impressum](/en/impressum)

* [![](/_static/images/social/gitlab-brands.png)Gitlab](https://i2pgit.org/)
* [Get involved!](/en/get-involved)
* [FAQ](/en/faq)


