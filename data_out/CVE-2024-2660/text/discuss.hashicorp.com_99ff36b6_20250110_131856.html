

[HashiCorp Discuss](/)

# [HCSEC-2024-07 - Vault TLS Cert Auth Method Did Not Correctly Validate OCSP Responses](/t/hcsec-2024-07-vault-tls-cert-auth-method-did-not-correctly-validate-ocsp-responses/64573)

[Security](/c/security/52)

[security-vault](https://discuss.hashicorp.com/tag/security-vault)

[mickael](https://discuss.hashicorp.com/u/mickael)

April 4, 2024, 5:43pm

1

**Bulletin ID:** HCSEC-2024-07

**Affected Products / Versions:** Vault and Vault Enterprise from 1.14.0 up to 1.15.6, 1.14.10; fixed in Vault 1.16.0 and Vault Enterprise 1.16.1, 1.15.7, and 1.14.11.

**Publication Date:** April 4, 2024

**Summary**

Vault and Vault Enterprise TLS certificates auth method did not correctly validate OCSP responses when one or more OCSP sources were configured. This vulnerability, CVE-2024-2660, affects Vault and Vault Enterprise 1.14.0 and above, and is fixed in Vault 1.16.0 and Vault Enterprise 1.16.1, 1.15.7, and 1.14.11.

**Background**

Vault offers a wide range of [auth methods](https://developer.hashicorp.com/vault/api-docs/auth) for authentication, including [TLS client certificates](https://developer.hashicorp.com/vault/api-docs/auth/cert). Vault’s TLS certificate auth method supports [multiple revocation checking methods](https://developer.hashicorp.com/vault/docs/auth/cert#revocation-checking), one of which is OCSP, used to check the validity of client certificates to authenticate to Vault.

**Details**

A bug was introduced in the OCSP response handling logic of Vault’s TLS certificate authentication method that resulted in signatures and responses from multiple servers not being handled properly. A malicious actor with privileged network access may have been able to successfully authenticate via Vault’s TLS certificate authentication method with incorrect certificate status information.

**Remediation**

Customers using the TLS auth method with an OCSP server configured in their Vault installation should evaluate the risk associated with this issue and consider upgrading to Vault 1.16.0 or newer, or Vault Enterprise 1.16.1, 1.15.7, 1.14.11, or newer.

Please refer to [Upgrading Vault](https://learn.hashicorp.com/tutorials/vault/sop-upgrade?in=vault/standard-procedures) for general guidance and version-specific upgrade notes.

**Acknowledgement**

This issue was identified by the Vault engineering team.

*We deeply appreciate any effort to coordinate disclosure of security vulnerabilities. For information about security at HashiCorp and the reporting of security vulnerabilities, please see <https://hashicorp.com/security>.*

### Related topics

| Topic |  | Replies | Views | Activity |
| --- | --- | --- | --- | --- |
| [HCSEC-2024-05 - Vault Cert Auth Method Did Not Correctly Validate Non-CA Certificates](https://discuss.hashicorp.com/t/hcsec-2024-05-vault-cert-auth-method-did-not-correctly-validate-non-ca-certificates/63382)  [Security](/c/security/52) [security-vault](https://discuss.hashicorp.com/tag/security-vault) | 0 | 9283 | March 4, 2024 |
| [HCSEC-2022-24 - Vault's TLS Cert Auth Method Only Loaded CRL After First Request](https://discuss.hashicorp.com/t/hcsec-2022-24-vaults-tls-cert-auth-method-only-loaded-crl-after-first-request/45483)  [Security](/c/security/52) [security-vault](https://discuss.hashicorp.com/tag/security-vault) | 0 | 6817 | October 12, 2022 |
| [HCSEC-2021-10 - Vault’s Cassandra Integrations Did Not Validate TLS Certificates](https://discuss.hashicorp.com/t/hcsec-2021-10-vault-s-cassandra-integrations-did-not-validate-tls-certificates/23463)  [Security](/c/security/52) [security-vault](https://discuss.hashicorp.com/tag/security-vault) | 0 | 7481 | April 21, 2021 |
| [HCSEC-2024-11 - Vault Incorrectly Validated JSON Web Tokens (JWT) Audience Claims](https://discuss.hashicorp.com/t/hcsec-2024-11-vault-incorrectly-validated-json-web-tokens-jwt-audience-claims/67770)  [Security](/c/security/52) [security-vault](https://discuss.hashicorp.com/tag/security-vault) | 0 | 3302 | June 12, 2024 |
| [HCSEC-2020-16 - Vault’s AWS Auth Method Allows Authentication Bypass](https://discuss.hashicorp.com/t/hcsec-2020-16-vault-s-aws-auth-method-allows-authentication-bypass/18101)  [Security](/c/security/52) [security-vault](https://discuss.hashicorp.com/tag/security-vault) | 0 | 4360 | November 25, 2020 |

* [Home](/)
* [Categories](/categories)
* [Guidelines](/guidelines)
* [Terms of Service](/tos)
* [Privacy Policy](https://meta.discourse.org/privacy)

Powered by [Discourse](https://www.discourse.org), best viewed with JavaScript enabled

