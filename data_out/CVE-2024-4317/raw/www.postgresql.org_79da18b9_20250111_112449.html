<!doctype html>
<html lang="en">
 <head>
  <title>PostgreSQL: CVE-2024-4317: Restrict visibility of &quot;pg_stats_ext&quot; and &quot;pg_stats_ext_exprs&quot; entries to the table owner</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta http-equiv="Content-Type" content="text/xhtml; charset=utf-8" />
   
  <meta name="theme-color" content="#336791"/>
  <meta name="copyright" content="The PostgreSQL Global Development Group" />
  <link href="/media/css/fontawesome.css?83493b5d" rel="stylesheet">
  <link rel="stylesheet" href="/media/css/bootstrap-4.4.1.min.css">
  <link rel="shortcut icon" href="/favicon.ico" />
  
  <link rel="stylesheet" type="text/css" href="/dyncss/base.css?83493b5d">

  <script src="/media/js/theme.js?83493b5d"></script>

  
  </head>
  <body>
    <div class="container-fluid">
      <div class="row justify-content-md-center">
        <div class="col">
          <!-- Header -->
          <nav class="navbar navbar-expand-lg navbar-light bg-light">
            <a class="navbar-brand p-0" href="/">
              <img class="logo" src="/media/img/about/press/elephant.png" alt="PostgreSQL Elephant Logo">
            </a>
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#pgNavbar" aria-controls="pgNavbar" aria-expanded="false" aria-label="Toggle navigation">
              <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="pgNavbar">
              <ul class="navbar-nav mr-auto">
                <li class="nav-item p-2"><a href="/" title="Home">Home</a></li>
                <li class="nav-item p-2"><a href="/about/" title="About">About</a></li>
                <li class="nav-item p-2"><a href="/download/" title="Download">Download</a></li>
                <li class="nav-item p-2"><a href="/docs/" title="Documentation">Documentation</a></li>
                <li class="nav-item p-2"><a href="/community/" title="Community">Community</a></li>
                <li class="nav-item p-2"><a href="/developer/" title="Developers">Developers</a></li>
                <li class="nav-item p-2"><a href="/support/" title="Support">Support</a></li>
                <li class="nav-item p-2"><a href="/about/donate/" title="Donate">Donate</a></li>
                <li class="nav-item p-2"><a href="/account/" title="Your account">Your account</a></li>
              </ul>
              <form role="search" method="get" action="/search/">
                <div class="input-group">
                  <input id="q" name="q" type="text" size="20" maxlength="255" accesskey="s"  class="form-control" placeholder="Search for...">
                  <span class="input-group-btn">
                    <button class="btn btn-default" type="submit"><i class="fas fa-search"></i></button>
                  </span>
                </div><!-- /input-group -->
              </form>
              <form id="form-theme" class="form-inline d-none">
                <button id="btn-theme" class="btn btn-default ml-1" type="button"></button>
              </form>
            </div>
          </nav>
        </div>
      </div>
      <div class="row justify-content-center pg-shout-box">
        <div class="col text-white text-center">November 21, 2024: <a href="/about/news/postgresql-172-166-1510-1415-1318-and-1222-released-2965/">
  PostgreSQL 17.2, 16.6, 15.10, 14.15, 13.18, and 12.22 Released!
</a>

</div>
      </div>
    </div>
    
<div class="container-fluid margin">
  <div class="row">
    <div class="col-lg-2">
      <div id="pgSideWrap">
       
       <div id="pgSideNav">
         <h2>Quick Links</h2>

         <ul>
           
           
           <li><a href="/support/">Support</a>
            
            
           
           </li>
           <li><a href="/support/versioning/">Versioning Policy</a>
            
            
           
           </li>
           <li><a href="/support/security/">Security</a>
            
            
           
           </li>
           <li><a href="/support/professional_support/">Professional Services</a>
            
            
           
           </li>
           <li><a href="/support/professional_hosting/">Hosting Solutions</a>
            
            
           
           </li>
           <li class="last-child"><a href="/account/submitbug/">Report a Bug</a>
            
            
           </li>
            
           
        </ul>

       </div>
       
      </div> <!-- pgSideWrap -->
    </div>
    <div class="col-lg-10">
      <div id="pgContentWrap">
        

<h1>CVE-2024-4317 <i class="fas fa-lock"></i></h1>
<h3>Restrict visibility of &quot;pg_stats_ext&quot; and &quot;pg_stats_ext_exprs&quot; entries to the table owner</h3>


<p>Missing authorization in PostgreSQL built-in views pg_stats_ext and pg_stats_ext_exprs allows an unprivileged database user to read most common values and other statistics from <a href="https://www.postgresql.org/docs/current/sql-createstatistics.html"><code>CREATE STATISTICS</code></a> commands of other users. The most common values may reveal column values the eavesdropper could not otherwise read or results of functions they cannot execute. Installing an unaffected version only fixes fresh PostgreSQL installations, namely those that are created with the initdb utility after installing that version. Current PostgreSQL installations will remain vulnerable until they follow the instructions in the release notes, which are provided as a convenience in the below section. Within major versions 14-16, minor versions before PostgreSQL 16.3, 15.7, and 14.12 are affected. Versions before PostgreSQL 14 are unaffected.</p>
<p>This fix only fixes fresh PostgreSQL installations, namely those that are
created with the <a href="https://www.postgresql.org/docs/current/app-initdb.html"><code>initdb</code></a>
utility after this fix is applied. If you have a current PostgreSQL installation
and are concerned about this issue, please use the following remediation steps to
fix the issue:</p>
<ol>
<li>
<p>Find the SQL script <code>fix-CVE-2024-4317.sql</code> in the <code>share</code> directory of
your PostgreSQL installation (e.g. in <code>/usr/share/postgresql/</code>), or download it
from the PostgreSQL git repository from one of the URLs below. You will need to
use the script that matches your major version:</p>
</li>
<li>
<p><a href="https://git.postgresql.org/gitweb/?p=postgresql.git;a=blob;f=src/backend/catalog/fix-CVE-2024-4317.sql;hb=refs/heads/REL_16_STABLE">PostgreSQL 16</a>: <a href="https://git.postgresql.org/gitweb/?p=postgresql.git;a=blob;f=src/backend/catalog/fix-CVE-2024-4317.sql;hb=refs/heads/REL_16_STABLE">https://git.postgresql.org/gitweb/?p=postgresql.git;a=blob;f=src/backend/catalog/fix-CVE-2024-4317.sql;hb=refs/heads/REL_16_STABLE</a></p>
</li>
<li><a href="https://git.postgresql.org/gitweb/?p=postgresql.git;a=blob;f=src/backend/catalog/fix-CVE-2024-4317.sql;hb=refs/heads/REL_15_STABLE">PostgreSQL 15</a>: <a href="https://git.postgresql.org/gitweb/?p=postgresql.git;a=blob;f=src/backend/catalog/fix-CVE-2024-4317.sql;hb=refs/heads/REL_15_STABLE">https://git.postgresql.org/gitweb/?p=postgresql.git;a=blob;f=src/backend/catalog/fix-CVE-2024-4317.sql;hb=refs/heads/REL_15_STABLE</a></li>
<li><a href="https://git.postgresql.org/gitweb/?p=postgresql.git;a=blob;f=src/backend/catalog/fix-CVE-2024-4317.sql;hb=refs/heads/REL_14_STABLE">PostgreSQL 14</a>: <a href="https://git.postgresql.org/gitweb/?p=postgresql.git;a=blob;f=src/backend/catalog/fix-CVE-2024-4317.sql;hb=refs/heads/REL_14_STABLE">https://git.postgresql.org/gitweb/?p=postgresql.git;a=blob;f=src/backend/catalog/fix-CVE-2024-4317.sql;hb=refs/heads/REL_14_STABLE</a></li>
</ol>
<p>From the above URLs, you can click the URL that says "raw" to download a version
that you can copy and paste.</p>
<p>Be sure to use the script appropriate to your PostgreSQL major version. If you
do not see this file, either your version is not vulnerable (only PostgreSQL 14,
15, and 16 are affected) or your minor version is too old to have the fix.</p>
<ol>
<li>In each database of the cluster, run the <code>fix-CVE-2024-4317.sql</code> script as
a database superuser. For example, in <a href="https://www.postgresql.org/docs/current/app-psql.html"><code>psql</code></a>,
with the file located in <code>/usr/share/postgresql/</code>, this command would look like:</li>
</ol>
<p><code>\i /usr/share/postgresql/fix-CVE-2024-4317.sql</code></p>
<ol>
<li>You must also execute this script in the <code>template0</code> and <code>template1</code>
databases, or the vulnerability will still exist in databases you create later.
To fix <code>template0</code>, you'll need to temporarily allow it accept connections. You
can do this with the following command:</li>
</ol>
<p><code>ALTER DATABASE template0 WITH ALLOW_CONNECTIONS true;</code></p>
<p>After executing the <code>fix-CVE-2024-4317.sql</code> script in <code>template0</code> and
<code>template1</code>, you should revoke the ability for <code>template0</code> to accept
connections. You can do this with the following command:</p>
<p><code>ALTER DATABASE template0 WITH ALLOW_CONNECTIONS false;</code></p>
<p>The PostgreSQL project thanks Lukas Fittl for reporting this problem.</p>


<h2>Version Information</h2>

<table class="table">
  <thead>
    <tr>
      <th>Affected Version</th>
      <th>Fixed In</th>
      
      <th>Fix Published</th>
      
  </thead>
  <tbody>
    
    <tr>
      <td>
        
          16
        
      </td>
      <td>
        <a href="/docs/release/16.3">
          
            16.3
          
        </a>
      </td>
      
      <td>
        <a href="/about/news/postgresql-163-157-1412-1315-and-1219-released-2858/">
          May 9, 2024
        </a>
      </td>
      
    </tr>
    
    <tr>
      <td>
        
          15
        
      </td>
      <td>
        <a href="/docs/release/15.7">
          
            15.7
          
        </a>
      </td>
      
      <td>
        <a href="/about/news/postgresql-163-157-1412-1315-and-1219-released-2858/">
          May 9, 2024
        </a>
      </td>
      
    </tr>
    
    <tr>
      <td>
        
          14
        
      </td>
      <td>
        <a href="/docs/release/14.12">
          
            14.12
          
        </a>
      </td>
      
      <td>
        <a href="/about/news/postgresql-163-157-1412-1315-and-1219-released-2858/">
          May 9, 2024
        </a>
      </td>
      
    </tr>
    
  </tbody>
</table>

<p>
  For more information about <a href="/support/versioning/">PostgreSQL versioning</a>,
  please visit the <a href="/support/versioning/">versioning page</a>.
</p>


<h2>CVSS 3.0</h2>

<table class="table">
  <tbody>
    <tr>
      <th>Overall Score</th>
      <td><strong>3.1</strong></td>
    </tr>
    <tr>
      <th>Component</th>
      <td>core server</td>
    </tr>
    <tr>
      <th>Vector</th>
      <td>
        <a href="https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:N/AC:H/PR:L/UI:N/S:U/C:L/I:N/A:N&version=3.0" target="_blank" rel="noopener noreferer">
          AV:N/AC:H/PR:L/UI:N/S:U/C:L/I:N/A:N
        </a>
      </td>
    </tr>
  </tbody>
</table>


<h2>Reporting Security Vulnerabilities</h2>

<p>
  If you wish to report a new security vulnerability in PostgreSQL, please
  send an email to
  <a href="mailto:security@postgresql.org">security@postgresql.org</a>.
</p>

<p>
  For reporting non-security bugs, please see the <a href="/account/submitbug/">Report a Bug</a> page.
</p>

      </div> <!-- pgContentWrap -->
    </div>
  </div>
</div>

    <!-- Footer -->
    <footer id="footer">
      <div class="container">
        <div class="row">
          <div class="col-md-12">
            <ul>
              <li><a href="https://twitter.com/postgresql"><img src="/media/img/atpostgresql.png" alt="@postgresql"></a></li>
              <li><a href="https://git.postgresql.org/gitweb/?p=postgresql.git"><img src="/media/img/git.png" alt="Git"></a></li>
            </ul>
          </div>
        </div>
      </div>
      <!-- Copyright -->
      <div class="container">
        <a href="/about/policies/">Policies</a> |
        <a href="/about/policies/coc/">Code of Conduct</a> |
        <a href="/about/">About PostgreSQL</a> |
        <a href="/about/contact/">Contact</a><br/>
        <p>Copyright &copy; 1996-2025 The PostgreSQL Global Development Group</p>
      </div>
    </footer>
    <script src="/media/js/jquery-3.4.1.slim.min.js"></script>
    <script src="/media/js/popper-1.16.0.min.js"></script>
    <script src="/media/js/bootstrap-4.4.1.min.js"></script>
    <script src="/media/js/main.js?83493b5d"></script>

  </body>
</html>
