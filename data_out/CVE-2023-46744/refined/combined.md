=== Content from github.com_a6442253_20250111_115406.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FSquidex%2Fsquidex%2Fsecurity%2Fadvisories%2FGHSA-xfr4-qg2v-7v5m)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FSquidex%2Fsquidex%2Fsecurity%2Fadvisories%2FGHSA-xfr4-qg2v-7v5m)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=Squidex%2Fsquidex)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[Squidex](/Squidex)
/
**[squidex](/Squidex/squidex)**
Public

* [Notifications](/login?return_to=%2FSquidex%2Fsquidex) You must be signed in to change notification settings
* [Fork
  462](/login?return_to=%2FSquidex%2Fsquidex)
* [Star
   2.3k](/login?return_to=%2FSquidex%2Fsquidex)

* [Code](/Squidex/squidex)
* [Issues
  1](/Squidex/squidex/issues)
* [Pull requests
  3](/Squidex/squidex/pulls)
* [Actions](/Squidex/squidex/actions)
* [Security](/Squidex/squidex/security)
* [Insights](/Squidex/squidex/pulse)

Additional navigation options

* [Code](/Squidex/squidex)
* [Issues](/Squidex/squidex/issues)
* [Pull requests](/Squidex/squidex/pulls)
* [Actions](/Squidex/squidex/actions)
* [Security](/Squidex/squidex/security)
* [Insights](/Squidex/squidex/pulse)

# Stored XSS via insufficient SVG element filtering

Moderate

[SebastianStehle](/SebastianStehle)
published
GHSA-xfr4-qg2v-7v5m
Nov 7, 2023

## Package

Squidex CMS
(Squidex )

## Affected versions

<= 7.8.2

## Patched versions

7.9.0

## Description

### Summary

A stored Cross-Site Scripting (XSS) vulnerability enables privilege escalation of authenticated users.

### Details

[CENSUS](https://census-labs.com/) identified that the SVG element filtering mechanism intended to stop XSS attacks through uploaded SVG images, is insufficient resulting to stored XSS attacks. The issue has been assigned CVE-2023-46857.

Stored XSS attacks are those where the injected script is permanently stored on the target servers, such as in a database, in a message forum, visitor log, comment field, etc. The victim then retrieves the malicious script from the server when it requests the stored information. In the specific case, an adversary can store a malicious JavaScript payload, packed as an SVG image, through the "upload asset" functionality. This JavaScript payload will be executed every time the image endpoint is visited.

Squidex allows the CMS contributors to be granted the permission of uploading an SVG asset. When the asset is uploaded, a filtering mechanism is performed to validate that the SVG does not contain malicious code. The code executed when uploading an SVG is the following:

```
Squidex/squidex-7.8.2/backend/src/Squidex.Domain.Apps.Entities/Assets/SvgAssetMetadataSource.cs

15: public sealed class SvgAssetMetadataSource : IAssetMetadataSource
    {
       ...
                        using (var reader = new StreamReader(command.File.OpenRead()))
                        {
                            var text = await reader.ReadToEndAsync();

38:                         if (!text.IsValidSvg())
                            {
                                throw new ValidationException(T.Get("validation.notAnValidSvg"));
                            }
      ...
}
```

The `IsValidSvg` method is defined in `Squidex/libs/text/Squidex.Text/HtmlSvgExtensions.cs`:

```
Squidex/libs/text/Squidex.Text/HtmlSvgExtensions.cs

12: public static class HtmlSvgExtensions
    {
        private static readonly HashSet<string> InvalidSvgElements = new HashSet<string>(StringComparer.OrdinalIgnoreCase)
        {
16:         "script"
        };

19:     public static bool IsValidSvg(this string html)
        {
            var document = LoadHtml(html);

            return IsValid(document.DocumentNode);
        }
        [...]

46:   private static bool IsValid(HtmlNode node)
        {
            switch (node.NodeType)
            {
                case HtmlNodeType.Document:
                    return IsChildrenValid(node);

                case HtmlNodeType.Element:
54:                 if (InvalidSvgElements.Contains(node.Name))
                    {
                        return false;
                    }

                    if (node.HasAttributes)
                    {
                        for (var i = 0; i < node.Attributes.Count; i++)
                        {
                            var attribute = node.Attributes[i];

65:                         if (attribute.Name.StartsWith("on", StringComparison.OrdinalIgnoreCase))
                            {
                                return false;
                            }
                        }
                    }

                    if (node.HasChildNodes)
                    {
                        return IsChildrenValid(node);
                    }

                    break;
            }

            return true;
        }
        [...]
```

The validation logic consists of traversing the HTML nodes in the DOM. In order for the validation to succeed, 2 conditions must be met:

1. No HTML tags included in a "blacklist" called "InvalidSvgElements" are present (line 54). This list only contains the element "script".
2. No attributes of HTML tags begin with "on" (i.e. onerror, onclick) (line 65).

If either of the 2 conditions is not satisfied, validation fails and the file/asset is not uploaded.

However it is possible to bypass the above filtering mechanism and execute arbitrary JavaScript code

by introducing other HTML elements such as an <iframe> element with a "src" attribute containing a "javascript:" value.

### PoC

As a Proof-of-Concept, the following SVG file will be successfully uploaded, evading the validation efforts:

```
<svg width="500" height="500" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
  <circle cx="50" cy="50" r="45" fill="green" id="foo"/>
  <foreignObject width="500" height="500">
     <iframe xmlns="http://www.w3.org/1999/xhtml" src="javascript:alert('xss')" width="400" height="250"/>
  </foreignObject>
</svg>
```
### Impact

Authenticated adversaries with the "assets.create" permission, can leverage this vulnerability to upload a malicious SVG as an asset, targeting any registered user that will attempt to open/view the asset through the Squidex CMS.

The impact of this issue is magnified due to the fact that the SVG image is rendered in-browser, under the Squidex instance's domain (in default installations).

As a result, adversaries are able to execute arbitrary JavaScript code inside the browser’s context of the targeted Squidex CMS application user. This can cause a variety of risks for the end user that can range in severity from annoyance to complete account compromise. The most severe attacks involve disclosure of the access token stored in the browser's local storage, allowing the actors to hijack user access and completely take over their accounts. The achieved level of access is directly related to the CMS role and permissions assigned on the compromised user. This means that the overall risk to the application can be significantly increased in cases where CMS administrative users are compromised.

Moreover, this issue undermines the business logic behind the "Image" filetype validation in Content Schemas that permit file uploads. For example, administrators may prohibit clients from uploading elements such as HTML content for a specific schema, but allow them to upload Images, including SVG. However, SVG images may enable XSS vectors as discussed above, creating a false sense of security surrounding the "Image" upload option.

### Severity

Moderate

### CVE ID

CVE-2023-46857

### Weaknesses

[CWE-79](/advisories?query=cwe%3A79)

### Credits

* [![@cmaraziaris](https://avatars.githubusercontent.com/u/48397341?s=40&v=4)](/cmaraziaris)
  [cmaraziaris](/cmaraziaris)
  Reporter

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


