The content relates to CVE-2024-28116.

**Root cause of vulnerability:**
The Grav CMS implements a custom sandbox to protect Twig methods, but the Twig object itself is not protected. This allows an attacker to interact with the Twig object and modify its attributes, bypassing the intended security measures.

**Weaknesses/vulnerabilities present:**
- Server-Side Template Injection (SSTI).
- Insecure use of Twig functions and filters.
- Inadequate security sandbox implementation.
- Ability to modify the configuration of safe functions and filters via Twig template directives.
- Blacklisting approach for dangerous functions instead of whitelisting.

**Impact of exploitation:**
- Remote code execution on the underlying server.
- Full compromise of the server and the application.
- Ability to execute arbitrary OS commands.

**Attack vectors:**
- Malicious Twig template directives injected into a web page.
- The vulnerability is triggered when the crafted page with the malicious template is accessed by any user.

**Required attacker capabilities/position:**
- Authenticated user with editor permissions (sufficient to edit pages).
- Ability to create or edit web pages with Twig processing enabled.