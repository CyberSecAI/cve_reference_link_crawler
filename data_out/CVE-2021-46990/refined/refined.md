```
{
  "vulnerability": {
    "root_cause": "The entry flush mitigation for powerpc64 can be enabled/disabled at runtime by patching kernel code. However, this patching operation was not thread-safe. If a CPU was executing the code being patched, it could result in a corrupted return address (LR register) leading to a crash.",
    "weaknesses": [
      "Race condition during code patching",
      "Lack of proper synchronization for shared resources"
    ],
    "impact": "Kernel crash (segfault) due to corrupted return address, leading to denial of service.",
    "attack_vectors": "Toggling the entry flush barrier via debugfs while other CPUs are active.",
    "required_capabilities": "Ability to write to the debugfs file 'entry_flush' which is typically available to privileged users."
  },
  "fixes": [
        "The fix involves using stop_machine() to ensure all CPUs other than the one doing the patching are stopped, avoiding the race condition.",
        "The patching logic was moved to a static function called by stop_machine."
  ]
}
```