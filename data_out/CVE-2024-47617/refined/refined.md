The provided content relates to CVE-2024-47617.

**Root cause of vulnerability:**
The vulnerability stems from a lack of proper input validation and output encoding of the `slug` parameter in the `MediaStreamController`'s `downloadAction` method within the Sulu CMS. Specifically, the application was not correctly validating if the provided slug matched the actual filename which resulted in the ability to inject malicious code via the filename parameter in the URL.

**Weaknesses/vulnerabilities present:**
- Reflected Cross-Site Scripting (XSS) vulnerability.
- Improper input validation of the `slug` parameter.
- Insufficient output encoding of the `slug` parameter.

**Impact of exploitation:**
- An attacker can inject arbitrary HTML/JavaScript code.
- This could lead to stealing sensitive information, manipulating website content, or performing actions on behalf of the victim.

**Attack vectors:**
- The vulnerability is triggered via a crafted media download URL.
- The attacker manipulates the `slug` parameter in the URL.

**Required attacker capabilities/position:**
- The attacker needs to craft a malicious URL.
- No special privileges are required, but user interaction is needed to trigger the vulnerability by accessing the malicious URL.

**Additional Details:**
- The vulnerability is located in the `SuluMediaBundle` component.
- The vulnerable code is specifically located in the `MediaStreamController.php` file, in the `downloadAction` method.
- The provided commit `eeacd14b6cf55f710084788140d40ebb00314b29` shows a fix removing the filename from the 404 message.
- The commit `a5a5ae555d282e88ff8559d38cfb46dea7939bda` shows a fix to force direct matching for media download URLs.
- The `CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N` score indicates a network-based attack vector, low complexity, no privileges required, user interaction required, scope change, low confidentiality and integrity impact, and no availability impact.
- The vulnerability is assigned CWE-79, which represents Cross-site Scripting.