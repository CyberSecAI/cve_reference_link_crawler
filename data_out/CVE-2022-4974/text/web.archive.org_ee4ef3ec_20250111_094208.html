

[![Wayback Machine](/_static/images/toolbar/wayback-toolbar-logo-200.png)](/web/ "Wayback Machine home page")

[2 captures](/web/20220225174410%2A/https%3A//www.pluginvulnerabilities.com/2022/02/25/our-security-review-of-wordpress-plugin-found-freemius-library-still-contained-vulnerabilities-3-years-after-major-security-incident/ "See a list of every capture for this URL")
25 Feb 2022 - 07 Oct 2022

| Jan | FEB | [**Oct**](https://web.archive.org/web/20221007223351/https%3A//www.pluginvulnerabilities.com/2022/02/25/our-security-review-of-wordpress-plugin-found-freemius-library-still-contained-vulnerabilities-3-years-after-major-security-incident/ "07 Oct 2022") |
| Previous capture | 25 | [Next capture](https://web.archive.org/web/20221007223351/https%3A//www.pluginvulnerabilities.com/2022/02/25/our-security-review-of-wordpress-plugin-found-freemius-library-still-contained-vulnerabilities-3-years-after-major-security-incident/ "22:33:51 Oct 07, 2022") |
| 2021 | 2022 | 2023 |

success
fail

 [About this capture](#expand)

COLLECTED BY

Organization: [Archive Team](https://archive.org/details/archiveteam)

![](http://archiveteam.org/images/e/e6/Archiveteam.jpg) Formed in 2009, the Archive Team (not to be confused with the archive.org Archive-It Team) is a rogue archivist collective dedicated to saving copies of rapidly dying or deleted websites for the sake of history and digital heritage. The group is 100% composed of volunteers and interested parties, and has expanded into a large amount of related projects for saving online and digital history.

History is littered with hundreds of conflicts over the future of a community, group, location or business that were "resolved" when one of the parties stepped ahead and destroyed what was there. With the original point of contention destroyed, the debates would fall to the wayside. Archive Team believes that by duplicated condemned data, the conversation and debate can continue, as well as the richness and insight gained by keeping the materials. Our projects have ranged in size from a single volunteer downloading the data to a small-but-critical site, to over 100 volunteers stepping forward to acquire terabytes of user-created data to save for future generations.

The main site for Archive Team is at [archiveteam.org](http://www.archiveteam.org) and contains up to the date information on various projects, manifestos, plans and walkthroughs.

This collection contains the output of many Archive Team projects, both ongoing and completed. Thanks to the generous providing of disk space by the Internet Archive, multi-terabyte datasets can be made available, as well as in use by the [Wayback Machine](http://archive.org/web/web.php), providing a path back to lost websites and work.

Our collection has grown to the point of having sub-collections for the type of data we acquire. If you are seeking to browse the contents of these collections, the Wayback Machine is the best first stop. Otherwise, you are free to dig into the stacks to see what you may find.

**The Archive Team Panic Downloads** are full pulldowns of currently extant websites, meant to serve as emergency backups for needed sites that are in danger of closing, or which will be missed dearly if suddenly lost due to hard drive crashes or server failures.

Collection: [Archive Team: URLs](https://archive.org/details/archiveteam_urls)

TIMESTAMPS

![loading](/_static/images/loading.gif)

The Wayback Machine - https://web.archive.org/web/20220225174410/https://www.pluginvulnerabilities.com/2022/02/25/our-security-review-of-wordpress-plugin-found-freemius-library-still-contained-vulnerabilities-3-years-after-major-security-incident/

[Login](https://web.archive.org/web/20220225174410/https%3A//www.pluginvulnerabilities.com/my-account/ "Login / Register")
[# Plugin Vulnerabilities

## A service to protect your site against vulnerabilities in WordPress plugins.](https://web.archive.org/web/20220225174410/https%3A//www.pluginvulnerabilities.com/ "A service to protect your site against vulnerabilities in WordPress plugins.")

* [Sign Up](https://web.archive.org/web/20220225174410/https%3A//www.pluginvulnerabilities.com/product/subscription/)
* [Plugin Security Checker](https://web.archive.org/web/20220225174410/https%3A//www.pluginvulnerabilities.com/plugin-security-checker/)
* [Plugin Vulnerabilities Firewall](https://web.archive.org/web/20220225174410/https%3A//www.pluginvulnerabilities.com/plugin-vulnerabilities-firewall/)

25
Feb

# Our Security Review of WordPress Plugin Found Freemius Library Still Contained Vulnerabilities 3 Years After Major Security Incident

Three years ago, the Freemius library, which is a monetization library widely used in WordPress plugins, fixed [a serious vulnerability only after a hacker had identified it and started exploiting it](https://web.archive.org/web/20220225174410/https%3A//www.pluginvulnerabilities.com/2019/02/26/hackers-are-probably-already-exploiting-this-authenticated-option-update-vulnerability-just-fixed-in-freemius/). The situation surrounding that [was quite a mess](https://web.archive.org/web/20220225174410/https%3A//www.pluginvulnerabilities.com/2019/02/27/a-legal-threat-and-an-attempted-cover-up-of-the-exploitation-of-the-freemius-authenticated-option-update-vulnerability/). It would be reasonable to think that the developer of the library and the developer of the plugins, especially security plugins, using the library would have made sure to get the security of the library reviewed after that to address any other security issues, but that turns out not to be the case.

What makes that more striking is that the developer claimed after that went down [that](https://web.archive.org/web/20220225174410/https%3A//freemius.com/blog/sdk-security-vulnerability/):

> security is top priority for us

And that:

> Even though we have a very strong security background, we conduct thorough code reviews and work with an experienced security researcher from the HackerOne community, yet this vulnerability still slipped through the cracks. 😔

As part of [our main service](https://web.archive.org/web/20220225174410/https%3A//www.pluginvulnerabilities.com/product/subscription/), we do [security reviews of WordPress plugins selected by our customers](https://web.archive.org/web/20220225174410/https%3A//www.pluginvulnerabilities.com/wordpress-plugin-security-reviews/). Earlier this month we did a review of a plugin with 100,000+ installs that contains the Freemius library. We found that the plugin and the Freemius library contained vulnerabilities and other security issues. It is hard to believe “thorough code reviews” could have been done of Fremius, as we did less than that and found multiple security vulnerabilities. The most serious vulnerability we found in Freemius is directly connected with the code that was the cause of the previously exploited vulnerability, but somehow wasn’t secured at the time.

The developer of the plugin promptly communicated with us and provided us with their fixes so that we could confirm the issues were addressed. By comparison, with the Freemius library, we only received an initial acknowledgement that the issues would be addressed, but nothing more.

Following the bad practices from three years ago the developer again has failed to make the fixed version of the library widely available, while a new version that partially addresses the issues we found has been released, it again isn’t available through the library’s GitJub project. With the [latest update to that being put out on January 3](https://web.archive.org/web/20220225174410/https%3A//github.com/Freemius/wordpress-sdk/commits/master).

Elsewhere though it is clear that the library has had security changes made, as for example, the plugin [Featured Images in RSS for Mailchimp & More](https://web.archive.org/web/20220225174410/https%3A//wordpress.org/plugins/featured-images-for-rss-feeds/), which has 30,000+ installs, had this changelog for a new version released on late on Wednesday:

> Updated Freemius SDK with improvements and security fixes, bump WP compatibility to v5.9.1.

The [changes made](https://web.archive.org/web/20220225174410/https%3A//plugins.trac.wordpress.org/changeset/2684111/) are clearly based on the issues we notified Freemius of. Since this is now public, we can go ahead with detailing the issues.

While the vulnerabilities were addressed, some of the insecurity we found still hasn’t been addressed in Freemius.

## Plugins With Over 5 Million Installs Impacted

Checking for usage of the Freemius library using a search of WP Directory [indicates that over 800 plugins in WordPress’ plugin directory contain the library](https://web.archive.org/web/20220225174410/https%3A//wpdirectory.net/search/01FWPVWA7BC5DYGZHNSZQ9QMN5) and that the 100 most popular of those have over 5.3 million installs. Among the most popular are five security realted plugins:

* [WP Activity Log](https://web.archive.org/web/20220225174410/https%3A//wordpress.org/plugins/wp-security-audit-log/) – 100,000 installs
* [WP fail2ban](https://web.archive.org/web/20220225174410/https%3A//wordpress.org/plugins/wp-fail2ban/) – 70,000 installs
* [WP Encryption](https://web.archive.org/web/20220225174410/https%3A//wordpress.org/plugins/wp-letsencrypt-ssl/) – 50,000 installs
* [SSL Zen](https://web.archive.org/web/20220225174410/https%3A//wordpress.org/plugins/ssl-zen/) – 30,000 installs
* [Security Ninja](https://web.archive.org/web/20220225174410/https%3A//wordpress.org/plugins/security-ninja/) – 9,000 installs

The two most popular of those, WP Activity Log  and WP fail2ban, as well as SSL Zen, have yet to be updated to include the new version of Freemius

## Authenticated Information Disclosure

What looks to be the most serious vulnerability we identified is that anyone logged in to WordPress has had access to the library’s debug log, despite it only being intended to be accessed by users with the Administrator role. The severity of that access would depend on if sensitive information got stored in the log.

What makes the lack of security on that stick out is that function being used, \_get\_debug\_log, is registered two lines up from the function that was at the root of the exploited vulnerability, \_set\_db\_option:

| ``` 3430 3431 3432 3433 3434  ``` | ``` self::add_ajax_action_static( 'get_debug_log', array( 'Freemius', '_get_debug_log' ) );   self::add_ajax_action_static( 'get_db_option', array( 'Freemius', '_get_db_option' ) );   self::add_ajax_action_static( 'set_db_option', array( 'Freemius', '_set_db_option' ) ); ``` |
| --- | --- |

self::add\_ajax\_action\_static( 'get\_debug\_log', array( 'Freemius', '\_get\_debug\_log' ) );
self::add\_ajax\_action\_static( 'get\_db\_option', array( 'Freemius', '\_get\_db\_option' ) );
self::add\_ajax\_action\_static( 'set\_db\_option', array( 'Freemius', '\_set\_db\_option' ) );

That has been addressed by adding a capabilities check to the code (as well as a nonce check):

| ``` 3575 3576 3577 3578 3579 3580  ``` | ``` static function _get_debug_log() { 	check_admin_referer( 'fs_get_debug_log' );   	if ( ! is_super_admin() ) { 		return; 	} ``` |
| --- | --- |

static function \_get\_debug\_log() {
check\_admin\_referer( 'fs\_get\_debug\_log' );
if ( ! is\_super\_admin() ) {
return;
}

## Cross-Site Request Forgery (CSRF)

The functionality that enables the library’s debug mode was also insecure, as it lacked protection against cross-site request forgery (CSRF). So an attacker could have previously caused a logged in Administrator to enable that without intending it.

That was addressed by adding a nonce check:

| ``` 3522 3523  ``` | ``` static function _toggle_debug_mode() { 	check_admin_referer( 'fs_toggle_debug_mode' ); ``` |
| --- | --- |

static function \_toggle\_debug\_mode() {
check\_admin\_referer( 'fs\_toggle\_debug\_mode' );

## More Functionality Similarly Impacted

Both capabilities checks and nonces are basic security in a WordPress plugin, so their being missing in those locations is hard to square with the developer of the library’s security claims mentioned above.

Several other functions we notified the developer of also had capabilities checks and nonce checks added. Those were the function dismiss\_notice\_ajax\_callback() in the file /includes/managers/class-fs-admin-notice-manager.php, as well as the functions \_retry\_connectivity\_test() and \_email\_about\_firewall\_issue() in the file /includes/class-freemius.php.

## Sanitizing and Validation Still Probably Lacking

Another issue that we noticed is that in a lot of places, the library is bringing in user input without sanitizing or validating it, which, if done, would improve security. A lot of that can be seen by looking at instance of usage of the function fs\_request\_get(), which brings in user input, in the code.

Unfortunately, the new version of the library only makes a change in that in regards to two of the functions previously mentioned in this post. Elsewhere, the code hasn’t been changed to address that.

## Lack of Protection Against Direct Access to PHP Files

Most of the plugin’s .php files that didn’t appear to be intended to be directly accessed contained protection against direct access, but a few were missing that. We didn’t see anything that could be exploited in the files without the restriction in place, but restricting access to them would ensure that there isn’t any issue with that.

The issue was mostly addressed by adding the protection to all but one of the files missing it. The remaining file being /includes/fs-essential-functions.php.

---

### Concerned About The Security of the Plugins You Use?

When you are a paying customer of our service, [you can suggest/vote for the WordPress plugins you use to receive a security review from us](https://web.archive.org/web/20220225174410/https%3A//www.pluginvulnerabilities.com/wordpress-plugin-security-reviews/). You can start using the service for free when you sign up now. We also offer [security reviews of WordPress plugins as a separate service](https://web.archive.org/web/20220225174410/https%3A//www.pluginvulnerabilities.com/wordpress-plugin-security-review-service/).
[Plugin Vulnerabilities](https://web.archive.org/web/20220225174410/https%3A//www.pluginvulnerabilities.com/)
Posted in [Analysis](https://web.archive.org/web/20220225174410/https%3A//www.pluginvulnerabilities.com/category/analysis/), [Vulnerability Report](https://web.archive.org/web/20220225174410/https%3A//www.pluginvulnerabilities.com/category/vulnerability-report/)
[Analysis](https://web.archive.org/web/20220225174410/https%3A//www.pluginvulnerabilities.com/tag/analysis/), [Freemius](https://web.archive.org/web/20220225174410/https%3A//www.pluginvulnerabilities.com/tag/freemius/), [Vulnerability Report](https://web.archive.org/web/20220225174410/https%3A//www.pluginvulnerabilities.com/tag/vulnerability-report/)
[Leave a comment](https://web.archive.org/web/20220225174410/https%3A//www.pluginvulnerabilities.com/2022/02/25/our-security-review-of-wordpress-plugin-found-freemius-library-still-contained-vulnerabilities-3-years-after-major-security-incident/#respond)

# Post navigation

### Leave a Reply [Cancel reply](/web/20220225174410/https%3A//www.pluginvulnerabilities.com/2022/02/25/our-security-review-of-wordpress-plugin-found-freemius-library-still-contained-vulnerabilities-3-years-after-major-security-incident/#respond)

Your email address will not be published. Required fields are marked \*

Comment

Name \*

Email \*

Website

In order to pass the CAPTCHA please enable JavaScript

### Services for Average Websites

* [Plugin Vulnerabilities Subscription](https://web.archive.org/web/20220225174410/https%3A//www.pluginvulnerabilities.com/product/subscription/ "Plugin Vulnerabilities Subscription")
  From: US$100.00  / year with 1 month free trial
* [Plugin Vulnerabilities Subscription for ClassicPress](https://web.archive.org/web/20220225174410/https%3A//www.pluginvulnerabilities.com/product/plugin-vulnerabilities-subscription-for-classicpress/ "Plugin Vulnerabilities Subscription for ClassicPress")
  From: US$100.00  / year with 1 month free trial
### Services for Websites with Above Average Security Risk

* [Plugin Vulnerabilities Subscription](https://web.archive.org/web/20220225174410/https%3A//www.pluginvulnerabilities.com/product/subscription/ "Plugin Vulnerabilities Subscription")
  From: US$100.00  / year with 1 month free trial
* [WordPress Plugin Security Review](https://web.archive.org/web/20220225174410/https%3A//www.pluginvulnerabilities.com/wordpress-plugin-security-review-service/ "WordPress Plugin Security Review")
  From: US$100.00
* [Wordpress Theme Security Review](https://web.archive.org/web/20220225174410/https%3A//www.pluginvulnerabilities.com/wordpress-theme-security-review-service/ "WordPress Theme Security Review")
  US$250.00
* [Plugin Vulnerabilities Subscription for ClassicPress](https://web.archive.org/web/20220225174410/https%3A//www.pluginvulnerabilities.com/product/plugin-vulnerabilities-subscription-for-classicpress/ "Plugin Vulnerabilities Subscription for ClassicPress")
  From: US$100.00  / year with 1 month free trial
### Services for Web Hosts and Security Providers

* [Plugin Vulnerabilities Daily Newsletter](https://web.archive.org/web/20220225174410/https%3A//www.pluginvulnerabilities.com/product/plugin-vulnerabilities-daily-newsletter/ "Plugin Vulnerabilities Daily Newsletter")
  US$1,000.00  / month with 1 month free trial
* [Custom Solutions for Web Hosts](https://web.archive.org/web/20220225174410/https%3A//www.pluginvulnerabilities.com/solutions-for-web-hosts/ "Plugin Vulnerabilities Daily Newsletter")
* [Custom Solutions for Security Providers](https://web.archive.org/web/20220225174410/https%3A//www.pluginvulnerabilities.com/solutions-for-security-providers/ "Plugin Vulnerabilities Daily Newsletter")

Powered by WordPress and WooCommerce

© 2016-2022 [White Fir Design LLC](https://web.archive.org/web/20220225174410/http%3A//www.whitefirdesign.com/) | [Privacy Policy](/web/20220225174410/https%3A//www.pluginvulnerabilities.com/privacy-policy/) | [Contact Us](/web/20220225174410/https%3A//www.pluginvulnerabilities.com/contact/) | [Report a Vulnerability](/web/20220225174410/https%3A//www.pluginvulnerabilities.com/report-a-vulnerability/)
 Fruitful theme by [fruitfulcode](https://web.archive.org/web/20220225174410/http%3A//fruitfulcode.com/)

[↑](#top "Back to top")

![](https://web.archive.org/web/20220225174410im_/https://www.pluginvulnerabilities.com/piwik/piwik.php?idsite=1&rec=1)

