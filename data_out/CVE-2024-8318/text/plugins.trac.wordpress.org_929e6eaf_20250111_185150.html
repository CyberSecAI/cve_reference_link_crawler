

[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fchangeset%3Fnew_path%3D%252Fattributes-for-blocks%26old%3D3066420%26new%3D3144730%26old_path%3D%252Fattributes-for-blocks)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* [Reverse Diff](/changeset/3066420/attributes-for-blocks?old=3144730&old_path=%2Fattributes-for-blocks)

---

# Changes in [attributes-for-blocks](/browser/attributes-for-blocks?rev=3144730 "Show entry in browser") [[3066420:3144730]](/log/attributes-for-blocks?rev=3144730&stop_rev=3066420 "Show revision log")

View differences
inline
side by side

Show
lines around each change

Show the changes in full context

Ignore:

Blank lines

Case changes

White space changes

Location:
[attributes-for-blocks](/browser/attributes-for-blocks?rev=3144730)
Files:

10 added
5 edited

* [tags/1.0.7](/browser/attributes-for-blocks/tags/1.0.7?rev=3144730 "Show entry in browser")
  (added)
* [tags/1.0.7/attributes-for-blocks.php](/browser/attributes-for-blocks/tags/1.0.7/attributes-for-blocks.php?rev=3144730 "Show entry in browser")
  (added)
* [tags/1.0.7/build](/browser/attributes-for-blocks/tags/1.0.7/build?rev=3144730 "Show entry in browser")
  (added)
* [tags/1.0.7/build/index.asset.php](/browser/attributes-for-blocks/tags/1.0.7/build/index.asset.php?rev=3144730 "Show entry in browser")
  (added)
* [tags/1.0.7/build/index.js](/browser/attributes-for-blocks/tags/1.0.7/build/index.js?rev=3144730 "Show entry in browser")
  (added)
* [tags/1.0.7/build/style-index-rtl.css](/browser/attributes-for-blocks/tags/1.0.7/build/style-index-rtl.css?rev=3144730 "Show entry in browser")
  (added)
* [tags/1.0.7/build/style-index.css](/browser/attributes-for-blocks/tags/1.0.7/build/style-index.css?rev=3144730 "Show entry in browser")
  (added)
* [tags/1.0.7/index.php](/browser/attributes-for-blocks/tags/1.0.7/index.php?rev=3144730 "Show entry in browser")
  (added)
* [tags/1.0.7/readme.txt](/browser/attributes-for-blocks/tags/1.0.7/readme.txt?rev=3144730 "Show entry in browser")
  (added)
* [trunk/attributes-for-blocks.php](/browser/attributes-for-blocks/trunk/attributes-for-blocks.php?rev=3144730 "Show entry in browser")
  (modified)
  ([2 diffs](#file9 "Show differences"))
* [trunk/build/index.asset.php](/browser/attributes-for-blocks/trunk/build/index.asset.php?rev=3144730 "Show entry in browser")
  (modified)
  ([1 diff](#file10 "Show differences"))
* [trunk/build/index.js](/browser/attributes-for-blocks/trunk/build/index.js?rev=3144730 "Show entry in browser")
  (modified)
  ([1 diff](#file11 "Show differences"))
* [trunk/build/style-index-rtl.css](/browser/attributes-for-blocks/trunk/build/style-index-rtl.css?rev=3144730 "Show entry in browser")
  (added)
* [trunk/build/style-index.css](/browser/attributes-for-blocks/trunk/build/style-index.css?rev=3144730 "Show entry in browser")
  (modified)
  ([1 diff](#file13 "Show differences"))
* [trunk/readme.txt](/browser/attributes-for-blocks/trunk/readme.txt?rev=3144730 "Show entry in browser")
  (modified)
  ([4 diffs](#file14 "Show differences"))

### Legend:

Unmodified
Added
Removed

* ## [attributes-for-blocks/trunk/attributes-for-blocks.php](/changeset/3144730/attributes-for-blocks/trunk/attributes-for-blocks.php?old=3066420&old_path=attributes-for-blocks%2Ftrunk%2Fattributes-for-blocks.php "Show the [3066420:3144730] differences restricted to attributes-for-blocks/trunk/attributes-for-blocks.php")

  | [r3066420](/browser/attributes-for-blocks/trunk/attributes-for-blocks.php?rev=3066420#L4 "Show revision 3066420 of this file in browser") | [r3144730](/browser/attributes-for-blocks/trunk/attributes-for-blocks.php?rev=3144730#L4 "Show revision 3144730 of this file in browser") |  |
  | --- | --- | --- |
  | 4 | 4 | \* Plugin URI: https://wordpress.org/plugins/attributes-for-blocks |
  | 5 | 5 | \* Description: Allows to add HTML attributes to Gutenberg blocks. |
  | 6 |  | \* Version: 1.0.~~6~~ |
  |  | 6 | \* Version: 1.0.7 |
  | 7 | 7 | \* Author: websevendev |
  | 8 | 8 | \* Author URI: https://github.com/websevendev |
  | […](/browser/attributes-for-blocks/trunk/attributes-for-blocks.php?rev=3066420#L250) | […](/browser/attributes-for-blocks/trunk/attributes-for-blocks.php?rev=3144730#L250) |  |
  | 250 | 250 |  |
  | 251 | 251 | /\*\* |
  |  | 252 | \* Strips `attributesForBlocks` block attribute when the current user doesn't have `unfiltered\_html` capabilities. |
  |  | 253 | \* |
  |  | 254 | \* @param string $content Content to filter through KSES. |
  |  | 255 | \*/ |
  |  | 256 | function sanitize\_attributes($content) { |
  |  | 257 |  |
  |  | 258 | if(current\_user\_can('unfiltered\_html')) { |
  |  | 259 | return $content; |
  |  | 260 | } |
  |  | 261 |  |
  |  | 262 | if(!has\_blocks($content)) { |
  |  | 263 | return $content; |
  |  | 264 | } |
  |  | 265 |  |
  |  | 266 | if(strpos($content, 'attributesForBlocks') === false) { |
  |  | 267 | return $content; |
  |  | 268 | } |
  |  | 269 |  |
  |  | 270 | $matches = null; |
  |  | 271 | if(preg\_match\_all('/\\\?"attributesForBlocks\\\?"\s\*:\s\*{[^}]\*}/', $content, $matches)) { |
  |  | 272 |  |
  |  | 273 | foreach($matches[0] as $atts) { |
  |  | 274 |  |
  |  | 275 | $empty\_atts = '"attributesForBlocks":{}'; |
  |  | 276 | $was\_slashed = wp\_unslash($atts) !== $atts; |
  |  | 277 | if($was\_slashed) { |
  |  | 278 | $empty\_atts = wp\_slash($empty\_atts); |
  |  | 279 | } |
  |  | 280 | $content = str\_replace($atts, $empty\_atts, $content); |
  |  | 281 | } |
  |  | 282 | } |
  |  | 283 |  |
  |  | 284 | return $content; |
  |  | 285 | } |
  |  | 286 | add\_filter('pre\_kses', \_\_NAMESPACE\_\_ . '\\sanitize\_attributes'); |
  |  | 287 |  |
  |  | 288 |  |
  |  | 289 | /\*\* |
  | 252 | 290 | \* Add GitHub link on the plugins page. |
  | 253 | 291 | \* |
* ## [attributes-for-blocks/trunk/build/index.asset.php](/changeset/3144730/attributes-for-blocks/trunk/build/index.asset.php?old=3066420&old_path=attributes-for-blocks%2Ftrunk%2Fbuild%2Findex.asset.php "Show the [3066420:3144730] differences restricted to attributes-for-blocks/trunk/build/index.asset.php")

  | [r3066420](/browser/attributes-for-blocks/trunk/build/index.asset.php?rev=3066420#L1 "Show revision 3066420 of this file in browser") | [r3144730](/browser/attributes-for-blocks/trunk/build/index.asset.php?rev=3144730#L1 "Show revision 3144730 of this file in browser") |  |
  | --- | --- | --- |
  | 1 |  | <?php return array('dependencies' => array('react', '~~wp-block-editor', 'wp-blocks', 'wp-components', 'wp-compose', 'wp-element', 'wp-hooks', 'wp-i18n', 'wp-primitives'), 'version' => 'a8aee59bf7a26a940ff3~~'); |
  |  | 1 | <?php return array('dependencies' => array('react', 'react-jsx-runtime', 'wp-block-editor', 'wp-blocks', 'wp-components', 'wp-compose', 'wp-data', 'wp-editor', 'wp-element', 'wp-hooks', 'wp-i18n', 'wp-primitives'), 'version' => 'ef887421d1357f491dd0'); |
* ## [attributes-for-blocks/trunk/build/index.js](/changeset/3144730/attributes-for-blocks/trunk/build/index.js?old=3066420&old_path=attributes-for-blocks%2Ftrunk%2Fbuild%2Findex.js "Show the [3066420:3144730] differences restricted to attributes-for-blocks/trunk/build/index.js")

  | [r3066420](/browser/attributes-for-blocks/trunk/build/index.js?rev=3066420#L1 "Show revision 3066420 of this file in browser") | [r3144730](/browser/attributes-for-blocks/trunk/build/index.js?rev=3144730#L1 "Show revision 3144730 of this file in browser") |  |
  | --- | --- | --- |
  | 1 |  | (()=>{var t,e={~~674:(t,e,r)=>{"use strict";const o=window.React,a=window.wp.hooks,s=window.wp.blocks,n=window.wp.element,l=window.wp.compose,i=window.wp.i18n,c=window.wp.blockEditor,u=window.wp.components,b=window.wp.primitives,d=(0,o.createElement)(b.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,o.createElement)(b.Path,{d:"M6 4a2 2 0 0 0-2 2v3h1.5V6a.5.5 0 0 1 .5-.5h3V4H6Zm3 14.5H6a.5.5 0 0 1-.5-.5v-3H4v3a2 2 0 0 0 2 2h3v-1.5Zm6 1.5v-1.5h3a.5.5 0 0 0 .5-.5v-3H20v3a2 2 0 0 1-2 2h-3Zm3-16a2 2 0 0 1 2 2v3h-1.5V6a.5.5 0 0 0-.5-.5h-3V4h3Z"})),h=(0,o.createElement)(b.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,o.createElement)(b.Path,{d:"M12 4.75a7.25 7.25 0 100 14.5 7.25 7.25 0 000-14.5zM3.25 12a8.75 8.75 0 1117.5 0 8.75 8.75 0 01-17.5 0zM12 8.75a1.5 1.5 0 01.167 2.99c-.465.052-.917.44-.917 1.01V14h1.5v-.845A3 3 0 109 10.25h1.5a1.5 1.5 0 011.5-1.5zM11.25 15v1.5h1.5V15h-1.5z"})),m=({children:t,as:e="div",...r})=>(0,n.createElement)(e,{dangerouslySetInnerHTML:{\_\_html:t},...r}),p=()=>{const[t,e]=(0,n.useState)(!1);return(0,o.createElement)(n.Fragment,null,(0,o.createElement)(u.Button,{variant:"secondary",className:"wsd-afb\_\_button-help","aria-label":(0,i.\_\_)("Show Attributes for Blocks help","attributes-for-blocks"),onClick:()=>e(!0),icon:h}),t&&(0,o.createElement)(u.Modal,{title:(0,i.\_\_)("Attributes for Blocks help","attributes-for-blocks"),onRequestClose:()=>e(!1),className:"wsd-afb\_\_help",style:{maxWidth:720}},(0,o.createElement)("div",{className:"wsd-afb\_\_help\_\_content"},(0,o.createElement)("h3",null,(0,i.\_\_)("How do I add an attribute?","attributes-for-blocks")),(0,o.createElement)("p",null,(0,i.\_\_)('Type an attribute name into the "Add attribute" field and press "Add" to add an attribute for the block. A new input with the attribute\'s name should appear below, into which you can optionally insert the attribute value.',"attributes-for-blocks")),(0,o.createElement)(m,{as:"p"},`\n\t\t\t\t\t\t\t${(0,i.\_\_)("Example attributes: ","attributes-for-blocks")}\n\t\t\t\t\t\t\t<code>style</code>,\n\t\t\t\t\t\t\t<code>title</code>,\n\t\t\t\t\t\t\t<code>target</code>,\n\t\t\t\t\t\t\t<code>class</code>,\n\t\t\t\t\t\t\t<code>id</code>,\n\t\t\t\t\t\t\t<code>onClick</code>,\n\t\t\t\t\t\t\t<code>data-\*</code>,\n\t\t\t\t\t\t\t<code>aria-\*</code>.\n\t\t\t\t\t\t`),(0,o.createElement)("h3",null,(0,i.\_\_)("How does it work?","attributes-for-blocks")),(0,o.createElement)(m,{as:"p"},`\n\t\t\t\t\t\t\t${(0,i.\_\_)("For regular blocks, attributes are added to the block save content's root element, meaning they will be rendered only on the front end and not in the editor. For dynamic blocks the attributes are added via `render\_callback` function and they may also be applied in the editor, depending if the block is rendered server or client side.","attributes-for-blocks")}\n\t\t\t\t\t\t`),(0,o.createElement)("h3",null,(0,i.\_\_)("Does it work for every block?","attributes-for-blocks")),(0,o.createElement)(m,{as:"p"},`\n\t\t\t\t\t\t\t${(0,i.\_\_)("It should work with normal blocks that render a valid WP Element that can utilize the `blocks.getSaveContent.extraProps` filter as well as dynamic blocks that utilize a `render\_callback`. Third party blocks that do something unorthodox may not work.","attributes-for-blocks")}\n\t\t\t\t\t\t`),(0,o.createElement)("h3",null,(0,i.\_\_)("Modes","attributes-for-blocks")),(0,o.createElement)("p",null,(0,i.\_\_)("You can change between modes by clicking the button next to the input where the attribute value is specified.","attributes-for-blocks")),(0,o.createElement)("h4",null,(0,i.\_\_)("Merge mode (default)","attributes-for-blocks")),(0,o.createElement)("p",null,(0,i.\_\_)("In merge mode, when a block has already defined the attribute you're trying to add, the values are merged.","attributes-for-blocks")),(0,o.createElement)("h4",null,(0,i.\_\_)("Override mode","attributes-for-blocks")),(0,o.createElement)("p",null,(0,i.\_\_)("In override mode, when a block has already defined the attribute you're trying to add, the value is completely replaced with the provided value. You can switch between modes by clicking the intersecting arrows button next to the attribute input.","attributes-for-blocks")),(0,o.createElement)("h3",null,(0,i.\_\_)("What happens when I disable this plugin?","attributes-for-blocks")),(0,o.createElement)("p",null,(0,i.\_\_)('Blocks with custom attributes may become invalid, depending on which attributes you\'ve added. From there you can recover the block without the custom attributes by clicking "Attempt Block Recovery" or keep the block with custom attributes as HTML by choosing "Convert to HTML". If you don\'t want to risk blocks becoming invalid you need to remove all custom attributes before disabling the plugin.',"attributes-for-blocks")),(0,o.createElement)("h3",null,(0,i.\_\_)("Common attributes","attributes-for-blocks")),(0,o.createElement)("h4",null,(0,i.\_\_)("Style attribute","attributes-for-blocks")),(0,o.createElement)(m,{as:"p"},`\n\t\t\t\t\t\t\t${(0,i.\_\_)("Inline styles can be defined as text.","attributes-for-blocks")}\n\t\t\t\t\t\t\t${(0,i.\_\_)("Example:","attributes-for-blocks")} <code>color:red;font-weight:bold</code><br>\n\t\t\t\t\t\t\t${(0,i.\_\_)("Spaces are allowed, leading or trailing semicolons are not needed.","attributes-for-blocks")}<br>\n\t\t\t\t\t\t\t${(0,i.\_\_)("Styles are not rendered in the block editor.","attributes-for-blocks")}\n\t\t\t\t\t\t`),(0,o.createElement)("h5",null,(0,i.\_\_)("Advanced editor","attributes-for-blocks")),(0,o.createElement)(m,{as:"p"},`\n\t\t\t\t\t\t\t${(0,i.\_\_)('Style attribute can be edited with an advanced editor by clicking "Toggle editor".',"attributes-for-blocks")}\n\t\t\t\t\t\t`),(0,o.createElement)("h4",null,(0,i.\_\_)("ID attribute","attributes-for-blocks")),(0,o.createElement)("p",null,(0,i.\_\_)('If the block supports it, you should use the built-in "HTML anchor" feature instead.',"attributes-for-blocks")),(0,o.createElement)("h4",null,(0,i.\_\_)("Class attribute","attributes-for-blocks")),(0,o.createElement)("p",null,(0,i.\_\_)('HTML class attribute can be defined with the regular "class" or React\'s "className" attribute (non-dynamic blocks). Results (merging/overriding) may vary depending on the block. If the block supports it, you should use the built-in "Additional CSS Class" feature instead.',"attributes-for-blocks")))))};var f=r(133);const k=f.default||f,g="-afb-placeholder",\_="-afb-space",y=({toggleStyleEditor:t,resetStyles:e})=>(0,o.createElement)("p",{style:{marginBottom:0}},(0,o.createElement)("span",{style:{color:"red"}},(0,i.\_\_)("Unable to parse styles.","attributes-for-blocks"))," ",(0,o.createElement)("a",{href:"#",onClick:t},(0,i.\_\_)("Edit","attributes-for-blocks")),` ${(0,i.\_\_)("or","attributes-for-blocks")} `,(0,o.createElement)("a",{href:"#",onClick:e},(0,i.\_\_)("Clear value","attributes-for-blocks"))),v=t=>t.replaceAll(":","").replaceAll(";",""),E=(t,e=!0)=>{const r=()=>{const e=document.querySelector(t);null!==e&&e.focus()};e?setTimeout(r,50):r()},w=({value:t,onChange:e,toggleStyleEditor:r})=>{const[a,s]=(0,n.useState)(!1);let l;try{l=k(t)}catch(t){const a=t=>(t.preventDefault(),e(""),!1);return(0,o.createElement)(y,{toggleStyleEditor:r,resetStyles:a})}l||(l={[g]:g});const c=r=>{const o=Object.keys(r).map((t=>""===t?g:t)).map((t=>{let e=r[t]||g;return" "===e[e.length-1]&&(e=e.slice(0,-1)+\_),`${t}: ${e};`})).join(" ");t!==o&&e(o)},b=Object.keys(l);return(0,o.createElement)(o.Fragment,null,b.map(((t,e)=>{const r=0===e,n=e+1===b.length,d=1===b.length,h=t===g&&l[t]===g;return(0,o.createElement)("div",{key:`rule-${e}`,className:"wsd-afb-action-input wsd-afb-style","data-index":e,"data-is-blank":h},(0,o.createElement)(u.TextControl,{placeholder:(0,i.\_\_)("Property...","attributes-for-blocks"),value:t===g?"":t,onChange:e=>{""!==e&&b.includes(e)&&(e=`${e}-`,s(!0)),c(b.reduce(((r,o)=>(o===t?r[v(e)]=l[o]:r[o]=l[o],r)),{}))},onKeyDown:t=>{a&&("-"===t.key&&(t.preventDefault(),t.stopPropagation()),s(!1))},onKeyUp:t=>{"Enter"===t.key&&E(`.wsd-afb-style[data-index="${e}"] .components-base-control + .components-base-control input[type="text"]`,!1)}}),(0,o.createElement)(u.TextControl,{placeholder:(0,i.\_\_)("Value...","attributes-for-blocks"),value:l[t]===g?"":l[t].replace(\_," "),onChange:e=>{c({...l,[t]:v(e)})},onBlur:()=>{l[t].includes(\_)&&c({...l,[t]:l[t].replace(\_,"")})},onKeyUp:t=>{if("Enter"===t.code){const t=n&&!l.hasOwnProperty(g);t&&c({...l,[g]:g}),E(`.wsd-afb-style[data-index="${e+1}"] input[type="text"]`,t)}}}),(0,o.createElement)("div",{className:"wsd-afb-button-group"},(0,o.createElement)(u.Button,{className:"button icon-button","aria-label":(0,i.\_\_)("Move up","attributes-for-blocks"),disabled:r,onClick:()=>c(b.filter((e=>e!==t)).reduce(((r,o,a)=>(a===e-1&&(r[t]=l[t]),r[o]=l[o],r)),{}))},(0,o.createElement)(u.Dashicon,{icon:"arrow-up"})),(0,o.createElement)(u.Button,{className:"button icon-button is-top-right","aria-label":(0,i.\_\_)("Remove rule","attributes-for-blocks"),disabled:d&&h,onClick:()=>{const{[t]:e,...r}=l;c({...r,...d&&{[g]:g}})}},(0,o.createElement)(u.Dashicon,{icon:"no"})),(0,o.createElement)(u.Button,{className:"button icon-button","aria-label":(0,i.\_\_)("Move down","attributes-for-blocks"),disabled:n,onClick:()=>c(b.filter((e=>e!==t)).reduce(((r,o,a)=>(r[o]=l[o],a===e&&(r[t]=l[t]),r)),{}))},(0,o.createElement)(u.Dashicon,{icon:"arrow-down"})),(0,o.createElement)(u.Button,{className:"button icon-button is-bottom-right","aria-label":(0,i.\_\_)("Add rule","attributes-for-blocks"),disabled:t===g,onClick:()=>{if(n){const{[g]:t,...e}=l;c({...e,[g]:g})}else c(b.reduce(((t,r,o)=>(r===g||(t[r]=l[r],o===e&&(t[g]=g)),t)),{}));E('.wsd-afb-style[data-is-blank="true"] input[type="text"]')}},(0,o.createElement)(u.Dashicon,{icon:"plus"}))))})))};class A extends n.Component{constructor(){super(...arguments),this.state={adding:"",message:void 0,styleEditor:JSON.parse(localStorage.getItem("attributesForBlocks/styleEditor"))||!1,isFullscreen:!1},this.addAttribute=this.addAttribute.bind(this),this.removeAttribute=this.removeAttribute.bind(this),this.toggleAttributeMode=this.toggleAttributeMode.bind(this),this.toggleStyleEditor=this.toggleStyleEditor.bind(this)}componentDidUpdate(t,e){e.adding&&!this.state.adding&&setTimeout((()=>{"style"===e.adding&&this.state.styleEditor?document.querySelector('.wsd-afb-style input[type="text"]')?.focus():document.querySelector(`.wsd-afb-action-input#afb-${e.adding} input[type="text"]`)?.focus()}),150),e.styleEditor!==this.state.styleEditor&&localStorage.setItem("attributesForBlocks/styleEditor",this.state.styleEditor)}addAttribute(t){t.preventDefault();let{adding:e}=this.state;if(!e)return void this.setState({message:(0,i.\_\_)("No attribute name specified.","attributes-for-blocks")});let{setAttributes:r}=this.props,{attributesForBlocks:o}=this.props.attributes;if(!o)return void this.setState({message:(0,i.\_\_)("Unable to add attributes to block.","attributes-for-blocks")});let a=e.replace("@","");if(a in o||"@"+a in o)return this.setState({message:(0,i.\_\_)("Attribute already exists","attributes-for-blocks")}),void document.querySelector(`.wsd-afb-action-input#afb-${a} input[type="text"]`).focus();r({attributesForBlocks:Object.assign({[e]:void 0},o,{[e]:""})}),this.setState({adding:"",message:void 0})}removeAttribute(t){let{setAttributes:e}=this.props,{attributesForBlocks:r}=this.props.attributes,o=Object.assign({},r);delete o[t],e({attributesForBlocks:o})}updateAttribute(t,e){let{setAttributes:r}=this.props,{attributesForBlocks:o}=this.props.attributes;r({attributesForBlocks:Object.assign({},o,{[t]:e})})}toggleAttributeMode(t){let{setAttributes:e}=this.props,{attributesForBlocks:r}=this.props.attributes,o="@"===t.substring(0,1)?t.substring(1):"@"+t;e({attributesForBlocks:((t,e,r)=>{let o={[t]:e};return Object.keys(r).reduce(((e,a)=>(o[a]?e[o[a]]=r[t]:e[a]=r[a],e)),{})})(t,o,r)})}toggleStyleEditor(t){if(this.setState({styleEditor:!this.state.styleEditor}),t)return t.preventDefault(),!1}render(){const{adding:t,isFullscreen:e}=this.state,{attributesForBlocks:r}=this.props.attributes,a=(0,o.createElement)(u.BaseControl,{className:"wsd-afb"},(0,o.createElement)(u.\_\_experimentalVStack,{spacing:2},(0,o.createElement)("form",{className:"wsd-afb-action-input",onSubmit:this.addAttribute},!e&&(0,o.createElement)(u.Button,{className:"wsd-afb\_\_button-full-screen","aria-label":(0,i.\_\_)("Full screen","attributes-for-blocks"),icon:d,onClick:()=>this.setState({isFullscreen:!e})}),(0,o.createElement)(u.TextControl,{label:(0,i.\_\_)("Additional attributes","attributes-for-blocks"),placeholder:(0,i.\_\_)("Attribute name...","attributes-for-blocks"),value:t,onChange:t=>this.setState({adding:t,message:void 0})}),(0,o.createElement)(u.Button,{className:"wsd-afb\_\_button-add is-last",variant:"primary",type:"submit","aria-label":(0,i.\_\_)("Add attribute","attributes-for-blocks")},(0,i.\_\_)("Add","attributes-for-blocks")),(0,o.createElement)(p,null)),(0,o.createElement)("p",{className:"wsd-afb-message"},this.state.message||" "),r&&Object.keys(r).map((t=>{const e=t.replace("@",""),a="@"===t.substring(0,1),s="style"===e.toLowerCase()&&this.state.styleEditor?"style":"default";return(0,o.createElement)(n.Fragment,{key:t},(0,o.createElement)("div",{id:`afb-${e}`,className:"wsd-afb-action-input"},"style"===e.toLowerCase()&&(0,o.createElement)("div",{className:"wsd-afb-action-link"},(0,o.createElement)("a",{href:"#",role:"button",onClick:this.toggleStyleEditor},(0,i.\_\_)("Toggle editor","attributes-for-blocks"))),(0,o.createElement)(u.TextControl,{label:(0,o.createElement)(n.Fragment,null,(0,o.createElement)("strong",null,e),a&&" "+(0,i.\_\_)("(override)","attributes-for-blocks")),disabled:"style"===s,value:r[t],onChange:e=>this.updateAttribute(t,e)}),(0,o.createElement)(u.Button,{className:"button icon-button","aria-label":(0,i.\_\_)("Toggle between merge and override mode","attributes-for-blocks"),"aria-current":a?(0,i.\_\_)("Override","attributes-for-blocks"):(0,i.\_\_)("Merge","attributes-for-blocks"),onClick:()=>this.toggleAttributeMode(t)},(0,o.createElement)(u.Dashicon,{icon:"randomize"})),(0,o.createElement)(u.Button,{className:"button icon-button is-last","aria-label":(0,i.\_\_)("Remove attribute","attributes-for-blocks")+": "+e,onClick:()=>this.removeAttribute(t)},(0,o.createElement)(u.Dashicon,{icon:"no-alt"}))),"style"===s&&(0,o.createElement)(w,{value:r[t],onChange:e=>this.updateAttribute(t,e),toggleStyleEditor:this.toggleStyleEditor}))}))));return(0,o.createElement)(c.InspectorAdvancedControls,null,e&&(0,o.createElement)(u.Modal,{title:(0,i.\_\_)("Additional attributes","attributes-for-blocks"),onRequestClose:()=>this.setState({isFullscreen:!1}),className:"wsd-afb\_\_full-screen",size:"large"},(0,o.createElement)(u.\_\_experimentalView,{className:"wsd-afb\_\_full-screen\_\_content"},a)),!e&&a)}}const S=A,C=(0,a.applyFilters)("afb.defaultEnabled",!0),x=t=>{const e=t.name||t;return!window.afbData.unsupportedBlocks.includes(e)&&(0,s.hasBlockSupport)(t,"attributesForBlocks",C)},B={attributesForBlocks:{type:"object",default:{}}},F=(0,l.createHigherOrderComponent)((function(t){return function(e){return x(e.name)?(0,o.createElement)(n.Fragment,null,(0,o.createElement)(t,{...e}),(0,o.createElement)(S,{...e})):(0,o.createElement)(t,{...e})}}),"withAttributesForBlocksInspectorControls");(0,a.addFilter)("blocks.registerBlockType","attributes-for-blocks/attributes",(function(t){return x(t)&&(t.attributes=Object.assign(t.attributes||{},B)),t})),(0,a.addFilter)("editor.BlockEdit","attributes-for-blocks/inspector-controls",F),(0,a.addFilter)("blocks.getSaveContent.extraProps","attributes-for-blocks/extra-props",((t,e,r)=>{if(x(e)){let{attributesForBlocks:e}=r;e&&Object.keys(e).forEach((r=>{"@"===r.substring(0,1)?t[r.substring(1)]=e[r]:t[r]=function(t,e,r){if(!e)return r;let o=" ";if("style"===t)switch(typeof e){case"object":let t={};return r.trim().split(";").forEach((e=>{if(e&&e.includes(":")){let r=e.split(":");t[r[0].trim()]=r[1].trim()}})),{...e,...t};case"string":";"!==e.trim().substring(e.length-1,e.length)&&";"!==r.trim().substring(0,1)&&(o=";")}return o=(0,a.applyFilters)("afb.attribute.separator",o,t,e,r),[e,r].join(o)}(r,t[r],e[r])}))}return t}))},788:t=>{var e=/\/\\*[^\*]\*\\*+([^/\*][^\*]\*\\*+)\*\//g,r=/\n/g,o=/^\s\*/,a=/^(\\*?[-#/\*\\\w]+(\[[0-9a-z\_-]+\])?)\s\*/,s=/^:\s\*/,n=/^((?:'(?:\\'|.)\*?'|"(?:\\"|.)\*?"|\([^)]\*?\)|[^};])+)/,l=/^[;\s]\*/,i=/^\s+|\s+$/g,c="";function u(t){return t?t.replace(i,c):c}t.exports=function(t,i){if("string"!=typeof t)throw new TypeError("First argument must be a string");if(!t)return[];i=i||{};var b=1,d=1;function h(t){var e=t.match(r);e&&(b+=e.length);var o=t.lastIndexOf("\n");d=~o?t.length-o:d+t.length}function m(){var t={line:b,column:d};return function(e){return e.position=new p(t),\_(),e}}function p(t){this.start=t,this.end={line:b,column:d},this.source=i.source}p.prototype.content=t;var f=[];function k(e){var r=new Error(i.source+":"+b+":"+d+": "+e);if(r.reason=e,r.filename=i.source,r.line=b,r.column=d,r.source=t,!i.silent)throw r;f.push(r)}function g(e){var r=e.exec(t);if(r){var o=r[0];return h(o),t=t.slice(o.length),r}}function \_(){g(o)}function y(t){var e;for(t=t||[];e=v();)!1!==e&&t.push(e);return t}function v(){var e=m();if("/"==t.charAt(0)&&"\*"==t.charAt(1)){for(var r=2;c!=t.charAt(r)&&("\*"!=t.charAt(r)||"/"!=t.charAt(r+1));)++r;if(r+=2,c===t.charAt(r-1))return k("End of comment missing");var o=t.slice(2,r-2);return d+=2,h(o),t=t.slice(r),d+=2,e({type:"comment",comment:o})}}function E(){var t=m(),r=g(a);if(r){if(v(),!g(s))return k("property missing ':'");var o=g(n),i=t({type:"declaration",property:u(r[0].replace(e,c)),value:o?u(o[0].replace(e,c)):c});return g(l),i}}return \_(),function(){var t,e=[];for(y(e);t=E();)!1!==t&&(e.push(t),y(e));return e}()}},133:function(t,e,r){"use strict";var o=this&&this.\_\_importDefault||function(t){return t&&t.\_\_esModule?t:{default:t}};Object.defineProperty(e,"\_\_esModule",{value:!0});var a=o(r(788));e.default=function(t,e){var r=null;if(!t||"string"!=typeof t)return r;var o=(0,a.default)(t),s="function"==typeof e;return o.forEach((function(t){if("declaration"===t.type){var o=t.property,a=t.value;s?e(o,a,t):a&&((r=r||{})[o]=a)}})),r}}},r={};function o(t){var a=r[t];if(void 0!==a)return a.exports;var s=r[t]={exports:{}};return e[t].call(s.exports,s,s.exports,o),s.exports}o.m=e,t=[],o.O=(e,r,a,s)=>{if(!r){var n=1/0;for(u=0;u<t.length;u++){for(var[r,a,s]=t[u],l=!0,i=0;i<r.length;i++)(!1&s||n>=s)&&Object.keys(o.O).every((t=>o.O[t](r[i])))?r.splice(i--,1):(l=!1,s<n&&(n=s));if(l){t.splice(u--,1);var c=a();void 0!==c&&(e=c)}}return e}s=s||0;for(var u=t.length;u>0&&t[u-1][2]>s;u--)t[u]=t[u-1];t[u]=[r,a,s]},o.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{var t={57:0,350:0};o.O.j=e=>0===t[e];var e=(e,r)=>{var a,s,[n,l,i]=r,c=0;if(n.some((e=>0!==t[e]))){for(a in l)o.o(l,a)&&(o.m[a]=l[a]);if(i)var u=i(o)}for(e&&e(r);c<n.length;c++)s=n[c],o.o(t,s)&&t[s]&&t[s][0](),t[s]=0;return o.O(u)},r=globalThis.webpackChunkattributes\_for\_blocks=globalThis.webpackChunkattributes\_for\_blocks||[];r.forEach(e.bind(null,0)),r.push=e.bind(null,r.push.bind(r))})();var a=o.O(void 0,[350],(()=>o(674)));a=o.O(a~~)})(); |
  |  | 1 | (()=>{var t,e={947:(t,e,s)=>{"use strict";const r=window.wp.hooks,o=window.wp.blocks,i=window.wp.element,a=window.wp.compose,n=window.wp.i18n,l=window.wp.blockEditor,c=window.wp.components,d=window.wp.data,u=window.wp.editor,b=window.wp.primitives,h=window.ReactJSXRuntime,p=(0,h.jsx)(b.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,h.jsx)(b.Path,{d:"M6 4a2 2 0 0 0-2 2v3h1.5V6a.5.5 0 0 1 .5-.5h3V4H6Zm3 14.5H6a.5.5 0 0 1-.5-.5v-3H4v3a2 2 0 0 0 2 2h3v-1.5Zm6 1.5v-1.5h3a.5.5 0 0 0 .5-.5v-3H20v3a2 2 0 0 1-2 2h-3Zm3-16a2 2 0 0 1 2 2v3h-1.5V6a.5.5 0 0 0-.5-.5h-3V4h3Z"})}),f=(0,h.jsx)(b.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,h.jsx)(b.Path,{d:"M12 4.75a7.25 7.25 0 100 14.5 7.25 7.25 0 000-14.5zM3.25 12a8.75 8.75 0 1117.5 0 8.75 8.75 0 01-17.5 0zM12 8.75a1.5 1.5 0 01.167 2.99c-.465.052-.917.44-.917 1.01V14h1.5v-.845A3 3 0 109 10.25h1.5a1.5 1.5 0 011.5-1.5zM11.25 15v1.5h1.5V15h-1.5z"})}),k=({children:t,as:e="div",...s})=>(0,i.createElement)(e,{dangerouslySetInnerHTML:{\_\_html:t},...s}),m=()=>{const[t,e]=(0,i.useState)(!1);return(0,h.jsxs)(i.Fragment,{children:[(0,h.jsx)(c.Button,{variant:"secondary",className:"wsd-afb\_\_button-help","aria-label":(0,n.\_\_)("Show Attributes for Blocks help","attributes-for-blocks"),onClick:()=>e(!0),icon:f}),t&&(0,h.jsx)(c.Modal,{title:(0,n.\_\_)("Attributes for Blocks help","attributes-for-blocks"),onRequestClose:()=>e(!1),className:"wsd-afb\_\_help",style:{maxWidth:720},children:(0,h.jsxs)("div",{className:"wsd-afb\_\_help\_\_content",children:[(0,h.jsx)("h3",{children:(0,n.\_\_)("How do I add an attribute?","attributes-for-blocks")}),(0,h.jsx)("p",{children:(0,n.\_\_)('Type an attribute name into the "Add attribute" field and press "Add" to add an attribute for the block. A new input with the attribute\'s name should appear below, into which you can optionally insert the attribute value.',"attributes-for-blocks")}),(0,h.jsx)(k,{as:"p",children:`\n\t\t\t\t\t\t\t${(0,n.\_\_)("Example attributes: ","attributes-for-blocks")}\n\t\t\t\t\t\t\t<code>style</code>,\n\t\t\t\t\t\t\t<code>title</code>,\n\t\t\t\t\t\t\t<code>target</code>,\n\t\t\t\t\t\t\t<code>class</code>,\n\t\t\t\t\t\t\t<code>id</code>,\n\t\t\t\t\t\t\t<code>onClick</code>,\n\t\t\t\t\t\t\t<code>data-\*</code>,\n\t\t\t\t\t\t\t<code>aria-\*</code>.\n\t\t\t\t\t\t`}),(0,h.jsx)("h3",{children:(0,n.\_\_)("Why is the input disabled?","attributes-for-blocks")}),(0,h.jsx)(k,{as:"p",children:`\n\t\t\t\t\t\t\t${(0,n.\_\_)("When the current user doesn't have `unfiltered\_html` capabilities attributes cannot be added and all existing attributes are stripped when the post is updated.","attributes-for-blocks")}\n\t\t\t\t\t\t`}),(0,h.jsx)("h3",{children:(0,n.\_\_)("How does it work?","attributes-for-blocks")}),(0,h.jsx)(k,{as:"p",children:`\n\t\t\t\t\t\t\t${(0,n.\_\_)("For regular blocks, attributes are added to the block save content's root element, meaning they will be rendered only on the front end and not in the editor. For dynamic blocks the attributes are added via `render\_callback` function and they may also be applied in the editor, depending if the block is rendered server or client side.","attributes-for-blocks")}\n\t\t\t\t\t\t`}),(0,h.jsx)("h3",{children:(0,n.\_\_)("Does it work for every block?","attributes-for-blocks")}),(0,h.jsx)(k,{as:"p",children:`\n\t\t\t\t\t\t\t${(0,n.\_\_)("It should work with normal blocks that render a valid WP Element that can utilize the `blocks.getSaveContent.extraProps` filter as well as dynamic blocks that utilize a `render\_callback`. Third party blocks that do something unorthodox may not work.","attributes-for-blocks")}\n\t\t\t\t\t\t`}),(0,h.jsx)("h3",{children:(0,n.\_\_)("Modes","attributes-for-blocks")}),(0,h.jsx)("p",{children:(0,n.\_\_)("You can change between modes by clicking the button next to the input where the attribute value is specified.","attributes-for-blocks")}),(0,h.jsx)("h4",{children:(0,n.\_\_)("Merge mode (default)","attributes-for-blocks")}),(0,h.jsx)("p",{children:(0,n.\_\_)("In merge mode, when a block has already defined the attribute you're trying to add, the values are merged.","attributes-for-blocks")}),(0,h.jsx)("h4",{children:(0,n.\_\_)("Override mode","attributes-for-blocks")}),(0,h.jsx)("p",{children:(0,n.\_\_)("In override mode, when a block has already defined the attribute you're trying to add, the value is completely replaced with the provided value. You can switch between modes by clicking the intersecting arrows button next to the attribute input.","attributes-for-blocks")}),(0,h.jsx)("h3",{children:(0,n.\_\_)("What happens when I disable this plugin?","attributes-for-blocks")}),(0,h.jsx)("p",{children:(0,n.\_\_)('Blocks with custom attributes may become invalid, depending on which attributes you\'ve added. From there you can recover the block without the custom attributes by clicking "Attempt Block Recovery" or keep the block with custom attributes as HTML by choosing "Convert to HTML". If you don\'t want to risk blocks becoming invalid you need to remove all custom attributes before disabling the plugin.',"attributes-for-blocks")}),(0,h.jsx)("h3",{children:(0,n.\_\_)("Common attributes","attributes-for-blocks")}),(0,h.jsx)("h4",{children:(0,n.\_\_)("Style attribute","attributes-for-blocks")}),(0,h.jsx)(k,{as:"p",children:`\n\t\t\t\t\t\t\t${(0,n.\_\_)("Inline styles can be defined as text.","attributes-for-blocks")}\n\t\t\t\t\t\t\t${(0,n.\_\_)("Example:","attributes-for-blocks")} <code>color:red;font-weight:bold</code><br>\n\t\t\t\t\t\t\t${(0,n.\_\_)("Spaces are allowed, leading or trailing semicolons are not needed.","attributes-for-blocks")}<br>\n\t\t\t\t\t\t\t${(0,n.\_\_)("Styles are not rendered in the block editor.","attributes-for-blocks")}\n\t\t\t\t\t\t`}),(0,h.jsx)("h5",{children:(0,n.\_\_)("Advanced editor","attributes-for-blocks")}),(0,h.jsx)(k,{as:"p",children:`\n\t\t\t\t\t\t\t${(0,n.\_\_)('Style attribute can be edited with an advanced editor by clicking "Toggle editor".',"attributes-for-blocks")}\n\t\t\t\t\t\t`}),(0,h.jsx)("h4",{children:(0,n.\_\_)("ID attribute","attributes-for-blocks")}),(0,h.jsx)("p",{children:(0,n.\_\_)('If the block supports it, you should use the built-in "HTML anchor" feature instead.',"attributes-for-blocks")}),(0,h.jsx)("h4",{children:(0,n.\_\_)("Class attribute","attributes-for-blocks")}),(0,h.jsx)("p",{children:(0,n.\_\_)('HTML class attribute can be defined with the regular "class" or React\'s "className" attribute (non-dynamic blocks). Results (merging/overriding) may vary depending on the block. If the block supports it, you should use the built-in "Additional CSS Class" feature instead.',"attributes-for-blocks")})]})})]})};window.React;var \_=s(676);const g=\_.default||\_,y="-afb-placeholder",w="-afb-space",v=({toggleStyleEditor:t,resetStyles:e})=>(0,h.jsxs)("p",{style:{marginBottom:0},children:[(0,h.jsx)("span",{style:{color:"red"},children:(0,n.\_\_)("Unable to parse styles.","attributes-for-blocks")})," ",(0,h.jsx)("a",{href:"#",onClick:t,children:(0,n.\_\_)("Edit","attributes-for-blocks")}),` ${(0,n.\_\_)("or","attributes-for-blocks")} `,(0,h.jsx)("a",{href:"#",onClick:e,children:(0,n.\_\_)("Clear value","attributes-for-blocks")})]}),x=t=>t.replaceAll(":","").replaceAll(";",""),j=(t,e=!0)=>{const s=()=>{const e=document.querySelector(t);null!==e&&e.focus()};e?setTimeout(s,50):s()},A=({value:t,onChange:e,toggleStyleEditor:s})=>{const[r,o]=(0,i.useState)(!1);let a;try{a=g(t)}catch(t){const r=t=>(t.preventDefault(),e(""),!1);return(0,h.jsx)(v,{toggleStyleEditor:s,resetStyles:r})}a||(a={[y]:y});const l=s=>{const r=Object.keys(s).map((t=>""===t?y:t)).map((t=>{let e=s[t]||y;return" "===e[e.length-1]&&(e=e.slice(0,-1)+w),`${t}: ${e};`})).join(" ");t!==r&&e(r)},d=Object.keys(a);return(0,h.jsx)(h.Fragment,{children:d.map(((t,e)=>{const s=0===e,i=e+1===d.length,u=1===d.length,b=t===y&&a[t]===y;return(0,h.jsxs)("div",{className:"wsd-afb-action-input wsd-afb-style","data-index":e,"data-is-blank":b,children:[(0,h.jsx)(c.TextControl,{placeholder:(0,n.\_\_)("Property...","attributes-for-blocks"),value:t===y?"":t,onChange:e=>{""!==e&&d.includes(e)&&(e=`${e}-`,o(!0)),l(d.reduce(((s,r)=>(r===t?s[x(e)]=a[r]:s[r]=a[r],s)),{}))},onKeyDown:t=>{r&&("-"===t.key&&(t.preventDefault(),t.stopPropagation()),o(!1))},onKeyUp:t=>{"Enter"===t.key&&j(`.wsd-afb-style[data-index="${e}"] .components-base-control + .components-base-control input[type="text"]`,!1)}}),(0,h.jsx)(c.TextControl,{placeholder:(0,n.\_\_)("Value...","attributes-for-blocks"),value:a[t]===y?"":a[t].replace(w," "),onChange:e=>{l({...a,[t]:x(e)})},onBlur:()=>{a[t].includes(w)&&l({...a,[t]:a[t].replace(w,"")})},onKeyUp:t=>{if("Enter"===t.code){const t=i&&!a.hasOwnProperty(y);t&&l({...a,[y]:y}),j(`.wsd-afb-style[data-index="${e+1}"] input[type="text"]`,t)}}}),(0,h.jsxs)("div",{className:"wsd-afb-button-group",children:[(0,h.jsx)(c.Button,{className:"button icon-button","aria-label":(0,n.\_\_)("Move up","attributes-for-blocks"),disabled:s,onClick:()=>l(d.filter((e=>e!==t)).reduce(((s,r,o)=>(o===e-1&&(s[t]=a[t]),s[r]=a[r],s)),{})),children:(0,h.jsx)(c.Dashicon,{icon:"arrow-up"})}),(0,h.jsx)(c.Button,{className:"button icon-button is-top-right","aria-label":(0,n.\_\_)("Remove rule","attributes-for-blocks"),disabled:u&&b,onClick:()=>{const{[t]:e,...s}=a;l({...s,...u&&{[y]:y}})},children:(0,h.jsx)(c.Dashicon,{icon:"no"})}),(0,h.jsx)(c.Button,{className:"button icon-button","aria-label":(0,n.\_\_)("Move down","attributes-for-blocks"),disabled:i,onClick:()=>l(d.filter((e=>e!==t)).reduce(((s,r,o)=>(s[r]=a[r],o===e&&(s[t]=a[t]),s)),{})),children:(0,h.jsx)(c.Dashicon,{icon:"arrow-down"})}),(0,h.jsx)(c.Button,{className:"button icon-button is-bottom-right","aria-label":(0,n.\_\_)("Add rule","attributes-for-blocks"),disabled:t===y,onClick:()=>{if(i){const{[y]:t,...e}=a;l({...e,[y]:y})}else l(d.reduce(((t,s,r)=>(s===y||(t[s]=a[s],r===e&&(t[y]=y)),t)),{}));j('.wsd-afb-style[data-is-blank="true"] input[type="text"]')},children:(0,h.jsx)(c.Dashicon,{icon:"plus"})})]})]},`rule-${e}`)}))})};class S extends i.Component{constructor(){super(...arguments),this.state={adding:"",message:void 0,styleEditor:JSON.parse(localStorage.getItem("attributesForBlocks/styleEditor"))||!1,isFullscreen:!1},this.addAttribute=this.addAttribute.bind(this),this.removeAttribute=this.removeAttribute.bind(this),this.toggleAttributeMode=this.toggleAttributeMode.bind(this),this.toggleStyleEditor=this.toggleStyleEditor.bind(this)}componentDidUpdate(t,e){e.adding&&!this.state.adding&&setTimeout((()=>{"style"===e.adding&&this.state.styleEditor?document.querySelector('.wsd-afb-style input[type="text"]')?.focus():document.querySelector(`.wsd-afb-action-input#afb-${e.adding} input[type="text"]`)?.focus()}),150),e.styleEditor!==this.state.styleEditor&&localStorage.setItem("attributesForBlocks/styleEditor",this.state.styleEditor)}addAttribute(t){t.preventDefault();let{adding:e}=this.state;if(!e)return void this.setState({message:(0,n.\_\_)("No attribute name specified.","attributes-for-blocks")});let{setAttributes:s}=this.props,{attributesForBlocks:r}=this.props.attributes;if(!r)return void this.setState({message:(0,n.\_\_)("Unable to add attributes to block.","attributes-for-blocks")});let o=e.replace("@","");if(o in r||"@"+o in r)return this.setState({message:(0,n.\_\_)("Attribute already exists","attributes-for-blocks")}),void document.querySelector(`.wsd-afb-action-input#afb-${o} input[type="text"]`).focus();s({attributesForBlocks:Object.assign({[e]:void 0},r,{[e]:""})}),this.setState({adding:"",message:void 0})}removeAttribute(t){let{setAttributes:e}=this.props,{attributesForBlocks:s}=this.props.attributes,r=Object.assign({},s);delete r[t],e({attributesForBlocks:r})}updateAttribute(t,e){let{setAttributes:s}=this.props,{attributesForBlocks:r}=this.props.attributes;s({attributesForBlocks:Object.assign({},r,{[t]:e})})}toggleAttributeMode(t){let{setAttributes:e}=this.props,{attributesForBlocks:s}=this.props.attributes,r="@"===t.substring(0,1)?t.substring(1):"@"+t;e({attributesForBlocks:((t,e,s)=>{let r={[t]:e};return Object.keys(s).reduce(((e,o)=>(r[o]?e[r[o]]=s[t]:e[o]=s[o],e)),{})})(t,r,s)})}toggleStyleEditor(t){if(this.setState({styleEditor:!this.state.styleEditor}),t)return t.preventDefault(),!1}render(){const{adding:t,isFullscreen:e}=this.state,{attributesForBlocks:s}=this.props.attributes,r=(0,h.jsx)(c.BaseControl,{className:"wsd-afb",children:(0,h.jsxs)(c.\_\_experimentalVStack,{spacing:2,children:[(0,h.jsxs)("form",{className:"wsd-afb-action-input",onSubmit:this.addAttribute,children:[!e&&(0,h.jsx)(c.Button,{className:"wsd-afb\_\_button-full-screen","aria-label":(0,n.\_\_)("Full screen","attributes-for-blocks"),icon:p,onClick:()=>this.setState({isFullscreen:!e})}),(0,h.jsx)(c.TextControl,{label:(0,n.\_\_)("Additional attributes","attributes-for-blocks"),placeholder:(0,n.\_\_)("Attribute name...","attributes-for-blocks"),value:t,onChange:t=>this.setState({adding:t,message:void 0}),disabled:!this.props.canUserUseUnfilteredHTML}),(0,h.jsx)(c.Button,{className:"wsd-afb\_\_button-add is-last",variant:"primary",type:"submit","aria-label":(0,n.\_\_)("Add attribute","attributes-for-blocks"),disabled:!this.props.canUserUseUnfilteredHTML,children:(0,n.\_\_)("Add","attributes-for-blocks")}),(0,h.jsx)(m,{})]}),(0,h.jsx)("p",{className:"wsd-afb-message",children:this.state.message||" "}),s&&Object.keys(s).map((t=>{const e=t.replace("@",""),r="@"===t.substring(0,1),o="style"===e.toLowerCase()&&this.state.styleEditor?"style":"default";return(0,h.jsxs)(i.Fragment,{children:[(0,h.jsxs)("div",{id:`afb-${e}`,className:"wsd-afb-action-input",children:["style"===e.toLowerCase()&&this.props.canUserUseUnfilteredHTML&&(0,h.jsx)("div",{className:"wsd-afb-action-link",children:(0,h.jsx)("a",{href:"#",role:"button",onClick:this.toggleStyleEditor,children:(0,n.\_\_)("Toggle editor","attributes-for-blocks")})}),(0,h.jsx)(c.TextControl,{label:(0,h.jsxs)(i.Fragment,{children:[(0,h.jsx)("strong",{children:e}),r&&" "+(0,n.\_\_)("(override)","attributes-for-blocks")]}),disabled:"style"===o||!this.props.canUserUseUnfilteredHTML,value:s[t],onChange:e=>this.updateAttribute(t,e)}),(0,h.jsx)(c.Button,{className:"button icon-button","aria-label":(0,n.\_\_)("Toggle between merge and override mode","attributes-for-blocks"),"aria-current":r?(0,n.\_\_)("Override","attributes-for-blocks"):(0,n.\_\_)("Merge","attributes-for-blocks"),onClick:()=>this.toggleAttributeMode(t),disabled:!this.props.canUserUseUnfilteredHTML,children:(0,h.jsx)(c.Dashicon,{icon:"randomize"})}),(0,h.jsx)(c.Button,{className:"button icon-button is-last","aria-label":(0,n.\_\_)("Remove attribute","attributes-for-blocks")+": "+e,onClick:()=>this.removeAttribute(t),disabled:!this.props.canUserUseUnfilteredHTML,children:(0,h.jsx)(c.Dashicon,{icon:"no-alt"})})]}),"style"===o&&this.props.canUserUseUnfilteredHTML&&(0,h.jsx)(A,{value:s[t],onChange:e=>this.updateAttribute(t,e),toggleStyleEditor:this.toggleStyleEditor})]},t)}))]})});return(0,h.jsxs)(l.InspectorAdvancedControls,{children:[e&&(0,h.jsx)(c.Modal,{title:(0,n.\_\_)("Additional attributes","attributes-for-blocks"),onRequestClose:()=>this.setState({isFullscreen:!1}),className:"wsd-afb\_\_full-screen",size:"large",children:(0,h.jsx)(c.\_\_experimentalView,{className:"wsd-afb\_\_full-screen\_\_content",children:r})}),!e&&r]})}}const C=(0,a.compose)([(0,d.withSelect)((t=>{const{canUserUseUnfilteredHTML:e}=t(u.store);return{canUserUseUnfilteredHTML:e()}}))])(S),B=(0,r.applyFilters)("afb.defaultEnabled",!0),E=t=>{const e=t.name||t;return!window.afbData.unsupportedBlocks.includes(e)&&(0,o.hasBlockSupport)(t,"attributesForBlocks",B)},F={attributesForBlocks:{type:"object",default:{}}},M=(0,a.createHigherOrderComponent)((function(t){return function(e){return E(e.name)?(0,h.jsxs)(i.Fragment,{children:[(0,h.jsx)(t,{...e}),(0,h.jsx)(C,{...e})]}):(0,h.jsx)(t,{...e})}}),"withAttributesForBlocksInspectorControls");(0,r.addFilter)("blocks.registerBlockType","attributes-for-blocks/attributes",(function(t){return E(t)&&(t.attributes=Object.assign(t.attributes||{},F)),t})),(0,r.addFilter)("editor.BlockEdit","attributes-for-blocks/inspector-controls",M),(0,r.addFilter)("blocks.getSaveContent.extraProps","attributes-for-blocks/extra-props",((t,e,s)=>{if(E(e)){let{attributesForBlocks:e}=s;e&&Object.keys(e).forEach((s=>{"@"===s.substring(0,1)?t[s.substring(1)]=e[s]:t[s]=function(t,e,s){if(!e)return s;let o=" ";if("style"===t)switch(typeof e){case"object":let t={};return s.trim().split(";").forEach((e=>{if(e&&e.includes(":")){let s=e.split(":");t[s[0].trim()]=s[1].trim()}})),{...e,...t};case"string":";"!==e.trim().substring(e.length-1,e.length)&&";"!==s.trim().substring(0,1)&&(o=";")}return o=(0,r.applyFilters)("afb.attribute.separator",o,t,e,s),[e,s].join(o)}(s,t[s],e[s])}))}return t}))},90:t=>{var e=/\/\\*[^\*]\*\\*+([^/\*][^\*]\*\\*+)\*\//g,s=/\n/g,r=/^\s\*/,o=/^(\\*?[-#/\*\\\w]+(\[[0-9a-z\_-]+\])?)\s\*/,i=/^:\s\*/,a=/^((?:'(?:\\'|.)\*?'|"(?:\\"|.)\*?"|\([^)]\*?\)|[^};])+)/,n=/^[;\s]\*/,l=/^\s+|\s+$/g,c="";function d(t){return t?t.replace(l,c):c}t.exports=function(t,l){if("string"!=typeof t)throw new TypeError("First argument must be a string");if(!t)return[];l=l||{};var u=1,b=1;function h(t){var e=t.match(s);e&&(u+=e.length);var r=t.lastIndexOf("\n");b=~r?t.length-r:b+t.length}function p(){var t={line:u,column:b};return function(e){return e.position=new f(t),g(),e}}function f(t){this.start=t,this.end={line:u,column:b},this.source=l.source}f.prototype.content=t;var k=[];function m(e){var s=new Error(l.source+":"+u+":"+b+": "+e);if(s.reason=e,s.filename=l.source,s.line=u,s.column=b,s.source=t,!l.silent)throw s;k.push(s)}function \_(e){var s=e.exec(t);if(s){var r=s[0];return h(r),t=t.slice(r.length),s}}function g(){\_(r)}function y(t){var e;for(t=t||[];e=w();)!1!==e&&t.push(e);return t}function w(){var e=p();if("/"==t.charAt(0)&&"\*"==t.charAt(1)){for(var s=2;c!=t.charAt(s)&&("\*"!=t.charAt(s)||"/"!=t.charAt(s+1));)++s;if(s+=2,c===t.charAt(s-1))return m("End of comment missing");var r=t.slice(2,s-2);return b+=2,h(r),t=t.slice(s),b+=2,e({type:"comment",comment:r})}}function v(){var t=p(),s=\_(o);if(s){if(w(),!\_(i))return m("property missing ':'");var r=\_(a),l=t({type:"declaration",property:d(s[0].replace(e,c)),value:r?d(r[0].replace(e,c)):c});return \_(n),l}}return g(),function(){var t,e=[];for(y(e);t=v();)!1!==t&&(e.push(t),y(e));return e}()}},676:function(t,e,s){"use strict";var r=this&&this.\_\_importDefault||function(t){return t&&t.\_\_esModule?t:{default:t}};Object.defineProperty(e,"\_\_esModule",{value:!0}),e.default=function(t,e){var s=null;if(!t||"string"!=typeof t)return s;var r=(0,o.default)(t),i="function"==typeof e;return r.forEach((function(t){if("declaration"===t.type){var r=t.property,o=t.value;i?e(r,o,t):o&&((s=s||{})[r]=o)}})),s};var o=r(s(90))}},s={};function r(t){var o=s[t];if(void 0!==o)return o.exports;var i=s[t]={exports:{}};return e[t].call(i.exports,i,i.exports,r),i.exports}r.m=e,t=[],r.O=(e,s,o,i)=>{if(!s){var a=1/0;for(d=0;d<t.length;d++){s=t[d][0],o=t[d][1],i=t[d][2];for(var n=!0,l=0;l<s.length;l++)(!1&i||a>=i)&&Object.keys(r.O).every((t=>r.O[t](s[l])))?s.splice(l--,1):(n=!1,i<a&&(a=i));if(n){t.splice(d--,1);var c=o();void 0!==c&&(e=c)}}return e}i=i||0;for(var d=t.length;d>0&&t[d-1][2]>i;d--)t[d]=t[d-1];t[d]=[s,o,i]},r.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{var t={57:0,350:0};r.O.j=e=>0===t[e];var e=(e,s)=>{var o,i,a=s[0],n=s[1],l=s[2],c=0;if(a.some((e=>0!==t[e]))){for(o in n)r.o(n,o)&&(r.m[o]=n[o]);if(l)var d=l(r)}for(e&&e(s);c<a.length;c++)i=a[c],r.o(t,i)&&t[i]&&t[i][0](),t[i]=0;return r.O(d)},s=self.webpackChunkattributes\_for\_blocks=self.webpackChunkattributes\_for\_blocks||[];s.forEach(e.bind(null,0)),s.push=e.bind(null,s.push.bind(s))})();var o=r.O(void 0,[350],(()=>r(947)));o=r.O(o)})(); |
* ## [attributes-for-blocks/trunk/build/style-index.css](/changeset/3144730/attributes-for-blocks/trunk/build/style-index.css?old=2939299&old_path=attributes-for-blocks%2Ftrunk%2Fbuild%2Fstyle-index.css "Show the [3066420:3144730] differences restricted to attributes-for-blocks/trunk/build/style-index.css")

  | [r3066420](/browser/attributes-for-blocks/trunk/build/style-index.css?rev=2939299#L1 "Show revision 3066420 of this file in browser") | [r3144730](/browser/attributes-for-blocks/trunk/build/style-index.css?rev=3144730#L1 "Show revision 3144730 of this file in browser") |  |
  | --- | --- | --- |
  | 1 |  | .wsd-afb .wsd-afb-action-input{align-items:flex-end;display:flex;flex-direction:row;margin-bottom:8px;position:relative}.wsd-afb .wsd-afb-action-input>.components-base-control{flex-grow:1;margin:0}.wsd-afb .wsd-afb-action-input>.components-base-control .components-base-control\_\_field{margin:0}.wsd-afb .wsd-afb-action-input>.components-base-control .components-base-control\_\_field .components-text-control\_\_input{border-bottom-right-radius:0;border-right:0;border-top-right-radius:0;height:32px;margin:0;min-height:32px}.wsd-afb .wsd-afb-action-input>.components-base-control .components-base-control\_\_field .components-text-control\_\_input[disabled]{cursor:not-allowed}.wsd-afb .wsd-afb-action-input>.components-base-control+.components-base-control .components-text-control\_\_input{border-bottom-left-radius:0;border-top-left-radius:0}.wsd-afb .wsd-afb-action-input>button{border-radius:0;border-right-width:0;box-shadow:none;display:flex;height:32px;margin:0;min-height:32px~~}.wsd-afb .wsd-afb-action-input>button.wsd-afb\_\_button-help{border-bottom:1px solid #757575;border-top:1px solid #757575}.wsd-afb .wsd-afb-action-input>button.wsd-afb\_\_button-help:hover{box-shadow:none}.wsd-afb .wsd-afb-action-input>button.wsd-afb\_\_button-add{order:1}.wsd-afb .wsd-afb-action-input>button.wsd-afb\_\_button-add:focus{background-color:var(--wp-admin-theme-color-darker-10);box-shadow:0 0 0 var(--wp-admin-border-width-focus) var(--wp-admin-theme-color);color:#fff}.wsd-afb .wsd-afb-action-input>button.wsd-afb\_\_button-add:active{color:#fff}.wsd-afb .wsd-afb-action-input>button.wsd-afb\_\_button-full-screen{height:18px;margin:0;min-height:auto;min-width:auto;padding:0;position:absolute;right:0;top:0;width:18px}.wsd-afb .wsd-afb-action-input>button.icon-button{padding:6px}.wsd-afb .wsd-afb-action-input>button.is-last{border-bottom-right-radius:2px;border-right-width:1px;border-top-right-radius:2px}.wsd-afb .wsd-afb-action-input>button:hover~button{border-left-color:var(--wp-admin-theme-color-darker-10)~~}.wsd-afb .wsd-afb-action-input:last-child{margin-bottom:0}.wsd-afb .wsd-afb-action-input:focus-within .components-text-control\_\_input{border-color:var(--wp-admin-theme-color);box-shadow:none}.wsd-afb .wsd-afb-action-input:focus-within button{border-bottom-color:var(--wp-admin-theme-color);border-top-color:var(--wp-admin-theme-color)}.wsd-afb .wsd-afb-action-input:focus-within button:last-child{border-right-color:var(--wp-admin-theme-color)}.wsd-afb .wsd-afb-action-input>.wsd-afb-button-group{border:1px solid var(--wp-admin-theme-color);border-radius:0;border-bottom-right-radius:2px;border-top-right-radius:2px;box-shadow:none;display:flex;flex-wrap:wrap;height:32px;margin:0;min-width:34px;padding:0;width:34px}.wsd-afb .wsd-afb-action-input>.wsd-afb-button-group>button{border:0;border-radius:0;height:15px;min-height:auto;overflow:hidden!important;padding:0;width:16px}.wsd-afb .wsd-afb-action-input>.wsd-afb-button-group>button>.dashicon{font-size:14px;height:14px;width:14px}.wsd-afb .wsd-afb-action-input>.wsd-afb-button-group>button.is-top-right{border-top-right-radius:2px}.wsd-afb .wsd-afb-action-input>.wsd-afb-button-group>button.is-bottom-right{border-bottom-right-radius:2px}.wsd-afb .wsd-afb-action-input:not(form),.wsd-afb form.wsd-afb-action-input{margin-bottom:0}.wsd-afb .wsd-afb-action-input:not(form) .components-base-control\_\_label{font-size:12px;margin-bottom:2px;text-transform:none}.wsd-afb .wsd-afb-action-input:not(form) input.components-text-control\_\_input{font-family:Menlo,Consolas,Monaco,Liberation Mono,Lucida Console,monospace}.wsd-afb .wsd-afb-action-input:not(form) input.components-text-control\_\_input::-moz-placeholder{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif}.wsd-afb .wsd-afb-action-input:not(form) input.components-text-control\_\_input::placeholder{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif}.wsd-afb .wsd-afb-message{color:red;font-size:12px;margin:-8px 0!important}.wsd-afb .wsd-afb-action-link{align-self:flex-start;justify-self:flex-start;position:absolute;right:0}.wsd-afb .wsd-afb-action-link>a{font-size:12px}.wsd-afb\_\_help\_\_content :is(h2,h3,h4,h5,h6){margin-bottom:0}.wsd-afb\_\_help\_\_content :is(h2,h3,h4,h5,h6):first-child{margin-top:0}.wsd-afb\_\_full-screen\_\_content>.components-base-control>.components-base-control\_\_field:last-child{margin-bottom:0}.wsd-afb\_\_full-screen\_\_content form.wsd-afb-action-input .components-base-control\_\_field>.components-base-control\_\_label{display:none} |
  |  | 1 | .wsd-afb .wsd-afb-action-input{align-items:flex-end;display:flex;flex-direction:row;margin-bottom:8px;position:relative}.wsd-afb .wsd-afb-action-input>.components-base-control{flex-grow:1;margin:0}.wsd-afb .wsd-afb-action-input>.components-base-control .components-base-control\_\_field{margin:0}.wsd-afb .wsd-afb-action-input>.components-base-control .components-base-control\_\_field .components-text-control\_\_input{border-bottom-right-radius:0;border-right:0;border-top-right-radius:0;height:32px;margin:0;min-height:32px}.wsd-afb .wsd-afb-action-input>.components-base-control .components-base-control\_\_field .components-text-control\_\_input[disabled]{cursor:not-allowed}.wsd-afb .wsd-afb-action-input>.components-base-control+.components-base-control .components-text-control\_\_input{border-bottom-left-radius:0;border-top-left-radius:0}.wsd-afb .wsd-afb-action-input>button{border-radius:0;border-right-width:0;box-shadow:none;display:flex;height:32px;margin:0;min-height:32px;-webkit-user-select:none;-moz-user-select:none;user-select:none}.wsd-afb .wsd-afb-action-input>button.wsd-afb\_\_button-help{border-bottom:1px solid #949494;border-top:1px solid #949494}.wsd-afb .wsd-afb-action-input>button.wsd-afb\_\_button-help:hover{box-shadow:none}.wsd-afb .wsd-afb-action-input>button.wsd-afb\_\_button-add{order:1}.wsd-afb .wsd-afb-action-input>button.wsd-afb\_\_button-add:focus{background-color:var(--wp-admin-theme-color-darker-10);box-shadow:0 0 0 var(--wp-admin-border-width-focus) var(--wp-admin-theme-color);color:#fff}.wsd-afb .wsd-afb-action-input>button.wsd-afb\_\_button-add:active{color:#fff}.wsd-afb .wsd-afb-action-input>button.wsd-afb\_\_button-full-screen{height:18px;margin:0;min-height:auto;min-width:auto;padding:0;position:absolute;right:0;top:0;width:18px}.wsd-afb .wsd-afb-action-input>button.icon-button{padding:6px}.wsd-afb .wsd-afb-action-input>button.is-last{border-bottom-right-radius:2px;border-right-width:1px;border-top-right-radius:2px}.wsd-afb .wsd-afb-action-input>button:hover~button{border-left-color:var(--wp-admin-theme-color-darker-10)}.wsd-afb .wsd-afb-action-input>button[disabled]{pointer-events:none}.wsd-afb .wsd-afb-action-input:last-child{margin-bottom:0}.wsd-afb .wsd-afb-action-input:focus-within .components-text-control\_\_input{border-color:var(--wp-admin-theme-color);box-shadow:none}.wsd-afb .wsd-afb-action-input:focus-within button{border-bottom-color:var(--wp-admin-theme-color);border-top-color:var(--wp-admin-theme-color)}.wsd-afb .wsd-afb-action-input:focus-within button:last-child{border-right-color:var(--wp-admin-theme-color)}.wsd-afb .wsd-afb-action-input>.wsd-afb-button-group{border:1px solid var(--wp-admin-theme-color);border-radius:0;border-bottom-right-radius:2px;border-top-right-radius:2px;box-shadow:none;display:flex;flex-wrap:wrap;height:32px;margin:0;min-width:34px;padding:0;width:34px}.wsd-afb .wsd-afb-action-input>.wsd-afb-button-group>button{border:0;border-radius:0;height:15px;min-height:auto;overflow:hidden!important;padding:0;width:16px}.wsd-afb .wsd-afb-action-input>.wsd-afb-button-group>button>.dashicon{font-size:14px;height:14px;width:14px}.wsd-afb .wsd-afb-action-input>.wsd-afb-button-group>button.is-top-right{border-top-right-radius:2px}.wsd-afb .wsd-afb-action-input>.wsd-afb-button-group>button.is-bottom-right{border-bottom-right-radius:2px}.wsd-afb .wsd-afb-action-input:not(form),.wsd-afb form.wsd-afb-action-input{margin-bottom:0}.wsd-afb .wsd-afb-action-input:not(form) .components-base-control\_\_label{font-size:12px;margin-bottom:2px;text-transform:none}.wsd-afb .wsd-afb-action-input:not(form) input.components-text-control\_\_input{font-family:Menlo,Consolas,Monaco,Liberation Mono,Lucida Console,monospace}.wsd-afb .wsd-afb-action-input:not(form) input.components-text-control\_\_input::-moz-placeholder{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif}.wsd-afb .wsd-afb-action-input:not(form) input.components-text-control\_\_input::placeholder{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif}.wsd-afb .wsd-afb-message{color:red;font-size:12px;margin:-8px 0!important}.wsd-afb .wsd-afb-action-link{align-self:flex-start;justify-self:flex-start;position:absolute;right:0}.wsd-afb .wsd-afb-action-link>a{font-size:12px}.wsd-afb\_\_help\_\_content :is(h2,h3,h4,h5,h6){margin-bottom:0}.wsd-afb\_\_help\_\_content :is(h2,h3,h4,h5,h6):first-child{margin-top:0}.wsd-afb\_\_full-screen\_\_content>.components-base-control>.components-base-control\_\_field:last-child{margin-bottom:0}.wsd-afb\_\_full-screen\_\_content form.wsd-afb-action-input .components-base-control\_\_field>.components-base-control\_\_label{display:none} |
* ## [attributes-for-blocks/trunk/readme.txt](/changeset/3144730/attributes-for-blocks/trunk/readme.txt?old=3066420&old_path=attributes-for-blocks%2Ftrunk%2Freadme.txt "Show the [3066420:3144730] differences restricted to attributes-for-blocks/trunk/readme.txt")

  | [r3066420](/browser/attributes-for-blocks/trunk/readme.txt?rev=3066420#L1 "Show revision 3066420 of this file in browser") | [r3144730](/browser/attributes-for-blocks/trunk/readme.txt?rev=3144730#L1 "Show revision 3144730 of this file in browser") |  |
  | --- | --- | --- |
  | 1 | 1 | === Attributes for Blocks === |
  | 2 | 2 | Contributors: websevendev, jimedwards |
  | 3 |  | Tags: gutenberg, blocks, attributes, ~~id, style, data, aria, onclick~~ |
  |  | 3 | Tags: gutenberg, blocks, attributes, style, aria |
  | 4 | 4 | Requires at least: 6.2.0 |
  | 5 |  | Tested up to: 6.~~5~~ |
  |  | 5 | Tested up to: 6.6 |
  | 6 | 6 | Requires PHP: 7.4 |
  | 7 |  | Stable tag: 1.0.~~6~~ |
  |  | 7 | Stable tag: 1.0.7 |
  | 8 | 8 | License: GPLv2 or later |
  | 9 | 9 | License URI: http://www.gnu.org/licenses/gpl-2.0.html |
  | […](/browser/attributes-for-blocks/trunk/readme.txt?rev=3066420#L23) | […](/browser/attributes-for-blocks/trunk/readme.txt?rev=3144730#L23) |  |
  | 23 | 23 | Type an attribute name into the "Add attribute" field and press "Add" to add an attribute for the block. A new input with the attribute's name should appear below, into which you can optionally insert the attribute value. |
  | 24 | 24 | Example attributes: `style`, `title`, `target`, `class`, `id`, `onClick`, `data-\*`, `aria-\*`. |
  |  | 25 |  |
  |  | 26 | = Why is the input disabled? = |
  |  | 27 | When the current user doesn't have `unfiltered\_html` capabilities attributes cannot be added and all existing attributes are stripped when the post is updated. |
  | 25 | 28 |  |
  | 26 | 29 | = How does it work? = |
  | […](/browser/attributes-for-blocks/trunk/readme.txt?rev=3066420#L45) | […](/browser/attributes-for-blocks/trunk/readme.txt?rev=3144730#L48) |  |
  | 45 | 48 | Blocks with custom attributes may become invalid, depending on which attributes you've added. From there you can recover the block without the custom attributes by clicking "Attempt Block Recovery" or keep the block with custom attributes as HTML by choosing "Convert to HTML". If you don't want to risk blocks becoming invalid you need to remove all custom attributes before disabling the plugin. |
  | 46 | 49 |  |
  |  | 50 | = How do I add unfiltered\_html capability to user roles? = |
  |  | 51 | You can modify which roles have the `unfiltered\_html` capability using custom code in your theme's `functions.php` file or via a custom plugin. Only grant this capability if you trust the current and future users of that role to not do anything malicious. |
  |  | 52 |  |
  |  | 53 | add\_action('init', function() { |
  |  | 54 | if($role = get\_role('contributor')) { |
  |  | 55 | $role->add\_cap('unfiltered\_html'); |
  |  | 56 | } |
  |  | 57 | }); |
  |  | 58 |  |
  | 47 | 59 | == Screenshots == |
  | 48 | 60 |  |
  | […](/browser/attributes-for-blocks/trunk/readme.txt?rev=3066420#L64) | […](/browser/attributes-for-blocks/trunk/readme.txt?rev=3144730#L76) |  |
  | 64 | 76 |  |
  | 65 | 77 | == Changelog == |
  |  | 78 |  |
  |  | 79 | = 1.0.7 = |
  |  | 80 | \* Security update: users without `unfiltered\_html` capability can no longer add attributes. When a user without the capability updates a post all existing attributes are stripped. Issue discovered by Francesco Carlucci (CVE ID: CVE-2024-8318, CVSS Severity Score: 6.4 (Medium)). The vulnerability made it possible for authenticated attackers, with Contributor-level access and above, to inject arbitrary web scripts in pages that will execute whenever a user accessed an injected page. |
  |  | 81 | \* Tested up to WordPress 6.6. |
  |  | 82 | \* Update `@wordpress/\*` packages. |
  | 66 | 83 |  |
  | 67 | 84 | = 1.0.6 = |

**Note:** See [TracChangeset](/wiki/TracChangeset)
for help on using the changeset viewer.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Unified Diff](?format=diff&new=3144730&old=3066420&new_path=%2Fattributes-for-blocks&old_path=%2Fattributes-for-blocks)
* [Zip Archive](?format=zip&new=3144730&old=3066420&new_path=%2Fattributes-for-blocks&old_path=%2Fattributes-for-blocks)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)

