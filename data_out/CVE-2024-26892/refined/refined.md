- **Root cause of vulnerability:** Use-after-free in the `mt7921_irq_handler` function within the MediaTek mt7921e WiFi driver. The interrupt handler can be called after the device has been removed and its resources freed, leading to a use-after-free condition.
- **Weaknesses/vulnerabilities present:** A use-after-free vulnerability exists due to the possibility of an interrupt occurring after the device is unregistered but before the interrupt handler is fully disabled.
- **Impact of exploitation:** The use-after-free vulnerability can lead to a kernel crash, denial of service, or potentially arbitrary code execution.
- **Attack vectors:** The vulnerability is triggered when the WiFi driver is unloaded (e.g., via `rmmod`) and an interrupt occurs during the unregistration process.
- **Required attacker capabilities/position:** An attacker would need the ability to unload the kernel module to trigger this vulnerability, typically requiring root privileges. The attacker also needs to trigger a specific interrupt at the right time, which might be difficult and would likely need to exploit some existing functionality.