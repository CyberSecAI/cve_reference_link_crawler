Based on the provided content, here's a breakdown of the vulnerability:

**Root Cause:**

*   The vulnerability lies in the `/kubepi/api/v1/users/search` endpoint, which leaks password hashes. This suggests a lack of proper access control or data sanitization when handling user data.

**Weaknesses/Vulnerabilities:**

*   **Information Disclosure:** The primary vulnerability is the exposure of user password hashes through the API endpoint. This is a violation of confidentiality.
*  **Lack of proper access control:** The API endpoint `/kubepi/api/v1/users/search` should not expose user password hashes

**Impact of Exploitation:**

*   **Confidential Information Leakage:** An attacker can obtain the password hashes of all users, including administrators.
*   **Password Cracking:** Leaked password hashes can be subjected to offline cracking attempts, potentially leading to unauthorized access to user accounts.

**Attack Vectors:**

*   **Network:** The vulnerability can be exploited remotely over the network.
*   The specific attack vector is accessing the vulnerable API endpoint `http://kube.pi/kubepi/api/v1/users/search?pageNum=1&&pageSize=10`

**Required Attacker Capabilities/Position:**

*   **Network Access:** The attacker needs network connectivity to the server running the vulnerable KubePi instance.
*   **Low Privileges:** The attacker only requires low privileges to exploit the vulnerability.

**Additional Details:**

*   **Affected Versions:** KubePi versions up to and including v1.6.4 are vulnerable.
*   **Patched Version:** The vulnerability is fixed in version v1.6.5.
*   **CVSS Score:** The vulnerability has a CVSS v3 score of 6.5, categorized as "Moderate".
*  **CWE:** The vulnerability is related to CWE-200 (Information Exposure)