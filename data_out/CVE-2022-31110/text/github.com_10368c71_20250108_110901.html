
[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FDIYgod%2FRSSHub%2Fissues%2F10045)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FDIYgod%2FRSSHub%2Fissues%2F10045)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=DIYgod%2FRSSHub)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[DIYgod](/DIYgod)
/
**[RSSHub](/DIYgod/RSSHub)**
Public

* [Notifications](/login?return_to=%2FDIYgod%2FRSSHub) You must be signed in to change notification settings
* [Fork
  7.7k](/login?return_to=%2FDIYgod%2FRSSHub)
* [Star
   34.7k](/login?return_to=%2FDIYgod%2FRSSHub)

* [Code](/DIYgod/RSSHub)
* [Issues
  317](/DIYgod/RSSHub/issues)
* [Pull requests
  18](/DIYgod/RSSHub/pulls)
* [Discussions](/DIYgod/RSSHub/discussions)
* [Actions](/DIYgod/RSSHub/actions)
* [Projects
  0](/DIYgod/RSSHub/projects)
* [Security](/DIYgod/RSSHub/security)
* [Insights](/DIYgod/RSSHub/pulse)

Additional navigation options

* [Code](/DIYgod/RSSHub)
* [Issues](/DIYgod/RSSHub/issues)
* [Pull requests](/DIYgod/RSSHub/pulls)
* [Discussions](/DIYgod/RSSHub/discussions)
* [Actions](/DIYgod/RSSHub/actions)
* [Projects](/DIYgod/RSSHub/projects)
* [Security](/DIYgod/RSSHub/security)
* [Insights](/DIYgod/RSSHub/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2FDIYgod%2FRSSHub%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2FDIYgod%2FRSSHub%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# [Vulnerability Report Disclosure: ReDoS] Catastrophic Backtracking in User-supplied Regular Expression #10045

Closed

[Rongronggg9](/Rongronggg9) opened this issue
Jun 26, 2022
· 2 comments

Closed

# [[Vulnerability Report Disclosure: ReDoS] Catastrophic Backtracking in User-supplied Regular Expression](#top) #10045

[Rongronggg9](/Rongronggg9) opened this issue
Jun 26, 2022
· 2 comments

Labels
[announcement](/DIYgod/RSSHub/labels/announcement)
[core bug](/DIYgod/RSSHub/labels/core%20bug)
Ouch! That hurts.
[security](/DIYgod/RSSHub/labels/security)
Pull requests that address a security vulnerability

## Comments

[![@Rongronggg9](https://avatars.githubusercontent.com/u/15956627?s=80&u=3e5d623ad009379b3b658c0bc965d44e8882db1d&v=4)](/Rongronggg9)

Copy link

Contributor

### **[Rongronggg9](/Rongronggg9)** commented [Jun 26, 2022](#issue-1284990825) • edited Loading

| **The vulnerability has been fixed (refer to the [security advisory](https://github.com/DIYgod/RSSHub/security/advisories/GHSA-jvxx-v45p-v5vf)).** According to the consultation with [@DIYgod](https://github.com/DIYgod), this is a complete disclosure of the vulnerability report, disclosed 120 hours after the fix commit.  [**For a better reading experience, download the PDF here.**](https://github.com/DIYgod/RSSHub/files/8987350/Vulnerability.Report.-.rev6.pdf)  简要的简体中文翻译附在下一条回复。 Vulnerability Report (RSSHub) **Regular expression Denial of Service (ReDoS)** **Catastrophic Backtracking in User-supplied Regular Expression** Author: Rongrong ([@Rongronggg9](https://github.com/Rongronggg9)) POC *After reporting to the repository owner, the vulnerability has been fixed (refer to the [security advisory](https://github.com/DIYgod/RSSHub/security/advisories/GHSA-jvxx-v45p-v5vf)). To reproduce the vulnerability, a version before [041cfc3](https://github.com/DIYgod/RSSHub/commit/041cfc376e41f361218cce4ed0ef04c8eff56179) (inclusive) is needed. [`diygod/rsshub:2022-06-20`](https://hub.docker.com/layers/rsshub/diygod/rsshub/2022-06-20/images/sha256-5c1e16c0e1ace16895ae536d9d6fa5b09f2c4a2aa6e3e4ca85ddf226c1aa3225?context=explore) is the last vulnerable Docker image.*   1. Follow the [official guide](https://github.com/DIYgod/RSSHub/blob/1d6e7d8a1df26ccd8a2156dbd8665097e077c6c6/docs/en/install/README.md) to deploy an RSSHub instance in any method (except Vercel or GAE). 2. `curl 'http://example.com/test/complicated?filter=%28%5B%5E%3C%3E%27%22%5D%2B%29%2A%22%3C&filterout=%28%5B%5E%3C%3E%27%22%5D%2B%29%2A%22%3C'` 3. The instance is now unresponsive to any request (Denial of Service). 4. Monitor the CPU usage of the process `node index.js`. It is now always occupying a whole CPU core. It can last for at least several hours.  EXP `example.com` is an RSSHub instance. `/test/complicated` can be nearly any "route" of RSSHub, here is a randomly chosen "test route". `filter`, `filter_title`, `filter_description`, `filter_author`, `filterout`, `filterout_title`, `filterout_description`, and `filterout_author` are all so-called parameters of RSSHub, which can be supplied in the URI query. These parameters accept user-supplied regular expressions with unconditional trust, then call `String.match()` to perform regular expression matches. All of these parameters are vulnerable. `%28%5B%5E%3C%3E%27%22%5D%2B%29%2A%22%3C` is the URL encoded form of the regular expression /`([^<>'"]+)*"<`/. The POC shows a catastrophic-backtracking-vulnerable regular expression specially designed for any HTML. But most catastrophic-backtracking-vulnerable regular expression may be able to construct an effective DoS attack (refer to the "Look back" chapter for more details).  Once catastrophic backtracking occurs, `String.match()` can take more than several hours to finish. There is no timeout enforced, causing the ReDoS attack to become "zero-cost": attack once, down for hours. On multi-core servers, the ReDoS attack can probably only affect the RSSHub instance itself; while on single-core servers, especially VPS[1](#user-content-fn-1-655e2db0ef420fdbc4819aa2477df308), it can be a disaster.  The component cannot be disabled. Every RSSHub instance is vulnerable "out-of-box" unless additional access control is applied. If an external watchdog or timeout is enforced (e.g. Vercel, GAE), the downtime of each effective attack can be limited. However, the instance must be terminated first in order to resume it, so the attack cost is still too low. Vulnerable version Since Git hash [4671720](https://github.com/DIYgod/RSSHub/commit/4671720f4c5e1aaaad8fcc1dce684b6546baf2ff), Pull Request [#3910](https://github.com/DIYgod/RSSHub/pull/3910) on GitHub, which was merge on Feb 9, 2020 (28.5 months ago). *Fixed in [5c41774](https://github.com/DIYgod/RSSHub/commit/5c4177441417b44a6e45c3c63e9eac2504abeb5b).* Condition to be vulnerable Unless additional access control is applied. If an external watchdog or timeout is enforced, the downtime can be limited but the instance is still vulnerable. Vulnerability grade High. Possible fix Either:   1. Drop the regular expression match feature completely and roll back to string match. 2. Enforce additional permission check when accepting user-supplied regular expressions. 3. Migrate to a backtracking-free regular expression engine. 4. (not really[2](#user-content-fn-2-655e2db0ef420fdbc4819aa2477df308) a "fix") Enforce a timeout when performing a regular expression match. 5. (not really[3](#user-content-fn-3-655e2db0ef420fdbc4819aa2477df308) a "fix") Disable the feature by default and require each instance maintainer to manually enable it.  Timeline Considering the fix of the vulnerability is simple, I prefer a 28+7 days timeline (UTC). Jun 21, 2022 (Day 0)  * Vulnerability found. * Vulnerability reported.  Jul 5, 2022 (Day 14)  * If the email to i@diygod.me gets no response, I will immediately open an issue in the [GitHub repository](https://github.com/DIYgod/RSSHub), only informing maintainers there is a DoS vulnerability without disclosing any vulnerability detail.  Jun 22, 2022 - Jul 19, 2022 (Day 1 - Day 28)  * If a fix is committed and pushed to the GitHub repository during this period, I will wait for 120 hours in order that maintainers can disclose a [security advisory](https://github.com/DIYgod/RSSHub/security/advisories) on GitHub. No matter whether the security advisory has been disclosed or not, once the 120-hour deadline is exceeded, I will immediately disclose the full report[4](#user-content-fn-4-655e2db0ef420fdbc4819aa2477df308) by opening an [issue in the GitHub repository](https://github.com/DIYgod/RSSHub/issues).  Jul 20, 2022 - Jul 26, 2022 (Day 29 - Day 35)  * Once a fix is committed and pushed to the GitHub repository during this period, I will immediately disclose the full report by opening an issue in the GitHub repository.  Jul 27, 2022 (Day 36)  * If no fix was committed and pushed to the GitHub repository during the previous two periods, I will immediately disclose the full report by opening an issue in the GitHub repository.  Additional conditions  * Maintainers may ask me to disclose the full report before exceeding the 120-hour deadline. * Maintainers may consult with me to determine a new timeline, but that consultation must be disclosed along with the full report. * If being replied "won't fix" or "not a vulnerability", I will immediately disclose the full report along with the reply by opening an issue in the GitHub repository. * I reserve the right to apply for a CVE-ID.  Timeline (in reality)Jun 21, 2022 15:31 UTC (0h)  * Vulnerability reported.  Jun 21, 2022 15:56 UTC (0.4h)  * Vulnerability fixed.   + Replace the regular expression engine with a backtracking-free one (`RE2`).   + Git hash: [5c41774](https://github.com/DIYgod/RSSHub/commit/5c4177441417b44a6e45c3c63e9eac2504abeb5b)  Jun 21, 2022 17:52 UTC (2.4h)  * The fix was confirmed to be effective.  Jun 22, 2022 10:43 UTC (19.2h)  * The [security advisory](https://github.com/DIYgod/RSSHub/security/advisories/GHSA-jvxx-v45p-v5vf) was published.  Jun 22, 2022 19:25 UTC (27.9h)  * Two commits "for backward compatibility" opened up the attack surface again by allowing instance maintainers to switch back to the vulnerable regular expression engine.   + Git hash: [e4478a3](https://github.com/DIYgod/RSSHub/commit/e4478a366ce179671c4f1bd2f0cff95985da44ea)     - Pull request: [feat(core): regex engine config #10013](https://github.com/DIYgod/RSSHub/pull/10013)   + Git hash: [dc64deb](https://github.com/DIYgod/RSSHub/commit/dc64debaf77f57b593f7b2a451298f350a084a97)     - Pull request: [feat(core): regex engine naming and test suit #10014](https://github.com/DIYgod/RSSHub/pull/10014)   + Since they were created by a maintainer ([@NeverBehave](https://github.com/NeverBehave)) and approved by the repository owner ([@DIYgod](https://github.com/DIYgod)), I choose not to consider it as a vulnerability but document it here for warning (refer to the next chapter).  Jun 26, 2022, 15:56 UTC (120.4h)  * The full report was able to be disclosed.  Look back A ReDoS attack is usually severe but cost-less, "defeating the strong with little effort". Carelessness and the over-trust in the regular expression engine requiring backtracking are the root causes of a ReDoS vulnerability, while the common immediate causes are:   1. A regular expression engine requiring backtracking, and 2. A catastrophic-backtracking-vulnerable regular expression, and 3. A user-supplied malicious strings.   ReDoS vulnerabilities are not very common since there must be a catastrophic-backtracking-vulnerable regular expression, which is usually written by programmers and out of the control of end-users. But in this vulnerability of RSSHub, things are different: both the regular expression and the string can be user-supplied. In the POC, I merely showed how to supply a vulnerable regular expression. So how to understand why the string can also be user-supplied? A fact is that some "routes" (e.g. `/twitter/user/:username`) grab posts from social media, resulting in anyone being able to post malicious strings and request RSSHub to grab them. An experienced attacker may merely construct a vulnerable regular expression specially designed for some strings just like the one I have demonstrated. While an inexperienced attacker can easily use known combinations of vulnerable regular expressions and malicious strings. As a result, everyone who knows what catastrophic backtracking is can probably construct an effective attack.  The fix adopts an alternative regular expression engine (`RE2`) which is backtracking-free. It is quite simple, but effective. It shows a nice example with functionality and security balanced.  However, as mentioned, two commits (refer to the previous chapter) have opened up the attack surface again in certain conditions. Those commits re-empower instance maintainers to switch back to the vulnerable regular expression engine, the vanilla built-in-JavaScript one (`RegExp`). To be responsible, I warn instance maintainers again not to switch back to `RegExp` unless:   * [Additional access control](https://github.com/DIYgod/RSSHub/blob/master/docs/en/install/README.md#access-control-configuration) is applied, or * Your instance does not expose to the Internet, or * You understand what are you doing exactly and do not care about ReDoS attacks.  RevisionsRev. 1 Initial report. Rev. 2 Document the chosen fix in the chapter "Possible fix". Correct some wording and statements. Add two new chapters: "Timeline (in reality)" and "Look back". Rev. 3 Minor revision. Document two commits opening up the attack surface again in certain conditions. Rev. 4 Fix the statement about `/test/complicated`. Rev. 5 Correct some mistakes in the chapter "Timeline (in reality)". Rev. 6 Document the last vulnerable Docker image. Footnotes  1. Most VPS providers take the advantage of a technology called "CPU credits". If a VPS has a high CPU load continuously, it can possibly consume all remaining CPU credits, causing the VPS provider to limit the performance to a fairly low level. Even if the high load ends, it can take at least several hours before there are enough CPU credits to make the performance resume. [↩](#user-content-fnref-1-655e2db0ef420fdbc4819aa2477df308) 2. The attack cost is still too low. [↩](#user-content-fnref-2-655e2db0ef420fdbc4819aa2477df308) 3. Still vulnerable if manually enabled and matching the "condition to be vulnerable". [↩](#user-content-fnref-3-655e2db0ef420fdbc4819aa2477df308) 4. What you are reading. [↩](#user-content-fnref-4-655e2db0ef420fdbc4819aa2477df308) |
| --- |
| The text was updated successfully, but these errors were encountered: |

 👍
1
 Colin-XKL reacted with thumbs up emoji
 ❤️
1
 maidmeow4 reacted with heart emoji

All reactions

* 👍
  1 reaction
* ❤️
  1 reaction

[![@Rongronggg9](https://avatars.githubusercontent.com/u/15956627?s=40&u=3e5d623ad009379b3b658c0bc965d44e8882db1d&v=4)](/Rongronggg9)
[Rongronggg9](/Rongronggg9)
added
the
[RSS bug](/DIYgod/RSSHub/labels/RSS%20bug)
Something isn't working
label
[Jun 26, 2022](#event-6880706420)

[![@Rongronggg9](https://avatars.githubusercontent.com/u/15956627?s=80&u=3e5d623ad009379b3b658c0bc965d44e8882db1d&v=4)](/Rongronggg9)

Copy link

Contributor

Author

### **[Rongronggg9](/Rongronggg9)** commented [Jun 26, 2022](#issuecomment-1166609489) • edited Loading

| 简体中文翻译由机器翻译协助完成。  该漏洞已得到修复 (请参阅[安全公告](https://github.com/DIYgod/RSSHub/security/advisories/GHSA-jvxx-v45p-v5vf))。根据与 [@DIYgod](https://github.com/DIYgod) 的协商，这是漏洞报告的完整披露，在修复提交的 120 小时后披露。 漏洞报告 (RSSHub) **正则表达式拒绝服务攻击 (ReDoS)** **用户提供的正则表达式中的灾难性回溯** 作者：Rongrong ([@Rongronggg9](https://github.com/Rongronggg9)) POC *向仓库所有者报告后，漏洞已修复 (参阅[安全公告](https://github.com/DIYgod/RSSHub/security/advisories/GHSA-jvxx-v45p-v5vf))。复现漏洞需要 [041cfc3](https://github.com/DIYgod/RSSHub/commit/041cfc376e41f361218cce4ed0ef04c8eff56179) (含) 之前的版本。[`diygod/rsshub:2022-06-20`](https://hub.docker.com/layers/rsshub/diygod/rsshub/2022-06-20/images/sha256-5c1e16c0e1ace16895ae536d9d6fa5b09f2c4a2aa6e3e4ca85ddf226c1aa3225?context=explore) 是最后一个易受攻击的 Docker 镜像。*   1. 按照[官方指南](https://github.com/DIYgod/RSSHub/blob/1d6e7d8a1df26ccd8a2156dbd8665097e077c6c6/docs/install/README.md)以任何方法 (Vercel 或 GAE 除外) 部署 RSSHub 实例。 2. `curl 'http://example.com/test/complicated?filter=%28%5B%5E%3C%3E%27%22%5D%2B%29%2A%22%3C&filterout=%28%5B%5E%3C%3E%27%22%5D%2B%29%2A%22%3C'` 3. 该实例现在对任何请求都没有响应 (拒绝服务)。 4. 监控进程 `node index.js` 的 CPU 使用率。它现在总是占据整个 CPU 核心。这种情况可以持续至少几个小时。  EXP `example.com` 是一个 RSSHub 实例。 `/test/complicated` 可以是 RSSHub 的几乎任何“路由”，这里是一个随机选择的“测试路由”。 `filter`, `filter_title`, `filter_description`, `filter_author`, `filterout`, `filterout_title`, `filterout_description`, 和 `filterout_author` 都是 RSSHub 的所谓参数，可以在 URI 查询字符串中提供。这些参数接受用户提供的正则表达式，并给予无条件信任，然后调用 `String.match()` 以执行正则表达式匹配。所有这些参数都是易受攻击的。 `%28%5B%5E%3C%3E%27%22%5D%2B%29%2A%22%3C` 是正则表达式 /`([^<>'"]+)*"<`/ 的 URL 编码形式。POC 显示了专为任何 HTML 设计的易受灾难性回溯攻击的正则表达式。但是大多数易受灾难性回溯攻击的正则表达式都有可能能够构建有效的 DoS 攻击 (有关详细信息，请参阅“回顾”一章)。  一旦发生灾难性的回溯，`String.match()` 可能需要数个小时才能完成。由于没有强制的执行超时，ReDoS 攻击可谓“零成本”：攻击一次，宕机数小时。在多核服务器上，ReDoS 攻击可能只会影响 RSSHub 实例本身；然而在单核服务器，尤其是 VPS[1](#user-content-fn-1-052950fa8004446e7db6a8a435f9b3fd) 上，这可以是一场灾难。  该组件无法禁用。除非应用了额外的访问控制，否则每个 RSSHub 实例“一开箱”就易受攻击。如果强制执行外部看门狗或超时 (例如 Vercel、GAE) ，则可以限制每次有效攻击导致的宕机时间。但是，实例必须先终止才能恢复，因此攻击成本仍然太低。 有漏洞的版本 自 Git hash [4671720](https://github.com/DIYgod/RSSHub/commit/4671720f4c5e1aaaad8fcc1dce684b6546baf2ff) 以来的所有版本，这个 commit 是 GitHub 上的 Pull Request [#3910](https://github.com/DIYgod/RSSHub/pull/3910)，于 2020 年 2 月 9 日 (28.5 个月前) 被合并。 *已在 [5c41774](https://github.com/DIYgod/RSSHub/commit/5c4177441417b44a6e45c3c63e9eac2504abeb5b) 中修复。* 易受攻击的条件 除非应用了额外的访问控制。 如果强制执行外部看门狗或超时，则可以限制宕机时间，但实例仍然容易受到攻击。 漏洞等级 高。 可能的修复 <略> 时间轴 <略> 时间轴 (现实中) <略> 回顾 ReDoS 攻击通常可以造成严重后果，但成本却很低，“四两拨千斤”。粗心和对需要回溯的正则表达式引擎的过度信任是写出 ReDoS 漏洞的根本原因，而造成攻击的常见的直接原因是：   1. 需要回溯的正则表达式引擎，以及 2. 一个易受灾难性回溯攻击的正则表达式，以及 3. 用户提供的恶意字符串。   ReDoS 漏洞并不常见，因为必须有一个易受灾难性回溯攻击的正则表达式，它通常由程序员编写并且不受最终用户的控制。但在 RSSHub 的这个漏洞中，情况有所不同：正则表达式和字符串都可以由用户提供。在 POC 中，我只是展示了如何提供易受攻击的正则表达式。那么如何理解为什么字符串也可以由用户提供呢？事实上，一些“路由” (例如 `/twitter/user/:username`) 从社交媒体抓取帖子，导致任何人都可以发布恶意字符串并请求 RSSHub 抓取它们。一个有经验的攻击者可能只需要构造一个专门为某些字符串设计的易受攻击的正则表达式，就像我演示的那样。然而没有经验的攻击者可以轻松使用易受攻击的正则表达式和恶意字符串的已知组合。因此，每个知道什么是灾难性回溯的人都可以构造有效的攻击。  该修复采用了一种替代正则表达式引擎 (`RE2`)，它无需使用回溯。这很简单，但也很有效。这展示了一个很好的例子，平衡了功能性和安全性。  然而，两个提交 ([#10013](https://github.com/DIYgod/RSSHub/pull/10013), [#10014](https://github.com/DIYgod/RSSHub/pull/10014)) 在某些情况下再次打开了攻击面。这些提交重新授权实例维护者切换回易受攻击的正则表达式引擎，即 JavaScript 中原生的引擎 (`RegExp`)。为了负责任，我在此警示实例维护者不要切换回 `RegExp`，除非：   * 应用了[额外的访问控制](https://github.com/DIYgod/RSSHub/blob/master/docs/install/README.md#%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6%E9%85%8D%E7%BD%AE)，或者 * 您的实例未暴露于互联网，或者 * 您完全了解自己在做什么，并且不关心 ReDoS 攻击。  修订记录 <略> Footnotes  1. 大多数 VPS 提供商利用一种称为“CPU 积分”的技术。如果 VPS 持续有高 CPU 负载，则可能会消耗所有剩余的 CPU 积分，导致 VPS 提供商将性能限制在相当低的水平。即使高负载结束，也可能需要至少几个小时才能有足够的 CPU 积分来恢复性能。 [↩](#user-content-fnref-1-052950fa8004446e7db6a8a435f9b3fd) |
| --- |

All reactions

Sorry, something went wrong.

[![@TonyRL](https://avatars.githubusercontent.com/u/11386903?s=40&v=4)](/TonyRL)
[TonyRL](/TonyRL)
added
[security](/DIYgod/RSSHub/labels/security)
Pull requests that address a security vulnerability
[core bug](/DIYgod/RSSHub/labels/core%20bug)
Ouch! That hurts.
[announcement](/DIYgod/RSSHub/labels/announcement)
and removed
[RSS bug](/DIYgod/RSSHub/labels/RSS%20bug)
Something isn't working
labels
[Jun 26, 2022](#event-6880755192)

[![@TonyRL](https://avatars.githubusercontent.com/u/11386903?s=40&v=4)](/TonyRL)
[TonyRL](/TonyRL)
pinned this issue
[Jun 26, 2022](#event-6880757217)

[![@DIYgod](https://avatars.githubusercontent.com/u/8266075?s=40&u=9de49c9b3eaf4db02e685458cb64b64c172034bf&v=4)](/DIYgod)
[DIYgod](/DIYgod)
closed this as [completed](/DIYgod/RSSHub/issues?q=is%3Aissue+is%3Aclosed+archived%3Afalse+reason%3Acompleted)
[Jun 30, 2022](#event-6910434152)

[![@Zahid01711](https://avatars.githubusercontent.com/u/54137658?s=80&v=4)](/Zahid01711)

### This comment was marked as off-topic.

[Sign in to view](/login?return_to=https%3A%2F%2Fgithub.com%2FDIYgod%2FRSSHub%2Fissues%2F10045)

[![@TonyRL](https://avatars.githubusercontent.com/u/11386903?s=40&v=4)](/TonyRL)
[TonyRL](/TonyRL)
unpinned this issue
[Jan 24, 2023](#event-8346749298)

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2FDIYgod%2FRSSHub%2Fissues%2F10045)

Assignees

No one assigned

Labels

[announcement](/DIYgod/RSSHub/labels/announcement)
[core bug](/DIYgod/RSSHub/labels/core%20bug)
Ouch! That hurts.
[security](/DIYgod/RSSHub/labels/security)
Pull requests that address a security vulnerability

Projects

None yet

Milestone

No milestone

Development

No branches or pull requests

4 participants

[![@DIYgod](https://avatars.githubusercontent.com/u/8266075?s=52&v=4)](/DIYgod) [![@TonyRL](https://avatars.githubusercontent.com/u/11386903?s=52&v=4)](/TonyRL) [![@Rongronggg9](https://avatars.githubusercontent.com/u/15956627?s=52&v=4)](/Rongronggg9) [![@Zahid01711](https://avatars.githubusercontent.com/u/54137658?s=52&v=4)](/Zahid01711)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.

