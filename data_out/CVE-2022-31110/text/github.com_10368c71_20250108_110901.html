
[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FDIYgod%2FRSSHub%2Fissues%2F10045)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FDIYgod%2FRSSHub%2Fissues%2F10045)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=DIYgod%2FRSSHub)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[DIYgod](/DIYgod)
/
**[RSSHub](/DIYgod/RSSHub)**
Public

* [Notifications](/login?return_to=%2FDIYgod%2FRSSHub) You must be signed in to change notification settings
* [Fork
  7.7k](/login?return_to=%2FDIYgod%2FRSSHub)
* [Star
   34.7k](/login?return_to=%2FDIYgod%2FRSSHub)

* [Code](/DIYgod/RSSHub)
* [Issues
  317](/DIYgod/RSSHub/issues)
* [Pull requests
  18](/DIYgod/RSSHub/pulls)
* [Discussions](/DIYgod/RSSHub/discussions)
* [Actions](/DIYgod/RSSHub/actions)
* [Projects
  0](/DIYgod/RSSHub/projects)
* [Security](/DIYgod/RSSHub/security)
* [Insights](/DIYgod/RSSHub/pulse)

Additional navigation options

* [Code](/DIYgod/RSSHub)
* [Issues](/DIYgod/RSSHub/issues)
* [Pull requests](/DIYgod/RSSHub/pulls)
* [Discussions](/DIYgod/RSSHub/discussions)
* [Actions](/DIYgod/RSSHub/actions)
* [Projects](/DIYgod/RSSHub/projects)
* [Security](/DIYgod/RSSHub/security)
* [Insights](/DIYgod/RSSHub/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2FDIYgod%2FRSSHub%2Fissues%2Fnew%2Fchoose)

By clicking â€œSign up for GitHubâ€, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). Weâ€™ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2FDIYgod%2FRSSHub%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# [Vulnerability Report Disclosure: ReDoS] Catastrophic Backtracking in User-supplied Regular Expression #10045

Closed

[Rongronggg9](/Rongronggg9) opened this issue
Jun 26, 2022
Â· 2 comments

Closed

# [[Vulnerability Report Disclosure: ReDoS] Catastrophic Backtracking in User-supplied Regular Expression](#top) #10045

[Rongronggg9](/Rongronggg9) opened this issue
Jun 26, 2022
Â· 2 comments

Labels
[announcement](/DIYgod/RSSHub/labels/announcement)
[core bug](/DIYgod/RSSHub/labels/core%20bug)
Ouch! That hurts.
[security](/DIYgod/RSSHub/labels/security)
Pull requests that address a security vulnerability

## Comments

[![@Rongronggg9](https://avatars.githubusercontent.com/u/15956627?s=80&u=3e5d623ad009379b3b658c0bc965d44e8882db1d&v=4)](/Rongronggg9)

Copy link

Contributor

### **[Rongronggg9](/Rongronggg9)** commented [Jun 26, 2022](#issue-1284990825) â€¢ edited Loading

| **The vulnerability has been fixed (refer to the [security advisory](https://github.com/DIYgod/RSSHub/security/advisories/GHSA-jvxx-v45p-v5vf)).** According to the consultation with [@DIYgod](https://github.com/DIYgod), this is a complete disclosure of the vulnerability report, disclosed 120 hours after the fix commit.  [**For a better reading experience, download the PDF here.**](https://github.com/DIYgod/RSSHub/files/8987350/Vulnerability.Report.-.rev6.pdf)  ç®€è¦çš„ç®€ä½“ä¸­æ–‡ç¿»è¯‘é™„åœ¨ä¸‹ä¸€æ¡å›å¤ã€‚ Vulnerability Report (RSSHub) **Regular expression Denial of Service (ReDoS)** **Catastrophic Backtracking in User-supplied Regular Expression** Author: Rongrong ([@Rongronggg9](https://github.com/Rongronggg9)) POC *After reporting to the repository owner, the vulnerability has been fixed (refer to the [security advisory](https://github.com/DIYgod/RSSHub/security/advisories/GHSA-jvxx-v45p-v5vf)). To reproduce the vulnerability, a version before [041cfc3](https://github.com/DIYgod/RSSHub/commit/041cfc376e41f361218cce4ed0ef04c8eff56179) (inclusive) is needed. [`diygod/rsshub:2022-06-20`](https://hub.docker.com/layers/rsshub/diygod/rsshub/2022-06-20/images/sha256-5c1e16c0e1ace16895ae536d9d6fa5b09f2c4a2aa6e3e4ca85ddf226c1aa3225?context=explore) is the last vulnerable Docker image.*   1. Follow the [official guide](https://github.com/DIYgod/RSSHub/blob/1d6e7d8a1df26ccd8a2156dbd8665097e077c6c6/docs/en/install/README.md) to deploy an RSSHub instance in any method (except Vercel or GAE). 2. `curl 'http://example.com/test/complicated?filter=%28%5B%5E%3C%3E%27%22%5D%2B%29%2A%22%3C&filterout=%28%5B%5E%3C%3E%27%22%5D%2B%29%2A%22%3C'` 3. The instance is now unresponsive to any request (Denial of Service). 4. Monitor the CPU usage of the process `node index.js`. It is now always occupying a whole CPU core. It can last for at least several hours.  EXP `example.com` is an RSSHub instance. `/test/complicated` can be nearly any "route" of RSSHub, here is a randomly chosen "test route". `filter`, `filter_title`, `filter_description`, `filter_author`, `filterout`, `filterout_title`, `filterout_description`, and `filterout_author` are all so-called parameters of RSSHub, which can be supplied in the URI query. These parameters accept user-supplied regular expressions with unconditional trust, then call `String.match()` to perform regular expression matches. All of these parameters are vulnerable. `%28%5B%5E%3C%3E%27%22%5D%2B%29%2A%22%3C` is the URL encoded form of the regular expression /`([^<>'"]+)*"<`/. The POC shows a catastrophic-backtracking-vulnerable regular expression specially designed for any HTML. But most catastrophic-backtracking-vulnerable regular expression may be able to construct an effective DoS attack (refer to the "Look back" chapter for more details).  Once catastrophic backtracking occurs, `String.match()` can take more than several hours to finish. There is no timeout enforced, causing the ReDoS attack to become "zero-cost": attack once, down for hours. On multi-core servers, the ReDoS attack can probably only affect the RSSHub instance itself; while on single-core servers, especially VPS[1](#user-content-fn-1-655e2db0ef420fdbc4819aa2477df308), it can be a disaster.  The component cannot be disabled. Every RSSHub instance is vulnerable "out-of-box" unless additional access control is applied. If an external watchdog or timeout is enforced (e.g. Vercel, GAE), the downtime of each effective attack can be limited. However, the instance must be terminated first in order to resume it, so the attack cost is still too low. Vulnerable version Since Git hash [4671720](https://github.com/DIYgod/RSSHub/commit/4671720f4c5e1aaaad8fcc1dce684b6546baf2ff), Pull Request [#3910](https://github.com/DIYgod/RSSHub/pull/3910) on GitHub, which was merge on Feb 9, 2020 (28.5 months ago). *Fixed in [5c41774](https://github.com/DIYgod/RSSHub/commit/5c4177441417b44a6e45c3c63e9eac2504abeb5b).* Condition to be vulnerable Unless additional access control is applied. If an external watchdog or timeout is enforced, the downtime can be limited but the instance is still vulnerable. Vulnerability grade High. Possible fix Either:   1. Drop the regular expression match feature completely and roll back to string match. 2. Enforce additional permission check when accepting user-supplied regular expressions. 3. Migrate to a backtracking-free regular expression engine. 4. (not really[2](#user-content-fn-2-655e2db0ef420fdbc4819aa2477df308) a "fix") Enforce a timeout when performing a regular expression match. 5. (not really[3](#user-content-fn-3-655e2db0ef420fdbc4819aa2477df308) a "fix") Disable the feature by default and require each instance maintainer to manually enable it.  Timeline Considering the fix of the vulnerability is simple, I prefer a 28+7 days timeline (UTC). Jun 21, 2022 (Day 0)  * Vulnerability found. * Vulnerability reported.  Jul 5, 2022 (Day 14)  * If the email to i@diygod.me gets no response, I will immediately open an issue in the [GitHub repository](https://github.com/DIYgod/RSSHub), only informing maintainers there is a DoS vulnerability without disclosing any vulnerability detail.  Jun 22, 2022 - Jul 19, 2022 (Day 1 - Day 28)  * If a fix is committed and pushed to the GitHub repository during this period, I will wait for 120 hours in order that maintainers can disclose a [security advisory](https://github.com/DIYgod/RSSHub/security/advisories) on GitHub. No matter whether the security advisory has been disclosed or not, once the 120-hour deadline is exceeded, I will immediately disclose the full report[4](#user-content-fn-4-655e2db0ef420fdbc4819aa2477df308) by opening an [issue in the GitHub repository](https://github.com/DIYgod/RSSHub/issues).  Jul 20, 2022 - Jul 26, 2022 (Day 29 - Day 35)  * Once a fix is committed and pushed to the GitHub repository during this period, I will immediately disclose the full report by opening an issue in the GitHub repository.  Jul 27, 2022 (Day 36)  * If no fix was committed and pushed to the GitHub repository during the previous two periods, I will immediately disclose the full report by opening an issue in the GitHub repository.  Additional conditions  * Maintainers may ask me to disclose the full report before exceeding the 120-hour deadline. * Maintainers may consult with me to determine a new timeline, but that consultation must be disclosed along with the full report. * If being replied "won't fix" or "not a vulnerability", I will immediately disclose the full report along with the reply by opening an issue in the GitHub repository. * I reserve the right to apply for a CVE-ID.  Timeline (in reality)Jun 21, 2022 15:31 UTC (0h)  * Vulnerability reported.  Jun 21, 2022 15:56 UTC (0.4h)  * Vulnerability fixed.   + Replace the regular expression engine with a backtracking-free one (`RE2`).   + Git hash: [5c41774](https://github.com/DIYgod/RSSHub/commit/5c4177441417b44a6e45c3c63e9eac2504abeb5b)  Jun 21, 2022 17:52 UTC (2.4h)  * The fix was confirmed to be effective.  Jun 22, 2022 10:43 UTC (19.2h)  * The [security advisory](https://github.com/DIYgod/RSSHub/security/advisories/GHSA-jvxx-v45p-v5vf) was published.  Jun 22, 2022 19:25 UTC (27.9h)  * Two commits "for backward compatibility" opened up the attack surface again by allowing instance maintainers to switch back to the vulnerable regular expression engine.   + Git hash: [e4478a3](https://github.com/DIYgod/RSSHub/commit/e4478a366ce179671c4f1bd2f0cff95985da44ea)     - Pull request: [feat(core): regex engine configÂ #10013](https://github.com/DIYgod/RSSHub/pull/10013)   + Git hash: [dc64deb](https://github.com/DIYgod/RSSHub/commit/dc64debaf77f57b593f7b2a451298f350a084a97)     - Pull request: [feat(core): regex engine naming and test suitÂ #10014](https://github.com/DIYgod/RSSHub/pull/10014)   + Since they were created by a maintainer ([@NeverBehave](https://github.com/NeverBehave)) and approved by the repository owner ([@DIYgod](https://github.com/DIYgod)), I choose not to consider it as a vulnerability but document it here for warning (refer to the next chapter).  Jun 26, 2022, 15:56 UTC (120.4h)  * The full report was able to be disclosed.  Look back A ReDoS attack is usually severe but cost-less, "defeating the strong with little effort". Carelessness and the over-trust in the regular expression engine requiring backtracking are the root causes of a ReDoS vulnerability, while the common immediate causes are:   1. A regular expression engine requiring backtracking, and 2. A catastrophic-backtracking-vulnerable regular expression, and 3. A user-supplied malicious strings.   ReDoS vulnerabilities are not very common since there must be a catastrophic-backtracking-vulnerable regular expression, which is usually written by programmers and out of the control of end-users. But in this vulnerability of RSSHub, things are different: both the regular expression and the string can be user-supplied. In the POC, I merely showed how to supply a vulnerable regular expression. So how to understand why the string can also be user-supplied? A fact is that some "routes" (e.g. `/twitter/user/:username`) grab posts from social media, resulting in anyone being able to post malicious strings and request RSSHub to grab them. An experienced attacker may merely construct a vulnerable regular expression specially designed for some strings just like the one I have demonstrated. While an inexperienced attacker can easily use known combinations of vulnerable regular expressions and malicious strings. As a result, everyone who knows what catastrophic backtracking is can probably construct an effective attack.  The fix adopts an alternative regular expression engine (`RE2`) which is backtracking-free. It is quite simple, but effective. It shows a nice example with functionality and security balanced.  However, as mentioned, two commits (refer to the previous chapter) have opened up the attack surface again in certain conditions. Those commits re-empower instance maintainers to switch back to the vulnerable regular expression engine, the vanilla built-in-JavaScript one (`RegExp`). To be responsible, I warn instance maintainers again not to switch back to `RegExp` unless:   * [Additional access control](https://github.com/DIYgod/RSSHub/blob/master/docs/en/install/README.md#access-control-configuration) is applied, or * Your instance does not expose to the Internet, or * You understand what are you doing exactly and do not care about ReDoS attacks.  RevisionsRev. 1 Initial report. Rev. 2 Document the chosen fix in the chapter "Possible fix". Correct some wording and statements. Add two new chapters: "Timeline (in reality)" and "Look back". Rev. 3 Minor revision. Document two commits opening up the attack surface again in certain conditions. Rev. 4 Fix the statement about `/test/complicated`. Rev. 5 Correct some mistakes in the chapter "Timeline (in reality)". Rev. 6 Document the last vulnerable Docker image. Footnotes  1. Most VPS providers take the advantage of a technology called "CPU credits". If a VPS has a high CPU load continuously, it can possibly consume all remaining CPU credits, causing the VPS provider to limit the performance to a fairly low level. Even if the high load ends, it can take at least several hours before there are enough CPU credits to make the performance resume. [â†©](#user-content-fnref-1-655e2db0ef420fdbc4819aa2477df308) 2. The attack cost is still too low. [â†©](#user-content-fnref-2-655e2db0ef420fdbc4819aa2477df308) 3. Still vulnerable if manually enabled and matching the "condition to be vulnerable". [â†©](#user-content-fnref-3-655e2db0ef420fdbc4819aa2477df308) 4. What you are reading. [â†©](#user-content-fnref-4-655e2db0ef420fdbc4819aa2477df308) |
| --- |
| The text was updated successfully, but these errors were encountered: |

 ğŸ‘
1
 Colin-XKL reacted with thumbs up emoji
 â¤ï¸
1
 maidmeow4 reacted with heart emoji

All reactions

* ğŸ‘
  1 reaction
* â¤ï¸
  1 reaction

[![@Rongronggg9](https://avatars.githubusercontent.com/u/15956627?s=40&u=3e5d623ad009379b3b658c0bc965d44e8882db1d&v=4)](/Rongronggg9)
[Rongronggg9](/Rongronggg9)
added
the
[RSS bug](/DIYgod/RSSHub/labels/RSS%20bug)
Something isn't working
label
[Jun 26, 2022](#event-6880706420)

[![@Rongronggg9](https://avatars.githubusercontent.com/u/15956627?s=80&u=3e5d623ad009379b3b658c0bc965d44e8882db1d&v=4)](/Rongronggg9)

Copy link

Contributor

Author

### **[Rongronggg9](/Rongronggg9)** commented [Jun 26, 2022](#issuecomment-1166609489) â€¢ edited Loading

| ç®€ä½“ä¸­æ–‡ç¿»è¯‘ç”±æœºå™¨ç¿»è¯‘ååŠ©å®Œæˆã€‚  è¯¥æ¼æ´å·²å¾—åˆ°ä¿®å¤ (è¯·å‚é˜…[å®‰å…¨å…¬å‘Š](https://github.com/DIYgod/RSSHub/security/advisories/GHSA-jvxx-v45p-v5vf))ã€‚æ ¹æ®ä¸ [@DIYgod](https://github.com/DIYgod) çš„åå•†ï¼Œè¿™æ˜¯æ¼æ´æŠ¥å‘Šçš„å®Œæ•´æŠ«éœ²ï¼Œåœ¨ä¿®å¤æäº¤çš„ 120 å°æ—¶åæŠ«éœ²ã€‚ æ¼æ´æŠ¥å‘Š (RSSHub) **æ­£åˆ™è¡¨è¾¾å¼æ‹’ç»æœåŠ¡æ”»å‡» (ReDoS)** **ç”¨æˆ·æä¾›çš„æ­£åˆ™è¡¨è¾¾å¼ä¸­çš„ç¾éš¾æ€§å›æº¯** ä½œè€…ï¼šRongrong ([@Rongronggg9](https://github.com/Rongronggg9)) POC *å‘ä»“åº“æ‰€æœ‰è€…æŠ¥å‘Šåï¼Œæ¼æ´å·²ä¿®å¤ (å‚é˜…[å®‰å…¨å…¬å‘Š](https://github.com/DIYgod/RSSHub/security/advisories/GHSA-jvxx-v45p-v5vf))ã€‚å¤ç°æ¼æ´éœ€è¦ [041cfc3](https://github.com/DIYgod/RSSHub/commit/041cfc376e41f361218cce4ed0ef04c8eff56179) (å«) ä¹‹å‰çš„ç‰ˆæœ¬ã€‚[`diygod/rsshub:2022-06-20`](https://hub.docker.com/layers/rsshub/diygod/rsshub/2022-06-20/images/sha256-5c1e16c0e1ace16895ae536d9d6fa5b09f2c4a2aa6e3e4ca85ddf226c1aa3225?context=explore) æ˜¯æœ€åä¸€ä¸ªæ˜“å—æ”»å‡»çš„ Docker é•œåƒã€‚*   1. æŒ‰ç…§[å®˜æ–¹æŒ‡å—](https://github.com/DIYgod/RSSHub/blob/1d6e7d8a1df26ccd8a2156dbd8665097e077c6c6/docs/install/README.md)ä»¥ä»»ä½•æ–¹æ³• (Vercel æˆ– GAE é™¤å¤–) éƒ¨ç½² RSSHub å®ä¾‹ã€‚ 2. `curl 'http://example.com/test/complicated?filter=%28%5B%5E%3C%3E%27%22%5D%2B%29%2A%22%3C&filterout=%28%5B%5E%3C%3E%27%22%5D%2B%29%2A%22%3C'` 3. è¯¥å®ä¾‹ç°åœ¨å¯¹ä»»ä½•è¯·æ±‚éƒ½æ²¡æœ‰å“åº” (æ‹’ç»æœåŠ¡)ã€‚ 4. ç›‘æ§è¿›ç¨‹ `node index.js` çš„ CPU ä½¿ç”¨ç‡ã€‚å®ƒç°åœ¨æ€»æ˜¯å æ®æ•´ä¸ª CPU æ ¸å¿ƒã€‚è¿™ç§æƒ…å†µå¯ä»¥æŒç»­è‡³å°‘å‡ ä¸ªå°æ—¶ã€‚  EXP `example.com` æ˜¯ä¸€ä¸ª RSSHub å®ä¾‹ã€‚ `/test/complicated` å¯ä»¥æ˜¯ RSSHub çš„å‡ ä¹ä»»ä½•â€œè·¯ç”±â€ï¼Œè¿™é‡Œæ˜¯ä¸€ä¸ªéšæœºé€‰æ‹©çš„â€œæµ‹è¯•è·¯ç”±â€ã€‚ `filter`, `filter_title`, `filter_description`, `filter_author`, `filterout`, `filterout_title`, `filterout_description`, å’Œ `filterout_author` éƒ½æ˜¯ RSSHub çš„æ‰€è°“å‚æ•°ï¼Œå¯ä»¥åœ¨ URI æŸ¥è¯¢å­—ç¬¦ä¸²ä¸­æä¾›ã€‚è¿™äº›å‚æ•°æ¥å—ç”¨æˆ·æä¾›çš„æ­£åˆ™è¡¨è¾¾å¼ï¼Œå¹¶ç»™äºˆæ— æ¡ä»¶ä¿¡ä»»ï¼Œç„¶åè°ƒç”¨ `String.match()` ä»¥æ‰§è¡Œæ­£åˆ™è¡¨è¾¾å¼åŒ¹é…ã€‚æ‰€æœ‰è¿™äº›å‚æ•°éƒ½æ˜¯æ˜“å—æ”»å‡»çš„ã€‚ `%28%5B%5E%3C%3E%27%22%5D%2B%29%2A%22%3C` æ˜¯æ­£åˆ™è¡¨è¾¾å¼ /`([^<>'"]+)*"<`/ çš„ URL ç¼–ç å½¢å¼ã€‚POC æ˜¾ç¤ºäº†ä¸“ä¸ºä»»ä½• HTML è®¾è®¡çš„æ˜“å—ç¾éš¾æ€§å›æº¯æ”»å‡»çš„æ­£åˆ™è¡¨è¾¾å¼ã€‚ä½†æ˜¯å¤§å¤šæ•°æ˜“å—ç¾éš¾æ€§å›æº¯æ”»å‡»çš„æ­£åˆ™è¡¨è¾¾å¼éƒ½æœ‰å¯èƒ½èƒ½å¤Ÿæ„å»ºæœ‰æ•ˆçš„ DoS æ”»å‡» (æœ‰å…³è¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜…â€œå›é¡¾â€ä¸€ç« )ã€‚  ä¸€æ—¦å‘ç”Ÿç¾éš¾æ€§çš„å›æº¯ï¼Œ`String.match()` å¯èƒ½éœ€è¦æ•°ä¸ªå°æ—¶æ‰èƒ½å®Œæˆã€‚ç”±äºæ²¡æœ‰å¼ºåˆ¶çš„æ‰§è¡Œè¶…æ—¶ï¼ŒReDoS æ”»å‡»å¯è°“â€œé›¶æˆæœ¬â€ï¼šæ”»å‡»ä¸€æ¬¡ï¼Œå®•æœºæ•°å°æ—¶ã€‚åœ¨å¤šæ ¸æœåŠ¡å™¨ä¸Šï¼ŒReDoS æ”»å‡»å¯èƒ½åªä¼šå½±å“ RSSHub å®ä¾‹æœ¬èº«ï¼›ç„¶è€Œåœ¨å•æ ¸æœåŠ¡å™¨ï¼Œå°¤å…¶æ˜¯ VPS[1](#user-content-fn-1-052950fa8004446e7db6a8a435f9b3fd) ä¸Šï¼Œè¿™å¯ä»¥æ˜¯ä¸€åœºç¾éš¾ã€‚  è¯¥ç»„ä»¶æ— æ³•ç¦ç”¨ã€‚é™¤éåº”ç”¨äº†é¢å¤–çš„è®¿é—®æ§åˆ¶ï¼Œå¦åˆ™æ¯ä¸ª RSSHub å®ä¾‹â€œä¸€å¼€ç®±â€å°±æ˜“å—æ”»å‡»ã€‚å¦‚æœå¼ºåˆ¶æ‰§è¡Œå¤–éƒ¨çœ‹é—¨ç‹—æˆ–è¶…æ—¶ (ä¾‹å¦‚ Vercelã€GAE) ï¼Œåˆ™å¯ä»¥é™åˆ¶æ¯æ¬¡æœ‰æ•ˆæ”»å‡»å¯¼è‡´çš„å®•æœºæ—¶é—´ã€‚ä½†æ˜¯ï¼Œå®ä¾‹å¿…é¡»å…ˆç»ˆæ­¢æ‰èƒ½æ¢å¤ï¼Œå› æ­¤æ”»å‡»æˆæœ¬ä»ç„¶å¤ªä½ã€‚ æœ‰æ¼æ´çš„ç‰ˆæœ¬ è‡ª Git hash [4671720](https://github.com/DIYgod/RSSHub/commit/4671720f4c5e1aaaad8fcc1dce684b6546baf2ff) ä»¥æ¥çš„æ‰€æœ‰ç‰ˆæœ¬ï¼Œè¿™ä¸ª commit æ˜¯ GitHub ä¸Šçš„ Pull Request [#3910](https://github.com/DIYgod/RSSHub/pull/3910)ï¼Œäº 2020 å¹´ 2 æœˆ 9 æ—¥ (28.5 ä¸ªæœˆå‰) è¢«åˆå¹¶ã€‚ *å·²åœ¨ [5c41774](https://github.com/DIYgod/RSSHub/commit/5c4177441417b44a6e45c3c63e9eac2504abeb5b) ä¸­ä¿®å¤ã€‚* æ˜“å—æ”»å‡»çš„æ¡ä»¶ é™¤éåº”ç”¨äº†é¢å¤–çš„è®¿é—®æ§åˆ¶ã€‚ å¦‚æœå¼ºåˆ¶æ‰§è¡Œå¤–éƒ¨çœ‹é—¨ç‹—æˆ–è¶…æ—¶ï¼Œåˆ™å¯ä»¥é™åˆ¶å®•æœºæ—¶é—´ï¼Œä½†å®ä¾‹ä»ç„¶å®¹æ˜“å—åˆ°æ”»å‡»ã€‚ æ¼æ´ç­‰çº§ é«˜ã€‚ å¯èƒ½çš„ä¿®å¤ <ç•¥> æ—¶é—´è½´ <ç•¥> æ—¶é—´è½´ (ç°å®ä¸­) <ç•¥> å›é¡¾ ReDoS æ”»å‡»é€šå¸¸å¯ä»¥é€ æˆä¸¥é‡åæœï¼Œä½†æˆæœ¬å´å¾ˆä½ï¼Œâ€œå››ä¸¤æ‹¨åƒæ–¤â€ã€‚ç²—å¿ƒå’Œå¯¹éœ€è¦å›æº¯çš„æ­£åˆ™è¡¨è¾¾å¼å¼•æ“çš„è¿‡åº¦ä¿¡ä»»æ˜¯å†™å‡º ReDoS æ¼æ´çš„æ ¹æœ¬åŸå› ï¼Œè€Œé€ æˆæ”»å‡»çš„å¸¸è§çš„ç›´æ¥åŸå› æ˜¯ï¼š   1. éœ€è¦å›æº¯çš„æ­£åˆ™è¡¨è¾¾å¼å¼•æ“ï¼Œä»¥åŠ 2. ä¸€ä¸ªæ˜“å—ç¾éš¾æ€§å›æº¯æ”»å‡»çš„æ­£åˆ™è¡¨è¾¾å¼ï¼Œä»¥åŠ 3. ç”¨æˆ·æä¾›çš„æ¶æ„å­—ç¬¦ä¸²ã€‚   ReDoS æ¼æ´å¹¶ä¸å¸¸è§ï¼Œå› ä¸ºå¿…é¡»æœ‰ä¸€ä¸ªæ˜“å—ç¾éš¾æ€§å›æº¯æ”»å‡»çš„æ­£åˆ™è¡¨è¾¾å¼ï¼Œå®ƒé€šå¸¸ç”±ç¨‹åºå‘˜ç¼–å†™å¹¶ä¸”ä¸å—æœ€ç»ˆç”¨æˆ·çš„æ§åˆ¶ã€‚ä½†åœ¨ RSSHub çš„è¿™ä¸ªæ¼æ´ä¸­ï¼Œæƒ…å†µæœ‰æ‰€ä¸åŒï¼šæ­£åˆ™è¡¨è¾¾å¼å’Œå­—ç¬¦ä¸²éƒ½å¯ä»¥ç”±ç”¨æˆ·æä¾›ã€‚åœ¨ POC ä¸­ï¼Œæˆ‘åªæ˜¯å±•ç¤ºäº†å¦‚ä½•æä¾›æ˜“å—æ”»å‡»çš„æ­£åˆ™è¡¨è¾¾å¼ã€‚é‚£ä¹ˆå¦‚ä½•ç†è§£ä¸ºä»€ä¹ˆå­—ç¬¦ä¸²ä¹Ÿå¯ä»¥ç”±ç”¨æˆ·æä¾›å‘¢ï¼Ÿäº‹å®ä¸Šï¼Œä¸€äº›â€œè·¯ç”±â€ (ä¾‹å¦‚ `/twitter/user/:username`) ä»ç¤¾äº¤åª’ä½“æŠ“å–å¸–å­ï¼Œå¯¼è‡´ä»»ä½•äººéƒ½å¯ä»¥å‘å¸ƒæ¶æ„å­—ç¬¦ä¸²å¹¶è¯·æ±‚ RSSHub æŠ“å–å®ƒä»¬ã€‚ä¸€ä¸ªæœ‰ç»éªŒçš„æ”»å‡»è€…å¯èƒ½åªéœ€è¦æ„é€ ä¸€ä¸ªä¸“é—¨ä¸ºæŸäº›å­—ç¬¦ä¸²è®¾è®¡çš„æ˜“å—æ”»å‡»çš„æ­£åˆ™è¡¨è¾¾å¼ï¼Œå°±åƒæˆ‘æ¼”ç¤ºçš„é‚£æ ·ã€‚ç„¶è€Œæ²¡æœ‰ç»éªŒçš„æ”»å‡»è€…å¯ä»¥è½»æ¾ä½¿ç”¨æ˜“å—æ”»å‡»çš„æ­£åˆ™è¡¨è¾¾å¼å’Œæ¶æ„å­—ç¬¦ä¸²çš„å·²çŸ¥ç»„åˆã€‚å› æ­¤ï¼Œæ¯ä¸ªçŸ¥é“ä»€ä¹ˆæ˜¯ç¾éš¾æ€§å›æº¯çš„äººéƒ½å¯ä»¥æ„é€ æœ‰æ•ˆçš„æ”»å‡»ã€‚  è¯¥ä¿®å¤é‡‡ç”¨äº†ä¸€ç§æ›¿ä»£æ­£åˆ™è¡¨è¾¾å¼å¼•æ“ (`RE2`)ï¼Œå®ƒæ— éœ€ä½¿ç”¨å›æº¯ã€‚è¿™å¾ˆç®€å•ï¼Œä½†ä¹Ÿå¾ˆæœ‰æ•ˆã€‚è¿™å±•ç¤ºäº†ä¸€ä¸ªå¾ˆå¥½çš„ä¾‹å­ï¼Œå¹³è¡¡äº†åŠŸèƒ½æ€§å’Œå®‰å…¨æ€§ã€‚  ç„¶è€Œï¼Œä¸¤ä¸ªæäº¤ ([#10013](https://github.com/DIYgod/RSSHub/pull/10013), [#10014](https://github.com/DIYgod/RSSHub/pull/10014)) åœ¨æŸäº›æƒ…å†µä¸‹å†æ¬¡æ‰“å¼€äº†æ”»å‡»é¢ã€‚è¿™äº›æäº¤é‡æ–°æˆæƒå®ä¾‹ç»´æŠ¤è€…åˆ‡æ¢å›æ˜“å—æ”»å‡»çš„æ­£åˆ™è¡¨è¾¾å¼å¼•æ“ï¼Œå³ JavaScript ä¸­åŸç”Ÿçš„å¼•æ“ (`RegExp`)ã€‚ä¸ºäº†è´Ÿè´£ä»»ï¼Œæˆ‘åœ¨æ­¤è­¦ç¤ºå®ä¾‹ç»´æŠ¤è€…ä¸è¦åˆ‡æ¢å› `RegExp`ï¼Œé™¤éï¼š   * åº”ç”¨äº†[é¢å¤–çš„è®¿é—®æ§åˆ¶](https://github.com/DIYgod/RSSHub/blob/master/docs/install/README.md#%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6%E9%85%8D%E7%BD%AE)ï¼Œæˆ–è€… * æ‚¨çš„å®ä¾‹æœªæš´éœ²äºäº’è”ç½‘ï¼Œæˆ–è€… * æ‚¨å®Œå…¨äº†è§£è‡ªå·±åœ¨åšä»€ä¹ˆï¼Œå¹¶ä¸”ä¸å…³å¿ƒ ReDoS æ”»å‡»ã€‚  ä¿®è®¢è®°å½• <ç•¥> Footnotes  1. å¤§å¤šæ•° VPS æä¾›å•†åˆ©ç”¨ä¸€ç§ç§°ä¸ºâ€œCPU ç§¯åˆ†â€çš„æŠ€æœ¯ã€‚å¦‚æœ VPS æŒç»­æœ‰é«˜ CPU è´Ÿè½½ï¼Œåˆ™å¯èƒ½ä¼šæ¶ˆè€—æ‰€æœ‰å‰©ä½™çš„ CPU ç§¯åˆ†ï¼Œå¯¼è‡´ VPS æä¾›å•†å°†æ€§èƒ½é™åˆ¶åœ¨ç›¸å½“ä½çš„æ°´å¹³ã€‚å³ä½¿é«˜è´Ÿè½½ç»“æŸï¼Œä¹Ÿå¯èƒ½éœ€è¦è‡³å°‘å‡ ä¸ªå°æ—¶æ‰èƒ½æœ‰è¶³å¤Ÿçš„ CPU ç§¯åˆ†æ¥æ¢å¤æ€§èƒ½ã€‚ [â†©](#user-content-fnref-1-052950fa8004446e7db6a8a435f9b3fd) |
| --- |

All reactions

Sorry, something went wrong.

[![@TonyRL](https://avatars.githubusercontent.com/u/11386903?s=40&v=4)](/TonyRL)
[TonyRL](/TonyRL)
added
[security](/DIYgod/RSSHub/labels/security)
Pull requests that address a security vulnerability
[core bug](/DIYgod/RSSHub/labels/core%20bug)
Ouch! That hurts.
[announcement](/DIYgod/RSSHub/labels/announcement)
and removed
[RSS bug](/DIYgod/RSSHub/labels/RSS%20bug)
Something isn't working
labels
[Jun 26, 2022](#event-6880755192)

[![@TonyRL](https://avatars.githubusercontent.com/u/11386903?s=40&v=4)](/TonyRL)
[TonyRL](/TonyRL)
pinned this issue
[Jun 26, 2022](#event-6880757217)

[![@DIYgod](https://avatars.githubusercontent.com/u/8266075?s=40&u=9de49c9b3eaf4db02e685458cb64b64c172034bf&v=4)](/DIYgod)
[DIYgod](/DIYgod)
closed this as [completed](/DIYgod/RSSHub/issues?q=is%3Aissue+is%3Aclosed+archived%3Afalse+reason%3Acompleted)
[Jun 30, 2022](#event-6910434152)

[![@Zahid01711](https://avatars.githubusercontent.com/u/54137658?s=80&v=4)](/Zahid01711)

### This comment was marked as off-topic.

[Sign in to view](/login?return_to=https%3A%2F%2Fgithub.com%2FDIYgod%2FRSSHub%2Fissues%2F10045)

[![@TonyRL](https://avatars.githubusercontent.com/u/11386903?s=40&v=4)](/TonyRL)
[TonyRL](/TonyRL)
unpinned this issue
[Jan 24, 2023](#event-8346749298)

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2FDIYgod%2FRSSHub%2Fissues%2F10045)

Assignees

No one assigned

Labels

[announcement](/DIYgod/RSSHub/labels/announcement)
[core bug](/DIYgod/RSSHub/labels/core%20bug)
Ouch! That hurts.
[security](/DIYgod/RSSHub/labels/security)
Pull requests that address a security vulnerability

Projects

None yet

Milestone

No milestone

Development

No branches or pull requests

4 participants

[![@DIYgod](https://avatars.githubusercontent.com/u/8266075?s=52&v=4)](/DIYgod) [![@TonyRL](https://avatars.githubusercontent.com/u/11386903?s=52&v=4)](/TonyRL) [![@Rongronggg9](https://avatars.githubusercontent.com/u/15956627?s=52&v=4)](/Rongronggg9) [![@Zahid01711](https://avatars.githubusercontent.com/u/54137658?s=52&v=4)](/Zahid01711)

## Footer

Â© 2025 GitHub,Â Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You canâ€™t perform that action at this time.

