The provided content relates to CVE-2021-47251.

**Root cause of vulnerability:**
The vulnerability lies in the `ieee80211_scan_rx` function in `net/mac80211/scan.c`. The function was using hardcoded values to check the minimum length of the received 802.11 frame, leading to incorrect handling of different frame types such as S1G beacons, probe responses and beacons.

**Weaknesses/vulnerabilities present:**
The code used fixed values (15 or 24 bytes) to check the skb length, which is incorrect for different 802.11 frame types. This could lead to a validation warning being triggered later in `cfg80211`.

**Impact of exploitation:**
The immediate impact of the vulnerability was a validation warning in `cfg80211` due to the inconsistent length check. It's not clear if there would be any further impact if the issue is not fixed.

**Attack vectors:**
An attacker could potentially send a crafted 802.11 frame with a length that doesn't satisfy the hardcoded length checks but would be valid for the correct frame type.

**Required attacker capabilities/position:**
The attacker needs to be able to send 802.11 frames to a vulnerable system. This likely means the attacker would need to be within range of the wireless network or have the capability to inject frames.

**Additional Details:**
The fix replaces the hardcoded length checks with dynamic determination based on the frame type. This uses the `offsetof` macro to correctly determine the minimum required header length based on whether the frame is a probe response, beacon, S1G beacon or S1G short beacon.