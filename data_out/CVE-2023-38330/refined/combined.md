=== Content from bugs.oxid-esales.com_cb2260fe_20250111_072853.html ===


Toggle sidebar [OXID eShop bugtrack](/main_page.php) Toggle user menu

* OXID eShop (all versions)

  + - [All Projects](/set_project.php?project_id=0)
    - [Apex Theme](/set_project.php?project_id=63)
    - [Flow theme](/set_project.php?project_id=40)
    - [module Adyen](/set_project.php?project_id=61)
    - [module Amazon Pay](/set_project.php?project_id=59)
    - [module Country VAT](/set_project.php?project_id=65)
    - [module Easy Credit](/set_project.php?project_id=68)
    - [module eVAT](/set_project.php?project_id=34)
    - [module Free Shipping Coupons](/set_project.php?project_id=71)
    - [module GDPR Base](/set_project.php?project_id=44)
    - [module GDPR Opt-in](/set_project.php?project_id=43)
    - [module Geo-Blocking](/set_project.php?project_id=64)
    - [module GraphQL](/set_project.php?project_id=55)
    - [GraphQL Base](/set_project.php?project_id=55;56)
    - [GraphQL Configuration Access](/set_project.php?project_id=55;67)
    - [GraphQL Storefront](/set_project.php?project_id=55;57)
    - [GraphQL Storefront Administration](/set_project.php?project_id=55;72)
    - [module Media library](/set_project.php?project_id=69)
    - [module OXID Analytics powered by Econda](/set_project.php?project_id=47)
    - [module OXID NGINX ReverseProxy](/set_project.php?project_id=52)
    - [module OXID Personalization powered by Econda](/set_project.php?project_id=46)
    - [module OXID Varnish ReverseProxy](/set_project.php?project_id=51)
    - [module PayPal](/set_project.php?project_id=14)
    - [module PayPal Checkout](/set_project.php?project_id=58)
    - [module Security](/set_project.php?project_id=70)
    - [module Stripe](/set_project.php?project_id=66)
    - [module Unzer](/set_project.php?project_id=60)
    - [module Usercentrics](/set_project.php?project_id=53)
    - [module Visual CMS](/set_project.php?project_id=41)
    - [OXID B2B ERP Interface](/set_project.php?project_id=45)
    - [OXID ERP Interface](/set_project.php?project_id=4)
    - [OXID eShop (all versions)](/set_project.php?project_id=1)
    - [OXID eShop B2B Edition](/set_project.php?project_id=39)
    - [Wave theme](/set_project.php?project_id=48)
    - [WYSIWYG Editor + Media Gallery](/set_project.php?project_id=42)
* user
  + [RSS](https://bugs.oxid-esales.com/issues_rss.php)
  + [Logout](/logout_page.php)

* [My View](/my_view_page.php)
* [View Issues](/view_all_bug_page.php)
* [Change Log](/changelog_page.php)
* [Roadmap](/roadmap_page.php)

* Anonymous
[Login](/login_page.php?return=%2Fview.php%3Fid%3D7479)
[Signup for a new account](/signup_page.php)

#### View Issue Details

[Jump to Notes](#bugnotes)

|  | | | | | |
| --- | --- | --- | --- | --- | --- |
| ID | Project | Category | View Status | Date Submitted | Last Update |
| --- | --- | --- | --- | --- | --- |
| 0007479 | OXID eShop (all versions) | 4.04. Security | public | 2023-06-06 09:44 | 2023-08-01 09:38 |
|  | | | | | |
|
| Reporter | [michael\_keiluweit](https://bugs.oxid-esales.com/view_user_page.php?id=34) | Assigned To |  |  | |
| Priority | high | Severity | major | Reproducibility | always |
| Status | resolved | Resolution | open |  | |
| Product Version | 6.5.2 |  | | | |
| Fixed in Version | 6.5.3 |  | | | |
|  | | | | | |
|
| Summary | 0007479: EE: package guzzlehttp/psr-7 2.4.3 has security flaws | | | | |
| Description | In EE 6.5.2 metapackage we have a requirement for guzzlehttp/psr7 version 2.4.3 which has security issues  Initial: NVD - CVE-2022-24775   Follow Up: NVD - CVE-2023-29197   This dependency comes into metapackage because of unzer module ("oxid-esales/unzer": "v1.0.1"). | | | | |
| Tags | [Security](tag_view_page.php?tag_id=208) | | | | |
|  | | | | | |
|
| Theme | Not defined | | | | |
| Browser | Not defined | | | | |
| PHP Version | Not defined | | | | |
| Database Version | Not defined | | | | |
|  | | | | | |
|

#### Activities

| [michael\_keiluweit](https://bugs.oxid-esales.com/view_user_page.php?id=34)  2023-06-06 09:45  administrator    [~0015208](view.php?id=7479#c15208 "Direct link to note") | <https://github.com/OXID-eSales/oxideshop_metapackage_ee/blob/v6.5.2/composer.json#L16> |
| --- | --- |
|  | |

Copyright © 2000 - 2025 OXID eSales AG | [Legal information](https://www.oxid-esales.com/impressum/) | [Privacy Policy](https://www.oxid-esales.com/datenschutz/)
Contact [administrator](/cdn-cgi/l/email-protection#d9b8bdb4b0b799b6a1b0bdf4bcaab8b5bcaaf7bab6b4 "Contact the webmaster via e-mail.") for assistance

[![Powered by Mantis Bug Tracker: a free and open source web based bug tracking system.](/images/mantis_logo.png)](https://www.oxidforge.org "Mantis Bug Tracker: a free and open source web based bug tracking system.")



=== Content from docs.oxid-esales.com_01bfa158_20250111_072853.html ===

[![Logo](../_static/logo.png)](../index.html)

OXID eShop

* [Anwenderdokumentation ➜](https://docs.oxid-esales.com/eshop/de/latest/)
* [Entwicklerdokumentation (EN) ➜](https://docs.oxid-esales.com/developer/en/latest/)

OXID Cloud

* [Clouddokumentation](../oxid-cloud/einfuehrung.html)

OXID eShop Enterprise B2B Edition

* [Dokumentation](../b2b-edition/einfuehrung.html)

OXID eShop Erweiterungen

* [Add-On-Dokumentation](../erweiterungen/add-ons/einfuehrung.html)
* [Moduldokumentation](../erweiterungen/module/einfuehrung.html)
* [Schnittstellendokumentation](../erweiterungen/schnittstellen/einfuehrung.html)

OXID docs ★ Neuigkeiten

* [OXID eShop 7.2.0 mit Zoom-Bildern, DSGVO-konformem Datenexport, VCMS-Update und anderen Verbesserungen](../releases/release-notes.html)
* [PE/EE-Modul zum Generieren von Coupons zum Versandkostenausgleich](https://docs.oxid-esales.com/modules/freeshipping-coupons/de/1.0/einfuehrung.html)
* [PE/EE-Security-Modul zum Erzwingen der Sicherheit von Passwörtern](https://docs.oxid-esales.com/modules/security/de/1.0/einfuehrung.html)
* [Geoblocking 2.2 verfügbar für OXID eShop 7.2](https://docs.oxid-esales.com/modules/geo-blocking/de/2.2/)
* [OXID ERP Interface 4.1 verfügbar für OXID eShop 7.2](https://docs.oxid-esales.com/de/erweiterungen/schnittstellen/einfuehrung.html)
* [OXID eShop Enterprise B2B Edition 7.2 verfügbar für OXID eShop 7.2](https://docs.oxid-esales.com/de/b2b-edition/einfuehrung.html)
* [OXID eShop eVAT 4.1 verfügbar für OXID eShop 7.2](https://docs.oxid-esales.com/modules/vat-tbe-services/de/4.1/)
* [DSGVO-konformer Datenexport mit GDPR Opt-in 4.1 für OXID eShop 7.2](https://docs.oxid-esales.com/modules/gdpr-optin/de/4.1/releases/gdpr-410.html)
* [OXID eShop Patch-Releases 7.0.4 und 7.1.1](https://docs.oxid-esales.com/de/releases/release-notes.html#oxid-eshop-7-0-4-7-1-1)
* [Zukünftige Updates und Verbesserungen im Release-Plan](../releases/release-plan.html)

OXID eShop Sicherheit

* [Sicherheit](security.html)
* Security-Bulletins
  + [SECURITY BULLETIN 2024-001](#security-bulletin-2024-001)
    - [SYNOPSIS](#synopsis)
    - [STATE](#state)
    - [IMPACT](#impact)
    - [AFFECTED PRODUCTS, RELEASES, AND PLATFORMS](#affected-products-releases-and-platforms)
    - [RESOLUTION](#resolution)
  + [SECURITY BULLETIN 2023-002](#security-bulletin-2023-002)
    - [SYNOPSIS](#id5)
    - [STATE](#id6)
    - [IMPACT](#id7)
    - [AFFECTED PRODUCTS, RELEASES, AND PLATFORMS](#id8)
    - [RESOLUTION](#id9)
    - [CREDITS](#credits)
  + [SECURITY BULLETIN 2023-001](#security-bulletin-2023-001)
    - [SYNOPSIS](#id11)
    - [STATE](#id12)
    - [IMPACT](#id13)
    - [AFFECTED PRODUCTS, RELEASES, AND PLATFORMS](#id14)
    - [RESOLUTION](#id15)
    - [CREDITS](#id16)
  + [Phar object injection in PHPMailer – CVE-2018-19296](#phar-object-injection-in-phpmailer-cve-2018-19296)
    - [Impact](#id17)
    - [Workaround](#workaround)
  + [Security Advisory: Preventing Dependency Confusion in PHP with Composer](#security-advisory-preventing-dependency-confusion-in-php-with-composer)
    - [Impact](#id18)
    - [Resolution](#id19)
  + [Security Bulletin 2019-002](#security-bulletin-2019-002)
    - [Synopsis](#id22)
    - [State](#id23)
    - [Impact](#id24)
    - [Affected products, releases, and platforms](#id25)
    - [Resolution](#id26)
    - [Workaround](#id27)
    - [Credits](#id28)
  + [Hotfixes for OXID eShop v4.9, v4.10, v5.2 and v5.3 (Security Issue 2019-002)](#hotfixes-for-oxid-eshop-v4-9-v4-10-v5-2-and-v5-3-security-issue-2019-002)
  + [Security Bulletin 2019-001](#security-bulletin-2019-001)
    - [Synopsis](#id30)
    - [State](#id31)
    - [Impact](#id32)
    - [Affected products, releases, and platforms](#id33)
    - [Resolution](#id34)
    - [Workarounds](#workarounds)
    - [Credits](#id35)
  + [Security Bulletin 2018-003](#security-bulletin-2018-003)
    - [Synopsis](#id37)
    - [State](#id38)
    - [Impact](#id39)
    - [Affected products, releases, and platforms](#id40)
    - [Resolution](#id41)
    - [Workarounds](#id42)
    - [Credits](#id43)
  + [Security Bulletin 2018-002](#security-bulletin-2018-002)
    - [Synopsis](#id45)
    - [State](#id46)
    - [Impact](#id47)
    - [Affected products, releases, and platforms](#id48)
    - [Resolution](#id49)
    - [Workarounds](#id50)
    - [Credits](#id51)
  + [Security Bulletin 2018-001](#security-bulletin-2018-001)
    - [Synopsis](#id53)
    - [State](#id54)
    - [Impact](#id55)
    - [Affected products, releases, and platforms](#id56)
    - [Resolution](#id57)
    - [Workarounds](#id58)
    - [Credits](#id59)

OXID docs | Informationen

* [Über OXID eSales Dokumentation](../ueber-oxid-esales-dokumentation/index.html)
* [Weitere Ressourcen](../weitere-ressourcen/index.html)

[OXID eSales Dokumentation](../index.html)

* Security-Bulletins

---

# Security-Bulletins[](#security-bulletins "Permalink to this heading")

Unsere Security-Bulletins sind nur auf Englisch verfügbar.

## SECURITY BULLETIN 2024-001[](#security-bulletin-2024-001 "Permalink to this heading")

February 27, 2024

CVE Identifier: [CVE-2024-24821](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-24821)

CVSS Score: [6.0](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:L/AC:H/PR:H/UI:N/S:C/C:H/I:H/A:H/E:F/RL:O/RC:R/CR:X/IR:X/AR:X/MAV:L/MAC:L/MPR:H/MUI:N/MS:U/MC:X/MI:X/MA:X&version=3.1)

### SYNOPSIS[](#synopsis "Permalink to this heading")

The package composer/composer with the version >=2.0,<2.2.23 || >=2.3,<2.7 loads arbitrary code from generated files, which allows code execution and possible privilege escalation.

### STATE[](#state "Permalink to this heading")

The issue is resolved, a patch release is available as of February 27, 2024.

### IMPACT[](#impact "Permalink to this heading")

An attacker with access to the infrastructure can require compromised packages and use them for code execution and/or privilege escalation.

### AFFECTED PRODUCTS, RELEASES, AND PLATFORMS[](#affected-products-releases-and-platforms "Permalink to this heading")

**Products**

* OXID eShop Enterprise Edition
* OXID eShop Professional Edition
* OXID eShop Community Edition

**Releases**

6.2 - 7.0.1

**Platforms**

The releases named above are affected on all platforms.

### RESOLUTION[](#resolution "Permalink to this heading")

The issue has been resolved in the following releases:

* 6.3.3
* 6.4.4
* 6.5.4
* 7.0.2

Update your shop to the latest version as soon as possible.

Bug tracker entry: <https://bugs.oxid-esales.com/view.php?id=7600>

## SECURITY BULLETIN 2023-002[](#security-bulletin-2023-002 "Permalink to this heading")

August 01, 2023

CVE Identifier: [CVE-2023-38330](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-38330)

CVSS Score: [6.7](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:N/AC:H/PR:N/UI:R/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C/CR:H/IR:H/AR:H/MAV:N/MAC:H/MPR:N/MUI:R/MS:U/MC:H/MI:H/MA:H)

### SYNOPSIS[](#id5 "Permalink to this heading")

The affected versions allow uploading files with modified headers in the administration area.

### STATE[](#id6 "Permalink to this heading")

The issue is resolved, a patch release is available as of July 25, 2023.

### IMPACT[](#id7 "Permalink to this heading")

An attacker can upload a file with modified header to create a HTTP Response Splitting attack.

### AFFECTED PRODUCTS, RELEASES, AND PLATFORMS[](#id8 "Permalink to this heading")

**Products**

* OXID eShop Enterprise Edition

**Releases**

* 6.5.0 – 6.5.2

**Platforms**

The releases named above are affected on all platforms.

### RESOLUTION[](#id9 "Permalink to this heading")

The issue has been resolved in the following releases:

* 6.5.3

Update your shop to the latest version as soon as possible.

Bug tracker entry: <https://bugs.oxid-esales.com/view.php?id=7479>

### CREDITS[](#credits "Permalink to this heading")

The issue was reported by our hosting partner dotfly. immediately after it became known.

## SECURITY BULLETIN 2023-001[](#security-bulletin-2023-001 "Permalink to this heading")

February 28, 2023

CVE Identifier: [CVE-2023-26260](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-26260)

CVSS Score: [6.7](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:N/AC:H/PR:N/UI:R/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C/CR:H/IR:H/AR:H/MAV:N/MAC:H/MPR:N/MUI:R/MS:U/MC:H/MI:H/MA:H)

### SYNOPSIS[](#id11 "Permalink to this heading")

The affected versions allow session hijacking in certain conditions.

### STATE[](#id12 "Permalink to this heading")

The issue is resolved, a patch release is available as of February 21, 2023.

### IMPACT[](#id13 "Permalink to this heading")

An attacker can get partial access to another customer’s account.

### AFFECTED PRODUCTS, RELEASES, AND PLATFORMS[](#id14 "Permalink to this heading")

**Products**

* OXID eShop Enterprise Edition
* OXID eShop Professional Edition
* OXID eShop Community Edition

**Releases**

* 6.2
* 6.3
* 6.4
* 6.5.0 – 6.5.1

**Platforms**

The releases named above are affected on all platforms.

### RESOLUTION[](#id15 "Permalink to this heading")

The issue has been resolved in the following releases:

* 6.2, 6.3, 6.4 per module
* 6.5.2 per patch release

Upgrade your shop to the latest version as soon as possible.

Bug tracker entry: <https://bugs.oxid-esales.com/view.php?id=7415>

### CREDITS[](#id16 "Permalink to this heading")

The issue was reported by our hosting partner Qwertiko immediately after it became known.

## Phar object injection in PHPMailer – CVE-2018-19296[](#phar-object-injection-in-phpmailer-cve-2018-19296 "Permalink to this heading")

May 27, 2021

We have been receiving messages that we would deliver a vulnerable version of PHPMailer with OXID eShop versions 6.2.4 and 6.3.0 (and earlier) because of [CVE-2018-19296](https://nvd.nist.gov/vuln/detail/CVE-2018-19296).

### Impact[](#id17 "Permalink to this heading")

After taking a deeper look at the actual impact, we can state that only method `phpmailer::addAttachment()` is affected in PHPMailer which is not used by OXID eShop (core installation) at all. However, it might be used in one of your extensions or modules. Please check that and inform/secure your clients accordingly!

[Daniel Seifert](https://github.com/SeifertDaniel) at [D³ Data Development](https://www.d3data.de/) gratefully found out that `addAttachment()` might still be triggered by `Email::sendBackupuMail()` which seems not to be in use anymore.

We will deprecate this method as soon as possible.

### Workaround[](#workaround "Permalink to this heading")

As a non-official workaround, we can offer this composer command in order to install the latest and fixed PHPMailer version:

```
composer info | grep phpmailer/phpmailer | awk '{print "composer require phpmailer/phpmailer:\"v6.4.1 as "$2"\""}' | sh

```

## Security Advisory: Preventing Dependency Confusion in PHP with Composer[](#security-advisory-preventing-dependency-confusion-in-php-with-composer "Permalink to this heading")

March 10, 2021

Recently, [Nils Adermann](https://blog.packagist.com/author/naderman/) from Packagist team published the article [Preventing Dependency Confusion in PHP with Composer](https://blog.packagist.com/preventing-dependency-hijacking/) in their blog.

### Impact[](#id18 "Permalink to this heading")

First off: OXID eShop itself, with the standard installation, is apparently not affected by this vulnerability.

Rather, this is a (strong) security advisory to all of three module vendors who still use the archaic way of distributing their modules as zip archives or do not use the packagist system at all.

As you all might know, at least since OXID eShop v6.2.x, it is mandatory to install modules via composer.

However, there are two different options possible, either automatic or manual installation as described here: [docs.oxid-esales.com/developer/en/6.2/development/modules\_components\_themes/module/installation\_setup/installation.html](https://docs.oxid-esales.com/developer/en/6.2/development/modules_components_themes/module/installation_setup/installation.html).

Even if a manual installation is necessary (depending on the vendor), composer will look up Packagist if there is a newer version of the module available and might use this one.

### Resolution[](#id19 "Permalink to this heading")

There is just a little thing to do for you as a module vendor (completely independent from OXID):

* Get yourself a [Packagist account](https://blog.packagist.com/preventing-dependency-hijacking/) and save your `vendorID` before anybody else can do that in your name.
* Additionally, register your first module with Packagist, which could only contain the required `composer.json` file and else be empty. We strongly urge you to do that today, as you are responsible for the safety of your clients and their customers.

Thanks to [Daniel](https://github.com/SeifertDaniel) at [D³ Data Development](https://www.d3data.de/) for letting us know about the gravity of this security risk!

## Security Bulletin 2019-002[](#security-bulletin-2019-002 "Permalink to this heading")

November 5, 2019

CVE Identifier: [CVE-2019-17062](https://cve.mitre.org/cgi-bin/cvename.cgi?name=2019-17062)

CVSS Score: [6.7](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:N/AC:H/PR:N/UI:R/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C/CR:H/IR:H/AR:H/MAV:N/MAC:H/MPR:N/MUI:R/MS:U/MC:H/MI:H/MA:H)

### Synopsis[](#id22 "Permalink to this heading")

With a specially crafted URL, users with administrative rights could unintentionally grant unauthorized users access to the admin panel.

### State[](#id23 "Permalink to this heading")

* Until now, no 0-day exploit is known.
* Issue is resolved, patch releases is available as of October 29th.
* Workaround is available.

### Impact[](#id24 "Permalink to this heading")

An attacker could trick a user with administrative rights to click on a malformed URL in order to gain access to the administration panel of OXID eShop.

### Affected products, releases, and platforms[](#id25 "Permalink to this heading")

**Products**

* OXID eShop Enterprise Edition (“EE”)
* OXID eShop Professional Edition (“PE”)
* OXID eShop Community Edition (“CE”)

**Releases**

* OXID eShop EE, PE and CE v6.0.0 – v6.0.5
* OXID eShop EE, PE and CE v6.1.0 – v6.1.4
* OXID eShop EE v5.3.x and 5.2.x
* OXID eShop PE and CE v4.10.x and 4.9.x

**Platforms**

The releases named above are affected on all platforms.

### Resolution[](#id26 "Permalink to this heading")

The issue has been resolved in the following releases:

* OXID eShop Enterprise, Professional & Community Edition v6.1.5
* OXID eShop Enterprise, Professional & Community Edition v6.0.6
* OXID eShop Enterprise Edition v5.3 and v5.2 (only workaround/hotfix available)
* OXID eShop Professional & Community Edition v4.10 and 4.9 (only workaround/hotfix available)

Please note that previous versions might be affected as well.

However, it was not assessed, nor will there be a workaround/fix for them.

Bug tracker entry (will remain in `private` state until November 5th): <https://bugs.oxid-esales.com/view.php?id=7023>

### Workaround[](#id27 "Permalink to this heading")

Download the file from the list according to your OXID eShop version/edition and replace the existing file in your installation:

`/source/Application/Controller/Admin/LoginController.php` (OXID eShop version >= v6)

* Hotfix for OXID eShop Enterprise, Professional & Community Edition v6.1.x (V2)
* Hotfix for OXID eShop Enterprise, Professional & Community Edition v6.0.x (V2)

`/application/controllers/admin/login.php` (OXID eShop version < v6)

* Hotfix for OXID eShop Enterprise Edition v5.3.x
* Hotfix for OXID eShop Enterprise Edition v5.2.x
* Hotfix for OXID eShop Professional Edition v4.10.x
* Hotfix for OXID eShop Professional Edition v4.9.x
* Hotfix for OXID eShop Community Edition v4.10.x
* Hotfix for OXID eShop Community Edition v4.9.x

Use this hotfix in OXID eShop >= v6.x as a *temporary* solution only.

Upgrade your shop to the latest version as soon as possible. The update will overwrite the hotfix.

### Credits[](#id28 "Permalink to this heading")

This security issue was found by an IT consultant at ALDI SÜD. Thanks a lot for reporting!

## Hotfixes for OXID eShop v4.9, v4.10, v5.2 and v5.3 (Security Issue 2019-002)[](#hotfixes-for-oxid-eshop-v4-9-v4-10-v5-2-and-v5-3-security-issue-2019-002 "Permalink to this heading")

October 29, 2019

Today, we published patch releases [OXID eShop 6.0.6](https://oxidforge.org/en/oxid-eshop-version-6-0-6.html) and [OXID eShop 6.1.5](https://oxidforge.org/en/oxid-eshop-version-6-1-5.html) fixing security issue 2019-002.

Also, former OXID eShop versions are affected by this leak that are not officially supported any more for actually a long time.

However, we decided to provide hot fixes as replacement files for series 4.9 and 4.10 (Community and Professional Edition) as well as series 5.2 and 5.3 (Enterprise Edition).

Please note that even more previous versions might be affected as well.

However, we did not assess, nor will there be a workaround/fix for them. If you run such an old version, we certainly want to urge you to update.

For more details, see the [Security Bulletin 2019-002](#security-bulletin-2019-002). It is being prepared and will be published on November 5th to give you some time for fixing your installations.

## Security Bulletin 2019-001[](#security-bulletin-2019-001 "Permalink to this heading")

July 30, 2019

CVE Identifier: [CVE-2019-13026](https://cve.mitre.org/cgi-bin/cvename.cgi?name=2019-13026)

CVSS Score: [7.5](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:N/AC:H/PR:N/UI:R/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C/CR:H/IR:H/AR:H/MAV:N/MAC:H/MPR:N/MUI:R/MS:U/MC:H/MI:H/MA:H)

### Synopsis[](#id30 "Permalink to this heading")

With a specially crafted URL, an attacker would be able to gain full access to the administration panel.

### State[](#id31 "Permalink to this heading")

* Until now, no 0-day exploit is known.
* The issue is resolved, a patch is releases available on July 30th.
* A workaround is available.

### Impact[](#id32 "Permalink to this heading")

An attacker can gain full access to an OXID eShop installation. This includes all shopping cart options, customer data and the database. No interaction between the attacker and the victim is necessary.

### Affected products, releases, and platforms[](#id33 "Permalink to this heading")

**Products**

* OXID eShop Enterprise Edition (“EE”)
* OXID eShop Professional Edition (“PE”)
* OXID eShop Community Edition (“CE”)

**Releases**

* OXID eShop EE, PE and CE v6.0.0 – v6.0.4
* OXID eShop EE, PE and CE v6.1.0 – v6.1.3

**Platforms**

The releases named above are affected on all platforms.

### Resolution[](#id34 "Permalink to this heading")

The issue has been resolved in the following releases:

* OXID eShop Enterprise Edition v6.1.4
* OXID eShop Professional Edition v6.1.4
* OXID eShop Community Edition v6.1.4
* OXID eShop Enterprise Edition v6.0.5
* OXID eShop Professional Edition v6.0.5
* OXID eShop Community Edition v6.0.5

Bug tracker entry (will remain in `private` state until July 30th): <https://bugs.oxid-esales.com/view.php?id=7002>

### Workarounds[](#workarounds "Permalink to this heading")

Please note that a fix for end-of-life versions will not be provided as they are not affected.

If you run one of the affected versions, please update your OXID eShop to v6.0.5 or 6.1.4 immediately.

However, in case you can’t update quickly, you are safe if you apply the workaround described here:

Add the following `mod_rewrite` rules right after `RewriteBase /` in `source/.htaccess`, line 4:

```
RewriteCond %{QUERY_STRING} \bsorting=[^\&\=]*[^a-z]+[^\&\=]*(\&|$) [NC]
RewriteRule .* - [F]

```

Use this blocking as a *temporary* solution only. Upgrade your shop to a supported version as soon as possible.

### Credits[](#id35 "Permalink to this heading")

This security issue was found by security researchers at <ripstech.com>.

Also, many thanks to [SysEleven](https://www.syseleven.de/) ’s security team for their helping hands.

## Security Bulletin 2018-003[](#security-bulletin-2018-003 "Permalink to this heading")

August 14, 2018

CVE Identifier: [CVE-2018-14020](https://cve.mitre.org/cgi-bin/cvename.cgi?name=2018-14020)

CVSS Score: [4.9](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H/E:F/RL:O/RC:C/CR:M/IR:M/AR:M/MAV:N/MAC:H/MPR:N/MUI:N/MS:U/MC:H/MI:H/MA:H)

### Synopsis[](#id37 "Permalink to this heading")

An attacker is able to change the delivery address by bypassing the checkout process when using Paymorrow payment method.

### State[](#id38 "Permalink to this heading")

This security issue was reported to us while working on an incident at a client system.

* The issue is resolved, patch releases are available.
* Sorry, no workaround possible.

### Impact[](#id39 "Permalink to this heading")

By bypassing the checkout process, an attacker can overcome the actual delivery address validation if the payment module doesn’t use OXID eShop’s checkout procedure properly.

In this case it happened to the Paymorrow module which is regularly delivered with OXID eShop compilation.

### Affected products, releases, and platforms[](#id40 "Permalink to this heading")

**Products**

* OXID eShop Enterprise Edition (“EE”)
* OXID eShop Professional Edition (“PE”)
* OXID eShop Community Edition (“CE”)

**Releases**

* OXID eShop EE v5.2.3 – v5.3.7
* OXID eShop PE and CE v4.9.3 – v4.10.7
* OXID eShop EE, PE and CE v6.0.0 – v6.0.2

**Platforms**

The releases named above are affected on all platforms.

### Resolution[](#id41 "Permalink to this heading")

The issue has already been resolved in the following releases:

* OXID eShop Enterprise Edition v6.1.0
* OXID eShop Professional Edition v6.1.0
* OXID eShop Community Edition v6.1.0
* OXID eShop Enterprise Edition v6.0.3
* OXID eShop Professional Edition v6.0.3
* OXID eShop Community Edition v6.0.3
* OXID eShop Enterprise Edition v5.3.8
* OXID eShop Professional Edition v4.10.8
* OXID eShop Community Edition v4.10.8

Bug tracker entry (will remain in `private` state until this security bulletin is published): <https://bugs.oxid-esales.com/view.php?id=6801>

### Workarounds[](#id42 "Permalink to this heading")

Unfortunately, a workaround cannot be provided.

### Credits[](#id43 "Permalink to this heading")

Many thanks to our Development Partner [digidesk – media solutions](https://www.digidesk.de/) who found this security issue and immediately reported it.

## Security Bulletin 2018-002[](#security-bulletin-2018-002 "Permalink to this heading")

August 14, 2018

CVE Identifier: [CVE-2018-12579](https://cve.mitre.org/cgi-bin/cvename.cgi?name=2018-12579)

CVSS Score [6.5](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:L/E:F/RL:O/RC:U/CR:M/IR:M/AR:L/MAV:N/MAC:H/MPR:N/MUI:N/MS:U/MC:H/MI:H/MA:L)

### Synopsis[](#id45 "Permalink to this heading")

An attacker would be able to take over access of a user account by entering an e-mail address similar to an already existing e-mail address in the database when using the password reset function.

### State[](#id46 "Permalink to this heading")

* Until now, no 0-day exploit is known.
* The issue is resolved, patch releases as well as a workaround are available.

### Impact[](#id47 "Permalink to this heading")

By entering a specially crafted e-mail address, an attacker is able to receive a message with the link to change the password to his own inbox and this way might take over access of a user account. This is only possible if an attacker correctly guesses or knows the e-mail address of any shop user and has registered a similar domain name like the one of the user e-mail. Additionally, it is not possible to reproduce in browsers that use punycode.

### Affected products, releases, and platforms[](#id48 "Permalink to this heading")

**Products**

* OXID eShop Enterprise Edition (“EE”)
* OXID eShop Professional Edition (“PE”)
* OXID eShop Community Edition (“CE”)

**Releases**

* All OXID eShop versions (EE) up to 5.3.7
* All OXID eShop versions (PE and CE) up to 4.10.7
* All OXID eShop 6 versions up to 6.0.2

**Platforms**

The releases named are affected on all platforms.

### Resolution[](#id49 "Permalink to this heading")

The issue has already been resolved in the following releases:

* OXID eShop Enterprise Edition v6.1.0
* OXID eShop Professional Edition v6.1.0
* OXID eShop Community Edition v6.1.0
* OXID eShop Enterprise Edition v6.0.3
* OXID eShop Professional Edition v6.0.3
* OXID eShop Community Edition v6.0.3
* OXID eShop Enterprise Edition v5.3.8
* OXID eShop Professional Edition v4.10.8
* OXID eShop Community Edition v4.10.8

Bug tracker entry (will remain in `private` state until the security bulletin is published): <https://bugs.oxid-esales.com/view.php?id=6818>

### Workarounds[](#id50 "Permalink to this heading")

**OXID eShop 5.3 (EE) & 4.10 (CE, PE)**

1. Find the method `sendForgotPwdEmail()` around line 719 in `core/oxemail.php`.
2. Replace all the content of the method with this code:

   ```
   $result = false;
   $oShop = $this->_addForgotPwdEmail($this->_getShop());
   $sOxId = $this->_getUserIdByUserName($sEmailAddress, $oShop->getId());
   $oUser = oxNew('oxuser');
   if ($sOxId && $oUser->load($sOxId)) {
     // create messages
     $oSmarty = $this->_getSmarty();
     $this->setUser($oUser);
     $this->_processViewArray();
     $this->_setMailParams($oShop);
     $this->setBody($oSmarty->fetch($this->_sForgotPwdTemplate));
     $this->setAltBody($oSmarty->fetch($this->_sForgotPwdTemplatePlain));
     $this->setSubject(($sSubject !== null) ? $sSubject : $oShop->oxshops__oxforgotpwdsubject->getRawValue());
     $sFullName = $oUser->oxuser__oxfname->getRawValue() . " " . $oUser->oxuser__oxlname->getRawValue();
     $sRecipientAddress = $oUser->oxuser__oxusername->getRawValue();
     $this->setRecipient($sRecipientAddress, $sFullName);
     $this->setReplyTo($oShop->oxshops__oxorderemail->value, $oShop->oxshops__oxname->getRawValue());
     if (!$this->send()) {
         $result = -1; // failed to send
     } else {
          $result = true; // success
     }
   }
   return $result;

   ```
3. Add a new private method `_getUserIdByUserName()` at the end of the `oxemail.php` file:

   ```
   /**
   * @param string $sUserName
   * @param int    $ShopId
   *
   * @return false|string
   */
   private function _getUserIdByUserName($sUserName, $ShopId)
   {
     $sSelect = "SELECT `OXID`
       FROM `oxuser`
       WHERE `OXACTIVE` = 1
       AND `OXUSERNAME` = ?
       AND `OXPASSWORD` != ''";
     if ($this->getConfig()->getConfigParam('blMallUsers')) {
         $sSelect .= "ORDER BY OXSHOPID = ? DESC";
     } else {
         $sSelect .= "AND OXSHOPID = ?";
     }
     $sOxId = oxDb::getDb()->getOne(
      $sSelect,
      array(
          $sUserName,
          $ShopId)
     );
     return $sOxId;
   }

   ```

**OXID eShop 6.0.x (CE, PE, EE)**

1. Go to the `Core/Email.php` file and move `use oxSystemComponentException;` below `use Exception;` around line 9.
2. Find the `sendForgotPwdEmail()` method around line 730.
3. Replace all the content of the method with the following code:

   ```
   $result = false;
   $shop = $this->_addForgotPwdEmail($this->_getShop());
   $oxid = $this->getUserIdByUserName($emailAddress, $shop->getId());
   $user = oxNew(\OxidEsales\Eshop\Application\Model\User::class);
   if ($oxid && $user->load($oxid)) {
         // create messages
         $smarty = $this->_getSmarty();
         $this->setUser($user);
         $this->_processViewArray();
         $this->_setMailParams($shop);
         $this->setBody($smarty->fetch($this->_sForgotPwdTemplate));
         $this->setAltBody($smarty->fetch($this->_sForgotPwdTemplatePlain));
         $this->setSubject(($subject !== null) ? $subject : $shop->oxshops__oxforgotpwdsubject->getRawValue());
         $fullName = $user->oxuser__oxfname->getRawValue() . " " . $user->oxuser__oxlname->getRawValue();
         $recipientAddress = $user->oxuser__oxusername->getRawValue();
         $this->setRecipient($recipientAddress, $fullName);
         $this->setReplyTo($shop->oxshops__oxorderemail->value, $shop->oxshops__oxname->getRawValue());
         if (!$this->send()) {
             $result = -1; // failed to send
         } else {
             $result = true; // success
         }
   }
   return $result;

   ```
4. Add a new private method `getUserIdByUserName()` at the end of the `Email.php` file.

   ```
    /**
    * @param string $userName
    * @param int    $shopId
    *
    * @return false|string
   */
   private function getUserIdByUserName($userName, $shopId)
   {
      $select = "SELECT `OXID`
        FROM `oxuser`
        WHERE `OXACTIVE` = 1
        AND `OXUSERNAME` = ?
        AND `OXPASSWORD` != ''";
      if ($this->getConfig()->getConfigParam('blMallUsers')) {
          $select .= "ORDER BY OXSHOPID = ? DESC";
      } else {
          $select .= "AND OXSHOPID = ?";
      }
      $sOxId = \OxidEsales\Eshop\Core\DatabaseProvider::getDb()->getOne(
          $select,
          [$userName,
           $shopId]
      );
      return $sOxId;
   }

   ```

### Credits[](#id51 "Permalink to this heading")

Many thanks to Hongkun Zeng from Zhejiang University & [VULNSPY.com](https://blog.vulnspy.com/) for this report.

## Security Bulletin 2018-001[](#security-bulletin-2018-001 "Permalink to this heading")

February 12, 2018

CVE Identifier: [CVE-2018-5763](https://cve.mitre.org/cgi-bin/cvename.cgi?name=2018-5763)

CVSS Score: [4.9](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L/E:F/RL:O/RC:C/CR:X/IR:X/AR:M/MAV:N/MAC:L/MPR:N/MUI:N/MS:U/MC:N/MI:N/MA:L)

### Synopsis[](#id53 "Permalink to this heading")

An attacker is able to bring servers to standstill by calling specially crafted URLs if OXID High Performance Option is activated, and Varnish is used (denial of service/DoS).

### State[](#id54 "Permalink to this heading")

* Until now, no 0-day exploit is known.
* The issue is resolved, patch releases as well as workarounds are available.

### Impact[](#id55 "Permalink to this heading")

By entering specially crafted URLs, an attacker is able to bring the shop server to a standstill and hence, it stops working.

This is only valid if OXID High Performance Option is activated and Varnish is used.

### Affected products, releases, and platforms[](#id56 "Permalink to this heading")

**Product**

* OXID eShop Enterprise Edition (“EE”)

**Releases**

* All OXID eShop versions up to 5.3.x
* All OXID eShop 6 (version 6.0.0)

**Platforms**

The releases named above are affected on all platforms.

### Resolution[](#id57 "Permalink to this heading")

The issue has been resolved in the following releases:

* OXID eShop Enterprise Edition v6.0.1
* OXID eShop Enterprise Edition v5.3.7

Bug tracker entry (will remain in “private” state): <https://bugs.oxid-esales.com/view.php?id=6678>

### Workarounds[](#id58 "Permalink to this heading")

Apply the following fix to Varnish default.vcl state – vcl\_recv:

```
if (req.esi_level > 1 && req.url !~ "&cl=oxwarticlebox") {
  return (synth(405, "Not allowed."));
}

```

This prevents from displaying any widget in widget except of oxwarticlebox which OXID uses in oxwarticledetails widget.

However, make sure your shop doesn’t use other widgets in a widget (that no widget returns ESI include).

### Credits[](#id59 "Permalink to this heading")

Many thanks to Timo Terhaar at [Laudert](https://www.laudert.com/) who found this security issue and immediately reported it.

 [Previous](security.html "Sicherheit")
[Next](../ueber-oxid-esales-dokumentation/index.html "Über OXID eSales Dokumentation")

---

© Copyright 2017 - 2024, OXID eSales AG.

[Impressum](https://www.oxid-esales.com/impressum/ "Impressum") | [Datenschutz](https://www.oxid-esales.com/datenschutz/ "Datenschutz") | [Kontakt](https://www.oxid-esales.com/kontakt/ "Kontakt")

 OXID docs
DE

Sprachen
[DE](https://docs.oxid-esales.com/de/)
[EN](https://docs.oxid-esales.com/en/)


