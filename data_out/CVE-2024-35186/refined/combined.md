=== Content from github.com_564a3f20_20250110_113452.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FGitoxideLabs%2Fgitoxide%2Fsecurity%2Fadvisories%2FGHSA-7w47-3wg8-547c)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FGitoxideLabs%2Fgitoxide%2Fsecurity%2Fadvisories%2FGHSA-7w47-3wg8-547c)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=GitoxideLabs%2Fgitoxide)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[GitoxideLabs](/GitoxideLabs)
/
**[gitoxide](/GitoxideLabs/gitoxide)**
Public

* [Notifications](/login?return_to=%2FGitoxideLabs%2Fgitoxide) You must be signed in to change notification settings
* [Fork
  320](/login?return_to=%2FGitoxideLabs%2Fgitoxide)
* [Star
   9.3k](/login?return_to=%2FGitoxideLabs%2Fgitoxide)

* [Code](/GitoxideLabs/gitoxide)
* [Issues
  106](/GitoxideLabs/gitoxide/issues)
* [Pull requests
  2](/GitoxideLabs/gitoxide/pulls)
* [Discussions](/GitoxideLabs/gitoxide/discussions)
* [Actions](/GitoxideLabs/gitoxide/actions)
* [Projects
  1](/GitoxideLabs/gitoxide/projects)
* [Security](/GitoxideLabs/gitoxide/security)
* [Insights](/GitoxideLabs/gitoxide/pulse)

Additional navigation options

* [Code](/GitoxideLabs/gitoxide)
* [Issues](/GitoxideLabs/gitoxide/issues)
* [Pull requests](/GitoxideLabs/gitoxide/pulls)
* [Discussions](/GitoxideLabs/gitoxide/discussions)
* [Actions](/GitoxideLabs/gitoxide/actions)
* [Projects](/GitoxideLabs/gitoxide/projects)
* [Security](/GitoxideLabs/gitoxide/security)
* [Insights](/GitoxideLabs/gitoxide/pulse)

# Traversal outside working tree enables arbitrary code execution

High

[Byron](/Byron)
published
GHSA-7w47-3wg8-547c
May 22, 2024

## Package

cargo

gitoxide
([Rust](/advisories?query=ecosystem%3Arust))

## Affected versions

< 0.36.0

## Patched versions

>= 0.36.0

cargo

gitoxide-core
([Rust](/advisories?query=ecosystem%3Arust))

< 0.38.0

>= 0.38.0

cargo

gix
([Rust](/advisories?query=ecosystem%3Arust))

< 0.63.0

>= 0.63.0

cargo

gix-fs
([Rust](/advisories?query=ecosystem%3Arust))

< 0.11.0

>= 0.11.0

cargo

gix-index
([Rust](/advisories?query=ecosystem%3Arust))

< 0.33.0

>= 0.33.0

cargo

gix-worktree
([Rust](/advisories?query=ecosystem%3Arust))

< 0.34.0

>= 0.34.0

cargo

gix-worktree-state
([Rust](/advisories?query=ecosystem%3Arust))

< 0.11.0

>= 0.11.0

## Description

### Summary

During checkout, gitoxide does not verify that paths point to locations in the working tree. A specially crafted repository can, when cloned, place new files anywhere writable by the application.

### Details

Although `gix-worktree-state` checks for collisions with existing files, it does not itself check if a path is really in the working tree when performing a checkout, nor do the path checks in `gix-fs` and `gix-worktree` prevent this. Cloning an untrusted repository containing specially crafted tree or blob names will create new files outside the repository, or inside the repository or a submodule's `.git` directory. The simplest cases are:

* A tree named `..` to traverse upward. This facilitates arbitrary code execution because files can be placed in one or more locations where they are likely to be executed soon.
* A tree named `.git` to enter a `.git` directory. This facilitates arbitrary code execution because hooks can be installed.

A number of alternatives that achieve the same effect are also possible, some of which correspond to specific vulnerabilities that have affected Git in the past:

* A tree or blob whose name contains one or more `/`, to traverse upward or downward. For example, even without containing any tree named `..` or `.git`, a repository can represent a file named `../outside` or `.git/hooks/pre-commit`. This is distinct from the more intuitive case a repository containing trees that represent those paths.
* In Windows, a tree or blob whose name contains one or more `\`, to traverse upward or downward. (Unlike `/`, these are valid on other systems.) See [GHSA-xjx4-8694-q2fq](https://github.com/git/git/security/advisories/GHSA-xjx4-8694-q2fq).
* On a case-insensitive filesystem (such as NTFS, APFS, or HFS+), a tree named as a case variant of `.git`.
* On HFS+, a tree named like `.git` or a case variant, with characters added that HFS+ ignores [in collation](https://developer.apple.com/library/archive/technotes/tn/tn1150.html#StringComparisonAlgorithm). See [git/git@6162a1d](https://github.com/git/git/commit/6162a1d323d24fd8cbbb1a6145a91fb849b2568f).
* On NTFS, a tree equivalent to `.git` (or a case variant) by the use of [NTFS stream](https://learn.microsoft.com/en-us/openspecs/windows_protocols/ms-fscc/c54dec26-1551-4d3a-a0ea-4fa40f848eb3) notation, such as `.git::$INDEX_ALLOCATION`. See [GHSA-5wph-8frv-58vj](https://github.com/git/git/security/advisories/GHSA-5wph-8frv-58vj).
* On an NTFS volume with [8.3 aliasing](https://learn.microsoft.com/en-us/windows/win32/fileio/naming-a-file#short-vs-long-names) enabled, a tree named as `git~1` (or a case variant). See [GHSA-589j-mmg9-733v](https://github.com/git/git/security/advisories/GHSA-589j-mmg9-733v).

When a checkout creates some files outside the repository directory but fails to complete, the repository directory is usually removed, but the outside files remain.

### PoC

For simplicity, these examples stage a stand-in file with a valid name, modify the index, and commit. The instructions assume `sed` supports `-i`, which is the case on most systems. If using Windows, a Git Bash shell should be used.

#### Example: Downward traversal to install hooks

1. Create a new repository with `git init dangerous-repo-installs-hook` and `cd` into the directory.
2. Create the stand-in called `.git@hooks@pre-commit`, with the *contents*:
   ```
   #!/bin/sh
   printf 'Vulnerable!\n'
   date >vulnerable
   ```
3. Stage the stand-in: `git add --chmod=+x .git@hooks@pre-commit`
4. Edit the index: `env LC_ALL=C sed -i.orig 's|\.git@hooks@pre-commit|.git/hooks/pre-commit|' .git/index`
5. Commit: `git commit -m 'Initial commit'`
6. *Optionally*, push to a private remote.

Then, on another or the same machine:

1. Clone the repository with a `gix clone …` command.
2. Enter the newly created directory.
3. *Optionally* run `ls -l .git/hooks` to observe that the `pre-commit` hook is already present.
4. Make a new file and commit it with `git`. This causes the payload surreptitiously installed as a `pre-commit` hook to run, printing the message `Vulnerable!` and creating a file in the current directory containing the current date and time.

Note that the effect is not limited to modifying the current directory. The payload could be written to perform any action that the user who runs `git commit` is capable of.

#### Example: Upward traversal to create a file above the working tree

1. Create a new repository with `git init dangerous-repo-reaches-up`, and `cd` into the directory.
2. Create the stand-in: `echo 'A file outside the working tree, somehow.' >..@outside`
3. Stage the stand-in: `git add ..@outside`
4. Edit the index: `env LC_ALL=C sed -i.orig 's|\.\.@outside|../outside|' .git/index`
5. Commit: `git commit -m 'Initial commit'`
6. *Optionally*, push to a private remote.

Then, as above, on the same or another machine, clone the repository with a `gix clone …` command. Observe that a file named `outside` is present alongside (not inside) the cloned directory.

### Impact

Any use of `gix` or another application that makes use of `gix-worktree-state`, or otherwise relies on `gix-fs` and `gix-worktree` for validation, is affected, if used to clone untrusted repositories. The above description focuses on code execution, as that leads to a complete loss of confidentiality, integrity, and availability, but creating files outside a working tree without attempting to execute code can directly impact integrity as well.

In use cases where no untrusted repository is ever cloned, this vulnerability has no impact. Furthermore, the impact of this vulnerability *may* be lower when `gix` is used to clone a repository for CI/CD purposes, even if untrusted, since in such uses the environment is usually isolated and arbitrary code is usually run deliberately from the repository with necessary safeguards in place.

### Severity

High

8.8

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Network

Attack complexity
Low

Privileges required
None

User interaction
Required

Scope
Unchanged

Confidentiality
High

Integrity
High

Availability
High

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H

### CVE ID

CVE-2024-35186

### Weaknesses

[CWE-23](/advisories?query=cwe%3A23)

### Credits

* [![@EliahKagan](https://avatars.githubusercontent.com/u/1771172?s=40&v=4)](/EliahKagan)
  [EliahKagan](/EliahKagan)
  Reporter
* [![@Byron](https://avatars.githubusercontent.com/u/63622?s=40&v=4)](/Byron)
  [Byron](/Byron)
  Remediation developer

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


