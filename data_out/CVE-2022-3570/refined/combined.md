=== Content from lists.debian.org_0fe7c53f_20250108_121047.html ===


---

[[Date Prev](msg00017.html)][[Date Next](msg00019.html)]
[[Thread Prev](msg00017.html)][[Thread Next](msg00019.html)]
[[Date Index](maillist.html#00018)]
[[Thread Index](threads.html#00018)]

# [SECURITY] [DLA 3278-1] tiff security update

---

* *To*: debian-lts-announce@lists.debian.org
* *Subject*: [SECURITY] [DLA 3278-1] tiff security update
* *From*: Sylvain Beucler <beuc@beuc.net>
* *Date*: Fri, 20 Jan 2023 23:37:38 +0100
* *Message-id*: <[[ðŸ”Ž]](/msgid-search/20230120223738.GA3389%40mail.beuc.net)Â [20230120223738.GA3389@mail.beuc.net](msg00018.html)>
* *Mail-followup-to*: debian-lts@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

- -------------------------------------------------------------------------
Debian LTS Advisory DLA-3278-1                debian-lts@lists.debian.org
<https://www.debian.org/lts/security/>                      Sylvain Beucler
January 20, 2023                              <https://wiki.debian.org/LTS>
- -------------------------------------------------------------------------

Package        : tiff
Version        : 4.1.0+git191117-2~deb10u5
CVE ID         : CVE-2022-1354 CVE-2022-1355 CVE-2022-2056 CVE-2022-2057
                 CVE-2022-2058 CVE-2022-2867 CVE-2022-2868 CVE-2022-2869
                 CVE-2022-3570 CVE-2022-3597 CVE-2022-3598 CVE-2022-3599
                 CVE-2022-3626 CVE-2022-3627 CVE-2022-3970 CVE-2022-34526
Debian Bug     : 1011160 1014494 1022555 1024737

Multiple vulnerabilities were found in tiff, a library and tools
providing support for the Tag Image File Format (TIFF), leading to
denial of service (DoS) and possibly local code execution.

CVE-2022-1354

    A heap buffer overflow flaw was found in Libtiffs' tiffinfo.c in
    TIFFReadRawDataStriped() function. This flaw allows an attacker to
    pass a crafted TIFF file to the tiffinfo tool, triggering a heap
    buffer overflow issue and causing a crash that leads to a denial
    of service.

CVE-2022-1355

    A stack buffer overflow flaw was found in Libtiffs' tiffcp.c in
    main() function. This flaw allows an attacker to pass a crafted
    TIFF file to the tiffcp tool, triggering a stack buffer overflow
    issue, possibly corrupting the memory, and causing a crash that
    leads to a denial of service.

CVE-2022-2056, CVE-2022-2057, CVE-2022-2058

    Divide By Zero error in tiffcrop allows attackers to cause a
    denial-of-service via a crafted tiff file.

CVE-2022-2867, CVE-2022-2868, CVE-2022-2869

    libtiff's tiffcrop utility has underflow and input validation flaw
    that can lead to out of bounds read and write. An attacker who
    supplies a crafted file to tiffcrop (likely via tricking a user to
    run tiffcrop on it with certain parameters) could cause a crash or
    in some cases, further exploitation.

CVE-2022-3570, CVE-2022-3598

    Multiple heap buffer overflows in tiffcrop.c utility in libtiff
    allows attacker to trigger unsafe or out of bounds memory access
    via crafted TIFF image file which could result into application
    crash, potential information disclosure or any other
    context-dependent impact.

CVE-2022-3597, CVE-2022-3626, CVE-2022-3627

    Out-of-bounds write, allowing attackers to cause a
    denial-of-service via a crafted tiff file.

CVE-2022-3599

    Out-of-bounds read in writeSingleSection in tools/tiffcrop.c,
    allowing attackers to cause a denial-of-service via a crafted tiff
    file.

CVE-2022-3970

    Affects the function TIFFReadRGBATileExt of the file
    libtiff/tif_getimage.c. The manipulation leads to integer
    overflow.

CVE-2022-34526

    A stack overflow was discovered in the _TIFFVGetField function of
    Tiffsplit. This vulnerability allows attackers to cause a Denial
    of Service (DoS) via a crafted TIFF file parsed by the "tiffsplit"
    or "tiffcrop" utilities.

For Debian 10 buster, these problems have been fixed in version
4.1.0+git191117-2~deb10u5.

We recommend that you upgrade your tiff packages.

For the detailed security status of tiff please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/tiff>

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>
-----BEGIN PGP SIGNATURE-----

iQIzBAEBCgAdFiEE1vEOfV7HXWKqBieIDTl9HeUlXjAFAmPLEPMACgkQDTl9HeUl
XjDZ+RAAqxwQGhtZtVzTTf4uI6VpIgsFNlkmqC4zUN6z8o/8UMwwXyzcbJbkkrkC
CoETLj9U+EOFRzpO+aAMUYckq3wlMKmDp2Hi2R69J99wJWqOI1uaYPQkpZtX5dCY
UJwN4QCu6rMecp9gTG/F7YfYkmgkZdG5JEvV2+w0oM295E5jJ/cqDL+9yYlNIRRG
InmYV6mLFYSw0alfysrk2QFb0XLcisfaUqw6A+LftETjAftsV1822rPBOd+r4f5Y
HGyo/Lj2xOZGhByK/4zawkdLxYlWu13hTcHGBUC3SHo+3T0zBpPPB6bjN8/E/N2P
CHGhiaUOI9qeSaub4eQs2WtUAUmpjRhZ92Tl6sIV8uJNC4SVY/qswqswBI2+Q2M4
hnQ9O0CknXCtxTJDruw2n84tQaeqV+0Ar8CnljQWgLNLuhGRqb5lz1CZ6jfpZLFI
77JRZPvXxxJ6h434Wuyc0zTImfEqYR9nbQ5eppUr3y5ScvMBoPdL2u17L/pIr7QE
CxTj5Hnf4Pam2DoWCHg1tvg9p321a89xIg6M0DtxILOCMVnNQJn0WXi3Uefj1yIb
PHlVJxxoOtcBwp1Y6Dcl4jAedqbnMUH8z3i1Rtki8LF7FbQ7keeOaZ7+M12r6A0C
AK++Xyz5eMj3IzPDexSBl6Fy4Ph0OnY3xvK93lJYiOvoe/iiWo0=
=YDjK
-----END PGP SIGNATURE-----

```

---



=== Content from security.netapp.com_2de8de2c_20250108_121047.html ===

[Skip to main content](#n-main-content)

* [NetApp.com](https://www.netapp.com/)
* [Support](https://mysupport.netapp.com)
* [Community](https://community.netapp.com)
* [Training](https://www.netapp.com/support-and-training/netapp-learning-services/)

* [Contact Us](https://www.netapp.com/company/contact-us/)

English
Ã¦Â—Â¥Ã¦ÂœÂ¬Ã¨ÂªÂž

[netapp-mark

NetApp

## Product Security](https://security.netapp.com)

Search

Search

* Search

Search

Search

* [Home](https://security.netapp.com/en)
* [Advisories](https://security.netapp.com/advisory/)
* [Bulletins](https://security.netapp.com/bulletins/)
* [Contact](https://security.netapp.com/contact/)
* [Policy](https://security.netapp.com/policy/)
* [Resources](https://security.netapp.com/resources/)
* [Certifications](https://security.netapp.com/certs/)

* [Home](https://security.netapp.com/en)
* [Advisory](https://security.netapp.com/advisory)
* [CVE-2022-3570 LibTIFF Vulnerability in NetApp Products](https://security.netapp.com/advisory/ntap-20230203-0002)

## CVE-2022-3570 LibTIFF Vulnerability in NetApp Products

circle-check-alt

This advisory should be considered the single source of current, up-to-date, authorized and accurate information from NetApp regarding Full Support products and versions.

close Ã—

#### Subscribe to NTAP-20230203-0002 updates

Email

Yes, please send me emails when NetApp Security Advisories are posted or updated.

 By filling and submitting this form, I understand and agree with the [NetApp privacy policy](https://www.netapp.com/company/legal/privacy-policy/ "Privacy Policy") and understand that I can unsubscribe from NetApp Security Advisory communications at any time.

Subscribe

#### Subscribe to NTAP-20230203-0002 advisory updates

OTP

Confirm

ionicons-v5-e

Confirmed your subscription to advisory alerts

close Ã—

#### Unsubscribe from NTAP-20230203-0002 advisory updates

Email

Unsubscribe

#### Unsubscribe from NTAP-20230203-0002 advisory updates

Email

Confirm

ionicons-v5-e

Unsubscribed successfully from advisory alerts

Subscribe to receive email updates

**Advisory ID:** NTAP-20230203-0002
**Version:**
1.0

**Last updated:**
02/03/2023

**Status:**
Final.

**CVEs:** CVE-2022-3570

Overview
#### Summary

Multiple NetApp products incorporate LibTIFF. LibTIFF versions 3.9.0 through 4.4.0 are susceptible to a vulnerability which when successfully exploited could lead to Denial of Service (DoS).

#### Impact

Successful exploitation of this vulnerability could lead to Denial of Service (DoS).

#### Vulnerability Scoring Details

| **CVE** | **Score** | **Vector** |
| --- | --- | --- |
| [CVE-2022-3570](https://nvd.nist.gov/vuln/detail/CVE-2022-3570) | 5.5 (MEDIUM) | CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:N/I:N/A:H |

#### Exploitation and Public Announcements

NetApp is aware of public discussion of this vulnerability.

Affected Products
#### Affected Products

None.

#### Products Not Affected

* 7-Mode Transition Tool
* AFF Baseboard Management Controller (BMC) - A700s
* ATTO FibreBridge - 7500N
* ATTO FibreBridge - 7600N
* Active IQ Unified Manager for Linux
* Active IQ Unified Manager for Microsoft Windows
* Active IQ Unified Manager for VMware vSphere
* Active IQ mobile app
* Astra Control Center
* Astra Control Center - NetApp Kubernetes Monitoring Operator
* Astra Trident
* Astra Trident Autosupport
* BeeGFS CSI Driver
* Brocade Fabric Operating System Firmware
* Brocade SAN Navigator (SANnav)
* Cloud Data Sense
* Cloud Insights Acquisition Unit
* Cloud Insights Telegraf Agent
* Cloud Secure Agent
* Cloud Volumes ONTAP Mediator
* E-Series BIOS
* E-Series SANtricity OS Controller Software 11.x
* E-Series SANtricity Storage Manager
* E-Series SANtricity Unified Manager and Web Services Proxy
* Element .NET SDK
* Element HealthTools
* Element JAVA SDK
* Element Plug-in for vCenter Server
* Element Powershell Tools
* Element Python SDK
* FAS/AFF BIOS - 2554/2552/2520
* FAS/AFF BIOS - 8080/8060/8040/8020
* FAS/AFF BIOS - 8300/8700/A400
* FAS/AFF BIOS - A250/500f
* FAS/AFF BIOS - A300/8200/A200/2650/2620/C190/A220/2720/2750
* FAS/AFF BIOS - A320
* FAS/AFF BIOS - A700/9000
* FAS/AFF BIOS - A700s
* FAS/AFF BIOS - A800
* FAS/AFF BIOS - A900/9500
* FAS/AFF Baseboard Management Controller (BMC) - 8300/8700/A400
* FAS/AFF Baseboard Management Controller (BMC) - A250/500f
* FAS/AFF Baseboard Management Controller (BMC) - A320/C190/A220/FAS2720/FAS2750/A800
* FAS/AFF Baseboard Management Controller (BMC) - A900/9500
* FAS/AFF Service Processor - 2554/2552/2520
* FAS/AFF Service Processor - 8080/8060/8040/8020
* FAS/AFF Service Processor - A300/8200/A200/2650/2620
* FAS/AFF Service Processor - A700/9000
* Global File Cache
* Host Utilities - SAN for Linux
* Host Utilities - SAN for Windows
* Interoperability Matrix Tool
* Inventory Collect Tool
* Management Services for Element Software and NetApp HCI
* MetroCluster Tiebreaker for clustered Data ONTAP
* Multipath I/O (SANtricity DSM for Windows MPIO)
* NetApp BlueXP
* NetApp Cloud Backup OST Plug-in (formerly AltaVault OST Plug-in)
* NetApp Converged Systems Advisor Agent
* NetApp E-Series BeeGFS Collection
* NetApp E-Series Host Collection
* NetApp E-Series Performance Analyzer
* NetApp E-Series SANtricity Collection
* NetApp HCI Baseboard Management Controller (BMC) - H300S/H500S/H700S/H410S
* NetApp HCI Baseboard Management Controller (BMC) - H410C
* NetApp HCI Baseboard Management Controller (BMC) - H610C
* NetApp HCI Baseboard Management Controller (BMC) - H610S
* NetApp HCI Baseboard Management Controller (BMC) - H615C
* NetApp HCI Compute Node (Bootstrap OS)
* NetApp HCI Compute Node BIOS
* NetApp HCI Storage Node BIOS
* NetApp Kubernetes Monitoring Operator
* NetApp Manageability SDK
* NetApp NFS Plug-in for VMware VAAI
* NetApp ONTAP PowerShell Toolkit (PSTK)
* NetApp SMI-S Provider
* NetApp SolidFire & HCI Management Node
* NetApp SolidFire & HCI Storage Node (Element Software)
* NetApp SolidFire Plug-in for vRealize Orchestrator (SolidFire vRO)
* NetApp Storage Services Connector for SAP Landscape Management
* NetApp Virtual Desktop Service (VDS)
* NetApp XCP NFS
* NetApp XCP SMB
* ONTAP 9 (formerly Clustered Data ONTAP)
* ONTAP Antivirus Connector
* ONTAP Mediator
* ONTAP Select Deploy administration utility
* ONTAP tools for VMware vSphere
* OnCommand Insight
* OnCommand Workflow Automation
* SANtricity Storage Plugin for vCenter
* SAS Firmware
* SRA Plugin for Linux
* SRA Plugin for Windows
* Single Mailbox Recovery
* Snap Creator Framework
* SnapCenter
* SnapCenter Plug-in for VMware vSphere
* SnapManager for Hyper-V
* SolidFire Storage Replication Adapter
* Spot PC
* StorageGRID (formerly StorageGRID Webscale)
* StorageGRID BIOS SG1000/SG100
* StorageGRID BIOS SG5660/SG5612/SG5760/SG5712
* StorageGRID BIOS SG6060/SGF6024
* StorageGRID Baseboard Management Controller (BMC)
* System Manager 9.x

Remediation
#### Software Versions and Fixes

None.

This section will be updated as patches are released.

#### Workarounds

None at this time.

#### Obtaining Software Fixes

Software fixes will be made available through the NetApp Support website in the Software Download section.

<https://mysupport.netapp.com/site/downloads/>

Customers who do not have access to the Support website should contact Technical Support at the number below to obtain the patches.

#### Contact Information

Check <http://mysupport.netapp.com> for further
updates.

For questions, contact NetApp at:

**Technical Support**

mysupport.netapp.com

1 888 4 NETAPP (1 888 463 8277) (U.S. and Canada)

+00 800 44 638277 (EMEA/Europe)

+800 800 80 800 (Asia/Pacific)

Revision History
#### Status of This Notice

**Final.**

This advisory should be considered the single source of current, up-to-date, authorized and accurate information from NetApp regarding Full Support products and versions.

This advisory is posted at the following link:

<https://security.netapp.com/advisory/NTAP-20230203-0002>
#### Revision History

| **Revision #** | **Date** | **Comments** |
| --- | --- | --- |
| 1.0 | 20230203 | Initial Public Release, Final status |

This document is provided solely for informational purposes. All information is based upon NetAppÃ¢Â€Â™s current knowledge and understanding of the hardware and software products tested by NetApp, and the methodology and assumptions used by NetApp. NetApp is not responsible for any errors or omissions that may be contained herein, and no warranty, representation, or other legal commitment or obligation is being provided by NetApp. Ã‚Â© 2025 NetApp, Inc. All rights reserved. No portions of this document may be reproduced without prior written consent of NetApp, Inc.

 Â©  NetApp

Have feedback for our website?
[Let us know](https://www.netapp.com/forms/site-feedback/)



=== Content from gitlab.com_62801f63_20250108_121045.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

* [cves](/gitlab-org/cves/-/tree/master)
* [2022](/gitlab-org/cves/-/tree/master/2022)
* [**CVE-2022-3570.json**](/gitlab-org/cves/-/blob/master/2022/CVE-2022-3570.json)

Find file

[Blame](/gitlab-org/cves/-/blame/master/2022/CVE-2022-3570.json)
[Permalink](/gitlab-org/cves/-/blob/c6a6f86828227186d5080abce4d5f88d42571ec9/2022/CVE-2022-3570.json "Go to permalink <kbd class='flat ml-1' aria-hidden=true>y</kbd>")

* [![ðŸ¤– GitLab Bot ðŸ¤–'s avatar](/uploads/-/system/user/avatar/1786152/avatar.png?width=64 "ðŸ¤– GitLab Bot ðŸ¤–")](/gitlab-bot)

  Oct 21, 2022

  [b51a7998](/gitlab-org/cves/-/commit/b51a7998ab9a1f50fa0609c1554bef4578cc6534)
  [Publishing 0 updated advisories and 1 new advisories](/gitlab-org/cves/-/commit/b51a7998ab9a1f50fa0609c1554bef4578cc6534)
  Â·
  b51a7998

  [ðŸ¤– GitLab Bot ðŸ¤–](/gitlab-bot) authored Oct 21, 2022

  b51a7998

  [Publishing 0 updated advisories and 1 new advisories](/gitlab-org/cves/-/commit/b51a7998ab9a1f50fa0609c1554bef4578cc6534)
  [ðŸ¤– GitLab Bot ðŸ¤–](/gitlab-bot) authored Oct 21, 2022

Loading



=== Content from www.debian.org_8316556a_20250108_121048.html ===


---

[[Date Prev](msg00020.html)][[Date Next](msg00022.html)]
[[Thread Prev](msg00020.html)][[Thread Next](msg00022.html)]
[[Date Index](maillist.html#00021)]
[[Thread Index](threads.html#00021)]

# [SECURITY] [DSA 5333-1] tiff security update

---

* *To*: debian-security-announce@lists.debian.org
* *Subject*: [SECURITY] [DSA 5333-1] tiff security update
* *From*: Aron Xu <aron@debian.org>
* *Date*: Sun, 29 Jan 2023 12:55:02 +0000
* *Message-id*: <[[ðŸ”Ž]](/msgid-search/E1pM7D4-001XO9-D9%40seger.debian.org)Â [E1pM7D4-001XO9-D9@seger.debian.org](msg00021.html)>
* *Reply-to*: debian-security-announce-request@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

- -------------------------------------------------------------------------
Debian Security Advisory DSA-5333-1                   security@debian.org
<https://www.debian.org/security/>                                  Aron Xu
January 29, 2023                      <https://www.debian.org/security/faq>
- -------------------------------------------------------------------------

Package        : tiff
CVE ID         : CVE-2022-1354 CVE-2022-1355 CVE-2022-1622 CVE-2022-1623
                 CVE-2022-2056 CVE-2022-2057 CVE-2022-2058 CVE-2022-2519
                 CVE-2022-2520 CVE-2022-2521 CVE-2022-2867 CVE-2022-2868
                 CVE-2022-2869 CVE-2022-2953 CVE-2022-3570 CVE-2022-3597
                 CVE-2022-3599 CVE-2022-3627 CVE-2022-3636 CVE-2022-34526
                 CVE-2022-48281
Debian Bug     : 1011160 1014494 1022555 1024737 1029653

Several buffer overflow, divide by zero or out of bounds read/write
vulnerabilities were discovered in tiff, the Tag Image File Format (TIFF)
library and tools, which may cause denial of service when processing a
crafted TIFF image.

For the stable distribution (bullseye), these problems have been fixed in
version 4.2.0-1+deb11u3.

We recommend that you upgrade your tiff packages.

For the detailed security status of tiff please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/tiff>

Further information about Debian Security Advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://www.debian.org/security/>

Mailing list: debian-security-announce@lists.debian.org
-----BEGIN PGP SIGNATURE-----

iQEzBAEBCAAdFiEEhhz+aYQl/Bp4OTA7O1LKKgqv2VQFAmPWbCMACgkQO1LKKgqv
2VSytwgAhwPmD658VKUyf76i4kD+dO2fioMClzNZNZgXz9CxWPn18j67dphNDQkx
K3b/Vd9n/FMnmi7hApNdUtEXdorq0355UIT4tI6IMxuywEdAou4vCl83KXx7a6xR
Hgzap+e+fRma3TS3NvlrvnXm02RMvULEo/QVs2/5B/cxmaPDEFpKzwXoQwO87Ozi
fK7W6LkH6GqhC/cgGoIFjR8n9EBVY6BBzgbardsrxVElspQNrfeKg1O5L7Y26ql9
bp8YwMpEfSPxX69u/75xGiT3fQpMiGsLUEUAOrGynZH1jtyTPPzGDMd+VG1S8fQU
vZ+ZLnm2nAHBx+1YaGZNBcW8ocY2jA==
=NMoP
-----END PGP SIGNATURE-----

```

---



=== Content from gitlab.com_32b23efb_20250108_121046.html ===


[Skip to content](#content-body)
GitLab

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

**Commit
bd94a9b3**

authored
Aug 22, 2022
by
**[![Su Laus's avatar](https://secure.gravatar.com/avatar/9302b5b3a440794ecd15395e8e5b972820cfe3e05b149fba3fd58835989b2b5d?s=96&d=identicon "Su Laus")](/Su_Laus)
[Su Laus](/Su_Laus)**

[Browse files](/libtiff/libtiff/-/tree/bd94a9b383d8755a27b5a1bc27660b8ad10b094c)

### tiffcrop subroutines require a larger buffer (fixes [#271](/libtiff/libtiff/-/issues/271 "Heap buffer overflow in extractContigSamples32bits, tiffcrop.c:3144"), [#381](/libtiff/libtiff/-/issues/381 "/tools/tiffcrop.c:8322 - Heap buffer overflow in rotateContigSamples24bits"), [#386](/libtiff/libtiff/-/issues/386 "tools/tiffcrop.c:3142 - Heap Buffer overflow in extractContigSamples32bits"), [#388](/libtiff/libtiff/-/issues/388 "/tools/tiffcrop.c:3416 - Heap buffer overflow in ExtractContigSamplesShifted24Bits"), [#389](/libtiff/libtiff/-/issues/389 "tools/tiffcrop.c:8899 - Heap buffer overflow in reverseSamples24bits"), [#435](/libtiff/libtiff/-/issues/435 "tiffcrop: heap-buffer-overflow in extractContigSamplesShifted24bits, tiffcrop.c:3604"))

```

Buffer overflows have been fixed by making the buffers at least 3 bytes larger than the image itself needs.
This is required for some tiffcrop conversion subroutines.

In addition, some integer casting warnings have been fixed.

Closes issues [#271](/libtiff/libtiff/-/issues/271 "Heap buffer overflow in extractContigSamples32bits, tiffcrop.c:3144"), [#381](/libtiff/libtiff/-/issues/381 "/tools/tiffcrop.c:8322  -  Heap buffer overflow in rotateContigSamples24bits"), [#386](/libtiff/libtiff/-/issues/386 "tools/tiffcrop.c:3142 - Heap Buffer overflow in extractContigSamples32bits"), [#388](/libtiff/libtiff/-/issues/388 "/tools/tiffcrop.c:3416 - Heap buffer overflow in ExtractContigSamplesShifted24Bits"), [#389](/libtiff/libtiff/-/issues/389 "tools/tiffcrop.c:8899 - Heap buffer overflow in reverseSamples24bits") and [#435](/libtiff/libtiff/-/issues/435 "tiffcrop: heap-buffer-overflow in extractContigSamplesShifted24bits, tiffcrop.c:3604").
```

parent
[48d6ece8](/libtiff/libtiff/-/commit/48d6ece8389b01129e7d357f0985c8f938ce3da3)

Loading

Loading

Loading

* [Changes
  1](/libtiff/libtiff/-/commit/bd94a9b383d8755a27b5a1bc27660b8ad10b094c)

[Expand all](/libtiff/libtiff/-/commit/bd94a9b383d8755a27b5a1bc27660b8ad10b094c?expanded=1)
[Hide whitespace changes](/libtiff/libtiff/-/commit/bd94a9b383d8755a27b5a1bc27660b8ad10b094c?action=show&controller=projects%2Fcommit&id=bd94a9b383d8755a27b5a1bc27660b8ad10b094c&namespace_id=libtiff&project_id=libtiff&w=1)
[Inline](/libtiff/libtiff/-/commit/bd94a9b383d8755a27b5a1bc27660b8ad10b094c?view=inline)
[Side-by-side](/libtiff/libtiff/-/commit/bd94a9b383d8755a27b5a1bc27660b8ad10b094c?view=parallel)

Loading

* [Chintan Shah](/shahcs)
  @shahcs

  mentioned in issue [gitlab-org/cves#479 (closed)](/gitlab-org/cves/-/issues/479 "Multiple Heap buffer overflows in tiffcrop utility of libtiff version 4.4.0")

  Â·

  [Aug 24, 2022](#note_1075668330)

  mentioned in issue [gitlab-org/cves#479 (closed)](/gitlab-org/cves/-/issues/479 "Multiple Heap buffer overflows in tiffcrop utility of libtiff version 4.4.0")

  mentioned in issue gitlab-org/cves#479

  Toggle commit list

Preview

0%
Loading

Try again

or
attach a new file

.

Cancel

You are about to add
**0
people**
to the discussion. Proceed with caution.

Finish editing this message first!

Save comment

Cancel

Please [register](/users/sign_up?redirect_to_referer=yes) or [sign in](/users/sign_in?redirect_to_referer=yes) to comment



=== Content from gitlab.com_d726ddf9_20250108_121047.html ===


[Skip to content](#content-body)
GitLab

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

# tools/tiffcrop.c:3142 - Heap Buffer overflow in extractContigSamples32bits

Summary -(Summarize the bug encountered concisely)

There is a Heap buffer overflow in /tools/tiffcrop.c:3142 in extractContigSamples32bits function

Version - (libtiff version)

```
root@ubuntu:/home/libtiff/tools# ./tiffcrop -v
Library Release: LIBTIFF, Version 4.3.0
Copyright (c) 1988-1996 Sam Leffler
Copyright (c) 1991-1996 Silicon Graphics, Inc.
Tiffcrop version: 2.4, last updated: 12-13-2010
Tiffcp code: Copyright (c) 1988-1997 Sam Leffler
           : Copyright (c) 1991-1997 Silicon Graphics, Inc
Tiffcrop additions: Copyright (c) 2007-2010 Richard Nolde

```

Steps to reproduce - (How one can reproduce the issue - this is very important)

```
Clone the latest source from the gitlab repository - git clone https://gitlab.com/libtiff/libtiff.git
cd libtiff

compile the source using the following command :

CC=gcc CXX=g++ CFLAGS="-ggdb -fsanitize=address,undefined -fno-sanitize-recover=all" CXXFLAGS="-ggdb -fsanitize=address,undefined -fno-sanitize-recover=all" LDFLAGS="-fsanitize=address,undefined -fno-sanitize-recover=all -lm" ./configure --disable-shared

Reproduce the crash with the following commmand :

./tiffcrop -i -E l -H 10 -V 10 -S 8:4 -R 270 poc.tif a.tif

```

Platform - (Operating system, architecture, compiler details)

```
gcc --version
gcc (Ubuntu 9.3.0-17ubuntu1~20.04) 9.3.0
Copyright (C) 2019 Free Software Foundation, Inc.
This is free software; see the source for copying conditions.  There is NO
warranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.

uname -r
5.13.0-28-generic

uname -a
Linux ubuntu 5.13.0-28-generic #31~20.04.1-Ubuntu SMP Wed Jan 19 14:08:10 UTC 2022 x86_64 x86_64 x86_64 GNU/Linux

lsb_release -a
No LSB modules are available.
Distributor ID:	Ubuntu
Description:	Ubuntu 20.04.3 LTS
Release:	20.04
Codename:	focal
```

* Address Sanitizer Logs ( ASAN )

```
TIFFReadDirectoryCheckOrder: Warning, Invalid TIFF directory; tags are not sorted in ascending order.
TIFFReadDirectory: Warning, Unknown field with tag 57568 (0xe0e0) encountered.
TIFFReadDirectory: Warning, Unknown field with tag 1028 (0x404) encountered.
TIFFReadDirectory: Warning, Unknown field with tag 1 (0x1) encountered.
TIFFFetchNormalTag: Warning, ASCII value for tag "Model" does not end in null byte.
TIFFReadDirectory: Warning, TIFF directory is missing required "StripByteCounts" field, calculating from imagelength.
TIFFAdvanceDirectory: Error fetching directory count.
loadImage: Image lacks Photometric interpretation tag.
=================================================================
==2014==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x602000000210 at pc 0x55bbcdc5bb9a bp 0x7fff3dbae7c0 sp 0x7fff3dbae7b0
READ of size 4 at 0x602000000210 thread T0
    #0 0x55bbcdc5bb99 in extractContigSamples32bits /home/targets/libtiff/tools/tiffcrop.c:3142
    #1 0x55bbcdc70529 in extractContigSamplesToBuffer /home/targets/libtiff/tools/tiffcrop.c:3627
    #2 0x55bbcdc70529 in writeBufferToSeparateStrips /home/targets/libtiff/tools/tiffcrop.c:1218
    #3 0x55bbcdc7d4b9 in writeSingleSection /home/targets/libtiff/tools/tiffcrop.c:7377
    #4 0x55bbcdc3ce20 in writeImageSections /home/targets/libtiff/tools/tiffcrop.c:7104
    #5 0x55bbcdc3ce20 in main /home/targets/libtiff/tools/tiffcrop.c:2451
    #6 0x7f20439f70b2 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x270b2)
    #7 0x55bbcdc434ed in _start (/home/targets/libtiff/tools/tiffcrop+0x324ed)

0x602000000213 is located 0 bytes to the right of 3-byte region [0x602000000210,0x602000000213)
allocated by thread T0 here:
    #0 0x7f2043e3abc8 in malloc (/lib/x86_64-linux-gnu/libasan.so.5+0x10dbc8)
    #1 0x55bbcdc3d94d in createImageSection /home/targets/libtiff/tools/tiffcrop.c:7402
    #2 0x55bbcdc3d94d in writeImageSections /home/targets/libtiff/tools/tiffcrop.c:7090
    #3 0x55bbcdc3d94d in main /home/targets/libtiff/tools/tiffcrop.c:2451

SUMMARY: AddressSanitizer: heap-buffer-overflow /home/targets/libtiff/tools/tiffcrop.c:3142 in extractContigSamples32bits
Shadow bytes around the buggy address:
  0x0c047fff7ff0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x0c047fff8000: fa fa 00 00 fa fa fd fa fa fa 02 fa fa fa fd fa
  0x0c047fff8010: fa fa fd fa fa fa fd fa fa fa 02 fa fa fa fd fa
  0x0c047fff8020: fa fa fd fa fa fa fd fa fa fa 00 fa fa fa 00 fa
  0x0c047fff8030: fa fa fd fd fa fa fd fd fa fa fd fa fa fa 00 04
=>0x0c047fff8040: fa fa[03]fa fa fa 02 fa fa fa 02 fa fa fa 06 fa
  0x0c047fff8050: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c047fff8060: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c047fff8070: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c047fff8080: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c047fff8090: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
Shadow byte legend (one shadow byte represents 8 application bytes):
  Addressable:           00
  Partially addressable: 01 02 03 04 05 06 07
  Heap left redzone:       fa
  Freed heap region:       fd
  Stack left redzone:      f1
  Stack mid redzone:       f2
  Stack right redzone:     f3
  Stack after return:      f5
  Stack use after scope:   f8
  Global redzone:          f9
  Global init order:       f6
  Poisoned by user:        f7
  Container overflow:      fc
  Array cookie:            ac
  Intra object redzone:    bb
  ASan internal:           fe
  Left alloca redzone:     ca
  Right alloca redzone:    cb
  Shadow gap:              cc
==2014==ABORTING

```[poc.zip](/uploads/4df5ce99cd3cbed76031489ef39f12fb/poc.zip)
```

Edited Feb 24, 2022 by [Chintan Shah](/shahcs)

Assignee
Loading

Time tracking
Loading

Confidentiality

Confidentiality controls have moved to the issue actions menu () at the top of the page.



=== Content from gitlab.com_2db58eaa_20250108_121046.html ===


[Skip to content](#content-body)
GitLab

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

# /tools/tiffcrop.c:8322 - Heap buffer overflow in rotateContigSamples24bits

Summary - (Summarize the bug encountered concisely)

There is a Heap buffer overflow in /tools/tiffcrop.c:8322 in rotateContigSamples24bits function

Version

```
root@ubuntu:/home/tlibtiff/tools# ./tiffcrop -v
Library Release: LIBTIFF, Version 4.3.0
Copyright (c) 1988-1996 Sam Leffler
Copyright (c) 1991-1996 Silicon Graphics, Inc.
Tiffcrop version: 2.4, last updated: 12-13-2010
Tiffcp code: Copyright (c) 1988-1997 Sam Leffler
           : Copyright (c) 1991-1997 Silicon Graphics, Inc
Tiffcrop additions: Copyright (c) 2007-2010 Richard Nolde
```

Steps to reproduce - (How one can reproduce the issue - this is very important)

```
Clone the latest source from the gitlab repository - git clone https://gitlab.com/libtiff/libtiff.git
cd libtiff

compile the source using the following command :

CC=gcc CXX=g++ CFLAGS="-ggdb -fsanitize=address,undefined -fno-sanitize-recover=all" CXXFLAGS="-ggdb -fsanitize=address,undefined -fno-sanitize-recover=all" LDFLAGS="-fsanitize=address,undefined -fno-sanitize-recover=all -lm" ./configure --disable-shared

Reproduce the crash with the following commmand :

./tiffcrop -i -E l -H 10 -V 10 -S 8:4 -R 270 poc.tif a.tif

```

Platform - (Operating system, architecture, compiler details)

```
gcc --version
gcc (Ubuntu 9.3.0-17ubuntu1~20.04) 9.3.0
Copyright (C) 2019 Free Software Foundation, Inc.
This is free software; see the source for copying conditions.  There is NO
warranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.

uname -r
5.13.0-28-generic

uname -a
Linux ubuntu 5.13.0-28-generic #31~20.04.1-Ubuntu SMP Wed Jan 19 14:08:10 UTC 2022 x86_64 x86_64 x86_64 GNU/Linux

lsb_release -a
No LSB modules are available.
Distributor ID:	Ubuntu
Description:	Ubuntu 20.04.3 LTS
Release:	20.04
Codename:	focal

```

* AddressSanitizer logs ( ASAN )

```

TIFFReadDirectoryCheckOrder: Warning, Invalid TIFF directory; tags are not sorted in ascending order.
TIFFReadDirectory: Warning, Unknown field with tag 65535 (0xffff) encountered.
TIFFFetchNormalTag: Warning, Incompatible type for "SubIFD"; tag ignored.
TIFFFetchNormalTag: Warning, incorrect count for field "PageNumber", expected 2, got 240.
TIFFReadDirectory: Warning, Sum of Photometric type-related color channels and ExtraSamples doesn't match SamplesPerPixel. Defining non-color channels as ExtraSamples..
PredictorSetup: Horizontal differencing "Predictor" not supported with 1-bit samples.
=================================================================
==3072446==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x602000000111 at pc 0x5645942e9ca1 bp 0x7ffc752e2770 sp 0x7ffc752e2760
READ of size 4 at 0x602000000111 thread T0
    #0 0x5645942e9ca0 in rotateContigSamples24bits /home/targets/libtiff/tools/tiffcrop.c:8322
    #1 0x5645942fa085 in rotateImage /home/targets/libtiff/tools/tiffcrop.c:8675
    #2 0x5645942e202f in createCroppedImage /home/targets/libtiff/tools/tiffcrop.c:7771
    #3 0x5645942e202f in main /home/targets/libtiff/tools/tiffcrop.c:2404
    #4 0x7f6e4b6680b2 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x270b2)
    #5 0x5645942e64ed in _start (/home/targets/libtiff/tools/tiffcrop+0x324ed)

0x602000000114 is located 0 bytes to the right of 4-byte region [0x602000000110,0x602000000114)
allocated by thread T0 here:
    #0 0x7f6e4baabbc8 in malloc (/lib/x86_64-linux-gnu/libasan.so.5+0x10dbc8)
    #1 0x5645942f81c1 in rotateImage /home/targets/libtiff/tools/tiffcrop.c:8479

SUMMARY: AddressSanitizer: heap-buffer-overflow /home/targets/libtiff/tools/tiffcrop.c:8322 in rotateContigSamples24bits
Shadow bytes around the buggy address:
  0x0c047fff7fd0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x0c047fff7fe0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x0c047fff7ff0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x0c047fff8000: fa fa 00 00 fa fa fd fa fa fa 04 fa fa fa fd fa
  0x0c047fff8010: fa fa 00 fa fa fa fd fa fa fa 00 fa fa fa fd fa
=>0x0c047fff8020: fa fa[04]fa fa fa 04 fa fa fa fa fa fa fa fa fa
  0x0c047fff8030: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c047fff8040: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c047fff8050: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c047fff8060: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c047fff8070: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
Shadow byte legend (one shadow byte represents 8 application bytes):
  Addressable:           00
  Partially addressable: 01 02 03 04 05 06 07
  Heap left redzone:       fa
  Freed heap region:       fd
  Stack left redzone:      f1
  Stack mid redzone:       f2
  Stack right redzone:     f3
  Stack after return:      f5
  Stack use after scope:   f8
  Global redzone:          f9
  Global init order:       f6
  Poisoned by user:        f7
  Container overflow:      fc
  Array cookie:            ac
  Intra object redzone:    bb
  ASan internal:           fe
  Left alloca redzone:     ca
  Right alloca redzone:    cb
  Shadow gap:              cc
==3072446==ABORTING

```[poc.zip](/uploads/e3c1b7d35fbb9e8f44b48f6f7fbaa0f2/poc.zip)
```

Edited Feb 17, 2022 by [Chintan Shah](/shahcs)

Assignee
Loading

Time tracking
Loading

Confidentiality

Confidentiality controls have moved to the issue actions menu () at the top of the page.


