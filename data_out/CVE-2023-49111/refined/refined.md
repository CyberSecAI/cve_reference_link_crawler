Based on the provided content, here's an analysis of CVE-2023-49111:

**Vulnerability:** Reflected Cross-Site Scripting (XSS)

**Root Cause:**
- The Kiuwan application's login page includes user-provided input (specifically, the "message" parameter) directly into a JavaScript block within the HTML response without proper sanitization or encoding.

**Weaknesses/Vulnerabilities:**
- Reflected XSS: User-supplied data is reflected back in the response without proper escaping, allowing an attacker to inject malicious JavaScript code.

**Impact of Exploitation:**
- **Stealing Credentials:** In environments using Single Sign-On (SSO) authentication, particularly with Active Directory (AD) via ADFS, an attacker can steal AD passwords by injecting malicious JavaScript that captures the user's input or redirects them to a fake login page.
- **Session Hijacking:** An attacker could potentially hijack a user's session by stealing session cookies through injected JavaScript.
- **Malicious Actions:** An attacker could execute arbitrary JavaScript code within the user's browser, leading to various malicious actions, such as data exfiltration, defacement of the page, or redirection to other websites.

**Attack Vectors:**
- The attack vector is a specially crafted URL that includes the malicious JavaScript payload in the `message` parameter.

**Required Attacker Capabilities/Position:**
- The attacker needs to craft a malicious URL and convince a victim to click on it. This can be done via:
    - Phishing emails
    - Malicious links on other websites
    - Social engineering techniques

**Technical Details:**
- The vulnerability exists in the `login.html` page of Kiuwan when SSO is enabled.
- A `message` parameter in the URL is reflected into a JavaScript block in the page's response.
- The attacker can inject JavaScript via URL encoding, e.g.,  `message=x'%2Beval('alert(document.location)');//`

**Additional Notes:**
- The vulnerability is particularly severe in SSO environments because it can lead to the compromise of AD credentials.
- The injected JavaScript code is only executed when the victim has a Kiuwan domain ID cached in their browserâ€™s local storage (SSO-enabled users)
- The fix for this vulnerability was released on 2024-02-06 as part of Kiuwan version 2.8.2402.3 and Kiuwan Local Analyzer master.1808.p685.q13371