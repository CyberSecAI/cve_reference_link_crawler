=== Content from www.openwall.com_a7c61ff8_20250111_113842.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](6) [[next>]](8) [[<thread-prev]](6) [[thread-next>]](9) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID:
 <SA1PR22MB2978E752B5A2B186F0B4D9B9B5B32@SA1PR22MB2978.namprd22.prod.outlook.com>
Date: Fri, 2 Aug 2024 14:41:18 +0000
From: Dane Bouchie <dbouchie@...dimed.com>
To: Solar Designer <solar@...nwall.com>, Andri Yngvason <andri@...vason.is>
CC: "oss-security@...ts.openwall.com" <oss-security@...ts.openwall.com>,
	Travis Wise <travis@...esquared.com>, "security@...pberrypi.com"
	<security@...pberrypi.com>, Simon Long <simon@...pberrypi.com>, Moritz
 M??hlenhoff <jmm@...til.org>, Salvatore Bonaccorso <carnil@...ian.org>
Subject: RE: Neat VNC Security Vulnerability

The client chooses the security type, so they can pass in "None" to the switch statement. is_allowed_security_type() now prevents that.

Dane Bouchie | Software Engineer
dbouchie@...dimed.com | P 407.677.8022, 170
1025 Willa Springs Drive, Winter Springs, FL  32708
Iradimed.com

-----Original Message-----
From: Solar Designer <solar@...nwall.com>
Sent: Friday, August 2, 2024 10:39 AM
To: Andri Yngvason <andri@...vason.is>
Cc: oss-security@...ts.openwall.com; Dane Bouchie <dbouchie@...dimed.com>; Travis Wise <travis@...esquared.com>; security@...pberrypi.com; Simon Long <simon@...pberrypi.com>; Moritz M??hlenhoff <jmm@...til.org>; Salvatore Bonaccorso <carnil@...ian.org>
Subject: Re: [oss-security] Neat VNC Security Vulnerability

[You don't often get email from solar@...nwall.com. Learn why this is important at <https://aka.ms/LearnAboutSenderIdentification> ]

Hi Andri,

On Thu, Aug 01, 2024 at 11:05:27PM +0000, Andri Yngvason wrote:
> It has come to my attention that there is a security vulnerability in Neat VNC.
>
> I've released a new version that fixes the vulnerability:
> <https://github.com/any1/neatvnc/releases/tag/v0.8.1>

Thank you very much for bringing this to oss-security!

On oss-security, we need a description of the vulnerability, not just a note that some vulnerability existed.

The release notes mention:

"The vulnerability was reported by Dane Bouchie and Travis Wise."

Dane and/or Travis, maybe you can provide the missing detail here?

The fix commit appears to be:

Add sanity check for chosen security type
<https://github.com/any1/neatvnc/commit/cc71650a69abc2573a0d96d082409d2468802d47>

Skimming it, I see it increases the size of buf in on_version_message() from 3 to 32 security types.  That function is also split in two and otherwise refactored.  A number of "security->types[security->n++]"
lines got replaced with ADD_SECURITY_TYPE(), which has an assert() against the new maximum.  There were 4 of those lines, so I can see how a buffer for 3 could be too small.  So there was a bug.  However, none of this looks like attacker-controlled input, or is it?  Now, even without attacker-controlled input an out-of-bounds write is undefined behavior, so theoretically could result in an exploitable vulnerability via some other correctly processed input, but was there any analysis whether it commonly or realistically does in this case?

I see the commit also adds an is_allowed_security_type() check to the beginning of on_security_message().  However, the rest of that function only has a switch statement covering a few known security types and:

        default:
                security_handshake_failed(client, NULL,
                                "Unsupported security type");

The action on failing the added pre-check is almost the same.  So I don't immediately see how not pre-checking could have been problematic.

Maybe I'm missing some bigger issue also fixed by those changes?

Don't get me wrong, fixing a bug and defensive programming is great, but we also need the security impact documented.

Alexander

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from github.com_168e6579_20250111_113841.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fany1%2Fneatvnc%2Fcompare%2Fv0.8.0...v0.8.1)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fany1%2Fneatvnc%2Fcompare%2Fv0.8.0...v0.8.1)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fcompare%2Fshow&source=header-repo&source_repo=any1%2Fneatvnc)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[any1](/any1)
/
**[neatvnc](/any1/neatvnc)**
Public

* [Notifications](/login?return_to=%2Fany1%2Fneatvnc) You must be signed in to change notification settings
* [Fork
  34](/login?return_to=%2Fany1%2Fneatvnc)
* [Star
   128](/login?return_to=%2Fany1%2Fneatvnc)

* [Code](/any1/neatvnc)
* [Issues
  15](/any1/neatvnc/issues)
* [Pull requests
  5](/any1/neatvnc/pulls)
* [Discussions](/any1/neatvnc/discussions)
* [Actions](/any1/neatvnc/actions)
* [Projects
  0](/any1/neatvnc/projects)
* [Security](/any1/neatvnc/security)
* [Insights](/any1/neatvnc/pulse)

Additional navigation options

* [Code](/any1/neatvnc)
* [Issues](/any1/neatvnc/issues)
* [Pull requests](/any1/neatvnc/pulls)
* [Discussions](/any1/neatvnc/discussions)
* [Actions](/any1/neatvnc/actions)
* [Projects](/any1/neatvnc/projects)
* [Security](/any1/neatvnc/security)
* [Insights](/any1/neatvnc/pulse)

[Permalink](https://github.com/any1/neatvnc/compare/any1%3A46432ce...any1%3A0708156)
# Comparing changes

 Choose two branches to see what’s changed or to start a new pull request.
If you need to, you can also  compare across forks
 or
[learn more about diff comparisons](https://docs.github.com/pull-requests/collaborating-with-pull-requests/proposing-changes-to-your-work-with-pull-requests/about-comparing-branches-in-pull-requests#three-dot-and-two-dot-git-diff-comparisons).

# Open a pull request

 Create a new pull request by comparing changes across two branches. If you need to, you can also  compare across forks
.
[Learn more about diff comparisons here](https://docs.github.com/pull-requests/collaborating-with-pull-requests/proposing-changes-to-your-work-with-pull-requests/about-comparing-branches-in-pull-requests#three-dot-and-two-dot-git-diff-comparisons).

*base repository:*
any1/neatvnc

Failed to load repositories. Confirm that selected base ref is valid, then try again.

 Loading

*base:*
v0.8.0

Choose a base ref

Branches
Tags

Could not load branches

Nothing to show

 Loading

[{{ refName }}
default](/any1/neatvnc/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...v0.8.1)

Could not load tags

Nothing to show

[{{ refName }}
default](/any1/neatvnc/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...v0.8.1)

 Loading

...

*head repository:*
any1/neatvnc

Failed to load repositories. Confirm that selected head ref is valid, then try again.

 Loading

*compare:*
v0.8.1

Choose a head ref

Branches
Tags

Could not load branches

Nothing to show

 Loading

[{{ refName }}
default](/any1/neatvnc/compare/v0.8.0...%7B%7B%20urlEncodedRefName%20%7D%7D)

Could not load tags

Nothing to show

[{{ refName }}
default](/any1/neatvnc/compare/v0.8.0...%7B%7B%20urlEncodedRefName%20%7D%7D)

 Loading

* 2

  commits
* 3

  files changed
* 1

  contributor

### Commits on Aug 1, 2024

1. [Add sanity check for chosen security type](/any1/neatvnc/commit/cc71650a69abc2573a0d96d082409d2468802d47)

   [![@any1](https://avatars.githubusercontent.com/u/2663782?s=40&v=4)](/any1)

   [any1](/any1/neatvnc/commits?author=any1 "View all commits by any1")
   committed
   Aug 1, 2024

   Configuration menu

   * [View commit details](/any1/neatvnc/commit/cc71650a69abc2573a0d96d082409d2468802d47)
   * Copy full SHA for cc71650
   * [Browse repository at this point](/any1/neatvnc/tree/cc71650a69abc2573a0d96d082409d2468802d47)

   Copy the full SHA

    [cc71650](/any1/neatvnc/commit/cc71650a69abc2573a0d96d082409d2468802d47)View commit details

   Browse the repository at this point in the history
2. [Release v0.8.1](/any1/neatvnc/commit/07081567ab21a2b099ceb41ae8cab872a31cbb9a)

   [![@any1](https://avatars.githubusercontent.com/u/2663782?s=40&v=4)](/any1)

   [any1](/any1/neatvnc/commits?author=any1 "View all commits by any1")
   committed
   Aug 1, 2024

   Configuration menu

   * [View commit details](/any1/neatvnc/commit/07081567ab21a2b099ceb41ae8cab872a31cbb9a)
   * Copy full SHA for 0708156
   * [Browse repository at this point](/any1/neatvnc/tree/07081567ab21a2b099ceb41ae8cab872a31cbb9a)

   Copy the full SHA

    [0708156](/any1/neatvnc/commit/07081567ab21a2b099ceb41ae8cab872a31cbb9a)View commit details

   Browse the repository at this point in the history

 Loading

### This comparison is taking too long to generate.

Unfortunately it looks like we can’t render this comparison for you right now. It might be too big, or there might be something weird with your repository.

You can try running this command locally to see the comparison on your machine:

`git diff v0.8.0...v0.8.1`

  Retry

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from www.openwall.com_302aaf1e_20250111_113842.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](9) [[next>]](../../../2024/08/03/1) [[<thread-prev]](9) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <CAFNQBQwdQMYSu4cO_WwiupeQJOEyK=mSgHikCNFK4qqbNjTM=A@mail.gmail.com>
Date: Fri, 2 Aug 2024 15:00:10 +0000
From: Andri Yngvason <andri@...vason.is>
To: Solar Designer <solar@...nwall.com>
Cc: Dane Bouchie <dbouchie@...dimed.com>,
	"oss-security@...ts.openwall.com" <oss-security@...ts.openwall.com>, Travis Wise <travis@...esquared.com>,
	"security@...pberrypi.com" <security@...pberrypi.com>, Simon Long <simon@...pberrypi.com>,
	"Moritz M??hlenhoff" <jmm@...til.org>, Salvatore Bonaccorso <carnil@...ian.org>
Subject: Re: Neat VNC Security Vulnerability

fös., 2. ágú. 2024 kl. 14:53 skrifaði Solar Designer <solar@...nwall.com>:
>
> On Fri, Aug 02, 2024 at 02:41:18PM +0000, Dane Bouchie wrote:
> > The client chooses the security type, so they can pass in "None" to the switch statement. is_allowed_security_type() now prevents that.
>
> Oh, so was the issue a trivial authentication bypass?  Evidently, logic
> errors like this are easy to miss in plain sight.
>

Yes, and yes.

>         switch (type) {
>         case RFB_SECURITY_TYPE_NONE:
>                 security_handshake_ok(client, NULL);
>                 client->state = VNC_CLIENT_STATE_WAITING_FOR_INIT;
>                 break;
>
> Should the above RFB_SECURITY_TYPE_NONE support continue to exist in the
> code at all, if RFB_SECURITY_TYPE_NONE is never added to the allowed
> security types array that the code now pre-checks against?  Maybe it
> should be #if 0'ed out, leaving it only as an example for debugging?
>

It is added to the list if no authentication is required.

Regards,
Andri

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from github.com_78750b36_20250111_113840.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fany1%2Fneatvnc%2Fcommit%2Fcc71650a69abc2573a0d96d082409d2468802d47)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fany1%2Fneatvnc%2Fcommit%2Fcc71650a69abc2573a0d96d082409d2468802d47)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=any1%2Fneatvnc)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[any1](/any1)
/
**[neatvnc](/any1/neatvnc)**
Public

* [Notifications](/login?return_to=%2Fany1%2Fneatvnc) You must be signed in to change notification settings
* [Fork
  34](/login?return_to=%2Fany1%2Fneatvnc)
* [Star
   128](/login?return_to=%2Fany1%2Fneatvnc)

* [Code](/any1/neatvnc)
* [Issues
  15](/any1/neatvnc/issues)
* [Pull requests
  5](/any1/neatvnc/pulls)
* [Discussions](/any1/neatvnc/discussions)
* [Actions](/any1/neatvnc/actions)
* [Projects
  0](/any1/neatvnc/projects)
* [Security](/any1/neatvnc/security)
* [Insights](/any1/neatvnc/pulse)

Additional navigation options

* [Code](/any1/neatvnc)
* [Issues](/any1/neatvnc/issues)
* [Pull requests](/any1/neatvnc/pulls)
* [Discussions](/any1/neatvnc/discussions)
* [Actions](/any1/neatvnc/actions)
* [Projects](/any1/neatvnc/projects)
* [Security](/any1/neatvnc/security)
* [Insights](/any1/neatvnc/pulse)

## Commit

[Permalink](/any1/neatvnc/commit/cc71650a69abc2573a0d96d082409d2468802d47)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Add sanity check for chosen security type

[Browse files](/any1/neatvnc/tree/cc71650a69abc2573a0d96d082409d2468802d47)
Browse the repository at this point in the history

* Loading branch information

[![@any1](https://avatars.githubusercontent.com/u/2663782?s=40&v=4)](/any1)

[any1](/any1/neatvnc/commits?author=any1 "View all commits by any1")
committed
Aug 1, 2024

1 parent
[46432ce](/any1/neatvnc/commit/46432ce8cade0b54a38d4bb42eb07f96c8ff49fd)

commit cc71650

 Show file tree

 Hide file tree

Showing
**2 changed files**
with
**60 additions**
and
**25 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* include

  + include/common.h
    [common.h](#diff-bc020f3ca1b410d9c45f1a3e744c2b506de509f4c7063cf7755272d69283cdb4)
* src

  + src/server.c
    [server.c](#diff-1abc5651133d108c0c420d9411925373c711133e7748d9e4f4c97d5fb543fdd9)

## There are no files selected for viewing

4 changes: 4 additions & 0 deletions

4
[include/common.h](#diff-bc020f3ca1b410d9c45f1a3e744c2b506de509f4c7063cf7755272d69283cdb4 "include/common.h")

Show comments

[View file](/any1/neatvnc/blob/cc71650a69abc2573a0d96d082409d2468802d47/include/common.h)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -38,6 +38,7 @@ |
|  |  | #define MAX\_OUTGOING\_FRAMES 4 |
|  |  | #define MSG\_BUFFER\_SIZE 4096 |
|  |  | #define MAX\_CUT\_TEXT\_SIZE 10000000 |
|  |  | #define MAX\_SECURITY\_TYPES 32 |
|  |  |  |
|  |  | enum nvnc\_client\_state { |
|  |  | VNC\_CLIENT\_STATE\_ERROR = -1, |
| Expand Down  Expand Up | | @@ -167,6 +168,9 @@ struct nvnc { |
|  |  | struct crypto\_rsa\_priv\_key\* rsa\_priv; |
|  |  | #endif |
|  |  |  |
|  |  | int n\_security\_types; |
|  |  | enum rfb\_security\_type security\_types[MAX\_SECURITY\_TYPES]; |
|  |  |  |
|  |  | uint32\_t n\_damage\_clients; |
|  |  | }; |
|  |  |  |
| Expand Down | |  |

81 changes: 56 additions & 25 deletions

81
[src/server.c](#diff-1abc5651133d108c0c420d9411925373c711133e7748d9e4f4c97d5fb543fdd9 "src/server.c")

Show comments

[View file](/any1/neatvnc/blob/cc71650a69abc2573a0d96d082409d2468802d47/src/server.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -67,7 +67,6 @@ |
|  |  | #endif |
|  |  |  |
|  |  | #define DEFAULT\_NAME "Neat VNC" |
|  |  | #define SECURITY\_TYPES\_MAX 3 |
|  |  | #define APPLE\_DH\_SERVER\_KEY\_LENGTH 256 |
|  |  |  |
|  |  | #define UDIV\_UP(a, b) (((a) + (b) - 1) / (b)) |
| Expand Down  Expand Up | | @@ -215,52 +214,79 @@ static int handle\_unsupported\_version(struct nvnc\_client\* client) |
|  |  | return 0; |
|  |  | } |
|  |  |  |
|  |  | static int on\_version\_message(struct nvnc\_client\* client) |
|  |  | static void init\_security\_types(struct nvnc\* server) |
|  |  | { |
|  |  | struct nvnc\* server = client->server; |
|  |  |  |
|  |  | if (client->buffer\_len - client->buffer\_index < 12) |
|  |  | return 0; |
|  |  |  |
|  |  | char version\_string[13]; |
|  |  | memcpy(version\_string, client->msg\_buffer + client->buffer\_index, 12); |
|  |  | version\_string[12] = '\0'; |
|  |  |  |
|  |  | if (strcmp(RFB\_VERSION\_MESSAGE, version\_string) != 0) |
|  |  | return handle\_unsupported\_version(client); |
|  |  | #define ADD\_SECURITY\_TYPE(type) \ |
|  |  | assert(server->n\_security\_types < MAX\_SECURITY\_TYPES); \ |
|  |  | server->security\_types[server->n\_security\_types++] = (type); |
|  |  |  |
|  |  | uint8\_t buf[sizeof(struct rfb\_security\_types\_msg) + |
|  |  | SECURITY\_TYPES\_MAX] = {}; |
|  |  | struct rfb\_security\_types\_msg\* security = |
|  |  | (struct rfb\_security\_types\_msg\*)buf; |
|  |  | if (server->n\_security\_types > 0) |
|  |  | return; |
|  |  |  |
|  |  | security->n = 0; |
|  |  | if (server->auth\_flags & NVNC\_AUTH\_REQUIRE\_AUTH) { |
|  |  | assert(server->auth\_fn); |
|  |  |  |
|  |  | #ifdef ENABLE\_TLS |
|  |  | if (server->tls\_creds) { |
|  |  | security->types[security->n++] = RFB\_SECURITY\_TYPE\_VENCRYPT; |
|  |  | ADD\_SECURITY\_TYPE(RFB\_SECURITY\_TYPE\_VENCRYPT); |
|  |  | } |
|  |  | #endif |
|  |  |  |
|  |  | #ifdef HAVE\_CRYPTO |
|  |  | security->types[security->n++] = RFB\_SECURITY\_TYPE\_RSA\_AES256; |
|  |  | security->types[security->n++] = RFB\_SECURITY\_TYPE\_RSA\_AES; |
|  |  | ADD\_SECURITY\_TYPE(RFB\_SECURITY\_TYPE\_RSA\_AES256); |
|  |  | ADD\_SECURITY\_TYPE(RFB\_SECURITY\_TYPE\_RSA\_AES); |
|  |  |  |
|  |  | if (!(server->auth\_flags & NVNC\_AUTH\_REQUIRE\_ENCRYPTION)) { |
|  |  | security->types[security->n++] = RFB\_SECURITY\_TYPE\_APPLE\_DH; |
|  |  | ADD\_SECURITY\_TYPE(RFB\_SECURITY\_TYPE\_APPLE\_DH); |
|  |  | } |
|  |  | #endif |
|  |  | } else { |
|  |  | security->n = 1; |
|  |  | security->types[0] = RFB\_SECURITY\_TYPE\_NONE; |
|  |  | ADD\_SECURITY\_TYPE(RFB\_SECURITY\_TYPE\_NONE); |
|  |  | } |
|  |  |  |
|  |  | if (security->n == 0) { |
|  |  | if (server->n\_security\_types == 0) { |
|  |  | nvnc\_log(NVNC\_LOG\_PANIC, "Failed to satisfy requested security constraints"); |
|  |  | } |
|  |  |  |
|  |  | #undef ADD\_SECURITY\_TYPE |
|  |  | } |
|  |  |  |
|  |  | static bool is\_allowed\_security\_type(const struct nvnc\* server, uint8\_t type) |
|  |  | { |
|  |  | for (int i = 0; i < server->n\_security\_types; ++i) { |
|  |  | if ((uint8\_t)server->security\_types[i] == type) { |
|  |  | return true; |
|  |  | } |
|  |  | } |
|  |  | return false; |
|  |  | } |
|  |  |  |
|  |  | static int on\_version\_message(struct nvnc\_client\* client) |
|  |  | { |
|  |  | struct nvnc\* server = client->server; |
|  |  |  |
|  |  | if (client->buffer\_len - client->buffer\_index < 12) |
|  |  | return 0; |
|  |  |  |
|  |  | char version\_string[13]; |
|  |  | memcpy(version\_string, client->msg\_buffer + client->buffer\_index, 12); |
|  |  | version\_string[12] = '\0'; |
|  |  |  |
|  |  | if (strcmp(RFB\_VERSION\_MESSAGE, version\_string) != 0) |
|  |  | return handle\_unsupported\_version(client); |
|  |  |  |
|  |  | uint8\_t buf[sizeof(struct rfb\_security\_types\_msg) + |
|  |  | MAX\_SECURITY\_TYPES] = {}; |
|  |  | struct rfb\_security\_types\_msg\* security = |
|  |  | (struct rfb\_security\_types\_msg\*)buf; |
|  |  |  |
|  |  | init\_security\_types(server); |
|  |  |  |
|  |  | security->n = server->n\_security\_types; |
|  |  | for (int i = 0; i < server->n\_security\_types; ++i) { |
|  |  | security->types[i] = server->security\_types[i]; |
|  |  | } |
|  |  |  |
|  |  | stream\_write(client->net\_stream, security, sizeof(\*security) + |
|  |  | security->n, NULL, NULL); |
|  |  |  |
| Expand Down  Expand Up | | @@ -798,6 +824,11 @@ static int on\_security\_message(struct nvnc\_client\* client) |
|  |  | uint8\_t type = client->msg\_buffer[client->buffer\_index]; |
|  |  | nvnc\_log(NVNC\_LOG\_DEBUG, "Client chose security type: %d", type); |
|  |  |  |
|  |  | if (!is\_allowed\_security\_type(client->server, type)) { |
|  |  | security\_handshake\_failed(client, NULL, "Illegal security type"); |
|  |  | return sizeof(type); |
|  |  | } |
|  |  |  |
|  |  | switch (type) { |
|  |  | case RFB\_SECURITY\_TYPE\_NONE: |
|  |  | security\_handshake\_ok(client, NULL); |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `cc71650`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fany1%2Fneatvnc%2Fcommit%2Fcc71650a69abc2573a0d96d082409d2468802d47) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from www.openwall.com_cd38acc7_20250111_113842.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](../../../2024/08/01/3) [[next>]](2) [[thread-next>]](6) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <CAFNQBQwnnA_=sZCvYf=sRzz2SXfqJB5_JEFYjCC+pcGekN9WFw@mail.gmail.com>
Date: Thu, 1 Aug 2024 23:05:27 +0000
From: Andri Yngvason <andri@...vason.is>
To: oss-security@...ts.openwall.com
Cc: Dane Bouchie <dbouchie@...dimed.com>, Travis Wise <travis@...esquared.com>,
	security@...pberrypi.com, Simon Long <simon@...pberrypi.com>,
	Moritz Mühlenhoff <jmm@...til.org>,
	Salvatore Bonaccorso <carnil@...ian.org>
Subject: Neat VNC Security Vulnerability

Hi,

It has come to my attention that there is a security vulnerability in Neat VNC.

I've released a new version that fixes the vulnerability:
<https://github.com/any1/neatvnc/releases/tag/v0.8.1>

Regards,
Andri

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from github.com_5051b445_20250111_113841.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fany1%2Fneatvnc%2Freleases%2Ftag%2Fv0.8.1)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fany1%2Fneatvnc%2Freleases%2Ftag%2Fv0.8.1)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Freleases%2Fshow&source=header-repo&source_repo=any1%2Fneatvnc)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[any1](/any1)
/
**[neatvnc](/any1/neatvnc)**
Public

* [Notifications](/login?return_to=%2Fany1%2Fneatvnc) You must be signed in to change notification settings
* [Fork
  34](/login?return_to=%2Fany1%2Fneatvnc)
* [Star
   128](/login?return_to=%2Fany1%2Fneatvnc)

* [Code](/any1/neatvnc/tree/v0.8.1)
* [Issues
  15](/any1/neatvnc/issues)
* [Pull requests
  5](/any1/neatvnc/pulls)
* [Discussions](/any1/neatvnc/discussions)
* [Actions](/any1/neatvnc/actions)
* [Projects
  0](/any1/neatvnc/projects)
* [Security](/any1/neatvnc/security)
* [Insights](/any1/neatvnc/pulse)

Additional navigation options

* [Code](/any1/neatvnc/tree/v0.8.1)
* [Issues](/any1/neatvnc/issues)
* [Pull requests](/any1/neatvnc/pulls)
* [Discussions](/any1/neatvnc/discussions)
* [Actions](/any1/neatvnc/actions)
* [Projects](/any1/neatvnc/projects)
* [Security](/any1/neatvnc/security)
* [Insights](/any1/neatvnc/pulse)

1. [Releases](/any1/neatvnc/releases)
2. [v0.8.1](/any1/neatvnc/releases/tag/v0.8.1)

# v0.8.1

 Compare

Choose a tag to compare

Could not load tags

Nothing to show

[{{ refName }}
default](/any1/neatvnc/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...v0.8.1)

 Loading

[View all tags](/any1/neatvnc/tags)

![@any1](https://avatars.githubusercontent.com/u/2663782?s=40&v=4)
[any1](/any1)
released this
01 Aug 22:47

·
[102 commits](/any1/neatvnc/compare/v0.8.1...master)
to master
since this release

[v0.8.1](/any1/neatvnc/tree/v0.8.1)

[`0708156`](/any1/neatvnc/commit/07081567ab21a2b099ceb41ae8cab872a31cbb9a)

This release fixes a security vulnerability.

Package maintainers are advised to upgrade ASAP.

The vulnerability was reported by Dane Bouchie and Travis Wise.

 Assets
2

 Loading

All reactions

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


