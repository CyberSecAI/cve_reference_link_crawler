=== Content from bugzilla.mozilla.org_82ed31b1_20250111_003845.html ===


![](/static/v20250108.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1821884)
* [XML](/show_bug.cgi?ctype=xml&id=1821884)

Closed
[Bug 1821884](/show_bug.cgi?id=1821884)
(CVE-2023-4051)

Opened 2 years ago
Closed 2 years ago

# File Open Dialog hide fullscreen notification

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

File Open Dialog hide fullscreen notification

## Categories

### (Core :: DOM: Core & HTML, defect)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=DOM%3A%20Core%20%26%20HTML#DOM%3A%20Core%20%26%20HTML)

DOM: Core & HTML
▾

Core :: DOM: Core & HTML
Issues in DOM tree [https://dom.spec.whatwg.org](https://dom.spec.whatwg.org/) & HTML [https://html.spec.whatwg.org](https://html.spec.whatwg.org/) that do not fit into any other DOM or HTML component or which span multiple DOM or HTML components.
[See Open Bugs in This Component](/buglist.cgi?product=Core&component=DOM%3A%20Core%20%26%20HTML&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=DOM%3A%20Core%20%26%20HTML&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=DOM%3A%20Core%20%26%20HTML)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

unspecified

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

S3

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

116 Branch

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Webcompat Score | --- |
| --- | --- |
| Performance Impact | --- |
| Webcompat Priority | --- |
| Accessibility Severity | --- |
| a11y-review | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr102 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=wontfix) |
| firefox-esr115 | [117+](/buglist.cgi?f1=cf_tracking_firefox_esr115&o1=equals&v1=117%2B) | [verified](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=verified) |
| firefox114 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox114&o1=equals&v1=wontfix) |
| firefox115 | [+](/buglist.cgi?f1=cf_tracking_firefox115&o1=equals&v1=%2B) | [wontfix](/buglist.cgi?f1=cf_status_firefox115&o1=equals&v1=wontfix) |
| firefox116 | [+](/buglist.cgi?f1=cf_tracking_firefox116&o1=equals&v1=%2B) | [verified](/buglist.cgi?f1=cf_status_firefox116&o1=equals&v1=verified) |
| firefox117 | --- | [verified](/buglist.cgi?f1=cf_status_firefox117&o1=equals&v1=verified) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr102 |  | wontfix |
| firefox-esr115 | 117+ | verified |
| firefox-esr128 | --- | --- |
| firefox114 |  | wontfix |
| firefox115 | + | wontfix |
| firefox116 | + | verified |
| firefox117 |  | verified |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: sas.kunz, Assigned: edgar)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/f65ba150a7cf6313efc23c96c9206cd8?d=mm&size=40)  [edgar](/user_profile?user_id=455480)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/860f658075a65d56d96e9f0575bbc14b?d=mm&size=40)  [sas.kunz](/user_profile?user_id=694415)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/331afc283e18d6d28cb7ebb11b2cf5bb?d=mm&size=40)  [hsinyi](/user_profile?user_id=434964)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

21 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

[CVE-2023-5726](/show_bug.cgi?id=1846205 "VERIFIED FIXED - File picker should cause the browser window to lose focus on Mac")

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

[CVE-2023-5729](/show_bug.cgi?id=1823720 "RESOLVED FIXED - Obscured Fullscreen by Launching Security Credential Setup"), [1828276](/show_bug.cgi?id=1828276 "RESOLVED DUPLICATE - color picker on popup window can overlap notification fullscreen"), [1831818](/show_bug.cgi?id=1831818 "RESOLVED DUPLICATE - Input File Dialog Able to Overlap Fullscreen Notification Toast"), [1834949](/show_bug.cgi?id=1834949 "RESOLVED DUPLICATE - Fix 1816287 can be Bypassed using setInterval/setTimout Functions")

[1833363](/show_bug.cgi?id=1833363 "RESOLVED FIXED - Add more tests for fullscreen warning")

Dependency [tree](/showdependencytree.cgi?id=1821884&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=1821884)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

[1847901](/show_bug.cgi?id=1847901 "VERIFIED FIXED - Firefox 116 \"<site> is now full screen\" keeps randomly showing up on alt-tab.")

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[Duplicates:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#duplicates)

[1828276](/show_bug.cgi?id=1828276 "RESOLVED DUPLICATE - color picker on popup window can overlap notification fullscreen"), [1831818](/show_bug.cgi?id=1831818 "RESOLVED DUPLICATE - Input File Dialog Able to Overlap Fullscreen Notification Toast"), [1834949](/show_bug.cgi?id=1834949 "RESOLVED DUPLICATE - Fix 1816287 can be Bypassed using setInterval/setTimout Functions")

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

[1831818](/show_bug.cgi?id=1831818 "RESOLVED DUPLICATE - Input File Dialog Able to Overlap Fullscreen Notification Toast"), [CVE-2023-4053](/show_bug.cgi?id=1839079 "VERIFIED FIXED - New Update Hide Full Screen Popup Ui Windows with mailto: link")

## Details

### (Keywords: csectype-spoof, reporter-external, sec-moderate, Whiteboard: [reporter-external] [client-bounty-form] [verif?] [reminder-esr-uplift 2023-07-05] [adv-main116+] [adv-esr115.2+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2023-4051

[Keywords:](/describekeywords.cgi)

[csectype-spoof](/buglist.cgi?keywords=csectype-spoof&resolution=---),
[reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---),
[sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[reporter-external] [client-bounty-form] [verif?] [reminder-esr-uplift 2023-07-05] [adv-main116+] [adv-esr115.2+]

QA Whiteboard:

[post-critsmash-triage]

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [dveditz](/user_profile?user_id=1689) | [sec-bounty](#a8090307_1689 "2 years ago") | + |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | sec-bounty | + |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (5 files, 1 obsolete file)

| [poc fileupload firefox.mp4](/attachment.cgi?id=9322577)  [2 years ago](#c0)  [Hafiizh](/user_profile?user_id=694415)   710.08 KB, video/mp4 |  | [Details](/attachment.cgi?id=9322577&action=edit) |
| --- | --- | --- |
| [filedialog.html](/attachment.cgi?id=9322578)  [2 years ago](#c1)  [Hafiizh](/user_profile?user_id=694415)   1.49 KB, text/html |  | [Details](/attachment.cgi?id=9322578&action=edit) |
| [Bug 1821884 - Don't hide the fullscreen notification until the fullscreen window is focus; r?Gijs](/attachment.cgi?id=9332950)  [2 years ago](#c15)  [Edgar Chen [:edgar]](/user_profile?user_id=455480)   48 bytes, text/x-phabricator-request |  | [Details](/attachment.cgi?id=9332950&action=edit) | [Review](/attachment.cgi?id=9332950) |
| [Bug 1821884 - Ensure consistent state for fullscreen/pointerlock warnings; r?Gijs](/attachment.cgi?id=9333124)  [2 years ago](#c16)  [Edgar Chen [:edgar]](/user_profile?user_id=455480)   48 bytes, text/x-phabricator-request | RyanVM : [approval-mozilla-esr115+](#c44 "1 year ago") | [Details](/attachment.cgi?id=9333124&action=edit) | [Review](/attachment.cgi?id=9333124) |
| [Bug 1821884 - Reshow initial fullscreen notification; r?Gijs](/attachment.cgi?id=9334626)  [2 years ago](#c22)  [Edgar Chen [:edgar]](/user_profile?user_id=455480)   48 bytes, text/x-phabricator-request | RyanVM : [approval-mozilla-esr115+](#a13536801_75935 "1 year ago") | [Details](/attachment.cgi?id=9334626&action=edit) | [Review](/attachment.cgi?id=9334626) |
| [advisory.txt](/attachment.cgi?id=9345940)  [1 years ago](#c37)  [Jesse Schwartzentruber (:truber)](/user_profile?user_id=486733)   224 bytes, text/plain |  | [Details](/attachment.cgi?id=9345940&action=edit) |

Show Obsolete

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Hafiizh](/user_profile?user_id=694415)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1821884#c0)• 2 years ago |
|  | |

Attached video
[poc fileupload firefox.mp4](attachment.cgi?id=9322577)
— [Details](attachment.cgi?id=9322577&action=edit)

I found a vulnerability in firefox 110.0.1 (64-bit) (i tested on windows OS) where a safety browsing alert notification can cover fullscreen notifications which can lead to spoofs.

step to reproduces:

1. open <http://103.186.0.20/fileupload.html>
2. press "Enter" on keyboard 2 times

mitigation:

Exit fullscreen when file dialog prompt is shown.

code (HTML file) :

<html>

<head>

<script>

```
        function fullscreen()
        {
                     document.getElementById("xx").requestFullscreen().then(function() {
                      document.getElementById('fileid').focus();
                      document.getElementById("fileid").focus();
          })
            .catch(function(error) {
                                            // element could not enter fullscreen mode
                                            // error message
                                            console.log(error.message);
            });
            document.getElementById("fileid").focus();
        }
    </script>
</head>
<body id="xx"  >

         <input id='fileid' type='file' name='filename'/>

        <button id="yy" >google.com</button>

</body>

```

</html>

<script>

document.getElementById("yy").focus();

document.getElementById("yy").addEventListener("keypress", function(e) {

if (e.key === "Enter") {

```
 fullscreen()

```

}

});

document.getElementById("fileid").addEventListener("keypress", function(e) {

if (e.key === "Enter") {

```
   document.getElementById('fileid').click();

```

}

});

const myTimeout = setTimeout(showdialogfile, 1000);

function myStopFunction() {

clearTimeout(myTimeout);

}

function showdialogfile() {

document.getElementById('fileid').click();

}

</script>

Flags: sec-bounty?

|  | [Hafiizh](/user_profile?user_id=694415)  Reporter |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1821884#c1)• 2 years ago |
|  | |

Attached file
[filedialog.html](attachment.cgi?id=9322578)
— [Details](attachment.cgi?id=9322578&action=edit)

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1821884#c2)• 2 years ago |
|  | |

I'm not sure what we could/should do about this. I imagine not showing the filepicker until we've shown the fullscreen warning would not be web-compatible and/or would lead to bad user experiences. We could move the warning on the screen but that requires knowing where the OS window opens (which I'm not sure we do - certainly the frontend has no way of finding out at the moment.

Edgar, as the resident fullscreen expert, any thoughts?

Group: firefox-core-security → dom-core-securityComponent: Security → DOM: Core & HTMLFlags: needinfo?(echen)Product: Firefox → Core

|  | [Olli Pettay [:smaug][bugs@pettay.fi]](/user_profile?user_id=39966) |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1821884#c3)• 2 years ago |
|  | |

Chrome seems to exit fullscreen when file picker is shown, on linux at least.

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1821884#c4)• 2 years ago |
|  | |

It's not working for me on Mac, doesn't seem to try to go to fullscreen. No errors in the console to explain it. From the video it would depend on where the user last used a file picker, wouldn't it? I think the OS remembers where you put it. Even in the video it doesn't cover it all that well.

Keywords: [csectype-spoof](/buglist.cgi?keywords=csectype-spoof&resolution=---)

|  | [Edgar Chen [:edgar]](/user_profile?user_id=455480)  Assignee |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1821884#c5)• 2 years ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1821884&comment_id=16328531 "1 revision") |
|  | |

(In reply to Daniel Veditz [:dveditz] from [comment #4](/show_bug.cgi?id=1821884#c4 "RESOLVED FIXED - File Open Dialog hide fullscreen notification"))

> doesn't seem to try to go to fullscreen.

This sounds weird, I do see page go to fullscreen on Mac.

(Note that you would need to press Enter key on `google.com` button to trigger fullscreen request, clicking the button does nothing)

> From the video it would depend on where the user last used a file picker, wouldn't it? I think the OS remembers where you put it. Even in the video it doesn't cover it all that well.

Mac and Linux (Ubuntu) open the File picker at middle of the screen/page every time, they do not remember the location, but size. It likely impact the user who has smaller screen or make the file picker pretty large.

Windows do remember the location and also the size for file picker, so yes, it would depend on where the user last used a file picker.

|  | [Edgar Chen [:edgar]](/user_profile?user_id=455480)  Assignee |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1821884#c6)• 2 years ago |
|  | |

(In reply to Olli Pettay [:smaug][bugs@pettay.fi] from [comment #3](/show_bug.cgi?id=1821884#c3 "RESOLVED FIXED - File Open Dialog hide fullscreen notification"))

> Chrome seems to exit fullscreen when file picker is shown, on linux at least.

I am not sure if exiting fullscreen when file picker is shown makes sense, as file picker is a modal window which is always visible with the main window together. Chromium also get a compliant from user, e.g. <https://bugs.chromium.org/p/chromium/issues/detail?id=1328896&q=Fullscreen%20F11&can=1>. Is it possible that we make warning always show on top, so file picker can not cover it?

Flags: needinfo?(echen)

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1821884#c7)• 2 years ago |
|  | |

(In reply to Edgar Chen [:edgar] from [comment #6](/show_bug.cgi?id=1821884#c6 "RESOLVED FIXED - File Open Dialog hide fullscreen notification"))

> Is it possible that we make warning always show on top, so file picker can not cover it?

I don't think that's easily possible with the UI framework we have, also given that longer term we would like the picker to be shown by a different process (cf. [bug 1677170](/show_bug.cgi?id=1677170 "NEW - [meta] Asynchronous, out-of-process Win32 file picker")).

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1821884#a829617_159069)• 2 years ago |

See Also: → [CVE-2023-5729](/show_bug.cgi?id=1823720 "RESOLVED FIXED - Obscured Fullscreen by Launching Security Credential Setup")

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1821884#c8)• 2 years ago |
|  | |

(In reply to Edgar Chen [:edgar] from [comment #5](/show_bug.cgi?id=1821884#c5 "RESOLVED FIXED - File Open Dialog hide fullscreen notification"))

> (In reply to Daniel Veditz [:dveditz] from [comment #4](/show_bug.cgi?id=1821884#c4 "RESOLVED FIXED - File Open Dialog hide fullscreen notification"))
>
> > doesn't seem to try to go to fullscreen.
>
> This sounds weird, I do see page go to fullscreen on Mac.

Worked like a charm when I tried today... dunno what's different. On my large monitor it didn't actually cover the toast, but I can see how it could depending on the user's configuration.

> I'm not sure what we could/should do about this.

one different thing would be to make the full-screen notification a separate OS pane that really is top-most. It looks like we're currently drawing it in our own content window which is why selects and other things are able to cover it so easily.

Status: UNCONFIRMED → NEWEver confirmed: trueKeywords: [sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

|  | [Edgar Chen [:edgar]](/user_profile?user_id=455480)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1821884#a1567139_455480)• 2 years ago |

Severity: -- → S3

|  | [Hafiizh](/user_profile?user_id=694415)  Reporter |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1821884#c9)• 2 years ago |
|  | |

hello any updates?

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1821884#a5060030_406194)• 2 years ago |

Duplicate of this bug: [1831818](/show_bug.cgi?id=1831818 "RESOLVED DUPLICATE - Input File Dialog Able to Overlap Fullscreen Notification Toast")

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1821884#c11)• 2 years ago |
| obsolete | |

| Comment hidden (obsolete) |  |
| --- | --- |

The severity field for this bug is set to `S3`. However, the following bug duplicate has higher severity:

* [Bug 1831818](/show_bug.cgi?id=1831818 "RESOLVED DUPLICATE - Input File Dialog Able to Overlap Fullscreen Notification Toast"): S2

:mccr8, could you consider increasing the severity of this bug to `S2`?

For more information, please visit [BugBot documentation](https://wiki.mozilla.org/BugBot#severity_higher_dups.py).

Flags: needinfo?(continuation)

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1821884#a5135523_406194)• 2 years ago |

Flags: needinfo?(continuation)

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1821884#c12)• 2 years ago |
|  | |

Hsin-Yi, could we maybe increase the priority on fixing this? It is a sec-moderate, but we've had two reports of it now, so it would be good to fix. Thanks.

Flags: needinfo?(htsai)

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1821884#a5140774_406194)• 2 years ago |

No longer duplicate of this bug: [1831818](/show_bug.cgi?id=1831818 "RESOLVED DUPLICATE - Input File Dialog Able to Overlap Fullscreen Notification Toast")

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1821884#a5140775_406194)• 2 years ago |

See Also: → [1831818](/show_bug.cgi?id=1831818 "RESOLVED DUPLICATE - Input File Dialog Able to Overlap Fullscreen Notification Toast")

|  | [Edgar Chen [:edgar]](/user_profile?user_id=455480)  Assignee |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1821884#c13)• 2 years ago |
|  | |

(In reply to Daniel Veditz [:dveditz] from [comment #8](/show_bug.cgi?id=1821884#c8 "RESOLVED FIXED - File Open Dialog hide fullscreen notification"))

> one different thing would be to make the full-screen notification a separate OS pane that really is top-most. It looks like we're currently drawing it in our own content window which is why selects and other things are able to cover it so easily.

The full-screen notification slide out automatically after 3 second, another thing would be to make the notification not slide out when the fullscreen window is unfocused or file/color picker is opened (not sure if we have any existing way to detect that). So when user switch back to fullscreen window, they still can have a chance to see the notification.

|  | [Edgar Chen [:edgar]](/user_profile?user_id=455480)  Assignee |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1821884#c14)• 2 years ago |
|  | |

(In reply to Edgar Chen [:edgar] from [comment #13](/show_bug.cgi?id=1821884#c13 "RESOLVED FIXED - File Open Dialog hide fullscreen notification"))

> file/color picker is opened (not sure if we have any existing way to detect that)

When file/color picker is opened, the fullscreen window is unfocused, so detect whether fullscreen window is focused should be enough.

|  | [Edgar Chen [:edgar]](/user_profile?user_id=455480)  Assignee |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1821884#c15)• 2 years ago |
|  | |

Attached file
[Bug 1821884 - Don't hide the fullscreen notification until the fullscreen window is focus; r?Gijs](attachment.cgi?id=9332950) (obsolete)
— [Details](attachment.cgi?id=9332950&action=edit)

|  | [Hsin-Yi Tsai (she/her) [:hsinyi]](/user_profile?user_id=434964) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1821884#a5224950_434964)• 2 years ago |

Flags: needinfo?(htsai)

|  | [Edgar Chen [:edgar]](/user_profile?user_id=455480)  Assignee |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1821884#c16)• 2 years ago |
|  | |

Attached file
[Bug 1821884 - Ensure consistent state for fullscreen/pointerlock warnings; r?Gijs](attachment.cgi?id=9333124)
— [Details](attachment.cgi?id=9333124&action=edit)

Fullscreen/PointerLock warnings are initialized with hidden="true", but

change to hidden="" after being shown and hidden again. I think this

started happening when we began using HTML elements instead of XUL as

they handle hidden attribute differently.

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1821884#a5230166_600971)• 2 years ago |

Assignee: nobody → echenStatus: NEW → ASSIGNED

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1821884#a5230174_600971)• 2 years ago |

[Attachment #9332950](/attachment.cgi?id=9332950&action=edit "Bug 1821884 - Don't hide the fullscreen notification until the fullscreen window is focus; r?Gijs") -
Attachment description: Bug 1821884 - Hide fullscreen notification automatically only when fullscreen window is focused; → Bug 1821884 - Don't hide the fullscreen notification until the fullscreen window is focus;

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1821884#a5644484_600971)• 2 years ago |

[Attachment #9333124](/attachment.cgi?id=9333124&action=edit "Bug 1821884 - Ensure consistent state for fullscreen/pointerlock warnings; r?Gijs") -
Attachment description: Bug 1821884 - Ensure consistent state for fullscreen/pointerlock warnings; → Bug 1821884 - Ensure consistent state for fullscreen/pointerlock warnings; r?Gijs

|  | [Edgar Chen [:edgar]](/user_profile?user_id=455480)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1821884#a5644914_455480)• 2 years ago |

Blocks: [1833363](/show_bug.cgi?id=1833363 "RESOLVED FIXED - Add more tests for fullscreen warning")

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1821884#a5646924_600971)• 2 years ago |

[Attachment #9332950](/attachment.cgi?id=9332950&action=edit "Bug 1821884 - Don't hide the fullscreen notification until the fullscreen window is focus; r?Gijs") -
Attachment description: Bug 1821884 - Don't hide the fullscreen notification until the fullscreen window is focus; → Bug 1821884 - Don't hide the fullscreen notification until the fullscreen window is focus; r?Gijs

|  | [Edgar Chen [:edgar]](/user_profile?user_id=455480)  Assignee |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1821884#c17)• 2 years ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1821884&comment_id=16414121 "1 revision") |
|  | |

(In reply to Edgar Chen [:edgar] from [comment #13](/show_bug.cgi?id=1821884#c13 "RESOLVED FIXED - File Open Dialog hide fullscreen notification"))

> The full-screen notification slide out automatically after 3 second, another thing would be to make the notification not slide out when the fullscreen window is unfocused or file/color picker is opened (not sure if we have any existing way to detect that). So when user switch back to fullscreen window, they still can have a chance to see the notification.

This approach helps some other situation, like notification is overlapped by a external application ([bug 1816287](/show_bug.cgi?id=1816287 "VERIFIED FIXED - Obscuring the Full-Screen notification in Firefox Using maximized external application window (e.g. via mailto:)")) or other browser window ([bug 1828276](/show_bug.cgi?id=1828276 "RESOLVED DUPLICATE - color picker on popup window can overlap notification fullscreen")).

But I just realized that there is one downside of this approach in multiple monitor scenario: If a user enter fullscreen on one monitor (e.g. playing a video) and then switch to another monitor to do other things before the fullscreen notification is hidden automatically (which current takes 3 sec), the fullscreen notification will not automatically hide until user switch focus back to the fullscreen window. This is a kind of tradeoff between security and user experience, Gijs and Daniel, any thoughts. And it would be also good to get some feedback from UX people if possible.

Flags: needinfo?(htsai)Flags: needinfo?(gijskruitbosch+bugs)Flags: needinfo?(dveditz)

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1821884#c18)• 2 years ago |
|  | |

(In reply to Edgar Chen [:edgar] from [comment #17](/show_bug.cgi?id=1821884#c17 "RESOLVED FIXED - File Open Dialog hide fullscreen notification"))

> But I just realized that there is one downside of this approach in multiple monitor scenario: If a user enter fullscreen on one monitor (e.g. playing a video) and then switch to another monitor to do other things before the fullscreen notification is hidden automatically (which current takes 3 sec), the fullscreen notification will not automatically hide until user switch focus back to the fullscreen window. This is a kind of tradeoff between security and user experience, Gijs and Daniel, any thoughts. And it would be also good to get some feedback from UX people if possible.

I think ideally we should be able to work out if any part of the window is occluded, which would allow us to spot the difference between these two cases, I think? But I don't know that we currently have an API for that (other than for the window being *completely* occluded, which isn't the case here). Perhaps :emilio can help or suggest an alternative approach?

Flags: needinfo?(gijskruitbosch+bugs) → needinfo?(emilio)

|  | [Emilio Cobos Álvarez (:emilio)](/user_profile?user_id=546716) |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1821884#c19)• 2 years ago |
|  | |

I don't think we can know whether the window is partially occluded unfortunately. But we should be able to track whether we're opening a modal dialog? Windows has [this code](https://searchfox.org/mozilla-central/rev/11a4d97a7b5cdfa133f4bda4525649f651703018/widget/windows/nsWindow.cpp#8761-8770) to track open file pickers, maybe we could track that similarly on other platforms?

Flags: needinfo?(emilio)

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1821884#c20)• 2 years ago |
|  | |

(In reply to Emilio Cobos Álvarez (:emilio) from [comment #19](/show_bug.cgi?id=1821884#c19 "RESOLVED FIXED - File Open Dialog hide fullscreen notification"))

> I don't think we can know whether the window is partially occluded unfortunately. But we should be able to track whether we're opening a modal dialog? Windows has [this code](https://searchfox.org/mozilla-central/rev/11a4d97a7b5cdfa133f4bda4525649f651703018/widget/windows/nsWindow.cpp#8761-8770) to track open file pickers, maybe we could track that similarly on other platforms?

That could work for the filepicker case, but the current version of this patch will also help when e.g. a page opens a link to an external protocol that opens some other app on the machine ([bug 1816287](/show_bug.cgi?id=1816287 "VERIFIED FIXED - Obscuring the Full-Screen notification in Firefox Using maximized external application window (e.g. via mailto:)")), or the credentials bits in [bug 1823720](/show_bug.cgi?id=1823720 "RESOLVED FIXED - Obscured Fullscreen by Launching Security Credential Setup"), which we can't detect in the same way. Addressing them all 1 by 1 is all very whack-a-mole, whereas just persisting / re-showing the warning when activate/deactivate happens would be a more general fix for all these types of "oh look I hid a bit of your window" types of "attack"s.

|  | [Edgar Chen [:edgar]](/user_profile?user_id=455480)  Assignee |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=1821884#c21)• 2 years ago |
|  | |

> If a user enter fullscreen on one monitor (e.g. playing a video) and then switch to another monitor to do other things before the fullscreen notification is hidden automatically

Or we could still auto-hide the notification when fullscreen window is deactivated and re-showing again when activate. In multiple monitor scenario, it would show notification again to the user when user switch focus back to fullscreen window, but seems less annoying than persisting the notification?

|  | [Edgar Chen [:edgar]](/user_profile?user_id=455480)  Assignee |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=1821884#c22)• 2 years ago |
|  | |

Attached file
[Bug 1821884 - Reshow initial fullscreen notification; r?Gijs](attachment.cgi?id=9334626)
— [Details](attachment.cgi?id=9334626&action=edit)

Depends on D177790

|  | [Hsin-Yi Tsai (she/her) [:hsinyi]](/user_profile?user_id=434964) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1821884#a6157819_434964)• 2 years ago |

Flags: needinfo?(htsai)

|  | [Hsin-Yi Tsai (she/her) [:hsinyi]](/user_profile?user_id=434964) |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=1821884#c23)• 2 years ago |
|  | |

(I've reached out to ask for UX feedback. Will keep here posted.)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=1821884#c24)• 2 years ago |
|  | |

> In multiple monitor scenario, it would show notification again to the user when user switch focus back to fullscreen window, but seems less annoying than persisting the notification?

Less annoying to the users who switched away immediately (how many will that be?), but way more annoying to everyone else. Currently they only see the initial prompt, but folks who switch apps a bunch of times while watching a movie (say to a chat program discussing the show they're all watching together, or answering mail during the commercials on ad-supported streams) would start to see this *all the time* if we made this change. Or was inherent in the proposal that this would not apply to user-initiated focus shifts? Can we make that distinction?

In theory I like reminding people, but in practice I think people will hate it.

Flags: needinfo?(dveditz)

|  | [Edgar Chen [:edgar]](/user_profile?user_id=455480)  Assignee |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=1821884#c25)• 2 years ago |
|  | |

> folks who switch apps a bunch of times while watching a movie (say to a chat program discussing the show they're all watching together, or answering mail during the commercials on ad-supported streams) would start to see this all the time if we made this change.

To clarify, this change only applies to the initial prompt:

* If the fullscreen window is switched away before the initial prompt's auto-hide timer expires (after 3 seconds), we assume that user might not see the prompt. Therefore, the "initial prompt" will reappear when the user refocuses on the fullscreen window.
* If the fullscreen window stay active until the initial prompt's auto-hide timer expires, we assume that user has seen the initial prompt. In this case, we will not show the prompt again, even if the user switches focus away and then back to the fullscreen window.

The initial prompt can reappear multiple times if the user rapidly switches between the fullscreen window and another window/application multiple times. However, this might be a rare or corner case, and perhaps re-showing prompt multiple times is acceptable?

> Or was inherent in the proposal that this would not apply to user-initiated focus shifts?

It is not easy to have a generic way to distinguish whether the focus change is user-initiated, especially in cases where the cause is from an external application or OS.

|  | [Sean Feng [:sefeng]](/user_profile?user_id=625922) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1821884#a6277670_625922)• 2 years ago |

Blocks: [1831818](/show_bug.cgi?id=1831818 "RESOLVED DUPLICATE - Input File Dialog Able to Overlap Fullscreen Notification Toast")

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=1821884#c26)• 2 years ago |
|  | |

Thanks for clarifying. That sounds fine.

|  | [Edgar Chen [:edgar]](/user_profile?user_id=455480)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1821884#a7019033_455480)• 2 years ago |

Blocks: [1834949](/show_bug.cgi?id=1834949 "RESOLVED DUPLICATE - Fix 1816287 can be Bypassed using setInterval/setTimout Functions")

|  | [Edgar Chen [:edgar]](/user_profile?user_id=455480)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1821884#a7105248_455480)• 2 years ago |

Blocks: [CVE-2023-5729](/show_bug.cgi?id=1823720 "RESOLVED FIXED - Obscured Fullscreen by Launching Security Credential Setup")See Also: [CVE-2023-5729](/show_bug.cgi?id=1823720 "RESOLVED FIXED - Obscured Fullscreen by Launching Security Credential Setup") →

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1821884#a7131092_600971)• 2 years ago |

[Attachment #9332950](/attachment.cgi?id=9332950&action=edit "Bug 1821884 - Don't hide the fullscreen notification until the fullscreen window is focus; r?Gijs") -
Attachment is obsolete: true

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1821884#a7365409_600971)• 2 years ago |

[Attachment #9334626](/attachment.cgi?id=9334626&action=edit "Bug 1821884 - Reshow initial fullscreen notification; r?Gijs") -
Attachment description: Bug 1821884 - Reshow fullscreen notification; → Bug 1821884 - Reshow initial fullscreen notification; r?Gijs

|  | [Edgar Chen [:edgar]](/user_profile?user_id=455480)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1821884#a7444116_455480)• 2 years ago |

Blocks: [1828276](/show_bug.cgi?id=1828276 "RESOLVED DUPLICATE - color picker on popup window can overlap notification fullscreen")

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 27](/show_bug.cgi?id=1821884#c27)• 2 years ago |
|  | |

Landed:

<https://hg.mozilla.org/integration/autoland/rev/47ac6b453494cb75a47a3d5572ef78ebe29845a8>

<https://hg.mozilla.org/integration/autoland/rev/b843039f68066217b47c8990efb2fe2cb8bf6cd4>

Backed out for causing browser-chrome failures of browser\_pointerlock\_warning.js:

<https://hg.mozilla.org/integration/autoland/rev/8c19dab5b51003effa919d308ff033031f7c52f7>

[Push with failures](https://treeherder.mozilla.org/jobs?repo=autoland&group_state=expanded&selectedTaskRun=YuPFzDBWRCCAE6jc51bD9w.0&resultStatus=testfailed%2Cbusted%2Cexception%2Cretry%2Cusercancel&revision=b843039f68066217b47c8990efb2fe2cb8bf6cd4)

[Failure log](https://treeherder.mozilla.org/logviewer?job_id=418481242&repo=autoland)

```
[task 2023-06-07T22:14:17.328Z] 22:14:17     INFO - Entering test bound show_pointerlock_warning_escape
[task 2023-06-07T22:14:17.328Z] 22:14:17     INFO - Pointerlock warning test for data:text/html,<body onpointerdown='this.requestPointerLock()' style='width: 100px; height: 100px;'></body>
[task 2023-06-07T22:14:17.330Z] 22:14:17     INFO - Console message: [JavaScript Warning: "This page is in Quirks Mode. Page layout may be impacted. For Standards Mode use “<!DOCTYPE html>”." {file: "data:text/html,<body onpointerdown='this.requestPointerLock()' style='width: 100px; height: 100px;'></body>" line: 0}]
[task 2023-06-07T22:14:17.331Z] 22:14:17     INFO - Buffered messages finished
[task 2023-06-07T22:14:17.331Z] 22:14:17     INFO - TEST-UNEXPECTED-FAIL | dom/tests/browser/browser_pointerlock_warning.js | Test timed out -

```
Flags: needinfo?(echen)

|  | [Edgar Chen [:edgar]](/user_profile?user_id=455480)  Assignee |  |
| --- | --- | --- |
| [Comment 28](/show_bug.cgi?id=1821884#c28)• 2 years ago |
|  | |

Oh, [D177790](https://phabricator.services.mozilla.com/D177790) needs to update browser\_pointerlock\_warning.js, too.

Flags: needinfo?(echen)

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 29](/show_bug.cgi?id=1821884#c29)• 2 years ago |
|  | |

Ensure consistent state for fullscreen/pointerlock warnings; r=Gijs

<https://hg.mozilla.org/integration/autoland/rev/2c0b0e1394fe2a02238df8ada39b17862c346b04>

<https://hg.mozilla.org/mozilla-central/rev/2c0b0e1394fe>

Reshow initial fullscreen notification; r=Gijs

<https://hg.mozilla.org/integration/autoland/rev/3ca2cc6f49ed260c43068aca6a6950863f9ae15b>

<https://hg.mozilla.org/mozilla-central/rev/3ca2cc6f49ed>

Group: dom-core-security → core-security-releaseStatus: ASSIGNED → RESOLVEDClosed: 2 years ago
[status-firefox116](/buglist.cgi?f1=cf_status_firefox116&o1=isnotempty):
--- → [fixed](/buglist.cgi?f1=cf_status_firefox116&o1=equals&v1=fixed)Resolution: --- → FIXEDTarget Milestone: --- → 116 Branch

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1821884#a8034432_75935)• 2 years ago |

[status-firefox114](/buglist.cgi?f1=cf_status_firefox114&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox114&o1=equals&v1=wontfix)
[status-firefox115](/buglist.cgi?f1=cf_status_firefox115&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox115&o1=equals&v1=affected)
[status-firefox-esr102](/buglist.cgi?f1=cf_status_firefox_esr102&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=wontfix)
[tracking-firefox115](/buglist.cgi?f1=cf_tracking_firefox115&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox115&o1=equals&v1=%2B)
[tracking-firefox116](/buglist.cgi?f1=cf_tracking_firefox116&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox116&o1=equals&v1=%2B)

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Comment 30](/show_bug.cgi?id=1821884#c30)• 2 years ago |
|  | |

The patch landed in nightly and beta is affected.

:edgar, is this bug important enough to require an uplift?

* If yes, please nominate the patch for beta approval.
* If no, please set `status-firefox115` to `wontfix`.

For more information, please visit [BugBot documentation](https://wiki.mozilla.org/BugBot#uplift_beta.py).

Flags: needinfo?(echen)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1821884#a8090307_1689)• 2 years ago |

Flags: sec-bounty? → sec-bounty+Summary: File Open Dialog hide notification screen → File Open Dialog hide fullscreen notification

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1821884#a8090641_1689)• 2 years ago |

Duplicate of this bug: [1828276](/show_bug.cgi?id=1828276 "RESOLVED DUPLICATE - color picker on popup window can overlap notification fullscreen")

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1821884#a8090685_428608)• 2 years ago |

Duplicate of this bug: [1834949](/show_bug.cgi?id=1834949 "RESOLVED DUPLICATE - Fix 1816287 can be Bypassed using setInterval/setTimout Functions")

|  | [Edgar Chen [:edgar]](/user_profile?user_id=455480)  Assignee |  |
| --- | --- | --- |
| [Comment 33](/show_bug.cgi?id=1821884#c33)• 2 years ago |
|  | |

Since there is a UX behavior change, we don't want to land this before 116 in order to have a longer time to collect possible feedback.

[status-firefox115](/buglist.cgi?f1=cf_status_firefox115&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox115&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox115&o1=equals&v1=wontfix)Flags: needinfo?(echen)

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Comment 34](/show_bug.cgi?id=1821884#c34)• 2 years ago |
|  | |

(In reply to Edgar Chen [:edgar] from [comment #33](/show_bug.cgi?id=1821884#c33 "RESOLVED FIXED - File Open Dialog hide fullscreen notification"))

> Since there is a UX behavior change, we don't want to land this before 116 in order to have a longer time to collect possible feedback.

Do we want to uplift to esr115 after 116 releases?

Flags: needinfo?(echen)

|  | [Edgar Chen [:edgar]](/user_profile?user_id=455480)  Assignee |  |
| --- | --- | --- |
| [Comment 35](/show_bug.cgi?id=1821884#c35)• 2 years ago |
|  | |

(In reply to :Gijs (he/him) from [comment #34](/show_bug.cgi?id=1821884#c34 "RESOLVED FIXED - File Open Dialog hide fullscreen notification"))

> Do we want to uplift to esr115 after 116 releases?

Good point, yes, I think it's worth to uplift to esr115 after 116 release.

Flags: needinfo?(echen)

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1821884#a8240234_159069)• 2 years ago |

Whiteboard: [reporter-external] [client-bounty-form] [verif?] → [reporter-external] [client-bounty-form] [verif?] [reminder-esr-uplift 2023-07-05]

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1821884#a8579797_159069)• 2 years ago |

Duplicate of this bug: [CVE-2023-4053](/show_bug.cgi?id=1839079 "VERIFIED FIXED - New Update Hide Full Screen Popup Ui Windows with mailto: link")

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1821884#a8581489_159069)• 2 years ago |

No longer duplicate of this bug: [CVE-2023-4053](/show_bug.cgi?id=1839079 "VERIFIED FIXED - New Update Hide Full Screen Popup Ui Windows with mailto: link")

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1821884#a8581490_159069)• 2 years ago |

See Also: → [CVE-2023-4053](/show_bug.cgi?id=1839079 "VERIFIED FIXED - New Update Hide Full Screen Popup Ui Windows with mailto: link")

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1821884#a9219580_75935)• 2 years ago |

[status-firefox-esr115](/buglist.cgi?f1=cf_status_firefox_esr115&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=affected)
[tracking-firefox-esr115](/buglist.cgi?f1=cf_tracking_firefox_esr115&o1=isnotempty):
--- → [?](/buglist.cgi?f1=cf_tracking_firefox_esr115&o1=equals&v1=%3F)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1821884#a9638936_75935)• 2 years ago |

[tracking-firefox-esr115](/buglist.cgi?f1=cf_tracking_firefox_esr115&o1=isnotempty):
[?](/buglist.cgi?f1=cf_tracking_firefox_esr115&o1=equals&v1=%3F) → [117+](/buglist.cgi?f1=cf_tracking_firefox_esr115&o1=equals&v1=117%2B)

|  | [Camelia Badau [:cbadau], Desktop Test Engineering](/user_profile?user_id=500622) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1821884#a10384729_500622)• 2 years ago |

Flags: qe-verify+

|  | [Andrei Vaida [:avaida]](/user_profile?user_id=488993) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1821884#a11149430_488993)• 1 years ago |

QA Whiteboard: [post-critsmash-triage]

|  | [Jesse Schwartzentruber (:truber)](/user_profile?user_id=486733) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1821884#a11827827_486733)• 1 years ago |

Whiteboard: [reporter-external] [client-bounty-form] [verif?] [reminder-esr-uplift 2023-07-05] → [reporter-external] [client-bounty-form] [verif?] [reminder-esr-uplift 2023-07-05] [adv-main116+]

|  | [Jesse Schwartzentruber (:truber)](/user_profile?user_id=486733) |  |
| --- | --- | --- |
| [Comment 37](/show_bug.cgi?id=1821884#c37)• 1 years ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9345940)
— [Details](attachment.cgi?id=9345940&action=edit)

|  | [Daniel Bodea [:danibodea]](/user_profile?user_id=616104) |  |
| --- | --- | --- |
| [Comment 38](/show_bug.cgi?id=1821884#c38)• 1 years ago |
|  | |

I am attempting to verify this fix, however, I can not see a difference in behavior between the fixed Nightly v117.0a1 and Beta v116.0 (RC) and the affected Release v115.0.3 in Windows10 and Ubuntu22.

All builds fail to exit fullscreen when the operating system's file picker is opened (steps from [comment 0](/show_bug.cgi?id=1821884#c0 "RESOLVED FIXED - File Open Dialog hide fullscreen notification")).

If you think I misunderstood the expected results, please explain. Otherwise, the fix might not be valid.

Thank you.

Flags: needinfo?(echen)

|  | [Hafiizh](/user_profile?user_id=694415)  Reporter |  |
| --- | --- | --- |
| [Comment 39](/show_bug.cgi?id=1821884#c39)• 1 years ago |
|  | |

The fixed is the fullscreen notification is shown after you close the file picker

|  | [Daniel Bodea [:danibodea]](/user_profile?user_id=616104) |  |
| --- | --- | --- |
| [Comment 40](/show_bug.cgi?id=1821884#c40)• 1 years ago |
|  | |

I can confirm that the exit fullscreen notification ("<http://103.186.0.20> is now fullscreen" Exit Full Screen (Esc)") is hidden when the file picker is shown.

Steps:

1. Load <http://103.186.0.20/fileupload.html>
2. focus the "google.com" button with keyboard navigation
3. Press ENTER once.

   Observe: the webpage is shown in fullscreen and the "exit fgull screen notification" is displayed
4. Before the notification disappears, press ENTER again.

   Affected: The notification is displayed while the file picker is also displayed.

   Fixed: The notification is hidden immediately when the file-picker is shown and appears again after it's closed.

Verified in Nightly v117.0a1 and Beta v116.0 (RC) on Windows 10 and Ubuntu 22.

Unfortunately, it seems that the fix is not working for MacOS. The "<http://103.186.0.20> is now fullscreen" Exit Full Screen (Esc)" notification remains displayed while the file-picker is displayed.

|  | [Edgar Chen [:edgar]](/user_profile?user_id=455480)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1821884#a12185257_455480)• 1 years ago |

Depends on: [CVE-2023-5726](/show_bug.cgi?id=1846205 "VERIFIED FIXED - File picker should cause the browser window to lose focus on Mac")

|  | [Edgar Chen [:edgar]](/user_profile?user_id=455480)  Assignee |  |
| --- | --- | --- |
| [Comment 41](/show_bug.cgi?id=1821884#c41)• 1 years ago |
|  | |

(In reply to Daniel Bodea [:danibodea] from [comment #40](/show_bug.cgi?id=1821884#c40 "RESOLVED FIXED - File Open Dialog hide fullscreen notification"))

> Verified in Nightly v117.0a1 and Beta v116.0 (RC) on Windows 10 and Ubuntu 22.
>
> Unfortunately, it seems that the fix is not working for MacOS. The "<http://103.186.0.20> is now fullscreen" Exit Full Screen (Esc)" notification remains displayed while the file-picker is displayed.

I thought I had tested all platforms, but it appears I overlooked Mac. It seems that opening a file picker doesn't cause the browser window to lose focus on Mac, so this approach doesn't work there. I filed [bug 1846205](/show_bug.cgi?id=1846205 "VERIFIED FIXED - File picker should cause the browser window to lose focus on Mac").

|  | [Emilio Cobos Álvarez (:emilio)](/user_profile?user_id=546716) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1821884#a12983310_546716)• 1 year ago |

Regressions: [1847901](/show_bug.cgi?id=1847901 "VERIFIED FIXED - Firefox 116 \"<site> is now full screen\" keeps randomly showing up on alt-tab.")

|  | [Edgar Chen [:edgar]](/user_profile?user_id=455480)  Assignee |  |
| --- | --- | --- |
| [Comment 42](/show_bug.cgi?id=1821884#c42)• 1 year ago |
|  | |

Comment on [attachment 9333124](/attachment.cgi?id=9333124 "Bug 1821884 - Ensure consistent state for fullscreen/pointerlock warnings; r?Gijs") [[details]](/attachment.cgi?id=9333124&action=edit "Bug 1821884 - Ensure consistent state for fullscreen/pointerlock warnings; r?Gijs")

[Bug 1821884](/show_bug.cgi?id=1821884 "RESOLVED FIXED - File Open Dialog hide fullscreen notification") - Ensure consistent state for fullscreen/pointerlock warnings; r?Gijs

### ESR Uplift Approval Request

* **If this is not a sec:{high,crit} bug, please state case for ESR consideration**: This is not a sec-high/crit bug, but these patches provide a more general fix for attacks that attempt to use filer picker or other applications to hide fullscreen notifications.
* **User impact if declined**: Fullscreen warning notification is overlapped by file picker or other application, which could lead to address bar UI spoofing.
* **Fix Landed on Version**: 116
* **Risk to taking this patch**: Medium
* **Why is the change risky/not risky? (and alternatives if risky)**: There is a UX behavior change, but it is landed for a while on 116 and doesn't have much compliant (except [bug 1847901](/show_bug.cgi?id=1847901 "VERIFIED FIXED - Firefox 116 \"<site> is now full screen\" keeps randomly showing up on alt-tab.")), so it should be safe to uplift to esr115
Flags: needinfo?(echen)
[Attachment #9333124](/attachment.cgi?id=9333124&action=edit "Bug 1821884 - Ensure consistent state for fullscreen/pointerlock warnings; r?Gijs") -
Flags: approval-mozilla-esr115?

|  | [Edgar Chen [:edgar]](/user_profile?user_id=455480)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1821884#a13480126_455480)• 1 year ago |

[Attachment #9334626](/attachment.cgi?id=9334626&action=edit "Bug 1821884 - Reshow initial fullscreen notification; r?Gijs") -
Flags: approval-mozilla-esr115?

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1821884#a13532139_1689)• 1 year ago |

Duplicate of this bug: [1831818](/show_bug.cgi?id=1831818 "RESOLVED DUPLICATE - Input File Dialog Able to Overlap Fullscreen Notification Toast")

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 44](/show_bug.cgi?id=1821884#c44)• 1 year ago |
|  | |

Comment on [attachment 9333124](/attachment.cgi?id=9333124 "Bug 1821884 - Ensure consistent state for fullscreen/pointerlock warnings; r?Gijs") [[details]](/attachment.cgi?id=9333124&action=edit "Bug 1821884 - Ensure consistent state for fullscreen/pointerlock warnings; r?Gijs")

[Bug 1821884](/show_bug.cgi?id=1821884 "RESOLVED FIXED - File Open Dialog hide fullscreen notification") - Ensure consistent state for fullscreen/pointerlock warnings; r?Gijs

Approved for 115.2esr.

[Attachment #9333124](/attachment.cgi?id=9333124&action=edit "Bug 1821884 - Ensure consistent state for fullscreen/pointerlock warnings; r?Gijs") -
Flags: approval-mozilla-esr115? → approval-mozilla-esr115+

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1821884#a13536801_75935)• 1 year ago |

[Attachment #9334626](/attachment.cgi?id=9334626&action=edit "Bug 1821884 - Reshow initial fullscreen notification; r?Gijs") -
Flags: approval-mozilla-esr115? → approval-mozilla-esr115+

|  | [Pulsebot](/user_profile?user_id=510726) |  |
| --- | --- | --- |
| [Comment 45](/show_bug.cgi?id=1821884#c45)• 1 year ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-esr115/rev/da1ee5783d55>
<https://hg.mozilla.org/releases/mozilla-esr115/rev/e92bd14823a4>

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1821884#a13537446_75935)• 1 year ago |

[status-firefox-esr115](/buglist.cgi?f1=cf_status_firefox_esr115&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=fixed)

|  | [Brindusa Tot, Desktop QA](/user_profile?user_id=553429) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1821884#a14123567_553429)• 1 year ago |

QA Whiteboard: [post-critsmash-triage] → [post-critsmash-triage][qa-triaged]

|  | [Daniel Bodea [:danibodea]](/user_profile?user_id=616104) |  |
| --- | --- | --- |
| [Comment 46](/show_bug.cgi?id=1821884#c46)• 1 year ago |
|  | |

Based on [comment 40](/show_bug.cgi?id=1821884#c40 "RESOLVED FIXED - File Open Dialog hide fullscreen notification"), I confirm this fix on branch 117 (Nightly v117.0a1) and branch 116 (Beta 116.0 RC) for Windows and Ubuntu 22.

I have also verified it in Release v116.0.3 and ESR v115.2esr for Windows 10 and Ubuntu 22.

This fix is not present on MacOS and this is being addressed in blocked [bug 1846205](/show_bug.cgi?id=1846205 "VERIFIED FIXED - File picker should cause the browser window to lose focus on Mac").

[status-firefox116](/buglist.cgi?f1=cf_status_firefox116&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox116&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox116&o1=equals&v1=verified)
[status-firefox117](/buglist.cgi?f1=cf_status_firefox117&o1=isnotempty):
--- → [verified](/buglist.cgi?f1=cf_status_firefox117&o1=equals&v1=verified)
[status-firefox-esr115](/buglist.cgi?f1=cf_status_firefox_esr115&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=verified)

|  | [June Wilde (she/her) [:jewilde]](/user_profile?user_id=626341) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1821884#a14355035_626341)• 1 year ago |

Whiteboard: [reporter-external] [client-bounty-form] [verif?] [reminder-esr-uplift 2023-07-05] [adv-main116+] → [reporter-external] [client-bounty-form] [verif?] [reminder-esr-uplift 2023-07-05] [adv-main116+] [adv-esr115.2+]

|  | [Brindusa Tot, Desktop QA](/user_profile?user_id=553429) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1821884#a14696639_553429)• 1 year ago |

QA Whiteboard: [post-critsmash-triage][qa-triaged] → [post-critsmash-triage]Flags: qe-verify+

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1821884#a25762071_1689)• 1 year ago |

Group: core-security-release

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1821884#a25768579_1689)• 1 year ago |

Alias: CVE-2023-4051

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1821884#a38501203_5898)• 8 months ago |

Keywords: [reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)
You need to [log in](/show_bug.cgi?id=1821884&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Hafiizh](/user_profile?user_id=694415)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from www.mozilla.org_8ea4e939_20250111_003847.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    #### Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [#### Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    #### Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    #### Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    #### Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    #### Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    #### MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    #### Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    #### Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [#### About Mozilla](/en-US/about/)
  + [#### The Mozilla Manifesto](/en-US/about/manifesto/)
  + [#### Get Involved](/en-US/contribute/)
  + [#### Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [#### Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2023-38

## Security Vulnerabilities fixed in Thunderbird 115.2

Announced
August 29, 2023
Impact
high
Products
Thunderbird
Fixed in

* Thunderbird 115.2

*In general, these flaws cannot be exploited through email in the Thunderbird product because scripting is disabled when reading mail, but are potentially risks in browser or browser-like contexts.*

#### [#CVE-2023-4573: Memory corruption in IPC CanvasTranslator](#CVE-2023-4573)

Reporter
sonakkbi
Impact
high
##### Description

When receiving rendering data over IPC `mStream` could have been destroyed when initialized, which could have led to a use-after-free causing a potentially exploitable crash.

##### References

* [Bug 1846687](https://bugzilla.mozilla.org/show_bug.cgi?id=1846687)

#### [#CVE-2023-4574: Memory corruption in IPC ColorPickerShownCallback](#CVE-2023-4574)

Reporter
sonakkbi
Impact
high
##### Description

When creating a callback over IPC for showing the Color Picker window, multiple of the same callbacks could have been created at a time and eventually all simultaneously destroyed as soon as one of the callbacks finished. This could have led to a use-after-free causing a potentially exploitable crash.

##### References

* [Bug 1846688](https://bugzilla.mozilla.org/show_bug.cgi?id=1846688)

#### [#CVE-2023-4575: Memory corruption in IPC FilePickerShownCallback](#CVE-2023-4575)

Reporter
sonakkbi
Impact
high
##### Description

When creating a callback over IPC for showing the File Picker window, multiple of the same callbacks could have been created at a time and eventually all simultaneously destroyed as soon as one of the callbacks finished. This could have led to a use-after-free causing a potentially exploitable crash.

##### References

* [Bug 1846689](https://bugzilla.mozilla.org/show_bug.cgi?id=1846689)

#### [#CVE-2023-4576: Integer Overflow in RecordedSourceSurfaceCreation](#CVE-2023-4576)

Reporter
fffvr
Impact
high
##### Description

On Windows, an integer overflow could occur in `RecordedSourceSurfaceCreation` which resulted in a heap buffer overflow potentially leaking sensitive data that could have led to a sandbox escape.
*This bug only affects Firefox on Windows. Other operating systems are unaffected.*

##### References

* [Bug 1846694](https://bugzilla.mozilla.org/show_bug.cgi?id=1846694)

#### [#CVE-2023-4577: Memory corruption in JIT UpdateRegExpStatics](#CVE-2023-4577)

Reporter
Lukas Bernhard
Impact
high
##### Description

When `UpdateRegExpStatics` attempted to access `initialStringHeap` it could already have been garbage collected prior to entering the function, which could potentially have led to an exploitable crash.

##### References

* [Bug 1847397](https://bugzilla.mozilla.org/show_bug.cgi?id=1847397)

#### [#CVE-2023-4051: Full screen notification obscured by file open dialog](#CVE-2023-4051)

Reporter
Hafiizh
Impact
moderate
##### Description

A website could have obscured the full screen notification by using the file open dialog. This could have led to user confusion and possible spoofing attacks.

##### References

* [Bug 1821884](https://bugzilla.mozilla.org/show_bug.cgi?id=1821884)

#### [#CVE-2023-4578: Error reporting methods in SpiderMonkey could have triggered an Out of Memory Exception](#CVE-2023-4578)

Reporter
Irvan Kurniawan (@sourc7)
Impact
moderate
##### Description

When calling `JS::CheckRegExpSyntax` a Syntax Error could have been set which would end in calling `convertToRuntimeErrorAndClear`. A path in the function could attempt to allocate memory when none is available which would have caused a newly created Out of Memory exception to be mishandled as a Syntax Error.

##### References

* [Bug 1839007](https://bugzilla.mozilla.org/show_bug.cgi?id=1839007)

#### [#CVE-2023-4053: Full screen notification obscured by external program](#CVE-2023-4053)

Reporter
Umar Farooq
Impact
moderate
##### Description

A website could have obscured the full screen notification by using a URL with a scheme handled by an external program, such as a mailto URL. This could have led to user confusion and possible spoofing attacks.

##### References

* [Bug 1839079](https://bugzilla.mozilla.org/show_bug.cgi?id=1839079)

#### [#CVE-2023-4580: Push notifications saved to disk unencrypted](#CVE-2023-4580)

Reporter
Harveer Singh
Impact
moderate
##### Description

Push notifications stored on disk in private browsing mode were not being encrypted potentially allowing the leak of sensitive information.

##### References

* [Bug 1843046](https://bugzilla.mozilla.org/show_bug.cgi?id=1843046)

#### [#CVE-2023-4581: XLL file extensions were downloadable without warnings](#CVE-2023-4581)

Reporter
Umar Farooq (@Puf)
Impact
moderate
##### Description

Excel `.xll` add-in files did not have a blocklist entry in Firefox's executable blocklist which allowed them to be downloaded without any warning of their potential harm.

##### References

* [Bug 1843758](https://bugzilla.mozilla.org/show_bug.cgi?id=1843758)

#### [#CVE-2023-4582: Buffer Overflow in WebGL glGetProgramiv](#CVE-2023-4582)

Reporter
Dohyun Lee (@l33d0hyun) of SSD-Disclosure Labs & DNSLab, Korea Univ.
Impact
low
##### Description

Due to large allocation checks in Angle for glsl shaders being too lenient a buffer overflow could have occured when allocating too much private shader memory on mac OS.
*This bug only affects Firefox on macOS. Other operating systems are unaffected.*

##### References

* [Bug 1773874](https://bugzilla.mozilla.org/show_bug.cgi?id=1773874)

#### [#CVE-2023-4583: Browsing Context potentially not cleared when closing Private Window](#CVE-2023-4583)

Reporter
Thejaka Maldeniya
Impact
low
##### Description

When checking if the Browsing Context had been discarded in `HttpBaseChannel`, if the load group was not available then it was assumed to have already been discarded which was not always the case for private channels after the private session had ended.

##### References

* [Bug 1842030](https://bugzilla.mozilla.org/show_bug.cgi?id=1842030)

#### [#CVE-2023-4584: Memory safety bugs fixed in Firefox 117, Firefox ESR 102.15, Firefox ESR 115.2, Thunderbird 102.15, and Thunderbird 115.2](#CVE-2023-4584)

Reporter
Randell Jesup, Andrew McCreight, the Mozilla Fuzzing Team
Impact
high
##### Description

Memory safety bugs present in Firefox 116, Firefox ESR 102.14, Firefox ESR 115.1, Thunderbird 102.14, and Thunderbird 115.1. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 117, Firefox ESR 102.15, Firefox ESR 115.2, Thunderbird 102.15, and Thunderbird 115.2](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1843968%2C1845205%2C1846080%2C1846526%2C1847529)

#### [#CVE-2023-4585: Memory safety bugs fixed in Firefox 117, Firefox ESR 115.2, and Thunderbird 115.2](#CVE-2023-4585)

Reporter
Donal Meehan, Sebastian Hengst, and the Mozilla Fuzzing Team
Impact
high
##### Description

Memory safety bugs present in Firefox 116, Firefox ESR 115.1, and Thunderbird 115.1. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 117, Firefox ESR 115.2, and Thunderbird 115.2](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1751583%2C1833504%2C1841082%2C1847904%2C1848999)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from www.mozilla.org_e6b091cb_20250111_003846.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    #### Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [#### Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    #### Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    #### Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    #### Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    #### Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    #### MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    #### Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    #### Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [#### About Mozilla](/en-US/about/)
  + [#### The Mozilla Manifesto](/en-US/about/manifesto/)
  + [#### Get Involved](/en-US/contribute/)
  + [#### Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [#### Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2023-36

## Security Vulnerabilities fixed in Firefox ESR 115.2

Announced
August 29, 2023
Impact
high
Products
Firefox ESR
Fixed in

* Firefox ESR 115.2

#### [#CVE-2023-4573: Memory corruption in IPC CanvasTranslator](#CVE-2023-4573)

Reporter
sonakkbi
Impact
high
##### Description

When receiving rendering data over IPC `mStream` could have been destroyed when initialized, which could have led to a use-after-free causing a potentially exploitable crash.

##### References

* [Bug 1846687](https://bugzilla.mozilla.org/show_bug.cgi?id=1846687)

#### [#CVE-2023-4574: Memory corruption in IPC ColorPickerShownCallback](#CVE-2023-4574)

Reporter
sonakkbi
Impact
high
##### Description

When creating a callback over IPC for showing the Color Picker window, multiple of the same callbacks could have been created at a time and eventually all simultaneously destroyed as soon as one of the callbacks finished. This could have led to a use-after-free causing a potentially exploitable crash.

##### References

* [Bug 1846688](https://bugzilla.mozilla.org/show_bug.cgi?id=1846688)

#### [#CVE-2023-4575: Memory corruption in IPC FilePickerShownCallback](#CVE-2023-4575)

Reporter
sonakkbi
Impact
high
##### Description

When creating a callback over IPC for showing the File Picker window, multiple of the same callbacks could have been created at a time and eventually all simultaneously destroyed as soon as one of the callbacks finished. This could have led to a use-after-free causing a potentially exploitable crash.

##### References

* [Bug 1846689](https://bugzilla.mozilla.org/show_bug.cgi?id=1846689)

#### [#CVE-2023-4576: Integer Overflow in RecordedSourceSurfaceCreation](#CVE-2023-4576)

Reporter
fffvr
Impact
high
##### Description

On Windows, an integer overflow could occur in `RecordedSourceSurfaceCreation` which resulted in a heap buffer overflow potentially leaking sensitive data that could have led to a sandbox escape.
*This bug only affects Firefox on Windows. Other operating systems are unaffected.*

##### References

* [Bug 1846694](https://bugzilla.mozilla.org/show_bug.cgi?id=1846694)

#### [#CVE-2023-4577: Memory corruption in JIT UpdateRegExpStatics](#CVE-2023-4577)

Reporter
Lukas Bernhard
Impact
high
##### Description

When `UpdateRegExpStatics` attempted to access `initialStringHeap` it could already have been garbage collected prior to entering the function, which could potentially have led to an exploitable crash.

##### References

* [Bug 1847397](https://bugzilla.mozilla.org/show_bug.cgi?id=1847397)

#### [#CVE-2023-4051: Full screen notification obscured by file open dialog](#CVE-2023-4051)

Reporter
Hafiizh
Impact
moderate
##### Description

A website could have obscured the full screen notification by using the file open dialog. This could have led to user confusion and possible spoofing attacks.

##### References

* [Bug 1821884](https://bugzilla.mozilla.org/show_bug.cgi?id=1821884)

#### [#CVE-2023-4578: Error reporting methods in SpiderMonkey could have triggered an Out of Memory Exception](#CVE-2023-4578)

Reporter
Irvan Kurniawan (@sourc7)
Impact
moderate
##### Description

When calling `JS::CheckRegExpSyntax` a Syntax Error could have been set which would end in calling `convertToRuntimeErrorAndClear`. A path in the function could attempt to allocate memory when none is available which would have caused a newly created Out of Memory exception to be mishandled as a Syntax Error.

##### References

* [Bug 1839007](https://bugzilla.mozilla.org/show_bug.cgi?id=1839007)

#### [#CVE-2023-4053: Full screen notification obscured by external program](#CVE-2023-4053)

Reporter
Umar Farooq
Impact
moderate
##### Description

A website could have obscured the full screen notification by using a URL with a scheme handled by an external program, such as a mailto URL. This could have led to user confusion and possible spoofing attacks.

##### References

* [Bug 1839079](https://bugzilla.mozilla.org/show_bug.cgi?id=1839079)

#### [#CVE-2023-4580: Push notifications saved to disk unencrypted](#CVE-2023-4580)

Reporter
Harveer Singh
Impact
moderate
##### Description

Push notifications stored on disk in private browsing mode were not being encrypted potentially allowing the leak of sensitive information.

##### References

* [Bug 1843046](https://bugzilla.mozilla.org/show_bug.cgi?id=1843046)

#### [#CVE-2023-4581: XLL file extensions were downloadable without warnings](#CVE-2023-4581)

Reporter
Umar Farooq (@Puf)
Impact
moderate
##### Description

Excel `.xll` add-in files did not have a blocklist entry in Firefox's executable blocklist which allowed them to be downloaded without any warning of their potential harm.

##### References

* [Bug 1843758](https://bugzilla.mozilla.org/show_bug.cgi?id=1843758)

#### [#CVE-2023-4582: Buffer Overflow in WebGL glGetProgramiv](#CVE-2023-4582)

Reporter
Dohyun Lee (@l33d0hyun) of SSD-Disclosure Labs & DNSLab, Korea Univ.
Impact
low
##### Description

Due to large allocation checks in Angle for glsl shaders being too lenient a buffer overflow could have occured when allocating too much private shader memory on mac OS.
*This bug only affects Firefox on macOS. Other operating systems are unaffected.*

##### References

* [Bug 1773874](https://bugzilla.mozilla.org/show_bug.cgi?id=1773874)

#### [#CVE-2023-4583: Browsing Context potentially not cleared when closing Private Window](#CVE-2023-4583)

Reporter
Thejaka Maldeniya
Impact
low
##### Description

When checking if the Browsing Context had been discarded in `HttpBaseChannel`, if the load group was not available then it was assumed to have already been discarded which was not always the case for private channels after the private session had ended.

##### References

* [Bug 1842030](https://bugzilla.mozilla.org/show_bug.cgi?id=1842030)

#### [#CVE-2023-4584: Memory safety bugs fixed in Firefox 117, Firefox ESR 102.15, Firefox ESR 115.2, Thunderbird 102.15, and Thunderbird 115.2](#CVE-2023-4584)

Reporter
Randell Jesup, Andrew McCreight, the Mozilla Fuzzing Team
Impact
high
##### Description

Memory safety bugs present in Firefox 116, Firefox ESR 102.14, Firefox ESR 115.1, Thunderbird 102.14, and Thunderbird 115.1. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 117, Firefox ESR 102.15, Firefox ESR 115.2, Thunderbird 102.15, and Thunderbird 115.2](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1843968%2C1845205%2C1846080%2C1846526%2C1847529)

#### [#CVE-2023-4585: Memory safety bugs fixed in Firefox 117, Firefox ESR 115.2, and Thunderbird 115.2](#CVE-2023-4585)

Reporter
Donal Meehan, Sebastian Hengst, and the Mozilla Fuzzing Team
Impact
high
##### Description

Memory safety bugs present in Firefox 116, Firefox ESR 115.1, and Thunderbird 115.1. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 117, Firefox ESR 115.2, and Thunderbird 115.2](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1751583%2C1833504%2C1841082%2C1847904%2C1848999)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from www.mozilla.org_542934ad_20250111_003845.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    #### Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [#### Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    #### Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    #### Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    #### Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    #### Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    #### MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    #### Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    #### Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [#### About Mozilla](/en-US/about/)
  + [#### The Mozilla Manifesto](/en-US/about/manifesto/)
  + [#### Get Involved](/en-US/contribute/)
  + [#### Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [#### Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2023-29

## Security Vulnerabilities fixed in Firefox 116

Announced
August 1, 2023
Impact
high
Products
Firefox
Fixed in

* Firefox 116

#### [#CVE-2023-4045: Offscreen Canvas could have bypassed cross-origin restrictions](#CVE-2023-4045)

Reporter
Max Vlasov
Impact
high
##### Description

Offscreen Canvas did not properly track cross-origin tainting, which could have been used to access image data from another site in violation of same-origin policy.

##### References

* [Bug 1833876](https://bugzilla.mozilla.org/show_bug.cgi?id=1833876)

#### [#CVE-2023-4046: Incorrect value used during WASM compilation](#CVE-2023-4046)

Reporter
Alexander Guryanov
Impact
high
##### Description

In some circumstances, a stale value could have been used for a global variable in WASM JIT analysis. This resulted in incorrect compilation and a potentially exploitable crash in the content process.

##### References

* [Bug 1837686](https://bugzilla.mozilla.org/show_bug.cgi?id=1837686)

#### [#CVE-2023-4047: Potential permissions request bypass via clickjacking](#CVE-2023-4047)

Reporter
Axel Chong (@Haxatron)
Impact
high
##### Description

A bug in popup notifications delay calculation could have made it possible for an attacker to trick a user into granting permissions.

##### References

* [Bug 1839073](https://bugzilla.mozilla.org/show_bug.cgi?id=1839073)

#### [#CVE-2023-4048: Crash in DOMParser due to out-of-memory conditions](#CVE-2023-4048)

Reporter
Irvan Kurniawan
Impact
high
##### Description

An out-of-bounds read could have led to an exploitable crash when parsing HTML with DOMParser in low memory situations.

##### References

* [Bug 1841368](https://bugzilla.mozilla.org/show_bug.cgi?id=1841368)

#### [#CVE-2023-4049: Fix potential race conditions when releasing platform objects](#CVE-2023-4049)

Reporter
Nika Layzell
Impact
high
##### Description

Race conditions in reference counting code were found through code inspection. These could have resulted in potentially exploitable use-after-free vulnerabilities.

##### References

* [Bug 1842658](https://bugzilla.mozilla.org/show_bug.cgi?id=1842658)

#### [#CVE-2023-4050: Stack buffer overflow in StorageManager](#CVE-2023-4050)

Reporter
Mark Brand
Impact
high
##### Description

In some cases, an untrusted input stream was copied to a stack buffer without checking its size. This resulted in a potentially exploitable crash which could have led to a sandbox escape.

##### References

* [Bug 1843038](https://bugzilla.mozilla.org/show_bug.cgi?id=1843038)

#### [#CVE-2023-4051: Full screen notification obscured by file open dialog](#CVE-2023-4051)

Reporter
Hafiizh
Impact
moderate
##### Description

A website could have obscured the full screen notification by using the file open dialog. This could have led to user confusion and possible spoofing attacks.

##### References

* [Bug 1821884](https://bugzilla.mozilla.org/show_bug.cgi?id=1821884)

#### [#CVE-2023-4052: File deletion and privilege escalation through Firefox uninstaller](#CVE-2023-4052)

Reporter
ycdxsb
Impact
moderate
##### Description

The Firefox updater created a directory writable by non-privileged users. When uninstalling Firefox, any files in that directory would be recursively deleted with the permissions of the uninstalling user account. This could be combined with creation of a junction (a form of symbolic link) to allow arbitrary file deletion controlled by the non-privileged user.
*This bug only affects Firefox on Windows. Other operating systems are unaffected.*

##### References

* [Bug 1824420](https://bugzilla.mozilla.org/show_bug.cgi?id=1824420)

#### [#CVE-2023-4053: Full screen notification obscured by external program](#CVE-2023-4053)

Reporter
P Umar Farooq
Impact
moderate
##### Description

A website could have obscured the full screen notification by using a URL with a scheme handled by an external program, such as a mailto URL. This could have led to user confusion and possible spoofing attacks.

##### References

* [Bug 1839079](https://bugzilla.mozilla.org/show_bug.cgi?id=1839079)

#### [#CVE-2023-4054: Lack of warning when opening appref-ms files](#CVE-2023-4054)

Reporter
P Umar Farooq
Impact
moderate
##### Description

When opening appref-ms files, Firefox did not warn the user that these files may contain malicious code.
*This bug only affects Firefox on Windows. Other operating systems are unaffected.*

##### References

* [Bug 1840777](https://bugzilla.mozilla.org/show_bug.cgi?id=1840777)

#### [#CVE-2023-4055: Cookie jar overflow caused unexpected cookie jar state](#CVE-2023-4055)

Reporter
Marco Squarcina
Impact
low
##### Description

When the number of cookies per domain was exceeded in `document.cookie`, the actual cookie jar sent to the host was no longer consistent with expected cookie jar state. This could have caused requests to be sent with some cookies missing.

##### References

* [Bug 1782561](https://bugzilla.mozilla.org/show_bug.cgi?id=1782561)

#### [#CVE-2023-4056: Memory safety bugs fixed in Firefox 116, Firefox ESR 115.1, Firefox ESR 102.14, Thunderbird 115.1, and Thunderbird 102.14](#CVE-2023-4056)

Reporter
Dianna Smith, Ryan VanderMeulen, Timothy Nikkel, and the Mozilla Fuzzing Team
Impact
high
##### Description

Memory safety bugs present in Firefox 115, Firefox ESR 115.0, Firefox ESR 102.13, Thunderbird 115.0, and Thunderbird 102.13. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 116, Firefox ESR 115.1, Firefox ESR 102.14, Thunderbird 115.1, and Thunderbird 102.14](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1820587%2C1824634%2C1839235%2C1842325%2C1843847)

#### [#CVE-2023-4057: Memory safety bugs fixed in Firefox 116, Firefox ESR 115.1, and Thunderbird 115.1](#CVE-2023-4057)

Reporter
The Mozilla Fuzzing Team
Impact
high
##### Description

Memory safety bugs present in Firefox 115, Firefox ESR 115.0, and Thunderbird 115.0. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 116, Firefox ESR 115.1, and Thunderbird 115.1](https://bugzilla.mozilla.org/show_bug.cgi?id=1841682)

#### [#CVE-2023-4058: Memory safety bugs fixed in Firefox 116](#CVE-2023-4058)

Reporter
Andrew McCreight and the Mozilla Fuzzing Team
Impact
high
##### Description

Memory safety bugs present in Firefox 115. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 116](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1819160%2C1828024)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)


