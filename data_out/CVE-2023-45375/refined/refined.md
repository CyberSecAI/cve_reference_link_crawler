- **Root cause of vulnerability:** The `PireosPayValidationModuleFrontController::postProcess()` method in the PireosPay module for PrestaShop contains sensitive SQL calls that are vulnerable to SQL injection. The module fails to properly sanitize user input (`$post_data_array[7]`) before using it in SQL queries.

- **Weaknesses/vulnerabilities present:**
    - SQL Injection (CWE-89): User-supplied data is directly incorporated into SQL queries without proper sanitization. Specifically, the `cart_id` parameter is used in `SELECT` statements without being escaped.
    - Lack of input validation and sanitization.

- **Impact of exploitation:**
    - Complete compromise of the PrestaShop database, including the ability to:
      - Obtain admin access.
      - Remove or modify data.
      - Expose sensitive data such as tokens and unlock admin ajax scripts.
      - Hijack emails by modifying SMTP settings.
    - Credit card theft through the deployment of a webskimmer.

- **Attack vectors:**
    - Network: The vulnerability can be exploited over the network using HTTP requests.
    - A simple POST request is sufficient to trigger the vulnerability.

- **Required attacker capabilities/position:**
    - The attacker does not need to be authenticated or have any special privileges.
    - The attacker can exploit the vulnerability with a basic HTTP request to a publicly accessible URL.

- **Additional details:**
    - The exploit is actively used to deploy webskimmers for credit card theft.
    - Exploitation of this vulnerability may not be directly visible in conventional frontend logs, as attackers can conceal the module's controller path. The requests will only appear as "POST /" in the logs.
    - The patch implemented in version 1.7.10 involves using `pSQL()` function to sanitize user input.
    - The vulnerability is located in the `modules/pireospay/controllers/front/validation.php` file
    - Attackers are able to execute arbitrary SQL queries using the `MerchantReference` parameter.