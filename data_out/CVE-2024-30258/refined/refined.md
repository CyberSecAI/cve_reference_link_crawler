Based on the provided information, here's a breakdown of the vulnerability:

**CVE ID:** CVE-2024-30258

**Root Cause of Vulnerability:**
The vulnerability stems from improper handling of malformed RTPS (Real-Time Publish-Subscribe) packets within the Fast-DDS library. Specifically, when a subscriber receives a malformed packet, it attempts to allocate a large amount of memory, leading to an out-of-memory error and subsequent crash. This occurs during the processing of property sequences within the packet.

**Weaknesses/Vulnerabilities Present:**
- **Insufficient Input Validation:** The library fails to adequately validate the structure and content of incoming RTPS packets.
- **Unbounded Memory Allocation:** The code does not properly check the size of the property sequences before allocating memory, leading to excessive memory allocation. This allows an attacker to cause an out of memory condition.

**Impact of Exploitation:**
- **Denial of Service (DoS):** A remote attacker can crash a Fast-DDS process by sending a crafted malformed RTPS packet. This can interrupt communication and functionality that relies on Fast-DDS.

**Attack Vectors:**
- **Network-based:** The attacker sends a malformed RTPS packet over the network to a vulnerable Fast-DDS subscriber.

**Required Attacker Capabilities/Position:**
- **Network Access:** The attacker needs to be able to send network packets to a vulnerable Fast-DDS subscriber.
- **Packet Crafting:** The attacker needs to be capable of crafting a malformed RTPS packet.

**Technical Details:**
- The vulnerability occurs when parsing `PropertySeq` and `BinaryPropertySeq` data within a message. The code uses the length of the sequence to allocate memory without verifying its validity.
- A malformed packet can specify a large length for the sequences, leading to the allocation of an extremely large memory block, exhausting available memory, and causing the application to crash.
- The crash occurs in the `std::vector` allocation logic when it attempts to resize the vector based on the length field provided in the malformed packet.
- The ASAN log shows the crash occurs due to an out-of-memory error during allocation for `eprosima::fastrtps::rtps::Property`.

**Affected Versions:**
- <= 2.14.0

**Patched Versions:**
- 2.14.1 / 2.13.5 / 2.10.4 / 2.6.8

**Additional Notes:**
- The provided content includes a proof-of-concept (PoC) with instructions on how to reproduce the crash, including how to build Fast-DDS and use the packet replayer.
- The fix involves adding checks on the parameter length when reading property sequences, binary property sequences and data holder sequences in the `CDRMessage.hpp` file. The `ParameterSerializer.hpp` is also updated to ensure parameter lengths are checked when using a `DataHolder`.
- The commit identified as fixing the issue is `65236f93e9c4ea3ff9a49fba4dfd9e43eb94037b`