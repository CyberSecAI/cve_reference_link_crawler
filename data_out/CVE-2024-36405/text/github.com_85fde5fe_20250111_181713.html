
[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fopen-quantum-safe%2Fliboqs%2Fblob%2F7eecda6095c003ddded7175a1ffdf35a2ce63ed5%2Fsrc%2Fkem%2Fkyber%2Fpqcrystals-kyber_kyber512_ref%2Fpoly.c)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fopen-quantum-safe%2Fliboqs%2Fblob%2F7eecda6095c003ddded7175a1ffdf35a2ce63ed5%2Fsrc%2Fkem%2Fkyber%2Fpqcrystals-kyber_kyber512_ref%2Fpoly.c)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=open-quantum-safe%2Fliboqs)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[open-quantum-safe](/open-quantum-safe)
/
**[liboqs](/open-quantum-safe/liboqs)**
Public

* [Notifications](/login?return_to=%2Fopen-quantum-safe%2Fliboqs) You must be signed in to change notification settings
* [Fork
  484](/login?return_to=%2Fopen-quantum-safe%2Fliboqs)
* [Star
   2k](/login?return_to=%2Fopen-quantum-safe%2Fliboqs)

* [Code](/open-quantum-safe/liboqs)
* [Issues
  82](/open-quantum-safe/liboqs/issues)
* [Pull requests
  9](/open-quantum-safe/liboqs/pulls)
* [Discussions](/open-quantum-safe/liboqs/discussions)
* [Actions](/open-quantum-safe/liboqs/actions)
* [Projects
  0](/open-quantum-safe/liboqs/projects)
* [Wiki](/open-quantum-safe/liboqs/wiki)
* [Security](/open-quantum-safe/liboqs/security)
* [Insights](/open-quantum-safe/liboqs/pulse)

Additional navigation options

* [Code](/open-quantum-safe/liboqs)
* [Issues](/open-quantum-safe/liboqs/issues)
* [Pull requests](/open-quantum-safe/liboqs/pulls)
* [Discussions](/open-quantum-safe/liboqs/discussions)
* [Actions](/open-quantum-safe/liboqs/actions)
* [Projects](/open-quantum-safe/liboqs/projects)
* [Wiki](/open-quantum-safe/liboqs/wiki)
* [Security](/open-quantum-safe/liboqs/security)
* [Insights](/open-quantum-safe/liboqs/pulse)

## Files

 7eecda6
## Breadcrumbs

1. [liboqs](/open-quantum-safe/liboqs/tree/7eecda6095c003ddded7175a1ffdf35a2ce63ed5)
2. /[src](/open-quantum-safe/liboqs/tree/7eecda6095c003ddded7175a1ffdf35a2ce63ed5/src)
3. /[kem](/open-quantum-safe/liboqs/tree/7eecda6095c003ddded7175a1ffdf35a2ce63ed5/src/kem)
4. /[kyber](/open-quantum-safe/liboqs/tree/7eecda6095c003ddded7175a1ffdf35a2ce63ed5/src/kem/kyber)
5. /[pqcrystals-kyber\_kyber512\_ref](/open-quantum-safe/liboqs/tree/7eecda6095c003ddded7175a1ffdf35a2ce63ed5/src/kem/kyber/pqcrystals-kyber_kyber512_ref)
/
# poly.c

Copy path Blame  Blame
## Latest commit

## History

[History](/open-quantum-safe/liboqs/commits/7eecda6095c003ddded7175a1ffdf35a2ce63ed5/src/kem/kyber/pqcrystals-kyber_kyber512_ref/poly.c)359 lines (334 loc) · 10.9 KB 7eecda6
## Breadcrumbs

1. [liboqs](/open-quantum-safe/liboqs/tree/7eecda6095c003ddded7175a1ffdf35a2ce63ed5)
2. /[src](/open-quantum-safe/liboqs/tree/7eecda6095c003ddded7175a1ffdf35a2ce63ed5/src)
3. /[kem](/open-quantum-safe/liboqs/tree/7eecda6095c003ddded7175a1ffdf35a2ce63ed5/src/kem)
4. /[kyber](/open-quantum-safe/liboqs/tree/7eecda6095c003ddded7175a1ffdf35a2ce63ed5/src/kem/kyber)
5. /[pqcrystals-kyber\_kyber512\_ref](/open-quantum-safe/liboqs/tree/7eecda6095c003ddded7175a1ffdf35a2ce63ed5/src/kem/kyber/pqcrystals-kyber_kyber512_ref)
/
# poly.c

Top
## File metadata and controls

* Code
* Blame

359 lines (334 loc) · 10.9 KB[Raw](https://github.com/open-quantum-safe/liboqs/raw/7eecda6095c003ddded7175a1ffdf35a2ce63ed5/src/kem/kyber/pqcrystals-kyber_kyber512_ref/poly.c)123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257258259260261262263264265266267268269270271272273274275276277278279280281282283284285286287288289290291292293294295296297298299300301302303304305306307308309310311312313314315316317318319320321322323324325326327328329330331332333334335336337338339340341342343344345346347348349350351352353354355356357358359#include <stdint.h>#include "params.h"#include "poly.h"#include "ntt.h"#include "reduce.h"#include "cbd.h"#include "symmetric.h"
/\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\* Name: poly\_compress\*\* Description: Compression and subsequent serialization of a polynomial\*\* Arguments: - uint8\_t \*r: pointer to output byte array\* (of length KYBER\_POLYCOMPRESSEDBYTES)\* - const poly \*a: pointer to input polynomial\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*/void poly\_compress(uint8\_t r[KYBER\_POLYCOMPRESSEDBYTES], const poly \*a){ unsigned int i,j; int16\_t u; uint32\_t d0; uint8\_t t[8];
#if (KYBER\_POLYCOMPRESSEDBYTES == 128) for(i=0;i<KYBER\_N/8;i++) { for(j=0;j<8;j++) { // map to positive standard representatives u = a->coeffs[8\*i+j]; u += (u >> 15) & KYBER\_Q;/\* t[j] = ((((uint16\_t)u << 4) + KYBER\_Q/2)/KYBER\_Q) & 15; \*/ d0 = u << 4; d0 += 1665; d0 \*= 80635; d0 >>= 28; t[j] = d0 & 0xf; }
 r[0] = t[0] | (t[1] << 4); r[1] = t[2] | (t[3] << 4); r[2] = t[4] | (t[5] << 4); r[3] = t[6] | (t[7] << 4); r += 4; }#elif (KYBER\_POLYCOMPRESSEDBYTES == 160) for(i=0;i<KYBER\_N/8;i++) { for(j=0;j<8;j++) { // map to positive standard representatives u = a->coeffs[8\*i+j]; u += (u >> 15) & KYBER\_Q;/\* t[j] = ((((uint32\_t)u << 5) + KYBER\_Q/2)/KYBER\_Q) & 31; \*/ d0 = u << 5; d0 += 1664; d0 \*= 40318; d0 >>= 27; t[j] = d0 & 0x1f; }
 r[0] = (t[0] >> 0) | (t[1] << 5); r[1] = (t[1] >> 3) | (t[2] << 2) | (t[3] << 7); r[2] = (t[3] >> 1) | (t[4] << 4); r[3] = (t[4] >> 4) | (t[5] << 1) | (t[6] << 6); r[4] = (t[6] >> 2) | (t[7] << 3); r += 5; }#else#error "KYBER\_POLYCOMPRESSEDBYTES needs to be in {128, 160}"#endif}
/\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\* Name: poly\_decompress\*\* Description: De-serialization and subsequent decompression of a polynomial;\* approximate inverse of poly\_compress\*\* Arguments: - poly \*r: pointer to output polynomial\* - const uint8\_t \*a: pointer to input byte array\* (of length KYBER\_POLYCOMPRESSEDBYTES bytes)\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*/void poly\_decompress(poly \*r, const uint8\_t a[KYBER\_POLYCOMPRESSEDBYTES]){ unsigned int i;
#if (KYBER\_POLYCOMPRESSEDBYTES == 128) for(i=0;i<KYBER\_N/2;i++) { r->coeffs[2\*i+0] = (((uint16\_t)(a[0] & 15)\*KYBER\_Q) + 8) >> 4; r->coeffs[2\*i+1] = (((uint16\_t)(a[0] >> 4)\*KYBER\_Q) + 8) >> 4; a += 1; }#elif (KYBER\_POLYCOMPRESSEDBYTES == 160) unsigned int j; uint8\_t t[8]; for(i=0;i<KYBER\_N/8;i++) { t[0] = (a[0] >> 0); t[1] = (a[0] >> 5) | (a[1] << 3); t[2] = (a[1] >> 2); t[3] = (a[1] >> 7) | (a[2] << 1); t[4] = (a[2] >> 4) | (a[3] << 4); t[5] = (a[3] >> 1); t[6] = (a[3] >> 6) | (a[4] << 2); t[7] = (a[4] >> 3); a += 5;
 for(j=0;j<8;j++) r->coeffs[8\*i+j] = ((uint32\_t)(t[j] & 31)\*KYBER\_Q + 16) >> 5; }#else#error "KYBER\_POLYCOMPRESSEDBYTES needs to be in {128, 160}"#endif}
/\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\* Name: poly\_tobytes\*\* Description: Serialization of a polynomial\*\* Arguments: - uint8\_t \*r: pointer to output byte array\* (needs space for KYBER\_POLYBYTES bytes)\* - const poly \*a: pointer to input polynomial\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*/void poly\_tobytes(uint8\_t r[KYBER\_POLYBYTES], const poly \*a){ unsigned int i; uint16\_t t0, t1;
 for(i=0;i<KYBER\_N/2;i++) { // map to positive standard representatives t0 = a->coeffs[2\*i]; t0 += ((int16\_t)t0 >> 15) & KYBER\_Q; t1 = a->coeffs[2\*i+1]; t1 += ((int16\_t)t1 >> 15) & KYBER\_Q; r[3\*i+0] = (t0 >> 0); r[3\*i+1] = (t0 >> 8) | (t1 << 4); r[3\*i+2] = (t1 >> 4); }}
/\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\* Name: poly\_frombytes\*\* Description: De-serialization of a polynomial;\* inverse of poly\_tobytes\*\* Arguments: - poly \*r: pointer to output polynomial\* - const uint8\_t \*a: pointer to input byte array\* (of KYBER\_POLYBYTES bytes)\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*/void poly\_frombytes(poly \*r, const uint8\_t a[KYBER\_POLYBYTES]){ unsigned int i; for(i=0;i<KYBER\_N/2;i++) { r->coeffs[2\*i] = ((a[3\*i+0] >> 0) | ((uint16\_t)a[3\*i+1] << 8)) & 0xFFF; r->coeffs[2\*i+1] = ((a[3\*i+1] >> 4) | ((uint16\_t)a[3\*i+2] << 4)) & 0xFFF; }}
/\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\* Name: poly\_frommsg\*\* Description: Convert 32-byte message to polynomial\*\* Arguments: - poly \*r: pointer to output polynomial\* - const uint8\_t \*msg: pointer to input message\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*/void poly\_frommsg(poly \*r, const uint8\_t msg[KYBER\_INDCPA\_MSGBYTES]){ unsigned int i,j; int16\_t mask;
#if (KYBER\_INDCPA\_MSGBYTES != KYBER\_N/8)#error "KYBER\_INDCPA\_MSGBYTES must be equal to KYBER\_N/8 bytes!"#endif
 for(i=0;i<KYBER\_N/8;i++) { for(j=0;j<8;j++) { mask = -(int16\_t)((msg[i] >> j)&1); r->coeffs[8\*i+j] = mask & ((KYBER\_Q+1)/2); } }}
/\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\* Name: poly\_tomsg\*\* Description: Convert polynomial to 32-byte message\*\* Arguments: - uint8\_t \*msg: pointer to output message\* - const poly \*a: pointer to input polynomial\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*/void poly\_tomsg(uint8\_t msg[KYBER\_INDCPA\_MSGBYTES], const poly \*a){ unsigned int i,j; uint32\_t t;
 for(i=0;i<KYBER\_N/8;i++) { msg[i] = 0; for(j=0;j<8;j++) { t = a->coeffs[8\*i+j]; // t += ((int16\_t)t >> 15) & KYBER\_Q; // t = (((t << 1) + KYBER\_Q/2)/KYBER\_Q) & 1; t <<= 1; t += 1665; t \*= 80635; t >>= 28; t &= 1; msg[i] |= t << j; } }}
/\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\* Name: poly\_getnoise\_eta1\*\* Description: Sample a polynomial deterministically from a seed and a nonce,\* with output polynomial close to centered binomial distribution\* with parameter KYBER\_ETA1\*\* Arguments: - poly \*r: pointer to output polynomial\* - const uint8\_t \*seed: pointer to input seed\* (of length KYBER\_SYMBYTES bytes)\* - uint8\_t nonce: one-byte input nonce\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*/void poly\_getnoise\_eta1(poly \*r, const uint8\_t seed[KYBER\_SYMBYTES], uint8\_t nonce){ uint8\_t buf[KYBER\_ETA1\*KYBER\_N/4]; prf(buf, sizeof(buf), seed, nonce); poly\_cbd\_eta1(r, buf);}
/\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\* Name: poly\_getnoise\_eta2\*\* Description: Sample a polynomial deterministically from a seed and a nonce,\* with output polynomial close to centered binomial distribution\* with parameter KYBER\_ETA2\*\* Arguments: - poly \*r: pointer to output polynomial\* - const uint8\_t \*seed: pointer to input seed\* (of length KYBER\_SYMBYTES bytes)\* - uint8\_t nonce: one-byte input nonce\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*/void poly\_getnoise\_eta2(poly \*r, const uint8\_t seed[KYBER\_SYMBYTES], uint8\_t nonce){ uint8\_t buf[KYBER\_ETA2\*KYBER\_N/4]; prf(buf, sizeof(buf), seed, nonce); poly\_cbd\_eta2(r, buf);}
/\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\* Name: poly\_ntt\*\* Description: Computes negacyclic number-theoretic transform (NTT) of\* a polynomial in place;\* inputs assumed to be in normal order, output in bitreversed order\*\* Arguments: - uint16\_t \*r: pointer to in/output polynomial\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*/void poly\_ntt(poly \*r){ ntt(r->coeffs); poly\_reduce(r);}
/\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\* Name: poly\_invntt\_tomont\*\* Description: Computes inverse of negacyclic number-theoretic transform (NTT)\* of a polynomial in place;\* inputs assumed to be in bitreversed order, output in normal order\*\* Arguments: - uint16\_t \*a: pointer to in/output polynomial\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*/void poly\_invntt\_tomont(poly \*r){ invntt(r->coeffs);}
/\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\* Name: poly\_basemul\_montgomery\*\* Description: Multiplication of two polynomials in NTT domain\*\* Arguments: - poly \*r: pointer to output polynomial\* - const poly \*a: pointer to first input polynomial\* - const poly \*b: pointer to second input polynomial\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*/void poly\_basemul\_montgomery(poly \*r, const poly \*a, const poly \*b){ unsigned int i; for(i=0;i<KYBER\_N/4;i++) { basemul(&r->coeffs[4\*i], &a->coeffs[4\*i], &b->coeffs[4\*i], zetas[64+i]); basemul(&r->coeffs[4\*i+2], &a->coeffs[4\*i+2], &b->coeffs[4\*i+2], -zetas[64+i]); }}
/\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\* Name: poly\_tomont\*\* Description: Inplace conversion of all coefficients of a polynomial\* from normal domain to Montgomery domain\*\* Arguments: - poly \*r: pointer to input/output polynomial\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*/void poly\_tomont(poly \*r){ unsigned int i; const int16\_t f = (1ULL << 32) % KYBER\_Q; for(i=0;i<KYBER\_N;i++) r->coeffs[i] = montgomery\_reduce((int32\_t)r->coeffs[i]\*f);}
/\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\* Name: poly\_reduce\*\* Description: Applies Barrett reduction to all coefficients of a polynomial\* for details of the Barrett reduction see comments in reduce.c\*\* Arguments: - poly \*r: pointer to input/output polynomial\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*/void poly\_reduce(poly \*r){ unsigned int i; for(i=0;i<KYBER\_N;i++) r->coeffs[i] = barrett\_reduce(r->coeffs[i]);}
/\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\* Name: poly\_add\*\* Description: Add two polynomials; no modular reduction is performed\*\* Arguments: - poly \*r: pointer to output polynomial\* - const poly \*a: pointer to first input polynomial\* - const poly \*b: pointer to second input polynomial\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*/void poly\_add(poly \*r, const poly \*a, const poly \*b){ unsigned int i; for(i=0;i<KYBER\_N;i++) r->coeffs[i] = a->coeffs[i] + b->coeffs[i];}
/\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\* Name: poly\_sub\*\* Description: Subtract two polynomials; no modular reduction is performed\*\* Arguments: - poly \*r: pointer to output polynomial\* - const poly \*a: pointer to first input polynomial\* - const poly \*b: pointer to second input polynomial\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*/void poly\_sub(poly \*r, const poly \*a, const poly \*b){ unsigned int i; for(i=0;i<KYBER\_N;i++) r->coeffs[i] = a->coeffs[i] - b->coeffs[i];}

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.

