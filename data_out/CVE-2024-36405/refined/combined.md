=== Content from github.com_85fde5fe_20250111_181713.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fopen-quantum-safe%2Fliboqs%2Fblob%2F7eecda6095c003ddded7175a1ffdf35a2ce63ed5%2Fsrc%2Fkem%2Fkyber%2Fpqcrystals-kyber_kyber512_ref%2Fpoly.c)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fopen-quantum-safe%2Fliboqs%2Fblob%2F7eecda6095c003ddded7175a1ffdf35a2ce63ed5%2Fsrc%2Fkem%2Fkyber%2Fpqcrystals-kyber_kyber512_ref%2Fpoly.c)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=open-quantum-safe%2Fliboqs)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[open-quantum-safe](/open-quantum-safe)
/
**[liboqs](/open-quantum-safe/liboqs)**
Public

* [Notifications](/login?return_to=%2Fopen-quantum-safe%2Fliboqs) You must be signed in to change notification settings
* [Fork
  484](/login?return_to=%2Fopen-quantum-safe%2Fliboqs)
* [Star
   2k](/login?return_to=%2Fopen-quantum-safe%2Fliboqs)

* [Code](/open-quantum-safe/liboqs)
* [Issues
  82](/open-quantum-safe/liboqs/issues)
* [Pull requests
  9](/open-quantum-safe/liboqs/pulls)
* [Discussions](/open-quantum-safe/liboqs/discussions)
* [Actions](/open-quantum-safe/liboqs/actions)
* [Projects
  0](/open-quantum-safe/liboqs/projects)
* [Wiki](/open-quantum-safe/liboqs/wiki)
* [Security](/open-quantum-safe/liboqs/security)
* [Insights](/open-quantum-safe/liboqs/pulse)

Additional navigation options

* [Code](/open-quantum-safe/liboqs)
* [Issues](/open-quantum-safe/liboqs/issues)
* [Pull requests](/open-quantum-safe/liboqs/pulls)
* [Discussions](/open-quantum-safe/liboqs/discussions)
* [Actions](/open-quantum-safe/liboqs/actions)
* [Projects](/open-quantum-safe/liboqs/projects)
* [Wiki](/open-quantum-safe/liboqs/wiki)
* [Security](/open-quantum-safe/liboqs/security)
* [Insights](/open-quantum-safe/liboqs/pulse)

## Files

 7eecda6
## Breadcrumbs

1. [liboqs](/open-quantum-safe/liboqs/tree/7eecda6095c003ddded7175a1ffdf35a2ce63ed5)
2. /[src](/open-quantum-safe/liboqs/tree/7eecda6095c003ddded7175a1ffdf35a2ce63ed5/src)
3. /[kem](/open-quantum-safe/liboqs/tree/7eecda6095c003ddded7175a1ffdf35a2ce63ed5/src/kem)
4. /[kyber](/open-quantum-safe/liboqs/tree/7eecda6095c003ddded7175a1ffdf35a2ce63ed5/src/kem/kyber)
5. /[pqcrystals-kyber\_kyber512\_ref](/open-quantum-safe/liboqs/tree/7eecda6095c003ddded7175a1ffdf35a2ce63ed5/src/kem/kyber/pqcrystals-kyber_kyber512_ref)
/
# poly.c

Copy path Blame  Blame
## Latest commit

## History

[History](/open-quantum-safe/liboqs/commits/7eecda6095c003ddded7175a1ffdf35a2ce63ed5/src/kem/kyber/pqcrystals-kyber_kyber512_ref/poly.c)359 lines (334 loc) · 10.9 KB 7eecda6
## Breadcrumbs

1. [liboqs](/open-quantum-safe/liboqs/tree/7eecda6095c003ddded7175a1ffdf35a2ce63ed5)
2. /[src](/open-quantum-safe/liboqs/tree/7eecda6095c003ddded7175a1ffdf35a2ce63ed5/src)
3. /[kem](/open-quantum-safe/liboqs/tree/7eecda6095c003ddded7175a1ffdf35a2ce63ed5/src/kem)
4. /[kyber](/open-quantum-safe/liboqs/tree/7eecda6095c003ddded7175a1ffdf35a2ce63ed5/src/kem/kyber)
5. /[pqcrystals-kyber\_kyber512\_ref](/open-quantum-safe/liboqs/tree/7eecda6095c003ddded7175a1ffdf35a2ce63ed5/src/kem/kyber/pqcrystals-kyber_kyber512_ref)
/
# poly.c

Top
## File metadata and controls

* Code
* Blame

359 lines (334 loc) · 10.9 KB[Raw](https://github.com/open-quantum-safe/liboqs/raw/7eecda6095c003ddded7175a1ffdf35a2ce63ed5/src/kem/kyber/pqcrystals-kyber_kyber512_ref/poly.c)123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257258259260261262263264265266267268269270271272273274275276277278279280281282283284285286287288289290291292293294295296297298299300301302303304305306307308309310311312313314315316317318319320321322323324325326327328329330331332333334335336337338339340341342343344345346347348349350351352353354355356357358359#include <stdint.h>#include "params.h"#include "poly.h"#include "ntt.h"#include "reduce.h"#include "cbd.h"#include "symmetric.h"
/\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\* Name: poly\_compress\*\* Description: Compression and subsequent serialization of a polynomial\*\* Arguments: - uint8\_t \*r: pointer to output byte array\* (of length KYBER\_POLYCOMPRESSEDBYTES)\* - const poly \*a: pointer to input polynomial\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*/void poly\_compress(uint8\_t r[KYBER\_POLYCOMPRESSEDBYTES], const poly \*a){ unsigned int i,j; int16\_t u; uint32\_t d0; uint8\_t t[8];
#if (KYBER\_POLYCOMPRESSEDBYTES == 128) for(i=0;i<KYBER\_N/8;i++) { for(j=0;j<8;j++) { // map to positive standard representatives u = a->coeffs[8\*i+j]; u += (u >> 15) & KYBER\_Q;/\* t[j] = ((((uint16\_t)u << 4) + KYBER\_Q/2)/KYBER\_Q) & 15; \*/ d0 = u << 4; d0 += 1665; d0 \*= 80635; d0 >>= 28; t[j] = d0 & 0xf; }
 r[0] = t[0] | (t[1] << 4); r[1] = t[2] | (t[3] << 4); r[2] = t[4] | (t[5] << 4); r[3] = t[6] | (t[7] << 4); r += 4; }#elif (KYBER\_POLYCOMPRESSEDBYTES == 160) for(i=0;i<KYBER\_N/8;i++) { for(j=0;j<8;j++) { // map to positive standard representatives u = a->coeffs[8\*i+j]; u += (u >> 15) & KYBER\_Q;/\* t[j] = ((((uint32\_t)u << 5) + KYBER\_Q/2)/KYBER\_Q) & 31; \*/ d0 = u << 5; d0 += 1664; d0 \*= 40318; d0 >>= 27; t[j] = d0 & 0x1f; }
 r[0] = (t[0] >> 0) | (t[1] << 5); r[1] = (t[1] >> 3) | (t[2] << 2) | (t[3] << 7); r[2] = (t[3] >> 1) | (t[4] << 4); r[3] = (t[4] >> 4) | (t[5] << 1) | (t[6] << 6); r[4] = (t[6] >> 2) | (t[7] << 3); r += 5; }#else#error "KYBER\_POLYCOMPRESSEDBYTES needs to be in {128, 160}"#endif}
/\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\* Name: poly\_decompress\*\* Description: De-serialization and subsequent decompression of a polynomial;\* approximate inverse of poly\_compress\*\* Arguments: - poly \*r: pointer to output polynomial\* - const uint8\_t \*a: pointer to input byte array\* (of length KYBER\_POLYCOMPRESSEDBYTES bytes)\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*/void poly\_decompress(poly \*r, const uint8\_t a[KYBER\_POLYCOMPRESSEDBYTES]){ unsigned int i;
#if (KYBER\_POLYCOMPRESSEDBYTES == 128) for(i=0;i<KYBER\_N/2;i++) { r->coeffs[2\*i+0] = (((uint16\_t)(a[0] & 15)\*KYBER\_Q) + 8) >> 4; r->coeffs[2\*i+1] = (((uint16\_t)(a[0] >> 4)\*KYBER\_Q) + 8) >> 4; a += 1; }#elif (KYBER\_POLYCOMPRESSEDBYTES == 160) unsigned int j; uint8\_t t[8]; for(i=0;i<KYBER\_N/8;i++) { t[0] = (a[0] >> 0); t[1] = (a[0] >> 5) | (a[1] << 3); t[2] = (a[1] >> 2); t[3] = (a[1] >> 7) | (a[2] << 1); t[4] = (a[2] >> 4) | (a[3] << 4); t[5] = (a[3] >> 1); t[6] = (a[3] >> 6) | (a[4] << 2); t[7] = (a[4] >> 3); a += 5;
 for(j=0;j<8;j++) r->coeffs[8\*i+j] = ((uint32\_t)(t[j] & 31)\*KYBER\_Q + 16) >> 5; }#else#error "KYBER\_POLYCOMPRESSEDBYTES needs to be in {128, 160}"#endif}
/\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\* Name: poly\_tobytes\*\* Description: Serialization of a polynomial\*\* Arguments: - uint8\_t \*r: pointer to output byte array\* (needs space for KYBER\_POLYBYTES bytes)\* - const poly \*a: pointer to input polynomial\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*/void poly\_tobytes(uint8\_t r[KYBER\_POLYBYTES], const poly \*a){ unsigned int i; uint16\_t t0, t1;
 for(i=0;i<KYBER\_N/2;i++) { // map to positive standard representatives t0 = a->coeffs[2\*i]; t0 += ((int16\_t)t0 >> 15) & KYBER\_Q; t1 = a->coeffs[2\*i+1]; t1 += ((int16\_t)t1 >> 15) & KYBER\_Q; r[3\*i+0] = (t0 >> 0); r[3\*i+1] = (t0 >> 8) | (t1 << 4); r[3\*i+2] = (t1 >> 4); }}
/\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\* Name: poly\_frombytes\*\* Description: De-serialization of a polynomial;\* inverse of poly\_tobytes\*\* Arguments: - poly \*r: pointer to output polynomial\* - const uint8\_t \*a: pointer to input byte array\* (of KYBER\_POLYBYTES bytes)\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*/void poly\_frombytes(poly \*r, const uint8\_t a[KYBER\_POLYBYTES]){ unsigned int i; for(i=0;i<KYBER\_N/2;i++) { r->coeffs[2\*i] = ((a[3\*i+0] >> 0) | ((uint16\_t)a[3\*i+1] << 8)) & 0xFFF; r->coeffs[2\*i+1] = ((a[3\*i+1] >> 4) | ((uint16\_t)a[3\*i+2] << 4)) & 0xFFF; }}
/\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\* Name: poly\_frommsg\*\* Description: Convert 32-byte message to polynomial\*\* Arguments: - poly \*r: pointer to output polynomial\* - const uint8\_t \*msg: pointer to input message\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*/void poly\_frommsg(poly \*r, const uint8\_t msg[KYBER\_INDCPA\_MSGBYTES]){ unsigned int i,j; int16\_t mask;
#if (KYBER\_INDCPA\_MSGBYTES != KYBER\_N/8)#error "KYBER\_INDCPA\_MSGBYTES must be equal to KYBER\_N/8 bytes!"#endif
 for(i=0;i<KYBER\_N/8;i++) { for(j=0;j<8;j++) { mask = -(int16\_t)((msg[i] >> j)&1); r->coeffs[8\*i+j] = mask & ((KYBER\_Q+1)/2); } }}
/\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\* Name: poly\_tomsg\*\* Description: Convert polynomial to 32-byte message\*\* Arguments: - uint8\_t \*msg: pointer to output message\* - const poly \*a: pointer to input polynomial\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*/void poly\_tomsg(uint8\_t msg[KYBER\_INDCPA\_MSGBYTES], const poly \*a){ unsigned int i,j; uint32\_t t;
 for(i=0;i<KYBER\_N/8;i++) { msg[i] = 0; for(j=0;j<8;j++) { t = a->coeffs[8\*i+j]; // t += ((int16\_t)t >> 15) & KYBER\_Q; // t = (((t << 1) + KYBER\_Q/2)/KYBER\_Q) & 1; t <<= 1; t += 1665; t \*= 80635; t >>= 28; t &= 1; msg[i] |= t << j; } }}
/\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\* Name: poly\_getnoise\_eta1\*\* Description: Sample a polynomial deterministically from a seed and a nonce,\* with output polynomial close to centered binomial distribution\* with parameter KYBER\_ETA1\*\* Arguments: - poly \*r: pointer to output polynomial\* - const uint8\_t \*seed: pointer to input seed\* (of length KYBER\_SYMBYTES bytes)\* - uint8\_t nonce: one-byte input nonce\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*/void poly\_getnoise\_eta1(poly \*r, const uint8\_t seed[KYBER\_SYMBYTES], uint8\_t nonce){ uint8\_t buf[KYBER\_ETA1\*KYBER\_N/4]; prf(buf, sizeof(buf), seed, nonce); poly\_cbd\_eta1(r, buf);}
/\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\* Name: poly\_getnoise\_eta2\*\* Description: Sample a polynomial deterministically from a seed and a nonce,\* with output polynomial close to centered binomial distribution\* with parameter KYBER\_ETA2\*\* Arguments: - poly \*r: pointer to output polynomial\* - const uint8\_t \*seed: pointer to input seed\* (of length KYBER\_SYMBYTES bytes)\* - uint8\_t nonce: one-byte input nonce\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*/void poly\_getnoise\_eta2(poly \*r, const uint8\_t seed[KYBER\_SYMBYTES], uint8\_t nonce){ uint8\_t buf[KYBER\_ETA2\*KYBER\_N/4]; prf(buf, sizeof(buf), seed, nonce); poly\_cbd\_eta2(r, buf);}
/\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\* Name: poly\_ntt\*\* Description: Computes negacyclic number-theoretic transform (NTT) of\* a polynomial in place;\* inputs assumed to be in normal order, output in bitreversed order\*\* Arguments: - uint16\_t \*r: pointer to in/output polynomial\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*/void poly\_ntt(poly \*r){ ntt(r->coeffs); poly\_reduce(r);}
/\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\* Name: poly\_invntt\_tomont\*\* Description: Computes inverse of negacyclic number-theoretic transform (NTT)\* of a polynomial in place;\* inputs assumed to be in bitreversed order, output in normal order\*\* Arguments: - uint16\_t \*a: pointer to in/output polynomial\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*/void poly\_invntt\_tomont(poly \*r){ invntt(r->coeffs);}
/\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\* Name: poly\_basemul\_montgomery\*\* Description: Multiplication of two polynomials in NTT domain\*\* Arguments: - poly \*r: pointer to output polynomial\* - const poly \*a: pointer to first input polynomial\* - const poly \*b: pointer to second input polynomial\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*/void poly\_basemul\_montgomery(poly \*r, const poly \*a, const poly \*b){ unsigned int i; for(i=0;i<KYBER\_N/4;i++) { basemul(&r->coeffs[4\*i], &a->coeffs[4\*i], &b->coeffs[4\*i], zetas[64+i]); basemul(&r->coeffs[4\*i+2], &a->coeffs[4\*i+2], &b->coeffs[4\*i+2], -zetas[64+i]); }}
/\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\* Name: poly\_tomont\*\* Description: Inplace conversion of all coefficients of a polynomial\* from normal domain to Montgomery domain\*\* Arguments: - poly \*r: pointer to input/output polynomial\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*/void poly\_tomont(poly \*r){ unsigned int i; const int16\_t f = (1ULL << 32) % KYBER\_Q; for(i=0;i<KYBER\_N;i++) r->coeffs[i] = montgomery\_reduce((int32\_t)r->coeffs[i]\*f);}
/\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\* Name: poly\_reduce\*\* Description: Applies Barrett reduction to all coefficients of a polynomial\* for details of the Barrett reduction see comments in reduce.c\*\* Arguments: - poly \*r: pointer to input/output polynomial\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*/void poly\_reduce(poly \*r){ unsigned int i; for(i=0;i<KYBER\_N;i++) r->coeffs[i] = barrett\_reduce(r->coeffs[i]);}
/\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\* Name: poly\_add\*\* Description: Add two polynomials; no modular reduction is performed\*\* Arguments: - poly \*r: pointer to output polynomial\* - const poly \*a: pointer to first input polynomial\* - const poly \*b: pointer to second input polynomial\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*/void poly\_add(poly \*r, const poly \*a, const poly \*b){ unsigned int i; for(i=0;i<KYBER\_N;i++) r->coeffs[i] = a->coeffs[i] + b->coeffs[i];}
/\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\* Name: poly\_sub\*\* Description: Subtract two polynomials; no modular reduction is performed\*\* Arguments: - poly \*r: pointer to output polynomial\* - const poly \*a: pointer to first input polynomial\* - const poly \*b: pointer to second input polynomial\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*/void poly\_sub(poly \*r, const poly \*a, const poly \*b){ unsigned int i; for(i=0;i<KYBER\_N;i++) r->coeffs[i] = a->coeffs[i] - b->coeffs[i];}

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_b96b93c6_20250111_181714.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fopen-quantum-safe%2Fliboqs%2Fcommit%2F982c762c242ef549c914891b47bf6e0ed6321f91)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fopen-quantum-safe%2Fliboqs%2Fcommit%2F982c762c242ef549c914891b47bf6e0ed6321f91)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=open-quantum-safe%2Fliboqs)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[open-quantum-safe](/open-quantum-safe)
/
**[liboqs](/open-quantum-safe/liboqs)**
Public

* [Notifications](/login?return_to=%2Fopen-quantum-safe%2Fliboqs) You must be signed in to change notification settings
* [Fork
  484](/login?return_to=%2Fopen-quantum-safe%2Fliboqs)
* [Star
   2k](/login?return_to=%2Fopen-quantum-safe%2Fliboqs)

* [Code](/open-quantum-safe/liboqs)
* [Issues
  82](/open-quantum-safe/liboqs/issues)
* [Pull requests
  9](/open-quantum-safe/liboqs/pulls)
* [Discussions](/open-quantum-safe/liboqs/discussions)
* [Actions](/open-quantum-safe/liboqs/actions)
* [Projects
  0](/open-quantum-safe/liboqs/projects)
* [Wiki](/open-quantum-safe/liboqs/wiki)
* [Security](/open-quantum-safe/liboqs/security)
* [Insights](/open-quantum-safe/liboqs/pulse)

Additional navigation options

* [Code](/open-quantum-safe/liboqs)
* [Issues](/open-quantum-safe/liboqs/issues)
* [Pull requests](/open-quantum-safe/liboqs/pulls)
* [Discussions](/open-quantum-safe/liboqs/discussions)
* [Actions](/open-quantum-safe/liboqs/actions)
* [Projects](/open-quantum-safe/liboqs/projects)
* [Wiki](/open-quantum-safe/liboqs/wiki)
* [Security](/open-quantum-safe/liboqs/security)
* [Insights](/open-quantum-safe/liboqs/pulse)

## Commit

[Permalink](/open-quantum-safe/liboqs/commit/982c762c242ef549c914891b47bf6e0ed6321f91)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Pull Kyber/ML-KEM CT-Fix from upstream

[Browse files](/open-quantum-safe/liboqs/tree/982c762c242ef549c914891b47bf6e0ed6321f91)
Browse the repository at this point in the history

```
Signed-off-by: Basil Hess <bhe@zurich.ibm.com>
```

* Loading branch information

[![@bhess](https://avatars.githubusercontent.com/u/149199?s=40&v=4)](/bhess) [![@dstebila](https://avatars.githubusercontent.com/u/8843219?s=40&v=4)](/dstebila)

[bhess](/open-quantum-safe/liboqs/commits?author=bhess "View all commits by bhess")
authored and
[dstebila](/open-quantum-safe/liboqs/commits?author=dstebila "View all commits by dstebila")
committed
Jun 5, 2024

1 parent
[755c023](/open-quantum-safe/liboqs/commit/755c02310277212c764ab94b6eb9348d500ba07d)

commit 982c762

 Show file tree

 Hide file tree

Showing
**29 changed files**
with
**166 additions**
and
**25 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* docs/algorithms/kem

  + docs/algorithms/kem/kyber.md
    [kyber.md](#diff-b057e4e41a30ed82aa39b40b1b3ef60749a49c0c7b8e8f195ad13faea0b3b21e)
  + docs/algorithms/kem/kyber.yml
    [kyber.yml](#diff-62acaa75033d46002846a422e8f7b75cb554c35903d439f38b44b8bdf524e3ce)
  + docs/algorithms/kem/ml\_kem.md
    [ml\_kem.md](#diff-d2e37ce0981156eef7604ea39b474f64a1fade0ec708d4cf5f8d64a7d2b69933)
  + docs/algorithms/kem/ml\_kem.yml
    [ml\_kem.yml](#diff-00f279c6b7a319e2ea06fe4e8888115897bed2adf9aa7fe6c07d94b29e572bb2)
* scripts/copy\_from\_upstream

  + scripts/copy\_from\_upstream/copy\_from\_upstream.yml
    [copy\_from\_upstream.yml](#diff-47bff58854d31ecb37c570e43c7539b0fa5588896d49a457d355655fa8b96f16)
* src/kem

  + kyber

    - pqcrystals-kyber\_kyber1024\_avx2

      * src/kem/kyber/pqcrystals-kyber\_kyber1024\_avx2/verify.h
        [verify.h](#diff-ddf62b6a86cd9d76c857aad873fc672532ba48b86419b9680db109dde0c5342e)
    - pqcrystals-kyber\_kyber1024\_ref

      * src/kem/kyber/pqcrystals-kyber\_kyber1024\_ref/poly.c
        [poly.c](#diff-b8bbdb7e029d2c677700b2cada6dc94db465b479cf8dac9b43a26fc8df7fd057)
      * src/kem/kyber/pqcrystals-kyber\_kyber1024\_ref/verify.c
        [verify.c](#diff-ea6d126c5e1cd95a8f22ae4e8c7e26574779c33e93f682616c4cc49d315f14dd)
      * src/kem/kyber/pqcrystals-kyber\_kyber1024\_ref/verify.h
        [verify.h](#diff-08ebd7eaf1eb50eb51386e0a5593df4555390cbcbde7e9310960e6436088adc9)
    - pqcrystals-kyber\_kyber512\_avx2

      * src/kem/kyber/pqcrystals-kyber\_kyber512\_avx2/verify.h
        [verify.h](#diff-e60ea7d6c65ad0bb6c0c37b1d1fc439c4b419d0b69e6abcaa98b811eaa8dac74)
    - pqcrystals-kyber\_kyber512\_ref

      * src/kem/kyber/pqcrystals-kyber\_kyber512\_ref/poly.c
        [poly.c](#diff-8543a15d6c7597ff00191fb1c226a7329d406889c1a9551d372682a033766102)
      * src/kem/kyber/pqcrystals-kyber\_kyber512\_ref/verify.c
        [verify.c](#diff-7a9f458c6c3eaa17118bb46a17c4a990370c2690a2da9457f497df8e00184513)
      * src/kem/kyber/pqcrystals-kyber\_kyber512\_ref/verify.h
        [verify.h](#diff-3b2b97a6a5b7555a62bca32cd753cbdd10771b92ce6851b58bb9471087588202)
    - pqcrystals-kyber\_kyber768\_avx2

      * src/kem/kyber/pqcrystals-kyber\_kyber768\_avx2/verify.h
        [verify.h](#diff-c8a45abc372e9e2b11faf2828ce18c44a4b5797882ee94ef484d61a921f274c8)
    - pqcrystals-kyber\_kyber768\_ref

      * src/kem/kyber/pqcrystals-kyber\_kyber768\_ref/poly.c
        [poly.c](#diff-5cea395ce474b81e4336254e635b8b6f82f82222a581e3026390c219f98d1efd)
      * src/kem/kyber/pqcrystals-kyber\_kyber768\_ref/verify.c
        [verify.c](#diff-f061f9cbe6219f5142658cd01576e07bcfa7a3ef35b2adb95f5f62033bac982e)
      * src/kem/kyber/pqcrystals-kyber\_kyber768\_ref/verify.h
        [verify.h](#diff-1c0415340251af88ddf70392dc1f40d2d451aa1bfbc99448309441dee7b2b529)
  + ml\_kem

    - pqcrystals-kyber-standard\_ml-kem-1024-ipd\_avx2

      * src/kem/ml\_kem/pqcrystals-kyber-standard\_ml-kem-1024-ipd\_avx2/verify.h
        [verify.h](#diff-90c27d401c04640da26eb77c45993d5837c555eb253dfc37e84ae3a39ff19a88)
    - pqcrystals-kyber-standard\_ml-kem-1024-ipd\_ref

      * src/kem/ml\_kem/pqcrystals-kyber-standard\_ml-kem-1024-ipd\_ref/poly.c
        [poly.c](#diff-b6d3e7c6bbfbdfadbe2c83ade6dd58b852bc6d5655fc25f31dd951f25077ef92)
      * src/kem/ml\_kem/pqcrystals-kyber-standard\_ml-kem-1024-ipd\_ref/verify.c
        [verify.c](#diff-184d9ca46fbea4c2ed09b651aa6cfb36b979951f4e1c1378dbb272f0f61e5664)
      * src/kem/ml\_kem/pqcrystals-kyber-standard\_ml-kem-1024-ipd\_ref/verify.h
        [verify.h](#diff-1ff0f2e4261f8c225dcfd6c02e840c226645db54ee42e08ffcb1486b219de9f4)
    - pqcrystals-kyber-standard\_ml-kem-512-ipd\_avx2

      * src/kem/ml\_kem/pqcrystals-kyber-standard\_ml-kem-512-ipd\_avx2/verify.h
        [verify.h](#diff-512ff1c4cf868296fadd2dac17bd82aa49d7f056f690644ea2c03e74e0e4544d)
    - pqcrystals-kyber-standard\_ml-kem-512-ipd\_ref

      * src/kem/ml\_kem/pqcrystals-kyber-standard\_ml-kem-512-ipd\_ref/poly.c
        [poly.c](#diff-b43edb61f8926f5c71f11df992f3e703c264b5dbf7825797794eebfef6043f47)
      * src/kem/ml\_kem/pqcrystals-kyber-standard\_ml-kem-512-ipd\_ref/verify.c
        [verify.c](#diff-6aaf22e3e67c57fa06392afc4a8cbf1bab216538e57d8e8429db40cfefe37667)
      * src/kem/ml\_kem/pqcrystals-kyber-standard\_ml-kem-512-ipd\_ref/verify.h
        [verify.h](#diff-fd150a7778ed26e02e2d34d26b86304e7cf496e25ef938be39f64725f74ee7bf)
    - pqcrystals-kyber-standard\_ml-kem-768-ipd\_avx2

      * src/kem/ml\_kem/pqcrystals-kyber-standard\_ml-kem-768-ipd\_avx2/verify.h
        [verify.h](#diff-67c6c24f9ba0a050cb4841d1cb0dac9c360a348a2715674d083ee8ffb9a7d1dd)
    - pqcrystals-kyber-standard\_ml-kem-768-ipd\_ref

      * src/kem/ml\_kem/pqcrystals-kyber-standard\_ml-kem-768-ipd\_ref/poly.c
        [poly.c](#diff-a0512b51fe70d588005f3d9f4eff679fc21ff2ba75d4f3735b37b9f6e6a91bbf)
      * src/kem/ml\_kem/pqcrystals-kyber-standard\_ml-kem-768-ipd\_ref/verify.c
        [verify.c](#diff-20b828bc11a563c44f7a1d5f44fe039c8616ccc84624f109a123d72cdb6c29ee)
      * src/kem/ml\_kem/pqcrystals-kyber-standard\_ml-kem-768-ipd\_ref/verify.h
        [verify.h](#diff-47a59d170c7f1cc65c1bc3ce9c8a7aa4dbf33b3182d99e8fdece801e38a99b4c)

## There are no files selected for viewing

4 changes: 2 additions & 2 deletions

4
[docs/algorithms/kem/kyber.md](#diff-b057e4e41a30ed82aa39b40b1b3ef60749a49c0c7b8e8f195ad13faea0b3b21e "docs/algorithms/kem/kyber.md")

Show comments

[View file](/open-quantum-safe/liboqs/blob/982c762c242ef549c914891b47bf6e0ed6321f91/docs/algorithms/kem/kyber.md)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |

| Expand Up | | @@ -7,9 +7,9 @@ |
|  |  | - \*\*Authors' website\*\*: https://pq-crystals.org/ |
|  |  | - \*\*Specification version\*\*: NIST Round 3 submission. |
|  |  | - \*\*Primary Source\*\*<a name="primary-source"></a>: |
|  |  | - \*\*Source\*\*: https://github.com/pq-crystals/kyber/commit/b628ba78711bc28327dc7d2d5c074a00f061884e with copy\_from\_upstream patches |
|  |  | - \*\*Source\*\*: https://github.com/pq-crystals/kyber/commit/441c0519a07e8b86c8d079954a6b10bd31d29efc with copy\_from\_upstream patches |
|  |  | - \*\*Implementation license (SPDX-Identifier)\*\*: CC0-1.0 or Apache-2.0 |
|  |  | - \*\*Optimized Implementation sources\*\*: https://github.com/pq-crystals/kyber/commit/b628ba78711bc28327dc7d2d5c074a00f061884e with copy\_from\_upstream patches |
|  |  | - \*\*Optimized Implementation sources\*\*: https://github.com/pq-crystals/kyber/commit/441c0519a07e8b86c8d079954a6b10bd31d29efc with copy\_from\_upstream patches |
|  |  | - \*\*oldpqclean-aarch64\*\*:<a name="oldpqclean-aarch64"></a> |
|  |  | - \*\*Source\*\*: https://github.com/PQClean/PQClean/commit/8e220a87308154d48fdfac40abbb191ac7fce06a with copy\_from\_upstream patches |
|  |  | - \*\*Implementation license (SPDX-Identifier)\*\*: CC0-1.0 and (CC0-1.0 or Apache-2.0) and (CC0-1.0 or MIT) and MIT |
| Expand Down | |  |

2 changes: 1 addition & 1 deletion

2
[docs/algorithms/kem/kyber.yml](#diff-62acaa75033d46002846a422e8f7b75cb554c35903d439f38b44b8bdf524e3ce "docs/algorithms/kem/kyber.yml")

Show comments

[View file](/open-quantum-safe/liboqs/blob/982c762c242ef549c914891b47bf6e0ed6321f91/docs/algorithms/kem/kyber.yml)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -17,7 +17,7 @@ website: https://pq-crystals.org/ |
|  |  | nist-round: 3 |
|  |  | spec-version: NIST Round 3 submission |
|  |  | primary-upstream: |
|  |  | source: https://github.com/pq-crystals/kyber/commit/b628ba78711bc28327dc7d2d5c074a00f061884e |
|  |  | source: https://github.com/pq-crystals/kyber/commit/441c0519a07e8b86c8d079954a6b10bd31d29efc |
|  |  | with copy\_from\_upstream patches |
|  |  | spdx-license-identifier: CC0-1.0 or Apache-2.0 |
|  |  | optimized-upstreams: |
| Expand Down | |  |

2 changes: 1 addition & 1 deletion

2
[docs/algorithms/kem/ml\_kem.md](#diff-d2e37ce0981156eef7604ea39b474f64a1fade0ec708d4cf5f8d64a7d2b69933 "docs/algorithms/kem/ml_kem.md")

Show comments

[View file](/open-quantum-safe/liboqs/blob/982c762c242ef549c914891b47bf6e0ed6321f91/docs/algorithms/kem/ml_kem.md)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |

| Expand Up | | @@ -7,7 +7,7 @@ |
|  |  | - \*\*Authors' website\*\*: https://pq-crystals.org/kyber/ and https://csrc.nist.gov/pubs/fips/203/ipd |
|  |  | - \*\*Specification version\*\*: ML-KEM-ipd. |
|  |  | - \*\*Primary Source\*\*<a name="primary-source"></a>: |
|  |  | - \*\*Source\*\*: https://github.com/pq-crystals/kyber/commit/11d00ff1f20cfca1f72d819e5a45165c1e0a2816 with copy\_from\_upstream patches |
|  |  | - \*\*Source\*\*: https://github.com/pq-crystals/kyber/commit/d1321ce5ac0b53f583eb47a040dc3625ee8e7e37 with copy\_from\_upstream patches |
|  |  | - \*\*Implementation license (SPDX-Identifier)\*\*: CC0-1.0 or Apache-2.0 |
|  |  |  |
|  |  |  |
| Expand Down | |  |

2 changes: 1 addition & 1 deletion

2
[docs/algorithms/kem/ml\_kem.yml](#diff-00f279c6b7a319e2ea06fe4e8888115897bed2adf9aa7fe6c07d94b29e572bb2 "docs/algorithms/kem/ml_kem.yml")

Show comments

[View file](/open-quantum-safe/liboqs/blob/982c762c242ef549c914891b47bf6e0ed6321f91/docs/algorithms/kem/ml_kem.yml)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -17,7 +17,7 @@ website: https://pq-crystals.org/kyber/ and https://csrc.nist.gov/pubs/fips/203/ |
|  |  | nist-round: ipd |
|  |  | spec-version: ML-KEM-ipd |
|  |  | primary-upstream: |
|  |  | source: https://github.com/pq-crystals/kyber/commit/11d00ff1f20cfca1f72d819e5a45165c1e0a2816 |
|  |  | source: https://github.com/pq-crystals/kyber/commit/d1321ce5ac0b53f583eb47a040dc3625ee8e7e37 |
|  |  | with copy\_from\_upstream patches |
|  |  | spdx-license-identifier: CC0-1.0 or Apache-2.0 |
|  |  | parameter-sets: |
| Expand Down | |  |

4 changes: 2 additions & 2 deletions

4
[scripts/copy\_from\_upstream/copy\_from\_upstream.yml](#diff-47bff58854d31ecb37c570e43c7539b0fa5588896d49a457d355655fa8b96f16 "scripts/copy_from_upstream/copy_from_upstream.yml")

Show comments

[View file](/open-quantum-safe/liboqs/blob/982c762c242ef549c914891b47bf6e0ed6321f91/scripts/copy_from_upstream/copy_from_upstream.yml)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -25,15 +25,15 @@ upstreams: |
|  |  | name: pqcrystals-kyber |
|  |  | git\_url: https://github.com/pq-crystals/kyber.git |
|  |  | git\_branch: master |
|  |  | git\_commit: b628ba78711bc28327dc7d2d5c074a00f061884e |
|  |  | git\_commit: 441c0519a07e8b86c8d079954a6b10bd31d29efc |
|  |  | kem\_meta\_path: '{pretty\_name\_full}\_META.yml' |
|  |  | kem\_scheme\_path: '.' |
|  |  | patches: [pqcrystals-kyber-yml.patch, pqcrystals-kyber-ref-shake-aes.patch, pqcrystals-kyber-avx2-shake-aes.patch] |
|  |  | - |
|  |  | name: pqcrystals-kyber-standard |
|  |  | git\_url: https://github.com/pq-crystals/kyber.git |
|  |  | git\_branch: standard |
|  |  | git\_commit: 11d00ff1f20cfca1f72d819e5a45165c1e0a2816 |
|  |  | git\_commit: d1321ce5ac0b53f583eb47a040dc3625ee8e7e37 |
|  |  | kem\_meta\_path: '{pretty\_name\_full}\_META.yml' |
|  |  | kem\_scheme\_path: '.' |
|  |  | patches: [pqcrystals-ml\_kem\_ipd.patch] |
| Expand Down | |  |

3 changes: 3 additions & 0 deletions

3
[src/kem/kyber/pqcrystals-kyber\_kyber1024\_avx2/verify.h](#diff-ddf62b6a86cd9d76c857aad873fc672532ba48b86419b9680db109dde0c5342e "src/kem/kyber/pqcrystals-kyber_kyber1024_avx2/verify.h")

Show comments

[View file](/open-quantum-safe/liboqs/blob/982c762c242ef549c914891b47bf6e0ed6321f91/src/kem/kyber/pqcrystals-kyber_kyber1024_avx2/verify.h)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -11,4 +11,7 @@ int verify(const uint8\_t \*a, const uint8\_t \*b, size\_t len); |
|  |  | #define cmov KYBER\_NAMESPACE(cmov) |
|  |  | void cmov(uint8\_t \*r, const uint8\_t \*x, size\_t len, uint8\_t b); |
|  |  |  |
|  |  | #define cmov\_int16 KYBER\_NAMESPACE(cmov\_int16) |
|  |  | void cmov\_int16(int16\_t \*r, int16\_t v, uint16\_t b); |
|  |  |  |
|  |  | #endif |

6 changes: 3 additions & 3 deletions

6
[src/kem/kyber/pqcrystals-kyber\_kyber1024\_ref/poly.c](#diff-b8bbdb7e029d2c677700b2cada6dc94db465b479cf8dac9b43a26fc8df7fd057 "src/kem/kyber/pqcrystals-kyber_kyber1024_ref/poly.c")

Show comments

[View file](/open-quantum-safe/liboqs/blob/982c762c242ef549c914891b47bf6e0ed6321f91/src/kem/kyber/pqcrystals-kyber_kyber1024_ref/poly.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -5,6 +5,7 @@ |
|  |  | #include "reduce.h" |
|  |  | #include "cbd.h" |
|  |  | #include "symmetric.h" |
|  |  | #include "verify.h" |
|  |  |  |
|  |  | /\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\* |
|  |  | \* Name: poly\_compress |
| Expand Down  Expand Up | | @@ -166,16 +167,15 @@ void poly\_frombytes(poly \*r, const uint8\_t a[KYBER\_POLYBYTES]) |
|  |  | void poly\_frommsg(poly \*r, const uint8\_t msg[KYBER\_INDCPA\_MSGBYTES]) |
|  |  | { |
|  |  | unsigned int i,j; |
|  |  | int16\_t mask; |
|  |  |  |
|  |  | #if (KYBER\_INDCPA\_MSGBYTES != KYBER\_N/8) |
|  |  | #error "KYBER\_INDCPA\_MSGBYTES must be equal to KYBER\_N/8 bytes!" |
|  |  | #endif |
|  |  |  |
|  |  | for(i=0;i<KYBER\_N/8;i++) { |
|  |  | for(j=0;j<8;j++) { |
|  |  | mask = -(int16\_t)((msg[i] >> j)&1); |
|  |  | r->coeffs[8\*i+j] = mask & ((KYBER\_Q+1)/2); |
|  |  | r->coeffs[8\*i+j] = 0; |
|  |  | cmov\_int16(r->coeffs+8\*i+j, ((KYBER\_Q+1)/2), (msg[i] >> j)&1); |
|  |  | } |
|  |  | } |
|  |  | } |
| Expand Down | |  |

17 changes: 17 additions & 0 deletions

17
[src/kem/kyber/pqcrystals-kyber\_kyber1024\_ref/verify.c](#diff-ea6d126c5e1cd95a8f22ae4e8c7e26574779c33e93f682616c4cc49d315f14dd "src/kem/kyber/pqcrystals-kyber_kyber1024_ref/verify.c")

Show comments

[View file](/open-quantum-safe/liboqs/blob/982c762c242ef549c914891b47bf6e0ed6321f91/src/kem/kyber/pqcrystals-kyber_kyber1024_ref/verify.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -55,3 +55,20 @@ void cmov(uint8\_t \*r, const uint8\_t \*x, size\_t len, uint8\_t b) |
|  |  | for(i=0;i<len;i++) |
|  |  | r[i] ^= b & (r[i] ^ x[i]); |
|  |  | } |
|  |  |  |
|  |  | /\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\* |
|  |  | \* Name: cmov\_int16 |
|  |  | \* |
|  |  | \* Description: Copy input v to \*r if b is 1, don't modify \*r if b is 0. |
|  |  | \* Requires b to be in {0,1}; |
|  |  | \* Runs in constant time. |
|  |  | \* |
|  |  | \* Arguments: int16\_t \*r: pointer to output int16\_t |
|  |  | \* int16\_t v: input int16\_t |
|  |  | \* uint8\_t b: Condition bit; has to be in {0,1} |
|  |  | \*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*/ |
|  |  | void cmov\_int16(int16\_t \*r, int16\_t v, uint16\_t b) |
|  |  | { |
|  |  | b = -b; |
|  |  | \*r ^= b & ((\*r) ^ v); |
|  |  | } |

3 changes: 3 additions & 0 deletions

3
[src/kem/kyber/pqcrystals-kyber\_kyber1024\_ref/verify.h](#diff-08ebd7eaf1eb50eb51386e0a5593df4555390cbcbde7e9310960e6436088adc9 "src/kem/kyber/pqcrystals-kyber_kyber1024_ref/verify.h")

Show comments

[View file](/open-quantum-safe/liboqs/blob/982c762c242ef549c914891b47bf6e0ed6321f91/src/kem/kyber/pqcrystals-kyber_kyber1024_ref/verify.h)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -11,4 +11,7 @@ int verify(const uint8\_t \*a, const uint8\_t \*b, size\_t len); |
|  |  | #define cmov KYBER\_NAMESPACE(cmov) |
|  |  | void cmov(uint8\_t \*r, const uint8\_t \*x, size\_t len, uint8\_t b); |
|  |  |  |
|  |  | #define cmov\_int16 KYBER\_NAMESPACE(cmov\_int16) |
|  |  | void cmov\_int16(int16\_t \*r, int16\_t v, uint16\_t b); |
|  |  |  |
|  |  | #endif |

3 changes: 3 additions & 0 deletions

3
[src/kem/kyber/pqcrystals-kyber\_kyber512\_avx2/verify.h](#diff-e60ea7d6c65ad0bb6c0c37b1d1fc439c4b419d0b69e6abcaa98b811eaa8dac74 "src/kem/kyber/pqcrystals-kyber_kyber512_avx2/verify.h")

Show comments

[View file](/open-quantum-safe/liboqs/blob/982c762c242ef549c914891b47bf6e0ed6321f91/src/kem/kyber/pqcrystals-kyber_kyber512_avx2/verify.h)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -11,4 +11,7 @@ int verify(const uint8\_t \*a, const uint8\_t \*b, size\_t len); |
|  |  | #define cmov KYBER\_NAMESPACE(cmov) |
|  |  | void cmov(uint8\_t \*r, const uint8\_t \*x, size\_t len, uint8\_t b); |
|  |  |  |
|  |  | #define cmov\_int16 KYBER\_NAMESPACE(cmov\_int16) |
|  |  | void cmov\_int16(int16\_t \*r, int16\_t v, uint16\_t b); |
|  |  |  |
|  |  | #endif |

6 changes: 3 additions & 3 deletions

6
[src/kem/kyber/pqcrystals-kyber\_kyber512\_ref/poly.c](#diff-8543a15d6c7597ff00191fb1c226a7329d406889c1a9551d372682a033766102 "src/kem/kyber/pqcrystals-kyber_kyber512_ref/poly.c")

Show comments

[View file](/open-quantum-safe/liboqs/blob/982c762c242ef549c914891b47bf6e0ed6321f91/src/kem/kyber/pqcrystals-kyber_kyber512_ref/poly.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -5,6 +5,7 @@ |
|  |  | #include "reduce.h" |
|  |  | #include "cbd.h" |
|  |  | #include "symmetric.h" |
|  |  | #include "verify.h" |
|  |  |  |
|  |  | /\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\* |
|  |  | \* Name: poly\_compress |
| Expand Down  Expand Up | | @@ -166,16 +167,15 @@ void poly\_frombytes(poly \*r, const uint8\_t a[KYBER\_POLYBYTES]) |
|  |  | void poly\_frommsg(poly \*r, const uint8\_t msg[KYBER\_INDCPA\_MSGBYTES]) |
|  |  | { |
|  |  | unsigned int i,j; |
|  |  | int16\_t mask; |
|  |  |  |
|  |  | #if (KYBER\_INDCPA\_MSGBYTES != KYBER\_N/8) |
|  |  | #error "KYBER\_INDCPA\_MSGBYTES must be equal to KYBER\_N/8 bytes!" |
|  |  | #endif |
|  |  |  |
|  |  | for(i=0;i<KYBER\_N/8;i++) { |
|  |  | for(j=0;j<8;j++) { |
|  |  | mask = -(int16\_t)((msg[i] >> j)&1); |
|  |  | r->coeffs[8\*i+j] = mask & ((KYBER\_Q+1)/2); |
|  |  | r->coeffs[8\*i+j] = 0; |
|  |  | cmov\_int16(r->coeffs+8\*i+j, ((KYBER\_Q+1)/2), (msg[i] >> j)&1); |
|  |  | } |
|  |  | } |
|  |  | } |
| Expand Down | |  |

17 changes: 17 additions & 0 deletions

17
[src/kem/kyber/pqcrystals-kyber\_kyber512\_ref/verify.c](#diff-7a9f458c6c3eaa17118bb46a17c4a990370c2690a2da9457f497df8e00184513 "src/kem/kyber/pqcrystals-kyber_kyber512_ref/verify.c")

Show comments

[View file](/open-quantum-safe/liboqs/blob/982c762c242ef549c914891b47bf6e0ed6321f91/src/kem/kyber/pqcrystals-kyber_kyber512_ref/verify.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -55,3 +55,20 @@ void cmov(uint8\_t \*r, const uint8\_t \*x, size\_t len, uint8\_t b) |
|  |  | for(i=0;i<len;i++) |
|  |  | r[i] ^= b & (r[i] ^ x[i]); |
|  |  | } |
|  |  |  |
|  |  | /\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\* |
|  |  | \* Name: cmov\_int16 |
|  |  | \* |
|  |  | \* Description: Copy input v to \*r if b is 1, don't modify \*r if b is 0. |
|  |  | \* Requires b to be in {0,1}; |
|  |  | \* Runs in constant time. |
|  |  | \* |
|  |  | \* Arguments: int16\_t \*r: pointer to output int16\_t |
|  |  | \* int16\_t v: input int16\_t |
|  |  | \* uint8\_t b: Condition bit; has to be in {0,1} |
|  |  | \*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*/ |
|  |  | void cmov\_int16(int16\_t \*r, int16\_t v, uint16\_t b) |
|  |  | { |
|  |  | b = -b; |
|  |  | \*r ^= b & ((\*r) ^ v); |
|  |  | } |

3 changes: 3 additions & 0 deletions

3
[src/kem/kyber/pqcrystals-kyber\_kyber512\_ref/verify.h](#diff-3b2b97a6a5b7555a62bca32cd753cbdd10771b92ce6851b58bb9471087588202 "src/kem/kyber/pqcrystals-kyber_kyber512_ref/verify.h")

Show comments

[View file](/open-quantum-safe/liboqs/blob/982c762c242ef549c914891b47bf6e0ed6321f91/src/kem/kyber/pqcrystals-kyber_kyber512_ref/verify.h)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -11,4 +11,7 @@ int verify(const uint8\_t \*a, const uint8\_t \*b, size\_t len); |
|  |  | #define cmov KYBER\_NAMESPACE(cmov) |
|  |  | void cmov(uint8\_t \*r, const uint8\_t \*x, size\_t len, uint8\_t b); |
|  |  |  |
|  |  | #define cmov\_int16 KYBER\_NAMESPACE(cmov\_int16) |
|  |  | void cmov\_int16(int16\_t \*r, int16\_t v, uint16\_t b); |
|  |  |  |
|  |  | #endif |

3 changes: 3 additions & 0 deletions

3
[src/kem/kyber/pqcrystals-kyber\_kyber768\_avx2/verify.h](#diff-c8a45abc372e9e2b11faf2828ce18c44a4b5797882ee94ef484d61a921f274c8 "src/kem/kyber/pqcrystals-kyber_kyber768_avx2/verify.h")

Show comments

[View file](/open-quantum-safe/liboqs/blob/982c762c242ef549c914891b47bf6e0ed6321f91/src/kem/kyber/pqcrystals-kyber_kyber768_avx2/verify.h)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -11,4 +11,7 @@ int verify(const uint8\_t \*a, const uint8\_t \*b, size\_t len); |
|  |  | #define cmov KYBER\_NAMESPACE(cmov) |
|  |  | void cmov(uint8\_t \*r, const uint8\_t \*x, size\_t len, uint8\_t b); |
|  |  |  |
|  |  | #define cmov\_int16 KYBER\_NAMESPACE(cmov\_int16) |
|  |  | void cmov\_int16(int16\_t \*r, int16\_t v, uint16\_t b); |
|  |  |  |
|  |  | #endif |

6 changes: 3 additions & 3 deletions

6
[src/kem/kyber/pqcrystals-kyber\_kyber768\_ref/poly.c](#diff-5cea395ce474b81e4336254e635b8b6f82f82222a581e3026390c219f98d1efd "src/kem/kyber/pqcrystals-kyber_kyber768_ref/poly.c")

Show comments

[View file](/open-quantum-safe/liboqs/blob/982c762c242ef549c914891b47bf6e0ed6321f91/src/kem/kyber/pqcrystals-kyber_kyber768_ref/poly.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -5,6 +5,7 @@ |
|  |  | #include "reduce.h" |
|  |  | #include "cbd.h" |
|  |  | #include "symmetric.h" |
|  |  | #include "verify.h" |
|  |  |  |
|  |  | /\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\* |
|  |  | \* Name: poly\_compress |
| Expand Down  Expand Up | | @@ -166,16 +167,15 @@ void poly\_frombytes(poly \*r, const uint8\_t a[KYBER\_POLYBYTES]) |
|  |  | void poly\_frommsg(poly \*r, const uint8\_t msg[KYBER\_INDCPA\_MSGBYTES]) |
|  |  | { |
|  |  | unsigned int i,j; |
|  |  | int16\_t mask; |
|  |  |  |
|  |  | #if (KYBER\_INDCPA\_MSGBYTES != KYBER\_N/8) |
|  |  | #error "KYBER\_INDCPA\_MSGBYTES must be equal to KYBER\_N/8 bytes!" |
|  |  | #endif |
|  |  |  |
|  |  | for(i=0;i<KYBER\_N/8;i++) { |
|  |  | for(j=0;j<8;j++) { |
|  |  | mask = -(int16\_t)((msg[i] >> j)&1); |
|  |  | r->coeffs[8\*i+j] = mask & ((KYBER\_Q+1)/2); |
|  |  | r->coeffs[8\*i+j] = 0; |
|  |  | cmov\_int16(r->coeffs+8\*i+j, ((KYBER\_Q+1)/2), (msg[i] >> j)&1); |
|  |  | } |
|  |  | } |
|  |  | } |
| Expand Down | |  |

17 changes: 17 additions & 0 deletions

17
[src/kem/kyber/pqcrystals-kyber\_kyber768\_ref/verify.c](#diff-f061f9cbe6219f5142658cd01576e07bcfa7a3ef35b2adb95f5f62033bac982e "src/kem/kyber/pqcrystals-kyber_kyber768_ref/verify.c")

Show comments

[View file](/open-quantum-safe/liboqs/blob/982c762c242ef549c914891b47bf6e0ed6321f91/src/kem/kyber/pqcrystals-kyber_kyber768_ref/verify.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -55,3 +55,20 @@ void cmov(uint8\_t \*r, const uint8\_t \*x, size\_t len, uint8\_t b) |
|  |  | for(i=0;i<len;i++) |
|  |  | r[i] ^= b & (r[i] ^ x[i]); |
|  |  | } |
|  |  |  |
|  |  | /\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\* |
|  |  | \* Name: cmov\_int16 |
|  |  | \* |
|  |  | \* Description: Copy input v to \*r if b is 1, don't modify \*r if b is 0. |
|  |  | \* Requires b to be in {0,1}; |
|  |  | \* Runs in constant time. |
|  |  | \* |
|  |  | \* Arguments: int16\_t \*r: pointer to output int16\_t |
|  |  | \* int16\_t v: input int16\_t |
|  |  | \* uint8\_t b: Condition bit; has to be in {0,1} |
|  |  | \*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*/ |
|  |  | void cmov\_int16(int16\_t \*r, int16\_t v, uint16\_t b) |
|  |  | { |
|  |  | b = -b; |
|  |  | \*r ^= b & ((\*r) ^ v); |
|  |  | } |

3 changes: 3 additions & 0 deletions

3
[src/kem/kyber/pqcrystals-kyber\_kyber768\_ref/verify.h](#diff-1c0415340251af88ddf70392dc1f40d2d451aa1bfbc99448309441dee7b2b529 "src/kem/kyber/pqcrystals-kyber_kyber768_ref/verify.h")

Show comments

[View file](/open-quantum-safe/liboqs/blob/982c762c242ef549c914891b47bf6e0ed6321f91/src/kem/kyber/pqcrystals-kyber_kyber768_ref/verify.h)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -11,4 +11,7 @@ int verify(const uint8\_t \*a, const uint8\_t \*b, size\_t len); |
|  |  | #define cmov KYBER\_NAMESPACE(cmov) |
|  |  | void cmov(uint8\_t \*r, const uint8\_t \*x, size\_t len, uint8\_t b); |
|  |  |  |
|  |  | #define cmov\_int16 KYBER\_NAMESPACE(cmov\_int16) |
|  |  | void cmov\_int16(int16\_t \*r, int16\_t v, uint16\_t b); |
|  |  |  |
|  |  | #endif |

3 changes: 3 additions & 0 deletions

3
[src/kem/ml\_kem/pqcrystals-kyber-standard\_ml-kem-1024-ipd\_avx2/verify.h](#diff-90c27d401c04640da26eb77c45993d5837c555eb253dfc37e84ae3a39ff19a88 "src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-1024-ipd_avx2/verify.h")

Show comments

[View file](/open-quantum-safe/liboqs/blob/982c762c242ef549c914891b47bf6e0ed6321f91/src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-1024-ipd_avx2/verify.h)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -11,4 +11,7 @@ int verify(const uint8\_t \*a, const uint8\_t \*b, size\_t len); |
|  |  | #define cmov KYBER\_NAMESPACE(cmov) |
|  |  | void cmov(uint8\_t \*r, const uint8\_t \*x, size\_t len, uint8\_t b); |
|  |  |  |
|  |  | #define cmov\_int16 KYBER\_NAMESPACE(cmov\_int16) |
|  |  | void cmov\_int16(int16\_t \*r, int16\_t v, uint16\_t b); |
|  |  |  |
|  |  | #endif |

6 changes: 3 additions & 3 deletions

6
[src/kem/ml\_kem/pqcrystals-kyber-standard\_ml-kem-1024-ipd\_ref/poly.c](#diff-b6d3e7c6bbfbdfadbe2c83ade6dd58b852bc6d5655fc25f31dd951f25077ef92 "src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-1024-ipd_ref/poly.c")

Show comments

[View file](/open-quantum-safe/liboqs/blob/982c762c242ef549c914891b47bf6e0ed6321f91/src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-1024-ipd_ref/poly.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -5,6 +5,7 @@ |
|  |  | #include "reduce.h" |
|  |  | #include "cbd.h" |
|  |  | #include "symmetric.h" |
|  |  | #include "verify.h" |
|  |  |  |
|  |  | /\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\* |
|  |  | \* Name: poly\_compress |
| Expand Down  Expand Up | | @@ -167,16 +168,15 @@ void poly\_frombytes(poly \*r, const uint8\_t a[KYBER\_POLYBYTES]) |
|  |  | void poly\_frommsg(poly \*r, const uint8\_t msg[KYBER\_INDCPA\_MSGBYTES]) |
|  |  | { |
|  |  | unsigned int i,j; |
|  |  | int16\_t mask; |
|  |  |  |
|  |  | #if (KYBER\_INDCPA\_MSGBYTES != KYBER\_N/8) |
|  |  | #error "KYBER\_INDCPA\_MSGBYTES must be equal to KYBER\_N/8 bytes!" |
|  |  | #endif |
|  |  |  |
|  |  | for(i=0;i<KYBER\_N/8;i++) { |
|  |  | for(j=0;j<8;j++) { |
|  |  | mask = -(int16\_t)((msg[i] >> j)&1); |
|  |  | r->coeffs[8\*i+j] = mask & ((KYBER\_Q+1)/2); |
|  |  | r->coeffs[8\*i+j] = 0; |
|  |  | cmov\_int16(r->coeffs+8\*i+j, ((KYBER\_Q+1)/2), (msg[i] >> j)&1); |
|  |  | } |
|  |  | } |
|  |  | } |
| Expand Down | |  |

18 changes: 18 additions & 0 deletions

18
[src/kem/ml\_kem/pqcrystals-kyber-standard\_ml-kem-1024-ipd\_ref/verify.c](#diff-184d9ca46fbea4c2ed09b651aa6cfb36b979951f4e1c1378dbb272f0f61e5664 "src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-1024-ipd_ref/verify.c")

Show comments

[View file](/open-quantum-safe/liboqs/blob/982c762c242ef549c914891b47bf6e0ed6321f91/src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-1024-ipd_ref/verify.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -45,3 +45,21 @@ void cmov(uint8\_t \*r, const uint8\_t \*x, size\_t len, uint8\_t b) |
|  |  | for(i=0;i<len;i++) |
|  |  | r[i] ^= b & (r[i] ^ x[i]); |
|  |  | } |
|  |  |  |
|  |  |  |
|  |  | /\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\* |
|  |  | \* Name: cmov\_int16 |
|  |  | \* |
|  |  | \* Description: Copy input v to \*r if b is 1, don't modify \*r if b is 0. |
|  |  | \* Requires b to be in {0,1}; |
|  |  | \* Runs in constant time. |
|  |  | \* |
|  |  | \* Arguments: int16\_t \*r: pointer to output int16\_t |
|  |  | \* int16\_t v: input int16\_t |
|  |  | \* uint8\_t b: Condition bit; has to be in {0,1} |
|  |  | \*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*/ |
|  |  | void cmov\_int16(int16\_t \*r, int16\_t v, uint16\_t b) |
|  |  | { |
|  |  | b = -b; |
|  |  | \*r ^= b & ((\*r) ^ v); |
|  |  | } |

3 changes: 3 additions & 0 deletions

3
[src/kem/ml\_kem/pqcrystals-kyber-standard\_ml-kem-1024-ipd\_ref/verify.h](#diff-1ff0f2e4261f8c225dcfd6c02e840c226645db54ee42e08ffcb1486b219de9f4 "src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-1024-ipd_ref/verify.h")

Show comments

[View file](/open-quantum-safe/liboqs/blob/982c762c242ef549c914891b47bf6e0ed6321f91/src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-1024-ipd_ref/verify.h)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -11,4 +11,7 @@ int verify(const uint8\_t \*a, const uint8\_t \*b, size\_t len); |
|  |  | #define cmov KYBER\_NAMESPACE(cmov) |
|  |  | void cmov(uint8\_t \*r, const uint8\_t \*x, size\_t len, uint8\_t b); |
|  |  |  |
|  |  | #define cmov\_int16 KYBER\_NAMESPACE(cmov\_int16) |
|  |  | void cmov\_int16(int16\_t \*r, int16\_t v, uint16\_t b); |
|  |  |  |
|  |  | #endif |

3 changes: 3 additions & 0 deletions

3
[src/kem/ml\_kem/pqcrystals-kyber-standard\_ml-kem-512-ipd\_avx2/verify.h](#diff-512ff1c4cf868296fadd2dac17bd82aa49d7f056f690644ea2c03e74e0e4544d "src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-512-ipd_avx2/verify.h")

Show comments

[View file](/open-quantum-safe/liboqs/blob/982c762c242ef549c914891b47bf6e0ed6321f91/src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-512-ipd_avx2/verify.h)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -11,4 +11,7 @@ int verify(const uint8\_t \*a, const uint8\_t \*b, size\_t len); |
|  |  | #define cmov KYBER\_NAMESPACE(cmov) |
|  |  | void cmov(uint8\_t \*r, const uint8\_t \*x, size\_t len, uint8\_t b); |
|  |  |  |
|  |  | #define cmov\_int16 KYBER\_NAMESPACE(cmov\_int16) |
|  |  | void cmov\_int16(int16\_t \*r, int16\_t v, uint16\_t b); |
|  |  |  |
|  |  | #endif |

6 changes: 3 additions & 3 deletions

6
[src/kem/ml\_kem/pqcrystals-kyber-standard\_ml-kem-512-ipd\_ref/poly.c](#diff-b43edb61f8926f5c71f11df992f3e703c264b5dbf7825797794eebfef6043f47 "src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-512-ipd_ref/poly.c")

Show comments

[View file](/open-quantum-safe/liboqs/blob/982c762c242ef549c914891b47bf6e0ed6321f91/src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-512-ipd_ref/poly.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -5,6 +5,7 @@ |
|  |  | #include "reduce.h" |
|  |  | #include "cbd.h" |
|  |  | #include "symmetric.h" |
|  |  | #include "verify.h" |
|  |  |  |
|  |  | /\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\* |
|  |  | \* Name: poly\_compress |
| Expand Down  Expand Up | | @@ -167,16 +168,15 @@ void poly\_frombytes(poly \*r, const uint8\_t a[KYBER\_POLYBYTES]) |
|  |  | void poly\_frommsg(poly \*r, const uint8\_t msg[KYBER\_INDCPA\_MSGBYTES]) |
|  |  | { |
|  |  | unsigned int i,j; |
|  |  | int16\_t mask; |
|  |  |  |
|  |  | #if (KYBER\_INDCPA\_MSGBYTES != KYBER\_N/8) |
|  |  | #error "KYBER\_INDCPA\_MSGBYTES must be equal to KYBER\_N/8 bytes!" |
|  |  | #endif |
|  |  |  |
|  |  | for(i=0;i<KYBER\_N/8;i++) { |
|  |  | for(j=0;j<8;j++) { |
|  |  | mask = -(int16\_t)((msg[i] >> j)&1); |
|  |  | r->coeffs[8\*i+j] = mask & ((KYBER\_Q+1)/2); |
|  |  | r->coeffs[8\*i+j] = 0; |
|  |  | cmov\_int16(r->coeffs+8\*i+j, ((KYBER\_Q+1)/2), (msg[i] >> j)&1); |
|  |  | } |
|  |  | } |
|  |  | } |
| Expand Down | |  |

18 changes: 18 additions & 0 deletions

18
[src/kem/ml\_kem/pqcrystals-kyber-standard\_ml-kem-512-ipd\_ref/verify.c](#diff-6aaf22e3e67c57fa06392afc4a8cbf1bab216538e57d8e8429db40cfefe37667 "src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-512-ipd_ref/verify.c")

Show comments

[View file](/open-quantum-safe/liboqs/blob/982c762c242ef549c914891b47bf6e0ed6321f91/src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-512-ipd_ref/verify.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -45,3 +45,21 @@ void cmov(uint8\_t \*r, const uint8\_t \*x, size\_t len, uint8\_t b) |
|  |  | for(i=0;i<len;i++) |
|  |  | r[i] ^= b & (r[i] ^ x[i]); |
|  |  | } |
|  |  |  |
|  |  |  |
|  |  | /\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\* |
|  |  | \* Name: cmov\_int16 |
|  |  | \* |
|  |  | \* Description: Copy input v to \*r if b is 1, don't modify \*r if b is 0. |
|  |  | \* Requires b to be in {0,1}; |
|  |  | \* Runs in constant time. |
|  |  | \* |
|  |  | \* Arguments: int16\_t \*r: pointer to output int16\_t |
|  |  | \* int16\_t v: input int16\_t |
|  |  | \* uint8\_t b: Condition bit; has to be in {0,1} |
|  |  | \*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*/ |
|  |  | void cmov\_int16(int16\_t \*r, int16\_t v, uint16\_t b) |
|  |  | { |
|  |  | b = -b; |
|  |  | \*r ^= b & ((\*r) ^ v); |
|  |  | } |

3 changes: 3 additions & 0 deletions

3
[src/kem/ml\_kem/pqcrystals-kyber-standard\_ml-kem-512-ipd\_ref/verify.h](#diff-fd150a7778ed26e02e2d34d26b86304e7cf496e25ef938be39f64725f74ee7bf "src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-512-ipd_ref/verify.h")

Show comments

[View file](/open-quantum-safe/liboqs/blob/982c762c242ef549c914891b47bf6e0ed6321f91/src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-512-ipd_ref/verify.h)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -11,4 +11,7 @@ int verify(const uint8\_t \*a, const uint8\_t \*b, size\_t len); |
|  |  | #define cmov KYBER\_NAMESPACE(cmov) |
|  |  | void cmov(uint8\_t \*r, const uint8\_t \*x, size\_t len, uint8\_t b); |
|  |  |  |
|  |  | #define cmov\_int16 KYBER\_NAMESPACE(cmov\_int16) |
|  |  | void cmov\_int16(int16\_t \*r, int16\_t v, uint16\_t b); |
|  |  |  |
|  |  | #endif |

3 changes: 3 additions & 0 deletions

3
[src/kem/ml\_kem/pqcrystals-kyber-standard\_ml-kem-768-ipd\_avx2/verify.h](#diff-67c6c24f9ba0a050cb4841d1cb0dac9c360a348a2715674d083ee8ffb9a7d1dd "src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-768-ipd_avx2/verify.h")

Show comments

[View file](/open-quantum-safe/liboqs/blob/982c762c242ef549c914891b47bf6e0ed6321f91/src/kem/ml_kem/pqcrystals-kyber-standard_ml-kem-768-ipd_avx2/verify.h)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -11,4 +11,7 @@ int verify(const uint8\_t \*a, const uint8\_t \*b, size\_t len); |
|  |  | #define cmov KYBER\_NAMESPACE(cmov) |
|  |  | void cmov(uint8\_t \*r, const uint8\_t \*x, size\_t len, uint8\_t b); |
|  |  |  |
|  |  | #define cmov\_int16 KYBER\_NAMESPACE(cmov\_int16) |
|  |  | void cmov\_int16(int16\_t \*r, int16\_t v, uint16\_t b); |
|  |  |  |
|  |  | #endif |

 Loading

Oops, something went wrong.
 Retry

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `982c762`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fopen-quantum-safe%2Fliboqs%2Fcommit%2F982c762c242ef549c914891b47bf6e0ed6321f91) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_d8ef0063_20250111_181716.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fpq-crystals%2Fkyber%2Fcommit%2F9b8d30698a3e7449aeb34e62339d4176f11e3c6c)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fpq-crystals%2Fkyber%2Fcommit%2F9b8d30698a3e7449aeb34e62339d4176f11e3c6c)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=pq-crystals%2Fkyber)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[pq-crystals](/pq-crystals)
/
**[kyber](/pq-crystals/kyber)**
Public

* [Notifications](/login?return_to=%2Fpq-crystals%2Fkyber) You must be signed in to change notification settings
* [Fork
  207](/login?return_to=%2Fpq-crystals%2Fkyber)
* [Star
   868](/login?return_to=%2Fpq-crystals%2Fkyber)

* [Code](/pq-crystals/kyber)
* [Issues
  17](/pq-crystals/kyber/issues)
* [Pull requests
  7](/pq-crystals/kyber/pulls)
* [Actions](/pq-crystals/kyber/actions)
* [Projects
  0](/pq-crystals/kyber/projects)
* [Security](/pq-crystals/kyber/security)
* [Insights](/pq-crystals/kyber/pulse)

Additional navigation options

* [Code](/pq-crystals/kyber)
* [Issues](/pq-crystals/kyber/issues)
* [Pull requests](/pq-crystals/kyber/pulls)
* [Actions](/pq-crystals/kyber/actions)
* [Projects](/pq-crystals/kyber/projects)
* [Security](/pq-crystals/kyber/security)
* [Insights](/pq-crystals/kyber/pulse)

## Commit

[Permalink](/pq-crystals/kyber/commit/9b8d30698a3e7449aeb34e62339d4176f11e3c6c)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Fixed secret-dependent branch in poly\_frommsg introduced by recent ve…

[Browse files](/pq-crystals/kyber/tree/9b8d30698a3e7449aeb34e62339d4176f11e3c6c)
Browse the repository at this point in the history

```
…rsions of clang with some flags (Thanks to Antoon Purnal for pointing this out!)
```

* Loading branch information

[![@cryptojedi](https://avatars.githubusercontent.com/u/3762820?s=40&v=4)](/cryptojedi)

[cryptojedi](/pq-crystals/kyber/commits?author=cryptojedi "View all commits by cryptojedi")
committed
Jun 3, 2024

1 parent
[b628ba7](/pq-crystals/kyber/commit/b628ba78711bc28327dc7d2d5c074a00f061884e)

commit 9b8d306

 Show file tree

 Hide file tree

Showing
**3 changed files**
with
**13 additions**
and
**3 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* ref

  + ref/poly.c
    [poly.c](#diff-7980ab4906160ca7543d48513c4c5a4512471b3aa97cf4b7badefa2d8cc1e102)
  + ref/verify.c
    [verify.c](#diff-b7c51795a476c98e151b0c58da7e0692ed078a44f13b245cf09c82eac70e4302)
  + ref/verify.h
    [verify.h](#diff-0834e94c8bbb0c7c27fe80d288e5053b689b13b15a83438f2b24f777fba23290)

## There are no files selected for viewing

6 changes: 3 additions & 3 deletions

6
[ref/poly.c](#diff-7980ab4906160ca7543d48513c4c5a4512471b3aa97cf4b7badefa2d8cc1e102 "ref/poly.c")

Show comments

[View file](/pq-crystals/kyber/blob/9b8d30698a3e7449aeb34e62339d4176f11e3c6c/ref/poly.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -5,6 +5,7 @@ |
|  |  | #include "reduce.h" |
|  |  | #include "cbd.h" |
|  |  | #include "symmetric.h" |
|  |  | #include "verify.h" |
|  |  |  |
|  |  | /\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\* |
|  |  | \* Name: poly\_compress |
| Expand Down  Expand Up | | @@ -166,16 +167,15 @@ void poly\_frombytes(poly \*r, const uint8\_t a[KYBER\_POLYBYTES]) |
|  |  | void poly\_frommsg(poly \*r, const uint8\_t msg[KYBER\_INDCPA\_MSGBYTES]) |
|  |  | { |
|  |  | unsigned int i,j; |
|  |  | int16\_t mask; |
|  |  |  |
|  |  | #if (KYBER\_INDCPA\_MSGBYTES != KYBER\_N/8) |
|  |  | #error "KYBER\_INDCPA\_MSGBYTES must be equal to KYBER\_N/8 bytes!" |
|  |  | #endif |
|  |  |  |
|  |  | for(i=0;i<KYBER\_N/8;i++) { |
|  |  | for(j=0;j<8;j++) { |
|  |  | mask = -(int16\_t)((msg[i] >> j)&1); |
|  |  | r->coeffs[8\*i+j] = mask & ((KYBER\_Q+1)/2); |
|  |  | r->coeffs[8\*i+j] = 0; |
|  |  | cmov\_int16(r->coeffs+8\*i+j, ((KYBER\_Q+1)/2), (msg[i] >> j)&1); |
|  |  | } |
|  |  | } |
|  |  | } |
| Expand Down | |  |

7 changes: 7 additions & 0 deletions

7
[ref/verify.c](#diff-b7c51795a476c98e151b0c58da7e0692ed078a44f13b245cf09c82eac70e4302 "ref/verify.c")

Show comments

[View file](/pq-crystals/kyber/blob/9b8d30698a3e7449aeb34e62339d4176f11e3c6c/ref/verify.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -55,3 +55,10 @@ void cmov(uint8\_t \*r, const uint8\_t \*x, size\_t len, uint8\_t b) |
|  |  | for(i=0;i<len;i++) |
|  |  | r[i] ^= b & (r[i] ^ x[i]); |
|  |  | } |
|  |  |  |
|  |  |  |
|  |  | void cmov\_int16(int16\_t \*r, int16\_t v, uint16\_t b) |
|  |  | { |
|  |  | b = -b; |
|  |  | \*r ^= b & ((\*r) ^ v); |
|  |  | } |

3 changes: 3 additions & 0 deletions

3
[ref/verify.h](#diff-0834e94c8bbb0c7c27fe80d288e5053b689b13b15a83438f2b24f777fba23290 "ref/verify.h")

Show comments

[View file](/pq-crystals/kyber/blob/9b8d30698a3e7449aeb34e62339d4176f11e3c6c/ref/verify.h)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -11,4 +11,7 @@ int verify(const uint8\_t \*a, const uint8\_t \*b, size\_t len); |
|  |  | #define cmov KYBER\_NAMESPACE(cmov) |
|  |  | void cmov(uint8\_t \*r, const uint8\_t \*x, size\_t len, uint8\_t b); |
|  |  |  |
|  |  | #define cmov\_int16 KYBER\_NAMESPACE(cmov\_int16) |
|  |  | void cmov\_int16(int16\_t \*r, int16\_t v, uint16\_t b); |
|  |  |  |
|  |  | #endif |

Toggle all file notes
Toggle all file annotations

### 2 comments on commit `9b8d306`

[![@Masken3](https://avatars.githubusercontent.com/u/566921?s=80&v=4)](/Masken3)

Copy link

### @Masken3 **[Masken3](/Masken3)** commented on `[9b8d306](/pq-crystals/kyber/commit/9b8d30698a3e7449aeb34e62339d4176f11e3c6c)` [Jun 10, 2024](#commitcomment-142953352)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Could this be vulnerable to link-time optimizations with `-flto`?

Sorry, something went wrong.

All reactions

[![@cryptojedi](https://avatars.githubusercontent.com/u/3762820?s=80&v=4)](/cryptojedi)

Copy link

Contributor

Author

### @cryptojedi **[cryptojedi](/cryptojedi)** commented on `[9b8d306](/pq-crystals/kyber/commit/9b8d30698a3e7449aeb34e62339d4176f11e3c6c)` [Jun 13, 2024](#commitcomment-143084350) via email

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Masken3 \*\*\*@\*\*\*.\*\*\*> wrote:
 Could this be vulnerable to link-time optimizations with `-flto`?
Yes. In fact, what I wrote as a reply to Antoon Purnal when he pointed
out the issue was
"I guess an obvious fix is to implement a cmov in a separate file and
call it from poly\_frommsg. Then the compiler cannot apply the
optimization, because it doesn't know that the last argument is always
either zero or one (well, at least if you don't compile with -lto)."
Some other fixes have now been suggested that will also work with -flto
(see, e.g., PR 78 and pqc-forum posts by DJB and Falko Strenzke
suggesting to use an additional volatile mask).
I will probably integrate one of those, although all "solutions"
(including my own of splitting across files) are very hacky workarounds
owed to the fact that compilers like clang and gcc are not security
aware.

Sorry, something went wrong.

All reactions

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fpq-crystals%2Fkyber%2Fcommit%2F9b8d30698a3e7449aeb34e62339d4176f11e3c6c) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_2ae6daaf_20250111_181715.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fopen-quantum-safe%2Fliboqs%2Fsecurity%2Fadvisories%2FGHSA-f2v9-5498-2vpp)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fopen-quantum-safe%2Fliboqs%2Fsecurity%2Fadvisories%2FGHSA-f2v9-5498-2vpp)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=open-quantum-safe%2Fliboqs)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[open-quantum-safe](/open-quantum-safe)
/
**[liboqs](/open-quantum-safe/liboqs)**
Public

* [Notifications](/login?return_to=%2Fopen-quantum-safe%2Fliboqs) You must be signed in to change notification settings
* [Fork
  484](/login?return_to=%2Fopen-quantum-safe%2Fliboqs)
* [Star
   2k](/login?return_to=%2Fopen-quantum-safe%2Fliboqs)

* [Code](/open-quantum-safe/liboqs)
* [Issues
  82](/open-quantum-safe/liboqs/issues)
* [Pull requests
  9](/open-quantum-safe/liboqs/pulls)
* [Discussions](/open-quantum-safe/liboqs/discussions)
* [Actions](/open-quantum-safe/liboqs/actions)
* [Projects
  0](/open-quantum-safe/liboqs/projects)
* [Wiki](/open-quantum-safe/liboqs/wiki)
* [Security](/open-quantum-safe/liboqs/security)
* [Insights](/open-quantum-safe/liboqs/pulse)

Additional navigation options

* [Code](/open-quantum-safe/liboqs)
* [Issues](/open-quantum-safe/liboqs/issues)
* [Pull requests](/open-quantum-safe/liboqs/pulls)
* [Discussions](/open-quantum-safe/liboqs/discussions)
* [Actions](/open-quantum-safe/liboqs/actions)
* [Projects](/open-quantum-safe/liboqs/projects)
* [Wiki](/open-quantum-safe/liboqs/wiki)
* [Security](/open-quantum-safe/liboqs/security)
* [Insights](/open-quantum-safe/liboqs/pulse)

# Control-flow timing leak in Kyber reference implementation when compiled with Clang 15-18 for -Os, -O1 and other options

Moderate

[dstebila](/dstebila)
published
GHSA-f2v9-5498-2vpp
Jun 7, 2024

## Package

liboqs

## Affected versions

<=0.10.0

## Patched versions

0.10.1 and higher

## Description

liboqs is a C-language cryptographic library that provides implementations of post-quantum cryptography algorithms.

## Impact

A control-flow timing leak has been identified in the reference implementation of the Kyber key encapsulation mechanism when it is compiled with Clang 15-18 for `-Os`, `-O1`, and other compilation options.

A proof-of-concept local attack on the reference implementation leaks the entire ML-KEM 512 secret key in ~10 minutes using end-to-end decapsulation timing measurements.

## Patches

Fixed in version 0.10.1 and main branch of liboqs on GitHub.

* [982c762](https://github.com/open-quantum-safe/liboqs/commit/982c762c242ef549c914891b47bf6e0ed6321f91)

## Workarounds

Some compiler options may produce vectorized code that does not leak secret information, however relying on these compiler options as a workaround may not be reliable.

## References

* [pq-crystals/kyber@9b8d306](https://github.com/pq-crystals/kyber/commit/9b8d30698a3e7449aeb34e62339d4176f11e3c6c)

## Further details

The function [`poly_frommsg`](https://github.com/open-quantum-safe/liboqs/blob/7eecda6095c003ddded7175a1ffdf35a2ce63ed5/src/kem/kyber/pqcrystals-kyber_kyber512_ref/poly.c#L166) produces a polynomial based on the bits of the message m. Given that m is sensitive in both the encapsulation and decapsulation procedure, it is crucial that the implementation does not leak the bits of m through timing. Despite the source-level mitigations in poly\_frommsg, the latest generations of Clang recognize that the code essentially performs a bit test and produces a secret-dependent branch for several compiler options.

The following compiler options when used with Clang 15, 16, 17, and 18 on x86 produce a branch:

* `-Os`
* `-O1`
* `-O2 -fno-vectorize`
* `-O3 -fno-vectorize`

## Credits

The vulnerability was identified by Antoon Purnal (PQShield). A patch was developed by Peter Schwabe (MPI-SP).

### Severity

Moderate

5.9

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Network

Attack complexity
High

Privileges required
None

User interaction
None

Scope
Unchanged

Confidentiality
High

Integrity
None

Availability
None

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:N/A:N

### CVE ID

CVE-2024-36405

### Weaknesses

[CWE-208](/advisories?query=cwe%3A208) [CWE-385](/advisories?query=cwe%3A385)

### Credits

* [![@antoonpurnal](https://avatars.githubusercontent.com/u/49988288?s=40&v=4)](/antoonpurnal)
  [antoonpurnal](/antoonpurnal)
  Reporter

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


