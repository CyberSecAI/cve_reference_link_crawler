```
{
  "vulnerability": {
    "root_cause": "The `poly_frommsg` function in the Kyber reference implementation, despite source-level mitigations, produces a secret-dependent branch due to compiler optimizations by Clang (versions 15-18) when compiled with certain flags.",
    "weaknesses": [
      "CWE-208: Observable Timing Discrepancy",
      "CWE-385: Insufficiently Protected Credentials"
    ],
    "impact": "A control-flow timing leak allows an attacker to extract the ML-KEM 512 secret key through timing measurements of the decapsulation process. A proof-of-concept local attack can leak the entire key in approximately 10 minutes.",
    "attack_vectors": "The vulnerability can be exploited through timing analysis of the Kyber decapsulation process. The attack is network based since an attacker can send carefully crafted ciphertexts to trigger decapsulation.",
    "required_attacker_capabilities": "The attacker needs to be able to perform timing measurements of the decapsulation process. The attacker does not need any specific privileges."
  },
  "affected_software": {
    "name": "liboqs",
    "versions": "<=0.10.0",
     "patched_versions": "0.10.1 and higher"
  },
  "additional_details": "The vulnerability stems from how Clang optimizes the `poly_frommsg` function when specific compiler flags are used (e.g., `-Os`, `-O1`, `-O2 -fno-vectorize`, `-O3 -fno-vectorize`). This optimization results in a conditional branch based on the message input, which introduces a timing difference exploitable by an attacker."
}
```