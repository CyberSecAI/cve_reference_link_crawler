

[Shule's Blog](https://f0rget.me)

* [安全](https://f0rget.me/category/%E5%AE%89%E5%85%A8/)
  [内网渗透](https://f0rget.me/category/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F/)
* [Writeup](https://f0rget.me/category/writeup/)
* [留言板](https://f0rget.me/message/)
* [About me](https://f0rget.me/about-me/)
* [RSS](https://f0rget.me/feed/)
* [文章归档](https://f0rget.me/archive/)
* [说说](https://f0rget.me/shuoshuo/)

##### 搜索

×

搜索

夜间模式暗黑模式

字体
Sans SerifSerif

阴影
浅阴影深阴影

滤镜
关闭
日落
暗化
灰度

圆角

主题色

0%

Shule's Blog

 搜索

* [站点概览](#leftbar_tab_overview)

###### Shule

###### 日月按时升起，化作尘土和笑声，山风带走一切

57
文章

6
分类

48
标签

##### 分类

×

[Java 13](https://f0rget.me/category/java/)[Writeup 20](https://f0rget.me/category/writeup/)[内网渗透 11](https://f0rget.me/category/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F/)[安全 12](https://f0rget.me/category/%E5%AE%89%E5%85%A8/)[未分类 1](https://f0rget.me/category/uncategorized/)[杂 12](https://f0rget.me/category/%E6%9D%82/)

##### 标签

×

[2024 1](https://f0rget.me/tag/2024/)[Apache Santuario 1](https://f0rget.me/tag/apache-santuario/)[common-collections 1](https://f0rget.me/tag/common-collections/)[ctf 3](https://f0rget.me/tag/ctf/)[ctfd 1](https://f0rget.me/tag/ctfd/)[CVE 1](https://f0rget.me/tag/cve/)[debug 1](https://f0rget.me/tag/debug/)[Easy 2](https://f0rget.me/tag/easy/)[esay 1](https://f0rget.me/tag/esay/)[eval 1](https://f0rget.me/tag/eval/)[fastjson 1](https://f0rget.me/tag/fastjson/)[fuzz 1](https://f0rget.me/tag/fuzz/)[hard 1](https://f0rget.me/tag/hard/)[jar 1](https://f0rget.me/tag/jar/)[java 2](https://f0rget.me/tag/java/)[JavaAgent 1](https://f0rget.me/tag/javaagent/)[Jetty 2](https://f0rget.me/tag/jetty/)[JNDI 1](https://f0rget.me/tag/jndi/)[Linux 16](https://f0rget.me/tag/linux/)[log4j2 1](https://f0rget.me/tag/log4j2/)[Medium 1](https://f0rget.me/tag/medium/)[Middle 1](https://f0rget.me/tag/middle/)[Msf 1](https://f0rget.me/tag/msf/)[php 2](https://f0rget.me/tag/php/)[script 1](https://f0rget.me/tag/script/)[Shiro 1](https://f0rget.me/tag/shiro/)[Spring 1](https://f0rget.me/tag/spring/)[SpringBoot 1](https://f0rget.me/tag/springboot/)[sqli 1](https://f0rget.me/tag/sqli/)[Tomcat 1](https://f0rget.me/tag/tomcat/)[waf 1](https://f0rget.me/tag/waf/)[Windows 3](https://f0rget.me/tag/windows/)[wsl 1](https://f0rget.me/tag/wsl/)[XEE 1](https://f0rget.me/tag/xee/)[ysoserial 1](https://f0rget.me/tag/ysoserial/)[代理 3](https://f0rget.me/tag/%E4%BB%A3%E7%90%86/)[信息收集 2](https://f0rget.me/tag/%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/)[内存马 5](https://f0rget.me/tag/%E5%86%85%E5%AD%98%E9%A9%AC/)[反序列化 1](https://f0rget.me/tag/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/)[命令执行 1](https://f0rget.me/tag/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/)[文件上传 1](https://f0rget.me/tag/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/)[木马 1](https://f0rget.me/tag/%E6%9C%A8%E9%A9%AC/)[权限提升 1](https://f0rget.me/tag/%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/)[权限维持 1](https://f0rget.me/tag/%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/)[横向移动 2](https://f0rget.me/tag/%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/)[渗透 0](https://f0rget.me/tag/%E6%B8%97%E9%80%8F/)[漏洞复现 1](https://f0rget.me/tag/%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/)[盲注 1](https://f0rget.me/tag/%E7%9B%B2%E6%B3%A8/)

[DICOM® Connectivity Framework (DCF) Operations Window Remote Command Execute](https://f0rget.me/2024/02/02/dcf-operations-window-remote-command-execute/)

2024-2-02 16:42

 |
 3,546 |
 [未分类](https://f0rget.me/category/uncategorized/) |
 0 |

2024-2-29 20:46

 92 字

|

1 分钟内

PoC：

The default configuration after DCF installation is to access it without authorization，similar to the figure below.

![mstsc_m4vJSavcxo](data:image/png;base64...)

Allowing a user to have full control over the filename at the point of viewing the log file can cause arbitrary file reads and directory traversal vulnerabilities.

![image-20240202143339996](data:image/png;base64...)

![BurpSuiteCommunity_ITLEBTfzsT](data:image/png;base64...)

The following picture shows the effect of reading from any file. payload: `/cgi-bin/format_logfile.pl?/etc/passwd`

![mstsc_lwJUEgsy2A](data:image/png;base64...)

Directory traversal. payload: `?/` . All files in the root directory will be displayed.

![image-20240202144733619](data:image/png;base64...)

And when we splice the pipe character `|` after the filename, then the file will be executed, giving the effect of remote command execution.

![image-20240202153731407](data:image/png;base64...)

版权声明：除特殊说明，博客文章均为 Shule 原创，依据 CC BY-SA 4.0 许可证进行授权，转载请附上出处链接及本声明。

豆

暂无评论

## 发送评论 编辑评论

正在回复  的评论 :

取消回复

Markdown

悄悄话

邮件提醒

发送
编辑

取消

|´・ω・)ノヾ(≧∇≦\*)ゝ(☆ω☆)（╯‵□′）╯︵┴─┴￣﹃￣(/ω＼)∠( ᐛ 」∠)＿(๑•̀ㅁ•́ฅ)→\_→୧(๑•̀⌄•́๑)૭٩(ˊᗜˋ\*)و(ノ°ο°)ノ(´இ皿இ｀)⌇●﹏●⌇(ฅ´ω`ฅ)(╯°A°)╯︵○○○φ(￣∇￣o)ヾ(´･ ･｀｡)ノ"( ง ᵒ̌皿ᵒ̌)ง⁼³₌₃(ó﹏ò｡)Σ(っ °Д °;)っ( ,,´･ω･)ﾉ"(´っω･｀｡)╮(╯▽╰)╭o(\*////▽////\*)q＞﹏＜( ๑´•ω•) "(ㆆᴗㆆ)😂😀😅😊🙂🙃😌😍😘😜😝😏😒🙄😳😡😔😫😱😭💩👻🙌🖕👍👫👬👭🌚🌝🙈💊😶🙏🍦🍉😣![](data:image/svg+xml;base64...)![](data:image/svg+xml;base64...)![](data:image/svg+xml;base64...)![](data:image/svg+xml;base64...)![](data:image/svg+xml;base64...)![](data:image/svg+xml;base64...)![](data:image/svg+xml;base64...)![](data:image/svg+xml;base64...)![](data:image/svg+xml;base64...)![](data:image/svg+xml;base64...)![](data:image/svg+xml;base64...)![](data:image/svg+xml;base64...)![](data:image/svg+xml;base64...)![](data:image/svg+xml;base64...)![](data:image/svg+xml;base64...)![](data:image/svg+xml;base64...)![](data:image/svg+xml;base64...)![](data:image/svg+xml;base64...)![](data:image/svg+xml;base64...)![](data:image/svg+xml;base64...)![](data:image/svg+xml;base64...)![](data:image/svg+xml;base64...)![](data:image/svg+xml;base64...)![](data:image/svg+xml;base64...)![](data:image/svg+xml;base64...)![](data:image/svg+xml;base64...)![](data:image/svg+xml;base64...)![](data:image/svg+xml;base64...)![](data:image/svg+xml;base64...)![](data:image/svg+xml;base64...)Source: github.com/k4yt3x/flowerhd
颜文字Emoji小恐龙花!

####

×

####

×

上一篇[Older versions of Apache Santuario dependencies lead to RCE](https://f0rget.me/2024/01/28/older-versions-of-apache-santuario-dependencies-lead-to-rce/)
Theme [**Argon**](https://github.com/solstice23/argon-theme)

| 耗时 0.550 秒 | 查询 32 次 | 内存 10.82 MB |

Copyright © 2022 - 2024 Shule

