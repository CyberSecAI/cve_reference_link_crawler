=== Content from git.kernel.org_14e604c8_20250111_033726.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=5e2c24f7b0911b15c29aefce760bcf770542fb61)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=5e2c24f7b0911b15c29aefce760bcf770542fb61)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=5e2c24f7b0911b15c29aefce760bcf770542fb61)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=5e2c24f7b0911b15c29aefce760bcf770542fb61)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Pablo Neira Ayuso <pablo@netfilter.org> | 2024-07-13 16:47:38 +0200 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-08-19 05:45:07 +0200 |
| commit | [5e2c24f7b0911b15c29aefce760bcf770542fb61](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=5e2c24f7b0911b15c29aefce760bcf770542fb61) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=5e2c24f7b0911b15c29aefce760bcf770542fb61)) | |
| tree | [909551f9ab758b5ccdc333b0890e3d89745ff4b6](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=5e2c24f7b0911b15c29aefce760bcf770542fb61) | |
| parent | [913173f420579ec59bed06967f8e27e1f451bf74](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=913173f420579ec59bed06967f8e27e1f451bf74) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=5e2c24f7b0911b15c29aefce760bcf770542fb61&id2=913173f420579ec59bed06967f8e27e1f451bf74)) | |
| download | [linux-5e2c24f7b0911b15c29aefce760bcf770542fb61.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-5e2c24f7b0911b15c29aefce760bcf770542fb61.tar.gz) | |

netfilter: ctnetlink: use helper function to calculate expect ID[ Upstream commit 782161895eb4ac45cf7cfa8db375bd4766cb8299 ]
Delete expectation path is missing a call to the nf\_expect\_get\_id()
helper function to calculate the expectation ID, otherwise LSB of the
expectation object address is leaked to userspace.
Fixes: 3c79107631db ("netfilter: ctnetlink: don't use conntrack/expect object addresses as id")
Reported-by: zdi-disclosures@trendmicro.com
Signed-off-by: Pablo Neira Ayuso <pablo@netfilter.org>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=5e2c24f7b0911b15c29aefce760bcf770542fb61)

| -rw-r--r-- | [net/netfilter/nf\_conntrack\_netlink.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/net/netfilter/nf_conntrack_netlink.c?id=5e2c24f7b0911b15c29aefce760bcf770542fb61) | 3 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 2 insertions, 1 deletions

| diff --git a/net/netfilter/nf\_conntrack\_netlink.c b/net/netfilter/nf\_conntrack\_netlink.cindex 1466015bc56dc7..b429ffde25b1ae 100644--- a/[net/netfilter/nf\_conntrack\_netlink.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/netfilter/nf_conntrack_netlink.c?id=913173f420579ec59bed06967f8e27e1f451bf74)+++ b/[net/netfilter/nf\_conntrack\_netlink.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/netfilter/nf_conntrack_netlink.c?id=5e2c24f7b0911b15c29aefce760bcf770542fb61)@@ -3426,7 +3426,8 @@ static int ctnetlink\_del\_expect(struct sk\_buff \*skb,  if (cda[CTA\_EXPECT\_ID]) { \_\_be32 id = nla\_get\_be32(cda[CTA\_EXPECT\_ID]);- if (ntohl(id) != (u32)(unsigned long)exp) {++ if (id != nf\_expect\_get\_id(exp)) { nf\_ct\_expect\_put(exp); return -ENOENT; } |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 03:36:03 +0000



=== Content from git.kernel.org_438cd3de_20250111_033728.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=74de442b8e12a207c07953ee068009a7701aff8f)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=74de442b8e12a207c07953ee068009a7701aff8f)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=74de442b8e12a207c07953ee068009a7701aff8f)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=74de442b8e12a207c07953ee068009a7701aff8f)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Pablo Neira Ayuso <pablo@netfilter.org> | 2024-07-13 16:47:38 +0200 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-08-03 09:00:19 +0200 |
| commit | [74de442b8e12a207c07953ee068009a7701aff8f](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=74de442b8e12a207c07953ee068009a7701aff8f) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=74de442b8e12a207c07953ee068009a7701aff8f)) | |
| tree | [9c935c534be08121125f96d2f0526f9f030dacb4](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=74de442b8e12a207c07953ee068009a7701aff8f) | |
| parent | [487ded1dbb0c4b371596a70937a32e4c64a1fb54](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=487ded1dbb0c4b371596a70937a32e4c64a1fb54) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=74de442b8e12a207c07953ee068009a7701aff8f&id2=487ded1dbb0c4b371596a70937a32e4c64a1fb54)) | |
| download | [linux-74de442b8e12a207c07953ee068009a7701aff8f.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-74de442b8e12a207c07953ee068009a7701aff8f.tar.gz) | |

netfilter: ctnetlink: use helper function to calculate expect ID[ Upstream commit 782161895eb4ac45cf7cfa8db375bd4766cb8299 ]
Delete expectation path is missing a call to the nf\_expect\_get\_id()
helper function to calculate the expectation ID, otherwise LSB of the
expectation object address is leaked to userspace.
Fixes: 3c79107631db ("netfilter: ctnetlink: don't use conntrack/expect object addresses as id")
Reported-by: zdi-disclosures@trendmicro.com
Signed-off-by: Pablo Neira Ayuso <pablo@netfilter.org>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=74de442b8e12a207c07953ee068009a7701aff8f)

| -rw-r--r-- | [net/netfilter/nf\_conntrack\_netlink.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/net/netfilter/nf_conntrack_netlink.c?id=74de442b8e12a207c07953ee068009a7701aff8f) | 3 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 2 insertions, 1 deletions

| diff --git a/net/netfilter/nf\_conntrack\_netlink.c b/net/netfilter/nf\_conntrack\_netlink.cindex 3b846cbdc050d3..4cbf71d0786b0d 100644--- a/[net/netfilter/nf\_conntrack\_netlink.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/netfilter/nf_conntrack_netlink.c?id=487ded1dbb0c4b371596a70937a32e4c64a1fb54)+++ b/[net/netfilter/nf\_conntrack\_netlink.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/netfilter/nf_conntrack_netlink.c?id=74de442b8e12a207c07953ee068009a7701aff8f)@@ -3420,7 +3420,8 @@ static int ctnetlink\_del\_expect(struct sk\_buff \*skb,  if (cda[CTA\_EXPECT\_ID]) { \_\_be32 id = nla\_get\_be32(cda[CTA\_EXPECT\_ID]);- if (ntohl(id) != (u32)(unsigned long)exp) {++ if (id != nf\_expect\_get\_id(exp)) { nf\_ct\_expect\_put(exp); return -ENOENT; } |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 03:36:05 +0000



=== Content from git.kernel.org_98f38df4_20250111_033728.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=782161895eb4ac45cf7cfa8db375bd4766cb8299)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=782161895eb4ac45cf7cfa8db375bd4766cb8299)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=782161895eb4ac45cf7cfa8db375bd4766cb8299)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=782161895eb4ac45cf7cfa8db375bd4766cb8299)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Pablo Neira Ayuso <pablo@netfilter.org> | 2024-07-13 16:47:38 +0200 |
| --- | --- | --- |
| committer | Pablo Neira Ayuso <pablo@netfilter.org> | 2024-07-17 19:00:47 +0200 |
| commit | [782161895eb4ac45cf7cfa8db375bd4766cb8299](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=782161895eb4ac45cf7cfa8db375bd4766cb8299) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=782161895eb4ac45cf7cfa8db375bd4766cb8299)) | |
| tree | [2cc7ca097db4f6b0a5e9e8502d6d5ed5e81f2814](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=782161895eb4ac45cf7cfa8db375bd4766cb8299) | |
| parent | [0e03c643dc9389e61fa484562dae58c8d6e96d63](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=0e03c643dc9389e61fa484562dae58c8d6e96d63) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=782161895eb4ac45cf7cfa8db375bd4766cb8299&id2=0e03c643dc9389e61fa484562dae58c8d6e96d63)) | |
| download | [linux-782161895eb4ac45cf7cfa8db375bd4766cb8299.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-782161895eb4ac45cf7cfa8db375bd4766cb8299.tar.gz) | |

netfilter: ctnetlink: use helper function to calculate expect IDDelete expectation path is missing a call to the nf\_expect\_get\_id()
helper function to calculate the expectation ID, otherwise LSB of the
expectation object address is leaked to userspace.
Fixes: 3c79107631db ("netfilter: ctnetlink: don't use conntrack/expect object addresses as id")
Reported-by: zdi-disclosures@trendmicro.com
Signed-off-by: Pablo Neira Ayuso <pablo@netfilter.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=782161895eb4ac45cf7cfa8db375bd4766cb8299)

| -rw-r--r-- | [net/netfilter/nf\_conntrack\_netlink.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/net/netfilter/nf_conntrack_netlink.c?id=782161895eb4ac45cf7cfa8db375bd4766cb8299) | 3 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 2 insertions, 1 deletions

| diff --git a/net/netfilter/nf\_conntrack\_netlink.c b/net/netfilter/nf\_conntrack\_netlink.cindex 3b846cbdc050d3..4cbf71d0786b0d 100644--- a/[net/netfilter/nf\_conntrack\_netlink.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/netfilter/nf_conntrack_netlink.c?id=0e03c643dc9389e61fa484562dae58c8d6e96d63)+++ b/[net/netfilter/nf\_conntrack\_netlink.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/netfilter/nf_conntrack_netlink.c?id=782161895eb4ac45cf7cfa8db375bd4766cb8299)@@ -3420,7 +3420,8 @@ static int ctnetlink\_del\_expect(struct sk\_buff \*skb,  if (cda[CTA\_EXPECT\_ID]) { \_\_be32 id = nla\_get\_be32(cda[CTA\_EXPECT\_ID]);- if (ntohl(id) != (u32)(unsigned long)exp) {++ if (id != nf\_expect\_get\_id(exp)) { nf\_ct\_expect\_put(exp); return -ENOENT; } |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 03:36:06 +0000



=== Content from git.kernel.org_8a769289_20250111_033729.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=eb4ca1a97e08ff5b920664ba292e576257e2d184)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=eb4ca1a97e08ff5b920664ba292e576257e2d184)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=eb4ca1a97e08ff5b920664ba292e576257e2d184)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=eb4ca1a97e08ff5b920664ba292e576257e2d184)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Pablo Neira Ayuso <pablo@netfilter.org> | 2024-07-13 16:47:38 +0200 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-08-19 05:40:53 +0200 |
| commit | [eb4ca1a97e08ff5b920664ba292e576257e2d184](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=eb4ca1a97e08ff5b920664ba292e576257e2d184) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=eb4ca1a97e08ff5b920664ba292e576257e2d184)) | |
| tree | [e72ee0b07b80d219b9505d97d8613939391f5fd1](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=eb4ca1a97e08ff5b920664ba292e576257e2d184) | |
| parent | [9118c408ee0956b996cd48a44c586d2b50e17990](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=9118c408ee0956b996cd48a44c586d2b50e17990) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=eb4ca1a97e08ff5b920664ba292e576257e2d184&id2=9118c408ee0956b996cd48a44c586d2b50e17990)) | |
| download | [linux-eb4ca1a97e08ff5b920664ba292e576257e2d184.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-eb4ca1a97e08ff5b920664ba292e576257e2d184.tar.gz) | |

netfilter: ctnetlink: use helper function to calculate expect ID[ Upstream commit 782161895eb4ac45cf7cfa8db375bd4766cb8299 ]
Delete expectation path is missing a call to the nf\_expect\_get\_id()
helper function to calculate the expectation ID, otherwise LSB of the
expectation object address is leaked to userspace.
Fixes: 3c79107631db ("netfilter: ctnetlink: don't use conntrack/expect object addresses as id")
Reported-by: zdi-disclosures@trendmicro.com
Signed-off-by: Pablo Neira Ayuso <pablo@netfilter.org>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=eb4ca1a97e08ff5b920664ba292e576257e2d184)

| -rw-r--r-- | [net/netfilter/nf\_conntrack\_netlink.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/net/netfilter/nf_conntrack_netlink.c?id=eb4ca1a97e08ff5b920664ba292e576257e2d184) | 3 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 2 insertions, 1 deletions

| diff --git a/net/netfilter/nf\_conntrack\_netlink.c b/net/netfilter/nf\_conntrack\_netlink.cindex ceb7c988edefa0..b55e87143c2cef 100644--- a/[net/netfilter/nf\_conntrack\_netlink.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/netfilter/nf_conntrack_netlink.c?id=9118c408ee0956b996cd48a44c586d2b50e17990)+++ b/[net/netfilter/nf\_conntrack\_netlink.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/netfilter/nf_conntrack_netlink.c?id=eb4ca1a97e08ff5b920664ba292e576257e2d184)@@ -3413,7 +3413,8 @@ static int ctnetlink\_del\_expect(struct net \*net, struct sock \*ctnl,  if (cda[CTA\_EXPECT\_ID]) { \_\_be32 id = nla\_get\_be32(cda[CTA\_EXPECT\_ID]);- if (ntohl(id) != (u32)(unsigned long)exp) {++ if (id != nf\_expect\_get\_id(exp)) { nf\_ct\_expect\_put(exp); return -ENOENT; } |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 03:36:06 +0000



=== Content from www.zerodayinitiative.com_65d5feb5_20250111_033731.html ===

[![thezdi](/images/logo.svg)](/)

Menu

* [PRIVACY](https://www.trendmicro.com/privacy)
* [WHO WE ARE](/about/)
* [HOW IT WORKS](/about/benefits/)
* [BLOG](/blog/)
* [ADVISORIES](/advisories/)
* [LOG IN](/portal/)
  [SIGN UP](/portal/register/)

Menu

* [PRIVACY](https://www.trendmicro.com/privacy/)
* [WHO WE ARE](/about/)
* [HOW IT WORKS](/about/benefits/)
* [BLOG](/blog/)
* [ADVISORIES](/advisories/)
* [LOG IN](/portal/)
* [SIGN UP](/portal/register/)

* [![thezdi](/images/logo.svg)](/)
* [Trend Micro](https://www.trendmicro.com/)

# Advisory Details

August 27th, 2024
## Linux Kernel Netfilter Conntrack Type Confusion Information Disclosure Vulnerability

### ZDI-24-1182ZDI-CAN-24591

| CVE ID |  |
| --- | --- |
| CVSS SCORE | 6.5, [AV:L/AC:L/PR:L/UI:N/S:C/C:H/I:N/A:N](http://nvd.nist.gov/cvss.cfm?calculator&version=3.0&vector=AV:L/AC:L/PR:L/UI:N/S:C/C:H/I:N/A:N) |
| AFFECTED VENDORS | [Linux](https://www.linux.org/) |
| AFFECTED PRODUCTS | Kernel |
| VULNERABILITY DETAILS | This vulnerability allows local attackers to disclose sensitive information on affected installations of Linux Kernel. An attacker must first obtain the ability to execute low-privileged code on the target system in order to exploit this vulnerability.  The specific flaw exists within the implementation of connection tracking. The issue results from the lack of proper validation of user-supplied data, which can result in a type confusion condition. An attacker can leverage this in conjunction with other vulnerabilities to execute arbitrary code in the context of the kernel. |
| ADDITIONAL DETAILS | Linux has issued an update to correct this vulnerability. More details can be found at: |
| DISCLOSURE TIMELINE | * 2024-07-12 - Vulnerability reported to vendor * 2024-08-27 - Coordinated public release of advisory * 2024-08-27 - Advisory Updated |
| CREDIT | HexRabbit (@h3xr4bb1t) from DEVCORE Research Team |

[BACK TO ADVISORIES](/advisories/)

### General Inquiries

zdi@trendmicro.com

### Find us on X

[@thezdi](https://twitter.com/thezdi)

### Find us on Mastodon

[Mastodon](https://infosec.exchange/%40thezdi)

### Media Inquiries

media\_relations@trendmicro.com

### Sensitive Email Communications

[PGP Key](https://www.zerodayinitiative.com/documents/zdi-pgp-key.asc)

[WHO WE ARE](/about/)

* [Our Mission](/about/)
* [Trend Micro](https://www.trendmicro.com)
* [TippingPoint IPS](https://www.trendmicro.com/en_us/business/products/network/integrated-atp/next-gen-intrusion-prevention-system.html)

[HOW IT WORKS](/about/benefits/)

* [Process](/about/benefits/#process)
* [Researcher Rewards](/about/benefits/#researcher-rewards)
* [FAQS](/about/faq/)
* [Privacy](https://www.trendmicro.com/privacy/)

[ADVISORIES](/advisories)

* [Published Advisories](/advisories/published)
* [Upcoming Advisories](/advisories/upcoming)
* [RSS Feeds](/rss)

[BLOG](/blog)

[![thezdi](/images/logo-footer.svg)](/)



=== Content from git.kernel.org_f4f7e0f1_20250111_033725.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=24f407042cf90b0872de667460230d8d50c06c39)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=24f407042cf90b0872de667460230d8d50c06c39)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=24f407042cf90b0872de667460230d8d50c06c39)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=24f407042cf90b0872de667460230d8d50c06c39)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Pablo Neira Ayuso <pablo@netfilter.org> | 2024-07-13 16:47:38 +0200 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-08-03 08:49:24 +0200 |
| commit | [24f407042cf90b0872de667460230d8d50c06c39](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=24f407042cf90b0872de667460230d8d50c06c39) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=24f407042cf90b0872de667460230d8d50c06c39)) | |
| tree | [b70245dc359f96bba7fe1f76402d0b577e9784e5](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=24f407042cf90b0872de667460230d8d50c06c39) | |
| parent | [e6b8caf06b9db851ef79ce0db01baa369f36ee55](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=e6b8caf06b9db851ef79ce0db01baa369f36ee55) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=24f407042cf90b0872de667460230d8d50c06c39&id2=e6b8caf06b9db851ef79ce0db01baa369f36ee55)) | |
| download | [linux-24f407042cf90b0872de667460230d8d50c06c39.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-24f407042cf90b0872de667460230d8d50c06c39.tar.gz) | |

netfilter: ctnetlink: use helper function to calculate expect ID[ Upstream commit 782161895eb4ac45cf7cfa8db375bd4766cb8299 ]
Delete expectation path is missing a call to the nf\_expect\_get\_id()
helper function to calculate the expectation ID, otherwise LSB of the
expectation object address is leaked to userspace.
Fixes: 3c79107631db ("netfilter: ctnetlink: don't use conntrack/expect object addresses as id")
Reported-by: zdi-disclosures@trendmicro.com
Signed-off-by: Pablo Neira Ayuso <pablo@netfilter.org>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=24f407042cf90b0872de667460230d8d50c06c39)

| -rw-r--r-- | [net/netfilter/nf\_conntrack\_netlink.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/net/netfilter/nf_conntrack_netlink.c?id=24f407042cf90b0872de667460230d8d50c06c39) | 3 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 2 insertions, 1 deletions

| diff --git a/net/netfilter/nf\_conntrack\_netlink.c b/net/netfilter/nf\_conntrack\_netlink.cindex 9ee8abd3e4b108..9672b0e00d6bfe 100644--- a/[net/netfilter/nf\_conntrack\_netlink.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/netfilter/nf_conntrack_netlink.c?id=e6b8caf06b9db851ef79ce0db01baa369f36ee55)+++ b/[net/netfilter/nf\_conntrack\_netlink.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/netfilter/nf_conntrack_netlink.c?id=24f407042cf90b0872de667460230d8d50c06c39)@@ -3415,7 +3415,8 @@ static int ctnetlink\_del\_expect(struct sk\_buff \*skb,  if (cda[CTA\_EXPECT\_ID]) { \_\_be32 id = nla\_get\_be32(cda[CTA\_EXPECT\_ID]);- if (ntohl(id) != (u32)(unsigned long)exp) {++ if (id != nf\_expect\_get\_id(exp)) { nf\_ct\_expect\_put(exp); return -ENOENT; } |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 03:36:02 +0000



=== Content from git.kernel.org_eba8d7c5_20250111_033727.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=66e7650dbbb8e236e781c670b167edc81e771450)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=66e7650dbbb8e236e781c670b167edc81e771450)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=66e7650dbbb8e236e781c670b167edc81e771450)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=66e7650dbbb8e236e781c670b167edc81e771450)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Pablo Neira Ayuso <pablo@netfilter.org> | 2024-07-13 16:47:38 +0200 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-08-19 05:32:01 +0200 |
| commit | [66e7650dbbb8e236e781c670b167edc81e771450](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=66e7650dbbb8e236e781c670b167edc81e771450) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=66e7650dbbb8e236e781c670b167edc81e771450)) | |
| tree | [55dce7b50c834a92a711378bdf24dc6626b58a9c](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=66e7650dbbb8e236e781c670b167edc81e771450) | |
| parent | [576862647ae00d67b09961f84629aea09736c047](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=576862647ae00d67b09961f84629aea09736c047) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=66e7650dbbb8e236e781c670b167edc81e771450&id2=576862647ae00d67b09961f84629aea09736c047)) | |
| download | [linux-66e7650dbbb8e236e781c670b167edc81e771450.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-66e7650dbbb8e236e781c670b167edc81e771450.tar.gz) | |

netfilter: ctnetlink: use helper function to calculate expect ID[ Upstream commit 782161895eb4ac45cf7cfa8db375bd4766cb8299 ]
Delete expectation path is missing a call to the nf\_expect\_get\_id()
helper function to calculate the expectation ID, otherwise LSB of the
expectation object address is leaked to userspace.
Fixes: 3c79107631db ("netfilter: ctnetlink: don't use conntrack/expect object addresses as id")
Reported-by: zdi-disclosures@trendmicro.com
Signed-off-by: Pablo Neira Ayuso <pablo@netfilter.org>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=66e7650dbbb8e236e781c670b167edc81e771450)

| -rw-r--r-- | [net/netfilter/nf\_conntrack\_netlink.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/net/netfilter/nf_conntrack_netlink.c?id=66e7650dbbb8e236e781c670b167edc81e771450) | 3 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 2 insertions, 1 deletions

| diff --git a/net/netfilter/nf\_conntrack\_netlink.c b/net/netfilter/nf\_conntrack\_netlink.cindex 83e8566ec3f056..bcb72ad2c17868 100644--- a/[net/netfilter/nf\_conntrack\_netlink.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/netfilter/nf_conntrack_netlink.c?id=576862647ae00d67b09961f84629aea09736c047)+++ b/[net/netfilter/nf\_conntrack\_netlink.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/netfilter/nf_conntrack_netlink.c?id=66e7650dbbb8e236e781c670b167edc81e771450)@@ -3106,7 +3106,8 @@ static int ctnetlink\_del\_expect(struct net \*net, struct sock \*ctnl,  if (cda[CTA\_EXPECT\_ID]) { \_\_be32 id = nla\_get\_be32(cda[CTA\_EXPECT\_ID]);- if (ntohl(id) != (u32)(unsigned long)exp) {++ if (id != nf\_expect\_get\_id(exp)) { nf\_ct\_expect\_put(exp); return -ENOENT; } |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 03:36:04 +0000



=== Content from git.kernel.org_584f245f_20250111_033725.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=27662b46f2adaa52c1665a82af4b21c42c4337fd)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=27662b46f2adaa52c1665a82af4b21c42c4337fd)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=27662b46f2adaa52c1665a82af4b21c42c4337fd)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=27662b46f2adaa52c1665a82af4b21c42c4337fd)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Pablo Neira Ayuso <pablo@netfilter.org> | 2024-07-13 16:47:38 +0200 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-08-03 08:54:04 +0200 |
| commit | [27662b46f2adaa52c1665a82af4b21c42c4337fd](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=27662b46f2adaa52c1665a82af4b21c42c4337fd) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=27662b46f2adaa52c1665a82af4b21c42c4337fd)) | |
| tree | [2556930daf63b69bea0b64a2da92c6bf65de873e](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=27662b46f2adaa52c1665a82af4b21c42c4337fd) | |
| parent | [08e4d9209a033fce220c23b0316249400b3e15c7](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=08e4d9209a033fce220c23b0316249400b3e15c7) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=27662b46f2adaa52c1665a82af4b21c42c4337fd&id2=08e4d9209a033fce220c23b0316249400b3e15c7)) | |
| download | [linux-27662b46f2adaa52c1665a82af4b21c42c4337fd.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-27662b46f2adaa52c1665a82af4b21c42c4337fd.tar.gz) | |

netfilter: ctnetlink: use helper function to calculate expect ID[ Upstream commit 782161895eb4ac45cf7cfa8db375bd4766cb8299 ]
Delete expectation path is missing a call to the nf\_expect\_get\_id()
helper function to calculate the expectation ID, otherwise LSB of the
expectation object address is leaked to userspace.
Fixes: 3c79107631db ("netfilter: ctnetlink: don't use conntrack/expect object addresses as id")
Reported-by: zdi-disclosures@trendmicro.com
Signed-off-by: Pablo Neira Ayuso <pablo@netfilter.org>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=27662b46f2adaa52c1665a82af4b21c42c4337fd)

| -rw-r--r-- | [net/netfilter/nf\_conntrack\_netlink.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/net/netfilter/nf_conntrack_netlink.c?id=27662b46f2adaa52c1665a82af4b21c42c4337fd) | 3 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 2 insertions, 1 deletions

| diff --git a/net/netfilter/nf\_conntrack\_netlink.c b/net/netfilter/nf\_conntrack\_netlink.cindex 334db22199c1d6..4dab45039f3497 100644--- a/[net/netfilter/nf\_conntrack\_netlink.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/netfilter/nf_conntrack_netlink.c?id=08e4d9209a033fce220c23b0316249400b3e15c7)+++ b/[net/netfilter/nf\_conntrack\_netlink.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/netfilter/nf_conntrack_netlink.c?id=27662b46f2adaa52c1665a82af4b21c42c4337fd)@@ -3411,7 +3411,8 @@ static int ctnetlink\_del\_expect(struct sk\_buff \*skb,  if (cda[CTA\_EXPECT\_ID]) { \_\_be32 id = nla\_get\_be32(cda[CTA\_EXPECT\_ID]);- if (ntohl(id) != (u32)(unsigned long)exp) {++ if (id != nf\_expect\_get\_id(exp)) { nf\_ct\_expect\_put(exp); return -ENOENT; } |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 03:36:02 +0000



=== Content from git.kernel.org_5413673f_20250111_033726.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=64c0b8e64be8368617ef08dfc59a3160563a1435)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=64c0b8e64be8368617ef08dfc59a3160563a1435)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=64c0b8e64be8368617ef08dfc59a3160563a1435)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=64c0b8e64be8368617ef08dfc59a3160563a1435)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Pablo Neira Ayuso <pablo@netfilter.org> | 2024-07-13 16:47:38 +0200 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-08-19 05:33:34 +0200 |
| commit | [64c0b8e64be8368617ef08dfc59a3160563a1435](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=64c0b8e64be8368617ef08dfc59a3160563a1435) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=64c0b8e64be8368617ef08dfc59a3160563a1435)) | |
| tree | [7664669d234696eae14fc16e79e543a9e088c337](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=64c0b8e64be8368617ef08dfc59a3160563a1435) | |
| parent | [55fa4883aa378031471dffea7ad5e9a0b5db81a8](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=55fa4883aa378031471dffea7ad5e9a0b5db81a8) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=64c0b8e64be8368617ef08dfc59a3160563a1435&id2=55fa4883aa378031471dffea7ad5e9a0b5db81a8)) | |
| download | [linux-64c0b8e64be8368617ef08dfc59a3160563a1435.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-64c0b8e64be8368617ef08dfc59a3160563a1435.tar.gz) | |

netfilter: ctnetlink: use helper function to calculate expect ID[ Upstream commit 782161895eb4ac45cf7cfa8db375bd4766cb8299 ]
Delete expectation path is missing a call to the nf\_expect\_get\_id()
helper function to calculate the expectation ID, otherwise LSB of the
expectation object address is leaked to userspace.
Fixes: 3c79107631db ("netfilter: ctnetlink: don't use conntrack/expect object addresses as id")
Reported-by: zdi-disclosures@trendmicro.com
Signed-off-by: Pablo Neira Ayuso <pablo@netfilter.org>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=64c0b8e64be8368617ef08dfc59a3160563a1435)

| -rw-r--r-- | [net/netfilter/nf\_conntrack\_netlink.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/net/netfilter/nf_conntrack_netlink.c?id=64c0b8e64be8368617ef08dfc59a3160563a1435) | 3 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 2 insertions, 1 deletions

| diff --git a/net/netfilter/nf\_conntrack\_netlink.c b/net/netfilter/nf\_conntrack\_netlink.cindex 45d02185f4b92a..c1401193a971bf 100644--- a/[net/netfilter/nf\_conntrack\_netlink.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/netfilter/nf_conntrack_netlink.c?id=55fa4883aa378031471dffea7ad5e9a0b5db81a8)+++ b/[net/netfilter/nf\_conntrack\_netlink.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/netfilter/nf_conntrack_netlink.c?id=64c0b8e64be8368617ef08dfc59a3160563a1435)@@ -3129,7 +3129,8 @@ static int ctnetlink\_del\_expect(struct net \*net, struct sock \*ctnl,  if (cda[CTA\_EXPECT\_ID]) { \_\_be32 id = nla\_get\_be32(cda[CTA\_EXPECT\_ID]);- if (ntohl(id) != (u32)(unsigned long)exp) {++ if (id != nf\_expect\_get\_id(exp)) { nf\_ct\_expect\_put(exp); return -ENOENT; } |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 03:36:04 +0000


