Based on the provided information, here's an analysis of the vulnerability:

**Root Cause:**

The vulnerability lies in the `io_uring` polling mechanism within the Linux kernel. Specifically, when a poll request is ready, but cannot be completed inline (due to certain conditions related to `EPOLLET` and `EPOLLONESHOT` flags), the request was not being added to the hash table. This resulted in a loss of access to the poll request, leading to a request leak.

**Weaknesses/Vulnerabilities:**

-   **Request Leak:**  The primary vulnerability is a request leak. When a poll request could not be completed inline, the code would not properly add it to the hash table for later handling. This meant the kernel could lose track of the request.
-   **Stalling:** The request leak eventually stalls the ring exit process, hindering the proper shutdown of `io_uring` resources.

**Impact of Exploitation:**

-   **Resource Exhaustion:** Repeated triggering of the vulnerability would lead to a buildup of leaked poll requests.
-   **Denial of Service (DoS):** The stall in the ring exit process could render the `io_uring` subsystem unusable, effectively causing a denial of service.

**Attack Vectors:**

-   The vulnerability can be triggered by initiating `io_uring` poll requests with specific configurations using `EPOLLET` and `EPOLLONESHOT` flags, such that the request becomes ready, but can't be completed inline.

**Required Attacker Capabilities/Position:**

-   The attacker needs the capability to create and submit `io_uring` poll requests with specific configurations, which typically requires some level of control over the application or system making io_uring syscalls.

**Technical Details:**

- The fix involves adding a call to `io_poll_add_hash(req)` in the `__io_arm_poll_handler` function. This ensures that if a ready poll request can't be finished inline, it will be inserted into the hash table. The `io_poll_add_hash` function either calls `io_poll_req_insert_locked` or `io_poll_req_insert` depending on the flags. This fixes the leak, preventing the stall in the ring exit process.
- The patch modifies `io_uring/poll.c`.
- The code changes specifically address scenarios where `(poll->events & (EPOLLET|EPOLLONESHOT)) == (EPOLLET|EPOLLONESHOT)` is true.
- This issue was reported and tested by syzbot.

This vulnerability was fixed by commit `febb985c06cb6f5fac63598c0bffd4fd823d110d` and backported to stable branches with commit `4ad6c063541665c407d17e1faf2fe4f04e947dcc`.