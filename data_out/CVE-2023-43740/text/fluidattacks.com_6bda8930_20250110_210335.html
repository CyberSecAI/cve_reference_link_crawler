[Contact us](/contact-us/)SearchEnglishEnglishEspaÃ±ol

* [![Fluid Attacks logo navbar](https://res.cloudinary.com/fluid-attacks/image/upload/f_auto,q_auto/v1/airs/menu/Logo?_a=AXAJYUZ0.webp)](/)
ServicePlatform[Plans](/plans/)Resources[Advisories](/advisories/)Company[Log in](https://app.fluidattacks.com/)[Try for free](https://app.fluidattacks.com/SignUp)
# Online Book Store Project v1.0 - Insecure File Upload

## Summary

|  |  |
| --- | --- |
| **Name** | Online Book Store Project v1.0 - Insecure File Upload |
| **Code name** | [Shagrath](https://en.wikipedia.org/wiki/Shagrath) |
| **Product** | Online Book Store Project |
| **Affected versions** | Version 1.0 |
|
| **State** | Public |
| **Release date** | 2023-09-28 |

## Vulnerability

|  |  |
| --- | --- |
| **Kind** | Insecure File Upload |
| **Rule** | [027. Insecure File Upload](https://docs.fluidattacks.com/criteria/vulnerabilities/027/) |
| **Remote** | Yes |
| **CVSSv3.1 Vector** | CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:C/C:H/I:H/A:H |
| **CVSSv3.1 Base Score** | 9.1 |
| **Exploit available** | Yes |
| **CVE ID(s)** | [CVE-2023-43740](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-43740) |

## Description

Online Book Store Project v1.0 is vulnerable to
an Insecure File Upload vulnerability on the 'image'
parameter of admin\_edit.php page, allowing an
authenticated attacker to obtain Remote Code Execution
on the server hosting the application.

## Vulnerability

The 'image' parameter of the admin\_edit.php resource
does not validate the contents, extension and type of
the file uploaded as a book image, leading to an
arbitrary file upload which can be abused to obtain
Remote Code Execution. The vulnerable code is located
at edit\_book.php:

```
if(isset($_FILES['image']) && $_FILES['image']['name'] != ""){
    $image = $_FILES['image']['name'];
    $directory_self = str_replace(basename($_SERVER['PHP_SELF']), '', $_SERVER['PHP_SELF']);
    $uploadDirectory = $_SERVER['DOCUMENT_ROOT'] . $directory_self . "bootstrap/img/";
    $uploadDirectory .= $image;
    move_uploaded_file($_FILES['image']['tmp_name'], $uploadDirectory);
}

```
## Evidence of exploitation

![evidence1](https://res.cloudinary.com/fluid-attacks/image/upload/v1695331753/airs/advisories/shagrath/evidence1.webp)

## Our security policy

We have reserved the ID CVE-2023-43740
to refer to this issue from now on.

* <https://fluidattacks.com/advisories/policy/>

## System Information

* Version: Online Book Store Project v1.0
* Operating System: Any

## Mitigation

There is currently no patch available for this vulnerability.

## Credits

The vulnerability was discovered by
[Andres Roldan](https://www.linkedin.com/in/andres-roldan/)
from Fluid Attacks' Offensive Team.

## References

**Vendor page** <https://projectworlds.in/>

## Timeline

![Time-lapse-logo](https://res.cloudinary.com/fluid-attacks/image/upload/f_auto,q_auto/v1/airs/icons/red-circle-check?_a=AXAJYUZ0.webp)

2023-09-21

Vulnerability discovered.

![Time-lapse-logo](https://res.cloudinary.com/fluid-attacks/image/upload/f_auto,q_auto/v1/airs/icons/red-circle-check?_a=AXAJYUZ0.webp)

2023-09-21

Vendor contacted.

![Time-lapse-logo](https://res.cloudinary.com/fluid-attacks/image/upload/f_auto,q_auto/v1/airs/icons/red-circle-check?_a=AXAJYUZ0.webp)

2023-09-28

Public Disclosure.

[![Fluid Logo Footer](https://res.cloudinary.com/fluid-attacks/image/upload/f_auto,q_auto/v1/airs/fluid-attacks-logo-2022-light?_a=AXAJYUZ0.webp)](/)

Hacking software for over 20 years

Fluid Attacks tests applications and other systems, covering all software development stages. Our team assists clients in quickly identifying and managing vulnerabilities to reduce the risk of incidents and deploy secure technology.

Service

[Continuous Hacking](/services/continuous-hacking/)[Platform overview](/platform/)

Solutions

[Application security](/solutions/)[Compliance](/compliance/)[Systems](/systems/)

Testing Techniques

[ASPM](/product/aspm/)[SAST](/product/sast/)[DAST](/product/dast/)[MPT](/product/mpt/)[MAST](/product/mast/)[SCA](/product/sca/)[CSPM](/product/cspm/)[PTaaS](/product/ptaas/)[RE](/product/re/)[SCR](/solutions/secure-code-review/)

Plans

[Essential](/plans/#essential)[Advanced](/plans/)

Resources

[Blog](/blog/)[Learn](/learn/)[Advisories](/advisories/)[Clients](/clients/)[Downloadables](/resources/)[Documentation](https://docs.fluidattacks.com/)

Company

[About us](/about-us/)[Certifications](/certifications/)[Partners](/partners/)[Careers](/careers/)[Contact us](/contact-us/)[Ethics Hotline](https://r.easyllama.com/ed68576b-c349-4f40-926b-4905c82c53bb)

Copyright Â© 0 Fluid Attacks. We hack your software. All rights reserved.

[Service status](https://status.fluidattacks.com/)[Terms of use](/terms-use/)[Privacy policy](/privacy/)[Cookie policy](/cookie/)

