
[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fgeotools%2Fgeotools%2Fpull%2F4797)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fgeotools%2Fgeotools%2Fpull%2F4797)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=geotools%2Fgeotools)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[geotools](/geotools)
/
**[geotools](/geotools/geotools)**
Public

* [Notifications](/login?return_to=%2Fgeotools%2Fgeotools) You must be signed in to change notification settings
* [Fork
  1.2k](/login?return_to=%2Fgeotools%2Fgeotools)
* [Star
   1.7k](/login?return_to=%2Fgeotools%2Fgeotools)

* [Code](/geotools/geotools)
* [Pull requests
  3](/geotools/geotools/pulls)
* [Actions](/geotools/geotools/actions)
* [Projects
  0](/geotools/geotools/projects)
* [Wiki](/geotools/geotools/wiki)
* [Security](/geotools/geotools/security)
* [Insights](/geotools/geotools/pulse)

Additional navigation options

* [Code](/geotools/geotools)
* [Pull requests](/geotools/geotools/pulls)
* [Actions](/geotools/geotools/actions)
* [Projects](/geotools/geotools/projects)
* [Wiki](/geotools/geotools/wiki)
* [Security](/geotools/geotools/security)
* [Insights](/geotools/geotools/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fgeotools%2Fgeotools%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fgeotools%2Fgeotools%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# [GEOT-7587] Improve handling of XPath expressions #4797

 Merged

[jodygarnett](/jodygarnett)
merged 1 commit into
[geotools:main](/geotools/geotools/tree/main "geotools/geotools:main")
from
[sikeoka:GEOT-7587](/sikeoka/geotools/tree/GEOT-7587 "sikeoka/geotools:GEOT-7587")

Jun 5, 2024

 Merged

# [[GEOT-7587] Improve handling of XPath expressions](#top) #4797

[jodygarnett](/jodygarnett)
merged 1 commit into
[geotools:main](/geotools/geotools/tree/main "geotools/geotools:main")
from
[sikeoka:GEOT-7587](/sikeoka/geotools/tree/GEOT-7587 "sikeoka/geotools:GEOT-7587")

Jun 5, 2024

[Conversation
16](/geotools/geotools/pull/4797)
[Commits
1](/geotools/geotools/pull/4797/commits)
[Checks
26](/geotools/geotools/pull/4797/checks)
[Files changed](/geotools/geotools/pull/4797/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![sikeoka](https://avatars.githubusercontent.com/u/11542093?s=60&v=4)](/sikeoka)

Copy link

Contributor

### @sikeoka **[sikeoka](/sikeoka)** commented [Jun 4, 2024](#issue-2333797410) • edited Loading

[![GEOT-7587](https://camo.githubusercontent.com/f85ee48b472a4ad18be554443ceac9d5d2cdaeb24d8dc91d0463b534e952b11d/68747470733a2f2f62616467656e2e6e65742f62616467652f4a4952412f47454f542d373538372f303035324343)](https://osgeo-org.atlassian.net/browse/GEOT-7587) [![Powered by Pull Request Badge](https://user-images.githubusercontent.com/1393946/111216524-d2bb8e00-85d4-11eb-821b-ed4c00989c02.png)](https://pullrequestbadge.com/?utm_medium=github&utm_source=geotools&utm_campaign=badge_info)

This PR refactors all jxpath initialization into a new utility method that disables calling functions from XPath expressions and fixes an incomplete class check that allowed complex feature code to be used on simple features. Some unnecessary dependency exclusions were also removed to clean up the pom.xml (commons-jxpath has no transitive dependencies).

# Checklist

* I have read the [contribution guidelines](https://github.com/geotools/geotools/blob/main/CONTRIBUTING.md).
* I have sent a [Contribution Licence Agreement](https://docs.geotools.org/latest/developer/procedures/contribution_license.html) (not required for small changes, e.g., fixing typos in documentation).
* First PR targets the `main` branch (backports managed later; ignore for branch specific issues).
* Avoid [Java 9+ split packages](http://tutorials.jenkov.com/java/modules.html#split-packages-not-allowed).
* All the build checks are green ([see automated QA checks](https://docs.geotools.org/latest/developer/conventions/code/qa.html)).

For core and extension modules:

* New unit tests have been added covering the changes.
* [Documentation](https://github.com/geotools/geotools/tree/main/docs) has been updated (if change is visible to end users).
* There is an issue in [GeoTools Jira](https://osgeo-org.atlassian.net/projects/GEOT) (except for changes not visible to end users).
* Commit message(s) must be in the form `[GEOT-XYZW] Title of the Jira ticket`.
* Bug fixes and small new features are presented as a single commit.
* The commit targets a single objective (if multiple focuses cannot be avoided, each one is in its own commit, and has a separate ticket describing it).

Sorry, something went wrong.

All reactions

 [![@sikeoka](https://avatars.githubusercontent.com/u/11542093?s=40&v=4)](/sikeoka)
[sikeoka](/sikeoka)
[force-pushed](/geotools/geotools/compare/582ac1723e66393cf7be63a9b2955427e877dc8b..fc74f9039d05753857788716c248416b005d13e5)
the
GEOT-7587

branch
from
[`582ac17`](/geotools/geotools/commit/582ac1723e66393cf7be63a9b2955427e877dc8b) to
[`fc74f90`](/geotools/geotools/commit/fc74f9039d05753857788716c248416b005d13e5)  [Compare](/geotools/geotools/compare/582ac1723e66393cf7be63a9b2955427e877dc8b..fc74f9039d05753857788716c248416b005d13e5)
[June 4, 2024 15:24](#event-13038306967)

[![davidblasby](https://avatars.githubusercontent.com/u/48937730?s=60&v=4)](/davidblasby)

**[davidblasby](/davidblasby)**
reviewed
[Jun 4, 2024](#pullrequestreview-2096872818)

 [View reviewed changes](/geotools/geotools/pull/4797/files)

[modules/extension/xsd/xsd-core/src/test/java/org/geotools/xsd/StreamingParserTest.java](/geotools/geotools/pull/4797/files#diff-35b25d78737fbba349f6122e6ed3373ae5c731a563172be688c4ec24e1a296b6)
Outdated

Show resolved

Hide resolved

[![davidblasby](https://avatars.githubusercontent.com/u/48937730?s=60&v=4)](/davidblasby)

**[davidblasby](/davidblasby)**
approved these changes
[Jun 4, 2024](#pullrequestreview-2096875009)

 [View reviewed changes](/geotools/geotools/pull/4797/files)

Copy link

Contributor

### @davidblasby **[davidblasby](/davidblasby)** left a comment

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Looks like a great addition. I don't really know the code, so I cannot say too much - sorry.

I think increasing the 5 second to something like 20 seconds would make it very unlikely to have a busy-machine problem. However, this is just a guess - its okay the way it is.

Sorry, something went wrong.

All reactions

[...ension/complex/src/test/java/org/geotools/filter/expression/FeaturePropertyAccessorTest.java](/geotools/geotools/pull/4797/files#diff-e7291403b36ac2cf7efe976006490c89af1c3fde587fc34023b63feae8ba4817)

Show resolved

Hide resolved

[![@sikeoka](https://avatars.githubusercontent.com/u/11542093?s=40&v=4)](/sikeoka)

`[[GEOT-7587] Improve handling of XPath expressions](/geotools/geotools/pull/4797/commits/e53e5170ba71521728875a436c80616cfb03c1e8 "[GEOT-7587] Improve handling of XPath expressions")`

`[e53e517](/geotools/geotools/pull/4797/commits/e53e5170ba71521728875a436c80616cfb03c1e8)`

 [![@sikeoka](https://avatars.githubusercontent.com/u/11542093?s=40&v=4)](/sikeoka)
[sikeoka](/sikeoka)
[force-pushed](/geotools/geotools/compare/fc74f9039d05753857788716c248416b005d13e5..e53e5170ba71521728875a436c80616cfb03c1e8)
the
GEOT-7587

branch
from
[`fc74f90`](/geotools/geotools/commit/fc74f9039d05753857788716c248416b005d13e5) to
[`e53e517`](/geotools/geotools/commit/e53e5170ba71521728875a436c80616cfb03c1e8)  [Compare](/geotools/geotools/compare/fc74f9039d05753857788716c248416b005d13e5..e53e5170ba71521728875a436c80616cfb03c1e8)
[June 4, 2024 17:20](#event-13039675775)

[![jodygarnett](https://avatars.githubusercontent.com/u/629681?s=60&v=4)](/jodygarnett)

**[jodygarnett](/jodygarnett)**
approved these changes
[Jun 5, 2024](#pullrequestreview-2097658624)

 [View reviewed changes](/geotools/geotools/pull/4797/files/e53e5170ba71521728875a436c80616cfb03c1e8)

Copy link

Member

### @jodygarnett **[jodygarnett](/jodygarnett)** left a comment

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

I am approving, with some minor feedback (test case threadsafety, and method name choice). I do not feel comfortable about "request changes" as that would block PR.

[@sikeoka](https://github.com/sikeoka) I will wait for your response/consideration before merge and backport.

Sorry, something went wrong.

All reactions

[modules/extension/xsd/xsd-core/src/test/java/org/geotools/xsd/StreamingParserTest.java](/geotools/geotools/pull/4797/files/e53e5170ba71521728875a436c80616cfb03c1e8#diff-35b25d78737fbba349f6122e6ed3373ae5c731a563172be688c4ec24e1a296b6)

|  |  | public void testParseWithJavaMethod() throws Exception { |
| --- | --- | --- |
|  |  | ByteArrayInputStream in = new ByteArrayInputStream("<mails></mails>".getBytes()); |
|  |  | StreamingParser parser = |
|  |  | new StreamingParser(new MLConfiguration(), in, "java.lang.Thread.sleep(30000)"); |

Copy link

Member

### @jodygarnett **[jodygarnett](/jodygarnett)** [Jun 5, 2024](#discussion_r1626792478)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

I am a bit confused as to choosing a time based example? Why not `java.lang.Math.abs(-1.0)` - and test. to see that 1.0 is returned. This would be a test that is not sensitive to build server speed?

Sorry, something went wrong.

All reactions

Copy link

Contributor

Author

### @sikeoka **[sikeoka](/sikeoka)** [Jun 5, 2024](#discussion_r1627946796) • edited Loading

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

This is a type of issue that is commonly referred to as `blind`. Just because something is being done doesn't mean that the result is actually sent anywhere so I needed some kind of side effect that I could check for. I originally tested this using `System.exit` but that isn't as JUnit or Maven friendly.

Sorry, something went wrong.

 😄
1
 jodygarnett reacted with laugh emoji

All reactions

* 😄
  1 reaction

Copy link

Member

### @jodygarnett **[jodygarnett](/jodygarnett)** [Jun 5, 2024](#discussion_r1628082131)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Okay that makes sense, thanks for explaining.

Sorry, something went wrong.

All reactions

[...mplex/src/main/java/org/geotools/data/complex/expression/FeaturePropertyAccessorFactory.java](/geotools/geotools/pull/4797/files/e53e5170ba71521728875a436c80616cfb03c1e8#diff-a4ed841fe4f8d1ef6262ee61a6b0e8ae4a4d27b10d5d4eb2ec7f4d3c3b99d775)

|  |  | } |
| --- | --- | --- |
|  |  |  |
|  |  | JXPathContext context = |
|  |  | JXPathUtils.newSafeContext(object, false, this.namespaces, true); |

Copy link

Member

### @jodygarnett **[jodygarnett](/jodygarnett)** [Jun 5, 2024](#discussion_r1626794060)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Minor feedback, `newSafeContext` may promise too much, if attribute security is used for something like GeoFence security plugin this would not know enough to prevent specific data traversals.

A name like `newDataContext` would be more clear this is about providing access to data only, not functions.

Sorry, something went wrong.

All reactions

Copy link

Contributor

Author

### @sikeoka **[sikeoka](/sikeoka)** [Jun 5, 2024](#discussion_r1627956415) • edited Loading

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

I named this based on two existing cases for similar types of issues although `getSafeContext` would be a more consistent name than `newSafeContext`:

org.geoserver.template.TemplateUtils.getSafeConfiguration()

org.geotools.ysld.YamlUtil.getSafeYaml()

Sorry, something went wrong.

 👍
1
 jodygarnett reacted with thumbs up emoji

All reactions

* 👍
  1 reaction

[modules/extension/xsd/xsd-core/src/main/java/org/geotools/xsd/impl/jxpath/JXPathUtils.java](/geotools/geotools/pull/4797/files/e53e5170ba71521728875a436c80616cfb03c1e8#diff-6e0fd86b25d51c6240ad166fd0ac1d8d4e3afd3c5612841d07c2b9a2c4914cf2)

|  |  | \* @param lenient whether the context is in lenient mode |
| --- | --- | --- |
|  |  | \* @return the context |
|  |  | \*/ |
|  |  | public static JXPathContext newSafeContext(Object contextBean, boolean lenient) { |

Copy link

Member

### @jodygarnett **[jodygarnett](/jodygarnett)** [Jun 5, 2024](#discussion_r1626798918)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Thanks for the clear javadocs I appreciate it.

Minor feedback: Consider `newDataContext` to accurately describe the restriction of no methods. In a more complicated security model such as GeoFence data traversal may be considered "unsafe" leading to this method name being misleading / incomplete.

Sorry, something went wrong.

All reactions

Copy link

Contributor

Author

### @sikeoka **[sikeoka](/sikeoka)** [Jun 5, 2024](#discussion_r1627959633)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

I really don't understand this comment since GeoFence has no dependence on gt-complex or commons-jxpath.

Sorry, something went wrong.

All reactions

Copy link

Member

### @jodygarnett **[jodygarnett](/jodygarnett)** [Jun 5, 2024](#discussion_r1628081109)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

I was trying to indicate that specific attributes may be restricted (using a geofence as an example of a plugin that offers this kind of functionality).

So "safe" indicates no functions, but it would not be safe from using xpath to traverse data to access a restricted columns.

As indicated this was minor feedback only.

Sorry, something went wrong.

All reactions

[![@jodygarnett](https://avatars.githubusercontent.com/u/629681?s=40&u=882f3d31e5d450f43ca9f54f468dcd79c4305895&v=4)](/jodygarnett)
[jodygarnett](/jodygarnett)
added
[backport 30.x](/geotools/geotools/labels/backport%2030.x)
Backport bot will backport to 30.x on merge
[backport 31.x](/geotools/geotools/labels/backport%2031.x)
Automatic backport to 31.x branch
labels
[Jun 5, 2024](#event-13054295136)

 Hide details
View details

[![@jodygarnett](https://avatars.githubusercontent.com/u/629681?s=40&u=882f3d31e5d450f43ca9f54f468dcd79c4305895&v=4)](/jodygarnett)
[jodygarnett](/jodygarnett)
merged commit [`f0c9961`](/geotools/geotools/commit/f0c9961dc4d40c5acfce2169fab92805738de5ea)
into
geotools:main

[Jun 5, 2024](https://github.com/geotools/geotools/pull/4797#event-13054297928)
23 checks passed

This was referenced Jun 5, 2024

[[Backport 30.x] [GEOT-7587] Improve handling of XPath expressions
#4800](/geotools/geotools/pull/4800)
 Merged

[[Backport 31.x] [GEOT-7587] Improve handling of XPath expressions
#4801](/geotools/geotools/pull/4801)
 Merged

[![@aaime](https://avatars.githubusercontent.com/u/325433?s=40&u=07d7270f523f3613ee5934affa295ba5ade1e0f6&v=4)](/aaime)
[aaime](/aaime)
added
the
[backport 29.x](/geotools/geotools/labels/backport%2029.x)
label
[Jun 5, 2024](#event-13055052455)

[![@aaime](https://avatars.githubusercontent.com/u/325433?s=80&u=07d7270f523f3613ee5934affa295ba5ade1e0f6&v=4)](/aaime)

Copy link

Member

### **[aaime](/aaime)** commented [Jun 5, 2024](#issuecomment-2150598038)

| The backport to `29.x` failed:  ``` The process '/usr/bin/git' failed with exit code 1  ```  stderr ``` error: could not apply e53e5170ba... [GEOT-7587] Improve handling of XPath expressions hint: After resolving the conflicts, mark them with hint: "git add/rm <pathspec>", then run hint: "git cherry-pick --continue". hint: You can instead skip this commit with "git cherry-pick --skip". hint: To abort and get back to the state before "git cherry-pick", hint: run "git cherry-pick --abort". hint: Disable this message with "git config advice.mergeConflict false"   ```   stdout ``` Auto-merging modules/extension/complex/src/main/java/org/geotools/data/complex/expression/FeaturePropertyAccessorFactory.java CONFLICT (content): Merge conflict in modules/extension/complex/src/main/java/org/geotools/data/complex/expression/FeaturePropertyAccessorFactory.java Auto-merging modules/extension/complex/src/main/java/org/geotools/data/complex/expression/MapPropertyAccessorFactory.java CONFLICT (content): Merge conflict in modules/extension/complex/src/main/java/org/geotools/data/complex/expression/MapPropertyAccessorFactory.java Auto-merging modules/extension/complex/src/test/java/org/geotools/filter/expression/FeaturePropertyAccessorTest.java Auto-merging modules/extension/xsd/xsd-core/pom.xml CONFLICT (content): Merge conflict in modules/extension/xsd/xsd-core/pom.xml   ```   To backport manually, run these commands in your terminal:  ``` # Fetch latest updates from GitHub git fetch # Create a new working tree git worktree add .worktrees/backport-29.x 29.x # Navigate to the new working tree cd .worktrees/backport-29.x # Create a new branch git switch --create backport-4797-to-29.x # Cherry-pick the merged commit of this pull request and resolve the conflicts git cherry-pick e53e5170ba71521728875a436c80616cfb03c1e8 # Push it to GitHub git push --set-upstream origin backport-4797-to-29.x # Go back to the original working tree cd ../.. # Delete the working tree git worktree remove .worktrees/backport-29.x ```  Then, create a pull request where the `base` branch is `29.x` and the `compare`/`head` branch is `backport-4797-to-29.x`. |
| --- |

All reactions

Sorry, something went wrong.

[![@aaime](https://avatars.githubusercontent.com/u/325433?s=40&u=07d7270f523f3613ee5934affa295ba5ade1e0f6&v=4)](/aaime)
[aaime](/aaime)
added
the
[failed backport](/geotools/geotools/labels/failed%20backport)
label
[Jun 5, 2024](#event-13055057875)

[![@jodygarnett](https://avatars.githubusercontent.com/u/629681?s=40&u=882f3d31e5d450f43ca9f54f468dcd79c4305895&v=4)](/jodygarnett)
[jodygarnett](/jodygarnett)
removed
[failed backport](/geotools/geotools/labels/failed%20backport)
[backport 29.x](/geotools/geotools/labels/backport%2029.x)
labels
[Jun 6, 2024](#event-13058784777)

[![@foyaga](https://avatars.githubusercontent.com/u/62537001?s=40&v=4)](/foyaga)
[foyaga](/foyaga)
mentioned this pull request
[Jul 2, 2024](#ref-issue-2385743357)

[GeoServer property 表达式注入代码执行漏洞（CVE-2024-36401）
foyaga/blog-timeline#294](/foyaga/blog-timeline/issues/294)

Open

[![@mirandadam](https://avatars.githubusercontent.com/u/3647225?s=40&v=4)](/mirandadam)
[mirandadam](/mirandadam)
mentioned this pull request
[Jul 3, 2024](#ref-issue-2385631793)

[Geoserver build for patch CVE-2024-36401
GeoNode/geonode-docker#44](/GeoNode/geonode-docker/issues/44)

Closed

 [![@sikeoka](https://avatars.githubusercontent.com/u/11542093?s=40&v=4)](/sikeoka)
[sikeoka](/sikeoka)
deleted the
GEOT-7587

branch
[July 15, 2024 20:09](#event-13510525358)

[![@javacoderpyl](https://avatars.githubusercontent.com/u/39752479?s=80&v=4)](/javacoderpyl)

Copy link

### **[javacoderpyl](/javacoderpyl)** commented [Aug 8, 2024](#issuecomment-2275155113)

| Hi, bro, since the versions 30.4, 31.2, and 29.6 of GeoTools that fix the vulnerability CVE-2024-36404 are all compiled jar files based on JDK 11, could you release a version that fixes this vulnerability but is compiled with JDK 8, such as version 28.x? |
| --- |

All reactions

Sorry, something went wrong.

[![@jodygarnett](https://avatars.githubusercontent.com/u/629681?s=80&u=882f3d31e5d450f43ca9f54f468dcd79c4305895&v=4)](/jodygarnett)

Copy link

Member

### **[jodygarnett](/jodygarnett)** commented [Aug 8, 2024](#issuecomment-2275897504)

| No one has volunteered to do that. We have a public release procedure if you wish to volunteer.  Even if you back port this fix, there are other vulnerabilities in older versions so why bother? |
| --- |

All reactions

Sorry, something went wrong.

[![@javacoderpyl](https://avatars.githubusercontent.com/u/39752479?s=80&v=4)](/javacoderpyl)

Copy link

### **[javacoderpyl](/javacoderpyl)** commented [Aug 8, 2024](#issuecomment-2275954126)

| No one has volunteered to do that. We have a public release procedure if you wish to volunteer.  Even if you back port this fix, there are other vulnerabilities in older versions so why bother?  Because our projects are based on Jdk8, the version of jdk11 cannot be run in our project. If I can study the open course and release a jdk 8 version of geotools that solves this vulnerability, how should I get this course? |
| --- |

All reactions

Sorry, something went wrong.

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fgeotools%2Fgeotools%2Fpull%2F4797)

Reviewers

[![@jodygarnett](https://avatars.githubusercontent.com/u/629681?s=40&v=4)](/jodygarnett) [jodygarnett](/jodygarnett)

jodygarnett approved these changes

[![@davidblasby](https://avatars.githubusercontent.com/u/48937730?s=40&v=4)](/davidblasby) [davidblasby](/davidblasby)

davidblasby approved these changes

Assignees

No one assigned

Labels

[backport 30.x](/geotools/geotools/labels/backport%2030.x)
Backport bot will backport to 30.x on merge
[backport 31.x](/geotools/geotools/labels/backport%2031.x)
Automatic backport to 31.x branch

Projects

None yet

Milestone

No milestone

Development

Successfully merging this pull request may close these issues.

5 participants

[![@sikeoka](https://avatars.githubusercontent.com/u/11542093?s=52&v=4)](/sikeoka) [![@aaime](https://avatars.githubusercontent.com/u/325433?s=52&v=4)](/aaime) [![@javacoderpyl](https://avatars.githubusercontent.com/u/39752479?s=52&v=4)](/javacoderpyl) [![@jodygarnett](https://avatars.githubusercontent.com/u/629681?s=52&v=4)](/jodygarnett) [![@davidblasby](https://avatars.githubusercontent.com/u/48937730?s=52&v=4)](/davidblasby)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.

