

[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fbrowser%2Fbuddypress-members-only%2Ftrunk%2Fbuddypress-members-only.php)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Revision](/browser/buddypress-members-only/trunk/buddypress-members-only.php?rev=3129696 "Revision 3129696")
* Next Revision →
* [Blame](/browser/buddypress-members-only/trunk/buddypress-members-only.php?annotate=blame "Annotate each line with the last changed revision (this can be time consuming...)")
* [Revision Log](/log/buddypress-members-only/trunk/buddypress-members-only.php)

---

# [source:](/browser?order=name "Go to repository root") [buddypress-members-only](/browser/buddypress-members-only?order=name "View buddypress-members-only")/[trunk](/browser/buddypress-members-only/trunk?order=name "View trunk")/[buddypress-members-only.php](/browser/buddypress-members-only/trunk/buddypress-members-only.php?order=name "View buddypress-members-only.php")

View diff against:

View revision:

| [Last change](/changeset/3132682/buddypress-members-only/trunk/buddypress-members-only.php "View differences") on this file was [3132682](/changeset/3132682/ "View changeset 3132682"), checked in by zhuyi, [5 months ago](/timeline?from=2024-08-08T12%3A00%3A44Z&precision=second "See timeline at 08/08/2024 12:00:44 PM") |
| --- |
| 3.5.3 |
| **File size:** 50.4 KB | |

| Line |  |
| --- | --- |
| [1](#L1) | <?php |
| [2](#L2) | /\* |
| [3](#L3) | Plugin Name: BuddyPress Members only |
| [4](#L4) | Plugin URI: https://membersonly.top/features/ |
| [5](#L5) | Description: Only registered users can view your site, non members can only see a login/home page with no registration options. More amazing features? Login and Logout auto redirect to Referer page or Certain page based on user roles,  Restricts your BP standard Components and customized  Components to users,enable page level members only protect, only protect your buddypress and open all other WP area to users... etc, Get <a href='https://membersonly.top' target='blank'>BP Members Only Pro</a> now. |
| [6](#L6) | Version: 3.5.3 |
| [7](#L7) | Author: Tomas: <a href='https://membersonly.top/features/' target='\_blank'>Features</a> | <a href='https://membersonly.top/forums' target='\_blank'>Support Forum</a> |
| [8](#L8) | Author URI: https://membersonly.top/features/ |
| [9](#L9) | Text Domain: bp-members-only |
| [10](#L10) | License: GPLv3 or later |
| [11](#L11) | Copyright 2015 - 2024  Tomas Zhu  (https://membersonly.top) |
| [12](#L12) | This program comes with ABSOLUTELY NO WARRANTY; |
| [13](#L13) | https://www.gnu.org/licenses/gpl-3.0.html |
| [14](#L14) | https://www.gnu.org/licenses/quick-guide-gplv3.html |
| [15](#L15) | \*/ |
| [16](#L16) | if (!defined('ABSPATH')) |
| [17](#L17) | { |
| [18](#L18) | exit; |
| [19](#L19) | } |
| [20](#L20) |  |
| [21](#L21) | define('BP\_MEMBERS\_ONLY\_FREE\_ADMIN\_PATH', plugin\_dir\_path(\_\_FILE\_\_).'admin'.'/'); |
| [22](#L22) |  |
| [23](#L23) | //!!! start 3.4.9 |
| [24](#L24) | $bprestrictrestapi = get\_option ( 'bprestrictrestapi' ); |
| [25](#L25) |  |
| [26](#L26) | if ( $bprestrictrestapi == 'yes') |
| [27](#L27) | { |
| [28](#L28) | require\_once("rules/rest.php"); |
| [29](#L29) | } |
| [30](#L30) | //!!! end 3.4.9 |
| [31](#L31) |  |
| [32](#L32) | //!!! before 3.4.9 require\_once("rules/rest.php"); |
| [33](#L33) | $bpmoinitsetup = get\_option ( 'bpmoinitsetup' ); |
| [34](#L34) | if (empty($bpmoinitsetup)) |
| [35](#L35) | { |
| [36](#L36) | require\_once("rules/bpmoinit.php"); |
| [37](#L37) | } |
| [38](#L38) |  |
| [39](#L39) | $bpmofreecurrentversion = get\_option ( 'bpmofreecurrentversion' ); |
| [40](#L40) | $bpmofreecurrentversion = str\_replace ( '.', '', $bpmofreecurrentversion ); |
| [41](#L41) | if (empty ( $bpmofreecurrentversion )) |
| [42](#L42) | { |
| [43](#L43) |  |
| [44](#L44) | } |
| [45](#L45) | else |
| [46](#L46) | { |
| [47](#L47) | define('BPMO\_FREE\_VERSION', '3.4.3'); |
| [48](#L48) | update\_option ( 'bpmofreecurrentversion', BPMO\_FREE\_VERSION); |
| [49](#L49) | } |
| [50](#L50) |  |
| [51](#L51) |  |
| [52](#L52) | require\_once("componentsettings.php"); |
| [53](#L53) | require\_once('rules/posttypes.php'); |
| [54](#L54) | require\_once("rules/shortcoderestriction.php"); // 2.8.5 |
| [55](#L55) | require\_once('rules/rssrestrictssetting.php'); |
| [56](#L56) | require\_once("rules/activityrssrestrict.php"); |
| [57](#L57) | require\_once("rules/restrictwordpressrss.php"); //3.3.3 |
| [58](#L58) |  |
| [59](#L59) | ob\_start(); |
| [60](#L60) | add\_action('admin\_menu', 'bp\_members\_only\_option\_menu'); |
| [61](#L61) |  |
| [62](#L62) | /\*\*\*\* localization \*\*\*\*/ |
| [63](#L63) | add\_action('plugins\_loaded','bp\_members\_only\_load\_textdomain'); |
| [64](#L64) |  |
| [65](#L65) | function bp\_members\_only\_load\_textdomain() |
| [66](#L66) | { |
| [67](#L67) | load\_plugin\_textdomain('bp-members-only', false, dirname( plugin\_basename( \_\_FILE\_\_ ) ).'/languages/'); |
| [68](#L68) | } |
| [69](#L69) |  |
| [70](#L70) | function bp\_members\_only\_option\_menu() |
| [71](#L71) | { |
| [72](#L72) |  |
| [73](#L73) | add\_menu\_page(\_\_('Buddypress Members Only', 'bp-members-only'), \_\_('Buddypress Members Only', 'bp-members-only'), 'manage\_options', 'bpmemberonly', 'buddypress\_members\_only\_setting'); |
| [74](#L74) | add\_submenu\_page('bpmemberonly', \_\_('Buddypress Members Only','bp-members-only'), \_\_('Buddypress Members Only','bp-members-only'), 'manage\_options', 'bpmemberonly', 'buddypress\_members\_only\_setting'); |
| [75](#L75) | add\_submenu\_page ( 'bpmemberonly', \_\_ ( 'Buddypress Members Only', 'bp-members-only' ), \_\_ ( 'BP Components', 'bp-members-only' ), 'manage\_options', 'bpmembercomponentonly', 'buddypress\_members\_component\_setting\_free' ); |
| [76](#L76) | add\_submenu\_page ( 'bpmemberonly', \_\_ ( 'Buddypress Members Only', 'bp-members-only' ), \_\_ ( 'Restrict Post Types','bp-members-only'),"manage\_options", 'bpMembersOnlyFreePostTypesSettings','bpMembersOnlyFreePostTypesSettings');  //!!! |
| [77](#L77) | add\_submenu\_page ( 'bpmemberonly', \_\_ ( 'BP Members Only', 'bp-members-only' ), \_\_ ( 'RSS Restricts', 'bp-members-only' ), 'manage\_options', 'bpmemberrssrestricts', 'buddypress\_members\_rss\_restricts\_setting\_free' ); |
| [78](#L78) | add\_submenu\_page('bpmemberonly',\_\_('Knowledge Base','bp-members-only'), \_\_('Knowledge Base','bp-members-only'),"manage\_options", 'membersonlyfaq','membersOnlyFreeFAQ'); |
| [79](#L79) | } |
| [80](#L80) |  |
| [81](#L81) | //!!!start |
| [82](#L82) | $bpdisableallfeature = get\_option('bpdisableallfeature'); |
| [83](#L83) | if ('yes' == $bpdisableallfeature) |
| [84](#L84) | { |
| [85](#L85) | return; |
| [86](#L86) | } |
| [87](#L87) | //!!!end |
| [88](#L88) |  |
| [89](#L89) | function buddypress\_members\_only\_setting() |
| [90](#L90) | { |
| [91](#L91) | global $wpdb; |
| [92](#L92) |  |
| [93](#L93) | $bpmemonlyredirectbppagesafterlogin = 'bpmemonlyredirectbppagesafterlogin\_Subscriber'; |
| [94](#L94) | $bpmemonlyredirecttypeafterlogin = 'bpmemonlyredirecttypeafterlogin\_Subscriber'; |
| [95](#L95) | $bpmemonlyredirecttypeafterloginoption = get\_option($bpmemonlyredirecttypeafterlogin); |
| [96](#L96) | $bpmemonlyredirectbppagesafterloginoption = get\_option($bpmemonlyredirectbppagesafterlogin); |
| [97](#L97) |  |
| [98](#L98) | $m\_bpmoregisterpageurl = get\_option('bpmoregisterpageurl'); |
| [99](#L99) |  |
| [100](#L100) | if (isset($\_POST['bpmosubmitnew'])) |
| [101](#L101) | { |
| [102](#L102) | // 1.8.3 |
| [103](#L103) | check\_admin\_referer( 'bpmo\_tomas\_bp\_members\_only\_nonce' ); |
| [104](#L104) | if (isset($\_POST['bpmoregisterpageurl'])) |
| [105](#L105) | { |
| [106](#L106) | //3.2.3 |
| [107](#L107) | $m\_bpmoregisterpageurl = sanitize\_url($\_POST['bpmoregisterpageurl']); |
| [108](#L108) | //$m\_bpmoregisterpageurl = esc\_url($\_POST['bpmoregisterpageurl']); |
| [109](#L109) | } |
| [110](#L110) |  |
| [111](#L111) | update\_option('bpmoregisterpageurl',$m\_bpmoregisterpageurl); |
| [112](#L112) |  |
| [113](#L113) | if (isset($\_POST['bpopenedpageurl'])) |
| [114](#L114) | { |
| [115](#L115) | $bpopenedpageurl = trim($\_POST['bpopenedpageurl']); |
| [116](#L116) | if (strlen($bpopenedpageurl) == 0) |
| [117](#L117) | { |
| [118](#L118) | delete\_option('saved\_open\_page\_url'); |
| [119](#L119) | } |
| [120](#L120) | else |
| [121](#L121) | { |
| [122](#L122) | if (function\_exists('sanitize\_textarea\_field')) |
| [123](#L123) | { |
| [124](#L124) | $bpopenedpageurl = sanitize\_textarea\_field($bpopenedpageurl); |
| [125](#L125) | } |
| [126](#L126) |  |
| [127](#L127) | update\_option('saved\_open\_page\_url',$bpopenedpageurl); |
| [128](#L128) | } |
| [129](#L129) | } |
| [130](#L130) |  |
| [131](#L131) |  |
| [132](#L132) | if (isset($\_POST[$bpmemonlyredirecttypeafterlogin])) |
| [133](#L133) | { |
| [134](#L134) | //3.2.3 |
| [135](#L135) | update\_option($bpmemonlyredirecttypeafterlogin, sanitize\_text\_field($\_POST[$bpmemonlyredirecttypeafterlogin])); |
| [136](#L136) | //update\_option($bpmemonlyredirecttypeafterlogin, $\_POST[$bpmemonlyredirecttypeafterlogin]); |
| [137](#L137) | if (isset($\_POST[$bpmemonlyredirectbppagesafterlogin])) |
| [138](#L138) | { |
| [139](#L139) | //3.2.3 |
| [140](#L140) | update\_option($bpmemonlyredirectbppagesafterlogin, sanitize\_text\_field($\_POST[$bpmemonlyredirectbppagesafterlogin])); |
| [141](#L141) | //update\_option($bpmemonlyredirectbppagesafterlogin, $\_POST[$bpmemonlyredirectbppagesafterlogin]); |
| [142](#L142) | } |
| [143](#L143) | } |
| [144](#L144) | else |
| [145](#L145) | { |
| [146](#L146) | delete\_option($bpmemonlyredirecttypeafterlogin); |
| [147](#L147) | delete\_option($bpmemonlyredirectbppagesafterlogin); |
| [148](#L148) | } |
| [149](#L149) |  |
| [150](#L150) | if (isset ( $\_POST ['bprestrictsbuddypresssection'] )) { |
| [151](#L151) | //3.2.3 |
| [152](#L152) | $m\_bprestrictsbuddypresssection = sanitize\_text\_field($\_POST ['bprestrictsbuddypresssection']); |
| [153](#L153) | //$m\_bprestrictsbuddypresssection = $\_POST ['bprestrictsbuddypresssection']; |
| [154](#L154) | update\_option ( 'bprestrictsbuddypresssection', $m\_bprestrictsbuddypresssection ); |
| [155](#L155) | } else { |
| [156](#L156) | delete\_option ( 'bprestrictsbuddypresssection' ); |
| [157](#L157) | } |
| [158](#L158) |  |
| [159](#L159) | if (isset ( $\_POST ['bprestrictrestapi'] )) { |
| [160](#L160) | //3.4.9 |
| [161](#L161) | $m\_bprestrictrestapi = sanitize\_text\_field($\_POST ['bprestrictrestapi']); |
| [162](#L162) | update\_option ( 'bprestrictrestapi', $m\_bprestrictrestapi ); |
| [163](#L163) | } else { |
| [164](#L164) | delete\_option ( 'bprestrictrestapi' ); |
| [165](#L165) | } |
| [166](#L166) |  |
| [167](#L167) | $bpmoMessageString =  \_\_( 'Your changes has been saved.', 'bp-members-only' ); |
| [168](#L168) | buddypress\_members\_only\_message($bpmoMessageString); |
| [169](#L169) |  |
| [170](#L170) |  |
| [171](#L171) | if (isset($\_POST['bpdisableallfeature'])) |
| [172](#L172) | { |
| [173](#L173) | $bpdisableallfeature = sanitize\_text\_field($\_POST['bpdisableallfeature']); |
| [174](#L174) | update\_option('bpdisableallfeature',$bpdisableallfeature); |
| [175](#L175) | } |
| [176](#L176) | else |
| [177](#L177) | { |
| [178](#L178) | delete\_option('bpdisableallfeature'); |
| [179](#L179) | } |
| [180](#L180) |  |
| [181](#L181) | $bpdisableallfeature = get\_option('bpdisableallfeature'); |
| [182](#L182) |  |
| [183](#L183) | if (isset ( $\_POST ['bpenablepagelevelprotect'] )) |
| [184](#L184) | { |
| [185](#L185) | //3.2.3 |
| [186](#L186) |  |
| [187](#L187) | $m\_bpenablepagelevelprotect = sanitize\_text\_field($\_POST ['bpenablepagelevelprotect']); |
| [188](#L188) | //$m\_bpenablepagelevelprotect = $\_POST ['bpenablepagelevelprotect']; |
| [189](#L189) | update\_option ( 'bpenablepagelevelprotect', $m\_bpenablepagelevelprotect ); |
| [190](#L190) | } |
| [191](#L191) | else |
| [192](#L192) | { |
| [193](#L193) | delete\_option ( 'bpenablepagelevelprotect' ); |
| [194](#L194) | } |
| [195](#L195) | $bpenablepagelevelprotect = get\_option ( 'bpenablepagelevelprotect' ); |
| [196](#L196) |  |
| [197](#L197) | //tomas\_bbp\_member\_only\_free\_custom\_links\_login |
| [198](#L198) | if (isset ( $\_POST ['tomas\_bbp\_member\_only\_free\_custom\_links\_login'] ) && (!(empty($\_POST ['tomas\_bbp\_member\_only\_free\_custom\_links\_login'])))) |
| [199](#L199) | { |
| [200](#L200) | //3.2.3 |
| [201](#L201) | $tomas\_bbp\_member\_only\_free\_custom\_links\_login = sanitize\_text\_field($\_POST ['tomas\_bbp\_member\_only\_free\_custom\_links\_login']); |
| [202](#L202) |  |
| [203](#L203) | //$tomas\_bbp\_member\_only\_free\_custom\_links\_login = $\_POST ['tomas\_bbp\_member\_only\_free\_custom\_links\_login']; |
| [204](#L204) | update\_option ( 'tomas\_bbp\_member\_only\_free\_custom\_links\_login', $tomas\_bbp\_member\_only\_free\_custom\_links\_login ); |
| [205](#L205) | add\_rewrite\_rule( $tomas\_bbp\_member\_only\_free\_custom\_links\_login.'/?$', 'wp-login.php', 'top' ); |
| [206](#L206) | flush\_rewrite\_rules(); |
| [207](#L207) | } |
| [208](#L208) | else |
| [209](#L209) | { |
| [210](#L210) | delete\_option ( 'tomas\_bbp\_member\_only\_free\_custom\_links\_login' ); |
| [211](#L211) | flush\_rewrite\_rules(); |
| [212](#L212) | } |
| [213](#L213) | $tomas\_bbp\_member\_only\_free\_custom\_links\_login = get\_option ( 'tomas\_bbp\_member\_only\_free\_custom\_links\_login' ); |
| [214](#L214) | } |
| [215](#L215) | echo "<br />"; |
| [216](#L216) |  |
| [217](#L217) | $saved\_register\_page\_url = get\_option('bpmoregisterpageurl'); |
| [218](#L218) | $bpmemonlyredirecttypeafterloginoption = get\_option($bpmemonlyredirecttypeafterlogin); |
| [219](#L219) | $bpmemonlyredirectbppagesafterloginoption = get\_option($bpmemonlyredirectbppagesafterlogin); |
| [220](#L220) | ?> |
| [221](#L221) |  |
| [222](#L222) | <div style='margin:10px 5px;'> |
| [223](#L223) | <div style='float:left;margin-right:10px;'> |
| [224](#L224) | <?php |
| [225](#L225) | /\* |
| [226](#L226) | //before 3.5.1 |
| [227](#L227) | <img src='<?php echo get\_option('siteurl');  ?>/wp-content/plugins/buddypress-members-only/images/new.png' style='width:30px;height:30px;'> |
| [228](#L228) | \*/ |
| [229](#L229) | //3.5.1 |
| [230](#L230) | ?> |
| [231](#L231) | <img src='<?php echo plugins\_url('/images/new.png', \_\_FILE\_\_);  ?>' style='width:30px;height:30px;'> |
| [232](#L232) |  |
| [233](#L233) | </div> |
| [234](#L234) | <div style='padding-top:5px; font-size:22px;'> <i></>Buddypress Members Only Setting:</i></div> |
| [235](#L235) | </div> |
| [236](#L236) | <div style='clear:both'></div> |
| [237](#L237) | <div class="wrap"> |
| [238](#L238) | <div id="dashboard-widgets-wrap"> |
| [239](#L239) | <div id="dashboard-widgets" class="metabox-holder"> |
| [240](#L240) | <div id="post-body"  style="width:60%;"> |
| [241](#L241) | <div id="dashboard-widgets-main-content"> |
| [242](#L242) | <div class="postbox-container" style="width:98%;"> |
| [243](#L243) | <div class="postbox"> |
| [244](#L244) | <?php |
| [245](#L245) | /\* |
| [246](#L246) | <h3 class='hndle' style='padding-top:10px;padding-bottom:10px;'><span> |
| [247](#L247) | <?php |
| [248](#L248) | echo  \_\_( 'Option Panel:', 'bp-members-only' ); |
| [249](#L249) | ?> |
| [250](#L250) | </span> |
| [251](#L251) | </h3> |
| [252](#L252) | \*/ |
| [253](#L253) | ?> |
| [254](#L254) | <div class="inside" style='padding-left:10px;'> |
| [255](#L255) | <form id="bpmoform" name="bpmoform" action="" method="POST"> |
| [256](#L256) | <?php |
| [257](#L257) | // 1.8.3 |
| [258](#L258) | wp\_nonce\_field('bpmo\_tomas\_bp\_members\_only\_nonce'); |
| [259](#L259) | ?> |
| [260](#L260) | <table id="bpmotable" width="100%"> |
| [261](#L261) | <tr> |
| [262](#L262) | <td width="100%" style="padding: 0px 20px;"> |
| [263](#L263) | <p> |
| [264](#L264) | <?php echo  \_\_( '<h3>Register Page URL:</h3>', 'bp-members-only' ); ?> |
| [265](#L265) | </p> |
| [266](#L266) | <input type="text" id="bpmoregisterpageurl" name="bpmoregisterpageurl"  style="width:500px;" size="70" value="<?php  echo esc\_url($saved\_register\_page\_url); ?>"> |
| [267](#L267) | <?php |
| [268](#L268) | //3.2.3 |
| [269](#L269) | /\* |
| [270](#L270) | <input type="text" id="bpmoregisterpageurl" name="bpmoregisterpageurl"  style="width:500px;" size="70" value="<?php  echo $saved\_register\_page\_url; ?>"> |
| [271](#L271) | \*/ |
| [272](#L272) | ?> |
| [273](#L273) | <p> |
| [274](#L274) | <font color="Gray"><i><?php echo  \_\_( '# When non-member users view your buddypress pages, they will be redirected to this page, you can input the URL of your register page, or login page.', 'bp-members-only' ); ?></i></font> |
| [275](#L275) | </p> |
| [276](#L276) | <p> |
| [277](#L277) | <font color="Gray"><i><?php echo  \_\_( '# Also you can input URL of other pages, for example, landing page or product page, please ensure checked "Only Protect My Buddypress Page" option at below.', 'bp-members-only' ); ?></i></font> |
| [278](#L278) | </p> |
| [279](#L279) | <p> |
| [280](#L280) | <?php |
| [281](#L281) | $knowledgebasemenuurl = get\_option('siteurl') . '/wp-admin/admin.php?page=membersonlyfaq'; |
| [282](#L282) | ?> |
| [283](#L283) | <font color="Gray"><i><?php echo  \_\_( '# By default, your buddypress site will restricts to non-members users, but you can open specific pages or open all non-buddypress pages to users, please click "<a href="'.esc\_url($knowledgebasemenuurl).'" target="\_blank">knowledge Base</a>" menu item to understand how to use this plugin, thanks.', 'bp-members-only' ); ?></i></font> |
| [284](#L284) | <?php |
| [285](#L285) | //3.2.3 |
| [286](#L286) | /\* |
| [287](#L287) | <font color="Gray"><i><?php echo  \_\_( '# By default, your buddypress site will restricts to non-members users, but you can open specific pages or open all non-buddypress pages to users, please click "<a href="'.$knowledgebasemenuurl.'" target="\_blank">knowledge Base</a>" menu item to understand how to use this plugin, thanks.', 'bp-members-only' ); ?></i></font> |
| [288](#L288) | \*/ |
| [289](#L289) | ?> |
| [290](#L290) | </p> |
| [291](#L291) | <p> |
| [292](#L292) | <font color="Gray"><i> |
| [293](#L293) | <?php echo  \_\_( '# Any question, suggestion or feature request, just submit a <a href="https://membersonly.top/contact-us/" target="\_blank">support ticket</a>, we are very happy to help you, thanks.', 'bp-members-only' ); ?> |
| [294](#L294) | </i></font> |
| [295](#L295) | </p> |
| [296](#L296) | </td> |
| [297](#L297) | </tr> |
| [298](#L298) |  |
| [299](#L299) | <tr style="margin-top:30px;"> |
| [300](#L300) | <td width="100%" style="padding: 20px;"> |
| [301](#L301) | <p> |
| [302](#L302) | <?php echo  \_\_( '<h3>Opened Page URLs:</h3>', 'bp-members-only' ); ?> |
| [303](#L303) | </p> |
| [304](#L304) | <?php |
| [305](#L305) | $urlsarray = get\_option('saved\_open\_page\_url'); |
| [306](#L306) | ?> |
| [307](#L307) | <textarea name="bpopenedpageurl" id="bpopenedpageurl" cols="70" rows="10" style="width:500px;"><?php echo esc\_textarea($urlsarray); ?></textarea> |
| [308](#L308) | <?php |
| [309](#L309) | /\* |
| [310](#L310) | <textarea name="bpopenedpageurl" id="bpopenedpageurl" cols="70" rows="10" style="width:500px;"><?php echo $urlsarray; ?></textarea> |
| [311](#L311) | \*/ |
| [312](#L312) | ?> |
| [313](#L313) | <p><font color="Gray"><i><?php echo  \_\_( 'Enter one URL per line please.', 'bp-members-only' ); ?></i></p> |
| [314](#L314) | <p><font color="Gray"><i><?php echo  \_\_( 'These pages will opened for guest and guest will not be directed to register page.', 'bp-members-only' ); ?></i></p> |
| [315](#L315) | </td> |
| [316](#L316) | </tr> |
| [317](#L317) |  |
| [318](#L318) | <tr style="margin-top:30px;"> |
| [319](#L319) | <td width="100%" style="padding: 20px;"> |
| [320](#L320) | <p> |
| [321](#L321) | <?php echo  \_\_( '<h3>Redirect Logged in Users to:</h3>', 'bp-members-only' ); ?> |
| [322](#L322) | </p> |
| [323](#L323) | <?php |
| [324](#L324) | $bpmemonlyredirectbppagesafterloginoption = get\_option($bpmemonlyredirectbppagesafterlogin); |
| [325](#L325) | ?> |
| [326](#L326) | <input type="checkbox"  id="<?php echo esc\_attr($bpmemonlyredirecttypeafterlogin); ?>" name="<?php echo esc\_attr($bpmemonlyredirecttypeafterlogin); ?>" value="bppages" <?php checked( 'bppages', $bpmemonlyredirecttypeafterloginoption ); ?> /> |
| [327](#L327) | <?php |
| [328](#L328) | //3.2.3 |
| [329](#L329) | /\* |
| [330](#L330) | <input type="checkbox"  id="<?php echo $bpmemonlyredirecttypeafterlogin; ?>" name="<?php echo $bpmemonlyredirecttypeafterlogin; ?>" value="bppages" <?php checked( 'bppages', $bpmemonlyredirecttypeafterloginoption ); ?> /> |
| [331](#L331) | <select name="<?php echo $bpmemonlyredirectbppagesafterlogin; ?>" id="<?php echo $bpmemonlyredirectbppagesafterlogin; ?>"> |
| [332](#L332) | <option value="bpprofile" <?php selected( $bpmemonlyredirectbppagesafterloginoption, 'bpprofile' ); ?>><?php echo 'BuddyPress Personal Profile Page' ?></option> |
| [333](#L333) | <option value="bpmembers" <?php selected( $bpmemonlyredirectbppagesafterloginoption, 'bpmembers' ); ?>><?php echo 'BuddyPress Members Page' ?></option> |
| [334](#L334) | <option value="bpuseractivity" <?php selected( $bpmemonlyredirectbppagesafterloginoption, 'bpuseractivity' ); ?>><?php echo 'BuddyPress Personal Activity Page' ?></option> |
| [335](#L335) | </select> |
| [336](#L336) |  |
| [337](#L337) | \*/ |
| [338](#L338) | ?> |
| [339](#L339) | <select name="<?php echo esc\_attr($bpmemonlyredirectbppagesafterlogin); ?>" id="<?php echo esc\_attr($bpmemonlyredirectbppagesafterlogin); ?>"> |
| [340](#L340) | <option value="bpprofile" <?php selected( esc\_attr($bpmemonlyredirectbppagesafterloginoption), 'bpprofile' ); ?>><?php echo 'BuddyPress Personal Profile Page' ?></option> |
| [341](#L341) | <option value="bpmembers" <?php selected( esc\_attr($bpmemonlyredirectbppagesafterloginoption), 'bpmembers' ); ?>><?php echo 'BuddyPress Members Page' ?></option> |
| [342](#L342) | <option value="bpuseractivity" <?php selected( esc\_attr($bpmemonlyredirectbppagesafterloginoption), 'bpuseractivity' ); ?>><?php echo 'BuddyPress Personal Activity Page' ?></option> |
| [343](#L343) | </select> |
| [344](#L344) |  |
| [345](#L345) | <p><font color="Gray"><i><?php echo  \_\_( 'You can setting redirect logged in users to buddypress profile page or buddypress members page.', 'bp-members-only' ); ?></i></p> |
| [346](#L346) | <p><font color="Gray"><i><?php echo  \_\_( 'If you did not install buddypress, this option will be ignored.', 'bp-members-only' ); ?></i></p> |
| [347](#L347) | </td> |
| [348](#L348) | </tr> |
| [349](#L349) | <tr style="margin-top:30px;"> |
| [350](#L350) | <td width="100%" style="padding: 20px;"> |
| [351](#L351) | <p> |
| [352](#L352) | <?php echo \_\_ ( '<h3>Only Protect My Buddypress Pages:</h3>', 'bp-members-only' ); ?> |
| [353](#L353) | </p> |
| [354](#L354) | <p> |
| [355](#L355) | <?php |
| [356](#L356) | $bprestrictsbuddypresssection = get\_option ( 'bprestrictsbuddypresssection' ); |
| [357](#L357) | if (! (empty ( $bprestrictsbuddypresssection ))) { |
| [358](#L358) | echo '<input type="checkbox" id="bprestrictsbuddypresssection" name="bprestrictsbuddypresssection"  style="" value="yes"  checked="checked"> All Other Sections On Your Site Will be Opened to Guest '; |
| [359](#L359) | } else { |
| [360](#L360) | echo '<input type="checkbox" id="bprestrictsbuddypresssection" name="bprestrictsbuddypresssection"  style="" value="yes" > All Other Sections On Your Site Will be Opened to Guest '; |
| [361](#L361) | } |
| [362](#L362) | ?> |
| [363](#L363) | </p> |
| [364](#L364) | <p> |
| [365](#L365) | <font color="Gray"><i> |
| [366](#L366) | <?php |
| [367](#L367) | echo \_\_ ( '# If you disabled this option, our plugin will protect all of your wordpress posts to non-member users, only home page / login / register / lost password page will be opened to guest.', 'bp-members-only' ); |
| [368](#L368) | ?></i> |
| [369](#L369) |  |
| [370](#L370) | </p> |
| [371](#L371) | <p> |
| [372](#L372) | <font color="Gray"><i> |
| [373](#L373) | <?php |
| [374](#L374) | echo \_\_ ( '# If you enabled this option, "opened Page URLs" setting in ', 'bp-members-only' ); |
| [375](#L375) | echo "<a  style='color:#4e8c9e;' href='" . get\_option ( 'siteurl' ) . "/wp-admin/admin.php?page=bpmemberonly' target='\_blank'>Opened Pages Panel</a>"; |
| [376](#L376) | echo \_\_ ( ' will be ignored', 'bp-members-only' ); |
| [377](#L377) | ?></i> |
| [378](#L378) |  |
| [379](#L379) | </p> |
| [380](#L380) | <p> |
| [381](#L381) | <font color="Gray"><i> |
| [382](#L382) | <?php |
| [383](#L383) | echo \_\_ ( '# All buddypress pages will be protected yet', 'bp-members-only' ); |
| [384](#L384) | ?> |
| [385](#L385) |  |
| [386](#L386) | </i> |
| [387](#L387) |  |
| [388](#L388) | </p> |
| [389](#L389) | </td> |
| [390](#L390) | </tr> |
| [391](#L391) |  |
| [392](#L392) | <tr style="margin-top:30px;"> |
| [393](#L393) | <td width="100%" style="padding: 20px;"> |
| [394](#L394) | <p> |
| [395](#L395) | <?php |
| [396](#L396) | echo  \_\_( '<h3>Temporarily Turn Off All Featrures:</h3>', 'bp-members-only' ); |
| [397](#L397) | ?> |
| [398](#L398) | </p> |
| [399](#L399) | <p> |
| [400](#L400) | <?php |
| [401](#L401) | $bpdisableallfeature = get\_option('bpdisableallfeature'); |
| [402](#L402) | if (!(empty($bpdisableallfeature))) |
| [403](#L403) | { |
| [404](#L404) | echo '<input type="checkbox" id="bpdisableallfeature" name="bpdisableallfeature"  style="" value="yes"  checked="checked"> Temporarily Turn Off All Featrures Of BuddyPress Members Only '; |
| [405](#L405) |  |
| [406](#L406) | } |
| [407](#L407) | else |
| [408](#L408) | { |
| [409](#L409) | echo '<input type="checkbox" id="bpdisableallfeature" name="bpdisableallfeature"  style="" value="yes" > Temporarily Turn Off All Featrures Of BuddyPress Members Only '; |
| [410](#L410) | } |
| [411](#L411) | ?> |
| [412](#L412) | </p> |
| [413](#L413) | <p><font color="Gray"><i> |
| [414](#L414) | <?php |
| [415](#L415) | echo  \_\_( '# If you enabled this option, all features of buddypress members only will be disabled, you site will open to all users', 'bp-members-only') ; |
| [416](#L416) | ?></i></p> |
| [417](#L417) | </td> |
| [418](#L418) | </tr> |
| [419](#L419) | <tr style="margin-top:30px;"> |
| [420](#L420) | <td width="100%" style="padding: 20px;"> |
| [421](#L421) | <p> |
| [422](#L422) | <?php |
| [423](#L423) | echo \_\_ ( '<h3>Enable Page Level Protect:</h3>', 'bp-members-only' ); |
| [424](#L424) | ?> |
| [425](#L425) | </p> |
| [426](#L426) | <p> |
| [427](#L427) | <?php |
| [428](#L428) | $bpenablepagelevelprotect = get\_option ( 'bpenablepagelevelprotect' ); |
| [429](#L429) | if (! (empty ( $bpenablepagelevelprotect ))) { |
| [430](#L430) | } else { |
| [431](#L431) | $bpenablepagelevelprotect = ''; |
| [432](#L432) | } |
| [433](#L433) | ?> |
| [434](#L434) | <?php |
| [435](#L435) | if (! (empty ( $bpenablepagelevelprotect ))) { |
| [436](#L436) | echo '<input type="checkbox" id="bpenablepagelevelprotect" name="bpenablepagelevelprotect"  style="" value="yes"  checked="checked"> Enable Page Level Protect Settings '; |
| [437](#L437) | } else { |
| [438](#L438) | echo '<input type="checkbox" id="bpenablepagelevelprotect" name="bpenablepagelevelprotect"  style="" value="yes" > Enable Page Level Protect Settings '; |
| [439](#L439) | } |
| [440](#L440) | ?> |
| [441](#L441) |  |
| [442](#L442) | <p> |
| [443](#L443) | <font color="Gray"><i> |
| [444](#L444) | <?php |
| [445](#L445) | echo \_\_ ( '# If you enabled this option,  in ', 'bp-members-only' ); |
| [446](#L446) | echo "<a style='color:#4e8c9e;' href='" . get\_option ( 'siteurl' ) . "/wp-admin/post-new.php' target='\_blank'>page / post  editor</a>"; |
| [447](#L447) | echo \_\_ ( ', you will find "Members only for this page?" meta box at the right top of the wordpress standard editor.', 'bp-members-only in ' ); |
| [448](#L448) | ?> |
| [449](#L449) | </i> |
| [450](#L450) |  |
| [451](#L451) | </p> |
| [452](#L452) | <p> |
| [453](#L453) | <font color="Gray"><i><?php echo  \_\_( '# If you checked "Allow everyone to access the page" checkbox in meta box, the post will be opened to all guest users', 'bp-members-only' ); ?></i> |
| [454](#L454) |  |
| [455](#L455) | </p> |
| [456](#L456) | <p> |
| [457](#L457) | <font color="Gray"><i> |
| [458](#L458) | <?php |
| [459](#L459) | echo \_\_ ( '# By this way, you do not need enter page URLs to ', 'bp-members-only' ); |
| [460](#L460) | echo "<a  style='color:#4e8c9e;' href='" . get\_option ( 'siteurl' ) . "/wp-admin/admin.php?page=bpmemberonly' target='\_blank'>Opened Pages Panel</a>"; |
| [461](#L461) | echo \_\_ ( ' always.', 'bp-members-only' ); |
| [462](#L462) |  |
| [463](#L463) | ?></i> |
| [464](#L464) | </p> |
| [465](#L465) | </td> |
| [466](#L466) | </tr> |
| [467](#L467) | <?php //!!!start ?> |
| [468](#L468) | <tr style="margin-top:30px;"> |
| [469](#L469) | <td width="100%" style="padding: 20px;"> |
| [470](#L470) | <p> |
| [471](#L471) | <?php |
| [472](#L472) | echo \_\_ ( '<h3>Custom / Hide WordPress Login Link:</h3>', 'bp-members-only' ); |
| [473](#L473) | ?> |
| [474](#L474) | </p> |
| [475](#L475) | <p> |
| [476](#L476) | <?php |
| [477](#L477) | $tomas\_bbp\_member\_only\_free\_custom\_links\_login = get\_option('tomas\_bbp\_member\_only\_free\_custom\_links\_login'); |
| [478](#L478) | ?> |
| [479](#L479) | <span><font color='gray'><?php echo get\_option('siteurl').'/'; ?></font></span> <input type="text" id="tomas\_bbp\_member\_only\_free\_custom\_links\_login" name="tomas\_bbp\_member\_only\_free\_custom\_links\_login" size='10' value="<?php  echo esc\_attr($tomas\_bbp\_member\_only\_free\_custom\_links\_login); ?>"> <font color='gray'>/</font> |
| [480](#L480) | </p> |
| [481](#L481) | <p> |
| [482](#L482) | <font color="Gray"><i> |
| [483](#L483) | <?php |
| [484](#L484) | echo \_\_ ( '# Why custom login link? A few users said they hope change wordpress login link for their private network, for stop spam bot', 'bp-members-only' ); |
| [485](#L485) | echo '<p>'; |
| [486](#L486) | echo \_\_ ( '# By default, wordpress login link is https://yourdomain.com/wp-login.php, but you can custom it as https://yourdomain.com/signin, and so on', 'bp-members-only' ); |
| [487](#L487) | echo '</p>'; |
| [488](#L488) | echo '<p>'; |
| [489](#L489) | echo \_\_ ( '# If you do not want to custom wordpress login link, just delete your value in this filed', 'bp-members-only' ); |
| [490](#L490) | echo '</p>'; |
| [491](#L491) | ?> |
| [492](#L492) | </i> |
| [493](#L493) | </p> |
| [494](#L494) | </td> |
| [495](#L495) | </tr> |
| [496](#L496) | <?php //!!!end ?> |
| [497](#L497) | <?php // !!! 3.4.9 start ?> |
| [498](#L498) | <tr style="margin-top:30px;"> |
| [499](#L499) | <td width="100%" style="padding: 20px;"> |
| [500](#L500) | <p> |
| [501](#L501) | <?php echo \_\_ ( '<h3>Disable REST API:</h3>', 'bp-members-only' ); ?> |
| [502](#L502) | </p> |
| [503](#L503) | <p> |
| [504](#L504) | <?php |
| [505](#L505) | $bprestrictrestapi = get\_option ( 'bprestrictrestapi' ); |
| [506](#L506) | if (! (empty ( $bprestrictrestapi ))) { |
| [507](#L507) | echo '<input type="checkbox" id="bprestrictrestapi" name="bprestrictrestapi"  style="" value="yes"  checked="checked"> Disable REST API '; |
| [508](#L508) | } else { |
| [509](#L509) | echo '<input type="checkbox" id="bprestrictrestapi" name="bprestrictrestapi"  style="" value="yes" > Disable REST API '; |
| [510](#L510) | } |
| [511](#L511) | ?> |
| [512](#L512) | </p> |
| [513](#L513) | <p> |
| [514](#L514) | <font color="Gray"><i> |
| [515](#L515) | <?php |
| [516](#L516) | echo \_\_ ( '# If you enable this option, the plugin will disable the REST API to enhance wordpress security', 'bp-members-only' ); |
| [517](#L517) | ?></i> |
| [518](#L518) |  |
| [519](#L519) | </p> |
| [520](#L520) | </td> |
| [521](#L521) | </tr> |
| [522](#L522) |  |
| [523](#L523) | <?php //end 3.4.9 ?> |
| [524](#L524) | </table> |
| [525](#L525) | <br /> |
| [526](#L526) | <input type="submit" id="bpmosubmitnew" name="bpmosubmitnew" value=" Submit " style="margin:1px 20px;"> |
| [527](#L527) | </form> |
| [528](#L528) |  |
| [529](#L529) | <br /> |
| [530](#L530) | </div> |
| [531](#L531) | </div> |
| [532](#L532) | <div> |
| [533](#L533) | <a class="" style="font-size:16px;vertical-align: super;color: #999;" target="\_blank" href="https://paypal.me/sunpayment"> |
| [534](#L534) | <span> |
| [535](#L535) | Buy me a coffee? |
| [536](#L536) | </span> |
| [537](#L537) | </a> |
| [538](#L538) | </div> |
| [539](#L539) | </div> |
| [540](#L540) | </div> |
| [541](#L541) | </div> |
| [542](#L542) | <?php if (function\_exists('is\_rtl')) |
| [543](#L543) | { |
| [544](#L544) | //better rtl support |
| [545](#L545) | if (is\_rtl()) |
| [546](#L546) | { |
| [547](#L547) | echo '<div id="post-body"  style="width:40%; float:left;">'; |
| [548](#L548) | } |
| [549](#L549) | else |
| [550](#L550) | { |
| [551](#L551) | echo '<div id="post-body"  style="width:40%; float:right;">'; |
| [552](#L552) | } |
| [553](#L553) | } |
| [554](#L554) | else |
| [555](#L555) | { |
| [556](#L556) | echo '<div id="post-body"  style="width:40%; float:right;">'; |
| [557](#L557) | } |
| [558](#L558) | ?> |
| [559](#L559) |  |
| [560](#L560) | <?php |
| [561](#L561) | /\* |
| [562](#L562) | \* no rtl |
| [563](#L563) | <div id="post-body"  style="width:40%; float:right;"> |
| [564](#L564) | \*/ |
| [565](#L565) | //!!! 3.5.1 |
| [566](#L566) | ?> |
| [567](#L567) | <div id="dashboard-widgets-main-content"> |
| [568](#L568) | <div class="postbox-container" style="width:90%;"> |
| [569](#L569) |  |
| [570](#L570) | <div class="postbox"> |
| [571](#L571) | <h3 class='hndle' style='padding: 20px 0px; !important'> |
| [572](#L572) | <span> |
| [573](#L573) | <?php |
| [574](#L574) | echo  \_\_( '<h3>Notice</H3>', 'bp-members-only' ); |
| [575](#L575) | ?> |
| [576](#L576) | </span> |
| [577](#L577) | </h3> |
| [578](#L578) |  |
| [579](#L579) | <div class="inside" style='padding-left:10px;'> |
| [580](#L580) | <div class="inside"> |
| [581](#L581) | <ul> |
| [582](#L582) | <li> |
| [583](#L583) | \* You can also download the latest Buddypress Members Only plugin for free from our <a href='https://membersonly.top/product/buddypress-members-only-free/'  target='\_blank'>official download link</a> at any time. |
| [584](#L584) | </li> |
| [585](#L585) | </div> |
| [586](#L586) |  |
| [587](#L587) | </div> |
| [588](#L588) | </div> |
| [589](#L589) |  |
| [590](#L590) |  |
| [591](#L591) | <div class="postbox"> |
| [592](#L592) | <h3 class='hndle' style='padding: 10px 0px; !important'> |
| [593](#L593) | <span> |
| [594](#L594) | <a class="" style="font-size:28px;" target="\_blank" href="https://membersonly.top/features/">Members Only Pro Features</a> |
| [595](#L595) | </span> |
| [596](#L596) | </h3> |
| [597](#L597) |  |
| [598](#L598) | <div class="inside" style='padding-left:10px;'> |
| [599](#L599) | <div class="inside"> |
| [600](#L600) | <ul> |
| [601](#L601) | <li> |
| [602](#L602) | \* All functions in free version |
| [603](#L603) | </li> |
| [604](#L604) | <li> |
| [605](#L605) | \* Fine-grained access control for buddypress site, you can restrict each buddypress componets based on user roles, one click to build user roles for BP members automatically, control each user role's profile visibility, each menu visibility based on user roles, restricts BP messages based on user roles, opt to restricts each wordpress pages(even home page), opt to restrict site RSS feed, opt to restricts specific BuddyPress Component Pages from search engines, opt to only allow approved members login your buddypress private network, you can decide which section of your BP / WP site will be opened / closed to specific user roles... <b>more feature can be found at: <a class="" target="\_blank" href="https://membersonly.top/features/">https://membersonly.top/features/</a></b> |
| [606](#L606) | </li> |
| [607](#L607) | <li> |
| [608](#L608) | \* Super easy to use, just a few clicks, build a membership buddypress network or build a privacy site quickly, with detailed guide. |
| [609](#L609) | </li> |
| [610](#L610) | <li> |
| [611](#L611) | \* <a href='https://membersonly.top/features/' target='\_blank'>Restricts BP standard components / customization components to users based on user roles</a>, for example, you can disable BP components pages to guest, open members component page to subscriber user roles, open profile component page to paid user roles only… |
| [612](#L612) | </li> |
| [613](#L613) | <li> |
| [614](#L614) | \* <a href='https://membersonly.top/buddypress-menu-visibility-by-user-roles-demo/' target='\_blank'>Menu Visibility Control by User Roles</a>, for example, you can only allow customer user role to see download menu, subscriber & customer user role can see product menu... and so on, so you do not need make a long menu lists to all users |
| [615](#L615) | </li> |
| [616](#L616) | <li> |
| [617](#L617) | \* <a href='https://membersonly.top/buddypress-membership-plugin-4-0-2-released-buddypress-profile-field-visibility-control-by-user-roles-addon-support-hide-buddypress-profile-fields/' target='\_blank'>Members profile field visibility control by user roles</a>, for example, you can settings to only paid members can show their profile fileds publicly, and profile fields of subscriber user role will be hidden... and so on |
| [618](#L618) | </li> |
| [619](#L619) | <li> |
| [620](#L620) | \* One click to add / remove 10 buddypress membership Levels, edit name of default membership levels, for example: Bronze, Silver, Gold… and so on |
| [621](#L621) | </li> |
| [622](#L622) | <li> |
| [623](#L623) | \* Just a simple clicks to charge membership fee via membership levels with [BuddyPress Membership WooCmmerce Payment Gateway Plugin](<a href='https://membersonly.top/features-of-buddypress-woocommerce-payment-gateway-plugin/' target='\_blank'>https://membersonly.top/features-of-buddypress-woocommerce-payment-gateway-plugin/</a>) |
| [624](#L624) | </li> |
| [625](#L625) | <li> |
| [626](#L626) | \* Approved Users Only, after enabled this option, when users register as members, they need awaiting administrator approve their account manually, only approved users can login your site, Admin user can approve or unapprove any users again at anytime. |
| [627](#L627) | </li> |
| [628](#L628) | <li> |
| [629](#L629) | \* Powerful Login redirect / Logout Redirect Based on \*\*User Roles\*\*: pro version will support more login / logout redirect options,  each user roles have options for redirect to the referer pages before they login, also support 12 buddypress components to redirect login / logout users, and support to redirect to any specific url based on your setup for each user roles... and so on |
| [630](#L630) | </li> |
| [631](#L631) | <li> |
| [632](#L632) | \* Customized Opened URLs Restricts based on user roles, For example, you can settings https://yourdomain.com/members/%username%/forums/ only opened for paid users, or open %sitename%/family/%username%/ for family user types… and so on. |
| [633](#L633) | </li> |
| [634](#L634) | <li> |
| [635](#L635) | \* Customized Closed URLs Restricts based on user roles, for example, you can close https://yourdomain.com/support page to guest users, and only open it for customer user roles, at the same time, you can open https://yourdomain.com/shop for guest user role, support use placeholders %username% and %sitename% to protect your customized Closed URLs pages |
| [636](#L636) | </li> |
| [637](#L637) | <li> |
| [638](#L638) | \* If you disable buddypress, our plugins will detect it automatically and continue to protect your wordpress pages. |
| [639](#L639) | </li> |
| [640](#L640) | <li> |
| [641](#L641) | \* Support Add Announcement on Buddypress Members Only register page, you can add announcement in editor with image, link, font style, videos… and so on, we will show announcement at top of register page. |
| [642](#L642) | </li> |
| [643](#L643) | <li> |
| [644](#L644) | \* …… more and more |
| [645](#L645) | </li> |
| [646](#L646) | <li> |
| [647](#L647) | <b>more feature can be found at: <a class="" target="\_blank" href="https://membersonly.top/features/">https://membersonly.top/features/</a></b> |
| [648](#L648) | </li> |
| [649](#L649) | </div> |
| [650](#L650) | </div> |
| [651](#L651) | </div> |
| [652](#L652) |  |
| [653](#L653) | <div class="postbox"> |
| [654](#L654) | <h3 class='hndle' style='padding: 20px 0px; !important'> |
| [655](#L655) | <span> |
| [656](#L656) | <?php |
| [657](#L657) | echo  \_\_( 'More BuddyPress Plugins Maybe You Will Like', 'bp-members-only' ); |
| [658](#L658) | ?> |
| [659](#L659) | </span> |
| [660](#L660) | </h3> |
| [661](#L661) |  |
| [662](#L662) | <div class="inside" style='padding-left:10px;'> |
| [663](#L663) | <div class="inside"> |
| [664](#L664) | <ul> |
| [665](#L665) | <li> |
| [666](#L666) | \* <a class="" target="\_blank" href="https://membersonly.top/features-of-buddypress-woocommerce-payment-gateway-plugin/">BuddyPress WooCommerce Payment Plugin</a> |
| [667](#L667) | </li> |
| [668](#L668) | <li> |
| [669](#L669) | \* <a class=""  target="\_blank" href="https://membersonly.top/features-of-buddypress-blacklist-whitelist-security-plugin/">BuddyPress Blacklist Plugin</a> |
| [670](#L670) | </li> |
| [671](#L671) | <li> |
| [672](#L672) | \* <a class=""  target="\_blank" href="https://membersonly.top/features-of-buddypress-google-xml-sitemaps-generator-plugin/">BuddyPress Google XML Sitemaps Generator Plugin</a> |
| [673](#L673) | </li> |
| [674](#L674) | </div> |
| [675](#L675) |  |
| [676](#L676) | </div> |
| [677](#L677) | </div> |
| [678](#L678) |  |
| [679](#L679) | <div class="postbox"> |
| [680](#L680) | <h3 class='hndle' style='padding: 20px 0px; !important'> |
| [681](#L681) | <span> |
| [682](#L682) | <?php |
| [683](#L683) | echo  \_\_( 'About This Plugin', 'bp-members-only' ); |
| [684](#L684) | ?> |
| [685](#L685) | </span> |
| [686](#L686) | </h3> |
| [687](#L687) |  |
| [688](#L688) | <div class="inside" style='padding-left:10px;'> |
| [689](#L689) | <div class="inside"> |
| [690](#L690) | <ul> |
| [691](#L691) | <li> |
| [692](#L692) | \* <a class="" target="\_blank" href="https://membersonly.top/features/">Plugin Homepage, Help / FAQ</a> |
| [693](#L693) | </li> |
| [694](#L694) | <li> |
| [695](#L695) | \* <a class=""  target="\_blank" href="https://membersonly.top/contact-us/">Support, Suggest a Feature, Report a Bug? Need Customize Plugin?</a> |
| [696](#L696) | </li> |
| [697](#L697) | <li> |
| [698](#L698) | \* <a class=""  target="\_blank" href="https://tomas.zhu.bz/category/my-share/">Sign UP for Free BuddyPress / WordPress Tips MailChimp List</a> |
| [699](#L699) | </li> |
| [700](#L700) | </div> |
| [701](#L701) |  |
| [702](#L702) | </div> |
| [703](#L703) | </div> |
| [704](#L704) |  |
| [705](#L705) |  |
| [706](#L706) | <div class="postbox"> |
| [707](#L707) | <h3 class='hndle' style='padding: 20px 0px; !important'> |
| [708](#L708) | <span> |
| [709](#L709) | <?php |
| [710](#L710) | echo  \_\_( 'BuddyPress Wordpress Tips Feed:', 'bp-members-only' ); |
| [711](#L711) | ?> |
| [712](#L712) | </span> |
| [713](#L713) | </h3> |
| [714](#L714) |  |
| [715](#L715) | <div class="inside" style='padding-left:10px;'> |
| [716](#L716) | <?php |
| [717](#L717) | wp\_widget\_rss\_output('https://membersonly.top/feed/', array( |
| [718](#L718) | 'items' => 3, |
| [719](#L719) | 'show\_summary' => 0, |
| [720](#L720) | 'show\_author' => 0, |
| [721](#L721) | 'show\_date' => 1) |
| [722](#L722) | ); |
| [723](#L723) | ?> |
| [724](#L724) | <br /> |
| [725](#L725) | </div> |
| [726](#L726) | </div> |
| [727](#L727) | </div> |
| [728](#L728) | </div> |
| [729](#L729) |  |
| [730](#L730) | </div> |
| [731](#L731) | <div style='clear:both'></div> |
| [732](#L732) | </div> |
| [733](#L733) | </div> |
| [734](#L734) | </div> |
| [735](#L735) | <div style="clear:both"></div> |
| [736](#L736) | <br /> |
| [737](#L737) |  |
| [738](#L738) |  |
| [739](#L739) |  |
| [740](#L740) | <?php |
| [741](#L741) | } |
| [742](#L742) |  |
| [743](#L743) |  |
| [744](#L744) | function buddypress\_members\_only\_message($p\_message) |
| [745](#L745) | { |
| [746](#L746) |  |
| [747](#L747) | echo "<div id='message' class='updated fade' style='line-height: 30px;margin-left: 0px;'>"; |
| [748](#L748) |  |
| [749](#L749) | echo $p\_message; |
| [750](#L750) |  |
| [751](#L751) | echo "</div>"; |
| [752](#L752) |  |
| [753](#L753) | } |
| [754](#L754) |  |
| [755](#L755) | function buddypress\_only\_for\_members() |
| [756](#L756) | { |
| [757](#L757) | global $user\_ID , $post; |
| [758](#L758) | if (is\_front\_page()) return; |
| [759](#L759) | if (function\_exists('bp\_is\_register\_page') && function\_exists('bp\_is\_activation\_page') ) |
| [760](#L760) | { |
| [761](#L761) | if ( bp\_is\_register\_page() || bp\_is\_activation\_page() ) |
| [762](#L762) | { |
| [763](#L763) | return; |
| [764](#L764) | } |
| [765](#L765) | } |
| [766](#L766) |  |
| [767](#L767) | //3.2.3 |
| [768](#L768) | $current\_url = sanitize\_text\_field($\_SERVER['HTTP\_HOST'].$\_SERVER['REQUEST\_URI']); |
| [769](#L769) | //$current\_url = $\_SERVER['HTTP\_HOST'].$\_SERVER['REQUEST\_URI']; |
| [770](#L770) |  |
| [771](#L771) | $current\_url = str\_ireplace('http://','',$current\_url); |
| [772](#L772) | $current\_url = str\_ireplace('https://','',$current\_url); |
| [773](#L773) | $current\_url = str\_ireplace('ws://','',$current\_url); |
| [774](#L774) | $current\_url = str\_ireplace('www.','',$current\_url); |
| [775](#L775) | $saved\_register\_page\_url = get\_option('bpmoregisterpageurl'); |
| [776](#L776) |  |
| [777](#L777) | $saved\_register\_page\_url = str\_ireplace('http://','',$saved\_register\_page\_url); |
| [778](#L778) | $saved\_register\_page\_url = str\_ireplace('https://','',$saved\_register\_page\_url); |
| [779](#L779) | $saved\_register\_page\_url = str\_ireplace('ws://','',$saved\_register\_page\_url); |
| [780](#L780) | $saved\_register\_page\_url = str\_ireplace('www.','',$saved\_register\_page\_url); |
| [781](#L781) |  |
| [782](#L782) | //!!!start |
| [783](#L783) | $current\_page\_id = get\_the\_ID (); |
| [784](#L784) | $bpenablepagelevelprotect = get\_option ( 'bpenablepagelevelprotect' ); |
| [785](#L785) | if (! (empty ( $bpenablepagelevelprotect ))) |
| [786](#L786) | { |
| [787](#L787) | $get\_post\_meta\_value\_for\_this\_page = get\_post\_meta ( $current\_page\_id, 'bp\_members\_only\_access\_to\_this\_page', true ); |
| [788](#L788) | if (strtolower ( $get\_post\_meta\_value\_for\_this\_page ) == 'yes') |
| [789](#L789) | { |
| [790](#L790) | return; |
| [791](#L791) | } |
| [792](#L792) | } |
| [793](#L793) | //!!!end |
| [794](#L794) |  |
| [795](#L795) | //!!!start restrict post type |
| [796](#L796) | $bp\_in\_post\_type\_have\_access = false; |
| [797](#L797) | if (isset($post->ID)) |
| [798](#L798) | { |
| [799](#L799) | $bpmp\_post\_type = $post->post\_type; |
| [800](#L800) |  |
| [801](#L801) | if (!(empty($bpmp\_post\_type))) |
| [802](#L802) | { |
| [803](#L803) | if (is\_user\_logged\_in () == false) |
| [804](#L804) | { |
| [805](#L805) | $bpmemonlypro\_enabled\_post\_type = get\_option("bpmemonlypro\_enabled\_post\_type"); |
| [806](#L806) | if ((! (empty ( $bpmemonlypro\_enabled\_post\_type ))) && (is\_array ( $bpmemonlypro\_enabled\_post\_type )) && (count ( $bpmemonlypro\_enabled\_post\_type ) > 0) && (in\_array ( $bpmp\_post\_type, $bpmemonlypro\_enabled\_post\_type ))) |
| [807](#L807) | { |
| [808](#L808) | return; |
| [809](#L809) | } |
| [810](#L810) | } |
| [811](#L811) | /\* |
| [812](#L812) | else |
| [813](#L813) | { |
| [814](#L814) | $user = wp\_get\_current\_user (); |
| [815](#L815) | if (empty ( $user->roles )) |
| [816](#L816) | { |
| [817](#L817) | if ((! (empty ( $bpmemonlypro\_enabled\_post\_type ))) && (is\_array ( $bpmemonlypro\_enabled\_post\_type )) && (count ( $bpmemonlypro\_enabled\_post\_type ) > 0) && (in\_array ( $bpmp\_post\_type, $bpmemonlypro\_enabled\_post\_type ))) |
| [818](#L818) | { |
| [819](#L819) | return; |
| [820](#L820) | } |
| [821](#L821) | } |
| [822](#L822) | else |
| [823](#L823) | { |
| [824](#L824) | foreach ( $tomas\_roles\_all\_array as $tomas\_roles\_single\_key => $tomas\_roles\_single\_array ) |
| [825](#L825) | { |
| [826](#L826) | $bp\_component\_role\_id = $tomas\_roles\_single\_key; |
| [827](#L827) |  |
| [828](#L828) | if (in\_array ( $bp\_component\_role\_id , $user->roles )) |
| [829](#L829) | { |
| [830](#L830) |  |
| [831](#L831) | } |
| [832](#L832) | else |
| [833](#L833) | { |
| [834](#L834) | continue; |
| [835](#L835) | } |
| [836](#L836) | $bp\_component\_role\_id = str\_replace ( ' ', '-', $tomas\_roles\_single\_key ); |
| [837](#L837) |  |
| [838](#L838) | $rolebasedstandardcomponent = 'bpmemonlypro\_enabled\_post\_type\_' . $bp\_component\_role\_id; |
| [839](#L839) |  |
| [840](#L840) | $rolebasedstandardcomponentoption = get\_option ( $rolebasedstandardcomponent ); |
| [841](#L841) |  |
| [842](#L842) |  |
| [843](#L843) | if (! (empty ( $rolebasedstandardcomponentoption ))) |
| [844](#L844) | { |
| [845](#L845) | foreach ( $rolebasedstandardcomponentoption as $rolebasedstandardcomponentoption\_single ) |
| [846](#L846) | { |
| [847](#L847) | if ($rolebasedstandardcomponentoption\_single == $bpmp\_post\_type) |
| [848](#L848) | { |
| [849](#L849) | return; |
| [850](#L850) | } |
| [851](#L851) | } |
| [852](#L852) | } |
| [853](#L853) | else |
| [854](#L854) | { |
| [855](#L855) | continue; |
| [856](#L856) | } |
| [857](#L857) | } |
| [858](#L858) | } |
| [859](#L859) | } |
| [860](#L860) | \*/ |
| [861](#L861) | } |
| [862](#L862) | } |
| [863](#L863) | //!!!end restrict post type end |
| [864](#L864) |  |
| [865](#L865) | $bprestrictsbuddypresssection = get\_option ( 'bprestrictsbuddypresssection' ); |
| [866](#L866) | $m\_bpstandardcomponent = get\_option ( 'bpstandardcomponent' ); // !!!3.0.5 |
| [867](#L867) |  |
| [868](#L868) | if (function\_exists ( 'bp\_current\_component' )) { |
| [869](#L869) | $is\_bp\_current\_component = bp\_current\_component (); |
| [870](#L870) | } else { |
| [871](#L871) | $is\_bp\_current\_component = ''; |
| [872](#L872) | } |
| [873](#L873) | $bp\_in\_componet\_have\_access = false; //!!! 3.0.5 |
| [874](#L874) |  |
| [875](#L875) | //!!!3.0.5 |
| [876](#L876) | if (is\_user\_logged\_in () == false) { |
| [877](#L877) | if ((! (empty ( $m\_bpstandardcomponent ))) && (is\_array ( $m\_bpstandardcomponent )) && (count ( $m\_bpstandardcomponent ) > 0) && (in\_array ( $is\_bp\_current\_component, $m\_bpstandardcomponent ))) |
| [878](#L878) | { |
| [879](#L879) | return; |
| [880](#L880) | } |
| [881](#L881) | } |
| [882](#L882) | //!!! end 3.0.5 |
| [883](#L883) |  |
| [884](#L884) | if (! (empty ( $bprestrictsbuddypresssection ))) { |
| [885](#L885) | if (empty ( $is\_bp\_current\_component )) { |
| [886](#L886) | return; |
| [887](#L887) | } |
| [888](#L888) | } |
| [889](#L889) |  |
| [890](#L890) |  |
| [891](#L891) | if (stripos($saved\_register\_page\_url, $current\_url) === false) |
| [892](#L892) | { |
| [893](#L893) |  |
| [894](#L894) | } |
| [895](#L895) | else |
| [896](#L896) | { |
| [897](#L897) | return; |
| [898](#L898) | } |
| [899](#L899) |  |
| [900](#L900) | // check is opened pages |
| [901](#L901) | $saved\_open\_page\_option = get\_option('saved\_open\_page\_url'); |
| [902](#L902) |  |
| [903](#L903) | $saved\_open\_page\_url = explode("\n", trim($saved\_open\_page\_option)); |
| [904](#L904) |  |
| [905](#L905) | if ((is\_array($saved\_open\_page\_url)) && (count($saved\_open\_page\_url) > 0)) |
| [906](#L906) | { |
| [907](#L907) | $root\_domain = get\_option('siteurl'); |
| [908](#L908) | foreach ($saved\_open\_page\_url as $saved\_open\_page\_url\_single) |
| [909](#L909) | { |
| [910](#L910) | // start 1.6 |
| [911](#L911) | $saved\_open\_page\_url\_single = trim($saved\_open\_page\_url\_single); |
| [912](#L912) |  |
| [913](#L913) | if (reserved\_url\_free($saved\_open\_page\_url\_single) == true) |
| [914](#L914) | { |
| [915](#L915) | continue; |
| [916](#L916) | } |
| [917](#L917) | // end 1.6 |
| [918](#L918) | $saved\_open\_page\_url\_single = pure\_url\_free($saved\_open\_page\_url\_single); |
| [919](#L919) |  |
| [920](#L920) | //2.7.7 |
| [921](#L921) | if (empty($saved\_open\_page\_url\_single)) |
| [922](#L922) | { |
| [923](#L923) |  |
| [924](#L924) | } |
| [925](#L925) | else |
| [926](#L926) | { |
| [927](#L927) | if (stripos($current\_url,$saved\_open\_page\_url\_single) === false) |
| [928](#L928) | { |
| [929](#L929) |  |
| [930](#L930) | } |
| [931](#L931) | else |
| [932](#L932) | { |
| [933](#L933) |  |
| [934](#L934) | return; |
| [935](#L935) | } |
| [936](#L936) | } |
| [937](#L937) |  |
| [938](#L938) | /\* |
| [939](#L939) | \* !!!old |
| [940](#L940) | if (stripos($current\_url,$saved\_open\_page\_url\_single) === false) |
| [941](#L941) | { |
| [942](#L942) |  |
| [943](#L943) | } |
| [944](#L944) | else |
| [945](#L945) | { |
| [946](#L946) |  |
| [947](#L947) | return; |
| [948](#L948) | } |
| [949](#L949) | \*/ |
| [950](#L950) | } |
| [951](#L951) | } |
| [952](#L952) |  |
| [953](#L953) | if ( is\_user\_logged\_in() == false ) |
| [954](#L954) | { |
| [955](#L955) | if (empty($saved\_register\_page\_url)) |
| [956](#L956) | { |
| [957](#L957) | //3.2.3 |
| [958](#L958) | $current\_url = sanitize\_text\_field($\_SERVER['REQUEST\_URI']); |
| [959](#L959) |  |
| [960](#L960) | //$current\_url = $\_SERVER['REQUEST\_URI']; |
| [961](#L961) | $redirect\_url = wp\_login\_url( ); |
| [962](#L962) | header( 'Location: ' . $redirect\_url ); |
| [963](#L963) | die(); |
| [964](#L964) | } |
| [965](#L965) | else |
| [966](#L966) | { |
| [967](#L967) | $saved\_register\_page\_url = 'http://'.$saved\_register\_page\_url; |
| [968](#L968) | header( 'Location: ' . $saved\_register\_page\_url ); |
| [969](#L969) | die(); |
| [970](#L970) | } |
| [971](#L971) | } |
| [972](#L972) | } |
| [973](#L973) |  |
| [974](#L974) | function pure\_url\_free($current\_url) |
| [975](#L975) | { |
| [976](#L976) | if (empty($current\_url)) return false; |
| [977](#L977) |  |
| [978](#L978) | $current\_url\_array = parse\_url($current\_url); // 1.6 |
| [979](#L979) |  |
| [980](#L980) |  |
| [981](#L981) |  |
| [982](#L982) | // 1.3 |
| [983](#L983) | $current\_url = str\_ireplace('http://','',$current\_url); |
| [984](#L984) | // start 1.6 |
| [985](#L985) | $current\_url = str\_ireplace('https://','',$current\_url); |
| [986](#L986) | $current\_url = str\_ireplace('ws://','',$current\_url); |
| [987](#L987) | // end 1.6 |
| [988](#L988) |  |
| [989](#L989) | $current\_url = str\_ireplace('www.','',$current\_url); |
| [990](#L990) | $current\_url = trim($current\_url); |
| [991](#L991) | return $current\_url; |
| [992](#L992) | } |
| [993](#L993) |  |
| [994](#L994) | // 1.6 |
| [995](#L995) | function reserved\_url\_free($url) |
| [996](#L996) | { |
| [997](#L997) | $home\_page = get\_option('siteurl'); |
| [998](#L998) | $home\_page = pure\_url\_free($home\_page); |
| [999](#L999) | $url = pure\_url\_free($url); |
| [1000](#L1000) | if ($home\_page == $url) |
| [1001](#L1001) | { |
| [1002](#L1002) | return true; |
| [1003](#L1003) | } |
| [1004](#L1004) | else |
| [1005](#L1005) | { |
| [1006](#L1006) | return false; |
| [1007](#L1007) | } |
| [1008](#L1008) | } |
| [1009](#L1009) |  |
| [1010](#L1010) |  |
| [1011](#L1011) | if (function\_exists('bp\_is\_register\_page') && function\_exists('bp\_is\_activation\_page') ) |
| [1012](#L1012) | { |
| [1013](#L1013) | add\_action('wp','buddypress\_only\_for\_members'); |
| [1014](#L1014) | } |
| [1015](#L1015) | else |
| [1016](#L1016) | { |
| [1017](#L1017) | add\_action('wp\_head','buddypress\_only\_for\_members'); |
| [1018](#L1018) | } |
| [1019](#L1019) |  |
| [1020](#L1020) | function bpmo\_free\_tomas\_login\_redirect($redirect\_to, $requested\_redirect\_to, $user) |
| [1021](#L1021) | { |
| [1022](#L1022) | global  $wp\_roles,$user\_ID; |
| [1023](#L1023) |  |
| [1024](#L1024) | $tomas\_roles\_all\_array =  $wp\_roles->roles; |
| [1025](#L1025) |  |
| [1026](#L1026) | if (empty($user)) |
| [1027](#L1027) | { |
| [1028](#L1028) | $user = wp\_get\_current\_user(); |
| [1029](#L1029) | } |
| [1030](#L1030) |  |
| [1031](#L1031) | if (empty($user->roles)) |
| [1032](#L1032) | { |
| [1033](#L1033) | return $redirect\_to; |
| [1034](#L1034) | } |
| [1035](#L1035) |  |
| [1036](#L1036) |  |
| [1037](#L1037) | $bpmemonlyredirectbppagesafterlogin = 'bpmemonlyredirectbppagesafterlogin\_Subscriber'; |
| [1038](#L1038) | $bpmemonlyredirecttypeafterlogin = 'bpmemonlyredirecttypeafterlogin\_Subscriber'; |
| [1039](#L1039) | $bpmemonlyredirecttypeafterloginoption = get\_option($bpmemonlyredirecttypeafterlogin); |
| [1040](#L1040) | $bpmemonlyredirectbppagesafterloginoption = get\_option($bpmemonlyredirectbppagesafterlogin); |
| [1041](#L1041) |  |
| [1042](#L1042) | if ($bpmemonlyredirecttypeafterloginoption == 'bppages') |
| [1043](#L1043) | { |
| [1044](#L1044) | $is\_buddypress\_plugin\_activated = in\_array( 'buddypress/bp-loader.php', (array) get\_option( 'active\_plugins', array() ) ); |
| [1045](#L1045) |  |
| [1046](#L1046) | if (true == $is\_buddypress\_plugin\_activated ) |
| [1047](#L1047) | { |
| [1048](#L1048) | $redirect\_target\_url\_to\_bppages = $bpmemonlyredirectbppagesafterloginoption; |
| [1049](#L1049) |  |
| [1050](#L1050) | if ($redirect\_target\_url\_to\_bppages == 'bpmembers') { |
| [1051](#L1051) | $bpmembersslug = bp\_get\_members\_root\_slug (); |
| [1052](#L1052) | $redirect\_target\_url = home\_url ( $bpmembersslug ); |
| [1053](#L1053) | } |
| [1054](#L1054) |  |
| [1055](#L1055) | if ($redirect\_target\_url\_to\_bppages == 'bpprofile') { |
| [1056](#L1056) | $redirect\_target\_url = tomas\_bpmo\_free\_get\_user\_domain ( $user ) . '/' . bp\_get\_profile\_slug (); |
| [1057](#L1057) | } |
| [1058](#L1058) |  |
| [1059](#L1059) | if ($redirect\_target\_url\_to\_bppages == 'bpuseractivity') { |
| [1060](#L1060) | $redirect\_target\_url = bp\_core\_get\_user\_domain ( $user->ID ); |
| [1061](#L1061) | } |
| [1062](#L1062) |  |
| [1063](#L1063) | wp\_safe\_redirect ( $redirect\_target\_url ); |
| [1064](#L1064) | die (); |
| [1065](#L1065) | return $redirect\_target\_url; |
| [1066](#L1066) | } |
| [1067](#L1067) | else |
| [1068](#L1068) | { |
| [1069](#L1069) | return $redirect\_to; |
| [1070](#L1070) | } |
| [1071](#L1071) | } |
| [1072](#L1072) | return $redirect\_to; |
| [1073](#L1073) | } |
| [1074](#L1074) |  |
| [1075](#L1075) | function tomas\_bpmo\_free\_get\_user\_domain($user) |
| [1076](#L1076) | { |
| [1077](#L1077) | $is\_buddypress\_plugin\_activated = in\_array( 'buddypress/bp-loader.php', (array) get\_option( 'active\_plugins', array() ) ); |
| [1078](#L1078) |  |
| [1079](#L1079) | if (true == $is\_buddypress\_plugin\_activated ) |
| [1080](#L1080) | { |
| [1081](#L1081) | $username = bp\_core\_get\_username ( $user->ID ); |
| [1082](#L1082) |  |
| [1083](#L1083) | if (bp\_is\_username\_compatibility\_mode ()) { |
| [1084](#L1084) | $username = rawurlencode ( $username ); |
| [1085](#L1085) | } |
| [1086](#L1086) |  |
| [1087](#L1087) | $after\_domain = bp\_core\_enable\_root\_profiles () ? $username : bp\_get\_members\_root\_slug () . '/' . $username; |
| [1088](#L1088) | $domain = trailingslashit ( bp\_get\_root\_domain () . '/' . $after\_domain ); |
| [1089](#L1089) | } |
| [1090](#L1090) | else |
| [1091](#L1091) | { |
| [1092](#L1092) | $domain = get\_option('siteurl'); |
| [1093](#L1093) | } |
| [1094](#L1094) |  |
| [1095](#L1095) | return $domain; |
| [1096](#L1096) | } |
| [1097](#L1097) |  |
| [1098](#L1098) | add\_filter( 'login\_redirect',  'bpmo\_free\_tomas\_login\_redirect', 10, 3 ); |
| [1099](#L1099) | add\_filter( 'bp\_login\_redirect',  'bpmo\_free\_tomas\_login\_redirect', 1, 3 ); |
| [1100](#L1100) |  |
| [1101](#L1101) | function membersOnlyFreeFAQ() |
| [1102](#L1102) | { |
| [1103](#L1103) | require\_once(BP\_MEMBERS\_ONLY\_FREE\_ADMIN\_PATH."howto.php"); |
| [1104](#L1104) | } |
| [1105](#L1105) |  |
| [1106](#L1106) | function members\_onlt\_free\_admin\_css() |
| [1107](#L1107) | { |
| [1108](#L1108) | wp\_enqueue\_style('members\_onlt\_free\_admin\_css', plugin\_dir\_url( \_\_FILE\_\_ ) .'asset/admin/css/admin.css'); |
| [1109](#L1109) |  |
| [1110](#L1110) | //3.2.3 |
| [1111](#L1111) | $current\_edit\_page = sanitize\_text\_field(strtolower($\_SERVER['REQUEST\_URI'])); |
| [1112](#L1112) | //$current\_edit\_page = strtolower($\_SERVER['REQUEST\_URI']); |
| [1113](#L1113) |  |
| [1114](#L1114) | if (!(empty($current\_edit\_page))) |
| [1115](#L1115) | { |
| [1116](#L1116) | if (strpos($current\_edit\_page, 'membersonlyfaq') === false) |
| [1117](#L1117) | { |
| [1118](#L1118) |  |
| [1119](#L1119) | } |
| [1120](#L1120) | else |
| [1121](#L1121) | { |
| [1122](#L1122) | wp\_register\_script( 'membersonly\_free\_admin\_js', plugin\_dir\_url( \_\_FILE\_\_ ).'/asset/admin/js/admin.js', array('jquery')); |
| [1123](#L1123) | wp\_enqueue\_script( 'membersonly\_free\_admin\_js' ); |
| [1124](#L1124) | } |
| [1125](#L1125) | } |
| [1126](#L1126) | } |
| [1127](#L1127) | add\_action('admin\_head', 'members\_onlt\_free\_admin\_css'); |
| [1128](#L1128) |  |
| [1129](#L1129) | //!!!start |
| [1130](#L1130) | $bpenablepagelevelprotect = get\_option ( 'bpenablepagelevelprotect' ); |
| [1131](#L1131) | if (! (empty ( $bpenablepagelevelprotect ))) { |
| [1132](#L1132) | add\_action ( 'add\_meta\_boxes', 'add\_bp\_members\_only\_control\_meta\_box' ); |
| [1133](#L1133) | add\_action ( 'save\_post', 'save\_wp\_members\_only\_control\_meta\_box', 10, 3 ); |
| [1134](#L1134) | } |
| [1135](#L1135) |  |
| [1136](#L1136) | function bp\_members\_only\_control\_meta\_box() { |
| [1137](#L1137) | $current\_page\_id = get\_the\_ID (); |
| [1138](#L1138) | $get\_post\_meta\_value\_for\_this\_page = get\_post\_meta ( $current\_page\_id, 'bp\_members\_only\_access\_to\_this\_page', true ); |
| [1139](#L1139) | global $wpdb; |
| [1140](#L1140) |  |
| [1141](#L1141) | ?> |
| [1142](#L1142) | <table cellspacing="2" cellpadding="5" style="width: 100%;" |
| [1143](#L1143) | class="form-table"> |
| [1144](#L1144) | <tbody> |
| [1145](#L1145) | <tr class="form-field"> |
| [1146](#L1146) | <td><input name="bp\_members\_only\_access\_to\_this\_page" type="checkbox" |
| [1147](#L1147) | value="yes" |
| [1148](#L1148) | <?php  if(esc\_attr( $get\_post\_meta\_value\_for\_this\_page ) == 'yes' ) {echo 'checked="checked"';} ?>><label><?php \_e('Allow everyone to access the page', 'admin-tools') ?></label> |
| [1149](#L1149) | </td> |
| [1150](#L1150) | </tr> |
| [1151](#L1151) | </tbody> |
| [1152](#L1152) | </table> |
| [1153](#L1153) | <?php |
| [1154](#L1154) | } |
| [1155](#L1155) | function add\_bp\_members\_only\_control\_meta\_box() { |
| [1156](#L1156) | add\_meta\_box ( "bp\_members\_only\_control\_meta\_box\_id", \_\_ ( 'Members only for this page?', 'bp-members-only' ), 'bp\_members\_only\_control\_meta\_box', null, "side", "high", null ); |
| [1157](#L1157) | } |
| [1158](#L1158) | function save\_wp\_members\_only\_control\_meta\_box($post\_id, $post, $update) { |
| [1159](#L1159) | $current\_page\_id = get\_the\_ID (); |
| [1160](#L1160) | $meta\_box\_checkbox\_value = ''; |
| [1161](#L1161) |  |
| [1162](#L1162) | //!!! start 2.9.5 |
| [1163](#L1163) | $bpmofunc\_in\_elementor\_editor = false; |
| [1164](#L1164) | $bpmofunc\_in\_elementor\_editor = bpmo\_in\_elementor\_editor(); |
| [1165](#L1165) | if ($bpmofunc\_in\_elementor\_editor == true) |
| [1166](#L1166) | { |
| [1167](#L1167) | return ''; |
| [1168](#L1168) | } |
| [1169](#L1169) | //!!! end 2.9.5 |
| [1170](#L1170) |  |
| [1171](#L1171) | if (isset ( $\_POST ['bp\_members\_only\_access\_to\_this\_page'] ) != "") |
| [1172](#L1172) | { |
| [1173](#L1173) | //3.2.3 |
| [1174](#L1174) | $meta\_box\_checkbox\_value = sanitize\_text\_field($\_POST['bp\_members\_only\_access\_to\_this\_page']); |
| [1175](#L1175) |  |
| [1176](#L1176) | //$meta\_box\_checkbox\_value = $\_POST ['bp\_members\_only\_access\_to\_this\_page']; |
| [1177](#L1177) | $get\_post\_meta\_value\_for\_this\_page = get\_post\_meta ( $current\_page\_id, 'bp\_members\_only\_access\_to\_this\_page', true ); |
| [1178](#L1178) | } |
| [1179](#L1179) |  |
| [1180](#L1180) | if (isset ( $\_POST ['bp\_members\_only\_access\_to\_this\_page'] ) != "") { |
| [1181](#L1181) | update\_post\_meta ( $current\_page\_id, 'bp\_members\_only\_access\_to\_this\_page', $meta\_box\_checkbox\_value ); |
| [1182](#L1182) | } else { |
| [1183](#L1183) | update\_post\_meta ( $current\_page\_id, 'bp\_members\_only\_access\_to\_this\_page', '' ); |
| [1184](#L1184) | } |
| [1185](#L1185) | } |
| [1186](#L1186) | //!!!end |
| [1187](#L1187) |  |
| [1188](#L1188) | function deactivate\_bp\_members\_only\_free() |
| [1189](#L1189) | { |
| [1190](#L1190) | flush\_rewrite\_rules(); |
| [1191](#L1191) | } |
| [1192](#L1192) |  |
| [1193](#L1193) | register\_deactivation\_hook(\_\_FILE\_\_, 'deactivate\_bp\_members\_only\_free'); |
| [1194](#L1194) |  |
| [1195](#L1195) | //!!! 2.8.3 |
| [1196](#L1196) | function bpmo\_user\_first\_run\_guide\_bar\_free() |
| [1197](#L1197) | { |
| [1198](#L1198) | $is\_user\_first\_run\_guide\_bar = get\_option('bpmo\_user\_first\_run\_guide\_bar\_free'); |
| [1199](#L1199) | if (empty($is\_user\_first\_run\_guide\_bar)) |
| [1200](#L1200) | { |
| [1201](#L1201) | echo "<div class='notice bpmo-notice notice-info'><p>Thanks for installing <strong>BuddyPress Members Only</strong>! Please check <a href='" . admin\_url() . "admin.php?page=membersonlyfaq' target='\_blank'>Knowledge Base</a>, then set up via <a href='" . admin\_url() . "admin.php?page=bpmemberonly' target='\_blank'>Setting Panel</a>, Any question or feature request please contact <a href='https://membersonly.top/contact-us/'  target='\_blank'>Support</a> :)</p></div>"; |
| [1202](#L1202) | update\_option('bpmo\_user\_first\_run\_guide\_bar\_free','yes'); |
| [1203](#L1203) | } |
| [1204](#L1204) | } |
| [1205](#L1205) |  |
| [1206](#L1206) | add\_action( 'admin\_notices', 'bpmo\_user\_first\_run\_guide\_bar\_free' ); |
| [1207](#L1207) |  |
| [1208](#L1208) | //!!! 2.9.5 |
| [1209](#L1209) | function bpmo\_in\_elementor\_editor() |
| [1210](#L1210) | { |
| [1211](#L1211) | if (isset($\_POST['actions'])) |
| [1212](#L1212) | { |
| [1213](#L1213) | $check\_elementor\_editor = stripos($\_POST['action'], 'elementor\_ajax'); |
| [1214](#L1214) | if ($check\_elementor\_editor === false) |
| [1215](#L1215) | { |
| [1216](#L1216) | return false; |
| [1217](#L1217) | } |
| [1218](#L1218) | else |
| [1219](#L1219) | { |
| [1220](#L1220) | return true; |
| [1221](#L1221) | } |
| [1222](#L1222) | } |
| [1223](#L1223) | } |
| [1224](#L1224) |  |
| [1225](#L1225) | function members\_only\_free\_setting\_panel\_head($title) |
| [1226](#L1226) | { |
| [1227](#L1227) | ?> |
| [1228](#L1228) | <div style='float:left;margin-right:10px;'> |
| [1229](#L1229) | <?php |
| [1230](#L1230) | /\* |
| [1231](#L1231) | //before 3.5.1 |
| [1232](#L1232) | <img src='<?php echo get\_option('siteurl');  ?>/wp-content/plugins/buddypress-members-only/images/new.png' style='width:30px;height:30px;'> |
| [1233](#L1233) | \*/ |
| [1234](#L1234) | //3.5.1 |
| [1235](#L1235) | ?> |
| [1236](#L1236) | <img src='<?php echo plugins\_url('/images/new.png', \_\_FILE\_\_);  ?>' style='width:30px;height:30px;'> |
| [1237](#L1237) |  |
| [1238](#L1238) |  |
| [1239](#L1239) | </div> |
| [1240](#L1240) | <div style='padding-top:5px; font-size:22px;'><?php echo $title; ?></div> |
| [1241](#L1241) | <div style='clear:both'></div> |
| [1242](#L1242) | <?php |
| [1243](#L1243) | } |
| [1244](#L1244) |  |
| [1245](#L1245) |  |
| [1246](#L1246) | function members\_only\_free\_check\_notify() |
| [1247](#L1247) | { |
| [1248](#L1248) |  |
| [1249](#L1249) | $update\_version\_json = '3.5.1'; |
| [1250](#L1250) |  |
| [1251](#L1251) | $members\_only\_free\_MessageString = \_\_("<p><b>Buddypress Members Only</b> has been migrated to <b>new WordPress repository address</b>. Please click the <a href='https://wordpress.org/plugins/ssl-for-buddypress' target='\_blank'>link</a> to <b>re-install</b> the new version.</p> <p>You can also download the latest Buddypress Members Only plugin for free from our <a href='https://membersonly.top/product/buddypress-members-only-free/'  target='\_blank'>official download link</a> at any time.</p>", 'bp-members-only'); |
| [1252](#L1252) |  |
| [1253](#L1253) | $members\_only\_free\_MessageString .= \_\_("<p>You only need to deactivate the current plugin, then install and activate <a href='https://wordpress.org/plugins/ssl-for-buddypress' target='\_blank'>Buddypress Members Only New</a>. All data and settings will be automatically saved and migrated, <b>with no risk involved</b>.</p>", 'bp-members-only'); |
| [1254](#L1254) |  |
| [1255](#L1255) |  |
| [1256](#L1256) | $members\_only\_free\_MessageString .= \_\_("<p>The old WordPress repository address will soon be closed. Please use the new WordPress repository address to reinstall the Membership plugin.</p> <p>Otherwise, you will not receive updates to the latest versions. We apologize deeply for any inconvenience caused to you. Thank you.</p>", 'bp-members-only'); |
| [1257](#L1257) |  |
| [1258](#L1258) |  |
| [1259](#L1259) |  |
| [1260](#L1260) | $members\_only\_free\_have\_new\_version = get\_option('members\_only\_free\_have\_new\_version\_' . $update\_version\_json); |
| [1261](#L1261) | if ($members\_only\_free\_have\_new\_version == 'dismiss') { |
| [1262](#L1262) | return; |
| [1263](#L1263) | } |
| [1264](#L1264) | else |
| [1265](#L1265) | { |
| [1266](#L1266) | members\_only\_free\_only\_update\_notify($members\_only\_free\_MessageString, $update\_version\_json); |
| [1267](#L1267) | } |
| [1268](#L1268) |  |
| [1269](#L1269) | } |
| [1270](#L1270) |  |
| [1271](#L1271) | function members\_only\_free\_hide\_notices() |
| [1272](#L1272) | { |
| [1273](#L1273) | if (isset($\_GET['members-only-free-hide-notice']) && isset($\_GET['members\_only\_free\_notice\_nonce'])) { |
| [1274](#L1274) | if (! wp\_verify\_nonce($\_GET['members\_only\_free\_notice\_nonce'], 'members\_only\_free\_hide\_notices\_nonce')) { |
| [1275](#L1275) | wp\_die(\_\_('Action failed. Please refresh the page and retry.', 'members\_only\_free')); |
| [1276](#L1276) | } |
| [1277](#L1277) |  |
| [1278](#L1278) | if (! current\_user\_can('manage\_options')) { |
| [1279](#L1279) | wp\_die(\_\_('Cheatin&#8217; huh?', 'members\_only\_free')); |
| [1280](#L1280) | } |
| [1281](#L1281) |  |
| [1282](#L1282) | $hide\_notice = sanitize\_text\_field($\_GET['members-only-free-hide-notice']); |
| [1283](#L1283) | update\_option('members\_only\_free\_have\_new\_version\_' . $\_GET['members-only-free-hide-notice'], 'dismiss'); |
| [1284](#L1284) | } |
| [1285](#L1285) | } |
| [1286](#L1286) |  |
| [1287](#L1287) | function members\_only\_free\_only\_update\_notify($p\_message, $version) |
| [1288](#L1288) | { |
| [1289](#L1289) | echo "<div id='message' class='updated fade' style='position: relative; line-height: 60px;margin-left: 0px;margin-top:10px; margin-bottom:10px;'>"; |
| [1290](#L1290) | ?> |
| [1291](#L1291) | <a class="notice-dismiss members-only-free-update-dismiss" |
| [1292](#L1292) | href="<?php echo esc\_url( wp\_nonce\_url( add\_query\_arg( 'members-only-free-hide-notice', $version ), 'members\_only\_free\_hide\_notices\_nonce', 'members\_only\_free\_notice\_nonce' ) ); ?>"><?php echo \_\_( 'Dismiss', 'bp-members-only' ); ?></a> |
| [1293](#L1293) | <?php |
| [1294](#L1294) | echo '<p>'; |
| [1295](#L1295) | echo $p\_message; |
| [1296](#L1296) | echo '</p>'; |
| [1297](#L1297) | echo "</div>"; |
| [1298](#L1298) | } |
| [1299](#L1299) |  |
| [1300](#L1300) | //add\_action('admin\_head', 'members\_only\_free\_check\_notify', 10); |
| [1301](#L1301) | //add\_action('init', 'members\_only\_free\_hide\_notices'); |
| [1302](#L1302) |  |

**Note:** See [TracBrowser](/wiki/TracBrowser)
for help on using the repository browser.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Plain Text](/browser/buddypress-members-only/trunk/buddypress-members-only.php?format=txt)
* [Original Format](/export/3220628/buddypress-members-only/trunk/buddypress-members-only.php)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)

