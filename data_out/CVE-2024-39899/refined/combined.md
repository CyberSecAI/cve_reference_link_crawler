=== Content from github.com_945c5476_20250110_133121.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FPrivateBin%2FPrivateBin%2Fpull%2F1370)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FPrivateBin%2FPrivateBin%2Fpull%2F1370)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=PrivateBin%2FPrivateBin)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[PrivateBin](/PrivateBin)
/
**[PrivateBin](/PrivateBin/PrivateBin)**
Public

* [Notifications](/login?return_to=%2FPrivateBin%2FPrivateBin) You must be signed in to change notification settings
* [Fork
  838](/login?return_to=%2FPrivateBin%2FPrivateBin)
* [Star
   6.7k](/login?return_to=%2FPrivateBin%2FPrivateBin)

* [Code](/PrivateBin/PrivateBin)
* [Issues
  108](/PrivateBin/PrivateBin/issues)
* [Pull requests
  4](/PrivateBin/PrivateBin/pulls)
* [Discussions](/PrivateBin/PrivateBin/discussions)
* [Actions](/PrivateBin/PrivateBin/actions)
* [Projects
  3](/PrivateBin/PrivateBin/projects)
* [Wiki](/PrivateBin/PrivateBin/wiki)
* [Security](/PrivateBin/PrivateBin/security)
* [Insights](/PrivateBin/PrivateBin/pulse)

Additional navigation options

* [Code](/PrivateBin/PrivateBin)
* [Issues](/PrivateBin/PrivateBin/issues)
* [Pull requests](/PrivateBin/PrivateBin/pulls)
* [Discussions](/PrivateBin/PrivateBin/discussions)
* [Actions](/PrivateBin/PrivateBin/actions)
* [Projects](/PrivateBin/PrivateBin/projects)
* [Wiki](/PrivateBin/PrivateBin/wiki)
* [Security](/PrivateBin/PrivateBin/security)
* [Insights](/PrivateBin/PrivateBin/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2FPrivateBin%2FPrivateBin%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2FPrivateBin%2FPrivateBin%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# prevent bypassing YOURLS proxy URL filter #1370

 Merged

[elrido](/elrido)
merged 2 commits into
[master](/PrivateBin/PrivateBin/tree/master "PrivateBin/PrivateBin:master")
from
[shorten-non-self-url](/PrivateBin/PrivateBin/tree/shorten-non-self-url "PrivateBin/PrivateBin:shorten-non-self-url")

Jul 9, 2024

 Merged

# [prevent bypassing YOURLS proxy URL filter](#top) #1370

[elrido](/elrido)
merged 2 commits into
[master](/PrivateBin/PrivateBin/tree/master "PrivateBin/PrivateBin:master")
from
[shorten-non-self-url](/PrivateBin/PrivateBin/tree/shorten-non-self-url "PrivateBin/PrivateBin:shorten-non-self-url")

Jul 9, 2024

[Conversation
11](/PrivateBin/PrivateBin/pull/1370)
[Commits
2](/PrivateBin/PrivateBin/pull/1370/commits)
[Checks
14](/PrivateBin/PrivateBin/pull/1370/checks)
[Files changed](/PrivateBin/PrivateBin/pull/1370/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![elrido](https://avatars.githubusercontent.com/u/1017622?s=60&v=4)](/elrido)

Copy link

Contributor

### @elrido **[elrido](/elrido)** commented [Jul 6, 2024](#issue-2393655990)

Kudos @nbviglk for reporting this via email.

## Changes

* prevent bypassing YOURLS proxy URL filter, allowing to shorten non-self URLs

## ToDo

* get this reviewed, anyone can think of additional ways of circumventing this?

Sorry, something went wrong.

All reactions

 [elrido](/elrido)
added 2 commits
[June 29, 2024 20:28](#commits-pushed-2c711e9)

[![@elrido](https://avatars.githubusercontent.com/u/1017622?s=40&v=4)](/elrido)

`[prevent bypassing YOURLS proxy URL filter, allowing to shorten non-se…](/PrivateBin/PrivateBin/pull/1370/commits/2c711e9d3ca21230fc68f5b4dba2a7a0592b963b "prevent bypassing YOURLS proxy URL filter, allowing to shorten non-self URLs")`
 …

`[2c711e9](/PrivateBin/PrivateBin/pull/1370/commits/2c711e9d3ca21230fc68f5b4dba2a7a0592b963b)`

```
…lf URLs
```

[![@elrido](https://avatars.githubusercontent.com/u/1017622?s=40&v=4)](/elrido)

`[fix test, basepath needs to be set](/PrivateBin/PrivateBin/pull/1370/commits/8e6e31db5cd7e50cfc6c1eeece8ac414fe37c30d "fix test, basepath needs to be set")`

`[8e6e31d](/PrivateBin/PrivateBin/pull/1370/commits/8e6e31db5cd7e50cfc6c1eeece8ac414fe37c30d)`

[![rugk](https://avatars.githubusercontent.com/u/11966684?s=60&v=4)](/rugk)

**[rugk](/rugk)**
requested changes
[Jul 7, 2024](#pullrequestreview-2161874200)

 [View reviewed changes](/PrivateBin/PrivateBin/pull/1370/files/8e6e31db5cd7e50cfc6c1eeece8ac414fe37c30d)

[lib/YourlsProxy.php](/PrivateBin/PrivateBin/pull/1370/files/8e6e31db5cd7e50cfc6c1eeece8ac414fe37c30d#diff-4bdcc376eae2e105a2dd1b74261ebeb03b02cccd29a31424de5160f55929ba34)

Show resolved

Hide resolved

[tst/JsonApiTest.php](/PrivateBin/PrivateBin/pull/1370/files/8e6e31db5cd7e50cfc6c1eeece8ac414fe37c30d#diff-668bd054fcf9d0797d8c3b827b5cb70299b875eb738d5a879c19df7246717e63)

Show resolved

Hide resolved

[![@rugk](https://avatars.githubusercontent.com/u/11966684?s=80&u=99534ab4f8e0d7ba8bbadd700dfdf021a728f826&v=4)](/rugk)

Copy link

Member

### **[rugk](/rugk)** commented [Jul 7, 2024](#issuecomment-2212475897)

| Only other circumvention idea would be Unicode RTL overwrite characters? <https://unicode-explorer.com/c/202E> I dunno if this confuses the PHP functions though that they read the string from the right? (My gut is, likely it does not, because technically strings start from the left, an Unicode RTL is only for display stuff?) |
| --- |

All reactions

Sorry, something went wrong.

[![@elrido](https://avatars.githubusercontent.com/u/1017622?s=80&v=4)](/elrido)

Copy link

Contributor

Author

### **[elrido](/elrido)** commented [Jul 7, 2024](#issuecomment-2212480492)

| *sigh* Due to [PHP 6 never materializing](https://wiki.php.net/rfc/php6), PHP still treats strings purely as byte arrays and is oblivious to unicode characters. So yes, as long as the admin doesn't include any utf-8 sequences in the basepath configuration setting, the strpos will remain agnostic to any utf-8 sequences passed in the GET parameter. It would then not match or not at position 0. |
| --- |

All reactions

Sorry, something went wrong.

[![rugk](https://avatars.githubusercontent.com/u/11966684?s=60&v=4)](/rugk)

**[rugk](/rugk)**
approved these changes
[Jul 8, 2024](#pullrequestreview-2164602189)

 [View reviewed changes](/PrivateBin/PrivateBin/pull/1370/files/8e6e31db5cd7e50cfc6c1eeece8ac414fe37c30d)

Copy link

Member

### @rugk **[rugk](/rugk)** left a comment

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Okay, so unless you want to introduce another test in `tst/JsonApiTest.php` for the issue at hand, this LGTM.

Sorry, something went wrong.

All reactions

[![@rugk](https://avatars.githubusercontent.com/u/11966684?s=40&u=99534ab4f8e0d7ba8bbadd700dfdf021a728f826&v=4)](/rugk)
[rugk](/rugk)
mentioned this pull request
[Jul 9, 2024](#ref-issue-2394101391)

[Replace usage of strpos with str\_starts\_with etc.
#1373](/PrivateBin/PrivateBin/issues/1373)

Closed

 Hide details
View details

[![@elrido](https://avatars.githubusercontent.com/u/1017622?s=40&v=4)](/elrido)
[elrido](/elrido)
merged commit [`0c4e810`](/PrivateBin/PrivateBin/commit/0c4e810e6728f67d678458838d8430dfba4fcca4)
into
master

[Jul 9, 2024](https://github.com/PrivateBin/PrivateBin/pull/1370#event-13444736530)
16 of 18 checks passed

 [![@elrido](https://avatars.githubusercontent.com/u/1017622?s=40&v=4)](/elrido)
[elrido](/elrido)
deleted the
shorten-non-self-url

branch
[July 9, 2024 18:38](#event-13444736721)

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2FPrivateBin%2FPrivateBin%2Fpull%2F1370)

Reviewers

[![@rugk](https://avatars.githubusercontent.com/u/11966684?s=40&v=4)](/rugk) [rugk](/rugk)

rugk approved these changes

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

Successfully merging this pull request may close these issues.

2 participants

[![@elrido](https://avatars.githubusercontent.com/u/1017622?s=52&v=4)](/elrido) [![@rugk](https://avatars.githubusercontent.com/u/11966684?s=52&v=4)](/rugk)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_c3588a32_20250110_133121.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FPrivateBin%2FPrivateBin%2Fsecurity%2Fadvisories%2FGHSA-mqqj-fx8h-437j)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FPrivateBin%2FPrivateBin%2Fsecurity%2Fadvisories%2FGHSA-mqqj-fx8h-437j)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=PrivateBin%2FPrivateBin)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[PrivateBin](/PrivateBin)
/
**[PrivateBin](/PrivateBin/PrivateBin)**
Public

* [Notifications](/login?return_to=%2FPrivateBin%2FPrivateBin) You must be signed in to change notification settings
* [Fork
  838](/login?return_to=%2FPrivateBin%2FPrivateBin)
* [Star
   6.7k](/login?return_to=%2FPrivateBin%2FPrivateBin)

* [Code](/PrivateBin/PrivateBin)
* [Issues
  108](/PrivateBin/PrivateBin/issues)
* [Pull requests
  4](/PrivateBin/PrivateBin/pulls)
* [Discussions](/PrivateBin/PrivateBin/discussions)
* [Actions](/PrivateBin/PrivateBin/actions)
* [Projects
  3](/PrivateBin/PrivateBin/projects)
* [Wiki](/PrivateBin/PrivateBin/wiki)
* [Security](/PrivateBin/PrivateBin/security)
* [Insights](/PrivateBin/PrivateBin/pulse)

Additional navigation options

* [Code](/PrivateBin/PrivateBin)
* [Issues](/PrivateBin/PrivateBin/issues)
* [Pull requests](/PrivateBin/PrivateBin/pulls)
* [Discussions](/PrivateBin/PrivateBin/discussions)
* [Actions](/PrivateBin/PrivateBin/actions)
* [Projects](/PrivateBin/PrivateBin/projects)
* [Wiki](/PrivateBin/PrivateBin/wiki)
* [Security](/PrivateBin/PrivateBin/security)
* [Insights](/PrivateBin/PrivateBin/pulse)

# Bypass of YOURLS proxy URL filter allows shortening URLs via YOURLs for other domains rather than the PrivateBin instance

Moderate

[elrido](/elrido)
published
GHSA-mqqj-fx8h-437j
Jul 9, 2024

## Package

composer

privatebin
([Composer](/advisories?query=ecosystem%3Acomposer))

## Affected versions

> 1.5.0

## Patched versions

1.7.4

docker

privatebin/gcs
([Docker](/advisories?query=ecosystem%3Adocker))

> 1.5.0

1.7.4

docker

privatebin/nginx-fpm-alpine
([Docker](/advisories?query=ecosystem%3Adocker))

> 1.5.0

1.7.4

docker

privatebin/pdo
([Docker](/advisories?query=ecosystem%3Adocker))

> 1.5.0

1.7.4

docker

privatebin/s3
([Docker](/advisories?query=ecosystem%3Adocker))

> 1.5.0

1.7.4

docker

privatebin/unit-alpine
([Docker](/advisories?query=ecosystem%3Adocker))

> 1.5.1

1.7.4

docker

privatebin/unit-fs
([Docker](/advisories?query=ecosystem%3Adocker))

> 1.5.1

1.7.4

docker

privatebin/unit-gcs
([Docker](/advisories?query=ecosystem%3Adocker))

> 1.5.1

1.7.4

docker

privatebin/unit-pdo
([Docker](/advisories?query=ecosystem%3Adocker))

> 1.5.1

1.7.4

docker

privatebin/unit-s3
([Docker](/advisories?query=ecosystem%3Adocker))

> 1.5.1

1.7.4

## Description

In [v1.5](https://github.com/PrivateBin/PrivateBin/blob/master/CHANGELOG.md#15-2022-12-11) we introduced the YOURLS server-side proxy. The idea was to allow using the YOURLs URL shortener without running the YOURLs instance without authentication and/or exposing the authentication token to the public, allowing anyone to shorten any URL. With the proxy mechanism, anyone can shorten any URL pointing to the configured PrivateBin instance. The vulnerability allowed other URLs to be shortened, as long as they contain the PrivateBin instance, defeating the limit imposed by the proxy.

Neither the confidentially of existing pastes on the server nor the configuration options including the YOURLs token are affected.

### Impact

This issue only affects non-standard configurations of PrivateBin. Instances are affected if all of the following conditions are met:

1. The PrivateBin instance enables URL shortening.
2. A YOURLs URL shortener is used and it is configured not to be public and require authentication to shorten URLs.
3. A basepath, the YOURLs proxy mechanism and an authentication token is configured in PrivateBin to use the non-public YOURLs instance.
4. A crafted URL is sent to PrivateBins' YOURLs proxy endpoint with a URL that contains the PrivateBin instance URL as a GET-parameter or as part of the URL-fragment, but doesn't start with the instance URL (a third-party URL)

The root cause is, [that the guard clause checking whether the URL to be shortened belongs to your own PrivateBin domain only checks if the PrivateBin instance is contained in the URL](https://github.com/PrivateBin/PrivateBin/blob/3cba170f3255de21bbebb77f6c565519ef33e8c1/lib/YourlsProxy.php#L50-L53) but not if it starts with it.

This is a kind of authentication bypass due to incomplete filtering. This [has a similar impact like an open redirect](https://cwe.mitre.org/data/definitions/601.html) except it does not directly redirect, but allows a further hiding of the target URL as is common and known for URL shorteners. If the URL shortener domain used is trusted by it's users, this allows hiding a malicious URL.

The highest impact may be that this can be used for phishing campaigns, by routing users to some kind of fake site mimicking the trusted shortener or PrivateBin domain, which could then extract sensitive data from entered data or similar. That said, this is a general concern with URL shorteners and users are advised to follow general phishing prevention attempts like verifying the domain of the site they are using and [using a trusted PrivateBin instance](https://github.com/PrivateBin/PrivateBin?tab=readme-ov-file#what-it-doesnt-provide).

### Indicators of exploitation

Check your YOURLs proxy for shortened domains that do not start with your own PrivateBin instance. Also note, that for this to be a result of an exploitation of this vulnerability, somewhere in the URL the `base path + ?` e.g. `https://privatebin.example/?` has to appear in the destination URL, as this is what the guard checked for.

### Patches

The problem has been patched in version 1.7.4 of PrivateBin. In addition to upgrading, users of the YOURLs proxy feature should check for the indicators of exploitation, as outlined above.

### Workarounds

* Disable URL shortening, if you have been using it.
* Only the YOURLs proxy is affected. Other URL shortening options either require a public, un-authenticated shortener, or expose the token to the client, which by design allows shortening any URL.

### Proof of concept

See [the unit test that got introduced](https://github.com/PrivateBin/PrivateBin/blob/2c711e9d3ca21230fc68f5b4dba2a7a0592b963b/tst/YourlsProxyTest.php#L57-L62) to prevent similar regressions for an example of a URL that would circumvent the configured basepath.

Here is an example of how a manual exploitation would work:

In a PrivateBin instance hosted on `https://privatebin.example/`, with a valid URL YOURLs shortening proxy configuration using a token to prevent un-authenticated short-URL creation, send a URL shortening request for the domain `https://attacker.example.com/?q=https://privatebin.example/?foo#bar`. `attacker.example.com` is any attacker controlled, arbitrary domain.

You can do this by sending a GET request to `https://privatebin.example/shortenviayourls?link=https%3A%2F%2Fattacker.example.com%2F%3Fq%3Dhttps%3A%2F%2Fprivatebin.example%2F%3Ffoo%23bar`, without URL encoding this looks as follows: `https://privatebin.example/shortenviayourls?link=https://attacker.example.com/?q=https://privatebin.example/?foo#bar`.

On an affected setup, you will get a valid short URL, which when accessed, leads to `https://attacker.example.com/?foo#bar`, the attackers domain. On a patched system your request will get rejected and only URLs starting with `https://privatebin.example/?[...]` are allowed for shortening.

### Post-mortem

From our limited analysis, the issue [has been introduced in commit `0dc9ab7` while refactoring](https://github.com/PrivateBin/PrivateBin/commit/0dc9ab7576d5a1296debeb788afb2ae9c72d137c). The use of [`substr`](http://php.net/manual/function.substr.php) got replaced by [`strpos`](https://www.php.net/manual/function.strpos). The [initial contribution](https://github.com/PrivateBin/PrivateBin/commit/b0f17f0a91cdebbfd6732781943f1e04ce3311f7) contained no tests, but an implementation without this flaw. All these changes got introduced [in a single pull request](https://github.com/PrivateBin/PrivateBin/pull/997). This follows many best practices, as tests were added and the refactoring was done in close collaboration with the original author.

In the future, [we plan to switch to the more obvious, readable and understandable](https://github.com/PrivateBin/PrivateBin/issues/1373) [`str_starts_with`](https://www.php.net/manual/function.str-starts-with.php), which is available since PHP v8. Such a better function naming and insisting on using modern functions would not only result in a better code quality, but would possibly have prevented the issue, but for backwards-compatibility with PHP 7.3, we stay on the old function for now.

### Final Thoughts

The project maintainers have always discouraged the use of URL shorteners and **users are always safer sharing the complete, long URL to a paste**, see [our FAQ](https://github.com/PrivateBin/PrivateBin/wiki/FAQ#the-url-is-so-long-cant-i-just-use-an-url-shortener).

If you need or want to provide a URL shortener option as a PrivateBin instance administrator, YOURLs is the *best option* available to use with PrivateBin, because it is the only shortener supported, through the proxy mechanism, preventing arbitrarily shortening any URLs. Running a public URL shortener instance and allowing anonymous users shortening arbitrary domains invites the shortener getting abused.

### References

* PR to fix the vulnerability: [#1370](https://github.com/PrivateBin/PrivateBin/pull/1370)

### Timeline

* 2024-06-28 Issue report by @nbxiglk via email
* 2024-06-29 Vulnerability reproduced by [@elrido](https://github.com/elrido), mitigation created and shared with maintainers and issue reporter for review
* 2024-07-06 Pull request with mitigation raised

### Severity

Moderate

5.3

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Network

Attack complexity
Low

Privileges required
None

User interaction
None

Scope
Unchanged

Confidentiality
None

Integrity
Low

Availability
None

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N

### CVE ID

CVE-2024-39899

### Weaknesses

[CWE-20](/advisories?query=cwe%3A20) [CWE-305](/advisories?query=cwe%3A305) [CWE-791](/advisories?query=cwe%3A791)

### Credits

* [![@nbxiglk0](https://avatars.githubusercontent.com/u/24366795?s=40&v=4)](/nbxiglk0)
  [nbxiglk0](/nbxiglk0)
  Reporter

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_6cb35021_20250110_133118.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FPrivateBin%2FPrivateBin%2Fcommit%2F0c4e810e6728f67d678458838d8430dfba4fcca4)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FPrivateBin%2FPrivateBin%2Fcommit%2F0c4e810e6728f67d678458838d8430dfba4fcca4)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=PrivateBin%2FPrivateBin)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[PrivateBin](/PrivateBin)
/
**[PrivateBin](/PrivateBin/PrivateBin)**
Public

* [Notifications](/login?return_to=%2FPrivateBin%2FPrivateBin) You must be signed in to change notification settings
* [Fork
  838](/login?return_to=%2FPrivateBin%2FPrivateBin)
* [Star
   6.7k](/login?return_to=%2FPrivateBin%2FPrivateBin)

* [Code](/PrivateBin/PrivateBin)
* [Issues
  108](/PrivateBin/PrivateBin/issues)
* [Pull requests
  4](/PrivateBin/PrivateBin/pulls)
* [Discussions](/PrivateBin/PrivateBin/discussions)
* [Actions](/PrivateBin/PrivateBin/actions)
* [Projects
  3](/PrivateBin/PrivateBin/projects)
* [Wiki](/PrivateBin/PrivateBin/wiki)
* [Security](/PrivateBin/PrivateBin/security)
* [Insights](/PrivateBin/PrivateBin/pulse)

Additional navigation options

* [Code](/PrivateBin/PrivateBin)
* [Issues](/PrivateBin/PrivateBin/issues)
* [Pull requests](/PrivateBin/PrivateBin/pulls)
* [Discussions](/PrivateBin/PrivateBin/discussions)
* [Actions](/PrivateBin/PrivateBin/actions)
* [Projects](/PrivateBin/PrivateBin/projects)
* [Wiki](/PrivateBin/PrivateBin/wiki)
* [Security](/PrivateBin/PrivateBin/security)
* [Insights](/PrivateBin/PrivateBin/pulse)

## Commit

[Permalink](/PrivateBin/PrivateBin/commit/0c4e810e6728f67d678458838d8430dfba4fcca4)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Merge branch 'shorten-non-self-url'

[Browse files](/PrivateBin/PrivateBin/tree/0c4e810e6728f67d678458838d8430dfba4fcca4)
Browse the repository at this point in the history

* Loading branch information

[![@elrido](https://avatars.githubusercontent.com/u/1017622?s=40&v=4)](/elrido)

[elrido](/PrivateBin/PrivateBin/commits?author=elrido "View all commits by elrido")
committed
Jul 9, 2024

2 parents
[8712ed6](/PrivateBin/PrivateBin/commit/8712ed6a5d304421fdfed93ecdfb97e077c661fd)
+
[8e6e31d](/PrivateBin/PrivateBin/commit/8e6e31db5cd7e50cfc6c1eeece8ac414fe37c30d)

commit 0c4e810

 Show file tree

 Hide file tree

Showing
**4 changed files**
with
**12 additions**
and
**1 deletion**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* CHANGELOG.md
  [CHANGELOG.md](#diff-06572a96a58dc510037d5efa622f9bec8519bc1beab13c9f251e97e657a9d4ed)
* lib

  + lib/YourlsProxy.php
    [YourlsProxy.php](#diff-4bdcc376eae2e105a2dd1b74261ebeb03b02cccd29a31424de5160f55929ba34)
* tst

  + tst/JsonApiTest.php
    [JsonApiTest.php](#diff-668bd054fcf9d0797d8c3b827b5cb70299b875eb738d5a879c19df7246717e63)
  + tst/YourlsProxyTest.php
    [YourlsProxyTest.php](#diff-dff46e3addc6009a91128d63abd005424eb737489f9d2355b23af2786ac35840)

## There are no files selected for viewing

1 change: 1 addition & 0 deletions

1
[CHANGELOG.md](#diff-06572a96a58dc510037d5efa622f9bec8519bc1beab13c9f251e97e657a9d4ed "CHANGELOG.md")

Show comments

[View file](/PrivateBin/PrivateBin/blob/0c4e810e6728f67d678458838d8430dfba4fcca4/CHANGELOG.md)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |

| Expand Up | | @@ -7,6 +7,7 @@ |
|  |  | \* FIXED: Reset password input field on creation of new paste (#1194) |
|  |  | \* FIXED: Allow database schema upgrade to skip versions (#1343) |
|  |  | \* FIXED: `bootstrap5` dark mode toggle unset on dark browser preference (#1340) |
|  |  | \* FIXED: Prevent bypassing YOURLS proxy URL filter, allowing to shorten non-self URLs |
|  |  |  |
|  |  | ## 1.7.3 (2024-05-13) |
|  |  | \* CHANGED: Various tweaks of the `bootstrap5` template, suggested by the community |
| Expand Down | |  |

2 changes: 1 addition & 1 deletion

2
[lib/YourlsProxy.php](#diff-4bdcc376eae2e105a2dd1b74261ebeb03b02cccd29a31424de5160f55929ba34 "lib/YourlsProxy.php")

Show comments

[View file](/PrivateBin/PrivateBin/blob/0c4e810e6728f67d678458838d8430dfba4fcca4/lib/YourlsProxy.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -47,7 +47,7 @@ class YourlsProxy |
|  |  | \*/ |
|  |  | public function \_\_construct(Configuration $conf, $link) |
|  |  | { |
|  |  | if (strpos($link, $conf->getKey('basepath') . '?') === false) { |
|  |  | if (strpos($link, $conf->getKey('basepath') . '?') !== 0) { |
|  |  | $this->\_error = 'Trying to shorten a URL that isn\'t pointing at our instance.'; |
|  |  | return; |
|  |  | } |
| Expand Down | |  |

3 changes: 3 additions & 0 deletions

3
[tst/JsonApiTest.php](#diff-668bd054fcf9d0797d8c3b827b5cb70299b875eb738d5a879c19df7246717e63 "tst/JsonApiTest.php")

Show comments

[View file](/PrivateBin/PrivateBin/blob/0c4e810e6728f67d678458838d8430dfba4fcca4/tst/JsonApiTest.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -325,6 +325,9 @@ public function baseUriProvider() |
|  |  | \*/ |
|  |  | public function testShortenViaYourlsFailure() |
|  |  | { |
|  |  | $options = parse\_ini\_file(CONF, true); |
|  |  | $options['main']['basepath'] = 'https://example.com/path'; // missing slash gets added by Configuration constructor |
|  |  | Helper::createIniFile(CONF, $options); |
|  |  | $\_SERVER['REQUEST\_URI'] = '/path/shortenviayourls?link=https%3A%2F%2Fexample.com%2Fpath%2F%3Ffoo%23bar'; |
|  |  | $\_GET['link'] = 'https://example.com/path/?foo#bar'; |
|  |  | ob\_start(); |
| Expand Down | |  |

7 changes: 7 additions & 0 deletions

7
[tst/YourlsProxyTest.php](#diff-dff46e3addc6009a91128d63abd005424eb737489f9d2355b23af2786ac35840 "tst/YourlsProxyTest.php")

Show comments

[View file](/PrivateBin/PrivateBin/blob/0c4e810e6728f67d678458838d8430dfba4fcca4/tst/YourlsProxyTest.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -54,6 +54,13 @@ public function testForeignUrl() |
|  |  | $this->assertEquals($yourls->getError(), 'Trying to shorten a URL that isn\'t pointing at our instance.'); |
|  |  | } |
|  |  |  |
|  |  | public function testSneakyForeignUrl() |
|  |  | { |
|  |  | $yourls = new YourlsProxy($this->\_conf, 'https://other.example.com/?q=https://example.com/?foo#bar'); |
|  |  | $this->assertTrue($yourls->isError()); |
|  |  | $this->assertEquals($yourls->getError(), 'Trying to shorten a URL that isn\'t pointing at our instance.'); |
|  |  | } |
|  |  |  |
|  |  | public function testYourlsError() |
|  |  | { |
|  |  | // when statusCode is not 200, shorturl may not have been set |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `0c4e810`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FPrivateBin%2FPrivateBin%2Fcommit%2F0c4e810e6728f67d678458838d8430dfba4fcca4) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


