
[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FPrivateBin%2FPrivateBin%2Fsecurity%2Fadvisories%2FGHSA-mqqj-fx8h-437j)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FPrivateBin%2FPrivateBin%2Fsecurity%2Fadvisories%2FGHSA-mqqj-fx8h-437j)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=PrivateBin%2FPrivateBin)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[PrivateBin](/PrivateBin)
/
**[PrivateBin](/PrivateBin/PrivateBin)**
Public

* [Notifications](/login?return_to=%2FPrivateBin%2FPrivateBin) You must be signed in to change notification settings
* [Fork
  838](/login?return_to=%2FPrivateBin%2FPrivateBin)
* [Star
   6.7k](/login?return_to=%2FPrivateBin%2FPrivateBin)

* [Code](/PrivateBin/PrivateBin)
* [Issues
  108](/PrivateBin/PrivateBin/issues)
* [Pull requests
  4](/PrivateBin/PrivateBin/pulls)
* [Discussions](/PrivateBin/PrivateBin/discussions)
* [Actions](/PrivateBin/PrivateBin/actions)
* [Projects
  3](/PrivateBin/PrivateBin/projects)
* [Wiki](/PrivateBin/PrivateBin/wiki)
* [Security](/PrivateBin/PrivateBin/security)
* [Insights](/PrivateBin/PrivateBin/pulse)

Additional navigation options

* [Code](/PrivateBin/PrivateBin)
* [Issues](/PrivateBin/PrivateBin/issues)
* [Pull requests](/PrivateBin/PrivateBin/pulls)
* [Discussions](/PrivateBin/PrivateBin/discussions)
* [Actions](/PrivateBin/PrivateBin/actions)
* [Projects](/PrivateBin/PrivateBin/projects)
* [Wiki](/PrivateBin/PrivateBin/wiki)
* [Security](/PrivateBin/PrivateBin/security)
* [Insights](/PrivateBin/PrivateBin/pulse)

# Bypass of YOURLS proxy URL filter allows shortening URLs via YOURLs for other domains rather than the PrivateBin instance

Moderate

[elrido](/elrido)
published
GHSA-mqqj-fx8h-437j
Jul 9, 2024

## Package

composer

privatebin
([Composer](/advisories?query=ecosystem%3Acomposer))

## Affected versions

> 1.5.0

## Patched versions

1.7.4

docker

privatebin/gcs
([Docker](/advisories?query=ecosystem%3Adocker))

> 1.5.0

1.7.4

docker

privatebin/nginx-fpm-alpine
([Docker](/advisories?query=ecosystem%3Adocker))

> 1.5.0

1.7.4

docker

privatebin/pdo
([Docker](/advisories?query=ecosystem%3Adocker))

> 1.5.0

1.7.4

docker

privatebin/s3
([Docker](/advisories?query=ecosystem%3Adocker))

> 1.5.0

1.7.4

docker

privatebin/unit-alpine
([Docker](/advisories?query=ecosystem%3Adocker))

> 1.5.1

1.7.4

docker

privatebin/unit-fs
([Docker](/advisories?query=ecosystem%3Adocker))

> 1.5.1

1.7.4

docker

privatebin/unit-gcs
([Docker](/advisories?query=ecosystem%3Adocker))

> 1.5.1

1.7.4

docker

privatebin/unit-pdo
([Docker](/advisories?query=ecosystem%3Adocker))

> 1.5.1

1.7.4

docker

privatebin/unit-s3
([Docker](/advisories?query=ecosystem%3Adocker))

> 1.5.1

1.7.4

## Description

In [v1.5](https://github.com/PrivateBin/PrivateBin/blob/master/CHANGELOG.md#15-2022-12-11) we introduced the YOURLS server-side proxy. The idea was to allow using the YOURLs URL shortener without running the YOURLs instance without authentication and/or exposing the authentication token to the public, allowing anyone to shorten any URL. With the proxy mechanism, anyone can shorten any URL pointing to the configured PrivateBin instance. The vulnerability allowed other URLs to be shortened, as long as they contain the PrivateBin instance, defeating the limit imposed by the proxy.

Neither the confidentially of existing pastes on the server nor the configuration options including the YOURLs token are affected.

### Impact

This issue only affects non-standard configurations of PrivateBin. Instances are affected if all of the following conditions are met:

1. The PrivateBin instance enables URL shortening.
2. A YOURLs URL shortener is used and it is configured not to be public and require authentication to shorten URLs.
3. A basepath, the YOURLs proxy mechanism and an authentication token is configured in PrivateBin to use the non-public YOURLs instance.
4. A crafted URL is sent to PrivateBins' YOURLs proxy endpoint with a URL that contains the PrivateBin instance URL as a GET-parameter or as part of the URL-fragment, but doesn't start with the instance URL (a third-party URL)

The root cause is, [that the guard clause checking whether the URL to be shortened belongs to your own PrivateBin domain only checks if the PrivateBin instance is contained in the URL](https://github.com/PrivateBin/PrivateBin/blob/3cba170f3255de21bbebb77f6c565519ef33e8c1/lib/YourlsProxy.php#L50-L53) but not if it starts with it.

This is a kind of authentication bypass due to incomplete filtering. This [has a similar impact like an open redirect](https://cwe.mitre.org/data/definitions/601.html) except it does not directly redirect, but allows a further hiding of the target URL as is common and known for URL shorteners. If the URL shortener domain used is trusted by it's users, this allows hiding a malicious URL.

The highest impact may be that this can be used for phishing campaigns, by routing users to some kind of fake site mimicking the trusted shortener or PrivateBin domain, which could then extract sensitive data from entered data or similar. That said, this is a general concern with URL shorteners and users are advised to follow general phishing prevention attempts like verifying the domain of the site they are using and [using a trusted PrivateBin instance](https://github.com/PrivateBin/PrivateBin?tab=readme-ov-file#what-it-doesnt-provide).

### Indicators of exploitation

Check your YOURLs proxy for shortened domains that do not start with your own PrivateBin instance. Also note, that for this to be a result of an exploitation of this vulnerability, somewhere in the URL the `base path + ?` e.g. `https://privatebin.example/?` has to appear in the destination URL, as this is what the guard checked for.

### Patches

The problem has been patched in version 1.7.4 of PrivateBin. In addition to upgrading, users of the YOURLs proxy feature should check for the indicators of exploitation, as outlined above.

### Workarounds

* Disable URL shortening, if you have been using it.
* Only the YOURLs proxy is affected. Other URL shortening options either require a public, un-authenticated shortener, or expose the token to the client, which by design allows shortening any URL.

### Proof of concept

See [the unit test that got introduced](https://github.com/PrivateBin/PrivateBin/blob/2c711e9d3ca21230fc68f5b4dba2a7a0592b963b/tst/YourlsProxyTest.php#L57-L62) to prevent similar regressions for an example of a URL that would circumvent the configured basepath.

Here is an example of how a manual exploitation would work:

In a PrivateBin instance hosted on `https://privatebin.example/`, with a valid URL YOURLs shortening proxy configuration using a token to prevent un-authenticated short-URL creation, send a URL shortening request for the domain `https://attacker.example.com/?q=https://privatebin.example/?foo#bar`. `attacker.example.com` is any attacker controlled, arbitrary domain.

You can do this by sending a GET request to `https://privatebin.example/shortenviayourls?link=https%3A%2F%2Fattacker.example.com%2F%3Fq%3Dhttps%3A%2F%2Fprivatebin.example%2F%3Ffoo%23bar`, without URL encoding this looks as follows: `https://privatebin.example/shortenviayourls?link=https://attacker.example.com/?q=https://privatebin.example/?foo#bar`.

On an affected setup, you will get a valid short URL, which when accessed, leads to `https://attacker.example.com/?foo#bar`, the attackers domain. On a patched system your request will get rejected and only URLs starting with `https://privatebin.example/?[...]` are allowed for shortening.

### Post-mortem

From our limited analysis, the issue [has been introduced in commit `0dc9ab7` while refactoring](https://github.com/PrivateBin/PrivateBin/commit/0dc9ab7576d5a1296debeb788afb2ae9c72d137c). The use of [`substr`](http://php.net/manual/function.substr.php) got replaced by [`strpos`](https://www.php.net/manual/function.strpos). The [initial contribution](https://github.com/PrivateBin/PrivateBin/commit/b0f17f0a91cdebbfd6732781943f1e04ce3311f7) contained no tests, but an implementation without this flaw. All these changes got introduced [in a single pull request](https://github.com/PrivateBin/PrivateBin/pull/997). This follows many best practices, as tests were added and the refactoring was done in close collaboration with the original author.

In the future, [we plan to switch to the more obvious, readable and understandable](https://github.com/PrivateBin/PrivateBin/issues/1373) [`str_starts_with`](https://www.php.net/manual/function.str-starts-with.php), which is available since PHP v8. Such a better function naming and insisting on using modern functions would not only result in a better code quality, but would possibly have prevented the issue, but for backwards-compatibility with PHP 7.3, we stay on the old function for now.

### Final Thoughts

The project maintainers have always discouraged the use of URL shorteners and **users are always safer sharing the complete, long URL to a paste**, see [our FAQ](https://github.com/PrivateBin/PrivateBin/wiki/FAQ#the-url-is-so-long-cant-i-just-use-an-url-shortener).

If you need or want to provide a URL shortener option as a PrivateBin instance administrator, YOURLs is the *best option* available to use with PrivateBin, because it is the only shortener supported, through the proxy mechanism, preventing arbitrarily shortening any URLs. Running a public URL shortener instance and allowing anonymous users shortening arbitrary domains invites the shortener getting abused.

### References

* PR to fix the vulnerability: [#1370](https://github.com/PrivateBin/PrivateBin/pull/1370)

### Timeline

* 2024-06-28 Issue report by @nbxiglk via email
* 2024-06-29 Vulnerability reproduced by [@elrido](https://github.com/elrido), mitigation created and shared with maintainers and issue reporter for review
* 2024-07-06 Pull request with mitigation raised

### Severity

Moderate

5.3

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Network

Attack complexity
Low

Privileges required
None

User interaction
None

Scope
Unchanged

Confidentiality
None

Integrity
Low

Availability
None

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N

### CVE ID

CVE-2024-39899

### Weaknesses

[CWE-20](/advisories?query=cwe%3A20) [CWE-305](/advisories?query=cwe%3A305) [CWE-791](/advisories?query=cwe%3A791)

### Credits

* [![@nbxiglk0](https://avatars.githubusercontent.com/u/24366795?s=40&v=4)](/nbxiglk0)
  [nbxiglk0](/nbxiglk0)
  Reporter

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.

