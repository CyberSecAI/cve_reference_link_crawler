Based on the provided commit message "Fix reflected XSS" and the code diff, this content is related to a security vulnerability.

- **Root cause of vulnerability:** Reflected Cross-Site Scripting (XSS) vulnerability in the `/ticket/:id?` endpoint. The vulnerability was present because the `site_id` parameter was not being properly sanitized before being used in the page.
- **Weaknesses/vulnerabilities present:** Reflected XSS.
- **Impact of exploitation:** An attacker can inject malicious scripts into the page that could execute in the context of the victim user's browser. This could lead to session hijacking, information theft, or other malicious actions.
- **Attack vectors:** The attacker would need to craft a malicious URL with a specific `site_id` query parameter that injects JavaScript code.
- **Required attacker capabilities/position:** The attacker needs to be able to convince a user to click the crafted malicious URL.

The diff shows that the vulnerable line
```perl
site_id => query_parameters->get('site_id') || session('site_id'),
```
was changed to:
```perl
site_id => $site_id,
```
where `$site_id` is sanitized with `int(query_parameters->get('site_id'))` before being used in the output. This fixes the reflected XSS vulnerability by ensuring that only an integer can be used in the output.