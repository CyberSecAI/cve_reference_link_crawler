=== Content from www.zerodayinitiative.com_e58f46e5_20250110_211726.html ===

[![thezdi](/images/logo.svg)](/)

Menu

* [PRIVACY](https://www.trendmicro.com/privacy)
* [WHO WE ARE](/about/)
* [HOW IT WORKS](/about/benefits/)
* [BLOG](/blog/)
* [ADVISORIES](/advisories/)
* [LOG IN](/portal/)
  [SIGN UP](/portal/register/)

Menu

* [PRIVACY](https://www.trendmicro.com/privacy/)
* [WHO WE ARE](/about/)
* [HOW IT WORKS](/about/benefits/)
* [BLOG](/blog/)
* [ADVISORIES](/advisories/)
* [LOG IN](/portal/)
* [SIGN UP](/portal/register/)

* [![thezdi](/images/logo.svg)](/)
* [Trend Micro](https://www.trendmicro.com/)

# Advisory Details

April 12th, 2023
## BlueZ Audio Profile AVRCP Improper Validation of Array Index Remote Code Execution Vulnerability

### ZDI-23-386ZDI-CAN-19908

| CVE ID | [CVE-2023-27349](https://www.cve.org/CVERecord?id=CVE-2023-27349) |
| --- | --- |
| CVSS SCORE | 7.1, [AV:A/AC:H/PR:N/UI:R/S:U/C:H/I:H/A:H](http://nvd.nist.gov/cvss.cfm?calculator&version=3.0&vector=AV:A/AC:H/PR:N/UI:R/S:U/C:H/I:H/A:H) |
| AFFECTED VENDORS | [BlueZ](http://www.bluez.org/) |
| AFFECTED PRODUCTS | [BlueZ](http://www.bluez.org/) |
| VULNERABILITY DETAILS | This vulnerability allows network-adjacent attackers to execute arbitrary code via Bluetooth on affected installations of BlueZ. User interaction is required to exploit this vulnerability in that the target must connect to a malicious device.  The specific flaw exists within the handling of the AVRCP protocol. The issue results from the lack of proper validation of user-supplied data, which can result in a write past the end of an allocated buffer. An attacker can leverage this vulnerability to execute code in the context of root. |
| ADDITIONAL DETAILS | BlueZ has issued an update to correct this vulnerability. More details can be found at: |
| DISCLOSURE TIMELINE | * 2023-03-22 - Vulnerability reported to vendor * 2023-04-12 - Coordinated public release of advisory |
| CREDIT | Michael Randrianantenaina (https://elkamika.blogspot.com/) |

[BACK TO ADVISORIES](/advisories/)

### General Inquiries

zdi@trendmicro.com

### Find us on X

[@thezdi](https://twitter.com/thezdi)

### Find us on Mastodon

[Mastodon](https://infosec.exchange/%40thezdi)

### Media Inquiries

media\_relations@trendmicro.com

### Sensitive Email Communications

[PGP Key](https://www.zerodayinitiative.com/documents/zdi-pgp-key.asc)

[WHO WE ARE](/about/)

* [Our Mission](/about/)
* [Trend Micro](https://www.trendmicro.com)
* [TippingPoint IPS](https://www.trendmicro.com/en_us/business/products/network/integrated-atp/next-gen-intrusion-prevention-system.html)

[HOW IT WORKS](/about/benefits/)

* [Process](/about/benefits/#process)
* [Researcher Rewards](/about/benefits/#researcher-rewards)
* [FAQS](/about/faq/)
* [Privacy](https://www.trendmicro.com/privacy/)

[ADVISORIES](/advisories)

* [Published Advisories](/advisories/published)
* [Upcoming Advisories](/advisories/upcoming)
* [RSS Feeds](/rss)

[BLOG](/blog)

[![thezdi](/images/logo-footer.svg)](/)



=== Content from lists.debian.org_43e403c7_20250110_211725.html ===


---

[[Date Prev](msg00014.html)][[Date Next](msg00016.html)]
[[Thread Prev](msg00014.html)][[Thread Next](msg00016.html)]
[[Date Index](maillist.html#00015)]
[[Thread Index](threads.html#00015)]

# [SECURITY] [DLA 3820-1] bluez security update

---

* *To*: debian-lts-announce@lists.debian.org
* *Subject*: [SECURITY] [DLA 3820-1] bluez security update
* *From*: Arturo Borrero Gonzalez <arturo@debian.org>
* *Date*: Sat, 25 May 2024 18:21:30 +0200
* *Message-id*: <[[ðŸ”Ž]](/msgid-search/efbfdd48-ee1c-4d6f-ac7a-e8ca449ac650%40debian.org)Â [efbfdd48-ee1c-4d6f-ac7a-e8ca449ac650@debian.org](msg00015.html)>
* *Mail-followup-to*: debian-lts@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

- -------------------------------------------------------------------------
Debian LTS Advisory DLA-3820-1                debian-lts@lists.debian.org
<https://www.debian.org/lts/security/>              Arturo Borrero Gonzalez
May 25, 2024                                  <https://wiki.debian.org/LTS>
- -------------------------------------------------------------------------

Package        : bluez
Version        : 5.50-1.2~deb10u5
CVE ID         : CVE-2023-27349

An problem has been fixed with the handling of the AVRCP protocol in the bluetooth
stack that could lead to remote code execution.

For Debian 10 buster, this problem has been fixed in version
5.50-1.2~deb10u5.

We recommend that you upgrade your bluez packages.

For the detailed security status of bluez please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/bluez>

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>
-----BEGIN PGP SIGNATURE-----

iQIzBAEBCgAdFiEE3ZhhqyPcMzOJLgepaOcTmB0VFfgFAmZSD3YACgkQaOcTmB0V
Ffjkyw//XicL8SANqe1bCCNAFez4zwLZU3fSixog/VCgFUX+MuOUopI7B6MHroP0
6b14E0lz77R8tRv8+EFP0eXSJcQ1qNBUJG8I+woik72xujub8UncMbY0alzieuQ8
FrP7pNbpJta00PBD1noltN0+jyEAoCM2p5fjwccCeiTfnFRuxiUiQnvMgWBPbqlJ
iJ57LYSnVURnees1hnz70Nf0qpMr3LXOnw7lDCwXWN+lyJYdDa+7ipBkbVAxhDGK
vHUa74b1olabw+6sEYYCPpyA/U75GDbkm9zzGBCKL+4HRjsrUwP1Jp0NPGFEqpKF
kkNCnaX5viJSIxaevIRgzZip6Ofy93VUKq4RD/gxo4mKYMdEiI2OY3Mc1aBrXhAy
3z42blWL/fA6HdFjNfyJj/OtxWHOtkT8o/4SAmLBZ4pGCSFITpAjrb7M8UU4mcxb
M8gkwXV6LCv0fqM2zw9sIJlwY8IrTLeze6a5lq0tRzD4i5pjj1HipHv1X2ts5lSq
cnkFNyPmedRweblFvknRtKlqH6pZBwXQxXXhvNXusLKjICdgf0lkhgY75CYQL7oo
ptxZeS4Q8IJ5uB8rxLcASo+F/pEwRHOe+mxItmwA3K6+n2/FlSgwPh0XmLSBw2Tq
c3l+kikRvLXB2kqj440I9id741bXyI4dMt7KcqpNNbhhHWN0QrM=
=W0T9
-----END PGP SIGNATURE-----

```

---



=== Content from git.kernel.org_462e9f0e_20250110_211724.html ===


| [cgit logo](/) | [index](/) : [bluez.git](/pub/scm/bluetooth/bluez.git/) | master |
| --- | --- | --- |
| Bluetooth protocol stack for Linux | Marcel Holtmann |

| [about](/pub/scm/bluetooth/bluez.git/about/)[summary](/pub/scm/bluetooth/bluez.git/)[refs](/pub/scm/bluetooth/bluez.git/refs/?id=f54299a850676d92c3dafd83e9174fcfe420ccc9)[log](/pub/scm/bluetooth/bluez.git/log/)[tree](/pub/scm/bluetooth/bluez.git/tree/?id=f54299a850676d92c3dafd83e9174fcfe420ccc9)[commit](/pub/scm/bluetooth/bluez.git/commit/?id=f54299a850676d92c3dafd83e9174fcfe420ccc9)[diff](/pub/scm/bluetooth/bluez.git/diff/?id=f54299a850676d92c3dafd83e9174fcfe420ccc9)[stats](/pub/scm/bluetooth/bluez.git/stats/)[homepage](http://www.bluez.org) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Luiz Augusto von Dentz <luiz.von.dentz@intel.com> | 2023-03-22 11:34:24 -0700 |
| --- | --- | --- |
| committer | Luiz Augusto von Dentz <luiz.von.dentz@intel.com> | 2023-03-30 16:44:46 -0700 |
| commit | [f54299a850676d92c3dafd83e9174fcfe420ccc9](/pub/scm/bluetooth/bluez.git/commit/?id=f54299a850676d92c3dafd83e9174fcfe420ccc9) ([patch](/pub/scm/bluetooth/bluez.git/patch/?id=f54299a850676d92c3dafd83e9174fcfe420ccc9)) | |
| tree | [ffc78bb31559add7c2197915c7e02f1eea3b77a9](/pub/scm/bluetooth/bluez.git/tree/?id=f54299a850676d92c3dafd83e9174fcfe420ccc9) | |
| parent | [5106fe8c868d5ec69af70f299eeedad42b900f69](/pub/scm/bluetooth/bluez.git/commit/?id=5106fe8c868d5ec69af70f299eeedad42b900f69) ([diff](/pub/scm/bluetooth/bluez.git/diff/?id=f54299a850676d92c3dafd83e9174fcfe420ccc9&id2=5106fe8c868d5ec69af70f299eeedad42b900f69)) | |

avrcp: Fix crash while handling unsupported eventsThe following crash can be observed if the remote peer send and
unsupported event:
ERROR: AddressSanitizer: heap-use-after-free on address 0x60b000148f11
at pc 0x559644552088 bp 0x7ffe28b3c7b0 sp 0x7ffe28b3c7a0
WRITE of size 1 at 0x60b000148f11 thread T0
#0 0x559644552087 in avrcp\_handle\_event profiles/audio/avrcp.c:3907
#1 0x559644536c22 in control\_response profiles/audio/avctp.c:939
#2 0x5596445379ab in session\_cb profiles/audio/avctp.c:1108
#3 0x7fbcb3e51c43 in g\_main\_context\_dispatch (/lib/x86\_64-linux-gnu/libglib-2.0.so.0+0x55c43)
#4 0x7fbcb3ea66c7 (/lib/x86\_64-linux-gnu/libglib-2.0.so.0+0xaa6c7)
#5 0x7fbcb3e512b2 in g\_main\_loop\_run (/lib/x86\_64-linux-gnu/libglib-2.0.so.0+0x552b2)
#6 0x559644754ab6 in mainloop\_run src/shared/mainloop-glib.c:66
#7 0x559644755606 in mainloop\_run\_with\_signal src/shared/mainloop-notify.c:188
#8 0x5596445bb963 in main src/main.c:1289
#9 0x7fbcb3bafd8f in \_\_libc\_start\_call\_main ../sysdeps/nptl/libc\_start\_call\_main.h:58
#10 0x7fbcb3bafe3f in \_\_libc\_start\_main\_impl ../csu/libc-start.c:392
#11 0x5596444e8224 in \_start (/usr/local/libexec/bluetooth/bluetoothd+0xf0224)
[Diffstat](/pub/scm/bluetooth/bluez.git/diff/?id=f54299a850676d92c3dafd83e9174fcfe420ccc9)

| -rw-r--r-- | [profiles/audio/avrcp.c](/pub/scm/bluetooth/bluez.git/diff/profiles/audio/avrcp.c?id=f54299a850676d92c3dafd83e9174fcfe420ccc9) | 6 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 6 insertions, 0 deletions

| diff --git a/profiles/audio/avrcp.c b/profiles/audio/avrcp.cindex 80f34c7a77..dda9a303fb 100644--- a/[profiles/audio/avrcp.c](/pub/scm/bluetooth/bluez.git/tree/profiles/audio/avrcp.c?id=5106fe8c868d5ec69af70f299eeedad42b900f69)+++ b/[profiles/audio/avrcp.c](/pub/scm/bluetooth/bluez.git/tree/profiles/audio/avrcp.c?id=f54299a850676d92c3dafd83e9174fcfe420ccc9)@@ -3901,6 +3901,12 @@ static gboolean avrcp\_handle\_event(struct avctp \*conn, uint8\_t code, case AVRCP\_EVENT\_UIDS\_CHANGED: avrcp\_uids\_changed(session, pdu); break;+ default:+ if (event > AVRCP\_EVENT\_LAST) {+ warn("Unsupported event: %u", event);+ return FALSE;+ }+ break; }  session->registered\_events |= (1 << event); |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-10 21:16:02 +0000


