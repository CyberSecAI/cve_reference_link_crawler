- **Root cause of vulnerability:** The vulnerability stems from the use of a 120-bit shared secret instead of the recommended minimum 128-bit secret for generating TOTP codes. This is due to a change in the ROTP library's `random_base32` function.
- **Weaknesses/vulnerabilities present:** Insufficiently random values (CWE-331) are being used for generating shared secrets, making them more vulnerable to brute-force attacks. Specifically, the shared secret is 120 bits instead of the 128-bit minimum specified by RFC 4226.
- **Impact of exploitation:** An attacker could potentially guess the shared secret, enabling them to generate valid TOTP codes and bypass multi-factor authentication, gaining unauthorized access to user accounts.
- **Attack vectors:** The attack vector is network-based.
- **Required attacker capabilities/position:** The attacker would require a position to attempt brute-force guessing of the shared secret to generate valid TOTP codes. The attacker would also need to know the user's username and password.