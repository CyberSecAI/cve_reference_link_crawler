```
{
  "CVE-2024-8007": {
    "description": "The RHOSP Director, when preparing container images for deployment, checks the connectivity to the registry. If TLS verification fails during this check, the registry is automatically added to the DockerInsecureRegistries parameter in the generated configuration file, or TLS verification is disabled for the image mirroring task. This results in images being pulled from the registry insecurely, without TLS verification. This allows a MITM attack by delivering tainted container images.",
    "vulnerabilities": [
      "Disabling TLS verification for registry mirrors during container image preparation.",
      "Insecurely pulling container images from the registry due to disabled TLS verification."
    ],
    "impact": "An attacker could perform a man-in-the-middle (MITM) attack, delivering tainted container images which would not be detected due to the disabled TLS verification. This could compromise the deployed Red Hat OpenStack Platform.",
    "attack_vectors": [
      "MITM attack during the pulling of container images from registry mirrors.",
    ],
    "required_capabilities": [
      "Ability to intercept network traffic between the RHOSP Director and registry mirrors."
    ],
    "affected_products": [
      "Red Hat OpenStack Platform 17.1 for RHEL 8 x86_64",
      "Red Hat OpenStack Platform 17.1 for RHEL 9 x86_64"
    ],
        "root_cause": "The vulnerability exists because the RHOSP Director disables TLS verification for registry mirrors if the initial TLS verification fails. This mechanism is intended to allow for registry mirrors with self-signed certificates, but it creates a security risk by allowing unverified image pulls.",
    "additional_details": "The issue is present in the openstack-tripleo-common component of the Red Hat OpenStack Platform (RHOSP) director. The configuration parameter DockerInsecureRegistries sets insecure=true for the affected registry in /etc/containers/registry.conf on all hosts during deployment."
  }
}
```