- **Root cause of vulnerability:** The vulnerability stems from the ability to execute code templates within Nuclei by using the `-w` (workflow file) option, even though it is intended for workflow files and not template files. By crafting a malicious YAML file that includes a `code` section and a `workflows` section, a user can trigger the execution of arbitrary commands.
- **Weaknesses/vulnerabilities present:**
    - Unsigned code template execution: The application allows the execution of code templates without requiring a signature, which is not intended for execution via the `-w` flag.
    - Misinterpretation of workflow files: The application misinterprets a specially crafted YAML file with a `workflows` field and `code` field, treating it as a valid workflow file when it should be treated as a malicious template file.
- **Impact of exploitation:** An attacker can execute arbitrary commands on the system running Nuclei. In web applications that inherit Nuclei and allow users to edit and execute workflow files, this can lead to severe consequences including compromising the server and/or connected systems.
- **Attack vectors:**
    - The primary attack vector is through the `-w` command-line option of Nuclei, which is intended for workflow files.
    - An attacker needs to craft a malicious YAML file containing the `code` and `workflows` section.
- **Required attacker capabilities/position:**
    - An attacker needs to have the ability to execute Nuclei with the crafted malicious YAML file using the `-w` option.
    - They also need the ability to specify the target using the `-u` option to trigger the code template execution.
    - In the case of inherited web applications, an attacker needs the ability to edit and execute workflow files within those web applications.