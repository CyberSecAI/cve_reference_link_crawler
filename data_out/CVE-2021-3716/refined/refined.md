```
{
  "vulnerability_details": {
    "root_cause": "The vulnerability stems from nbdkit improperly caching plaintext state across the STARTTLS encryption boundary.",
    "weaknesses": [
      "Improper caching of plaintext state",
      "Lack of proper handling of NBD_OPT_STRUCTURED_REPLY before STARTTLS"
    ],
    "impact": "A Man-in-the-Middle (MitM) attacker can inject a plaintext NBD_OPT_STRUCTURED_REPLY before the TLS handshake, potentially causing a denial-of-service on the client. The client may terminate the NBD session due to unexpected structured replies.",
    "attack_vectors": [
      "Man-in-the-Middle (MitM) attack",
      "Network traffic modification"
    ],
    "attacker_capabilities": "The attacker needs to be positioned to intercept and modify network traffic between the NBD client and server. They must be able to inject a plaintext NBD_OPT_STRUCTURED_REPLY before the STARTTLS handshake.",
     "additional_details": "The vulnerability was introduced in nbdkit v1.11.8 with the implementation of NBD Structured Replies. The issue is only exploitable when nbdkit is in opportunistic TLS mode (--tls=on). Using forced TLS mode (--tls=require) prevents this attack.  The NBD specification has been tightened to declare this behaviour as a security hole."
  }
}
```