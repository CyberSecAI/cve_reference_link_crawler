Based on the provided content, here's a breakdown of the vulnerability:

**Root Cause:**
The vulnerability stems from the insecure handling of uploaded ZIP files in the `install.php` file within the LeptonCMS backend. Specifically, the system extracts the uploaded ZIP archive without proper sanitization and then directly includes a file named `info.php` if it exists within the archive. This lack of filtering on extracted files allows for arbitrary PHP code execution.

**Weaknesses/Vulnerabilities Present:**
*   **Arbitrary File Upload:** The system allows the upload of ZIP files without validating their contents.
*   **Unsafe File Extraction:** The system extracts ZIP files to a temporary location, without sanitizing filenames, leading to the potential for overwriting important system files with carefully crafted archives.
*   **Unrestricted File Inclusion:**  The `install.php` script blindly includes `info.php` from the extracted ZIP, which can contain arbitrary PHP code, if present.
* **Lack of Input Sanitization:** The system does not sanitize or validate the content of the uploaded file (ZIP archive) or its extracted contents.
* **Path Traversal:** Although not explicitly demonstrated, the lack of sanitization in the extraction process could potentially allow for path traversal vulnerabilities, where an attacker could include a malicious file from outside the intended extraction directory.

**Impact of Exploitation:**
*   **Arbitrary Code Execution:** An attacker can execute arbitrary PHP code on the server by crafting a malicious ZIP file containing a `info.php` file with PHP code. This can lead to full system compromise.
*   **Complete System Takeover:** Successful exploitation can allow attackers to read/write/delete files, access sensitive data, modify the website, and potentially gain complete control of the web server.

**Attack Vectors:**
*   **File Upload:** The primary attack vector is through the file upload functionality within the LeptonCMS backend.
* **ZIP Archive:** The attacker crafts a ZIP archive containing a malicious PHP file named `info.php`.
*   **Web Interface:** The attack is performed through the web interface, specifically the template installation page.

**Required Attacker Capabilities/Position:**
*   **Authentication:** The attacker needs to be authenticated to the LeptonCMS backend to access the vulnerable upload functionality. This typically implies having administrator or another privileged account.
*   **Knowledge of the Vulnerability:** The attacker needs to be aware of the file upload vulnerability within the `install.php` file and how to exploit it.
*   **File Creation:** The attacker needs to be able to create a specially crafted ZIP file.

**Additional Information:**

The provided content gives detailed information about the vulnerability, how to reproduce it, and the vulnerable code, which is more than the general CVE description. It clearly outlines the following steps:

1.  **Setup:** Download and install LeptonCMS v7.1.0.
2.  **Access:** Log into the backend.
3.  **Create Malicious Files:** Create a `index.php` file and a `info.php` file containing malicious code.
4.  **Archive:** Compress these files into a zip archive named `1.zip`.
5.  **Upload:** Upload `1.zip` via the backend's template upload functionality.
6.  **Exploit:** Execute the malicious code by triggering the `install.php` script's inclusion of the `info.php` file.

The content also suggests mitigation: modify the module to detect malicious code before including `info.php`.