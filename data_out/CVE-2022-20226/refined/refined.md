Based on the provided information, here's an analysis of CVE-2022-20226:

**Root Cause of Vulnerability:**

The vulnerability arises from inadequate permission checks on the `Transaction` interface in Android's SurfaceFlinger. Specifically, the `setTrustedOverlay` and `setInputWindowInfo` fields within the `Transaction` interface require permission to be applied. These permission checks were initially implemented by verifying the PID and UID of the process sending the transaction. However, the widespread use of transaction merging rendered this method insufficient.

**Weaknesses/Vulnerabilities Present:**

*   **Insufficient Permission Checks:**  The initial implementation relied on PID and UID checks, which are bypassed by transaction merging. This allows a process without necessary permissions to potentially set `setTrustedOverlay` and `setInputWindowInfo`.

*   **Lack of Proper Sanitization:** Transactions were not being properly sanitized as they moved between client and system processes, specifically when merged transactions are sent.

**Impact of Exploitation:**

*   **Elevation of Privilege (EoP):** An attacker could potentially manipulate the `setTrustedOverlay` and `setInputWindowInfo` fields, which are intended to be restricted. This could allow them to gain more control over the display or input behavior than they are normally authorized.
* The specific impact would depend on what the attacker is able to do via the manipulated `setTrustedOverlay` and `setInputWindowInfo`.

**Attack Vectors:**

*   **Transaction Merging:** The primary attack vector involves exploiting transaction merging, which bypasses the original permission checks based on PID and UID. A malicious process can inject privileged operations (through setTrustedOverlay or setInputWindowInfo) into a transaction that will eventually reach SurfaceFlinger.

**Required Attacker Capabilities/Position:**

*   **Ability to send transactions to SurfaceFlinger:** An attacker needs to be able to send transactions which get merged with other transactions before reaching SurfaceFlinger.
*   **Understanding of Transaction Merging:** They would need to understand how transaction merging works to be able to exploit this vulnerability.

**Additional Notes:**
*   The fix implements a `sanitize` method in the `Transaction` class that is called at the boundary of `IWindowSession#finishDrawing`, ensuring that only permitted operations are carried through.
*   The commit message suggests that moving forward, security-sensitive interfaces should be moved off of the `Transaction` class and that many permissions are for use-cases, and not security.
*   The vulnerability was addressed by sanitizing transactions at the `IWindowSession#finishDrawing` boundary, indicating this as the point where transactions transition from client to system processes.
*   The information contained in the provided document goes into detail about the technical implementation of the fix, which is more detailed than the official CVE description.