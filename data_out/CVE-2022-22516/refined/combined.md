=== Content from customers.codesys.com_0529c2d8_20250108_111304.html ===
Advisory 2022-03
Security update for SysDrv3S

Published: 27 June 2023

© CODESYS Group

Version: 3.0
Template: templ_tecdoc_en_V3.0.docx
File name: Advisory2022-03_CDS-77172.docx

Page

3

3

3
3
3
3

3

3
3
3
4

4

4

5

5

5

6

6

CONTENT

1

2

2.1
2.2
2.3
2.4

3

3.1
3.2
3.3
3.4

4

5

6

7

8

Affected Products

Vulnerability overview

Type
Management Summary
References
Severity Rating

Vulnerability details

Detailed Description
Exploitability
Difficulty
Existence of exploit

Available software updates

Mitigation

Acknowledgments

Further Information

Disclaimer

Bibliography

Change History

x
c
o
d
0

.

.

3
V
_
n
e
_
c
o
d
c
e

t

l

_
p
m
e

t

:

l

t

e
a
p
m
e
T

© CODESYS Group

3/6

Advisory 2022-03

1  Affected Products

The SysDrv3S.sys driver is affected in all versions prior V3.5.18.0. This driver is used on systems with the
Microsoft Windows operating system to handle PC fieldbus cards like the Hilscher CIF or CIFX by the following
CODESYS V2 and CODESYS V3 products:

• CODESYS Control RTE (SL)
• CODESYS Control RTE (for Beckhoff CX) SL
• CODESYS Control Win (SL)
• CODESYS PLCWinNT V2
• CODESYS SP RTE V2

The driver is delivered as part of the above products and the CODESYS Development System V2 and V3 setup.

The SysDrv3S.sys is not automatically installed by running the CODESYS setup, but must be explicitly selected
manually during setting up the PC fieldbus card and then installed with admin rights.

Systems on which the CODESYS product setups were installed without taking these additional steps to install
the SysDrv3S.sys driver are not affected by this vulnerability.

2  Vulnerability overview

2.1  Type

CWE-732: Incorrect Permission Assignment for Critical Resource [7]

2.2  Management Summary

The SysDrv3S driver allows to map arbitrary physical addresses into the own process space and to access
them.

2.3  References

CVE: CVE-2022-22516 [6]

CODESYS JIRA: CDS-77172, LCDS-375

2.4  Severity Rating

CODESYS GmbH has rated this vulnerability as high.

The CVSS v3.1 base score of 7.8 has been assigned. The CVSS vector string is
(CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H). [8]

3  Vulnerability details

3.1  Detailed Description

The CODESYS Control runtime system enables embedded or PC-based devices to be a programmable
industrial controller. On systems with the Microsoft Windows operating system, the CODESYS Control runtime
system uses the SysDrv3S.sys driver to access PC fieldbus cards and thus to be able to address remote IOs.
The driver is used to handle Hilscher CIF and CIFX and similar PC fieldbus cards.

The affected versions of the driver allow each user to map arbitrary physical addresses in his own process
space. Consequently, any system user can read and write to this memory.

3.2  Exploitability

This vulnerability could be exploited locally.

3.3  Difficulty

An attacker with high skills would be able to exploit this vulnerability.

© CODESYS Group

x
c
o
d
0

.

.

3
V
_
n
e
_
c
o
d
c
e

t

l

_
p
m
e

t

:

l

t

e
a
p
m
e
T

4/6

Advisory 2022-03

3.4  Existence of exploit

No known public exploits specifically target this vulnerability in CODESYS products.

4  Available software updates

CODESYS GmbH has released version V3.5.18.0 of the driver SysDrv3S.sys and the following product setups
containing this new driver version to fix the identified security vulnerability:
• CODESYS Control RTE (SL)
• CODESYS Control RTE (for Beckhoff CX) SL
• CODESYS Control Win (SL)
• CODESYS Development System V3

The CODESYS Development System and the products available as CODESYS AddOns can be downloaded
and installed directly with the CODESYS Installer, which is part of the CODESYS Development System as of
version V3.5.17.0.

Alternatively, as well as for all other products, you will find further information on obtaining the software update
in the CODESYS Update area [3].

To make the fix effective, you have to update the SysDrv3S.sys driver to version V3.5.18.0 or higher manually:
• In the Microsoft Windows Device Manager right-click on the Hilscher device to open the context menu.
• Select Update driver within this.
• Install the driver from the subdirectory "./Driver" of your CODESYS Development System V3 or CODESYS
Control installation directory.
• Check the driver version after the update. The driver must have version number 3.5.18.0 or higher.

The SysDrv3S.sys V3.5.18.0 and higher supports the Hilscher PC fieldbus cards only. Thus, the following
hardware can no longer be used with the SysDrv3S.sys driver:
• "SysDrv3S Automata CAN PCI 2N" = SysDrv3S, PCI\VEN_10B5&DEV_9050&SUBSYS_34551971”
• "SysDrv3S Peak PCAN-PCI" = SysDrv3S, PCI\VEN_001C&DEV_0001&SUBSYS_0004001C”
• "SysDrv3S Peak PCAN-EXPRESS" = SysDrv3S, PCI\VEN_001C&DEV_0003&SUBSYS_0002001C”

Please contact the CODESYS support [5], if you need to use this driver with one of the PC fieldbus cards listed
above or any other currently unsupported hardware.

--------------------

CODESYS V2

For the affected CODESYS V2 products, CODESYS GmbH has released SysDrv3S V3.5.19.10. As of this
version, the SysDrv3S supports both CODESYS V2 and CODESYS V3 runtime systems. Version V3.5.19.10 of
the SysDrv3S is shipped with CODESYS Development System V2 Setup V2.3.9.71 and also as part of
CODESYS V3 Setup V3.5.19.10 or higher.

To make the fix effective for CODESYS V2 runtime systems, you have to update the SysDrv3S.sys driver
manually to version V3.5.19.10. See description above.

5  Mitigation

CODESYS GmbH recommends using the available software update to fix the vulnerability.

Currently, CODESYS GmbH has not identified any specific workarounds for this vulnerability, in case the
software update is not applied.

As part of a security strategy, CODESYS GmbH recommends the following general defense measures to
reduce the risk of exploits:
• Use controllers and devices only in a protected environment to minimize network exposure and ensure that
they are not accessible from outside
• Use firewalls to protect and separate the control system network from other networks
• Use VPN (Virtual Private Networks) tunnels if remote access is required

© CODESYS Group

x
c
o
d
0

.

.

3
V
_
n
e
_
c
o
d
c
e

t

l

_
p
m
e

t

:

l

t

e
a
p
m
e
T

5/6

Advisory 2022-03

• Activate and apply user management and password features
• Use encrypted communication links
• Limit the access to both development and control system by physical means, operating system features, etc.
• Protect both development and control system by using up to date virus detecting solutions
For more information and general recommendations for protecting machines and plants, see also the
CODESYS Security Whitepaper [1].

6  Acknowledgments

The vulnerability was discovered by Denis Goryushev of Positive Technologies.

CODESYS GmbH thanks for reporting following coordinated disclosure. This helps us to improve our products
and to protect customers and users.

7  Further Information

For additional information regarding the CODESYS products, especially the above-mentioned versions, or about
the described vulnerability please contact the CODESYS support team [5].

8  Disclaimer

CODESYS GmbH assumes no liability whatsoever for indirect, collateral, accidental or consequential losses
that occur by the distribution and/or use of this document or any losses in connection with the distribution and/or
use of this document. All information published in this document is provided on good faith by CODESYS GmbH.
Insofar as permissible by law, however, none of this information shall establish any guarantee, commitment or
liability on the part of CODESYS GmbH.

Note: Not all CODESYS features are available in all territories. For more information on geographic restrictions,
please contact sales@codesys.com.

x
c
o
d
0

.

.

3
V
_
n
e
_
c
o
d
c
e

t

l

_
p
m
e

t

:

l

t

e
a
p
m
e
T

© CODESYS Group

6/6

Advisory 2022-03

Bibliography

[1]  CODESYS GmbH: CODESYS Security Whitepaper
[2]  CODESYS GmbH: Coordinated Disclosure Policy
[3]  CODESYS GmbH update area: https://www.codesys.com/download
[4]  CODESYS GmbH security information page: https://www.codesys.com/security
[5]  CODESYS GmbH support contact site: https://www.codesys.com/support
[6]  Common Vulnerabilities and Exposures (CVE): https://cve.mitre.org
[7]  Common Weakness Enumeration (CWE): https://cwe.mitre.org
[8]  CVSS Calculator: https://www.first.org/cvss/calculator/3.1
[9]  ICS-CERT: https://ics-cert.us-cert.gov

The latest version of this document can be found here:

https://customers.codesys.com/index.php?eID=dumpFile&t=f&f=17090&token=6cd08b169916366df31388d2e7
ba58e7bce93508&download=

Change History

Version  Description

1.0

2.0

3.0

First version

Software update available

CVSS vector adapted, CODESYS V2.3 update

Date

24.03.2022

06.04.2022

27.06.2023

x
c
o
d
0

.

.

3
V
_
n
e
_
c
o
d
c
e

t

l

_
p
m
e

t

:

l

t

e
a
p
m
e
T

© CODESYS Group


