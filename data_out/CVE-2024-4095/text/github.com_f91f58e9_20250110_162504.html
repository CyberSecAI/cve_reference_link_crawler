
[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fbaden03%2Fcollapse-o-matic%2Fblob%2F561d8ab53a03e44c12234ba9687226fdbb5054cc%2Fcollapse-o-matic.php)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fbaden03%2Fcollapse-o-matic%2Fblob%2F561d8ab53a03e44c12234ba9687226fdbb5054cc%2Fcollapse-o-matic.php)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=baden03%2Fcollapse-o-matic)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[baden03](/baden03)
/
**[collapse-o-matic](/baden03/collapse-o-matic)**
Public

* [Notifications](/login?return_to=%2Fbaden03%2Fcollapse-o-matic) You must be signed in to change notification settings
* [Fork
  7](/login?return_to=%2Fbaden03%2Fcollapse-o-matic)
* [Star
   6](/login?return_to=%2Fbaden03%2Fcollapse-o-matic)

* [Code](/baden03/collapse-o-matic)
* [Issues
  1](/baden03/collapse-o-matic/issues)
* [Pull requests
  0](/baden03/collapse-o-matic/pulls)
* [Actions](/baden03/collapse-o-matic/actions)
* [Projects
  0](/baden03/collapse-o-matic/projects)
* [Wiki](/baden03/collapse-o-matic/wiki)
* [Security](/baden03/collapse-o-matic/security)
* [Insights](/baden03/collapse-o-matic/pulse)

Additional navigation options

* [Code](/baden03/collapse-o-matic)
* [Issues](/baden03/collapse-o-matic/issues)
* [Pull requests](/baden03/collapse-o-matic/pulls)
* [Actions](/baden03/collapse-o-matic/actions)
* [Projects](/baden03/collapse-o-matic/projects)
* [Wiki](/baden03/collapse-o-matic/wiki)
* [Security](/baden03/collapse-o-matic/security)
* [Insights](/baden03/collapse-o-matic/pulse)

## Files

 561d8ab
## Breadcrumbs

1. [collapse-o-matic](/baden03/collapse-o-matic/tree/561d8ab53a03e44c12234ba9687226fdbb5054cc)
/
# collapse-o-matic.php

Copy path Blame  Blame
## Latest commit

## History

[History](/baden03/collapse-o-matic/commits/561d8ab53a03e44c12234ba9687226fdbb5054cc/collapse-o-matic.php)executable file·976 lines (875 loc) · 41 KB 561d8ab
## Breadcrumbs

1. [collapse-o-matic](/baden03/collapse-o-matic/tree/561d8ab53a03e44c12234ba9687226fdbb5054cc)
/
# collapse-o-matic.php

Top
## File metadata and controls

* Code
* Blame

executable file·976 lines (875 loc) · 41 KB[Raw](https://github.com/baden03/collapse-o-matic/raw/561d8ab53a03e44c12234ba9687226fdbb5054cc/collapse-o-matic.php)123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257258259260261262263264265266267268269270271272273274275276277278279280281282283284285286287288289290291292293294295296297298299300301302303304305306307308309310311312313314315316317318319320321322323324325326327328329330331332333334335336337338339340341342343344345346347348349350351352353354355356357358359360361362363364365366367368369370371372373374375376377378379380381382383384385386387388389390391392393394395396397398399400401402403404405406407408409410411412413414415416417418419420421422423424425426427428429430431432433434435436437438439440441442443444445446447448449450451452453454455456457458459460461462463464465466467468469470471472473474475476477478479480481482483484485486487488489490491492493494495496497498499500501502503504505506507508509510511512513514515516517518519520521522523524525526527528529530531532533534535536537538539540541542543544545546547548549550551552553554555556557558559560561562563564565566567568569570571572573574575576577578579580581582583584585586587588589590591592593594595596597598599600601602603604605606607608609610611612613614615616617618619620621622623624625626627628629630631632633634635636637638639640641642643644645646647648649650651652653654655656657658659660661662663664665666667668669670671672673674675676677678679680681682683684685686687688689690691692693694695696697698699700701702703704705706707708709710711712713714715716717718719720721722723724725726727728729730731732733734735736737738739740741742743744745746747748749750751752753754755756757758759760761762763764765766767768769770771772773774775776777778779780781782783784785786787788789790791792793794795796797798799800801802803804805806807808809810811812813814815816817818819820821822823824825826827828829830831832833834835836837838839840841842843844845846847848849850851852853854855856857858859860861862863864865866867868869870871872873874875876877878879880881882883884885886887888889890891892893894895896897898899900901902903904905906907908909910911912913914915916917918919920921922923924925926927928929930931932933934935936937938939940941942943944945946947948949950951952953954955956957958959960961962963964965966967968969970971972973974975976<?php/\*Plugin Name: Collapse-O-MaticText Domain: jquery-collapse-o-maticPlugin URI: https://pluginoven.com/plugins/collapse-o-matic/Description: Collapse-O-Matic adds an [expand] shortcode that wraps content into a lovely, jQuery collapsible div.Version: 1.8.5.6Author: twinpictures, baden03Author URI: https://twinpictures.de/License: GPL2\*/
/\*\* \* Class WP\_Collapse\_O\_Matic \* @package WP\_Collapse\_O\_Matic \* @category WordPress Plugins \*/
if(!defined('PLUGIN\_OVEN\_URL')){ define( 'PLUGIN\_OVEN\_URL', 'https://pluginoven.com/' );}if(!defined('PLUGIN\_OVEN\_CC')){ define( 'PLUGIN\_OVEN\_CC', 'Collapse Commander' );}
class WP\_Collapse\_O\_Matic {
 /\*\* \* Current version \* @var string \*/ var $version = '1.8.5.6';
 /\*\* \* Used as prefix for options entry \* @var string \*/ var $domain = 'colomat';
 /\*\* \* Name of the options \* @var string \*/ var $options\_name = 'WP\_Collapse\_O\_Matic\_options';
 /\*\* \* @var array \*/ var $options = array( 'style' => 'light', 'cid' => '', 'tag' => 'span', 'trigclass' => '', 'targtag' => 'div', 'targclass' => '', 'notitle' => '', 'duration' => 'fast', 'tabindex' => '0', 'slideEffect' => 'slideFade', 'custom\_css' => '', 'script\_check' => '', 'css\_check' => '', 'script\_location' => 'footer', 'cc\_download\_key' => '', 'cc\_email' => '', 'filter\_content' => '', 'pauseinit' => '', 'cc\_display\_id' => '', 'cc\_display\_title' => '', 'touch\_start' => '', );
 var $license\_group = 'colomat\_licenseing';
 var $license\_name = 'WP\_Collapse\_O\_Matic\_license';
 var $license\_options = array( 'collapse\_commander\_license\_key' => '', 'collapse\_commander\_license\_status' => '' );
 /\*\* \* PHP5 constructor \*/ function \_\_construct() { // set option values $this->\_set\_options();
 // load text domain for translations load\_plugin\_textdomain( 'jquery-collapse-o-matic' );
 //load the script and style if viewing the front-end add\_action('wp\_enqueue\_scripts', array( $this, 'collapsTronicInit' ) ); add\_action('admin\_enqueue\_scripts', array( $this, 'codemirror\_enqueue\_scripts') );
 // add actions add\_action( 'admin\_menu', array( $this, 'admin\_menu' ) ); add\_action( 'plugin\_action\_links\_' . plugin\_basename(\_\_FILE\_\_), array( $this, 'plugin\_actions' ) ); add\_action( 'admin\_init', array( $this, 'admin\_init' ) ); add\_shortcode('expand', array($this, 'shortcode')); add\_shortcode('colomat', array($this, 'shortcode'));
 //add expandsub shortcodes for ($i=1; $i<30; $i++) { add\_shortcode('expandsub'.$i, array($this, 'shortcode')); }
 // Add shortcode support for widgets add\_filter('widget\_text', 'do\_shortcode'); }
 /\*\* \* Callback init \*/ function collapsTronicInit() { //collapse script $load\_in\_footer = false; if($this->options['script\_location'] == 'footer' ){ $load\_in\_footer = true; } wp\_register\_script('collapseomatic-js', plugins\_url('js/collapse.js', \_\_FILE\_\_), array('jquery'), '1.7.2', $load\_in\_footer);  //prep options for injection $com\_options = [ 'colomatduration' => $this->options['duration'], 'colomatslideEffect' => $this->options['slideEffect'], 'colomatpauseInit' => $this->options['pauseinit'], 'colomattouchstart' => $this->options['touch\_start'] ]; wp\_add\_inline\_script( 'collapseomatic-js', 'const com\_options = ' . json\_encode( $com\_options ), 'before' );
 if( empty($this->options['script\_check']) ){ wp\_enqueue\_script('collapseomatic-js'); }
 //css wp\_register\_style( 'collapscore-css', plugins\_url('css/core\_style.css', \_\_FILE\_\_) , array (), '1.0' ); wp\_register\_style( 'collapseomatic-css', plugins\_url('css/'.$this->options['style'].'\_style.css', \_\_FILE\_\_) , array (), '1.6' ); if( !empty( $this->options['custom\_css'] ) ){ wp\_add\_inline\_style( 'collapscore-css', $this->options['custom\_css'] ); }
 if( empty($this->options['css\_check'])){ wp\_enqueue\_style( 'collapscore-css' ); if ($this->options['style'] !== 'none') { wp\_enqueue\_style( 'collapseomatic-css' ); } } }
 function codemirror\_enqueue\_scripts($hook) { if($hook == 'settings\_page\_collapse-o-matic-options'){ wp\_register\_script('cm\_js', plugins\_url('js/admin\_codemirror.js', \_\_FILE\_\_), array('jquery'), '0.1.0', true); $cm\_settings = wp\_enqueue\_code\_editor( [ 'type' => 'text/css', 'codemirror' => [ 'lineNumbers' => true, 'autoRefresh' => true ] ] ); wp\_localize\_script('cm\_js', 'cm\_settings', $cm\_settings); wp\_enqueue\_script( 'cm\_js' ); wp\_enqueue\_script( 'wp-theme-plugin-editor' ); wp\_enqueue\_style( 'wp-codemirror' ); wp\_register\_style( 'com-admin-css', plugins\_url('css/admin\_style.css', \_\_FILE\_\_) , array (), '1.0.0' ); wp\_enqueue\_style( 'com-admin-css' ); } }
 /\*\* \* Callback admin\_menu \*/ function admin\_menu() { if ( function\_exists( 'add\_options\_page' ) AND current\_user\_can( 'manage\_options' ) ) { // add options page $page = add\_options\_page('Collapse-O-Matic Options', 'Collapse-O-Matic', 'manage\_options', 'collapse-o-matic-options', array( $this, 'options\_page' )); } }
 /\*\* \* Callback admin\_init \*/ function admin\_init() { // register settings register\_setting( $this->domain, $this->options\_name ); register\_setting( $this->license\_group, $this->license\_name, array($this, 'edd\_sanitize\_license') ); }
 /\*\* \* Callback shortcode \*/ function shortcode($atts, $content = null){ $options = $this->options; if( !empty($this->options['script\_check']) ){ wp\_enqueue\_script('collapseomatic-js'); }
 if( !empty($this->options['css\_check'])){ wp\_enqueue\_style( 'collapscore-css' ); if ($this->options['style'] !== 'none') { wp\_enqueue\_style( 'collapseomatic-css' ); } }
 //find a random number, if no id is assigned $ran = uniqid(); extract(shortcode\_atts(array( 'title' => '', 'cid' => $options['cid'], 'template\_id' => '', 'swaptitle' => '', 'alt' => '', 'swapalt' => '', 'notitle' => $options['notitle'], 'id' => 'id'.$ran, 'tag' => $options['tag'], 'trigclass' => $options['trigclass'], 'targtag' => $options['targtag'], 'targclass' => $options['targclass'], 'targpos' => '', 'trigpos' => 'above', 'rel' => '', 'group' => '', 'togglegroup' => '', 'expanded' => '', 'excerpt' => '', 'swapexcerpt' => false, 'excerptpos' => 'below-trigger', 'excerpttag' => 'div', 'excerptclass' => '', 'findme' => '', 'scrollonclose' => '', 'startwrap' => '', 'endwrap' => '', 'elwraptag' => '', 'elwrapclass' => '', 'filter' => $options['filter\_content'], 'tabindex' => $options['tabindex'], 'animation\_effect' => '', 'duration' => '', 'orderby' => '', 'order' => '' ), $atts, 'expand'));
 //collapse commander if( !empty($cid) && is\_plugin\_active( 'collapse-commander/collapse-commander.php') ){ $meta\_values = WP\_CollapseCommander::meta\_grabber($cid, $orderby, $order); extract(shortcode\_atts($meta\_values, $atts)); }
 if(!empty($triggertext)){ $title = $triggertext; } if(!empty($highlander) && !empty($rel)){ $rel .= '-highlander'; }
 //content filtering if(empty($filter) || $filter == 'false'){ $content = do\_shortcode($content); } else{ $content = apply\_filters( 'the\_content', $content ); $content = str\_replace( ']]>', ']]&gt;', $content ); }
 if( !empty($cid) && get\_edit\_post\_link($cid) ){ $content .= '<div class="com\_edit\_link"><a class="post-edit-link" href="'.get\_edit\_post\_link($cid).'">'.\_\_('Edit').'</a></div>'; }
 if( !empty($sub\_cids) ){ foreach($sub\_cids as $sub\_cid){ $args = array('cid' => $sub\_cid); $content .= $this->shortcode($args); } }
 //id does not allow spaces $id = preg\_replace('/\s+/', '\_', $id);
 $ewo = ''; $ewc = '';
 //id does not allow spaces $id = preg\_replace('/\s+/', '\_', $id);
 //placeholders $placeholder\_arr = array('%(%', '%)%', '%{%', '%}%'); $swapout\_arr = array('<', '>', '[', ']');
 $allowed\_tags = [ "div", "span", "p", "li", "ul", "ol", "strong", "b", "em", "i", "u", "h1", "h2", "h3", "h4", "h5", "h6", "blockquote", "a", "img", "tr", "td", "th", "caption", "small", "cite", "q" ];
  if(!empty($tag)){ $tag = $this->filter\_allowed\_tags( $tag, $allowed\_tags ); }
 $title = do\_shortcode(str\_replace($placeholder\_arr, $swapout\_arr, $title)); if($swaptitle){ $swaptitle = do\_shortcode(str\_replace($placeholder\_arr, $swapout\_arr, $swaptitle)); } if($startwrap){ $startwrap = do\_shortcode(str\_replace($placeholder\_arr, $swapout\_arr, $startwrap)); } if($endwrap){ $endwrap = do\_shortcode(str\_replace($placeholder\_arr, $swapout\_arr, $endwrap)); } //need to check for a few versions, because of new option setting. can be removed after a few revisiosn. if(!empty($targtag)){ $targtag = $this->filter\_allowed\_tags( $targtag, $allowed\_tags ); } else{ $targtag = 'div'; }
  if(!empty($elwraptag)){ $ewclass = ''; if($elwrapclass){ $ewclass = 'class="'.esc\_attr($elwrapclass).'"'; } $elwraptag = $this->filter\_allowed\_tags( $elwraptag, $allowed\_tags );
 $ewo = '<'. $elwraptag .' '.$ewclass.'>'; $ewc = '</'. $elwraptag .'>'; }
 $eDiv = '';
 if($content){ $inline\_class = ''; $collapse\_class = 'collapseomatic\_content '; if($targpos == 'inline'){ $inline\_class = 'colomat-inline '; $collapse\_class = 'collapseomatic\_content\_inline '; } $eDiv = '<'. esc\_attr( $targtag ) .' id="target-'.$id.'" class="'.esc\_attr($collapse\_class.$inline\_class.$targclass).'">'. $content .'</'. esc\_attr( $targtag ) .'>'; } if($excerpt){ $excerpt = str\_replace($placeholder\_arr, $swapout\_arr, $excerpt); $excerpt = do\_shortcode($excerpt); $excerpt = apply\_filters( 'colomat\_excerpt', $excerpt );
 if($targpos == 'inline'){ $excerpt .= $eDiv; $eDiv = ''; } if($excerptpos == 'above-trigger'){ $nibble = '<'. esc\_attr( $excerpttag ) .' id="excerpt-'.esc\_attr($id).'" class="'.esc\_attr($excerptclass).'">'. esc\_attr( $excerpt ).'</'. esc\_attr( $excerpttag ) .'>'; } else{ $nibble = '<'. esc\_attr( $excerpttag ) .' id="excerpt-'.esc\_attr($id).'" class="collapseomatic\_excerpt '.esc\_attr($excerptclass).'">'. esc\_attr( $excerpt ) .'</'. esc\_attr( $excerpttag ) .'>'; } //swapexcerpt if($swapexcerpt !== false){ $swapexcerpt = str\_replace($placeholder\_arr, $swapout\_arr, $swapexcerpt); $swapexcerpt = do\_shortcode($swapexcerpt); $swapexcerpt = apply\_filters( 'colomat\_swapexcerpt', $swapexcerpt ); $nibble .= '<'. esc\_attr( $excerpttag ) .' id="swapexcerpt-'.esc\_attr($id).'" style="display:none;">'. esc\_attr( $swapexcerpt ).'</'. esc\_attr( $excerpttag ) .'>'; } } $altatt = ''; if(!empty($alt)){ $altatt = 'alt="'.esc\_attr($alt).'" title="'.esc\_attr($alt).'"'; } else if( empty($notitle) ){ $altatt = 'title="'.esc\_attr($title).'"'; } $relatt = ''; if(!empty($rel)){ $relatt = 'rel="'.esc\_attr($rel).'"'; }
 $groupatt = ''; //legacy if($group && !$togglegroup){ $togglegroup = $group; }
 if($togglegroup){ $groupatt = 'data-togglegroup="'.esc\_attr($togglegroup).'"'; } $inexatt = ''; //var\_dump($tabindex); if(!empty($tabindex) || $tabindex == 0 ){ $inexatt = 'tabindex="'.esc\_attr($tabindex).'"'; } if($expanded && $expanded != 'false'){ $trigclass .= ' colomat-close'; } $anchor = ''; if($findme){ $trigclass .= ' find-me'; $offset = ''; if($findme != 'true' && $findme != 'auto'){ $offset = $findme; } //$anchor = '<input type="hidden" id="find-'.$id.'" name="'.$offset.'"/>'; $anchor = 'data-findme="'.$offset.'"'; }
 //effect $effatt = ''; if($animation\_effect){ $effatt = 'data-animation\_effect="'.esc\_attr($animation\_effect).'"'; }
 //duration $duratt = ''; if($duration){ $duratt = 'data-duration="'.esc\_attr($duration).'"'; }
 $closeanchor = ''; if($scrollonclose && (is\_numeric($scrollonclose) || $scrollonclose == 0)){ $trigclass .= ' scroll-to-trigger'; $closeanchor = '<input type="hidden" id="scrollonclose-'.esc\_attr($id).'" name="'.esc\_attr($scrollonclose).'"/>'; }
 //deal with image from collapse-commander if( !empty($trigtype) && $trigtype == 'image' && !empty($triggerimage) && strtolower($tag) == 'img' ){ $imageclass = 'collapseomatic noarrow' . esc\_attr($trigclass); $image\_atts = array( 'id' => $id, 'class' => $imageclass, 'alt' => $alt ); if(!$notitle){ $image\_atts['title'] = $alt; } $link = $closeanchor.wp\_get\_attachment\_image( $triggerimage, 'full', false, $image\_atts ); } else{ if(!empty($trigtype) && $trigtype == 'image' && !empty($triggerimage)){ $title = wp\_get\_attachment\_image( $triggerimage, 'full' ); } $link = $closeanchor.'<'. esc\_attr($tag) .' class="collapseomatic '.esc\_attr($trigclass).'" id="'.esc\_attr($id).'" '.$relatt.' '.$inexatt.' '.$altatt.' '.$anchor.' '.$groupatt.' '.$effatt.' '.$duratt.'>'.wp\_kses\_post($startwrap.$title.$endwrap).'</'. esc\_attr($tag) .'>'; }
 //swap image if( !empty($trigtype) && $trigtype == 'image' && !empty($swapimage) && strtolower($tag) == 'img' ){ $link .= wp\_get\_attachment\_image( $swapimage, 'full', false, array( 'id' => 'swap-'.$id, 'class' => 'colomat-swap', 'alt' => $swapalt, 'style' => 'display:none;' ) ); } else{ if(!empty($trigtype) && $trigtype == 'image' && !empty($swapimage)){ $swaptitle = wp\_get\_attachment\_image( $swapimage, 'full' ); } } //swap title if($swaptitle){ $swapalt\_attr = ''; if(!empty($swapalt)){ $swapalt\_attr = "alt='".esc\_attr($swapalt)."'"; } $link .= "<". esc\_attr($tag) ." id='swap-".esc\_attr($id)."' ".esc\_attr($swapalt\_attr)." class='colomat-swap' style='display:none;'>".wp\_kses\_post($startwrap.$swaptitle.$endwrap)."</". esc\_attr($tag) .">"; }
 if($excerpt){ if($excerptpos == 'above-trigger'){ if($trigpos == 'below'){ $retStr = $ewo.$eDiv.$nibble.$link.$ewc; } else{ $retStr = $ewo.$nibble.$link.$eDiv.$ewc; } } else if($excerptpos == 'below-trigger'){ if($trigpos == 'below'){ $retStr = $ewo.$eDiv.$link.$nibble.$ewc; } else{ $retStr = $ewo.$link.$nibble.$eDiv.$ewc; } } else{ if($trigpos == 'below'){ $retStr = $ewo.$eDiv.$link.$nibble.$ewc; } else{ $retStr = $ewo.$link.$eDiv.$nibble.$ewc; } } } else{ if($trigpos == 'below'){ $retStr = $ewo.$eDiv.$link.$ewc; } else{ $retStr = $ewo.$link.$eDiv.$ewc; } } return $retStr; }
 // Add link to options page from plugin list function plugin\_actions($links) { $new\_links = array(); $new\_links[] = '<a href="options-general.php?page=collapse-o-matic-options">' . \_\_('Settings', 'jquery-collapse-o-matic') . '</a>'; return array\_merge($new\_links, $links); }
 /\*\* \* Admin options page \*/ function options\_page() { $like\_it\_arr = array( \_\_('really tied the room together', 'jquery-collapse-o-matic'), \_\_('made you feel all warm and fuzzy on the inside', 'jquery-collapse-o-matic'), \_\_('restored your faith in humanity... even if only for a fleeting second', 'jquery-collapse-o-matic'), \_\_('rocked your world', 'provided a positive vision of future living', 'jquery-collapse-o-matic'), \_\_('inspired you to commit a random act of kindness', 'jquery-collapse-o-matic'), \_\_('encouraged more regular flossing of the teeth', 'jquery-collapse-o-matic'), \_\_('helped organize your life in the small ways that matter', 'jquery-collapse-o-matic'), \_\_('saved your minutes--if not tens of minutes--writing your own solution', 'jquery-collapse-o-matic'), \_\_('brightened your day... or darkened if if you are trying to sleep in', 'jquery-collapse-o-matic'), \_\_('caused you to dance a little jig of joy and joyousness', 'jquery-collapse-o-matic'), \_\_('inspired you to tweet a little @twinpictues social love', 'jquery-collapse-o-matic'), \_\_('tasted great, while also being less filling', 'jquery-collapse-o-matic'), \_\_('caused you to shout: "everybody spread love, give me some mo!"', 'jquery-collapse-o-matic'), \_\_('helped you keep the funk alive', 'jquery-collapse-o-matic'), \_\_('<a href="https://www.youtube.com/watch?v=dvQ28F5fOdU" target="\_blank">soften hands while you do dishes</a>', 'jquery-collapse-o-matic'), \_\_('helped that little old lady <a href="https://www.youtube.com/watch?v=Ug75diEyiA0" target="\_blank">find the beef</a>', 'jquery-collapse-o-matic') ); $rand\_key = array\_rand($like\_it\_arr); $like\_it = $like\_it\_arr[$rand\_key]; ?> <div class="wrap"> <h2>Collapse-O-Matic</h2> </div>
 <div class="postbox-container metabox-holder meta-box-sortables" style="width: 69%"> <div style="margin:0 5px;"> <div class="postbox"> <div class="handlediv" title="<?php \_e( 'Click to toggle', 'jquery-collapse-o-matic' ) ?>"><br/></div> <h3 class="hndle"><?php \_e( 'Default Collapse-O-Matic Settings', 'jquery-collapse-o-matic' ) ?></h3> <div class="inside"> <form method="post" action="options.php"> <?php settings\_fields( $this->domain ); $options = $this->options; ?> <fieldset class="options"> <table class="form-table"> <tr> <th><?php \_e( 'Style', 'jquery-collapse-o-matic' ) ?>:</th> <td><label><select id="style" name="<?php echo esc\_attr($this->options\_name); ?>[style]"> <?php if(empty($options['style'])){ $options['style'] = 'light'; } $st\_array = array( \_\_('Light', 'jquery-collapse-o-matic') => 'light', \_\_('Dark', 'jquery-collapse-o-matic') => 'dark', \_\_('None', 'jquery-collapse-o-matic') => 'none' ); foreach( $st\_array as $key => $value){ $selected = ''; if($options['style'] == $value){ $selected = 'SELECTED'; } echo '<option value="'.esc\_attr($value).'" '.$selected.'>'.esc\_attr($key).'</option>'; } ?> </select> <br /><span class="description"><?php \_e('Select Light for sites with lighter backgrounds. Select Dark for sites with darker backgrounds. Select None to handle styling yourself.', 'jquery-collapse-o-matic'); ?></span></label> </td> </tr>
 <?php if( is\_plugin\_active( 'collapse-commander/collapse-commander.php' ) ) : ?> <tr> <th><?php \_e( 'CID Attribute', 'jquery-collapse-o-matic' ) ?>:</th> <td><label><input type="text" id="cid" name="<?php echo esc\_attr($this->options\_name); ?>[cid]" value="<?php echo esc\_attr($options['cid']); ?>" /> <br /><span class="description"><?php printf( \_\_('Default %sCollapse Commander%s ID', 'jquery-collapse-o-matic'), '<a href="https://pluginoven.com/premium-plugins/collapse-commander/" target="\_blank">', '</a>'); ?></span></label> </td> </tr> <?php else: ?> <tr> <th><?php \_e( 'Collapse Management', 'colpromat' ) ?></th> <td><?php printf(\_\_( '%sCollapse Commander%s is an add-on plugin that introduces an advanced management interface to better organize expand elements and simplify expand shortcodes.', 'colpromat' ), '<a href="https://pluginoven.com/premium-plugins/collapse-commander/">', '</a>'); ?> </td> </tr> <?php endif; ?>
 <tr> <th><?php \_e( 'Tag Attribute', 'jquery-collapse-o-matic' ) ?>:</th> <td><label><input type="text" id="tag" name="<?php echo esc\_attr($this->options\_name); ?>[tag]" value="<?php echo esc\_attr($options['tag']); ?>" /> <br /><span class="description"><?php printf(\_\_('HTML tag use to wrap the trigger text. See %sTag Attribute%s in the documentation for more info.', 'jquery-collapse-o-matic'), '<a href="https://pluginoven.com/plugins/collapse-o-matic/documentation/shortcode/#tag-attribute" target="\_blank">', '</a>'); ?></span></label> </td> </tr>
 <tr> <th><?php \_e( 'Trigclass Attribute', 'jquery-collapse-o-matic' ) ?>:</th> <td><label><input type="text" id="trigclass" name="<?php echo esc\_attr($this->options\_name); ?>[trigclass]" value="<?php echo esc\_attr($options['trigclass']); ?>" /> <br /><span class="description"><?php printf(\_\_('Default class assigned to the trigger element. See %sTrigclass Attribute%s in the documentation for more info.', 'jquery-collapse-o-matic'), '<a href="https://pluginoven.com/plugins/collapse-o-matic/documentation/shortcode/#trigclass-attribute" target="\_blank">', '</a>'); ?></span></label> </td> </tr>
 <tr> <th><?php \_e( 'Tabindex Attribute', 'jquery-collapse-o-matic' ) ?>:</th> <td><label><input type="text" id="tabindex" name="<?php echo esc\_attr($this->options\_name); ?>[tabindex]" value="<?php echo esc\_attr($options['tabindex']); ?>" /> <br /><span class="description"><?php printf(\_\_('Default tabindex value to be assigned to the trigger element. See %sTabindex Attribute%s in the documentation for more info.', 'jquery-collapse-o-matic'), '<a href="https://pluginoven.com/plugins/collapse-o-matic/documentation/shortcode/#tabindex-attribute" target="\_blank">', '</a>'); ?></span></label> </td> </tr>
 <tr> <th><?php \_e( 'Targtag Attribute', 'jquery-collapse-o-matic' ) ?>:</th> <td><label><input type="text" id="targtag" name="<?php echo esc\_attr($this->options\_name); ?>[targtag]" value="<?php echo esc\_attr($options['targtag']); ?>" /> <br /><span class="description"><?php printf(\_\_('HTML tag use for the target element. See %sTargtag Attribute%s in the documentation for more info.', 'jquery-collapse-o-matic'), '<a href="https://pluginoven.com/plugins/collapse-o-matic/documentation/shortcode/#targtag-attribute" target="\_blank">', '</a>'); ?></span></label> </td> </tr>
 <tr> <th><?php \_e( 'Targclass Attribute', 'jquery-collapse-o-matic' ) ?>:</th> <td><label><input type="text" id="targclass" name="<?php echo esc\_attr($this->options\_name); ?>[targclass]" value="<?php echo esc\_attr($options['targclass']); ?>" /> <br /><span class="description"><?php printf(\_\_('Default class assigned to the target element. See %sTargclass Attribute%s in the documentation for more info.', 'jquery-collapse-o-matic'), '<a href="https://pluginoven.com/plugins/collapse-o-matic/documentation/shortcode/#targclass-attribute" target="\_blank">', '</a>'); ?></span></label> </td> </tr>
 <tr> <th><?php \_e( 'No Title', 'jquery-collapse-o-matic' ) ?>:</th> <td><label><input type="checkbox" id="notitle" name="<?php echo esc\_attr($this->options\_name); ?>[notitle]" value="1" <?php echo checked( $options['notitle'], 1 ); ?> /> <?php \_e('No Title', 'jquery-collapse-o-matic'); ?> <br /><span class="description"><?php \_e('Do not use title tags by default.', 'jquery-collapse-o-matic'); ?></span></label> </td> </tr>
 <tr> <th><?php \_e( 'Add touchstart', 'jquery-collapse-o-matic' ) ?>:</th> <td><label><input type="checkbox" id="touch\_start" name="<?php echo esc\_attr($this->options\_name); ?>[touch\_start]" value="1" <?php echo checked( $options['touch\_start'], 1 ); ?> /> <?php \_e('Add touchstart', 'jquery-collapse-o-matic'); ?> <br /><span class="description"><?php \_e('Add jQuery touchstart binding to triggers.', 'jquery-collapse-o-matic'); ?></span></label> </td> </tr>
 <tr> <th><?php \_e( 'Initial Pause', 'jquery-collapse-o-matic' ) ?>:</th> <td><label><input type="number" id="pauseinit" name="<?php echo esc\_attr($this->options\_name); ?>[pauseinit]" value="<?php echo esc\_attr($options['pauseinit']); ?>" /> <br /><span class="description"><?php \_e('Amount of time in milliseconds to pause before the initial collapse is triggered on page load.', 'jquery-collapse-o-matic'); ?></span></label> </td> </tr>
 <tr> <?php if(empty($options['duration'])){ $options['duration'] = 'fast'; } ?> <th><?php \_e( 'Animation Duration', 'jquery-collapse-o-matic' ) ?>:</th> <td><label><input type="text" id="duration" name="<?php echo esc\_attr($this->options\_name); ?>[duration]" value="<?php echo esc\_attr($options['duration']); ?>" /> <br /><span class="description"><?php printf(\_\_('A string or number determining how long the animation will run. See %sDuration%s in the documentation for more info.', 'jquery-collapse-o-matic'), '<a href="https://plugins.twinpictures.de/plugins/collapse-o-matic/documentation/#duration" target="\_blank">', '</a>'); ?></span></label> </td> </tr>
 <tr> <th><?php \_e( 'Animation Effect', 'jquery-collapse-o-matic' ) ?>:</th> <td><label><select id="slideEffect" name="<?php echo esc\_attr($this->options\_name); ?>[slideEffect]"> <?php if(empty($options['slideEffect'])){ $options['slideEffect'] = 'slideFade'; } $se\_array = array( \_\_('Slide Only', 'jquery-collapse-o-matic') => 'slideToggle', \_\_('Slide & Fade', 'jquery-collapse-o-matic') => 'slideFade', \_\_('Fade Only', 'jquery-collapse-o-matic') => 'fadeOnly' ); foreach( $se\_array as $key => $value){ $selected = ''; if($options['slideEffect'] == $value){ $selected = 'SELECTED'; } echo '<option value="'.esc\_attr($value).'" '.$selected.'>'.esc\_attr($key).'</option>'; } ?> </select> <br /><span class="description"><?php printf(\_\_('Animation effect to use while collapsing and expanding. See %sAnimation Effect%s in the documentation for more info.', 'jquery-collapse-o-matic'), '<a href="https://plugins.twinpictures.de/plugins/collapse-o-matic/documentation/#animation-effect" target="\_blank">', '</a>'); ?></span></label> </td> </tr>
 <tr> <th><?php \_e( 'Custom Style', 'jquery-collapse-o-matic' ) ?>:</th> <td><label><textarea id="custom\_css" name="<?php echo esc\_attr($this->options\_name); ?>[custom\_css]"><?php echo esc\_textarea($options['custom\_css']); ?></textarea> <br /><span class="description"><?php \_e( 'Custom CSS style for <em>ultimate flexibility</em>', 'jquery-collapse-o-matic' ) ?></span></label> </td> </tr>
 <tr> <th><?php \_e( 'Content Filter', 'jquery-collapse-o-matic' ) ?>:</th> <td><label><input type="checkbox" id="filter\_content" name="<?php echo esc\_attr($this->options\_name); ?>[filter\_content]" value="1" <?php echo checked( $options['filter\_content'], 1 ); ?> /> <?php \_e('Apply filter', 'jquery-collapse-o-matic'); ?> <br /><span class="description"><?php \_e('Apply the\_content filter to target content.', 'jquery-collapse-o-matic'); ?></span></label> </td> </tr>
 <?php //if collapse-commander is installed, display options for displaying id and text in shortocdes if( is\_plugin\_active( 'collapse-commander/collapse-commander.php' ) ) : ?> <tr> <th><?php \_e( 'Display ID', 'colpromat' ) ?>:</th> <td><label><input type="checkbox" id="cc\_display\_id" name="<?php echo esc\_attr($this->options\_name); ?>[cc\_display\_id]" value="1" <?php echo checked( $options['cc\_display\_id'], 1 ); ?> /> <?php \_e('Display ID', 'colpromat'); ?> <br /><span class="description"><?php \_e('Display custom ID attribute in shortcodes if set for easier shortcode managment.', 'colpromat'); ?></span></label> </td> </tr>
 <tr> <th><?php \_e( 'Display Title', 'colpromat' ) ?>:</th> <td><label><input type="checkbox" id="cc\_display\_title" name="<?php echo esc\_attr($this->options\_name); ?>[cc\_display\_title]" value="1" <?php echo checked( $options['cc\_display\_title'], 1 ); ?> /> <?php \_e('Display Title', 'colpromat'); ?> <br /><span class="description"><?php \_e('Display custom eT attribute in shortcodes that shows expand title for easier shortcode managment.', 'colpromat'); ?></span></label> </td> </tr> <?php endif; ?>
 <tr> <th><?php \_e( 'Shortcode Scripts', 'jquery-collapse-o-matic' ) ?>:</th> <td><label><input type="checkbox" id="script\_check" name="<?php echo esc\_attr($this->options\_name); ?>[script\_check]" value="1" <?php echo checked( $options['script\_check'], 1 ); ?> /> <?php \_e('Only load scripts with shortcode.', 'jquery-collapse-o-matic'); ?> <br /><span class="description"><?php \_e('Only load Collapse-O-Matic scripts if [expand] shortcode is used.', 'jquery-collapse-o-matic'); ?></span></label> </td> </tr>
 <tr> <th><?php \_e( 'Shortcode CSS', 'jquery-collapse-o-matic' ) ?>:</th> <td><label><input type="checkbox" id="css\_check" name="<?php echo esc\_attr($this->options\_name); ?>[css\_check]" value="1" <?php echo checked( $options['css\_check'], 1 ); ?> /> <?php \_e('Only load CSS with shortcode.', 'jquery-collapse-o-matic'); ?> <br /><span class="description"><?php \_e('Only load Collapse-O-Matic CSS if [expand] shortcode is used.', 'jquery-collapse-o-matic'); ?></span></label> </td> </tr>
 <tr> <th><?php \_e( 'Script Load Location', 'jquery-collapse-o-matic' ) ?>:</th> <td><label><select id="script\_location" name="<?php echo esc\_attr($this->options\_name); ?>[script\_location]"> <?php if(empty($options['script\_location'])){ $options['script\_location'] = 'footer'; } $sl\_array = array( \_\_('Header', 'jquery-collapse-o-matic') => 'header', \_\_('Footer', 'jquery-collapse-o-matic') => 'footer' ); foreach( $sl\_array as $key => $value){ $selected = ''; if($options['script\_location'] == $value){ $selected = 'SELECTED'; } echo '<option value="'.esc\_attr($value).'" '.$selected.'>'.esc\_attr($key).'</option>'; } ?> </select> <br /><span class="description"><?php \_e('Where should the script be loaded, in the Header or the Footer?', 'jquery-collapse-o-matic'); ?></span></label> </td> </tr> <?php if( !is\_plugin\_active( 'collapse-commander/collapse-commander.php' ) ) : ?> <tr> <th><strong><?php \_e( 'Take Command!', 'jquery-collapse-o-matic' ) ?></strong></th> <td><?php printf(\_\_( '%sCollapse Commander%s is an add-on plugin that introduces an advanced management interface to better organize expand elements and simplify expand shortcodes.', 'jquery-collapse-o-matic' ), '<a href="https://pluginoven.com/premium-plugins/collapse-commander/?utm\_source=collapse-o-matic&utm\_medium=plugin-settings-page&utm\_content=collapse-commander&utm\_campaign=collapse-o-matic-commander">', '</a>'); ?> </td> </tr> <?php endif; ?> <tr> <th><strong><?php \_e( 'Level Up!', 'jquery-collapse-o-matic' ) ?></strong></th> <td><?php printf(\_\_( '%sCollapse-Pro-Matic%s is our premium plugin that offers additional attributes and features for <i>ultimate</i> flexibility, in addition to a very %shigh level of personal support%s.', 'jquery-collapse-o-matic' ), '<a href="https://pluginoven.com/premium-plugins/collapse-pro-matic/?utm\_source=collapse-o-matic&utm\_medium=plugin-settings-page&utm\_content=collapse-pro-matic&utm\_campaign=collapse-o-matic-pro">', '</a>', '<a href="https://pluginoven.com/premium-plugins/collapse-pro-matic/testimonials/?utm\_source=collapse-o-matic&utm\_medium=plugin-settings-page&utm\_content=collapse-pro-matic&utm\_campaign=collapse-o-matic-support">', '</a>'); ?> </td> </tr> </table> </fieldset>
 <p class="submit"> <input class="button-primary" type="submit" value="<?php \_e( 'Save Changes' ) ?>" /> </p> </form> </div> </div> </div> </div>
 <div class="postbox-container side metabox-holder meta-box-sortables" style="width:29%;"> <div style="margin:0 5px;"> <div class="postbox"> <div class="handlediv" title="<?php \_e( 'Click to toggle', 'jquery-collapse-o-matic' ) ?>"><br/></div> <h3 class="hndle"><?php \_e( 'About' ) ?></h3> <div class="inside"> <h4><img src="<?php echo plugins\_url( 'images/collapse-o-matic-icon.png', \_\_FILE\_\_ ) ?>" width="16" height="16"/> Collapse-O-Matic Version <?php echo esc\_attr($this->version); ?></h4> <p><?php \_e( 'Remove clutter, save space. Display and hide additional content in a SEO friendly way. Wrap any content&mdash;including other shortcodes&mdash;into a lovely jQuery expanding and collapsing element.', 'jquery-collapse-o-matic') ?></p> <ul> <li><?php printf( \_\_( '%sDetailed documentation%s, complete with working demonstrations of all shortcode attributes, is available for your instructional enjoyment.', 'jquery-collapse-o-matic'), '<a href="https://pluginoven.com/plugins/collapse-o-matic/documentation/" target="\_blank">', '</a>'); ?></li> <li><?php printf( \_\_( '%sFree Opensource Support%s', 'jquery-collapse-o-matic'), '<a href="https://wordpress.org/support/plugin/jquery-collapse-o-matic" target="\_blank">', '</a>'); ?></li> <li><?php printf( \_\_( 'If this plugin %s, please consider %sreviewing it at WordPress.org%s to help others.', 'jquery-collapse-o-matic'), $like\_it, '<a href="https://wordpress.org/support/view/plugin-reviews/jquery-collapse-o-matic" target="\_blank">', '</a>' ) ?></li> <li><a href="https://wordpress.org/plugins/jquery-collapse-o-matic/" target="\_blank">WordPress.org</a> | <a href="https://pluginoven.com/plugins/collapse-o-matic/" target="\_blank">Twinpictues Plugin Oven</a></li> </ul> </div> </div> </div> <div class="clear"></div> </div>
 <?php if( is\_plugin\_active( 'collapse-commander/collapse-commander.php' ) ) : ?>
 <div class="postbox-container side metabox-holder" style="width:29%;"> <div style="margin:0 5px;"> <div class="postbox"> <h3 class="handle"><?php \_e( 'Register Collapse Commander', 'jquery-collapse-o-matic') ?></h3> <div class="inside"> <p><?php printf( \_\_('To receive plugin updates you must register your plugin. Enter your Collapse Commander licence key below. Licence keys may be viewed and manged by logging into %syour account%s.', 'colpromat'), '<a href="https://pluginoven.com/my-account/" target="\_blank">', '</a>'); ?></p> <form method="post" action="options.php"> <?php settings\_fields( $this->license\_group ); $options = get\_option($this->license\_name); $cc\_licence = ( !isset( $options['collapse\_commander\_license\_key'] ) ) ? '' : $options['collapse\_commander\_license\_key']; ?> <fieldset> <table style="width: 100%"> <tbody> <tr> <th><?php \_e( 'License Key', 'colpromat' ) ?>:</th> <td><label for="collapse\_commander\_license\_key"><input type="text" id="collapse\_commander\_license\_key" name="<?php echo esc\_attr($this->license\_name); ?>[collapse\_commander\_license\_key]" value="<?php echo esc\_attr( $cc\_licence ); ?>" style="width: 100%" /> <br /><span class="description"><?php \_e('Enter your license key', 'jquery-collapse-o-matic'); ?></span></label> </td>
 </tr>
 <?php if( isset($options['collapse\_commander\_license\_key']) ) { ?> <tr valign="top"> <th><?php \_e('License Status', 'colpromat'); ?>:</th> <td> <?php if( isset($options['collapse\_commander\_license\_status']) && $options['collapse\_commander\_license\_status'] == 'valid' ) { ?> <span style="color:green;"><?php \_e('active'); ?></span><br/> <input type="submit" class="button-secondary" name="edd\_cc\_license\_deactivate" value="<?php \_e('Deactivate License', 'jquery-collapse-o-matic'); ?>"/> <?php } else { if( isset($options['collapse\_commander\_license\_status']) ){ ?> <span style="color: red"><?php echo esc\_attr($options['collapse\_commander\_license\_status']); ?></span><br/> <?php } else { ?> <span style="color: grey"><?php \_e('inactive', 'jquery-collapse-o-matic'); ?></span><br/> <?php } ?> <input type="submit" class="button-secondary" name="edd\_cc\_license\_activate" value="<?php \_e('Activate License', 'jquery-collapse-o-matic'); ?>"/> <?php } ?> </td> </tr> <?php } ?> </tbody> </table> </fieldset> <?php submit\_button( \_\_( 'Register', 'jquery-collapse-o-matic') ); ?> </form> </div> </div> </div> </div> <?php else: ?> <div class="postbox-container side metabox-holder meta-box-sortables" style="width:29%;"> <div style="margin:0 5px;"> <div class="postbox"> <div class="handlediv" title="<?php \_e( 'Click to toggle', 'jquery-collapse-o-matic' ) ?>"><br/></div> <h3 class="hndle">Collapse Commander</h3> <div class="inside"> <p>A brief and not-exactly-sober overview of <a href="https://pluginoven.com/premium-plugins/collapse-commander/?utm\_source=collapse-o-matic&utm\_medium=plugin-settings-page&utm\_content=collapse-commander&utm\_campaign=collapse-o-matic-commander">Collapse Commander</a>, a new add-on plugin for Collapse-O-Matic and Collapse-Pro-Matic that adds and advanded expand shortcode management system.</p> <iframe width="100%" height="300" src="//www.youtube.com/embed/w9X4nXpAEfo" frameborder="0" allowfullscreen></iframe> </div> </div> </div> <div class="clear"></div> </div> <?php endif; ?> <?php }
 /\*\* \* Set options from save values or defaults \*/ function \_set\_options() { // set options $saved\_options = get\_option( $this->options\_name );
 // backwards compatible (old values) if ( empty( $saved\_options ) ) { $saved\_options = get\_option( $this->domain . 'options' ); } // set all options if ( !empty( $saved\_options ) ) { foreach ( $this->options AS $key => $option ) { if($key == 'tabindex'){ $this->options[ $key ] = in\_array( $key, $saved\_options ) ? $saved\_options[ $key ] : 0; } else{ $this->options[ $key ] = ( empty( $saved\_options[ $key ] ) ) ? '' : $saved\_options[ $key ]; } } } }
 function edd\_sanitize\_license( $new ) { //collapse commander $options = get\_option($this->license\_name); $old\_cc = ( !isset( $options['collapse\_commander\_license\_key'] ) ) ? '' : $options['collapse\_commander\_license\_key']; $old\_cc\_status = ( !isset( $options['collapse\_commander\_license\_status'] ) ) ? '' : $options['collapse\_commander\_license\_status'];
 if( !empty($old\_cc) && $old\_cc != $new['collapse\_commander\_license\_key'] ) { $new['collapse\_commander\_license\_status'] = ''; } else{ $new['collapse\_commander\_license\_status'] = $old\_cc\_status; }
 if( isset( $\_POST['edd\_cc\_license\_activate'] ) ) { $new['collapse\_commander\_license\_status'] = $this->plugin\_oven\_activate\_license( urlencode( PLUGIN\_OVEN\_CC ), $new['collapse\_commander\_license\_key'], 'activate\_license'); }
 if( isset( $\_POST['edd\_cc\_license\_deactivate'] ) ) { $new['collapse\_commander\_license\_status'] = $this->plugin\_oven\_activate\_license( urlencode( PLUGIN\_OVEN\_CC ), $new['collapse\_commander\_license\_key'], 'deactivate\_license'); } return $new; }
 /\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\* \* this illustrates how to activate \* a license key \*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*/
 function plugin\_oven\_activate\_license($plugin\_name, $license\_key, $edd\_action) { // data to send in our API request $api\_params = array( 'edd\_action' => $edd\_action, 'license' => $license\_key, 'item\_name' => $plugin\_name, 'url' => home\_url() );
 // Call the custom API. $response = wp\_remote\_get( esc\_url\_raw( add\_query\_arg( $api\_params, PLUGIN\_OVEN\_URL ) ), array( 'timeout' => 15, 'sslverify' => false ) );
 // make sure the response came back okay if ( is\_wp\_error( $response ) ) return false;
 // decode the license data $license\_data = json\_decode( wp\_remote\_retrieve\_body( $response ) );
 // $license\_data->license will be either "valid" or "invalid" return $license\_data->license; }
 /\*\* \* Filter $input to allow only tags from $allowed\_tags array \*/ function filter\_allowed\_tags( $input, $allowed\_tags ) { $pattern = '/\A(' . implode( '|', $allowed\_tags ) . ')\Z/'; if ( preg\_match( $pattern, $input, $matches ) ) { $output = $matches[0]; } else { $output = ''; }
 return $output; }
} // end class WP\_Collapse\_O\_Matic
/\*\* \* Create instance \*/$WP\_Collapse\_O\_Matic = new WP\_Collapse\_O\_Matic;
//clean unwanted p and br tags from shortcodes//https://www.wpexplorer.com/clean-up-wordpress-shortcode-formattingif (!function\_exists('tp\_clean\_shortcodes')) { function tp\_clean\_shortcodes($content){ $array = array ( '<p>[' => '[', ']</p>' => ']', ']<br />' => ']' ); $content = strtr($content, $array); return $content; } add\_filter('the\_content', 'tp\_clean\_shortcodes');}
?>

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.

