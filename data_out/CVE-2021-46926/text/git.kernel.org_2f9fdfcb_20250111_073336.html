

| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=385f287f9853da402d94278e59f594501c1d1dad)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=385f287f9853da402d94278e59f594501c1d1dad)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=385f287f9853da402d94278e59f594501c1d1dad)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=385f287f9853da402d94278e59f594501c1d1dad)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Libin Yang <libin.yang@intel.com> | 2021-12-21 09:08:16 +0800 |
| --- | --- | --- |
| committer | Takashi Iwai <tiwai@suse.de> | 2021-12-22 20:17:37 +0100 |
| commit | [385f287f9853da402d94278e59f594501c1d1dad](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=385f287f9853da402d94278e59f594501c1d1dad) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=385f287f9853da402d94278e59f594501c1d1dad)) | |
| tree | [af7fd09adc9ccbc5317ce064bad5a746c405ab1f](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=385f287f9853da402d94278e59f594501c1d1dad) | |
| parent | [b6fd77472dea76b7a2bad3a338ade920152972b8](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=b6fd77472dea76b7a2bad3a338ade920152972b8) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=385f287f9853da402d94278e59f594501c1d1dad&id2=b6fd77472dea76b7a2bad3a338ade920152972b8)) | |
| download | [linux-385f287f9853da402d94278e59f594501c1d1dad.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-385f287f9853da402d94278e59f594501c1d1dad.tar.gz) | |

ALSA: hda: intel-sdw-acpi: harden detection of controllerThe existing code currently sets a pointer to an ACPI handle before
checking that it's actually a SoundWire controller. This can lead to
issues where the graph walk continues and eventually fails, but the
pointer was set already.
This patch changes the logic so that the information provided to
the caller is set when a controller is found.
Reviewed-by: PÃ©ter Ujfalusi <peter.ujfalusi@linux.intel.com>
Signed-off-by: Libin Yang <libin.yang@intel.com>
Signed-off-by: Pierre-Louis Bossart <pierre-louis.bossart@linux.intel.com>
Signed-off-by: Bard Liao <yung-chuan.liao@linux.intel.com>
Link: [https://lore.kernel.org/r/20211221010817.23636-2-yung-chuan.liao@linux.intel.com](https://lore.kernel.org/r/20211221010817.23636-2-yung-chuan.liao%40linux.intel.com)
Signed-off-by: Takashi Iwai <tiwai@suse.de>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=385f287f9853da402d94278e59f594501c1d1dad)

| -rw-r--r-- | [sound/hda/intel-sdw-acpi.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/sound/hda/intel-sdw-acpi.c?id=385f287f9853da402d94278e59f594501c1d1dad) | 5 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 3 insertions, 2 deletions

| diff --git a/sound/hda/intel-sdw-acpi.c b/sound/hda/intel-sdw-acpi.cindex c0123bc31c0ddf..ba8a872a290107 100644--- a/[sound/hda/intel-sdw-acpi.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/sound/hda/intel-sdw-acpi.c?id=b6fd77472dea76b7a2bad3a338ade920152972b8)+++ b/[sound/hda/intel-sdw-acpi.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/sound/hda/intel-sdw-acpi.c?id=385f287f9853da402d94278e59f594501c1d1dad)@@ -132,8 +132,6 @@ static acpi\_status sdw\_intel\_acpi\_cb(acpi\_handle handle, u32 level, return AE\_NOT\_FOUND; } - info->handle = handle;- /\* \* On some Intel platforms, multiple children of the HDAS \* device can be found, but only one of them is the SoundWire@@ -144,6 +142,9 @@ static acpi\_status sdw\_intel\_acpi\_cb(acpi\_handle handle, u32 level, if (FIELD\_GET(GENMASK(31, 28), adr) != SDW\_LINK\_TYPE) return AE\_OK; /\* keep going \*/ + /\* found the correct SoundWire controller \*/+ info->handle = handle;+ /\* device found, stop namespace walk \*/ return AE\_CTRL\_TERMINATE; } |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 07:32:13 +0000

