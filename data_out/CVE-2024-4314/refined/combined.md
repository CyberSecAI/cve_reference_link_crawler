=== Content from plugins.trac.wordpress.org_056a413d_20250111_114901.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fchangeset%2F3079755%2Fhostel%2Ftrunk%3Fcontextall%3D1%26old%3D3070681%26old_path%3D%252Fhostel%252Ftrunk)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* [Reverse Diff](/changeset/3070681/hostel/trunk?old=3079755&old_path=%2Fhostel%2Ftrunk)

---

# Changes in [hostel/trunk](/browser/hostel/trunk?rev=3079755 "Show entry in browser") [[3070681:3079755]](/log/hostel/trunk?rev=3079755&stop_rev=3070681 "Show revision log")

View differences
inline
side by side

Show
lines around each change

Show the changes in full context

Ignore:

Blank lines

Case changes

White space changes

Location:
[hostel/trunk](/browser/hostel/trunk?rev=3079755)
Files:

3 edited

* [controllers/rooms.php](/browser/hostel/trunk/controllers/rooms.php?rev=3079755 "Show entry in browser")
  (modified)
  ([1 diff](#file0 "Show differences"))
* [hostel.php](/browser/hostel/trunk/hostel.php?rev=3079755 "Show entry in browser")
  (modified)
  ([1 diff](#file1 "Show differences"))
* [views/rooms.php](/browser/hostel/trunk/views/rooms.php?rev=3079755 "Show entry in browser")
  (modified)
  ([1 diff](#file2 "Show differences"))

### Legend:

Unmodified
Added
Removed

* ## [hostel/trunk/controllers/rooms.php](/changeset/3079755/hostel/trunk/controllers/rooms.php?old=1635467&old_path=hostel%2Ftrunk%2Fcontrollers%2Frooms.php "Show the [3070681:3079755] differences restricted to hostel/trunk/controllers/rooms.php")

  | [r3070681](/browser/hostel/trunk/controllers/rooms.php?rev=1635467#L1 "Show revision 3070681 of this file in browser") | [r3079755](/browser/hostel/trunk/controllers/rooms.php?rev=3079755#L1 "Show revision 3079755 of this file in browser") |  |
  | --- | --- | --- |
  | 1 | 1 | <?php |
  | 2 | 2 | // manage hostel rooms controller |
  | 3 | 3 | class WPHostelRooms { |
  | 4 | 4 | static function manage() { |
  | 5 | 5 | $\_room = new WPHostelRoom(); |
  | 6 | 6 |  |
  | 7 | 7 | $action = empty($\_GET['action'])?'list':$\_GET['action']; |
  | 8 | 8 | switch($action) { |
  | 9 | 9 | case 'add': |
  | 10 | 10 | if(!empty($\_POST['ok']) and check\_admin\_referer('wphostel\_room')) { |
  | 11 | 11 | $\_room -> add($\_POST); |
  | 12 | 12 | $success = \_\_('Room added.', 'wphostel'); |
  | 13 | 13 | wphostel\_redirect("admin.php?page=wphostel\_rooms&action=list"); |
  | 14 | 14 | } |
  | 15 | 15 |  |
  | 16 | 16 | if(@file\_exists(get\_stylesheet\_directory().'/wphostel/room.php')) include get\_stylesheet\_directory().'/wphostel/room.php'; |
  | 17 | 17 | else include(WPHOSTEL\_PATH."/views/room.php"); |
  | 18 | 18 | break; |
  | 19 | 19 |  |
  | 20 | 20 | case 'edit': |
  | 21 | 21 | $\_GET['id'] = intval($\_GET['id']); |
  | 22 | 22 | if(!empty($\_POST['ok']) and check\_admin\_referer('wphostel\_room')) { |
  | 23 | 23 | $\_room->edit($\_POST, $\_GET['id']); |
  | 24 | 24 | $success = \_\_('Room details saved.', 'wphostel'); |
  | 25 | 25 | wphostel\_redirect("admin.php?page=wphostel\_rooms&action=list"); |
  | 26 | 26 | } |
  | 27 | 27 |  |
  | 28 | 28 | $room = $\_room->get($\_GET['id']); |
  | 29 | 29 |  |
  | 30 | 30 | if(@file\_exists(get\_stylesheet\_directory().'/wphostel/room.php')) include get\_stylesheet\_directory().'/wphostel/room.php'; |
  | 31 | 31 | else include(WPHOSTEL\_PATH."/views/room.php"); |
  | 32 | 32 | break; |
  | 33 | 33 |  |
  | 34 | 34 | case 'delete': |
  |  | 35 | if (!isset($\_GET['nonce'])) wp\_die(""); |
  |  | 36 | $nonce = $\_GET['nonce']; |
  |  | 37 | if (!wp\_verify\_nonce($nonce, 'delete\_room')) { |
  |  | 38 | // Nonce verification failed |
  |  | 39 | wp\_die('Nonce verification failed'); |
  |  | 40 | } |
  | 35 | 41 | $\_GET['id'] = intval($\_GET['id']); |
  | 36 | 42 | $\_room->delete($\_GET['id']); |
  | 37 | 43 | $success = \_\_("Room deleted.", 'wphostel'); |
  | 38 | 44 | wphostel\_redirect("admin.php?page=wphostel\_rooms&action=list"); |
  | 39 | 45 | break; |
  | 40 | 46 |  |
  | 41 | 47 | case 'list': |
  | 42 | 48 | default: |
  | 43 | 49 | $rooms = $\_room->find(); |
  | 44 | 50 | if(@file\_exists(get\_stylesheet\_directory().'/wphostel/rooms.php')) include get\_stylesheet\_directory().'/wphostel/rooms.php'; |
  | 45 | 51 | else include(WPHOSTEL\_PATH."/views/rooms.php"); |
  | 46 | 52 | break; |
  | 47 | 53 | } |
  | 48 | 54 | } |
  | 49 | 55 |  |
  | 50 | 56 | // ajax called function that returns the default number of beds for the booking form: |
  | 51 | 57 | // for dorm rooms and "per room" price return 1 |
  | 52 | 58 | // for private rooms return max beds |
  | 53 | 59 | // outputs also 0 or 1 after the | to show whether the user can change or not the number of rooms |
  | 54 | 60 | static function default\_beds() { |
  | 55 | 61 | global $wpdb; |
  | 56 | 62 |  |
  | 57 | 63 | // select room |
  | 58 | 64 | $room = $wpdb->get\_row($wpdb->prepare("SELECT \* FROM ".WPHOSTEL\_ROOMS." WHERE id=%d", intval($\_POST['room\_id']))); |
  | 59 | 65 |  |
  | 60 | 66 | if($room->rtype == 'dorm' or $room->price\_type == 'per-room') { |
  | 61 | 67 | echo "1"; |
  | 62 | 68 | if($room->rtype == 'dorm') echo "|1"; |
  | 63 | 69 | else echo "|0"; |
  | 64 | 70 | } |
  | 65 | 71 | else echo $room->beds.'|0'; |
  | 66 | 72 |  |
  | 67 | 73 | exit; |
  | 68 | 74 | } |
  | 69 | 75 |  |
  | 70 | 76 | // displays the availability table of all rooms by given dates |
  | 71 | 77 | static function availability\_table($shortcode\_id, $atts = null) { |
  | 72 | 78 | global $wpdb; |
  | 73 | 79 |  |
  | 74 | 80 | $\_room = new WPHostelRoom(); |
  | 75 | 81 | $\_booking = new WPHostelBooking(); |
  | 76 | 82 | $dateformat = get\_option('date\_format'); |
  | 77 | 83 | $booking\_mode = get\_option('wphostel\_booking\_mode'); |
  | 78 | 84 | $min\_stay = get\_option('wphostel\_min\_stay'); |
  | 79 | 85 | $booking\_start = get\_option('wphostel\_booking\_start'); |
  | 80 | 86 | if(empty($booking\_start)) $booking\_start = 'tomorrow'; |
  | 81 | 87 | $book\_to\_date = ($booking\_start == 'tomorrow') ? '+2 days' : 'tomorrow'; |
  | 82 | 88 | $show\_titles = empty($atts['show\_titles']) ? 0 : $atts['show\_titles']; |
  | 83 | 89 |  |
  | 84 | 90 | // the dropdown defaults to "from tomorrow to 1 day after" |
  | 85 | 91 | $default\_dateto\_diff = $min\_stay ? strtotime("+ ".(intval($min\_stay)+1)." days") : strtotime($book\_to\_date); |
  | 86 | 92 | $datefrom = empty($\_POST['wphostel\_from']) ? date("Y-m-d", strtotime($booking\_start)) : sanitize\_text\_field($\_POST['wphostel\_from']); |
  | 87 | 93 | $dateto = empty($\_POST['wphostel\_to']) ? date("Y-m-d", $default\_dateto\_diff) : sanitize\_text\_field($\_POST['wphostel\_to']); |
  | 88 | 94 |  |
  | 89 | 95 | // select all rooms |
  | 90 | 96 | $rooms = $wpdb->get\_results("SELECT \* FROM ".WPHOSTEL\_ROOMS." ORDER BY price", ARRAY\_A); |
  | 91 | 97 |  |
  | 92 | 98 | // select all bookings in the given period |
  | 93 | 99 | $bookings = $\_booking->select\_in\_period($datefrom, $dateto); |
  | 94 | 100 |  |
  | 95 | 101 | $datefrom\_time = strtotime($datefrom); |
  | 96 | 102 | $dateto\_time = strtotime($dateto); |
  | 97 | 103 | $numdays = ($dateto\_time   -  $datefrom\_time) / (24 \* 3600); |
  | 98 | 104 |  |
  | 99 | 105 | // match bookings to rooms so for each date we know if the room is booked or not |
  | 100 | 106 | foreach($rooms as $cnt=>$room) { |
  | 101 | 107 | $rooms[$cnt] = $\_room->availability($room, $bookings, $datefrom, $dateto, $numdays, $datefrom\_time, $dateto\_time); |
  | 102 | 108 | } // end foreach room |
  | 103 | 109 |  |
  | 104 | 110 | if(@file\_exists(get\_stylesheet\_directory().'/wphostel/partial/rooms-table.html.php')) include get\_stylesheet\_directory().'/wphostel/partial/rooms-table.html.php'; |
  | 105 | 111 | else include(WPHOSTEL\_PATH."/views/partial/rooms-table.html.php"); |
  | 106 | 112 | } // end availability table |
  | 107 | 113 | } |
* ## [hostel/trunk/hostel.php](/changeset/3079755/hostel/trunk/hostel.php?old=3070681&old_path=hostel%2Ftrunk%2Fhostel.php "Show the [3070681:3079755] differences restricted to hostel/trunk/hostel.php")

  | [r3070681](/browser/hostel/trunk/hostel.php?rev=3070681#L1 "Show revision 3070681 of this file in browser") | [r3079755](/browser/hostel/trunk/hostel.php?rev=3079755#L1 "Show revision 3079755 of this file in browser") |  |
  | --- | --- | --- |
  | 1 | 1 | <?php |
  | 2 | 2 | /\* |
  | 3 | 3 | Plugin Name: Hostel |
  | 4 | 4 | Plugin URI: http://wp-hostel.com |
  | 5 | 5 | Description: Hostel / BnB management plugin |
  | 6 | 6 | Author: Kiboko Labs |
  | 7 |  | Version: 1.1.5.~~3~~ |
  |  | 7 | Version: 1.1.5.4 |
  | 8 | 8 | Author URI: http://kibokolabs.com |
  | 9 | 9 | License: GPLv2 or later |
  | 10 | 10 | Text Domain: wphostel |
  | 11 | 11 | \*/ |
  | 12 | 12 |  |
  | 13 | 13 | define( 'WPHOSTEL\_PATH', dirname( \_\_FILE\_\_ ) ); |
  | 14 | 14 | define( 'WPHOSTEL\_RELATIVE\_PATH', dirname( plugin\_basename( \_\_FILE\_\_ ))); |
  | 15 | 15 | define( 'WPHOSTEL\_URL', plugin\_dir\_url( \_\_FILE\_\_ )); |
  | 16 | 16 |  |
  | 17 | 17 | // require controllers and models |
  | 18 | 18 | require(WPHOSTEL\_PATH."/helpers/htmlhelper.php"); |
  | 19 | 19 | require(WPHOSTEL\_PATH."/models/hostel.php"); |
  | 20 | 20 | require(WPHOSTEL\_PATH."/models/room.php"); |
  | 21 | 21 | require(WPHOSTEL\_PATH."/controllers/rooms.php"); |
  | 22 | 22 | require(WPHOSTEL\_PATH."/models/booking.php"); |
  | 23 | 23 | require(WPHOSTEL\_PATH."/models/payment.php"); |
  | 24 | 24 | require(WPHOSTEL\_PATH."/controllers/bookings.php"); |
  | 25 | 25 | require(WPHOSTEL\_PATH."/controllers/shortcodes.php"); |
  | 26 | 26 | require(WPHOSTEL\_PATH."/controllers/help.php"); |
  | 27 | 27 | require(WPHOSTEL\_PATH."/controllers/ajax.php"); |
  | 28 | 28 | require(WPHOSTEL\_PATH."/controllers/sync.php"); |
  | 29 | 29 |  |
  | 30 | 30 | add\_action('init', array("WPHostel", "init")); |
  | 31 | 31 |  |
  | 32 | 32 | register\_activation\_hook(\_\_FILE\_\_, array("WPHostel", "install")); |
  | 33 | 33 | add\_action('admin\_menu', array("WPHostel", "menu")); |
  | 34 | 34 | add\_action('admin\_enqueue\_scripts', array("WPHostel", "scripts")); |
  | 35 | 35 |  |
  | 36 | 36 | // show the things on the front-end |
  | 37 | 37 | add\_action( 'wp\_enqueue\_scripts', array("WPHostel", "scripts")); |
  | 38 | 38 |  |
  | 39 | 39 | // widgets |
  | 40 | 40 | add\_action( 'widgets\_init', array("WPHostel", "register\_widgets") ); |
  | 41 | 41 |  |
  | 42 | 42 | // other actions |
  | 43 | 43 | add\_action('wp\_ajax\_wphostel\_ajax', 'wphostel\_ajax'); |
  | 44 | 44 | add\_action('wp\_ajax\_nopriv\_wphostel\_ajax', 'wphostel\_ajax'); |
* ## [hostel/trunk/views/rooms.php](/changeset/3079755/hostel/trunk/views/rooms.php?old=1714014&old_path=hostel%2Ftrunk%2Fviews%2Frooms.php "Show the [3070681:3079755] differences restricted to hostel/trunk/views/rooms.php")

  | [r3070681](/browser/hostel/trunk/views/rooms.php?rev=1714014#L1 "Show revision 3070681 of this file in browser") | [r3079755](/browser/hostel/trunk/views/rooms.php?rev=3079755#L1 "Show revision 3079755 of this file in browser") |  |
  | --- | --- | --- |
  | 1 | 1 | <style type="text/css"> |
  | 2 | 2 | <?php wphostel\_resp\_table\_css(800);?> |
  | 3 | 3 | </style> |
  | 4 | 4 |  |
  | 5 | 5 | <h1><?php \_e('Manage Rooms', 'wphostel')?></h1> |
  | 6 | 6 |  |
  | 7 | 7 | <div class="wrap"> |
  | 8 | 8 | <p><a href="admin.php?page=wphostel\_rooms&action=add"><?php \_e('Click here to add room', 'wphostel')?></a></p> |
  | 9 | 9 |  |
  | 10 | 10 | <?php if(!sizeof($rooms)):?> |
  | 11 | 11 | <p><?php \_e('You have not added any rooms yet.', 'wphostel')?></p> |
  | 12 | 12 | <?php echo "</div>"; |
  | 13 | 13 | return false; |
  | 14 | 14 | endif?> |
  | 15 | 15 |  |
  | 16 | 16 | <table class="widefat wphostel-table"> |
  | 17 | 17 | <thead> |
  | 18 | 18 | <tr><th><?php \_e('Room title', 'wphostel')?></th><th><?php \_e('Room type', 'wphostel')?></th><th><?php \_e('Num beds', 'wphostel')?></th> |
  | 19 | 19 | <th><?php \_e('Bathroom', 'wphostel')?></th><th><?php \_e('Price', 'wphostel')?></th><th><?php \_e('Book shortcode', 'wphostel')?></th><th><?php \_e('Action', 'wphostel')?></th></tr> |
  | 20 | 20 | </thead> |
  | 21 | 21 | <tbody> |
  | 22 | 22 | <?php foreach($rooms as $room): |
  | 23 | 23 | $class = ('alternate' == @$class) ? '' : 'alternate';?> |
  | 24 | 24 | <tr class="<?php echo $class?>"><td><?php echo stripslashes($room->title)?></td> <td><?php echo $\_room->prettify('rtype', $room->rtype);?></td> |
  | 25 | 25 | <td><?php echo $room->beds?></td><td><?php echo $\_room->prettify('bathroom', $room->bathroom)?></td> <td><?php echo WPHOSTEL\_CURRENCY.' '.$room->price?><br> |
  | 26 | 26 | <?php echo $\_room->prettify('price\_type', $room->price\_type);?></td> |
  | 27 | 27 | <td><input type="text" value="[wphostel-book <?php echo $room->id?>]" size="15" onclick="this.select();" readonly></td> |
  | 28 | 28 | <td><a href="admin.php?page=wphostel\_rooms&action=edit&id=<?php echo $room->id?>"><?php \_e('Edit', 'wphostel')?></a> | <a href="#" onclick="wphostelDeleteRoom(<?php echo $room->id?>);return false;"><?php \_e('Delete', 'wphostel')?></a> |
  | 29 | 29 | | <a href='#' onclick="jQuery('#iCal<?php echo $room->id?>').toggle();return false;"><?php \_e('iCalendar', 'wphostel');?></a> |
  | 30 | 30 | <div id="iCal<?php echo $room->id?>" style="display:none;"> |
  | 31 | 31 | <?php \_e('Get link:', 'wphostel');?><br> <input type="text" value="<?php echo site\_url("?wphostel\_ical=1&room\_id=".$room->id);?>" onclick="this.select();" readonly="readonly" size="30"> |
  | 32 | 32 | <br> |
  | 33 | 33 | <a href="<?php echo site\_url("?wphostel\_ical=1&room\_id=".$room->id."&download=1");?>"><?php \_e('Download file', 'wphostel');?></a> |
  | 34 | 34 | </div> |
  | 35 | 35 | </td></tr> |
  | 36 | 36 | <?php endforeach;?> |
  | 37 | 37 | </tbody> |
  | 38 | 38 | </table> |
  | 39 | 39 |  |
  | 40 | 40 | <p><?php \_e('When you place the booking shortcode a "Book" button will be automatically generated. Use it on a page where you have manually described your room with pictures etc. You can pass custom button text as second argument to the shortcode - like this:', 'wphostel')?> [wphostel-book 1 "Reserve room!"].</p> |
  | 41 | 41 | </div> |
  | 42 | 42 |  |
  | 43 | 43 | <script type="text/javascript" > |
  | 44 | 44 | function wphostelDeleteRoom(id) { |
  | 45 | 45 | if(confirm("<?php \_e('Are you sure?', 'wphostel')?>")) { |
  | 46 |  | window.location='admin.php?page=wphostel\_rooms&action=delete&id='+id; |
  |  | 46 | let nonce = '<?php echo wp\_create\_nonce( 'delete\_room'); ?>'; |
  |  | 47 | window.location='admin.php?page=wphostel\_rooms&action=delete&id='+id+'&nonce='+nonce; |
  | 47 | 48 | } |
  | 48 | 49 | } |
  | 49 | 50 |  |
  | 50 | 51 | <?php wphostel\_resp\_table\_js();?> |
  | 51 | 52 | </script> |

**Note:** See [TracChangeset](/wiki/TracChangeset)
for help on using the changeset viewer.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Unified Diff](?format=diff&new=3079755&old=3070681&new_path=%2Fhostel%2Ftrunk&old_path=%2Fhostel%2Ftrunk)
* [Zip Archive](?format=zip&new=3079755&old=3070681&new_path=%2Fhostel%2Ftrunk&old_path=%2Fhostel%2Ftrunk)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)



=== Content from www.wordfence.com_575d8054_20250111_114902.html ===


[![](https://www.wordfence.com/img/wordfence-intelligence-logo.svg)](/threat-intel/)

Have you found a vulnerability in a WordPress plugin or theme? Report vulnerabilities in WordPress plugins and themes through our [bug bounty program](https://www.wordfence.com/threat-intel/bug-bounty-program) and earn a bounty on all in-scope submissions, while we handle the responsible disclosure process on your behalf.

As a reminder, the Wordfence Intelligence Vulnerability Database API is completely free to query and utilize, both personally and commercially, and contains all the same vulnerability data as the user interface. Please review the API documentation and Webhook documentation for more information on how to query the vulnerability API endpoints and configure webhooks utilizing all the same data present in the Wordfence Intelligence user interface.

# hostel <= 1.1.5.3 - Cross-Site Request Forgery

 [Wordfence Intelligence](https://www.wordfence.com/threat-intel)   >    [Vulnerability Database](https://www.wordfence.com/threat-intel/vulnerabilities)   >   hostel <= 1.1.5.3 - Cross-Site Request Forgery

4.3

**Cross-Site Request Forgery (CSRF)**
**CVSS Vector**
[CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:L/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:L/A:N)

| CVE | [CVE-2024-4314](https://www.cve.org/CVERecord?id=CVE-2024-4314) |
| --- | --- |
| CVSS | 4.3 (Medium) |
| Publicly Published | May 6, 2024 |
| Last Updated | May 9, 2024 |
| Researcher | [Benedictus Jovan (aillesiM)](https://www.wordfence.com/threat-intel/vulnerabilities/researchers/benedictus-jovan) |

### Description

The Hostel plugin for WordPress is vulnerable to Cross-Site Request Forgery in all versions up to, and including, 1.1.5.3. This is due to missing or incorrect nonce validation when managing rooms. This makes it possible for unauthenticated attackers to create and delete rooms via a forged request granted they can trick a site administrator into performing an action such as clicking on a link.

#### References

* [plugins.trac.wordpress.org](https://plugins.trac.wordpress.org/changeset/3079755/hostel/trunk?contextall=1&old=3070681&old_path=%2Fhostel%2Ftrunk)

#### Share

[Facebook](https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fhostel%2Fhostel-1153-cross-site-request-forgery&t=hostel%20%3C%3D%201.1.5.3%20-%20Cross-Site%20Request%20Forgery "Facebook")
[Twitter](https://twitter.com/share?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fhostel%2Fhostel-1153-cross-site-request-forgery&text=hostel%20%3C%3D%201.1.5.3%20-%20Cross-Site%20Request%20Forgery "Twitter")
[LinkedIn](https://www.linkedin.com/shareArticle?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fhostel%2Fhostel-1153-cross-site-request-forgery "LinkedIn")
Email

## Vulnerability Details for Hostel

#### [Hostel](https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/hostel)

| Software Type | Plugin |
| --- | --- |
| Software Slug | hostel [(view on wordpress.org)](https://wordpress.org/plugins/hostel) |
| Patched? | Yes |
| Remediation | Update to version 1.1.5.4, or a newer patched version |
| Affected Version | * <= 1.1.5.3 |
| Patched Version | * 1.1.5.4 |

This record contains material that is subject to copyright.

**Copyright 2012-2025 Defiant Inc.**

**License:**
Defiant hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute this software vulnerability information. Any copy of the software vulnerability information you make for such purposes is authorized provided that you include a hyperlink to this vulnerability record and reproduce Defiant's copyright designation and this license in any such copy.
**[Read more.](https://www.wordfence.com/wordfence-intelligence-terms-and-conditions/)**

**Copyright 1999-2025 The MITRE Corporation**

**License:**
CVE Usage: MITRE hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute Common Vulnerabilities and Exposures (CVE®). Any copy you make for such purposes is authorized provided that you reproduce MITRE's copyright designation and this license in any such copy.
**[Read more.](https://www.cve.org/Legal/TermsOfUse)**

Have information to add, or spot any errors? Contact us at wfi-support@wordfence.com so we can make any appropriate adjustments.

Did you know Wordfence Intelligence provides free personal and commercial API access to our comprehensive WordPress vulnerability database, along with a free webhook integration to stay on top of the latest vulnerabilities added and updated in the database? Get started today!

Learn more

Want to get notified of the latest vulnerabilities that may affect your WordPress site?
 Install Wordfence on your site today to get notified immediately if your site is affected by a vulnerability that has been added to our database.

Get Wordfence

The Wordfence Intelligence WordPress vulnerability database is completely free to access and query via API. Please review the documentation on how to access and consume the vulnerability data via API.

Documentation


