
[Log in / Register](https://bugs.launchpad.net/ubuntu/%2Bsource/jhead/%2Bbug/1900820/%2Blogin)

[![](https://launchpadlibrarian.net/606381979/CoF%2064px.png)](https://launchpad.net/ubuntu)

## [Ubuntu](https://launchpad.net/ubuntu)[jhead package](https://launchpad.net/ubuntu/%2Bsource/jhead)

* [Overview](https://launchpad.net/ubuntu/%2Bsource/jhead)
* [Code](https://code.launchpad.net/ubuntu/%2Bsource/jhead)
* [Bugs](https://bugs.launchpad.net/ubuntu/%2Bsource/jhead)
* Blueprints
* [Translations](https://translations.launchpad.net/ubuntu/%2Bsource/jhead)
* [Answers](https://answers.launchpad.net/ubuntu/%2Bsource/jhead)

# heap-buffer-overflow in jpgfile.c:51 process\_COM

Bug #1900820 reported by
[Fstark](https://launchpad.net/~fstark521)
on 2020-10-21

[6](/%2Bhelp-bugs/bug-heat.html)

This bug affects 1 person

| Affects | | Status | Importance | Assigned to | Milestone |
| --- | --- | --- | --- | --- | --- |
|  | [jhead (Ubuntu)](https://bugs.launchpad.net/ubuntu/%2Bsource/jhead "Latest release: 1:3.08-3, uploaded to main on 2024-11-08 22:38:39.844813+00:00 by Joachim Reichel (reichel-debian), maintained by Joachim Reichel (reichel-debian)") | New | Undecided | Unassigned |  |

### Bug Description

fuzz1:id:000000,sig:06,src:000023,time:610,op:flip1,pos:23

=================================================================

==29731==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x60200000eff4 at pc 0x00000040e11b bp 0x7ffde2ec58c0 sp 0x7ffde2ec58b0

READ of size 1 at 0x60200000eff4 thread T0

    #0 0x40e11a in process\_COM /home/fstark/jhead/jpgfile.c:51

    #1 0x40f78f in ReadJpegSections /home/fstark/jhead/jpgfile.c:240

    #2 0x410e86 in ReadJpegSections /home/fstark/jhead/jpgfile.c:125

    #3 0x410e86 in ReadJpegFile /home/fstark/jhead/jpgfile.c:378

    #4 0x40858b in ProcessFile /home/fstark/jhead/jhead.c:905

    #5 0x402f2c in main /home/fstark/jhead/jhead.c:1756

    #6 0x7f003e17983f in \_\_libc\_start\_main (/lib/x86\_64-linux-gnu/libc.so.6+0x2083f)

    #7 0x406708 in \_start (/home/fstark/jhead/jhead+0x406708)

0x60200000eff4 is located 0 bytes to the right of 4-byte region [0x60200000eff0,0x60200000eff4)

allocated by thread T0 here:

    #0 0x7f003e8c4602 in malloc (/usr/lib/x86\_64-linux-gnu/libasan.so.2+0x98602)

    #1 0x40e4a8 in ReadJpegSections /home/fstark/jhead/jpgfile.c:172

SUMMARY: AddressSanitizer: heap-buffer-overflow /home/fstark/jhead/jpgfile.c:51 process\_COM

Shadow bytes around the buggy address:

  0x0c047fff9da0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa

  0x0c047fff9db0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa

  0x0c047fff9dc0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa

  0x0c047fff9dd0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa

  0x0c047fff9de0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa

=>0x0c047fff9df0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa[04]fa

  0x0c047fff9e00: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa

  0x0c047fff9e10: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa

  0x0c047fff9e20: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa

  0x0c047fff9e30: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa

  0x0c047fff9e40: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa

Shadow byte legend (one shadow byte represents 8 application bytes):

  Addressable: 00

  Partially addressable: 01 02 03 04 05 06 07

  Heap left redzone: fa

  Heap right redzone: fb

  Freed heap region: fd

  Stack left redzone: f1

  Stack mid redzone: f2

  Stack right redzone: f3

  Stack partial redzone: f4

  Stack after return: f5

  Stack use after scope: f8

  Global redzone: f9

  Global init order: f6

  Poisoned by user: f7

  Container overflow: fc

  Array cookie: ac

  Intra object redzone: bb

  ASan internal: fe

==29731==ABORTING

Tags:

[heap-buffer-overflow](/ubuntu/%2Bsource/jhead/%2Bbugs?field.tag=heap-buffer-overflow)
[jhead](/ubuntu/%2Bsource/jhead/%2Bbugs?field.tag=jhead)

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Fstark (fstark521)](https://launchpad.net/~fstark521) wrote on 2020-10-21: |  |  | [#1](/ubuntu/%2Bsource/jhead/%2Bbug/1900820/comments/1) |
| --- | --- | --- | --- |

* [poc](https://bugs.launchpad.net/ubuntu/%2Bsource/jhead/%2Bbug/1900820/%2Battachment/5424954/%2Bfiles/poc)
  [Edit](/ubuntu/%2Bsource/jhead/%2Bbug/1900820/%2Battachment/5424954)
  (279 bytes,
  application/octet-stream)

[See full activity log](https://bugs.launchpad.net/ubuntu/%2Bsource/jhead/%2Bbug/1900820/%2Bactivity)

To post a comment you must [log in](%2Blogin?comments=all).

* [Report a bug](/ubuntu/%2Bsource/jhead/%2Bfilebug)

This report contains
**Public**
information

Everyone can see this information.

You are
[not directly subscribed to this bug's notifications.](/ubuntu/%2Bsource/jhead/%2Bbug/1900820/%2Bsubscribe)

Subscribing...

* [Edit bug mail](https://bugs.launchpad.net/ubuntu/%2Bsource/jhead/%2Bbug/1900820/%2Bsubscriptions "View and change your subscriptions to this bug")

## Other bug subscribers

[Subscribe someone else](https://bugs.launchpad.net/ubuntu/%2Bsource/jhead/%2Bbug/1900820/%2Baddsubscriber "Launchpad will email that person whenever this bugs changes")

## Bug attachments

* [poc](https://bugs.launchpad.net/ubuntu/%2Bsource/jhead/%2Bbug/1900820/%2Battachment/5424954/%2Bfiles/poc)
  [Edit](/ubuntu/%2Bsource/jhead/%2Bbug/1900820/%2Battachment/5424954 "Change attachment details")

* [Add attachment](/ubuntu/%2Bsource/jhead/%2Bbug/1900820/%2Baddcomment)

## Remote bug watches

Bug watches keep track of this bug in other bug trackers.

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
 •
[Take the tour](https://launchpad.net/%2Btour)
 •
[Read the guide](https://help.launchpad.net/)

© 2004
[Canonical Ltd.](http://canonical.com/)
 •
[Terms of use](https://launchpad.net/legal)
 •
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
 •
[Contact Launchpad Support](/feedback)
 •
[Blog](http://blog.launchpad.net/)
 •
[Careers](https://canonical.com/careers)
 •
[System status](https://ubuntu.social/%40launchpadstatus)
 •
6394e03
([Get the code!](https://dev.launchpad.net/))

