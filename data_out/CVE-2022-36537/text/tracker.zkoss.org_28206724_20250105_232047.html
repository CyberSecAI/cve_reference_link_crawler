

[Log in](/login.jsp?os_destination=%2Fbrowse%2FZK-5150)[Skip to main content](#main)[Skip to sidebar](#sidebar)[![ZK-Tracker](/s/-n1wp6y/9120016/y46g9s/_/jira-logo-scaled.png)](https://tracker.zkoss.org/secure/MyJiraHome.jspa)

* [Dashboards](/secure/Dashboard.jspa "View and manage your dashboards")
* [Projects](/secure/BrowseProjects.jspa "View recent projects and browse a list of projects")
* [Issues](/issues/ "Search for issues and view recent issues")

* Give feedback to Atlassian
* [Help](https://docs.atlassian.com/jira/jcore-docs-0912/ "Help")
  + [Jira Core help](https://docs.atlassian.com/jira/jcore-docs-0912/ "Go to the online documentation for Jira Core")
  + [Keyboard Shortcuts](/secure/ViewKeyboardShortcuts%21default.jspa "Get more information about Jira's Keyboard Shortcuts")
  + [About Jira](/secure/AboutPage.jspa "Get more information about Jira")
  + [Jira Credits](/secure/credits/AroundTheWorld%21default.jspa "See who did what")
* [Log In](/login.jsp?os_destination=%2Fbrowse%2FZK-5150)

![Uploaded image for project: 'ZK'](https://tracker.zkoss.org/secure/projectavatar?pid=10000&avatarId=13701)

1. [ZK](/browse/ZK)
2. [ZK-5150](/browse/ZK-5150)

## Vulnerability in zk upload

[Log In](/login.jsp?os_destination=%2Fbrowse%2FZK-5150 "Log In")ClosedExportnullXMLWordPrintable
### Details

* **Type:**
  ![Icon: Bug](/secure/viewavatar?size=xsmall&avatarId=12403&avatarType=issuetype "Bug - A problem which impairs or prevents the functions of the product.") Bug
* **Resolution:**
  Fixed
* **Priority:**
  ![Icon: Normal](/images/icons/priorities/medium.svg "Normal - Normal") Normal
* **Fix Version/s:**
  [9.6.2](/issues/?jql=project+%3D+ZK+AND+fixVersion+%3D+9.6.2 "9.6.2 ")
* **Affects Version/s:**
  9.6.1
* **Component/s:**
  None
* **Security Level:**
  Jimmy
* **Labels:**
  + [defect](/issues/?jql=labels+%3D+defect "defect")
  + [security](/issues/?jql=labels+%3D+security "security")

* **Safety specification requirements:**
  None

### Description

## Secure versions

This vulnerability is resolved in versions:

* **9.6.2**
* 9.6.0.2 (security release)
* 9.5.1.4 (security release)
* 9.0.1.3 (security release)
* 8.6.4.2 (security release)

## Workaround

download attached classes, and add them to application in their declared package.

* For **ZK 8.6.0.1 to 9.6.1**: use [zk8601-to-zk961-patch.zip![](/images/icons/link_attachment_7.gif)](/secure/attachment/25341/25341_zk8601-to-zk961-patch.zip "zk8601-to-zk961-patch.zip attached to ZK-5150")
* For **ZK 8.0.2 to 8.6.0**: use [zk802-to-zk8600-patch.zip![](/images/icons/link_attachment_7.gif)](/secure/attachment/25340/25340_zk802-to-zk8600-patch.zip "zk802-to-zk8600-patch.zip attached to ZK-5150")
* For **ZK 8.0.1 and before**: contact [[email protected]![](/images/icons/mail_small.gif)](/cdn-cgi/l/email-protection#1c75727a735c6677736f6f32736e7b)

register in zk.xml

```

	<listener>
	    <listener-class>org.zkoss.support.patch.AuUploadWebAppInit</listener-class>
	</listener>

	<system-config>
		<file-item-factory-class>org.zkoss.support.patch.UploadFixItemFactory</file-item-factory-class>
	</system-config>

```
## Vulnerability details

Thanks to Markus Wulftange of Code White GmbH for discovering and reporting this issue, as well as cooperating with us in its resolution.

ZK AuUploader servlets contains a security vulnerability which can be exploited to retrieve the content of a file located in the web context. This includes files normally hidden from the user located in WEB-INF, such as web.xml, zk.xml, etc.

In the unsecure versions, an attacker may send a forged request to the /zkau/upload endpoint.

If the forged request contains the nextURI parameter, the AuUploader will try to forward the request internally, and output the document found if any into the response.

Since this is an internal forward, it can access documents located in restricted WEB-INF folder, which exposes internal files such as web.xml, zk.xml and other files located in this directory.

This vulnerability affects ZK versions below the secure version list provided above.

The secure list contains security releases for ZK branches from 8.6.X up to 9.6.0.X, and the main release 9.6.2

## National Vulnerability Database (NVD)

This bug is recorded as [CVE-2022-36537](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-36537)

### Attachments

### Attachments

* Options
  + - [Sort By Name](/browse/ZK-5150?attachmentSortBy=fileName#attachmentmodule "viewissue.subtasks.tab.show.all.name")
    - [Sort By Date](/browse/ZK-5150?attachmentSortBy=dateTime#attachmentmodule "Sort By Date")
    - [Ascending](/browse/ZK-5150?attachmentOrder=asc#attachmentmodule "Ascending")
    - [Descending](/browse/ZK-5150?attachmentOrder=desc#attachmentmodule "Descending")
    - [Thumbnails](/browse/ZK-5150?attachmentViewMode=gallery#attachmentmodule "Thumbnails")
    - [List](/browse/ZK-5150?attachmentViewMode=list#attachmentmodule "List")
    - [Download All](/secure/attachmentzip/28932.zip "Download all attachments as a ZIP file")

1. [zk802-to-zk8600-patch.zip](/secure/attachment/25340/zk802-to-zk8600-patch.zip "zk802-to-zk8600-patch.zip - Latest 19/May/22 8:54 AM - MDuchemin")2 kB19/May/22 8:54 AM
2. [zk8601-to-zk961-patch.zip](/secure/attachment/25341/zk8601-to-zk961-patch.zip "zk8601-to-zk961-patch.zip - Latest 19/May/22 8:54 AM - MDuchemin")2 kB19/May/22 8:54 AM
### Activity

### People

Assignee:

![DevChu](https://tracker.zkoss.org/secure/useravatar?size=small&avatarId=10122)
DevChu

Reporter:

![hawk](https://tracker.zkoss.org/secure/useravatar?size=small&avatarId=10122)
hawk

Votes:
0
Vote for this issue

Watchers:
2
Start watching this issue

### Dates

Created:

04/May/22 10:22 AM

Updated:

01/Feb/24 1:28 AM

Resolved:

05/May/22 1:28 AM

* Atlassian Jira [Project Management Software](https://www.atlassian.com/software/jira)
* [About Jira](/secure/AboutPage.jspa/secure/AboutPage.jspa)
* [Report a problem](/secure/CreateIssue%21default.jspa)

Powered by a free Atlassian [Jira](http://www.atlassian.com/software/jira) open source license for ZK - Leading Enterprise Ajax Solutions. Try Jira - [bug tracking software](http://www.atlassian.com/software/jira) for *your* team.

[Atlassian](http://www.atlassian.com/)

