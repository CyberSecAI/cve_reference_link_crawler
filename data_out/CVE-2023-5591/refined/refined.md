Based on the provided content, here's an analysis of the vulnerability:

**Root Cause of Vulnerability:**

*   The root cause is an SQL injection vulnerability in the `address-search.inc.php` file of the LibreNMS project. The code was using an unparameterized variable when constructing an SQL query to search for MAC addresses. Specifically, the `ifPhysAddress` field was being queried using `LIKE` with a string directly injected into the SQL query from the `$vars['address']` variable, after some sanitization.

**Weaknesses/Vulnerabilities Present:**

*   **SQL Injection:** The primary weakness is the use of string concatenation to build the SQL query. Even though some characters are removed, it's still vulnerable to injection. An attacker could craft a malicious string in `$vars['address']` that would inject arbitrary SQL into the query.

**Impact of Exploitation:**

*   **Data Breach:** Successful exploitation could allow an attacker to read, modify, or delete data from the database.
*   **Privilege Escalation:** In some database configurations, SQL injection can be used to gain higher levels of access or execute operating system commands on the database server.

**Attack Vectors:**

*   The attack vector is through the `address-search.inc.php` script, specifically when the `search_type` is set to `mac`.
*   An attacker can manipulate the `$vars['address']` input to inject malicious SQL code.

**Required Attacker Capabilities/Position:**

*   The attacker needs to be able to interact with the `address-search.inc.php` script and be able to control the input parameters, especially the `address` variable. This likely requires being an authenticated user, but the access control required is not specified.

**Additional Notes:**

*   The provided diff shows that the vulnerability was addressed by switching to a parameterized query using `?` placeholders. The `$param` array is then used to safely insert the sanitized search string.
*   The original code used string concatenation with a `LIKE` clause, which is a common pattern in SQL injection vulnerabilities.
*  The fix sanitizes the input by removing certain characters (`:`, ` `, `-`, `.`, `0x`) before using it in the query, which is not sufficient to prevent SQL injection.
* The commit message "Fix MAC search sql injection" and the code diff clearly relate to SQL injection.