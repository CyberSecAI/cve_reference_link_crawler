<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>oss-security - Re: Linux: Race can lead to UAF in net/bluetooth/sco.c: sco_sock_connect()</title>

<link href="/style.css" type="text/css" rel="stylesheet">
<style type="text/css">
.calendar { text-align: center; }
.ccell { background: #ccc; width: 5ex; padding: 2px; }

.cal_brief { text-align: center; }
.cal_brief td:first-child { background: inherit; }
.cal_brief td { background: #ccc; width: 5ex; padding: 2px; }
.cal_big { text-align: center; padding: 0; margin: 0; }
.cal_big td { padding: 0 2px; }
.cal_mon { text-align: center; }
.cal_mon th { font-size: small; padding: 0; margin: 0; }
.cal_mon td { background: #ccc; width: 5ex; height: 1.5em;
	padding: 2px; text-align: right; }
.cal_mon td[colspan] { background: inherit; }
.cal_mon sup { color: #F0F0F0; text-align: left; float: left;
	margin-top: -2pt; font-weight: bold; }
.cal_mon a { text-align: right; margin-left: -4em; float: right; }
</style>
</head>

<BODY bgcolor="#E0E0E0" text="black" link="blue" alink="red" vlink="navy">


<table bgcolor="#ffffff" width="100%" border="0" cellspacing="0" cellpadding="0">
<tr>

<td>
<a href="/"><img class="logo" src="/logo.png" border="0" width="182" height="80" alt="Openwall"></a>
<td width="100%">
<div class="nav">
<ul>
<li><a href="/">Products</a>
<ul>
<li><a href="/Owl/">Openwall GNU/*/Linux &nbsp; <i>server OS</i></a>
<li><a href="/lkrg/">Linux Kernel Runtime Guard</a>
<li><a href="/john/">John the Ripper &nbsp; <i>password cracker</i></a>
<ul>
<li><a href="/john/">Free &amp; Open Source for any platform</a>
<li><a href="/john/cloud/">in the cloud</a>
<li><a href="/john/pro/linux/">Pro for Linux</a>
<li><a href="/john/pro/macosx/">Pro for macOS</a>
</ul>
<li><a href="/wordlists/">Wordlists &nbsp; <i>for password cracking</i></a>
<li><a href="/passwdqc/">passwdqc &nbsp; <i>policy enforcement</i></a>
<ul>
<li><a href="/passwdqc/">Free &amp; Open Source for Unix</a>
<li><a href="/passwdqc/windows/">Pro for Windows (Active Directory)</a>
</ul>
<li><a href="/yescrypt/">yescrypt &nbsp; <i>KDF &amp; password hashing</i></a>
<li><a href="/yespower/">yespower &nbsp; <i>Proof-of-Work (PoW)</i></a>
<li><a href="/crypt/">crypt_blowfish &nbsp; <i>password hashing</i></a>
<li><a href="/phpass/">phpass &nbsp; <i>ditto in PHP</i></a>
<li><a href="/tcb/">tcb &nbsp; <i>better password shadowing</i></a>
<li><a href="/pam/">Pluggable Authentication Modules</a>
<li><a href="/scanlogd/">scanlogd &nbsp; <i>port scan detector</i></a>
<li><a href="/popa3d/">popa3d &nbsp; <i>tiny POP3 daemon</i></a>
<li><a href="/blists/">blists &nbsp; <i>web interface to mailing lists</i></a>
<li><a href="/msulogin/">msulogin &nbsp; <i>single user mode login</i></a>
<li><a href="/php_mt_seed/">php_mt_seed &nbsp; <i>mt_rand() cracker</i></a>
</ul>
<li><a href="/services/">Services</a>
<li id="narrow-li-1"><a>Publications</a>
<ul>
<li><a href="/articles/">Articles</a>
<li><a href="/presentations/">Presentations</a>
</ul>
<li><a>Resources</a>
<ul>
<li><a href="/lists/">Mailing lists</a>
<li><a href="https://openwall.info/wiki/">Community wiki</a>
<li><a href="https://github.com/openwall">Source code repositories (GitHub)</a>
<li><a href="https://cvsweb.openwall.com">Source code repositories (CVSweb)</a>
<li><a href="/mirrors/">File archive &amp; mirrors</a>
<li><a href="/signatures/">How to verify digital signatures</a>
<li><a href="/ove/">OVE IDs</a>
</ul>
<li id="last-li"><a href="/news">What's new</a>
</ul>
</div>


</table>


<TABLE bgcolor="#B4D0DC" width="100%" border="0" cellspacing="0" cellpadding="1">
<TR><TD>
<TABLE width="100%" border="0" cellspacing="0" cellpadding="2">
<TR><TD bgcolor="#ECF8FF">
<a href="https://hashsuite.openwall.net">
Hash Suite - Windows password security audit tool. GUI, reports in PDF.</a>

</TABLE>
</TABLE>

<a href="../../../2024/11/29/3">[&lt;prev]</a> <a href="2">[next&gt;]</a> <a href="../../../2024/11/29/1">[&lt;thread-prev]</a> <a href="2">[thread-next&gt;]</a> <a href=".">[day]</a> <a href="..">[month]</a> <a href="../..">[year]</a> <a href="../../..">[list]</a>
<pre style="white-space: pre-wrap">
Message-ID: &lt;CABBYNZKNpv7ArhxYoZhO8S5zdqFj9ydMb+eg9tyzDF-i+g=N5g&#64;mail.gmail.com&gt;
Date: Fri, 29 Nov 2024 21:41:12 -0500
From: Luiz Augusto von Dentz &lt;luiz.dentz&#64;...il.com&gt;
To: Solar Designer &lt;solar&#64;...nwall.com&gt;
Cc: oss-security&#64;...ts.openwall.com, tianshu qiu &lt;jimuchutianshu97&#64;...il.com&gt;, 
	Marcel Holtmann &lt;marcel&#64;...tmann.org&gt;, Johan Hedberg &lt;johan.hedberg&#64;...il.com&gt;
Subject: Re: Linux: Race can lead to UAF in net/bluetooth/sco.c: sco_sock_connect()

Hi,

On Thu, Nov 28, 2024 at 11:41â€¯PM Solar Designer &lt;solar&#64;...nwall.com&gt; wrote:
&gt;
&gt; Hi,
&gt;
&gt; Upon expiration of the maximum of 14 days embargo, I am forwarding a
&gt; vulnerability report (and a couple of replies) that was erroneously
&gt; sent to the linux-distros list and then was not fully handled.  We
&gt; require information actionable for the distros within the maximum of 14
&gt; days, which generally means that the upstream should be contacted first
&gt; and should have a fix ready for the distros to include (or at least
&gt; should expect that by the proposed public disclosure date).  The
&gt; specific wording we use is:
&gt;
&gt; "For Linux kernel issues, you must notify the kernel security team first,
&gt; wait for the fix, and only then notify linux-distros or oss-security
&gt; (depending on whether the information is still private or already
&gt; public, as well as on issue severity)."
&gt;
&gt; While we assume good faith even if the report is misaddressed (which we
&gt; understand does happen as instructions are naturally more complicated
&gt; than we'd have liked), unfortunately this time the reporter also did not
&gt; reply to any of linux-distros' members questions, most notably "have you
&gt; contacted either security&#64;...nel.org or the bluetooth maintainers about
&gt; this issue?"  Ideally, someone from linux-distros should have taken over
&gt; and handled this fully - including asking s@k.o and the maintainers
&gt; directly - but unfortunately this also did not happen this time.
&gt;
&gt; As you can see from the messages below, the issue may be the same as
&gt; CVE-2024-27398 fixed by commit 483bc08181827fc475643272ffb69c533007e546
&gt; ("Bluetooth: Fix use-after-free bugs caused by sco_sock_timeout").  The
&gt; report claims that the "race condition bug has not been solved yet" by
&gt; this commit, but then the only testing appears to have been on a kernel
&gt; pre-dating this commit.
&gt;
&gt; I'm also attaching here some of the files from the reporter's referenced
&gt; GitHub repo.  The main claimed PoC is a 9 MB file Linux-6.8.0-PoC.webm,
&gt; not attached here, but I do attach the proposed patch, test.c "test case
&gt; after patch" (as the commit message said), and most-relevant files from
&gt; inside PoC.zip.  I preserved the filenames, but edited the Makefile and
&gt; #include directives to avoid dependency on otherwise-unused files.  Both
&gt; programs (test.c and poc.c) build for me on Rocky Linux 9.5 with
&gt; bluez-libs-devel and fuse-devel installed.  I did not try running them.
&gt;
&gt; On a related note, my searching Linux kernel mailing lists for related
&gt; keywords finds other issues also in Bluetooth and even specifically in
&gt; SCO triggered by syzbot and with recent proposed patches:
&gt;
&gt; 2024-11-25 13:16 [syzbot] [bluetooth?] KASAN: slab-use-after-free Read in sco_sock_connect syzbot
&gt; 2024-11-25 23:58 ` [PATCH] Bluetooth: SCO: remove the redundant sco_conn_put Edward Adam Davis

Well, I guess we are still expecting this to be handled via
security&#64;...nel.org? And while there are some changes to SCO related
to sco_conn lifetime, and the patches mentioned above do not affect
the sco_connect to be invoked while helding sock_hold (proposed fix),
that said first we probably need to confirm the problem is still
reproducible upstream, if that is still reproducible I suspect we can
apply a similar fix that was done for ISO sockets since it is quite
similar to SCO sockets:

d40ae85ee62e ("Bluetooth: ISO: fix iso_conn related locking and
validity issues")

&gt; Alexander
&gt;
&gt; From: tianshu qiu &lt;jimuchutianshu97&#64;...il.com&gt;
&gt; To: linux-distros
&gt; Subject: [vs-plain] Race condition vulnerability that can lead to UAF in net/bluetooth/sco.c:sco_sock_connect
&gt; Date: Thu, 14 Nov 2024 18:35:24 +0800
&gt;
&gt; On Thu, Nov 14, 2024 at 06:35:24PM +0800, tianshu qiu wrote:
&gt; &gt; The bug was introduced on Apr 11, 2023:
&gt; &gt; <a href="https://github.com/torvalds/linux/commit/9a8ec9e8ebb5a7c0cfbce2d6b4a6b67b2b78e8f3" rel="nofollow">https://github.com/torvalds/linux/commit/9a8ec9e8ebb5a7c0cfbce2d6b4a6b67b2b78e8f3</a>
&gt; &gt;
&gt; &gt; =*=*=*=*=*=*=*=*==*=*=*=*=*=*=*=*==*=*=*=*=*=*=*=*= BUG DETAILS
&gt; &gt; =*=*=*=*=*=*=*=*==*=*=*=*=*=*=*=*==*=*=*=*=*=*=*=*==*=*=*=*=*=*=*=*=
&gt; &gt;
&gt; &gt; I found the bug when looking for unlocked access to ???struct sock???
&gt; &gt; objects in the ???net??? directory. I think that "struct sock" is shared
&gt; &gt; among multiple threads.
&gt; &gt; Access to struct sock object, especially reading and writing sk
&gt; &gt; -&gt;sk_state, should call lock_sock(sk) in advance to lock, and call
&gt; &gt; release_sock(sk) to
&gt; &gt; unlock after the last access to ???struct sock??? object, so as to prevent
&gt; &gt; race between threads.
&gt; &gt;
&gt; &gt; =*=*=*=*=*=*=*=*==*=*=*=*=*=*=*=*==*=*=*=*=*=*=*=*==*=*=*=*=*=*=*=*==*=*=*=*=*=*=*=*==*=*=*=*=*=*=*=*==*=*=*=*=*=*=*=*==*=*=*=*=*=*=*=*=
&gt; &gt;
&gt; &gt; static int sco_sock_connect(struct socket *sock, struct sockaddr
&gt; &gt; *addr, int alen, int flags)
&gt; &gt; {
&gt; &gt;         struct sockaddr_sco *sa = (struct sockaddr_sco *) addr;
&gt; &gt;         struct sock *sk = sock-&gt;sk;
&gt; &gt;         int err;
&gt; &gt;
&gt; &gt;         BT_DBG("sk %p", sk);
&gt; &gt;
&gt; &gt;         if (alen &lt; sizeof(struct sockaddr_sco) ||
&gt; &gt;         addr-&gt;sa_family != AF_BLUETOOTH)
&gt; &gt;         return -EINVAL;
&gt; &gt;
&gt; &gt;         if (sk-&gt;sk_state != BT_OPEN &amp;&amp; sk-&gt;sk_state != BT_BOUND)
&gt; &gt;                 return -EBADFD;
&gt; &gt;
&gt; &gt;         if (sk-&gt;sk_type != SOCK_SEQPACKET)
&gt; &gt;                 err = -EINVAL;
&gt; &gt;
&gt; &gt;         lock_sock(sk);
&gt; &gt;               // first lock-release pair
&gt; &gt;         /* Set destination address and psm */
&gt; &gt;         bacpy(&amp;sco_pi(sk)-&gt;dst, &amp;sa-&gt;sco_bdaddr);
&gt; &gt;         release_sock(sk);
&gt; &gt;            // first lock-release pair
&gt; &gt;
&gt; &gt;         err = sco_connect(sk);
&gt; &gt;         if (err)
&gt; &gt;                 return err;
&gt; &gt;
&gt; &gt;         lock_sock(sk);
&gt; &gt;                  // second lock-release pair
&gt; &gt;
&gt; &gt;         err = bt_sock_wait_state(sk, BT_CONNECTED,
&gt; &gt;         sock_sndtimeo(sk, flags &amp; O_NONBLOCK));
&gt; &gt;
&gt; &gt;         release_sock(sk);
&gt; &gt;              // second lock-release pair
&gt; &gt;         return err;
&gt; &gt; }
&gt; &gt;
&gt; &gt;
&gt; &gt;
&gt; &gt; static int sco_connect(struct sock *sk)
&gt; &gt; {
&gt; &gt;         struct sco_conn *conn;
&gt; &gt;         struct hci_conn *hcon;
&gt; &gt;         struct hci_dev  *hdev;
&gt; &gt;
&gt; &gt;         ??????
&gt; &gt;
&gt; &gt;         hdev = hci_get_route(&amp;sco_pi(sk)-&gt;dst, &amp;sco_pi(sk)-&gt;src, BDADDR_BREDR);
&gt; &gt;         if (!hdev)
&gt; &gt;                 return -EHOSTUNREACH;
&gt; &gt;
&gt; &gt;         hci_dev_lock(hdev);
&gt; &gt;
&gt; &gt;         ??????
&gt; &gt;
&gt; &gt;         hcon = hci_connect_sco(hdev, type, &amp;sco_pi(sk)-&gt;dst,
&gt; &gt;         sco_pi(sk)-&gt;setting, &amp;sco_pi(sk)-&gt;codec);
&gt; &gt;
&gt; &gt;         ??????
&gt; &gt;
&gt; &gt;         lock_sock(sk);
&gt; &gt;                  // third lock-release pair
&gt; &gt;
&gt; &gt;         err = sco_chan_add(conn, sk, NULL);
&gt; &gt;         if (err) {
&gt; &gt;                 release_sock(sk);
&gt; &gt;                 goto unlock;
&gt; &gt;         }
&gt; &gt;
&gt; &gt;         /* Update source addr of the socket */
&gt; &gt;         bacpy(&amp;sco_pi(sk)-&gt;src, &amp;hcon-&gt;src);
&gt; &gt;
&gt; &gt;         if (hcon-&gt;state == BT_CONNECTED) {
&gt; &gt;                 sco_sock_clear_timer(sk);
&gt; &gt;                 sk-&gt;sk_state = BT_CONNECTED;
&gt; &gt;         } else {
&gt; &gt;                 sk-&gt;sk_state = BT_CONNECT;
&gt; &gt;                 sco_sock_set_timer(sk, sk-&gt;sk_sndtimeo);
&gt; &gt;         }
&gt; &gt;
&gt; &gt;         release_sock(sk);
&gt; &gt;              // third lock-release pair
&gt; &gt;
&gt; &gt;         ......
&gt; &gt;
&gt; &gt; }
&gt; &gt;
&gt; &gt; =*=*=*=*=*=*=*=*==*=*=*=*=*=*=*=*==*=*=*=*=*=*=*=*==*=*=*=*=*=*=*=*==*=*=*=*=*=*=*=*==*=*=*=*=*=*=*=*==*=*=*=*=*=*=*=*==*=*=*=*=*=*=*=*=
&gt; &gt;
&gt; &gt; To avoid possible circular locking, the commit that introduced the bug
&gt; &gt; splits the "lock-release" pair which protects the whole
&gt; &gt; sco_sock_connect to three parts.
&gt; &gt;
&gt; &gt; The "if" branch for determining sk -&gt;sk_state in sco_sock_connect is
&gt; &gt; exposed outside the lock_sock(sk) protection, which can lead to race
&gt; &gt; condition if two threads
&gt; &gt; execute ???connect??? system calls simultaneously.
&gt; &gt; This will lead to dangling ???struct sco_conn??? object in the function
&gt; &gt; sco_chan_add, the calling procedure is:
&gt; &gt; sco_sock_connect -&gt; sco_connect -&gt; sco_chan_add -&gt; __sco_chan_add.
&gt; &gt;
&gt; &gt; The timer associated to this dangling ???struct sco_conn??? object is
&gt; &gt; still work, even if the "struct sock" object was freed by the system
&gt; &gt; call "close", which will cause
&gt; &gt; UAF when timeout is reached.
&gt; &gt;
&gt; &gt; Although the following two commits attempt to solve the UAF issue in
&gt; &gt; sco_sock_timeout, race condition bug has not been solved yet:
&gt; &gt;
&gt; &gt; <a href="https://github.com/torvalds/linux/commit/1bf4470a3939c678fb822073e9ea77a0560bc6bb" rel="nofollow">https://github.com/torvalds/linux/commit/1bf4470a3939c678fb822073e9ea77a0560bc6bb</a>
&gt; &gt; <a href="https://github.com/torvalds/linux/commit/483bc08181827fc475643272ffb69c533007e546" rel="nofollow">https://github.com/torvalds/linux/commit/483bc08181827fc475643272ffb69c533007e546</a>
&gt; &gt;
&gt; &gt; This is a serious vulnerability that can cause local privilege
&gt; &gt; escalation. I hope this vulnerability can be patched and assigned a
&gt; &gt; CVE number.
&gt; &gt;
&gt; &gt; =*=*=*=*=*=*=*=*==*=*=*=*=*=*=*=*==*=*=*=*=*=*=*=*==*=*=*=*=*=*=*=*=
&gt; &gt; DMESG LOG =*=*=*=*=*=*=*=*==*=*=*=*=*=*=*=*==*=*=*=*=*=*=*=*==*=*=*=*=*=*=*=*=
&gt; &gt;
&gt; &gt;
&gt; &gt; [ 1084.906919] BUG: KASAN: slab-use-after-free in sco_conn_del+0xa6/0x220
&gt; &gt; [ 1084.906940] Write of size 4 at addr ffff888122c06880 by task
&gt; &gt; kworker/u265:0/162
&gt; &gt;
&gt; &gt; [ 1084.906955] CPU: 0 PID: 162 Comm: kworker/u265:0 Not tainted 6.8.0 #4
&gt; &gt; [ 1084.906966] Hardware name: VMware, Inc. VMware Virtual
&gt; &gt; Platform/440BX Desktop Reference Platform, BIOS 6.00 11/12/2020
&gt; &gt; [ 1084.906974] Workqueue: hci0 hci_rx_work
&gt; &gt; [ 1084.906991] Call Trace:
&gt; &gt; [ 1084.906996]  &lt;TASK&gt;
&gt; &gt; [ 1084.907004]  dump_stack_lvl+0x48/0x70
&gt; &gt; [ 1084.907018]  print_report+0xd2/0x670
&gt; &gt; [ 1084.907028]  ? __pfx__raw_spin_lock_irqsave+0x10/0x10
&gt; &gt; [ 1084.907039]  ? kasan_complete_mode_report_info+0x8a/0x230
&gt; &gt; [ 1084.907052]  kasan_report+0xd7/0x120
&gt; &gt; [ 1084.907060]  ? sco_conn_del+0xa6/0x220
&gt; &gt; [ 1084.907070]  ? sco_conn_del+0xa6/0x220
&gt; &gt; [ 1084.907082]  kasan_check_range+0x11c/0x200
&gt; &gt; [ 1084.907092]  __kasan_check_write+0x14/0x30
&gt; &gt; [ 1084.907103]  sco_conn_del+0xa6/0x220
&gt; &gt; [ 1084.907114]  sco_connect_cfm+0x1d4/0xac0
&gt; &gt; [ 1084.907125]  ? __pfx_sco_connect_cfm+0x10/0x10
&gt; &gt; [ 1084.907135]  ? __pfx_mutex_lock+0x10/0x10
&gt; &gt; [ 1084.907147]  hci_sco_setup+0x397/0x570
&gt; &gt; [ 1084.907157]  ? __pfx_hci_sco_setup+0x10/0x10
&gt; &gt; [ 1084.907165]  ? __pfx_mutex_lock+0x10/0x10
&gt; &gt; [ 1084.907176]  hci_conn_complete_evt+0x957/0x1150
&gt; &gt; [ 1084.907186]  ? kasan_save_track+0x14/0x40
&gt; &gt; [ 1084.907196]  ? __pfx_hci_conn_complete_evt+0x10/0x10
&gt; &gt; [ 1084.907205]  ? __kasan_check_write+0x14/0x30
&gt; &gt; [ 1084.907216]  ? mutex_unlock+0x81/0xe0
&gt; &gt; [ 1084.907224]  ? __pfx_mutex_unlock+0x10/0x10
&gt; &gt; [ 1084.907235]  hci_event_packet+0x818/0x1080
&gt; &gt; [ 1084.907246]  ? __pfx_hci_conn_complete_evt+0x10/0x10
&gt; &gt; [ 1084.907256]  ? __pfx_hci_event_packet+0x10/0x10
&gt; &gt; [ 1084.907266]  ? __pfx__raw_spin_lock_irqsave+0x10/0x10
&gt; &gt; [ 1084.907275]  ? __pfx_hci_cmd_sync_complete+0x10/0x10
&gt; &gt; [ 1084.907286]  ? __kasan_check_read+0x11/0x20
&gt; &gt; [ 1084.907297]  hci_rx_work+0x312/0xd60
&gt; &gt; [ 1084.907308]  ? __pfx__raw_spin_lock_irq+0x10/0x10
&gt; &gt; [ 1084.907318]  process_one_work+0x577/0xd30
&gt; &gt; [ 1084.907371]  ? _raw_spin_lock_irq+0x8b/0x100
&gt; &gt; [ 1084.907384]  worker_thread+0x879/0x15a0
&gt; &gt; [ 1084.907392]  ? __pfx__raw_spin_lock_irqsave+0x10/0x10
&gt; &gt; [ 1084.907403]  ? __pfx_worker_thread+0x10/0x10
&gt; &gt; [ 1084.907411]  kthread+0x2b7/0x390
&gt; &gt; [ 1084.907421]  ? __pfx_kthread+0x10/0x10
&gt; &gt; [ 1084.907431]  ret_from_fork+0x44/0x90
&gt; &gt; [ 1084.907442]  ? __pfx_kthread+0x10/0x10
&gt; &gt; [ 1084.907451]  ret_from_fork_asm+0x1b/0x30
&gt; &gt; [ 1084.907497]  &lt;/TASK&gt;
&gt; &gt;
&gt; &gt; [ 1084.907506] Allocated by task 3974:
&gt; &gt; [ 1084.907513]  kasan_save_stack+0x39/0x70
&gt; &gt; [ 1084.907522]  kasan_save_track+0x14/0x40
&gt; &gt; [ 1084.907527]  kasan_save_alloc_info+0x37/0x60
&gt; &gt; [ 1084.907537]  __kasan_kmalloc+0xc3/0xd0
&gt; &gt; [ 1084.907543]  __kmalloc+0x21f/0x530
&gt; &gt; [ 1084.907551]  sk_prot_alloc+0x16d/0x220
&gt; &gt; [ 1084.907560]  sk_alloc+0x35/0x750
&gt; &gt; [ 1084.907568]  bt_sock_alloc+0x2f/0x360
&gt; &gt; [ 1084.907576]  sco_sock_create+0xc6/0x390
&gt; &gt; [ 1084.907617]  bt_sock_create+0x152/0x320
&gt; &gt; [ 1084.907629]  __sock_create+0x212/0x500
&gt; &gt; [ 1084.907636]  __sys_socket+0x139/0x210
&gt; &gt; [ 1084.907670]  __x64_sys_socket+0x72/0xc0
&gt; &gt; [ 1084.907677]  do_syscall_64+0x82/0x180
&gt; &gt; [ 1084.907684]  entry_SYSCALL_64_after_hwframe+0x6e/0x76
&gt; &gt;
&gt; &gt; [ 1084.907750] Freed by task 3974:
&gt; &gt; [ 1084.907755]  kasan_save_stack+0x39/0x70
&gt; &gt; [ 1084.907760]  kasan_save_track+0x14/0x40
&gt; &gt; [ 1084.907764]  kasan_save_free_info+0x3b/0x60
&gt; &gt; [ 1084.907769]  poison_slab_object+0x10a/0x180
&gt; &gt; [ 1084.907773]  __kasan_slab_free+0x33/0x60
&gt; &gt; [ 1084.907777]  kfree+0xda/0x2f0
&gt; &gt; [ 1084.907782]  __sk_destruct+0x44e/0x640
&gt; &gt; [ 1084.907787]  sk_destruct+0xaa/0xd0
&gt; &gt; [ 1084.907792]  __sk_free+0xa5/0x300
&gt; &gt; [ 1084.907797]  sk_free+0x50/0x80
&gt; &gt; [ 1084.907802]  sco_sock_kill+0x12e/0x160
&gt; &gt; [ 1084.907808]  sco_sock_release+0x134/0x290
&gt; &gt; [ 1084.907813]  __sock_release+0xac/0x270
&gt; &gt; [ 1084.907817]  sock_close+0x15/0x30
&gt; &gt; [ 1084.907821]  __fput+0x205/0xa90
&gt; &gt; [ 1084.907825]  __fput_sync+0x3a/0x50
&gt; &gt; [ 1084.907829]  __x64_sys_close+0x7e/0xe0
&gt; &gt; [ 1084.907835]  do_syscall_64+0x82/0x180
&gt; &gt; [ 1084.907839]  entry_SYSCALL_64_after_hwframe+0x6e/0x76
&gt; &gt;
&gt; &gt; [ 1084.907847] The buggy address belongs to the object at ffff888122c06800
&gt; &gt;          which belongs to the cache kmalloc-rnd-04-1k of size 1024
&gt; &gt; [ 1084.907852] The buggy address is located 128 bytes inside of
&gt; &gt;          freed 1024-byte region [ffff888122c06800, ffff888122c06c00)
&gt; &gt;
&gt; &gt; [ 1084.907861] The buggy address belongs to the physical page:
&gt; &gt; [ 1084.907865] page:00000000dd0be509 refcount:1 mapcount:0
&gt; &gt; mapping:0000000000000000 index:0x0 pfn:0x122c00
&gt; &gt; [ 1084.907871] head:00000000dd0be509 order:3 entire_mapcount:0
&gt; &gt; nr_pages_mapped:0 pincount:0
&gt; &gt; [ 1084.907876] flags:
&gt; &gt; 0x17ffffc0000840(slab|head|node=0|zone=2|lastcpupid=0x1fffff)
&gt; &gt; [ 1084.907882] page_type: 0xffffffff()
&gt; &gt; [ 1084.907887] raw: 0017ffffc0000840 ffff88810004f040 dead000000000122
&gt; &gt; 0000000000000000
&gt; &gt; [ 1084.907892] raw: 0000000000000000 0000000080100010 00000001ffffffff
&gt; &gt; 0000000000000000
&gt; &gt; [ 1084.907895] page dumped because: kasan: bad access detected
&gt; &gt;
&gt; &gt; [ 1084.907900] Memory state around the buggy address:
&gt; &gt; [ 1084.907904]  ffff888122c06780: fc fc fc fc fc fc fc fc fc fc fc fc
&gt; &gt; fc fc fc fc
&gt; &gt; [ 1084.907908]  ffff888122c06800: fa fb fb fb fb fb fb fb fb fb fb fb
&gt; &gt; fb fb fb fb
&gt; &gt; [ 1084.907913] &gt;ffff888122c06880: fb fb fb fb fb fb fb fb fb fb fb fb
&gt; &gt; fb fb fb fb
&gt; &gt; [ 1084.907916]                    ^
&gt; &gt; [ 1084.907920]  ffff888122c06900: fb fb fb fb fb fb fb fb fb fb fb fb
&gt; &gt; fb fb fb fb
&gt; &gt; [ 1084.907923]  ffff888122c06980: fb fb fb fb fb fb fb fb fb fb fb fb
&gt; &gt; fb fb fb fb
&gt; &gt; [ 1084.907927] ==================================================================
&gt; &gt; [ 1084.908048] Disabling lock debugging due to kernel taint
&gt; &gt; [ 1084.908054] ------------[ cut here ]------------
&gt; &gt; [ 1084.908057] refcount_t: addition on 0; use-after-free.
&gt; &gt; [ 1084.908141] WARNING: CPU: 0 PID: 162 at lib/refcount.c:25
&gt; &gt; refcount_warn_saturate+0x171/0x1a0
&gt; &gt; [ 1084.908174] Modules linked in: isofs snd_seq_dummy snd_hrtimer qrtr
&gt; &gt; intel_rapl_msr intel_rapl_common intel_uncore_frequency_common
&gt; &gt; intel_pmc_core intel_vsec pmt_telemetry pmt_class crct10dif_pclmul
&gt; &gt; polyval_clmulni snd_ens1371 polyval_generic snd_ac97_codec
&gt; &gt; ghash_clmulni_intel gameport sha256_ssse3 ac97_bus vmw_balloon
&gt; &gt; sha1_ssse3 snd_pcm aesni_intel uvcvideo crypto_simd snd_seq_midi
&gt; &gt; cryptd rapl snd_seq_midi_event videobuf2_vmalloc uvc snd_rawmidi
&gt; &gt; videobuf2_memops videobuf2_v4l2 snd_seq snd_seq_device videodev
&gt; &gt; snd_timer videobuf2_common snd mc btusb btmtk soundcore i2c_piix4
&gt; &gt; input_leds joydev mac_hid serio_raw vsock_loopback binfmt_misc
&gt; &gt; vmw_vsock_virtio_transport_common vmw_vsock_vmci_transport vsock
&gt; &gt; vmw_vmci sch_fq_codel ramoops reed_solomon vmwgfx drm_ttm_helper ttm
&gt; &gt; msr parport_pc ppdev lp parport efi_pstore nfnetlink dmi_sysfs
&gt; &gt; ip_tables x_tables autofs4 hid_generic crc32_pclmul usbhid psmouse
&gt; &gt; mptspi mptscsih e1000 ahci mptbase libahci scsi_transport_spi
&gt; &gt; pata_acpi floppy
&gt; &gt; [ 1084.908607] CPU: 0 PID: 162 Comm: kworker/u265:0 Tainted: G    B
&gt; &gt;           6.8.0 #4
&gt; &gt; [ 1084.908614] Hardware name: VMware, Inc. VMware Virtual
&gt; &gt; Platform/440BX Desktop Reference Platform, BIOS 6.00 11/12/2020
&gt; &gt; [ 1084.908618] Workqueue: hci0 hci_rx_work
&gt; &gt; [ 1084.908627] RIP: 0010:refcount_warn_saturate+0x171/0x1a0
&gt; &gt; [ 1084.908634] Code: 1d 81 1a eb 03 80 fb 01 0f 87 13 6f df 01 83 e3
&gt; &gt; 01 0f 85 4f ff ff ff 48 c7 c7 40 1c aa 84 c6 05 61 1a eb 03 01 e8 ef
&gt; &gt; de c3 fe &lt;0f&gt; 0b e9 35 ff ff ff 48 89 df e8 f0 99 59 ff e9 bc fe ff ff
&gt; &gt; 48 c7
&gt; &gt; [ 1084.908639] RSP: 0018:ffff888134717940 EFLAGS: 00010246
&gt; &gt; [ 1084.908644] RAX: 0000000000000000 RBX: 0000000000000000 RCX: 0000000000000000
&gt; &gt; [ 1084.908648] RDX: 0000000000000000 RSI: 0000000000000000 RDI: 0000000000000000
&gt; &gt; [ 1084.908651] RBP: ffff888134717950 R08: 0000000000000000 R09: 0000000000000000
&gt; &gt; [ 1084.908654] R10: 0000000000000000 R11: 0000000000000000 R12: 0000000000000002
&gt; &gt; [ 1084.908657] R13: ffff888104589000 R14: ffff888104589780 R15: ffff88810033dc08
&gt; &gt; [ 1084.908661] FS:  0000000000000000(0000) GS:ffff8881f3200000(0000)
&gt; &gt; knlGS:0000000000000000
&gt; &gt; [ 1084.908665] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
&gt; &gt; [ 1084.908669] CR2: 000062bcbcecc5a0 CR3: 000000011de7a002 CR4: 00000000003706f0
&gt; &gt; [ 1084.908673] Call Trace:
&gt; &gt; [ 1084.908692]  &lt;TASK&gt;
&gt; &gt; [ 1084.908695]  ? show_regs+0x6d/0x80
&gt; &gt; [ 1084.908702]  ? __warn+0xcd/0x270
&gt; &gt; [ 1084.908706]  ? refcount_warn_saturate+0x171/0x1a0
&gt; &gt; [ 1084.908710]  ? report_bug+0x288/0x310
&gt; &gt; [ 1084.908715]  ? vprintk_default+0x1d/0x30
&gt; &gt; [ 1084.908720]  ? handle_bug+0x9f/0xd0
&gt; &gt; [ 1084.908724]  ? exc_invalid_op+0x18/0x50
&gt; &gt; [ 1084.908728]  ? asm_exc_invalid_op+0x1b/0x20
&gt; &gt; [ 1084.908736]  ? refcount_warn_saturate+0x171/0x1a0
&gt; &gt; [ 1084.908741]  sco_conn_del+0x1ef/0x220
&gt; &gt; [ 1084.908746]  sco_connect_cfm+0x1d4/0xac0
&gt; &gt; [ 1084.908751]  ? __pfx_sco_connect_cfm+0x10/0x10
&gt; &gt; [ 1084.908756]  ? __pfx_mutex_lock+0x10/0x10
&gt; &gt; [ 1084.908762]  hci_sco_setup+0x397/0x570
&gt; &gt; [ 1084.908766]  ? __pfx_hci_sco_setup+0x10/0x10
&gt; &gt; [ 1084.908769]  ? __pfx_mutex_lock+0x10/0x10
&gt; &gt; [ 1084.908774]  hci_conn_complete_evt+0x957/0x1150
&gt; &gt; [ 1084.908779]  ? kasan_save_track+0x14/0x40
&gt; &gt; [ 1084.908784]  ? __pfx_hci_conn_complete_evt+0x10/0x10
&gt; &gt; [ 1084.908788]  ? __kasan_check_write+0x14/0x30
&gt; &gt; [ 1084.908793]  ? mutex_unlock+0x81/0xe0
&gt; &gt; [ 1084.908797]  ? __pfx_mutex_unlock+0x10/0x10
&gt; &gt; [ 1084.908802]  hci_event_packet+0x818/0x1080
&gt; &gt; [ 1084.908807]  ? __pfx_hci_conn_complete_evt+0x10/0x10
&gt; &gt; [ 1084.908812]  ? __pfx_hci_event_packet+0x10/0x10
&gt; &gt; [ 1084.908816]  ? __pfx__raw_spin_lock_irqsave+0x10/0x10
&gt; &gt; [ 1084.908820]  ? __pfx_hci_cmd_sync_complete+0x10/0x10
&gt; &gt; [ 1084.908825]  ? __kasan_check_read+0x11/0x20
&gt; &gt; [ 1084.908831]  hci_rx_work+0x312/0xd60
&gt; &gt; [ 1084.908836]  ? __pfx__raw_spin_lock_irq+0x10/0x10
&gt; &gt; [ 1084.908841]  process_one_work+0x577/0xd30
&gt; &gt; [ 1084.908844]  ? _raw_spin_lock_irq+0x8b/0x100
&gt; &gt; [ 1084.908850]  worker_thread+0x879/0x15a0
&gt; &gt; [ 1084.908853]  ? __pfx__raw_spin_lock_irqsave+0x10/0x10
&gt; &gt; [ 1084.908859]  ? __pfx_worker_thread+0x10/0x10
&gt; &gt; [ 1084.908862]  kthread+0x2b7/0x390
&gt; &gt; [ 1084.908867]  ? __pfx_kthread+0x10/0x10
&gt; &gt; [ 1084.908871]  ret_from_fork+0x44/0x90
&gt; &gt; [ 1084.908876]  ? __pfx_kthread+0x10/0x10
&gt; &gt; [ 1084.908880]  ret_from_fork_asm+0x1b/0x30
&gt; &gt; [ 1084.908886]  &lt;/TASK&gt;
&gt; &gt; [ 1084.908888] ---[ end trace 0000000000000000 ]---
&gt; &gt; [ 1084.908894] ------------[ cut here ]------------
&gt; &gt; [ 1084.908896] refcount_t: underflow; use-after-free.
&gt; &gt; [ 1084.908937] WARNING: CPU: 0 PID: 162 at lib/refcount.c:28
&gt; &gt; refcount_warn_saturate+0x13e/0x1a0
&gt; &gt; [ 1084.908946] Modules linked in: isofs snd_seq_dummy snd_hrtimer qrtr
&gt; &gt; intel_rapl_msr intel_rapl_common intel_uncore_frequency_common
&gt; &gt; intel_pmc_core intel_vsec pmt_telemetry pmt_class crct10dif_pclmul
&gt; &gt; polyval_clmulni snd_ens1371 polyval_generic snd_ac97_codec
&gt; &gt; ghash_clmulni_intel gameport sha256_ssse3 ac97_bus vmw_balloon
&gt; &gt; sha1_ssse3 snd_pcm aesni_intel uvcvideo crypto_simd snd_seq_midi
&gt; &gt; cryptd rapl snd_seq_midi_event videobuf2_vmalloc uvc snd_rawmidi
&gt; &gt; videobuf2_memops videobuf2_v4l2 snd_seq snd_seq_device videodev
&gt; &gt; snd_timer videobuf2_common snd mc btusb btmtk soundcore i2c_piix4
&gt; &gt; input_leds joydev mac_hid serio_raw vsock_loopback binfmt_misc
&gt; &gt; vmw_vsock_virtio_transport_common vmw_vsock_vmci_transport vsock
&gt; &gt; vmw_vmci sch_fq_codel ramoops reed_solomon vmwgfx drm_ttm_helper ttm
&gt; &gt; msr parport_pc ppdev lp parport efi_pstore nfnetlink dmi_sysfs
&gt; &gt; ip_tables x_tables autofs4 hid_generic crc32_pclmul usbhid psmouse
&gt; &gt; mptspi mptscsih e1000 ahci mptbase libahci scsi_transport_spi
&gt; &gt; pata_acpi floppy
&gt; &gt; [ 1084.909076] CPU: 0 PID: 162 Comm: kworker/u265:0 Tainted: G    B
&gt; &gt; W          6.8.0 #4
&gt; &gt; [ 1084.909081] Hardware name: VMware, Inc. VMware Virtual
&gt; &gt; Platform/440BX Desktop Reference Platform, BIOS 6.00 11/12/2020
&gt; &gt; [ 1084.909084] Workqueue: hci0 hci_rx_work
&gt; &gt; [ 1084.909090] RIP: 0010:refcount_warn_saturate+0x13e/0x1a0
&gt; &gt; [ 1084.909094] Code: eb 97 0f b6 1d af 1a eb 03 80 fb 01 0f 87 56 6f
&gt; &gt; df 01 83 e3 01 75 82 48 c7 c7 a0 1c aa 84 c6 05 93 1a eb 03 01 e8 22
&gt; &gt; df c3 fe &lt;0f&gt; 0b e9 68 ff ff ff 0f b6 1d 81 1a eb 03 80 fb 01 0f 87 13
&gt; &gt; 6f df
&gt; &gt; [ 1084.909097] RSP: 0018:ffff888134717940 EFLAGS: 00010246
&gt; &gt; [ 1084.909101] RAX: 0000000000000000 RBX: 0000000000000000 RCX: 0000000000000000
&gt; &gt; [ 1084.909103] RDX: 0000000000000000 RSI: 0000000000000000 RDI: 0000000000000000
&gt; &gt; [ 1084.909106] RBP: ffff888134717950 R08: 0000000000000000 R09: 0000000000000000
&gt; &gt; [ 1084.909108] R10: 0000000000000000 R11: 0000000000000000 R12: 0000000000000003
&gt; &gt; [ 1084.909110] R13: ffff888104589000 R14: ffff888104589780 R15: ffff88810033dc08
&gt; &gt; [ 1084.909113] FS:  0000000000000000(0000) GS:ffff8881f3200000(0000)
&gt; &gt; knlGS:0000000000000000
&gt; &gt; [ 1084.909116] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
&gt; &gt; [ 1084.909119] CR2: 000062bcbcecc5a0 CR3: 000000011de7a002 CR4: 00000000003706f0
&gt; &gt; [ 1084.909122] Call Trace:
&gt; &gt; [ 1084.909124]  &lt;TASK&gt;
&gt; &gt; [ 1084.909127]  ? show_regs+0x6d/0x80
&gt; &gt; [ 1084.909132]  ? __warn+0xcd/0x270
&gt; &gt; [ 1084.909137]  ? refcount_warn_saturate+0x13e/0x1a0
&gt; &gt; [ 1084.909141]  ? report_bug+0x288/0x310
&gt; &gt; [ 1084.909145]  ? vprintk_default+0x1d/0x30
&gt; &gt; [ 1084.909149]  ? handle_bug+0x9f/0xd0
&gt; &gt; [ 1084.909153]  ? exc_invalid_op+0x18/0x50
&gt; &gt; [ 1084.909158]  ? asm_exc_invalid_op+0x1b/0x20
&gt; &gt; [ 1084.909164]  ? refcount_warn_saturate+0x13e/0x1a0
&gt; &gt; [ 1084.909168]  sco_conn_del+0x1dc/0x220
&gt; &gt; [ 1084.909174]  sco_connect_cfm+0x1d4/0xac0
&gt; &gt; [ 1084.909179]  ? __pfx_sco_connect_cfm+0x10/0x10
&gt; &gt; [ 1084.909184]  ? __pfx_mutex_lock+0x10/0x10
&gt; &gt; [ 1084.909189]  hci_sco_setup+0x397/0x570
&gt; &gt; [ 1084.909193]  ? __pfx_hci_sco_setup+0x10/0x10
&gt; &gt; [ 1084.909196]  ? __pfx_mutex_lock+0x10/0x10
&gt; &gt; [ 1084.909202]  hci_conn_complete_evt+0x957/0x1150
&gt; &gt; [ 1084.909206]  ? kasan_save_track+0x14/0x40
&gt; &gt; [ 1084.909211]  ? __pfx_hci_conn_complete_evt+0x10/0x10
&gt; &gt; [ 1084.909215]  ? __kasan_check_write+0x14/0x30
&gt; &gt; [ 1084.909220]  ? mutex_unlock+0x81/0xe0
&gt; &gt; [ 1084.909224]  ? __pfx_mutex_unlock+0x10/0x10
&gt; &gt; [ 1084.909228]  hci_event_packet+0x818/0x1080
&gt; &gt; [ 1084.909256]  ? __pfx_hci_conn_complete_evt+0x10/0x10
&gt; &gt; [ 1084.909261]  ? __pfx_hci_event_packet+0x10/0x10
&gt; &gt; [ 1084.909267]  ? __pfx__raw_spin_lock_irqsave+0x10/0x10
&gt; &gt; [ 1084.909272]  ? __pfx_hci_cmd_sync_complete+0x10/0x10
&gt; &gt; [ 1084.909278]  ? __kasan_check_read+0x11/0x20
&gt; &gt; [ 1084.909285]  hci_rx_work+0x312/0xd60
&gt; &gt; [ 1084.909291]  ? __pfx__raw_spin_lock_irq+0x10/0x10
&gt; &gt; [ 1084.909297]  process_one_work+0x577/0xd30
&gt; &gt; [ 1084.909301]  ? _raw_spin_lock_irq+0x8b/0x100
&gt; &gt; [ 1084.909308]  worker_thread+0x879/0x15a0
&gt; &gt; [ 1084.909312]  ? __pfx__raw_spin_lock_irqsave+0x10/0x10
&gt; &gt; [ 1084.909319]  ? __pfx_worker_thread+0x10/0x10
&gt; &gt; [ 1084.909323]  kthread+0x2b7/0x390
&gt; &gt; [ 1084.909328]  ? __pfx_kthread+0x10/0x10
&gt; &gt; [ 1084.909350]  ret_from_fork+0x44/0x90
&gt; &gt; [ 1084.909354]  ? __pfx_kthread+0x10/0x10
&gt; &gt; [ 1084.909359]  ret_from_fork_asm+0x1b/0x30
&gt; &gt; [ 1084.909364]  &lt;/TASK&gt;
&gt; &gt; [ 1084.909366] ---[ end trace 0000000000000000 ]---
&gt; &gt;
&gt; &gt; =*=*=*=*=*=*=*=*==*=*=*=*=*=*=*=*==*=*=*=*=*=*=*=*==*=*=*=*=*=*=*=*=
&gt; &gt; Environment =*=*=*=*=*=*=*=*==*=*=*=*=*=*=*=*==*=*=*=*=*=*=*=*==*=*=*=*=*=*=*=*=
&gt; &gt;
&gt; &gt; linux-6.8.0
&gt; &gt; ubuntu 24.04
&gt; &gt; .config: <a href="https://github.com/qiutianshu/sco-race-condition/blob/main/config" rel="nofollow">https://github.com/qiutianshu/sco-race-condition/blob/main/config</a>
&gt; &gt;
&gt; &gt; =*=*=*=*=*=*=*=*==*=*=*=*=*=*=*=*==*=*=*=*=*=*=*=*==*=*=*=*=*=*=*=*=
&gt; &gt; Proof of Concept
&gt; &gt; =*=*=*=*=*=*=*=*==*=*=*=*=*=*=*=*==*=*=*=*=*=*=*=*==*=*=*=*=*=*=*=*=
&gt; &gt;
&gt; &gt; <a href="https://github.com/qiutianshu/sco-race-condition/blob/main/Linux-6.8.0-PoC.webm" rel="nofollow">https://github.com/qiutianshu/sco-race-condition/blob/main/Linux-6.8.0-PoC.webm</a>
&gt; &gt;
&gt; &gt; =*=*=*=*=*=*=*=*==*=*=*=*=*=*=*=*==*=*=*=*=*=*=*=*==*=*=*=*=*=*=*=*=
&gt; &gt; PATCH =*=*=*=*=*=*=*=*==*=*=*=*=*=*=*=*==*=*=*=*=*=*=*=*==*=*=*=*=*=*=*=*=
&gt; &gt;
&gt; &gt; My patch removes the three "lock-release" pairs in the original
&gt; &gt; sco_sock_connect, and use a single "lock-release" pair to protect the
&gt; &gt; whole connect procedure.
&gt; &gt; Circular locking have not been observed after patching:
&gt; &gt; <a href="https://github.com/qiutianshu/sco-race-condition/blob/main/test.c" rel="nofollow">https://github.com/qiutianshu/sco-race-condition/blob/main/test.c</a>
&gt; &gt;
&gt; &gt; Patch:
&gt; &gt; <a href="https://github.com/qiutianshu/sco-race-condition/blob/main/diff.txt" rel="nofollow">https://github.com/qiutianshu/sco-race-condition/blob/main/diff.txt</a>
&gt;
&gt; The replies originally included some quoting of the message above, which
&gt; I excluded from the copies below.
&gt;
&gt; On Thu, Nov 14, 2024 at 07:51:20PM +0100, Vegard Nossum wrote:
&gt; &gt; Hi tianshu,
&gt; &gt;
&gt; &gt; Thank you for the report.
&gt; &gt;
&gt; &gt; At a glance, 483bc08181827fc475643272ffb69c533007e546 looks like it was
&gt; &gt; only committed in 6.9 yet your crash/kernel messages indicate you are
&gt; &gt; testing against 6.8.0 -- are you sure this wasn't fixed already? Could
&gt; &gt; you verify with a more recent kernel?
&gt; &gt;
&gt; &gt; Secondly, have you contacted either security&#64;...nel.org or the bluetooth
&gt; &gt; maintainers about this issue? The maintainers would be:
&gt; &gt;
&gt; &gt; BLUETOOTH SUBSYSTEM
&gt; &gt; M:      Marcel Holtmann &lt;marcel&#64;...tmann.org&gt;
&gt; &gt; M:      Johan Hedberg &lt;johan.hedberg&#64;...il.com&gt;
&gt; &gt; M:      Luiz Augusto von Dentz &lt;luiz.dentz&#64;...il.com&gt;
&gt; &gt;
&gt; &gt; Please see the kernel documentation on reporting security issues:
&gt; &gt;
&gt; &gt; <a href="https://docs.kernel.org/process/security-bugs.html" rel="nofollow">https://docs.kernel.org/process/security-bugs.html</a>
&gt; &gt;
&gt; &gt; For CVE assignments, you need to contact the CVE assignment team:
&gt; &gt;
&gt; &gt; <a href="https://docs.kernel.org/process/cve.html" rel="nofollow">https://docs.kernel.org/process/cve.html</a>
&gt; &gt;
&gt; &gt; However, be aware that CVE-2024-27398 was already assigned to the issue
&gt; &gt; fixed by commit 483bc08181827fc475643272ffb69c533007e546 ("Bluetooth:
&gt; &gt; Fix use-after-free bugs caused by sco_sock_timeout") -- which, if it's
&gt; &gt; the same issue, would also be the same CVE.
&gt; &gt;
&gt; &gt; I admit I haven't looked very closely at the code yet, I will try to
&gt; &gt; take a better look tomorrow. (Anybody else on the list is obviously
&gt; &gt; welcome to look as well.)
&gt; &gt;
&gt; &gt; Finally, I will point out that we usually require reporters to set an
&gt; &gt; embargo end-date according to the linux-distros list policy (usually 7
&gt; &gt; days, no more than 14 days), after which your report must also be made
&gt; &gt; public by posting it to oss-security; see:
&gt; &gt;
&gt; &gt; <a href="https://oss-security.openwall.org/wiki/mailing-lists/distros#list-policy-and-instructions-for-reporters">https://oss-security.openwall.org/wiki/mailing-lists/distros#list-policy-and-instructions-for-reporters</a>
&gt; &gt;
&gt; &gt; Thanks,
&gt; &gt;
&gt; &gt; Vegard
&gt;
&gt; On Mon, Nov 18, 2024 at 09:33:27PM +0100, Salvatore Bonaccorso wrote:
&gt; &gt; Hi,
&gt; &gt;
&gt; &gt; Question back on your report: have you reached out first to the kernel
&gt; &gt; security team?
&gt; &gt;
&gt; &gt; Cf. <a href="https://oss-security.openwall.org/wiki/mailing-lists/distros#list-policy-and-instructions-for-reporters">https://oss-security.openwall.org/wiki/mailing-lists/distros#list-policy-and-instructions-for-reporters</a>
&gt; &gt;
&gt; &gt; | Please consider notifying upstream projects/developers of the affected
&gt; &gt; | software, other affected distro vendors, and/or affected Open Source
&gt; &gt; | projects before notifying one of these mailing lists in order to
&gt; &gt; | readily have fixes for the distributions to apply and to ensure that
&gt; &gt; | these other parties are OK with the maximum embargo period that would
&gt; &gt; | apply (if not, you may delay your notification to the mailing list).
&gt; &gt; | For Linux kernel issues, you must notify the kernel security team
&gt; &gt; | first, wait for the fix, and only then notify linux-distros or
&gt; &gt; | oss-security (depending on whether the information is still private or
&gt; &gt; | already public, as well as on issue severity).
&gt; &gt;
&gt; &gt; Regards,
&gt; &gt; Salvatore



-- 
Luiz Augusto von Dentz
</pre>
<p><a href="https://www.openwall.com/blists/">Powered by blists</a> - <a href="https://lists.openwall.net">more mailing lists</a>


<p>
Please check out the
<a href="https://oss-security.openwall.org/wiki/">
Open Source Software Security Wiki</a>, which is counterpart to this
<a href="https://oss-security.openwall.org/wiki/mailing-lists/oss-security">mailing list</a>.
<p>
Confused about <a href="/lists/">mailing lists</a> and their use?
<a href="https://en.wikipedia.org/wiki/Electronic_mailing_list">Read about mailing lists on Wikipedia</a>
and check out these
<a href="https://www.complang.tuwien.ac.at/anton/mail-news-errors.html">guidelines on proper formatting of your messages</a>.
<p>

</body>
</html>
