```
{
  "CVE-2024-27398": {
    "description": "The provided content describes a use-after-free vulnerability in the Linux kernel's Bluetooth SCO socket implementation, specifically within the `sco_sock_timeout` function. This function is called by a delayed work item, and a race condition can occur if the socket is deallocated before the delayed work executes.",
    "affected_component": "Bluetooth SCO socket implementation in the Linux kernel",
    "root_cause": "A race condition exists between the cleanup thread releasing a SCO socket and the worker thread executing the `sco_sock_timeout` delayed work. The worker thread can attempt to dereference the socket after it has been deallocated.",
    "vulnerabilities": [
      "Use-after-free"
    ],
    "impact": "A use-after-free can occur leading to a potential denial of service and possibly local privilege escalation.",
      "attack_vector": "The vulnerability can be triggered through the use of multiple threads simultaneously connecting and disconnecting from Bluetooth SCO sockets",
    "attacker_capabilities": "Attacker needs to be able to create and destroy SCO sockets rapidly.",
   "additional_details": "The vulnerability arises from the scheduling of a delayed work item to determine sco connection timeout, while the socket is being released on another thread.  A missing check for null `conn->hcon` before dereferencing `sk = conn->sk;` in `sco_sock_timeout` leads to the use-after-free. The fix involves adding a check to ensure `conn->hcon` is not null before proceeding. The patch associated with this CVE involves adding a check protected by the sco_conn_lock to ensure that `conn->hcon` is not null before proceeding to dereference the socket.  The report also claims the race condition is not fully solved by the fix of CVE-2024-27398",
    "references": [
      "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=483bc08181827fc475643272ffb69c533007e546",
        "https://lists.debian.org/debian-lts-announce/2024/06/msg00019.html",
    "https://security.netapp.com/advisory/ntap-20240912-0012/",
       "https://lists.debian.org/debian-lts-announce/2024/06/msg00020.html",
    "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/thread/DW2MIOIMOFUSNLHLRYX23AFR36BMKD65/",
     "https://www.openwall.com/lists/oss-security/2024/11/29/2",
     "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/OTB4HWU2PTVW5NEYHHLOCXDKG3PYA534/",
        "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=bfab2c1f7940a232cd519e82fff137e308abfd93",
        "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=3212afd00e3cda790fd0583cb3eaef8f9575a014",
          "https://www.openwall.com/lists/oss-security/2024/11/30/1",
      "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=012363cb1bec5f33a7b94629ab2c1086f30280f2",
      "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=33a6e92161a78c1073d90e27abe28d746feb0a53",
           "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=6a18eeb1b3bbc67c20d9609c31dca6a69b4bcde5",
            "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=f9162268df1a32d0638c7bf906b2789184c80f34",
           "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=9ece97b6f96030ca232054e2d042f075a9567f3e"


    ]
  }
}
```