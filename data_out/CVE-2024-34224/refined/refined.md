The provided content relates to CVE-2024-34224.

- **Root cause of vulnerability**: The application fails to properly sanitize user-supplied input within the `firstname`, `middlename`, and `lastname` parameters when processing the `save` action in `/php-lms/classes/Users.php`, which leads to stored Cross-Site Scripting (XSS).
- **Weaknesses/vulnerabilities present**: Stored Cross-Site Scripting (XSS) vulnerability.
- **Impact of exploitation**: An attacker can inject arbitrary web scripts or HTML. This allows the attacker to potentially perform actions such as session hijacking, defacement, or phishing attacks, impacting other users of the application when they view the affected data.
- **Attack vectors**: The attack vector is through HTTP requests to `/php-lms/classes/Users.php?f=save`, where the attacker includes a malicious JavaScript payload within the `firstname`, `middlename`, or `lastname` parameters.
- **Required attacker capabilities/position**: The attacker needs to have the ability to interact with the `/php-lms/classes/Users.php?f=save` endpoint, likely requiring user-level access (e.g. administrator) to the vulnerable functionality.