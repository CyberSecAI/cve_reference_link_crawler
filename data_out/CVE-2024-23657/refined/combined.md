=== Content from portswigger.net_c56e7453_20250110_202644.html ===


[Login](/users)

Products

Solutions

[Research](/research)
[Academy](/web-security)
Support

Company

[Customers](/customers)
[About](/about)
[Blog](/blog)
[Careers](/careers)
[Legal](/legal)
[Contact](/contact)
[Resellers](/support/reseller-faqs)

[My account](/users/youraccount)
[Customers](/customers)
[About](/about)
[Blog](/blog)
[Careers](/careers)
[Legal](/legal)
[Contact](/contact)
[Resellers](/support/reseller-faqs)
[![Burp Suite Enterprise Edition](/content/images/svg/icons/enterprise.svg)
**Burp Suite Enterprise Edition**
The enterprise-enabled dynamic web vulnerability scanner.](/burp/enterprise)
[![Burp Suite Professional](/content/images/svg/icons/professional.svg)
**Burp Suite Professional**
The world's #1 web penetration testing toolkit.](/burp/pro)
[![Burp Suite Community Edition](/content/images/svg/icons/community.svg)
**Burp Suite Community Edition**
The best manual tools to start web security testing.](/burp/communitydownload)
[![Dastardly, from Burp Suite](/mega-nav/images/dastardly.svg)
**Dastardly, from Burp Suite**
Free, lightweight web application security scanning for CI/CD.](/burp/dastardly)
[View all product editions](/burp)

[**Burp Scanner**

Burp Suite's web vulnerability scanner

![Burp Suite's web vulnerability scanner'](/mega-nav/images/burp-suite-scanner.jpg)](/burp/vulnerability-scanner)

[**Attack surface visibility**
Improve security posture, prioritize manual testing, free up time.](/solutions/attack-surface-visibility)
[**CI-driven scanning**
More proactive security - find and fix vulnerabilities earlier.](/solutions/ci-driven-scanning)
[**Application security testing**
See how our software enables the world to secure the web.](/solutions)
[**DevSecOps**
Catch critical bugs; ship more secure software, more quickly.](/solutions/devsecops)
[**Penetration testing**
Accelerate penetration testing - find more bugs, more quickly.](/solutions/penetration-testing)
[**Automated scanning**
Scale dynamic scanning. Reduce risk. Save time/money.](/solutions/automated-security-testing)
[**Bug bounty hunting**
Level up your hacking and earn more bug bounties.](/solutions/bug-bounty-hunting)
[**Compliance**
Enhance security monitoring to comply with confidence.](/solutions/compliance)

[View all solutions](/solutions)

[**Product comparison**

What's the difference between Pro and Enterprise Edition?

![Burp Suite Professional vs Burp Suite Enterprise Edition](/mega-nav/images/burp-suite.jpg)](/burp/enterprise/resources/enterprise-edition-vs-professional)

[**Support Center**
Get help and advice from our experts on all things Burp.](/support)
[**Documentation**
Tutorials and guides for Burp Suite.](/burp/documentation)
[**Get Started - Professional**
Get started with Burp Suite Professional.](/burp/documentation/desktop/getting-started)
[**Get Started - Enterprise**
Get started with Burp Suite Enterprise Edition.](/burp/documentation/enterprise/getting-started)
[**User Forum**
Get your questions answered in the User Forum.](https://forum.portswigger.net/)
[**Downloads**
Download the latest version of Burp Suite.](/burp/releases)

[Visit the Support Center](/support)

[**Downloads**

Download the latest version of Burp Suite.

![The latest version of Burp Suite software for download](/mega-nav/images/latest-burp-suite-software-download.jpg)](/burp/releases)

Academy home

* [Dashboard](https://portswigger.net/web-security/index.html)
* [Learning paths](https://portswigger.net/web-security/learning-paths)
* Latest topics

  [Web cache deception](/web-security/web-cache-deception)
  [Web LLM attacks](/web-security/llm-attacks)
  [API testing](/web-security/api-testing)
  [NoSQL injection](/web-security/nosql-injection)
  [Race conditions](/web-security/race-conditions)
  [View all topics](/web-security/all-topics)
* All content

  [All labs](/web-security/all-labs)
  [All topics](/web-security/all-topics)
  [Mystery labs](/web-security/mystery-lab-challenge)
* Hall of Fame

  [Leaderboard](https://portswigger.net/web-security/hall-of-fame)
  [Interview - Kamil Vavra](https://portswigger.net/web-security/getting-started/kamil-vavra/index.html)
  [Interview - Johnny Villarreal](https://portswigger.net/web-security/getting-started/johnny-villarreal/index.html)
  [Interview - Andres Rauschecker](https://portswigger.net/web-security/getting-started/andres-rauschecker/index.html)
* [Get started](https://portswigger.net/web-security/getting-started/index.html)
* Get certified

  [Get certified](https://portswigger.net/web-security/certification/index.html)
  [How to prepare](https://portswigger.net/web-security/certification/how-to-prepare/index.html)
  [How it works](https://portswigger.net/web-security/certification/how-it-works/index.html)
  [Practice exam](https://portswigger.net/web-security/certification/practice-exam/index.html)
  [Exam hints and guidance](https://portswigger.net/web-security/certification/exam-hints-and-guidance/index.html)
  [What the exam involves](https://portswigger.net/web-security/certification/how-it-works/index.html#what-the-exam-involves)
  [FAQs](https://portswigger.net/web-security/certification/frequently-asked-questions/index.html)
  [Validate your certification](https://portswigger.net/web-security/certification#validate-your-certification)

[Back to all topics](/web-security/all-topics)

### WebSockets

* [What are WebSockets?](/web-security/websockets/what-are-websockets)

  + [HTTP vs WebSockets](/web-security/websockets/what-are-websockets#what-is-the-difference-between-http-and-websockets)
  + [How are connections established?](/web-security/websockets/what-are-websockets#how-are-websocket-connections-established)
  + [What do WebSocket messages look like?](/web-security/websockets/what-are-websockets#what-do-websocket-messages-look-like)
* [Manipulating WebSocket traffic](/web-security/websockets#manipulating-websocket-traffic)

  + [Intercepting and modifying messages](/web-security/websockets#intercepting-and-modifying-websocket-messages)
  + [Replaying and generating new messages](/web-security/websockets#replaying-and-generating-new-websocket-messages)
  + [Manipulating WebSocket connections](/web-security/websockets#manipulating-websocket-connections)
* [Exploiting vulnerabilities](/web-security/websockets#websockets-security-vulnerabilities)

  + [Manipulating WebSocket messages](/web-security/websockets#manipulating-websocket-messages-to-exploit-vulnerabilities)
  + [Manipulating the WebSocket handshake](/web-security/websockets#manipulating-the-websocket-handshake-to-exploit-vulnerabilities)
  + [Cross-site WebSocket hijacking](/web-security/websockets/cross-site-websocket-hijacking)

    - [Impact](/web-security/websockets/cross-site-websocket-hijacking#what-is-the-impact-of-cross-site-websocket-hijacking)
    - [Performing an attack](/web-security/websockets/cross-site-websocket-hijacking#performing-a-cross-site-websocket-hijacking-attack)
* [Securing a WebSocket connection](/web-security/websockets#how-to-secure-a-websocket-connection)
* [View all WebSockets labs](/web-security/all-labs#websockets)

* [Web Security Academy](/web-security)
* [WebSockets](/web-security/websockets)
* [CSWSH](/web-security/websockets/cross-site-websocket-hijacking)

# Cross-site WebSocket hijacking

In this section, we'll explain cross-site WebSocket hijacking (CSWSH), describe the impact of a compromise, and spell out how to perform a cross-site WebSocket hijacking attack.

## What is cross-site WebSocket hijacking?

Cross-site WebSocket hijacking (also known as cross-origin WebSocket hijacking) involves a cross-site request forgery (CSRF) vulnerability on a [WebSocket handshake](/web-security/websockets/what-are-websockets#how-are-websocket-connections-established). It arises when the WebSocket handshake request relies solely on HTTP cookies for session handling and does not contain any CSRF tokens or other unpredictable values.

An attacker can create a malicious web page on their own domain which establishes a cross-site WebSocket connection to the vulnerable application. The application will handle the connection in the context of the victim user's session with the application.

The attacker's page can then send arbitrary messages to the server via the connection and read the contents of messages that are received back from the server. This means that, unlike regular CSRF, the attacker gains two-way interaction with the compromised application.

## What is the impact of cross-site WebSocket hijacking?

A successful cross-site WebSocket hijacking attack will often enable an attacker to:

* **Perform unauthorized actions masquerading as the victim user.** As with regular CSRF, the attacker can send arbitrary messages to the server-side application. If the application uses client-generated WebSocket messages to perform any sensitive actions, then the attacker can generate suitable messages cross-domain and trigger those actions.
* **Retrieve sensitive data that the user can access.** Unlike with regular CSRF, cross-site WebSocket hijacking gives the attacker two-way interaction with the vulnerable application over the hijacked WebSocket. If the application uses server-generated WebSocket messages to return any sensitive data to the user, then the attacker can intercept those messages and capture the victim user's data.

## Performing a cross-site WebSocket hijacking attack

Since a cross-site WebSocket hijacking attack is essentially a CSRF vulnerability on a WebSocket handshake, the first step to performing an attack is to review the WebSocket handshakes that the application carries out and determine whether they are protected against CSRF.

In terms of the [normal conditions for CSRF attacks](/web-security/csrf#how-does-csrf-work), you typically need to find a handshake message that relies solely on HTTP cookies for session handling and doesn't employ any tokens or other unpredictable values in request parameters.

For example, the following WebSocket handshake request is probably vulnerable to CSRF, because the only session token is transmitted in a cookie:

`GET /chat HTTP/1.1
Host: normal-website.com
Sec-WebSocket-Version: 13
Sec-WebSocket-Key: wDqumtseNBJdhkihL6PW7w==
Connection: keep-alive, Upgrade
Cookie: session=KOsEJNuflw4Rd9BDNrVmvwBF9rEijeE2
Upgrade: websocket`
#### Note

The `Sec-WebSocket-Key` header contains a random value to prevent errors from caching proxies, and is not used for authentication or session handling purposes.

If the WebSocket handshake request is vulnerable to CSRF, then an attacker's web page can perform a cross-site request to open a WebSocket on the vulnerable site. What happens next in the attack depends entirely on the application's logic and how it is using WebSockets. The attack might involve:

* Sending WebSocket messages to perform unauthorized actions on behalf of the victim user.
* Sending WebSocket messages to retrieve sensitive data.
* Sometimes, just waiting for incoming messages to arrive containing sensitive data.

LAB
PRACTITIONER
[Cross-site WebSocket hijacking](/web-security/websockets/cross-site-websocket-hijacking/lab)

## Register for free to track your learning progress

![The benefits of working through PortSwigger's Web Security Academy](/content/images/vulnerabilities/web-security-academy-footer.png)

* Practise exploiting vulnerabilities on realistic targets.
* Record your progression from Apprentice to Expert.
* See where you rank in our Hall of Fame.

REGISTER

As we use reCAPTCHA, you need to be able to access Google's servers to use this function.

Already got an account?
[Login here](https://portswigger.net/users)

Want to track your progress and have a more personalized learning experience? (It's free!)

[Sign up](/users/register)
[Login](/users?returnurl=%2fweb-security%2fwebsockets%2fcross-site-websocket-hijacking)

![Try Burp Suite for Free](/content/images/logos/burp-suite-icon.svg)
#### Find WebSocket vulnerabilities using Burp Suite

[Try for free](https://portswigger.net/burp)

Burp Suite

[Web vulnerability scanner](/burp/vulnerability-scanner)
[Burp Suite Editions](/burp)
[Release Notes](/burp/releases)

Vulnerabilities

[Cross-site scripting (XSS)](/web-security/cross-site-scripting)
[SQL injection](/web-security/sql-injection)
[Cross-site request forgery](/web-security/csrf)
[XML external entity injection](/web-security/xxe)
[Directory traversal](/web-security/file-path-traversal)
[Server-side request forgery](/web-security/ssrf)

Customers

[Organizations](/organizations)
[Testers](/testers)
[Developers](/developers)

Company

[About](/about)
[Careers](/careers)
[Contact](/about/contact)
[Legal](/legal)
[Privacy Notice](/privacy)

Insights

[Web Security Academy](/web-security)
[Blog](/blog)
[Research](/research)

[![PortSwigger Logo](/content/images/logos/portswigger-logo.svg)](/)
 [Follow us](https://twitter.com/Burp_Suite)

© 2025 PortSwigger Ltd.



=== Content from github.com_f81de1d7_20250110_202644.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fnuxt%2Fnuxt%2Fsecurity%2Fadvisories%2FGHSA-rcvg-rgf7-pppv)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fnuxt%2Fnuxt%2Fsecurity%2Fadvisories%2FGHSA-rcvg-rgf7-pppv)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=nuxt%2Fnuxt)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[nuxt](/nuxt)
/
**[nuxt](/nuxt/nuxt)**
Public

* [Notifications](/login?return_to=%2Fnuxt%2Fnuxt) You must be signed in to change notification settings
* [Fork
  5.1k](/login?return_to=%2Fnuxt%2Fnuxt)
* [Star
   55.7k](/login?return_to=%2Fnuxt%2Fnuxt)

* [Code](/nuxt/nuxt)
* [Issues
  848](/nuxt/nuxt/issues)
* [Pull requests
  59](/nuxt/nuxt/pulls)
* [Discussions](/nuxt/nuxt/discussions)
* [Actions](/nuxt/nuxt/actions)
* [Projects
  1](/nuxt/nuxt/projects)
* [Security](/nuxt/nuxt/security)
* [Insights](/nuxt/nuxt/pulse)

Additional navigation options

* [Code](/nuxt/nuxt)
* [Issues](/nuxt/nuxt/issues)
* [Pull requests](/nuxt/nuxt/pulls)
* [Discussions](/nuxt/nuxt/discussions)
* [Actions](/nuxt/nuxt/actions)
* [Projects](/nuxt/nuxt/projects)
* [Security](/nuxt/nuxt/security)
* [Insights](/nuxt/nuxt/pulse)

# Path Traversal: '../filedir' in Nuxt Devtools

High

[danielroe](/danielroe)
published
GHSA-rcvg-rgf7-pppv
Aug 5, 2024

## Package

npm

@nuxt/devtools
([npm](/advisories?query=ecosystem%3Anpm))

## Affected versions

< 1.3.9

## Patched versions

>= 1.3.9

## Description

### Summary

Nuxt Devtools is missing authentication on the `getTextAssetContent` RPC function which is vulnerable to path traversal. Combined with a lack of Origin checks on the WebSocket handler, an attacker is able to interact with a locally running devtools instance and exfiltrate data abusing this vulnerability.

In certain configurations an attacker could leak the devtools authentication token and then abuse other RPC functions to achieve RCE.

### Details

The `getTextAssetContent` function does not check for path traversals [(source)](https://github.com/nuxt/devtools/blob/c4f2b68281203fc3f61ffc97d9c6623fbfde46bb/packages/devtools/src/server-rpc/assets.ts#L88C48-L88C48), this could allow an attacker to read arbitrary files over the RPC WebSocket.

The WebSocket server does not check the origin of the request [(source)](https://github.com/nuxt/devtools/blob/c4f2b68281203fc3f61ffc97d9c6623fbfde46bb/packages/devtools/src/server-rpc/index.ts#L109) leading to [CSWSH](https://portswigger.net/web-security/websockets/cross-site-websocket-hijacking). This may be intentional to allow certain configurations to work correctly.

Nuxt Devtools authentication tokens are placed within the home directory of the current user [(source)](https://github.com/nuxt/devtools/blob/c4f2b68281203fc3f61ffc97d9c6623fbfde46bb/packages/devtools/src/dev-auth.ts#L14).

In the scenario that:

* The user has a Nuxt3 Project running
* Devtools is enabled and running
* The project is placed within the users home directory.
* The user visits a malicious webpage
* User has authenticated with devtools at least once

The malicious webpage can connect to the Devtools WebSocket, perform a directory traversal brute force to find the authentication token, then use the *authenticated* [`writeStaticAssets` function](https://github.com/nuxt/devtools/blob/c4f2b68281203fc3f61ffc97d9c6623fbfde46bb/packages/devtools/src/server-rpc/assets.ts#L96C11-L96C28) to create a new Component, Nitro Handler or `app.vue` file which will run automatically as the file is changed.

### PoC

POC will exploit the Devtools server on localhost:3000 (you may need to manually restart the server as the restart hook does not always work).

POC: <https://devtools-exploit.pages.dev>

1. Create a new project with nuxt.new.
2. Place the project inside your home directory.
3. Run `pnpm run dev`.
4. Open the POC page.

The POC will:

* Identify devtools version.
* Leak your devtools token.
* Create a new server handler with an insecure eval.

### Impact

* All new Nuxt projects by default (devtools is enabled) are vulnerable to arbitrary file read.
* Certain Nuxt configurations are vulnerable to Remote Code Execution

### Severity

High

8.8

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Network

Attack complexity
Low

Privileges required
None

User interaction
Required

Scope
Unchanged

Confidentiality
High

Integrity
High

Availability
High

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H

### CVE ID

CVE-2024-23657

### Weaknesses

[CWE-24](/advisories?query=cwe%3A24)

### Credits

* [![@OhB00](https://avatars.githubusercontent.com/u/43827372?s=40&v=4)](/OhB00)
  [OhB00](/OhB00)
  Reporter
* [![@antfu](https://avatars.githubusercontent.com/u/11247099?s=40&v=4)](/antfu)
  [antfu](/antfu)
  Remediation developer

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_4515915e_20250110_202643.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fnuxt%2Fdevtools%2Fblob%2Fc4f2b68281203fc3f61ffc97d9c6623fbfde46bb%2Fpackages%2Fdevtools%2Fsrc%2Fserver-rpc%2Fassets.ts)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fnuxt%2Fdevtools%2Fblob%2Fc4f2b68281203fc3f61ffc97d9c6623fbfde46bb%2Fpackages%2Fdevtools%2Fsrc%2Fserver-rpc%2Fassets.ts)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=nuxt%2Fdevtools)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[nuxt](/nuxt)
/
**[devtools](/nuxt/devtools)**
Public

* [Notifications](/login?return_to=%2Fnuxt%2Fdevtools) You must be signed in to change notification settings
* [Fork
  164](/login?return_to=%2Fnuxt%2Fdevtools)
* [Star
   3k](/login?return_to=%2Fnuxt%2Fdevtools)

* [Code](/nuxt/devtools)
* [Issues
  69](/nuxt/devtools/issues)
* [Pull requests
  7](/nuxt/devtools/pulls)
* [Discussions](/nuxt/devtools/discussions)
* [Actions](/nuxt/devtools/actions)
* [Projects
  0](/nuxt/devtools/projects)
* [Security](/nuxt/devtools/security)
* [Insights](/nuxt/devtools/pulse)

Additional navigation options

* [Code](/nuxt/devtools)
* [Issues](/nuxt/devtools/issues)
* [Pull requests](/nuxt/devtools/pulls)
* [Discussions](/nuxt/devtools/discussions)
* [Actions](/nuxt/devtools/actions)
* [Projects](/nuxt/devtools/projects)
* [Security](/nuxt/devtools/security)
* [Insights](/nuxt/devtools/pulse)

## Files

 c4f2b68
## Breadcrumbs

1. [devtools](/nuxt/devtools/tree/c4f2b68281203fc3f61ffc97d9c6623fbfde46bb)
2. /[packages](/nuxt/devtools/tree/c4f2b68281203fc3f61ffc97d9c6623fbfde46bb/packages)
3. /[devtools](/nuxt/devtools/tree/c4f2b68281203fc3f61ffc97d9c6623fbfde46bb/packages/devtools)
4. /[src](/nuxt/devtools/tree/c4f2b68281203fc3f61ffc97d9c6623fbfde46bb/packages/devtools/src)
5. /[server-rpc](/nuxt/devtools/tree/c4f2b68281203fc3f61ffc97d9c6623fbfde46bb/packages/devtools/src/server-rpc)
/
# assets.ts

Copy path Blame  Blame
## Latest commit

## History

[History](/nuxt/devtools/commits/c4f2b68281203fc3f61ffc97d9c6623fbfde46bb/packages/devtools/src/server-rpc/assets.ts)145 lines (128 loc) · 4.81 KB c4f2b68
## Breadcrumbs

1. [devtools](/nuxt/devtools/tree/c4f2b68281203fc3f61ffc97d9c6623fbfde46bb)
2. /[packages](/nuxt/devtools/tree/c4f2b68281203fc3f61ffc97d9c6623fbfde46bb/packages)
3. /[devtools](/nuxt/devtools/tree/c4f2b68281203fc3f61ffc97d9c6623fbfde46bb/packages/devtools)
4. /[src](/nuxt/devtools/tree/c4f2b68281203fc3f61ffc97d9c6623fbfde46bb/packages/devtools/src)
5. /[server-rpc](/nuxt/devtools/tree/c4f2b68281203fc3f61ffc97d9c6623fbfde46bb/packages/devtools/src/server-rpc)
/
# assets.ts

Top
## File metadata and controls

* Code
* Blame

145 lines (128 loc) · 4.81 KB[Raw](https://github.com/nuxt/devtools/raw/c4f2b68281203fc3f61ffc97d9c6623fbfde46bb/packages/devtools/src/server-rpc/assets.ts)123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145import fsp from 'node:fs/promises'import { parse } from 'node:path'import { join, resolve } from 'pathe'import { imageMeta } from 'image-meta'import { debounce } from 'perfect-debounce'import fg from 'fast-glob'import type { AssetEntry, AssetInfo, AssetType, ImageMeta, NuxtDevtoolsServerContext, ServerFunctions } from '../types'import { defaultAllowedExtensions } from '../constant'
export function setupAssetsRPC({ nuxt, ensureDevAuthToken, refresh, options }: NuxtDevtoolsServerContext) { const \_imageMetaCache = new Map<string, ImageMeta | undefined>() let cache: AssetInfo[] | null = null
 const extensions = options.assets?.uploadExtensions || defaultAllowedExtensions
 const publicDir = resolve(nuxt.options.srcDir, nuxt.options.dir.public)
 const refreshDebounced = debounce(() => { cache = null refresh('getStaticAssets') }, 500)
 nuxt.hook('builder:watch', (event, key) => { if (key.startsWith(nuxt.options.dir.public) && (event === 'add' || event === 'unlink')) refreshDebounced() })
 async function scan() { if (cache) return cache
 const baseURL = nuxt.options.app.baseURL const files = await fg(['\*\*/\*'], { cwd: publicDir, onlyFiles: true, })
 function guessType(path: string): AssetType { if (/\.(png|jpe?g|jxl|gif|svg|webp|avif|ico|bmp|tiff?)$/i.test(path)) return 'image' if (/\.(mp4|webm|ogv|mov|avi|flv|wmv|mpg|mpeg|mkv|3gp|3g2|ts|mts|m2ts|vob|ogm|ogx|rm|rmvb|asf|amv|divx|m4v|svi|viv|f4v|f4p|f4a|f4b)$/i.test(path)) return 'video' if (/\.(mp3|wav|ogg|flac|aac|wma|alac|ape|ac3|dts|tta|opus|amr|aiff|au|mid|midi|ra|rm|wv|weba|dss|spx|vox|tak|dsf|dff|dsd|cda)$/i.test(path)) return 'audio' if (/\.(woff2?|eot|ttf|otf|ttc|pfa|pfb|pfm|afm)/i.test(path)) return 'font' if (/\.(json[5c]?|te?xt|[mc]?[jt]sx?|md[cx]?|markdown)/i.test(path)) return 'text' return 'other' }
 cache = await Promise.all(files.map(async (path) => { const filePath = resolve(publicDir, path) const stat = await fsp.lstat(filePath) return { path, publicPath: join(baseURL, path), filePath, type: guessType(path), size: stat.size, mtime: stat.mtimeMs, } }))
 return cache }
 return { async getStaticAssets() { return await scan() }, async getImageMeta(filepath: string) { if (\_imageMetaCache.has(filepath)) return \_imageMetaCache.get(filepath) try { const meta = imageMeta(await fsp.readFile(filepath)) as ImageMeta \_imageMetaCache.set(filepath, meta) return meta } catch (e) { \_imageMetaCache.set(filepath, undefined) console.error(e) return undefined } }, async getTextAssetContent(filepath: string, limit = 300) { try { const content = await fsp.readFile(filepath, 'utf-8') return content.slice(0, limit) } catch (e) { console.error(e) return undefined } }, async writeStaticAssets(token: string, files: AssetEntry[], folder: string) { await ensureDevAuthToken(token)
 const baseDir = resolve(nuxt.options.srcDir, nuxt.options.dir.public + folder)
 return await Promise.all( files.map(async ({ path, content, encoding, override }) => { let finalPath = resolve(baseDir, path)
 const { ext } = parse(finalPath) if (extensions !== '\*') { if (!extensions.includes(ext.toLowerCase().slice(1))) throw new Error(`File extension ${ext} is not allowed to upload, allowed extensions are: ${extensions.join(', ')}\nYou can configure it in Nuxt config at \`devtools.assets.uploadExtensions\`.`) }
 if (!override) { try { await fsp.stat(finalPath) const base = finalPath.slice(0, finalPath.length - ext.length - 1) let i = 1 while (await fsp.access(`${base}-${i}.${ext}`).then(() => true).catch(() => false)) i++ finalPath = `${base}-${i}.${ext}` } catch (err) { // Ignore error if file doesn't exist } } await fsp.writeFile(finalPath, content, { encoding: encoding ?? 'utf-8', }) return finalPath }), ) }, async deleteStaticAsset(token: string, path: string) { await ensureDevAuthToken(token)
 return await fsp.unlink(path) }, async renameStaticAsset(token: string, oldPath: string, newPath: string) { await ensureDevAuthToken(token)
 const exist = cache?.find(asset => asset.filePath === newPath) if (exist) throw new Error(`File ${newPath} already exists`) return await fsp.rename(oldPath, newPath) }, } satisfies Partial<ServerFunctions>}

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_6dc9aeed_20250110_202642.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fnuxt%2Fdevtools%2Fblob%2Fc4f2b68281203fc3f61ffc97d9c6623fbfde46bb%2Fpackages%2Fdevtools%2Fsrc%2Fserver-rpc%2Fassets.ts)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fnuxt%2Fdevtools%2Fblob%2Fc4f2b68281203fc3f61ffc97d9c6623fbfde46bb%2Fpackages%2Fdevtools%2Fsrc%2Fserver-rpc%2Fassets.ts)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=nuxt%2Fdevtools)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[nuxt](/nuxt)
/
**[devtools](/nuxt/devtools)**
Public

* [Notifications](/login?return_to=%2Fnuxt%2Fdevtools) You must be signed in to change notification settings
* [Fork
  164](/login?return_to=%2Fnuxt%2Fdevtools)
* [Star
   3k](/login?return_to=%2Fnuxt%2Fdevtools)

* [Code](/nuxt/devtools)
* [Issues
  69](/nuxt/devtools/issues)
* [Pull requests
  7](/nuxt/devtools/pulls)
* [Discussions](/nuxt/devtools/discussions)
* [Actions](/nuxt/devtools/actions)
* [Projects
  0](/nuxt/devtools/projects)
* [Security](/nuxt/devtools/security)
* [Insights](/nuxt/devtools/pulse)

Additional navigation options

* [Code](/nuxt/devtools)
* [Issues](/nuxt/devtools/issues)
* [Pull requests](/nuxt/devtools/pulls)
* [Discussions](/nuxt/devtools/discussions)
* [Actions](/nuxt/devtools/actions)
* [Projects](/nuxt/devtools/projects)
* [Security](/nuxt/devtools/security)
* [Insights](/nuxt/devtools/pulse)

## Files

 c4f2b68
## Breadcrumbs

1. [devtools](/nuxt/devtools/tree/c4f2b68281203fc3f61ffc97d9c6623fbfde46bb)
2. /[packages](/nuxt/devtools/tree/c4f2b68281203fc3f61ffc97d9c6623fbfde46bb/packages)
3. /[devtools](/nuxt/devtools/tree/c4f2b68281203fc3f61ffc97d9c6623fbfde46bb/packages/devtools)
4. /[src](/nuxt/devtools/tree/c4f2b68281203fc3f61ffc97d9c6623fbfde46bb/packages/devtools/src)
5. /[server-rpc](/nuxt/devtools/tree/c4f2b68281203fc3f61ffc97d9c6623fbfde46bb/packages/devtools/src/server-rpc)
/
# assets.ts

Copy path Blame  Blame
## Latest commit

## History

[History](/nuxt/devtools/commits/c4f2b68281203fc3f61ffc97d9c6623fbfde46bb/packages/devtools/src/server-rpc/assets.ts)145 lines (128 loc) · 4.81 KB c4f2b68
## Breadcrumbs

1. [devtools](/nuxt/devtools/tree/c4f2b68281203fc3f61ffc97d9c6623fbfde46bb)
2. /[packages](/nuxt/devtools/tree/c4f2b68281203fc3f61ffc97d9c6623fbfde46bb/packages)
3. /[devtools](/nuxt/devtools/tree/c4f2b68281203fc3f61ffc97d9c6623fbfde46bb/packages/devtools)
4. /[src](/nuxt/devtools/tree/c4f2b68281203fc3f61ffc97d9c6623fbfde46bb/packages/devtools/src)
5. /[server-rpc](/nuxt/devtools/tree/c4f2b68281203fc3f61ffc97d9c6623fbfde46bb/packages/devtools/src/server-rpc)
/
# assets.ts

Top
## File metadata and controls

* Code
* Blame

145 lines (128 loc) · 4.81 KB[Raw](https://github.com/nuxt/devtools/raw/c4f2b68281203fc3f61ffc97d9c6623fbfde46bb/packages/devtools/src/server-rpc/assets.ts)123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145import fsp from 'node:fs/promises'import { parse } from 'node:path'import { join, resolve } from 'pathe'import { imageMeta } from 'image-meta'import { debounce } from 'perfect-debounce'import fg from 'fast-glob'import type { AssetEntry, AssetInfo, AssetType, ImageMeta, NuxtDevtoolsServerContext, ServerFunctions } from '../types'import { defaultAllowedExtensions } from '../constant'
export function setupAssetsRPC({ nuxt, ensureDevAuthToken, refresh, options }: NuxtDevtoolsServerContext) { const \_imageMetaCache = new Map<string, ImageMeta | undefined>() let cache: AssetInfo[] | null = null
 const extensions = options.assets?.uploadExtensions || defaultAllowedExtensions
 const publicDir = resolve(nuxt.options.srcDir, nuxt.options.dir.public)
 const refreshDebounced = debounce(() => { cache = null refresh('getStaticAssets') }, 500)
 nuxt.hook('builder:watch', (event, key) => { if (key.startsWith(nuxt.options.dir.public) && (event === 'add' || event === 'unlink')) refreshDebounced() })
 async function scan() { if (cache) return cache
 const baseURL = nuxt.options.app.baseURL const files = await fg(['\*\*/\*'], { cwd: publicDir, onlyFiles: true, })
 function guessType(path: string): AssetType { if (/\.(png|jpe?g|jxl|gif|svg|webp|avif|ico|bmp|tiff?)$/i.test(path)) return 'image' if (/\.(mp4|webm|ogv|mov|avi|flv|wmv|mpg|mpeg|mkv|3gp|3g2|ts|mts|m2ts|vob|ogm|ogx|rm|rmvb|asf|amv|divx|m4v|svi|viv|f4v|f4p|f4a|f4b)$/i.test(path)) return 'video' if (/\.(mp3|wav|ogg|flac|aac|wma|alac|ape|ac3|dts|tta|opus|amr|aiff|au|mid|midi|ra|rm|wv|weba|dss|spx|vox|tak|dsf|dff|dsd|cda)$/i.test(path)) return 'audio' if (/\.(woff2?|eot|ttf|otf|ttc|pfa|pfb|pfm|afm)/i.test(path)) return 'font' if (/\.(json[5c]?|te?xt|[mc]?[jt]sx?|md[cx]?|markdown)/i.test(path)) return 'text' return 'other' }
 cache = await Promise.all(files.map(async (path) => { const filePath = resolve(publicDir, path) const stat = await fsp.lstat(filePath) return { path, publicPath: join(baseURL, path), filePath, type: guessType(path), size: stat.size, mtime: stat.mtimeMs, } }))
 return cache }
 return { async getStaticAssets() { return await scan() }, async getImageMeta(filepath: string) { if (\_imageMetaCache.has(filepath)) return \_imageMetaCache.get(filepath) try { const meta = imageMeta(await fsp.readFile(filepath)) as ImageMeta \_imageMetaCache.set(filepath, meta) return meta } catch (e) { \_imageMetaCache.set(filepath, undefined) console.error(e) return undefined } }, async getTextAssetContent(filepath: string, limit = 300) { try { const content = await fsp.readFile(filepath, 'utf-8') return content.slice(0, limit) } catch (e) { console.error(e) return undefined } }, async writeStaticAssets(token: string, files: AssetEntry[], folder: string) { await ensureDevAuthToken(token)
 const baseDir = resolve(nuxt.options.srcDir, nuxt.options.dir.public + folder)
 return await Promise.all( files.map(async ({ path, content, encoding, override }) => { let finalPath = resolve(baseDir, path)
 const { ext } = parse(finalPath) if (extensions !== '\*') { if (!extensions.includes(ext.toLowerCase().slice(1))) throw new Error(`File extension ${ext} is not allowed to upload, allowed extensions are: ${extensions.join(', ')}\nYou can configure it in Nuxt config at \`devtools.assets.uploadExtensions\`.`) }
 if (!override) { try { await fsp.stat(finalPath) const base = finalPath.slice(0, finalPath.length - ext.length - 1) let i = 1 while (await fsp.access(`${base}-${i}.${ext}`).then(() => true).catch(() => false)) i++ finalPath = `${base}-${i}.${ext}` } catch (err) { // Ignore error if file doesn't exist } } await fsp.writeFile(finalPath, content, { encoding: encoding ?? 'utf-8', }) return finalPath }), ) }, async deleteStaticAsset(token: string, path: string) { await ensureDevAuthToken(token)
 return await fsp.unlink(path) }, async renameStaticAsset(token: string, oldPath: string, newPath: string) { await ensureDevAuthToken(token)
 const exist = cache?.find(asset => asset.filePath === newPath) if (exist) throw new Error(`File ${newPath} already exists`) return await fsp.rename(oldPath, newPath) }, } satisfies Partial<ServerFunctions>}

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_0c510012_20250110_202642.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fnuxt%2Fdevtools%2Fblob%2Fc4f2b68281203fc3f61ffc97d9c6623fbfde46bb%2Fpackages%2Fdevtools%2Fsrc%2Fdev-auth.ts)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fnuxt%2Fdevtools%2Fblob%2Fc4f2b68281203fc3f61ffc97d9c6623fbfde46bb%2Fpackages%2Fdevtools%2Fsrc%2Fdev-auth.ts)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=nuxt%2Fdevtools)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[nuxt](/nuxt)
/
**[devtools](/nuxt/devtools)**
Public

* [Notifications](/login?return_to=%2Fnuxt%2Fdevtools) You must be signed in to change notification settings
* [Fork
  164](/login?return_to=%2Fnuxt%2Fdevtools)
* [Star
   3k](/login?return_to=%2Fnuxt%2Fdevtools)

* [Code](/nuxt/devtools)
* [Issues
  69](/nuxt/devtools/issues)
* [Pull requests
  7](/nuxt/devtools/pulls)
* [Discussions](/nuxt/devtools/discussions)
* [Actions](/nuxt/devtools/actions)
* [Projects
  0](/nuxt/devtools/projects)
* [Security](/nuxt/devtools/security)
* [Insights](/nuxt/devtools/pulse)

Additional navigation options

* [Code](/nuxt/devtools)
* [Issues](/nuxt/devtools/issues)
* [Pull requests](/nuxt/devtools/pulls)
* [Discussions](/nuxt/devtools/discussions)
* [Actions](/nuxt/devtools/actions)
* [Projects](/nuxt/devtools/projects)
* [Security](/nuxt/devtools/security)
* [Insights](/nuxt/devtools/pulse)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_75163688_20250110_202644.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fnuxt%2Fdevtools%2Fblob%2Fc4f2b68281203fc3f61ffc97d9c6623fbfde46bb%2Fpackages%2Fdevtools%2Fsrc%2Fserver-rpc%2Findex.ts)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fnuxt%2Fdevtools%2Fblob%2Fc4f2b68281203fc3f61ffc97d9c6623fbfde46bb%2Fpackages%2Fdevtools%2Fsrc%2Fserver-rpc%2Findex.ts)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=nuxt%2Fdevtools)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[nuxt](/nuxt)
/
**[devtools](/nuxt/devtools)**
Public

* [Notifications](/login?return_to=%2Fnuxt%2Fdevtools) You must be signed in to change notification settings
* [Fork
  164](/login?return_to=%2Fnuxt%2Fdevtools)
* [Star
   3k](/login?return_to=%2Fnuxt%2Fdevtools)

* [Code](/nuxt/devtools)
* [Issues
  69](/nuxt/devtools/issues)
* [Pull requests
  7](/nuxt/devtools/pulls)
* [Discussions](/nuxt/devtools/discussions)
* [Actions](/nuxt/devtools/actions)
* [Projects
  0](/nuxt/devtools/projects)
* [Security](/nuxt/devtools/security)
* [Insights](/nuxt/devtools/pulse)

Additional navigation options

* [Code](/nuxt/devtools)
* [Issues](/nuxt/devtools/issues)
* [Pull requests](/nuxt/devtools/pulls)
* [Discussions](/nuxt/devtools/discussions)
* [Actions](/nuxt/devtools/actions)
* [Projects](/nuxt/devtools/projects)
* [Security](/nuxt/devtools/security)
* [Insights](/nuxt/devtools/pulse)

## Files

 c4f2b68
## Breadcrumbs

1. [devtools](/nuxt/devtools/tree/c4f2b68281203fc3f61ffc97d9c6623fbfde46bb)
2. /[packages](/nuxt/devtools/tree/c4f2b68281203fc3f61ffc97d9c6623fbfde46bb/packages)
3. /[devtools](/nuxt/devtools/tree/c4f2b68281203fc3f61ffc97d9c6623fbfde46bb/packages/devtools)
4. /[src](/nuxt/devtools/tree/c4f2b68281203fc3f61ffc97d9c6623fbfde46bb/packages/devtools/src)
5. /[server-rpc](/nuxt/devtools/tree/c4f2b68281203fc3f61ffc97d9c6623fbfde46bb/packages/devtools/src/server-rpc)
/
# index.ts

Copy path Blame  Blame
## Latest commit

## History

[History](/nuxt/devtools/commits/c4f2b68281203fc3f61ffc97d9c6623fbfde46bb/packages/devtools/src/server-rpc/index.ts)151 lines (138 loc) · 4.17 KB c4f2b68
## Breadcrumbs

1. [devtools](/nuxt/devtools/tree/c4f2b68281203fc3f61ffc97d9c6623fbfde46bb)
2. /[packages](/nuxt/devtools/tree/c4f2b68281203fc3f61ffc97d9c6623fbfde46bb/packages)
3. /[devtools](/nuxt/devtools/tree/c4f2b68281203fc3f61ffc97d9c6623fbfde46bb/packages/devtools)
4. /[src](/nuxt/devtools/tree/c4f2b68281203fc3f61ffc97d9c6623fbfde46bb/packages/devtools/src)
5. /[server-rpc](/nuxt/devtools/tree/c4f2b68281203fc3f61ffc97d9c6623fbfde46bb/packages/devtools/src/server-rpc)
/
# index.ts

Top
## File metadata and controls

* Code
* Blame

151 lines (138 loc) · 4.17 KB[Raw](https://github.com/nuxt/devtools/raw/c4f2b68281203fc3f61ffc97d9c6623fbfde46bb/packages/devtools/src/server-rpc/index.ts)123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151import type { WebSocket } from 'ws'import { createBirpcGroup } from 'birpc'import type { ChannelOptions } from 'birpc'
import { parse, stringify } from 'flatted'import type { Nuxt } from 'nuxt/schema'import { colors } from 'consola/utils'import type { Plugin } from 'vite'import { logger } from '@nuxt/kit'import type { ClientFunctions, ModuleOptions, NuxtDevtoolsServerContext, ServerFunctions } from '../types'import { WS\_EVENT\_NAME } from '../constant'import { getDevAuthToken } from '../dev-auth'import { setupStorageRPC } from './storage'import { setupAssetsRPC } from './assets'import { setupNpmRPC } from './npm'import { setupCustomTabRPC } from './custom-tabs'import { setupGeneralRPC } from './general'import { setupWizardRPC } from './wizard'import { setupTerminalRPC } from './terminals'import { setupServerRoutesRPC } from './server-routes'import { setupAnalyzeBuildRPC } from './analyze-build'import { setupOptionsRPC } from './options'import { setupTimelineRPC } from './timeline'import { setupTelemetryRPC } from './telemetry'
export function setupRPC(nuxt: Nuxt, options: ModuleOptions) { const serverFunctions = {} as ServerFunctions const extendedRpcMap = new Map<string, any>() const rpc = createBirpcGroup<ClientFunctions, ServerFunctions>( serverFunctions, [], { resolver: (name, fn) => { if (fn) return fn
 if (!name.includes(':')) return
 const [namespace, fnName] = name.split(':') return extendedRpcMap.get(namespace)?.[fnName] }, onError(error, name) { logger.error( colors.yellow(`[nuxt-devtools] RPC error on executing "${colors.bold(name)}":\n`) + colors.red(error?.message || ''), ) }, timeout: 120\_000, }, )
 function refresh(event: keyof ServerFunctions) { rpc.broadcast.refresh.asEvent(event) }
 function extendServerRpc(namespace: string, functions: any): any { extendedRpcMap.set(namespace, functions)
 return { broadcast: new Proxy({}, { get: (\_, key) => { if (typeof key !== 'string') return return (rpc.broadcast as any)[`${namespace}:${key}`] }, }), } }
 const ctx: NuxtDevtoolsServerContext = { nuxt, options, rpc, refresh, extendServerRpc, openInEditorHooks: [], async ensureDevAuthToken(token: string) { if (options.disableAuthorization) return if (token !== await getDevAuthToken()) throw new Error('Invalid dev auth token.') }, }
 // @ts-expect-error untyped nuxt.devtools = ctx
 Object.assign(serverFunctions, { ...setupGeneralRPC(ctx), ...setupCustomTabRPC(ctx), ...setupStorageRPC(ctx), ...setupAssetsRPC(ctx), ...setupNpmRPC(ctx), ...setupWizardRPC(ctx), ...setupTerminalRPC(ctx), ...setupServerRoutesRPC(ctx), ...setupAnalyzeBuildRPC(ctx), ...setupOptionsRPC(ctx), ...setupTimelineRPC(ctx), ...setupTelemetryRPC(ctx), } satisfies ServerFunctions)
 const wsClients = new Set<WebSocket>()
 const vitePlugin: Plugin = { name: 'nuxt:devtools:rpc', configureServer(server) { server.ws.on('connection', (ws) => { wsClients.add(ws) const channel: ChannelOptions = { post: d => ws.send(JSON.stringify({ type: 'custom', event: WS\_EVENT\_NAME, data: d, })), on: (fn) => { ws.on('message', (e) => { try { const data = JSON.parse(String(e)) || {} if (data.type === 'custom' && data.event === WS\_EVENT\_NAME) { // console.log(data.data) fn(data.data) } } catch {} }) }, serialize: stringify, deserialize: parse, } rpc.updateChannels((c) => { c.push(channel) }) ws.on('close', () => { wsClients.delete(ws) rpc.updateChannels((c) => { const index = c.indexOf(channel) if (index >= 0) c.splice(index, 1) }) }) }) }, }
 return { vitePlugin, ...ctx, }}

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


