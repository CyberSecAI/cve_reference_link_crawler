<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta content="IE=edge" http-equiv="X-UA-Compatible">
        <meta content="width=device-width, initial-scale=1" name="viewport">
        <title>Cross-site WebSocket hijacking | Web Security Academy</title>
        <meta content="In this section, we&#x27;ll explain cross-site WebSocket hijacking (CSWSH), describe the impact of a compromise, and spell out how to perform a cross-site ..." name="description">
        <!-- Twitter data -->



<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="Cross-site WebSocket hijacking | Web Security Academy">
    <meta name="twitter:description" content="In this section, we&#x27;ll explain cross-site WebSocket hijacking (CSWSH), describe the impact of a compromise, and spell out how to perform a cross-site ...">
<meta name="twitter:image" content="https://portswigger.net/content/images/logos/academy-twittercard.png">
    <meta name="twitter:site" content="@WebSecAcademy">

<!-- Open Graph data -->
<meta property="og:title" content="Cross-site WebSocket hijacking | Web Security Academy" />
    <meta property="og:description" content="In this section, we&#x27;ll explain cross-site WebSocket hijacking (CSWSH), describe the impact of a compromise, and spell out how to perform a cross-site ...">
<meta property="og:url" content="https://portswigger.net/web-security/websockets/cross-site-websocket-hijacking" />
<meta property="og:image" content="https://portswigger.net/content/images/logos/academy-twittercard.png"/>
<meta property="og:type" content="website"/>
<link rel="canonical" href="https://portswigger.net/web-security/websockets/cross-site-websocket-hijacking" />
<link rel="icon" href="/content/images/logos/favicon.ico" type="image/x-icon" />
<link rel="apple-touch-icon" href="/content/images/logos/apple-touch-icon.png">
        <link href="/content/pswebsecacademy.css" rel="stylesheet" type="text/css">
        <link rel="preload" href="/content/fonts/ps-icons-small/ps-icons-small.woff?td2uot" as="font" crossorigin="anonymous">
<link rel="preload" href="/content/fonts/ps-main/ps-icons.woff?l1la2n" as="font" crossorigin="anonymous">
        
<script nonce="/mq7gs1O/Lr/qYteP+c2ifeEJMfKE41C">
    const dimensionName = "dimension2";
    const userRef = "";
</script>



<script nonce="/mq7gs1O/Lr/qYteP+c2ifeEJMfKE41C">

    (function(window, document, dataLayerName, id) {
    function stgCreateCookie(a,b,c){var d="";if(c){var e=new Date;e.setTime(e.getTime()+24*c*60*60*1e3),d=";expires="+e.toUTCString()}document.cookie=a+"="+b+d+"; path=/"}
    var isStgDebug=(window.location.href.match("stg_debug")||document.cookie.match("stg_debug"))&&!window.location.href.match("stg_disable_debug");
    stgCreateCookie("stg_debug",isStgDebug?1:"",isStgDebug?14:-1);
    var qP=[];dataLayerName!=="dataLayer"&&qP.push("data_layer_name="+dataLayerName),isStgDebug&&qP.push("stg_debug");
    var qPString=qP.length>0?("?"+qP.join("&")):"";
    document.write('<nonce-script src="https://ps.containers.piwik.pro/'+id+'.sync.js' + qPString + '" nonce="/mq7gs1O/Lr/qYteP+c2ifeEJMfKE41C"></' + 'nonce-script>');
    })(window, document, 'dataLayer', '287552c2-4917-42e0-8982-ba994a2a73d7');

    window.dataLayer = window.dataLayer || [];
    window.dataLayer.push({
        customerId : '',
    });
</script> 
    </head>
    <body class="theme-">
        


<script nonce="/mq7gs1O/Lr/qYteP+c2ifeEJMfKE41C">
(function(window, document, dataLayerName, id) {
    window[dataLayerName]=window[dataLayerName]||[],window[dataLayerName].push({start:(new Date).getTime(),event:"stg.start"});
    var scripts=document.getElementsByTagName('script')[0],tags=document.createElement('script');
    function stgCreateCookie(a,b,c){var d="";if(c){var e=new Date;e.setTime(e.getTime()+24*c*60*60*1e3),d=";expires="+e.toUTCString()}document.cookie=a+"="+b+d+"; path=/"}
    var isStgDebug=(window.location.href.match("stg_debug")||document.cookie.match("stg_debug"))&&!window.location.href.match("stg_disable_debug");
    stgCreateCookie("stg_debug",isStgDebug?1:"",isStgDebug?14:-1);
    var qP=[];dataLayerName!=="dataLayer"&&qP.push("data_layer_name="+dataLayerName),tags.nonce="/mq7gs1O/Lr/qYteP+c2ifeEJMfKE41C",isStgDebug&&qP.push("stg_debug");
    var qPString=qP.length>0?("?"+qP.join("&")):"";
    tags.async=!0,tags.src="https://ps.containers.piwik.pro/"+id+".js"+qPString,
    scripts.parentNode.insertBefore(tags,scripts);
    !function(a,n,i){a[n]=a[n]||{};for(var c=0;c<i.length;c++)!function(i){a[n][i]=a[n][i]||{},a[n][i].api=a[n][i].api||function(){
    var a=[].slice.call(arguments,0);"string"==typeof a[0]&&window[dataLayerName].push({event:n+"."+i+":"+a[0],parameters:[].slice.call(arguments,1)})}}(i[c])}(window,"ppms",["tm","cm"]);
    })(window, document, 'dataLayer', '287552c2-4917-42e0-8982-ba994a2a73d7');
</script>
        


        <header class="page-header" id="top">
            <div class="container">
    <a class="logo" href="/"></a>
    <div class="header-right">
        <div class="login-buttons">
                <a class="button-orange-small" href="/users">Login</a>
        </div>
        

    <input type="checkbox" id="hamburger-mobile" class="hamburger-input-mobile">
    <input type="radio" id="hamburger-desktop" class="hamburger-input-desktop" name="mega-nav-input">
    <div class="hamburger-menu-mobile">
        <label class="hamburger-menu-label header-hidden" for="hamburger-mobile">
            <span class="hamburger-layers"></span>
        </label>
    </div>
    <div class="mega-nav">
        <input type="radio" id="mega-nav-close" class="mega-nav-input-close" name="mega-nav-input">
        <input type="radio" id="mega-nav-label-1" class="mega-nav-input-1" name="mega-nav-input">
        <input type="radio" id="mega-nav-label-2" class="mega-nav-input-2" name="mega-nav-input">
        <input type="radio" id="mega-nav-label-6" class="mega-nav-input-6" name="mega-nav-input">
        <input type="radio" id="mega-nav-label-7" class="mega-nav-input-7" name="mega-nav-input">

        <label for="mega-nav-close" class="mega-nav-close"></label>

        <label class="mega-nav-label mega-nav-label-1" for="mega-nav-label-1">
            <span class="mega-nav-text">Products</span>
            <span class="icon-arrow-head-down"></span>
        </label>
        <label class="mega-nav-label mega-nav-label-2" for="mega-nav-label-2">
            <span class="mega-nav-text">Solutions</span>
            <span class="icon-arrow-head-down"></span>
        </label>
        <a class="mega-nav-link" href="/research"><span class="mega-nav-text">Research</span></a>
        <a class="mega-nav-link" href="/web-security"><span class="mega-nav-text">Academy</span></a>
        <label class="mega-nav-label mega-nav-label-6" for="mega-nav-label-6">
            <span class="mega-nav-text">Support</span>
            <span class="icon-arrow-head-down"></span>
        </label>

        <label class="mega-nav-label mega-nav-label-7 header-hidden" for="mega-nav-label-7">
            <span class="mega-nav-text">Company</span>
            <span class="icon-arrow-head-down"></span>
        </label>
        <div class="hamburger-menu-desktop">
            <label class="hamburger-menu-label header-show" for="hamburger-desktop">
                <span class="hamburger-layers"></span>
            </label>
            <div>
                <a class="hamburger-menu-desktop-link hamburger-menu-desktop-link-1" href="/customers"><span class="mega-nav-text">Customers</span></a>
                <a class="hamburger-menu-desktop-link hamburger-menu-desktop-link-3" href="/about"><span class="mega-nav-text">About</span></a>
                <a class="hamburger-menu-desktop-link hamburger-menu-desktop-link-4" href="/blog"><span class="mega-nav-text">Blog</span></a>
                <a class="hamburger-menu-desktop-link hamburger-menu-desktop-link-5" href="/careers"><span class="mega-nav-text">Careers</span></a>
                <a class="hamburger-menu-desktop-link hamburger-menu-desktop-link-6" href="/legal"><span class="mega-nav-text">Legal</span></a>
                <a class="hamburger-menu-desktop-link hamburger-menu-desktop-link-7" href="/contact"><span class="mega-nav-text">Contact</span></a>
                <a class="hamburger-menu-desktop-link hamburger-menu-desktop-link-8" href="/support/reseller-faqs"><span class="mega-nav-text">Resellers</span></a>
            </div>
        </div>

        <a class="mega-nav-link header-hidden" href="/users/youraccount"><span class="mega-nav-text">My account</span></a>
        <a class="hamburger-menu-link hamburger-menu-link-1" href="/customers"><span class="mega-nav-text">Customers</span></a>
        <a class="hamburger-menu-link hamburger-menu-link-3" href="/about"><span class="mega-nav-text">About</span></a>
        <a class="hamburger-menu-link hamburger-menu-link-4" href="/blog"><span class="mega-nav-text">Blog</span></a>
        <a class="hamburger-menu-link hamburger-menu-link-5" href="/careers"><span class="mega-nav-text">Careers</span></a>
        <a class="hamburger-menu-link hamburger-menu-link-6" href="/legal"><span class="mega-nav-text">Legal</span></a>
        <a class="hamburger-menu-link hamburger-menu-link-7" href="/contact"><span class="mega-nav-text">Contact</span></a>
        <a class="hamburger-menu-link hamburger-menu-link-8" href="/support/reseller-faqs"><span class="mega-nav-text">Resellers</span></a>

        <div class="mega-nav-container">

            <div class="mega-nav-content mega-nav-content-1">
                <div class="section-white-medium-no-padding">
                    <div class="container-columns-66-percent-right">
                        <div>
                            <a href="/burp/enterprise" class="link-block-white">
                                <img src="/content/images/svg/icons/enterprise.svg" alt="Burp Suite Enterprise Edition">
                                <span><strong>Burp Suite Enterprise Edition</strong></span>
                                <span>The enterprise-enabled dynamic web vulnerability scanner.</span>
                            </a>

                            <a href="/burp/pro" class="link-block-white">
                                <img src="/content/images/svg/icons/professional.svg" alt="Burp Suite Professional">
                                <span><strong>Burp Suite Professional</strong></span>
                                <span>The world's #1 web penetration testing toolkit.</span>
                            </a>

                            <a href="/burp/communitydownload" class="link-block-white">
                                <img src="/content/images/svg/icons/community.svg" alt="Burp Suite Community Edition">
                                <span><strong>Burp Suite Community Edition</strong></span>
                                <span>The best manual tools to start web security testing.</span>
                            </a>

                            <a href="/burp/dastardly" class="link-block-white">
                                <img src="/mega-nav/images/dastardly.svg" alt="Dastardly, from Burp Suite">
                                <span><strong>Dastardly, from Burp Suite</strong></span>
                                <span>Free, lightweight web application security scanning for CI/CD.</span>
                            </a>

                            <a href="/burp" class="chevron-after">View all product editions</a>
                        </div>

                        <div>
                            <div class="container-cards-lists-white">
                                <a href="/burp/vulnerability-scanner">
                                    <p><strong>Burp Scanner</strong></p>
                                    <p>Burp Suite's web vulnerability scanner</p>
                                    <img src="/mega-nav/images/burp-suite-scanner.jpg" alt="Burp Suite's web vulnerability scanner'">
                                </a>
                            </div>

                        </div>


                    </div>
                </div>
            </div>

            <div class="mega-nav-content mega-nav-content-2">
                <div class="section-white-medium-no-padding">
                    <div class="container-columns-66-percent-right">
                        <div>
                            <div class="container-columns">
                                <a href="/solutions/attack-surface-visibility" class="link-block-white">
                                    <span><strong>Attack surface visibility</strong></span>
                                    <span>Improve security posture, prioritize manual testing, free up time.</span>
                                </a>
                                <a href="/solutions/ci-driven-scanning" class="link-block-white">
                                    <span><strong>CI-driven scanning</strong></span>
                                    <span>More proactive security - find and fix vulnerabilities earlier.</span>
                                </a>
                                <a href="/solutions" class="link-block-white">
                                    <span><strong>Application security testing</strong></span>
                                    <span>See how our software enables the world to secure the web.</span>
                                </a>
                                <a href="/solutions/devsecops" class="link-block-white">
                                    <span><strong>DevSecOps</strong></span>
                                    <span>Catch critical bugs; ship more secure software, more quickly.</span>
                                </a>

                                <a href="/solutions/penetration-testing" class="link-block-white">
                                    <span><strong>Penetration testing</strong></span>
                                    <span>Accelerate penetration testing - find more bugs, more quickly.</span>
                                </a>
                                <a href="/solutions/automated-security-testing" class="link-block-white">
                                    <span><strong>Automated scanning</strong></span>
                                    <span>Scale dynamic scanning. Reduce risk. Save time/money.</span>
                                </a>

                                <a href="/solutions/bug-bounty-hunting" class="link-block-white">
                                    <span><strong>Bug bounty hunting</strong></span>
                                    <span>Level up your hacking and earn more bug bounties.</span>
                                </a>
                                <a href="/solutions/compliance" class="link-block-white">
                                    <span><strong>Compliance</strong></span>
                                    <span>Enhance security monitoring to comply with confidence.</span>
                                </a>
                            </div>
                            <a href="/solutions" class="chevron-after">View all solutions</a>
                        </div>

                        <div>
                            <div class="container-cards-lists-white">
                                <a href="/burp/enterprise/resources/enterprise-edition-vs-professional">
                                    <p><strong>Product comparison</strong></p>
                                    <p>What's the difference between Pro and Enterprise Edition?</p>
                                    <img src="/mega-nav/images/burp-suite.jpg" alt="Burp Suite Professional vs Burp Suite Enterprise Edition">
                                </a>
                            </div>

                        </div>


                    </div>
                </div>
            </div>

            <div class="mega-nav-content mega-nav-content-6">
                <div class="section-white-medium-no-padding">
                    <div class="container-columns-66-percent-right">
                        <div>
                            <div class="container-columns">
                                <a href="/support" class="link-block-white">
                                    <span><strong>Support Center</strong></span>
                                    <span>Get help and advice from our experts on all things Burp.</span>
                                </a>
                                <a href="/burp/documentation" class="link-block-white">
                                    <span><strong>Documentation</strong></span>
                                    <span>Tutorials and guides for Burp Suite.</span>
                                </a>
                                <a href="/burp/documentation/desktop/getting-started" class="link-block-white">
                                    <span><strong>Get Started - Professional</strong></span>
                                    <span>Get started with Burp Suite Professional.</span>
                                </a>
                                <a href="/burp/documentation/enterprise/getting-started" class="link-block-white">
                                    <span><strong>Get Started - Enterprise</strong></span>
                                    <span>Get started with Burp Suite Enterprise Edition.</span>
                                </a>
                                <a href="https://forum.portswigger.net/" class="link-block-white">
                                    <span><strong>User Forum</strong></span>
                                    <span>Get your questions answered in the User Forum.</span>
                                </a>
                                <a href="/burp/releases" class="link-block-white">
                                    <span><strong>Downloads</strong></span>
                                    <span>Download the latest version of Burp Suite.</span>
                                </a>
                            </div>
                            <a href="/support" class="chevron-after">Visit the Support Center</a>
                        </div>

                        <div>
                            <div class="container-cards-lists-white">
                                <a href="/burp/releases">
                                    <p><strong>Downloads</strong></p>
                                    <p>Download the latest version of Burp Suite.</p>
                                    <img src="/mega-nav/images/latest-burp-suite-software-download.jpg" alt="The latest version of Burp Suite software for download">
                                </a>
                            </div>

                        </div>


                    </div>
                </div>
            </div>

        </div>

    </div>


    </div>
</div>
        </header>
        
            <nav class="navigation-top">
                <input type="checkbox" id="nav-main-enterprise">
                <label for="nav-main-enterprise">
                    <span>Academy home</span>
                    <span class="icon-arrow-head-down"></span>
                </label>
                <ul>
                    <li><a href="https://portswigger.net/web-security/index.html">Dashboard</a></li>
                    <li><a href="https://portswigger.net/web-security/learning-paths">Learning paths</a></li>
                    <li>
                        <input type="checkbox" id="nav-main-academy-topics">
                        <label for="nav-main-academy-topics">
                            <span>Latest topics</span>
                            <span class="icon-arrow-head-down"></span>
                        </label>
                        <div>
                            <a href="/web-security/web-cache-deception">Web cache deception</a>
                            <a href="/web-security/llm-attacks">Web LLM attacks</a>
                            <a href="/web-security/api-testing">API testing</a>
                            <a href="/web-security/nosql-injection">NoSQL injection</a>
                            <a href="/web-security/race-conditions">Race conditions</a>
                            <a href="/web-security/all-topics">View all topics</a>
                        </div>
                    </li>
                    <li>
                        <input type="checkbox" id="nav-main-academy-all-content">
                        <label for="nav-main-academy-all-content">
                            <span>All content</span>
                            <span class="icon-arrow-head-down"></span>
                        </label>
                        <div>
                            <a href="/web-security/all-labs">All labs</a>
                            <a href="/web-security/all-topics">All topics</a>
                            <a href="/web-security/mystery-lab-challenge">Mystery labs</a>
                        </div>
                    </li>
                    <li>
                        <input type="checkbox" id="nav-main-academy-hall-of-fame">
                        <label for="nav-main-academy-hall-of-fame">
                            <span>Hall of Fame</span>
                            <span class="icon-arrow-head-down"></span>
                        </label>
                        <div>
                            <a href="https://portswigger.net/web-security/hall-of-fame">Leaderboard</a>
                            <a href="https://portswigger.net/web-security/getting-started/kamil-vavra/index.html">Interview - Kamil Vavra</a>
                            <a href="https://portswigger.net/web-security/getting-started/johnny-villarreal/index.html">Interview - Johnny Villarreal</a>
                            <a href="https://portswigger.net/web-security/getting-started/andres-rauschecker/index.html">Interview - Andres Rauschecker</a>
                        </div>
                    </li>
                    <li><a href="https://portswigger.net/web-security/getting-started/index.html">Get started</a></li>
                    <li>
                        <input type="checkbox" id="nav-main-academy-certification">
                        <label for="nav-main-academy-certification">
                             <span>Get certified</span>
                             <span class="icon-arrow-head-down"></span>
                        </label>
                        <div>
                             <a href="https://portswigger.net/web-security/certification/index.html">Get certified</a>
                             <a href="https://portswigger.net/web-security/certification/how-to-prepare/index.html">How to prepare</a>
                             <a href="https://portswigger.net/web-security/certification/how-it-works/index.html">How it works</a>
                             <a href="https://portswigger.net/web-security/certification/practice-exam/index.html">Practice exam</a>
                             <a href="https://portswigger.net/web-security/certification/exam-hints-and-guidance/index.html">Exam hints and guidance</a>
                             <a href="https://portswigger.net/web-security/certification/how-it-works/index.html#what-the-exam-involves">What the exam involves</a>
                             <a href="https://portswigger.net/web-security/certification/frequently-asked-questions/index.html">FAQs</a>
                             <a href="https://portswigger.net/web-security/certification#validate-your-certification">Validate your certification</a>
                        </div>
                    </li>
                </ul>
            </nav>
        
        <div class="wrapper-large">
            <div class="container-academy">
                
                <input class="nav-lhs-toggle-input" type="checkbox" id="nav-lhs-toggle">
                <aside class="nav-lhs" id="tree-nav" tree-nav-version="246">
                    <nav class="nav-lhs-scrollable">
                    <label class="nav-lhs-toggle-label" for="nav-lhs-toggle"></label> 
                    

        <a class="nav-back" href="/web-security/all-topics">
            <span class="icon-arrow-head-left"></span>
            Back to all topics
        </a>
        <input type="checkbox" id="nav-main-id">
        <label class="nav-label" for="nav-main-id">
            <span class="icon-arrow-head-down"></span>
        </label>
        <h3>WebSockets</h3>
        <ul>
            <li>
                <input type="checkbox" id="sub-nav-id-1">
                <label for="sub-nav-id-1">
                    <a href="/web-security/websockets/what-are-websockets">What are WebSockets?</a>
                    <span class="icon-arrow-head-down"></span>
                </label>
                <ul>
                    <li><a href="/web-security/websockets/what-are-websockets#what-is-the-difference-between-http-and-websockets">HTTP vs WebSockets</a></li>
                    <li><a href="/web-security/websockets/what-are-websockets#how-are-websocket-connections-established">How are connections established?</a></li>
                    <li><a href="/web-security/websockets/what-are-websockets#what-do-websocket-messages-look-like">What do WebSocket messages look like?</a></li>
                </ul>
            </li>
            <li>
                <input type="checkbox" id="sub-nav-id-2">
                <label for="sub-nav-id-2">
                    <a href="/web-security/websockets#manipulating-websocket-traffic">Manipulating WebSocket traffic</a>
                    <span class="icon-arrow-head-down"></span>
                </label>
                <ul>
                    <li><a href="/web-security/websockets#intercepting-and-modifying-websocket-messages">Intercepting and modifying messages</a></li>
                    <li><a href="/web-security/websockets#replaying-and-generating-new-websocket-messages">Replaying and generating new messages</a></li>
                    <li><a href="/web-security/websockets#manipulating-websocket-connections">Manipulating WebSocket connections</a></li>
                </ul>
            </li>
            <li>
                <input type="checkbox" id="sub-nav-id-3">
                <label for="sub-nav-id-3">
                    <a href="/web-security/websockets#websockets-security-vulnerabilities">Exploiting vulnerabilities</a>
                    <span class="icon-arrow-head-down"></span>
                </label>
                <ul>
                    <li><a href="/web-security/websockets#manipulating-websocket-messages-to-exploit-vulnerabilities">Manipulating WebSocket messages</a></li>
                    <li><a href="/web-security/websockets#manipulating-the-websocket-handshake-to-exploit-vulnerabilities">Manipulating the WebSocket handshake</a></li>
                    <li>
                        <input type="checkbox" id="sub-nav-id-4">
                        <label for="sub-nav-id-4">
                            <a href="/web-security/websockets/cross-site-websocket-hijacking">Cross-site WebSocket hijacking</a>
                            <span class="icon-arrow-head-down"></span>
                        </label>
                        <ul>
                            <li><a href="/web-security/websockets/cross-site-websocket-hijacking#what-is-the-impact-of-cross-site-websocket-hijacking">Impact</a></li>
                            <li><a href="/web-security/websockets/cross-site-websocket-hijacking#performing-a-cross-site-websocket-hijacking-attack">Performing an attack</a></li>
                        </ul>
                    </li>
                </ul>
            </li>
            <li><a href="/web-security/websockets#how-to-secure-a-websocket-connection">Securing a WebSocket connection</a></li>
            <li><a href="/web-security/all-labs#websockets">View all WebSockets labs</a></li>
        </ul>
    
                    </nav>
                </aside>
                <main>
                    



<ul class="breadcrumb-list" itemscope itemtype="http://schema.org/BreadcrumbList"><li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem"><a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/web-security"><span itemprop="name">Web Security Academy</span></a><meta itemprop="position" content="1" /></li><li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem"><a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/web-security/websockets"><span itemprop="name">WebSockets</span></a><meta itemprop="position" content="2" /></li><li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem"><a itemscope itemtype="http://schema.org/Thing" itemprop="item" href="/web-security/websockets/cross-site-websocket-hijacking"><span itemprop="name">CSWSH</span></a><meta itemprop="position" content="3" /></li></ul>    <div class="section theme-white">

        <h1 class="heading-2">Cross-site WebSocket hijacking</h1><p>
            In this section, we'll explain cross-site WebSocket hijacking (CSWSH), describe the impact of a compromise, and spell out how to perform a cross-site WebSocket hijacking attack.
        </p><h2 id="what-is-cross-site-websocket-hijacking">What is cross-site WebSocket hijacking?</h2><p>
            Cross-site WebSocket hijacking (also known as cross-origin WebSocket hijacking) involves a cross-site request forgery (CSRF) vulnerability on a <a href="/web-security/websockets/what-are-websockets#how-are-websocket-connections-established">WebSocket handshake</a>. It arises when the WebSocket handshake request relies solely on HTTP cookies for session handling and does not contain any CSRF tokens or other unpredictable values.
        </p><p>
            An attacker can create a malicious web page on their own domain which establishes a cross-site WebSocket connection to the vulnerable application. The application will handle the connection in the context of the victim user's session with the application.
        </p><p>
            The attacker's page can then send arbitrary messages to the server via the connection and read the contents of messages that are received back from the server. This means that, unlike regular CSRF, the attacker gains two-way interaction with the compromised application.
        </p><h2 id="what-is-the-impact-of-cross-site-websocket-hijacking">What is the impact of cross-site WebSocket hijacking?</h2><p>
            A successful cross-site WebSocket hijacking attack will often enable an attacker to:
        </p><ul>
            <li>
                <strong>Perform unauthorized actions masquerading as the victim user.</strong> As with regular CSRF, the attacker can send arbitrary messages to the server-side application. If the application uses client-generated WebSocket messages to perform any sensitive actions, then the attacker can generate suitable messages cross-domain and trigger those actions.
            </li>
            <li>
                <strong>Retrieve sensitive data that the user can access.</strong> Unlike with regular CSRF, cross-site WebSocket hijacking gives the attacker two-way interaction with the vulnerable application over the hijacked WebSocket. If the application uses server-generated WebSocket messages to return any sensitive data to the user, then the attacker can intercept those messages and capture the victim user's data.
            </li>
        </ul><h2 id="performing-a-cross-site-websocket-hijacking-attack">Performing a cross-site WebSocket hijacking attack</h2><p>
            Since a cross-site WebSocket hijacking attack is essentially a CSRF vulnerability on a WebSocket handshake, the first step to performing an attack is to review the WebSocket handshakes that the application carries out and determine whether they are protected against CSRF.
        </p><p>
            In terms of the <a href="/web-security/csrf#how-does-csrf-work">normal conditions for CSRF attacks</a>, you typically need to find a handshake message that relies solely on HTTP cookies for session handling and doesn't employ any tokens or other unpredictable values in request parameters.
        </p><p id="performing-a-cross-site-websocket-hijacking-attack-K5P6">
            For example, the following WebSocket handshake request is probably vulnerable to CSRF, because the only session token is transmitted in a cookie:
        </p><code class="code-scrollable">GET /chat HTTP/1.1
Host: normal-website.com
Sec-WebSocket-Version: 13
Sec-WebSocket-Key: wDqumtseNBJdhkihL6PW7w==
Connection: keep-alive, Upgrade
Cookie: session=KOsEJNuflw4Rd9BDNrVmvwBF9rEijeE2
Upgrade: websocket</code><div class="highlightedarea">
            <h4>Note</h4>
        <p>
            The <code>Sec-WebSocket-Key</code> header contains a random value to prevent errors from caching proxies, and is not used for authentication or session handling purposes.
        </p>
		</div><p id="performing-a-cross-site-websocket-hijacking-attack-D5E9">
            If the WebSocket handshake request is vulnerable to CSRF, then an attacker's web page can perform a cross-site request to open a WebSocket on the vulnerable site. What happens next in the attack depends entirely on the application's logic and how it is using WebSockets. The attack might involve:
        </p><ul>
            <li> Sending WebSocket messages to perform unauthorized actions on behalf of the victim user. </li>
            <li> Sending WebSocket messages to retrieve sensitive data. </li>
            <li>
                Sometimes, just waiting for incoming messages to arrive containing sensitive data.
            </li>
        </ul>

    <div class="widgetcontainer-lab-link " id="a15ec3915bdc09700eea6c9fd20970de0aaf2bfbb87b3e7ec3d8d9800b8e542d">
        <span>LAB</span>
        <div class="flex-columns">
            <span class="label-light-blue-small">PRACTITIONER</span>
            <a href="/web-security/websockets/cross-site-websocket-hijacking/lab">Cross-site WebSocket hijacking</a>
        </div>
    </div>

        
        
    <div class="footer">
        <div class="margin-bottom-medium section-no-padding theme-enterprise-2">
            <h2 class="text-center">Register for free to track your learning progress</h2>
        </div>
        <div class="section-no-padding theme-enterprise-2">
            <div class="container-columns-vertically-centered">
                <div class="container-small text-right">
                    <img alt="The benefits of working through PortSwigger's Web Security Academy" src="/content/images/vulnerabilities/web-security-academy-footer.png">
                </div>
                <div class="section-small text-left">
                    <ul class="unordered-list-vertical-ticks-small">
                        <li>
                            <p>Practise exploiting vulnerabilities on realistic targets.</p>
                        </li>
                        <li>
                            <p>Record your progression from Apprentice to Expert.</p>
                        </li>
                        <li>
                            <p>See where you rank in our Hall of Fame.</p>
                        </li>
                    </ul>
                    
<form action="/users/register" class="recaptchaloadingmask text-left" id="RegistrationWidget-FB0FF9F27DDD91A74291DBB8A5E589D5" method="post"><input type="hidden" name="RequestVerificationToken" value="F7BA3A1B295D4787EF7AE248B9948D81E75ABEBAD3FFA4F70A27F5A3F40C1C86529B93D1E34B964C07A5B2A02FED8A94243BE61C9BFBD583AEA84088E2AF6B9F">        <div class="form-small disable-no-recaptcha">
            <div class="font-small-error hidden">
                <span class="icon-alert-white"></span>
                <span class="font-small-error-text"></span>
            </div>
            <label>
                <input name="EmailAddress" placeholder="Enter your email" type="email">
                <button class="button-orange" type="submit">
                    <span>REGISTER</span>
                </button>
            </label>
        </div>
    <div id="Recaptcha-FB0FF9F27DDD91A74291DBB8A5E589D5" class="recaptcha-div">
            <div class="recaptcha-inner">
                <div class="hidden" id="NoRecaptcha-FB0FF9F27DDD91A74291DBB8A5E589D5">
                    

    <div class="notify-inline no-padding-bottom  error">
        <div class="notify-logo icon-error"></div>
        <div class="notify-message">
            As we use reCAPTCHA, you need to be able to access Google's servers to use this function.
        </div>
    </div>

                </div>

                <input id="RecaptchaToken-FB0FF9F27DDD91A74291DBB8A5E589D5" name="RecaptchaToken" type="hidden" value="">
                <input type="hidden" id="RecaptchaClientSecret-FB0FF9F27DDD91A74291DBB8A5E589D5" value="6LcEbGQpAAAAAG5JHilJGhS8gS1WHx8YESTR8Arv">
                <input type="hidden" id="RecaptchaV2ClientSecret-FB0FF9F27DDD91A74291DBB8A5E589D5" value="6Ld3bGQpAAAAAKyCAg40XRmP87A6XNT7CW4rQq7F">
                <div id="RecaptchaRenderLocation-FB0FF9F27DDD91A74291DBB8A5E589D5" class="grecaptcha-v2-box"></div>
            </div>
            <script nonce="/mq7gs1O/Lr/qYteP&#x2B;c2ifeEJMfKE41C">
              var recaptchaClientUrl = "https://www.google.com/recaptcha/api.js?render=";
            </script>
        <span class="Warning field-validation-valid" data-valmsg-for="RecaptchaToken" data-valmsg-replace="true"></span>
    </div>
</form>    <p>
        Already got an account?
        <a href="https://portswigger.net/users">Login here</a>
    </p>
    <script src="/bundles/widgets/register.js?v=ks5Ax-XeNUsI1M28zz5J8CxXNYY" nonce="/mq7gs1O/Lr/qYteP&#x2B;c2ifeEJMfKE41C"></script>

                </div>
            </div>
        </div>
    </div>

    
    </div>


    <script src="/bundles/public/staticcms.js?v=ZCCRCRh4bxVJcTGuyy5kcZwV-G8" nonce="/mq7gs1O/Lr/qYteP&#x2B;c2ifeEJMfKE41C"></script>
    <script src="/bundles/public/websecacademy.js?v=rOOT_p5bA_A0ZF_z6o92JrX7K6g" nonce="/mq7gs1O/Lr/qYteP&#x2B;c2ifeEJMfKE41C"></script>

                    
        <div class="sidebar-content">
            
<input class="hidden" id="trackerpopup" type="checkbox">
<div class="widgetcontainer-box is-twobtns academy-account-status is-logged-out" id="AcademyAccountStatusWidget">
        <p class="hidden-when-collapsed">Want to track your progress and have a more personalized learning experience? (It's free!)</p>
        <div class="flex-center">
            <a class="button-orange-small" href="/users/register">Sign up</a>
            <a class="button-white-small" href="/users?returnurl=%2fweb-security%2fwebsockets%2fcross-site-websocket-hijacking">Login</a>
        </div>
</div>


            <div class="sidebar-trial-advert">
                <img alt="Try Burp Suite for Free" src="/content/images/logos/burp-suite-icon.svg">
                <h4>Find WebSocket vulnerabilities using Burp Suite</h4>
                <a class="button-white" href="https://portswigger.net/burp">Try for free</a>
            </div>
        </div>
    
                </main>
            </div>
        </div>
        
    <footer class="wrapper">
        <div class="container">
            <div>
                <p>Burp Suite</p>
                <a href="/burp/vulnerability-scanner">Web vulnerability scanner</a>
                <a href="/burp">Burp Suite Editions</a>
                <a href="/burp/releases">Release Notes</a>
            </div>
            <div>
                <p>Vulnerabilities</p>
                <a href="/web-security/cross-site-scripting">Cross-site scripting (XSS)</a>
                <a href="/web-security/sql-injection">SQL injection</a>
                <a href="/web-security/csrf">Cross-site request forgery</a>
                <a href="/web-security/xxe">XML external entity injection</a>
                <a href="/web-security/file-path-traversal">Directory traversal</a>
                <a href="/web-security/ssrf">Server-side request forgery</a>
            </div>
            <div>
                <p>Customers</p>
                <a href="/organizations">Organizations</a>
                <a href="/testers">Testers</a>
                <a href="/developers">Developers</a>
            </div>
            <div>
                <p>Company</p>
                <a href="/about">About</a>
                <a href="/careers">Careers</a>
                <a href="/about/contact">Contact</a>
                <a href="/legal">Legal</a>
                <a href="/privacy">Privacy Notice</a>
            </div>
            <div>
                <p>Insights</p>
                <a href="/web-security">Web Security Academy</a>
                <a href="/blog">Blog</a>
                <a href="/research">Research</a>
            </div>
            <div>
                <a href="/"><img src="/content/images/logos/portswigger-logo.svg" alt="PortSwigger Logo" class="footer-logo"></a>
                <a class="button-outline-blue-small camelcase" href="https://twitter.com/Burp_Suite" rel="noreferrer"><span class="icon-twitter"></span>  Follow us</a>
                <p class="grey">&copy; 2025 PortSwigger Ltd.</p>
            </div>
        </div>
    </footer>
    <a href="#top" class="back-to-top"><svg xmlns="http://www.w3.org/2000/svg" width="26" height="26" viewBox="0 0 26 26"><polygon points="4.07 14.7 5.03 15.78 12.48 9.13 19.94 15.78 20.9 14.7 12.48 7.2 4.07 14.7" fill="#f63" /><path d="M13,0A13,13,0,1,0,26,13,13,13,0,0,0,13,0Zm0,24.56A11.56,11.56,0,1,1,24.56,13,11.58,11.58,0,0,1,13,24.56Z" fill="#f63" /></svg></a>

    </body>
</html>