=== Content from github.com_fac28a0e_20250111_042344.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fcontao%2Fcontao%2Fcommit%2Fc98585d36baa25fda69c062421e7e7eadc53c82b)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fcontao%2Fcontao%2Fcommit%2Fc98585d36baa25fda69c062421e7e7eadc53c82b)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=contao%2Fcontao)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[contao](/contao)
/
**[contao](/contao/contao)**
Public

* [Notifications](/login?return_to=%2Fcontao%2Fcontao) You must be signed in to change notification settings
* [Fork
  160](/login?return_to=%2Fcontao%2Fcontao)
* [Star
   359](/login?return_to=%2Fcontao%2Fcontao)

* [Code](/contao/contao)
* [Issues
  317](/contao/contao/issues)
* [Pull requests
  91](/contao/contao/pulls)
* [Actions](/contao/contao/actions)
* [Security](/contao/contao/security)
* [Insights](/contao/contao/pulse)

Additional navigation options

* [Code](/contao/contao)
* [Issues](/contao/contao/issues)
* [Pull requests](/contao/contao/pulls)
* [Actions](/contao/contao/actions)
* [Security](/contao/contao/security)
* [Insights](/contao/contao/pulse)

## Commit

[Permalink](/contao/contao/commit/c98585d36baa25fda69c062421e7e7eadc53c82b)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Merge pull request from [GHSA-4gpr-p634-922x](https://github.com/advisories/GHSA-4gpr-p634-922x "GHSA-4gpr-p634-922x")

[Browse files](/contao/contao/tree/c98585d36baa25fda69c062421e7e7eadc53c82b)
Browse the repository at this point in the history

* Loading branch information

[![@ausi](https://avatars.githubusercontent.com/u/367169?s=40&v=4)](/ausi)

[ausi](/contao/contao/commits?author=ausi "View all commits by ausi")
authored
Jul 25, 2023

1 parent
[2f8026c](/contao/contao/commit/2f8026c42da3b5e03baae640b590344c3a4b72dd)

commit c98585d

 Show file tree

 Hide file tree

Showing
**3 changed files**
with
**35 additions**
and
**35 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* core-bundle/contao/widgets

  + core-bundle/contao/widgets/InputUnit.php
    [InputUnit.php](#diff-f238a8b0a2b3fcfcd6795d0ad7a82f7212cf2eefcf19b74efa6fa435eafe8241)
  + core-bundle/contao/widgets/TimePeriod.php
    [TimePeriod.php](#diff-87488222eb474de77255637dd89ae78a5ce2d6da17c15beb7cea41b8a7b62e94)
  + core-bundle/contao/widgets/TrblField.php
    [TrblField.php](#diff-ff5bdc223fa6527b1c5ed4de88da7c291d83461a762315a00c4633b33641d4dd)

## There are no files selected for viewing

22 changes: 11 additions & 11 deletions

22
[core-bundle/contao/widgets/InputUnit.php](#diff-f238a8b0a2b3fcfcd6795d0ad7a82f7212cf2eefcf19b74efa6fa435eafe8241 "core-bundle/contao/widgets/InputUnit.php")

Show comments

[View file](/contao/contao/blob/c98585d36baa25fda69c062421e7e7eadc53c82b/core-bundle/contao/widgets/InputUnit.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -32,12 +32,6 @@ class InputUnit extends Widget |
|  |  | \*/ |
|  |  | protected $strTemplate = 'be\_widget'; |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Units |
|  |  | \* @var array |
|  |  | \*/ |
|  |  | protected $arrUnits = array(); |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Add specific attributes |
|  |  | \* |
| Expand Down  Expand Up | | @@ -72,7 +66,7 @@ public function \_\_set($strKey, $varValue) |
|  |  | break; |
|  |  |  |
|  |  | case 'options': |
|  |  | $this->arrUnits = StringUtil::deserialize($varValue); |
|  |  | $this->arrOptions = StringUtil::deserialize($varValue); |
|  |  | break; |
|  |  |  |
|  |  | default: |
| Expand All | | @@ -82,8 +76,6 @@ public function \_\_set($strKey, $varValue) |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Do not validate unit fields |
|  |  | \* |
|  |  | \* @param mixed $varInput |
|  |  | \* |
|  |  | \* @return mixed |
| Expand All | | @@ -92,7 +84,15 @@ protected function validator($varInput) |
|  |  | { |
|  |  | foreach ($varInput as $k=>$v) |
|  |  | { |
|  |  | if ($k != 'unit') |
|  |  | if ($k == 'unit') |
|  |  | { |
|  |  | if (!$this->isValidOption($v)) |
|  |  | { |
|  |  | $varInput[$k] = ''; |
|  |  | $this->addError($GLOBALS['TL\_LANG']['ERR']['invalid']); |
|  |  | } |
|  |  | } |
|  |  | else |
|  |  | { |
|  |  | $varInput[$k] = parent::validator($v); |
|  |  | } |
| Expand Down  Expand Up | | @@ -132,7 +132,7 @@ public function generate() |
|  |  | { |
|  |  | $arrUnits = array(); |
|  |  |  |
|  |  | foreach ($this->arrUnits as $arrUnit) |
|  |  | foreach ($this->arrOptions as $arrUnit) |
|  |  | { |
|  |  | $arrUnits[] = sprintf( |
|  |  | '<option value="%s"%s>%s</option>', |
| Expand Down | |  |

26 changes: 13 additions & 13 deletions

26
[core-bundle/contao/widgets/TimePeriod.php](#diff-87488222eb474de77255637dd89ae78a5ce2d6da17c15beb7cea41b8a7b62e94 "core-bundle/contao/widgets/TimePeriod.php")

Show comments

[View file](/contao/contao/blob/c98585d36baa25fda69c062421e7e7eadc53c82b/core-bundle/contao/widgets/TimePeriod.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -31,12 +31,6 @@ class TimePeriod extends Widget |
|  |  | \*/ |
|  |  | protected $strTemplate = 'be\_widget'; |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Units |
|  |  | \* @var array |
|  |  | \*/ |
|  |  | protected $arrUnits = array(); |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Add specific attributes |
|  |  | \* |
| Expand Down  Expand Up | | @@ -67,7 +61,7 @@ public function \_\_set($strKey, $varValue) |
|  |  | break; |
|  |  |  |
|  |  | case 'options': |
|  |  | $this->arrUnits = StringUtil::deserialize($varValue); |
|  |  | $this->arrOptions = StringUtil::deserialize($varValue); |
|  |  | break; |
|  |  |  |
|  |  | default: |
| Expand All | | @@ -77,8 +71,6 @@ public function \_\_set($strKey, $varValue) |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Do not validate unit fields |
|  |  | \* |
|  |  | \* @param mixed $varInput |
|  |  | \* |
|  |  | \* @return mixed |
| Expand All | | @@ -87,7 +79,15 @@ protected function validator($varInput) |
|  |  | { |
|  |  | foreach ($varInput as $k=>$v) |
|  |  | { |
|  |  | if ($k != 'unit') |
|  |  | if ($k == 'unit') |
|  |  | { |
|  |  | if (!$this->isValidOption($v)) |
|  |  | { |
|  |  | $varInput[$k] = ''; |
|  |  | $this->addError($GLOBALS['TL\_LANG']['ERR']['invalid']); |
|  |  | } |
|  |  | } |
|  |  | else |
|  |  | { |
|  |  | $varInput[$k] = parent::validator($v); |
|  |  | } |
| Expand Down  Expand Up | | @@ -128,12 +128,12 @@ public function generate() |
|  |  | $arrUnits = array(); |
|  |  |  |
|  |  | // Add an empty option if there are none (see #5067) |
|  |  | if (empty($this->arrUnits)) |
|  |  | if (empty($this->arrOptions)) |
|  |  | { |
|  |  | $this->arrUnits = array(array('value'=>'', 'label'=>'-')); |
|  |  | $this->arrOptions = array(array('value'=>'', 'label'=>'-')); |
|  |  | } |
|  |  |  |
|  |  | foreach ($this->arrUnits as $arrUnit) |
|  |  | foreach ($this->arrOptions as $arrUnit) |
|  |  | { |
|  |  | $arrUnits[] = sprintf( |
|  |  | '<option value="%s"%s>%s</option>', |
| Expand Down | |  |

22 changes: 11 additions & 11 deletions

22
[core-bundle/contao/widgets/TrblField.php](#diff-ff5bdc223fa6527b1c5ed4de88da7c291d83461a762315a00c4633b33641d4dd "core-bundle/contao/widgets/TrblField.php")

Show comments

[View file](/contao/contao/blob/c98585d36baa25fda69c062421e7e7eadc53c82b/core-bundle/contao/widgets/TrblField.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -30,12 +30,6 @@ class TrblField extends Widget |
|  |  | \*/ |
|  |  | protected $strTemplate = 'be\_widget'; |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Units |
|  |  | \* @var array |
|  |  | \*/ |
|  |  | protected $arrUnits = array(); |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Add specific attributes |
|  |  | \* |
| Expand All | | @@ -54,7 +48,7 @@ public function \_\_set($strKey, $varValue) |
|  |  | break; |
|  |  |  |
|  |  | case 'options': |
|  |  | $this->arrUnits = StringUtil::deserialize($varValue); |
|  |  | $this->arrOptions = StringUtil::deserialize($varValue); |
|  |  | break; |
|  |  |  |
|  |  | default: |
| Expand All | | @@ -64,8 +58,6 @@ public function \_\_set($strKey, $varValue) |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Do not validate unit fields |
|  |  | \* |
|  |  | \* @param mixed $varInput |
|  |  | \* |
|  |  | \* @return mixed |
| Expand All | | @@ -74,7 +66,15 @@ protected function validator($varInput) |
|  |  | { |
|  |  | foreach ($varInput as $k=>$v) |
|  |  | { |
|  |  | if ($k != 'unit') |
|  |  | if ($k == 'unit') |
|  |  | { |
|  |  | if (!$this->isValidOption($v)) |
|  |  | { |
|  |  | $varInput[$k] = ''; |
|  |  | $this->addError($GLOBALS['TL\_LANG']['ERR']['invalid']); |
|  |  | } |
|  |  | } |
|  |  | else |
|  |  | { |
|  |  | $varInput[$k] = parent::validator($v); |
|  |  | } |
| Expand Down  Expand Up | | @@ -114,7 +114,7 @@ public function generate() |
|  |  | { |
|  |  | $arrUnits = array(); |
|  |  |  |
|  |  | foreach ($this->arrUnits as $arrUnit) |
|  |  | foreach ($this->arrOptions as $arrUnit) |
|  |  | { |
|  |  | $arrUnits[] = sprintf( |
|  |  | '<option value="%s"%s>%s</option>', |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `c98585d`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fcontao%2Fcontao%2Fcommit%2Fc98585d36baa25fda69c062421e7e7eadc53c82b) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from herolab.usd.de_63d464ce_20250111_042352.html ===

[![](https://herolab.usd.de/wp-content/uploads/sites/9/2021/07/usd-HeroLab-Logo-hell-nebeneinander.svg "usd HeroLab Logo hell nebeneinander")](https://herolab.usd.de/)

* [Über uns](https://herolab.usd.de/ueber-uns/)
  + [Wie wir arbeiten](https://herolab.usd.de/wie-wir-arbeiten/)
  + [Unsere Expert\*innen](https://herolab.usd.de/unsere-experten/)
  + [Unsere Leistungen](https://www.usd.de/security-analysis-pentests/)
  + [Unsere Plattformen und Tools](https://herolab.usd.de/unsere-plattformen-und-tools/)
* [Security Research](https://herolab.usd.de/security-research/)
  + [Unser Engagement](/security-research/#engagement)
  + [Security Advisories](https://herolab.usd.de/security-advisories/)
  + [Responsible Disclosure](https://herolab.usd.de/responsible-disclosure/)
* [LabNews](https://herolab.usd.de/labnews/)
* [Meet the Team](https://herolab.usd.de/meet-the-team/)
* [usd AG](http://www.usd.de)
* [English](https://herolab.usd.de/en/security-advisories/usd-2023-0020/ "English")

[![](https://herolab.usd.de/wp-content/uploads/sites/9/2021/07/usd-HeroLab-Logo-hell-nebeneinander.svg)](https://herolab.usd.de/)

* [Über uns](https://herolab.usd.de/ueber-uns/)
  + [Wie wir arbeiten](https://herolab.usd.de/wie-wir-arbeiten/)
  + [Unsere Expert\*innen](https://herolab.usd.de/unsere-experten/)
  + [Unsere Leistungen](https://www.usd.de/security-analysis-pentests/)
  + [Unsere Plattformen und Tools](https://herolab.usd.de/unsere-plattformen-und-tools/)
* [Security Research](https://herolab.usd.de/security-research/)
  + [Unser Engagement](/security-research/#engagement)
  + [Security Advisories](https://herolab.usd.de/security-advisories/)
  + [Responsible Disclosure](https://herolab.usd.de/responsible-disclosure/)
* [LabNews](https://herolab.usd.de/labnews/)
* [Meet the Team](https://herolab.usd.de/meet-the-team/)
* [usd AG](http://www.usd.de)
* [English](https://herolab.usd.de/en/security-advisories/usd-2023-0020/ "English")

# usd-2023-0020 | XSS in Contao v.4.13.28

#

**Advisory ID**: usd-2023-0020

**Product**: Contao CMS

**Affected Version**: 4.0.0 to 4.9.42, 4.13.28, and 5.1.10

**Vulnerability Type**: CWE 79 - Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')

**Security Risk**: Medium

**Vendor URL**: <https://contao.org/en/>

**Vendor Status**: Fixed

**CVE Number**: CVE-2023-36806

**CVE Link**: <https://nvd.nist.gov/vuln/detail/CVE-2023-36806>

### Desciption

Contao is a powerful open source CMS that lets you create professional websites and scalable web applications.

A user of a low-privileged role can send along an XSS payload via a modification of the request that creates an article with a headline, which is triggered in the frontend and in the backend.

When choosing the headline, different **h** tags can be used.

However, these are not checked by the Contao system on the server side.

If a **script** tag is sent instead, the headline is embedded in a **script** tag. The headline can then be used for the content of a payload.

Although the Contao backend filters out certain special characters like **= ( ) < >** at this point, this is not sufficient to prevent a successful payload.

### Proof of Concept

To include the XSS in the payload, the **headline[unit]** attribute for the HTML value of the headline must be changed from an **h tag** to a **script tag**. Then the following payload can be entered in the **headline[value]** field:

*Reflect.apply.call\**${alert}${undefined}${[document.domain]}\*\*\*

```
POST /contao?do=article&id=10767&table=tl_content&act=edit&rt=b64d9e8[...] HTTP/1.1
Host:vulnerable-host.de
[...]
&headline%5Bvalue%5D=Reflect.apply.call%60%24%7Balert%7D%24%7Bundefined%7D%24%7B%5Bdocument.domain%5D%7D%60µ&µheadline%5Bunit%5D=scriptµ&text=%3Cp%3Etest%3C%2Fp%3E&addImage=&customTpl=&protected=&guests=&cssID%5B%5D=&cssID%5B%5D=&invisible=&start=&stop=&save=

```

The payload is triggered in the fronted but also in the backend.

### Fix

It is recommended to classify any input on the website as potentially dangerous.

All output generated dynamically using user-controlled data should be coded according to the output context.

In addition, all input should be validated or filtered on the server side. Where possible, a list of allowed characters should also be used to validate input values. The narrower such a filter can be, the more effective its protection.

Allowlists are particularly recommended if input values have a precisely defined format or if a list of allowed input values exists.

### References

* [https://www.owasp.org/index.php/Cross-site\_Scripting\_(XSS)](https://www.owasp.org/index.php/Cross-site_Scripting_%28XSS%29)
* <https://contao.org/de/sicherheitshinweise/cross-site-scripting-in-widgets-mit-einheiten>
* <https://github.com/contao/contao/security/advisories/GHSA-4gpr-p634-922x>

### Timeline

* **2023-06-29**: First contact request via security@contao.org.
* **2023-06-30**: Response by Contao's Security Team with a preliminary patch for and a request for retesting.
* **2023-07-03**: A review of the patch shows that the issue is mitigated.
* **2023-07-17**: Contao informs that the patch is scheduled to release of the 25th of July.
* **2023-07-25**: Patch is released, usd analysts Fabian Brenner and Christian Pöschl are credited for their research.
* **2023-10-20**: Advisory released by usd AG.

### Credits

This security vulnerability was identified by Fabian Brenner and Christian Pöschl of usd AG.

### About usd Security Advisories

![](https://herolab.usd.de/wp-content/uploads/sites/9/2021/07/icon-hero.png "icon-hero")

In order to protect businesses against hackers and criminals, we always have to keep our skills and knowledge up to date. Thus, security research is just as important for our work as is building up a security community to promote the exchange of knowledge. After all, more security can only be achieved if many individuals take on the task.

Our [CST Academy](https://www.usd.de/en/cst-academy/) and our [usd HeroLab](https://herolab.usd.de/en/) are essential parts of our security mission. We share the knowledge we gain in our practical work and our research through training courses and publications. In this context, the [usd HeroLab](https://herolab.usd.de/en/) publishes a series of papers on new vulnerabilities and current security issues.

Always for the sake of our mission: „more security.“

[to usd AG](https://www.usd.de/)

In accordance with usd AG’s [Responsible Disclosure Policy](/en/responsible-disclosure/), all vendors have been notified of the existence of these vulnerabilities.

##

### Disclaimer

The information provided in this security advisory is provided „as is“ and without warranty of any kind. Details of this security advisory may be updated in order to provide as accurate information as possible.

#### usd HeroLab

[Kontakt](https://www.usd.de/kontakt/)
[Impressum](https://www.usd.de/impressum/)
[Datenschutz](https://www.usd.de/datenschutz/)
[AGB](https://www.usd.de/allgemeine-geschaeftsbedingungen-beratung/)

© 2023 usd AG

#### LabNews

## [From Unicode to Exploit: The Security Risks of Overlong UTF-8 Encodings](https://herolab.usd.de/the-security-risks-of-overlong-utf-8-encodings/)

Sep. 6, 2024

Written by Dominique Dittert, Senior Security Consultant, usd HeroLab In the dynamic field of cybersecurity, it is often the obscure and long-forgotten vulnerabilities that pose a hidden threat to otherwise hardened systems. One such vulnerability lies in invalid...

## [Security Advisories zu hugocms und Gitea](https://herolab.usd.de/security-advisories-zu-hugocms-und-gitea/)

Juli 25, 2024

Die Pentest Professionals des usd HeroLabs haben während der Durchführung ihrer Pentests hugocms und Gitea untersucht. Dabei wurden mehrere Schwachstellen auf den verschiedenen Anwendungen identifiziert. Die Schwachstelle wurde dem Hersteller im Rahmen der Responsible...

## [Security Advisory zu AXIS Webcam](https://herolab.usd.de/security-advisory-zu-axis-webcam/)

Juli 1, 2024

Die Pentest Professionals des usd HeroLabs haben während der Durchführung ihrer Pentests die AXIS Webcam (P1364) untersucht. Unsere Professionals entdeckten eine Sicherheitslücke (Cross-Site Request Forgery) im Adminpanel der AXIS P1364 Webcam. Das Ausnutzen dieser...

#### Folgen Sie uns

[![](https://herolab.usd.de/wp-content/uploads/sites/9/2023/10/usd-social-media-github.svg)](https://github.com/usdAG/)    [![](https://herolab.usd.de/wp-content/uploads/sites/9/2023/10/usd-social-media-reddit.svg)](https://www.reddit.com/user/usdAG/?rdt=60932)    [![](https://www.usd.de/wp-content/uploads/usd-social-media-youtube.svg)](https://www.youtube.com/c/usdAG)    [![](https://www.usd.de/wp-content/uploads/usd-social-media-mastodon.svg)](https://infosec.exchange/%40usdAG)

[![](https://www.usd.de/wp-content/uploads/usd-social-media-x.svg)](https://twitter.com/usdAG)[![](https://www.usd.de/wp-content/uploads/usd-social-media-meetup.svg)](https://www.meetup.com/de-DE/Cyber-Security-Transformation-Academy/?_locale=de-DE)    [![](https://www.usd.de/wp-content/uploads/usd-social-media-instagram.svg)](https://www.instagram.com/usdhero/)    [![](https://www.usd.de/wp-content/uploads/usd-social-media-linkedin.svg)](https://www.linkedin.com/company/usdag/?originalSubdomain=de)

[Meldung einer Schwachstelle oder eines Bugs](https://www.usd.de/meldung-bug-oder-schwachstelle/)

[Code of Ethics](/code-of-ethics/)



=== Content from github.com_9fd55fee_20250111_042344.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fcontao%2Fcontao%2Fcommit%2F5c9aff32cfc1f7dc452a045862ac2f86a6b9b4b4)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fcontao%2Fcontao%2Fcommit%2F5c9aff32cfc1f7dc452a045862ac2f86a6b9b4b4)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=contao%2Fcontao)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[contao](/contao)
/
**[contao](/contao/contao)**
Public

* [Notifications](/login?return_to=%2Fcontao%2Fcontao) You must be signed in to change notification settings
* [Fork
  160](/login?return_to=%2Fcontao%2Fcontao)
* [Star
   359](/login?return_to=%2Fcontao%2Fcontao)

* [Code](/contao/contao)
* [Issues
  317](/contao/contao/issues)
* [Pull requests
  91](/contao/contao/pulls)
* [Actions](/contao/contao/actions)
* [Security](/contao/contao/security)
* [Insights](/contao/contao/pulse)

Additional navigation options

* [Code](/contao/contao)
* [Issues](/contao/contao/issues)
* [Pull requests](/contao/contao/pulls)
* [Actions](/contao/contao/actions)
* [Security](/contao/contao/security)
* [Insights](/contao/contao/pulse)

## Commit

[Permalink](/contao/contao/commit/5c9aff32cfc1f7dc452a045862ac2f86a6b9b4b4)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Merge pull request from [GHSA-4gpr-p634-922x](https://github.com/advisories/GHSA-4gpr-p634-922x "GHSA-4gpr-p634-922x")

[Browse files](/contao/contao/tree/5c9aff32cfc1f7dc452a045862ac2f86a6b9b4b4)
Browse the repository at this point in the history

* Loading branch information

[![@ausi](https://avatars.githubusercontent.com/u/367169?s=40&v=4)](/ausi)

[ausi](/contao/contao/commits?author=ausi "View all commits by ausi")
authored
Jul 25, 2023

1 parent
[0f0bea8](/contao/contao/commit/0f0bea8048d667cc0906a9da1e88e8d5af0c2e92)

commit 5c9aff3

 Show file tree

 Hide file tree

Showing
**3 changed files**
with
**35 additions**
and
**35 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* core-bundle/src/Resources/contao/widgets

  + core-bundle/src/Resources/contao/widgets/InputUnit.php
    [InputUnit.php](#diff-6d3aa8bba2a7c1f5982cb2deaecabd2258f742f2bb81bcce9a37e40165cc06b1)
  + core-bundle/src/Resources/contao/widgets/TimePeriod.php
    [TimePeriod.php](#diff-68772fccfec5a8db65d3c6a393179dffecfc413c72d0a2a578be0b0943b07075)
  + core-bundle/src/Resources/contao/widgets/TrblField.php
    [TrblField.php](#diff-38ade468dd03219ee6f8c429edecba87f0905b7185ed05babbce547df86ebc1a)

## There are no files selected for viewing

22 changes: 11 additions & 11 deletions

22
[core-bundle/src/Resources/contao/widgets/InputUnit.php](#diff-6d3aa8bba2a7c1f5982cb2deaecabd2258f742f2bb81bcce9a37e40165cc06b1 "core-bundle/src/Resources/contao/widgets/InputUnit.php")

Show comments

[View file](/contao/contao/blob/5c9aff32cfc1f7dc452a045862ac2f86a6b9b4b4/core-bundle/src/Resources/contao/widgets/InputUnit.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -34,12 +34,6 @@ class InputUnit extends Widget |
|  |  | \*/ |
|  |  | protected $strTemplate = 'be\_widget'; |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Units |
|  |  | \* @var array |
|  |  | \*/ |
|  |  | protected $arrUnits = array(); |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Add specific attributes |
|  |  | \* |
| Expand Down  Expand Up | | @@ -74,7 +68,7 @@ public function \_\_set($strKey, $varValue) |
|  |  | break; |
|  |  |  |
|  |  | case 'options': |
|  |  | $this->arrUnits = StringUtil::deserialize($varValue); |
|  |  | $this->arrOptions = StringUtil::deserialize($varValue); |
|  |  | break; |
|  |  |  |
|  |  | default: |
| Expand All | | @@ -84,8 +78,6 @@ public function \_\_set($strKey, $varValue) |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Do not validate unit fields |
|  |  | \* |
|  |  | \* @param mixed $varInput |
|  |  | \* |
|  |  | \* @return mixed |
| Expand All | | @@ -94,7 +86,15 @@ protected function validator($varInput) |
|  |  | { |
|  |  | foreach ($varInput as $k=>$v) |
|  |  | { |
|  |  | if ($k != 'unit') |
|  |  | if ($k == 'unit') |
|  |  | { |
|  |  | if (!$this->isValidOption($v)) |
|  |  | { |
|  |  | $varInput[$k] = ''; |
|  |  | $this->addError($GLOBALS['TL\_LANG']['ERR']['invalid']); |
|  |  | } |
|  |  | } |
|  |  | else |
|  |  | { |
|  |  | $varInput[$k] = parent::validator($v); |
|  |  | } |
| Expand Down  Expand Up | | @@ -134,7 +134,7 @@ public function generate() |
|  |  | { |
|  |  | $arrUnits = array(); |
|  |  |  |
|  |  | foreach ($this->arrUnits as $arrUnit) |
|  |  | foreach ($this->arrOptions as $arrUnit) |
|  |  | { |
|  |  | $arrUnits[] = sprintf( |
|  |  | '<option value="%s"%s>%s</option>', |
| Expand Down | |  |

26 changes: 13 additions & 13 deletions

26
[core-bundle/src/Resources/contao/widgets/TimePeriod.php](#diff-68772fccfec5a8db65d3c6a393179dffecfc413c72d0a2a578be0b0943b07075 "core-bundle/src/Resources/contao/widgets/TimePeriod.php")

Show comments

[View file](/contao/contao/blob/5c9aff32cfc1f7dc452a045862ac2f86a6b9b4b4/core-bundle/src/Resources/contao/widgets/TimePeriod.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -33,12 +33,6 @@ class TimePeriod extends Widget |
|  |  | \*/ |
|  |  | protected $strTemplate = 'be\_widget'; |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Units |
|  |  | \* @var array |
|  |  | \*/ |
|  |  | protected $arrUnits = array(); |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Add specific attributes |
|  |  | \* |
| Expand Down  Expand Up | | @@ -69,7 +63,7 @@ public function \_\_set($strKey, $varValue) |
|  |  | break; |
|  |  |  |
|  |  | case 'options': |
|  |  | $this->arrUnits = StringUtil::deserialize($varValue); |
|  |  | $this->arrOptions = StringUtil::deserialize($varValue); |
|  |  | break; |
|  |  |  |
|  |  | default: |
| Expand All | | @@ -79,8 +73,6 @@ public function \_\_set($strKey, $varValue) |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Do not validate unit fields |
|  |  | \* |
|  |  | \* @param mixed $varInput |
|  |  | \* |
|  |  | \* @return mixed |
| Expand All | | @@ -89,7 +81,15 @@ protected function validator($varInput) |
|  |  | { |
|  |  | foreach ($varInput as $k=>$v) |
|  |  | { |
|  |  | if ($k != 'unit') |
|  |  | if ($k == 'unit') |
|  |  | { |
|  |  | if (!$this->isValidOption($v)) |
|  |  | { |
|  |  | $varInput[$k] = ''; |
|  |  | $this->addError($GLOBALS['TL\_LANG']['ERR']['invalid']); |
|  |  | } |
|  |  | } |
|  |  | else |
|  |  | { |
|  |  | $varInput[$k] = parent::validator($v); |
|  |  | } |
| Expand Down  Expand Up | | @@ -130,12 +130,12 @@ public function generate() |
|  |  | $arrUnits = array(); |
|  |  |  |
|  |  | // Add an empty option if there are none (see #5067) |
|  |  | if (empty($this->arrUnits)) |
|  |  | if (empty($this->arrOptions)) |
|  |  | { |
|  |  | $this->arrUnits = array(array('value'=>'', 'label'=>'-')); |
|  |  | $this->arrOptions = array(array('value'=>'', 'label'=>'-')); |
|  |  | } |
|  |  |  |
|  |  | foreach ($this->arrUnits as $arrUnit) |
|  |  | foreach ($this->arrOptions as $arrUnit) |
|  |  | { |
|  |  | $arrUnits[] = sprintf( |
|  |  | '<option value="%s"%s>%s</option>', |
| Expand Down | |  |

22 changes: 11 additions & 11 deletions

22
[core-bundle/src/Resources/contao/widgets/TrblField.php](#diff-38ade468dd03219ee6f8c429edecba87f0905b7185ed05babbce547df86ebc1a "core-bundle/src/Resources/contao/widgets/TrblField.php")

Show comments

[View file](/contao/contao/blob/5c9aff32cfc1f7dc452a045862ac2f86a6b9b4b4/core-bundle/src/Resources/contao/widgets/TrblField.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -32,12 +32,6 @@ class TrblField extends Widget |
|  |  | \*/ |
|  |  | protected $strTemplate = 'be\_widget'; |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Units |
|  |  | \* @var array |
|  |  | \*/ |
|  |  | protected $arrUnits = array(); |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Add specific attributes |
|  |  | \* |
| Expand All | | @@ -56,7 +50,7 @@ public function \_\_set($strKey, $varValue) |
|  |  | break; |
|  |  |  |
|  |  | case 'options': |
|  |  | $this->arrUnits = StringUtil::deserialize($varValue); |
|  |  | $this->arrOptions = StringUtil::deserialize($varValue); |
|  |  | break; |
|  |  |  |
|  |  | default: |
| Expand All | | @@ -66,8 +60,6 @@ public function \_\_set($strKey, $varValue) |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Do not validate unit fields |
|  |  | \* |
|  |  | \* @param mixed $varInput |
|  |  | \* |
|  |  | \* @return mixed |
| Expand All | | @@ -76,7 +68,15 @@ protected function validator($varInput) |
|  |  | { |
|  |  | foreach ($varInput as $k=>$v) |
|  |  | { |
|  |  | if ($k != 'unit') |
|  |  | if ($k == 'unit') |
|  |  | { |
|  |  | if (!$this->isValidOption($v)) |
|  |  | { |
|  |  | $varInput[$k] = ''; |
|  |  | $this->addError($GLOBALS['TL\_LANG']['ERR']['invalid']); |
|  |  | } |
|  |  | } |
|  |  | else |
|  |  | { |
|  |  | $varInput[$k] = parent::validator($v); |
|  |  | } |
| Expand Down  Expand Up | | @@ -116,7 +116,7 @@ public function generate() |
|  |  | { |
|  |  | $arrUnits = array(); |
|  |  |  |
|  |  | foreach ($this->arrUnits as $arrUnit) |
|  |  | foreach ($this->arrOptions as $arrUnit) |
|  |  | { |
|  |  | $arrUnits[] = sprintf( |
|  |  | '<option value="%s"%s>%s</option>', |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `5c9aff3`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fcontao%2Fcontao%2Fcommit%2F5c9aff32cfc1f7dc452a045862ac2f86a6b9b4b4) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_34ad2a54_20250111_042345.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fcontao%2Fcontao%2Fcommit%2Fccb64c777eb0f9c0e6490c9135d80e915d37cd32)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fcontao%2Fcontao%2Fcommit%2Fccb64c777eb0f9c0e6490c9135d80e915d37cd32)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=contao%2Fcontao)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[contao](/contao)
/
**[contao](/contao/contao)**
Public

* [Notifications](/login?return_to=%2Fcontao%2Fcontao) You must be signed in to change notification settings
* [Fork
  160](/login?return_to=%2Fcontao%2Fcontao)
* [Star
   359](/login?return_to=%2Fcontao%2Fcontao)

* [Code](/contao/contao)
* [Issues
  317](/contao/contao/issues)
* [Pull requests
  91](/contao/contao/pulls)
* [Actions](/contao/contao/actions)
* [Security](/contao/contao/security)
* [Insights](/contao/contao/pulse)

Additional navigation options

* [Code](/contao/contao)
* [Issues](/contao/contao/issues)
* [Pull requests](/contao/contao/pulls)
* [Actions](/contao/contao/actions)
* [Security](/contao/contao/security)
* [Insights](/contao/contao/pulse)

## Commit

[Permalink](/contao/contao/commit/ccb64c777eb0f9c0e6490c9135d80e915d37cd32)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Merge pull request from [GHSA-4gpr-p634-922x](https://github.com/advisories/GHSA-4gpr-p634-922x "GHSA-4gpr-p634-922x")

[Browse files](/contao/contao/tree/ccb64c777eb0f9c0e6490c9135d80e915d37cd32)
Browse the repository at this point in the history

* Loading branch information

[![@ausi](https://avatars.githubusercontent.com/u/367169?s=40&v=4)](/ausi)

[ausi](/contao/contao/commits?author=ausi "View all commits by ausi")
authored
Jul 25, 2023

1 parent
[c4810a7](/contao/contao/commit/c4810a73e1a0186625c25ac2d49b980b570c85dd)

commit ccb64c7

 Show file tree

 Hide file tree

Showing
**3 changed files**
with
**35 additions**
and
**35 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* core-bundle/src/Resources/contao/widgets

  + core-bundle/src/Resources/contao/widgets/InputUnit.php
    [InputUnit.php](#diff-6d3aa8bba2a7c1f5982cb2deaecabd2258f742f2bb81bcce9a37e40165cc06b1)
  + core-bundle/src/Resources/contao/widgets/TimePeriod.php
    [TimePeriod.php](#diff-68772fccfec5a8db65d3c6a393179dffecfc413c72d0a2a578be0b0943b07075)
  + core-bundle/src/Resources/contao/widgets/TrblField.php
    [TrblField.php](#diff-38ade468dd03219ee6f8c429edecba87f0905b7185ed05babbce547df86ebc1a)

## There are no files selected for viewing

22 changes: 11 additions & 11 deletions

22
[core-bundle/src/Resources/contao/widgets/InputUnit.php](#diff-6d3aa8bba2a7c1f5982cb2deaecabd2258f742f2bb81bcce9a37e40165cc06b1 "core-bundle/src/Resources/contao/widgets/InputUnit.php")

Show comments

[View file](/contao/contao/blob/ccb64c777eb0f9c0e6490c9135d80e915d37cd32/core-bundle/src/Resources/contao/widgets/InputUnit.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -32,12 +32,6 @@ class InputUnit extends Widget |
|  |  | \*/ |
|  |  | protected $strTemplate = 'be\_widget'; |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Units |
|  |  | \* @var array |
|  |  | \*/ |
|  |  | protected $arrUnits = array(); |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Add specific attributes |
|  |  | \* |
| Expand Down  Expand Up | | @@ -72,7 +66,7 @@ public function \_\_set($strKey, $varValue) |
|  |  | break; |
|  |  |  |
|  |  | case 'options': |
|  |  | $this->arrUnits = StringUtil::deserialize($varValue); |
|  |  | $this->arrOptions = StringUtil::deserialize($varValue); |
|  |  | break; |
|  |  |  |
|  |  | default: |
| Expand All | | @@ -82,8 +76,6 @@ public function \_\_set($strKey, $varValue) |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Do not validate unit fields |
|  |  | \* |
|  |  | \* @param mixed $varInput |
|  |  | \* |
|  |  | \* @return mixed |
| Expand All | | @@ -92,7 +84,15 @@ protected function validator($varInput) |
|  |  | { |
|  |  | foreach ($varInput as $k=>$v) |
|  |  | { |
|  |  | if ($k != 'unit') |
|  |  | if ($k == 'unit') |
|  |  | { |
|  |  | if (!$this->isValidOption($v)) |
|  |  | { |
|  |  | $varInput[$k] = ''; |
|  |  | $this->addError($GLOBALS['TL\_LANG']['ERR']['invalid']); |
|  |  | } |
|  |  | } |
|  |  | else |
|  |  | { |
|  |  | $varInput[$k] = parent::validator($v); |
|  |  | } |
| Expand Down  Expand Up | | @@ -132,7 +132,7 @@ public function generate() |
|  |  | { |
|  |  | $arrUnits = array(); |
|  |  |  |
|  |  | foreach ($this->arrUnits as $arrUnit) |
|  |  | foreach ($this->arrOptions as $arrUnit) |
|  |  | { |
|  |  | $arrUnits[] = sprintf( |
|  |  | '<option value="%s"%s>%s</option>', |
| Expand Down | |  |

26 changes: 13 additions & 13 deletions

26
[core-bundle/src/Resources/contao/widgets/TimePeriod.php](#diff-68772fccfec5a8db65d3c6a393179dffecfc413c72d0a2a578be0b0943b07075 "core-bundle/src/Resources/contao/widgets/TimePeriod.php")

Show comments

[View file](/contao/contao/blob/ccb64c777eb0f9c0e6490c9135d80e915d37cd32/core-bundle/src/Resources/contao/widgets/TimePeriod.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -31,12 +31,6 @@ class TimePeriod extends Widget |
|  |  | \*/ |
|  |  | protected $strTemplate = 'be\_widget'; |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Units |
|  |  | \* @var array |
|  |  | \*/ |
|  |  | protected $arrUnits = array(); |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Add specific attributes |
|  |  | \* |
| Expand Down  Expand Up | | @@ -67,7 +61,7 @@ public function \_\_set($strKey, $varValue) |
|  |  | break; |
|  |  |  |
|  |  | case 'options': |
|  |  | $this->arrUnits = StringUtil::deserialize($varValue); |
|  |  | $this->arrOptions = StringUtil::deserialize($varValue); |
|  |  | break; |
|  |  |  |
|  |  | default: |
| Expand All | | @@ -77,8 +71,6 @@ public function \_\_set($strKey, $varValue) |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Do not validate unit fields |
|  |  | \* |
|  |  | \* @param mixed $varInput |
|  |  | \* |
|  |  | \* @return mixed |
| Expand All | | @@ -87,7 +79,15 @@ protected function validator($varInput) |
|  |  | { |
|  |  | foreach ($varInput as $k=>$v) |
|  |  | { |
|  |  | if ($k != 'unit') |
|  |  | if ($k == 'unit') |
|  |  | { |
|  |  | if (!$this->isValidOption($v)) |
|  |  | { |
|  |  | $varInput[$k] = ''; |
|  |  | $this->addError($GLOBALS['TL\_LANG']['ERR']['invalid']); |
|  |  | } |
|  |  | } |
|  |  | else |
|  |  | { |
|  |  | $varInput[$k] = parent::validator($v); |
|  |  | } |
| Expand Down  Expand Up | | @@ -128,12 +128,12 @@ public function generate() |
|  |  | $arrUnits = array(); |
|  |  |  |
|  |  | // Add an empty option if there are none (see #5067) |
|  |  | if (empty($this->arrUnits)) |
|  |  | if (empty($this->arrOptions)) |
|  |  | { |
|  |  | $this->arrUnits = array(array('value'=>'', 'label'=>'-')); |
|  |  | $this->arrOptions = array(array('value'=>'', 'label'=>'-')); |
|  |  | } |
|  |  |  |
|  |  | foreach ($this->arrUnits as $arrUnit) |
|  |  | foreach ($this->arrOptions as $arrUnit) |
|  |  | { |
|  |  | $arrUnits[] = sprintf( |
|  |  | '<option value="%s"%s>%s</option>', |
| Expand Down | |  |

22 changes: 11 additions & 11 deletions

22
[core-bundle/src/Resources/contao/widgets/TrblField.php](#diff-38ade468dd03219ee6f8c429edecba87f0905b7185ed05babbce547df86ebc1a "core-bundle/src/Resources/contao/widgets/TrblField.php")

Show comments

[View file](/contao/contao/blob/ccb64c777eb0f9c0e6490c9135d80e915d37cd32/core-bundle/src/Resources/contao/widgets/TrblField.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -30,12 +30,6 @@ class TrblField extends Widget |
|  |  | \*/ |
|  |  | protected $strTemplate = 'be\_widget'; |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Units |
|  |  | \* @var array |
|  |  | \*/ |
|  |  | protected $arrUnits = array(); |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Add specific attributes |
|  |  | \* |
| Expand All | | @@ -54,7 +48,7 @@ public function \_\_set($strKey, $varValue) |
|  |  | break; |
|  |  |  |
|  |  | case 'options': |
|  |  | $this->arrUnits = StringUtil::deserialize($varValue); |
|  |  | $this->arrOptions = StringUtil::deserialize($varValue); |
|  |  | break; |
|  |  |  |
|  |  | default: |
| Expand All | | @@ -64,8 +58,6 @@ public function \_\_set($strKey, $varValue) |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Do not validate unit fields |
|  |  | \* |
|  |  | \* @param mixed $varInput |
|  |  | \* |
|  |  | \* @return mixed |
| Expand All | | @@ -74,7 +66,15 @@ protected function validator($varInput) |
|  |  | { |
|  |  | foreach ($varInput as $k=>$v) |
|  |  | { |
|  |  | if ($k != 'unit') |
|  |  | if ($k == 'unit') |
|  |  | { |
|  |  | if (!$this->isValidOption($v)) |
|  |  | { |
|  |  | $varInput[$k] = ''; |
|  |  | $this->addError($GLOBALS['TL\_LANG']['ERR']['invalid']); |
|  |  | } |
|  |  | } |
|  |  | else |
|  |  | { |
|  |  | $varInput[$k] = parent::validator($v); |
|  |  | } |
| Expand Down  Expand Up | | @@ -114,7 +114,7 @@ public function generate() |
|  |  | { |
|  |  | $arrUnits = array(); |
|  |  |  |
|  |  | foreach ($this->arrUnits as $arrUnit) |
|  |  | foreach ($this->arrOptions as $arrUnit) |
|  |  | { |
|  |  | $arrUnits[] = sprintf( |
|  |  | '<option value="%s"%s>%s</option>', |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `ccb64c7`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fcontao%2Fcontao%2Fcommit%2Fccb64c777eb0f9c0e6490c9135d80e915d37cd32) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_8dc7246e_20250111_042346.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fcontao%2Fcontao%2Fsecurity%2Fadvisories%2FGHSA-4gpr-p634-922x)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fcontao%2Fcontao%2Fsecurity%2Fadvisories%2FGHSA-4gpr-p634-922x)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=contao%2Fcontao)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[contao](/contao)
/
**[contao](/contao/contao)**
Public

* [Notifications](/login?return_to=%2Fcontao%2Fcontao) You must be signed in to change notification settings
* [Fork
  160](/login?return_to=%2Fcontao%2Fcontao)
* [Star
   359](/login?return_to=%2Fcontao%2Fcontao)

* [Code](/contao/contao)
* [Issues
  317](/contao/contao/issues)
* [Pull requests
  91](/contao/contao/pulls)
* [Actions](/contao/contao/actions)
* [Security](/contao/contao/security)
* [Insights](/contao/contao/pulse)

Additional navigation options

* [Code](/contao/contao)
* [Issues](/contao/contao/issues)
* [Pull requests](/contao/contao/pulls)
* [Actions](/contao/contao/actions)
* [Security](/contao/contao/security)
* [Insights](/contao/contao/pulse)

# Cross site scripting in widgets with units

Moderate

[leofeyer](/leofeyer)
published
GHSA-4gpr-p634-922x
Jul 25, 2023

## Package

composer

contao/core-bundle
([Composer](/advisories?query=ecosystem%3Acomposer))

## Affected versions

>=4.0.0

## Patched versions

4.9.42, 4.13.28, 5.1.10

## Description

### Impact

Authenticated users can inject malicious code in widgets with units, which is then executed both in the element preview (back end) and on the website (front end).

### Patches

Update to Contao 4.9.42, 4.13.28 or 5.1.10.

### Workarounds

Disable login for all untrusted back end users.

### References

<https://contao.org/en/security-advisories/cross-site-scripting-in-widgets-with-units>

### For more information

If you have any questions or comments about this advisory, open an issue in [contao/contao](https://github.com/contao/contao/issues/new/choose).

### Credits

Thanks to Christian Pöschl and Fabian Brenner from usd AG for reporting this vulnerability.

### Severity

Moderate

4.6

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Network

Attack complexity
Low

Privileges required
Low

User interaction
Required

Scope
Unchanged

Confidentiality
Low

Integrity
Low

Availability
None

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:L/I:L/A:N

### CVE ID

CVE-2023-36806

### Weaknesses

[CWE-79](/advisories?query=cwe%3A79)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


