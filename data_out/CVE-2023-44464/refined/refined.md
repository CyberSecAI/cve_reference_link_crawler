The provided content describes a security vulnerability in pretix, identified as CVE-2023-44464.

**Root Cause:**
The vulnerability stems from insecure validation of image files uploaded to pretix. The system only checked if the file name had an allowed extension (e.g., ".png") and if the file contained valid image data, but it did not verify if the file data actually matched the claimed format. This allowed an attacker to upload an EPS file renamed to a valid image extension.

**Weaknesses/Vulnerabilities:**
- Insecure file validation: The system lacked proper validation of image file content, relying solely on filename extensions and basic image data checks.
- Usage of vulnerable library (indirect): The vulnerability is indirectly caused by the usage of the Pillow library, which in turn uses Ghostscript for parsing EPS files. Ghostscript is known to have vulnerabilities.
-  The lack of format checking allows the execution of Ghostscript on malicious EPS files, when a different image type was expected based on extension

**Impact of Exploitation:**
- Remote Code Execution: By uploading a specially crafted EPS file, an attacker could trigger a vulnerability in Ghostscript, leading to arbitrary code execution on the server.
- The vulnerability could be exploited by any user with upload privileges, which included almost all backend users.
- The ability to upload files through the "Questions" feature also allowed for customer initiated exploitation

**Attack Vectors:**
- File Upload: The attack vector is through uploading image files to the pretix system. This can occur during backend operations, as well as through the "Questions" feature of an event.
- File type renaming: The attacker can rename malicious EPS files to bypass file extension restrictions

**Required Attacker Capabilities/Position:**
- Ability to upload files: The attacker needs the ability to upload files through the pretix interface, which can be obtained via a backend user or through a configured question for an event.
- Knowledge of the vulnerability: The attacker needs to be aware of the insufficient image validation and the vulnerability in Ghostscript when handling EPS files.

The provided content also includes information about the fix:
- The vulnerability is fixed by not allowing Pillow to parse EPS files.
- This is done by removing "EPS" from the list of allowed image formats by Pillow
- The fix is included in pretix versions 2023.7.3, 2023.6.3, and 4.20.4.