```
{
  "vulnerability": {
    "root_cause": "A data race exists in the `__nft_flowtable_type_get()` function when iterating over the `nf_tables_flowtables` list. This occurs because `nft_unregister_flowtable_type()` can run concurrently within `nf_flow_inet_module_exit()`, while `__nft_flowtable_type_get()` is also running in `nf_tables_newflowtable()` without any protection during list traversal.",
    "weaknesses": [
      "Data race in concurrent access to shared data structure (`nf_tables_flowtables` list)."
    ],
    "impact": "The data race can lead to unpredictable behavior, potentially including kernel crashes or other forms of denial of service.",
    "attack_vectors": "Concurrent execution of `nft_unregister_flowtable_type()` and `__nft_flowtable_type_get()` via the netfilter framework and module loading/unloading.",
    "required_capabilities": "An attacker needs the ability to trigger the concurrent execution of the affected functions. This may involve manipulating network configurations or the loading and unloading of kernel modules."
  },
  "fix": {
    "description": "The fix involves using `list_for_each_entry_rcu()` to iterate over the `nf_tables_flowtables` list in `__nft_flowtable_type_get()`. Additionally, `rcu_read_lock()` is used in the caller function `nft_flowtable_type_get()` to protect the entire type query process, ensuring that the list is read consistently under an RCU lock.",
    "changes": [
      "Replaced `list_for_each_entry` with `list_for_each_entry_rcu` in `__nft_flowtable_type_get`.",
      "Added `rcu_read_lock()` before calling `__nft_flowtable_type_get` in `nft_flowtable_type_get`.",
       "Added `rcu_read_unlock()` after calling `__nft_flowtable_type_get` in `nft_flowtable_type_get`."
    ]
  },
  "cve": "CVE-2024-35898",
  "references": [
    "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=24225011d81b471acc0e1e315b7d9905459a6304",
    "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=a347bc8e6251eaee4b619da28020641eb5b0dd77",
    "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=9b5b7708ec2be21dd7ef8ca0e3abe4ae9f3b083b",
    "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=e684b1674fd1ca4361812a491242ae871d6b2859",
    "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=8b891153b2e4dc0ca9d9dab8f619d49c740813df",
    "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=dacfcbb0f015c2a0b645b986c9d9d1a99df2075b",
    "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=1be80a07c7d2343c67b45e0b8f69bb564f77c56b",
     "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=69d1fe14a680042ec913f22196b58e2c8ff1b007",
     "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=e5e3bb06457b575940d41138952d4e88e2c5561d",
      "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=940d41caa71f0d3a52df2fde5fada524a993e331",
     "https://lists.debian.org/debian-lts-announce/2024/06/msg00020.html",
      "https://lists.debian.org/debian-lts-announce/2024/06/msg00017.html"
  ]
}
```