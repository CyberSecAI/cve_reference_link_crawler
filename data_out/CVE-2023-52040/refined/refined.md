- **Root cause of vulnerability**: The `shttpd` executable's `sub_41284C` function in TOTOLINK X6000R firmware takes `qos_up_bw` and `qos_down_bw` parameters, passes them to the `Uci_Set_Str` function without sanitization, which in turn passes it to `CsteSystem` function where the command is executed directly.
- **Weaknesses/vulnerabilities present**: Command injection vulnerability due to lack of input sanitization.
- **Impact of exploitation**: Arbitrary command execution on the device.
- **Attack vectors**: HTTP POST request to the `/cgi-bin/cstecgi.cgi` endpoint, modifying the `qos_up_bw` and `qos_down_bw` parameters to inject shell commands.
- **Required attacker capabilities/position**: An attacker needs to be able to send HTTP requests to the device. The attacker needs to know the vulnerable endpoint and parameters. The attacker could be on the local network.