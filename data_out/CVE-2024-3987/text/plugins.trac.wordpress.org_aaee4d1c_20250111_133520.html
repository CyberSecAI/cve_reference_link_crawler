

[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fchangeset%2F3097563%2Fmobile-menu%2Ftrunk%2Fincludes%2Fclass-wp-mobile-menu-core.php)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Change](/changeset/3038752/mobile-menu/trunk/includes/class-wp-mobile-menu-core.php "Changeset 3038752 for mobile-menu/trunk/includes/class-wp-mobile-menu-core.php")
* [Next Change](/changeset/3108344/mobile-menu/trunk/includes/class-wp-mobile-menu-core.php "Changeset 3108344 for mobile-menu/trunk/includes/class-wp-mobile-menu-core.php") →

---

# Changeset [3097563](/changeset/3097563 "Show full changeset") for [mobile-menu/trunk/includes/class-wp-mobile-menu-core.php](/browser/mobile-menu/trunk/includes/class-wp-mobile-menu-core.php?rev=3097563 "Show entry in browser")

View differences
inline
side by side

Show
lines around each change

Show the changes in full context

Ignore:

Blank lines

Case changes

White space changes

Timestamp:
06/04/2024 06:19:26 PM
([7 months](/timeline?from=2024-06-04T18%3A19%3A26Z&precision=second "See timeline at 06/04/2024 06:19:26 PM") ago)

Author:
takanakui
Message:

Release 2.8.4.3 version - Security Fix

File:

1 edited

* [mobile-menu/trunk/includes/class-wp-mobile-menu-core.php](/browser/mobile-menu/trunk/includes/class-wp-mobile-menu-core.php?rev=3097563 "Show entry in browser")
  (modified)
  ([78 diffs](#file0 "Show differences"))

### Legend:

Unmodified
Added
Removed

* ## [mobile-menu/trunk/includes/class-wp-mobile-menu-core.php](/changeset/3097563/mobile-menu/trunk/includes/class-wp-mobile-menu-core.php "Show the changeset 3097563 restricted to mobile-menu/trunk/includes/class-wp-mobile-menu-core.php")

  | [r3038752](/browser/mobile-menu/trunk/includes/class-wp-mobile-menu-core.php?rev=3038752#L10 "Show revision 3038752 of this file in browser") | [r3097563](/browser/mobile-menu/trunk/includes/class-wp-mobile-menu-core.php?rev=3097563#L10 "Show revision 3097563 of this file in browser") |  |
  | --- | --- | --- |
  | 10 | 10 | \* @since 2.0.0 |
  | 11 | 11 | \*/ |
  | 12 |  | class WP\_Mobile\_Menu\_Core |
  | 13 |  | { |
  |  | 12 | class WP\_Mobile\_Menu\_Core { |
  | 14 | 13 | /\*\* |
  | 15 | 14 | \* @var object |
  | 16 | 15 | \*/ |
  | 17 |  | public  $plugin\_settings ; |
  |  | 16 | public $plugin\_settings; |
  |  | 17 |  |
  | 18 | 18 | /\*\* |
  | 19 | 19 | \* @var String |
  | 20 | 20 | \*/ |
  | 21 |  | public  $menu\_display\_type ; |
  | 22 |  | private  $close\_icon ; |
  | 23 |  | private  $mobmenu\_parent\_link ; |
  | 24 |  | private  $search\_form ; |
  | 25 |  | private  $logo\_content ; |
  | 26 |  | private  $mobmenu\_depth ; |
  |  | 21 | public $menu\_display\_type; |
  |  | 22 |  |
  |  | 23 | private $close\_icon; |
  |  | 24 |  |
  |  | 25 | private $mobmenu\_parent\_link; |
  |  | 26 |  |
  |  | 27 | private $search\_form; |
  |  | 28 |  |
  |  | 29 | private $logo\_content; |
  |  | 30 |  |
  |  | 31 | private $mobmenu\_depth; |
  |  | 32 |  |
  | 27 | 33 | /\*\* |
  | 28 | 34 | \* Add Body Class |
  | […](/browser/mobile-menu/trunk/includes/class-wp-mobile-menu-core.php?rev=3038752#L30) | […](/browser/mobile-menu/trunk/includes/class-wp-mobile-menu-core.php?rev=3097563#L36) |  |
  | 30 | 36 | \* @since 2.8.1.3 |
  | 31 | 37 | \*/ |
  | 32 |  | private function get\_menu\_display\_type( $display\_type ) |
  | 33 |  | { |
  |  | 38 | private function get\_menu\_display\_type( $display\_type ) { |
  | 34 | 39 | $menu\_display\_type = ''; |
  | 35 | 40 | // Add the class of the animation display type. |
  | […](/browser/mobile-menu/trunk/includes/class-wp-mobile-menu-core.php?rev=3038752#L50) | […](/browser/mobile-menu/trunk/includes/class-wp-mobile-menu-core.php?rev=3097563#L55) |  |
  | 50 | 55 | return $menu\_display\_type; |
  | 51 | 56 | } |
  | 52 |  |  |
  |  | 57 |  |
  | 53 | 58 | /\*\* |
  | 54 | 59 | \* Add Body Class |
  | […](/browser/mobile-menu/trunk/includes/class-wp-mobile-menu-core.php?rev=3038752#L56) | […](/browser/mobile-menu/trunk/includes/class-wp-mobile-menu-core.php?rev=3097563#L61) |  |
  | 56 | 61 | \* @since 2.0 |
  | 57 | 62 | \*/ |
  | 58 |  | public function mobmenu\_add\_body\_class( $classes ) |
  | 59 |  | { |
  |  | 63 | public function mobmenu\_add\_body\_class( $classes ) { |
  | 60 | 64 | $plugin\_settings = MobileMenuOptions::getInstance( 'mobmenu' ); |
  | 61 | 65 | $display\_type = $plugin\_settings->getOption( 'menu\_display\_type' ); |
  | […](/browser/mobile-menu/trunk/includes/class-wp-mobile-menu-core.php?rev=3038752#L92) | […](/browser/mobile-menu/trunk/includes/class-wp-mobile-menu-core.php?rev=3097563#L96) |  |
  | 92 | 96 | return $classes; |
  | 93 | 97 | } |
  | 94 |  |  |
  |  | 98 |  |
  | 95 | 99 | /\*\* |
  | 96 | 100 | \* Frontend Scripts. |
  | 97 | 101 | \*/ |
  | 98 |  | public function frontend\_enqueue\_scripts() |
  | 99 |  | { |
  | 100 |  | global  $mm\_fs ; |
  |  | 102 | public function frontend\_enqueue\_scripts() { |
  |  | 103 | global $mm\_fs; |
  | 101 | 104 | // Enqueue the common free scripts. |
  | 102 | 105 | $this->frontend\_free\_enqueue\_scripts(); |
  | 103 | 106 | } |
  | 104 |  |  |
  |  | 107 |  |
  | 105 | 108 | /\*\* |
  | 106 | 109 | \* Frontend Free version Scripts. |
  | 107 | 110 | \*/ |
  | 108 |  | public function frontend\_free\_enqueue\_scripts() |
  | 109 |  | { |
  | 110 |  | global  $mm\_fs ; |
  |  | 111 | public function frontend\_free\_enqueue\_scripts() { |
  |  | 112 | global $mm\_fs; |
  | 111 | 113 | // Load the Free assets. |
  | 112 | 114 | wp\_register\_script( |
  | 113 | 115 | 'mobmenujs', |
  | 114 | 116 | plugins\_url( 'js/mobmenu.js', \_\_FILE\_\_ ), |
  | 115 |  | array(~~'jquery'~~ ), |
  |  | 117 | array('jquery'), |
  | 116 | 118 | WP\_MOBILE\_MENU\_VERSION |
  | 117 | 119 | ); |
  | […](/browser/mobile-menu/trunk/includes/class-wp-mobile-menu-core.php?rev=3038752#L125) | […](/browser/mobile-menu/trunk/includes/class-wp-mobile-menu-core.php?rev=3097563#L127) |  |
  | 125 | 127 | ); |
  | 126 | 128 | } |
  | 127 |  |  |
  |  | 129 |  |
  | 128 | 130 | /\*\* |
  | 129 | 131 | \* Build the icons HTML. |
  | 130 | 132 | \*/ |
  | 131 |  | public function get\_icons\_html() |
  | 132 |  | { |
  |  | 133 | public function get\_icons\_html() { |
  | 133 | 134 | $menu\_title = ''; |
  | 134 | 135 | if ( isset( $\_POST['menu\_item\_id'] ) ) { |
  | […](/browser/mobile-menu/trunk/includes/class-wp-mobile-menu-core.php?rev=3038752#L145) | […](/browser/mobile-menu/trunk/includes/class-wp-mobile-menu-core.php?rev=3097563#L146) |  |
  | 145 | 146 | } |
  | 146 | 147 | $seleted\_icon = sanitize\_text\_field( get\_post\_meta( $menu\_item\_id, '\_mobmenu\_icon', true ) ); |
  | 147 |  |  |
  | 148 |  | if ( !empty($seleted\_icon) ) { |
  |  | 148 | if ( !empty( $seleted\_icon ) ) { |
  | 149 | 149 | $selected = ' data-selected-icon="' . $seleted\_icon . '" '; |
  | 150 | 150 | } else { |
  | 151 | 151 | $selected = ''; |
  | 152 | 152 | } |
  | 153 |  |  |
  | 154 | 153 | $icons = $this->get\_icons\_list(); |
  | 155 |  |  |
  | 156 | 154 | if ( 'yes' === $full\_content ) { |
  | 157 | 155 | $output = '<div class="mobmenu-icons-overlay"></div><div class="mobmenu-icons-content" data-menu-id="' . $menu\_id . '" data-menu-item-id="' . $menu\_item\_id . '">'; |
  | […](/browser/mobile-menu/trunk/includes/class-wp-mobile-menu-core.php?rev=3038752#L168) | […](/browser/mobile-menu/trunk/includes/class-wp-mobile-menu-core.php?rev=3097563#L166) |  |
  | 168 | 166 | $output = '<div class="mobmenu-icons-holder" ' . $selected . ' data-title="' . esc\_attr( $menu\_title ) . '" - Menu Item Icon" >'; |
  | 169 | 167 | } |
  | 170 |  |  |
  | 171 |  | echo  $output ; |
  |  | 168 | echo $output; |
  | 172 | 169 | wp\_die(); |
  | 173 | 170 | } |
  | 174 |  |  |
  |  | 171 |  |
  | 175 | 172 | /\*\* |
  | 176 | 173 | \* Add the plugin page row links. |
  | 177 | 174 | \*/ |
  | 178 |  | public function add\_plugin\_row\_meta( $links, $file ) |
  | 179 |  | { |
  | 180 |  |  |
  |  | 175 | public function add\_plugin\_row\_meta( $links, $file ) { |
  | 181 | 176 | if ( 'mobile-menu-premium/mobmenu.php' == $file || 'mobile-menu-premium/mobmenu.php' == $file ) { |
  | 182 | 177 | $row\_meta = array( |
  | […](/browser/mobile-menu/trunk/includes/class-wp-mobile-menu-core.php?rev=3038752#L188) | […](/browser/mobile-menu/trunk/includes/class-wp-mobile-menu-core.php?rev=3097563#L183) |  |
  | 188 | 183 | return $links; |
  | 189 | 184 | } |
  | 190 |  |  |
  | 191 |  | } |
  | 192 |  |  |
  |  | 185 | } |
  |  | 186 |  |
  | 193 | 187 | /\*\* |
  | 194 | 188 | \* Build the WP Mobile Menu Html Markup. |
  | […](/browser/mobile-menu/trunk/includes/class-wp-mobile-menu-core.php?rev=3038752#L205) | […](/browser/mobile-menu/trunk/includes/class-wp-mobile-menu-core.php?rev=3097563#L199) |  |
  | 205 | 199 | $hamburger\_animation, |
  | 206 | 200 | $close\_icon |
  | 207 |  | ) |
  | 208 |  | { |
  |  | 201 | ) { |
  | 209 | 202 | $menu\_content = ''; |
  | 210 | 203 | //$menu\_text    = ''; |
  | […](/browser/mobile-menu/trunk/includes/class-wp-mobile-menu-core.php?rev=3038752#L212) | […](/browser/mobile-menu/trunk/includes/class-wp-mobile-menu-core.php?rev=3097563#L205) |  |
  | 212 | 205 | $menu\_text = '<span class="' . $type . '-menu-icon-text">' . \_\_( $menu\_text, 'mobile-menu' ) . '</span>'; |
  | 213 | 206 | } |
  | 214 |  |  |
  | 215 | 207 | if ( $icon\_action ) { |
  | 216 | 208 | $menu\_content .= '<a href="#" class="mobmenu-' . $type . '-bt mobmenu-trigger-action" data-panel-target="mobmenu-' . $type . '-panel" aria-label="' . \_\_( ucfirst( $type ) . ' Menu Button', 'mobile-menu' ) . '">'; |
  | 217 | 209 | } else { |
  | 218 |  |  |
  | 219 | 210 | if ( $icon\_target ) { |
  | 220 | 211 | $icon\_url\_target = '\_self'; |
  | […](/browser/mobile-menu/trunk/includes/class-wp-mobile-menu-core.php?rev=3038752#L222) | […](/browser/mobile-menu/trunk/includes/class-wp-mobile-menu-core.php?rev=3097563#L213) |  |
  | 222 | 213 | $icon\_url\_target = '\_blank'; |
  | 223 | 214 | } |
  | 224 |  |  |
  | 225 | 215 | $menu\_content .= '<a href="' . $icon\_url . '" target="' . $icon\_url\_target . '" id="mobmenu-center">'; |
  | 226 | 216 | } |
  | 227 |  |  |
  | 228 | 217 | $icon\_image = wp\_get\_attachment\_image\_src( $icon ); |
  | 229 |  |  |
  | 230 | 218 | if ( $icon\_image ) { |
  | 231 | 219 | $icon\_image = $icon\_image[0]; |
  | […](/browser/mobile-menu/trunk/includes/class-wp-mobile-menu-core.php?rev=3038752#L233) | […](/browser/mobile-menu/trunk/includes/class-wp-mobile-menu-core.php?rev=3097563#L221) |  |
  | 233 | 221 | $icon\_image = ''; |
  | 234 | 222 | } |
  | 235 |  |  |
  | 236 | 223 | $menu\_icon = $icon\_new; |
  | 237 | 224 | switch ( $menu\_icon ) { |
  | […](/browser/mobile-menu/trunk/includes/class-wp-mobile-menu-core.php?rev=3038752#L251) | […](/browser/mobile-menu/trunk/includes/class-wp-mobile-menu-core.php?rev=3097563#L238) |  |
  | 251 | 238 | return $menu\_content; |
  | 252 | 239 | } |
  | 253 |  |  |
  |  | 240 |  |
  | 254 | 241 | /\*\* |
  | 255 | 242 | \* Build the WP Mobile Menu Html Markup. |
  | 256 | 243 | \*/ |
  | 257 |  | public function load\_menu\_html\_markup() |
  | 258 |  | { |
  | 259 |  | global  $mm\_fs ; |
  | 260 |  | global  $woocommerce ; |
  |  | 244 | public function load\_menu\_html\_markup() { |
  |  | 245 | global $mm\_fs; |
  |  | 246 | global $woocommerce; |
  | 261 | 247 | $upload\_dir = wp\_upload\_dir(); |
  | 262 | 248 | $uploadsFolder = $upload\_dir['basedir'] . '/'; |
  | […](/browser/mobile-menu/trunk/includes/class-wp-mobile-menu-core.php?rev=3038752#L308) | […](/browser/mobile-menu/trunk/includes/class-wp-mobile-menu-core.php?rev=3097563#L294) |  |
  | 308 | 294 | $output .= '<div class="mob-menu-header-holder mobmenu" ' . $menu\_display\_class . $sticky\_el\_data\_detach . $autoclose\_menus\_el\_data . $mm\_open\_cart\_menu . ' data-open-icon="' . $submenu\_open\_icon\_font . '" data-close-icon="' . $submenu\_close\_icon\_font . '">'; |
  | 309 | 295 | // Left Menu Content. |
  | 310 |  |  |
  | 311 | 296 | if ( $plugin\_settings->getOption( 'enable\_left\_menu' ) && !$left\_logged\_in\_user ) { |
  | 312 | 297 | $menu\_text = $plugin\_settings->getOption( 'left\_menu\_text' ); |
  | […](/browser/mobile-menu/trunk/includes/class-wp-mobile-menu-core.php?rev=3038752#L331) | […](/browser/mobile-menu/trunk/includes/class-wp-mobile-menu-core.php?rev=3097563#L316) |  |
  | 331 | 316 | ); |
  | 332 | 317 | } |
  | 333 |  |  |
  | 334 | 318 | if ( !$plugin\_settings->getOption( 'disabled\_logo\_text' ) ) { |
  | 335 | 319 | // Format the Header Branding. |
  | […](/browser/mobile-menu/trunk/includes/class-wp-mobile-menu-core.php?rev=3038752#L337) | […](/browser/mobile-menu/trunk/includes/class-wp-mobile-menu-core.php?rev=3097563#L321) |  |
  | 337 | 321 | } |
  | 338 | 322 | // Right Menu Content. |
  | 339 |  |  |
  | 340 | 323 | if ( $plugin\_settings->getOption( 'enable\_right\_menu' ) && !$right\_logged\_in\_user ) { |
  | 341 | 324 | $menu\_text = $plugin\_settings->getOption( 'right\_menu\_text' ); |
  | […](/browser/mobile-menu/trunk/includes/class-wp-mobile-menu-core.php?rev=3038752#L360) | […](/browser/mobile-menu/trunk/includes/class-wp-mobile-menu-core.php?rev=3097563#L343) |  |
  | 360 | 343 | ); |
  | 361 | 344 | } |
  | 362 |  |  |
  | 363 | 345 | $language\_selector = ''; |
  | 364 |  | $header\_elements\_order = array(~~'left-menu', 'logo', 'right-menu'~~ ); |
  |  | 346 | $header\_elements\_order = array('left-menu', 'logo', 'right-menu'); |
  | 365 | 347 | $header\_output = ''; |
  | 366 | 348 | if ( $plugin\_settings->getOption( 'enable\_left\_menu' ) ) { |
  | 367 | 349 | $header\_output = '<div  class="mobmenul-container">'; |
  | 368 | 350 | } |
  | 369 |  | if ( !empty(~~$header\_elements\_order~~) ) { |
  |  | 351 | if ( !empty( $header\_elements\_order ) ) { |
  | 370 | 352 | foreach ( $header\_elements\_order as $element ) { |
  | 371 | 353 | switch ( $element ) { |
  | […](/browser/mobile-menu/trunk/includes/class-wp-mobile-menu-core.php?rev=3038752#L383) | […](/browser/mobile-menu/trunk/includes/class-wp-mobile-menu-core.php?rev=3097563#L365) |  |
  | 383 | 365 | break; |
  | 384 | 366 | case 'logo': |
  | 385 |  |  |
  | 386 | 367 | if ( $plugin\_settings->getOption( 'enable\_left\_menu' ) ) { |
  | 387 | 368 | $header\_output .= '</div>' . $this->logo\_content . '<div class="mobmenur-container">'; |
  | […](/browser/mobile-menu/trunk/includes/class-wp-mobile-menu-core.php?rev=3038752#L389) | […](/browser/mobile-menu/trunk/includes/class-wp-mobile-menu-core.php?rev=3097563#L370) |  |
  | 389 | 370 | $header\_output .= $this->logo\_content . '<div class="mobmenur-container">'; |
  | 390 | 371 | } |
  | 391 |  |  |
  | 392 | 372 | break; |
  | 393 | 373 | case 'search': |
  | […](/browser/mobile-menu/trunk/includes/class-wp-mobile-menu-core.php?rev=3038752#L404) | […](/browser/mobile-menu/trunk/includes/class-wp-mobile-menu-core.php?rev=3097563#L384) |  |
  | 404 | 384 | $output .= '</div>'; |
  | 405 | 385 | // Echo the Header HTML. |
  | 406 |  | echo ~~$output~~ ; |
  |  | 386 | echo $output; |
  | 407 | 387 | // Build the left menu panel. |
  | 408 | 388 | if ( $plugin\_settings->getOption( 'enable\_left\_menu' ) && !$left\_logged\_in\_user ) { |
  | 409 | 389 | $this->build\_left\_menu\_content(); |
  | 410 | 390 | } |
  | 411 |  |  |
  | 412 | 391 | if ( $plugin\_settings->getOption( 'enable\_right\_menu' ) && !$right\_logged\_in\_user ) { |
  | 413 | 392 | $this->mobmenu\_parent\_link = ''; |
  | […](/browser/mobile-menu/trunk/includes/class-wp-mobile-menu-core.php?rev=3038752#L417) | […](/browser/mobile-menu/trunk/includes/class-wp-mobile-menu-core.php?rev=3097563#L396) |  |
  | 417 | 396 | ?> |
  | 418 | 397 | <div class="mobmenu-right-alignment mobmenu-panel mobmenu-right-panel <?php |
  | 419 |  | echo ~~$this->mobmenu\_parent\_link~~ ; |
  |  | 398 | echo $this->mobmenu\_parent\_link; |
  | 420 | 399 | ?> "> |
  | 421 | 400 | <a href="#" class="mobmenu-right-bt" aria-label="<?php |
  | 422 | 401 | \_e( 'Right Menu Button', 'mobile-menu' ); |
  | 423 | 402 | ?>"><?php |
  | 424 |  | echo ~~$this->mobmenu\_close\_button( $close\_icon )~~ ; |
  |  | 403 | echo $this->mobmenu\_close\_button( $close\_icon ); |
  | 425 | 404 | ?></a> |
  | 426 | 405 | <div class="mobmenu-content"> |
  | […](/browser/mobile-menu/trunk/includes/class-wp-mobile-menu-core.php?rev=3038752#L428) | […](/browser/mobile-menu/trunk/includes/class-wp-mobile-menu-core.php?rev=3097563#L407) |  |
  | 428 | 407 | do\_action( 'mobmenu\_right\_top\_content' ); |
  | 429 | 408 | // Check if the Right Menu Top Widget has any content. |
  | 430 |  |  |
  | 431 | 409 | if ( is\_active\_sidebar( 'mobmrighttop' ) ) { |
  | 432 | 410 | ?> |
  | […](/browser/mobile-menu/trunk/includes/class-wp-mobile-menu-core.php?rev=3038752#L438) | […](/browser/mobile-menu/trunk/includes/class-wp-mobile-menu-core.php?rev=3097563#L416) |  |
  | 438 | 416 | <?php |
  | 439 | 417 | } |
  | 440 |  |  |
  | 441 |  | $right\_panel\_elements\_order = array( 'right-menu' ); |
  |  | 418 | $right\_panel\_elements\_order = array('right-menu'); |
  | 442 | 419 | $right\_menu\_panel\_content = ''; |
  | 443 |  | if ( !empty(~~$right\_panel\_elements\_order~~) ) { |
  |  | 420 | if ( !empty( $right\_panel\_elements\_order ) ) { |
  | 444 | 421 | foreach ( $right\_panel\_elements\_order as $element ) { |
  | 445 | 422 | switch ( $element ) { |
  | 446 | 423 | case 'right-menu': |
  | 447 |  |  |
  | 448 | 424 | if ( $this->plugin\_settings->getOption( 'right\_menu\_tabbed\_menus', false ) ) { |
  | 449 | 425 | $right\_menu = $this->display\_tabbed\_menu( 'right' ); |
  | […](/browser/mobile-menu/trunk/includes/class-wp-mobile-menu-core.php?rev=3038752#L451) | […](/browser/mobile-menu/trunk/includes/class-wp-mobile-menu-core.php?rev=3097563#L427) |  |
  | 451 | 427 | $right\_menu = $this->display\_menu( 'right' ); |
  | 452 | 428 | } |
  | 453 |  |  |
  | 454 | 429 | $right\_menu\_panel\_content .= $right\_menu; |
  | 455 | 430 | break; |
  | […](/browser/mobile-menu/trunk/includes/class-wp-mobile-menu-core.php?rev=3038752#L466) | […](/browser/mobile-menu/trunk/includes/class-wp-mobile-menu-core.php?rev=3097563#L441) |  |
  | 466 | 441 | } |
  | 467 | 442 | } |
  | 468 |  | echo ~~$right\_menu\_panel\_content~~ ; |
  |  | 443 | echo $right\_menu\_panel\_content; |
  | 469 | 444 | // Check if the Right Menu Bottom Widget has any content. |
  | 470 |  |  |
  | 471 | 445 | if ( is\_active\_sidebar( 'mobmrightbottom' ) ) { |
  | 472 | 446 | ?> |
  | […](/browser/mobile-menu/trunk/includes/class-wp-mobile-menu-core.php?rev=3038752#L478) | […](/browser/mobile-menu/trunk/includes/class-wp-mobile-menu-core.php?rev=3097563#L452) |  |
  | 478 | 452 | <?php |
  | 479 | 453 | } |
  | 480 |  |  |
  | 481 | 454 | ?> |
  | 482 | 455 |  |
  | […](/browser/mobile-menu/trunk/includes/class-wp-mobile-menu-core.php?rev=3038752#L485) | […](/browser/mobile-menu/trunk/includes/class-wp-mobile-menu-core.php?rev=3097563#L458) |  |
  | 485 | 458 | <?php |
  | 486 | 459 | } |
  | 487 |  |  |
  | 488 |  | } |
  | 489 |  |  |
  |  | 460 | } |
  |  | 461 |  |
  | 490 | 462 | /\*\* |
  | 491 | 463 | \* Build Menu Content |
  | 492 | 464 | \*/ |
  | 493 |  | public function build\_left\_menu\_content() |
  | 494 |  | { |
  | 495 |  | global  $mm\_fs ; |
  |  | 465 | public function build\_left\_menu\_content() { |
  |  | 466 | global $mm\_fs; |
  | 496 | 467 | // Build the left menu panel. |
  | 497 | 468 | $this->mobmenu\_parent\_link = ''; |
  | […](/browser/mobile-menu/trunk/includes/class-wp-mobile-menu-core.php?rev=3038752#L502) | […](/browser/mobile-menu/trunk/includes/class-wp-mobile-menu-core.php?rev=3097563#L473) |  |
  | 502 | 473 |  |
  | 503 | 474 | <div class="mobmenu-left-alignment mobmenu-panel mobmenu-left-panel <?php |
  | 504 |  | echo ~~$this->mobmenu\_parent\_link~~ ; |
  |  | 475 | echo $this->mobmenu\_parent\_link; |
  | 505 | 476 | ?> "> |
  | 506 | 477 | <a href="#" class="mobmenu-left-bt" aria-label="<?php |
  | 507 | 478 | \_e( 'Left Menu Button', 'mobile-menu' ); |
  | 508 | 479 | ?>"><?php |
  | 509 |  | echo ~~$this->mobmenu\_close\_button( $this->close\_icon )~~ ; |
  |  | 480 | echo $this->mobmenu\_close\_button( $this->close\_icon ); |
  | 510 | 481 | ?></a> |
  | 511 | 482 |  |
  | […](/browser/mobile-menu/trunk/includes/class-wp-mobile-menu-core.php?rev=3038752#L513) | […](/browser/mobile-menu/trunk/includes/class-wp-mobile-menu-core.php?rev=3097563#L484) |  |
  | 513 | 484 | <?php |
  | 514 | 485 | do\_action( 'mobmenu\_left\_top\_content' ); |
  | 515 |  |  |
  | 516 | 486 | if ( is\_active\_sidebar( 'mobmlefttop' ) ) { |
  | 517 | 487 | ?> |
  | […](/browser/mobile-menu/trunk/includes/class-wp-mobile-menu-core.php?rev=3038752#L523) | […](/browser/mobile-menu/trunk/includes/class-wp-mobile-menu-core.php?rev=3097563#L493) |  |
  | 523 | 493 | <?php |
  | 524 | 494 | } |
  | 525 |  |  |
  | 526 |  | $left\_panel\_elements\_order = array( 'left-menu' ); |
  |  | 495 | $left\_panel\_elements\_order = array('left-menu'); |
  | 527 | 496 | $left\_menu\_panel\_content = ''; |
  | 528 |  | if ( !empty(~~$left\_panel\_elements\_order~~) ) { |
  |  | 497 | if ( !empty( $left\_panel\_elements\_order ) ) { |
  | 529 | 498 | foreach ( $left\_panel\_elements\_order as $element ) { |
  | 530 | 499 | switch ( $element ) { |
  | 531 | 500 | case 'left-menu': |
  | 532 |  |  |
  | 533 | 501 | if ( $this->plugin\_settings->getOption( 'left\_menu\_tabbed\_menus', false ) ) { |
  | 534 | 502 | $left\_menu = $this->display\_tabbed\_menu( 'left' ); |
  | […](/browser/mobile-menu/trunk/includes/class-wp-mobile-menu-core.php?rev=3038752#L536) | […](/browser/mobile-menu/trunk/includes/class-wp-mobile-menu-core.php?rev=3097563#L504) |  |
  | 536 | 504 | $left\_menu = $this->display\_menu( 'left' ); |
  | 537 | 505 | } |
  | 538 |  |  |
  | 539 | 506 | $left\_menu\_panel\_content .= $left\_menu; |
  | 540 | 507 | break; |
  | […](/browser/mobile-menu/trunk/includes/class-wp-mobile-menu-core.php?rev=3038752#L551) | […](/browser/mobile-menu/trunk/includes/class-wp-mobile-menu-core.php?rev=3097563#L518) |  |
  | 551 | 518 | } |
  | 552 | 519 | } |
  | 553 |  | echo ~~$left\_menu\_panel\_content~~ ; |
  |  | 520 | echo $left\_menu\_panel\_content; |
  | 554 | 521 | // Check if the Left Menu Bottom Widget has any content. |
  | 555 |  |  |
  | 556 | 522 | if ( is\_active\_sidebar( 'mobmleftbottom' ) ) { |
  | 557 | 523 | ?> |
  | […](/browser/mobile-menu/trunk/includes/class-wp-mobile-menu-core.php?rev=3038752#L563) | […](/browser/mobile-menu/trunk/includes/class-wp-mobile-menu-core.php?rev=3097563#L529) |  |
  | 563 | 529 | <?php |
  | 564 | 530 | } |
  | 565 |  |  |
  | 566 | 531 | ?> |
  | 567 | 532 |  |
  | […](/browser/mobile-menu/trunk/includes/class-wp-mobile-menu-core.php?rev=3038752#L570) | […](/browser/mobile-menu/trunk/includes/class-wp-mobile-menu-core.php?rev=3097563#L535) |  |
  | 570 | 535 | <?php |
  | 571 | 536 | } |
  | 572 |  |  |
  |  | 537 |  |
  | 573 | 538 | /\*\* |
  | 574 | 539 | \* Display Left Menu. |
  | 575 | 540 | \*/ |
  | 576 |  | public function display\_menu( $menu ) |
  | 577 |  | { |
  | 578 |  | global  $mm\_fs ; |
  |  | 541 | public function display\_menu( $menu ) { |
  |  | 542 | global $mm\_fs; |
  | 579 | 543 | $plugin\_settings = MobileMenuOptions::getInstance( 'mobmenu' ); |
  | 580 | 544 | $current\_menu = $plugin\_settings->getOption( $menu . '\_menu' ); |
  | […](/browser/mobile-menu/trunk/includes/class-wp-mobile-menu-core.php?rev=3038752#L582) | […](/browser/mobile-menu/trunk/includes/class-wp-mobile-menu-core.php?rev=3097563#L546) |  |
  | 582 | 546 | $current\_menu = ''; |
  | 583 | 547 | } |
  | 584 |  |  |
  | 585 | 548 | if ( has\_nav\_menu( $menu . '-wp-mobile-menu' ) && $current\_menu === '' ) { |
  | 586 | 549 | $current\_menu = $menu . '-wp-mobile-menu'; |
  | […](/browser/mobile-menu/trunk/includes/class-wp-mobile-menu-core.php?rev=3038752#L589) | […](/browser/mobile-menu/trunk/includes/class-wp-mobile-menu-core.php?rev=3097563#L552) |  |
  | 589 | 552 | $menu\_param = 'menu'; |
  | 590 | 553 | } |
  | 591 |  |  |
  | 592 | 554 | $output = ''; |
  | 593 | 555 | // Only build the menu it there is a menu assigned to it. |
  | 594 |  |  |
  | 595 | 556 | if ( '' !== $current\_menu ) { |
  | 596 | 557 | $current\_menu = apply\_filters( 'wp\_mobile\_menu\_current\_menu', $current\_menu, $menu ); |
  | […](/browser/mobile-menu/trunk/includes/class-wp-mobile-menu-core.php?rev=3038752#L601) | […](/browser/mobile-menu/trunk/includes/class-wp-mobile-menu-core.php?rev=3097563#L562) |  |
  | 601 | 562 | 'fallback\_cb' => false, |
  | 602 | 563 | 'depth'       => $this->mobmenu\_depth, |
  | 603 |  | 'walker'      => new WP\_Mobile\_Menu\_Walker\_Nav\_Menu(~~$menu, ''~~ ), |
  |  | 564 | 'walker'      => new WP\_Mobile\_Menu\_Walker\_Nav\_Menu($menu, ''), |
  | 604 | 565 | 'echo'        => false, |
  | 605 | 566 | ) ); |
  | 606 | 567 | } else { |
  | 607 |  |  |
  | 608 | 568 | if ( current\_user\_can( 'administrator' ) ) { |
  | 609 | 569 | ?> |
  | 610 | 570 | <h4 class='no-mobile-menu'><a href='<?php |
  | 611 |  | echo ~~get\_site\_url()~~ ; |
  |  | 571 | echo get\_site\_url(); |
  | 612 | 572 | ?>/wp-admin/nav-menus.php?action=locations'><?php |
  | 613 | 573 | \_e( 'Assign a menu to the ' . $menu . ' Mobile Menu location in the Appearance-> Menus-> Manage Locations.' ); |
  | […](/browser/mobile-menu/trunk/includes/class-wp-mobile-menu-core.php?rev=3038752#L615) | […](/browser/mobile-menu/trunk/includes/class-wp-mobile-menu-core.php?rev=3097563#L575) |  |
  | 615 | 575 | <?php |
  | 616 | 576 | } |
  | 617 |  |  |
  | 618 |  | } |
  | 619 |  |  |
  |  | 577 | } |
  | 620 | 578 | return $output; |
  | 621 | 579 | } |
  | 622 |  |  |
  |  | 580 |  |
  | 623 | 581 | /\*\* |
  | 624 | 582 | \* Display Tabbed Menu. |
  | 625 | 583 | \*/ |
  | 626 |  | public function display\_tabbed\_menu( $menu ) |
  | 627 |  | { |
  | 628 |  | global  $mm\_fs ; |
  |  | 584 | public function display\_tabbed\_menu( $menu ) { |
  |  | 585 | global $mm\_fs; |
  | 629 | 586 | $tab\_title\_1 = $this->plugin\_settings->getOption( $menu . '\_tab\_title\_1' ); |
  | 630 | 587 | $tab\_title\_2 = $this->plugin\_settings->getOption( $menu . '\_tab\_title\_2' ); |
  | […](/browser/mobile-menu/trunk/includes/class-wp-mobile-menu-core.php?rev=3038752#L637) | […](/browser/mobile-menu/trunk/includes/class-wp-mobile-menu-core.php?rev=3097563#L594) |  |
  | 637 | 594 | 'fallback\_cb' => false, |
  | 638 | 595 | 'depth'       => $this->mobmenu\_depth, |
  | 639 |  | 'walker'      => new WP\_Mobile\_Menu\_Walker\_Nav\_Menu(~~$menu, ''~~ ), |
  |  | 596 | 'walker'      => new WP\_Mobile\_Menu\_Walker\_Nav\_Menu($menu, ''), |
  | 640 | 597 | 'echo'        => false, |
  | 641 | 598 | ) ); |
  | […](/browser/mobile-menu/trunk/includes/class-wp-mobile-menu-core.php?rev=3038752#L647) | […](/browser/mobile-menu/trunk/includes/class-wp-mobile-menu-core.php?rev=3097563#L604) |  |
  | 647 | 604 | 'fallback\_cb' => false, |
  | 648 | 605 | 'depth'       => $this->mobmenu\_depth, |
  | 649 |  | 'walker'      => new WP\_Mobile\_Menu\_Walker\_Nav\_Menu(~~$menu, ''~~ ), |
  |  | 606 | 'walker'      => new WP\_Mobile\_Menu\_Walker\_Nav\_Menu($menu, ''), |
  | 650 | 607 | 'echo'        => false, |
  | 651 | 608 | ) ); |
  | […](/browser/mobile-menu/trunk/includes/class-wp-mobile-menu-core.php?rev=3038752#L656) | […](/browser/mobile-menu/trunk/includes/class-wp-mobile-menu-core.php?rev=3097563#L613) |  |
  | 656 | 613 | $current\_menu = ''; |
  | 657 | 614 | } |
  | 658 |  |  |
  | 659 | 615 | if ( has\_nav\_menu( $menu . '-wp-mobile-menu' ) ) { |
  | 660 | 616 | $current\_menu = $menu . '-wp-mobile-menu'; |
  | […](/browser/mobile-menu/trunk/includes/class-wp-mobile-menu-core.php?rev=3038752#L663) | […](/browser/mobile-menu/trunk/includes/class-wp-mobile-menu-core.php?rev=3097563#L619) |  |
  | 663 | 619 | $menu\_param = 'menu'; |
  | 664 | 620 | } |
  | 665 |  |  |
  | 666 | 621 | $output = ''; |
  | 667 | 622 | // Only build the menu it there is a menu assigned to it. |
  | 668 |  |  |
  | 669 | 623 | if ( '' !== $current\_menu ) { |
  | 670 | 624 | // Display the menu. |
  | […](/browser/mobile-menu/trunk/includes/class-wp-mobile-menu-core.php?rev=3038752#L674) | […](/browser/mobile-menu/trunk/includes/class-wp-mobile-menu-core.php?rev=3097563#L628) |  |
  | 674 | 628 | 'fallback\_cb' => false, |
  | 675 | 629 | 'depth'       => $this->mobmenu\_depth, |
  | 676 |  | 'walker'      => new WP\_Mobile\_Menu\_Walker\_Nav\_Menu(~~$menu, ''~~ ), |
  |  | 630 | 'walker'      => new WP\_Mobile\_Menu\_Walker\_Nav\_Menu($menu, ''), |
  | 677 | 631 | 'echo'        => false, |
  | 678 | 632 | ) ); |
  | 679 | 633 | } else { |
  | 680 |  |  |
  | 681 | 634 | if ( current\_user\_can( 'administrator' ) ) { |
  | 682 | 635 | ?> |
  | 683 | 636 | <h4 class='no-mobile-menu'><a href='<?php |
  | 684 |  | echo ~~get\_site\_url()~~ ; |
  |  | 637 | echo get\_site\_url(); |
  | 685 | 638 | ?>/wp-admin/nav-menus.php?action=locations'><?php |
  | 686 | 639 | \_e( 'Assign a menu to the ' . $menu . ' Mobile Menu location in the Appearance-> Menus-> Manage Locations.' ); |
  | […](/browser/mobile-menu/trunk/includes/class-wp-mobile-menu-core.php?rev=3038752#L688) | […](/browser/mobile-menu/trunk/includes/class-wp-mobile-menu-core.php?rev=3097563#L641) |  |
  | 688 | 641 | <?php |
  | 689 | 642 | } |
  | 690 |  |  |
  | 691 |  | } |
  | 692 |  |  |
  |  | 643 | } |
  | 693 | 644 | return $output; |
  | 694 | 645 | } |
  | 695 |  |  |
  |  | 646 |  |
  | 696 | 647 | /\*\* |
  | 697 | 648 | \* Load the Finde elements tool. |
  | 698 | 649 | \*/ |
  | 699 |  | public function find\_elements\_mobmenu() |
  | 700 |  | { |
  | 701 |  |  |
  |  | 650 | public function find\_elements\_mobmenu() { |
  | 702 | 651 | if ( isset( $\_GET['mobmenu-action'] ) ) { |
  | 703 | 652 | $mobmenu\_action = $\_GET['mobmenu-action']; |
  | […](/browser/mobile-menu/trunk/includes/class-wp-mobile-menu-core.php?rev=3038752#L706) | […](/browser/mobile-menu/trunk/includes/class-wp-mobile-menu-core.php?rev=3097563#L655) |  |
  | 706 | 655 | } |
  | 707 | 656 | } |
  | 708 |  |  |
  | 709 |  | } |
  | 710 |  |  |
  | 711 |  |  |
  |  | 657 | } |
  |  | 658 |  |
  |  | 659 | /\*\* |
  |  | 660 | \* |
  |  | 661 | \* Register Mobile Menu Elementor Widget. |
  |  | 662 | \* |
  |  | 663 | \* @since 1.0.1 |
  |  | 664 | \*/ |
  |  | 665 | public function mobmenu\_el\_init\_widgets() { |
  |  | 666 | // Include Widget files |
  |  | 667 | require\_once \_\_DIR\_\_ . '/widgets/mobile-menu.php'; |
  |  | 668 | // Register widget |
  |  | 669 | \Elementor\Plugin::instance()->widgets\_manager->register\_widget\_type( new \Mobile\_Menu\_El\_Menu\_Widget() ); |
  |  | 670 | } |
  |  | 671 |  |
  | 712 | 672 | /\*\* |
  | 713 | 673 | \* Register the Mobile Menus. |
  | 714 | 674 | \*/ |
  | 715 |  | public function register\_menus() |
  | 716 |  | { |
  | 717 |  | global  $mm\_fs ; |
  |  | 675 | public function register\_menus() { |
  |  | 676 | global $mm\_fs; |
  | 718 | 677 | $menu\_locations = array( |
  | 719 | 678 | 'left-wp-mobile-menu'  => \_\_( 'Left Mobile Menu', 'mobile-menu' ), |
  | […](/browser/mobile-menu/trunk/includes/class-wp-mobile-menu-core.php?rev=3038752#L722) | […](/browser/mobile-menu/trunk/includes/class-wp-mobile-menu-core.php?rev=3097563#L681) |  |
  | 722 | 681 | register\_nav\_menus( $menu\_locations ); |
  | 723 | 682 | } |
  | 724 |  |  |
  |  | 683 |  |
  | 725 | 684 | /\*\* |
  | 726 | 685 | \* |
  | […](/browser/mobile-menu/trunk/includes/class-wp-mobile-menu-core.php?rev=3038752#L731) | […](/browser/mobile-menu/trunk/includes/class-wp-mobile-menu-core.php?rev=3097563#L690) |  |
  | 731 | 690 | \* @var $header\_text |
  | 732 | 691 | \*/ |
  | 733 |  | public function format\_header\_branding( $plugin\_settings, $header\_text ) |
  | 734 |  | { |
  | 735 |  | global $mm\_fs ; |
  |  | 692 | public function format\_header\_branding( $plugin\_settings, $header\_text ) { |
  |  | 693 | global $mm\_fs; |
  | 736 | 694 | global $post\_id; |
  | 737 |  |  |
  | 738 | 695 | $logo = $plugin\_settings->getOption( 'logo\_img' ); |
  | 739 |  | ~~$alternative\_logo\_img = $plugin\_settings->getOption( 'alternative\_logo\_img', $post\_id );~~ |
  | 740 |  | ~~if ( $alternative\_logo\_img != null ) {~~ |
  | 741 |  | ~~$logo = $alternative\_logo\_img;~~ |
  | 742 |  | ~~}~~ |
  | 743 | 696 | // Translate Logo with WPML. |
  | 744 |  |  |
  | 745 | 697 | if ( class\_exists( 'SitePress' ) ) { |
  | 746 | 698 | $current\_language = apply\_filters( 'wpml\_current\_language', NULL ); |
  | […](/browser/mobile-menu/trunk/includes/class-wp-mobile-menu-core.php?rev=3038752#L753) | […](/browser/mobile-menu/trunk/includes/class-wp-mobile-menu-core.php?rev=3097563#L705) |  |
  | 753 | 705 | ); |
  | 754 | 706 | } |
  | 755 |  |  |
  | 756 | 707 | $logo\_img = wp\_get\_attachment\_image\_src( $logo, 'full' ); |
  | 757 |  |  |
  | 758 | 708 | if ( $logo\_img == null ) { |
  | 759 | 709 | $logo\_img = ''; |
  | […](/browser/mobile-menu/trunk/includes/class-wp-mobile-menu-core.php?rev=3038752#L761) | […](/browser/mobile-menu/trunk/includes/class-wp-mobile-menu-core.php?rev=3097563#L711) |  |
  | 761 | 711 | $logo\_img = $logo\_img[0]; |
  | 762 | 712 | } |
  | 763 |  |  |
  | 764 | 713 | $logo\_img = apply\_filters( 'wp\_mobile\_menu\_logo\_img', $logo\_img ); |
  | 765 | 714 | $logo\_output = ''; |
  | […](/browser/mobile-menu/trunk/includes/class-wp-mobile-menu-core.php?rev=3038752#L769) | […](/browser/mobile-menu/trunk/includes/class-wp-mobile-menu-core.php?rev=3097563#L718) |  |
  | 769 | 718 | $logo\_img\_retina = $plugin\_settings->getOption( 'logo\_img\_retina' ); |
  | 770 | 719 | // Retina Logo. |
  | 771 |  |  |
  | 772 | 720 | if ( $logo\_img\_retina ) { |
  | 773 |  | ~~if ( $alternative\_logo\_img != null ) {~~ |
  | 774 |  | ~~$logo\_img\_retina = $alternative\_logo\_img;~~ |
  | 775 |  | ~~}~~ |
  | 776 | 721 | $logo\_img\_retina = wp\_get\_attachment\_image\_src( $logo\_img\_retina, 'full' ); |
  | 777 |  |  |
  | 778 | 722 | if ( $logo\_img\_retina == null || !$logo\_img\_retina ) { |
  | 779 | 723 | $logo\_img\_retina = $logo\_img; |
  | […](/browser/mobile-menu/trunk/includes/class-wp-mobile-menu-core.php?rev=3038752#L786) | […](/browser/mobile-menu/trunk/includes/class-wp-mobile-menu-core.php?rev=3097563#L730) |  |
  | 786 | 730 | } |
  | 787 | 731 | } |
  | 788 |  |  |
  | 789 |  | } |
  | 790 |  |  |
  | 791 |  |  |
  |  | 732 | } |
  | 792 | 733 | if ( $plugin\_settings->getOption( 'disabled\_logo\_url' ) ) { |
  | 793 | 734 | $logo\_url = '<h3 class="headertext">'; |
  | 794 | 735 | $logo\_url\_end = '</h3>'; |
  | 795 | 736 | } else { |
  | 796 |  |  |
  | 797 | 737 | if ( '' === $plugin\_settings->getOption( 'logo\_url' ) ) { |
  | 798 |  |  |
  | 799 | 738 | if ( function\_exists( 'pll\_home\_url' ) ) { |
  | 800 | 739 | $logo\_url = pll\_home\_url(); |
  | […](/browser/mobile-menu/trunk/includes/class-wp-mobile-menu-core.php?rev=3038752#L802) | […](/browser/mobile-menu/trunk/includes/class-wp-mobile-menu-core.php?rev=3097563#L741) |  |
  | 802 | 741 | $logo\_url = get\_bloginfo( 'url' ); |
  | 803 | 742 | } |
  | 804 |  |  |
  | 805 | 743 | } else { |
  | 806 | 744 | $logo\_url = $plugin\_settings->getOption( 'logo\_url' ); |
  | 807 | 745 | } |
  | 808 |  |  |
  | 809 | 746 | $logo\_url\_end = '</a>'; |
  | 810 | 747 | $logo\_url = apply\_filters( 'wp\_mobile\_menu\_logo\_url', $logo\_url ); |
  | 811 | 748 | $logo\_url = '<a href="' . $logo\_url . '" class="headertext">'; |
  | 812 | 749 | } |
  | 813 |  |  |
  | 814 | 750 | $output = '<div class="mob-menu-logo-holder">' . $logo\_url; |
  | 815 | 751 | $header\_branding = $plugin\_settings->getOption( 'header\_branding' ); |
  | 816 | 752 | // Assign the image alt valude with the blog title in case it's not provided on the image. It the blog title also doesn't exist default it to Organization Logo. |
  | 817 | 753 | if ( '' === $logo\_alt ) { |
  | 818 |  |  |
  | 819 | 754 | if ( '' === get\_bloginfo( 'name' ) ) { |
  | 820 | 755 | $logo\_alt = \_\_( 'Organization Logo', 'mobile-menu' ); |
  | […](/browser/mobile-menu/trunk/includes/class-wp-mobile-menu-core.php?rev=3038752#L822) | […](/browser/mobile-menu/trunk/includes/class-wp-mobile-menu-core.php?rev=3097563#L757) |  |
  | 822 | 757 | $logo\_alt = get\_bloginfo( 'name' ); |
  | 823 | 758 | } |
  | 824 |  |  |
  | 825 |  | } |
  | 826 |  |  |
  |  | 759 | } |
  | 827 | 760 | if ( ('logo' === $header\_branding || 'logo-text' === $header\_branding || 'text-logo' === $header\_branding) && '' !== $logo\_img ) { |
  | 828 |  |  |
  | 829 |  | $logo\_output .= '<img class="mob-standard-logo"   src="' . $logo\_img . '"  alt="' . $logo\_alt . '">'; |
  |  | 761 | $plugin\_settings = MobileMenuOptions::getInstance( 'mobmenu' ); |
  |  | 762 | $logo\_height = $plugin\_settings->getOption( 'logo\_height' ); |
  |  | 763 | $logo\_output .= '<img class="mob-standard-logo" height="' . $logo\_height . '"  src="' . $logo\_img . '"  alt="' . esc\_attr( $logo\_alt ) . '">'; |
  | 830 | 764 | // If there is a retina logo. |
  | 831 | 765 | if ( isset( $logo\_img\_retina ) ) { |
  | […](/browser/mobile-menu/trunk/includes/class-wp-mobile-menu-core.php?rev=3038752#L833) | […](/browser/mobile-menu/trunk/includes/class-wp-mobile-menu-core.php?rev=3097563#L767) |  |
  | 833 | 767 | } |
  | 834 | 768 | } |
  | 835 |  |  |
  | 836 | 769 | $header\_text = '<span>' . $header\_text . '</span>'; |
  | 837 | 770 | if ( $header\_branding ) { |
  | […](/browser/mobile-menu/trunk/includes/class-wp-mobile-menu-core.php?rev=3038752#L856) | […](/browser/mobile-menu/trunk/includes/class-wp-mobile-menu-core.php?rev=3097563#L789) |  |
  | 856 | 789 | return $output; |
  | 857 | 790 | } |
  | 858 |  |  |
  |  | 791 |  |
  | 859 | 792 | /\*\* |
  | 860 | 793 | \* |
  | […](/browser/mobile-menu/trunk/includes/class-wp-mobile-menu-core.php?rev=3038752#L863) | […](/browser/mobile-menu/trunk/includes/class-wp-mobile-menu-core.php?rev=3097563#L796) |  |
  | 863 | 796 | \* @since 2.7 |
  | 864 | 797 | \*/ |
  | 865 |  | public function mobmenu\_close\_button( $icon ) |
  | 866 |  | { |
  |  | 798 | public function mobmenu\_close\_button( $icon ) { |
  | 867 | 799 | $close\_button = apply\_filters( 'mm\_close\_button\_filter', '<i class="mob-icon-' . $icon . ' mob-cancel-button"></i>' ); |
  | 868 | 800 | return $close\_button; |
  | 869 | 801 | } |
  | 870 |  |  |
  |  | 802 |  |
  | 871 | 803 | /\*\* |
  | 872 | 804 | \* |
  | […](/browser/mobile-menu/trunk/includes/class-wp-mobile-menu-core.php?rev=3038752#L875) | […](/browser/mobile-menu/trunk/includes/class-wp-mobile-menu-core.php?rev=3097563#L807) |  |
  | 875 | 807 | \* @since 2.0 |
  | 876 | 808 | \*/ |
  | 877 |  | public function save\_menu\_item\_icon() |
  | 878 |  | { |
  | 879 |  |  |
  |  | 809 | public function save\_menu\_item\_icon() { |
  | 880 | 810 | if ( isset( $\_POST['menu\_item\_id'] ) ) { |
  | 881 | 811 | $menu\_item\_id = absint( esc\_attr( $\_POST['menu\_item\_id'] ) ); |
  | […](/browser/mobile-menu/trunk/includes/class-wp-mobile-menu-core.php?rev=3038752#L886) | […](/browser/mobile-menu/trunk/includes/class-wp-mobile-menu-core.php?rev=3097563#L816) |  |
  | 886 | 816 | wp\_send\_json\_success(); |
  | 887 | 817 | } |
  | 888 |  |  |
  | 889 |  | } |
  | 890 |  |  |
  |  | 818 | } |
  |  | 819 |  |
  | 891 | 820 | /\* |
  | 892 | 821 | \* Register Sidebar Menu Widgets. |
  | 893 | 822 | \* |
  | 894 | 823 | \*/ |
  | 895 |  | public function register\_sidebar() |
  | 896 |  | { |
  |  | 824 | public function register\_sidebar() { |
  | 897 | 825 | // Register the Mobile Menu Left Menu Top Widget. |
  | 898 | 826 | $args = array( |
  | […](/browser/mobile-menu/trunk/includes/class-wp-mobile-menu-core.php?rev=3038752#L951) | […](/browser/mobile-menu/trunk/includes/class-wp-mobile-menu-core.php?rev=3097563#L879) |  |
  | 951 | 879 | register\_sidebar( $args ); |
  | 952 | 880 | } |
  | 953 |  |  |
  |  | 881 |  |
  | 954 | 882 | /\*\* |
  | 955 | 883 | \* Get the Icon Font list. |
  | 956 | 884 | \*/ |
  | 957 |  | public function get\_icons\_list() |
  | 958 |  | { |
  | 959 |  | global  $mm\_fs ; |
  |  | 885 | public function get\_icons\_list() { |
  |  | 886 | global $mm\_fs; |
  | 960 | 887 | $icons\_base = array( |
  | 961 | 888 | 'menu', |
  | […](/browser/mobile-menu/trunk/includes/class-wp-mobile-menu-core.php?rev=3038752#L1006) | […](/browser/mobile-menu/trunk/includes/class-wp-mobile-menu-core.php?rev=3097563#L933) |  |
  | 1006 | 933 | return $icons\_base; |
  | 1007 | 934 | } |
  | 1008 |  |  |
  |  | 935 |  |
  | 1009 | 936 | /\*\* |
  | 1010 | 937 | \* |
  | […](/browser/mobile-menu/trunk/includes/class-wp-mobile-menu-core.php?rev=3038752#L1013) | […](/browser/mobile-menu/trunk/includes/class-wp-mobile-menu-core.php?rev=3097563#L940) |  |
  | 1013 | 940 | \* @since 2.7 |
  | 1014 | 941 | \*/ |
  | 1015 |  | public function mobile\_menu\_export\_settings() |
  | 1016 |  | { |
  |  | 942 | public function mobile\_menu\_export\_settings() { |
  | 1017 | 943 | ob\_clean(); |
  | 1018 | 944 | $date = date( 'Y-m-d' ); |
  | […](/browser/mobile-menu/trunk/includes/class-wp-mobile-menu-core.php?rev=3038752#L1022) | […](/browser/mobile-menu/trunk/includes/class-wp-mobile-menu-core.php?rev=3097563#L948) |  |
  | 1022 | 948 | header( 'Content-Disposition: attachment; filename=' . $filename ); |
  | 1023 | 949 | header( 'Content-Type: text/html; charset=utf-8' ); |
  | 1024 |  | echo ~~$output~~ ; |
  |  | 950 | echo $output; |
  | 1025 | 951 | die; |
  | 1026 | 952 | } |
  | 1027 |  |  |
  |  | 953 |  |
  | 1028 | 954 | /\*\* |
  | 1029 | 955 | \* |
  | […](/browser/mobile-menu/trunk/includes/class-wp-mobile-menu-core.php?rev=3038752#L1032) | […](/browser/mobile-menu/trunk/includes/class-wp-mobile-menu-core.php?rev=3097563#L958) |  |
  | 1032 | 958 | \* @since 2.7 |
  | 1033 | 959 | \*/ |
  | 1034 |  | public function mobile\_menu\_import\_settings( $settings\_id ) |
  | 1035 |  | { |
  | 1036 |  | global  $mm\_fs ; |
  | 1037 |  | global  $message ; |
  | 1038 |  | global  $message\_code ; |
  |  | 960 | public function mobile\_menu\_import\_settings( $settings\_id ) { |
  |  | 961 | global $mm\_fs; |
  |  | 962 | global $message; |
  |  | 963 | global $message\_code; |
  | 1039 | 964 | $message = ''; |
  | 1040 | 965 | $message\_code = ''; |
  | […](/browser/mobile-menu/trunk/includes/class-wp-mobile-menu-core.php?rev=3038752#L1042) | […](/browser/mobile-menu/trunk/includes/class-wp-mobile-menu-core.php?rev=3097563#L967) |  |
  | 1042 | 967 | $left\_menu = $plugin\_settings->getOption( 'left\_menu' ); |
  | 1043 | 968 | // If we are importing an oficial demo. |
  | 1044 |  |  |
  | 1045 | 969 | if ( isset( $\_REQUEST['demo'] ) ) { |
  | 1046 | 970 | $file = $\_REQUEST['demo'] . '.txt'; |
  | […](/browser/mobile-menu/trunk/includes/class-wp-mobile-menu-core.php?rev=3038752#L1048) | […](/browser/mobile-menu/trunk/includes/class-wp-mobile-menu-core.php?rev=3097563#L972) |  |
  | 1048 | 972 | } else { |
  | 1049 | 973 | // If we are importing a settings file from the user. |
  | 1050 |  |  |
  | 1051 | 974 | if ( isset( $\_FILES['upload\_mobmenu\_settings'] ) && '' !== $\_FILES['upload\_mobmenu\_settings']['tmp\_name'] ) { |
  | 1052 | 975 | $file = $\_FILES['upload\_mobmenu\_settings']; |
  | 1053 | 976 | $file\_content = file\_get\_contents( $file['tmp\_name'] ); |
  | 1054 | 977 | } |
  | 1055 |  |  |
  | 1056 |  | } |
  | 1057 |  |  |
  |  | 978 | } |
  | 1058 | 979 | if ( (isset( $\_FILES['upload\_mobmenu\_settings'] ) || isset( $\_REQUEST['demo'] )) && 'error' != $message\_code ) { |
  | 1059 | 980 | // If the file is empty. |
  | 1060 |  |  |
  | 1061 | 981 | if ( !$file\_content ) { |
  | 1062 | 982 | $message = \_\_( 'The file is empty. Upload a new file and try again.', 'mobile-menu' ); |
  | […](/browser/mobile-menu/trunk/includes/class-wp-mobile-menu-core.php?rev=3038752#L1064) | […](/browser/mobile-menu/trunk/includes/class-wp-mobile-menu-core.php?rev=3097563#L984) |  |
  | 1064 | 984 | } else { |
  | 1065 | 985 | // Update the Mobile Menu Settings. |
  | 1066 |  |  |
  | 1067 | 986 | if ( get\_option( 'mobmenu\_options' ) !== $file\_content ) { |
  | 1068 | 987 | $result = update\_option( 'mobmenu\_options', $file\_content ); |
  | 1069 |  |  |
  | 1070 | 988 | if ( $result ) { |
  | 1071 | 989 | $message = \_\_( 'Settings Imported successfully.', 'mobile-menu' ); |
  | […](/browser/mobile-menu/trunk/includes/class-wp-mobile-menu-core.php?rev=3038752#L1076) | […](/browser/mobile-menu/trunk/includes/class-wp-mobile-menu-core.php?rev=3097563#L994) |  |
  | 1076 | 994 | $message\_code = 'error'; |
  | 1077 | 995 | } |
  | 1078 |  |  |
  | 1079 | 996 | } else { |
  | 1080 | 997 | $message = \_\_( 'The settings are exactly the same has the current ones. Nothing was imported.', 'mobile-menu' ); |
  | 1081 | 998 | $message\_code = 'warning'; |
  | 1082 | 999 | } |
  | 1083 |  |  |
  | 1084 |  | } |
  | 1085 |  |  |
  |  | 1000 | } |
  | 1086 | 1001 | } |
  | 1087 | 1002 | $version\_class = 'mm-free-version'; |
  | […](/browser/mobile-menu/trunk/includes/class-wp-mobile-menu-core.php?rev=3038752#L1106) | […](/browser/mobile-menu/trunk/includes/class-wp-mobile-menu-core.php?rev=3097563#L1021) |  |
  | 1106 | 1021 | ?></button> |
  | 1107 | 1022 | <?php |
  | 1108 |  |  |
  | 1109 | 1023 | if ( isset( $\_REQUEST['demo'] ) && 'free-demo' === $\_REQUEST['demo'] ) { |
  | 1110 | 1024 | ?> |
  | 1111 | 1025 | <h4 class="<?php |
  | 1112 |  | echo ~~$message\_code~~ ; |
  |  | 1026 | echo $message\_code; |
  | 1113 | 1027 | ?>"><?php |
  | 1114 | 1028 | \_e( $message, 'mobile-menu' ); |
  | […](/browser/mobile-menu/trunk/includes/class-wp-mobile-menu-core.php?rev=3038752#L1116) | […](/browser/mobile-menu/trunk/includes/class-wp-mobile-menu-core.php?rev=3097563#L1030) |  |
  | 1116 | 1030 | <?php |
  | 1117 | 1031 | } |
  | 1118 |  |  |
  | 1119 | 1032 | ?> |
  | 1120 | 1033 | </div> |
  | 1121 | 1034 | <a href="https://demo.wpmobilemenu.com/?utm\_source=wprepo-dash&utm\_medium=user%20website&utm\_campaign=import-demo" target="\_blank"> |
  | 1122 | 1035 | <img src="<?php |
  | 1123 |  | echo ~~plugins\_url( 'demo-content/assets/freedemo-mobile-menu.png', \_\_FILE\_\_ )~~ ; |
  |  | 1036 | echo plugins\_url( 'demo-content/assets/freedemo-mobile-menu.png', \_\_FILE\_\_ ); |
  | 1124 | 1037 | ?>"> |
  | 1125 | 1038 | <span><?php |
  | […](/browser/mobile-menu/trunk/includes/class-wp-mobile-menu-core.php?rev=3038752#L1134) | […](/browser/mobile-menu/trunk/includes/class-wp-mobile-menu-core.php?rev=3097563#L1047) |  |
  | 1134 | 1047 | ?></h4> |
  | 1135 | 1048 | <button type="submit" class="button button-secondary button-next mobile-menu-import-demo <?php |
  | 1136 |  | echo ~~$version\_class~~ ; |
  |  | 1049 | echo $version\_class; |
  | 1137 | 1050 | ?>" data-demo-id="shop-demo" value="<?php |
  | 1138 | 1051 | esc\_attr\_e( 'Import Demo', 'mobile-menu' ); |
  | […](/browser/mobile-menu/trunk/includes/class-wp-mobile-menu-core.php?rev=3038752#L1141) | […](/browser/mobile-menu/trunk/includes/class-wp-mobile-menu-core.php?rev=3097563#L1054) |  |
  | 1141 | 1054 | ?></button> |
  | 1142 | 1055 | <?php |
  | 1143 |  |  |
  | 1144 | 1056 | if ( isset( $\_REQUEST['demo'] ) && 'shop-demo' === $\_REQUEST['demo'] ) { |
  | 1145 | 1057 | ?> |
  | 1146 | 1058 | <h4 class="<?php |
  | 1147 |  | echo ~~$message\_code~~ ; |
  |  | 1059 | echo $message\_code; |
  | 1148 | 1060 | ?>"><?php |
  | 1149 | 1061 | \_e( $message, 'mobile-menu' ); |
  | […](/browser/mobile-menu/trunk/includes/class-wp-mobile-menu-core.php?rev=3038752#L1151) | […](/browser/mobile-menu/trunk/includes/class-wp-mobile-menu-core.php?rev=3097563#L1063) |  |
  | 1151 | 1063 | <?php |
  | 1152 | 1064 | } |
  | 1153 |  |  |
  | 1154 | 1065 | ?> |
  | 1155 | 1066 | </div> |
  | 1156 | 1067 | <a href="https://shopdemo.wpmobilemenu.com/?utm\_source=wprepo-dash&utm\_medium=user%20website&utm\_campaign=demo\_importer\_option" target="\_blank"> |
  | 1157 | 1068 | <img src="<?php |
  | 1158 |  | echo ~~plugins\_url( 'demo-content/assets/shopdemo-mobile-menu.png', \_\_FILE\_\_ )~~ ; |
  |  | 1069 | echo plugins\_url( 'demo-content/assets/shopdemo-mobile-menu.png', \_\_FILE\_\_ ); |
  | 1159 | 1070 | ?>"> |
  | 1160 | 1071 | <span><?php |
  | […](/browser/mobile-menu/trunk/includes/class-wp-mobile-menu-core.php?rev=3038752#L1169) | […](/browser/mobile-menu/trunk/includes/class-wp-mobile-menu-core.php?rev=3097563#L1080) |  |
  | 1169 | 1080 | ?></h4> |
  | 1170 | 1081 | <button type="submit" class="button button-secondary button-next mobile-menu-import-demo <?php |
  | 1171 |  | echo ~~$version\_class~~ ; |
  |  | 1082 | echo $version\_class; |
  | 1172 | 1083 | ?>" data-demo-id="professional-demo" value="<?php |
  | 1173 | 1084 | esc\_attr\_e( 'Import Demo', 'mobile-menu' ); |
  | […](/browser/mobile-menu/trunk/includes/class-wp-mobile-menu-core.php?rev=3038752#L1176) | […](/browser/mobile-menu/trunk/includes/class-wp-mobile-menu-core.php?rev=3097563#L1087) |  |
  | 1176 | 1087 | ?></button> |
  | 1177 | 1088 | <?php |
  | 1178 |  |  |
  | 1179 | 1089 | if ( isset( $\_REQUEST['demo'] ) && 'professional-demo' === $\_REQUEST['demo'] ) { |
  | 1180 | 1090 | ?> |
  | 1181 | 1091 | <h4 class="<?php |
  | 1182 |  | echo ~~$message\_code~~ ; |
  |  | 1092 | echo $message\_code; |
  | 1183 | 1093 | ?>"><?php |
  | 1184 | 1094 | \_e( $message, 'mobile-menu' ); |
  | […](/browser/mobile-menu/trunk/includes/class-wp-mobile-menu-core.php?rev=3038752#L1186) | […](/browser/mobile-menu/trunk/includes/class-wp-mobile-menu-core.php?rev=3097563#L1096) |  |
  | 1186 | 1096 | <?php |
  | 1187 | 1097 | } |
  | 1188 |  |  |
  | 1189 | 1098 | ?> |
  | 1190 | 1099 | </div> |
  | 1191 | 1100 | <a href="https://prodemo.wpmobilemenu.com/?utm\_source=wprepo-dash&utm\_medium=user%20website&utm\_campaign=demo\_importer\_option" target="\_blank"> |
  | 1192 | 1101 | <img src="<?php |
  | 1193 |  | echo ~~plugins\_url( 'demo-content/assets/prodemo-mobile-menu.png', \_\_FILE\_\_ )~~ ; |
  |  | 1102 | echo plugins\_url( 'demo-content/assets/prodemo-mobile-menu.png', \_\_FILE\_\_ ); |
  | 1194 | 1103 | ?>"> |
  | 1195 | 1104 | <span><?php |
  | […](/browser/mobile-menu/trunk/includes/class-wp-mobile-menu-core.php?rev=3038752#L1217) | […](/browser/mobile-menu/trunk/includes/class-wp-mobile-menu-core.php?rev=3097563#L1126) |  |
  | 1217 | 1126 | </header> |
  | 1218 | 1127 | <?php |
  | 1219 |  |  |
  | 1220 | 1128 | if ( '' !== $message && !isset( $\_REQUEST['demo'] ) ) { |
  | 1221 | 1129 | ?> |
  | 1222 | 1130 | <div class="mobmenu-message-holder"> |
  | 1223 | 1131 | <h4 class="<?php |
  | 1224 |  | echo ~~$message\_code~~ ; |
  |  | 1132 | echo $message\_code; |
  | 1225 | 1133 | ?>"><?php |
  | 1226 | 1134 | \_e( $message, 'mobile-menu' ); |
  | […](/browser/mobile-menu/trunk/includes/class-wp-mobile-menu-core.php?rev=3038752#L1229) | […](/browser/mobile-menu/trunk/includes/class-wp-mobile-menu-core.php?rev=3097563#L1137) |  |
  | 1229 | 1137 | <?php |
  | 1230 | 1138 | } |
  | 1231 |  |  |
  | 1232 | 1139 | ?> |
  | 1233 | 1140 | <section> |

**Note:** See [TracChangeset](/wiki/TracChangeset)
for help on using the changeset viewer.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Unified Diff](?format=diff&new=3097563)
* [Zip Archive](?format=zip&new=3097563)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)

