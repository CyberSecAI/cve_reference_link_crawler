The provided content relates to CVE-2022-48652.

**Root cause of vulnerability:**
The vulnerability stems from a race condition in the `ice` driver when updating Traffic Classes (TCs). If the number of allocated queues is less than the number of Traffic Classes, and the TCs are updated via LLDP, the function `ice_vsi_cfg_tc()` might fail. However, this function would leave the `num_txq`, `num_rxq` and `tc_cfg` variables in the VSI structure in a dirty state, leading to invalid pointer access and a subsequent crash.

**Weaknesses/vulnerabilities present:**
- Race condition when updating TCs and queue configuration
- Inconsistent state of VSI structure after failed TC configuration
- Incorrect queue mapping leading to out of bounds access

**Impact of exploitation:**
- Kernel crash due to invalid memory access
- Denial of service

**Attack vectors:**
- Triggering a TC update through LLDP when allocated queues are less than traffic classes.

**Required attacker capabilities/position:**
- Ability to influence or trigger LLDP updates that would cause a change in the number of traffic classes.
- Local access (root or similar privileges) to control the network configuration.