The provided content relates to CVE-2024-33905.

**Root cause of vulnerability:**
The vulnerability lies in the way the Telegram Web app handles the `web_app_open_link` event, specifically within the `addMultipleEventsListeners` function. It uses `window.open(t, "_blank")` to open a new window with the provided URL (`t`). This allowed an attacker to use the `javascript:` URI scheme, executing arbitrary javascript code in the context of the parent window.

**Weaknesses/vulnerabilities present:**
- Cross-Site Scripting (XSS) vulnerability: By using the `javascript:` scheme within the `web_app_open_link` event, an attacker can inject and execute arbitrary JavaScript code in the context of the Telegram Web application.
- Insecure handling of URLs: The application does not properly sanitize or validate URLs passed to the `window.open()` function, making it susceptible to the `javascript:` scheme.
- Lack of context isolation: When opening a new window, the code did not isolate the new window's javascript context from the parent's one.

**Impact of exploitation:**
- Session Hijacking: An attacker could exploit this XSS vulnerability to gain access to the victim's Telegram session by stealing the `localStorage` data where the user session is stored.
- Arbitrary JavaScript execution: An attacker can execute arbitrary JavaScript code on the victim's browser within the context of the Telegram Web application.

**Attack vectors:**
- The attacker creates a malicious Telegram Mini App.
- The attacker sets the URL of the Mini App to a webpage controlled by the attacker which hosts the exploit.
- The exploit utilizes the `postMessage` API to send a `web_app_open_link` event with a crafted URL (e.g., using the `javascript:` scheme).

**Required attacker capabilities/position:**
- The attacker needs to be able to create a Telegram Bot and a Mini App.
- The attacker needs to be able to host a webpage which will be used to deliver the exploit.
- The attacker needs to trick the victim into opening the malicious Mini App.