Based on the provided content, here's a breakdown of the vulnerability:

**Root Cause:**
The vulnerability stems from WEBrick's improper handling of HTTP requests that include both `Content-Length` and `Transfer-Encoding` headers. According to RFC 7230, section 3.3.3.3, a server can reject such requests with a 400 error, but WEBrick wasn't doing this.

**Weaknesses/Vulnerabilities:**
- **HTTP Request Smuggling:** By including both headers, an attacker can manipulate how the server parses request boundaries, effectively "smuggling" a second, malicious request within the body of the first.

**Impact of Exploitation:**
- **Unauthorized Access:** The smuggled request can target restricted resources, such as `/admin`, which are not intended for access by unauthorized users. An attacker could potentially bypass access controls.
- **Data Manipulation:** An attacker might use a smuggled request to alter data, potentially leading to application logic issues or even data corruption depending on the application using WEBrick.

**Attack Vectors:**
- The attacker crafts a malicious HTTP request that contains both `Content-Length` and `Transfer-Encoding` headers. This is sent to the server. The server's flawed parsing logic then allows a second, smuggled request within the body of the first to be processed as a separate valid request.

**Required Attacker Capabilities/Position:**
- The attacker needs the ability to send HTTP requests to the vulnerable WEBrick server.
- No special privileges or authentication is required for the basic attack to succeed.

**Technical Details:**
The initial proof of concept exploit was:
```
POST /user HTTP/1.1
Host: 127.0.0.1:8000
Content-Length: 50
Transfer-Encoding: chunked

0

GET /admin HTTP/1.1
Host: 127.0.0.1:8000
```

The fix implemented in pull request #146 and commit `d88321da45dcd230ac2b4585cad4833d6d5e8841` was to raise a `WEBrick::HTTPStatus::BadRequest` error when a request contained both `Content-Length` and `Transfer-Encoding` headers, effectively preventing the request smuggling attack. The fix is in the `lib/webrick/httprequest.rb` file. A corresponding test case `test_content_length_and_transfer_encoding_headers_smuggling` was added to `test/webrick/test_httprequest.rb`.

**Additional Notes:**
- The maintainers of Webrick have stated that it "should not be used in production." This is because it has been removed from Ruby core and they only maintain it because it's used by gems mainly for testing. The project has changed its maintenance policy.
- The maintainers initially resisted having this issue listed as a CVE due to the policy change, however a CVE was eventually assigned as CVE-2024-47220.