=== Content from bugzilla.mozilla.org_b0e61c8b_20250108_124630.html ===


![](/static/v20241211.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1738501)
* [XML](/show_bug.cgi?ctype=xml&id=1738501)

Closed
[Bug 1738501](/show_bug.cgi?id=1738501)
(CVE-2021-43529)

Opened 3 years ago
Closed 3 years ago

# Automatic S/MIME cert import should use additional verification using mozilla::pkix

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Automatic S/MIME cert import should use additional verification using mozilla::pkix

## Categories

### (MailNews Core :: Security: S/MIME, enhancement, P1)

[Product:](/describecomponents.cgi?product=MailNews%20Core)

MailNews Core
▾

MailNews Core
Mail and news components common to Thunderbird and SeaMonkey
[See Open Bugs in This Product](/buglist.cgi?product=MailNews%20Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=MailNews%20Core)
Watch This Product

[Component:](/describecomponents.cgi?product=MailNews%20Core&component=Security%3A%20S%2FMIME#Security%3A%20S%2FMIME)

Security: S/MIME
▾

MailNews Core :: Security: S/MIME
S/MIME is the sending of signed and/or encrypted email.
[See Open Bugs in This Component](/buglist.cgi?product=MailNews%20Core&component=Security%3A%20S%2FMIME&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=MailNews%20Core&component=Security%3A%20S%2FMIME&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=MailNews%20Core&component=Security%3A%20S%2FMIME)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

unspecified

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

enhancement

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

P1

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

S1

## Tracking

### (thunderbird\_esr78 wontfix, thunderbird\_esr91+ fixed, thunderbird95 fixed)

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

96 Branch

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| thunderbird\_esr78 | --- | [wontfix](/buglist.cgi?f1=cf_status_thunderbird_esr78&o1=equals&v1=wontfix) |
| thunderbird\_esr91 | [+](/buglist.cgi?f1=cf_tracking_thunderbird_esr91&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_thunderbird_esr91&o1=equals&v1=fixed) |
| thunderbird95 | --- | [fixed](/buglist.cgi?f1=cf_status_thunderbird_95&o1=equals&v1=fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| relnote-thunderbird |  | --- |
| thunderbird\_esr78 |  | wontfix |
| thunderbird\_esr91 | + | fixed |
| thunderbird95 |  | fixed |
| seamonkey2.53 | --- | --- |
| seamonkey2.57esr | --- | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| thunderbird133 | --- | --- |
| thunderbird134 | --- | --- |
| thunderbird135 | --- | --- |

## People

### (Reporter: KaiE, Assigned: KaiE)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=40)  [KaiE](/user_profile?user_id=36541)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/d11b5b0a468ed960df1fde3c304d3580?d=mm&size=40)  [KaiE](/user_profile?user_id=36541)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

---

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

11 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

[CVE-2021-43527](/show_bug.cgi?id=1737470 "RESOLVED FIXED - Memory Corruption in decodeECorDsaSignature with DSA signatures (and RSA-PSS)")

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

Dependency [tree](/showdependencytree.cgi?id=1738501&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=1738501)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

[1738592](/show_bug.cgi?id=1738592 "NEW - Allow NSS S/MIME code to call application defined certificate verification functions")

## Details

### (Keywords: sec-critical)

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2021-43529

[Keywords:](/describekeywords.cgi)

[sec-critical](/buglist.cgi?keywords=sec-critical&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

|  | wanted-thunderbird |  |
| --- | --- | --- |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |
|  | relnote |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (3 files)

| [Bug 1738501 - Add check using mozilla::pkix to some more scenarios. r=mkmelin](/attachment.cgi?id=9248476)  [3 years ago](#c1)  [Kai Engert [:KaiE:]](/user_profile?user_id=36541)   48 bytes, text/x-phabricator-request | rjl : [approval-comm-esr91+](#c7 "3 years ago") | [Details](/attachment.cgi?id=9248476&action=edit) | [Review](/attachment.cgi?id=9248476) |
| --- | --- | --- |
| [1738501-cc.patch](/attachment.cgi?id=9248548)  [3 years ago](#c3)  [Kai Engert [:KaiE:]](/user_profile?user_id=36541)   9.88 KB, patch | rjl : [approval-comm-beta+](#c8 "3 years ago") | [Details](/attachment.cgi?id=9248548&action=edit) | [Diff](/attachment.cgi?id=9248548&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1738501&attachment=9248548) |
| [fix-symbols.patch](/attachment.cgi?id=9248766)  [3 years ago](#c11)  [Kai Engert [:KaiE:]](/user_profile?user_id=36541)   797 bytes, patch | rjl : [review+](#a259610_63411 "3 years ago") | [Details](/attachment.cgi?id=9248766&action=edit) | [Diff](/attachment.cgi?id=9248766&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1738501&attachment=9248766) |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Kai Engert [:KaiE:]](/user_profile?user_id=36541)  Assignee |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1738501#c0)• 3 years ago |
|  | |

When processing incoming S/MIME email that is digitally signed, we:

* (a) perform a check of the signature, including verification of the signing certificate
* (b) import the certificates that are found inside the signature, because they might be necessary for verifying the signing certificate, and also for making it possible to use these certificates in the future for encryption

The classic NSS verification is limited in its ability to perform revocation checking, in particular the current configuration used by the Gecko platform has trouble with a proxy configuration.

In addition the S/MIME implementation in NSS is hardcoded to use the classic NSS verification APIs.

Therefore in [bug 324474](/show_bug.cgi?id=324474 "RESOLVED FIXED - Revoked S/MIME certificate difficult to detect in received messages"), we had added an additional check at the mail code level. In [bug 813418](/show_bug.cgi?id=813418 "RESOLVED FIXED - Centralize certificate validation") that code was later upgraded to use the mozilla::pkix for an initial validity check.

However, that additional check is limited to check the signature certificate. Earlier, we perform import of certificates that are bundled with the signature.

This bug suggests that we perform the additional check for all certificates that we are automatically importing, too.

We should expedite adding this check, therefore I'm using a workaround that involves copying some internal NSS code to the Thunderbird code. At a later time, we should clean this up by adding a new API to NSS, that allows the mail code to perform its own additional checks using a callback. (The design of the new API can be discussed at a later time, when we perform the cleanup.)

It was noticed that the mozilla::pkix code doesn't support checking DSA certificates nor RSA-PSS certificates.

This means, because of the existing checks, we never show signatures from such certificates as valid. I couldn't find any bug report in the S/MIME component mentioning the classic DSA algorithm, so apparently nobody has ever complained that DSA cert signatures are always reported in Thunderbird as invalid. And it's already known that RSA-PSS is not yet supported by the Thunderbird S/MIME code ([bug 1597202](/show_bug.cgi?id=1597202 "NEW - Thunderbird S/MIME should support RSA-PSS")).

Therefore I'm not worried that the suggested change will extend this limitation to the automatic certificate import from incoming email, it seems unlikely that it will have a relevant impact.

[tracking-firefox94](/buglist.cgi?f1=cf_tracking_firefox94&o1=isnotempty):
[?](/buglist.cgi?f1=cf_tracking_firefox94&o1=equals&v1=%3F) → ---
[tracking-firefox95](/buglist.cgi?f1=cf_tracking_firefox95&o1=isnotempty):
[?](/buglist.cgi?f1=cf_tracking_firefox95&o1=equals&v1=%3F) → ---

|  | [Kai Engert [:KaiE:]](/user_profile?user_id=36541)  Assignee |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1738501#c1)• 3 years ago |
|  | |

Attached file
[Bug 1738501 - Add check using mozilla::pkix to some more scenarios. r=mkmelin](attachment.cgi?id=9248476)
— [Details](attachment.cgi?id=9248476&action=edit)

|  | [Kai Engert [:KaiE:]](/user_profile?user_id=36541)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1738501#a853_36541)• 3 years ago |

[status-thunderbird\_esr78](/buglist.cgi?f1=cf_status_thunderbird_esr78&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_thunderbird_esr78&o1=equals&v1=wontfix)
[status-thunderbird\_esr91](/buglist.cgi?f1=cf_status_thunderbird_esr91&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_thunderbird_esr91&o1=equals&v1=affected)
[tracking-thunderbird\_esr91](/buglist.cgi?f1=cf_tracking_thunderbird_esr91&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_thunderbird_esr91&o1=equals&v1=%2B)

|  | [Kai Engert [:KaiE:]](/user_profile?user_id=36541)  Assignee |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1738501#c3)• 3 years ago |
|  | |

Attached patch

[1738501-cc.patch](attachment.cgi?id=9248548&action=diff)
— [Details](attachment.cgi?id=9248548&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1738501&attachment=9248548)

Note the patch in phabricator applies to comm-esr91.

comm-central needs a slightly merged patch, I'm attaching it here.

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1738501#c4)• 3 years ago |
|  | |

Looks good to me.

|  | [Kai Engert [:KaiE:]](/user_profile?user_id=36541)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1738501#a238641_36541)• 3 years ago |

Group: mail-core-security

|  | [Wayne Mery (:wsmwk)](/user_profile?user_id=29811) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1738501#c5)• 3 years ago |
|  | |

Comment on [attachment 9248548](/attachment.cgi?id=9248548 "1738501-cc.patch") [[details]](/attachment.cgi?id=9248548&action=edit "1738501-cc.patch") [[diff]](/attachment.cgi?id=9248548&action=diff "1738501-cc.patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1738501&attachment=9248548)

1738501-cc.patch

[Triage Comment]

Approved for ers91

[Attachment #9248548](/attachment.cgi?id=9248548&action=edit "1738501-cc.patch") -
Flags: approval-comm-esr91+

|  | [Wayne Mery (:wsmwk)](/user_profile?user_id=29811) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1738501#c6)• 3 years ago |
|  | |

Comment on [attachment 9248476](/attachment.cgi?id=9248476 "Bug 1738501 - Add check using mozilla::pkix to some more scenarios. r=mkmelin") [[details]](/attachment.cgi?id=9248476&action=edit "Bug 1738501 - Add check using mozilla::pkix to some more scenarios. r=mkmelin")

[Bug 1738501](/show_bug.cgi?id=1738501 "RESOLVED FIXED - Automatic S/MIME cert import should use additional verification using mozilla::pkix") - Add check using mozilla::pkix to some more scenarios. r=mkmelin

[Triage Comment]

Approved for beta

[Attachment #9248476](/attachment.cgi?id=9248476&action=edit "Bug 1738501 - Add check using mozilla::pkix to some more scenarios. r=mkmelin") -
Flags: approval-comm-beta+

|  | [Rob Lemley [:rjl]](/user_profile?user_id=63411) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1738501#c7)• 3 years ago |
|  | |

Comment on [attachment 9248476](/attachment.cgi?id=9248476 "Bug 1738501 - Add check using mozilla::pkix to some more scenarios. r=mkmelin") [[details]](/attachment.cgi?id=9248476&action=edit "Bug 1738501 - Add check using mozilla::pkix to some more scenarios. r=mkmelin")

[Bug 1738501](/show_bug.cgi?id=1738501 "RESOLVED FIXED - Automatic S/MIME cert import should use additional verification using mozilla::pkix") - Add check using mozilla::pkix to some more scenarios. r=mkmelin

[Triage Comment]

This is the c-esr91 version.

[Attachment #9248476](/attachment.cgi?id=9248476&action=edit "Bug 1738501 - Add check using mozilla::pkix to some more scenarios. r=mkmelin") -
Flags: approval-comm-beta+ → approval-comm-esr91+

|  | [Rob Lemley [:rjl]](/user_profile?user_id=63411) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1738501#c8)• 3 years ago |
|  | |

Comment on [attachment 9248548](/attachment.cgi?id=9248548 "1738501-cc.patch") [[details]](/attachment.cgi?id=9248548&action=edit "1738501-cc.patch") [[diff]](/attachment.cgi?id=9248548&action=diff "1738501-cc.patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1738501&attachment=9248548)

1738501-cc.patch

[Triage Comment]

For c-central and c-beta (95b1)

[Attachment #9248548](/attachment.cgi?id=9248548&action=edit "1738501-cc.patch") -
Flags: approval-comm-esr91+ → approval-comm-beta+

|  | [Pulsebot](/user_profile?user_id=510726) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1738501#c9)• 3 years ago |
|  | |

Pushed by thunderbird@calypsoblue.org:

<https://hg.mozilla.org/comm-central/rev/2ff7d3a75e8f>

Add check using mozilla::pkix to some more scenarios. r=mkmelin

Status: NEW → RESOLVEDClosed: 3 years agoResolution: --- → FIXED

|  | [Rob Lemley [:rjl]](/user_profile?user_id=63411) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1738501#c10)• 3 years ago |
| bugherder uplift | |

Thunderbird 91.3.0:

<https://hg.mozilla.org/releases/comm-esr91/rev/54507526da82>

[status-thunderbird\_esr91](/buglist.cgi?f1=cf_status_thunderbird_esr91&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_thunderbird_esr91&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_thunderbird_esr91&o1=equals&v1=fixed)

|  | [Kai Engert [:KaiE:]](/user_profile?user_id=36541)  Assignee |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1738501#c11)• 3 years ago |
|  | |

Attached patch

[fix-symbols.patch](attachment.cgi?id=9248766&action=diff)
— [Details](attachment.cgi?id=9248766&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1738501&attachment=9248766)

Add required symbols for linking.

|  | [Kai Engert [:KaiE:]](/user_profile?user_id=36541)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1738501#a253074_36541)• 3 years ago |

[Attachment #9248766](/attachment.cgi?id=9248766&action=edit "fix-symbols.patch") -
Flags: review?(rob)

|  | [Pulsebot](/user_profile?user_id=510726) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1738501#c12)• 3 years ago |
|  | |

Pushed by thunderbird@calypsoblue.org:
<https://hg.mozilla.org/comm-central/rev/ad4f738a236a>
Follow-up: Fix unresolved NSS symbols on macOS/Windows. r=rjl

|  | [Rob Lemley [:rjl]](/user_profile?user_id=63411) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1738501#c13)• 3 years ago |
| bugherder uplift | |

Thunderbird 95.0b1:

<https://hg.mozilla.org/releases/comm-beta/rev/ad434a0dbe8b>

<https://hg.mozilla.org/releases/comm-beta/rev/2897d53eb065>

[status-thunderbird95](/buglist.cgi?f1=cf_status_thunderbird_95&o1=isnotempty):
--- → [fixed](/buglist.cgi?f1=cf_status_thunderbird_95&o1=equals&v1=fixed)

|  | [Kai Engert [:KaiE:]](/user_profile?user_id=36541)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1738501#a259153_36541)• 3 years ago |

Target Milestone: --- → 96 Branch

|  | [Rob Lemley [:rjl]](/user_profile?user_id=63411) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1738501#c14)• 3 years ago |
| bugherder uplift | |

Thunderbird 91.3.0:

<https://hg.mozilla.org/releases/comm-esr91/rev/bea1eb4e98a3>

|  | [Rob Lemley [:rjl]](/user_profile?user_id=63411) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1738501#a259610_63411)• 3 years ago |

[Attachment #9248766](/attachment.cgi?id=9248766&action=edit "fix-symbols.patch") -
Flags: review?(rob) → review+

|  | [Pulsebot](/user_profile?user_id=510726) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1738501#c15)• 3 years ago |
|  | |

Pushed by mkmelin@iki.fi:
<https://hg.mozilla.org/comm-central/rev/a0e693ab8bee>
follow-up - clang-format. rs=clang-format

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1738501#c16)• 3 years ago |
|  | |

Assigning [CVE-2021-43529](https://www.cve.org/CVERecord?id=CVE-2021-43529). Since this happened to protect Thunderbird users from the worst effects of [bug 1737470](/show_bug.cgi?id=1737470 "RESOLVED FIXED - Memory Corruption in decodeECorDsaSignature with DSA signatures (and RSA-PSS)") it's effectively a security fix.

Alias: CVE-2021-43529Blocks: [CVE-2021-43527](/show_bug.cgi?id=1737470 "RESOLVED FIXED - Memory Corruption in decodeECorDsaSignature with DSA signatures (and RSA-PSS)")

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1738501#a2835327_1689)• 3 years ago |

No longer blocks: [CVE-2021-43527](/show_bug.cgi?id=1737470 "RESOLVED FIXED - Memory Corruption in decodeECorDsaSignature with DSA signatures (and RSA-PSS)")Depends on: [CVE-2021-43527](/show_bug.cgi?id=1737470 "RESOLVED FIXED - Memory Corruption in decodeECorDsaSignature with DSA signatures (and RSA-PSS)")

|  | [Kai Engert [:KaiE:]](/user_profile?user_id=36541)  Assignee |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1738501#c17)• 3 years ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1738501&comment_id=15679854 "1 revision") |
|  | |

Suggested advisory text:

```
CVE-2021-43529:
     title:  Memory corruption when processing S/MIME messages
     impact: critical
     reporter: Tavis Ormandy
     description: |
       Thunderbird versions prior to 91.3.0 are vulnerable to the heap
overflow described in CVE-2021-43527 when processing S/MIME messages.
Thunderbird versions 91.3.0 and later will not call the vulnerable code
when processing S/MIME messages that contain certificates with
DER-encoded DSA or RSA-PSS signatures.
     bugs:
       - url: 1738501

```
Flags: needinfo?(dveditz)Keywords: [sec-critical](/buglist.cgi?keywords=sec-critical&resolution=---)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1738501#c18)• 3 years ago |
|  | |

That sounds pretty good.

Flags: needinfo?(dveditz)

|  | [Kai Engert [:KaiE:]](/user_profile?user_id=36541)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1738501#a12502938_36541)• 3 years ago |

See Also: → [1738592](/show_bug.cgi?id=1738592 "NEW - Allow NSS S/MIME code to call application defined certificate verification functions")
You need to [log in](/show_bug.cgi?id=1738501&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Kai Engert [:KaiE:]](/user_profile?user_id=36541)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review


