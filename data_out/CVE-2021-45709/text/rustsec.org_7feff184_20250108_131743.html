

RUSTSEC-2021-0121: crypto2: Non-aligned u32 read in Chacha20 encryption and decryption › RustSec Advisory Database

#

[About](/)
[Advisories](/advisories/)
[Report Vulnerabilities](/contributing.html)

[History](https://github.com/RustSec/advisory-db/commits/main/crates/crypto2/RUSTSEC-2021-0121.md) ⋅
[Edit](https://github.com/RustSec/advisory-db/edit/main/crates/crypto2/RUSTSEC-2021-0121.md) ⋅
[JSON (OSV)](https://api.osv.dev/v1/vulns/RUSTSEC-2021-0121)

# RUSTSEC-2021-0121

Non-aligned u32 read in Chacha20 encryption and decryption

Reported
October 8, 2021

Issued
October 18, 2021

(last modified: June 13, 2023)

Package
[crypto2](/packages/crypto2.html)
([crates.io](https://crates.io/crates/crypto2))

Type
INFO
Unsound

Keywords
[#crypto](/keywords/crypto.html)
[#alignment](/keywords/alignment.html)
[#unsound](/keywords/unsound.html)

Aliases

* [CVE-2021-45709](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-45709)
* [GHSA-9hfg-pxr6-q4vp](https://github.com/advisories/GHSA-9hfg-pxr6-q4vp)
* [GHSA-pmcv-mgcf-rvxg](https://github.com/advisories/GHSA-pmcv-mgcf-rvxg)

References

* <https://github.com/shadowsocks/crypto2/issues/27>

Patched
no patched versions

Affected Functions
Version
`crypto2::streamcipher::Chacha20::decrypt_slice`

* `*`

`crypto2::streamcipher::Chacha20::encrypt_slice`

* `*`

`crypto2::streamcipher::xor_si512_inplace`

* `*`

### Description

The implementation does not enforce alignment requirements on input slices while incorrectly assuming 4-byte alignment through an unsafe call to `std::slice::from_raw_parts_mut`, which breaks the contract and introduces undefined behavior.

This affects Chacha20 encryption and decryption in crypto2.

Advisory available under [CC0-1.0](https://spdx.org/licenses/CC0-1.0.html)
license.

