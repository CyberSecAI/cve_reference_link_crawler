```
{
  "vulnerability": {
    "root_cause": "The `vmemmap` was not correctly offset in the RISC-V architecture when `CONFIG_SPARSEMEM_VMEMMAP` was enabled. It was defined as `((struct page *)VMEMMAP_START)` without considering the physical RAM base address.",
    "weaknesses": [
      "Incorrect calculation of `vmemmap` address",
      "Out-of-bounds access risk during `pfn_to_page()` and `page_to_pfn()` operations when `CONFIG_SPARSEMEM_VMEMMAP` is enabled."
    ],
    "impact": "Incorrect address calculations within the kernel when using `pfn_to_page()` and `page_to_pfn()` which can lead to out-of-bounds memory access.",
     "attack_vectors": [
       "Exploiting incorrect address calculations within the kernel"
    ],
    "required_capabilities": [
      "Ability to trigger `pfn_to_page()` and `page_to_pfn()` operations with crafted page frame numbers (PFNs) on RISC-V architecture with `CONFIG_SPARSEMEM_VMEMMAP` enabled."
    ]
  },
    "fix": {
        "description": "The `vmemmap` definition was corrected to  `((struct page *)VMEMMAP_START - (phys_ram_base >> PAGE_SHIFT))` to correctly offset it by the base address of physical RAM.",
    "file_changes": [
        {
            "file": "arch/riscv/include/asm/pgtable.h",
            "change_type": "modified",
            "details": "The definition of `vmemmap` was changed to include the offset `(phys_ram_base >> PAGE_SHIFT)` to adjust its virtual address. From `#define vmemmap ((struct page *)VMEMMAP_START)` to `#define vmemmap ((struct page *)VMEMMAP_START - (phys_ram_base >> PAGE_SHIFT))`. This ensures that the first page of the vmemmap is mapped to the first page of physical memory."
        }
      ]
    }
}
```