<!DOCTYPE html>
<html lang="en-us">
    
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="theme-color" content="dark">
    <title> CVE-2022-29603: High-Severity SQL Injection Vulnerability in UniverSIS | Notes from Underground</title>
    
    
    
    <link rel="stylesheet" href="/blog/sass/main.min.b81b77bfef641cdef5a77f4a7bb221547def6cea9b73ab29b5fed4c98707f2a8.css">
    <link rel="stylesheet" href="https://suumcuique.org/blog/css/align.css">
</head>


    <body class="dark">
        <nav class="navbar">
    <div class="container">
        <div class="flex">
            <div>
                <a class="brand" href="/">
                    
                    Notes from Underground
                    </a>
            </div>
            <div class="flex">
                
                <button id="dark-mode-button"></button>
            </div>
            </div>
    </div>
</nav>
        <main>
            

<div class="container">
    <article>
        <header class="article-header">
            <div class="thumb">
                <div>
                    <h1>CVE-2022-29603: High-Severity SQL Injection Vulnerability in UniverSIS</h1>
                    <div class="post-meta">
                        <div>
                            By Stavros Mekesis on <time>April 24, 2022</time>
                        </div>
                        <div class="tags">
                            
                        </div>
                    </div>
                </div>
            </div>
        </header>
    </article>

    <div class="article-post">
    <p>CVE-ID: <a href="https://nvd.nist.gov/vuln/detail/CVE-2022-29603">CVE-2022-29603</a><br>
Affected Products: <a href="https://gitlab.com/universis/universis-api">UniverSIS-API</a> versions prior to commit <a href="https://gitlab.com/universis/universis-api/-/commit/39e47d7f4654c83296b8de61b243b510c375d3fb">39e47d7f</a>
<br>
Class: Improper Neutralization of Special Elements used in an SQL Command (&lsquo;SQL Injection&rsquo;) (<a href="https://cwe.mitre.org/data/definitions/89.html">CWE-89</a>)
<br>
Discovered by: Stavros Mekesis</p>
<h2 id="vulnerability-details">Vulnerability Details</h2>
<p>An SQL Injection vulnerability exists in <a href="https://gitlab.com/universis/universis-api">UniverSIS-API</a> versions prior to commit <a href="https://gitlab.com/universis/universis-api/-/commit/39e47d7f4654c83296b8de61b243b510c375d3fb">39e47d7f</a> via the <code>$select</code> parameter in multiple API endpoints due to improper validation of user-supplied input to the <code>$select</code> parameter. A remote authenticated attacker could send specially crafted SQL statements to a vulnerable UniverSIS API endpoint (e.g. <code>/api/students/me/messages/</code>) using the <code>$select</code> parameter, which could allow the attacker to view, add, modify or delete information in the back-end database.</p>
<h3 id="proof-of-concept">Proof of Concept</h3>
<p>SQL injection can be detected manually by submitting the single quote character (&rsquo;) and looking for errors or other anomalies (see Fig. 1).</p>
<figure>
    <img src="https://i.imgur.com/j9oi7Rm.png" alt="Verifying that the $select parameter is vulnerable to SQL Injection">
    <figcaption>Fig. 1. Verifying that the $select parameter is vulnerable to SQL Injection.</figcaption>
</figure>
<p>A remote authenticated attacker can leverage the SQL injection vulnerability to retrieve data from other tables within the database. For example, the following request will cause the application to return all IDs, given names, family names, father&rsquo;s names, mother&rsquo;s names, Social Security numbers, home addresses, home phones, and mobile phones from the <code>PersonData</code> table (see Fig. 2).</p>
<figure>
    <img src="https://i.imgur.com/KFdN1e6.png" alt="Retrieving sensitive personal data from the PersonData table">
    <figcaption>Fig. 2. Retrieving sensitive personal data from the PersonData table. NOTE: The <a href="https://students.universis.io/">'demo' application</a> uses <a href="https://en.wikipedia.org/wiki/Dummy_data">dummy data</a>.</figcaption>
</figure>
<p>Also, the attacker can leverage the SQL injection vulnerability to modify information in the back-end database. For example, the following request will cause the application to change the thesis grade for Μιχαλόπουλος Αντώνιος (<a href="mailto:student7@example.com">student7@example.com</a>) to &ldquo;10&rdquo; (see Fig. 3–5).</p>
<figure>
    <img src="https://i.imgur.com/1dlqQNi.png" alt="Changing the thesis grade for Μιχαλόπουλος Αντώνιος (student7@example.com) to 10.">
    <figcaption>Fig. 3. Changing the thesis grade for Μιχαλόπουλος Αντώνιος (student7@example.com) to "10".</figcaption>
</figure>
<figure>
    <img src="https://i.imgur.com/xLCeEwA.png" alt="The thesis grade before and after the SQL Injection attack">
    <figcaption>Fig. 4. The thesis grade before the SQL Injection attack.</figcaption>
</figure>
<figure>
    <img src="https://i.imgur.com/3SG0oNF.png" alt="The thesis grade before the SQL Injection attack">
    <figcaption>Fig. 5. The thesis grade after the SQL Injection attack.</figcaption>
</figure>
<h2 id="remediation">Remediation</h2>
<p>UniverSIS has released a <a href="https://gitlab.com/universis/universis-api/-/commit/39e47d7f4654c83296b8de61b243b510c375d3fb">patch</a> for this vulnerability on GitLab. Please apply the patch as soon as possible.</p>
<h2 id="responsible-disclosure-timeline">Responsible Disclosure Timeline</h2>
<p>Vendor Contact: April 17, 2022<br>
Vendor Fix Released: April 18, 2022<br>
Public Advisory: April 24, 2022<br>
CVE Allocation: April 25, 2022</p>
<h2 id="in-the-news">In the News</h2>
<p>&ldquo;<a href="https://portswigger.net/daily-swig/student-grades-stored-in-greek-education-platform-universis-could-be-manipulated-via-sqli">Student grades stored in Greek education platform UniverSIS could be manipulated via SQLi</a>.&rdquo; The Daily Swig (<a href="https://portswigger.net">PortSwigger</a>).</p>

    </div>
</div>

<div class="container">
    
    <nav class="flex container suggested">
        
        <a rel="prev" href="/blog/posts/information-disclosure-vulnerability-universis/" title="Previous post (older)">
            <span>Previous</span>
            CVE-2022-28924: Sensitive Information Disclosure Vulnerability in UniverSIS
            </a>
        
        
        
        <a rel="next" href="/blog/posts/interview-portswigger-the-daily-swig/" title="Next post (newer)">
            <span>Next</span>
            Interview: Student grades stored in Greek education platform UniverSIS could be manipulated via SQLi
            </a> 
        
    </nav>
    
</div>
</main>


        </main>
        <footer class="footer flex">
    <section class="container">
        <nav class="footer-links">
            
        </nav>
    </section>
    
    
    <script async src="/blog/js/features.min.fdb064613b89cfdaaa43fcf86c021408578dd158cf0accad7cc50e1913005d12.js"></script>
</footer>

    </body>
</html>