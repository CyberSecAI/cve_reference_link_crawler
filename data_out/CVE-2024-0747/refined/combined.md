=== Content from www.mozilla.org_3a71a3b3_20250111_082943.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, weâ€™d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured â€” we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    #### Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [#### Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    #### Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    #### Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    #### Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    #### Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    #### MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    #### Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    #### Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [#### About Mozilla](/en-US/about/)
  + [#### The Mozilla Manifesto](/en-US/about/manifesto/)
  + [#### Get Involved](/en-US/contribute/)
  + [#### Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [#### Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2024-04

## Security Vulnerabilities fixed in Thunderbird 115.7

Announced
January 23, 2024
Impact
high
Products
Thunderbird
Fixed in

* Thunderbird 115.7

*In general, these flaws cannot be exploited through email in the Thunderbird product because scripting is disabled when reading mail, but are potentially risks in browser or browser-like contexts.*

#### [#CVE-2024-0741: Out of bounds write in ANGLE](#CVE-2024-0741)

Reporter
Renan Rios
Impact
high
##### Description

An out of bounds write in ANGLE could have allowed an attacker to corrupt memory leading to a potentially exploitable crash.

##### References

* [Bug 1864587](https://bugzilla.mozilla.org/show_bug.cgi?id=1864587)

#### [#CVE-2024-0742: Failure to update user input timestamp](#CVE-2024-0742)

Reporter
Andrew McCreight
Impact
high
##### Description

It was possible for certain browser prompts and dialogs to be activated or dismissed unintentionally by the user due to an incorrect timestamp used to prevent input after page load.

##### References

* [Bug 1867152](https://bugzilla.mozilla.org/show_bug.cgi?id=1867152)

#### [#CVE-2024-0746: Crash when listing printers on Linux](#CVE-2024-0746)

Reporter
Cornel Ionce
Impact
moderate
##### Description

A Linux user opening the print preview dialog could have caused the browser to crash.

##### References

* [Bug 1660223](https://bugzilla.mozilla.org/show_bug.cgi?id=1660223)

#### [#CVE-2024-0747: Bypass of Content Security Policy when directive unsafe-inline was set](#CVE-2024-0747)

Reporter
Seongil Wi
Impact
moderate
##### Description

When a parent page loaded a child in an iframe with `unsafe-inline`, the parent Content Security Policy could have overridden the child Content Security Policy.

##### References

* [Bug 1764343](https://bugzilla.mozilla.org/show_bug.cgi?id=1764343)

#### [#CVE-2024-0749: Phishing site popup could show local origin in address bar](#CVE-2024-0749)

Reporter
Kestrel
Impact
moderate
##### Description

A phishing site could have repurposed an `about:` dialog to show phishing content with an incorrect origin in the address bar.

##### References

* [Bug 1813463](https://bugzilla.mozilla.org/show_bug.cgi?id=1813463)

#### [#CVE-2024-0750: Potential permissions request bypass via clickjacking](#CVE-2024-0750)

Reporter
Hafiizh
Impact
moderate
##### Description

A bug in popup notifications delay calculation could have made it possible for an attacker to trick a user into granting permissions.

##### References

* [Bug 1863083](https://bugzilla.mozilla.org/show_bug.cgi?id=1863083)

#### [#CVE-2024-0751: Privilege escalation through devtools](#CVE-2024-0751)

Reporter
Rob Wu
Impact
moderate
##### Description

A malicious devtools extension could have been used to escalate privileges.

##### References

* [Bug 1865689](https://bugzilla.mozilla.org/show_bug.cgi?id=1865689)

#### [#CVE-2024-0753: HSTS policy on subdomain could bypass policy of upper domain](#CVE-2024-0753)

Reporter
Hanno BÃ¶ck
Impact
moderate
##### Description

In specific HSTS configurations an attacker could have bypassed HSTS on a subdomain.

##### References

* [Bug 1870262](https://bugzilla.mozilla.org/show_bug.cgi?id=1870262)

#### [#CVE-2024-0755: Memory safety bugs fixed in Firefox 122, Firefox ESR 115.7, and Thunderbird 115.7](#CVE-2024-0755)

Reporter
Daniel Holbert, Andrew Osmond, and the Mozilla Fuzzing Team
Impact
moderate
##### Description

Memory safety bugs present in Firefox 121, Firefox ESR 115.6, and Thunderbird 115.6. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 122, Firefox ESR 115.7, and Thunderbird 115.7](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1868456%2C1871445%2C1873701)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporationâ€™s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are Â©1998â€“2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from lists.debian.org_e97caf08_20250111_082941.html ===


---

[[Date Prev](msg00014.html)][[Date Next](msg00016.html)]
[[Thread Prev](msg00014.html)][[Thread Next](msg00016.html)]
[[Date Index](maillist.html#00015)]
[[Thread Index](threads.html#00015)]

# [SECURITY] [DLA 3720-1] thunderbird security update

---

* *To*: <debian-lts-announce@lists.debian.org>
* *Subject*: [SECURITY] [DLA 3720-1] thunderbird security update
* *From*: Emilio Pozuelo Monfort <pochu@debian.org>
* *Date*: Thu, 25 Jan 2024 11:49:57 +0100 (CET)
* *Message-id*: <[[ðŸ”Ž]](/msgid-search/20240125104957.8D75D2AB5D4%40andromeda)Â [20240125104957.8D75D2AB5D4@andromeda](msg00015.html)>
* *Mail-followup-to*: debian-lts@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

- -------------------------------------------------------------------------
Debian LTS Advisory DLA-3720-1                debian-lts@lists.debian.org
<https://www.debian.org/lts/security/>               Emilio Pozuelo Monfort
January 25, 2024                              <https://wiki.debian.org/LTS>
- -------------------------------------------------------------------------

Package        : thunderbird
Version        : 1:115.7.0-1~deb10u1
CVE ID         : CVE-2024-0741 CVE-2024-0742 CVE-2024-0746 CVE-2024-0747
                 CVE-2024-0749 CVE-2024-0750 CVE-2024-0751 CVE-2024-0753
                 CVE-2024-0755

Multiple security issues were discovered in Thunderbird, which could
result in denial of service or the execution of arbitrary code.

For Debian 10 buster, these problems have been fixed in version
1:115.7.0-1~deb10u1.

We recommend that you upgrade your thunderbird packages.

For the detailed security status of thunderbird please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/thunderbird>

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>
-----BEGIN PGP SIGNATURE-----

iQIzBAEBCAAdFiEEcJymx+vmJZxd92Q+nUbEiOQ2gwIFAmWyPNUACgkQnUbEiOQ2
gwJUfBAAii62ZY/Ii3bdR/NHircg99wh+aBQpFQqQaDmuobl3h3PuNttJvBF6xfV
bgUKzv224LAlADMmxK05h3nvuCmYvu+wsx58EekwEJlTGI7ED7zDqKx9UUrxPMwX
Ojl5aSfI6RYbw5lQ/NcyI/NOGdU3ds21xadbKkDG8h2iKxpVcTXTpqpFOqToCDax
FHChrj1FeNJADuL+w4w7Eice2+I2ArgvsAGkMuLH2CxG9gdQMon05eOwL571bU1+
MqueuTY1T9tFZC+7+Q2qxixorw4p/AMV3xXl1zAfb1cCx8wOKXt/86ElgyRyc14X
eIDcPh9o98bnyU30fVYViGYAzIEmJ5+CcPkXOcI0YIF41krOHSSnptmOE8Hxj9h+
deiUjHLAKQ6Ncyu/jnCltrSeFvRnfamagh9B28VMyV2Q/gY/LC3yzzfYgsBVGfmT
jjNgPWU2IoUSzyfqz8kPyqRffTj3kDDlVkdJc2afobkpcx88afxYXO+x95ilcVYv
I+rgsjU4BKitdA0GcXiC8JMcFulrZZg9un6zfMZjYipPlJX6x2XEllwpUv30IdiT
wGlKUeC04jrD9X2kxTCdijAKIZJMRJzspuHERgLWEOmJSo9k1zlbFxPzrVq5RgTk
mwkkF9Lvgy7PrnuvkDmcYwSx9FEHb+D6dMM8e/UiRwZu3s3R150=
=fQo/
-----END PGP SIGNATURE-----

```

---



=== Content from bugzilla.mozilla.org_c0ed9e72_20250111_082941.html ===


![](/static/v20250108.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  Â·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summaryâ–¾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View â–¾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1764343)
* [XML](/show_bug.cgi?ctype=xml&id=1764343)

Closed
[Bug 1764343](/show_bug.cgi?id=1764343)
(CVE-2024-0747)

Opened 3 years ago
Closed 1 year ago

# iframe CSP bypass via "unsafe-inline" script in parent frame despite iframe CSP having `default-src: none`

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

iframe CSP bypass via "unsafe-inline" script in parent frame despite iframe CSP having `default-src: none`

## Categories

### (Core :: DOM: Security, defect, P3)

[Product:](/describecomponents.cgi?product=Core)

Core
â–¾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=DOM%3A%20Security#DOM%3A%20Security)

DOM: Security
â–¾

Core :: DOM: Security
Native content-based security features including: Content Security Policy (CSP), Mixed Content Blocker (MCB), and Safe Browsing.
[See Open Bugs in This Component](/buglist.cgi?product=Core&component=DOM%3A%20Security&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=DOM%3A%20Security&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=DOM%3A%20Security)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

Firefox 99

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

P3

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

S3

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

122 Branch

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Performance Impact | --- |
| --- | --- |
| Webcompat Score | --- |
| a11y-review | --- |
| Webcompat Priority | --- |
| Accessibility Severity | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr115 | [122+](/buglist.cgi?f1=cf_tracking_firefox_esr115&o1=equals&v1=122%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=fixed) |
| firefox120 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox120&o1=equals&v1=wontfix) |
| firefox121 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox121&o1=equals&v1=wontfix) |
| firefox122 | [+](/buglist.cgi?f1=cf_tracking_firefox122&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox122&o1=equals&v1=fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr115 | 122+ | fixed |
| firefox-esr128 | --- | --- |
| firefox120 |  | wontfix |
| firefox121 |  | wontfix |
| firefox122 | + | fixed |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: su3604, Assigned: tschuster)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/643f0847a3bf01b6ac23263f1661d14e?d=mm&size=40)  [tschuster](/user_profile?user_id=703078)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/39a51f1bd5937c86ff3c351c00a569ad?d=mm&size=40)  [su3604](/user_profile?user_id=697459)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/1f41f3ef916e1c1fc9401cf3212a6708?d=mm&size=40)  [freddy](/user_profile?user_id=428608)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

11 people

## References

### (Blocks 1 open bug)

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

[1869940](/show_bug.cgi?id=1869940 "RESOLVED FIXED - Perma [tier 2] TEST-UNEXPECTED-PASS /content-security-policy/unsafe-eval/eval-blocked-in-about-blank-iframe.html | single tracking bug")

[csp-w3c-3](/show_bug.cgi?id=1231788 "NEW - [meta] Implement Content Security Policy 3.0 per the W3C standard (csp-w3c-3)")

Dependency [tree](/showdependencytree.cgi?id=1764343&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=1764343)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Keywords: sec-moderate, Whiteboard: [adv-main122+][adv-esr115.7+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2024-0747

[Keywords:](/describekeywords.cgi)

[sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[adv-main122+][adv-esr115.7+]

QA Whiteboard:

[post-critsmash-triage]

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [RyanVM](/user_profile?user_id=75935) | [in-testsuite](#a52744574_75935 "1 year ago") | + |
| --- | --- | --- |
| [RyanVM](/user_profile?user_id=75935) | in-testsuite | + |
| --- | --- | --- |
| [avaida](/user_profile?user_id=488993) | [qe-verify](#a53461255_488993 "1 year ago") | - |
| --- | --- | --- |
| [avaida](/user_profile?user_id=488993) | qe-verify | - |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (3 files)

| [Bug 1764343 - Remove steps in Document::Open not derived from spec; r=dveditz](/attachment.cgi?id=9357678)  [1 year ago](#c9)  [June Wilde (she/her) [:jewilde]](/user_profile?user_id=626341)   48 bytes, text/x-phabricator-request |  | [Details](/attachment.cgi?id=9357678&action=edit) | [Review](/attachment.cgi?id=9357678) |
| --- | --- | --- |
| [Bug 1764343 - ESR115: Remove steps in Document::Open not derived from spec. r?dveditz](/attachment.cgi?id=9371286)  [1 year ago](#c21)  [Tom Schuster](/user_profile?user_id=703078)   48 bytes, text/x-phabricator-request | dmeehan : [approval-mozilla-esr115+](#c24 "1 year ago") | [Details](/attachment.cgi?id=9371286&action=edit) | [Review](/attachment.cgi?id=9371286) |
| [advisory.txt](/attachment.cgi?id=9373600)  [1 year ago](#c26)  [Jesse Schwartzentruber (:truber)](/user_profile?user_id=486733)   195 bytes, text/plain |  | [Details](/attachment.cgi?id=9373600&action=edit) |

Bottom â†“
Tags â–¾

* Reset

Timeline â–¾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | Multiple Authors |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1764343#c0)â€¢ 3 years ago â€¢ [Edited](/page.cgi?id=comment-revisions.html&bug_id=1764343&comment_id=15855904 "1 revision") |
|  | |

User Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10\_15\_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/100.0.4896.75 Safari/537.36

Steps to reproduce:

1. Set the following files on your web server.

```
<html>
    <head>
        <meta http-equiv="Content-Security-Policy" content="script-src 'unsafe-inline'">
    </head>
    <body>
        <iframe id=x src='self.html'></iframe>
        <script nonce=123>
            x.onload=_=>x.contentDocument.write('<script>alert(1)<\/script>');
        </script>
    </body>
</html>

```
```
<html>
    <head>
        <meta http-equiv="Content-Security-Policy" content="default-src 'none'">
    </head>
    <body>
    </body>
</html>

```

2. Go to the test.html page

Actual results:

The inline script written in the iframe is executed.

Expected results:

CSP is defined for each page. That is, when specifying a separate page (eg, self.html) other than the local scheme (<https://www.w3.org/TR/CSP3/#security-inherit-csp>) in the iframe src, the iframe must be affected by the corresponding CSP, not the parent CSP. However, I confirmed that the CSP of the parent page is inherited to another separate page when writing is performed by calling the x.contentDocument.write function in Firefox.

Although self.html should not allow inline script execution according to its CSP default-src 'none', an attacker can use the trick in this report to cause inline scripts to be executed in self.html environment.

|  | [Seongil Wi](/user_profile?user_id=697459)  Reporter |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1764343#c1)â€¢ 3 years ago |
|  | |

FYI, I've seen Chrome, Edge, and Safari correctly enforce the CSP of the child page in this case.

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1764343#a1370_159069)â€¢ 3 years ago |

Group: firefox-core-security â†’ dom-core-securityComponent: Untriaged â†’ DOM: SecurityProduct: Firefox â†’ CoreSummary: [CSP bypass] â†’ iframe CSP bypass via "unsafe-inline" script in parent frame despite iframe CSP having `default-src: none`

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1764343#a109373_1689)â€¢ 3 years ago |

Status: UNCONFIRMED â†’ NEWEver confirmed: trueKeywords: [sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1764343#c2)â€¢ 3 years ago |
|  | |

I'll take a couple of minutes later this week to better understand how and why the CSP is inherited.

Flags: needinfo?(fbraun)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1764343#c3)â€¢ 3 years ago |
|  | |

If the parent page had reached in and added an inline onclick handler or whatever, that should get blocked.

If the CSP were in the HTTP header it should have stuck around.

I think in this case (have not experimented yet), the document.write() implies a document.open() which blows away the current document (where the CSP was set in a META tag) and then you're left without a CSP. Maybe it would inherit from the parent, but that allows unsafe-ineline.

Freddy will investigate

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1764343#a3629732_1689)â€¢ 3 years ago |

Severity: -- â†’ S3Priority: -- â†’ P3Whiteboard: [domsecurity-backlog1]

|  | [Christoph Kerschbaumer [:ckerschb]](/user_profile?user_id=363267) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1764343#a3629765_363267)â€¢ 3 years ago |

Blocks: [csp-w3c-3](/show_bug.cgi?id=1231788 "NEW - [meta] Implement Content Security Policy 3.0 per the W3C standard (csp-w3c-3)")

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1764343#c4)â€¢ 3 years ago â€¢ [Edited](/page.cgi?id=comment-revisions.html&bug_id=1764343&comment_id=15914411 "1 revision") |
|  | |

OK, I took a moment to look at this. To reproduce this, I have modified the child document to have a big headline (`<h1>Child</h1>`) would suffice.

Loading the test case will verify Dan's assumption in [comment 3](/show_bug.cgi?id=1764343#c3 "RESOLVED FIXED - iframe CSP bypass via \"unsafe-inline\" script in parent frame despite iframe CSP having `default-src: none`"): The self.html document will be thrown away completely and the `document.write()` call creates a new one (the headline goes away). The new document doesn't have a `<meta>` CSP and the script will be allowed.

Contrary, if the parent script did the following instead:

```
s = x.contentDocument.createElement("script");
s.innerText = "alert(2)";
x.contentDocument.body.append(s);

```

Then the `<meta>` element would still be intact and therefore disallow the inline script:

> Content Security Policy: The pageâ€™s settings blocked the loading of a resource at inline (â€œdefault-srcâ€).

I *think* we can fix this as INVALID, but I'm happy to hear objections.

Flags: needinfo?(fbraun)

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1764343#c5)â€¢ 3 years ago |
|  | |

(In reply to Frederik Braun [:freddy] from [comment #4](/show_bug.cgi?id=1764343#c4 "RESOLVED FIXED - iframe CSP bypass via \"unsafe-inline\" script in parent frame despite iframe CSP having `default-src: none`"))

> I *think* we can fix this as INVALID, but I'm happy to hear objections.

(In reply to Seongil Wi from [comment #1](/show_bug.cgi?id=1764343#c1 "RESOLVED FIXED - iframe CSP bypass via \"unsafe-inline\" script in parent frame despite iframe CSP having `default-src: none`"))

> FYI, I've seen Chrome, Edge, and Safari correctly enforce the CSP of the child page in this case.

I'm curious why other browsers would behave differently here, if the spec says we're doing the right thing?

Flags: needinfo?(fbraun)

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1764343#c6)â€¢ 2 years ago |
|  | |

Huh, it looks like the CSP should be copied over but never is. Or does it copy it from the opener (instead of from the previous popup document?)

Maybe that changed with recent document/navigation changes?

<https://searchfox.org/mozilla-central/rev/b0844a16d60042c8e1e8f50465a89c1696d283fb/dom/base/Document.cpp#9535-9544>

I'll keep the needinfo to continue investigating. Sorry this has been taking so long.

I'm also CCing Tom who has done most of the recent CSP work. Not necessarily because I expect him to pick this up, but because I'm sure this will be interesting to him :)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1764343#c7)â€¢ 2 years ago |
|  | |

I believe this is a dupe of [bug 1754872](/show_bug.cgi?id=1754872 "NEW"), where both Mike West and Anne think the spec supports the Chrome behavior. document.open() is not creating an actual fresh "about:blank" document. They interpret <https://html.spec.whatwg.org/multipage/dynamic-markup-insertion.html#document-open-steps> as emptying out the document but then re-using it rather than creating a new document. That would preserve the "policy container" attributes including CSP.

|  | [June Wilde (she/her) [:jewilde]](/user_profile?user_id=626341) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1764343#c8)â€¢ 1 year ago |
|  | |

Similarly to what is happening in [Bug 1754872](/show_bug.cgi?id=1754872 "NEW"), when initially parsing and binding the `self.html` iframe's document we [parse the Meta tag CSP directives](https://searchfox.org/mozilla-central/rev/1865e9fba4166ab2aa6c9d539913115723d9cc53/dom/base/Document.cpp#11109) and apply them to the iframe's document.

Later, when we are in the implicit `document.open` we [inherit](https://searchfox.org/mozilla-central/rev/1865e9fba4166ab2aa6c9d539913115723d9cc53/dom/base/Document.cpp#9697) the opening document's CSP directives. We replace the existing DOM in the iframe's document with the `<script>` tag passed into the subsequent `document.write` call and when binding the `<script>` tag to the tree call [`CSPAllowsInlineScript`](https://searchfox.org/mozilla-central/rev/1865e9fba4166ab2aa6c9d539913115723d9cc53/dom/script/ScriptLoader.cpp#919) which in turn calls [`nsCSPContext::GetAllowsInline`](https://searchfox.org/mozilla-central/rev/1865e9fba4166ab2aa6c9d539913115723d9cc53/dom/security/nsCSPContext.cpp#606).

Here `mPolicies` has a single entry, which is the inherited `script-src 'unsafe-inline'` directive from the opening document, but doesn't retain the Meta tag CSP directive previously assigned from `self.html` so ultimately allows the script to run.

Based on both of these bugs and their test cases and comments it seems like inheriting the CSP directives from the opener isn't what we actually want for a same-origin iframe and that we should be inheriting the iframe's CSP directives from before calling `document.open`? Or is the current behavior what we want and compliant with the spec?

I'm not familiar with any of the relevant specs, however, so I'm needinfoing Tom S. and Christoph to help me with guidance. I'm also attaching the test case provided by Seongil as a mochitest to help debug if needed

Assignee: nobody â†’ jewildeStatus: NEW â†’ ASSIGNEDFlags: needinfo?(tschuster)Flags: needinfo?(fbraun)Flags: needinfo?(ckerschb)Whiteboard: [domsecurity-backlog1] â†’ [domsecurity-active]

|  | [June Wilde (she/her) [:jewilde]](/user_profile?user_id=626341) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1764343#c9)â€¢ 1 year ago |
|  | |

Attached file
[Bug 1764343 - Remove steps in Document::Open not derived from spec; r=dveditz](attachment.cgi?id=9357678)
â€” [Details](attachment.cgi?id=9357678&action=edit)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1764343#c10)â€¢ 1 year ago |
|  | |

right, we currently, ***incorrectly***, treat document.write() on an existing document (or more specifically, the implicit document.open() that happens on the first write) as if we navigated to "about:blank" and built a new document from scratch. At least, from the CSP and probably sandbox POV, if not in all HTML/DOM particulars.

These rules will apply to any two existing same-origin documents where a script running in one (AD for active document) modifies the other (TD for target document) through a window reference. Could be a parent document and an iframe, a window and a popup it opened, or a popup writing back into its opener. The Target Document will have policies associated with it, in this case we're talking about CSP, and those existing policies should be preserved; it should not inherit ANY policy from the AD that re-wrote it using document.write(), just as it wouldn't inherit anything if AD modified TD through pure DOM node deletion/creation.

If the newly written content has a <meta CSP> in it that gets parsed then that should be *added* to the list of TD policies, but we should not remove or replace any that already existed even if they were from <meta> tags instead of headers. If we allow document.write() to erase the policy we created from previous <meta> tag content then this could be used by a document to relax it's own CSP.

Flags: needinfo?(ckerschb)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1764343#c11)â€¢ 1 year ago |
|  | |

Our `Document::Open()` code that you reference in [comment 8](/show_bug.cgi?id=1764343#c8 "RESOLVED FIXED - iframe CSP bypass via \"unsafe-inline\" script in parent frame despite iframe CSP having `default-src: none`") has comments aligning each bit of code with a step of the spec -- except the bit you pointed to! Clearly that was added to solve some inheritance problem we were having, but it's causing this one. We can't simply remove it without figuring out why it was there initially. Is this where we inherit policies because fresh "about:blank" documents happen to go through here too? If so it should be moved to some earlier document creation time. Or maybe we've done it there, too, by now and this is "extra"?

Likewise, the placement of this securityInfo bit is suspicious:

<https://searchfox.org/mozilla-central/rev/1865e9fba4166ab2aa6c9d539913115723d9cc53/dom/base/Document.cpp#9806-9808>

That, too, looks like something that should happen on document creation, not document.open(), and not get reset when manipulated from the outside. I think it's not harmful here since this can only happen in a same-origin scenario, but I can imagine some edge-case scenarios where the values would be technically wrong (but not meaningfully so). for example: Long-lived tab where, after putting your laptop to sleep and commuting home, you interact with framed content in a way that causes a same-site navigation or reload. Maybe one of those locations uses a MITM security proxy (Enterprise middlebox, or home anti-virus scanning) so you'd get a different certificate chain and ciphersuite details. Wouldn't be that important -- presumably you'd get the same values for the parent page if you had refreshed it.

Mostly I mention it because it seems to come from the same mental-model as the CSP inheritance problem we're having, and may mean there wasn't a better place for it at the time. Hopefully there is now, but if not you may need to create one.

|  | [June Wilde (she/her) [:jewilde]](/user_profile?user_id=626341) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1764343#c12)â€¢ 1 year ago |
|  | |

I've updated the patch to remove [that block of code in `Document::Open`](https://searchfox.org/mozilla-central/rev/1865e9fba4166ab2aa6c9d539913115723d9cc53/dom/base/Document.cpp#9697) which seems to most likely have been code that either got duplicated or inadvertently left behind in past refactors of the CSP code. I believe it was once doing what [this code block](https://searchfox.org/mozilla-central/rev/1865e9fba4166ab2aa6c9d539913115723d9cc53/dom/base/Document.cpp#3759) is doing now, although trying to track it down past the changes from [Bug 965637](/show_bug.cgi?id=965637 "RESOLVED FIXED - Move CSP from nsIPrincipal into the Client") has been near impossible.

I've also tested these changes out pretty extensively on try which only came back with known intermittents. The last thing I need to do is write some more comprehensive tests and then this will be ready for review! Thanks Dan for your help, I greatly appreciate it

|  | [Tom Schuster](/user_profile?user_id=703078)  Assignee |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1764343#c13)â€¢ 1 year ago |
|  | |

I wasn't really aware of how document.write works (yuck!). It seems a bit unfortunate that we are going to start relying on that apparently non-standard behavior with about:blank, which is what makes `CSP_ShouldResponseInheritCSP` return true.

Flags: needinfo?(tschuster)

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1764343#a47450231_600971)â€¢ 1 year ago |

[Attachment #9357678](/attachment.cgi?id=9357678&action=edit "Bug 1764343 - Remove steps in Document::Open not derived from spec; r=dveditz") -
Attachment description: WIP: Bug 1764343 - CSP inheritance from document.write; â†’ Bug 1764343 - Remove steps in Document::Open not derived from spec; r=dveditz

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1764343#a49227156_428608)â€¢ 1 year ago |

Assignee: jewilde â†’ nobodyStatus: ASSIGNED â†’ NEWWhiteboard: [domsecurity-active]

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1764343#c14)â€¢ 1 year ago |
|  | |

> It seems a bit unfortunate that we are going to start relying on that apparently non-standard behavior with about:blank

document.open()/write() is historical behavior that the WHATWG has very much attempted to document/standardize.

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1764343#c15)â€¢ 1 year ago |
|  | |

It seems this is reviewed and ready to go. I don't recall what was keeping us from landing? Maybe a green try run?

Can you kick this over the finish line, Tom?

Flags: needinfo?(tschuster)

|  | [Tom Schuster](/user_profile?user_id=703078)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1764343#a51480643_703078)â€¢ 1 year ago |

Assignee: nobody â†’ tschusterFlags: needinfo?(tschuster)

|  | [Tom Schuster](/user_profile?user_id=703078)  Assignee |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1764343#c16)â€¢ 1 year ago |
|  | |

Looks like the tests need to be updated still.

|  | [Tom Schuster](/user_profile?user_id=703078)  Assignee |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1764343#c17)â€¢ 1 year ago |
|  | |

Please have a look at the review.

Flags: needinfo?(dveditz)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1764343#a52679237_1689)â€¢ 1 year ago |

Flags: needinfo?(dveditz)

|  | [Pulsebot](/user_profile?user_id=510726) |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1764343#c18)â€¢ 1 year ago |
|  | |

Pushed by tschuster@mozilla.com:
<https://hg.mozilla.org/integration/autoland/rev/5bfc7845071c>
Remove steps in Document::Open not derived from spec; r=dveditz

|  | [Donal Meehan [:dmeehan]](/user_profile?user_id=695136) |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1764343#c19)â€¢ 1 year ago â€¢ [Edited](/page.cgi?id=comment-revisions.html&bug_id=1764343&comment_id=16710654 "1 revision") |
|  | |

<https://hg.mozilla.org/mozilla-central/rev/5bfc7845071c>

Group: dom-core-security â†’ core-security-releaseStatus: NEW â†’ RESOLVEDClosed: 1 year ago
[status-firefox122](/buglist.cgi?f1=cf_status_firefox122&o1=isnotempty):
--- â†’ [fixed](/buglist.cgi?f1=cf_status_firefox122&o1=equals&v1=fixed)Resolution: --- â†’ FIXEDTarget Milestone: --- â†’ 122 Branch

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1764343#a52744574_75935)â€¢ 1 year ago |

[status-firefox120](/buglist.cgi?f1=cf_status_firefox120&o1=isnotempty):
--- â†’ [wontfix](/buglist.cgi?f1=cf_status_firefox120&o1=equals&v1=wontfix)
[status-firefox121](/buglist.cgi?f1=cf_status_firefox121&o1=isnotempty):
--- â†’ [wontfix](/buglist.cgi?f1=cf_status_firefox121&o1=equals&v1=wontfix)
[status-firefox-esr115](/buglist.cgi?f1=cf_status_firefox_esr115&o1=isnotempty):
--- â†’ [affected](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=affected)
[tracking-firefox122](/buglist.cgi?f1=cf_tracking_firefox122&o1=isnotempty):
--- â†’ [+](/buglist.cgi?f1=cf_tracking_firefox122&o1=equals&v1=%2B)
[tracking-firefox-esr115](/buglist.cgi?f1=cf_tracking_firefox_esr115&o1=isnotempty):
--- â†’ [122+](/buglist.cgi?f1=cf_tracking_firefox_esr115&o1=equals&v1=122%2B)Flags: in-testsuite+

|  | [Tom Schuster](/user_profile?user_id=703078)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1764343#a52860680_703078)â€¢ 1 year ago |

Blocks: [1869940](/show_bug.cgi?id=1869940 "RESOLVED FIXED - Perma [tier 2] TEST-UNEXPECTED-PASS /content-security-policy/unsafe-eval/eval-blocked-in-about-blank-iframe.html | single tracking bug")

|  | [Andrei Vaida [:avaida]](/user_profile?user_id=488993) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1764343#a53461255_488993)â€¢ 1 year ago |

QA Whiteboard: [post-critsmash-triage]Flags: qe-verify-

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1764343#c20)â€¢ 1 year ago |
|  | |

Is this ready for an ESR approval request?

Flags: needinfo?(tschuster)

|  | [Tom Schuster](/user_profile?user_id=703078)  Assignee |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=1764343#c21)â€¢ 1 year ago |
|  | |

Attached file
[Bug 1764343 - ESR115: Remove steps in Document::Open not derived from spec. r?dveditz](attachment.cgi?id=9371286)
â€” [Details](attachment.cgi?id=9371286&action=edit)

|  | [Donal Meehan [:dmeehan]](/user_profile?user_id=695136) |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=1764343#c22)â€¢ 1 year ago |
|  | |

Any concerns with an ESR approval request?

115.7esr builds next week.

|  | [Tom Schuster](/user_profile?user_id=703078)  Assignee |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=1764343#c23)â€¢ 1 year ago |
|  | |

Comment on [attachment 9371286](/attachment.cgi?id=9371286 "Bug 1764343 - ESR115: Remove steps in Document::Open not derived from spec. r?dveditz") [[details]](/attachment.cgi?id=9371286&action=edit "Bug 1764343 - ESR115: Remove steps in Document::Open not derived from spec. r?dveditz")

[Bug 1764343](/show_bug.cgi?id=1764343 "RESOLVED FIXED - iframe CSP bypass via \"unsafe-inline\" script in parent frame despite iframe CSP having `default-src: none`") - ESR115: Remove steps in Document::Open not derived from spec. r?dveditz

### ESR Uplift Approval Request

* **If this is not a sec:{high,crit} bug, please state case for ESR consideration**: CSP is not properly being applied and could allow (among others) unexpected script execution on websites.
* **User impact if declined**:
* **Fix Landed on Version**: 122
* **Risk to taking this patch**: Low
* **Why is the change risky/not risky? (and alternatives if risky)**: On Beta already and matches (tested) Chrome behavior.
Flags: needinfo?(tschuster)
[Attachment #9371286](/attachment.cgi?id=9371286&action=edit "Bug 1764343 - ESR115: Remove steps in Document::Open not derived from spec. r?dveditz") -
Flags: approval-mozilla-esr115?

|  | [Donal Meehan [:dmeehan]](/user_profile?user_id=695136) |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=1764343#c24)â€¢ 1 year ago |
|  | |

Comment on [attachment 9371286](/attachment.cgi?id=9371286 "Bug 1764343 - ESR115: Remove steps in Document::Open not derived from spec. r?dveditz") [[details]](/attachment.cgi?id=9371286&action=edit "Bug 1764343 - ESR115: Remove steps in Document::Open not derived from spec. r?dveditz")

[Bug 1764343](/show_bug.cgi?id=1764343 "RESOLVED FIXED - iframe CSP bypass via \"unsafe-inline\" script in parent frame despite iframe CSP having `default-src: none`") - ESR115: Remove steps in Document::Open not derived from spec. r?dveditz

Approved for 115.7esr.

[Attachment #9371286](/attachment.cgi?id=9371286&action=edit "Bug 1764343 - ESR115: Remove steps in Document::Open not derived from spec. r?dveditz") -
Flags: approval-mozilla-esr115? â†’ approval-mozilla-esr115+

|  | [Pulsebot](/user_profile?user_id=510726) |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=1764343#c25)â€¢ 1 year ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-esr115/rev/d4bec049e2f0>

|  | [Donal Meehan [:dmeehan]](/user_profile?user_id=695136) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1764343#a55563768_695136)â€¢ 1 year ago |

[status-firefox-esr115](/buglist.cgi?f1=cf_status_firefox_esr115&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=affected) â†’ [fixed](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=fixed)

|  | [Jesse Schwartzentruber (:truber)](/user_profile?user_id=486733) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1764343#a55747489_486733)â€¢ 1 year ago |

Whiteboard: [adv-main122+][adv-esr115.7+]

|  | [Jesse Schwartzentruber (:truber)](/user_profile?user_id=486733) |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=1764343#c26)â€¢ 1 year ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9373600)
â€” [Details](attachment.cgi?id=9373600&action=edit)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1764343#a55909891_578488)â€¢ 1 year ago |

Alias: CVE-2024-0747

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 27](/show_bug.cgi?id=1764343#c27)â€¢ 8 months ago |
|  | |

Making Firefox 122 security bugs public. [bugspam filter string: Pilgarlic-Towers]

Group: core-security-release
You need to [log in](/show_bug.cgi?id=1764343&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top â†‘

## Attachment

Hide Details

### General

Creator:  [June Wilde (she/her) [:jewilde]](/user_profile?user_id=626341)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from lists.debian.org_d0d32a04_20250111_082941.html ===


---

[[Date Prev](msg00021.html)][[Date Next](msg00023.html)]
[[Thread Prev](msg00021.html)][[Thread Next](msg00023.html)]
[[Date Index](maillist.html#00022)]
[[Thread Index](threads.html#00022)]

# [SECURITY] [DLA 3727-1] firefox-esr security update

---

* *To*: <debian-lts-announce@lists.debian.org>
* *Subject*: [SECURITY] [DLA 3727-1] firefox-esr security update
* *From*: Emilio Pozuelo Monfort <pochu@debian.org>
* *Date*: Wed, 31 Jan 2024 16:16:20 +0100 (CET)
* *Message-id*: <[[ðŸ”Ž]](/msgid-search/20240131151620.C92DC2A01ED%40andromeda)Â [20240131151620.C92DC2A01ED@andromeda](msg00022.html)>
* *Mail-followup-to*: debian-lts@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

- -------------------------------------------------------------------------
Debian LTS Advisory DLA-3727-1                debian-lts@lists.debian.org
<https://www.debian.org/lts/security/>               Emilio Pozuelo Monfort
January 31, 2024                              <https://wiki.debian.org/LTS>
- -------------------------------------------------------------------------

Package        : firefox-esr
Version        : 115.7.0esr-1~deb10u1
CVE ID         : CVE-2024-0741 CVE-2024-0742 CVE-2024-0746 CVE-2024-0747
                 CVE-2024-0749 CVE-2024-0750 CVE-2024-0751 CVE-2024-0753
                 CVE-2024-0755

Multiple security issues have been found in the Mozilla Firefox web
browser, which could potentially result in the execution of arbitrary
code, phishing, clickjacking, privilege escalation, HSTS bypass or
bypass of content security policies.

For Debian 10 buster, these problems have been fixed in version
115.7.0esr-1~deb10u1.

We recommend that you upgrade your firefox-esr packages.

For the detailed security status of firefox-esr please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/firefox-esr>

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>
-----BEGIN PGP SIGNATURE-----

iQIzBAEBCAAdFiEEcJymx+vmJZxd92Q+nUbEiOQ2gwIFAmW6ZD8ACgkQnUbEiOQ2
gwLwtRAAkrRo4Tp7+yx/1wUz9/TR5vREOCXoszy2WdVQvuTgiNYwkSAMDL1TpId1
M2mNLtL8v3QCCNoZqA3rIDVsixrBwZWdDLUA1OMjqyB3ChuX45lcyu3A+71v9MkI
2VaOIlkaWicu9rxNSQOYuPqItl2ydFLTUmVgR1pR4J+NstP/imijiEbPAiG5BM4n
U8L0IiUs8J+DQxeft5SWwFbMjbS8pi2R845z7p9RjGkIMPJF3CUdpsKnQcItCQIV
Ncc4YzVc8h7qpR4IWgLsGMoqA0EOtQB6NzFHZlASItgLJhDJSCVx/9/kUggjkq2D
DYTz5SoXW5P2QhX6rhkzYb8PVzyd9OQLXk2gEqEq4mtAidKO0IYl9ImwiCsnUoQp
HGz/e3QzFd2g1PVZ2RrjXjHAVe3r2wX3hv/eU8zZJadMR7/FcuYGKUPM897iov0K
Pac32GKpDdr7+x+LABrpzit1RjaULdzfOIa8EakOKtnnmtzH2KTf7nkLG8+KshfL
L5gmaWeBj1korqswg6p6ptPgm/KaqTK9ycyHZnwWNOdtDmAedfYJqITWgWZLP/nx
WzElPEQgqL521o/oFpAQ3Dp+OqNrjPV47oP5xdHQrdj1VJ0omc6F3GtJIvh182ak
HDKoTxdvLigeN4l9HnIdNqSFNRrsjNUbFjf2LdvdHYM382R5W9s=
=hLRb
-----END PGP SIGNATURE-----

```

---



=== Content from www.mozilla.org_edd21a79_20250111_082941.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, weâ€™d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured â€” we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    #### Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [#### Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    #### Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    #### Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    #### Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    #### Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    #### MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    #### Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    #### Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [#### About Mozilla](/en-US/about/)
  + [#### The Mozilla Manifesto](/en-US/about/manifesto/)
  + [#### Get Involved](/en-US/contribute/)
  + [#### Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [#### Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2024-01

## Security Vulnerabilities fixed in Firefox 122

Announced
January 23, 2024
Impact
high
Products
Firefox
Fixed in

* Firefox 122

#### [#CVE-2024-0741: Out of bounds write in ANGLE](#CVE-2024-0741)

Reporter
Renan Rios
Impact
high
##### Description

An out of bounds write in ANGLE could have allowed an attacker to corrupt memory leading to a potentially exploitable crash.

##### References

* [Bug 1864587](https://bugzilla.mozilla.org/show_bug.cgi?id=1864587)

#### [#CVE-2024-0742: Failure to update user input timestamp](#CVE-2024-0742)

Reporter
Andrew McCreight
Impact
high
##### Description

It was possible for certain browser prompts and dialogs to be activated or dismissed unintentionally by the user due to an incorrect timestamp used to prevent input after page load.

##### References

* [Bug 1867152](https://bugzilla.mozilla.org/show_bug.cgi?id=1867152)

#### [#CVE-2024-0743: Crash in NSS TLS method](#CVE-2024-0743)

Reporter
John Schanck
Impact
high
##### Description

An unchecked return value in TLS handshake code could have caused a potentially exploitable crash.

##### References

* [Bug 1867408](https://bugzilla.mozilla.org/show_bug.cgi?id=1867408)

#### [#CVE-2024-0744: Wild pointer dereference in JavaScript](#CVE-2024-0744)

Reporter
Lukas Bernhard
Impact
high
##### Description

In some circumstances, JIT compiled code could have dereferenced a wild pointer value. This could have led to an exploitable crash.

##### References

* [Bug 1871089](https://bugzilla.mozilla.org/show_bug.cgi?id=1871089)

#### [#CVE-2024-0745: Stack buffer overflow in WebAudio](#CVE-2024-0745)

Reporter
Yangkang of 360 ATA Team
Impact
high
##### Description

The WebAudio `OscillatorNode` object was susceptible to a stack buffer overflow. This could have led to a potentially exploitable crash.

##### References

* [Bug 1871838](https://bugzilla.mozilla.org/show_bug.cgi?id=1871838)

#### [#CVE-2024-0746: Crash when listing printers on Linux](#CVE-2024-0746)

Reporter
Cornel Ionce
Impact
moderate
##### Description

A Linux user opening the print preview dialog could have caused the browser to crash.

##### References

* [Bug 1660223](https://bugzilla.mozilla.org/show_bug.cgi?id=1660223)

#### [#CVE-2024-0747: Bypass of Content Security Policy when directive unsafe-inline was set](#CVE-2024-0747)

Reporter
Seongil Wi
Impact
moderate
##### Description

When a parent page loaded a child in an iframe with `unsafe-inline`, the parent Content Security Policy could have overridden the child Content Security Policy.

##### References

* [Bug 1764343](https://bugzilla.mozilla.org/show_bug.cgi?id=1764343)

#### [#CVE-2024-0748: Compromised content process could modify document URI](#CVE-2024-0748)

Reporter
Young Min Kim
Impact
moderate
##### Description

A compromised content process could have updated the document URI. This could have allowed an attacker to set an arbitrary URI in the address bar or history.

##### References

* [Bug 1783504](https://bugzilla.mozilla.org/show_bug.cgi?id=1783504)

#### [#CVE-2024-0749: Phishing site popup could show local origin in address bar](#CVE-2024-0749)

Reporter
Kestrel
Impact
moderate
##### Description

A phishing site could have repurposed an `about:` dialog to show phishing content with an incorrect origin in the address bar.

##### References

* [Bug 1813463](https://bugzilla.mozilla.org/show_bug.cgi?id=1813463)

#### [#CVE-2024-0750: Potential permissions request bypass via clickjacking](#CVE-2024-0750)

Reporter
Hafiizh
Impact
moderate
##### Description

A bug in popup notifications delay calculation could have made it possible for an attacker to trick a user into granting permissions.

##### References

* [Bug 1863083](https://bugzilla.mozilla.org/show_bug.cgi?id=1863083)

#### [#CVE-2024-0751: Privilege escalation through devtools](#CVE-2024-0751)

Reporter
Rob Wu
Impact
moderate
##### Description

A malicious devtools extension could have been used to escalate privileges.

##### References

* [Bug 1865689](https://bugzilla.mozilla.org/show_bug.cgi?id=1865689)

#### [#CVE-2024-0752: Use-after-free could occur when applying update on macOS](#CVE-2024-0752)

Reporter
Nika Layzell
Impact
moderate
##### Description

A use-after-free crash could have occurred on macOS if a Firefox update were being applied on a very busy system. This could have resulted in an exploitable crash.

##### References

* [Bug 1866840](https://bugzilla.mozilla.org/show_bug.cgi?id=1866840)

#### [#CVE-2024-0753: HSTS policy on subdomain could bypass policy of upper domain](#CVE-2024-0753)

Reporter
Hanno BÃ¶ck
Impact
moderate
##### Description

In specific HSTS configurations an attacker could have bypassed HSTS on a subdomain.

##### References

* [Bug 1870262](https://bugzilla.mozilla.org/show_bug.cgi?id=1870262)

#### [#CVE-2024-0754: Crash when using some WASM files in devtools](#CVE-2024-0754)

Reporter
Christian Holler
Impact
moderate
##### Description

Some WASM source files could have caused a crash when loaded in devtools.

##### References

* [Bug 1871605](https://bugzilla.mozilla.org/show_bug.cgi?id=1871605)

#### [#CVE-2024-0755: Memory safety bugs fixed in Firefox 122, Firefox ESR 115.7, and Thunderbird 115.7](#CVE-2024-0755)

Reporter
Daniel Holbert, Andrew Osmond, and the Mozilla Fuzzing Team
Impact
moderate
##### Description

Memory safety bugs present in Firefox 121, Firefox ESR 115.6, and Thunderbird 115.6. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 122, Firefox ESR 115.7, and Thunderbird 115.7](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1868456%2C1871445%2C1873701)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporationâ€™s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are Â©1998â€“2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from www.mozilla.org_eb2c002a_20250111_082942.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, weâ€™d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured â€” we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    #### Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [#### Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    #### Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    #### Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    #### Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    #### Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    #### MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    #### Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    #### Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [#### About Mozilla](/en-US/about/)
  + [#### The Mozilla Manifesto](/en-US/about/manifesto/)
  + [#### Get Involved](/en-US/contribute/)
  + [#### Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [#### Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2024-02

## Security Vulnerabilities fixed in Firefox ESR 115.7

Announced
January 23, 2024
Impact
high
Products
Firefox ESR
Fixed in

* Firefox ESR 115.7

*Updated February 8, 2024 to remove CVE-2024-0749 which was inadvertently included in the original advisory.*

#### [#CVE-2024-0741: Out of bounds write in ANGLE](#CVE-2024-0741)

Reporter
Renan Rios
Impact
high
##### Description

An out of bounds write in ANGLE could have allowed an attacker to corrupt memory leading to a potentially exploitable crash.

##### References

* [Bug 1864587](https://bugzilla.mozilla.org/show_bug.cgi?id=1864587)

#### [#CVE-2024-0742: Failure to update user input timestamp](#CVE-2024-0742)

Reporter
Andrew McCreight
Impact
high
##### Description

It was possible for certain browser prompts and dialogs to be activated or dismissed unintentionally by the user due to an incorrect timestamp used to prevent input after page load.

##### References

* [Bug 1867152](https://bugzilla.mozilla.org/show_bug.cgi?id=1867152)

#### [#CVE-2024-0746: Crash when listing printers on Linux](#CVE-2024-0746)

Reporter
Cornel Ionce
Impact
moderate
##### Description

A Linux user opening the print preview dialog could have caused the browser to crash.

##### References

* [Bug 1660223](https://bugzilla.mozilla.org/show_bug.cgi?id=1660223)

#### [#CVE-2024-0747: Bypass of Content Security Policy when directive unsafe-inline was set](#CVE-2024-0747)

Reporter
Seongil Wi
Impact
moderate
##### Description

When a parent page loaded a child in an iframe with `unsafe-inline`, the parent Content Security Policy could have overridden the child Content Security Policy.

##### References

* [Bug 1764343](https://bugzilla.mozilla.org/show_bug.cgi?id=1764343)

#### [#CVE-2024-0750: Potential permissions request bypass via clickjacking](#CVE-2024-0750)

Reporter
Hafiizh
Impact
moderate
##### Description

A bug in popup notifications delay calculation could have made it possible for an attacker to trick a user into granting permissions.

##### References

* [Bug 1863083](https://bugzilla.mozilla.org/show_bug.cgi?id=1863083)

#### [#CVE-2024-0751: Privilege escalation through devtools](#CVE-2024-0751)

Reporter
Rob Wu
Impact
moderate
##### Description

A malicious devtools extension could have been used to escalate privileges.

##### References

* [Bug 1865689](https://bugzilla.mozilla.org/show_bug.cgi?id=1865689)

#### [#CVE-2024-0753: HSTS policy on subdomain could bypass policy of upper domain](#CVE-2024-0753)

Reporter
Hanno BÃ¶ck
Impact
moderate
##### Description

In specific HSTS configurations an attacker could have bypassed HSTS on a subdomain.

##### References

* [Bug 1870262](https://bugzilla.mozilla.org/show_bug.cgi?id=1870262)

#### [#CVE-2024-0755: Memory safety bugs fixed in Firefox 122, Firefox ESR 115.7, and Thunderbird 115.7](#CVE-2024-0755)

Reporter
Daniel Holbert, Andrew Osmond, and the Mozilla Fuzzing Team
Impact
moderate
##### Description

Memory safety bugs present in Firefox 121, Firefox ESR 115.6, and Thunderbird 115.6. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 122, Firefox ESR 115.7, and Thunderbird 115.7](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1868456%2C1871445%2C1873701)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporationâ€™s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are Â©1998â€“2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)


