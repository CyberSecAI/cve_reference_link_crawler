
[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fhnsecurity%2Fvulns%2Fblob%2Fmain%2FHNS-2024-09-Keycloak.md)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fhnsecurity%2Fvulns%2Fblob%2Fmain%2FHNS-2024-09-Keycloak.md)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=hnsecurity%2Fvulns)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[hnsecurity](/hnsecurity)
/
**[vulns](/hnsecurity/vulns)**
Public

* [Notifications](/login?return_to=%2Fhnsecurity%2Fvulns) You must be signed in to change notification settings
* [Fork
  2](/login?return_to=%2Fhnsecurity%2Fvulns)
* [Star
   21](/login?return_to=%2Fhnsecurity%2Fvulns)

* [Code](/hnsecurity/vulns)
* [Issues
  0](/hnsecurity/vulns/issues)
* [Pull requests
  0](/hnsecurity/vulns/pulls)
* [Actions](/hnsecurity/vulns/actions)
* [Projects
  0](/hnsecurity/vulns/projects)
* [Security](/hnsecurity/vulns/security)
* [Insights](/hnsecurity/vulns/pulse)

Additional navigation options

* [Code](/hnsecurity/vulns)
* [Issues](/hnsecurity/vulns/issues)
* [Pull requests](/hnsecurity/vulns/pulls)
* [Actions](/hnsecurity/vulns/actions)
* [Projects](/hnsecurity/vulns/projects)
* [Security](/hnsecurity/vulns/security)
* [Insights](/hnsecurity/vulns/pulse)

## Files

 main
## Breadcrumbs

1. [vulns](/hnsecurity/vulns/tree/main)
/
# HNS-2024-09-Keycloak.md

 Blame  Blame
## Latest commit

## History

[History](/hnsecurity/vulns/commits/main/HNS-2024-09-Keycloak.md)50 lines (36 loc) · 2.97 KB main
## Breadcrumbs

1. [vulns](/hnsecurity/vulns/tree/main)
/
# HNS-2024-09-Keycloak.md

Top
## File metadata and controls

* Preview
* Code
* Blame

50 lines (36 loc) · 2.97 KB[Raw](https://github.com/hnsecurity/vulns/raw/refs/heads/main/HNS-2024-09-Keycloak.md)
# HN Security Advisory - <https://security.humanativaspa.it/>

* Title: Multiple race conditions in Keycloak's anti-brute force mechanism
* Products:
  + Keycloak <= 22.0.11
  + Keycloak <= 24.0.6
  + Keycloak <= 25.0.2
* Author: Ema Srdoc <ema.srdoc at hnsecurity.it> and Maurizio Agazzini <maurizio.agazzini at hnsecurity.it>
* Date: 2024-10-30
* CVE Names and Vendor CVSS Scores:

  CVE-2024-4629: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:N
* Advisory URLs:

  <https://github.com/hnsecurity/vulns/blob/main/HNS-2024-09-Keycloak.md>

# Description

Race conditions in the context of web applications, particularly in authentication processes involving user credentials and one-time passwords (OTPs), pose significant security risks.

In a typical authentication scenario, when a user submits their credentials (username and password) through a form, the server validates these credentials before granting access. However, in the presence of race conditions, multiple requests from the same user or different users may arrive at the server simultaneously or in rapid succession.

Keycloak implements an anti-brute force mechanism (which is not enabled by default) which should limit the attack attempts by locking out user accounts after a configured number of incorrect login attempts:

* <https://www.keycloak.org/docs/latest/server_admin/#password-guess-brute-force-attacks>

Based on our analysis, the software does not implement controls to block attacks of this kind; therefore, it's possible to send multiple requests that are processed simultaneously, completely bypassing the anti-brute-force mechanism. Furthermore, when the account is locked, active sessions are not invalidated.

The issue has been verified both on the username and password-based login and on the OTP request. No checks have been performed on the "Quick Login Check Milliseconds" functionality, but we expect it to be affected by the same issue.

The configuration used for testing was set to lockout user accounts after 3 incorrect login attempts.

Further details on the technique used are available here:

* <https://portswigger.net/research/smashing-the-state-machine>
* <https://portswigger.net/research/the-single-packet-attack-making-remote-race-conditions-local>
* <https://portswigger.net/research/turbo-intruder-embracing-the-billion-request-attack>

# Affected platforms

All Keycloak versions up to and including version 22.0.11, 24.0.6, 25.0.2 are affected.

# Disclosure timeline

18/04/2024 - First communication with details.

18/04/2024 - Response: we can't see the details.

18/04/2024 - Send details again as an attachment.

02/05/2024 - Request for a follow-up.

09/05/2024 - Response: CVE-2024-4629 assigned, fix in backlog.

24/05/2024 - Request for a roadmap of the fix.

22/08/2024 - Request for a follow-up.

26/08/2024 - Response: already fixed and published as a [public issue](https://github.com/keycloak/keycloak/issues/31726)

03/09/2024 - [CVE-2024-4629](https://access.redhat.com/security/cve/CVE-2024-4629) is published.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.

