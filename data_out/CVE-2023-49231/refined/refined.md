Based on the provided content, here's a breakdown of the vulnerability:

**Root Cause:**
The vulnerability stems from a wildcard injection vulnerability within a prepared SQL statement in an undocumented REST API route of Visual Planning. Specifically, the `LIKE` operator is used in combination with user-controlled input (`apikey` header) without proper sanitization, allowing for wildcard injection.

**Weaknesses/Vulnerabilities:**
- **SQL Wildcard Injection:** The use of the `LIKE` operator with unsanitized user input in a SQL query makes it vulnerable to wildcard injection.
- **Undocumented API Route:** The vulnerable `/session` endpoint was not documented, making it harder to discover and secure.
- **Lack of Input Sanitization:** The `apikey` header is not properly sanitized before being used in the SQL query.

**Impact of Exploitation:**
- **API Key Exfiltration:** By injecting wildcard characters (e.g., `%`) into the `apikey` header, an attacker can cause the server to return a success message, even with an invalid key, provided the query matches. Through a series of requests and responses, an attacker can brute-force the full API key character by character.
- **Administrative Access:** With a valid API key, attackers gain access to the REST API v2.0. This access allows them to:
    - Exfiltrate sensitive company data.
    - Upload or download files.
    - Manage users, including creating administrative users, if no external user management (e.g., LDAP) is configured.
- **Server Compromise:** Given that administrators can upload modules using the Visual Planning Admin Center, a successful API key compromise could lead to a full server compromise.

**Attack Vectors:**
- **HTTP GET Request:** The attack is performed by sending a crafted GET request to the `/session` endpoint of the Visual Planning REST API v2.0.
- **`apikey` Header Manipulation:** The attacker manipulates the `apikey` header to inject wildcard characters into the SQL query.

**Required Attacker Capabilities/Position:**
- **Network Access:** The attacker needs network access to the Visual Planning instance.
- **Knowledge of the API Endpoint:** The attacker needs knowledge of the undocumented `/session` API endpoint.
- **Ability to Craft HTTP Requests:** The attacker must be able to send HTTP requests with a manipulated `apikey` header.

**Additional Details:**
- The vulnerability exists in Visual Planning versions prior to build 240207 of version 8.
- The vulnerability was discovered during a red teaming assessment.
- A proof-of-concept script (`brute_vp_apikey.py`) was developed to automate the API key exfiltration process.
- The vendor was notified, and a patch has been released.
- The vulnerability is located in the `PlanningWSRestV2.java` and `WSSession.java` files of the Visual Planning application.
- The vulnerable SQL query is `SELECT XMLContent FROM Planning WHERE XMLContent LIKE ?`.
- The attack uses the LIKE operator to exploit the vulnerability via wildcard injection by passing in the % character.