=== Content from docs.couchdb.org_0b108614_20250108_123825.html ===

[Apache CouchDB®
![Logo](../_static/logo.png)](../index.html)
3.4

## Table of Contents

User Guides

* [1. Introduction](../intro/index.html)
* [2. Replication](../replication/index.html)
* [3. Design Documents](../ddocs/index.html)
* [4. Best Practices](../best-practices/index.html)

Administration Guides

* [1. Installation](../install/index.html)
* [2. Setup](../setup/index.html)
* [3. Configuration](../config/index.html)
* [4. Cluster Management](../cluster/index.html)
* [5. Maintenance](../maintenance/index.html)
* [6. Fauxton](../fauxton/index.html)
* [7. Experimental Features](../experimental.html)

Reference Guides

* [1. API Reference](../api/index.html)
* [2. JSON Structure Reference](../json-structure.html)
* [3. Query Server](../query-server/index.html)
* [4. Partitioned Databases](../partitioned-dbs/index.html)

Other

* [1. Release Notes](../whatsnew/index.html)
* [2. Security Issues / CVEs](index.html)
  + [2.1. CVE-2010-0009: Apache CouchDB Timing Attack Vulnerability](2010-0009.html)
  + [2.2. CVE-2010-2234: Apache CouchDB Cross Site Request Forgery Attack](2010-2234.html)
  + [2.3. CVE-2010-3854: Apache CouchDB Cross Site Scripting Issue](2010-3854.html)
  + [2.4. CVE-2012-5641: Information disclosure via unescaped backslashes in URLs on Windows](2012-5641.html)
  + [2.5. CVE-2012-5649: JSONP arbitrary code execution with Adobe Flash](2012-5649.html)
  + [2.6. CVE-2012-5650: DOM based Cross-Site Scripting via Futon UI](2012-5650.html)
  + [2.7. CVE-2014-2668: DoS (CPU and memory consumption) via the count parameter to /\_uuids](2014-2668.html)
  + [2.8. CVE-2017-12635: Apache CouchDB Remote Privilege Escalation](2017-12635.html)
  + [2.9. CVE-2017-12636: Apache CouchDB Remote Code Execution](2017-12636.html)
  + [2.10. CVE-2018-11769: Apache CouchDB Remote Code Execution](2018-11769.html)
  + [2.11. CVE-2018-17188: Apache CouchDB Remote Privilege Escalations](2018-17188.html)
  + [2.12. CVE-2018-8007: Apache CouchDB Remote Code Execution](2018-8007.html)
  + [2.13. CVE-2020-1955: Apache CouchDB Remote Privilege Escalation](2020-1955.html)
  + 2.14. CVE-2021-38295: Apache CouchDB Privilege Escalation
    - [2.14.1. Description](#description)
    - [2.14.2. Mitigation](#mitigation)
    - [2.14.3. Credit](#credit)
  + [2.15. CVE-2022-24706: Apache CouchDB Remote Privilege Escalation](2022-24706.html)
  + [2.16. CVE-2023-26268: Apache CouchDB: Information sharing via couchjs processes](2023-26268.html)
  + [2.17. CVE-2023-45725: Apache CouchDB: Privilege Escalation Using Design Documents](2023-45725.html)
* [3. Reporting New Security Problems with Apache CouchDB](index.html#reporting-new-security-problems-with-apache-couchdb)
* [4. License](../about.html)
* [5. Contributing to this Documentation](../contributing.html)

## Quick Reference Guides

* [API Quick Reference](../http-routingtable.html)
* [Configuration Quick Reference](../config-ref.html)

## More Help

* [CouchDB Homepage](https://couchdb.apache.org/)
* [Mailing Lists](https://couchdb.apache.org/#mailing-list)
* [Realtime Chat](https://couchdb.apache.org/#chat)
* [Issue Tracker](https://github.com/apache/couchdb/issues)
* [Download Docs](../download.html)

[Apache CouchDB®](../index.html)

* [2. Security Issues / CVEs](index.html)
* 2.14. CVE-2021-38295: Apache CouchDB Privilege Escalation
* [View page source](../_sources/cve/2021-38295.rst.txt)

---

# 2.14. CVE-2021-38295: Apache CouchDB Privilege Escalation[¶](#cve-2021-38295-apache-couchdb-privilege-escalation "Link to this heading")

Date:

12.10.2021

Affected:

3.1.1 and below

Severity:

Low

Vendor:

The Apache Software Foundation

## 2.14.1. Description[¶](#description "Link to this heading")

A malicious user with permission to create documents in a database is able
to attach a HTML attachment to a document. If a CouchDB admin opens that
attachment in a browser, e.g. via the CouchDB admin interface Fauxton,
any JavaScript code embedded in that HTML attachment will be executed within
the security context of that admin. A similar route is available with the
already deprecated \_show and \_list functionality.

This *privilege escalation* vulnerability allows an attacker to add or remove
data in any database or make configuration changes.

## 2.14.2. Mitigation[¶](#mitigation "Link to this heading")

CouchDB [3.2.0](../whatsnew/3.2.html#release-3-2-0) and onwards adds Content-Security-Policy
headers for all attachment, \_show and \_list requests. This breaks certain
niche use-cases and there are configuration options to restore the previous
behaviour for those who need it.

CouchDB [3.1.2](../whatsnew/3.1.html#release-3-1-2) defaults to the previous behaviour, but
adds configuration options to turn Content-Security-Policy headers on for
all affected requests.

## 2.14.3. Credit[¶](#credit "Link to this heading")

This issue was identified by Cory Sabol of [Secure Ideas](https://secureideas.com/).

 [Previous](2020-1955.html "2.13. CVE-2020-1955: Apache CouchDB Remote Privilege Escalation")
[Next](2022-24706.html "2.15. CVE-2022-24706: Apache CouchDB Remote Privilege Escalation")

---

© Copyright 2024, Apache Software Foundation. CouchDB® is a registered trademark of the Apache Software Foundation.

Built with [Sphinx](https://www.sphinx-doc.org/) using a
[theme](https://github.com/readthedocs/sphinx_rtd_theme)
provided by [Read the Docs](https://readthedocs.org).


