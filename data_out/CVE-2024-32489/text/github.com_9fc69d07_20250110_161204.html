
[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ftecnickcom%2FTCPDF%2Fcommit%2F51cd1b39de5643836e62661d162c472d63167df7)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ftecnickcom%2FTCPDF%2Fcommit%2F51cd1b39de5643836e62661d162c472d63167df7)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=tecnickcom%2FTCPDF)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[tecnickcom](/tecnickcom)
/
**[TCPDF](/tecnickcom/TCPDF)**
Public

* [Notifications](/login?return_to=%2Ftecnickcom%2FTCPDF) You must be signed in to change notification settings
* [Fork
  1.5k](/login?return_to=%2Ftecnickcom%2FTCPDF)
* [Star
   4.3k](/login?return_to=%2Ftecnickcom%2FTCPDF)

* [Code](/tecnickcom/TCPDF)
* [Issues
  341](/tecnickcom/TCPDF/issues)
* [Pull requests
  6](/tecnickcom/TCPDF/pulls)
* [Actions](/tecnickcom/TCPDF/actions)
* [Projects
  0](/tecnickcom/TCPDF/projects)
* [Security](/tecnickcom/TCPDF/security)
* [Insights](/tecnickcom/TCPDF/pulse)

Additional navigation options

* [Code](/tecnickcom/TCPDF)
* [Issues](/tecnickcom/TCPDF/issues)
* [Pull requests](/tecnickcom/TCPDF/pulls)
* [Actions](/tecnickcom/TCPDF/actions)
* [Projects](/tecnickcom/TCPDF/projects)
* [Security](/tecnickcom/TCPDF/security)
* [Insights](/tecnickcom/TCPDF/pulse)

## Commit

[Permalink](/tecnickcom/TCPDF/commit/51cd1b39de5643836e62661d162c472d63167df7)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Fix security issue (breaking change)

[Browse files](/tecnickcom/TCPDF/tree/51cd1b39de5643836e62661d162c472d63167df7)
Browse the repository at this point in the history

* Loading branch information

[![@nicolaasuni](https://avatars.githubusercontent.com/u/1186996?s=40&v=4)](/nicolaasuni)

[nicolaasuni](/tecnickcom/TCPDF/commits?author=nicolaasuni "View all commits by nicolaasuni")
committed
Mar 18, 2024

1 parent
[5fce932](/tecnickcom/TCPDF/commit/5fce932fcee4371865314ab7f6c0d85423c5c7ce)

commit 51cd1b3

 Show file tree

 Hide file tree

Showing
**10 changed files**
with
**101 additions**
and
**76 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* CHANGELOG.TXT
  [CHANGELOG.TXT](#diff-51217d6b37dd5106095284aee104f3b49df61d3dac07405a2e711356ae624bb3)
* LICENSE.TXT
  [LICENSE.TXT](#diff-14538857e2a6cdbe65ea17aa22362d5effe5a7c6eb2ad49eebd2eea45a2202cd)
* README.md
  [README.md](#diff-b335630551682c19a781afebcf4d07bf978fb1f8ac04c6bf87428ed5106870f5)
* VERSION
  [VERSION](#diff-7b60b8e351cbb80c47459ffe2c79f1a26404871f49294780fe47ad0e58c09350)
* composer.json
  [composer.json](#diff-d2ab9925cad7eac58e0ff4cc0d251a937ecf49e4b6bf57f8b95aab76648a9d34)
* examples

  + config

    - examples/config/tcpdf\_config\_alt.php
      [tcpdf\_config\_alt.php](#diff-b902caea27468048c9f67f74d39101fd535da2a3362004a5c83b677de91fe84b)
  + examples/example\_049.php
    [example\_049.php](#diff-4b1acdc17ef0690047add83e96aa286cf787e08ada24f85a1a89a4010b9eab5e)
* include

  + include/tcpdf\_static.php
    [tcpdf\_static.php](#diff-780856e2018bdfc6173dcbadc140721d619d42b032cf29219f4d953cdc89e256)
* tcpdf.php
  [tcpdf.php](#diff-9e49843a3fbb8d051466b9db0da16467ce405ebff7855afaa854ea9d680b38d6)
* tcpdf\_autoconfig.php
  [tcpdf\_autoconfig.php](#diff-f1981f911fb0550288689aacda97488f672058405fd525a150c0588e588d1024)

## There are no files selected for viewing

5 changes: 5 additions & 0 deletions

5
[CHANGELOG.TXT](#diff-51217d6b37dd5106095284aee104f3b49df61d3dac07405a2e711356ae624bb3 "CHANGELOG.TXT")

Show comments

[View file](/tecnickcom/TCPDF/blob/51cd1b39de5643836e62661d162c472d63167df7/CHANGELOG.TXT)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |

|  |  | @@ -1,3 +1,8 @@ |
|  |  | 6.7.0 (2024-03-18) |
|  |  | - Fix security issue. |
|  |  | - [BREAKING CHANGE] The tcpdf HTML tag syntax has changed, see example\_049.php. |
|  |  | - New K\_ALLOWED\_TCPDF\_TAGS configuration constant to set the allowed methods for the tcdpf HTML tag. |
|  |  |  |
|  |  | 6.6.5 (2023-09-06) |
|  |  | - Fix corrupted file. |
|  |  |  |
| Expand Down | |  |

2 changes: 1 addition & 1 deletion

2
[LICENSE.TXT](#diff-14538857e2a6cdbe65ea17aa22362d5effe5a7c6eb2ad49eebd2eea45a2202cd "LICENSE.TXT")

Show comments

[View file](/tecnickcom/TCPDF/blob/51cd1b39de5643836e62661d162c472d63167df7/LICENSE.TXT)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |

| Expand Up | | @@ -7,7 +7,7 @@ |
|  |  | published by the Free Software Foundation, either version 3 of the |
|  |  | License, or (at your option) any later version. |
|  |  |  |
|  |  | 2002-2023 Nicola Asuni - Tecnick.com LTD |
|  |  | 2002-2024 Nicola Asuni - Tecnick.com LTD |
|  |  |  |
|  |  | \*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\* |
|  |  | \*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\* |
| Expand Down | |  |

2 changes: 1 addition & 1 deletion

2
[README.md](#diff-b335630551682c19a781afebcf4d07bf978fb1f8ac04c6bf87428ed5106870f5 "README.md")

Show comments

[View file](/tecnickcom/TCPDF/blob/51cd1b39de5643836e62661d162c472d63167df7/README.md)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |

| Expand Up | | @@ -6,7 +6,7 @@ |
|  |  |  |
|  |  | \* \*\*category\*\* Library |
|  |  | \* \*\*author\*\* Nicola Asuni <info@tecnick.com> |
|  |  | \* \*\*copyright\*\* 2002-2023 Nicola Asuni - Tecnick.com LTD |
|  |  | \* \*\*copyright\*\* 2002-2024 Nicola Asuni - Tecnick.com LTD |
|  |  | \* \*\*license\*\* http://www.gnu.org/copyleft/lesser.html GNU-LGPL v3 (see LICENSE.TXT) |
|  |  | \* \*\*link\*\* http://www.tcpdf.org |
|  |  | \* \*\*source\*\* https://github.com/tecnickcom/TCPDF |
| Expand Down | |  |

2 changes: 1 addition & 1 deletion

2
[VERSION](#diff-7b60b8e351cbb80c47459ffe2c79f1a26404871f49294780fe47ad0e58c09350 "VERSION")

Show comments

[View file](/tecnickcom/TCPDF/blob/51cd1b39de5643836e62661d162c472d63167df7/VERSION)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1 +1 @@ |
|  |  | 6.6.5 |
|  |  | 6.7.0 |

2 changes: 1 addition & 1 deletion

2
[composer.json](#diff-d2ab9925cad7eac58e0ff4cc0d251a937ecf49e4b6bf57f8b95aab76648a9d34 "composer.json")

Show comments

[View file](/tecnickcom/TCPDF/blob/51cd1b39de5643836e62661d162c472d63167df7/composer.json)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -12,7 +12,7 @@ |
|  |  | "barcodes" |
|  |  | ], |
|  |  | "homepage": "http://www.tcpdf.org/", |
|  |  | "version": "6.6.5", |
|  |  | "version": "6.7.0", |
|  |  | "license": "LGPL-3.0-or-later", |
|  |  | "authors": [ |
|  |  | { |
| Expand Down | |  |

12 changes: 12 additions & 0 deletions

12
[examples/config/tcpdf\_config\_alt.php](#diff-b902caea27468048c9f67f74d39101fd535da2a3362004a5c83b677de91fe84b "examples/config/tcpdf_config_alt.php")

Show comments

[View file](/tecnickcom/TCPDF/blob/51cd1b39de5643836e62661d162c472d63167df7/examples/config/tcpdf_config_alt.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -212,6 +212,18 @@ |
|  |  | \*/ |
|  |  | define('K\_TCPDF\_CALLS\_IN\_HTML', true); |
|  |  |  |
|  |  | /\*\* |
|  |  | \* List the TCPDF methods that are allowed to be called using HTML syntax. |
|  |  | \* The constant K\_TCPDF\_CALLS\_IN\_HTML must be set to true. |
|  |  | \* IMPORTANT: For security reason, disable this feature if you are allowing user HTML content. |
|  |  | \*/ |
|  |  | define('K\_ALLOWED\_TCPDF\_TAGS', array( |
|  |  | 'AddPage', |
|  |  | 'Rect', |
|  |  | 'SetDrawColor', |
|  |  | 'write1DBarcode', |
|  |  | )); |
|  |  |  |
|  |  | /\*\* |
|  |  | \* If true and PHP version is greater than 5, then the Error() method throw new exception instead of terminating the execution. |
|  |  | \*/ |
| Expand Down | |  |

34 changes: 18 additions & 16 deletions

34
[examples/example\_049.php](#diff-4b1acdc17ef0690047add83e96aa286cf787e08ada24f85a1a89a4010b9eab5e "examples/example_049.php")

Show comments

[View file](/tecnickcom/TCPDF/blob/51cd1b39de5643836e62661d162c472d63167df7/examples/example_049.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -2,7 +2,7 @@ |
|  |  | //============================================================+ |
|  |  | // File name : example\_049.php |
|  |  | // Begin : 2009-04-03 |
|  |  | // Last Update : 2014-12-10 |
|  |  | // Last Update : 2024-03-18 |
|  |  | // |
|  |  | // Description : Example 049 for TCPDF class |
|  |  | // WriteHTML with TCPDF callback functions |
| Expand Down  Expand Up | | @@ -78,11 +78,11 @@ |
|  |  | /\* \* \* \* \* \* \* \* \* \* \* \* \* \* \* \* \* \* \* \* \* \* \* \* \* \* \* \* \* \* \* \* \* \* \* \* \* |
|  |  |  |
|  |  | IMPORTANT: |
|  |  | If you are printing user-generated content, tcpdf tag can be unsafe. |
|  |  | You can disable this tag by setting to false the K\_TCPDF\_CALLS\_IN\_HTML |
|  |  | constant on TCPDF configuration file. |
|  |  | If you are printing user-generated content, the tcpdf tag should be considered unsafe. |
|  |  | This tag is disabled by default by the K\_TCPDF\_CALLS\_IN\_HTML constant on TCPDF configuration file. |
|  |  | Please use this feature only if you are in control of the HTML content and you are sure that it does not contain any harmful code. |
|  |  |  |
|  |  | For security reasons, the parameters for the 'params' attribute of TCPDF |
|  |  | For security reasons, the parameters for the 'params' attribute of TCPDF |
|  |  | tag must be prepared as an array and encoded with the |
|  |  | serializeTCPDFtagParameters() method (see the example below). |
|  |  |  |
| Expand All | | @@ -91,23 +91,25 @@ |
|  |  |  |
|  |  | $html = '<h1>Test TCPDF Methods in HTML</h1> |
|  |  | <h2 style="color:red;">IMPORTANT:</h2> |
|  |  | <span style="color:red;">If you are using user-generated content, the tcpdf tag can be unsafe.<br /> |
|  |  | You can disable this tag by setting to false the <b>K\_TCPDF\_CALLS\_IN\_HTML</b> constant on TCPDF configuration file.</span> |
|  |  | <span style="color:red;">If you are using user-generated content, the tcpdf tag should be considered unsafe.<br /> |
|  |  | Please use this feature only if you are in control of the HTML content and you are sure that it does not contain any harmful code.<br /> |
|  |  | This feature is disabled by default by the <b>K\_TCPDF\_CALLS\_IN\_HTML</b> constant on TCPDF configuration file.</span> |
|  |  | <h2>write1DBarcode method in HTML</h2>'; |
|  |  |  |
|  |  | $params = $pdf->serializeTCPDFtagParameters(array('CODE 39', 'C39', '', '', 80, 30, 0.4, array('position'=>'S', 'border'=>true, 'padding'=>4, 'fgcolor'=>array(0,0,0), 'bgcolor'=>array(255,255,255), 'text'=>true, 'font'=>'helvetica', 'fontsize'=>8, 'stretchtext'=>4), 'N')); |
|  |  | $html .= '<tcpdf method="write1DBarcode" params="'.$params.'" />'; |
|  |  | $data = $pdf->serializeTCPDFtag('write1DBarcode', array('CODE 39', 'C39', '', '', 80, 30, 0.4, array('position'=>'S', 'border'=>true, 'padding'=>4, 'fgcolor'=>array(0,0,0), 'bgcolor'=>array(255,255,255), 'text'=>true, 'font'=>'helvetica', 'fontsize'=>8, 'stretchtext'=>4), 'N')); |
|  |  | $html .= '<tcpdf data="'.$data.'" />'; |
|  |  |  |
|  |  | $params = $pdf->serializeTCPDFtagParameters(array('CODE 128', 'C128', '', '', 80, 30, 0.4, array('position'=>'S', 'border'=>true, 'padding'=>4, 'fgcolor'=>array(0,0,0), 'bgcolor'=>array(255,255,255), 'text'=>true, 'font'=>'helvetica', 'fontsize'=>8, 'stretchtext'=>4), 'N')); |
|  |  | $html .= '<tcpdf method="write1DBarcode" params="'.$params.'" />'; |
|  |  | $data = $pdf->serializeTCPDFtag('write1DBarcode', array('CODE 128', 'C128', '', '', 80, 30, 0.4, array('position'=>'S', 'border'=>true, 'padding'=>4, 'fgcolor'=>array(0,0,0), 'bgcolor'=>array(255,255,255), 'text'=>true, 'font'=>'helvetica', 'fontsize'=>8, 'stretchtext'=>4), 'N')); |
|  |  | $html .= '<tcpdf data="'.$data.'" />'; |
|  |  |  |
|  |  | $html .= '<tcpdf method="AddPage" /><h2>Graphic Functions</h2>'; |
|  |  | $data = $pdf->serializeTCPDFtag('AddPage'); |
|  |  | $html .= '<tcpdf data="'.$data.'" /><h2>Graphic Functions</h2>'; |
|  |  |  |
|  |  | $params = $pdf->serializeTCPDFtagParameters(array(0)); |
|  |  | $html .= '<tcpdf method="SetDrawColor" params="'.$params.'" />'; |
|  |  | $data = $pdf->serializeTCPDFtag('SetDrawColor', array(0)); |
|  |  | $html .= '<tcpdf data="'.$data.'" />'; |
|  |  |  |
|  |  | $params = $pdf->serializeTCPDFtagParameters(array(50, 50, 40, 10, 'DF', array(), array(0,128,255))); |
|  |  | $html .= '<tcpdf method="Rect" params="'.$params.'" />'; |
|  |  | $data = $pdf->serializeTCPDFtag('Rect', array(50, 50, 40, 10, 'DF', array(), array(0,128,255))); |
|  |  | $html .= '<tcpdf data="'.$data.'" />'; |
|  |  |  |
|  |  |  |
|  |  | // output the HTML content |
| Expand Down | |  |

2 changes: 1 addition & 1 deletion

2
[include/tcpdf\_static.php](#diff-780856e2018bdfc6173dcbadc140721d619d42b032cf29219f4d953cdc89e256 "include/tcpdf_static.php")

Show comments

[View file](/tecnickcom/TCPDF/blob/51cd1b39de5643836e62661d162c472d63167df7/include/tcpdf_static.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -55,7 +55,7 @@ class TCPDF\_STATIC { |
|  |  | \* Current TCPDF version. |
|  |  | \* @private static |
|  |  | \*/ |
|  |  | private static $tcpdf\_version = '6.6.5'; |
|  |  | private static $tcpdf\_version = '6.7.0'; |
|  |  |  |
|  |  | /\*\* |
|  |  | \* String alias for total number of pages. |
| Expand Down | |  |

112 changes: 57 additions & 55 deletions

112
[tcpdf.php](#diff-9e49843a3fbb8d051466b9db0da16467ce405ebff7855afaa854ea9d680b38d6 "tcpdf.php")

Show comments

Show annotations

[View file](/tecnickcom/TCPDF/blob/51cd1b39de5643836e62661d162c472d63167df7/tcpdf.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1,13 +1,13 @@ |
|  |  | <?php |
|  |  | //============================================================+ |
|  |  | // File name : tcpdf.php |
|  |  | // Version : 6.6.5 |
|  |  | // Version : 6.7.0 |
|  |  | // Begin : 2002-08-03 |
|  |  | // Last Update : 2023-09-06 |
|  |  | // Last Update : 2024-03-18 |
|  |  | // Author : Nicola Asuni - Tecnick.com LTD - www.tecnick.com - info@tecnick.com |
|  |  | // License : GNU-LGPL v3 (http://www.gnu.org/copyleft/lesser.html) |
|  |  | // ------------------------------------------------------------------- |
|  |  | // Copyright (C) 2002-2023 Nicola Asuni - Tecnick.com LTD |
|  |  | // Copyright (C) 2002-2024 Nicola Asuni - Tecnick.com LTD |
|  |  | // |
|  |  | // This file is part of TCPDF software library. |
|  |  | // |
| Expand Down  Expand Up | | @@ -128,7 +128,7 @@ |
|  |  | \* TCPDF project (http://www.tcpdf.org) has been originally derived in 2002 from the Public Domain FPDF class by Olivier Plathey (http://www.fpdf.org), but now is almost entirely rewritten.<br> |
|  |  | \* @package com.tecnick.tcpdf |
|  |  | \* @brief PHP class for generating PDF documents without requiring external extensions. |
|  |  | \* @version 6.6.5 |
|  |  | \* @version 6.7.0 |
|  |  | \* @author Nicola Asuni - info@tecnick.com |
|  |  | \* @IgnoreAnnotation("protected") |
|  |  | \* @IgnoreAnnotation("public") |
| Expand Down  Expand Up | | @@ -17200,41 +17200,49 @@ protected function getSpaceString() { |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Return an hash code used to ensure that the serialized data has been generated by this TCPDF instance. |
|  |  | \* @param string $data serialized data |
|  |  | \* @return string |
|  |  | \* Serialize data to be used with TCPDF tag in HTML code. |
|  |  | \* @param string $method TCPDF method name |
|  |  | \* @param array $params Method parameters |
|  |  | \* @return string Serialized data |
|  |  | \* @public static |
|  |  | \*/ |
|  |  | protected function getHashForTCPDFtagParams($data) { |
|  |  | return md5(strlen($data).$this->file\_id.$data); |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Serialize an array of parameters to be used with TCPDF tag in HTML code. |
|  |  | \* @param array $data parameters array |
|  |  | \* @return string containing serialized data |
|  |  | \* @public static |
|  |  | \*/ |
|  |  | public function serializeTCPDFtagParameters($data) { |
|  |  | public function serializeTCPDFtag($method, $params=array()) { |
|  |  | $data = array('m' => $method, 'p' => $params); |
|  |  | $encoded = urlencode(json\_encode($data)); |
|  |  | return $this->getHashForTCPDFtagParams($encoded).$encoded; |
|  |  | $hash = password\_hash($encoded.'+'.$this->file\_id, PASSWORD\_DEFAULT); |
|  |  | return strlen($hash).'+'.$hash.'+'.$encoded; |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Unserialize parameters to be used with TCPDF tag in HTML code. |
|  |  | \* Unserialize data to be used with TCPDF tag in HTML code. |
|  |  | \* @param string $data serialized data |
|  |  | \* @return array containing unserialized data |
|  |  | \* @protected static |
|  |  | \*/ |
|  |  | protected function unserializeTCPDFtagParameters($data) { |
|  |  | $hash = substr($data, 0, 32); |
|  |  | $encoded = substr($data, 32); |
|  |  | if ($hash != $this->getHashForTCPDFtagParams($encoded)) { |
|  |  | protected function unserializeTCPDFtag($data) { |
|  |  | $hpos = strpos($data, '+'); |
|  |  | $hlen = intval(substr($data, 0, $hpos)); |
|  |  | $hash = substr($data, $hpos + 1, $hlen); |
|  |  | $encoded = substr($data, $hpos + 2 + $hlen); |
|  |  | if (!password\_verify($encoded.'+'.$this->file\_id, $hash)) { |
|  |  | $this->Error('Invalid parameters'); |
|  |  | } |
|  |  | return json\_decode(urldecode($encoded), true); |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Check if a TCPDF tag is allowed |
|  |  | \* @param string $method TCPDF method name |
|  |  | \* @return boolean |
|  |  | \* @protected |
|  |  | \*/ |
|  |  | protected function allowedTCPDFtag($method) { |
|  |  | if (!defined('K\_ALLOWED\_TCPDF\_TAGS') || empty(K\_ALLOWED\_TCPDF\_TAGS)) { |
|  |  | return false; |
|  |  | } |
|  |  | return in\_array($method, K\_ALLOWED\_TCPDF\_TAGS, true); |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Prints a cell (rectangular area) with optional borders, background color and html text string. |
|  |  | \* The upper-left corner of the cell corresponds to the current position. After the call, the current position moves to the right or to the next line.<br /> |
| Expand All | | @@ -17248,8 +17256,7 @@ protected function unserializeTCPDFtagParameters($data) { |
|  |  | \* @param float|null $y upper-left corner Y coordinate |
|  |  | \* @param string $html html text to print. Default value: empty string. |
|  |  | \* @param mixed $border Indicates if borders must be drawn around the cell. The value can be a number:<ul><li>0: no border (default)</li><li>1: frame</li></ul> or a string containing some or all of the following characters (in any order):<ul><li>L: left</li><li>T: top</li><li>R: right</li><li>B: bottom</li></ul> or an array of line styles for each border group - for example: array('LTRB' => array('width' => 2, 'cap' => 'butt', 'join' => 'miter', 'dash' => 0, 'color' => array(0, 0, 0))) |
|  |  | \* @param int $ln Indicates where the current position should go after the call. Possible values are:<ul><li>0: to the right (or left for RTL language)</li><li>1: to the beginning of the next line</li><li>2: below</li></ul> |
|  |  | Putting 1 is equivalent to putting 0 and calling Ln() just after. Default value: 0. |
|  |  | \* @param int $ln Indicates where the current position should go after the call. Possible values are:<ul><li>0: to the right (or left for RTL language)</li><li>1: to the beginning of the next line</li><li>2: below</li></ul> Putting 1 is equivalent to putting 0 and calling Ln() just after. Default value: 0. |
|  |  | \* @param boolean $fill Indicates if the cell background must be painted (true) or transparent (false). |
|  |  | \* @param boolean $reseth if true reset the last cell height (default true). |
|  |  | \* @param string $align Allows to center or align the text. Possible values are:<ul><li>L : left align</li><li>C : center</li><li>R : right align</li><li>'' : empty string : left for LTR or right for RTL</li></ul> |
| Expand Down  Expand Up | | @@ -19510,17 +19517,14 @@ protected function openHTMLTagHandler($dom, $key, $cell) { |
|  |  | case 'tcpdf': { |
|  |  | if (defined('K\_TCPDF\_CALLS\_IN\_HTML') AND (K\_TCPDF\_CALLS\_IN\_HTML === true)) { |
|  |  | // Special tag used to call TCPDF methods |
|  |  | if (isset($tag['attribute']['method'])) { |
|  |  | $tcpdf\_method = $tag['attribute']['method']; |
|  |  | if (method\_exists($this, $tcpdf\_method)) { |
|  |  | if (isset($tag['attribute']['params']) AND (!empty($tag['attribute']['params']))) { |
|  |  | $params = $this->unserializeTCPDFtagParameters($tag['attribute']['params']); |
|  |  | call\_user\_func\_array(array($this, $tcpdf\_method), $params); |
|  |  | } else { |
|  |  | $this->$tcpdf\_method(); |
|  |  | } |
|  |  | $this->newline = true; |
|  |  | // This tag is disabled by default by the K\_TCPDF\_CALLS\_IN\_HTML constant on TCPDF configuration file. |
|  |  | // Please use this feature only if you are in control of the HTML content and you are sure that it does not contain any harmful code. |
|  |  | if (!empty($tag['attribute']['data'])) { |
|  |  | $tcpdf\_tag\_data = $this->unserializeTCPDFtag($tag['attribute']['data']); |
|  |  | if ($this->allowedTCPDFtag($tcpdf\_tag\_data['m'])) { |
|  |  | call\_user\_func\_array(array($this, $tcpdf\_tag\_data['m']), $tcpdf\_tag\_data['p']); |
|  |  | } |
|  |  | $this->newline = true; |
|  |  | } |
|  |  | } |
|  |  | break; |
| Expand Down  Expand Up | | @@ -21867,25 +21871,23 @@ public function commitTransaction() { |
|  |  | \* @since 4.5.029 (2009-03-19) |
|  |  | \*/ |
|  |  | public function rollbackTransaction($self=false) { |
|  |  | if (isset($this->objcopy)) { |
|  |  | $objcopy = $this->objcopy; |
|  |  | $this->\_destroy(true, true); |
|  |  | if ($self) { |
|  |  | $objvars = get\_object\_vars($objcopy); |
|  |  | foreach ($objvars as $key => $value) { |
|  |  | $this->$key = $value; |
|  |  | } |
|  |  | $objcopy->\_destroy(true, true); |
|  |  | /\* The unique file\_id should not be used during cleanup again \*/ |
|  |  | $objcopy->file\_id = NULL; |
|  |  | unset($objcopy); |
|  |  | return $this; |
|  |  | } |
|  |  | /\* The unique file\_id should not be used during cleanup again \*/ |
|  |  | $this->file\_id = NULL; |
|  |  | return $objcopy; |
|  |  | } |
|  |  | return $this; |
|  |  | if (!isset($this->objcopy)) { |
|  |  | return $this; |
|  |  | } |
|  |  | $file\_id = $this->file\_id; |
|  |  | $objcopy = $this->objcopy; |
|  |  | $this->\_destroy(true, true); |
|  |  | if ($self) { |
|  |  | $objvars = get\_object\_vars($objcopy); |
|  |  | foreach ($objvars as $key => $value) { |
|  |  | $this->$key = $value; |
|  |  | } |
|  |  | $objcopy->\_destroy(true, true); |
|  |  | unset($objcopy); |
|  |  | return $this; |
|  |  | } |
|  |  | $this->file\_id = $file\_id; |
|  |  | return $objcopy; |
|  |  | } |
|  |  |  |
|  |  | // --- MULTI COLUMNS METHODS ----------------------- |
| Expand Down | |  |

4 changes: 4 additions & 0 deletions

4
[tcpdf\_autoconfig.php](#diff-f1981f911fb0550288689aacda97488f672058405fd525a150c0588e588d1024 "tcpdf_autoconfig.php")

Show comments

[View file](/tecnickcom/TCPDF/blob/51cd1b39de5643836e62661d162c472d63167df7/tcpdf_autoconfig.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -228,6 +228,10 @@ |
|  |  | define('K\_TCPDF\_CALLS\_IN\_HTML', false); |
|  |  | } |
|  |  |  |
|  |  | if (!defined('K\_ALLOWED\_TCPDF\_TAGS')) { |
|  |  | define('K\_ALLOWED\_TCPDF\_TAGS', array()); |
|  |  | } |
|  |  |  |
|  |  | if (!defined('K\_TCPDF\_THROW\_EXCEPTION\_ERROR')) { |
|  |  | define('K\_TCPDF\_THROW\_EXCEPTION\_ERROR', false); |
|  |  | } |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `51cd1b3`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Ftecnickcom%2FTCPDF%2Fcommit%2F51cd1b39de5643836e62661d162c472d63167df7) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.

