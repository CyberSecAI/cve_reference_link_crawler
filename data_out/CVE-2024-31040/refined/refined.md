- **Root cause of vulnerability:** A heap-buffer-overflow error occurs in the `get_var_integer` function of NanoMQ due to incorrect bounds checking when parsing a variable-length integer from a buffer. The function reads beyond the allocated heap buffer.
- **Weaknesses/vulnerabilities present:** Heap-buffer-overflow. The `get_var_integer` function does not respect the boundaries of the provided buffer leading to out-of-bounds read.
- **Impact of exploitation:** The heap-buffer-overflow leads to undefined behavior, potentially causing crashes or enabling arbitrary code execution. The provided ASan report indicates a crash due to out-of-bounds read.
- **Attack vectors:** The vulnerability is triggered by sending a specially crafted MQTT packet (a series of hexstreams) to the NanoMQ server, which causes `get_var_integer` function to attempt to read past the end of a 14-byte allocated buffer.
- **Required attacker capabilities/position:** The attacker needs to be able to send MQTT packets to the NanoMQ server. The attacker can trigger the vulnerability with specific crafted hex streams.