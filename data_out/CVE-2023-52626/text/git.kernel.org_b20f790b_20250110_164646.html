

| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=3876638b2c7ebb2c9d181de1191db0de8cac143a)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=3876638b2c7ebb2c9d181de1191db0de8cac143a)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=3876638b2c7ebb2c9d181de1191db0de8cac143a)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=3876638b2c7ebb2c9d181de1191db0de8cac143a)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Rahul Rameshbabu <rrameshbabu@nvidia.com> | 2023-11-22 18:32:11 -0800 |
| --- | --- | --- |
| committer | Saeed Mahameed <saeedm@nvidia.com> | 2024-01-24 00:15:33 -0800 |
| commit | [3876638b2c7ebb2c9d181de1191db0de8cac143a](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=3876638b2c7ebb2c9d181de1191db0de8cac143a) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=3876638b2c7ebb2c9d181de1191db0de8cac143a)) | |
| tree | [20fe15124ab30c04f52b93d39b4d7214cdc1fd2e](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=3876638b2c7ebb2c9d181de1191db0de8cac143a) | |
| parent | [cfbc3608a8c69b48bf238bd68f768192f0238e0d](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=cfbc3608a8c69b48bf238bd68f768192f0238e0d) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=3876638b2c7ebb2c9d181de1191db0de8cac143a&id2=cfbc3608a8c69b48bf238bd68f768192f0238e0d)) | |
| download | [linux-3876638b2c7ebb2c9d181de1191db0de8cac143a.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-3876638b2c7ebb2c9d181de1191db0de8cac143a.tar.gz) | |

net/mlx5e: Fix operation precedence bug in port timestamping napi\_poll contextIndirection (\*) is of lower precedence than postfix increment (++). Logic
in napi\_poll context would cause an out-of-bound read by first increment
the pointer address by byte address space and then dereference the value.
Rather, the intended logic was to dereference first and then increment the
underlying value.
Fixes: 92214be5979c ("net/mlx5e: Update doorbell for port timestamping CQ before the software counter")
Signed-off-by: Rahul Rameshbabu <rrameshbabu@nvidia.com>
Reviewed-by: Tariq Toukan <tariqt@nvidia.com>
Signed-off-by: Saeed Mahameed <saeedm@nvidia.com>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=3876638b2c7ebb2c9d181de1191db0de8cac143a)

| -rw-r--r-- | [drivers/net/ethernet/mellanox/mlx5/core/en/ptp.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/net/ethernet/mellanox/mlx5/core/en/ptp.c?id=3876638b2c7ebb2c9d181de1191db0de8cac143a) | 2 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 1 insertions, 1 deletions

| diff --git a/drivers/net/ethernet/mellanox/mlx5/core/en/ptp.c b/drivers/net/ethernet/mellanox/mlx5/core/en/ptp.cindex c206cc0a84832e..078f56a3cbb2b3 100644--- a/[drivers/net/ethernet/mellanox/mlx5/core/en/ptp.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/net/ethernet/mellanox/mlx5/core/en/ptp.c?id=cfbc3608a8c69b48bf238bd68f768192f0238e0d)+++ b/[drivers/net/ethernet/mellanox/mlx5/core/en/ptp.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/net/ethernet/mellanox/mlx5/core/en/ptp.c?id=3876638b2c7ebb2c9d181de1191db0de8cac143a)@@ -213,7 +213,7 @@ static void mlx5e\_ptp\_handle\_ts\_cqe(struct mlx5e\_ptpsq \*ptpsq, mlx5e\_ptpsq\_mark\_ts\_cqes\_undelivered(ptpsq, hwtstamp); out: napi\_consume\_skb(skb, budget);- md\_buff[\*md\_buff\_sz++] = metadata\_id;+ md\_buff[(\*md\_buff\_sz)++] = metadata\_id; if (unlikely(mlx5e\_ptp\_metadata\_map\_unhealthy(&ptpsq->metadata\_map)) && !test\_and\_set\_bit(MLX5E\_SQ\_STATE\_RECOVERING, &sq->state)) queue\_work(ptpsq->txqsq.priv->wq, &ptpsq->report\_unhealthy\_work); |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-10 16:45:23 +0000

