=== Content from plugins.trac.wordpress.org_fc3aaa1b_20250111_015022.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ‚ÜóÔ∏é](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ‚ÜóÔ∏é](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ‚ÜóÔ∏é](https://central.wordcamp.org/)
  + [Meetups ‚ÜóÔ∏é](https://www.meetup.com/pro/wordpress/)
  + [Job Board ‚ÜóÔ∏é](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ‚ÜóÔ∏é](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ‚ÜóÔ∏é](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fchangeset%2F3129917)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ‚Üê [Previous Changeset](/changeset/3129916 "Changeset 3129916")
* [Next Changeset](/changeset/3129918 "Changeset 3129918") ‚Üí

---

# Changeset 3129917

View differences
inline
side by side

Show
lines around each change

Show the changes in full context

Ignore:

Blank lines

Case changes

White space changes

Timestamp:
08/02/2024 09:20:39 AM
([5 months](/timeline?from=2024-08-02T09%3A20%3A39Z&precision=second "See timeline at 08/02/2024 09:20:39 AM") ago)

Author:
dylanjkotze
Message:

style: updated version number

File:

1 edited

* [zephyr-project-manager/trunk/zephyr-project-manager.php](/browser/zephyr-project-manager/trunk/zephyr-project-manager.php?rev=3129917 "Show entry in browser")
  (modified)
  ([1 diff](#file0 "Show differences"))

### Legend:

Unmodified
Added
Removed

* ## [zephyr-project-manager/trunk/zephyr-project-manager.php](/changeset/3129917/zephyr-project-manager/trunk/zephyr-project-manager.php "Show the changeset 3129917 restricted to zephyr-project-manager/trunk/zephyr-project-manager.php")

  | [r3129916](/browser/zephyr-project-manager/trunk/zephyr-project-manager.php?rev=3129916#L7 "Show revision 3129916 of this file in browser") | [r3129917](/browser/zephyr-project-manager/trunk/zephyr-project-manager.php?rev=3129917#L7 "Show revision 3129917 of this file in browser") |  |
  | --- | --- | --- |
  | 7 | 7 | \* Description:¬† A modern project manager for WordPress to keep track of all your projects from within WordPress. |
  | 8 | 8 | \* Plugin URI:¬† ¬†https://zephyr-one.com |
  | 9 |  | \* Version:¬† ¬† ¬† 3.3.10~~0~~ |
  |  | 9 | \* Version:¬† ¬† ¬† 3.3.101 |
  | 10 | 10 | \* Author:¬† ¬† ¬† ¬†Dylan James |
  | 11 | 11 | \* License:¬† ¬† ¬† GPLv2 or later |

**Note:** See [TracChangeset](/wiki/TracChangeset)
for help on using the changeset viewer.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Unified Diff](?format=diff&new=3129917)
* [Zip Archive](?format=zip&new=3129917)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)



=== Content from wordpress.org_e4a7a720_20250111_015023.html ===


[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Showcase](https://wordpress.org/showcase/)
* [Hosting](https://wordpress.org/hosting/)
* Extend
  + [Themes](https://wordpress.org/themes/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Blocks](https://wordpress.org/blocks/)
  + [Openverse ‚ÜóÔ∏é](https://openverse.org/)
* Learn
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ‚ÜóÔ∏é](https://wordpress.tv/)
* Community
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [Events](https://events.wordpress.org/)
  + [Job Board ‚ÜóÔ∏é](https://jobs.wordpress.net/)
* About
  + [About WordPress](https://wordpress.org/about/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ‚ÜóÔ∏é](https://wordpress.org/gutenberg/)
* [Get WordPress](https://wordpress.org/download/)

Search in WordPress.org

[Get WordPress](https://wordpress.org/download/)

[WordPress.org](https://wordpress.org/)

[Plugin Directory](https://wordpress.org/plugins/)

Zephyr Project Manager

* [Submit a plugin](https://wordpress.org/plugins/developers/)
* [My favorites](https://wordpress.org/plugins/browse/favorites/)
* [Log in](https://login.wordpress.org/?redirect_to=https%3A%2F%2Fwordpress.org%2Fplugins%2Fzephyr-project-manager&locale=en_US)

* [Submit a plugin](https://wordpress.org/plugins/developers/)
* [My favorites](https://wordpress.org/plugins/browse/favorites/)
* [Log in](https://login.wordpress.org/?redirect_to=https%3A%2F%2Fwordpress.org%2Fplugins%2Fzephyr-project-manager&locale=en_US)

Search plugins

![](https://ps.w.org/zephyr-project-manager/assets/banner-772x250.png?rev=1934187)
![](https://ps.w.org/zephyr-project-manager/assets/icon-128x128.png?rev=1934187)
# Zephyr Project Manager

By Dylan James

[Download](https://downloads.wordpress.org/plugin/zephyr-project-manager.zip)

* [Details](https://wordpress.org/plugins/zephyr-project-manager/#description)
* [Reviews](https://wordpress.org/plugins/zephyr-project-manager/#reviews)
* [Installation](https://wordpress.org/plugins/zephyr-project-manager/#installation)
* [Development](https://wordpress.org/plugins/zephyr-project-manager/#developers)

[Support](https://wordpress.org/support/plugin/zephyr-project-manager/)

## Description

Zephyr Project Manager is a modern, easy to use project manager for WordPress, to help manage all your projects and tasks effectively and get work done. It features a beautifully designed user interface to efficiently keep your projects on track. You can create unlimited projects, tasks and categories, start discussions on tasks and projects and upload files/attachments, manage files from the file manager page, view project progress using charts and use the built-in calendar, just to name a few features.

#### Core Features

#### Basic Version (Free)

**Projects**

* Create unlimited projects and customize them to your preference
* Set the name, start and end dates, description and category for your project
* Set the priority for your projects to manage them even more effectively
* Ability to copy projects and convert projects to tasks
* Recieve notifications via email of updates and completion
* Keep everyone informed via the discussion panel, where you can send attachments and messages and the team can respond and view the messages
* View progress chart of project completion and see progress at a glance
* Export and import projects to CSV and JSON

**Tasks**

* Create, view, edit and customize as many tasks as you want to
* Set the name, start and end dates, description, project and assignee for your task
* Assign tasks to users or teams
* Set the priority for your task to manage them even more effectively
* Mark tasks as complete/incomplete easily and open an overview of the task by clicking on them
* Create subtasks to break tasks down even more and make tasks even more descriptive and easy to complete
* Start discussions with other team memeber about the tasks, ask questions, and add attachments
* Copy tasks and convert tasks to projects
* Export and import tasks to and from CSV and JSON

**Android App**

* Download the official Android App now to manage your tasks and projects on the go. The app completely syncs with your website data and provides real time notifications to keep you in the loop

**Personal Dashboards**

* Each user has their own personal dashboards where they can see projects and tasks completed, their upcoming tasks and more from just a glance.

**Discussions & Attachments**

* Start discussions on projects or tasks and chat with other members on the progress of tasks
* Upload, download and view attachments straight to and from your tasks and projects

**Email Notifications**

* Recieve email updates on overdue tasks
* Receive weekly updates
* Receive updates on activity such as completed tasks, deleted tasks etc.
* Set your notification preferences and choose which notifications you would like to use

**File Manager**

* Upload files to tasks and projects and add comments to communicate with other members
* View all project and task files/attachments in one place and easily manage them
* Download, view info and delete files from the file manager, easily and effectively

**Categories**

* Create unlimited categories to keep your projects organized
* Set the category name description and color to make your projects unique
* Set the category of your projects and assign multiple categories as well

**Calendar**

* View all your completed and upcoming tasks in the calendar for an easy overview
* Easily see the work and time required to complete tasks and navigate effectively with the calender
* Set your own custom date format

**Progress**

* Create automatic progress charts for your projects and print them
* View progress charts for each project and set the status of projects
* Receive emails on project progress
* See the progress of projects, including completed tasks, pending tasks and more from the project list, for a comprehensive overview

**Teams & Members**

* View and manage all the members and teams in one place
* View team members progress and their work done from a single page
* Create teams and assign users to your teams
* Assign tasks to individual members or teams

**Customization**

* Zephyr Project Manager is highly customizable
* Set your profile details such as your custom name, profile picture, description, email notifications and more
* Change the colors used by the plugin to customize the interface to your preference
* Manage user capabilities and more
* I am always happy to take on customization requests if you contact me at dylanjkotze@gmail.com üôÇ

**Fully Translatable and Localized**

* Zephyr has been fully localized to be easily translated into any language

#### Professional Edition

* Customizable Frontend Project Manager page
* Kanban board style projects
* Asana Integration
* Custom Fields
* Custom Task Templates
* Custom Project Templates
* Reporting & Statistics
* And more‚Ä¶
* [Get the Pro Edition Now](https://zephyr-one.com/purchase-pro)

New Features Coming Soon:

\* WooCommerce Integration

\* Majorly improved Basic and Pro version with lots of new features and improvements

\* Editable email templates and more

For more information and documentation, please visit [the website](https://zephyr-one.com)

### Feature Requests

I am always looking to improve the plugin and add more useful features. If there are any features you feel may be missing or if you have any feedback, please feel free to contact me and I will be happy to add them

## Screenshots

* [![](https://ps.w.org/zephyr-project-manager/assets/screenshot-1.png?rev=1934190)](https://ps.w.org/zephyr-project-manager/assets/screenshot-1.png?rev=1934190)

  Create unlimited projects, customized to your preference
* [![](https://ps.w.org/zephyr-project-manager/assets/screenshot-2.png?rev=1934190)](https://ps.w.org/zephyr-project-manager/assets/screenshot-2.png?rev=1934190)

  Detailed projects
* [![](https://ps.w.org/zephyr-project-manager/assets/screenshot-3.png?rev=1934190)](https://ps.w.org/zephyr-project-manager/assets/screenshot-3.png?rev=1934190)

  Unlimited tasks, with start with helpful overview
* [![](https://ps.w.org/zephyr-project-manager/assets/screenshot-4.png?rev=1934190)](https://ps.w.org/zephyr-project-manager/assets/screenshot-4.png?rev=1934190)

  Create detailed tasks to stay organized
* [![](https://ps.w.org/zephyr-project-manager/assets/screenshot-5.png?rev=1934190)](https://ps.w.org/zephyr-project-manager/assets/screenshot-5.png?rev=1934190)

  Quick task information view
* [![](https://ps.w.org/zephyr-project-manager/assets/screenshot-6.png?rev=1934190)](https://ps.w.org/zephyr-project-manager/assets/screenshot-6.png?rev=1934190)

  Easily edit and manage projects
* [![](https://ps.w.org/zephyr-project-manager/assets/screenshot-7.png?rev=1934190)](https://ps.w.org/zephyr-project-manager/assets/screenshot-7.png?rev=1934190)

  Discuss projects with other members
* [![](https://ps.w.org/zephyr-project-manager/assets/screenshot-8.png?rev=1934190)](https://ps.w.org/zephyr-project-manager/assets/screenshot-8.png?rev=1934190)

  Create categories to categorize projects
* [![](https://ps.w.org/zephyr-project-manager/assets/screenshot-9.png?rev=1934190)](https://ps.w.org/zephyr-project-manager/assets/screenshot-9.png?rev=1934190)

  Change your picture, name, description and notification preferences
* [![](https://ps.w.org/zephyr-project-manager/assets/screenshot-11.png?rev=1934190)](https://ps.w.org/zephyr-project-manager/assets/screenshot-11.png?rev=1934190)

  Easily manage and view all uploaded files from discussions
* [![](https://ps.w.org/zephyr-project-manager/assets/screenshot-12.png?rev=1934190)](https://ps.w.org/zephyr-project-manager/assets/screenshot-12.png?rev=1934190)

  Get a high overview of tasks that need to be done using the Calender
* [![](https://ps.w.org/zephyr-project-manager/assets/screenshot-13.png?rev=1934190)](https://ps.w.org/zephyr-project-manager/assets/screenshot-13.png?rev=1934190)

  See what is going on via the Activity page

## Installation

1. Upload the plugin files to the `/wp-content/plugins/plugin-name` directory, or install the plugin through the WordPress ‚ÄòPlugins‚Äô > ‚ÄòAdd New‚Äô screen directly.
2. Activate the plugin through the ‚ÄòPlugins‚Äô screen in your WordPress Dashboard
3. Navigate to the Zephyr Project Manager option in the sidebar to start using the features of the plugin
4. From here you can create new projects, tasks, files, discussions and much more.
5. View the full documentation here for a guide on using the features.
6. If you experience any problems, please do not hesitate to contact me at dylanjkotze@gmail.com and I would be more than happy to help.

## Reviews

![](https://secure.gravatar.com/avatar/531228ed678bd24185b34c0d2fddcde9de16678251a6f86b37de26fc6670bf3c?s=60&d=retro&r=g)
### [I always come back to this plugin‚Ä¶](https://wordpress.org/support/topic/i-always-come-back-to-this-plugin-2/)

[Peter](https://profiles.wordpress.org/pijag/ "Posts by Peter")
April 6, 2024
1 reply

Generally, I have tried all similar solutions for the markets and I always come back to Zephyr.
Many thanks to the developer for a truly great product.

![](https://secure.gravatar.com/avatar/ea167a9bb25d826b32aca2e11fa9f8ac60a57486b896b647bd49c01ebdc952e4?s=60&d=retro&r=g)
### [Zephyr Project Manager Best Plugin EverÔºÅÔºÅÔºÅ](https://wordpress.org/support/topic/zephyr-project-manager-best-plugin-ever%EF%BC%81%EF%BC%81%EF%BC%81/)

[fh888](https://profiles.wordpress.org/fh888/ "Posts by fh888")
March 25, 2024
1 reply

This Zephyr Project Manager WordPress plugin is the most user-friendly and cost-effective solution for managing company projects and tasks. Setting it up is incredibly easy! I enthusiastically recommend it to anyone!

![](https://secure.gravatar.com/avatar/68ae25a7e01c844a53285f45064af09f0bb80b64ef5092d5d342b78d4090e42f?s=60&d=retro&r=g)
### [Best PM Software Hands Down](https://wordpress.org/support/topic/best-pm-software-hands-down/)

[darinandrews1977](https://profiles.wordpress.org/darinandrews1977/ "Posts by darinandrews1977")
January 1, 2024
2 replies

I have been looking for a reliable project management software for my business and wordpress plugins have all had problems that I could not get fixed by the developers.. After I upgraded to the pro version I instantly ran into a few problems and was frustrated that I had to once again try to get it handled. I emailed Dylan and could not believe how fast he actually got back to me.. He was all over getting me fixed up, and in the end I probably cost him time but he got me going.. If I could give him a 10 star I would and I am grateful to have found this plugin.. Can‚Äôt wait to get to work tomorrow! Thanks again Dylan, you are awesome!

![](https://secure.gravatar.com/avatar/a6dc3b37c6c1252477f6c546aabca717c5e0d1fef85af759ae069f94a3fbb794?s=60&d=retro&r=g)
### [Poor documentation, slow support](https://wordpress.org/support/topic/badly-flawed-frontend/)

[genoxpress](https://profiles.wordpress.org/genoxpress/ "Posts by genoxpress")
August 25, 2023
3 replies

I took the upgrade especially because of the ‚ÄúFrontend Project Manager‚Äù.
Really disappointed that it does not allow for navigation beyond the dashboard. Just returns 404 error if you attempt to reach sections like ‚ÄúProjects‚Äù, ‚ÄúTasks‚Äù, etc.
It means the user ‚Äúmust‚Äù sign in to the WP dashboard to get things done
Update: I‚Äôm adding only 1 more star. The bare bones documentation on this plugin is holding it back in my opinion.

![](https://secure.gravatar.com/avatar/2eb426857835beb8565e7fad6437393295b0b84f32d2d56e7825bb02d67c4299?s=60&d=retro&r=g)
### [Amazing plugin functionality and best support](https://wordpress.org/support/topic/amazing-plugin-functionality-and-best-support/)

[lukapeteh](https://profiles.wordpress.org/lukapeteh/ "Posts by lukapeteh")
July 25, 2023
1 reply

I have been looking for a plugin that would easily replace Trello that I used to use when managing all sorts of projects. When building websites you have to be able to control the whole process, know what tasks need to be completed in what time, and me as a manager I need to know everything about the project itself. And here comes the great solution ‚ÄúZephyr PRO Plugin for Wordpress‚Äù. Even with a free version you can manage projects but when buying a very cheap PRO version you can see that this plugin was made specifically for project managers. I would really advise to check out the plugin and give the PRO version a shot. Categories, custom fields, reporting and analysis are amazing futures that really make this plugin stand out. I tried 6 different solutions but Zephyr PRO makes the most sense! And also: The support via email is great. I received my response in about 3 hours with detailed help. Thanks again!

![](https://secure.gravatar.com/avatar/e55022bb215488914c5520cd445ab8bab47a5a28a9224587212d3ad587500bc9?s=60&d=retro&r=g)
### [Great plugin if it works](https://wordpress.org/support/topic/great-plugin-34266/)

[24steps](https://profiles.wordpress.org/24steps/ "Posts by 24steps")
June 5, 2023
1 reply

<p>This is a super nice project manager. I‚Äôm really keen to know when you will add gantt chart module. Can you estimate when? Many thanks, Ceri</p>
<p>¬†</p>
<p>UPDATE 2023</p>
<p>I paid for the premium version of this plugin and it is installed and active on my server but it has stopped working and i am getting a message to ‚Äòinstall premium‚Äô. ¬†It was apparently a one time fee so I‚Äôm disappointed at this development. ¬†Unfortunately there is no way to contact Dylan other than leaving a review on here. ¬†:(</p>

[Read all 96 reviews](https://wordpress.org/support/plugin/zephyr-project-manager/reviews/)
## Contributors & Developers

‚ÄúZephyr Project Manager‚Äù is open source software. The following people have contributed to this plugin.

Contributors

* ![](https://secure.gravatar.com/avatar/eb03a9587fc0503e3c3c2e28fab2d2ce59ab5d4cbc00a35d6e2d791bc1a4cf12?s=32&d=mm&r=g) [Dylan James](https://profiles.wordpress.org/dylanjkotze/)

‚ÄúZephyr Project Manager‚Äù has been translated into 5 locales. Thank you to [the translators](https://translate.wordpress.org/projects/wp-plugins/zephyr-project-manager/contributors) for their contributions.

[Translate ‚ÄúZephyr Project Manager‚Äù into your language.](https://translate.wordpress.org/projects/wp-plugins/zephyr-project-manager)

### Interested in development?

[Browse the code](https://plugins.trac.wordpress.org/browser/zephyr-project-manager/), check out the [SVN repository](https://plugins.svn.wordpress.org/zephyr-project-manager/), or subscribe to the [development log](https://plugins.trac.wordpress.org/log/zephyr-project-manager/) by [RSS](https://plugins.trac.wordpress.org/log/zephyr-project-manager/?limit=100&mode=stop_on_copy&format=rss).

## Changelog

#### 3.3.105

* Fixed vulnerability
* Updated textdomain loading to fix PHP notice

#### 3.3.103

* Fixed vulnerabilities

#### 3.3.102

* Fixed vulnerability

#### 3.3.101

* Fixed file upload vulnerability
* Fixed project and task deletion vulnerability

#### 3.3.100

* Fixed vulnerability with CSV export
* Tested with WP 6.6

#### 3.3.95

* Fixed date issue when using some languages
* Tested with WP 6.5

#### 3.3.95

* Fixed file upload issue

#### 3.3.94

* Fixed display if there are no tasks created yet
* Fixed vulnerability in advanced settings

#### 3.3.93

* Added breadcrumbs to tasks, subtasks and projects for easier navigation
* Removed redundant collapse button
* Added contrast improvements
* Added ability to set the current user as the default task assignee
* Added the ability to set the start and due date to the current date by default

#### 3.3.91

* Fixed vulnerability

#### 3.3.9

* Added ‚ÄúDefault Project Tab‚Äù setting to set which tab is initially displayed on the single project page
* Tested with WP 6.2
* Fixed project button issue

= 3.3.8

\* Added ability to drag and re-order subtasks

\* Added ability to download project as PDF

\* Added project status label display to the project grid

\* Fixed completed status projects

= 3.3.7

\* Added ‚ÄúDelete Assigned Tasks‚Äù permission

\* Added ‚ÄúDelete Assigned Projects‚Äù permission

= 3.3.69

\* Added option to customize calendar text color

\* Made status filter show only users tasks if on My Tasks

\* Fixed filename ‚ÄúUntitled‚Äù issue on files page

\* Fixed calendar date issue

= 3.3.68

\* Added ability to filter tasks by status from the tasks page in the backend

\* Removed ability to edit your own role as admin from the user edit page

= 3.3.67

\* Fixed issue when creating multiple tasks at the same time

\* Added ability to set parent task from the new task modal

\* Added ability to import iCal files from the Calendar page

\* Added ‚ÄúShow calendar due date only‚Äù setting to set whether calendar tasks span the full width or only show the end date on the calendar

= 3.3.66

\* Added ability to create a task list, with easy navigation

\* Added ability to sync ICS file, which is publicly accessible

\* Improved accessibility and ARIA compliance

\* Added ‚ÄòCategories‚Äô field to new task and task edit pages

\* Added keyboard shortcuts for faster workflows

\* Added new notification option to set whether project assignees receive new task notifications of a task created within a project they are part of

\* Fixed local file upload issue

\* Added ability to upload multiple files at once using the local file picker

= 3.3.64

\* Moved task settings to basic version

\* Updated German translations

= 3.3.63

\* Added ‚ÄúBlocking Tasks‚Äù feature that can be enabled from Zephyr > General Settings

\* Added ‚ÄúHide Completed Tasks in My Tasks‚Äù setting in Zephyr > General Settings to hide tasks that are completed

\* Various other changes and improvements

\* Updated German translations

= 3.3.62

\* Added all statuses to calendar status selection

= 3.3.61

\* Added task status changed email

\* Fixed duplicate setting and view members setting

= 3.3.6

\* Improved readability and fixed low contrast text issues

\* Added File Icon and Folder Icon settings

\* Fixed CSV export issue

= 3.3.59

\* Added new extended file picker with the ability to enter external file links as well. Can be enabled from Zephyr > Settings > General > ‚ÄòEnable extended file uploader with external link input‚Äô.

\* Improved file display for folder and documents

\* Added setting to change calendar item colors to use category color, status color or priority color

= 3.3.58

\* Added new ‚ÄúEdit Assigned Tasks‚Äù permission

\* Fixed permission issue with non-Zephyr related roles

= 3.3.57

\* Added two new permissions: ‚ÄúEdit Statuses‚Äù and ‚ÄúEdit Priorities‚Äù

\* Changed fonts to be loaded locally instead of from Google fonts

\* Changed icons and other CDN content to load locally instead

\* Fixed issue with direct link to project not allowing opening of popup menu

\* Improved loading of unnecessary shortcode and frontend scripts/styles when not needed

= 3.3.56

\* Changed style of new project popup

\* Made project description field resizable

= 3.3.55

\* Fixed projects page error

= 3.3.54

\* Updated German translations

\* Added subtasks to task list, shown in a hierarchy

\* Fixed some styling issues

\* Added new setting to allow automatically removing users from tasks when removed from the project, and adding them to project when a task is created in that project

= 3.3.53

\* Added new ‚ÄúAllow users to only view categories assigned to them‚Äù setting

= 3.3.52

\* Updated and improved German translations

\* Added translation support for default statuses and priorities

\* Fixed translation issues on Welcome page and with Projects plural

= 3.3.5

\* Fixed project view description edit issue

\* Fixed ‚ÄúMy Tasks‚Äù showing tasks you created as well as are assigned to

\* Fixed undefined has being added to the URL when clicking on some tabs

\* Improved styling of project progress chart

\* Improved contrast in form label colors and improved readability

\* Added task hamburger menu to the task detail page as well

\* Changed ‚ÄúProject Assignees‚Äù to ‚ÄúProject Managers‚Äù

\* Added ‚ÄúMembers‚Äù and ‚ÄúTeams‚Äù groups to the project ‚ÄúMember‚Äù selection field

\* Added improved German translations

\* Added new action hook for when project members are removed

= 3.3.4

\* Added new ‚ÄúDirectly Link to Project‚Äù setting under Zephyr > Settings > General settings to skip the project popup and link directly to the detail page

\* Added new ‚ÄúDirectly Link to Task‚Äù setting under Zephyr > Settings > General settings to skip the task popup and link directly to the detail page

\* Changed activity viewing permissions so only administrators can see all activity and members can see only their own activity, activity related to tasks and projects they are part of, or activity related to team members

= 3.3.3

\* Added new ‚ÄúCreate Categories‚Äù permission to set who can create categories.

\* Added new ‚ÄúView Assigned Project Tasks‚Äù permission to set whether a user can view tasks assigned to a project without having to be assigned to each task, and only having to be assigned to the project.

\* Fixed ‚ÄúAdd New‚Äù button shown on the tasks page if they don‚Äôt have the permission to create tasks.

= 3.3.2

\* REST API improvements and fixes

\* Fixed issues with user permissions when creating files

\* Fixed project edit permission issue

= 3.3.1

\* Fixed issues with task and project creation and editing permissions

= 3.3.0

\* Added all user roles to the Zephyr > Permission settings, to allow setting Zephyr permissions for built in roles as well as custom roles

\* Fixed mobile app issue

\* Styling improvements

#### 3.2.61

* Tested with WP 6.1

#### 3.2.55

* Added additional AJAX checks for permissions
* Added new setting to set who can access Zephyr based on their user role in Zephyr > Settings
* Added project sorting functionality to sort projects by date created, date due, alphabetically ascending, alphabetically descending and by priority

#### 3.2.54

* Fixed user member edit issue
* Fixed datepicker styling
* Fixed archived project view
* Fixed blurry text in new project popup
* Fixed small description field issue in new project popup
* Prevented accidental removal of your own Zephyr access as an administrator from the access controls

#### 3.2.53

* Fixed assignee bug on tasks with multiple assignees
* Fixed timezone issues

#### 3.2.52

* Fixed file uploads in discussions and messages not sending

#### 3.2.5

* Fixed ‚ÄòNo subtasks‚Äô message not removed after creating the first subtask sometimes
* Fixed issue when creating multiple tasks inside a project at once, assigning not working correctly
* Added full AJAX authentication, sanitization and validation
* Added full REST API authentication, sanitization and validation
* Fixed security vulnerabilities

#### 3.2.42

* Fixed new subtask option, not working with create tasks capability
* Improved member project picker by allowing searching, and showing it in a dropdown instead of single toggles
* Fixed non Zephyr members showing in project member picker
* Fixed issue with new task button shortcode
* Fixed importer issues
* Added the ‚ÄúRequire Authentication for REST API Requests‚Äù setting
* Added REST API Authentication functionality

#### 3.2.41

* Tested with WP 6.0
* Fixed security issue
* Updated Italian translations
* Improved welcome page to only show once, even if not clicking on the get started button, and not showing the Pro option on the welcome page if it is installed simultaneously

#### 3.2.31

* Tested and stable with PHP 8
* Fixed register\_rest\_route warning with permission callback
* Fixed warning
* Fixed calendar task display issue with colorless category
* Fixed calendar filter update issue

#### 3.2.1

* Various fixes and improvements
* Tested with WordPress 5.4.2
* Lots of new features in development and coming soon

#### 3.2.01

* Maintenance updates and small improvements

#### 3.2.0

* Added description and start and end date to subtasks to add more information
* Added project assignees
* Added ability to archive and unarchive projects
* Added new permission to allow only project assignees to edit their projects
* Improved dashboard project charts
* Fixed projects counting subtasks as completed tasks as well
* Fixed wrong timezone used for messages in the discussion panel
* Created new WooCommerce integration available on the website
* Added ability to set hour and minutes for tasks start and end dates
* Added ability to drag and change task orders on project pages
* Lots of other changes and improvements
* Tested with WP 5.3

#### 3.0.1

* Added French translations thanks a million to Laureline!
* Added recurring tasks to calendar
* Added ability to edit shortcode tasks
* Improved project category selection in the dashboard
* Added ‚Äòlist‚Äô view type for task list shortcode
* Added ability to set limit to task list via the shortcode
* Fixed issue with tasks table not being created on some hosting environments

#### 3.0.0

* Tested with WordPress 5.2 and fixed PHP notice
* Added new shortcode: Calendar [zephyr\_calendar]
* Added new shortcode: New Task Button [zephyr\_new\_task\_button]
* Added new shortcode: Display files [zephyr\_files]
* Added new shortcode: Upload File button [zephyr\_file\_upload]
* Added new shortcode: Display activity [zephyr\_activity]

#### 2.95.0

* New Feature: Task recurrence settings to set tasks to recur each day, each week, month or annually
* Improved calendar display and added more details information and color coding
* Added full multisite compatibility
* Lots of performance and optimization enhancements
* Assign categories to new projects
* Improved dashboard with user overview
* Group projects by categories
* Switch between project list and project grid view
* Fixed assignees not being selectable from the project quick task creation section
* Added mentions to discussions and tasks to easily mention users
* Improved progress section in projects and displays user progress as well
* Ability to select custom statuses from Project > Progress section
* Simplified and improved permission settings
* Ability to drag calendar items

#### 2.94.0

* Added Czech language translation with many thanks to Martin ≈†m√≠d üôÇ
* Added category selection to new project modal
* Added category select page to show projects by category

#### 2.93.0

* Improvements to mobile display
* Tested with WP 5.1.1
* Removed logging calls
* Fixed issue with status column not being created on install on some servers

#### 2.92.0

* Added the ability to create and set statuses and priorities for tasks and projects individualy
* Multiple assignees on tasks
* Improved project progress page with filtering and task progress overview
* Ability to display unique ID or project ID next to project name
* Added new shortcode options to show tasks from certain projects or certain users
* Fixed email issue and added project specific email settings
* Added user role management settings for administrators
* Fixed localization POT file issue
* Fixed JS error for non ES6 browsers

#### 2.91.0

* Added status color coding to calendar
* Added project, team, status and assignee filtering to the calendar

#### 2.90.0

* Custom priorities/statuses with custom name and colors can now be created and used
* Filtering projects by category has been added
* Fixed issue with tasks not showing in ‚ÄòMy Tasks‚Äô if in assigned ‚Äòteam‚Äô
* Send email notifications to all assigned ‚Äòteam members‚Äô as well
* Fixed tooltip items for charts not showing
* Fixed Export to CSV and JSON not working correctly and improved importing
* Fixed issue with new custom color settings only showing after reload, once saved
* Added task description to new task email notification
* Added ability to set custom email ‚Äòfrom name‚Äô and ‚Äòfrom email‚Äô for email notifications
* Fixed issue with multiple lines in comments only showing in one line

#### 2.89.0

* Added full RTL (right-to-left) support in both free and premium versions
* Added shortcode functionality to display single projects and tasks in the frontend
* Added more information to calendar events including assignee names, the project name and the description

#### 2.88.0

* New Feature: Added task and project priorities
* Fixed file upload issue on file manager page
* Fixed Calendar issue and redunant string in the beginning of each task
* Added localization support for missing strings and calendar
* Added custom date format and date localization
* Styling improvements and compatibility issues

#### 2.87.0

* Improvement: Realtime notifications for new messages, new tasks and new projects created by users
* Android Mobile App is now available in the Free version
* Added realtime push notifications to apps
* Shortcuts for creating new projects and tasks and pressing enter to create tasks or projects when the popup is open
* Various styling improvemnets

#### 2.86.0

* Added validation for new tasks to check if start date is earlier than the due date
* Various styling fixes and improvements
* Styling fixes for IE browsers

#### 2.85.0

* Added localization for sidebar menu titles and page titles
* Fixed issue with project selection not updating after saving more than one task
* Styling improvements and enhancements

#### 2.84.0

* Fixed PHP error on Devices page

#### 2.83.0

* Improvement: Styling overhaul ‚Äì fixed many small styling issues and revamped the styling with some more modern styling
* Improvement: Automatically show changes made to task and projects name in the header of the edit page
* Fix: Added fallback for viewing tasks when there is a JS error
* Improvemnet: Added notifications sent to Android App
* Other: Removed the deactivation survey and the Patreon request notice and some other notices to provide less clutter

#### 2.82.0

* Fix: Fixed issue with tasks loading on Calendar on some pages due to incorrect rest URL
* Improvement: Added deactivation survey to the plugin to pinpoint if there are any major problems or features that people are needing
* Improvement: Added missing English strings in the PO file

#### 2.81.0

* Fix: Calendar task URL leading to incorrect URL in dashboard
* Fix: Added ‚ÄòTask Assigned‚Äô notification preference to Teams & Members edit section
* Fix: Tasks due this week email being sent if no tasks are due
* Fix: Added check for the rest URL to see if it is available to fix a Calendar issue

#### 2.8.0

* Fix: Fixed conflicting AJAX errors when error reporting is active
* Improvement: Completely internationalized the plugin for localization
* Improvement: Added loader/spinner for certain AJAX requests to improve the UX
* Improvement: Changed layout of dashboard to make it easier to use and get data from
* Improvement: Added team and project link to task modal view
* Imrpovement: Various small styling changes and improvements
* Added Spanish Translation with 100% translation

#### 2.79.0

* Fix: New task email notification is now only sent to assignee
* Fix: Emails only sent to members that have Zephyr access
* Fix: Overdue summary email was sent even if there are no overdue tasks
* Fix: Some browser notifications for overdue tasks were shown to the incorrect user and not the assignee
* Improvement: Added info section to Zephyr dashboard to show version numbers and indicate if Pro is installed
* Improvement: Default ‚ÄòAll Activity‚Äô and ‚ÄòWeekly Activity‚Äô to false
* Improvement: Added notificaiton option for ‚ÄòTask Assigned‚Äô

## Meta

* Version **3.3.105**
* Last updated **1 month ago**
* Active installations **1,000+**
* WordPress version **3.2 or higher**
* Tested up to **6.7.1**
* PHP version **5.2.4 or higher**
* Languages
  See all 6

  Close

  [Arabic](https://ar.wordpress.org/plugins/zephyr-project-manager/), [Bosnian](https://bs.wordpress.org/plugins/zephyr-project-manager/), [English (US)](https://wordpress.org/plugins/zephyr-project-manager/), [French (France)](https://fr.wordpress.org/plugins/zephyr-project-manager/), [Russian](https://ru.wordpress.org/plugins/zephyr-project-manager/), and [Turkish](https://tr.wordpress.org/plugins/zephyr-project-manager/).

  [Translate into your language](https://translate.wordpress.org/projects/wp-plugins/zephyr-project-manager)
* Tags [collaboration](https://wordpress.org/plugins/tags/collaboration/)[project manager](https://wordpress.org/plugins/tags/project-manager/)[projects](https://wordpress.org/plugins/tags/projects/)[task manager](https://wordpress.org/plugins/tags/task-manager/)[Tasks](https://wordpress.org/plugins/tags/tasks/)
* [Advanced View](https://wordpress.org/plugins/zephyr-project-manager/advanced/)

## Ratings

4.8 out of 5 stars.

* [88 5-star reviews
  5 stars

  88](https://wordpress.org/support/plugin/zephyr-project-manager/reviews/?filter=5)
* [1 4-star review
  4 stars

  1](https://wordpress.org/support/plugin/zephyr-project-manager/reviews/?filter=4)
* [4 3-star reviews
  3 stars

  4](https://wordpress.org/support/plugin/zephyr-project-manager/reviews/?filter=3)
* [1 2-star review
  2 stars

  1](https://wordpress.org/support/plugin/zephyr-project-manager/reviews/?filter=2)
* [2 1-star reviews
  1 star

  2](https://wordpress.org/support/plugin/zephyr-project-manager/reviews/?filter=1)

[Add my review](https://wordpress.org/support/plugin/zephyr-project-manager/reviews/#new-post)

[See all reviews](https://wordpress.org/support/plugin/zephyr-project-manager/reviews/)

## Contributors

* ![](https://secure.gravatar.com/avatar/eb03a9587fc0503e3c3c2e28fab2d2ce59ab5d4cbc00a35d6e2d791bc1a4cf12?s=32&d=mm&r=g) [Dylan James](https://profiles.wordpress.org/dylanjkotze/)
## Support

Issues resolved in last two months:

0 out of 1

[View support forum](https://wordpress.org/support/plugin/zephyr-project-manager/)

## Donate

Would you like to support the advancement of this plugin?

[Donate to this plugin](https://www.paypal.com/donate/?cmd=_donations&business=dylanjkotze@gmail.com&item_name=Zephyr+Project+Manager+Donation&currency_code=USD&source=url)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Privacy](https://wordpress.org/about/privacy/)

* [Showcase](https://wordpress.org/showcase/)
* [Themes](https://wordpress.org/themes/)
* [Plugins](https://wordpress.org/plugins/)
* [Patterns](https://wordpress.org/patterns/)

* [Learn](https://learn.wordpress.org/)
* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [WordPress.tv ‚Üó](https://wordpress.tv/)

* [Get Involved](https://make.wordpress.org/)
* [Events](https://events.wordpress.org/)
* [Donate ‚Üó](https://wordpressfoundation.org/donate/)
* [Five for the Future](https://wordpress.org/five-for-the-future/)

* [WordPress.com ‚Üó](https://wordpress.com/?ref=wporg-footer)
* [Matt ‚Üó](https://ma.tt/)
* [bbPress ‚Üó](https://bbpress.org/)
* [BuddyPress ‚Üó](https://buddypress.org/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our X (formerly Twitter) account](https://www.x.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)
* [Visit our YouTube channel](https://www.youtube.com/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)



=== Content from www.wordfence.com_95509099_20250111_015024.html ===


[![](https://www.wordfence.com/img/wordfence-intelligence-logo.svg)](/threat-intel/)

Have you found a vulnerability in a WordPress plugin or theme? Report vulnerabilities in WordPress plugins and themes through our [bug bounty program](https://www.wordfence.com/threat-intel/bug-bounty-program) and earn a bounty on all in-scope submissions, while we handle the responsible disclosure process on your behalf.

As a reminder, the Wordfence Intelligence Vulnerability Database API is completely free to query and utilize, both personally and commercially, and contains all the same vulnerability data as the user interface. Please review the API documentation and Webhook documentation for more information on how to query the vulnerability API endpoints and configure webhooks utilizing all the same data present in the Wordfence Intelligence user interface.

# Zephyr Project Manager <= 3.3.100 - Authenticated (Subscriber+) Stored Cross-Site Scripting via filename Parameter

 [Wordfence Intelligence](https://www.wordfence.com/threat-intel) ¬†¬†>¬†¬†  [Vulnerability Database](https://www.wordfence.com/threat-intel/vulnerabilities) ¬†¬†>¬†¬† Zephyr Project Manager <= 3.3.100 - Authenticated (Subscriber+) Stored Cross-Site Scripting via filename Parameter

6.4

**Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')**
**CVSS Vector**
[CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:N)

| CVE | [CVE-2024-7356](https://www.cve.org/CVERecord?id=CVE-2024-7356) |
| --- | --- |
| CVSS | 6.4 (Medium) |
| Publicly Published | August 2, 2024 |
| Last Updated | August 3, 2024 |
| Researcher | [wesley (wcraft)](https://www.wordfence.com/threat-intel/vulnerabilities/researchers/wesley-jhon) |

### Description

The Zephyr Project Manager plugin for WordPress is vulnerable to Stored Cross-Site Scripting via the ‚Äòfilename‚Äô parameter in all versions up to, and including, 3.3.100 due to insufficient input sanitization and output escaping. This makes it possible for authenticated attackers, with Subscriber-level access and above, to inject arbitrary web scripts in pages that will execute whenever a user accesses an injected page.

#### References

* [plugins.trac.wordpress.org](https://plugins.trac.wordpress.org/browser/zephyr-project-manager/trunk/assets/js/core-admin.js#L2975)
* [wordpress.org](https://wordpress.org/plugins/zephyr-project-manager/#developers)
* [plugins.trac.wordpress.org](https://plugins.trac.wordpress.org/changeset/3129917/)

#### Share

[Facebook](https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fzephyr-project-manager%2Fzephyr-project-manager-33100-authenticated-subscriber-stored-cross-site-scripting-via-filename-parameter&t=Zephyr%20Project%20Manager%20%3C%3D%203.3.100%20-%20Authenticated%20%28Subscriber%2B%29%20Stored%20Cross-Site%20Scripting%20via%20filename%20Parameter "Facebook")
[Twitter](https://twitter.com/share?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fzephyr-project-manager%2Fzephyr-project-manager-33100-authenticated-subscriber-stored-cross-site-scripting-via-filename-parameter&text=Zephyr%20Project%20Manager%20%3C%3D%203.3.100%20-%20Authenticated%20%28Subscriber%2B%29%20Stored%20Cross-Site%20Scripting%20via%20filename%20Parameter "Twitter")
[LinkedIn](https://www.linkedin.com/shareArticle?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fzephyr-project-manager%2Fzephyr-project-manager-33100-authenticated-subscriber-stored-cross-site-scripting-via-filename-parameter "LinkedIn")
Email

## Vulnerability Details for Zephyr Project Manager

#### [Zephyr Project Manager](https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/zephyr-project-manager)

| Software Type | Plugin |
| --- | --- |
| Software Slug | zephyr-project-manager [(view on wordpress.org)](https://wordpress.org/plugins/zephyr-project-manager) |
| Patched? | Yes |
| Remediation | Update to version 3.3.101, or a newer patched version |
| Affected Version | * <= 3.3.100 |
| Patched Version | * 3.3.101 |

This record contains material that is subject to copyright.

**Copyright 2012-2025 Defiant Inc.**

**License:**
Defiant hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute this software vulnerability information. Any copy of the software vulnerability information you make for such purposes is authorized provided that you include a hyperlink to this vulnerability record and reproduce Defiant's copyright designation and this license in any such copy.
**[Read more.](https://www.wordfence.com/wordfence-intelligence-terms-and-conditions/)**

**Copyright 1999-2025 The MITRE Corporation**

**License:**
CVE Usage: MITRE hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute Common Vulnerabilities and Exposures (CVE¬Æ). Any copy you make for such purposes is authorized provided that you reproduce MITRE's copyright designation and this license in any such copy.
**[Read more.](https://www.cve.org/Legal/TermsOfUse)**

Have information to add, or spot any errors? Contact us at wfi-support@wordfence.com so we can make any appropriate adjustments.

Did you know Wordfence Intelligence provides free personal and commercial API access to our comprehensive WordPress vulnerability database, along with a free webhook integration to stay on top of the latest vulnerabilities added and updated in the database? Get started today!

Learn more

Want to get notified of the latest vulnerabilities that may affect your WordPress site?
 Install Wordfence on your site today to get notified immediately if your site is affected by a vulnerability that has been added to our database.

Get Wordfence

The Wordfence Intelligence WordPress vulnerability database is completely free to access and query via API. Please review the documentation on how to access and consume the vulnerability data via API.

Documentation



=== Content from plugins.trac.wordpress.org_e1e1a166_20250111_015022.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ‚ÜóÔ∏é](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ‚ÜóÔ∏é](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ‚ÜóÔ∏é](https://central.wordcamp.org/)
  + [Meetups ‚ÜóÔ∏é](https://www.meetup.com/pro/wordpress/)
  + [Job Board ‚ÜóÔ∏é](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ‚ÜóÔ∏é](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ‚ÜóÔ∏é](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fbrowser%2Fzephyr-project-manager%2Ftrunk%2Fassets%2Fjs%2Fcore-admin.js)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ‚Üê [Previous Revision](/browser/zephyr-project-manager/trunk/assets/js/core-admin.js?rev=3111536 "Revision 3111536")
* Next Revision ‚Üí
* [Blame](/browser/zephyr-project-manager/trunk/assets/js/core-admin.js?annotate=blame "Annotate each line with the last changed revision (this can be time consuming...)")
* [Revision Log](/log/zephyr-project-manager/trunk/assets/js/core-admin.js)

---

# [source:](/browser?order=name "Go to repository root") [zephyr-project-manager](/browser/zephyr-project-manager?order=name "View zephyr-project-manager")/[trunk](/browser/zephyr-project-manager/trunk?order=name "View trunk")/[assets](/browser/zephyr-project-manager/trunk/assets?order=name "View assets")/[js](/browser/zephyr-project-manager/trunk/assets/js?order=name "View js")/[core-admin.js](/browser/zephyr-project-manager/trunk/assets/js/core-admin.js?order=name "View core-admin.js")

View diff against:

View revision:

| [Last change](/changeset/3115676/zephyr-project-manager/trunk/assets/js/core-admin.js "View differences") on this file was [3115676](/changeset/3115676/ "View changeset 3115676"), checked in by dylanjkotze, [6 months ago](/timeline?from=2024-07-10T14%3A38%3A21Z&precision=second "See timeline at 07/10/2024 02:38:21 PM") |
| --- |
| feat: make .csv and .json files generated for export temporary |
| **File size:** 134.2 KB | |

| Line |  |
| --- | --- |
| [1](#L1) | var¬†zephyrSocket¬†=¬†false; |
| [2](#L2) |  |
| [3](#L3) | if¬†(zpm\_localized.settings.node\_enabled)¬†{ |
| [4](#L4) | zephyrSocket¬†=¬†io('https://zephyr-project-manager.eu-4.evennode.com/'); |
| [5](#L5) | } |
| [6](#L6) |  |
| [7](#L7) | var¬†ZPM\_Manager¬†=¬†new¬†ZephyrProjects(); |
| [8](#L8) |  |
| [9](#L9) | const¬†zpmFilters¬†=¬†[]; |
| [10](#L10) |  |
| [11](#L11) | if¬†(zephyrSocket)¬†{ |
| [12](#L12) | zephyrSocket.on('connect',¬†function¬†(data)¬†{ |
| [13](#L13) | zephyrSocket.emit('join',¬†zpm\_localized.website); |
| [14](#L14) | }); |
| [15](#L15) | } |
| [16](#L16) |  |
| [17](#L17) | var¬†zpmProjects¬†=¬†[]; |
| [18](#L18) |  |
| [19](#L19) | function¬†zpmAddFilter(hookName,¬†callback)¬†{ |
| [20](#L20) | if¬†(!zpmFilters[hookName])¬†{ |
| [21](#L21) | zpmFilters[hookName]¬†=¬†[]; |
| [22](#L22) | } |
| [23](#L23) | zpmFilters[hookName].push(callback); |
| [24](#L24) | } |
| [25](#L25) |  |
| [26](#L26) | // Function to apply filters |
| [27](#L27) | function¬†zpmApplyFilter(hookName,¬†value)¬†{ |
| [28](#L28) | if¬†(zpmFilters[hookName])¬†{ |
| [29](#L29) | zpmFilters[hookName].forEach(callback¬†=>¬†{ |
| [30](#L30) | value¬†=¬†callback(value); |
| [31](#L31) | }); |
| [32](#L32) | } |
| [33](#L33) | return¬†value; |
| [34](#L34) | } |
| [35](#L35) |  |
| [36](#L36) | jQuery(document).ready(function¬†($)¬†{ |
| [37](#L37) |  |
| [38](#L38) | if¬†(zephyrSocket)¬†{ |
| [39](#L39) | zephyrSocket.on('task-created',¬†function¬†(data)¬†{ |
| [40](#L40) | //ZephyrProjects.sendDesktopNotification( 'New Task Created', 'A new task has been created called ' + data.name, 'icon.jpg' ); |
| [41](#L41) | }); |
| [42](#L42) | } |
| [43](#L43) |  |
| [44](#L44) | // Initialization functions |
| [45](#L45) | zpmInit(); |
| [46](#L46) | zpmSetupRippleEffect(); |
| [47](#L47) |  |
| [48](#L48) | ZephyrProjects.get\_projects(function¬†(response)¬†{ |
| [49](#L49) | zpmProjects¬†=¬†response; |
| [50](#L50) | }); |
| [51](#L51) |  |
| [52](#L52) | // Initialize |
| [53](#L53) | function¬†zpmInit()¬†{ |
| [54](#L54) | var¬†task\_loading\_ajax¬†=¬†null; |
| [55](#L55) | if¬†(ZephyrProjects.isCalendarPage())¬†{ |
| [56](#L56) | ZephyrProjects.initialize\_calendar(); |
| [57](#L57) | } |
| [58](#L58) | var¬†dateFormat¬†=¬†ZephyrProjects.getDateFormat(); |
| [59](#L59) | var¬†timeFormat¬†=¬†'HH:mm'; |
| [60](#L60) | //dateFormat = 'yy-mm-dd H:i'; |
| [61](#L61) | ZephyrProjects.colorPicker('#zpm\_project\_color, #zpm\_category\_color, .zpm-color-picker, #zpm\_colorpicker\_primary, #zpm\_colorpicker\_primary\_dark, #zpm\_colorpicker\_primary\_light, .zpm-color-picker'); |
| [62](#L62) |  |
| [63](#L63) | $('#zpm\_edit\_project\_start\_date').datepicker({¬†dateFormat:¬†dateFormat,¬†timeFormat:¬†timeFormat¬†}); |
| [64](#L64) | $('#zpm\_edit\_project\_due\_date').datepicker({¬†dateFormat:¬†dateFormat,¬†timeFormat:¬†timeFormat¬†}); |
| [65](#L65) | $('#zpm\_new\_task\_due\_date').datetimepicker({¬†dateFormat:¬†dateFormat,¬†timeFormat:¬†timeFormat¬†}); |
| [66](#L66) | ZephyrProjects.datetimepicker('#zpm\_new\_task\_start\_date'); |
| [67](#L67) | ZephyrProjects.datetimepicker('#zpm\_edit\_task\_start\_date'); |
| [68](#L68) | $('#zpm\_edit\_task\_due\_date').datetimepicker({¬†dateFormat:¬†dateFormat,¬†timeFormat:¬†timeFormat¬†}); |
| [69](#L69) | $('#zpm\_edit\_project\_end\_date').datepicker({¬†dateFormat:¬†dateFormat,¬†timeFormat:¬†timeFormat¬†}); |
| [70](#L70) | $("#zpm\_project\_due\_date").datepicker({¬†dateFormat:¬†dateFormat,¬†timeFormat:¬†timeFormat¬†}); |
| [71](#L71) | $("#zpm\_task\_due\_date").datetimepicker({¬†dateFormat:¬†dateFormat,¬†timeFormat:¬†timeFormat¬†}); |
| [72](#L72) | $(".zpm-datepicker").datepicker({¬†dateFormat:¬†dateFormat,¬†timeFormat:¬†timeFormat¬†}); |
| [73](#L73) | $('body').append('<div id="zpm\_notifcation\_holder"></div>'); |
| [74](#L74) | $('.zpm\_comment\_content').each(function¬†()¬†{ |
| [75](#L75) | $(this).html(ZephyrProjects.linkify($(this).html())); |
| [76](#L76) | }); |
| [77](#L77) | } |
| [78](#L78) |  |
| [79](#L79) | $('body').find('.zpm-multi-select').chosen({ |
| [80](#L80) | disable\_search\_threshold:¬†10, |
| [81](#L81) | width:¬†'100%' |
| [82](#L82) | }); |
| [83](#L83) |  |
| [84](#L84) | $('body').find('.zpm-chosen-select, .zpm-chosen').chosen({ |
| [85](#L85) | disable\_search\_threshold:¬†10, |
| [86](#L86) | width:¬†'100%' |
| [87](#L87) | }); |
| [88](#L88) |  |
| [89](#L89) | // Dropdown menu |
| [90](#L90) | $('body').on('click',¬†function¬†(e)¬†{ |
| [91](#L91) | target¬†=¬†$(e.target); |
| [92](#L92) | if¬†(target.hasClass('disabled'))¬†{ |
| [93](#L93) | return; |
| [94](#L94) | } |
| [95](#L95) | if¬†(target.find('.zpm\_dropdown\_menu').hasClass('active'))¬†{ |
| [96](#L96) | target.find('.zpm\_dropdown\_menu').removeClass('active'); |
| [97](#L97) | return; |
| [98](#L98) | } |
| [99](#L99) | if¬†(target.hasClass('active'))¬†{ |
| [100](#L100) | return; |
| [101](#L101) | } |
| [102](#L102) | if¬†(!$(e.target).data('zpm-pro-upsell'))¬†{ |
| [103](#L103) | $('body').find('.zpm-pro-notice').removeClass('active'); |
| [104](#L104) | } |
| [105](#L105) | $('.zpm\_dropdown\_menu').removeClass('active'); |
| [106](#L106) | if¬†(target.hasClass('zpm\_taskbar\_link')¬†||¬†target.hasClass('zpm\_taskbar\_list\_item'))¬†{ |
| [107](#L107) | const¬†$menu¬†=¬†target.closest('.zpm\_taskbar\_list\_item').find('.zpm\_dropdown\_menu'); |
| [108](#L108) | $menu.toggleClass('active'); |
| [109](#L109) | $menu.attr('aria-hidden',¬†$menu.hasClass('active')¬†?¬†'false'¬†:¬†'true'); |
| [110](#L110) | }¬†else¬†if¬†(target.hasClass('zpm\_options\_button')¬†||¬†target.hasClass('zpm\_project\_grid\_options')¬†||¬†target.hasClass('zpm\_project\_grid\_options\_icon')¬†||¬†target.hasClass('zpm\_category\_option\_icon'))¬†{ |
| [111](#L111) | const¬†$menu¬†=¬†target.find('.zpm\_dropdown\_menu') |
| [112](#L112) | $menu.toggleClass('active'); |
| [113](#L113) | $menu.attr('aria-hidden',¬†$menu.hasClass('active')¬†?¬†'false'¬†:¬†'true'); |
| [114](#L114) | } |
| [115](#L115) | }); |
| [116](#L116) |  |
| [117](#L117) | $('[zpm-open-modal]').on('click',¬†function¬†()¬†{ |
| [118](#L118) | var¬†modal\_id¬†=¬†$(this).attr('zpm-open-modal'); |
| [119](#L119) | ZephyrProjects.open\_modal(modal\_id); |
| [120](#L120) | }); |
| [121](#L121) |  |
| [122](#L122) | $('.zpm\_tab').on('click',¬†function¬†()¬†{ |
| [123](#L123) | var¬†target¬†=¬†$(this).data('target'); |
| [124](#L124) | $('.zpm\_tab').removeClass('active'); |
| [125](#L125) | $('.tab-pane').removeClass('active'); |
| [126](#L126) | $(this).addClass('active'); |
| [127](#L127) | $('.tab-pane[data-section="'¬†+¬†target¬†+¬†'"]').addClass('active'); |
| [128](#L128) | }); |
| [129](#L129) |  |
| [130](#L130) | $('body').on('click',¬†'[data-zpm-tab-trigger]',¬†function¬†()¬†{ |
| [131](#L131) | var¬†tab¬†=¬†$(this).data('zpm-tab-trigger'); |
| [132](#L132) | $('body').find('[data-zpm-tab-trigger]').removeClass('zpm\_tab\_selected'); |
| [133](#L133) | $(this).addClass('zpm\_tab\_selected'); |
| [134](#L134) | $('body').find('[data-zpm-tab]').removeClass('zpm\_tab\_active'); |
| [135](#L135) | $('body').find('[data-zpm-tab="'¬†+¬†tab¬†+¬†'"]').addClass('zpm\_tab\_active'); |
| [136](#L136) | ZephyrProjects.addParameterToURL('action',¬†tab); |
| [137](#L137) | }); |
| [138](#L138) |  |
| [139](#L139) | var¬†$zpmMemberList¬†=¬†$('#zpm-member-list\_\_table'); |
| [140](#L140) | if¬†($zpmMemberList.length¬†>¬†0)¬†{ |
| [141](#L141) | $zpmMemberList.DataTable(); |
| [142](#L142) | } |
| [143](#L143) |  |
| [144](#L144) | /\* Upload Profile Picture \*/ |
| [145](#L145) | var¬†mediaUploader; |
| [146](#L146) |  |
| [147](#L147) | $('.zpm\_settings\_profile\_picture').on('click',¬†function¬†()¬†{ |
| [148](#L148) | if¬†(mediaUploader)¬†{ |
| [149](#L149) | mediaUploader.open(); |
| [150](#L150) | return; |
| [151](#L151) | } |
| [152](#L152) |  |
| [153](#L153) | var¬†args¬†=¬†{ |
| [154](#L154) | title:¬†zpm\_localized.strings.choose\_image, |
| [155](#L155) | button:¬†{ |
| [156](#L156) | text:¬†zpm\_localized.strings.choose\_image |
| [157](#L157) | },¬†multiple:¬†false |
| [158](#L158) | }; |
| [159](#L159) |  |
| [160](#L160) | if¬†(zpm\_localized.settings.view\_own\_files)¬†{ |
| [161](#L161) | args.library¬†=¬†{}; |
| [162](#L162) | args.library.user¬†=¬†zpm\_localized.user\_id; |
| [163](#L163) | } |
| [164](#L164) |  |
| [165](#L165) | mediaUploader¬†=¬†wp.media.frames.file\_frame¬†=¬†wp.media(args); |
| [166](#L166) |  |
| [167](#L167) | var¬†image\_holder¬†=¬†$('.zpm\_settings\_profile\_image'); |
| [168](#L168) | var¬†image\_input¬†=¬†$('#zpm\_profile\_picture\_hidden'); |
| [169](#L169) |  |
| [170](#L170) | mediaUploader.on('select',¬†function¬†()¬†{ |
| [171](#L171) | var¬†attachment¬†=¬†mediaUploader.state().get('selection').first().toJSON(); |
| [172](#L172) | image\_holder.css('background-image',¬†'url('¬†+¬†attachment.url¬†+¬†')'); |
| [173](#L173) | image\_input.val(attachment.url); |
| [174](#L174) | }); |
| [175](#L175) | // Open the uploader dialog |
| [176](#L176) | mediaUploader.open(); |
| [177](#L177) | }); |
| [178](#L178) |  |
| [179](#L179) | // Import tasks via CSV |
| [180](#L180) | var¬†csvFileUploader; |
| [181](#L181) |  |
| [182](#L182) | $('#zpm\_import\_tasks\_from\_csv').on('click',¬†function¬†()¬†{ |
| [183](#L183) | if¬†(csvFileUploader)¬†{ |
| [184](#L184) | csvFileUploader.open(); |
| [185](#L185) | return; |
| [186](#L186) | } |
| [187](#L187) |  |
| [188](#L188) | var¬†args¬†=¬†{ |
| [189](#L189) | title:¬†zpm\_localized.strings.select\_csv, |
| [190](#L190) | button:¬†{ |
| [191](#L191) | text:¬†zpm\_localized.strings.choose\_file |
| [192](#L192) | },¬†multiple:¬†false |
| [193](#L193) | }; |
| [194](#L194) |  |
| [195](#L195) | if¬†(zpm\_localized.settings.view\_own\_files)¬†{ |
| [196](#L196) | args.library¬†=¬†{}; |
| [197](#L197) | args.library.user¬†=¬†zpm\_localized.user\_id; |
| [198](#L198) | } |
| [199](#L199) |  |
| [200](#L200) | csvFileUploader¬†=¬†wp.media.frames.file\_frame¬†=¬†wp.media(args); |
| [201](#L201) |  |
| [202](#L202) | csvFileUploader.on('select',¬†function¬†()¬†{ |
| [203](#L203) | var¬†attachment¬†=¬†csvFileUploader.state().get('selection').first().toJSON(); |
| [204](#L204) | zpm\_import\_tasks(attachment); |
| [205](#L205) | }); |
| [206](#L206) | // Open the uploader dialog |
| [207](#L207) | csvFileUploader.open(); |
| [208](#L208) | }); |
| [209](#L209) |  |
| [210](#L210) | // Import tasks via JSON |
| [211](#L211) | var¬†jsonFileUploader; |
| [212](#L212) | $('#zpm\_import\_tasks\_from\_json').on('click',¬†function¬†()¬†{ |
| [213](#L213) | if¬†(jsonFileUploader)¬†{ |
| [214](#L214) | jsonFileUploader.open(); |
| [215](#L215) | return; |
| [216](#L216) | } |
| [217](#L217) |  |
| [218](#L218) | var¬†args¬†=¬†{ |
| [219](#L219) | title:¬†zpm\_localized.strings.select\_json, |
| [220](#L220) | button:¬†{ |
| [221](#L221) | text:¬†zpm\_localized.strings.choose\_file |
| [222](#L222) | },¬†multiple:¬†false |
| [223](#L223) | }; |
| [224](#L224) |  |
| [225](#L225) | if¬†(zpm\_localized.settings.view\_own\_files)¬†{ |
| [226](#L226) | args.library¬†=¬†{}; |
| [227](#L227) | args.library.user¬†=¬†zpm\_localized.user\_id; |
| [228](#L228) | } |
| [229](#L229) |  |
| [230](#L230) | jsonFileUploader¬†=¬†wp.media.frames.file\_frame¬†=¬†wp.media(args); |
| [231](#L231) |  |
| [232](#L232) | jsonFileUploader.on('select',¬†function¬†()¬†{ |
| [233](#L233) | var¬†attachment¬†=¬†jsonFileUploader.state().get('selection').first().toJSON(); |
| [234](#L234) | zpm\_import\_tasks(attachment); |
| [235](#L235) | }); |
| [236](#L236) | // Open the uploader dialog |
| [237](#L237) | jsonFileUploader.open(); |
| [238](#L238) | }); |
| [239](#L239) |  |
| [240](#L240) | // Reset profile picture |
| [241](#L241) | $('#zpm\_reset\_profile\_picture').on('click',¬†function¬†()¬†{ |
| [242](#L242) | default\_image¬†=¬†$('#zpm\_gravatar').val(); |
| [243](#L243) | var¬†image\_holder¬†=¬†$('.zpm\_settings\_profile\_image'); |
| [244](#L244) | var¬†image\_input¬†=¬†$('#zpm\_profile\_picture\_hidden'); |
| [245](#L245) |  |
| [246](#L246) | image\_holder.css('background-image',¬†'url('¬†+¬†default\_image¬†+¬†')'); |
| [247](#L247) | image\_input.val(default\_image); |
| [248](#L248) | }); |
| [249](#L249) |  |
| [250](#L250) | /\* Charts and Data Vizualization \*/ |
| [251](#L251) | var¬†projects¬†=¬†[]; |
| [252](#L252) | var¬†labels¬†=¬†[]; |
| [253](#L253) |  |
| [254](#L254) | ZephyrProjects.ajax({ |
| [255](#L255) | action:¬†'zpm\_get\_projects' |
| [256](#L256) | },¬†function¬†(data)¬†{ |
| [257](#L257) | $.each(data,¬†function¬†(key,¬†val)¬†{ |
| [258](#L258) | if¬†(typeof¬†val¬†===¬†'undefined')¬†return; |
| [259](#L259) | projects.push({ |
| [260](#L260) | id:¬†val.id, |
| [261](#L261) | name:¬†val.name, |
| [262](#L262) | description:¬†val.description, |
| [263](#L263) | date\_created:¬†val.date\_created, |
| [264](#L264) | date\_due:¬†val.date\_due, |
| [265](#L265) | completed:¬†val.completed |
| [266](#L266) | }); |
| [267](#L267) | labels.push(val.name); |
| [268](#L268) | }); |
| [269](#L269) |  |
| [270](#L270) | var¬†canvas¬†=¬†$("#myChart"); |
| [271](#L271) | if¬†(canvas.length)¬†{ |
| [272](#L272) | var¬†ctx¬†=¬†canvas; |
| [273](#L273) | var¬†chart¬†=¬†new¬†Chart(ctx,¬†{ |
| [274](#L274) | type:¬†'bar', |
| [275](#L275) | data:¬†{ |
| [276](#L276) | labels:¬†labels, |
| [277](#L277) | datasets:¬†[{ |
| [278](#L278) | label:¬†zpm\_localized.strings.tasks\_completed, |
| [279](#L279) | data:¬†[12,¬†19,¬†3,¬†5], |
| [280](#L280) | backgroundColor:¬†[ |
| [281](#L281) | 'rgba(255, 99, 132, 0.2)', |
| [282](#L282) | 'rgba(54, 162, 235, 0.2)', |
| [283](#L283) | 'rgba(255, 206, 86, 0.2)', |
| [284](#L284) | 'rgba(75, 192, 192, 0.2)' |
| [285](#L285) | ], |
| [286](#L286) | borderColor:¬†[ |
| [287](#L287) | 'rgba(255,99,132,1)', |
| [288](#L288) | 'rgba(54, 162, 235, 1)', |
| [289](#L289) | 'rgba(255, 206, 86, 1)', |
| [290](#L290) | 'rgba(75, 192, 192, 1)' |
| [291](#L291) | ], |
| [292](#L292) | borderWidth:¬†1 |
| [293](#L293) | },¬†{ |
| [294](#L294) | label:¬†zpm\_localized.strings.tasks\_remaining, |
| [295](#L295) | data:¬†[10,¬†5,¬†9,¬†17], |
| [296](#L296) | backgroundColor:¬†[ |
| [297](#L297) | 'rgba(255, 99, 132, 0.2)', |
| [298](#L298) | 'rgba(54, 162, 235, 0.2)', |
| [299](#L299) | 'rgba(255, 206, 86, 0.2)', |
| [300](#L300) | 'rgba(75, 192, 192, 0.2)' |
| [301](#L301) | ], |
| [302](#L302) | borderColor:¬†[ |
| [303](#L303) | 'rgba(255,99,132,1)', |
| [304](#L304) | 'rgba(54, 162, 235, 1)', |
| [305](#L305) | 'rgba(255, 206, 86, 1)', |
| [306](#L306) | 'rgba(75, 192, 192, 1)' |
| [307](#L307) | ], |
| [308](#L308) | borderWidth:¬†1 |
| [309](#L309) | }] |
| [310](#L310) | }, |
| [311](#L311) | options:¬†{ |
| [312](#L312) | scales:¬†{ |
| [313](#L313) | yAxes:¬†[{ |
| [314](#L314) | ticks:¬†{ |
| [315](#L315) | beginAtZero:¬†true, |
| [316](#L316) | stepSize:¬†1, |
| [317](#L317) | callback:¬†function(value,¬†index,¬†values)¬†{ |
| [318](#L318) | return¬†parseInt(value); |
| [319](#L319) | }, |
| [320](#L320) | } |
| [321](#L321) | }] |
| [322](#L322) | } |
| [323](#L323) | } |
| [324](#L324) | }); |
| [325](#L325) | } |
| [326](#L326) | }); |
| [327](#L327) |  |
| [328](#L328) | // Display task reminders and notifications |
| [329](#L329) | ZephyrProjects.task\_reminders(); |
| [330](#L330) |  |
| [331](#L331) | jQuery('body').on('click',¬†'.zpm\_floating\_notification\_button',¬†function¬†()¬†{ |
| [332](#L332) | var¬†notification¬†=¬†jQuery(this).closest('.zpm\_floating\_notification'); |
| [333](#L333) | var¬†task\_id¬†=¬†notification.data('id'); |
| [334](#L334) | var¬†item¬†=¬†notification.data('item'); |
| [335](#L335) | notification.addClass('dismissed'); |
| [336](#L336) | localStorage.setItem(item¬†+¬†task\_id,¬†true); |
| [337](#L337) | }); |
| [338](#L338) |  |
| [339](#L339) | $('#zpm\_add\_new\_btn').on('click',¬†function¬†()¬†{ |
| [340](#L340) | const¬†$btn¬†=¬†$(this); |
| [341](#L341) | const¬†$dropdown¬†=¬†jQuery('body').find('#zpm\_add\_new\_dropdown'); |
| [342](#L342) | $btn.toggleClass('active'); |
| [343](#L343) | $btn.attr('aria-expanded',¬†$btn.hasClass('active')¬†?¬†'true'¬†:¬†'false'); |
| [344](#L344) | $dropdown.attr('aria-expanded',¬†$btn.hasClass('active')¬†?¬†'true'¬†:¬†'false'); |
| [345](#L345) | }); |
| [346](#L346) |  |
| [347](#L347) | $('#zpm\_create\_quickproject, #zpm\_first\_project, #zpm\_create\_new\_project').on('click',¬†function¬†()¬†{ |
| [348](#L348) | zpm\_close\_quicktask\_modal(); |
| [349](#L349) | ZephyrProjects.open\_modal('zpm\_project\_modal'); |
| [350](#L350) | $('.zpm\_project\_name\_input').focus(); |
| [351](#L351) | }); |
| [352](#L352) |  |
| [353](#L353) | $('.zpm\_fancy\_item').on('click',¬†function¬†()¬†{ |
| [354](#L354) | zpm\_close\_quicktask\_modal(); |
| [355](#L355) | }); |
| [356](#L356) |  |
| [357](#L357) | function¬†zpm\_close\_quicktask\_modal()¬†{ |
| [358](#L358) | $('body').find('#zpm\_add\_new\_btn').removeClass('active'); |
| [359](#L359) | $('body').find('#'¬†+¬†$('body').find('#zpm\_add\_new\_btn').data('zpm-dropdown-toggle')).removeClass('active'); |
| [360](#L360) | } |
| [361](#L361) |  |
| [362](#L362) | $('body').on('click',¬†'.zpm\_close\_modal',¬†function¬†()¬†{ |
| [363](#L363) | var¬†modalId¬†=¬†$(this).closest('.zpm-modal').attr('id'); |
| [364](#L364) | ZephyrProjects.close\_modal(); |
| [365](#L365) | }); |
| [366](#L366) |  |
| [367](#L367) | $('body').on('click',¬†'[data-zpm-trigger="remove\_modal"]',¬†function¬†()¬†{ |
| [368](#L368) | var¬†modalId¬†=¬†$(this).closest('.zpm-modal').attr('id'); |
| [369](#L369) | ZephyrProjects.remove\_modal(modalId); |
| [370](#L370) | }); |
| [371](#L371) |  |
| [372](#L372) | $('body').on('click',¬†'.zpm-modal-background[data-zpm-trigger="remove\_modal"]',¬†function¬†()¬†{ |
| [373](#L373) | $('.zpm-modal').remove(); |
| [374](#L374) | }); |
| [375](#L375) |  |
| [376](#L376) | $('body').on('click',¬†'[data-zpm-trigger="close\_modal"]',¬†function¬†()¬†{ |
| [377](#L377) | ZephyrProjects.close\_modal(); |
| [378](#L378) | }); |
| [379](#L379) |  |
| [380](#L380) | // Close modals when clicking on modal background |
| [381](#L381) | $('body').on('click',¬†'.zpm\_modal\_background',¬†function¬†()¬†{ |
| [382](#L382) | var¬†backgroundId¬†=¬†$(this).attr('id'); |
| [383](#L383) |  |
| [384](#L384) | if¬†(backgroundId¬†==¬†'zpm\_quickview\_project\_background')¬†{ |
| [385](#L385) | var¬†modalId¬†=¬†'zpm\_quickview\_modal'; |
| [386](#L386) | ZephyrProjects.remove\_modal(modalId); |
| [387](#L387) | }¬†else¬†{ |
| [388](#L388) | ZephyrProjects.close\_modal(); |
| [389](#L389) | } |
| [390](#L390) | }); |
| [391](#L391) |  |
| [392](#L392) | // New Project Modal |
| [393](#L393) | //var open\_modal = $('#zpm\_add\_new\_btn'); |
| [394](#L394) | //var close\_modal = $('#zpm\_project\_modal .close'); |
| [395](#L395) |  |
| [396](#L396) | var¬†modal¬†=¬†$('.zpm-modal'); |
| [397](#L397) |  |
| [398](#L398) | $(window).on('click',¬†function¬†(e)¬†{ |
| [399](#L399) | if¬†($(e.target)[0]¬†==¬†modal[0])¬†{ |
| [400](#L400) | $('body').find('.zpm\_modal\_background').remove(); |
| [401](#L401) | $('body').find('.zpm-modal').remove(); |
| [402](#L402) | } |
| [403](#L403) | }); |
| [404](#L404) |  |
| [405](#L405) | jQuery('body').on('change',¬†'[data-filter-tasks-status], #zpm-tasks-assignee-filter, [data-task-filter="sort"], #zpm-tasks-project-filter',¬†function¬†()¬†{ |
| [406](#L406) | zpmFilterTasks(); |
| [407](#L407) | }); |
| [408](#L408) |  |
| [409](#L409) | jQuery('body').on('click',¬†'#zpm\_filter\_tasks .zpm\_selection\_option, #zpm-tasks-filter-nav .zpm\_selection\_option',¬†function()¬†{ |
| [410](#L410) | setTimeout(function()¬†{ |
| [411](#L411) | zpmFilterTasks(); |
| [412](#L412) | },¬†100); |
| [413](#L413) | }); |
| [414](#L414) |  |
| [415](#L415) | $('body').on('click',¬†'.zpm\_project\_title',¬†function¬†(e)¬†{ |
| [416](#L416) | if¬†(!zpm\_localized.settings.direct\_link\_project)¬†{ |
| [417](#L417) | e.preventDefault(); |
| [418](#L418) | if¬†(e.target.className.indexOf('zpm\_project\_grid\_options')¬†>¬†-1)¬†{¬†return;¬†}; |
| [419](#L419) | var¬†title¬†=¬†$(this).text(); |
| [420](#L420) | var¬†content¬†=¬†'<input type="text" name="zpm\_project\_title"/>'; |
| [421](#L421) | content¬†+=¬†'<input type="text" name="zpm\_project\_description">'; |
| [422](#L422) | }¬†else¬†{ |
| [423](#L423) | const¬†target¬†=¬†$(e.target); |
| [424](#L424) |  |
| [425](#L425) | if¬†(target.hasClass('zpm\_project\_grid\_options')¬†||¬†target.closest('.zpm\_project\_grid\_options').length¬†>¬†0)¬†{ |
| [426](#L426) | e.preventDefault(); |
| [427](#L427) | return; |
| [428](#L428) | } |
| [429](#L429) | } |
| [430](#L430) | }); |
| [431](#L431) |  |
| [432](#L432) | // Custom Select Fields |
| [433](#L433) | $('body').on('click',¬†'.zpm\_select\_option',¬†function¬†(e)¬†{ |
| [434](#L434) | var¬†data¬†=¬†$(this).data(); |
| [435](#L435) | var¬†optionValue¬†=¬†$(this).html(); |
| [436](#L436) |  |
| [437](#L437) | $(this).closest('.zpm\_select\_dropdown').find('.zpm\_select\_option').each(function¬†()¬†{ |
| [438](#L438) | $(this).removeClass('selected'); |
| [439](#L439) | }); |
| [440](#L440) |  |
| [441](#L441) | $(this).closest('.zpm\_select\_trigger').find('.zpm\_selected\_option').html(optionValue); |
| [442](#L442) | $(this).closest('.zpm\_select\_trigger').removeClass('active'); |
| [443](#L443) | $(this).closest('.zpm\_select\_dropdown').removeClass('active'); |
| [444](#L444) | $(this).addClass('selected'); |
| [445](#L445) | }); |
| [446](#L446) |  |
| [447](#L447) | $('body').on('click',¬†'.zpm\_select\_trigger',¬†function¬†(e)¬†{ |
| [448](#L448) | var¬†data¬†=¬†$(this).data(); |
| [449](#L449) | $('.zpm\_select\_trigger').each(function¬†()¬†{ |
| [450](#L450) | var¬†thisData¬†=¬†$(this).data(); |
| [451](#L451) | }); |
| [452](#L452) |  |
| [453](#L453) | if¬†(e.target.className.indexOf('zpm\_select\_option')¬†<=¬†-1)¬†{ |
| [454](#L454) | $(this).toggleClass('active'); |
| [455](#L455) | $(this).find('.zpm\_select\_dropdown').toggleClass('active'); |
| [456](#L456) | } |
| [457](#L457) | }); |
| [458](#L458) |  |
| [459](#L459) | function¬†zpmNewModal(subject,¬†header,¬†content,¬†buttons,¬†modal\_id,¬†task\_id,¬†options,¬†project\_id,¬†navigation)¬†{ |
| [460](#L460) | var¬†modal\_navigation¬†=¬†(typeof¬†navigation¬†!==¬†'undefined'¬†&&¬†navigation¬†!==¬†'')¬†?¬†navigation¬†:¬†''; |
| [461](#L461) | var¬†modal\_settings¬†=¬†(typeof¬†options¬†!==¬†'undefined'¬†&&¬†options¬†!==¬†'')¬†?¬†'<span class="zpm\_modal\_options\_btn" data-dropdown-id="zpm\_view\_task\_dropdown"><i class="dashicons dashicons-menu"></i>'¬†+¬†options¬†+¬†'</span>'¬†:¬†''; |
| [462](#L462) | var¬†modal¬†=¬†'<div id="'¬†+¬†modal\_id¬†+¬†'" class="zpm-modal" data-modal-action="remove" data-task-id="'¬†+¬†task\_id¬†+¬†'" data-project-id="'¬†+¬†project\_id¬†+¬†'">'¬†+ |
| [463](#L463) | '<div class="zpm\_modal\_body">'¬†+ |
| [464](#L464) | '<h2>'¬†+¬†subject¬†+¬†'</h2>'¬†+ |
| [465](#L465) | '<h3 class="zpm\_modal\_task\_name">'¬†+¬†header¬†+¬†'</h3>'¬†+¬†modal\_settings¬†+ |
| [466](#L466) | modal\_navigation¬†+ |
| [467](#L467) | '<div class="zpm\_modal\_content">'¬†+¬†content¬†+¬†'</div>'¬†+ |
| [468](#L468) | '<div class="zpm\_modal\_buttons">'¬†+¬†buttons¬†+¬†'</div>'¬†+ |
| [469](#L469) | '</div>'¬†+ |
| [470](#L470) | '</div'; |
| [471](#L471) | $('body').append(modal); |
| [472](#L472) | ZephyrProjects.open\_modal(modal\_id); |
| [473](#L473) | } |
| [474](#L474) |  |
| [475](#L475) | $('body').on('click',¬†'#zpm\_quick\_task\_add',¬†function¬†()¬†{ |
| [476](#L476) | $('body').find('.zpm\_quicktask\_container').toggleClass('active'); |
| [477](#L477) | }); |
| [478](#L478) |  |
| [479](#L479) | ZephyrProjects.refreshProjectsProgressBar(); |
| [480](#L480) |  |
| [481](#L481) | $('body').on('click',¬†'.zpm\_project\_title',¬†function¬†(e)¬†{ |
| [482](#L482) | if¬†(!zpm\_localized.settings.direct\_link\_project)¬†{ |
| [483](#L483) | e.preventDefault(); |
| [484](#L484) | var¬†menu\_ids¬†=¬†[ |
| [485](#L485) | 'zpm\_add\_project\_to\_dashboard', |
| [486](#L486) | 'zpm\_delete\_project', |
| [487](#L487) | 'zpm-project-action\_\_archive', |
| [488](#L488) | 'zpm\_copy\_project', |
| [489](#L489) | 'zpm\_export\_project', |
| [490](#L490) | 'zpm\_export\_project\_to\_csv', |
| [491](#L491) | 'zpm\_export\_project\_to\_json', |
| [492](#L492) | 'zpm\_print\_project' |
| [493](#L493) | ]; |
| [494](#L494) |  |
| [495](#L495) | if¬†(e.target.className.indexOf('zpm\_project\_grid\_options')¬†>¬†-1¬†||¬†$.inArray($(e.target).attr('id'),¬†menu\_ids)¬†>¬†-1)¬†{ |
| [496](#L496) | return; |
| [497](#L497) | }; |
| [498](#L498) |  |
| [499](#L499) | var¬†title¬†=¬†$(this).find('.zpm\_project\_grid\_name').text(); |
| [500](#L500) | var¬†description¬†=¬†$(this).closest('.zpm\_project\_grid\_cell').find('.zpm\_project\_description').text(); |
| [501](#L501) | var¬†project\_link¬†=¬†$(this).attr('href'); |
| [502](#L502) | var¬†project\_id¬†=¬†$(this).data('project\_id'); |
| [503](#L503) | var¬†buttons¬†=¬†'<a class="zpm\_button" href="'¬†+¬†project\_link¬†+¬†'">'¬†+¬†zpm\_localized.strings.go\_to\_project¬†+¬†'</a>'; |
| [504](#L504) | var¬†task\_data¬†=¬†{ |
| [505](#L505) | project\_id:¬†project\_id |
| [506](#L506) | }; |
| [507](#L507) |  |
| [508](#L508) | ZephyrProjects.open\_modal('zpm\_quickview\_modal'); |
| [509](#L509) | var¬†project\_view\_modal¬†=¬†$('body').find('#zpm\_quickview\_modal'); |
| [510](#L510) | project\_view\_modal.html('<div class="zpm\_task\_loader"></div>'); |
| [511](#L511) | var¬†data¬†=¬†{ |
| [512](#L512) | action:¬†'zpm\_view\_project', |
| [513](#L513) | project\_id:¬†project\_id |
| [514](#L514) | }; |
| [515](#L515) |  |
| [516](#L516) | ZephyrProjects.ajax(data,¬†function¬†(response)¬†{ |
| [517](#L517) | project\_view\_modal.find('.zpm\_task\_loader').remove(); |
| [518](#L518) | project\_view\_modal.html(response.html); |
| [519](#L519) | $('body').find('.zpm\_quicktask\_content #zpm\_quicktask\_date').datepicker({¬†dateFormat:¬†ZephyrProjects.getDateFormat()¬†}); |
| [520](#L520) | $('body').find('.zpm\_quicktask\_content #zpm\_quicktask\_select\_assignee').chosen({ |
| [521](#L521) | disable\_search\_threshold:¬†10, |
| [522](#L522) | no\_results\_text:¬†zpm\_localized.strings.no\_users\_found, |
| [523](#L523) | width:¬†"100%" |
| [524](#L524) | }); |
| [525](#L525) |  |
| [526](#L526) | $('body').find('#zpm\_quickview\_modal').attr('data-project-id',¬†data.project\_id); |
| [527](#L527) |  |
| [528](#L528) | ZephyrProjects.get\_tasks(task\_data,¬†function¬†(response)¬†{ |
| [529](#L529) | //$('body').find('.zpm\_task\_loader').remove(); |
| [530](#L530) |  |
| [531](#L531) | //$('body').find('#zpm\_quickview\_modal .zpm\_modal\_content').html( response ); |
| [532](#L532) | }); |
| [533](#L533) | }); |
| [534](#L534) | // ZephyrProjects.get\_project( data, function( response ) { |
| [535](#L535) | //¬† ¬† ¬† $('body').find('#zpm-project-modal-overview').html(response.overview\_html); |
| [536](#L536) | //¬† ¬† ¬† $('body').find('#zpm-project-modal-discussion').html(response.comments\_html); |
| [537](#L537) | //¬† ¬† ¬† $('body').find('#zpm-project-modal-due-date').html(response.date\_due); |
| [538](#L538) | //¬† ¬† ¬† $('body').find('#zpm-project-preview\_\_header').after(response.priority\_html); |
| [539](#L539) | // }); |
| [540](#L540) | } |
| [541](#L541) | }); |
| [542](#L542) |  |
| [543](#L543) | $('body').on('click',¬†'.zpm\_task\_complete',¬†function¬†()¬†{ |
| [544](#L544) | $(this).toggleClass('completed'); |
| [545](#L545) | }); |
| [546](#L546) |  |
| [547](#L547) | $(document).on('zephyr\_new\_task\_modal\_opened',¬†function()¬†{ |
| [548](#L548) | const¬†isMyTasks¬†=¬†jQuery('body').find('#zpm-tasks-filter--my-tasks').hasClass('zpm\_nav\_item\_selected'); |
| [549](#L549) |  |
| [550](#L550) | if¬†(isMyTasks)¬†{ |
| [551](#L551) | jQuery('body').find('#zpm\_new\_task\_assignee').val(zpm\_localized.user\_id).trigger('chosen:updated'); |
| [552](#L552) | } |
| [553](#L553) | }); |
| [554](#L554) |  |
| [555](#L555) | /\* Open new task modal on Tasks page \*/ |
| [556](#L556) | $('body').on('click',¬†'#zpm\_task\_add\_new',¬†function¬†()¬†{ |
| [557](#L557) | jQuery.event.trigger({¬†type:¬†'zephyr\_new\_task\_modal\_opened',¬†data:¬†{}¬†}); |
| [558](#L558) | jQuery('body').find('#zpm\_create\_task #zpm\_new\_task\_name').focus(); |
| [559](#L559) | $('body').find('#zpm\_create\_task').addClass('active'); |
| [560](#L560) |  |
| [561](#L561) | ZephyrProjects.open\_modal(); |
| [562](#L562) | $('body').find('#zpm-new-task-template-select').trigger('change'); |
| [563](#L563) | $('body').find('select#zpm\_new\_task\_project').chosen({ |
| [564](#L564) | disable\_search\_threshold:¬†10, |
| [565](#L565) | no\_results\_text:¬†zpm\_localized.strings.no\_projects\_found, |
| [566](#L566) | width:¬†"100%" |
| [567](#L567) | }); |
| [568](#L568) | }); |
| [569](#L569) |  |
| [570](#L570) | /\* Open new task modal for the QuickAdd menu \*/ |
| [571](#L571) | $('body').on('click',¬†'#zpm\_quickadd\_task',¬†function¬†()¬†{ |
| [572](#L572) | jQuery.event.trigger({¬†type:¬†'zephyr\_new\_task\_modal\_opened',¬†data:¬†{}¬†}); |
| [573](#L573) | jQuery('body').find('#zpm\_create\_task #zpm\_new\_task\_name').focus(); |
| [574](#L574) | ZephyrProjects.open\_modal('zpm\_create\_task'); |
| [575](#L575) | var¬†modal¬†=¬†jQuery('body').find('#zpm\_create\_task'); |
| [576](#L576) | modal.find('[data-ajax-name="parent-id"]').val('-1').trigger('chosen:updated'); |
| [577](#L577) | $('body').find('#zpm-new-task-template-select').trigger('change'); |
| [578](#L578) | $('body').find('select#zpm\_new\_task\_project').chosen({ |
| [579](#L579) | disable\_search\_threshold:¬†10, |
| [580](#L580) | no\_results\_text:¬†zpm\_localized.strings.no\_projects\_found, |
| [581](#L581) | width:¬†"100%" |
| [582](#L582) | }); |
| [583](#L583) | }); |
| [584](#L584) |  |
| [585](#L585) | /\* Open new task modal when there are no tasks \*/ |
| [586](#L586) | $('body').on('click',¬†'#zpm\_first\_task',¬†function¬†()¬†{ |
| [587](#L587) | $('body').find('#zpm\_task\_add\_new').trigger('click'); |
| [588](#L588) | }); |
| [589](#L589) |  |
| [590](#L590) | /\* Open new task modal on Project editor page \*/ |
| [591](#L591) | $('body').on('click',¬†'#zpm\_add\_new\_project\_task',¬†function¬†()¬†{ |
| [592](#L592) | ZephyrProjects.open\_modal('zpm\_create\_task'); |
| [593](#L593) | $('body').find('#zpm-new-task-template-select').trigger('change'); |
| [594](#L594) | }); |
| [595](#L595) |  |
| [596](#L596) | var¬†zpm\_new\_task\_files¬†=¬†[]; |
| [597](#L597) | var¬†zpm\_new\_task\_uploader; |
| [598](#L598) |  |
| [599](#L599) | $('body').on('click',¬†'#zpm-new-task\_\_new-file',¬†function¬†()¬†{ |
| [600](#L600) | if¬†(zpm\_new\_task\_uploader)¬†{ |
| [601](#L601) | zpm\_new\_task\_uploader.open(); |
| [602](#L602) | return; |
| [603](#L603) | } |
| [604](#L604) |  |
| [605](#L605) | var¬†args¬†=¬†{ |
| [606](#L606) | title:¬†zpm\_localized.strings.choose\_file, |
| [607](#L607) | button:¬†{ |
| [608](#L608) | text:¬†zpm\_localized.strings.choose\_file |
| [609](#L609) | },¬†multiple:¬†'add' |
| [610](#L610) | }; |
| [611](#L611) |  |
| [612](#L612) | if¬†(zpm\_localized.settings.view\_own\_files)¬†{ |
| [613](#L613) | args.library¬†=¬†{}; |
| [614](#L614) | args.library.user¬†=¬†zpm\_localized.user\_id; |
| [615](#L615) | } |
| [616](#L616) |  |
| [617](#L617) | zpm\_new\_task\_uploader¬†=¬†wp.media.frames.file\_frame¬†=¬†wp.media(args); |
| [618](#L618) |  |
| [619](#L619) | zpm\_new\_task\_uploader.on('select',¬†function¬†()¬†{ |
| [620](#L620) | var¬†attachments¬†=¬†zpm\_new\_task\_uploader.state().get('selection').map( |
| [621](#L621) |  |
| [622](#L622) | function¬†(attachment)¬†{ |
| [623](#L623) |  |
| [624](#L624) | attachment.toJSON(); |
| [625](#L625) | return¬†attachment; |
| [626](#L626) |  |
| [627](#L627) | }); |
| [628](#L628) |  |
| [629](#L629) | for¬†(var¬†i¬†=¬†0;¬†i¬†<¬†attachments.length;¬†++i)¬†{ |
| [630](#L630) | zpm\_new\_task\_files.push({¬†attachment\_id:¬†attachments[i].id¬†}); |
| [631](#L631) | $("#zpm\_create\_task .zpm\_modal\_body").animate({¬†scrollTop:¬†$('#zpm\_create\_task .zpm\_modal\_body').prop("scrollHeight")¬†},¬†1000); |
| [632](#L632) | $('#zpm-new-task\_\_attachments').append('<div class="zpm-new-task\_\_attachment"><a href="'¬†+¬†attachments[i].attributes.url¬†+¬†'" target="\_blank">'¬†+¬†attachments[i].attributes.url¬†+¬†'</a></div>'); |
| [633](#L633) |  |
| [634](#L634) | } |
| [635](#L635) | }); |
| [636](#L636) | // Open the uploader dialog |
| [637](#L637) | zpm\_new\_task\_uploader.open(); |
| [638](#L638) |  |
| [639](#L639) | }); |
| [640](#L640) |  |
| [641](#L641) | /\* Create a new task \*/ |
| [642](#L642) | $('#zpm\_save\_task').on('click',¬†function¬†()¬†{ |
| [643](#L643) | // Close modal, save task and update task list |
| [644](#L644) | var¬†form¬†=¬†$(this).closest('.zpm-form'); |
| [645](#L645) | var¬†name¬†=¬†$('#zpm\_new\_task\_name').val(); |
| [646](#L646) | var¬†description¬†=¬†$('#zpm\_new\_task\_description').val(); |
| [647](#L647) | var¬†project¬†=¬†$('#zpm\_new\_task\_project').val(); |
| [648](#L648) | var¬†assignee¬†=¬†$('#zpm\_new\_task\_assignee').val(); |
| [649](#L649) | var¬†due\_date¬†=¬†$('#zpm\_new\_task\_due\_date').val(); |
| [650](#L650) | var¬†start\_date¬†=¬†$('#zpm\_new\_task\_start\_date').val(); |
| [651](#L651) | var¬†team¬†=¬†$('#zpm-new-task-team-selection').val(); |
| [652](#L652) | var¬†priority¬†=¬†$('body').find('#zpm-new-task-priority-value').val(); |
| [653](#L653) | var¬†status¬†=¬†$('body').find('#zpm-new-task\_\_status').val(); |
| [654](#L654) | var¬†is\_recurring¬†=¬†$('body').find('#zpm-new-task\_\_type-daily').is(':checked'); |
| [655](#L655) | var¬†type¬†=¬†is\_recurring¬†?¬†'daily'¬†:¬†'default'; |
| [656](#L656) | const¬†categories¬†=¬†jQuery('body').find('#zpm-new-task--categories').val(); |
| [657](#L657) | var¬†recurrence\_type¬†=¬†$('#zpm-new-task\_\_recurrence-select').val(); |
| [658](#L658) | var¬†recurrence\_data¬†=¬†{}; |
| [659](#L659) | recurrence\_data.type¬†=¬†recurrence\_type; |
| [660](#L660) |  |
| [661](#L661) |  |
| [662](#L662) | // Example usage |
| [663](#L663) |  |
| [664](#L664) |  |
| [665](#L665) |  |
| [666](#L666) |  |
| [667](#L667) | // Now apply the filters |
| [668](#L668) | let¬†createTaskValid¬†=¬†zpmApplyFilter('zpm/tasks/create',¬†true); |
| [669](#L669) | console.log('create task valid',¬†createTaskValid); |
| [670](#L670) |  |
| [671](#L671) | if¬†(!createTaskValid)¬†return; |
| [672](#L672) |  |
| [673](#L673) | switch¬†(recurrence\_type)¬†{ |
| [674](#L674) | case¬†'daily': |
| [675](#L675) | var¬†days¬†=¬†$('#zpm-new-task\_\_recurrence-daily').val(); |
| [676](#L676) | var¬†expiration¬†=¬†$('#zpm-new-task\_\_recurrence-expiration-date').val(); |
| [677](#L677) | var¬†start¬†=¬†$('#zpm-new-task\_\_recurrence-start-date').val(); |
| [678](#L678) |  |
| [679](#L679) | recurrence\_data.days¬†=¬†days; |
| [680](#L680) | recurrence\_data.expires¬†=¬†expiration; |
| [681](#L681) | recurrence\_data.starts¬†=¬†start; |
| [682](#L682) | break; |
| [683](#L683) | case¬†'weekly': |
| [684](#L684) | var¬†expiration¬†=¬†$('#zpm-new-task\_\_recurrence-expiration-date-weekly').val(); |
| [685](#L685) | recurrence\_data.expires¬†=¬†expiration; |
| [686](#L686) | var¬†start¬†=¬†$('#zpm-new-task\_\_recurrence-start-date-weekly').val(); |
| [687](#L687) | recurrence\_data.starts¬†=¬†start; |
| [688](#L688) | break; |
| [689](#L689) | case¬†'monthly': |
| [690](#L690) | var¬†expiration¬†=¬†$('#zpm-new-task\_\_recurrence-expiration-date-monthly').val(); |
| [691](#L691) | recurrence\_data.expires¬†=¬†expiration; |
| [692](#L692) | var¬†start¬†=¬†$('#zpm-new-task\_\_recurrence-start-date-monthly').val(); |
| [693](#L693) | recurrence\_data.starts¬†=¬†start; |
| [694](#L694) | break; |
| [695](#L695) | case¬†'annually': |
| [696](#L696) | var¬†expiration¬†=¬†$('#zpm-new-task\_\_recurrence-expiration-date-annual').val(); |
| [697](#L697) | recurrence\_data.expires¬†=¬†expiration; |
| [698](#L698) | var¬†start¬†=¬†$('#zpm-new-task\_\_recurrence-start-date-annual').val(); |
| [699](#L699) | recurrence\_data.starts¬†=¬†start; |
| [700](#L700) | break; |
| [701](#L701) | default: |
| [702](#L702) | break; |
| [703](#L703) | } |
| [704](#L704) |  |
| [705](#L705) | $('select#zpm\_new\_task\_project').val('').trigger("chosen:updated"); |
| [706](#L706) | $('#zpm\_new\_task\_assignee').val('').trigger("chosen:updated"); |
| [707](#L707) | $('#zpm-new-task-team-selection').val('').trigger("chosen:updated"); |
| [708](#L708) |  |
| [709](#L709) | var¬†custom\_fields¬†=¬†[]; |
| [710](#L710) | $('body').find('#zpm\_create\_task .zpm\_task\_custom\_field').each(function¬†()¬†{ |
| [711](#L711) | var¬†id¬†=¬†$(this).data('zpm-cf-id'); |
| [712](#L712) | var¬†type¬†=¬†$(this).data('zpm-cf-type'); |
| [713](#L713) | var¬†value¬†=¬†$(this).val(); |
| [714](#L714) |  |
| [715](#L715) | if¬†($(this).is('div'))¬†return; |
| [716](#L716) |  |
| [717](#L717) | if¬†(type¬†==¬†"checkbox")¬†{ |
| [718](#L718) | value¬†=¬†$(this).is(':checked'); |
| [719](#L719) | } |
| [720](#L720) |  |
| [721](#L721) | if¬†(type¬†==¬†'rating')¬†{ |
| [722](#L722) | value¬†=¬†$(this).find('.zpm-rating-field\_\_value').val(); |
| [723](#L723) | } |
| [724](#L724) |  |
| [725](#L725) | if¬†(type¬†==¬†'multiple-choice')¬†{ |
| [726](#L726) | value¬†=¬†$(this).find('input:checked').val(); |
| [727](#L727) | } |
| [728](#L728) |  |
| [729](#L729) | custom\_fields.push({ |
| [730](#L730) | id:¬†id, |
| [731](#L731) | value:¬†value |
| [732](#L732) | }); |
| [733](#L733) |  |
| [734](#L734) | }); |
| [735](#L735) |  |
| [736](#L736) | if¬†(name¬†==¬†'')¬†{ |
| [737](#L737) | alert(zpm\_localized.strings.enter\_task\_name); |
| [738](#L738) | return; |
| [739](#L739) | } |
| [740](#L740) |  |
| [741](#L741) |  |
| [742](#L742) | if¬†(due\_date¬†!==¬†""¬†&&¬†start\_date¬†!==¬†"")¬†{ |
| [743](#L743) | dateStart¬†=¬†Date.parse(start\_date); |
| [744](#L744) | dateEnd¬†=¬†Date.parse(due\_date); |
| [745](#L745) |  |
| [746](#L746) | if¬†(dateStart¬†>¬†dateEnd)¬†{ |
| [747](#L747) | alert("Due Date should be greater than the Start Date."); |
| [748](#L748) | return; |
| [749](#L749) | } |
| [750](#L750) | } |
| [751](#L751) |  |
| [752](#L752) | var¬†subtasks¬†=¬†[]; |
| [753](#L753) |  |
| [754](#L754) | $('.zpm\_task\_subtask\_item').each(function¬†()¬†{ |
| [755](#L755) | if¬†($(this).val()¬†!==¬†'')¬†{ |
| [756](#L756) | subtasks.push($(this).val()); |
| [757](#L757) | } |
| [758](#L758) | }); |
| [759](#L759) |  |
| [760](#L760) | var¬†data¬†=¬†{ |
| [761](#L761) | task\_name:¬†name, |
| [762](#L762) | task\_description:¬†description, |
| [763](#L763) | subtasks:¬†subtasks, |
| [764](#L764) | task\_project:¬†project, |
| [765](#L765) | task\_assignee:¬†assignee, |
| [766](#L766) | task\_due\_date:¬†ZephyrProjects.getDate(due\_date), |
| [767](#L767) | task\_start\_date:¬†ZephyrProjects.getDate(start\_date), |
| [768](#L768) | task\_custom\_fields:¬†custom\_fields, |
| [769](#L769) | categories, |
| [770](#L770) | team:¬†team, |
| [771](#L771) | priority:¬†priority, |
| [772](#L772) | status:¬†status, |
| [773](#L773) | type:¬†type, |
| [774](#L774) | recurrence:¬†recurrence\_data |
| [775](#L775) | }; |
| [776](#L776) |  |
| [777](#L777) | form.find('[data-ajax-name]').each(function¬†()¬†{ |
| [778](#L778) | var¬†name¬†=¬†jQuery(this).data('ajax-name'); |
| [779](#L779) | var¬†value¬†=¬†jQuery(this).val(); |
| [780](#L780) | data[name]¬†=¬†value; |
| [781](#L781) | }); |
| [782](#L782) |  |
| [783](#L783) | if¬†($('body').find('#zpm-new-task-kanban-id').length¬†>¬†0¬†&&¬†$('body').find('#zpm-new-task-kanban-id').val()¬†!==¬†'')¬†{ |
| [784](#L784) | data.kanban\_col¬†=¬†$('#zpm-new-task-kanban-id').val(); |
| [785](#L785) | }¬†else¬†if¬†(jQuery('body').find('.zpm\_kanban\_heading').length¬†>¬†0)¬†{ |
| [786](#L786) | // data.kanban\_col = jQuery('body').find('.zpm\_kanban\_heading').first().data('kanban-id'); |
| [787](#L787) | } |
| [788](#L788) |  |
| [789](#L789) | ZPM\_Manager.set\_new\_task\_data(data); |
| [790](#L790) | ZPM\_Manager.create\_task(function¬†(response)¬†{ |
| [791](#L791) | if¬†(zpm\_new\_task\_files.length¬†>¬†0)¬†{ |
| [792](#L792) | ZephyrProjects.upload\_new\_task\_attachments(response.id,¬†zpm\_new\_task\_files); |
| [793](#L793) | } |
| [794](#L794) |  |
| [795](#L795) | zpm\_new\_task\_files¬†=¬†[]; |
| [796](#L796) | $('#zpm-new-task\_\_attachments').html(''); |
| [797](#L797) | jQuery.event.trigger({¬†type:¬†'zephyr\_task\_created',¬†ndata:¬†response¬†}); |
| [798](#L798) |  |
| [799](#L799) | var¬†new\_task¬†=¬†response.new\_task\_html; |
| [800](#L800) | var¬†taskList¬†=¬†$('body').find('.zpm\_task\_list'); |
| [801](#L801) |  |
| [802](#L802) | if¬†(response.parent\_id¬†!==¬†'-1')¬†{ |
| [803](#L803) | jQuery('body').find('#zpm-no-subtasks').hide(); |
| [804](#L804) | taskList¬†=¬†$('body').find('#zpm-subtask-list'); |
| [805](#L805) | } |
| [806](#L806) |  |
| [807](#L807) | taskList.append(new\_task); |
| [808](#L808) | $('body').find('.zpm\_message\_center').remove(); |
| [809](#L809) | $('body').find('#zpm\_task\_option\_container').removeClass('zpm\_hidden'); |
| [810](#L810) | $('body').find('#zpm\_task\_list\_container').removeClass('zpm\_hidden'); |
| [811](#L811) | $('body').find('.zpm\_no\_results\_message').addClass('zpm\_hidden'); |
| [812](#L812) | $('.zpm\_no\_results\_message').hide(); |
| [813](#L813) |  |
| [814](#L814) | if¬†($('body').find('.zpm\_kanban\_container').length¬†!==¬†0)¬†{ |
| [815](#L815) | var¬†container¬†=¬†$('body').find('.zpm-delete-kanban-row[data-kanban-id="'¬†+¬†response.kanban\_col¬†+¬†'"]').closest('.zpm\_kanban\_row').find('.zpm\_kanban\_container'); |
| [816](#L816) |  |
| [817](#L817) | if¬†(container.length¬†==¬†0)¬†{ |
| [818](#L818) | if¬†(typeof¬†response.column.name¬†!==¬†'undefined')¬†{ |
| [819](#L819) | const¬†html¬†=¬†ZephyrProjects.Kanban.column\_html(response.column); |
| [820](#L820) | jQuery('body').find('#zpm\_kanban\_row\_add\_column').before(html); |
| [821](#L821) |  |
| [822](#L822) | container¬†=¬†$('body').find('[data-kanban-id="'¬†+¬†response.kanban\_col¬†+¬†'"]').closest('.zpm\_kanban\_row').find('.zpm\_kanban\_container'); |
| [823](#L823) | ZephyrProjects.colorPicker('.zpm\_kanban\_color\_picker'); |
| [824](#L824) | jQuery(document).trigger('zpm/kanban/updated'); |
| [825](#L825) | } |
| [826](#L826) | } |
| [827](#L827) |  |
| [828](#L828) | container.append(response.kanban\_html); |
| [829](#L829) | container.animate({¬†scrollTop:¬†container.prop("scrollHeight")¬†},¬†1000); |
| [830](#L830) | jQuery(document).trigger('zpm/orders/changed',¬†response.kanban\_col); |
| [831](#L831) | } |
| [832](#L832) |  |
| [833](#L833) | form.find('[data-ajax-name]').each(function¬†()¬†{ |
| [834](#L834) | const¬†fieldDefault¬†=¬†jQuery(this).data('default'); |
| [835](#L835) |  |
| [836](#L836) | if¬†(typeof¬†fieldDefault¬†!==¬†'undefined')¬†{ |
| [837](#L837) | jQuery(this).val(fieldDefault).trigger('chosen:updated'); |
| [838](#L838) | }¬†else¬†{ |
| [839](#L839) | jQuery(this).val('').trigger('chosen:updated'); |
| [840](#L840) | } |
| [841](#L841) | }); |
| [842](#L842) | }); |
| [843](#L843) |  |
| [844](#L844) |  |
| [845](#L845) | ZephyrProjects.close\_modal(); |
| [846](#L846) |  |
| [847](#L847) | const¬†$newTaskDueDate¬†=¬†$('body').find('#zpm\_create\_task #zpm\_new\_task\_due\_date'); |
| [848](#L848) | const¬†$newTaskStartDate¬†=¬†$('body').find('#zpm\_create\_task #zpm\_new\_task\_start\_date'); |
| [849](#L849) | const¬†$newTaskAssignee¬†=¬†$('body').find('#zpm\_create\_task #zpm\_new\_task\_assignee'); |
| [850](#L850) |  |
| [851](#L851) | $('body').find('#zpm\_create\_task #zpm\_new\_task\_name').val(''); |
| [852](#L852) | $('body').find('#zpm\_create\_task #zpm\_new\_task\_description').val(''); |
| [853](#L853) |  |
| [854](#L854) | $newTaskDueDate.val($newTaskDueDate.data('default')); |
| [855](#L855) | $newTaskStartDate.val($newTaskStartDate.data('default')); |
| [856](#L856) |  |
| [857](#L857) | if¬†($('body').find('#zpm-project-id').length¬†<=¬†0)¬†{ |
| [858](#L858) | $('body').find('#zpm\_create\_task select#zpm\_new\_task\_project').val('-1'); |
| [859](#L859) | } |
| [860](#L860) |  |
| [861](#L861) | if¬†(zpm\_localized.current\_project¬†!==¬†'')¬†{ |
| [862](#L862) | jQuery('body').find('#zpm\_new\_task\_project').val(zpm\_localized.current\_project).trigger('chosen:updated'); |
| [863](#L863) | } |
| [864](#L864) |  |
| [865](#L865) | $newTaskAssignee.val($newTaskAssignee.data('default')).trigger('chosen:updated'); |
| [866](#L866) | $('body').find('#zpm\_create\_task #zpm\_task\_subtasks').html(''); |
| [867](#L867) | jQuery('body').find('#zpm-new-task--categories').val('').trigger('chosen:updated'); |
| [868](#L868) | const¬†$status¬†=¬†jQuery('body').find('#zpm-new-task\_\_status'); |
| [869](#L869) | $status.val($status.data('default')).trigger('chosen:updated'); |
| [870](#L870) | }); |
| [871](#L871) |  |
| [872](#L872) | jQuery('body').on('click',¬†'#zpm-task-single\_\_add-files-btn',¬†function¬†()¬†{ |
| [873](#L873) | const¬†taskID¬†=¬†jQuery(this).data('task-id'); |
| [874](#L874) | let¬†zpm\_file\_uploader¬†=¬†null; |
| [875](#L875) |  |
| [876](#L876) | ZephyrProjects.upload\_file(zpm\_file\_uploader,¬†function¬†(res)¬†{ |
| [877](#L877) | const¬†$filesContainer¬†=¬†jQuery('body').find('[data-task-files-container="'¬†+¬†taskID¬†+¬†'"]'); |
| [878](#L878) | const¬†files¬†=¬†[]; |
| [879](#L879) | const¬†attachments¬†=¬†res; |
| [880](#L880) |  |
| [881](#L881) | ZephyrProjects.notification(zpm\_localized.strings.uploading\_files); |
| [882](#L882) | zpm\_new\_task\_files¬†=¬†[]; |
| [883](#L883) |  |
| [884](#L884) | for¬†(var¬†i¬†=¬†0;¬†i¬†<¬†attachments.length;¬†++i)¬†{ |
| [885](#L885) | zpm\_new\_task\_files.push({ |
| [886](#L886) | attachment\_id:¬†attachments[i].id |
| [887](#L887) | }); |
| [888](#L888) | } |
| [889](#L889) |  |
| [890](#L890) | ZephyrProjects.upload\_new\_task\_attachments(taskID,¬†zpm\_new\_task\_files,¬†function(res)¬†{ |
| [891](#L891) | jQuery('body').find('.zpm-files\_\_container').html(res.files\_html); |
| [892](#L892) | jQuery('body').find('.zpm\_task\_comments').prepend(res.html); |
| [893](#L893) | }); |
| [894](#L894) |  |
| [895](#L895) | jQuery('body').find('[data-zpm-tab="task-files"]').click(); |
| [896](#L896) | },¬†true); |
| [897](#L897) | }); |
| [898](#L898) |  |
| [899](#L899) | $('#zpm\_save\_changes\_task').on('click',¬†function¬†()¬†{ |
| [900](#L900) |  |
| [901](#L901) | var¬†form¬†=¬†jQuery(this).closest('#zpm\_task\_editor\_settings'); |
| [902](#L902) | var¬†taskId¬†=¬†$(this).data('task-id'); |
| [903](#L903) | var¬†name¬†=¬†$('#zpm\_edit\_task\_name').val(); |
| [904](#L904) | var¬†description¬†=¬†$('#zpm\_edit\_task\_description').val(); |
| [905](#L905) | var¬†assignee¬†=¬†$('#zpm\_edit\_task\_assignee').val(); |
| [906](#L906) | var¬†due\_date¬†=¬†$('#zpm\_edit\_task\_due\_date').val(); |
| [907](#L907) | var¬†start\_date¬†=¬†$('#zpm\_edit\_task\_start\_date').val(); |
| [908](#L908) | let¬†project\_id¬†=¬†$('body').find('#zpm\_edit\_task\_project').val(); |
| [909](#L909) | var¬†team¬†=¬†$('body').find('#zpm-edit-task-team-selection').val(); |
| [910](#L910) | var¬†priority¬†=¬†$('body').find('#zpm-edit-task-priority-value').val(); |
| [911](#L911) | var¬†status¬†=¬†$('body').find('#zpm-edit-task\_\_status').val(); |
| [912](#L912) | var¬†is\_recurring¬†=¬†$('body').find('#zpm-edit-task\_\_type-daily').is(':checked'); |
| [913](#L913) | var¬†type¬†=¬†is\_recurring¬†?¬†'daily'¬†:¬†'default'; |
| [914](#L914) | var¬†subtasks¬†=¬†[]; |
| [915](#L915) | var¬†custom\_fields¬†=¬†[]; |
| [916](#L916) |  |
| [917](#L917) | var¬†recurrence\_type¬†=¬†$('#zpm-edit-task\_\_recurrence-select').val(); |
| [918](#L918) | var¬†recurrence\_data¬†=¬†{}; |
| [919](#L919) | recurrence\_data.type¬†=¬†recurrence\_type; |
| [920](#L920) | var¬†recurrenceParent¬†=¬†''; |
| [921](#L921) |  |
| [922](#L922) | switch¬†(recurrence\_type)¬†{ |
| [923](#L923) | case¬†'daily': |
| [924](#L924) | var¬†days¬†=¬†$('#zpm-edit-task\_\_recurrence-daily').val(); |
| [925](#L925) | var¬†expiration¬†=¬†$('#zpm-edit-task\_\_recurrence-expiration-date').val(); |
| [926](#L926) | recurrenceParent¬†=¬†$('body').find('#zpm-edit-task\_\_recurrence [data-section="daily"]'); |
| [927](#L927) | recurrence\_data.days¬†=¬†days; |
| [928](#L928) | recurrence\_data.expires¬†=¬†expiration; |
| [929](#L929) | break; |
| [930](#L930) | case¬†'weekly': |
| [931](#L931) | var¬†expiration¬†=¬†$('#zpm-edit-task\_\_recurrence-expiration-date-weekly').val(); |
| [932](#L932) | recurrence\_data.expires¬†=¬†expiration; |
| [933](#L933) | recurrenceParent¬†=¬†$('body').find('#zpm-edit-task\_\_recurrence [data-section="weekly"]'); |
| [934](#L934) | break; |
| [935](#L935) | case¬†'monthly': |
| [936](#L936) | var¬†expiration¬†=¬†$('#zpm-edit-task\_\_recurrence-expiration-date-monthly').val(); |
| [937](#L937) | recurrence\_data.expires¬†=¬†expiration; |
| [938](#L938) | recurrenceParent¬†=¬†$('body').find('#zpm-edit-task\_\_recurrence [data-section="monthly"]'); |
| [939](#L939) | break; |
| [940](#L940) | case¬†'annually': |
| [941](#L941) | var¬†expiration¬†=¬†$('#zpm-edit-task\_\_recurrence-expiration-date-annual').val(); |
| [942](#L942) | recurrence\_data.expires¬†=¬†expiration; |
| [943](#L943) | recurrenceParent¬†=¬†$('body').find('#zpm-edit-task\_\_recurrence [data-section="annually"]'); |
| [944](#L944) | break; |
| [945](#L945) | default: |
| [946](#L946) | break; |
| [947](#L947) | } |
| [948](#L948) |  |
| [949](#L949) | if¬†(recurrenceParent¬†!==¬†'')¬†{ |
| [950](#L950) | recurrence\_data.frequency¬†=¬†recurrenceParent.find('[data-ajax-name="frequency"]').val(); |
| [951](#L951) | recurrence\_data.start¬†=¬†recurrenceParent.find('[data-ajax-name="recurrence-start"]').val(); |
| [952](#L952) | } |
| [953](#L953) |  |
| [954](#L954) | if¬†(name¬†==¬†"")¬†{ |
| [955](#L955) | alert(zpm\_localized.strings.enter\_task\_name); |
| [956](#L956) | return; |
| [957](#L957) | } |
| [958](#L958) |  |
| [959](#L959) | if¬†(start\_date¬†!==¬†""¬†&&¬†due\_date¬†!==¬†"")¬†{ |
| [960](#L960) | var¬†startDate¬†=¬†Date.parse(start\_date); |
| [961](#L961) | var¬†endDate¬†=¬†Date.parse(due\_date); |
| [962](#L962) |  |
| [963](#L963) | if¬†(endDate¬†<¬†startDate)¬†{ |
| [964](#L964) | const¬†$duration¬†=¬†jQuery('body').find('#zpm-edit-task--duration'); |
| [965](#L965) |  |
| [966](#L966) | if¬†($duration.length¬†==¬†0)¬†{ |
| [967](#L967) | alert("Due Date should be greater than the Start Date."); |
| [968](#L968) | return; |
| [969](#L969) | } |
| [970](#L970) | } |
| [971](#L971) | } |
| [972](#L972) |  |
| [973](#L973) | $('body').find('#zpm\_task\_edit\_custom\_fields .zpm\_task\_custom\_field').each(function¬†()¬†{ |
| [974](#L974) | var¬†id¬†=¬†$(this).data('zpm-cf-id'); |
| [975](#L975) | var¬†type¬†=¬†$(this).data('zpm-cf-type'); |
| [976](#L976) | var¬†value¬†=¬†$(this).val(); |
| [977](#L977) |  |
| [978](#L978) | if¬†($(this).is('div'))¬†return; |
| [979](#L979) |  |
| [980](#L980) | if¬†(type¬†==¬†"checkbox")¬†{ |
| [981](#L981) | var¬†value¬†=¬†$(this).is(':checked'); |
| [982](#L982) | } |
| [983](#L983) |  |
| [984](#L984) | if¬†(type¬†==¬†'rating')¬†{ |
| [985](#L985) | value¬†=¬†$(this).find('.zpm-rating-field\_\_value').val(); |
| [986](#L986) | } |
| [987](#L987) |  |
| [988](#L988) | if¬†(type¬†==¬†'multiple-choice')¬†{ |
| [989](#L989) | value¬†=¬†$(this).find('input:checked').val(); |
| [990](#L990) | } |
| [991](#L991) |  |
| [992](#L992) | custom\_fields.push({ |
| [993](#L993) | id:¬†id, |
| [994](#L994) | value:¬†value |
| [995](#L995) | }); |
| [996](#L996) | }); |
| [997](#L997) |  |
| [998](#L998) | $(this).html(zpm\_localized.strings.saving); |
| [999](#L999) | const¬†categories¬†=¬†jQuery('body').find('#zpm-new-task--categories').val(); |
| [1000](#L1000) |  |
| [1001](#L1001) | var¬†data¬†=¬†{ |
| [1002](#L1002) | task\_id:¬†taskId, |
| [1003](#L1003) | task\_name:¬†name, |
| [1004](#L1004) | task\_description:¬†description, |
| [1005](#L1005) | task\_assignee:¬†assignee, |
| [1006](#L1006) | task\_subtasks:¬†subtasks, |
| [1007](#L1007) | task\_due\_date:¬†ZephyrProjects.getDate(due\_date), |
| [1008](#L1008) | task\_start\_date:¬†ZephyrProjects.getDate(start\_date), |
| [1009](#L1009) | task\_custom\_fields:¬†custom\_fields, |
| [1010](#L1010) | task\_project:¬†project\_id, |
| [1011](#L1011) | team:¬†team, |
| [1012](#L1012) | priority:¬†priority, |
| [1013](#L1013) | status:¬†status, |
| [1014](#L1014) | type:¬†type, |
| [1015](#L1015) | recurrence:¬†recurrence\_data, |
| [1016](#L1016) | categories |
| [1017](#L1017) | }; |
| [1018](#L1018) |  |
| [1019](#L1019) | form.find('[data-ajax-name]').each(function¬†()¬†{ |
| [1020](#L1020) | var¬†name¬†=¬†jQuery(this).data('ajax-name'); |
| [1021](#L1021) | var¬†value¬†=¬†jQuery(this).val(); |
| [1022](#L1022) | data[name]¬†=¬†value; |
| [1023](#L1023) | }); |
| [1024](#L1024) |  |
| [1025](#L1025) | if¬†(status¬†===¬†'completed')¬†{ |
| [1026](#L1026) | jQuery('body').find('.zpm\_task\_mark\_complete').attr('checked',¬†'checked'); |
| [1027](#L1027) | } |
| [1028](#L1028) |  |
| [1029](#L1029) | ZephyrProjects.update\_task(data,¬†function¬†(response)¬†{ |
| [1030](#L1030) | var¬†background¬†=¬†jQuery('#zpm-edit-task-priority').css('background-color'); |
| [1031](#L1031) | var¬†text\_color¬†=¬†"#fff"; |
| [1032](#L1032) | $('#zpm\_save\_changes\_task').html(zpm\_localized.strings.save\_changes); |
| [1033](#L1033) |  |
| [1034](#L1034) | if¬†(priority¬†==¬†""¬†||¬†priority¬†==¬†"priority\_none")¬†{ |
| [1035](#L1035) | $('#zpm-task-edit-priority-label').addClass('zpm-label-hidden'); |
| [1036](#L1036) | text\_color¬†=¬†"#333"; |
| [1037](#L1037) | }¬†else¬†{ |
| [1038](#L1038) | $('#zpm-task-edit-priority-label').removeClass('zpm-label-hidden'); |
| [1039](#L1039) | } |
| [1040](#L1040) | $('#zpm-task-edit-priority-label').removeClass('priority\_high').removeClass('priority\_low').removeClass('priority\_medium').removeClass('priority\_critical').addClass(priority).text($('.zpm-edit-task-priority[data-value="'¬†+¬†priority¬†+¬†'"]').text()); |
| [1041](#L1041) |  |
| [1042](#L1042) |  |
| [1043](#L1043) | $('#zpm-task-edit-priority-label').attr('style',¬†'background: '¬†+¬†background¬†+¬†' !important; color: '¬†+¬†text\_color¬†+¬†' !important;'); |
| [1044](#L1044) | ZephyrProjects.notification(zpm\_localized.strings.changes\_saved); |
| [1045](#L1045) | }); |
| [1046](#L1046) | }); |
| [1047](#L1047) |  |
| [1048](#L1048) | $('body').on('click',¬†'[zpm-send-test-emails]',¬†function()¬†{ |
| [1049](#L1049) | ZephyrProjects.promptInput({ |
| [1050](#L1050) | title:¬†'Enter Email Address', |
| [1051](#L1051) | confirmText:¬†'Send Test Emails', |
| [1052](#L1052) | callback:¬†function(value)¬†{ |
| [1053](#L1053) | console.log('zpm/value',¬†value); |
| [1054](#L1054) | ZephyrProjects.notification(zpm\_localized.strings.sending); |
| [1055](#L1055) | ZephyrProjects.ajax({ |
| [1056](#L1056) | action:¬†'zpm\_sendTestEmails', |
| [1057](#L1057) | email:¬†value |
| [1058](#L1058) | },¬†function()¬†{ |
| [1059](#L1059) | ZephyrProjects.notification(zpm\_localized.strings.sent); |
| [1060](#L1060) | }); |
| [1061](#L1061) | } |
| [1062](#L1062) | }) |
| [1063](#L1063) | }); |
| [1064](#L1064) |  |
| [1065](#L1065) | /\* Update task completion status \*/ |
| [1066](#L1066) | $('body').on('click',¬†'.zpm\_task\_mark\_complete',¬†function¬†()¬†{ |
| [1067](#L1067) | var¬†task\_id¬†=¬†$(this).data('task-id'); |
| [1068](#L1068) |  |
| [1069](#L1069) | if¬†($(this).is(':checked'))¬†{ |
| [1070](#L1070) | var¬†data¬†=¬†{ |
| [1071](#L1071) | id:¬†task\_id, |
| [1072](#L1072) | completed:¬†1 |
| [1073](#L1073) | }; |
| [1074](#L1074) |  |
| [1075](#L1075) | ZephyrProjects.complete\_task(data,¬†function¬†(response)¬†{¬†}); |
| [1076](#L1076) | $('body').find('.zpm\_task\_list\_row[data-task-id="'¬†+¬†task\_id¬†+¬†'"]').addClass('zpm\_task\_complete'); |
| [1077](#L1077) | $('body').find('.zpm\_task\_mark\_complete[data-task-id="'¬†+¬†task\_id¬†+¬†'"]').attr('checked',¬†'checked'); |
| [1078](#L1078) | }¬†else¬†{ |
| [1079](#L1079) | $('body').find('.zpm\_task\_list\_row[data-task-id="'¬†+¬†task\_id¬†+¬†'"]').removeClass('zpm\_task\_complete'); |
| [1080](#L1080) | $('body').find('.zpm\_task\_mark\_complete[data-task-id="'¬†+¬†task\_id¬†+¬†'"]').removeAttr('checked'); |
| [1081](#L1081) | var¬†data¬†=¬†{ |
| [1082](#L1082) | id:¬†task\_id, |
| [1083](#L1083) | completed:¬†0 |
| [1084](#L1084) | }; |
| [1085](#L1085) |  |
| [1086](#L1086) | ZephyrProjects.complete\_task(data,¬†function¬†(response)¬†{¬†}); |
| [1087](#L1087) | } |
| [1088](#L1088) | }); |
| [1089](#L1089) |  |
| [1090](#L1090) | /\* Mark a task as complete \*/ |
| [1091](#L1091) | $('body').on('click',¬†'.zpm\_task\_mark\_complete',¬†function¬†()¬†{ |
| [1092](#L1092) | var¬†checked¬†=¬†$(this).is(':checked'); |
| [1093](#L1093) | var¬†task\_id¬†=¬†$(this).closest('li').data('task-id'); |
| [1094](#L1094) |  |
| [1095](#L1095) | if¬†(checked¬†==¬†'checked')¬†{ |
| [1096](#L1096) | $(this).closest('li').addClass('zpm\_task\_completed'); |
| [1097](#L1097) | }¬†else¬†{ |
| [1098](#L1098) | $(this).closest('li').removeClass('zpm\_task\_completed'); |
| [1099](#L1099) | } |
| [1100](#L1100) | }); |
| [1101](#L1101) |  |
| [1102](#L1102) | /\* Delete a task from the list \*/ |
| [1103](#L1103) | $('body').on('click',¬†'.zpm\_delete\_task',¬†function¬†()¬†{ |
| [1104](#L1104) | var¬†task\_id¬†=¬†jQuery(this).closest('[data-task-id]').data('task-id'); |
| [1105](#L1105) | $(this).closest('li').hide(); |
| [1106](#L1106) | }); |
| [1107](#L1107) |  |
| [1108](#L1108) | // Select project type |
| [1109](#L1109) | $('body').on('click',¬†'.zpm\_modal\_item',¬†function¬†()¬†{ |
| [1110](#L1110) | var¬†type¬†=¬†$(this).find('.image').data('project-type'); |
| [1111](#L1111) | $('#zpm-project-type').val(type); |
| [1112](#L1112) | $('body').find('.zpm\_modal\_item .image').removeClass('zpm\_project\_selected'); |
| [1113](#L1113) | $(this).find('.image').addClass('zpm\_project\_selected'); |
| [1114](#L1114) | }); |
| [1115](#L1115) |  |
| [1116](#L1116) | // Add new project via modal |
| [1117](#L1117) | $('body').on('click',¬†'#zpm\_modal\_add\_project',¬†function¬†()¬†{ |
| [1118](#L1118) | var¬†name¬†=¬†$(this).closest('#zpm\_project\_modal').find('.zpm\_project\_name\_input').val(); |
| [1119](#L1119) | var¬†project\_type¬†=¬†$(this).closest('#zpm\_project\_modal').find('.zpm\_project\_selected').data('project-type'); |
| [1120](#L1120) | var¬†description¬†=¬†$('body').find('#zpm-new-project-description').val(); |
| [1121](#L1121) | var¬†type¬†=¬†$('body').find('#zpm-project-type').val(); |
| [1122](#L1122) | var¬†priority¬†=¬†$('body').find('#zpm-new-project-priority-value').val(); |
| [1123](#L1123) | var¬†categories¬†=¬†$('body').find('#zpm-new-project\_\_categories').val(); |
| [1124](#L1124) | var¬†managers¬†=¬†$('body').find('#zpm-new-project\_\_managers').val(); |
| [1125](#L1125) | var¬†modal¬†=¬†$(this).closest('#zpm\_project\_modal'); |
| [1126](#L1126) | if¬†(name¬†==¬†'')¬†{ |
| [1127](#L1127) | $(this).closest('#zpm\_project\_modal').find('.zpm\_project\_name\_input').after('<span class="zpm\_validation\_error">'¬†+¬†zpm\_localized.strings.enter\_project\_name¬†+¬†'</span>'); |
| [1128](#L1128) | }¬†else¬†{ |
| [1129](#L1129) | modal.find('.zpm\_project\_name\_input').val(''); |
| [1130](#L1130) | ZephyrProjects.close\_modal(); |
| [1131](#L1131) |  |
| [1132](#L1132) | var¬†data¬†=¬†{ |
| [1133](#L1133) | project\_name:¬†name, |
| [1134](#L1134) | project\_description:¬†description, |
| [1135](#L1135) | project\_categories:¬†'', |
| [1136](#L1136) | project\_due\_date:¬†'', |
| [1137](#L1137) | type:¬†type, |
| [1138](#L1138) | priority:¬†priority, |
| [1139](#L1139) | categories:¬†categories, |
| [1140](#L1140) | managers |
| [1141](#L1141) | }; |
| [1142](#L1142) |  |
| [1143](#L1143) | ZPM\_Manager.create\_project(data,¬†function¬†(response)¬†{ |
| [1144](#L1144) | jQuery.event.trigger({¬†type:¬†'zephyr\_project\_created',¬†ndata:¬†response¬†}); |
| [1145](#L1145) | $('body').find('#zpm\_project\_manager\_display').removeClass('zpm\_hide'); |
| [1146](#L1146) | $('body').find('.zpm\_no\_results\_message').hide(); |
| [1147](#L1147) | $('body').find('.zpm\_project\_grid').prepend(response.html); |
| [1148](#L1148) |  |
| [1149](#L1149) | if¬†(typeof¬†response.url¬†!==¬†'undefined'¬†&&¬†response.url¬†!==¬†'')¬†{ |
| [1150](#L1150) | window.location.href¬†=¬†response.url; |
| [1151](#L1151) | } |
| [1152](#L1152) | }); |
| [1153](#L1153) |  |
| [1154](#L1154) | if¬†(categories)¬†{ |
| [1155](#L1155) | // categories.forEach(function (cat) { |
| [1156](#L1156) | //¬† ¬† ¬† var val = $('.zpm-category\_\_grid-cell[data-category-id="' + cat + '"]').find('.zpm-category-card\_\_count-value'); |
| [1157](#L1157) | //¬† ¬† ¬† var count = parseInt(val.text()); |
| [1158](#L1158) | //¬† ¬† ¬† val.text(count + 1); |
| [1159](#L1159) | // }); |
| [1160](#L1160) | } |
| [1161](#L1161) | } |
| [1162](#L1162) | }); |
| [1163](#L1163) |  |
| [1164](#L1164) | var¬†task\_loading\_ajax¬†=¬†null; |
| [1165](#L1165) |  |
| [1166](#L1166) | // Selected task from list |
| [1167](#L1167) | $('body').on('click',¬†'.zpm\_task\_list\_row',¬†function¬†(e)¬†{ |
| [1168](#L1168) | //e.preventDefault(); |
| [1169](#L1169) | const¬†$target¬†=¬†jQuery(e.target); |
| [1170](#L1170) |  |
| [1171](#L1171) |  |
| [1172](#L1172) | if¬†($target.hasClass('zpm\_task\_project')¬†||¬†$target.hasClass('zpm-override-click')¬†||¬†$target.closest('.zpm-override-click').length¬†>¬†0)¬†{ |
| [1173](#L1173) | e.preventDefault(); |
| [1174](#L1174) | e.stopPropagation(); |
| [1175](#L1175) | console.log('project'); |
| [1176](#L1176) | return; |
| [1177](#L1177) | } |
| [1178](#L1178) |  |
| [1179](#L1179) | if¬†(!zpm\_localized.settings.direct\_link\_task)¬†{ |
| [1180](#L1180) | if¬†(e.target.className.indexOf('zpm\_task\_mark\_complete')¬†>¬†-1¬†||¬†e.target.className.indexOf('zpm-material-checkbox-label')¬†>¬†-1¬†||¬†e.target.className.indexOf('zpm-task-bulk-selector')¬†>¬†-1)¬†{ |
| [1181](#L1181) |  |
| [1182](#L1182) | //return; |
| [1183](#L1183) | }¬†else¬†{ |
| [1184](#L1184) | e.preventDefault(); |
| [1185](#L1185) | var¬†data¬†=¬†$(this).data(); |
| [1186](#L1186) | var¬†task\_name¬†=¬†data.taskName; |
| [1187](#L1187) | var¬†task\_id¬†=¬†data.taskId; |
| [1188](#L1188) | var¬†task\_view\_modal¬†=¬†$('body').find('#zpm\_task\_view\_container'); |
| [1189](#L1189) | task\_view\_modal.html('<div class="zpm\_task\_loader"></div>'); |
| [1190](#L1190) |  |
| [1191](#L1191) | var¬†data¬†=¬†{ |
| [1192](#L1192) | task\_id:¬†task\_id |
| [1193](#L1193) | }; |
| [1194](#L1194) |  |
| [1195](#L1195) | if¬†($(this).closest('#zpm\_quickview\_modal').length¬†>¬†0)¬†{ |
| [1196](#L1196) | var¬†url¬†=¬†zpm\_localized.tasks\_url¬†+¬†'&action=view\_task&task\_id='¬†+¬†task\_id; |
| [1197](#L1197) | var¬†win¬†=¬†window.open(url,¬†'\_blank'); |
| [1198](#L1198) | win.focus(); |
| [1199](#L1199) | }¬†else¬†{ |
| [1200](#L1200) | ZephyrProjects.view\_task(data,¬†function¬†(response)¬†{ |
| [1201](#L1201) | task\_view\_modal.html(response); |
| [1202](#L1202) | }); |
| [1203](#L1203) |  |
| [1204](#L1204) | ZephyrProjects.open\_modal('zpm\_task\_view\_container'); |
| [1205](#L1205) | $('body').find('#zpm\_task\_view\_container').attr('data-task-id',¬†task\_id); |
| [1206](#L1206) | } |
| [1207](#L1207) | } |
| [1208](#L1208) | } |
| [1209](#L1209) | }); |
| [1210](#L1210) |  |
| [1211](#L1211) | $('body').on('click',¬†'#zpm\_create\_quicktask',¬†function¬†()¬†{ |
| [1212](#L1212) | var¬†quickTaskDataHolder¬†=¬†$(this).closest('.zpm\_quicktask\_container'); |
| [1213](#L1213) | var¬†taskName¬†=¬†quickTaskDataHolder.find('#zpm\_quicktask\_name'); |
| [1214](#L1214) | var¬†taskDescription¬†=¬†quickTaskDataHolder.find('#zpm\_quicktask\_description'); |
| [1215](#L1215) | var¬†taskDueDate¬†=¬†quickTaskDataHolder.find('#zpm\_quicktask\_date'); |
| [1216](#L1216) | var¬†taskProject¬†=¬†$(this).closest('.zpm-modal').data('project-id'); |
| [1217](#L1217) | var¬†taskAssignee¬†=¬†quickTaskDataHolder.find('#zpm\_quicktask\_select\_assignee'); |
| [1218](#L1218) | quickTaskDataHolder.removeClass('active'); |
| [1219](#L1219) |  |
| [1220](#L1220) | $('body').find('#zpm\_quick\_task\_add').html(zpm\_localized.strings.saving).addClass('saving'); |
| [1221](#L1221) |  |
| [1222](#L1222) | var¬†data¬†=¬†{ |
| [1223](#L1223) | task\_project:¬†taskProject, |
| [1224](#L1224) | task\_name:¬†taskName.val(), |
| [1225](#L1225) | task\_description:¬†taskDescription.val(), |
| [1226](#L1226) | task\_assignee:¬†taskAssignee.val(), |
| [1227](#L1227) | task\_due\_date:¬†ZephyrProjects.getDate(taskDueDate.val()) |
| [1228](#L1228) | }; |
| [1229](#L1229) |  |
| [1230](#L1230) | ZephyrProjects.create\_task(data,¬†function¬†(response)¬†{ |
| [1231](#L1231) | $('body').find('.zpm\_task\_list').append(response.new\_task\_html); |
| [1232](#L1232) | $('body').find('#zpm\_quick\_task\_add').html(zpm\_localized.strings.add\_task).removeClass('saving'); |
| [1233](#L1233) | taskName.val('');¬†taskDescription.val('');¬†taskDueDate.val('');¬†taskAssignee.val(''); |
| [1234](#L1234) | $('body').find('#zpm\_tasks\_tab .zpm\_message\_center').remove(); |
| [1235](#L1235) | zpmSortTasksByDueDate('#zpm-project-task-list'); |
| [1236](#L1236) | }); |
| [1237](#L1237) | }); |
| [1238](#L1238) |  |
| [1239](#L1239) | // Execute file actions |
| [1240](#L1240) | $('body').on('click',¬†'.zpm\_file\_action, .zpm\_file\_preview, .zpm-file-preview-icon',¬†function¬†()¬†{ |
| [1241](#L1241) | var¬†action¬†=¬†$(this).data('zpm-action'); |
| [1242](#L1242) | var¬†target¬†=¬†$(this).closest('.zpm\_file\_item'); |
| [1243](#L1243) | var¬†$container¬†=¬†$(this).closest('.zpm\_file\_item\_container'); |
| [1244](#L1244) | var¬†projectId¬†=¬†$container.data('project-id'); |
| [1245](#L1245) | var¬†fileId¬†=¬†target.data('attachment-id'); |
| [1246](#L1246) | const¬†isExternal¬†=¬†target.data('is-external')¬†==¬†'1'; |
| [1247](#L1247) | const¬†url¬†=¬†target.data('attachment-url'); |
| [1248](#L1248) | const¬†taskName¬†=¬†target.data('task-name'); |
| [1249](#L1249) | const¬†hasTaskName¬†=¬†typeof¬†taskName¬†!==¬†'undefined'¬†&&¬†taskName¬†!==¬†''; |
| [1250](#L1250) |  |
| [1251](#L1251) | if¬†(isExternal)¬†{ |
| [1252](#L1252) | if¬†(action¬†!==¬†'delete'¬†&&¬†action¬†!==¬†'remove\_file')¬†{ |
| [1253](#L1253) | window.open(url,¬†'\_BLANK'); |
| [1254](#L1254) | return; |
| [1255](#L1255) | } |
| [1256](#L1256) | } |
| [1257](#L1257) |  |
| [1258](#L1258) | if¬†(action¬†==¬†'download\_file')¬†{ |
| [1259](#L1259) | var¬†link¬†=¬†document.createElement('a'); |
| [1260](#L1260) | document.body.appendChild(link); |
| [1261](#L1261) | link.download¬†=¬†target.data('attachment-name'); |
| [1262](#L1262) | link.href¬†=¬†target.data('attachment-url'); |
| [1263](#L1263) | link.click(); |
| [1264](#L1264) | } |
| [1265](#L1265) |  |
| [1266](#L1266) | if¬†(action¬†==¬†'show\_info')¬†{ |
| [1267](#L1267) | var¬†file\_data¬†=¬†target.data(); |
| [1268](#L1268) | var¬†html¬†=¬†'<div><label class="zpm\_label">'¬†+¬†zpm\_localized.strings.file\_link¬†+¬†'</label>'¬†+ |
| [1269](#L1269) | '<p><a class="wppm\_link" href="'¬†+¬†file\_data.attachmentUrl¬†+¬†'">'¬†+¬†file\_data.attachmentUrl¬†+¬†'</a></p>'¬†+ |
| [1270](#L1270) | '<label class="zpm\_label">'¬†+¬†zpm\_localized.strings.project¬†+¬†'</label>'¬†+ |
| [1271](#L1271) | '<input type="hidden" id="zpm-file-manager\_\_last-file-id" /> '¬†+ |
| [1272](#L1272) | '<p><select id="zpm-file-manager\_\_project-change" class="zpm\_input">'; |
| [1273](#L1273) |  |
| [1274](#L1274) | zpmProjects.forEach(function¬†(project)¬†{ |
| [1275](#L1275) | html¬†=¬†html¬†+¬†'<option value="'¬†+¬†project.id¬†+¬†'" '; |
| [1276](#L1276) | if¬†(projectId¬†==¬†project.id)¬†{ |
| [1277](#L1277) | html¬†+=¬†'selected="selected" '; |
| [1278](#L1278) | } |
| [1279](#L1279) | html¬†=¬†html¬†+¬†' >'¬†+¬†project.name¬†+¬†'</option>'; |
| [1280](#L1280) | }); |
| [1281](#L1281) | html¬†=¬†html¬†+¬†'</select></p>'; |
| [1282](#L1282) |  |
| [1283](#L1283) | if¬†(hasTaskName)¬†{ |
| [1284](#L1284) | html¬†+=¬†'<div class="zpm-file--task-name" data-task-name-field>'¬†+ |
| [1285](#L1285) | '<label class="zpm\_label">'¬†+¬†zpm\_localized.strings.task¬†+¬†'</label>'¬†+ |
| [1286](#L1286) | '<p data-task-name-field-field>'¬†+¬†taskName¬†+¬†'</p>'¬†+ |
| [1287](#L1287) | '</div>'; |
| [1288](#L1288) | } |
| [1289](#L1289) |  |
| [1290](#L1290) | html¬†+=¬†'<label class="zpm\_label">'¬†+¬†zpm\_localized.strings.date\_uploaded¬†+¬†'</label>'¬†+ |
| [1291](#L1291) | '<p>'¬†+¬†file\_data.attachmentDate¬†+¬†'</p>'¬†+ |
| [1292](#L1292) | '</div>'; |
| [1293](#L1293) |  |
| [1294](#L1294) | zpmNewModal(zpm\_localized.strings.file\_info,¬†file\_data.attachmentName,¬†html,¬†'',¬†'zpm\_file\_info\_modal'); |
| [1295](#L1295) | $('body').find('#zpm-file-manager\_\_last-file-id').val(fileId); |
| [1296](#L1296) | } |
| [1297](#L1297) |  |
| [1298](#L1298) | if¬†(action¬†==¬†'remove\_file')¬†{ |
| [1299](#L1299) | if¬†(confirm(zpm\_localized.strings.delete\_file\_notice))¬†{ |
| [1300](#L1300) | ZephyrProjects.remove\_comment({ |
| [1301](#L1301) | comment\_id:¬†target.data('attachment-id'), |
| [1302](#L1302) | },¬†function¬†()¬†{ |
| [1303](#L1303) | ZephyrProjects.notification(zpm\_localized.strings.file\_removed); |
| [1304](#L1304) | }); |
| [1305](#L1305) | $(this).closest('.zpm\_file\_item\_container').remove(); |
| [1306](#L1306) | } |
| [1307](#L1307) | } |
| [1308](#L1308) | }); |
| [1309](#L1309) |  |
| [1310](#L1310) | $('body').on('change',¬†'#zpm-file-manager\_\_project-change',¬†function¬†()¬†{ |
| [1311](#L1311) | var¬†value¬†=¬†$(this).val(); |
| [1312](#L1312) | var¬†fileId¬†=¬†$('body').find('#zpm-file-manager\_\_last-file-id').val(); |
| [1313](#L1313) | ZephyrProjects.updateFileProject(fileId,¬†value); |
| [1314](#L1314) | $('body').find('.zpm\_file\_item[data-attachment-id="'¬†+¬†fileId¬†+¬†'"]').closest('.zpm\_file\_item\_container').attr('data-project-id',¬†value).data('project-id',¬†value); |
| [1315](#L1315) | ZephyrProjects.remove\_modal('zpm\_file\_info\_modal'); |
| [1316](#L1316) | ZephyrProjects.close\_modal('zpm\_file\_info\_modal'); |
| [1317](#L1317) | }); |
| [1318](#L1318) |  |
| [1319](#L1319) | // Like a task |
| [1320](#L1320) | $('body').on('click',¬†'#zpm\_like\_task\_btn',¬†function¬†(e)¬†{ |
| [1321](#L1321) | $(this).toggleClass('zpm\_liked'); |
| [1322](#L1322) | var¬†task\_id¬†=¬†$(this).data('task-id'); |
| [1323](#L1323) | var¬†data¬†=¬†{ |
| [1324](#L1324) | task\_id:¬†task\_id |
| [1325](#L1325) | }; |
| [1326](#L1326) |  |
| [1327](#L1327) | ZephyrProjects.like\_task(data); |
| [1328](#L1328) | }); |
| [1329](#L1329) |  |
| [1330](#L1330) | // Follow a task |
| [1331](#L1331) | $('body').on('click',¬†'#zpm\_follow\_task',¬†function¬†()¬†{ |
| [1332](#L1332) | var¬†task\_id¬†=¬†$(this).closest('#zpm\_task\_view\_container').data('task-id'); |
| [1333](#L1333) | var¬†data¬†=¬†{ |
| [1334](#L1334) | task\_id:¬†task\_id |
| [1335](#L1335) | }; |
| [1336](#L1336) |  |
| [1337](#L1337) | $('body').find('#zpm\_follow\_task').toggleClass('zpm\_following').removeClass('lnr-plus-circle').addClass('lnr-redo').addClass('zpm\_spin'); |
| [1338](#L1338) |  |
| [1339](#L1339) | ZephyrProjects.follow\_task(data,¬†function¬†(response)¬†{ |
| [1340](#L1340) | $('body').find('#zpm\_follow\_task').removeClass('lnr-redo').removeClass('zpm\_spin').addClass('lnr-plus-circle'); |
| [1341](#L1341) | if¬†(response.following)¬†{ |
| [1342](#L1342) | $('body').find('.zpm\_task\_follower[data-user-id="'¬†+¬†response.user\_id¬†+¬†'"]').remove(); |
| [1343](#L1343) | }¬†else¬†{ |
| [1344](#L1344) | $('body').find('#zpm\_task\_following').append(response.html); |
| [1345](#L1345) | } |
| [1346](#L1346) | }); |
| [1347](#L1347) | }); |
| [1348](#L1348) |  |
| [1349](#L1349) | // Custom Dropdown |
| [1350](#L1350) | $('body').find('#zpm\_new\_task\_assignee').chosen({ |
| [1351](#L1351) | disable\_search\_threshold:¬†10, |
| [1352](#L1352) | no\_results\_text:¬†zpm\_localized.strings.no\_users\_found, |
| [1353](#L1353) | width:¬†"50%" |
| [1354](#L1354) | }); |
| [1355](#L1355) |  |
| [1356](#L1356) | $('body').find('#zpm-edit-task\_\_status').chosen({ |
| [1357](#L1357) | disable\_search\_threshold:¬†10, |
| [1358](#L1358) | no\_results\_text:¬†zpm\_localized.strings.no\_results\_found, |
| [1359](#L1359) | width:¬†"100%" |
| [1360](#L1360) | }); |
| [1361](#L1361) |  |
| [1362](#L1362) | $('body').find('#zpm-edit-project\_\_status').chosen({ |
| [1363](#L1363) | disable\_search\_threshold:¬†10, |
| [1364](#L1364) | no\_results\_text:¬†zpm\_localized.strings.no\_results\_found, |
| [1365](#L1365) | width:¬†"100%" |
| [1366](#L1366) | }); |
| [1367](#L1367) |  |
| [1368](#L1368) | $('body').find('#zpm-new-task\_\_status').chosen({ |
| [1369](#L1369) | disable\_search\_threshold:¬†10, |
| [1370](#L1370) | no\_results\_text:¬†zpm\_localized.strings.no\_results\_found, |
| [1371](#L1371) | width:¬†"100%" |
| [1372](#L1372) | }); |
| [1373](#L1373) |  |
| [1374](#L1374) | $('body').find('#zpm\_file\_upload\_project').chosen({ |
| [1375](#L1375) | disable\_search\_threshold:¬†10, |
| [1376](#L1376) | no\_results\_text:¬†zpm\_localized.strings.no\_users\_found, |
| [1377](#L1377) | width:¬†"50%" |
| [1378](#L1378) | }); |
| [1379](#L1379) |  |
| [1380](#L1380) | $('body').find('#zpm-new-task-team-selection').chosen({ |
| [1381](#L1381) | disable\_search\_threshold:¬†10, |
| [1382](#L1382) | no\_results\_text:¬†zpm\_localized.strings.no\_teams\_found, |
| [1383](#L1383) | width:¬†"50%" |
| [1384](#L1384) | }); |
| [1385](#L1385) |  |
| [1386](#L1386) | $('body').find('#zpm-new-task-template-select').chosen({ |
| [1387](#L1387) | disable\_search\_threshold:¬†10, |
| [1388](#L1388) | no\_results\_text:¬†zpm\_localized.strings.no\_templates\_found, |
| [1389](#L1389) | width:¬†"50%" |
| [1390](#L1390) | }); |
| [1391](#L1391) |  |
| [1392](#L1392) | $('body').find('#zpm\_edit\_task\_assignee').chosen({ |
| [1393](#L1393) | disable\_search\_threshold:¬†10, |
| [1394](#L1394) | no\_results\_text:¬†zpm\_localized.strings.no\_users\_found, |
| [1395](#L1395) | width:¬†"50%" |
| [1396](#L1396) | }); |
| [1397](#L1397) |  |
| [1398](#L1398) | $('body').find('#zpm\_edit\_task\_assignee').addClass('visible').chosen({ |
| [1399](#L1399) | disable\_search\_threshold:¬†10, |
| [1400](#L1400) | no\_results\_text:¬†zpm\_localized.strings.no\_users\_found, |
| [1401](#L1401) | width:¬†"100%" |
| [1402](#L1402) | }); |
| [1403](#L1403) |  |
| [1404](#L1404) | $('body').find('#zpm-edit-task-team-selection').addClass('visible').chosen({ |
| [1405](#L1405) | disable\_search\_threshold:¬†10, |
| [1406](#L1406) | no\_results\_text:¬†zpm\_localized.strings.no\_teams\_found, |
| [1407](#L1407) | width:¬†"100%" |
| [1408](#L1408) | }); |
| [1409](#L1409) |  |
| [1410](#L1410) | $('body').find('#zpm\_edit\_task\_project').addClass('visible').chosen({ |
| [1411](#L1411) | disable\_search\_threshold:¬†10, |
| [1412](#L1412) | no\_results\_text:¬†zpm\_localized.strings.no\_projects\_found, |
| [1413](#L1413) | width:¬†"100%" |
| [1414](#L1414) | }); |
| [1415](#L1415) |  |
| [1416](#L1416) | $('body').find('#zpm-new-project\_\_categories, #zpm-new-project\_\_managers').addClass('visible').chosen({ |
| [1417](#L1417) | disable\_search\_threshold:¬†10, |
| [1418](#L1418) | no\_results\_text:¬†zpm\_localized.strings.no\_results\_found, |
| [1419](#L1419) | width:¬†"100%" |
| [1420](#L1420) | }); |
| [1421](#L1421) |  |
| [1422](#L1422) | $('body').find('#zpm-calendar\_\_filter-team, #zpm-calendar\_\_filter-assignee, #zpm-calendar\_\_filter-project, #zpm-calendar\_\_filter-completed').addClass('visible').chosen({ |
| [1423](#L1423) | disable\_search\_threshold:¬†10, |
| [1424](#L1424) | no\_results\_text:¬†zpm\_localized.strings.no\_results\_found |
| [1425](#L1425) | }); |
| [1426](#L1426) |  |
| [1427](#L1427) | $('body').find('#zpm-edit-task\_\_recurrence-select').chosen({ |
| [1428](#L1428) | disable\_search\_threshold:¬†10, |
| [1429](#L1429) | no\_results\_text:¬†zpm\_localized.strings.no\_results\_found, |
| [1430](#L1430) | width:¬†"100%" |
| [1431](#L1431) | }); |
| [1432](#L1432) |  |
| [1433](#L1433) | $('body').find('#zpm-calendar\_\_filter-completed').val('0').trigger('chosen:updated'); |
| [1434](#L1434) |  |
| [1435](#L1435) | // Edit task team changed |
| [1436](#L1436) | $('body').on('change',¬†'#zpm-edit-task-team-selection',¬†function¬†()¬†{ |
| [1437](#L1437) | let¬†teamId¬†=¬†$(this).val(); |
| [1438](#L1438) |  |
| [1439](#L1439) | updateEditTaskTeamMembers(teamId); |
| [1440](#L1440) | }); |
| [1441](#L1441) |  |
| [1442](#L1442) | // var zpmTeamValue = $('#zpm-edit-task-team-selection').val(); |
| [1443](#L1443) |  |
| [1444](#L1444) | // if (typeof zpmTeamValue !== 'undefined' && zpmTeamValue !== -1) { |
| [1445](#L1445) | //¬† ¬† ¬† //updateEditTaskTeamMembers(zpmTeamValue); |
| [1446](#L1446) | //¬† ¬† ¬† ZephyrProjects.getTeam({ |
| [1447](#L1447) | //¬† ¬† ¬† ¬† ¬† ¬† ¬† id: zpmTeamValue |
| [1448](#L1448) | //¬† ¬† ¬† }, function(res) { |
| [1449](#L1449) |  |
| [1450](#L1450) | //¬† ¬† ¬† ¬† ¬† ¬† ¬† if (res != null) { |
| [1451](#L1451) | //¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† $('#zpm\_edit\_task\_assignee > option').hide(); |
| [1452](#L1452) | //¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† $('#zpm\_edit\_task\_assignee > option[value="-1"]').show(); |
| [1453](#L1453) | //¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† $.each(res.members, function(key, val) { |
| [1454](#L1454) | //¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† let userId = val.id; |
| [1455](#L1455) | //¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† $('#zpm\_edit\_task\_assignee > option[value="' + userId + '"]').show(); |
| [1456](#L1456) | //¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† $('#zpm\_edit\_task\_assignee').trigger("chosen:updated"); |
| [1457](#L1457) | //¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† }); |
| [1458](#L1458) | //¬† ¬† ¬† ¬† ¬† ¬† ¬† } |
| [1459](#L1459) | //¬† ¬† ¬† }); |
| [1460](#L1460) | // } |
| [1461](#L1461) |  |
| [1462](#L1462) | function¬†updateEditTaskTeamMembers(teamId)¬†{ |
| [1463](#L1463) | //$('#zpm\_edit\_task\_assignee > option').show(); |
| [1464](#L1464) | //$('#zpm\_edit\_task\_assignee').trigger("chosen:updated"); |
| [1465](#L1465) |  |
| [1466](#L1466) | ZephyrProjects.getTeam({ |
| [1467](#L1467) | id:¬†teamId |
| [1468](#L1468) | },¬†function¬†(res)¬†{ |
| [1469](#L1469) | $('#zpm\_edit\_task\_assignee').val(''); |
| [1470](#L1470) | $('#zpm\_edit\_task\_assignee').trigger("chosen:updated"); |
| [1471](#L1471) | if¬†(res¬†!=¬†null)¬†{ |
| [1472](#L1472) | var¬†values¬†=¬†[]; |
| [1473](#L1473) | $.each(res.members,¬†function¬†(key,¬†val)¬†{ |
| [1474](#L1474) | let¬†userId¬†=¬†val.id; |
| [1475](#L1475) | values.push(userId); |
| [1476](#L1476) | }); |
| [1477](#L1477) | $('#zpm\_edit\_task\_assignee').val(values); |
| [1478](#L1478) | $('#zpm\_edit\_task\_assignee').trigger("chosen:updated"); |
| [1479](#L1479) | } |
| [1480](#L1480) | }); |
| [1481](#L1481) | } |
| [1482](#L1482) |  |
| [1483](#L1483) | // Task Subtasks |
| [1484](#L1484) | $('body').on('click',¬†'#zpm\_task\_add\_subtask',¬†function¬†()¬†{ |
| [1485](#L1485) | var¬†newSubTask¬†=¬†'<span class="zpm\_task\_subtask"><input type="text" class="zpm\_task\_subtask\_item" placeholder="'¬†+¬†zpm\_localized.strings.new\_subtask¬†+¬†'" value=""/><i class="zpm\_delete\_subtask\_icon dashicons dashicons-no-alt"></i></span>'; |
| [1486](#L1486) | $('body').find('#zpm\_task\_subtasks').append(newSubTask); |
| [1487](#L1487) | var¬†lastSubTask¬†=¬†$('body').find('.zpm\_task\_subtask:last-of-type'); |
| [1488](#L1488) | var¬†scrollParent¬†=¬†$('body').find('.zpm\_modal\_content'); |
| [1489](#L1489) |  |
| [1490](#L1490) | scrollParent.animate({ |
| [1491](#L1491) | scrollTop:¬†lastSubTask.offset().top |
| [1492](#L1492) | },¬†0); |
| [1493](#L1493) | }); |
| [1494](#L1494) |  |
| [1495](#L1495) | $('body').on('click',¬†'.zpm\_delete\_subtask\_icon',¬†function¬†()¬†{ |
| [1496](#L1496) | $(this).closest('.zpm\_task\_subtask').remove(); |
| [1497](#L1497) | }); |
| [1498](#L1498) |  |
| [1499](#L1499) | // Task Options |
| [1500](#L1500) | $('body').on('click',¬†'.zpm\_modal\_options\_btn',¬†function¬†()¬†{ |
| [1501](#L1501) | var¬†dropdown¬†=¬†$(this).data('dropdown-id'); |
| [1502](#L1502) | const¬†$menu¬†=¬†$(this).find('.zpm\_modal\_dropdown'); |
| [1503](#L1503) | $menu.toggleClass('active'); |
| [1504](#L1504) | $menu.attr('aria-hidden',¬†$menu.hasClass('active')¬†?¬†'false'¬†:¬†'true'); |
| [1505](#L1505) | }); |
| [1506](#L1506) |  |
| [1507](#L1507) | $('body').on('click',¬†'[zpm-toggle-dropdown]',¬†function¬†(e)¬†{ |
| [1508](#L1508) | e.stopPropagation(); |
| [1509](#L1509) | let¬†id¬†=¬†$(this).attr('zpm-toggle-dropdown'); |
| [1510](#L1510) | const¬†$dropdown¬†=¬†$('body').find('#'¬†+¬†id); |
| [1511](#L1511) | jQuery('body').find('.zpm-dropdown').not($dropdown).removeClass('zpm-open'); |
| [1512](#L1512) | $dropdown.toggleClass('zpm-open'); |
| [1513](#L1513) | }); |
| [1514](#L1514) |  |
| [1515](#L1515) | $('body').on('click',¬†'.zpm-dropdown-item',¬†function¬†(e)¬†{ |
| [1516](#L1516) | $(this).closest('.zpm-dropdown').removeClass('zpm-open'); |
| [1517](#L1517) | e.stopPropagation(); |
| [1518](#L1518) | }); |
| [1519](#L1519) |  |
| [1520](#L1520) | // New Task Priority |
| [1521](#L1521) | $('body').on('click',¬†'.zpm-new-task-priority',¬†function¬†(e)¬†{ |
| [1522](#L1522) | let¬†priority¬†=¬†$(this).data('value'); |
| [1523](#L1523) | let¬†color¬†=¬†$(this).data('color'); |
| [1524](#L1524) |  |
| [1525](#L1525) | if¬†(typeof¬†color¬†!==¬†"undefined")¬†{ |
| [1526](#L1526) | var¬†text\_color¬†=¬†"#fff"; |
| [1527](#L1527) | if¬†(priority¬†==¬†"priority\_none")¬†{ |
| [1528](#L1528) | text\_color¬†=¬†"#333"; |
| [1529](#L1529) | } |
| [1530](#L1530) | $('body').find('#zpm-new-task-priority').attr('style',¬†'background: '¬†+¬†color¬†+¬†' !important; color: '¬†+¬†text\_color¬†+¬†' !important'); |
| [1531](#L1531) | } |
| [1532](#L1532) |  |
| [1533](#L1533) | $('body').find('#zpm-new-task-priority').attr('data-priority',¬†priority); |
| [1534](#L1534) | $('body').find('#zpm-new-task-priority-value').val(priority); |
| [1535](#L1535) | $('body').find('#zpm-new-task-priority .zpm-priority-name').text(zpm\_localized.strings.priority¬†+¬†": "¬†+¬†$(this).text()); |
| [1536](#L1536) | e.stopPropagation(); |
| [1537](#L1537) | }); |
| [1538](#L1538) |  |
| [1539](#L1539) | // Edit Task Priority |
| [1540](#L1540) | $('body').on('click',¬†'.zpm-edit-task-priority',¬†function¬†(e)¬†{ |
| [1541](#L1541) | let¬†priority¬†=¬†$(this).data('value'); |
| [1542](#L1542) | let¬†color¬†=¬†$(this).data('color'); |
| [1543](#L1543) |  |
| [1544](#L1544) | if¬†(typeof¬†color¬†!==¬†"undefined")¬†{ |
| [1545](#L1545) | var¬†text\_color¬†=¬†"#fff"; |
| [1546](#L1546) | if¬†(priority¬†==¬†"priority\_none")¬†{ |
| [1547](#L1547) | text\_color¬†=¬†"#333"; |
| [1548](#L1548) | } |
| [1549](#L1549) | $('body').find('#zpm-edit-task-priority').attr('style',¬†'background: '¬†+¬†color¬†+¬†' !important; color: '¬†+¬†text\_color¬†+¬†' !important'); |
| [1550](#L1550) | } |
| [1551](#L1551) |  |
| [1552](#L1552) | $('body').find('#zpm-edit-task-priority').attr('data-priority',¬†priority); |
| [1553](#L1553) | $('body').find('#zpm-edit-task-priority-value').val(priority); |
| [1554](#L1554) | $('body').find('#zpm-edit-task-priority .zpm-priority-name').text(zpm\_localized.strings.priority¬†+¬†": "¬†+¬†$(this).text()); |
| [1555](#L1555) | e.stopPropagation(); |
| [1556](#L1556) | }); |
| [1557](#L1557) |  |
| [1558](#L1558) | // General Priority Dropdown |
| [1559](#L1559) | $('body').on('click',¬†'.zpm-priority-selection .zpm-dropdown-item',¬†function¬†(e)¬†{ |
| [1560](#L1560) | let¬†priority¬†=¬†$(this).data('value'); |
| [1561](#L1561) | let¬†color¬†=¬†$(this).data('color'); |
| [1562](#L1562) |  |
| [1563](#L1563) | if¬†(typeof¬†color¬†!==¬†"undefined")¬†{ |
| [1564](#L1564) | var¬†text\_color¬†=¬†"#fff"; |
| [1565](#L1565) | if¬†(priority¬†==¬†"priority\_none")¬†{ |
| [1566](#L1566) | text\_color¬†=¬†"#333"; |
| [1567](#L1567) | } |
| [1568](#L1568) | $('body').find('#zpm-edit-task-priority').attr('style',¬†'background: '¬†+¬†color¬†+¬†' !important; color: '¬†+¬†text\_color¬†+¬†' !important'); |
| [1569](#L1569) | } |
| [1570](#L1570) |  |
| [1571](#L1571) | if¬†(typeof¬†color¬†!==¬†"undefined")¬†{ |
| [1572](#L1572) | $(this).closest('.zpm-priority-selection').attr('style',¬†'background: '¬†+¬†color¬†+¬†' !important; color: '¬†+¬†text\_color¬†+¬†' !important;'); |
| [1573](#L1573) | } |
| [1574](#L1574) |  |
| [1575](#L1575) | $(this).closest('.zpm-priority-selection').attr('data-priority',¬†priority); |
| [1576](#L1576) | $(this).closest('.zpm-priority-selection').prev().val(priority); |
| [1577](#L1577) | $(this).closest('.zpm-priority-selection').find('.zpm-priority-name').text(zpm\_localized.strings.priority¬†+¬†": "¬†+¬†$(this).text()); |
| [1578](#L1578) | e.stopPropagation(); |
| [1579](#L1579) | }); |
| [1580](#L1580) |  |
| [1581](#L1581) | // Copy a task |
| [1582](#L1582) | $('body').on('click',¬†'#zpm\_copy\_task',¬†function¬†()¬†{ |
| [1583](#L1583) | var¬†taskId¬†=¬†$(this).closest('[data-task-id]').data('task-id'); |
| [1584](#L1584) | var¬†baseModal¬†=¬†$(this).closest('.zpm-modal'); |
| [1585](#L1585) | var¬†taskName¬†=¬†baseModal.find('.zpm\_modal\_task\_name').html(); |
| [1586](#L1586) | var¬†buttons¬†=¬†'<button id="zpm\_copy\_task\_btn" class="zpm\_button">'¬†+¬†zpm\_localized.strings.create\_new\_task¬†+¬†'</button>'; |
| [1587](#L1587) |  |
| [1588](#L1588) | if¬†(baseModal.length¬†==¬†0)¬†{ |
| [1589](#L1589) | taskName¬†=¬†jQuery('body').find('#zpm\_task\_name\_title').text(); |
| [1590](#L1590) | } |
| [1591](#L1591) |  |
| [1592](#L1592) | var¬†optionsList¬†=¬†[ |
| [1593](#L1593) | { |
| [1594](#L1594) | name:¬†zpm\_localized.strings.task\_description, |
| [1595](#L1595) | default:¬†'checked', |
| [1596](#L1596) | value:¬†'description' |
| [1597](#L1597) | },¬†{ |
| [1598](#L1598) | name:¬†zpm\_localized.strings.assignee, |
| [1599](#L1599) | default:¬†'checked', |
| [1600](#L1600) | value:¬†'assignee' |
| [1601](#L1601) | },¬†{ |
| [1602](#L1602) | name:¬†zpm\_localized.strings.subtasks, |
| [1603](#L1603) | default:¬†'checked', |
| [1604](#L1604) | value:¬†'subtasks' |
| [1605](#L1605) | },¬†{ |
| [1606](#L1606) | name:¬†zpm\_localized.strings.attachments, |
| [1607](#L1607) | default:¬†'', |
| [1608](#L1608) | value:¬†'attachments' |
| [1609](#L1609) | },¬†{ |
| [1610](#L1610) | name:¬†zpm\_localized.strings.start\_date, |
| [1611](#L1611) | default:¬†'checked', |
| [1612](#L1612) | value:¬†'start\_date' |
| [1613](#L1613) | },¬†{ |
| [1614](#L1614) | name:¬†zpm\_localized.strings.due\_date, |
| [1615](#L1615) | default:¬†'checked', |
| [1616](#L1616) | value:¬†'due\_date', |
| [1617](#L1617) | } |
| [1618](#L1618) | ]; |
| [1619](#L1619) |  |
| [1620](#L1620) | var¬†options¬†=¬†'<ul class="zpm\_copy\_task\_options">'; |
| [1621](#L1621) | for¬†(var¬†i¬†=¬†0;¬†i¬†<¬†optionsList.length;¬†i++)¬†{ |
| [1622](#L1622) | options¬†=¬†options¬†+ |
| [1623](#L1623) | '<li>'¬†+ |
| [1624](#L1624) | '<label for="zpm\_copy\_task\_option\_'¬†+¬†i¬†+¬†'" class="zpm\_checkbox\_label">'¬†+ |
| [1625](#L1625) | '<input type="checkbox" id="zpm\_copy\_task\_option\_'¬†+¬†i¬†+¬†'" name="zpm\_copy\_task\_option\_'¬†+¬†i¬†+¬†'" class="zpm\_copy\_task\_option zpm\_toggle invisible" value="1" '¬†+¬†optionsList[i].default¬†+¬†' data-option-value="'¬†+¬†optionsList[i].value¬†+¬†'">'¬†+ |
| [1626](#L1626) | '<div class="zpm\_main\_checkbox">'¬†+ |
| [1627](#L1627) | '<svg width="20px" height="20px" viewBox="0 0 20 20">'¬†+ |
| [1628](#L1628) | '<path d="M3,1 L17,1 L17,1 C18.1045695,1 19,1.8954305 19,3 L19,17 L19,17 C19,18.1045695 18.1045695,19 17,19 L3,19 L3,19 C1.8954305,19 1,18.1045695 1,17 L1,3 L1,3 C1,1.8954305 1.8954305,1 3,1 Z"></path>'¬†+ |
| [1629](#L1629) | '<polyline points="4 11 8 15 16 6"></polyline>'¬†+ |
| [1630](#L1630) | '</svg>'¬†+ |
| [1631](#L1631) | '</div>'¬†+ |
| [1632](#L1632) | '</label>'¬†+ |
| [1633](#L1633) | optionsList[i].name¬†+ |
| [1634](#L1634) | '</li>'; |
| [1635](#L1635) | } |
| [1636](#L1636) | var¬†options¬†=¬†options¬†+¬†'</ul>'; |
| [1637](#L1637) | var¬†content¬†=¬†'<p id="zpm\_copy\_task\_body"><h5 class="zpm\_copy\_project\_title">'¬†+¬†zpm\_localized.strings.include¬†+¬†': </h5>'¬†+¬†options¬†+¬†'</p>'; |
| [1638](#L1638) |  |
| [1639](#L1639) | ZephyrProjects.close\_modal(); |
| [1640](#L1640) | zpmNewModal(zpm\_localized.strings.copy\_task,¬†'<input id="zpm\_copy\_task\_name" value="'¬†+¬†zpm\_localized.strings.copy\_of¬†+¬†' '¬†+¬†$.trim(taskName)¬†+¬†'" placeholder="'¬†+¬†zpm\_localized.strings.task\_name¬†+¬†'" />',¬†content,¬†buttons,¬†'zpm\_copy\_task\_modal',¬†taskId); |
| [1641](#L1641) | ZephyrProjects.open\_modal('zpm\_copy\_task\_modal'); |
| [1642](#L1642) | }); |
| [1643](#L1643) |  |
| [1644](#L1644) | $('body').on('click',¬†'#zpm\_copy\_task\_btn',¬†function¬†()¬†{ |
| [1645](#L1645) | var¬†taskId¬†=¬†$(this).closest('.zpm-modal').data('task-id'); |
| [1646](#L1646) | var¬†newName¬†=¬†$('body').find('#zpm\_copy\_task\_name').val(); |
| [1647](#L1647) | var¬†copySettings¬†=¬†[]; |
| [1648](#L1648) |  |
| [1649](#L1649) | $('.zpm\_copy\_task\_options .zpm\_copy\_task\_option').each(function¬†()¬†{ |
| [1650](#L1650) | var¬†checked¬†=¬†($(this).is(':checked'))¬†?¬†true¬†:¬†false; |
| [1651](#L1651) | var¬†optionValue¬†=¬†$(this).data('option-value'); |
| [1652](#L1652) |  |
| [1653](#L1653) | if¬†(checked)¬†{ |
| [1654](#L1654) | copySettings.push(optionValue); |
| [1655](#L1655) | } |
| [1656](#L1656) | }); |
| [1657](#L1657) |  |
| [1658](#L1658) | var¬†data¬†=¬†{ |
| [1659](#L1659) | task\_id:¬†taskId, |
| [1660](#L1660) | task\_name:¬†newName, |
| [1661](#L1661) | copy\_options:¬†copySettings |
| [1662](#L1662) | }; |
| [1663](#L1663) | ZephyrProjects.copy\_task(data,¬†function¬†(response)¬†{ |
| [1664](#L1664) | $('body').find('.zpm\_task\_list').append(response.html); |
| [1665](#L1665) | $('body').find('.zpm\_message\_center').remove(); |
| [1666](#L1666) | }); |
| [1667](#L1667) |  |
| [1668](#L1668) | ZephyrProjects.close\_modal(); |
| [1669](#L1669) | }); |
| [1670](#L1670) |  |
| [1671](#L1671) | // Copy a project |
| [1672](#L1672) | $('body').on('click',¬†'#zpm\_copy\_project',¬†function¬†()¬†{ |
| [1673](#L1673) | var¬†projectId¬†=¬†$(this).closest('.zpm\_project\_item').data('project-id'); |
| [1674](#L1674) | var¬†projectName¬†=¬†$(this).closest('.zpm\_project\_item').find('.zpm\_project\_grid\_name').text(); |
| [1675](#L1675) | var¬†buttons¬†=¬†'<button id="zpm\_copy\_project\_btn" class="zpm\_button">'¬†+¬†zpm\_localized.strings.create\_new\_project¬†+¬†'</button>'; |
| [1676](#L1676) |  |
| [1677](#L1677) | var¬†optionsList¬†=¬†[ |
| [1678](#L1678) | { |
| [1679](#L1679) | name:¬†zpm\_localized.strings.description, |
| [1680](#L1680) | default:¬†'checked', |
| [1681](#L1681) | value:¬†'description' |
| [1682](#L1682) | },¬†{ |
| [1683](#L1683) | name:¬†zpm\_localized.strings.tasks, |
| [1684](#L1684) | default:¬†'checked', |
| [1685](#L1685) | value:¬†'tasks' |
| [1686](#L1686) | },¬†{ |
| [1687](#L1687) | name:¬†zpm\_localized.strings.attachments, |
| [1688](#L1688) | default:¬†'checked', |
| [1689](#L1689) | value:¬†'attachments' |
| [1690](#L1690) | },¬†{ |
| [1691](#L1691) | name:¬†zpm\_localized.strings.start\_date, |
| [1692](#L1692) | default:¬†'checked', |
| [1693](#L1693) | value:¬†'start\_date' |
| [1694](#L1694) | },¬†{ |
| [1695](#L1695) | name:¬†zpm\_localized.strings.due\_date, |
| [1696](#L1696) | default:¬†'checked', |
| [1697](#L1697) | value:¬†'due\_date', |
| [1698](#L1698) | },¬†{ |
| [1699](#L1699) | name:¬†'Milestones', |
| [1700](#L1700) | default:¬†'checked', |
| [1701](#L1701) | value:¬†'milestones', |
| [1702](#L1702) | },¬†{ |
| [1703](#L1703) | name:¬†'Blocking Tasks', |
| [1704](#L1704) | default:¬†'checked', |
| [1705](#L1705) | value:¬†'blockingTasks', |
| [1706](#L1706) | } |
| [1707](#L1707) | ]; |
| [1708](#L1708) |  |
| [1709](#L1709) | var¬†options¬†=¬†'<ul class="zpm\_copy\_project\_options">'; |
| [1710](#L1710) | for¬†(var¬†i¬†=¬†0;¬†i¬†<¬†optionsList.length;¬†i++)¬†{ |
| [1711](#L1711) | options¬†=¬†options¬†+ |
| [1712](#L1712) | '<li>'¬†+ |
| [1713](#L1713) | '<label for="zpm\_copy\_project\_option\_'¬†+¬†i¬†+¬†'" class="zpm\_checkbox\_label">'¬†+ |
| [1714](#L1714) | '<input type="checkbox" id="zpm\_copy\_project\_option\_'¬†+¬†i¬†+¬†'" name="zpm\_copy\_project\_option\_'¬†+¬†i¬†+¬†'" class="zpm\_copy\_project\_option zpm\_toggle invisible" value="1" '¬†+¬†optionsList[i].default¬†+¬†' data-option-value="'¬†+¬†optionsList[i].value¬†+¬†'">'¬†+ |
| [1715](#L1715) | '<div class="zpm\_main\_checkbox">'¬†+ |
| [1716](#L1716) | '<svg width="20px" height="20px" viewBox="0 0 20 20">'¬†+ |
| [1717](#L1717) | '<path d="M3,1 L17,1 L17,1 C18.1045695,1 19,1.8954305 19,3 L19,17 L19,17 C19,18.1045695 18.1045695,19 17,19 L3,19 L3,19 C1.8954305,19 1,18.1045695 1,17 L1,3 L1,3 C1,1.8954305 1.8954305,1 3,1 Z"></path>'¬†+ |
| [1718](#L1718) | '<polyline points="4 11 8 15 16 6"></polyline>'¬†+ |
| [1719](#L1719) | '</svg>'¬†+ |
| [1720](#L1720) | '</div>'¬†+ |
| [1721](#L1721) | '</label>'¬†+ |
| [1722](#L1722) | optionsList[i].name¬†+ |
| [1723](#L1723) | '</li>'; |
| [1724](#L1724) | } |
| [1725](#L1725) | var¬†options¬†=¬†options¬†+¬†'</ul>'; |
| [1726](#L1726) | var¬†content¬†=¬†'<p id="zpm\_copy\_project\_body"><h5>'¬†+¬†zpm\_localized.strings.include¬†+¬†': </h5>'¬†+¬†options¬†+¬†'</p>'; |
| [1727](#L1727) |  |
| [1728](#L1728) | ZephyrProjects.close\_modal(); |
| [1729](#L1729) | const¬†value¬†=¬†zpm\_localized.strings.copy\_of¬†+¬†' '¬†+¬†$.trim(projectName); |
| [1730](#L1730) | zpmNewModal(zpm\_localized.strings.copy\_project,¬†'<input id="zpm\_copy\_project\_name" value="'¬†+¬†value¬†+¬†'" placeholder="'¬†+¬†zpm\_localized.strings.project\_name¬†+¬†'" />',¬†content,¬†buttons,¬†'zpm\_copy\_project\_modal',¬†projectId,¬†'',¬†projectId); |
| [1731](#L1731) | ZephyrProjects.open\_modal('zpm\_copy\_project\_modal'); |
| [1732](#L1732) | }); |
| [1733](#L1733) |  |
| [1734](#L1734) | $('body').on('click',¬†'#zpm\_copy\_project\_btn',¬†function¬†()¬†{ |
| [1735](#L1735) | var¬†project\_id¬†=¬†$(this).closest('.zpm-modal').data('project-id'); |
| [1736](#L1736) | var¬†new\_name¬†=¬†$('body').find('#zpm\_copy\_project\_name').val(); |
| [1737](#L1737) | var¬†copy\_options¬†=¬†[]; |
| [1738](#L1738) |  |
| [1739](#L1739) | $('.zpm\_copy\_project\_options .zpm\_copy\_project\_option').each(function¬†()¬†{ |
| [1740](#L1740) | var¬†checked¬†=¬†($(this).is(':checked'))¬†?¬†true¬†:¬†false; |
| [1741](#L1741) | var¬†option\_value¬†=¬†$(this).data('option-value'); |
| [1742](#L1742) | if¬†(checked)¬†{ |
| [1743](#L1743) | copy\_options.push(option\_value); |
| [1744](#L1744) | } |
| [1745](#L1745) | }); |
| [1746](#L1746) |  |
| [1747](#L1747) | var¬†data¬†=¬†{ |
| [1748](#L1748) | project\_id:¬†project\_id, |
| [1749](#L1749) | project\_name:¬†new\_name, |
| [1750](#L1750) | copy\_options:¬†copy\_options |
| [1751](#L1751) | }; |
| [1752](#L1752) |  |
| [1753](#L1753) | ZephyrProjects.copy\_project(data,¬†function¬†(response)¬†{ |
| [1754](#L1754) | $('body').find('.zpm\_project\_grid').prepend(response.html); |
| [1755](#L1755) | }); |
| [1756](#L1756) | ZephyrProjects.close\_modal(); |
| [1757](#L1757) | }); |
| [1758](#L1758) |  |
| [1759](#L1759) |  |
| [1760](#L1760) | // Convert task to Project |
| [1761](#L1761) | $('body').on('click',¬†'#zpm\_convert\_task',¬†function¬†()¬†{ |
| [1762](#L1762) | var¬†taskId¬†=¬†$(this).closest('[data-task-id]').data('task-id'); |
| [1763](#L1763) | var¬†baseModal¬†=¬†$(this).closest('.zpm-modal'); |
| [1764](#L1764) | var¬†taskName¬†=¬†baseModal.find('.zpm\_modal\_task\_name').html(); |
| [1765](#L1765) | var¬†buttons¬†=¬†'<button id="zpm\_convert\_task\_btn" class="zpm\_button">'¬†+¬†zpm\_localized.strings.convert\_task¬†+¬†'</button>'; |
| [1766](#L1766) |  |
| [1767](#L1767) | if¬†(baseModal.length¬†==¬†0)¬†{ |
| [1768](#L1768) | taskName¬†=¬†jQuery('body').find('#zpm\_task\_name\_title').text(); |
| [1769](#L1769) | } |
| [1770](#L1770) |  |
| [1771](#L1771) | var¬†optionsList¬†=¬†[ |
| [1772](#L1772) | { |
| [1773](#L1773) | name:¬†zpm\_localized.strings.task\_description\_as\_description, |
| [1774](#L1774) | default:¬†'checked', |
| [1775](#L1775) | value:¬†'description' |
| [1776](#L1776) | },¬†{ |
| [1777](#L1777) | name:¬†zpm\_localized.strings.subtasks\_as\_tasks, |
| [1778](#L1778) | default:¬†'checked', |
| [1779](#L1779) | value:¬†'subtasks' |
| [1780](#L1780) | },¬†{ |
| [1781](#L1781) | name:¬†zpm\_localized.strings.assignee\_as\_creator, |
| [1782](#L1782) | default:¬†'checked', |
| [1783](#L1783) | value:¬†'assignee' |
| [1784](#L1784) | } |
| [1785](#L1785) | ]; |
| [1786](#L1786) |  |
| [1787](#L1787) | var¬†options¬†=¬†'<ul class="zpm\_convert\_task\_options">'; |
| [1788](#L1788) | for¬†(var¬†i¬†=¬†0;¬†i¬†<¬†optionsList.length;¬†i++)¬†{ |
| [1789](#L1789) | options¬†=¬†options¬†+ |
| [1790](#L1790) | '<li>'¬†+ |
| [1791](#L1791) | '<label for="zpm\_convert\_task\_option\_'¬†+¬†i¬†+¬†'" class="zpm\_checkbox\_label">'¬†+ |
| [1792](#L1792) | '<input type="checkbox" id="zpm\_convert\_task\_option\_'¬†+¬†i¬†+¬†'" name="zpm\_convert\_task\_option\_'¬†+¬†i¬†+¬†'" class="zpm\_convert\_task\_option zpm\_toggle invisible" value="1" '¬†+¬†optionsList[i].default¬†+¬†' data-option-value="'¬†+¬†optionsList[i].value¬†+¬†'">'¬†+ |
| [1793](#L1793) | '<div class="zpm\_main\_checkbox">'¬†+ |
| [1794](#L1794) | '<svg width="20px" height="20px" viewBox="0 0 20 20">'¬†+ |
| [1795](#L1795) | '<path d="M3,1 L17,1 L17,1 C18.1045695,1 19,1.8954305 19,3 L19,17 L19,17 C19,18.1045695 18.1045695,19 17,19 L3,19 L3,19 C1.8954305,19 1,18.1045695 1,17 L1,3 L1,3 C1,1.8954305 1.8954305,1 3,1 Z"></path>'¬†+ |
| [1796](#L1796) | '<polyline points="4 11 8 15 16 6"></polyline>'¬†+ |
| [1797](#L1797) | '</svg>'¬†+ |
| [1798](#L1798) | '</div>'¬†+ |
| [1799](#L1799) | '</label>'¬†+ |
| [1800](#L1800) | optionsList[i].name¬†+ |
| [1801](#L1801) | '</li>'; |
| [1802](#L1802) | } |
| [1803](#L1803) | var¬†options¬†=¬†options¬†+¬†'</ul>'; |
| [1804](#L1804) | var¬†content¬†=¬†'<p id="zpm\_convert\_task\_body"><h5>'¬†+¬†zpm\_localized.strings.include¬†+¬†': </h5>'¬†+¬†options¬†+¬†'</p>'; |
| [1805](#L1805) |  |
| [1806](#L1806) | ZephyrProjects.close\_modal(); |
| [1807](#L1807) | zpmNewModal(zpm\_localized.strings.convert\_to\_project,¬†'<input id="zpm\_convert\_task\_name" value="'¬†+¬†zpm\_localized.strings.project¬†+¬†': '¬†+¬†$.trim(taskName)¬†+¬†'" placeholder="'¬†+¬†zpm\_localized.strings.project\_name¬†+¬†'" />',¬†content,¬†buttons,¬†'zpm\_convert\_task\_modal',¬†taskId); |
| [1808](#L1808) | ZephyrProjects.open\_modal('zpm\_convert\_task\_modal'); |
| [1809](#L1809) | }); |
| [1810](#L1810) |  |
| [1811](#L1811) | $('body').on('click',¬†'#zpm\_convert\_task\_btn',¬†function¬†()¬†{ |
| [1812](#L1812) | var¬†taskId¬†=¬†$(this).closest('.zpm-modal').data('task-id'); |
| [1813](#L1813) | var¬†newName¬†=¬†$('body').find('#zpm\_convert\_task\_name').val(); |
| [1814](#L1814) |  |
| [1815](#L1815) | var¬†convertSettings¬†=¬†[]; |
| [1816](#L1816) | $('.zpm\_convert\_task\_options .zpm\_convert\_task\_option').each(function¬†()¬†{ |
| [1817](#L1817) | var¬†checked¬†=¬†($(this).is(':checked'))¬†?¬†true¬†:¬†false; |
| [1818](#L1818) | var¬†optionValue¬†=¬†$(this).data('option-value'); |
| [1819](#L1819) | if¬†(checked)¬†{ |
| [1820](#L1820) | convertSettings.push(optionValue); |
| [1821](#L1821) | } |
| [1822](#L1822) | }); |
| [1823](#L1823) |  |
| [1824](#L1824) | var¬†data¬†=¬†{ |
| [1825](#L1825) | task\_id:¬†taskId, |
| [1826](#L1826) | project\_name:¬†newName, |
| [1827](#L1827) | convert\_options:¬†convertSettings |
| [1828](#L1828) | }; |
| [1829](#L1829) |  |
| [1830](#L1830) | ZephyrProjects.task\_to\_project(data,¬†function¬†(response)¬†{ |
| [1831](#L1831) |  |
| [1832](#L1832) | }); |
| [1833](#L1833) |  |
| [1834](#L1834) | ZephyrProjects.close\_modal(); |
| [1835](#L1835) | }); |
| [1836](#L1836) |  |
| [1837](#L1837) |  |
| [1838](#L1838) | // Export a task to JSON |
| [1839](#L1839) | $('body').on('click',¬†'#zpm\_export\_task\_to\_json',¬†function¬†()¬†{ |
| [1840](#L1840) | var¬†taskId¬†=¬†$(this).closest('[data-task-id]').data('task-id'); |
| [1841](#L1841) |  |
| [1842](#L1842) | var¬†data¬†=¬†{ |
| [1843](#L1843) | task\_id:¬†taskId, |
| [1844](#L1844) | export\_to:¬†'json' |
| [1845](#L1845) | }; |
| [1846](#L1846) |  |
| [1847](#L1847) | ZephyrProjects.export\_task(data,¬†function¬†(response)¬†{ |
| [1848](#L1848) | var¬†link¬†=¬†document.createElement('a'); |
| [1849](#L1849) | document.body.appendChild(link); |
| [1850](#L1850) | link.download¬†=¬†response.file\_name; |
| [1851](#L1851) | link.href¬†=¬†response.file\_url; |
| [1852](#L1852) | link.click(); |
| [1853](#L1853) | }); |
| [1854](#L1854) | }); |
| [1855](#L1855) |  |
| [1856](#L1856) | // Export a task to CSV |
| [1857](#L1857) | $('body').on('click',¬†'#zpm\_export\_task\_to\_csv',¬†function¬†()¬†{ |
| [1858](#L1858) | var¬†taskId¬†=¬†$(this).closest('[data-task-id]').data('task-id'); |
| [1859](#L1859) | var¬†data¬†=¬†{ |
| [1860](#L1860) | task\_id:¬†taskId, |
| [1861](#L1861) | export\_to:¬†'csv' |
| [1862](#L1862) | }; |
| [1863](#L1863) |  |
| [1864](#L1864) | ZephyrProjects.export\_task(data,¬†function¬†(response)¬†{ |
| [1865](#L1865) | var¬†link¬†=¬†document.createElement('a'); |
| [1866](#L1866) | document.body.appendChild(link); |
| [1867](#L1867) | link.download¬†=¬†response.file\_name; |
| [1868](#L1868) | link.href¬†=¬†response.file\_url; |
| [1869](#L1869) | link.click(); |
| [1870](#L1870) | }); |
| [1871](#L1871) |  |
| [1872](#L1872) | }); |
| [1873](#L1873) |  |
| [1874](#L1874) | // Export all tasks to JSON |
| [1875](#L1875) | $('body').on('click',¬†'#zpm\_export\_all\_tasks\_to\_json',¬†function¬†()¬†{ |
| [1876](#L1876) |  |
| [1877](#L1877) | var¬†data¬†=¬†{ |
| [1878](#L1878) | export\_to:¬†'json' |
| [1879](#L1879) | }; |
| [1880](#L1880) |  |
| [1881](#L1881) | ZephyrProjects.export\_tasks(data,¬†function¬†(response)¬†{ |
| [1882](#L1882) | var¬†link¬†=¬†document.createElement('a'); |
| [1883](#L1883) | document.body.appendChild(link); |
| [1884](#L1884) | link.download¬†=¬†'All Tasks.json'; |
| [1885](#L1885) | link.href¬†=¬†response; |
| [1886](#L1886) | link.click(); |
| [1887](#L1887) | }); |
| [1888](#L1888) | }); |
| [1889](#L1889) |  |
| [1890](#L1890) | // Export all tasks to CSV |
| [1891](#L1891) | $('body').on('click',¬†'#zpm\_export\_all\_tasks\_to\_csv',¬†function¬†()¬†{ |
| [1892](#L1892) |  |
| [1893](#L1893) | var¬†data¬†=¬†{ |
| [1894](#L1894) | export\_to:¬†'csv' |
| [1895](#L1895) | }; |
| [1896](#L1896) |  |
| [1897](#L1897) | ZephyrProjects.export\_tasks(data,¬†function¬†(response)¬†{ |
| [1898](#L1898) | var¬†link¬†=¬†document.createElement('a'); |
| [1899](#L1899) | document.body.appendChild(link); |
| [1900](#L1900) | link.download¬†=¬†'All Tasks.csv'; |
| [1901](#L1901) | link.href¬†=¬†response; |
| [1902](#L1902) | link.click(); |
| [1903](#L1903) | }); |
| [1904](#L1904) | }); |
| [1905](#L1905) |  |
| [1906](#L1906) | // Print a task |
| [1907](#L1907) | $('body').on('click',¬†'#zpm\_print\_task',¬†function¬†()¬†{ |
| [1908](#L1908) | setTimeout(function¬†()¬†{ |
| [1909](#L1909) | var¬†$printContainer¬†=¬†$('body').find('#zpm\_task\_view\_container'); |
| [1910](#L1910) |  |
| [1911](#L1911) | if¬†($printContainer.length¬†==¬†0)¬†{ |
| [1912](#L1912) | $printContainer¬†=¬†jQuery('body').find('#zpm\_task\_view'); |
| [1913](#L1913) | } |
| [1914](#L1914) |  |
| [1915](#L1915) | var¬†printContents¬†=¬†$printContainer.html(); |
| [1916](#L1916) | var¬†originalContents¬†=¬†document.body.innerHTML; |
| [1917](#L1917) | document.body.innerHTML¬†=¬†printContents; |
| [1918](#L1918) | window.print(); |
| [1919](#L1919) | document.body.innerHTML¬†=¬†originalContents; |
| [1920](#L1920) | },¬†500); |
| [1921](#L1921) | }); |
| [1922](#L1922) |  |
| [1923](#L1923) | $('body').on('click',¬†'.zpm\_custom\_dropdown',¬†function¬†()¬†{ |
| [1924](#L1924) | var¬†dropdown¬†=¬†$(this).data('dropdown-id'); |
| [1925](#L1925) | $(this).toggleClass('active'); |
| [1926](#L1926) | $(this).find('#'¬†+¬†dropdown).toggleClass('active'); |
| [1927](#L1927) | }); |
| [1928](#L1928) |  |
| [1929](#L1929) | // Filter Tasks |
| [1930](#L1930) | // $('body').on('click', '#zpm\_filter\_tasks .zpm\_selection\_option, #zpm-tasks-filter-nav .zpm\_selection\_option', function () { |
| [1931](#L1931) | //¬† ¬† ¬† var filter = $(this).data('zpm-filter'); |
| [1932](#L1932) | //¬† ¬† ¬† var option = $(this).html(); |
| [1933](#L1933) | //¬† ¬† ¬† var user\_id = '-1'; |
| [1934](#L1934) | //¬† ¬† ¬† if (filter == '0') { |
| [1935](#L1935) | //¬† ¬† ¬† ¬† ¬† ¬† ¬† user\_id = $(this).data('user-id'); |
| [1936](#L1936) | //¬† ¬† ¬† } |
| [1937](#L1937) | //¬† ¬† ¬† if (typeof filter == 'undefined') { |
| [1938](#L1938) | //¬† ¬† ¬† ¬† ¬† ¬† ¬† return; |
| [1939](#L1939) | //¬† ¬† ¬† } |
| [1940](#L1940) |  |
| [1941](#L1941) | //¬† ¬† ¬† $(this).closest('.zpm\_custom\_dropdown').find('.zpm\_selected\_option').html(option); |
| [1942](#L1942) | //¬† ¬† ¬† zpm\_loader\_modal(zpm\_localized.strings.loading\_tasks); |
| [1943](#L1943) |  |
| [1944](#L1944) | //¬† ¬† ¬† var data = { |
| [1945](#L1945) | //¬† ¬† ¬† ¬† ¬† ¬† ¬† zpm\_filter: filter, |
| [1946](#L1946) | //¬† ¬† ¬† ¬† ¬† ¬† ¬† zpm\_user\_id: user\_id |
| [1947](#L1947) | //¬† ¬† ¬† }; |
| [1948](#L1948) |  |
| [1949](#L1949) | //¬† ¬† ¬† ZephyrProjects.filter\_tasks(data, function (response) { |
| [1950](#L1950) | //¬† ¬† ¬† ¬† ¬† ¬† ¬† $('body').find('.zpm\_task\_list').html(response.html); |
| [1951](#L1951) | //¬† ¬† ¬† ¬† ¬† ¬† ¬† zpm\_close\_loader\_modal(); |
| [1952](#L1952) | //¬† ¬† ¬† }); |
| [1953](#L1953) | // }); |
| [1954](#L1954) |  |
| [1955](#L1955) | // Filter Projects |
| [1956](#L1956) | $('body').on('click',¬†'#zpm\_filter\_projects .zpm\_selection\_option',¬†function¬†()¬†{ |
| [1957](#L1957) | var¬†filter¬†=¬†$(this).data('zpm-filter'); |
| [1958](#L1958) | var¬†option¬†=¬†$(this).html(); |
| [1959](#L1959) | var¬†user\_id¬†=¬†zpm\_localized.user\_id; |
| [1960](#L1960) | var¬†data¬†=¬†{ |
| [1961](#L1961) | zpm\_filter:¬†filter, |
| [1962](#L1962) | zpm\_user\_id:¬†user\_id |
| [1963](#L1963) | }; |
| [1964](#L1964) |  |
| [1965](#L1965) | if¬†(typeof¬†filter¬†==¬†"undefined")¬†{ |
| [1966](#L1966) | // Filter projects by category |
| [1967](#L1967) | filter¬†=¬†$(this).data('zpm-category-filter'); |
| [1968](#L1968) | data.filter\_category¬†=¬†filter; |
| [1969](#L1969) | option¬†=¬†zpm\_localized.strings.category¬†+¬†": "¬†+¬†option; |
| [1970](#L1970) | }¬†else¬†{ |
| [1971](#L1971) |  |
| [1972](#L1972) | } |
| [1973](#L1973) |  |
| [1974](#L1974) | $('#zpm-project-filter-title').html(option); |
| [1975](#L1975) |  |
| [1976](#L1976) | ZephyrProjects.filter\_projects(data,¬†function¬†(response)¬†{ |
| [1977](#L1977) | $('body').find('.zpm\_project\_grid').html(response.html); |
| [1978](#L1978) | //zpm\_close\_loader\_modal(); |
| [1979](#L1979) | $('.zpm\_project\_progress\_bar').each(function¬†()¬†{ |
| [1980](#L1980) | var¬†total\_tasks¬†=¬†$(this).data('total\_tasks'); |
| [1981](#L1981) | var¬†completed\_tasks¬†=¬†$(this).data('completed\_tasks'); |
| [1982](#L1982) | var¬†width¬†=¬†(total\_tasks¬†!==¬†0)¬†?¬†((completed\_tasks¬†/¬†total\_tasks)¬†\*¬†100)¬†:¬†0; |
| [1983](#L1983) | $(this).css('width',¬†width¬†+¬†'%'); |
| [1984](#L1984) | }); |
| [1985](#L1985) | }); |
| [1986](#L1986) | }); |
| [1987](#L1987) |  |
| [1988](#L1988) | $('body').on('click',¬†'#zpm\_filter\_tasks\_icon',¬†function¬†()¬†{ |
| [1989](#L1989) | var¬†dropdown¬†=¬†$(this).data('dropdown-id'); |
| [1990](#L1990) | $('#zpm\_filter\_tasks').toggleClass('active'); |
| [1991](#L1991) | $('body').find('#'¬†+¬†dropdown).toggleClass('active'); |
| [1992](#L1992) | }); |
| [1993](#L1993) |  |
| [1994](#L1994) | // Import tasks via CSV or JSON |
| [1995](#L1995) | function¬†zpm\_import\_tasks(attachment)¬†{ |
| [1996](#L1996) | if¬†(attachment.mime¬†==¬†'text/csv')¬†{ |
| [1997](#L1997) | ZephyrProjects.close\_modal(); |
| [1998](#L1998) | zpmNewModal(zpm\_localized.strings.import\_tasks,¬†zpm\_localized.strings.importing\_via\_csv,¬†'<div id="zpm\_csv\_task\_import\_data"></div>',¬†'<button data-zpm-trigger="close\_modal" class="zpm\_button zpm\_button\_borderless" id="zpm\_import\_csv\_data\_btn">'¬†+¬†zpm\_localized.strings.close¬†+¬†'</button>',¬†'zpm\_import\_csv\_data\_modal'); |
| [1999](#L1999) | ZephyrProjects.open\_modal('zpm\_import\_csv\_data\_modal'); |
| [2000](#L2000) |  |
| [2001](#L2001) | var¬†data¬†=¬†{ |
| [2002](#L2002) | zpm\_file:¬†attachment.url, |
| [2003](#L2003) | zpm\_import\_via:¬†'csv' |
| [2004](#L2004) | }; |
| [2005](#L2005) |  |
| [2006](#L2006) | ZephyrProjects.upload\_tasks(data,¬†function¬†(response)¬†{ |
| [2007](#L2007) | var¬†length¬†=¬†(response.tasks.length¬†-¬†1); |
| [2008](#L2008) | var¬†output¬†=¬†'<h5>'¬†+¬†zpm\_localized.strings.importing¬†+¬†' '¬†+¬†length¬†+¬†' '¬†+¬†zpm\_localized.strings.tasks¬†+¬†':</h5><ul id="zpm\_csv\_task\_list">'; |
| [2009](#L2009) | for¬†(var¬†i¬†=¬†1;¬†i¬†<¬†response.tasks.length;¬†i++)¬†{ |
| [2010](#L2010) | var¬†uploaded¬†=¬†(response.tasks[i].already\_uploaded)¬†?¬†'zpm\_task\_exists'¬†:¬†''; |
| [2011](#L2011) | var¬†task\_exists¬†=¬†(response.tasks[i].already\_uploaded)¬†?¬†zpm\_localized.strings.task\_exists¬†+¬†': '¬†:¬†''; |
| [2012](#L2012) | output¬†=¬†output¬†+¬†'<li¬† class="zpm\_imported\_task '¬†+¬†uploaded¬†+¬†'">'¬†+¬†task\_exists¬†+¬†response.tasks[i].name¬†+¬†' '¬†+¬†response.tasks[i].description¬†+¬†' ('¬†+¬†response.tasks[i].project¬†+¬†')</li>'; |
| [2013](#L2013) | } |
| [2014](#L2014) | output¬†=¬†output¬†+¬†'</ul>'; |
| [2015](#L2015) | $('body').find('#zpm\_csv\_task\_import\_data').html(output); |
| [2016](#L2016) | $('.zpm\_task\_list').append(response.html); |
| [2017](#L2017) | }); |
| [2018](#L2018) |  |
| [2019](#L2019) | }¬†else¬†if¬†(attachment.mime¬†==¬†'application/json')¬†{ |
| [2020](#L2020) | ZephyrProjects.close\_modal(); |
| [2021](#L2021) | zpmNewModal(zpm\_localized.strings.import\_tasks,¬†zpm\_localized.strings.importing\_via\_json,¬†'<div id="zpm\_json\_task\_import\_data"></div>',¬†'<button data-zpm-trigger="close\_modal" class="zpm\_button zpm\_button\_borderless" id="zpm\_import\_json\_data\_btn">'¬†+¬†zpm\_localized.strings.close¬†+¬†'</button>',¬†'zpm\_import\_json\_data\_modal'); |
| [2022](#L2022) | ZephyrProjects.open\_modal('zpm\_import\_json\_data\_modal'); |
| [2023](#L2023) |  |
| [2024](#L2024) | var¬†data¬†=¬†{ |
| [2025](#L2025) | zpm\_file:¬†attachment.url, |
| [2026](#L2026) | zpm\_import\_via:¬†'json' |
| [2027](#L2027) | }; |
| [2028](#L2028) |  |
| [2029](#L2029) | ZephyrProjects.upload\_tasks(data,¬†function¬†(response)¬†{ |
| [2030](#L2030) | var¬†length¬†=¬†(response.tasks.length¬†-¬†1); |
| [2031](#L2031) | var¬†output¬†=¬†'<h5>'¬†+¬†zpm\_localized.strings.importing¬†+¬†' '¬†+¬†length¬†+¬†' '¬†+¬†zpm\_localized.strings.tasks¬†+¬†':</h5><ul id="zpm\_json\_task\_list">'; |
| [2032](#L2032) | for¬†(var¬†i¬†=¬†0;¬†i¬†<¬†response.tasks.length;¬†i++)¬†{ |
| [2033](#L2033) | var¬†uploaded¬†=¬†(response.tasks[i].already\_uploaded)¬†?¬†'zpm\_task\_exists'¬†:¬†''; |
| [2034](#L2034) | var¬†task\_exists¬†=¬†(response.tasks[i].already\_uploaded)¬†?¬†zpm\_localized.strings.task\_exists¬†+¬†': '¬†:¬†''; |
| [2035](#L2035) | output¬†=¬†output¬†+¬†'<li class="zpm\_imported\_task '¬†+¬†uploaded¬†+¬†'">'¬†+¬†task\_exists¬†+¬†response.tasks[i].name¬†+¬†' '¬†+¬†response.tasks[i].description¬†+¬†' ('¬†+¬†response.tasks[i].project¬†+¬†')</li>'; |
| [2036](#L2036) | } |
| [2037](#L2037) | output¬†=¬†output¬†+¬†'</ul>'; |
| [2038](#L2038) | $('body').find('#zpm\_json\_task\_import\_data').html(output); |
| [2039](#L2039) | $('.zpm\_task\_list').append(response.html); |
| [2040](#L2040) | }); |
| [2041](#L2041) | }¬†else¬†{ |
| [2042](#L2042) | alert(zpm\_localized.strings.incorrect\_import); |
| [2043](#L2043) | } |
| [2044](#L2044) | } |
| [2045](#L2045) |  |
| [2046](#L2046) | // Hide admin sidebar |
| [2047](#L2047) | $('body').on('click',¬†'#zpm\_hide\_wp\_adminbar',¬†function¬†()¬†{ |
| [2048](#L2048) | $(document).find('body.wp-admin').toggleClass('folded'); |
| [2049](#L2049) | $(this).toggleClass('folded'); |
| [2050](#L2050) | }); |
| [2051](#L2051) |  |
| [2052](#L2052) | // Save project settings |
| [2053](#L2053) | $('body').on('click',¬†'#zpm\_project\_save\_settings',¬†function¬†()¬†{ |
| [2054](#L2054) | var¬†form¬†=¬†$(this).closest('.zpm-form'); |
| [2055](#L2055) | var¬†id¬†=¬†$(this).closest('#zpm\_project\_editor').data('project-id'); |
| [2056](#L2056) | var¬†name¬†=¬†$('body').find('#zpm\_edit\_project\_name').val(); |
| [2057](#L2057) | var¬†description¬†=¬†$('body').find('#zpm\_edit\_project\_description').val(); |
| [2058](#L2058) | var¬†due\_date¬†=¬†$('body').find('#zpm\_edit\_project\_due\_date').val(); |
| [2059](#L2059) | var¬†start\_date¬†=¬†$('body').find('#zpm\_edit\_project\_start\_date').val(); |
| [2060](#L2060) | var¬†priority¬†=¬†$('body').find('#zpm-edit-project-priority-value').val(); |
| [2061](#L2061) | var¬†status¬†=¬†$('body').find('#zpm-edit-project\_\_status').val(); |
| [2062](#L2062) | var¬†categories¬†=¬†$('body').find('#zpm-edit-project\_\_categories').val(); |
| [2063](#L2063) | var¬†custom\_fields¬†=¬†[]; |
| [2064](#L2064) |  |
| [2065](#L2065) | $(this).html('Saving...'); |
| [2066](#L2066) |  |
| [2067](#L2067) | $('body').find('#zpm\_task\_edit\_custom\_fields .zpm\_task\_custom\_field').each(function¬†()¬†{ |
| [2068](#L2068) | var¬†id¬†=¬†$(this).data('zpm-cf-id'); |
| [2069](#L2069) | var¬†type¬†=¬†$(this).data('zpm-cf-type'); |
| [2070](#L2070) | var¬†value¬†=¬†$(this).val(); |
| [2071](#L2071) |  |
| [2072](#L2072) | if¬†(type¬†==¬†"checkbox")¬†{ |
| [2073](#L2073) | var¬†value¬†=¬†$(this).is(':checked'); |
| [2074](#L2074) | } |
| [2075](#L2075) |  |
| [2076](#L2076) | if¬†(type¬†==¬†'rating')¬†{ |
| [2077](#L2077) | value¬†=¬†$(this).find('.zpm-rating-field\_\_value').val(); |
| [2078](#L2078) | } |
| [2079](#L2079) |  |
| [2080](#L2080) | if¬†(type¬†==¬†'multiple-choice')¬†{ |
| [2081](#L2081) | value¬†=¬†$(this).find('input:checked').val(); |
| [2082](#L2082) | } |
| [2083](#L2083) |  |
| [2084](#L2084) | custom\_fields.push({ |
| [2085](#L2085) | id:¬†id, |
| [2086](#L2086) | value:¬†value |
| [2087](#L2087) | }); |
| [2088](#L2088) | }); |
| [2089](#L2089) |  |
| [2090](#L2090) | $('#zpm\_edit\_project\_description').mentionsInput('val',¬†function¬†(text)¬†{ |
| [2091](#L2091) | var¬†description¬†=¬†$.trim(text); |
| [2092](#L2092) | var¬†data¬†=¬†{ |
| [2093](#L2093) | project\_id:¬†id, |
| [2094](#L2094) | project\_name:¬†name, |
| [2095](#L2095) | project\_description:¬†description, |
| [2096](#L2096) | project\_due\_date:¬†ZephyrProjects.getDate(due\_date), |
| [2097](#L2097) | project\_start\_date:¬†ZephyrProjects.getDate(start\_date), |
| [2098](#L2098) | project\_categories:¬†categories, |
| [2099](#L2099) | priority:¬†priority, |
| [2100](#L2100) | custom\_fields:¬†custom\_fields, |
| [2101](#L2101) | status:¬†status |
| [2102](#L2102) | }; |
| [2103](#L2103) |  |
| [2104](#L2104) | form.find('[data-ajax-name]').each(function¬†()¬†{ |
| [2105](#L2105) | var¬†name¬†=¬†jQuery(this).data('ajax-name'); |
| [2106](#L2106) | var¬†value¬†=¬†jQuery(this).val(); |
| [2107](#L2107) | data[name]¬†=¬†value; |
| [2108](#L2108) | }); |
| [2109](#L2109) |  |
| [2110](#L2110) | var¬†assigneeSelect¬†=¬†$('body').find('#zpm-edit-project\_\_assignee'); |
| [2111](#L2111) | if¬†(assigneeSelect.length¬†>¬†0)¬†{ |
| [2112](#L2112) | data.assignees¬†=¬†assigneeSelect.val(); |
| [2113](#L2113) | } |
| [2114](#L2114) |  |
| [2115](#L2115) | ZPM\_Manager.update\_project(data,¬†function¬†(response)¬†{ |
| [2116](#L2116) | var¬†background¬†=¬†jQuery('#zpm-edit-project-priority').css('background-color'); |
| [2117](#L2117) | var¬†text\_color¬†=¬†"#fff"; |
| [2118](#L2118) |  |
| [2119](#L2119) | if¬†(priority¬†==¬†""¬†||¬†priority¬†==¬†"priority\_none")¬†{ |
| [2120](#L2120) | $('#zpm-project-edit-priority-label').addClass('zpm-label-hidden'); |
| [2121](#L2121) | text\_color¬†=¬†"#333"; |
| [2122](#L2122) | }¬†else¬†{ |
| [2123](#L2123) | $('#zpm-project-edit-priority-label').removeClass('zpm-label-hidden'); |
| [2124](#L2124) | } |
| [2125](#L2125) |  |
| [2126](#L2126) | $('#zpm-project-edit-priority-label').removeClass('priority\_high').removeClass('priority\_low').removeClass('priority\_medium').removeClass('priority\_critical').addClass(priority).text($('.zpm-edit-project-priority[data-value="'¬†+¬†priority¬†+¬†'"]').text()); |
| [2127](#L2127) | $('#zpm-project-edit-priority-label').attr('style',¬†'background: '¬†+¬†background¬†+¬†' !important; color: '¬†+¬†text\_color¬†+¬†' !important;'); |
| [2128](#L2128) |  |
| [2129](#L2129) | $('#zpm\_project\_name\_title').html(name); |
| [2130](#L2130) | $('#zpm\_project\_save\_settings').html(zpm\_localized.strings.save\_changes); |
| [2131](#L2131) | }); |
| [2132](#L2132) | }); |
| [2133](#L2133) | // ZephyrProjects.update\_project(data, function(response){ |
| [2134](#L2134) | //¬† ¬† ¬† var background = jQuery('#zpm-edit-project-priority').css('background-color'); |
| [2135](#L2135) | //¬† ¬† ¬† var text\_color = "#fff"; |
| [2136](#L2136) |  |
| [2137](#L2137) | //¬† ¬† ¬† if (priority == "" || priority == "priority\_none") { |
| [2138](#L2138) | //¬† ¬† ¬† ¬† ¬† ¬† ¬† $('#zpm-project-edit-priority-label').addClass('zpm-label-hidden'); |
| [2139](#L2139) | //¬† ¬† ¬† ¬† ¬† ¬† ¬† text\_color = "#333"; |
| [2140](#L2140) | //¬† ¬† ¬† } else { |
| [2141](#L2141) | //¬† ¬† ¬† ¬† ¬† ¬† ¬† $('#zpm-project-edit-priority-label').removeClass('zpm-label-hidden'); |
| [2142](#L2142) | //¬† ¬† ¬† } |
| [2143](#L2143) |  |
| [2144](#L2144) | //¬† ¬† ¬† $('#zpm-project-edit-priority-label').removeClass('priority\_high').removeClass('priority\_low').removeClass('priority\_medium').removeClass('priority\_critical').addClass(priority).text($('.zpm-edit-project-priority[data-value="' + priority + '"]').text()); |
| [2145](#L2145) | //¬† ¬† ¬† $('#zpm-project-edit-priority-label').attr('style', 'background: ' + background + ' !important; color: ' + text\_color + ' !important;'); |
| [2146](#L2146) |  |
| [2147](#L2147) | //¬† ¬† ¬† $('#zpm\_project\_name\_title').html( name ); |
| [2148](#L2148) | //¬† ¬† ¬† $('#zpm\_project\_save\_settings').html( zpm\_localized.strings.save\_changes ); |
| [2149](#L2149) |  |
| [2150](#L2150) |  |
| [2151](#L2151) | // }); |
| [2152](#L2152) | }); |
| [2153](#L2153) |  |
| [2154](#L2154) | // Delete project |
| [2155](#L2155) | $('body').on('click',¬†'#zpm\_delete\_project',¬†function¬†()¬†{ |
| [2156](#L2156) | if¬†(confirm(zpm\_localized.strings.delete\_project\_notice))¬†{ |
| [2157](#L2157) | $(this).closest('.zpm\_project\_grid\_cell').remove(); |
| [2158](#L2158) | var¬†project\_id¬†=¬†$(this).closest('.zpm\_project\_item').data('project-id'); |
| [2159](#L2159) | var¬†project\_name¬†=¬†$(this).closest('.zpm\_project\_title').find('.zpm\_project\_grid\_name').text(); |
| [2160](#L2160) |  |
| [2161](#L2161) | ZephyrProjects.delete\_project({ |
| [2162](#L2162) | project\_id:¬†project\_id, |
| [2163](#L2163) | project\_name:¬†project\_name |
| [2164](#L2164) | },¬†function¬†(response)¬†{ |
| [2165](#L2165) | if¬†(response.project\_count¬†==¬†0)¬†{ |
| [2166](#L2166) | $('body').find('#zpm\_project\_manager\_display').addClass('zpm\_hide'); |
| [2167](#L2167) | $('body').find('#zpm\_projects\_holder').append('<div class="zpm\_no\_results\_message">'¬†+¬†zpm\_localized.strings.no\_projects\_created¬†+¬†'</div>'); |
| [2168](#L2168) | } |
| [2169](#L2169) | }); |
| [2170](#L2170) | } |
| [2171](#L2171) | }); |
| [2172](#L2172) |  |
| [2173](#L2173) | // Archive project |
| [2174](#L2174) | $('body').on('click',¬†'#zpm-project-action\_\_archive',¬†function¬†()¬†{ |
| [2175](#L2175) | $(this).closest('.zpm\_project\_grid\_cell').remove(); |
| [2176](#L2176) | var¬†item¬†=¬†$(this).closest('.zpm\_project\_item'); |
| [2177](#L2177) | var¬†project\_id¬†=¬†item.data('project-id'); |
| [2178](#L2178) | var¬†archived¬†=¬†$(this).data('archived'); |
| [2179](#L2179) |  |
| [2180](#L2180) | ZephyrProjects.archiveProject({ |
| [2181](#L2181) | project\_id:¬†project\_id, |
| [2182](#L2182) | archived:¬†archived |
| [2183](#L2183) | },¬†function¬†(response)¬†{ |
| [2184](#L2184) | }); |
| [2185](#L2185) | }); |
| [2186](#L2186) |  |
| [2187](#L2187) | // Like a project |
| [2188](#L2188) | $('body').on('click',¬†'#zpm\_like\_project\_btn',¬†function¬†(e)¬†{ |
| [2189](#L2189) | $(this).toggleClass('zpm\_liked'); |
| [2190](#L2190) | var¬†project\_id¬†=¬†$(this).data('project-id'); |
| [2191](#L2191) | var¬†data¬†=¬†{ |
| [2192](#L2192) | project\_id:¬†project\_id |
| [2193](#L2193) | }; |
| [2194](#L2194) |  |
| [2195](#L2195) | ZephyrProjects.like\_project(data,¬†function¬†(response)¬†{ |
| [2196](#L2196) |  |
| [2197](#L2197) | }); |
| [2198](#L2198) | }); |
| [2199](#L2199) |  |
| [2200](#L2200) | // Export all projects |
| [2201](#L2201) | $('body').on('click',¬†'.zpm-export-projects\_\_btn, [data-export-projects-csv]',¬†function¬†()¬†{ |
| [2202](#L2202) | ZephyrProjects.ajax({ |
| [2203](#L2203) | action:¬†'zpm\_exportProjectsToCSV' |
| [2204](#L2204) | },¬†function¬†(response)¬†{ |
| [2205](#L2205) | var¬†link¬†=¬†document.createElement('a'); |
| [2206](#L2206) | document.body.appendChild(link); |
| [2207](#L2207) | link.download¬†=¬†'ZPM Projects.csv'; |
| [2208](#L2208) | link.href¬†=¬†response; |
| [2209](#L2209) | link.click(); |
| [2210](#L2210) | ZephyrProjects.deleteTempFiles(); |
| [2211](#L2211) | }); |
| [2212](#L2212) | }); |
| [2213](#L2213) |  |
| [2214](#L2214) | // Export all tasks |
| [2215](#L2215) | $('body').on('click',¬†'.zpm-export-tasks\_\_btn, [data-export-tasks-csv]',¬†function¬†()¬†{ |
| [2216](#L2216) | ZephyrProjects.modal('task-export-modal',¬†ZephyrProjects.getTemplate('taskExportModal'),¬†true); |
| [2217](#L2217) | }); |
| [2218](#L2218) |  |
| [2219](#L2219) | // Export Project to CSV |
| [2220](#L2220) | $('body').on('click',¬†'#zpm\_export\_project\_to\_csv',¬†function¬†()¬†{ |
| [2221](#L2221) | var¬†project\_id¬†=¬†$(this).closest('.zpm\_project\_item').data('project-id'); |
| [2222](#L2222) | var¬†project\_name¬†=¬†$(this).closest('.zpm\_project\_item').find('.zpm\_project\_grid\_name').html(); |
| [2223](#L2223) | project\_name¬†=¬†jQuery.trim(project\_name); |
| [2224](#L2224) |  |
| [2225](#L2225) | var¬†data¬†=¬†{ |
| [2226](#L2226) | project\_id:¬†project\_id, |
| [2227](#L2227) | project\_name:¬†project\_name, |
| [2228](#L2228) | export\_to:¬†'csv' |
| [2229](#L2229) | }; |
| [2230](#L2230) |  |
| [2231](#L2231) | ZephyrProjects.export\_project(data,¬†function¬†(response)¬†{ |
| [2232](#L2232) | var¬†link¬†=¬†document.createElement('a'); |
| [2233](#L2233) | document.body.appendChild(link); |
| [2234](#L2234) | link.download¬†=¬†'Project - '¬†+¬†$.trim(project\_name)¬†+¬†'.csv'; |
| [2235](#L2235) | link.href¬†=¬†response.project\_csv; |
| [2236](#L2236) | link.click(); |
| [2237](#L2237) |  |
| [2238](#L2238) | var¬†link\_tasks¬†=¬†document.createElement('a'); |
| [2239](#L2239) | document.body.appendChild(link\_tasks); |
| [2240](#L2240) | link\_tasks.download¬†=¬†$.trim(project\_name)¬†+¬†' - Tasks.csv'; |
| [2241](#L2241) | link\_tasks.href¬†=¬†response.project\_tasks\_csv; |
| [2242](#L2242) | link\_tasks.click(); |
| [2243](#L2243) | }); |
| [2244](#L2244) | }); |
| [2245](#L2245) |  |
| [2246](#L2246) | // Export Project to JSON |
| [2247](#L2247) | $('body').on('click',¬†'#zpm\_export\_project\_to\_json',¬†function¬†()¬†{ |
| [2248](#L2248) | var¬†project\_id¬†=¬†$(this).closest('.zpm\_project\_item').data('project-id'); |
| [2249](#L2249) | var¬†project\_name¬†=¬†$(this).closest('.zpm\_project\_item').find('.zpm\_project\_grid\_name').html(); |
| [2250](#L2250) | var¬†data¬†=¬†{ |
| [2251](#L2251) | project\_id:¬†project\_id, |
| [2252](#L2252) | project\_name:¬†project\_name, |
| [2253](#L2253) | export\_to:¬†'json' |
| [2254](#L2254) | }; |
| [2255](#L2255) |  |
| [2256](#L2256) | ZephyrProjects.export\_project(data,¬†function¬†(response)¬†{ |
| [2257](#L2257) | var¬†link¬†=¬†document.createElement('a'); |
| [2258](#L2258) | document.body.appendChild(link); |
| [2259](#L2259) | link.download¬†=¬†response.file\_name; |
| [2260](#L2260) | link.href¬†=¬†response.file\_url; |
| [2261](#L2261) | jQuery(link).attr('target',¬†'\_BLANK'); |
| [2262](#L2262) | link.click(); |
| [2263](#L2263) | }); |
| [2264](#L2264) |  |
| [2265](#L2265) | }); |
| [2266](#L2266) |  |
| [2267](#L2267) | // Print a Project |
| [2268](#L2268) | $('body').on('click',¬†'#zpm\_print\_project',¬†function¬†()¬†{ |
| [2269](#L2269) | var¬†project\_id¬†=¬†$(this).closest('.zpm\_project\_item').data('project-id'); |
| [2270](#L2270) | var¬†data¬†=¬†{ |
| [2271](#L2271) | project\_id:¬†project\_id |
| [2272](#L2272) | }; |
| [2273](#L2273) |  |
| [2274](#L2274) | ZephyrProjects.print\_project(data,¬†function¬†(response)¬†{ |
| [2275](#L2275) |  |
| [2276](#L2276) | }); |
| [2277](#L2277) | }); |
| [2278](#L2278) |  |
| [2279](#L2279) | // Custom Fancy Modal |
| [2280](#L2280) | $('body').on('click',¬†'[data-zpm-dropdown-toggle]',¬†function¬†()¬†{ |
| [2281](#L2281) | var¬†target¬†=¬†$(this).data('zpm-dropdown-toggle'); |
| [2282](#L2282) | $('body').find('#'¬†+¬†target).toggleClass('active'); |
| [2283](#L2283) | }); |
| [2284](#L2284) |  |
| [2285](#L2285) | /\* Comments and Conversations \*/ |
| [2286](#L2286) | // Send task comment |
| [2287](#L2287) | $('body').on('click',¬†'#zpm\_task\_chat\_comment',¬†function¬†()¬†{ |
| [2288](#L2288) | var¬†task\_id¬†=¬†$(this).data('task-id'); |
| [2289](#L2289) | const¬†$btn¬†=¬†jQuery(this); |
| [2290](#L2290) | const¬†originalText¬†=¬†$btn.data('text'); |
| [2291](#L2291) | const¬†loadingText¬†=¬†$btn.data('loading-text'); |
| [2292](#L2292) |  |
| [2293](#L2293) | if¬†(typeof¬†loadingText¬†!==¬†'undefined')¬†{ |
| [2294](#L2294) | $btn.text(loadingText); |
| [2295](#L2295) | } |
| [2296](#L2296) |  |
| [2297](#L2297) | // $('#zpm\_chat\_message').mentionsInput('val', function (text) { |
| [2298](#L2298) | //¬† ¬† ¬† var message = $.trim(text); |
| [2299](#L2299) | //¬† ¬† ¬† message = message.replace(/\<div><br><\/div>/g, ''); |
| [2300](#L2300) | //¬† ¬† ¬† send\_message('task', task\_id, message, function() { |
| [2301](#L2301) | //¬† ¬† ¬† ¬† ¬† ¬† ¬† if (typeof originalText !== 'undefined') { |
| [2302](#L2302) | //¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† $btn.text(originalText); |
| [2303](#L2303) | //¬† ¬† ¬† ¬† ¬† ¬† ¬† } |
| [2304](#L2304) | //¬† ¬† ¬† }); |
| [2305](#L2305) | //¬† ¬† ¬† $('#zpm\_chat\_message').mentionsInput('reset'); |
| [2306](#L2306) | // }); |
| [2307](#L2307) |  |
| [2308](#L2308) | const¬†message¬†=¬†ZephyrProjects.getVal($('#zpm\_chat\_message')); |
| [2309](#L2309) | send\_message('task',¬†task\_id,¬†message,¬†function()¬†{ |
| [2310](#L2310) | if¬†(typeof¬†originalText¬†!==¬†'undefined')¬†{ |
| [2311](#L2311) | $btn.text(originalText); |
| [2312](#L2312) | } |
| [2313](#L2313) | }); |
| [2314](#L2314) | }); |
| [2315](#L2315) |  |
| [2316](#L2316) | // Send project comment |
| [2317](#L2317) | $('body').on('click',¬†'#zpm\_project\_chat\_comment',¬†function¬†()¬†{ |
| [2318](#L2318) | var¬†project\_id¬†=¬†$(this).data('project-id'); |
| [2319](#L2319) | // $('#zpm\_chat\_message').mentionsInput('val', function (text) { |
| [2320](#L2320) | //¬† ¬† ¬† var message = $.trim(text); |
| [2321](#L2321) | //¬† ¬† ¬† message = message.replace(/\<div><br><\/div>/g, ''); |
| [2322](#L2322) | //¬† ¬† ¬† send\_message('project', project\_id, message); |
| [2323](#L2323) | //¬† ¬† ¬† $('#zpm\_chat\_message').mentionsInput('reset'); |
| [2324](#L2324) | // }); |
| [2325](#L2325) | const¬†$btn¬†=¬†jQuery(this); |
| [2326](#L2326) | $btn.text(zpm\_localized.strings.sending); |
| [2327](#L2327) |  |
| [2328](#L2328) | const¬†message¬†=¬†ZephyrProjects.getVal($('#zpm\_chat\_message')); |
| [2329](#L2329) | send\_message('project',¬†project\_id,¬†message,¬†function()¬†{ |
| [2330](#L2330) | $btn.text(zpm\_localized.strings.comment); |
| [2331](#L2331) | }); |
| [2332](#L2332) | // var message = $.trim($('body').find('#zpm\_chat\_message')[0].innerText); |
| [2333](#L2333) | // message = message.replace(/\<div><br><\/div>/g,''); |
| [2334](#L2334) |  |
| [2335](#L2335) | }); |
| [2336](#L2336) |  |
| [2337](#L2337) | function¬†send\_message(subject,¬†subject\_id,¬†message,¬†callback)¬†{ |
| [2338](#L2338) | var¬†attachments¬†=¬†[]; |
| [2339](#L2339) | $('body').find('.zpm\_comment\_attachment').each(function¬†()¬†{ |
| [2340](#L2340) | var¬†attachment\_id¬†=¬†$(this).data('attachment-id'); |
| [2341](#L2341) | attachments.push({ |
| [2342](#L2342) | attachment\_id:¬†attachment\_id |
| [2343](#L2343) | }); |
| [2344](#L2344) | }); |
| [2345](#L2345) |  |
| [2346](#L2346) | // if ($(this).text() == zpm\_localized.strings.comment) { |
| [2347](#L2347) | //¬† ¬† ¬† $(this).html(zpm\_localized.strings.sending); |
| [2348](#L2348) | // } |
| [2349](#L2349) |  |
| [2350](#L2350) | //$(this).addClass('zpm\_message\_sending'); |
| [2351](#L2351) |  |
| [2352](#L2352) | var¬†data¬†=¬†{ |
| [2353](#L2353) | user\_id:¬†zpm\_localized.user\_id, |
| [2354](#L2354) | subject:¬†subject, |
| [2355](#L2355) | subject\_id:¬†subject\_id, |
| [2356](#L2356) | message:¬†message, |
| [2357](#L2357) | type:¬†'message', |
| [2358](#L2358) | attachments:¬†attachments |
| [2359](#L2359) | }; |
| [2360](#L2360) |  |
| [2361](#L2361) | ZephyrProjects.send\_comment(data,¬†function¬†(response)¬†{ |
| [2362](#L2362) | ZephyrProjects.notification(zpm\_localized.strings.message\_sent); |
| [2363](#L2363) | response.id¬†=¬†subject\_id; |
| [2364](#L2364) | response.user\_id¬†=¬†zpm\_localized.user\_id; |
| [2365](#L2365) | response.subject¬†=¬†subject; |
| [2366](#L2366) | response.type¬†=¬†data.type; |
| [2367](#L2367) | jQuery.event.trigger({¬†type:¬†'zephyr\_new\_message',¬†ndata:¬†response¬†}); |
| [2368](#L2368) |  |
| [2369](#L2369) | if¬†(typeof¬†response.files\_html¬†!==¬†'undefined')¬†{ |
| [2370](#L2370) | jQuery('.zpm-files\_\_container').html(response.files\_html); |
| [2371](#L2371) | } |
| [2372](#L2372) |  |
| [2373](#L2373) | if¬†($('#zpm\_task\_chat\_comment').text()¬†==¬†zpm\_localized.strings.sending)¬†{ |
| [2374](#L2374) | $('#zpm\_task\_chat\_comment').html(zpm\_localized.strings.comment); |
| [2375](#L2375) | } |
| [2376](#L2376) |  |
| [2377](#L2377) | $('#zpm\_task\_chat\_comment').removeClass('zpm\_message\_sending'); |
| [2378](#L2378) | $('body').find('.zpm\_task\_comments').prepend(response.html); |
| [2379](#L2379) | var¬†newComment¬†=¬†$('body').find('.zpm\_comment\_content').first(); |
| [2380](#L2380) | newComment.html(ZephyrProjects.linkify(newComment.html())); |
| [2381](#L2381) | $('body').find('#zpm\_chat\_message').html(''); |
| [2382](#L2382) | $('#zpm\_chat\_attachments').html(''); |
| [2383](#L2383) | ZephyrProjects.scrollTo('html',¬†'.zpm\_task\_comments',¬†-100); |
| [2384](#L2384) |  |
| [2385](#L2385) | if¬†(typeof¬†callback¬†!==¬†'undefined')¬†{ |
| [2386](#L2386) | callback(response); |
| [2387](#L2387) | } |
| [2388](#L2388) | }); |
| [2389](#L2389) | } |
| [2390](#L2390) |  |
| [2391](#L2391) | /\* Upload Task File \*/ |
| [2392](#L2392) | var¬†zpm\_file\_uploader; |
| [2393](#L2393) |  |
| [2394](#L2394) | $('body').on('click',¬†'#zpm\_task\_chat\_files, #zpm\_project\_chat\_files',¬†function¬†()¬†{ |
| [2395](#L2395) | ZephyrProjects.upload\_file(zpm\_file\_uploader,¬†function¬†(res)¬†{ |
| [2396](#L2396) | var¬†attachments¬†=¬†res; |
| [2397](#L2397) |  |
| [2398](#L2398) | for¬†(var¬†i¬†=¬†0;¬†i¬†<¬†attachments.length;¬†++i)¬†{ |
| [2399](#L2399) | var¬†attachment\_holder¬†=¬†$('body').find('#zpm\_chat\_attachments'); |
| [2400](#L2400) | attachment\_holder.append('<span data-attachment-id="'¬†+¬†attachments[i].id¬†+¬†'" class="zpm\_comment\_attachment">'¬†+¬†attachments[i].attributes.url¬†+¬†'<span class="zpm\_remove\_attachment lnr lnr-cross"></span></span>'); |
| [2401](#L2401) | } |
| [2402](#L2402) | },¬†true); |
| [2403](#L2403) | }); |
| [2404](#L2404) |  |
| [2405](#L2405) | /\* Upload a general file from the Files page \*/ |
| [2406](#L2406) | var¬†file\_uploader; |
| [2407](#L2407) | $('#zpm\_upload\_file\_btn').on('click',¬†function¬†()¬†{ |
| [2408](#L2408) | ZephyrProjects.upload\_file(file\_uploader,¬†function(attachment)¬†{ |
| [2409](#L2409) | var¬†project\_id¬†=¬†$('#zpm-new-file-project-value').val(); |
| [2410](#L2410) | $('#zpm-uploaded-filename').val(attachment.filename); |
| [2411](#L2411) | upload\_attachment(attachment.id,¬†'project',¬†project\_id,¬†attachment.filename,¬†attachment.icon); |
| [2412](#L2412) | $(this).closest('.zpm\_modal\_footer').find('#zpm\_submit\_file').removeClass('inactive'); |
| [2413](#L2413) | },¬†false); |
| [2414](#L2414) | }); |
| [2415](#L2415) |  |
| [2416](#L2416) | /\* Remove a selected attachment \*/ |
| [2417](#L2417) | $('body').on('click',¬†'.zpm\_remove\_attachment',¬†function¬†()¬†{ |
| [2418](#L2418) | $(this).closest('.zpm\_comment\_attachment').remove(); |
| [2419](#L2419) | }); |
| [2420](#L2420) |  |
| [2421](#L2421) | /\* Delete a comment \*/ |
| [2422](#L2422) | $('body').on('click',¬†'.zpm\_delete\_comment',¬†function¬†()¬†{ |
| [2423](#L2423) | var¬†comment¬†=¬†$(this).closest('.zpm\_comment'); |
| [2424](#L2424) | var¬†comment\_id¬†=¬†comment.data('zpm-comment-id'); |
| [2425](#L2425) | comment.remove(); |
| [2426](#L2426) |  |
| [2427](#L2427) | var¬†data¬†=¬†{ |
| [2428](#L2428) | comment\_id:¬†comment\_id |
| [2429](#L2429) | }; |
| [2430](#L2430) |  |
| [2431](#L2431) | ZephyrProjects.remove\_comment(data,¬†function¬†()¬†{ |
| [2432](#L2432) | ZephyrProjects.notification(zpm\_localized.strings.message\_removed); |
| [2433](#L2433) | }); |
| [2434](#L2434) |  |
| [2435](#L2435) | const¬†$attachments¬†=¬†comment.find('[data-attachment]'); |
| [2436](#L2436) | $attachments.each(function()¬†{ |
| [2437](#L2437) | const¬†attachment¬†=¬†jQuery(this).data('attachment'); |
| [2438](#L2438) |  |
| [2439](#L2439) | jQuery('body').find('[data-file="'¬†+¬†attachment¬†+¬†'"], [data-attachment-id="'¬†+¬†attachment¬†+¬†'"]').remove(); |
| [2440](#L2440) | }); |
| [2441](#L2441) | }); |
| [2442](#L2442) |  |
| [2443](#L2443) | $('body').on('click',¬†'.zpm-edit-message',¬†function¬†()¬†{ |
| [2444](#L2444) | var¬†comment¬†=¬†$(this).closest('.zpm\_comment'); |
| [2445](#L2445) | var¬†comment\_id¬†=¬†comment.data('zpm-comment-id'); |
| [2446](#L2446) | var¬†message¬†=¬†comment.find('.zpm\_comment\_content').html(); |
| [2447](#L2447) | console.log('message',¬†message); |
| [2448](#L2448) | var¬†html¬†=¬†'<input type="hidden" data-ajax-name="message-id" value="'¬†+¬†comment\_id¬†+¬†'" />'¬†+ |
| [2449](#L2449) | '<div class="zpm-contenteditable" contenteditable="true" type="text" data-ajax-name="message">'¬†+¬†message¬†+¬†'</div>'; |
| [2450](#L2450) | ZephyrProjects.zephyrModal(zpm\_localized.strings.edit\_message,¬†html,¬†zpm\_localized.strings.save\_changes,¬†function¬†(modal)¬†{ |
| [2451](#L2451) | var¬†id¬†=¬†modal.find('[data-ajax-name="message-id"]').val(); |
| [2452](#L2452) | var¬†message¬†=¬†modal.find('[data-ajax-name="message"]').html(); |
| [2453](#L2453) |  |
| [2454](#L2454) | comment.find('.zpm\_comment\_content').html(message); |
| [2455](#L2455) | ZephyrProjects.ajax({ |
| [2456](#L2456) | action:¬†'zpm\_updateMessage', |
| [2457](#L2457) | message\_id:¬†id, |
| [2458](#L2458) | message:¬†message |
| [2459](#L2459) | },¬†function¬†(response)¬†{ |
| [2460](#L2460) | }); |
| [2461](#L2461) | },¬†'zpm-edit-message\_\_modal'); |
| [2462](#L2462) | }); |
| [2463](#L2463) |  |
| [2464](#L2464) | function¬†upload\_attachment(attachment\_id,¬†attachment\_type,¬†subject\_id,¬†filename,¬†icon)¬†{ |
| [2465](#L2465) | ZephyrProjects.notification(zpm\_localized.strings.uploading\_file); |
| [2466](#L2466) | var¬†attachment\_type¬†=¬†(typeof¬†attachment\_type¬†!==¬†'undefined')¬†?¬†attachment\_type¬†:¬†''; |
| [2467](#L2467) | var¬†subject\_id¬†=¬†(typeof¬†subject\_id¬†!==¬†'undefined')¬†?¬†subject\_id¬†:¬†''; |
| [2468](#L2468) | const¬†attachment¬†=¬†{ |
| [2469](#L2469) | attachment\_id:¬†attachment\_id, |
| [2470](#L2470) | attachment\_type:¬†attachment\_type, |
| [2471](#L2471) | subject\_id:¬†subject\_id, |
| [2472](#L2472) | icon |
| [2473](#L2473) | }; |
| [2474](#L2474) |  |
| [2475](#L2475) | if¬†(typeof¬†filename¬†!==¬†'undefined')¬†{ |
| [2476](#L2476) | attachment.filename¬†=¬†filename; |
| [2477](#L2477) | } |
| [2478](#L2478) |  |
| [2479](#L2479) | var¬†attachments¬†=¬†[attachment]; |
| [2480](#L2480) | var¬†data¬†=¬†{ |
| [2481](#L2481) | attachments:¬†attachments |
| [2482](#L2482) | }; |
| [2483](#L2483) |  |
| [2484](#L2484) | ZephyrProjects.send\_comment(data,¬†function¬†(response)¬†{ |
| [2485](#L2485) | $('body').find('.zpm\_files\_container').prepend(response.html); |
| [2486](#L2486) | $('#zpm\_no\_files').hide(); |
| [2487](#L2487) | ZephyrProjects.notification(zpm\_localized.strings.file\_uploaded); |
| [2488](#L2488) | }); |
| [2489](#L2489) | } |
| [2490](#L2490) |  |
| [2491](#L2491) | /\* Open the new subtask modal \*/ |
| [2492](#L2492) | $('body').on('click',¬†'#zpm\_add\_new\_subtask',¬†function¬†()¬†{ |
| [2493](#L2493) | const¬†project¬†=¬†jQuery(this).data('project'); |
| [2494](#L2494) | //ZephyrProjects.open\_modal('zpm\_new\_subtask\_modal'); |
| [2495](#L2495) | jQuery.event.trigger({¬†type:¬†'zephyr\_new\_task\_modal\_opened',¬†data:¬†{}¬†}); |
| [2496](#L2496) | ZephyrProjects.open\_modal('zpm\_create\_task'); |
| [2497](#L2497) | var¬†modal¬†=¬†jQuery('body').find('#zpm\_create\_task'); |
| [2498](#L2498) | modal.find('[data-ajax-name="parent-id"]').val(jQuery('body').find('#zpm-task-id').val()).trigger('chosen:updated'); |
| [2499](#L2499) | $('body').find('#zpm-new-task-template-select').trigger('change'); |
| [2500](#L2500) | $('body').find('select#zpm\_new\_task\_project').chosen({ |
| [2501](#L2501) | disable\_search\_threshold:¬†10, |
| [2502](#L2502) | no\_results\_text:¬†zpm\_localized.strings.no\_projects\_found, |
| [2503](#L2503) | width:¬†"100%" |
| [2504](#L2504) | }); |
| [2505](#L2505) | if¬†(typeof¬†project¬†!==¬†'undefined')¬†{ |
| [2506](#L2506) | jQuery('body').find('#zpm\_new\_task\_project').val(project).trigger('chosen:updated'); |
| [2507](#L2507) | } |
| [2508](#L2508) | }); |
| [2509](#L2509) |  |
| [2510](#L2510) | $('body').on('click',¬†'#zpm\_save\_new\_subtask',¬†function¬†()¬†{ |
| [2511](#L2511) | var¬†task\_id¬†=¬†$('body').find('#zpm\_js\_task\_id').val(); |
| [2512](#L2512) | var¬†subtask\_name¬†=¬†$('body').find('#zpm\_new\_subtask\_name').val(); |
| [2513](#L2513) | var¬†description¬†=¬†$('body').find('#zpm-new-subtask\_\_description').val(); |
| [2514](#L2514) | var¬†start¬†=¬†$('body').find('#zpm-new-subtask\_\_start').val(); |
| [2515](#L2515) | var¬†due¬†=¬†$('body').find('#zpm-new-subtask\_\_due').val(); |
| [2516](#L2516) |  |
| [2517](#L2517) | var¬†data¬†=¬†{ |
| [2518](#L2518) | task\_id:¬†task\_id, |
| [2519](#L2519) | subtask\_action:¬†'new\_subtask', |
| [2520](#L2520) | subtask\_name:¬†subtask\_name, |
| [2521](#L2521) | description:¬†description, |
| [2522](#L2522) | start:¬†start, |
| [2523](#L2523) | due:¬†due |
| [2524](#L2524) | }; |
| [2525](#L2525) |  |
| [2526](#L2526) | $('body').find('#zpm\_new\_subtask\_name').val(''); |
| [2527](#L2527) | ZephyrProjects.close\_modal(); |
| [2528](#L2528) | ZephyrProjects.notification(zpm\_localized.strings.creating\_subtask); |
| [2529](#L2529) |  |
| [2530](#L2530) | ZephyrProjects.update\_subtasks(data,¬†function¬†(response)¬†{ |
| [2531](#L2531) | ZephyrProjects.notification(zpm\_localized.strings.subtask\_saved); |
| [2532](#L2532) | var¬†subtask\_list¬†=¬†$('body').find('#zpm-subtask-list'); |
| [2533](#L2533) | subtask\_list.append(response.html); |
| [2534](#L2534) | jQuery('#zpm-no-subtasks').hide(); |
| [2535](#L2535) | }); |
| [2536](#L2536) | }); |
| [2537](#L2537) |  |
| [2538](#L2538) | /\* Delete a subtask from the database \*/ |
| [2539](#L2539) | $('body').on('click',¬†'.zpm\_delete\_subtask',¬†function¬†()¬†{ |
| [2540](#L2540) | $(this).closest('.zpm\_subtask\_item').remove(); |
| [2541](#L2541) | var¬†task\_id¬†=¬†$('body').find('#zpm\_js\_task\_id').val(); |
| [2542](#L2542) | var¬†subtask\_id¬†=¬†$(this).data('zpm-subtask-id'); |
| [2543](#L2543) | var¬†data¬†=¬†{ |
| [2544](#L2544) | subtask\_action:¬†'delete\_subtask', |
| [2545](#L2545) | subtask\_id:¬†subtask\_id |
| [2546](#L2546) | }; |
| [2547](#L2547) |  |
| [2548](#L2548) | ZephyrProjects.update\_subtasks(data,¬†function¬†(response)¬†{ |
| [2549](#L2549) | ZephyrProjects.notification(zpm\_localized.strings.subtask\_deleted); |
| [2550](#L2550) | }); |
| [2551](#L2551) | if¬†($('body').find('.zpm\_subtask\_item').length¬†<=¬†0)¬†{ |
| [2552](#L2552) | jQuery('#zpm-no-subtasks').show(); |
| [2553](#L2553) | } |
| [2554](#L2554) | }); |
| [2555](#L2555) |  |
| [2556](#L2556) | /\* Edit a subtask \*/ |
| [2557](#L2557) | $('body').on('click',¬†'.zpm\_subtask\_item',¬†function¬†(e)¬†{ |
| [2558](#L2558) | // var taskId = $(this).data('zpm-subtask'); |
| [2559](#L2559) | // var target = $(e.target); |
| [2560](#L2560) | // if (target.hasClass('zpm\_subtask\_is\_done') || target.hasClass('zpm\_delete\_subtask') || target.hasClass('zpm-material-checkbox-label') || target.closest('.zpm-modal').length > 0) { |
| [2561](#L2561) |  |
| [2562](#L2562) | // } else { |
| [2563](#L2563) | //¬† ¬† ¬† ZephyrProjects.zephyrAjaxModal({ |
| [2564](#L2564) | //¬† ¬† ¬† ¬† ¬† ¬† ¬† action: 'zpm\_subtaskEditModal', |
| [2565](#L2565) | //¬† ¬† ¬† ¬† ¬† ¬† ¬† id: taskId |
| [2566](#L2566) | //¬† ¬† ¬† }, function(response){ |
| [2567](#L2567) | //¬† ¬† ¬† ¬† ¬† ¬† ¬† var data = {}; |
| [2568](#L2568) | //¬† ¬† ¬† ¬† ¬† ¬† ¬† var modal = response.modal |
| [2569](#L2569) | //¬† ¬† ¬† ¬† ¬† ¬† ¬† data.new\_subtask\_name = modal.find('[data-ajax-name="name"]').val(); |
| [2570](#L2570) | //¬† ¬† ¬† ¬† ¬† ¬† ¬† data.description = modal.find('[data-ajax-name="description"]').val(); |
| [2571](#L2571) | //¬† ¬† ¬† ¬† ¬† ¬† ¬† data.start\_date = modal.find('[data-ajax-name="start-date"]').val(); |
| [2572](#L2572) | //¬† ¬† ¬† ¬† ¬† ¬† ¬† data.due\_date = modal.find('[data-ajax-name="due-date"]').val(); |
| [2573](#L2573) | //¬† ¬† ¬† ¬† ¬† ¬† ¬† data.subtask\_action = 'update\_subtask'; |
| [2574](#L2574) | //¬† ¬† ¬† ¬† ¬† ¬† ¬† data.subtask\_id = taskId; |
| [2575](#L2575) | //¬† ¬† ¬† ¬† ¬† ¬† ¬† data.task\_id = modal.find('[data-ajax-name="parent-id"]').val(); |
| [2576](#L2576) |  |
| [2577](#L2577) | //¬† ¬† ¬† ¬† ¬† ¬† ¬† ZephyrProjects.update\_subtasks(data, function(response){ |
| [2578](#L2578) | //¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ZephyrProjects.notification( zpm\_localized.strings.changes\_saved ); |
| [2579](#L2579) | //¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† $('body').find('[data-zpm-subtask="' + taskId + '"]').replaceWith(response.html); |
| [2580](#L2580) | //¬† ¬† ¬† ¬† ¬† ¬† ¬† }); |
| [2581](#L2581) | //¬† ¬† ¬† }); |
| [2582](#L2582) | // } |
| [2583](#L2583) | }); |
| [2584](#L2584) |  |
| [2585](#L2585) | /\* Update subtask name in database \*/ |
| [2586](#L2586) | // $('body').on('click', '.zpm\_update\_subtask', function() { |
| [2587](#L2587) | //¬† ¬† ¬† var task\_id = $('body').find('#zpm\_js\_task\_id').val(); |
| [2588](#L2588) | //¬† ¬† ¬† var subtask\_id = $(this).data('zpm-subtask-id'); |
| [2589](#L2589) | //¬† ¬† ¬† var subtask\_parent = $(this).closest('.zpm\_subtask\_item'); |
| [2590](#L2590) | //¬† ¬† ¬† var subtask = $(this).closest('.zpm\_subtask\_item').data('zpm-subtask'); |
| [2591](#L2591) | //¬† ¬† ¬† var new\_subtask = $(this).closest('.zpm\_subtask\_item').find('.zpm\_subtask\_name').html(); |
| [2592](#L2592) | //¬† ¬† ¬† var data = { |
| [2593](#L2593) | //¬† ¬† ¬† ¬† ¬† ¬† ¬† task\_id: task\_id, |
| [2594](#L2594) | //¬† ¬† ¬† ¬† ¬† ¬† ¬† subtask\_id: subtask\_id, |
| [2595](#L2595) | //¬† ¬† ¬† ¬† ¬† ¬† ¬† subtask\_action: 'update\_subtask', |
| [2596](#L2596) | //¬† ¬† ¬† ¬† ¬† ¬† ¬† new\_subtask\_name: new\_subtask |
| [2597](#L2597) | //¬† ¬† ¬† } |
| [2598](#L2598) | //¬† ¬† ¬† $(this).closest('.zpm\_subtask\_item').find('.zpm\_subtask\_name').removeAttr('contentEditable'); |
| [2599](#L2599) | //¬† ¬† ¬† $(this).removeClass('is\_active'); |
| [2600](#L2600) |  |
| [2601](#L2601) | //¬† ¬† ¬† ZephyrProjects.update\_subtasks(data, function(response){ |
| [2602](#L2602) | //¬† ¬† ¬† ¬† ¬† ¬† ¬† ZephyrProjects.notification( zpm\_localized.strings.changes\_saved ); |
| [2603](#L2603) | //¬† ¬† ¬† }); |
| [2604](#L2604) | // }); |
| [2605](#L2605) |  |
| [2606](#L2606) | /\* Mark if subtask is done \*/ |
| [2607](#L2607) | $('body').on('change',¬†'.zpm\_subtask\_is\_done',¬†function¬†()¬†{ |
| [2608](#L2608) | var¬†task\_id¬†=¬†$(this).data('task-id'); |
| [2609](#L2609) | var¬†isChecked¬†=¬†$(this).is(':checked'); |
| [2610](#L2610) |  |
| [2611](#L2611) | console.log('ischecked',¬†isChecked,¬†$(this)); |
| [2612](#L2612) |  |
| [2613](#L2613) | if¬†(isChecked)¬†{ |
| [2614](#L2614) | var¬†data¬†=¬†{ |
| [2615](#L2615) | id:¬†task\_id, |
| [2616](#L2616) | completed:¬†1 |
| [2617](#L2617) | }; |
| [2618](#L2618) |  |
| [2619](#L2619) | ZephyrProjects.complete\_task(data,¬†function¬†(response)¬†{¬†}); |
| [2620](#L2620) | $(this).closest('.zpm\_subtask\_item').addClass('zpm\_task\_complete'); |
| [2621](#L2621) | }¬†else¬†{ |
| [2622](#L2622) | var¬†data¬†=¬†{ |
| [2623](#L2623) | id:¬†task\_id, |
| [2624](#L2624) | completed:¬†0 |
| [2625](#L2625) | }; |
| [2626](#L2626) |  |
| [2627](#L2627) | ZephyrProjects.complete\_task(data,¬†function¬†(response)¬†{¬†}); |
| [2628](#L2628) | $(this).closest('.zpm\_subtask\_item').removeClass('zpm\_task\_complete'); |
| [2629](#L2629) | } |
| [2630](#L2630) | }); |
| [2631](#L2631) |  |
| [2632](#L2632) | /\* Open the new status modal \*/ |
| [2633](#L2633) | $('body').on('click',¬†'#zpm\_new\_status\_btn',¬†function¬†()¬†{ |
| [2634](#L2634) | $('#zpm-status-type\_\_new').val('status'); |
| [2635](#L2635) | ZephyrProjects.open\_modal('zpm\_new\_status\_modal'); |
| [2636](#L2636) | }); |
| [2637](#L2637) |  |
| [2638](#L2638) | $('body').on('click',¬†'#zpm\_new\_priority\_btn',¬†function¬†()¬†{ |
| [2639](#L2639) | $('#zpm-status-type\_\_new').val('priority'); |
| [2640](#L2640) | ZephyrProjects.open\_modal('zpm\_new\_status\_modal'); |
| [2641](#L2641) | }); |
| [2642](#L2642) |  |
| [2643](#L2643) | $('body').on('click',¬†'.zpm-status-list\_\_item',¬†function¬†()¬†{ |
| [2644](#L2644) | const¬†readonly¬†=¬†jQuery(this).attr('readonly'); |
| [2645](#L2645) |  |
| [2646](#L2646) | if¬†(typeof¬†readonly¬†!==¬†'undefined')¬†return; |
| [2647](#L2647) |  |
| [2648](#L2648) | ZephyrProjects.open\_modal('zpm\_edit\_status\_modal'); |
| [2649](#L2649) | var¬†name¬†=¬†$(this).find('.zpm-status-list\_\_item-name').text(); |
| [2650](#L2650) | var¬†color¬†=¬†$(this).find('.zpm-status-list\_\_item-color').css('background-color'); |
| [2651](#L2651) | $('#zpm-edit-status-id').val($(this).data('status-slug')); |
| [2652](#L2652) | $('#zpm\_edit\_status\_name').val(name); |
| [2653](#L2653) | $('#zpm\_edit\_status\_color').val(color).trigger('change'); |
| [2654](#L2654) | $('#zpm-status-type\_\_edit').val('status'); |
| [2655](#L2655) | }); |
| [2656](#L2656) |  |
| [2657](#L2657) | $('body').on('click',¬†'.zpm-priority-list\_\_item',¬†function¬†()¬†{ |
| [2658](#L2658) | const¬†readonly¬†=¬†jQuery(this).attr('readonly'); |
| [2659](#L2659) |  |
| [2660](#L2660) | if¬†(typeof¬†readonly¬†!==¬†'undefined')¬†return; |
| [2661](#L2661) |  |
| [2662](#L2662) | ZephyrProjects.open\_modal('zpm\_edit\_status\_modal'); |
| [2663](#L2663) | var¬†name¬†=¬†$(this).find('.zpm-priority-list\_\_item-name').text(); |
| [2664](#L2664) | var¬†color¬†=¬†$(this).find('.zpm-priority-list\_\_item-color').css('background-color'); |
| [2665](#L2665) | $('#zpm-edit-status-id').val($(this).data('priority-slug')); |
| [2666](#L2666) | $('#zpm\_edit\_status\_name').val(name); |
| [2667](#L2667) | $('#zpm\_edit\_status\_color').val(color).trigger('change'); |
| [2668](#L2668) | $('#zpm-status-type\_\_edit').val('priority'); |
| [2669](#L2669) | }); |
| [2670](#L2670) |  |
| [2671](#L2671) | /\* Open the new category modal \*/ |
| [2672](#L2672) | $('body').on('click',¬†'#zpm\_new\_category\_btn, #zpm\_new\_quick\_category',¬†function¬†()¬†{ |
| [2673](#L2673) | ZephyrProjects.open\_modal('zpm\_new\_category\_modal'); |
| [2674](#L2674) | }); |
| [2675](#L2675) |  |
| [2676](#L2676) | /\* Create a new category \*/ |
| [2677](#L2677) | $('body').on('click',¬†'#zpm\_create\_category',¬†function¬†(e)¬†{ |
| [2678](#L2678) |  |
| [2679](#L2679) | var¬†name¬†=¬†$(this).closest('#zpm\_new\_category\_modal').find('#zpm\_category\_name').val(); |
| [2680](#L2680) | var¬†description¬†=¬†$(this).closest('#zpm\_new\_category\_modal').find('#zpm\_category\_description').val(); |
| [2681](#L2681) | var¬†color¬†=¬†$(this).closest('#zpm\_new\_category\_modal').find('#zpm\_category\_color').val(); |
| [2682](#L2682) | if¬†(name¬†==¬†'')¬†{¬†return;¬†} |
| [2683](#L2683) |  |
| [2684](#L2684) | ZephyrProjects.notification(zpm\_localized.strings.creating\_category); |
| [2685](#L2685) | ZephyrProjects.close\_modal(); |
| [2686](#L2686) | $(this).closest('#zpm\_new\_category\_modal').find('#zpm\_category\_name').val(''); |
| [2687](#L2687) | $(this).closest('#zpm\_new\_category\_modal').find('#zpm\_category\_description').val(''); |
| [2688](#L2688) | $(this).closest('#zpm\_new\_category\_modal').find('#zpm\_category\_color').val(''); |
| [2689](#L2689) | var¬†data¬†=¬†{ |
| [2690](#L2690) | category\_name:¬†name, |
| [2691](#L2691) | category\_description:¬†description, |
| [2692](#L2692) | category\_color:¬†color, |
| [2693](#L2693) | }; |
| [2694](#L2694) |  |
| [2695](#L2695) | ZephyrProjects.create\_category(data,¬†function¬†(response)¬†{ |
| [2696](#L2696) | $('.zpm\_category\_list').html(response); |
| [2697](#L2697) | }); |
| [2698](#L2698) | }); |
| [2699](#L2699) |  |
| [2700](#L2700) | /\* Delete a category \*/ |
| [2701](#L2701) | $('body').on('click',¬†'.zpm\_delete\_category',¬†function¬†()¬†{ |
| [2702](#L2702) | var¬†category\_id¬†=¬†$(this).data('category-id'); |
| [2703](#L2703) |  |
| [2704](#L2704) | if¬†(confirm(zpm\_localized.strings.delete\_category\_notice))¬†{ |
| [2705](#L2705) | ZephyrProjects.notification(zpm\_localized.strings.deleting\_category); |
| [2706](#L2706) | ZephyrProjects.remove\_category({ |
| [2707](#L2707) | id:¬†category\_id |
| [2708](#L2708) | },¬†function¬†(response)¬†{ |
| [2709](#L2709) | $('.zpm\_category\_list').html(response); |
| [2710](#L2710) | }); |
| [2711](#L2711) | }¬†else¬†{ |
| [2712](#L2712) |  |
| [2713](#L2713) | } |
| [2714](#L2714) | }); |
| [2715](#L2715) |  |
| [2716](#L2716) | /\* Edit a category \*/ |
| [2717](#L2717) | $('body').on('click',¬†'.zpm\_category\_row',¬†function¬†(e)¬†{ |
| [2718](#L2718) | if¬†(e.target.className¬†==¬†'zpm\_delete\_category'¬†||¬†e.target.className¬†==¬†'zpm\_delete\_category\_icon lnr lnr-cross')¬†{¬†return;¬†} |
| [2719](#L2719) | ZephyrProjects.open\_modal('zpm\_edit\_category\_modal'); |
| [2720](#L2720) | var¬†category\_id¬†=¬†$(this).data('category-id'); |
| [2721](#L2721) | var¬†category\_color¬†=¬†$(this).find('.zpm\_category\_color').data('zpm-color'); |
| [2722](#L2722) | var¬†category\_name¬†=¬†$(this).find('.zpm\_category\_name').html(); |
| [2723](#L2723) | var¬†category\_description¬†=¬†$(this).find('.zpm\_category\_description').html(); |
| [2724](#L2724) |  |
| [2725](#L2725) | $('body').find('#zpm-edit-category-id').val(category\_id); |
| [2726](#L2726) | $('body').find('#zpm\_edit\_category\_modal #zpm\_edit\_category\_name').val(category\_name); |
| [2727](#L2727) | $('body').find('#zpm\_edit\_category\_modal #zpm\_edit\_category\_description').val(category\_description); |
| [2728](#L2728) | $('body').find('#zpm\_edit\_category\_modal #zpm\_edit\_category\_color').val(category\_color); |
| [2729](#L2729) |  |
| [2730](#L2730) | ZephyrProjects.colorPicker('#zpm\_edit\_category\_color'); |
| [2731](#L2731) | }); |
| [2732](#L2732) |  |
| [2733](#L2733) | /\* Update category \*/ |
| [2734](#L2734) | $('body').on('click',¬†'#zpm\_edit\_category',¬†function¬†(e)¬†{ |
| [2735](#L2735) | var¬†base¬†=¬†$(this).closest('#zpm\_edit\_category\_modal'); |
| [2736](#L2736) | var¬†category\_id¬†=¬†$('#zpm-edit-category-id').val(); |
| [2737](#L2737) | var¬†name¬†=¬†base.find('#zpm\_edit\_category\_name').val(); |
| [2738](#L2738) | var¬†description¬†=¬†base.find('#zpm\_edit\_category\_description').val(); |
| [2739](#L2739) | var¬†color¬†=¬†base.find('#zpm\_edit\_category\_color').val(); |
| [2740](#L2740) | var¬†data¬†=¬†{ |
| [2741](#L2741) | category\_id:¬†category\_id, |
| [2742](#L2742) | category\_name:¬†name, |
| [2743](#L2743) | category\_description:¬†description, |
| [2744](#L2744) | category\_color:¬†color, |
| [2745](#L2745) | }; |
| [2746](#L2746) |  |
| [2747](#L2747) | if¬†(name¬†==¬†'')¬†{ |
| [2748](#L2748) | return; |
| [2749](#L2749) | } |
| [2750](#L2750) |  |
| [2751](#L2751) | ZephyrProjects.notification(zpm\_localized.strings.saving\_changes); |
| [2752](#L2752) | ZephyrProjects.close\_modal(); |
| [2753](#L2753) | ZephyrProjects.update\_category(data,¬†function¬†(response)¬†{ |
| [2754](#L2754) | $('.zpm\_category\_list').html(response); |
| [2755](#L2755) | }); |
| [2756](#L2756) | }); |
| [2757](#L2757) |  |
| [2758](#L2758) | /\* Project quickview tabs \*/ |
| [2759](#L2759) | $('body').on('click',¬†'.zpm\_nav\_item',¬†function¬†()¬†{ |
| [2760](#L2760) | tabId¬†=¬†$(this).data('zpm-tab'); |
| [2761](#L2761) | var¬†parentModal¬†=¬†$(this).closest('.zpm-modal'); |
| [2762](#L2762) | if¬†(parentModal.length¬†>¬†0)¬†{ |
| [2763](#L2763) | parentModal.find('.zpm\_nav\_item').removeClass('zpm\_nav\_item\_selected'); |
| [2764](#L2764) | parentModal.find('.zpm\_tab\_pane').removeClass('zpm\_tab\_active'); |
| [2765](#L2765) | parentModal.find('.zpm\_tab\_pane[data-zpm-tab="'¬†+¬†tabId¬†+¬†'"]').addClass('zpm\_tab\_active'); |
| [2766](#L2766) | }¬†else¬†{ |
| [2767](#L2767) | $('body').find('.zpm\_nav\_item').removeClass('zpm\_nav\_item\_selected'); |
| [2768](#L2768) | $('body').find('.zpm\_tab\_pane').removeClass('zpm\_tab\_active'); |
| [2769](#L2769) | $('body').find('.zpm\_tab\_pane[data-zpm-tab="'¬†+¬†tabId¬†+¬†'"]').addClass('zpm\_tab\_active'); |
| [2770](#L2770) | } |
| [2771](#L2771) | $(this).addClass('zpm\_nav\_item\_selected'); |
| [2772](#L2772) |  |
| [2773](#L2773) | if¬†(tabId¬†==¬†"project-tasks")¬†{ |
| [2774](#L2774) | $('.project-type-board, .project-type-scrum').addClass('no-background'); |
| [2775](#L2775) | }¬†else¬†{ |
| [2776](#L2776) | $('.project-type-board, .project-type-scrum').removeClass('no-background'); |
| [2777](#L2777) | } |
| [2778](#L2778) | }); |
| [2779](#L2779) |  |
| [2780](#L2780) | // Delete a task |
| [2781](#L2781) | $('body').on('click',¬†'#zpm\_delete\_task',¬†function¬†()¬†{ |
| [2782](#L2782) | var¬†task\_id¬†=¬†jQuery(this).closest('[data-task-id]').data('task-id'); |
| [2783](#L2783) |  |
| [2784](#L2784) | ZephyrProjects.remove\_task({ |
| [2785](#L2785) | task\_id:¬†task\_id |
| [2786](#L2786) | },¬†function(res)¬†{ |
| [2787](#L2787) | const¬†$container¬†=¬†jQuery('body').find('#zpm\_task\_view'); |
| [2788](#L2788) |  |
| [2789](#L2789) | if¬†($container.length¬†>¬†0)¬†{ |
| [2790](#L2790) | window.location.href¬†=¬†zpm\_localized.tasks\_url; |
| [2791](#L2791) | } |
| [2792](#L2792) | }); |
| [2793](#L2793) |  |
| [2794](#L2794) | $('body').find('.zpm\_task\_list\_row[data-task-id="'¬†+¬†task\_id¬†+¬†'"]').remove(); |
| [2795](#L2795) |  |
| [2796](#L2796) | if¬†($('body').find('.zpm\_task\_list\_row').length¬†<=¬†0)¬†{ |
| [2797](#L2797) |  |
| [2798](#L2798) | // If user is on the 'All Tab' |
| [2799](#L2799) | if¬†($('body').find('.zpm\_selection\_option[data-zpm-filter="-1"]').hasClass('zpm\_nav\_item\_selected'))¬†{ |
| [2800](#L2800) | $('.zpm\_no\_results\_message').show(); |
| [2801](#L2801) | $('body').find('#zpm\_task\_option\_container').addClass('zpm\_hidden'); |
| [2802](#L2802) | $('body').find('#zpm\_task\_list\_container').addClass('zpm\_hidden'); |
| [2803](#L2803) | }¬†else¬†{ |
| [2804](#L2804) | $('body').find('.zpm\_task\_list').html('<p class="zpm\_error\_message">'¬†+¬†zpm\_localized.strings.no\_results\_found¬†+¬†'</p>'); |
| [2805](#L2805) | } |
| [2806](#L2806) | } |
| [2807](#L2807) |  |
| [2808](#L2808) | ZephyrProjects.close\_modal(); |
| [2809](#L2809) | }); |
| [2810](#L2810) |  |
| [2811](#L2811) | $('body').on('click',¬†'.zpm\_filter\_file',¬†function¬†()¬†{ |
| [2812](#L2812) | var¬†project\_id¬†=¬†$(this).data('project-id'); |
| [2813](#L2813) | $('.zpm\_filter\_file').removeClass('zpm\_selected\_link'); |
| [2814](#L2814) | $(this).addClass('zpm\_selected\_link'); |
| [2815](#L2815) | $('body').find('.zpm\_file\_item\_container').hide(); |
| [2816](#L2816) |  |
| [2817](#L2817) | if¬†(project\_id¬†==¬†'-1')¬†{ |
| [2818](#L2818) | $('body').find('.zpm\_file\_item\_container').show(); |
| [2819](#L2819) | $('body').find('#zpm\_no\_files').hide(); |
| [2820](#L2820) | } |
| [2821](#L2821) |  |
| [2822](#L2822) | $('#zpm-new-file-project-value').val(project\_id); |
| [2823](#L2823) | // If the project has files |
| [2824](#L2824) | if¬†($('body').find('.zpm\_file\_item\_container[data-project-id="'¬†+¬†project\_id¬†+¬†'"]').length¬†>¬†0)¬†{ |
| [2825](#L2825) | if¬†(project\_id¬†==¬†'-1')¬†{ |
| [2826](#L2826) | $('body').find('.zpm\_file\_item\_container').show(); |
| [2827](#L2827) | }¬†else¬†{ |
| [2828](#L2828) | $('body').find('.zpm\_file\_item\_container[data-project-id="'¬†+¬†project\_id¬†+¬†'"]').show(); |
| [2829](#L2829) | } |
| [2830](#L2830) | $('#zpm\_no\_files').hide(); |
| [2831](#L2831) | }¬†else¬†{ |
| [2832](#L2832) | if¬†(project\_id¬†==¬†'-1')¬†{ |
| [2833](#L2833) | $('#zpm\_no\_files').hide(); |
| [2834](#L2834) | }¬†else¬†{ |
| [2835](#L2835) | if¬†($('.zpm\_file\_item\_container').length¬†<=¬†0)¬†{ |
| [2836](#L2836) | $('#zpm\_no\_files').show(); |
| [2837](#L2837) | }¬†else¬†{ |
| [2838](#L2838) | $('#zpm\_no\_files').hide(); |
| [2839](#L2839) | } |
| [2840](#L2840) | } |
| [2841](#L2841) | } |
| [2842](#L2842) | }); |
| [2843](#L2843) |  |
| [2844](#L2844) | /\* WP Dashboard Charts \*/ |
| [2845](#L2845) | var¬†zpm\_progress\_chart¬†=¬†document.getElementById("zpm-dashboard-project-chart"); |
| [2846](#L2846) | var¬†completed\_projects¬†=¬†$('body').find('#zpm-dashboard-project-chart').data('project-completed'); |
| [2847](#L2847) | var¬†pending\_projects¬†=¬†$('body').find('#zpm-dashboard-project-chart').data('project-pending'); |
| [2848](#L2848) |  |
| [2849](#L2849) | var¬†zpm\_chart\_data¬†=¬†{ |
| [2850](#L2850) | labels:¬†[ |
| [2851](#L2851) | zpm\_localized.strings.completed\_projects, |
| [2852](#L2852) | zpm\_localized.strings.pending\_projects |
| [2853](#L2853) | ], |
| [2854](#L2854) | datasets:¬†[{ |
| [2855](#L2855) | data:¬†[completed\_projects,¬†pending\_projects], |
| [2856](#L2856) | backgroundColor:¬†[ |
| [2857](#L2857) | '#ec1665', |
| [2858](#L2858) | "#14aaf5", |
| [2859](#L2859) | ], |
| [2860](#L2860) | borderWidth:¬†0 |
| [2861](#L2861) | }] |
| [2862](#L2862) | }; |
| [2863](#L2863) |  |
| [2864](#L2864) | var¬†chart\_options¬†=¬†{ |
| [2865](#L2865) | cutoutPercentage:¬†80, |
| [2866](#L2866) | legend:¬†{ |
| [2867](#L2867) | position:¬†'bottom' |
| [2868](#L2868) | }, |
| [2869](#L2869) | animation:¬†{ |
| [2870](#L2870) | animateRotate:¬†false, |
| [2871](#L2871) | animateScale:¬†true |
| [2872](#L2872) | } |
| [2873](#L2873) | }; |
| [2874](#L2874) |  |
| [2875](#L2875) | if¬†(zpm\_progress\_chart¬†!==¬†null)¬†{ |
| [2876](#L2876) | var¬†doughnut\_chart¬†=¬†new¬†Chart(zpm\_progress\_chart,¬†{ |
| [2877](#L2877) | type:¬†'doughnut', |
| [2878](#L2878) | data:¬†zpm\_chart\_data, |
| [2879](#L2879) | options:¬†chart\_options |
| [2880](#L2880) | }); |
| [2881](#L2881) | } |
| [2882](#L2882) |  |
| [2883](#L2883) | function¬†zpm\_loader\_modal(message)¬†{ |
| [2884](#L2884) | var¬†html¬†=¬†'<div id="zpm\_loader\_modal" class="zpm-modal active"><div class="zpm\_task\_loader"></div>'¬†+¬†message¬†+¬†'</div>'; |
| [2885](#L2885) | if¬†($('body').find('#zpm\_loader\_modal').length¬†>¬†0)¬†{ |
| [2886](#L2886) | zpm\_close\_loader\_modal(); |
| [2887](#L2887) | } |
| [2888](#L2888) | $('body').append(html); |
| [2889](#L2889) | } |
| [2890](#L2890) |  |
| [2891](#L2891) | function¬†zpm\_close\_loader\_modal()¬†{ |
| [2892](#L2892) | $('body').find('#zpm\_loader\_modal').remove(); |
| [2893](#L2893) | } |
| [2894](#L2894) |  |
| [2895](#L2895) | $('body').on('click',¬†'#zpm\_update\_project\_progress',¬†function¬†()¬†{ |
| [2896](#L2896) | zpm\_update\_project\_progress(); |
| [2897](#L2897) | }); |
| [2898](#L2898) |  |
| [2899](#L2899) | function¬†zpm\_update\_project\_progress(project\_id)¬†{ |
| [2900](#L2900) | // Display a project progress chart |
| [2901](#L2901) | if¬†(typeof¬†project\_id¬†==¬†'undefined')¬†{ |
| [2902](#L2902) | var¬†project\_id¬†=¬†$('body').find('#zpm\_project\_editor').data('project-id'); |
| [2903](#L2903) | } |
| [2904](#L2904) |  |
| [2905](#L2905) | var¬†data¬†=¬†{ |
| [2906](#L2906) | project\_id:¬†project\_id |
| [2907](#L2907) | }; |
| [2908](#L2908) |  |
| [2909](#L2909) | ZephyrProjects.project\_progress(data,¬†function¬†(response)¬†{ |
| [2910](#L2910) | var¬†data¬†=¬†[]; |
| [2911](#L2911) | $(response.chart\_data).each(function¬†(e,¬†f)¬†{ |
| [2912](#L2912) | data.push({ |
| [2913](#L2913) | date:¬†f.date, |
| [2914](#L2914) | completed:¬†f.completed\_tasks, |
| [2915](#L2915) | pending:¬†f.pending\_tasks, |
| [2916](#L2916) | overdue:¬†f.overdue\_tasks |
| [2917](#L2917) | }); |
| [2918](#L2918) | }); |
| [2919](#L2919) |  |
| [2920](#L2920) | // temp |
| [2921](#L2921) | //ZephyrProjects.project\_chart(data); |
| [2922](#L2922) | zpm\_close\_loader\_modal(); |
| [2923](#L2923) | }); |
| [2924](#L2924) | } |
| [2925](#L2925) |  |
| [2926](#L2926) | $('#zpm\_load\_activities').on('click',¬†function¬†()¬†{ |
| [2927](#L2927) | var¬†button¬†=¬†$(this); |
| [2928](#L2928) | var¬†offset¬†=¬†button.data('offset'); |
| [2929](#L2929) | var¬†data¬†=¬†{ |
| [2930](#L2930) | offset:¬†offset |
| [2931](#L2931) | }; |
| [2932](#L2932) | button.data('offset',¬†offset¬†+=¬†1); |
| [2933](#L2933) | zpm\_loader\_modal('Loading activity...'); |
| [2934](#L2934) |  |
| [2935](#L2935) | ZephyrProjects.display\_activity(data,¬†function¬†(response)¬†{ |
| [2936](#L2936) | $('body').find('#zpm\_loader\_modal').remove(); |
| [2937](#L2937) | if¬†(response¬†!==¬†false¬†&&¬†response¬†!==¬†'')¬†{ |
| [2938](#L2938) | $('#zpm\_activity\_body').append(response); |
| [2939](#L2939) | }¬†else¬†{ |
| [2940](#L2940) | button.addClass('disabled').attr('disabled',¬†'disabled'); |
| [2941](#L2941) | zpm\_close\_loader\_modal(); |
| [2942](#L2942) | } |
| [2943](#L2943) | }); |
| [2944](#L2944) | }); |
| [2945](#L2945) |  |
| [2946](#L2946) | // Progress Page |
| [2947](#L2947) | var¬†project\_selector¬†=¬†$('#zpm\_project\_progress\_select'); |
| [2948](#L2948) |  |
| [2949](#L2949) | if¬†(project\_selector.length¬†>¬†0)¬†{ |
| [2950](#L2950) | var¬†project\_id¬†=¬†project\_selector.val(); |
| [2951](#L2951) | zpm\_update\_project\_progress(project\_id); |
| [2952](#L2952) | zpm\_loader\_modal('Loading progress...'); |
| [2953](#L2953) | } |
| [2954](#L2954) |  |
| [2955](#L2955) | project\_selector.on('change',¬†function¬†()¬†{ |
| [2956](#L2956) | var¬†project\_id¬†=¬†$(this).val(); |
| [2957](#L2957) | zpm\_update\_project\_progress(project\_id); |
| [2958](#L2958) | zpm\_loader\_modal(zpm\_localized.strings.loading\_progress); |
| [2959](#L2959) | }); |
| [2960](#L2960) |  |
| [2961](#L2961) | // Quick Menu |
| [2962](#L2962) | $('#zpm\_new\_quick\_file').on('click',¬†function¬†()¬†{ |
| [2963](#L2963) | ZephyrProjects.open\_modal('zpm\_new\_file\_upload'); |
| [2964](#L2964) | }); |
| [2965](#L2965) |  |
| [2966](#L2966) | $('#zpm\_submit\_file').on('click',¬†function¬†()¬†{ |
| [2967](#L2967) | ZephyrProjects.close\_modal(); |
| [2968](#L2968) | var¬†attachment¬†=¬†[]; |
| [2969](#L2969) | attachment['attachment\_id']¬†=¬†$('#zpm\_uploaded\_file\_name').val(); |
| [2970](#L2970) | attachment['attachment\_type']¬†=¬†'project'; |
| [2971](#L2971) | attachment['subject\_id']¬†=¬†$('#zpm\_file\_upload\_project').val(); |
| [2972](#L2972) | attachment['filename']¬†=¬†$('#zpm-uploaded-filename').val(); |
| [2973](#L2973) |  |
| [2974](#L2974) | const¬†icon¬†=¬†jQuery('body').find('#file-uploader-type [name="file\_icon"]:checked').val(); |
| [2975](#L2975) | upload\_attachment(attachment['attachment\_id'],¬†attachment['attachment\_type'],¬†attachment['subject\_id'],¬†attachment['filename'],¬†icon); |
| [2976](#L2976) | }); |
| [2977](#L2977) |  |
| [2978](#L2978) | // File Uploader |
| [2979](#L2979) | var¬†quick\_file\_uploader; |
| [2980](#L2980) | $('#zpm\_upload\_file').on('click',¬†function¬†()¬†{ |
| [2981](#L2981) | ZephyrProjects.upload\_file(quick\_file\_uploader,¬†function(attachment)¬†{ |
| [2982](#L2982) | $('#zpm\_uploaded\_file\_name').val(attachment.id); |
| [2983](#L2983) | $('#zpm-uploaded-filename').val(attachment.filename); |
| [2984](#L2984) | },¬†false); |
| [2985](#L2985) | }); |
| [2986](#L2986) |  |
| [2987](#L2987) | $('body').on('click',¬†'#zpm\_add\_project\_to\_dashboard',¬†function¬†()¬†{ |
| [2988](#L2988) | var¬†project\_id¬†=¬†$(this).closest('.zpm\_project\_item').data('project-id'); |
| [2989](#L2989) | var¬†data¬†=¬†{ |
| [2990](#L2990) | project\_id:¬†project\_id |
| [2991](#L2991) | }; |
| [2992](#L2992) | ZephyrProjects.add\_to\_dashboard(data); |
| [2993](#L2993) | }); |
| [2994](#L2994) |  |
| [2995](#L2995) | $('body').on('click',¬†'.zpm\_remove\_project\_from\_dashboard',¬†function¬†()¬†{ |
| [2996](#L2996) | var¬†project\_id¬†=¬†$(this).closest('.zpm\_dashboard\_project').data('project-id'); |
| [2997](#L2997) | var¬†data¬†=¬†{ |
| [2998](#L2998) | project\_id:¬†project\_id |
| [2999](#L2999) | }; |
| [3000](#L3000) | $(this).parents('.zpm\_dashboard\_project\_container').remove(); |
| [3001](#L3001) | ZephyrProjects.remove\_from\_dashboard(data); |
| [3002](#L3002) | }); |
| [3003](#L3003) |  |
| [3004](#L3004) | $('#zpm\_dismiss\_review\_notice').on('click',¬†function¬†()¬†{ |
| [3005](#L3005) | $(this).closest('.zpm\_admin\_notice').remove(); |
| [3006](#L3006) | var¬†data¬†=¬†{ |
| [3007](#L3007) | notice:¬†'review\_notice' |
| [3008](#L3008) | }; |
| [3009](#L3009) | ZephyrProjects.dismiss\_notice(data); |
| [3010](#L3010) | }); |
| [3011](#L3011) |  |
| [3012](#L3012) | $('#zpm\_dismiss\_welcome\_notice').on('click',¬†function¬†()¬†{ |
| [3013](#L3013) | $(this).closest('.zpm\_admin\_notice').remove(); |
| [3014](#L3014) | var¬†data¬†=¬†{ |
| [3015](#L3015) | notice:¬†'welcome\_notice' |
| [3016](#L3016) | }; |
| [3017](#L3017) | ZephyrProjects.dismiss\_notice(data); |
| [3018](#L3018) | }); |
| [3019](#L3019) |  |
| [3020](#L3020) | // Update project status |
| [3021](#L3021) | $('#zpm\_update\_project\_status').on('click',¬†function¬†()¬†{ |
| [3022](#L3022) | var¬†project\_id¬†=¬†$(this).data('project-id'); |
| [3023](#L3023) | var¬†status¬†=¬†$('#zpm\_project\_status').html(); |
| [3024](#L3024) | var¬†status\_color¬†=¬†$('.zpm\_project\_status.active').data('status'); |
| [3025](#L3025) | var¬†data¬†=¬†{ |
| [3026](#L3026) | project\_id:¬†project\_id, |
| [3027](#L3027) | status:¬†status, |
| [3028](#L3028) | status\_color:¬†status\_color |
| [3029](#L3029) | }; |
| [3030](#L3030) |  |
| [3031](#L3031) | ZephyrProjects.update\_project\_status(data,¬†function¬†(response)¬†{¬†}); |
| [3032](#L3032) | }); |
| [3033](#L3033) |  |
| [3034](#L3034) | $('.zpm\_project\_status').on('click',¬†function¬†()¬†{ |
| [3035](#L3035) | $('.zpm\_project\_status').removeClass('active'); |
| [3036](#L3036) | $(this).addClass('active'); |
| [3037](#L3037) | $('#zpm\_project\_status').text($(this).data('status-name')); |
| [3038](#L3038) | }); |
| [3039](#L3039) |  |
| [3040](#L3040) | $('body').on('click',¬†'#zpm\_add\_custom\_field\_pro',¬†function¬†()¬†{ |
| [3041](#L3041) | $(this).find('.zpm-pro-notice').toggleClass('active'); |
| [3042](#L3042) | }); |
| [3043](#L3043) |  |
| [3044](#L3044) | $('body').on('click',¬†'.zpm-close-pro-notice',¬†function¬†()¬†{ |
| [3045](#L3045) | $(this).closest('.zpm-pro-notice').removeClass('active'); |
| [3046](#L3046) | }); |
| [3047](#L3047) |  |
| [3048](#L3048) | $('body').on('click',¬†'#zpm-save-project-members',¬†function¬†()¬†{ |
| [3049](#L3049) | var¬†members¬†=¬†jQuery('body').find('#zpm-edit-project\_\_members').val(); |
| [3050](#L3050) | var¬†project\_id¬†=¬†$('#zpm-project-id').val(); |
| [3051](#L3051) |  |
| [3052](#L3052) | var¬†data¬†=¬†{ |
| [3053](#L3053) | project\_id:¬†project\_id, |
| [3054](#L3054) | members:¬†members |
| [3055](#L3055) | }; |
| [3056](#L3056) |  |
| [3057](#L3057) | ZephyrProjects.Project.update\_members(data,¬†function¬†(response)¬†{ |
| [3058](#L3058) | }); |
| [3059](#L3059) | }); |
| [3060](#L3060) |  |
| [3061](#L3061) | $('body').on('click',¬†'#zpm-select-all-project-members',¬†function¬†()¬†{ |
| [3062](#L3062) | let¬†$select¬†=¬†jQuery('body').find('#zpm-edit-project\_\_members'); |
| [3063](#L3063) | var¬†action¬†=¬†$(this).data('zpm-action'); |
| [3064](#L3064) | if¬†(action¬†===¬†"select\_all")¬†{ |
| [3065](#L3065) | $select.find('option').prop('selected',¬†true); |
| [3066](#L3066) | $select.trigger('chosen:updated'); |
| [3067](#L3067) | // $('.zpm-project-member').each(function(){ |
| [3068](#L3068) | //¬† ¬† ¬† var checked = $(this).is(':checked'); |
| [3069](#L3069) | //¬† ¬† ¬† if (!checked) { |
| [3070](#L3070) | //¬† ¬† ¬† ¬† ¬† ¬† ¬† $(this).trigger('click'); |
| [3071](#L3071) | //¬† ¬† ¬† } |
| [3072](#L3072) | // }); |
| [3073](#L3073) |  |
| [3074](#L3074) | // $('#zpm-select-all-project-members').data('zpm-action', 'deselect\_all').text(zpm\_localized.strings.deselect\_all); |
| [3075](#L3075) | }¬†else¬†{ |
| [3076](#L3076) | $select.find('option:selected').removeAttr('selected'); |
| [3077](#L3077) | $select.trigger('chosen:updated'); |
| [3078](#L3078) | // $('.zpm-project-member').each(function(){ |
| [3079](#L3079) | //¬† ¬† ¬† var checked = $(this).is(':checked'); |
| [3080](#L3080) | //¬† ¬† ¬† if (checked) { |
| [3081](#L3081) | //¬† ¬† ¬† ¬† ¬† ¬† ¬† $(this).trigger('click'); |
| [3082](#L3082) | //¬† ¬† ¬† } |
| [3083](#L3083) | // }); |
| [3084](#L3084) | // $('#zpm-select-all-project-members').data('zpm-action', 'select\_all').text(zpm\_localized.strings.select\_all); |
| [3085](#L3085) | } |
| [3086](#L3086) |  |
| [3087](#L3087) |  |
| [3088](#L3088) | }); |
| [3089](#L3089) |  |
| [3090](#L3090) | $('body').on('change',¬†'.zpm-can-zephyr',¬†function¬†()¬†{ |
| [3091](#L3091) | var¬†checked¬†=¬†$(this).is(':checked'); |
| [3092](#L3092) | var¬†userID¬†=¬†$(this).data('user-id'); |
| [3093](#L3093) | ZephyrProjects.updateUserAccess({¬†user\_id:¬†userID,¬†access:¬†checked¬†},¬†function¬†(res)¬†{ |
| [3094](#L3094) | ZephyrProjects.notification(zpm\_localized.strings.access\_updated); |
| [3095](#L3095) | }); |
| [3096](#L3096) | }); |
| [3097](#L3097) |  |
| [3098](#L3098) | $('.zpm-dismiss-whats-new').on('click',¬†function¬†()¬†{ |
| [3099](#L3099) | let¬†noticeContainer¬†=¬†$(this).closest('#zpm-whats-new'); |
| [3100](#L3100) | let¬†notice\_id¬†=¬†$(this).closest('#zpm-whats-new').data('notice'); |
| [3101](#L3101) |  |
| [3102](#L3102) | noticeContainer.addClass('zpm-hidden'); |
| [3103](#L3103) | ZephyrProjects.dismiss\_notice({ |
| [3104](#L3104) | notice:¬†notice\_id |
| [3105](#L3105) | }); |
| [3106](#L3106) | }); |
| [3107](#L3107) |  |
| [3108](#L3108) | $('.zpm-dismiss-notice').on('click',¬†function¬†()¬†{ |
| [3109](#L3109) | let¬†notice\_id¬†=¬†$(this).data('notice-id'); |
| [3110](#L3110) | $(this).addClass('dismissed'); |
| [3111](#L3111) | ZephyrProjects.dismiss\_notice({ |
| [3112](#L3112) | notice:¬†notice\_id |
| [3113](#L3113) | }); |
| [3114](#L3114) | }); |
| [3115](#L3115) |  |
| [3116](#L3116) | $('.zpm-dismiss-notice-button').on('click',¬†function¬†()¬†{ |
| [3117](#L3117) | let¬†noticeContainer¬†=¬†$(this).closest('#zpm-whats-new'); |
| [3118](#L3118) | let¬†notice\_id¬†=¬†$(this).data('notice-version'); |
| [3119](#L3119) |  |
| [3120](#L3120) | noticeContainer.addClass('zpm-hidden'); |
| [3121](#L3121) | ZephyrProjects.dismiss\_notice({ |
| [3122](#L3122) | notice:¬†notice\_id |
| [3123](#L3123) | }); |
| [3124](#L3124) | }); |
| [3125](#L3125) |  |
| [3126](#L3126) | $('[data-zpm-modal-trigger]').on('click',¬†function¬†()¬†{ |
| [3127](#L3127) | let¬†id¬†=¬†$(this).data('zpm-modal-trigger'); |
| [3128](#L3128) | ZephyrProjects.open\_modal(id); |
| [3129](#L3129) | }); |
| [3130](#L3130) |  |
| [3131](#L3131) | $('[data-zpm-modal]').on('click',¬†function¬†()¬†{ |
| [3132](#L3132) | let¬†id¬†=¬†$(this).data('zpm-modal'); |
| [3133](#L3133) | ZephyrProjects.open\_modal(id); |
| [3134](#L3134) | }); |
| [3135](#L3135) |  |
| [3136](#L3136) |  |
| [3137](#L3137) | $('#zpm-new-team').on('click',¬†function¬†()¬†{ |
| [3138](#L3138) | let¬†teamName¬†=¬†$('#zpm-new-team-name'); |
| [3139](#L3139) | let¬†teamDescription¬†=¬†$('#zpm-new-team-description'); |
| [3140](#L3140) | let¬†teamMembers¬†=¬†[]; |
| [3141](#L3141) |  |
| [3142](#L3142) | $('.zpm-new-team-member').each(function¬†()¬†{ |
| [3143](#L3143) | if¬†($(this).is(':checked'))¬†{ |
| [3144](#L3144) | teamMembers.push($(this).data('member-id')); |
| [3145](#L3145) | } |
| [3146](#L3146) | $(this).removeAttr('checked'); |
| [3147](#L3147) | }); |
| [3148](#L3148) |  |
| [3149](#L3149) | ZephyrProjects.addTeam({ |
| [3150](#L3150) | name:¬†teamName.val(), |
| [3151](#L3151) | description:¬†teamDescription.val(), |
| [3152](#L3152) | members:¬†teamMembers |
| [3153](#L3153) | },¬†function¬†(res)¬†{ |
| [3154](#L3154) | $('.zpm-teams-list').append(res.html); |
| [3155](#L3155) | $('#zpm-new-task-team-selection').append('<option value="'¬†+¬†res.team.id¬†+¬†'">'¬†+¬†res.team.name¬†+¬†'</option>'); |
| [3156](#L3156) | }); |
| [3157](#L3157) |  |
| [3158](#L3158) | teamName.val(''); |
| [3159](#L3159) | teamDescription.val(''); |
| [3160](#L3160) | ZephyrProjects.close\_modal('#zpm-new-team-modal'); |
| [3161](#L3161) | $('#zpm-no-teams-notice').hide(); |
| [3162](#L3162) | }); |
| [3163](#L3163) |  |
| [3164](#L3164) | // Check if new task - team selection has changed |
| [3165](#L3165) | $('body').on('change',¬†'#zpm-new-task-team-selection',¬†function¬†()¬†{ |
| [3166](#L3166) | let¬†teamId¬†=¬†$(this).val(); |
| [3167](#L3167) | // $('#zpm\_new\_task\_assignee').val(''); |
| [3168](#L3168) | // $('#zpm\_new\_task\_assignee').trigger("chosen:updated"); |
| [3169](#L3169) |  |
| [3170](#L3170) | ZephyrProjects.getTeam({ |
| [3171](#L3171) | id:¬†teamId |
| [3172](#L3172) | },¬†function¬†(res)¬†{ |
| [3173](#L3173) | if¬†(res¬†!=¬†null)¬†{ |
| [3174](#L3174) | var¬†values¬†=¬†[]; |
| [3175](#L3175) | $.each(res.members,¬†function¬†(key,¬†val)¬†{ |
| [3176](#L3176) | let¬†userId¬†=¬†val.id; |
| [3177](#L3177) | values.push(userId); |
| [3178](#L3178) |  |
| [3179](#L3179) | }); |
| [3180](#L3180) | $('#zpm\_new\_task\_assignee').val(values); |
| [3181](#L3181) | $('#zpm\_new\_task\_assignee').trigger("chosen:updated"); |
| [3182](#L3182) | } |
| [3183](#L3183) | }); |
| [3184](#L3184) | }); |
| [3185](#L3185) |  |
| [3186](#L3186) | $('body').on('click',¬†'.zpm-edit-team',¬†function¬†()¬†{ |
| [3187](#L3187) | let¬†id¬†=¬†$(this).data('team-id'); |
| [3188](#L3188) | let¬†idHidden¬†=¬†$('#zpm-edit-team-id'); |
| [3189](#L3189) | let¬†teamName¬†=¬†$('#zpm-edit-team-name'); |
| [3190](#L3190) | let¬†teamDescription¬†=¬†$('#zpm-edit-team-description'); |
| [3191](#L3191) |  |
| [3192](#L3192) | $('body').find('.zpm-edit-team-member').removeAttr('checked'); |
| [3193](#L3193) | idHidden.val(id); |
| [3194](#L3194) | teamName.val(''); |
| [3195](#L3195) | teamDescription.val(''); |
| [3196](#L3196) |  |
| [3197](#L3197) | ZephyrProjects.open\_modal('zpm-edit-team-modal'); |
| [3198](#L3198) |  |
| [3199](#L3199) | $('body').find('#zpm-modal-loader-edit-team').show(); |
| [3200](#L3200) | ZephyrProjects.getTeam({ |
| [3201](#L3201) | id:¬†id |
| [3202](#L3202) | },¬†function¬†(res)¬†{ |
| [3203](#L3203) | $('body').find('#zpm-modal-loader-edit-team').hide(); |
| [3204](#L3204) | teamName.val(res.name); |
| [3205](#L3205) | teamDescription.val(res.description); |
| [3206](#L3206) | $.each(res.members,¬†function¬†(key,¬†val)¬†{ |
| [3207](#L3207) | let¬†userId¬†=¬†val.id; |
| [3208](#L3208) | $('body').find('.zpm-edit-team-member[data-member-id="'¬†+¬†userId¬†+¬†'"]').prop('checked',¬†true); |
| [3209](#L3209) | }); |
| [3210](#L3210) | }); |
| [3211](#L3211) |  |
| [3212](#L3212) | }); |
| [3213](#L3213) |  |
| [3214](#L3214) | $('body').on('click',¬†'.zpm-delete-team',¬†function¬†()¬†{ |
| [3215](#L3215) | let¬†id¬†=¬†$(this).data('team-id'); |
| [3216](#L3216) | let¬†container¬†=¬†$(this).closest('.zpm\_team\_member'); |
| [3217](#L3217) |  |
| [3218](#L3218) | ZephyrProjects.confirm(zpm\_localized.strings.delete\_team\_notice,¬†function¬†()¬†{ |
| [3219](#L3219) | container.remove(); |
| [3220](#L3220) | ZephyrProjects.deleteTeam({ |
| [3221](#L3221) | id:¬†id |
| [3222](#L3222) | },¬†function¬†(res)¬†{ |
| [3223](#L3223) | }); |
| [3224](#L3224) | }); |
| [3225](#L3225) | }); |
| [3226](#L3226) |  |
| [3227](#L3227) | $('#zpm-edit-team').on('click',¬†function¬†()¬†{ |
| [3228](#L3228) | let¬†id¬†=¬†$('#zpm-edit-team-id'); |
| [3229](#L3229) | let¬†teamName¬†=¬†$('#zpm-edit-team-name'); |
| [3230](#L3230) | let¬†teamDescription¬†=¬†$('#zpm-edit-team-description'); |
| [3231](#L3231) | let¬†teamMembers¬†=¬†[]; |
| [3232](#L3232) |  |
| [3233](#L3233) | $('.zpm-edit-team-member').each(function¬†()¬†{ |
| [3234](#L3234) | if¬†($(this).is(':checked'))¬†{ |
| [3235](#L3235) | teamMembers.push($(this).data('member-id')); |
| [3236](#L3236) | } |
| [3237](#L3237) | $(this).removeAttr('checked'); |
| [3238](#L3238) | }); |
| [3239](#L3239) |  |
| [3240](#L3240) | ZephyrProjects.updateTeam({ |
| [3241](#L3241) | id:¬†id.val(), |
| [3242](#L3242) | name:¬†teamName.val(), |
| [3243](#L3243) | description:¬†teamDescription.val(), |
| [3244](#L3244) | members:¬†teamMembers |
| [3245](#L3245) | },¬†function¬†(res)¬†{ |
| [3246](#L3246) | $('body').find('.zpm\_team\_member[data-team-id="'¬†+¬†id.val()¬†+¬†'"]').replaceWith(res); |
| [3247](#L3247) | }); |
| [3248](#L3248) |  |
| [3249](#L3249) | teamName.val(''); |
| [3250](#L3250) | teamDescription.val(''); |
| [3251](#L3251) | ZephyrProjects.close\_modal('#zpm-edit-team-modal'); |
| [3252](#L3252) | }); |
| [3253](#L3253) |  |
| [3254](#L3254) | jQuery('body').on('click',¬†function¬†(e)¬†{ |
| [3255](#L3255) | var¬†target¬†=¬†jQuery(e.target); |
| [3256](#L3256) | var¬†id¬†=¬†target.prop('id'); |
| [3257](#L3257) |  |
| [3258](#L3258) | if¬†(jQuery(e.target).hasClass('.zpm\_fancy\_dropdown')¬†||¬†id¬†==¬†'zpm\_add\_new\_btn'¬†||¬†target.closest('#zpm\_add\_new\_btn').length¬†>¬†0)¬†{ |
| [3259](#L3259) |  |
| [3260](#L3260) | }¬†else¬†{ |
| [3261](#L3261) | jQuery('body').find('.zpm\_fancy\_dropdown').removeClass('active'); |
| [3262](#L3262) | } |
| [3263](#L3263) | }); |
| [3264](#L3264) |  |
| [3265](#L3265) | function¬†zpmSetupRippleEffect()¬†{ |
| [3266](#L3266) | // Material ripple effect |
| [3267](#L3267) | $('body').on('click',¬†'.zpm\_button,[data-ripple], [ripple], [zpm-ripple], .zpm\_project\_title.project\_name, .zpm\_button\_outline',¬†function¬†(e)¬†{ |
| [3268](#L3268) | var¬†$self¬†=¬†$(this); |
| [3269](#L3269) |  |
| [3270](#L3270) | if¬†($self.attr('disabled')¬†||¬†e.target.className.indexOf('zpm\_task\_mark\_complete')¬†>¬†-1¬†||¬†e.target.className.indexOf('zpm-material-checkbox-label')¬†>¬†-1¬†||¬†e.target.className.indexOf('zpm-task-bulk-selector')¬†>¬†-1¬†||¬†e.target.className.indexOf('zpm\_toggle')¬†>¬†-1¬†||¬†e.target.className.indexOf('zpm\_task\_project')¬†>¬†-1¬†||¬†e.target.className.indexOf('zpm-override-click')¬†>¬†-1)¬†{ |
| [3271](#L3271) | return; |
| [3272](#L3272) | } |
| [3273](#L3273) |  |
| [3274](#L3274) | var¬†initPos¬†=¬†$self.css('position'), |
| [3275](#L3275) | offs¬†=¬†$self.offset(), |
| [3276](#L3276) | x¬†=¬†e.pageX¬†-¬†offs.left, |
| [3277](#L3277) | y¬†=¬†e.pageY¬†-¬†offs.top, |
| [3278](#L3278) | dia¬†=¬†Math.min(this.offsetHeight,¬†this.offsetWidth,¬†100),¬†// start diameter |
| [3279](#L3279) | $ripple¬†=¬†$('<div/>',¬†{¬†class:¬†'ripple',¬†appendTo:¬†$self¬†}); |
| [3280](#L3280) |  |
| [3281](#L3281) | if¬†(!initPos¬†||¬†initPos¬†===¬†'static')¬†{ |
| [3282](#L3282) | $self.css({¬†position:¬†'relative'¬†}); |
| [3283](#L3283) | } |
| [3284](#L3284) |  |
| [3285](#L3285) | $('<div/>',¬†{ |
| [3286](#L3286) | class:¬†'rippleWave', |
| [3287](#L3287) | css:¬†{ |
| [3288](#L3288) | background:¬†$self.data('ripple'), |
| [3289](#L3289) | width:¬†dia, |
| [3290](#L3290) | height:¬†dia, |
| [3291](#L3291) | left:¬†x¬†-¬†(dia¬†/¬†2), |
| [3292](#L3292) | top:¬†y¬†-¬†(dia¬†/¬†2), |
| [3293](#L3293) | }, |
| [3294](#L3294) | appendTo:¬†$ripple, |
| [3295](#L3295) | one:¬†{ |
| [3296](#L3296) | animationend:¬†function¬†()¬†{ |
| [3297](#L3297) | $ripple.remove(); |
| [3298](#L3298) | } |
| [3299](#L3299) | } |
| [3300](#L3300) | }); |
| [3301](#L3301) | }); |
| [3302](#L3302) | } |
| [3303](#L3303) |  |
| [3304](#L3304) | $('#zpm\_edit\_task\_name').on('input',¬†function¬†()¬†{ |
| [3305](#L3305) | $('#zpm\_task\_name\_title').text($(this).val()); |
| [3306](#L3306) | }); |
| [3307](#L3307) |  |
| [3308](#L3308) | jQuery(document).on('zephyr\_task\_created',¬†function¬†(e)¬†{ |
| [3309](#L3309) | if¬†(zephyrSocket)¬†{ |
| [3310](#L3310) | e.ndata.devices¬†=¬†zpm\_localized.device\_ids; |
| [3311](#L3311) | e.ndata.user\_id¬†=¬†zpm\_localized.user\_id; |
| [3312](#L3312) | zephyrSocket.emit('task-created',¬†zpm\_localized.website,¬†e.ndata); |
| [3313](#L3313) | } |
| [3314](#L3314) |  |
| [3315](#L3315) | let¬†currentTotal¬†=¬†jQuery("#zpm\_stat\_tasks\_total").text(); |
| [3316](#L3316) | let¬†newTotal¬†=¬†parseInt(currentTotal)¬†+¬†1; |
| [3317](#L3317) | jQuery("#zpm\_stat\_tasks\_total").text(newTotal); |
| [3318](#L3318) | let¬†currentActive¬†=¬†jQuery("#zpm\_stat\_tasks\_active").text(); |
| [3319](#L3319) | let¬†newActive¬†=¬†parseInt(currentActive)¬†+¬†1; |
| [3320](#L3320) | jQuery("#zpm\_stat\_tasks\_active").text(newActive); |
| [3321](#L3321) | }); |
| [3322](#L3322) |  |
| [3323](#L3323) | jQuery(document).on('zephyr\_task\_deleted',¬†function¬†(e)¬†{ |
| [3324](#L3324) | if¬†(zephyrSocket)¬†{ |
| [3325](#L3325) | e.ndata.devices¬†=¬†zpm\_localized.device\_ids; |
| [3326](#L3326) | e.ndata.user\_id¬†=¬†zpm\_localized.user\_id; |
| [3327](#L3327) | zephyrSocket.emit('task-deleted',¬†zpm\_localized.website,¬†e.ndata); |
| [3328](#L3328) | } |
| [3329](#L3329) | }); |
| [3330](#L3330) |  |
| [3331](#L3331) | jQuery(document).on('zephyr\_new\_message',¬†function¬†(e)¬†{ |
| [3332](#L3332) | if¬†(zephyrSocket)¬†{ |
| [3333](#L3333) | e.ndata.devices¬†=¬†zpm\_localized.device\_ids; |
| [3334](#L3334) | zephyrSocket.emit('new-message',¬†zpm\_localized.website,¬†e.ndata); |
| [3335](#L3335) | } |
| [3336](#L3336) | }); |
| [3337](#L3337) |  |
| [3338](#L3338) | jQuery(document).on('zephyr\_project\_created',¬†function¬†(e)¬†{ |
| [3339](#L3339) | var¬†data¬†=¬†e.ndata; |
| [3340](#L3340) | e.ndata.devices¬†=¬†zpm\_localized.device\_ids; |
| [3341](#L3341) | if¬†(zephyrSocket)¬†{ |
| [3342](#L3342) | zephyrSocket.emit('new-project',¬†zpm\_localized.website,¬†e.ndata); |
| [3343](#L3343) | } |
| [3344](#L3344) |  |
| [3345](#L3345) |  |
| [3346](#L3346) | jQuery('body').find('#zpm\_new\_task\_project').append('<option value="'¬†+¬†data.project.id¬†+¬†'">'¬†+¬†data.project.name¬†+¬†'</option>'); |
| [3347](#L3347) | jQuery('body').find('#zpm\_new\_task\_project').trigger('chosen:updated').trigger('change'); |
| [3348](#L3348) |  |
| [3349](#L3349) | let¬†currentCount¬†=¬†jQuery("#zpm\_projects\_created\_count").text(); |
| [3350](#L3350) | let¬†newCount¬†=¬†parseInt(currentCount)¬†+¬†1; |
| [3351](#L3351) | jQuery("#zpm\_projects\_created\_count").text(newCount); |
| [3352](#L3352) | jQuery("#zpm\_project\_stats\_total").html(newCount); |
| [3353](#L3353) |  |
| [3354](#L3354) | let¬†currentActive¬†=¬†jQuery("#zpm\_projects\_active\_count").text(); |
| [3355](#L3355) | let¬†newActive¬†=¬†parseInt(currentActive)¬†+¬†1; |
| [3356](#L3356) | jQuery("#zpm\_projects\_active\_count").text(newActive); |
| [3357](#L3357) | }); |
| [3358](#L3358) |  |
| [3359](#L3359) | // Listen for new tasks created by other users |
| [3360](#L3360) | if¬†(zephyrSocket)¬†{ |
| [3361](#L3361) | zephyrSocket.on('task-created',¬†function¬†(data)¬†{ |
| [3362](#L3362) | if¬†(typeof¬†data.user\_id¬†!==¬†zpm\_localized.user\_id)¬†{ |
| [3363](#L3363) | if¬†(data.assignee¬†==¬†zpm\_localized.user\_id)¬†{ |
| [3364](#L3364) | ZephyrProjects.notification(data.username¬†+¬†" assigned a new task to you: <a href='"¬†+¬†zpm\_localized.tasks\_url¬†+¬†"&action=view\_task&task\_id="¬†+¬†data.id¬†+¬†"' target='\_blank'>"¬†+¬†data.name¬†+¬†"</a>",¬†false,¬†5000); |
| [3365](#L3365) | }¬†else¬†{ |
| [3366](#L3366) | ZephyrProjects.notification(data.username¬†+¬†" created a new task: <a href='"¬†+¬†zpm\_localized.tasks\_url¬†+¬†"&action=view\_task&task\_id="¬†+¬†data.id¬†+¬†"' target='\_blank'>"¬†+¬†data.name¬†+¬†"</a>",¬†false,¬†4000); |
| [3367](#L3367) | } |
| [3368](#L3368) |  |
| [3369](#L3369) | var¬†new\_task¬†=¬†data.new\_task\_html; |
| [3370](#L3370) | $('body').find('.zpm\_task\_list').append(new\_task); |
| [3371](#L3371) | $('body').find('.zpm\_message\_center').remove(); |
| [3372](#L3372) | $('body').find('#zpm\_task\_option\_container').removeClass('zpm\_hidden'); |
| [3373](#L3373) | $('body').find('#zpm\_task\_list\_container').removeClass('zpm\_hidden'); |
| [3374](#L3374) | $('body').find('.zpm\_no\_results\_message').addClass('zpm\_hidden'); |
| [3375](#L3375) | $('.zpm\_no\_results\_message').hide(); |
| [3376](#L3376) | } |
| [3377](#L3377) | }); |
| [3378](#L3378) | } |
| [3379](#L3379) |  |
| [3380](#L3380) | // Listen for new tasks created by other users |
| [3381](#L3381) | if¬†(zephyrSocket)¬†{ |
| [3382](#L3382) | zephyrSocket.on('new-project',¬†function¬†(data)¬†{ |
| [3383](#L3383) | if¬†(typeof¬†data.user\_id¬†!==¬†zpm\_localized.user\_id)¬†{ |
| [3384](#L3384) | $('body').find('#zpm\_project\_manager\_display').removeClass('zpm\_hide'); |
| [3385](#L3385) | $('body').find('.zpm\_no\_results\_message').hide(); |
| [3386](#L3386) | $('body').find('.zpm\_project\_grid').prepend(data.html); |
| [3387](#L3387) | ZephyrProjects.notification(data.username¬†+¬†" created a new project: <a href='"¬†+¬†zpm\_localized.projects\_url¬†+¬†"&action=edit\_project&project="¬†+¬†data.project.id¬†+¬†"' target='\_blank'>"¬†+¬†data.project.name¬†+¬†"</a>",¬†false,¬†4000); |
| [3388](#L3388) | } |
| [3389](#L3389) | }); |
| [3390](#L3390) | } |
| [3391](#L3391) |  |
| [3392](#L3392) | // Listen for new message sent by other users |
| [3393](#L3393) | if¬†(zephyrSocket)¬†{ |
| [3394](#L3394) | zephyrSocket.on('new-message',¬†function¬†(data)¬†{ |
| [3395](#L3395) | if¬†(typeof¬†data.user\_id¬†!==¬†zpm\_localized.user\_id)¬†{ |
| [3396](#L3396) | if¬†(data.subject¬†==¬†"task")¬†{ |
| [3397](#L3397) | $('body').find('.zpm\_task\_comments[data-task-id="'¬†+¬†data.id¬†+¬†'"]').prepend(data.html); |
| [3398](#L3398) | ZephyrProjects.notification("New comment on the task: <a href='"¬†+¬†zpm\_localized.tasks\_url¬†+¬†"&action=view\_task&task\_id="¬†+¬†data.id¬†+¬†"' target='\_blank'>"¬†+¬†data.subject\_object.name¬†+¬†"</a>",¬†false,¬†4000); |
| [3399](#L3399) | }¬†else¬†{ |
| [3400](#L3400) | $('body').find('.zpm\_task\_comments[data-project-id="'¬†+¬†data.id¬†+¬†'"]').prepend(data.html); |
| [3401](#L3401) | ZephyrProjects.notification("New comment on the project: <a href='"¬†+¬†zpm\_localized.projects\_url¬†+¬†"&action=edit\_project&project="¬†+¬†data.id¬†+¬†"' target='\_blank'>"¬†+¬†data.subject\_object.name¬†+¬†"</a>",¬†false,¬†4000); |
| [3402](#L3402) | } |
| [3403](#L3403) | } |
| [3404](#L3404) | }); |
| [3405](#L3405) | } |
| [3406](#L3406) |  |
| [3407](#L3407) | $('#zpm\_edit\_project\_name').on('input',¬†function¬†()¬†{ |
| [3408](#L3408) | $('#zpm\_project\_name\_title').text($(this).val()); |
| [3409](#L3409) | }); |
| [3410](#L3410) |  |
| [3411](#L3411) | $('.zpm\_nav\_item').on('click',¬†function¬†()¬†{ |
| [3412](#L3412) | var¬†tab¬†=¬†$(this).data('zpm-tab'); |
| [3413](#L3413) | if¬†(typeof¬†tab¬†!==¬†"undefined")¬†{ |
| [3414](#L3414) | location.hash¬†=¬†tab; |
| [3415](#L3415) | } |
| [3416](#L3416) | }); |
| [3417](#L3417) |  |
| [3418](#L3418) | var¬†hash¬†=¬†window.location.hash.slice(1); |
| [3419](#L3419) | if¬†(typeof¬†hash¬†!==¬†'undefined'¬†&&¬†hash¬†!==¬†"")¬†{ |
| [3420](#L3420) | $('.zpm\_nav\_item[data-zpm-tab="'¬†+¬†hash¬†+¬†'"]').trigger('click'); |
| [3421](#L3421) | } |
| [3422](#L3422) |  |
| [3423](#L3423) | $('body').on('click',¬†'#zpm-copy-task-shortcode',¬†function¬†()¬†{ |
| [3424](#L3424) | var¬†shortcode¬†=¬†$(this).data('shortcode'); |
| [3425](#L3425) | ZephyrProjects.copy\_to\_clipboard(shortcode); |
| [3426](#L3426) | ZephyrProjects.notification(zpm\_localized.strings.shortcode\_copied¬†+¬†': '¬†+¬†shortcode); |
| [3427](#L3427) | }); |
| [3428](#L3428) |  |
| [3429](#L3429) | $('body').on('click',¬†'#zpm-copy-project-shortcode',¬†function¬†()¬†{ |
| [3430](#L3430) | var¬†shortcode¬†=¬†$(this).data('shortcode'); |
| [3431](#L3431) | ZephyrProjects.copy\_to\_clipboard(shortcode); |
| [3432](#L3432) | ZephyrProjects.notification(zpm\_localized.strings.shortcode\_copied¬†+¬†': '¬†+¬†shortcode); |
| [3433](#L3433) | }); |
| [3434](#L3434) |  |
| [3435](#L3435) | // jQuery('#zpm\_create\_task').keypress(function(e) { |
| [3436](#L3436) | //¬† ¬† ¬† let keycode = e.which; |
| [3437](#L3437) | //¬† ¬† ¬† if (keycode == 13) { |
| [3438](#L3438) | //¬† ¬† ¬† ¬† ¬† ¬† ¬† jQuery('#zpm\_save\_task').click(); |
| [3439](#L3439) | //¬† ¬† ¬† } |
| [3440](#L3440) | // }); |
| [3441](#L3441) |  |
| [3442](#L3442) | // jQuery('.zpm\_project\_name\_input').keypress(function(e) { |
| [3443](#L3443) | //¬† ¬† ¬† let keycode = e.which; |
| [3444](#L3444) | //¬† ¬† ¬† if (keycode == 13) { |
| [3445](#L3445) | //¬† ¬† ¬† ¬† ¬† ¬† ¬† jQuery('#zpm\_modal\_add\_project').click(); |
| [3446](#L3446) | //¬† ¬† ¬† } |
| [3447](#L3447) | // }); |
| [3448](#L3448) |  |
| [3449](#L3449) | // document.onkeyup = function(e) { |
| [3450](#L3450) | //¬† ¬† ¬† if (e.which == 27) { |
| [3451](#L3451) | //¬† ¬† ¬† ¬† ¬† ¬† ¬† jQuery('#zpm\_modal\_background').click(); |
| [3452](#L3452) | //¬† ¬† ¬† } else if (e.shiftKey && e.which == 84) { |
| [3453](#L3453) | //¬† ¬† ¬† ¬† ¬† ¬† ¬† jQuery('body').find('#zpm\_quickadd\_task').click(); |
| [3454](#L3454) | //¬† ¬† ¬† } else if (e.shiftKey && e.which == 80) { |
| [3455](#L3455) | //¬† ¬† ¬† ¬† ¬† ¬† ¬† jQuery('body').find('#zpm\_create\_quickproject').click(); |
| [3456](#L3456) | //¬† ¬† ¬† } |
| [3457](#L3457) | // }; |
| [3458](#L3458) |  |
| [3459](#L3459) | $('.zpm-switch-project-type').on('click',¬†function¬†()¬†{ |
| [3460](#L3460) | var¬†id¬†=¬†$(this).data('project-id'); |
| [3461](#L3461) | var¬†type¬†=¬†$(this).data('type'); |
| [3462](#L3462) | var¬†pro¬†=¬†$(this).data('zpm-pro'); |
| [3463](#L3463) |  |
| [3464](#L3464) | if¬†(pro¬†&&¬†(pro¬†==¬†"1"¬†||¬†pro¬†==¬†"true"))¬†{ |
| [3465](#L3465) | $(this).closest('#zpm\_switch\_project\_type\_button').find('.zpm-project-type\_\_label').text(zpm\_localized.strings.loading); |
| [3466](#L3466) | ZephyrProjects.switch\_project\_type({ |
| [3467](#L3467) | project\_id:¬†id, |
| [3468](#L3468) | type:¬†type |
| [3469](#L3469) | },¬†function¬†()¬†{ |
| [3470](#L3470) | location.reload(); |
| [3471](#L3471) | }); |
| [3472](#L3472) | } |
| [3473](#L3473) | }); |
| [3474](#L3474) |  |
| [3475](#L3475) | $('button#zpm\_profile\_settings').on('click',¬†function¬†(e)¬†{ |
| [3476](#L3476) | var¬†custom\_fields¬†=¬†[]; |
| [3477](#L3477) |  |
| [3478](#L3478) | $('body').find('#zpm\_profile\_settings .zpm\_task\_custom\_field[data-zpm-cf-id]').each(function¬†()¬†{ |
| [3479](#L3479) | var¬†id¬†=¬†$(this).data('zpm-cf-id'); |
| [3480](#L3480) | var¬†type¬†=¬†$(this).data('zpm-cf-type'); |
| [3481](#L3481) | var¬†value¬†=¬†$(this).val(); |
| [3482](#L3482) |  |
| [3483](#L3483) | if¬†(type¬†==¬†"checkbox")¬†{ |
| [3484](#L3484) | value¬†=¬†$(this).is(':checked'); |
| [3485](#L3485) | } |
| [3486](#L3486) |  |
| [3487](#L3487) | custom\_fields.push({ |
| [3488](#L3488) | id:¬†id, |
| [3489](#L3489) | value:¬†value |
| [3490](#L3490) | }); |
| [3491](#L3491) |  |
| [3492](#L3492) | }); |
| [3493](#L3493) |  |
| [3494](#L3494) | var¬†data¬†=¬†$(this).serializeArray();¬†// convert form to array |
| [3495](#L3495) | data.push({¬†name:¬†"NonFormValue",¬†value:¬†custom\_fields¬†}); |
| [3496](#L3496) | data.zpm\_nonce¬†=¬†zpm\_localized.zpm\_nonce; |
| [3497](#L3497) |  |
| [3498](#L3498) | $.ajax({ |
| [3499](#L3499) | type:¬†'POST', |
| [3500](#L3500) | url:¬†zpm\_localized.ajaxurl, |
| [3501](#L3501) | data:¬†$.param(data), |
| [3502](#L3502) | }); |
| [3503](#L3503) | }); |
| [3504](#L3504) |  |
| [3505](#L3505) | // Create new status |
| [3506](#L3506) | $('#zpm\_create\_status').on('click',¬†function¬†()¬†{ |
| [3507](#L3507) | ZephyrProjects.close\_modal('#zpm\_new\_status\_modal'); |
| [3508](#L3508) |  |
| [3509](#L3509) | var¬†name¬†=¬†$('#zpm\_status\_name').val(); |
| [3510](#L3510) | var¬†color¬†=¬†$('#zpm\_status\_color').val(); |
| [3511](#L3511) | var¬†type¬†=¬†$('#zpm-status-type\_\_new').val(); |
| [3512](#L3512) |  |
| [3513](#L3513) | ZephyrProjects.create\_status({ |
| [3514](#L3514) | name:¬†name, |
| [3515](#L3515) | color:¬†color, |
| [3516](#L3516) | type:¬†type |
| [3517](#L3517) | },¬†function¬†(res)¬†{ |
| [3518](#L3518) | $('.zpm-'¬†+¬†type¬†+¬†'-list').append(res.html); |
| [3519](#L3519) | }); |
| [3520](#L3520) | }); |
| [3521](#L3521) |  |
| [3522](#L3522) | // Update status |
| [3523](#L3523) | $('#zpm\_edit\_status').on('click',¬†function¬†()¬†{ |
| [3524](#L3524) | ZephyrProjects.close\_modal('#zpm\_edit\_status\_modal'); |
| [3525](#L3525) |  |
| [3526](#L3526) | var¬†name¬†=¬†$('#zpm\_edit\_status\_name').val(); |
| [3527](#L3527) | var¬†color¬†=¬†$('#zpm\_edit\_status\_color').val(); |
| [3528](#L3528) | var¬†slug¬†=¬†$('#zpm-edit-status-id').val(); |
| [3529](#L3529) | var¬†type¬†=¬†$('#zpm-status-type\_\_edit').val(); |
| [3530](#L3530) |  |
| [3531](#L3531) | var¬†selector¬†=¬†'.zpm-'¬†+¬†type¬†+¬†'-list\_\_item[data-'¬†+¬†type¬†+¬†'-slug="'¬†+¬†slug¬†+¬†'"]'; |
| [3532](#L3532) |  |
| [3533](#L3533) | ZephyrProjects.update\_status({ |
| [3534](#L3534) | name:¬†name, |
| [3535](#L3535) | color:¬†color, |
| [3536](#L3536) | slug:¬†slug, |
| [3537](#L3537) | type:¬†type |
| [3538](#L3538) | },¬†function¬†(res)¬†{ |
| [3539](#L3539) | $(selector).replaceWith(res.html); |
| [3540](#L3540) | }); |
| [3541](#L3541) | }); |
| [3542](#L3542) |  |
| [3543](#L3543) | // Delete Status |
| [3544](#L3544) | $('body').on('click',¬†'.zpm-delete-status',¬†function¬†(e)¬†{ |
| [3545](#L3545) | e.stopPropagation(); |
| [3546](#L3546) | var¬†slug¬†=¬†$(this).data('id'); |
| [3547](#L3547) | if¬†(confirm(zpm\_localized.strings.delete\_status\_prompt))¬†{ |
| [3548](#L3548) | ZephyrProjects.delete\_status({ |
| [3549](#L3549) | slug:¬†slug, |
| [3550](#L3550) | type:¬†'status' |
| [3551](#L3551) | },¬†function¬†()¬†{ |
| [3552](#L3552) | }); |
| [3553](#L3553) | $(this).closest('.zpm-status-list\_\_item').remove(); |
| [3554](#L3554) | } |
| [3555](#L3555) | }); |
| [3556](#L3556) |  |
| [3557](#L3557) | $('body').on('click',¬†'.zpm-delete-priority',¬†function¬†(e)¬†{ |
| [3558](#L3558) | e.stopPropagation(); |
| [3559](#L3559) | var¬†slug¬†=¬†$(this).data('id'); |
| [3560](#L3560) | if¬†(confirm(zpm\_localized.strings.delete\_status\_prompt))¬†{ |
| [3561](#L3561) | ZephyrProjects.delete\_status({ |
| [3562](#L3562) | slug:¬†slug, |
| [3563](#L3563) | type:¬†'priority' |
| [3564](#L3564) | },¬†function¬†()¬†{ |
| [3565](#L3565) | }); |
| [3566](#L3566) | $(this).closest('.zpm-priority-list\_\_item').remove(); |
| [3567](#L3567) | } |
| [3568](#L3568) | }); |
| [3569](#L3569) |  |
| [3570](#L3570) | //$('#zpm-calendar\_\_filter-assignee').val(zpm\_localized.user\_id).trigger('chosen:updated'); |
| [3571](#L3571) |  |
| [3572](#L3572) | $('body').on('change',¬†'#zpm-calendar\_\_filter-project, #zpm-calendar\_\_filter-team, #zpm-calendar\_\_filter-assignee, #zpm-calendar\_\_filter-completed',¬†function¬†()¬†{ |
| [3573](#L3573) | filterCalendarTasks(); |
| [3574](#L3574) | }); |
| [3575](#L3575) |  |
| [3576](#L3576) | // ZephyrProjects.ajax({ |
| [3577](#L3577) | //¬† ¬† ¬† action: 'zpm\_get\_user\_projects', |
| [3578](#L3578) | //¬† ¬† ¬† user\_id: zpm\_localized.user\_id |
| [3579](#L3579) | // }, function (response) { |
| [3580](#L3580) | //¬† ¬† ¬† $('.zpm-user-project-count-value').text(response.project\_count); |
| [3581](#L3581) | // }); |
| [3582](#L3582) |  |
| [3583](#L3583) | // Deprecated since adding pagination |
| [3584](#L3584) | // if (ZephyrProjects.isMembersPage()) { |
| [3585](#L3585) | //¬† ¬† ¬† ZephyrProjects.ajax({ |
| [3586](#L3586) | //¬† ¬† ¬† ¬† ¬† ¬† ¬† action: 'zpm\_team\_members\_list\_html' |
| [3587](#L3587) | //¬† ¬† ¬† }, function(response){ |
| [3588](#L3588) | //¬† ¬† ¬† ¬† ¬† ¬† ¬† $('#zpm\_members').html(response.html); |
| [3589](#L3589) | //¬† ¬† ¬† }); |
| [3590](#L3590) | // } |
| [3591](#L3591) |  |
| [3592](#L3592) | // Paginate member list |
| [3593](#L3593) | var¬†zpm\_members\_paged¬†=¬†1; |
| [3594](#L3594) | $('body').on('click',¬†'#zpm-members-pagination\_\_next',¬†function¬†(e)¬†{ |
| [3595](#L3595) | var¬†pages¬†=¬†$(this).data('zpm-pages'); |
| [3596](#L3596) |  |
| [3597](#L3597) | $(this).data('zpm-page',¬†zpm\_members\_paged); |
| [3598](#L3598) | if¬†(zpm\_members\_paged¬†<¬†pages)¬†{ |
| [3599](#L3599) | zpm\_members\_paged++; |
| [3600](#L3600) | ZephyrProjects.notification(zpm\_localized.strings.loading); |
| [3601](#L3601) | ZephyrProjects.ajax({ |
| [3602](#L3602) | action:¬†'zpm\_get\_members', |
| [3603](#L3603) | page:¬†zpm\_members\_paged, |
| [3604](#L3604) | limit:¬†10 |
| [3605](#L3605) | },¬†function¬†(response)¬†{ |
| [3606](#L3606) | var¬†html¬†=¬†''; |
| [3607](#L3607) | response.forEach(function¬†(member)¬†{ |
| [3608](#L3608) | html¬†+=¬†member.list\_html; |
| [3609](#L3609) | }); |
| [3610](#L3610) | $('#zpm-member-list\_\_table').html(html); |
| [3611](#L3611) | ZephyrProjects.remove\_notifications(); |
| [3612](#L3612) | }); |
| [3613](#L3613) | $('#zpm-members-pagination\_\_previous').removeAttr('disabled'); |
| [3614](#L3614) | if¬†(zpm\_members\_paged¬†==¬†pages)¬†{ |
| [3615](#L3615) | $(this).attr('disabled',¬†'disabled'); |
| [3616](#L3616) | }¬†else¬†{ |
| [3617](#L3617) | $(this).removeAttr('disabled'); |
| [3618](#L3618) | } |
| [3619](#L3619) | }¬†else¬†{ |
| [3620](#L3620) | $(this).attr('disabled',¬†'disabled'); |
| [3621](#L3621) | } |
| [3622](#L3622) | }); |
| [3623](#L3623) |  |
| [3624](#L3624) | $('body').on('click',¬†'#zpm-members-pagination\_\_previous',¬†function¬†(e)¬†{ |
| [3625](#L3625) | var¬†pages¬†=¬†$('#zpm-members-pagination\_\_next').data('zpm-pages'); |
| [3626](#L3626) |  |
| [3627](#L3627) | $('#zpm-members-pagination\_\_next').data('zpm-page',¬†zpm\_members\_paged); |
| [3628](#L3628) | if¬†(zpm\_members\_paged¬†>¬†1)¬†{ |
| [3629](#L3629) | zpm\_members\_paged--; |
| [3630](#L3630) | ZephyrProjects.notification(zpm\_localized.strings.loading); |
| [3631](#L3631) | ZephyrProjects.ajax({ |
| [3632](#L3632) | action:¬†'zpm\_get\_members', |
| [3633](#L3633) | page:¬†zpm\_members\_paged, |
| [3634](#L3634) | limit:¬†10 |
| [3635](#L3635) | },¬†function¬†(response)¬†{ |
| [3636](#L3636) | var¬†html¬†=¬†''; |
| [3637](#L3637) | response.forEach(function¬†(member)¬†{ |
| [3638](#L3638) | html¬†+=¬†member.list\_html; |
| [3639](#L3639) | }); |
| [3640](#L3640) | ZephyrProjects.remove\_notifications(); |
| [3641](#L3641) | $('#zpm-member-list\_\_table').html(html); |
| [3642](#L3642) | }); |
| [3643](#L3643) | $('#zpm-members-pagination\_\_next').removeAttr('disabled'); |
| [3644](#L3644) | if¬†(zpm\_members\_paged¬†==¬†1)¬†{ |
| [3645](#L3645) | $(this).attr('disabled',¬†'disabled'); |
| [3646](#L3646) | }¬†else¬†{ |
| [3647](#L3647) | $(this).removeAttr('disabled'); |
| [3648](#L3648) | } |
| [3649](#L3649) | }¬†else¬†{ |
| [3650](#L3650) | $(this).attr('disabled',¬†'disabled'); |
| [3651](#L3651) | } |
| [3652](#L3652) | }); |
| [3653](#L3653) |  |
| [3654](#L3654) | $('body').on('click',¬†'.zpm-members-pagination\_\_page',¬†function¬†(e)¬†{ |
| [3655](#L3655) | var¬†thisBtn¬†=¬†$(this); |
| [3656](#L3656) | var¬†page¬†=¬†$(this).data('page'); |
| [3657](#L3657) | zpm\_members\_paged¬†=¬†page; |
| [3658](#L3658) |  |
| [3659](#L3659) | jQuery('.zpm-members-pagination\_\_page').removeAttr('disabled'); |
| [3660](#L3660) |  |
| [3661](#L3661) | //$(this).data('zpm-page', zpm\_members\_paged); |
| [3662](#L3662) |  |
| [3663](#L3663) | ZephyrProjects.notification(zpm\_localized.strings.loading); |
| [3664](#L3664) | ZephyrProjects.ajax({ |
| [3665](#L3665) | action:¬†'zpm\_get\_members', |
| [3666](#L3666) | page:¬†page, |
| [3667](#L3667) | limit:¬†10 |
| [3668](#L3668) | },¬†function¬†(response)¬†{ |
| [3669](#L3669) | var¬†html¬†=¬†''; |
| [3670](#L3670) | response.forEach(function¬†(member)¬†{ |
| [3671](#L3671) | html¬†+=¬†member.list\_html; |
| [3672](#L3672) | }); |
| [3673](#L3673) | $('#zpm-member-list\_\_table').html(html); |
| [3674](#L3674) | ZephyrProjects.remove\_notifications(); |
| [3675](#L3675) | thisBtn.attr('disabled',¬†'disabled'); |
| [3676](#L3676) | }); |
| [3677](#L3677) |  |
| [3678](#L3678) | }); |
| [3679](#L3679) |  |
| [3680](#L3680) | var¬†doughnut\_chart; |
| [3681](#L3681) | var¬†zpm\_project\_doughnut\_data; |
| [3682](#L3682) |  |
| [3683](#L3683) | // If we are viewing a single project |
| [3684](#L3684) | if¬†(zpm\_localized.current\_project¬†!==¬†"-1")¬†{ |
| [3685](#L3685) | ZephyrProjects.ajax({ |
| [3686](#L3686) | action:¬†'zpm\_get\_project\_members', |
| [3687](#L3687) | project\_id:¬†zpm\_localized.current\_project |
| [3688](#L3688) | },¬†function¬†(response)¬†{ |
| [3689](#L3689) | if¬†(typeof¬†response.forEach¬†==¬†'function')¬†{ |
| [3690](#L3690) | response.forEach(function¬†(user\_id)¬†{ |
| [3691](#L3691) | ZephyrProjects.ajax({ |
| [3692](#L3692) | action:¬†'zpm\_get\_user\_progress', |
| [3693](#L3693) | user\_id:¬†user\_id, |
| [3694](#L3694) | project\_id:¬†zpm\_localized.current\_project |
| [3695](#L3695) | },¬†function¬†(response)¬†{ |
| [3696](#L3696) | var¬†member¬†=¬†$('.zpm-project-progress\_\_member[data-user-id="'¬†+¬†user\_id¬†+¬†'"]'); |
| [3697](#L3697) | var¬†percent¬†=¬†Math.round(parseInt(response.percent\_complete)); |
| [3698](#L3698) |  |
| [3699](#L3699) | member.find('.zpm-progress-member\_\_percent').text(percent¬†+¬†'%'); |
| [3700](#L3700) | if¬†(percent¬†>=¬†100)¬†{ |
| [3701](#L3701) | member.addClass('zpm-green'); |
| [3702](#L3702) | } |
| [3703](#L3703) | if¬†(percent¬†<¬†100)¬†{ |
| [3704](#L3704) | member.addClass('zpm-yellow-green'); |
| [3705](#L3705) | } |
| [3706](#L3706) | if¬†(percent¬†<¬†75)¬†{ |
| [3707](#L3707) | member.addClass('zpm-yellow'); |
| [3708](#L3708) | } |
| [3709](#L3709) | if¬†(percent¬†<¬†50)¬†{ |
| [3710](#L3710) | member.addClass('zpm-yellow-orange'); |
| [3711](#L3711) | } |
| [3712](#L3712) | if¬†(percent¬†<¬†25)¬†{ |
| [3713](#L3713) | member.addClass('zpm-orange'); |
| [3714](#L3714) | } |
| [3715](#L3715) | if¬†(percent¬†<=¬†0)¬†{ |
| [3716](#L3716) | member.addClass('zpm-red'); |
| [3717](#L3717) | } |
| [3718](#L3718) |  |
| [3719](#L3719) | if¬†(parseInt(response.tasks\_total)¬†<=¬†0)¬†{ |
| [3720](#L3720) | member.addClass('zpm-no-tasks'); |
| [3721](#L3721) | } |
| [3722](#L3722) |  |
| [3723](#L3723) | member.find('.zpm-project-progress\_\_member-details').html(response.html); |
| [3724](#L3724) | }); |
| [3725](#L3725) | }); |
| [3726](#L3726) | } |
| [3727](#L3727) | }); |
| [3728](#L3728) |  |
| [3729](#L3729) | ZephyrProjects.ajax({ |
| [3730](#L3730) | action:¬†'zpm\_project\_task\_progress', |
| [3731](#L3731) | project\_id:¬†zpm\_localized.current\_project |
| [3732](#L3732) | },¬†function¬†(response)¬†{ |
| [3733](#L3733) | var¬†zpm\_progress\_chart¬†=¬†document.getElementById("zpm-project-chart\_\_doughnut"); |
| [3734](#L3734) | var¬†completed\_projects¬†=¬†response.completed; |
| [3735](#L3735) | var¬†pending\_projects¬†=¬†response.pending; |
| [3736](#L3736) | var¬†overdue\_tasks¬†=¬†response.overdue; |
| [3737](#L3737) | const¬†labels¬†=¬†[ |
| [3738](#L3738) | // zpm\_localized.strings.completed\_tasks, |
| [3739](#L3739) | zpm\_localized.strings.pending\_tasks, |
| [3740](#L3740) | zpm\_localized.strings.overdue\_tasks |
| [3741](#L3741) | ]; |
| [3742](#L3742) | const¬†colors¬†=¬†[ |
| [3743](#L3743) | // '#00bc8a', |
| [3744](#L3744) | "#6500d8", |
| [3745](#L3745) | "#e8005c", |
| [3746](#L3746) | ]; |
| [3747](#L3747) | // const data = [completed\_projects, pending\_projects, overdue\_tasks]; |
| [3748](#L3748) | const¬†data¬†=¬†[pending\_projects,¬†overdue\_tasks]; |
| [3749](#L3749) |  |
| [3750](#L3750) | jQuery.each(response.statuses,¬†function(index,¬†status)¬†{ |
| [3751](#L3751) | labels.push(status.name); |
| [3752](#L3752) | colors.push(status.color); |
| [3753](#L3753) | data.push(status.tasks); |
| [3754](#L3754) | }); |
| [3755](#L3755) |  |
| [3756](#L3756) | zpm\_project\_doughnut\_data¬†=¬†{ |
| [3757](#L3757) | labels:¬†labels, |
| [3758](#L3758) | datasets:¬†[{ |
| [3759](#L3759) | data:¬†data, |
| [3760](#L3760) | backgroundColor:¬†colors, |
| [3761](#L3761) | borderWidth:¬†0 |
| [3762](#L3762) | }] |
| [3763](#L3763) | }; |
| [3764](#L3764) |  |
| [3765](#L3765) | var¬†chart\_options¬†=¬†{ |
| [3766](#L3766) | cutout:¬†95, |
| [3767](#L3767) | legend:¬†{ |
| [3768](#L3768) | position:¬†'bottom' |
| [3769](#L3769) | }, |
| [3770](#L3770) | animation:¬†{ |
| [3771](#L3771) | animateRotate:¬†true, |
| [3772](#L3772) | animateScale:¬†true |
| [3773](#L3773) | } |
| [3774](#L3774) | }; |
| [3775](#L3775) |  |
| [3776](#L3776) | chart\_options.tooltips¬†=¬†{ |
| [3777](#L3777) | yAlign:¬†'bottom', |
| [3778](#L3778) | callbacks:¬†{ |
| [3779](#L3779) | labelColor:¬†function¬†(tooltipItem,¬†chart)¬†{ |
| [3780](#L3780) | return¬†{ |
| [3781](#L3781) | backgroundColor:¬†'rgba(20, 170, 245, .7)', |
| [3782](#L3782) | color:¬†'rgb(255,255,255)' |
| [3783](#L3783) | }; |
| [3784](#L3784) | }, |
| [3785](#L3785) | labelTextColor:¬†function¬†(tooltipItem,¬†chart)¬†{ |
| [3786](#L3786) | return¬†'#fff'; |
| [3787](#L3787) | }, |
| [3788](#L3788) | labelChartColor:¬†function¬†(tooltipItem,¬†chart)¬†{ |
| [3789](#L3789) | return¬†{ |
| [3790](#L3790) | backgroundColor:¬†'rgba(20, 170, 245, .7)', |
| [3791](#L3791) | color:¬†'rgb(255,255,255)' |
| [3792](#L3792) | }; |
| [3793](#L3793) | }, |
| [3794](#L3794) | labelTextChartColor:¬†function¬†(tooltipItem,¬†chart)¬†{ |
| [3795](#L3795) | return¬†"rgb(255,255,255)"; |
| [3796](#L3796) | }, |
| [3797](#L3797) | }, |
| [3798](#L3798) | }; |
| [3799](#L3799) | if¬†(zpm\_progress\_chart¬†!==¬†null)¬†{ |
| [3800](#L3800) | doughnut\_chart¬†=¬†new¬†Chart(zpm\_progress\_chart,¬†{ |
| [3801](#L3801) | type:¬†'doughnut', |
| [3802](#L3802) | data:¬†zpm\_project\_doughnut\_data, |
| [3803](#L3803) | options:¬†chart\_options |
| [3804](#L3804) | }); |
| [3805](#L3805) | } |
| [3806](#L3806) | }); |
| [3807](#L3807) | } |
| [3808](#L3808) |  |
| [3809](#L3809) | $('#zpm-project-chart\_\_filter').on('change',¬†function¬†()¬†{ |
| [3810](#L3810) | var¬†user\_id¬†=¬†$(this).val(); |
| [3811](#L3811) |  |
| [3812](#L3812) | ZephyrProjects.ajax({ |
| [3813](#L3813) | action:¬†'zpm\_get\_user\_progress', |
| [3814](#L3814) | project\_id:¬†zpm\_localized.current\_project, |
| [3815](#L3815) | user\_id:¬†user\_id |
| [3816](#L3816) | },¬†function¬†(response)¬†{ |
| [3817](#L3817) | zpm\_project\_doughnut\_data¬†=¬†{ |
| [3818](#L3818) | labels:¬†[ |
| [3819](#L3819) | zpm\_localized.strings.completed\_tasks, |
| [3820](#L3820) | zpm\_localized.strings.pending\_tasks, |
| [3821](#L3821) | zpm\_localized.strings.overdue\_tasks |
| [3822](#L3822) | ], |
| [3823](#L3823) | datasets:¬†[{ |
| [3824](#L3824) | data:¬†[response.completed,¬†response.pending,¬†response.overdue], |
| [3825](#L3825) | backgroundColor:¬†[ |
| [3826](#L3826) | '#00bc8a', |
| [3827](#L3827) | "#6500d8", |
| [3828](#L3828) | "#e8005c", |
| [3829](#L3829) | ], |
| [3830](#L3830) | borderWidth:¬†0 |
| [3831](#L3831) | }] |
| [3832](#L3832) | }; |
| [3833](#L3833) | doughnut\_chart.data¬†=¬†zpm\_project\_doughnut\_data; |
| [3834](#L3834) | doughnut\_chart.update(); |
| [3835](#L3835) | }); |
| [3836](#L3836) | }); |
| [3837](#L3837) |  |
| [3838](#L3838) | // Pagination of projects |
| [3839](#L3839) | var¬†projectsPage¬†=¬†ZephyrProjects.getUrlParam('projects\_page'); |
| [3840](#L3840) | var¬†zpmProjectsTotal¬†=¬†100; |
| [3841](#L3841) | var¬†zpmProjectsPage¬†=¬†projectsPage¬†?¬†projectsPage¬†:¬†1; |
| [3842](#L3842) | var¬†zpmProjectsPerPage¬†=¬†zpm\_localized.settings.projects\_per\_page; |
| [3843](#L3843) |  |
| [3844](#L3844) | $('.zpm-projects-pagination\_\_page').on('click',¬†function¬†()¬†{ |
| [3845](#L3845) | var¬†page¬†=¬†$(this).data('page'); |
| [3846](#L3846) | zpmProjectsPage¬†=¬†page; |
| [3847](#L3847) |  |
| [3848](#L3848) | if¬†(zpmProjectsPage¬†<=¬†zpmProjectsTotal)¬†{ |
| [3849](#L3849) | $(this).addClass('zpm-pagination\_\_current-page'); |
| [3850](#L3850) | $('.zpm-projects-pagination\_\_page').not(this).removeClass('zpm-pagination\_\_current-page'); |
| [3851](#L3851) | ZephyrProjects.paginateProjects(zpmProjectsPage,¬†zpmProjectsPerPage,¬†false); |
| [3852](#L3852) | }¬†else¬†{ |
| [3853](#L3853) | } |
| [3854](#L3854) | }); |
| [3855](#L3855) |  |
| [3856](#L3856) | // Deprecated next and prev |
| [3857](#L3857) | // $('.zpm-projects-next').on('click', function(){ |
| [3858](#L3858) |  |
| [3859](#L3859) | //¬† ¬† ¬† zpmProjectsPage++; |
| [3860](#L3860) |  |
| [3861](#L3861) | //¬† ¬† ¬† if (zpmProjectsPage <= zpmProjectsTotal) { |
| [3862](#L3862) | //¬† ¬† ¬† ¬† ¬† ¬† ¬† ZephyrProjects.paginateProjects( zpmProjectsPage, zpmProjectsPerPage, false ); |
| [3863](#L3863) | //¬† ¬† ¬† ¬† ¬† ¬† ¬† $('.zpm-projects-previous').removeAttr('disabled'); |
| [3864](#L3864) | //¬† ¬† ¬† ¬† ¬† ¬† ¬† if (zpmProjectsPage == zpmProjectsTotal) { |
| [3865](#L3865) | //¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† $(this).attr('disabled', 'disabled'); |
| [3866](#L3866) | //¬† ¬† ¬† ¬† ¬† ¬† ¬† } else { |
| [3867](#L3867) | //¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† $(this).removeAttr('disabled'); |
| [3868](#L3868) | //¬† ¬† ¬† ¬† ¬† ¬† ¬† } |
| [3869](#L3869) | //¬† ¬† ¬† } else { |
| [3870](#L3870) | //¬† ¬† ¬† ¬† ¬† ¬† ¬† alert('No more pages'); |
| [3871](#L3871) | //¬† ¬† ¬† } |
| [3872](#L3872) |  |
| [3873](#L3873) | // }); |
| [3874](#L3874) |  |
| [3875](#L3875) | // $('.zpm-projects-previous').on('click', function(){ |
| [3876](#L3876) | //¬† ¬† ¬† zpmProjectsPage--; |
| [3877](#L3877) | //¬† ¬† ¬† if (zpmProjectsPage > 0) { |
| [3878](#L3878) | //¬† ¬† ¬† ¬† ¬† ¬† ¬† ZephyrProjects.paginateProjects( zpmProjectsPage, zpmProjectsPerPage, false ); |
| [3879](#L3879) | //¬† ¬† ¬† ¬† ¬† ¬† ¬† $('.zpm-projects-next').removeAttr('disabled'); |
| [3880](#L3880) | //¬† ¬† ¬† ¬† ¬† ¬† ¬† if (zpmProjectsPage == 1) { |
| [3881](#L3881) | //¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† $(this).attr('disabled', 'disabled'); |
| [3882](#L3882) | //¬† ¬† ¬† ¬† ¬† ¬† ¬† } else { |
| [3883](#L3883) | //¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† $(this).removeAttr('disabled'); |
| [3884](#L3884) | //¬† ¬† ¬† ¬† ¬† ¬† ¬† } |
| [3885](#L3885) | //¬† ¬† ¬† } else { |
| [3886](#L3886) | //¬† ¬† ¬† ¬† ¬† ¬† ¬† alert('No more pages'); |
| [3887](#L3887) | //¬† ¬† ¬† } |
| [3888](#L3888) | // }); |
| [3889](#L3889) |  |
| [3890](#L3890) | $('.zpm-project-view\_\_option').on('click',¬†function¬†()¬†{ |
| [3891](#L3891) | var¬†view¬†=¬†$(this).data('view'); |
| [3892](#L3892) | $(this).addClass('zpm-state\_\_active'); |
| [3893](#L3893) | $('.zpm-project-view\_\_option').not(this).removeClass('zpm-state\_\_active'); |
| [3894](#L3894) |  |
| [3895](#L3895) | ZephyrProjects.updateProjectView(view); |
| [3896](#L3896) |  |
| [3897](#L3897) | switch¬†(view)¬†{ |
| [3898](#L3898) | case¬†'grid': |
| [3899](#L3899) | $('#zpm\_project\_list').removeClass('zpm-project-view\_\_list'); |
| [3900](#L3900) | break; |
| [3901](#L3901) | case¬†'list': |
| [3902](#L3902) | $('#zpm\_project\_list').addClass('zpm-project-view\_\_list'); |
| [3903](#L3903) | break; |
| [3904](#L3904) | default: |
| [3905](#L3905) | break; |
| [3906](#L3906) | } |
| [3907](#L3907) | }); |
| [3908](#L3908) |  |
| [3909](#L3909) | $('.zpm-toggle-state').on('click',¬†function¬†()¬†{ |
| [3910](#L3910) | $(this).toggleClass('zpm-state\_\_active'); |
| [3911](#L3911) | }); |
| [3912](#L3912) |  |
| [3913](#L3913) | $('#zpm-project-view\_\_archived').on('click',¬†function¬†()¬†{ |
| [3914](#L3914) | var¬†filter¬†=¬†'-1'; |
| [3915](#L3915) | if¬†($(this).hasClass('zpm-state\_\_active'))¬†{ |
| [3916](#L3916) | // Show all |
| [3917](#L3917) | filter¬†=¬†'archived'; |
| [3918](#L3918) | }¬†else¬†{ |
| [3919](#L3919) | } |
| [3920](#L3920) | var¬†title¬†=¬†$('#zpm-project-view\_\_title'); |
| [3921](#L3921) | title.text(zpm\_localized.strings.loading); |
| [3922](#L3922) |  |
| [3923](#L3923) | ZephyrProjects.filter\_projects({ |
| [3924](#L3924) | zpm\_filter:¬†filter, |
| [3925](#L3925) | zpm\_user\_id:¬†zpm\_localized.user\_id |
| [3926](#L3926) | },¬†function¬†(response)¬†{ |
| [3927](#L3927) | if¬†(filter¬†==¬†'archived')¬†{ |
| [3928](#L3928) | title.text(zpm\_localized.strings.archived\_projects); |
| [3929](#L3929) | }¬†else¬†{ |
| [3930](#L3930) | title.text(zpm\_localized.strings.all\_projects); |
| [3931](#L3931) | } |
| [3932](#L3932) | $('body').find('.zpm\_project\_grid').html(response.html); |
| [3933](#L3933) | //zpm\_close\_loader\_modal(); |
| [3934](#L3934) | $('.zpm\_project\_progress\_bar').each(function¬†()¬†{ |
| [3935](#L3935) | var¬†total\_tasks¬†=¬†$(this).data('total\_tasks'); |
| [3936](#L3936) | var¬†completed\_tasks¬†=¬†$(this).data('completed\_tasks'); |
| [3937](#L3937) | var¬†width¬†=¬†(total\_tasks¬†!==¬†0)¬†?¬†((completed\_tasks¬†/¬†total\_tasks)¬†\*¬†100)¬†:¬†0; |
| [3938](#L3938) | $(this).css('width',¬†width¬†+¬†'%'); |
| [3939](#L3939) | }); |
| [3940](#L3940) | }); |
| [3941](#L3941) | }); |
| [3942](#L3942) |  |
| [3943](#L3943) | $('body').on('click',¬†'.zpm\_project\_item',¬†function¬†(e)¬†{ |
| [3944](#L3944) |  |
| [3945](#L3945) | }); |
| [3946](#L3946) |  |
| [3947](#L3947) | var¬†category\_id¬†=¬†ZephyrProjects.getUrlParam('category\_id'); |
| [3948](#L3948) | ZephyrProjects.ajax({ |
| [3949](#L3949) | action:¬†'zpm\_get\_available\_project\_count', |
| [3950](#L3950) | user\_id:¬†zpm\_localized.user\_id, |
| [3951](#L3951) | category\_id:¬†category\_id, |
| [3952](#L3952) | },¬†function¬†(response)¬†{ |
| [3953](#L3953) | zpmProjectsTotal¬†=¬†response.count; |
| [3954](#L3954) | }); |
| [3955](#L3955) |  |
| [3956](#L3956) | // Recurrence selection changed |
| [3957](#L3957) | $('#zpm-new-task\_\_recurrence-select').on('change',¬†function¬†()¬†{ |
| [3958](#L3958) | var¬†val¬†=¬†$(this).val(); |
| [3959](#L3959) | $('.zpm-new-task\_\_recurrence-section').hide(); |
| [3960](#L3960) | $('.zpm-new-task\_\_recurrence-section[data-section="'¬†+¬†val¬†+¬†'"]').show(); |
| [3961](#L3961) | }); |
| [3962](#L3962) |  |
| [3963](#L3963) | // Recurrence selection changed |
| [3964](#L3964) | $('#zpm-edit-task\_\_recurrence-select').on('change',¬†function¬†()¬†{ |
| [3965](#L3965) | var¬†val¬†=¬†$(this).val(); |
| [3966](#L3966) | $('.zpm-edit-task\_\_recurrence-section').hide(); |
| [3967](#L3967) | $('.zpm-edit-task\_\_recurrence-section[data-section="'¬†+¬†val¬†+¬†'"]').show(); |
| [3968](#L3968) | }); |
| [3969](#L3969) |  |
| [3970](#L3970) | var¬†currentProjectDescription¬†=¬†$('#zpm\_edit\_project\_description').val(); |
| [3971](#L3971) | $('#zpm\_chat\_message, #zpm\_edit\_project\_description').mentionsInput({ |
| [3972](#L3972) | elastic:¬†false, |
| [3973](#L3973) | onDataRequest:¬†function¬†(mode,¬†query,¬†callback)¬†{ |
| [3974](#L3974) | ZephyrProjects.ajax({ |
| [3975](#L3975) | action:¬†'zpm\_getUserData' |
| [3976](#L3976) | },¬†function¬†(responseData)¬†{ |
| [3977](#L3977) | responseData¬†=¬†\_.filter(responseData,¬†function¬†(item)¬†{¬†return¬†item.name.toLowerCase().indexOf(query.toLowerCase())¬†!==¬†-1;¬†}); |
| [3978](#L3978) | callback.call(this,¬†responseData); |
| [3979](#L3979) | }); |
| [3980](#L3980) | } |
| [3981](#L3981) | }); |
| [3982](#L3982) | $('#zpm\_edit\_project\_description').val(currentProjectDescription); |
| [3983](#L3983) |  |
| [3984](#L3984) | jQuery(document).on('zpm.task\_window\_loaded',¬†function¬†(res)¬†{ |
| [3985](#L3985) | $('#zpm\_task\_view\_container #zpm\_chat\_message').mentionsInput({ |
| [3986](#L3986) | elastic:¬†false, |
| [3987](#L3987) | onDataRequest:¬†function¬†(mode,¬†query,¬†callback)¬†{ |
| [3988](#L3988) | ZephyrProjects.ajax({ |
| [3989](#L3989) | action:¬†'zpm\_getUserData' |
| [3990](#L3990) | },¬†function¬†(responseData)¬†{ |
| [3991](#L3991) | responseData¬†=¬†\_.filter(responseData,¬†function¬†(item)¬†{¬†return¬†item.name.toLowerCase().indexOf(query.toLowerCase())¬†!==¬†-1;¬†}); |
| [3992](#L3992) | callback.call(this,¬†responseData); |
| [3993](#L3993) | }); |
| [3994](#L3994) | } |
| [3995](#L3995) | }); |
| [3996](#L3996) | }); |
| [3997](#L3997) | //$('#zpm\_edit\_project\_description').val(currentProjectDescription); |
| [3998](#L3998) |  |
| [3999](#L3999) | // Delete all Zephyr data |
| [4000](#L4000) | jQuery('body').on('click',¬†'#zpm-delete-data\_\_button',¬†function¬†()¬†{ |
| [4001](#L4001) | ZephyrProjects.confirm\_modal('Delete All Zephyr Data',¬†'Are you sure that you would like to permanently delele ALL your Zephyr Project Manager data including Tasks, Projects, Categories, Files, Messages and settings? This action cannot be undone.',¬†'Delete',¬†function¬†()¬†{ |
| [4002](#L4002) | jQuery('#zpm-delete-data\_\_form button').click(); |
| [4003](#L4003) | }); |
| [4004](#L4004) | }); |
| [4005](#L4005) |  |
| [4006](#L4006) | jQuery('body').on('click',¬†'.zpm-import-projects\_\_btn',¬†function¬†()¬†{ |
| [4007](#L4007) | ZephyrProjects.projectImporter(); |
| [4008](#L4008) | }); |
| [4009](#L4009) |  |
| [4010](#L4010) | jQuery('body').on('click',¬†'.zpm-import-tasks\_\_btn',¬†function¬†()¬†{ |
| [4011](#L4011) | ZephyrProjects.taskImporter(); |
| [4012](#L4012) | }); |
| [4013](#L4013) |  |
| [4014](#L4014) | jQuery('body').on('click',¬†'#zpm-members\_\_bulk-access-btn',¬†function¬†()¬†{ |
| [4015](#L4015) | ZephyrProjects.memberPicker({ |
| [4016](#L4016) | multiple:¬†true, |
| [4017](#L4017) | buttons:¬†[ |
| [4018](#L4018) | { |
| [4019](#L4019) | text:¬†'Remove Access', |
| [4020](#L4020) | id:¬†'zpm-members-muli\_\_remove', |
| [4021](#L4021) | callback:¬†function¬†(members)¬†{ |
| [4022](#L4022) | if¬†(typeof¬†members¬†!==¬†'undefined')¬†{ |
| [4023](#L4023) | members.forEach(function¬†(member)¬†{ |
| [4024](#L4024) | var¬†userID¬†=¬†member.id; |
| [4025](#L4025) | ZephyrProjects.updateUserAccess({¬†user\_id:¬†userID,¬†access:¬†false¬†},¬†function¬†(res)¬†{ |
| [4026](#L4026) | ZephyrProjects.notification(zpm\_localized.strings.access\_updated); |
| [4027](#L4027) | window.location.reload(); |
| [4028](#L4028) | }); |
| [4029](#L4029) | }); |
| [4030](#L4030) | } |
| [4031](#L4031) | } |
| [4032](#L4032) | }, |
| [4033](#L4033) | { |
| [4034](#L4034) | text:¬†'Allow Access', |
| [4035](#L4035) | id:¬†'zpm-members-muli\_\_add', |
| [4036](#L4036) | callback:¬†function¬†(members)¬†{ |
| [4037](#L4037) | if¬†(typeof¬†members¬†!==¬†'undefined')¬†{ |
| [4038](#L4038) | ZephyrProjects.updateUserAccess({¬†user\_id:¬†members,¬†access:¬†true¬†},¬†function¬†(res)¬†{ |
| [4039](#L4039) | ZephyrProjects.notification(zpm\_localized.strings.access\_updated); |
| [4040](#L4040) | window.location.reload(); |
| [4041](#L4041) | }); |
| [4042](#L4042) | } |
| [4043](#L4043) | } |
| [4044](#L4044) | } |
| [4045](#L4045) | ] |
| [4046](#L4046) | },¬†function¬†(data)¬†{ |
| [4047](#L4047) | }); |
| [4048](#L4048) | }); |
| [4049](#L4049) | }); |
| [4050](#L4050) |  |
| [4051](#L4051) | function¬†filterCalendarTasks()¬†{ |
| [4052](#L4052) | var¬†project¬†=¬†jQuery('#zpm-calendar\_\_filter-project').val(); |
| [4053](#L4053) | zpm\_calendar.fullCalendar('rerenderEvents'); |
| [4054](#L4054) | } |
| [4055](#L4055) |  |
| [4056](#L4056) | function¬†zpmGetTaskFilters()¬†{ |
| [4057](#L4057) | const¬†$tab¬†=¬†jQuery('body').find('.zpm\_nav\_item\_selected[data-zpm-filter]'); |
| [4058](#L4058) | var¬†tab¬†=¬†$tab.data('zpm-filter'); |
| [4059](#L4059) |  |
| [4060](#L4060) | if¬†(tab¬†==¬†'0')¬†tab¬†=¬†'my\_tasks'; |
| [4061](#L4061) | if¬†(tab¬†==¬†'-1')¬†tab¬†=¬†'all'; |
| [4062](#L4062) | if¬†(tab¬†==¬†'1')¬†tab¬†=¬†'active'; |
| [4063](#L4063) | if¬†(tab¬†==¬†'2')¬†tab¬†=¬†'completed'; |
| [4064](#L4064) |  |
| [4065](#L4065) | console.log(tab); |
| [4066](#L4066) |  |
| [4067](#L4067) | const¬†assignee¬†=¬†jQuery('body').find('#zpm-tasks-assignee-filter').val(); |
| [4068](#L4068) | const¬†sorting¬†=¬†jQuery('body').find('[data-task-filter="sort"]').val(); |
| [4069](#L4069) | const¬†status¬†=¬†jQuery('body').find('[data-filter-tasks-status]').val(); |
| [4070](#L4070) | const¬†project¬†=¬†jQuery('body').find('#zpm-tasks-project-filter').val(); |
| [4071](#L4071) |  |
| [4072](#L4072) | return¬†{ |
| [4073](#L4073) | tab,¬†assignee,¬†sorting,¬†status,¬†project |
| [4074](#L4074) | }; |
| [4075](#L4075) | } |
| [4076](#L4076) |  |
| [4077](#L4077) | function¬†zpmFilterTasks()¬†{ |
| [4078](#L4078) | const¬†filters¬†=¬†zpmGetTaskFilters(); |
| [4079](#L4079) | const¬†$taskContainer¬†=¬†jQuery('body').find('#zpm-task-list\_\_tasks'); |
| [4080](#L4080) |  |
| [4081](#L4081) | $taskContainer.html('<p class="zpm\_error\_message">'¬†+¬†zpm\_localized.strings.loading¬†+¬†'</p>'); |
| [4082](#L4082) | console.log('zpm/task/filters',¬†filters); |
| [4083](#L4083) | ZephyrProjects.ajax({ |
| [4084](#L4084) | action:¬†'zpm\_filterTasks', |
| [4085](#L4085) | frontend:¬†false, |
| [4086](#L4086) | filters |
| [4087](#L4087) | },¬†function(res)¬†{ |
| [4088](#L4088) | console.log('zpm/task/filters/res',¬†res.data,¬†res.data.length); |
| [4089](#L4089) | $taskContainer.html(res.data.html); |
| [4090](#L4090) | }); |
| [4091](#L4091) | } |

**Note:** See [TracBrowser](/wiki/TracBrowser)
for help on using the repository browser.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Plain Text](/browser/zephyr-project-manager/trunk/assets/js/core-admin.js?format=txt)
* [Original Format](/export/3220505/zephyr-project-manager/trunk/assets/js/core-admin.js)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)


