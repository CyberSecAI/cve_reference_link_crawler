

| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=5d5f1a7f3b1039925f79c7894f153c2a905201fb)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=5d5f1a7f3b1039925f79c7894f153c2a905201fb)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=5d5f1a7f3b1039925f79c7894f153c2a905201fb)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=5d5f1a7f3b1039925f79c7894f153c2a905201fb)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Philip Yang <Philip.Yang@amd.com> | 2024-03-11 18:07:34 -0400 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-04-10 16:18:43 +0200 |
| commit | [5d5f1a7f3b1039925f79c7894f153c2a905201fb](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=5d5f1a7f3b1039925f79c7894f153c2a905201fb) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=5d5f1a7f3b1039925f79c7894f153c2a905201fb)) | |
| tree | [4a4e85133930d1bea0ee7e7e0bd8ef8405ecab3e](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=5d5f1a7f3b1039925f79c7894f153c2a905201fb) | |
| parent | [d69abe190a5f2a4cf547f758d8df2fcbcb3cbdfe](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=d69abe190a5f2a4cf547f758d8df2fcbcb3cbdfe) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=5d5f1a7f3b1039925f79c7894f153c2a905201fb&id2=d69abe190a5f2a4cf547f758d8df2fcbcb3cbdfe)) | |
| download | [linux-5d5f1a7f3b1039925f79c7894f153c2a905201fb.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-5d5f1a7f3b1039925f79c7894f153c2a905201fb.tar.gz) | |

drm/amdgpu: amdgpu\_ttm\_gart\_bind set gtt bound flag[ Upstream commit 6c6064cbe58b43533e3451ad6a8ba9736c109ac3 ]
Otherwise after the GTT bo is released, the GTT and gart space is freed
but amdgpu\_ttm\_backend\_unbind will not clear the gart page table entry
and leave valid mapping entry pointing to the stale system page. Then
if GPU access the gart address mistakely, it will read undefined value
instead page fault, harder to debug and reproduce the real issue.
Cc: stable@vger.kernel.org
Signed-off-by: Philip Yang <Philip.Yang@amd.com>
Reviewed-by: Christian KÃ¶nig <christian.koenig@amd.com>
Signed-off-by: Alex Deucher <alexander.deucher@amd.com>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=5d5f1a7f3b1039925f79c7894f153c2a905201fb)

| -rw-r--r-- | [drivers/gpu/drm/amd/amdgpu/amdgpu\_ttm.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/gpu/drm/amd/amdgpu/amdgpu_ttm.c?id=5d5f1a7f3b1039925f79c7894f153c2a905201fb) | 1 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 1 insertions, 0 deletions

| diff --git a/drivers/gpu/drm/amd/amdgpu/amdgpu\_ttm.c b/drivers/gpu/drm/amd/amdgpu/amdgpu\_ttm.cindex b06fb1fa411b42..9a1b19e3d43789 100644--- a/[drivers/gpu/drm/amd/amdgpu/amdgpu\_ttm.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/gpu/drm/amd/amdgpu/amdgpu_ttm.c?id=d69abe190a5f2a4cf547f758d8df2fcbcb3cbdfe)+++ b/[drivers/gpu/drm/amd/amdgpu/amdgpu\_ttm.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/gpu/drm/amd/amdgpu/amdgpu_ttm.c?id=5d5f1a7f3b1039925f79c7894f153c2a905201fb)@@ -859,6 +859,7 @@ static int amdgpu\_ttm\_gart\_bind(struct amdgpu\_device \*adev, r = amdgpu\_gart\_bind(adev, gtt->offset, ttm->num\_pages, gtt->ttm.dma\_address, flags); }+ gtt->bound = true;  gart\_bind\_fail: if (r) |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-10 21:59:51 +0000

