```text
{
  "vulnerability": {
    "root_cause": "The `IsLocalUrl` method in `StringsExtensions.cs` incorrectly validates URLs, specifically those starting with `//` or `~/` followed by control characters such as tabs, newlines, or carriage returns before the actual host.",
    "weaknesses": [
      "Improper validation of URLs.",
      "Insufficient checks for control characters in URLs."
    ],
    "impact": "An attacker can craft malicious URLs that are incorrectly identified as local, which can be used in open redirect attacks, potentially leading users to phishing sites.",
    "attack_vectors": "Crafting malicious URLs with control characters before the hostname.",
    "required_attacker_capabilities": "Ability to craft URLs with control characters. No specific position or user privileges required.",
    "additional_information": "The vulnerability is present in multiple methods: `DefaultIdentityServerInteractionService.GetAuthorizationContextAsync`, `DefaultIdentityServerInteractionService.IsValidReturnUrl`, `ServerUrlExtensions.GetIdentityServerRelativeUrl`, `ReturnUrlParser.ParseAsync`, `OidcReturnUrlParser.ParseAsync`, `ReturnUrlParser.IsValidReturnUrl`, and `OidcReturnUrlParser.IsValidReturnUrl`."
  },
  "affected_versions": {
    "Duende.IdentityServer": [
      "<= 7.0.5",
      "<= 6.3.9",
      "<= 6.2.4",
      "<= 6.1.7",
      "<= 6.0.4"
    ],
     "IdentityServer4": [
      "<= 4.1.2"
    ]
  },
 "patched_versions": {
    "Duende.IdentityServer": [
      "7.0.6",
      "6.3.10",
      "6.2.5",
      "6.1.8",
      "6.0.5"
    ]
  },
 "cwe": "CWE-601",
 "cvss_score": 4.7,
  "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:N/A:N"
}
```