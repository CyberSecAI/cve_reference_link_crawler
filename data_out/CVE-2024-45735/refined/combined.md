=== Content from advisory.splunk.com_4b4cad4b_20250110_125621.html ===
 [![ ](/assets/img/logo.svg)](https://www.splunk.com/)

* [Home](/)
* [Report a Vulnerability](/report)
* [FAQs](/faqs)
* [Mailing List](https://www.splunk.com/en_us/form/splunk-security-advisories-notification.html)

 Toggle menu

* [Home](/)
* [Report a Vulnerability](/report)
* [FAQs](/faqs)
* [Mailing List](https://www.splunk.com/en_us/form/splunk-security-advisories-notification.html)
# Improper Access Control for low-privileged user in Splunk Secure Gateway App

**Advisory ID:** SVD-2024-1005

**CVE ID:** [CVE-2024-45735](https://www.cve.org/CVERecord?id=CVE-2024-45735)

**Published:** 2024-10-14

**Last Update:** 2024-10-14

**CVSSv3.1 Score:** 4.3, Medium

**CVSSv3.1 Vector:** [CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N)

**CWE:** [CWE-284](https://cwe.mitre.org/data/definitions/284.html)

**Bug ID:** VULN-12960

## Description

In Splunk Enterprise versions below 9.2.3 and 9.1.6, and Splunk Secure Gateway versions on Splunk Cloud Platform versions below 3.4.259, 3.6.17, and 3.7.0, a low-privileged user that does not hold the “admin” or “power” Splunk roles can see App Key Value Store (KV Store) deployment configuration and public/private keys in the Splunk Secure Gateway App.

## Solution

Upgrade Splunk Enterprise to versions 9.3.0, 9.2.3, 9.1.6 or higher.

Splunk is actively monitoring Splunk Cloud Platform instances and upgrading Splunk Secure Gateway.

## Product Status

| Product | Version | Component | Affected Version | Fix Version |
| --- | --- | --- | --- | --- |
| Splunk Enterprise | 9.3 | Splunk Secure Gateway | Not affected | 9.3.0 |
| Splunk Enterprise | 9.2 | Splunk Secure Gateway | 9.2.0 to 9.2.2 | 9.2.3 |
| Splunk Enterprise | 9.1 | Splunk Secure Gateway | 9.1.0 to 9.1.5 | 9.1.6 |
| Splunk Secure Gateway | 3.7 |  | Not affected | 3.7.0 |
| Splunk Secure Gateway | 3.6 |  | 3.6.0 to 3.6.16 | 3.6.17 |
| Splunk Secure Gateway | 3.4 |  | Below 3.4.259 | 3.4.259 |

## Mitigations and Workarounds

Splunk Mobile, Spacebridge, and Mission Control rely on functionality in $SPLUNK\_HOME/etc/apps/splunk\_secure\_gateway. If you do not use any of the apps, features, or functionality, as a potential mitigation, you may remove or disable the app. See [Manage app and add-on objects](https://docs.splunk.com/Documentation/Splunk/latest/Admin/Managingappobjects).

## Detections

* [Splunk SG Information Disclosure for low privs user](https://research.splunk.com/application/0a3d6035-7bef-4dfa-b01e-84349edac3b4/)

## Severity

Splunk rates this vulnerability as a 4.3, Medium, with a CVSSv3.1 vector of CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N.

## Acknowledgments

Gabriel Nitu, Splunk

* Email
* [RSS Feed](/feed.xml)
* [Support](https://login.splunk.com/page/sso_redirect?type=portal)
© 2005 - 2025 Splunk Inc. All rights reserved.[Legal](https://www.splunk.com/en_us/legal.html)     [Privacy     [Website Terms of Use](https://www.splunk.com/en_us/legal/terms/terms-of-use.html)](https://www.splunk.com/en_us/legal/privacy/privacy-policy.html)

=== Content from research.splunk.com_1bb962e4_20250110_125622.html ===

[![Splunk Security Content Logo](https://research.splunk.com/images/logo.svg)](https://research.splunk.com/)

* [Analytic Stories](https://research.splunk.com/stories/)
* [Detections](https://research.splunk.com/detections/)
* [Playbooks](https://research.splunk.com/playbooks/)
* [Data Sources](https://research.splunk.com/sources/)
* [Blog](https://www.splunk.com/en_us/blog/author/secmrkt-research.html)
* [About](http://splunk.com/threat-research)
* [![GitHub Repo](https://research.splunk.com/images/GitHubMarkLight.svg)](https://github.com/splunk/security_content)

## Table of Contents

* + [Description](#description)
  + [Search](#search)
  + [Data Source](#data-source)
  + [Macros Used](#macros-used)
  + [Annotations](#annotations)
  + [Default Configuration](#default-configuration)
  + [Implementation](#implementation)
  + [Known False Positives](#known-false-positives)
  + [Associated Analytic Story](#associated-analytic-story)
  + [Risk Based Analytics (RBA)](#risk-based-analytics-rba)
  + [References](#references)
  + [Detection Testing](#detection-testing)

# Detection: Splunk SG Information Disclosure for Low Privs User

Updated Date: 2024-10-17
ID: 0a3d6035-7bef-4dfa-b01e-84349edac3b4
Author: Rod Soto
[Type: Hunting](#default-configuration)
[Product: Splunk Enterprise Security](https://www.splunk.com/en_us/products/enterprise-security.html)
### Description

In Splunk Enterprise versions below 9.3.0, 9.2.1 and 9.1.6, and Splunk Secure Gateway versions on Splunk Cloud Platform versions below 3.4.259, 3.6.17, and 3.7.0, a low-privileged user that does not hold the âadminâ or âpowerâ Splunk roles can see App Key Value Store (KV Store) deployment configuration and public/private keys in the Splunk Secure Gateway App.

### Search

```
1`splunkd_ui` uri_path="*/splunkd/__raw/services/ssg/kvstore/*" user!=admin user!="-"
2
3| stats count by clientip user method uri_path
4
5| `splunk_sg_information_disclosure_for_low_privs_user_filter`

```
### Data Source

| Name | Platform | Sourcetype | Source |
| --- | --- | --- | --- |
| [Splunk](/sources/d8a2c791-460b-4756-a8e5-ecade77b21e3) | Splunk icon [Splunk](/platform/splunk) | `'splunkd_ui_access'` | `'splunkd_ui_access.log'` |

### Macros Used

| Name | Value |
| --- | --- |
| [splunkd\_ui](https://github.com/splunk/security_content/blob/develop/macros/splunkd_ui.yml) | `index=_internal sourcetype=splunkd_ui_access` |
| splunk\_sg\_information\_disclosure\_for\_low\_privs\_user\_filter | `search *` |

`splunk_sg_information_disclosure_for_low_privs_user_filter` is an empty macro by default. It allows the user to filter out any results (false positives) without editing the SPL.
### Annotations

- MITRE ATT&CK

+ Kill Chain Phases

+ NIST

+ CIS

- Threat Actors

| ID | Technique | Tactic |
| --- | --- | --- |
| [T1087](https://attack.mitre.org/techniques/T1087/) | Account Discovery | Discovery |

KillChainPhase.EXPLOITAITON

NistCategory.DE\_AE

Cis18Value.CIS\_10

Aquatic Panda
FIN13

### Default Configuration

This detection is configured by default in Splunk Enterprise Security to run with the following settings:

| Setting | Value |
| --- | --- |
| Disabled | true |
| Cron Schedule | `0 * * * *` |
| Earliest Time | `-70m@m` |
| Latest Time | `-10m@m` |
| Schedule Window | `auto` |
| Creates Risk Event | False |

This configuration file applies to all detections of type hunting.
### Implementation

Requires access to internal indexes.

### Known False Positives

This is a hunting search and will produce false positives, the focus of this search must be on unusual requests towards the Splunk Secure Gateway from a non administrator user.

### Associated Analytic Story

* [Splunk Vulnerabilities](/stories/splunk_vulnerabilities/)

### Risk Based Analytics (RBA)

| Risk Message | Risk Score | Impact | Confidence |
| --- | --- | --- | --- |
| Potential exposure of Splunk Security Gateway sensitive information by $user$ | 40 | 80 | 50 |

The Risk Score is calculated by the following formula: Risk Score = (Impact \* Confidence/100). Initial Confidence and Impact is set by the analytic author.
### References

* <https://advisory.splunk.com/advisories/SVD-2024-1005>

### Detection Testing

| Test Type | Status | Dataset | Source | Sourcetype |
| --- | --- | --- | --- | --- |
| Validation | â [Passing](https://github.com/splunk/security_content/actions/workflows/build.yml) | N/A | N/A | N/A |
| Unit | â [Passing](https://github.com/splunk/security_content/actions/workflows/build.yml) | N/A | `N/A` | `N/A` |
| Integration | â Passing | N/A | `N/A` | `N/A` |

Replay any dataset to Splunk Enterprise by using our [`replay.py`](https://github.com/splunk/attack_data#using-replaypy) tool or the [UI](https://github.com/splunk/attack_data#using-ui).
Alternatively you can replay a dataset into a [Splunk Attack Range](https://github.com/splunk/attack_range#replay-dumps-into-attack-range-splunk-server)

---

Source: [GitHub](https://github.com/splunk/security_content/tree/develop/detections/application/splunk_sg_information_disclosure_for_low_privs_user.yml) |
Version: **2**

[Detection: Splunk Sensitive Information Disclosure in DEBUG Logging Channels](https://research.splunk.com/application/93dc7182-c5da-4085-82ec-401abf33d623/ "Detection: Splunk Sensitive Information Disclosure in DEBUG Logging Channels")

[Detection: Splunk Stored XSS conf-web Settings on Premises](https://research.splunk.com/application/ed1209ef-228d-4dab-9856-be9369925a5c/ "Detection: Splunk Stored XSS conf-web Settings on Premises")

Â© 2005 - 2024 Splunk LLC All rights reserved.


