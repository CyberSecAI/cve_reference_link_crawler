=== Content from access.redhat.com_22beb0ea_20250108_152916.html ===

[Skip to main content](#rh-login-card)
![Red Hat logo](/auth/resources/wi6vu/login/rhd-theme/img/RHLogo_white.svg)

All Red Hat

[Register](/auth/realms/redhat-external/login-actions/registration?client_id=unified-downloads&tab_id=_k7JyFocUs8&client_data=eyJydSI6Imh0dHBzOi8vYWNjZXNzLnJlZGhhdC5jb20vZG93bmxvYWRzL3NhbWwvZmluYWxpemUiLCJybSI6InBvc3QiLCJzdCI6Imh0dHBzOi8vYWNjZXNzLnJlZGhhdC5jb20vZXJyYXRhL1JIU0EtMjAyMjo4MzkzJTVEKGh0dHBzOi9hY2Nlc3MucmVkaGF0LmNvbS9lcnJhdGEvUkhTQS0yMDIyJTNBODM5MykifQ)

# Log in to your Red Hat account

#### Danger alert:

#### Log in attempt timed out

Resubmit your information.

 Red Hat login or email

Next

 Red Hat login or email

Log in with company single sign-on

Log in with Red Hat account

 Red Hat login or email

Password

Log in

[Register for a Red Hat account](/auth/realms/redhat-external/login-actions/registration?client_id=unified-downloads&tab_id=_k7JyFocUs8&client_data=eyJydSI6Imh0dHBzOi8vYWNjZXNzLnJlZGhhdC5jb20vZG93bmxvYWRzL3NhbWwvZmluYWxpemUiLCJybSI6InBvc3QiLCJzdCI6Imh0dHBzOi8vYWNjZXNzLnJlZGhhdC5jb20vZXJyYXRhL1JIU0EtMjAyMjo4MzkzJTVEKGh0dHBzOi9hY2Nlc3MucmVkaGF0LmNvbS9lcnJhdGEvUkhTQS0yMDIyJTNBODM5MykifQ)

[Forgot your password?](/auth/realms/redhat-external/login-actions/reset-credentials?client_id=unified-downloads&tab_id=_k7JyFocUs8&client_data=eyJydSI6Imh0dHBzOi8vYWNjZXNzLnJlZGhhdC5jb20vZG93bmxvYWRzL3NhbWwvZmluYWxpemUiLCJybSI6InBvc3QiLCJzdCI6Imh0dHBzOi8vYWNjZXNzLnJlZGhhdC5jb20vZXJyYXRhL1JIU0EtMjAyMjo4MzkzJTVEKGh0dHBzOi9hY2Nlc3MucmVkaGF0LmNvbS9lcnJhdGEvUkhTQS0yMDIyJTNBODM5MykifQ)

### Why create an account?

* ![](/auth/resources/wi6vu/login/rhd-theme/img/pricetag.png)

  #### Product trials

  Try our products hands-on to see if they’ll work for you.
* ![](/auth/resources/wi6vu/login/rhd-theme/img/book.png)

  #### Learning resources

  Get training and learning tools to help you use our products.
* ![](/auth/resources/wi6vu/login/rhd-theme/img/support.png)

  #### World-class support

  Rely on our trusted customer support and partner enablement.

A subscription may be required for some services.

[![Red Hat logo](https://static.redhat.com/libs/redhat/brand-assets/2/corp/logo--on-dark.svg)](https://redhat.com/en)
[LinkedIn](https://www.linkedin.com/company/red-hat)
[YouTube](https://www.youtube.com/user/RedHatVideos)
[Facebook](https://www.facebook.com/redhatinc)
[X/Twitter](https://twitter.com/RedHat)
### Products

* [Red Hat Enterprise Linux](https://redhat.com/en/technologies/linux-platforms/enterprise-linux)
* [Red Hat OpenShift](https://redhat.com/en/technologies/cloud-computing/openshift)
* [Red Hat Ansible Automation Platform](https://redhat.com/en/technologies/management/ansible)
* [Cloud services](https://redhat.com/en/technologies/cloud-computing/openshift/cloud-services)
* [See all products](https://redhat.com/en/technologies/all-products)

### Tools

* [My account](https://sso.redhat.com)
* [Training and certification](https://redhat.com/en/services/training-and-certification)
* [Customer support](https://access.redhat.com)
* [Developer resources](https://developers.redhat.com/)
* [Learning community](https://learn.redhat.com/)
* [Partner resources](https://connect.redhat.com/)
* [Resource library](https://redhat.com/en/resources)

### Try, buy & sell

* [Product trial center](https://redhat.com/en/products/trials)
* [Red Hat Marketplace](https://marketplace.redhat.com)
* [Red Hat Ecosystem Catalog](https://catalog.redhat.com/)
* [Find a partner](http://redhat.force.com/finder/)
* [Red Hat Store](https://www.redhat.com/en/store)
* [Console](https://cloud.redhat.com/)

### Communicate

* [Contact consulting](https://redhat.com/en/services/consulting-overview#contact-us)
* [Contact sales](https://redhat.com/en/contact)
* [Contact training](https://redhat.com/en/services/training-and-certification/contact-us)
* [Social](https://redhat.com/en/about/social)

### About Red Hat

We’re the world’s leading provider of enterprise open source solutions—including Linux, cloud, container, and Kubernetes. We deliver hardened solutions that make it easier for enterprises to work across platforms and environments, from the core datacenter to the network edge.

### Subscribe to our newsletter, Red Hat Shares

[Sign up now](https://www.redhat.com/en/email-preferences?newsletter=RH-Shares&intcmp=7016000000154xCAAQ)

### Red Hat legal and privacy links

* [About Red Hat](https://redhat.com/en/about/company)
* [Jobs](https://redhat.com/en/jobs)
* [Events](https://redhat.com/en/events)
* [Locations](https://redhat.com/en/about/office-locations)
* [Contact Red Hat](https://redhat.com/en/contact)
* [Red Hat Blog](https://redhat.com/en/blog)
* [Diversity, equity, and inclusion](https://redhat.com/en/about/our-culture/diversity-equity-inclusion)
* [Cool Stuff Store](https://coolstuff.redhat.com/)
* [Red Hat Summit](https://www.redhat.com/en/summit)

© 2022 Red Hat, Inc.
### Red Hat legal and privacy links

* [Privacy statement](https://redhat.com/en/about/privacy-policy)
* [Terms of use](https://redhat.com/en/about/terms-use)
* [All policies and guidelines](https://redhat.com/en/about/all-policies-guidelines)
* [Digital accessibility](https://redhat.com/en/about/digital-accessibility)



=== Content from github.com_61267068_20250108_152915.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Flogrotate%2Flogrotate%2Freleases%2Ftag%2F3.20.1)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Flogrotate%2Flogrotate%2Freleases%2Ftag%2F3.20.1)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Freleases%2Fshow&source=header-repo&source_repo=logrotate%2Flogrotate)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[logrotate](/logrotate)
/
**[logrotate](/logrotate/logrotate)**
Public

* [Notifications](/login?return_to=%2Flogrotate%2Flogrotate) You must be signed in to change notification settings
* [Fork
  201](/login?return_to=%2Flogrotate%2Flogrotate)
* [Star
   1.3k](/login?return_to=%2Flogrotate%2Flogrotate)

* [Code](/logrotate/logrotate/tree/3.20.1)
* [Issues
  47](/logrotate/logrotate/issues)
* [Pull requests
  7](/logrotate/logrotate/pulls)
* [Actions](/logrotate/logrotate/actions)
* [Projects
  0](/logrotate/logrotate/projects)
* [Wiki](/logrotate/logrotate/wiki)
* [Security](/logrotate/logrotate/security)
* [Insights](/logrotate/logrotate/pulse)

Additional navigation options

* [Code](/logrotate/logrotate/tree/3.20.1)
* [Issues](/logrotate/logrotate/issues)
* [Pull requests](/logrotate/logrotate/pulls)
* [Actions](/logrotate/logrotate/actions)
* [Projects](/logrotate/logrotate/projects)
* [Wiki](/logrotate/logrotate/wiki)
* [Security](/logrotate/logrotate/security)
* [Insights](/logrotate/logrotate/pulse)

1. [Releases](/logrotate/logrotate/releases)
2. [3.20.1](/logrotate/logrotate/releases/tag/3.20.1)

# logrotate-3.20.1

 Compare

Choose a tag to compare

Could not load tags

Nothing to show

[{{ refName }}
default](/logrotate/logrotate/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...3.20.1)

 Loading

[View all tags](/logrotate/logrotate/tags)

![@kdudka](https://avatars.githubusercontent.com/u/227483?s=40&v=4)
[kdudka](/kdudka)
released this
25 May 15:29

[3.20.1](/logrotate/logrotate/tree/3.20.1)

This tag was signed with the committer’s **verified signature**.
The key has expired.

[![](https://avatars.githubusercontent.com/u/227483?s=64&v=4)](/kdudka)
[kdudka](/kdudka)
Kamil Dudka

GPG key ID: 873DB37572A37B36
Expired

[Learn about vigilant mode](https://docs.github.com/github/authenticating-to-github/displaying-verification-statuses-for-all-of-your-commits).

[`5cf4cd4`](/logrotate/logrotate/commit/5cf4cd44f79e1db8f698a7de9ef612044bb5699e)

* drop world-readable permission on state file even when ACLs are enabled ([#446](https://github.com/logrotate/logrotate/pull/446))

 Assets
6

 Loading

 🎉
4
 tricantivu, copyrighthero, jamacku, and NonBinaryJellyFish reacted with hooray emoji
 ❤️
1
 Gadgetflow7 reacted with heart emoji

All reactions

* 🎉
  4 reactions
* ❤️
  1 reaction

 5 people reacted

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from lists.fedoraproject.org_04c368c7_20250108_122159.html ===


[![Fedora Mailing-Lists](/static/logo-hyperkitty-fedora.png)](/archives/ "Fedora Mailing-Lists")

[Sign In](/accounts/login/?next=/archives/list/package-announce%40lists.fedoraproject.org/message/Y7EHGYRE6DSFSBXQIWYDGTSXKO6IFSJQ/)
[Sign Up](/accounts/signup/?next=/archives/list/package-announce%40lists.fedoraproject.org/message/Y7EHGYRE6DSFSBXQIWYDGTSXKO6IFSJQ/)

* [Sign In](/accounts/login/?next=/archives/list/package-announce%40lists.fedoraproject.org/message/Y7EHGYRE6DSFSBXQIWYDGTSXKO6IFSJQ/)
* [Sign Up](/accounts/signup/?next=/archives/list/package-announce%40lists.fedoraproject.org/message/Y7EHGYRE6DSFSBXQIWYDGTSXKO6IFSJQ/)

* [Manage this list](/admin/lists/package-announce.lists.fedoraproject.org/)

×
#### Keyboard Shortcuts

### Thread View

* `j`: Next unread message
* `k`: Previous unread message
* `j a`: Jump to all threads* `j l`: Jump to MailingList overview

### 2025

* [January](/archives/list/package-announce%40lists.fedoraproject.org/2025/1/)

### 2024

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2024/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2024/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2024/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2024/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2024/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2024/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2024/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2024/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2024/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2024/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2024/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2024/1/)

### 2023

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2023/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2023/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2023/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2023/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2023/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2023/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2023/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2023/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2023/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2023/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2023/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2023/1/)

### 2022

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2022/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2022/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2022/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2022/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2022/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2022/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2022/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2022/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2022/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2022/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2022/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2022/1/)

### 2021

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2021/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2021/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2021/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2021/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2021/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2021/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2021/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2021/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2021/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2021/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2021/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2021/1/)

### 2020

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2020/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2020/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2020/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2020/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2020/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2020/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2020/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2020/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2020/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2020/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2020/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2020/1/)

### 2019

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2019/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2019/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2019/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2019/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2019/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2019/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2019/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2019/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2019/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2019/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2019/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2019/1/)

### 2018

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2018/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2018/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2018/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2018/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2018/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2018/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2018/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2018/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2018/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2018/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2018/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2018/1/)

### 2017

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2017/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2017/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2017/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2017/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2017/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2017/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2017/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2017/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2017/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2017/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2017/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2017/1/)

### 2016

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2016/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2016/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2016/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2016/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2016/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2016/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2016/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2016/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2016/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2016/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2016/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2016/1/)

### 2015

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2015/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2015/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2015/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2015/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2015/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2015/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2015/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2015/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2015/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2015/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2015/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2015/1/)

### 2014

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2014/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2014/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2014/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2014/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2014/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2014/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2014/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2014/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2014/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2014/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2014/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2014/1/)

### 2013

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2013/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2013/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2013/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2013/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2013/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2013/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2013/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2013/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2013/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2013/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2013/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2013/1/)

### 2012

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2012/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2012/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2012/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2012/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2012/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2012/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2012/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2012/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2012/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2012/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2012/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2012/1/)

### 2011

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2011/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2011/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2011/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2011/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2011/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2011/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2011/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2011/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2011/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2011/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2011/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2011/1/)

### 2010

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2010/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2010/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2010/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2010/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2010/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2010/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2010/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2010/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2010/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2010/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2010/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2010/1/)

### 2009

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2009/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2009/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2009/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2009/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2009/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2009/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2009/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2009/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2009/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2009/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2009/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2009/1/)

### 2008

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2008/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2008/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2008/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2008/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2008/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2008/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2008/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2008/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2008/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2008/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2008/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2008/1/)

### 2007

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2007/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2007/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2007/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2007/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2007/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2007/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2007/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2007/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2007/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2007/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2007/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2007/1/)

### 2006

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2006/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2006/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2006/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2006/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2006/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2006/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2006/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2006/5/)

[List overview](/archives/list/package-announce%40lists.fedoraproject.org/)

[Download](/archives/list/package-announce%40lists.fedoraproject.org/export/package-announce%40lists.fedoraproject.org-Y7EHGYRE6DSFSBXQIWYDGTSXKO6IFSJQ.mbox.gz?message=Y7EHGYRE6DSFSBXQIWYDGTSXKO6IFSJQ "This message in gzipped mbox format")

[thread](/archives/list/package-announce%40lists.fedoraproject.org/thread/Y7EHGYRE6DSFSBXQIWYDGTSXKO6IFSJQ/#Y7EHGYRE6DSFSBXQIWYDGTSXKO6IFSJQ)

# [SECURITY] Fedora 35 Update: logrotate-3.18.1-4.fc35

![](https://seccdn.libravatar.org/avatar/be256568dfce45c1862b55e6cf3f2726.jpg?s=120&d=retro&r=g)

[updates＠fedoraproject.org](/archives/users/3d8bb2e4c1d843beb492d4f8a7c44761/ "See the profile for updates＠fedoraproject.org")

12 Jun
2022

12 Jun
'22

1:16 a.m.

--------------------------------------------------------------------------------
Fedora Update Notification
FEDORA-2022-ff0188b37c
2022-06-12 01:16:07.760740
--------------------------------------------------------------------------------

Name : logrotate
Product : Fedora 35
Version : 3.18.1
Release : 4.fc35
URL : <https://github.com/logrotate/logrotate>
Summary : Rotates, compresses, removes and mails system log files
Description :
The logrotate utility is designed to simplify the administration of
log files on a system which generates a lot of log files. Logrotate
allows for the automatic rotation compression, removal and mailing of
log files. Logrotate can be set to handle a log file daily, weekly,
monthly or when the log file gets to a certain size.

Install the logrotate package if you need a utility to deal with the
log files on your system.

--------------------------------------------------------------------------------
Update Information:

- lockState: do not print `error:` when exit code is unaffected (#2090926) ----
- fix potential DoS from unprivileged users via the state file (CVE-2022-1348)
--------------------------------------------------------------------------------
ChangeLog:

\* Fri May 27 2022 Kamil Dudka kdudka@redhat.com - 3.18.1-4
- lockState: do not print `error:` when exit code is unaffected (#2090926)
\* Wed May 25 2022 Kamil Dudka kdudka@redhat.com - 3.18.1-3
- fix potential DoS from unprivileged users via the state file (CVE-2022-1348)
--------------------------------------------------------------------------------
References:

[ 1 ] Bug #2090272 - CVE-2022-1348 logrotate: potential DoS from unprivileged users via the state file [fedora-all]
<https://bugzilla.redhat.com/show_bug.cgi?id=2090272>
[ 2 ] Bug #2090926 - error: state file /var/lib/logrotate/logrotate.status is world-readable and thus can be locked from other unprivileged users. Skipping lock acquisition
<https://bugzilla.redhat.com/show_bug.cgi?id=2090926>
--------------------------------------------------------------------------------

This update can be installed with the "dnf" update program. Use
su -c 'dnf upgrade --advisory FEDORA-2022-ff0188b37c' at the command
line. For more information, refer to the dnf documentation available at
<http://dnf.readthedocs.io/en/latest/command_ref.html#upgrade-command-label>

All packages are signed with the Fedora Project GPG key. More details on the
GPG keys used by the Fedora Project can be found at
<https://fedoraproject.org/keys>
--------------------------------------------------------------------------------

[0](#like "You must be logged-in to vote.")
[0](#dislike "You must be logged-in to vote.")

Reply

[Back to the thread](/archives/list/package-announce%40lists.fedoraproject.org/thread/Y7EHGYRE6DSFSBXQIWYDGTSXKO6IFSJQ/#Y7EHGYRE6DSFSBXQIWYDGTSXKO6IFSJQ)

[Back to the list](/archives/list/package-announce%40lists.fedoraproject.org/)

Powered by [HyperKitty](http://hyperkitty.readthedocs.org) version 1.3.7.



=== Content from github.com_bdc7a00c_20250108_152918.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Flogrotate%2Flogrotate%2Fcommit%2Ff46d0bdfc9c53515c13880c501f4d2e1e7dd8b25)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Flogrotate%2Flogrotate%2Fcommit%2Ff46d0bdfc9c53515c13880c501f4d2e1e7dd8b25)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=logrotate%2Flogrotate)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[logrotate](/logrotate)
/
**[logrotate](/logrotate/logrotate)**
Public

* [Notifications](/login?return_to=%2Flogrotate%2Flogrotate) You must be signed in to change notification settings
* [Fork
  201](/login?return_to=%2Flogrotate%2Flogrotate)
* [Star
   1.3k](/login?return_to=%2Flogrotate%2Flogrotate)

* [Code](/logrotate/logrotate)
* [Issues
  47](/logrotate/logrotate/issues)
* [Pull requests
  7](/logrotate/logrotate/pulls)
* [Actions](/logrotate/logrotate/actions)
* [Projects
  0](/logrotate/logrotate/projects)
* [Wiki](/logrotate/logrotate/wiki)
* [Security](/logrotate/logrotate/security)
* [Insights](/logrotate/logrotate/pulse)

Additional navigation options

* [Code](/logrotate/logrotate)
* [Issues](/logrotate/logrotate/issues)
* [Pull requests](/logrotate/logrotate/pulls)
* [Actions](/logrotate/logrotate/actions)
* [Projects](/logrotate/logrotate/projects)
* [Wiki](/logrotate/logrotate/wiki)
* [Security](/logrotate/logrotate/security)
* [Insights](/logrotate/logrotate/pulse)

## Commit

[Permalink](/logrotate/logrotate/commit/f46d0bdfc9c53515c13880c501f4d2e1e7dd8b25)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Lock state file to prevent parallel execution

[Browse files](/logrotate/logrotate/tree/f46d0bdfc9c53515c13880c501f4d2e1e7dd8b25)
Browse the repository at this point in the history

```
Running multiple instances of logrotate on the same set of log-files
might have undesirable effects.

Add command line option --skip-state-lock to skip locking the state
file, for example if locking is unsupported or prohibited.

Fixes: [#295](https://github.com/logrotate/logrotate/issues/295)
Closes: [#297](https://github.com/logrotate/logrotate/pull/297)
```

* Loading branch information

[![@cgzones](https://avatars.githubusercontent.com/u/6131885?s=40&v=4)](/cgzones) [![@kdudka](https://avatars.githubusercontent.com/u/227483?s=40&v=4)](/kdudka)

[cgzones](/logrotate/logrotate/commits?author=cgzones "View all commits by cgzones")
authored and
[kdudka](/logrotate/logrotate/commits?author=kdudka "View all commits by kdudka")
committed
Jun 24, 2020

1 parent
[f9c88a1](/logrotate/logrotate/commit/f9c88a133846684d22e34204a01198ece384e1f4)

commit f46d0bd

 Show file tree

 Hide file tree

Showing
**5 changed files**
with
**104 additions**
and
**37 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* logrotate.8.in
  [logrotate.8.in](#diff-2b89a06b24931f234524aa80d40a0f1680f3b23f5d733bc047c48b0056f007ce)
* logrotate.c
  [logrotate.c](#diff-e787ec20cfd136ac3f0005579d58aaa439dafe5d2bd3880bc25ce759e6f2973b)
* test

  + test/Makefile.am
    [Makefile.am](#diff-0b5cec97f57673e2834901f351d8d4449b408dc480ebb1c58a92cb543cc7bb41)
  + test/test-0087.sh
    [test-0087.sh](#diff-e82e17d4010d94d9099c1acf70a8e53dfb48cddbb0692987f2dee8c3a2440faa)
  + test/test-config.87.in
    [test-config.87.in](#diff-041da3603264c74476f6e6705fce645c45539c898dc6a544a5e86740d24a8b0b)

## There are no files selected for viewing

9 changes: 8 additions & 1 deletion

9
[logrotate.8.in](#diff-2b89a06b24931f234524aa80d40a0f1680f3b23f5d733bc047c48b0056f007ce "logrotate.8.in")

Show comments

[View file](/logrotate/logrotate/blob/f46d0bdfc9c53515c13880c501f4d2e1e7dd8b25/logrotate.8.in)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -20,6 +20,7 @@ logrotate \(hy rotates, compresses, and mails system logs |
|  |  | \fR[\fB\-\-force\fR] |
|  |  | \fR[\fB\-\-debug\fR] |
|  |  | \fR[\fB\-\-state\fR \fIfile\fR] |
|  |  | \fR[\fB\-\-skip-state-lock\fR] |
|  |  | \fR[\fB\-\-verbose\fR] |
|  |  | \fR[\fB\-\-log\fR \fIfile\fR] |
|  |  | \fR[\fB\-\-mail\fR \fIcommand\fR] |
| Expand Down  Expand Up | | @@ -71,7 +72,13 @@ Turn on debug mode, which means that no changes are made to the logs and the |
|  |  | \fB\-s\fR, \fB\-\-state\fR \fIstatefile\fR |
|  |  | Tells \fBlogrotate\fR to use an alternate state file. This is useful |
|  |  | if \fBlogrotate\fR is being run as a different user for various sets of |
|  |  | log files. The default state file is \fI@STATE\_FILE\_PATH@\fR. |
|  |  | log files. To prevent parallel execution \fBlogrotate\fR by default |
|  |  | acquires a lock on the state file, if it can not be acquired it will exit |
|  |  | with value 3. The default state file is \fI@STATE\_FILE\_PATH@\fR. |
|  |  |  |
|  |  | .TP |
|  |  | \fB\-\-skip-state-lock\fR |
|  |  | Do not lock the state file, for example if locking is unsupported or prohibited. |
|  |  |  |
|  |  | .TP |
|  |  | \fB\-v\fR, \fB\-\-verbose\fR |
| Expand Down | |  |

104 changes: 68 additions & 36 deletions

104
[logrotate.c](#diff-e787ec20cfd136ac3f0005579d58aaa439dafe5d2bd3880bc25ce759e6f2973b "logrotate.c")

Show comments

[View file](/logrotate/logrotate/blob/f46d0bdfc9c53515c13880c501f4d2e1e7dd8b25/logrotate.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -12,6 +12,7 @@ |
|  |  | #include <stdio.h> |
|  |  | #include <stdlib.h> |
|  |  | #include <string.h> |
|  |  | #include <sys/file.h> |
|  |  | #include <sys/stat.h> |
|  |  | #include <sys/wait.h> |
|  |  | #include <time.h> |
| Expand Down  Expand Up | | @@ -2511,37 +2512,12 @@ static int writeState(const char \*stateFilename) |
|  |  |  |
|  |  | fdcurr = open(stateFilename, O\_RDONLY); |
|  |  | if (fdcurr == -1) { |
|  |  | const char \*state\_header\_v2 = "logrotate state -- version 2\n"; |
|  |  | const size\_t state\_header\_v2\_len = strlen(state\_header\_v2); |
|  |  | size\_t ret; |
|  |  |  |
|  |  | /\* no error if state file is just missing \*/ |
|  |  | if (errno != ENOENT) { |
|  |  | message(MESS\_ERROR, "error opening state file %s: %s\n", |
|  |  | stateFilename, strerror(errno)); |
|  |  | free(tmpFilename); |
|  |  | return 1; |
|  |  | } |
|  |  |  |
|  |  | /\* create a stub state file with mode 0644 \*/ |
|  |  | fdcurr = open(stateFilename, O\_CREAT | O\_EXCL | O\_WRONLY, |
|  |  | S\_IWUSR | S\_IRUSR | S\_IRGRP | S\_IROTH); |
|  |  | if (fdcurr == -1) { |
|  |  | message(MESS\_ERROR, "error creating stub state file %s: %s\n", |
|  |  | stateFilename, strerror(errno)); |
|  |  | free(tmpFilename); |
|  |  | return 1; |
|  |  | } |
|  |  |  |
|  |  | /\* check write access \*/ |
|  |  | ret = full\_write(fdcurr, state\_header\_v2, state\_header\_v2\_len); |
|  |  | if (ret != state\_header\_v2\_len) { |
|  |  | message(MESS\_ERROR, "error writing to stub state file %s: %s\n", |
|  |  | stateFilename, strerror(errno)); |
|  |  | close(fdcurr); |
|  |  | free(tmpFilename); |
|  |  | return 1; |
|  |  | } |
|  |  | /\* the statefile should exist, lockState() already created an empty |
|  |  | \* state file in case it did not exist initially \*/ |
|  |  | message(MESS\_ERROR, "error opening state file %s: %s\n", |
|  |  | stateFilename, strerror(errno)); |
|  |  | free(tmpFilename); |
|  |  | return 1; |
|  |  | } |
|  |  |  |
|  |  | /\* get attributes, to assign them to the new state file \*/ |
| Expand Down  Expand Up | | @@ -2721,12 +2697,15 @@ static int readState(const char \*stateFilename) |
|  |  | /\* treat non-openable file as an empty file for allocateHash() \*/ |
|  |  | f\_stat.st\_size = 0; |
|  |  |  |
|  |  | /\* no error if state just not exists \*/ |
|  |  | if (errno != ENOENT) { |
|  |  | message(MESS\_ERROR, "error opening state file %s: %s\n", |
|  |  | stateFilename, strerror(errno)); |
|  |  | /\* the statefile should exist, lockState() already created an empty |
|  |  | \* state file in case it did not exist initially \*/ |
|  |  | message(MESS\_ERROR, "error opening state file %s: %s\n", |
|  |  | stateFilename, strerror(errno)); |
|  |  |  |
|  |  | /\* do not return until the hash table is allocated \*/ |
|  |  | /\* Do not return until the hash table is allocated. |
|  |  | \* In debug mode the state file might not exist, |
|  |  | \* cause lockState() is not called \*/ |
|  |  | if (!debug) { |
|  |  | rc = 1; |
|  |  | } |
|  |  | } else { |
| Expand Down  Expand Up | | @@ -2909,9 +2888,57 @@ static int readState(const char \*stateFilename) |
|  |  | return 0; |
|  |  | } |
|  |  |  |
|  |  | static int lockState(const char \*stateFilename, int skip\_state\_lock) |
|  |  | { |
|  |  | int lockFd = open(stateFilename, O\_RDWR | O\_CLOEXEC); |
|  |  | if (lockFd == -1) { |
|  |  | if (errno == ENOENT) { |
|  |  | message(MESS\_DEBUG, "Creating stub state file: %s\n", |
|  |  | stateFilename); |
|  |  |  |
|  |  | /\* create a stub state file with mode 0644 \*/ |
|  |  | lockFd = open(stateFilename, O\_CREAT | O\_EXCL | O\_WRONLY, |
|  |  | S\_IWUSR | S\_IRUSR | S\_IRGRP | S\_IROTH); |
|  |  | if (lockFd == -1) { |
|  |  | message(MESS\_ERROR, "error creating stub state file %s: %s\n", |
|  |  | stateFilename, strerror(errno)); |
|  |  | return 1; |
|  |  | } |
|  |  | } else { |
|  |  | message(MESS\_ERROR, "error opening state file %s: %s\n", |
|  |  | stateFilename, strerror(errno)); |
|  |  | return 1; |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | if (skip\_state\_lock) { |
|  |  | message(MESS\_DEBUG, "Skip locking state file %s\n", |
|  |  | stateFilename); |
|  |  | close(lockFd); |
|  |  | return 0; |
|  |  | } |
|  |  |  |
|  |  | if (flock(lockFd, LOCK\_EX | LOCK\_NB) == -1) { |
|  |  | if (errno == EWOULDBLOCK) { |
|  |  | message(MESS\_ERROR, "state file %s is already locked\n" |
|  |  | "logrotate does not support parallel execution on the" |
|  |  | " same set of logfiles.\n", stateFilename); |
|  |  | } else { |
|  |  | message(MESS\_ERROR, "can not acquire lock on state file %s: %s\n", |
|  |  | stateFilename, strerror(errno)); |
|  |  | } |
|  |  | close(lockFd); |
|  |  | return 1; |
|  |  | } |
|  |  |  |
|  |  | /\* keep lockFd open till we terminate \*/ |
|  |  | return 0; |
|  |  | } |
|  |  |  |
|  |  | int main(int argc, const char \*\*argv) |
|  |  | { |
|  |  | int force = 0; |
|  |  | int skip\_state\_lock = 0; |
|  |  | const char \*stateFile = STATEFILE; |
|  |  | const char \*logFile = NULL; |
|  |  | FILE \*logFd = NULL; |
| Expand All | | @@ -2931,6 +2958,7 @@ int main(int argc, const char \*\*argv) |
|  |  | {"state", 's', POPT\_ARG\_STRING, &stateFile, 0, |
|  |  | "Path of state file", |
|  |  | "statefile"}, |
|  |  | {"skip-state-lock", '\0', POPT\_ARG\_NONE, &skip\_state\_lock, 0, "Do not lock the state file", NULL}, |
|  |  | {"verbose", 'v', 0, NULL, 'v', "Display messages during rotation", NULL}, |
|  |  | {"log", 'l', POPT\_ARG\_STRING, &logFile, 'l', "Log file or 'syslog' to log to syslog", |
|  |  | "logfile"}, |
| Expand Down  Expand Up | | @@ -3027,6 +3055,10 @@ int main(int argc, const char \*\*argv) |
|  |  | poptFreeContext(optCon); |
|  |  | nowSecs = time(NULL); |
|  |  |  |
|  |  | if (!debug && lockState(stateFile, skip\_state\_lock)) { |
|  |  | exit(3); |
|  |  | } |
|  |  |  |
|  |  | if (readState(stateFile)) |
|  |  | rc = 1; |
|  |  |  |
| Expand Down | |  |

1 change: 1 addition & 0 deletions

1
[test/Makefile.am](#diff-0b5cec97f57673e2834901f351d8d4449b408dc480ebb1c58a92cb543cc7bb41 "test/Makefile.am")

Show comments

[View file](/logrotate/logrotate/blob/f46d0bdfc9c53515c13880c501f4d2e1e7dd8b25/test/Makefile.am)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -85,6 +85,7 @@ TEST\_CASES = \ |
|  |  | test-0084.sh \ |
|  |  | test-0085.sh \ |
|  |  | test-0086.sh \ |
|  |  | test-0087.sh \ |
|  |  | test-0100.sh \ |
|  |  | test-0101.sh |
|  |  |  |
| Expand Down | |  |

22 changes: 22 additions & 0 deletions

22
[test/test-0087.sh](#diff-e82e17d4010d94d9099c1acf70a8e53dfb48cddbb0692987f2dee8c3a2440faa "test/test-0087.sh")

Show comments

[View file](/logrotate/logrotate/blob/f46d0bdfc9c53515c13880c501f4d2e1e7dd8b25/test/test-0087.sh)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -0,0 +1,22 @@ |
|  |  | #!/bin/bash |
|  |  |  |
|  |  | . ./test-common.sh |
|  |  |  |
|  |  | # check state file locking |
|  |  | cleanup 87 |
|  |  |  |
|  |  | preptest test.log 87 1 |
|  |  |  |
|  |  | touch state |
|  |  |  |
|  |  | $RLR test-config.87 -v -f & |
|  |  |  |
|  |  | sleep 2 |
|  |  |  |
|  |  | $RLR test-config.87 -v |
|  |  | ret=$? |
|  |  |  |
|  |  | if [ $ret -ne 3 ]; then |
|  |  | echo "Expected second instance to fail (returned $ret - expected 3)." |
|  |  | exit 3 |
|  |  | fi |

5 changes: 5 additions & 0 deletions

5
[test/test-config.87.in](#diff-041da3603264c74476f6e6705fce645c45539c898dc6a544a5e86740d24a8b0b "test/test-config.87.in")

Show comments

[View file](/logrotate/logrotate/blob/f46d0bdfc9c53515c13880c501f4d2e1e7dd8b25/test/test-config.87.in)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -0,0 +1,5 @@ |
|  |  | &DIR&/test.log { |
|  |  | postrotate |
|  |  | sleep 8 |
|  |  | endscript |
|  |  | } |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `f46d0bd`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Flogrotate%2Flogrotate%2Fcommit%2Ff46d0bdfc9c53515c13880c501f4d2e1e7dd8b25) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_4ea9868a_20250108_152916.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Flogrotate%2Flogrotate%2Freleases%2Ftag%2F3.20.0)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Flogrotate%2Flogrotate%2Freleases%2Ftag%2F3.20.0)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Freleases%2Fshow&source=header-repo&source_repo=logrotate%2Flogrotate)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[logrotate](/logrotate)
/
**[logrotate](/logrotate/logrotate)**
Public

* [Notifications](/login?return_to=%2Flogrotate%2Flogrotate) You must be signed in to change notification settings
* [Fork
  201](/login?return_to=%2Flogrotate%2Flogrotate)
* [Star
   1.3k](/login?return_to=%2Flogrotate%2Flogrotate)

* [Code](/logrotate/logrotate/tree/3.20.0)
* [Issues
  47](/logrotate/logrotate/issues)
* [Pull requests
  7](/logrotate/logrotate/pulls)
* [Actions](/logrotate/logrotate/actions)
* [Projects
  0](/logrotate/logrotate/projects)
* [Wiki](/logrotate/logrotate/wiki)
* [Security](/logrotate/logrotate/security)
* [Insights](/logrotate/logrotate/pulse)

Additional navigation options

* [Code](/logrotate/logrotate/tree/3.20.0)
* [Issues](/logrotate/logrotate/issues)
* [Pull requests](/logrotate/logrotate/pulls)
* [Actions](/logrotate/logrotate/actions)
* [Projects](/logrotate/logrotate/projects)
* [Wiki](/logrotate/logrotate/wiki)
* [Security](/logrotate/logrotate/security)
* [Insights](/logrotate/logrotate/pulse)

1. [Releases](/logrotate/logrotate/releases)
2. [3.20.0](/logrotate/logrotate/releases/tag/3.20.0)

# logrotate-3.20.0

 Compare

Choose a tag to compare

Could not load tags

Nothing to show

[{{ refName }}
default](/logrotate/logrotate/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...3.20.0)

 Loading

[View all tags](/logrotate/logrotate/tags)

![@kdudka](https://avatars.githubusercontent.com/u/227483?s=40&v=4)
[kdudka](/kdudka)
released this
25 May 07:12

[3.20.0](/logrotate/logrotate/tree/3.20.0)

This tag was signed with the committer’s **verified signature**.
The key has expired.

[![](https://avatars.githubusercontent.com/u/227483?s=64&v=4)](/kdudka)
[kdudka](/kdudka)
Kamil Dudka

GPG key ID: 873DB37572A37B36
Expired

[Learn about vigilant mode](https://docs.github.com/github/authenticating-to-github/displaying-verification-statuses-for-all-of-your-commits).

[`b8b1750`](/logrotate/logrotate/commit/b8b1750933f876f6e844f2958b77a380e98bc7b4)

* fix potential DoS from unprivileged users via the state file ([CVE-2022-1348](https://bugzilla.redhat.com/CVE-2022-1348))
* fix a misleading debug message with `copytruncate` and `rotate 0` ([#443](https://github.com/logrotate/logrotate/issues/443))
* add support for unsigned `time_t` ([#438](https://github.com/logrotate/logrotate/pull/438))
* do not lock state file `/dev/null` ([#433](https://github.com/logrotate/logrotate/pull/433))

 Assets
6

 Loading

 🎉
1
 tricantivu reacted with hooray emoji

All reactions

* 🎉
  1 reaction

 1 person reacted

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from bugzilla.redhat.com_90cfd350_20250108_122158.html ===


* Login
  + Log in using an SSO provider:- [Fedora Account System](saml2_login.cgi?idp=Fedora%20Account%20System&target=show_bug.cgi%3Fid%3DCVE-2022-1348)
    - [Red Hat Associate](saml2_login.cgi?idp=Red%20Hat%20Associate&target=show_bug.cgi%3Fid%3DCVE-2022-1348)
    - [Red Hat Customer](saml2_login.cgi?idp=Red%20Hat%20Customer&target=show_bug.cgi%3Fid%3DCVE-2022-1348)+ Login using a Red Hat Bugzilla account
  + Forgot Password
  + [Create an Account](createaccount.cgi)

Red Hat Bugzilla – Bug 2075074

* [Home](./)
* [New](enter_bug.cgi)
* Search
  + [Simple Search](query.cgi?format=specific)
  + [Advanced Search](query.cgi?format=advanced)
* My Links
  + [Browse](describecomponents.cgi)
  + [Requests](request.cgi)
  + Reports
  + Current State
    - [Search](query.cgi)
    - [Tabular reports](query.cgi?format=report-table)
    - [Graphical reports](query.cgi?format=report-graph)
    - [Duplicates](duplicates.cgi)
  + Other Reports
    - [User Changes](https://bugzilla.redhat.com/page.cgi?id=user_activity.html)
  + Plotly Reports
    - [Bug Status](https://bugzilla.redhat.com/page.cgi?id=bug_status.html)
    - [Bug Severity](https://bugzilla.redhat.com/page.cgi?id=bug_severity.html)
    - [Non-Defaults](https://bugzilla.redhat.com/page.cgi?id=non_defaults.html)
* [Product Dashboard](page.cgi?id=productdashboard.html)

- Help
  * [Page Help!](docs/en/html/using/understanding.html)
  * [Bug Writing Guidelines](page.cgi?id=bug-writing.html)
  * [What's new](page.cgi?id=whats-new.html)
  * [Browser Support Policy](https://access.redhat.com/help/browsers)
  * [5.0.4.rh103 Release notes](page.cgi?id=release-notes.html)
  * [FAQ](page.cgi?id=faq.html)
  * [Guides index](docs/en/html/index.html)
  * [User guide](docs/en/html/using/index.html)
  * [Web Services](docs/en/html/integrating/api/Bugzilla/WebService/Bug.html)
  * [Contact](page.cgi?id=redhat/contact.html)
  * [Legal](page.cgi?id=terms-conditions.html)
- [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")

This site requires JavaScript to be enabled to function correctly, please enable it.

[**Bug 2075074**](show_bug.cgi?id=2075074)
(CVE-2022-1348)
- [CVE-2022-1348](https://access.redhat.com/security/cve/CVE-2022-1348) logrotate: potential DoS from unprivileged users via the state file

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
CVE-2022-1348 logrotate: potential DoS from unprivileged users via the state ...

| | [Keywords](describekeywords.cgi): | Security | | --- | --- | | [Status](page.cgi?id=fields.html#bug_status): | CLOSED ERRATA | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | CVE-2022-1348 | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components. Select a Classification to narrow down this list.") | Security Response | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Other | | [Component:](describecomponents.cgi?product=Security Response "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | vulnerability | | [Sub Component:](page.cgi?id=fields.html#rh_sub_components "The sub component of a specific component") | --- | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | unspecified | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | All | | [OS:](page.cgi?id=fields.html#op_sys "The operating system the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Linux | | [Priority:](page.cgi?id=fields.html#priority) | medium | | [Severity:](page.cgi?id=fields.html#bug_severity) | medium | | [Target Milestone:](page.cgi?id=fields.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | --- | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Red Hat Product Security | | [QA Contact:](page.cgi?id=fields.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") |  | | [Docs Contact:](page.cgi?id=fields.html#docs_contact "The person responsible for documenting once the bug has been resolved.") |  | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") |  | | [Depends On:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") | [2075221](show_bug.cgi?id=2075221) [2090272](show_bug.cgi?id=2090272 "CLOSED ERRATA - CVE-2022-1348 logrotate: potential DoS from unprivileged users via the state file [fedora-all]") | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") | [2073997](show_bug.cgi?id=2073997) [2075165](show_bug.cgi?id=2075165) | | TreeView+ | [depends on](buglist.cgi?bug_id=2075074&bug_id_type=anddependson&format=tvp) / [blocked](buglist.cgi?bug_id=2075074&bug_id_type=andblocked&format=tvp&tvp_dir=blocked) |  | |  | | [Reported:](page.cgi?id=fields.html#reporter) | 2022-04-13 14:31 UTC by Guilherme de Almeida Suckevicz | | --- | --- | | [Modified:](page.cgi?id=fields.html#modified) | 2022-12-06 19:03 UTC ([History](show_activity.cgi?id=2075074)) | | [CC List:](page.cgi?id=fields.html#cclist) | 12 users (show)  cgzones gparvin jkaluza jramanat kdudka kvolny lzaoral njean pahickey security-response-team stcannon svashisht | | Fixed In Version: | logrotate-3.20.1 | | | Doc Type: | If docs needed, set a value | | | Doc Text: | A vulnerability was found in logrotate in how the state file is created. The state file is used to prevent parallel executions of multiple instances of logrotate by acquiring and releasing a file lock. When the state file does not exist, it is created with world-readable permission, allowing an unprivileged user to lock the state file, stopping any rotation. | | | Clone Of: |  | | | Environment: |  | | | Last Closed: | 2022-12-06 19:03:11 UTC | | | Embargoed: |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | [(Terms of Use)](page.cgi?id=terms-conditions.html) | | | --- | --- | --- | |  | | |    Links | System | ID | Private | Priority | Status | Summary | Last Updated | | Red Hat Product Errata | [RHSA-2022:8393](https://access.redhat.com/errata/RHSA-2022%3A8393) | 0 | None | None | None | 2022-11-15 11:06:26 UTC | |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=2075074#c0)  Guilherme de Almeida Suckevicz    2022-04-13 14:31:36 UTC  ``` A vulnerability was found in logrotate in versions 3.17.0 and newer in the way the state file is created. The state file is used to prevent parallel executions of multiple instances of logrotate by acquiring and releasing a file lock. When the state file does not exist, it is created with a default permission mode of 0644, and with an umask of 0022 results in a world-readable file allowing an unprivileged user to lock the state file, stopping any rotation.  References: <https://github.com/logrotate/logrotate/blame/master/logrotate.c#L3015-L3017> <https://github.com/logrotate/logrotate/commit/f46d0bdfc9c53515c13880c501f4d2e1e7dd8b25>   ```  [Comment 5](show_bug.cgi?id=2075074#c5)  Kamil Dudka    2022-05-05 13:01:17 UTC  ``` What are the next steps?  I believe we can use the patch provided to me privately by Christian.  We should schedule the unembargo date to match the next release of logrotate (no specific date planned yet) and announce the issue securely to other software vendors, along with unembargo date and the patch?   ```  [Comment 6](show_bug.cgi?id=2075074#c6)  Guilherme de Almeida Suckevicz    2022-05-05 13:21:52 UTC  ``` The next step is to unembargo the flaw and to report the CVE to Mitre.  The unembargo date is up to reporter and upstream, Christian and you on this case. For us, the sooner the better, as this issue was rated with a moderate severity.  We can announce this issue to linux-distros mailing list, but they have a embargo policy and the maximum acceptable embargo period there is 14 days.   ```  [Comment 7](show_bug.cgi?id=2075074#c7)  Kamil Dudka    2022-05-05 14:09:46 UTC  ``` We used to release logrotate on Fridays, which is not optimal for announcement of a security issue I guess...  If we released logrotate-3.20.0 on Wednesday May 25th, would it work as unembargo date?   ```  [Comment 8](show_bug.cgi?id=2075074#c8)  Guilherme de Almeida Suckevicz    2022-05-06 13:19:38 UTC  ``` Yes, security announcements are usually not done on Fridays.  May 25th sounds good.   ```  [Comment 11](show_bug.cgi?id=2075074#c11)  Kamil Dudka    2022-05-18 08:27:38 UTC  ``` As pointed out by a member of openwall, we should also change the upstream spec file to reflect the permission change (and perhaps to defer its creation to the first run of logrotate?):  --- a/logrotate.spec.in +++ b/logrotate.spec.in @@ -41,7 +41,6 @@ install -p -m 644 examples/logrotate.conf $RPM_BUILD_ROOT%{_sysconfdir}/logrotat  install -p -m 644 examples/btmp $RPM_BUILD_ROOT%{_sysconfdir}/logrotate.d/btmp  install -p -m 644 examples/wtmp $RPM_BUILD_ROOT%{_sysconfdir}/logrotate.d/wtmp  install -p -m 755 examples/logrotate.cron $RPM_BUILD_ROOT%{_sysconfdir}/cron.daily/logrotate -touch $RPM_BUILD_ROOT%{_localstatedir}/lib/logrotate.status   %clean  rm -rf $RPM_BUILD_ROOT @@ -55,4 +54,4 @@ rm -rf $RPM_BUILD_ROOT  %attr(0755, root, root) %{_sysconfdir}/cron.daily/logrotate  %attr(0644, root, root) %config(noreplace) %{_sysconfdir}/logrotate.conf  %attr(0755, root, root) %{_sysconfdir}/logrotate.d -%attr(0644, root, root) %verify(not size md5 mtime) %config(noreplace) %{_localstatedir}/lib/logrotate.status +%ghost %attr(0640, root, root) %verify(not size md5 mtime) %{_localstatedir}/lib/logrotate.status   ```  [Comment 14](show_bug.cgi?id=2075074#c14)  Kamil Dudka    2022-05-25 07:15:36 UTC  ``` logrotate-3.20.0, which contains the fix for this security issue, has been released:      <https://github.com/logrotate/logrotate/releases/tag/3.20.0>   ```  [Comment 15](show_bug.cgi?id=2075074#c15)  Kamil Dudka    2022-05-25 07:39:44 UTC  ``` Upstream fix for CVE-2022-1348:      <https://github.com/logrotate/logrotate/commit/1f76a381e2caa0603ae3dbc51ed0f1aa0d6658b9>   ```  [Comment 16](show_bug.cgi?id=2075074#c16)  Kamil Dudka    2022-05-25 08:08:13 UTC  ``` I have realized that the code to remove the worl-readable permission bit on state file did not work well with ACLs.  The following upstream pull request should fix it:      <https://github.com/logrotate/logrotate/pull/446>   ```  [Comment 18](show_bug.cgi?id=2075074#c18)  Guilherme de Almeida Suckevicz    2022-05-25 13:16:16 UTC  ``` Created logrotate tracking bugs for this issue:  Affects: fedora-all [[bug 2090272](show_bug.cgi?id=2090272 "CLOSED ERRATA - CVE-2022-1348 logrotate: potential DoS from unprivileged users via the state file [fedora-all]")]   ```  [Comment 19](show_bug.cgi?id=2075074#c19)  Kamil Dudka    2022-05-25 15:37:42 UTC  ``` A bug-fix release logrotate-3.20.1 has been released:      <https://github.com/logrotate/logrotate/releases/tag/3.20.1>  The following two commits should be cherry-picked for older releases of logrotate (from 3.17.0 to 3.19.0):      <https://github.com/logrotate/logrotate/commit/1f76a381e2caa0603ae3dbc51ed0f1aa0d6658b9>     <https://github.com/logrotate/logrotate/commit/addbd293242b0b78aa54f054e6c1d249451f137d>   ```  [Comment 20](show_bug.cgi?id=2075074#c20)  errata-xmlrpc    2022-11-15 11:06:24 UTC  ``` This issue has been addressed in the following products:    Red Hat Enterprise Linux 9  Via RHSA-2022:8393 [https://access.redhat.com/errata/RHSA-2022:8393](https://access.redhat.com/errata/RHSA-2022%3A8393)   ```  [Comment 21](show_bug.cgi?id=2075074#c21)  Karel Volný    2022-11-23 14:33:11 UTC  ``` the test for this issue fails also on older RHELs ... aren't we going to fix it there too, at least rhel8 which will have an erratum in 8.8?   ```  [Comment 22](show_bug.cgi?id=2075074#c22)  Guilherme de Almeida Suckevicz    2022-11-23 15:04:48 UTC  ``` In reply to [comment #21](show_bug.cgi?id=2075074#c21): > the test for this issue fails also on older RHELs ... aren't we going to fix > it there too, at least rhel8 which will have an erratum in 8.8?  Hi, this issue was introduced in upstream in versions 3.17.0 and newer, rhel-8 ships logrotate-3.14 and does not contain the vulnerable code, therefore it's not affected.  Also, the security-response-team address is not monitored, so needinfo for this address has no affect.  Thanks.   ```  [Comment 23](show_bug.cgi?id=2075074#c23)  Kamil Dudka    2022-11-23 15:07:05 UTC  ``` State file locking was introduced in logrotate-3.17.0 while we have logrotate-3.14.0 in RHEL-8.  The security issue does not affect RHEL-8 for sure.  How exactly did the test fail?  In an affected version of logrotate, the test would fail like this: ``` Running test 92 reading config file test-config.92 error: state file state is already locked logrotate does not support parallel execution on the same set of logfiles. ```   ```  [Comment 24](show_bug.cgi?id=2075074#c24)  Karel Volný    2022-11-23 16:06:20 UTC  ``` (In reply to Kamil Dudka from [comment #23](show_bug.cgi?id=2075074#c23)) > State file locking was introduced in logrotate-3.17.0 while we have > logrotate-3.14.0 in RHEL-8.  The security issue does not affect RHEL-8 for > sure.  How exactly did the test fail? >  > In an affected version of logrotate, the test would fail like this: > ``` > Running test 92 > reading config file test-config.92 > error: state file state is already locked > logrotate does not support parallel execution on the same set of logfiles. > ```  no, this message is not present, the test complains about file being readable -  :: [ 07:36:48 ] :: [  BEGIN   ] :: Running 'logrotate /etc/logrotate.conf' :: [ 07:36:48 ] :: [   PASS   ] :: Command 'logrotate /etc/logrotate.conf' (Expected 0, got 0) :: [ 07:36:49 ] :: [  BEGIN   ] :: Unpriviliged user shouldnt be able to read state file :: actually running 'su tester-cve-2022-1348 -c 'cat /var/lib/logrotate/logrotate.status'' logrotate state -- version 2 "/var/log/sssd/sssd_implicit_files.log" 2022-11-29-7:0:0 "/var/log/firewalld" 2022-11-29-7:0:0 "/var/log/sssd/sssd_nss.log" 2022-11-29-7:0:0 "/var/log/boot.log" 2022-11-29-7:0:0 "/var/log/up2date" 2022-11-29-7:0:0 "/var/log/hawkey.log" 2022-11-29-7:0:0 "/var/log/kvm_stat.csv" 2022-11-29-7:0:0 "/var/log/wtmp" 2022-11-29-7:0:0 "/var/log/chrony/*.log" 2022-11-29-7:0:0 "/var/log/sssd/sssd.log" 2022-11-29-7:0:0 "/var/log/spooler" 2022-11-29-7:0:0 "/var/log/btmp" 2022-11-29-7:0:0 "/var/log/rhsm/rhsmcertd.log" 2022-11-29-7:0:0 "/var/log/maillog" 2022-11-29-7:0:0 "/var/log/my_logDZZ" 2022-11-29-7:0:0 "/var/log/secure" 2022-11-29-7:0:0 "/var/log/rhsm/rhsm.log" 2022-11-29-7:0:0 "/var/log/messages" 2022-11-29-7:0:0 "/var/log/cron" 2022-11-29-7:0:0 :: [ 07:36:49 ] :: [   FAIL   ] :: Unpriviliged user shouldnt be able to read state file (Expected 1, got 0)    <https://beaker.engineering.redhat.com/tasks/executed?recipe_task_id=153042320&recipe_task_id=153042541&recipe_task_id=153042436&recipe_task_id=153042599&recipe_task_id=153042378&recipe_task_id=153042657&old_pkg_tasks=153042541,153042657,153042599&new_pkg_tasks=153042320,153042378,153042436>   so, if I get that right, the patch doesn't fix the core of the problem but rather prevents it from triggering, so the test checks whether the prevention is in place and not whether the problem really happens, which is irrelevant for older releases?  guess I should limit the test to run on RHEL 9+ only then ... sorry for the noise, I'm not the test author and this scenario is not something I had expected   ```  [Comment 25](show_bug.cgi?id=2075074#c25)  Kamil Dudka    2022-11-23 16:30:53 UTC  ``` I though you were talking about the upstream test [1].  The downstream test [2] seems correct but it is just not applicable on RHEL-8 and older.  To clarify the fix, it is not an issue if the state file is readable by non-privileged users in RHEL-8.  There is nothing secret in the file and if the file is locked on RHEL-8, nobody cares.  If a non-privileged user locks the state file on RHEL-9, they cause the system job triggered by logrotate.timer to fail with the error pasted in [comment #23](show_bug.cgi?id=2075074#c23).  The code raising the error does not exist in RHEL-8 logrotate, so there is no [CVE-2022-1348](https://access.redhat.com/security/cve/CVE-2022-1348) in RHEL-8 logrotate.  [1] <https://pkgs.devel.redhat.com/cgit/rpms/logrotate/tree/0004-logrotate-3.18.0-CVE-2022-1348.patch?h=rhel-9-main&id=b90be9f1f55909b15ef5298883461e560e62f2d3#n108> [2] <https://pkgs.devel.redhat.com/cgit/tests/logrotate/tree/Security/CVE-2022-1348-logrotate-potential-dos-from-unpriviliged-users-via-the-state-file/runtest.sh?id=c261d6ad7ab3f6c73f7d70f999f75efc773ce198>   ```  [Comment 26](show_bug.cgi?id=2075074#c26)  Product Security DevOps Team    2022-12-06 19:03:09 UTC  ``` This bug is now closed. Further updates for individual products will be reflected on the CVE page(s):  <https://access.redhat.com/security/cve/cve-2022-1348>   ``` |  |
| --- | --- |

---

| Note You need to [log in](show_bug.cgi?id=2075074&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. |
| --- |

---

[Privacy](page.cgi?id=redhat/privacy.html)
[Contact](page.cgi?id=redhat/contact.html)
[FAQ](page.cgi?id=faq.html)
[Legal](page.cgi?id=terms-conditions.html)



=== Content from www.openwall.com_533f1383_20250108_122157.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](2) [[next>]](4) [[thread-next>]](4) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <5618910.DvuYhMxLoT@nbkamil>
Date: Wed, 25 May 2022 15:37:24 +0200
From: Kamil Dudka <kdudka@...hat.com>
To: Marc Deslauriers <marc.deslauriers@...onical.com>
Cc: oss-security@...ts.openwall.com, Guilherme de Almeida Suckevicz <gsuckevi@...hat.com>
Subject: Re: CVE-2022-1348 logrotate: potential DoS from unprivileged users via the state file

On Wednesday, May 25, 2022 3:19:31 PM CEST Marc Deslauriers wrote:
> On 2022-05-18 09:54, Kamil Dudka wrote:
> > The current version of the patch to fix CVE-2022-1348 in logrotate is
> > attached.  We are going to apply the patch upstream on May 25th, when
> > the embargo is lifted.
>
> FWIW, I don't think the patch actually works when logrotate is built with
> ACL support...
>
> Marc.

You are right.  Although the patch mitigates the security issue, it is not
perfect.  I had already opened an upstream pull request to improve it:

    <https://github.com/logrotate/logrotate/pull/446>

I might create a bug fix release soon with the patch included.

Sorry for the troubles!

Kamil

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from github.com_e8bf95aa_20250108_152914.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Flogrotate%2Flogrotate%2Fpull%2F446)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Flogrotate%2Flogrotate%2Fpull%2F446)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=logrotate%2Flogrotate)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[logrotate](/logrotate)
/
**[logrotate](/logrotate/logrotate)**
Public

* [Notifications](/login?return_to=%2Flogrotate%2Flogrotate) You must be signed in to change notification settings
* [Fork
  201](/login?return_to=%2Flogrotate%2Flogrotate)
* [Star
   1.3k](/login?return_to=%2Flogrotate%2Flogrotate)

* [Code](/logrotate/logrotate)
* [Issues
  47](/logrotate/logrotate/issues)
* [Pull requests
  7](/logrotate/logrotate/pulls)
* [Actions](/logrotate/logrotate/actions)
* [Projects
  0](/logrotate/logrotate/projects)
* [Wiki](/logrotate/logrotate/wiki)
* [Security](/logrotate/logrotate/security)
* [Insights](/logrotate/logrotate/pulse)

Additional navigation options

* [Code](/logrotate/logrotate)
* [Issues](/logrotate/logrotate/issues)
* [Pull requests](/logrotate/logrotate/pulls)
* [Actions](/logrotate/logrotate/actions)
* [Projects](/logrotate/logrotate/projects)
* [Wiki](/logrotate/logrotate/wiki)
* [Security](/logrotate/logrotate/security)
* [Insights](/logrotate/logrotate/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Flogrotate%2Flogrotate%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Flogrotate%2Flogrotate%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# drop world-readable permission on state file #446

 Merged

[kdudka](/kdudka)
merged 1 commit into
[logrotate:master](/logrotate/logrotate/tree/master "logrotate/logrotate:master")
from
[kdudka:state-perm](/kdudka/logrotate/tree/state-perm "kdudka/logrotate:state-perm")

May 25, 2022

 Merged

# [drop world-readable permission on state file](#top) #446

[kdudka](/kdudka)
merged 1 commit into
[logrotate:master](/logrotate/logrotate/tree/master "logrotate/logrotate:master")
from
[kdudka:state-perm](/kdudka/logrotate/tree/state-perm "kdudka/logrotate:state-perm")

May 25, 2022

[Conversation
2](/logrotate/logrotate/pull/446)
[Commits
1](/logrotate/logrotate/pull/446/commits)
[Checks
0](/logrotate/logrotate/pull/446/checks)
[Files changed](/logrotate/logrotate/pull/446/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![kdudka](https://avatars.githubusercontent.com/u/227483?s=60&v=4)](/kdudka)

Copy link

Member

### @kdudka **[kdudka](/kdudka)** commented [May 25, 2022](#issue-1247718399)

... even when ACLs are enabled. This is a follow-up to the fix

of [CVE-2022-1348](https://github.com/advisories/GHSA-4c4j-w8hm-rjgv "CVE-2022-1348"). It has no impact on security but makes the state

file locking work again in more cases.

Sorry, something went wrong.

All reactions

 [![@kdudka](https://avatars.githubusercontent.com/u/227483?s=40&v=4)](/kdudka)
[kdudka](/kdudka)
requested a review
from [cgzones](/cgzones)
[May 25, 2022 08:05](#event-6675521621)

[![@kdudka](https://avatars.githubusercontent.com/u/227483?s=40&v=4)](/kdudka)

`[drop world-readable permission on state file](/logrotate/logrotate/pull/446/commits/addbd293242b0b78aa54f054e6c1d249451f137d "drop world-readable permission on state file

... even when ACLs are enabled.  This is a follow-up to the fix
of CVE-2022-1348.  It has no impact on security but makes the state
file locking work again in more cases.

Closes: https://github.com/logrotate/logrotate/pull/446")`
 …

`[addbd29](/logrotate/logrotate/pull/446/commits/addbd293242b0b78aa54f054e6c1d249451f137d)`

```
... even when ACLs are enabled.  This is a follow-up to the fix
of [CVE-2022-1348](https://github.com/advisories/GHSA-4c4j-w8hm-rjgv "CVE-2022-1348").  It has no impact on security but makes the state
file locking work again in more cases.

Closes: [logrotate#446](https://github.com/logrotate/logrotate/pull/446)
```

 [![@kdudka](https://avatars.githubusercontent.com/u/227483?s=40&v=4)](/kdudka)
[kdudka](/kdudka)
[force-pushed](/logrotate/logrotate/compare/d91b15339aeec186b98ff903373861fb17c55f9b..addbd293242b0b78aa54f054e6c1d249451f137d)
the
state-perm

branch
from
[`d91b153`](/logrotate/logrotate/commit/d91b15339aeec186b98ff903373861fb17c55f9b) to
[`addbd29`](/logrotate/logrotate/commit/addbd293242b0b78aa54f054e6c1d249451f137d)  [Compare](/logrotate/logrotate/compare/d91b15339aeec186b98ff903373861fb17c55f9b..addbd293242b0b78aa54f054e6c1d249451f137d)
[May 25, 2022 08:09](#event-6675546156)

[![@lzaoral](https://avatars.githubusercontent.com/u/48823770?s=80&v=4)](/lzaoral)

Copy link

### **[lzaoral](/lzaoral)** commented [May 25, 2022](#issuecomment-1137413965)

| LGTM, [@kdudka](https://github.com/kdudka). |
| --- |

All reactions

Sorry, something went wrong.

[![@kdudka](https://avatars.githubusercontent.com/u/227483?s=80&v=4)](/kdudka)

Copy link

Member

Author

### **[kdudka](/kdudka)** commented [May 25, 2022](#issuecomment-1137429910)

| Thanks for review! Merging... |
| --- |

All reactions

Sorry, something went wrong.

[![@kdudka](https://avatars.githubusercontent.com/u/227483?s=40&v=4)](/kdudka)
[kdudka](/kdudka)
merged commit [`addbd29`](/logrotate/logrotate/commit/addbd293242b0b78aa54f054e6c1d249451f137d)
into
logrotate:master

[May 25, 2022](https://github.com/logrotate/logrotate/pull/446#event-6678797995)

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Flogrotate%2Flogrotate%2Fpull%2F446)

Reviewers

[![@cgzones](https://avatars.githubusercontent.com/u/6131885?s=40&v=4)](/cgzones) [cgzones](/cgzones)

 Awaiting requested review from cgzones

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

Successfully merging this pull request may close these issues.

2 participants

[![@kdudka](https://avatars.githubusercontent.com/u/227483?s=52&v=4)](/kdudka) [![@lzaoral](https://avatars.githubusercontent.com/u/48823770?s=52&v=4)](/lzaoral)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from lists.fedoraproject.org_d11b7485_20250108_122159.html ===


[![Fedora Mailing-Lists](/static/logo-hyperkitty-fedora.png)](/archives/ "Fedora Mailing-Lists")

[Sign In](/accounts/login/?next=/archives/list/package-announce%40lists.fedoraproject.org/message/ZYEB4F37BY6GLEJKP2EPVAVQ6TA3HQKR/)
[Sign Up](/accounts/signup/?next=/archives/list/package-announce%40lists.fedoraproject.org/message/ZYEB4F37BY6GLEJKP2EPVAVQ6TA3HQKR/)

* [Sign In](/accounts/login/?next=/archives/list/package-announce%40lists.fedoraproject.org/message/ZYEB4F37BY6GLEJKP2EPVAVQ6TA3HQKR/)
* [Sign Up](/accounts/signup/?next=/archives/list/package-announce%40lists.fedoraproject.org/message/ZYEB4F37BY6GLEJKP2EPVAVQ6TA3HQKR/)

* [Manage this list](/admin/lists/package-announce.lists.fedoraproject.org/)

×
#### Keyboard Shortcuts

### Thread View

* `j`: Next unread message
* `k`: Previous unread message
* `j a`: Jump to all threads* `j l`: Jump to MailingList overview

### 2025

* [January](/archives/list/package-announce%40lists.fedoraproject.org/2025/1/)

### 2024

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2024/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2024/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2024/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2024/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2024/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2024/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2024/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2024/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2024/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2024/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2024/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2024/1/)

### 2023

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2023/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2023/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2023/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2023/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2023/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2023/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2023/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2023/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2023/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2023/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2023/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2023/1/)

### 2022

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2022/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2022/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2022/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2022/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2022/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2022/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2022/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2022/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2022/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2022/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2022/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2022/1/)

### 2021

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2021/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2021/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2021/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2021/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2021/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2021/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2021/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2021/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2021/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2021/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2021/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2021/1/)

### 2020

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2020/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2020/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2020/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2020/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2020/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2020/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2020/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2020/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2020/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2020/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2020/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2020/1/)

### 2019

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2019/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2019/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2019/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2019/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2019/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2019/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2019/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2019/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2019/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2019/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2019/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2019/1/)

### 2018

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2018/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2018/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2018/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2018/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2018/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2018/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2018/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2018/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2018/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2018/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2018/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2018/1/)

### 2017

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2017/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2017/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2017/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2017/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2017/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2017/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2017/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2017/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2017/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2017/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2017/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2017/1/)

### 2016

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2016/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2016/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2016/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2016/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2016/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2016/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2016/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2016/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2016/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2016/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2016/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2016/1/)

### 2015

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2015/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2015/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2015/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2015/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2015/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2015/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2015/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2015/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2015/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2015/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2015/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2015/1/)

### 2014

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2014/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2014/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2014/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2014/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2014/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2014/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2014/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2014/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2014/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2014/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2014/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2014/1/)

### 2013

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2013/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2013/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2013/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2013/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2013/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2013/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2013/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2013/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2013/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2013/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2013/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2013/1/)

### 2012

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2012/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2012/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2012/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2012/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2012/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2012/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2012/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2012/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2012/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2012/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2012/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2012/1/)

### 2011

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2011/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2011/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2011/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2011/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2011/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2011/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2011/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2011/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2011/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2011/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2011/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2011/1/)

### 2010

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2010/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2010/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2010/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2010/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2010/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2010/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2010/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2010/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2010/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2010/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2010/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2010/1/)

### 2009

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2009/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2009/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2009/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2009/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2009/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2009/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2009/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2009/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2009/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2009/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2009/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2009/1/)

### 2008

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2008/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2008/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2008/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2008/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2008/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2008/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2008/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2008/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2008/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2008/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2008/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2008/1/)

### 2007

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2007/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2007/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2007/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2007/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2007/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2007/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2007/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2007/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2007/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2007/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2007/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2007/1/)

### 2006

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2006/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2006/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2006/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2006/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2006/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2006/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2006/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2006/5/)

[List overview](/archives/list/package-announce%40lists.fedoraproject.org/)

[Download](/archives/list/package-announce%40lists.fedoraproject.org/export/package-announce%40lists.fedoraproject.org-ZYEB4F37BY6GLEJKP2EPVAVQ6TA3HQKR.mbox.gz?message=ZYEB4F37BY6GLEJKP2EPVAVQ6TA3HQKR "This message in gzipped mbox format")

[thread](/archives/list/package-announce%40lists.fedoraproject.org/thread/ZYEB4F37BY6GLEJKP2EPVAVQ6TA3HQKR/#ZYEB4F37BY6GLEJKP2EPVAVQ6TA3HQKR)

# [SECURITY] Fedora 36 Update: logrotate-3.20.1-1.fc36

![](https://seccdn.libravatar.org/avatar/be256568dfce45c1862b55e6cf3f2726.jpg?s=120&d=retro&r=g)

[updates＠fedoraproject.org](/archives/users/3d8bb2e4c1d843beb492d4f8a7c44761/ "See the profile for updates＠fedoraproject.org")

28 May
2022

28 May
'22

3:16 a.m.

--------------------------------------------------------------------------------
Fedora Update Notification
FEDORA-2022-87c0f05204
2022-05-28 01:13:38.361007
--------------------------------------------------------------------------------

Name : logrotate
Product : Fedora 36
Version : 3.20.1
Release : 1.fc36
URL : <https://github.com/logrotate/logrotate>
Summary : Rotates, compresses, removes and mails system log files
Description :
The logrotate utility is designed to simplify the administration of
log files on a system which generates a lot of log files. Logrotate
allows for the automatic rotation compression, removal and mailing of
log files. Logrotate can be set to handle a log file daily, weekly,
monthly or when the log file gets to a certain size.

Install the logrotate package if you need a utility to deal with the
log files on your system.

--------------------------------------------------------------------------------
Update Information:

- fix potential DoS from unprivileged users via the state file (CVE-2022-1348)
--------------------------------------------------------------------------------
ChangeLog:

\* Wed May 25 2022 Kamil Dudka kdudka@redhat.com - 3.20.1-1
- new upstream version 3.20.1, which fixes the following security issue:
CVE-2022-1348 - potential DoS from unprivileged users via the state file
\* Tue Mar 15 2022 Kamil Dudka kdudka@redhat.com - 3.19.0-3
- verify GPG signature of upstream tarball when building the package
--------------------------------------------------------------------------------
References:

[ 1 ] Bug #2090272 - CVE-2022-1348 logrotate: potential DoS from unprivileged users via the state file [fedora-all]
<https://bugzilla.redhat.com/show_bug.cgi?id=2090272>
--------------------------------------------------------------------------------

This update can be installed with the "dnf" update program. Use
su -c 'dnf upgrade --advisory FEDORA-2022-87c0f05204' at the command
line. For more information, refer to the dnf documentation available at
<http://dnf.readthedocs.io/en/latest/command_ref.html#upgrade-command-label>

All packages are signed with the Fedora Project GPG key. More details on the
GPG keys used by the Fedora Project can be found at
<https://fedoraproject.org/keys>
--------------------------------------------------------------------------------

[0](#like "You must be logged-in to vote.")
[0](#dislike "You must be logged-in to vote.")

Reply

[Back to the thread](/archives/list/package-announce%40lists.fedoraproject.org/thread/ZYEB4F37BY6GLEJKP2EPVAVQ6TA3HQKR/#ZYEB4F37BY6GLEJKP2EPVAVQ6TA3HQKR)

[Back to the list](/archives/list/package-announce%40lists.fedoraproject.org/)

Powered by [HyperKitty](http://hyperkitty.readthedocs.org) version 1.3.7.



=== Content from github.com_66b9b0f3_20250108_152915.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Flogrotate%2Flogrotate%2Fcommit%2Faddbd293242b0b78aa54f054e6c1d249451f137d)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Flogrotate%2Flogrotate%2Fcommit%2Faddbd293242b0b78aa54f054e6c1d249451f137d)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=logrotate%2Flogrotate)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[logrotate](/logrotate)
/
**[logrotate](/logrotate/logrotate)**
Public

* [Notifications](/login?return_to=%2Flogrotate%2Flogrotate) You must be signed in to change notification settings
* [Fork
  201](/login?return_to=%2Flogrotate%2Flogrotate)
* [Star
   1.3k](/login?return_to=%2Flogrotate%2Flogrotate)

* [Code](/logrotate/logrotate)
* [Issues
  47](/logrotate/logrotate/issues)
* [Pull requests
  7](/logrotate/logrotate/pulls)
* [Actions](/logrotate/logrotate/actions)
* [Projects
  0](/logrotate/logrotate/projects)
* [Wiki](/logrotate/logrotate/wiki)
* [Security](/logrotate/logrotate/security)
* [Insights](/logrotate/logrotate/pulse)

Additional navigation options

* [Code](/logrotate/logrotate)
* [Issues](/logrotate/logrotate/issues)
* [Pull requests](/logrotate/logrotate/pulls)
* [Actions](/logrotate/logrotate/actions)
* [Projects](/logrotate/logrotate/projects)
* [Wiki](/logrotate/logrotate/wiki)
* [Security](/logrotate/logrotate/security)
* [Insights](/logrotate/logrotate/pulse)

## Commit

[Permalink](/logrotate/logrotate/commit/addbd293242b0b78aa54f054e6c1d249451f137d)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

drop world-readable permission on state file

[Browse files](/logrotate/logrotate/tree/addbd293242b0b78aa54f054e6c1d249451f137d)
Browse the repository at this point in the history

```
... even when ACLs are enabled.  This is a follow-up to the fix
of [CVE-2022-1348](https://github.com/advisories/GHSA-4c4j-w8hm-rjgv "CVE-2022-1348").  It has no impact on security but makes the state
file locking work again in more cases.

Closes: [#446](https://github.com/logrotate/logrotate/pull/446)
```

* Loading branch information

[![@kdudka](https://avatars.githubusercontent.com/u/227483?s=40&v=4)](/kdudka)

[kdudka](/logrotate/logrotate/commits?author=kdudka "View all commits by kdudka")
committed
May 25, 2022

1 parent
[96e883a](/logrotate/logrotate/commit/96e883a2728ca522711054bab1818cd53236c0c1)

commit addbd29

 Show file tree

 Hide file tree

Showing
**2 changed files**
with
**8 additions**
and
**3 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* logrotate.c
  [logrotate.c](#diff-e787ec20cfd136ac3f0005579d58aaa439dafe5d2bd3880bc25ce759e6f2973b)
* test

  + test/test-0048.sh
    [test-0048.sh](#diff-0ee2e70c2e56db079ce589ed4bb1cd25a4548483a71db841dd5fac8b40f7d496)

## There are no files selected for viewing

10 changes: 7 additions & 3 deletions

10
[logrotate.c](#diff-e787ec20cfd136ac3f0005579d58aaa439dafe5d2bd3880bc25ce759e6f2973b "logrotate.c")

Show comments

[View file](/logrotate/logrotate/blob/addbd293242b0b78aa54f054e6c1d249451f137d/logrotate.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -2593,6 +2593,7 @@ static int writeState(const char \*stateFilename) |
|  |  | struct tm now; |
|  |  | time\_t now\_time, last\_time; |
|  |  | char \*prevCtx; |
|  |  | int force\_mode = 0; |
|  |  |  |
|  |  | if (!strcmp(stateFilename, "/dev/null")) |
|  |  | /\* explicitly asked not to write the state file \*/ |
| Expand Down  Expand Up | | @@ -2664,10 +2665,13 @@ static int writeState(const char \*stateFilename) |
|  |  |  |
|  |  | close(fdcurr); |
|  |  |  |
|  |  | /\* drop world-readable flag to prevent others from locking \*/ |
|  |  | sb.st\_mode &= ~(mode\_t)S\_IROTH; |
|  |  | if (sb.st\_mode & (mode\_t)S\_IROTH) { |
|  |  | /\* drop world-readable flag to prevent others from locking \*/ |
|  |  | sb.st\_mode &= ~(mode\_t)S\_IROTH; |
|  |  | force\_mode = 1; |
|  |  | } |
|  |  |  |
|  |  | fdsave = createOutputFile(tmpFilename, O\_RDWR, &sb, prev\_acl, 0); |
|  |  | fdsave = createOutputFile(tmpFilename, O\_RDWR, &sb, prev\_acl, force\_mode); |
|  |  | #ifdef WITH\_ACL |
|  |  | if (prev\_acl) { |
|  |  | acl\_free(prev\_acl); |
| Expand Down | |  |

1 change: 1 addition & 0 deletions

1
[test/test-0048.sh](#diff-0ee2e70c2e56db079ce589ed4bb1cd25a4548483a71db841dd5fac8b40f7d496 "test/test-0048.sh")

Show comments

[View file](/logrotate/logrotate/blob/addbd293242b0b78aa54f054e6c1d249451f137d/test/test-0048.sh)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -18,6 +18,7 @@ cat > state << EOF |
|  |  | logrotate state -- version 2 |
|  |  | EOF |
|  |  |  |
|  |  | chmod 0640 state |
|  |  | setfacl -m u:nobody:rwx state |
|  |  |  |
|  |  | $RLR test-config.48 || exit 23 |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `addbd29`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Flogrotate%2Flogrotate%2Fcommit%2Faddbd293242b0b78aa54f054e6c1d249451f137d) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from www.openwall.com_bc048945_20250108_122157.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](3) [[next>]](5) [[<thread-prev]](3) [[thread-next>]](5) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <24add3d4-c09d-76d7-0dee-6e0c089ff0e6@canonical.com>
Date: Wed, 25 May 2022 10:07:34 -0400
From: Marc Deslauriers <marc.deslauriers@...onical.com>
To: oss-security@...ts.openwall.com, Kamil Dudka <kdudka@...hat.com>
Cc: Guilherme de Almeida Suckevicz <gsuckevi@...hat.com>
Subject: Re: Re: CVE-2022-1348 logrotate: potential DoS from
 unprivileged users via the state file

On 2022-05-25 09:37, Kamil Dudka wrote:
> On Wednesday, May 25, 2022 3:19:31 PM CEST Marc Deslauriers wrote:
>> On 2022-05-18 09:54, Kamil Dudka wrote:
>>> The current version of the patch to fix CVE-2022-1348 in logrotate is
>>> attached.  We are going to apply the patch upstream on May 25th, when
>>> the embargo is lifted.
>>
>> FWIW, I don't think the patch actually works when logrotate is built with
>> ACL support...
>>
>> Marc.
>
> You are right.  Although the patch mitigates the security issue, it is not
> perfect.  I had already opened an upstream pull request to improve it:
>
>     <https://github.com/logrotate/logrotate/pull/446>
>
> I might create a bug fix release soon with the patch included.
>
> Sorry for the troubles!
>
> Kamil
>
>

Oh! I had not seen that pull request. Thanks, that should solve the issue!

Marc.

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from www.openwall.com_1d824478_20250108_122158.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](4) [[next>]](../../../2022/05/26/1) [[<thread-prev]](4) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <4449206.LvFx2qVVIh@nbkamil>
Date: Wed, 25 May 2022 17:41:03 +0200
From: Kamil Dudka <kdudka@...hat.com>
To: Marc Deslauriers <marc.deslauriers@...onical.com>
Cc: oss-security@...ts.openwall.com, Guilherme de Almeida Suckevicz <gsuckevi@...hat.com>
Subject: Re: Re: CVE-2022-1348 logrotate: potential DoS from unprivileged users via the state file

On Wednesday, May 25, 2022 4:07:34 PM CEST Marc Deslauriers wrote:
> On 2022-05-25 09:37, Kamil Dudka wrote:
> > On Wednesday, May 25, 2022 3:19:31 PM CEST Marc Deslauriers wrote:
> >> On 2022-05-18 09:54, Kamil Dudka wrote:
> >>> The current version of the patch to fix CVE-2022-1348 in logrotate is
> >>> attached.  We are going to apply the patch upstream on May 25th, when
> >>> the embargo is lifted.
> >>
> >> FWIW, I don't think the patch actually works when logrotate is built with
> >> ACL support...
> >>
> >> Marc.
> >
> > You are right.  Although the patch mitigates the security issue, it is not
> >
> > perfect.  I had already opened an upstream pull request to improve it:
> >     <https://github.com/logrotate/logrotate/pull/446>
> >
> > I might create a bug fix release soon with the patch included.
> >
> > Sorry for the troubles!
> >
> > Kamil
>
> Oh! I had not seen that pull request. Thanks, that should solve the issue!
>
> Marc.

Thanks for confirmation!  I have merged the pull request and released 3.20.1:

    <https://github.com/logrotate/logrotate/releases/tag/3.20.1>

The following two commits should be cherry-picked for older releases
of logrotate (from 3.17.0 to 3.19.0):

    <https://github.com/logrotate/logrotate/commit/1f76a381e2caa0603ae3dbc51ed0f1aa0d6658b9>
    <https://github.com/logrotate/logrotate/commit/addbd293242b0b78aa54f054e6c1d249451f137d>

Kamil

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from access.redhat.com_d16d46b9_20250108_152912.html ===


[Skip to navigation](#pfe-navigation)
[Skip to main content](#cp-main)
### Utilities

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)

[![Red Hat Customer Portal](https://access.redhat.com/chrome_themes/nimbus/img/red-hat-customer-portal.svg)](https://access.redhat.com/)

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)
* [Products](https://access.redhat.com/)
  ### Top Products

  + [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
  + [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
  + [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
  [All Products](https://access.redhat.com/products/)

  ### Downloads and Containers

  + [Downloads](https://access.redhat.com/downloads/)
  + [Packages](https://access.redhat.com/downloads/content/package-browser)
  + [Containers](https://catalog.redhat.com/software/containers/explore/)
  ### Top Resources

  + [Documentation](//docs.redhat.com/)
  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Product Compliance](https://access.redhat.com/articles/1202803)
  + [Errata](https://access.redhat.com/errata/)
* [Knowledge](https://access.redhat.com/labs/)
  ### Red Hat Knowledge Center

  + [Knowledgebase Solutions](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Solution)
  + [Knowledgebase Articles](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Article)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Errata](https://access.redhat.com/errata/)
  ### Top Product Docs

  + [Red Hat Enterprise Linux](//docs.redhat.com/en/documentation/red_hat_enterprise_linux/)
  + [Red Hat OpenShift](//docs.redhat.com/en/documentation/openshift_container_platform/)
  + [Red Hat Ansible Automation Platform](//docs.redhat.com/en/documentation/red_hat_ansible_automation_platform/)
  [All Product Docs](//docs.redhat.com/en/products)

  ### [Training and Certification](//www.redhat.com/en/services/training-and-certification)

  + [About](//www.redhat.com/en/services/training-and-certification)
  + [Course Index](//www.redhat.com/en/services/training/all-courses-exams)
  + [Certification Index](//www.redhat.com/en/services/certifications)
  + [Skill Assessment](//skills.ole.redhat.com/)
* [Security](https://access.redhat.com/security/)
  ### [Red Hat Product Security Center](https://access.redhat.com/security)

  + [Security Updates](https://access.redhat.com/security)
  + [Security Advisories](https://access.redhat.com/security/security-updates/#/security-advisories)
  + [Red Hat CVE Database](https://access.redhat.com/security/security-updates/#/cve)
  + [Errata](https://access.redhat.com/errata/)
  ### References

  + [Security Bulletins](https://access.redhat.com/security/vulnerabilities)
  + [Security Measurement](https://www.redhat.com/security/data/metrics/)
  + [Severity Ratings](https://access.redhat.com/security/updates/classification/)
  + [Security Data](https://access.redhat.com/security/data)
  ### Top Resources

  + [Security Labs](https://access.redhat.com/security/security-updates/#/security-labs)
  + [Backporting Policies](https://access.redhat.com/security/updates/backporting/)
  + [Security Blog](//redhat.com/en/blog/channel/security)
* [Support](https://access.redhat.com/support/)
  ### [Red Hat Support](https://access.redhat.com/support/)

  + [Support Cases](https://access.redhat.com/support/cases/)
  + [Troubleshoot](https://access.redhat.com/support/cases/#/troubleshoot)
  + [Get Support](https://access.redhat.com/support/)
  + [Contact Red Hat Support](https://access.redhat.com/support/contact/)
  ### [Red Hat Community Support](https://access.redhat.com/community)

  + [Customer Portal Community](https://access.redhat.com/community/)
  + [Community Discussions](https://access.redhat.com/discussions/)
  + [Red Hat Accelerator Program](https://access.redhat.com/accelerators/)
  ### Top Resources

  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Red Hat JBoss Supported Configurations](https://access.redhat.com/support/configurations/jboss)
  + [Red Hat Insights](https://cloud.redhat.com/insights)

Or [troubleshoot an issue](/support/cases/#/troubleshoot).

English

## Select Your Language

* [English](https://access.redhat.com/changeLanguage?language=en)
* [Français](https://access.redhat.com/changeLanguage?language=fr)
* [한국어](https://access.redhat.com/changeLanguage?language=ko)
* [日本語](https://access.redhat.com/changeLanguage?language=ja)
* [中文 (中国)](https://access.redhat.com/changeLanguage?language=zh_CN)

### Infrastructure and Management

* [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
* [Red Hat Satellite](https://access.redhat.com/products/red-hat-satellite/)
* [Red Hat Subscription Management](https://access.redhat.com/products/red-hat-subscription-management/)
* [Red Hat Insights](https://access.redhat.com/products/red-hat-insights/)
* [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
### Cloud Computing

* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
* [Red Hat OpenStack Platform](https://access.redhat.com/products/red-hat-openstack-platform/)
* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform/)
* [Red Hat OpenShift AI](https://access.redhat.com/products/red-hat-openshift-ai/)
* [Red Hat OpenShift Dedicated](https://access.redhat.com/products/openshift-dedicated-red-hat/)
* [Red Hat Advanced Cluster Security for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-security-for-kubernetes/)
* [Red Hat Advanced Cluster Management for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-management-for-kubernetes/)
* [Red Hat Quay](https://access.redhat.com/products/red-hat-quay/)
* [Red Hat OpenShift Dev Spaces](https://access.redhat.com/products/red-hat-openshift-dev-spaces)
* [Red Hat OpenShift Service on AWS](https://access.redhat.com/products/red-hat-openshift-service-aws)
### Storage

* [Red Hat Gluster Storage](https://access.redhat.com/products/red-hat-storage/)
* [Red Hat Hyperconverged Infrastructure](https://access.redhat.com/products/red-hat-hyperconverged-infrastructure/)
* [Red Hat Ceph Storage](https://access.redhat.com/products/red-hat-ceph-storage/)
* [Red Hat OpenShift Data Foundation](https://access.redhat.com/products/red-hat-openshift-data-foundation)
### Runtimes

* [Red Hat Runtimes](https://access.redhat.com/products/red-hat-runtimes/)
* [Red Hat JBoss Enterprise Application Platform](https://access.redhat.com/products/red-hat-jboss-enterprise-application-platform/)
* [Red Hat Data Grid](https://access.redhat.com/products/red-hat-data-grid/)
* [Red Hat JBoss Web Server](https://access.redhat.com/products/red-hat-jboss-web-server/)
* [Red Hat build of Keycloak](https://access.redhat.com/products/red-hat-build-of-keycloak/)
* [Red Hat support for Spring Boot](https://access.redhat.com/products/spring-boot/)
* [Red Hat build of Node.js](https://access.redhat.com/products/nodejs/)
* [Red Hat build of Quarkus](https://access.redhat.com/products/quarkus/)
### Integration and Automation

* [Red Hat Application Foundations](https://access.redhat.com/products/red-hat-application-foundations/)
* [Red Hat Fuse](https://access.redhat.com/products/red-hat-fuse/)
* [Red Hat AMQ](https://access.redhat.com/products/red-hat-amq/)
* [Red Hat 3scale API Management](https://access.redhat.com/products/red-hat-3scale/)

[All Products](https://access.redhat.com/products/)

**We're sorry but cve-details doesn't work properly without JavaScript enabled. Please enable it to continue.**

[![Red Hat](https://static.redhat.com/libs/redhat/brand-assets/2/corp/logo--on-dark.svg)](https://redhat.com/en)
[X (formerly Twitter)](https://twitter.com/RedHat)
### Quick Links

* [Downloads](https://access.redhat.com/downloads/)
* [Subscriptions](https://access.redhat.com/management)
* [Support Cases](https://access.redhat.com/support)
* [Customer Service](https://access.redhat.com/support/customer-service)
* [Product Documentation](//docs.redhat.com/)

### Help

* [Contact Us](https://access.redhat.com/support/contact/)
* [Customer Portal FAQ](https://access.redhat.com/articles/33844)
* [Log-in Assistance](https://access.redhat.com/help/login_assistance)

### Site Info

* [Trust Red Hat](https://www.redhat.com/en/trust)
* [Browser Support Policy](https://www.redhat.com/en/about/browser-support)
* [Accessibility](https://www.redhat.com/en/about/digital-accessibility)
* [Awards and Recognition](https://access.redhat.com/recognition/)
* [Colophon](https://access.redhat.com/help/colophon/)

### Related Sites

* [redhat.com](https://www.redhat.com/)
* [developers.redhat.com](http://developers.redhat.com/)
* [connect.redhat.com](https://connect.redhat.com/)
* [cloud.redhat.com](https://cloud.redhat.com/)

### Red Hat legal and privacy links

* [About Red Hat](https://redhat.com/en/about/company)
* [Jobs](https://redhat.com/en/jobs)
* [Events](https://redhat.com/en/events)
* [Locations](https://redhat.com/en/about/office-locations)
* [Contact Red Hat](https://redhat.com/en/contact)
* [Red Hat Blog](https://redhat.com/en/blog)
* [Diversity, equity, and inclusion](https://redhat.com/en/about/our-culture/diversity-equity-inclusion)
* [Cool Stuff Store](https://coolstuff.redhat.com/)
* [Red Hat Summit](https://www.redhat.com/en/summit)

 © 2024 Red Hat, Inc.
### Red Hat legal and privacy links

* [Privacy statement](https://redhat.com/en/about/privacy-policy)
* [Terms of use](https://redhat.com/en/about/terms-use)
* [All policies and guidelines](https://redhat.com/en/about/all-policies-guidelines)
* [Digital accessibility](https://redhat.com/en/about/digital-accessibility)



=== Content from github.com_f3a793ed_20250108_152913.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Flogrotate%2Flogrotate%2Fcommit%2F1f76a381e2caa0603ae3dbc51ed0f1aa0d6658b9)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Flogrotate%2Flogrotate%2Fcommit%2F1f76a381e2caa0603ae3dbc51ed0f1aa0d6658b9)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=logrotate%2Flogrotate)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[logrotate](/logrotate)
/
**[logrotate](/logrotate/logrotate)**
Public

* [Notifications](/login?return_to=%2Flogrotate%2Flogrotate) You must be signed in to change notification settings
* [Fork
  201](/login?return_to=%2Flogrotate%2Flogrotate)
* [Star
   1.3k](/login?return_to=%2Flogrotate%2Flogrotate)

* [Code](/logrotate/logrotate)
* [Issues
  47](/logrotate/logrotate/issues)
* [Pull requests
  7](/logrotate/logrotate/pulls)
* [Actions](/logrotate/logrotate/actions)
* [Projects
  0](/logrotate/logrotate/projects)
* [Wiki](/logrotate/logrotate/wiki)
* [Security](/logrotate/logrotate/security)
* [Insights](/logrotate/logrotate/pulse)

Additional navigation options

* [Code](/logrotate/logrotate)
* [Issues](/logrotate/logrotate/issues)
* [Pull requests](/logrotate/logrotate/pulls)
* [Actions](/logrotate/logrotate/actions)
* [Projects](/logrotate/logrotate/projects)
* [Wiki](/logrotate/logrotate/wiki)
* [Security](/logrotate/logrotate/security)
* [Insights](/logrotate/logrotate/pulse)

## Commit

[Permalink](/logrotate/logrotate/commit/1f76a381e2caa0603ae3dbc51ed0f1aa0d6658b9)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

skip locking if state file is world-readable

[Browse files](/logrotate/logrotate/tree/1f76a381e2caa0603ae3dbc51ed0f1aa0d6658b9)
Browse the repository at this point in the history

```
Fixes: [CVE-2022-1348](https://github.com/advisories/GHSA-4c4j-w8hm-rjgv "CVE-2022-1348") - potential DoS from unprivileged users via the state file
Bug: <https://bugzilla.redhat.com/CVE-2022-1348>
```

* Loading branch information

[![@cgzones](https://avatars.githubusercontent.com/u/6131885?s=40&v=4)](/cgzones) [![@kdudka](https://avatars.githubusercontent.com/u/227483?s=40&v=4)](/kdudka)

[cgzones](/logrotate/logrotate/commits?author=cgzones "View all commits by cgzones")
authored and
[kdudka](/logrotate/logrotate/commits?author=kdudka "View all commits by kdudka")
committed
May 24, 2022

1 parent
[c27b2a5](/logrotate/logrotate/commit/c27b2a5b358ea9aa23fc856df7eef025888acce5)

commit 1f76a38

 Show file tree

 Hide file tree

Showing
**6 changed files**
with
**49 additions**
and
**4 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* logrotate.c
  [logrotate.c](#diff-e787ec20cfd136ac3f0005579d58aaa439dafe5d2bd3880bc25ce759e6f2973b)
* logrotate.spec.in
  [logrotate.spec.in](#diff-42daf0f01fac5e2e0d47f1e0a8b3d5c324975461b71df50ba4e998ce6d6e5f43)
* test

  + test/Makefile.am
    [Makefile.am](#diff-0b5cec97f57673e2834901f351d8d4449b408dc480ebb1c58a92cb543cc7bb41)
  + test/test-0087.sh
    [test-0087.sh](#diff-e82e17d4010d94d9099c1acf70a8e53dfb48cddbb0692987f2dee8c3a2440faa)
  + test/test-0092.sh
    [test-0092.sh](#diff-a4d5d1b9e14b2369065372538e4bfb307412b8a6910255a414085d6de712704a)
  + test/test-config.92.in
    [test-config.92.in](#diff-ce3cb0699346a7936785d9e7a75035a00ae81b4e944482987aac414beeac61eb)

## There are no files selected for viewing

24 changes: 22 additions & 2 deletions

24
[logrotate.c](#diff-e787ec20cfd136ac3f0005579d58aaa439dafe5d2bd3880bc25ce759e6f2973b "logrotate.c")

Show comments

[View file](/logrotate/logrotate/blob/1f76a381e2caa0603ae3dbc51ed0f1aa0d6658b9/logrotate.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -2664,6 +2664,9 @@ static int writeState(const char \*stateFilename) |
|  |  |  |
|  |  | close(fdcurr); |
|  |  |  |
|  |  | /\* drop world-readable flag to prevent others from locking \*/ |
|  |  | sb.st\_mode &= ~(mode\_t)S\_IROTH; |
|  |  |  |
|  |  | fdsave = createOutputFile(tmpFilename, O\_RDWR, &sb, prev\_acl, 0); |
|  |  | #ifdef WITH\_ACL |
|  |  | if (prev\_acl) { |
| Expand Down  Expand Up | | @@ -3001,6 +3004,7 @@ static int readState(const char \*stateFilename) |
|  |  | static int lockState(const char \*stateFilename, int skip\_state\_lock) |
|  |  | { |
|  |  | int lockFd; |
|  |  | struct stat sb; |
|  |  |  |
|  |  | if (!strcmp(stateFilename, "/dev/null")) { |
|  |  | return 0; |
| Expand All | | @@ -3012,9 +3016,9 @@ static int lockState(const char \*stateFilename, int skip\_state\_lock) |
|  |  | message(MESS\_DEBUG, "Creating stub state file: %s\n", |
|  |  | stateFilename); |
|  |  |  |
|  |  | /\* create a stub state file with mode 0644 \*/ |
|  |  | /\* create a stub state file with mode 0640 \*/ |
|  |  | lockFd = open(stateFilename, O\_CREAT | O\_EXCL | O\_WRONLY, |
|  |  | S\_IWUSR | S\_IRUSR | S\_IRGRP | S\_IROTH); |
|  |  | S\_IWUSR | S\_IRUSR | S\_IRGRP); |
|  |  | if (lockFd == -1) { |
|  |  | message(MESS\_ERROR, "error creating stub state file %s: %s\n", |
|  |  | stateFilename, strerror(errno)); |
| Expand All | | @@ -3034,6 +3038,22 @@ static int lockState(const char \*stateFilename, int skip\_state\_lock) |
|  |  | return 0; |
|  |  | } |
|  |  |  |
|  |  | if (fstat(lockFd, &sb) == -1) { |
|  |  | message(MESS\_ERROR, "error stat()ing state file %s: %s\n", |
|  |  | stateFilename, strerror(errno)); |
|  |  | close(lockFd); |
|  |  | return 1; |
|  |  | } |
|  |  |  |
|  |  | if (sb.st\_mode & S\_IROTH) { |
|  |  | message(MESS\_ERROR, "state file %s is world-readable and thus can" |
|  |  | " be locked from other unprivileged users." |
|  |  | " Skipping lock acquisition...\n", |
|  |  | stateFilename); |
|  |  | close(lockFd); |
|  |  | return 0; |
|  |  | } |
|  |  |  |
|  |  | if (flock(lockFd, LOCK\_EX | LOCK\_NB) == -1) { |
|  |  | if (errno == EWOULDBLOCK) { |
|  |  | message(MESS\_ERROR, "state file %s is already locked\n" |
| Expand Down | |  |

3 changes: 1 addition & 2 deletions

3
[logrotate.spec.in](#diff-42daf0f01fac5e2e0d47f1e0a8b3d5c324975461b71df50ba4e998ce6d6e5f43 "logrotate.spec.in")

Show comments

[View file](/logrotate/logrotate/blob/1f76a381e2caa0603ae3dbc51ed0f1aa0d6658b9/logrotate.spec.in)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -41,7 +41,6 @@ install -p -m 644 examples/logrotate.conf $RPM\_BUILD\_ROOT%{\_sysconfdir}/logrotat |
|  |  | install -p -m 644 examples/btmp $RPM\_BUILD\_ROOT%{\_sysconfdir}/logrotate.d/btmp |
|  |  | install -p -m 644 examples/wtmp $RPM\_BUILD\_ROOT%{\_sysconfdir}/logrotate.d/wtmp |
|  |  | install -p -m 755 examples/logrotate.cron $RPM\_BUILD\_ROOT%{\_sysconfdir}/cron.daily/logrotate |
|  |  | touch $RPM\_BUILD\_ROOT%{\_localstatedir}/lib/logrotate.status |
|  |  |  |
|  |  | %clean |
|  |  | rm -rf $RPM\_BUILD\_ROOT |
| Expand All | | @@ -55,4 +54,4 @@ rm -rf $RPM\_BUILD\_ROOT |
|  |  | %attr(0755, root, root) %{\_sysconfdir}/cron.daily/logrotate |
|  |  | %attr(0644, root, root) %config(noreplace) %{\_sysconfdir}/logrotate.conf |
|  |  | %attr(0755, root, root) %{\_sysconfdir}/logrotate.d |
|  |  | %attr(0644, root, root) %verify(not size md5 mtime) %config(noreplace) %{\_localstatedir}/lib/logrotate.status |
|  |  | %ghost %attr(0640, root, root) %verify(not size md5 mtime) %{\_localstatedir}/lib/logrotate.status |

1 change: 1 addition & 0 deletions

1
[test/Makefile.am](#diff-0b5cec97f57673e2834901f351d8d4449b408dc480ebb1c58a92cb543cc7bb41 "test/Makefile.am")

Show comments

[View file](/logrotate/logrotate/blob/1f76a381e2caa0603ae3dbc51ed0f1aa0d6658b9/test/Makefile.am)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -90,6 +90,7 @@ TEST\_CASES = \ |
|  |  | test-0089.sh \ |
|  |  | test-0090.sh \ |
|  |  | test-0091.sh \ |
|  |  | test-0092.sh \ |
|  |  | test-0100.sh \ |
|  |  | test-0101.sh \ |
|  |  | test-0102.sh \ |
| Expand Down | |  |

1 change: 1 addition & 0 deletions

1
[test/test-0087.sh](#diff-e82e17d4010d94d9099c1acf70a8e53dfb48cddbb0692987f2dee8c3a2440faa "test/test-0087.sh")

Show comments

[View file](/logrotate/logrotate/blob/1f76a381e2caa0603ae3dbc51ed0f1aa0d6658b9/test/test-0087.sh)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -8,6 +8,7 @@ cleanup 87 |
|  |  | preptest test.log 87 1 |
|  |  |  |
|  |  | touch state |
|  |  | chmod 0640 state |
|  |  |  |
|  |  | $RLR test-config.87 -f & |
|  |  |  |
| Expand Down | |  |

20 changes: 20 additions & 0 deletions

20
[test/test-0092.sh](#diff-a4d5d1b9e14b2369065372538e4bfb307412b8a6910255a414085d6de712704a "test/test-0092.sh")

Show comments

[View file](/logrotate/logrotate/blob/1f76a381e2caa0603ae3dbc51ed0f1aa0d6658b9/test/test-0092.sh)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -0,0 +1,20 @@ |
|  |  | #!/bin/sh |
|  |  |  |
|  |  | . ./test-common.sh |
|  |  |  |
|  |  | # check state file locking |
|  |  | cleanup 92 |
|  |  |  |
|  |  | preptest test.log 92 1 |
|  |  |  |
|  |  | touch state |
|  |  | chmod 0644 state |
|  |  | flock state -c "sleep 10" & |
|  |  |  |
|  |  | $RLR -f test-config.92 || exit 23 |
|  |  |  |
|  |  | checkoutput <<EOF |
|  |  | test.log 0 |
|  |  | test.log.1 0 zero |
|  |  | EOF |
|  |  |  |

4 changes: 4 additions & 0 deletions

4
[test/test-config.92.in](#diff-ce3cb0699346a7936785d9e7a75035a00ae81b4e944482987aac414beeac61eb "test/test-config.92.in")

Show comments

[View file](/logrotate/logrotate/blob/1f76a381e2caa0603ae3dbc51ed0f1aa0d6658b9/test/test-config.92.in)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -0,0 +1,4 @@ |
|  |  | &DIR&/test.log { |
|  |  | rotate 1 |
|  |  | create |
|  |  | } |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `1f76a38`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Flogrotate%2Flogrotate%2Fcommit%2F1f76a381e2caa0603ae3dbc51ed0f1aa0d6658b9) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from access.redhat.com_bbce8bc9_20250108_152913.html ===


[Skip to navigation](#pfe-navigation)
[Skip to main content](#cp-main)
### Utilities

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)

[![Red Hat Customer Portal](https://access.redhat.com/chrome_themes/nimbus/img/red-hat-customer-portal.svg)](https://access.redhat.com/)

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)
* [Products](https://access.redhat.com/)
  ### Top Products

  + [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
  + [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
  + [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
  [All Products](https://access.redhat.com/products/)

  ### Downloads and Containers

  + [Downloads](https://access.redhat.com/downloads/)
  + [Packages](https://access.redhat.com/downloads/content/package-browser)
  + [Containers](https://catalog.redhat.com/software/containers/explore/)
  ### Top Resources

  + [Documentation](//docs.redhat.com/)
  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Product Compliance](https://access.redhat.com/articles/1202803)
  + [Errata](https://access.redhat.com/errata/)
* [Knowledge](https://access.redhat.com/labs/)
  ### Red Hat Knowledge Center

  + [Knowledgebase Solutions](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Solution)
  + [Knowledgebase Articles](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Article)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Errata](https://access.redhat.com/errata/)
  ### Top Product Docs

  + [Red Hat Enterprise Linux](//docs.redhat.com/en/documentation/red_hat_enterprise_linux/)
  + [Red Hat OpenShift](//docs.redhat.com/en/documentation/openshift_container_platform/)
  + [Red Hat Ansible Automation Platform](//docs.redhat.com/en/documentation/red_hat_ansible_automation_platform/)
  [All Product Docs](//docs.redhat.com/en/products)

  ### [Training and Certification](//www.redhat.com/en/services/training-and-certification)

  + [About](//www.redhat.com/en/services/training-and-certification)
  + [Course Index](//www.redhat.com/en/services/training/all-courses-exams)
  + [Certification Index](//www.redhat.com/en/services/certifications)
  + [Skill Assessment](//skills.ole.redhat.com/)
* [Security](https://access.redhat.com/security/)
  ### [Red Hat Product Security Center](https://access.redhat.com/security)

  + [Security Updates](https://access.redhat.com/security)
  + [Security Advisories](https://access.redhat.com/security/security-updates/#/security-advisories)
  + [Red Hat CVE Database](https://access.redhat.com/security/security-updates/#/cve)
  + [Errata](https://access.redhat.com/errata/)
  ### References

  + [Security Bulletins](https://access.redhat.com/security/vulnerabilities)
  + [Security Measurement](https://www.redhat.com/security/data/metrics/)
  + [Severity Ratings](https://access.redhat.com/security/updates/classification/)
  + [Security Data](https://access.redhat.com/security/data)
  ### Top Resources

  + [Security Labs](https://access.redhat.com/security/security-updates/#/security-labs)
  + [Backporting Policies](https://access.redhat.com/security/updates/backporting/)
  + [Security Blog](//redhat.com/en/blog/channel/security)
* [Support](https://access.redhat.com/support/)
  ### [Red Hat Support](https://access.redhat.com/support/)

  + [Support Cases](https://access.redhat.com/support/cases/)
  + [Troubleshoot](https://access.redhat.com/support/cases/#/troubleshoot)
  + [Get Support](https://access.redhat.com/support/)
  + [Contact Red Hat Support](https://access.redhat.com/support/contact/)
  ### [Red Hat Community Support](https://access.redhat.com/community)

  + [Customer Portal Community](https://access.redhat.com/community/)
  + [Community Discussions](https://access.redhat.com/discussions/)
  + [Red Hat Accelerator Program](https://access.redhat.com/accelerators/)
  ### Top Resources

  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Red Hat JBoss Supported Configurations](https://access.redhat.com/support/configurations/jboss)
  + [Red Hat Insights](https://cloud.redhat.com/insights)

Or [troubleshoot an issue](/support/cases/#/troubleshoot).

English

## Select Your Language

* [English](https://access.redhat.com/changeLanguage?language=en)
* [Français](https://access.redhat.com/changeLanguage?language=fr)
* [한국어](https://access.redhat.com/changeLanguage?language=ko)
* [日本語](https://access.redhat.com/changeLanguage?language=ja)
* [中文 (中国)](https://access.redhat.com/changeLanguage?language=zh_CN)

### Infrastructure and Management

* [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
* [Red Hat Satellite](https://access.redhat.com/products/red-hat-satellite/)
* [Red Hat Subscription Management](https://access.redhat.com/products/red-hat-subscription-management/)
* [Red Hat Insights](https://access.redhat.com/products/red-hat-insights/)
* [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
### Cloud Computing

* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
* [Red Hat OpenStack Platform](https://access.redhat.com/products/red-hat-openstack-platform/)
* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform/)
* [Red Hat OpenShift AI](https://access.redhat.com/products/red-hat-openshift-ai/)
* [Red Hat OpenShift Dedicated](https://access.redhat.com/products/openshift-dedicated-red-hat/)
* [Red Hat Advanced Cluster Security for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-security-for-kubernetes/)
* [Red Hat Advanced Cluster Management for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-management-for-kubernetes/)
* [Red Hat Quay](https://access.redhat.com/products/red-hat-quay/)
* [Red Hat OpenShift Dev Spaces](https://access.redhat.com/products/red-hat-openshift-dev-spaces)
* [Red Hat OpenShift Service on AWS](https://access.redhat.com/products/red-hat-openshift-service-aws)
### Storage

* [Red Hat Gluster Storage](https://access.redhat.com/products/red-hat-storage/)
* [Red Hat Hyperconverged Infrastructure](https://access.redhat.com/products/red-hat-hyperconverged-infrastructure/)
* [Red Hat Ceph Storage](https://access.redhat.com/products/red-hat-ceph-storage/)
* [Red Hat OpenShift Data Foundation](https://access.redhat.com/products/red-hat-openshift-data-foundation)
### Runtimes

* [Red Hat Runtimes](https://access.redhat.com/products/red-hat-runtimes/)
* [Red Hat JBoss Enterprise Application Platform](https://access.redhat.com/products/red-hat-jboss-enterprise-application-platform/)
* [Red Hat Data Grid](https://access.redhat.com/products/red-hat-data-grid/)
* [Red Hat JBoss Web Server](https://access.redhat.com/products/red-hat-jboss-web-server/)
* [Red Hat build of Keycloak](https://access.redhat.com/products/red-hat-build-of-keycloak/)
* [Red Hat support for Spring Boot](https://access.redhat.com/products/spring-boot/)
* [Red Hat build of Node.js](https://access.redhat.com/products/nodejs/)
* [Red Hat build of Quarkus](https://access.redhat.com/products/quarkus/)
### Integration and Automation

* [Red Hat Application Foundations](https://access.redhat.com/products/red-hat-application-foundations/)
* [Red Hat Fuse](https://access.redhat.com/products/red-hat-fuse/)
* [Red Hat AMQ](https://access.redhat.com/products/red-hat-amq/)
* [Red Hat 3scale API Management](https://access.redhat.com/products/red-hat-3scale/)

[All Products](https://access.redhat.com/products/)

**We're sorry but cve-details doesn't work properly without JavaScript enabled. Please enable it to continue.**

[![Red Hat](https://static.redhat.com/libs/redhat/brand-assets/2/corp/logo--on-dark.svg)](https://redhat.com/en)
[X (formerly Twitter)](https://twitter.com/RedHat)
### Quick Links

* [Downloads](https://access.redhat.com/downloads/)
* [Subscriptions](https://access.redhat.com/management)
* [Support Cases](https://access.redhat.com/support)
* [Customer Service](https://access.redhat.com/support/customer-service)
* [Product Documentation](//docs.redhat.com/)

### Help

* [Contact Us](https://access.redhat.com/support/contact/)
* [Customer Portal FAQ](https://access.redhat.com/articles/33844)
* [Log-in Assistance](https://access.redhat.com/help/login_assistance)

### Site Info

* [Trust Red Hat](https://www.redhat.com/en/trust)
* [Browser Support Policy](https://www.redhat.com/en/about/browser-support)
* [Accessibility](https://www.redhat.com/en/about/digital-accessibility)
* [Awards and Recognition](https://access.redhat.com/recognition/)
* [Colophon](https://access.redhat.com/help/colophon/)

### Related Sites

* [redhat.com](https://www.redhat.com/)
* [developers.redhat.com](http://developers.redhat.com/)
* [connect.redhat.com](https://connect.redhat.com/)
* [cloud.redhat.com](https://cloud.redhat.com/)

### Red Hat legal and privacy links

* [About Red Hat](https://redhat.com/en/about/company)
* [Jobs](https://redhat.com/en/jobs)
* [Events](https://redhat.com/en/events)
* [Locations](https://redhat.com/en/about/office-locations)
* [Contact Red Hat](https://redhat.com/en/contact)
* [Red Hat Blog](https://redhat.com/en/blog)
* [Diversity, equity, and inclusion](https://redhat.com/en/about/our-culture/diversity-equity-inclusion)
* [Cool Stuff Store](https://coolstuff.redhat.com/)
* [Red Hat Summit](https://www.redhat.com/en/summit)

 © 2024 Red Hat, Inc.
### Red Hat legal and privacy links

* [Privacy statement](https://redhat.com/en/about/privacy-policy)
* [Terms of use](https://redhat.com/en/about/terms-use)
* [All policies and guidelines](https://redhat.com/en/about/all-policies-guidelines)
* [Digital accessibility](https://redhat.com/en/about/digital-accessibility)


