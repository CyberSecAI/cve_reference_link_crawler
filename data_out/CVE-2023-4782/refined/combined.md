=== Content from discuss.hashicorp.com_db62fd7c_20250110_135632.html ===


[HashiCorp Discuss](/)

# [HCSEC-2023-27 - Terraform Allows Arbitrary File Write During Init Operation](/t/hcsec-2023-27-terraform-allows-arbitrary-file-write-during-init-operation/58082)

[Security](/c/security/52)

[security-terraform](https://discuss.hashicorp.com/tag/security-terraform)

[eastebry](https://discuss.hashicorp.com/u/eastebry)

September 8, 2023, 4:33pm

1

**Bulletin ID:** HCSEC-2023-27

**Affected Products / Versions:** Terraform 1.0.8 through 1.5.6; fixed in 1.5.7.

**Publication Date:** September 8, 2023

**Summary**

Terraform 1.0.8 through 1.5.6 allows arbitrary file write during the `init` operation if run on maliciously crafted Terraform configuration. This vulnerability, CVE-2023-4782, was fixed in Terraform 1.5.7.

**Background**

The [core Terraform workflow](https://developer.hashicorp.com/terraform/tutorials/cli/plan) uses 3 main operations; `init`, `plan`, and `apply`.

The Terraform [init](https://developer.hashicorp.com/terraform/cli/commands/init) operation initializes a working directory containing Terraform configuration files, downloading the required modules and providers for subsequent plan and apply operations.

While both the `plan` and `apply` operations are intended to execute the user-supplied Terraform configuration, `init` is intended only to be used for installing dependencies specified in the Terraform configuration.

**Details**

An external party reported that it was possible to coerce Terraform into writing arbitrary files during the `init` operation by supplying a maliciously crafted Terraform configuration.

Terraform considers the provided Terraform configuration to be trusted when executing plan and apply, and does not attempt to defend against malicious modules and providers when executing these operations. By contrast, `init` is intended to be a safer operation, allowing users to review the installed modules and providers prior to executing `plan` or `apply`.

Exposure associated with this issue will depend on the environment in which Terraform is being executed and, for many deployments, may present minimal additional risk. In order for this vulnerability to pose a privilege escalation risk, the following conditions must be met:

1. Terraform `init` is run on untrusted Terraform configuration, or Terraform configuration containing untrusted modules.
2. The Terraform user is relying on security validations performed on the dependencies installed by Terraform `init` prior to running the Terraform `plan` or `apply` operations.

Terraform Cloud and Terraform Enterprise combine the `init` and `plan` operations during Terraform runs, so this issue does not break the documented [security model](https://developer.hashicorp.com/terraform/cloud-docs/architectural-details/security-model). Recommendations for secure use, specifically regarding use of trusted providers / modules and control of access to configuration source code, remain applicable.

**Remediation**

Customers should evaluate the risk associated with this issue, specifically with the conditions above in mind, and consider upgrading to Terraform 1.5.7 or newer.

**Acknowledgement**

HashiCorp thanks Lum14n of Eagle Cloud Security Technology for the discovery of this issue.

*We deeply appreciate any effort to coordinate disclosure of security vulnerabilities. For information about security at HashiCorp and the reporting of security vulnerabilities, please see <https://hashicorp.com/security>.*

### Related topics

| Topic |  | Replies | Views | Activity |
| --- | --- | --- | --- | --- |
| [HCSEC-2021-18 - Terraform Enterprise Allowed Privilege Escalation Via Run Token](https://discuss.hashicorp.com/t/hcsec-2021-18-terraform-enterprise-allowed-privilege-escalation-via-run-token/27070)  [Security](/c/security/52) [security-terraform](https://discuss.hashicorp.com/tag/security-terraform) | 0 | 7273 | July 20, 2021 |
| [HCSEC-2023-26 - Terraform’s Handling Of Duplicate Map Keys In Configurations May Have Security Implications](https://discuss.hashicorp.com/t/hcsec-2023-26-terraform-s-handling-of-duplicate-map-keys-in-configurations-may-have-security-implications/57613)  [Security](/c/security/52) [security-terraform](https://discuss.hashicorp.com/tag/security-terraform) | 0 | 7269 | August 24, 2023 |
| [HCSEC-2024-19 - Terraform Enterprise’s Single Sign-On And Ruby SAML’s CVE-2024-45409](https://discuss.hashicorp.com/t/hcsec-2024-19-terraform-enterprise-s-single-sign-on-and-ruby-saml-s-cve-2024-45409/70203)  [Security](/c/security/52) [security-terraform](https://discuss.hashicorp.com/tag/security-terraform) | 1 | 973 | October 21, 2024 |
| [HCSEC-2020-15 - Terraform Enterprise Allowed Local Account Creation Bypassing SSO](https://discuss.hashicorp.com/t/hcsec-2020-15-terraform-enterprise-allowed-local-account-creation-bypassing-sso/18100)  [Security](/c/security/52) [security-terraform](https://discuss.hashicorp.com/tag/security-terraform) | 0 | 4948 | November 25, 2020 |
| [Terraform Updates for HCSEC-2021-12](https://discuss.hashicorp.com/t/terraform-updates-for-hcsec-2021-12/23570)  [Terraform](/c/terraform-core/27) | 0 | 25866 | April 24, 2021 |

* [Home](/)
* [Categories](/categories)
* [Guidelines](/guidelines)
* [Terms of Service](/tos)
* [Privacy Policy](https://meta.discourse.org/privacy)

Powered by [Discourse](https://www.discourse.org), best viewed with JavaScript enabled


