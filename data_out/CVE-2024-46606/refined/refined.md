Based on the provided content, here's a breakdown of the vulnerability:

**Root Cause:**

- The vulnerability lies in the insufficient sanitization of user-supplied input within the "Description" field when editing a photo in Piwigo's admin panel.

**Weaknesses/Vulnerabilities:**

- **Stored Cross-Site Scripting (XSS):** The primary vulnerability is a stored XSS. An attacker can inject malicious JavaScript code into the photo description field. This script is then stored in the database and executed when other users view the photo.
- **CSRF (Cross-Site Request Forgery):** The exploit leverages a CSRF vulnerability to change the email address of a victim.

**Impact of Exploitation:**

- **Account Takeover:** By changing the victim's email address, the attacker can potentially use the "forgotten password" feature to gain unauthorized access to the victim's account.
- **Arbitrary JavaScript Execution:** An attacker can execute arbitrary JavaScript code in the victim's browser session. This could lead to various malicious actions such as session hijacking, data theft or defacing the website.

**Attack Vectors:**

- **Admin Panel:** An attacker with admin privileges injects a malicious script into the "Description" field of a photo through the admin interface (`/admin.php?page=photo`).
- **Public Album Access:** A regular user (victim) viewing the public photo containing the malicious code triggers the XSS vulnerability when the page is rendered.

**Required Attacker Capabilities/Position:**

- **Initial access:** The attacker needs an admin account to inject the malicious code.
- **Social Engineering (optional):** The attacker needs to ensure a victim user visits the page with the malicious payload. If the album is public, this is easily achieved.

**Technical Details**
The provided exploit code is a JavaScript payload that performs the following actions:
   1.  Creates an XMLHttpRequest to get the profile page.
   2. Extracts the CSRF token from the profile page.
   3.  Sends a POST request to `/photos/profile.php` with the attacker's email address, the extracted CSRF token, and other profile information. This changes the profile email address of the user who views the page.
```html
<script>var req=new XMLHttpRequest;function handleResponse(){var e=this.responseText.match(/name="pwg_token" value="([a-zA-Z0-9]+)"/)[1],s=new XMLHttpRequest;s.open("post","/photos/profile.php",!0),s.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),s.send(`redirect=%2Fphotos%2F&mail_address=changed-by-stored-xss%40mail.com&password=&use_new_pwd=&passwordConf=&nb_image_page=15&theme=modus&language=en_GB&recent_period=7&expand=false&show_nb_hits=false&pwg_token=${e}&validate=Submit`)}req.onload=handleResponse,req.open("get","/photos/profile.php",!0),req.send();</script>
```

**Affected Versions:**

- Piwigo <= 14.5.0

**Additional Notes:**
- The content provides more detail than the typical CVE description by including the actual exploit code and a detailed explanation of the attack steps.
- A proof-of-concept video `poc_2.mp4` is also referenced, further aiding understanding of the exploit.