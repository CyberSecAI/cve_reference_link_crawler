
[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FSquidex%2Fsquidex%2Fsecurity%2Fadvisories%2FGHSA-phqq-8g7v-3pg5)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FSquidex%2Fsquidex%2Fsecurity%2Fadvisories%2FGHSA-phqq-8g7v-3pg5)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=Squidex%2Fsquidex)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[Squidex](/Squidex)
/
**[squidex](/Squidex/squidex)**
Public

* [Notifications](/login?return_to=%2FSquidex%2Fsquidex) You must be signed in to change notification settings
* [Fork
  462](/login?return_to=%2FSquidex%2Fsquidex)
* [Star
   2.3k](/login?return_to=%2FSquidex%2Fsquidex)

* [Code](/Squidex/squidex)
* [Issues
  1](/Squidex/squidex/issues)
* [Pull requests
  3](/Squidex/squidex/pulls)
* [Actions](/Squidex/squidex/actions)
* [Security](/Squidex/squidex/security)
* [Insights](/Squidex/squidex/pulse)

Additional navigation options

* [Code](/Squidex/squidex)
* [Issues](/Squidex/squidex/issues)
* [Pull requests](/Squidex/squidex/pulls)
* [Actions](/Squidex/squidex/actions)
* [Security](/Squidex/squidex/security)
* [Insights](/Squidex/squidex/pulse)

# RCE via Arbitrary File Write

High

[SebastianStehle](/SebastianStehle)
published
GHSA-phqq-8g7v-3pg5
Nov 7, 2023

## Package

No package listed

## Affected versions

7.8.2

## Patched versions

7.9.0

## Description

### Summary

An arbitrary file write vulnerability in the backup restore feature allows an authenticated attacker to gain remote code execution (RCE).

### Details

Squidex allows users with the `squidex.admin.restore` permission to create and restore backups. Part of these backups are the assets uploaded to an App. For each asset, the backup zip archive contains a `.asset` file with the actual content of the asset as well as a related `AssetCreatedEventV2` event, which is stored in a JSON file:

```
$ zipinfo backup.zip
...
-rw-r--r--  3.0 unx       43 tx stor 23-Oct-09 12:04 attachments/176/46c05041-9588-4179-b5eb-ddfcd9463e1e_0.asset
-rw-r--r--  3.0 unx     1184 tx defN 23-Oct-09 12:04 events/0/4.json
...
```

Amongst other things, the JSON file contains the event type (`AssetCreatedEventV2`), the ID of the asset (`46c05041-9588-4179-b5eb-ddfcd9463e1e`), its filename (`test.txt`), and its file version (`0`):

```
$ cat events/0/4.json
{"n":{"t":"AssetCreatedEventV2","s":"asset-33e55647-7db1-4a20-b27b-0f690753a5d5--46c05041-9588-4179-b5eb-ddfcd9463e1e","p":"{\u0022parentId\u0022:\u002200000000-0000-0000-0000-000000000000\u0022,\u0022fileName\u0022:\u0022test.txt\u0022,\u0022fileHash\u0022:\u0022tguDdazklWWU13e5N/3kflTT9vxjvjy4gyxByFts5V8=\u0022,\u0022mimeType\u0022:\u0022text/plain\u0022,\u0022slug\u0022:\u0022test.txt\u0022,\u0022fileVersion\u0022:0,\u0022fileSize\u0022:43,\u0022type\u0022:\u0022Unknown\u0022,\u0022metadata\u0022:{},...}
```

When a backup with this event is restored, the `BackupAssets.ReadAssetAsync` method is responsible for re-creating the asset. For this purpose, it determines the name of the `.asset` file in the zip archive, reads its content, and stores the content in the filestore (by default [FolderAssetStore](https://github.com/Squidex/libs/blob/main/assets/Squidex.Assets/FolderAssetStore.cs)):

```
    private async Task ReadAssetAsync(DomainId appId, DomainId assetId, long fileVersion, IBackupReader reader,
        CancellationToken ct)
    {
        try
        {
     // (1) get name of .asset file in zip archive
            var fileName = GetName(assetId, fileVersion);

     // (2) read content of .asset file
            await using (var stream = await(fileName, ct))
            {
       // (3) store content in filestore
                await assetFileStore.UploadAsync(appId, assetId, fileVersion, null, stream, true, ct);
            }
        }
        catch (FileNotFoundException)
        {
            return;
        }
    }
```

The `GetName` method constructs the name of `.asset` file by using the `assetId` and `fileVersion`:

```
    private static string GetName(DomainId assetId, long fileVersion)
    {
        return $"{assetId}_{fileVersion}.asset";
    }
```

Please notice that this filename is only used to retrieve the `.asset` file from the zip archive. When the asset is stored in the filestore via the `UploadAsync` method, the `assetId` and `fileVersion` are passed as arguments. These are further passed to the method `GetFileName`, which determines the filename where the asset should be stored:

```
    public Task UploadAsync(DomainId appId, DomainId id, long fileVersion, string? suffix, Stream stream, bool overwrite = true,
        CancellationToken ct = default)
    {
        var fileName = GetFileName(appId, id, fileVersion, suffix);
        return assetStore.UploadAsync(fileName, stream, overwrite, ct);
    }
```

The `GetFileName` is slightly different from the `GetName` method. Again, the `assetId` (parameter `id`) is used, but the `fileVersion` is only appended, if it is equal or greater than zero. Also, there is no suffix by default (no `.asset` extension):

```
    private string GetFileName(DomainId appId, DomainId id, long fileVersion = -1, string? suffix = null)
    {
        var sb = new StringBuilder(20);
        // ...
        sb.Append(id);
        if (fileVersion >= 0)
        {
            sb.Append('_');
            sb.Append(fileVersion);
        }
       // ...
        return sb.ToString();
    }
```

In both cases, for the retrieval (`GetName`) and the storage (`GetFileName`) of an asset file, the `assetId` is inserted into the filename without any sanitization.

### Impact

The vulnerability allows an attacker with `squidex.admin.restore` privileges to run arbitrary operating system commands on the underlying server (RCE).

An unauthenticated attacker can combine this vulnerability with an XSS vulnerability to trigger the vulnerability in the context of a user with the required privileges and restore a malicious backup to take over the Squidex instance.

### Severity

High

### CVE ID

CVE-2023-46253

### Weaknesses

[CWE-22](/advisories?query=cwe%3A22)

### Credits

* [![@stefan-schiller-sonarsource](https://avatars.githubusercontent.com/u/110469906?s=40&v=4)](/stefan-schiller-sonarsource)
  [stefan-schiller-sonarsource](/stefan-schiller-sonarsource)
  Reporter

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.

