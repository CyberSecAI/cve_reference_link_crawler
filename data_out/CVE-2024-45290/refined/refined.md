The provided content is related to CVE-2024-45290.

**Root Cause of Vulnerability:**

The vulnerability stems from the lack of proper validation of file paths when opening an XLSX file in PhpSpreadsheet. Specifically, the `setPath()` method, which is called when processing linked images, does not sufficiently sanitize URLs, leading to the acceptance of `file://` and `php://` URLs. This allows an attacker to use specially crafted `php://filter` URLs to trigger an error oracle that leaks file or URL contents one character at a time.

**Weaknesses/Vulnerabilities Present:**

*   **Absolute Path Traversal (CWE-36):** The software does not properly validate paths provided in the XLSX file, allowing access to arbitrary files on the server by providing a `file://` URL.
*   **Server-Side Request Forgery (SSRF) (CWE-918):** The software allows an attacker to make arbitrary HTTP requests by providing a URL as an image path. Furthermore, the use of `php://` wrappers enables access to other protocols, such as the `expect://` wrapper that can lead to remote code execution in some cases.

**Impact of Exploitation:**

An attacker can read arbitrary files on the server, including sensitive information like credentials, configuration files, or source code. They can also make arbitrary HTTP requests to internal or external resources, potentially leading to further attacks or information disclosure.

**Attack Vectors:**

The attacker crafts a malicious XLSX file where image paths are set to crafted `php://filter` URLs. This crafted file is then opened by the vulnerable application, which attempts to process the image paths, triggering the vulnerability.

**Required Attacker Capabilities/Position:**

The attacker needs the ability to create and upload a malicious XLSX file, or otherwise provide this file to be opened by the vulnerable application. No specific privileges are needed, and the attack can be performed remotely.

**Technical Details:**

The vulnerability is located in the `setPath` method of the `PhpOffice\PhpSpreadsheet\Worksheet\Drawing` class. The method uses `filter_var` to validate URLs, but this function also considers `file://` and `php://` URLs as valid, which leads to vulnerabilities.
The PoC shows how to create a modified XLSX file using PHP's ZipArchive, which includes malicious URLs and how to exploit the vulnerability using a Python script (`php_filter_chains_oracle_exploit.py`). The script uses `iconv` and the error oracle technique to leak file content.
The provided content indicates that the vulnerability has been fixed in versions 2.3.0, 1.29.2, and 2.1.1.