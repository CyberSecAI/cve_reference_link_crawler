=== Content from foswiki.org_765f9aae_20250111_110324.html ===


| [Powered by Foswiki, The Free and Open Source Wiki](https://foswiki.org/Home/WebHome) | * Default Български Čeština Dansk Deutsch Ελληνικά English Español Suomi Français Italiano 日本語 한글 Nederlands Norsk Polski Português Português brasileiro Русский Svenska tlhIngan Hol Türkçe Українська 简体中文 正體中文 |
| --- | --- |

* [About](https://foswiki.org/About/WebHome)
* [Blog](http://blog.foswiki.org)
* [Extensions](https://foswiki.org/Extensions/WebHome)
* [Documentation](https://foswiki.org/System/WebHome)
* [Community](https://foswiki.org/Community/WebHome)
* [Development](https://foswiki.org/Development/WebHome)
* [Tasks](https://foswiki.org/Tasks/WebHome)
* [Download](https://foswiki.org/Download/FoswikiRelease02x01x09)
* [Support](https://foswiki.org/Support/WebHome)
* [Sandbox](https://foswiki.org/Sandbox/WebHome)

You are here: [Foswiki](/)>[Support Web](/Support/WebHome)>[SecurityAlert-CVE-2023-33756](/Support/SecurityAlert-CVE-2023-33756 "Topic revision: 2 (06 Aug 2023 - 15:15:39)") (06 Aug 2023, [MichaelDaum](/Main/MichaelDaum))[Edit](/bin/edit/Support/SecurityAlert-CVE-2023-33756?t=1736593403 "Edit this topic text") [Attach](/bin/attach/Support/SecurityAlert-CVE-2023-33756 "Attach an image or document to this topic")  [![txt](/pub/System/DocumentGraphics/txt.png) plain text](/Support/SecurityAlert-CVE-2023-33756?skin=plain;template=SecurityAlertTextView)
# Security Alert: [SpreadSheetPlugin](/Support/SpreadSheetPlugin)'s EVAL feature exposes infromation about paths and files on the server

 ![IDEA!](/pub/System/DocumentGraphics/tip.png "IDEA!") ***Get Alerted:*** *to get immediate alerts* of high priority security issues, please join the low-volume `foswiki-announce` list - details at [Mailing Lists](/Community/MailingLists) By abusing the [SpreadSheetPlugin](/Support/SpreadSheetPlugin) EVAL feature, it is possible to gain infromation about paths and files on the server.

* [Severity Level](#Severity_Level)
* [MITRE Name for this Vulnerability](#MITRE_Name_for_this_Vulnerability)
* [Vulnerable Software Versions](#Vulnerable_Software_Versions)
## Severity Level

Severity 1 issue: The web server can be compromisedThe severity level was assigned by the Foswiki [SecurityTaskTeam](/Community/SecurityTaskTeam) as documented in [SecurityAlertProcess](/Development/SecurityAlertProcess)
## MITRE Name for this Vulnerability

The Common Vulnerabilities and Exposures project has assigned the name [CVE-2023-33756](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-33756) to this vulnerability.
## Vulnerable Software Versions

* [Foswiki 1.0.0](/Download/FoswikiRelease01x00x00), [Foswiki 1.0.0-beta1](/Download/FoswikiRelease01x00x00Beta1), [Foswiki 1.0.0-beta2](/Download/FoswikiRelease01x00x00Beta2), [Foswiki 1.0.0-beta3](/Download/FoswikiRelease01x00x00Beta3), [Foswiki 1.0.1](/Download/FoswikiRelease01x00x01), [Foswiki 1.0.2](/Download/FoswikiRelease01x00x02), [Foswiki 1.0.3](/Download/FoswikiRelease01x00x03), [Foswiki 1.0.4](/Download/FoswikiRelease01x00x04), [Foswiki 1.0.5](/Download/FoswikiRelease01x00x05), [Foswiki 1.0.6](/Download/FoswikiRelease01x00x06), [Foswiki 1.0.7](/Download/FoswikiRelease01x00x07), [Foswiki 1.0.8](/Download/FoswikiRelease01x00x08), [Foswiki 1.0.9](/Download/FoswikiRelease01x00x09), [Foswiki 1.0.9-rc1](/Download/FoswikiRelease01x00x09RC1), [Foswiki 1.0.9-RC2](/Download/FoswikiRelease01x00x09RC2), [Foswiki 1.0.10](/Download/FoswikiRelease01x00x10), [Foswiki 1.0.10-rc1](/Download/FoswikiRelease01x00x10rc01), [Foswiki 1.1.0](/Download/FoswikiRelease01x01x00), [Foswiki 1.1.0-beta1](/Download/FoswikiRelease01x01x00Beta1), [Foswiki 1.1.0-RC1](/Download/FoswikiRelease01x01x00RC1), [Foswiki 1.1.1](/Download/FoswikiRelease01x01x01), [Foswiki 1.1.2](/Download/FoswikiRelease01x01x02), [Foswiki 1.1.3](/Download/FoswikiRelease01x01x03), [Foswiki 1.1.3-RC1](/Download/FoswikiRelease01x01x03RC1), [Foswiki 1.1.4](/Download/FoswikiRelease01x01x04), [Foswiki 1.1.4-RC2](/Download/FoswikiRelease01x01x04RC2), [Foswiki 1.1.5](/Download/FoswikiRelease01x01x05), [Foswiki 1.1.6](/Download/FoswikiRelease01x01x06), [Foswiki 1.1.7](/Download/FoswikiRelease01x01x07), [Foswiki 1.1.8](/Download/FoswikiRelease01x01x08), [Foswiki 1.1.9](/Download/FoswikiRelease01x01x09), [Foswiki 1.1.10](/Download/FoswikiRelease01x01x10), [Foswiki 1.1.10-RC1](/Download/FoswikiRelease01x01x10_RC1), [Foswiki 1.2.0\_Beta\_1](/Download/FoswikiRelease01x02x00Beta1), [Foswiki 1.2.0\_Beta\_2](/Download/FoswikiRelease01x02x00Beta2), [Foswiki 2.0.0](/Download/FoswikiRelease02x00x00), [Foswiki 2.0.0-RC1](/Download/FoswikiRelease02x00x00RC1), [Foswiki 2.0.0-RC2](/Download/FoswikiRelease02x00x00RC2), [Foswiki 2.0.1](/Download/FoswikiRelease02x00x01), [Foswiki 2.0.2](/Download/FoswikiRelease02x00x02), [Foswiki 2.0.3](/Download/FoswikiRelease02x00x03), [Foswiki 2.1.0](/Download/FoswikiRelease02x01x00), [Foswiki 2.1.0-Beta1](/Download/FoswikiRelease02x01x00Beta1), [Foswiki 2.1.1](/Download/FoswikiRelease02x01x01), [Foswiki 2.1.1-RC1](/Download/FoswikiRelease02x01x01-RC1), [Foswiki 2.1.1-RC2](/Download/FoswikiRelease02x01x01-RC2), [Foswiki 2.1.2](/Download/FoswikiRelease02x01x02), [Foswiki 2.1.3](/Download/FoswikiRelease02x01x03), [Foswiki 2.1.3-Beta1](/Download/FoswikiRelease02x01x03-Beta1), [Foswiki 2.1.3-Beta2](/Download/FoswikiRelease02x01x03-Beta2), [Foswiki 2.1.3-RC1](/Download/FoswikiRelease02x01x03-RC1), [Foswiki 2.1.4](/Download/FoswikiRelease02x01x04), [Foswiki 2.1.4-RC1](/Download/FoswikiRelease02x01x04-RC1), [Foswiki 2.1.4-RC2](/Download/FoswikiRelease02x01x04-RC2), [Foswiki 2.1.4-RC3](/Download/FoswikiRelease02x01x04-RC3), [Foswiki 2.1.5](/Download/FoswikiRelease02x01x05), [Foswiki 2.1.5-RC](/Download/FoswikiRelease02x01x05-RC), [Foswiki 2.1.6](/Download/FoswikiRelease02x01x06), [Foswiki 2.1.7](/Download/FoswikiRelease02x01x07)

Fixed in [Foswiki 2.1.8](/Download/FoswikiRelease02x01x08)
## Attack Vectors

The EVAL feature of the plugin allows simple evaluation of formulas which
are passed to the perl eval function. While there is filtering in place, the
use of <, >, \*, /, . and e allows to make statements such as the following:
<\*>. This statement returns the filename of the first file in the current
directory. This basically is evaluating a perl file glob.This can be combined with the path traversal sequence ../ to get the first
file in all directories from the installation folder up to the root folder.
Furthermore, the regexes in place substitute the string "ee" with a single
"e", which allows attackers to disclose the first file in a folder starting
with the letter "e". For example:
```

https://<target>/bin/view/System/SpreadSheetPlugin?formula=%24EVAL%28%24CHAR%2860%29../../../ee*/*+%24CHAR%2862%29%29

```
While the use of % also allows access to hashmaps, we were not able to
leverage it to access anything other than the current module name.
## Impact

An attacker can gain information about the server such as paths or files.
## Details

No prerequisites are necessary, as the demo page is
accessible without authentication.
## Countermeasures

* Apply [hotfix](/pub/Tasks/Item15192/Calc_pm.patch) to `Calc.pm`.
* Restrict unauthorized access to the System.SpreadSheetPlugin topic.
* Upgrade to the latest patched production [FoswikiRelease02x01x08](/Download/FoswikiRelease02x01x08).

## Authors and Credits

```

Abian Manuel Blome
Siemens Energy Global GmbH & Co. KG
Siemens Energy
Cybersecurity
Technologies
SE CYS A&R TEC
Otto-Hahn-Ring 6
81739 Munich, Germany

```
## Action Plan with Timeline

* 2023-05-17: email from Abian Manuel Blome
* 2023-05-17: first hotfix checked in to 2.1x and master branches
* 2023-05-17: filed a CVE-request
* 2023-05-17: updated hotfix multiple times
* 2023-05-17: applied hotfix to foswiki.org and blog.foswiki.org
* 2023-05-22: updated hotfix based on Abian's feedback
* 2023-05-23: reworked patch to trap any globbing within an `$EVLA()` expression
* 2023-05-31: CVE-2023-33756 was assigned
* 2023-08-06: fix released in Foswiki-2.1.8

[Edit](/bin/edit/Support/SecurityAlert-CVE-2023-33756?t=1736593403 "Edit this topic text")  | [Attach](/bin/attach/Support/SecurityAlert-CVE-2023-33756 "Attach an image or document to this topic") | [Print version](/Support/SecurityAlert-CVE-2023-33756?cover=print; "Printable version of this topic") | [History](/bin/oops/Support/SecurityAlert-CVE-2023-33756?template=oopshistory "View complete topic history"): r2 [<](/bin/compare/Support/SecurityAlert-CVE-2023-33756?rev1=1;rev2=2) [r1](/Support/SecurityAlert-CVE-2023-33756?rev=1) | [Backlinks](/Support/SecurityAlert-CVE-2023-33756?template=backlinksweb "Search the Support Web for topics that link to here") | [View wiki text](/Support/SecurityAlert-CVE-2023-33756?raw=on "View without formatting") | [Edit wiki text](/bin/edit/Support/SecurityAlert-CVE-2023-33756?t=1736593403;nowysiwyg=1 "Edit Wiki text") | [More topic actions](/Support/SecurityAlert-CVE-2023-33756?template=more&currrev=2 "Delete or rename this topic; set parent topic; view and compare revisions")Topic revision: r2 - 06 Aug 2023, [MichaelDaum](/Main/MichaelDaum)

[Support](/Support/WebHome)

* ![key](/pub/System/FamFamFamSilkIcons/key.png)[Log In](/bin/login?foswiki_origin=GET%2cview%2c/Support/SecurityAlert-CVE-2023-33756)
* ![add](/pub/System/FamFamFamSilkIcons/add.png)[Register](/System/UserRegistration)
## Quick Links

* [Support questions](/Support/SupportQuestions)
* [FAQ's](/Support/FAQ)
* [Tips](/Support/BestPracticeTips)
* [Extensions support](/Support/Extensions)
* [Supplemental documents](/Support/SupplementalDocuments)
* [Wiki consultants](/Support/WikiConsultants)

## Tools

* [![newtopic](/pub/System/DocumentGraphics/newtopic.png) Create New Topic](/Support/WebCreateNewTopic?topicparent=SecurityAlert-CVE-2023-33756)
* [![index](/pub/System/DocumentGraphics/index.png) Index](/Support/WebTopicList)
* [![searchtopic](/pub/System/DocumentGraphics/searchtopic.png) Search](/Support/WebSearch)
* [![changes](/pub/System/DocumentGraphics/changes.png) Changes](/Support/WebChanges)
* [![notify](/pub/System/DocumentGraphics/notify.png) Notifications](/Support/WebNotify)
* [![feed](/pub/System/DocumentGraphics/feed.png) RSS Feed](/Support/WebRss)
* [![statistics](/pub/System/DocumentGraphics/statistics.png) Statistics](/Support/WebStatistics)
* [![wrench](/pub/System/DocumentGraphics/wrench.png) Preferences](/Support/WebPreferences)

The copyright of the content on this website is held by the contributing authors, except where stated elsewhere. See [Copyright Statement](/Community/CopyrightStatement). [![Creative Commons License](https://foswiki.org/pub/System/SiteGraphics/cc-by-sa-3.0-88x31.png)](http://creativecommons.org/licenses/by-sa/3.0/)    [Legal Imprint](/About/LegalImprint)    [Privacy Policy](/Community/PrivacyPolicy)


