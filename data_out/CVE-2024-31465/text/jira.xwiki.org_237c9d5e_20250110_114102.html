

[Log in](/login.jsp?os_destination=%2Fbrowse%2FXWIKI-21474)[Skip to main content](#main)[Skip to sidebar](#sidebar)Linked ApplicationsLoadingâ€¦[![XWiki.org JIRA](/s/-65z3d2/930000/8ws80b/_/jira-logo-scaled.png)](https://jira.xwiki.org/secure/MyJiraHome.jspa)

* [Dashboards](/secure/Dashboard.jspa "View and manage your dashboards")
* [Projects](/secure/BrowseProjects.jspa "View recent projects and browse a list of projects")
* [Issues](/issues/ "Search for issues and view recent issues")

* Give feedback to Atlassian
* [Help](https://docs.atlassian.com/jira/jcore-docs-093/ "Help")
  + [Jira Core help](https://docs.atlassian.com/jira/jcore-docs-093/ "Go to the online documentation for Jira Core")
  + [Keyboard Shortcuts](/secure/ViewKeyboardShortcuts%21default.jspa "Get more information about Jira's Keyboard Shortcuts")
  + [About Jira](/secure/AboutPage.jspa "Get more information about Jira")
  + [Jira Credits](/secure/credits/AroundTheWorld%21default.jspa "See who did what")
* [Log In](/login.jsp?os_destination=%2Fbrowse%2FXWIKI-21474)

![Uploaded image for project: 'XWiki Platform'](https://jira.xwiki.org/secure/projectavatar?pid=10010&avatarId=13602)

1. [XWiki Platform](/browse/XWIKI)
2. [XWIKI-21474](/browse/XWIKI-21474)

# Remote code execution from account via SearchSuggestSourceSheet

[Log In](/login.jsp?os_destination=%2Fbrowse%2FXWIKI-21474 "Log In")ClosedExportnull

XMLWordPrintable
#### Details

* **Type:**
  ![](/secure/viewavatar?size=xsmall&avatarId=13503&avatarType=issuetype "Bug - A problem which impairs or prevents the functions of the product.") Bug
* **Resolution:**
  Fixed
* **Priority:**
  ![](/images/icons/priorities/blocker.svg "Blocker - Blocks development and/or testing work, production could not run.") Blocker
* **Fix Version/s:**
  [14.10.20](/issues/?jql=project+%3D+XWIKI+AND+fixVersion+%3D+14.10.20 "14.10.20 "), [15.5.4](/issues/?jql=project+%3D+XWIKI+AND+fixVersion+%3D+15.5.4 "15.5.4 "), [15.10-rc-1](/issues/?jql=project+%3D+XWIKI+AND+fixVersion+%3D+15.10-rc-1 "15.10-rc-1 ")
* **Affects Version/s:**
  5.2-milestone-2
* **Component/s:**
  [Search - Generic](/issues/?jql=project+%3D+XWIKI+AND+component+%3D+%22Search+-+Generic%22 "Search - Generic ")
* **Labels:**
  + [attack\_escalation](/issues/?jql=labels+%3D+attack_escalation "attack_escalation")
  + [attacker\_account](/issues/?jql=labels+%3D+attacker_account "attacker_account")
  + [security](/issues/?jql=labels+%3D+security "security")

* **Tests:**
  Unit
* **Difficulty:**
  Unknown
* **Documentation:**
  N/A
* **Documentation in Release Notes:**
  N/A
* **Similar issues:**

#### Description

**Steps to reproduce:**

1. As a user without script or programming right, edit any page like your user profile with the object editor.
2. Add an object of type XWiki.SearchSuggestSourceClass
3. Set some properties of the object to the value
   ```
    }}}{{async}}{{groovy}}println("Hello from Groovy!"){{/groovy}}{{/async}}
   ```

   ![](/secure/attachment/41841/41841_image-2023-10-26-12-13-05-122.png)
4. Save and view the page.
5. Add ?sheet=XWiki.SearchSuggestSourceSheet to the URL.

**Expected result:**

The entered values are displayed as-is.

**Actual result:**

The value

```
Hello from Groovy!}}}
```

is displayed for all fields where a value has been set. This demonstrates a privilege escalation from a simple user account to programming right.

[![](https://jira.xwiki.org/secure/thumbnail/41840/_thumb_41840.png)](/secure/attachment/41840/41840_image-2023-10-26-12-13-33-592.png "image-2023-10-26-12-13-33-592.png")

The [vulnerable code](https://github.com/xwiki/xwiki-platform/blob/e5357c39ba2abd648cfbb0ac1b650a23df7d8d7e/xwiki-platform-core/xwiki-platform-search/xwiki-platform-search-ui/src/main/resources/XWiki/SearchSuggestSourceSheet.xml#L73) has been introduced in [~~XWIKI-9392~~](https://jira.xwiki.org/browse/XWIKI-9392 "Search suggest should use Solr when the active search configuration is Solr") which leads to an affects version of XWiki 5.2.

#### Attachments

#### Attachments

* Options
  + [Sort By Name](/browse/XWIKI-21474?attachmentSortBy=fileName#attachmentmodule "viewissue.subtasks.tab.show.all.name")
  + [Sort By Date](/browse/XWIKI-21474?attachmentSortBy=dateTime#attachmentmodule "Sort By Date")
  + [Ascending](/browse/XWIKI-21474?attachmentOrder=asc#attachmentmodule "Ascending")
  + [Descending](/browse/XWIKI-21474?attachmentOrder=desc#attachmentmodule "Descending")
  + [Thumbnails](/browse/XWIKI-21474?attachmentViewMode=gallery#attachmentmodule "Thumbnails")
  + [List](/browse/XWIKI-21474?attachmentViewMode=list#attachmentmodule "List")
  + [Download All](/secure/attachmentzip/72330.zip "Download all attachments as a ZIP file")

1. [![image-2023-10-26-12-13-05-122.png](https://jira.xwiki.org/secure/thumbnail/41841/_thumb_41841.png)](/secure/attachment/41841/image-2023-10-26-12-13-05-122.png "image-2023-10-26-12-13-05-122.png - Latest 26/Oct/23 12:13 - Michael Hamann")[image-2023-10-26-12-13-05-122.png](/secure/attachment/41841/image-2023-10-26-12-13-05-122.png "image-2023-10-26-12-13-05-122.png - Latest 26/Oct/23 12:13 - Michael Hamann")72 kB26/Oct/23 12:13
2. [![image-2023-10-26-12-13-33-592.png](https://jira.xwiki.org/secure/thumbnail/41840/_thumb_41840.png)](/secure/attachment/41840/image-2023-10-26-12-13-33-592.png "image-2023-10-26-12-13-33-592.png - Latest 26/Oct/23 12:13 - Michael Hamann")[image-2023-10-26-12-13-33-592.png](/secure/attachment/41840/image-2023-10-26-12-13-33-592.png "image-2023-10-26-12-13-33-592.png - Latest 26/Oct/23 12:13 - Michael Hamann")72 kB26/Oct/23 12:13
#### Issue Links

links to

![Web Link](https://github.com/favicon.ico "Web Link")
[Security Advisory](https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-34fj-r5gq-7395)

#### Activity

#### People

Assignee:

![pjeanjean](https://jira.xwiki.org/secure/useravatar?size=small&avatarId=10222)
Pierre Jeanjean

Reporter:

![MichaelHamann](https://jira.xwiki.org/secure/useravatar?size=small&avatarId=10222)
Michael Hamann

Votes:
0
Vote for this issue

Watchers:
1
Start watching this issue

#### Dates

Created:

26/Oct/23 12:14

Updated:

10/Apr/24 09:52

Resolved:

16/Nov/23 16:34

* Atlassian Jira [Project Management Software](https://www.atlassian.com/software/jira)
* [About Jira](/secure/AboutPage.jspa/secure/AboutPage.jspa)
* [Report a problem](/secure/CreateIssue%21default.jspa)

Powered by a free Atlassian [Jira](http://www.atlassian.com/software/jira) open source license for XWiki.org. Try Jira - [bug tracking software](http://www.atlassian.com/software/jira) for *your* team.

[Atlassian](http://www.atlassian.com/)

