[Open in app](https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Ff18a6fe3a473&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderUser&source=---top_nav_layout_nav----------------------------------)

Sign up

[Sign in](/m/signin?operation=login&redirect=https%3A%2F%2Fmedium.com%2F%40cnetsec%2Fsecurity-advisory-cve-2024-23091-weak-password-hashing-using-md5-f18a6fe3a473&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

[Write](/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---top_nav_layout_nav-----------------------new_post_topnav-----------)

Sign up

[Sign in](/m/signin?operation=login&redirect=https%3A%2F%2Fmedium.com%2F%40cnetsec%2Fsecurity-advisory-cve-2024-23091-weak-password-hashing-using-md5-f18a6fe3a473&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

![](https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png)
# HotelDruid — Security Advisory: CVE-2024–23091 — Weak Password Hashing Using MD5

[![cnetsec](https://miro.medium.com/v2/resize:fill:88:88/1*3Rq6uMjq2LJbxrGQTzSKOA.png)](/%40cnetsec?source=post_page---byline--f18a6fe3a473--------------------------------)

[cnetsec](/%40cnetsec?source=post_page---byline--f18a6fe3a473--------------------------------)

·

[Follow](/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F80c4ffb69cd7&operation=register&redirect=https%3A%2F%2Fmedium.com%2F%40cnetsec%2Fsecurity-advisory-cve-2024-23091-weak-password-hashing-using-md5-f18a6fe3a473&user=cnetsec&userId=80c4ffb69cd7&source=post_page-80c4ffb69cd7--byline--f18a6fe3a473---------------------post_header-----------)

2 min read·Jul 26, 2024

--

Listen

Share

A vulnerability has been identified in the funzioni.php file of the affected system, where MD5 is used for hashing passwords. MD5 is a cryptographic hash function that is known to be weak and susceptible to various types of attacks, such as collision, preimage, and brute-force attacks. The use of MD5 for password hashing compromises the security of user passwords, potentially allowing attackers to recover plaintext passwords from the hash values.

**Affected Component:**
funzioni.php

**Affected Versions:**
Versions prior to 1.32

**Description**:
The affected code in the funzioni.php file uses the MD5 algorithm for hashing passwords. Despite the inclusion of a salt in versions greater than 1.32, the inherent weaknesses of MD5 still pose a significant security risk.

```
if ($tipo_pass == “5”) {
 if (C_VERSIONE_ATTUALE > 1.32) {
 $salt = (string) risul_query($utente, 0, ‘salt’);
 for ($num1 = 0; $num1 < 15; $num1++)
 $password_phpr = md5($password_phpr . substr($salt, 0, (20 — $num1)));
 } else {
 $password_phpr = md5($password_phpr);
 }
}
The vulnerability occurs due to the use of MD5 salting:
```

Example:

```
Without Salting (for versions <= 1.32): $password_phpr = md5($password_phpr);
This approach is particularly weak as it does not incorporate a salt, making it susceptible to dictionary and pre-computed rainbow table attacks.
CWE-327: Use of a Broken or Risky Cryptographic Algorithm
```

**Impact**:
An attacker who gains access to the hashed passwords can exploit this vulnerability to perform brute-force attacks, potentially recovering the original plaintext passwords. This could lead to unauthorized access to user accounts and sensitive information.

**Solution**:
It is recommended to replace MD5 with a more secure password hashing algorithm such as bcrypt, argon2, or scrypt. These algorithms are designed to be computationally intensive, making brute-force attacks significantly more difficult.

**References**:

CWE-327: Use of a Broken or Risky Cryptographic Algorithm
This vulnerability was reported by Cnetsec

Link : https://github.com/digital-druid/hoteldruid/blob/master/includes/funzioni.php

--

--

[![cnetsec](https://miro.medium.com/v2/resize:fill:96:96/1*3Rq6uMjq2LJbxrGQTzSKOA.png)](/%40cnetsec?source=post_page---post_author_info--f18a6fe3a473--------------------------------)[![cnetsec](https://miro.medium.com/v2/resize:fill:128:128/1*3Rq6uMjq2LJbxrGQTzSKOA.png)](/%40cnetsec?source=post_page---post_author_info--f18a6fe3a473--------------------------------)Follow[## Written by cnetsec](/%40cnetsec?source=post_page---post_author_info--f18a6fe3a473--------------------------------)[10 Followers](/%40cnetsec/followers?source=post_page---post_author_info--f18a6fe3a473--------------------------------)·[0 Following](/%40cnetsec/following?source=post_page---post_author_info--f18a6fe3a473--------------------------------)

Cloud Native and Appsec Research

Follow
## No responses yet

[Help](https://help.medium.com/hc/en-us?source=post_page-----f18a6fe3a473--------------------------------)[Status](https://medium.statuspage.io/?source=post_page-----f18a6fe3a473--------------------------------)[About](/about?autoplay=1&source=post_page-----f18a6fe3a473--------------------------------)[Careers](/jobs-at-medium/work-at-medium-959d1a85284e?source=post_page-----f18a6fe3a473--------------------------------)[Press](pressinquiries%40medium.com?source=post_page-----f18a6fe3a473--------------------------------)[Blog](https://blog.medium.com/?source=post_page-----f18a6fe3a473--------------------------------)[Privacy](https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----f18a6fe3a473--------------------------------)[Terms](https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----f18a6fe3a473--------------------------------)[Text to speech](https://speechify.com/medium?source=post_page-----f18a6fe3a473--------------------------------)[Teams](/business?source=post_page-----f18a6fe3a473--------------------------------)

