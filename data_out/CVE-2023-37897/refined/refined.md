The provided content relates to CVE-2023-37897.

**Root cause of vulnerability:**
The vulnerability stems from an incorrect implementation of a security check in the `isDangerousFunction()` function within the Grav CMS. The function was designed to identify potentially dangerous functions that could be used in Server-Side Template Injection (SSTI) attacks. However, it incorrectly returned `false` when a double backslash (`\\`) was present in the function name, bypassing the intended security filter.

**Weaknesses/vulnerabilities present:**
- **SSTI Bypass**: The core vulnerability is the bypass of the SSTI mitigation introduced by commit `71bbed1`. The `isDangerousFunction()` function was intended to prevent the usage of dangerous functions within Twig templates but fails when a double backslash is prepended to the function name. This allowed attackers to execute arbitrary code using the `|map` filter.
- **Incorrect filtering**: The `strpos($name, "\\") !== false` check in the `isDangerousFunction()` function was implemented incorrectly. Instead of returning `true` (indicating a dangerous function) it returns `false`, when `\` is present in `$name`, thus bypassing the blacklist.

**Impact of exploitation:**
Successful exploitation of this vulnerability allows an attacker to execute arbitrary code on the server. This could result in:
- **Complete System Compromise:** The attacker could gain full control of the web server and potentially the underlying system.
- **Data Breach:** Sensitive data stored on the server could be accessed and exfiltrated.
- **Denial of Service:** The attacker could disrupt the normal operation of the website or server.

**Attack vectors:**
- **Twig Template Injection:** The attacker exploits the vulnerability through specially crafted Twig templates. This involves using the `|map` filter with a dangerous function name prepended with double backslashes.

**Required attacker capabilities/position:**
The attacker needs to have access to:
1.  An administrator account or;
2.  A non-administrator user account with Admin panel access and Create/Update page permissions, allowing the modification of page content and enabling Twig processing.