

| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=25a1c2d4b1fcf938356a9688a96a6456abd44b29)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=25a1c2d4b1fcf938356a9688a96a6456abd44b29)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=25a1c2d4b1fcf938356a9688a96a6456abd44b29)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=25a1c2d4b1fcf938356a9688a96a6456abd44b29)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Hyunwoo Kim <v4bel@theori.io> | 2024-04-22 05:39:30 -0400 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-05-02 16:29:24 +0200 |
| commit | [25a1c2d4b1fcf938356a9688a96a6456abd44b29](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=25a1c2d4b1fcf938356a9688a96a6456abd44b29) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=25a1c2d4b1fcf938356a9688a96a6456abd44b29)) | |
| tree | [d3437989f759950b9207deea8f8f2b5912450ad0](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=25a1c2d4b1fcf938356a9688a96a6456abd44b29) | |
| parent | [5e5e1865b73ba1628cc0ac92b9d614a489982230](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=5e5e1865b73ba1628cc0ac92b9d614a489982230) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=25a1c2d4b1fcf938356a9688a96a6456abd44b29&id2=5e5e1865b73ba1628cc0ac92b9d614a489982230)) | |
| download | [linux-25a1c2d4b1fcf938356a9688a96a6456abd44b29.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-25a1c2d4b1fcf938356a9688a96a6456abd44b29.tar.gz) | |

net: gtp: Fix Use-After-Free in gtp\_dellink[ Upstream commit f2a904107ee2b647bb7794a1a82b67740d7c8a64 ]
Since call\_rcu, which is called in the hlist\_for\_each\_entry\_rcu traversal
of gtp\_dellink, is not part of the RCU read critical section, it
is possible that the RCU grace period will pass during the traversal and
the key will be free.
To prevent this, it should be changed to hlist\_for\_each\_entry\_safe.
Fixes: 94dc550a5062 ("gtp: fix an use-after-free in ipv4\_pdp\_find()")
Signed-off-by: Hyunwoo Kim <v4bel@theori.io>
Reviewed-by: Eric Dumazet <edumazet@google.com>
Signed-off-by: David S. Miller <davem@davemloft.net>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=25a1c2d4b1fcf938356a9688a96a6456abd44b29)

| -rw-r--r-- | [drivers/net/gtp.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/net/gtp.c?id=25a1c2d4b1fcf938356a9688a96a6456abd44b29) | 3 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 2 insertions, 1 deletions

| diff --git a/drivers/net/gtp.c b/drivers/net/gtp.cindex 7086acfed5b904..05b5914d83582b 100644--- a/[drivers/net/gtp.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/net/gtp.c?id=5e5e1865b73ba1628cc0ac92b9d614a489982230)+++ b/[drivers/net/gtp.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/net/gtp.c?id=25a1c2d4b1fcf938356a9688a96a6456abd44b29)@@ -1110,11 +1110,12 @@ out\_hashtable: static void gtp\_dellink(struct net\_device \*dev, struct list\_head \*head) { struct gtp\_dev \*gtp = netdev\_priv(dev);+ struct hlist\_node \*next; struct pdp\_ctx \*pctx; int i;  for (i = 0; i < gtp->hash\_size; i++)- hlist\_for\_each\_entry\_rcu(pctx, &gtp->tid\_hash[i], hlist\_tid)+ hlist\_for\_each\_entry\_safe(pctx, next, &gtp->tid\_hash[i], hlist\_tid) pdp\_context\_delete(pctx);  list\_del\_rcu(&gtp->list); |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 13:55:14 +0000

