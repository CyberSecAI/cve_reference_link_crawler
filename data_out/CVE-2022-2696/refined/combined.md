=== Content from www.wordfence.com_48c56c87_20250108_125931.html ===


# Vulnerability Advisories Continued

Wordfence is authorized by the Common Vulnerabilities and Exposures (CVE®) Program as a CNA, or CVE Numbering Authority. As a CNA, Wordfence assigns CVE IDs for new vulnerabilities in WordPress Core, WordPress Plugins and WordPress Themes.

Assigned CVE IDs and the vulnerability details are published below. For more information about submitting vulnerabilities to Wordfence for CVE ID assignment, please refer to our [vulnerability disclosure policy](https://www.wordfence.com/security/).

**\*\*This page is no longer maintained, please visit [Wordfence Intelligence](https://www.wordfence.com/threat-intel)  for the latest Information on Vulnerabilities.\*\***

---

## Chained Quiz <= 1.3.2.2 – Authenticated (Admin+) Stored Cross-Site Scripting via Mailchimp API Key

**Affected Plugin:** [Chained Quiz](https://wordpress.org/plugins/chained-quiz/)

**Plugin Slug:** chained-quiz

**Affected Versions:** <= 1.3.2

**CVE ID:** [CVE-2022-4217](https://www.cve.org/CVERecord?id=CVE-2022-4216)

**CVSS Score:** 5.5 (Medium)

**CVSS Vector:** [CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:C/C:L/I:L/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:C/C:L/I:L/A:N)

**Researcher/s:** Muhammad Zeeshan (Xib3rR4dAr)

**Fully Patched Version:** 1.3.2.3

**Recommended Remediation:** Update to version 1.3.2.3, or newer patched version.

**Publication Date:** 2022-12-02

The Chained Quiz plugin for WordPress is vulnerable to Stored Cross-Site Scripting via the ‘api\_key’ parameter in versions up to, and including, 1.3.2.2 due to insufficient input sanitization and output escaping. This makes it possible for authenticated attackers with administrative privileges to inject arbitrary web scripts in pages that will execute whenever a user accesses an injected page.

---

## Chained Quiz <= 1.3.2.2 – Authenticated (Admin+) Stored Cross-Site Scripting via Facebook App ID

**Affected Plugin:** [Chained Quiz](https://wordpress.org/plugins/chained-quiz/)

**Plugin Slug:** chained-quiz

**Affected Versions:** <= 1.3.2

**CVE ID:** [CVE-2022-4216](https://www.cve.org/CVERecord?id=CVE-2022-4216)

**CVSS Score:** 5.5 (Medium)

**CVSS Vector:** [CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:C/C:L/I:L/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:C/C:L/I:L/A:N)

**Researcher/s:** Muhammad Zeeshan (Xib3rR4dAr)

**Fully Patched Version:** 1.3.2.3

**Recommended Remediation:** Update to version 1.3.2.3, or newer patched version.

**Publication Date:** 2022-12-02

The Chained Quiz plugin for WordPress is vulnerable to Stored Cross-Site Scripting via the ‘facebook\_appid’ parameter in versions up to, and including, 1.3.2.2 due to insufficient input sanitization and output escaping. This makes it possible for authenticated attackers with administrative privileges to inject arbitrary web scripts in pages that will execute whenever a user accesses an injected page.

---

## Chained Quiz <= 1.3.2 – Reflected Cross-Site Scripting via datef

**Affected Plugin:** [Chained Quiz](https://wordpress.org/plugins/chained-quiz/)

**Plugin Slug:** chained-quiz

**Affected Versions:** <= 1.3.2

**CVE ID:** [CVE-2022-4208](https://www.cve.org/CVERecord?id=CVE-2022-4208)

**CVSS Score:** 6.1 (Medium)

**CVSS Vector:** [CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N)

**Researcher/s:** Muhammad Zeeshan (Xib3rR4dAr)

**Fully Patched Version:** 1.3.2.1

**Recommended Remediation:** Update to version 1.3.2.1, or newer patched version.

**Publication Date:** 2022-12-02

The Chained Quiz plugin for WordPress is vulnerable to Reflected Cross-Site Scripting via the ‘datef’ parameter on the ‘chainedquiz\_list’ page in versions up to, and including, 1.3.2 due to insufficient input sanitization and output escaping. This makes it possible for unauthenticated attackers to inject arbitrary web scripts in pages that execute if they can successfully trick a user into performing an action such as clicking on a link.

---

## Chained Quiz <= 1.3.2 – Reflected Cross-Site Scripting via pointsf

**Affected Plugin:** [Chained Quiz](https://wordpress.org/plugins/chained-quiz/)

**Plugin Slug:** chained-quiz

**Affected Versions:** <= 1.3.2

**CVE ID:** [CVE-2022-4209](https://www.cve.org/CVERecord?id=CVE-2022-4209)

**CVSS Score:** 6.1 (Medium)

**CVSS Vector:** [CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N)

**Researcher/s:** Muhammad Zeeshan (Xib3rR4dAr)

**Fully Patched Version:** 1.3.2.1

**Recommended Remediation:** Update to version 1.3.2.1, or newer patched version.

**Publication Date:** 2022-12-02

The Chained Quiz plugin for WordPress is vulnerable to Reflected Cross-Site Scripting via the ‘pointsf’ parameter on the ‘chainedquiz\_list’ page in versions up to, and including, 1.3.2 due to insufficient input sanitization and output escaping. This makes it possible for unauthenticated attackers to inject arbitrary web scripts in pages that execute if they can successfully trick a user into performing an action such as clicking on a link.

---

## Chained Quiz <= 1.3.2 – Reflected Cross-Site Scripting via dnf

**Affected Plugin:** [Chained Quiz](https://wordpress.org/plugins/chained-quiz/)

**Plugin Slug:** chained-quiz

**Affected Versions:** <= 1.3.2

**CVE ID:** [CVE-2022-4210](https://www.cve.org/CVERecord?id=CVE-2022-4210)

**CVSS Score:** 6.1 (Medium)

**CVSS Vector:** [CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N)

**Researcher/s:** Muhammad Zeeshan (Xib3rR4dAr)

**Fully Patched Version:** 1.3.2.1

**Recommended Remediation:** Update to version 1.3.2.1, or newer patched version.

**Publication Date:** 2022-12-02

The Chained Quiz plugin for WordPress is vulnerable to Reflected Cross-Site Scripting via the ‘dnf’ parameter on the ‘chainedquiz\_list’ page in versions up to, and including, 1.3.2 due to insufficient input sanitization and output escaping. This makes it possible for unauthenticated attackers to inject arbitrary web scripts in pages that execute if they can successfully trick a user into performing an action such as clicking on a link.

---

## Chained Quiz <= 1.3.2 – Reflected Cross-Site Scripting via emailf

**Affected Plugin:** [Chained Quiz](https://wordpress.org/plugins/chained-quiz/)

**Plugin Slug:** chained-quiz

**Affected Versions:** <= 1.3.2

**CVE ID:** [CVE-2022-4211](https://www.cve.org/CVERecord?id=CVE-2022-4211)

**CVSS Score:** 6.1 (Medium)

**CVSS Vector:** [CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N)

**Researcher/s:** Muhammad Zeeshan (Xib3rR4dAr)

**Fully Patched Version:** 1.3.2.1

**Recommended Remediation:** Update to version 1.3.2.1, or newer patched version.

**Publication Date:** 2022-12-02

The Chained Quiz plugin for WordPress is vulnerable to Reflected Cross-Site Scripting via the ’emailf’ parameter on the ‘chainedquiz\_list’ page in versions up to, and including, 1.3.2 due to insufficient input sanitization and output escaping. This makes it possible for unauthenticated attackers to inject arbitrary web scripts in pages that execute if they can successfully trick a user into performing an action such as clicking on a link.

---

## Chained Quiz <= 1.3.2 – Reflected Cross-Site Scripting via ipf

**Affected Plugin:** [Chained Quiz](https://wordpress.org/plugins/chained-quiz/)

**Plugin Slug:** chained-quiz

**Affected Versions:** <= 1.3.2

**CVE ID:** [CVE-2022-4212](https://www.cve.org/CVERecord?id=CVE-2022-4212)

**CVSS Score:** 6.1 (Medium)

**CVSS Vector:** [CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N)

**Researcher/s:** Muhammad Zeeshan (Xib3rR4dAr)

**Fully Patched Version:** 1.3.2.1

**Recommended Remediation:** Update to version 1.3.2.1, or newer patched version.

**Publication Date:** 2022-12-02

The Chained Quiz plugin for WordPress is vulnerable to Reflected Cross-Site Scripting via the ‘ipf’ parameter on the ‘chainedquiz\_list’ page in versions up to, and including, 1.3.2 due to insufficient input sanitization and output escaping. This makes it possible for unauthenticated attackers to inject arbitrary web scripts in pages that execute if they can successfully trick a user into performing an action such as clicking on a link.

---

## Chained Quiz <= 1.3.2.2 – Reflected Cross-Site Scripting via dn

**Affected Plugin:** [Chained Quiz](https://wordpress.org/plugins/chained-quiz/)

**Plugin Slug:** chained-quiz

**Affected Versions:** <= 1.3.2.2

**CVE ID:** [CVE-2022-4213](https://www.cve.org/CVERecord?id=CVE-2022-4213)

**CVSS Score:** 6.1 (Medium)

**CVSS Vector:** [CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N)

**Researcher/s:** Muhammad Zeeshan (Xib3rR4dAr)

**Fully Patched Version:** 1.3.2.3

**Recommended Remediation:** Update to version 1.3.2.3, or newer patched version.

**Publication Date:** 2022-12-02

The Chained Quiz plugin for WordPress is vulnerable to Reflected Cross-Site Scripting via the ‘dn’ parameter on the ‘chainedquiz\_list’ page in versions up to, and including, 1.3.2.2 due to insufficient input sanitization and output escaping. This makes it possible for unauthenticated attackers to inject arbitrary web scripts in pages that execute if they can successfully trick a user into performing an action such as clicking on a link.

---

## Chained Quiz <= 1.3.2.3 – Reflected Cross-Site Scripting via ip

**Affected Plugin:** [Chained Quiz](https://wordpress.org/plugins/chained-quiz/)

**Plugin Slug:** chained-quiz

**Affected Versions:** <= 1.3.2.3

**CVE ID:** [CVE-2022-4214](https://www.cve.org/CVERecord?id=CVE-2022-4214)

**CVSS Score:** 6.1 (Medium)

**CVSS Vector:** [CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N)

**Researcher/s:** Muhammad Zeeshan (Xib3rR4dAr)

**Fully Patched Version:** 1.3.2.4

**Recommended Remediation:** Update to version 1.3.2.4, or newer patched version.

**Publication Date:** 2022-12-02

The Chained Quiz plugin for WordPress is vulnerable to Reflected Cross-Site Scripting via the ‘ip’ parameter on the ‘chainedquiz\_list’ page in versions up to, and including, 1.3.2.3 due to insufficient input sanitization and output escaping. This makes it possible for unauthenticated attackers to inject arbitrary web scripts in pages that execute if they can successfully trick a user into performing an action such as clicking on a link.

---

## Chained Quiz <= 1.3.2.3 – Reflected Cross-Site Scripting via date

**Affected Plugin:** [Chained Quiz](https://wordpress.org/plugins/chained-quiz/)

**Plugin Slug:** chained-quiz

**Affected Versions:** <= 1.3.2.3

**CVE ID:** [CVE-2022-4215](https://www.cve.org/CVERecord?id=CVE-2022-4215)

**CVSS Score:** 6.1 (Medium)

**CVSS Vector:** [CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N)

**Researcher/s:** Muhammad Zeeshan (Xib3rR4dAr)

**Fully Patched Version:** 1.3.2.4

**Recommended Remediation:** Update to version 1.3.2.4, or newer patched version.

**Publication Date:** 2022-12-02

The Chained Quiz plugin for WordPress is vulnerable to Reflected Cross-Site Scripting via the ‘date’ parameter on the ‘chainedquiz\_list’ page in versions up to, and including, 1.3.2.3 due to insufficient input sanitization and output escaping. This makes it possible for unauthenticated attackers to inject arbitrary web scripts in pages that execute if they can successfully trick a user into performing an action such as clicking on a link.

---

## Chained Quiz <= 1.3.2.4 – Cross-Site Request Forgery to Question Deletion

**Affected Plugin:** [Chained Quiz](https://wordpress.org/plugins/chained-quiz/)

**Plugin Slug:** chained-quiz

**Affected Versions:** <= 1.3.2.4

**CVE ID:** [CVE-2022-4220](https://www.cve.org/CVERecord?id=CVE-2022-4220)

**CVSS Score:** 5.4 (Medium)

**CVSS Vector:** [CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:L/A:L](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:L/A:L)

**Researcher/s:** Muhammad Zeeshan (Xib3rR4dAr)

**Fully Patched Version:** 1.3.2.5

**Recommended Remediation:** Update to version 1.3.2.5, or newer patched version.

**Publication Date:** 2022-12-02

The Chained Quiz plugin for WordPress is vulnerable to Cross-Site Request Forgery in versions up to, and including, 1.3.2.4. This is due to missing nonce validation on the list\_questions() function. This makes it possible for unauthenticated attackers to delete questions from quizzes via a forged request granted they can trick a site administrator into performing an action such as clicking on a link.

---

## Chained Quiz <= 1.3.2.4 – Cross-Site Request Forgery to Submitted Response Deletion

**Affected Plugin:** [Chained Quiz](https://wordpress.org/plugins/chained-quiz/)

**Plugin Slug:** chained-quiz

**Affected Versions:** <= 1.3.2.4

**CVE ID:** [CVE-2022-4219](https://www.cve.org/CVERecord?id=CVE-2022-4219)

**CVSS Score:** 5.4 (Medium)

**CVSS Vector:** [CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:L/A:L](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:L/A:L)

**Researcher/s:** Muhammad Zeeshan (Xib3rR4dAr)

**Fully Patched Version:** 1.3.2.5

**Recommended Remediation:** Update to version 1.3.2.5, or newer patched version.

**Publication Date:** 2022-12-02

The Chained Quiz plugin for WordPress is vulnerable to Cross-Site Request Forgery in versions up to, and including, 1.3.2.4. This is due to missing nonce validation on the manage() function. This makes it possible for unauthenticated attackers to delete submitted quiz responses via a forged request granted they can trick a site administrator into performing an action such as clicking on a link.

---

## Chained Quiz <= 1.3.2.4 – Cross-Site Request Forgery to Arbitrary Quiz Deletion and Copying

**Affected Plugin:** [Chained Quiz](https://wordpress.org/plugins/chained-quiz/)

**Plugin Slug:** chained-quiz

**Affected Versions:** <= 1.3.2.4

**CVE ID:** [CVE-2022-4218](https://www.cve.org/CVERecord?id=CVE-2022-4218)

**CVSS Score:** 5.4 (Medium)

**CVSS Vector:** [CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:L/A:L](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:L/A:L)

**Researcher/s:** Muhammad Zeeshan (Xib3rR4dAr)

**Fully Patched Version:** 1.3.2.5

**Recommended Remediation:** Update to version 1.3.2.5, or newer patched version.

**Publication Date:** 2022-12-02

The Chained Quiz plugin for WordPress is vulnerable to Cross-Site Request Forgery in versions up to, and including, 1.3.2.4. This is due to missing nonce validation on the list\_quizzes() function. This makes it possible for unauthenticated attackers to delete quizzes and copy quizzes via a forged request granted they can trick a site administrator into performing an action such as clicking on a link.

---

## Appointment Hour Booking <= 1.3.72 – CAPTCHA Bypass

**Affected Plugin:** [Appointment Hour Booking](https://wordpress.org/plugins/appointment-hour-booking/)

**Plugin Slug:** appointment-hour-booking

**Affected Versions:** <= 1.3.72

**CVE ID:** [CVE-2022-4036](https://www.cve.org/CVERecord?id=CVE-2022-4036)

**CVSS Score:** 5.3 (Medium)

**CVSS Vector:** [CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N)

**Researcher/s:** Luca Greeb, Andreas Krüger

**Fully Patched Version:** 1.3.73

**Recommended Remediation:** Update to version 1.3.73, or newer patched version.

**Publication Date:** 2022-11-29

The Appointment Hour Booking plugin for WordPress is vulnerable to CAPTCHA bypass in versions up to, and including, 1.3.72. This is due to the use of insufficiently strong hashing algorithm on the CAPTCHA secret that is also displayed to the user via a cookie.

---

## Appointment Hour Booking <= 1.3.72 – Unauthenticated iFrame Injection via Appointment Form

**Affected Plugin:** [Appointment Hour Booking](https://wordpress.org/plugins/appointment-hour-booking/)

**Plugin Slug:** appointment-hour-booking

**Affected Versions:** <= 1.3.72

**CVE ID:** [CVE-2022-4035](https://www.cve.org/CVERecord?id=CVE-2022-4035)

**CVSS Score:** 7.2 (High)

**CVSS Vector:** [CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:L/I:L/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:L/I:L/A:N)

**Researcher/s:** Luca Greeb, Andreas Krüger

**Fully Patched Version:** 1.3.73

**Recommended Remediation:** Update to version 1.3.73, or newer patched version.

**Publication Date:** 2022-11-29

The Appointment Hour Booking plugin for WordPress is vulnerable to iFrame Injection via the ‘email’ or general field parameters in versions up to, and including, 1.3.72 due to insufficient input sanitization and output escaping that makes injecting iFrame tags possible. This makes it possible for unauthenticated attackers to inject iFrames when submitting a booking that will execute whenever a user accesses the injected booking details page.

---

## Appointment Hour Booking <= 1.3.72 – CSV Injection

**Affected Plugin:** [Appointment Hour Booking](https://wordpress.org/plugins/appointment-hour-booking/)

**Plugin Slug:** appointment-hour-booking

**Affected Versions:** <= 1.3.72

**CVE ID:** [CVE-2022-4034](https://www.cve.org/CVERecord?id=CVE-2022-4034)

**CVSS Score:** 5.8 (Medium)

**CVSS Vector:** [CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:C/C:L/I:L/A:L](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:C/C:L/I:L/A:L)

**Researcher/s:** Luca Greeb, Andreas Krüger

**Fully Patched Version:** 1.3.73

**Recommended Remediation:** Update to version 1.3.73, or newer patched version.

**Publication Date:** 2022-11-29

The Appointment Hour Booking Plugin for WordPress is vulnerable to CSV Injection in versions up to, and including, 1.3.72. This makes it possible for unauthenticated attackers to embed untrusted input into content during booking creation that may be exported as a CSV file when a site’s administrator exports booking details. This can result in code execution when these files are downloaded and opened on a local system with a vulnerable configuration.

---

## Quiz and Survey Master <= 8.0.4 – Improper Input Validation

**Affected Plugin:** [Quiz and Survey Master](https://wordpress.org/plugins/quiz-master-next/)

**Plugin Slug:** quiz-master-next

**Affected Versions:** <= 8.0.4

**CVE ID:** [CVE-2022-4033](https://www.cve.org/CVERecord?id=CVE-2022-4033)

**CVSS Score:** 5.3 (Medium)

**CVSS Vector:** [CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N)

**Researcher/s:** Luca Greeb, Andreas Krüger

**Fully Patched Version:** 8.0.5

**Recommended Remediation:** Update to version 8.0.5, or newer patched version.

**Publication Date:** 2022-11-29

The Quiz and Survey Master plugin for WordPress is vulnerable to input validation bypass via the ‘question[id]’ parameter in versions up to, and including, 8.0.4 due to insufficient input validation that allows attackers to inject content other than the specified value (i.e. a number, file path, etc..). This makes it possible attackers to submit values other than the intended input type.

---

## Quiz and Survey Master <= 8.0.4 – Unauthenticated iFrame Injection via Paragraph and Short Answer

**Affected Plugin:** [Quiz and Survey Master](https://wordpress.org/plugins/quiz-master-next/)

**Plugin Slug:** quiz-master-next

**Affected Versions:** <= 8.0.4

**CVE ID:** [CVE-2022-4032](https://www.cve.org/CVERecord?id=CVE-2022-4032)

**CVSS Score:** 7.2 (Medium)

**CVSS Vector:** [CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:L/I:L/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:L/I:L/A:N)

**Researcher/s:** Luca Greeb, Andreas Krüger

**Fully Patched Version:** 8.0.5

**Recommended Remediation:** Update to version 8.0.5, or newer patched version.

**Publication Date:** 2022-11-29

The Quiz and Survey Master plugin for WordPress is vulnerable to iFrame Injection via the ‘question[id]’ parameter in versions up to, and including, 8.0.4 due to insufficient input sanitization and output escaping that allowed iframe tags to be injected. This makes it possible for unauthenticated attackers to inject iFrames in pages that will execute whenever a user accesses an injected page.

---

## Simple:Press <= 6.8 – Authenticated (Admin+) Path Traversal to Arbitrary File Modification

**Affected Plugin:** [Simple:Press](https://wordpress.org/plugins/simplepress/)

**Plugin Slug:** simplepress

**Affected Versions:** <= 6.8

**CVE ID:** [CVE-2022-4031](https://www.cve.org/CVERecord?id=CVE-2022-4031)

**CVSS Score:** 3.1 (Low)

**CVSS Vector:** [CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:N/I:L/A:L](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:N/I:L/A:L)

**Researcher/s:** Luca Greeb, Andreas Krüger

**Fully Patched Version:** 6.8.1

**Recommended Remediation:** Update to version 6.8.1, or newer patched version.

**Publication Date:** 2022-11-29

The Simple:Press plugin for WordPress is vulnerable to arbitrary file modifications in versions up to, and including, 6.8 via the ‘file’ parameter which does not properly restrict files to be edited in the context of the plugin. This makes it possible with attackers, with high-level permissions such as an administrator, to supply paths to arbitrary files on the server that can be modified outside of the intended scope of the plugin.

---

## Simple:Press <= 6.8 – Authenticated (Subscriber+) Path Traversal to Arbitrary File Deletion

**Affected Plugin:** [Simple:Press](https://wordpress.org/plugins/simplepress/)

**Plugin Slug:** simplepress

**Affected Versions:** <= 6.8

**CVE ID:** [CVE-2022-4030](https://www.cve.org/CVERecord?id=CVE-2022-4030)

**CVSS Score:** 8.1 (High)

**CVSS Vector:** [CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:H](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:H)

**Researcher/s:** Luca Greeb, Andreas Krüger

**Fully Patched Version:** 6.8.1

**Recommended Remediation:** Update to version 6.8.1, or newer patched version.

**Publication Date:** 2022-11-29

The Simple:Press plugin for WordPress is vulnerable to Path Traversal in versions up to, and including, 6.8 via the ‘file’ parameter which can be manipulated during user avatar deletion. This makes it possible with attackers, with minimal permissions such as a subscriber, to supply paths to arbitrary files on the server that will subsequently be deleted. This can be used to delete the wp-config.php file that can allow an attacker to configure the site and achieve remote code execution.

---

## Simple:Press <= 6.8 – Reflected Cross-Site Scripting via Cookie Value

**Affected Plugin:** [Simple:Press](https://wordpress.org/plugins/simplepress/)

**Plugin Slug:** simplepress

**Affected Versions:** <= 6.8

**CVE ID:** [CVE-2022-4029](https://www.cve.org/CVERecord?id=CVE-2022-4029)

**CVSS Score:** 4.7 (Medium)

**CVSS Vector:** [CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:C/C:L/I:L/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:C/C:L/I:L/A:N)

**Researcher/s:** Luca Greeb, Andreas Krüger

**Fully Patched Version:** 6.8.1

**Recommended Remediation:** Update to version 6.8.1, or newer patched version.

**Publication Date:** 2022-11-29

The Simple:Press plugin for WordPress is vulnerable to Reflected Cross-Site Scripting via the ‘sforum\_[md5 hash of the WordPress URL]’ cookie value in versions up to, and including, 6.8 due to insufficient input sanitization and output escaping. This makes it possible for unauthenticated attackers to inject arbitrary web scripts in pages that execute if they can successfully trick a user into performing an action such as clicking on a link. This would be highly complex to exploit as it would require the attacker to set the cookie a cookie for the targeted user.

---

## Simple:Press <= 6.8 – Authenticated Stored Cross-Site Scripting via Profile Signatures

**Affected Plugin:** [Simple:Press](https://wordpress.org/plugins/simplepress/)

**Plugin Slug:** simplepress

**Affected Versions:** <= 6.8

**CVE ID:** [CVE-2022-4028](https://www.cve.org/CVERecord?id=CVE-2022-4028)

**CVSS Score:** 6.4 (Medium)

**CVSS Vector:** [CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:N)

**Researcher/s:** Luca Greeb, Andreas Krüger

**Fully Patched Version:** 6.8.1

**Recommended Remediation:** Update to version 6.8.1, or newer patched version.

**Publication Date:** 2022-11-29

The Simple:Press plugin for WordPress is vulnerable to Stored Cross-Site Scripting via the ‘postitem’ parameter manipulated during the profile-save action when modifying a profile signature in versions up to, and including, 6.8 due to insufficient input sanitization and output escaping that makes injecting object and embed tags possible. This makes it possible for authenticated attackers, with minimal permissions, such as a subscriber to inject arbitrary web scripts in pages when modifying a profile signature that will execute whenever a user accesses an injected page.

---

## Simple:Press <= 6.8 – Unauthenticated Stored Cross-Site Scripting via Forum Replies

**Affected Plugin:** [Simple:Press](https://wordpress.org/plugins/simplepress/)

**Plugin Slug:** simplepress

**Affected Versions:** <= 6.8

**CVE ID:** [CVE-2022-4027](https://www.cve.org/CVERecord?id=CVE-2022-4027)

**CVSS Score:** 7.2 (High)

**CVSS Vector:** [CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:L/I:L/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:L/I:L/A:N)

**Researcher/s:** Luca Greeb, Andreas Krüger

**Fully Patched Version:** 6.8.1

**Recommended Remediation:** Update to version 6.8.1, or newer patched version.

**Publication Date:** 2022-11-29

The Simple:Press plugin for WordPress is vulnerable to Stored Cross-Site Scripting via the ‘postitem’ parameter manipulated during a forum response in versions up to, and including, 6.8 due to insufficient input sanitization and output escaping that makes injecting object and embed tags possible. This makes it possible for unauthenticated attackers to inject arbitrary web scripts in pages when responding to forum threads that will execute whenever a user accesses an injected page.

---

## Theme and plugin translation for Polylang <= 3.2.16 – Missing Authorization

**Affected Plugin:** [Theme and plugin translation for Polylang](https://wordpress.org/plugins/theme-translation-for-polylang/)

**Theme Plugin:** theme-translation-for-polylang

**Affected Versions:** <= 3.2.16

**CVE ID:** [CVE-2022-4169](https://www.cve.org/CVERecord?id=CVE-2022-4169)

**CVSS Score:** 6.5 (Medium)

**CVSS Vector:** [CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:L](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:L)

**Researcher/s:** Florent BESNARD

**Fully Patched Version:** 3.2.17

**Recommended Remediation:** Update to version 3.2.17, or newer patched version.

**Publication Date:** 2022-11-28

The Theme and plugin translation for Polylang is vulnerable to authorization bypass in versions up to, and including, 3.2.16 due to missing capability checks in the process\_polylang\_theme\_translation\_wp\_loaded() function. This makes it possible for unauthenticated attackers to update plugin and theme translation settings and to import translation strings.

---

## Betheme <= 26.5.1.4 – Authenticated (Contributor+) PHP Object Injection

**Affected Theme:** [Betheme](https://muffingroup.com/betheme/)

**Theme Slug:** betheme

**Affected Versions:** <= 26.1.4

**CVE ID:** [CVE-2022-3861](https://www.cve.org/CVERecord?id=CVE-2022-3861)

**CVSS Score:** 8.8 (High)

**CVSS Vector:** [CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H)

**Researcher/s:** Julien Ahrens

**Fully Patched Version:** 26.6

**Recommended Remediation:** Update to version 26.6, or newer patched version.

**Publication Date:** 2022-11-21

The Betheme theme for WordPress is vulnerable to PHP Object Injection in versions up to, and including, 26.5.1.4 via deserialization of untrusted input supplied via the import, mfn-items-import-page, and mfn-items-import parameters passed through the mfn\_builder\_import, mfn\_builder\_import\_page, importdata, importsinglepage, and importfromclipboard functions. This makes it possible for authenticated attackers, with contributor level permissions and above to inject a PHP Object. The additional presence of a POP chain would make it possible for attackers to execute code, retrieve sensitive data, delete files, etc..

---

## SVG Support 2.5  – 2.5.1 – Insecure Plugin Defaults to Cross-Site Scripting

**Affected Plugin:** [SVG Support](https://wordpress.org/plugins/svg-support/)

**Plugin Slug:** svg-support

**Affected Versions:** 2.5 – 2.5.1

**CVE ID:** [CVE-2022-4022](https://www.cve.org/CVERecord?id=CVE-2022-4022)

**CVSS Score:** 6.4 (Medium)

**CVSS Vector:** [CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:N)

**Researcher/s:** Marco Wotschka

**Fully Patched Version:** 2.5.2

**Recommended Remediation:** Update to version 2.5.2, or newer patched version.

**Publication Date:** 2022-11-16

The SVG Support plugin for WordPress defaults to insecure settings in version 2.5 and 2.5.1. SVG files containing malicious javascript are not sanitized. While version 2.5 adds the ability to sanitize image as they are uploaded, the plugin defaults to disable sanitization and does not restrict SVG upload to only administrators. This allows authenticated attackers, with author-level privileges and higher, to upload malicious SVG files that can be embedded in posts and pages by higher privileged users. Additionally, the embedded JavaScript is also triggered on visiting the image URL, which allows an attacker to execute malicious code in browsers visiting that URL.

---

## Permalink Manager Lite <= 2.2.20.1 – Cross-Site Request Forgery

**Affected Plugin:** [Permalink Manager Lite](https://wordpress.org/plugins/permalink-manager/)

**Plugin Slug:** permalink-manager

**Affected Versions:** <= 2.2.20.1

**CVE ID:** [CVE-2022-4021](https://www.cve.org/CVERecord?id=CVE-2022-4021)

**CVSS Score:** 8.8 (High)

**CVSS Vector:** [CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H)

**Researcher/s:** Marco Wotschka

**Fully Patched Version:** 2.2.20.2

**Recommended Remediation:** Update to version 2.2.20.2, or newer patched version.

**Publication Date:** 2022-11-16

The Permalink Manager Lite plugin for WordPress is vulnerable to Cross-Site Request Forgery in versions up to, and including, 2.2.20.1. This is due to missing or incorrect nonce validation on the extra\_actions function. This makes it possible for unauthenticated attackers to change plugin settings including permalinks and site maps, via forged request granted they can trick a site administrator into performing an action such as clicking on a link.

---

## TeraWallet – For WooCommerce <= 1.4.3 – Insecure Direct Object Reference

**Affected Plugin:** [TeraWallet – For WooCommerce](https://wordpress.org/plugins/woo-wallet/)

**Plugin Slug:** woo-wallet

**Affected Versions:** <= 1.4.3

**CVE ID:** [CVE-2022-3995](https://www.cve.org/CVERecord?id=CVE-2022-3995)

**CVSS Score:** 4.3 (Medium)

**CVSS Vector:** [CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:N)

**Researcher/s:** Marco Wotschka

**Fully Patched Version:** 1.4.4

**Recommended Remediation:** Update to version 1.4.4, or newer patched version.

**Publication Date:** 2022-11-14

The TeraWallet plugin for WordPress is vulnerable to Insecure Direct Object Reference in versions up to, and including, 1.4.3. This is due to insufficient validation of the user-controlled key on the lock\_unlock\_terawallet AJAX action. This makes it possible for authenticated attackers, with subscriber-level permissions and above, to lock/unlock other users wallets.

---

## Photospace Gallery <= 2.3.5 – Authenticated (Subscriber+) Stored Cross-Site Scripting

**Affected Plugin:** [Photospace Gallery](https://wordpress.org/plugins/photospace)

**Plugin Slug:** photospace

**Affected Versions:** <= 2.3.5

**CVE ID:** [CVE-2022-3991](https://www.cve.org/CVERecord?id=CVE-2022-3991)

**CVSS Score:** 6.4 (Medium)

**CVSS Vector:** [CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:N)

**Researcher/s:** Marco Wotschka

**Fully Patched Version:** Unpatched.

**Recommended Remediation:** Uninstall plugin from site until patched version available.

**Publication Date:** 2022-11-14

The Photospace Gallery plugin for WordPress is vulnerable to Stored Cross-Site Scripting via its settings parameters saved via the update() function in versions up to, and including, 2.3.5 due to insufficient input sanitization and output escaping. This makes it possible for authenticated attackers, with subscriber-level permissions and above, to inject arbitrary web scripts in pages that will execute whenever a user accesses an injected page.

---

## Transposh WordPress Translation <= 1.0.8.1 – Authorization Bypass

**Affected Plugin:** [Transposh WordPress Translation](https://wordpress.org/plugins/transposh-translation-filter-for-wordpress)

**Plugin Slug:** transposh-translation-filter-for-wordpress

**Affected Versions:** <= 1.0.8.1

**CVE ID:** [CVE-2022-2536](https://www.cve.org/CVERecord?id=CVE-2022-2536)

**CVSS Score:** 7.5 (High)

**CVSS Vector:** [CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N)

**Researcher/s:** Julien Ahrens

**Fully Patched Version:** Unpatched.

**Recommended Remediation:** Uninstall plugin from site until patched version available.

**Publication Date:** 2022-11-14

The Transposh WordPress Translation plugin for WordPress is vulnerable to unauthorized setting changes by unauthenticated users in versions up to, and including, 1.0.8.1. This is due to insufficient validation of settings on the ‘tp\_translation’ AJAX action which makes it possible for unauthenticated attackers to bypass any restrictions and influence the data shown on the site. Please note this is a separate issue from CVE-2022-2461. Notes from the researcher: When installed Transposh comes with a set of pre-configured options, one of these is the “Who can translate” setting under the “Settings” tab. However, this option is largely ignored, if Transposh has enabled its “autotranslate” feature (it’s enabled by default) and the HTTP POST parameter “sr0” is larger than 0. This is caused by a faulty validation in “wp/transposh\_db.php.”

---

## Feed Them Social – for Twitter feed, Youtube and more <= 2.9.9 – Authenticated (Subscriber+) Stored Cross-Site Scripting

**Affected Plugin:** [Feed Them Social – for Twitter feed, Youtube and more](https://wordpress.org/plugins/feed-them-social/)

**Plugin Slug:** feed-them-social

**Affected Versions:** <= 2.9.9

**CVE ID:** [CVE-2022-2940](https://www.cve.org/CVERecord?id=CVE-2022-2940)

**CVSS Score:** 6.4 (Medium)

**CVSS Vector:** [CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:N)

**Researcher/s:** Marco Wotschka

**Fully Patched Version:** 3.0.1

**Recommended Remediation:** Update to version 3.0.1, or newer patched version.

**Publication Date:** 2022-11-14

The Feed Them Social plugin for WordPress is vulnerable to Cross-Site Request Forgery in versions up to, and including, 2.9.9. This is due to missing or incorrect nonce validation on various functions such as fts\_instagram\_token\_ajax(). This makes it possible for unauthenticated attackers to trigger settings updates via forged request granted they can trick a site administrator into performing an action such as clicking on a link.

---

## Feed Them Social – for Twitter feed, Youtube and more <= 2.9.9 – Cross-Site Request Forgery to Settings Update

**Affected Plugin:** [Feed Them Social – for Twitter feed, Youtube and more](https://wordpress.org/plugins/feed-them-social/)

**Plugin Slug:** feed-them-social

**Affected Versions:** <= 2.9.9

**CVE ID:** [CVE-2022-2942](https://www.cve.org/CVERecord?id=CVE-2022-2942)

**CVSS Score:** 8.8 (High)

**CVSS Vector:** [CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H)

**Researcher/s:** Marco Wotschka

**Fully Patched Version:** 3.0.1

**Recommended Remediation:** Update to version 3.0.1, or newer patched version.

**Publication Date:** 2022-11-14

The Feed Them Social plugin for WordPress is vulnerable to Cross-Site Request Forgery in versions up to, and including, 2.9.9. This is due to missing or incorrect nonce validation on various functions such as fts\_instagram\_token\_ajax(). This makes it possible for unauthenticated attackers to trigger settings updates via forged request granted they can trick a site administrator into performing an action such as clicking on a link.

---

## WordPress Countdown Widget <= 3.1.9.2 – Authenticated (Administrator+) Stored Cross-Site Scripting

**Affected Plugin:** [WordPress Countdown Widget](https://wordpress.org/plugins/wordpress-countdown-widget/)

**Plugin Slug:** wordpress-countdown-widget

**Affected Versions:** <= 3.1.9.2

**CVE ID:** [CVE-2022-2944](https://www.cve.org/CVERecord?id=CVE-2022-2944)

**CVSS Score:** 8.8 (High)

**CVSS Vector:** [CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H)

**Researcher/s:** Marco Wotschka

**Fully Patched Version:** 3.1.9.3

**Recommended Remediation:** Update to version 3.1.9.3, or newer patched version.

**Publication Date:** 2022-11-14

The WordPress Countdown Widget plugin for WordPress is vulnerable to Stored Cross-Site Scripting via several parameters in versions up to, and including, 3.1.9.2 due to insufficient input sanitization and output escaping. This makes it possible for authenticated attackers, with administrator-level permissions and above, to inject arbitrary web scripts in pages that will execute whenever a user accesses an injected page.

---

## Follow Me Plugin <= 3.1.1 – Cross-Site Request Forgery to Cross-Site Scripting

**Affected Plugin:** [Follow Me Plugin](https://wordpress.org/plugins/follow-me/)

**Plugin Slug:** follow-me

**Affected Versions:** <= 3.1.1

**CVE ID:** [CVE-2022-3240](https://www.cve.org/CVERecord?id=CVE-2022-3240)

**CVSS Score:** 8.8 (High)

**CVSS Vector:** [CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H)

**Researcher/s:** Marco Wotschka

**Fully Patched Version:** Unpatched.

**Recommended Remediation:** Uninstall plugin from site until patched version available.

**Publication Date:** 2022-11-14

The “Follow Me Plugin” plugin for WordPress is vulnerable to Cross-Site Request Forgery in versions up to, and including, 3.1.1. This is due to missing nonce validation on the FollowMeIgniteSocialMedia\_options\_page() function. This makes it possible for unauthenticated attackers to modify the plugin’s settings and inject malicious JavaScript via a forged request granted they can trick a site administrator into performing an action such as clicking on a link.

---

## WP Affiliate Platform <= 6.3.9 – Cross-Site Request Forgery

**Affected Plugin:** [WP Affiliate Platform](https://www.tipsandtricks-hq.com/wordpress-affiliate-platform-plugin-simple-affiliate-program-for-wordpress-blogsite-1474)

**Plugin Slug:** wp-affiliate-platform

**Affected Versions:** <= 6.3.9

**CVE ID:** [CVE-2022-3898](https://www.cve.org/CVERecord?id=CVE-2022-3898)

**CVSS Score:** 8.8 (High)

**CVSS Vector:** [CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H)

**Researcher/s:** Marco Wotschka

**Fully Patched Version:** 6.4.0

**Recommended Remediation:** Update to version 6.4.0, or newer.

**Publication Date:** 2022-11-14

The WP Affiliate Platform plugin for WordPress is vulnerable to Cross-Site Request Forgery in versions up to, and including, 6.3.9. This is due to missing or incorrect nonce validation on various functions including the affiliates\_menu method. This makes it possible for unauthenticated attackers to delete affiliate records, via forged request granted they can trick a site administrator into performing an action such as clicking on a link.

---

## WP Affiliate Platform <= 6.3.9 – Authenticated (Administrator+) Stored Cross-Site Scripting

**Affected Plugin:** [WP Affiliate Platform](https://www.tipsandtricks-hq.com/wordpress-affiliate-platform-plugin-simple-affiliate-program-for-wordpress-blogsite-1474)

**Plugin Slug:** wp-affiliate-platform

**Affected Versions:** <= 6.3.9

**CVE ID:** [CVE-2022-3897](https://www.cve.org/CVERecord?id=CVE-2022-3897)

**CVSS Score:** 5.5 (Medium)

**CVSS Vector:** [CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:C/C:L/I:L/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:C/C:L/I:L/A:N)

**Researcher/s:** Marco Wotschka

**Fully Patched Version:** 6.4.0

**Recommended Remediation:** Update to version 6.4.0, or newer.

**Publication Date:** 2022-11-14

The WP Affiliate Platform plugin for WordPress is vulnerable to Stored Cross-Site Scripting via several parameters in versions up to, and including, 6.3.9 due to insufficient input sanitization and output escaping. This makes it possible for authenticated attackers, with administrator-level permissions and above, to inject arbitrary web scripts in pages that will execute whenever a user accesses an injected page.

---

## WP Affiliate Platform <= 6.3.9 – Reflected Cross-Site Scripting

**Affected Plugin:** [WP Affiliate Platform](https://www.tipsandtricks-hq.com/wordpress-affiliate-platform-plugin-simple-affiliate-program-for-wordpress-blogsite-1474)

**Plugin Slug:** wp-affiliate-platform

**Affected Versions:** <= 6.3.9

**CVE ID:** [CVE-2022-3896](https://www.cve.org/CVERecord?id=CVE-2022-3896)

**CVSS Score:** 6.1 (Medium)

**CVSS Vector:** [CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N)

**Researcher/s:** Marco Wotschka

**Fully Patched Version:** 6.4.0

**Recommended Remediation:** Update to version 6.4.0, or newer.

**Publication Date:** 2022-11-14

The WP Affiliate Platform plugin for WordPress is vulnerable to Reflected Cross-Site Scripting via $\_SERVER[“REQUEST\_URI”] in versions up to, and including, 6.3.9 due to insufficient input sanitization and output escaping. This makes it possible for unauthenticated attackers to inject arbitrary web scripts in pages that execute if they can successfully trick a user into performing an action such as clicking on a link. This is unlikely to work in modern browsers.

---

## Becustom <= 1.0.5.2 – Cross-Site Request Forgery

**Affected Plugin:** [Becustom](https://muffingroup.com/betheme/features/be-custom/)

**Plugin Slug:** becustom

**Affected Versions:** <= 1.0.5.2

**CVE ID:** [CVE-2022-3747](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-3747)

**CVSS Score:** 8.8 (High)

**CVSS Vector:** [CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H)

**Researcher/s:** Julien Ahrens

**Fully Patched Version:** 1.0.5.3

**Recommended Remediation:** Update to version 1.0.5.3, or newer.

**Publication Date:** 2022-11-14

The Becustom plugin for WordPress is vulnerable to Cross-Site Request Forgery in versions up to, and including, 1.0.5.2. This is due to missing nonce validation when saving the plugin’s settings. This makes it possible for unauthenticated attackers to update the plugin’s settings like betheme\_url\_slug, replaced\_theme\_author, and betheme\_label to name a few, via a forged request granted they can trick a site administrator into performing an action such as clicking on a link.

---

## VR Calendar <= 2.3.3 – Cross-Site Request Forgery

**Affected Plugin:** [VR Calendar](https://wordpress.org/plugins/vr-calendar-sync/)

**Plugin Slug:** vr-calendar-sync

**Affected Versions:** <= 2.3.3

**CVE ID:** [CVE-2022-3852](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-3852)

**CVSS Score:** 8.8 (High)

**CVSS Vector:** [CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H)

**Researcher/s:** Marco Wotschka

**Fully Patched Version:** 2.3.4

**Recommended Remediation:** Update to version 2.3.4, or newer.

**Publication Date:** 2022-11-03

The VR Calendar plugin for WordPress is vulnerable to Cross-Site Request Forgery in versions up to, and including, 2.3.3. This is due to missing or incorrect nonce validation on several functions. This makes it possible for unauthenticated attackers to delete, and modify calendars as well as the plugin settings, via forged request granted they can trick a site administrator into performing an action such as clicking on a link.

---

## Restaurant Menu – Food Ordering System – Table Reservation <= 2.3.0 – Missing Authorization on AJAX Actions

**Affected Plugin:** [Restaurant Menu – Food Ordering System – Table Reservation](https://wordpress.org/plugins/menu-ordering-reservations/)

**Plugin Slug:** menu-ordering-reservations

**Affected Versions:** <= 2.3.0

**CVE ID:** [CVE-2022-2696](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-2696)

**CVSS Score:** 6.3 (Medium)

**CVSS Vector:** [CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L)

**Researcher/s:** ptsfence

**Fully Patched Version:** 2.3.1

**Recommended Remediation:** Update to version 2.3.1, or newer.

**Publication Date:** 2022-10-31

The Restaurant Menu – Food Ordering System – Table Reservation plugin for WordPress is vulnerable to authorization bypass via several AJAX actions in versions up to, and including 2.3.0 due to missing capability checks and missing nonce validation. This makes it possible for authenticated attackers with minimal permissions to perform a wide variety of actions such as modifying the plugin’s settings and modifying the ordering system preferences.

---

## Restaurant Menu – Food Ordering System – Table Reservation <= 2.3.1 – Cross-Site Request Forgery

**Affected Plugin:** [Restaurant Menu – Food Ordering System – Table Reservation](https://wordpress.org/plugins/menu-ordering-reservations/)

**Plugin Slug:** menu-ordering-reservations

**Affected Versions:** <= 2.3.1

**CVE ID:** [CVE-2022-3776](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-3776)

**CVSS Score:** 8.8 (High)

**CVSS Vector:** [CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H)

**Researcher/s:** ptsfence

**Fully Patched Version:** 2.3.2

**Recommended Remediation:** Update to version 2.3.2, or newer.

**Publication Date:** 2022-10-31

The Restaurant Menu – Food Ordering System – Table Reservation plugin for WordPress is vulnerable to Cross-Site Request Forgery in versions up to, and including, 2.3.1. This is due to missing or incorrect nonce validation on several functions called via AJAX actions such as forms\_action, set\_option, & chosen\_options to name a few . This makes it possible for unauthenticated attackers to perform a variety of administrative actions like modifying forms, via a forged request granted they can trick a site administrator into performing an action such as clicking on a link.

---

## Ultimate Member – User Profile, User Registration, Login & Membership Plugin <= 2.5.0 – Authenticated (Admin+) Limited Remote Code Execution via um\_populate\_dropdown\_options

**Affected Plugin:** [Ultimate Member – User Profile, User Registration, Login & Membership Plugin](https://wordpress.org/plugins/ultimate-member/)

**Plugin Slug:** ultimate-member

**Affected Versions:** <= 2.5.0

**CVE ID:** [CVE-2022-3384](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-3384)

**CVSS Score:** 7.2 (High)

**CVSS Vector:** [CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H)

**Researcher/s:** Ruijie Li

**Fully Patched Version:** 2.5.1

**Recommended Remediation:** Update to version 2.5.1, or newer.

**Publication Date:** 2022-10-28

The Ultimate Member plugin for WordPress is vulnerable to Remote Code Execution in versions up to, and including, 2.5.0 via the populate\_dropdown\_options function that accepts user supplied input and passes it through call\_user\_func(). This is restricted to non-parameter PHP functions like phpinfo(); since user supplied parameters are not passed through the function. This makes it possible for authenticated attackers, with administrative privileges, to execute code on the server.

---

## Ultimate Member – User Profile, User Registration, Login & Membership Plugin <= 2.5.0 – Authenticated (Admin+) Remote Code Execution via Multi-Select

**Affected Plugin:** [Ultimate Member – User Profile, User Registration, Login & Membership Plugin](https://wordpress.org/plugins/ultimate-member/)

**Plugin Slug:** ultimate-member

**Affected Versions:** <= 2.5.0

**CVE ID:** [CVE-2022-3383](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-3383)

**CVSS Score:** 7.2 (High)

**CVSS Vector:** [CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H)

**Researcher/s:** Ruijie Li

**Fully Patched Version:** 2.5.1

**Recommended Remediation:** Update to version 2.5.1, or newer.

**Publication Date:** 2022-10-28

The Ultimate Member plugin for WordPress is vulnerable to Remote Code Execution in versions up to, and including, 2.5.0 via the get\_option\_value\_from\_callback function that accepts user supplied input and passes it through call\_user\_func(). This makes it possible for authenticated attackers, with administrative capabilities, to execute code on the server.

---

## Ultimate Member – User Profile, User Registration, Login & Membership Plugin <= 2.5.0 – Authenticated (Contributor+) Directory Traversal via Shortcodes

**Affected Plugin:** [Ultimate Member – User Profile, User Registration, Login & Membership Plugin](https://wordpress.org/plugins/ultimate-member/)

**Plugin Slug:** ultimate-member

**Affected Versions:** <= 2.5.0

**CVE ID:** [CVE-2022-3361](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-3361)

**CVSS Score:** 4.3 (Medium)

**CVSS Vector:** [CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N)

**Researcher/s:** Ruijie Li

**Fully Patched Version:** 2.5.1

**Recommended Remediation:** Update to version 2.5.1, or newer.

**Publication Date:** 2022-10-28

The Ultimate Member plugin for WordPress is vulnerable to directory traversal in versions up to, and including 2.5.0 due to insufficient input validation on the ‘template’ attribute used in shortcodes. This makes it possible for attackers with administrative privileges to supply arbitrary paths using traversal (../../) to access and include files outside of the intended directory. If an attacker can successfully upload a php file then remote code execution via inclusion may also be possible. Note: for users with less than administrative capabilities, /wp-admin access needs to be enabled for that user in order for this to be exploitable by those users.

---

## Ultimate Member – User Profile, User Registration, Login & Membership Plugin <= 2.5.0 – Authenticated (Admin+) Directory Traversal

**Affected Plugin:** [Ultimate Member – User Profile, User Registration, Login & Membership Plugin](https://wordpress.org/plugins/ultimate-member/)

**Plugin Slug:** ultimate-member

**Affected Versions:** <= 2.5.0

**CVE ID:** [CVE-2022-2445](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-2445)

**CVSS Score:** 4.7 (Medium)

**CVSS Vector:** [CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:L/I:L/A:L](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:L/I:L/A:L)

**Researcher/s:** Ruijie Li

**Fully Patched Version:** 2.5.1

**Recommended Remediation:** Update to version 2.5.1, or newer.

**Publication Date:** 2022-10-28

The Ultimate Member plugin for WordPress is vulnerable to directory traversal in versions up to, and including 2.5.0 due to insufficient input validation on the ‘pack’ parameter. This makes it possible for attackers with administrative privileges to supply arbitrary paths using traversal (../../) to access and include files outside of the intended directory. If an attacker can successfully upload a file with the exact name ‘init.php’ then remote code execution may also be possible.

---

## Web Stories <= 1.24.0 – Server Side Request Forgery

**Affected Plugin:** [Web Stories](https://wordpress.org/plugins/web-stories/)

**Plugin Slug:** web-stories

**Affected Versions:** <= 1.24.0

**CVE ID:** [CVE-2022-3708](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-3708)

**CVSS Score:** 9.6 (Critical)

**CVSS Vector:** [CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:N)

**Researcher/s:** Aymen Borgi

**Fully Patched Version:** 1.25.0

**Recommended Remediation:** Update to version 1.25.0, or newer.

**Publication Date:** 2022-10-26

The Web Stories plugin for WordPress is vulnerable to Server-Side Request Forgery in versions up to, and including 1.24.0 due to insufficient validation of URLs supplied via the ‘url’ parameter found via the /v1/hotlink/proxy REST API Endpoint. This made it possible for authenticated users to make web requests to arbitrary locations originating from the web application and can be used to query and modify information from internal services.

---

## ImageMagick Engine <= 1.7.4 – Cross-Site Request Forgery to Remote Command Execution

**Affected Plugin:** ImageMagick Engine

**Plugin Slug:** imagemagick-engine

**Affected Versions:** <= 1.7.4

**CVE ID:** [CVE-2022-2441](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-2441)

**CVSS Score:** 8.8 (High)

**CVSS Vector:** [CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H)

**Researcher/s:** Rasoul Jahanshahi

**Fully Patched Version:** Unpatched.

**Recommended Remediation:** Uninstall plugin from site until patched version available.

**Publication Date:** 2022-10-17

The ImageMagick Engine plugin for WordPress is vulnerable to remote code execution via the ‘cli\_path’ parameter in versions up to, and including 1.7.4. This makes it possible for unauthenticated users to run arbitrary commands leading to remote command execution, granted they can trick a site administrator into performing an action such as clicking on a link. This makes it possible for an attacker to create and or modify files hosted on the server which can easily grant attackers backdoor access to the affected server.

---

## Log HTTP Requests <= 1.3.1 – Stored Cross-Site Scripting

**Affected Plugin:** [Log HTTP Requests](https://wordpress.org/plugins/log-http-requests/)

**Plugin Slug:** log-http-requests

**Affected Versions:** <= 1.3.1

**CVE ID:** [CVE-2022-3402](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-3402)

**CVSS Score:** 6.1 (Medium)

**CVSS Vector:** [CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N)

**Researcher/s:** Etan Imanol Castro Aldrete

**Fully Patched Version:** 1.3.2

**Recommended Remediation:** Update to version 1.3.2, or newer.

**Publication Date:** 2022-10-05

The Log HTTP Requests plugin for WordPress is vulnerable to Stored Cross-Site Scripting via logged HTTP requests in versions up to, and including, 1.3.1 due to insufficient input sanitization and output escaping. This makes it possible for unauthenticated attackers who can trick a site’s administrator into performing an action like clicking on a link, or an authenticated user with access to a page that sends a request using user-supplied data via the server, to inject arbitrary web scripts in pages that will execute whenever a user accesses an injected page.

---

## Bricks 1.2 – 1.5.3 – Remote Code Execution

**Affected Theme:** [Bricks](https://bricksbuilder.io/)

**Theme Slug:** bricks

**Affected Versions:** 1.2 to 1.5.3

**CVE ID:** [CVE-2022-3401](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-3401)

**CVSS Score:** 8.8 (High)

**CVSS Vector:** [CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H)

**Researcher/s:** Anonymous

**Fully Patched Version:** 1.5.4

**Recommended Remediation:** Update to version 1.5.4, or newer.

**Publication Date:** 2022-10-03

The Bricks theme for WordPress is vulnerable to remote code execution due to the theme allowing site editors to include executable code blocks in website content in versions 1.2 to 1.5.3. This, combined with the missing authorization vulnerability (CVE-2022-3400), makes it possible for authenticated attackers with minimal permissions, such as a subscriber, can edit any page, post, or template on the vulnerable WordPress website and inject a code execution block that can be used to achieve remote code execution.

---

## Bricks 1.0 – 1.5.3 – Missing Authorization to Arbitrary Content Creation/Modification

**Affected Theme:** [Bricks](https://bricksbuilder.io/)

**Theme Slug:** bricks

**Affected Versions:** 1.0 – 1.5.3

**CVE ID:** [CVE-2022-3400](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-3400)

**CVSS Score:** 6.5 (Medium)

**CVSS Vector:** [CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:N)

**Researcher/s:** Anonymous

**Fully Patched Version:** 1.5.4

**Recommended Remediation:** Update to version 1.5.4, or newer.

**Publication Date:** 2022-10-03

The Bricks theme for WordPress is vulnerable to authorization bypass due to a missing capability check on the bricks\_save\_post AJAX action in versions 1.0 to 1.5.3. This makes it possible for authenticated attackers with minimal permissions, such as a subscriber, to edit any page, post, or template on the vulnerable WordPress website.

This site uses cookies in accordance with our [Privacy Policy](/privacy-policy).

Cookie Settings
Accept All

## Cookie Options

For additional information on how this site uses cookies, please review our [Privacy Policy](/privacy-policy). The cookies used by this site are classified into the following categories and can be configured below.

### Strictly Necessary

These Cookies are necessary for the Sites and Services to work properly. They include any essential authentication and authorization cookies for the Services.

\* Cookies of this category are necessary for the site to function and cannot be disabled.

### Performance/Analytical

These Cookies allow us to collect certain information about how you navigate the Sites or utilize the Services running on your device. They help us understand which areas you use and what we can do to improve them.

### Targeting

These Cookies are used to deliver relevant information related to the Services to an identified machine or other device (not a named or otherwise identifiable person) which has previously been used to visit our Sites. Some of these types of Cookies on our Sites are operated by third parties with our permission and are used to identify advertising sources that are effectively driving customers to our Sites.

Cancel
Save



=== Content from plugins.trac.wordpress.org_40e0a37f_20250108_125928.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fbrowser%2Fmenu-ordering-reservations%2Ftrunk%2Fincludes%2Fadmin%2Fclass-glf-admin-screens.php%3Frev%3D2664283)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Revision](/browser/menu-ordering-reservations/trunk/includes/admin/class-glf-admin-screens.php?rev=2576321 "Revision 2576321")
* [Latest Revision](/browser/menu-ordering-reservations/trunk/includes/admin/class-glf-admin-screens.php)
* [Next Revision](/browser/menu-ordering-reservations/trunk/includes/admin/class-glf-admin-screens.php?rev=2793398 "Revision 2793398") →
* [Blame](/browser/menu-ordering-reservations/trunk/includes/admin/class-glf-admin-screens.php?annotate=blame&rev=2664283 "Annotate each line with the last changed revision (this can be time consuming...)")
* [Revision Log](/log/menu-ordering-reservations/trunk/includes/admin/class-glf-admin-screens.php?rev=2664283)

---

# [source:](/browser?rev=2664283&order=name "Go to repository root") [menu-ordering-reservations](/browser/menu-ordering-reservations?rev=2664283&order=name "View menu-ordering-reservations")/[trunk](/browser/menu-ordering-reservations/trunk?rev=2664283&order=name "View trunk")/[includes](/browser/menu-ordering-reservations/trunk/includes?rev=2664283&order=name "View includes")/[admin](/browser/menu-ordering-reservations/trunk/includes/admin?rev=2664283&order=name "View admin")/[class-glf-admin-screens.php](/browser/menu-ordering-reservations/trunk/includes/admin/class-glf-admin-screens.php?rev=2664283&order=name "View class-glf-admin-screens.php") @ [2664283](/changeset/2664283/ "View changeset 2664283")

View diff against:

View revision:

| [Last change](/changeset/2664283/menu-ordering-reservations/trunk/includes/admin/class-glf-admin-screens.php "View differences") on this file since 2664283 was [2664283](/changeset/2664283/ "View changeset 2664283"), checked in by gloriafood, [3 years ago](/timeline?from=2022-01-25T08%3A04%3A56Z&precision=second "See timeline at 01/25/2022 08:04:56 AM") |
| --- |
| opening hours widget - v2.2.0 |
| **File size:** 17.6 KB | |

| Line |  |
| --- | --- |
| [1](#L1) | <?php |
| [2](#L2) | if ( !defined( 'ABSPATH' ) ) { |
| [3](#L3) | exit; |
| [4](#L4) | } // Exit if accessed directly |
| [5](#L5) |  |
| [6](#L6) | /\*\* |
| [7](#L7) | \* This class manages the screens |
| [8](#L8) | \* |
| [9](#L9) | \* @since     1.1.0 |
| [10](#L10) | \*/ |
| [11](#L11) | if ( !class\_exists( 'Glf\_Admin\_Screens' ) ) { |
| [12](#L12) |  |
| [13](#L13) | class Glf\_Admin\_Screens { |
| [14](#L14) | public function \_\_construct() { |
| [15](#L15) | $this->glf\_admin\_screens\_config(); |
| [16](#L16) | if ( !wp\_doing\_ajax() ) { |
| [17](#L17) | if ( is\_admin() ) { |
| [18](#L18) | $this->glf\_admin\_screens\_menu(); |
| [19](#L19) | } |
| [20](#L20) | } |
| [21](#L21) | else{ |
| [22](#L22) | add\_action( 'wp\_ajax\_glf\_form\_sign\_up', array( $this, 'forms\_action' ) ); |
| [23](#L23) | add\_action( 'wp\_ajax\_glf\_form\_login', array( $this, 'forms\_action' ) ); |
| [24](#L24) | add\_action( 'wp\_ajax\_glf\_form\_forgot\_password', array( $this, 'forms\_action' ) ); |
| [25](#L25) | add\_action( 'wp\_ajax\_glf\_form\_disconnect', array( $this, 'forms\_action' ) ); |
| [26](#L26) |  |
| [27](#L27) | add\_action( 'wp\_ajax\_glf\_set\_option', array( $this, 'set\_option' ) ); |
| [28](#L28) | add\_action( 'wp\_ajax\_glf\_chosen\_options', array( $this, 'chosen\_options' ) ); |
| [29](#L29) | add\_action( 'wp\_ajax\_glf\_setup\_options\_remove', array( $this, 'glf\_setup\_options\_remove' ) ); |
| [30](#L30) |  |
| [31](#L31) | add\_action( 'wp\_ajax\_glf\_get\_updated\_urls', array( $this, 'glf\_get\_updated\_urls' ) ); |
| [32](#L32) |  |
| [33](#L33) | add\_action( 'wp\_ajax\_glf\_load\_screen', array( $this, 'glf\_load\_screen' ) ); |
| [34](#L34) |  |
| [35](#L35) | add\_action( 'wp\_ajax\_glf\_tracking', array( $this, 'glf\_tracking' ) ); |
| [36](#L36) |  |
| [37](#L37) | add\_action( 'wp\_ajax\_glf\_create\_demo\_page', array( $this, 'glf\_create\_demo\_page' ) ); |
| [38](#L38) | } |
| [39](#L39) | } |
| [40](#L40) | public function glf\_admin\_screens\_config(){ |
| [41](#L41) | if ( class\_exists( 'Glf\_Utils' ) ) { |
| [42](#L42) | Glf\_Utils::glf\_require\_once( GLF\_PLUGIN\_DIR . '/includes/admin/helper/class-glf-helper-screens.php' ); |
| [43](#L43) | } |
| [44](#L44) | } |
| [45](#L45) | public function glf\_admin\_screens\_menu(){ |
| [46](#L46) | add\_action( 'admin\_menu', array( $this, 'glf\_wordpress\_add\_menu\_options' ) ); |
| [47](#L47) | } |
| [48](#L48) |  |
| [49](#L49) | /\* |
| [50](#L50) | \* Actions perform at loading of admin menu |
| [51](#L51) | \*/ |
| [52](#L52) | public function glf\_wordpress\_add\_menu\_options() { |
| [53](#L53) | $title = 'GloriaFood'; |
| [54](#L54) | if ( current\_user\_can( 'manage\_options' ) ) { |
| [55](#L55) | add\_menu\_page( 'GloriaFood', $title, 'manage\_options', 'glf-overview', array( |
| [56](#L56) | $this, |
| [57](#L57) | 'glf\_wordpress\_add\_menu\_include' |
| [58](#L58) | ), GLF\_PLUGIN\_URL . 'assets/images/GF-icon.svg', '2.2.9' ); |
| [59](#L59) |  |
| [60](#L60) | add\_submenu\_page( 'glf-overview', 'Overview', 'Overview', 'manage\_options', 'glf-overview', array( |
| [61](#L61) | $this, |
| [62](#L62) | 'glf\_wordpress\_add\_menu\_include' |
| [63](#L63) | ) ); |
| [64](#L64) | add\_submenu\_page( 'glf-overview', 'Settings', 'Settings', 'manage\_options', 'glf-settings', array( |
| [65](#L65) | $this, |
| [66](#L66) | 'glf\_wordpress\_add\_menu\_include' |
| [67](#L67) | ) ); |
| [68](#L68) | } |
| [69](#L69) | } |
| [70](#L70) |  |
| [71](#L71) | /\* |
| [72](#L72) | \* Actions perform on loading of left menu or settings pages |
| [73](#L73) | \*/ |
| [74](#L74) | public function glf\_wordpress\_add\_menu\_include() { |
| [75](#L75) | $pages = array( 'overview', 'settings', 'screens', 'html' ); |
| [76](#L76) | $screen = get\_current\_screen(); |
| [77](#L77) | foreach ( $pages as $page ) { |
| [78](#L78) | if ( Glf\_Utils::glf\_url\_ends\_with( $screen->base, $page ) !== false ) { |
| [79](#L79) | if ( in\_array( $page, array( 'overview', 'settings', 'screens', 'html' ) ) ) { |
| [80](#L80) | Glf\_Utils::$\_GLF->update\_restaurants(); |
| [81](#L81) | Glf\_Utils::$\_GLF->load\_user\_data(); |
| [82](#L82) | Glf\_Utils::glf\_set\_default\_app\_options( false, 'add\_menu' ); |
| [83](#L83) | Glf\_Utils::glf\_custom\_css\_check\_and\_set\_defaults( Glf\_Utils::$\_GLF->custom\_css ); |
| [84](#L84) | require(GLF\_PLUGIN\_DIR . 'includes/admin/' . $page . '/class-glf-screen-' . $page . '.php'); |
| [85](#L85) | } |
| [86](#L86) | break; |
| [87](#L87) | } |
| [88](#L88) | } |
| [89](#L89) | } |
| [90](#L90) |  |
| [91](#L91) |  |
| [92](#L92) | public function glf\_load\_screen() { |
| [93](#L93) | $action = isset( $\_POST[ 'action' ] ) ? $\_POST[ 'action' ] : ''; |
| [94](#L94) | $response = array( 'action' => $action ); |
| [95](#L95) |  |
| [96](#L96) | $screen = isset( $\_POST[ 'data' ], $\_POST[ 'data' ][ 'screen' ] ) ? $\_POST[ 'data' ][ 'screen' ] : ''; |
| [97](#L97) |  |
| [98](#L98) | if ( $action !== 'glf\_load\_screen' && !empty( $screen )  ) { |
| [99](#L99) | $response[ 'status' ] = 'success'; |
| [100](#L100) | echo json\_encode( $response ); |
| [101](#L101) | exit(); |
| [102](#L102) | } |
| [103](#L103) |  |
| [104](#L104) | if( $screen === 'overview\_authenticate' ){ |
| [105](#L105) | ob\_start(); |
| [106](#L106) | Glf\_Utils::glf\_require\_once( \_\_DIR\_\_ . '/overview/overview\_top\_bar.php' ); |
| [107](#L107) | $\_POST['screen\_sign\_up'] = 'true'; |
| [108](#L108) | Glf\_Utils::glf\_require\_once( \_\_DIR\_\_ . '/overview/overview\_authenticate.php' ); |
| [109](#L109) | $response[ 'screen' ] = ob\_get\_clean(); |
| [110](#L110) | $response[ 'empty' ] = 'true'; |
| [111](#L111) | } |
| [112](#L112) |  |
| [113](#L113) |  |
| [114](#L114) | $response[ 'POST' ] = $\_POST; |
| [115](#L115) | $response[ 'status' ] = 'success'; |
| [116](#L116) | echo json\_encode( $response ); |
| [117](#L117) | exit(); |
| [118](#L118) |  |
| [119](#L119) | } |
| [120](#L120) | public function forms\_action() { |
| [121](#L121) | $errors = array(); |
| [122](#L122) | $action = isset( $\_POST[ 'action' ] ) ? str\_replace( 'glf\_form\_', '', $\_POST[ 'action' ] ) : ''; |
| [123](#L123) |  |
| [124](#L124) | $data = $\_POST[ 'data' ]; |
| [125](#L125) | parse\_str( $data, $data ); |
| [126](#L126) |  |
| [127](#L127) | $\_POST = array( 'action' => $action ); |
| [128](#L128) | foreach ( $data as $key => $d ) { |
| [129](#L129) | $\_POST[ $key ] = $d; |
| [130](#L130) | } |
| [131](#L131) | $response = array( 'action' => $action ); |
| [132](#L132) |  |
| [133](#L133) |  |
| [134](#L134) | if ( in\_array( $action, array( 'forgot\_password', 'login', 'sign\_up' ) ) ) { |
| [135](#L135) | if ( $this->glf\_security\_check() ) { |
| [136](#L136) | $this->glf\_security\_check\_failed( $response ); |
| [137](#L137) | } |
| [138](#L138) |  |
| [139](#L139) | $response[ 'data' ] = $data; |
| [140](#L140) |  |
| [141](#L141) | $validate\_fields = $this->glf\_validate\_fields( $action ); |
| [142](#L142) | if ( !empty( $validate\_fields ) ) { |
| [143](#L143) | $errors = $validate\_fields; |
| [144](#L144) | } else { |
| [145](#L145) | $errors = $this->glf\_validate\_form( $action ); |
| [146](#L146) | } |
| [147](#L147) | if( !empty( $errors ) ){ |
| [148](#L148) | $response[ 'errors' ] = $errors; |
| [149](#L149) | } |
| [150](#L150) | if ( empty( $errors ) ) { |
| [151](#L151) | $response[ 'status' ] = 'success'; |
| [152](#L152) | $response[ 'post' ] = $\_POST; |
| [153](#L153) | $response[ 'logged\_in' ] = Glf\_Utils::$\_GLF->is\_authenticated(); |
| [154](#L154) |  |
| [155](#L155) | Glf\_Utils::glf\_set\_default\_app\_options( false, $action); |
| [156](#L156) | $glf\_wordpress\_options = Glf\_Utils::glf\_wp\_options\_data('true'); |
| [157](#L157) | ob\_start(); |
| [158](#L158) | if( $action !== 'forgot\_password' ){ |
| [159](#L159) | Glf\_Utils::$\_GLF->update\_restaurants(); |
| [160](#L160) | Glf\_Utils::$\_GLF->load\_user\_data(); |
| [161](#L161) | $is\_update = Glf\_Utils::glf\_get\_from\_wordpress\_options( 'is\_update', '' ); |
| [162](#L162) |  |
| [163](#L163) | if( $is\_update ){ |
| [164](#L164) | //Glf\_Utils::glf\_add\_to\_wordpress\_options( 'is\_update', false ); |
| [165](#L165) | Glf\_Helper\_Screens::set\_default\_setup\_options(); |
| [166](#L166) | $response[ 'action' ] = 'redirect'; |
| [167](#L167) | $response[ 'screen\_url' ] = admin\_url() . 'admin.php?page=glf-overview'; |
| [168](#L168) | }  else{ |
| [169](#L169) |  |
| [170](#L170) | Glf\_Utils::glf\_require\_once( \_\_DIR\_\_ . '/overview/overview\_screen\_options.php' ); |
| [171](#L171) | Glf\_Utils::glf\_add\_to\_wordpress\_options( $action, false ); |
| [172](#L172) |  |
| [173](#L173) | $screen\_output = glf\_get\_screen\_sequence( $action ); |
| [174](#L174) | $response[ 'html' ] = $screen\_output['output']; |
| [175](#L175) | if( empty( $response[ 'html' ] ) ){ |
| [176](#L176) | $response[ 'action' ] = 'redirect'; |
| [177](#L177) | $response[ 'screen\_url' ] = admin\_url() . 'admin.php?page=glf-overview'; |
| [178](#L178) | } |
| [179](#L179) | else{ |
| [180](#L180) | if( $screen\_output['extra'] === 'empty' ){ |
| [181](#L181) | $response[ 'empty' ] = 'true'; |
| [182](#L182) | } |
| [183](#L183) | echo $response[ 'html' ]; |
| [184](#L184) | } |
| [185](#L185) | } |
| [186](#L186) |  |
| [187](#L187) |  |
| [188](#L188) | }else{ |
| [189](#L189) | Glf\_Utils::glf\_require\_once( \_\_DIR\_\_ . '/overview/overview\_authenticate.php' ); |
| [190](#L190) | $response[ 'empty' ] = 'true'; |
| [191](#L191) | } |
| [192](#L192) |  |
| [193](#L193) | $response[ 'screen' ] = ob\_get\_clean(); |
| [194](#L194) |  |
| [195](#L195) | } |
| [196](#L196) | } else if ( $action === 'disconnect' ) { |
| [197](#L197) | delete\_option( 'glf\_connection\_type' ); |
| [198](#L198) | Glf\_Utils::$\_GLF->remove\_user\_data(); |
| [199](#L199) | } |
| [200](#L200) |  |
| [201](#L201) | $response[ 'POST' ] = $\_POST; |
| [202](#L202) | echo json\_encode( $response ); |
| [203](#L203) | exit(); |
| [204](#L204) | } |
| [205](#L205) | public function set\_option() { |
| [206](#L206) | $errors = array(); |
| [207](#L207) | $action = isset( $\_POST[ 'action' ] ) ? $\_POST[ 'action' ] : ''; |
| [208](#L208) |  |
| [209](#L209) | $data = $\_POST[ 'data' ]; |
| [210](#L210) | $response = array( 'action' => $action ); |
| [211](#L211) | if ( $action === 'glf\_set\_option' ) { |
| [212](#L212) | Glf\_Utils::glf\_add\_to\_wordpress\_options( (string)$data[ 'option\_name' ], (string)$data[ 'option\_value' ] ); |
| [213](#L213) |  |
| [214](#L214) |  |
| [215](#L215) | if( isset( $data['screen'] ) ){ |
| [216](#L216) | if( $data[ 'screen' ] === 'overview' ){ |
| [217](#L217) | $response[ 'action' ] = 'redirect'; |
| [218](#L218) | $response[ 'screen\_url' ] = admin\_url() . 'admin.php?page=glf-overview'; |
| [219](#L219) |  |
| [220](#L220) | } else{ |
| [221](#L221) | $response[ 'action' ] = $data[ 'screen' ]; |
| [222](#L222) | } |
| [223](#L223) | } |
| [224](#L224) | $response[ 'status' ] = 'success'; |
| [225](#L225) | $response[ $data['option\_name'] ] = Glf\_Utils::glf\_get\_from\_wordpress\_options( (string)$data[ 'option\_name' ], '', 'true' ); |
| [226](#L226) |  |
| [227](#L227) | } |
| [228](#L228) |  |
| [229](#L229) | echo json\_encode( $response ); |
| [230](#L230) | exit(); |
| [231](#L231) | } |
| [232](#L232) | public function chosen\_options() { |
| [233](#L233) | $errors = array(); |
| [234](#L234) | $action = isset( $\_POST[ 'action' ] ) ? $\_POST[ 'action' ] : ''; |
| [235](#L235) |  |
| [236](#L236) | $data = $\_POST[ 'data' ]; |
| [237](#L237) | $response = array( 'action' => $action ); |
| [238](#L238) | if ( $action === 'glf\_chosen\_options' ) { |
| [239](#L239) | $chosen\_options = array(); |
| [240](#L240) | foreach ( $data as $option\_name => $option ) { |
| [241](#L241) | if ( $option === 'true' ) { |
| [242](#L242) | $\_extra\_options = Glf\_Helper\_Screens::get\_todo\_options\_of\_extra\_option( $option\_name ); |
| [243](#L243) | if(!empty( $\_extra\_options) && is\_array( $\_extra\_options)){ |
| [244](#L244) | foreach ( $\_extra\_options as $\_extra\_opt\_key => $val ) { |
| [245](#L245) | $chosen\_options[] = $\_extra\_opt\_key; |
| [246](#L246) | } |
| [247](#L247) | } else{ |
| [248](#L248) | $chosen\_options[] = $option\_name; |
| [249](#L249) | } |
| [250](#L250) | } |
| [251](#L251) |  |
| [252](#L252) | } |
| [253](#L253) | Glf\_Utils::glf\_add\_to\_wordpress\_options( 'setup\_options', $chosen\_options ); |
| [254](#L254) |  |
| [255](#L255) | $response[ 'status' ] = 'success'; |
| [256](#L256) | $response[ 'data' ] = $\_POST[ 'data' ]; |
| [257](#L257) | } |
| [258](#L258) |  |
| [259](#L259) | echo json\_encode( $response ); |
| [260](#L260) | exit(); |
| [261](#L261) | } |
| [262](#L262) | public function glf\_setup\_options\_remove() { |
| [263](#L263) | $errors = array(); |
| [264](#L264) | $action = isset( $\_POST[ 'action' ] ) ? $\_POST[ 'action' ] : ''; |
| [265](#L265) |  |
| [266](#L266) | $data = $\_POST[ 'data' ]; |
| [267](#L267) | $response = array( 'action' => $action ); |
| [268](#L268) | if ( $action === 'glf\_setup\_options\_remove' && isset( $data['option'] )  ) { |
| [269](#L269) | if( $data[ 'option' ] === 'enroll\_partner\_program' ){ |
| [270](#L270) | Glf\_Utils::glf\_add\_to\_wordpress\_options( 'partner\_program\_dismiss', 'yes' ); |
| [271](#L271) | }else{ |
| [272](#L272) | $chosen\_options = Glf\_Utils::glf\_get\_from\_wordpress\_options( 'setup\_options', array() ); |
| [273](#L273) | foreach ( $chosen\_options as $idx => $option ) { |
| [274](#L274) | if ( $data[ 'option' ] === $option ) { |
| [275](#L275) | unset( $chosen\_options[ $idx ] ); |
| [276](#L276) | } |
| [277](#L277) |  |
| [278](#L278) | } |
| [279](#L279) | Glf\_Utils::glf\_add\_to\_wordpress\_options( 'setup\_options', $chosen\_options ); |
| [280](#L280) | } |
| [281](#L281) |  |
| [282](#L282) | $response[ 'status' ] = 'success'; |
| [283](#L283) | $response[ 'data' ] = $\_POST[ 'data' ]; |
| [284](#L284) | } |
| [285](#L285) |  |
| [286](#L286) | echo json\_encode( $response ); |
| [287](#L287) | exit(); |
| [288](#L288) | } |
| [289](#L289) | public function glf\_get\_updated\_urls(){ |
| [290](#L290) | $action = isset( $\_POST[ 'action' ] ) ? $\_POST[ 'action' ] : ''; |
| [291](#L291) |  |
| [292](#L292) | $response = array( 'action' => $action ); |
| [293](#L293) | if ( $action === 'glf\_get\_updated\_urls' ) { |
| [294](#L294) | $data = $\_POST[ 'data' ]; |
| [295](#L295) | $location = isset( $data[ 'location' ] ) ? (string)$data[ 'location' ] : ''; |
| [296](#L296) |  |
| [297](#L297) | $glf\_wordpress\_options = Glf\_Utils::glf\_wp\_options\_data(); |
| [298](#L298) | $glf\_wordpress\_options->{'app\_options'}[ Glf\_Utils::$\_GLF->user->id ][ 'default\_location' ] = $location; |
| [299](#L299) | Glf\_Utils::glf\_database\_option\_operation( 'update', 'glf\_wordpress\_options', $glf\_wordpress\_options ); |
| [300](#L300) |  |
| [301](#L301) | $response[ 'status' ] = 'success'; |
| [302](#L302) | $response[ 'location' ] = $location; |
| [303](#L303) | $restaurant = Glf\_Utils::get\_restaurant\_data\_by\_location( $location ); |
| [304](#L304) | $response[ 'todo' ] = Glf\_Helper\_Screens::generate\_todo\_list( $restaurant ); |
| [305](#L305) | $response[ 'admin\_url' ] = Glf\_Utils::$\_GLF->get\_glf\_mor\_token() . '&r=app.admin.setup&acid=' . $restaurant->account\_id; |
| [306](#L306) |  |
| [307](#L307) | } |
| [308](#L308) |  |
| [309](#L309) | echo json\_encode( $response ); |
| [310](#L310) | exit(); |
| [311](#L311) | } |
| [312](#L312) |  |
| [313](#L313) | public function glf\_security\_check\_failed( $response ) { |
| [314](#L314) | $response[ 'status' ] = 'error'; |
| [315](#L315) | $response[ 'msg' ] = 'Access restricted, security check failed!'; |
| [316](#L316) | echo json\_encode( $response ); |
| [317](#L317) | exit(); |
| [318](#L318) | } |
| [319](#L319) |  |
| [320](#L320) | public function glf\_security\_check() { |
| [321](#L321) | return (!(!empty( $\_POST[ 'action' ] ) && current\_user\_can( 'manage\_options' ) && isset( $\_POST[ '\_wpnonce' ] ) && wp\_verify\_nonce( $\_POST[ '\_wpnonce' ], 'glf-mor-auth' ))); |
| [322](#L322) | } |
| [323](#L323) |  |
| [324](#L324) | public function glf\_validate\_form( $mode ) { |
| [325](#L325) | $errors = array(); |
| [326](#L326) |  |
| [327](#L327) | if( $mode === 'login' ){ |
| [328](#L328) | $connection\_type = isset( $\_POST[ 'glf\_connection\_type' ] ) ? $\_POST[ 'glf\_connection\_type' ] : ''; |
| [329](#L329) | if( !empty( $connection\_type ) ){ |
| [330](#L330) | update\_option( 'glf\_connection\_type', $connection\_type ); |
| [331](#L331) | } |
| [332](#L332) | } |
| [333](#L333) | $get\_connection\_type = get\_option( 'glf\_connection\_type', '' ); |
| [334](#L334) | $response\_body = Glf\_Utils::glf\_mor\_remote\_call( ( $get\_connection\_type === 'staging' ? GLF\_STAGING\_API\_URL : GLF\_API\_URL ), $mode ); |
| [335](#L335) |  |
| [336](#L336) | $response[ 'response\_body' ] = $response\_body; |
| [337](#L337) | if ( isset( $response\_body->errorDescription ) ) { |
| [338](#L338) | $errors[ "form" ] = $response\_body->errorDescription; |
| [339](#L339) | } else if ( $mode !== 'forgot\_password' ) { |
| [340](#L340) | if ( $mode !== 'login' ) { |
| [341](#L341) | $errors = $this->glf\_validate\_form( 'login' ); |
| [342](#L342) | } else { |
| [343](#L343) | Glf\_Utils::$\_GLF->save\_user\_data( array( |
| [344](#L344) | 'user' => $response\_body->user, |
| [345](#L345) | 'auth\_domain' => $response\_body->domain, |
| [346](#L346) | 'auth\_token' => $response\_body->token |
| [347](#L347) | ) ); |
| [348](#L348) | Glf\_Utils::$\_GLF->load\_user\_data(); |
| [349](#L349) | } |
| [350](#L350) | } |
| [351](#L351) | return $errors; |
| [352](#L352) | } |
| [353](#L353) |  |
| [354](#L354) | public function glf\_validate\_fields( $mode ) { |
| [355](#L355) | $fields = array( |
| [356](#L356) | "login" => array( "email", "password" ), |
| [357](#L357) | "sign\_up" => array( "email", "password", "restaurant\_name", "first\_name", "last\_name" ), |
| [358](#L358) | "forgot\_password" => array( "email" ), |
| [359](#L359) | ); |
| [360](#L360) | $fields = $fields[ $mode ]; |
| [361](#L361) | $errors = array(); |
| [362](#L362) | foreach ( $fields as $field ) { |
| [363](#L363) | if ( !isset( $\_POST[ $field ] ) || empty( $\_POST[ $field ] ) ) { |
| [364](#L364) | $errors[ $field ] = "Please fill in the " .$this->glf\_field\_to\_label( $field ); |
| [365](#L365) | } elseif ( $field === "email" && !is\_email( $\_POST[ $field ] ) ) { |
| [366](#L366) | $errors[ $field ] = "The Email Address you inserted is invalid!"; |
| [367](#L367) | } |
| [368](#L368) | } |
| [369](#L369) |  |
| [370](#L370) | return $errors; |
| [371](#L371) | } |
| [372](#L372) |  |
| [373](#L373) | public function glf\_field\_to\_label( $field ) { |
| [374](#L374) | switch ( $field ) { |
| [375](#L375) | case 'email': |
| [376](#L376) | return \_\_( 'Email', 'menu-ordering-reservations' ); |
| [377](#L377) |  |
| [378](#L378) | case 'password': |
| [379](#L379) | return \_\_( 'Password', 'menu-ordering-reservations' ); |
| [380](#L380) |  |
| [381](#L381) | case 'restaurant\_name': |
| [382](#L382) | return \_\_( 'Restaurant name', 'menu-ordering-reservations' ); |
| [383](#L383) |  |
| [384](#L384) | case 'first\_name': |
| [385](#L385) | return \_\_( 'First name', 'menu-ordering-reservations' ); |
| [386](#L386) |  |
| [387](#L387) | case 'last\_name': |
| [388](#L388) | return \_\_( 'Last name', 'menu-ordering-reservations' ); |
| [389](#L389) |  |
| [390](#L390) | default: |
| [391](#L391) | return ucwords( str\_replace( "\_", " ", $field ) ); |
| [392](#L392) | } |
| [393](#L393) |  |
| [394](#L394) | } |
| [395](#L395) |  |
| [396](#L396) | public function glf\_tracking() { |
| [397](#L397) | $action = isset( $\_POST[ 'action' ] ) ? $\_POST[ 'action' ] : ''; |
| [398](#L398) | $data = $\_POST[ 'data' ]; |
| [399](#L399) | $response = array( 'action' => $action ); |
| [400](#L400) | if ( $action === 'glf\_tracking' ) { |
| [401](#L401) | $response['data'] = Glf\_Utils::glf\_tracking\_send( $data ); |
| [402](#L402) |  |
| [403](#L403) | } |
| [404](#L404) | echo json\_encode( $response ); |
| [405](#L405) | exit(); |
| [406](#L406) | } |
| [407](#L407) |  |
| [408](#L408) | public function glf\_create\_demo\_page() { |
| [409](#L409) | $action = isset( $\_POST[ 'action' ] ) ? $\_POST[ 'action' ] : ''; |
| [410](#L410) | $data = $\_POST[ 'data' ]; |
| [411](#L411) | $response = array( 'action' => $action ); |
| [412](#L412) | if ( $action === 'glf\_create\_demo\_page' ) { |
| [413](#L413) | Glf\_Helper\_Screens::create\_demo\_page(); |
| [414](#L414) | $response['url'] = Glf\_Helper\_Screens::get\_demo\_page\_edit\_url(); |
| [415](#L415) |  |
| [416](#L416) | } |
| [417](#L417) | echo json\_encode( $response ); |
| [418](#L418) | exit(); |
| [419](#L419) | } |
| [420](#L420) |  |
| [421](#L421) | } |
| [422](#L422) |  |
| [423](#L423) | new Glf\_Admin\_Screens(); |
| [424](#L424) | } |

**Note:** See [TracBrowser](/wiki/TracBrowser)
for help on using the repository browser.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Plain Text](/browser/menu-ordering-reservations/trunk/includes/admin/class-glf-admin-screens.php?rev=2664283&format=txt)
* [Original Format](/export/2664283/menu-ordering-reservations/trunk/includes/admin/class-glf-admin-screens.php)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)



=== Content from plugins.trac.wordpress.org_9e1f4209_20250108_125930.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fchangeset%3Fnew%3D2793398%2540menu-ordering-reservations%26old%3D2793398%2540menu-ordering-reservations)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Change](/changeset/2720462/menu-ordering-reservations "Changeset 2720462 for menu-ordering-reservations")
* [Next Change](/changeset/2793399/menu-ordering-reservations "Changeset 2793399 for menu-ordering-reservations") →

---

# Changeset [2793398](/changeset/2793398 "Show full changeset") for [menu-ordering-reservations](/browser/menu-ordering-reservations?rev=2793398 "Show entry in browser")

View differences
inline
side by side

Show
lines around each change

Show the changes in full context

Ignore:

Blank lines

Case changes

White space changes

Timestamp:
10/03/2022 11:31:30 AM
([2 years](/timeline?from=2022-10-03T11%3A31%3A30Z&precision=second "See timeline at 10/03/2022 11:31:30 AM") ago)

Author:
gloriafood
Message:

release version 2.3.1

Location:
[menu-ordering-reservations/trunk](/browser/menu-ordering-reservations/trunk?rev=2793398)
Files:

14 edited

* [assets/css/public-style.css](/browser/menu-ordering-reservations/trunk/assets/css/public-style.css?rev=2793398 "Show entry in browser")
  (modified)
  ([2 diffs](#file0 "Show differences"))
* [assets/js/footer.js](/browser/menu-ordering-reservations/trunk/assets/js/footer.js?rev=2793398 "Show entry in browser")
  (modified)
  ([1 diff](#file1 "Show differences"))
* [includes/admin/class-glf-admin-screens.php](/browser/menu-ordering-reservations/trunk/includes/admin/class-glf-admin-screens.php?rev=2793398 "Show entry in browser")
  (modified)
  ([8 diffs](#file2 "Show differences"))
* [includes/modules/ask-for-review/class-glf-module-ask-for-review.php](/browser/menu-ordering-reservations/trunk/includes/modules/ask-for-review/class-glf-module-ask-for-review.php?rev=2793398 "Show entry in browser")
  (modified)
  ([2 diffs](#file3 "Show differences"))
* [includes/modules/elementor/class-glf-module-elementor.php](/browser/menu-ordering-reservations/trunk/includes/modules/elementor/class-glf-module-elementor.php?rev=2793398 "Show entry in browser")
  (modified)
  ([3 diffs](#file4 "Show differences"))
* [includes/modules/elementor/widgets/base/class-glf-widget-button-base.php](/browser/menu-ordering-reservations/trunk/includes/modules/elementor/widgets/base/class-glf-widget-button-base.php?rev=2793398 "Show entry in browser")
  (modified)
  ([6 diffs](#file5 "Show differences"))
* [includes/modules/elementor/widgets/food-menu/class-glf-module-elementor-food-menu-widget.php](/browser/menu-ordering-reservations/trunk/includes/modules/elementor/widgets/food-menu/class-glf-module-elementor-food-menu-widget.php?rev=2793398 "Show entry in browser")
  (modified)
  ([1 diff](#file6 "Show differences"))
* [includes/modules/elementor/widgets/opening-hours/class-glf-module-elementor-opening-hours-widget.php](/browser/menu-ordering-reservations/trunk/includes/modules/elementor/widgets/opening-hours/class-glf-module-elementor-opening-hours-widget.php?rev=2793398 "Show entry in browser")
  (modified)
  ([1 diff](#file7 "Show differences"))
* [includes/modules/elementor/widgets/promotions/class-glf-module-elementor-promotions-widget.php](/browser/menu-ordering-reservations/trunk/includes/modules/elementor/widgets/promotions/class-glf-module-elementor-promotions-widget.php?rev=2793398 "Show entry in browser")
  (modified)
  ([1 diff](#file8 "Show differences"))
* [includes/modules/elementor/widgets/reservations/class-glf-module-elementor-reservations-widget.php](/browser/menu-ordering-reservations/trunk/includes/modules/elementor/widgets/reservations/class-glf-module-elementor-reservations-widget.php?rev=2793398 "Show entry in browser")
  (modified)
  ([1 diff](#file9 "Show differences"))
* [includes/modules/shortcodes/class-glf-module-shortcodes.php](/browser/menu-ordering-reservations/trunk/includes/modules/shortcodes/class-glf-module-shortcodes.php?rev=2793398 "Show entry in browser")
  (modified)
  ([1 diff](#file10 "Show differences"))
* [includes/utils/class-glf-utils.php](/browser/menu-ordering-reservations/trunk/includes/utils/class-glf-utils.php?rev=2793398 "Show entry in browser")
  (modified)
  ([3 diffs](#file11 "Show differences"))
* [readme.txt](/browser/menu-ordering-reservations/trunk/readme.txt?rev=2793398 "Show entry in browser")
  (modified)
  ([1 diff](#file12 "Show differences"))
* [restaurant-system.php](/browser/menu-ordering-reservations/trunk/restaurant-system.php?rev=2793398 "Show entry in browser")
  (modified)
  ([3 diffs](#file13 "Show differences"))

### Legend:

Unmodified
Added
Removed

* ## [menu-ordering-reservations/trunk/assets/css/public-style.css](/changeset/2793398/menu-ordering-reservations/trunk/assets/css/public-style.css "Show the changeset 2793398 restricted to menu-ordering-reservations/trunk/assets/css/public-style.css")

  | [r2720461](/browser/menu-ordering-reservations/trunk/assets/css/public-style.css?rev=2720461#L23 "Show revision 2720461 of this file in browser") | [r2793398](/browser/menu-ordering-reservations/trunk/assets/css/public-style.css?rev=2793398#L23 "Show revision 2793398 of this file in browser") |  |
  | --- | --- | --- |
  | 23 | 23 | .glf-mor-restaurant-menu-category:first-of-type { |
  | 24 | 24 | padding-top: 0; |
  |  | 25 | } |
  |  | 26 |  |
  |  | 27 | .glf-mor-restaurant-menu-category-description { |
  |  | 28 | font-weight: 400; |
  |  | 29 | font-size: 1.25rem; |
  |  | 30 | line-height: 1.6; |
  |  | 31 | padding-top: 0.5rem; |
  | 25 | 32 | } |
  | 26 | 33 |  |
  | […](/browser/menu-ordering-reservations/trunk/assets/css/public-style.css?rev=2720461#L270) | […](/browser/menu-ordering-reservations/trunk/assets/css/public-style.css?rev=2793398#L277) |  |
  | 270 | 277 | margin: 0px 10px 20px 10px; |
  | 271 | 278 | } |
  |  | 279 |  |
  |  | 280 | .elementor-glf-button { |
  |  | 281 | cursor: pointer; |
  |  | 282 | } |
* ## [menu-ordering-reservations/trunk/assets/js/footer.js](/changeset/2793398/menu-ordering-reservations/trunk/assets/js/footer.js "Show the changeset 2793398 restricted to menu-ordering-reservations/trunk/assets/js/footer.js")

  | [r2568003](/browser/menu-ordering-reservations/trunk/assets/js/footer.js?rev=2568003#L4 "Show revision 2568003 of this file in browser") | [r2793398](/browser/menu-ordering-reservations/trunk/assets/js/footer.js?rev=2793398#L4 "Show revision 2793398 of this file in browser") |  |
  | --- | --- | --- |
  | 4 | 4 |  |
  | 5 | 5 | //Do we trust the sender of this message? |
  | 6 |  | if (~~!re.test(event.origin)~~) |
  |  | 6 | if (event.origin !== 'https://www.restaurantlogin.com') |
  | 7 | 7 | return; |
  | 8 | 8 |  |
* ## [menu-ordering-reservations/trunk/includes/admin/class-glf-admin-screens.php](/changeset/2793398/menu-ordering-reservations/trunk/includes/admin/class-glf-admin-screens.php "Show the changeset 2793398 restricted to menu-ordering-reservations/trunk/includes/admin/class-glf-admin-screens.php")

  | [r2664283](/browser/menu-ordering-reservations/trunk/includes/admin/class-glf-admin-screens.php?rev=2664283#L94 "Show revision 2664283 of this file in browser") | [r2793398](/browser/menu-ordering-reservations/trunk/includes/admin/class-glf-admin-screens.php?rev=2793398#L94 "Show revision 2793398 of this file in browser") |  |
  | --- | --- | --- |
  | 94 | 94 | $response = array( 'action' => $action ); |
  | 95 | 95 |  |
  |  | 96 | if ( Glf\_Utils::glf\_capabilities\_check() ) { |
  |  | 97 | Glf\_Utils::glf\_capabilities\_check\_failed( $response ); |
  |  | 98 | } |
  |  | 99 |  |
  | 96 | 100 | $screen = isset( $\_POST[ 'data' ], $\_POST[ 'data' ][ 'screen' ] ) ? $\_POST[ 'data' ][ 'screen' ] : ''; |
  | 97 | 101 |  |
  | […](/browser/menu-ordering-reservations/trunk/includes/admin/class-glf-admin-screens.php?rev=2664283#L131) | […](/browser/menu-ordering-reservations/trunk/includes/admin/class-glf-admin-screens.php?rev=2793398#L135) |  |
  | 131 | 135 | $response = array( 'action' => $action ); |
  | 132 | 136 |  |
  |  | 137 | if ( Glf\_Utils::glf\_capabilities\_check() ) { |
  |  | 138 | Glf\_Utils::glf\_capabilities\_check\_failed( $response ); |
  |  | 139 | } |
  | 133 | 140 |  |
  | 134 | 141 | if ( in\_array( $action, array( 'forgot\_password', 'login', 'sign\_up' ) ) ) { |
  | […](/browser/menu-ordering-reservations/trunk/includes/admin/class-glf-admin-screens.php?rev=2664283#L209) | […](/browser/menu-ordering-reservations/trunk/includes/admin/class-glf-admin-screens.php?rev=2793398#L216) |  |
  | 209 | 216 | $data = $\_POST[ 'data' ]; |
  | 210 | 217 | $response = array( 'action' => $action ); |
  |  | 218 |  |
  |  | 219 | if ( Glf\_Utils::glf\_capabilities\_check() ) { |
  |  | 220 | Glf\_Utils::glf\_capabilities\_check\_failed( $response ); |
  |  | 221 | } |
  |  | 222 |  |
  | 211 | 223 | if ( $action === 'glf\_set\_option' ) { |
  | 212 | 224 | Glf\_Utils::glf\_add\_to\_wordpress\_options( (string)$data[ 'option\_name' ], (string)$data[ 'option\_value' ] ); |
  | […](/browser/menu-ordering-reservations/trunk/includes/admin/class-glf-admin-screens.php?rev=2664283#L236) | […](/browser/menu-ordering-reservations/trunk/includes/admin/class-glf-admin-screens.php?rev=2793398#L248) |  |
  | 236 | 248 | $data = $\_POST[ 'data' ]; |
  | 237 | 249 | $response = array( 'action' => $action ); |
  |  | 250 | if ( Glf\_Utils::glf\_capabilities\_check() ) { |
  |  | 251 | Glf\_Utils::glf\_capabilities\_check\_failed( $response ); |
  |  | 252 | } |
  | 238 | 253 | if ( $action === 'glf\_chosen\_options' ) { |
  | 239 | 254 | $chosen\_options = array(); |
  | […](/browser/menu-ordering-reservations/trunk/includes/admin/class-glf-admin-screens.php?rev=2664283#L266) | […](/browser/menu-ordering-reservations/trunk/includes/admin/class-glf-admin-screens.php?rev=2793398#L281) |  |
  | 266 | 281 | $data = $\_POST[ 'data' ]; |
  | 267 | 282 | $response = array( 'action' => $action ); |
  |  | 283 |  |
  |  | 284 | if ( Glf\_Utils::glf\_capabilities\_check() ) { |
  |  | 285 | Glf\_Utils::glf\_capabilities\_check\_failed( $response ); |
  |  | 286 | } |
  |  | 287 |  |
  | 268 | 288 | if ( $action === 'glf\_setup\_options\_remove' && isset( $data['option'] )  ) { |
  | 269 | 289 | if( $data[ 'option' ] === 'enroll\_partner\_program' ){ |
  | […](/browser/menu-ordering-reservations/trunk/includes/admin/class-glf-admin-screens.php?rev=2664283#L291) | […](/browser/menu-ordering-reservations/trunk/includes/admin/class-glf-admin-screens.php?rev=2793398#L311) |  |
  | 291 | 311 |  |
  | 292 | 312 | $response = array( 'action' => $action ); |
  |  | 313 |  |
  |  | 314 | if ( Glf\_Utils::glf\_capabilities\_check() ) { |
  |  | 315 | Glf\_Utils::glf\_capabilities\_check\_failed( $response ); |
  |  | 316 | } |
  |  | 317 |  |
  | 293 | 318 | if ( $action === 'glf\_get\_updated\_urls' ) { |
  | 294 | 319 | $data = $\_POST[ 'data' ]; |
  | […](/browser/menu-ordering-reservations/trunk/includes/admin/class-glf-admin-screens.php?rev=2664283#L398) | […](/browser/menu-ordering-reservations/trunk/includes/admin/class-glf-admin-screens.php?rev=2793398#L423) |  |
  | 398 | 423 | $data = $\_POST[ 'data' ]; |
  | 399 | 424 | $response = array( 'action' => $action ); |
  |  | 425 |  |
  |  | 426 | if ( Glf\_Utils::glf\_capabilities\_check() ) { |
  |  | 427 | Glf\_Utils::glf\_capabilities\_check\_failed( $response ); |
  |  | 428 | } |
  |  | 429 |  |
  | 400 | 430 | if ( $action === 'glf\_tracking' ) { |
  | 401 | 431 | $response['data'] = Glf\_Utils::glf\_tracking\_send( $data ); |
  | […](/browser/menu-ordering-reservations/trunk/includes/admin/class-glf-admin-screens.php?rev=2664283#L410) | […](/browser/menu-ordering-reservations/trunk/includes/admin/class-glf-admin-screens.php?rev=2793398#L440) |  |
  | 410 | 440 | $data = $\_POST[ 'data' ]; |
  | 411 | 441 | $response = array( 'action' => $action ); |
  |  | 442 |  |
  |  | 443 | if ( Glf\_Utils::glf\_capabilities\_check() ) { |
  |  | 444 | Glf\_Utils::glf\_capabilities\_check\_failed( $response ); |
  |  | 445 | } |
  |  | 446 |  |
  | 412 | 447 | if ( $action === 'glf\_create\_demo\_page' ) { |
  | 413 | 448 | Glf\_Helper\_Screens::create\_demo\_page(); |
* ## [menu-ordering-reservations/trunk/includes/modules/ask-for-review/class-glf-module-ask-for-review.php](/changeset/2793398/menu-ordering-reservations/trunk/includes/modules/ask-for-review/class-glf-module-ask-for-review.php "Show the changeset 2793398 restricted to menu-ordering-reservations/trunk/includes/modules/ask-for-review/class-glf-module-ask-for-review.php")

  | [r2664283](/browser/menu-ordering-reservations/trunk/includes/modules/ask-for-review/class-glf-module-ask-for-review.php?rev=2664283#L76 "Show revision 2664283 of this file in browser") | [r2793398](/browser/menu-ordering-reservations/trunk/includes/modules/ask-for-review/class-glf-module-ask-for-review.php?rev=2793398#L76 "Show revision 2793398 of this file in browser") |  |
  | --- | --- | --- |
  | 76 | 76 |  |
  | 77 | 77 | public function glf\_action\_ask\_for\_review\_user\_response() { |
  |  | 78 | $action = isset( $\_POST[ 'action' ] ) ? $\_POST[ 'action' ] : ''; |
  |  | 79 | $response = array( 'action' => $action ); |
  |  | 80 |  |
  |  | 81 | if ( Glf\_Utils::glf\_capabilities\_check() ) { |
  |  | 82 | Glf\_Utils::glf\_capabilities\_check\_failed( $response ); |
  |  | 83 | } |
  |  | 84 |  |
  | 78 | 85 | $this->glf\_get\_database\_option(); |
  | 79 | 86 | $this->db\_option\_ask\_for\_review[ 'already\_done\_review' ] = true; |
  | […](/browser/menu-ordering-reservations/trunk/includes/modules/ask-for-review/class-glf-module-ask-for-review.php?rev=2664283#L83) | […](/browser/menu-ordering-reservations/trunk/includes/modules/ask-for-review/class-glf-module-ask-for-review.php?rev=2793398#L90) |  |
  | 83 | 90 | } |
  | 84 | 91 | public function glf\_action\_ask\_for\_review\_cta\_clicked() { |
  |  | 92 | $action = isset( $\_POST[ 'action' ] ) ? $\_POST[ 'action' ] : ''; |
  |  | 93 | $response = array( 'action' => $action ); |
  |  | 94 |  |
  |  | 95 | if ( Glf\_Utils::glf\_capabilities\_check() ) { |
  |  | 96 | Glf\_Utils::glf\_capabilities\_check\_failed( $response ); |
  |  | 97 | } |
  |  | 98 |  |
  | 85 | 99 | $this->glf\_get\_database\_option(); |
  | 86 | 100 | $this->db\_option\_ask\_for\_review[ 'banner\_review\_requested\_event' ] = true; |
* ## [menu-ordering-reservations/trunk/includes/modules/elementor/class-glf-module-elementor.php](/changeset/2793398/menu-ordering-reservations/trunk/includes/modules/elementor/class-glf-module-elementor.php "Show the changeset 2793398 restricted to menu-ordering-reservations/trunk/includes/modules/elementor/class-glf-module-elementor.php")

  | [r2720461](/browser/menu-ordering-reservations/trunk/includes/modules/elementor/class-glf-module-elementor.php?rev=2720461#L30 "Show revision 2720461 of this file in browser") | [r2793398](/browser/menu-ordering-reservations/trunk/includes/modules/elementor/class-glf-module-elementor.php?rev=2793398#L30 "Show revision 2793398 of this file in browser") |  |
  | --- | --- | --- |
  | 30 | 30 | add\_action( 'elementor/widgets/widgets\_registered', array( $this, 'glf\_register\_elementor\_widgets' ) ); |
  | 31 | 31 |  |
  |  | 32 | add\_action( 'elementor/editor/after\_save', array( $this, 'glf\_after\_save\_elementor' ), 10 , 2 ); |
  |  | 33 |  |
  | 32 | 34 | if ( wp\_doing\_ajax() ) { |
  | 33 | 35 | $this->add\_elementor\_widget\_ajax(); |
  | […](/browser/menu-ordering-reservations/trunk/includes/modules/elementor/class-glf-module-elementor.php?rev=2720461#L41) | […](/browser/menu-ordering-reservations/trunk/includes/modules/elementor/class-glf-module-elementor.php?rev=2793398#L43) |  |
  | 41 | 43 |  |
  | 42 | 44 | public function refresh\_elementor\_widget() { |
  |  | 45 | $action = isset( $\_POST[ 'action' ] ) ? $\_POST[ 'action' ] : ''; |
  | 43 | 46 | $response = array( |
  | 44 |  | 'status' => 'failure', |
  |  | 47 | 'action' => $action , |
  |  | 48 | 'status' => 'failure' |
  |  | 49 |  |
  | 45 | 50 | ); |
  |  | 51 |  |
  |  | 52 | if ( Glf\_Utils::glf\_capabilities\_check() ) { |
  |  | 53 | Glf\_Utils::glf\_capabilities\_check\_failed( $response ); |
  |  | 54 | } |
  |  | 55 |  |
  | 46 | 56 | if( isset( $\_POST['action'] ) && $\_POST['action'] === 'glf\_refresh\_elementor\_widget' ){ |
  | 47 | 57 | $response['status'] = 'success'; |
  | […](/browser/menu-ordering-reservations/trunk/includes/modules/elementor/class-glf-module-elementor.php?rev=2720461#L124) | […](/browser/menu-ordering-reservations/trunk/includes/modules/elementor/class-glf-module-elementor.php?rev=2793398#L134) |  |
  | 124 | 134 |  |
  | 125 | 135 | } |
  |  | 136 |  |
  |  | 137 | public function glf\_after\_save\_elementor( $post\_id, $editor\_data) |
  |  | 138 | { |
  |  | 139 | $orderingWidgets = []; |
  |  | 140 | $reservationWidgets = []; |
  |  | 141 | $menuWidgets = []; |
  |  | 142 | $promotionWidgets = []; |
  |  | 143 | $openingHoursWidgets = []; |
  |  | 144 |  |
  |  | 145 | $columns = array\_merge(...array\_column($editor\_data, 'elements')); |
  |  | 146 | $widgets = array\_merge(...array\_column($columns, 'elements')); |
  |  | 147 | if (!empty($widgets)) { |
  |  | 148 | foreach ($widgets as $widget) { |
  |  | 149 | $widgetType = $widget['widgetType']; |
  |  | 150 | switch ($widgetType) { |
  |  | 151 | case "glf\_elementor\_widget\_ordering": |
  |  | 152 | $orderingWidgets[] = $widget['id']; |
  |  | 153 | break; |
  |  | 154 | case "glf\_elementor\_widget\_reservations": |
  |  | 155 | $reservationWidgets[] = $widget['id']; |
  |  | 156 | break; |
  |  | 157 | case "glf\_elementor\_food\_menu": |
  |  | 158 | $menuWidgets[] = $widget['id']; |
  |  | 159 | break; |
  |  | 160 | case "glf\_elementor\_promotions": |
  |  | 161 | $promotionWidgets[] = $widget['id']; |
  |  | 162 | break; |
  |  | 163 | case "glf\_elementor\_opening\_hours": |
  |  | 164 | $openingHoursWidgets[] = $widget['id']; |
  |  | 165 | break; |
  |  | 166 | } |
  |  | 167 | } |
  |  | 168 |  |
  |  | 169 | $currentOrderingIds = Glf\_Utils::glf\_get\_from\_wordpress\_options('ordering\_widget\_ids', []); |
  |  | 170 | $currentReservationIds = Glf\_Utils::glf\_get\_from\_wordpress\_options('reservations\_widget\_ids', []); |
  |  | 171 | $currentMenuIds = Glf\_Utils::glf\_get\_from\_wordpress\_options('menu\_widget\_ids', []); |
  |  | 172 | $currentPromotionIds = Glf\_Utils::glf\_get\_from\_wordpress\_options('promotions\_widget\_ids', []); |
  |  | 173 | $currentOpeningHoursIds = Glf\_Utils::glf\_get\_from\_wordpress\_options('opening\_hours\_widget\_ids', []); |
  |  | 174 |  |
  |  | 175 | $deletedOrderingIds = array\_diff($currentOrderingIds, $orderingWidgets); |
  |  | 176 | $deletedReservationIds = array\_diff($currentReservationIds, $reservationWidgets); |
  |  | 177 | $deletedMenuIds = array\_diff($currentMenuIds, $menuWidgets); |
  |  | 178 | $deletedPromotionIds = array\_diff($currentPromotionIds, $promotionWidgets); |
  |  | 179 | $deletedOpeningHoursIds = array\_diff($currentOpeningHoursIds, $openingHoursWidgets); |
  |  | 180 |  |
  |  | 181 | //remove deleted widgets |
  |  | 182 | if (!empty($deletedOrderingIds)) { |
  |  | 183 | $currentOrderingIds = array\_diff($currentOrderingIds, $deletedOrderingIds); |
  |  | 184 | Glf\_Utils::glf\_add\_to\_wordpress\_options('ordering\_widget\_ids', $currentOrderingIds); |
  |  | 185 | } |
  |  | 186 | if (!empty($deletedReservationIds)) { |
  |  | 187 | $currentReservationIds = array\_diff($currentReservationIds, $deletedReservationIds); |
  |  | 188 | Glf\_Utils::glf\_add\_to\_wordpress\_options('reservations\_widget\_ids', $currentReservationIds); |
  |  | 189 | } |
  |  | 190 | if (!empty($deletedMenuIds)) { |
  |  | 191 | $currentMenuIds = array\_diff($currentMenuIds, $deletedMenuIds); |
  |  | 192 | Glf\_Utils::glf\_add\_to\_wordpress\_options('menu\_widget\_ids', $currentMenuIds); |
  |  | 193 | } |
  |  | 194 | if (!empty($deletedPromotionIds)) { |
  |  | 195 | $currentPromotionIds = array\_diff($currentPromotionIds, $deletedPromotionIds); |
  |  | 196 | Glf\_Utils::glf\_add\_to\_wordpress\_options('promotions\_widget\_ids', $currentPromotionIds); |
  |  | 197 | } |
  |  | 198 | if (!empty($deletedOpeningHoursIds)) { |
  |  | 199 | $currentOpeningHoursIds = array\_diff($currentOpeningHoursIds, $deletedOpeningHoursIds); |
  |  | 200 | Glf\_Utils::glf\_add\_to\_wordpress\_options('opening\_hours\_widget\_ids', $currentOpeningHoursIds); |
  |  | 201 | } |
  |  | 202 | } |
  |  | 203 | } |
  |  | 204 |  |
  | 126 | 205 | } |
  | 127 | 206 |  |
* ## [menu-ordering-reservations/trunk/includes/modules/elementor/widgets/base/class-glf-widget-button-base.php](/changeset/2793398/menu-ordering-reservations/trunk/includes/modules/elementor/widgets/base/class-glf-widget-button-base.php "Show the changeset 2793398 restricted to menu-ordering-reservations/trunk/includes/modules/elementor/widgets/base/class-glf-widget-button-base.php")

  | [r2720461](/browser/menu-ordering-reservations/trunk/includes/modules/elementor/widgets/base/class-glf-widget-button-base.php?rev=2720461#L24 "Show revision 2720461 of this file in browser") | [r2793398](/browser/menu-ordering-reservations/trunk/includes/modules/elementor/widgets/base/class-glf-widget-button-base.php?rev=2793398#L24 "Show revision 2793398 of this file in browser") |  |
  | --- | --- | --- |
  | 24 | 24 | class Glf\_Widget\_Button\_Base extends \Elementor\Widget\_Base { |
  | 25 | 25 |  |
  |  | 26 |  |
  | 26 | 27 | /\*\* |
  | 27 | 28 | \* Set widget name |
  | […](/browser/menu-ordering-reservations/trunk/includes/modules/elementor/widgets/base/class-glf-widget-button-base.php?rev=2720461#L427) | […](/browser/menu-ordering-reservations/trunk/includes/modules/elementor/widgets/base/class-glf-widget-button-base.php?rev=2793398#L428) |  |
  | 427 | 428 | public function render() { |
  | 428 | 429 | $settings = $this->get\_settings\_for\_display(); |
  |  | 430 | $widgetRawData = $this->get\_raw\_data(); |
  | 429 | 431 |  |
  | 430 | 432 | $this->add\_render\_attribute( 'wrapper', 'class', 'elementor-button-wrapper' ); |
  | 431 | 433 |  |
  | 432 | 434 | $this->add\_render\_attribute( 'button', 'class', 'elementor-button' ); |
  |  | 435 | $this->add\_render\_attribute('button', 'class', 'elementor-glf-button'); |
  | 433 | 436 | $this->add\_render\_attribute( 'button', 'role', 'button' ); |
  | 434 | 437 |  |
  | […](/browser/menu-ordering-reservations/trunk/includes/modules/elementor/widgets/base/class-glf-widget-button-base.php?rev=2720461#L449) | […](/browser/menu-ordering-reservations/trunk/includes/modules/elementor/widgets/base/class-glf-widget-button-base.php?rev=2793398#L452) |  |
  | 449 | 452 | } |
  | 450 | 453 |  |
  | 451 |  | if( $this->get\_name() === 'glf\_elementor\_widget\_reservations' ){ |
  | 452 |  | $this->add\_render\_attribute( 'custom', 'data-glf-reservation', "true" ); |
  | 453 |  | Glf\_Utils::glf\_add\_to\_wordpress\_options( 'button\_reservations', 'true' ); |
  |  | 454 | $sendTracking = false; |
  |  | 455 | if ($this->get\_name() === 'glf\_elementor\_widget\_reservations') { |
  |  | 456 | $this->add\_render\_attribute('custom', 'data-glf-reservation', "true"); |
  |  | 457 | Glf\_Utils::glf\_add\_to\_wordpress\_options('button\_reservations', 'true'); |
  | 454 | 458 | $data = array( |
  | 455 | 459 | 'type' => 'added', |
  | […](/browser/menu-ordering-reservations/trunk/includes/modules/elementor/widgets/base/class-glf-widget-button-base.php?rev=2720461#L457) | […](/browser/menu-ordering-reservations/trunk/includes/modules/elementor/widgets/base/class-glf-widget-button-base.php?rev=2793398#L461) |  |
  | 457 | 461 | 'editor' => 'elementor', |
  | 458 | 462 | 'version' => '2.0', |
  | 459 |  | 'ruid' => $settings[~~'glf\_ruid'~~ ] |
  |  | 463 | 'ruid' => $settings['glf\_ruid'] |
  | 460 | 464 | ); |
  | 461 | 465 | } else { |
  | 462 |  | Glf\_Utils::glf\_add\_to\_wordpress\_options( 'button\_ordering', 'true' ); |
  |  | 466 |  |
  |  | 467 | Glf\_Utils::glf\_add\_to\_wordpress\_options('button\_ordering', 'true'); |
  |  | 468 |  |
  | 463 | 469 | $data = array( |
  | 464 | 470 | 'type' => 'added', |
  | […](/browser/menu-ordering-reservations/trunk/includes/modules/elementor/widgets/base/class-glf-widget-button-base.php?rev=2720461#L466) | […](/browser/menu-ordering-reservations/trunk/includes/modules/elementor/widgets/base/class-glf-widget-button-base.php?rev=2793398#L472) |  |
  | 466 | 472 | 'editor' => 'elementor', |
  | 467 | 473 | 'version' => '2.0', |
  | 468 |  | 'ruid' => $settings[~~'glf\_ruid'~~ ] |
  |  | 474 | 'ruid' => $settings['glf\_ruid'] |
  | 469 | 475 | ); |
  | 470 |  | } |
  | 471 |  | $currentOption = Glf\_Utils::glf\_get\_from\_wordpress\_options( $data[ 'editor' ] . '\_' . $data['added'], 'false' ); |
  | 472 |  | if( $currentOption === 'false' ) { |
  | 473 |  | Glf\_Utils::glf\_tracking\_send( $data ); |
  | 474 |  | } |
  |  | 476 |  |
  |  | 477 | } |
  |  | 478 | $currentOrderingIds = Glf\_Utils::glf\_get\_from\_wordpress\_options('button\_' . $data['added'] . '\_ids', false); |
  |  | 479 | $widgetId = $widgetRawData['id']; |
  |  | 480 |  |
  |  | 481 | if ($currentOrderingIds !== false) { |
  |  | 482 | if (!in\_array($widgetId, $currentOrderingIds)) { |
  |  | 483 | array\_push($currentOrderingIds, $widgetId); |
  |  | 484 | Glf\_Utils::glf\_add\_to\_wordpress\_options('button\_' . $data['added'] . '\_ids', $currentOrderingIds); |
  |  | 485 | $sendTracking = true; |
  |  | 486 | } |
  |  | 487 | } else { |
  |  | 488 | Glf\_Utils::glf\_add\_to\_wordpress\_options('button\_' . $data['added'] . '\_ids', [$widgetRawData['id']]); |
  |  | 489 | $sendTracking = true; |
  |  | 490 | } |
  |  | 491 |  |
  |  | 492 | if ($sendTracking) { |
  |  | 493 | Glf\_Utils::glf\_tracking\_send($data); |
  |  | 494 | } |
  |  | 495 |  |
  |  | 496 | //$currentOption = Glf\_Utils::glf\_get\_from\_wordpress\_options( $data[ 'editor' ] . '\_' . $data['added'], 'false' ); |
  |  | 497 | //if( $currentOption === 'false' ) { |
  |  | 498 | //    Glf\_Utils::glf\_tracking\_send( $data ); |
  |  | 499 | //} |
  | 475 | 500 |  |
  | 476 | 501 | ?> |
  | […](/browser/menu-ordering-reservations/trunk/includes/modules/elementor/widgets/base/class-glf-widget-button-base.php?rev=2720461#L576) | […](/browser/menu-ordering-reservations/trunk/includes/modules/elementor/widgets/base/class-glf-widget-button-base.php?rev=2793398#L601) |  |
  | 576 | 601 | return Icons\_Manager::on\_import\_migration( $element, 'icon', 'selected\_icon' ); |
  | 577 | 602 | } |
  |  | 603 |  |
  |  | 604 |  |
  | 578 | 605 | } |
  | 579 | 606 | } |
* ## [menu-ordering-reservations/trunk/includes/modules/elementor/widgets/food-menu/class-glf-module-elementor-food-menu-widget.php](/changeset/2793398/menu-ordering-reservations/trunk/includes/modules/elementor/widgets/food-menu/class-glf-module-elementor-food-menu-widget.php "Show the changeset 2793398 restricted to menu-ordering-reservations/trunk/includes/modules/elementor/widgets/food-menu/class-glf-module-elementor-food-menu-widget.php")

  | [r2720461](/browser/menu-ordering-reservations/trunk/includes/modules/elementor/widgets/food-menu/class-glf-module-elementor-food-menu-widget.php?rev=2720461#L125 "Show revision 2720461 of this file in browser") | [r2793398](/browser/menu-ordering-reservations/trunk/includes/modules/elementor/widgets/food-menu/class-glf-module-elementor-food-menu-widget.php?rev=2793398#L125 "Show revision 2793398 of this file in browser") |  |
  | --- | --- | --- |
  | 125 | 125 | $atts[ 'class' ] = $settings[ 'glf\_class' ]; |
  | 126 | 126 | } |
  | 127 |  |  |
  | 128 |  | Glf\_Utils::glf\_prepare\_tracking\_data( 'menu', $atts, 'elementor', 'menu\_widget' ); |
  |  | 127 | $widgetRawData = $this->get\_raw\_data(); |
  |  | 128 | Glf\_Utils::glf\_prepare\_tracking\_data( 'menu', $atts, 'elementor', 'menu\_widget', $widgetRawData['id'] ); |
  | 129 | 129 | $atts[ 'elementor' ] = ''; |
  | 130 | 130 | echo Glf\_Module\_Shortcodes::add\_menu\_shortcode( $atts ); |
* ## [menu-ordering-reservations/trunk/includes/modules/elementor/widgets/opening-hours/class-glf-module-elementor-opening-hours-widget.php](/changeset/2793398/menu-ordering-reservations/trunk/includes/modules/elementor/widgets/opening-hours/class-glf-module-elementor-opening-hours-widget.php "Show the changeset 2793398 restricted to menu-ordering-reservations/trunk/includes/modules/elementor/widgets/opening-hours/class-glf-module-elementor-opening-hours-widget.php")

  | [r2720461](/browser/menu-ordering-reservations/trunk/includes/modules/elementor/widgets/opening-hours/class-glf-module-elementor-opening-hours-widget.php?rev=2720461#L125 "Show revision 2720461 of this file in browser") | [r2793398](/browser/menu-ordering-reservations/trunk/includes/modules/elementor/widgets/opening-hours/class-glf-module-elementor-opening-hours-widget.php?rev=2793398#L125 "Show revision 2793398 of this file in browser") |  |
  | --- | --- | --- |
  | 125 | 125 | $atts[ 'class' ] = $settings[ 'glf\_class' ]; |
  | 126 | 126 | } |
  | 127 |  |  |
  | 128 |  | Glf\_Utils::glf\_prepare\_tracking\_data( 'opening-hours', $atts, 'elementor', 'opening\_hours\_widget' ); |
  |  | 127 | $widgetRawData = $this->get\_raw\_data(); |
  |  | 128 | Glf\_Utils::glf\_prepare\_tracking\_data( 'opening-hours', $atts, 'elementor', 'opening\_hours\_widget', $widgetRawData['id'] ); |
  | 129 | 129 | $atts[ 'elementor' ] = ''; |
  | 130 | 130 | echo Glf\_Module\_Shortcodes::add\_opening\_hours( $atts ); |
* ## [menu-ordering-reservations/trunk/includes/modules/elementor/widgets/promotions/class-glf-module-elementor-promotions-widget.php](/changeset/2793398/menu-ordering-reservations/trunk/includes/modules/elementor/widgets/promotions/class-glf-module-elementor-promotions-widget.php "Show the changeset 2793398 restricted to menu-ordering-reservations/trunk/includes/modules/elementor/widgets/promotions/class-glf-module-elementor-promotions-widget.php")

  | [r2720461](/browser/menu-ordering-reservations/trunk/includes/modules/elementor/widgets/promotions/class-glf-module-elementor-promotions-widget.php?rev=2720461#L131 "Show revision 2720461 of this file in browser") | [r2793398](/browser/menu-ordering-reservations/trunk/includes/modules/elementor/widgets/promotions/class-glf-module-elementor-promotions-widget.php?rev=2793398#L131 "Show revision 2793398 of this file in browser") |  |
  | --- | --- | --- |
  | 131 | 131 | $atts[ 'class' ] = $settings[ 'glf\_class' ]; |
  | 132 | 132 | } |
  | 133 |  |  |
  | 134 |  | Glf\_Utils::glf\_prepare\_tracking\_data( 'promotions', $atts, 'elementor', 'promotions\_widget' ); |
  |  | 133 | $widgetRawData = $this->get\_raw\_data(); |
  |  | 134 | Glf\_Utils::glf\_prepare\_tracking\_data( 'promotions', $atts, 'elementor', 'promotions\_widget', $widgetRawData['id'] ); |
  | 135 | 135 | $atts[ 'elementor' ] = ''; |
  | 136 | 136 | echo Glf\_Module\_Shortcodes::add\_promotions( $atts ); |
* ## [menu-ordering-reservations/trunk/includes/modules/elementor/widgets/reservations/class-glf-module-elementor-reservations-widget.php](/changeset/2793398/menu-ordering-reservations/trunk/includes/modules/elementor/widgets/reservations/class-glf-module-elementor-reservations-widget.php "Show the changeset 2793398 restricted to menu-ordering-reservations/trunk/includes/modules/elementor/widgets/reservations/class-glf-module-elementor-reservations-widget.php")

  | [r2720461](/browser/menu-ordering-reservations/trunk/includes/modules/elementor/widgets/reservations/class-glf-module-elementor-reservations-widget.php?rev=2720461#L117 "Show revision 2720461 of this file in browser") | [r2793398](/browser/menu-ordering-reservations/trunk/includes/modules/elementor/widgets/reservations/class-glf-module-elementor-reservations-widget.php?rev=2793398#L117 "Show revision 2793398 of this file in browser") |  |
  | --- | --- | --- |
  | 117 | 117 | } |
  | 118 | 118 |  |
  | 119 |  | Glf\_Utils::glf\_prepare\_tracking\_data( 'reservations', $atts, 'elementor', 'button\_reservations' ); |
  |  | 119 | $widgetRawData = $this->get\_raw\_data(); |
  |  | 120 | Glf\_Utils::glf\_prepare\_tracking\_data( 'reservations', $atts, 'elementor', 'button\_reservations', $widgetRawData['id'] ); |
  | 120 | 121 | $atts[ 'elementor' ] = ''; |
  | 121 | 122 | echo Glf\_Module\_Shortcodes::add\_shortcode( 'reservations', $atts ); |
* ## [menu-ordering-reservations/trunk/includes/modules/shortcodes/class-glf-module-shortcodes.php](/changeset/2793398/menu-ordering-reservations/trunk/includes/modules/shortcodes/class-glf-module-shortcodes.php "Show the changeset 2793398 restricted to menu-ordering-reservations/trunk/includes/modules/shortcodes/class-glf-module-shortcodes.php")

  | [r2720461](/browser/menu-ordering-reservations/trunk/includes/modules/shortcodes/class-glf-module-shortcodes.php?rev=2720461#L129 "Show revision 2720461 of this file in browser") | [r2793398](/browser/menu-ordering-reservations/trunk/includes/modules/shortcodes/class-glf-module-shortcodes.php?rev=2793398#L129 "Show revision 2793398 of this file in browser") |  |
  | --- | --- | --- |
  | 129 | 129 | foreach ( $restaurant\_menu->categories as $cat\_index => $category ) { |
  | 130 | 130 | if ( ! empty( $category->items ) ) { |
  | 131 |  | $html .= '<div class="glf-mor-restaurant-menu-category"><h3>' . $category->name . '</h3>'; |
  | 132 |  |  |
  |  | 131 | $html .= '<div class="glf-mor-restaurant-menu-category"><h3>' . $category->name ; |
  |  | 132 | if ( ! empty( $category->description)) { |
  |  | 133 | $html .= '<div class="glf-mor-restaurant-menu-category-description">' . $category->description . '</div>'; |
  |  | 134 | } |
  |  | 135 | $html .= '</h3>'; |
  | 133 | 136 | foreach ( $category->items as $item\_index => $item ) { |
  | 134 | 137 | $price\_from\_text = ( is\_array( $item->sizes) && count( $item->sizes ) > 1 ); |
* ## [menu-ordering-reservations/trunk/includes/utils/class-glf-utils.php](/changeset/2793398/menu-ordering-reservations/trunk/includes/utils/class-glf-utils.php "Show the changeset 2793398 restricted to menu-ordering-reservations/trunk/includes/utils/class-glf-utils.php")

  | [r2720461](/browser/menu-ordering-reservations/trunk/includes/utils/class-glf-utils.php?rev=2720461#L515 "Show revision 2720461 of this file in browser") | [r2793398](/browser/menu-ordering-reservations/trunk/includes/utils/class-glf-utils.php?rev=2793398#L515 "Show revision 2793398 of this file in browser") |  |
  | --- | --- | --- |
  | 515 | 515 | } |
  | 516 | 516 |  |
  | 517 |  | public static function glf\_prepare\_tracking\_data( $added, $atts, $editor\_type, $option ){ |
  |  | 517 | public static function glf\_prepare\_tracking\_data( $added, $atts, $editor\_type, $option, $widgetId = false ){ |
  | 518 | 518 | $currentOption = self::glf\_get\_from\_wordpress\_options( $editor\_type . '\_' . $option, 'false' ); |
  | 519 | 519 | self::glf\_add\_to\_wordpress\_options( $editor\_type . '\_' . $option, 'true' ); |
  | 520 | 520 | self::glf\_add\_to\_wordpress\_options( $option, 'true' ); |
  | 521 | 521 |  |
  | 522 |  | if ( $currentOption === 'false' ) { |
  |  | 522 | $sendTracking = false; |
  |  | 523 | $currentWidgetIds = Glf\_Utils::glf\_get\_from\_wordpress\_options( $added . '\_widget\_ids', false); |
  |  | 524 | if ($currentWidgetIds !== false) { |
  |  | 525 | if (!in\_array($widgetId, $currentWidgetIds)) { |
  |  | 526 | array\_push($currentWidgetIds, $widgetId); |
  |  | 527 | Glf\_Utils::glf\_add\_to\_wordpress\_options($added . '\_widget\_ids', $currentWidgetIds); |
  |  | 528 | $sendTracking = true; |
  |  | 529 | } |
  |  | 530 | } else { |
  |  | 531 | Glf\_Utils::glf\_add\_to\_wordpress\_options($added . '\_widget\_ids', [$widgetId]); |
  |  | 532 | $sendTracking = true; |
  |  | 533 | } |
  |  | 534 | if ( $sendTracking ) { |
  | 523 | 535 | $data = array( |
  | 524 | 536 | 'type' => 'added', |
  | […](/browser/menu-ordering-reservations/trunk/includes/utils/class-glf-utils.php?rev=2720461#L589) | […](/browser/menu-ordering-reservations/trunk/includes/utils/class-glf-utils.php?rev=2793398#L601) |  |
  | 589 | 601 | $response = ''; |
  | 590 | 602 | if ( !empty( $args[ 'event' ] ) && ( $consent || isset($data['consent']) ) ) { |
  |  | 603 | $args['data']['restaurant\_version'] = Glf\_Utils::$\_GLF->version; |
  | 591 | 604 | $response = self::$\_GLF->glf\_mor\_api\_call( "tracking", 'POST', $args ); |
  | 592 | 605 | } |
  | […](/browser/menu-ordering-reservations/trunk/includes/utils/class-glf-utils.php?rev=2720461#L601) | […](/browser/menu-ordering-reservations/trunk/includes/utils/class-glf-utils.php?rev=2793398#L614) |  |
  | 601 | 614 | } |
  | 602 | 615 |  |
  |  | 616 | public function glf\_capabilities\_check() { |
  |  | 617 | return (!(!empty( $\_POST[ 'action' ] ) && current\_user\_can( 'manage\_options' ))); |
  |  | 618 | } |
  |  | 619 |  |
  |  | 620 | public function glf\_capabilities\_get\_check() { |
  |  | 621 | return (!(!empty( $\_GET[ 'action' ] ) && current\_user\_can( 'manage\_options' ))); |
  |  | 622 | } |
  |  | 623 |  |
  |  | 624 | public function glf\_capabilities\_check\_failed( $response ) { |
  |  | 625 | $response[ 'status' ] = 'error'; |
  |  | 626 | $response[ 'msg' ] = 'Access restricted, security check failed!'; |
  |  | 627 | echo json\_encode( $response ); |
  |  | 628 | exit(); |
  |  | 629 | } |
  |  | 630 |  |
  | 603 | 631 | } |
  | 604 | 632 | } |
* ## [menu-ordering-reservations/trunk/readme.txt](/changeset/2793398/menu-ordering-reservations/trunk/readme.txt "Show the changeset 2793398 restricted to menu-ordering-reservations/trunk/readme.txt")

  | [r2720461](/browser/menu-ordering-reservations/trunk/readme.txt?rev=2720461#L280 "Show revision 2720461 of this file in browser") | [r2793398](/browser/menu-ordering-reservations/trunk/readme.txt?rev=2793398#L280 "Show revision 2793398 of this file in browser") |  |
  | --- | --- | --- |
  | 280 | 280 | \* New Feature - Classic editor shortcode Promotions |
  | 281 | 281 | \* New Feature - Update Food Menu and Opening Hours right from the widget |
  |  | 282 |  |
  |  | 283 | = 2.3.1 = |
  |  | 284 | \* Tested up to: 5.8.4 to 6.0 |
  |  | 285 | \* Bug fixes and security improvements |
* ## [menu-ordering-reservations/trunk/restaurant-system.php](/changeset/2793398/menu-ordering-reservations/trunk/restaurant-system.php "Show the changeset 2793398 restricted to menu-ordering-reservations/trunk/restaurant-system.php")

  | [r2720461](/browser/menu-ordering-reservations/trunk/restaurant-system.php?rev=2720461#L5 "Show revision 2720461 of this file in browser") | [r2793398](/browser/menu-ordering-reservations/trunk/restaurant-system.php?rev=2793398#L5 "Show revision 2793398 of this file in browser") |  |
  | --- | --- | --- |
  | 5 | 5 | Description: This plugin is all you need to turn your restaurant website into an online business. Using a simple and friendly interface you get a restaurant menu, online food ordering and restaurant booking system. All free, no fees, no hidden costs, no commissions - for unlimited food orders and restaurant reservations. |
  | 6 | 6 |  |
  | 7 |  | Version: 2.3.~~0~~ |
  |  | 7 | Version: 2.3.1 |
  | 8 | 8 | Author: GloriaFood |
  | 9 | 9 | Author URI: https://www.gloriafood.com/ |
  | […](/browser/menu-ordering-reservations/trunk/restaurant-system.php?rev=2720461#L92) | […](/browser/menu-ordering-reservations/trunk/restaurant-system.php?rev=2793398#L92) |  |
  | 92 | 92 | $glf\_wordpress\_options                   = Glf\_Utils::glf\_wp\_options\_data(); |
  | 93 | 93 |  |
  |  | 94 | $action = isset( $\_GET[ 'action' ] ) ? $\_GET[ 'action' ] : ''; |
  |  | 95 | $response = array( 'action' => $action ); |
  |  | 96 | if ( Glf\_Utils::glf\_capabilities\_check() ) { |
  |  | 97 | Glf\_Utils::glf\_capabilities\_check\_failed( $response ); |
  |  | 98 | } |
  | 94 | 99 | $glf\_wordpress\_options->{'app\_options'}[ Glf\_Utils::$\_GLF->user->id ]['default\_location'] = $location; |
  | 95 | 100 | Glf\_Utils::glf\_database\_option\_operation( 'update', 'glf\_wordpress\_options', $glf\_wordpress\_options ); |
  | […](/browser/menu-ordering-reservations/trunk/restaurant-system.php?rev=2720461#L235) | […](/browser/menu-ordering-reservations/trunk/restaurant-system.php?rev=2793398#L240) |  |
  | 235 | 240 |  |
  | 236 | 241 | public function customize\_button\_dialog() { |
  |  | 242 | $action = isset( $\_GET[ 'action' ] ) ? $\_GET[ 'action' ] : ''; |
  |  | 243 | $response = array( 'action' => $action ); |
  |  | 244 |  |
  |  | 245 | if ( Glf\_Utils::glf\_capabilities\_get\_check() ) { |
  |  | 246 | Glf\_Utils::glf\_capabilities\_check\_failed( $response ); |
  |  | 247 | } |
  |  | 248 |  |
  | 237 | 249 | Glf\_Utils::glf\_include( GLF\_PLUGIN\_DIR . 'includes/admin/settings/customize-button.php' ); |
  | 238 | 250 | } |

**Note:** See [TracChangeset](/wiki/TracChangeset)
for help on using the changeset viewer.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Unified Diff](?format=diff&new=2793398)
* [Zip Archive](?format=zip&new=2793398)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)


