
[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fpgadmin-org%2Fpgadmin4%2Fissues%2F7258)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fpgadmin-org%2Fpgadmin4%2Fissues%2F7258)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=pgadmin-org%2Fpgadmin4)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[pgadmin-org](/pgadmin-org)
/
**[pgadmin4](/pgadmin-org/pgadmin4)**
Public

* [Notifications](/login?return_to=%2Fpgadmin-org%2Fpgadmin4) You must be signed in to change notification settings
* [Fork
  679](/login?return_to=%2Fpgadmin-org%2Fpgadmin4)
* [Star
   2.7k](/login?return_to=%2Fpgadmin-org%2Fpgadmin4)

* [Code](/pgadmin-org/pgadmin4)
* [Issues
  360](/pgadmin-org/pgadmin4/issues)
* [Pull requests
  7](/pgadmin-org/pgadmin4/pulls)
* [Actions](/pgadmin-org/pgadmin4/actions)
* [Projects
  6](/pgadmin-org/pgadmin4/projects)
* [Security](/pgadmin-org/pgadmin4/security)
* [Insights](/pgadmin-org/pgadmin4/pulse)

Additional navigation options

* [Code](/pgadmin-org/pgadmin4)
* [Issues](/pgadmin-org/pgadmin4/issues)
* [Pull requests](/pgadmin-org/pgadmin4/pulls)
* [Actions](/pgadmin-org/pgadmin4/actions)
* [Projects](/pgadmin-org/pgadmin4/projects)
* [Security](/pgadmin-org/pgadmin4/security)
* [Insights](/pgadmin-org/pgadmin4/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fpgadmin-org%2Fpgadmin4%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fpgadmin-org%2Fpgadmin4%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Unsafe Deserialization and Remote Code Execution by an Authenticated user in pgAdmin 4 (CVE-2024-2044) #7258

Closed

[adityatoshniwal](/adityatoshniwal) opened this issue
Mar 4, 2024
· 2 comments

Closed

# [Unsafe Deserialization and Remote Code Execution by an Authenticated user in pgAdmin 4 (CVE-2024-2044)](#top) #7258

[adityatoshniwal](/adityatoshniwal) opened this issue
Mar 4, 2024
· 2 comments

Labels
[Bug](/pgadmin-org/pgadmin4/labels/Bug)
[EDB Sprint 163](/pgadmin-org/pgadmin4/labels/EDB%20Sprint%20163)

Milestone
[8.4](/pgadmin-org/pgadmin4/milestone/172 "8.4")

## Comments

[![@adityatoshniwal](https://avatars.githubusercontent.com/u/31855755?s=80&u=01c452aaee8373e053590ec7966c0f731fd20913&v=4)](/adityatoshniwal)

Copy link

Contributor

### **[adityatoshniwal](/adityatoshniwal)** commented [Mar 4, 2024](#issue-2166113313) • edited Loading

| **Reported by: Davide TheZero thezero@shielder.it** along with attachment [path\_traversal\_leads\_to\_unsafe\_deserialization.md](https://github.com/pgadmin-org/pgadmin4/files/14553680/path_traversal_leads_to_unsafe_deserialization.md) for reproducing.  **Summary:** pgAdmin 4 uses a file-based session management approach. The session files are saved on disk as pickle objects. When a user performs a request, the value of the session cookie 'pga4\_session' is used to retrieve the file, then its content is deserialised, and finally its signature verified. The cookie value is split in 2 parts at the first '!' character. The first part is the session ID (sid), while the second is the session digest. The vulnerability lies in versions of pgAdmin prior to 8.4 where a method loads session files by concatenating the sessions folder - located inside the pgAdmin 4 DATA\_DIR - with the session ID. Precisely, the two values are concatenated using the ['os.path.join'] function. It does not set a trusted base-path which should not be escaped  This issue does not affect users running pgAdmin in desktop mode. |
| --- |
| The text was updated successfully, but these errors were encountered: |

All reactions

[![@adityatoshniwal](https://avatars.githubusercontent.com/u/31855755?s=40&u=01c452aaee8373e053590ec7966c0f731fd20913&v=4)](/adityatoshniwal)
[adityatoshniwal](/adityatoshniwal)
added
the
[Bug](/pgadmin-org/pgadmin4/labels/Bug)
label
[Mar 4, 2024](#event-11994324455)

[![@akshay-joshi](https://avatars.githubusercontent.com/u/1632882?s=40&u=4fb96aad7234f4e30980947c7c1a186e96b7f6cb&v=4)](/akshay-joshi)
[akshay-joshi](/akshay-joshi)
added this to the [8.4](/pgadmin-org/pgadmin4/milestone/172) milestone
[Mar 4, 2024](#event-11994533264)

[![@akshay-joshi](https://avatars.githubusercontent.com/u/1632882?s=40&u=4fb96aad7234f4e30980947c7c1a186e96b7f6cb&v=4)](/akshay-joshi)
[akshay-joshi](/akshay-joshi)
added
the
[EDB Sprint 163](/pgadmin-org/pgadmin4/labels/EDB%20Sprint%20163)
label
[Mar 4, 2024](#event-11994534644)

[![@akshay-joshi](https://avatars.githubusercontent.com/u/1632882?s=40&u=4fb96aad7234f4e30980947c7c1a186e96b7f6cb&v=4)](/akshay-joshi)
[akshay-joshi](/akshay-joshi)
added this to [Not Refined](/orgs/pgadmin-org/projects/5)
[Mar 5, 2024](#event-14874066587)

[![@akshay-joshi](https://avatars.githubusercontent.com/u/1632882?s=40&u=4fb96aad7234f4e30980947c7c1a186e96b7f6cb&v=4)](/akshay-joshi)
[akshay-joshi](/akshay-joshi)
removed this from [Not Refined](/orgs/pgadmin-org/projects/5)
[Mar 7, 2024](#event-14867899470)

[![@akshay-joshi](https://avatars.githubusercontent.com/u/1632882?s=40&u=4fb96aad7234f4e30980947c7c1a186e96b7f6cb&v=4)](/akshay-joshi)
[akshay-joshi](/akshay-joshi)
added this to [Current Sprint (184)](/orgs/pgadmin-org/projects/1)
[Mar 7, 2024](#event-14896396211)

[![@akshay-joshi](https://avatars.githubusercontent.com/u/1632882?s=40&u=4fb96aad7234f4e30980947c7c1a186e96b7f6cb&v=4)](/akshay-joshi)
[akshay-joshi](/akshay-joshi)
moved this to **✅ Done**
in [Current Sprint (184)](/orgs/pgadmin-org/projects/1)
[Mar 7, 2024](#event-15090232121)

[![@adityatoshniwal](https://avatars.githubusercontent.com/u/31855755?s=40&u=01c452aaee8373e053590ec7966c0f731fd20913&v=4)](/adityatoshniwal)
[adityatoshniwal](/adityatoshniwal)
changed the title
~~Code improvement in file based session~~
Unsafe Deserialization and Remote Code Execution by an Authenticated user in pgAdmin 4 (CVE-2024-2044)
[Mar 7, 2024](#event-12040236095)

[![@akshay-joshi](https://avatars.githubusercontent.com/u/1632882?s=40&u=4fb96aad7234f4e30980947c7c1a186e96b7f6cb&v=4)](/akshay-joshi)
[akshay-joshi](/akshay-joshi)
closed this as [completed](/pgadmin-org/pgadmin4/issues?q=is%3Aissue+is%3Aclosed+archived%3Afalse+reason%3Acompleted)
[Mar 8, 2024](#event-12051523739)

[![@shelbyc](https://avatars.githubusercontent.com/u/5782553?s=40&v=4)](/shelbyc)
[shelbyc](/shelbyc)
mentioned this issue
[Mar 11, 2024](#ref-pullrequest-2177367448)

[[GHSA-rj98-crf4-g69w] pgAdmin 4 vulnerable to Unsafe Deserialization and Remote Code Execution by an Authenticated user
github/advisory-database#3950](/github/advisory-database/pull/3950)
 Merged

[![@foyaga](https://avatars.githubusercontent.com/u/62537001?s=40&v=4)](/foyaga)
[foyaga](/foyaga)
mentioned this issue
[Mar 13, 2024](#ref-issue-2183201978)

[pgAdmin4 反序列化代码执行漏洞（CVE-2024-2044）
foyaga/blog-timeline#144](/foyaga/blog-timeline/issues/144)

Open

[![@akshay-joshi](https://avatars.githubusercontent.com/u/1632882?s=40&u=4fb96aad7234f4e30980947c7c1a186e96b7f6cb&v=4)](/akshay-joshi)
[akshay-joshi](/akshay-joshi)
removed this from [Current Sprint (184)](/orgs/pgadmin-org/projects/1)
[Mar 13, 2024](#event-14865707063)

[LeSuisse](/LeSuisse)
added a commit
to LeSuisse/nixpkgs
that referenced
this issue
[Mar 17, 2024](#ref-commit-66f2aff)
[![@LeSuisse](https://avatars.githubusercontent.com/u/737767?s=40&v=4)](/LeSuisse)

`[pgadmin4: apply patch for](/LeSuisse/nixpkgs/commit/66f2affcc684bf0a654dad6cbe61385b07ca6876 "pgadmin4: apply patch for CVE-2024-2044

https://github.com/pgadmin-org/pgadmin4/issues/7258") [CVE-2024-2044](https://github.com/advisories/GHSA-rj98-crf4-g69w "CVE-2024-2044")`
…

`[66f2aff](/LeSuisse/nixpkgs/commit/66f2affcc684bf0a654dad6cbe61385b07ca6876)`

```
[pgadmin-org/pgadmin4#7258](https://github.com/pgadmin-org/pgadmin4/issues/7258)
```

[![@LeSuisse](https://avatars.githubusercontent.com/u/737767?s=40&v=4)](/LeSuisse)
[LeSuisse](/LeSuisse)
mentioned this issue
[Mar 17, 2024](#ref-pullrequest-2190634194)

[[23.11] pgadmin4: apply patch for CVE-2024-2044
NixOS/nixpkgs#296624](/NixOS/nixpkgs/pull/296624)
 Merged

13 tasks

[![@kperuma3](https://avatars.githubusercontent.com/u/167552573?s=80&v=4)](/kperuma3)

Copy link

### **[kperuma3](/kperuma3)** commented [Apr 19, 2024](#issuecomment-2067058951)

| I’m using pgadmin4 v 7.3 and installed locally on my laptop to connect GCP (Google cloud platform) instances. Will this [CVE-2024-2044](https://github.com/advisories/GHSA-rj98-crf4-g69w "CVE-2024-2044") - pgAdmin (<=8.3) Path Traversal in Session Handling Leads to Unsafe Deserialization and Remote Code Execution (RCE) impact me? |
| --- |

All reactions

Sorry, something went wrong.

[![@adityatoshniwal](https://avatars.githubusercontent.com/u/31855755?s=80&u=01c452aaee8373e053590ec7966c0f731fd20913&v=4)](/adityatoshniwal)

Copy link

Contributor

Author

### **[adityatoshniwal](/adityatoshniwal)** commented [Apr 22, 2024](#issuecomment-2068477295)

| I’m using pgadmin4 v 7.3 and installed locally on my laptop to connect GCP (Google cloud platform) instances. Will this [CVE-2024-2044](https://github.com/advisories/GHSA-rj98-crf4-g69w) - pgAdmin (<=8.3) Path Traversal in Session Handling Leads to Unsafe Deserialization and Remote Code Execution (RCE) impact me?  It is mentioned in the issue description - `This issue does not affect users running pgAdmin in desktop mode.` |
| --- |

All reactions

Sorry, something went wrong.

[zeme-wana](/zeme-wana)
pushed a commit
to input-output-hk/nixpkgs
that referenced
this issue
[May 8, 2024](#ref-commit-7830fb0)
[![@LeSuisse](https://avatars.githubusercontent.com/u/737767?s=40&v=4)](/LeSuisse) [![@zeme-wana](https://avatars.githubusercontent.com/u/15709674?s=40&v=4)](/zeme-wana)

`[pgadmin4: apply patch for](/input-output-hk/nixpkgs/commit/7830fb006a61942d735add8e876181091b041491 "pgadmin4: apply patch for CVE-2024-2044

https://github.com/pgadmin-org/pgadmin4/issues/7258") [CVE-2024-2044](https://github.com/advisories/GHSA-rj98-crf4-g69w "CVE-2024-2044")`
…

`[7830fb0](/input-output-hk/nixpkgs/commit/7830fb006a61942d735add8e876181091b041491)`

```
[pgadmin-org/pgadmin4#7258](https://github.com/pgadmin-org/pgadmin4/issues/7258)
```

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fpgadmin-org%2Fpgadmin4%2Fissues%2F7258)

Assignees

No one assigned

Labels

[Bug](/pgadmin-org/pgadmin4/labels/Bug)
[EDB Sprint 163](/pgadmin-org/pgadmin4/labels/EDB%20Sprint%20163)

Projects

None yet

Milestone

 [**8.4**](/pgadmin-org/pgadmin4/milestone/172 "8.4")

Development

No branches or pull requests

3 participants

[![@akshay-joshi](https://avatars.githubusercontent.com/u/1632882?s=52&v=4)](/akshay-joshi) [![@adityatoshniwal](https://avatars.githubusercontent.com/u/31855755?s=52&v=4)](/adityatoshniwal) [![@kperuma3](https://avatars.githubusercontent.com/u/167552573?s=52&v=4)](/kperuma3)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.

