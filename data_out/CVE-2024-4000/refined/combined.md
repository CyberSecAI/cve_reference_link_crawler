=== Content from plugins.trac.wordpress.org_9c5caded_20250111_012807.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fchangeset%3Fnew%3D3078437%2540pearl-header-builder%26old%3D3078437%2540pearl-header-builder)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Change](/changeset/2953612/pearl-header-builder "Changeset 2953612 for pearl-header-builder")
* [Next Change](/changeset/3078438/pearl-header-builder "Changeset 3078438 for pearl-header-builder") →

---

# Changeset [3078437](/changeset/3078437 "Show full changeset") for [pearl-header-builder](/browser/pearl-header-builder?rev=3078437 "Show entry in browser")

View differences
inline
side by side

Show
lines around each change

Show the changes in full context

Ignore:

Blank lines

Case changes

White space changes

Timestamp:
04/29/2024 06:56:16 AM
([9 months](/timeline?from=2024-04-29T06%3A56%3A16Z&precision=second "See timeline at 04/29/2024 06:56:16 AM") ago)

Author:
stylemix
Message:

prepare release 1.3.7

Location:
[pearl-header-builder/trunk](/browser/pearl-header-builder/trunk?rev=3078437)
Files:

2 added
3 edited

* [.babelrc](/browser/pearl-header-builder/trunk/.babelrc?rev=3078437 "Show entry in browser")
  (added)
* [Installation.md](/browser/pearl-header-builder/trunk/Installation.md?rev=3078437 "Show entry in browser")
  (added)
* [frontend/includes.php](/browser/pearl-header-builder/trunk/frontend/includes.php?rev=3078437 "Show entry in browser")
  (modified)
  ([1 diff](#file2 "Show differences"))
* [pearl\_header\_builder.php](/browser/pearl-header-builder/trunk/pearl_header_builder.php?rev=3078437 "Show entry in browser")
  (modified)
  ([2 diffs](#file3 "Show differences"))
* [readme.txt](/browser/pearl-header-builder/trunk/readme.txt?rev=3078437 "Show entry in browser")
  (modified)
  ([2 diffs](#file4 "Show differences"))

### Legend:

Unmodified
Added
Removed

* ## [pearl-header-builder/trunk/frontend/includes.php](/changeset/3078437/pearl-header-builder/trunk/frontend/includes.php "Show the changeset 3078437 restricted to pearl-header-builder/trunk/frontend/includes.php")

  | [r2462116](/browser/pearl-header-builder/trunk/frontend/includes.php?rev=2462116#L1 "Show revision 2462116 of this file in browser") | [r3078437](/browser/pearl-header-builder/trunk/frontend/includes.php?rev=3078437#L1 "Show revision 3078437 of this file in browser") |  |
  | --- | --- | --- |
  | 1 | 1 | <?php |
  | 2 |  | add\_action('stm\_hb', array('pearl\_header\_builder', 'build')); |
  | 3 |  | add\_shortcode('stm\_hb', array('pearl\_header\_builder', 'build\_from\_shortcode')); |
  | 4 |  |  |
  | 5 |  |  |
  | 6 |  | if (!class\_exists('pearl\_header\_builder')) { |
  | 7 |  | Class Pearl\_Header\_Builder |
  | 8 |  | { |
  | 9 |  |  |
  | 10 |  | public $headerName = 'stm\_hb\_settings'; |
  | 11 |  |  |
  | 12 |  | public static function build($headerName) |
  | 13 |  | { |
  | 14 |  | $headerName = (empty($headerName)) ? 'stm\_hb\_settings' : $headerName; |
  | 15 |  | return new self($headerName); |
  | 16 |  | } |
  | 17 |  |  |
  | 18 |  | public static function build\_from\_shortcode($args, $content = "") |
  | 19 |  | { |
  | 20 |  | new Pearl\_Header\_Builder($args); |
  | 21 |  | ob\_start(); |
  | 22 |  | require\_once(STM\_HB\_DIR . 'hb\_templates/main.php'); |
  | 23 |  | $content = ob\_get\_clean(); |
  | 24 |  | return apply\_filters('stm\_hb\_build\_from\_shortcode', $content); |
  | 25 |  | } |
  | 26 |  |  |
  | 27 |  | private function \_\_construct($args) |
  | 28 |  | { |
  | 29 |  | $this->headerName = (!empty($args['header'])) ? $args['header'] : 'stm\_hb\_settings'; |
  | 30 |  | $this->inline\_scripts(); |
  | 31 |  | require\_once(STM\_HB\_DIR . 'hb\_templates/main.php'); |
  | 32 |  | } |
  | 33 |  |  |
  | 34 |  | function header\_element\_custom\_styles() |
  | 35 |  | { |
  | 36 |  | $custom\_css = ''; |
  | 37 |  | $data = apply\_filters('pearl\_builder\_elements', stm\_hb\_get\_option('header\_builder', false, $this->headerName)); |
  | 38 |  | if (empty($data)) return null; |
  | 39 |  |  |
  | 40 |  | foreach ($data as $row => $columns) { |
  | 41 |  | foreach ($columns as $column => $elements) { |
  | 42 |  | foreach ($elements as $data) { |
  | 43 |  | $element = sanitize\_title($data['$$hashKey']); |
  | 44 |  | if (!empty($element)) { |
  | 45 |  |  |
  | 46 |  | $element = ".stm-header\_\_element.{$element}"; |
  | 47 |  | $media = array( |
  | 48 |  | 'default' => '(min-width:1023px)', |
  | 49 |  | 'tablet'  => '(max-width:1023px) and (min-width:425px)', |
  | 50 |  | 'mobile'  => '(max-width:425px)' |
  | 51 |  | ); |
  | 52 |  |  |
  | 53 |  |  |
  | 54 |  | /\*Generate margins\*/ |
  | 55 |  | if (!empty($data['margins'])) { |
  | 56 |  | foreach ($data['margins'] as $display => $margins) { |
  | 57 |  | if (!empty($margins)) { |
  | 58 |  | $custom\_css .= "@media {$media[$display]}{{$element}{"; |
  | 59 |  | foreach ($margins as $prop => $value) { |
  | 60 |  | if (isset($prop) && isset($value)) { |
  | 61 |  | $custom\_css .= "margin-{$prop}:{$value}px !important;"; |
  | 62 |  | } |
  | 63 |  | } |
  | 64 |  | $custom\_css .= "}}"; |
  | 65 |  | } |
  | 66 |  | } |
  | 67 |  | } |
  | 68 |  | /\*Generate text color\*/ |
  | 69 |  | if (array\_has($data, 'data.textColor.name') && $data['data']['textColor']['name'] === 'Custom') { |
  | 70 |  | $custom\_css .= $element . "{color: " . $data['data']['textColor']['value'] . "}"; |
  | 71 |  | } |
  | 72 |  |  |
  | 73 |  | /\*Generate icon color\*/ |
  | 74 |  | if (array\_has($data, 'data.iconColor.name') && $data['data']['iconColor']['name'] === 'Custom') { |
  | 75 |  | $custom\_css .= $element . " [class\*='\_icon'] {color: " . $data['data']['iconColor']['value'] . "}"; |
  | 76 |  | } |
  | 77 |  |  |
  | 78 |  |  |
  | 79 |  | /\*Menu item hover line\*/ |
  | 80 |  | if (array\_has($data, 'data.lineColor') && !empty($data['data']['lineColor']) && |
  | 81 |  | array\_has($data, 'data.line') && !empty($data['data']['line']) |
  | 82 |  | ) { |
  | 83 |  | $custom\_css .= $element . " li:before {background-color: {$data['data']['lineColor']} !important;}"; |
  | 84 |  | } |
  | 85 |  |  |
  | 86 |  | /\*Menu item a color\*/ |
  | 87 |  | if (array\_has($data, 'data.menuLinkColor') && !empty($data['data']['menuLinkColor'])) { |
  | 88 |  | $custom\_css .= $element . " li a {color: {$data['data']['menuLinkColor']} !important;}"; |
  | 89 |  | } |
  | 90 |  | /\*Menu item a color on hover\*/ |
  | 91 |  | if (array\_has($data, 'data.menuLinkColorOnHover') && !empty($data['data']['menuLinkColorOnHover'])) { |
  | 92 |  | $custom\_css .= $element . " li a:hover {color: {$data['data']['menuLinkColorOnHover']} !important;}"; |
  | 93 |  | $custom\_css .= $element . " li:hover > a {color: {$data['data']['menuLinkColorOnHover']} !important;}"; |
  | 94 |  | } |
  | 95 |  |  |
  | 96 |  | if (!empty($data['order'])) { |
  | 97 |  | foreach ($media as $device => $breakpoint) { |
  | 98 |  | if (!empty($data['order'][$device])) { |
  | 99 |  | $custom\_css .= "@media {$breakpoint} {"; |
  | 100 |  | $custom\_css .= $element . "{order: -{$data['order'][$device]}}"; |
  | 101 |  | $custom\_css .= "}"; |
  | 102 |  | } |
  | 103 |  | } |
  | 104 |  | $custom\_css .= $element . "{}"; |
  | 105 |  | } |
  | 106 |  |  |
  | 107 |  | $disabled\_devices = (!empty($data['disabled'])) ? array\_keys(array\_filter($data['disabled'])) : array(); |
  | 108 |  | if (!empty($disabled\_devices)) { |
  | 109 |  | foreach ($media as $device => $breakpoint) { |
  | 110 |  | if (in\_array($device, $disabled\_devices)) { |
  | 111 |  | $custom\_css .= "@media {$breakpoint} {"; |
  | 112 |  | $custom\_css .= $element . "{display: none!important};"; |
  | 113 |  | $custom\_css .= "}"; |
  | 114 |  | } |
  | 115 |  | } |
  | 116 |  | } |
  | 117 |  | } |
  | 118 |  | } |
  | 119 |  | } |
  | 120 |  | } |
  | 121 |  |  |
  | 122 |  | return $custom\_css; |
  | 123 |  | } |
  | 124 |  |  |
  | 125 |  | function header\_elements\_styles() |
  | 126 |  | { |
  | 127 |  | $custom\_css = ''; |
  | 128 |  | $top\_bar\_bg = stm\_hb\_get\_image\_url(stm\_hb\_get\_option('top\_bar\_bg', false, $this->headerName)); |
  | 129 |  | $header\_bg = stm\_hb\_get\_image\_url(stm\_hb\_get\_option('header\_bg', false, $this->headerName)); |
  | 130 |  | $bottom\_bar\_bg = stm\_hb\_get\_image\_url(stm\_hb\_get\_option('bottom\_bar\_bg', false, $this->headerName)); |
  | 131 |  | $all\_bg = stm\_hb\_get\_image\_url(stm\_hb\_get\_option('all\_bg', false, $this->headerName)); |
  | 132 |  | $all\_bg\_color = stm\_hb\_get\_option('all\_bg\_color', false, $this->headerName); |
  | 133 |  |  |
  | 134 |  | $top\_bar\_width = stm\_hb\_get\_option('top\_bar\_width', false, $this->headerName); |
  | 135 |  | $header\_width = stm\_hb\_get\_option('header\_width', false, $this->headerName); |
  | 136 |  | $bottom\_bar\_width = stm\_hb\_get\_option('bottom\_bar\_width', false, $this->headerName); |
  | 137 |  |  |
  | 138 |  | $styles = array( |
  | 139 |  | '.stm-header'                          => array( |
  | 140 |  | 'background-image' => esc\_url($all\_bg), |
  | 141 |  | ), |
  | 142 |  | '.stm-header:before'                   => array( |
  | 143 |  | 'background-color' => stm\_hb\_get\_option('all\_bg\_color', false, $this->headerName), |
  | 144 |  | ), |
  | 145 |  | '.stm-header\_\_row\_color\_top'           => array( |
  | 146 |  | 'padding-top'                          => stm\_hb\_get\_option('top\_bar\_top', false, $this->headerName), |
  | 147 |  | 'padding-bottom'                       => stm\_hb\_get\_option('top\_bar\_bottom', false, $this->headerName), |
  | 148 |  | 'margin-top'                          => stm\_hb\_get\_option('top\_bar\_top\_margin', false, $this->headerName), |
  | 149 |  | 'margin-bottom'                       => stm\_hb\_get\_option('top\_bar\_bottom\_margin', false, $this->headerName), |
  | 150 |  | 'background-image'                     => esc\_url($top\_bar\_bg), |
  | 151 |  | 'color'                                => stm\_hb\_get\_option('top\_bar\_text\_color', false, $this->headerName), |
  | 152 |  | 'z-index'                                => stm\_hb\_get\_option('top\_bar\_zindex', false, $this->headerName), |
  | 153 |  | '.stm-icontext\_\_text'                  => array( |
  | 154 |  | 'color' => stm\_hb\_get\_option('top\_bar\_text\_color', false, $this->headerName) |
  | 155 |  | ), |
  | 156 |  | 'a'                                    => array( |
  | 157 |  | 'color' => stm\_hb\_get\_option('top\_bar\_text\_color', false, $this->headerName) |
  | 158 |  | ), |
  | 159 |  | '.dropdown-toggle'                     => array( |
  | 160 |  | 'color' => stm\_hb\_get\_option('top\_bar\_text\_color', false, $this->headerName) . '!important' |
  | 161 |  | ), |
  | 162 |  | 'a:hover, .stm-navigation\_\_default > ul > li > a:hover'                              => array( |
  | 163 |  | 'color' => stm\_hb\_get\_option('top\_bar\_link\_color\_hover', false, $this->headerName) . '!important' |
  | 164 |  | ), |
  | 165 |  | 'li:hover a'                           => array( |
  | 166 |  | 'color' => stm\_hb\_get\_option('top\_bar\_link\_color\_hover', false, $this->headerName) |
  | 167 |  | ), |
  | 168 |  | '.stm-switcher\_\_trigger\_default:after' => array( |
  | 169 |  | 'border-top-color' => stm\_hb\_get\_option('top\_bar\_text\_color', false, $this->headerName) |
  | 170 |  | ), |
  | 171 |  | '.dropdown-toggle:after'               => array( |
  | 172 |  | 'border-top-color' => stm\_hb\_get\_option('top\_bar\_text\_color', false, $this->headerName) . '!important' |
  | 173 |  | ), |
  | 174 |  | ), |
  | 175 |  | '.stm-header\_\_row\_color\_top:before'    => array( |
  | 176 |  | 'background-color' => stm\_hb\_get\_option('top\_bar\_color', false, $this->headerName), |
  | 177 |  | ), |
  | 178 |  | '.stm-header\_\_row\_color\_center'        => array( |
  | 179 |  | 'padding-top'                          => stm\_hb\_get\_option('header\_top', false, $this->headerName), |
  | 180 |  | 'padding-bottom'                       => stm\_hb\_get\_option('header\_bottom', false, $this->headerName), |
  | 181 |  | 'margin-top'                          => stm\_hb\_get\_option('header\_top\_margin', false, $this->headerName), |
  | 182 |  | 'margin-bottom'                       => stm\_hb\_get\_option('header\_bottom\_margin', false, $this->headerName), |
  | 183 |  | 'background-image'                     => esc\_url($header\_bg), |
  | 184 |  | 'color'                                => stm\_hb\_get\_option('header\_text\_color', false, $this->headerName), |
  | 185 |  | 'z-index'                                => stm\_hb\_get\_option('header\_zindex', false, $this->headerName), |
  | 186 |  | '.stm-icontext\_\_text'                  => array( |
  | 187 |  | 'color' => stm\_hb\_get\_option('header\_text\_color', false, $this->headerName) |
  | 188 |  | ), |
  | 189 |  | 'a'                                    => array( |
  | 190 |  | 'color' => stm\_hb\_get\_option('header\_text\_color', false, $this->headerName) |
  | 191 |  | ), |
  | 192 |  | '.dropdown-toggle'                     => array( |
  | 193 |  | 'color' => stm\_hb\_get\_option('header\_text\_color', false, $this->headerName) . '!important' |
  | 194 |  | ), |
  | 195 |  | 'li:hover > a'                         => array( |
  | 196 |  | 'color' => stm\_hb\_get\_option('header\_text\_color\_hover', false, $this->headerName) . '!important' |
  | 197 |  | ), |
  | 198 |  | 'a:hover, .stm-navigation\_\_default > ul > li > a:hover'                              => array( |
  | 199 |  | 'color' => stm\_hb\_get\_option('header\_text\_color\_hover', false, $this->headerName) . '!important' |
  | 200 |  | ), |
  | 201 |  | 'a > .divider'                         => array( |
  | 202 |  | 'color' => stm\_hb\_get\_option('header\_text\_color', false, $this->headerName) . '!important' |
  | 203 |  | ), |
  | 204 |  | 'a:hover > .divider'                   => array( |
  | 205 |  | 'color' => stm\_hb\_get\_option('header\_text\_color', false, $this->headerName) . '!important' |
  | 206 |  | ), |
  | 207 |  | 'li:hover > a > .divider'              => array( |
  | 208 |  | 'color' => stm\_hb\_get\_option('header\_text\_color', false, $this->headerName) . '!important' |
  | 209 |  | ), |
  | 210 |  | '.stm-switcher\_\_trigger\_default:after' => array( |
  | 211 |  | 'border-top-color' => stm\_hb\_get\_option('header\_text\_color', false, $this->headerName) |
  | 212 |  | ), |
  | 213 |  | '.dropdown-toggle:after'               => array( |
  | 214 |  | 'border-top-color' => stm\_hb\_get\_option('header\_text\_color', false, $this->headerName) . '!important' |
  | 215 |  | ), |
  | 216 |  | ), |
  | 217 |  | '.stm-header\_\_row\_color\_center:before' => array( |
  | 218 |  | 'background-color' => stm\_hb\_get\_option('header\_color', false, $this->headerName), |
  | 219 |  | ), |
  | 220 |  | '.stm-header\_\_row\_color\_bottom'        => array( |
  | 221 |  | 'padding-top'                          => stm\_hb\_get\_option('bottom\_bar\_top', false, $this->headerName), |
  | 222 |  | 'padding-bottom'                       => stm\_hb\_get\_option('bottom\_bar\_bottom', false, $this->headerName), |
  | 223 |  | 'margin-top'                          => stm\_hb\_get\_option('bottom\_bar\_top\_margin', false, $this->headerName), |
  | 224 |  | 'margin-bottom'                       => stm\_hb\_get\_option('bottom\_bar\_bottom\_margin', false, $this->headerName), |
  | 225 |  | 'background-image'                     => esc\_url($bottom\_bar\_bg), |
  | 226 |  | 'color'                                => stm\_hb\_get\_option('bottom\_bar\_text\_color', false, $this->headerName), |
  | 227 |  | 'z-index'                                => stm\_hb\_get\_option('bottom\_bar\_zindex', false, $this->headerName), |
  | 228 |  | '.stm-icontext\_\_text'                  => array( |
  | 229 |  | 'color' => stm\_hb\_get\_option('bottom\_bar\_text\_color', false, $this->headerName) |
  | 230 |  | ), |
  | 231 |  | 'a'                                    => array( |
  | 232 |  | 'color' => stm\_hb\_get\_option('bottom\_bar\_text\_color', false, $this->headerName) |
  | 233 |  | ), |
  | 234 |  | '.dropdown-toggle'                     => array( |
  | 235 |  | 'color' => stm\_hb\_get\_option('bottom\_bar\_text\_color', false, $this->headerName) . '!important' |
  | 236 |  | ), |
  | 237 |  | 'a:hover, .stm-navigation\_\_default > ul > li > a:hover'                              => array( |
  | 238 |  | 'color' => stm\_hb\_get\_option('bottom\_bar\_link\_color\_hover', false, $this->headerName) . '!important' |
  | 239 |  | ), |
  | 240 |  | 'li:hover a'                           => array( |
  | 241 |  | 'color' => stm\_hb\_get\_option('bottom\_bar\_link\_color\_hover', false, $this->headerName) |
  | 242 |  | ), |
  | 243 |  | '.stm-switcher\_\_trigger\_default:after' => array( |
  | 244 |  | 'border-top-color' => stm\_hb\_get\_option('bottom\_bar\_text\_color', false, $this->headerName) |
  | 245 |  | ), |
  | 246 |  | '.dropdown-toggle:after'               => array( |
  | 247 |  | 'border-top-color' => stm\_hb\_get\_option('bottom\_bar\_text\_color', false, $this->headerName) . '!important' |
  | 248 |  | ), |
  | 249 |  | ), |
  | 250 |  | '.stm-header\_\_row\_color\_bottom:before' => array( |
  | 251 |  | 'background-color' => stm\_hb\_get\_option('bottom\_bar\_color', false, $this->headerName), |
  | 252 |  | ), |
  | 253 |  | ); |
  | 254 |  |  |
  | 255 |  |  |
  | 256 |  | if(!empty($top\_bar\_width)) { |
  | 257 |  | $item = array('max-width' => $top\_bar\_width); |
  | 258 |  | $styles['.stm-header\_\_row\_color\_top'] = $item + $styles['.stm-header\_\_row\_color\_top']; |
  | 259 |  | } |
  | 260 |  |  |
  | 261 |  | if(!empty($header\_width)) { |
  | 262 |  | $item = array('max-width' => $header\_width); |
  | 263 |  | $styles['.stm-header\_\_row\_color\_center'] = $item + $styles['.stm-header\_\_row\_color\_center']; |
  | 264 |  | } |
  | 265 |  |  |
  | 266 |  | if(!empty($bottom\_bar\_width)) { |
  | 267 |  | $item = array('max-width' => $bottom\_bar\_width); |
  | 268 |  | $styles['.stm-header\_\_row\_color\_bottom'] = $item + $styles['.stm-header\_\_row\_color\_bottom']; |
  | 269 |  | } |
  | 270 |  |  |
  | 271 |  | foreach ($styles as $element => $element\_styles) { |
  | 272 |  | $custom\_css .= "{$element}{"; |
  | 273 |  | foreach ($element\_styles as $parent\_prop => $parent\_value) { |
  | 274 |  | if (!empty($parent\_value)) { |
  | 275 |  | $helpers = stm\_hb\_get\_style($parent\_prop); |
  | 276 |  | $prefix = $helpers['prefix']; |
  | 277 |  | $affix = $helpers['affix']; |
  | 278 |  |  |
  | 279 |  | /\*Second lvl\*/ |
  | 280 |  | if (is\_array($parent\_value)) { |
  | 281 |  | $custom\_css .= "} {$element} {$parent\_prop} {"; |
  | 282 |  | foreach ($parent\_value as $prop => $value) { |
  | 283 |  | $helpers = stm\_hb\_get\_style($parent\_prop); |
  | 284 |  | $prefix = $helpers['prefix']; |
  | 285 |  | $affix = $helpers['affix']; |
  | 286 |  |  |
  | 287 |  | $custom\_css .= "{$prop}:{$prefix}{$value}{$affix};"; |
  | 288 |  | } |
  | 289 |  | } else { |
  | 290 |  | /\*First lvl\*/ |
  | 291 |  | $custom\_css .= "{$parent\_prop}:{$prefix}{$parent\_value}{$affix};"; |
  | 292 |  | } |
  | 293 |  | } |
  | 294 |  | } |
  | 295 |  | $custom\_css .= '}'; |
  | 296 |  | } |
  | 297 |  |  |
  | 298 |  | return $custom\_css; |
  | 299 |  | } |
  | 300 |  |  |
  | 301 |  | function get\_custom\_styled\_elements\_array() |
  | 302 |  | { |
  | 303 |  | $elements\_list = array( |
  | 304 |  | 'colors'        => array( |
  | 305 |  | 'main\_color'      => array( |
  | 306 |  | '.stm\_hb\_mtc', |
  | 307 |  | '.stm\_hb\_mtc\_h:hover', |
  | 308 |  | '.stm\_hb\_mtc\_b:before', |
  | 309 |  | '.stm\_hb\_mtc\_b\_h:hover:before', |
  | 310 |  | '.stm\_hb\_mtc\_a:after', |
  | 311 |  | '.stm\_hb\_mtc\_a\_h:hover:after', |
  | 312 |  | '.stm\_hb\_mtc\_a\_h.active', |
  | 313 |  | '.mini-cart', |
  | 314 |  | ), |
  | 315 |  | 'secondary\_color' => array( |
  | 316 |  | '.stm\_hb\_stc', |
  | 317 |  | '.stm\_hb\_stc\_h:hover', |
  | 318 |  | '.stm\_hb\_stc\_a:after', |
  | 319 |  | '.stm\_hb\_stc\_a\_h:hover:after', |
  | 320 |  | '.stm\_hb\_stc\_b:before', |
  | 321 |  | '.stm\_hb\_stc\_b\_h:hover:before', |
  | 322 |  | ), |
  | 323 |  | 'third\_color'     => array( |
  | 324 |  | '.stm\_hb\_ttc', |
  | 325 |  | '.stm\_hb\_ttc\_h:hover', |
  | 326 |  | '.stm\_hb\_ttc\_a:after', |
  | 327 |  | '.stm\_hb\_ttc\_a\_h:hover:after', |
  | 328 |  | '.stm\_hb\_ttc\_b:before', |
  | 329 |  | '.stm\_hb\_ttc\_b\_h:hover:before', |
  | 330 |  | ) |
  | 331 |  | ), |
  | 332 |  | 'bg\_colors'     => array( |
  | 333 |  | 'main\_color'      => array( |
  | 334 |  | '.stm\_hb\_mbc', |
  | 335 |  | '.stm\_hb\_mbc\_h:hover', |
  | 336 |  | '.stm\_hb\_mbc\_b:before', |
  | 337 |  | '.stm\_hb\_mbc\_b\_h:hover:before', |
  | 338 |  | '.stm\_hb\_mbc\_a:after', |
  | 339 |  | '.stm\_hb\_mbc\_a\_h:hover:after', |
  | 340 |  | '.stm\_hb\_mbc\_h.active', |
  | 341 |  | '.stm-search .stm\_widget\_search button[type=submit]', |
  | 342 |  | ), |
  | 343 |  | 'secondary\_color' => array( |
  | 344 |  | '.stm\_hb\_sbc', |
  | 345 |  | '.stm\_hb\_sbc\_h:hover', |
  | 346 |  | '.stm\_hb\_sbc\_a:after', |
  | 347 |  | '.stm\_hb\_sbc\_a\_h:hover:after', |
  | 348 |  | '.stm\_hb\_sbc\_b:before', |
  | 349 |  | '.stm\_hb\_sbc\_b\_h:hover:before', |
  | 350 |  | ), |
  | 351 |  | 'third\_color'     => array( |
  | 352 |  | '.stm\_hb\_tbc', |
  | 353 |  | '.stm\_hb\_tbc\_h:hover', |
  | 354 |  | '.stm\_hb\_tbc\_h.active', |
  | 355 |  | '.stm\_hb\_tbc\_a:after', |
  | 356 |  | '.stm\_hb\_tbc\_a\_h:hover:after', |
  | 357 |  | '.stm\_hb\_tbc\_b:before', |
  | 358 |  | '.stm\_hb\_tbc\_b\_h:hover:before', |
  | 359 |  | ) |
  | 360 |  | ), |
  | 361 |  | 'border\_colors' => array( |
  | 362 |  | 'main\_color'      => array( |
  | 363 |  | '.stm\_hb\_mbdc', |
  | 364 |  | '.stm\_hb\_mbdc\_h:hover', |
  | 365 |  | '.stm\_hb\_mbdc\_b:before', |
  | 366 |  | '.stm\_hb\_mbdc\_b\_h:hover:before', |
  | 367 |  | '.stm\_hb\_mbdc\_a:after', |
  | 368 |  | '.stm\_hb\_mbdc\_a\_h:hover:after', |
  | 369 |  | '.stm-search .stm\_widget\_search .form-control:focus', |
  | 370 |  | ), |
  | 371 |  | 'secondary\_color' => array( |
  | 372 |  | '.stm\_hb\_sbdc', |
  | 373 |  | '.stm\_hb\_sbdc\_h:hover', |
  | 374 |  | '.stm\_hb\_sbdc\_a:after', |
  | 375 |  | '.stm\_hb\_sbdc\_a\_h:hover:after', |
  | 376 |  | '.stm\_hb\_sbdc\_b:before', |
  | 377 |  | '.stm\_hb\_sbdc\_b\_h:hover:before', |
  | 378 |  |  |
  | 379 |  | ), |
  | 380 |  | 'third\_color'     => array( |
  | 381 |  | '.stm\_hb\_tbdc', |
  | 382 |  | '.stm\_hb\_tbdc\_h:hover', |
  | 383 |  | '.stm\_hb\_tbdc\_a:after', |
  | 384 |  | '.stm\_hb\_tbdc\_a\_h:hover:after', |
  | 385 |  | '.stm\_hb\_tbdc\_b:before', |
  | 386 |  | '.stm\_hb\_tbdc\_b\_h:hover:before', |
  | 387 |  | ), |
  | 388 |  | ) |
  | 389 |  | ); |
  | 390 |  |  |
  | 391 |  | $main\_color = stm\_hb\_get\_option('main\_color', '#297ee8', $this->headerName); |
  | 392 |  | $secondary\_color = stm\_hb\_get\_option('secondary\_color', '#222222', $this->headerName); |
  | 393 |  | $third\_color = stm\_hb\_get\_option('third\_color', '#297ee8', $this->headerName); |
  | 394 |  |  |
  | 395 |  | /\*Color\*/ |
  | 396 |  | $colors = $elements\_list['colors']; |
  | 397 |  |  |
  | 398 |  | /\*Background color\*/ |
  | 399 |  | $bg\_colors = $elements\_list['bg\_colors']; |
  | 400 |  |  |
  | 401 |  | /\*Border color\*/ |
  | 402 |  | $border\_colors = $elements\_list['border\_colors']; |
  | 403 |  |  |
  | 404 |  | ob\_start(); |
  | 405 |  | foreach ($colors as $color => $elements) { ?> |
  | 406 |  | <?php echo implode(',', $elements) ?> {color: <?php echo sanitize\_text\_field(${$color}); ?> !important} |
  | 407 |  | <?php } |
  | 408 |  |  |
  | 409 |  | foreach ($bg\_colors as $bg\_color => $elements) { ?> |
  | 410 |  | <?php echo implode(',', $elements) ?> {background-color: <?php echo sanitize\_text\_field(${$bg\_color}); ?> !important} |
  | 411 |  | <?php } |
  | 412 |  |  |
  | 413 |  | foreach ($border\_colors as $border\_color => $elements) { ?> |
  | 414 |  | <?php echo implode(',', $elements) ?> {border-color: <?php echo sanitize\_text\_field(${$border\_color}); ?> !important} |
  | 415 |  | <?php } |
  | 416 |  |  |
  | 417 |  |  |
  | 418 |  | //Header width |
  | 419 |  | $header\_container\_width = stm\_hb\_get\_option('header\_container\_width', false, $this->headerName); |
  | 420 |  | $header\_content\_width = stm\_hb\_get\_option('header\_content\_width', false, $this->headerName); |
  | 421 |  |  |
  | 422 |  | if (!empty($header\_container\_width)) { |
  | 423 |  | echo ".stm-header{max-width:{$header\_container\_width}px;}"; |
  | 424 |  | } |
  | 425 |  |  |
  | 426 |  | if (!empty($header\_content\_width)) { |
  | 427 |  | echo ".stm-header\_\_row\_color > .container{max-width:{$header\_content\_width}px;}"; |
  | 428 |  | } |
  | 429 |  |  |
  | 430 |  | $styles = ob\_get\_clean(); |
  | 431 |  |  |
  | 432 |  | return $styles; |
  | 433 |  |  |
  | 434 |  | } |
  | 435 |  |  |
  | 436 |  | function inline\_scripts() |
  | 437 |  | { |
  | 438 |  | $styles = ''; |
  | 439 |  | $styles .= $this->header\_element\_custom\_styles(); |
  | 440 |  | $styles .= $this->header\_elements\_styles(); |
  | 441 |  | $styles .= $this->get\_custom\_styled\_elements\_array(); |
  | 442 |  |  |
  | 443 |  | echo stm\_hb\_text\_sanitize('<style type="text/css" id="styles-' . $this->headerName . '">'); |
  | 444 |  | echo stm\_hb\_text\_sanitize($styles); |
  | 445 |  | echo stm\_hb\_text\_sanitize('</style>'); |
  | 446 |  | } |
  | 447 |  |  |
  | 448 |  | } |
  | 449 |  | } |
  | 450 |  |  |
  | 451 |  |  |
  | 452 |  | function stm\_hb\_get\_option($option\_name, $default = false, $hb = '') |
  | 453 |  | { |
  | 454 |  |  |
  | 455 |  | $hb = !empty($hb) ? $hb : 'header\_builder'; |
  | 456 |  |  |
  | 457 |  | $options = get\_option($hb, array()); |
  | 458 |  | $option = null; |
  | 459 |  |  |
  | 460 |  | if (!empty($options[$option\_name])) { |
  | 461 |  | $option = $options[$option\_name]; |
  | 462 |  | } elseif (isset($default)) { |
  | 463 |  | $option = $default; |
  | 464 |  | } |
  | 465 |  |  |
  | 466 |  | return $option; |
  | 467 |  | } |
  | 468 |  |  |
  | 469 |  | function stm\_hb($a) |
  | 470 |  | { |
  | 471 |  | echo '<pre>'; |
  | 472 |  | print\_r($a); |
  | 473 |  | echo '</pre>'; |
  | 474 |  | } |
  | 475 |  |  |
  | 476 |  | function stm\_hb\_parts() |
  | 477 |  | { |
  | 478 |  | return array( |
  | 479 |  | 'rows'  => array('top', 'center', 'bottom'), |
  | 480 |  | 'cells' => array('left', 'center', 'right') |
  | 481 |  | ); |
  | 482 |  | } |
  | 483 |  |  |
  | 484 |  | function stm\_hb\_check\_string($string) |
  | 485 |  | { |
  | 486 |  | return $string === 'true'; |
  | 487 |  | } |
  | 488 |  |  |
  | 489 |  | function stm\_hb\_element\_style($element) |
  | 490 |  | { |
  | 491 |  | $style\_class = ''; |
  | 492 |  | if (!empty($element['data']) and !empty($element['data']['style'])) { |
  | 493 |  | $style\_class = $element['data']['style']; |
  | 494 |  | } |
  | 495 |  |  |
  | 496 |  | return " stm-header\_\_element\_{$style\_class}"; |
  | 497 |  | } |
  | 498 |  |  |
  | 499 |  | function stm\_hb\_locate\_builder\_element($templates, $template\_name, $\_\_folder) |
  | 500 |  | { |
  | 501 |  | $located = false; |
  | 502 |  |  |
  | 503 |  | foreach ((array)$templates as $template) { |
  | 504 |  |  |
  | 505 |  | $folder = $template; |
  | 506 |  |  |
  | 507 |  | if (!empty($template\_name)) { |
  | 508 |  | $template = $template\_name; |
  | 509 |  | } |
  | 510 |  |  |
  | 511 |  | if (substr($template, -4) !== '.php') { |
  | 512 |  | $template .= '.php'; |
  | 513 |  | } |
  | 514 |  |  |
  | 515 |  | if ($\_\_folder !== 'elements') { |
  | 516 |  | $base = 'hb\_templates/' . $\_\_folder . '/' . $template; |
  | 517 |  | } else { |
  | 518 |  | $base = 'hb\_templates/' . $\_\_folder . '/' . $folder . '/' . $template; |
  | 519 |  | } |
  | 520 |  |  |
  | 521 |  | if (!($located = locate\_template('/' . $base))) { |
  | 522 |  | $located = STM\_HB\_DIR . $base; |
  | 523 |  | } |
  | 524 |  |  |
  | 525 |  | if (file\_exists($located)) { |
  | 526 |  | break; |
  | 527 |  | } |
  | 528 |  |  |
  | 529 |  | } |
  | 530 |  |  |
  | 531 |  | return apply\_filters('stm\_listings\_locate\_template', $located, $templates); |
  | 532 |  | } |
  | 533 |  |  |
  | 534 |  | function stm\_hb\_load\_element($\_\_template, $\_\_vars = array(), $\_\_template\_name = '', $\_\_folder = 'elements') |
  | 535 |  | { |
  | 536 |  | extract($\_\_vars); |
  | 537 |  | include stm\_hb\_locate\_builder\_element($\_\_template, $\_\_template\_name, $\_\_folder); |
  | 538 |  | } |
  | 539 |  |  |
  | 540 |  | function stm\_get\_assets\_path() |
  | 541 |  | { |
  | 542 |  | $assets = array(); |
  | 543 |  | $url = STM\_HB\_URL; |
  | 544 |  | $assets['css'] = $url . 'assets/admin/assets/css/'; |
  | 545 |  | $assets['frontend\_css'] = $url . 'assets/frontend/assets/css/'; |
  | 546 |  | $assets['frontend\_js'] = $url . 'assets/frontend/assets/js/'; |
  | 547 |  | $assets['frontend\_vendor'] = $url . 'assets/frontend/assets/vendor/'; |
  | 548 |  | $assets['js'] = $url . 'assets/admin/assets/js/'; |
  | 549 |  | $assets['vendors'] = $url . 'assets/admin/assets/vendor/'; |
  | 550 |  | $assets['v'] = WP\_DEBUG ? time() : STM\_HB\_VER; |
  | 551 |  |  |
  | 552 |  | return apply\_filters('stm\_get\_assets\_path', $assets); |
  | 553 |  | } |
  | 554 |  |  |
  | 555 |  | function stm\_hb\_random($len = 10) |
  | 556 |  | { |
  | 557 |  | $word = array\_merge(range('a', 'z'), range('A', 'Z')); |
  | 558 |  | shuffle($word); |
  | 559 |  | return substr(implode($word), 0, $len); |
  | 560 |  | } |
  | 561 |  |  |
  | 562 |  | function stm\_hb\_get\_dropdown($dropdown) |
  | 563 |  | { |
  | 564 |  | $choices = array( |
  | 565 |  | 'first'  => [], |
  | 566 |  | 'others' => [] |
  | 567 |  | ); |
  | 568 |  |  |
  | 569 |  | if (!empty($dropdown[0]) and !empty($dropdown[0]['label'])) { |
  | 570 |  | $choices['first'] = $dropdown[0]; |
  | 571 |  | } |
  | 572 |  |  |
  | 573 |  | array\_shift($dropdown); |
  | 574 |  |  |
  | 575 |  | if (!empty($dropdown)) { |
  | 576 |  | $choices['others'] = $dropdown; |
  | 577 |  | } |
  | 578 |  |  |
  | 579 |  | return $choices; |
  | 580 |  | } |
  | 581 |  |  |
  | 582 |  | function stm\_hb\_array\_to\_style\_string($arr, $important = false) |
  | 583 |  | { |
  | 584 |  | $important = $important ? '!important' : ''; |
  | 585 |  | $r = array\_map( |
  | 586 |  | function ($v, $k) { |
  | 587 |  | return $k . ':' . $v; |
  | 588 |  | }, |
  | 589 |  | $arr, |
  | 590 |  | array\_keys($arr) |
  | 591 |  | ); |
  | 592 |  |  |
  | 593 |  | $r = implode($important . '; ', $r) . $important . ';'; |
  | 594 |  |  |
  | 595 |  | return $r; |
  | 596 |  | } |
  | 597 |  |  |
  | 598 |  | function stm\_hb\_get\_wpml\_langs() |
  | 599 |  | { |
  | 600 |  | do\_action('wpml\_add\_language\_selector'); |
  | 601 |  |  |
  | 602 |  | if (defined('ICL\_LANGUAGE\_CODE')) { |
  | 603 |  | $current\_language\_code = ICL\_LANGUAGE\_CODE; |
  | 604 |  | $langs = icl\_get\_languages('skip\_missing=0'); |
  | 605 |  | $wpml = array(); |
  | 606 |  |  |
  | 607 |  | if (!empty($langs)) { |
  | 608 |  | if (!empty($langs[$current\_language\_code])) { |
  | 609 |  | $current\_language = $langs[$current\_language\_code]; |
  | 610 |  | $wpml[] = array( |
  | 611 |  | 'label' => $current\_language['native\_name'], |
  | 612 |  | 'url'   => $current\_language['url'], |
  | 613 |  | ); |
  | 614 |  | } |
  | 615 |  |  |
  | 616 |  | foreach ($langs as $lang\_key => $lang\_info) { |
  | 617 |  | if ($lang\_key !== $current\_language\_code) { |
  | 618 |  | $wpml[] = array( |
  | 619 |  | 'label' => $lang\_info['native\_name'], |
  | 620 |  | 'url'   => $lang\_info['url'], |
  | 621 |  | ); |
  | 622 |  | } |
  | 623 |  | } |
  | 624 |  | } |
  | 625 |  | } |
  | 626 |  |  |
  | 627 |  | if (empty($langs)) { |
  | 628 |  | $wpml = [ |
  | 629 |  | array( |
  | 630 |  | 'label' => esc\_html\_\_('English', 'pearl-header-builder'), |
  | 631 |  | 'url'   => '/' |
  | 632 |  | ), |
  | 633 |  | ]; |
  | 634 |  | } |
  | 635 |  |  |
  | 636 |  | return apply\_filters('pearl\_get\_wpml\_langs', $wpml); |
  | 637 |  | } |
  | 638 |  |  |
  | 639 |  | function stm\_hb\_get\_image\_url($id, $size = 'full') |
  | 640 |  | { |
  | 641 |  | $url = ''; |
  | 642 |  | if (!empty($id)) { |
  | 643 |  | $image = wp\_get\_attachment\_image\_src($id, $size, false); |
  | 644 |  | if (!empty($image[0])) { |
  | 645 |  | $url = $image[0]; |
  | 646 |  | } |
  | 647 |  | } |
  | 648 |  |  |
  | 649 |  | return $url; |
  | 650 |  | } |
  | 651 |  |  |
  | 652 |  | function stm\_hb\_color\_treads($color) |
  | 653 |  | { |
  | 654 |  | $color = (strlen($color) == 6) ? "#{$color}" : $color; |
  | 655 |  | return apply\_filters('pearl\_color\_treads', $color); |
  | 656 |  | } |
  | 657 |  |  |
  | 658 |  | function stm\_hb\_get\_style($key = '') |
  | 659 |  | { |
  | 660 |  | $r = array( |
  | 661 |  | 'prefix' => '', |
  | 662 |  | 'affix'  => '' |
  | 663 |  | ); |
  | 664 |  |  |
  | 665 |  | $metrix = array( |
  | 666 |  | 'padding-top', |
  | 667 |  | 'padding-bottom', |
  | 668 |  | 'margin-top', |
  | 669 |  | 'margin-bottom', |
  | 670 |  | 'line-height', |
  | 671 |  | 'border-width', |
  | 672 |  | 'max-width' |
  | 673 |  | ); |
  | 674 |  |  |
  | 675 |  | $src = array( |
  | 676 |  | 'background-image' |
  | 677 |  | ); |
  | 678 |  |  |
  | 679 |  | /\*Set px\*/ |
  | 680 |  | if (in\_array($key, $metrix)) { |
  | 681 |  | $r['affix'] = 'px'; |
  | 682 |  | } |
  | 683 |  |  |
  | 684 |  | /\*Set url\*/ |
  | 685 |  | if (in\_array($key, $src)) { |
  | 686 |  | $r['prefix'] = 'url("'; |
  | 687 |  | $r['affix'] = '")'; |
  | 688 |  | } |
  | 689 |  |  |
  | 690 |  | return apply\_filters('stm\_hb\_get\_style', $r); |
  | 691 |  | } |
  | 692 |  |  |
  | 693 |  | function stm\_hb\_text\_sanitize($text) |
  | 694 |  | { |
  | 695 |  | return $text; |
  | 696 |  | } |
  | 697 |  |  |
  | 698 |  | function stm\_hb\_get\_cart\_url() |
  | 699 |  | { |
  | 700 |  | $cart\_id = get\_option('woocommerce\_cart\_page\_id', ''); |
  | 701 |  | return !empty($cart\_id) ? get\_the\_permalink($cart\_id) : ''; |
  | 702 |  | } |
  | 703 |  |  |
  | 704 |  | function stm\_hb\_cart\_fragments($fragments) |
  | 705 |  | { |
  | 706 |  |  |
  | 707 |  | /\*Mini cart\*/ |
  | 708 |  | ob\_start(); |
  | 709 |  | stm\_hb\_load\_element('cart', array(), 'mini-cart'); |
  | 710 |  | $mini\_cart = ob\_get\_contents(); |
  | 711 |  | ob\_end\_clean(); |
  | 712 |  |  |
  | 713 |  | /\*Quantity\*/ |
  | 714 |  | ob\_start(); |
  | 715 |  | stm\_hb\_load\_element('cart', array(), 'quantity'); |
  | 716 |  | $quantity = ob\_get\_contents(); |
  | 717 |  | ob\_end\_clean(); |
  | 718 |  |  |
  | 719 |  |  |
  | 720 |  | $fragments['.mini-cart'] = $mini\_cart; |
  | 721 |  | $fragments['.cart\_\_quantity-badge'] = $quantity; |
  | 722 |  |  |
  | 723 |  | return $fragments; |
  | 724 |  | } |
  | 725 |  |  |
  | 726 |  | add\_filter('woocommerce\_add\_to\_cart\_fragments', 'stm\_hb\_cart\_fragments', 1000, 1); |
  |  | 2 | add\_action( 'stm\_hb', array( 'pearl\_header\_builder', 'build' ) ); |
  |  | 3 | add\_shortcode( 'stm\_hb', array( 'pearl\_header\_builder', 'build\_from\_shortcode' ) ); |
  |  | 4 |  |
  |  | 5 |  |
  |  | 6 | if ( ! class\_exists( 'pearl\_header\_builder' ) ) { |
  |  | 7 | class Pearl\_Header\_Builder { |
  |  | 8 |  |
  |  | 9 | public $headerName = 'stm\_hb\_settings'; |
  |  | 10 |  |
  |  | 11 | public static function build( $headerName ) { |
  |  | 12 | $headerName = ( empty( $headerName ) ) ? 'stm\_hb\_settings' : $headerName; |
  |  | 13 |  |
  |  | 14 | return new self( $headerName ); |
  |  | 15 | } |
  |  | 16 |  |
  |  | 17 | public static function build\_from\_shortcode( $args, $content = '' ) { |
  |  | 18 | new Pearl\_Header\_Builder( $args ); |
  |  | 19 | ob\_start(); |
  |  | 20 | require\_once STM\_HB\_DIR . 'hb\_templates/main.php'; |
  |  | 21 | $content = ob\_get\_clean(); |
  |  | 22 |  |
  |  | 23 | return apply\_filters( 'stm\_hb\_build\_from\_shortcode', $content ); |
  |  | 24 | } |
  |  | 25 |  |
  |  | 26 | private function \_\_construct( $args ) { |
  |  | 27 | $this->headerName = ( ! empty( $args['header'] ) ) ? $args['header'] : 'stm\_hb\_settings'; |
  |  | 28 | $this->inline\_scripts(); |
  |  | 29 | require\_once STM\_HB\_DIR . 'hb\_templates/main.php'; |
  |  | 30 | } |
  |  | 31 |  |
  |  | 32 | public function header\_element\_custom\_styles() { |
  |  | 33 | $custom\_css = ''; |
  |  | 34 | $data       = apply\_filters( 'pearl\_builder\_elements', stm\_hb\_get\_option( 'header\_builder', false, $this->headerName ) ); |
  |  | 35 | if ( empty( $data ) ) { |
  |  | 36 | return null; |
  |  | 37 | } |
  |  | 38 |  |
  |  | 39 | foreach ( $data as $row => $columns ) { |
  |  | 40 | foreach ( $columns as $column => $elements ) { |
  |  | 41 | foreach ( $elements as $data ) { |
  |  | 42 | $element = sanitize\_title( $data['$$hashKey'] ); |
  |  | 43 | if ( ! empty( $element ) ) { |
  |  | 44 |  |
  |  | 45 | $element = ".stm-header\_\_element.{$element}"; |
  |  | 46 | $media   = array( |
  |  | 47 | 'default' => '(min-width:1023px)', |
  |  | 48 | 'tablet'  => '(max-width:1023px) and (min-width:425px)', |
  |  | 49 | 'mobile'  => '(max-width:425px)', |
  |  | 50 | ); |
  |  | 51 |  |
  |  | 52 | /\*Generate margins\*/ |
  |  | 53 | if ( ! empty( $data['margins'] ) ) { |
  |  | 54 | foreach ( $data['margins'] as $display => $margins ) { |
  |  | 55 | if ( ! empty( $margins ) ) { |
  |  | 56 | $custom\_css .= "@media {$media[$display]}{{$element}{"; |
  |  | 57 | foreach ( $margins as $prop => $value ) { |
  |  | 58 | if ( isset( $prop ) && isset( $value ) ) { |
  |  | 59 | $custom\_css .= "margin-{$prop}:{$value}px !important;"; |
  |  | 60 | } |
  |  | 61 | } |
  |  | 62 | $custom\_css .= '}}'; |
  |  | 63 | } |
  |  | 64 | } |
  |  | 65 | } |
  |  | 66 | /\*Generate text color\*/ |
  |  | 67 | if ( array\_has( $data, 'data.textColor.name' ) && 'Custom' === $data['data']['textColor']['name'] ) { |
  |  | 68 | $custom\_css .= $element . '{color: ' . $data['data']['textColor']['value'] . '}'; |
  |  | 69 | } |
  |  | 70 |  |
  |  | 71 | /\*Generate icon color\*/ |
  |  | 72 | if ( array\_has( $data, 'data.iconColor.name' ) && 'Custom' === $data['data']['iconColor']['name'] ) { |
  |  | 73 | $custom\_css .= $element . " [class\*='\_icon'] {color: " . $data['data']['iconColor']['value'] . '}'; |
  |  | 74 | } |
  |  | 75 |  |
  |  | 76 | /\*Menu item hover line\*/ |
  |  | 77 | if ( array\_has( $data, 'data.lineColor' ) && ! empty( $data['data']['lineColor'] ) && |
  |  | 78 | array\_has( $data, 'data.line' ) && ! empty( $data['data']['line'] ) |
  |  | 79 | ) { |
  |  | 80 | $custom\_css .= $element . " li:before {background-color: {$data['data']['lineColor']} !important;}"; |
  |  | 81 | } |
  |  | 82 |  |
  |  | 83 | /\*Menu item a color\*/ |
  |  | 84 | if ( array\_has( $data, 'data.menuLinkColor' ) && ! empty( $data['data']['menuLinkColor'] ) ) { |
  |  | 85 | $custom\_css .= $element . " li a {color: {$data['data']['menuLinkColor']} !important;}"; |
  |  | 86 | } |
  |  | 87 | /\*Menu item a color on hover\*/ |
  |  | 88 | if ( array\_has( $data, 'data.menuLinkColorOnHover' ) && ! empty( $data['data']['menuLinkColorOnHover'] ) ) { |
  |  | 89 | $custom\_css .= $element . " li a:hover {color: {$data['data']['menuLinkColorOnHover']} !important;}"; |
  |  | 90 | $custom\_css .= $element . " li:hover > a {color: {$data['data']['menuLinkColorOnHover']} !important;}"; |
  |  | 91 | } |
  |  | 92 |  |
  |  | 93 | if ( ! empty( $data['order'] ) ) { |
  |  | 94 | foreach ( $media as $device => $breakpoint ) { |
  |  | 95 | if ( ! empty( $data['order'][ $device ] ) ) { |
  |  | 96 | $custom\_css .= "@media {$breakpoint} {"; |
  |  | 97 | $custom\_css .= $element . "{order: -{$data['order'][$device]}}"; |
  |  | 98 | $custom\_css .= '}'; |
  |  | 99 | } |
  |  | 100 | } |
  |  | 101 | $custom\_css .= $element . '{}'; |
  |  | 102 | } |
  |  | 103 |  |
  |  | 104 | $disabled\_devices = ( ! empty( $data['disabled'] ) ) ? array\_keys( array\_filter( $data['disabled'] ) ) : array(); |
  |  | 105 | if ( ! empty( $disabled\_devices ) ) { |
  |  | 106 | foreach ( $media as $device => $breakpoint ) { |
  |  | 107 | if ( in\_array( $device, $disabled\_devices ) ) { |
  |  | 108 | $custom\_css .= "@media {$breakpoint} {"; |
  |  | 109 | $custom\_css .= $element . '{display: none!important};'; |
  |  | 110 | $custom\_css .= '}'; |
  |  | 111 | } |
  |  | 112 | } |
  |  | 113 | } |
  |  | 114 | } |
  |  | 115 | } |
  |  | 116 | } |
  |  | 117 | } |
  |  | 118 |  |
  |  | 119 | return $custom\_css; |
  |  | 120 | } |
  |  | 121 |  |
  |  | 122 | public function header\_elements\_styles() { |
  |  | 123 | $custom\_css    = ''; |
  |  | 124 | $top\_bar\_bg    = stm\_hb\_get\_image\_url( stm\_hb\_get\_option( 'top\_bar\_bg', false, $this->headerName ) ); |
  |  | 125 | $header\_bg     = stm\_hb\_get\_image\_url( stm\_hb\_get\_option( 'header\_bg', false, $this->headerName ) ); |
  |  | 126 | $bottom\_bar\_bg = stm\_hb\_get\_image\_url( stm\_hb\_get\_option( 'bottom\_bar\_bg', false, $this->headerName ) ); |
  |  | 127 | $all\_bg        = stm\_hb\_get\_image\_url( stm\_hb\_get\_option( 'all\_bg', false, $this->headerName ) ); |
  |  | 128 | $all\_bg\_color  = stm\_hb\_get\_option( 'all\_bg\_color', false, $this->headerName ); |
  |  | 129 |  |
  |  | 130 | $top\_bar\_width    = stm\_hb\_get\_option( 'top\_bar\_width', false, $this->headerName ); |
  |  | 131 | $header\_width     = stm\_hb\_get\_option( 'header\_width', false, $this->headerName ); |
  |  | 132 | $bottom\_bar\_width = stm\_hb\_get\_option( 'bottom\_bar\_width', false, $this->headerName ); |
  |  | 133 |  |
  |  | 134 | $styles = array( |
  |  | 135 | '.stm-header'                          => array( |
  |  | 136 | 'background-image' => esc\_url( $all\_bg ), |
  |  | 137 | ), |
  |  | 138 | '.stm-header:before'                   => array( |
  |  | 139 | 'background-color' => stm\_hb\_get\_option( 'all\_bg\_color', false, $this->headerName ), |
  |  | 140 | ), |
  |  | 141 | '.stm-header\_\_row\_color\_top'           => array( |
  |  | 142 | 'padding-top'                          => stm\_hb\_get\_option( 'top\_bar\_top', false, $this->headerName ), |
  |  | 143 | 'padding-bottom'                       => stm\_hb\_get\_option( 'top\_bar\_bottom', false, $this->headerName ), |
  |  | 144 | 'margin-top'                           => stm\_hb\_get\_option( 'top\_bar\_top\_margin', false, $this->headerName ), |
  |  | 145 | 'margin-bottom'                        => stm\_hb\_get\_option( 'top\_bar\_bottom\_margin', false, $this->headerName ), |
  |  | 146 | 'background-image'                     => esc\_url( $top\_bar\_bg ), |
  |  | 147 | 'color'                                => stm\_hb\_get\_option( 'top\_bar\_text\_color', false, $this->headerName ), |
  |  | 148 | 'z-index'                              => stm\_hb\_get\_option( 'top\_bar\_zindex', false, $this->headerName ), |
  |  | 149 | '.stm-icontext\_\_text'                  => array( |
  |  | 150 | 'color' => stm\_hb\_get\_option( 'top\_bar\_text\_color', false, $this->headerName ), |
  |  | 151 | ), |
  |  | 152 | 'a'                                    => array( |
  |  | 153 | 'color' => stm\_hb\_get\_option( 'top\_bar\_text\_color', false, $this->headerName ), |
  |  | 154 | ), |
  |  | 155 | '.dropdown-toggle'                     => array( |
  |  | 156 | 'color' => stm\_hb\_get\_option( 'top\_bar\_text\_color', false, $this->headerName ) . '!important', |
  |  | 157 | ), |
  |  | 158 | 'a:hover, .stm-navigation\_\_default > ul > li > a:hover' => array( |
  |  | 159 | 'color' => stm\_hb\_get\_option( 'top\_bar\_link\_color\_hover', false, $this->headerName ) . '!important', |
  |  | 160 | ), |
  |  | 161 | 'li:hover a'                           => array( |
  |  | 162 | 'color' => stm\_hb\_get\_option( 'top\_bar\_link\_color\_hover', false, $this->headerName ), |
  |  | 163 | ), |
  |  | 164 | '.stm-switcher\_\_trigger\_default:after' => array( |
  |  | 165 | 'border-top-color' => stm\_hb\_get\_option( 'top\_bar\_text\_color', false, $this->headerName ), |
  |  | 166 | ), |
  |  | 167 | '.dropdown-toggle:after'               => array( |
  |  | 168 | 'border-top-color' => stm\_hb\_get\_option( 'top\_bar\_text\_color', false, $this->headerName ) . '!important', |
  |  | 169 | ), |
  |  | 170 | ), |
  |  | 171 | '.stm-header\_\_row\_color\_top:before'    => array( |
  |  | 172 | 'background-color' => stm\_hb\_get\_option( 'top\_bar\_color', false, $this->headerName ), |
  |  | 173 | ), |
  |  | 174 | '.stm-header\_\_row\_color\_center'        => array( |
  |  | 175 | 'padding-top'                          => stm\_hb\_get\_option( 'header\_top', false, $this->headerName ), |
  |  | 176 | 'padding-bottom'                       => stm\_hb\_get\_option( 'header\_bottom', false, $this->headerName ), |
  |  | 177 | 'margin-top'                           => stm\_hb\_get\_option( 'header\_top\_margin', false, $this->headerName ), |
  |  | 178 | 'margin-bottom'                        => stm\_hb\_get\_option( 'header\_bottom\_margin', false, $this->headerName ), |
  |  | 179 | 'background-image'                     => esc\_url( $header\_bg ), |
  |  | 180 | 'color'                                => stm\_hb\_get\_option( 'header\_text\_color', false, $this->headerName ), |
  |  | 181 | 'z-index'                              => stm\_hb\_get\_option( 'header\_zindex', false, $this->headerName ), |
  |  | 182 | '.stm-icontext\_\_text'                  => array( |
  |  | 183 | 'color' => stm\_hb\_get\_option( 'header\_text\_color', false, $this->headerName ), |
  |  | 184 | ), |
  |  | 185 | 'a'                                    => array( |
  |  | 186 | 'color' => stm\_hb\_get\_option( 'header\_text\_color', false, $this->headerName ), |
  |  | 187 | ), |
  |  | 188 | '.dropdown-toggle'                     => array( |
  |  | 189 | 'color' => stm\_hb\_get\_option( 'header\_text\_color', false, $this->headerName ) . '!important', |
  |  | 190 | ), |
  |  | 191 | 'li:hover > a'                         => array( |
  |  | 192 | 'color' => stm\_hb\_get\_option( 'header\_text\_color\_hover', false, $this->headerName ) . '!important', |
  |  | 193 | ), |
  |  | 194 | 'a:hover, .stm-navigation\_\_default > ul > li > a:hover' => array( |
  |  | 195 | 'color' => stm\_hb\_get\_option( 'header\_text\_color\_hover', false, $this->headerName ) . '!important', |
  |  | 196 | ), |
  |  | 197 | 'a > .divider'                         => array( |
  |  | 198 | 'color' => stm\_hb\_get\_option( 'header\_text\_color', false, $this->headerName ) . '!important', |
  |  | 199 | ), |
  |  | 200 | 'a:hover > .divider'                   => array( |
  |  | 201 | 'color' => stm\_hb\_get\_option( 'header\_text\_color', false, $this->headerName ) . '!important', |
  |  | 202 | ), |
  |  | 203 | 'li:hover > a > .divider'              => array( |
  |  | 204 | 'color' => stm\_hb\_get\_option( 'header\_text\_color', false, $this->headerName ) . '!important', |
  |  | 205 | ), |
  |  | 206 | '.stm-switcher\_\_trigger\_default:after' => array( |
  |  | 207 | 'border-top-color' => stm\_hb\_get\_option( 'header\_text\_color', false, $this->headerName ), |
  |  | 208 | ), |
  |  | 209 | '.dropdown-toggle:after'               => array( |
  |  | 210 | 'border-top-color' => stm\_hb\_get\_option( 'header\_text\_color', false, $this->headerName ) . '!important', |
  |  | 211 | ), |
  |  | 212 | ), |
  |  | 213 | '.stm-header\_\_row\_color\_center:before' => array( |
  |  | 214 | 'background-color' => stm\_hb\_get\_option( 'header\_color', false, $this->headerName ), |
  |  | 215 | ), |
  |  | 216 | '.stm-header\_\_row\_color\_bottom'        => array( |
  |  | 217 | 'padding-top'                          => stm\_hb\_get\_option( 'bottom\_bar\_top', false, $this->headerName ), |
  |  | 218 | 'padding-bottom'                       => stm\_hb\_get\_option( 'bottom\_bar\_bottom', false, $this->headerName ), |
  |  | 219 | 'margin-top'                           => stm\_hb\_get\_option( 'bottom\_bar\_top\_margin', false, $this->headerName ), |
  |  | 220 | 'margin-bottom'                        => stm\_hb\_get\_option( 'bottom\_bar\_bottom\_margin', false, $this->headerName ), |
  |  | 221 | 'background-image'                     => esc\_url( $bottom\_bar\_bg ), |
  |  | 222 | 'color'                                => stm\_hb\_get\_option( 'bottom\_bar\_text\_color', false, $this->headerName ), |
  |  | 223 | 'z-index'                              => stm\_hb\_get\_option( 'bottom\_bar\_zindex', false, $this->headerName ), |
  |  | 224 | '.stm-icontext\_\_text'                  => array( |
  |  | 225 | 'color' => stm\_hb\_get\_option( 'bottom\_bar\_text\_color', false, $this->headerName ), |
  |  | 226 | ), |
  |  | 227 | 'a'                                    => array( |
  |  | 228 | 'color' => stm\_hb\_get\_option( 'bottom\_bar\_text\_color', false, $this->headerName ), |
  |  | 229 | ), |
  |  | 230 | '.dropdown-toggle'                     => array( |
  |  | 231 | 'color' => stm\_hb\_get\_option( 'bottom\_bar\_text\_color', false, $this->headerName ) . '!important', |
  |  | 232 | ), |
  |  | 233 | 'a:hover, .stm-navigation\_\_default > ul > li > a:hover' => array( |
  |  | 234 | 'color' => stm\_hb\_get\_option( 'bottom\_bar\_link\_color\_hover', false, $this->headerName ) . '!important', |
  |  | 235 | ), |
  |  | 236 | 'li:hover a'                           => array( |
  |  | 237 | 'color' => stm\_hb\_get\_option( 'bottom\_bar\_link\_color\_hover', false, $this->headerName ), |
  |  | 238 | ), |
  |  | 239 | '.stm-switcher\_\_trigger\_default:after' => array( |
  |  | 240 | 'border-top-color' => stm\_hb\_get\_option( 'bottom\_bar\_text\_color', false, $this->headerName ), |
  |  | 241 | ), |
  |  | 242 | '.dropdown-toggle:after'               => array( |
  |  | 243 | 'border-top-color' => stm\_hb\_get\_option( 'bottom\_bar\_text\_color', false, $this->headerName ) . '!important', |
  |  | 244 | ), |
  |  | 245 | ), |
  |  | 246 | '.stm-header\_\_row\_color\_bottom:before' => array( |
  |  | 247 | 'background-color' => stm\_hb\_get\_option( 'bottom\_bar\_color', false, $this->headerName ), |
  |  | 248 | ), |
  |  | 249 | ); |
  |  | 250 |  |
  |  | 251 | if ( ! empty( $top\_bar\_width ) ) { |
  |  | 252 | $item                                 = array( 'max-width' => $top\_bar\_width ); |
  |  | 253 | $styles['.stm-header\_\_row\_color\_top'] = $item + $styles['.stm-header\_\_row\_color\_top']; |
  |  | 254 | } |
  |  | 255 |  |
  |  | 256 | if ( ! empty( $header\_width ) ) { |
  |  | 257 | $item                                    = array( 'max-width' => $header\_width ); |
  |  | 258 | $styles['.stm-header\_\_row\_color\_center'] = $item + $styles['.stm-header\_\_row\_color\_center']; |
  |  | 259 | } |
  |  | 260 |  |
  |  | 261 | if ( ! empty( $bottom\_bar\_width ) ) { |
  |  | 262 | $item                                    = array( 'max-width' => $bottom\_bar\_width ); |
  |  | 263 | $styles['.stm-header\_\_row\_color\_bottom'] = $item + $styles['.stm-header\_\_row\_color\_bottom']; |
  |  | 264 | } |
  |  | 265 |  |
  |  | 266 | foreach ( $styles as $element => $element\_styles ) { |
  |  | 267 | $custom\_css .= "{$element}{"; |
  |  | 268 | foreach ( $element\_styles as $parent\_prop => $parent\_value ) { |
  |  | 269 | if ( ! empty( $parent\_value ) ) { |
  |  | 270 | $helpers = stm\_hb\_get\_style( $parent\_prop ); |
  |  | 271 | $prefix  = $helpers['prefix']; |
  |  | 272 | $affix   = $helpers['affix']; |
  |  | 273 |  |
  |  | 274 | /\*Second lvl\*/ |
  |  | 275 | if ( is\_array( $parent\_value ) ) { |
  |  | 276 | $custom\_css .= "} {$element} {$parent\_prop} {"; |
  |  | 277 | foreach ( $parent\_value as $prop => $value ) { |
  |  | 278 | $helpers = stm\_hb\_get\_style( $parent\_prop ); |
  |  | 279 | $prefix  = $helpers['prefix']; |
  |  | 280 | $affix   = $helpers['affix']; |
  |  | 281 |  |
  |  | 282 | $custom\_css .= "{$prop}:{$prefix}{$value}{$affix};"; |
  |  | 283 | } |
  |  | 284 | } else { |
  |  | 285 | /\*First lvl\*/ |
  |  | 286 | $custom\_css .= "{$parent\_prop}:{$prefix}{$parent\_value}{$affix};"; |
  |  | 287 | } |
  |  | 288 | } |
  |  | 289 | } |
  |  | 290 | $custom\_css .= '}'; |
  |  | 291 | } |
  |  | 292 |  |
  |  | 293 | return $custom\_css; |
  |  | 294 | } |
  |  | 295 |  |
  |  | 296 | public function get\_custom\_styled\_elements\_array() { |
  |  | 297 | $elements\_list = array( |
  |  | 298 | 'colors'        => array( |
  |  | 299 | 'main\_color'      => array( |
  |  | 300 | '.stm\_hb\_mtc', |
  |  | 301 | '.stm\_hb\_mtc\_h:hover', |
  |  | 302 | '.stm\_hb\_mtc\_b:before', |
  |  | 303 | '.stm\_hb\_mtc\_b\_h:hover:before', |
  |  | 304 | '.stm\_hb\_mtc\_a:after', |
  |  | 305 | '.stm\_hb\_mtc\_a\_h:hover:after', |
  |  | 306 | '.stm\_hb\_mtc\_a\_h.active', |
  |  | 307 | '.mini-cart', |
  |  | 308 | ), |
  |  | 309 | 'secondary\_color' => array( |
  |  | 310 | '.stm\_hb\_stc', |
  |  | 311 | '.stm\_hb\_stc\_h:hover', |
  |  | 312 | '.stm\_hb\_stc\_a:after', |
  |  | 313 | '.stm\_hb\_stc\_a\_h:hover:after', |
  |  | 314 | '.stm\_hb\_stc\_b:before', |
  |  | 315 | '.stm\_hb\_stc\_b\_h:hover:before', |
  |  | 316 | ), |
  |  | 317 | 'third\_color'     => array( |
  |  | 318 | '.stm\_hb\_ttc', |
  |  | 319 | '.stm\_hb\_ttc\_h:hover', |
  |  | 320 | '.stm\_hb\_ttc\_a:after', |
  |  | 321 | '.stm\_hb\_ttc\_a\_h:hover:after', |
  |  | 322 | '.stm\_hb\_ttc\_b:before', |
  |  | 323 | '.stm\_hb\_ttc\_b\_h:hover:before', |
  |  | 324 | ), |
  |  | 325 | ), |
  |  | 326 | 'bg\_colors'     => array( |
  |  | 327 | 'main\_color'      => array( |
  |  | 328 | '.stm\_hb\_mbc', |
  |  | 329 | '.stm\_hb\_mbc\_h:hover', |
  |  | 330 | '.stm\_hb\_mbc\_b:before', |
  |  | 331 | '.stm\_hb\_mbc\_b\_h:hover:before', |
  |  | 332 | '.stm\_hb\_mbc\_a:after', |
  |  | 333 | '.stm\_hb\_mbc\_a\_h:hover:after', |
  |  | 334 | '.stm\_hb\_mbc\_h.active', |
  |  | 335 | '.stm-search .stm\_widget\_search button[type=submit]', |
  |  | 336 | ), |
  |  | 337 | 'secondary\_color' => array( |
  |  | 338 | '.stm\_hb\_sbc', |
  |  | 339 | '.stm\_hb\_sbc\_h:hover', |
  |  | 340 | '.stm\_hb\_sbc\_a:after', |
  |  | 341 | '.stm\_hb\_sbc\_a\_h:hover:after', |
  |  | 342 | '.stm\_hb\_sbc\_b:before', |
  |  | 343 | '.stm\_hb\_sbc\_b\_h:hover:before', |
  |  | 344 | ), |
  |  | 345 | 'third\_color'     => array( |
  |  | 346 | '.stm\_hb\_tbc', |
  |  | 347 | '.stm\_hb\_tbc\_h:hover', |
  |  | 348 | '.stm\_hb\_tbc\_h.active', |
  |  | 349 | '.stm\_hb\_tbc\_a:after', |
  |  | 350 | '.stm\_hb\_tbc\_a\_h:hover:after', |
  |  | 351 | '.stm\_hb\_tbc\_b:before', |
  |  | 352 | '.stm\_hb\_tbc\_b\_h:hover:before', |
  |  | 353 | ), |
  |  | 354 | ), |
  |  | 355 | 'border\_colors' => array( |
  |  | 356 | 'main\_color'      => array( |
  |  | 357 | '.stm\_hb\_mbdc', |
  |  | 358 | '.stm\_hb\_mbdc\_h:hover', |
  |  | 359 | '.stm\_hb\_mbdc\_b:before', |
  |  | 360 | '.stm\_hb\_mbdc\_b\_h:hover:before', |
  |  | 361 | '.stm\_hb\_mbdc\_a:after', |
  |  | 362 | '.stm\_hb\_mbdc\_a\_h:hover:after', |
  |  | 363 | '.stm-search .stm\_widget\_search .form-control:focus', |
  |  | 364 | ), |
  |  | 365 | 'secondary\_color' => array( |
  |  | 366 | '.stm\_hb\_sbdc', |
  |  | 367 | '.stm\_hb\_sbdc\_h:hover', |
  |  | 368 | '.stm\_hb\_sbdc\_a:after', |
  |  | 369 | '.stm\_hb\_sbdc\_a\_h:hover:after', |
  |  | 370 | '.stm\_hb\_sbdc\_b:before', |
  |  | 371 | '.stm\_hb\_sbdc\_b\_h:hover:before', |
  |  | 372 |  |
  |  | 373 | ), |
  |  | 374 | 'third\_color'     => array( |
  |  | 375 | '.stm\_hb\_tbdc', |
  |  | 376 | '.stm\_hb\_tbdc\_h:hover', |
  |  | 377 | '.stm\_hb\_tbdc\_a:after', |
  |  | 378 | '.stm\_hb\_tbdc\_a\_h:hover:after', |
  |  | 379 | '.stm\_hb\_tbdc\_b:before', |
  |  | 380 | '.stm\_hb\_tbdc\_b\_h:hover:before', |
  |  | 381 | ), |
  |  | 382 | ), |
  |  | 383 | ); |
  |  | 384 |  |
  |  | 385 | $main\_color      = stm\_hb\_get\_option( 'main\_color', '#297ee8', $this->headerName ); |
  |  | 386 | $secondary\_color = stm\_hb\_get\_option( 'secondary\_color', '#222222', $this->headerName ); |
  |  | 387 | $third\_color     = stm\_hb\_get\_option( 'third\_color', '#297ee8', $this->headerName ); |
  |  | 388 |  |
  |  | 389 | /\*Color\*/ |
  |  | 390 | $colors = $elements\_list['colors']; |
  |  | 391 |  |
  |  | 392 | /\*Background color\*/ |
  |  | 393 | $bg\_colors = $elements\_list['bg\_colors']; |
  |  | 394 |  |
  |  | 395 | /\*Border color\*/ |
  |  | 396 | $border\_colors = $elements\_list['border\_colors']; |
  |  | 397 |  |
  |  | 398 | ob\_start(); |
  |  | 399 | foreach ( $colors as $color => $elements ) { |
  |  | 400 | //phpcs:ignore |
  |  | 401 | echo implode( ',', $elements ); |
  |  | 402 | ?> |
  |  | 403 | {color: <?php echo sanitize\_text\_field( ${$color} );//phpcs:ignore ?> !important} |
  |  | 404 | <?php |
  |  | 405 | } |
  |  | 406 |  |
  |  | 407 | foreach ( $bg\_colors as $bg\_color => $elements ) { |
  |  | 408 | //phpcs:ignore |
  |  | 409 | echo implode( ',', $elements ); |
  |  | 410 | ?> |
  |  | 411 | {background-color: <?php echo sanitize\_text\_field( ${$bg\_color} );//phpcs:ignore ?> !important} |
  |  | 412 | <?php |
  |  | 413 | } |
  |  | 414 |  |
  |  | 415 | foreach ( $border\_colors as $border\_color => $elements ) { |
  |  | 416 | //phpcs:ignore |
  |  | 417 | echo implode( ',', $elements ) |
  |  | 418 | ?> |
  |  | 419 | {border-color: <?php echo sanitize\_text\_field( ${$border\_color} );//phpcs:ignore ?> !important} |
  |  | 420 | <?php |
  |  | 421 | } |
  |  | 422 |  |
  |  | 423 | //Header width |
  |  | 424 | $header\_container\_width = stm\_hb\_get\_option( 'header\_container\_width', false, $this->headerName ); |
  |  | 425 | $header\_content\_width   = stm\_hb\_get\_option( 'header\_content\_width', false, $this->headerName ); |
  |  | 426 |  |
  |  | 427 | if ( ! empty( $header\_container\_width ) ) { |
  |  | 428 | echo ".stm-header{max-width:{$header\_container\_width}px;}";//phpcs:ignore |
  |  | 429 | } |
  |  | 430 |  |
  |  | 431 | if ( ! empty( $header\_content\_width ) ) { |
  |  | 432 | echo ".stm-header\_\_row\_color > .container{max-width:{$header\_content\_width}px;}";//phpcs:ignore |
  |  | 433 | } |
  |  | 434 |  |
  |  | 435 | $styles = ob\_get\_clean(); |
  |  | 436 |  |
  |  | 437 | return $styles; |
  |  | 438 |  |
  |  | 439 | } |
  |  | 440 |  |
  |  | 441 | public function inline\_scripts() { |
  |  | 442 | $styles  = ''; |
  |  | 443 | $styles .= $this->header\_element\_custom\_styles(); |
  |  | 444 | $styles .= $this->header\_elements\_styles(); |
  |  | 445 | $styles .= $this->get\_custom\_styled\_elements\_array(); |
  |  | 446 |  |
  |  | 447 | echo stm\_hb\_text\_sanitize( '<style type="text/css" id="styles-' . esc\_attr( $this->headerName ) . '">' ); //phpcs:ignore |
  |  | 448 | echo stm\_hb\_text\_sanitize( $styles ); //phpcs:ignore |
  |  | 449 | echo stm\_hb\_text\_sanitize( '</style>' );//phpcs:ignore |
  |  | 450 | } |
  |  | 451 |  |
  |  | 452 | } |
  |  | 453 | } |
  |  | 454 |  |
  |  | 455 | function stm\_hb\_get\_option( $option\_name, $default = false, $hb = '' ) { |
  |  | 456 |  |
  |  | 457 | $hb = ! empty( $hb ) ? $hb : 'header\_builder'; |
  |  | 458 |  |
  |  | 459 | $options = get\_option( $hb, array() ); |
  |  | 460 | $option  = null; |
  |  | 461 |  |
  |  | 462 | if ( ! empty( $options[ $option\_name ] ) ) { |
  |  | 463 | $option = $options[ $option\_name ]; |
  |  | 464 | } elseif ( isset( $default ) ) { |
  |  | 465 | $option = $default; |
  |  | 466 | } |
  |  | 467 |  |
  |  | 468 | return $option; |
  |  | 469 | } |
  |  | 470 |  |
  |  | 471 | function stm\_hb( $a ) { |
  |  | 472 | echo '<pre>'; |
  |  | 473 | print\_r( $a ); |
  |  | 474 | echo '</pre>'; |
  |  | 475 | } |
  |  | 476 |  |
  |  | 477 | function stm\_hb\_parts() { |
  |  | 478 | return array( |
  |  | 479 | 'rows'  => array( 'top', 'center', 'bottom' ), |
  |  | 480 | 'cells' => array( 'left', 'center', 'right' ), |
  |  | 481 | ); |
  |  | 482 | } |
  |  | 483 |  |
  |  | 484 | function stm\_hb\_check\_string( $string ) { |
  |  | 485 | return 'true' === $string; |
  |  | 486 | } |
  |  | 487 |  |
  |  | 488 | function stm\_hb\_element\_style( $element ) { |
  |  | 489 | $style\_class = ''; |
  |  | 490 | if ( ! empty( $element['data'] ) && ! empty( $element['data']['style'] ) ) { |
  |  | 491 | $style\_class = $element['data']['style']; |
  |  | 492 | } |
  |  | 493 |  |
  |  | 494 | return " stm-header\_\_element\_{$style\_class}"; |
  |  | 495 | } |
  |  | 496 |  |
  |  | 497 | function stm\_hb\_locate\_builder\_element( $templates, $template\_name, $\_\_folder ) { |
  |  | 498 | $located = false; |
  |  | 499 |  |
  |  | 500 | foreach ( (array) $templates as $template ) { |
  |  | 501 |  |
  |  | 502 | $folder = $template; |
  |  | 503 |  |
  |  | 504 | if ( ! empty( $template\_name ) ) { |
  |  | 505 | $template = $template\_name; |
  |  | 506 | } |
  |  | 507 |  |
  |  | 508 | if ( substr( $template, - 4 ) !== '.php' ) { |
  |  | 509 | $template .= '.php'; |
  |  | 510 | } |
  |  | 511 |  |
  |  | 512 | if ( 'elements' !== $\_\_folder ) { |
  |  | 513 | $base = 'hb\_templates/' . $\_\_folder . '/' . $template; |
  |  | 514 | } else { |
  |  | 515 | $base = 'hb\_templates/' . $\_\_folder . '/' . $folder . '/' . $template; |
  |  | 516 | } |
  |  | 517 | $located = locate\_template( '/' . $base ); |
  |  | 518 | if ( ! ( $located ) ) { |
  |  | 519 | $located = STM\_HB\_DIR . $base; |
  |  | 520 | } |
  |  | 521 |  |
  |  | 522 | if ( file\_exists( $located ) ) { |
  |  | 523 | break; |
  |  | 524 | } |
  |  | 525 | } |
  |  | 526 |  |
  |  | 527 | return apply\_filters( 'stm\_listings\_locate\_template', $located, $templates ); |
  |  | 528 | } |
  |  | 529 |  |
  |  | 530 | function stm\_hb\_load\_element( $\_\_template, $\_\_vars = array(), $\_\_template\_name = '', $\_\_folder = 'elements' ) { |
  |  | 531 | extract( $\_\_vars ); |
  |  | 532 | include stm\_hb\_locate\_builder\_element( $\_\_template, $\_\_template\_name, $\_\_folder ); |
  |  | 533 | } |
  |  | 534 |  |
  |  | 535 | function stm\_get\_assets\_path() { |
  |  | 536 | $assets                    = array(); |
  |  | 537 | $url                       = STM\_HB\_URL; |
  |  | 538 | $assets['css']             = $url . 'assets/admin/assets/css/'; |
  |  | 539 | $assets['frontend\_css']    = $url . 'assets/frontend/assets/css/'; |
  |  | 540 | $assets['frontend\_js']     = $url . 'assets/frontend/assets/js/'; |
  |  | 541 | $assets['frontend\_vendor'] = $url . 'assets/frontend/assets/vendor/'; |
  |  | 542 | $assets['js']              = $url . 'assets/admin/assets/js/'; |
  |  | 543 | $assets['vendors']         = $url . 'assets/admin/assets/vendor/'; |
  |  | 544 | $assets['v']               = WP\_DEBUG ? time() : STM\_HB\_VER; |
  |  | 545 |  |
  |  | 546 | return apply\_filters( 'stm\_get\_assets\_path', $assets ); |
  |  | 547 | } |
  |  | 548 |  |
  |  | 549 | function stm\_hb\_random( $len = 10 ) { |
  |  | 550 | $word = array\_merge( range( 'a', 'z' ), range( 'A', 'Z' ) ); |
  |  | 551 | shuffle( $word ); |
  |  | 552 |  |
  |  | 553 | return substr( implode( $word ), 0, $len ); |
  |  | 554 | } |
  |  | 555 |  |
  |  | 556 | function stm\_hb\_get\_dropdown( $dropdown ) { |
  |  | 557 | $choices = array( |
  |  | 558 | 'first'  => array(), |
  |  | 559 | 'others' => array(), |
  |  | 560 | ); |
  |  | 561 |  |
  |  | 562 | if ( ! empty( $dropdown[0] ) && ! empty( $dropdown[0]['label'] ) ) { |
  |  | 563 | $choices['first'] = $dropdown[0]; |
  |  | 564 | } |
  |  | 565 |  |
  |  | 566 | array\_shift( $dropdown ); |
  |  | 567 |  |
  |  | 568 | if ( ! empty( $dropdown ) ) { |
  |  | 569 | $choices['others'] = $dropdown; |
  |  | 570 | } |
  |  | 571 |  |
  |  | 572 | return $choices; |
  |  | 573 | } |
  |  | 574 |  |
  |  | 575 | function stm\_hb\_array\_to\_style\_string( $arr, $important = false ) { |
  |  | 576 | $important = $important ? '!important' : ''; |
  |  | 577 | $r         = array\_map( |
  |  | 578 | function ( $v, $k ) { |
  |  | 579 | return $k . ':' . $v; |
  |  | 580 | }, |
  |  | 581 | $arr, |
  |  | 582 | array\_keys( $arr ) |
  |  | 583 | ); |
  |  | 584 |  |
  |  | 585 | $r = implode( $important . '; ', $r ) . $important . ';'; |
  |  | 586 |  |
  |  | 587 | return $r; |
  |  | 588 | } |
  |  | 589 |  |
  |  | 590 | function stm\_hb\_get\_wpml\_langs() { |
  |  | 591 | do\_action( 'wpml\_add\_language\_selector' ); |
  |  | 592 |  |
  |  | 593 | if ( defined( 'ICL\_LANGUAGE\_CODE' ) ) { |
  |  | 594 | $current\_language\_code = ICL\_LANGUAGE\_CODE; |
  |  | 595 | $langs                 = icl\_get\_languages( 'skip\_missing=0' ); |
  |  | 596 | $wpml                  = array(); |
  |  | 597 |  |
  |  | 598 | if ( ! empty( $langs ) ) { |
  |  | 599 | if ( ! empty( $langs[ $current\_language\_code ] ) ) { |
  |  | 600 | $current\_language = $langs[ $current\_language\_code ]; |
  |  | 601 | $wpml[]           = array( |
  |  | 602 | 'label' => $current\_language['native\_name'], |
  |  | 603 | 'url'   => $current\_language['url'], |
  |  | 604 | ); |
  |  | 605 | } |
  |  | 606 |  |
  |  | 607 | foreach ( $langs as $lang\_key => $lang\_info ) { |
  |  | 608 | if ( $lang\_key !== $current\_language\_code ) { |
  |  | 609 | $wpml[] = array( |
  |  | 610 | 'label' => $lang\_info['native\_name'], |
  |  | 611 | 'url'   => $lang\_info['url'], |
  |  | 612 | ); |
  |  | 613 | } |
  |  | 614 | } |
  |  | 615 | } |
  |  | 616 | } |
  |  | 617 |  |
  |  | 618 | if ( empty( $langs ) ) { |
  |  | 619 | $wpml = array( |
  |  | 620 | array( |
  |  | 621 | 'label' => esc\_html\_\_( 'English', 'pearl-header-builder' ), |
  |  | 622 | 'url'   => '/', |
  |  | 623 | ), |
  |  | 624 | ); |
  |  | 625 | } |
  |  | 626 |  |
  |  | 627 | return apply\_filters( 'pearl\_get\_wpml\_langs', $wpml ); |
  |  | 628 | } |
  |  | 629 |  |
  |  | 630 | function stm\_hb\_get\_image\_url( $id, $size = 'full' ) { |
  |  | 631 | $url = ''; |
  |  | 632 | if ( ! empty( $id ) ) { |
  |  | 633 | $image = wp\_get\_attachment\_image\_src( $id, $size, false ); |
  |  | 634 | if ( ! empty( $image[0] ) ) { |
  |  | 635 | $url = $image[0]; |
  |  | 636 | } |
  |  | 637 | } |
  |  | 638 |  |
  |  | 639 | return $url; |
  |  | 640 | } |
  |  | 641 |  |
  |  | 642 | function stm\_hb\_color\_treads( $color ) { |
  |  | 643 | $color = ( strlen( $color ) == 6 ) ? "#{$color}" : $color; |
  |  | 644 |  |
  |  | 645 | return apply\_filters( 'pearl\_color\_treads', $color ); |
  |  | 646 | } |
  |  | 647 |  |
  |  | 648 | function stm\_hb\_get\_style( $key = '' ) { |
  |  | 649 | $r = array( |
  |  | 650 | 'prefix' => '', |
  |  | 651 | 'affix'  => '', |
  |  | 652 | ); |
  |  | 653 |  |
  |  | 654 | $metrix = array( |
  |  | 655 | 'padding-top', |
  |  | 656 | 'padding-bottom', |
  |  | 657 | 'margin-top', |
  |  | 658 | 'margin-bottom', |
  |  | 659 | 'line-height', |
  |  | 660 | 'border-width', |
  |  | 661 | 'max-width', |
  |  | 662 | ); |
  |  | 663 |  |
  |  | 664 | $src = array( |
  |  | 665 | 'background-image', |
  |  | 666 | ); |
  |  | 667 |  |
  |  | 668 | /\*Set px\*/ |
  |  | 669 | if ( in\_array( $key, $metrix ) ) { |
  |  | 670 | $r['affix'] = 'px'; |
  |  | 671 | } |
  |  | 672 |  |
  |  | 673 | /\*Set url\*/ |
  |  | 674 | if ( in\_array( $key, $src ) ) { |
  |  | 675 | $r['prefix'] = 'url("'; |
  |  | 676 | $r['affix']  = '")'; |
  |  | 677 | } |
  |  | 678 |  |
  |  | 679 | return apply\_filters( 'stm\_hb\_get\_style', $r ); |
  |  | 680 | } |
  |  | 681 |  |
  |  | 682 | function stm\_hb\_text\_sanitize( $text ) { |
  |  | 683 | return $text; |
  |  | 684 | } |
  |  | 685 |  |
  |  | 686 | function stm\_hb\_get\_cart\_url() { |
  |  | 687 | $cart\_id = get\_option( 'woocommerce\_cart\_page\_id', '' ); |
  |  | 688 |  |
  |  | 689 | return ! empty( $cart\_id ) ? get\_the\_permalink( $cart\_id ) : ''; |
  |  | 690 | } |
  |  | 691 |  |
  |  | 692 | function stm\_hb\_cart\_fragments( $fragments ) { |
  |  | 693 |  |
  |  | 694 | /\*Mini cart\*/ |
  |  | 695 | ob\_start(); |
  |  | 696 | stm\_hb\_load\_element( 'cart', array(), 'mini-cart' ); |
  |  | 697 | $mini\_cart = ob\_get\_contents(); |
  |  | 698 | ob\_end\_clean(); |
  |  | 699 |  |
  |  | 700 | /\*Quantity\*/ |
  |  | 701 | ob\_start(); |
  |  | 702 | stm\_hb\_load\_element( 'cart', array(), 'quantity' ); |
  |  | 703 | $quantity = ob\_get\_contents(); |
  |  | 704 | ob\_end\_clean(); |
  |  | 705 |  |
  |  | 706 | $fragments['.mini-cart']            = $mini\_cart; |
  |  | 707 | $fragments['.cart\_\_quantity-badge'] = $quantity; |
  |  | 708 |  |
  |  | 709 | return $fragments; |
  |  | 710 | } |
  |  | 711 |  |
  |  | 712 | add\_filter( 'woocommerce\_add\_to\_cart\_fragments', 'stm\_hb\_cart\_fragments', 1000, 1 ); |
* ## [pearl-header-builder/trunk/pearl\_header\_builder.php](/changeset/3078437/pearl-header-builder/trunk/pearl_header_builder.php "Show the changeset 3078437 restricted to pearl-header-builder/trunk/pearl_header_builder.php")

  | [r2953612](/browser/pearl-header-builder/trunk/pearl_header_builder.php?rev=2953612#L6 "Show revision 2953612 of this file in browser") | [r3078437](/browser/pearl-header-builder/trunk/pearl_header_builder.php?rev=3078437#L6 "Show revision 3078437 of this file in browser") |  |
  | --- | --- | --- |
  | 6 | 6 | Author: StylemixThemes |
  | 7 | 7 | Author URI: https://stylemixthemes.com |
  | 8 |  | Version: 1.3.~~6~~ |
  |  | 8 | Version: 1.3.7 |
  | 9 | 9 | \*/ |
  | 10 | 10 |  |
  | […](/browser/pearl-header-builder/trunk/pearl_header_builder.php?rev=2953612#L13) | […](/browser/pearl-header-builder/trunk/pearl_header_builder.php?rev=3078437#L13) |  |
  | 13 | 13 | } |
  | 14 | 14 |  |
  | 15 |  | define( 'STM\_HB\_VER', '1.3.~~6~~' ); |
  |  | 15 | define( 'STM\_HB\_VER', '1.3.7' ); |
  | 16 | 16 | define( 'STM\_HB\_DIR', plugin\_dir\_path( \_\_FILE\_\_ ) ); |
  | 17 | 17 | define( 'STM\_HB\_URL', plugins\_url( '/', \_\_FILE\_\_ ) ); |
* ## [pearl-header-builder/trunk/readme.txt](/changeset/3078437/pearl-header-builder/trunk/readme.txt "Show the changeset 3078437 restricted to pearl-header-builder/trunk/readme.txt")

  | [r2953612](/browser/pearl-header-builder/trunk/readme.txt?rev=2953612#L5 "Show revision 2953612 of this file in browser") | [r3078437](/browser/pearl-header-builder/trunk/readme.txt?rev=3078437#L5 "Show revision 3078437 of this file in browser") |  |
  | --- | --- | --- |
  | 5 | 5 | Requires at least: 4.6 |
  | 6 | 6 | Tested up to: 6.3 |
  | 7 |  | Stable tag: 1.3.~~6~~ |
  |  | 7 | Stable tag: 1.3.7 |
  | 8 | 8 | License: GPLv2 or later |
  | 9 | 9 | License URI: https://www.gnu.org/licenses/gpl-2.0.html |
  | […](/browser/pearl-header-builder/trunk/readme.txt?rev=2953612#L123) | […](/browser/pearl-header-builder/trunk/readme.txt?rev=3078437#L123) |  |
  | 123 | 123 | == Changelog == |
  | 124 | 124 |  |
  |  | 125 | = 1.3.7 = |
  |  | 126 | \* Security update |
  |  | 127 |  |
  | 125 | 128 | = 1.3.6 = |
  | 126 | 129 | \* Security update |

**Note:** See [TracChangeset](/wiki/TracChangeset)
for help on using the changeset viewer.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Unified Diff](?format=diff&new=3078437)
* [Zip Archive](?format=zip&new=3078437)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)



=== Content from www.wordfence.com_d03fd6fe_20250111_012808.html ===


[![](https://www.wordfence.com/img/wordfence-intelligence-logo.svg)](/threat-intel/)

Have you found a vulnerability in a WordPress plugin or theme? Report vulnerabilities in WordPress plugins and themes through our [bug bounty program](https://www.wordfence.com/threat-intel/bug-bounty-program) and earn a bounty on all in-scope submissions, while we handle the responsible disclosure process on your behalf.

As a reminder, the Wordfence Intelligence Vulnerability Database API is completely free to query and utilize, both personally and commercially, and contains all the same vulnerability data as the user interface. Please review the API documentation and Webhook documentation for more information on how to query the vulnerability API endpoints and configure webhooks utilizing all the same data present in the Wordfence Intelligence user interface.

# WordPress Header Builder Plugin – Pearl <= 1.3.6 - Authenticated (Contributor+) Stored Cross-Site Scripting via Shortcode

 [Wordfence Intelligence](https://www.wordfence.com/threat-intel)   >    [Vulnerability Database](https://www.wordfence.com/threat-intel/vulnerabilities)   >   WordPress Header Builder Plugin – Pearl <= 1.3.6 - Authenticated (Contributor+) Stored Cross-Site Scripting via Shortcode

6.4

**Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')**
**CVSS Vector**
[CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:N)

| CVE | [CVE-2024-4000](https://www.cve.org/CVERecord?id=CVE-2024-4000) |
| --- | --- |
| CVSS | 6.4 (Medium) |
| Publicly Published | April 30, 2024 |
| Last Updated | May 2, 2024 |
| Researcher | [Krzysztof Zając - CERT PL](https://www.wordfence.com/threat-intel/vulnerabilities/researchers/krzysztof-zajac) |

### Description

The WordPress Header Builder Plugin – Pearl plugin for WordPress is vulnerable to Stored Cross-Site Scripting via the plugin's 'stm\_hb' shortcode in all versions up to, and including, 1.3.6 due to insufficient input sanitization and output escaping on user supplied attributes. This makes it possible for authenticated attackers, with contributor-level access and above, to inject arbitrary web scripts in pages that will execute whenever a user accesses an injected page.

#### References

* [plugins.trac.wordpress.org](https://plugins.trac.wordpress.org/changeset?sfp_email=&sfph_mail=&reponame=&old=3078437%40pearl-header-builder&new=3078437%40pearl-header-builder&sfp_email=&sfph_mail=)

#### Share

[Facebook](https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fpearl-header-builder%2Fwordpress-header-builder-plugin-pearl-136-authenticated-contributor-stored-cross-site-scripting-via-shortcode&t=WordPress%20Header%20Builder%20Plugin%20%E2%80%93%20Pearl%20%3C%3D%201.3.6%20-%20Authenticated%20%28Contributor%2B%29%20Stored%20Cross-Site%20Scripting%20via%20Shortcode "Facebook")
[Twitter](https://twitter.com/share?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fpearl-header-builder%2Fwordpress-header-builder-plugin-pearl-136-authenticated-contributor-stored-cross-site-scripting-via-shortcode&text=WordPress%20Header%20Builder%20Plugin%20%E2%80%93%20Pearl%20%3C%3D%201.3.6%20-%20Authenticated%20%28Contributor%2B%29%20Stored%20Cross-Site%20Scripting%20via%20Shortcode "Twitter")
[LinkedIn](https://www.linkedin.com/shareArticle?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fpearl-header-builder%2Fwordpress-header-builder-plugin-pearl-136-authenticated-contributor-stored-cross-site-scripting-via-shortcode "LinkedIn")
Email

## Vulnerability Details for WordPress Header Builder Plugin – Pearl

#### [WordPress Header Builder Plugin – Pearl](https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/pearl-header-builder)

| Software Type | Plugin |
| --- | --- |
| Software Slug | pearl-header-builder [(view on wordpress.org)](https://wordpress.org/plugins/pearl-header-builder) |
| Patched? | Yes |
| Remediation | Update to version 1.3.7, or a newer patched version |
| Affected Version | * <= 1.3.6 |
| Patched Version | * 1.3.7 |

This record contains material that is subject to copyright.

**Copyright 2012-2025 Defiant Inc.**

**License:**
Defiant hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute this software vulnerability information. Any copy of the software vulnerability information you make for such purposes is authorized provided that you include a hyperlink to this vulnerability record and reproduce Defiant's copyright designation and this license in any such copy.
**[Read more.](https://www.wordfence.com/wordfence-intelligence-terms-and-conditions/)**

**Copyright 1999-2025 The MITRE Corporation**

**License:**
CVE Usage: MITRE hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute Common Vulnerabilities and Exposures (CVE®). Any copy you make for such purposes is authorized provided that you reproduce MITRE's copyright designation and this license in any such copy.
**[Read more.](https://www.cve.org/Legal/TermsOfUse)**

Have information to add, or spot any errors? Contact us at wfi-support@wordfence.com so we can make any appropriate adjustments.

Did you know Wordfence Intelligence provides free personal and commercial API access to our comprehensive WordPress vulnerability database, along with a free webhook integration to stay on top of the latest vulnerabilities added and updated in the database? Get started today!

Learn more

Want to get notified of the latest vulnerabilities that may affect your WordPress site?
 Install Wordfence on your site today to get notified immediately if your site is affected by a vulnerability that has been added to our database.

Get Wordfence

The Wordfence Intelligence WordPress vulnerability database is completely free to access and query via API. Please review the documentation on how to access and consume the vulnerability data via API.

Documentation


