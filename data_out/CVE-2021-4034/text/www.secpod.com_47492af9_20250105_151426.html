
[Skip to content](#main)
[![SecPod Blog](https://www.secpod.com/blog/wp-content/uploads/2024/02/SecPod-Logo-Full-Light-Background.png)](https://www.secpod.com)

* [Blog Home](https://www.secpod.com/blog/)
* [Topics](https://www.secpod.com/blog/)
  + [All Articles](/blog/?post_type=post)
  + [Security Research and Intelligence](https://www.secpod.com/blog/category/security-research/)
  + [Endpoint Security and Management](https://www.secpod.com/blog/category/endpoint-security/)
    - [Vulnerability Management](https://www.secpod.com/blog/category/endpoint-security/vulnerability-management/)
    - [Patch Management](https://www.secpod.com/blog/category/endpoint-security/patch-management/)
    - [Endpoint Security](https://www.secpod.com/blog/category/endpoint-security/endpoint-security-endpoint-security/)
    - [Endpoint Management](https://www.secpod.com/blog/category/endpoint-security/endpoint-management/)
    - [IT Asset Management](https://www.secpod.com/blog/category/endpoint-security/it-asset-management/)
    - [Regulatory Compliance](https://www.secpod.com/blog/category/endpoint-security/regulatory-compliance/)
    - [Threat Detection and Response](https://www.secpod.com/blog/category/endpoint-security/threat-detection-and-response/)
  + [Product Releases](https://www.secpod.com/blog/category/product-release-updates/)
  + [Technology and Trends](https://www.secpod.com/blog/category/technology-and-trends/)
    - [Artificial Intelligence](https://www.secpod.com/blog/category/technology-and-trends/artificial-intelligence/)
    - [Computer Engineering](https://www.secpod.com/blog/category/technology-and-trends/computer-engineering/)
    - [COVID-19](https://www.secpod.com/blog/category/technology-and-trends/covid-19/)
    - [Cyber Hygiene Framework](https://www.secpod.com/blog/category/technology-and-trends/cyber-hygiene/)
    - [Remote Work](https://www.secpod.com/blog/category/technology-and-trends/remote-work/)
    - [Security Automation](https://www.secpod.com/blog/category/technology-and-trends/security-automation/)
  + [SecPod Culture](https://www.secpod.com/blog/category/culture/)
  + [From CEO’s Desk](https://www.secpod.com/blog/category/culture/ceo-speak/)
* More
  + [Request a Product Demo](https://www.secpod.com/schedule-demo/)
  + [About SecPod](https://www.secpod.com/about-us/)
  + [Community Center](https://community.secpod.com/)
  + [Knowledge Base](https://docs.secpod.com/)
  + [Security & Privacy](https://security.secpod.com/)
  + [Get Support](https://support.secpod.com/)
* [SUBSCRIBE NEWSLETTER](/blog/newsletter/)
* [Toggle website search](https://www.secpod.com/blog/)

Search this website

[Menu
Close](https://www.secpod.com/blog/#mobile-menu-toggle)

* [Blog Home](https://www.secpod.com/blog/)
* [Topics](https://www.secpod.com/blog/)
  + [All Articles](/blog/?post_type=post)
  + [Security Research and Intelligence](https://www.secpod.com/blog/category/security-research/)
  + [Endpoint Security and Management](https://www.secpod.com/blog/category/endpoint-security/)
    - [Vulnerability Management](https://www.secpod.com/blog/category/endpoint-security/vulnerability-management/)
    - [Patch Management](https://www.secpod.com/blog/category/endpoint-security/patch-management/)
    - [Endpoint Security](https://www.secpod.com/blog/category/endpoint-security/endpoint-security-endpoint-security/)
    - [Endpoint Management](https://www.secpod.com/blog/category/endpoint-security/endpoint-management/)
    - [IT Asset Management](https://www.secpod.com/blog/category/endpoint-security/it-asset-management/)
    - [Regulatory Compliance](https://www.secpod.com/blog/category/endpoint-security/regulatory-compliance/)
    - [Threat Detection and Response](https://www.secpod.com/blog/category/endpoint-security/threat-detection-and-response/)
  + [Product Releases](https://www.secpod.com/blog/category/product-release-updates/)
  + [Technology and Trends](https://www.secpod.com/blog/category/technology-and-trends/)
    - [Artificial Intelligence](https://www.secpod.com/blog/category/technology-and-trends/artificial-intelligence/)
    - [Computer Engineering](https://www.secpod.com/blog/category/technology-and-trends/computer-engineering/)
    - [COVID-19](https://www.secpod.com/blog/category/technology-and-trends/covid-19/)
    - [Cyber Hygiene Framework](https://www.secpod.com/blog/category/technology-and-trends/cyber-hygiene/)
    - [Remote Work](https://www.secpod.com/blog/category/technology-and-trends/remote-work/)
    - [Security Automation](https://www.secpod.com/blog/category/technology-and-trends/security-automation/)
  + [SecPod Culture](https://www.secpod.com/blog/category/culture/)
  + [From CEO’s Desk](https://www.secpod.com/blog/category/culture/ceo-speak/)
* More
  + [Request a Product Demo](https://www.secpod.com/schedule-demo/)
  + [About SecPod](https://www.secpod.com/about-us/)
  + [Community Center](https://community.secpod.com/)
  + [Knowledge Base](https://docs.secpod.com/)
  + [Security & Privacy](https://security.secpod.com/)
  + [Get Support](https://support.secpod.com/)
* [SUBSCRIBE NEWSLETTER](/blog/newsletter/)
* [Toggle website search](https://www.secpod.com/blog/)

![You are currently viewing PwnKit Linux vulnerability Jan-2022: Local Privilege Escalation Vulnerability In Major Linux Distributions](https://www.secpod.com/blog/wp-content/uploads/2022/01/Local-Privilege-Escalation-bug-affects-major-Linux-distros-1.png)

# PwnKit Linux vulnerability Jan-2022: Local Privilege Escalation Vulnerability In Major Linux Distributions

* Post author:[Mohamed Faiz](https://www.secpod.com/blog/author/mohamed/ "Posts by Mohamed Faiz")
* Post published:January 28, 2022
* Reading time:9 mins read

Most of the Linux distributions have the **pkexec binary**. The vulnerability **([CVE-2021-4034](https://www.scaprepo.com/view.jsp?id=CVE-2021-4034))** lies in that binary. The pkexec is a part PwnKit Linux vulnerability Jan-2022, which affects the Polkit open-source application framework used for interaction between privileged and unprivileged processes. Furthermore, the affected binary can also allow executing commands with elevated privileges. A [patch management software](https://www.secpod.com/patch-management/) can help deploy the patches more efficiently.

The vulnerability has existed for about 12 years since the release of version 0.113 of the pkexec component. Almost all of the popular Linux distros are affected, including RHEL, Fedora, Debian, CentOS, and many unknown Linux distros, along with the uneven versions of those distros. Moreover, having a fast scanning [vulnerability management tool](https://www.secpod.com/vulnerability-management/) can be a benefit most of the times.

---

### **Vulnerability Details of PwnKit Linux vulnerability Jan-2022**

The pkexec command in Polkit has a **memory corruption vulnerability** that leads to local privilege escalation. This vulnerability allows a regular user to elevate to root. A remote**attack is not possible** with this particular flaw. Any person having access to a non-privileged user in a system can exploit this vulnerability to **gain the privileges of a root user**.

Could you look at the PwnKit Linux vulnerability Jan-2022 code snippet from the pkexec binary?

> ———————————————————————–
>
> 534        for (n = 1; n < (guint) argc; n++) { ….. }
>
> 610        path = g\_strdup (argv[n]);
>
> 629        if (path[0] != ‘/’) {
>
> 632        s = g\_find\_program\_in\_path (path);
>
> 639        argv[n] = path = s;
>
> 640        }
>
> ————————————————————————

* The binary pkexec expects an argument (A command will be passed as an argument). If pkexec command is executed without an argument, in the main program, at line 534, argc value will be 0.
* But the ‘for loop’ is initiated with **n=1**.
* So the argv[n] in line 610, will read out-of-bounds value from argv[1].
* The out-of-bounds argv[1] points to the first environment variable, “value.”
* The obtained path, “value” is passed to a function g\_find\_program\_in\_path(path) in line 632, because “value” is not starting with ‘/’ (as per the condition in line 629).
* The g\_find\_program\_in\_path function searches the binary “value” path in the PATH environment variables. As a result, the ‘s’ variable will have the full path of the executable binary, if and only if the binary exists, and at last, the full path of the “value” binary is written out-of-bounds to argv[n] (i.e., argv[1]).

Moreover, the above part of the snippet allows the attacker to **craft malicious environment variables** and run it as a command using pkexec to **attain the privilege escalation** which will remove the PwnKit [Linux vulnerability](https://www.secpod.com/vulnerability-management/) Jan-2022

---

### **Exploit Snippet**

SecPod Security Research Team exploited this vulnerability to gain further technical details.

> $ ls -l /usr/bin/pkexec
>
> -rwsr-xr-x 1 root root 23376 Mar 27 2019 /usr/bin/pkexec

* Give front on what is suid.

> $ id
>
> uid=1001(secpod) gid=1001(secpod) groups=1001(secpod),4(adm),27(sudo),113(lpadmin),128(sambashare)

* Logged in with a user with less privileges named “secpod” having uid “1001.”

> $ ./cve-2021-4034
>
> # id
>
> uid=0(root) gid=0(root) groups=0(root),4(adm),27(sudo),113(lpadmin),128(sambashare),1001(secpod)
>
> # whoami
>
> root

* As soon as secpod user performs the exploit, we get access to the root shell.

---

### **Publicly available Exploits of PwnKit Linux vulnerability Jan-2022**

Individuals coined many exploits as soon as the technical details of the PwnKit Linux Vulnerability Jan-2022 ([CVE-2021-4034](https://www.scaprepo.com/view.jsp?id=CVE-2021-4034)) became public. Some of the links for the exploit are as follows:

> <https://github.com/Ayrx/CVE-2021-4034>
>
> <https://github.com/berdav/CVE-2021-4034>
>
> <https://github.com/arthepsy/CVE-2021-4034>
>
> <https://github.com/ryaagard/CVE-2021-4034>
>
> <https://github.com/joeammond/CVE-2021-4034>

---

**Impact**

Meanwhile, successful exploitation of this vulnerability could allow any non-privileged user to gain root access.

---

**Mitigation**

You can use SanerNow to detect and [mitigate this vulnerability](https://www.secpod.com/patch-management/). (PwnKit Linux vulnerability Jan-2022)

All major vendors have published fixes for their respective OS. In addition, **Ubuntu** has provided an update for PolicyKit to address the vulnerability in versions 14.04 and 16.04 ESM (extended security maintenance) and more recent versions of ubuntu, such as 18.04 20.04, and 21.04.

**Red Hat** also released a security update for PolicyKit on Workstation and Enterprise products and extended life cycle support, AUS, and TUS.

**SUSE** and **Debian** also have released fixes for this vulnerability for most of their supported versions.

---

#### **Other Workarounds and Mitigation**

For systems that cannot use SanerNow or if the security update of the specific vendor has not published a fix, you can use the following walkaround to mitigate this vulnerability temporarily.

> # chmod u-s /usr/bin/pkexec

The above command will remove SUID-bit from pkexec command.

SanerNow can also mitigate the PwnKit Linux vulnerability Jan-2022 by using the attached [mitigation\_script](https://www.secpod.com/blog/wp-content/uploads/2022/01/polkit_mitigation.zip).

Note: The mitigation will remove SUID-bit from pkexec command. To roll back from the mitigation, use the attached [rollback\_script](https://www.secpod.com/blog/wp-content/uploads/2022/01/polkit_rollback.zip).

* First login to the SanerNow platform
* Switch to the account/site-specific view and Go to the ‘VM tool’.
* If your application is vulnerable, Saner lists the above CVE in ‘Top Vulnerabilities’ or ‘Recently Discovered Vulnerabilities’
* Search for this vulnerability in the VM tool. If you are affected, apply the workaround through EM -> Actions.

[![Apply EM actions to mitigate PwnKit Linux vulnerability](https://www.secpod.com/blog/wp-content/uploads/2022/01/Selection_009-e1643375239859.png)](https://www.secpod.com/blog/wp-content/uploads/2022/01/Selection_009.png)

[![](https://www.secpod.com/blog/wp-content/uploads/2021/12/Selection_010.png)](https://www.secpod.com/blog/wp-content/uploads/2021/12/Selection_010.png)

* Select ‘Software Deployment’ under Actions in EM tool as shown below:

[![](https://www.secpod.com/blog/wp-content/uploads/2021/12/Selection_011.png)](https://www.secpod.com/blog/wp-content/uploads/2021/12/Selection_011.png)

* Next, we can select ‘Upload’ as shown below:

[![Press upload in software deployment dashboard](https://www.secpod.com/blog/wp-content/uploads/2021/12/Selection_012.png)](https://www.secpod.com/blog/wp-content/uploads/2021/12/Selection_012.png)

* This will prompt for uploading software package then select ‘Compressed Installer Packages’ and upload the compressed file.

[![Upload software package](https://www.secpod.com/blog/wp-content/uploads/2021/12/Selection_013.png)](https://www.secpod.com/blog/wp-content/uploads/2021/12/Selection_013.png)

* Once you upload the file, select the file and click on ‘Edit then edit the file by specifying the relevant OS as ‘Family,’ the extraction location as ‘Extract Location’ where you should extract the compressed file, and the file’s name in the ‘Run File’ option as shown.

[![](https://www.secpod.com/blog/wp-content/uploads/2022/01/Selection_025.png)](https://www.secpod.com/blog/wp-content/uploads/2022/01/Selection_025.png)

* Select ‘Update Details’, and the compressed file will update with all the newly added details.

[![](https://www.secpod.com/blog/wp-content/uploads/2022/01/Selection_026.png)](https://www.secpod.com/blog/wp-content/uploads/2022/01/Selection_026.png)

* After the update click on the refresh button and select the file. Click on install.

[![](https://www.secpod.com/blog/wp-content/uploads/2022/01/Selection_027.png)](https://www.secpod.com/blog/wp-content/uploads/2022/01/Selection_027.png)

* In addition, select the affected devices where you need to apply the mitigation.

[![](https://www.secpod.com/blog/wp-content/uploads/2021/12/Selection_022.png)](https://www.secpod.com/blog/wp-content/uploads/2021/12/Selection_022.png)

* Update the “Task Name”, “Schedule” the remediation and populate “Reboot Schedule” as required and click on Create Installation task

[![Create installation task to mitigate PwnKit Linux vulnerability](https://www.secpod.com/blog/wp-content/uploads/2022/01/Selection_028.png)](https://www.secpod.com/blog/wp-content/uploads/2022/01/Selection_028.png)

* Once you create the task, it will initiate the job and redirect you to the below-mentioned page:

[![](https://www.secpod.com/blog/wp-content/uploads/2022/01/Selection_029.png)](https://www.secpod.com/blog/wp-content/uploads/2022/01/Selection_029.png)

---

Therefore, with **SanerNow**, you can quickly detect and mitigate the Polkit vulnerability in your network. We built **SanerNow [Vulnerability Management](https://www.secpod.com/vulnerability-management/)** on our home-grown world’s largest vulnerability database, which includes 160,000+ security checks. [SanerNow](https://sanernow.com/) offers the industry’s fastest vulnerability scanning techniques to detect vulnerabilities in less than 5 minutes.

## Read more articles

 [Previous PostApple Critical Security Updates January 2022](https://www.secpod.com/blog/apple-critical-security-updates-january-2022/) [Next PostMost Painful Products that Keep IT Security Admins Up on their Toes](https://www.secpod.com/blog/most-painful-products-that-keep-it-security-admins-up-on-their-toes/)

Copyright 2024 - [SecPod](https://secpod.com). All Rights Reserved.

