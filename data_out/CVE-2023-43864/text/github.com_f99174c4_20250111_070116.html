
[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FYTrick%2Fvuln%2Fblob%2Fmain%2FDIR-619L%2520Buffer%2520Overflow_1.md)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FYTrick%2Fvuln%2Fblob%2Fmain%2FDIR-619L%2520Buffer%2520Overflow_1.md)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=YTrick%2Fvuln)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[YTrick](/YTrick)
/
**[vuln](/YTrick/vuln)**
Public

* [Notifications](/login?return_to=%2FYTrick%2Fvuln) You must be signed in to change notification settings
* [Fork
  0](/login?return_to=%2FYTrick%2Fvuln)
* [Star
   0](/login?return_to=%2FYTrick%2Fvuln)

* [Code](/YTrick/vuln)
* [Issues
  0](/YTrick/vuln/issues)
* [Pull requests
  0](/YTrick/vuln/pulls)
* [Actions](/YTrick/vuln/actions)
* [Projects
  0](/YTrick/vuln/projects)
* [Security](/YTrick/vuln/security)
* [Insights](/YTrick/vuln/pulse)

Additional navigation options

* [Code](/YTrick/vuln)
* [Issues](/YTrick/vuln/issues)
* [Pull requests](/YTrick/vuln/pulls)
* [Actions](/YTrick/vuln/actions)
* [Projects](/YTrick/vuln/projects)
* [Security](/YTrick/vuln/security)
* [Insights](/YTrick/vuln/pulse)

## Files

 main
## Breadcrumbs

1. [vuln](/YTrick/vuln/tree/main)
/
# DIR-619L Buffer Overflow\_1.md

Copy path Blame  Blame
## Latest commit

## History

[History](/YTrick/vuln/commits/main/DIR-619L%20Buffer%20Overflow_1.md)140 lines (69 loc) · 5.64 KB main
## Breadcrumbs

1. [vuln](/YTrick/vuln/tree/main)
/
# DIR-619L Buffer Overflow\_1.md

Top
## File metadata and controls

* Preview
* Code
* Blame

140 lines (69 loc) · 5.64 KB[Raw](https://github.com/YTrick/vuln/raw/refs/heads/main/DIR-619L%20Buffer%20Overflow_1.md)
# DIR-619L Buffer Overflow

**Vulnerability description**

D-Link DIR-619L B1 2.02 was found to contain a stack overflow in multiple functions. This vulnerability allows attackers to trigger a denial of service (DoS) through web page parameters.

[![image](https://private-user-images.githubusercontent.com/57278844/268900651-56525b82-fc9d-454c-8ed6-db0c44513cf8.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1NzkxNzYsIm5iZiI6MTczNjU3ODg3NiwicGF0aCI6Ii81NzI3ODg0NC8yNjg5MDA2NTEtNTY1MjViODItZmM5ZC00NTRjLThlZDYtZGIwYzQ0NTEzY2Y4LnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDA3MDExNlomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWVlN2I5MmI1OTk3NDRmNzk0YTk5MTA3NzFjYTVkZmZjZmU4Yzc0NDQzOWM1NjFlMWU4M2E2MmE1ZjAxM2E1MWQmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.Tat0VAvmj3ewkQG0lrLc1oYmDRjYptx590PvXsAoUZA)](https://private-user-images.githubusercontent.com/57278844/268900651-56525b82-fc9d-454c-8ed6-db0c44513cf8.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1NzkxNzYsIm5iZiI6MTczNjU3ODg3NiwicGF0aCI6Ii81NzI3ODg0NC8yNjg5MDA2NTEtNTY1MjViODItZmM5ZC00NTRjLThlZDYtZGIwYzQ0NTEzY2Y4LnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDA3MDExNlomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWVlN2I5MmI1OTk3NDRmNzk0YTk5MTA3NzFjYTVkZmZjZmU4Yzc0NDQzOWM1NjFlMWU4M2E2MmE1ZjAxM2E1MWQmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.Tat0VAvmj3ewkQG0lrLc1oYmDRjYptx590PvXsAoUZA)

## 1.formSetWAN\_Wizard534 Function

### Vulnerability analysis

The websGetVar function obtains the curtime parameter from the front-end and stores the data on the stack through the sprintf function. However, due to the lack of data length restrictions, a buffer overflow vulnerability is created.

[![image](https://private-user-images.githubusercontent.com/57278844/268900694-29142d71-caf9-4df6-bf57-cbed92fa38b8.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1NzkxNzYsIm5iZiI6MTczNjU3ODg3NiwicGF0aCI6Ii81NzI3ODg0NC8yNjg5MDA2OTQtMjkxNDJkNzEtY2FmOS00ZGY2LWJmNTctY2JlZDkyZmEzOGI4LnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDA3MDExNlomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWFiZDZhZDc4YjZmZWVjZGU1NzIzOGE1NjQxMGNkMTI4OThiNGUzZGEyM2EzZDZmZmIwOWQyYTc5NDcwMGYyZjAmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.go29aA91qFMotRywl65BhWytknCsYJjbXnDblTZdOVw)](https://private-user-images.githubusercontent.com/57278844/268900694-29142d71-caf9-4df6-bf57-cbed92fa38b8.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1NzkxNzYsIm5iZiI6MTczNjU3ODg3NiwicGF0aCI6Ii81NzI3ODg0NC8yNjg5MDA2OTQtMjkxNDJkNzEtY2FmOS00ZGY2LWJmNTctY2JlZDkyZmEzOGI4LnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDA3MDExNlomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWFiZDZhZDc4YjZmZWVjZGU1NzIzOGE1NjQxMGNkMTI4OThiNGUzZGEyM2EzZDZmZmIwOWQyYTc5NDcwMGYyZjAmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.go29aA91qFMotRywl65BhWytknCsYJjbXnDblTZdOVw)

### POC

[![image](https://private-user-images.githubusercontent.com/57278844/268900722-ec53fd61-5ed5-4c80-8f0c-846f36967a61.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1NzkxNzYsIm5iZiI6MTczNjU3ODg3NiwicGF0aCI6Ii81NzI3ODg0NC8yNjg5MDA3MjItZWM1M2ZkNjEtNWVkNS00YzgwLThmMGMtODQ2ZjM2OTY3YTYxLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDA3MDExNlomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTk4NjY3OWNlZWI5NzE0MTQxMjc2NTYzMGEyMWUxM2Y1OTI1MzNjNTViYjNhY2MwYjZkN2Y4YTM1NzU1MTRkNTUmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.s2egOoGmtBNDGMVEeh-clKZqYx2OVjJXRz3qXAWy8cg)](https://private-user-images.githubusercontent.com/57278844/268900722-ec53fd61-5ed5-4c80-8f0c-846f36967a61.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1NzkxNzYsIm5iZiI6MTczNjU3ODg3NiwicGF0aCI6Ii81NzI3ODg0NC8yNjg5MDA3MjItZWM1M2ZkNjEtNWVkNS00YzgwLThmMGMtODQ2ZjM2OTY3YTYxLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDA3MDExNlomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTk4NjY3OWNlZWI5NzE0MTQxMjc2NTYzMGEyMWUxM2Y1OTI1MzNjNTViYjNhY2MwYjZkN2Y4YTM1NzU1MTRkNTUmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.s2egOoGmtBNDGMVEeh-clKZqYx2OVjJXRz3qXAWy8cg)

## 2.formSetWAN\_Wizard55 Function

### Vulnerability analysis

The websGetVar function obtains the curtime parameter from the front-end and stores the data on the stack through the sprintf function. However, due to the lack of data length restrictions, a buffer overflow vulnerability is created.

[![image](https://private-user-images.githubusercontent.com/57278844/268900758-3ded85f2-f0ba-4699-a2cb-31279555aa3c.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1NzkxNzYsIm5iZiI6MTczNjU3ODg3NiwicGF0aCI6Ii81NzI3ODg0NC8yNjg5MDA3NTgtM2RlZDg1ZjItZjBiYS00Njk5LWEyY2ItMzEyNzk1NTVhYTNjLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDA3MDExNlomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWQ2NjgyYjY3N2Q2NzA3NzcyMmE5NjNhMzY0ZDkxNDM2NzhlMmZlMWQxNWFjYjdiZDc3Y2UxNWFiZjRkMDdkOTUmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.KTMVOT5kwDVTmBiiU23IHE_CVVE8to6ZMw_VUO3VgvE)](https://private-user-images.githubusercontent.com/57278844/268900758-3ded85f2-f0ba-4699-a2cb-31279555aa3c.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1NzkxNzYsIm5iZiI6MTczNjU3ODg3NiwicGF0aCI6Ii81NzI3ODg0NC8yNjg5MDA3NTgtM2RlZDg1ZjItZjBiYS00Njk5LWEyY2ItMzEyNzk1NTVhYTNjLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDA3MDExNlomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWQ2NjgyYjY3N2Q2NzA3NzcyMmE5NjNhMzY0ZDkxNDM2NzhlMmZlMWQxNWFjYjdiZDc3Y2UxNWFiZjRkMDdkOTUmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.KTMVOT5kwDVTmBiiU23IHE_CVVE8to6ZMw_VUO3VgvE)

### POC

[![image](https://private-user-images.githubusercontent.com/57278844/268900777-be34139a-8148-4167-95d5-68808071f4e2.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1NzkxNzYsIm5iZiI6MTczNjU3ODg3NiwicGF0aCI6Ii81NzI3ODg0NC8yNjg5MDA3NzctYmUzNDEzOWEtODE0OC00MTY3LTk1ZDUtNjg4MDgwNzFmNGUyLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDA3MDExNlomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTQ2MWUyNTVlODU1ZjdlZmYwMDlmMWY1YzY0MzFlY2M2ZjA2OTYwODZiMDQ4NWExNTY3ZTI2NThkZTA4NTUxNzYmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.YN7kyO0DEppQM1OD-QWXM7zAjJtUObPTGZxS33wCK-0)](https://private-user-images.githubusercontent.com/57278844/268900777-be34139a-8148-4167-95d5-68808071f4e2.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1NzkxNzYsIm5iZiI6MTczNjU3ODg3NiwicGF0aCI6Ii81NzI3ODg0NC8yNjg5MDA3NzctYmUzNDEzOWEtODE0OC00MTY3LTk1ZDUtNjg4MDgwNzFmNGUyLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDA3MDExNlomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTQ2MWUyNTVlODU1ZjdlZmYwMDlmMWY1YzY0MzFlY2M2ZjA2OTYwODZiMDQ4NWExNTY3ZTI2NThkZTA4NTUxNzYmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.YN7kyO0DEppQM1OD-QWXM7zAjJtUObPTGZxS33wCK-0)

## 3.formSetWAN\_Wizard56 Function

### Vulnerability analysis

The websGetVar function obtains the curtime parameter from the front-end and stores the data on the stack through the sprintf function. However, due to the lack of data length restrictions, a buffer overflow vulnerability is created.

[![image](https://private-user-images.githubusercontent.com/57278844/268900805-4833e3c3-61f4-4180-882d-b2223c9eaffe.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1NzkxNzYsIm5iZiI6MTczNjU3ODg3NiwicGF0aCI6Ii81NzI3ODg0NC8yNjg5MDA4MDUtNDgzM2UzYzMtNjFmNC00MTgwLTg4MmQtYjIyMjNjOWVhZmZlLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDA3MDExNlomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTFmNDY4ZDhkZjk1YjhhNmQyMTYwMzU5Y2EyOTg5YjQxNjZmYTFkODZmNTcxNjUyNGUwY2Q1MDE5M2ExYmU4ZDAmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.pG3RnvXPogQV3QKf0ui9iZ5nToJpXXVB5AsqFCjhk4g)](https://private-user-images.githubusercontent.com/57278844/268900805-4833e3c3-61f4-4180-882d-b2223c9eaffe.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1NzkxNzYsIm5iZiI6MTczNjU3ODg3NiwicGF0aCI6Ii81NzI3ODg0NC8yNjg5MDA4MDUtNDgzM2UzYzMtNjFmNC00MTgwLTg4MmQtYjIyMjNjOWVhZmZlLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDA3MDExNlomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTFmNDY4ZDhkZjk1YjhhNmQyMTYwMzU5Y2EyOTg5YjQxNjZmYTFkODZmNTcxNjUyNGUwY2Q1MDE5M2ExYmU4ZDAmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.pG3RnvXPogQV3QKf0ui9iZ5nToJpXXVB5AsqFCjhk4g)

### POC

[![image](https://private-user-images.githubusercontent.com/57278844/268900830-45dd2c19-793a-42a9-ab6b-01fab2170336.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1NzkxNzYsIm5iZiI6MTczNjU3ODg3NiwicGF0aCI6Ii81NzI3ODg0NC8yNjg5MDA4MzAtNDVkZDJjMTktNzkzYS00MmE5LWFiNmItMDFmYWIyMTcwMzM2LnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDA3MDExNlomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTljZjFmNGQ3YmY0OGRmNmZiYjg2NGU1MmM2ZGU2YTFhYWJkMGIxODA0MDUxNjRmMGQ1NjIyMDVkZGVkMTA5NTUmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.kDWZLWEcJ_0gET8gxAzwNMgygRPLJ4WtcXlStx6c50o)](https://private-user-images.githubusercontent.com/57278844/268900830-45dd2c19-793a-42a9-ab6b-01fab2170336.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1NzkxNzYsIm5iZiI6MTczNjU3ODg3NiwicGF0aCI6Ii81NzI3ODg0NC8yNjg5MDA4MzAtNDVkZDJjMTktNzkzYS00MmE5LWFiNmItMDFmYWIyMTcwMzM2LnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDA3MDExNlomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTljZjFmNGQ3YmY0OGRmNmZiYjg2NGU1MmM2ZGU2YTFhYWJkMGIxODA0MDUxNjRmMGQ1NjIyMDVkZGVkMTA5NTUmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.kDWZLWEcJ_0gET8gxAzwNMgygRPLJ4WtcXlStx6c50o)

## 4.formSetWAN\_Wizard7 Function

### Vulnerability analysis

The websGetVar function obtains the curtime parameter from the front-end and stores the data on the stack through the sprintf function. However, due to the lack of data length restrictions, a buffer overflow vulnerability is created.

[![image](https://private-user-images.githubusercontent.com/57278844/268900864-971cb899-67bd-460c-b750-aabacfacae50.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1NzkxNzYsIm5iZiI6MTczNjU3ODg3NiwicGF0aCI6Ii81NzI3ODg0NC8yNjg5MDA4NjQtOTcxY2I4OTktNjdiZC00NjBjLWI3NTAtYWFiYWNmYWNhZTUwLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDA3MDExNlomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTBlZWY4NTUwZDBjMmFiOTFjMzRiMzNlZWIwNDc0NTAzNGE1M2QyNjRlM2RjZDE2MTU5YzFkZjRiNzQ5NTI5ZmYmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.KgoG29a7bCIFAidQ8NAnLplJlYBSGIO9GNUAF0YDcSI)](https://private-user-images.githubusercontent.com/57278844/268900864-971cb899-67bd-460c-b750-aabacfacae50.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1NzkxNzYsIm5iZiI6MTczNjU3ODg3NiwicGF0aCI6Ii81NzI3ODg0NC8yNjg5MDA4NjQtOTcxY2I4OTktNjdiZC00NjBjLWI3NTAtYWFiYWNmYWNhZTUwLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDA3MDExNlomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTBlZWY4NTUwZDBjMmFiOTFjMzRiMzNlZWIwNDc0NTAzNGE1M2QyNjRlM2RjZDE2MTU5YzFkZjRiNzQ5NTI5ZmYmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.KgoG29a7bCIFAidQ8NAnLplJlYBSGIO9GNUAF0YDcSI)

[![image](https://private-user-images.githubusercontent.com/57278844/268900894-e9fc8cdd-9748-4b0b-84d4-593f6739de55.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1NzkxNzYsIm5iZiI6MTczNjU3ODg3NiwicGF0aCI6Ii81NzI3ODg0NC8yNjg5MDA4OTQtZTlmYzhjZGQtOTc0OC00YjBiLTg0ZDQtNTkzZjY3MzlkZTU1LnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDA3MDExNlomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWZjZjQ0ZTQ3YTYzNzMxMjQ3NjBlNTFjNTEwMjI5NTdjMmU0M2Y1OTY3MGY2NWY3MTM4ZjhjNDliNWVhOWJjZTImWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.qLrsIYKvnlRjssfDHjCVvVX9mj17GyajxAY2Jr57dKM)](https://private-user-images.githubusercontent.com/57278844/268900894-e9fc8cdd-9748-4b0b-84d4-593f6739de55.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1NzkxNzYsIm5iZiI6MTczNjU3ODg3NiwicGF0aCI6Ii81NzI3ODg0NC8yNjg5MDA4OTQtZTlmYzhjZGQtOTc0OC00YjBiLTg0ZDQtNTkzZjY3MzlkZTU1LnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDA3MDExNlomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWZjZjQ0ZTQ3YTYzNzMxMjQ3NjBlNTFjNTEwMjI5NTdjMmU0M2Y1OTY3MGY2NWY3MTM4ZjhjNDliNWVhOWJjZTImWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.qLrsIYKvnlRjssfDHjCVvVX9mj17GyajxAY2Jr57dKM)

### POC

[![image](https://private-user-images.githubusercontent.com/57278844/268900937-1a489083-4f74-4151-b5ca-aea92eddebcd.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1NzkxNzYsIm5iZiI6MTczNjU3ODg3NiwicGF0aCI6Ii81NzI3ODg0NC8yNjg5MDA5MzctMWE0ODkwODMtNGY3NC00MTUxLWI1Y2EtYWVhOTJlZGRlYmNkLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDA3MDExNlomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWFiOThiNWRmMzYyZDBmODZiMjE2OTZiOTJmODQ5MjYzNDNmZDY3YTc5YTg4NjhkYmZjNjY2NWNmZDBkOGE4MGImWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.ph5ZH6KTDp5c9tJlvXJMqBxv6g9bZN5Plk41ZW101nE)](https://private-user-images.githubusercontent.com/57278844/268900937-1a489083-4f74-4151-b5ca-aea92eddebcd.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1NzkxNzYsIm5iZiI6MTczNjU3ODg3NiwicGF0aCI6Ii81NzI3ODg0NC8yNjg5MDA5MzctMWE0ODkwODMtNGY3NC00MTUxLWI1Y2EtYWVhOTJlZGRlYmNkLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDA3MDExNlomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWFiOThiNWRmMzYyZDBmODZiMjE2OTZiOTJmODQ5MjYzNDNmZDY3YTc5YTg4NjhkYmZjNjY2NWNmZDBkOGE4MGImWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.ph5ZH6KTDp5c9tJlvXJMqBxv6g9bZN5Plk41ZW101nE)

## 5.formSetWanDhcpplus Function

### Vulnerability analysis

The websGetVar function obtains the curtime parameter from the front-end and stores the data on the stack through the sprintf function. However, due to the lack of data length restrictions, a buffer overflow vulnerability is created.

[![image](https://private-user-images.githubusercontent.com/57278844/268900978-bdfe9f02-a798-4880-b99f-7ba3f79091ba.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1NzkxNzYsIm5iZiI6MTczNjU3ODg3NiwicGF0aCI6Ii81NzI3ODg0NC8yNjg5MDA5NzgtYmRmZTlmMDItYTc5OC00ODgwLWI5OWYtN2JhM2Y3OTA5MWJhLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDA3MDExNlomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTIzYjViNmQ1NDE5NWQ1ZTQ1M2Q5Y2JhMDY5NTZhZDZlZjZiMzBkOWQzYmU0NmYxMzM2NTNiYjkzYTNmNTQ4NTEmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.4LVJS7K_rkxt4TEcoe4QxLmiDhQ9n8nDEpptma1m-r0)](https://private-user-images.githubusercontent.com/57278844/268900978-bdfe9f02-a798-4880-b99f-7ba3f79091ba.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1NzkxNzYsIm5iZiI6MTczNjU3ODg3NiwicGF0aCI6Ii81NzI3ODg0NC8yNjg5MDA5NzgtYmRmZTlmMDItYTc5OC00ODgwLWI5OWYtN2JhM2Y3OTA5MWJhLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDA3MDExNlomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTIzYjViNmQ1NDE5NWQ1ZTQ1M2Q5Y2JhMDY5NTZhZDZlZjZiMzBkOWQzYmU0NmYxMzM2NTNiYjkzYTNmNTQ4NTEmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.4LVJS7K_rkxt4TEcoe4QxLmiDhQ9n8nDEpptma1m-r0)

[![image](https://private-user-images.githubusercontent.com/57278844/268901021-be251492-8b0c-4d05-83dc-d7ff66224b99.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1NzkxNzYsIm5iZiI6MTczNjU3ODg3NiwicGF0aCI6Ii81NzI3ODg0NC8yNjg5MDEwMjEtYmUyNTE0OTItOGIwYy00ZDA1LTgzZGMtZDdmZjY2MjI0Yjk5LnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDA3MDExNlomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTM2ZGExMmUzNzM1YzM1NmJhNWEyMjYwZGViNTllNjk1OWM3NTdlMDI2N2Y5N2YyZmZmMmNlOTUwN2YyNWIxMjEmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.-ycG4nNhJDjBJAruNv5I395F7V_Vslx1SrEJD3wzqj4)](https://private-user-images.githubusercontent.com/57278844/268901021-be251492-8b0c-4d05-83dc-d7ff66224b99.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1NzkxNzYsIm5iZiI6MTczNjU3ODg3NiwicGF0aCI6Ii81NzI3ODg0NC8yNjg5MDEwMjEtYmUyNTE0OTItOGIwYy00ZDA1LTgzZGMtZDdmZjY2MjI0Yjk5LnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDA3MDExNlomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTM2ZGExMmUzNzM1YzM1NmJhNWEyMjYwZGViNTllNjk1OWM3NTdlMDI2N2Y5N2YyZmZmMmNlOTUwN2YyNWIxMjEmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.-ycG4nNhJDjBJAruNv5I395F7V_Vslx1SrEJD3wzqj4)

### POC

[![image](https://private-user-images.githubusercontent.com/57278844/268901047-cd47566c-db66-4ec7-b2a9-46aa3095c4f6.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1NzkxNzYsIm5iZiI6MTczNjU3ODg3NiwicGF0aCI6Ii81NzI3ODg0NC8yNjg5MDEwNDctY2Q0NzU2NmMtZGI2Ni00ZWM3LWIyYTktNDZhYTMwOTVjNGY2LnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDA3MDExNlomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWUyNTRhODI2NjE1MjMxMjhiZDVlNDNhZmE1YmFkMzI0MmQ3YjJmNTVhMjYyYmU4MjVkYTdiNzIzNGNiYTQwN2QmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.TS60ysP46AeBbBkuVGyc_szYexVGDWsHW0B1dNLcLIk)](https://private-user-images.githubusercontent.com/57278844/268901047-cd47566c-db66-4ec7-b2a9-46aa3095c4f6.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1NzkxNzYsIm5iZiI6MTczNjU3ODg3NiwicGF0aCI6Ii81NzI3ODg0NC8yNjg5MDEwNDctY2Q0NzU2NmMtZGI2Ni00ZWM3LWIyYTktNDZhYTMwOTVjNGY2LnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDA3MDExNlomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWUyNTRhODI2NjE1MjMxMjhiZDVlNDNhZmE1YmFkMzI0MmQ3YjJmNTVhMjYyYmU4MjVkYTdiNzIzNGNiYTQwN2QmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.TS60ysP46AeBbBkuVGyc_szYexVGDWsHW0B1dNLcLIk)

## 6.formSetWanNonLogin Function

### Vulnerability analysis

The websGetVar function obtains the curtime parameter from the front-end and stores the data on the stack through the sprintf function. However, due to the lack of data length restrictions, a buffer overflow vulnerability is created.

[![image](https://private-user-images.githubusercontent.com/57278844/268901072-c7f42a4a-5572-44e5-9410-0dcc2010b9e2.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1NzkxNzYsIm5iZiI6MTczNjU3ODg3NiwicGF0aCI6Ii81NzI3ODg0NC8yNjg5MDEwNzItYzdmNDJhNGEtNTU3Mi00NGU1LTk0MTAtMGRjYzIwMTBiOWUyLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDA3MDExNlomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTdkYzIxODQ3MGUxZjlhY2RlNDkxZDI4NzllZjAyMTk1MzE2OTRhYmRkNGNlMWMwN2JjMGFhZWYzYWFkZGViMjMmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.TLd1J4PKkJuoE_TiboUtDYIGocJZ5EMbEM-EjQ9BGc0)](https://private-user-images.githubusercontent.com/57278844/268901072-c7f42a4a-5572-44e5-9410-0dcc2010b9e2.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1NzkxNzYsIm5iZiI6MTczNjU3ODg3NiwicGF0aCI6Ii81NzI3ODg0NC8yNjg5MDEwNzItYzdmNDJhNGEtNTU3Mi00NGU1LTk0MTAtMGRjYzIwMTBiOWUyLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDA3MDExNlomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTdkYzIxODQ3MGUxZjlhY2RlNDkxZDI4NzllZjAyMTk1MzE2OTRhYmRkNGNlMWMwN2JjMGFhZWYzYWFkZGViMjMmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.TLd1J4PKkJuoE_TiboUtDYIGocJZ5EMbEM-EjQ9BGc0)

[![image](https://private-user-images.githubusercontent.com/57278844/268901092-df527077-c31a-40c1-9bd4-c4b535d11eab.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1NzkxNzYsIm5iZiI6MTczNjU3ODg3NiwicGF0aCI6Ii81NzI3ODg0NC8yNjg5MDEwOTItZGY1MjcwNzctYzMxYS00MGMxLTliZDQtYzRiNTM1ZDExZWFiLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDA3MDExNlomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWY5OWUwZjZjNmY5MGFjMDhjZjA2NWJjZGE4OTUzNzg2NGI2NzQwNDA0MDRmN2EyZjQ3MDNmODc2MzhlOWJlNjcmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.HirowTBD_o_U0w7DgLYI0WDq_GMWwpzQsd_jT7IpeEE)](https://private-user-images.githubusercontent.com/57278844/268901092-df527077-c31a-40c1-9bd4-c4b535d11eab.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1NzkxNzYsIm5iZiI6MTczNjU3ODg3NiwicGF0aCI6Ii81NzI3ODg0NC8yNjg5MDEwOTItZGY1MjcwNzctYzMxYS00MGMxLTliZDQtYzRiNTM1ZDExZWFiLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDA3MDExNlomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWY5OWUwZjZjNmY5MGFjMDhjZjA2NWJjZGE4OTUzNzg2NGI2NzQwNDA0MDRmN2EyZjQ3MDNmODc2MzhlOWJlNjcmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.HirowTBD_o_U0w7DgLYI0WDq_GMWwpzQsd_jT7IpeEE)

### POC

[![image](https://private-user-images.githubusercontent.com/57278844/268901108-a186719d-377e-44a8-9bad-76e45978a64c.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1NzkxNzYsIm5iZiI6MTczNjU3ODg3NiwicGF0aCI6Ii81NzI3ODg0NC8yNjg5MDExMDgtYTE4NjcxOWQtMzc3ZS00NGE4LTliYWQtNzZlNDU5NzhhNjRjLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDA3MDExNlomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTA4ZDJlM2ZjNDk4NmY3YWI5YjdiZWY3YjE5Yjk0ZTMyOGMzMTc3YTgwNDQwNDczMWVmZDY0N2Q1ODhhMzg0YzkmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.FYBbWK1VvcYu6kLrBy6FKgOmDJaezw3n_J2azhMns-E)](https://private-user-images.githubusercontent.com/57278844/268901108-a186719d-377e-44a8-9bad-76e45978a64c.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1NzkxNzYsIm5iZiI6MTczNjU3ODg3NiwicGF0aCI6Ii81NzI3ODg0NC8yNjg5MDExMDgtYTE4NjcxOWQtMzc3ZS00NGE4LTliYWQtNzZlNDU5NzhhNjRjLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDA3MDExNlomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTA4ZDJlM2ZjNDk4NmY3YWI5YjdiZWY3YjE5Yjk0ZTMyOGMzMTc3YTgwNDQwNDczMWVmZDY0N2Q1ODhhMzg0YzkmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.FYBbWK1VvcYu6kLrBy6FKgOmDJaezw3n_J2azhMns-E)

## 7.formSetWanPPPoE Function

### Vulnerability analysis

The websGetVar function obtains the curtime parameter from the front-end and stores the data on the stack through the sprintf function. However, due to the lack of data length restrictions, a buffer overflow vulnerability is created.

[![image](https://private-user-images.githubusercontent.com/57278844/268901130-13a7ae0d-bd71-46f8-bea3-858d9a9609b4.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1NzkxNzYsIm5iZiI6MTczNjU3ODg3NiwicGF0aCI6Ii81NzI3ODg0NC8yNjg5MDExMzAtMTNhN2FlMGQtYmQ3MS00NmY4LWJlYTMtODU4ZDlhOTYwOWI0LnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDA3MDExNlomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTljZWExYzQ3ZjM5YWM4NjUxZDkzZTYxMmJmY2FhNTJkNWMyNGYzMmNmMWI3ZTYwZDJkYjFhZjBkMzg3ZjkxMTgmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.bXxEn3EPt3vT16jxqLlzlR3GklsmtjZURHaxaG4thUg)](https://private-user-images.githubusercontent.com/57278844/268901130-13a7ae0d-bd71-46f8-bea3-858d9a9609b4.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1NzkxNzYsIm5iZiI6MTczNjU3ODg3NiwicGF0aCI6Ii81NzI3ODg0NC8yNjg5MDExMzAtMTNhN2FlMGQtYmQ3MS00NmY4LWJlYTMtODU4ZDlhOTYwOWI0LnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDA3MDExNlomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTljZWExYzQ3ZjM5YWM4NjUxZDkzZTYxMmJmY2FhNTJkNWMyNGYzMmNmMWI3ZTYwZDJkYjFhZjBkMzg3ZjkxMTgmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.bXxEn3EPt3vT16jxqLlzlR3GklsmtjZURHaxaG4thUg)

[![image](https://private-user-images.githubusercontent.com/57278844/268901153-5dd89b8a-d9d3-4922-aef2-3887521f7095.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1NzkxNzYsIm5iZiI6MTczNjU3ODg3NiwicGF0aCI6Ii81NzI3ODg0NC8yNjg5MDExNTMtNWRkODliOGEtZDlkMy00OTIyLWFlZjItMzg4NzUyMWY3MDk1LnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDA3MDExNlomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTY2M2M1N2I0ZmU5N2ZiNGU3ZTY3NjUxNTExN2RjN2QyYzVjMmMwODA3NWQ3N2ZhMGQ2Mjk0NDljMzIwNDE4NWEmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.yKmWxY0n98WohPpTViHgmy-MUa6TFaLJ9CIl4Xs2IdY)](https://private-user-images.githubusercontent.com/57278844/268901153-5dd89b8a-d9d3-4922-aef2-3887521f7095.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1NzkxNzYsIm5iZiI6MTczNjU3ODg3NiwicGF0aCI6Ii81NzI3ODg0NC8yNjg5MDExNTMtNWRkODliOGEtZDlkMy00OTIyLWFlZjItMzg4NzUyMWY3MDk1LnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDA3MDExNlomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTY2M2M1N2I0ZmU5N2ZiNGU3ZTY3NjUxNTExN2RjN2QyYzVjMmMwODA3NWQ3N2ZhMGQ2Mjk0NDljMzIwNDE4NWEmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.yKmWxY0n98WohPpTViHgmy-MUa6TFaLJ9CIl4Xs2IdY)

### POC

[![image](https://private-user-images.githubusercontent.com/57278844/268901178-e7a5fce1-aa65-4a32-869b-3f049b35c534.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1NzkxNzYsIm5iZiI6MTczNjU3ODg3NiwicGF0aCI6Ii81NzI3ODg0NC8yNjg5MDExNzgtZTdhNWZjZTEtYWE2NS00YTMyLTg2OWItM2YwNDliMzVjNTM0LnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDA3MDExNlomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTdlYzQwZWM0ZWYwMzBhZDNjYTFjMjYzNWMwOTUxZmMwYzZjNTJlMzk1NjcxYzViNjllMTZiYWNhZTc2MTQ5ZWMmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.2-SSZtR9ilVBADpWs-3eMpn5fCdrZR3QaBzryPvWJcw)](https://private-user-images.githubusercontent.com/57278844/268901178-e7a5fce1-aa65-4a32-869b-3f049b35c534.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1NzkxNzYsIm5iZiI6MTczNjU3ODg3NiwicGF0aCI6Ii81NzI3ODg0NC8yNjg5MDExNzgtZTdhNWZjZTEtYWE2NS00YTMyLTg2OWItM2YwNDliMzVjNTM0LnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDA3MDExNlomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTdlYzQwZWM0ZWYwMzBhZDNjYTFjMjYzNWMwOTUxZmMwYzZjNTJlMzk1NjcxYzViNjllMTZiYWNhZTc2MTQ5ZWMmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.2-SSZtR9ilVBADpWs-3eMpn5fCdrZR3QaBzryPvWJcw)

## 8.formSetWanPPTP Function

### Vulnerability analysis

The websGetVar function obtains the curtime parameter from the front-end and stores the data on the stack through the sprintf function. However, due to the lack of data length restrictions, a buffer overflow vulnerability is created.

[![image](https://private-user-images.githubusercontent.com/57278844/268901221-cc2f0cfd-23b2-4cda-9863-3d827e4f41d5.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1NzkxNzYsIm5iZiI6MTczNjU3ODg3NiwicGF0aCI6Ii81NzI3ODg0NC8yNjg5MDEyMjEtY2MyZjBjZmQtMjNiMi00Y2RhLTk4NjMtM2Q4MjdlNGY0MWQ1LnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDA3MDExNlomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTg3YmQyNzlmZTk5MmQ4MzVmMTFiNDFhN2FiNTk2ZmM5NDMxOWZiZDAzZmJhN2YyMjU3YzI0OTk3NzVlZjgwMWImWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.9udaZ8l6G088qihMZ88xIwA7AYEtOOsM_SQLbpNa-nk)](https://private-user-images.githubusercontent.com/57278844/268901221-cc2f0cfd-23b2-4cda-9863-3d827e4f41d5.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1NzkxNzYsIm5iZiI6MTczNjU3ODg3NiwicGF0aCI6Ii81NzI3ODg0NC8yNjg5MDEyMjEtY2MyZjBjZmQtMjNiMi00Y2RhLTk4NjMtM2Q4MjdlNGY0MWQ1LnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDA3MDExNlomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTg3YmQyNzlmZTk5MmQ4MzVmMTFiNDFhN2FiNTk2ZmM5NDMxOWZiZDAzZmJhN2YyMjU3YzI0OTk3NzVlZjgwMWImWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.9udaZ8l6G088qihMZ88xIwA7AYEtOOsM_SQLbpNa-nk)

[![image](https://private-user-images.githubusercontent.com/57278844/268901243-42866e8c-ee17-4fff-815c-30fed8a71d82.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1NzkxNzYsIm5iZiI6MTczNjU3ODg3NiwicGF0aCI6Ii81NzI3ODg0NC8yNjg5MDEyNDMtNDI4NjZlOGMtZWUxNy00ZmZmLTgxNWMtMzBmZWQ4YTcxZDgyLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDA3MDExNlomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTQyNTBiZmM1NzAxMjFkYzM2ZmY5MGNhODEyY2FiMWVjNWY5YzIxMzI1M2VhMzBkNjFmYTZiY2U2NzY5MDc5ODUmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.NYHb4SPt88H7LqkIz4C-gshHuBRn7ZsUz1GWEgqBK9A)](https://private-user-images.githubusercontent.com/57278844/268901243-42866e8c-ee17-4fff-815c-30fed8a71d82.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1NzkxNzYsIm5iZiI6MTczNjU3ODg3NiwicGF0aCI6Ii81NzI3ODg0NC8yNjg5MDEyNDMtNDI4NjZlOGMtZWUxNy00ZmZmLTgxNWMtMzBmZWQ4YTcxZDgyLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDA3MDExNlomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTQyNTBiZmM1NzAxMjFkYzM2ZmY5MGNhODEyY2FiMWVjNWY5YzIxMzI1M2VhMzBkNjFmYTZiY2U2NzY5MDc5ODUmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.NYHb4SPt88H7LqkIz4C-gshHuBRn7ZsUz1GWEgqBK9A)

### POC

[![image](https://private-user-images.githubusercontent.com/57278844/268901269-f59b9415-5a47-4f02-9dde-9fbb210b9270.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1NzkxNzYsIm5iZiI6MTczNjU3ODg3NiwicGF0aCI6Ii81NzI3ODg0NC8yNjg5MDEyNjktZjU5Yjk0MTUtNWE0Ny00ZjAyLTlkZGUtOWZiYjIxMGI5MjcwLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDA3MDExNlomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTNjOTNjNzVkMDE0MTM4ZThjNzM5MDk2YjRkNDFhOGVhMjEwZjEyMTExNTgwNmNjNTk4MTc2M2U0YTFjMWM5ZDcmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.K2L5ExQM_PntQvnl7YadcYNcnib4VZ0nr4cRFXbROf8)](https://private-user-images.githubusercontent.com/57278844/268901269-f59b9415-5a47-4f02-9dde-9fbb210b9270.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1NzkxNzYsIm5iZiI6MTczNjU3ODg3NiwicGF0aCI6Ii81NzI3ODg0NC8yNjg5MDEyNjktZjU5Yjk0MTUtNWE0Ny00ZjAyLTlkZGUtOWZiYjIxMGI5MjcwLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDA3MDExNlomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTNjOTNjNzVkMDE0MTM4ZThjNzM5MDk2YjRkNDFhOGVhMjEwZjEyMTExNTgwNmNjNTk4MTc2M2U0YTFjMWM5ZDcmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.K2L5ExQM_PntQvnl7YadcYNcnib4VZ0nr4cRFXbROf8)

## 9.formSetWanL2TP Function

### Vulnerability analysis

The websGetVar function obtains the curtime parameter from the front-end and stores the data on the stack through the sprintf function. However, due to the lack of data length restrictions, a buffer overflow vulnerability is created.

[![image](https://private-user-images.githubusercontent.com/57278844/268901321-db9b77fe-71f5-4d28-9ebf-a17160124eba.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1NzkxNzYsIm5iZiI6MTczNjU3ODg3NiwicGF0aCI6Ii81NzI3ODg0NC8yNjg5MDEzMjEtZGI5Yjc3ZmUtNzFmNS00ZDI4LTllYmYtYTE3MTYwMTI0ZWJhLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDA3MDExNlomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWU5ZTcyMDg1MDU4ZGQ4YTE4ZWMzOTBiMzJlOGQwMTBhMDZmYmExNGM3ODcwY2Y5ZmE4MTcwYWI5NTJkMDZjZDMmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.LD5CM7VOxKSA_6WtlzSDzpHI-6daqwKmDlgNFO8CtmU)](https://private-user-images.githubusercontent.com/57278844/268901321-db9b77fe-71f5-4d28-9ebf-a17160124eba.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1NzkxNzYsIm5iZiI6MTczNjU3ODg3NiwicGF0aCI6Ii81NzI3ODg0NC8yNjg5MDEzMjEtZGI5Yjc3ZmUtNzFmNS00ZDI4LTllYmYtYTE3MTYwMTI0ZWJhLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDA3MDExNlomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWU5ZTcyMDg1MDU4ZGQ4YTE4ZWMzOTBiMzJlOGQwMTBhMDZmYmExNGM3ODcwY2Y5ZmE4MTcwYWI5NTJkMDZjZDMmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.LD5CM7VOxKSA_6WtlzSDzpHI-6daqwKmDlgNFO8CtmU)

### POC

[![image](https://private-user-images.githubusercontent.com/57278844/268901356-e8b5e71b-9602-4839-b898-b7f27253839e.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1NzkxNzYsIm5iZiI6MTczNjU3ODg3NiwicGF0aCI6Ii81NzI3ODg0NC8yNjg5MDEzNTYtZThiNWU3MWItOTYwMi00ODM5LWI4OTgtYjdmMjcyNTM4MzllLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDA3MDExNlomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWZlODZmYWExYjVhOWY2Y2IzNmEwNjc3OTI1MGQyYmI3NGMzYTVjNTYyNWIzZWEzZjQxNzBkYzBmYWRiYTM5NjImWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.Dujpw0cCHZ3GXFBXes9ppXJoXFKrLTaPbz-HEfIfW6Y)](https://private-user-images.githubusercontent.com/57278844/268901356-e8b5e71b-9602-4839-b898-b7f27253839e.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1NzkxNzYsIm5iZiI6MTczNjU3ODg3NiwicGF0aCI6Ii81NzI3ODg0NC8yNjg5MDEzNTYtZThiNWU3MWItOTYwMi00ODM5LWI4OTgtYjdmMjcyNTM4MzllLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDA3MDExNlomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWZlODZmYWExYjVhOWY2Y2IzNmEwNjc3OTI1MGQyYmI3NGMzYTVjNTYyNWIzZWEzZjQxNzBkYzBmYWRiYTM5NjImWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.Dujpw0cCHZ3GXFBXes9ppXJoXFKrLTaPbz-HEfIfW6Y)

## 10.formLanguageChange Function

### Vulnerability analysis

The websGetVar function obtains the currtime parameter from the front-end and stores the data on the stack through the sprintf function. However, due to the lack of data length restrictions, a buffer overflow vulnerability is created.

[![image](https://private-user-images.githubusercontent.com/57278844/268901403-3fc309e9-5133-4fd5-9dc9-abd65e3d4084.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1NzkxNzYsIm5iZiI6MTczNjU3ODg3NiwicGF0aCI6Ii81NzI3ODg0NC8yNjg5MDE0MDMtM2ZjMzA5ZTktNTEzMy00ZmQ1LTlkYzktYWJkNjVlM2Q0MDg0LnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDA3MDExNlomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWM3MzE0MDg0OGU2ZWQwZDlhNTRiNDM4MDIwNmVkMTY1MGNhOGVkYzUyZjI2ZWMzNzkwYzQzZWEzMzA4NmVhYWImWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.NFEcXfZmjtKs2ZUlSg-mKxyNeSsnWHTHyS4VpgivBhg)](https://private-user-images.githubusercontent.com/57278844/268901403-3fc309e9-5133-4fd5-9dc9-abd65e3d4084.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1NzkxNzYsIm5iZiI6MTczNjU3ODg3NiwicGF0aCI6Ii81NzI3ODg0NC8yNjg5MDE0MDMtM2ZjMzA5ZTktNTEzMy00ZmQ1LTlkYzktYWJkNjVlM2Q0MDg0LnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDA3MDExNlomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWM3MzE0MDg0OGU2ZWQwZDlhNTRiNDM4MDIwNmVkMTY1MGNhOGVkYzUyZjI2ZWMzNzkwYzQzZWEzMzA4NmVhYWImWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.NFEcXfZmjtKs2ZUlSg-mKxyNeSsnWHTHyS4VpgivBhg)

### POC

[![image](https://private-user-images.githubusercontent.com/57278844/268904063-6642c7bc-2f62-4a21-9abd-20d579dbf39e.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1NzkxNzYsIm5iZiI6MTczNjU3ODg3NiwicGF0aCI6Ii81NzI3ODg0NC8yNjg5MDQwNjMtNjY0MmM3YmMtMmY2Mi00YTIxLTlhYmQtMjBkNTc5ZGJmMzllLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDA3MDExNlomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWU2ZGE2YmIwZDdkYzQ4ZjgwY2EwN2VhOWRjNWRkZTJiYTcxZGZlOWNmMjIwMTRmZjU3YjU1ZTIxM2E2MGM2ZDgmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.4jcyCcNxg_zd-fm2qr8ztLl1Sonx3ODVuwLu0OjnhZQ)](https://private-user-images.githubusercontent.com/57278844/268904063-6642c7bc-2f62-4a21-9abd-20d579dbf39e.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1NzkxNzYsIm5iZiI6MTczNjU3ODg3NiwicGF0aCI6Ii81NzI3ODg0NC8yNjg5MDQwNjMtNjY0MmM3YmMtMmY2Mi00YTIxLTlhYmQtMjBkNTc5ZGJmMzllLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDA3MDExNlomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWU2ZGE2YmIwZDdkYzQ4ZjgwY2EwN2VhOWRjNWRkZTJiYTcxZGZlOWNmMjIwMTRmZjU3YjU1ZTIxM2E2MGM2ZDgmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.4jcyCcNxg_zd-fm2qr8ztLl1Sonx3ODVuwLu0OjnhZQ)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.

