```
{
  "vulnerability": {
    "root_cause": "The dompdf library does not validate the contents of font files, only their file type, and stores font files in a publicly accessible directory. This allows a malicious user to inject PHP code into a font file, which is then stored and executed by dompdf.",
    "weaknesses": [
      "Insecure handling of font file processing.",
       "Lack of sanitization of user-controlled data used in file storage.",
       "Storing user-provided content in a publicly accessible directory."
    ],
    "impact": "Remote code execution (RCE) on the server. An attacker can inject arbitrary PHP code and execute it within the context of the web application.",
    "attack_vectors": "The attacker injects malicious CSS into a document rendered by Dompdf which references a specially crafted font file containing PHP code. When the PDF is rendered, dompdf saves the font file locally, and it becomes executable as a PHP file, the attacker can then access and execute that PHP file.",
    "required_capabilities": "The attacker needs to be able to inject CSS into a document processed by dompdf, and the dompdf font directory needs to be accessible via HTTP.",
     "additional_details": "The vulnerability exists because dompdf saves font files to a local font cache and doesn't validate the contents of the font file. The filename extension is preserved when saving the font file, so a malicious font file containing PHP code can be saved with a .php extension. This issue was fixed by matching the installed font filename extension to its type to prevent the execution of malicious files"
  }
}
```