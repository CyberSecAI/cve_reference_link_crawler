
[Log in / Register](https://bugs.launchpad.net/ubuntu/%2Bsource/crowdsec-firewall-bouncer/%2Bbug/2069596/%2Blogin)

[![](https://launchpadlibrarian.net/606381979/CoF%2064px.png)](https://launchpad.net/ubuntu)

## [Ubuntu](https://launchpad.net/ubuntu)[crowdsec-firewall-bouncer package](https://launchpad.net/ubuntu/%2Bsource/crowdsec-firewall-bouncer)

* [Overview](https://launchpad.net/ubuntu/%2Bsource/crowdsec-firewall-bouncer)
* [Code](https://code.launchpad.net/ubuntu/%2Bsource/crowdsec-firewall-bouncer)
* [Bugs](https://bugs.launchpad.net/ubuntu/%2Bsource/crowdsec-firewall-bouncer)
* Blueprints
* [Translations](https://translations.launchpad.net/ubuntu/%2Bsource/crowdsec-firewall-bouncer)
* [Answers](https://answers.launchpad.net/ubuntu/%2Bsource/crowdsec-firewall-bouncer)

# blocks wrong IPv4 and IPv6 addresses on LE systems (reversed byte order)

Bug #2069596 reported by
[Cyril Brulebois](https://launchpad.net/~kibi)
on 2024-06-17

[256](/%2Bhelp-bugs/bug-heat.html)

This bug affects 1 person

| Affects | | Status | Importance | Assigned to | Milestone |
| --- | --- | --- | --- | --- | --- |
|  | [crowdsec-firewall-bouncer (Ubuntu)](https://bugs.launchpad.net/ubuntu/%2Bsource/crowdsec-firewall-bouncer "Latest release: 0.0.25-3ubuntu0.24.04.2, uploaded to main on 2024-10-25 04:09:09.758688+00:00 by Evan Caville (evancaville), maintained by Ubuntu Developers (ubuntu-devel-discuss-lists)") | Confirmed | Undecided | Unassigned |  |

### Bug Description

Hi,

The crowdsec-firewall-bouncer binary package is affected by a bug in the golang-github-google-nftables-dev binary package, leading to blocking the wrong IP addresses (both IPv4 and IPv6) on all little-endian systems.

Upstream bug reports, about Ubuntu:

 - <https://github.com/google/nftables/issues/225>

 - <https://github.com/crowdsecurity/cs-firewall-bouncer/issues/368>

Debian bug reports:

 - <https://bugs.debian.org/1071247>

 - <https://bugs.debian.org/1071248>

That's been fixed in Debian testing/unstable:

 - golang-github-google-nftables/0.1.0-4

 - crowdsec-firewall-bouncer/0.0.25-4

and that's also getting fixed in stable (bookworm) via a trivial backport of those packages, now in bookworm-proposed-updates, to be published in the 12.6 point release at the end of the month:

 - golang-github-google-nftables/0.1.0-4~deb12u1

 - crowdsec-firewall-bouncer/0.0.25-4~deb12u1

I'm not familiar with Ubuntu's way of sync-ing from Debian, that's why I thought it would be best to file a bug there directly (against the leaf package), as opposed to contacting the maintainers documented at <https://packages.ubuntu.com/> (which recommends using Launchpad anyway).

Just to be crystal-clear: the fix is in the golang-github-google-nftables source package, while the crowdsec-firewall-bouncer one only requires a rebuild against the fixed package.

I'm also ticking the security vulnerability box, for the same reason I put the Debian Security team in the loop for the Debian bug reports: I'd rather have more eyes than fewer eyes on that kind of topic: the bouncer is currently giving a false sense of security as it doesn't actually block suspicious addresses, and also block other ones.

Cheers,

Cyril.

Tags:

[community-security](/ubuntu/%2Bsource/crowdsec-firewall-bouncer/%2Bbugs?field.tag=community-security)

## CVE References

* [2024-6284](/bugs/cve/2024-6284 "** RESERVED ** This candidate has bee...")

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Mark Esler (eslerm)](https://launchpad.net/~eslerm) wrote on 2024-06-19: |  |  | [#1](/ubuntu/%2Bsource/crowdsec-firewall-bouncer/%2Bbug/2069596/comments/1) |
| --- | --- | --- | --- |

Thank you for taking the time to report this Cyril.

Do you know if Google intends to assign a CVE?

Thank you for taking the time to report this Cyril.
Do you know if Google intends to assign a CVE?

| **information type**: | Private Security → Public Security |
| --- | --- |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Cyril Brulebois (kibi)](https://launchpad.net/~kibi) wrote on 2024-06-19:  [**Re: [Bug 2069596] Re: blocks wrong IPv4 and IPv6 addresses on LE systems (reversed byte order)**](/ubuntu/%2Bsource/crowdsec-firewall-bouncer/%2Bbug/2069596/comments/2) |  |  | [#2](/ubuntu/%2Bsource/crowdsec-firewall-bouncer/%2Bbug/2069596/comments/2) |
| --- | --- | --- | --- |

Hi,

Mark Esler <email address hidden> (2024-06-19):

> Thank you for taking the time to report this Cyril.

No worries at all.

> Do you know if Google intends to assign a CVE?

That I don't know, I've been mainly in contact with CrowdSec's upstream

developers (who notified me about the problem with the Debian/Ubuntu

packages) and with the various Debian teams to see how to best address

this in stable (i.e. security then release teams).

Note the google/nftables issue was detected and fixed a year ago

already, we just failed to notice earlier. :(

Cheers,

--

Cyril Brulebois -- Debian Consultant @ DEBAMAX -- <https://debamax.com/>

Hi,
Mark Esler <2069596@bugs.launchpad.net> (2024-06-19):
> Thank you for taking the time to report this Cyril.
No worries at all.
> Do you know if Google intends to assign a CVE?
That I don't know, I've been mainly in contact with CrowdSec's upstream
developers (who notified me about the problem with the Debian/Ubuntu
packages) and with the various Debian teams to see how to best address
this in stable (i.e. security then release teams).
Note the google/nftables issue was detected and fixed a year ago
already, we just failed to notice earlier. :(
Cheers,
--
Cyril Brulebois -- Debian Consultant @ DEBAMAX -- https://debamax.com/

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Mark Esler (eslerm)](https://launchpad.net/~eslerm) wrote on 2024-06-20: |  |  | [#3](/ubuntu/%2Bsource/crowdsec-firewall-bouncer/%2Bbug/2069596/comments/3) |
| --- | --- | --- | --- |

Cyril, upstream has agreed to assign a CVE. That will alert the Go ecosystem and distros to the issue and fix \o/

I will update you when I learn more.

Cyril, upstream has agreed to assign a CVE. That will alert the Go ecosystem and distros to the issue and fix \o/
I will update you when I learn more.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Marc Deslauriers (mdeslaur)](https://launchpad.net/~mdeslaur) wrote on 2024-07-05: |  |  | [#4](/ubuntu/%2Bsource/crowdsec-firewall-bouncer/%2Bbug/2069596/comments/4) |
| --- | --- | --- | --- |

Thanks for taking the time to report this bug and helping to make Ubuntu better. Since the package referred to in this bug is in universe or multiverse, it is community maintained. If you are able, I suggest coordinating with upstream and posting a debdiff for this issue. When a debdiff is available, members of the security team will review it and publish the package. See the following link for more information: <https://wiki.ubuntu.com/SecurityTeam/UpdateProcedures>

Thanks for taking the time to report this bug and helping to make Ubuntu better. Since the package referred to in this bug is in universe or multiverse, it is community maintained. If you are able, I suggest coordinating with upstream and posting a debdiff for this issue. When a debdiff is available, members of the security team will review it and publish the package. See the following link for more information: https://wiki.ubuntu.com/SecurityTeam/UpdateProcedures

| **tags**: | added: community-security |
| --- | --- |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Cyril Brulebois (kibi)](https://launchpad.net/~kibi) wrote on 2024-07-05: |  |  | [#5](/ubuntu/%2Bsource/crowdsec-firewall-bouncer/%2Bbug/2069596/comments/5) |
| --- | --- | --- | --- |

Everything is in my initial report really… see what got merged into Debian 12 for last week's point release…

Everything is in my initial report really… see what got merged into Debian 12 for last week's point release…

[Marc Deslauriers (mdeslaur)](https://launchpad.net/~mdeslaur)
on 2024-07-05

| Changed in crowdsec-firewall-bouncer (Ubuntu): | |
| --- | --- |
| **status**: | New → Confirmed |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Mark Esler (eslerm)](https://launchpad.net/~eslerm) wrote on 2024-07-08: |  |  | [#6](/ubuntu/%2Bsource/crowdsec-firewall-bouncer/%2Bbug/2069596/comments/6) |
| --- | --- | --- | --- |

Google has assigned CVE-2024-6284 to describe this issue. Many thanks to Michael from upstream for the assignment and to Cyril for raising the need \o/

The fix for <https://github.com/google/nftables/issues/225> is <https://github.com/google/nftables/commit/d746ecb0e494e7200180c3886fde9664d9100729>

Google has assigned CVE-2024-6284 to describe this issue. Many thanks to Michael from upstream for the assignment and to Cyril for raising the need \o/
The fix for https://github.com/google/nftables/issues/225 is https://github.com/google/nftables/commit/d746ecb0e494e7200180c3886fde9664d9100729

[See full activity log](https://bugs.launchpad.net/ubuntu/%2Bsource/crowdsec-firewall-bouncer/%2Bbug/2069596/%2Bactivity)

To post a comment you must [log in](%2Blogin?comments=all).

* [Report a bug](/ubuntu/%2Bsource/crowdsec-firewall-bouncer/%2Bfilebug)

This report contains
**Public Security**
information

Everyone can see this security related information.

You are
[not directly subscribed to this bug's notifications.](/ubuntu/%2Bsource/crowdsec-firewall-bouncer/%2Bbug/2069596/%2Bsubscribe)

Subscribing...

* [Edit bug mail](https://bugs.launchpad.net/ubuntu/%2Bsource/crowdsec-firewall-bouncer/%2Bbug/2069596/%2Bsubscriptions "View and change your subscriptions to this bug")

## Other bug subscribers

[Subscribe someone else](https://bugs.launchpad.net/ubuntu/%2Bsource/crowdsec-firewall-bouncer/%2Bbug/2069596/%2Baddsubscriber "Launchpad will email that person whenever this bugs changes")

## Remote bug watches

* [auto-github-google-nftables #225](https://github.com/google/nftables/issues/225)

  [closed]
  [Edit](/bugs/2069596/%2Bwatch/160920 "Change watch details")

Bug watches keep track of this bug in other bug trackers.

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
 •
[Take the tour](https://launchpad.net/%2Btour)
 •
[Read the guide](https://help.launchpad.net/)

© 2004
[Canonical Ltd.](http://canonical.com/)
 •
[Terms of use](https://launchpad.net/legal)
 •
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
 •
[Contact Launchpad Support](/feedback)
 •
[Blog](http://blog.launchpad.net/)
 •
[Careers](https://canonical.com/careers)
 •
[System status](https://ubuntu.social/%40launchpadstatus)
 •
6394e03
([Get the code!](https://dev.launchpad.net/))

