=== Content from bugs.launchpad.net_949049a3_20250111_090610.html ===

[Log in / Register](https://bugs.launchpad.net/ubuntu/%2Bsource/crowdsec-firewall-bouncer/%2Bbug/2069596/%2Blogin)

[![](https://launchpadlibrarian.net/606381979/CoF%2064px.png)](https://launchpad.net/ubuntu)

## [Ubuntu](https://launchpad.net/ubuntu)[crowdsec-firewall-bouncer package](https://launchpad.net/ubuntu/%2Bsource/crowdsec-firewall-bouncer)

* [Overview](https://launchpad.net/ubuntu/%2Bsource/crowdsec-firewall-bouncer)
* [Code](https://code.launchpad.net/ubuntu/%2Bsource/crowdsec-firewall-bouncer)
* [Bugs](https://bugs.launchpad.net/ubuntu/%2Bsource/crowdsec-firewall-bouncer)
* Blueprints
* [Translations](https://translations.launchpad.net/ubuntu/%2Bsource/crowdsec-firewall-bouncer)
* [Answers](https://answers.launchpad.net/ubuntu/%2Bsource/crowdsec-firewall-bouncer)

# blocks wrong IPv4 and IPv6 addresses on LE systems (reversed byte order)

Bug #2069596 reported by
[Cyril Brulebois](https://launchpad.net/~kibi)
on 2024-06-17

[256](/%2Bhelp-bugs/bug-heat.html)

This bug affects 1 person

| Affects | | Status | Importance | Assigned to | Milestone |
| --- | --- | --- | --- | --- | --- |
|  | [crowdsec-firewall-bouncer (Ubuntu)](https://bugs.launchpad.net/ubuntu/%2Bsource/crowdsec-firewall-bouncer "Latest release: 0.0.25-3ubuntu0.24.04.2, uploaded to main on 2024-10-25 04:09:09.758688+00:00 by Evan Caville (evancaville), maintained by Ubuntu Developers (ubuntu-devel-discuss-lists)") | Confirmed | Undecided | Unassigned |  |

### Bug Description

Hi,

The crowdsec-firewall-bouncer binary package is affected by a bug in the golang-github-google-nftables-dev binary package, leading to blocking the wrong IP addresses (both IPv4 and IPv6) on all little-endian systems.

Upstream bug reports, about Ubuntu:

 - <https://github.com/google/nftables/issues/225>

 - <https://github.com/crowdsecurity/cs-firewall-bouncer/issues/368>

Debian bug reports:

 - <https://bugs.debian.org/1071247>

 - <https://bugs.debian.org/1071248>

That's been fixed in Debian testing/unstable:

 - golang-github-google-nftables/0.1.0-4

 - crowdsec-firewall-bouncer/0.0.25-4

and that's also getting fixed in stable (bookworm) via a trivial backport of those packages, now in bookworm-proposed-updates, to be published in the 12.6 point release at the end of the month:

 - golang-github-google-nftables/0.1.0-4~deb12u1

 - crowdsec-firewall-bouncer/0.0.25-4~deb12u1

I'm not familiar with Ubuntu's way of sync-ing from Debian, that's why I thought it would be best to file a bug there directly (against the leaf package), as opposed to contacting the maintainers documented at <https://packages.ubuntu.com/> (which recommends using Launchpad anyway).

Just to be crystal-clear: the fix is in the golang-github-google-nftables source package, while the crowdsec-firewall-bouncer one only requires a rebuild against the fixed package.

I'm also ticking the security vulnerability box, for the same reason I put the Debian Security team in the loop for the Debian bug reports: I'd rather have more eyes than fewer eyes on that kind of topic: the bouncer is currently giving a false sense of security as it doesn't actually block suspicious addresses, and also block other ones.

Cheers,

Cyril.

Tags:

[community-security](/ubuntu/%2Bsource/crowdsec-firewall-bouncer/%2Bbugs?field.tag=community-security)

## CVE References

* [2024-6284](/bugs/cve/2024-6284 "** RESERVED ** This candidate has bee...")

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Mark Esler (eslerm)](https://launchpad.net/~eslerm) wrote on 2024-06-19: |  |  | [#1](/ubuntu/%2Bsource/crowdsec-firewall-bouncer/%2Bbug/2069596/comments/1) |
| --- | --- | --- | --- |

Thank you for taking the time to report this Cyril.

Do you know if Google intends to assign a CVE?

Thank you for taking the time to report this Cyril.
Do you know if Google intends to assign a CVE?

| **information type**: | Private Security → Public Security |
| --- | --- |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Cyril Brulebois (kibi)](https://launchpad.net/~kibi) wrote on 2024-06-19:  [**Re: [Bug 2069596] Re: blocks wrong IPv4 and IPv6 addresses on LE systems (reversed byte order)**](/ubuntu/%2Bsource/crowdsec-firewall-bouncer/%2Bbug/2069596/comments/2) |  |  | [#2](/ubuntu/%2Bsource/crowdsec-firewall-bouncer/%2Bbug/2069596/comments/2) |
| --- | --- | --- | --- |

Hi,

Mark Esler <email address hidden> (2024-06-19):

> Thank you for taking the time to report this Cyril.

No worries at all.

> Do you know if Google intends to assign a CVE?

That I don't know, I've been mainly in contact with CrowdSec's upstream

developers (who notified me about the problem with the Debian/Ubuntu

packages) and with the various Debian teams to see how to best address

this in stable (i.e. security then release teams).

Note the google/nftables issue was detected and fixed a year ago

already, we just failed to notice earlier. :(

Cheers,

--

Cyril Brulebois -- Debian Consultant @ DEBAMAX -- <https://debamax.com/>

Hi,
Mark Esler <2069596@bugs.launchpad.net> (2024-06-19):
> Thank you for taking the time to report this Cyril.
No worries at all.
> Do you know if Google intends to assign a CVE?
That I don't know, I've been mainly in contact with CrowdSec's upstream
developers (who notified me about the problem with the Debian/Ubuntu
packages) and with the various Debian teams to see how to best address
this in stable (i.e. security then release teams).
Note the google/nftables issue was detected and fixed a year ago
already, we just failed to notice earlier. :(
Cheers,
--
Cyril Brulebois -- Debian Consultant @ DEBAMAX -- https://debamax.com/

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Mark Esler (eslerm)](https://launchpad.net/~eslerm) wrote on 2024-06-20: |  |  | [#3](/ubuntu/%2Bsource/crowdsec-firewall-bouncer/%2Bbug/2069596/comments/3) |
| --- | --- | --- | --- |

Cyril, upstream has agreed to assign a CVE. That will alert the Go ecosystem and distros to the issue and fix \o/

I will update you when I learn more.

Cyril, upstream has agreed to assign a CVE. That will alert the Go ecosystem and distros to the issue and fix \o/
I will update you when I learn more.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Marc Deslauriers (mdeslaur)](https://launchpad.net/~mdeslaur) wrote on 2024-07-05: |  |  | [#4](/ubuntu/%2Bsource/crowdsec-firewall-bouncer/%2Bbug/2069596/comments/4) |
| --- | --- | --- | --- |

Thanks for taking the time to report this bug and helping to make Ubuntu better. Since the package referred to in this bug is in universe or multiverse, it is community maintained. If you are able, I suggest coordinating with upstream and posting a debdiff for this issue. When a debdiff is available, members of the security team will review it and publish the package. See the following link for more information: <https://wiki.ubuntu.com/SecurityTeam/UpdateProcedures>

Thanks for taking the time to report this bug and helping to make Ubuntu better. Since the package referred to in this bug is in universe or multiverse, it is community maintained. If you are able, I suggest coordinating with upstream and posting a debdiff for this issue. When a debdiff is available, members of the security team will review it and publish the package. See the following link for more information: https://wiki.ubuntu.com/SecurityTeam/UpdateProcedures

| **tags**: | added: community-security |
| --- | --- |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Cyril Brulebois (kibi)](https://launchpad.net/~kibi) wrote on 2024-07-05: |  |  | [#5](/ubuntu/%2Bsource/crowdsec-firewall-bouncer/%2Bbug/2069596/comments/5) |
| --- | --- | --- | --- |

Everything is in my initial report really… see what got merged into Debian 12 for last week's point release…

Everything is in my initial report really… see what got merged into Debian 12 for last week's point release…

[Marc Deslauriers (mdeslaur)](https://launchpad.net/~mdeslaur)
on 2024-07-05

| Changed in crowdsec-firewall-bouncer (Ubuntu): | |
| --- | --- |
| **status**: | New → Confirmed |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Mark Esler (eslerm)](https://launchpad.net/~eslerm) wrote on 2024-07-08: |  |  | [#6](/ubuntu/%2Bsource/crowdsec-firewall-bouncer/%2Bbug/2069596/comments/6) |
| --- | --- | --- | --- |

Google has assigned CVE-2024-6284 to describe this issue. Many thanks to Michael from upstream for the assignment and to Cyril for raising the need \o/

The fix for <https://github.com/google/nftables/issues/225> is <https://github.com/google/nftables/commit/d746ecb0e494e7200180c3886fde9664d9100729>

Google has assigned CVE-2024-6284 to describe this issue. Many thanks to Michael from upstream for the assignment and to Cyril for raising the need \o/
The fix for https://github.com/google/nftables/issues/225 is https://github.com/google/nftables/commit/d746ecb0e494e7200180c3886fde9664d9100729

[See full activity log](https://bugs.launchpad.net/ubuntu/%2Bsource/crowdsec-firewall-bouncer/%2Bbug/2069596/%2Bactivity)

To post a comment you must [log in](%2Blogin?comments=all).

* [Report a bug](/ubuntu/%2Bsource/crowdsec-firewall-bouncer/%2Bfilebug)

This report contains
**Public Security**
information

Everyone can see this security related information.

You are
[not directly subscribed to this bug's notifications.](/ubuntu/%2Bsource/crowdsec-firewall-bouncer/%2Bbug/2069596/%2Bsubscribe)

Subscribing...

* [Edit bug mail](https://bugs.launchpad.net/ubuntu/%2Bsource/crowdsec-firewall-bouncer/%2Bbug/2069596/%2Bsubscriptions "View and change your subscriptions to this bug")

## Other bug subscribers

[Subscribe someone else](https://bugs.launchpad.net/ubuntu/%2Bsource/crowdsec-firewall-bouncer/%2Bbug/2069596/%2Baddsubscriber "Launchpad will email that person whenever this bugs changes")

## Remote bug watches

* [auto-github-google-nftables #225](https://github.com/google/nftables/issues/225)

  [closed]
  [Edit](/bugs/2069596/%2Bwatch/160920 "Change watch details")

Bug watches keep track of this bug in other bug trackers.

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
 •
[Take the tour](https://launchpad.net/%2Btour)
 •
[Read the guide](https://help.launchpad.net/)

© 2004
[Canonical Ltd.](http://canonical.com/)
 •
[Terms of use](https://launchpad.net/legal)
 •
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
 •
[Contact Launchpad Support](/feedback)
 •
[Blog](http://blog.launchpad.net/)
 •
[Careers](https://canonical.com/careers)
 •
[System status](https://ubuntu.social/%40launchpadstatus)
 •
6394e03
([Get the code!](https://dev.launchpad.net/))



=== Content from github.com_d2ac7ff3_20250111_090611.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fcrowdsecurity%2Fcs-firewall-bouncer%2Fissues%2F368)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fcrowdsecurity%2Fcs-firewall-bouncer%2Fissues%2F368)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=crowdsecurity%2Fcs-firewall-bouncer)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[crowdsecurity](/crowdsecurity)
/
**[cs-firewall-bouncer](/crowdsecurity/cs-firewall-bouncer)**
Public

* [Notifications](/login?return_to=%2Fcrowdsecurity%2Fcs-firewall-bouncer) You must be signed in to change notification settings
* [Fork
  44](/login?return_to=%2Fcrowdsecurity%2Fcs-firewall-bouncer)
* [Star
   121](/login?return_to=%2Fcrowdsecurity%2Fcs-firewall-bouncer)

* [Code](/crowdsecurity/cs-firewall-bouncer)
* [Issues
  23](/crowdsecurity/cs-firewall-bouncer/issues)
* [Pull requests
  4](/crowdsecurity/cs-firewall-bouncer/pulls)
* [Actions](/crowdsecurity/cs-firewall-bouncer/actions)
* [Projects
  0](/crowdsecurity/cs-firewall-bouncer/projects)
* [Security](/crowdsecurity/cs-firewall-bouncer/security)
* [Insights](/crowdsecurity/cs-firewall-bouncer/pulse)

Additional navigation options

* [Code](/crowdsecurity/cs-firewall-bouncer)
* [Issues](/crowdsecurity/cs-firewall-bouncer/issues)
* [Pull requests](/crowdsecurity/cs-firewall-bouncer/pulls)
* [Actions](/crowdsecurity/cs-firewall-bouncer/actions)
* [Projects](/crowdsecurity/cs-firewall-bouncer/projects)
* [Security](/crowdsecurity/cs-firewall-bouncer/security)
* [Insights](/crowdsecurity/cs-firewall-bouncer/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fcrowdsecurity%2Fcs-firewall-bouncer%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fcrowdsecurity%2Fcs-firewall-bouncer%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# mismatch between IPs from CrowdSec servers and those seen in nftables, reverse octet order (endianness) #368

Closed

[bughunter2](/bughunter2) opened this issue
May 13, 2024
· 10 comments

Closed

# [mismatch between IPs from CrowdSec servers and those seen in nftables, reverse octet order (endianness)](#top) #368

[bughunter2](/bughunter2) opened this issue
May 13, 2024
· 10 comments

Labels
[needs/kind](/crowdsecurity/cs-firewall-bouncer/labels/needs/kind)
[needs/triage](/crowdsecurity/cs-firewall-bouncer/labels/needs/triage)

## Comments

[![@bughunter2](https://avatars.githubusercontent.com/u/16524?s=80&u=42da8119f5a1d0e19a23d2cc9ba9f50b1276e0f2&v=4)](/bughunter2)

Copy link

### **[bughunter2](/bughunter2)** commented [May 13, 2024](#issue-2294760807) • edited Loading

| What happened? ``` 2024-05-13  Problem: --------  These symptoms seem to hint at one or more bugs.  There's a mismatch between the octet order in both the IPv4 and IPv6 addresses added to nftables and the IP addresses returned by the CrowdSec servers and those shown in the crowdsec-firewall-bouncer.log file (when log_level is set to debug).  At the very least, this can be a source of confusion. At worst, it means CrowdSec is banning the wrong IP addresses.  And because there's a mismatch between what the CrowdSec servers return and the IP addresses that get added to nftables, it might actually be that CrowdSec is banning the wrong IPs. I surely hope this is not the case?  Also, you can't easily 'grep' your nftables for an IP address from a CrowdSec log file, and instead you have to reverse the octets before looking for that address in your firewall.  Questions: ----------    - It seems to be an endianness bug, but which of the following, if any, is true?    - Does CrowdSec ban the wrong IP addresses (reverse octet order)?    - Do the CrowdSec servers return the wrong IP addresses (reverse octet order) through their HTTP API?    - Does the crowdsec-firewall-bouncer.log file show IP addresses in the wrong octet order?    - Are IP addresses added in the wrong octet order to nftables?  Troubleshooting details: ------------------------  1. Stop the crowdsec services. 2. Set crowdsec-firewall-bouncer's log_level to 'debug'. 3. Start the crowdsec service. 4. Start the crowdsec-firewall-bouncer service. 5. Observe the following:  The CrowdSec servers return something like this (output shown only partially here):  /var/log/crowdsec-firewall-bouncer.log contains a line like this (contains our example: 101.42.161.99):  time="13-05-2024 22:31:12" level=debug msg="Response: HTTP/1.1 200 OK\r\nTransfer-Encoding: chunked\r\n Content-Type: application/json; charset=utf-8\r\nDate: Mon, 13 May 2024 20:31:12 GMT\r\n\r\n231e5a\r\n{\"deleted\":null, "new\":[{\"duration\":\"155h56m43.973575713s\",\"id\":14973,\"origin\":\"CAPI\",\"scenario\":\"crowdsecurity/http-bad-user- agent\",\"scope\":\"Ip\",\"type\":\"ban\",\"value\":\"34.219.212.12\"},{\"duration\":\"155h56m43.973571691s\",\"id\": 14974,\"origin\":\"CAPI\",\"scenario\":\"crowdsecurity/http-probing\",\"scope\":\"Ip\",\"type\":\"ban\",\"value\": \"4.227.114.13\"},{\"duration\":\"155h56m43.97356988s\",\"id\":14975,\"origin\":\"CAPI\",\"scenario\"... ... ... r-agent\",\"scope\":\"Ip\",\"type\":\"ban\",\"value\":\"35.227.24.137\"},{\"duration\":\"155h56m43.97353777s\",\"id\": 14995,\"origin\":\"CAPI\",\"scenario\":\"crowdsecurity/ssh-slow-bf\",\"scope\":\"Ip\",\"type\":\"ban\",\"value\": \"101.42.161.99\"},{\"duration\":\"155h56m43.973536851s\",\"id\":14996,\"origin\":\"CAPI\",\"scenario\":\"crowdsecurity/ http-bad-user-agent\",\"scope\":\"Ip\",\"type\":\"ban\",\"value\":\"54.185.132.207\"},{\"duration\": \"155h56m43.973535581s\",\"id\":14997,\"origin\":\"CAPI\",\"scenario\":\"crowdsecurity/http-bad-user-agent\",\"... ...  /var/log/crowdsec-firewall-bouncer.log contains a line like this:  time="13-05-2024 22:31:12" level=debug msg="Adding '101.42.161.99' for '155h56m43.97353777s'"  ... but the 'nft list ruleset' output does NOT contain IPv4 address 101.42.161.99. However, it does contain the IPv4 address 99.161.42.101 ...:  # nft list ruleset | grep -in "101.42.161.99" # <== No matches. # nft list ruleset | grep -in "99.161.42.101" # <== Does match:  3173:			     99.161.42.101 timeout 6d11h56m43s972ms expires 6d11h55m29s16ms, 99.166.70.54 timeout 6d18h56m43s968ms expires 6d18h55m31s604ms,  The same happens with IPv6 addresses: -------------------------------------  /var/log/crowdsec-firewall-bouncer.log contains a line like this:  time="13-05-2024 22:31:19" level=debug msg="adding 2a03:4000:0:39c:e40c:92ff:fe2d:8e38 to buffer "  While 'nft list ruleset' contains:  # nft list ruleset | grep -in "ff92"  7596:			     388e:2dfe:ff92:ce4:9c03:0:40:32a timeout 6d18h56m43s968ms expires 6d18h55m35s444ms,  So which is correct?   - 2a03:4000:0:39c:e40c:92ff:fe2d:8e38 # Returned by CrowdSec servers and shown in crowdsec-firewall-bouncer.log   - 388e:2dfe:ff92:ce4:9c03:0:40:32a    # Shown in nft list ruleset.  Again, we can see that the octet order is reversed:  It seems to be "double reversed", in the sense that within each octet, the order is reversed as well. For example, the beginning was 2a03, but it moves to the end and becomes 32a.  2a03 => 32a 4000 => 40 0    => 0 39c  => 9c03 e40c => ce4 92ff => ff92 fe2d => 2dfe 8e38 => 388e   ``` What did you expect to happen? That there's no mismatch between the IPv4 and IPv6 addresses returned by the CrowdSec servers, what the crowdsec-firewall-bouncer.log file shows, and what nftables shows (nft list ruleset). They should all be in agreement. How can we reproduce it (as minimally and precisely as possible)? See above. Anything else we need to know? *No response* Crowdsec version ``` $ cscli version 2024/05/14 00:33:26 version: v1.4.6-6~deb12u1-debian 2024/05/14 00:33:26 Codename: alphaga 2024/05/14 00:33:26 BuildDate: 2023-07-15_09:29:33 2024/05/14 00:33:26 GoVersion: 1.19.8 2024/05/14 00:33:26 Platform: linux 2024/05/14 00:33:26 Constraint_parser: >= 1.0, <= 2.0 2024/05/14 00:33:26 Constraint_scenario: >= 1.0, < 3.0 2024/05/14 00:33:26 Constraint_api: v1 2024/05/14 00:33:26 Constraint_acquis: >= 1.0, < 2.0 ```  OS version ``` $ cat /etc/os-release PRETTY_NAME="Debian GNU/Linux 12 (bookworm)" NAME="Debian GNU/Linux" VERSION_ID="12" VERSION="12 (bookworm)" VERSION_CODENAME=bookworm ID=debian HOME_URL="https://www.debian.org/" SUPPORT_URL="https://www.debian.org/support" BUG_REPORT_URL="https://bugs.debian.org/"  $ uname -a 6.1.0-20-amd64 ```  Enabled collections and parsers ``` $ cscli hub list -o raw crowdsecurity/apache2,enabled,0.1,apache2 support : parser and generic http scenarios ,collections crowdsecurity/base-http-scenarios,enabled,0.6,http common : scanners detection,collections crowdsecurity/http-cve,enabled,1.9,,collections crowdsecurity/linux,enabled,0.2,core linux support : syslog+ssh,collections crowdsecurity/nginx,enabled,0.2,nginx support : parser and generic http scenarios,collections crowdsecurity/sshd,enabled,0.2,sshd support : parser and brute-force detection,collections crowdsecurity/apache2-logs,enabled,1.3,Parse Apache2 access and error logs,parsers crowdsecurity/dateparse-enrich,enabled,0.2,,parsers crowdsecurity/http-logs,enabled,1.1,"Parse more Specifically HTTP logs, such as HTTP Code, HTTP path, HTTP args and if its a static ressource",parsers crowdsecurity/nginx-logs,enabled,1.3,Parse nginx access and error logs,parsers crowdsecurity/sshd-logs,enabled,2.0,Parse openSSH logs,parsers crowdsecurity/syslog-logs,enabled,0.8,,parsers crowdsecurity/whitelists,enabled,0.2,Whitelist events from private ipv4 addresses,parsers crowdsecurity/CVE-2022-26134,enabled,0.1,Detect CVE-2022-26134 exploits,scenarios crowdsecurity/CVE-2022-35914,enabled,0.1,Detect CVE-2022-35914 exploits,scenarios crowdsecurity/CVE-2022-37042,enabled,0.1,Detect CVE-2022-37042 exploits,scenarios crowdsecurity/CVE-2022-40684,enabled,0.2,Detect cve-2022-40684 exploitation attempts,scenarios crowdsecurity/CVE-2022-41082,enabled,0.3,Detect CVE-2022-41082 exploits,scenarios crowdsecurity/CVE-2022-41697,enabled,0.1,Detect CVE-2022-41697 enumeration,scenarios crowdsecurity/CVE-2022-42889,enabled,0.2,Detect CVE-2022-42889 exploits (Text4Shell),scenarios crowdsecurity/CVE-2022-44877,enabled,0.2,Detect CVE-2022-44877 exploits,scenarios crowdsecurity/CVE-2022-46169,enabled,0.1,Detect CVE-2022-46169 brute forcing,scenarios crowdsecurity/apache_log4j2_cve-2021-44228,enabled,0.4,Detect cve-2021-44228 exploitation attemps,scenarios crowdsecurity/f5-big-ip-cve-2020-5902,enabled,0.1,Detect cve-2020-5902 exploitation attemps,scenarios crowdsecurity/fortinet-cve-2018-13379,enabled,0.2,Detect cve-2018-13379 exploitation attemps,scenarios crowdsecurity/grafana-cve-2021-43798,enabled,0.1,Detect cve-2021-43798 exploitation attemps,scenarios crowdsecurity/http-backdoors-attempts,enabled,0.3,Detect attempt to common backdoors,scenarios crowdsecurity/http-bad-user-agent,enabled,0.7,Detect bad user-agents,scenarios crowdsecurity/http-crawl-non_statics,enabled,0.3,Detect aggressive crawl from single ip,scenarios crowdsecurity/http-cve-2021-41773,enabled,0.1,cve-2021-41773,scenarios crowdsecurity/http-cve-2021-42013,enabled,0.1,cve-2021-42013,scenarios crowdsecurity/http-generic-bf,enabled,0.4,Detect generic http brute force,scenarios crowdsecurity/http-open-proxy,enabled,0.3,Detect scan for open proxy,scenarios crowdsecurity/http-path-traversal-probing,enabled,0.2,Detect path traversal attempt,scenarios crowdsecurity/http-probing,enabled,0.2,Detect site scanning/probing from a single ip,scenarios crowdsecurity/http-sensitive-files,enabled,0.2,"Detect attempt to access to sensitive files (.log, .db ..) or folders (.git)",scenarios crowdsecurity/http-sqli-probing,enabled,0.2,A scenario that detects SQL injection probing with minimal false positives,scenarios crowdsecurity/http-xss-probing,enabled,0.2,A scenario that detects XSS probing with minimal false positives,scenarios crowdsecurity/jira_cve-2021-26086,enabled,0.1,Detect Atlassian Jira CVE-2021-26086 exploitation attemps,scenarios crowdsecurity/nginx-req-limit-exceeded,enabled,0.1,Detects IPs which violate nginx's user set request limit.,scenarios crowdsecurity/pulse-secure-sslvpn-cve-2019-11510,enabled,0.2,Detect cve-2019-11510 exploitation attemps,scenarios crowdsecurity/spring4shell_cve-2022-22965,enabled,0.2,Detect cve-2022-22965 probing,scenarios crowdsecurity/ssh-bf,enabled,0.1,Detect ssh bruteforce,scenarios crowdsecurity/ssh-slow-bf,enabled,0.2,Detect slow ssh bruteforce,scenarios crowdsecurity/thinkphp-cve-2018-20062,enabled,0.3,Detect ThinkPHP CVE-2018-20062 exploitation attemps,scenarios crowdsecurity/vmware-cve-2022-22954,enabled,0.2,Detect Vmware CVE-2022-22954 exploitation attempts,scenarios crowdsecurity/vmware-vcenter-vmsa-2021-0027,enabled,0.1,Detect VMSA-2021-0027 exploitation attemps,scenarios ltsich/http-w00tw00t,enabled,0.1,detect w00tw00t,scenarios ```  Acquisition config ```console # On Linux: $ cat /etc/crowdsec/acquis.yaml /etc/crowdsec/acquis.d/\* # paste output hereOn Windows: C:> Get-Content C:\ProgramData\CrowdSec\config\acquis.yaml paste output hereConfig show ``` $ cscli config show Global:    - Configuration Folder   : /etc/crowdsec    - Data Folder            : /var/lib/crowdsec/data    - Hub Folder             : /var/lib/crowdsec/hub    - Simulation File        : /etc/crowdsec/simulation.yaml    - Log Folder             : /var/log/    - Log level              : info    - Log Media              : file Crowdsec:   - Acquisition File        : /etc/crowdsec/acquis.yaml   - Parsers routines        : 1   - Acquisition Folder      : /etc/crowdsec/acquis.d cscli:   - Output                  : human   - Hub Branch              :    - Hub Folder              : /var/lib/crowdsec/hub Local API Server:   - Listen URL              : 127.0.0.1:8080   - Profile File            : /etc/crowdsec/profiles.yaml   - Trusted IPs:        - 127.0.0.1       - ::1   - Database:       - Type                : sqlite       - Path                : /var/lib/crowdsec/data/crowdsec.db       - Flush age           : 7d       - Flush size          : 5000 ```  Prometheus metrics ``` $ cscli metrics # paste output here ```  Related custom configs versions (if applicable) : notification plugins, custom scenarios, parsers etc. |
| --- |
| The text was updated successfully, but these errors were encountered: |

All reactions

[![@github-actions](https://avatars.githubusercontent.com/in/15368?s=40&v=4)](/apps/github-actions)
[github-actions](/apps/github-actions)
bot
added
the
[needs/triage](/crowdsecurity/cs-firewall-bouncer/labels/needs/triage)
label
[May 13, 2024](#event-12798005921)

[![@github-actions](https://avatars.githubusercontent.com/in/15368?s=80&v=4)](/apps/github-actions)
[![GitHub Actions](https://avatars.githubusercontent.com/in/15368?s=40&u=167a342ed94d2a713daf64a8b476ead2cebe1852&v=4)](https://github.com/apps/github-actions)

Copy link

### **[github-actions](/apps/github-actions) bot** commented [May 13, 2024](#issuecomment-2109566538)

| [@bughunter2](https://github.com/bughunter2): Thanks for opening an issue, it is currently awaiting triage.  In the meantime, you can:   1. Check [Crowdsec Documentation](https://docs.crowdsec.net/) to see if your issue can be self resolved. 2. You can also join our [Discord](https://discord.gg/crowdsec). 3. Check [Releases](https://github.com/crowdsecurity/crowdsec/releases/latest) to make sure your agent is on the latest version.  Details I am a bot created to help the [crowdsecurity](https://github.com/crowdsecurity) developers manage community feedback and contributions. You can check out my [manifest file](https://github.com/crowdsecurity/crowdsec/blob/master/.github/governance.yml) to understand my behavior and what I can do. If you want to use this for your project, you can check out the [BirthdayResearch/oss-governance-bot](https://github.com/BirthdayResearch/oss-governance-bot) repository. |
| --- |

All reactions

Sorry, something went wrong.

[![@blotus](https://avatars.githubusercontent.com/u/835060?s=80&v=4)](/blotus)

Copy link

Member

### **[blotus](/blotus)** commented [May 14, 2024](#issuecomment-2109566543)

| Hello,  Looking at the version number of crowdsec, it seems that you are using the packages available in your distro repository. I cannot reproduce the issue with either the latest crowdsec + firewall bouncer version installed from our own repositories OR with a manual build on a debian 12 of crowdsec 1.4.6 and firewall bouncer 0.0.25 (which are the version shipped in debian), which would indicate the issue is coming specifically from the debian build.  The easiest fix for you would be to switch to our repositories (<https://docs.crowdsec.net/docs/next/getting_started/install_crowdsec>), that way you will be able to install much more recent and "known to work" versions.  Now, for the issue itself, it seems like it's coming from the firewall bouncer: when I manually add a decision in crowdsec and query LAPI directly, I see the proper IP in the stream, so the only place for the IP to get reversed is inside the bouncer itself. I'll try to contact the debian package maintainer to see if he has any idea where this could come from.  (I'm also moving the issue to the firewall bouncer repository, and I'll leave it open for now just for tracking purposes) |
| --- |

All reactions

Sorry, something went wrong.

[![@blotus](https://avatars.githubusercontent.com/u/835060?s=40&v=4)](/blotus)
[blotus](/blotus)
transferred this issue from crowdsecurity/crowdsec
[May 14, 2024](#event-12798006050)

[![@github-actions](https://avatars.githubusercontent.com/in/15368?s=80&v=4)](/apps/github-actions)
[![GitHub Actions](https://avatars.githubusercontent.com/in/15368?s=40&u=167a342ed94d2a713daf64a8b476ead2cebe1852&v=4)](https://github.com/apps/github-actions)

Copy link

### **[github-actions](/apps/github-actions) bot** commented [May 14, 2024](#issuecomment-2109566881)

| [@bughunter2](https://github.com/bughunter2): Thanks for opening an issue, it is currently awaiting triage.  In the meantime, you can:   1. Check [Documentation](https://docs.crowdsec.net/docs/next/bouncers/firewall) to see if your issue can be self resolved. 2. You can also join our [Discord](https://discord.gg/crowdsec)  Details I am a bot created to help the [crowdsecurity](https://github.com/crowdsecurity) developers manage community feedback and contributions. You can check out my [manifest file](https://github.com/crowdsecurity/cs-firewall-bouncer/blob/main/.github/governance.yml) to understand my behavior and what I can do. If you want to use this for your project, you can check out the [BirthdayResearch/oss-governance-bot](https://github.com/BirthdayResearch/oss-governance-bot) repository. |
| --- |

All reactions

Sorry, something went wrong.

[![@github-actions](https://avatars.githubusercontent.com/in/15368?s=40&v=4)](/apps/github-actions)
[github-actions](/apps/github-actions)
bot
added
the
[needs/kind](/crowdsecurity/cs-firewall-bouncer/labels/needs/kind)
label
[May 14, 2024](#event-12798008721)

[![@github-actions](https://avatars.githubusercontent.com/in/15368?s=80&v=4)](/apps/github-actions)
[![GitHub Actions](https://avatars.githubusercontent.com/in/15368?s=40&u=167a342ed94d2a713daf64a8b476ead2cebe1852&v=4)](https://github.com/apps/github-actions)

Copy link

### **[github-actions](/apps/github-actions) bot** commented [May 14, 2024](#issuecomment-2109566926)

| [@bughunter2](https://github.com/bughunter2): There are no 'kind' label on this issue. You need a 'kind' label to start the triage process.   * `/kind feature` * `/kind enhancement` * `/kind bug` * `/kind packaging`  Details I am a bot created to help the [crowdsecurity](https://github.com/crowdsecurity) developers manage community feedback and contributions. You can check out my [manifest file](https://github.com/crowdsecurity/cs-firewall-bouncer/blob/main/.github/governance.yml) to understand my behavior and what I can do. If you want to use this for your project, you can check out the [BirthdayResearch/oss-governance-bot](https://github.com/BirthdayResearch/oss-governance-bot) repository. |
| --- |

All reactions

Sorry, something went wrong.

[![@CyrilBrulebois](https://avatars.githubusercontent.com/u/8861145?s=80&v=4)](/CyrilBrulebois)

Copy link

### **[CyrilBrulebois](/CyrilBrulebois)** commented [May 14, 2024](#issuecomment-2109743204)

| Thanks for filing/forwarding the report, I'm able to reproduce this on my bookworm/amd64 system and I'm equally surprised and ashamed to have missed it until today…  That's likely an issue in the google/nftables module, and there's an issue + associated commit that looks promising:   * [AddSet IPv4 wrong byte order on Ubuntu 22.04 google/nftables#225](https://github.com/google/nftables/issues/225) * [google/nftables@d746ecb](https://github.com/google/nftables/commit/d746ecb0e494e7200180c3886fde9664d9100729)   I'll check what happens when I cherry-pick that in the Debian package, and rebuild the bouncer against it. If that helps, I'll upload the package to unstable and request a rebuild of the bouncer (or perform an upload if there are other changes to include along the way). Then I'll file a request to get that updated in stable as well (plus a rebuild).  Sorry about that… |
| --- |

All reactions

Sorry, something went wrong.

[![@CyrilBrulebois](https://avatars.githubusercontent.com/u/8861145?s=80&v=4)](/CyrilBrulebois)

Copy link

### **[CyrilBrulebois](/CyrilBrulebois)** commented [May 17, 2024](#issuecomment-2116902393)

| I've just opened <https://bugs.debian.org/1071247> for tracking purposes.  TL;DR: Applying the aforementioned patch and rebuilding the bouncer against it fixes the issue on LE systems, and doesn't regress on BE systems. I'll coordinate remediation with the security team (if that warrants a DSA) or with the release team (if it doesn't). |
| --- |

All reactions

Sorry, something went wrong.

[![@CyrilBrulebois](https://avatars.githubusercontent.com/u/8861145?s=80&v=4)](/CyrilBrulebois)

Copy link

### **[CyrilBrulebois](/CyrilBrulebois)** commented [May 21, 2024](#issuecomment-2122140220)

| I haven't heard back from the security team yet, but I've just uploaded both packages (`golang-github-google-nftables` and `crowdsec-firewall-bouncer`) to `unstable`, which `urgency=high`. Hopefully they'll reach `testing` soon.  As for `bookworm`, I've published rebuilds of both packages with version numbers that match what would be used for `bookworm-security` or `bookworm-proposed-updates` in a custom repository, which can be configured with:  ``` deb [trusted=yes] https://crowdsec.apt.debamax.com/debian bookworm main  ```  (The signing key is available at that URL if you wish to configure it.) |
| --- |

All reactions

Sorry, something went wrong.

[![@CyrilBrulebois](https://avatars.githubusercontent.com/u/8861145?s=80&v=4)](/CyrilBrulebois)

Copy link

### **[CyrilBrulebois](/CyrilBrulebois)** commented [Jun 15, 2024](#issuecomment-2170970817)

| The Debian security team decided this didn't warrant a security announcement, and that we should get this fixed via the upcoming point release instead: following a green light from the release team, I've just uploaded both packages. They should be available shortly in the `bookworm-proposed-updates` repository, and be merged into the `bookworm` one during the 12.6 point release, scheduled at the end of the month. |
| --- |

All reactions

Sorry, something went wrong.

[![@CyrilBrulebois](https://avatars.githubusercontent.com/u/8861145?s=80&v=4)](/CyrilBrulebois)

Copy link

### **[CyrilBrulebois](/CyrilBrulebois)** commented [Jun 17, 2024](#issuecomment-2172736552)

| Packages have been accepted, built, and published in `bookworm-proposed-updates`:  ``` kibi@tokyo:~$ apt-cache policy crowdsec-firewall-bouncer  crowdsec-firewall-bouncer:   Installed: (none)   Candidate: 0.0.25-4~deb12u1   Version table: →    0.0.25-4~deb12u1 500 →       500 http://deb.debian.org/debian bookworm-proposed-updates/main amd64 Packages      0.0.25-3 500         500 http://deb.debian.org/debian bookworm/main amd64 Packages  ```  (The fixed version is highlighted with arrows.) |
| --- |

 👍
2
 LaurenceJJones and bughunter2 reacted with thumbs up emoji

All reactions

* 👍
  2 reactions

Sorry, something went wrong.

[![@LaurenceJJones](https://avatars.githubusercontent.com/u/23139695?s=80&u=614b46f0372f36e13b39d4ef7409e8c9c1a5babb&v=4)](/LaurenceJJones)

Copy link

Contributor

### **[LaurenceJJones](/LaurenceJJones)** commented [Jun 19, 2024](#issuecomment-2179341662)

| Thank you [@CyrilBrulebois](https://github.com/CyrilBrulebois) for all the updates on the matter, as this seems to be backported and fixed can we class the issue as resolved. Feel free [@bughunter2](https://github.com/bughunter2) to unresolved the issue if this doesn't satisfy as a resolution. |
| --- |

 👍
1
 bughunter2 reacted with thumbs up emoji

All reactions

* 👍
  1 reaction

Sorry, something went wrong.

[![@LaurenceJJones](https://avatars.githubusercontent.com/u/23139695?s=40&u=614b46f0372f36e13b39d4ef7409e8c9c1a5babb&v=4)](/LaurenceJJones)
[LaurenceJJones](/LaurenceJJones)
closed this as [completed](/crowdsecurity/cs-firewall-bouncer/issues?q=is%3Aissue+is%3Aclosed+archived%3Afalse+reason%3Acompleted)
[Jun 21, 2024](#event-13238346434)

[![@GoVulnBot](https://avatars.githubusercontent.com/u/96493708?s=40&v=4)](/GoVulnBot)
[GoVulnBot](/GoVulnBot)
mentioned this issue
[Jul 5, 2024](#ref-issue-2393138946)

[x/vulndb: potential Go vuln in github.com/google/nftables: GHSA-qjvf-8748-9w7h
golang/vulndb#2977](/golang/vulndb/issues/2977)

Closed

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fcrowdsecurity%2Fcs-firewall-bouncer%2Fissues%2F368)

Assignees

No one assigned

Labels

[needs/kind](/crowdsecurity/cs-firewall-bouncer/labels/needs/kind)
[needs/triage](/crowdsecurity/cs-firewall-bouncer/labels/needs/triage)

Projects

None yet

Milestone

No milestone

Development

No branches or pull requests

4 participants

[![@bughunter2](https://avatars.githubusercontent.com/u/16524?s=52&v=4)](/bughunter2) [![@blotus](https://avatars.githubusercontent.com/u/835060?s=52&v=4)](/blotus) [![@CyrilBrulebois](https://avatars.githubusercontent.com/u/8861145?s=52&v=4)](/CyrilBrulebois) [![@LaurenceJJones](https://avatars.githubusercontent.com/u/23139695?s=52&v=4)](/LaurenceJJones)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_f1473f22_20250111_090613.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fgoogle%2Fnftables%2Fissues%2F225)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fgoogle%2Fnftables%2Fissues%2F225)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=google%2Fnftables)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[google](/google)
/
**[nftables](/google/nftables)**
Public

* [Notifications](/login?return_to=%2Fgoogle%2Fnftables) You must be signed in to change notification settings
* [Fork
  139](/login?return_to=%2Fgoogle%2Fnftables)
* [Star
   1.1k](/login?return_to=%2Fgoogle%2Fnftables)

* [Code](/google/nftables)
* [Issues
  17](/google/nftables/issues)
* [Pull requests
  10](/google/nftables/pulls)
* [Actions](/google/nftables/actions)
* [Security](/google/nftables/security)
* [Insights](/google/nftables/pulse)

Additional navigation options

* [Code](/google/nftables)
* [Issues](/google/nftables/issues)
* [Pull requests](/google/nftables/pulls)
* [Actions](/google/nftables/actions)
* [Security](/google/nftables/security)
* [Insights](/google/nftables/pulse)

# AddSet IPv4 wrong byte order on Ubuntu 22.04 #225

[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy link[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy linkClosedClosed[AddSet IPv4 wrong byte order on Ubuntu 22.04](#top)#225Copy link![@eldevel](https://avatars.githubusercontent.com/u/15248223?v=4&size=80)
## Description

![@eldevel](https://avatars.githubusercontent.com/u/15248223?v=4&size=48)[eldevel](https://github.com/eldevel)opened [on May 15, 2023](https://github.com/google/nftables/issues/225#issue-1710017916)

I am trying to add a set with ipv4 addresses, but the ip address bytes are reversed. Here is my code:

```
package main

import (
	"github.com/google/nftables"
	"github.com/vishvananda/netns"
	"net"
)

func main() {
	ns, _ := netns.Get()
	conn := nftables.Conn{NetNS: int(ns)}

	conn.FlushRuleset()

	mangle := conn.AddTable(&nftables.Table{
		Name:   "mangle",
		Family: nftables.TableFamilyINet,
	})

	testSet := &nftables.Set{
		Name:    "test_v4",
		Table:   mangle,
		KeyType: nftables.TypeIPAddr,
	}

	conn.AddSet(testSet, []nftables.SetElement{{
		Key: []byte(net.ParseIP("192.168.1.64").To4()),
	}})

	conn.Flush()
}

```

But the result is:

```
# nft list ruleset
table inet mangle {
        set test_v4 {
                type ipv4_addr
                elements = { 64.1.168.192 }
        }
}

```

Some additional information:

```
# go version
go version go1.18.1 linux/amd64

# nft -v
nftables v1.0.2 (Lester Gooch)

# uname -r -v
5.15.0-71-generic #78-Ubuntu SMP Tue Apr 18 09:00:29 UTC 2023

# cat /etc/lsb-release
DISTRIB_ID=Ubuntu
DISTRIB_RELEASE=22.04
DISTRIB_CODENAME=jammy
DISTRIB_DESCRIPTION="Ubuntu 22.04.2 LTS

# lscpu | grep Order
Byte Order:                      Little Endian

```
👍1
## Activity

[Sign up for free](/signup?return_to=) **to join this conversation on GitHub.** Already have an account? [Sign in to comment](/login?return_to=)
## Metadata

### Assignees

No one assigned

### Labels

No labelsNo labels
### Type

No type
### Projects

No projects
### Milestone

No milestone

### Relationships

None yet
### Development

No branches or pull requests
## Issue actions

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


