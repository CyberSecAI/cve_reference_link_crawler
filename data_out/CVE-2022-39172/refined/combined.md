=== Content from sec-consult.com_d9c4fb8a_20250111_074431.html ===

Toggle Navbar

* [Career](/career/)
* [About us](/about-us/)
* [Contact](/contact/)

* EN
  + [DE](/de/vulnerability-lab/advisory/stored-cross-site-scripting-in-der-mb-support-broker-management-solution-openviva-c2/ "German")
Search

* Security Testing
  + [Web Application Security](/security-testing/web-application-security/)
  + [Penetration Testing](/security-testing/penetration-testing/)
  + [Mobile Security](/security-testing/mobile-security/)
  + [Cloud Security](/security-testing/cloud-security/)
  + [IT Infrastructure Security](/security-testing/it-infrastructure-security/)
  + [Security for SAP Services](/security-testing/security-for-sap-services/)
  + [IoT and Embedded Systems Security](/security-testing/iot-and-embedded-systems-security/)
  + [Red Teaming](/security-testing/red-teaming/)
* Processes & Organisation
  + [Information Security Management (ISM)](/processes-organisation/information-security-management-ism/)
  + [Network and Information Systems Security (NIS)](/processes-organisation/network-and-information-systems-security-nis/)
  + [OT Security](/processes-organisation/ot-security/)
  + [Secure Software Development Consulting](/processes-organisation/secure-software-development/)
  + [Red Teaming](/security-testing/red-teaming/)
  + [SEC Trainings](/processes-organisation/sec-trainings/)
  + [Project- und Program Management](/processes-organisation/project-und-program-management/)
* Incident Response
  + [SEC Defence](/incident-response/sec-defence/)
* [Vulnerability Lab](/vulnerability-lab/)
* [Blog](/blog/)
 [Incident?
Breached?
Report an incident](/incident-response/sec-defence/)

1. [Home](/)
2. [Vulnerability Lab](/vulnerability-lab/)
3. Stored Cross-Site Scripting in mb Support broker management solution openVIVA c2
# Stored Cross-Site Scripting in mb Support broker management solution openVIVA c2

Title

Stored Cross-Site Scripting

Product

mb Support broker management solution openVIVA c2

Vulnerable Version

<20220801

Fixed Version

=>20220801

CVE Number

CVE-2022-39172

Impact

medium

Homepage

[https://mbsupport.de](https://mbsupport.de "https://mbsupport.de")

Found

16.03.2022

By

Daniel Hirschberger (Office Bochum) | SEC Consult Vulnerability Lab

The product openVIVA c2 of the vendor mb Support is vulnerable against a targeted stored cross-site scripting attack. An authenticated user with the role "user" can create a new process/ticket ("Prozess") and insert arbitrary JavaScript in the "Name" field because it is not sanitized. Afterwards, an attacker can assign the process to a person mainly responsible ("Hauptverantwortlicher") which allows them to specify the victim as target.

## Vendor description

*"Support small and medium-sized companies as well as large corporate customers with just one software. Sales , inventory management , billing , e-mail and much more - with openVIVA c2 you get everything in one application. Without system disruption and in one database, you can do all the work of an insurance broker with one piece of software. Connect brokers, intermediaries, insurers and customers directly with our self-service portals . Strengthen your customer relationships and work more efficiently yourself. mb Support offers portals for intermediaries as well as industrial and commercial customers and tailor-made portal solutions for insurers, brokers and private customers."*

Source: <https://mbsupport.de/>

## Business recommendation

The vendor provides an updated version to their customers.

An in-depth security analysis performed by security professionals is highly advised, as the software may be affected from other security issues.

## Vulnerability overview/description

### 1) Stored Cross-Site Scripting (CVE-2022-39172)

An authenticated attacker with privileges of the role 'user' can create a new 'Vorgang' (Process). The field 'Name' is not sanitized and enables an attacker to perform a stored XSS attack. Additionally, the field 'Hauptverantwortlicher' (persons mainly responsible) can be used to assign this 'Vorgang' to another user who will receive it in his overview list. This results in a targeted stored XSS attack.

## Proof of concept

### 1) Stored Cross-Site Scripting (CVE-2022-39172)

The application is developed on top of Oracle Apex (https://apex.oracle.com/en/) which provides several security features to developers. Two of those are request replay protection and parameter checksumming which make it hard to develop a PoC which only consists of requests and responses. Therefore this PoC will be a textual description of the required steps and supplemented with pictures. Additionally the library 'AlertifyJS' is used, which changes the appearance of alert popups which can be confusing if you are used to the standard alert popups.

To execute the attack the following steps have to be performed:
 1. Log in to openVIVA c2
 2. Go to 'mein openVIVA' (my openVIVA)
 3. Click on 'Vorgangszuordnung' (Process Assignment)
 4. Click on 'Neuen Vorgang starten' (Start new Process)
 5. In the new form enter the XSS payload into the 'Name' field, for example  "<script>alert('XSS')</script>"
 6. Choose your victim as 'Hauptverantwortlicher' (persons mainly responsible)
 7. Click on the three dots
 8. Click on 'Speichern' (save)

The victim now has a new 'Vorgang' in his inbox. If the 'Vorgänge' menu is clicked,the victim is redirected to the list of assigned 'Vorgänge'. Because our payload is in the name field it is executed as soon as the list of processes is loaded.

##

![](/fileadmin/_processed_/7/1/csm_sec-consult-c-mb-01-neuer_vorgang_c2137b7bde.png)![](/fileadmin/_processed_/8/d/csm_sec-consult-c-mb-02-neuer_vorgang_79766cd6c1.png)![](/fileadmin/_processed_/9/c/csm_sec-consult-c-mb-03-speichern_10f9ea21c4.png)![](/fileadmin/_processed_/7/c/csm_sec-consult-c-mb-04-dashboard_cdc7f3df4c.png)![](/fileadmin/_processed_/2/2/csm_sec-consult-c-mb-05-xss_16e9837269.png)
## Vulnerable / tested versions

The following version has been tested and found to be vulnerable:

* openVIVA c2 20220101

## Vendor contact timeline

| 2022-03-30 | Contacting vendor through email followed by a telephone call, sent the advisory |
| --- | --- |
| 2022-04-20 | Asking for status update |
| 2022-04-22 | Patch release is planned for August |
| 2022-07-26 | Statuscall - Patch exists, advisory release delayed until rollout to all customers is complete (~ August 2023(!)) |
| 2023-09-18 | Asking for a status update and patch download information. Vendor response - no public link available; few customers still have no patch. |
| 2023-09-25 | Release of security advisory |

## Solution

Upgrade to version 2022-08-01 or later. The vendor has no public download link available as all customers will be patched according to their maintenance contract.

## Workaround

None

## Advisory URL

[sec-consult.com/vulnerability-lab/](https://sec-consult.com/vulnerability-lab/)

EOF Daniel Hirschberger / @2023

*Interested to work with the experts of SEC Consult? Send us your [application](https://sec-consult.com/career/)*

*Interested in improving your cyber security with the experts of SEC Consult? Contact our [local offices](https://sec-consult.com/contact/)*

[Back](/vulnerability-lab/)

* [Legal Notice](/legalnotice/)
* [Privacy Statement](/privacy-statement/)
* [Jobs](/career/)

SEC Consult is one of the leading consultancies in the field of cyber and [application security](/security-testing/web-application-security/ "Web Application Security"). The company specializes in [information security management](/processes-organisation/information-security-management-ism/ "Information Security Management (ISM)"), [NIS security audits](/processes-organisation/network-and-information-systems-security-nis/ "NIS security audits"), [penetration testing](/security-testing/penetration-testing/ "Pentesting (Pentest)"), ISO 27001 certification support, [Cyber Defence](/incident-response/sec-defence/ "Cyber Defence") and [secure software certification](/processes-organisation/secure-software-development/ "Secure Software Development Consulting"). SEC Consult is part of [Eviden](https://eviden.com/ "Link to Eviden website").

[![bsi ISO/IEC 27001 Information Security Management CERTIFIED](/typo3temp/assets/_processed_/c/2/csm_bsi_9a24e74563.png)](/about-us/ "About us")[![ISO 27001 CREST certified](/typo3temp/assets/_processed_/0/6/csm_crest_0eb9c5864d.png)](/about-us/ "About us")[![Great Place To Work AT certified](/typo3temp/assets/_processed_/0/3/csm_great-place-to-work-at_773b265aa6.png)](/about-us/ "About us")[![Great Place To Work DE certified](/typo3temp/assets/_processed_/d/6/csm_great-place-to-work-de_2fcb537270.png)](/about-us/ "About us")

## We use Cookies

We use cookies to offer you a perfect visit experience. These include cookies that are necessary for the operation of the site and for the control of our commercial corporate goals, as well as those that are only used for anonymous statistical purposes, for convenience settings or to display personalized content. Decide for yourself which categories you want to allow. Please note that based on your settings, not all functions of the site may be available.

**[Legal Notice](/legalnotice/)** •  **[Privacy Statement](/privacy-statement/)**

### Technically required

(
0
Service
)

no

Technically required (
0
Service
)

yes

### Analysis / statistics

(
1
Service
)

Anonymous evaluation for troubleshooting and further development

no

Analysis / statistics (
1
Service
)

yes

#### Matomo

no

Matomo

yes

Matomo.org
Show details

Hide details

**Purpose**: Error analysis, statistical evaluation of our website accesses, campaign analysis, conversion tracking.
 **Processing operations**: collection of access data, data from your browser and data about the content accessed; execution of analysis software and storage of data on your terminal device, anonymization of the data collected; evaluation of the anonymous data in the form of statistics.
 **Storage period**: 1 year.
 **Joint controller**: LimeSoda Interactive Marketing GmbH.
 **Legal basis for data processing**: Art. 6 para. 1 lit. f of the DSGVO.
 **Consequences of non-consent**: This basic tracking is absolutely necessary for the operation of our website.
 **Data transfer**: The data collected with Matomo is stored on our own servers. It is not passed on to third parties.

Accept selected

Reject all

Accept all


