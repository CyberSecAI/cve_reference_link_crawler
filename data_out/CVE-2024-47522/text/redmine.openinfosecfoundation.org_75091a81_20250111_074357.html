

⚲

### Project

### General

### Profile

* [Sign in](/login)
* [Register](/account/register)

* [Home](/)
* [Projects](/projects)
* [Help](https://www.redmine.org/guide)

[Search](/projects/suricata/search?scope=subprojects):

 Suricata[All Projects](/projects?jump=issues)
# Suricata

* [Overview](/projects/suricata)
* [Activity](/projects/suricata/activity)
* [Roadmap](/projects/suricata/roadmap)
* [Issues](/projects/suricata/issues)
* [Wiki](/projects/suricata/wiki)
* [Files](/projects/suricata/files)

### Custom queries

* [8.0.0 Stories](/projects/suricata/issues?query_id=90)
* [Good First Issues](/projects/suricata/issues?query_id=41)
* [OISF community](/projects/suricata/issues?query_id=3)

Actions
Copy link
## Security #7267

closed

### ja4: non alphanumeric characters in alpn lead to panic

Added by [Philippe Antoine](/users/1820) [4 months](/projects/suricata/activity?from=2024-09-23 "09/23/2024 09:25 AM") ago.
Updated [3 months](/projects/suricata/activity?from=2024-10-16 "10/16/2024 07:51 AM") ago.

Status:ClosedPriority:NormalAssignee:[Philippe Antoine](/users/1820)Target version:[8.0.0-beta1](/versions/163 "04/01/2025")
Affected Versions:Label:CVE:[2024-47522](https://nvd.nist.gov/vuln/detail/CVE-2024-47522)Git IDs:

1e152d1f1060a5afd39496d4f2556e7159cd22cc

Severity:CRITICALDisclosure Date:12/23/2024

---

**Description**

Found by oss-fuzz:
<https://issues.oss-fuzz.com/issues/368729563>

And we did not follow what the spec described for the case <https://github.com/FoxIO-LLC/ja4/blob/main/technical_details/JA4.md#alpn-extension-value>

---

**Subtasks**
[1](/issues?parent_id=~7267&set_filter=true&status_id=%2A) (0 open — [1 closed](/issues?parent_id=~7267&set_filter=true&status_id=c))

|  | [Security #7268](/issues/7268): ja4: non alphanumeric characters in alpn lead to panic (7.0.x backport) | Closed | [Philippe Antoine](/users/1820) |  |  |  | Actions |
| --- | --- | --- | --- | --- | --- | --- | --- |

* [History](/issues/7267?tab=history)
* [Notes](/issues/7267?tab=notes)
* [Property changes](/issues/7267?tab=properties)

ActionsCopy link
[#1](#note-1)
#### Updated by [OISF Ticketbot](/users/7712) [4 months](/projects/suricata/activity?from=2024-09-23 "09/23/2024 09:26 AM") ago

* **Subtask** *#7268* added

ActionsCopy link
[#2](#note-2)
#### Updated by [OISF Ticketbot](/users/7712) [4 months](/projects/suricata/activity?from=2024-09-23 "09/23/2024 09:26 AM") ago

* **Label** deleted (~~*Needs backport to 7.0*~~)

ActionsCopy link
[#3](#note-3)
#### Updated by [Philippe Antoine](/users/1820) [4 months](/projects/suricata/activity?from=2024-09-23 "09/23/2024 09:50 AM") ago

* **Status** changed from *New* to *In Review*
* **Label** *Needs backport to 7.0* added

Gitlab MR

ActionsCopy link
[#4](#note-4)
#### Updated by [Philippe Antoine](/users/1820) [4 months](/projects/suricata/activity?from=2024-09-23 "09/23/2024 09:50 AM") ago

* **Label** deleted (~~*Needs backport to 7.0*~~)

ActionsCopy link
[#5](#note-5)
#### Updated by [Philippe Antoine](/users/1820) [4 months](/projects/suricata/activity?from=2024-09-23 "09/23/2024 12:45 PM") ago

Stack trace :
```

thread '<unnamed>' panicked at src/ja4.rs:265:16:
source slice length (37) does not match destination slice length (36)

    #0 0x7adeac77f00b in raise /build/glibc-LcI20x/glibc-2.31/sysdeps/unix/sysv/linux/raise.c:51:1
    #1 0x7adeac75e858 in abort /build/glibc-LcI20x/glibc-2.31/stdlib/abort.c:79:7
    #2 0x5a3fa7ac8086 in std::sys::pal::unix::abort_internal::h6262fe410407344a /rustc/1a648b397dedc98ada3dd3360f6d661ec2436c56/library/std/src/sys/pal/unix/mod.rs:371:14
    #3 0x5a3fa7abdab8 in rust_panic /rustc/1a648b397dedc98ada3dd3360f6d661ec2436c56/library/std/src/panicking.rs:834:5
    #4 0x5a3fa7abd899 in std::panicking::rust_panic_with_hook::haac9f65a4111ce33 /rustc/1a648b397dedc98ada3dd3360f6d661ec2436c56/library/std/src/panicking.rs:803:5
    #5 0x5a3fa7abd5a1 in std::panicking::begin_panic_handler::_$u7b$$u7b$closure$u7d$$u7d$::h6a452ac7fecf7288 /rustc/1a648b397dedc98ada3dd3360f6d661ec2436c56/library/std/src/panicking.rs:659:13
    #6 0x5a3fa7abaaa5 in std::sys_common::backtrace::__rust_end_short_backtrace::ha4c176c669fc3286 /rustc/1a648b397dedc98ada3dd3360f6d661ec2436c56/library/std/src/sys_common/backtrace.rs:171:18
    #7 0x5a3fa7abd2f3 in rust_begin_unwind /rustc/1a648b397dedc98ada3dd3360f6d661ec2436c56/library/std/src/panicking.rs:647:5
    #8 0x5a3fa49e5fd4 in core::panicking::panic_fmt::hfae197985af26789 /rustc/1a648b397dedc98ada3dd3360f6d661ec2436c56/library/core/src/panicking.rs:72:14
    #9 0x5a3fa49e66f1 in core::slice::_$LT$impl$u20$$u5b$T$u5d$$GT$::copy_from_slice::len_mismatch_fail::h75ad154f73fa60ec /rustc/1a648b397dedc98ada3dd3360f6d661ec2436c56/library/core/src/slice/mod.rs:3597:13
    #10 0x5a3fa5799db2 in core::slice::_$LT$impl$u20$$u5b$T$u5d$$GT$::copy_from_slice::h18261594c9e199d2 /rustc/1a648b397dedc98ada3dd3360f6d661ec2436c56/library/core/src/slice/mod.rs:3604:13
    #11 0x5a3fa5799db2 in SCJA4GetHash suricata/rust/src/ja4.rs:265:5
    #12 0x5a3fa4bcdb3c in GetData suricata/src/detect-ja4-hash.c:147:9
    #13 0x5a3fa4b5efb3 in PrefilterMpm suricata/src/detect-engine-prefilter.c:727:32
    #14 0x5a3fa4b58c9a in DetectRunPrefilterTx suricata/src/detect-engine-prefilter.c:125:9
    #15 0x5a3fa4ff0818 in DetectRunTx suricata/src/detect.c:1466:13
    #16 0x5a3fa4ff0818 in DetectRun suricata/src/detect.c:174:9
    #17 0x5a3fa4febb78 in Detect suricata/src/detect.c:0
    #18 0x5a3fa4c73ff5 in FlowWorker suricata/src/flow-worker.c:636:9
    #19 0x5a3fa4ac19d9 in LLVMFuzzerTestOneInput suricata/src/tests/fuzz/fuzz_sigpcap_aware.c:179:13

```

ActionsCopy link
[#6](#note-6)
#### Updated by [Victor Julien](/users/4) [4 months](/projects/suricata/activity?from=2024-09-23 "09/23/2024 02:07 PM") ago

* **Severity** changed from *MODERATE* to *CRITICAL*

ActionsCopy link
[#7](#note-7)
#### Updated by [Juliana Fajardini Reichow](/users/6858) [4 months](/projects/suricata/activity?from=2024-09-27 "09/27/2024 08:42 PM") ago

* **CVE** set to *2024-47522*

<https://github.com/OISF/suricata/security/advisories/GHSA-w5xv-6586-jpm7>

ActionsCopy link
[#8](#note-8)
#### Updated by [Philippe Antoine](/users/1820) [3 months](/projects/suricata/activity?from=2024-10-01 "10/01/2024 09:14 AM") ago

* **Status** changed from *In Review* to *Closed*

<https://github.com/OISF/suricata/commit/1e152d1f1060a5afd39496d4f2556e7159cd22cc>

ActionsCopy link
[#9](#note-9)
#### Updated by [Philippe Antoine](/users/1820) [3 months](/projects/suricata/activity?from=2024-10-01 "10/01/2024 11:28 AM") ago

* **Git IDs** updated ([diff](/journals/36284/diff?detail_id=36871 "View differences"))

ActionsCopy link
[#10](#note-10)
#### Updated by [Victor Julien](/users/4) [3 months](/projects/suricata/activity?from=2024-10-16 "10/16/2024 07:51 AM") ago

* **Private** changed from *Yes* to *No*

Actions
Copy link

Also available in: [Atom](/issues/7267.atom)
[PDF](/issues/7267.pdf)

Powered by [Redmine](https://www.redmine.org/) © 2006-2024 Jean-Philippe Lang

Loading...

