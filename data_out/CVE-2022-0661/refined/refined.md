- **Root cause of vulnerability:** The plugin fails to sanitize the body of the adverts injected into pages. This allows a high-privileged user (Admin+) to inject arbitrary HTML, JavaScript, or even PHP code.
- **Weaknesses/vulnerabilities present:**
    - Stored Cross-Site Scripting (XSS): Due to the lack of sanitization, an attacker can inject malicious JavaScript code that will be executed when other users visit the affected pages.
    - Remote Code Execution (RCE): By injecting PHP code, an attacker can execute arbitrary commands on the server. This is possible even when file editing is disabled using the `DISALLOW_FILE_EDIT` and `DISALLOW_FILE_MOD` constants.
- **Impact of exploitation:**
    - XSS: An attacker can perform various malicious actions on the site, such as stealing user cookies, redirecting users to malicious sites, or defacing the website.
    - RCE: An attacker can gain complete control of the server, allowing them to access sensitive data, modify files, or perform other malicious activities.
- **Attack vectors:**
    - The vulnerability is triggered through the plugin's settings page under "Ad Injection".
    - An attacker would need to navigate to "Settings > Ad Injection".
    - The malicious payload is injected in the "Adverts: Top ad" section.
- **Required attacker capabilities/position:**
    - The attacker needs to be a high-privileged user (Admin+) in order to exploit the vulnerability.