

⚲

### Project

### General

### Profile

* [Sign in](/login)
* [Register](/account/register)

* [Home](/)
* [Projects](/projects)
* [Help](https://www.redmine.org/guide)

[Search](/projects/pfsense/search?scope=subprojects):

 pfSense[All Projects](/projects?jump=issues)
# pfSense

* [Overview](/projects/pfsense)
* [Activity](/projects/pfsense/activity)
* [Roadmap](/projects/pfsense/roadmap)
* [Issues](/projects/pfsense/issues)
* [Gantt](/projects/pfsense/issues/gantt)
* [Calendar](/projects/pfsense/issues/calendar)
* [News](/projects/pfsense/news)
* [Documents](/projects/pfsense/documents)
* [Repository](/projects/pfsense/repository)

### Custom queries

* [2.7.0 - Resolved/Closed](/projects/pfsense/issues?query_id=218)
* [2.7.1 - All Open Issues](/projects/pfsense/issues?query_id=250)
* [2.7.1 - Resolved/Closed](/projects/pfsense/issues?query_id=249)
* [2.7.2 - Resolved/Closed](/projects/pfsense/issues?query_id=254)
* [2.8.0 - All Open Bugs](/projects/pfsense/issues?query_id=164)
* [2.8.0 - All Open Features](/projects/pfsense/issues?query_id=161)
* [2.8.0 - All Open Issues](/projects/pfsense/issues?query_id=165)
* [2.8.0 - All Open Regressions](/projects/pfsense/issues?query_id=108)
* [2.8.0 - Feedback](/projects/pfsense/issues?query_id=105)
* [2.8.0 - Needs Attention](/projects/pfsense/issues?query_id=244)
* [2.8.0 - New/Confirmed](/projects/pfsense/issues?query_id=106)
* [2.8.0 - Pull Requests](/projects/pfsense/issues?query_id=142)
* [2.8.0 - Regressions affecting 2.7.0](/projects/pfsense/issues?query_id=202)
* [2.8.0 - Resolved/Closed](/projects/pfsense/issues?query_id=245)
* [23.01 Plus - All Closed Issues](/projects/pfsense/issues?query_id=224)
* [23.01 Target - All Closed Issues](/projects/pfsense/issues?query_id=223)
* [23.05 Plus - All Closed Issues](/projects/pfsense/issues?query_id=232)
* [23.05 Target - All Closed Issues](/projects/pfsense/issues?query_id=233)
* [23.05.1 Plus - All Closed Issues](/projects/pfsense/issues?query_id=240)
* [23.05.1 Target - All Closed Issues](/projects/pfsense/issues?query_id=239)
* [23.09 Plus - All Closed Issues](/projects/pfsense/issues?query_id=236)
* [23.09 Target - All Closed Issues](/projects/pfsense/issues?query_id=235)
* [23.09.1 Plus - All Closed Issues](/projects/pfsense/issues?query_id=255)
* [23.09.1 Target - All Closed Issues](/projects/pfsense/issues?query_id=257)
* [24.03 Plus - All Closed Issues](/projects/pfsense/issues?query_id=251)
* [24.03 Target - All Closed Issues](/projects/pfsense/issues?query_id=252)
* [24.11 Plus - All Closed Issues](/projects/pfsense/issues?query_id=259)
* [24.11 Target - All Closed Issues](/projects/pfsense/issues?query_id=260)
* [25.03 Plus - All Closed Issues](/projects/pfsense/issues?query_id=262)
* [25.03 Plus - All Open Issues](/projects/pfsense/issues?query_id=263)
* [25.03 Plus - Feedback Issues](/projects/pfsense/issues?query_id=264)
* [25.03 Plus - Needs Attention/Work](/projects/pfsense/issues?query_id=265)
* [25.03 Plus - New/Confirmed/In Progress Issues](/projects/pfsense/issues?query_id=266)
* [25.03 Plus - Pull Request Review](/projects/pfsense/issues?query_id=190)
* [25.03 Plus - Waiting on Merge](/projects/pfsense/issues?query_id=189)
* [25.03 Target - All Closed Issues](/projects/pfsense/issues?query_id=267)
* [25.03 Target - All Open Issues](/projects/pfsense/issues?query_id=268)
* [All Open Issues assigned to Me](/projects/pfsense/issues?query_id=57)
* [All Open Pull Requests](/projects/pfsense/issues?query_id=143)
* [Any Target - All Open Regressions](/projects/pfsense/issues?query_id=170)
* [Any Target - Feedback Issues](/projects/pfsense/issues?query_id=100)
* [CE-Next - All Closed Issues (Move to specific target)](/projects/pfsense/issues?query_id=171)
* [CE-Next - All Open Issues](/projects/pfsense/issues?query_id=167)
* [CE-Next - Feedback (Likely needs target changed)](/projects/pfsense/issues?query_id=181)
* [New Issues by Category - Future Target](/projects/pfsense/issues?query_id=137)
* [New Issues by Category - No Target](/projects/pfsense/issues?query_id=134)
* [New Issues by Category - No Target+Future](/projects/pfsense/issues?query_id=138)
* [No Target - All Open Issues (Base Only)](/projects/pfsense/issues?query_id=34)
* [No Target - New Issues (Base Only)](/projects/pfsense/issues?query_id=33)
* [No Target - New Issues (Base and Packages)](/projects/pfsense/issues?query_id=27)
* [Release Notes - Plus Target Version (DO NOT EDIT)](/projects/pfsense/issues?query_id=191)
* [Release Notes - Target Version (DO NOT EDIT)](/projects/pfsense/issues?query_id=169)

Actions
Copy link
## Bug #15778

closed
![](https://www.gravatar.com/avatar/7ab3973ba8593e45396aaf66576f889d?rating=PG&size=50&default=identicon "Author: zhao mouren")
![](https://www.gravatar.com/avatar/a2838b99a49c651ce36cd2b4307a50ba?rating=PG&size=22&default=identicon "Assignee: Jim Pingle")

### Interface group members are not validated on load/save on ``interfaces\_groups\_edit.php``, and are printed without encoding on ``interfaces\_groups.php``

Added by [zhao mouren](/users/61569) [3 months](/projects/pfsense/activity?from=2024-10-12 "10/12/2024 06:42 AM") ago.
Updated [about 2 months](/projects/pfsense/activity?from=2024-11-26 "11/26/2024 02:14 AM") ago.

Status:ClosedPriority:HighAssignee:[Jim Pingle](/users/10)Category:InterfacesTarget version:[2.8.0](/versions/74)Start date:Due date:% Done:

|  |
| --- |

100%

Estimated time:
Plus Target Version:24.11Release Notes:DefaultAffected Version:AllAffected Architecture:

---

**Description**

When submitting interface group members on `interfaces_groups_edit.php` the member list is not validated before it is then stored in the configuration. The group member list is then printed without encoding on `interfaces_groups.php`, leading to a potential stored XSS.

Original report URL: <https://github.com/physicszq/web_issue/blob/main/pfsense/interfaces_groups_edit_file.md_xss.md>

* [History](/issues/15778?tab=history)
* [Notes](/issues/15778?tab=notes)
* [Property changes](/issues/15778?tab=properties)
* [Associated revisions](/issues/15778?tab=changesets)

ActionsCopy link
[#1](#note-1)
#### Updated by [Jim Pingle](/users/10) [3 months](/projects/pfsense/activity?from=2024-10-14 "10/14/2024 02:43 PM") ago

* **Subject** changed from *interfaces\_groups\_edit.php exists xss* to *Interface group members are not validated on load/save on ``interfaces\_groups\_edit.php``, and are printed without encoding on ``interfaces\_groups.php``*
* **Description** updated ([diff](/journals/74726/diff?detail_id=65177 "View differences"))
* **Status** changed from *New* to *Confirmed*
* **Assignee** set to *Jim Pingle*
* **Priority** changed from *Normal* to *High*
* **Target version** set to *2.8.0*
* **Plus Target Version** set to *24.11*

In the future, please submit security concerns privately via the process documented at <https://www.netgate.com/security>

Updated subject/description to match observed behavior. Keeping public for now since it was submitted publicly.

I was able to confirm a problem here but the screenshot at the linked URL is weird in that the URL and XSS dialog in the screenshot are from `interfaces_groups.php` but that does not match the rest of the content in the screenshot background which is from `interfaces_groups_edit.php`. Might be a browser quirk or how the screenshot was created, but it's still odd. There isn't any way I could find that resulted in an XSS dialog on `interfaces_groups_edit.php` directly with the error message shown in the screenshot about the group already existing. The XSS appeared on `interfaces_groups.php` where it prints the member list, which matches the URL in the screenshot.

ActionsCopy link
[#2](#note-2)
#### Updated by [Jim Pingle](/users/10) [3 months](/projects/pfsense/activity?from=2024-10-14 "10/14/2024 02:55 PM") ago

* **Status** changed from *Confirmed* to *Feedback*
* **% Done** changed from *0* to *100*

Applied in changeset [9a843098cf3f28c27c3e615c4c788c84bd29df6f](/projects/pfsense/repository/2/revisions/9a843098cf3f28c27c3e615c4c788c84bd29df6f "Interface group member validation/encoding. Fixes #15778").

ActionsCopy link
[#3](#note-3)
#### Updated by [Jim Pingle](/users/10) [2 months](/projects/pfsense/activity?from=2024-11-11 "11/11/2024 04:08 PM") ago

* **Status** changed from *Feedback* to *Closed*

Seems to be working properly on save and load in current builds.

ActionsCopy link
[#5](#note-5)
#### Updated by [Jim Pingle](/users/10) [about 2 months](/projects/pfsense/activity?from=2024-11-26 "11/26/2024 02:13 AM") ago

* **Private** changed from *No* to *Yes*

ActionsCopy link
[#6](#note-6)
#### Updated by [Jim Pingle](/users/10) [about 2 months](/projects/pfsense/activity?from=2024-11-26 "11/26/2024 02:14 AM") ago

* **Private** changed from *Yes* to *No*

Actions
Copy link

Also available in: [Atom](/issues/15778.atom)
[PDF](/issues/15778.pdf)

Powered by [Redmine](https://www.redmine.org/) © 2006-2023 Jean-Philippe Lang

Loading...

