=== Content from rehmeinfosec.de_cce42183_20250110_130427.html ===
[Homerehme.infosec[**Was, Wie, Warum?**Schnelleinstieg](/schnelleinstieg)](/)

* [Services](/leistungen)
  + [Penetrationstests & Red-Teaming](/leistungen/penetrationstests-red-teaming)
  + [Code Audits](/leistungen/code-audits)
* [Unternehmen](/unternehmen)
* [Labor](/labor)
  + [OS Command Injection in ILIAS eLearning platform](/labor/os-command-injection-in-ilias-elearning-platform)
  + [Mehrere Remote Code Execution Sicherheitslücken in "Fragenpool für Tests" Import](/labor/mehrere-remote-code-execution-sicherheitsluecken-in-fragenpool-fuer-tests-import)
  + [Remote Code Execution in "Fragenpool für Umfragen" Import](/labor/remote-code-execution-in-fragenpool-fuer-umfragen-import)
  + [Multiple Cross Site Scipting (XSS) in ILIAS eLearning platform](/labor/multiple-cross-site-scipting-xss-in-ilias-elearning-platform)
  + [Local File Inclusion in ILIAS eLearning platform](/labor/local-file-inclusion-in-ilias-elearning-platform)
  + [Remote Code Execution und .htaccess Bypass in ILIAS eLearning platform](/labor/remote-code-execution-and-bypassing-htaccess-rule-in-ilias-elearning-platform)
  + [Arbitrary File Deletion in ILIAS eLearning platform](/labor/arbitrary-file-deletion-in-ilias-elearning-platform)
  + [Remote Code Execution in Stud.IP (eLearning platform)](/labor/cve-2023-50982)
  + [OS Command Injection in ILIAS eLearning platform](/labor/cve-2023-45869)
  + [Local File Inclusion to Arbitrary File Copy in ILIAS eLearning platform](/labor/cve-2023-45868)
  + [XSS in Roundcube Webmailer](/labor/cve-2023-47272)
  + [Local File Inclusion in ILIAS eLearning platform](/labor/cve-2023-45867)
[Kontakt](/impressum)
## Weitere Veröffentlichungen

In unserem Labor schreiben wir regelmäßig in Form von Blogbeiträgen über identifizierte Sicherheitslücken, welche nach dem [Responsible Disclosure](/responsible-disclosure) Verfahren veröffentlicht werden.

[Zum Labor](/labor)
#### Veröffentlichung (CVE-2023-45867)

# Local File Inclusion in ILIAS eLearning platform

26.10.2023 - Rene Rehme

Im Zuge eines Penetrationstests wurde eine [Local File Inclusion (LFI)](https://capec.mitre.org/data/definitions/252.html) Sicherheitslücke in **ILIAS Version7.25 (2023-09-12 Release)** entdeckt. Eine Ausnutzung hat zudem zur Folge, dass durch den Angreifer definierte Dateien bzw. ganze Verzeichnisse verschoben werden (Arbitrary File Movement) Für die Ausnutzung der Sicherheitslücke werden keine Administrator-Rechte benötigt.

#### Responsible Disclosure

⚑ 25. Sep. 2023 - Die Sicherheitslücke wurde identifiziert.
→ 26. Sep. 2023 - Die Sicherheitslücke wurde an ILIAS gemeldet.
← 29. Sep. 2023 - ILIAS bestätigt den Erhalt des Reports.
← 06. Okt. 2023 - ILIAS bestätigt, dass die Sicherheitslücke geschlossen wurde.
← 23. Okt. 2023 - Patched ILIAS-Release: [8.6](https://docu.ilias.de/goto_docu_pg_154840_35.html), [7.26](https://docu.ilias.de/goto_docu_pg_154839_35.html)

## Allgemeine Beschreibung

Eine Local File Inclusion Schwachstelle wurde im Modul ScormAicc gefunden. Ein Angreifer, mit einem privilegierten Account, kann mit entsprechender Berechtigung potenziell den Inhalt jede auf dem Webserver abgelegten Datei, welche mit dem Webserver-User www-data gelesen werden kann, abrufen. Zum Beispiel Konfigurationsdateien oder auch Dateien außerhalb des documentRoot.

## Proof of Concept (PoC)

![content image](https://rehmeinfosec.de/_Resources/Persistent/5/8/a/7/58a7662ca1666f6c4a3957a3c57d83f25e4d876d/85c4989e2c324d92a3299755caff9018-2233x1467.webp)

Zu sehen ist, wie die Systemdatei  /etc/passwd , welche außerhalb des documentRoot liegt und eigentlich nicht öffentlich abrufbar ist, ausgelesen wird.

## Reproduktion der Sicherheitslücke

#### Reproduktionsschritte

**Schritt 1:**

Installieren Sie eine ILIAS Version7.25 (2023-09-12 Release) Instanz auf einem Testsystem.

**Schritt 2:**

Loggen Sie sich mit einem User Account ein, der die Rechte Einstellungen bearbeiten: ILIAS-Lernmodul bearbeiten besitzt.

1. Navigieren Sie auf Magazin
2. Klicken Sie auf den Button Neues Objekt hinzufügen
3. Erstellen Sie ein neues SCORM-Lernmodul über Option 2: Neues SCORM-Lernmodul anlegen.
4. Navigieren Sie auf den Tab Export
5. Kopieren Sie den Link, welcher unter Download hinterlegt ist. (*Rechtsklick -> Link kopieren*).

Der Download-Link ist (z.B.) wie folgt aufgebaut:

URL
```
http://ilias.local/ilias.php?ref_id=157&file=1697232056__0__sahs_671.zip&type=SCORM%202004%203rd&cmd=downloadExportFile&cmdClass=ilobjscorm2004learningmodulegui&cmdNode=wz:q3&baseClass=ilsahseditgui
```

Modifizieren Sie den URL-Parameter file, um via Directory Traversal z.B. auf die Systemdatei /etc/passwd zuzugreifen:

URL
```
https://ilias.local/ilias.php?ref_id=157&file=../../../../../../../../etc/passwd&cmd=downloadExportFile&cmdClass=ilobjscorm2004learningmodulegui&cmdNode=wz:q3&baseClass=ilSAHSEditGUI
```

Je nachdem unter welchem Pfad die Ilias Instanz installiert wurde, müssen entsprechend ../ in der URL erweitert oder entfernt werden.

## Bewertung

6.5Medium[CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/)
#### Exploitability Metrics

**Attack Vector (AV): N**
Es handelt sich um einen Netzwerkangriff. Die verwundbare Komponente ist "aus der Ferne ausnutzbar" und wird als ein Angriff betrachtet, der auf Protokollebene über das Internet stattfindet.

**Attack Complexity (AC): L**
Besondere Zugangsbedingungen oder mildernde Umstände bestehen nicht.

**Privileges Required (PR): L**
Der Angreifer benötigt Privilegien, die grundlegende Benutzerfunktionen eines Users bereitstellen. Für eine Ausnutzung reicht i.d.R die "Tutoren" Rolle.

**User Interaction (UI): N**
Es ist keine User-Interaktion durch ein Opfer notwendig.

**Scope (S): U**
Die anfällige und betroffene Komponente ist die Webanwendung.

**Confidentiality (C): H**
Bei einem erfolgreichen Angriff kommt es zu einem totalen Verlust der Vertraulichkeit. Ressourcen innerhalb der betroffenen Komponente und weiterführend Komponenten des Betriebssystems werden dem Angreifer bei gegebenem Lesezugriff und entsprechender Berechtigung durch den Webserver-User www-data offengelegt, indem Verzeichnisse mit Dateien an einen öffentlich abrufbaren Ort verschoben werden.

**Integrity (I): N**
Bei einem erfolgreichen Angriff kommt es zu keinem Verlust der Integrität. Der Angreifer ist nicht in der Lage, Dateien zu verändern. Vermutlich könnte ein Angreifer durch das Verschieben von Konfigurationsdateien an Zugänge gelangen, die Zugriff auf weitere Komponenten zur Folge haben (siehe PoC Bild). Es ist demnach po­ten­zi­ell möglich, dass ein Angreifer Daten oder Dateien durch eine weiterführende Eskalation verändern kann. Dies ist aber spekulativ.

**Availability (A): H**
Bei einem erfolgreichen Angriff ist der Angreifer ist in der Lage, den Zugang zu den Ressourcen der betroffenen Komponente und weiterführend aus Komponenten des Betriebssystems durch das Verschieben (und nachträglich löschen) von Verzeichnissen vollständig zu verweigern.

## Externe Informationen

**heise online**

<https://www.heise.de/news/NATO-und-Behoerden-von-kritischer-Luecke-in-Lernplattform-ILIAS-betroffen-9344057.html>

**CVE (MITRE)**

<https://www.cve.org/CVERecord?id=CVE-2023-45867>

**NIST (National Vulnerability Database)**

<https://nvd.nist.gov/vuln/detail/CVE-2023-45867>

rehme.infosec

Piiip, in [meinem persönlichen Blog](https://renerehme.de) veröffentliche ich Artikel über IT-Security, persönliche Projekte, Coding Experimente oder Basteleien. Im Labor findest du aktuelle Veröffentlichungen von gefunden Sicherheitslücken in Software.

* [LinkedIn](https://www.linkedin.com/company/100283045/)
* [XING](https://www.xing.com/pages/rehme-infosec)

Services

* [Penetration Testing](/leistungen/penetrationstests-red-teaming "Penetration Testing")
* [Red-Teaming](/leistungen/penetrationstests-red-teaming "Red-Teaming")
* [Code Audits](/leistungen/code-audits "Code Audits")

Unternehmen

* [Über uns](/unternehmen "Über uns")

Nützliche Links

* [Responsible Disclosure](/labor/responsible-disclosure)
* [IT-Sicherheitshinweise des CERT-Bund](/alle-it-sicherheitshinweise-des-cert-bund)

Legal

* [Impressum](/impressum)
* [Datenschutz](/datenschutz)

© rehme.infosec 2024, alle Rechte vorbehalten



=== Content from rehmeinfosec.de_324fc6b8_20250110_130426.html ===
[Homerehme.infosec[**Was, Wie, Warum?**Schnelleinstieg](/schnelleinstieg)](/)

* [Labor](/labor)
  + [ILIAS 7 & 8 - OS Command Injection](/labor/ilias-7-8-os-command-injection)
  + [ILIAS 7 & 8 - Mehrere Remote Code Execution Sicherheitslücken in "Fragenpool für Tests" Import](/labor/ilias-7-8-mehrere-remote-code-execution-sicherheitsluecken-in-fragenpool-fuer-tests-import)
  + [ILIAS 7 - Remote Code Execution in "Fragenpool für Umfragen" Import](/labor/ilias-7-remote-code-execution-in-fragenpool-fuer-umfragen-import)
  + [RoundCube 1.6.4 and 1.5.5 - Cross Site Scripting (XSS)](/labor/roundcube-1-6-4-and-1-5-5-cross-site-scripting-xss)
  + [Multiple Cross Site Scipting (XSS) in ILIAS eLearning platform](/labor/multiple-cross-site-scipting-xss-in-ilias-elearning-platform)
  + [Local File Inclusion in ILIAS eLearning platform](/labor/local-file-inclusion-in-ilias-elearning-platform)
  + [Remote Code Execution und .htaccess Bypass in ILIAS eLearning platform](/labor/remote-code-execution-and-bypassing-htaccess-rule-in-ilias-elearning-platform)
  + [Arbitrary File Deletion in ILIAS eLearning platform](/labor/arbitrary-file-deletion-in-ilias-elearning-platform)
  + [Remote Code Execution in Stud.IP (eLearning platform)](/labor/cve-2023-50982)
  + [OS Command Injection in ILIAS eLearning platform](/labor/cve-2023-45869)
  + [Local File Inclusion to Arbitrary File Copy in ILIAS eLearning platform](/labor/cve-2023-45868)
  + [XSS in Roundcube Webmailer](/labor/cve-2023-47272)
  + [Local File Inclusion in ILIAS eLearning platform](/labor/cve-2023-45867)
[Kontakt](/impressum)
## Labor

In meinem Labor hast du die Möglichkeit, veröffentlichte Sicherheitslücken einzusehen, die ich identifiziert habe.

[Zum Labor](/labor)
#### Computer things... beep.  Ethical Hacker. Coder.

# Something happens...

#### Warn- und Informationsdienst (WID)

## IT-Sicherheitshinweise des CERT-Bund

Das Computer Emergency Response Team der Bundesverwaltung — CERT-Bund veröffentlicht täglich [aktuelle Hinweise](https://wid.cert-bund.de/portal/wid/start) zu Sicherheitslücken in gängigen IT-Produkten. Die kritischsten Meldungen werden hier automatisiert ausgespielt.

[Tinyproxy: Mehrere Schwachstellen](https://wid.cert-bund.de/portal/wid/securityadvisory?name=WID-SEC-2024-0997 "Tinyproxy: Mehrere Schwachstellen")Critical- 08.01.2025 - 12:37Ein entfernter, anonymer Angreifer kann mehrere Schwachstellen in Tinyproxy ausnutzen, um beliebigen Programmcode auszuführen und um vertrauliche Informationen offenzulegen.[Microsoft Windows: Mehrere Schwachstellen](https://wid.cert-bund.de/portal/wid/securityadvisory?name=WID-SEC-2024-3657 "Microsoft Windows: Mehrere Schwachstellen")Critical- 03.01.2025 - 09:12Ein Angreifer kann mehrere Schwachstellen in verschiedenen Versionen von Microsoft Windows und Microsoft Windows Server ausnutzen, um seine Privilegien zu erhöhen, beliebigen Code auszuführen, vertrauliche Informationen offenzulegen und einen Denial-of-Service-Situation zu erzeugen.[Mitel MiCollab: Mehrere Schwachstellen](https://wid.cert-bund.de/portal/wid/securityadvisory?name=WID-SEC-2024-3141 "Mitel MiCollab: Mehrere Schwachstellen")Critical- 08.01.2025 - 09:02Ein entfernter, anonymer Angreifer kann mehrere Schwachstellen in Mitel MiCollab ausnutzen, um Dateien zu manipulieren, Sicherheitsmaßnahmen zu umgehen, Phishing-Angriffe durchzuführen und vertrauliche Informationen preiszugeben.[Microsoft Windows: Mehrere Schwachstellen](https://wid.cert-bund.de/portal/wid/securityadvisory?name=WID-SEC-2024-3445 "Microsoft Windows: Mehrere Schwachstellen")Critical- 06.01.2025 - 09:02Ein Angreifer kann mehrere Schwachstellen in verschiedenen Versionen von Microsoft Windows Server und Microsoft Windows ausnutzen, um seine Privilegien zu erhöhen, einen Denial-of-Service-Zustand zu erzeugen, beliebigen Code auszuführen, vertrauliche Informationen preiszugeben und einen Spoofing-Angriff durchzuführen.[Oracle Java SE: Mehrere Schwachstellen](https://wid.cert-bund.de/portal/wid/securityadvisory?name=WID-SEC-2024-0895 "Oracle Java SE: Mehrere Schwachstellen")High- 08.01.2025 - 10:39Ein entfernter, anonymer Angreifer kann mehrere Schwachstellen in Oracle Java SE ausnutzen, um die Vertraulichkeit, Integrität und Verfügbarkeit zu gefährden.[Alle Hinweise anzeigen](/alle-it-sicherheitshinweise-des-cert-bund)rehme.infosec

Piiip, in [meinem persönlichen Blog](https://renerehme.de) veröffentliche ich Artikel über IT-Security, persönliche Projekte, Coding Experimente oder Basteleien. Im Labor findest du aktuelle Veröffentlichungen von gefunden Sicherheitslücken in Software.

* [LinkedIn](https://www.linkedin.com/company/100283045/)
* [XING](https://www.xing.com/pages/rehme-infosec)

Services

* [Penetration Testing](/leistungen/penetrationstests-red-teaming "Penetration Testing")
* [Red-Teaming](/leistungen/penetrationstests-red-teaming "Red-Teaming")
* [Code Audits](/leistungen/code-audits "Code Audits")

Unternehmen

* [Über uns](/unternehmen "Über uns")

Nützliche Links

* [Responsible Disclosure](/labor/responsible-disclosure)
* [IT-Sicherheitshinweise des CERT-Bund](/alle-it-sicherheitshinweise-des-cert-bund)

Legal

* [Impressum](/impressum)
* [Datenschutz](/datenschutz)

© rehme.infosec 2024, alle Rechte vorbehalten


