The provided content relates to CVE-2024-26902.

**Root cause of vulnerability:**
The vulnerability stems from using `(1 << idx)` with an integer type to set bits in an `unsigned long`, which is incorrect on a 64-bit architecture. This leads to potential integer overflow issues.

**Weaknesses/vulnerabilities present:**
- **Incorrect bit manipulation:** The code incorrectly uses left bit shift on an integer (`1 << idx`) where `idx` could be a value large enough to cause an overflow. The result of this shift is then used in a bitwise OR operation to set a bit in an `unsigned long` variable.
- **Data type mismatch:** The code uses an integer type to perform bit operations which are to be applied to an unsigned long type which results in unexpected behavior due to the size difference.

**Impact of exploitation:**
- **Kernel panic:** The incorrect bit manipulation leads to a null pointer dereference, causing a kernel panic. This makes the system unstable and unavailable.

**Attack vectors:**
- The vulnerability is triggered when using the performance monitoring unit (PMU) on RISC-V architecture, specifically when running `perf record -e branches`. The vulnerability is triggered in the interrupt handler for overflow of the PMU.

**Required attacker capabilities/position:**
- An attacker needs to be able to trigger a performance event that causes the PMU counters to overflow, specifically the branches event in this instance. This would require the ability to execute code or commands on the target system, often requiring some level of access.