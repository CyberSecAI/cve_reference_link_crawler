=== Content from jvn.jp_633a5fba_20250111_092100.html ===


![Japan Vulnerability Notes](/common/img/note_logo.gif)

Published:2023/09/05  Last Updated:2023/09/05
# JVN#92720882 Multiple vulnerabilities in CGIs of PMailServer and PMailServer2

## Overview

CGIs included with PMailServer and PMailServer2 provided by A.K.I Software contain multiple vulnerabilities.

## Products Affected

* PMailServer Free edition

  \* This product is affected by CVE-2023-39223 (pmam.exe) only.
* PMailServer Version 1.91 and earlier
  + Standard edition
  + Pro edition
  + Standard + IMAP4 edition
  + Pro + IMAP4 edition
* PMailServer2 prior to Version 2.51a
  + Standard edition
  + Pro edition
  + Standard + IMAP4 edition
  + Pro + IMAP4 edition
  + Enterprise edition

The following CGIs included with the above products are affected by the vulnerabilities.

* pmc.exe 2.5.1.720 and earlier
* pmam.exe 2.5.1.1411 and earlier
* pmmls.exe 2.5.1.561 and earlier
* pmum.exe (Standard edition) 2.5.1.25451 and earlier
* pmum.exe (Pro edition) 2.5.1.25452 and earlier
* pmum.exe (Standard + IMAP4 edition) 2.5.1.25453 and earlier
* pmum.exe (Pro + IMAP4 edition / Enterprise edition) 2.5.1.25454 and earlier
* pmman.exe (Standard edition) 2.5.1.12154 and earlier
* pmman.exe (Pro edition) 2.5.1.12155 and earlier
* pmman.exe (Standard + IMAP4 edition) 2.5.1.12156 and earlier
* pmman.exe (Pro + IMAP4 edition) 2.5.1.12157 and earlier
* pmman.exe (Enterprise edition) 2.5.1.12158 and earlier

## Description

CGIs included with PMailServer and PMailServer2 provided by A.K.I Software contain multiple vulnerabilities listed below.

* **Stored cross-site scripting vulnerability ([CWE-79](https://cwe.mitre.org/data/definitions/79.html))** - CVE-2023-39223

  | CVSS v3 | CVSS:3.0/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N | **Base Score: 5.4** |
  | --- | --- | --- |
  | CVSS v2 | AV:N/AC:L/Au:S/C:N/I:P/A:N | **Base Score: 4.0** |
* **Insufficient verification vulnerability in Broadcast Mail CGI (pmc.exe) ([CWE-434](https://cwe.mitre.org/data/definitions/434.html))** - CVE-2023-39933

  | CVSS v3 | CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:N | **Base Score: 4.3** |
  | --- | --- | --- |
  | CVSS v2 | AV:N/AC:L/Au:S/C:N/I:P/A:N | **Base Score: 4.0** |
* **Directory traversal vulnerability in Mailing List Search CGI (pmmls.exe) ([CWE-22](https://cwe.mitre.org/data/definitions/22.html))** - CVE-2023-40160

  | CVSS v3 | CVSS:3.0/AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:N/A:N | **Base Score: 3.7** |
  | --- | --- | --- |
  | CVSS v2 | AV:N/AC:M/Au:N/C:P/I:N/A:N | **Base Score: 4.3** |
* **Directory traversal vulnerability in Internal Simple Webserver ([CWE-22](https://cwe.mitre.org/data/definitions/22.html))** - CVE-2023-40747

  | CVSS v3 | CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N | **Base Score: 5.3** |
  | --- | --- | --- |
  | CVSS v2 | AV:N/AC:L/Au:N/C:P/I:N/A:N | **Base Score: 5.0** |

## Impact

* An arbitrary script may be executed on a logged-in user's web browser - CVE-2023-39223
* A user who can upload files through the product may execute an arbitrary excutable file with the web server's execution privilege - CVE-2023-39933
* A remote attacker may obtain arbitrary files on the server - CVE-2023-40160
* A remote attacker may access arbitrary files outside DocumentRoot - CVE-2023-40747

## Solution

**For PMailServer2:**

**Apply Update file**

Apply Update file according to the information provided by the developer.

**For PMailServer:**

**Stop using the product's CGIs or Switch to alternative products**

The developer states that the affected products are no longer being developed, and Update files will not be provided.

The developer recommends stop using the product's CGIs or switching to an alternative product "PMailServer2".

**Apply the Workarounds**

The developer provides workarounds for these vulnerabilities.

For more information, please refer to the [developer's website (Text in Japanse)](https://akisoftware.com/Vulnerability202301.html).

## Vendor Status

| Vendor | Link |
| --- | --- |
| A.K.I Software | [CGI of PMailServer/PMailServer2 vulnerability information (Text in Japanese)](https://akisoftware.com/Vulnerability202301.html) |

## References

## JPCERT/CC Addendum

## Vulnerability Analysis by JPCERT/CC

## Credit

CVE-2023-39223, CVE-2023-39933, CVE-2023-40160

Shuji Shimizu of VeriServe Corporation reported these vulnerabilities to IPA.

JPCERT/CC coordinated with the developer under Information Security Early Warning Partnership.

CVE-2023-40747

Shunta Nakanishi of VeriServe Corporation reported this vulnerability to IPA.

JPCERT/CC coordinated with the developer under Information Security Early Warning Partnership.

## Other Information

| JPCERT Alert |  |
| --- | --- |
| JPCERT Reports |  |
| CERT Advisory |  |
| CPNI Advisory |  |
| TRnotes |  |
| CVE | [CVE-2023-39223](https://www.cve.org/CVERecord?id=CVE-2023-39223) |
|  | [CVE-2023-39933](https://www.cve.org/CVERecord?id=CVE-2023-39933) |
|  | [CVE-2023-40160](https://www.cve.org/CVERecord?id=CVE-2023-40160) |
|  | [CVE-2023-40747](https://www.cve.org/CVERecord?id=CVE-2023-40747) |
| JVN iPedia | [JVNDB-2023-000090](https://jvndb.jvn.jp/jvndb/JVNDB-2023-000090) |

* JVN
* [HOME](/en/index.html)
* [What is JVN ?](/en/nav/jvn.html)
* [Instructions](/en/nav/jvnhelp.html)
* [List of Vulnerability Report](/en/report/index.html)
* [VN\_JP](/en/jp/index.html)
* [VN\_JP(Unreachable)](/en/adj/index.html)
* [VN\_VU](/en/vu/index.html)
* [TA](/en/ta/index.html)
* [TRnotes](/en/tr/index.html)
* [JVN iPedia](http://jvndb.jvn.jp/en/)
* [MyJVN](http://jvndb.jvn.jp/en/apis/myjvn/index.html)
* [JVNJS/RSS](/en/rss/index.html)
* [Vendor List](/en/nav/index.html)
* [List of unreachable developers](/en/reply/index.html)
* [Contact](/en/contact/index.html)

Copyright (c) 2000-2023 JPCERT/CC and IPA. All rights reserved.



=== Content from akisoftware.com_f9020720_20250111_092059.html ===


A.K.I Software - ZLeBÆã«îñ - PMailServer / PMailServer2 ãL»it® CGI É¨¯éÆã«îñ

Æã«¯ÊÔ@JVN#92720882

öJú 2023 N 9  5 ú

ÅIXVú 2023 N 9  5 ú

¡Tv

PMailServer / PMailServer2 t®Ì CGI ÉÂ¢ÄºLÌÆã«ª¶Ý·é±Æª»¾µÜµ½B

1. »iÅt® Webmail (pmum.exejÌXPW[ÉÄCÓÌ JavaScript ªÀsÅ«éâè
2. »iÅt® ¯ñ[ (pmc.exejÉÄæt@CÈOðAbv[hðs¢[gÅÀst@CªÀsÅ«éâè
3. »iÅt® [OXgõ (pmmls.exejÉÄCÓÌt@Cðæ¾Å«éâè
4. T[o[}l[W[t®Ì ÈÕWebT[o[ÉÄ DocumentRoot OÌt@CÉANZXªÅ«éâè
5. »iÅt®CGI (pmam.exe / pmum.exe / pmc.exe )É¨¢ÄüÍðsÁ½ÛÉ HTML^Oª¼ÚoÍ³êéâè(XSS)

¡e¿Ì éo[W

PMailServer t[Å(pmam.exeÌÝ)

PMailServer Version 1.91 ÈOÌX^\_[hÅAvÅAX^\_[h{IMAP4ÎÅAv{IMAP4ÎÅ

PMailServer2 Version 2.51a ÈOÌX^\_[hÅAvÅAX^\_[h{IMAP4ÎÅAv{IMAP4ÎÅAG^[vCYÅ

¡Y»iÌmFû@

»ê¼êÌt@CÉÂ¢ÄÍAWindows GNXv[[æèt@CÌvpeBðJ«AÚ×©çt@Co[WÅmFðs¢Ü·B

pmc.exe 2.5.1.720 ðÜÞ±êæèàOÌo[W

pmam.exe 2.5.1.1411 ðÜÞ±êæèàOÌo[W

pmmls.exe 2.5.1.561 ðÜÞ±êæèàOÌo[W

pmum.exe(Std) 2.5.1.25451 ðÜÞ±êæèàOÌo[W

pmum.exe(Pro) 2.5.1.25452 ðÜÞ±êæèàOÌo[W

pmum.exe(Std + IMAP4) 2.5.1.25453 ðÜÞ±êæèàOÌo[W

pmum.exe(Pro + IMAP4 / Enterprise) 2.5.1.25454 ðÜÞ±êæèàOÌo[W

pmman.exe(Std) 2.5.1.12154 ðÜÞ±êæèàOÌo[W

pmman.exe(Pro) 2.5.1.12155 ðÜÞ±êæèàOÌo[W

pmman.exe(Std + IMAP4) 2.5.1.12156 ðÜÞ±êæèàOÌo[W

pmman.exe(Pro + IMAP4) 2.5.1.12157 ðÜÞ±êæèàOÌo[W

pmman.exe(Enterprise) 2.5.1.12158 ðÜÞ±êæèàOÌo[W

¡Îôû@

* PMailServer2 ðpµÄ¢éêÍATCgàÅöJðsÁÄ¢éAVersion 2.51a XVðs¢Y·ét@CÌã«ðsÁÄº³¢B
* t[Å¨æÑPMailServer ðp³êÄ¢éêÍA2012N 614úÉPMailServerÌJ­ÍI¹µÄ¢é×AXVt@CÌñÍ²´¢Ü¹ñB

  ±êçÌo[Wð²pÌêÍ PMailServer2 ÖÌAbvO[hð§¢½µÜ·B

¡Æã«Ìà¾¨æÑÎô

1. »iÅt® Webmail (pmum.exejÌXPW[ÉÄCÓÌ JavaScript ªÀsÅ«éâè

   XPW[[ªLøÉÈÁÄ¢é WebmailÉOCãAXPW[[ÌÚ×ðo^·éÛÉAHTML^Oªßßé×ACÓÌHTMLÌ\¦¨æÑ JavaScript ª\¦yÑÀsªÅ«Ü·B

   ÎôÆµÄAXPW[Éo^ðs¤ÛÉ HTML^Oi¼p¨æÑjðGXP[vµ HTML^OyÑ JavaScript ÌÀsðÅ«È¢æ¤ÉÏXµÜµ½B
2. »iÅt® ¯ñ[ (pmc.exejÉÄæt@CÈOðAbv[hðs¢[gÅÀst@CªÀsÅ«éâè

   ¯ñ[CGIÉOCãA[ÉYt·éæt@CðAbv[h·éÛÉACÓÌt@CÌAbv[hªÅ«AÂAbv[h³ê½t@CªÀst@CÅ Á½êAWebT[o[oRÅAbv[hµ½t@CÌÀsªÂ\Å·B

   ÎôÆµÄAg£q .jpg / .jpeg / .gif / .png ÈOÌt@CÍAbv[hðÖ~ÆµAÜ½Abv[h³ê½t@CÌwb\_[ðmFµÄ¶LætH[}bgÈOÍÛ¶ðsíÈ¢æ¤ÉÏXðs¢Üµ½B
3. »iÅt® [OXgõ (pmmls.exejÉÄCÓÌt@Cðæ¾Å«éâè

   CGIøiIvVjÉÄs³ÈIvVðÜÞ URL ðwèµ½êACÓÌt@Cðæ¾Å«Ü·B

   ÎôÆµÄAs³ÈIvVð`FbNµA[OXgÅöJ³êÄ¢é[ÌÝðæ¾Å«éæ¤ÉC³ðs¢Üµ½B

   ¯ÉLøÈ[OXgÌwèðÅ«éæ¤ÉÏXðs¢Üµ½B
4. T[o[}l[W[t®Ì ÈÕWebT[o[ÉÄ DocumentRoot OÌt@CÉANZXªÅ«éâè

   http / https oRÅANZXðsÁ½êAs³ÈpXðÜÞ URL ðwèµ½êADocumentRootiCXg[tH\_ÈºÉ é Docroot tH\_jOÖÌt@CÌANZXyÑæ¾ªÂ\Å·B
   ÎôÆµÄ DocumentRoot ÈOÖÌANZXªÅ«È¢æ¤ÉC³ðs¢Üµ½B
5. * pmam.exe ÅOCæÊÅhC¼ðüÍ·éÛÉ HTML^OðÜÞ¶ñðüÍµOCðsÁ½êAüÍ³ê½àeª»ÌÜÜoÍyÑÀs³êéâè
   * pmc.exe ÅOCãAUser-AgentÉ HTML^OðÜÞ¶ñðüÍµOCðsÁ½êAüÍ³ê½àeª»ÌÜÜoÍyÑÀs³êéâè
   * pmum.exe Å UAC IvVðÂ¯ÄANZXµ½ÛÉAUser-AgentÉ HTML^OðÜÞ¶ñðüÍµ½êAüÍ³ê½àeª»ÌÜÜoÍyÑÀs³êéâè
   * pmum.exe ÌXPW[Å HTML^OðÜÞ¶ñðÝè³ê½êAüÍ³ê½àeª»ÌÜÜoÍyÑÀs³êéâè
   * ãLÈOÅàÞÜ½ÍÂ\«Ì éâèÌC³

   üÍ¶ñÌ^OðGXP[v·éæ¤ÉC³ðs¢Üµ½B

¡ñðô

PMailServer2 ð²pÌêÍ Version 2.51a È~ÖÌo[WAbvð§¢½µÜ·B

àµ 2.51a È~ÉXVµÈ¢êÍ

* Webmail ÅÌXPW[Ìgpð~
* pmmls ÌgpÌ~¨æÑÝuðsíÈ¢
* pmc ÌgpÌ~¨æÑÝuðsíÈ¢
* T[o[}l[W[ÌÈÕWebÌgpð~
* pmam.exeÌgpð~

ðsÁÄº³¢B

* PMailServer ÉÍXVt@CÌñÍsíêÈ¢×AYCGIÌpð~Aàµ­ÍÇÒÈOÌANZXðs¤±ÆªÅ«È¢æ¤ÉM³IPÌ§ÀÈÇðsÁÄ­¾³¢B
* Èñç©ÌRÉæèXVðsí¸AÜ½gpÌ~ªÅ«È¢êÍAÇÒÈOÌANZXðs¤±ÆªÅ«È¢æ¤ÉM³IPÌ§ÀÈÇðÇÒÌ»fÅsÁÄ­¾³¢B

  ½¾µª{IÈðÉÍÈèÜ¹ñÌÅAPMailServerð²pÌêÍ PMailServer2 ÖÌAbvO[hð§¢½µÜ·B

¡Ó«

®ïÐxT[u ´ ãùm lA®ïÐxT[u ¼ x¾ l©çâèÌ²ñð¢½¾«AJPCERT/CC Aîñi@\ IPA É²¦Í¢½¾«Üµ½B

±ÌêðØèÄ´ÓÌÓð\µµÜ·B

¡Aæ

Æã«Aû

<https://akisoftware.com/software.html> ©ç[ÉÄ¨â¢í¹­¾³¢B


