Based on the provided content, here's a breakdown of the vulnerability:

**Root Cause:**

*   A reflected Cross-Site Scripting (XSS) vulnerability exists due to unsanitized user input in the `directory` parameter of the admin `common/filemanager.list` route.

**Weaknesses/Vulnerabilities Present:**

*   **Reflected XSS:** The application reflects user-provided input in the `directory` parameter directly back to the user's browser without proper sanitization or encoding. This allows an attacker to inject malicious scripts into the webpage.
*   The application does not properly sanitize input, allowing for injection of javascript.
*  The redirect after login is vulnerable to manipulation

**Impact of Exploitation:**

*   An attacker can steal a user's session token by tricking them into clicking a malicious link. This malicious link redirects the user to the login page, and upon successful login, the injected script is executed in the context of the logged-in user.
*   If the attacked user has admin privileges, the attacker can leverage this vulnerability as part of a more complex attack chain (e.g., Zip Slip or arbitrary file writes). This could lead to a complete compromise of the application.
*   XSS can be used to steal cookies, hijack user sessions, expose sensitive information, and deliver malware.

**Attack Vectors:**

*   The primary attack vector is a maliciously crafted URL that includes the XSS payload in the `directory` parameter of the `common/filemanager.list` route.
*   The attacker needs to trick the victim into clicking the crafted link, usually through social engineering or other means.

**Required Attacker Capabilities/Position:**

*   The attacker needs to know or guess the admin directory path (default is "admin", but users are warned to rename it).
*   The attacker needs to be able to create a malicious URL with the XSS payload.
* The attacker needs to entice a user to click the malcious link.

**Additional Notes:**

* The provided commit removes the redirect functionality from the login page, fixing part of the exploit vector. However, the vulnerability can still be exploited if the user is already authenticated.

**Proof of Concept (PoC):**

```
/admin/index.php?route=common/filemanager.list&directory=demo%2522%253E%253Cscript%253Ealert%25281%2529%253C%252Fscript%253E%253Cinput%2Btype%253D%2522hidden
```
This PoC URL demonstrates the vulnerability by injecting a javascript alert.

The content provides more details than the standard CVE description, including the specific vulnerable parameter, the attack vector, and proof-of-concept.