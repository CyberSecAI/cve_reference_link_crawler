=== Content from infosecwriteups.com_525d8c8d_20250110_174317.html ===
[Open in app](https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F3d5c8e1113f0&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---top_nav_layout_nav----------------------------------)

[Sign up](https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Finfosecwriteups.com%2Fxss-store-in-zkteco-welcome-to-wdms-3d5c8e1113f0&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

[Sign in](https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Finfosecwriteups.com%2Fxss-store-in-zkteco-welcome-to-wdms-3d5c8e1113f0&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

[Write](https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---top_nav_layout_nav-----------------------new_post_topnav-----------)

[Sign up](https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Finfosecwriteups.com%2Fxss-store-in-zkteco-welcome-to-wdms-3d5c8e1113f0&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

[Sign in](https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Finfosecwriteups.com%2Fxss-store-in-zkteco-welcome-to-wdms-3d5c8e1113f0&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

![](https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png)
# ZKTeco WDMS 5.1.3 ‚Äî Persistent XSS (CVE-2023‚Äì51157)

[![Miguel M√©ndez Z.](https://miro.medium.com/v2/resize:fill:88:88/1*Q4hN4YUHZYVEO_qiggsBWQ@2x.jpeg)](https://medium.com/%40s1kr10s?source=post_page---byline--3d5c8e1113f0--------------------------------)[![InfoSec Write-ups](https://miro.medium.com/v2/resize:fill:48:48/1*SWJxYWGZzgmBP1D0Qg_3zQ.png)](https://infosecwriteups.com/?source=post_page---byline--3d5c8e1113f0--------------------------------)

[Miguel M√©ndez Z.](https://medium.com/%40s1kr10s?source=post_page---byline--3d5c8e1113f0--------------------------------)

¬∑

[Follow](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F691af447be50&operation=register&redirect=https%3A%2F%2Finfosecwriteups.com%2Fxss-store-in-zkteco-welcome-to-wdms-3d5c8e1113f0&user=Miguel+M%C3%A9ndez+Z.&userId=691af447be50&source=post_page-691af447be50--byline--3d5c8e1113f0---------------------post_header-----------)

Published in[InfoSec Write-ups](https://infosecwriteups.com/?source=post_page---byline--3d5c8e1113f0--------------------------------)¬∑3 min read¬∑Jan 22, 2024

--

Listen

Share

![]()

[https://www.zkteco.com](https://www.zkteco.com/en/)

# Context

Hello everyone! On this occasion, I would like to share how I discovered a vulnerability in a ZKTeco WDMS system. It all started when I had to review third-party systems, as in this case, where the opportunities to exploit these circumstances are crucial, especially when economic constraints prevent the acquisition of these platforms.

# Whats ZKTeco WDMS?

WDMSis Web-based Data Master System, an advanced middleware.
 As a middleware, WDMSallows you to deploy on servers and databases for devices and transactions management. Administrators can access WDMSanywhere by the browser or a third-party software by API to handle thousands of devices.

![]()
# **Technical Details:**

* **Vendor:** ZKTeco
* **Vendor Website:** <https://www.zkteco.com>
* **Affected Version:** ZKTeco WDMS 5.1.3
* **Vulnerable Endpoint:** `/iclock/data/employee`

# Review Vulnerability

The first thing we encounter is a typical user access. We will skip this process as it is not relevant to this publication.

![]()

login panel

After logging into the application, a panel is displayed that features a menu, allowing us to view, modify, and delete specific information. This menu serves as a key interface that enables efficient data management. From here, various functions are accessible, facilitating interaction and administration of the information contained in the platform.

![]()

application

Now, we proceed to attempt to modify employee information in the ‚ÄúEmp Name‚Äù (EName) field. Initially, we tested with a small payload; however, the results were not satisfactory. This is because the form is validated on the frontend, and the payload must adhere to a maximum of 40 characters.

![]()

form

The results when trying to inject payloads into the form are as follows.

![]()

error input

Now, the vulnerability in this form lies in the fact that the information is only validated on the frontend, as mentioned earlier. However, this validation is not performed on the backend, allowing the possibility to intercept the request and modify the information before it is sent.

![]()

After sending the payload, we can observe how it is stored, ready to be executed and reflected in the user‚Äôs view.

![]()

payload inject

# Conclusion

In summary, when attempting to modify employee data, a vulnerability in validation is revealed, which occurs exclusively on the frontend. This allows for the interception and modification of information before it is sent to the backend. The conclusion underscores the importance of implementing more robust validation measures both on the frontend and the backend to prevent potential security breaches.

# Timeline

* 2023‚Äì12‚Äì14 Vulnerability identified
* 2023‚Äì12‚Äì18 Customer approved disclosure to vendor
* 2024‚Äì01‚Äì09 [CVE-2023‚Äì51157](https://cve.mitre.org/cgi-bin/cvekey.cgi?keyword=CVE-2023-51157) Assigned
* 2024‚Äì01‚Äì?? Vendor notified ü¶óü¶óü¶ó
[Vulnerability](https://medium.com/tag/vulnerability?source=post_page-----3d5c8e1113f0--------------------------------)[Research](https://medium.com/tag/research?source=post_page-----3d5c8e1113f0--------------------------------)[Pentesting](https://medium.com/tag/pentesting?source=post_page-----3d5c8e1113f0--------------------------------)[Exploitation](https://medium.com/tag/exploitation?source=post_page-----3d5c8e1113f0--------------------------------)[Cross Site Scripting](https://medium.com/tag/cross-site-scripting?source=post_page-----3d5c8e1113f0--------------------------------)

--

--

[![InfoSec Write-ups](https://miro.medium.com/v2/resize:fill:96:96/1*SWJxYWGZzgmBP1D0Qg_3zQ.png)](https://infosecwriteups.com/?source=post_page---post_publication_info--3d5c8e1113f0--------------------------------)[![InfoSec Write-ups](https://miro.medium.com/v2/resize:fill:128:128/1*SWJxYWGZzgmBP1D0Qg_3zQ.png)](https://infosecwriteups.com/?source=post_page---post_publication_info--3d5c8e1113f0--------------------------------)[Follow](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Fbugbountywriteup&operation=register&redirect=https%3A%2F%2Finfosecwriteups.com%2Fxss-store-in-zkteco-welcome-to-wdms-3d5c8e1113f0&collection=InfoSec+Write-ups&collectionId=7b722bfd1b8d&source=post_page---post_publication_info--3d5c8e1113f0---------------------follow_profile-----------)[## Published in InfoSec Write-ups](https://infosecwriteups.com/?source=post_page---post_publication_info--3d5c8e1113f0--------------------------------)[50K Followers](/followers?source=post_page---post_publication_info--3d5c8e1113f0--------------------------------)¬∑[Last published¬†1 day ago](/using-discord-as-a-c2-cf90b3480689?source=post_page---post_publication_info--3d5c8e1113f0--------------------------------)

A collection of write-ups from the best hackers in the world on topics ranging from bug bounties and CTFs to vulnhub machines, hardware challenges and real life encounters. Subscribe to our weekly newsletter for the coolest infosec updates: <https://weekly.infosecwriteups.com/>

[Follow](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Fbugbountywriteup&operation=register&redirect=https%3A%2F%2Finfosecwriteups.com%2Fxss-store-in-zkteco-welcome-to-wdms-3d5c8e1113f0&collection=InfoSec+Write-ups&collectionId=7b722bfd1b8d&source=post_page---post_publication_info--3d5c8e1113f0---------------------follow_profile-----------)[![Miguel M√©ndez Z.](https://miro.medium.com/v2/resize:fill:96:96/1*Q4hN4YUHZYVEO_qiggsBWQ@2x.jpeg)](https://medium.com/%40s1kr10s?source=post_page---post_author_info--3d5c8e1113f0--------------------------------)[![Miguel M√©ndez Z.](https://miro.medium.com/v2/resize:fill:128:128/1*Q4hN4YUHZYVEO_qiggsBWQ@2x.jpeg)](https://medium.com/%40s1kr10s?source=post_page---post_author_info--3d5c8e1113f0--------------------------------)[Follow](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F691af447be50&operation=register&redirect=https%3A%2F%2Finfosecwriteups.com%2Fxss-store-in-zkteco-welcome-to-wdms-3d5c8e1113f0&user=Miguel+M%C3%A9ndez+Z.&userId=691af447be50&source=post_page-691af447be50--post_author_info--3d5c8e1113f0---------------------follow_profile-----------)[## Written by Miguel M√©ndez Z.](https://medium.com/%40s1kr10s?source=post_page---post_author_info--3d5c8e1113f0--------------------------------)[142 Followers](https://medium.com/%40s1kr10s/followers?source=post_page---post_author_info--3d5c8e1113f0--------------------------------)¬∑[45 Following](https://medium.com/%40s1kr10s/following?source=post_page---post_author_info--3d5c8e1113f0--------------------------------)

<https://s1kr10s.github.io/whoami.html> ‚Äî @s1kr10s

[Follow](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F691af447be50&operation=register&redirect=https%3A%2F%2Finfosecwriteups.com%2Fxss-store-in-zkteco-welcome-to-wdms-3d5c8e1113f0&user=Miguel+M%C3%A9ndez+Z.&userId=691af447be50&source=post_page-691af447be50--post_author_info--3d5c8e1113f0---------------------follow_profile-----------)
## No responses yet

[Help](https://help.medium.com/hc/en-us?source=post_page-----3d5c8e1113f0--------------------------------)[Status](https://medium.statuspage.io/?source=post_page-----3d5c8e1113f0--------------------------------)[About](https://medium.com/about?autoplay=1&source=post_page-----3d5c8e1113f0--------------------------------)[Careers](https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=post_page-----3d5c8e1113f0--------------------------------)[Press](pressinquiries%40medium.com?source=post_page-----3d5c8e1113f0--------------------------------)[Blog](https://blog.medium.com/?source=post_page-----3d5c8e1113f0--------------------------------)[Privacy](https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----3d5c8e1113f0--------------------------------)[Terms](https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----3d5c8e1113f0--------------------------------)[Text to speech](https://speechify.com/medium?source=post_page-----3d5c8e1113f0--------------------------------)[Teams](https://medium.com/business?source=post_page-----3d5c8e1113f0--------------------------------)


