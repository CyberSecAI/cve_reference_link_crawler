

[![Google Cloud](https://www.gstatic.com/devrel-devsite/prod/vda41147226ae308b24384f785d31d739107d2716272d99cd11c490ff3892954d/cloud/images/cloud-logo.svg)](/)

[Documentation](https://cloud.google.com/docs)

[Technology areas](https://cloud.google.com/docs/tech-area-overviews)

close

* [AI and ML](https://cloud.google.com/docs/ai-ml)
* [Application development](https://cloud.google.com/docs/application-development)
* [Application hosting](https://cloud.google.com/docs/application-hosting)
* [Compute](https://cloud.google.com/docs/compute-area)
* [Data analytics and pipelines](https://cloud.google.com/docs/data)
* [Databases](https://cloud.google.com/docs/databases)
* [Distributed, hybrid, and multicloud](https://cloud.google.com/docs/dhm-cloud)
* [Generative AI](https://cloud.google.com/docs/generative-ai)
* [Industry solutions](https://cloud.google.com/docs/industry)
* [Networking](https://cloud.google.com/docs/networking)
* [Observability and monitoring](https://cloud.google.com/docs/observability)
* [Security](https://cloud.google.com/docs/security)
* [Storage](https://cloud.google.com/docs/storage)

[Cross-product tools](https://cloud.google.com/docs/cross-product-overviews)

close

* [Access and resources management](https://cloud.google.com/docs/access-resources)
* [Costs and usage management](https://cloud.google.com/docs/costs-usage)
* [Google Cloud SDK, languages, frameworks, and tools](https://cloud.google.com/docs/devtools)
* [Infrastructure as code](https://cloud.google.com/docs/iac)
* [Migration](https://cloud.google.com/docs/migration)

[Related sites](https://cloud.google.com/)

close

* [Google Cloud Home](https://cloud.google.com/)
* [Free Trial and Free Tier](https://cloud.google.com/free)
* [Architecture Center](https://cloud.google.com/architecture)
* [Blog](https://cloud.google.com/blog)
* [Contact Sales](https://cloud.google.com/contact)
* [Google Cloud Developer Center](https://cloud.google.com/developers)
* [Google Developer Center](https://developers.google.com/)
* [Google Cloud Marketplace](https://console.cloud.google.com/marketplace)
* [Google Cloud Marketplace Documentation](https://cloud.google.com/marketplace/docs)
* [Google Cloud Skills Boost](https://www.cloudskillsboost.google/paths)
* [Google Cloud Solution Center](https://cloud.google.com/solutions)
* [Google Cloud Support](https://cloud.google.com/support-hub)
* [Google Cloud Tech Youtube Channel](https://www.youtube.com/%40googlecloudtech)

`/`

* English
* Deutsch
* Español – América Latina
* Français
* Indonesia
* Italiano
* Português – Brasil
* 中文 – 简体
* 日本語
* 한국어

Sign in

* [Looker](https://cloud.google.com/looker)

[Contact Us](https://cloud.google.com/contact)
[Start free](//console.cloud.google.com/freetrial)

[![Google Cloud](https://www.gstatic.com/devrel-devsite/prod/vda41147226ae308b24384f785d31d739107d2716272d99cd11c490ff3892954d/cloud/images/cloud-logo.svg)](/)

* [Documentation](/docs)
* [Technology areas](/docs/tech-area-overviews)
  + More
* [Cross-product tools](/docs/cross-product-overviews)
  + More
* [Related sites](/)
  + More
* [Console](//console.cloud.google.com/)
* [Contact Us](/contact)
* [Start free](//console.cloud.google.com/freetrial)

* [AI and ML](/docs/ai-ml)
* [Application development](/docs/application-development)
* [Application hosting](/docs/application-hosting)
* [Compute](/docs/compute-area)
* [Data analytics and pipelines](/docs/data)
* [Databases](/docs/databases)
* [Distributed, hybrid, and multicloud](/docs/dhm-cloud)
* [Generative AI](/docs/generative-ai)
* [Industry solutions](/docs/industry)
* [Networking](/docs/networking)
* [Observability and monitoring](/docs/observability)
* [Security](/docs/security)
* [Storage](/docs/storage)

* [Access and resources management](/docs/access-resources)
* [Costs and usage management](/docs/costs-usage)
* [Google Cloud SDK, languages, frameworks, and tools](/docs/devtools)
* [Infrastructure as code](/docs/iac)
* [Migration](/docs/migration)

* [Google Cloud Home](/)
* [Free Trial and Free Tier](/free)
* [Architecture Center](/architecture)
* [Blog](https://cloud.google.com/blog)
* [Contact Sales](/contact)
* [Google Cloud Developer Center](/developers)
* [Google Developer Center](https://developers.google.com/)
* [Google Cloud Marketplace](https://console.cloud.google.com/marketplace)
* [Google Cloud Marketplace Documentation](/marketplace/docs)
* [Google Cloud Skills Boost](https://www.cloudskillsboost.google/paths)
* [Google Cloud Solution Center](/solutions)
* [Google Cloud Support](/support-hub)
* [Google Cloud Tech Youtube Channel](https://www.youtube.com/%40googlecloudtech)

Note that you are viewing Looker documentation. For Looker Studio documentation, visit <https://support.google.com/looker-studio>.

* [Home](https://cloud.google.com/)
* [Looker](https://cloud.google.com/looker)
* [Documentation](https://cloud.google.com/looker/docs)

Send feedback

# Looker Query ID API Patch Notice

Stay organized with collections

Save and categorize content based on your preferences.

Looker has made a mandatory security update available to prevent the risk of metadata exposure across authenticated Looker users sharing the same LookML model. To enable the mitigation in your instance, you might be required to change the usage of certain API endpoints. This patch affects all supported Looker versions listed in the [Officially supported releases](/looker/docs/officially-supported-releases) document.

## What changed?

Looker has applied a mandatory security update to your system. Due to the change in behavior of some API endpoints, you will need to take action to enable the security update and adjust your usage of any updated APIs to avoid causing errors in your API scripts.

For Looker-hosted instances, this patch adds a new [legacy feature](/looker/docs/legacy-feature-schedule), called **Disallow Numeric Query IDs**.
When enabled, this legacy feature causes changes in the use of the following API endpoints:

* The [`GET /queries/<query_id>`](/looker/docs/reference/looker-api/latest/methods/Query/query) endpoint requires a [slug](/looker/docs/glossary#slug) for the `query_id`. A `query_id` that is given a numeric query ID will return a 404 error.
* The [`POST /render_tasks/queries/<query_id>/<result_format>`](/looker/docs/reference/looker-api/latest/methods/RenderTask/create_query_render_task) endpoint requires a slug for the `query_id`. A `query_id` that is given a numeric query ID will return a 404 error.
* The [`GET /running_queries`](/looker/docs/reference/looker-api/latest/methods/Query/all_running_queries) endpoint is restricted to Looker admins only.

For customer-hosted instances, the previous API endpoint changes will be enabled when the instance is upgraded to a Looker version that includes this patch.

## What do I need to do?

Google Cloud recommends all customers complete both of the following actions:

* [Update any API scripts](#updating_api_scripts) that include any of the [updated API endpoints](#what_changed). If you don't update your API scripts as described in the following section, this may cause errors in your applications. For instructions on how to use [System Activity](/looker/docs/usage-reports-with-system-activity-explores) to view your API endpoint usage, see the "[How can I tell if we use any of the updated API endpoints?](#how_can_i_tell_if_we_use_any_of_the_updated_api_endpoints)" section of this document.
* Enable the patch updates. For instructions, see the section that corresponds with your Looker instance:

  + [Enabling the patch updates on Looker-hosted Looker (original) instances](#enabling_the_patch_on_looker-hosted_looker_original_instances)
  + [Enabling the patch updates on Looker (Google Cloud core) instances](#enabling_the_patch_on_looker_google_cloud_core_instances)
  + [Enabling the patch updates on Customer-hosted instances](#enabling_the_patch_on_customer-hosted_instances)

### Updating API scripts

If you are using one of the API endpoints listed next, you may need to take action regardless of the Looker version or API version that you are using. The recommended action is different depending on whether you are using [API 3.0 or API 3.1](#if_you_are_using_api_30_or_31), or [API 4.0](#if_you_are_using_api_40).

**Note:** If you are unsure which version of the Looker API you are using, in the **Admin > Queries** panel of Looker's Admin menu, the **Source** column will indicate the API version used to generate any queries with the API.

* `GET /queries/<query_id>`
* `POST /render_tasks/queries/<query_id>/<result_format>`
* `GET /running_queries`

#### If you are using API 4.0

If you are using API 4.0, and are using one of the endpoints [listed in the previous section](#updating_api_scripts), make the following application code changes:

* Replace any numeric `query_ids` (for example, 32, 124, etc.) that are used with the `GET /queries/<query_id>` or `POST /render_tasks/queries/<query_id>/<result_format>` endpoints with the [slug](/looker/docs/glossary#slug) value for the query. For instructions on finding a query's slug value, see the section ["How do I find the slug value for a query?"](#how_do_i_find_the_slug_value_for_a_query).
* Any applications that use the `GET /running_queries` endpoint will be restricted to Looker admins only.

#### If you are using API 3.0 or 3.1

If you are using API 3.0 or API 3.1, and are using one of the endpoints [listed in the previous section](#updating_api_scripts), make the following application code changes:

* The `GET /queries/<query_id>` endpoint will no longer work. Replace the `GET /queries/<query_id>` endpoint with the `GET /queries/slug/<slug>` endpoint to retrieve the same query metadata you were getting before. For instructions on finding a query's slug value, see the section ["How do I find the slug value for a query?"](#how_do_i_find_the_slug_value_for_a_query).
* The `POST /render_tasks/queries/<query_id>/<result_format>` endpoint will no longer work. The Looker SDKs that support API 3.1 will support both API 3.1 and API 4.0. If you are not using one of Looker's SDKs, modify the `http request path` to use 4.0 instead of 3.1 for that call. Then replace any numeric `query_ids` (for example, 32, 124, etc.) with the [slug](/looker/docs/glossary#slug) value for the query. For instructions on finding a query's slug value, see the section ["How do I find the slug value for a query?"](#how_do_i_find_the_slug_value_for_a_query).
* Any applications that use the `GET /running_queries` endpoint will be restricted to Looker admins only.

#### How do I find the slug value for a query?

You can find the slug value for a query in the following ways:

* For an Explore, you can find the slug in the Explore's URL following the `qid=` variable in the URL.
* You can find the slug value associated with a numeric query ID using [System Activity](/looker/docs/usage-reports-with-system-activity-explores).

  **Note:** In order to view the System Activity Explores, you must have a [role](/looker/docs/admin-panel-users-roles) that includes the [`see_system_activity` permission](/looker/docs/admin-panel-users-roles#see_system_activity).
  1. From the Looker Explore menu, select the [**System Activity > History** Explore](/looker/docs/usage-reports-with-system-activity-explores#history).
  2. From the **Query** view, select the **ID** and **Link** dimensions.
  3. Optionally, add a filter on the **ID** dimension, and enter the query's numeric query ID in the **Query ID** filter field.
  4. Click **Run**.

     ![](/static/looker/docs/images/system-activity-get-slug-2420.png)
  5. Click the `[Query]` link next to the numeric query ID in the Explore results, and that will open an Explore based on that numeric query ID.
  6. You can then use the slug in the Explore's URL, which follows the `qid=` variable in the URL.

### Enabling the patch on Looker-hosted Looker (original) instances

Google Cloud recommends all Looker-hosted customers enable the new **Disallow Numeric Query ID** [legacy feature](/looker/docs/legacy-feature-schedule).

**Note:** **If Disallow Numeric Query IDs** is already enabled, the patch has already been applied to your instance.

To enable **Disallow Numeric Query IDs**:

1. Navigate to the **Admin > Legacy** panel in Looker's Admin menu.
2. Enable the **Disallow Numeric Query IDs** toggle:

   ![](/static/looker/docs/images/disallow-numeric-query-ids-2420.png)

**Important:** The **Disallow Numeric Query IDs** legacy feature will be automatically enabled for all Looker-hosted instances on February 22, 2024 regardless of the status of the toggle prior to February 22. If you need more time to adjust your usage of endpoints, please advise us by [contacting Looker support](/looker/docs/best-practices/looker-support-details).
### Enabling the patch on Looker (Google Cloud core) instances

The patch is automatically enabled on all Looker (Google Cloud core) instances. There is nothing you need to do to enable the patch, but ensure to [update any API scripts](#updating_api_scripts) that include any of the updated API endpoints.

### Enabling the patch on Customer-hosted instances

All customer-hosted instances should [update their Looker instance](/looker/docs/updating-looker-instance) to a version of Looker that includes the latest patch. This patch is included in the most recent update to Looker versions 23.18, 23.20, 24.0, and 24.2, and to Looker [ESR](/looker/docs/standard-extended-support-release-program-overview) versions 23.0, 23.6, 23.12, and 24.0. Ensure to [update any API scripts](#updating_api_scripts) that include any of the updated API endpoints before you update your Looker instance.

## How can I tell if we use any of the updated API endpoints?

You can view a list of the API calls made to your Looker instance using the [API Usage System Activity Explore](/looker/docs/usage-reports-with-system-activity-explores#api_usage).

1. From the Looker **Explore** menu, select the **System Activity** Explore, and then the **API Usage** view.
2. Select the **Created Date > Date** and **Endpoint** dimensions, and the **Total Usage** measure.
3. Add a filter on the **Endpoint** dimension, and in the filter field, include the following endpoints:

   * `/queries/:query_id`
   * `/render_tasks/queries/:query_id/:result_format`
   * `/running_queries`
4. Click **Run**. Looker will display usage information for those endpoints.

   ![](/static/looker/docs/images/sa-api-usage-2420.png)

## If I need more time to update my API scripts, what do I do?

[Contact Looker support](/looker/docs/best-practices/looker-support-details) no later than February 21st, 5pm Pacific, and advise us that you would like to have the **Disallow Numeric Query IDs** [legacy feature](/looker/docs/legacy-feature-schedule) disabled until you can update your API scripts.

**Note:** the **Disallow Numeric Query IDs** legacy feature will be removed entirely in 90 days.
## Are there additional steps, outside of what I need to do for this incident, that the affected parties need to do to mitigate possible adverse effects?

No

## What steps is Looker taking to prevent similar issues in the future?

Looker and Google maintain a robust security program to proactively prevent and identify security flaws internally. You can find more information at <https://cloud.google.com/looker/product/security>.

## Has Looker informed regulators?

Looker follows all appropriate regulatory requirements regarding disclosures for these types of issues.

Send feedback

Except as otherwise noted, the content of this page is licensed under the [Creative Commons Attribution 4.0 License](https://creativecommons.org/licenses/by/4.0/), and code samples are licensed under the [Apache 2.0 License](https://www.apache.org/licenses/LICENSE-2.0). For details, see the [Google Developers Site Policies](https://developers.google.com/site-policies). Java is a registered trademark of Oracle and/or its affiliates.

Last updated 2024-10-08 UTC.

Need to tell us more?

[[["Easy to understand","easyToUnderstand","thumb-up"],["Solved my problem","solvedMyProblem","thumb-up"],["Other","otherUp","thumb-up"]],[["Hard to understand","hardToUnderstand","thumb-down"],["Incorrect information or sample code","incorrectInformationOrSampleCode","thumb-down"],["Missing the information/samples I need","missingTheInformationSamplesINeed","thumb-down"],["Other","otherDown","thumb-down"]],["Last updated 2024-10-08 UTC."],[],[]]

* ### Why Google

  + [Choosing Google Cloud](/why-google-cloud/)
  + [Trust and security](/trust-center/)
  + [Modern Infrastructure Cloud](/solutions/modern-infrastructure/)
  + [Multicloud](/multicloud/)
  + [Global infrastructure](/infrastructure/)
  + [Customers and case studies](/customers/)
  + [Analyst reports](/analyst-reports/)
  + [Whitepapers](/whitepapers/)
  + [Blog](//cloud.google.com/blog/)
* ### Products and pricing

  + [Google Cloud pricing](/pricing/)
  + [Google Workspace pricing](//workspace.google.com/pricing.html)
  + [See all products](/products/)
* ### Solutions

  + [Infrastructure modernization](/solutions/infrastructure-modernization/)
  + [Databases](/solutions/databases/)
  + [Application modernization](/solutions/application-modernization/)
  + [Smart analytics](/solutions/smart-analytics/)
  + [Artificial Intelligence](/solutions/ai/)
  + [Security](/solutions/security/)
  + [Productivity & work transformation](https://workspace.google.com/enterprise/)
  + [Industry solutions](/solutions/#industry-solutions)
  + [DevOps solutions](/solutions/devops/)
  + [Small business solutions](/solutions/#section-14)
  + [See all solutions](/solutions/)
* ### Resources

  + [Google Cloud Affiliate Program](/affiliate-program/)
  + [Google Cloud documentation](/docs/)
  + [Google Cloud quickstarts](/docs/get-started/)
  + [Google Cloud Marketplace](/marketplace/)
  + [Learn about cloud computing](/discover/)
  + [Support](/support-hub/)
  + [Code samples](/docs/samples)
  + [Cloud Architecture Center](/architecture/)
  + [Training](/learn/training/)
  + [Certifications](/learn/certification/)
  + [Google for Developers](//developers.google.com)
  + [Google Cloud for Startups](/startup/)
  + [System status](//status.cloud.google.com)
  + [Release Notes](/release-notes)
* ### Engage

  + [Contact sales](/contact/)
  + [Find a Partner](//cloud.google.com/find-a-partner)
  + [Become a Partner](/partners/become-a-partner/)
  + [Events](/events/)
  + [Podcasts](/podcasts/)
  + [Developer Center](/developers/)
  + [Press Corner](https://www.googlecloudpresscorner.com/)
  + [Google Cloud on YouTube](//www.youtube.com/googlecloud)
  + [Google Cloud Tech on YouTube](//www.youtube.com/googlecloudplatform)
  + [Follow on X](//x.com/googlecloud)
  + [Join User Research](//userresearch.google.com/?reserved=1&utm_source=website&Q_Language=en&utm_medium=own_srch&utm_campaign=CloudWebFooter&utm_term=0&utm_content=0&productTag=clou&campaignDate=jul19&pType=devel&referral_code=jk212693)
  + [We're hiring. Join Google Cloud!](//careers.google.com/cloud)
  + [Google Cloud Community](https://www.googlecloudcommunity.com/)

* [About Google](//about.google/)
* [Privacy](//policies.google.com/privacy)
* [Site terms](//www.google.com/intl/en/policies/terms/regional.html)
* [Google Cloud terms](/product-terms/)
* Manage cookies
* [Our third decade of climate action: join us](/sustainability)
* Sign up for the Google Cloud newsletter
  [Subscribe](/newsletter/)

* English
* Deutsch
* Español – América Latina
* Français
* Indonesia
* Italiano
* Português – Brasil
* 中文 – 简体
* 日本語
* 한국어

