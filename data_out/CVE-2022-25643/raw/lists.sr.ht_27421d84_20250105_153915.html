<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
<title>
  [SECURITY ADVISORY] seatd-launch: remove files with escalated privileges with SUID &mdash; sourcehut lists
</title>

    
    <link rel="icon" type="image/svg+xml" href="/static/logo.svg" />
    <link rel="icon" type="image/png" href="/static/logo.png" sizes="any" />
    
    
    <link rel="stylesheet" href="/static/main.min.c6a67196.css">
    
    
    
    
<link rel="alternate" type="application/mbox" href="/~kennylevinsen/seatd-announce/%3CETEO7R.QG8B1KGD531R1@kl.wtf%3E/mbox">

  </head>
  <body>
    
    
    
    
    <nav class="container navbar navbar-light navbar-expand-sm">
      
<span class="navbar-brand">
  <span class="icon icon-circle " aria-hidden="true"><svg width="22" height="22" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8zm0 448c-110.5 0-200-89.5-200-200S145.5 56 256 56s200 89.5 200 200-89.5 200-200 200z"/></svg>
</span>
  <a href="https://sr.ht">
    sourcehut
  </a>
</span>

<ul class="navbar-nav">
  
</ul>
<div class="login">
  
  <span class="navbar-text">
    
    <a href="https://meta.sr.ht/oauth/authorize?client_id=d2c8d246da1ccabb&amp;scopes=profile&amp;state=%2F~kennylevinsen%2Fseatd-announce%2F%3CETEO7R.QG8B1KGD531R1%40kl.wtf%3E%3F" rel="nofollow">Log in</a>
    &mdash;
    <a href="https://meta.sr.ht">Register</a>
    
  </span>
  
</div>
    </nav>
    
    
<div class="header-tabbed">
  
  <div class="container">
  
    <h2>
      <a href="/~kennylevinsen">~kennylevinsen</a>/<wbr>seatd-announce
      
    </h2>
    
    
    <ul class="nav nav-tabs">
      
      <li class="nav-item">
        
    <a
      class="nav-link active"
      href="/~kennylevinsen/seatd-announce">archives</a>
    
      </li>
      <li class="nav-item">
        
    <a
      class="nav-link "
      href="/~kennylevinsen/seatd-announce/patches">patches</a>
    
      </li>
      
      
      
      
      <li class="nav-item">
        <a
          class="nav-link "
          
          href="mailto:~kennylevinsen/seatd-announce@lists.sr.ht"
          
        >new post</a>
      </li>
      
      
      
      
    </ul>
    
  </div>
</div>

<div class="container">
  <div class="row">
    <div class="col-md-12">
      
      
      

      
      
      
      <small class="text-muted pull-right" style="line-height: 2">
        
        <span><span class="icon icon-reply " aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M8.309 189.836L184.313 37.851C199.719 24.546 224 35.347 224 56.015v80.053c160.629 1.839 288 34.032 288 186.258 0 61.441-39.581 122.309-83.333 154.132-13.653 9.931-33.111-2.533-28.077-18.631 45.344-145.012-21.507-183.51-176.59-185.742V360c0 20.7-24.3 31.453-39.687 18.164l-176.004-152c-11.071-9.562-11.086-26.753 0-36.328z"/></svg>
</span> 1</span>
        
        
      </small>
      <h3>
        [SECURITY ADVISORY] seatd-launch: remove files with escalated privileges with SUID
      </h3>
      
      <div>
        <div class="message-header">
          <div class="from">
            
            
            
            <a href="/~kennylevinsen">Kenny Levinsen</a>
            
            <a href="mailto:~kennylevinsen/seatd-announce@lists.sr.ht?cc=Kenny%20Levinsen%20%3Ckl%40kl.wtf%3E&amp;in-reply-to=%3CETEO7R.QG8B1KGD531R1%40kl.wtf%3E&amp;subject=Re%3A%20%5BSECURITY%20ADVISORY%5D%20seatd-launch%3A%20remove%20files%20with%20escalated%20privileges%20with%20SUID">&lt;kl@kl.wtf&gt;</a>
          </div>
          
          <details>
            <summary>Details</summary>
            <div>
              <dl>
                <div>
                  <dt>Message ID</dt>
                  <dd><code>&lt;ETEO7R.QG8B1KGD531R1@kl.wtf&gt;</code></dd>
                </div>
                
                
                <div>
                  <dt>DKIM signature</dt>
                  <dd>
                    
                    missing
                    
                  </dd>
                </div>
              </dl>
              <a href="/~kennylevinsen/seatd-announce/%3CETEO7R.QG8B1KGD531R1@kl.wtf%3E/raw" target="_blank">Download raw message</a>
              
            </div>
          </details>
          <div class="date">
            <a
              id="&lt;ETEO7R.QG8B1KGD531R1@kl.wtf&gt;"
              href="#&lt;ETEO7R.QG8B1KGD531R1@kl.wtf&gt;"
              class="text-muted"
            ><span title="2022-02-21 22:37:08 UTC">2 years ago</span></a>
          </div>
          <div class="msg-info">
            
            
            
          </div>
        </div>
        <pre class="message-body">seatd-launch: remove files with escalated privileges with SUID
==============================================================

This security advisory describes a vulnerability in seatd-launch 
shipped as part of seatd release 0.6.0, 0.6.1, 0.6.2 and 0.6.3. The 
vulnerability was fixed in seatd release 0.6.4.

VULNERABILITY
-------------

seatd-launch could use a user-specified socket path instead of the 
internally generated socket path, and would unlink the socket path 
before use to guard against collision with leftover sockets. This meant 
that a caller could freely control what file path would be unlinked and 
replaced with a user-owned seatd socket for the duration of the session.

If seatd-launch had the SUID bit set, this could be used by a malicious 
user to remove files with the privileges of the owner of seatd-launch, 
which is likely root, and replace it with a user-owned domain socket.

This does not directly allow retrieving the contents of existing files, 
and the user-owned socket file is at the current time not believed to 
be directly useful for further exploitation.

INFO
----

The vulnerability was first introduced in 48727a0b6bc2 when 
implementing command line argument support in seatd-launch.

To be vulnerable, the seatd-launch executable must be installed with 
the SUID bit set. The SUID bit is not set by the build system 
installation process, and must be done by either the package maintainer 
or user.

seatd and libseat are not affected by this vulnerability.

A CVE ID has been requested and will follow when issued.

AFFECTED VERSIONS
-----------------

    Affected: 0.6.0, 0.6.1, 0.6.2, 0.6.3
    Not affected: &gt;= 0.6.4

seatd-launch did not exist prior to 0.6.0.

MITIGATION
----------

seatd 0.6.4 contains a security fix that addresses the vulnerability by 
removing support for user-specified socket paths from seatd-launch.

RECOMMENDATIONS
---------------

    A - Upgrade to version 0.6.4

    B - Remove seatd-launch if installed with the SUID bit set

TIMELINE
--------

    2022-02-21: The vulnerability is discovered by the project authors
    2022-02-21: A fix is released and a security advisory is posted</pre>
      </div>
      
      
      
      
      
      <div>
        <div class="message-header">
          <div class="from">
            
            
            
            <a href="/~kennylevinsen">Kenny Levinsen</a>
            
            <a href="mailto:~kennylevinsen/seatd-announce@lists.sr.ht?cc=Kenny%20Levinsen%20%3Ckl%40kl.wtf%3E&amp;in-reply-to=%3CX69P7R.AHDZGOK6PHKK2%40kl.wtf%3E&amp;subject=Re%3A%20%5BSECURITY%20ADVISORY%5D%20seatd-launch%3A%20remove%20files%20with%20escalated%20privileges%20with%20SUID">&lt;kl@kl.wtf&gt;</a>
          </div>
          
          <details>
            <summary>Details</summary>
            <div>
              <dl>
                <div>
                  <dt>Message ID</dt>
                  <dd><code>&lt;X69P7R.AHDZGOK6PHKK2@kl.wtf&gt;</code></dd>
                </div>
                
                <div>
                  <dt>In-Reply-To</dt>
                  <dd>
                    <code>
                      &lt;ETEO7R.QG8B1KGD531R1@kl.wtf&gt;
                    </code>
                    <a href="#&lt;ETEO7R.QG8B1KGD531R1@kl.wtf&gt;">(view parent)</a>
                  </dd>
                </div>
                
                
                <div>
                  <dt>DKIM signature</dt>
                  <dd>
                    
                    missing
                    
                  </dd>
                </div>
              </dl>
              <a href="/~kennylevinsen/seatd-announce/%3CX69P7R.AHDZGOK6PHKK2@kl.wtf%3E/raw" target="_blank">Download raw message</a>
              
            </div>
          </details>
          <div class="date">
            <a
              id="&lt;X69P7R.AHDZGOK6PHKK2@kl.wtf&gt;"
              href="#&lt;X69P7R.AHDZGOK6PHKK2@kl.wtf&gt;"
              class="text-muted"
            ><span title="2022-02-22 09:33:06 UTC">2 years ago</span></a>
          </div>
          <div class="msg-info">
            
            
            
          </div>
        </div>
        <pre class="message-body">The vulnerability has been assigned CVE-2022-25643.

The CVE data is expected to become public shortly.</pre>
      </div>
      
      
    </div>
  </div>
  <div class="row">
    <div class="col-md-6 offset-md-6">
      <div class="form-group">
        <a class="btn btn-primary btn-block"
          href="mailto:~kennylevinsen/seatd-announce@lists.sr.ht?cc=Kenny%20Levinsen%20%3Ckl%40kl.wtf%3E&amp;in-reply-to=%3CX69P7R.AHDZGOK6PHKK2%40kl.wtf%3E&amp;subject=Re%3A%20%5BSECURITY%20ADVISORY%5D%20seatd-launch%3A%20remove%20files%20with%20escalated%20privileges%20with%20SUID"
        >Reply to thread <span class="icon icon-caret-right " aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 192 512"><path d="M0 384.662V127.338c0-17.818 21.543-26.741 34.142-14.142l128.662 128.662c7.81 7.81 7.81 20.474 0 28.284L34.142 398.804C21.543 411.404 0 402.48 0 384.662z"/></svg>
</span></a>
        <a class="btn btn-default btn-block" href="/~kennylevinsen/seatd-announce/%3CETEO7R.QG8B1KGD531R1@kl.wtf%3E/mbox"
        >Export thread (mbox) <span class="icon icon-caret-right " aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 192 512"><path d="M0 384.662V127.338c0-17.818 21.543-26.741 34.142-14.142l128.662 128.662c7.81 7.81 7.81 20.474 0 28.284L34.142 398.804C21.543 411.404 0 402.48 0 384.662z"/></svg>
</span></a>
        <form
          style="margin-top: 0.5rem"
          action="/~kennylevinsen/seatd-announce/forward/%3CETEO7R.QG8B1KGD531R1@kl.wtf%3E"
          method="POST"
        >
          <input
        type='hidden'
        name='_csrf_token'
        value='1be5855f4f1acc29e6931f4855596ff16e4775ff113ab7c4f9cebd77a2ca0504dc075fbab053182d7efdd32791ef6b78a90afbd403946c1c7d65ac7271fd740d' />
          <button
            class="btn btn-default btn-block"
          >Forward this thread to me <span class="icon icon-caret-right " aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 192 512"><path d="M0 384.662V127.338c0-17.818 21.543-26.741 34.142-14.142l128.662 128.662c7.81 7.81 7.81 20.474 0 28.284L34.142 398.804C21.543 411.404 0 402.48 0 384.662z"/></svg>
</span></button>
        </form>
      </div>
    </div>
  </div>
</div>


    
    
  </body>
</html>