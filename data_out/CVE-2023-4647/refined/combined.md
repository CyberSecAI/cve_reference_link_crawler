=== Content from gitlab.com_e7e07a47_20250111_124814.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

# Pagination for Branches and Tags can be skipped

### Problem

[!92624 (merged)](https://gitlab.com/gitlab-org/gitlab/-/merge_requests/92624 "Allow pagination=none for recursive tree API") introduced an option to skip pagination for tree API. However, `Gitlab::Pagination::GitalyKeysetPager` is used for branches and tags as well. Unintentionally, `pagination=none` can also work for these endpoints. That can lead to a potential abuse (like DoS attack).

### Solution

Make sure that `pagination=none` applied only to TreeFinder. [The code with the vulnerability](https://gitlab.com/gitlab-org/gitlab/blob/4eefed2a5af4725e1afea91a819e8b9b32e4cb19/lib/gitlab/pagination/gitaly_keyset_pager.rb#L18).

### Reproduction steps

Trying to set `per_page > 100`, API returns only 100 elements

```
curl --silent http://127.0.0.1:3000/api/v4/projects/2/repository/branches\?per_page\=200 | jq length
100
```

But with `pagination=none`, API returns everything.

```
curl --silent http://127.0.0.1:3000/api/v4/projects/2/repository/branches\?pagination\=none | jq length
126
```

Assignee
Loading

Time tracking
Loading

Confidentiality

Confidentiality controls have moved to the issue actions menu () at the top of the page.


