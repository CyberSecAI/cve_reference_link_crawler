

![Ruby on Rails Discussions](data:image/svg;base64...)
Loading

[Ruby on Rails Discussions](/)

# [Possible Denial of Service Vulnerability in Rack Header Parsing](/t/possible-denial-of-service-vulnerability-in-rack-header-parsing/84942)

[Security Announcements](/c/security-announcements/9)

[rack](https://discuss.rubyonrails.org/tag/rack),
[announcement](https://discuss.rubyonrails.org/tag/announcement)

[tenderlove](https://discuss.rubyonrails.org/u/tenderlove)
(Aaron Patterson)

February 21, 2024, 8:32pm

1

There is a possible denial of service vulnerability in the header parsing
routines in Rack. This vulnerability has been assigned the CVE identifier
CVE-2024-26146.

Versions Affected: All.
Not affected: None
Fixed Versions: 2.0.9.4, 2.1.4.4, 2.2.8.1, 3.0.9.1

## Impact

Carefully crafted headers can cause header parsing in Rack to take longer than
expected resulting in a possible denial of service issue. Accept and Forwarded
headers are impacted.

Ruby 3.2 has mitigations for this problem, so Rack applications using Ruby 3.2
or newer are unaffected.

## Releases

The fixed releases are available at the normal locations.

## Workarounds

There are no feasible workarounds for this issue.

## Patches

To aid users who aren’t able to upgrade immediately we have provided patches for
the two supported release series. They are in git-am format and consist of a
single changeset.

* 2-0-header-redos.patch - Patch for 2.0 series
* 2-1-header-redos.patch - Patch for 2.1 series
* 2-2-header-redos.patch - Patch for 2.2 series
* 3-0-header-redos.patch - Patch for 3.0 series

## Credits

Thanks to [svalkanov](https://github.com/svalkanov) for reporting this and
providing patches!

[2-0-header-redos.patch](/uploads/short-url/sHpVdOeeOaR26vR4Jxr3m9F1eVp.patch) (906 Bytes)
[2-1-header-redos.patch](/uploads/short-url/rwvIYcVh7k8POPdDyqM4R89jroJ.patch) (922 Bytes)
[2-2-header-redos.patch](/uploads/short-url/yMUj3p7m9rgDg0klZB01rzZTAQr.patch) (890 Bytes)
[3-0-header-redos.patch](/uploads/short-url/heYW95L3CGWYV2G5owG9LSYaCIm.patch) (1.5 KB)

1 Like

### Related topics

| Topic |  | Replies | Views | Activity |
| --- | --- | --- | --- | --- |
| [[CVE-2023-27539] Possible Denial of Service Vulnerability in Rack's header parsing](https://discuss.rubyonrails.org/t/cve-2023-27539-possible-denial-of-service-vulnerability-in-racks-header-parsing/82466)  [Security Announcements](/c/security-announcements/9) [announcement](https://discuss.rubyonrails.org/tag/announcement) ,  [patch](https://discuss.rubyonrails.org/tag/patch) ,  [security](https://discuss.rubyonrails.org/tag/security) | 0 | 6909 | March 13, 2023 |
| [[CVE-2022-44570] Possible Denial of Service Vulnerability in Rack's Range header parsing](https://discuss.rubyonrails.org/t/cve-2022-44570-possible-denial-of-service-vulnerability-in-racks-range-header-parsing/82125)  [Security Announcements](/c/security-announcements/9) [patch](https://discuss.rubyonrails.org/tag/patch) ,  [rack](https://discuss.rubyonrails.org/tag/rack) ,  [security](https://discuss.rubyonrails.org/tag/security) | 0 | 7203 | January 17, 2023 |
| [[CVE-2022-44571] Possible Denial of Service Vulnerability in Rack Content-Disposition parsing](https://discuss.rubyonrails.org/t/cve-2022-44571-possible-denial-of-service-vulnerability-in-rack-content-disposition-parsing/82126)  [Security Announcements](/c/security-announcements/9) [patch](https://discuss.rubyonrails.org/tag/patch) ,  [rack](https://discuss.rubyonrails.org/tag/rack) ,  [security](https://discuss.rubyonrails.org/tag/security) | 0 | 6768 | January 17, 2023 |
| [[CVE-2022-30122] Denial of Service Vulnerability in Rack Multipart Parsing](https://discuss.rubyonrails.org/t/cve-2022-30122-denial-of-service-vulnerability-in-rack-multipart-parsing/80729)  [Security Announcements](/c/security-announcements/9) [announcement](https://discuss.rubyonrails.org/tag/announcement) ,  [rack](https://discuss.rubyonrails.org/tag/rack) ,  [security](https://discuss.rubyonrails.org/tag/security) | 0 | 8313 | May 27, 2022 |
| [Denial of Service Vulnerability in Rack Content-Type Parsing](https://discuss.rubyonrails.org/t/denial-of-service-vulnerability-in-rack-content-type-parsing/84941)  [Security Announcements](/c/security-announcements/9) [announcement](https://discuss.rubyonrails.org/tag/announcement) ,  [rack](https://discuss.rubyonrails.org/tag/rack) | 0 | 4780 | February 21, 2024 |

* [Home](/)
* [Categories](/categories)
* [Guidelines](/guidelines)
* [Terms of Service](/tos)
* [Privacy Policy](/privacy)

Powered by [Discourse](https://www.discourse.org), best viewed with JavaScript enabled

