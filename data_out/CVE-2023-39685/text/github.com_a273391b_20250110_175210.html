
[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fhjson%2Fhjson-java%2Fissues%2F27)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fhjson%2Fhjson-java%2Fissues%2F27)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=hjson%2Fhjson-java)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[hjson](/hjson)
/
**[hjson-java](/hjson/hjson-java)**
Public

* [Notifications](/login?return_to=%2Fhjson%2Fhjson-java) You must be signed in to change notification settings
* [Fork
  24](/login?return_to=%2Fhjson%2Fhjson-java)
* [Star
   160](/login?return_to=%2Fhjson%2Fhjson-java)

* [Code](/hjson/hjson-java)
* [Issues
  4](/hjson/hjson-java/issues)
* [Pull requests
  2](/hjson/hjson-java/pulls)
* [Actions](/hjson/hjson-java/actions)
* [Projects
  0](/hjson/hjson-java/projects)
* [Security](/hjson/hjson-java/security)
* [Insights](/hjson/hjson-java/pulse)

Additional navigation options

* [Code](/hjson/hjson-java)
* [Issues](/hjson/hjson-java/issues)
* [Pull requests](/hjson/hjson-java/pulls)
* [Actions](/hjson/hjson-java/actions)
* [Projects](/hjson/hjson-java/projects)
* [Security](/hjson/hjson-java/security)
* [Insights](/hjson/hjson-java/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fhjson%2Fhjson-java%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fhjson%2Fhjson-java%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# java.lang.StringIndexOutOfBoundsException error caused by hjson parsing of untrusted JSON String #27

Closed

[lopezalvar](/lopezalvar) opened this issue
Jul 30, 2023
· 4 comments
 · Fixed by [#29](https://github.com/hjson/hjson-java/pull/29)

Closed

# [java.lang.StringIndexOutOfBoundsException error caused by hjson parsing of untrusted JSON String](#top) #27

[lopezalvar](/lopezalvar) opened this issue
Jul 30, 2023
· 4 comments
 · Fixed by [#29](https://github.com/hjson/hjson-java/pull/29)

## Comments

[![@lopezalvar](https://avatars.githubusercontent.com/u/8658171?s=80&u=8d237ce2520307fc6debd650f10200dc5761046f&v=4)](/lopezalvar)

Copy link

### **[lopezalvar](/lopezalvar)** commented [Jul 30, 2023](#issue-1827914114)

| Description The utilization of hjson to interpret untrusted JSON strings could potentially expose to significant security risks, specifically denial of service (DOS) attacks. This vulnerability arises when the parser operates on input provided by users, which could be manipulated by malicious actors. They could craft content designed to trigger a java.lang.StringIndexOutOfBoundsException error, leading to a system crash. This not only disrupts normal operations but also opens up opportunities for further exploitations. PoC ```     <dependency>       <groupId>org.hjson</groupId>       <artifactId>hjson</artifactId>       <version>3.0.0</version>     </dependency> ```  ``` package com.example; import org.hjson.JsonValue;   public class App  {     public static void main( String[] args )     {         String jsonString = "[\n[\n=\n[[\'\'\'\'\'\'";         JsonValue.readHjson(jsonString);      } } ``` Error Log ``` Exception in thread "main" java.lang.StringIndexOutOfBoundsException: index -1,length 0         at java.base/java.lang.String.checkIndex(String.java:3278)         at java.base/java.lang.AbstractStringBuilder.charAt(AbstractStringBuilder.java:307)         at java.base/java.lang.StringBuilder.charAt(StringBuilder.java:89)         at org.hjson.HjsonParser.readMlString(HjsonParser.java:250)         at org.hjson.HjsonParser.readStringInternal(HjsonParser.java:301)         at org.hjson.HjsonParser.readString(HjsonParser.java:282)         at org.hjson.HjsonParser.readValue(HjsonParser.java:117)         at org.hjson.HjsonParser.readArray(HjsonParser.java:173)         at org.hjson.HjsonParser.readValue(HjsonParser.java:118)         at org.hjson.HjsonParser.readArray(HjsonParser.java:173)         at org.hjson.HjsonParser.readValue(HjsonParser.java:118)         at org.hjson.HjsonParser.readArray(HjsonParser.java:173)         at org.hjson.HjsonParser.readValue(HjsonParser.java:118)         at org.hjson.HjsonParser.readArray(HjsonParser.java:173)         at org.hjson.HjsonParser.readValue(HjsonParser.java:118)         at org.hjson.HjsonParser.parse(HjsonParser.java:88)         at org.hjson.JsonValue.readHjson(JsonValue.java:130)         at com.example.App.main(App.java:10) ``` |
| --- |
| The text was updated successfully, but these errors were encountered: |

All reactions

[![@trobro](https://avatars.githubusercontent.com/u/5781786?s=80&v=4)](/trobro)

Copy link

Member

### **[trobro](/trobro)** commented [Aug 2, 2023](#issuecomment-1662979645)

| I assume the correct behavior for Hjson would be to throw *org.hjson.ParseException* instead of *java.lang.StringIndexOutOfBoundsException*. Do you consider the difference in exception type to be a significant security risk? |
| --- |

All reactions

Sorry, something went wrong.

[![@lopezalvar](https://avatars.githubusercontent.com/u/8658171?s=80&u=8d237ce2520307fc6debd650f10200dc5761046f&v=4)](/lopezalvar)

Copy link

Author

### **[lopezalvar](/lopezalvar)** commented [Aug 4, 2023](#issuecomment-1665394498)

| Hi [@trobro](https://github.com/trobro),  Thanks for your response. I agree with your point that the expected behavior would be for the hjson library to throw a org.hjson.ParseException. The difference in exception types is indeed significant. A java.lang.StringIndexOutOfBoundsException is a runtime exception that can crash the system if not properly handled, while a org.hjson.ParseException is a checked exception that forces the developer to handle it. This difference could indeed be a security risk, as it could potentially lead to a Denial of Service (DoS) attack. Additionally some other security risk can arise like, if the exception is not properly handled and the stack trace is exposed to the attacker, it could lead to information leakage, revealing sensitive details about the system's internal workings. This could provide an attacker with valuable information to craft more targeted and potentially damaging attacks.  I believe that the library should ideally throw a org.hjson.ParseException to ensure that the developer is aware of the potential issue and handles it appropriately.  For reference, here are some similar vulnerabilities found in other JSON parsing libraries: [CVE-2022-40150](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-40150) [CVE-2022-40149](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-40149) |
| --- |

All reactions

Sorry, something went wrong.

[![@trobro](https://avatars.githubusercontent.com/u/5781786?s=80&v=4)](/trobro)

Copy link

Member

### **[trobro](/trobro)** commented [Aug 8, 2023](#issuecomment-1669378076)

| Thanks for the explanation, I agree with you. Unfortunately hjson-java has been without maintainer for many years and I haven't been able to get in contact with anyone who might have credentials for hjson at Maven, so perhaps it won't be possible to upload a new release to Maven. |
| --- |

All reactions

Sorry, something went wrong.

[![@trobro](https://avatars.githubusercontent.com/u/5781786?s=80&v=4)](/trobro)

Copy link

Member

### **[trobro](/trobro)** commented [Aug 12, 2023](#issuecomment-1675940559)

| I see now that *org.hjson.ParseException* is also a runtime exception, so the fix won't change much, but I'll still fix it. |
| --- |

All reactions

Sorry, something went wrong.

[![@trobro](https://avatars.githubusercontent.com/u/5781786?s=40&v=4)](/trobro)
[trobro](/trobro)
mentioned this issue
[Aug 12, 2023](#ref-pullrequest-1848049225)

[Fix out of bounds
#29](/hjson/hjson-java/pull/29)
 Merged

[![@trobro](https://avatars.githubusercontent.com/u/5781786?s=40&v=4)](/trobro)
[trobro](/trobro)
closed this as [completed](/hjson/hjson-java/issues?q=is%3Aissue+is%3Aclosed+archived%3Afalse+reason%3Acompleted)
in
[#29](/hjson/hjson-java/pull/29)
[Aug 12, 2023](#event-10077141173)

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fhjson%2Fhjson-java%2Fissues%2F27)

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

Successfully merging a pull request may close this issue.

 [Fix out of bounds](/hjson/hjson-java/pull/29)
 [hjson/hjson-java](/hjson/hjson-java)

2 participants

[![@trobro](https://avatars.githubusercontent.com/u/5781786?s=52&v=4)](/trobro) [![@lopezalvar](https://avatars.githubusercontent.com/u/8658171?s=52&v=4)](/lopezalvar)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.

