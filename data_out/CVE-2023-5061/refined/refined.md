- **Root cause of vulnerability:** The GitLab API allows developers to override predefined variables when creating scheduled pipelines, even when the project setting `restrict_user_defined_variables` is enabled, which is intended to prevent developers from overriding these variables.
- **Weaknesses/vulnerabilities present:** Inconsistent enforcement of the `restrict_user_defined_variables` setting between the UI and API. The API endpoint for scheduled pipelines allows bypassing the restriction.
- **Impact of exploitation:** A developer can bypass the intended restriction on overriding predefined variables. This allows a developer to trigger specific pipeline jobs (e.g., jobs that are configured to only run for certain users) they would otherwise not be authorized to trigger.
- **Attack vectors:**
    - An attacker (developer) uses the GitLab API endpoint to create a scheduled pipeline and include predefined variables in the request.
- **Required attacker capabilities/position:**
    - The attacker needs to have the "developer" role in the GitLab project.
    - The attacker needs to have API access with a valid private token.