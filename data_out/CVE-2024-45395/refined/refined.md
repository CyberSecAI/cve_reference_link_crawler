```
{
  "vulnerability": {
    "root_cause": "The sigstore-go library is vulnerable to a denial-of-service (DoS) attack due to unbounded loops when processing untrusted input within a Sigstore Bundle.",
    "weaknesses": [
      "Unbounded loops when verifying large amounts of data in Sigstore Bundles (signed transparency log entries, RFC 3161 timestamps, and attestation subjects/digests)."
    ],
    "impact": "A maliciously crafted Sigstore Bundle can cause excessive CPU resource consumption, leading to a denial-of-service. This can disrupt services relying on sigstore-go for verification, as verification may fail to complete.",
    "attack_vectors": [
      "Maliciously crafted Sigstore Bundles with an excessive number of signed transparency log entries, RFC 3161 timestamps, and attestation subjects/digests, triggering unbounded loops during verification"
    ],
    "required_capabilities": "Attacker needs to create a crafted Sigstore Bundle. No user interaction is required for the attack to be effective once a vulnerable system processes the malicious bundle.",
    "additional_details": "The vulnerability lies in the verification functions in `github.com/sigstore/sigstore-go/pkg/verify`. Specifically, the vulnerable loops are:\n\n1.  The DSSE envelope verification loop in `verifyEnvelopeWithArtifact`, which decodes all the digests in an attestation.\n2.  The `VerifyArtifactTransparencyLog` function, which verifies all the signed entries in a bundle.\n3.  The `VerifyTimestampAuthority` function, which verifies all the RFC 3161 timestamps in a bundle."
  },
  "patch": {
    "description": "The vulnerability is addressed by adding hard limits to the number of verifiable data structures that can be processed in a bundle, with verification failing if these limits are exceeded.",
    "limits": {
      "signed_transparency_log_entries": 32,
      "rfc_3161_timestamps": 32,
      "attestation_subjects": 1024,
      "digests_per_attestation_subject": 32
    }
  }
}
```