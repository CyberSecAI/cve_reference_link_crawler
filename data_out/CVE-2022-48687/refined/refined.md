The provided content relates to CVE-2022-48687.

**Root cause of vulnerability:**
The vulnerability arises from a missing length check when setting HMAC data in the IPv6 Segment Routing (SRv6) layer. Specifically, the `SECRETLEN` attribute, which specifies the length of the HMAC secret, is not validated against the actual length of the `SECRET` attribute.

**Weaknesses/vulnerabilities present:**
- Out-of-bounds read: When setting HMAC data via netlink, an attacker can provide a `SECRETLEN` value that exceeds the actual length of the provided `SECRET`. This leads to `memcpy` reading beyond the allocated buffer, potentially into the `skb_shared_info` structure.
- Inconsistent attribute handling: The code incorrectly decouples the declared secret length from the provided secret data length.

**Impact of exploitation:**
- Information leak: The out-of-bounds read allows an attacker to read kernel memory, potentially revealing sensitive data. The leaked data can then be accessed from userspace by dumping HMAC state.

**Attack vectors:**
- Netlink messages: The vulnerability is triggered via a crafted netlink message, specifically when setting HMAC data for SRv6. The message must include `SEG6_ATTR_HMACKEYID`, `SEG6_ATTR_SECRET`, `SEG6_ATTR_SECRETLEN`, and `SEG6_ATTR_ALGID`.

**Required attacker capabilities/position:**
- The attacker needs the ability to send netlink messages to the kernel, typically requiring root or `CAP_NET_ADMIN` privileges.