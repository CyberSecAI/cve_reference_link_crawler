=== Content from git.kernel.org_4cb30b7e_20250111_131242.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=f684c16971ed5e77dfa25a9ad25b5297e1f58eab)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=f684c16971ed5e77dfa25a9ad25b5297e1f58eab)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=f684c16971ed5e77dfa25a9ad25b5297e1f58eab)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=f684c16971ed5e77dfa25a9ad25b5297e1f58eab)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | David Lebrun <dlebrun@google.com> | 2022-09-02 10:45:06 +0100 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2022-09-15 12:17:06 +0200 |
| commit | [f684c16971ed5e77dfa25a9ad25b5297e1f58eab](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=f684c16971ed5e77dfa25a9ad25b5297e1f58eab) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=f684c16971ed5e77dfa25a9ad25b5297e1f58eab)) | |
| tree | [85b775eba2de230e5f67f4321f32bf70c57c14a5](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=f684c16971ed5e77dfa25a9ad25b5297e1f58eab) | |
| parent | [c49f320e2492738d478bc427dcd54ccfe0cba746](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=c49f320e2492738d478bc427dcd54ccfe0cba746) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=f684c16971ed5e77dfa25a9ad25b5297e1f58eab&id2=c49f320e2492738d478bc427dcd54ccfe0cba746)) | |
| download | [linux-f684c16971ed5e77dfa25a9ad25b5297e1f58eab.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-f684c16971ed5e77dfa25a9ad25b5297e1f58eab.tar.gz) | |

ipv6: sr: fix out-of-bounds read when setting HMAC data.[ Upstream commit 84a53580c5d2138c7361c7c3eea5b31827e63b35 ]
The SRv6 layer allows defining HMAC data that can later be used to sign IPv6
Segment Routing Headers. This configuration is realised via netlink through
four attributes: SEG6\_ATTR\_HMACKEYID, SEG6\_ATTR\_SECRET, SEG6\_ATTR\_SECRETLEN and
SEG6\_ATTR\_ALGID. Because the SECRETLEN attribute is decoupled from the actual
length of the SECRET attribute, it is possible to provide invalid combinations
(e.g., secret = "", secretlen = 64). This case is not checked in the code and
with an appropriately crafted netlink message, an out-of-bounds read of up
to 64 bytes (max secret length) can occur past the skb end pointer and into
skb\_shared\_info:
Breakpoint 1, seg6\_genl\_sethmac (skb=<optimized out>, info=<optimized out>) at net/ipv6/seg6.c:208
208 memcpy(hinfo->secret, secret, slen);
(gdb) bt
#0 seg6\_genl\_sethmac (skb=<optimized out>, info=<optimized out>) at net/ipv6/seg6.c:208
#1 0xffffffff81e012e9 in genl\_family\_rcv\_msg\_doit (skb=skb@entry=0xffff88800b1f9f00, nlh=nlh@entry=0xffff88800b1b7600,
extack=extack@entry=0xffffc90000ba7af0, ops=ops@entry=0xffffc90000ba7a80, hdrlen=4, net=0xffffffff84237580 <init\_net>, family=<optimized out>,
family=<optimized out>) at net/netlink/genetlink.c:731
#2 0xffffffff81e01435 in genl\_family\_rcv\_msg (extack=0xffffc90000ba7af0, nlh=0xffff88800b1b7600, skb=0xffff88800b1f9f00,
family=0xffffffff82fef6c0 <seg6\_genl\_family>) at net/netlink/genetlink.c:775
#3 genl\_rcv\_msg (skb=0xffff88800b1f9f00, nlh=0xffff88800b1b7600, extack=0xffffc90000ba7af0) at net/netlink/genetlink.c:792
#4 0xffffffff81dfffc3 in netlink\_rcv\_skb (skb=skb@entry=0xffff88800b1f9f00, cb=cb@entry=0xffffffff81e01350 <genl\_rcv\_msg>)
at net/netlink/af\_netlink.c:2501
#5 0xffffffff81e00919 in genl\_rcv (skb=0xffff88800b1f9f00) at net/netlink/genetlink.c:803
#6 0xffffffff81dff6ae in netlink\_unicast\_kernel (ssk=0xffff888010eec800, skb=0xffff88800b1f9f00, sk=0xffff888004aed000)
at net/netlink/af\_netlink.c:1319
#7 netlink\_unicast (ssk=ssk@entry=0xffff888010eec800, skb=skb@entry=0xffff88800b1f9f00, portid=portid@entry=0, nonblock=<optimized out>)
at net/netlink/af\_netlink.c:1345
#8 0xffffffff81dff9a4 in netlink\_sendmsg (sock=<optimized out>, msg=0xffffc90000ba7e48, len=<optimized out>) at net/netlink/af\_netlink.c:1921
...
(gdb) p/x ((struct sk\_buff \*)0xffff88800b1f9f00)->head + ((struct sk\_buff \*)0xffff88800b1f9f00)->end
$1 = 0xffff88800b1b76c0
(gdb) p/x secret
$2 = 0xffff88800b1b76c0
(gdb) p slen
$3 = 64 '@'
The OOB data can then be read back from userspace by dumping HMAC state. This
commit fixes this by ensuring SECRETLEN cannot exceed the actual length of
SECRET.
Reported-by: Lucas Leong <wmliang.tw@gmail.com>
Tested: verified that EINVAL is correctly returned when secretlen > len(secret)
Fixes: 4f4853dc1c9c1 ("ipv6: sr: implement API to control SR HMAC structure")
Signed-off-by: David Lebrun <dlebrun@google.com>
Signed-off-by: David S. Miller <davem@davemloft.net>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=f684c16971ed5e77dfa25a9ad25b5297e1f58eab)

| -rw-r--r-- | [net/ipv6/seg6.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/net/ipv6/seg6.c?id=f684c16971ed5e77dfa25a9ad25b5297e1f58eab) | 5 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 5 insertions, 0 deletions

| diff --git a/net/ipv6/seg6.c b/net/ipv6/seg6.cindex 9b2f272ca16491..89d55770ac74b4 100644--- a/[net/ipv6/seg6.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/ipv6/seg6.c?id=c49f320e2492738d478bc427dcd54ccfe0cba746)+++ b/[net/ipv6/seg6.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/ipv6/seg6.c?id=f684c16971ed5e77dfa25a9ad25b5297e1f58eab)@@ -130,6 +130,11 @@ static int seg6\_genl\_sethmac(struct sk\_buff \*skb, struct genl\_info \*info) goto out\_unlock; } + if (slen > nla\_len(info->attrs[SEG6\_ATTR\_SECRET])) {+ err = -EINVAL;+ goto out\_unlock;+ }+ if (hinfo) { err = seg6\_hmac\_info\_del(net, hmackeyid); if (err) |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 13:11:19 +0000



=== Content from git.kernel.org_20b10b4b_20250111_131236.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=3df71e11a4773d775c3633c44319f7acdb89011c)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=3df71e11a4773d775c3633c44319f7acdb89011c)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=3df71e11a4773d775c3633c44319f7acdb89011c)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=3df71e11a4773d775c3633c44319f7acdb89011c)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | David Lebrun <dlebrun@google.com> | 2022-09-02 10:45:06 +0100 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2022-09-15 12:04:55 +0200 |
| commit | [3df71e11a4773d775c3633c44319f7acdb89011c](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=3df71e11a4773d775c3633c44319f7acdb89011c) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=3df71e11a4773d775c3633c44319f7acdb89011c)) | |
| tree | [e62a62c57df59acc5d9de52cfa65068ab77b010d](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=3df71e11a4773d775c3633c44319f7acdb89011c) | |
| parent | [e7f78835d551bb2deb5aa3346d84c8f03ade313d](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=e7f78835d551bb2deb5aa3346d84c8f03ade313d) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=3df71e11a4773d775c3633c44319f7acdb89011c&id2=e7f78835d551bb2deb5aa3346d84c8f03ade313d)) | |
| download | [linux-3df71e11a4773d775c3633c44319f7acdb89011c.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-3df71e11a4773d775c3633c44319f7acdb89011c.tar.gz) | |

ipv6: sr: fix out-of-bounds read when setting HMAC data.[ Upstream commit 84a53580c5d2138c7361c7c3eea5b31827e63b35 ]
The SRv6 layer allows defining HMAC data that can later be used to sign IPv6
Segment Routing Headers. This configuration is realised via netlink through
four attributes: SEG6\_ATTR\_HMACKEYID, SEG6\_ATTR\_SECRET, SEG6\_ATTR\_SECRETLEN and
SEG6\_ATTR\_ALGID. Because the SECRETLEN attribute is decoupled from the actual
length of the SECRET attribute, it is possible to provide invalid combinations
(e.g., secret = "", secretlen = 64). This case is not checked in the code and
with an appropriately crafted netlink message, an out-of-bounds read of up
to 64 bytes (max secret length) can occur past the skb end pointer and into
skb\_shared\_info:
Breakpoint 1, seg6\_genl\_sethmac (skb=<optimized out>, info=<optimized out>) at net/ipv6/seg6.c:208
208 memcpy(hinfo->secret, secret, slen);
(gdb) bt
#0 seg6\_genl\_sethmac (skb=<optimized out>, info=<optimized out>) at net/ipv6/seg6.c:208
#1 0xffffffff81e012e9 in genl\_family\_rcv\_msg\_doit (skb=skb@entry=0xffff88800b1f9f00, nlh=nlh@entry=0xffff88800b1b7600,
extack=extack@entry=0xffffc90000ba7af0, ops=ops@entry=0xffffc90000ba7a80, hdrlen=4, net=0xffffffff84237580 <init\_net>, family=<optimized out>,
family=<optimized out>) at net/netlink/genetlink.c:731
#2 0xffffffff81e01435 in genl\_family\_rcv\_msg (extack=0xffffc90000ba7af0, nlh=0xffff88800b1b7600, skb=0xffff88800b1f9f00,
family=0xffffffff82fef6c0 <seg6\_genl\_family>) at net/netlink/genetlink.c:775
#3 genl\_rcv\_msg (skb=0xffff88800b1f9f00, nlh=0xffff88800b1b7600, extack=0xffffc90000ba7af0) at net/netlink/genetlink.c:792
#4 0xffffffff81dfffc3 in netlink\_rcv\_skb (skb=skb@entry=0xffff88800b1f9f00, cb=cb@entry=0xffffffff81e01350 <genl\_rcv\_msg>)
at net/netlink/af\_netlink.c:2501
#5 0xffffffff81e00919 in genl\_rcv (skb=0xffff88800b1f9f00) at net/netlink/genetlink.c:803
#6 0xffffffff81dff6ae in netlink\_unicast\_kernel (ssk=0xffff888010eec800, skb=0xffff88800b1f9f00, sk=0xffff888004aed000)
at net/netlink/af\_netlink.c:1319
#7 netlink\_unicast (ssk=ssk@entry=0xffff888010eec800, skb=skb@entry=0xffff88800b1f9f00, portid=portid@entry=0, nonblock=<optimized out>)
at net/netlink/af\_netlink.c:1345
#8 0xffffffff81dff9a4 in netlink\_sendmsg (sock=<optimized out>, msg=0xffffc90000ba7e48, len=<optimized out>) at net/netlink/af\_netlink.c:1921
...
(gdb) p/x ((struct sk\_buff \*)0xffff88800b1f9f00)->head + ((struct sk\_buff \*)0xffff88800b1f9f00)->end
$1 = 0xffff88800b1b76c0
(gdb) p/x secret
$2 = 0xffff88800b1b76c0
(gdb) p slen
$3 = 64 '@'
The OOB data can then be read back from userspace by dumping HMAC state. This
commit fixes this by ensuring SECRETLEN cannot exceed the actual length of
SECRET.
Reported-by: Lucas Leong <wmliang.tw@gmail.com>
Tested: verified that EINVAL is correctly returned when secretlen > len(secret)
Fixes: 4f4853dc1c9c1 ("ipv6: sr: implement API to control SR HMAC structure")
Signed-off-by: David Lebrun <dlebrun@google.com>
Signed-off-by: David S. Miller <davem@davemloft.net>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=3df71e11a4773d775c3633c44319f7acdb89011c)

| -rw-r--r-- | [net/ipv6/seg6.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/net/ipv6/seg6.c?id=3df71e11a4773d775c3633c44319f7acdb89011c) | 5 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 5 insertions, 0 deletions

| diff --git a/net/ipv6/seg6.c b/net/ipv6/seg6.cindex 75421a472d25ac..f5c448c276fef2 100644--- a/[net/ipv6/seg6.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/ipv6/seg6.c?id=e7f78835d551bb2deb5aa3346d84c8f03ade313d)+++ b/[net/ipv6/seg6.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/ipv6/seg6.c?id=3df71e11a4773d775c3633c44319f7acdb89011c)@@ -125,6 +125,11 @@ static int seg6\_genl\_sethmac(struct sk\_buff \*skb, struct genl\_info \*info) goto out\_unlock; } + if (slen > nla\_len(info->attrs[SEG6\_ATTR\_SECRET])) {+ err = -EINVAL;+ goto out\_unlock;+ }+ if (hinfo) { err = seg6\_hmac\_info\_del(net, hmackeyid); if (err) |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 13:11:13 +0000



=== Content from git.kernel.org_f02b5133_20250111_131239.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=84a53580c5d2138c7361c7c3eea5b31827e63b35)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=84a53580c5d2138c7361c7c3eea5b31827e63b35)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=84a53580c5d2138c7361c7c3eea5b31827e63b35)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=84a53580c5d2138c7361c7c3eea5b31827e63b35)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | David Lebrun <dlebrun@google.com> | 2022-09-02 10:45:06 +0100 |
| --- | --- | --- |
| committer | David S. Miller <davem@davemloft.net> | 2022-09-05 10:33:34 +0100 |
| commit | [84a53580c5d2138c7361c7c3eea5b31827e63b35](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=84a53580c5d2138c7361c7c3eea5b31827e63b35) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=84a53580c5d2138c7361c7c3eea5b31827e63b35)) | |
| tree | [e50fd04a02d70e938357312fdd275986270cf76d](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=84a53580c5d2138c7361c7c3eea5b31827e63b35) | |
| parent | [060ad609fa38e9a62fd5f79d0aaf83f94e6f0e36](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=060ad609fa38e9a62fd5f79d0aaf83f94e6f0e36) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=84a53580c5d2138c7361c7c3eea5b31827e63b35&id2=060ad609fa38e9a62fd5f79d0aaf83f94e6f0e36)) | |
| download | [linux-84a53580c5d2138c7361c7c3eea5b31827e63b35.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-84a53580c5d2138c7361c7c3eea5b31827e63b35.tar.gz) | |

ipv6: sr: fix out-of-bounds read when setting HMAC data.The SRv6 layer allows defining HMAC data that can later be used to sign IPv6
Segment Routing Headers. This configuration is realised via netlink through
four attributes: SEG6\_ATTR\_HMACKEYID, SEG6\_ATTR\_SECRET, SEG6\_ATTR\_SECRETLEN and
SEG6\_ATTR\_ALGID. Because the SECRETLEN attribute is decoupled from the actual
length of the SECRET attribute, it is possible to provide invalid combinations
(e.g., secret = "", secretlen = 64). This case is not checked in the code and
with an appropriately crafted netlink message, an out-of-bounds read of up
to 64 bytes (max secret length) can occur past the skb end pointer and into
skb\_shared\_info:
Breakpoint 1, seg6\_genl\_sethmac (skb=<optimized out>, info=<optimized out>) at net/ipv6/seg6.c:208
208 memcpy(hinfo->secret, secret, slen);
(gdb) bt
#0 seg6\_genl\_sethmac (skb=<optimized out>, info=<optimized out>) at net/ipv6/seg6.c:208
#1 0xffffffff81e012e9 in genl\_family\_rcv\_msg\_doit (skb=skb@entry=0xffff88800b1f9f00, nlh=nlh@entry=0xffff88800b1b7600,
extack=extack@entry=0xffffc90000ba7af0, ops=ops@entry=0xffffc90000ba7a80, hdrlen=4, net=0xffffffff84237580 <init\_net>, family=<optimized out>,
family=<optimized out>) at net/netlink/genetlink.c:731
#2 0xffffffff81e01435 in genl\_family\_rcv\_msg (extack=0xffffc90000ba7af0, nlh=0xffff88800b1b7600, skb=0xffff88800b1f9f00,
family=0xffffffff82fef6c0 <seg6\_genl\_family>) at net/netlink/genetlink.c:775
#3 genl\_rcv\_msg (skb=0xffff88800b1f9f00, nlh=0xffff88800b1b7600, extack=0xffffc90000ba7af0) at net/netlink/genetlink.c:792
#4 0xffffffff81dfffc3 in netlink\_rcv\_skb (skb=skb@entry=0xffff88800b1f9f00, cb=cb@entry=0xffffffff81e01350 <genl\_rcv\_msg>)
at net/netlink/af\_netlink.c:2501
#5 0xffffffff81e00919 in genl\_rcv (skb=0xffff88800b1f9f00) at net/netlink/genetlink.c:803
#6 0xffffffff81dff6ae in netlink\_unicast\_kernel (ssk=0xffff888010eec800, skb=0xffff88800b1f9f00, sk=0xffff888004aed000)
at net/netlink/af\_netlink.c:1319
#7 netlink\_unicast (ssk=ssk@entry=0xffff888010eec800, skb=skb@entry=0xffff88800b1f9f00, portid=portid@entry=0, nonblock=<optimized out>)
at net/netlink/af\_netlink.c:1345
#8 0xffffffff81dff9a4 in netlink\_sendmsg (sock=<optimized out>, msg=0xffffc90000ba7e48, len=<optimized out>) at net/netlink/af\_netlink.c:1921
...
(gdb) p/x ((struct sk\_buff \*)0xffff88800b1f9f00)->head + ((struct sk\_buff \*)0xffff88800b1f9f00)->end
$1 = 0xffff88800b1b76c0
(gdb) p/x secret
$2 = 0xffff88800b1b76c0
(gdb) p slen
$3 = 64 '@'
The OOB data can then be read back from userspace by dumping HMAC state. This
commit fixes this by ensuring SECRETLEN cannot exceed the actual length of
SECRET.
Reported-by: Lucas Leong <wmliang.tw@gmail.com>
Tested: verified that EINVAL is correctly returned when secretlen > len(secret)
Fixes: 4f4853dc1c9c1 ("ipv6: sr: implement API to control SR HMAC structure")
Signed-off-by: David Lebrun <dlebrun@google.com>
Signed-off-by: David S. Miller <davem@davemloft.net>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=84a53580c5d2138c7361c7c3eea5b31827e63b35)

| -rw-r--r-- | [net/ipv6/seg6.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/net/ipv6/seg6.c?id=84a53580c5d2138c7361c7c3eea5b31827e63b35) | 5 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 5 insertions, 0 deletions

| diff --git a/net/ipv6/seg6.c b/net/ipv6/seg6.cindex 73aaabf0e96655..0b0e34ddc64e0a 100644--- a/[net/ipv6/seg6.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/ipv6/seg6.c?id=060ad609fa38e9a62fd5f79d0aaf83f94e6f0e36)+++ b/[net/ipv6/seg6.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/ipv6/seg6.c?id=84a53580c5d2138c7361c7c3eea5b31827e63b35)@@ -191,6 +191,11 @@ static int seg6\_genl\_sethmac(struct sk\_buff \*skb, struct genl\_info \*info) goto out\_unlock; } + if (slen > nla\_len(info->attrs[SEG6\_ATTR\_SECRET])) {+ err = -EINVAL;+ goto out\_unlock;+ }+ if (hinfo) { err = seg6\_hmac\_info\_del(net, hmackeyid); if (err) |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 13:11:16 +0000



=== Content from git.kernel.org_ed56f5b8_20250111_131237.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=55195563ec29f80f984237b743de0e2b6ba4d093)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=55195563ec29f80f984237b743de0e2b6ba4d093)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=55195563ec29f80f984237b743de0e2b6ba4d093)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=55195563ec29f80f984237b743de0e2b6ba4d093)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | David Lebrun <dlebrun@google.com> | 2022-09-02 10:45:06 +0100 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2022-09-15 11:30:06 +0200 |
| commit | [55195563ec29f80f984237b743de0e2b6ba4d093](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=55195563ec29f80f984237b743de0e2b6ba4d093) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=55195563ec29f80f984237b743de0e2b6ba4d093)) | |
| tree | [c0292f5efeb57adb5bfcfc4681af2bbfad1c59bc](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=55195563ec29f80f984237b743de0e2b6ba4d093) | |
| parent | [4c4eda13641017577e3b7e1d6d23cfd11a56e003](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=4c4eda13641017577e3b7e1d6d23cfd11a56e003) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=55195563ec29f80f984237b743de0e2b6ba4d093&id2=4c4eda13641017577e3b7e1d6d23cfd11a56e003)) | |
| download | [linux-55195563ec29f80f984237b743de0e2b6ba4d093.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-55195563ec29f80f984237b743de0e2b6ba4d093.tar.gz) | |

ipv6: sr: fix out-of-bounds read when setting HMAC data.[ Upstream commit 84a53580c5d2138c7361c7c3eea5b31827e63b35 ]
The SRv6 layer allows defining HMAC data that can later be used to sign IPv6
Segment Routing Headers. This configuration is realised via netlink through
four attributes: SEG6\_ATTR\_HMACKEYID, SEG6\_ATTR\_SECRET, SEG6\_ATTR\_SECRETLEN and
SEG6\_ATTR\_ALGID. Because the SECRETLEN attribute is decoupled from the actual
length of the SECRET attribute, it is possible to provide invalid combinations
(e.g., secret = "", secretlen = 64). This case is not checked in the code and
with an appropriately crafted netlink message, an out-of-bounds read of up
to 64 bytes (max secret length) can occur past the skb end pointer and into
skb\_shared\_info:
Breakpoint 1, seg6\_genl\_sethmac (skb=<optimized out>, info=<optimized out>) at net/ipv6/seg6.c:208
208 memcpy(hinfo->secret, secret, slen);
(gdb) bt
#0 seg6\_genl\_sethmac (skb=<optimized out>, info=<optimized out>) at net/ipv6/seg6.c:208
#1 0xffffffff81e012e9 in genl\_family\_rcv\_msg\_doit (skb=skb@entry=0xffff88800b1f9f00, nlh=nlh@entry=0xffff88800b1b7600,
extack=extack@entry=0xffffc90000ba7af0, ops=ops@entry=0xffffc90000ba7a80, hdrlen=4, net=0xffffffff84237580 <init\_net>, family=<optimized out>,
family=<optimized out>) at net/netlink/genetlink.c:731
#2 0xffffffff81e01435 in genl\_family\_rcv\_msg (extack=0xffffc90000ba7af0, nlh=0xffff88800b1b7600, skb=0xffff88800b1f9f00,
family=0xffffffff82fef6c0 <seg6\_genl\_family>) at net/netlink/genetlink.c:775
#3 genl\_rcv\_msg (skb=0xffff88800b1f9f00, nlh=0xffff88800b1b7600, extack=0xffffc90000ba7af0) at net/netlink/genetlink.c:792
#4 0xffffffff81dfffc3 in netlink\_rcv\_skb (skb=skb@entry=0xffff88800b1f9f00, cb=cb@entry=0xffffffff81e01350 <genl\_rcv\_msg>)
at net/netlink/af\_netlink.c:2501
#5 0xffffffff81e00919 in genl\_rcv (skb=0xffff88800b1f9f00) at net/netlink/genetlink.c:803
#6 0xffffffff81dff6ae in netlink\_unicast\_kernel (ssk=0xffff888010eec800, skb=0xffff88800b1f9f00, sk=0xffff888004aed000)
at net/netlink/af\_netlink.c:1319
#7 netlink\_unicast (ssk=ssk@entry=0xffff888010eec800, skb=skb@entry=0xffff88800b1f9f00, portid=portid@entry=0, nonblock=<optimized out>)
at net/netlink/af\_netlink.c:1345
#8 0xffffffff81dff9a4 in netlink\_sendmsg (sock=<optimized out>, msg=0xffffc90000ba7e48, len=<optimized out>) at net/netlink/af\_netlink.c:1921
...
(gdb) p/x ((struct sk\_buff \*)0xffff88800b1f9f00)->head + ((struct sk\_buff \*)0xffff88800b1f9f00)->end
$1 = 0xffff88800b1b76c0
(gdb) p/x secret
$2 = 0xffff88800b1b76c0
(gdb) p slen
$3 = 64 '@'
The OOB data can then be read back from userspace by dumping HMAC state. This
commit fixes this by ensuring SECRETLEN cannot exceed the actual length of
SECRET.
Reported-by: Lucas Leong <wmliang.tw@gmail.com>
Tested: verified that EINVAL is correctly returned when secretlen > len(secret)
Fixes: 4f4853dc1c9c1 ("ipv6: sr: implement API to control SR HMAC structure")
Signed-off-by: David Lebrun <dlebrun@google.com>
Signed-off-by: David S. Miller <davem@davemloft.net>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=55195563ec29f80f984237b743de0e2b6ba4d093)

| -rw-r--r-- | [net/ipv6/seg6.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/net/ipv6/seg6.c?id=55195563ec29f80f984237b743de0e2b6ba4d093) | 5 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 5 insertions, 0 deletions

| diff --git a/net/ipv6/seg6.c b/net/ipv6/seg6.cindex fa6b64c95d3ae2..0c7c6fc16c3c3b 100644--- a/[net/ipv6/seg6.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/ipv6/seg6.c?id=4c4eda13641017577e3b7e1d6d23cfd11a56e003)+++ b/[net/ipv6/seg6.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/ipv6/seg6.c?id=55195563ec29f80f984237b743de0e2b6ba4d093)@@ -191,6 +191,11 @@ static int seg6\_genl\_sethmac(struct sk\_buff \*skb, struct genl\_info \*info) goto out\_unlock; } + if (slen > nla\_len(info->attrs[SEG6\_ATTR\_SECRET])) {+ err = -EINVAL;+ goto out\_unlock;+ }+ if (hinfo) { err = seg6\_hmac\_info\_del(net, hmackeyid); if (err) |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 13:11:14 +0000



=== Content from git.kernel.org_9a617333_20250111_131235.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=076f2479fc5a15c4a970ca3b5e57d42ba09a31fa)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=076f2479fc5a15c4a970ca3b5e57d42ba09a31fa)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=076f2479fc5a15c4a970ca3b5e57d42ba09a31fa)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=076f2479fc5a15c4a970ca3b5e57d42ba09a31fa)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | David Lebrun <dlebrun@google.com> | 2022-09-02 10:45:06 +0100 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2022-09-15 11:32:05 +0200 |
| commit | [076f2479fc5a15c4a970ca3b5e57d42ba09a31fa](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=076f2479fc5a15c4a970ca3b5e57d42ba09a31fa) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=076f2479fc5a15c4a970ca3b5e57d42ba09a31fa)) | |
| tree | [af53c746b1eb635a91543b9c416a7757221e4e5f](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=076f2479fc5a15c4a970ca3b5e57d42ba09a31fa) | |
| parent | [047e66867eb6ffc4dcbf145b13f9943990f1ca88](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=047e66867eb6ffc4dcbf145b13f9943990f1ca88) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=076f2479fc5a15c4a970ca3b5e57d42ba09a31fa&id2=047e66867eb6ffc4dcbf145b13f9943990f1ca88)) | |
| download | [linux-076f2479fc5a15c4a970ca3b5e57d42ba09a31fa.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-076f2479fc5a15c4a970ca3b5e57d42ba09a31fa.tar.gz) | |

ipv6: sr: fix out-of-bounds read when setting HMAC data.[ Upstream commit 84a53580c5d2138c7361c7c3eea5b31827e63b35 ]
The SRv6 layer allows defining HMAC data that can later be used to sign IPv6
Segment Routing Headers. This configuration is realised via netlink through
four attributes: SEG6\_ATTR\_HMACKEYID, SEG6\_ATTR\_SECRET, SEG6\_ATTR\_SECRETLEN and
SEG6\_ATTR\_ALGID. Because the SECRETLEN attribute is decoupled from the actual
length of the SECRET attribute, it is possible to provide invalid combinations
(e.g., secret = "", secretlen = 64). This case is not checked in the code and
with an appropriately crafted netlink message, an out-of-bounds read of up
to 64 bytes (max secret length) can occur past the skb end pointer and into
skb\_shared\_info:
Breakpoint 1, seg6\_genl\_sethmac (skb=<optimized out>, info=<optimized out>) at net/ipv6/seg6.c:208
208 memcpy(hinfo->secret, secret, slen);
(gdb) bt
#0 seg6\_genl\_sethmac (skb=<optimized out>, info=<optimized out>) at net/ipv6/seg6.c:208
#1 0xffffffff81e012e9 in genl\_family\_rcv\_msg\_doit (skb=skb@entry=0xffff88800b1f9f00, nlh=nlh@entry=0xffff88800b1b7600,
extack=extack@entry=0xffffc90000ba7af0, ops=ops@entry=0xffffc90000ba7a80, hdrlen=4, net=0xffffffff84237580 <init\_net>, family=<optimized out>,
family=<optimized out>) at net/netlink/genetlink.c:731
#2 0xffffffff81e01435 in genl\_family\_rcv\_msg (extack=0xffffc90000ba7af0, nlh=0xffff88800b1b7600, skb=0xffff88800b1f9f00,
family=0xffffffff82fef6c0 <seg6\_genl\_family>) at net/netlink/genetlink.c:775
#3 genl\_rcv\_msg (skb=0xffff88800b1f9f00, nlh=0xffff88800b1b7600, extack=0xffffc90000ba7af0) at net/netlink/genetlink.c:792
#4 0xffffffff81dfffc3 in netlink\_rcv\_skb (skb=skb@entry=0xffff88800b1f9f00, cb=cb@entry=0xffffffff81e01350 <genl\_rcv\_msg>)
at net/netlink/af\_netlink.c:2501
#5 0xffffffff81e00919 in genl\_rcv (skb=0xffff88800b1f9f00) at net/netlink/genetlink.c:803
#6 0xffffffff81dff6ae in netlink\_unicast\_kernel (ssk=0xffff888010eec800, skb=0xffff88800b1f9f00, sk=0xffff888004aed000)
at net/netlink/af\_netlink.c:1319
#7 netlink\_unicast (ssk=ssk@entry=0xffff888010eec800, skb=skb@entry=0xffff88800b1f9f00, portid=portid@entry=0, nonblock=<optimized out>)
at net/netlink/af\_netlink.c:1345
#8 0xffffffff81dff9a4 in netlink\_sendmsg (sock=<optimized out>, msg=0xffffc90000ba7e48, len=<optimized out>) at net/netlink/af\_netlink.c:1921
...
(gdb) p/x ((struct sk\_buff \*)0xffff88800b1f9f00)->head + ((struct sk\_buff \*)0xffff88800b1f9f00)->end
$1 = 0xffff88800b1b76c0
(gdb) p/x secret
$2 = 0xffff88800b1b76c0
(gdb) p slen
$3 = 64 '@'
The OOB data can then be read back from userspace by dumping HMAC state. This
commit fixes this by ensuring SECRETLEN cannot exceed the actual length of
SECRET.
Reported-by: Lucas Leong <wmliang.tw@gmail.com>
Tested: verified that EINVAL is correctly returned when secretlen > len(secret)
Fixes: 4f4853dc1c9c1 ("ipv6: sr: implement API to control SR HMAC structure")
Signed-off-by: David Lebrun <dlebrun@google.com>
Signed-off-by: David S. Miller <davem@davemloft.net>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=076f2479fc5a15c4a970ca3b5e57d42ba09a31fa)

| -rw-r--r-- | [net/ipv6/seg6.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/net/ipv6/seg6.c?id=076f2479fc5a15c4a970ca3b5e57d42ba09a31fa) | 5 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 5 insertions, 0 deletions

| diff --git a/net/ipv6/seg6.c b/net/ipv6/seg6.cindex d2f8138e5a73a5..2278c0234c4979 100644--- a/[net/ipv6/seg6.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/ipv6/seg6.c?id=047e66867eb6ffc4dcbf145b13f9943990f1ca88)+++ b/[net/ipv6/seg6.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/ipv6/seg6.c?id=076f2479fc5a15c4a970ca3b5e57d42ba09a31fa)@@ -135,6 +135,11 @@ static int seg6\_genl\_sethmac(struct sk\_buff \*skb, struct genl\_info \*info) goto out\_unlock; } + if (slen > nla\_len(info->attrs[SEG6\_ATTR\_SECRET])) {+ err = -EINVAL;+ goto out\_unlock;+ }+ if (hinfo) { err = seg6\_hmac\_info\_del(net, hmackeyid); if (err) |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 13:11:12 +0000



=== Content from git.kernel.org_b95f227f_20250111_131238.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=56ad3f475482bca55b0ae544031333018eb145b3)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=56ad3f475482bca55b0ae544031333018eb145b3)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=56ad3f475482bca55b0ae544031333018eb145b3)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=56ad3f475482bca55b0ae544031333018eb145b3)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | David Lebrun <dlebrun@google.com> | 2022-09-02 10:45:06 +0100 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2022-09-15 10:47:16 +0200 |
| commit | [56ad3f475482bca55b0ae544031333018eb145b3](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=56ad3f475482bca55b0ae544031333018eb145b3) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=56ad3f475482bca55b0ae544031333018eb145b3)) | |
| tree | [96a5cb2171cdcb64043fa5d2e1de3f8305e43723](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=56ad3f475482bca55b0ae544031333018eb145b3) | |
| parent | [17589c4ee37068a65d02e01f75eb02d671051a65](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=17589c4ee37068a65d02e01f75eb02d671051a65) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=56ad3f475482bca55b0ae544031333018eb145b3&id2=17589c4ee37068a65d02e01f75eb02d671051a65)) | |
| download | [linux-56ad3f475482bca55b0ae544031333018eb145b3.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-56ad3f475482bca55b0ae544031333018eb145b3.tar.gz) | |

ipv6: sr: fix out-of-bounds read when setting HMAC data.[ Upstream commit 84a53580c5d2138c7361c7c3eea5b31827e63b35 ]
The SRv6 layer allows defining HMAC data that can later be used to sign IPv6
Segment Routing Headers. This configuration is realised via netlink through
four attributes: SEG6\_ATTR\_HMACKEYID, SEG6\_ATTR\_SECRET, SEG6\_ATTR\_SECRETLEN and
SEG6\_ATTR\_ALGID. Because the SECRETLEN attribute is decoupled from the actual
length of the SECRET attribute, it is possible to provide invalid combinations
(e.g., secret = "", secretlen = 64). This case is not checked in the code and
with an appropriately crafted netlink message, an out-of-bounds read of up
to 64 bytes (max secret length) can occur past the skb end pointer and into
skb\_shared\_info:
Breakpoint 1, seg6\_genl\_sethmac (skb=<optimized out>, info=<optimized out>) at net/ipv6/seg6.c:208
208 memcpy(hinfo->secret, secret, slen);
(gdb) bt
#0 seg6\_genl\_sethmac (skb=<optimized out>, info=<optimized out>) at net/ipv6/seg6.c:208
#1 0xffffffff81e012e9 in genl\_family\_rcv\_msg\_doit (skb=skb@entry=0xffff88800b1f9f00, nlh=nlh@entry=0xffff88800b1b7600,
extack=extack@entry=0xffffc90000ba7af0, ops=ops@entry=0xffffc90000ba7a80, hdrlen=4, net=0xffffffff84237580 <init\_net>, family=<optimized out>,
family=<optimized out>) at net/netlink/genetlink.c:731
#2 0xffffffff81e01435 in genl\_family\_rcv\_msg (extack=0xffffc90000ba7af0, nlh=0xffff88800b1b7600, skb=0xffff88800b1f9f00,
family=0xffffffff82fef6c0 <seg6\_genl\_family>) at net/netlink/genetlink.c:775
#3 genl\_rcv\_msg (skb=0xffff88800b1f9f00, nlh=0xffff88800b1b7600, extack=0xffffc90000ba7af0) at net/netlink/genetlink.c:792
#4 0xffffffff81dfffc3 in netlink\_rcv\_skb (skb=skb@entry=0xffff88800b1f9f00, cb=cb@entry=0xffffffff81e01350 <genl\_rcv\_msg>)
at net/netlink/af\_netlink.c:2501
#5 0xffffffff81e00919 in genl\_rcv (skb=0xffff88800b1f9f00) at net/netlink/genetlink.c:803
#6 0xffffffff81dff6ae in netlink\_unicast\_kernel (ssk=0xffff888010eec800, skb=0xffff88800b1f9f00, sk=0xffff888004aed000)
at net/netlink/af\_netlink.c:1319
#7 netlink\_unicast (ssk=ssk@entry=0xffff888010eec800, skb=skb@entry=0xffff88800b1f9f00, portid=portid@entry=0, nonblock=<optimized out>)
at net/netlink/af\_netlink.c:1345
#8 0xffffffff81dff9a4 in netlink\_sendmsg (sock=<optimized out>, msg=0xffffc90000ba7e48, len=<optimized out>) at net/netlink/af\_netlink.c:1921
...
(gdb) p/x ((struct sk\_buff \*)0xffff88800b1f9f00)->head + ((struct sk\_buff \*)0xffff88800b1f9f00)->end
$1 = 0xffff88800b1b76c0
(gdb) p/x secret
$2 = 0xffff88800b1b76c0
(gdb) p slen
$3 = 64 '@'
The OOB data can then be read back from userspace by dumping HMAC state. This
commit fixes this by ensuring SECRETLEN cannot exceed the actual length of
SECRET.
Reported-by: Lucas Leong <wmliang.tw@gmail.com>
Tested: verified that EINVAL is correctly returned when secretlen > len(secret)
Fixes: 4f4853dc1c9c1 ("ipv6: sr: implement API to control SR HMAC structure")
Signed-off-by: David Lebrun <dlebrun@google.com>
Signed-off-by: David S. Miller <davem@davemloft.net>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=56ad3f475482bca55b0ae544031333018eb145b3)

| -rw-r--r-- | [net/ipv6/seg6.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/net/ipv6/seg6.c?id=56ad3f475482bca55b0ae544031333018eb145b3) | 5 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 5 insertions, 0 deletions

| diff --git a/net/ipv6/seg6.c b/net/ipv6/seg6.cindex 73aaabf0e96655..0b0e34ddc64e0a 100644--- a/[net/ipv6/seg6.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/ipv6/seg6.c?id=17589c4ee37068a65d02e01f75eb02d671051a65)+++ b/[net/ipv6/seg6.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/ipv6/seg6.c?id=56ad3f475482bca55b0ae544031333018eb145b3)@@ -191,6 +191,11 @@ static int seg6\_genl\_sethmac(struct sk\_buff \*skb, struct genl\_info \*info) goto out\_unlock; } + if (slen > nla\_len(info->attrs[SEG6\_ATTR\_SECRET])) {+ err = -EINVAL;+ goto out\_unlock;+ }+ if (hinfo) { err = seg6\_hmac\_info\_del(net, hmackeyid); if (err) |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 13:11:16 +0000



=== Content from git.kernel.org_3383fc17_20250111_131240.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=dc9dbd65c803af1607484fed5da50d41dc8dd864)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=dc9dbd65c803af1607484fed5da50d41dc8dd864)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=dc9dbd65c803af1607484fed5da50d41dc8dd864)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=dc9dbd65c803af1607484fed5da50d41dc8dd864)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | David Lebrun <dlebrun@google.com> | 2022-09-02 10:45:06 +0100 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2022-09-15 12:23:52 +0200 |
| commit | [dc9dbd65c803af1607484fed5da50d41dc8dd864](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=dc9dbd65c803af1607484fed5da50d41dc8dd864) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=dc9dbd65c803af1607484fed5da50d41dc8dd864)) | |
| tree | [55ee9033e75f26f953cde017deee0b3eb0063ba3](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=dc9dbd65c803af1607484fed5da50d41dc8dd864) | |
| parent | [c9d6f7ce3b13c48d6693055fae996be72a2d71b0](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=c9d6f7ce3b13c48d6693055fae996be72a2d71b0) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=dc9dbd65c803af1607484fed5da50d41dc8dd864&id2=c9d6f7ce3b13c48d6693055fae996be72a2d71b0)) | |
| download | [linux-dc9dbd65c803af1607484fed5da50d41dc8dd864.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-dc9dbd65c803af1607484fed5da50d41dc8dd864.tar.gz) | |

ipv6: sr: fix out-of-bounds read when setting HMAC data.[ Upstream commit 84a53580c5d2138c7361c7c3eea5b31827e63b35 ]
The SRv6 layer allows defining HMAC data that can later be used to sign IPv6
Segment Routing Headers. This configuration is realised via netlink through
four attributes: SEG6\_ATTR\_HMACKEYID, SEG6\_ATTR\_SECRET, SEG6\_ATTR\_SECRETLEN and
SEG6\_ATTR\_ALGID. Because the SECRETLEN attribute is decoupled from the actual
length of the SECRET attribute, it is possible to provide invalid combinations
(e.g., secret = "", secretlen = 64). This case is not checked in the code and
with an appropriately crafted netlink message, an out-of-bounds read of up
to 64 bytes (max secret length) can occur past the skb end pointer and into
skb\_shared\_info:
Breakpoint 1, seg6\_genl\_sethmac (skb=<optimized out>, info=<optimized out>) at net/ipv6/seg6.c:208
208 memcpy(hinfo->secret, secret, slen);
(gdb) bt
#0 seg6\_genl\_sethmac (skb=<optimized out>, info=<optimized out>) at net/ipv6/seg6.c:208
#1 0xffffffff81e012e9 in genl\_family\_rcv\_msg\_doit (skb=skb@entry=0xffff88800b1f9f00, nlh=nlh@entry=0xffff88800b1b7600,
extack=extack@entry=0xffffc90000ba7af0, ops=ops@entry=0xffffc90000ba7a80, hdrlen=4, net=0xffffffff84237580 <init\_net>, family=<optimized out>,
family=<optimized out>) at net/netlink/genetlink.c:731
#2 0xffffffff81e01435 in genl\_family\_rcv\_msg (extack=0xffffc90000ba7af0, nlh=0xffff88800b1b7600, skb=0xffff88800b1f9f00,
family=0xffffffff82fef6c0 <seg6\_genl\_family>) at net/netlink/genetlink.c:775
#3 genl\_rcv\_msg (skb=0xffff88800b1f9f00, nlh=0xffff88800b1b7600, extack=0xffffc90000ba7af0) at net/netlink/genetlink.c:792
#4 0xffffffff81dfffc3 in netlink\_rcv\_skb (skb=skb@entry=0xffff88800b1f9f00, cb=cb@entry=0xffffffff81e01350 <genl\_rcv\_msg>)
at net/netlink/af\_netlink.c:2501
#5 0xffffffff81e00919 in genl\_rcv (skb=0xffff88800b1f9f00) at net/netlink/genetlink.c:803
#6 0xffffffff81dff6ae in netlink\_unicast\_kernel (ssk=0xffff888010eec800, skb=0xffff88800b1f9f00, sk=0xffff888004aed000)
at net/netlink/af\_netlink.c:1319
#7 netlink\_unicast (ssk=ssk@entry=0xffff888010eec800, skb=skb@entry=0xffff88800b1f9f00, portid=portid@entry=0, nonblock=<optimized out>)
at net/netlink/af\_netlink.c:1345
#8 0xffffffff81dff9a4 in netlink\_sendmsg (sock=<optimized out>, msg=0xffffc90000ba7e48, len=<optimized out>) at net/netlink/af\_netlink.c:1921
...
(gdb) p/x ((struct sk\_buff \*)0xffff88800b1f9f00)->head + ((struct sk\_buff \*)0xffff88800b1f9f00)->end
$1 = 0xffff88800b1b76c0
(gdb) p/x secret
$2 = 0xffff88800b1b76c0
(gdb) p slen
$3 = 64 '@'
The OOB data can then be read back from userspace by dumping HMAC state. This
commit fixes this by ensuring SECRETLEN cannot exceed the actual length of
SECRET.
Reported-by: Lucas Leong <wmliang.tw@gmail.com>
Tested: verified that EINVAL is correctly returned when secretlen > len(secret)
Fixes: 4f4853dc1c9c1 ("ipv6: sr: implement API to control SR HMAC structure")
Signed-off-by: David Lebrun <dlebrun@google.com>
Signed-off-by: David S. Miller <davem@davemloft.net>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=dc9dbd65c803af1607484fed5da50d41dc8dd864)

| -rw-r--r-- | [net/ipv6/seg6.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/net/ipv6/seg6.c?id=dc9dbd65c803af1607484fed5da50d41dc8dd864) | 5 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 5 insertions, 0 deletions

| diff --git a/net/ipv6/seg6.c b/net/ipv6/seg6.cindex fdeb90dd1c8240..9c45165fe79bb2 100644--- a/[net/ipv6/seg6.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/ipv6/seg6.c?id=c9d6f7ce3b13c48d6693055fae996be72a2d71b0)+++ b/[net/ipv6/seg6.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/ipv6/seg6.c?id=dc9dbd65c803af1607484fed5da50d41dc8dd864)@@ -129,6 +129,11 @@ static int seg6\_genl\_sethmac(struct sk\_buff \*skb, struct genl\_info \*info) goto out\_unlock; } + if (slen > nla\_len(info->attrs[SEG6\_ATTR\_SECRET])) {+ err = -EINVAL;+ goto out\_unlock;+ }+ if (hinfo) { err = seg6\_hmac\_info\_del(net, hmackeyid); if (err) |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 13:11:18 +0000


