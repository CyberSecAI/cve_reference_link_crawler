- **Root cause of vulnerability:** The `print_cpu_stall_info()` function in the Linux kernel's RCU (Read-Copy-Update) subsystem uses `sprintf()` to format a string containing the difference in jiffies, which is an unsigned value. If the jiffies difference is very large (e.g., due to a system time issue) it can result in a buffer overflow because the buffer size is fixed and `sprintf` does not perform bounds checking.
- **Weaknesses/vulnerabilities present:** Buffer overflow due to unbounded string formatting using `sprintf`. The usage of `%ld` for an unsigned value might lead to unexpected behavior or confusion during debugging.
- **Impact of exploitation:** A buffer overflow in kernel space could lead to a denial of service (crash) or potentially arbitrary code execution, depending on how the overflowed buffer is used.
- **Attack vectors:** The vulnerability is triggered when a large jiffies difference is detected within the RCU subsystem during the execution of `print_cpu_stall_info()`. This could be triggered by system time issues causing large jumps in reported times.
- **Required attacker capabilities/position:** An attacker would need to cause the system to experience large jiffies differences which may be accomplished by manipulating the system time or by inducing some kind of stall or fault in time reporting.