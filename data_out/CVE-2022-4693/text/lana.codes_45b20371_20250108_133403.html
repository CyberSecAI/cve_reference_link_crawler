
[Skip to content](#content)

[![Lana Report](https://lana.report/wp-content/uploads/lana-report-inverse-text-logo-with-mascot.png)](https://lana.report/)

* [Front Page](https://lana.report/)
* [Reports](https://lana.report/vulnerability/)
* [Publications](https://lana.report/publication/)

1. [Lana Report](https://lana.report/)
2. [Publications](https://lana.report/publication/)

### User Verification by PickPlugins WordPress plugin Authentication Bypass

REPORT ID: eeabe1d3-6f64-400a-8fb2-0865efdf6957

The plugin contains an Auth Bypass vulnerability. To bypass authentication, we only need to know the user‚Äôs username. Depending on whose username we know, which can be easily queried because it is usually public data, we may even be given an administrator role on the website.

#### Let‚Äôs check the plugin

The `user_verification_send_otp()` function generates an otp with the following code:

```
$password = wp_generate_password(6, false, false);
update_user_meta($user_id, 'uv_otp', $password);
```

and sends the user the otp by email with the following code:

```
$user_data['otp'] = $password;
$otp_via_mail = user_verification_send_otp_via_mail($user_data);
```

but the otp is also returned in the ajax response:

```
$response['password'] = $password;
echo json_encode($response);
```

The problem is that the password, which should only be received by the user via email, becomes public in this way.

#### Let‚Äôs configure the plugin

In the User Verification Settings, select the ‚ÄúYes‚Äù option for ‚ÄúEnable on default login‚Äù.

This setting is required to log in to the website using otp.

#### Let‚Äôs see how we can exploit this vulnerability

All we have to do is check the request response, the easiest way is with the browser console.

[![](https://lana.report/wp-content/uploads/user-verification-otp-login-screenshot.png)](https://lana.report/wp-content/uploads/user-verification-otp-login-screenshot.png)

Screenshot: User Verification *‚Äì Sent OTP at Login*

[![](https://lana.report/wp-content/uploads/user-verification-enter-otp-screenshot.png)](https://lana.report/wp-content/uploads/user-verification-enter-otp-screenshot.png)

Screenshot: User Verification *‚Äì Enter OTP, and and the password in reponse*

As we can see in the screenshot, the password is included in the json in the response:

```
{"success_message":"OTP has been sent successfully.","otp_via_mail":true,"password":"pQ8IAi","uv_otp_count":1}
```

If we enter this password in the ‚ÄúEnter OTP‚Äù field and click on the Log In button, we will log in to the given user.

#### Try it

Feel free to try and use the lana.solutions/vdb WordPress websites for testing. I have set the roles and capabilities, so you can only get low level access to the website.

Website: <https://lana.solutions/vdb/pickplugins-user-verification/>

### References

Source Code
<https://wordpress.org/plugins/user-verification/>

Repository
<https://plugins.svn.wordpress.org/user-verification/>

Lana Report
<https://lana.report/vulnerability/e2bb48ab-56ca-42c7-8c1f-9a270f39f349/>

CVE
[CVE-2022-4693](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-4693)

### Let's discuss

### Attributes

Catgory
WordPress Plugin

Vulnerability Discovered
2022-12-18

Post Published
2022-12-21

Affected Version
<= 1.0.93

### Classification

Type
Authentication Bypass

### Researcher

Name
[Istv√°n M√°rton](https://lana.report "Visit Istv√°n M√°rton‚Äôs website")

Email
[[email¬†protected]](/cdn-cgi/l/email-protection#0c65626a634c606d626d226f6368697f)

### Tags

authentication bypass
exploit
wordpress plugin

### Advertisement

### Support Us?

We would truly appreciate it if you bought us a bunny (food for a snow leopard).

[![buy me a bunny!](https://img.buymeacoffee.com/button-api/?text=buy me a bunny!&emoji=üê∞&slug=lanacodes&button_colour=0776eb&font_colour=ffffff&font_family=Lato&outline_colour=ffffff&coffee_colour=FFDD00)](https://www.buymeacoffee.com/lanacodes)

![](https://lana.report/wp-content/uploads/lana-report-inverse-text-logo-with-mascot.png)

The Lana Report is a database containing vulnerabilities researched and published by Lana Solutions.

### General

* [Vulnerabilities](https://lana.report/vulnerability/)
* [Publications](https://lana.report/publication/)

### Lana Solutions

* [Lana Codes](https://lana.codes/)
### Wordfence

* [Bug Bounty Program](https://wordfence.com/refer/lanareport)

### Socials

* [Telegram](https://t.me/LanaReport)
* [Twitter](https://twitter.com/LanaReport)

Lana Report ¬© 2024 All Rights Reserved.

Made with üíô by [Lana Codes](https://lana.codes/)

