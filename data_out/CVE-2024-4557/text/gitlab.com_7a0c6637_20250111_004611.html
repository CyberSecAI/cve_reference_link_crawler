

[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

# DOS via move\_issue (Bypass #1543584)

âš  **Please read [the process](https://gitlab.com/gitlab-org/release/docs/-/blob/master/general/security/developer.md) on how to fix security issues before starting to work on the issue. Vulnerabilities must be fixed in a security mirror.**

**[HackerOne report #2485172](https://hackerone.com/reports/2485172)** by `setiawan_` on 2024-05-01, assigned to `GitLab Team`:

[Report](#report) | [Attachments](#attachments) | [How To Reproduce](#how-to-reproduce)

## Report

* When evaluating Availability impact for DoS that requires continuous traffic, use the 1k Reference Architecture. The number of requests must be less than the "test request rate per second" and cause unavailability of 10+ seconds that the user can perceive to assess the impact as `A:H` . [clarifying-notes](https://gitlab-com.gitlab.io/gl-security/product-security/appsec/cvss-calculator/#clarifying-notes).
* I am using 8 vCPU [1k users reference architectures](https://docs.gitlab.com/ee/administration/reference_architectures/1k_users.html)

##### Summary

Moving an issue with a specially-crafted description Linear-sized input creates a square-sized table results in high CPU usage for 60 seconds (request timeout).

The table syntax allows columns to be omitted from some of the rows. Rows with too few columns are automatically extended to the correct length. For example, each `|a|` row in this example gets extended to 5 columns:

##### Steps to reproduce

Reproduce:

1. Create a project
2. Create an issue with the following description. [![DoS_Move_Issues.txt](data:image/gif;base64...)](https://user-content.gitlab-static.net/92197762dd7adba36f8c6fae2f65c84fdfeaa9fc/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f62306335636634312d646463392d346566302d396364392d3135336662633731343662342f446f535f4d6f76655f4973737565732e747874) (You can skip this way and use the issues at [Gitlab](https://gitlab.com/gitlab-org/gitlab/-/issues/). But this is not recommended, Please use your local installation )
3. Click Bulk Edit in Issues and check the issue you created.
4. Click Move Selected
5. Select the project you want to move to to trigger DoS.

[bandicam\_2024-05-01\_18-16-53-337.mp4](https://user-content.gitlab-static.net/0db782652839e568a0562081500e53eea23286f3/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f37376634626335362d333566622d343138622d393436332d6130313838323734366533392f62616e646963616d5f323032342d30352d30315f31382d31362d35332d3333372e6d7034 "Download 'bandicam_2024-05-01_18-16-53-337.mp4'")

##### Output of checks

This bug happens on GitLab.com , CE , EE.

###### Results of GitLab environment info

```
System information
System:         Debian 12
Current User:   git
Using RVM:      no
Ruby Version:   3.1.4p223
Gem Version:    3.5.7
Bundler Version:2.5.8
Rake Version:   13.0.6
Redis Version:  7.0.15
Sidekiq Version:7.1.6
Go Version:     unknown

GitLab information
Version:        16.11.1
Revision:       3ad2f8c9e62
Directory:      /opt/gitlab/embedded/service/gitlab-rails
DB Adapter:     PostgreSQL
DB Version:     14.11
URL:            https://x
HTTP Clone URL: https://x/some-group/some-project.git
SSH Clone URL:  git@x:some-group/some-project.git
Using LDAP:     no
Using Omniauth: yes
Omniauth Providers:

GitLab Shell
Version:        14.35.0
Repository storages:
- default:      unix:/var/opt/gitlab/gitaly/gitaly.socket
GitLab Shell path:              /opt/gitlab/embedded/service/gitlab-shell

Gitaly
- default Address:      unix:/var/opt/gitlab/gitaly/gitaly.socket
- default Version:      16.11.1
- default Git Version:  2.43.2
```

S:C Impact caused to systems beyond the exploitable component ( Graphql )

This issue can cause the graphql endpoint to DoS. This results in the cvss score being `S:C` Because the vulnerable component is GitLab and the affected component is the production server ( Graphql )

```
{"operationName":"moveIssue","variables":{"moveIssueInput":{"projectPath":"root/aaaaaa","iid":"6","targetProjectPath":"root/bbbbbbb"}}," query":"mutation moveIssue($moveIssueInput: IssueMoveInput!) {\n issueMove(input: $moveIssueInput) {\n issue {\n id\n webUrl\n __typename\n }\n errors\n __typename\n }\ n}\n"}
```

Response:

```
{"data":{"issueMove":null},"errors":[{"message":"Timeout on Base.issue","locations":[{"line":3,"column":5}] ,"path":["issueMove","issue"]},{"message":"Timeout on BaseMutation.errors","locations":[{"line":8,"column":5}]," path":["issueMove","errors"]}]}
```

[CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:N/I:N/A:H](https://gitlab-com.gitlab.io/gl-security/product-security/appsec/cvss-calculator/#vector=CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:N/I:N/A:H) (7.7 High )

#### Impact

* After 60 seconds (timeout) - request failed.
* Meanwhile, on the server side, (one) CPU is burning (verified against local instance).
* Issuing many requests in parallel causes many CPUs to run out of power.
* When using extension autolink, certain inputs will run out of resources indefinitely and subsequent denial of service.
* This also causes api/graphql to run out of resources

## Attachments

**Warning:** Attachments received through HackerOne, please exercise caution!

* [bandicam\_2024-05-01\_18-16-53-337.mp4](https://h1.sec.gitlab.net/a/77f4bc56-35fb-418b-9463-a01882746e39/bandicam_2024-05-01_18-16-53-337.mp4)
* [DoS\_Move\_Issues.txt](https://h1.sec.gitlab.net/a/b0c5cf41-ddc9-4ef0-9cd9-153fbc7146b4/DoS_Move_Issues.txt)

## How To Reproduce

Please add [reproducibility information](https://about.gitlab.com/handbook/engineering/security/#reproducibility-on-security-issues) to this section:

Edited Aug 23, 2024 by [Kevin Morrison](/kmorrison1)

Assignee
Loading

Time tracking
Loading

Confidentiality

Confidentiality controls have moved to the issue actions menu () at the top of the page.

