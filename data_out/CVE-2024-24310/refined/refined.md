Based on the provided content, here's a breakdown of the vulnerability:

**Root Cause:**

*   The vulnerability stems from a lack of proper sanitization of the `idshop` parameter in the `ajax.php` script within the "Generate barcode on invoice / delivery slip" module for PrestaShop. This allows for SQL injection attacks.

**Weaknesses/Vulnerabilities Present:**

*   **SQL Injection (CWE-89):** The module's `ajax.php` script directly uses user-supplied input (`idshop`) in a SQL query without proper sanitization or parameterization. This allows an attacker to inject malicious SQL code.
*   **Inadequate Token Validation:** The original code only checked if `ec_token` was set, and did not handle the cases where it did not exist or was empty.
*   The advisory also mentions the risk of Stored XSS if `pSQL` function is missing, although this is not the main focus of the CVE.

**Impact of Exploitation:**

*   **Gaining admin access:** Attackers can potentially gain administrative privileges on the PrestaShop platform.
*   **Data theft/removal:** Sensitive data can be stolen or deleted from the associated PrestaShop database.
*   **Exposure of sensitive data:** Data from sensitive tables can be exposed to the front-end, including tokens that unlock admin AJAX scripts.
*   **Email hijacking:** Attackers could modify SMTP settings to hijack emails.

**Attack Vectors:**

*   **Network:** The attack can be executed remotely over the network via HTTP requests.
*   **Direct HTTP call:** The vulnerable `ajax.php` script can be targeted with a trivial HTTP call, provided an order reference is known.

**Required Attacker Capabilities/Position:**

*   **Low privilege:** Attackers need low privileges but a valid order reference. This means the vulnerability could be exploited by unauthenticated users if the module is not correctly installed or configured and the secret token `ECO_TOKEN_BARCODE` is not set or empty.
*   **Knowledge of order reference:** A valid order reference needs to be known to exploit this vulnerability on a correctly configured module (where the token is set).
*   **Ability to forge HTTP requests:** The attacker needs to be able to craft HTTP requests to send to the vulnerable `ajax.php` file.

**Additional Notes:**

*   The advisory mentions that if the module has never been installed OR if the `ECO_TOKEN_BARCODE` is not set, the CVSS score is higher (8.8), making the SQLi easier to exploit by unauthenticated users.
*   The vulnerability is fixed in version 2.0.0 of the module.
*   The provided patch shows that the fix includes sanitizing the `idshop` parameter by casting it to an integer (`(int) Tools::getValue('idshop')`) and adding a check for an empty `ec_token`