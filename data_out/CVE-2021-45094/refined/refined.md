Based on the provided content, here's a breakdown of the vulnerability details for CVE-2021-45094:

**Root Cause of Vulnerability:**

*   The vulnerability is due to a lack of proper input sanitization and output encoding in the Imprivata Privileged Access Management (PAM) application. This allowed for the injection of malicious code via stored cross-site scripting (XSS).

**Weaknesses/Vulnerabilities Present:**

*   **Stored Cross-Site Scripting (XSS):** The application failed to sanitize user-provided input and encode it when displayed. This allowed an attacker to inject malicious HTML and JavaScript into various fields, which would then be executed when a victim viewed the affected areas of the application.
    *   Specifically, the application did not sanitize/encode user inputs in two areas:
        *   **Anonymous Links:** Malicious JavaScript could be embedded in links shared with other users.
        *  **Audit Log**: Malicious HTML and JavaScript could be injected via multiple fields such as User Profile’s "Last Name" field and "Name" field of new records in personal vault, which would then be rendered in the Audit Log.

*   **Outdated AngularJS:** The application used an outdated version of AngularJS (1.5.0) that was vulnerable to specific bypass techniques, which were used to circumvent initial attempts at patching the XSS vulnerabilities.

**Impact of Exploitation:**

*   **Privilege Escalation:** An attacker with low-level user access could inject malicious JavaScript to execute in the context of a higher-privileged user (e.g., a System Administrator). This allowed the attacker to escalate their privileges to System Administrator by performing actions on behalf of the victim user such as creating a new admin user.
*   **Denial of Service (DoS):** The bypass payload could trigger numerous `fetch` requests in the victim’s browser, which could lead to browser crashes due to excessive memory usage.

**Attack Vectors:**

*   **Anonymous Links:** An attacker could create an anonymous link containing malicious JavaScript, and then trick a victim user into opening it.
*   **Audit Log:** An attacker could inject malicious JavaScript into user-controllable fields, which would then be executed when an administrator views the audit log.

**Required Attacker Capabilities/Position:**

*   The attacker needs to have an authenticated low-privilege user account in Imprivata PAM.
*   The attacker needs to convince a victim user (with higher privileges) to either:
    *   Open a malicious anonymous link.
    *   View the audit log containing injected malicious code.
*   For bypassing the initial patch, the attacker needs knowledge of Angular JS XSS bypass techniques.

**Additional Details:**
*   The initial fix (version 2.3.202112121126) only partially addressed the issue by blocking `<script>` tags, but failed to encode output. The vulnerability was still exploitable in the Audit Log area by using an Angular JS XSS payload.

This information provides a detailed understanding of the vulnerability, its exploitation, and its potential impact.