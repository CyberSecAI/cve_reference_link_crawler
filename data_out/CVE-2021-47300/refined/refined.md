The provided content is related to CVE-2021-47300.

**Root cause of vulnerability:**
The vulnerability stems from a bug in the program rejection logic within the BPF (Berkeley Packet Filter) subsystem of the Linux kernel. Specifically, when the JIT (Just-In-Time) compilation of a BPF program fails, the program falls back to the interpreter. The issue arises because the `env->prog->aux->tail_call_reachable` flag, which indicates whether tail calls are reachable, is not correctly propagated to the outer environment when a JIT compilation fails. This leads to a faulty rejection of the program when it contains tail calls, causing a use-after-free vulnerability.

**Weaknesses/vulnerabilities present:**
- Incorrect propagation of the `tail_call_reachable` flag from the main program's subprogram (`func[0]`) to the outer environment's program auxiliary structure (`env->prog->aux`).
- Use-after-free vulnerability due to the incorrect program rejection when using tail calls after JIT compilation fails and the program falls back to the interpreter.

**Impact of exploitation:**
- Kernel crash
- Potential for arbitrary code execution, as indicated by the slab-out-of-bounds read detected by KASAN

**Attack vectors:**
- Exploitation requires crafting a malicious BPF program that includes tail calls and fails to compile using JIT.
- The vulnerability is triggered when the JIT compilation of the BPF program fails, causing the program to fall back to the interpreter, and then the incorrect rejection logic is triggered, leading to the use-after-free.

**Required attacker capabilities/position:**
- The attacker needs the ability to load BPF programs into the kernel. This often requires root privileges or specific capabilities.
- The attacker must be able to create a BPF program with tail calls.
- The attacker must cause the JIT compiler to fail, forcing the interpreter to be used to trigger the bug.