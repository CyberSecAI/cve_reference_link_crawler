Based on the provided content, here's a breakdown of the vulnerability:

**CVE ID:** CVE-2024-6706

**Vulnerability Details:**

*   **Affected Vendor:** Open WebUI
*   **Affected Product:** Open WebUI
*   **Affected Version:** 0.1.105
*   **Platform:** Debian 12
*   **CWE Classification:** CWE-79 (Improper Neutralization of Input During Web Page Generation - Cross-site Scripting)

**Root Cause of Vulnerability:**

*   The vulnerability stems from how Open WebUI handles responses from language models, specifically when those responses include markdown code blocks.
*   While most HTML-related characters are sanitized outside of code blocks, characters inside code blocks are not encoded.
*   By crafting specific prompts, attackers can trick language models into generating responses with improperly closed markdown code blocks, leading to unsanitized HTML being rendered. This occurs because the language model "corrects" missing backticks, resulting in some content being wrapped in `<code>` tags and other content rendered directly as HTML.

**Weaknesses/Vulnerabilities Present:**

*   **Stored Cross-Site Scripting (XSS):** The vulnerability allows an attacker to inject arbitrary JavaScript into the web page. This is a stored XSS vulnerability because the malicious code is stored in the chat history and executed when a user views the chat.
*   **Improper Input Handling:** The application fails to properly sanitize or encode user-controlled input (in this case, the language model's response) when rendering it on the page.
*  **Inconsistent Markdown Parsing:** The combination of the markdown parser and the language model's response generation leads to unexpected output where code blocks are not handled as expected.

**Impact of Exploitation:**

*   An attacker can execute arbitrary JavaScript code within the context of the victim's browser when they view a chat containing the malicious prompt.
*   This can lead to various attacks, such as:
    *   Session hijacking (stealing cookies)
    *   Defacement of the web page
    *   Redirection to malicious websites
    *   Performing actions on behalf of the user.

**Attack Vectors:**

*   **Malicious Prompt Injection:** An attacker crafts a specific prompt that causes the language model to output a response with uneven code blocks and malicious HTML content.
*   **Language Model Manipulation:** The attacker leverages the language model's behavior to unintentionally close codeblocks in a way that enables the XSS.

**Required Attacker Capabilities/Position:**

*   The attacker needs to be able to interact with the Open WebUI and send prompts to the language model.
*   The attacker does not necessarily need to be an authenticated user to inject the malicious prompt, they can use a public chat that other users may view.
*   The attacker needs some basic understanding of how markdown and HTML code blocks work.

**More Details than the CVE Description:**

* The advisory provides a detailed technical explanation of the vulnerability, including the specific markdown injection technique and the resulting HTML code.
*  It includes a proof-of-concept (PoC) with exact steps to reproduce the vulnerability
*   The advisory also includes a disclosure timeline, showing the vendor's lack of response.
*  The vulnerability was discovered by Jaggar Henry and Sean Segreti of KoreLogic, Inc.

**Mitigation:**

The advisory mentions that the issue has been silently remediated, however it does not mention how.