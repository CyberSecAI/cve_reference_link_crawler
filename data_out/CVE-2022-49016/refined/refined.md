```
{
  "vulnerability": {
    "root_cause": "Unbalanced refcount of the 'fwnode' in the mdiobus driver.",
    "weaknesses": [
      "Memory leak due to unbalanced of_node_get()/of_node_put() calls.",
      "Improper handling of fwnode reference counting in device registration and release."
    ],
    "impact": "Memory leak, as indicated by the error message 'OF: ERROR: memory leak, expected refcount 1 instead of 2'.",
    "attack_vectors": "The vulnerability is triggered during device (mscc-miim) load test with specific kernel configurations (CONFIG_OF_UNITTEST and CONFIG_OF_DYNAMIC enabled).",
    "required_capabilities": "The attacker would need the ability to load and unload devices, specifically those using the mdiobus driver and triggering the code path with the unbalanced fwnode reference."
  },
  "fixes": [
        "Call fwnode_handle_put() in phy_device_release() to release the reference when the device is freed.",
        "Call fwnode_handle_get() before phy_device_register() to increment the reference count when dealing with acpi nodes."
    ],
  "commits": [
    {
      "commit_id": "2708b357440427d6a9fee667eb7b8307f4625adc",
      "commit_message": "net: mdiobus: fix unbalanced node reference count[ Upstream commit cdde1560118f82498fc9e9a7c1ef7f0ef7755891 ]",
      "files_changed": [
        {
          "file_path": "drivers/net/mdio/fwnode_mdio.c",
          "insertions": 1,
          "deletions": 1
        },
        {
          "file_path": "drivers/net/phy/phy_device.c",
          "insertions": 1,
          "deletions": 0
        }
      ]
    },
   {
      "commit_id": "cdde1560118f82498fc9e9a7c1ef7f0ef7755891",
      "commit_message": "net: mdiobus: fix unbalanced node reference count",
      "files_changed": [
       {
          "file_path": "drivers/net/mdio/fwnode_mdio.c",
          "insertions": 1,
          "deletions": 1
        },
        {
          "file_path": "drivers/net/phy/phy_device.c",
          "insertions": 1,
          "deletions": 0
        }
      ]
    },
    {
      "commit_id": "543d917f691ab06885ee779c862065899eaa4251",
      "commit_message": "net: mdiobus: fix unbalanced node reference count[ Upstream commit cdde1560118f82498fc9e9a7c1ef7f0ef7755891 ]",
      "files_changed": [
        {
          "file_path": "drivers/net/mdio/fwnode_mdio.c",
          "insertions": 1,
          "deletions": 1
        },
        {
          "file_path": "drivers/net/phy/phy_device.c",
          "insertions": 1,
          "deletions": 0
        }
      ]
    }
  ]
}
```