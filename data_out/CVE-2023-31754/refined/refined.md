- **Root cause of vulnerability:** The Optimizely admin panel uses JavaScript to fetch and display content. When a fetch fails (e.g., requested content does not exist), an error message is displayed. The error message is displayed by setting the `innerHTML` attribute of an element with the message content, which is not sanitized, allowing for the injection of arbitrary HTML content.
- **Weaknesses/vulnerabilities present:** DOM-based Cross-site Scripting (XSS). The application directly uses user-controlled input within `innerHTML` without proper sanitization.
- **Impact of exploitation:** An attacker can execute arbitrary JavaScript code in a legitimate user's browser. This can lead to complete compromise of the Optimizely instance, including creating new admin users and gaining full access to the system, as demonstrated by the proof-of-concept exploit.
- **Attack vectors:** The vulnerability is triggered via a crafted URL that includes malicious HTML in the URL fragment.
- **Required attacker capabilities/position:** The attacker needs to trick a user into clicking a malicious link. The user must be logged into the Optimizely system for the attack to work.