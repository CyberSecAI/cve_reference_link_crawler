- **Root cause of vulnerability:** The tagDiv Composer plugin has a REST route that lacks authorization and does not properly validate or escape parameters, specifically the `compiled_css` parameter. This allows for the injection of malicious code into the page's CSS.
- **Weaknesses/vulnerabilities present:**
    - Unauthenticated Stored Cross-Site Scripting (XSS) vulnerability due to the lack of authorization in a REST route.
    - Insufficient input validation and output escaping of the `compiled_css` parameter which results in XSS.
- **Impact of exploitation:** An attacker can inject malicious JavaScript code into the plugin's CSS, which executes when a page is loaded in a user's browser. This can lead to various malicious activities, including but not limited to:
    - Session hijacking
    - Defacement of the website
    - Redirection to malicious websites
    - Execution of arbitrary code in the victim's browser.
- **Attack vectors:**
    - Before version 4.1: An unauthenticated user can send a POST request with the malicious CSS payload to the `/wp-json/tdw/save_css` REST endpoint.
    - Version 4.1: An authenticated admin user can send a POST request using `wp.apiRequest` with the malicious CSS payload to the `tdw/save_css` endpoint within the WordPress admin panel.
- **Required attacker capabilities/position:**
    - Before version 4.1: No authentication is needed. The attacker needs to be able to send a POST request to the vulnerable endpoint
    - Version 4.1: Requires admin level access to WordPress to inject the payload through the WordPress admin panel.