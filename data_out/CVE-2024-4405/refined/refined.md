- **Root cause of vulnerability**: The vulnerability exists because the `manual-upgrade.html` file does not properly sanitize user-supplied data within the `manualUpgradeInfo` parameter.
- **Weaknesses/vulnerabilities present**: Cross-Site Scripting (XSS) vulnerability due to insufficient sanitization of user-supplied input.
- **Impact of exploitation**: An attacker can execute arbitrary code in the context of the current user of the Xiaomi Pro 13 device. This could lead to various malicious actions, including data theft, malware installation, or device compromise.
- **Attack vectors**: The attacker needs to trick the target user into visiting a malicious web page or opening a malicious file that contains the crafted `manualUpgradeInfo` parameter.
- **Required attacker capabilities/position**: The attacker needs to be able to deliver a malicious payload to the target user, which could be done remotely. User interaction is required, specifically visiting a malicious page or opening a malicious file.