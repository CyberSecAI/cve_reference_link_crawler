

  ![](https://px.ads.linkedin.com/collect/?pid=6584308&fmt=gif)

* Platform
  + [Supply Chain Security](https://eclypsium.com/platform/)
  + [Supply Chain Intelligence](https://eclypsium.com/platform/guide/)
* Solutions
  + [Solutions Overview](https://eclypsium.com/solutions/)
  + [Solutions](https://eclypsium.com/solutions/)
  + [Digital Supply Chain
     Security](https://eclypsium.com/solutions/digital-supply-chain-security/)
  + [Firmware Security
     for Enterprises](https://eclypsium.com/solutions/firmware-security-for-enterprises/)
  + [Regulatory Compliance](https://eclypsium.com/compliance/)
  + [Zero Trust
     for Endpoints](https://eclypsium.com/solutions/zero-trust-for-endpoints/)
* Resources
  + - [Resources Overview](https://eclypsium.com/resources/)
    - [Resources](https://eclypsium.com/resources/)
    - [Blog](https://eclypsium.com/blog/)
    - [Demos & Videos](https://eclypsium.com/demos-videos/)
    - [Events & Webinars](https://eclypsium.com/events/)
    - [Podcasts](https://eclypsium.com/podcasts/)
    - [WHITE PAPERS](https://eclypsium.com/resources/whitepapers/)
    - [SOLUTION BRIEFS](https://eclypsium.com/resources/solution-briefs/)
    - [CASE STUDIES](https://eclypsium.com/resources/case-studies/)
    - [THREAT REPORTS](https://eclypsium.com/threat-report/)
  + - [Newsletter](/newsletter)
    - [Support](https://eclypsium.zendesk.com/)
  + - ###### Latest Blogs

      [Blog](https://eclypsium.com/category/blog/), [RESEARCH](https://eclypsium.com/category/research/)
      #### [Genetic Engineering Meets Reverse Engineering: DNA Sequencer's Vulnerable BIOS](https://eclypsium.com/blog/genetic-engineering-meets-reverse-engineering-dna-sequencers-vulnerable-bios/)

      [Learn more](https://eclypsium.com/blog/genetic-engineering-meets-reverse-engineering-dna-sequencers-vulnerable-bios/)

      [Blog](https://eclypsium.com/category/blog/), [RESEARCH](https://eclypsium.com/category/research/)
      #### [BadRAM-ifications: A Low-Cost Attack on Trusted Execution Environments](https://eclypsium.com/blog/amd-badram/)

      [Learn more](https://eclypsium.com/blog/amd-badram/)
* [Research](https://eclypsium.com/research/)
* Company
  + [Company Overview](https://eclypsium.com/company/)
  + [Company](https://eclypsium.com/company/)
  + [Team](https://eclypsium.com/company/team/)
  + [Newsroom](https://eclypsium.com/company/newsroom/)
  + [Careers](https://eclypsium.com/company/careers/)
  + [Partners](https://eclypsium.com/company/partners/)
  + [Contact](https://eclypsium.com/company/contact/)

* [Get a demo](https://eclypsium.com/demo/)
* [Take a Tour](https://eclypsium.com/tour/)

* [Get a demo](https://eclypsium.com/demo/)
* [Take a Tour](https://eclypsium.com/tour/)

* Platform
  + [Supply Chain Security](https://eclypsium.com/platform/)
  + [Supply Chain Intelligence](https://eclypsium.com/platform/guide/)
* Solutions
  + [Solutions Overview](https://eclypsium.com/solutions/)
  + [Solutions](https://eclypsium.com/solutions/)
  + [Digital Supply Chain
     Security](https://eclypsium.com/solutions/digital-supply-chain-security/)
  + [Firmware Security
     for Enterprises](https://eclypsium.com/solutions/firmware-security-for-enterprises/)
  + [Regulatory Compliance](https://eclypsium.com/compliance/)
  + [Zero Trust
     for Endpoints](https://eclypsium.com/solutions/zero-trust-for-endpoints/)
* Resources
  + - [Resources Overview](https://eclypsium.com/resources/)
    - [Resources](https://eclypsium.com/resources/)
    - [Blog](https://eclypsium.com/blog/)
    - [Demos & Videos](https://eclypsium.com/demos-videos/)
    - [Events & Webinars](https://eclypsium.com/events/)
    - [Podcasts](https://eclypsium.com/podcasts/)
    - [WHITE PAPERS](https://eclypsium.com/resources/whitepapers/)
    - [SOLUTION BRIEFS](https://eclypsium.com/resources/solution-briefs/)
    - [CASE STUDIES](https://eclypsium.com/resources/case-studies/)
    - [THREAT REPORTS](https://eclypsium.com/threat-report/)
  + - [Newsletter](/newsletter)
    - [Support](https://eclypsium.zendesk.com/)
  + - ###### Latest Blogs

      [Blog](https://eclypsium.com/category/blog/), [RESEARCH](https://eclypsium.com/category/research/)
      #### [Genetic Engineering Meets Reverse Engineering: DNA Sequencer's Vulnerable BIOS](https://eclypsium.com/blog/genetic-engineering-meets-reverse-engineering-dna-sequencers-vulnerable-bios/)

      [Learn more](https://eclypsium.com/blog/genetic-engineering-meets-reverse-engineering-dna-sequencers-vulnerable-bios/)

      [Blog](https://eclypsium.com/category/blog/), [RESEARCH](https://eclypsium.com/category/research/)
      #### [BadRAM-ifications: A Low-Cost Attack on Trusted Execution Environments](https://eclypsium.com/blog/amd-badram/)

      [Learn more](https://eclypsium.com/blog/amd-badram/)
* [Research](https://eclypsium.com/research/)
* Company
  + [Company Overview](https://eclypsium.com/company/)
  + [Company](https://eclypsium.com/company/)
  + [Team](https://eclypsium.com/company/team/)
  + [Newsroom](https://eclypsium.com/company/newsroom/)
  + [Careers](https://eclypsium.com/company/careers/)
  + [Partners](https://eclypsium.com/company/partners/)
  + [Contact](https://eclypsium.com/company/contact/)

[Blog](https://eclypsium.com/category/blog/)
# Screwed Drivers - Signed, Sealed, Delivered

By:
Eclypsium

August 10, 2019

![Screwed Drivers - Signed, Sealed, Delivered](https://eclypsium.com/wp-content/uploads/Eclypsium-Research-Signed-Sealed-Delivered.jpg)

[Download the PDF >](/wp-content/uploads/Screwed-Drivers.pdf)

## Common Design Flaw In Dozens of Device Drivers Allows Widespread Windows Compromise

*Listen in as Eclypsium researchers Jesse Michael and Mickey Shkatov discuss this research, and subsequent developments in a [recorded webinar](https://www.brighttalk.com/webcast/17865/372680?utm_source=Eclypsium&utm_medium=brighttalk&utm_campaign=372680).*

As part of Eclypsium’s ongoing hardware and firmware security research, we have become increasingly interested in the area of insecure drivers and how they can be abused in an attack against a device. Drivers that provide access to system BIOS or system components for the purposes of updating firmware, running diagnostics, or customizing options on the component can allow attackers to turn the very tools used to manage a system into powerful threats that can escalate privileges and persist invisibly on the host.

Recent research and attacks in the wild have made it clear that this area warrants additional scrutiny. For example, other research has revealed vulnerabilities in individual hardware vendor drivers (e.g. [ASUS](https://web.archive.org/web/20200221021744/https%3A//www.secureauth.com/labs/advisories/asus-drivers-elevation-privilege-vulnerabilities), [ASRock](https://web.archive.org/web/20190507195133/https%3A//www.secureauth.com/labs/advisories/asrock-drivers-elevation-privilege-vulnerabilities), [GIGABYTE](https://web.archive.org/web/20191003011358/https%3A//www.secureauth.com/labs/advisories/gigabyte-drivers-elevation-privilege-vulnerabilities)) that allowed applications with user privileges to read and write with the privileges of kernel. This is obviously a serious escalation of privileges, and we wanted to know if these sorts of vulnerabilities were isolated incidents or examples of a more widespread problem. Secondly, there are multiple examples of attacks in the wild that take advantage of this class of vulnerable drivers. For example, the [Slingshot APT campaign](https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2018/03/09133534/The-Slingshot-APT_report_ENG_final.pdf) installs a kernel rootkit by exploiting drivers with read/write MSR capabilities in order to bypass driver signing enforcement. And the recent [LoJax](https://www.trendmicro.com/vinfo/us/security/news/cyber-attacks/lojax-uefi-rootkit-used-in-cyberespionage) malware abused similar driver functionality to install malicious implants within the firmware of a victim device and persist even across a complete reinstallation of the operating system.

Our analysis found that the problem of insecure drivers is widespread, affecting more than 40 drivers from at least 20 different vendors – including every major BIOS vendor, as well as hardware vendors like ASUS, Toshiba, NVIDIA, and Huawei. However, the widespread nature of these vulnerabilities highlights a more fundamental issue – all the vulnerable drivers we discovered have been certified by Microsoft. Since the presence of a vulnerable driver on a device can provide a user (or attacker) with improperly elevated privileges, we have engaged Microsoft to support solutions to better protect against this class of vulnerabilities, such as blacklisting known bad drivers.

![](https://eclypsium.com/wp-content/uploads/drivers-interlude-1024x101-1.png)
## Overview and Impact of the Vulnerabilities

All these vulnerabilities allow the driver to act as a proxy to perform highly privileged access to the hardware resources, such as read and write access to processor and chipset I/O space, Model Specific Registers (MSR), Control Registers (CR), Debug Registers (DR), physical memory and kernel virtual memory. This is a privilege escalation as it can move an attacker from user mode (Ring 3) to OS kernel mode (Ring 0). The concept of protection rings is summarized in the image below, where each inward ring is granted progressively more privilege. It is important to note that even Administrators operate at Ring 3 (and no deeper), alongside other users. Access to the kernel can not only give an attacker the most privileged access available to the operating system, it can also grant access to the hardware and firmware interfaces with even higher privileges such as the system BIOS firmware.

![](https://eclypsium.com/wp-content/uploads/rings.png)
## How Vulnerabilities Can Be Used In an Attack

A vulnerable driver installed on a machine could allow an application running with user privileges to escalate to kernel privileges and abuse the functionality of the driver. In other words, any malware running in the user space could scan for a vulnerable driver on the victim machine and then use it to gain full control over the system and potentially the underlying firmware. However, if a vulnerable driver is **not** already on a system, administrator privilege would be required to install a vulnerable driver.

As mentioned earlier, a vulnerable driver could also give an attacker access to the “negative” firmware rings that lie beneath the operating system. As seen with the LoJax malware, this allows malware to attack vulnerable system firmware (e.g. UEFI) to maintain persistence on the device, even if the operating system is completely reinstalled. The problem extends to device components, in addition to the system firmware. Some vulnerable drivers interact with graphics cards, network adapters, hard drives, and other devices. Persistent malware inside these devices could read, write, or redirect data stored, displayed or sent over the network. Likewise, any of the components could be disabled as part of a DoS or ransomware attack.

Since many of the drivers themselves are designed to update firmware, the driver is providing not only the necessary privileges, but also the mechanism to make changes.

## Signed and Certified Does Not Mean Safe

It is of particular concern that the drivers in question were not rogue or unsanctioned – in fact, just the opposite. All the drivers come from trusted third-party vendors, signed by valid Certificate Authorities, and certified by Microsoft. Both Microsoft and the third-party vendors will need to be more vigilant with these types of vulnerabilities going forward.

These issues apply to all modern versions of Microsoft Windows and there is currently no universal mechanism to keep a Windows machine from loading one of these known bad drivers. Implementing group policies and other features specific to Windows Pro, Windows Enterprise and Windows Server may offer some protection to a subset of users. Once installed, these drivers can reside on a device for long periods of time unless specifically updated or uninstalled. In addition to the drivers which are already installed on the system, malware can bring any of these drivers along with them to perform privilege escalation and gain direct access to the hardware.

![](https://eclypsium.com/wp-content/uploads/drivers-interlude-1024x101-2.png)
## Impacts and Mitigation

The presence of vulnerable drivers can make it increasingly challenging to secure the firmware attack surface. Vulnerable or outdated system and component firmware is a common problem and a high value target for attackers, who can use it to launch other attacks, completely brick systems, or remain on a device for years gathering data, even after the device is wiped. To make matters worse, in this case, the very drivers and tools that would be used to update the firmware are themselves vulnerable and provide a potential avenue for attack. As a result, organizations should not only continuously scan for outdated firmware, but also update to the latest version of device drivers when fixes become available from device manufacturers.

Organizations may also want to keep their firmware up to date, scan for vulnerabilities, monitor and test the integrity of their firmware to identify unapproved or unexpected changes.

## List of Affected Vendors

* ASRock
* ASUSTeK Computer
* ATI Technologies (AMD)
* Biostar
* EVGA
* Getac
* GIGABYTE
* Huawei
* Insyde
* Intel
* Micro-Star International (MSI)
* NVIDIA
* Phoenix Technologies
* Realtek Semiconductor
* SuperMicro
* Toshiba

Some affected vendors are still under embargo due to their work in highly regulated environments and will take longer to have a fix certified and ready to deploy to customers.

You can read the DEF CON presentation [here](/wp-content/uploads/EXTERNAL-Get-off-the-kernel-if-you-cant-drive-DEFCON27.pdf).

Update: Eclypsium published [additional research](https://eclypsium.com/research/mother-of-all-drivers-new-vulnerabilities-found-in-windows-drivers/) on this topic in November, 2019.

Tag[Drivers](https://eclypsium.com/tag/drivers/), [Research](https://eclypsium.com/tag/research/)
[Back to Blog](/blog)

Related Blogs

[View all](/blog)

 [![](https://eclypsium.com/wp-content/uploads/feature_image_dnasequencer.jpg)](https://eclypsium.com/blog/genetic-engineering-meets-reverse-engineering-dna-sequencers-vulnerable-bios/)

[Blog](https://eclypsium.com/category/blog/), [RESEARCH](https://eclypsium.com/category/research/)
#### [Genetic Engineering Meets Reverse Engineering: DNA Sequencer's Vulnerable BIOS](https://eclypsium.com/blog/genetic-engineering-meets-reverse-engineering-dna-sequencers-vulnerable-bios/)

[Read more](https://eclypsium.com/blog/genetic-engineering-meets-reverse-engineering-dna-sequencers-vulnerable-bios/)

 [![](https://eclypsium.com/wp-content/uploads/feature_image_badram.jpg)](https://eclypsium.com/blog/amd-badram/)

[Blog](https://eclypsium.com/category/blog/), [RESEARCH](https://eclypsium.com/category/research/)
#### [BadRAM-ifications: A Low-Cost Attack on Trusted Execution Environments](https://eclypsium.com/blog/amd-badram/)

[Read more](https://eclypsium.com/blog/amd-badram/)

 [![](https://eclypsium.com/wp-content/uploads/feature_image_typhoonapts.png)](https://eclypsium.com/blog/salt-typhoon/)

[Blog](https://eclypsium.com/category/blog/)
#### [Holding Back Salt Typhoon + Other Chinese APT CVEs](https://eclypsium.com/blog/salt-typhoon/)

[Read more](https://eclypsium.com/blog/salt-typhoon/)

 [![CISA and the FCC have issued new cyber security guidance for telecommunications carriers](https://eclypsium.com/wp-content/uploads/feature_image_cisafcchardening.jpg)](https://eclypsium.com/blog/fcc-cisa-communications-infrastructure-cyber-security/)

[Blog](https://eclypsium.com/category/blog/)
#### [CISA and FCC Issue Urgent Call for Cyber Hardening for Communications Infrastructure](https://eclypsium.com/blog/fcc-cisa-communications-infrastructure-cyber-security/)

[Read more](https://eclypsium.com/blog/fcc-cisa-communications-infrastructure-cyber-security/)

 [![Eclypsium | Supply Chain Security for the Modern Enterprise](https://eclypsium.com/wp-content/themes/eclypsium/assets/img/png/Eclypsium-logo-footer.png)](https://eclypsium.com)
[Get a Demo](https://eclypsium.com/demo/)
[Contact Us](https://eclypsium.com/company/contact/)
###### [Platform](https://eclypsium.com/platform/)

* Title
  + [Supply Chain Security](https://eclypsium.com/platform/)
  + [Supply Chain Intelligence](https://eclypsium.com/platform/guide/)

###### [Research](https://eclypsium.com/research/)

###### [Solutions](https://eclypsium.com/solutions/)

* Title
  + [Digital Supply Chain Security](https://eclypsium.com/solutions/digital-supply-chain-security/)
  + [Firmware Security for Enterprises](https://eclypsium.com/solutions/firmware-security-for-enterprises/)
  + [Simple Solutions for New Regulatory Challenges](https://eclypsium.com/compliance/)
  + [Zero Trust for Endpoints](https://eclypsium.com/solutions/zero-trust-for-endpoints/)
###### [Resources](https://eclypsium.com/resources/)

* [Title](https://eclypsium.com/resources/)
  + [Blog](/blog)
  + [Events](/events)
  + [Podcasts](/podcasts)
  + [White Papers](/whitepapers)
* Title
  + [Solution Briefs](/solution-briefs)
  + [THREAT REPORTS](https://eclypsium.com/category/threat-reports/)
  + [Newsletter](/newsletter)
###### [Company](https://eclypsium.com/company/)

* [Title](https://eclypsium.com/company/)
  + [Team](https://eclypsium.com/company/team/)
  + [Newsroom](https://eclypsium.com/company/newsroom/)
  + [Careers](https://eclypsium.com/company/careers/)
  + [Partners](https://eclypsium.com/company/partners/)
  + [Security](https://eclypsium.com/security/)
  + [Contact](https://eclypsium.com/company/contact/)

* [Linkedin](https://www.linkedin.com/company/eclypsium/ "Linkedin")
* [Youtube](https://www.youtube.com/%40Eclypsium "Youtube")
* [Twitter](https://twitter.com/eclypsium "Twitter")
* [Facebook](https://www.facebook.com/Eclypsium/ "Facebook")
© 2025 Eclypsium, Inc.
###### [Privacy Policy](/privacy-policy) | [Terms of Use](https://eclypsium.com/eula/) | [Sitemap](/sitemap)

![websights](https://ws.zoominfo.com/pixel/62631d72af23a00012552677)

