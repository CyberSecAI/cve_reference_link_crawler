- **Root cause of vulnerability**: The `diag_ping_start` function in `validate.so` uses the user-supplied `ping_ip` parameter in a `sysprintf` call, which executes the command `alias ping='ping -c 3'; eval "<ping_ip>" > /tmp/ping.log 2>&1 &`. The `eval` command executes the content of the `ping_ip` parameter as a shell command. This results in arbitrary command injection as the `ping_ip` parameter is not sanitized.
- **Weaknesses/vulnerabilities present**: Command injection due to improper sanitization of user-supplied input in the `ping_ip` parameter, allowing arbitrary command execution. Improper access control as this code can be reached without authentication.
- **Impact of exploitation**: An attacker can execute arbitrary shell commands on the vulnerable device.
- **Attack vectors**: Sending a specially crafted network request to the device's web server that includes the `change_action=gozila_cgi`, `submit_button=Ping`, `submit_type=start`, and a malicious `ping_ip` parameter, can trigger the command injection.
- **Required attacker capabilities/position**: An attacker needs to be able to send HTTP requests to the device's web server. This would typically require the attacker to be on the same network as the device or be able to reach the device over the internet, if exposed. No authentication is required to exploit the vulnerability.