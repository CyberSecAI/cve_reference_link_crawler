```
{
  "CVE-2023-52889": {
    "Description": "The panic below is observed when receiving ICMP packets with secmark set while an ICMP raw socket is being created. SK_CTX(sk)->label is updated in apparmor_socket_post_create(), but the packet is delivered to the socket before that, causing the null pointer dereference. Drop the packet if label context is not set.",
    "Root cause of vulnerability": "The AppArmor security module attempts to access the socket's security label before it has been initialized during socket creation. Specifically, when receiving an skb (socket buffer) with a secmark set, the `apparmor_socket_sock_rcv_skb` function is called. However, the socket's label context is only updated in `apparmor_socket_post_create()` which is called after packet delivery.",
    "Weaknesses/vulnerabilities": [
      "Race condition between packet reception and socket context setup.",
      "Null pointer dereference due to accessing uninitialized label context."
    ],
    "Impact of exploitation": "A null pointer dereference leads to a kernel panic, causing a denial of service.",
    "Attack vectors": "Sending ICMP packets with a set secmark to a raw socket during its creation.",
     "Required attacker capabilities/position": "An attacker needs the ability to send network packets to a system and trigger socket creation. No specific position or privileges are mentioned beyond that."
  }
}
```