- **Root cause of vulnerability**: A null pointer dereference in the `gsmi_get_variable` function within the Google SMI driver. The vulnerability occurs because the function attempts to dereference the `attr` pointer without checking if it is NULL. This occurs when the `get_variable` function is called with attr=NULL. This was introduced by commit 859748255b43.
- **Weaknesses/vulnerabilities present**: The code directly dereferences the `attr` pointer without verifying if it's NULL.
- **Impact of exploitation**:  A null pointer dereference will lead to a kernel panic, causing a denial of service.
- **Attack vectors**: The vulnerability is triggered when the `gsmi_get_variable` function is called with the `attr` argument set to NULL, which happens when the `efi_pstore` attempts to get EFI variables.
- **Required attacker capabilities/position**: An attacker would require the ability to trigger the `efi_pstore` driver to request an EFI variable, which would in turn call `gsmi_get_variable` with a NULL `attr` pointer. This would likely require some level of control or influence over the system.