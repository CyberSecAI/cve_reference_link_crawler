=== Content from git.kernel.org_3e4f7523_20250111_013333.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=eb0421d90f916dffe96b4c049ddf01c0c50620d2)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=eb0421d90f916dffe96b4c049ddf01c0c50620d2)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=eb0421d90f916dffe96b4c049ddf01c0c50620d2)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=eb0421d90f916dffe96b4c049ddf01c0c50620d2)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Khazhismel Kumykov <khazhy@chromium.org> | 2023-01-17 17:02:12 -0800 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2023-01-24 07:22:47 +0100 |
| commit | [eb0421d90f916dffe96b4c049ddf01c0c50620d2](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=eb0421d90f916dffe96b4c049ddf01c0c50620d2) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=eb0421d90f916dffe96b4c049ddf01c0c50620d2)) | |
| tree | [331c76ee970995223036b9c4c733b486e2192fab](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=eb0421d90f916dffe96b4c049ddf01c0c50620d2) | |
| parent | [b8d99cda526b4066cf817a3d57e69af4e710149d](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=b8d99cda526b4066cf817a3d57e69af4e710149d) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=eb0421d90f916dffe96b4c049ddf01c0c50620d2&id2=b8d99cda526b4066cf817a3d57e69af4e710149d)) | |
| download | [linux-eb0421d90f916dffe96b4c049ddf01c0c50620d2.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-eb0421d90f916dffe96b4c049ddf01c0c50620d2.tar.gz) | |

gsmi: fix null-deref in gsmi\_get\_variablecommit a769b05eeed7accc4019a1ed9799dd72067f1ce8 upstream.
We can get EFI variables without fetching the attribute, so we must
allow for that in gsmi.
commit 859748255b43 ("efi: pstore: Omit efivars caching EFI varstore
access layer") added a new get\_variable call with attr=NULL, which
triggers panic in gsmi.
Fixes: 74c5b31c6618 ("driver: Google EFI SMI")
Cc: stable <stable@kernel.org>
Signed-off-by: Khazhismel Kumykov <khazhy@google.com>
Link: [https://lore.kernel.org/r/20230118010212.1268474-1-khazhy@google.com](https://lore.kernel.org/r/20230118010212.1268474-1-khazhy%40google.com)
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=eb0421d90f916dffe96b4c049ddf01c0c50620d2)

| -rw-r--r-- | [drivers/firmware/google/gsmi.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/firmware/google/gsmi.c?id=eb0421d90f916dffe96b4c049ddf01c0c50620d2) | 7 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 4 insertions, 3 deletions

| diff --git a/drivers/firmware/google/gsmi.c b/drivers/firmware/google/gsmi.cindex 4e2575dfeb908f..871bedf533a805 100644--- a/[drivers/firmware/google/gsmi.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/firmware/google/gsmi.c?id=b8d99cda526b4066cf817a3d57e69af4e710149d)+++ b/[drivers/firmware/google/gsmi.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/firmware/google/gsmi.c?id=eb0421d90f916dffe96b4c049ddf01c0c50620d2)@@ -361,9 +361,10 @@ static efi\_status\_t gsmi\_get\_variable(efi\_char16\_t \*name, memcpy(data, gsmi\_dev.data\_buf->start, \*data\_size);  /\* All variables are have the following attributes \*/- \*attr = EFI\_VARIABLE\_NON\_VOLATILE |- EFI\_VARIABLE\_BOOTSERVICE\_ACCESS |- EFI\_VARIABLE\_RUNTIME\_ACCESS;+ if (attr)+ \*attr = EFI\_VARIABLE\_NON\_VOLATILE |+ EFI\_VARIABLE\_BOOTSERVICE\_ACCESS |+ EFI\_VARIABLE\_RUNTIME\_ACCESS; }  spin\_unlock\_irqrestore(&gsmi\_dev.lock, flags); |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 01:32:10 +0000



=== Content from git.kernel.org_fd04f636_20250111_013330.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=6646d769fdb0ce4318ef9afd127f8526d1ca8393)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=6646d769fdb0ce4318ef9afd127f8526d1ca8393)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=6646d769fdb0ce4318ef9afd127f8526d1ca8393)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=6646d769fdb0ce4318ef9afd127f8526d1ca8393)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Khazhismel Kumykov <khazhy@chromium.org> | 2023-01-17 17:02:12 -0800 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2023-01-24 07:24:39 +0100 |
| commit | [6646d769fdb0ce4318ef9afd127f8526d1ca8393](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=6646d769fdb0ce4318ef9afd127f8526d1ca8393) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=6646d769fdb0ce4318ef9afd127f8526d1ca8393)) | |
| tree | [8ab06e67e8cb72b56617f6092c8493ee5757cea4](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=6646d769fdb0ce4318ef9afd127f8526d1ca8393) | |
| parent | [1c5aaff754f3d916e49ea8d8539642e4771323c4](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=1c5aaff754f3d916e49ea8d8539642e4771323c4) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=6646d769fdb0ce4318ef9afd127f8526d1ca8393&id2=1c5aaff754f3d916e49ea8d8539642e4771323c4)) | |
| download | [linux-6646d769fdb0ce4318ef9afd127f8526d1ca8393.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-6646d769fdb0ce4318ef9afd127f8526d1ca8393.tar.gz) | |

gsmi: fix null-deref in gsmi\_get\_variablecommit a769b05eeed7accc4019a1ed9799dd72067f1ce8 upstream.
We can get EFI variables without fetching the attribute, so we must
allow for that in gsmi.
commit 859748255b43 ("efi: pstore: Omit efivars caching EFI varstore
access layer") added a new get\_variable call with attr=NULL, which
triggers panic in gsmi.
Fixes: 74c5b31c6618 ("driver: Google EFI SMI")
Cc: stable <stable@kernel.org>
Signed-off-by: Khazhismel Kumykov <khazhy@google.com>
Link: [https://lore.kernel.org/r/20230118010212.1268474-1-khazhy@google.com](https://lore.kernel.org/r/20230118010212.1268474-1-khazhy%40google.com)
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=6646d769fdb0ce4318ef9afd127f8526d1ca8393)

| -rw-r--r-- | [drivers/firmware/google/gsmi.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/firmware/google/gsmi.c?id=6646d769fdb0ce4318ef9afd127f8526d1ca8393) | 7 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 4 insertions, 3 deletions

| diff --git a/drivers/firmware/google/gsmi.c b/drivers/firmware/google/gsmi.cindex 4e2575dfeb908f..871bedf533a805 100644--- a/[drivers/firmware/google/gsmi.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/firmware/google/gsmi.c?id=1c5aaff754f3d916e49ea8d8539642e4771323c4)+++ b/[drivers/firmware/google/gsmi.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/firmware/google/gsmi.c?id=6646d769fdb0ce4318ef9afd127f8526d1ca8393)@@ -361,9 +361,10 @@ static efi\_status\_t gsmi\_get\_variable(efi\_char16\_t \*name, memcpy(data, gsmi\_dev.data\_buf->start, \*data\_size);  /\* All variables are have the following attributes \*/- \*attr = EFI\_VARIABLE\_NON\_VOLATILE |- EFI\_VARIABLE\_BOOTSERVICE\_ACCESS |- EFI\_VARIABLE\_RUNTIME\_ACCESS;+ if (attr)+ \*attr = EFI\_VARIABLE\_NON\_VOLATILE |+ EFI\_VARIABLE\_BOOTSERVICE\_ACCESS |+ EFI\_VARIABLE\_RUNTIME\_ACCESS; }  spin\_unlock\_irqrestore(&gsmi\_dev.lock, flags); |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 01:32:07 +0000



=== Content from git.kernel.org_84c22f86_20250111_013332.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=ae2a9dcc8caa60b1e14671294e5ec902ea5d1dfd)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=ae2a9dcc8caa60b1e14671294e5ec902ea5d1dfd)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=ae2a9dcc8caa60b1e14671294e5ec902ea5d1dfd)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=ae2a9dcc8caa60b1e14671294e5ec902ea5d1dfd)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Khazhismel Kumykov <khazhy@chromium.org> | 2023-01-17 17:02:12 -0800 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2023-01-24 07:20:00 +0100 |
| commit | [ae2a9dcc8caa60b1e14671294e5ec902ea5d1dfd](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=ae2a9dcc8caa60b1e14671294e5ec902ea5d1dfd) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=ae2a9dcc8caa60b1e14671294e5ec902ea5d1dfd)) | |
| tree | [08ec890ad95aa517588a3bea75013853e86e1429](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=ae2a9dcc8caa60b1e14671294e5ec902ea5d1dfd) | |
| parent | [a75e80d11826ad02ec153cff97d64033fd99623d](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=a75e80d11826ad02ec153cff97d64033fd99623d) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=ae2a9dcc8caa60b1e14671294e5ec902ea5d1dfd&id2=a75e80d11826ad02ec153cff97d64033fd99623d)) | |
| download | [linux-ae2a9dcc8caa60b1e14671294e5ec902ea5d1dfd.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-ae2a9dcc8caa60b1e14671294e5ec902ea5d1dfd.tar.gz) | |

gsmi: fix null-deref in gsmi\_get\_variablecommit a769b05eeed7accc4019a1ed9799dd72067f1ce8 upstream.
We can get EFI variables without fetching the attribute, so we must
allow for that in gsmi.
commit 859748255b43 ("efi: pstore: Omit efivars caching EFI varstore
access layer") added a new get\_variable call with attr=NULL, which
triggers panic in gsmi.
Fixes: 74c5b31c6618 ("driver: Google EFI SMI")
Cc: stable <stable@kernel.org>
Signed-off-by: Khazhismel Kumykov <khazhy@google.com>
Link: [https://lore.kernel.org/r/20230118010212.1268474-1-khazhy@google.com](https://lore.kernel.org/r/20230118010212.1268474-1-khazhy%40google.com)
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=ae2a9dcc8caa60b1e14671294e5ec902ea5d1dfd)

| -rw-r--r-- | [drivers/firmware/google/gsmi.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/firmware/google/gsmi.c?id=ae2a9dcc8caa60b1e14671294e5ec902ea5d1dfd) | 7 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 4 insertions, 3 deletions

| diff --git a/drivers/firmware/google/gsmi.c b/drivers/firmware/google/gsmi.cindex c1cd5ca875caae..407cac71c77de9 100644--- a/[drivers/firmware/google/gsmi.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/firmware/google/gsmi.c?id=a75e80d11826ad02ec153cff97d64033fd99623d)+++ b/[drivers/firmware/google/gsmi.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/firmware/google/gsmi.c?id=ae2a9dcc8caa60b1e14671294e5ec902ea5d1dfd)@@ -360,9 +360,10 @@ static efi\_status\_t gsmi\_get\_variable(efi\_char16\_t \*name, memcpy(data, gsmi\_dev.data\_buf->start, \*data\_size);  /\* All variables are have the following attributes \*/- \*attr = EFI\_VARIABLE\_NON\_VOLATILE |- EFI\_VARIABLE\_BOOTSERVICE\_ACCESS |- EFI\_VARIABLE\_RUNTIME\_ACCESS;+ if (attr)+ \*attr = EFI\_VARIABLE\_NON\_VOLATILE |+ EFI\_VARIABLE\_BOOTSERVICE\_ACCESS |+ EFI\_VARIABLE\_RUNTIME\_ACCESS; }  spin\_unlock\_irqrestore(&gsmi\_dev.lock, flags); |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 01:32:09 +0000



=== Content from git.kernel.org_bed831ec_20250111_013329.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=32313c11bdc8a02c577abaf865be3664ab30410a)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=32313c11bdc8a02c577abaf865be3664ab30410a)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=32313c11bdc8a02c577abaf865be3664ab30410a)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=32313c11bdc8a02c577abaf865be3664ab30410a)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Khazhismel Kumykov <khazhy@chromium.org> | 2023-01-17 17:02:12 -0800 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2023-01-24 07:11:50 +0100 |
| commit | [32313c11bdc8a02c577abaf865be3664ab30410a](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=32313c11bdc8a02c577abaf865be3664ab30410a) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=32313c11bdc8a02c577abaf865be3664ab30410a)) | |
| tree | [3d8e5c6df6bfb0472608daf4b8203729ae9aecd5](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=32313c11bdc8a02c577abaf865be3664ab30410a) | |
| parent | [8ee291ae493d607be269fb76d2bab5ad39c039f7](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=8ee291ae493d607be269fb76d2bab5ad39c039f7) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=32313c11bdc8a02c577abaf865be3664ab30410a&id2=8ee291ae493d607be269fb76d2bab5ad39c039f7)) | |
| download | [linux-32313c11bdc8a02c577abaf865be3664ab30410a.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-32313c11bdc8a02c577abaf865be3664ab30410a.tar.gz) | |

gsmi: fix null-deref in gsmi\_get\_variablecommit a769b05eeed7accc4019a1ed9799dd72067f1ce8 upstream.
We can get EFI variables without fetching the attribute, so we must
allow for that in gsmi.
commit 859748255b43 ("efi: pstore: Omit efivars caching EFI varstore
access layer") added a new get\_variable call with attr=NULL, which
triggers panic in gsmi.
Fixes: 74c5b31c6618 ("driver: Google EFI SMI")
Cc: stable <stable@kernel.org>
Signed-off-by: Khazhismel Kumykov <khazhy@google.com>
Link: [https://lore.kernel.org/r/20230118010212.1268474-1-khazhy@google.com](https://lore.kernel.org/r/20230118010212.1268474-1-khazhy%40google.com)
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=32313c11bdc8a02c577abaf865be3664ab30410a)

| -rw-r--r-- | [drivers/firmware/google/gsmi.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/firmware/google/gsmi.c?id=32313c11bdc8a02c577abaf865be3664ab30410a) | 7 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 4 insertions, 3 deletions

| diff --git a/drivers/firmware/google/gsmi.c b/drivers/firmware/google/gsmi.cindex 2e3ef0eb6e8214..e50dd4030d908a 100644--- a/[drivers/firmware/google/gsmi.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/firmware/google/gsmi.c?id=8ee291ae493d607be269fb76d2bab5ad39c039f7)+++ b/[drivers/firmware/google/gsmi.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/firmware/google/gsmi.c?id=32313c11bdc8a02c577abaf865be3664ab30410a)@@ -343,9 +343,10 @@ static efi\_status\_t gsmi\_get\_variable(efi\_char16\_t \*name, memcpy(data, gsmi\_dev.data\_buf->start, \*data\_size);  /\* All variables are have the following attributes \*/- \*attr = EFI\_VARIABLE\_NON\_VOLATILE |- EFI\_VARIABLE\_BOOTSERVICE\_ACCESS |- EFI\_VARIABLE\_RUNTIME\_ACCESS;+ if (attr)+ \*attr = EFI\_VARIABLE\_NON\_VOLATILE |+ EFI\_VARIABLE\_BOOTSERVICE\_ACCESS |+ EFI\_VARIABLE\_RUNTIME\_ACCESS; }  spin\_unlock\_irqrestore(&gsmi\_dev.lock, flags); |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 01:32:06 +0000



=== Content from git.kernel.org_6a6b3f14_20250111_013331.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=a769b05eeed7accc4019a1ed9799dd72067f1ce8)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=a769b05eeed7accc4019a1ed9799dd72067f1ce8)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=a769b05eeed7accc4019a1ed9799dd72067f1ce8)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=a769b05eeed7accc4019a1ed9799dd72067f1ce8)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Khazhismel Kumykov <khazhy@chromium.org> | 2023-01-17 17:02:12 -0800 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2023-01-20 13:23:42 +0100 |
| commit | [a769b05eeed7accc4019a1ed9799dd72067f1ce8](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=a769b05eeed7accc4019a1ed9799dd72067f1ce8) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=a769b05eeed7accc4019a1ed9799dd72067f1ce8)) | |
| tree | [39d16a4e0eb076c77f63f7e778ceed3e9d55cb20](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=a769b05eeed7accc4019a1ed9799dd72067f1ce8) | |
| parent | [96b328d119eca7563c1edcc4e1039a62e6370ecb](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=96b328d119eca7563c1edcc4e1039a62e6370ecb) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=a769b05eeed7accc4019a1ed9799dd72067f1ce8&id2=96b328d119eca7563c1edcc4e1039a62e6370ecb)) | |
| download | [linux-a769b05eeed7accc4019a1ed9799dd72067f1ce8.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-a769b05eeed7accc4019a1ed9799dd72067f1ce8.tar.gz) | |

gsmi: fix null-deref in gsmi\_get\_variableWe can get EFI variables without fetching the attribute, so we must
allow for that in gsmi.
commit 859748255b43 ("efi: pstore: Omit efivars caching EFI varstore
access layer") added a new get\_variable call with attr=NULL, which
triggers panic in gsmi.
Fixes: 74c5b31c6618 ("driver: Google EFI SMI")
Cc: stable <stable@kernel.org>
Signed-off-by: Khazhismel Kumykov <khazhy@google.com>
Link: [https://lore.kernel.org/r/20230118010212.1268474-1-khazhy@google.com](https://lore.kernel.org/r/20230118010212.1268474-1-khazhy%40google.com)
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=a769b05eeed7accc4019a1ed9799dd72067f1ce8)

| -rw-r--r-- | [drivers/firmware/google/gsmi.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/firmware/google/gsmi.c?id=a769b05eeed7accc4019a1ed9799dd72067f1ce8) | 7 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 4 insertions, 3 deletions

| diff --git a/drivers/firmware/google/gsmi.c b/drivers/firmware/google/gsmi.cindex 4e2575dfeb908f..871bedf533a805 100644--- a/[drivers/firmware/google/gsmi.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/firmware/google/gsmi.c?id=96b328d119eca7563c1edcc4e1039a62e6370ecb)+++ b/[drivers/firmware/google/gsmi.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/firmware/google/gsmi.c?id=a769b05eeed7accc4019a1ed9799dd72067f1ce8)@@ -361,9 +361,10 @@ static efi\_status\_t gsmi\_get\_variable(efi\_char16\_t \*name, memcpy(data, gsmi\_dev.data\_buf->start, \*data\_size);  /\* All variables are have the following attributes \*/- \*attr = EFI\_VARIABLE\_NON\_VOLATILE |- EFI\_VARIABLE\_BOOTSERVICE\_ACCESS |- EFI\_VARIABLE\_RUNTIME\_ACCESS;+ if (attr)+ \*attr = EFI\_VARIABLE\_NON\_VOLATILE |+ EFI\_VARIABLE\_BOOTSERVICE\_ACCESS |+ EFI\_VARIABLE\_RUNTIME\_ACCESS; }  spin\_unlock\_irqrestore(&gsmi\_dev.lock, flags); |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 01:32:08 +0000



=== Content from git.kernel.org_cb6f0b31_20250111_013335.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=ffef77794fb5f1245c3249b86342bad2299accb5)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=ffef77794fb5f1245c3249b86342bad2299accb5)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=ffef77794fb5f1245c3249b86342bad2299accb5)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=ffef77794fb5f1245c3249b86342bad2299accb5)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Khazhismel Kumykov <khazhy@chromium.org> | 2023-01-17 17:02:12 -0800 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2023-01-24 07:18:01 +0100 |
| commit | [ffef77794fb5f1245c3249b86342bad2299accb5](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=ffef77794fb5f1245c3249b86342bad2299accb5) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=ffef77794fb5f1245c3249b86342bad2299accb5)) | |
| tree | [38de6e5199258fee7c1fe2c886ff4219955778b5](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=ffef77794fb5f1245c3249b86342bad2299accb5) | |
| parent | [b4461af0a5e69eb9de806049065e97842522d822](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=b4461af0a5e69eb9de806049065e97842522d822) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=ffef77794fb5f1245c3249b86342bad2299accb5&id2=b4461af0a5e69eb9de806049065e97842522d822)) | |
| download | [linux-ffef77794fb5f1245c3249b86342bad2299accb5.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-ffef77794fb5f1245c3249b86342bad2299accb5.tar.gz) | |

gsmi: fix null-deref in gsmi\_get\_variablecommit a769b05eeed7accc4019a1ed9799dd72067f1ce8 upstream.
We can get EFI variables without fetching the attribute, so we must
allow for that in gsmi.
commit 859748255b43 ("efi: pstore: Omit efivars caching EFI varstore
access layer") added a new get\_variable call with attr=NULL, which
triggers panic in gsmi.
Fixes: 74c5b31c6618 ("driver: Google EFI SMI")
Cc: stable <stable@kernel.org>
Signed-off-by: Khazhismel Kumykov <khazhy@google.com>
Link: [https://lore.kernel.org/r/20230118010212.1268474-1-khazhy@google.com](https://lore.kernel.org/r/20230118010212.1268474-1-khazhy%40google.com)
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=ffef77794fb5f1245c3249b86342bad2299accb5)

| -rw-r--r-- | [drivers/firmware/google/gsmi.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/firmware/google/gsmi.c?id=ffef77794fb5f1245c3249b86342bad2299accb5) | 7 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 4 insertions, 3 deletions

| diff --git a/drivers/firmware/google/gsmi.c b/drivers/firmware/google/gsmi.cindex 517fb57d07d2e8..94753ad18ca63e 100644--- a/[drivers/firmware/google/gsmi.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/firmware/google/gsmi.c?id=b4461af0a5e69eb9de806049065e97842522d822)+++ b/[drivers/firmware/google/gsmi.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/firmware/google/gsmi.c?id=ffef77794fb5f1245c3249b86342bad2299accb5)@@ -359,9 +359,10 @@ static efi\_status\_t gsmi\_get\_variable(efi\_char16\_t \*name, memcpy(data, gsmi\_dev.data\_buf->start, \*data\_size);  /\* All variables are have the following attributes \*/- \*attr = EFI\_VARIABLE\_NON\_VOLATILE |- EFI\_VARIABLE\_BOOTSERVICE\_ACCESS |- EFI\_VARIABLE\_RUNTIME\_ACCESS;+ if (attr)+ \*attr = EFI\_VARIABLE\_NON\_VOLATILE |+ EFI\_VARIABLE\_BOOTSERVICE\_ACCESS |+ EFI\_VARIABLE\_RUNTIME\_ACCESS; }  spin\_unlock\_irqrestore(&gsmi\_dev.lock, flags); |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 01:32:12 +0000



=== Content from git.kernel.org_75cb9790_20250111_013334.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=ee5763ef829bd923033510de6d1df7c73f085e4b)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=ee5763ef829bd923033510de6d1df7c73f085e4b)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=ee5763ef829bd923033510de6d1df7c73f085e4b)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=ee5763ef829bd923033510de6d1df7c73f085e4b)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Khazhismel Kumykov <khazhy@chromium.org> | 2023-01-17 17:02:12 -0800 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2023-01-24 07:05:19 +0100 |
| commit | [ee5763ef829bd923033510de6d1df7c73f085e4b](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=ee5763ef829bd923033510de6d1df7c73f085e4b) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=ee5763ef829bd923033510de6d1df7c73f085e4b)) | |
| tree | [3733fd3f0e82406492e26a31d325065db74dfda2](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=ee5763ef829bd923033510de6d1df7c73f085e4b) | |
| parent | [31fa3c5ca009c1cafbbd211d4b482e6dfcaae317](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=31fa3c5ca009c1cafbbd211d4b482e6dfcaae317) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=ee5763ef829bd923033510de6d1df7c73f085e4b&id2=31fa3c5ca009c1cafbbd211d4b482e6dfcaae317)) | |
| download | [linux-ee5763ef829bd923033510de6d1df7c73f085e4b.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-ee5763ef829bd923033510de6d1df7c73f085e4b.tar.gz) | |

gsmi: fix null-deref in gsmi\_get\_variablecommit a769b05eeed7accc4019a1ed9799dd72067f1ce8 upstream.
We can get EFI variables without fetching the attribute, so we must
allow for that in gsmi.
commit 859748255b43 ("efi: pstore: Omit efivars caching EFI varstore
access layer") added a new get\_variable call with attr=NULL, which
triggers panic in gsmi.
Fixes: 74c5b31c6618 ("driver: Google EFI SMI")
Cc: stable <stable@kernel.org>
Signed-off-by: Khazhismel Kumykov <khazhy@google.com>
Link: [https://lore.kernel.org/r/20230118010212.1268474-1-khazhy@google.com](https://lore.kernel.org/r/20230118010212.1268474-1-khazhy%40google.com)
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=ee5763ef829bd923033510de6d1df7c73f085e4b)

| -rw-r--r-- | [drivers/firmware/google/gsmi.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/firmware/google/gsmi.c?id=ee5763ef829bd923033510de6d1df7c73f085e4b) | 7 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 4 insertions, 3 deletions

| diff --git a/drivers/firmware/google/gsmi.c b/drivers/firmware/google/gsmi.cindex 2e3ef0eb6e8214..e50dd4030d908a 100644--- a/[drivers/firmware/google/gsmi.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/firmware/google/gsmi.c?id=31fa3c5ca009c1cafbbd211d4b482e6dfcaae317)+++ b/[drivers/firmware/google/gsmi.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/firmware/google/gsmi.c?id=ee5763ef829bd923033510de6d1df7c73f085e4b)@@ -343,9 +343,10 @@ static efi\_status\_t gsmi\_get\_variable(efi\_char16\_t \*name, memcpy(data, gsmi\_dev.data\_buf->start, \*data\_size);  /\* All variables are have the following attributes \*/- \*attr = EFI\_VARIABLE\_NON\_VOLATILE |- EFI\_VARIABLE\_BOOTSERVICE\_ACCESS |- EFI\_VARIABLE\_RUNTIME\_ACCESS;+ if (attr)+ \*attr = EFI\_VARIABLE\_NON\_VOLATILE |+ EFI\_VARIABLE\_BOOTSERVICE\_ACCESS |+ EFI\_VARIABLE\_RUNTIME\_ACCESS; }  spin\_unlock\_irqrestore(&gsmi\_dev.lock, flags); |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 01:32:11 +0000


