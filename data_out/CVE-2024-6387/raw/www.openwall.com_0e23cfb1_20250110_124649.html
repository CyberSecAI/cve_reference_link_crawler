<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>oss-security - Re: CVE-2024-6387: RCE in OpenSSH's server, on glibc-based Linux systems</title>

<link href="/style.css" type="text/css" rel="stylesheet">
<style type="text/css">
.calendar { text-align: center; }
.ccell { background: #ccc; width: 5ex; padding: 2px; }

.cal_brief { text-align: center; }
.cal_brief td:first-child { background: inherit; }
.cal_brief td { background: #ccc; width: 5ex; padding: 2px; }
.cal_big { text-align: center; padding: 0; margin: 0; }
.cal_big td { padding: 0 2px; }
.cal_mon { text-align: center; }
.cal_mon th { font-size: small; padding: 0; margin: 0; }
.cal_mon td { background: #ccc; width: 5ex; height: 1.5em;
	padding: 2px; text-align: right; }
.cal_mon td[colspan] { background: inherit; }
.cal_mon sup { color: #F0F0F0; text-align: left; float: left;
	margin-top: -2pt; font-weight: bold; }
.cal_mon a { text-align: right; margin-left: -4em; float: right; }
</style>
</head>

<BODY bgcolor="#E0E0E0" text="black" link="blue" alink="red" vlink="navy">


<table bgcolor="#ffffff" width="100%" border="0" cellspacing="0" cellpadding="0">
<tr>

<td>
<a href="/"><img class="logo" src="/logo.png" border="0" width="182" height="80" alt="Openwall"></a>
<td width="100%">
<div class="nav">
<ul>
<li><a href="/">Products</a>
<ul>
<li><a href="/Owl/">Openwall GNU/*/Linux &nbsp; <i>server OS</i></a>
<li><a href="/lkrg/">Linux Kernel Runtime Guard</a>
<li><a href="/john/">John the Ripper &nbsp; <i>password cracker</i></a>
<ul>
<li><a href="/john/">Free &amp; Open Source for any platform</a>
<li><a href="/john/cloud/">in the cloud</a>
<li><a href="/john/pro/linux/">Pro for Linux</a>
<li><a href="/john/pro/macosx/">Pro for macOS</a>
</ul>
<li><a href="/wordlists/">Wordlists &nbsp; <i>for password cracking</i></a>
<li><a href="/passwdqc/">passwdqc &nbsp; <i>policy enforcement</i></a>
<ul>
<li><a href="/passwdqc/">Free &amp; Open Source for Unix</a>
<li><a href="/passwdqc/windows/">Pro for Windows (Active Directory)</a>
</ul>
<li><a href="/yescrypt/">yescrypt &nbsp; <i>KDF &amp; password hashing</i></a>
<li><a href="/yespower/">yespower &nbsp; <i>Proof-of-Work (PoW)</i></a>
<li><a href="/crypt/">crypt_blowfish &nbsp; <i>password hashing</i></a>
<li><a href="/phpass/">phpass &nbsp; <i>ditto in PHP</i></a>
<li><a href="/tcb/">tcb &nbsp; <i>better password shadowing</i></a>
<li><a href="/pam/">Pluggable Authentication Modules</a>
<li><a href="/scanlogd/">scanlogd &nbsp; <i>port scan detector</i></a>
<li><a href="/popa3d/">popa3d &nbsp; <i>tiny POP3 daemon</i></a>
<li><a href="/blists/">blists &nbsp; <i>web interface to mailing lists</i></a>
<li><a href="/msulogin/">msulogin &nbsp; <i>single user mode login</i></a>
<li><a href="/php_mt_seed/">php_mt_seed &nbsp; <i>mt_rand() cracker</i></a>
</ul>
<li><a href="/services/">Services</a>
<li id="narrow-li-1"><a>Publications</a>
<ul>
<li><a href="/articles/">Articles</a>
<li><a href="/presentations/">Presentations</a>
</ul>
<li><a>Resources</a>
<ul>
<li><a href="/lists/">Mailing lists</a>
<li><a href="https://openwall.info/wiki/">Community wiki</a>
<li><a href="https://github.com/openwall">Source code repositories (GitHub)</a>
<li><a href="https://cvsweb.openwall.com">Source code repositories (CVSweb)</a>
<li><a href="/mirrors/">File archive &amp; mirrors</a>
<li><a href="/signatures/">How to verify digital signatures</a>
<li><a href="/ove/">OVE IDs</a>
</ul>
<li id="last-li"><a href="/news">What's new</a>
</ul>
</div>


</table>


<TABLE bgcolor="#B4D0DC" width="100%" border="0" cellspacing="0" cellpadding="1">
<TR><TD>
<TABLE width="100%" border="0" cellspacing="0" cellpadding="2">
<TR><TD bgcolor="#ECF8FF">
<a href="https://hashsuite.openwall.net">
Hash Suite - Windows password security audit tool. GUI, reports in PDF.</a>

</TABLE>
</TABLE>

<a href="4">[&lt;prev]</a> <a href="../../../2024/07/10/1">[next&gt;]</a> <a href="2">[&lt;thread-prev]</a> <a href="../../../2024/07/10/1">[thread-next&gt;]</a> <a href=".">[day]</a> <a href="..">[month]</a> <a href="../..">[year]</a> <a href="../../..">[list]</a>
<pre style="white-space: pre-wrap">
Message-ID: &lt;20240709224923.GA17147&#64;openwall.com&gt;
Date: Wed, 10 Jul 2024 00:49:23 +0200
From: Solar Designer &lt;solar&#64;...nwall.com&gt;
To: oss-security&#64;...ts.openwall.com
Cc: Qualys Security Advisory &lt;qsa&#64;...lys.com&gt;
Subject: Re: CVE-2024-6387: RCE in OpenSSH's server, on glibc-based Linux systems

On Tue, Jul 09, 2024 at 09:52:58AM +1000, Damien Miller wrote:
&gt; On Mon, 8 Jul 2024, Solar Designer wrote:
&gt; &gt; Today is the coordinated release date to publicly disclose a related
&gt; &gt; issue I found during review of Qualys' findings, with further analysis
&gt; &gt; by Qualys.  My summary is:
&gt; &gt; 
&gt; &gt; CVE-2024-6409: OpenSSH: Possible remote code execution in privsep child
&gt; &gt; due to a race condition in signal handling
&gt; 
&gt; As an aside, who wrote the text of
&gt; <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-6409" rel="nofollow">https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-6409</a> ?

I don't know for sure, but I guess someone from Red Hat did since the
CVE was assigned by them as a CNA.  Also, the description is the same as
what's in Red Hat Bugzilla.

&gt; It's disappointing that this CVE states that this is a vulnerability
&gt; in OpenSSH sshd, and fails to make clear that this only affects Redhat
&gt; versions and users of their downstream patch.

This was in the title, just not in the description.  And now I see I did
it the other way around in my oss-security posting - should have been
more careful to include this information in both the suggested title and
in the description - sorry about that.  Meanwhile, looks like the
CVE-2024-6409 record has been updated today, perhaps in response to your
message, and now says Red Hat Enterprise Linux 9 also in the description.

&gt; This follows another critical failure to properly issue CVEs for OpenSSH:
&gt; CVE-2024-6387 only lists CPEs for Redhat systems as affected (see the
&gt; JSON dump of the entry: <a href="https://cveawg.mitre.org/api/cve/CVE-2024-6387" rel="nofollow">https://cveawg.mitre.org/api/cve/CVE-2024-6387</a> )

The current revision (also updated today) starts with:

      "affected": [
        {
          "repo": "<a href="https://anongit.mindrot.org/openssh.git" rel="nofollow">https://anongit.mindrot.org/openssh.git</a>",
          "versions": [
            {
              "status": "affected",
              "version": "8.5p1",
              "versionType": "custom",
              "lessThanOrEqual": "9.7p1"
            }
          ],
          "packageName": "OpenSSH",
          "collectionURL": "<a href="https://www.openssh.com/" rel="nofollow">https://www.openssh.com/</a>",
          "defaultStatus": "unaffected"
        },

and only then proceeds to give CPEs for Red Hat products.

&gt; This means that anyone using automation that consumes CVEs for detecting
&gt; vulnerabilities will be left exposed.

Does the above look good enough now, or should there also be a CPE for
upstream OpenSSH?

&gt; Moreover, the explanatory text for CVE-2024-6387 is also extremely lacking.
&gt; It fails to explain the consequence of the vulnerability (unauth RCE) and
&gt; just talks about mechanism.

This is still the case, and this CVE was also assigned by Red Hat (in
response to requests by Qualys and me in the distros list discussion),
and the description is also the same as in Red Hat Bugzilla, so should
probably be first improved in a database Red Hat uses internally.

&gt; I don't know if it's in anyone on this list's ability to get these
&gt; fixed, but IMO they are serious failures of the CVE process that make
&gt; it near-useless for consumers of this information.

Apparently, someone in here noticed and started making edits.

Alexander
</pre>
<p><a href="https://www.openwall.com/blists/">Powered by blists</a> - <a href="https://lists.openwall.net">more mailing lists</a>


<p>
Please check out the
<a href="https://oss-security.openwall.org/wiki/">
Open Source Software Security Wiki</a>, which is counterpart to this
<a href="https://oss-security.openwall.org/wiki/mailing-lists/oss-security">mailing list</a>.
<p>
Confused about <a href="/lists/">mailing lists</a> and their use?
<a href="https://en.wikipedia.org/wiki/Electronic_mailing_list">Read about mailing lists on Wikipedia</a>
and check out these
<a href="https://www.complang.tuwien.ac.at/anton/mail-news-errors.html">guidelines on proper formatting of your messages</a>.
<p>

</body>
</html>
