The provided content contains information about CVE-2022-29778.

**Root cause of vulnerability:**
The vulnerability lies in the `getWOLMAC` function within `SetVirtualServerSettings.php`. This function directly concatenates the `$ipv4addr` variable into a command executed by `scut` without any filtering or sanitization. The `$ipv4addr` is obtained from user-controlled input.

**Weaknesses/vulnerabilities present:**
- Command Injection: Due to the lack of input validation, an attacker can inject arbitrary shell commands by manipulating the `$ipv4addr` variable.

**Impact of exploitation:**
- Remote Command Execution (RCE): Successful exploitation allows an attacker to execute arbitrary commands on the router's operating system. This could lead to complete compromise of the device. The attacker could potentially access sensitive information (e.g. `/etc/shadow`), modify device settings, or use the device as a botnet node.

**Attack vectors:**
- HTTP POST request to `/HNAP1/` with `SOAPACTION: "http://purenetworks.com/HNAP1/SetVirtualServerSettings"`
- The attacker must send a crafted XML payload within the POST request to the web interface to configure a new virtual server with description set to "Wake-On-Lan" and inject commands through `LocalIPAddress`.

**Required attacker capabilities/position:**
- The attacker needs to be authenticated to the web interface of the router.
- The attacker must be able to send HTTP POST requests to the router's web interface (e.g. same network or through a compromised computer within the network).
-  The attacker must know the router's IP address and have valid login credentials.