```
{
  "vulnerability": {
    "root_cause": "The API for matching Subject Alternative Names (SAN) in X.509 certificates did not consider the SAN type. It would match a DNS hostname in an rfc822Name SAN or an email address in a uniformResourceIndicator SAN.",
    "weaknesses": [
      "Improper validation of X.509 certificate SAN fields.",
       "Bypassing of configured constraints such as nameConstraints due to malformed certificates."
    ],
    "impact": "Allows for man-in-the-middle attacks. By issuing a malformed certificate (e.g., encoding a DNS hostname in an rfc822Name SAN), a malicious CA can have their certificate accepted as valid for a host. This can bypass configured constraints (like nameConstraints).",
    "attack_vectors": "Network-based attacks where an attacker can present a malformed certificate issued by a malicious CA.",
     "required_capabilities": "The attacker requires a malicious CA capable of issuing malformed certificates. The attacker also needs to be in a position to perform a man-in-the-middle attack (e.g., intercepting network traffic)."
  },
  "patch": {
    "description": "The patch introduces the ability to specify the type of SAN along with the value to match against. The deprecated `match_subject_alt_names` is replaced with `match_typed_subject_alt_names`. The patch also includes changes to the code to properly handle the SAN type and related documentation.",
    "changes": [
      "Added a new `SubjectAltNameMatcher` message to `api/envoy/extensions/transport_sockets/tls/v3/common.proto` to allow specifying the SAN type.",
      "Added a new `match_typed_subject_alt_names` field to `api/envoy/extensions/transport_sockets/tls/v3/common.proto` to use `SubjectAltNameMatcher`.",
      "Deprecated the old `match_subject_alt_names` field in `api/envoy/extensions/transport_sockets/tls/v3/common.proto`.",
      "Modified `source/common/ssl/certificate_validation_context_config_impl.cc` to handle the new `match_typed_subject_alt_names` and deprecated `match_subject_alt_names` fields.",
       "Updated the documentation and examples to use `match_typed_subject_alt_names`."
    ]
  }
}
```