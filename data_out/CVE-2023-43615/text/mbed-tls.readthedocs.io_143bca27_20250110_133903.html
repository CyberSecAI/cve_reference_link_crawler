
[Mbed TLS](../../)

Contents

* [Getting Started](../../getting_started/)
* [API Reference](https://mbed-tls.readthedocs.io/projects/api)
* [Project](../../project/)
* [Reviews](../../reviews/)
* [Security Advisories](../)
  + [Buffer underrun in pkwrite when writing an opaque key pair](../mbedtls-security-advisory-2024-10-1/)
  + [Limited authentication bypass in TLS 1.3 optional client authentication](../mbedtls-security-advisory-2024-08-3/)
  + [Stack buffer overflow in ECDSA signature conversion functions](../mbedtls-security-advisory-2024-08-2/)
  + [CTR\_DRBG prioritized over HMAC\_DRBG as the PSA DRBG](../mbedtls-security-advisory-2024-08-1/)
  + [Insecure handling of shared memory in PSA Crypto APIs](../mbedtls-security-advisory-2024-03/)
  + [Buffer overflow in mbedtls\_x509\_set\_extension()](../mbedtls-security-advisory-2024-01-2/)
  + [Timing side channel in private key RSA operations.](../mbedtls-security-advisory-2024-01-1/)
  + [Buffer overflow in TLS handshake parsing with ECDH](../mbedtls-security-advisory-2023-10-2/)
  + Buffer overread in TLS stream cipher suites
    - [Vulnerability](#vulnerability)
    - [Impact](#impact)
    - [Resolution](#resolution)
    - [Work-around](#work-around)
  + [Buffer overread in DTLS ClientHello parsing](../mbedtls-security-advisory-2022-07/)
  + [Double Free in `mbedtls_ssl_set_session()` in an error case.](../mbedtls-security-advisory-2021-12/)
  + [Local side channel attack on static Diffie-Hellman with Montgomery curves](../mbedtls-security-advisory-2021-07-2/)
  + [Local side channel attack on RSA](../mbedtls-security-advisory-2021-07-1/)
  + [Protocol weakness in DHE-PSK key exchange](../mbedtls-security-advisory-2020-09-3/)
  + [Local side channel attack on RSA and static Diffie-Hellman](../mbedtls-security-advisory-2020-09-2/)
  + [Local side channel attack on classical CBC decryption in (D)TLS](../mbedtls-security-advisory-2020-09-1/)
  + [Side-channel attack on ECC key import and validation](../mbedtls-security-advisory-2020-07/)
  + [Side channel attack on ECDSA](../mbedtls-security-advisory-2020-04/)
  + [Cache attack against RSA key import in SGX](../mbedtls-security-advisory-2020-02/)
  + [Side channel attack on ECDSA](../mbedtls-security-advisory-2019-12/)
  + [Side channel attack on deterministic ECDSA](../mbedtls-security-advisory-2019-10/)
  + [Mbed TLS Security Advisory 2018-03](../mbedtls-security-advisory-2018-03/)
  + [Mbed TLS Security Advisory 2018-02](../mbedtls-security-advisory-2018-02/)
  + [mbed TLS Security Advisory 2018-01](../mbedtls-security-advisory-2018-01/)
  + [mbed TLS Security Advisory 2017-02](../mbedtls-security-advisory-2017-02/)
  + [mbed TLS Security Advisory 2017-01](../mbedtls-security-advisory-2017-01/)
  + [mbed TLS Security Advisory 2015-01](../mbedtls-security-advisory-2015-01/)
  + [PolarSSL Security Advisory 2014-04](../polarssl-security-advisory-2014-04/)
  + [PolarSSL Security Advisory 2014-03](../polarssl-security-advisory-2014-03-poodle-attack-on-ssl-v3/)
  + [PolarSSL Security Advisory 2014-02](../polarssl-security-advisory-2014-02/)
  + [PolarSSL Security Advisory 2014-01](../polarssl-security-advisory-2014-01/)
  + [PolarSSL Security Advisory 2013-05](../polarssl-security-advisory-2013-05/)
  + [PolarSSL Security Advisory 2013-04](../polarssl-security-advisory-2013-04/)
  + [PolarSSL Security Advisory 2013-03](../polarssl-security-advisory-2013-03/)
  + [PolarSSL Security Advisory 2013-02](../polarssl-security-advisory-2013-02/)
  + [PolarSSL Security Advisory 2013-01](../polarssl-security-advisory-2013-01/)
  + [PolarSSL Security Advisory 2012-01](../polarssl-security-advisory-2012-01/)
  + [PolarSSL Security Advisory 2011-02](../polarssl-security-advisory-2011-02/)
  + [PolarSSL Security Advisory 2011-01](../polarssl-security-advisory-2011-01/)
* [Contributing to This Documentation](../../CONTRIBUTING/)
* [Knowledge Base](../../kb/)

[Mbed TLS](../../)

* [Security Advisories](../)
* Buffer overread in TLS stream cipher suites
* [View page source](../../_sources/security-advisories/mbedtls-security-advisory-2023-10-1.md.txt)

---

# Buffer overread in TLS stream cipher suites[](#buffer-overread-in-tls-stream-cipher-suites "Permalink to this heading")

| **Title** | Buffer overread in TLS stream cipher suites |
| --- | --- |
| **CVE** | CVE-2023-43615 |
| **Date** | 05 October 2023 |
| **Affects** | All versions of Mbed TLS |
| **Impact** | A remote attacker may cause a crash or information disclosure. |
| **Severity** | Medium |
| **Credit** | OSS-Fuzz |

## Vulnerability[](#vulnerability "Permalink to this heading")

A peer in a (D)TLS connection using a null-cipher or RC4 cipher suite can send a malformed encrypted (or null-encrypted) record that causes a buffer overread of the vulnerable application. When the TLS parsing code calculates the MAC of the record, it subtracts the MAC length from the record length without checking if the record is large enough. As a consequence, if the payload of the record is shorter than the MAC, the code attempts to read slightly less than `SIZE_MAX` bytes to calculate the MAC of the received record.

Note that only weak cipher suites are affected: cipher suites using the null cipher (`TLS_xxx_WITH_NULL_hhh`, with authentication but not encryption) or RC4 (`TLS_xxx_WITH_RC4_128_hhh`, a weak and deprecated cipher, no longer supported after Mbed TLS 3.0). Those cipher suites are disabled in the default build-time configuration.

All protocol versions up to 1.2 are affected, including DTLS. TLS 1.3 is not affected. CBC and AEAD cipher suites are not affected.

## Impact[](#impact "Permalink to this heading")

A (D)TLS peer that has successfully completed a handshake using a null-cipher or RC4 cipher suite can cause a buffer overread. On many platforms, this will result in a memory access fault. On platforms without memory protection, if the address space contains memory-mapped peripherals, the read operations can cause unpredictable results.

## Resolution[](#resolution "Permalink to this heading")

Affected users will want to upgrade to Mbed TLS 3.5.0 or 2.28.5 depending on the branch they’re currently using.

## Work-around[](#work-around "Permalink to this heading")

The vulnerability is not present in the default build of Mbed TLS. It is only present if the compile-time configuration enables the vulnerable cipher suites. If you use a custom configuration and you want to check that the vulnerable cipher suites are not included in your build:

* In Mbed TLS 3.x or 2.28, make sure that `MBEDTLS_CIPHER_NULL_CIPHER` is not enabled.
* In Mbed TLS 2.28, also make sure that `MBEDTLS_REMOVE_ARC4_CIPHERSUITES` is enabled, or that `MBEDTLS_ARC4_C` is not enabled.

If the vulnerable cipher suites are enabled at compile time, they can be disabled at run time by calling `mbedtls_ssl_conf_ciphersuites()` with a list that does not include null-cipher or RC4 cipher suites. Alternatively, call `mbedtls_ssl_conf_ciphersuites_for_version()` for all affected protocol versions (SSLv3, TLS 1.0, TLS 1.1, TLS 1.2).

Applications that only accept TLS 1.3 are not affected.

The vulnerability only affects data records after a successful handshake, so if your TLS endpoint requires authentication, it can only be exploited by an authenticated client. Also, a firewall that prevents the negotiation of null-cipher or RC4 cipher suites will prevent the vulnerability from being exploited by traffic that goes through the firewall.

 [Previous](../mbedtls-security-advisory-2023-10-2/ "Buffer overflow in TLS handshake parsing with ECDH")
[Next](../mbedtls-security-advisory-2022-07/ "Buffer overread in DTLS ClientHello parsing")

---

© Copyright The Mbed TLS Contributors.

Built with [Sphinx](https://www.sphinx-doc.org/) using a
[theme](https://github.com/readthedocs/sphinx_rtd_theme)
provided by [Read the Docs](https://readthedocs.org).

