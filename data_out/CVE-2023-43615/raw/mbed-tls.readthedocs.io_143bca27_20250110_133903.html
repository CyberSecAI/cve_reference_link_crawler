<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Buffer overread in TLS stream cipher suites &mdash; Mbed TLS  documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=19f00094" />

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js?v=df4b10f6"></script>
        <script src="../../_static/doctools.js?v=888ff710"></script>
        <script src="../../_static/sphinx_highlight.js?v=4825356b"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex/" />
    <link rel="search" title="Search" href="../../search/" />
    <link rel="next" title="Buffer overread in DTLS ClientHello parsing" href="../mbedtls-security-advisory-2022-07/" />
    <link rel="prev" title="Buffer overflow in TLS handshake parsing with ECDH" href="../mbedtls-security-advisory-2023-10-2/" /> 
<script async type="text/javascript" src="/_/static/javascript/readthedocs-addons.js"></script><meta name="readthedocs-project-slug" content="mbed-tls" /><meta name="readthedocs-version-slug" content="latest" /><meta name="readthedocs-resolver-filename" content="/security-advisories/mbedtls-security-advisory-2023-10-1/" /><meta name="readthedocs-http-status" content="200" /></head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../" class="icon icon-home">
            Mbed TLS
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search/" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../getting_started/">Getting Started</a></li>
<li class="toctree-l1"><a class="reference external" href="https://mbed-tls.readthedocs.io/projects/api">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../project/">Project</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../reviews/">Reviews</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../">Security Advisories</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../mbedtls-security-advisory-2024-10-1/">Buffer underrun in pkwrite when writing an opaque key pair</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mbedtls-security-advisory-2024-08-3/">Limited authentication bypass in TLS 1.3 optional client authentication</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mbedtls-security-advisory-2024-08-2/">Stack buffer overflow in ECDSA signature conversion functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mbedtls-security-advisory-2024-08-1/">CTR_DRBG prioritized over HMAC_DRBG as the PSA DRBG</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mbedtls-security-advisory-2024-03/">Insecure handling of shared memory in PSA Crypto APIs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mbedtls-security-advisory-2024-01-2/">Buffer overflow in mbedtls_x509_set_extension()</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mbedtls-security-advisory-2024-01-1/">Timing side channel in private key RSA operations.</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mbedtls-security-advisory-2023-10-2/">Buffer overflow in TLS handshake parsing with ECDH</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Buffer overread in TLS stream cipher suites</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#vulnerability">Vulnerability</a></li>
<li class="toctree-l3"><a class="reference internal" href="#impact">Impact</a></li>
<li class="toctree-l3"><a class="reference internal" href="#resolution">Resolution</a></li>
<li class="toctree-l3"><a class="reference internal" href="#work-around">Work-around</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../mbedtls-security-advisory-2022-07/">Buffer overread in DTLS ClientHello parsing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mbedtls-security-advisory-2021-12/">Double Free in <code class="docutils literal notranslate"><span class="pre">mbedtls_ssl_set_session()</span></code> in an error case.</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mbedtls-security-advisory-2021-07-2/">Local side channel attack on static Diffie-Hellman with Montgomery curves</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mbedtls-security-advisory-2021-07-1/">Local side channel attack on RSA</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mbedtls-security-advisory-2020-09-3/">Protocol weakness in DHE-PSK key exchange</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mbedtls-security-advisory-2020-09-2/">Local side channel attack on RSA and static Diffie-Hellman</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mbedtls-security-advisory-2020-09-1/">Local side channel attack on classical CBC decryption in (D)TLS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mbedtls-security-advisory-2020-07/">Side-channel attack on ECC key import and validation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mbedtls-security-advisory-2020-04/">Side channel attack on ECDSA</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mbedtls-security-advisory-2020-02/">Cache attack against RSA key import in SGX</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mbedtls-security-advisory-2019-12/">Side channel attack on ECDSA</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mbedtls-security-advisory-2019-10/">Side channel attack on deterministic ECDSA</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mbedtls-security-advisory-2018-03/">Mbed TLS Security Advisory 2018-03</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mbedtls-security-advisory-2018-02/">Mbed TLS Security Advisory 2018-02</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mbedtls-security-advisory-2018-01/">mbed TLS Security Advisory 2018-01</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mbedtls-security-advisory-2017-02/">mbed TLS Security Advisory 2017-02</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mbedtls-security-advisory-2017-01/">mbed TLS Security Advisory 2017-01</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mbedtls-security-advisory-2015-01/">mbed TLS Security Advisory 2015-01</a></li>
<li class="toctree-l2"><a class="reference internal" href="../polarssl-security-advisory-2014-04/">PolarSSL Security Advisory 2014-04</a></li>
<li class="toctree-l2"><a class="reference internal" href="../polarssl-security-advisory-2014-03-poodle-attack-on-ssl-v3/">PolarSSL Security Advisory 2014-03</a></li>
<li class="toctree-l2"><a class="reference internal" href="../polarssl-security-advisory-2014-02/">PolarSSL Security Advisory 2014-02</a></li>
<li class="toctree-l2"><a class="reference internal" href="../polarssl-security-advisory-2014-01/">PolarSSL Security Advisory 2014-01</a></li>
<li class="toctree-l2"><a class="reference internal" href="../polarssl-security-advisory-2013-05/">PolarSSL Security Advisory 2013-05</a></li>
<li class="toctree-l2"><a class="reference internal" href="../polarssl-security-advisory-2013-04/">PolarSSL Security Advisory 2013-04</a></li>
<li class="toctree-l2"><a class="reference internal" href="../polarssl-security-advisory-2013-03/">PolarSSL Security Advisory 2013-03</a></li>
<li class="toctree-l2"><a class="reference internal" href="../polarssl-security-advisory-2013-02/">PolarSSL Security Advisory 2013-02</a></li>
<li class="toctree-l2"><a class="reference internal" href="../polarssl-security-advisory-2013-01/">PolarSSL Security Advisory 2013-01</a></li>
<li class="toctree-l2"><a class="reference internal" href="../polarssl-security-advisory-2012-01/">PolarSSL Security Advisory 2012-01</a></li>
<li class="toctree-l2"><a class="reference internal" href="../polarssl-security-advisory-2011-02/">PolarSSL Security Advisory 2011-02</a></li>
<li class="toctree-l2"><a class="reference internal" href="../polarssl-security-advisory-2011-01/">PolarSSL Security Advisory 2011-01</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../CONTRIBUTING/">Contributing to This Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../kb/">Knowledge Base</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../">Mbed TLS</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../">Security Advisories</a></li>
      <li class="breadcrumb-item active">Buffer overread in TLS stream cipher suites</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/security-advisories/mbedtls-security-advisory-2023-10-1.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="buffer-overread-in-tls-stream-cipher-suites">
<h1>Buffer overread in TLS stream cipher suites<a class="headerlink" href="#buffer-overread-in-tls-stream-cipher-suites" title="Permalink to this heading"></a></h1>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p><strong>Title</strong></p></th>
<th class="head"><p>Buffer overread in TLS stream cipher suites</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>CVE</strong></p></td>
<td><p>CVE-2023-43615</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Date</strong></p></td>
<td><p>05 October 2023</p></td>
</tr>
<tr class="row-even"><td><p><strong>Affects</strong></p></td>
<td><p>All versions of Mbed TLS</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Impact</strong></p></td>
<td><p>A remote attacker may cause a crash or information disclosure.</p></td>
</tr>
<tr class="row-even"><td><p><strong>Severity</strong></p></td>
<td><p>Medium</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Credit</strong></p></td>
<td><p>OSS-Fuzz</p></td>
</tr>
</tbody>
</table>
<section id="vulnerability">
<h2>Vulnerability<a class="headerlink" href="#vulnerability" title="Permalink to this heading"></a></h2>
<p>A peer in a (D)TLS connection using a null-cipher or RC4 cipher suite can send a malformed encrypted (or null-encrypted) record that causes a buffer overread of the vulnerable application. When the TLS parsing code calculates the MAC of the record, it subtracts the MAC length from the record length without checking if the record is large enough. As a consequence, if the payload of the record is shorter than the MAC, the code attempts to read slightly less than <code class="docutils literal notranslate"><span class="pre">SIZE_MAX</span></code> bytes to calculate the MAC of the received record.</p>
<p>Note that only weak cipher suites are affected: cipher suites using the null cipher (<code class="docutils literal notranslate"><span class="pre">TLS_xxx_WITH_NULL_hhh</span></code>, with authentication but not encryption) or RC4 (<code class="docutils literal notranslate"><span class="pre">TLS_xxx_WITH_RC4_128_hhh</span></code>, a weak and deprecated cipher, no longer supported after Mbed TLS 3.0). Those cipher suites are disabled in the default build-time configuration.</p>
<p>All protocol versions up to 1.2 are affected, including DTLS. TLS 1.3 is not affected. CBC and AEAD cipher suites are not affected.</p>
</section>
<section id="impact">
<h2>Impact<a class="headerlink" href="#impact" title="Permalink to this heading"></a></h2>
<p>A (D)TLS peer that has successfully completed a handshake using a null-cipher or RC4 cipher suite can cause a buffer overread. On many platforms, this will result in a memory access fault. On platforms without memory protection, if the address space contains memory-mapped peripherals, the read operations can cause unpredictable results.</p>
</section>
<section id="resolution">
<h2>Resolution<a class="headerlink" href="#resolution" title="Permalink to this heading"></a></h2>
<p>Affected users will want to upgrade to Mbed TLS 3.5.0 or 2.28.5 depending on the branch they’re currently using.</p>
</section>
<section id="work-around">
<h2>Work-around<a class="headerlink" href="#work-around" title="Permalink to this heading"></a></h2>
<p>The vulnerability is not present in the default build of Mbed TLS. It is only present if the compile-time configuration enables the vulnerable cipher suites. If you use a custom configuration and you want to check that the vulnerable cipher suites are not included in your build:</p>
<ul class="simple">
<li><p>In Mbed TLS 3.x or 2.28, make sure that <code class="docutils literal notranslate"><span class="pre">MBEDTLS_CIPHER_NULL_CIPHER</span></code> is not enabled.</p></li>
<li><p>In Mbed TLS 2.28, also make sure that <code class="docutils literal notranslate"><span class="pre">MBEDTLS_REMOVE_ARC4_CIPHERSUITES</span></code> is enabled, or that <code class="docutils literal notranslate"><span class="pre">MBEDTLS_ARC4_C</span></code> is not enabled.</p></li>
</ul>
<p>If the vulnerable cipher suites are enabled at compile time, they can be disabled at run time by calling <code class="docutils literal notranslate"><span class="pre">mbedtls_ssl_conf_ciphersuites()</span></code> with a list that does not include null-cipher or RC4 cipher suites. Alternatively, call <code class="docutils literal notranslate"><span class="pre">mbedtls_ssl_conf_ciphersuites_for_version()</span></code> for all affected protocol versions (SSLv3, TLS 1.0, TLS 1.1, TLS 1.2).</p>
<p>Applications that only accept TLS 1.3 are not affected.</p>
<p>The vulnerability only affects data records after a successful handshake, so if your TLS endpoint requires authentication, it can only be exploited by an authenticated client. Also, a firewall that prevents the negotiation of null-cipher or RC4 cipher suites will prevent the vulnerability from being exploited by traffic that goes through the firewall.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../mbedtls-security-advisory-2023-10-2/" class="btn btn-neutral float-left" title="Buffer overflow in TLS handshake parsing with ECDH" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../mbedtls-security-advisory-2022-07/" class="btn btn-neutral float-right" title="Buffer overread in DTLS ClientHello parsing" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright The Mbed TLS Contributors.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>