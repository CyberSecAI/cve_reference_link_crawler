

| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=dd65b324174a64558a16ebbf4c3266e5701185d0)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=dd65b324174a64558a16ebbf4c3266e5701185d0)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=dd65b324174a64558a16ebbf4c3266e5701185d0)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=dd65b324174a64558a16ebbf4c3266e5701185d0)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Jeff Layton <jlayton@kernel.org> | 2024-08-22 14:47:01 -0400 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-09-04 13:30:03 +0200 |
| commit | [dd65b324174a64558a16ebbf4c3266e5701185d0](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=dd65b324174a64558a16ebbf4c3266e5701185d0) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=dd65b324174a64558a16ebbf4c3266e5701185d0)) | |
| tree | [dceed3da737f3599955e49b16015bb000e488acd](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=dd65b324174a64558a16ebbf4c3266e5701185d0) | |
| parent | [2aadeb966cdada68da5694ffe5dc3ffe8224b913](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=2aadeb966cdada68da5694ffe5dc3ffe8224b913) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=dd65b324174a64558a16ebbf4c3266e5701185d0&id2=2aadeb966cdada68da5694ffe5dc3ffe8224b913)) | |
| download | [linux-dd65b324174a64558a16ebbf4c3266e5701185d0.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-dd65b324174a64558a16ebbf4c3266e5701185d0.tar.gz) | |

nfsd: ensure that nfsd4\_fattr\_args.context is zeroed out[ Upstream commit f58bab6fd4063913bd8321e99874b8239e9ba726 ]
If nfsd4\_encode\_fattr4 ends up doing a "goto out" before we get to
checking for the security label, then args.context will be set to
uninitialized junk on the stack, which we'll then try to free.
Initialize it early.
Fixes: f59388a579c6 ("NFSD: Add nfsd4\_encode\_fattr4\_sec\_label()")
Signed-off-by: Jeff Layton <jlayton@kernel.org>
Signed-off-by: Chuck Lever <chuck.lever@oracle.com>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=dd65b324174a64558a16ebbf4c3266e5701185d0)

| -rw-r--r-- | [fs/nfsd/nfs4xdr.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/fs/nfsd/nfs4xdr.c?id=dd65b324174a64558a16ebbf4c3266e5701185d0) | 4 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 3 insertions, 1 deletions

| diff --git a/fs/nfsd/nfs4xdr.c b/fs/nfsd/nfs4xdr.cindex c7bfd2180e3f27..8a7bc2b58e721c 100644--- a/[fs/nfsd/nfs4xdr.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/fs/nfsd/nfs4xdr.c?id=2aadeb966cdada68da5694ffe5dc3ffe8224b913)+++ b/[fs/nfsd/nfs4xdr.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/fs/nfsd/nfs4xdr.c?id=dd65b324174a64558a16ebbf4c3266e5701185d0)@@ -3545,6 +3545,9 @@ nfsd4\_encode\_fattr4(struct svc\_rqst \*rqstp, struct xdr\_stream \*xdr, args.dentry = dentry; args.ignore\_crossmnt = (ignore\_crossmnt != 0); args.acl = NULL;+#ifdef CONFIG\_NFSD\_V4\_SECURITY\_LABEL+ args.context = NULL;+#endif  /\* \* Make a local copy of the attribute bitmap that can be modified.@@ -3617,7 +3620,6 @@ nfsd4\_encode\_fattr4(struct svc\_rqst \*rqstp, struct xdr\_stream \*xdr, args.contextsupport = false;  #ifdef CONFIG\_NFSD\_V4\_SECURITY\_LABEL- args.context = NULL; if ((attrmask[2] & FATTR4\_WORD2\_SECURITY\_LABEL) || attrmask[0] & FATTR4\_WORD0\_SUPPORTED\_ATTRS) { if (exp->ex\_flags & NFSEXP\_SECURITY\_LABEL) |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 07:40:39 +0000

