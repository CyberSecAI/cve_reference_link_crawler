
[![](https://secpro.llc/wp-content/uploads/2022/06/SECPRO-LOG3-Transp-Recor-copy-2.png)](https://secpro.llc)

* [Services](https://secpro.llc/services/)
* [Training](https://secpro.llc/training)
* [About Us](https://secpro.llc/about/)
  + [Latam](https://secpro.co)
  + [Community](https://secpro.llc/community/)
* [Academy](https://academia.secpro.co/)
* [Contact](https://secpro.llc/contact/)
* [Resources](https://secpro.llc/resources/)
* [Blog](https://secpro.llc/blog/)
* ![en](https://secpro.llc/wp-content/plugins/gtranslate/flags/svg/en-us.svg)
  + ![en](https://secpro.llc/wp-content/plugins/gtranslate/flags/svg/en-us.svg)
  + ![es](https://secpro.llc/wp-content/plugins/gtranslate/flags/svg/es.svg)

# Insecure Object Reference Vulnerability in Web Application Document Handling

# Summary

Name: Insecure Object Reference Vulnerability in Web Application Document Handling

Product: EMSigner

Affected versions: EMSigner version 2.8.7

Affected Component: EndPoint /Areas/AdhocLogin/GETALLDOCUMENTSWORKDETAILSShareDownload and Web Parameter “DocumentId” and EndPoint /Areas/Share/InternalUserCompletedDownload and Web Parameter “ID”

Attack Type: Remote

Vulnerability Type: Incorrect Access Control

Impact: Information Disclosure

CVSSv3.1 Vector: AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N

CVSSv3.1 Base Score: 6.5

CVE ID(s): CVE-2023-43900

# Description

Insecure Direct Object References (IDOR) in EMSigner v2.8.7 allow attackers to gain unauthorized access to application content and view sensitive data of other users via manipulation of the documentID and EncryptedDocumentId parameters.

# Vulnerability

The “Insecure Object Reference Vulnerability in Web Application Document Handling” vulnerability stems from an insecure handling of object references within the web application’s document management functionality. It occurs because the application allows unauthorized access to sensitive document-related data by inadequately validating and controlling access to specific parameters, such as “DocumentID” and “EncryptedDocumentId.”

# Attack Vectors

The vulnerability is exploited through Insecure Direct Object References (IDOR) by manipulating parameter values, particularly the “documentID” and “EncryptedDocumentId” parameters. An attacker gains unauthorized access to application content and can view sensitive data of other users.

# Explotation

During the web application assessment for one of our clients, we performed an assessment on a web app that used the emSigner software. Now, speaking of emSigner, this software is a document automation solution that helps organizations completely eliminate paper from all workflows and create an end-to-end document automation ecosystem, digitizing documents using legally valid digital signatures.

While researching this web app, we discovered a vulnerability that allows an attacker to gain access to application content by manipulating parameter values, specifically documentID and EncryptedDocumentId parameter. An attacker can access unauthorized data information of another user. This can potentially lead to unauthorized access, disclosure of sensitive information

Below, we will explain this vulnerability and the steps needed to exploit it.

Logged in as a low-privilege user [[email protected]](/cdn-cgi/l/email-protection) and clicking on the option to download documents as shown in figure 6, An attacker intercept the request <https://domain.com/Areas/AdhocLogin/GETALLDOCUMENTSWORKDETAILSShareDownload?WorkFlowID=&DocumentID=19> the consultants noticed that the  **DocumentId** parameter loads numbers sequentially to obtain document information.  Consultants used the burpsuite intruder tool to automatically send numbers between 1 and 999 as shown in figure 1.

![](https://secpro.llc/wp-content/uploads/2023/11/EMSigner-cv3.png "EMSigner-cv3")

*Figure 1* *DocumentID Enumeration*

Consultants analyzed server’s response, focusing on responses with larger size and length as shown in figure 2.

![](https://secpro.llc/wp-content/uploads/2023/11/EMSigner-cv3-2.png "EMSigner-cv3-2")

*Figure 2* *Response HTTP Verification*

Consultantans identified responses containing the “**DocumentName**” and “**EncryptedDocumentId**” parameters, which reveal the document’s name and it is encrypted identifier.

![](https://secpro.llc/wp-content/uploads/2023/11/EMSigner-cv3-3.png "EMSigner-cv3-3")

*Figure 3* *Response HTTP Verification*

With the information in figure x the consultants manipulated the request https://domain.com//Areas/Share/InternalUserCompletedDownload?ID=<EncryptedDocumentId> for download documents from other profiles, providing the “EncryptedDocumentId” value in the “**ID**” web parameter, allowing to display documents upload from the any as shown in figure 4.

![](https://secpro.llc/wp-content/uploads/2023/11/EMSigner-cv3-4.png "EMSigner-cv3-4")

*Figure 4* *IDOR Exploitation*

# Remediation

An updated version of EMSigner is available at the vendor page.

# Credits

The vulnerability was discovered by Jean Paul Granados from SecPro’s Company (<https://secpro.co/> – [https://secpro.llc/)](https://secpro.llc/%29).

# References

Vendor page <https://www.emsigner.com/>

# Timeline

2023-02-27

Vulnerability discovered.

2023-05-08

Vendor contacted.

2023-05-24

Vendor replied acknowledging the report.

2023-09-01

Vulnerability patched.

2023-10-27

Public Disclosure.

## Contact Us


#### +1 (804) 256-8316


### [[email protected]](/cdn-cgi/l/email-protection)


#### 2034 Eisenhower Ave # 170 Alexandria, VA 22314

Monday-Friday: 9am - 5pm

## Get Started

## Schedule a virtual appointment with our experts for a free External Cybersecurity Diagnostic.

[Book Appointment](https://secpro.llc/contact/)

[![ISO 9001 SGS Certificate Icon](https://secpro.llc/wp-content/uploads/2022/06/WhatsApp_Image_2022-02-11_at_11.05.30_AM-removebg-preview-e1644617982207.png "SGS ISO 9001")](http://www.sgs.com/certifiedclients)

[![ISO 27001 SGS Certificate Icon](https://secpro.llc/wp-content/uploads/2022/06/SGS-27001.png "SGS 27001")](http://www.sgs.com/certifiedclients)

## Get informed about Events, News and Free Resources

## Success!

Email

Subscribe

#### **Privacy Policy**

#### Follow us on our social media

* [Follow](https://www.facebook.com/SecprollcUSA/ "Follow on Facebook")
* Follow
* [Follow](https://www.youtube.com/%40secproint "Follow on Youtube")
* Follow
* [Follow](https://www.linkedin.com/company/secprollc/ "Follow on LinkedIn")
* Follow

* Facebook
* X

SecPro LLC Designs

