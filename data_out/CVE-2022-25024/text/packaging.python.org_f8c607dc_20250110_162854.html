

Contents

Menu

Expand

Light mode

Dark mode

Auto light/dark, in light mode

Auto light/dark, in dark mode

Hide navigation sidebar

Hide table of contents sidebar

[Skip to content](#furo-main-content)
Toggle site navigation sidebar

[Python Packaging User Guide](../../)

Toggle Light / Dark / Auto color theme

Toggle table of contents sidebar

[Python Packaging User Guide](../../)

* [Overview of Python Packaging](../../overview/)
* [The Packaging Flow](../../flow/)
* [Tutorials](../../tutorials/)Toggle navigation of Tutorials
  + [Installing Packages](../../tutorials/installing-packages/)
  + [Managing Application Dependencies](../../tutorials/managing-dependencies/)
  + [Packaging Python Projects](../../tutorials/packaging-projects/)
* [Guides](../)Toggle navigation of Guides
  + [Installation](../section-install/)Toggle navigation of Installation
    - [Install packages in a virtual environment using pip and venv](../installing-using-pip-and-virtual-environments/)
    - [Installing packages using virtualenv](../installing-using-virtualenv/)
    - [Installing stand alone command line tools](../installing-stand-alone-command-line-tools/)
    - [Installing pip/setuptools/wheel with Linux Package Managers](../installing-using-linux-tools/)
    - [Installing scientific packages](../installing-scientific-packages/)
  + [Building and Publishing](../section-build-and-publish/)Toggle navigation of Building and Publishing
    - [Writing your `pyproject.toml`](../writing-pyproject-toml/)
    - [Packaging and distributing projects](../distributing-packages-using-setuptools/)
    - [Dropping support for older Python versions](../dropping-older-python-versions/)
    - [Packaging binary extensions](../packaging-binary-extensions/)
    - [Packaging namespace packages](../packaging-namespace-packages/)
    - [Creating and packaging command-line tools](../creating-command-line-tools/)
    - [Creating and discovering plugins](../creating-and-discovering-plugins/)
    - [Using TestPyPI](../using-testpypi/)
    - [Making a PyPI-friendly README](../making-a-pypi-friendly-readme/)
    - [Publishing package distribution releases using GitHub Actions CI/CD workflows](../publishing-package-distribution-releases-using-github-actions-ci-cd-workflows/)
    - [How to modernize a `setup.py` based project?](../modernize-setup-py-project/)
  + [Hosting](../section-hosting/)Toggle navigation of Hosting
    - [Package index mirrors and caches](../index-mirrors-and-caches/)
    - [Hosting your own simple repository](../hosting-your-own-index/)
  + [Tool recommendations](../tool-recommendations/)
  + Analyzing PyPI package downloads
* [Discussions](../../discussions/)Toggle navigation of Discussions
  + [Versioning](../../discussions/versioning/)
  + [Deploying Python applications](../../discussions/deploying-python-applications/)
  + [pip vs easy\_install](../../discussions/pip-vs-easy-install/)
  + [install\_requires vs requirements files](../../discussions/install-requires-vs-requirements/)
  + [Distribution package vs. import package](../../discussions/distribution-package-vs-import-package/)
  + [Package Formats](../../discussions/package-formats/)
  + [src layout vs flat layout](../../discussions/src-layout-vs-flat-layout/)
  + [Is `setup.py` deprecated?](../../discussions/setup-py-deprecated/)
  + [Single-sourcing the Project Version](../../discussions/single-source-version/)
* [PyPA specifications](../../specifications/)Toggle navigation of PyPA specifications
  + [Package Distribution Metadata](../../specifications/section-distribution-metadata/)Toggle navigation of Package Distribution Metadata
    - [Names and normalization](../../specifications/name-normalization/)
    - [Core metadata specifications](../../specifications/core-metadata/)
    - [Version specifiers](../../specifications/version-specifiers/)
    - [Dependency specifiers](../../specifications/dependency-specifiers/)
    - [`pyproject.toml` specification](../../specifications/pyproject-toml/)
    - [Dependency Groups](../../specifications/dependency-groups/)
    - [Inline script metadata](../../specifications/inline-script-metadata/)
    - [Platform compatibility tags](../../specifications/platform-compatibility-tags/)
    - [Well-known Project URLs in Metadata](../../specifications/well-known-project-urls/)
  + [Package Installation Metadata](../../specifications/section-installation-metadata/)Toggle navigation of Package Installation Metadata
    - [Recording installed projects](../../specifications/recording-installed-packages/)
    - [Entry points specification](../../specifications/entry-points/)
    - [Recording the Direct URL Origin of installed distributions](../../specifications/direct-url/)
    - [Direct URL Data Structure](../../specifications/direct-url-data-structure/)
    - [Python Virtual Environments](../../specifications/virtual-environments/)
    - [Externally Managed Environments](../../specifications/externally-managed-environments/)
  + [Package Distribution File Formats](../../specifications/section-distribution-formats/)Toggle navigation of Package Distribution File Formats
    - [Source distribution format](../../specifications/source-distribution-format/)
    - [Binary distribution format](../../specifications/binary-distribution-format/)
  + [Package Index Interfaces](../../specifications/section-package-indices/)Toggle navigation of Package Index Interfaces
    - [The `.pypirc` file](../../specifications/pypirc/)
    - [Simple repository API](../../specifications/simple-repository-api/)
    - [Index hosted attestations](../../specifications/index-hosted-attestations/)
* [Project Summaries](../../key_projects/)
* [Glossary](../../glossary/)
* [How to Get Support](../../support/)
* [Contribute to this guide](../../contribute/)
* [News](../../news/)

Back to top
[View this page](https://github.com/pypa/packaging.python.org/blob/main/source/guides/analyzing-pypi-package-downloads.rst?plain=true "View this page")
[Edit this page](https://github.com/pypa/packaging.python.org/edit/main/source/guides/analyzing-pypi-package-downloads.rst "Edit this page")
Toggle Light / Dark / Auto color theme

Toggle table of contents sidebar

# Analyzing PyPI package downloads[¶](#analyzing-pypi-package-downloads "Link to this heading")

This section covers how to use the public PyPI download statistics dataset
to learn more about downloads of a package (or packages) hosted on PyPI. For
example, you can use it to discover the distribution of Python versions used to
download a package.

## Background[¶](#background "Link to this heading")

PyPI does not display download statistics for a number of reasons: [[1]](#id4)

* **Inefficient to make work with a Content Distribution Network (CDN):**
  Download statistics change constantly. Including them in project pages, which
  are heavily cached, would require invalidating the cache more often, and
  reduce the overall effectiveness of the cache.
* **Highly inaccurate:** A number of things prevent the download counts from
  being accurate, some of which include:

  + `pip`’s download cache (lowers download counts)
  + Internal or unofficial mirrors (can both raise or lower download counts)
  + Packages not hosted on PyPI (for comparisons sake)
  + Unofficial scripts or attempts at download count inflation (raises download
    counts)
  + Known historical data quality issues (lowers download counts)
* **Not particularly useful:** Just because a project has been downloaded a lot
  doesn’t mean it’s good; Similarly just because a project hasn’t been
  downloaded a lot doesn’t mean it’s bad!

In short, because its value is low for various reasons, and the tradeoffs
required to make it work are high, it has been not an effective use of
limited resources.

## Public dataset[¶](#public-dataset "Link to this heading")

As an alternative, the [Linehaul project](https://github.com/pypa/linehaul-cloud-function/)
streams download logs from PyPI to [Google BigQuery](https://cloud.google.com/bigquery) [[2]](#id5), where they are
stored as a public dataset.

### Getting set up[¶](#getting-set-up "Link to this heading")

In order to use [Google BigQuery](https://cloud.google.com/bigquery) to query the [public PyPI download
statistics dataset](https://console.cloud.google.com/bigquery?p=bigquery-public-data&d=pypi&page=dataset), you’ll need a Google account and to enable the BigQuery
API on a Google Cloud Platform project. You can run up to 1TB of queries
per month [using the BigQuery free tier without a credit card](https://cloud.google.com/blog/products/data-analytics/query-without-a-credit-card-introducing-bigquery-sandbox)

* Navigate to the [BigQuery web UI](https://console.cloud.google.com/bigquery).
* Create a new project.
* Enable the [BigQuery API](https://console.developers.google.com/apis/library/bigquery-json.googleapis.com).

For more detailed instructions on how to get started with BigQuery, check out
the [BigQuery quickstart guide](https://cloud.google.com/bigquery/docs/quickstarts/quickstart-web-ui).

### Data schema[¶](#data-schema "Link to this heading")

Linehaul writes an entry in a `bigquery-public-data.pypi.file_downloads` table for each
download. The table contains information about what file was downloaded and how
it was downloaded. Some useful columns from the [table schema](https://console.cloud.google.com/bigquery?pli=1&p=bigquery-public-data&d=pypi&t=file_downloads&page=table)
include:

| Column | Description | Examples |
| --- | --- | --- |
| timestamp | Date and time | `2020-03-09 00:33:03 UTC` |
| file.project | Project name | `pipenv`, `nose` |
| file.version | Package version | `0.1.6`, `1.4.2` |
| details.installer.name | Installer | pip, [bandersnatch](../../key_projects/#bandersnatch) |
| details.python | Python version | `2.7.12`, `3.6.4` |

### Useful queries[¶](#useful-queries "Link to this heading")

Run queries in the [BigQuery web UI](https://console.cloud.google.com/bigquery) by clicking the “Compose query” button.

Note that the rows are stored in a partitioned table, which helps
limit the cost of queries. These example queries analyze downloads from
recent history by filtering on the `timestamp` column.

#### Counting package downloads[¶](#counting-package-downloads "Link to this heading")

The following query counts the total number of downloads for the project
“pytest”.

```
#standardSQL
SELECT COUNT(*) AS num_downloads
FROM `bigquery-public-data.pypi.file_downloads`
WHERE file.project = 'pytest'
  -- Only query the last 30 days of history
  AND DATE(timestamp)
    BETWEEN DATE_SUB(CURRENT_DATE(), INTERVAL 30 DAY)
    AND CURRENT_DATE()

```

| num\_downloads |
| --- |
| 26190085 |

To count downloads from pip only, filter on the `details.installer.name`
column.

```
#standardSQL
SELECT COUNT(*) AS num_downloads
FROM `bigquery-public-data.pypi.file_downloads`
WHERE file.project = 'pytest'
  AND details.installer.name = 'pip'
  -- Only query the last 30 days of history
  AND DATE(timestamp)
    BETWEEN DATE_SUB(CURRENT_DATE(), INTERVAL 30 DAY)
    AND CURRENT_DATE()

```

| num\_downloads |
| --- |
| 24334215 |

#### Package downloads over time[¶](#package-downloads-over-time "Link to this heading")

To group by monthly downloads, use the `TIMESTAMP_TRUNC` function. Also
filtering by this column reduces corresponding costs.

```
#standardSQL
SELECT
  COUNT(*) AS num_downloads,
  DATE_TRUNC(DATE(timestamp), MONTH) AS `month`
FROM `bigquery-public-data.pypi.file_downloads`
WHERE
  file.project = 'pytest'
  -- Only query the last 6 months of history
  AND DATE(timestamp)
    BETWEEN DATE_TRUNC(DATE_SUB(CURRENT_DATE(), INTERVAL 6 MONTH), MONTH)
    AND CURRENT_DATE()
GROUP BY `month`
ORDER BY `month` DESC

```

| num\_downloads | month |
| --- | --- |
| 1956741 | 2018-01-01 |
| 2344692 | 2017-12-01 |
| 1730398 | 2017-11-01 |
| 2047310 | 2017-10-01 |
| 1744443 | 2017-09-01 |
| 1916952 | 2017-08-01 |

#### Python versions over time[¶](#python-versions-over-time "Link to this heading")

Extract the Python version from the `details.python` column. Warning: This
query processes over 500 GB of data.

```
#standardSQL
SELECT
  REGEXP_EXTRACT(details.python, r"[0-9]+\.[0-9]+") AS python_version,
  COUNT(*) AS num_downloads,
FROM `bigquery-public-data.pypi.file_downloads`
WHERE
  -- Only query the last 6 months of history
  DATE(timestamp)
    BETWEEN DATE_TRUNC(DATE_SUB(CURRENT_DATE(), INTERVAL 6 MONTH), MONTH)
    AND CURRENT_DATE()
GROUP BY `python_version`
ORDER BY `num_downloads` DESC

```

| python | num\_downloads |
| --- | --- |
| 3.7 | 18051328726 |
| 3.6 | 9635067203 |
| 3.8 | 7781904681 |
| 2.7 | 6381252241 |
| null | 2026630299 |
| 3.5 | 1894153540 |

#### Getting absolute links to artifacts[¶](#getting-absolute-links-to-artifacts "Link to this heading")

It’s sometimes helpful to be able to get the absolute links to download
artifacts from PyPI based on their hashes, e.g. if a particular project or
release has been deleted from PyPI. The metadata table includes the `path`
column, which includes the hash and artifact filename.

Note

The URL generated here is not guaranteed to be stable, but currently aligns with the URL where PyPI artifacts are hosted.

```
SELECT
  CONCAT('https://files.pythonhosted.org/packages', path) as url
FROM
  `bigquery-public-data.pypi.distribution_metadata`
WHERE
  filename LIKE 'sampleproject%'

```

| url |
| --- |
| <https://files.pythonhosted.org/packages/eb/45/79be82bdeafcecb9dca474cad4003e32ef8e4a0dec6abbd4145ccb02abe1/sampleproject-1.2.0.tar.gz> |
| <https://files.pythonhosted.org/packages/56/0a/178e8bbb585ec5b13af42dae48b1d7425d6575b3ff9b02e5ec475e38e1d6/sampleproject_nomura-1.2.0-py2.py3-none-any.whl> |
| <https://files.pythonhosted.org/packages/63/88/3200eeaf22571f18d2c41e288862502e33365ccbdc12b892db23f51f8e70/sampleproject_nomura-1.2.0.tar.gz> |
| <https://files.pythonhosted.org/packages/21/e9/2743311822e71c0756394b6c5ab15cb64ca66c78c6c6a5cd872c9ed33154/sampleproject_doubleyoung18-1.3.0-py2.py3-none-any.whl> |
| <https://files.pythonhosted.org/packages/6f/5b/2f3fe94e1c02816fe23c7ceee5292fb186912929e1972eee7fb729fa27af/sampleproject-1.3.1.tar.gz> |

## Caveats[¶](#caveats "Link to this heading")

In addition to the caveats listed in the background above, Linehaul suffered
from a bug which caused it to significantly under-report download statistics
prior to July 26, 2018. Downloads before this date are proportionally accurate
(e.g. the percentage of Python 2 vs. Python 3 downloads) but total numbers are
lower than actual by an order of magnitude.

## Additional tools[¶](#additional-tools "Link to this heading")

Besides using the BigQuery console, there are some additional tools which may
be useful when analyzing download statistics.

### `google-cloud-bigquery`[¶](#google-cloud-bigquery "Link to this heading")

You can also access the public PyPI download statistics dataset
programmatically via the BigQuery API and the [google-cloud-bigquery](https://cloud.google.com/bigquery/docs/reference/libraries) project,
the official Python client library for BigQuery.

```
from google.cloud import bigquery

# Note: depending on where this code is being run, you may require
# additional authentication. See:
# https://cloud.google.com/bigquery/docs/authentication/
client = bigquery.Client()

query_job = client.query("""
SELECT COUNT(*) AS num_downloads
FROM `bigquery-public-data.pypi.file_downloads`
WHERE file.project = 'pytest'
  -- Only query the last 30 days of history
  AND DATE(timestamp)
    BETWEEN DATE_SUB(CURRENT_DATE(), INTERVAL 30 DAY)
    AND CURRENT_DATE()""")

results = query_job.result()  # Waits for job to complete.
for row in results:
    print("{} downloads".format(row.num_downloads))

```

### `pypinfo`[¶](#pypinfo "Link to this heading")

[pypinfo](https://github.com/ofek/pypinfo) is a command-line tool which provides access to the dataset and
can generate several useful queries. For example, you can query the total
number of download for a package with the command `pypinfo package_name`.

Install [pypinfo](https://github.com/ofek/pypinfo) using pip.

```
python3 -m pip install pypinfo

```

Usage:

```
$ pypinfo requests
Served from cache: False
Data processed: 6.87 GiB
Data billed: 6.87 GiB
Estimated cost: $0.04

| download_count |
| -------------- |
|      9,316,415 |

```

### `pandas-gbq`[¶](#pandas-gbq "Link to this heading")

The [pandas-gbq](https://pandas-gbq.readthedocs.io/en/latest/) project allows for accessing query results via [Pandas](https://pandas.pydata.org/).

## References[¶](#references "Link to this heading")

[[1](#id2)]

[PyPI Download Counts deprecation email](https://mail.python.org/pipermail/distutils-sig/2013-May/020855.html)

[[2](#id3)]

[PyPI BigQuery dataset announcement email](https://mail.python.org/pipermail/distutils-sig/2016-May/028986.html)

[Next

Discussions](../../discussions/)
[Previous

Tool recommendations](../tool-recommendations/)

Copyright © 2013–2020, PyPA

Made with [Sphinx](https://www.sphinx-doc.org/) and [@pradyunsg](https://pradyunsg.me)'s
[Furo](https://github.com/pradyunsg/furo)
Last updated on Jan 08, 2025

On this page

* Analyzing PyPI package downloads
  + [Background](#background)
  + [Public dataset](#public-dataset)
    - [Getting set up](#getting-set-up)
    - [Data schema](#data-schema)
    - [Useful queries](#useful-queries)
      * [Counting package downloads](#counting-package-downloads)
      * [Package downloads over time](#package-downloads-over-time)
      * [Python versions over time](#python-versions-over-time)
      * [Getting absolute links to artifacts](#getting-absolute-links-to-artifacts)
  + [Caveats](#caveats)
  + [Additional tools](#additional-tools)
    - [`google-cloud-bigquery`](#google-cloud-bigquery)
    - [`pypinfo`](#pypinfo)
    - [`pandas-gbq`](#pandas-gbq)
  + [References](#references)

