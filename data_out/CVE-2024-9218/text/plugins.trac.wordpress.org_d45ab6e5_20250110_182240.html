

[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fbrowser%2Fmagazine-blocks%2Ftags%2F1.3.14%2Fincludes%2FBlocks.php)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Revision](/browser/magazine-blocks/trunk/includes/Blocks.php?rev=3072735 "Revision 3072735")
* [Next Revision](/browser/magazine-blocks/trunk/includes/Blocks.php?rev=3161000 "Revision 3161000") →
* [Blame](/browser/magazine-blocks/trunk/includes/Blocks.php?annotate=blame "Annotate each line with the last changed revision (this can be time consuming...)")
* [Revision Log](/log/magazine-blocks/tags/1.3.14/includes/Blocks.php)

---

# [source:](/browser?order=name "Go to repository root") [magazine-blocks](/browser/magazine-blocks?order=name "View magazine-blocks")/[tags](/browser/magazine-blocks/tags?order=name "View tags")/[1.3.14](/browser/magazine-blocks/tags/1.3.14?order=name "View 1.3.14")/[includes](/browser/magazine-blocks/tags/1.3.14/includes?order=name "View includes")/[Blocks.php](/browser/magazine-blocks/tags/1.3.14/includes/Blocks.php?order=name "View Blocks.php")

View diff against:

View revision:

| [Last change](/changeset/3114201/magazine-blocks/trunk/includes/Blocks.php "View differences") on this file was [3114201](/changeset/3114201/ "View changeset 3114201"), checked in by wpblockart, [6 months ago](/timeline?from=2024-07-08T10%3A52%3A37Z&precision=second "See timeline at 07/08/2024 10:52:37 AM") |
| --- |
| Update to version 1.3.9 from GitHub |
| **File size:** 13.2 KB | |

| Line |  |
| --- | --- |
| [1](#L1) | <?php |
| [2](#L2) | /\*\* |
| [3](#L3) | \* Magazine Blocks Manager. |
| [4](#L4) | \* |
| [5](#L5) | \* @since 1.0.0 |
| [6](#L6) | \* @package Magazine Blocks |
| [7](#L7) | \*/ |
| [8](#L8) |  |
| [9](#L9) | namespace MagazineBlocks; |
| [10](#L10) |  |
| [11](#L11) | // Exit if accessed directly. |
| [12](#L12) | defined( 'ABSPATH' ) || exit; |
| [13](#L13) |  |
| [14](#L14) | use MagazineBlocks\BlockTypes\Advertisement; |
| [15](#L15) | use MagazineBlocks\BlockTypes\DateWeather; |
| [16](#L16) | use MagazineBlocks\BlockTypes\Modal; |
| [17](#L17) | use MagazineBlocks\Traits\Singleton; |
| [18](#L18) | use MagazineBlocks\BlockTypes\Heading; |
| [19](#L19) | use MagazineBlocks\BlockTypes\BannerPosts; |
| [20](#L20) | use MagazineBlocks\BlockTypes\GridModule; |
| [21](#L21) | use MagazineBlocks\BlockTypes\FeaturedPosts; |
| [22](#L22) | use MagazineBlocks\BlockTypes\FeaturedCategories; |
| [23](#L23) | use MagazineBlocks\BlockTypes\PostList; |
| [24](#L24) | use MagazineBlocks\BlockTypes\CategoryList; |
| [25](#L25) | use MagazineBlocks\BlockTypes\TabPost; |
| [26](#L26) | use MagazineBlocks\BlockTypes\NewsTicker; |
| [27](#L27) | use MagazineBlocks\BlockTypes\Column; |
| [28](#L28) | use MagazineBlocks\BlockTypes\PostVideo; |
| [29](#L29) | use MagazineBlocks\BlockTypes\Section; |
| [30](#L30) | use MagazineBlocks\BlockTypes\Slider; |
| [31](#L31) | use MagazineBlocks\BlockTypes\AbstractBlock; |
| [32](#L32) | use MagazineBlocks\BlockTypes\LatestPosts; |
| [33](#L33) | use MagazineBlocks\BlockTypes\SocialIcons; |
| [34](#L34) | use MagazineBlocks\BlockTypes\SocialIcon; |
| [35](#L35) | use WP\_Query; |
| [36](#L36) |  |
| [37](#L37) | /\*\* |
| [38](#L38) | \* Magazine\_Blocks Blocks Manager |
| [39](#L39) | \* |
| [40](#L40) | \* Registers all the blocks & block categories and manages them. |
| [41](#L41) | \* |
| [42](#L42) | \* @since 1.0.0 |
| [43](#L43) | \*/ |
| [44](#L44) | final class Blocks { |
| [45](#L45) |  |
| [46](#L46) | use Singleton; |
| [47](#L47) |  |
| [48](#L48) | /\*\* |
| [49](#L49) | \* Block styles. |
| [50](#L50) | \* |
| [51](#L51) | \* @var BlockStyles|null $block\_styles |
| [52](#L52) | \*/ |
| [53](#L53) | private $block\_styles; |
| [54](#L54) |  |
| [55](#L55) | /\*\* |
| [56](#L56) | \* Blocks that need to be prepared for CSS generation. |
| [57](#L57) | \* |
| [58](#L58) | \* @var array $prepared\_blocks |
| [59](#L59) | \*/ |
| [60](#L60) | private $prepared\_blocks = array(); |
| [61](#L61) |  |
| [62](#L62) | /\*\* |
| [63](#L63) | \* Prepared widget blocks. |
| [64](#L64) | \* |
| [65](#L65) | \* @var array |
| [66](#L66) | \*/ |
| [67](#L67) | private $prepared\_widget\_blocks = array(); |
| [68](#L68) |  |
| [69](#L69) | /\*\* |
| [70](#L70) | \* Constructor. |
| [71](#L71) | \*/ |
| [72](#L72) | protected function \_\_construct() { |
| [73](#L73) | $this->init\_hooks(); |
| [74](#L74) | } |
| [75](#L75) |  |
| [76](#L76) | /\*\* |
| [77](#L77) | \* Magazine\_Blocks/BlocksManager Constructor. |
| [78](#L78) | \* |
| [79](#L79) | \* @since 1.0.0 |
| [80](#L80) | \*/ |
| [81](#L81) | private function init\_hooks() { |
| [82](#L82) | $block\_categories\_hook   = version\_compare( get\_bloginfo( 'version' ), '5.8', '>=' ) ? |
| [83](#L83) | 'block\_categories\_all' : |
| [84](#L84) | 'block\_categories'; |
| [85](#L85) | $preload\_api\_hook\_handle = class\_exists( 'WP\_Block\_Editor\_Context' ) ? 'block\_editor\_rest\_api\_preload\_paths' : 'block\_editor\_preload\_paths'; |
| [86](#L86) |  |
| [87](#L87) | add\_action( 'init', array( $this, 'register\_block\_types' ) ); |
| [88](#L88) | add\_filter( $block\_categories\_hook, array( $this, 'block\_categories' ), PHP\_INT\_MAX, 2 ); |
| [89](#L89) | add\_filter( $preload\_api\_hook\_handle, array( $this, 'preload\_rest\_api\_path' ), 10, 2 ); |
| [90](#L90) |  |
| [91](#L91) | add\_filter( 'pre\_render\_block', array( $this, 'maybe\_prepare\_blocks' ), 10, 3 ); |
| [92](#L92) | add\_filter( 'wp\_head', array( $this, 'maybe\_prepare\_blocks' ), 0 ); |
| [93](#L93) | add\_action( 'wp\_enqueue\_scripts', array( $this, 'enqueue\_blocks\_styles' ), 11 ); |
| [94](#L94) |  |
| [95](#L95) | add\_action( 'customize\_save\_after', array( $this, 'maybe\_clear\_widget\_block\_styles' ) ); |
| [96](#L96) | add\_action( 'rest\_after\_save\_widget', array( $this, 'maybe\_clear\_widget\_block\_styles' ) ); |
| [97](#L97) | add\_action( 'after\_switch\_theme', array( $this, 'maybe\_clear\_block\_styles\_on\_theme\_switch' ), 10, 2 ); |
| [98](#L98) | add\_action( 'save\_post', array( $this, 'maybe\_clear\_block\_styles' ), 10, 3 ); |
| [99](#L99) | add\_action( 'delete\_post', array( $this, 'maybe\_clear\_block\_styles' ), 10, 2 ); |
| [100](#L100) | add\_action( 'magazine\_blocks\_responsive\_breakpoints\_changed', array( $this, 'regenerate\_block\_styles' ) ); |
| [101](#L101) | } |
| [102](#L102) |  |
| [103](#L103) | /\*\* |
| [104](#L104) | \* Preload REST api path. |
| [105](#L105) | \* |
| [106](#L106) | \* @param array                                   $paths Rest API paths. |
| [107](#L107) | \* @param \WP\_Block\_Editor\_Context|\WP\_Post|mixed $context Current editor context. |
| [108](#L108) | \* |
| [109](#L109) | \* @return array |
| [110](#L110) | \*/ |
| [111](#L111) | public function preload\_rest\_api\_path( array $paths, $context ): array { |
| [112](#L112) | if ( |
| [113](#L113) | $context instanceof \WP\_Post || |
| [114](#L114) | ( isset( $context->name ) && in\_array( $context->name, [ 'core/edit-site', 'core/edit-post' ], true ) ) |
| [115](#L115) | ) { |
| [116](#L116) | $paths[] = '/magazine-blocks/v1/library-data'; |
| [117](#L117) | } |
| [118](#L118) | return $paths; |
| [119](#L119) | } |
| [120](#L120) |  |
| [121](#L121) | /\*\* |
| [122](#L122) | \* Prepare blocks for FSE themes. |
| [123](#L123) | \*/ |
| [124](#L124) | public function maybe\_prepare\_blocks() { |
| [125](#L125) | if ( magazine\_blocks\_is\_block\_theme() && doing\_filter( 'pre\_render\_block' ) ) { |
| [126](#L126) | $args                    = func\_get\_args(); |
| [127](#L127) | $block                   = $args[1]; |
| [128](#L128) | $this->prepared\_blocks[] = $block; |
| [129](#L129) | return $args[0]; |
| [130](#L130) | } |
| [131](#L131) | if ( ! magazine\_blocks\_is\_block\_theme() && doing\_action( 'wp\_head' ) ) { |
| [132](#L132) | $this->prepared\_blocks        = parse\_blocks( get\_the\_content() ); |
| [133](#L133) | $this->prepared\_widget\_blocks = $this->get\_widget\_blocks(); |
| [134](#L134) | } |
| [135](#L135) | } |
| [136](#L136) |  |
| [137](#L137) | /\*\* |
| [138](#L138) | \* Enqueue blocks styles. |
| [139](#L139) | \* |
| [140](#L140) | \* @return void |
| [141](#L141) | \*/ |
| [142](#L142) | public function enqueue\_blocks\_styles() { |
| [143](#L143) | if ( empty( $this->prepared\_blocks ) ) { |
| [144](#L144) | return; |
| [145](#L145) | } |
| [146](#L146) |  |
| [147](#L147) | $fonts                 = array(); |
| [148](#L148) | $this->prepared\_blocks = magazine\_blocks\_process\_blocks( $this->prepared\_blocks ); |
| [149](#L149) | $styles                = magazine\_blocks\_generate\_blocks\_styles( $this->prepared\_blocks ); |
| [150](#L150) | if ( ! magazine\_blocks\_is\_block\_theme() ) { |
| [151](#L151) | $this->prepared\_widget\_blocks = magazine\_blocks\_process\_blocks( $this->prepared\_widget\_blocks ); |
| [152](#L152) | $widget\_styles                = magazine\_blocks\_generate\_blocks\_styles( $this->prepared\_widget\_blocks, 'widgets' ); |
| [153](#L153) | $fonts                        = $widget\_styles->get\_fonts(); |
| [154](#L154) | $widget\_styles->enqueue(); |
| [155](#L155) | } |
| [156](#L156) |  |
| [157](#L157) | $styles->enqueue\_fonts( $fonts ); |
| [158](#L158) | $styles->enqueue(); |
| [159](#L159) | } |
| [160](#L160) |  |
| [161](#L161) | /\*\* |
| [162](#L162) | \* Register block types. |
| [163](#L163) | \* |
| [164](#L164) | \* @return void |
| [165](#L165) | \*/ |
| [166](#L166) | public function register\_block\_types() { |
| [167](#L167) | $block\_types = $this->get\_block\_types(); |
| [168](#L168) | foreach ( $block\_types as $block\_type ) { |
| [169](#L169) | new $block\_type(); |
| [170](#L170) | } |
| [171](#L171) | } |
| [172](#L172) |  |
| [173](#L173) | /\*\* |
| [174](#L174) | \* Get block types. |
| [175](#L175) | \* |
| [176](#L176) | \* @return AbstractBlock[] |
| [177](#L177) | \*/ |
| [178](#L178) | private function get\_block\_types(): array { |
| [179](#L179) | return apply\_filters( |
| [180](#L180) | 'magazine\_blocks\_block\_types', |
| [181](#L181) | array( |
| [182](#L182) | Advertisement::class, |
| [183](#L183) | Heading::class, |
| [184](#L184) | BannerPosts::class, |
| [185](#L185) | GridModule::class, |
| [186](#L186) | FeaturedPosts::class, |
| [187](#L187) | FeaturedCategories::class, |
| [188](#L188) | TabPost::class, |
| [189](#L189) | PostList::class, |
| [190](#L190) | CategoryList::class, |
| [191](#L191) | NewsTicker::class, |
| [192](#L192) | Column::class, |
| [193](#L193) | PostVideo::class, |
| [194](#L194) | Section::class, |
| [195](#L195) | DateWeather::class, |
| [196](#L196) | Slider::class, |
| [197](#L197) | SocialIcons::class, |
| [198](#L198) | SocialIcon::class, |
| [199](#L199) | Modal::class, |
| [200](#L200) | LatestPosts::class, |
| [201](#L201) | ) |
| [202](#L202) | ); |
| [203](#L203) | } |
| [204](#L204) |  |
| [205](#L205) | /\*\* |
| [206](#L206) | \* Add "Magazine Blocks" category to the blocks listing in post edit screen. |
| [207](#L207) | \* |
| [208](#L208) | \* @param array $block\_categories All registered block categories. |
| [209](#L209) | \* @return array |
| [210](#L210) | \* @since 1.0.0 |
| [211](#L211) | \*/ |
| [212](#L212) | public function block\_categories( array $block\_categories ): array { |
| [213](#L213) | return array\_merge( |
| [214](#L214) | array( |
| [215](#L215) | array( |
| [216](#L216) | 'slug'  => 'magazine-blocks', |
| [217](#L217) | 'title' => esc\_html\_\_( 'Magazine Blocks', 'magazine-blocks' ), |
| [218](#L218) | ), |
| [219](#L219) | ), |
| [220](#L220) | $block\_categories |
| [221](#L221) | ); |
| [222](#L222) | } |
| [223](#L223) |  |
| [224](#L224) | /\*\* |
| [225](#L225) | \* Clear cached widget styles when widget is updated. |
| [226](#L226) | \* |
| [227](#L227) | \* @return void |
| [228](#L228) | \*/ |
| [229](#L229) | public function maybe\_clear\_widget\_block\_styles() { |
| [230](#L230) | $cached = get\_option( '\_magazine\_blocks\_blocks\_css', array() ); |
| [231](#L231) | magazine\_blocks\_array\_forget( $cached, 'widgets' ); |
| [232](#L232) | update\_option( '\_magazine\_blocks\_blocks\_css', $cached ); |
| [233](#L233) | } |
| [234](#L234) |  |
| [235](#L235) | /\*\* |
| [236](#L236) | \* Clear cached styles when theme is switched. |
| [237](#L237) | \* |
| [238](#L238) | \* If is block theme then clear all cached styles stored in options table. |
| [239](#L239) | \* As block theme fully depends on blocks. |
| [240](#L240) | \* |
| [241](#L241) | \* @param string    $name string Theme name. |
| [242](#L242) | \* @param \WP\_Theme $theme Theme object. |
| [243](#L243) | \* @return void |
| [244](#L244) | \*/ |
| [245](#L245) | public function maybe\_clear\_block\_styles\_on\_theme\_switch( string $name, \WP\_Theme $theme ) { |
| [246](#L246) | if ( $theme->is\_block\_theme() ) { |
| [247](#L247) | delete\_option( '\_magazine\_blocks\_blocks\_css' ); |
| [248](#L248) | } |
| [249](#L249) | } |
| [250](#L250) |  |
| [251](#L251) | /\*\* |
| [252](#L252) | \* Clear or update cached styles. |
| [253](#L253) | \* |
| [254](#L254) | \* @param int      $id Post ID. |
| [255](#L255) | \* @param \WP\_Post $post Post object. |
| [256](#L256) | \* @return void |
| [257](#L257) | \*/ |
| [258](#L258) | public function maybe\_clear\_block\_styles( $id, \WP\_Post $post ) { |
| [259](#L259) | if ( doing\_action( 'save\_post' ) ) { |
| [260](#L260) | // Don't make style for reusable blocks. |
| [261](#L261) | if ( 'wp\_block' === $post->post\_type ) { |
| [262](#L262) | return; |
| [263](#L263) | } |
| [264](#L264) |  |
| [265](#L265) | // Clear cached styles when template part or template is updated. |
| [266](#L266) | if ( 'wp\_template\_part' === $post->post\_type || 'wp\_template' === $post->post\_type ) { |
| [267](#L267) | delete\_option( '\_magazine\_blocks\_blocks\_css' ); |
| [268](#L268) | return; |
| [269](#L269) | } |
| [270](#L270) |  |
| [271](#L271) | delete\_post\_meta( $id, '\_magazine\_blocks\_blocks\_css' ); |
| [272](#L272) | } |
| [273](#L273) |  |
| [274](#L274) | if ( doing\_action( 'delete\_post' ) ) { |
| [275](#L275) | $filesystem = magazine\_blocks\_get\_filesystem(); |
| [276](#L276) | if ( $filesystem ) { |
| [277](#L277) | $css\_files = $filesystem->dirlist( MAGAZINE\_BLOCKS\_UPLOAD\_DIR ); |
| [278](#L278) | if ( ! empty( $css\_files ) ) { |
| [279](#L279) | foreach ( $css\_files as $css\_file ) { |
| [280](#L280) | if ( false !== strpos( $css\_file['name'], "ba-style-$id-" ) ) { |
| [281](#L281) | $filesystem->delete( MAGAZINE\_BLOCKS\_UPLOAD\_DIR . $css\_file['name'] ); |
| [282](#L282) | break; |
| [283](#L283) | } |
| [284](#L284) | } |
| [285](#L285) | } |
| [286](#L286) | } |
| [287](#L287) | } |
| [288](#L288) | } |
| [289](#L289) |  |
| [290](#L290) | /\*\* |
| [291](#L291) | \* Get widget blocks. |
| [292](#L292) | \* |
| [293](#L293) | \* @return array |
| [294](#L294) | \*/ |
| [295](#L295) | private function get\_widget\_blocks() { |
| [296](#L296) | return parse\_blocks( |
| [297](#L297) | array\_reduce( |
| [298](#L298) | get\_option( 'widget\_block', array() ), |
| [299](#L299) | function ( $acc, $curr ) { |
| [300](#L300) | if ( ! empty( $curr['content'] ) ) { |
| [301](#L301) | $acc .= $curr['content']; |
| [302](#L302) | } |
| [303](#L303) | return $acc; |
| [304](#L304) | }, |
| [305](#L305) | '' |
| [306](#L306) | ) |
| [307](#L307) | ); |
| [308](#L308) | } |
| [309](#L309) |  |
| [310](#L310) | /\*\* |
| [311](#L311) | \* Regenerate block styles. |
| [312](#L312) | \* |
| [313](#L313) | \* @return void |
| [314](#L314) | \*/ |
| [315](#L315) | public function regenerate\_block\_styles() { |
| [316](#L316) | delete\_option( '\_magazine\_blocks\_blocks\_css' ); |
| [317](#L317) | delete\_post\_meta\_by\_key( '\_magazine\_blocks\_blocks\_css' ); |
| [318](#L318) |  |
| [319](#L319) | $filesystem = magazine\_blocks\_get\_filesystem(); |
| [320](#L320) |  |
| [321](#L321) | if ( $filesystem ) { |
| [322](#L322) | $filesystem->delete( MAGAZINE\_BLOCKS\_UPLOAD\_DIR, true ); |
| [323](#L323) | } |
| [324](#L324) | } |
| [325](#L325) | } |
| [326](#L326) |  |
| [327](#L327) | /\*\* |
| [328](#L328) | \* Custom pagination function to generate numbered pagination links. |
| [329](#L329) | \* |
| [330](#L330) | \* @param int $max\_num\_pages The total number of pages. |
| [331](#L331) | \* @param int $current\_page  The current page number. |
| [332](#L332) | \* @return string The HTML for numbered pagination links. |
| [333](#L333) | \*/ |
| [334](#L334) | function mzb\_numbered\_pagination( $max\_num\_pages, $current\_page, $client\_id, $range = 2 ) { |
| [335](#L335) | $pagination = ''; |
| [336](#L336) |  |
| [337](#L337) | if ( $max\_num\_pages > 1 ) { |
| [338](#L338) | $pagination .= '<ul class="mzb-pagination-numbers">'; |
| [339](#L339) |  |
| [340](#L340) | // Previous Arrow |
| [341](#L341) | if ( $current\_page > 1 ) { |
| [342](#L342) | $prev\_page   = $current\_page - 1; |
| [343](#L343) | $pagination .= '<li class="page-item prev"><a class="page-link" href="' . add\_query\_arg( 'block\_id\_' . $client\_id, $prev\_page ) . '"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="17" viewBox="0 0 16 17" fill="none"> |
| [344](#L344) | <path d="M14.0002 7.9622H3.60683L8.4735 3.1022C8.53566 3.04004 8.58496 2.96625 8.6186 2.88503C8.65224 2.80382 8.66956 2.71677 8.66956 2.62887C8.66956 2.54096 8.65224 2.45392 8.6186 2.3727C8.58496 2.29149 8.53566 2.21769 8.4735 2.15553C8.41134 2.09337 8.33754 2.04407 8.25633 2.01043C8.17511 1.97679 8.08807 1.95947 8.00016 1.95947C7.82263 1.95947 7.65237 2.03 7.52683 2.15553L1.52683 8.15553C1.46509 8.21811 1.41737 8.2931 1.38683 8.37553C1.35267 8.45568 1.33455 8.54175 1.3335 8.62887C1.33516 8.71807 1.35324 8.80621 1.38683 8.88887C1.42086 8.96552 1.46827 9.0355 1.52683 9.09553L7.52683 15.0955C7.5888 15.158 7.66254 15.2076 7.74378 15.2415C7.82502 15.2753 7.91216 15.2927 8.00016 15.2927C8.08817 15.2927 8.17531 15.2753 8.25655 15.2415C8.33779 15.2076 8.41152 15.158 8.4735 15.0955C8.53598 15.0336 8.58558 14.9598 8.61942 14.8786C8.65327 14.7973 8.6707 14.7102 8.6707 14.6222C8.6707 14.5342 8.65327 14.4471 8.61942 14.3658C8.58558 14.2846 8.53598 14.2108 8.4735 14.1489L3.60683 9.29553H14.0002C14.177 9.29553 14.3465 9.2253 14.4716 9.10027C14.5966 8.97525 14.6668 8.80568 14.6668 8.62887C14.6668 8.45206 14.5966 8.28249 14.4716 8.15746C14.3465 8.03244 14.177 7.9622 14.0002 7.9622Z" fill="#3F3F46"/> |
| [345](#L345) | </svg></a></li>'; |
| [346](#L346) | } |
| [347](#L347) |  |
| [348](#L348) | // Always display the first page |
| [349](#L349) | $pagination .= '<li class="page-item' . ( $current\_page === 1 ? ' current' : '' ) . '"><a class="page-link" href="' . add\_query\_arg( 'block\_id\_' . $client\_id, 1 ) . '">1</a></li>'; |
| [350](#L350) |  |
| [351](#L351) | // Start ellipsis |
| [352](#L352) | if ( $current\_page > ( $range + 2 ) ) { |
| [353](#L353) | $pagination .= '<li class="page-item ellipsis">...</li>'; |
| [354](#L354) | } |
| [355](#L355) |  |
| [356](#L356) | for ( $i = max( 2, $current\_page - $range ); $i <= min( $max\_num\_pages - 1, $current\_page + $range ); $i++ ) { |
| [357](#L357) | $class       = ( $i === $current\_page ) ? ' current' : ''; |
| [358](#L358) | $pagination .= '<li class="page-item' . $class . '"><a class="page-link" href="' . add\_query\_arg( 'block\_id\_' . $client\_id, $i ) . '">' . $i . '</a></li>'; |
| [359](#L359) | } |
| [360](#L360) |  |
| [361](#L361) | // End ellipsis |
| [362](#L362) | if ( $current\_page < ( $max\_num\_pages - $range - 1 ) ) { |
| [363](#L363) | $pagination .= '<li class="page-item ellipsis">...</li>'; |
| [364](#L364) | } |
| [365](#L365) |  |
| [366](#L366) | // Always display the last page |
| [367](#L367) | $pagination .= '<li class="page-item' . ( $current\_page === $max\_num\_pages ? ' current' : '' ) . '"><a class="page-link" href="' . add\_query\_arg( 'block\_id\_' . $client\_id, $max\_num\_pages ) . '">' . $max\_num\_pages . '</a></li>'; |
| [368](#L368) |  |
| [369](#L369) | // Next Arrow |
| [370](#L370) | if ( $current\_page < $max\_num\_pages ) { |
| [371](#L371) | $next\_page   = $current\_page + 1; |
| [372](#L372) | $pagination .= '<li class="page-item next"><a class="page-link" href="' . add\_query\_arg( 'block\_id\_' . $client\_id, $next\_page ) . '"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="17" viewBox="0 0 16 17" fill="none"> |
| [373](#L373) | <path d="M2.00016 7.9622H12.3935L7.52683 3.1022C7.40129 2.97666 7.33077 2.8064 7.33077 2.62887C7.33077 2.54096 7.34808 2.45392 7.38172 2.3727C7.41536 2.29149 7.46467 2.21769 7.52683 2.15553C7.58899 2.09337 7.66278 2.04407 7.744 2.01043C7.82521 1.97679 7.91226 1.95947 8.00016 1.95947C8.1777 1.95947 8.34796 2.03 8.4735 2.15553L14.4735 8.15553C14.5352 8.21811 14.583 8.2931 14.6135 8.37553C14.6477 8.45568 14.6658 8.54175 14.6668 8.62887C14.6652 8.71807 14.6471 8.80621 14.6135 8.88887C14.5795 8.96552 14.5321 9.0355 14.4735 9.09553L8.4735 15.0955C8.41152 15.158 8.33779 15.2076 8.25655 15.2415C8.17531 15.2753 8.08817 15.2927 8.00016 15.2927C7.91216 15.2927 7.82502 15.2753 7.74378 15.2415C7.66254 15.2076 7.5888 15.158 7.52683 15.0955C7.46434 15.0336 7.41475 14.9598 7.3809 14.8786C7.34706 14.7973 7.32963 14.7102 7.32963 14.6222C7.32963 14.5342 7.34706 14.4471 7.3809 14.3658C7.41475 14.2846 7.46434 14.2108 7.52683 14.1489L12.3935 9.29553H2.00016C1.82335 9.29553 1.65378 9.2253 1.52876 9.10027C1.40373 8.97525 1.3335 8.80568 1.3335 8.62887C1.3335 8.45206 1.40373 8.28249 1.52876 8.15746C1.65378 8.03244 1.82335 7.9622 2.00016 7.9622Z" fill="#3F3F46"/> |
| [374](#L374) | </svg></a></li>'; |
| [375](#L375) | } |
| [376](#L376) |  |
| [377](#L377) | $pagination .= '</ul>'; |
| [378](#L378) | } |
| [379](#L379) |  |
| [380](#L380) | return $pagination; |
| [381](#L381) | } |

**Note:** See [TracBrowser](/wiki/TracBrowser)
for help on using the repository browser.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Plain Text](/browser/magazine-blocks/tags/1.3.14/includes/Blocks.php?format=txt)
* [Original Format](/export/3220381/magazine-blocks/tags/1.3.14/includes/Blocks.php)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)

