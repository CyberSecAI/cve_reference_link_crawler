```
{
  "vulnerability_details": {
    "root_cause": "The K3s apiserver/supervisor listener on port TCP 6443 uses the `rancher/dynamiclistener` library to dynamically generate TLS certificates that contain Subject Alternative Names (SAN) for any hostname or IP address requested by a client. This is intended to allow servers and external load balancers to be added to the cluster without pre-configured endpoints. However, there was no filtering of requested addresses in K3s.",
    "weaknesses": [
      "Lack of filtering of requested addresses in the TLS SAN list generation process."
    ],
    "impact": "An attacker can cause a denial of service (DoS) by repeatedly sending requests that force the TLS server to add entries to the certificate's Subject Alternative Name (SAN) list. This causes the certificate to grow so large that it exceeds the maximum size allowed by TLS client implementations. Clients will then fail to establish new connections, thus denying service.",
    "attack_vectors": "Network access to the K3s server's apiserver/supervisor port (TCP 6443) is required.",
    "required_attacker_capabilities": "An attacker needs the ability to perform a TLS handshake against the apiserver/supervisor port (TCP 6443). No authentication is required."
  },
  "affected_versions": [
    "< v1.24.17+k3s1",
    "< v1.25.13+k3s1",
    "< v1.26.8+k3s1",
    "< v1.27.5+k3s1",
    "< v1.28.1+k3s1"
  ],
  "patched_versions": [
    "v1.24.17+k3s1",
    "v1.25.13+k3s1",
     "v1.26.8+k3s1",
    "v1.27.5+k3s1",
    "v1.28.1+k3s1"
  ],
    "remediation": "Upgrade to a patched version. For K3s 1.27 or earlier, add `tls-san-security: true` to the K3s configuration to enable enhanced security for the supervisor's TLS SAN list. Configure `node-external-ip` on servers and add `tls-san` entries for any load-balancers or VIP addresses.",
    "mitigation": "The certificate can be 'frozen' by running `kubectl annotate secret -n kube-system k3s-serving listener.cattle.io/static=true`. However, this prevents adding new SAN entries and automatic renewal, requiring manual intervention for new servers or certificate expiration."
}
```