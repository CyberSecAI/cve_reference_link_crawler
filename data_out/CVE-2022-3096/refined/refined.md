- **Root cause of vulnerability**: The WordPress plugin "WP Total Hacks" does not prevent low-privilege users (like subscribers) from modifying the plugin's settings.
- **Weaknesses/vulnerabilities present**:
  - **Broken Access Control**: Low-privileged users can modify plugin settings, which should be restricted to higher-privilege users like administrators.
  - **Stored Cross-Site Scripting (XSS)**: Due to lack of sanitization and escaping, a malicious script can be injected into the plugin's settings via a crafted POST request and stored. This script can then be executed when other users (e.g. administrators) view the affected settings page.
- **Impact of exploitation**: A successful attack allows a low-privilege user to execute arbitrary JavaScript code in the context of other users who access the settings page, potentially leading to session hijacking, defacement, or other malicious actions.
- **Attack vectors**:
  - The attacker sends a crafted POST request to the WordPress admin panel with modified plugin settings that contain a malicious script.
- **Required attacker capabilities/position**:
    - The attacker must have a low-privilege user account (e.g., subscriber) on the vulnerable WordPress site.
    - The attacker needs to be able to send a POST request to the WordPress admin panel.