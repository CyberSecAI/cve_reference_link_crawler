
[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fgolang%2Fgo%2Fissues%2F65065)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fgolang%2Fgo%2Fissues%2F65065)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=golang%2Fgo)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[golang](/golang)
/
**[go](/golang/go)**
Public

* [Notifications](/login?return_to=%2Fgolang%2Fgo) You must be signed in to change notification settings
* [Fork
  17.8k](/login?return_to=%2Fgolang%2Fgo)
* [Star
   125k](/login?return_to=%2Fgolang%2Fgo)

* [Code](/golang/go)
* [Issues
  5k+](/golang/go/issues)
* [Pull requests
  508](/golang/go/pulls)
* [Discussions](/golang/go/discussions)
* [Actions](/golang/go/actions)
* [Projects
  4](/golang/go/projects)
* [Wiki](/golang/go/wiki)
* [Security](/golang/go/security)
* [Insights](/golang/go/pulse)

Additional navigation options

* [Code](/golang/go)
* [Issues](/golang/go/issues)
* [Pull requests](/golang/go/pulls)
* [Discussions](/golang/go/discussions)
* [Actions](/golang/go/actions)
* [Projects](/golang/go/projects)
* [Wiki](/golang/go/wiki)
* [Security](/golang/go/security)
* [Insights](/golang/go/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fgolang%2Fgo%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fgolang%2Fgo%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# net/http, net/http/cookiejar: incorrect forwarding of sensitive headers and cookies on HTTP redirect [CVE-2023-45289] #65065

Closed

[neild](/neild) opened this issue
Jan 11, 2024
· 5 comments

Closed

# [net/http, net/http/cookiejar: incorrect forwarding of sensitive headers and cookies on HTTP redirect [CVE-2023-45289]](#top) #65065

[neild](/neild) opened this issue
Jan 11, 2024
· 5 comments

Assignees
[![@neild](https://avatars.githubusercontent.com/u/52544?s=40&v=4)](/neild)

Labels
[release-blocker](/golang/go/labels/release-blocker)
[Security](/golang/go/labels/Security)

Milestone
[Go1.23](/golang/go/milestone/212 "Go1.23")

## Comments

[![@neild](https://avatars.githubusercontent.com/u/52544?s=80&u=41bff20219d93918578944360c3930f30df4693b&v=4)](/neild)

Copy link

Contributor

### **[neild](/neild)** commented [Jan 11, 2024](#issue-2077455269) • edited by mknyszek Loading

| When following an HTTP redirect to a domain which is not a subdomain match or exact match of the initial domain, an http.Client does not forward sensitive headers such as "Authorization" or "Cookie". For example, a redirect from foo.com to [www.foo.com](http://www.foo.com) will forward the Authorization header, but a redirect to bar.com will not.  A maliciously crafted HTTP redirect could cause sensitive headers to be unexpectedly forwarded.  Thanks to Juho Nurminen of Mattermost for reporting this issue. This is [CVE-2023-45289](https://github.com/advisories/GHSA-32ch-6x54-q4h9 "CVE-2023-45289").  /cc @golang/security and @golang/release |
| --- |
| The text was updated successfully, but these errors were encountered: |

All reactions

[![@neild](https://avatars.githubusercontent.com/u/52544?s=40&u=41bff20219d93918578944360c3930f30df4693b&v=4)](/neild)
[neild](/neild)
added
[Security](/golang/go/labels/Security)
[release-blocker](/golang/go/labels/release-blocker)
labels
[Jan 11, 2024](#event-11460824380)

[![@neild](https://avatars.githubusercontent.com/u/52544?s=40&u=41bff20219d93918578944360c3930f30df4693b&v=4)](/neild)
[neild](/neild)
self-assigned this
[Jan 11, 2024](#event-11460824440)

[![@neild](https://avatars.githubusercontent.com/u/52544?s=40&u=41bff20219d93918578944360c3930f30df4693b&v=4)](/neild)
[neild](/neild)
added this to the [Go1.22](/golang/go/milestone/298) milestone
[Jan 11, 2024](#event-11460845708)

[![@neild](https://avatars.githubusercontent.com/u/52544?s=80&u=41bff20219d93918578944360c3930f30df4693b&v=4)](/neild)

Copy link

Contributor

Author

### **[neild](/neild)** commented [Jan 30, 2024](#issuecomment-1917986223)

| [@gopherbot](https://github.com/gopherbot) please open backport issues for this security fix. |
| --- |

All reactions

Sorry, something went wrong.

This was referenced Jan 30, 2024

[security: fix CVE-2023-45289 [1.20 backport]
#65384](/golang/go/issues/65384)

Closed

[security: fix CVE-2023-45289 [1.21 backport]
#65385](/golang/go/issues/65385)

Closed

[![@gopherbot](https://avatars.githubusercontent.com/u/8566911?s=80&u=be84be2341a1a28dc2ede61150f7ceaaf470b8ba&v=4)](/gopherbot)

Copy link

Contributor

### **[gopherbot](/gopherbot)** commented [Jan 30, 2024](#issuecomment-1917986509)

| Backport issue(s) opened: [#65384](https://github.com/golang/go/issues/65384) (for 1.20), [#65385](https://github.com/golang/go/issues/65385) (for 1.21).  Remember to create the cherry-pick CL(s) as soon as the patch is submitted to master, according to <https://go.dev/wiki/MinorReleases>. |
| --- |

All reactions

Sorry, something went wrong.

[![@mknyszek](https://avatars.githubusercontent.com/u/1248668?s=40&u=43d1280f5d30cfd450e4b47693153b22a86ec893&v=4)](/mknyszek)
[mknyszek](/mknyszek)
modified the milestones:
[Go1.22](/golang/go/milestone/298),
[Go1.23](/golang/go/milestone/212)
[Feb 2, 2024](#event-11687598979)

[![@neild](https://avatars.githubusercontent.com/u/52544?s=40&u=41bff20219d93918578944360c3930f30df4693b&v=4)](/neild)
[neild](/neild)
mentioned this issue
[Feb 21, 2024](#ref-issue-2147826927)

[security: fix CVE-2023-45289 [1.22 backport]
#65859](/golang/go/issues/65859)

Closed

[![@gopherbot](https://avatars.githubusercontent.com/u/8566911?s=80&u=be84be2341a1a28dc2ede61150f7ceaaf470b8ba&v=4)](/gopherbot)

Copy link

Contributor

### **[gopherbot](/gopherbot)** commented [Mar 5, 2024](#issuecomment-1979103872)

| Change <https://go.dev/cl/569236> mentions this issue: `[release-branch.go1.22] net/http, net/http/cookiejar: avoid subdomain matches on IPv6 zones` |
| --- |

All reactions

Sorry, something went wrong.

[![@gopherbot](https://avatars.githubusercontent.com/u/8566911?s=80&u=be84be2341a1a28dc2ede61150f7ceaaf470b8ba&v=4)](/gopherbot)

Copy link

Contributor

### **[gopherbot](/gopherbot)** commented [Mar 5, 2024](#issuecomment-1979103919)

| Change <https://go.dev/cl/569239> mentions this issue: `[release-branch.go1.21] net/http, net/http/cookiejar: avoid subdomain matches on IPv6 zones` |
| --- |

All reactions

Sorry, something went wrong.

[gopherbot](/gopherbot)
pushed a commit
that referenced
this issue
[Mar 5, 2024](#ref-commit-3a85520)
[![@neild](https://avatars.githubusercontent.com/u/52544?s=40&u=41bff20219d93918578944360c3930f30df4693b&v=4)](/neild) [![@gopherbot](https://avatars.githubusercontent.com/u/8566911?s=40&v=4)](/gopherbot)

`[[release-branch.go1.22] net/http, net/http/cookiejar: avoid subdomain…](/golang/go/commit/3a855208e3efed2e9d7c20ad023f1fa78afcc0be "[release-branch.go1.22] net/http, net/http/cookiejar: avoid subdomain matches on IPv6 zones

When deciding whether to forward cookies or sensitive headers
across a redirect, do not attempt to interpret an IPv6 address
as a domain name.

Avoids a case where a maliciously-crafted redirect to an
IPv6 address with a scoped addressing zone could be
misinterpreted as a within-domain redirect. For example,
we could interpret \"::1%.www.example.com\" as a subdomain
of \"www.example.com\".

Thanks to Juho Nurminen of Mattermost for reporting this issue.

Fixes CVE-2023-45289
Fixes #65859
For #65065

Change-Id: I8f463f59f0e700c8a18733d2b264a8bcb3a19599
Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/2131938
Reviewed-by: Tatiana Bradley <tatianabradley@google.com>
Reviewed-by: Roland Shoemaker <bracewell@google.com>
Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/2174344
Reviewed-by: Carlos Amedee <amedee@google.com>
Reviewed-on: https://go-review.googlesource.com/c/go/+/569236
Reviewed-by: Carlos Amedee <carlos@golang.org>
LUCI-TryBot-Result: Go LUCI <golang-scoped@luci-project-accounts.iam.gserviceaccount.com>
Auto-Submit: Michael Knyszek <mknyszek@google.com>")`
…

`[3a85520](/golang/go/commit/3a855208e3efed2e9d7c20ad023f1fa78afcc0be)`

```
… matches on IPv6 zones

When deciding whether to forward cookies or sensitive headers
across a redirect, do not attempt to interpret an IPv6 address
as a domain name.

Avoids a case where a maliciously-crafted redirect to an
IPv6 address with a scoped addressing zone could be
misinterpreted as a within-domain redirect. For example,
we could interpret "::1%.[www.example.com](http://www.example.com)" as a subdomain
of "[www.example.com](http://www.example.com)".

Thanks to Juho Nurminen of Mattermost for reporting this issue.

Fixes [CVE-2023-45289](https://github.com/advisories/GHSA-32ch-6x54-q4h9 "CVE-2023-45289")
Fixes [#65859](https://github.com/golang/go/issues/65859)
For [#65065](https://github.com/golang/go/issues/65065)

Change-Id: I8f463f59f0e700c8a18733d2b264a8bcb3a19599
Reviewed-on: [https://team-review.git.corp.google.com/c/golang/go-private/+/2131938](https://team-review.git.corp.google.com/c/golang/go-private/%2B/2131938)
Reviewed-by: Tatiana Bradley <tatianabradley@google.com>
Reviewed-by: Roland Shoemaker <bracewell@google.com>
Reviewed-on: [https://team-review.git.corp.google.com/c/golang/go-private/+/2174344](https://team-review.git.corp.google.com/c/golang/go-private/%2B/2174344)
Reviewed-by: Carlos Amedee <amedee@google.com>
Reviewed-on: [https://go-review.googlesource.com/c/go/+/569236](https://go-review.googlesource.com/c/go/%2B/569236)
Reviewed-by: Carlos Amedee <carlos@golang.org>
LUCI-TryBot-Result: Go LUCI <golang-scoped@luci-project-accounts.iam.gserviceaccount.com>
Auto-Submit: Michael Knyszek <mknyszek@google.com>
```

[gopherbot](/gopherbot)
pushed a commit
that referenced
this issue
[Mar 5, 2024](#ref-commit-20586c0)
[![@neild](https://avatars.githubusercontent.com/u/52544?s=40&u=41bff20219d93918578944360c3930f30df4693b&v=4)](/neild) [![@gopherbot](https://avatars.githubusercontent.com/u/8566911?s=40&v=4)](/gopherbot)

`[[release-branch.go1.21] net/http, net/http/cookiejar: avoid subdomain…](/golang/go/commit/20586c0dbe03d144f914155f879fa5ee287591a1 "[release-branch.go1.21] net/http, net/http/cookiejar: avoid subdomain matches on IPv6 zones

When deciding whether to forward cookies or sensitive headers
across a redirect, do not attempt to interpret an IPv6 address
as a domain name.

Avoids a case where a maliciously-crafted redirect to an
IPv6 address with a scoped addressing zone could be
misinterpreted as a within-domain redirect. For example,
we could interpret \"::1%.www.example.com\" as a subdomain
of \"www.example.com\".

Thanks to Juho Nurminen of Mattermost for reporting this issue.

Fixes CVE-2023-45289
Fixes #65385
For #65065

Change-Id: I8f463f59f0e700c8a18733d2b264a8bcb3a19599
Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/2131938
Reviewed-by: Tatiana Bradley <tatianabradley@google.com>
Reviewed-by: Roland Shoemaker <bracewell@google.com>
Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/2173775
Reviewed-by: Carlos Amedee <amedee@google.com>
Reviewed-on: https://go-review.googlesource.com/c/go/+/569239
Reviewed-by: Carlos Amedee <carlos@golang.org>
Auto-Submit: Michael Knyszek <mknyszek@google.com>
TryBot-Bypass: Michael Knyszek <mknyszek@google.com>")`
…

`[20586c0](/golang/go/commit/20586c0dbe03d144f914155f879fa5ee287591a1)`

```
… matches on IPv6 zones

When deciding whether to forward cookies or sensitive headers
across a redirect, do not attempt to interpret an IPv6 address
as a domain name.

Avoids a case where a maliciously-crafted redirect to an
IPv6 address with a scoped addressing zone could be
misinterpreted as a within-domain redirect. For example,
we could interpret "::1%.[www.example.com](http://www.example.com)" as a subdomain
of "[www.example.com](http://www.example.com)".

Thanks to Juho Nurminen of Mattermost for reporting this issue.

Fixes [CVE-2023-45289](https://github.com/advisories/GHSA-32ch-6x54-q4h9 "CVE-2023-45289")
Fixes [#65385](https://github.com/golang/go/issues/65385)
For [#65065](https://github.com/golang/go/issues/65065)

Change-Id: I8f463f59f0e700c8a18733d2b264a8bcb3a19599
Reviewed-on: [https://team-review.git.corp.google.com/c/golang/go-private/+/2131938](https://team-review.git.corp.google.com/c/golang/go-private/%2B/2131938)
Reviewed-by: Tatiana Bradley <tatianabradley@google.com>
Reviewed-by: Roland Shoemaker <bracewell@google.com>
Reviewed-on: [https://team-review.git.corp.google.com/c/golang/go-private/+/2173775](https://team-review.git.corp.google.com/c/golang/go-private/%2B/2173775)
Reviewed-by: Carlos Amedee <amedee@google.com>
Reviewed-on: [https://go-review.googlesource.com/c/go/+/569239](https://go-review.googlesource.com/c/go/%2B/569239)
Reviewed-by: Carlos Amedee <carlos@golang.org>
Auto-Submit: Michael Knyszek <mknyszek@google.com>
TryBot-Bypass: Michael Knyszek <mknyszek@google.com>
```

[![@mknyszek](https://avatars.githubusercontent.com/u/1248668?s=40&u=43d1280f5d30cfd450e4b47693153b22a86ec893&v=4)](/mknyszek)
[mknyszek](/mknyszek)
changed the title
~~security: fix CVE-2023-45289~~
net/http, net/http/cookiejar: incorrect forwarding of sensitive headers and cookies on HTTP redirect [CVE-2023-45289]
[Mar 5, 2024](#event-12017745653)

[bradfitz](/bradfitz)
pushed a commit
to tailscale/go
that referenced
this issue
[Mar 5, 2024](#ref-commit-80f4377)
[![@neild](https://avatars.githubusercontent.com/u/52544?s=40&u=41bff20219d93918578944360c3930f30df4693b&v=4)](/neild) [![@bradfitz](https://avatars.githubusercontent.com/u/2621?s=40&v=4)](/bradfitz)

`[[release-branch.go1.22] net/http, net/http/cookiejar: avoid subdomain…](/tailscale/go/commit/80f43772c4837547522905ebc5f8853d509ba8da "[release-branch.go1.22] net/http, net/http/cookiejar: avoid subdomain matches on IPv6 zones

When deciding whether to forward cookies or sensitive headers
across a redirect, do not attempt to interpret an IPv6 address
as a domain name.

Avoids a case where a maliciously-crafted redirect to an
IPv6 address with a scoped addressing zone could be
misinterpreted as a within-domain redirect. For example,
we could interpret \"::1%.www.example.com\" as a subdomain
of \"www.example.com\".

Thanks to Juho Nurminen of Mattermost for reporting this issue.

Fixes CVE-2023-45289
Fixes #65859
For #65065

Change-Id: I8f463f59f0e700c8a18733d2b264a8bcb3a19599
Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/2131938
Reviewed-by: Tatiana Bradley <tatianabradley@google.com>
Reviewed-by: Roland Shoemaker <bracewell@google.com>
Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/2174344
Reviewed-by: Carlos Amedee <amedee@google.com>
Reviewed-on: https://go-review.googlesource.com/c/go/+/569236
Reviewed-by: Carlos Amedee <carlos@golang.org>
LUCI-TryBot-Result: Go LUCI <golang-scoped@luci-project-accounts.iam.gserviceaccount.com>
Auto-Submit: Michael Knyszek <mknyszek@google.com>")`
…

`[80f4377](/tailscale/go/commit/80f43772c4837547522905ebc5f8853d509ba8da)`

```
… matches on IPv6 zones

When deciding whether to forward cookies or sensitive headers
across a redirect, do not attempt to interpret an IPv6 address
as a domain name.

Avoids a case where a maliciously-crafted redirect to an
IPv6 address with a scoped addressing zone could be
misinterpreted as a within-domain redirect. For example,
we could interpret "::1%.[www.example.com](http://www.example.com)" as a subdomain
of "[www.example.com](http://www.example.com)".

Thanks to Juho Nurminen of Mattermost for reporting this issue.

Fixes [CVE-2023-45289](https://github.com/advisories/GHSA-32ch-6x54-q4h9 "CVE-2023-45289")
Fixes [golang#65859](https://github.com/golang/go/issues/65859)
For [golang#65065](https://github.com/golang/go/issues/65065)

Change-Id: I8f463f59f0e700c8a18733d2b264a8bcb3a19599
Reviewed-on: [https://team-review.git.corp.google.com/c/golang/go-private/+/2131938](https://team-review.git.corp.google.com/c/golang/go-private/%2B/2131938)
Reviewed-by: Tatiana Bradley <tatianabradley@google.com>
Reviewed-by: Roland Shoemaker <bracewell@google.com>
Reviewed-on: [https://team-review.git.corp.google.com/c/golang/go-private/+/2174344](https://team-review.git.corp.google.com/c/golang/go-private/%2B/2174344)
Reviewed-by: Carlos Amedee <amedee@google.com>
Reviewed-on: [https://go-review.googlesource.com/c/go/+/569236](https://go-review.googlesource.com/c/go/%2B/569236)
Reviewed-by: Carlos Amedee <carlos@golang.org>
LUCI-TryBot-Result: Go LUCI <golang-scoped@luci-project-accounts.iam.gserviceaccount.com>
Auto-Submit: Michael Knyszek <mknyszek@google.com>
```

[![@gopherbot](https://avatars.githubusercontent.com/u/8566911?s=80&u=be84be2341a1a28dc2ede61150f7ceaaf470b8ba&v=4)](/gopherbot)

Copy link

Contributor

### **[gopherbot](/gopherbot)** commented [Mar 5, 2024](#issuecomment-1979358952)

| Change <https://go.dev/cl/569340> mentions this issue: `net/http, net/http/cookiejar: avoid subdomain matches on IPv6 zones` |
| --- |

All reactions

Sorry, something went wrong.

[![@gopherbot](https://avatars.githubusercontent.com/u/8566911?s=40&u=be84be2341a1a28dc2ede61150f7ceaaf470b8ba&v=4)](/gopherbot)
[gopherbot](/gopherbot)
closed this as [completed](/golang/go/issues?q=is%3Aissue+is%3Aclosed+archived%3Afalse+reason%3Acompleted)
in
`[821bf37](/golang/go/commit/821bf37819ec170cadbc9e44a7471f7613611c41)`
[Mar 5, 2024](#event-12018132530)

[romaindoumenc](/romaindoumenc)
pushed a commit
to TroutSoftware/go
that referenced
this issue
[Mar 6, 2024](#ref-commit-553fe12)
[![@neild](https://avatars.githubusercontent.com/u/52544?s=40&u=41bff20219d93918578944360c3930f30df4693b&v=4)](/neild) [![@romaindoumenc](https://avatars.githubusercontent.com/u/4268844?s=40&v=4)](/romaindoumenc)

`[[release-branch.go1.22] net/http, net/http/cookiejar: avoid subdomain…](/TroutSoftware/go/commit/553fe122f0bebb68251206476fc58730fdcbab0a "[release-branch.go1.22] net/http, net/http/cookiejar: avoid subdomain matches on IPv6 zones

When deciding whether to forward cookies or sensitive headers
across a redirect, do not attempt to interpret an IPv6 address
as a domain name.

Avoids a case where a maliciously-crafted redirect to an
IPv6 address with a scoped addressing zone could be
misinterpreted as a within-domain redirect. For example,
we could interpret \"::1%.www.example.com\" as a subdomain
of \"www.example.com\".

Thanks to Juho Nurminen of Mattermost for reporting this issue.

Fixes CVE-2023-45289
Fixes #65859
For #65065

Change-Id: I8f463f59f0e700c8a18733d2b264a8bcb3a19599
Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/2131938
Reviewed-by: Tatiana Bradley <tatianabradley@google.com>
Reviewed-by: Roland Shoemaker <bracewell@google.com>
Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/2174344
Reviewed-by: Carlos Amedee <amedee@google.com>
Reviewed-on: https://go-review.googlesource.com/c/go/+/569236
Reviewed-by: Carlos Amedee <carlos@golang.org>
LUCI-TryBot-Result: Go LUCI <golang-scoped@luci-project-accounts.iam.gserviceaccount.com>
Auto-Submit: Michael Knyszek <mknyszek@google.com>")`
…

`[553fe12](/TroutSoftware/go/commit/553fe122f0bebb68251206476fc58730fdcbab0a)`

```
… matches on IPv6 zones

When deciding whether to forward cookies or sensitive headers
across a redirect, do not attempt to interpret an IPv6 address
as a domain name.

Avoids a case where a maliciously-crafted redirect to an
IPv6 address with a scoped addressing zone could be
misinterpreted as a within-domain redirect. For example,
we could interpret "::1%.[www.example.com](http://www.example.com)" as a subdomain
of "[www.example.com](http://www.example.com)".

Thanks to Juho Nurminen of Mattermost for reporting this issue.

Fixes [CVE-2023-45289](https://github.com/advisories/GHSA-32ch-6x54-q4h9 "CVE-2023-45289")
Fixes [golang#65859](https://github.com/golang/go/issues/65859)
For [golang#65065](https://github.com/golang/go/issues/65065)

Change-Id: I8f463f59f0e700c8a18733d2b264a8bcb3a19599
Reviewed-on: [https://team-review.git.corp.google.com/c/golang/go-private/+/2131938](https://team-review.git.corp.google.com/c/golang/go-private/%2B/2131938)
Reviewed-by: Tatiana Bradley <tatianabradley@google.com>
Reviewed-by: Roland Shoemaker <bracewell@google.com>
Reviewed-on: [https://team-review.git.corp.google.com/c/golang/go-private/+/2174344](https://team-review.git.corp.google.com/c/golang/go-private/%2B/2174344)
Reviewed-by: Carlos Amedee <amedee@google.com>
Reviewed-on: [https://go-review.googlesource.com/c/go/+/569236](https://go-review.googlesource.com/c/go/%2B/569236)
Reviewed-by: Carlos Amedee <carlos@golang.org>
LUCI-TryBot-Result: Go LUCI <golang-scoped@luci-project-accounts.iam.gserviceaccount.com>
Auto-Submit: Michael Knyszek <mknyszek@google.com>
```

[![@rhamzeh](https://avatars.githubusercontent.com/u/536147?s=40&v=4)](/rhamzeh)
[rhamzeh](/rhamzeh)
mentioned this issue
[May 4, 2024](#ref-issue-2278656216)

[Why the specific dependency on Go `1.21.9`?
openfga/go-sdk#94](/openfga/go-sdk/issues/94)

Closed

6 tasks

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fgolang%2Fgo%2Fissues%2F65065)

Assignees

[![@neild](https://avatars.githubusercontent.com/u/52544?s=40&v=4)](/neild) [neild](/neild)

Labels

[release-blocker](/golang/go/labels/release-blocker)
[Security](/golang/go/labels/Security)

Projects

None yet

Milestone

 [**Go1.23**](/golang/go/milestone/212 "Go1.23")

Development

No branches or pull requests

3 participants

[![@neild](https://avatars.githubusercontent.com/u/52544?s=52&v=4)](/neild) [![@mknyszek](https://avatars.githubusercontent.com/u/1248668?s=52&v=4)](/mknyszek) [![@gopherbot](https://avatars.githubusercontent.com/u/8566911?s=52&v=4)](/gopherbot)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.

