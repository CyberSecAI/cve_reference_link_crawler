The provided content is related to CVE-2024-27099.

**Root cause of vulnerability:**
The vulnerability stems from a double free error in the uAMQP library. This occurs when the library attempts to free the same memory location twice while processing an incorrect "AMQP_VALUE" failed state, typically triggered by a failed memory allocation due to low memory conditions.

**Weaknesses/vulnerabilities present:**
- Double free vulnerability in the `link.c` file of the `azure-uamqp-c` library.
- Improper handling of failed memory allocation scenarios.

**Impact of exploitation:**
- Potential remote code execution (RCE) on the affected device. This occurs due to memory corruption caused by the double free.

**Attack vectors:**
- Network-based attack: Malformed payloads sent to the device via the IoT Hub service can trigger the vulnerability.

**Required attacker capabilities/position:**
- The attacker needs a compromised Azure account to send malformed payloads via the IoT Hub service.
- The targeted device needs to experience low memory conditions to trigger the memory allocation failure that leads to the double free.
- The attacker needs the ability to overwrite code space with remote code to achieve RCE.

**Additional details:**
- The vulnerability affects versions of the `azure-uamqp-c` library prior to February 8, 2024.
- The patch for this vulnerability is located in commit `2ca42b6`.
- The vulnerability is rated as "Moderate" with a CVSS score of 6.0.
- The CVSSv3 base metrics are AV:N/AC:H/PR:H/UI:R/S:U/C:H/I:H/A:L.
- The code changes related to the fix are in `src/link.c` and the addition of new test cases in `tests/link_ut`.