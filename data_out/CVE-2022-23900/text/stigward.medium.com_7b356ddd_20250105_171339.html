[Open in app](https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F51988f6f15df&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderUser&source=---top_nav_layout_nav----------------------------------)

Sign up

[Sign in](https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Fstigward.medium.com%2Fwavlink-command-injection-cve-2022-23900-51988f6f15df&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

[Write](https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---top_nav_layout_nav-----------------------new_post_topnav-----------)

Sign up

[Sign in](https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Fstigward.medium.com%2Fwavlink-command-injection-cve-2022-23900-51988f6f15df&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

![](https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png)

Member-only story

# Wavlink Command Injection (CVE-2022–23900)

## Your Router Is My Router

[![Stigward](https://miro.medium.com/v2/resize:fill:88:88/1*_WlrSZLEATpQrAJpRB7O0A.png)](/?source=post_page---byline--51988f6f15df--------------------------------)

[Stigward](/?source=post_page---byline--51988f6f15df--------------------------------)

·

[Follow](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F9bf043ed960e&operation=register&redirect=https%3A%2F%2Fstigward.medium.com%2Fwavlink-command-injection-cve-2022-23900-51988f6f15df&user=Stigward&userId=9bf043ed960e&source=post_page-9bf043ed960e--byline--51988f6f15df---------------------post_header-----------)

5 min read·Apr 6, 2022

--

1

Share

# TL/DR:

The [Wavlink WL-WN531P3 router](https://www.amazon.com/Wireless-Touchlink-Beamforming-High-Gain-Connections/dp/B07WNV36B2) exposes an API endpoint susceptible to command injection. This API endpoint is reachable without an authentication header, meaning the vulnerability can be exploited by an unauthenticated attacker. Furthermore, the router has no CSRF protection, thus RCE can be achieved without connecting to the local network.

# Vulnerability Description and Discovery:

The router hosts an API that is used to accept requests made from within the Admin portal. One thing a user can do from within this portal is send a `ping` command. An example has been included below:

![]()

Because `ping` is a well-known bash command, we may immediately begin to theorize about the possibility of command injection.

## Command Injection Explanation:

For those unfamiliar with command injection, here is a quick rundown:

Let’s take the above `ping` functionality and walk through what could be happening between the web portal and the router.

1. You as the user input the IP you wish to ping.
2. The Admin portal sends a request to the router with the IP you specified.

--

--

1

[![Stigward](https://miro.medium.com/v2/resize:fill:96:96/1*_WlrSZLEATpQrAJpRB7O0A.png)](/?source=post_page---post_author_info--51988f6f15df--------------------------------)[![Stigward](https://miro.medium.com/v2/resize:fill:128:128/1*_WlrSZLEATpQrAJpRB7O0A.png)](/?source=post_page---post_author_info--51988f6f15df--------------------------------)Follow[## Written by Stigward](/?source=post_page---post_author_info--51988f6f15df--------------------------------)[26 Followers](/followers?source=post_page---post_author_info--51988f6f15df--------------------------------)·[4 Following](/following?source=post_page---post_author_info--51988f6f15df--------------------------------)

Average hacker and chronic side-project abandoner.

Follow
## Responses (1)

See all responses[Help](https://help.medium.com/hc/en-us?source=post_page-----51988f6f15df--------------------------------)[Status](https://medium.statuspage.io/?source=post_page-----51988f6f15df--------------------------------)[About](https://medium.com/about?autoplay=1&source=post_page-----51988f6f15df--------------------------------)[Careers](https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=post_page-----51988f6f15df--------------------------------)[Press](pressinquiries%40medium.com?source=post_page-----51988f6f15df--------------------------------)[Blog](https://blog.medium.com/?source=post_page-----51988f6f15df--------------------------------)[Privacy](https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----51988f6f15df--------------------------------)[Terms](https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----51988f6f15df--------------------------------)[Text to speech](https://speechify.com/medium?source=post_page-----51988f6f15df--------------------------------)[Teams](https://medium.com/business?source=post_page-----51988f6f15df--------------------------------)

