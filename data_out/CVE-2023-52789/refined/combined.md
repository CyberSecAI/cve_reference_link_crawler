=== Content from git.kernel.org_9fb08473_20250111_042734.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=909963e0c16778cec28efb1affc21558825f4200)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=909963e0c16778cec28efb1affc21558825f4200)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=909963e0c16778cec28efb1affc21558825f4200)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=909963e0c16778cec28efb1affc21558825f4200)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Yi Yang <yiyang13@huawei.com> | 2023-09-04 11:52:20 +0800 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2023-11-28 16:46:32 +0000 |
| commit | [909963e0c16778cec28efb1affc21558825f4200](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=909963e0c16778cec28efb1affc21558825f4200) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=909963e0c16778cec28efb1affc21558825f4200)) | |
| tree | [d23be8dcd5da914df31e566677fc730579b59dea](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=909963e0c16778cec28efb1affc21558825f4200) | |
| parent | [1987b1e2eac42c1466ec13a1027757df480d8303](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=1987b1e2eac42c1466ec13a1027757df480d8303) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=909963e0c16778cec28efb1affc21558825f4200&id2=1987b1e2eac42c1466ec13a1027757df480d8303)) | |
| download | [linux-909963e0c16778cec28efb1affc21558825f4200.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-909963e0c16778cec28efb1affc21558825f4200.tar.gz) | |

tty: vcc: Add check for kstrdup() in vcc\_probe()[ Upstream commit d81ffb87aaa75f842cd7aa57091810353755b3e6 ]
Add check for the return value of kstrdup() and return the error, if it
fails in order to avoid NULL pointer dereference.
Signed-off-by: Yi Yang <yiyang13@huawei.com>
Reviewed-by: Jiri Slaby <jirislaby@kernel.org>
Link: [https://lore.kernel.org/r/20230904035220.48164-1-yiyang13@huawei.com](https://lore.kernel.org/r/20230904035220.48164-1-yiyang13%40huawei.com)
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=909963e0c16778cec28efb1affc21558825f4200)

| -rw-r--r-- | [drivers/tty/vcc.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/tty/vcc.c?id=909963e0c16778cec28efb1affc21558825f4200) | 16 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 13 insertions, 3 deletions

| diff --git a/drivers/tty/vcc.c b/drivers/tty/vcc.cindex 10a832a2135e29..31ecba11331595 100644--- a/[drivers/tty/vcc.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/tty/vcc.c?id=1987b1e2eac42c1466ec13a1027757df480d8303)+++ b/[drivers/tty/vcc.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/tty/vcc.c?id=909963e0c16778cec28efb1affc21558825f4200)@@ -586,18 +586,22 @@ static int vcc\_probe(struct vio\_dev \*vdev, const struct vio\_device\_id \*id) return -ENOMEM;  name = kstrdup(dev\_name(&vdev->dev), GFP\_KERNEL);+ if (!name) {+ rv = -ENOMEM;+ goto free\_port;+ }  rv = vio\_driver\_init(&port->vio, vdev, VDEV\_CONSOLE\_CON, vcc\_versions, ARRAY\_SIZE(vcc\_versions), NULL, name); if (rv)- goto free\_port;+ goto free\_name;  port->vio.debug = vcc\_dbg\_vio; vcc\_ldc\_cfg.debug = vcc\_dbg\_ldc;  rv = vio\_ldc\_alloc(&port->vio, &vcc\_ldc\_cfg, port); if (rv)- goto free\_port;+ goto free\_name;  spin\_lock\_init(&port->lock); @@ -631,6 +635,11 @@ static int vcc\_probe(struct vio\_dev \*vdev, const struct vio\_device\_id \*id) goto unreg\_tty; } port->domain = kstrdup(domain, GFP\_KERNEL);+ if (!port->domain) {+ rv = -ENOMEM;+ goto unreg\_tty;+ }+  mdesc\_release(hp); @@ -660,8 +669,9 @@ free\_table: vcc\_table\_remove(port->index); free\_ldc: vio\_ldc\_free(&port->vio);-free\_port:+free\_name: kfree(name);+free\_port: kfree(port);  return rv; |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 04:26:11 +0000



=== Content from git.kernel.org_03177330_20250111_042734.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=d81ffb87aaa75f842cd7aa57091810353755b3e6)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=d81ffb87aaa75f842cd7aa57091810353755b3e6)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=d81ffb87aaa75f842cd7aa57091810353755b3e6)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=d81ffb87aaa75f842cd7aa57091810353755b3e6)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Yi Yang <yiyang13@huawei.com> | 2023-09-04 11:52:20 +0800 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2023-09-18 11:14:42 +0200 |
| commit | [d81ffb87aaa75f842cd7aa57091810353755b3e6](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=d81ffb87aaa75f842cd7aa57091810353755b3e6) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=d81ffb87aaa75f842cd7aa57091810353755b3e6)) | |
| tree | [1170f1004e81c4766035981a4f404da5aaf693a1](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=d81ffb87aaa75f842cd7aa57091810353755b3e6) | |
| parent | [30e945861f3b46c4a5b25b861da40510a64cf9a4](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=30e945861f3b46c4a5b25b861da40510a64cf9a4) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=d81ffb87aaa75f842cd7aa57091810353755b3e6&id2=30e945861f3b46c4a5b25b861da40510a64cf9a4)) | |
| download | [linux-d81ffb87aaa75f842cd7aa57091810353755b3e6.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-d81ffb87aaa75f842cd7aa57091810353755b3e6.tar.gz) | |

tty: vcc: Add check for kstrdup() in vcc\_probe()Add check for the return value of kstrdup() and return the error, if it
fails in order to avoid NULL pointer dereference.
Signed-off-by: Yi Yang <yiyang13@huawei.com>
Reviewed-by: Jiri Slaby <jirislaby@kernel.org>
Link: [https://lore.kernel.org/r/20230904035220.48164-1-yiyang13@huawei.com](https://lore.kernel.org/r/20230904035220.48164-1-yiyang13%40huawei.com)
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=d81ffb87aaa75f842cd7aa57091810353755b3e6)

| -rw-r--r-- | [drivers/tty/vcc.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/tty/vcc.c?id=d81ffb87aaa75f842cd7aa57091810353755b3e6) | 16 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 13 insertions, 3 deletions

| diff --git a/drivers/tty/vcc.c b/drivers/tty/vcc.cindex a39ed981bfd3e4..5b625f20233b47 100644--- a/[drivers/tty/vcc.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/tty/vcc.c?id=30e945861f3b46c4a5b25b861da40510a64cf9a4)+++ b/[drivers/tty/vcc.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/tty/vcc.c?id=d81ffb87aaa75f842cd7aa57091810353755b3e6)@@ -579,18 +579,22 @@ static int vcc\_probe(struct vio\_dev \*vdev, const struct vio\_device\_id \*id) return -ENOMEM;  name = kstrdup(dev\_name(&vdev->dev), GFP\_KERNEL);+ if (!name) {+ rv = -ENOMEM;+ goto free\_port;+ }  rv = vio\_driver\_init(&port->vio, vdev, VDEV\_CONSOLE\_CON, vcc\_versions, ARRAY\_SIZE(vcc\_versions), NULL, name); if (rv)- goto free\_port;+ goto free\_name;  port->vio.debug = vcc\_dbg\_vio; vcc\_ldc\_cfg.debug = vcc\_dbg\_ldc;  rv = vio\_ldc\_alloc(&port->vio, &vcc\_ldc\_cfg, port); if (rv)- goto free\_port;+ goto free\_name;  spin\_lock\_init(&port->lock); @@ -624,6 +628,11 @@ static int vcc\_probe(struct vio\_dev \*vdev, const struct vio\_device\_id \*id) goto unreg\_tty; } port->domain = kstrdup(domain, GFP\_KERNEL);+ if (!port->domain) {+ rv = -ENOMEM;+ goto unreg\_tty;+ }+  mdesc\_release(hp); @@ -653,8 +662,9 @@ free\_table: vcc\_table\_remove(port->index); free\_ldc: vio\_ldc\_free(&port->vio);-free\_port:+free\_name: kfree(name);+free\_port: kfree(port);  return rv; |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 04:26:12 +0000



=== Content from git.kernel.org_59e8e384_20250111_042733.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=8f8771757b130383732195497e47fba2aba76d3a)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=8f8771757b130383732195497e47fba2aba76d3a)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=8f8771757b130383732195497e47fba2aba76d3a)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=8f8771757b130383732195497e47fba2aba76d3a)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Yi Yang <yiyang13@huawei.com> | 2023-09-04 11:52:20 +0800 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2023-11-28 17:19:45 +0000 |
| commit | [8f8771757b130383732195497e47fba2aba76d3a](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=8f8771757b130383732195497e47fba2aba76d3a) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=8f8771757b130383732195497e47fba2aba76d3a)) | |
| tree | [54f6f0dceaa19c84c7bcd8f24c68fec58df6277e](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=8f8771757b130383732195497e47fba2aba76d3a) | |
| parent | [3097a09f08f0b055e773e64af0232e668a0a6425](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=3097a09f08f0b055e773e64af0232e668a0a6425) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=8f8771757b130383732195497e47fba2aba76d3a&id2=3097a09f08f0b055e773e64af0232e668a0a6425)) | |
| download | [linux-8f8771757b130383732195497e47fba2aba76d3a.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-8f8771757b130383732195497e47fba2aba76d3a.tar.gz) | |

tty: vcc: Add check for kstrdup() in vcc\_probe()[ Upstream commit d81ffb87aaa75f842cd7aa57091810353755b3e6 ]
Add check for the return value of kstrdup() and return the error, if it
fails in order to avoid NULL pointer dereference.
Signed-off-by: Yi Yang <yiyang13@huawei.com>
Reviewed-by: Jiri Slaby <jirislaby@kernel.org>
Link: [https://lore.kernel.org/r/20230904035220.48164-1-yiyang13@huawei.com](https://lore.kernel.org/r/20230904035220.48164-1-yiyang13%40huawei.com)
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=8f8771757b130383732195497e47fba2aba76d3a)

| -rw-r--r-- | [drivers/tty/vcc.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/tty/vcc.c?id=8f8771757b130383732195497e47fba2aba76d3a) | 16 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 13 insertions, 3 deletions

| diff --git a/drivers/tty/vcc.c b/drivers/tty/vcc.cindex a39ed981bfd3e4..5b625f20233b47 100644--- a/[drivers/tty/vcc.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/tty/vcc.c?id=3097a09f08f0b055e773e64af0232e668a0a6425)+++ b/[drivers/tty/vcc.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/tty/vcc.c?id=8f8771757b130383732195497e47fba2aba76d3a)@@ -579,18 +579,22 @@ static int vcc\_probe(struct vio\_dev \*vdev, const struct vio\_device\_id \*id) return -ENOMEM;  name = kstrdup(dev\_name(&vdev->dev), GFP\_KERNEL);+ if (!name) {+ rv = -ENOMEM;+ goto free\_port;+ }  rv = vio\_driver\_init(&port->vio, vdev, VDEV\_CONSOLE\_CON, vcc\_versions, ARRAY\_SIZE(vcc\_versions), NULL, name); if (rv)- goto free\_port;+ goto free\_name;  port->vio.debug = vcc\_dbg\_vio; vcc\_ldc\_cfg.debug = vcc\_dbg\_ldc;  rv = vio\_ldc\_alloc(&port->vio, &vcc\_ldc\_cfg, port); if (rv)- goto free\_port;+ goto free\_name;  spin\_lock\_init(&port->lock); @@ -624,6 +628,11 @@ static int vcc\_probe(struct vio\_dev \*vdev, const struct vio\_device\_id \*id) goto unreg\_tty; } port->domain = kstrdup(domain, GFP\_KERNEL);+ if (!port->domain) {+ rv = -ENOMEM;+ goto unreg\_tty;+ }+  mdesc\_release(hp); @@ -653,8 +662,9 @@ free\_table: vcc\_table\_remove(port->index); free\_ldc: vio\_ldc\_free(&port->vio);-free\_port:+free\_name: kfree(name);+free\_port: kfree(port);  return rv; |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 04:26:10 +0000



=== Content from git.kernel.org_cbb1b3b8_20250111_042732.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=7cebc86481bf16049e266f6774d90f2fd4f8d5d2)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=7cebc86481bf16049e266f6774d90f2fd4f8d5d2)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=7cebc86481bf16049e266f6774d90f2fd4f8d5d2)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=7cebc86481bf16049e266f6774d90f2fd4f8d5d2)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Yi Yang <yiyang13@huawei.com> | 2023-09-04 11:52:20 +0800 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2023-11-28 17:07:01 +0000 |
| commit | [7cebc86481bf16049e266f6774d90f2fd4f8d5d2](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=7cebc86481bf16049e266f6774d90f2fd4f8d5d2) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=7cebc86481bf16049e266f6774d90f2fd4f8d5d2)) | |
| tree | [148242f1ee965d5e1ac49a1e9842476d6a79e190](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=7cebc86481bf16049e266f6774d90f2fd4f8d5d2) | |
| parent | [d6957635de8fb51c14afa7bfab9cce4beeeea37f](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=d6957635de8fb51c14afa7bfab9cce4beeeea37f) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=7cebc86481bf16049e266f6774d90f2fd4f8d5d2&id2=d6957635de8fb51c14afa7bfab9cce4beeeea37f)) | |
| download | [linux-7cebc86481bf16049e266f6774d90f2fd4f8d5d2.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-7cebc86481bf16049e266f6774d90f2fd4f8d5d2.tar.gz) | |

tty: vcc: Add check for kstrdup() in vcc\_probe()[ Upstream commit d81ffb87aaa75f842cd7aa57091810353755b3e6 ]
Add check for the return value of kstrdup() and return the error, if it
fails in order to avoid NULL pointer dereference.
Signed-off-by: Yi Yang <yiyang13@huawei.com>
Reviewed-by: Jiri Slaby <jirislaby@kernel.org>
Link: [https://lore.kernel.org/r/20230904035220.48164-1-yiyang13@huawei.com](https://lore.kernel.org/r/20230904035220.48164-1-yiyang13%40huawei.com)
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=7cebc86481bf16049e266f6774d90f2fd4f8d5d2)

| -rw-r--r-- | [drivers/tty/vcc.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/tty/vcc.c?id=7cebc86481bf16049e266f6774d90f2fd4f8d5d2) | 16 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 13 insertions, 3 deletions

| diff --git a/drivers/tty/vcc.c b/drivers/tty/vcc.cindex 34ba6e54789a7f..b8b832c75b8560 100644--- a/[drivers/tty/vcc.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/tty/vcc.c?id=d6957635de8fb51c14afa7bfab9cce4beeeea37f)+++ b/[drivers/tty/vcc.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/tty/vcc.c?id=7cebc86481bf16049e266f6774d90f2fd4f8d5d2)@@ -579,18 +579,22 @@ static int vcc\_probe(struct vio\_dev \*vdev, const struct vio\_device\_id \*id) return -ENOMEM;  name = kstrdup(dev\_name(&vdev->dev), GFP\_KERNEL);+ if (!name) {+ rv = -ENOMEM;+ goto free\_port;+ }  rv = vio\_driver\_init(&port->vio, vdev, VDEV\_CONSOLE\_CON, vcc\_versions, ARRAY\_SIZE(vcc\_versions), NULL, name); if (rv)- goto free\_port;+ goto free\_name;  port->vio.debug = vcc\_dbg\_vio; vcc\_ldc\_cfg.debug = vcc\_dbg\_ldc;  rv = vio\_ldc\_alloc(&port->vio, &vcc\_ldc\_cfg, port); if (rv)- goto free\_port;+ goto free\_name;  spin\_lock\_init(&port->lock); @@ -624,6 +628,11 @@ static int vcc\_probe(struct vio\_dev \*vdev, const struct vio\_device\_id \*id) goto unreg\_tty; } port->domain = kstrdup(domain, GFP\_KERNEL);+ if (!port->domain) {+ rv = -ENOMEM;+ goto unreg\_tty;+ }+  mdesc\_release(hp); @@ -653,8 +662,9 @@ free\_table: vcc\_table\_remove(port->index); free\_ldc: vio\_ldc\_free(&port->vio);-free\_port:+free\_name: kfree(name);+free\_port: kfree(port);  return rv; |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 04:26:09 +0000



=== Content from git.kernel.org_1129267d_20250111_042731.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=6c80f48912b5bd4965352d1a9a989e21743a4a06)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=6c80f48912b5bd4965352d1a9a989e21743a4a06)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=6c80f48912b5bd4965352d1a9a989e21743a4a06)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=6c80f48912b5bd4965352d1a9a989e21743a4a06)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Yi Yang <yiyang13@huawei.com> | 2023-09-04 11:52:20 +0800 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2023-11-28 16:56:19 +0000 |
| commit | [6c80f48912b5bd4965352d1a9a989e21743a4a06](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=6c80f48912b5bd4965352d1a9a989e21743a4a06) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=6c80f48912b5bd4965352d1a9a989e21743a4a06)) | |
| tree | [231a02cf8bc36cb7ad5e1e07e970f81006c67824](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=6c80f48912b5bd4965352d1a9a989e21743a4a06) | |
| parent | [2ff61106d6b49862786d68f5a4b971b13c6b8807](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=2ff61106d6b49862786d68f5a4b971b13c6b8807) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=6c80f48912b5bd4965352d1a9a989e21743a4a06&id2=2ff61106d6b49862786d68f5a4b971b13c6b8807)) | |
| download | [linux-6c80f48912b5bd4965352d1a9a989e21743a4a06.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-6c80f48912b5bd4965352d1a9a989e21743a4a06.tar.gz) | |

tty: vcc: Add check for kstrdup() in vcc\_probe()[ Upstream commit d81ffb87aaa75f842cd7aa57091810353755b3e6 ]
Add check for the return value of kstrdup() and return the error, if it
fails in order to avoid NULL pointer dereference.
Signed-off-by: Yi Yang <yiyang13@huawei.com>
Reviewed-by: Jiri Slaby <jirislaby@kernel.org>
Link: [https://lore.kernel.org/r/20230904035220.48164-1-yiyang13@huawei.com](https://lore.kernel.org/r/20230904035220.48164-1-yiyang13%40huawei.com)
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=6c80f48912b5bd4965352d1a9a989e21743a4a06)

| -rw-r--r-- | [drivers/tty/vcc.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/tty/vcc.c?id=6c80f48912b5bd4965352d1a9a989e21743a4a06) | 16 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 13 insertions, 3 deletions

| diff --git a/drivers/tty/vcc.c b/drivers/tty/vcc.cindex e11383ae1e7e31..71356d9684bace 100644--- a/[drivers/tty/vcc.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/tty/vcc.c?id=2ff61106d6b49862786d68f5a4b971b13c6b8807)+++ b/[drivers/tty/vcc.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/tty/vcc.c?id=6c80f48912b5bd4965352d1a9a989e21743a4a06)@@ -578,18 +578,22 @@ static int vcc\_probe(struct vio\_dev \*vdev, const struct vio\_device\_id \*id) return -ENOMEM;  name = kstrdup(dev\_name(&vdev->dev), GFP\_KERNEL);+ if (!name) {+ rv = -ENOMEM;+ goto free\_port;+ }  rv = vio\_driver\_init(&port->vio, vdev, VDEV\_CONSOLE\_CON, vcc\_versions, ARRAY\_SIZE(vcc\_versions), NULL, name); if (rv)- goto free\_port;+ goto free\_name;  port->vio.debug = vcc\_dbg\_vio; vcc\_ldc\_cfg.debug = vcc\_dbg\_ldc;  rv = vio\_ldc\_alloc(&port->vio, &vcc\_ldc\_cfg, port); if (rv)- goto free\_port;+ goto free\_name;  spin\_lock\_init(&port->lock); @@ -623,6 +627,11 @@ static int vcc\_probe(struct vio\_dev \*vdev, const struct vio\_device\_id \*id) goto unreg\_tty; } port->domain = kstrdup(domain, GFP\_KERNEL);+ if (!port->domain) {+ rv = -ENOMEM;+ goto unreg\_tty;+ }+  mdesc\_release(hp); @@ -652,8 +661,9 @@ free\_table: vcc\_table\_remove(port->index); free\_ldc: vio\_ldc\_free(&port->vio);-free\_port:+free\_name: kfree(name);+free\_port: kfree(port);  return rv; |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 04:26:09 +0000



=== Content from git.kernel.org_6db8b569_20250111_042731.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=4ef41a7f33ffe1a335e7db7e1564ddc6afad47cc)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=4ef41a7f33ffe1a335e7db7e1564ddc6afad47cc)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=4ef41a7f33ffe1a335e7db7e1564ddc6afad47cc)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=4ef41a7f33ffe1a335e7db7e1564ddc6afad47cc)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Yi Yang <yiyang13@huawei.com> | 2023-09-04 11:52:20 +0800 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2023-11-28 16:54:52 +0000 |
| commit | [4ef41a7f33ffe1a335e7db7e1564ddc6afad47cc](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=4ef41a7f33ffe1a335e7db7e1564ddc6afad47cc) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=4ef41a7f33ffe1a335e7db7e1564ddc6afad47cc)) | |
| tree | [e92fa72ad05dbce4048c6c13659a3343a27b50f2](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=4ef41a7f33ffe1a335e7db7e1564ddc6afad47cc) | |
| parent | [484cc536a3a2ec3ae7dd28b175c4fde3f6573722](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=484cc536a3a2ec3ae7dd28b175c4fde3f6573722) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=4ef41a7f33ffe1a335e7db7e1564ddc6afad47cc&id2=484cc536a3a2ec3ae7dd28b175c4fde3f6573722)) | |
| download | [linux-4ef41a7f33ffe1a335e7db7e1564ddc6afad47cc.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-4ef41a7f33ffe1a335e7db7e1564ddc6afad47cc.tar.gz) | |

tty: vcc: Add check for kstrdup() in vcc\_probe()[ Upstream commit d81ffb87aaa75f842cd7aa57091810353755b3e6 ]
Add check for the return value of kstrdup() and return the error, if it
fails in order to avoid NULL pointer dereference.
Signed-off-by: Yi Yang <yiyang13@huawei.com>
Reviewed-by: Jiri Slaby <jirislaby@kernel.org>
Link: [https://lore.kernel.org/r/20230904035220.48164-1-yiyang13@huawei.com](https://lore.kernel.org/r/20230904035220.48164-1-yiyang13%40huawei.com)
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=4ef41a7f33ffe1a335e7db7e1564ddc6afad47cc)

| -rw-r--r-- | [drivers/tty/vcc.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/tty/vcc.c?id=4ef41a7f33ffe1a335e7db7e1564ddc6afad47cc) | 16 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 13 insertions, 3 deletions

| diff --git a/drivers/tty/vcc.c b/drivers/tty/vcc.cindex 9ffd42e333b83f..6b2d35ac6e3b34 100644--- a/[drivers/tty/vcc.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/tty/vcc.c?id=484cc536a3a2ec3ae7dd28b175c4fde3f6573722)+++ b/[drivers/tty/vcc.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/tty/vcc.c?id=4ef41a7f33ffe1a335e7db7e1564ddc6afad47cc)@@ -587,18 +587,22 @@ static int vcc\_probe(struct vio\_dev \*vdev, const struct vio\_device\_id \*id) return -ENOMEM;  name = kstrdup(dev\_name(&vdev->dev), GFP\_KERNEL);+ if (!name) {+ rv = -ENOMEM;+ goto free\_port;+ }  rv = vio\_driver\_init(&port->vio, vdev, VDEV\_CONSOLE\_CON, vcc\_versions, ARRAY\_SIZE(vcc\_versions), NULL, name); if (rv)- goto free\_port;+ goto free\_name;  port->vio.debug = vcc\_dbg\_vio; vcc\_ldc\_cfg.debug = vcc\_dbg\_ldc;  rv = vio\_ldc\_alloc(&port->vio, &vcc\_ldc\_cfg, port); if (rv)- goto free\_port;+ goto free\_name;  spin\_lock\_init(&port->lock); @@ -632,6 +636,11 @@ static int vcc\_probe(struct vio\_dev \*vdev, const struct vio\_device\_id \*id) goto unreg\_tty; } port->domain = kstrdup(domain, GFP\_KERNEL);+ if (!port->domain) {+ rv = -ENOMEM;+ goto unreg\_tty;+ }+  mdesc\_release(hp); @@ -661,8 +670,9 @@ free\_table: vcc\_table\_remove(port->index); free\_ldc: vio\_ldc\_free(&port->vio);-free\_port:+free\_name: kfree(name);+free\_port: kfree(port);  return rv; |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 04:26:08 +0000



=== Content from git.kernel.org_89b4a482_20250111_042730.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=4a24a31826246b15477399febd13292b0c9f0ee9)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=4a24a31826246b15477399febd13292b0c9f0ee9)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=4a24a31826246b15477399febd13292b0c9f0ee9)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=4a24a31826246b15477399febd13292b0c9f0ee9)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Yi Yang <yiyang13@huawei.com> | 2023-09-04 11:52:20 +0800 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2023-11-28 17:14:49 +0000 |
| commit | [4a24a31826246b15477399febd13292b0c9f0ee9](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=4a24a31826246b15477399febd13292b0c9f0ee9) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=4a24a31826246b15477399febd13292b0c9f0ee9)) | |
| tree | [6b7dfdcc4ba12e806704b59cf15bcbee86a0dda5](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=4a24a31826246b15477399febd13292b0c9f0ee9) | |
| parent | [5440e83534ee5e8c14898a7b5dd1bc97ca0f6c3b](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=5440e83534ee5e8c14898a7b5dd1bc97ca0f6c3b) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=4a24a31826246b15477399febd13292b0c9f0ee9&id2=5440e83534ee5e8c14898a7b5dd1bc97ca0f6c3b)) | |
| download | [linux-4a24a31826246b15477399febd13292b0c9f0ee9.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-4a24a31826246b15477399febd13292b0c9f0ee9.tar.gz) | |

tty: vcc: Add check for kstrdup() in vcc\_probe()[ Upstream commit d81ffb87aaa75f842cd7aa57091810353755b3e6 ]
Add check for the return value of kstrdup() and return the error, if it
fails in order to avoid NULL pointer dereference.
Signed-off-by: Yi Yang <yiyang13@huawei.com>
Reviewed-by: Jiri Slaby <jirislaby@kernel.org>
Link: [https://lore.kernel.org/r/20230904035220.48164-1-yiyang13@huawei.com](https://lore.kernel.org/r/20230904035220.48164-1-yiyang13%40huawei.com)
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=4a24a31826246b15477399febd13292b0c9f0ee9)

| -rw-r--r-- | [drivers/tty/vcc.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/tty/vcc.c?id=4a24a31826246b15477399febd13292b0c9f0ee9) | 16 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 13 insertions, 3 deletions

| diff --git a/drivers/tty/vcc.c b/drivers/tty/vcc.cindex 34ba6e54789a7f..b8b832c75b8560 100644--- a/[drivers/tty/vcc.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/tty/vcc.c?id=5440e83534ee5e8c14898a7b5dd1bc97ca0f6c3b)+++ b/[drivers/tty/vcc.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/tty/vcc.c?id=4a24a31826246b15477399febd13292b0c9f0ee9)@@ -579,18 +579,22 @@ static int vcc\_probe(struct vio\_dev \*vdev, const struct vio\_device\_id \*id) return -ENOMEM;  name = kstrdup(dev\_name(&vdev->dev), GFP\_KERNEL);+ if (!name) {+ rv = -ENOMEM;+ goto free\_port;+ }  rv = vio\_driver\_init(&port->vio, vdev, VDEV\_CONSOLE\_CON, vcc\_versions, ARRAY\_SIZE(vcc\_versions), NULL, name); if (rv)- goto free\_port;+ goto free\_name;  port->vio.debug = vcc\_dbg\_vio; vcc\_ldc\_cfg.debug = vcc\_dbg\_ldc;  rv = vio\_ldc\_alloc(&port->vio, &vcc\_ldc\_cfg, port); if (rv)- goto free\_port;+ goto free\_name;  spin\_lock\_init(&port->lock); @@ -624,6 +628,11 @@ static int vcc\_probe(struct vio\_dev \*vdev, const struct vio\_device\_id \*id) goto unreg\_tty; } port->domain = kstrdup(domain, GFP\_KERNEL);+ if (!port->domain) {+ rv = -ENOMEM;+ goto unreg\_tty;+ }+  mdesc\_release(hp); @@ -653,8 +662,9 @@ free\_table: vcc\_table\_remove(port->index); free\_ldc: vio\_ldc\_free(&port->vio);-free\_port:+free\_name: kfree(name);+free\_port: kfree(port);  return rv; |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 04:26:07 +0000



=== Content from git.kernel.org_ff3df6ff_20250111_042729.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=460284dfb10b207980c6f3f7046e33446ceb38ac)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=460284dfb10b207980c6f3f7046e33446ceb38ac)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=460284dfb10b207980c6f3f7046e33446ceb38ac)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=460284dfb10b207980c6f3f7046e33446ceb38ac)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Yi Yang <yiyang13@huawei.com> | 2023-09-04 11:52:20 +0800 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2023-11-28 16:50:15 +0000 |
| commit | [460284dfb10b207980c6f3f7046e33446ceb38ac](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=460284dfb10b207980c6f3f7046e33446ceb38ac) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=460284dfb10b207980c6f3f7046e33446ceb38ac)) | |
| tree | [db37f282fbcf20bf0291cf3f575f136dc07f01a1](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=460284dfb10b207980c6f3f7046e33446ceb38ac) | |
| parent | [35b9435123ef65ed73135c319d66226b9d1f8a2a](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=35b9435123ef65ed73135c319d66226b9d1f8a2a) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=460284dfb10b207980c6f3f7046e33446ceb38ac&id2=35b9435123ef65ed73135c319d66226b9d1f8a2a)) | |
| download | [linux-460284dfb10b207980c6f3f7046e33446ceb38ac.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-460284dfb10b207980c6f3f7046e33446ceb38ac.tar.gz) | |

tty: vcc: Add check for kstrdup() in vcc\_probe()[ Upstream commit d81ffb87aaa75f842cd7aa57091810353755b3e6 ]
Add check for the return value of kstrdup() and return the error, if it
fails in order to avoid NULL pointer dereference.
Signed-off-by: Yi Yang <yiyang13@huawei.com>
Reviewed-by: Jiri Slaby <jirislaby@kernel.org>
Link: [https://lore.kernel.org/r/20230904035220.48164-1-yiyang13@huawei.com](https://lore.kernel.org/r/20230904035220.48164-1-yiyang13%40huawei.com)
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=460284dfb10b207980c6f3f7046e33446ceb38ac)

| -rw-r--r-- | [drivers/tty/vcc.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/tty/vcc.c?id=460284dfb10b207980c6f3f7046e33446ceb38ac) | 16 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 13 insertions, 3 deletions

| diff --git a/drivers/tty/vcc.c b/drivers/tty/vcc.cindex 9ffd42e333b83f..6b2d35ac6e3b34 100644--- a/[drivers/tty/vcc.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/tty/vcc.c?id=35b9435123ef65ed73135c319d66226b9d1f8a2a)+++ b/[drivers/tty/vcc.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/tty/vcc.c?id=460284dfb10b207980c6f3f7046e33446ceb38ac)@@ -587,18 +587,22 @@ static int vcc\_probe(struct vio\_dev \*vdev, const struct vio\_device\_id \*id) return -ENOMEM;  name = kstrdup(dev\_name(&vdev->dev), GFP\_KERNEL);+ if (!name) {+ rv = -ENOMEM;+ goto free\_port;+ }  rv = vio\_driver\_init(&port->vio, vdev, VDEV\_CONSOLE\_CON, vcc\_versions, ARRAY\_SIZE(vcc\_versions), NULL, name); if (rv)- goto free\_port;+ goto free\_name;  port->vio.debug = vcc\_dbg\_vio; vcc\_ldc\_cfg.debug = vcc\_dbg\_ldc;  rv = vio\_ldc\_alloc(&port->vio, &vcc\_ldc\_cfg, port); if (rv)- goto free\_port;+ goto free\_name;  spin\_lock\_init(&port->lock); @@ -632,6 +636,11 @@ static int vcc\_probe(struct vio\_dev \*vdev, const struct vio\_device\_id \*id) goto unreg\_tty; } port->domain = kstrdup(domain, GFP\_KERNEL);+ if (!port->domain) {+ rv = -ENOMEM;+ goto unreg\_tty;+ }+  mdesc\_release(hp); @@ -661,8 +670,9 @@ free\_table: vcc\_table\_remove(port->index); free\_ldc: vio\_ldc\_free(&port->vio);-free\_port:+free\_name: kfree(name);+free\_port: kfree(port);  return rv; |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 04:26:06 +0000



=== Content from git.kernel.org_d74ea70f_20250111_042728.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=38cd56fc9de78bf3c878790785e8c231116ef9d3)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=38cd56fc9de78bf3c878790785e8c231116ef9d3)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=38cd56fc9de78bf3c878790785e8c231116ef9d3)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=38cd56fc9de78bf3c878790785e8c231116ef9d3)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Yi Yang <yiyang13@huawei.com> | 2023-09-04 11:52:20 +0800 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2023-11-28 16:45:44 +0000 |
| commit | [38cd56fc9de78bf3c878790785e8c231116ef9d3](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=38cd56fc9de78bf3c878790785e8c231116ef9d3) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=38cd56fc9de78bf3c878790785e8c231116ef9d3)) | |
| tree | [04e463b5f12427e567cb58f66c2ddf3cf6c03ab3](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=38cd56fc9de78bf3c878790785e8c231116ef9d3) | |
| parent | [930f0aaba4820d6362de4e6ed569eaf444f1ea4e](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=930f0aaba4820d6362de4e6ed569eaf444f1ea4e) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=38cd56fc9de78bf3c878790785e8c231116ef9d3&id2=930f0aaba4820d6362de4e6ed569eaf444f1ea4e)) | |
| download | [linux-38cd56fc9de78bf3c878790785e8c231116ef9d3.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-38cd56fc9de78bf3c878790785e8c231116ef9d3.tar.gz) | |

tty: vcc: Add check for kstrdup() in vcc\_probe()[ Upstream commit d81ffb87aaa75f842cd7aa57091810353755b3e6 ]
Add check for the return value of kstrdup() and return the error, if it
fails in order to avoid NULL pointer dereference.
Signed-off-by: Yi Yang <yiyang13@huawei.com>
Reviewed-by: Jiri Slaby <jirislaby@kernel.org>
Link: [https://lore.kernel.org/r/20230904035220.48164-1-yiyang13@huawei.com](https://lore.kernel.org/r/20230904035220.48164-1-yiyang13%40huawei.com)
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=38cd56fc9de78bf3c878790785e8c231116ef9d3)

| -rw-r--r-- | [drivers/tty/vcc.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/tty/vcc.c?id=38cd56fc9de78bf3c878790785e8c231116ef9d3) | 16 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 13 insertions, 3 deletions

| diff --git a/drivers/tty/vcc.c b/drivers/tty/vcc.cindex 4e795353192bc7..67f528cf1056da 100644--- a/[drivers/tty/vcc.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/tty/vcc.c?id=930f0aaba4820d6362de4e6ed569eaf444f1ea4e)+++ b/[drivers/tty/vcc.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/tty/vcc.c?id=38cd56fc9de78bf3c878790785e8c231116ef9d3)@@ -594,18 +594,22 @@ static int vcc\_probe(struct vio\_dev \*vdev, const struct vio\_device\_id \*id) return -ENOMEM;  name = kstrdup(dev\_name(&vdev->dev), GFP\_KERNEL);+ if (!name) {+ rv = -ENOMEM;+ goto free\_port;+ }  rv = vio\_driver\_init(&port->vio, vdev, VDEV\_CONSOLE\_CON, vcc\_versions, ARRAY\_SIZE(vcc\_versions), NULL, name); if (rv)- goto free\_port;+ goto free\_name;  port->vio.debug = vcc\_dbg\_vio; vcc\_ldc\_cfg.debug = vcc\_dbg\_ldc;  rv = vio\_ldc\_alloc(&port->vio, &vcc\_ldc\_cfg, port); if (rv)- goto free\_port;+ goto free\_name;  spin\_lock\_init(&port->lock); @@ -639,6 +643,11 @@ static int vcc\_probe(struct vio\_dev \*vdev, const struct vio\_device\_id \*id) goto unreg\_tty; } port->domain = kstrdup(domain, GFP\_KERNEL);+ if (!port->domain) {+ rv = -ENOMEM;+ goto unreg\_tty;+ }+  mdesc\_release(hp); @@ -673,8 +682,9 @@ free\_table: vcc\_table\_remove(port->index); free\_ldc: vio\_ldc\_free(&port->vio);-free\_port:+free\_name: kfree(name);+free\_port: kfree(port);  return rv; |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 04:26:05 +0000


