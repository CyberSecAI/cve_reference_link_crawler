=== Content from git.kernel.org_bb39516f_20250111_175933.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=83e197a8414c0ba545e7e3916ce05f836f349273)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=83e197a8414c0ba545e7e3916ce05f836f349273)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=83e197a8414c0ba545e7e3916ce05f836f349273)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=83e197a8414c0ba545e7e3916ce05f836f349273)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Takashi Iwai <tiwai@suse.de> | 2021-06-10 17:20:59 +0200 |
| --- | --- | --- |
| committer | Takashi Iwai <tiwai@suse.de> | 2021-06-10 17:21:30 +0200 |
| commit | [83e197a8414c0ba545e7e3916ce05f836f349273](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=83e197a8414c0ba545e7e3916ce05f836f349273) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=83e197a8414c0ba545e7e3916ce05f836f349273)) | |
| tree | [905362ad82a2d2ad6e99b618956ee96dae625a83](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=83e197a8414c0ba545e7e3916ce05f836f349273) | |
| parent | [a0309c344886c499b6071e7f03658e7f71a9afbb](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=a0309c344886c499b6071e7f03658e7f71a9afbb) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=83e197a8414c0ba545e7e3916ce05f836f349273&id2=a0309c344886c499b6071e7f03658e7f71a9afbb)) | |
| download | [linux-83e197a8414c0ba545e7e3916ce05f836f349273.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-83e197a8414c0ba545e7e3916ce05f836f349273.tar.gz) | |

ALSA: seq: Fix race of snd\_seq\_timer\_open()The timer instance per queue is exclusive, and snd\_seq\_timer\_open()
should have managed the concurrent accesses. It looks as if it's
checking the already existing timer instance at the beginning, but
it's not right, because there is no protection, hence any later
concurrent call of snd\_seq\_timer\_open() may override the timer
instance easily. This may result in UAF, as the leftover timer
instance can keep running while the queue itself gets closed, as
spotted by syzkaller recently.
For avoiding the race, add a proper check at the assignment of
tmr->timeri again, and return -EBUSY if it's been already registered.
Reported-by: syzbot+ddc1260a83ed1cbf6fb5@syzkaller.appspotmail.com
Cc: <stable@vger.kernel.org>
Link: [https://lore.kernel.org/r/000000000000dce34f05c42f110c@google.com](https://lore.kernel.org/r/000000000000dce34f05c42f110c%40google.com)
Link: [https://lore.kernel.org/r/20210610152059.24633-1-tiwai@suse.de](https://lore.kernel.org/r/20210610152059.24633-1-tiwai%40suse.de)
Signed-off-by: Takashi Iwai <tiwai@suse.de>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=83e197a8414c0ba545e7e3916ce05f836f349273)

| -rw-r--r-- | [sound/core/seq/seq\_timer.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/sound/core/seq/seq_timer.c?id=83e197a8414c0ba545e7e3916ce05f836f349273) | 10 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 9 insertions, 1 deletions

| diff --git a/sound/core/seq/seq\_timer.c b/sound/core/seq/seq\_timer.cindex 1645e4142e3024..9863be6fd43e1a 100644--- a/[sound/core/seq/seq\_timer.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/sound/core/seq/seq_timer.c?id=a0309c344886c499b6071e7f03658e7f71a9afbb)+++ b/[sound/core/seq/seq\_timer.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/sound/core/seq/seq_timer.c?id=83e197a8414c0ba545e7e3916ce05f836f349273)@@ -297,8 +297,16 @@ int snd\_seq\_timer\_open(struct snd\_seq\_queue \*q) return err; } spin\_lock\_irq(&tmr->lock);- tmr->timeri = t;+ if (tmr->timeri)+ err = -EBUSY;+ else+ tmr->timeri = t; spin\_unlock\_irq(&tmr->lock);+ if (err < 0) {+ snd\_timer\_close(t);+ snd\_timer\_instance\_free(t);+ return err;+ } return 0; } |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 17:58:10 +0000



=== Content from git.kernel.org_1762dc41_20250111_175933.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=536a7646c00a0f14fee49e5e313109e5da2f6031)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=536a7646c00a0f14fee49e5e313109e5da2f6031)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=536a7646c00a0f14fee49e5e313109e5da2f6031)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=536a7646c00a0f14fee49e5e313109e5da2f6031)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Takashi Iwai <tiwai@suse.de> | 2021-06-10 17:20:59 +0200 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2021-06-16 12:05:04 +0200 |
| commit | [536a7646c00a0f14fee49e5e313109e5da2f6031](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=536a7646c00a0f14fee49e5e313109e5da2f6031) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=536a7646c00a0f14fee49e5e313109e5da2f6031)) | |
| tree | [dc2ff9f96f063b1e20e7cc83ca729ee8412f128a](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=536a7646c00a0f14fee49e5e313109e5da2f6031) | |
| parent | [9f573a752d1b3180f78d473e8cf0c4bda2ea30a9](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=9f573a752d1b3180f78d473e8cf0c4bda2ea30a9) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=536a7646c00a0f14fee49e5e313109e5da2f6031&id2=9f573a752d1b3180f78d473e8cf0c4bda2ea30a9)) | |
| download | [linux-536a7646c00a0f14fee49e5e313109e5da2f6031.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-536a7646c00a0f14fee49e5e313109e5da2f6031.tar.gz) | |

ALSA: seq: Fix race of snd\_seq\_timer\_open()commit 83e197a8414c0ba545e7e3916ce05f836f349273 upstream.
The timer instance per queue is exclusive, and snd\_seq\_timer\_open()
should have managed the concurrent accesses. It looks as if it's
checking the already existing timer instance at the beginning, but
it's not right, because there is no protection, hence any later
concurrent call of snd\_seq\_timer\_open() may override the timer
instance easily. This may result in UAF, as the leftover timer
instance can keep running while the queue itself gets closed, as
spotted by syzkaller recently.
For avoiding the race, add a proper check at the assignment of
tmr->timeri again, and return -EBUSY if it's been already registered.
Reported-by: syzbot+ddc1260a83ed1cbf6fb5@syzkaller.appspotmail.com
Cc: <stable@vger.kernel.org>
Link: [https://lore.kernel.org/r/000000000000dce34f05c42f110c@google.com](https://lore.kernel.org/r/000000000000dce34f05c42f110c%40google.com)
Link: [https://lore.kernel.org/r/20210610152059.24633-1-tiwai@suse.de](https://lore.kernel.org/r/20210610152059.24633-1-tiwai%40suse.de)
Signed-off-by: Takashi Iwai <tiwai@suse.de>
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=536a7646c00a0f14fee49e5e313109e5da2f6031)

| -rw-r--r-- | [sound/core/seq/seq\_timer.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/sound/core/seq/seq_timer.c?id=536a7646c00a0f14fee49e5e313109e5da2f6031) | 10 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 9 insertions, 1 deletions

| diff --git a/sound/core/seq/seq\_timer.c b/sound/core/seq/seq\_timer.cindex 1645e4142e3024..9863be6fd43e1a 100644--- a/[sound/core/seq/seq\_timer.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/sound/core/seq/seq_timer.c?id=9f573a752d1b3180f78d473e8cf0c4bda2ea30a9)+++ b/[sound/core/seq/seq\_timer.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/sound/core/seq/seq_timer.c?id=536a7646c00a0f14fee49e5e313109e5da2f6031)@@ -297,8 +297,16 @@ int snd\_seq\_timer\_open(struct snd\_seq\_queue \*q) return err; } spin\_lock\_irq(&tmr->lock);- tmr->timeri = t;+ if (tmr->timeri)+ err = -EBUSY;+ else+ tmr->timeri = t; spin\_unlock\_irq(&tmr->lock);+ if (err < 0) {+ snd\_timer\_close(t);+ snd\_timer\_instance\_free(t);+ return err;+ } return 0; } |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 17:58:10 +0000



=== Content from git.kernel.org_7fe05daa_20250111_175935.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=bd7d88b0874f82f7b29d1a53e574cedaf23166ba)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=bd7d88b0874f82f7b29d1a53e574cedaf23166ba)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=bd7d88b0874f82f7b29d1a53e574cedaf23166ba)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=bd7d88b0874f82f7b29d1a53e574cedaf23166ba)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Takashi Iwai <tiwai@suse.de> | 2021-06-10 17:20:59 +0200 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2021-06-16 12:01:38 +0200 |
| commit | [bd7d88b0874f82f7b29d1a53e574cedaf23166ba](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=bd7d88b0874f82f7b29d1a53e574cedaf23166ba) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=bd7d88b0874f82f7b29d1a53e574cedaf23166ba)) | |
| tree | [2889598b5dbce62b4fc062b9b70752442c9d5811](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=bd7d88b0874f82f7b29d1a53e574cedaf23166ba) | |
| parent | [fff6af6deae8af944f07eb27dba0236e1a2e95cb](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=fff6af6deae8af944f07eb27dba0236e1a2e95cb) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=bd7d88b0874f82f7b29d1a53e574cedaf23166ba&id2=fff6af6deae8af944f07eb27dba0236e1a2e95cb)) | |
| download | [linux-bd7d88b0874f82f7b29d1a53e574cedaf23166ba.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-bd7d88b0874f82f7b29d1a53e574cedaf23166ba.tar.gz) | |

ALSA: seq: Fix race of snd\_seq\_timer\_open()commit 83e197a8414c0ba545e7e3916ce05f836f349273 upstream.
The timer instance per queue is exclusive, and snd\_seq\_timer\_open()
should have managed the concurrent accesses. It looks as if it's
checking the already existing timer instance at the beginning, but
it's not right, because there is no protection, hence any later
concurrent call of snd\_seq\_timer\_open() may override the timer
instance easily. This may result in UAF, as the leftover timer
instance can keep running while the queue itself gets closed, as
spotted by syzkaller recently.
For avoiding the race, add a proper check at the assignment of
tmr->timeri again, and return -EBUSY if it's been already registered.
Reported-by: syzbot+ddc1260a83ed1cbf6fb5@syzkaller.appspotmail.com
Cc: <stable@vger.kernel.org>
Link: [https://lore.kernel.org/r/000000000000dce34f05c42f110c@google.com](https://lore.kernel.org/r/000000000000dce34f05c42f110c%40google.com)
Link: [https://lore.kernel.org/r/20210610152059.24633-1-tiwai@suse.de](https://lore.kernel.org/r/20210610152059.24633-1-tiwai%40suse.de)
Signed-off-by: Takashi Iwai <tiwai@suse.de>
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=bd7d88b0874f82f7b29d1a53e574cedaf23166ba)

| -rw-r--r-- | [sound/core/seq/seq\_timer.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/sound/core/seq/seq_timer.c?id=bd7d88b0874f82f7b29d1a53e574cedaf23166ba) | 10 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 9 insertions, 1 deletions

| diff --git a/sound/core/seq/seq\_timer.c b/sound/core/seq/seq\_timer.cindex 1645e4142e3024..9863be6fd43e1a 100644--- a/[sound/core/seq/seq\_timer.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/sound/core/seq/seq_timer.c?id=fff6af6deae8af944f07eb27dba0236e1a2e95cb)+++ b/[sound/core/seq/seq\_timer.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/sound/core/seq/seq_timer.c?id=bd7d88b0874f82f7b29d1a53e574cedaf23166ba)@@ -297,8 +297,16 @@ int snd\_seq\_timer\_open(struct snd\_seq\_queue \*q) return err; } spin\_lock\_irq(&tmr->lock);- tmr->timeri = t;+ if (tmr->timeri)+ err = -EBUSY;+ else+ tmr->timeri = t; spin\_unlock\_irq(&tmr->lock);+ if (err < 0) {+ snd\_timer\_close(t);+ snd\_timer\_instance\_free(t);+ return err;+ } return 0; } |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 17:58:12 +0000


