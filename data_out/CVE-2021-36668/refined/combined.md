=== Content from docs.druva.com_4d21de1e_20250108_141753.html ===
Copyright 2023. Intercom Inc.
Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at
http://www.apache.org/licenses/LICENSE-2.0
Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.Copyright (c) 2023, Intercom, Inc. (legal@intercom.io) with Reserved Font Name "Lato".
This Font Software is licensed under the SIL Open Font License, Version 1.1.[Skip to main content](#main-content)[![Druva | Documentation](https://downloads.intercomcdn.com/i/o/440690/1a2d657ec884f670fda4ec8e/31e15d955d73babef21f49bb8f1142ee.png)](/en/)[Product Tours](https://www.druva.com/tours)[API Docs](https://developer.druva.com/)English;English[Product Tours](https://www.druva.com/tours)[API Docs](https://developer.druva.com/)English;EnglishTable of contents[All Collections](/en/)[Knowledge Base](https://help.druva.com/en/collections/7848424-knowledge-base)[Security Update](https://help.druva.com/en/collections/7848452-security-update)Security Advisory for inSync Client 7.0.1 and beforeSecurity Advisory for inSync Client 7.0.1 and before Updated over 9 months agoTable of contents

**Advisory ID:**Druva/DVSA-2022-001

**Issue Date:**07-07-2022

**Last Updated:**08-06-2021 (Initial Advisory)

**Advisory Status**: Final

**Version:**1.0

**Overall Severity Classification:**High

# Summary

The inSync Client versions were susceptible to vulnerabilities that could allow malicious users with user-level privileges to inject code and escalate privileges to root by chaining these flaws. These vulnerabilities cannot be exploited remotely and are exploitable only if the malicious user has user-level access to the device. Druva has released an inSync Client update that overcomes these vulnerabilities. Customers are strongly advised to upgrade to the latest version to remediate these vulnerabilities. See the [customer action required](https://docs.google.com/document/d/1rKGAFLxpUJrRlGIMJ-ZFS4QLTjRK0CPVkcx3nCF98z0/edit#heading=h.fno1e8s6ihtu) section for more details.

---

**üìù Note**
‚Äã**These vulnerabilities were identified, fixed, and communicated to customers (via email) in Aug 2021. The CVE IDs have been assigned on 16 May 2022.**

---

## Impact

Successful exploitation of these vulnerabilities could lead to Privilege escalation, command injection, arbitrary NodeJS code injection and unauthorized modification of data.

## Affected products(s), version(s) and resolution

| **Product** | **CVE ID** | **Platform** | **Affected Versions** | **Fixed/updated version** |
| --- | --- | --- | --- | --- |
| inSync Client | CVE-2021-36665 | Windows | All versions before v7.0.0 | v7.0.0 and above |
| macOS | All versions before v7.0.0 | v7.0.0 and above |
| CVE-2021-36666    CVE-2021-36667 | macOS | All versions before v7.0.0 | v7.0.0 and above |
| CVE-2021-36668 | Windows | v7.0.0 and earlier versions | v7.0.1-r110201 and above |
| macOS | v7.0.0 and earlier versions | v7.0.1-r110206 and above |
| Linux(Ubuntu only) | Linux: v5.9.2 | v5.9.3 and above. |

## Customer action required

Upgrade the inSync Client to the latest installation version, which addresses all the CVE‚Äôs mentioned above:

**Windows**: v7.0.1-r110201 and above

**Mac:**v7.0.1-r110206 and above

**Linux (Ubuntu):**v5.9.3 and above.

Download the latest inSync Client [here](https://downloads.druva.com/insync/#inSync_Client).
For upgrade instructions, see [Upgrade the inSync Client](https://docs.druva.com/internal/Documentation/inSync/Old_inSync_Cloud_Admin_Guides/User_Guide/020_Configuring_inSync_Client/Upgrade_the_inSync_Client).
Customers are advised to contact [Support](https://support.druva.com/) for technical assistance.

## Vulnerabilities

**CVE-2021-36665 - Insecure deserialization leading to arbitrary code execution**

Insecure deserialization vulnerability in the inSyncUpgrade could allow an attacker with user-level privileges to execute arbitrary code and escalate privileges to root by supplying an upgrade package with a malicious signature.

**CVE-2021-36666 - Code Injection via arbitrary dynamic library loading**

Code injection vulnerability in Mac Client could allow an attacker with user-level privileges on the system to load random libraries and escalate privileges to root via DYLD\_INSERT\_LIBRARIES environment variable.

**CVE-2021-36667 - OS Command Injection Vulnerability in local HTTP server**

OS command injection vulnerability in Mac Client's local HTTP server could allow an attacker with user-level privileges on the device to execute arbitrary OS commands as a non-root user.

**CVE-2021-36668 - URL Injection in inSync Client**

URL Injection vulnerability in inSync Electron UI could allow a local, authenticated attacker to execute arbitrary NodeJS code by manipulating a port number parameter.

**Vulnerability details, CVSS Scoring and Metrics:**

| **Vulnerability** | **CVE ID** | **CVSSv3Base Score** | **CVSSv3.1 Vector** | **Severity** | **Platform** |
| --- | --- | --- | --- | --- | --- |
| Insecure deserialization leading to arbitrary code execution | CVE-2021-36665 | 7.5 | [AV:L/AC:H/PR:L/UI:N/S:C/C:H/I:H/A:N](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV%3AL%2FAC%3AH%2FPR%3AL%2FUI%3AN%2FS%3AC%2FC%3AH%2FI%3AH%2FA%3AN&version=3.1) | High | Windows, macOS |
| Code Injection via arbitrary dynamic library loading | CVE-2021-36666 | 7.5 | [AV:L/AC:H/PR:L/UI:N/S:C/C:H/I:H/A:N](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV%3AL%2FAC%3AH%2FPR%3AL%2FUI%3AN%2FS%3AC%2FC%3AH%2FI%3AH%2FA%3AN&version=3.1) | High | macOS |
| OS Command Injection Vulnerability in local HTTP server | CVE-2021-36667 | 4.4 | [AV:L/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:N](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV%3AL%2FAC%3AL%2FPR%3AL%2FUI%3AN%2FS%3AU%2FC%3AL%2FI%3AL%2FA%3AN&version=3.1) | Medium | macOS |
| URL Injection vulnerability in inSync App | CVE-2021-36668 | 5.3 | [AV:L/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV%3AL%2FAC%3AL%2FPR%3AL%2FUI%3AN%2FS%3AU%2FC%3AL%2FI%3AL%2FA%3AL&version=3.1) | Medium | Windows, macOS, Linux (Ubuntu) |

## Acknowledgments

Druva would like to thank Mr. Oliver Grubin ( info@olvrgrbn.com ) for taking the effort to report these vulnerabilities by participating in coordinated and responsible disclosure.

## References

* [Release Notes for inSync Client v7.0.0](https://docs.druva.com/005_inSync_Client/inSync_Client_7.0.0_for_inSync_Cloud/000Release_Details/Release_Notes_for_inSync_Client_v7.0.0)
* [Release Notes for inSync Client v7.1.0](https://help.druva.com/en/collections/7941606-insync-client-for-endpoints)
* Druva utilizes the Common Vulnerability Scoring System (CVSS) base score and metrics by the **National Institute of Standards and Technology** in the National Vulnerability Database. For more information on CVSS and score calculation system, see [Common Vulnerability Scoring System: Specification Document](https://www.first.org/cvss/specification-document).

---

Related Articles[Release Notes - inSync Client](https://help.druva.com/en/articles/8829600-release-notes-insync-client)[Download Link for inSync Client](https://help.druva.com/en/articles/8829618-download-link-for-insync-client)[Uninstall inSync Client](https://help.druva.com/en/articles/8829622-uninstall-insync-client)[Upgrade the inSync Client](https://help.druva.com/en/articles/8829623-upgrade-the-insync-client)[Start the inSync Client](https://help.druva.com/en/articles/8829624-start-the-insync-client)Did this answer your question?üòûüòêüòÉ[![Druva | Documentation](https://downloads.intercomcdn.com/i/o/440690/1a2d657ec884f670fda4ec8e/31e15d955d73babef21f49bb8f1142ee.png)](/en/)Druva ¬© 2024. All rights reserved.

* [![](https://intercom.help/druva-help-center/assets/svg/icon:social-linkedin/F8F9FA)](https://www.linkedin.com/company/druva)
* [![](https://intercom.help/druva-help-center/assets/svg/icon:social-facebook/F8F9FA)](https://www.facebook.com/DruvaInc)
* [![](https://intercom.help/druva-help-center/assets/svg/icon:social-twitter-x/F8F9FA)](https://www.twitter.com/druvainc)

Support Community

* [Forum](https://support.druva.com/DRC_DiscussionsForums)
* [Knowledge Base](https://help.druva.com/en/collections/7848424-knowledge-base)

Support Resources

* [Druva Academy](https://academy.druva.com/)
* [Cloud Status](https://status.druva.com/)
* [Support](https://support.druva.com/)

More Reference Links

* [Druva.com](https://www.druva.com/)
* [Featured Resources](https://www.druva.com/resources/)
* [Druva Blog](https://www.druva.com/blog/)
* [Contact Us](https://www.druva.com/about/contact-us)

Druva Privacy Policy

* [Privacy Policy](https://www.druva.com/privacy-policy/)


=== Content from druva.com_4f4ae7d7_20250108_141751.html ===


Language

* [English](/)
* [Deutsch](/de)

[![Druva Logo](/adobe/dynamicmedia/deliver/dm-aid--aba77bd6-9fac-4e37-9f84-73f2bbed462c/druva-logo-reversed.png?preferwebp=true&quality=85)](/)

* [Platform](/products)
  + Data Security Cloud
    ![](/content/dam/druvaincprogram/icons/orange-icon_data-security-cloud.png)
    Data Security Cloud

    Fully managed data security across enterprise, cloud, SaaS, and end user.

    - [Overview](/products/platform-overview)
    - [Plans & Pricing](/products/pricing-plans)
    - [Trust Center](https://security.druva.com/)
  + Data Protection
    [![](/content/dam/druvaincprogram/icons/navy-icon_data-protection.png)
    Data Protection](/solutions/cloud-data-protection)

    Modernize data protection to reduce costs and complexity

    - [Public Cloud Backup](/solutions/cloud-backup)
    - [Hybrid Cloud Backup](/products/data-center)
    - [End User & SaaS Apps Backup](/use-cases/saas-backup)
  + Cyber Response & Recovery
    [![](/content/dam/druvaincprogram/icons/navy-icon_global-check.png)
    Cyber Response & Recovery](/solutions/cyber-resilience-compliance-monitoring)

    Bounce back from cyber attacks with data that is always safe and ready.

    - [Accelerated Ransomware Recovery](/use-cases/ransomware)
    - [Security Posture & Observability](/use-cases/security-posture-and-observability)
    - [Managed Data Detection & Response](/solutions/managed-ddr)
  + eDiscovery & Compliance
    [![](/content/dam/druvaincprogram/icons/navy-icon_governance.png)
    eDiscovery & Compliance](/use-cases/compliance)

    Secure, protect, and streamline data governance.

    - [Sensitive Data Governance](/use-cases/compliance)
    - [eDiscovery & Legal Hold](/use-cases/ediscovery)
    - [Cloud Archive & Retention](/use-cases/long-term-data-retention)
  + [![](/content/dam/druvaincprogram/icons/navy-icon_shiny-annoucement.png)
    Meet Dru - Your Copilot for Data Security](/use-cases/ai)
* Solutions
  + Use Cases
    Use Cases

    Learn how Druva helps you accelerate key business initiatives

    - [Accelerate and Protect Multi-Cloud](/solutions/accelerate-protect-cloud-projects)
    - [Ransomware Recovery Readiness](/solutions/cyber-resilience-compliance-monitoring)
    - [Threat Hunting](/solutions/threat-hunting)
    - [Data Protection Modernization](/solutions/cloud-data-protection)
    - [End User Protection](/solutions/end-user-protection)
    - [Remote and Branch Office Backup](/products/remote-office-backup-recovery)
    - [Cloud Disaster Recovery](/use-cases/cloud-disaster-recovery)
    - [Druva vs. Veeam: See the SaaS Advantage](/comparison/druva-vs-veeam)
  + Key Technologies
    - Public Cloud
      Public Cloud

      Protect native AWS and Azure deployments with secure backups without the cost and complexity

      * [AWS Backup](/use-cases/aws-cloud-backup)
      * [Amazon EC2](/solutions/amazon-ec2-backup)
      * [Amazon RDS](/solutions/amazon-rds-backup)
      * [Azure](/solutions/azure-vm-backup)
    - Hybrid Workloads
      Hybrid Workloads

      Transform data center backup and disaster recovery for virtual environments

      * [VMware](/solutions/vmware-cloud-backup)
      * [Hyper-V](/solutions/hyper-v)
      * [Nutanix](/solutions/nutanix)
      * [Oracle](/solutions/oracle-data-protection)
      * [MS SQL](/solutions/sql)
      * [SAP HANA](/solutions/sap-hana-backup)
      * [NAS/files](/solutions/nas-backup)
    - Endpoint and SaaS Apps
      [Endpoint and SaaS Apps](/solutions/enterprise-workloads/applications)

      Enterprise Cloud Backup and data management across edge, on-premises and cloud workloads

      * [End User Protection](/solutions/end-user-protection)
      * [Microsoft 365](/solutions/microsoft-365-backup)
      * [Microsoft 365 Backup Storage](/solutions/microsoft-365-backup-storage)
      * [Microsoft Entra ID](/solutions/microsoft-entra-id)
      * [Microsoft Dynamics 365](/solutions/microsoft-dynamics-365)
      * [Salesforce](/solutions/salesforce)
      * [Google Workspace](/solutions/google-workspace)
  + [Free Trial](https://login.druva.com/signup)
* [Customers](/customers)
  + [Explore All Customer Stories](/customers)

    We are trusted by the world's leading organizations to protect their data. Explore customer success stories to see how your peers are using Druva.
  + [![](/content/dam/druvaincprogram/logos/customers/medallia.jpg)](/customers/medallia)

    Ransomware recovery ready

    [Learn why Medallia chose Druva](/customers/medallia)

    [![](/content/dam/druvaincprogram/logos/customers/regeneron.png)](/customers/regeneron)

    SaaS data protection across the enterprise

    [See why Regeneron partnered with Druva](/customers/regeneron)
* [Resources](/resources)
  + - [Analyst Research](/resources/analyst-reports)
    - [eBooks](/resources/ebooks)
    - [Data Resilience](/data-resilience)
    - [Glossary of Terms](/glossary)
    - [Product Demos](/resources/product-demos)
    - [Solution Briefs](/resources/solution-briefs)
    - [White Papers](/resources/white-papers)
    - [Datasheets](/resources/datasheets)
    - [Testimonials](/resources/testimonials)
  + [![](/content/dam/druvaincprogram/thumbnails/tco-calc-nav-thmb.png)](/comparison/druva-vs-veeam-tco)

    Druva vs. Veeam TCO Calculator

    [Find the hidden costs of legacy backup](/comparison/druva-vs-veeam-tco)

    [![](/content/dam/druvaincprogram/thumbnails/resources/Tmb_Reports_Forrester-TEI-Study.png)](https://www.druva.com/resources/analyst-report/analyst-report-forrester-tei-2024)

    Forrester: Total Economic Impact of Druva 2024

    [Customers see 224% ROI: Find out how](https://www.druva.com/resources/analyst-report/analyst-report-forrester-tei-2024)
* Partners
  + Programs
    Programs

    Learn how you can profit with Druva and a cloud-first SaaS selling motion. Explore partner programs, access resources, and discover the benefits of partnering with Druva.

    - [Partner+ Program](/partners/partner-program)
    - [Security Integrations](/partners/security-integrations)
    - [Technology Partners](/partners/technology-alliance-program)
    - [Managed Service Providers](/partners/msp-partner-program)
    - [Public Sector](/use-cases/public-sector)
  + Strategic Partners
    Strategic Partners

    Learn about Druva's strategic capabilities across platform, OEM, and other partnerships. Find out how Druva accelerates and protects customers' cloud journeys.

    - [Dell Technologies](/partners/dell)
    - [AWS](/partners/aws)
    - [VMware](/partners/vmware)
    - [Nutanix](/partners/nutanix)
  + [Become a Partner](https://partnerportal.druva.com/English/register_email.aspx)
* [Company](/about)
  + - [Company](/about)
    - [Leadership](/about/leadership)
    - [Investors](/about/investors)
    - [Careers](/about/careers)
    - [Contact Us](/about/contact-us)
    - [Newsroom](/about/news)
    - [Awards](/about/awards)
    - [Events](/about/events)
    - [Diversity, Equity & Inclusion](/about/diversity)
    - [Blog](/blog)
  + [![](/content/dam/druvaincprogram/icons/Blue-icons_contact-us.svg)](/about/contact-us)

    Get in touch with us

    [Contact Us](/about/contact-us)

    [![](/content/dam/druvaincprogram/icons/Blue-icons_blog.svg)](/blog)

    News, product innovations, and more

    [Blog](/blog)
* [Get Started](/get-started)
* [Support](/support "Support")
* [Login](https://login.druva.com)
* Language
  + [English](/)
  + [Deutsch](/de)

# Data Security on Autopilot.

Data threats are continuously evolving ‚Äì cyber attacks, exfiltration risks, and privacy fines are the new normal.¬†Druva makes data security autonomous with a 100% SaaS, fully managed cloud platform to secure and recover your data from any threat.

[Take a Tour](/tours)

[Druva $10M Guarantee](/resiliency-guarantee)

![overview video](/homepage/_jcr_content/root/container/container/hero_copy_copy/ctaVideo.coreimg.png/1722533938787/homepage-hero-video-thmb-never-worry.png)

√ó

[30-Day Free Trial](https://login.druva.com/signup)

![dru investigate icon](/content/dam/druvaincprogram/icons/white-icon_backup-and-protection_reduced.svg)

## Explore Druva's Best-in-Class AWS Backup, Including EC2 & RDS

[Learn More](https://www.druva.com/use-cases/aws-cloud-backup?int=gradient-banner)

![circle diagram](/adobe/dynamicmedia/deliver/dm-aid--9e30ea61-34fa-441b-be80-0f54dc3bec0c/circle-diagram-bare-1220x.png?preferwebp=true&quality=85)

## Data Security Cloud

![](/content/dam/druvaincprogram/icons/white-icon_rapid-response.png)

**Autonomous Protection**

![](/content/dam/druvaincprogram/icons/white-icon_auto-protection.png)

**Rapid Response**

![](/content/dam/druvaincprogram/icons/white-icon_guaranteed-rec.png)

**Guaranteed Recovery**

![](/content/dam/druvaincprogram/icons/orange-icon_data-protection.png)
[Data Protection](/solutions/cloud-data-protection)

![](/content/dam/druvaincprogram/icons/orange-icon_cyber-resiliency.png)
[Cyber Response & Recovery](/solutions/cyber-resilience-compliance-monitoring)

![](/content/dam/druvaincprogram/icons/orange-icon_risk-compliance.png)
[eDiscovery & Compliance](/use-cases/compliance)

Trusted by the world‚Äôs leading organizations

![](/content/dam/druvaincprogram/logos/homepage-logo-wall/logo-river_coldwell-banker.webp)
![](/content/dam/druvaincprogram/logos/homepage-logo-wall/logo-river_amgen.svg)
![](/content/dam/druvaincprogram/logos/homepage-logo-wall/logo-river_brown-forman.webp)
![](/content/dam/druvaincprogram/logos/homepage-logo-wall/logo-river_clorox.webp)
![](/content/dam/druvaincprogram/logos/homepage-logo-wall/logo-river_chipotle.webp)
![](/content/dam/druvaincprogram/logos/homepage-logo-wall/logo-river_hitachi.webp)
![](/content/dam/druvaincprogram/logos/homepage-logo-wall/logo-river_jamf.webp)

![](/content/dam/druvaincprogram/logos/homepage-logo-wall/logo-river_leica.svg)

![](/content/dam/druvaincprogram/logos/homepage-logo-wall/logo-river_marriott.webp)

![](/content/dam/druvaincprogram/logos/homepage-logo-wall/logo-river_nasa.webp)

![](/content/dam/druvaincprogram/logos/homepage-logo-wall/logo-river_regeneron.webp)

![](/content/dam/druvaincprogram/logos/homepage-logo-wall/logo-river_sofi.webp)

![](/content/dam/druvaincprogram/logos/homepage-logo-wall/logo-river_shearman.png)

![](/content/dam/druvaincprogram/logos/homepage-logo-wall/logo-river_takeda.svg)

![](/content/dam/druvaincprogram/logos/homepage-logo-wall/logo-river_coldwell-banker.webp)

![](/content/dam/druvaincprogram/logos/homepage-logo-wall/logo-river_amgen.svg)

![](/content/dam/druvaincprogram/logos/homepage-logo-wall/logo-river_brown-forman.webp)

![](/content/dam/druvaincprogram/logos/homepage-logo-wall/logo-river_clorox.webp)

![](/content/dam/druvaincprogram/logos/homepage-logo-wall/logo-river_chipotle.webp)

![](/content/dam/druvaincprogram/logos/homepage-logo-wall/logo-river_hitachi.webp)

![](/content/dam/druvaincprogram/logos/homepage-logo-wall/logo-river_jamf.webp)

![](/content/dam/druvaincprogram/logos/homepage-logo-wall/logo-river_leica.svg)

![](/content/dam/druvaincprogram/logos/homepage-logo-wall/logo-river_marriott.webp)

![](/content/dam/druvaincprogram/logos/homepage-logo-wall/logo-river_nasa.webp)

![](/content/dam/druvaincprogram/logos/homepage-logo-wall/logo-river_regeneron.webp)

![](/content/dam/druvaincprogram/logos/homepage-logo-wall/logo-river_sofi.webp)

![](/content/dam/druvaincprogram/logos/homepage-logo-wall/logo-river_shearman.png)

![](/content/dam/druvaincprogram/logos/homepage-logo-wall/logo-river_takeda.svg)

Trusted by the world‚Äôs leading organizations

![](/content/dam/druvaincprogram/logos/homepage-logo-wall/logo-river_coldwell-banker.webp)

![](/content/dam/druvaincprogram/logos/homepage-logo-wall/logo-river_amgen.svg)

![](/content/dam/druvaincprogram/logos/homepage-logo-wall/logo-river_brown-forman.webp)

![](/content/dam/druvaincprogram/logos/homepage-logo-wall/logo-river_clorox.webp)

![](/content/dam/druvaincprogram/logos/homepage-logo-wall/logo-river_chipotle.webp)

![](/content/dam/druvaincprogram/logos/homepage-logo-wall/logo-river_hitachi.webp)

![](/content/dam/druvaincprogram/logos/homepage-logo-wall/logo-river_jamf.webp)

![](/content/dam/druvaincprogram/logos/homepage-logo-wall/logo-river_leica.svg)

![](/content/dam/druvaincprogram/logos/homepage-logo-wall/logo-river_marriott.webp)

![](/content/dam/druvaincprogram/logos/homepage-logo-wall/logo-river_nasa.webp)

![](/content/dam/druvaincprogram/logos/homepage-logo-wall/logo-river_regeneron.webp)

![](/content/dam/druvaincprogram/logos/homepage-logo-wall/logo-river_sofi.webp)

![](/content/dam/druvaincprogram/logos/homepage-logo-wall/logo-river_shearman.png)

![](/content/dam/druvaincprogram/logos/homepage-logo-wall/logo-river_takeda.svg)

![](/content/dam/druvaincprogram/logos/homepage-logo-wall/logo-river_coldwell-banker.webp)

![](/content/dam/druvaincprogram/logos/homepage-logo-wall/logo-river_amgen.svg)

![](/content/dam/druvaincprogram/logos/homepage-logo-wall/logo-river_brown-forman.webp)

![](/content/dam/druvaincprogram/logos/homepage-logo-wall/logo-river_clorox.webp)

![](/content/dam/druvaincprogram/logos/homepage-logo-wall/logo-river_chipotle.webp)

![](/content/dam/druvaincprogram/logos/homepage-logo-wall/logo-river_hitachi.webp)

![](/content/dam/druvaincprogram/logos/homepage-logo-wall/logo-river_jamf.webp)

![](/content/dam/druvaincprogram/logos/homepage-logo-wall/logo-river_leica.svg)

![](/content/dam/druvaincprogram/logos/homepage-logo-wall/logo-river_marriott.webp)

![](/content/dam/druvaincprogram/logos/homepage-logo-wall/logo-river_nasa.webp)

![](/content/dam/druvaincprogram/logos/homepage-logo-wall/logo-river_regeneron.webp)

![](/content/dam/druvaincprogram/logos/homepage-logo-wall/logo-river_sofi.webp)

![](/content/dam/druvaincprogram/logos/homepage-logo-wall/logo-river_shearman.png)

![](/content/dam/druvaincprogram/logos/homepage-logo-wall/logo-river_takeda.svg)

## Combat cyber exposure. Recover confidently.

Out-of-the-box air-gapped backups, deep visibility into data, and strict SLAs with cloud-scale recovery

### Every application. Every location. Every cloud. One platform.

[![](/content/dam/druvaincprogram/logos/workloads-cloud-diagram/workloads-logos_aws.svg)](/solutions/amazon-ec2-backup)
[![](/content/dam/druvaincprogram/logos/workloads-cloud-diagram/workloads-logos_m365.svg)](/solutions/microsoft-365-backup)
[![](/content/dam/druvaincprogram/logos/workloads-cloud-diagram/workloads-logos_oracle.svg)](/solutions/oracle-data-protection)
[![](/content/dam/druvaincprogram/logos/workloads-cloud-diagram/azure-logo.png)](/solutions/azure-vm-backup)
[![](/content/dam/druvaincprogram/logos/workloads-cloud-diagram/workloads-logos_google-workspace.svg)](/solutions/google-workspace)
[![](/content/dam/druvaincprogram/logos/logo-salesforce.svg)](/solutions/salesforce)
[![](/content/dam/druvaincprogram/logos/workloads-cloud-diagram/workloads-logos_vmware.svg)](/solutions/vmware-cloud-backup)
[![](/content/dam/druvaincprogram/logos/workloads/mac-os.webp)](/use-cases/endpoint-backup)
[![](/content/dam/druvaincprogram/logos/workloads-cloud-diagram/workloads-logos_nutanix.svg)](/solutions/nutanix)
[![](/content/dam/druvaincprogram/logos/workloads-cloud-diagram/workloads-logos_microsoft-sql.png)](/solutions/sql)
[![](/content/dam/druvaincprogram/logos/workloads-cloud-diagram/workloads-logos_sap-hana.png)](/solutions/sap-hana-backup)
[![](/content/dam/druvaincprogram/logos/workloads-cloud-diagram/workloads-logos_linux.png)](/use-cases/endpoint-backup)

![druva ai video](/homepage/_jcr_content/root/container/container/container_1573716571/container_1549234114/container_copy/dual_teasers_650572817/teaser1/video.coreimg.png/1714587084061/ai-demo-2-promo-thmb.png)

√ó

Demo

**Simply ask Dru and be taken directly where needed. Dru even follows up with suggested next actions.**

Navigate the Druva platform with AI

√ó

[![](/adobe/dynamicmedia/deliver/dm-aid--1e9a2342-8a4a-4868-9a99-e50c645cc0c9/tco-calc-nav-thmb.png?preferwebp=true&quality=85)](/comparison/druva-vs-veeam-tco)

TCO Calculator

**Break free from the hidden costs of legacy backup. Generate a custom report and see how much you could save with Druva.**

[Create your report](/comparison/druva-vs-veeam-tco)

## Is Druva right for me?

![globe](/homepage/_jcr_content/root/container/container/container_1573716571/container_1549234114/omni_container/omni_flip/flipImage.coreimg.svg/1680562893681/white-icon-instant-recovery.svg)

#### Can I confidently recover from ransomware at scale?

###### Can I confidently recover from ransomware at scale?

Druva bridges the gap between security and backup by improving data observability and offering an integrated approach to faster, and more secure, ransomware recovery.

[Security Posture & Observability](/use-cases/security-posture-and-observability)

[Accelerated Ransomware Recovery](/use-cases/ransomware)

[The Data Resiliency Guarantee](/resiliency-guarantee)

![shields](/homepage/_jcr_content/root/container/container/container_1573716571/container_1549234114/omni_container/omni_flip_2032988430/flipImage.coreimg.svg/1680562893453/white-icon-protected-cloud.svg)

#### Is a cloud SaaS platform right for my data protection needs?

###### Is a cloud SaaS platform right for my data protection needs?

Your organization is already using the cloud for production or productivity applications. Extend the benefits of cloud to your data protection environment and further eliminate the need for hardware, software and maintenance.

[AWS Workloads](/solutions/amazon-ec2-backup)

[Microsoft 365](/solutions/microsoft-365-backup)

[Salesforce](/solutions/salesforce)

![pay me](/homepage/_jcr_content/root/container/container/container_1573716571/container_1549234114/omni_container/omni_flip_821137766/flipImage.coreimg.svg/1680562893474/white-icon-cost-savings.svg)

#### How does Druva‚Äôs cost compare to other solutions?

###### How does Druva‚Äôs cost compare to other solutions?

Only Druva‚Äôs SaaS cloud-based backup and data security approach lowers TCO by eliminating hardware, software, and maintenance, consolidating multiple solutions, and offering consumption-based pricing.

[TCO Calculator](https://tco.druva.com/)

[Druva‚Äôs advantage versus
traditional solutions](/products/saas-advantage)

[Pricing](/products/pricing-plans)

## The endgame for data resiliency

See how the next generation of cloud SaaS platform changes the game

### Radically simple

* **Zero complexity.**¬†No backup hardware, no software, no appliances. Just a 100% SaaS cloud data solution.
* **Unified services.**Manage all your applications, services, security, and reporting from a single console.
* **Automated (everything).**¬†Automate backup, disaster recovery, security and compliance for true simplicity.

![radically-simple](/adobe/dynamicmedia/deliver/dm-aid--11069916-155b-42c7-8f7e-729d5578447f/radically-simple.png?preferwebp=true&quality=85)
![radically-simple](/adobe/dynamicmedia/deliver/dm-aid--11069916-155b-42c7-8f7e-729d5578447f/radically-simple.png?preferwebp=true&quality=85)
√ó

### Cyber secure

* **Zero-trust architecture.**Protect all your data easily with access control, built-in air-gap, immutability, and encryption.
* **Centralized security reporting**¬†across all applications from a centralized console, 24/7.
* **Accelerated ransomware recovery** with automated response following an attack.

![cyber secure](/adobe/dynamicmedia/deliver/dm-aid--1cb55e01-9fac-458b-98aa-6c11a49f91ec/cyber-secure.png?preferwebp=true&quality=85)
![cyber secure](/adobe/dynamicmedia/deliver/dm-aid--1cb55e01-9fac-458b-98aa-6c11a49f91ec/cyber-secure.png?preferwebp=true&quality=85)
√ó

### Infinitely scalable

* **Automatic and on-demand resource scaling.** Scale resources automatically, or on-demand.
* **Unlimited resources.** Unlimited storage ready so your backups won‚Äôt fail.
* **Deployable anywhere.** Cloud-native design, powered by Amazon Web Services.

![infinte-scalable](/adobe/dynamicmedia/deliver/dm-aid--aa5acb04-3081-4c5f-8282-4a3437a6a49f/infinitely-scalable.png?preferwebp=true&quality=85)
![infinte-scalable](/adobe/dynamicmedia/deliver/dm-aid--aa5acb04-3081-4c5f-8282-4a3437a6a49f/infinitely-scalable.png?preferwebp=true&quality=85)
√ó

### SaaS efficiency

* **Data security cloud optimized for advantage.** Automatic updates to stay secure and protected without maintenance.
* **Consumption pricing**¬†to eliminate idle capacity and reduce costs.
* **Reduced IT overhead.**¬† Consolidate backup silos and multiple vendors.

![saas-efficiency](/adobe/dynamicmedia/deliver/dm-aid--f6d08a1f-8ac4-4d2e-8c35-1e742459b54e/saas-efficiency.png?preferwebp=true&quality=85)
![saas-efficiency](/adobe/dynamicmedia/deliver/dm-aid--f6d08a1f-8ac4-4d2e-8c35-1e742459b54e/saas-efficiency.png?preferwebp=true&quality=85)
√ó

### Resiliency guaranteed

* **Total protection.** Zero compromises.
* **Coverage** for 5 key data risks.
* **Data health check** to ensure data is safe.

![resiliency](/adobe/dynamicmedia/deliver/dm-aid--8b79b216-246e-45d1-84a2-01677e0b2cb9/resiliency-guaranteed.png?preferwebp=true&quality=85)
![resiliency](/adobe/dynamicmedia/deliver/dm-aid--8b79b216-246e-45d1-84a2-01677e0b2cb9/resiliency-guaranteed.png?preferwebp=true&quality=85)
√ó

![](/homepage/_jcr_content/root/container/container/container_313327732/teaser.coreimg.svg/1721934063600/white-icon-product-tour.svg)

## Got 5 minutes?

Experience the data security cloud platform firsthand

[Take a Tour](/tours)

> ‚Äú‚Äù

Explore the customer story

### Druva Recognized as a 2024 Customers' Choice

A 2024 Gartner¬Æ Peer Insights‚Ñ¢ Customers‚Äô Choice for Disaster Recovery as a Service

[Read now](https://www.druva.com/resources/reports/analyst-report-gartner-peer-insights-customers-choice-draas)

[![gartner-peer](/adobe/dynamicmedia/deliver/dm-aid--d2f6eae6-8f5b-4255-a7f9-948e88141d40/gartner-pi-cc-2024.png?preferwebp=true&quality=85)](https://www.druva.com/resources/analyst-report/analyst-report-gartner-2024-ebrss-voc)

## Get started now.

See for yourself why Druva is the leader in data resiliency.

[Request a Demo](/demo)

[Contact Us](/about/contact-us)

### Druva Data Security Cloud

* [Overview](/products/platform-overview)
* [Plans & Pricing](/products/pricing-plans)
* [Trust Center](https://security.druva.com/)
* [Meet Dru: Druva's AI Copilot for Data Security](/use-cases/ai)

### The Druva Platform

* [Autonomous Protection](/products/platform-overview/autonomous-protection)
* [Rapid Response](/products/platform-overview/rapid-response)
* [Guaranteed Recovery](/products/platform-overview/guaranteed-recovery)

### Data Protection

* [Public Cloud Backup](/solutions/cloud-backup)
* [Hybrid Cloud Backup](/products/data-center)
* [End User & SaaS Apps Backup](/use-cases/saas-backup)

### Cyber Response & Recovery

* [Accelerated Ransomware Recovery](/use-cases/ransomware)
* [Security Posture & Observability](/use-cases/security-posture-and-observability)
* [Managed Data Detection & Response](/solutions/managed-ddr)

### eDiscovery & Compliance

* [Sensitive Data Governance](/use-cases/compliance)
* [eDiscovery & Legal Hold](/use-cases/ediscovery)
* [Cloud Archive & Retention](/use-cases/long-term-data-retention)

### Use Cases

* [Accelerate and Protect Multi-Cloud](/solutions/accelerate-protect-cloud-projects)
* [Ransomware Recovery Readiness](/solutions/cyber-resilience-compliance-monitoring)
* [Data Protection Modernization](/solutions/cloud-data-protection)
* [End User Protection](/solutions/end-user-protection)
* [Remote and Branch Office Backup](/products/remote-office-backup-recovery)
* [Cloud Disaster Recovery](/use-cases/cloud-disaster-recovery)

### Key Technologies

* [Amazon EC2](/solutions/amazon-ec2-backup)
* [Azure](/solutions/azure-vm-backup)
* [VMware](/solutions/vmware-cloud-backup)
* [Hyper-V](/solutions/hyper-v)
* [Nutanix](/solutions/nutanix)
* [Oracle](/solutions/oracle-data-protection)
* [MS SQL](/solutions/sql)
* [SAP HANA](/solutions/sap-hana-backup)
* [NAS/files](/solutions/nas-backup)
* [End User Protection](/solutions/end-user-protection)
* [Microsoft 365](/solutions/microsoft-365-backup)
* [Salesforce](/solutions/salesforce)
* [Google Workspace](/solutions/google-workspace)
* [Microsoft Entra ID](/solutions/microsoft-entra-id)

### Customers

* [Customers](/customers)

### Resources

* [Analyst Research](/resources/analyst-reports)
* [Cloud Data Protection](/protecting-data-in-the-cloud)
* [Datasheets](/resources/datasheets)
* [Data Resilience](/data-resilience)
* [Product Demos](/resources/product-demos)
* [eBooks](/resources/ebooks)
* [Glossary of Terms](/glossary)
* [Infographics](/resources/infographics)
* [Ransomware Recovery](/ransomware-recovery-readiness)
* [Solution Briefs](/resources/solution-briefs)
* [Tipsheets](/resources/tipsheets)
* [Videos](/resources/videos)
* [White Papers](/resources/white-papers)

### Partners

* [Dell Technologies](/partners/dell)
* [AWS](/partners/aws)
* [VMware](/partners/vmware)
* [Nutanix](/partners/nutanix)
* [Partner+ Program](/partners/partner-program)
* [Technology Partners](/partners/technology-alliance-program)
* [Managed Service Providers](/partners/msp-partner-program)
* [Public Sector](/use-cases/public-sector)

### Company

* [Company](/about)
* [Investors](/about/investors)
* [Leadership](/about/leadership)
* [Corporate Responsibility](/about/corporate-responsibility)
* [Diversity, Equity & Inclusion](/about/diversity)
* [Blog](/blog)
* [Careers](/about/careers)
* [Newsroom](/about/news)
* [Events](/about/events)
* [Privacy Policy](/privacy-policy)
* [Legal and Compliance](/legal)
* [Modern Slavery Act](https://www.druva.com/documents/uk-modern-slavery-act.pdf)
* [Pandemic Response](/pandemic-response)

Americas

**1-800-375-0160**

EMEA

**+44 (0) 20 3750 9440**

More regions

[Contact us](/about/contact-us)

¬©¬†2025 Druva Inc. and/or its affiliates. All rights reserved. Various trademarks held by their respective owners.

[Privacy Policy](https://www.druva.com/privacy-policy/) [| SaaS Backup Privacy Policy](https://www.druva.com/insync-privacy-policy/) [| Disclosure Policy](https://www.druva.com/disclosure-policy/)[| Cookie Policy](https://www.druva.com/cookie-policy/)[| Terms of Use |](https://www.druva.com/terms-of-use/)



=== Content from imhotepisinvisible.com_1e57d520_20250108_141754.html ===

[# Imhotep Is Invisible](https://imhotepisinvisible.com)

# Druva inSync for Mac Local Privilege Escalation

## tldr

This research details four CVEs in [Druva inSync](https://www.druva.com/products/endpoints/) that allow local privilege escalation to the root user on MacOS. These issues have been [patched by the Druva team](https://docs.druva.com/Knowledge_Base/Security_Update/Security_Advisory_for_inSync_Client_7.0.1_and_before). If you're using the product, now would be a good time to check if you're up to date. Otherwise, skip down to the videos to watch it in action, or keep reading for all the details.

[CVE-2021-36665](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-36665):
An issue was discovered in Druva 6.9.0 for MacOS, allows attackers to gain escalated local privileges via the inSyncUpgradeDaemon.

[CVE-2021-36666](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-36666):
An issue was discovered in Druva 6.9.0 for MacOS, allows attackers to gain escalated local privileges via the inSyncDecommission.

[CVE-2021-36667](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-36667):
Command injection vulnerability in Driva inSync 6.9.0 for MacOS, allows attackers to execute arbitrary commands via crafted payload to the local HTTP server due to unsanitized call to the python os.system library.

[CVE-2021-36668](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-36668):
URL injection in Driva inSync 6.9.0 for MacOS, allows attackers to force a visit to an arbitrary url via the port parameter to the Electron App.

## What is Druva inSync?

[Druva inSync](https://www.druva.com/products/endpoints/) is an enterprise solution for backing up user endpoints. The client is written in Python 2 (!) alongside an Electron app (powered by a very out of date version of Electron) that provides a UI for users.

On Mac there are several binaries bundled in the app package:

```
inSync
inSyncUpgrade
inSyncUpgradeDaemon
inSyncDecommission

```

They all run as part of normal operation:

![](running-binaries.png)

They communicate with each other via HTTP or Unix socket, depending on the binary. Both inSyncDecommission and inSyncUpgradeDaemon are configured as LaunchDaemons and run as root. This means that if we can talk to either of them then we may be able to use them to perform our own actions with root privileges.

![](running-listeners.png)

Luckily, the communications between them are not fully unauthenticated. The user level binaries use a variety of keys stored in the Keychain to communicate with the root daemons. Those keys are accessed via a custom native Python module (packaged as `keychainAPI.so`) and the access is configured to allow each binary to read the secret without prompting for a password.

![](keychain.png)

What does that mean for us? If we can convince one of the usermode programs to give up the keychain secret to us, we can use that ourselves to talk to the root daemons!

## Decompiling

To get anywhere, it will be helpful to inspect the Druva binaries further. On Mac the Druva applications are packaged using PyInstaller. We can use existing tooling to extract the original pyc, and then py files from the binaries. We also have to de-obfuscate the opcodes, which we can do using the [same technique](https://medium.com/tenable-techblog/remapping-python-opcodes-67d79586bfd5) outlined in the last public vulnerability research into inSync.

Once we‚Äôve decompiled the apps we can start poking around. `inSyncDecommission` and `inSyncUpgradeDaemon` are both running RPC servers that are authenticated (as expected) with keys from the keychain. Let‚Äôs see what we can do.

## Exploit 1: inSyncUpgradeDaemon

Decompiling `inSyncUpgradeDaemonRPC.py` we can see the `daemon_install_package` method runs a shell script and blindly executes as root whatever package has been handed to it by the usermode `inSyncUpgrade`.

```
def daemon_install_package(ctx, installer, uname):
    try:
        import stat
        os.chmod(installer, stat.S_IXUSR)
        if not os.path.exists(inSyncParam.CLIENT_GLOBAL_ROOT):
            try:
                os.makedirs(inSyncParam.CLIENT_GLOBAL_ROOT)
            except Exception as fault:
                SyncLog.error('Could not create directory %s', inSyncParam.CLIENT_GLOBAL_ROOT)
        installfilepath = os.path.join(inSyncParam.CLIENT_GLOBAL_ROOT, 'install.sh')
        if os.path.exists('/Volumes/inSync'):
            ret, out = commands.getstatusoutput('hdiutil unmount /Volumes/inSync')
        ret, out = commands.getstatusoutput('hdiutil mount "%s"' % installer)
        if ret != 0:
            SyncLog.error('An error occurred while mounting dmg file')
        SyncLog.info('Creating %s', installfilepath)
        FILE = open(installfilepath, 'w')
        FILE.write('#!/bin/sh\n')
        FILE.write('{\n')
        FILE.write('echo `date` "install.sh execution started"\n')
        FILE.write('cd /Volumes/inSync/\n')
        FILE.write('pkg_name=$(ls | grep -i pkg | head -n1)\n')
        FILE.write('if [ -z "$pkg_name" ]; then pkg_name="Install inSync.mpkg"; fi\n')
        FILE.write('installer -package "/Volumes/inSync/${pkg_name}" -target /\n')
        FILE.write('hdiutil unmount /Volumes/inSync -force\n')
        FILE.write('rm "%s"\n' % installer)
        user_home = '/Users/' + uname + inSyncParam.CLIENT_GLOBAL_ROOT
        ipkgfile = os.path.join(user_home, 'auto-upgrade', uname, 'binary')
        FILE.write('rm "%s"\n' % ipkgfile)
        FILE.write('echo `date` "install.sh execution ended"\n')
        FILE.write('} >>/tmp/inSyncInstall 2>&1')
        os.chmod(installfilepath, stat.S_IXUSR)
        cmdline = ['/bin/sh', installfilepath]
        try:
            pid = os.fork()
        except OSError as fault:
            SyncLog.error('Unable to install new package Error: %s', fault)
            raise Exception('%s [%d]' % (fault.strerror, fault.errno))
        if 0 == pid:
            os.setsid()
            os.execvp(cmdline[0], cmdline)
    except Exception as fault:
        SyncLog.error('Failure in daemon install. Fault %s', fault)
        SyncLog.traceback(fault)

```

Where does inSyncUpgrade get the package information from? It reads a URL out of `$HOME/Library/Application Support/inSync/inSync.cfg` and then asks that URL for a package over a REST API. `inSync.cfg` is user-writeable, so we can replace that server with our own, and serve up a malicious binary. There is some home grown package signature verification in `inSyncPackage.py` but critically it calls `pickle.loads()` on the untrusted data:

```
def load(self, fpath, quick=False):
    f = file(fpath, 'rb')
    magic = f.read(len(PKG_MAGIC))
    if magic != PKG_MAGIC:
        raise PackageException('Not an inSync Package')
    ssize = struct.calcsize('<I')
    sbytes = f.read(ssize)
    if len(sbytes) < ssize:
        raise PackageException('Package file corrupt')
    sbytes = struct.unpack('<I', sbytes)[0]
    header = f.read(sbytes)
    if len(header) != sbytes:
        raise PackageException('Package file corrupt')
    headerBlk = None
    md5header, md5Signature = Pickle.loads(header)
    ...

```

This is essentially game over. We can supply a malicious pickle that runs whatever code we want. Here we talk to the `UpgradeDaemon` and supply it a malicious filename that exploits a command injection vulnerability in the shell script it runs (`FILE.write('rm "%s"\n' % installer)`), giving us a reverse shell as root. As part of this exploit we also take advantage of a URL injection vulnerability in the app to make this attack only require one line on the victim‚Äôs system - if port starts with an `@` sign the ip address will be interpreted as a username and password:

```
inSyncURL = 'http://127.0.0.1:' + port + '/index.html';

```

[Full Exploit Code](https://gist.github.com/imhotepisinvisible/61c5e83af471d56ddb2d1136eb7bd4b5)

## Exploit 2: inSyncDecommission

While we could use the same pickle vulnerability to talk to `inSyncDecommision`, let‚Äôs take a different route to privilege escalation. `InSyncDecommission` runs an RPC server (`inSyncDaemonRPC.py`) that basically lets us do whatever we want on the system:

```
def register(server):
    server.register_auth_validator(validate_session)
    server.register_function(daemon_authenticate, 'daemon.authenticate', autoauth=False)
    server.register_function(daemon_mkdir, 'daemon.mkdir')
    server.register_function(daemon_makedirs, 'daemon.makedirs')
    server.register_function(daemon_open_file, 'daemon.open_file')
    server.register_function(daemon_write, 'daemon.write')
    server.register_function(daemon_read, 'daemon.read')
    server.register_function(daemon_close_file, 'daemon.close_file')
    server.register_function(daemon_set_file_acl, 'daemon.set_file_acl')
    server.register_function(daemon_set_acls, 'daemon.set_acls')
    server.register_function(daemon_set_file_time, 'daemon.set_file_time')
    server.register_function(daemon_set_xattr, 'daemon.set_xattr')
    server.register_function(daemon_remove_file, 'daemon.remove_file')
    server.register_function(daemon_rename_file, 'daemon.rename_file')
    server.register_function(daemon_autoupdate, 'daemon.autoupdate')
    server.register_function(daemon_system_restart, 'daemon.system_restart')
    server.register_function(daemon_renice, 'daemon.renice')
    server.register_function(daemon_set_secrets, 'daemon.set_secrets')
    server.register_function(daemon_delete_secrets, 'daemon.delete_secrets')
    server.register_function(daemon_delete_file, 'daemon.delete_file')
    server.register_function(daemon_symlink, 'daemon.symlink')
    server.register_function(daemon_mknod, 'daemon.mknod')
    server.register_function(daemon_mkfifo, 'daemon.mkfifo')
    server.register_function(daemon_move, 'daemon.move')
    server.register_function(daemon_create_device_refresh_path, 'daemon.create_device_refresh_path')

```

For this attack we‚Äôre going to target `daemon_read` and `daemon_write`. This will let us read and write any file on the file system (as root). For a proof of concept we can write to `/etc/sudoers` allowing any user to run sudo without requiring a password.

inSync is compiled with the [Hardened Runtime](https://developer.apple.com/documentation/security/hardened_runtime) enabled. However, poking around the app package we find the entitlements file for the app which disables some critical protections:

![](entitlements.png)

This means that the hardened runtime protections do not apply to any libraries, and we can use the `DYLD_` environment variables to inject whatever libraries we want. Therefore we can simply inject a malicious dylib into the app and use the app‚Äôs privilege to read out secrets from the keychain.
From there it‚Äôs simple enough to write a python script to talk to `inSyncDecommission` and own the system:

[Full Exploit Code](https://gist.github.com/imhotepisinvisible/ce51d396d319a3f10eeed9de40f97895)

## Bonus security hygiene issues

There are several other ports open by `inSync` and `inSyncUpgrade`. Since they‚Äôre running with user level privileges I didn‚Äôt look into them too deeply, but they probably shouldn‚Äôt be running. Both services are running a debug server which allows (by design) arbitrary Python code execution. They‚Äôre saved by needing to write to `/etc/inSyncServer` which is not possible by default. Once that directory is created, code execution is easy via the `runcmd` RPC command. The same script can be used as for exploiting Decommission, the socket merely needs to be wrapped in an SSL connection with `ssl.wrap_socket`.

inSync also listens on three other ports. One is an http server that seems to simple proxy to Druva‚Äôs cloud service. The Electron app talks to this server (ignoring TLS validation errors) for operations such as restore.

There is also another http server running that the main Electron UI talks to. This also has a simple command injection vulnerability via the `filename` variable:

```
@cherrypy.expose
@post_activation_api_wrapper
def copy_to_clipboard(self, *args, **kwargs):
    try:
        cherrypy.response.headers['Access-Control-Allow-Origin'] = '*'
        cherrypy.response.headers['Access-Control-Allow-Methods'] = 'POST, GET'
        filename = kwargs.get('data', '')
        if sys.platform == 'win32':
            import pyperclip
            pyperclip.copy(filename)
        else:
            os.system("echo '%s' | pbcopy" % filename)
        return {'status': 0, 'msg': '', 'data': {}}
    except Exception as fault:
        return {'status': -1, 'msg': _(fault), 'data': {}}

```

The final server is another RPC service used by the Syncer.

Beyond the URL injection vulnerability in the Electron app already discussed, it is also several versions out of date and has none of the important security mitigations introduced in recent years such as [Context Isolation](https://www.electronjs.org/docs/latest/tutorial/context-isolation).

## Fix

These issues are fixed in [inSync Client 7.0.1](https://docs.druva.com/005_inSync_Client/inSync_Client_7.0.0_for_inSync_Cloud/000Release_Details/Release_Notes_for_inSync_Client_v7.0.0). Thanks to the Druva security team for their quick response to my report and resolving the issues.

## References

<https://medium.com/tenable-techblog/getting-root-on-macos-via-3rd-party-backup-software-b804085f0c9>

<https://medium.com/tenable-techblog/remapping-python-opcodes-67d79586bfd5>

<https://wojciechregula.blog/post/stealing-macos-apps-keychain-entries/>

## Timeline

| Date | Action |
| --- | --- |
| 06/10/21 | Issue reported to Druva |
| 06/16/21 | Followed up with Druva after receiving no reply |
| 06/16/21 | Confirmation from Druva that they have received the report |
| 06/22/21 | Confirmation from Druva of repro of three out of four issues |
| 06/30/21 | Confirmation from Druva of repro of the fourth issue |
| 07/08/21 | CVEs requested from MITRE |
| 07/24/21 | inSync Client v7.0.0 released that fixes the bulk of the issues |
| 09/22/21 | inSync Client v7.0.1 released with an additional fix |
| 10/11/21 | inSync Client v7.0.1 re-released with a further fix |
| 05/11/22 | CVE assignment finally received from MITRE |


