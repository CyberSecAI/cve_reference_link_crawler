- **Root cause of vulnerability:** An uncontrolled memory consumption bug exists in Argo CD's repo-server when handling large directory-type application manifest files.
- **Weaknesses/vulnerabilities present:**
    - CWE-20: Improper Input Validation
    - CWE-400: Uncontrolled Resource Consumption
    - CWE-770: Allocation of Resources Without Limits or Throttling
    - CWE-789: Uncontrolled Memory Allocation
    The vulnerability stems from the repo-server not limiting the total size of manifest files when handling directory-type applications. This leads to excessive memory usage when a large number of files or extremely large files are present in the manifests, which ultimately allows for a denial-of-service (DoS).
- **Impact of exploitation:** A malicious, authenticated Argo CD user with the authorization to deploy applications from a repository containing large manifests can crash the `repo-server` service. Since the `repo-server` is a critical component of Argo CD, its crash leads to a denial of core Argo CD services such as syncing application updates, which results in a denial-of-service.
- **Attack vectors:** An attacker needs to be a valid, authenticated Argo CD user authorized to deploy Applications from a repository. The attacker controls or can manipulate the contents of this repository to contain a large number of manifest files or very large files within the directory-type application.
- **Required attacker capabilities/position:** The attacker needs to be an authenticated user with the ability to deploy applications from a controlled repository. They must also have the ability to include large manifests or a large number of manifests into the application definition.