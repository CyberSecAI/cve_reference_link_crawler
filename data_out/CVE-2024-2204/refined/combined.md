=== Content from fluidattacks.com_2c88ce06_20250110_190511.html ===
[Contact us](/contact-us/)SearchEnglishEnglishEspaÃ±ol

* [![Fluid Attacks logo navbar](https://res.cloudinary.com/fluid-attacks/image/upload/f_auto,q_auto/v1/airs/menu/Logo?_a=AXAJYUZ0.webp)](/)
ServicePlatform[Plans](/plans/)Resources[Advisories](/advisories/)Company[Log in](https://app.fluidattacks.com/)[Try for free](https://app.fluidattacks.com/SignUp)
# Zemana AntiLogger v2.74.204.664 - DoS

## Summary

|  |  |
| --- | --- |
| **Name** | Zemana AntiLogger v2.74.204.664 - Denial of Service (DoS) |
| **Code name** | [Hassan](https://www.last.fm/pt/music/Georgina%2BHassan/%2Bwiki) |
| **Product** | Zemana AntiLogger |
| **Vendor** | Zemana Ltd. |
| **Affected versions** | Version 2.74.204.664 |
| **State** | Public |
| **Release date** | 2024-03-14 |

## Vulnerability

|  |  |
| --- | --- |
| **Kind** | Denial of Service (DoS) |
| **Rule** | [002. Asymmetric Denial of Service](https://docs.fluidattacks.com/criteria/vulnerabilities/002/) |
| **Remote** | No |
| **CVSSv3 Vector** | CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H |
| **CVSSv3 Base Score** | 5.5 |
| **Exploit available** | Yes |
| **CVE ID(s)** | [CVE-2024-2204](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-2204) |

## Description

Zemana AntiLogger v2.74.204.664 is vulnerable to
a Denial of Service (DoS) vulnerability by
triggering the `0x80002004` and `0x80002010` IOCTL
codes of the `zam64.sys` and `zamguard64.sys` drivers.

## Vulnerability

The `0x80002004` and `0x80002010` IOCTL codes of the
`zam64.sys` and `zamguard64.sys` drivers are
vulnerable to Denial of Service (DoS) leading to a BSOD of
the affected computer caused by a NULL pointer
dereference.

In order to perform calls to any IOCTL of the
`zam64.sys` and `zamguard64.sys` driver, a call to the
IOCTL `0x80002010` must be performed
with the current process ID as an authorized IOCTL process
caller:

```
if ( IoctlCode != 0x80002010 )
{
 if ( IoctlCode + 0x7FFFDFAC > 0x10
    || (CurrentStackLocation = 0x11001i64, !_bittest((const int *)&CurrentStackLocation, IoctlCode + 0x7FFFDFAC)) )
    {
    if ( (unsigned int)sub_140009BE4(CurrentStackLocation, "Main.c") && !(unsigned int)sub_140009BEC(v6, 1i64) )
    {
        v3 = 0xC0000022;
        DnsPrint_RpcZoneInfo(
        7,
        (unsigned int)"Main.c",
        0x1E2,
        (unsigned int)"DeviceIoControlHandler",
        0xC0000022,
        "ProcessID %d is not authorized to send IOCTLs ",
        v6);
        goto LABEL_79;
    }
    }
}

```

The handling code of the `0x80002010` IOCTL calls
`sub_14000F4B4`:

```
__int64 __fastcall sub_14000F4B4(unsigned int *SystemBuffer, __int64 a2, _DWORD *a3, _DWORD *a4)
{
  struct _UNICODE_STRING *v4; // rdi
  unsigned int v8; // eax
  __int64 result; // rax
  __int64 v10; // [rsp+50h] [rbp+8h] BYREF

  v10 = 0i64;
  v4 = (struct _UNICODE_STRING *)(SystemBuffer + 0x1D);  // [1]
  DnsPrint_RpcZoneInfo(
    1,
    (unsigned int)"IoctlHandler.c",
    0x16,
    (unsigned int)"IoctlCreateFileBypassFilters",
    0,
    "Request %ws",
    SystemBuffer + 0x1D);  // [2]
  v8 = SystemBuffer[2];
  if ( (v8 & 2) != 0 || (v8 & 0x100) != 0 )
    sub_14000C33C(v4, *SystemBuffer);
  result = sub_14000AC2C(v4, *SystemBuffer, SystemBuffer[1], 1, SystemBuffer[2], 7u, SystemBuffer[3], (void **)&v10);  //[3]

```

That function receives the `SystemBuffer`
variable as a first parameter. When the
`nInBufferSize` value of the IOCTL request call is 0
and the `lpInBuffer` is NULL, the value of `SystemBuffer`
is also 0. However, there are not checks (`[1], [2], [3]`)
for such case before trying to dereference the variable.
The result is a NULL pointer dereference:

```
CONTEXT:  ffffa5848e18dd60 -- (.cxr 0xffffa5848e18dd60)
rax=0000000000000001 rbx=0000000000000000 rcx=0000000000000000
rdx=0000000000000000 rsi=0000000000000000 rdi=00000000c0000001
rip=fffff803392e0284 rsp=ffffa5848e18e760 rbp=0000000000001910
 r8=0000000000000208  r9=fffff803392f06b0 r10=0000000000000001
r11=0000000000000000 r12=0000000000000000 r13=fffff803392f06b0
r14=0000000000000000 r15=ffffa7053c4fd5b0
iopl=0         nv up ei pl nz na pe nc
cs=0010  ss=0018  ds=002b  es=002b  fs=0053  gs=002b             efl=00050202
zam64+0x10284:
fffff803`392e0284 8b0b            mov     ecx,dword ptr [rbx] ds:002b:00000000`00000000=????????
Resetting default scope

PROCESS_NAME:  IOCTLBruteForce.exe

STACK_TEXT:
ffffa584`8e18e760 fffff803`392e0701     : ffffd186`282fb928 00000000`00000000 00000000`00000000 00000000`00000000 : zam64+0x10284
ffffa584`8e18e790 fffff803`334d1f35     : ffffa705`00000000 ffffa705`3c4fd5b0 00000000`00000002 00000000`00000001 : zam64+0x10701

```
## Our security policy

We have reserved the ID CVE-2024-2204 to refer
to this issue from now on.

* <https://fluidattacks.com/advisories/policy/>

## System Information

* Version: Zemana AntiLogger v2.74.204.664
* Operating System: Windows

## Mitigation

There is currently no patch available for this vulnerability.

## Credits

The vulnerability was discovered by
[Andres Roldan](https://www.linkedin.com/in/andres-roldan/)
from Fluid Attacks' Offensive Team.

## References

**Vendor page** <https://zemana.com/>

**Product page** <https://zemana.com/us/antilogger.html>

## Timeline

![Time-lapse-logo](https://res.cloudinary.com/fluid-attacks/image/upload/f_auto,q_auto/v1/airs/icons/red-circle-check?_a=AXAJYUZ0.webp)

2024-02-23

Vulnerability discovered.

![Time-lapse-logo](https://res.cloudinary.com/fluid-attacks/image/upload/f_auto,q_auto/v1/airs/icons/red-circle-check?_a=AXAJYUZ0.webp)

2024-03-05

Vendor contacted.

![Time-lapse-logo](https://res.cloudinary.com/fluid-attacks/image/upload/f_auto,q_auto/v1/airs/icons/red-circle-check?_a=AXAJYUZ0.webp)

2024-03-14

Public Disclosure.

[![Fluid Logo Footer](https://res.cloudinary.com/fluid-attacks/image/upload/f_auto,q_auto/v1/airs/fluid-attacks-logo-2022-light?_a=AXAJYUZ0.webp)](/)

Hacking software for over 20 years

Fluid Attacks tests applications and other systems, covering all software development stages. Our team assists clients in quickly identifying and managing vulnerabilities to reduce the risk of incidents and deploy secure technology.

Service

[Continuous Hacking](/services/continuous-hacking/)[Platform overview](/platform/)

Solutions

[Application security](/solutions/)[Compliance](/compliance/)[Systems](/systems/)

Testing Techniques

[ASPM](/product/aspm/)[SAST](/product/sast/)[DAST](/product/dast/)[MPT](/product/mpt/)[MAST](/product/mast/)[SCA](/product/sca/)[CSPM](/product/cspm/)[PTaaS](/product/ptaas/)[RE](/product/re/)[SCR](/solutions/secure-code-review/)

Plans

[Essential](/plans/#essential)[Advanced](/plans/)

Resources

[Blog](/blog/)[Learn](/learn/)[Advisories](/advisories/)[Clients](/clients/)[Downloadables](/resources/)[Documentation](https://docs.fluidattacks.com/)

Company

[About us](/about-us/)[Certifications](/certifications/)[Partners](/partners/)[Careers](/careers/)[Contact us](/contact-us/)[Ethics Hotline](https://r.easyllama.com/ed68576b-c349-4f40-926b-4905c82c53bb)

Copyright Â© 0 Fluid Attacks. We hack your software. All rights reserved.

[Service status](https://status.fluidattacks.com/)[Terms of use](/terms-use/)[Privacy policy](/privacy/)[Cookie policy](/cookie/)



=== Content from zemana.com_29ba51d9_20250110_190512.html ===


 [![Zemana logo horizontal](../aws.zemana.com/images/logo/logo_white.png)](index.html)

 Toggle navigation

* PRODUCTS
  + [AntiMalware](antimalware.html)+ [AntiLogger](antilogger.html)+ [Mobile Antivirus](free-mobile-security.html)+ [PAGI Gen v1](https://pagi.ai/)+ [Deepware](https://deepware.ai/)* [PRICING](store/antimalware.html)
    + [Buy AntiMalware](store/antimalware.html)+ [Buy AntiLogger](store/antilogger.html)+ [Buy Android Antivirus](https://zemana.com/us/free-mobile-security.html?id=com.zemana.msecurity&referrer=utm_source%3Davangate%26utm_campaign%3Davangate_redirection)* Partners
      + [Sales Partnership](partners/sales-partnership.html)+ [Technology Partnership](partners/technology-partnership.html)+ [Partner Portal](http://oem.zemana.com/)* OEM
        + [White-label](white-label.html)+ [SDK](sdk.html)* [HELP](https://zemana.com/us/help.html)

# Zemana AntiLogger

## We keep your private data private!

[DOWNLOAD FREE DEMO](https://zemana.com/downloads/Zemana.AntiLogger.Setup.exe)

[GET PREMIUM](store/antilogger.html)

  [Version 2.74.2.664](whats-new2c6b.html?ProductID=1)

   XP, Vista, 7/8/10/11 (32 & 64 bit)

 [Scroll for more details](#features)

#### Secure SSL

Makes it possible that your credit card numbers, social security numbers, and login credentials are transmitted securely leaving attackers powerÂ­less.

#### Keystroke Logging Protection

Zemana AntiLogger allows you to camouflage your daily online activities-shopping, calling, texting, online banking and more, so intruders can never get a pick into it.

#### Anti-Ransomware

Do you want to see your data encrypted with ransomware? Definitely no. Use the best ransomware protection in the market as according to MRG Effitas ([report here](https://www.mrg-effitas.com/wp-content/uploads/2016/07/Zemana_ransomware_detection.pdf)) and build your defense system.

#### Adware Removal

Detects and cleans browser addÂ­on's; adware infections, unwanted apps and tool bars that you don't even know how they appeared there.

#### Malware Scanner

Lightweight and efficient online malware scanner that detects malware and hidden malicious processes that may be sneaking on your PC.

#### Zero-day Malware Protection

Each unknown file will be analyzed carefully in the cloud with Pandora Technology before they execute on your PC, increasing zeroÂ­ day malware protection.

#### Real Time Protection

Works continuously in the background blocking infections before they reach your PC in real time.

#### 24/7 Technical Support

In case you are experiencing some problem with your AntiLogger, Zemana [support team](https://zemana.com/us/help.html) is there **24/7** to assist you.

![]()

![]()

![]()

![]()

![]()

Want to find out more?
 Click [here](http://dl9.zemana.com/Website_Media/Zemana%20AntiLogger%20brochure.pdf) to download our Zemana AntiLogger brochure.

### See what others say about Zemana AntiLogger

> My Computer was hacked and I discovered Zemana, tried it a few days, bought it and will never be without it. It has blocked numerous attempts to access my keyboard. It will block any changes to your regular routine. So take an old computer technician's advice and try Zemana, you'll never be sorry and once you see what it can do, you'll never be without it!
> Col. D. Gillespie

> We look for software products that work well with others and yet provide an enhanced level of security with a minimum local resource demand and of course all at a reasonable cost. We have found that the Zemana products meet just such parameters. We highly recommend the Zemana AntiLogger as a cost effective way of staying ahead of the âbad guysâ.
> William H. Jett President Techware USA, Inc.

> I trust Zemana Antilogger 100% to protect my PC from any keyloggers I may get hit with. I would trust my life with this software. Don't be fooled by reviews ratings, Don't be penny wise and pound foolish. Protect your pc today like you would protect the lives of your own family.
> Dr. H. Hechabarria, Panama

> The best I have come across, second to none, keep up the outstanding work guys. I canât rate you high enough. You found a virus no other anti-virus software even warned me about including AVG and ZoneAlarm. This virus was from a disc install and I used every security I owned to find whatever was slowing my pc down. Yours was the only program to detect it. Thanks so much.
> Steve C, UK

###### Zemana

Using our products should be simple, easy and satisfying.
 They should help you and solve your problem.
 We grow together with our users.

###### Products

* [Zemana AntiMalware](antimalware.html)* [Zemana AntiLogger](antilogger.html)* [Zemana Mobile Antivirus](free-mobile-security.html)* [Zemana Endpoint Security](endpoint-security.html)

###### Help

* [FAQ](https://zemana.com/us/help.html)* [Forum](https://zemana.com/index.html?q=h)* [Submit a ticket](https://zemana.com/us/help.html)* [Malware Academy](removal-guide/malware-academy.html)

###### Company

* [About us](company/about-us.html)* [Blog](http://blog.zemana.com/)* [Press Center](company/press-center.html)* [Careers](company/careers.html)* [Fan Club](fan-club.html)

[![Zemana logo horizontal](../aws.zemana.com/images/logo/logo_white.png)](index.html)

 Toggle navigation

* [Copyright © 2007 - 2022 Zemana Ltd.](https://www.zemana.com)* [About us](company/about-us.html)* [Contact us](https://zemana.com/us/help.html)* [Privacy Policy](privacy.html)* [Site Map](site-map.html)* [Global (English)](antilogger.html) * [Turkish](tr/antilogger.html)

 Toggle navigation

* [Copyright © 2007 - 2022 Zemana Ltd.](https://www.zemana.com)* [About us](company/about-us.html)* [Contact us](https://zemana.com/us/help.html)* [Privacy Policy](privacy.html)* [Site Map](site-map.html)* [Global (English)](antilogger.html) * [Turkish](tr/antilogger.html)

![Zemana 30 day money back guarantee](../d5nxst8fruw4z.cloudfront.net/atrkc30b.gif?account=pWEUi1a4ZP002V)

