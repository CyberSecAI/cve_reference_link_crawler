=== Content from github.com_63fa1dc9_20250110_163047.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fquill-mention%2Fquill-mention%2Fpull%2F341)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fquill-mention%2Fquill-mention%2Fpull%2F341)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=quill-mention%2Fquill-mention)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[quill-mention](/quill-mention)
/
**[quill-mention](/quill-mention/quill-mention)**
Public

* [Notifications](/login?return_to=%2Fquill-mention%2Fquill-mention) You must be signed in to change notification settings
* [Fork
  274](/login?return_to=%2Fquill-mention%2Fquill-mention)
* [Star
   770](/login?return_to=%2Fquill-mention%2Fquill-mention)

* [Code](/quill-mention/quill-mention)
* [Issues
  42](/quill-mention/quill-mention/issues)
* [Pull requests
  10](/quill-mention/quill-mention/pulls)
* [Discussions](/quill-mention/quill-mention/discussions)
* [Actions](/quill-mention/quill-mention/actions)
* [Projects
  0](/quill-mention/quill-mention/projects)
* [Security](/quill-mention/quill-mention/security)
* [Insights](/quill-mention/quill-mention/pulse)

Additional navigation options

* [Code](/quill-mention/quill-mention)
* [Issues](/quill-mention/quill-mention/issues)
* [Pull requests](/quill-mention/quill-mention/pulls)
* [Discussions](/quill-mention/quill-mention/discussions)
* [Actions](/quill-mention/quill-mention/actions)
* [Projects](/quill-mention/quill-mention/projects)
* [Security](/quill-mention/quill-mention/security)
* [Insights](/quill-mention/quill-mention/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fquill-mention%2Fquill-mention%2Fissues%2Fnew%2Fchoose)

By clicking ‚ÄúSign up for GitHub‚Äù, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We‚Äôll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fquill-mention%2Fquill-mention%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Fix innerHTML XSS vulnerability #341

 Merged

[csculley](/csculley)
merged 5 commits into
[quill-mention:master](/quill-mention/quill-mention/tree/master "quill-mention/quill-mention:master")
from
SimplyBinary:fix-inner-html

Sep 11, 2023

 Merged

# [Fix innerHTML XSS vulnerability](#top) #341

[csculley](/csculley)
merged 5 commits into
[quill-mention:master](/quill-mention/quill-mention/tree/master "quill-mention/quill-mention:master")
from
SimplyBinary:fix-inner-html

Sep 11, 2023

+104

‚àí45

[Conversation
8](/quill-mention/quill-mention/pull/341)
[Commits
5](/quill-mention/quill-mention/pull/341/commits)
[Checks
0](/quill-mention/quill-mention/pull/341/checks)
[Files changed
8](/quill-mention/quill-mention/pull/341/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![csculley](https://avatars.githubusercontent.com/u/5550159?s=60&v=4)](/csculley)

Copy link

Collaborator

### @csculley **[csculley](/csculley)** commented [Sep 6, 2023](#issue-1884733562) ‚Ä¢ edited Loading

Closes [#255](https://github.com/quill-mention/quill-mention/issues/255)

This PR fixes the XSS vulnerability issues associated with using `innerHTML`.

Please let me know if anything needs to be changed. Thank you!

Sorry, something went wrong.

All reactions

[![@csculley](https://avatars.githubusercontent.com/u/5550159?s=40&u=70216e768a659bdcd25756d215f85c5e9b06ca78&v=4)](/csculley)
[csculley](/csculley)
mentioned this pull request
[Sep 6, 2023](#ref-issue-1283140468)

[Uses innerHTML - potentially allows injection attacks
#255](/quill-mention/quill-mention/issues/255)

Closed

[![@thexeos](https://avatars.githubusercontent.com/u/2260539?s=80&u=64f19db5907b698973ec10fca6b32344de569254&v=4)](/thexeos)

Copy link

Collaborator

### **[thexeos](/thexeos)** commented [Sep 6, 2023](#issuecomment-1709265448)

| This is a breaking change, so a major version bump and upgrade notes would be needed in readme. |
| --- |

All reactions

Sorry, something went wrong.

[![@csculley](https://avatars.githubusercontent.com/u/5550159?s=80&u=70216e768a659bdcd25756d215f85c5e9b06ca78&v=4)](/csculley)

Copy link

Collaborator

Author

### **[csculley](/csculley)** commented [Sep 7, 2023](#issuecomment-1709328718)

| Should we start a new `CHANGELOG.md` file in the root of the repository? Otherwise, I can add an upgrade notes section to the changelog if you'd like! |
| --- |

All reactions

Sorry, something went wrong.

 [![@csculley](https://avatars.githubusercontent.com/u/5550159?s=40&u=70216e768a659bdcd25756d215f85c5e9b06ca78&v=4)](/csculley)
[csculley](/csculley)
marked this pull request as draft
[September 7, 2023 01:40](#event-10301896797)

[![@thexeos](https://avatars.githubusercontent.com/u/2260539?s=80&u=64f19db5907b698973ec10fca6b32344de569254&v=4)](/thexeos)

Copy link

Collaborator

### **[thexeos](/thexeos)** commented [Sep 7, 2023](#issuecomment-1709443751)

| Should we start a new `CHANGELOG.md` file in the root of the repository? Otherwise, I can add an upgrade notes section to the changelog if you'd like!  I like the README approach. It also means that people that visit **npm** page would see the important upgrade instructions. |
| --- |

 üëç
2
 csculley and MadSpindel reacted with thumbs up emoji

All reactions

* üëç
  2 reactions

Sorry, something went wrong.

 [![@csculley](https://avatars.githubusercontent.com/u/5550159?s=40&u=70216e768a659bdcd25756d215f85c5e9b06ca78&v=4)](/csculley)
[csculley](/csculley)
marked this pull request as ready for review
[September 7, 2023 16:25](#event-10309496812)

[![@csculley](https://avatars.githubusercontent.com/u/5550159?s=80&u=70216e768a659bdcd25756d215f85c5e9b06ca78&v=4)](/csculley)

Copy link

Collaborator

Author

### **[csculley](/csculley)** commented [Sep 7, 2023](#issuecomment-1710451965)

| This should be ready to review again! Please let me know if there's anything that should be changed for better code quality or styling. Thank you! |
| --- |

All reactions

Sorry, something went wrong.

 [![@csculley](https://avatars.githubusercontent.com/u/5550159?s=40&u=70216e768a659bdcd25756d215f85c5e9b06ca78&v=4)](/csculley)
[csculley](/csculley)
marked this pull request as draft
[September 8, 2023 18:05](#event-10320922884)

 [oliviasculley](/oliviasculley)
added 3 commits
[September 8, 2023 14:17](#commits-pushed-893c9ca)

[![@oliviasculley](https://avatars.githubusercontent.com/u/88074048?s=40&v=4)](/oliviasculley)

`[support custom HTML blot and item rendering](/quill-mention/quill-mention/pull/341/commits/893c9cade8df85dcdff237f303edfc43e7ad4820 "support custom HTML blot and item rendering")`

`[893c9ca](/quill-mention/quill-mention/pull/341/commits/893c9cade8df85dcdff237f303edfc43e7ad4820)`

[![@oliviasculley](https://avatars.githubusercontent.com/u/88074048?s=40&v=4)](/oliviasculley)

`[bump version to 4.0.0](/quill-mention/quill-mention/pull/341/commits/880e11fc9e506a60446e7bb8fe574a3c30325aa9 "bump version to 4.0.0")`

`[880e11f](/quill-mention/quill-mention/pull/341/commits/880e11fc9e506a60446e7bb8fe574a3c30325aa9)`

[![@oliviasculley](https://avatars.githubusercontent.com/u/88074048?s=40&v=4)](/oliviasculley)

`[run npm build](/quill-mention/quill-mention/pull/341/commits/39cf8f7de666b222ea71f26582b86573a1a857ca "run npm build")`

`[39cf8f7](/quill-mention/quill-mention/pull/341/commits/39cf8f7de666b222ea71f26582b86573a1a857ca)`

 [![@csculley](https://avatars.githubusercontent.com/u/5550159?s=40&u=70216e768a659bdcd25756d215f85c5e9b06ca78&v=4)](/csculley)
[csculley](/csculley)
marked this pull request as ready for review
[September 8, 2023 18:24](#event-10321064052)

[![@csculley](https://avatars.githubusercontent.com/u/5550159?s=80&u=70216e768a659bdcd25756d215f85c5e9b06ca78&v=4)](/csculley)

Copy link

Collaborator

Author

### **[csculley](/csculley)** commented [Sep 8, 2023](#issuecomment-1712066061)

| Alright, I'm feeling good about this one üòÑ |
| --- |

All reactions

Sorry, something went wrong.

 [![@csculley](https://avatars.githubusercontent.com/u/5550159?s=40&u=70216e768a659bdcd25756d215f85c5e9b06ca78&v=4)](/csculley)
[csculley](/csculley)
requested a review
from [MadSpindel](/MadSpindel)
[September 8, 2023 19:41](#event-10321609857)

 [oliviasculley](/oliviasculley)
added 2 commits
[September 8, 2023 15:52](#commits-pushed-6972655)

[![@oliviasculley](https://avatars.githubusercontent.com/u/88074048?s=40&v=4)](/oliviasculley)

`[update documentation](/quill-mention/quill-mention/pull/341/commits/69726551c9ac2408771c53509a2e859585f72a0d "update documentation")`

`[6972655](/quill-mention/quill-mention/pull/341/commits/69726551c9ac2408771c53509a2e859585f72a0d)`

[![@oliviasculley](https://avatars.githubusercontent.com/u/88074048?s=40&v=4)](/oliviasculley)

`[add custom blot styling to advanced demo](/quill-mention/quill-mention/pull/341/commits/6e040106a781711c6040465c26f1f22999e1187a "add custom blot styling to advanced demo")`

`[6e04010](/quill-mention/quill-mention/pull/341/commits/6e040106a781711c6040465c26f1f22999e1187a)`

[![@MadSpindel](https://avatars.githubusercontent.com/u/3159565?s=40&u=da187525da614bb4305965bafca4786b68381af1&v=4)](/MadSpindel)
[MadSpindel](/MadSpindel)
assigned [thexeos](/thexeos)
[Sep 9, 2023](#event-10323655404)

 [![@MadSpindel](https://avatars.githubusercontent.com/u/3159565?s=40&u=da187525da614bb4305965bafca4786b68381af1&v=4)](/MadSpindel)
[MadSpindel](/MadSpindel)
requested a review
from [thexeos](/thexeos)
[September 10, 2023 12:20](#event-10326264798)

[![thexeos](https://avatars.githubusercontent.com/u/2260539?s=60&v=4)](/thexeos)

**[thexeos](/thexeos)**
approved these changes
[Sep 10, 2023](#pullrequestreview-1618905964)

 [View reviewed changes](/quill-mention/quill-mention/pull/341/files/6e040106a781711c6040465c26f1f22999e1187a)

Copy link

Collaborator

### @thexeos **[thexeos](/thexeos)** left a comment

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Looks good to me.

In summary:

* Existing Delta documents will loose their rendered HTML in `value`, but that is expected, as it may be currently polluted with XSS.
* New Delta documents will only ever store String (plain text) in `value` - the documentation reflects it.
* HTML rendering is still supported through the use of custom blots, that extend the default `MentionBlot`. They must implement a `render` method that returns an `Element`. Functionality of rendering HTML is maintained.
* Furthermore, the use of custom blot name means that `mention` objects with custom `data` payload will be explicitly handled by the custom blot, rather than the default one.
* I could not find any new XSS vectors (except for the end user introducing one in their `render` method).

Good work!

Sorry, something went wrong.

 ‚ù§Ô∏è
1
 csculley reacted with heart emoji

All reactions

* ‚ù§Ô∏è
  1 reaction

[![@csculley](https://avatars.githubusercontent.com/u/5550159?s=40&u=70216e768a659bdcd25756d215f85c5e9b06ca78&v=4)](/csculley)
[csculley](/csculley)
merged commit [`e85262d`](/quill-mention/quill-mention/commit/e85262ddced0a7f0b6fc8350d236a68bd1e28385)
into
quill-mention:master

[Sep 11, 2023](https://github.com/quill-mention/quill-mention/pull/341#event-10334128799)

 [![@csculley](https://avatars.githubusercontent.com/u/5550159?s=40&u=70216e768a659bdcd25756d215f85c5e9b06ca78&v=4)](/csculley)
[csculley](/csculley)
deleted the
fix-inner-html

branch
[September 11, 2023 13:18](#event-10334130464)

[![@MadSpindel](https://avatars.githubusercontent.com/u/3159565?s=80&u=da187525da614bb4305965bafca4786b68381af1&v=4)](/MadSpindel)

Copy link

Member

### **[MadSpindel](/MadSpindel)** commented [Sep 11, 2023](#issuecomment-1713881683)

| Excellent job [@csculley](https://github.com/csculley)! I've now published version 4.0.0 to npm. |
| --- |

All reactions

Sorry, something went wrong.

[![@csculley](https://avatars.githubusercontent.com/u/5550159?s=80&u=70216e768a659bdcd25756d215f85c5e9b06ca78&v=4)](/csculley)

Copy link

Collaborator

Author

### **[csculley](/csculley)** commented [Sep 11, 2023](#issuecomment-1713883157)

| Thank you so much!! |
| --- |

All reactions

Sorry, something went wrong.

[![@csculley](https://avatars.githubusercontent.com/u/5550159?s=40&u=70216e768a659bdcd25756d215f85c5e9b06ca78&v=4)](/csculley)
[csculley](/csculley)
mentioned this pull request
[Nov 3, 2023](#ref-issue-1975820860)

[Release notes / changes
#353](/quill-mention/quill-mention/issues/353)

Open

This was referenced Apr 24, 2024

[Is there a way to add profile image to the mention search list ?
#164](/quill-mention/quill-mention/issues/164)

Closed

[Add profile image to the mention list
#371](/quill-mention/quill-mention/issues/371)

Closed

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fquill-mention%2Fquill-mention%2Fpull%2F341)

Reviewers

[![@thexeos](https://avatars.githubusercontent.com/u/2260539?s=40&v=4)](/thexeos) [thexeos](/thexeos)

thexeos approved these changes

[![@MadSpindel](https://avatars.githubusercontent.com/u/3159565?s=40&v=4)](/MadSpindel) [MadSpindel](/MadSpindel)

 Awaiting requested review from MadSpindel

Assignees

[![@thexeos](https://avatars.githubusercontent.com/u/2260539?s=40&v=4)](/thexeos) [thexeos](/thexeos)

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

Successfully merging this pull request may close these issues.

 [Uses innerHTML - potentially allows injection attacks](https://github.com/quill-mention/quill-mention/issues/255)

4 participants

[![@csculley](https://avatars.githubusercontent.com/u/5550159?s=52&v=4)](/csculley) [![@thexeos](https://avatars.githubusercontent.com/u/2260539?s=52&v=4)](/thexeos) [![@MadSpindel](https://avatars.githubusercontent.com/u/3159565?s=52&v=4)](/MadSpindel) [![@oliviasculley](https://avatars.githubusercontent.com/u/88074048?s=52&v=4)](/oliviasculley)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.



=== Content from security.snyk.io_ab9851c3_20250110_163048.html ===
[![Homepage](/_nuxt/header-logo.Dk_X-iWD.svg)](/)

2. [Snyk Vulnerability Database](/vuln)
3. [npm](/vuln/npm)
4. quill-mention
# Cross-site Scripting (XSS) Affecting [quill-mention](/package/npm/quill-mention) package, versions **<4.0.0**

---

### Severity

 Recommended 0.0medium010

CVSS assessment made by Snyk's Security Team. [Learn more](/vuln/SNYK-JS-QUILLMENTION-5921549#cvss)

### Threat Intelligence

Exploit Maturity

Snyk has a proof-of-concept or detailed explanation of how to exploit this vulnerability.

Proof of conceptEPSS

The probability is the direct output of the EPSS model, and conveys an overall sense of the threat of
exploitation in the wild. The percentile measures the EPSS probability relative to all known EPSS scores.
Note: This data is updated daily, relying on the latest available EPSS model version.
Check out the EPSS
[documentation](https://www.first.org/epss/articles/prob_percentile_bins)
for more details.

**0.15% (52nd percentile)**
### Do your applications use this vulnerable package?

In a few clicks we can analyze your entire application and see what components are vulnerable in your application, and suggest you quick fixes.

[Test your applications](https://app.snyk.io/login?cta=sign-up&loc=banner&page=vuln-vuln)
### Snyk Learn

Learn about Cross-site Scripting (XSS) vulnerabilities in an interactive lesson.

 [Start learning](https://learn.snyk.io/lesson/xss/)

* Snyk ID**SNYK-JS-QUILLMENTION-5921549**
* published**27 Sept 2023**
* disclosed**26 Sept 2023**
* credit**Cameron Foale**

[Report a new vulnerability](https://snyk.io/vulnerability-disclosure/) [Found a mistake?](https://support.snyk.io/s/contactsupport)
#### Introduced: 26 Sep 2023

[CVE-2023-26149 ¬†(opens in a new tab)](https://www.cve.org/CVERecord?id=CVE-2023-26149) Common Vulnerabilities and Exposures (CVE) are common identifiers for publicly known security vulnerabilities[CWE-79 ¬†(opens in a new tab)](https://cwe.mitre.org/data/definitions/79.html) Common Weakness Enumeration (CWE) is a category system for software weaknesses First added by Snyk
## How to fix?

Upgrade `quill-mention` to version 4.0.0 or higher.

## Overview

[quill-mention](https://www.npmjs.org/package/quill-mention) is a @mentions for the Quill rich text editor

Affected versions of this package are vulnerable to Cross-site Scripting (XSS) due to improper user-input sanitization, via the `renderList` function.

**Note:**

If the mentions list is sourced from unsafe (user-sourced) data, this might allow an injection attack when a Quill user hits `@`.

## Details

A cross-site scripting attack occurs when the attacker tricks a legitimate web-based application or site to accept a request as originating from a trusted source.

This is done by escaping the context of the web application; the web application then delivers that data to its users along with other trusted dynamic content, without validating it. The browser unknowingly executes malicious script on the client side (through client-side languages; usually JavaScript or HTML) in order to perform actions that are otherwise typically blocked by the browser‚Äôs Same Origin Policy.

Injecting malicious code is the most prevalent manner by which XSS is exploited; for this reason, escaping characters in order to prevent this manipulation is the top method for securing code against this vulnerability.

Escaping means that the application is coded to mark key characters, and particularly key characters included in user input, to prevent those characters from being interpreted in a dangerous context. For example, in HTML, `<` can be coded as `&lt`; and `>` can be coded as `&gt`; in order to be interpreted and displayed as themselves in text, while within the code itself, they are used for HTML tags. If malicious content is injected into an application that escapes special characters and that malicious content uses `<` and `>` as HTML tags, those characters are nonetheless not interpreted as HTML tags by the browser if they‚Äôve been correctly escaped in the application code and in this way the attempted attack is diverted.

The most prominent use of XSS is to steal cookies (source: OWASP HttpOnly) and hijack user sessions, but XSS exploits have been used to expose sensitive information, enable access to privileged services and functionality and deliver malware.

### Types of attacks

There are a few methods by which XSS can be manipulated:

| Type | Origin | Description |
| --- | --- | --- |
| **Stored** | Server | The malicious code is inserted in the application (usually as a link) by the attacker. The code is activated every time a user clicks the link. |
| **Reflected** | Server | The attacker delivers a malicious link externally from the vulnerable web site application to a user. When clicked, malicious code is sent to the vulnerable web site, which reflects the attack back to the user‚Äôs browser. |
| **DOM-based** | Client | The attacker forces the user‚Äôs browser to render a malicious page. The data in the page itself delivers the cross-site scripting data. |
| **Mutated** |  | The attacker injects code that appears safe, but is then rewritten and modified by the browser, while parsing the markup. An example is rebalancing unclosed quotation marks or even adding quotation marks to unquoted parameters. |

### Affected environments

The following environments are susceptible to an XSS attack:

* Web servers
* Application servers
* Web application environments

### How to prevent

This section describes the top best practices designed to specifically protect your code:

* Sanitize data input in an HTTP request before reflecting it back, ensuring all data is validated, filtered or escaped before echoing anything back to the user, such as the values of query parameters during searches.
* Convert special characters such as `?`, `&`, `/`, `<`, `>` and spaces to their respective HTML or URL encoded equivalents.
* Give users the option to disable client-side scripts.
* Redirect invalid requests.
* Detect simultaneous logins, including those from two separate IP addresses, and invalidate those sessions.
* Use and enforce a Content Security Policy (source: Wikipedia) to disable any features that might be manipulated for an XSS attack.
* Read the documentation for any of the libraries referenced in your code to understand which elements allow for embedded HTML.
## References

* [GitHub Commit](https://github.com/quill-mention/quill-mention/commit/e85262ddced0a7f0b6fc8350d236a68bd1e28385)
* [GitHub Issue](https://github.com/quill-mention/quill-mention/issues/255)
* [GitHub PR](https://github.com/quill-mention/quill-mention/pull/341)
* [PoC](https://codepen.io/ALiangLiang/pen/mdQMJXK)
* [Vulnerable Code](https://github.com/quill-mention/quill-mention/blob/0aa9847719257496b14ac5401872c4e2ffcbc3d1/src/quill.mention.js#L391)
### CVSS Scores

version 3.1
### Snyk

6.1¬†medium

* Attack Vector (AV)

  The vulnerable component is bound to the network stack and the set of possible attackers extends beyond the other options listed below, up to and including the entire Internet. Such a vulnerability is often termed ‚Äúremotely exploitable‚Äù and can be thought of as an attack being exploitable *at the protocol level* one or more network hops away (e.g., across one or more routers).

  **Network**
* Attack Complexity (AC)

  Specialized access conditions or extenuating circumstances do not exist. An attacker can expect repeatable success when attacking the vulnerable component.

  **Low**
* Privileges Required (PR)

  The attacker is unauthorized prior to attack, and therefore does not require any access to settings or files of the vulnerable system to carry out an attack.

  **None**
* User Interaction (UI)

  Successful exploitation of this vulnerability requires a user to take some action before the vulnerability can be exploited. For example, a successful exploit may only be possible during the installation of an application by a system administrator.

  **Required**

* Scope (S)

  An exploited vulnerability can affect resources beyond the security scope managed by the security authority of the vulnerable component. In this case, the vulnerable component and the impacted component are different and managed by different security authorities.

  **Changed**

* Confidentiality (C)

  There is some loss of confidentiality. Access to some restricted information is obtained, but the attacker does not have control over what information is obtained, or the amount or kind of loss is limited. The information disclosure does not cause a direct, serious loss to the impacted component.

  **Low**
* Integrity (I)

  Modification of data is possible, but the attacker does not have control over the consequence of a modification, or the amount of modification is limited. The data modification does not have a direct, serious impact on the impacted component.

  **Low**
* Availability (A)

  There is no impact to availability within the impacted component.

  **None**
### NVD

6.1¬†medium
### Product

* [Snyk Open Source](https://snyk.io/product/open-source-security-management/)
* [Snyk Code](https://snyk.io/product/snyk-code/)
* [Snyk Container](https://snyk.io/product/container-vulnerability-management/)
* [Snyk Infrastructure as Code](https://snyk.io/product/infrastructure-as-code-security/)
* [Snyk AppRisk](https://snyk.io/product/snyk-apprisk/)
### Resources

* [Vulnerability DB](https://security.snyk.io/)
* [Documentation](https://docs.snyk.io/)
* [Disclosed Vulnerabilities](/disclosed-vulnerabilities)
* [Blog](https://snyk.io/blog/)
* [FAQs](https://support.snyk.io/)
### Company

* [About](https://snyk.io/about)
* [Jobs](https://snyk.io/careers/)
* Contact
* [Policies](https://snyk.io/policies/terms-of-service/)
* [Do Not Sell My Personal Information](https://preferences.snyk.io/dont_sell)
### Contact Us

* Support
* [Report a new vuln](https://snyk.io/vulnerability-disclosure)
* [Events](https://snyk.io/events)
### Find us online

### Track our development

[![DevSecOps Community Podcast](data:image/svg+xml;base64...)](https://www.devseccon.com/the-secure-developer-podcast/)

¬© 2025 Snyk Limited

Registered in England and Wales. Company number: 09677925

Registered address: Highlands House, Basingstoke Road, Spencers Wood, Reading, Berkshire, RG7 1NT.



=== Content from github.com_25ef230e_20250110_163045.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fquill-mention%2Fquill-mention%2Fcommit%2Fe85262ddced0a7f0b6fc8350d236a68bd1e28385)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fquill-mention%2Fquill-mention%2Fcommit%2Fe85262ddced0a7f0b6fc8350d236a68bd1e28385)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=quill-mention%2Fquill-mention)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[quill-mention](/quill-mention)
/
**[quill-mention](/quill-mention/quill-mention)**
Public

* [Notifications](/login?return_to=%2Fquill-mention%2Fquill-mention) You must be signed in to change notification settings
* [Fork
  274](/login?return_to=%2Fquill-mention%2Fquill-mention)
* [Star
   770](/login?return_to=%2Fquill-mention%2Fquill-mention)

* [Code](/quill-mention/quill-mention)
* [Issues
  42](/quill-mention/quill-mention/issues)
* [Pull requests
  10](/quill-mention/quill-mention/pulls)
* [Discussions](/quill-mention/quill-mention/discussions)
* [Actions](/quill-mention/quill-mention/actions)
* [Projects
  0](/quill-mention/quill-mention/projects)
* [Security](/quill-mention/quill-mention/security)
* [Insights](/quill-mention/quill-mention/pulse)

Additional navigation options

* [Code](/quill-mention/quill-mention)
* [Issues](/quill-mention/quill-mention/issues)
* [Pull requests](/quill-mention/quill-mention/pulls)
* [Discussions](/quill-mention/quill-mention/discussions)
* [Actions](/quill-mention/quill-mention/actions)
* [Projects](/quill-mention/quill-mention/projects)
* [Security](/quill-mention/quill-mention/security)
* [Insights](/quill-mention/quill-mention/pulse)

## Commit

[Permalink](/quill-mention/quill-mention/commit/e85262ddced0a7f0b6fc8350d236a68bd1e28385)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Merge pull request [#341](https://github.com/quill-mention/quill-mention/pull/341) from SimplyBinary/fix-inner-html

[Browse files](/quill-mention/quill-mention/tree/e85262ddced0a7f0b6fc8350d236a68bd1e28385)
Browse the repository at this point in the history

```
Fix innerHTML XSS vulnerability
```

* Loading branch information

[![@csculley](https://avatars.githubusercontent.com/u/5550159?s=40&v=4)](/csculley)

[csculley](/quill-mention/quill-mention/commits?author=csculley "View all commits by csculley")
authored
Sep 11, 2023

2 parents
[125636a](/quill-mention/quill-mention/commit/125636a2c0edb54d7b2f881532bfbab281f694e2)
+
[6e04010](/quill-mention/quill-mention/commit/6e040106a781711c6040465c26f1f22999e1187a)

commit e85262d

 Show file tree

 Hide file tree

Showing
**8 changed files**
with
**104 additions**
and
**45 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* README.md
  [README.md](#diff-b335630551682c19a781afebcf4d07bf978fb1f8ac04c6bf87428ed5106870f5)
* docs

  + docs/index.html
    [index.html](#diff-b04b38d4e36f7a7171aeb211bf933eaf36d41d9866ebbc3639f673f84dc350ae)
  + docs/quill.mention.min.js
    [quill.mention.min.js](#diff-ca4542ca8b1a8cfda8ae5a45c97469e736b50feec170726f7ef0dac9297a1106)
* package-lock.json
  [package-lock.json](#diff-053150b640a7ce75eff69d1a22cae7f0f94ad64ce9a855db544dda0929316519)
* package.json
  [package.json](#diff-7ae45ad102eab3b6d7e7896acd08c427a9b25b346470d7bc6507b6481575d519)
* src

  + blots

    - src/blots/mention.js
      [mention.js](#diff-b0f83b8d21658d0e56848b7caf63123e031817f8cb3566abb3e4885f1b9b8222)
  + src/quill.mention.js
    [quill.mention.js](#diff-abffac1c006c2a96ab282611528f090200458a52610957fbbe3c7e1077800304)
  + utils

    - src/utils/index.js
      [index.js](#diff-ebd8554ec43b07366bd40d16b09d1d063d9e8d5921fa30de4eb80bffdf82668d)

## There are no files selected for viewing

43 changes: 41 additions & 2 deletions

43
[README.md](#diff-b335630551682c19a781afebcf4d07bf978fb1f8ac04c6bf87428ed5106870f5 "README.md")

Show comments

[View file](/quill-mention/quill-mention/blob/e85262ddced0a7f0b6fc8350d236a68bd1e28385/README.md)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |

| Expand Up | | @@ -147,7 +147,7 @@ const quill = new Quill("#editor", { |
|  |  | | Property | Default | Description | |
|  |  | | --------------------------------------------- | ------------------------------------------------------------ | ------------------------------------------------------------ | |
|  |  | | `source(searchTerm, renderList, mentionChar)` | `null` | Required callback function to handle the search term and connect it to a data source for matches. The data source can be a local source or an AJAX request. The callback should call `renderList(matches, searchTerm);` with matches of JSON Objects in an array to show the result for the user. The JSON Objects should have `id` and `value` but can also have other values to be used in `renderItem` for custom display. | |
|  |  | | `renderItem(item, searchTerm)` | `function` | A function that gives you control over how matches from source are displayed. You can use this function to highlight the search term or change the design with custom HTML. | |
|  |  | | `renderItem(item, searchTerm)` | `function` | A function that gives you control over how matches from source are displayed. You can use this function to highlight the search term or change the design with custom HTML. This function will need to return either a string possibly containing unsanitized user content, or a class implementing the [Node](https://developer.mozilla.org/en-US/docs/Web/API/Node) interface which will be treated as a sanitized DOM node. | |
|  |  | | `allowedChars` | `[a-zA-Z0-9\_]` (or `function`) | Allowed characters in search term triggering a search request using regular expressions. Can be a function that takes the denotationChar and returns a regex. | |
|  |  | | `minChars` | `0` | Minimum number of characters after the @ symbol triggering a search request | |
|  |  | | `maxChars` | `31` | Maximum number of characters after the @ symbol triggering a search request | |
| Expand All | | @@ -171,7 +171,7 @@ const quill = new Quill("#editor", { |
|  |  | | `mentionListClass` | `'ql-mention-list'` | Style class to be used for the mention list (may be null) | |
|  |  | | `spaceAfterInsert` | `true` | Whether or not insert 1 space after mention block in text | |
|  |  | | `positioningStrategy` | `'absolute'` | Options are `'normal'` and `'fixed'`. When `'fixed'`, the menu will be appended to the body and use fixed positioning. Use this if the menu is clipped by a parent element that's using `overflow:hidden|scroll`. | |
|  |  | | `renderLoading` | `function` | A function that returns the HTML for a loading message during async calls from `source`. The default functions returns `null` to prevent a loading message. | |
|  |  | | `renderLoading` | `function` | A function that returns the HTML for a loading message during async calls from `source`. The function will need to return either a string possibly containing unsanitized user content, or a class implementing the [Node](https://developer.mozilla.org/en-US/docs/Web/API/Node) interface which will be treated as a sanitized DOM node. The default functions returns `null` to prevent a loading message. | |
|  |  | | `selectKeys` | `[13]` | An array of keyboard key codes that will trigger the select action for the mention dropdown. Default is ENTER key. See [this reference](http://gcctech.org/csc/javascript/javascript\_keycodes.htm) for a list of numbers for each keyboard key. | |
|  |  |  |
|  |  | ### Methods |
| Expand All | | @@ -187,10 +187,49 @@ You may retrieve the module from Quill like `quill.getModule('mention')` then ca |
|  |  |  |
|  |  | To allow styling based on the menu orientation, a class is added depending on the orientation and the `mentionContainerClass` option. By default this will be `ql-mention-list-container-bottom` or `ql-mention-list-container-top`. |
|  |  |  |
|  |  | #### Mention Blot Styling |
|  |  |  |
|  |  | Mention blots can also be dynamically styled from data attributes, but requires |
|  |  | implement a custom Quill blot. For example: |
|  |  |  |
|  |  | ```javascript |
|  |  | const MentionBlot = Quill.import("blots/mention"); |
|  |  |  |
|  |  | class StyledMentionBlot extends MentionBlot { |
|  |  | static render(data) { |
|  |  | const element = document.createElement('span'); |
|  |  | element.innerText = data.value; |
|  |  | element.style.color = data.color; |
|  |  | return element; |
|  |  | } |
|  |  | } |
|  |  | StyledMentionBlot.blotName = "styled-mention"; |
|  |  |  |
|  |  | Quill.register(StyledMentionBlot); |
|  |  | ``` |
|  |  |  |
|  |  | Then, when creating your Quill instance, use the following settings: |
|  |  |  |
|  |  | ```javascript |
|  |  | const quill = new Quill('#editor', { |
|  |  | modules: { |
|  |  | mention: { |
|  |  | // ... |
|  |  | dataAttributes: ['id', 'value', 'denotationChar', 'link', 'target', 'disabled', 'color'], |
|  |  | blotName: 'styled-mention', |
|  |  | } |
|  |  | } |
|  |  | }); |
|  |  | ``` |
|  |  |  |
|  |  | ### Headers and Informational Items |
|  |  |  |
|  |  | Sometimes you may want to display a menu item that should not be selectable. These items may be group headers, hint text, or even a message saying there were no matching results. To show items like these, add `disabled:true` to items passed to `renderList` from your `source` method. Disabled items are shown but not selectable with the mouse or keyboard. If you need to style the disabled items differently, you will need to override the `renderItem` method. |
|  |  |  |
|  |  | ### Upgrade Notes |
|  |  |  |
|  |  | As of 4.0.0, HTML embedded in `value` will no longer be rendered, due to potential XSS issues. Instead, to adjust rendering of list items, you can return a class implementing the [Node](https://developer.mozilla.org/en-US/docs/Web/API/Node) interface which will be treated as a sanitized DOM node, and in order to customize blot rendering, you will need to create a [custom mention blot](https://github.com/quill-mention/quill-mention#mention-blot-styling) |
|  |  |  |
|  |  | ## Authors |
|  |  |  |
|  |  | \*\*Fredrik Sundqvist\*\* ([MadSpindel](https://github.com/MadSpindel)) |
| Expand Down | |  |

42 changes: 31 additions & 11 deletions

42
[docs/index.html](#diff-b04b38d4e36f7a7171aeb211bf933eaf36d41d9866ebbc3639f673f84dc350ae "docs/index.html")

Show comments

[View file](/quill-mention/quill-mention/blob/e85262ddced0a7f0b6fc8350d236a68bd1e28385/docs/index.html)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -47,7 +47,7 @@ <h2>Simple Demo</h2> |
|  |  |  |
|  |  | <br /> |
|  |  | <h2>Advanced Demo</h2> |
|  |  | <p>Asynchronous retrieval, disabled items (i.e. group headers), loading message, programmatic methods</p> |
|  |  | <p>Asynchronous retrieval, disabled items (i.e. group headers), loading message, programmatic methods, and custom blot rendering</p> |
|  |  | <div id="editor2"></div> |
|  |  | <div style="margin-top:5px"> |
|  |  | <button onclick="showMenu()">Show @ Menu</button> |
| Expand All | | @@ -61,6 +61,7 @@ <h2>License</h2> |
|  |  | <!-- Include the Quill library --> |
|  |  | <script src="https://cdn.quilljs.com/1.3.6/quill.min.js"></script> |
|  |  | <script src="quill.mention.min.js"></script> |
|  |  |  |
|  |  | <!-- Initialize Quill editor --> |
|  |  | <script> |
|  |  | const atValues = [ |
| Expand All | | @@ -86,15 +87,15 @@ <h2>License</h2> |
|  |  | ]; |
|  |  |  |
|  |  | const advancedValues = [ |
|  |  | { id: "1", value: "Manuel Neuer", team: "Bayern Munich" }, |
|  |  | { id: "2", value: "Robert Lewandowski", team: "Bayern Munich" }, |
|  |  | { id: "3", value: "Thomas Muller", team: "Bayern Munich" }, |
|  |  | { id: "4", value: "Roman Burki", team: "Borussia Dortmund" }, |
|  |  | { id: "5", value: "Jadon Sancho", team: "Borussia Dortmund" }, |
|  |  | { id: "6", value: "Marco Reus", team: "Borussia Dortmund" }, |
|  |  | { id: "7", value: "Alexander Nubel", team: "Schalke 04" }, |
|  |  | { id: "8", value: "Bastian Oczipka", team: "Schalke 04" }, |
|  |  | { id: "9", value: "Weston McKennie", team: "Schalke 04" } |
|  |  | { id: "1", value: "Manuel Neuer", team: "Bayern Munich", color: "green" }, |
|  |  | { id: "2", value: "Robert Lewandowski", team: "Bayern Munich", color: "blue" }, |
|  |  | { id: "3", value: "Thomas Muller", team: "Bayern Munich", color: "red" }, |
|  |  | { id: "4", value: "Roman Burki", team: "Borussia Dortmund", color: "orange" }, |
|  |  | { id: "5", value: "Jadon Sancho", team: "Borussia Dortmund", color: "black" }, |
|  |  | { id: "6", value: "Marco Reus", team: "Borussia Dortmund", color: "yellow" }, |
|  |  | { id: "7", value: "Alexander Nubel", team: "Schalke 04", color: "purple" }, |
|  |  | { id: "8", value: "Bastian Oczipka", team: "Schalke 04", color: "indigo" }, |
|  |  | { id: "9", value: "Weston McKennie", team: "Schalke 04", color: "violet" } |
|  |  | ]; |
|  |  |  |
|  |  | var quill = new Quill("#editor", { |
| Expand Down  Expand Up | | @@ -130,6 +131,20 @@ <h2>License</h2> |
|  |  | } |
|  |  | }); |
|  |  |  |
|  |  | const MentionBlot = Quill.import("blots/mention"); |
|  |  |  |
|  |  | class StyledMentionBlot extends MentionBlot { |
|  |  | static render(data) { |
|  |  | const element = document.createElement('span'); |
|  |  | element.innerText = data.value; |
|  |  | element.style.color = data.color; |
|  |  | return element; |
|  |  | } |
|  |  | } |
|  |  | StyledMentionBlot.blotName = "styled-mention"; |
|  |  |  |
|  |  | Quill.register(StyledMentionBlot); |
|  |  |  |
|  |  | var quill2 = new Quill("#editor2", { |
|  |  | placeholder: "Start by typing @ for mentions", |
|  |  | modules: { |
| Expand All | | @@ -139,7 +154,10 @@ <h2>License</h2> |
|  |  | positioningStrategy: "fixed", |
|  |  | renderItem: (data) => { |
|  |  | if (data.disabled) { |
|  |  | return `<div style="height:10px;line-height:10px;font-size:10px;background-color:#ccc;margin:0 -20px;padding:4px">${data.value}</div>`; |
|  |  | const div = document.createElement("div"); |
|  |  | div.style = "height:10px;line-height:10px;font-size:10px;background-color:#ccc;margin:0 -20px;padding:4px"; |
|  |  | div.innerText = data.value; |
|  |  | return div; |
|  |  | } |
|  |  | return data.value; |
|  |  | }, |
| Expand Down  Expand Up | | @@ -178,6 +196,8 @@ <h2>License</h2> |
|  |  | renderList(matches, searchTerm); |
|  |  | }, 1000); |
|  |  | }, |
|  |  | dataAttributes: ['id', 'value', 'denotationChar', 'link', 'target', 'disabled', 'color'], |
|  |  | blotName: 'styled-mention', |
|  |  | }, |
|  |  | }, |
|  |  | }); |
| Expand Down | |  |

2 changes: 1 addition & 1 deletion

2
[docs/quill.mention.min.js](#diff-ca4542ca8b1a8cfda8ae5a45c97469e736b50feec170726f7ef0dac9297a1106 "docs/quill.mention.min.js")

Show comments

[View file](/quill-mention/quill-mention/blob/e85262ddced0a7f0b6fc8350d236a68bd1e28385/docs/quill.mention.min.js)
Edit file

Delete file

Load diff

Large diffs are not rendered by default.

Oops, something went wrong.

Retry

4 changes: 2 additions & 2 deletions

4
[package-lock.json](#diff-053150b640a7ce75eff69d1a22cae7f0f94ad64ce9a855db544dda0929316519 "package-lock.json")

Show comments

[View file](/quill-mention/quill-mention/blob/e85262ddced0a7f0b6fc8350d236a68bd1e28385/package-lock.json)
Edit file

Delete file

Load diff

Some generated files are not rendered by default. Learn more about [how customized files appear on GitHub](https://docs.github.com/github/administering-a-repository/customizing-how-changed-files-appear-on-github).

Oops, something went wrong.

Retry

2 changes: 1 addition & 1 deletion

2
[package.json](#diff-7ae45ad102eab3b6d7e7896acd08c427a9b25b346470d7bc6507b6481575d519 "package.json")

Show comments

[View file](/quill-mention/quill-mention/blob/e85262ddced0a7f0b6fc8350d236a68bd1e28385/package.json)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1,6 +1,6 @@ |
|  |  | { |
|  |  | "name": "quill-mention", |
|  |  | "version": "3.4.1", |
|  |  | "version": "4.0.0", |
|  |  | "description": "@mentions for the Quill rich text editor", |
|  |  | "homepage": "https://quill-mention.com/", |
|  |  | "main": "dist/quill.mention.csj.js", |
| Expand Down | |  |

15 changes: 11 additions & 4 deletions

15
[src/blots/mention.js](#diff-b0f83b8d21658d0e56848b7caf63123e031817f8cb3566abb3e4885f1b9b8222 "src/blots/mention.js")

Show comments

[View file](/quill-mention/quill-mention/blob/e85262ddced0a7f0b6fc8350d236a68bd1e28385/src/blots/mention.js)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -14,11 +14,18 @@ class MentionBlot extends Embed { |
|  |  |  |
|  |  | static create(data) { |
|  |  | const node = super.create(); |
|  |  |  |
|  |  | const denotationChar = document.createElement("span"); |
|  |  | denotationChar.className = "ql-mention-denotation-char"; |
|  |  | denotationChar.innerHTML = data.denotationChar; |
|  |  | denotationChar.innerText = data.denotationChar; |
|  |  | node.appendChild(denotationChar); |
|  |  | node.innerHTML += data.value; |
|  |  |  |
|  |  | if (typeof this.render === 'function') { |
|  |  | node.appendChild(this.render(data)); |
|  |  | } else { |
|  |  | node.innerText += data.value; |
|  |  | } |
|  |  |  |
|  |  | return MentionBlot.setDataValues(node, data); |
|  |  | } |
|  |  |  |
| Expand All | | @@ -36,7 +43,7 @@ class MentionBlot extends Embed { |
|  |  |  |
|  |  | attach() { |
|  |  | super.attach(); |
|  |  |  |
|  |  |  |
|  |  | if (!this.mounted) { |
|  |  | this.mounted = true; |
|  |  | this.clickHandler = this.getClickHandler(); |
| Expand Down  Expand Up | | @@ -89,4 +96,4 @@ MentionBlot.blotName = "mention"; |
|  |  | MentionBlot.tagName = "span"; |
|  |  | MentionBlot.className = "mention"; |
|  |  |  |
|  |  | Quill.register(MentionBlot); |
|  |  | Quill.register("blots/mention", MentionBlot); |

32 changes: 9 additions & 23 deletions

32
[src/quill.mention.js](#diff-abffac1c006c2a96ab282611528f090200458a52610957fbbe3c7e1077800304 "src/quill.mention.js")

Show comments

[View file](/quill-mention/quill-mention/blob/e85262ddced0a7f0b6fc8350d236a68bd1e28385/src/quill.mention.js)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -4,7 +4,8 @@ import { |
|  |  | attachDataValues, |
|  |  | getMentionCharIndex, |
|  |  | hasValidChars, |
|  |  | hasValidMentionCharIndex |
|  |  | hasValidMentionCharIndex, |
|  |  | setInnerContent, |
|  |  | } from "./utils"; |
|  |  | import "./quill.mention.css"; |
|  |  | import "./blots/mention"; |
| Expand All | | @@ -27,8 +28,8 @@ class Mention { |
|  |  |  |
|  |  | this.options = { |
|  |  | source: null, |
|  |  | renderItem(item) { |
|  |  | return `${item.value}`; |
|  |  | renderItem({ value }) { |
|  |  | return `${value}`; |
|  |  | }, |
|  |  | renderLoading() { |
|  |  | return null; |
| Expand Down  Expand Up | | @@ -244,22 +245,6 @@ class Mention { |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | getItemData() { |
|  |  | const { link } = this.mentionList.childNodes[this.itemIndex].dataset; |
|  |  | const hasLinkValue = typeof link !== "undefined"; |
|  |  | const itemTarget = this.mentionList.childNodes[this.itemIndex].dataset |
|  |  | .target; |
|  |  | if (hasLinkValue) { |
|  |  | this.mentionList.childNodes[ |
|  |  | this.itemIndex |
|  |  | ].dataset.value = `<a href="${link}" target=${itemTarget || |
|  |  | this.options.linkTarget}>${ |
|  |  | this.mentionList.childNodes[this.itemIndex].dataset.value |
|  |  | }`; |
|  |  | } |
|  |  | return this.mentionList.childNodes[this.itemIndex].dataset; |
|  |  | } |
|  |  |  |
|  |  | onContainerMouseMove() { |
|  |  | this.suspendMouseEnter = false; |
|  |  | } |
| Expand All | | @@ -268,7 +253,7 @@ class Mention { |
|  |  | if (this.itemIndex === -1) { |
|  |  | return; |
|  |  | } |
|  |  | const data = this.getItemData(); |
|  |  | const data = this.mentionList.childNodes[this.itemIndex].dataset; |
|  |  | if (data.disabled) { |
|  |  | return; |
|  |  | } |
| Expand Down  Expand Up | | @@ -365,7 +350,7 @@ class Mention { |
|  |  | this.mentionList.innerHTML = ""; |
|  |  | var loadingDiv = document.createElement("div"); |
|  |  | loadingDiv.className = "ql-mention-loading"; |
|  |  | loadingDiv.innerHTML = this.options.renderLoading(); |
|  |  | setInnerContent(loadingDiv, this.options.renderLoading()); |
|  |  | this.mentionContainer.append(loadingDiv); |
|  |  | this.showMentionList(); |
|  |  | } |
| Expand All | | @@ -382,7 +367,7 @@ class Mention { |
|  |  | this.removeLoading(); |
|  |  |  |
|  |  | this.values = data; |
|  |  | this.mentionList.innerHTML = ""; |
|  |  | this.mentionList.innerText = ""; |
|  |  |  |
|  |  | var initialSelection = -1; |
|  |  |  |
| Expand All | | @@ -399,7 +384,8 @@ class Mention { |
|  |  | initialSelection = i; |
|  |  | } |
|  |  | li.dataset.index = i; |
|  |  | li.innerHTML = this.options.renderItem(data[i], searchTerm); |
|  |  | const renderedItem = this.options.renderItem(data[i], searchTerm); |
|  |  | setInnerContent(li, renderedItem); |
|  |  | if (!data[i].disabled) { |
|  |  | li.onmouseenter = this.onItemMouseEnter.bind(this); |
|  |  | li.onmouseup = this.onItemClick.bind(this); |
| Expand Down | |  |

9 changes: 8 additions & 1 deletion

9
[src/utils/index.js](#diff-ebd8554ec43b07366bd40d16b09d1d063d9e8d5921fa30de4eb80bffdf82668d "src/utils/index.js")

Show comments

[View file](/quill-mention/quill-mention/blob/e85262ddced0a7f0b6fc8350d236a68bd1e28385/src/utils/index.js)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -10,6 +10,12 @@ function attachDataValues(element, data, dataAttributes) { |
|  |  | return mention; |
|  |  | } |
|  |  |  |
|  |  | function setInnerContent (element, value) { |
|  |  | if (value === null) return; |
|  |  | if (typeof value === "object") element.appendChild(value); |
|  |  | else element.innerText = value; |
|  |  | } |
|  |  |  |
|  |  | function getMentionCharIndex(text, mentionDenotationChars, isolateChar, allowInlineMentionChar) { |
|  |  | return mentionDenotationChars.reduce( |
|  |  | (prev, mentionChar) => { |
| Expand Down  Expand Up | | @@ -72,5 +78,6 @@ export { |
|  |  | attachDataValues, |
|  |  | getMentionCharIndex, |
|  |  | hasValidChars, |
|  |  | hasValidMentionCharIndex |
|  |  | hasValidMentionCharIndex, |
|  |  | setInnerContent |
|  |  | }; |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `e85262d`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fquill-mention%2Fquill-mention%2Fcommit%2Fe85262ddced0a7f0b6fc8350d236a68bd1e28385) to comment.

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.



=== Content from github.com_5022cb41_20250110_163046.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fquill-mention%2Fquill-mention%2Fissues%2F255)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fquill-mention%2Fquill-mention%2Fissues%2F255)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=quill-mention%2Fquill-mention)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[quill-mention](/quill-mention)
/
**[quill-mention](/quill-mention/quill-mention)**
Public

* [Notifications](/login?return_to=%2Fquill-mention%2Fquill-mention) You must be signed in to change notification settings
* [Fork
  274](/login?return_to=%2Fquill-mention%2Fquill-mention)
* [Star
   770](/login?return_to=%2Fquill-mention%2Fquill-mention)

* [Code](/quill-mention/quill-mention)
* [Issues
  42](/quill-mention/quill-mention/issues)
* [Pull requests
  10](/quill-mention/quill-mention/pulls)
* [Discussions](/quill-mention/quill-mention/discussions)
* [Actions](/quill-mention/quill-mention/actions)
* [Projects
  0](/quill-mention/quill-mention/projects)
* [Security](/quill-mention/quill-mention/security)
* [Insights](/quill-mention/quill-mention/pulse)

Additional navigation options

* [Code](/quill-mention/quill-mention)
* [Issues](/quill-mention/quill-mention/issues)
* [Pull requests](/quill-mention/quill-mention/pulls)
* [Discussions](/quill-mention/quill-mention/discussions)
* [Actions](/quill-mention/quill-mention/actions)
* [Projects](/quill-mention/quill-mention/projects)
* [Security](/quill-mention/quill-mention/security)
* [Insights](/quill-mention/quill-mention/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fquill-mention%2Fquill-mention%2Fissues%2Fnew%2Fchoose)

By clicking ‚ÄúSign up for GitHub‚Äù, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We‚Äôll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fquill-mention%2Fquill-mention%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Uses innerHTML - potentially allows injection attacks #255

Closed

[cocoademon](/cocoademon) opened this issue
Jun 24, 2022
¬∑ 14 comments
 ¬∑ Fixed by [#341](https://github.com/quill-mention/quill-mention/pull/341)

Closed

# [Uses innerHTML - potentially allows injection attacks](#top) #255

[cocoademon](/cocoademon) opened this issue
Jun 24, 2022
¬∑ 14 comments
 ¬∑ Fixed by [#341](https://github.com/quill-mention/quill-mention/pull/341)

## Comments

[![@cocoademon](https://avatars.githubusercontent.com/u/810106?s=80&u=9ad917c01514a808a3ddba7797a723fa2aa0cfb6&v=4)](/cocoademon)

Copy link

### **[cocoademon](/cocoademon)** commented [Jun 24, 2022](#issue-1283140468)

| In renderList, the list items are rendered using innerHTML with no escaping. If the mentions list is sourced from unsafe (user-sourced) data, this might allow an injection attack when a Quill user hits @.     [quill-mention/src/quill.mention.js](https://github.com/quill-mention/quill-mention/blob/0aa9847719257496b14ac5401872c4e2ffcbc3d1/src/quill.mention.js#L391)  Line 391 in [0aa9847](/quill-mention/quill-mention/commit/0aa9847719257496b14ac5401872c4e2ffcbc3d1)   |  | li.innerHTML = this.options.renderItem(data[i], searchTerm); | | --- | --- |      A possible solution is to change renderItem to return a DOMelement, which uses textContent rather than innerHTML. |
| --- | --- | --- |
| The text was updated successfully, but these errors were encountered: |

 üëç
6
 pizzadudez, areemadev, shengslogar, ALiangLiang, ogzhnsfgl, and csculley reacted with thumbs up emoji

All reactions

* üëç
  6 reactions

[![@ALiangLiang](https://avatars.githubusercontent.com/u/6974496?s=80&v=4)](/ALiangLiang)

Copy link

### **[ALiangLiang](/ALiangLiang)** commented [Jul 4, 2023](#issuecomment-1620660236) ‚Ä¢ edited Loading

| Thanks [@cocoademon](https://github.com/cocoademon). It's really a XSS vulnerability. I'll stop using it in my product.  DEMO: <https://codepen.io/ALiangLiang/pen/mdQMJXK>  [image](https://private-user-images.githubusercontent.com/6974496/250981971-433f7dda-4af5-4d87-835e-aadf0d4bed02.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1MjY5NDYsIm5iZiI6MTczNjUyNjY0NiwicGF0aCI6Ii82OTc0NDk2LzI1MDk4MTk3MS00MzNmN2RkYS00YWY1LTRkODctODM1ZS1hYWRmMGQ0YmVkMDIucG5nP1gtQW16LUFsZ29yaXRobT1BV1M0LUhNQUMtU0hBMjU2JlgtQW16LUNyZWRlbnRpYWw9QUtJQVZDT0RZTFNBNTNQUUs0WkElMkYyMDI1MDExMCUyRnVzLWVhc3QtMSUyRnMzJTJGYXdzNF9yZXF1ZXN0JlgtQW16LURhdGU9MjAyNTAxMTBUMTYzMDQ2WiZYLUFtei1FeHBpcmVzPTMwMCZYLUFtei1TaWduYXR1cmU9ZDc4YjIxMmI2YzgxMmMyZDhjNmE4ODQxMzBjNTYyMzY4NTBjNjYzZGIyN2IyYmNkOTk3ZGVhMzZlNDVmN2YwYyZYLUFtei1TaWduZWRIZWFkZXJzPWhvc3QifQ.jwBssCTqPTogiqm5Lz-UnfgGYzcvUzRrkn29MTpAkqQ) |
| --- |

All reactions

Sorry, something went wrong.

[![@thexeos](https://avatars.githubusercontent.com/u/2260539?s=80&u=64f19db5907b698973ec10fca6b32344de569254&v=4)](/thexeos)

Copy link

Collaborator

### **[thexeos](/thexeos)** commented [Sep 5, 2023](#issuecomment-1705981385)

| Why stop using it if you can just call some generic `escapeHTML` on `value` before returning the list?  [@cocoademon](https://github.com/cocoademon), there is another place where innerHTML is used and using DOMElement won't be a solution:     [quill-mention/src/blots/mention.js](https://github.com/quill-mention/quill-mention/blob/dc1a78c9d65e5821c1be07cd1f0655404e913d03/src/blots/mention.js#L21)  Line 21 in [dc1a78c](/quill-mention/quill-mention/commit/dc1a78c9d65e5821c1be07cd1f0655404e913d03)   |  | node.innerHTML += data.value; | | --- | --- |      This is the code where the blot is rendered. |
| --- | --- | --- |

All reactions

Sorry, something went wrong.

[![@ALiangLiang](https://avatars.githubusercontent.com/u/6974496?s=80&v=4)](/ALiangLiang)

Copy link

### **[ALiangLiang](/ALiangLiang)** commented [Sep 6, 2023](#issuecomment-1707719508)

| Why stop using it if you can just call some generic `escapeHTML` on `value` before returning the list?  [@cocoademon](https://github.com/cocoademon), there is another place where innerHTML is used and using DOMElement won't be a solution:     [quill-mention/src/blots/mention.js](https://github.com/quill-mention/quill-mention/blob/dc1a78c9d65e5821c1be07cd1f0655404e913d03/src/blots/mention.js#L21)  Line 21 in [dc1a78c](/quill-mention/quill-mention/commit/dc1a78c9d65e5821c1be07cd1f0655404e913d03)   |  | node.innerHTML += data.value; | | --- | --- |      This is the code where the blot is rendered.  I can't risk my bussiness product being hacked even if I use any escapeHTML packages. What if a new XSS method emerge? The best solution is to stop assigning user generated value to `innerHTML`. |
| --- | --- | --- |

All reactions

Sorry, something went wrong.

[![@csculley](https://avatars.githubusercontent.com/u/5550159?s=40&u=70216e768a659bdcd25756d215f85c5e9b06ca78&v=4)](/csculley)
[csculley](/csculley)
mentioned this issue
[Sep 6, 2023](#ref-pullrequest-1884733562)

[Fix innerHTML XSS vulnerability
#341](/quill-mention/quill-mention/pull/341)
 Merged

[![@csculley](https://avatars.githubusercontent.com/u/5550159?s=80&u=70216e768a659bdcd25756d215f85c5e9b06ca78&v=4)](/csculley)

Copy link

Collaborator

### **[csculley](/csculley)** commented [Sep 6, 2023](#issuecomment-1709104757) ‚Ä¢ edited Loading

| Hello, I've attempted to partially address this issue with [#341](https://github.com/quill-mention/quill-mention/pull/341), which sanitizes `renderItem` with `innerText` since `renderItem` explicitly returns a string. Using `innerText` should be safe here since the list element isn't a `script`.  I think fully resolving this issue would most likely need to properly support returning HTML from `renderItem` somehow (maybe a wrapper?) , which could then be used also better sanitize `renderLoading` as well, but I mostly wanted to patch this issue in the meantime while the details for that could be discussed in this or another ticket. Thank you! |
| --- |

All reactions

Sorry, something went wrong.

[![@csculley](https://avatars.githubusercontent.com/u/5550159?s=80&u=70216e768a659bdcd25756d215f85c5e9b06ca78&v=4)](/csculley)

Copy link

Collaborator

### **[csculley](/csculley)** commented [Sep 7, 2023](#issuecomment-1709345537) ‚Ä¢ edited Loading

| I'm thinking, maybe in the meantime we can provide `{id: 1, value: 'text'}` or `{id: 2, html: '<html>'}`, and for renderItem, returning `{text: 'text'}` or `{html: '<html>'}` that will use `innerText` or `innerHTML` respectively. Then, people will only need to modify their items if they need to use custom HTML and any custom `renderItem` callbacks, and the vast majority of the use cases that use user-provided plaintext will be protected. Does this sound good with everyone? |
| --- |

 üëç
1
 thexeos reacted with thumbs up emoji

All reactions

* üëç
  1 reaction

Sorry, something went wrong.

[![@csculley](https://avatars.githubusercontent.com/u/5550159?s=80&u=70216e768a659bdcd25756d215f85c5e9b06ca78&v=4)](/csculley)

Copy link

Collaborator

### **[csculley](/csculley)** commented [Sep 7, 2023](#issuecomment-1709367965)

| Doing even more thinking, we could check if the returned item is a string or object, that would remove the need to change the `renderItem` unless you are using custom HTML, so I would guess that most people wouldn't need to change anything if they're just using text üòÑ |
| --- |

All reactions

Sorry, something went wrong.

[![@thexeos](https://avatars.githubusercontent.com/u/2260539?s=80&u=64f19db5907b698973ec10fca6b32344de569254&v=4)](/thexeos)

Copy link

Collaborator

### **[thexeos](/thexeos)** commented [Sep 7, 2023](#issuecomment-1709441989) ‚Ä¢ edited Loading

| Doing even more thinking, we could check if the returned item is a string or object, that would remove the need to change the `renderItem` unless you are using custom HTML, so I would guess that most people wouldn't need to change anything if they're just using text üòÑ  I like this idea. It provides backward compatibility for anyone who never intended to output HTML and an easy upgrade path.  What if the returned object is actually a `DocumentFragment` or `instanceof HTMLElement`? Make the HTML truly explicit and give an option to whoever needs HTML to construct it with DOM API rather than String concatenation. And besides, setting `innerHTML` already uses `DocumentFragment` under the hood.  With explicit approach, the upgrade instructions would be something along the lines of:  Replace this  ``` renderItem(item) {   return '<span style="color: ' + item.color + '">' + item.value + '</span>' } ```  With this  ``` renderItem(item) {   const renderer = document.createElement('template')   renderer.innerHTML = '<span style="color: ' + item.color + '">' + item.value + '</span>'   return renderer.content } ```  Or even better  ``` renderItem(item) {   const element = document.createElement('span')   element.innerText = item.value   element.style.color = item.color   return element } ``` |
| --- |

 üëç
2
 csculley and aktas reacted with thumbs up emoji

All reactions

* üëç
  2 reactions

Sorry, something went wrong.

[![@ALiangLiang](https://avatars.githubusercontent.com/u/6974496?s=80&v=4)](/ALiangLiang)

Copy link

### **[ALiangLiang](/ALiangLiang)** commented [Sep 7, 2023](#issuecomment-1709454569) ‚Ä¢ edited Loading

| I thinks for backward compatibility. If we prodvide a new bool option named `allowHTML` which default `true` on mention module, and keeps `item` strucutre `{ id: '', value: '' }`. And also comment the risk about the new option. So the package can bumps a minor version. And release a major version with default `false` `allowHTML` or even stops supporting HTML string.  ``` const quill = new Quill("#editor", {   modules: {     mention: {       allowedChars: /^[A-Za-z\s√Ö√Ñ√ñ√•√§√∂]*$/,       mentionDenotationChars: ["@", "#"],       source: async function(searchTerm, renderList) {         const matchedPeople = await suggestPeople(searchTerm);         renderList(matchedPeople);       },       allowHTML: true // default for `true` in minor version bumping, `false` for major version bumping     }   } }) ```  Maybe supporting [`Node`](https://developer.mozilla.org/en-US/docs/Web/API/Node) is better in above two version. Is's accepted by [`Element.append`](https://developer.mozilla.org/en-US/docs/Web/API/Element/append). Document, HTMLElement and DocumentFragment are all implementations of it.  ``` Node.isPrototypeOf(Document) // true Node.isPrototypeOf(Element) // true Node.isPrototypeOf(DocumentFragment) // true ``` |
| --- |

All reactions

Sorry, something went wrong.

[![@csculley](https://avatars.githubusercontent.com/u/5550159?s=80&u=70216e768a659bdcd25756d215f85c5e9b06ca78&v=4)](/csculley)

Copy link

Collaborator

### **[csculley](/csculley)** commented [Sep 7, 2023](#issuecomment-1710343646) ‚Ä¢ edited Loading

| Hmm, i'm running into a roadblock with rendering the mention blots. There'll be no good way to tell the difference between blots that have been saved in the past that rely on `blot.innerHTML = data.value`. These will either be unsafe or could be unsupported when relying on something newer like [Element.setHTML()](https://developer.mozilla.org/en-US/docs/Web/API/Element/setHTML#browser_compatibility) .  Since this is already a potentially breaking change, we could introduce a breaking change into the blot structure by saving text under `value` and `html` that we consider sanitized in string form under `html` in the blot, but I'm not sure if there's a better solution. |
| --- |

All reactions

Sorry, something went wrong.

[![@csculley](https://avatars.githubusercontent.com/u/5550159?s=80&u=70216e768a659bdcd25756d215f85c5e9b06ca78&v=4)](/csculley)

Copy link

Collaborator

### **[csculley](/csculley)** commented [Sep 7, 2023](#issuecomment-1710454146)

| I ended up saving the html in the mention blot under `_html` to avoid conflicting with any user-specified `html` fields. Please let me know if anyone has any thoughts on [#341](https://github.com/quill-mention/quill-mention/pull/341). Thank you!! |
| --- |

All reactions

Sorry, something went wrong.

[![@thexeos](https://avatars.githubusercontent.com/u/2260539?s=80&u=64f19db5907b698973ec10fca6b32344de569254&v=4)](/thexeos)

Copy link

Collaborator

### **[thexeos](/thexeos)** commented [Sep 7, 2023](#issuecomment-1710632955) ‚Ä¢ edited Loading

| Hmm, `value` being an object may cause more problems than I had initially anticipated. In essence, this changes resulting Delta in backwards incompatible way.  Before:  ``` { ops: [   { insert: { mention: { id: '1', value: 'Regular Tag', denotationChar: '@'  } } }   { insert: { mention: { id: '5', value: '<span style="color: red">Red Tag</span>', denotationChar: '@'  } } } ] }  ```  After (unserialized):  ``` { ops: [   { insert: { mention: { id: '1', value: 'Regular Tag', denotationChar: '@'  } } }   { insert: { mention: { id: '5', value: HTMLSpanElement, _html: '<span style="color: red;">Red Tag</span>', denotationChar: '@'  } } } ] }  ```  After (JSON serialized):  ``` { ops: [   { insert: { mention: { id: '1', value: 'Regular Tag', denotationChar: '@'  } } }   { insert: { mention: { id: '5', value: { text: 'Red Tag' }, _html: '<span style="color: red;">Red Tag</span>', denotationChar: '@'  } } } ] }  ```  I see two consequences to this:   1. We are still left with stored XSS - malicious user may manipulate the contents of `_html` and have it execute on other people's devices when they load Delta into their editor. 2. Rolling back to `quill-mention` v3 is not possible, as content of `value` is an object, so we'd be rendering `[object Object]` in place of mention text.   For (1) it arguably is the website developer's responsibility to sanitize user-generated content, including Deltas from Quill, and the proposed implementation would already shield the original editor (whoever inserts these mentions in the editor) from incoming XSS via `source` list.  To address (2), we must refrain from storing objects under `value` field. So maybe HTML goes into `value` and we include the originally proposed `html` flag to trigger insertion with `innerHTML` instead of `innerText`. But (1) still stands.  The ultimate solution would of course be passing a render function to the blot itself, so the developer that needs a customized blot, based on some custom `data` values, can do so at runtime. The `value` would then remain a `string` and be rendered with `innerText` in absence of a custom renderer. Of course, that is not a realistic solution due to the nature of blot registration with Quill.  More realistic solution would be to allow developers to extend from `MentionBlot` class and then either implement their own `create` method or to include logic in `create` method that would invoke some custom render method. The plugin already supports overriding the blot name via options, so at most only the `create` method would have to be changed.  It seems to me like this is the only sure way to avoid stored XSS during hydration of an editor while still allowing custom design for the blot.  The changes to blot code may look like this:  ``` class MentionBlot extends Embed {   // ...    static create(data) {     const node = super.create();     const denotationChar = document.createElement("span");     denotationChar.className = "ql-mention-denotation-char";     denotationChar.innerText = data.denotationChar;     node.appendChild(denotationChar);      if (typeof this.render === 'function') {       node.appendChild(this.render(data))     } else {       node.innerText += data.value;     }      return MentionBlot.setDataValues(node, data);   }    // ... } ```  User instructions may look like this:  ``` import { MentionBlot } from 'quill-mention'  class StyledMentionBlot extends MentionBlot {   constructor(scroll, node) {     super(scroll, node);   }    static render(data) {     const element = document.createElement('span');     element.innerText = data.value;     element.style.color = data.color;     return element;   } } StyledMentionBlot.blotName = "styled-mention";  Quill.register(StyledMentionBlot);  // ...  const quill = new Quill('#editor', {   modules: {     mention: {       // ...       dataAttributes: ['id', 'value', 'denotationChar', 'link', 'target', 'disabled', 'color'],       blotName: 'styled-mention',     }   } }); ```  And we'd have to export `MentionBlot`. |
| --- |

All reactions

Sorry, something went wrong.

[![@csculley](https://avatars.githubusercontent.com/u/5550159?s=80&u=70216e768a659bdcd25756d215f85c5e9b06ca78&v=4)](/csculley)

Copy link

Collaborator

### **[csculley](/csculley)** commented [Sep 8, 2023](#issuecomment-1711747290)

| This seems like a good path forward! I think it mirrors the way other custom blots are added to Quill. I'm still a bit confused by  Of course, that is not a realistic solution due to the nature of blot registration with Quill.  but that might just be due to my inexperience with Quill.  Currently (if i'm understanding correctly) there's only one `blotName` that can be set at a time, so when I think of the user defining custom mention blots, I think that they would also want to be able to embed multiple types simultaneously and have their respective custom blots created. However, instead of going down that rabbithole, could we just soup up the current `MentionBlot` and provide a single overrideable `serializeBlot` and `renderBlot` function that is sourced from the options?  To me it seems like this would be easier to implement initially (if they just have one custom type they want to style, just throwing in a custom `serializeBlot` and `renderBlot` and calling it a day) but would be less suitable, say if you want to wrangle with 15 different blot types all at once. I'm not sure if that's even really a use case we need to consider, and if not then we could wait until someone opens an issue with that feature request, and just add overrideable callbacks to the current mention blot in the meantime.  Please let me know if this sounds good or if i'm on the right track at least üòÑ |
| --- |

All reactions

Sorry, something went wrong.

[![@csculley](https://avatars.githubusercontent.com/u/5550159?s=80&u=70216e768a659bdcd25756d215f85c5e9b06ca78&v=4)](/csculley)

Copy link

Collaborator

### **[csculley](/csculley)** commented [Sep 8, 2023](#issuecomment-1711797612)

| I think I'm understanding a bit more after reading into custom blots. It seems like there's been some interest in rendering blots based on editor instance options (which is what we'd need for my proposed solution) which has been discussed here: [slab/quill#1162](https://github.com/slab/quill/issues/1162)  But I'm thinking it might be better to jump through all the hoops of defining custom blots off of `Mention` to avoid hacky ways of getting the editor configuration. I'll get to work on getting this working üòÑ |
| --- |

 ‚ù§Ô∏è
1
 thexeos reacted with heart emoji

All reactions

* ‚ù§Ô∏è
  1 reaction

Sorry, something went wrong.

[![@thexeos](https://avatars.githubusercontent.com/u/2260539?s=80&u=64f19db5907b698973ec10fca6b32344de569254&v=4)](/thexeos)

Copy link

Collaborator

### **[thexeos](/thexeos)** commented [Sep 9, 2023](#issuecomment-1712355789)

| However, instead of going down that rabbithole, could we just soup up the current `MentionBlot` and provide a single overrideable `serializeBlot` and `renderBlot` function that is sourced from the options?  You've already discovered the present Quill limitations in blot rendering, but for anyone looking for more context and how it all relates to this issue, here is the short explanation.   ---   *TL;DR blot is a class with `create` function that is passed a primitive `data` object extracted from Delta. Since Delta needs to be serialized, there is no reliable way to pass (custom) functions into the `create` function of a blot.*  The nature of the blot is to act as a Node factory with Delta OPs as inputs. Blot allows Quill to interface with your custom content, describing how it interacts with the editor and other content around it. To render a blot a `create` function is called, and it is passed a `data` object extracted from the Delta OP that contained this blot's custom name (e.g., given `{ insert: { mention: { value: 'John Doe' } } }` OP, the `data = { value: 'John Doe' }`). Since Delta is usually serialized to JSON for storage, the contents of `data` object are limited to supported JS types (string, number, boolean, null, [serializable] object, array). While you can always pass a custom function via a property in `data`, this function will lose its purpose during serialization.  What's also important is that Quill runs a global registry for blots. So if you register a blot named `mention`, then all editors will run its `create(data)` method to produce a Node. Thus, if you want one editor to render mentions as plain text and another editor to prepend an  with a profile photo next to the name, you will need to either: (a) find a way to pass a custom render function in `data` (won't work after serialization), or (b) define a custom blot, which would implement the corresponding `create(data)` method.   ---   The current approach that `quill-mention` takes - storing the rendered HTML in `data` - doesn't actually cover the above use case. Once the HTML is added as `value` to `data` - all Quill editors on the page would use that HTML in their `mention` Nodes.  Furthermore, my proposed custom blot name is also an incomplete solution, as it would only be "renderable" by the original custom blot and not by other implementations of the MentionBlot.  So I'd say the current list of requirements is:   * Maintain `data.value` type as String and always load it through `innerText` to avoid a built-in XSS * Maintain `blotName` the same for both backwards and lateral compatibility (across different mention plugin renderer implementations) unless the user requires it to be different for other purposes * Since the first requirement makes rendering of HTML from any stored `data.*` impossible, a new way to render HTML is needed   Now, since no editor context is passed to blot's `create(data)`, we can only ever define at most one custom renderer via this plugin - the same custom function that would be called for all `mention` blots on the page. Because of this, it doesn't make sense to accept a render function into plugin options, if only one function could ever operate at once.  So to recap:   * The HTML inside `quill-mention`'s blot *should* only ever be set inside MentionBlot's `create(data)` method * That method is static and it only ever receives `data` object, which lacks pointer to the editor in question * While a custom function can be called from MentionBlot's create method, and such function can be stored by `quill-mention` in some internal registry, there is no universal way to select between multiple registered functions   I don't currently have any non-hackish ideas to solve this. |
| --- |

 üëç
2
 csculley and digitalcraftco reacted with thumbs up emoji

All reactions

* üëç
  2 reactions

Sorry, something went wrong.

[![@csculley](https://avatars.githubusercontent.com/u/5550159?s=40&u=70216e768a659bdcd25756d215f85c5e9b06ca78&v=4)](/csculley)
[csculley](/csculley)
closed this as [completed](/quill-mention/quill-mention/issues?q=is%3Aissue+is%3Aclosed+archived%3Afalse+reason%3Acompleted)
in
[#341](/quill-mention/quill-mention/pull/341)
[Sep 11, 2023](#event-10334129258)

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fquill-mention%2Fquill-mention%2Fissues%2F255)

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

Successfully merging a pull request may close this issue.

 [Fix innerHTML XSS vulnerability](/quill-mention/quill-mention/pull/341)

4 participants

[![@cocoademon](https://avatars.githubusercontent.com/u/810106?s=52&v=4)](/cocoademon) [![@thexeos](https://avatars.githubusercontent.com/u/2260539?s=52&v=4)](/thexeos) [![@csculley](https://avatars.githubusercontent.com/u/5550159?s=52&v=4)](/csculley) [![@ALiangLiang](https://avatars.githubusercontent.com/u/6974496?s=52&v=4)](/ALiangLiang)

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.


