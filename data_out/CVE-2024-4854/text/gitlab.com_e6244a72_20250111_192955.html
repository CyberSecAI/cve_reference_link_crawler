

[Skip to content](#content-body)
GitLab

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

# Mongo: Ensure the offset advances

Code

* Review changes
* Check out branch
* ---
* Download
* [Patches](/wireshark/wireshark/-/merge_requests/15047.patch)
* [Plain diff](/wireshark/wireshark/-/merge_requests/15047.diff)

[John Thacker](/johnthacker) requested to merge  [johnthacker/wireshark:mongo\_negative\_length](/johnthacker/wireshark/-/tree/mongo_negative_length "johnthacker/wireshark:mongo_negative_length")
 into [master](/wireshark/wireshark/-/tree/master "master") Mar 30, 2024

* [Overview
  0](/wireshark/wireshark/-/merge_requests/15047)
* [Commits
  1](/wireshark/wireshark/-/merge_requests/15047/commits)
* [Pipelines
  2](/wireshark/wireshark/-/merge_requests/15047/pipelines)
* [Changes
  1](/wireshark/wireshark/-/merge_requests/15047/diffs)

Expand

The MongoDB Wire Protocol uses *signed* 32 bit integers for lengths.
dissect\_bson\_document checks for bogus values and ensures that a
non-negative (and at least 5) size is returned, but we need to make
sure to use that return value instead of trusting the value read
from the packet in dissect\_op\_msg\_section.

Fix [#19726 (closed)](/wireshark/wireshark/-/issues/19726 "Fuzz job crash: fuzz-2024-03-30-7212.pcap")

## Merge request reports

Assignee
Loading

Reviewers
Loading

Select reviewersRequest review fromLoading

Time tracking
Loading

Loading

