

[Skip to content](#content-body)
GitLab

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

# ZigBee TLV: fix infinite loop in deeply nested packets

Code

* Review changes
* Check out branch
* ---
* Download
* [Patches](/wireshark/wireshark/-/merge_requests/15499.patch)
* [Plain diff](/wireshark/wireshark/-/merge_requests/15499.diff)

[Martin Nyhus](/zidel_) requested to merge  [zidel\_/wireshark:zbee\_beacon\_loop](/zidel_/wireshark/-/tree/zbee_beacon_loop "zidel_/wireshark:zbee_beacon_loop")
 into [master](/wireshark/wireshark/-/tree/master "master") May 01, 2024

* [Overview
  0](/wireshark/wireshark/-/merge_requests/15499)
* [Commits
  1](/wireshark/wireshark/-/merge_requests/15499/commits)
* [Pipelines
  4](/wireshark/wireshark/-/merge_requests/15499/pipelines)
* [Changes
  1](/wireshark/wireshark/-/merge_requests/15499/diffs)

Expand

When analyzing a packet that hits the recursion limit returning the
remaining length of the buffer would allow backtracking, setting up an
infinite loop if the packet is constructed correctly and the code would
fail by hitting the too many items check.

Since dissect\_zbee\_tlvs doesn't know the length of the value it is
dissecting it can't pretend to have consumed all of it. Most of the
callers of this function eventually check for bytes that weren't
consumed so returning offset (i.e. no bytes consumed) makes the value
get treated as unknown bytes.

Input to fuzzshark\_zbee\_beacon that triggered this:
fb 03 49 ff 49 eb 49 ff 49 ff 49 eb 49 ff

## Merge request reports

Assignee
Loading

Reviewers
Loading

Select reviewersRequest review fromLoading

Time tracking
Loading

Loading

