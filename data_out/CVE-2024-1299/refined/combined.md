=== Content from gitlab.com_cdd0a486_20250111_125437.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

# Guest with manage group access tokens can rotate and see group access token with owner permissions

⚠ **Please read [the process](https://gitlab.com/gitlab-org/release/docs/-/blob/master/general/security/developer.md) on how to fix security issues before starting to work on the issue. Vulnerabilities must be fixed in a security mirror.**

**[HackerOne report #2356976](https://hackerone.com/reports/2356976)** by `ashish_r_padelkar` on 2024-02-06, assigned to [@rshambhuni](/rshambhuni "Rohit Shambhuni"):

[Report](#report) | [How To Reproduce](#how-to-reproduce)

## Report

##### Summary

It is possible for guest with custom role of `manage group access tokens` to rotate access token of group owner privileges using this vulnerability.

##### Steps to reproduce

1.1.Create a group (with ultimate licence trial).

2.Create a group access token with owner role and api scope at `https://Yourinstance/groups/groupjan2024/-/settings/access_tokens`

3.Now use your personal access token to create a custom role of `guest` role with `manage_group_access_tokens` permission.

```
curl --request POST --header "Content-Type: application/json" --header "Authorization: Bearer glpat-1233" --data '{"name" : "Custom guest1", "base_access_level" : 10, "manage_group_access_tokens" : true}' "http://Yourinstance/api/v4/groups/34/member_roles"
```

4.Now apply this custom role to group member at <https://Yourinstance/groups/groupjan2024/-/group_members>.

5.Login as above member and you see that you can see the group access token entry at `https://Yourinstance/groups/groupjan2024/-/settings/access_tokens` but cant see the token itself.

6.Now use below curl to rotate the token.

```
curl --request POST --header "PRIVATE-TOKEN: glpat-123" "http://Yourinstance/api/v4/groups/34/access_tokens/13/rotate"
```

`PRIVATE-TOKEN` is your personal token which can be created at `https://Yourinstance/-/user_settings/personal_access_tokens`

`access_tokens` ID (in this case, its 13) can be obtained from `http://Yourinstance/api/v4/groups/34/access_tokens`

7.Response will show you the token which has owner permission despite you having just guest role.

##### What is the current *bug* behavior?

Guest with manage group access tokens can rotate and see group access token with owner permissions

##### What is the expected *correct* behavior?

Guest with manage group access tokens can rotate but shouldn't see the group access token with higher permissions

##### Output of checks

Gitlab enterprise ultimate 16.8

creation of group access tokens are not enabled on gitlab.com yet

Regards,

Ashish

#### Impact

Guest with manage group access tokens can rotate and see group access token with owner permissions

## How To Reproduce

Please add [reproducibility information](https://about.gitlab.com/handbook/engineering/security/#reproducibility-on-security-issues) to this section:

Edited Apr 15, 2024 by [Rohit Shambhuni](/rshambhuni)

Assignee
Loading

Time tracking
Loading

Confidentiality

Confidentiality controls have moved to the issue actions menu () at the top of the page.



=== Content from about.gitlab.com_7cdbac90_20250111_125436.html ===


[←
Back to
releases](/releases/categories/releases/)
Mar 6, 2024

-
[Greg Myers](/company/team/#gitlab)
# GitLab Security Release: 16.9.2, 16.8.4, 16.7.7

Learn more about GitLab Security Release: 16.9.2, 16.8.4, 16.7.7 for GitLab Community Edition (CE) and Enterprise Edition (EE).

Today we are releasing versions 16.9.2, 16.8.4, 16.7.7 for GitLab Community Edition (CE) and Enterprise Edition (EE).

These versions contain important security fixes, and we strongly recommend that all GitLab installations be upgraded to
one of these versions immediately. GitLab.com is already running the patched version.

GitLab releases patches for vulnerabilities in dedicated security releases. There are two types of security releases:
a monthly, scheduled security release, released a week after the feature release (which deploys on the 3rd Thursday of each month),
and ad-hoc security releases for critical vulnerabilities. For more information, you can visit our [security FAQ](https://about.gitlab.com/security/faq/).
You can see all of our regular and security release blog posts [here](/releases/categories/releases/).
In addition, the issues detailing each vulnerability are made public on our
[issue tracker](https://gitlab.com/gitlab-org/gitlab/-/issues/?sort=created_date&state=closed&label_name%5B%5D=bug%3A%3Avulnerability&confidential=no&first_page_size=100)
30 days after the release in which they were patched.

We are dedicated to ensuring all aspects of GitLab that are exposed to customers or that host customer data are held to
the highest security standards. As part of maintaining good security hygiene, it is highly recommended that all customers
upgrade to the latest security release for their supported version. You can read more
[best practices in securing your GitLab instance](/blog/2020/05/20/gitlab-instance-security-best-practices/) in our blog post.

### Recommended Action

We **strongly recommend** that all installations running a version affected by the issues described below are **upgraded to the latest version as soon as possible**.

When no specific deployment type (omnibus, source code, helm chart, etc.) of a product is mentioned, this means all types are affected.

## Table of fixes

| Title | Severity |
| --- | --- |
| [Bypassing CODEOWNERS approval allowing to steal protected variables](#bypassing-codeowners-approval-allowing-to-steal-protected-variables) | High |
| [Guest with manage group access tokens can rotate and see group access token with owner permissions](#guest-with-manage-group-access-tokens-can-rotate-and-see-group-access-token-with-owner-permissions) | Medium |

### Bypassing CODEOWNERS approval allowing to steal protected variables

An authorization bypass vulnerability was discovered in GitLab affecting versions 11.3 prior to 16.7.7, 16.7.6 prior to 16.8.4, and 16.8.3 prior to 16.9.2. An attacker could bypass CODEOWNERS by utilizing a crafted payload in an old feature branch to perform malicious actions.
This is a high severity issue (`CVSS:3.1/AV:N/AC:H/PR:L/UI:R/S:C/C:H/I:H/A:N`, 7.7).
It is now mitigated in the latest release and is assigned [CVE-2024-0199](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-0199).

Thanks [ali\_shehab](https://hackerone.com/ali_shehab) for reporting this vulnerability through our HackerOne bug bounty program.

### Guest with manage group access tokens can rotate and see group access token with owner permissions

A privilege escalation vulnerability was discovered in GitLab affecting versions 16.8 prior to 16.8.4 and 16.9 prior to 16.9.2. It was possible for a user with custom role of `manage_group_access_tokens` to rotate group access tokens with owner privileges.
This is a medium severity issue (`CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:N`, 6.5).
It is now mitigated in the latest release and is assigned [CVE-2024-1299](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-1299).

Thanks [ashish\_r\_padelkar](https://hackerone.com/ashish_r_padelkar) for reporting this vulnerability through our HackerOne bug bounty program.

### Upgrade Kubectl to the latest stable version

`kubectl` has been updated to version 1.29.2.

### Mattermost Security Updates February 14, 2024

Mattermost has been updated to version 9.5, which contains several patches and security fixes.

## Non Security Patches

### 16.9.2

* [Merge branch 'hm-rescue-stale-element-error-in-base' into 'master'](https://gitlab.com/gitlab-org/gitlab/-/merge_requests/146113)
* [Fix broken master](https://gitlab.com/gitlab-org/gitlab/-/merge_requests/146033)
* [Use fixed date for failing specs [16.9]](https://gitlab.com/gitlab-org/gitlab/-/merge_requests/146202)
* [Backport 'pb-fix-broken-master-elastic' into 16.9](https://gitlab.com/gitlab-org/gitlab/-/merge_requests/146031)
* [Backport Fix Search::Zoekt.index? logic to 16.9](https://gitlab.com/gitlab-org/gitlab/-/merge_requests/145946)
* [Backport 'Don't escape search term in modal twice' into 16.9](https://gitlab.com/gitlab-org/gitlab/-/merge_requests/146036)
* [Backport 'add-praefect-to-release-environment-template'](https://gitlab.com/gitlab-org/gitlab/-/merge_requests/146315)
* [Backport 'Shows branch name in non-blobâ¦scopes' into 16.9](https://gitlab.com/gitlab-org/gitlab/-/merge_requests/146035)
* [Backport: Geo - Fix container repositories checksum mismatch errors](https://gitlab.com/gitlab-org/gitlab/-/merge_requests/146181)
* [Backport 145801 (Fix CI linter error when repository is empty) to 16.9](https://gitlab.com/gitlab-org/gitlab/-/merge_requests/146074)
* [Merge branch 'remove-pi-os-12-release' into 'master'](https://gitlab.com/gitlab-org/omnibus-gitlab/-/merge_requests/7444)
* [Backport to 16.9: Fix Geo: Personal snippets not syncing](https://gitlab.com/gitlab-org/gitlab/-/merge_requests/145036)

### 16.8.4

* [Backport to 16.8: Fix Geo: Personal snippets not syncing](https://gitlab.com/gitlab-org/gitlab/-/merge_requests/145037)
* [Backport to 16.8: Fix pg\_dump failing with multiple PG read-replicas](https://gitlab.com/gitlab-org/gitlab/-/merge_requests/145451)
* [Update tests for broken 16.8](https://gitlab.com/gitlab-org/gitlab/-/merge_requests/146233)
* [Backport 'add-praefect-to-release-environment-template'](https://gitlab.com/gitlab-org/gitlab/-/merge_requests/146316)
* [Backport: Geo - Fix container repositories checksum mismatch errors](https://gitlab.com/gitlab-org/gitlab/-/merge_requests/146183)
* [Backport 145801 (Fix CI linter error when repository is empty) to 16.8](https://gitlab.com/gitlab-org/gitlab/-/merge_requests/146073)

### 16.7.7

* [Backport to 16.7: Fix pg\_dump failing with multiple PG read-replicas](https://gitlab.com/gitlab-org/gitlab/-/merge_requests/145569)
* [Merge branch 'add-praefect-to-release-environment-template'](https://gitlab.com/gitlab-org/gitlab/-/merge_requests/146318)

## Updating

To update GitLab, see the [Update page](/update).
To update GitLab Runner, see the [Updating the Runner page](https://docs.gitlab.com/runner/install/linux-repository.html#updating-the-runner).

## Receive Security Release Notifications

To receive security release blog notifications delivered to your inbox, visit our [contact us](https://about.gitlab.com/company/contact/) page.
To receive release notifications via RSS, subscribe to our [security release RSS feed](https://about.gitlab.com/security-releases.xml) or our [RSS feed for all releases](https://about.gitlab.com/all-releases.xml).

[GitLab Security Release: 16.9.2, 16.8.4, 16.7.7
via @gitlab

Click to tweet!](http://twitter.com/share?text=GitLab+Security+Release%3A+16.9.2%2C+16.8.4%2C+16.7.7+via+%40gitlab&url=https://about.gitlab.com/releases/2024/03/06/security-release-gitlab-16-9-2-released/&hashtags= "Tweet!")

* [security](/releases/tags.html#security)

[Share on Facebook](http://www.facebook.com/sharer.php?u=https://about.gitlab.com/releases/2024/03/06/security-release-gitlab-16-9-2-released/)
[Share on X](http://x.com/share?url=https://about.gitlab.com/releases/2024/03/06/security-release-gitlab-16-9-2-released/&text=GitLab Security Release: 16.9.2, 16.8.4, 16.7.7)
[Share on LinkedIn](https://www.linkedin.com/shareArticle?mini=true&url=https://about.gitlab.com/releases/2024/03/06/security-release-gitlab-16-9-2-released/&title=GitLab Security Release: 16.9.2, 16.8.4, 16.7.7&summary=&source=)
[Share on Hacker News](https://news.ycombinator.com/submitlink?u=https://about.gitlab.com/releases/2024/03/06/security-release-gitlab-16-9-2-released/&t=GitLab Security Release: 16.9.2, 16.8.4, 16.7.7)

* [Previous Post:
  GitLab Security Release: 16.9.1, 16.8.3, 16.7.6](/releases/2024/02/21/security-release-gitlab-16-9-1-released/ "GitLab Security Release: 16.9.1, 16.8.3, 16.7.6")
* [Next Post:
  GitLab 16.10 released with semantic versioning in the
  ...](/releases/2024/03/21/gitlab-16-10-released/ "GitLab 16.10 released with semantic versioning in the CI/CD catalog")

Sign up for GitLab's monthly newsletter

Thanks for subscribing!

### We want to hear from you

Enjoyed reading this blog post or have questions or feedback? Share your thoughts by creating a new topic in the GitLab community forum.

[Share your feedback](https://forum.gitlab.com/new-topic?title=GitLab Security Release: 16.9.2, 16.8.4, 16.7.7&body=&tags=blog-feedback)

## Take GitLab for a spin

See what your team could do with The DevSecOps Platform.

[Get free trial](https://gitlab.com/-/trials/new?glm_content=default-saas-trial&glm_source=about.gitlab.com)

![](/images/cta/gitlab-enterprise-team-member-photos.png)

Have a question? We're here to help.

[Talk to an expert](https://about.gitlab.com/sales/)

[Edit this page](https://gitlab.com/-/ide/project/gitlab-com/www-gitlab-com/edit/master/-/sites/uncategorized/source/releases/posts/2024-03-06-security-release-gitlab-16-9-2-released.html.md)
[View source](https://gitlab.com/gitlab-com/www-gitlab-com/blob/master/sites/uncategorized/source/releases/posts/2024-03-06-security-release-gitlab-16-9-2-released.html.md)


