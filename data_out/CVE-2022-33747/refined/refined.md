### CVE-2022-33747
**Root cause of vulnerability:**
- When removing pages from a guest's Physical-to-Machine (P2M) mapping, and large pages are used in 2nd-stage page tables, memory allocation might occur to replace the large mapping with smaller ones. These allocations are taken from the global memory pool.

**Weaknesses/vulnerabilities present:**
- Unbounded memory consumption: A malicious guest can trigger memory allocations in the global memory pool by manipulating its P2M mappings, leading to exhaustion of the pool.

**Impact of exploitation:**
- Denial of Service: A malicious guest could exhaust the global memory pool, preventing further allocation of Xen memory. This impacts any operation that requires memory allocation, such as creating new guests. However, the memory exhaustion itself shouldn't cause Xen or properly written guests to crash.

**Attack vectors:**
- A malicious guest manipulates its own P2M mappings.

**Required attacker capabilities/position:**
- The attacker needs to be a malicious guest running on a Xen hypervisor.
- The system must be an Arm system. X86 systems are not vulnerable.