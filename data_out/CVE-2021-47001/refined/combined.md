=== Content from git.kernel.org_50aa98c7_20250110_192417.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=8834ecb5df22b7ff3c9b0deba7726579bb613f95)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=8834ecb5df22b7ff3c9b0deba7726579bb613f95)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=8834ecb5df22b7ff3c9b0deba7726579bb613f95)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=8834ecb5df22b7ff3c9b0deba7726579bb613f95)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Chuck Lever <chuck.lever@oracle.com> | 2021-04-19 14:02:41 -0400 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2021-05-19 10:29:42 +0200 |
| commit | [8834ecb5df22b7ff3c9b0deba7726579bb613f95](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=8834ecb5df22b7ff3c9b0deba7726579bb613f95) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=8834ecb5df22b7ff3c9b0deba7726579bb613f95)) | |
| tree | [6692faa0da7c93e8d794ab352af9bb8a59197bee](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=8834ecb5df22b7ff3c9b0deba7726579bb613f95) | |
| parent | [6276265c31a70fa88a8c1317e09f2e01d4d9c339](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=6276265c31a70fa88a8c1317e09f2e01d4d9c339) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=8834ecb5df22b7ff3c9b0deba7726579bb613f95&id2=6276265c31a70fa88a8c1317e09f2e01d4d9c339)) | |
| download | [linux-8834ecb5df22b7ff3c9b0deba7726579bb613f95.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-8834ecb5df22b7ff3c9b0deba7726579bb613f95.tar.gz) | |

xprtrdma: Fix cwnd update ordering[ Upstream commit 35d8b10a25884050bb3b0149b62c3818ec59f77c ]
After a reconnect, the reply handler is opening the cwnd (and thus
enabling more RPC Calls to be sent) /before/ rpcrdma\_post\_recvs()
can post enough Receive WRs to receive their replies. This causes an
RNR and the new connection is lost immediately.
The race is most clearly exposed when KASAN and disconnect injection
are enabled. This slows down rpcrdma\_rep\_create() enough to allow
the send side to post a bunch of RPC Calls before the Receive
completion handler can invoke ib\_post\_recv().
Fixes: 2ae50ad68cd7 ("xprtrdma: Close window between waking RPC senders and posting Receives")
Signed-off-by: Chuck Lever <chuck.lever@oracle.com>
Signed-off-by: Trond Myklebust <trond.myklebust@hammerspace.com>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=8834ecb5df22b7ff3c9b0deba7726579bb613f95)

| -rw-r--r-- | [net/sunrpc/xprtrdma/rpc\_rdma.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/net/sunrpc/xprtrdma/rpc_rdma.c?id=8834ecb5df22b7ff3c9b0deba7726579bb613f95) | 3 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |
| -rw-r--r-- | [net/sunrpc/xprtrdma/verbs.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/net/sunrpc/xprtrdma/verbs.c?id=8834ecb5df22b7ff3c9b0deba7726579bb613f95) | 10 | |  |  |  | | --- | --- | --- | |
| -rw-r--r-- | [net/sunrpc/xprtrdma/xprt\_rdma.h](/pub/scm/linux/kernel/git/stable/linux.git/diff/net/sunrpc/xprtrdma/xprt_rdma.h?id=8834ecb5df22b7ff3c9b0deba7726579bb613f95) | 2 | |  |  |  | | --- | --- | --- | |

3 files changed, 8 insertions, 7 deletions

| diff --git a/net/sunrpc/xprtrdma/rpc\_rdma.c b/net/sunrpc/xprtrdma/rpc\_rdma.cindex 8f5d0cb6836099..d40ace8a973d9f 100644--- a/[net/sunrpc/xprtrdma/rpc\_rdma.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/sunrpc/xprtrdma/rpc_rdma.c?id=6276265c31a70fa88a8c1317e09f2e01d4d9c339)+++ b/[net/sunrpc/xprtrdma/rpc\_rdma.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/sunrpc/xprtrdma/rpc_rdma.c?id=8834ecb5df22b7ff3c9b0deba7726579bb613f95)@@ -1459,9 +1459,10 @@ void rpcrdma\_reply\_handler(struct rpcrdma\_rep \*rep) credits = 1; /\* don't deadlock \*/ else if (credits > r\_xprt->rx\_ep->re\_max\_requests) credits = r\_xprt->rx\_ep->re\_max\_requests;+ rpcrdma\_post\_recvs(r\_xprt, credits + (buf->rb\_bc\_srv\_max\_requests << 1),+ false); if (buf->rb\_credits != credits) rpcrdma\_update\_cwnd(r\_xprt, credits);- rpcrdma\_post\_recvs(r\_xprt, false);  req = rpcr\_to\_rdmar(rqst); if (unlikely(req->rl\_reply))diff --git a/net/sunrpc/xprtrdma/verbs.c b/net/sunrpc/xprtrdma/verbs.cindex ec912cf9c618c3..f3fffc74ab0fa2 100644--- a/[net/sunrpc/xprtrdma/verbs.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/sunrpc/xprtrdma/verbs.c?id=6276265c31a70fa88a8c1317e09f2e01d4d9c339)+++ b/[net/sunrpc/xprtrdma/verbs.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/sunrpc/xprtrdma/verbs.c?id=8834ecb5df22b7ff3c9b0deba7726579bb613f95)@@ -535,7 +535,7 @@ int rpcrdma\_xprt\_connect(struct rpcrdma\_xprt \*r\_xprt) \* outstanding Receives. \*/ rpcrdma\_ep\_get(ep);- rpcrdma\_post\_recvs(r\_xprt, true);+ rpcrdma\_post\_recvs(r\_xprt, 1, true);  rc = rdma\_connect(ep->re\_id, &ep->re\_remote\_cma); if (rc)@@ -1364,21 +1364,21 @@ int rpcrdma\_post\_sends(struct rpcrdma\_xprt \*r\_xprt, struct rpcrdma\_req \*req) /\*\* \* rpcrdma\_post\_recvs - Refill the Receive Queue \* @r\_xprt: controlling transport instance- \* @temp: mark Receive buffers to be deleted after use+ \* @needed: current credit grant+ \* @temp: mark Receive buffers to be deleted after one use \* \*/-void rpcrdma\_post\_recvs(struct rpcrdma\_xprt \*r\_xprt, bool temp)+void rpcrdma\_post\_recvs(struct rpcrdma\_xprt \*r\_xprt, int needed, bool temp) { struct rpcrdma\_buffer \*buf = &r\_xprt->rx\_buf; struct rpcrdma\_ep \*ep = r\_xprt->rx\_ep; struct ib\_recv\_wr \*wr, \*bad\_wr; struct rpcrdma\_rep \*rep;- int needed, count, rc;+ int count, rc;  rc = 0; count = 0; - needed = buf->rb\_credits + (buf->rb\_bc\_srv\_max\_requests << 1); if (likely(ep->re\_receive\_count > needed)) goto out; needed -= ep->re\_receive\_count;diff --git a/net/sunrpc/xprtrdma/xprt\_rdma.h b/net/sunrpc/xprtrdma/xprt\_rdma.hindex 94b28657aeeb82..c3bcc84c16c4cf 100644--- a/[net/sunrpc/xprtrdma/xprt\_rdma.h](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/sunrpc/xprtrdma/xprt_rdma.h?id=6276265c31a70fa88a8c1317e09f2e01d4d9c339)+++ b/[net/sunrpc/xprtrdma/xprt\_rdma.h](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/sunrpc/xprtrdma/xprt_rdma.h?id=8834ecb5df22b7ff3c9b0deba7726579bb613f95)@@ -460,7 +460,7 @@ int rpcrdma\_xprt\_connect(struct rpcrdma\_xprt \*r\_xprt); void rpcrdma\_xprt\_disconnect(struct rpcrdma\_xprt \*r\_xprt);  int rpcrdma\_post\_sends(struct rpcrdma\_xprt \*r\_xprt, struct rpcrdma\_req \*req);-void rpcrdma\_post\_recvs(struct rpcrdma\_xprt \*r\_xprt, bool temp);+void rpcrdma\_post\_recvs(struct rpcrdma\_xprt \*r\_xprt, int needed, bool temp);  /\* \* Buffer calls - xprtrdma/verbs.c |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-10 19:22:54 +0000



=== Content from git.kernel.org_d0e687ad_20250110_192415.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=35d8b10a25884050bb3b0149b62c3818ec59f77c)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=35d8b10a25884050bb3b0149b62c3818ec59f77c)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=35d8b10a25884050bb3b0149b62c3818ec59f77c)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=35d8b10a25884050bb3b0149b62c3818ec59f77c)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Chuck Lever <chuck.lever@oracle.com> | 2021-04-19 14:02:41 -0400 |
| --- | --- | --- |
| committer | Trond Myklebust <trond.myklebust@hammerspace.com> | 2021-04-26 09:24:05 -0400 |
| commit | [35d8b10a25884050bb3b0149b62c3818ec59f77c](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=35d8b10a25884050bb3b0149b62c3818ec59f77c) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=35d8b10a25884050bb3b0149b62c3818ec59f77c)) | |
| tree | [d5d3dd7bca87beb2f9a957c73d2a3bdc2696a1d1](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=35d8b10a25884050bb3b0149b62c3818ec59f77c) | |
| parent | [9e3ca33b62d4878f6ae39776abb6deebb37db597](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=9e3ca33b62d4878f6ae39776abb6deebb37db597) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=35d8b10a25884050bb3b0149b62c3818ec59f77c&id2=9e3ca33b62d4878f6ae39776abb6deebb37db597)) | |
| download | [linux-35d8b10a25884050bb3b0149b62c3818ec59f77c.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-35d8b10a25884050bb3b0149b62c3818ec59f77c.tar.gz) | |

xprtrdma: Fix cwnd update orderingAfter a reconnect, the reply handler is opening the cwnd (and thus
enabling more RPC Calls to be sent) /before/ rpcrdma\_post\_recvs()
can post enough Receive WRs to receive their replies. This causes an
RNR and the new connection is lost immediately.
The race is most clearly exposed when KASAN and disconnect injection
are enabled. This slows down rpcrdma\_rep\_create() enough to allow
the send side to post a bunch of RPC Calls before the Receive
completion handler can invoke ib\_post\_recv().
Fixes: 2ae50ad68cd7 ("xprtrdma: Close window between waking RPC senders and posting Receives")
Signed-off-by: Chuck Lever <chuck.lever@oracle.com>
Signed-off-by: Trond Myklebust <trond.myklebust@hammerspace.com>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=35d8b10a25884050bb3b0149b62c3818ec59f77c)

| -rw-r--r-- | [net/sunrpc/xprtrdma/rpc\_rdma.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/net/sunrpc/xprtrdma/rpc_rdma.c?id=35d8b10a25884050bb3b0149b62c3818ec59f77c) | 3 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |
| -rw-r--r-- | [net/sunrpc/xprtrdma/verbs.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/net/sunrpc/xprtrdma/verbs.c?id=35d8b10a25884050bb3b0149b62c3818ec59f77c) | 10 | |  |  |  | | --- | --- | --- | |
| -rw-r--r-- | [net/sunrpc/xprtrdma/xprt\_rdma.h](/pub/scm/linux/kernel/git/stable/linux.git/diff/net/sunrpc/xprtrdma/xprt_rdma.h?id=35d8b10a25884050bb3b0149b62c3818ec59f77c) | 2 | |  |  |  | | --- | --- | --- | |

3 files changed, 8 insertions, 7 deletions

| diff --git a/net/sunrpc/xprtrdma/rpc\_rdma.c b/net/sunrpc/xprtrdma/rpc\_rdma.cindex 292f066d006e5b..21ddd78a8c3512 100644--- a/[net/sunrpc/xprtrdma/rpc\_rdma.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/sunrpc/xprtrdma/rpc_rdma.c?id=9e3ca33b62d4878f6ae39776abb6deebb37db597)+++ b/[net/sunrpc/xprtrdma/rpc\_rdma.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/sunrpc/xprtrdma/rpc_rdma.c?id=35d8b10a25884050bb3b0149b62c3818ec59f77c)@@ -1430,9 +1430,10 @@ void rpcrdma\_reply\_handler(struct rpcrdma\_rep \*rep) credits = 1; /\* don't deadlock \*/ else if (credits > r\_xprt->rx\_ep->re\_max\_requests) credits = r\_xprt->rx\_ep->re\_max\_requests;+ rpcrdma\_post\_recvs(r\_xprt, credits + (buf->rb\_bc\_srv\_max\_requests << 1),+ false); if (buf->rb\_credits != credits) rpcrdma\_update\_cwnd(r\_xprt, credits);- rpcrdma\_post\_recvs(r\_xprt, false);  req = rpcr\_to\_rdmar(rqst); if (unlikely(req->rl\_reply))diff --git a/net/sunrpc/xprtrdma/verbs.c b/net/sunrpc/xprtrdma/verbs.cindex 95ce9328e5d2a2..de96fcede7d4b2 100644--- a/[net/sunrpc/xprtrdma/verbs.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/sunrpc/xprtrdma/verbs.c?id=9e3ca33b62d4878f6ae39776abb6deebb37db597)+++ b/[net/sunrpc/xprtrdma/verbs.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/sunrpc/xprtrdma/verbs.c?id=35d8b10a25884050bb3b0149b62c3818ec59f77c)@@ -544,7 +544,7 @@ int rpcrdma\_xprt\_connect(struct rpcrdma\_xprt \*r\_xprt) \* outstanding Receives. \*/ rpcrdma\_ep\_get(ep);- rpcrdma\_post\_recvs(r\_xprt, true);+ rpcrdma\_post\_recvs(r\_xprt, 1, true);  rc = rdma\_connect(ep->re\_id, &ep->re\_remote\_cma); if (rc)@@ -1395,21 +1395,21 @@ int rpcrdma\_post\_sends(struct rpcrdma\_xprt \*r\_xprt, struct rpcrdma\_req \*req) /\*\* \* rpcrdma\_post\_recvs - Refill the Receive Queue \* @r\_xprt: controlling transport instance- \* @temp: mark Receive buffers to be deleted after use+ \* @needed: current credit grant+ \* @temp: mark Receive buffers to be deleted after one use \* \*/-void rpcrdma\_post\_recvs(struct rpcrdma\_xprt \*r\_xprt, bool temp)+void rpcrdma\_post\_recvs(struct rpcrdma\_xprt \*r\_xprt, int needed, bool temp) { struct rpcrdma\_buffer \*buf = &r\_xprt->rx\_buf; struct rpcrdma\_ep \*ep = r\_xprt->rx\_ep; struct ib\_recv\_wr \*wr, \*bad\_wr; struct rpcrdma\_rep \*rep;- int needed, count, rc;+ int count, rc;  rc = 0; count = 0; - needed = buf->rb\_credits + (buf->rb\_bc\_srv\_max\_requests << 1); if (likely(ep->re\_receive\_count > needed)) goto out; needed -= ep->re\_receive\_count;diff --git a/net/sunrpc/xprtrdma/xprt\_rdma.h b/net/sunrpc/xprtrdma/xprt\_rdma.hindex 31404326f29f3c..2504f67af63edd 100644--- a/[net/sunrpc/xprtrdma/xprt\_rdma.h](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/sunrpc/xprtrdma/xprt_rdma.h?id=9e3ca33b62d4878f6ae39776abb6deebb37db597)+++ b/[net/sunrpc/xprtrdma/xprt\_rdma.h](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/sunrpc/xprtrdma/xprt_rdma.h?id=35d8b10a25884050bb3b0149b62c3818ec59f77c)@@ -462,7 +462,7 @@ int rpcrdma\_xprt\_connect(struct rpcrdma\_xprt \*r\_xprt); void rpcrdma\_xprt\_disconnect(struct rpcrdma\_xprt \*r\_xprt);  int rpcrdma\_post\_sends(struct rpcrdma\_xprt \*r\_xprt, struct rpcrdma\_req \*req);-void rpcrdma\_post\_recvs(struct rpcrdma\_xprt \*r\_xprt, bool temp);+void rpcrdma\_post\_recvs(struct rpcrdma\_xprt \*r\_xprt, int needed, bool temp);  /\* \* Buffer calls - xprtrdma/verbs.c |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-10 19:22:52 +0000



=== Content from git.kernel.org_5a7a5bac_20250110_192418.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=eddae8be7944096419c2ae29477a45f767d0fcd4)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=eddae8be7944096419c2ae29477a45f767d0fcd4)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=eddae8be7944096419c2ae29477a45f767d0fcd4)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=eddae8be7944096419c2ae29477a45f767d0fcd4)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Chuck Lever <chuck.lever@oracle.com> | 2021-04-19 14:02:41 -0400 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2021-05-19 10:13:04 +0200 |
| commit | [eddae8be7944096419c2ae29477a45f767d0fcd4](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=eddae8be7944096419c2ae29477a45f767d0fcd4) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=eddae8be7944096419c2ae29477a45f767d0fcd4)) | |
| tree | [e72b55a4e0ba457776d70c3cad7b7d98ec4dcaf2](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=eddae8be7944096419c2ae29477a45f767d0fcd4) | |
| parent | [89a31bf85c7b99e8f501f5b8559577983017e27e](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=89a31bf85c7b99e8f501f5b8559577983017e27e) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=eddae8be7944096419c2ae29477a45f767d0fcd4&id2=89a31bf85c7b99e8f501f5b8559577983017e27e)) | |
| download | [linux-eddae8be7944096419c2ae29477a45f767d0fcd4.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-eddae8be7944096419c2ae29477a45f767d0fcd4.tar.gz) | |

xprtrdma: Fix cwnd update ordering[ Upstream commit 35d8b10a25884050bb3b0149b62c3818ec59f77c ]
After a reconnect, the reply handler is opening the cwnd (and thus
enabling more RPC Calls to be sent) /before/ rpcrdma\_post\_recvs()
can post enough Receive WRs to receive their replies. This causes an
RNR and the new connection is lost immediately.
The race is most clearly exposed when KASAN and disconnect injection
are enabled. This slows down rpcrdma\_rep\_create() enough to allow
the send side to post a bunch of RPC Calls before the Receive
completion handler can invoke ib\_post\_recv().
Fixes: 2ae50ad68cd7 ("xprtrdma: Close window between waking RPC senders and posting Receives")
Signed-off-by: Chuck Lever <chuck.lever@oracle.com>
Signed-off-by: Trond Myklebust <trond.myklebust@hammerspace.com>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=eddae8be7944096419c2ae29477a45f767d0fcd4)

| -rw-r--r-- | [net/sunrpc/xprtrdma/rpc\_rdma.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/net/sunrpc/xprtrdma/rpc_rdma.c?id=eddae8be7944096419c2ae29477a45f767d0fcd4) | 3 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |
| -rw-r--r-- | [net/sunrpc/xprtrdma/verbs.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/net/sunrpc/xprtrdma/verbs.c?id=eddae8be7944096419c2ae29477a45f767d0fcd4) | 10 | |  |  |  | | --- | --- | --- | |
| -rw-r--r-- | [net/sunrpc/xprtrdma/xprt\_rdma.h](/pub/scm/linux/kernel/git/stable/linux.git/diff/net/sunrpc/xprtrdma/xprt_rdma.h?id=eddae8be7944096419c2ae29477a45f767d0fcd4) | 2 | |  |  |  | | --- | --- | --- | |

3 files changed, 8 insertions, 7 deletions

| diff --git a/net/sunrpc/xprtrdma/rpc\_rdma.c b/net/sunrpc/xprtrdma/rpc\_rdma.cindex c48536f2121fb2..ca267a855a12c2 100644--- a/[net/sunrpc/xprtrdma/rpc\_rdma.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/sunrpc/xprtrdma/rpc_rdma.c?id=89a31bf85c7b99e8f501f5b8559577983017e27e)+++ b/[net/sunrpc/xprtrdma/rpc\_rdma.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/sunrpc/xprtrdma/rpc_rdma.c?id=eddae8be7944096419c2ae29477a45f767d0fcd4)@@ -1467,9 +1467,10 @@ void rpcrdma\_reply\_handler(struct rpcrdma\_rep \*rep) credits = 1; /\* don't deadlock \*/ else if (credits > r\_xprt->rx\_ep->re\_max\_requests) credits = r\_xprt->rx\_ep->re\_max\_requests;+ rpcrdma\_post\_recvs(r\_xprt, credits + (buf->rb\_bc\_srv\_max\_requests << 1),+ false); if (buf->rb\_credits != credits) rpcrdma\_update\_cwnd(r\_xprt, credits);- rpcrdma\_post\_recvs(r\_xprt, false);  req = rpcr\_to\_rdmar(rqst); if (req->rl\_reply) {diff --git a/net/sunrpc/xprtrdma/verbs.c b/net/sunrpc/xprtrdma/verbs.cindex ad6e2e4994ce8e..04325f0267c1c8 100644--- a/[net/sunrpc/xprtrdma/verbs.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/sunrpc/xprtrdma/verbs.c?id=89a31bf85c7b99e8f501f5b8559577983017e27e)+++ b/[net/sunrpc/xprtrdma/verbs.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/sunrpc/xprtrdma/verbs.c?id=eddae8be7944096419c2ae29477a45f767d0fcd4)@@ -535,7 +535,7 @@ int rpcrdma\_xprt\_connect(struct rpcrdma\_xprt \*r\_xprt) \* outstanding Receives. \*/ rpcrdma\_ep\_get(ep);- rpcrdma\_post\_recvs(r\_xprt, true);+ rpcrdma\_post\_recvs(r\_xprt, 1, true);  rc = rdma\_connect(ep->re\_id, &ep->re\_remote\_cma); if (rc)@@ -1377,21 +1377,21 @@ int rpcrdma\_post\_sends(struct rpcrdma\_xprt \*r\_xprt, struct rpcrdma\_req \*req) /\*\* \* rpcrdma\_post\_recvs - Refill the Receive Queue \* @r\_xprt: controlling transport instance- \* @temp: mark Receive buffers to be deleted after use+ \* @needed: current credit grant+ \* @temp: mark Receive buffers to be deleted after one use \* \*/-void rpcrdma\_post\_recvs(struct rpcrdma\_xprt \*r\_xprt, bool temp)+void rpcrdma\_post\_recvs(struct rpcrdma\_xprt \*r\_xprt, int needed, bool temp) { struct rpcrdma\_buffer \*buf = &r\_xprt->rx\_buf; struct rpcrdma\_ep \*ep = r\_xprt->rx\_ep; struct ib\_recv\_wr \*wr, \*bad\_wr; struct rpcrdma\_rep \*rep;- int needed, count, rc;+ int count, rc;  rc = 0; count = 0; - needed = buf->rb\_credits + (buf->rb\_bc\_srv\_max\_requests << 1); if (likely(ep->re\_receive\_count > needed)) goto out; needed -= ep->re\_receive\_count;diff --git a/net/sunrpc/xprtrdma/xprt\_rdma.h b/net/sunrpc/xprtrdma/xprt\_rdma.hindex 43974ef39a5055..3cacc6f4c5271f 100644--- a/[net/sunrpc/xprtrdma/xprt\_rdma.h](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/sunrpc/xprtrdma/xprt_rdma.h?id=89a31bf85c7b99e8f501f5b8559577983017e27e)+++ b/[net/sunrpc/xprtrdma/xprt\_rdma.h](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/sunrpc/xprtrdma/xprt_rdma.h?id=eddae8be7944096419c2ae29477a45f767d0fcd4)@@ -452,7 +452,7 @@ int rpcrdma\_xprt\_connect(struct rpcrdma\_xprt \*r\_xprt); void rpcrdma\_xprt\_disconnect(struct rpcrdma\_xprt \*r\_xprt);  int rpcrdma\_post\_sends(struct rpcrdma\_xprt \*r\_xprt, struct rpcrdma\_req \*req);-void rpcrdma\_post\_recvs(struct rpcrdma\_xprt \*r\_xprt, bool temp);+void rpcrdma\_post\_recvs(struct rpcrdma\_xprt \*r\_xprt, int needed, bool temp);  /\* \* Buffer calls - xprtrdma/verbs.c |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-10 19:22:55 +0000



=== Content from git.kernel.org_6e591be9_20250110_192414.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=19b5fa9489b5706bc878c3a522a7f771079e2fa0)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=19b5fa9489b5706bc878c3a522a7f771079e2fa0)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=19b5fa9489b5706bc878c3a522a7f771079e2fa0)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=19b5fa9489b5706bc878c3a522a7f771079e2fa0)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Chuck Lever <chuck.lever@oracle.com> | 2021-04-19 14:02:41 -0400 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2021-05-19 10:56:26 +0200 |
| commit | [19b5fa9489b5706bc878c3a522a7f771079e2fa0](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=19b5fa9489b5706bc878c3a522a7f771079e2fa0) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=19b5fa9489b5706bc878c3a522a7f771079e2fa0)) | |
| tree | [46159d63104f66247c251733543dafecc374ab9b](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=19b5fa9489b5706bc878c3a522a7f771079e2fa0) | |
| parent | [9ec43636c735623ab18f346c2e04954711d76e65](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=9ec43636c735623ab18f346c2e04954711d76e65) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=19b5fa9489b5706bc878c3a522a7f771079e2fa0&id2=9ec43636c735623ab18f346c2e04954711d76e65)) | |
| download | [linux-19b5fa9489b5706bc878c3a522a7f771079e2fa0.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-19b5fa9489b5706bc878c3a522a7f771079e2fa0.tar.gz) | |

xprtrdma: Fix cwnd update ordering[ Upstream commit 35d8b10a25884050bb3b0149b62c3818ec59f77c ]
After a reconnect, the reply handler is opening the cwnd (and thus
enabling more RPC Calls to be sent) /before/ rpcrdma\_post\_recvs()
can post enough Receive WRs to receive their replies. This causes an
RNR and the new connection is lost immediately.
The race is most clearly exposed when KASAN and disconnect injection
are enabled. This slows down rpcrdma\_rep\_create() enough to allow
the send side to post a bunch of RPC Calls before the Receive
completion handler can invoke ib\_post\_recv().
Fixes: 2ae50ad68cd7 ("xprtrdma: Close window between waking RPC senders and posting Receives")
Signed-off-by: Chuck Lever <chuck.lever@oracle.com>
Signed-off-by: Trond Myklebust <trond.myklebust@hammerspace.com>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=19b5fa9489b5706bc878c3a522a7f771079e2fa0)

| -rw-r--r-- | [net/sunrpc/xprtrdma/rpc\_rdma.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/net/sunrpc/xprtrdma/rpc_rdma.c?id=19b5fa9489b5706bc878c3a522a7f771079e2fa0) | 3 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |
| -rw-r--r-- | [net/sunrpc/xprtrdma/verbs.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/net/sunrpc/xprtrdma/verbs.c?id=19b5fa9489b5706bc878c3a522a7f771079e2fa0) | 10 | |  |  |  | | --- | --- | --- | |
| -rw-r--r-- | [net/sunrpc/xprtrdma/xprt\_rdma.h](/pub/scm/linux/kernel/git/stable/linux.git/diff/net/sunrpc/xprtrdma/xprt_rdma.h?id=19b5fa9489b5706bc878c3a522a7f771079e2fa0) | 2 | |  |  |  | | --- | --- | --- | |

3 files changed, 8 insertions, 7 deletions

| diff --git a/net/sunrpc/xprtrdma/rpc\_rdma.c b/net/sunrpc/xprtrdma/rpc\_rdma.cindex 292f066d006e5b..21ddd78a8c3512 100644--- a/[net/sunrpc/xprtrdma/rpc\_rdma.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/sunrpc/xprtrdma/rpc_rdma.c?id=9ec43636c735623ab18f346c2e04954711d76e65)+++ b/[net/sunrpc/xprtrdma/rpc\_rdma.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/sunrpc/xprtrdma/rpc_rdma.c?id=19b5fa9489b5706bc878c3a522a7f771079e2fa0)@@ -1430,9 +1430,10 @@ void rpcrdma\_reply\_handler(struct rpcrdma\_rep \*rep) credits = 1; /\* don't deadlock \*/ else if (credits > r\_xprt->rx\_ep->re\_max\_requests) credits = r\_xprt->rx\_ep->re\_max\_requests;+ rpcrdma\_post\_recvs(r\_xprt, credits + (buf->rb\_bc\_srv\_max\_requests << 1),+ false); if (buf->rb\_credits != credits) rpcrdma\_update\_cwnd(r\_xprt, credits);- rpcrdma\_post\_recvs(r\_xprt, false);  req = rpcr\_to\_rdmar(rqst); if (unlikely(req->rl\_reply))diff --git a/net/sunrpc/xprtrdma/verbs.c b/net/sunrpc/xprtrdma/verbs.cindex ec912cf9c618c3..f3fffc74ab0fa2 100644--- a/[net/sunrpc/xprtrdma/verbs.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/sunrpc/xprtrdma/verbs.c?id=9ec43636c735623ab18f346c2e04954711d76e65)+++ b/[net/sunrpc/xprtrdma/verbs.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/sunrpc/xprtrdma/verbs.c?id=19b5fa9489b5706bc878c3a522a7f771079e2fa0)@@ -535,7 +535,7 @@ int rpcrdma\_xprt\_connect(struct rpcrdma\_xprt \*r\_xprt) \* outstanding Receives. \*/ rpcrdma\_ep\_get(ep);- rpcrdma\_post\_recvs(r\_xprt, true);+ rpcrdma\_post\_recvs(r\_xprt, 1, true);  rc = rdma\_connect(ep->re\_id, &ep->re\_remote\_cma); if (rc)@@ -1364,21 +1364,21 @@ int rpcrdma\_post\_sends(struct rpcrdma\_xprt \*r\_xprt, struct rpcrdma\_req \*req) /\*\* \* rpcrdma\_post\_recvs - Refill the Receive Queue \* @r\_xprt: controlling transport instance- \* @temp: mark Receive buffers to be deleted after use+ \* @needed: current credit grant+ \* @temp: mark Receive buffers to be deleted after one use \* \*/-void rpcrdma\_post\_recvs(struct rpcrdma\_xprt \*r\_xprt, bool temp)+void rpcrdma\_post\_recvs(struct rpcrdma\_xprt \*r\_xprt, int needed, bool temp) { struct rpcrdma\_buffer \*buf = &r\_xprt->rx\_buf; struct rpcrdma\_ep \*ep = r\_xprt->rx\_ep; struct ib\_recv\_wr \*wr, \*bad\_wr; struct rpcrdma\_rep \*rep;- int needed, count, rc;+ int count, rc;  rc = 0; count = 0; - needed = buf->rb\_credits + (buf->rb\_bc\_srv\_max\_requests << 1); if (likely(ep->re\_receive\_count > needed)) goto out; needed -= ep->re\_receive\_count;diff --git a/net/sunrpc/xprtrdma/xprt\_rdma.h b/net/sunrpc/xprtrdma/xprt\_rdma.hindex fe3be985e239a5..28af11fbe64389 100644--- a/[net/sunrpc/xprtrdma/xprt\_rdma.h](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/sunrpc/xprtrdma/xprt_rdma.h?id=9ec43636c735623ab18f346c2e04954711d76e65)+++ b/[net/sunrpc/xprtrdma/xprt\_rdma.h](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/sunrpc/xprtrdma/xprt_rdma.h?id=19b5fa9489b5706bc878c3a522a7f771079e2fa0)@@ -461,7 +461,7 @@ int rpcrdma\_xprt\_connect(struct rpcrdma\_xprt \*r\_xprt); void rpcrdma\_xprt\_disconnect(struct rpcrdma\_xprt \*r\_xprt);  int rpcrdma\_post\_sends(struct rpcrdma\_xprt \*r\_xprt, struct rpcrdma\_req \*req);-void rpcrdma\_post\_recvs(struct rpcrdma\_xprt \*r\_xprt, bool temp);+void rpcrdma\_post\_recvs(struct rpcrdma\_xprt \*r\_xprt, int needed, bool temp);  /\* \* Buffer calls - xprtrdma/verbs.c |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-10 19:22:51 +0000


