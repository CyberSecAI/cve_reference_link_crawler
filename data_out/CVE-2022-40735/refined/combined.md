=== Content from github.com_c6ce779d_20250108_162307.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fadvisories%2FGHSA-8vmc-7qrc-q5mx)

**CVE-2022-40735**

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fadvisories%2FGHSA-8vmc-7qrc-q5mx)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2Fadvisories%2F%3Cid%3E&source=header)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

1. [GitHub Advisory Database](/advisories)
2. [Unreviewed](/advisories?query=type%3Aunreviewed)
3. [CVE-2022-40735](/advisories/GHSA-8vmc-7qrc-q5mx)

## Using long exponents in the Diffie-Hellman Key Agreement...

High severity

Unreviewed

Published
Nov 15, 2022
to the GitHub Advisory Database
•
Updated May 3, 2024

## Package

No package listed—
[Suggest a package](/advisories/GHSA-8vmc-7qrc-q5mx/improve)

## Affected versions

Unknown

## Patched versions

Unknown

## Description

Using long exponents in the Diffie-Hellman Key Agreement Protocol allows remote attackers (from the client side) to trigger unnecessarily expensive server-side DHE modular-exponentiation calculations. An attacker may cause asymmetric resource consumption with any common client application which uses a DHE implementation that applies short exponents. The attack may be more disruptive in cases where a client sends arbitrary numbers that are actually not DH public keys (aka the D(HE)ater attack) or can require a server to select its largest supported key size. The basic attack scenario is that the client must claim that it can only communicate with DHE, and the server must be configured to allow DHE. This can affect TLS, SSH, and IKE.

### References

* <https://nvd.nist.gov/vuln/detail/CVE-2022-40735>
* [mozilla/ssl-config-generator#162](https://github.com/mozilla/ssl-config-generator/issues/162)
* <https://gist.github.com/c0r0n3r/9455ddcab985c50fd1912eabf26e058b>
* <https://link.springer.com/content/pdf/10.1007/3-540-68339-9_29.pdf>
* <https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-57pt1r5.pdf>
* <https://www.researchgate.net/profile/Anton-Stiglic-2/publication/2401745_Security_Issues_in_the_Diffie-Hellman_Key_Agreement_Protocol/links/546c144f0cf20dedafd53e7e/Security-Issues-in-the-Diffie-Hellman-Key-Agreement-Protocol.pdf>
* <https://raw.githubusercontent.com/CVEProject/cvelist/9d7fbbcabd3f44cfedc9e8807757d31ece85a2c6/2022/40xxx/CVE-2022-40735.json>
* <https://www.rfc-editor.org/rfc/rfc3526>
* <https://www.rfc-editor.org/rfc/rfc4419>
* <https://www.rfc-editor.org/rfc/rfc5114#section-4>
* <https://www.rfc-editor.org/rfc/rfc7919#section-5.2>
* <https://dheatattack.gitlab.io>
* <https://ieeexplore.ieee.org/document/10374117>

Published by the [National Vulnerability Database](https://nvd.nist.gov/vuln/detail/CVE-2022-40735)
Nov 14, 2022

Published to the GitHub Advisory Database
Nov 15, 2022

Last updated
May 3, 2024

### Severity

High

7.5

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Network

Attack complexity
Low

Privileges required
None

User interaction
None

Scope
Unchanged

Confidentiality
None

Integrity
None

Availability
High

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H

### [EPSS score](https://www.first.org/epss/user-guide)

0.819%
 (82nd percentile)

### Weaknesses

[CWE-400](/advisories?query=cwe%3A400)

### CVE ID

CVE-2022-40735

### GHSA ID

GHSA-8vmc-7qrc-q5mx

### Source code

No known source code

Dependabot alerts are not supported on this advisory because it does not have a package from a supported ecosystem with an affected and fixed version.

[Learn more about GitHub language support](https://docs.github.com/get-started/learning-about-github/github-language-support#about-supported-languages)

 Loading

Checking history

See something to contribute?
[Suggest improvements for this vulnerability](/advisories/GHSA-8vmc-7qrc-q5mx/improve).

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from dheatattack.gitlab.io_05a91ac5_20250108_141350.html ===

[D(HE)at Attack](/)

* [Summary](/summary/ "Summary page")
* [FAQ](/faq/ "FAQ page")
* [Mitigations](/mitigations/ "Mitigations page")
* [PoC Code](/dheater/ "PoC Code page")
* [Details](/details/ "Details page")
* [References](/references/ "References page")

# D(HE)at Attack

## (Project Page)

D(HE)at is a [denial-of-service](https://en.wikipedia.org/wiki/Denial-of-service_attack) (DoS) attack on the finite
field Diffie-Hellman (DH) key exchange protocol allowing remote users without any privileges triggering expensive
server-side DH modular-exponentiation calculations without any significant resource (CPU) requirement on the attacker’s
side.

[CVE-2002-20001](https://nvd.nist.gov/vuln/detail/CVE-2002-20001) was assigned to the attack and a
[full technical paper](https://ieeexplore.ieee.org/document/10374117) published at IEEE Access, while there are
additional implementation issues ([CVE-2022-40735](https://nvd.nist.gov/vuln/detail/CVE-2022-40735),
[CVE-2024-41996](https://nvd.nist.gov/vuln/detail/CVE-2024-41996)) that strongly influences the affect of an attack.

[Cryptolyzer](https://gitlab.com/coroner/cryptolyzer), [ssh-audit](https://github.com/jtesta/ssh-audit) (open source),
and [Scanigma](https://scanigma.com/) (SaaS) can be used to check whether your service is affected by D(HE)at attack.

# Recent References

# [ALAS-2024-727](/references/2024-10-10-amazon-linux-security-advisory/)

Issue Overview: Validating the order of the public keys in the Diffie-Hellman Key Agreement Protocol, when an approved safe prime is used, allows remote attackers (from the client side) to trigger unnecessarily expensive server-side DHE modular-exponentiation calculations. The client may cause asymmetric resource consumption. The basic attack scenario is that the client must claim that it can only communicate with DHE, and the server must be configured to allow DHE and validate the order of the public key. (CVE-2024-41996)

[read more](/references/2024-10-10-amazon-linux-security-advisory/)

# [IT-Sicherheit: UNIX und Windows bedroht - Update für IT-Sicherheitshinweis zu Diffie-Hellman Implementierungen (Risiko: mittel)](/references/2024-10-02-new-de/)

Wie das BSI aktuell meldet, hat die IT-Sicherheitswarnung bezüglich einer bekannten Schwachstelle für Diffie-Hellman Implementierungen ein Update erhalten. Wie sich betroffene Nutzer verhalten sollten, erfahren Sie hier.

[read more](/references/2024-10-02-new-de/)

# [Security update for openssl-3](/references/2024-10-01-suse-update-advisories/)

CVE-2024-41996: Validating the order of the public keys in the Diffie-Hellman Key Agreement Protocol, when an approved safe prime is used, allows remote attackers to trigger expensive server-side DHE (bsc#1230698)

[read more](/references/2024-10-01-suse-update-advisories/)

# More

## [How Diffie-Hellman Key Exchange can Cause Availability Issues](/references/2024-09-09-pfeiffer-szilard/)

## [Release 1.30.0-gke.1930](/references/2024-08-29-google-cloud-release-notes/)

## [CVE-2024-41996](/references/2024-08-26-redhat-cve-2024-41996/)

## [CVE-2024-41996](/references/2024-08-26-suse-cve-2024-41996/)

[All References](/references/)

[© Szilárd Pfeiffer, 2024](https://dheatattack.gitlab.io/)



=== Content from github.com_af3502a9_20250108_141353.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmozilla%2Fssl-config-generator%2Fissues%2F162)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmozilla%2Fssl-config-generator%2Fissues%2F162)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=mozilla%2Fssl-config-generator)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[mozilla](/mozilla)
/
**[ssl-config-generator](/mozilla/ssl-config-generator)**
Public

* [Notifications](/login?return_to=%2Fmozilla%2Fssl-config-generator) You must be signed in to change notification settings
* [Fork
  60](/login?return_to=%2Fmozilla%2Fssl-config-generator)
* [Star
   383](/login?return_to=%2Fmozilla%2Fssl-config-generator)

* [Code](/mozilla/ssl-config-generator)
* [Issues
  15](/mozilla/ssl-config-generator/issues)
* [Pull requests
  3](/mozilla/ssl-config-generator/pulls)
* [Discussions](/mozilla/ssl-config-generator/discussions)
* [Actions](/mozilla/ssl-config-generator/actions)
* [Security](/mozilla/ssl-config-generator/security)
* [Insights](/mozilla/ssl-config-generator/pulse)

Additional navigation options

* [Code](/mozilla/ssl-config-generator)
* [Issues](/mozilla/ssl-config-generator/issues)
* [Pull requests](/mozilla/ssl-config-generator/pulls)
* [Discussions](/mozilla/ssl-config-generator/discussions)
* [Actions](/mozilla/ssl-config-generator/actions)
* [Security](/mozilla/ssl-config-generator/security)
* [Insights](/mozilla/ssl-config-generator/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fmozilla%2Fssl-config-generator%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fmozilla%2Fssl-config-generator%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Stop recommending DHE, because of "dheater" vulnerability #162

Open

[patrakov](/patrakov) opened this issue
Oct 23, 2021
· 42 comments

Open

# [Stop recommending DHE, because of "dheater" vulnerability](#top) #162

[patrakov](/patrakov) opened this issue
Oct 23, 2021
· 42 comments

Assignees
[![@gene1wood](https://avatars.githubusercontent.com/u/1134034?s=40&v=4)](/gene1wood)

Labels
[blocked](/mozilla/ssl-config-generator/labels/blocked)
Something has to happen first elsewhere
[specs](/mozilla/ssl-config-generator/labels/specs)
This involves changes in recommendations

## Comments

[![@patrakov](https://avatars.githubusercontent.com/u/2943163?s=80&u=0e7708067b58060fd2d0e28cbb31e978fb260257&v=4)](/patrakov)

Copy link

### **[patrakov](/patrakov)** commented [Oct 23, 2021](#issue-1034276936)

| [These guys](https://github.com/Balasys/dheater) found a way to saturate the server CPU core to 100% using as little as 5 KB/s of incoming traffic. The pre-requisite is that the server supports DHE as the key exchange. Therefore, to avoid creating such a vulnerable configuration, I propose removing DHE from all levels of SSL config. |
| --- |
| The text was updated successfully, but these errors were encountered: |

 👍
4
 kovacs-andras, HLFH, Haxel0rd, and libvoid reacted with thumbs up emoji

All reactions

* 👍
  4 reactions

[![@tomato42](https://avatars.githubusercontent.com/u/618246?s=80&v=4)](/tomato42)

Copy link

Member

### **[tomato42](/tomato42)** commented [Oct 24, 2021](#issuecomment-950379283)

| 1. It's a well known property of DHE that it's more computationally intensive than RSA and ECDHE key exchanges. 2. [Not every named vulnerability is important or requires an action](https://github.com/hannob/vulns) |
| --- |

 👍
2
 polarathene and HLFH reacted with thumbs up emoji

All reactions

* 👍
  2 reactions

Sorry, something went wrong.

[![@Gunni](https://avatars.githubusercontent.com/u/358099?s=80&u=24d694f515b28f4da31663a0a960b9e028d84536&v=4)](/Gunni)

Copy link

### **[Gunni](/Gunni)** commented [Nov 23, 2021](#issuecomment-977025373)

| [CVE-2002-20001](https://github.com/advisories/GHSA-jx4r-qc68-xjr5 "CVE-2002-20001") has been assigned for DHE. |
| --- |

 👍
1
 Haxel0rd reacted with thumbs up emoji

All reactions

* 👍
  1 reaction

Sorry, something went wrong.

[![@ghen2](https://avatars.githubusercontent.com/u/23522924?s=80&v=4)](/ghen2)

Copy link

### **[ghen2](/ghen2)** commented [Nov 24, 2021](#issuecomment-978152814)

| It's a well known property of DHE that it's more computationally intensive than RSA and ECDHE key exchanges.  This is not about the (well known) performance difference under normal usage. This novel technique lets an SSL client trivially occupy 100% CPU on the SSL server by sending rogue data, ie. without requiring a corresponding computational effort from the client. This is an easy DoS attack, which can be mitigated by disabling DHE, or by rate limiting new connections per client (which not all SSL servers can do). |
| --- |

 👍
1
 Haxel0rd reacted with thumbs up emoji

All reactions

* 👍
  1 reaction

Sorry, something went wrong.

[![@tomato42](https://avatars.githubusercontent.com/u/618246?s=80&v=4)](/tomato42)

Copy link

Member

### **[tomato42](/tomato42)** commented [Nov 26, 2021](#issuecomment-979667111)

| It's a well known property of DHE that it's more computationally intensive than RSA and ECDHE key exchanges.  This is not about the (well known) performance difference under normal usage. This novel technique lets an SSL client trivially occupy 100% CPU on the SSL server by sending rogue data, ie. without requiring a corresponding computational effort from the client. This is an easy DoS attack, which can be mitigated by disabling DHE, or by rate limiting new connections per client (which not all SSL servers can do).  That's the case for *all* DH requests from the client, be it FFDHE or ECDHE, no ClientHello (not even in TLS 1.3) includes proof of work or proof of freshness of the key share, at the same time the server has to generate a fresh key share and calculate the shared keys (the processes that use up the CPU time).  Even on a very fast CPU, you can't expect more than ~2k ECDH key exchanges per second per core with a P-384 curve. With the massive 379 byte large TLS 1.3 Client Hello from OpenSSL 1.1.1 that translates to something like 1MiB/s of traffic (after including connection establishment) to fully saturate a core. That's residential broadband levels of upload.  Does that qualify as a DoS too? At what point we can't add support for a stronger, but slower algorithm because that would make the server *vulnerable*? |
| --- |

All reactions

Sorry, something went wrong.

[![@patrakov](https://avatars.githubusercontent.com/u/2943163?s=80&u=0e7708067b58060fd2d0e28cbb31e978fb260257&v=4)](/patrakov)

Copy link

Author

### **[patrakov](/patrakov)** commented [Nov 26, 2021](#issuecomment-979684077)

| There is a huge difference between 5 KiB/s (that's what dheater generates) and 1 MiB/s mentioned in the previous comment. |
| --- |

All reactions

Sorry, something went wrong.

[![@tomato42](https://avatars.githubusercontent.com/u/618246?s=80&v=4)](/tomato42)

Copy link

Member

### **[tomato42](/tomato42)** commented [Nov 26, 2021](#issuecomment-979930711)

| Read my answer again:   1. 1 MiB/s is unoptimised, those are not minimal ClientHello's 2. those are values for different CPUs, I got an example from a top of the line desktop CPU, on a virtualized host on a hosting provider you can easily get performance few times worse, maybe even 10 times worse   So I wouldn't be surprised if to perform the same kind of attack against the same machine as they did but with ECDH you wouldn't need more than 30KiB/s of traffic, and I'm quite sure it wouldn't be more than 100KiB/s  So again, at what point is a cryptographic algorithm a vulnerability? |
| --- |

 👎
2
 Haxel0rd and domdom82 reacted with thumbs down emoji

All reactions

* 👎
  2 reactions

Sorry, something went wrong.

[![@watchingdogs](https://avatars.githubusercontent.com/u/69792238?s=80&v=4)](/watchingdogs)

Copy link

### **[watchingdogs](/watchingdogs)** commented [Nov 30, 2021](#issuecomment-982312031)

| There is a huge difference between 5 KiB/s (that's what dheater generates) and 1 MiB/s mentioned in the previous comment.  Don't trust what the tool says for bandwidth, make you own measurement because it can be inaccurate.  So again, at what point is a cryptographic algorithm a vulnerability?  Solving this issue isn't done removing support for DHE, but rather making people aware of it and they'll be able to act up on their knowledge, by maybe setting up a firewall. At least a notice for this vulnerability would be beneficial. |
| --- |

 👍
3
 tomato42, polarathene, and codesport reacted with thumbs up emoji

All reactions

* 👍
  3 reactions

Sorry, something went wrong.

[![@mattcaswell](https://avatars.githubusercontent.com/u/7422273?s=40&v=4)](/mattcaswell)
[mattcaswell](/mattcaswell)
mentioned this issue
[Dec 30, 2021](#ref-issue-1090836006)

[Stop recommending DHE, because of "dheater" vulnerability :CVE-2002-20001
openssl/openssl#17374](/openssl/openssl/issues/17374)

Closed

[![@c0r0n3r](https://avatars.githubusercontent.com/u/979146?s=80&u=25775c6a5e163f1e04839800b028809faaf86ffa&v=4)](/c0r0n3r)

Copy link

### **[c0r0n3r](/c0r0n3r)** commented [Sep 2, 2022](#issuecomment-1235600040)

| IMHO it would be an appropriate compromise to add an option to the generated configurations to control the used named groups whenever possible. It would be necessary because, in the case of TLS 1.3 (and TLS 1.2 with [RFC 7919](https://www.rfc-editor.org/rfc/rfc7919.html) support), the clients are allowed to negotiate FFDHE parameters with any key sizes which enabled in the server's configuration. It means that an attacker can exploit that mechanism to force to use the largest allowed key size to overload the server, as the proof-of-concept code ([DHEater](https://github.com/Balasys/dheater)) of [CVE-2002-20001](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2002-20001) demonstrate. The default value of named groups may contain the large FFDHE groups (e.g., [OpenSSL 3.0](https://github.com/openssl/openssl/pull/18480#issuecomment-1168638009), [GnuTLS](https://www.gnutls.org/manual/gnutls.html#DOCF20)), meaning that the server is highly vulnerable to the DHEat attack using the default. Setting the named groups to contain only the smaller FFDHE groups would solve the problem without security concerns. |
| --- |

 👍
3
 domdom82, janbrasna, and polarathene reacted with thumbs up emoji

All reactions

* 👍
  3 reactions

Sorry, something went wrong.

[![@domdom82](https://avatars.githubusercontent.com/u/1755853?s=80&u=ca7f80050b15e0f935922cf6e6653032d878d4ae&v=4)](/domdom82)

Copy link

### **[domdom82](/domdom82)** commented [May 3, 2024](#issuecomment-2092738736)

| I agree with [@c0r0n3r](https://github.com/c0r0n3r) making the named groups configurable is a fair option. I was working on hardening my HAProxy config and quite frankly, the current recommendation by the mozilla ssl generator makes TLS 1.3 **more** vulnerable than TLS 1.2 to this attack. The dh-param option allows me to limit the key size to 2048 bit but it only works for TLS 1.2. For TLS 1.3, I needed to add the "ssl-default-bind-curves x25519:secp256r1" option, because OpenSSL 3.x re-introduced DHE again. So, it would have helped me save a lot of time if the ssl-generator at least had the option to configure named groups / curves. |
| --- |

 👍
2
 c0r0n3r and maxmoehl reacted with thumbs up emoji
 👀
1
 janbrasna reacted with eyes emoji

All reactions

* 👍
  2 reactions
* 👀
  1 reaction

Sorry, something went wrong.

[![@c0r0n3r](https://avatars.githubusercontent.com/u/979146?s=80&u=25775c6a5e163f1e04839800b028809faaf86ffa&v=4)](/c0r0n3r)

Copy link

### **[c0r0n3r](/c0r0n3r)** commented [May 3, 2024](#issuecomment-2092796235)

| The related technical paper ([D(HE)at: A Practical Denial-of-Service Attack on the Finite Field Diffie–Hellman Key Exchange](https://ieeexplore.ieee.org/document/10374117)) may help your decision. |
| --- |

 👍
1
 libvoid reacted with thumbs up emoji
 ❤️
2
 janbrasna and polarathene reacted with heart emoji

All reactions

* 👍
  1 reaction
* ❤️
  2 reactions

Sorry, something went wrong.

[![@ghen2](https://avatars.githubusercontent.com/u/23522924?s=40&v=4)](/ghen2)
[ghen2](/ghen2)
mentioned this issue
[Jun 18, 2024](#ref-issue-548472004)

[DHE ciphers should be disabled in Intermediate compatibility configuration
mozilla/server-side-tls#268](/mozilla/server-side-tls/issues/268)

Open

[![@janbrasna](https://avatars.githubusercontent.com/u/1784648?s=40&v=4)](/janbrasna)
[janbrasna](/janbrasna)
added
the
[specs](/mozilla/ssl-config-generator/labels/specs)
This involves changes in recommendations
label
[Oct 5, 2024](#event-14528335286)

[![@gstrauss](https://avatars.githubusercontent.com/u/839103?s=40&v=4)](/gstrauss)
[gstrauss](/gstrauss)
mentioned this issue
[Oct 13, 2024](#ref-pullrequest-2582550656)

[Enable OpenSSL 3.x as the default in UI
#263](/mozilla/ssl-config-generator/pull/263)
 Closed

[![@tomato42](https://avatars.githubusercontent.com/u/618246?s=40&v=4)](/tomato42)
[tomato42](/tomato42)
mentioned this issue
[Oct 27, 2024](#ref-issue-2616554298)

[DHE-RSA-CHACHA20-POLY1305 should NOT be used anymore
#269](/mozilla/ssl-config-generator/issues/269)

Closed

[![@gstrauss](https://avatars.githubusercontent.com/u/839103?s=80&v=4)](/gstrauss)

Copy link

Collaborator

### **[gstrauss](/gstrauss)** commented [Oct 28, 2024](#issuecomment-2440896274)

| TLS\_DHE\_RSA\_WITH\_CHACHA20\_POLY1305\_SHA256 is one of the ciphers recommended by RFC 7905 (published June 2016), and was added to the ssl-config-generator Intermediate configuration in 2023 after discussion in [mozilla/server-side-tls#285](https://github.com/mozilla/server-side-tls/issues/285)  I personally agree that DHE ciphers (non-ECDHE) should no longer be recommended for Modern and Intermediate and am also pushing for this change, which as [@ghen2](https://github.com/ghen2) noted above has also been discussed in [mozilla/server-side-tls#268](https://github.com/mozilla/server-side-tls/issues/268) (which was opened in 2020, prior to [mozilla/server-side-tls#285](https://github.com/mozilla/server-side-tls/issues/285) from 2023) |
| --- |

All reactions

Sorry, something went wrong.

[![@c0r0n3r](https://avatars.githubusercontent.com/u/979146?s=80&u=25775c6a5e163f1e04839800b028809faaf86ffa&v=4)](/c0r0n3r)

Copy link

### **[c0r0n3r](/c0r0n3r)** commented [Oct 28, 2024](#issuecomment-2442785378)

| There is another issue ([CVE-2024-41996](https://nvd.nist.gov/vuln/detail/CVE-2024-41996)) which should also be considered. This one and the other two issues ([CVE-2002-20001](https://github.com/advisories/GHSA-jx4r-qc68-xjr5 "CVE-2002-20001"), [CVE-2022-40735](https://github.com/advisories/GHSA-8vmc-7qrc-q5mx "CVE-2022-40735")) are discussed in [my article](https://pfeifferszilard.hu/2024/09/09/how-diffie-hellman-key-exchange-can-cause-availability-issues.html). |
| --- |

 ❤️
1
 janbrasna reacted with heart emoji

All reactions

* ❤️
  1 reaction

Sorry, something went wrong.

[![@janbrasna](https://avatars.githubusercontent.com/u/1784648?s=80&v=4)](/janbrasna)

Copy link

Collaborator

### **[janbrasna](/janbrasna)** commented [Oct 29, 2024](#issuecomment-2442898900)

| When the DHE suites are included, we also explicitly set the param to be equal to the `ffdhe2048` group (which is the current size for `intermediate`) — that's why I'm a bit concerned about [#256](https://github.com/mozilla/ssl-config-generator/pull/256) changing that to RFC 7919 without any restriction allowing unnecessarily large group negotiations.  I consider the more specific issues actually implementation bugs (mostly regressions from 1.1.1x) that are being addressed over time: [openssl/openssl#18480](https://github.com/openssl/openssl/pull/18480) (3.1.0), [openssl/openssl#18793](https://github.com/openssl/openssl/pull/18793) (3.0.6), [openssl/openssl#25088](https://github.com/openssl/openssl/pull/25088) (future 3.4.x release and a backport perhaps?) — silently expecting when the efficiency is being added for safe primes, it means not only for named groups, but also for provided params equal to the groups.  *(All the relevant CVEs refer to this issue here, so I'm linking the OpenSSL fixes for posterity.)* |
| --- |

All reactions

Sorry, something went wrong.

This was referenced Oct 29, 2024

[Postfix 3.7+ custom DH params discouraged on OpenSSL 3
#238](/mozilla/ssl-config-generator/issues/238)

Closed

[[Epic] OpenSSL 3.x compatibility
#260](/mozilla/ssl-config-generator/issues/260)

Closed

[![@janbrasna](https://avatars.githubusercontent.com/u/1784648?s=40&v=4)](/janbrasna)
[janbrasna](/janbrasna)
mentioned this issue
[Nov 11, 2024](#ref-issue-2649661568)

[Explicitly configure curves/groups from the guidelines
#270](/mozilla/ssl-config-generator/issues/270)

Closed

[![@gstrauss](https://avatars.githubusercontent.com/u/839103?s=80&v=4)](/gstrauss)

Copy link

Collaborator

### **[gstrauss](/gstrauss)** commented [Nov 25, 2024](#issuecomment-2498656605)

| IANA TLS Supported Groups (see "Recommended" column in the table) <https://www.iana.org/assignments/tls-parameters/tls-parameters.xhtml#tls-parameters-8>  The recommended groups are currently X25519:P-256:P-384:X448. (P-256 is also known as secp256r1 and as prime256v1) (P-384 is also known as secp384r1)  The ssl-config-generator guidelines currently contain groups `X25519:prime256v1:secp384r1`, though this is not currently exposed in the configs generated by ssl-config-generator. (See [#270](https://github.com/mozilla/ssl-config-generator/issues/270) for that discussion)  [@polarathene](https://github.com/polarathene) is there any good reason why a future version of the ssl-config-generator guidelines should be modified to recommend ffdhe groups for key exchange with TLSv1.3?  boringssl and libressl do not support ffdhe key exchange with TLSv1.3. This fails: `openssl s_client -tls1_3 -groups ffdhe2048 -connect google.com:443` The same command tested on my local machine (changing google.com:443 to localhost:443) works with openssl 3.2.2, but again, does not work with boringssl or libressl.  [@polarathene](https://github.com/polarathene) separately, for TLSv1.2, is there any good reason why a future version of the ssl-config-generator Intermediate guidelines should continue to recommend TLSv1.2 DHE\_\* ciphers? Is my understanding correct that if the DHE\_\* ciphers are removed from the current ssl-config-generator Intermediate recommendations, then servers following the Intermediate guidelines, and without DHE\_\* ciphers for TLSv1.2 will not be affected by DHEater for TLSv1.2 connections? |
| --- |

 🎉
1
 Gunni reacted with hooray emoji
 🚀
2
 Gunni and c0r0n3r reacted with rocket emoji

All reactions

* 🎉
  1 reaction
* 🚀
  2 reactions

Sorry, something went wrong.

[![@polarathene](https://avatars.githubusercontent.com/u/5098581?s=80&u=73cfbe9f5e20d8c02154e5ca1c57b9a199b7f7bc&v=4)](/polarathene)

Copy link

Contributor

### **[polarathene](/polarathene)** commented [Nov 25, 2024](#issuecomment-2499231766)

| **TL;DR:** I think as we approach 2025, the majority of servers and clients that would be negatively impacted by lack of DHE should be niche and are stuck on EOL software/hardware.   * For any affected consumers, they'd need to buy a replacement. * For business/government, they'd need to either invest in migrating/upgrading or should be considered to have the expertise to maintain their cipher suite requirements when they're no longer compatible with mainstream advice that this project caters to.   The DHEater related concern only seems to pragmatically apply to TLS 1.3 when larger modulus / computation can be triggered by the client? If that can be limited that'd probably be ideal, otherwise it may require opt-out (*if supported by the implementation, [Postfix seems to do this internally with OpenSSL 3](https://github.com/mozilla/ssl-config-generator/issues/238)*).   ---   [@polarathene](https://github.com/polarathene) is there any good reason why a future version of the ssl-config-generator guidelines should be modified to recommend ffdhe groups for key exchange with TLSv1.3?  boringssl and libressl do not support ffdhe key exchange with TLSv1.3.  AFAIK, at least with initial TLS 1.3 the FFDHE groups were never something you had much influence on at the server side, just whatever the client requested? Regardless [2048-bit is quite secure](https://github.com/mozilla/ssl-config-generator/pull/256#issuecomment-2468980060) IMO, even as a static group for DHE.  I'm not an expert in this area btw, I just sunk a fair amount of time into learning enough to be able to better weigh in on the topic for projects I maintain when it comes to security 😅 I trust with TLS 1.3 the actual experts made the decision they did to reduce control over cipher suites along with the inclusion of FFDHE groups that we'd have more official channels making amendments via RFCs should the security of the groups become a concern in future.  **EDIT:** Looked over [the paper (section 5)](https://ieeexplore.ieee.org/document/10374117#sec5) from [@c0r0n3r](https://github.com/c0r0n3r) (*your website isn't accessible btw, cloudflare states invalid cert*), I see this is a bigger issue for TLS 1.3 since FFDHE group selection can be negotiated instead of fixed 😕  I vaguely recall TLS 1.3 having FFDHE groups included but I don't recall a specific reason other than as an alternative option to ECDHE for key exchange? (*which has been [split out from cipher suite definitions in TLS 1.3](https://tlswg.org/tls13-spec/draft-ietf-tls-rfc8446bis.html#section-1.3)*) 🤷‍♂️ The 3 AEAD ciphers in TLS 1.3 have specific purposes (*AES-GCM or ChaCha-Poly1305 often depending on HW accel IIRC, and CCM for embedded needs*).   ---   [@polarathene](https://github.com/polarathene) separately, for TLSv1.2, is there any good reason why a future version of the ssl-config-generator Intermediate guidelines should continue to recommend TLSv1.2 DHE\_\* ciphers?  I think I was looking at removing these from a project I maintain, at least from the modern profile, but I'm having some trouble finding notes on that decision (*might have been lost during a system failure a couple months back*).  I would agree with the input of others that it's probably worthwhile to discourage DHE:   * [DHE-RSA-CHACHA20-POLY1305 should NOT be used anymore #269 (comment)](https://github.com/mozilla/ssl-config-generator/issues/269#issuecomment-2441748304) * [DHE ciphers should be disabled in Intermediate compatibility configuration server-side-tls#268 (comment)](https://github.com/mozilla/server-side-tls/issues/268#issuecomment-2174478990) * [Stop recommending DHE, because of "dheater" vulnerability #162 (comment)](https://github.com/mozilla/ssl-config-generator/issues/162#issuecomment-2440896274)   This project after all is a guideline for those that don't know any better, it does not enforce the exclusion of these ciphers should you need them, and those with legitimate use-cases could always raise an issue to chime in with why they believe it's still relevant to bring back for the majority.  You're dealing with rather dated servers or clients to only have support where DHE is a more secure cipher choice available. Such cases AFAIK tend to be due to businesses or government that are blocked from dropping the requirement, but have the resources to know better and make the necessary modification to bring back the ciphers they require.  As I maintain a mail server project, there is a bit more of a lag there. I changed our "modern" profile to roughly resemble the "intermediate" profile from Mozilla and OWASP in late 2020. The last main compatibility concern I can recall was possibly with Apple Mail and resolved in 2018, other than that it's businesses on systems with EOL windows and the like where I advise them to manually manage their cipher-suite lists.   ---   Is my understanding correct that if the DHE\_\* ciphers are removed from the current ssl-config-generator Intermediate recommendations, then servers following the Intermediate guidelines, and without DHE\_\* ciphers for TLSv1.2 will not be affected by DHEater for TLSv1.2 connections?  I lack the time to get familiar with DHEater again, but when I did look into it years ago it did not seem like a pragmatic concern. - There's no need for 4096-bit or 8192-bit modulus that some less knowledgeable users would wrongly adopt.   * I know some software doesn't support dual-cert ECDSA + RSA (fallback), and for some software that may potentially be an issue to support dated clients (notably in mail servers), but I lack any recent statistics info on what is still limited to TLS 1.2 and for whatever reason only capable of DHE. Shouldn't be a concern for majority of deployments though.   The mail server project I maintain [dropped TLS 1.0 + 1.1](https://github.com/docker-mailserver/docker-mailserver/commit/4dda5f8b1ff66cdc4d1adbd3b0de3c8e82db1af9) in Dec 2022 (*officially part of the [v12 release](https://github.com/docker-mailserver/docker-mailserver/releases/tag/v12.0.0) in April 2023*). That change had [two reports in 2024](https://github.com/docker-mailserver/docker-mailserver/issues/2679) about affected users, 1 was stuck on Windows 7, while the other was trying to use old hardware (a document scanner). It's possible that dropping DHE based cipher-suites could have similar compatibility impact, but I think enough time has passed for that to no longer be the responsibility of your server.  Looking at the [DMS test for TLS 1.2 RSA cipher suite](https://github.com/docker-mailserver/docker-mailserver/blob/edfecbceb163eda98124fdb10dd37bfe6fa0f46d/test/tests/parallel/set2/tls_cipherlists.bats#L208-L210), there should still be ample ciphers available even without DHE. I don't have my old notes from my 2020 research on me for more specific compatibility info, but as mentioned I think it should be fine to drop DHE 👍 |
| --- |

 ❤️
1
 gstrauss reacted with heart emoji
 🚀
2
 gstrauss and c0r0n3r reacted with rocket emoji

All reactions

* ❤️
  1 reaction
* 🚀
  2 reactions

Sorry, something went wrong.

[![@gstrauss](https://avatars.githubusercontent.com/u/839103?s=80&v=4)](/gstrauss)

Copy link

Collaborator

### **[gstrauss](/gstrauss)** commented [Nov 26, 2024](#issuecomment-2499804943)

| [@polarathene](https://github.com/polarathene) thanks for your comments.  [@gene1wood](https://github.com/gene1wood) along with my comments in [#162 (comment)](https://github.com/mozilla/ssl-config-generator/issues/162#issuecomment-2498656605), it would seem that there is consensus that we should remove the DHE ciphers for <= TLS1.2.  This issue is blocked waiting for guidance in [mozilla/server-side-tls#268](https://github.com/mozilla/server-side-tls/issues/268), where there seems to be support (e.g. April's comment in Jun 2024 [mozilla/server-side-tls#268 (comment)](https://github.com/mozilla/server-side-tls/issues/268#issuecomment-2174478990)) for modifying the guidelines to remove DHE ciphers. |
| --- |

 👍
1
 polarathene reacted with thumbs up emoji

All reactions

* 👍
  1 reaction

Sorry, something went wrong.

[![@gstrauss](https://avatars.githubusercontent.com/u/839103?s=40&v=4)](/gstrauss)
[gstrauss](/gstrauss)
assigned [gene1wood](/gene1wood)
[Nov 26, 2024](#event-15431223148)

[![@gstrauss](https://avatars.githubusercontent.com/u/839103?s=40&v=4)](/gstrauss)
[gstrauss](/gstrauss)
added
the
[blocked](/mozilla/ssl-config-generator/labels/blocked)
Something has to happen first elsewhere
label
[Nov 26, 2024](#event-15431224083)

[![@tomato42](https://avatars.githubusercontent.com/u/618246?s=80&v=4)](/tomato42)

Copy link

Member

### **[tomato42](/tomato42)** commented [Nov 26, 2024](#issuecomment-2500254923)

| yes, at this point we probably should move DHE to "Old", and limit it to 2048 bit parameters with a safe prime |
| --- |

 👍
1
 gstrauss reacted with thumbs up emoji
 ❤️
1
 gstrauss reacted with heart emoji
 🚀
3
 gstrauss, polarathene, and Gunni reacted with rocket emoji

All reactions

* 👍
  1 reaction
* ❤️
  1 reaction
* 🚀
  3 reactions

Sorry, something went wrong.

[![@tomato42](https://avatars.githubusercontent.com/u/618246?s=80&v=4)](/tomato42)

Copy link

Member

### **[tomato42](/tomato42)** commented [Nov 26, 2024](#issuecomment-2501716585)

| that being said, replacing ffdhe2048 in TLS 1.3 with a PQC key exchange would be nice: [#279](https://github.com/mozilla/ssl-config-generator/issues/279) |
| --- |

 ❤️
1
 ghen2 reacted with heart emoji

All reactions

* ❤️
  1 reaction

Sorry, something went wrong.

[![@c0r0n3r](https://avatars.githubusercontent.com/u/979146?s=80&u=25775c6a5e163f1e04839800b028809faaf86ffa&v=4)](/c0r0n3r)

Copy link

### **[c0r0n3r](/c0r0n3r)** commented [Nov 26, 2024](#issuecomment-2502138555)

| IMHO, 3072 bits is a good compromise between speed and security. Please consider that 2048 bits provide only 112, while 3072 bits provide 128 bits of security. |
| --- |

All reactions

Sorry, something went wrong.

[![@polarathene](https://avatars.githubusercontent.com/u/5098581?s=80&u=73cfbe9f5e20d8c02154e5ca1c57b9a199b7f7bc&v=4)](/polarathene)

Copy link

Contributor

### **[polarathene](/polarathene)** commented [Nov 27, 2024](#issuecomment-2502319449) • edited Loading

| Please consider that 2048 bits provide only 112, while 3072 bits provide 128 bits of security.  110-bits technically IIRC, it gets rounded to the nearest byte, so 112-bit. Likewise for 3072-bit modulus mapped to around 131-bit symmetric strength.  2048-bit is still plenty though: [#256 (comment)](https://github.com/mozilla/ssl-config-generator/pull/256#issuecomment-2468980060)  **TL;DR:** You would not be able to pull off this attack within our lifetime without the world knowing, assuming you could even acquire the necessary compute resources.  In that linked resource:   * Basically with the capability of the global bitcoin network hashrate at **750 EH/sec** (*that's 750 followed by 18 more zeros*) which uses about **170 TW/year** (*power output of Ukraine*), your average success for 110-bit brute force would be around **27k years**. 200x that power requirement is more than the entire planet outputs btw, so **you're going to bottleneck**. * That's simplifying each "operation" to the cost of SHA256 (*or was it two of those with bitcoin hashing?*). I don't have my old notes on me for the [GNFS](https://en.wikipedia.org/wiki/General_number_field_sieve) which is more complicated to attack, but it will require more compute and especially memory, it gets complicated. I had the math for it all and it aligned with historical records for the lower levels of entropy that were compromised. * I'm pretty sure I also calculated with limits of physics (*which is way out of our reach*) where even with top tier efficiency 114-bit of entropy would require enough energy to boil all the oceans in the world, regardless of time efficiency, that's a cost that should be clearly expensive to pursue vs alternatives.  ---   Doesn't really matter how much I back that sort of statement up, people still feel uncomfortable about it, especially when NIST and others like it will push for 3072-bit as a baseline. Quantum attacks to my knowledge are just as infeasible cost wise, you get the faster computation via algorithm advantage but there's a trade-off and it does not scale any better cost wise tbh.  That said, if you get some more peace of mind from bumping it up a bit more and that decision doesn't really affect your resource costs, by all means adopt 3072-bit if you like. I'm just stating that 2048-bit / 110-bit is quite secure. |
| --- |

 🎉
1
 Gunni reacted with hooray emoji

All reactions

* 🎉
  1 reaction

Sorry, something went wrong.

[![@gstrauss](https://avatars.githubusercontent.com/u/839103?s=80&v=4)](/gstrauss)

Copy link

Collaborator

### **[gstrauss](/gstrauss)** commented [Nov 27, 2024](#issuecomment-2503009345)

| [@c0r0n3r](https://github.com/c0r0n3r): Elliptic curves are more CPU efficient, memory efficient, and more space efficient (smaller network packet size).  If using DHE instead of elliptic curves, it is more likely that the computer does not support elliptic curves, and also more likely that the computer is slower and older tech. As such, 2048 bits (currently) provides a sufficient level of security and so should be maintained at 2048 bits (for the Old configuration).  The last substantial update to the public Mozilla SSL guidelines was in 2020.  [@c0r0n3r](https://github.com/c0r0n3r): when the next update (eventually) comes, why should DHE be part of it? (Yes ECDHE, but why DHE?) DHE should be relegated to the Old configuration (and perhaps not even included in Old configuration if DHEater DoS attacks are a strong concern). [@c0r0n3r](https://github.com/c0r0n3r) If you think the guidance should be changed from 2048-bit to 3072-bit, please provide references to help us understand why we should still be recommending DHE and why the recommendation should change from 2048-bit to 3072-bit. I am asking about DHE key exchange here, not RSA key size. Thank you. |
| --- |

 👍
1
 polarathene reacted with thumbs up emoji
 🚀
1
 Gunni reacted with rocket emoji

All reactions

* 👍
  1 reaction
* 🚀
  1 reaction

Sorry, something went wrong.

[![@c0r0n3r](https://avatars.githubusercontent.com/u/979146?s=80&u=25775c6a5e163f1e04839800b028809faaf86ffa&v=4)](/c0r0n3r)

Copy link

### **[c0r0n3r](/c0r0n3r)** commented [Nov 27, 2024](#issuecomment-2505018013)

| [@gstrauss](https://github.com/gstrauss), as we referenced in our [paper](https://ieeexplore.ieee.org/document/10374117#table1) (Table 1) [NIST Special Publication 800-57 Part 1 Revision 5](https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-57pt1r5.pdf) (Table 2) says that DH using 3072-bit size provides equivalent security to AES-128 (128 bit). I thought it necessary to note that suggesting a parameter that can provide 128 bits of security is considerable. |
| --- |

All reactions

Sorry, something went wrong.

[![@polarathene](https://avatars.githubusercontent.com/u/5098581?s=80&u=73cfbe9f5e20d8c02154e5ca1c57b9a199b7f7bc&v=4)](/polarathene)

Copy link

Contributor

### **[polarathene](/polarathene)** commented [Nov 28, 2024](#issuecomment-2505029229)

| I thought it necessary to note that suggesting a parameter that can provide 128 bits of security is considerable.  110-bits is also considerable.  You could choose 256-bit over 128-bit for the same reason, but in both cases you're not really adding any pragmatic security when the cost for 110-bit is already out of reach. |
| --- |

All reactions

Sorry, something went wrong.

[![@c0r0n3r](https://avatars.githubusercontent.com/u/979146?s=80&u=25775c6a5e163f1e04839800b028809faaf86ffa&v=4)](/c0r0n3r)

Copy link

### **[c0r0n3r](/c0r0n3r)** commented [Nov 28, 2024](#issuecomment-2505037181)

| [@polarathene](https://github.com/polarathene), as you can find in our [paper](https://ieeexplore.ieee.org/document/10374117#table12) 256 bits of security using DH KEX is not supported by the vast majority of the cryptographic libraries and would cause serious performance issues. |
| --- |

All reactions

Sorry, something went wrong.

[![@gstrauss](https://avatars.githubusercontent.com/u/839103?s=80&v=4)](/gstrauss)

Copy link

Collaborator

### **[gstrauss](/gstrauss)** commented [Nov 28, 2024](#issuecomment-2505047194) • edited Loading

| [@c0r0n3r](https://github.com/c0r0n3r) thank you for providing the reference. However, that does not quite answer the question I was asking. The reason for my question is one of "practical engineering", and I think what [@polarathene](https://github.com/polarathene) might be trying to argue in the details.  [NIST Special Publication 800-57 Part 1 Revision 5](https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-57pt1r5.pdf) (Table 2) says that DH using 3072-bit size provides equivalent security to AES-128 (128 bit). I thought it necessary to note that suggesting a parameter that can provide 128 bits of security is considerable.  I am not questioning that. Instead, coming from a practical perspective, I am asking if we can omit DHE key exchange. For (future update of) ssl-config-generator Intermediate and Modern configs, why we should recommend DHE key exchange in TLSv1.2 ciphers, or in TLSv1.3 groups?  [@c0r0n3r](https://github.com/c0r0n3r) do you disagree with my statement?  Elliptic curves are more CPU efficient, memory efficient, and more space efficient (smaller network packet size).  (and also not vulnerable to resource usage DoS due to DHEater attack)  Edit: I should have specified "elliptic curves of similar strength to much larger DH keys" |
| --- |

All reactions

Sorry, something went wrong.

[![@polarathene](https://avatars.githubusercontent.com/u/5098581?s=80&u=73cfbe9f5e20d8c02154e5ca1c57b9a199b7f7bc&v=4)](/polarathene)

Copy link

Contributor

### **[polarathene](/polarathene)** commented [Nov 28, 2024](#issuecomment-2505054033) • edited Loading

| [@c0r0n3r](https://github.com/c0r0n3r) you misunderstand what I was saying. I'm referring to symmetric security strength, not DH specifically. It's obvious that the equivalent in DH would be bad for other reasons discussed in this issue.  I am simply stating that 110-bits (2048-bit modulus) is sufficiently secure. I know you've referenced the NIST document as a source, but I've done that years ago and taken it a step further (*as illustrated above with approximating the cost in resources to actually perform an attack*).  If the information I provided earlier is not sufficient, you can review [my math related to the NIST table referenced](https://gist.github.com/polarathene/9e3cd791091dc2bd075a2ec4cf793aaa), but digging up my old notes with the more in-depth math for GFNS and the limits of physics computations is not something I can presently afford to do right now until I'm in a better situation financially.   ---   The reason for my question is one of "practical engineering", and I think what [@polarathene](https://github.com/polarathene) might be trying to argue in the details.  Yes, specifically that there is no pragmatic increase in security above 2048-bit with DHE to my knowledge. I've shared my knowledge over the years regarding this and have yet to have any response that invalidates my findings, which if anything the cost is higher.  DHE cipher suites to my knowledge were more of a compatibility/transition as historically support for other cipher suites on older systems (now EOL for some years IIRC) had been lacking. The only other reason I recall DHE being relevant is when ECDHE was not desired due to certain concerns (*potential backdoors I think with ECC, unless using say ed25519*), my old notes have the details/links related to that. |
| --- |

All reactions

Sorry, something went wrong.

[![@tomato42](https://avatars.githubusercontent.com/u/618246?s=80&v=4)](/tomato42)

Copy link

Member

### **[tomato42](/tomato42)** commented [Nov 28, 2024](#issuecomment-2506120184)

| IMHO, 3072 bits is a good compromise between speed and security. Please consider that 2048 bits provide only 112, while 3072 bits provide 128 bits of security.  We are accepting 2048 bit RSA keys, for legacy deployments there really is no reason to pair 3072 bit DH with 2048 bit RSA. And I know that at least some Java versions are happy with 2048 bit DH but will fall flat when getting 3072 bit DH params, which, again, for legacy, max-compatibility configuration, is a bad thing. |
| --- |

 🚀
1
 c0r0n3r reacted with rocket emoji

All reactions

* 🚀
  1 reaction

Sorry, something went wrong.

[![@polarathene](https://avatars.githubusercontent.com/u/5098581?s=80&u=73cfbe9f5e20d8c02154e5ca1c57b9a199b7f7bc&v=4)](/polarathene)

Copy link

Contributor

### **[polarathene](/polarathene)** commented [Nov 28, 2024](#issuecomment-2506691590)

| there really is no reason to pair 3072 bit DH with 2048 bit RSA  Technically the RSA key is replaced periodically while FFDHE 3072-bit group parameters are static, so if 2048-bit were possible to attack, bumping it up to 3072-bit for DHE would make sense.  Regarding 2048-bit compatibility, yes that limitation exists elsewhere too and are being dismissed as too old to be relevant anymore? Those environments often lacked ECDHE support or support for other modern ciphers (in TLS 1.2). Where possible it's better to put them behind a proxy to bridge to modern security capabilities. |
| --- |

All reactions

Sorry, something went wrong.

[![@tomato42](https://avatars.githubusercontent.com/u/618246?s=80&v=4)](/tomato42)

Copy link

Member

### **[tomato42](/tomato42)** commented [Nov 29, 2024](#issuecomment-2507960253)

| Technically the RSA key is replaced periodically while FFDHE 3072-bit group parameters are static, so if 2048-bit were possible to attack, bumping it up to 3072-bit for DHE would make sense.  while some precomputation is possible for attacking a particular parameter set, and then reusing that for attacking different key exchanges, it requires more resources than breaking a single DH key exchange. An attacker that's able to "easily" break DH with static params by use of precomputation would be able regularly break RSA public keys. See the LogJam paper for details.  So really, it's an academic distinction without relevance to practical deployments. Pair RSA with same-size DHE, even if it's a well-known DHE prime. That's the algorithm already implemented and deployed in OpenSSL, NSS, and possibly other libraries. |
| --- |

All reactions

Sorry, something went wrong.

[![@polarathene](https://avatars.githubusercontent.com/u/5098581?s=80&u=73cfbe9f5e20d8c02154e5ca1c57b9a199b7f7bc&v=4)](/polarathene)

### This comment was marked as off-topic.

[Sign in to view](/login?return_to=https%3A%2F%2Fgithub.com%2Fmozilla%2Fssl-config-generator%2Fissues%2F162)

[![@c0r0n3r](https://avatars.githubusercontent.com/u/979146?s=80&u=25775c6a5e163f1e04839800b028809faaf86ffa&v=4)](/c0r0n3r)

Copy link

### **[c0r0n3r](/c0r0n3r)** commented [Nov 30, 2024](#issuecomment-2509139319) • edited Loading

| [@gstrauss](https://github.com/gstrauss), thanks for clarifying your comment. I agree with your statement. However, there can be implementation issues that may cause ECDHE to be vulnerable to D(HE)at attack, but it would require further investigation. |
| --- |

All reactions

Sorry, something went wrong.

[![@c0r0n3r](https://avatars.githubusercontent.com/u/979146?s=80&u=25775c6a5e163f1e04839800b028809faaf86ffa&v=4)](/c0r0n3r)

Copy link

### **[c0r0n3r](/c0r0n3r)** commented [Nov 30, 2024](#issuecomment-2509139709)

| We are accepting 2048 bit RSA keys, for legacy deployments there really is no reason to pair 3072 bit DH with 2048 bit RSA. And I know that at least some Java versions are happy with 2048 bit DH but will fall flat when getting 3072 bit DH params, which, again, for legacy, max-compatibility configuration, is a bad thing.  Good to know. Thanks for sharing this info. |
| --- |

All reactions

Sorry, something went wrong.

[![@tomato42](https://avatars.githubusercontent.com/u/618246?s=80&v=4)](/tomato42)

Copy link

Member

### **[tomato42](/tomato42)** commented [Dec 2, 2024](#issuecomment-2511735895)

| The main differentiation I was making was a certificate generally has a life time of 90 days or less, while the standardized groups with FFDHE from RFC 7919 don't have that constraint.  no, they don't: CA certificates have lifetimes measured in decades, and even regular certificates will have lifetimes measured in years because not everybody can use ACME |
| --- |

All reactions

Sorry, something went wrong.

[![@polarathene](https://avatars.githubusercontent.com/u/5098581?s=80&u=73cfbe9f5e20d8c02154e5ca1c57b9a199b7f7bc&v=4)](/polarathene)

### This comment was marked as off-topic.

[Sign in to view](/login?return_to=https%3A%2F%2Fgithub.com%2Fmozilla%2Fssl-config-generator%2Fissues%2F162)

[![@gstrauss](https://avatars.githubusercontent.com/u/839103?s=80&v=4)](/gstrauss)

Copy link

Collaborator

### **[gstrauss](/gstrauss)** commented [Dec 2, 2024](#issuecomment-2512858078) • edited Loading

| [@polarathene](https://github.com/polarathene) here is some meta feedback: you have shown a tendency to make statements/conclusions without evidence and then ask others for evidence when they tell you that your assumptions -- which you made as statements -- are incorrect or misleading in their representation. It is not the responsibility of others to prove you wrong. Please ask questions rather than making statements and attempting to put the burden on others to disprove your statements.  Statistically, when the advice this generator provides for modern and intermediate profiles is used the bulk of certificates will be ACME with a short lifespan such as 90 days.  Citation needed. (Also, [@tomato42](https://github.com/tomato42) provided a counterexample.)  Could you provide context on why ACME wouldn't be available?  Not everyone uses ACME to manage their certificates. One possible security pattern is to disallow servers to make outgoing connections, not even via a proxy. In those configurations, certificates must be pushed to those servers and the certificate lifetimes are managed by the CA which issues the certificate, which might not be the CA you have in mind.  [@polarathene](https://github.com/polarathene) There are many possible valid configurations and your preferred configuration is not one that can be enforced on the entire internet.  The systems unable to do so are going to have caveats due to environment or age which I assume won't be supported indefinitely by this generator.  For some, yes. It is an ongoing challenge to provide reasonably secure configurations for a wide variety of scenarios and ages of software. I am trying to structure the conversations around publicly maintained software versions and end-of-life versions (even if commercial support is available privately for older software versions). |
| --- |

 😕
1
 polarathene reacted with confused emoji

All reactions

* 😕
  1 reaction

Sorry, something went wrong.

[![@polarathene](https://avatars.githubusercontent.com/u/5098581?s=80&u=73cfbe9f5e20d8c02154e5ca1c57b9a199b7f7bc&v=4)](/polarathene)

### This comment was marked as off-topic.

[Sign in to view](/login?return_to=https%3A%2F%2Fgithub.com%2Fmozilla%2Fssl-config-generator%2Fissues%2F162)

This was referenced Dec 3, 2024

[Include support for Post-Quantum Cryptography as experimental
#279](/mozilla/ssl-config-generator/issues/279)

Open

[config TLSv1.3 key exchange groups where supported
#284](/mozilla/ssl-config-generator/pull/284)
 Merged

[![@tomato42](https://avatars.githubusercontent.com/u/618246?s=80&v=4)](/tomato42)

Copy link

Member

### **[tomato42](/tomato42)** commented [Dec 8, 2024](#issuecomment-2526152554) • edited Loading

| [@polarathene](https://github.com/polarathene) the whole certificate chain needs to be secure, so as long as we have browsers trusting any CA with lifetime measured in multiple years and keys that are 2048 bit long your whole argument for mismatched recommendations for DHE and RSA pair is invalid  attacking a single key used by said CA will be easier than attacking 2048 bit static parameter set for DHE  both of which will lead to compromise of the connections happening after that break  recommending different RSA and DHE limits goes against recommendations of basically whole cryptographic community, so please, just stop |
| --- |

All reactions

Sorry, something went wrong.

[![@polarathene](https://avatars.githubusercontent.com/u/5098581?s=80&u=73cfbe9f5e20d8c02154e5ca1c57b9a199b7f7bc&v=4)](/polarathene)

### This comment was marked as off-topic.

[Sign in to view](/login?return_to=https%3A%2F%2Fgithub.com%2Fmozilla%2Fssl-config-generator%2Fissues%2F162)

[![@polarathene](https://avatars.githubusercontent.com/u/5098581?s=80&u=73cfbe9f5e20d8c02154e5ca1c57b9a199b7f7bc&v=4)](/polarathene)

### This comment was marked as off-topic.

[Sign in to view](/login?return_to=https%3A%2F%2Fgithub.com%2Fmozilla%2Fssl-config-generator%2Fissues%2F162)

[![@tomato42](https://avatars.githubusercontent.com/u/618246?s=80&v=4)](/tomato42)

Copy link

Member

### **[tomato42](/tomato42)** commented [Dec 12, 2024](#issuecomment-2539420419)

| Just in case big comments from me is the actual communication issue.  **Attack scenario:**  ``` * 2048-bit RSA certificate (_any part of the chain_), 10 year expiry.  * 2048-bit FFDHE parameters (RFC 7919), no expiry, no rotation.  * 20 year attack. The entire planet is dedicating it's resources to accomplish this. Moore's law accounted for.  ```  **Conclusion:**  ``` * Optimal attack target? (_between these two choices, obviously there is more affordable alternatives_) DHE parameters due to sufficient time to attack.  * Counter-measure?      * Raise DHE parameters from 2048-bit (_110-bit symmetric_) to 3072-bit (_132-bit symmetric_) or rotate params to non-standardized params (_without weak cyclic groups used_).   * Use an alternative key exchange instead of FFDHE.  ```  You're forgetting that this is about general recommendations for normal internet systems.  if you need to care about secrecy of the data for more than 20 years, then you need custom policies.  I'm not recommending anything?  And those "counter-measures" above? what's that?  sorry, but I don't find this conversation productive or pleasant |
| --- |

All reactions

Sorry, something went wrong.

[![@polarathene](https://avatars.githubusercontent.com/u/5098581?s=80&u=73cfbe9f5e20d8c02154e5ca1c57b9a199b7f7bc&v=4)](/polarathene)

### This comment was marked as off-topic.

[Sign in to view](/login?return_to=https%3A%2F%2Fgithub.com%2Fmozilla%2Fssl-config-generator%2Fissues%2F162)

[![@gstrauss](https://avatars.githubusercontent.com/u/839103?s=80&v=4)](/gstrauss)

Copy link

Collaborator

### **[gstrauss](/gstrauss)** commented [Dec 13, 2024](#issuecomment-2540535509)

| [@polarathene](https://github.com/polarathene): Your initial statements have been useful contributions to the discussion. Thank you. The repetition and drowning in some of the details has not been constructive. Please stop posting on this issue.  While you may be an expert in this area, you are not the only expert and we are not here to validate you.  Correct me if I'm wrong,  No. N.B.: I am neither validating nor am I disputing your statements; I am ceasing to entertain them further.  So let's just end this discussion and agree that my statement  No. The discussion was already over.  Otherwise I'm more than happy to continue until we're on the same page about the validity of the statement.  No. Not here.  Please stop posting *here* on *this issue*. You are not going to receive the validation you are looking for *here*, as this issue is not about validating you.  Thank you for your contributions to the discussion. Please stop repeating yourself and please stop posting here on this issue.  Have I repeated myself enough to make my point crystal clear? Did you understand it the first time? (Likely.) If you got it the first time, and I fully expect that you did, then please turn it around and apply the same to yourself.  Further responses here repeating yourself or seeking validation maybe hidden, deleted, or otherwise removed.  As you, yourself said above:  So let's just end this discussion  Yes, to that part, on the already-ended discussion. |
| --- |

 👍
2
 polarathene and tomato42 reacted with thumbs up emoji
 😕
1
 polarathene reacted with confused emoji

All reactions

* 👍
  2 reactions
* 😕
  1 reaction

Sorry, something went wrong.

[![@Zoey2936](https://avatars.githubusercontent.com/u/75573284?s=40&v=4)](/Zoey2936)
[Zoey2936](/Zoey2936)
mentioned this issue
[Dec 16, 2024](#ref-pullrequest-2740149050)

[Improve nginx reverse proxy template
nextcloud/all-in-one#5750](/nextcloud/all-in-one/pull/5750)
 Merged

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fmozilla%2Fssl-config-generator%2Fissues%2F162)

Assignees

[![@gene1wood](https://avatars.githubusercontent.com/u/1134034?s=40&v=4)](/gene1wood) [gene1wood](/gene1wood)

Labels

[blocked](/mozilla/ssl-config-generator/labels/blocked)
Something has to happen first elsewhere
[specs](/mozilla/ssl-config-generator/labels/specs)
This involves changes in recommendations

Projects

None yet

Milestone

No milestone

Development

No branches or pull requests

11 participants

[![@Gunni](https://avatars.githubusercontent.com/u/358099?s=52&v=4)](/Gunni) [![@tomato42](https://avatars.githubusercontent.com/u/618246?s=52&v=4)](/tomato42) [![@gstrauss](https://avatars.githubusercontent.com/u/839103?s=52&v=4)](/gstrauss) [![@c0r0n3r](https://avatars.githubusercontent.com/u/979146?s=52&v=4)](/c0r0n3r) [![@gene1wood](https://avatars.githubusercontent.com/u/1134034?s=52&v=4)](/gene1wood) [![@domdom82](https://avatars.githubusercontent.com/u/1755853?s=52&v=4)](/domdom82) [![@janbrasna](https://avatars.githubusercontent.com/u/1784648?s=52&v=4)](/janbrasna) [![@patrakov](https://avatars.githubusercontent.com/u/2943163?s=52&v=4)](/patrakov) [![@polarathene](https://avatars.githubusercontent.com/u/5098581?s=52&v=4)](/polarathene) [![@ghen2](https://avatars.githubusercontent.com/u/23522924?s=52&v=4)](/ghen2) [![@watchingdogs](https://avatars.githubusercontent.com/u/69792238?s=52&v=4)](/watchingdogs)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from www.rfc-editor.org_65094c12_20250108_141355.html ===

[[RFC Home](https://www.rfc-editor.org "RFC Editor")] [[TEXT](/rfc/rfc4419.txt)|[PDF](/rfc/pdfrfc/rfc4419.txt.pdf)|[HTML](/rfc/rfc4419.html)] [[Tracker](https://datatracker.ietf.org/doc/rfc4419 "IETF Datatracker information for this document")] [[IPR](https://datatracker.ietf.org/ipr/search/?rfc=4419&submit=rfc "IPR disclosures related to this document")] [[Errata](/errata/rfc4419)] [[Info page](https://www.rfc-editor.org/info/rfc4419 "Info page")]

 PROPOSED STANDARD
Updated by: [8270](/rfc/rfc8270) Errata Exist
```
Network Working Group                                          M. Friedl
Request for Comments: 4419                                     N. Provos
Category: Standards Track                                     W. Simpson
                                                              March 2006

                   Diffie-Hellman Group Exchange for
            the Secure Shell (SSH) Transport Layer Protocol

Status of This Memo

   This document specifies an Internet standards track protocol for the
   Internet community, and requests discussion and suggestions for
   improvements.  Please refer to the current edition of the "Internet
   Official Protocol Standards" (STD 1) for the standardization state
   and status of this protocol.  Distribution of this memo is unlimited.

Copyright Notice

   Copyright (C) The Internet Society (2006).

Abstract

   This memo describes a new key exchange method for the Secure Shell
   (SSH) protocol.  It allows the SSH server to propose new groups on
   which to perform the Diffie-Hellman key exchange to the client.  The
   proposed groups need not be fixed and can change with time.

[1](#section-1).  Overview and Rationale

   SSH [[RFC4251](./rfc4251 "\"The Secure Shell (SSH) Protocol Architecture\"")] is a very common protocol for secure remote login on
   the Internet.  Currently, SSH performs the initial key exchange using
   the "diffie-hellman-group1-sha1" method [[RFC4253](./rfc4253 "\"The Secure Shell (SSH) Transport Layer Protocol\"")].  This method
   prescribes a fixed group on which all operations are performed.

   The Diffie-Hellman key exchange provides a shared secret that cannot
   be determined by either party alone.  Furthermore, the shared secret
   is known only to the participant parties.  In SSH, the key exchange
   is signed with the host key to provide host authentication.

   The security of the Diffie-Hellman key exchange is based on the
   difficulty of solving the Discrete Logarithm Problem (DLP).  Since we
   expect that the SSH protocol will be in use for many years in the
   future, we fear that extensive precomputation and more efficient
   algorithms to compute the discrete logarithm over a fixed group might
   pose a security threat to the SSH protocol.

Friedl, et al.              Standards Track                     [Page 1]
```

---

```

[RFC 4419](./rfc4419)                 SSH DH Group Exchange                March 2006

   The ability to propose new groups will reduce the incentive to use
   precomputation for more efficient calculation of the discrete
   logarithm.  The server can constantly compute new groups in the
   background.

[2](#section-2).  Requirements Notation

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in [[RFC2119](./rfc2119 "\"Key words for use in RFCs to Indicate Requirement Levels\"")].

[3](#section-3).  Diffie-Hellman Group and Key Exchange

   The server keeps a list of safe primes and corresponding generators
   that it can select from.  A prime p is safe if p = 2q + 1 and q is
   prime.  New primes can be generated in the background.

   The generator g should be chosen such that the order of the generated
   subgroup does not factor into small primes; that is, with p = 2q + 1,
   the order has to be either q or p - 1.  If the order is p - 1, then
   the exponents generate all possible public values, evenly distributed
   throughout the range of the modulus p, without cycling through a
   smaller subset.  Such a generator is called a "primitive root" (which
   is trivial to find when p is "safe").

   The client requests a modulus from the server indicating the
   preferred size.  In the following description (C is the client, S is
   the server, the modulus p is a large safe prime, and g is a generator
   for a subgroup of GF(p), min is the minimal size of p in bits that is
   acceptable to the client, n is the size of the modulus p in bits that
   the client would like to receive from the server, max is the maximal
   size of p in bits that the client can accept, V_S is S's version
   string, V_C is C's version string, K_S is S's public host key, I_C is
   C's KEXINIT message, and I_S is S's KEXINIT message that has been
   exchanged before this part begins):

   1.  C sends "min || n || max" to S, indicating the minimal acceptable
       group size, the preferred size of the group, and the maximal
       group size in bits the client will accept.

   2.  S finds a group that best matches the client's request, and sends
       "p || g" to C.

   3.  C generates a random number x, where 1 < x < (p-1)/2.  It
       computes e = g^x mod p, and sends "e" to S.

Friedl, et al.              Standards Track                     [Page 2]
```

---

```

[RFC 4419](./rfc4419)                 SSH DH Group Exchange                March 2006

   4.  S generates a random number y, where 0 < y < (p-1)/2, and
       computes f = g^y mod p.  S receives "e".  It computes K = e^y mod
       p, H = hash(V_C || V_S || I_C || I_S || K_S || min || n || max ||
       p || g || e || f || K) (these elements are encoded according to
       their types; see below), and signature s on H with its private
       host key.  S sends "K_S || f || s" to C.  The signing operation
       may involve a second hashing operation.

   5.  C verifies that K_S really is the host key for S (e.g., using
       certificates or a local database to obtain the public key).  C is
       also allowed to accept the key without verification; however,
       doing so will render the protocol insecure against active attacks
       (but may be desirable for practical reasons in the short term in
       many environments).  C then computes K = f^x mod p, H = hash(V_C
       || V_S || I_C || I_S || K_S || min || n || max || p || g || e ||
       f || K), and verifies the signature s on H.

   Servers and clients SHOULD support groups with a modulus length of k
   bits, where 1024 <= k <= 8192.  The recommended values for min and
   max are 1024 and 8192, respectively.

   Either side MUST NOT send or accept e or f values that are not in the
   range [1, p-1].  If this condition is violated, the key exchange
   fails.  To prevent confinement attacks, they MUST accept the shared
   secret K only if 1 < K < p - 1.

   The server should return the smallest group it knows that is larger
   than the size the client requested.  If the server does not know a
   group that is larger than the client request, then it SHOULD return
   the largest group it knows.  In all cases, the size of the returned
   group SHOULD be at least 1024 bits.

   This is implemented with the following messages.  The hash algorithm
   for computing the exchange hash is defined by the method name, and is
   called HASH.  The public key algorithm for signing is negotiated with
   the KEXINIT messages.

   First, the client sends:

     byte    SSH_MSG_KEY_DH_GEX_REQUEST
     uint32  min, minimal size in bits of an acceptable group
     uint32  n, preferred size in bits of the group the server will send
     uint32  max, maximal size in bits of an acceptable group

Friedl, et al.              Standards Track                     [Page 3]
```

---

```

[RFC 4419](./rfc4419)                 SSH DH Group Exchange                March 2006

   The server responds with

     byte    SSH_MSG_KEX_DH_GEX_GROUP
     mpint   p, safe prime
     mpint   g, generator for subgroup in GF(p)

   The client responds with:

     byte    SSH_MSG_KEX_DH_GEX_INIT
     mpint   e

   The server responds with:

     byte    SSH_MSG_KEX_DH_GEX_REPLY
     string  server public host key and certificates (K_S)
     mpint   f
     string  signature of H

   The hash H is computed as the HASH hash of the concatenation of the
   following:

     string  V_C, the client's version string (CR and NL excluded)
     string  V_S, the server's version string (CR and NL excluded)
     string  I_C, the payload of the client's SSH_MSG_KEXINIT
     string  I_S, the payload of the server's SSH_MSG_KEXINIT
     string  K_S, the host key
     uint32  min, minimal size in bits of an acceptable group
     uint32  n, preferred size in bits of the group the server will send
     uint32  max, maximal size in bits of an acceptable group
     mpint   p, safe prime
     mpint   g, generator for subgroup
     mpint   e, exchange value sent by the client
     mpint   f, exchange value sent by the server
     mpint   K, the shared secret

   This value is called the exchange hash, and it is used to
   authenticate the key exchange as per [[RFC4253](./rfc4253 "\"The Secure Shell (SSH) Transport Layer Protocol\"")].

[4](#section-4).  Key Exchange Methods

   This document defines two new key exchange methods:
   "diffie-hellman-group-exchange-sha1" and
   "diffie-hellman-group-exchange-sha256".

Friedl, et al.              Standards Track                     [Page 4]
```

---

```

[RFC 4419](./rfc4419)                 SSH DH Group Exchange                March 2006

[4.1](#section-4.1).  diffie-hellman-group-exchange-sha1

   The "diffie-hellman-group-exchange-sha1" method specifies
   Diffie-Hellman Group and Key Exchange with SHA-1 [[FIPS-180-2](#ref-FIPS-180-2 "\"Secure Hash Standard (SHS)\"")] as
   HASH.

[4.2](#section-4.2).  diffie-hellman-group-exchange-sha256

   The "diffie-hellman-group-exchange-sha256" method specifies
   Diffie-Hellman Group and Key Exchange with SHA-256 [[FIPS-180-2](#ref-FIPS-180-2 "\"Secure Hash Standard (SHS)\"")] as
   HASH.

   Note that the hash used in key exchange (in this case, SHA-256) must
   also be used in the key derivation pseudo-random function (PRF), as
   per the requirement in the "Output from Key Exchange" section in
   [[RFC4253](./rfc4253 "\"The Secure Shell (SSH) Transport Layer Protocol\"")].

[5](#section-5).  Summary of Message Numbers

   The following message numbers have been defined in this document.
   They are in a name space private to this document and not assigned by
   IANA.

     #define SSH_MSG_KEX_DH_GEX_REQUEST_OLD  30
     #define SSH_MSG_KEX_DH_GEX_REQUEST      34
     #define SSH_MSG_KEX_DH_GEX_GROUP        31
     #define SSH_MSG_KEX_DH_GEX_INIT         32
     #define SSH_MSG_KEX_DH_GEX_REPLY        33

   SSH_MSG_KEX_DH_GEX_REQUEST_OLD is used for backward compatibility.
   Instead of sending "min || n || max", the client only sends "n".  In
   addition, the hash is calculated using only "n" instead of "min || n
   || max".

   The numbers 30-49 are key exchange specific and may be redefined by
   other kex methods.

[6](#section-6).  Implementation Notes

[6.1](#section-6.1).  Choice of Generator

   One useful technique is to select the generator, and then limit the
   modulus selection sieve to primes with that generator:

      2   when p (mod 24) = 11.
      5   when p (mod 10) = 3 or 7.

Friedl, et al.              Standards Track                     [Page 5]
```

---

```

[RFC 4419](./rfc4419)                 SSH DH Group Exchange                March 2006

   It is recommended to use 2 as generator, because it improves
   efficiency in multiplication performance.  It is usable even when it
   is not a primitive root, as it still covers half of the space of
   possible residues.

[6.2](#section-6.2).  Private Exponents

   To increase the speed of the key exchange, both client and server may
   reduce the size of their private exponents.  It should be at least
   twice as long as the key material that is generated from the shared
   secret.  For more details, see the paper by van Oorschot and Wiener
   [[VAN-OORSCHOT](#ref-VAN-OORSCHOT "\"On Diffie-Hellman key agreement with short exponents\"")].

[7](#section-7).  Security Considerations

   This protocol aims to be simple and uses only well-understood
   primitives.  This encourages acceptance by the community and allows
   for ease of implementation, which hopefully leads to a more secure
   system.

   The use of multiple moduli inhibits a determined attacker from
   precalculating moduli exchange values, and discourages dedication of
   resources for analysis of any particular modulus.

   It is important to employ only safe primes as moduli, as they allow
   us to find a generator g so that the order of the generated subgroup
   does not factor into small primes, that is, with p = 2q + 1, the
   order has to be either q or p - 1.  If the order is p - 1, then the
   exponents generate all possible public values, evenly distributed
   throughout the range of the modulus p, without cycling through a
   smaller subset.  Van Oorshot and Wiener note that using short private
   exponents with a random prime modulus p makes the computation of the
   discrete logarithm easy [[VAN-OORSCHOT](#ref-VAN-OORSCHOT "\"On Diffie-Hellman key agreement with short exponents\"")].  However, they also state
   that this problem does not apply to safe primes.

   The least significant bit of the private exponent can be recovered
   when the modulus is a safe prime [[MENEZES](#ref-MENEZES "\"Handbook of Applied Cryptography\"")].  However, this is not a
   problem if the size of the private exponent is big enough.  Related
   to this, Waldvogel and Massey note: When private exponents are chosen
   independently and uniformly at random from {0,...,p-2}, the key
   entropy is less than 2 bits away from the maximum, lg(p-1)
   [[WALDVOGEL](#ref-WALDVOGEL "\"The probability distribution of the Diffie-Hellman key\"")].

   The security considerations in [[RFC4251](./rfc4251 "\"The Secure Shell (SSH) Protocol Architecture\"")] also apply to this key
   exchange method.

Friedl, et al.              Standards Track                     [Page 6]
```

---

```

[RFC 4419](./rfc4419)                 SSH DH Group Exchange                March 2006

[8](#section-8).  Acknowledgements

   The document is derived in part from "SSH Transport Layer Protocol"
   [[RFC4253](./rfc4253 "\"The Secure Shell (SSH) Transport Layer Protocol\"")] by T. Ylonen, T. Kivinen, M. Saarinen, T.  Rinne, and S.
   Lehtinen.

   Markku-Juhani Saarinen pointed out that the least significant bit of
   the private exponent can be recovered efficiently when using safe
   primes and a subgroup with an order divisible by two.

   Bodo Moeller suggested that the server send only one group, reducing
   the complexity of the implementation and the amount of data that
   needs to be exchanged between client and server.

Friedl, et al.              Standards Track                     [Page 7]
```

---

```

[RFC 4419](./rfc4419)                 SSH DH Group Exchange                March 2006

Appendix A:  Generation of Safe Primes

   The "Handbook of Applied Cryptography" [[MENEZES](#ref-MENEZES "\"Handbook of Applied Cryptography\"")] lists the following
   algorithm to generate a k-bit safe prime p.  It has been modified so
   that 2 is a generator for the multiplicative group mod p.

   1.  Do the following:

       1.  Select a random (k-1)-bit prime q, so that q mod 12 = 5.

       2.  Compute p := 2q + 1, and test whether p is prime (using,
           e.g., trial division and the Rabin-Miller test).

   2.  Repeat until p is prime.

   If an implementation uses the OpenSSL libraries, a group consisting
   of a 1024-bit safe prime and 2 as generator can be created as
   follows:

       DH *d = NULL;
       d = DH_generate_parameters(1024, DH_GENERATOR_2, NULL, NULL);
       BN_print_fp(stdout, d->p);

   The order of the subgroup generated by 2 is q = p - 1.

References

Normative References

   [FIPS-180-2]   National Institute of Standards and Technology (NIST),
                  "Secure Hash Standard (SHS)", FIPS PUB 180-2,
                  August 2002.

   [RFC4251]      Ylonen, T. and C. Lonvick, "The Secure Shell (SSH)
                  Protocol Architecture", [RFC 4251](./rfc4251), January 2006.

   [RFC4253]      Lonvick, C., "The Secure Shell (SSH) Transport Layer
                  Protocol", [RFC 4253](./rfc4253), January 2006.

   [RFC2119]      Bradner, S., "Key words for use in RFCs to Indicate
                  Requirement Levels", [BCP 14](https://www.rfc-editor.org/bcp/bcp14), [RFC 2119](./rfc2119), March 1997.

Informative References

   [MENEZES]      Menezes, A., van Oorschot, P., and S. Vanstone,
                  "Handbook of Applied Cryptography", CRC Press, p. 537,
                  1996.

Friedl, et al.              Standards Track                     [Page 8]
```

---

```

[RFC 4419](./rfc4419)                 SSH DH Group Exchange                March 2006

   [VAN-OORSCHOT] van Oorschot, P. and M. Wiener, "On Diffie-Hellman key
                  agreement with short exponents", Advances in
                  Cryptology -EUROCRYPT'96, LNCS 1070,
                  Springer-Verlag, pp. 332-343, 1996.

   [WALDVOGEL]    Waldvogel, C. and J. Massey, "The probability
                  distribution of the Diffie-Hellman key", Proceedings
                  of AUSCRYPT 92, LNCS 718, Springer-Verlag, pp.
                  492-504, 1993.

Authors' Addresses

   Markus Friedl
   EMail: markus@openbsd.org

   Niels Provos
   EMail: provos@citi.umich.edu

   William A. Simpson
   EMail: wsimpson@greendragon.com

Friedl, et al.              Standards Track                     [Page 9]
```

---

```

[RFC 4419](./rfc4419)                 SSH DH Group Exchange                March 2006

Full Copyright Statement

   Copyright (C) The Internet Society (2006).

   This document is subject to the rights, licenses and restrictions
   contained in [BCP 78](https://www.rfc-editor.org/bcp/bcp78), and except as set forth therein, the authors
   retain all their rights.

   This document and the information contained herein are provided on an
   "AS IS" basis and THE CONTRIBUTOR, THE ORGANIZATION HE/SHE REPRESENTS
   OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY AND THE INTERNET
   ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES, EXPRESS OR IMPLIED,
   INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF THE
   INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED
   WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.

Intellectual Property

   The IETF takes no position regarding the validity or scope of any
   Intellectual Property Rights or other rights that might be claimed to
   pertain to the implementation or use of the technology described in
   this document or the extent to which any license under such rights
   might or might not be available; nor does it represent that it has
   made any independent effort to identify any such rights.  Information
   on the procedures with respect to rights in RFC documents can be
   found in [BCP 78](https://www.rfc-editor.org/bcp/bcp78) and [BCP 79](https://www.rfc-editor.org/bcp/bcp79).

   Copies of IPR disclosures made to the IETF Secretariat and any
   assurances of licenses to be made available, or the result of an
   attempt made to obtain a general license or permission for the use of
   such proprietary rights by implementers or users of this
   specification can be obtained from the IETF on-line IPR repository at
   <http://www.ietf.org/ipr>.

   The IETF invites any interested party to bring to its attention any
   copyrights, patents or patent applications, or other proprietary
   rights that may cover technology that may be required to implement
   this standard.  Please address the information to the IETF at
   ietf-ipr@ietf.org.

Acknowledgement

   Funding for the RFC Editor function is provided by the IETF
   Administrative Support Activity (IASA).

Friedl, et al.              Standards Track                    [Page 10]

```


=== Content from raw.githubusercontent.com_ac5fbba2_20250108_141355.html ===
{
"CVE\_data\_meta": {
"ASSIGNER": "cve@mitre.org",
"ID": "CVE-2022-40735",
"STATE": "PUBLIC"
},
"affects": {
"vendor": {
"vendor\_data": [
{
"product": {
"product\_data": [
{
"product\_name": "n/a",
"version": {
"version\_data": [
{
"version\_value": "n/a"
}
]
}
}
]
},
"vendor\_name": "n/a"
}
]
}
},
"data\_format": "MITRE",
"data\_type": "CVE",
"data\_version": "4.0",
"description": {
"description\_data": [
{
"lang": "eng",
"value": "Using long exponents in the Diffie-Hellman Key Agreement Protocol allows remote attackers (from the client side) to trigger unnecessarily expensive server-side DHE modular-exponentiation calculations. An attacker may cause asymmetric resource consumption with any common client application which uses a DHE implementation that applies short exponents. The attack may be more disruptive in cases where a client sends arbitrary numbers that are actually not DH public keys (aka the D(HE)ater attack) or can require a server to select its largest supported key size. The basic attack scenario is that the client must claim that it can only communicate with DHE, and the server must be configured to allow DHE. This can affect TLS, SSH, and IKE."
}
]
},
"problemtype": {
"problemtype\_data": [
{
"description": [
{
"lang": "eng",
"value": "n/a"
}
]
}
]
},
"references": {
"reference\_data": [
{
"url": "https://github.com/mozilla/ssl-config-generator/issues/162",
"refsource": "MISC",
"name": "https://github.com/mozilla/ssl-config-generator/issues/162"
},
{
"refsource": "MISC",
"name": "https://gist.github.com/c0r0n3r/9455ddcab985c50fd1912eabf26e058b",
"url": "https://gist.github.com/c0r0n3r/9455ddcab985c50fd1912eabf26e058b"
},
{
"refsource": "MISC",
"name": "https://link.springer.com/content/pdf/10.1007/3-540-68339-9\_29.pdf",
"url": "https://link.springer.com/content/pdf/10.1007/3-540-68339-9\_29.pdf"
},
{
"refsource": "MISC",
"name": "https://www.researchgate.net/profile/Anton-Stiglic-2/publication/2401745\_Security\_Issues\_in\_the\_Diffie-Hellman\_Key\_Agreement\_Protocol/links/546c144f0cf20dedafd53e7e/Security-Issues-in-the-Diffie-Hellman-Key-Agreement-Protocol.pdf",
"url": "https://www.researchgate.net/profile/Anton-Stiglic-2/publication/2401745\_Security\_Issues\_in\_the\_Diffie-Hellman\_Key\_Agreement\_Protocol/links/546c144f0cf20dedafd53e7e/Security-Issues-in-the-Diffie-Hellman-Key-Agreement-Protocol.pdf"
},
{
"refsource": "MISC",
"name": "https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-57pt1r5.pdf",
"url": "https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-57pt1r5.pdf"
}
]
}
}

=== Content from link.springer.com_a8d1dd2f_20250108_141355.html ===
On Diffie-Hellman Key Agreement
with Short  Exponents

Paul  C. van  Oorschot

Michael J .  Wiener

Bell-Northern  Research,  Box  3511 Station  C
Ottawa, Ontario  KIY 4H7, Canada
{paulv, uiener)Qbnr. ca

A b s t r a c t .   T h e   difficulty  of  computing  discrete  logarithms  known  to
be  “short”  is  examined,  motivated  by  recent  practical  interest  in  using
Diffie-Hellman  key  agreement  with  short  exponents  (e.g.  over  Z,  with
160-bit  exponents  and  1024-bit primes p ) .  A  new  divide-and-conquer  al-
gorithm for discrete logarithms is  presented,  combining  Pollard’s lambda
method with  a partial  Pohlig-Hellman decomposition.  For  random  Diffie-
Hellman  primes  p ,  examination  reveals this  partial  decomposition  itself
allows recovery of short exponents in many cases, while the new technique
dramatically  extends  the  range.  Use  of  subgroups of  large prime  order
precludes  the  attack  at essentially  no cost,  and  is  t h e  recommended  so-
lution.  Using safe primes  also  precludes this particular  attack and allows
improved  exponentiation  performance,  although  parameter  generation
cos;bs are dramatically  higher.

1

Introduction

Diffie-Hellman  key  agreement  [3] allows two  parties  A  and  B  to derive a com-
m o n   secret  by  communications  over  a n   unsecured  channel,  while  sharing  n o
user-specific  keying  material  a  priori.  A  prime p  a n d   element  g  E  2;  of  large
multiplicative order  are  fixed.  A  chooses  a random  integer  z, 1  5  z  5 p  - 2,
a n d  sends to E  the value gz mod p  (hereafter, reduction mod p  is not explicitly
noted).  B  responds by  choosing  a random  y,  1  5 y 5 p  - 2,  and sending to A
t.he  value gy. A  and  B  may then  respect.ively  compute a common secret  key  K
as  K  = (gy)“ and  ii’ = (g2)Y.  Due t.0 t.he intractability of  the discrete logarithm
problem [lo] for appropriate p ,  a n  eavesdropper  is unable to compute z or y from
observation  of  g2 a n d  gy,  and  thus unable to compute  K  in the same manner
as A  or  B .  I t  is  widely  believed  t h a t  computing discrete  logs is  required  for any
party  other than A  or B  to compute K ,  although this remains an open question
[12]. For  protection  from  active adversaries,  the technique must be  augmented;
various authenticated key  agreement protocols  a r e  available  [17].

Regarding appropriate choice of the prime p ,  two issues are size and structure.
Regarding bitsize, taking current  algorithms into account and depending on the
security  requirement,  512  bits  is  typically  specified  as a  minimum,  a n d   1024
bits (or more) is commonly recommended  and generally considered safe for most
applications. Regarding st.ruct.ure, it. is well-known  t h a t  p  m u s t  b e  such t h a t  p -   1

U. Maurer (Ed.): Advances in Cryptology - EUROCRYPT ’96, LNCS 1070, pp. 332-343, 1996.
0 Springer-Verlag Berlin Heidelberg  1996

333

contains a large prime factor, t o  preclude feasibility of the discrete log algorithm
of  Pohlig and  Hellman  [14].

Efficient  implementation  of  Diffie-Hellman  key  agreement  entails  efficient.
modular exponentiation, which  requires  efficient  modular multiplication. For  a
modulus p  of bit,length m ,  mod p  exponentiation with m-bit  exponents using the
basic square-and-multiply method  [7]  requires  about  m  modular squarings and
c  m  (m-bit)  modular  multiplies, where  naively, c = 0.5  (on  average); improvc-
ments  are  possible. Standard  techniques  [2]  for  each  of  (m-bit)  multiplication
mod p and modular reduction  require O ( m 2 )  bit operations.

Diffie-Hellman  is a preferred mechanism for generating ephemeral keys.  Per-
formance issues arise as security considerations demand moduli well beyond 512
bits in some applications. Since the cost of computing gx depends linearly on the
bitlength of  2 ,  ensuing real-time costs have motivated  use of  exponents z of less
than full  (m-bit) length, e.g. for  l g z  as small as 128 o r   160. This  is  somewhat
analogous to the widespread  use  of  short  public  exponents  such  LS  e  = 216 + 1
in  the  RSA  [ZS]  public-key  operation.  Care  is  necessary  to  e n s u r e   such  opti-
mizations do  not  introduce  security  weaknesses.  For  example, precaut.ions are
necessary  in  some applications when  using  e  = 3  in  RSA  [4]: and  using  a  short
RSA private exponent  is  known  to be  insecure  [21].

This paper  examines the security implications of  using short  Diffie-Hellman
exponents.  The major  conclusions are  that  use  of  random  primes p  combined
with short exponents is generally insecure, and t h a t  the use of  large prime-order
subgroups is highly recommended. $2 reviews standard techniques for computing
discrete logs in cyclic groups, including the case of short exponents. 53 presents a
new  method combining Pollard’s lambda method with partial recovery of a secret
exponent  by  a  (partial)  Pohlig-Hellman decomposition, allowing an  alarmingly
effective  attack  when  short  exponents  are  used  and  the  group  in  question  h a s
order n of  arbitrary factorization (e.g.  R = p - 1 for random prime moduli p ) .  $ 4
examines the use  of  short  exponents with  safe primes, while  $5 examines use  of
short exponents  when  computations are  restricted  to  large subgroups  of  prime
order.  Both  techniques, when  used  appropriately, preclude  the  known  at.t.acks:
each  offers  different  advantages.  Safe  primes  may  allow  further  computational
savings during exponentiation if  a generator such  as g  = 2  is used,  while use  of
prime-order  subgroups are dramatically (e.g. more t h a n  an order of  magnitude)
less costly with respect t o  parameter generation (namely p ) .  Much of the discus-
sion  applies t o  exponentiation-based  systems  beyond  Diffie-Hellman, i.e.  more
general discrete logarithm problems.

2  Background  on  Discrete Logarithm Techniques

In  this section,  the  basic  methods  for  cornputsing discrete  logs  i n   cyclic  groiip‘i
are  reviewed:  Shanks’ method,  and  Pollard’s  more  practical  rho  and  lambda
methods.  The  Pohlig-Hellman  decomposition  technique,  of  use  in  conjunction
with  any of  these, is  also reviewed.  Advanced readers  may omit this section.

334

The discrete logarithm problem for cyclic groups is as follows: given  a cyclic
group G of  order n (i.e. having n elements), generator g  E G, and element y  E G,
find z such t.hat. y  = gz. One such group is the multiplicativegroup 2;  of integers
modulo a  prime p: this group  has order  n = p - 1.

Shanks’ method.  Aside from exhaust.ive search, the simplest idea for  solving
this problem  is Shanks’ “baby-st.ep giant-step’’ method 181 (p.9 and 575-576). It
requires  O(n’I2) steps and the same order  of  space,  where  a step is one group
operation.  Define  t  =  [n1/2 1. Compute  ( g * ) i   for  1  5  i  5  t ,  and  store  the
ordered  pair  ( ( s t y ,  i) in  a  table, sorted  by  first  component  (in  constant  time
using  conventional  hashing).  To  find  the  logarithm x, compute y  . gj(=  g ” + j )
for  j  2  0. Stop when  finding  a  j  yielding  a value  stored  in  the  table; this  is
guaranteed for  some j  5 t  - 1. At  this  point, g“  = g z + j ,   implying ti  t + j
(mod n). Then  I = ti - j mod n  is  t.he desired  log. The running  time  is  O ( t )
steps  where  1  =  nr  and  r  =  1/2.  The  algorithm  may  be  generalized  using
CI  5  T  5  1 ,  requiring  a  one-time  precomputation  of  O(nr) time and space, and
a per-logarithm  computation  of  O ( n l + )   time;  r = 0  is exhaustive search, while
T  = 1 is  table  lookup.  For example, T  = 1/3  uses  less  space  and  more time. As
overall time cannot  be reduced  below n1I2 and space is typically more expensive,
T  > 1/2 is not  interesting unless computing  a very  large number of  logarithms.

Pollard rho. In  practice,  Pollard’s  rho  method  for  discrete  logarithms  [15]  is
preferable  t o  Shanks. It has similar square-root  running time (heuristic, whereas
Shanks is  deterministic), but ent,irely avoids the large space  requirement. While
further details are omitted here (as the main focus is the lambda method), it is
noted  t.hat. this  rriemoryless rho  met.hod can  be  parallelized  with  perfect  linear
speedup [20]; that. is, essentially  an r-fold speedup is possible  using  r  processors.

Pollard lambda.  A  lesser-known algorithm due to Pollard, the lambda  method
[15],  more  affectionately  called t.he method  f o r   catching  kangaroos, can  be  used
when  the  pursued  logarithm  x is  known  to  lie  within  a  restricted  interval  of
width  w .  Given  a group  G of  order  n and  known  integers b  and w ,  it finds the
logarithm z of  an element  y  = g“  E G in time O ( W ’ / ~ )  and space for  O(1ogw)
group elements,  provided  it  is guaranteed  that b  < x < b + w .  If x is  not found
on  the  first  iteration,  the  probability  of  which  can  be  controlled,  subsequent
iterations may be  run  as required. The technique  is as follows.

The  method  involves computing  two  sequences  (trails) of  points  T  and  W
(represent,ing paths  travelled  by  t,arne and  wild  kangaroos).  T  computes  the
sequence  do, Y;,  . . . , y;Y ,  where  d+l =
. g f ( Y : )   using  the  “random” function
f(y,!)  whose  output  takes  values  from  a  set  R.  At  the  point  dN, T halts  and
“sets  a trap”  hoping  to  cat.ch W  should  W  land  at  this  point  during its  own
[.rail y  = yo, y1,. . . , Y N ;  t.his will  occur  if  W’s t.rail  hits any  point d .  T h e  tame
trail  begins  at do = g b + w ,   and  proceeds t o  dN. Note  log,(y”)  = log,(y&) 4-  dk,
where  d;Y  = Ciz0 f ( y i )   mod n. The wild trail  begins  a t  yo  = y,  and concludes

”-1

335

when  y~  = y" for some point  YM in  W's trail, at which  point  the logarithm x
of  y is  computed  as x = b + w + d h  - dM  mod n .  If  no collision  y~  = yb occurs
before  dM  exceeds  w + d h ,  t h e  h u n t  is terminated  with  failure (W has  travelled
beyond  the trap). The failure probability  for  a single  iteration  is  controlled  by
parameter  0  (see  below), which  should  be  set  to minimize  the expected  overall
work  (balancing  expected  number  of  iterations and  work  per  iteration).

The  sequences

and  yi  can  be  viewed  as deterministic  paths  which  are
stepped  by  random  values  from  an  integer  set  R of  mean  rn; by  rough  analysis,
each of the N  points in T's trail provides an independent chance with probability
l / m   of  catching  W .  For  0  = N / m  and  m  large,  the  probability  of  success  is
ps  = 1 - (1 - m-l)em zz 1 - e-'.  For optimum performance,  set m = N .  wl/'  for
Q  as optimized below. Then for example, for  6'  = 4, p s  = 0.98  (0 = 1 gives ps =
0.63) and the total  expected  work,  N  + M ,  minimized  by  cy  = 1/4,  is  O ( w ' / ' )
steps. More generally, 2
is the expected  work  given 8, when  minimized  using
Q  = J/(2&)  [15]. Pollard  suggests  computing and storing g 3  for all  s  E  R. used.
and  therefore  choosing  IR,I  <<  wl/'.  R = {2*,  2 l ,  2 2 , .  . , , 2 L - 1 }  is  one suggestion
(for  an appropriate bound  L ) ,  with  f(yi)  = 23  where  j = yi mod  L.

6

Pohlig-Hellman decomposition. Given  the  prime  power  factorization  of  n
(with  q,,  the  largest  prime  divisor),  a divide-and-conquer  technique  known  as
Pohlig-Hellman  decomposition  [14]  can  be  used  to reduce  the  running  time for
each  of the Shanks, rho and lambda methods, by  decomposing  the original  large
discrete  log  problem  into  a number  of  smaller  such  sub-problems.  For  Shanks.
the  reduction  results  in  overall  time  and  space  O ( m ;  for  rho  and  lambda:
the  reduction  is  to  such  time  and  negligible  space.  The original  problem  is  to
find  x ,  given  a group  G  of  order  n (e.g. G  = Z;, R = p  - l ) ,  g, and y  where
y = g z .  This is reduced  to one of finding  c;  discrete  logs  in  a subgroup of  order
q;  for  each  prime  power  qf'  dividing  n. Let  n  = fly=,  qf'  where  q;  < q i + l l   q,
prime.  For simplicit,y, consider  the case  ci  = 1 for  all i (distinct  prime factors);
the technique  is easily generalized.  For  a fixed  i, compute y"/q*  = ( g " / " ) " .   The
result  takes on one of  pi  values,  defining the simpler sub-problem of finding the
discrete logarithm x i   (= x  mod p i )  in a group of  pi  elements generated by  g"/q*.
Once ti is found for all i, the Chinese Remainder Theorem allows solution of the
simultaneous congruences  x  G x i  mod qi , yielding x  mod fl p i ,  which  is z mod  R
as originally desired. The overall complexity is dominated  by  the cost of  finding
2,'  the logarithm for the largest  prime factor q,,  .

C o m p u t i n g  Discrete Logs of Restricted Form.  While sub-exponential  time
index-calculus  techniques  (see  [9])  for  computing  discrete  logarithms in  groups
with additional structure are in general  more powerful  than those of Shanks and
Pollard,  the  latter  are  typically  more  effective  when  the  order  n  of  the  group
factors such that a Pohlig-Hellman decomposition  is  possible, or when the expo-
nent  is small. This paper  restricts  attention  to methods  applicable to arbitrary
cyclic  groups.  For  a cyclic group  G of  order  n  (e.g. n  = p  - 1 for  Z;), it follows
from the discussion  above that:

336

(i)  discrete  logs can  be found in  O(n1I2) time and negligible space; and
( i i )   tirile can  be  reduced  to O ( q ’ / 2 )  if  q  is  t,he largest  prime divisor of  n.

For  an  appropriate bound  B, call  a prime factor  q;  of  n  small  if  q;  < B ,  and
call  R  smooth  (more specifically:  B-smooth)  if  all of its prime factors are small
in  this  sense.  To  be  of  interest,  B  is  chosen  depending  on  the  computational
resourceS  available, and  for  the  present  purposes,  defined  such  t h a t  when  n is
B-smooth,  discrete  logarithms may feasibly be  computed  using  Pohlig-Hellman
decomposition.  For  non-smooth  n, finding  I (given  y  where  y = gz)  appears
difficult for random x of approximate bitlength lgp.’ In the sections listed below,
the following approaches for  constraining the size of exponents  are examined:

$3: restricting  exponents  to random integers z  in the range  [l,w];
$4: using  a safe prime p  = 29 + 1 ( q  prime) along with  the first  option; and
$5: rtrst.rict.iiig computations t.o a subgroup  of  prime order  q  where  q  x  w .

3  Restricting Exponents t o  t h e  Range  [I, w]

Pollard’s lambda met.hod allows exhaction  of  logs with  running  time about, t h e
square-root  of  the  size  of  the  interval  in  question.  The  requirement  of  a  fixed
level  of  security, say  2‘  (i.e.  t  bits), defines  a  (not  necessarily  greatest)  lower
bound  on  the size  of  Diffie-Hellman  exponents.  More  specifically,  if  exponents
are  limited  t o  random  integers  I of  bitlength  w,  this  imposes  the  constraint,
w  2  2 2 1 .  However, if  attacks  better  than  the  basic  square-root  methods exist,
this  bound  on  w  fails to provide  t  bits  of  security.  Indeed,  Lemma2 implies  a
great,er lower bound, resulting  from such  an  improved  attack.

To  explore  the  security  impact of  short  exponents,  consider  the amount of
information  which  may  be  obtained  from  a  Pohlig-Hellman  decomposition  in
this  case  of  short  exponents,  for  a  group  G  of  order  n  (e.g.  n  = p  - 1 for

G = 2;). As previously, assume n = ny=, q;  where q;  < q;+l.  T h e  t a s k  is t o  find
c  given  y  (= gz). For  each  B-smooth prime  factor q i ,  it  is  feasible to  compute
zi = 2 mod q,.  Suppose there  are  r  5 u  such small q;,  Combine these xi using
the  Chinese  Remainder  Theorem to recover  z mod B,  where  B,  = n:=‘=, Qi. If
Br  >  2 ,  this  yields  I itself,  while  for  B,  5  2:  it  yields  k  =  lg(Br)  bits  of
information about  x. T h e  bitlength  of  the product  of  all small prime factors of
n  is  k, and  each  q;  essentially  leaks  lgq;  bits  of  I.  This  raises  two  important
questions.  Let  l g z  = u .

Q l :   For  a raridorn  prime p ,  what  is the expected  number  of  bits k of  3: leaked?
Q2:  1s t.here an attack finding  t,he remaining  u - k bits of  z  in  O ( e )
 time?
( I f  p  leaks k bits  of  x, t  bits of  security  would then  require  l g z  2 2t + k.)
Related to Q1 and of  more direct  practical  interest  is the question: for a random
prime y, with  what  probability  is  z fully  revealed  ( B ,  > z)? Both  this and  & I
depend  on  the size  of  I relative  to the  smoothness  bound  B .  The expectation

1  I (

lg”  is  used  to denote base-2 logarithms;  “ln”  denotes n a t u r a l   logarithms.

337

is  that  k  z 1gB (see  §3.1), and  thus one  may  expect  full  compromise when
lg B, although there  is  considerable variation. Perhaps  more significant  is
Igz
the affirmative answer  to Q 2 ,  using a new  t.echnique  (see  $3.2).

Expected  Size of Product of  Short Factors of p  - 1

3.1
Again  let  B  be  an  upper  bound such that  computing discrete logs is  computa-
tionally  feasible  in  groups  of  prime  order  q  5 B. Consider  first, for  a random
prime modulus p, the expected  bitlength of the product  B,  of  all  “sma11” primes
pi  <  B  which  divide  p - 1. (More  generally, the  question  relates  t o   divisors
of  a group  order  n.) Each  such  prime  contribut.es lgp,  bits  to  k  = Ig B,.!  and
pi  divides a random  number  with  probability  l/p, (refined  further  below). The
expected  bitlength  of  B,  can  thus be  approximated as:

This sum may be further approximated by summing, rather  than over all primes
p;, over  all  integers  i  2 2  weighted  by  the probability  i is  prime  (estimated  as
11 l n i  by the Prime Number Theorem). Then, since C;”=, i-’  z In B ,

A  slight.ly more precise  estimate results by  replxing l/pi  by  l / ( p t  - l ) ,  justified
as follows. Of  interest. is whet.her p%Ip-- 1. Since pi  does not. divide p, p mod p; #
0  and  thus p  - 1 mod pi  #  -1,
leaving  only  p i   - 1 (not  pi) possible  residue
classes. Moreover,  l / ( p i  - 1) may itself  be refined  to pi/(p; - 1)’.  to account  for
divisors p ;  of  higher multiplicity. Numerical summation of t.his refinement. given
in  Lemma 1, supports  the estimate above.  (While such  a result  is  known, and
may be derived rigourously using advanced number theory, a heuristic derivation
from first principles as given  above is considered  appealing.)
Lemma 1.  For a  random prime p and  a fixed  bound  B  (see  above),  the  expected
bitlength k = lg(B,)  of the product  of all prime  divisors p i   5 B  of p  - 1 is

where  C1  x 0.94,  and  C1  < 1.0 f o r  B > 2”.
This answers Q1 (but see also Table 2); note that. k is independent of lgp. Tahle  1
provides supporting  results  for  a small sample of  random  primes  p .  indicating
the average, minimum, and maximum bitlengths of  the product  of  all B-smooth
prime divisors of p -   1. Note the large deviation from the mean, and that values
B in Table 1 are relatively small.

The cryptographic significance of  Lemma 1 is  as follows. An  adversary with
sufficient computational  resources  t o  compute discrete  logs  in  cyclic groups  of
order up to 2s implies B  =: 2’.  One then expects about Ic  = s bits of  a n  exponent
z are leaked  by  a “random” prime  modulus p (revealing  2: entirely  if  l g z  < s).

338

Ig(B,)  for  100 primes p  z 2Io2*

min

max

16.4

B  mean

-
216
232 1  31.3
I  52.1
2"
1 2"
I  65.0

1.0
1 .o
I  2.6
I  2.6
Table  1. Smoothness of p  - 1 relative  to B. B,  = n qr'  where q,  5 B ,  q?lp  - 1.

194.4
I 243.1

112.2

1

47.2

I

3.2  L a m b d a  Method  Restricted  t o  a Strategic Interval

A  new  technique for  cornputing discret,e logs is now presented, which is computa-
t.ionally feasible when  exponents E  are bounded t,o x a 2"  for (in)appropriat,e u .
The t.echnique first. recovers  what  information about. x  may  be obtained  from a
part.ial Pohlig-Hellman decomposition (say I;  bits), and then employs the lambda
method  t o   recover  the  remaining  bits.  The  combined  technique  runs  in  time
0(2("-')/2).  This answers Q2  in  the affirmative.

Let  y  = gz be  a n  element  of  a group  G  of  order  n ,  with  the  usual  task  t o
determine  x. Isolate  the smooth factors of  n and  write  n = zQ  where  z  = B,
(see  33)  is  the  product  of  smooth factors,  and  has  bitlength  approximately  k.
C0mput.e V  where  V  = 2: mod z,  by  a  partial  Pohlig-Hellman decomposition
(see  $ 2 ) .  Write  x = A z  + V ,  where  0  5  V  <  2 wit.h  A  as yet  unknown. Then
y  = gz = g A z + " .   N o w   A  5 x / z  implies sl E  [0,2'],  where  c  x u - k bits  of  z:
remain unknowii after finding V .  Compute 9"  and y*  = y/gv  = g A z   = hA where
h = gz is  known. Consider  the new  problem of  finding the discrete logarithm A
(relative  to  h )  of  y*,  given  y*  and  the base  h  (in  place  of  9 ) .  Use  the lambda
algorit.hm (see 52) to find A .  Using h in place of g here restricts the trail points t o
a subset. of cardinality about 2'.  As required in the lambda method, the log to be
found (here A  in  place of x) is known to lie in a restricted range [b, b+w] = [0,2"]
of width w  = 2'.  The expected  running time t o  find  A  is thus 0").
z  and  V ,  this allows computation of  x = Az + V .

Knowing

An  example  with  concrete  parameters is  given for  clarity.  Let  G = 2;  and
R  = p - 1 with a 1024-bit prime p  and 160-bit 3: (so ec = 160). Suppose E  = 100
hits  of  L  are  recovered  using  Pohlig-Hellnian  (so I g r   z 100). Then  IgA  sz  60
( c   = 60),  and  ahhough h  generabes  a  subgroup of  order  z  21024-100, recovery
of  A  by  the  lambda method  is  feasible, in  0(230) steps, because  A  is  known  to
lie  in  the  interval  A  E  [0,260] of  width  w  = 260. Note  that  while  the  Shanks
met,hod is also easily adapted  to restricted  intervals, it is much more costly t h a n
t.he lambda due to  memory  requirements.  Furt,hermore, t,he rho  method  is  not
feasible - direct use  results  in  running time which  is  square-root  but in  a group
of  cardinality 2924, and adaptations remain far inferior to the lambda method.
In  summary, the technique  allows  an  at.tack on  Diffie-Hellman  (and  similar
exponentiation-based systems) which  has running t.ime (in number of group op-
erat,ions) significantly better  than  square  root  of  the exponent  space size  (e.g.

339

= 2”).  Instead, it is the larger of the square root after this is first. rediirpd
to account  for  leaked  bits recoverable  by  partial  Pohlig-Hellman  decomposition
 = 230), and the square root of the largest  prime factor of  n used
(e.g. d
in  this decomposition. This establishes the following result.

v

Lemma2.  T h e  security  of  discrete  exponentiation in  a  group  of order n uszng

exponents x  w 2u is at  most a . max(u - k ,  Ig(q,))  bits,  where k is the n u m b e r  of
bits  of x  feasibly recoverable  by  a partial  Pohlig-Hellman decomposition  (using a
partial factorization  of  n),  and  qr  i s  t h e   largest  p r i m e  f a c t o r  of R used  therein.

In  other  words, the  running  time  is  O ( m a x ( G ,  6)).
By  Lemrnal. for
G = 2;  with random primes p ,  one expects k = lg B  for a smoothness boiind  B .
At, present, it, seems dangerous t o  assume other  than that an analogous gcn-
era1 result  holds, when  the exponent space is restricted  t o  any arhit.rary set  S  of
cardinality 2”. Related to this, the rho algorithm is adaptable t o  the case  where
exponents  3: are const,rained by  bounding their  Hamming weight. For  example.
Heiman [5] describes how to do so using Shanks’ method  (t,he rho met.hod woiilrl
furthermore remove  memory  requirements).  We  are  aware  of  no  “faster  than
square-root”  method  on  S in  this  case; the  above  combined  method  does  riot.
appear  t o  apply  directly.  Of  related  interest,  Yacobi  [22]  has sketched  a tech-
nique for improving exponentiation performance (saving multiplications but not
squarings) based  on use of  exponents which  are compressible in  the Ziv-Lempel
sense.

Table 2  provides insight  into the  practical  implicat.ions of  Lemma 2. It  waq
constructed  by  generating  100 random  1024-bit primes p  (as per  Table l ) ,  and
partially factoring each  using  an implementation  of  the elliptic curve  factoriza-
tion  method, specifically  tuned  and  run  t o  find prime  factors  up  t,o 85  bits  i n
length  (thus  with  high  probability  extracting  all  80-bit  fackrs). This allowed
determination  of k for  use  in  the attack of  Lemma 2.

Table2  gives  empirical  values  for  the  percentage  of  cases  this  attack  suc-
ceeds  for  exponents  z = 2”,  assuming  attackers  capable  of  2c  total  modular
multiplications (roughly corresponding t o  an ability to take logs in groups of or-
der = 22c).  For  example, for 32% of these 1024-bit  primes, an adversary capable
of  Z40  multiplications mod p  would find  a 160-bit logarithm x .  An  ideal method
accelerating exponentiation  via short  exponents  would have, in  Table 2, for the
best attack, the entry “100%” only for (roughly) u 5 2c,  and  “0%”  for all u > 2c:
this appears t o  be the case for safe primes ($4) and  prime-order subgroups ($5).

adversary
power zc

224

232

2‘0

64

96

81%

100%

100%

45%
68%
84%

exponent  bitlength  u
192

160

128

18%

38%

55%

10%

25%
32%

1%

12%
22%

224

256

0%

2%
7%

0%

1%

2%

Table  2. Sample  success  rate of  discrete log  attack in  2“ steps, for  1024-bit primes

340

Prior  t.o  this  result,  it.  h a s   been  suggest.ed  that, using  a  160-bit exponent  x
provide dO  bits of  security, for  primes p  which  are not  “Pohlig-Hellman weak”.
1 t  IS now  seen  t.hat. even  “partial”  Pohlig-Hellrnan weakness  may  significantly
reduce  at.t-ack tirnes.  Note  the  power  of  the  divide-and-conquer  nature  of  the
attack: if  n  = p - 1  contains, for example, divisors whose bitlengths sum t o  u/2,
a u-bit. logarithm  can  be  recovered  by  determining  u/2  bits  through  a partial
Pohlig-Hellman  decomposition  in 0 ( 2 ” / 4 )  (and  typically  less t h a n  2”14) steps,
and  u / 2  bits through subsequent use of the lambda method  on the appropriate
subproblem  in  a further  O ( 2 ” l 4 )  steps, giving an  overall cost of  0(2”/4)  steps.
Previously, the best  attack would require the minimum of the time to run either
Pohlig-Hellrnan or  a square-root method on the entire problem, i.e. 0 ( 2 ” / ‘ ) .

4  Use  of  Short  Exponents with  Safe  Primes

Prior uncert,aint,y about the securit.y implications of using arbitrary prime moduli
p  with  short  exponents  T has  motivated  (e.g. [6,  11)  the use  of  sale  p r i m e s  p ,
of  t.he  form  p  =  2q + 1  where  q  is  also  prime.  This  precludes  the  attack  of
Lemma 2  because  a partial  Pohlig-Hellman  decomposition yields  only  a single
bit, of  information about an exponent  x. Against this  attack, it  appears safe to
use  exponents  x zz  2”,  with  u = 2t  determined  such  that  0(2$) operations  are
cornputationally infeasible (perhaps t = 80 for commercial security).

It, should  be  emphasized,  however, that, when  using  short  exponents,  it  is
n o t   f h c  s z n g l p   v e r y  large prame  q  that  provides protection  against  L e m m a   2, but,
rat.her that, t.he t.ot,al bit.lengt,h of smooth factors is k = 1; t,his differs significantly
fronr  t,he sit,uat,ion for  an  ordinary  Pohlig-Hellman att.ack  against  a full-length
exporient.. For  example, p  = Rq + 1 with q  very  large and  R relatively small, e.g.
Ig R = T  = 20  bits, nonetheless  leaks 20  bits of  information about a n  exponent
T  (of bitlengbh  2t  say). This reduces  securit.y from t  t,o t - ( r / 2 )  bits, which  for
short. exponents  (t small) may bring an  attack  per  Lemma 2 within  range.

An advantage of using safe primes p  = 2 q  + 1 is that all group elements of Z;
other  than f l  are then  known t o  have order  either q  or 2q. Consequently g = 2
is known  to be a generator  for the full group of  29  elements if  2  is  a quadratic
non-residue mod p  (in this case one bit of a logarithm z is available by  a partial
Pohlig-Hellman decomposition), and a generator for the subgroup of q  elements
when 2  is  a quadratic residue (in this case, g  = 2 does not leak even one bit).2 In
modular exponentiation using base g = 2, the cost. of the modular multiplies (but
not. squarings) effectively  disappears. Ordinarily, multiplies are more costly than
squatings,  ahhough  the  number  of  multiplies is  substantially  less.  In  efficient
implement.at.ions, this number is reduced further. All points considered, one may
expect  use  of  g  = 2  to result, in  modular exponentiation performance improved
by  20% overall, vs.  an arbitrary  generator  9 .  As the main motivation for  use  of
short exponents  i s  improved performance, this is significant.

A  more important  point  is  t h a t   use  of  a generator  for  the subgroup of  order  p corre-
sponds  to a  prime-order  subgroup as per  $ 5  (albeit  t h e  maximal  proper  subgroup),
which  avoids t h e  attack detailed  in  the last  paragraph  of  54.

341

One drawback, however, is the computational cost of finding safe primes. A n
obvious (but inefficient.) method to find an n - b i t  safe prime p  is  t c i   generat.e a n d
search some space of candidate primes q  = p i  of m -   1 bits, verify t.hat. q is prime,
and  then  verify  the candidate p ;   = 2qi + 1 is  also  prime.  While  the  densit.y  of
primes  in  search  sequences  2q, + 1 differs  somewhat  from  that. of  the  density
of  primes  among  all  integers,  the  latter  is  1/ l n p  (e.g.  1 in  710  zz  In 2'"?4 for
1024-bit  integers).  A  standard  optimization is  to filter  candidate  primes  using
small-prime sieve techniques.  But  even  advanced  techniques  require some form
of  double search,  generating many primes  pi  before  a safe prime p  emerges.  In
contrast,  the  cost  of  parameter  generation  in  t h e   alternative  of  using  prime-
order subgroups ($5) is essentially that of generating a single candidate 1024-bit
prime. Use  of  safe primes thus appears t o  introduce a substantial penalty, with
parameter generation t.ime increased by  a factor roughly equal t.0 t.he number of
trials  required  t.o generat,e an  m - 1 bit  prime qi.

A  drawback  of  more  general  concern  for  basic  forms of  Difie-Hellman  key
agreement  is  a  potentially  fatal  protocol  attack  (rather  than  an  algorithmic
at,tack on  exponent.iation  itself)  which,  although  observed  by  others  (includ-
ing  S. Vanstone),  appears  to  not  yet  be  widely  recognized. T h e  at.tack  applies
also  for  safe  primes,  except  when  the  large  prime-order  subgroup  thereof  is
used  (as  noted  above).  Note  that  if  (Y  generates  2,.  where  p  = 2q + 1,  then
/3  = crQ = crb-1)/2 = -1  is  an  element of  order  2. If  A  and  B  respectively send
each  other  unauthenticated  ephemeral  exponentials  az and  cry  (as in  §1), a n
active intruder may substitute (a")Q for the first, and ( ( Y Y ) ~  for the second. The
shared key computed by both parties is then  K = a z Y q   = /Y, which  is +1  or  -1
depending on the parity of zy. (The attack generalizes directly for p  = Rq+  1 .  in
which  case  Ii'  takes on  one of  R values from t,he group of  order  R. generatd  hy
p = aq; for  appropriately small R, Ii' may thus be  easily  found  by  the  intruder
by exhaustive trial.) This again motivates the use of prime-order subgroups ( i 5 ) .

5  Restricting Computations to  Prime-order Subgroups

To meet the objective of improved running time through use of short exponents,
the recommended  alternative is  t o  employ  an idea  used  in  Schnorr's  signature
scheme [18] and in DSA [19], to guarantee t h a t  computations are carried out in a
large subgroup of cardinality q x  2"  where q  is prime ( a  prime-order  subgroup).
For  t  bits  of  security, set  u  = 2t  (e.g.  u = 160  is  used  in  DSA).  If  g  E  Z i   is
a  generator,  and  q  divides  p  - 1,  then  = g(P-')/q  generates  a subgroup  of
order  q .  Using /3  in  place of g as a base for exponentiation, all exponents I may
be  reduced  modulo q .   Such  an  element /3  of  order  q  may  be  found  as  follows.
Select  a random  element h E  Zp'  and  compute /3  = h ( p - l ) / q ;   repeat  until  /3  #  1 .
(While it suffices  to first  find  a generator g  and  then  use  g  = h  w i t h   guarantwd
success, finding such  a g  is  not  mandatory, and moreover  requires knowledge  of
the factorization  of p  - 1 .)

T h e  expected number of repetitions to find @  # 1 is q / ( q -   1) z 1, established
as follows. A  trial fails if the order of  h divides Q = ( p  - l ) / q ;   otherwise h(P-')/q

342

h a s  order  q  (success).  Since exactly Q elements  have order  which  divides Q ,  the
proportioil  of  eler1rent.s h  which  fails is Q / ( p  - 1) = l / q .
The  use of prime-order  subgroups is by  far preferable  t o  using random primes
($3) and  at,ternpt.ing to  increase  the  exponent.  bitlength  from  2t  to  25  + i!’
t o
compensate  for  divisors  of  p  - 1. The  latter  not  only  increases  exponentiation
t.iiire? but. arr  appropriate  value  of  1’  varies  with  p ,  can  only  be  determined  with
cert.ainty  by  factoring y - 1, and  with  small  probability  may  be  quite  large.
The use of prime-order  subgroups has the advantage over safe primes that prime
generation does not require guaranteeing a large prime divisor q = (p- 1)/2; only
a prime  divisor  q  x  221 is  required.  Since typically 25  <( l g p  (e.g.  160 vs.  1024),
t.he cost. of constructing, by  well-known techniques  [13], a primep such t h a t  p -  1
has a 2t-bit prime divisor  q  is little more than for finding a random prime p .  In
addition, the use of  prime-order  subgroups  precludes  the att,ack discussed  in  the
lajt  paragraph  of  $4.

6  Concluding  Remarks

,411 houglr  the  details differ,  Pollard’s lambda method  can  be  parallelized  analo-
gously  t,o t,he rho  method  (201.  Thus all  aspects  of  the short-exponent  discrete
log attack of  Lemma 2 can be parallelized, and the task  can  be distributed  over
large collections  of  computing platforms (111 , with small memory requirements.
For  a security  requirement  o f t  bits when  using secret  exponents  x in  Diffie-
Hellman  exponentiation  (mod p )  and  similar  systems, use  of  random  primes  p
t,oget,her with  Igz = u  is  clearly  insecure  for  u  = 2t  (and even  larger).  Suscep-
t.ibi1it.y 60  at,t.acks based  on  a partial  Pohlig-Hellman  decomposition  (stemming
from divisors of p - 1) is significant, when  using short exponents 2. In  this case,
random  primes  y  should  not  be  used.

The resulk  herein  firmly  establish that some measure  must  be  taken  to en-
sure securit,y is  preserved  when  using  short  exponents  for  Diffie-Hellman  expo-
irent.iat.ion. Aside  from  precluding  strict  Pohlig-Hellman  attacks,  this  require-
ment  was  hitherto  folklore,  which  has  nonetheless  apparently  helped  motivate
the  use  of  safe  primes  in  practical  protocols  such  as Photuris  [S]  and  SKIP
[l]. We  are  aware  of  no  effective  attacks  against  the  combined  use  of  (appro-
priately)  short  exponents  with  computations restricted  t o   (sufficiently)  large
prime-order  subgroups.  Use of  prime-order  subgroups  allows more efficient gen-
eration  of  ephemeral  Diffie-Hellman  parameters. In  contrast, finding safe primes
p  irit.roduces considerable  expense,  although pre-computing  a safe prime off-line
and  using  g  = 2  as a base  allows  improved  real-time  performance.  However,  in
this case, it, is recomirrerided t,hat the safe prime be one for which g = 2 generates
a large  prinie-order  subgroup  as well.

References

1 .   A .  Aziz,  “Simple  Key  Management  for Internet  Protocols  (SKIP)”, Internet  Draft

(work in  progress), draft-ietf-ipsec-skipO-i.txt, November  1995.

343

2.  A.  Bosselaers,  R. Govaerts,  J. Vandewalle,  “Comparison  of  three  modular  reduc-

tion  functions”,  Crypto’93, Springer-Verlag  LNCS  773, pp.175-176.

3.  W.  Diffie,  M.  Hellman,  “New  directions  in  cryptography”,  IEEE  IT-22  (1976)

pp.644-654.

4.  J.  Hastad,  “On using  RSA with  low exponent in  a public-key  network”.  Crypfn’X.5.

Springer-Verlag  LNCS 218,  pp.403-408.

5.  R.  Heiman,  “A  note on discrete  logarithms with  special  structure“,  Eurocrypl‘S1,

Springer-Verlag  LNCS 658, pp.454-457.

6.  P. Karn, W.A.  Simpson,  “The Photuris session  key  management. prot.ocol”. Inter-

net  Draft  (work in  progress),  draft-ietf-ipsec-photuris-06.txt., Oct,obrr 1995.

7.  D.E.  Knuth,  The A r t  of  Computer Programming, vo1.2: Seminumerical Algorithms,

2nd  edition,  Addison-Wesley,  1981.

8.  D.E.  Knuth,  The  A r t   of  Computer  Programming,  ~01.3: Sorting  and  Searching,

Addison-Wesley,  1973.

9.  B.A.  LaMacchia,  A.M.  Odlyzko,  “Computation  of  discrete  logarithms  in  prime

fields”,  Designs,  Codes  and  Cryptography, vol.1  no.]  (May  1991), pp.47-62.

10.  K.S.  McCurley,  “The  discrete  logarithm  problem”,  pp.49-74  in:  Cryptology  and
Computational Number  Theory - Proc.  Symp. Applied Math., vol. 42  (1990). A M S .
11.  A.K.  Lenstra,  M.S.  Manasse,  “Factoring  by  electronic  mail”,  Eurocrypf ’89.

Springer-Verlag  LNCS 434,  pp.355-371.

12.  U.M.  Maurer,  “Towards  the  equivalence  of  breaking  th e  Diffie-Hellman  proto-
col  and  computing  discrete  logarithms”.  Crypto ’94, Springer-VFrlag  LYCS  839.
pp.271-281.

13.  U.M.  Maurer,  “Fast Generation  of  Prime  Numbers and  Secure  Public-Key  Cryp-

tographic  Parameters”,  J. Cryptology, vo1.8  no.3  (1995),  123-156.

14.  S.C. Pohlig, M.E.  Hellman,  “An improved algorithm for computing logarithms over
G F ( p )  and  its cryptographic significance”, IEEE  Trans. Information Theory, vol.
IT-24, no.1  (Jan. 1978), pp.106-110.

15.  J.M.  Pollard,  “Monte  Carlo  methods  for  index  computation  (mod  p)”:  Math.

Comp., vo1.32  no.143  (July  1978) pp.918-924.

16. R.L.  Rivest,  A.  Shamir, L.  Adleman,  “A  method  for  obtaining  digital  signatures
and  public  key cryptosystems”,  C.ACM, v01.21  no.2  (Feb.  1978), pp.120-126.
17.  R.  Rueppel,  P.C.  van  Oorschot,  “Modern  key  agreement  techniques”,  Computer

Communications, vo1.17  no.7  (July  1994), pp.458-465.

18.  C.P. Schnorr,  “Efficient  signature generation  by  sma rt cards”,  J .   Cryptology ~ 0 1 . 4

(1991), pp.161-174.

19.  U.S. Department of  Commerce / N.I.S.T., Digital  Signature  Standard,  FIPS  186,

National Technical  Information  Service,  Springfield,  Virginia,  May  1994.

20.  P.C.  van Oorschot,  M.J.  Wiener,  “Parallel collision  search with application to  hash
functions  and discrete logarithms”,  Proc.  2nd ACM  Conference on  Computer and
Communications Security (Nov.  1994), Fairfax, VA,  pp.210-218.

21.  M.J. Wiener,  “Cryptanalysis  of short RSA secret exponents”, IEEE Trans. on Info.

Theory, voI.36  no.3  (May  1990), pp.553-558.

22.  Y.  Yacobi,  “Discrete-log with  compressible  exponents”,  Crypto ’90, Springer-Verlag

LNCS  537,  pp.639-643.



=== Content from www.rfc-editor.org_22de929e_20250108_141356.html ===

[[RFC Home](https://www.rfc-editor.org "RFC Editor")] [[TEXT](/rfc/rfc5114.txt)|[PDF](/rfc/pdfrfc/rfc5114.txt.pdf)|[HTML](/rfc/rfc5114.html)] [[Tracker](https://datatracker.ietf.org/doc/rfc5114 "IETF Datatracker information for this document")] [[IPR](https://datatracker.ietf.org/ipr/search/?rfc=5114&submit=rfc "IPR disclosures related to this document")] [[Info page](https://www.rfc-editor.org/info/rfc5114 "Info page")]

 INFORMATIONAL

```
Network Working Group                                        M. Lepinski
Request for Comments: 5114                                       S. Kent
Category: Informational                                 BBN Technologies
                                                            January 2008

     Additional Diffie-Hellman Groups for Use with IETF Standards

Status of This Memo

   This memo provides information for the Internet community.  It does
   not specify an Internet standard of any kind.  Distribution of this
   memo is unlimited.

Abstract

   This document describes eight Diffie-Hellman groups that can be used
   in conjunction with IETF protocols to provide security for Internet
   communications.  The groups allow implementers to use the same groups
   with a variety of security protocols, e.g., SMIME, Secure SHell
   (SSH), Transport Layer Security (TLS), and Internet Key Exchange
   (IKE).

   All of these groups comply in form and structure with relevant
   standards from ISO, ANSI, NIST, and the IEEE.  These groups are
   compatible with all IETF standards that make use of Diffie-Hellman or
   Elliptic Curve Diffie-Hellman cryptography.

   These groups and the associated test data are defined by NIST on
   their web site [[EX80056A](#ref-EX80056A "\"Examples for NIST 800-56A,\"")], but have not yet (as of this writing) been
   published in a formal NIST document.  Publication of these groups and
   associated test data, as well as describing how to use Diffie-Hellman
   and Elliptic Curve Diffie-Hellman for key agreement in all of the
   protocols cited below, in one RFC, will facilitate development of
   interoperable implementations and support the Federal Information
   Processing Standard (FIPS) validation of implementations that make
   use of these groups.

Lepinski & Kent              Informational                      [Page 1]
```

---

```

[RFC 5114](./rfc5114)            Additional Diffie-Hellman Groups        January 2008

Table of Contents

   [1](#section-1). Introduction ....................................................[2](#page-2)
   [2](#section-2). Additional Diffie-Hellman Groups ................................[4](#page-4)
      [2.1](#section-2.1). 1024-bit MODP Group with 160-bit Prime Order Subgroup ......[4](#page-4)
      [2.2](#section-2.2). 2048-bit MODP Group with 224-bit Prime Order Subgroup ......[4](#page-4)
      [2.3](#section-2.3). 2048-bit MODP Group with 256-bit Prime Order Subgroup ......[5](#page-5)
      [2.4](#section-2.4). 192-bit Random ECP Group ...................................[6](#page-6)
      [2.5](#section-2.5). 224-bit Random ECP Group ...................................[7](#page-7)
      [2.6](#section-2.6). 256-bit Random ECP Group ...................................[7](#page-7)
      [2.7](#section-2.7). 384-bit Random ECP Group ...................................[8](#page-8)
      [2.8](#section-2.8). 521-bit Random ECP Group ...................................[9](#page-9)
   [3](#section-3). Using These Groups with IETF Standards ..........................[9](#page-9)
      [3.1](#section-3.1). X.509 Certificates .........................................[9](#page-9)
      [3.2](#section-3.2). IKE .......................................................[10](#page-10)
      [3.3](#section-3.3). TLS .......................................................[10](#page-10)
      [3.4](#section-3.4). SSH .......................................................[11](#page-11)
      [3.5](#section-3.5). SMIME .....................................................[11](#page-11)
   [4](#section-4). Security Considerations ........................................[12](#page-12)
   [5](#section-5). IANA Considerations ............................................[13](#page-13)
   [6](#section-6). Acknowledgments ................................................[13](#page-13)
   [Appendix A](#appendix-A): Test Data .............................................[14](#page-14)
      [A.1](#appendix-A.1). 1024-bit MODP Group with 160-bit Prime Order Subgroup......[15](#page-15)
      [A.2](#appendix-A.2). 2048-bit MODP Group with 224-bit Prime Order Subgroup......[15](#page-15)
      [A.3](#appendix-A.3). 2048-bit MODP Group with 256-bit Prime Order Subgroup......[16](#page-16)
      [A.4](#appendix-A.4). 192-bit Random ECP Group ..................................[17](#page-17)
      [A.5](#appendix-A.5). 224-bit Random ECP Group ..................................[18](#page-18)
      [A.6](#appendix-A.6). 256-bit Random ECP Group ..................................[18](#page-18)
      [A.7](#appendix-A.7). 384-bit Random ECP Group ..................................[19](#page-19)
      [A.8](#appendix-A.8). 521-bit Random ECP Group ..................................[19](#page-19)
   Normative References ..............................................[20](#page-20)
   Informative References ............................................[20](#page-20)

[1](#section-1).  Introduction

   This document provides parameters and test data for several
   Diffie-Hellman (D-H) groups that can be used with IETF protocols that
   employ D-H keys, (e.g., IKE, TLS, SSH, and SMIME) and with IETF
   standards, such as Public Key Infrastructure for X.509 Certificates
   (PKIX) (for certificates that carry D-H keys).  These groups
   complement others already documented for the IETF, including the
   "Oakley" groups defined in [RFC 2409](./rfc2409) [[RFC2409](./rfc2409 "\"The Internet Key Exchange (IKE)\"")] for use with IKEv1, and
   several additional D-H groups defined later, e.g., [[RFC3526](./rfc3526 "\"More Modular Exponential (MODP) Diffie-Hellman groups for Internet Key Exchange (IKE)\"")] and
   [[RFC4492](./rfc4492 "\"Elliptic Curve Cryptography (ECC) Cipher Suites for Transport Layer Security (TLS)\"")].

Lepinski & Kent              Informational                      [Page 2]
```

---

```

[RFC 5114](./rfc5114)            Additional Diffie-Hellman Groups        January 2008

   The initial impetus for the definition of D-H groups (in the IETF)
   arose in the IPsec (IKE) context, because of the use of an ephemeral,
   unauthenticated D-H exchange as the starting point for that protocol.
   [RFC 2409](./rfc2409) defined five standard Oakley Groups: three modular
   exponentiation groups and two elliptic curve groups over GF[2^N].
   One modular exponentiation group (768 bits - Oakley Group 1) was
   declared to be mandatory for all IKEv1 implementations to support,
   while the other four were optional.  Sixteen additional groups
   subsequently have been defined and registered with IANA for use with
   IKEv1, including eight that have also been registered for use with
   IKEv2.  All of these additional groups are optional in the IKE
   context.  Of the twenty-one groups defined so far for use with IKE,
   eight are MODP groups (exponentiation groups modulo a prime), ten are
   EC2N groups (elliptic curve groups over GF[2^N]), and three are ECP
   groups (elliptic curve groups over GF[P]).

   The purpose of this document is to provide the parameters and test
   data for eight additional groups, in a format consistent with
   existing RFCs along with instructions on how these groups can be used
   with IETF protocols such as SMIME, SSH, TLS, and IKE.  Three of these
   groups were previously specified for use with IKE [[RFC4753](./rfc4753 "\"ECP Groups For IKE and IKEv2\"")], and five
   of these groups were previously specified for use with TLS [[RFC4492](./rfc4492 "\"Elliptic Curve Cryptography (ECC) Cipher Suites for Transport Layer Security (TLS)\"")].
   (The latter document does not provide or reference test data for the
   specified groups).  By combining the specification of all eight
   groups with test data and instructions for use in a variety of
   protocols, this document serves as a resource for implementers who
   may wish to offer the same Diffie-Hellman groups for use with
   multiple IETF protocols.

   All of these groups are compatible with applicable ISO [[ISO-14888-3](#ref-ISO-14888-3 "ISO/IEC 14888-3:2006")],
   ANSI [[X9.62](#ref-X9.62)], and NIST [[NIST80056A](#ref-NIST80056A "\"Recommendation for Pair-Wise Key Establishment Schemes Using Discrete Logarithm Cryptography,\"")] standards for Diffie-Hellman key
   exchange.  These groups and the associated test data are defined by
   NIST on their web site [[EX80056A](#ref-EX80056A "\"Examples for NIST 800-56A,\"")], but have not yet (as of this
   writing) been published in a formal NIST document.  Publication of
   these groups with associated test data as an RFC will facilitate
   development of interoperable implementations and support FIPS
   validation of implementations that make use of these groups.

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in [RFC 2119](./rfc2119) [[RFC2119](./rfc2119 "\"Key words for use in RFCs to Indicate Requirement Levels\"")].

Lepinski & Kent              Informational                      [Page 3]
```

---

```

[RFC 5114](./rfc5114)            Additional Diffie-Hellman Groups        January 2008

[2](#section-2).  Additional Diffie-Hellman Groups

   This section contains the specification for eight groups for use in
   IKE, TLS, SSH, etc.  There are three standard prime modulus groups
   and five elliptic curve groups.  All groups were taken from
   publications of the National Institute of Standards and Technology,
   specifically [[DSS](#ref-DSS "FIPS PUB 186-2")] and [[NIST80056A](#ref-NIST80056A "\"Recommendation for Pair-Wise Key Establishment Schemes Using Discrete Logarithm Cryptography,\"")].  Test data for each group is
   provided in [Appendix A](#appendix-A).

[2.1](#section-2.1).  1024-bit MODP Group with 160-bit Prime Order Subgroup

   The hexadecimal value of the prime is:

   p = B10B8F96 A080E01D DE92DE5E AE5D54EC 52C99FBC FB06A3C6
       9A6A9DCA 52D23B61 6073E286 75A23D18 9838EF1E 2EE652C0
       13ECB4AE A9061123 24975C3C D49B83BF ACCBDD7D 90C4BD70
       98488E9C 219A7372 4EFFD6FA E5644738 FAA31A4F F55BCCC0
       A151AF5F 0DC8B4BD 45BF37DF 365C1A65 E68CFDA7 6D4DA708
       DF1FB2BC 2E4A4371

   The hexadecimal value of the generator is:

   g = A4D1CBD5 C3FD3412 6765A442 EFB99905 F8104DD2 58AC507F
       D6406CFF 14266D31 266FEA1E 5C41564B 777E690F 5504F213
       160217B4 B01B886A 5E91547F 9E2749F4 D7FBD7D3 B9A92EE1
       909D0D22 63F80A76 A6A24C08 7A091F53 1DBF0A01 69B6A28A
       D662A4D1 8E73AFA3 2D779D59 18D08BC8 858F4DCE F97C2A24
       855E6EEB 22B3B2E5

   The generator generates a prime-order subgroup of size:

   q = F518AA87 81A8DF27 8ABA4E7D 64B7CB9D 49462353

[2.2](#section-2.2).  2048-bit MODP Group with 224-bit Prime Order Subgroup

   The hexadecimal value of the prime is:

   p =  AD107E1E 9123A9D0 D660FAA7 9559C51F A20D64E5 683B9FD1
        B54B1597 B61D0A75 E6FA141D F95A56DB AF9A3C40 7BA1DF15
        EB3D688A 309C180E 1DE6B85A 1274A0A6 6D3F8152 AD6AC212
        9037C9ED EFDA4DF8 D91E8FEF 55B7394B 7AD5B7D0 B6C12207
        C9F98D11 ED34DBF6 C6BA0B2C 8BBC27BE 6A00E0A0 B9C49708
        B3BF8A31 70918836 81286130 BC8985DB 1602E714 415D9330
        278273C7 DE31EFDC 7310F712 1FD5A074 15987D9A DC0A486D
        CDF93ACC 44328387 315D75E1 98C641A4 80CD86A1 B9E587E8
        BE60E69C C928B2B9 C52172E4 13042E9B 23F10B0E 16E79763
        C9B53DCF 4BA80A29 E3FB73C1 6B8E75B9 7EF363E2 FFA31F71
        CF9DE538 4E71B81C 0AC4DFFE 0C10E64F

Lepinski & Kent              Informational                      [Page 4]
```

---

```

[RFC 5114](./rfc5114)            Additional Diffie-Hellman Groups        January 2008

   The hexadecimal value of the generator is:

   g =  AC4032EF 4F2D9AE3 9DF30B5C 8FFDAC50 6CDEBE7B 89998CAF
        74866A08 CFE4FFE3 A6824A4E 10B9A6F0 DD921F01 A70C4AFA
        AB739D77 00C29F52 C57DB17C 620A8652 BE5E9001 A8D66AD7
        C1766910 1999024A F4D02727 5AC1348B B8A762D0 521BC98A
        E2471504 22EA1ED4 09939D54 DA7460CD B5F6C6B2 50717CBE
        F180EB34 118E98D1 19529A45 D6F83456 6E3025E3 16A330EF
        BB77A86F 0C1AB15B 051AE3D4 28C8F8AC B70A8137 150B8EEB
        10E183ED D19963DD D9E263E4 770589EF 6AA21E7F 5F2FF381
        B539CCE3 409D13CD 566AFBB4 8D6C0191 81E1BCFE 94B30269
        EDFE72FE 9B6AA4BD 7B5A0F1C 71CFFF4C 19C418E1 F6EC0179
        81BC087F 2A7065B3 84B890D3 191F2BFA

   The generator generates a prime-order subgroup of size:

   q =  801C0D34 C58D93FE 99717710 1F80535A 4738CEBC BF389A99
        B36371EB

[2.3](#section-2.3).  2048-bit MODP Group with 256-bit Prime Order Subgroup

   The hexadecimal value of the prime is:

   p = 87A8E61D B4B6663C FFBBD19C 65195999 8CEEF608 660DD0F2
       5D2CEED4 435E3B00 E00DF8F1 D61957D4 FAF7DF45 61B2AA30
       16C3D911 34096FAA 3BF4296D 830E9A7C 209E0C64 97517ABD
       5A8A9D30 6BCF67ED 91F9E672 5B4758C0 22E0B1EF 4275BF7B
       6C5BFC11 D45F9088 B941F54E B1E59BB8 BC39A0BF 12307F5C
       4FDB70C5 81B23F76 B63ACAE1 CAA6B790 2D525267 35488A0E
       F13C6D9A 51BFA4AB 3AD83477 96524D8E F6A167B5 A41825D9
       67E144E5 14056425 1CCACB83 E6B486F6 B3CA3F79 71506026
       C0B857F6 89962856 DED4010A BD0BE621 C3A3960A 54E710C3
       75F26375 D7014103 A4B54330 C198AF12 6116D227 6E11715F
       693877FA D7EF09CA DB094AE9 1E1A1597

Lepinski & Kent              Informational                      [Page 5]
```

---

```

[RFC 5114](./rfc5114)            Additional Diffie-Hellman Groups        January 2008

   The hexadecimal value of the generator is:

   g = 3FB32C9B 73134D0B 2E775066 60EDBD48 4CA7B18F 21EF2054
       07F4793A 1A0BA125 10DBC150 77BE463F FF4FED4A AC0BB555
       BE3A6C1B 0C6B47B1 BC3773BF 7E8C6F62 901228F8 C28CBB18
       A55AE313 41000A65 0196F931 C77A57F2 DDF463E5 E9EC144B
       777DE62A AAB8A862 8AC376D2 82D6ED38 64E67982 428EBC83
       1D14348F 6F2F9193 B5045AF2 767164E1 DFC967C1 FB3F2E55
       A4BD1BFF E83B9C80 D052B985 D182EA0A DB2A3B73 13D3FE14
       C8484B1E 052588B9 B7D2BBD2 DF016199 ECD06E15 57CD0915
       B3353BBB 64E0EC37 7FD02837 0DF92B52 C7891428 CDC67EB6
       184B523D 1DB246C3 2F630784 90F00EF8 D647D148 D4795451
       5E2327CF EF98C582 664B4C0F 6CC41659

   The generator generates a prime-order subgroup of size:

   q = 8CF83642 A709A097 B4479976 40129DA2 99B1A47D 1EB3750B
       A308B0FE 64F5FBD3

[2.4](#section-2.4).  192-bit Random ECP Group

   The curve is based on the integers modulo the prime p given by:
      p = 2^(192) - 2^(64) - 1

   Group prime (in hexadecimal):
      p = FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFE FFFFFFFF FFFFFFFF

   The equation for the elliptic curve is:
      y^2 = x^3 + ax + b (mod p)

   Group curve parameter A (in hexadecimal):
      a = FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFE FFFFFFFF FFFFFFFC

   Group curve parameter B (in hexadecimal):
      b = 64210519 E59C80E7 0FA7E9AB 72243049 FEB8DEEC C146B9B1

   The generator for this group is given by: g=(gx,gy) where

      gx = 188DA80E B03090F6 7CBF20EB 43A18800 F4FF0AFD 82FF1012

      gy = 07192B95 FFC8DA78 631011ED 6B24CDD5 73F977A1 1E794811

   Group order (in hexadecimal):
      n = FFFFFFFF FFFFFFFF FFFFFFFF 99DEF836 146BC9B1 B4D22831

Lepinski & Kent              Informational                      [Page 6]
```

---

```

[RFC 5114](./rfc5114)            Additional Diffie-Hellman Groups        January 2008

[2.5](#section-2.5).  224-bit Random ECP Group

   The curve is based on the integers modulo the prime p given by:
      p = 2^(224) - 2^(96) + 1

   Group prime (in hexadecimal):
      p = FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF 00000000 00000000
          00000001

   The equation for the elliptic curve is:
      y^2 = x^3 + ax + b (mod p)

   Group curve parameter A (in hexadecimal):
      a = FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFE FFFFFFFF FFFFFFFF
          FFFFFFFE

   Group curve parameter B (in hexadecimal):
      b = B4050A85 0C04B3AB F5413256 5044B0B7 D7BFD8BA 270B3943
          2355FFB4

   The generator for this group is given by: g=(gx,gy) where

      gx = B70E0CBD 6BB4BF7F 321390B9 4A03C1D3 56C21122 343280D6
           115C1D21

      gy = BD376388 B5F723FB 4C22DFE6 CD4375A0 5A074764 44D58199
           85007E34

   Group Order (in hexadecimal):
      n = FFFFFFFF FFFFFFFF FFFFFFFF FFFF16A2 E0B8F03E 13DD2945
          5C5C2A3D

[2.6](#section-2.6).  256-bit Random ECP Group

   The curve is based on the integers modulo the prime p given by:
      p = 2^(256)-2^(224)+2^(192)+2^(96)-1

   Group prime (in hexadecimal):
      p = FFFFFFFF 00000001 00000000 00000000 00000000 FFFFFFFF
          FFFFFFFF FFFFFFFF

   The equation for the elliptic curve is:
      y^2 = x^3 + ax + b (mod p)

   Group curve parameter A (in hexadecimal):
      a = FFFFFFFF 00000001 00000000 00000000 00000000 FFFFFFFF
          FFFFFFFF FFFFFFFC

Lepinski & Kent              Informational                      [Page 7]
```

---

```

[RFC 5114](./rfc5114)            Additional Diffie-Hellman Groups        January 2008

   Group curve parameter B (in hexadecimal):
      b = 5AC635D8 AA3A93E7 B3EBBD55 769886BC 651D06B0 CC53B0F6
          3BCE3C3E 27D2604B

   The generator for this group is given by: g=(gx,gy) where

      gx = 6B17D1F2 E12C4247 F8BCE6E5 63A440F2 77037D81 2DEB33A0
           F4A13945 D898C296

      gy = 4FE342E2 FE1A7F9B 8EE7EB4A 7C0F9E16 2BCE3357 6B315ECE
           CBB64068 37BF51F5

   Group Order (in hexadecimal):
      n = FFFFFFFF 00000000 FFFFFFFF FFFFFFFF BCE6FAAD A7179E84
          F3B9CAC2 FC632551

[2.7](#section-2.7).  384-bit Random ECP Group

   The curve is based on the integers modulo the prime p given by:
      p = 2^(384)-2^(128)-2^(96)+2^(32)-1

   Group prime (in hexadecimal):
      p = FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF
          FFFFFFFF FFFFFFFE FFFFFFFF 00000000 00000000 FFFFFFFF

   The equation for the elliptic curve is:
      y^2 = x^3 + ax + b (mod p)

   Group curve parameter A (in hexadecimal):
      a = FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF
          FFFFFFFF FFFFFFFE FFFFFFFF 00000000 00000000 FFFFFFFC

   Group curve parameter B (in hexadecimal):
      b = B3312FA7 E23EE7E4 988E056B E3F82D19 181D9C6E FE814112
          0314088F 5013875A C656398D 8A2ED19D 2A85C8ED D3EC2AEF

   The generator for this group is given by: g=(gx,gy) where

      gx = AA87CA22 BE8B0537 8EB1C71E F320AD74 6E1D3B62 8BA79B98
           59F741E0 82542A38 5502F25D BF55296C 3A545E38 72760AB7

      gy = 3617DE4A 96262C6F 5D9E98BF 9292DC29 F8F41DBD 289A147C
           E9DA3113 B5F0B8C0 0A60B1CE 1D7E819D 7A431D7C 90EA0E5F

   Group Order (in hexadecimal):
      n = FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF
          C7634D81 F4372DDF 581A0DB2 48B0A77A ECEC196A CCC52973

Lepinski & Kent              Informational                      [Page 8]
```

---

```

[RFC 5114](./rfc5114)            Additional Diffie-Hellman Groups        January 2008

[2.8](#section-2.8).  521-bit Random ECP Group

   The curve is based on the integers modulo the prime p given by:
      p = 2^(521)-1

   Group Prime (in hexadecimal):
      p = 000001FF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF
          FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF
          FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF

   The equation for the elliptic curve is:
      y^2 = x^3 + ax + b (mod p)

   Group curve parameter A (in hexadecimal):
      a = 000001FF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF
          FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF
          FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFC

   Group curve parameter B (in hexadecimal):
      b = 00000051 953EB961 8E1C9A1F 929A21A0 B68540EE A2DA725B
          99B315F3 B8B48991 8EF109E1 56193951 EC7E937B 1652C0BD
          3BB1BF07 3573DF88 3D2C34F1 EF451FD4 6B503F00

   The generator for this group is given by: g=(gx,gy) where

      gx = 000000C6 858E06B7 0404E9CD 9E3ECB66 2395B442 9C648139
           053FB521 F828AF60 6B4D3DBA A14B5E77 EFE75928 FE1DC127
           A2FFA8DE 3348B3C1 856A429B F97E7E31 C2E5BD66

      gy = 00000118 39296A78 9A3BC004 5C8A5FB4 2C7D1BD9 98F54449
           579B4468 17AFBD17 273E662C 97EE7299 5EF42640 C550B901
           3FAD0761 353C7086 A272C240 88BE9476 9FD16650

   Group Order (in hexadecimal):
      n = 000001FF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF
          FFFFFFFF FFFFFFFF FFFFFFFA 51868783 BF2F966B 7FCC0148
          F709A5D0 3BB5C9B8 899C47AE BB6FB71E 91386409

[3](#section-3).  Using These Groups with IETF Standards

[3.1](#section-3.1).  X.509 Certificates

   Representation of both MODP and Elliptic Curve Diffie-Hellman public
   keys (and associated parameters) in X.509 certificates is defined in
   [[RFC3279](./rfc3279 "\"Algorithms and Identifiers for the Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile\"")].  The MODP groups defined above MUST be represented via the
   syntax defined in [Section 2.3.3](#section-2.3.3), and the elliptic curve groups via

Lepinski & Kent              Informational                      [Page 9]
```

---

```

[RFC 5114](./rfc5114)            Additional Diffie-Hellman Groups        January 2008

   the syntax defined in Section in 2.3.5 of that RFC.  When a
   Diffie-Hellman public key is encoded in a certificate, if the
   KeyUsage extension is present, the keyAgreement bits MUST be
   asserted, and encipherOnly or decipherOnly (but not both) MAY be
   asserted.

[3.2](#section-3.2).  IKE

   Use of MODP Diffie-Hellman groups with IKEv2 is defined in [[RFC4306](./rfc4306 "\"Internet Key Exchange (IKEv2) Protocol\"")],
   and the use of MODP groups with IKEv1 is defined in [[RFC2409](./rfc2409 "\"The Internet Key Exchange (IKE)\"")].
   However, in the case of ECP Diffie-Hellman groups, the format of key
   exchange payloads and the derivation of a shared secret has thus far
   been specified on a group-by-group basis.  For the ECP Diffie-Hellman
   groups defined in this document, the key exchange payload format and
   shared key derivation procedure specified in [[RFC4753](./rfc4753 "\"ECP Groups For IKE and IKEv2\"")] MUST be used
   (with both IKEv2 and IKEv1).

   In order to use a Diffie-Hellman group with IKE, it is required that
   a transform ID for the group be registered with IANA.  The following
   table provides the Transform IDs of each Diffie-Hellman group
   described in this document, as registered in both [[IANA-IKE](#ref-IANA-IKE)] and
   [[IANA-IKE2](#ref-IANA-IKE2)].

   NAME                                                    | NUMBER
   --------------------------------------------------------+---------
   1024-bit MODP Group with 160-bit Prime Order Subgroup   |   22
   2048-bit MODP Group with 224-bit Prime Order Subgroup   |   23
   2048-bit MODP Group with 256-bit Prime Order Subgroup   |   24
   192-bit Random ECP Group                                |   25
   224-bit Random ECP Group                                |   26
   256-bit Random ECP Group                                |   19
   384-bit Random ECP Group                                |   20
   521-bit Random ECP Group                                |   21

[3.3](#section-3.3).  TLS

   Use of MODP Diffie-Hellman groups in TLS 1.1 is defined in [[RFC4346](./rfc4346 "\"The Transport Layer Security (TLS) Protocol Version 1.1\"")].
   TLS 1.0, the widely deployed predecessor of TLS 1.1, is specified in
   [[RFC2246](./rfc2246 "\"The TLS Protocol Version 1.0\"")] and is the same as TLS 1.1 with respect to the use of
   (MODP) Diffie-Hellman to compute a pre-Master secret.  (Currently,
   the TLS working group is in the process of producing a specification
   for TLS 1.2.  It is unlikely that TLS 1.2 will make significant
   changes to the use of Diffie-Hellman, and thus the following will
   likely also be applicable to TLS 1.2).

Lepinski & Kent              Informational                     [Page 10]
```

---

```

[RFC 5114](./rfc5114)            Additional Diffie-Hellman Groups        January 2008

   A server may employ a certificate containing (fixed) Diffie-Hellman
   parameters, and likewise for a client using a certificate.  Thus, the
   relevant PKIX RFCs (see 3.1 above) are applicable.  Alternatively, a
   server may send ephemeral Diffie-Hellman parameters in the server key
   exchange message, where the message signature is verified using an
   RSA- or DSS-signed server certificate.  The details for accomplishing
   this for MODP Diffie-Hellman groups are provided in [[RFC2246](./rfc2246 "\"The TLS Protocol Version 1.0\"")].

   Use of Elliptic Curve Diffie-Hellman in TLS 1.1 (and 1.0) is defined
   in [[RFC4492](./rfc4492 "\"Elliptic Curve Cryptography (ECC) Cipher Suites for Transport Layer Security (TLS)\"")].  The elliptic curves in this document appear in the
   IANA EC Named Curve Registry [[IANA-TLS](#ref-IANA-TLS)], although the names in the
   registry are taken from the Standards for Efficient Cryptography
   Group (SECG) specification [[SECG](#ref-SECG "\"Recommended Elliptic Curve Domain Parameters\"")] and differ from the names appearing
   in NIST publications.  The following table provides the EC Named
   Curve ID for each of the elliptic curves along with both the NIST
   name and the SECG name for the curve.

   NAME (NIST)                      |    NUMBER    |    NAME (SECG)
   ---------------------------------+--------------+---------------
   192-bit Random ECP Group         |      19      |    secp192r1
   224-bit Random ECP Group         |      21      |    secp224r1
   256-bit Random ECP Group         |      23      |    secp256r1
   384-bit Random ECP Group         |      24      |    secp384r1
   521-bit Random ECP Group         |      25      |    secp521r1

[3.4](#section-3.4).  SSH

   Use of Diffie-Hellman with SSH was defined initially in [[RFC4253](./rfc4253 "\"The Secure Shell (SSH) Transport Layer Protocol\"")].
   That RFC defined two MODP Diffie-Hellman groups, and called for the
   registration of additional groups via an IANA registry.  However,
   [[RFC4419](./rfc4419 "\"Diffie- Hellman Group Exchange for the Secure Shell (SSH) Transport Layer Protocol\"")] extended the original model to allow MODP Diffie-Hellman
   parameters to be transmitted as part of the key exchange messages.
   Thus, using [RFC 4419](./rfc4419), no additional specifications (or IANA registry
   actions) are required to enable use of the MODP groups defined in
   this document.  At this time, no RFC describes the use of Elliptic
   Curve Diffie-Hellman with SSH.  However, [[SSH-ECC](#ref-SSH-ECC "\"Elliptic-Curve Algorithm Integration in the Secure Shell Transport Layer\"")] provides a
   description of how to make use of Elliptic Curve Diffie-Hellman with
   SSH.

[3.5](#section-3.5).  SMIME

   Use of Diffie-Hellman in SMIME is defined via a discussion of
   Cryptographic Message Syntax (CMS) enveloped data [[RFC3852](./rfc3852 "\"Cryptographic Message Syntax (CMS)\"")].  For
   MODP Diffie-Hellman, the appropriate reference is [[RFC2631](./rfc2631 "\"Diffie-Hellman Key Agreement Method\"")].  This
   specification calls for a sender to extract the Diffie-Hellman (MODP)
   parameters from a recipient's certificate, and thus the PKIX
   specifications for representation of Diffie-Hellman parameters
   suffice.  The sender transmits his public key via the

Lepinski & Kent              Informational                     [Page 11]
```

---

```

[RFC 5114](./rfc5114)            Additional Diffie-Hellman Groups        January 2008

   OriginatorIdentifierorKey field, or via a reference to the sender's
   certificate.

   Use of Elliptic Curve Diffie-Hellman in CMS is defined in [[RFC3278](./rfc3278 "\"Use of Elliptic Curve Cryptography (ECC) Algorithms in Cryptographic Message Syntax (CMS)\"")].
   As with use of MODP Diffie-Hellman in the CMS context, the sender is
   assumed to acquire the recipient's public key and parameters from a
   certificate.  The sender includes his Elliptic Curve Diffie-Hellman
   public key in the KeyAgreeRecipientInfo originator field.  (See
   [Section 8.2 of RFC 3278](./rfc3278#section-8.2) for details of the ECC-CMS-SharedInfo).

[4](#section-4).  Security Considerations

   The strength of a key derived from a Diffie-Hellman exchange using
   any of the groups defined here depends on the inherent strength of
   the group, the size of the exponent used, and the entropy provided by
   the random number generator used.  The groups defined in this
   document were chosen to make the work factor for solving the discrete
   logarithm problem roughly comparable to an attack on the subgroup.

   Using secret keys of an appropriate size is crucial to the security
   of a Diffie-Hellman exchange.  For modular exponentiation groups, the
   size of the secret key should be equal to the size of q (the size of
   the prime order subgroup).  For elliptic curve groups, the size of
   the secret key must be equal to the size of n (the order of the group
   generated by the point g).  Using larger secret keys provides
   absolutely no additional security, and using smaller secret keys is
   likely to result in dramatically less security.  (See [[NIST80056A](#ref-NIST80056A "\"Recommendation for Pair-Wise Key Establishment Schemes Using Discrete Logarithm Cryptography,\"")]
   for more information on selecting secret keys.)

   When secret keys of an appropriate size are used, an approximation of
   the strength of each of the Diffie-Hellman groups is provided in the
   table below.  For each group, the table contains an RSA key size and
   symmetric key size that provide roughly equivalent levels of
   security.  This data is based on the recommendations in [[NIST80057](#ref-NIST80057 "\"Recommendation for Key Management - Part 1\"")].

   GROUP                                      |  SYMMETRIC |   RSA
   -------------------------------------------+------------+-------
   1024-bit MODP with 160-bit Prime Subgroup  |        80  |   1024
   2048-bit MODP with 224-bit Prime Subgroup  |       112  |   2048
   2048-bit MODP with 256-bit Prime Subgroup  |       112  |   2048
   192-bit Random ECP Group                   |        80  |   1024
   224-bit Random ECP Group                   |       112  |   2048
   256-bit Random ECP Group                   |       128  |   3072
   384-bit Random ECP Group                   |       192  |   7680
   521-bit Random ECP Group                   |       256  |  15360

Lepinski & Kent              Informational                     [Page 12]
```

---

```

[RFC 5114](./rfc5114)            Additional Diffie-Hellman Groups        January 2008

[5](#section-5).  IANA Considerations

   IANA has taken the following actions:

   Updated the IKE and IKEv2 registries to include the following five
   groups defined in this document: (Note that the other three ECP
   groups defined in this document have already been added to the IKE
   registry).

   o  1024-bit MODP Group with 160-bit Prime Order Subgroup

   o  2048-bit MODP Group with 224-bit Prime Order Subgroup

   o  2048-bit MODP Group with 256-bit Prime Order Subgroup

   o  192-bit Random ECP Group

   o  224-bit Random ECP Group

   Updated [[IANA-IKE](#ref-IANA-IKE)] and [[IANA-IKE2](#ref-IANA-IKE2)] to reflect the above, which now
   appear as entries in the list of Diffie-Hellman groups given by Group
   Description.  The descriptions are as stated above.

[6](#section-6).  Acknowledgments

   We wish to thank NIST for publishing the group definitions and
   providing test data to assist implementers in verifying that software
   or hardware correctly implements these groups.  We also wish to thank
   Tero Kivinen and Sean Turner for providing helpful comments after
   reviewing an earlier version of this document.

Lepinski & Kent              Informational                     [Page 13]
```

---

```

[RFC 5114](./rfc5114)            Additional Diffie-Hellman Groups        January 2008

[Appendix A](#appendix-A).  Test Data

   The test data in this appendix is a protocol-independent subset of
   the test data in [[EX80056A](#ref-EX80056A "\"Examples for NIST 800-56A,\"")].  In the test data for the three modular
   exponentiation groups, we use the following notation:

      xA: The secret key of party A

      yA: The public key of party A

      xB: The secret key of party B

      yB: The public key of party B

      Z: The shared secret that results from the Diffie-Hellman
         computation

   In the test data for the five elliptic curve groups, we use the
   following notation:

      dA:   The secret value of party A

      x_qA: The x-coordinate of the public key of party A

      y_qA: The y-coordinate of the public key of party A

      dB:   The secret value of party B

      x_qA: The x-coordinate of the public key of party B

      y_qA: The y-coordinate of the public key of party B

      x_Z:  The x-coordinate of the shared secret that results from the
            Diffie-Hellman computation

      y_Z:  The y-coordinate of the shared secret that results form the
            Diffie-Hellman computation

Lepinski & Kent              Informational                     [Page 14]
```

---

```

[RFC 5114](./rfc5114)            Additional Diffie-Hellman Groups        January 2008

[A.1](#appendix-A.1).  1024-bit MODP Group with 160-bit Prime Order Subgroup

      xA =          B9A3B3AE 8FEFC1A2 93049650 7086F845 5D48943E

      yA =                                     2A853B3D 92197501
           B9015B2D EB3ED84F 5E021DCC 3E52F109 D3273D2B 7521281C
           BABE0E76 FF5727FA 8ACCE269 56BA9A1F CA26F202 28D8693F
           EB10841D 84A73600 54ECE5A7 F5B7A61A D3DFB3C6 0D2E4310
           6D8727DA 37DF9CCE 95B47875 5D06BCEA 8F9D4596 5F75A5F3
           D1DF3701 165FC9E5 0C4279CE B07F9895 40AE96D5 D88ED776

      xB =          9392C9F9 EB6A7A6A 9022F7D8 3E7223C6 835BBDDA

      yB =                                     717A6CB0 53371FF4
           A3B93294 1C1E5663 F861A1D6 AD34AE66 576DFB98 F6C6CBF9
           DDD5A56C 7833F6BC FDFF0955 82AD868E 440E8D09 FD769E3C
           ECCDC3D3 B1E4CFA0 57776CAA F9739B6A 9FEE8E74 11F8D6DA
           C09D6A4E DB46CC2B 5D520309 0EAE6126 311E53FD 2C14B574
           E6A3109A 3DA1BE41 BDCEAA18 6F5CE067 16A2B6A0 7B3C33FE

      Z  =                                     5C804F45 4D30D9C4
           DF85271F 93528C91 DF6B48AB 5F80B3B5 9CAAC1B2 8F8ACBA9
           CD3E39F3 CB614525 D9521D2E 644C53B8 07B810F3 40062F25
           7D7D6FBF E8D5E8F0 72E9B6E9 AFDA9413 EAFB2E8B 0699B1FB
           5A0CACED DEAEAD7E 9CFBB36A E2B42083 5BD83A19 FB0B5E96
           BF8FA4D0 9E345525 167ECD91 55416F46 F408ED31 B63C6E6D

[A.2](#appendix-A.2).  2048-bit MODP Group with 224-bit Prime Order Subgroup

      xA =                                              22E62601
           DBFFD067 08A680F7 47F361F7 6D8F4F72 1A0548E4 83294B0C

      yA =                   1B3A6345 1BD886E6 99E67B49 4E288BD7
           F8E0D370 BADDA7A0 EFD2FDE7 D8F66145 CC9F2804 19975EB8
           08877C8A 4C0C8E0B D48D4A54 01EB1E87 76BFEEE1 34C03831
           AC273CD9 D635AB0C E006A42A 887E3F52 FB8766B6 50F38078
           BC8EE858 0CEFE243 968CFC4F 8DC3DB08 4554171D 41BF2E86
           1B7BB4D6 9DD0E01E A387CBAA 5CA672AF CBE8BDB9 D62D4CE1
           5F17DD36 F91ED1EE DD65CA4A 06455CB9 4CD40A52 EC360E84
           B3C926E2 2C4380A3 BF309D56 849768B7 F52CFDF6 55FD053A
           7EF70697 9E7E5806 B17DFAE5 3AD2A5BC 568EBB52 9A7A61D6
           8D256F8F C97C074A 861D827E 2EBC8C61 34553115 B70E7103
           920AA16D 85E52BCB AB8D786A 68178FA8 FF7C2F5C 71648D6F

      xB =                                              4FF3BC96
           C7FC6A6D 71D3B363 800A7CDF EF6FC41B 4417EA15 353B7590

Lepinski & Kent              Informational                     [Page 15]
```

---

```

[RFC 5114](./rfc5114)            Additional Diffie-Hellman Groups        January 2008

     yB =                   4DCEE992 A9762A13 F2F83844 AD3D77EE
           0E31C971 8B3DB6C2 035D3961 182C3E0B A247EC41 82D760CD
           48D99599 970622A1 881BBA2D C822939C 78C3912C 6661FA54
           38B20766 222B75E2 4C2E3AD0 C7287236 129525EE 15B5DD79
           98AA04C4 A9696CAC D7172083 A97A8166 4EAD2C47 9E444E4C
           0654CC19 E28D7703 CEE8DACD 6126F5D6 65EC52C6 7255DB92
           014B037E B621A2AC 8E365DE0 71FFC140 0ACF077A 12913DD8
           DE894734 37AB7BA3 46743C1B 215DD9C1 2164A7E4 053118D1
           99BEC8EF 6FC56117 0C84C87D 10EE9A67 4A1FA8FF E13BDFBA
           1D44DE48 946D68DC 0CDD7776 35A7AB5B FB1E4BB7 B856F968
           27734C18 4138E915 D9C3002E BCE53120 546A7E20 02142B6C

      Z  =                   34D9BDDC 1B42176C 313FEA03 4C21034D
           074A6313 BB4ECDB3 703FFF42 4567A46B DF75530E DE0A9DA5
           229DE7D7 6732286C BC0F91DA 4C3C852F C099C679 531D94C7
           8AB03D9D ECB0A4E4 CA8B2BB4 591C4021 CF8CE3A2 0A541D33
           994017D0 200AE2C9 516E2FF5 14577926 9E862B0F B474A2D5
           6DC31ED5 69A7700B 4C4AB16B 22A45513 531EF523 D7121207
           7B5A169B DEFFAD7A D9608284 C7795B6D 5A5183B8 7066DE17
           D8D671C9 EBD8EC89 544D45EC 061593D4 42C62AB9 CE3B1CB9
           943A1D23 A5EA3BCF 21A01471 E67E003E 7F8A69C7 28BE490B
           2FC88CFE B92DB6A2 15E5D03C 17C464C9 AC1A46E2 03E13F95
           2995FB03 C69D3CC4 7FCB510B 6998FFD3 AA6DE73C F9F63869

[A.3](#appendix-A.3).  2048-bit MODP Group with 256-bit Prime Order Subgroup

      xA =                                     0881382C DB87660C
           6DC13E61 4938D5B9 C8B2F248 581CC5E3 1B354543 97FCE50E

      yA =                   2E9380C8 323AF975 45BC4941 DEB0EC37
           42C62FE0 ECE824A6 ABDBE66C 59BEE024 2911BFB9 67235CEB
           A35AE13E 4EC752BE 630B92DC 4BDE2847 A9C62CB8 15274542
           1FB7EB60 A63C0FE9 159FCCE7 26CE7CD8 523D7450 667EF840
           E4919121 EB5F01C8 C9B0D3D6 48A93BFB 75689E82 44AC134A
           F544711C E79A02DC C3422668 4780DDDC B4985941 06C37F5B
           C7985648 7AF5AB02 2A2E5E42 F09897C1 A85A11EA 0212AF04
           D9B4CEBC 937C3C1A 3E15A8A0 342E3376 15C84E7F E3B8B9B8
           7FB1E73A 15AF12A3 0D746E06 DFC34F29 0D797CE5 1AA13AA7
           85BF6658 AFF5E4B0 93003CBE AF665B3C 2E113A3A 4E905269
           341DC071 1426685F 4EF37E86 8A8126FF 3F2279B5 7CA67E29

      xB =                                     7D62A7E3 EF36DE61
           7B13D1AF B82C780D 83A23BD4 EE670564 5121F371 F546A53D

Lepinski & Kent              Informational                     [Page 16]
```

---

```

[RFC 5114](./rfc5114)            Additional Diffie-Hellman Groups        January 2008

      yB =                   575F0351 BD2B1B81 7448BDF8 7A6C362C
           1E289D39 03A30B98 32C5741F A250363E 7ACBC7F7 7F3DACBC
           1F131ADD 8E03367E FF8FBBB3 E1C57844 24809B25 AFE4D226
           2A1A6FD2 FAB64105 CA30A674 E07F7809 85208863 2FC04923
           3791AD4E DD083A97 8B883EE6 18BC5E0D D047415F 2D95E683
           CF14826B 5FBE10D3 CE41C6C1 20C78AB2 0008C698 BF7F0BCA
           B9D7F407 BED0F43A FB2970F5 7F8D1204 3963E66D DD320D59
           9AD9936C 8F44137C 08B180EC 5E985CEB E186F3D5 49677E80
           607331EE 17AF3380 A725B078 2317D7DD 43F59D7A F9568A9B
           B63A84D3 65F92244 ED120988 219302F4 2924C7CA 90B89D24
           F71B0AB6 97823D7D EB1AFF5B 0E8E4A45 D49F7F53 757E1913

      Z  =                   86C70BF8 D0BB81BB 01078A17 219CB7D2
           7203DB2A 19C877F1 D1F19FD7 D77EF225 46A68F00 5AD52DC8
           4553B78F C60330BE 51EA7C06 72CAC151 5E4B35C0 47B9A551
           B88F39DC 26DA14A0 9EF74774 D47C762D D177F9ED 5BC2F11E
           52C879BD 95098504 CD9EECD8 A8F9B3EF BD1F008A C5853097
           D9D1837F 2B18F77C D7BE01AF 80A7C7B5 EA3CA54C C02D0C11
           6FEE3F95 BB873993 85875D7E 86747E67 6E728938 ACBFF709
           8E05BE4D CFB24052 B83AEFFB 14783F02 9ADBDE7F 53FAE920
           84224090 E007CEE9 4D4BF2BA CE9FFD4B 57D2AF7C 724D0CAA
           19BF0501 F6F17B4A A10F425E 3EA76080 B4B9D6B3 CEFEA115
           B2CEB878 9BB8A3B0 EA87FEBE 63B6C8F8 46EC6DB0 C26C5D7C

[A.4](#appendix-A.4).  192-bit Random ECP Group

      dA   = 323FA316 9D8E9C65 93F59476 BC142000 AB5BE0E2 49C43426

      x_qA = CD46489E CFD6C105 E7B3D325 66E2B122 E249ABAA DD870612

      y_qA = 68887B48 77DF51DD 4DC3D6FD 11F0A26F 8FD38443 17916E9A

      dB   = 631F95BB 4A67632C 9C476EEE 9AB695AB 240A0499 307FCF62

      x_qB = 519A1216 80E00454 66BA21DF 2EEE47F5 973B5005 77EF13D5

      y_qB = FF613AB4 D64CEE3A 20875BDB 10F953F6 B30CA072 C60AA57F

      x_Z  = AD420182 633F8526 BFE954AC DA376F05 E5FF4F83 7F54FEBE

      y_Z  = 4371545E D772A597 41D0EDA3 2C671112 B7FDDD51 461FCF32

Lepinski & Kent              Informational                     [Page 17]
```

---

```

[RFC 5114](./rfc5114)            Additional Diffie-Hellman Groups        January 2008

[A.5](#appendix-A.5).  224-bit Random ECP Group

      dA   =                                              B558EB6C
             288DA707 BBB4F8FB AE2AB9E9 CB62E3BC 5C7573E2 2E26D37F

      x_qA =                                              49DFEF30
             9F81488C 304CFF5A B3EE5A21 54367DC7 833150E0 A51F3EEB

      y_qA =                                              4F2B5EE4
             5762C4F6 54C1A0C6 7F54CF88 B016B51B CE3D7C22 8D57ADB4

      dB   =                                              AC3B1ADD
             3D9770E6 F6A708EE 9F3B8E0A B3B480E9 F27F85C8 8B5E6D18

      x_qB =                                              6B3AC96A
             8D0CDE6A 5599BE80 32EDF10C 162D0A8A D219506D CD42A207

      y_qB =                                              D491BE99
             C213A7D1 CA3706DE BFE305F3 61AFCBB3 3E2609C8 B1618AD5

      x_Z  =                                              52272F50
             F46F4EDC 91515690 92F46DF2 D96ECC3B 6DC1714A 4EA949FA

      y_Z  =                                              5F30C6AA
             36DDC403 C0ACB712 BB88F176 3C3046F6 D919BD9C 524322BF

[A.6](#appendix-A.6).  256-bit Random ECP Group

      dA   =                                     81426414 5F2F56F2
             E96A8E33 7A128499 3FAF432A 5ABCE59E 867B7291 D507A3AF

      x_qA =                                     2AF502F3 BE8952F2
             C9B5A8D4 160D09E9 7165BE50 BC42AE4A 5E8D3B4B A83AEB15

      y_qA =                                     EB0FAF4C A986C4D3
             8681A0F9 872D79D5 6795BD4B FF6E6DE3 C0F5015E CE5EFD85

      dB   =                                     2CE1788E C197E096
             DB95A200 CC0AB26A 19CE6BCC AD562B8E EE1B5937 61CF7F41

      x_qB =                                     B120DE4A A3649279
             5346E8DE 6C2C8646 AE06AAEA 279FA775 B3AB0715 F6CE51B0

      y_qB =                                     9F1B7EEC E20D7B5E
             D8EC685F A3F071D8 37270270 92A84113 85C34DDE 5708B2B6

      x_Z  =                                     DD0F5396 219D1EA3
             93310412 D19A08F1 F5811E9D C8EC8EEA 7F80D21C 820C2788

Lepinski & Kent              Informational                     [Page 18]
```

---

```

[RFC 5114](./rfc5114)            Additional Diffie-Hellman Groups        January 2008

      y_Z  =                                     0357DCCD 4C804D0D
             8D33AA42 B848834A A5605F9A B0D37239 A115BBB6 47936F50

[A.7](#appendix-A.7).  384-bit Random ECP Group

      dA   = D27335EA 71664AF2 44DD14E9 FD126071 5DFD8A79 65571C48
             D709EE7A 7962A156 D706A90C BCB5DF29 86F05FEA DB9376F1

      x_qA = 793148F1 787634D5 DA4C6D90 74417D05 E057AB62 F82054D1
             0EE6B040 3D627954 7E6A8EA9 D1FD7742 7D016FE2 7A8B8C66

      y_qA = C6C41294 331D23E6 F480F4FB 4CD40504 C947392E 94F4C3F0
             6B8F398B B29E4236 8F7A6859 23DE3B67 BACED214 A1A1D128

      dB   = 52D1791F DB4B70F8 9C0F00D4 56C2F702 3B612526 2C36A7DF
             1F802311 21CCE3D3 9BE52E00 C194A413 2C4A6C76 8BCD94D2

      x_qB = 5CD42AB9 C41B5347 F74B8D4E FB708B3D 5B36DB65 915359B4
             4ABC1764 7B6B9999 789D72A8 4865AE2F 223F12B5 A1ABC120

      y_qB = E171458F EAA939AA A3A8BFAC 46B404BD 8F6D5B34 8C0FA4D8
             0CECA163 56CA9332 40BDE872 3415A8EC E035B0ED F36755DE

      x_Z  = 5EA1FC4A F7256D20 55981B11 0575E0A8 CAE53160 137D904C
             59D926EB 1B8456E4 27AA8A45 40884C37 DE159A58 028ABC0E

      y_Z  = 0CC59E4B 046414A8 1C8A3BDF DCA92526 C48769DD 8D3127CA
             A99B3632 D1913942 DE362EAF AA962379 374D9F3F 066841CA

[A.8](#appendix-A.8).  521-bit Random ECP Group

      dA   =              0113 F82DA825 735E3D97 276683B2 B74277BA
             D27335EA 71664AF2 430CC4F3 3459B966 9EE78B3F FB9B8683
             015D344D CBFEF6FB 9AF4C6C4 70BE2545 16CD3C1A 1FB47362

      x_qA =              01EB B34DD757 21ABF8AD C9DBED17 889CBB97
             65D90A7C 60F2CEF0 07BB0F2B 26E14881 FD4442E6 89D61CB2
             DD046EE3 0E3FFD20 F9A45BBD F6413D58 3A2DBF59 924FD35C

      y_qA =              00F6 B632D194 C0388E22 D8437E55 8C552AE1
             95ADFD15 3F92D749 08351B2F 8C4EDA94 EDB0916D 1B53C020
             B5EECAED 1A5FC38A 233E4830 587BB2EE 3489B3B4 2A5A86A4

      dB   =              00CE E3480D86 45A17D24 9F2776D2 8BAE6169
             52D1791F DB4B70F7 C3378732 AA1B2292 8448BCD1 DC2496D4
             35B01048 066EBE4F 72903C36 1B1A9DC1 193DC2C9 D0891B96

Lepinski & Kent              Informational                     [Page 19]
```

---

```

[RFC 5114](./rfc5114)            Additional Diffie-Hellman Groups        January 2008

      x_qB =              010E BFAFC6E8 5E08D24B FFFCC1A4 511DB0E6
             34BEEB1B 6DEC8C59 39AE4476 6201AF62 00430BA9 7C8AC6A0
             E9F08B33 CE7E9FEE B5BA4EE5 E0D81510 C24295B8 A08D0235

      y_qB =              00A4 A6EC300D F9E257B0 372B5E7A BFEF0934
             36719A77 887EBB0B 18CF8099 B9F4212B 6E30A141 9C18E029
             D36863CC 9D448F4D BA4D2A0E 60711BE5 72915FBD 4FEF2695

      x_Z  =              00CD EA89621C FA46B132 F9E4CFE2 261CDE2D
             4368EB56 56634C7C C98C7A00 CDE54ED1 866A0DD3 E6126C9D
             2F845DAF F82CEB1D A08F5D87 521BB0EB ECA77911 169C20CC

      y_Z  =              00F9 A7164102 9B7FC1A8 08AD07CD 4861E868
             614B865A FBECAB1F 2BD4D8B5 5EBCB5E3 A53143CE B2C511B1
             AE0AF5AC 827F60F2 FD872565 AC5CA0A1 64038FE9 80A7E4BD

Normative References

   [RFC2119]      Bradner, S., "Key words for use in RFCs to Indicate
                  Requirement Levels", [BCP 14](https://www.rfc-editor.org/bcp/bcp14), [RFC 2119](./rfc2119), March 1997.

Informative References

   [RFC2246]      Dierks, T. and C. Allen, "The TLS Protocol Version
                  1.0", [RFC 2246](./rfc2246), January 1999.

   [RFC2409]      Harkins, D. and D. Carrel, "The Internet Key Exchange
                  (IKE)", [RFC 2409](./rfc2409), November 1998.

   [RFC2631]      Rescorla, E., "Diffie-Hellman Key Agreement Method",
                  [RFC 2631](./rfc2631), June 1999.

   [RFC3278]      Blake-Wilson, S., Brown, D., and P. Lambert, "Use of
                  Elliptic Curve Cryptography (ECC) Algorithms in
                  Cryptographic Message Syntax (CMS)", [RFC 3278](./rfc3278), April
                  2002.

   [RFC3279]      Bassham, L., Polk, W., and R. Housley, "Algorithms and
                  Identifiers for the Internet X.509 Public Key
                  Infrastructure Certificate and Certificate Revocation
                  List (CRL) Profile", [RFC 3279](./rfc3279), April 2002.

   [RFC3526]      Kivinen, T. and M. Kojo, "More Modular Exponential
                  (MODP) Diffie-Hellman groups for Internet Key Exchange
                  (IKE)", [RFC 3526](./rfc3526), May 2003.

   [RFC3852]      Housley, R., "Cryptographic Message Syntax (CMS)", [RFC](./rfc3852)
                  [3852](./rfc3852), July 2004.

Lepinski & Kent              Informational                     [Page 20]
```

---

```

[RFC 5114](./rfc5114)            Additional Diffie-Hellman Groups        January 2008

   [RFC4253]      Ylonen, T. and C. Lonvick, Ed., "The Secure Shell
                  (SSH) Transport Layer Protocol", [RFC 4253](./rfc4253), January
                  2006.

   [RFC4306]      Kaufman, C., Ed., "Internet Key Exchange (IKEv2)
                  Protocol", [RFC 4306](./rfc4306), December 2005.

   [RFC4346]      Dierks, T. and E. Rescorla, "The Transport Layer
                  Security (TLS) Protocol Version 1.1", [RFC 4346](./rfc4346), April
                  2006.

   [RFC4419]      Friedl, M., Provos, N., and W. Simpson, "Diffie-
                  Hellman Group Exchange for the Secure Shell (SSH)
                  Transport Layer Protocol", [RFC 4419](./rfc4419), March 2006.

   [RFC4492]      Blake-Wilson, S., Bolyard, N., Gupta, V., Hawk, C.,
                  and B. Moeller, "Elliptic Curve Cryptography (ECC)
                  Cipher Suites for Transport Layer Security (TLS)", [RFC](./rfc4492)
                  [4492](./rfc4492), May 2006.

   [RFC4753]      Fu, D. and J. Solinas, "ECP Groups For IKE and IKEv2",
                  [RFC 4753](./rfc4753), January 2007.

   [SSH-ECC]      Green, J. and D. Stebila, "Elliptic-Curve Algorithm
                  Integration in the Secure Shell Transport Layer", Work
                  in Progress, 2007.

   [IANA-IKE]     Internet Assigned Numbers Authority, Internet Key
                  Exchange (IKE) Attributes.
                  <http://www.iana.org/assignments/ipsec-registry>

   [IANA-IKE2]    IKEv2 Parameters.
                  <http://www.iana.org/assignments/ikev2-parameters>

   [IANA-TLS]     Internet Assigned Numbers Authority, Transport Layer
                  Security (TLS) Attributes.
                  <http://www.iana.org/assignments/tls-parameters>

   [ISO-14888-3]  International Organization for Standardization and
                  International Electrotechnical Commission, ISO/IEC
                  14888-3:2006, Information Technology: Security
                  Techniques: Digital Signatures with Appendix:  Part 3
                  - Discrete Logarithm Based Mechanisms.

   [DSS]          National Institute for Standards and Technology,
                  Digital Signature Standard (DSS), FIPS PUB 186-2,
                  January 2000.
                  <http://csrc.nist.gov/publications/fips/index.html>

Lepinski & Kent              Informational                     [Page 21]
```

---

```

[RFC 5114](./rfc5114)            Additional Diffie-Hellman Groups        January 2008

   [NIST80056A]   National Institute of Standards and Technology,
                  "Recommendation for Pair-Wise Key Establishment
                  Schemes Using Discrete Logarithm Cryptography," NIST
                  Special Publication 800-56A, March 2006.
                  <http://csrc.nist.gov/CryptoToolkit/KeyMgmt.html>

   [EX80056A]     National Institute for Standards and Technology,
                  "Examples for NIST 800-56A," May 2007.
                  <http://csrc.nist.gov/groups/ST/toolkit/examples.html>

   [NIST80057]    National Institute of Standards and Technology,
                  "Recommendation for Key Management - Part 1", NIST
                  Special Publication 800-57.

   [SECG]         SECG, "Recommended Elliptic Curve Domain Parameters",
                  SEC 2, 2000,
                  <<http://www.secg.org/>>.

   [X9.62]        ANSI X9.62-2005, Public Key Cryptography For The
                  Financial Services Industry: The Elliptic Curve
                  Digital Signature Algorithm (ECDSA). 2005.

Author's Addresses

   Matt Lepinski
   BBN Technologies
   10 Moulton St.
   Cambridge, MA 02138

   EMail: mlepinski@bbn.com

   Stephen Kent
   BBN Technologies
   10 Moulton St.
   Cambridge, MA 02138

   EMail: kent@bbn.com

Lepinski & Kent              Informational                     [Page 22]
```

---

```

[RFC 5114](./rfc5114)            Additional Diffie-Hellman Groups        January 2008

Full Copyright Statement

   Copyright (C) The IETF Trust (2008).

   This document is subject to the rights, licenses and restrictions
   contained in [BCP 78](https://www.rfc-editor.org/bcp/bcp78), and except as set forth therein, the authors
   retain all their rights.

   This document and the information contained herein are provided on an
   "AS IS" basis and THE CONTRIBUTOR, THE ORGANIZATION HE/SHE REPRESENTS
   OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY, THE IETF TRUST AND
   THE INTERNET ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES, EXPRESS
   OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF
   THE INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED
   WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.

Intellectual Property

   The IETF takes no position regarding the validity or scope of any
   Intellectual Property Rights or other rights that might be claimed to
   pertain to the implementation or use of the technology described in
   this document or the extent to which any license under such rights
   might or might not be available; nor does it represent that it has
   made any independent effort to identify any such rights.  Information
   on the procedures with respect to rights in RFC documents can be
   found in [BCP 78](https://www.rfc-editor.org/bcp/bcp78) and [BCP 79](https://www.rfc-editor.org/bcp/bcp79).

   Copies of IPR disclosures made to the IETF Secretariat and any
   assurances of licenses to be made available, or the result of an
   attempt made to obtain a general license or permission for the use of
   such proprietary rights by implementers or users of this
   specification can be obtained from the IETF on-line IPR repository at
   <http://www.ietf.org/ipr>.

   The IETF invites any interested party to bring to its attention any
   copyrights, patents or patent applications, or other proprietary
   rights that may cover technology that may be required to implement
   this standard.  Please address the information to the IETF at
   ietf-ipr@ietf.org.

Lepinski & Kent              Informational                     [Page 23]

```


=== Content from gist.github.com_f3dbdcfa_20250108_141351.html ===

[Skip to content](#start-of-content)

[All gists](/discover)
[Back to GitHub](https://github.com)
[Sign in](https://gist.github.com/auth/github?return_to=https%3A%2F%2Fgist.github.com%2Fc0r0n3r%2F9455ddcab985c50fd1912eabf26e058b)
[Sign up](/join?return_to=https%3A%2F%2Fgist.github.com%2Fc0r0n3r%2F9455ddcab985c50fd1912eabf26e058b&source=header-gist)

[Sign in](https://gist.github.com/auth/github?return_to=https%3A%2F%2Fgist.github.com%2Fc0r0n3r%2F9455ddcab985c50fd1912eabf26e058b) [Sign up](/join?return_to=https%3A%2F%2Fgist.github.com%2Fc0r0n3r%2F9455ddcab985c50fd1912eabf26e058b&source=header-gist)

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

Instantly share code, notes, and snippets.

[![@c0r0n3r](https://avatars.githubusercontent.com/u/979146?s=64&v=4)](/c0r0n3r)

# [c0r0n3r](/c0r0n3r)/**[diffie\_hellman\_short\_exponent\_references.md](/c0r0n3r/9455ddcab985c50fd1912eabf26e058b)**

Last active
November 3, 2022 10:21

Show Gist options

* [Download ZIP](/c0r0n3r/9455ddcab985c50fd1912eabf26e058b/archive/46d010d4173b09d05d1eb64945132520547cc72b.zip)

* [Star
  (0)
  0](/login?return_to=https%3A%2F%2Fgist.github.com%2Fc0r0n3r%2F9455ddcab985c50fd1912eabf26e058b)You must be signed in to star a gist
* [Fork
  (0)
  0](/login?return_to=https%3A%2F%2Fgist.github.com%2Fc0r0n3r%2F9455ddcab985c50fd1912eabf26e058b)You must be signed in to fork a gist

* Embed

  + Embed
     Embed this gist in your website.
  + Share
     Copy sharable link for this gist.
  + Clone via HTTPS
     Clone using the web URL.
  + [Learn more about clone URLs](https://docs.github.com/articles/which-remote-url-should-i-use)

  Clone this repository at &lt;script src=&quot;https://gist.github.com/c0r0n3r/9455ddcab985c50fd1912eabf26e058b.js&quot;&gt;&lt;/script&gt;
* Save c0r0n3r/9455ddcab985c50fd1912eabf26e058b to your computer and use it in GitHub Desktop.

[Code](/c0r0n3r/9455ddcab985c50fd1912eabf26e058b)
[Revisions
3](/c0r0n3r/9455ddcab985c50fd1912eabf26e058b/revisions)

Embed

* Embed
   Embed this gist in your website.
* Share
   Copy sharable link for this gist.
* Clone via HTTPS
   Clone using the web URL.
* [Learn more about clone URLs](https://docs.github.com/articles/which-remote-url-should-i-use)

Clone this repository at &lt;script src=&quot;https://gist.github.com/c0r0n3r/9455ddcab985c50fd1912eabf26e058b.js&quot;&gt;&lt;/script&gt;

Save c0r0n3r/9455ddcab985c50fd1912eabf26e058b to your computer and use it in GitHub Desktop.

[Download ZIP](/c0r0n3r/9455ddcab985c50fd1912eabf26e058b/archive/46d010d4173b09d05d1eb64945132520547cc72b.zip)

Diffie-Hellman short exponent references

 [Raw](/c0r0n3r/9455ddcab985c50fd1912eabf26e058b/raw/46d010d4173b09d05d1eb64945132520547cc72b/diffie_hellman_short_exponent_references.md)

[**diffie\_hellman\_short\_exponent\_references.md**](#file-diffie_hellman_short_exponent_references-md)

| Date | Publication | Section |
| --- | --- | --- |
| 1996 | [On Diffie-Hellman Key Agreement with Short Exponents](https://link.springer.com/content/pdf/10.1007/3-540-68339-9_29.pdf) | 6 Concluding Remarks |
| 2001 | [Security Issues in the Diffie-Hellman Key Agreement Protocol](https://www.researchgate.net/profile/Anton-Stiglic-2/publication/2401745_Security_Issues_in_the_Diffie-Hellman_Key_Agreement_Protocol/links/546c144f0cf20dedafd53e7e/Security-Issues-in-the-Diffie-Hellman-Key-Agreement-Protocol.pdf) | 7.1.1 Efficiency Considerations - 3 |
| 2003 | [RFC3526](https://www.ietf.org/rfc/rfc3526.txt) | 8. Security Considerations |
| 2006 | [SP 800-57 Part 1 Rev. 5 - Recommendation for Key Management: Part 1 – General](https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-57pt1r5.pdf) | Table 2: Comparable security strengths of symmetric block cipher and asymmetric-key algorithms |
| 2006 | [RFC4419](https://www.rfc-editor.org/rfc/rfc4419) | 6.2. Private Exponents |
| 2008 | [RFC5114](https://www.rfc-editor.org/rfc/rfc5114#section-4) | 4. Security Considerations |
| 2016 | [RFC7919](https://www.rfc-editor.org/rfc/rfc7919#section-5.2) | 5.2 Short exponents |

[Sign up for free](/join?source=comment-gist)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgist.github.com%2Fc0r0n3r%2F9455ddcab985c50fd1912eabf26e058b)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from www.rfc-editor.org_b0679eaa_20250108_141355.html ===

[[RFC Home](https://www.rfc-editor.org "RFC Editor")] [[TEXT](/rfc/rfc3526.txt)|[PDF](/rfc/pdfrfc/rfc3526.txt.pdf)|[HTML](/rfc/rfc3526.html)] [[Tracker](https://datatracker.ietf.org/doc/rfc3526 "IETF Datatracker information for this document")] [[IPR](https://datatracker.ietf.org/ipr/search/?rfc=3526&submit=rfc "IPR disclosures related to this document")] [[Errata](/errata/rfc3526)] [[Info page](https://www.rfc-editor.org/info/rfc3526 "Info page")]

 PROPOSED STANDARD
 Errata Exist
```
Network Working Group                                         T. Kivinen
Request for Comments: 3526                                       M. Kojo
Category: Standards Track                    SSH Communications Security
                                                                May 2003

         More Modular Exponential (MODP) Diffie-Hellman groups
                    for Internet Key Exchange (IKE)

Status of this Memo

   This document specifies an Internet standards track protocol for the
   Internet community, and requests discussion and suggestions for
   improvements.  Please refer to the current edition of the "Internet
   Official Protocol Standards" (STD 1) for the standardization state
   and status of this protocol.  Distribution of this memo is unlimited.

Copyright Notice

   Copyright (C) The Internet Society (2003).  All Rights Reserved.

Abstract

   This document defines new Modular Exponential (MODP) Groups for the
   Internet Key Exchange (IKE) protocol.  It documents the well known
   and used 1536 bit group 5, and also defines new 2048, 3072, 4096,
   6144, and 8192 bit Diffie-Hellman groups numbered starting at 14.
   The selection of the primes for theses groups follows the criteria
   established by Richard Schroeppel.

Table of Contents

   [1](#section-1).   Introduction. . . . . . . . . . . . . . . . . . . . . . .  [2](#page-2)
   [2](#section-2).   1536-bit MODP Group . . . . . . . . . . . . . . . . . . .  [3](#page-3)
   [3](#section-3).   2048-bit MODP Group . . . . . . . . . . . . . . . . . . .  [3](#page-3)
   [4](#section-4).   3072-bit MODP Group . . . . . . . . . . . . . . . . . . .  [4](#page-4)
   [5](#section-5).   4096-bit MODP Group . . . . . . . . . . . . . . . . . . .  [5](#page-5)
   [6](#section-6).   6144-bit MODP Group . . . . . . . . . . . . . . . . . . .  [6](#page-6)
   [7](#section-7).   8192-bit MODP Group . . . . . . . . . . . . . . . . . . .  [6](#page-6)
   [8](#section-8).   Security Considerations . . . . . . . . . . . . . . . . .  [8](#page-8)
   [9](#section-9).   IANA Considerations . . . . . . . . . . . . . . . . . . .  [8](#page-8)
   [10](#section-10).  Normative References. . . . . . . . . . . . . . . . . . .  [8](#page-8)
   [11](#section-11).  Non-Normative References. . . . . . . . . . . . . . . . .  [8](#page-8)
   [12](#section-12).  Authors' Addresses  . . . . . . . . . . . . . . . . . . .  [9](#page-9)
   [13](#section-13).  Full Copyright Statement. . . . . . . . . . . . . . . . . [10](#page-10)

Kivinen & Kojo              Standards Track                     [Page 1]
```

---

```

[RFC 3526](./rfc3526)           MODP Diffie-Hellman groups for IKE           May 2003

[1](#section-1).  Introduction

   One of the important protocol parameters negotiated by Internet Key
   Exchange (IKE) [[RFC-2409](./rfc2409 "\"The Internet Key Exchange (IKE)\"")] is the Diffie-Hellman "group" that will be
   used for certain cryptographic operations.  IKE currently defines 4
   groups.  These groups are approximately as strong as a symmetric key
   of 70-80 bits.

   The new Advanced Encryption Standard (AES) cipher [[AES](#ref-AES "\"Advanced Encryption Standard (AES),\"")], which has
   more strength, needs stronger groups.  For the 128-bit AES we need
   about a 3200-bit group [[Orman01](#ref-Orman01 "\"Determining Strengths For Public Keys Used For Exchanging Symmetric Keys\"")].  The 192 and 256-bit keys would
   need groups that are about 8000 and 15400 bits respectively.  Another
   source [[RSA13](#ref-RSA13 "\"RSA Bulleting #13: A Cost-Based Security Analysis of Symmetric and Asymmetric Key Lengths\"")] [[Rousseau00](#ref-Rousseau00 "\"New Time and Space Based Key Size Equivalents for RSA and Diffie-Hellman\"")] estimates that the security equivalent
   key size for the 192-bit symmetric cipher is 2500 bits instead of
   8000 bits, and the equivalent key size 256-bit symmetric cipher is
   4200 bits instead of 15400 bits.

   Because of this disagreement, we just specify different groups
   without specifying which group should be used with 128, 192 or 256-
   bit AES.  With current hardware groups bigger than 8192-bits being
   too slow for practical use, this document does not provide any groups
   bigger than 8192-bits.

   The exponent size used in the Diffie-Hellman must be selected so that
   it matches other parts of the system.  It should not be the weakest
   link in the security system.  It should have double the entropy of
   the strength of the entire system, i.e., if you use a group whose
   strength is 128 bits, you must use more than 256 bits of randomness
   in the exponent used in the Diffie-Hellman calculation.

Kivinen & Kojo              Standards Track                     [Page 2]
```

---

```

[RFC 3526](./rfc3526)           MODP Diffie-Hellman groups for IKE           May 2003

[2](#section-2).  1536-bit MODP Group

   The 1536 bit MODP group has been used for the implementations for
   quite a long time, but was not defined in [RFC 2409](./rfc2409) (IKE).
   Implementations have been using group 5 to designate this group, we
   standardize that practice here.

   The prime is: 2^1536 - 2^1472 - 1 + 2^64 * { [2^1406 pi] + 741804 }

   Its hexadecimal value is:

      FFFFFFFF FFFFFFFF C90FDAA2 2168C234 C4C6628B 80DC1CD1
      29024E08 8A67CC74 020BBEA6 3B139B22 514A0879 8E3404DD
      EF9519B3 CD3A431B 302B0A6D F25F1437 4FE1356D 6D51C245
      E485B576 625E7EC6 F44C42E9 A637ED6B 0BFF5CB6 F406B7ED
      EE386BFB 5A899FA5 AE9F2411 7C4B1FE6 49286651 ECE45B3D
      C2007CB8 A163BF05 98DA4836 1C55D39A 69163FA8 FD24CF5F
      83655D23 DCA3AD96 1C62F356 208552BB 9ED52907 7096966D
      670C354E 4ABC9804 F1746C08 CA237327 FFFFFFFF FFFFFFFF

   The generator is: 2.

[3](#section-3).  2048-bit MODP Group

   This group is assigned id 14.

   This prime is: 2^2048 - 2^1984 - 1 + 2^64 * { [2^1918 pi] + 124476 }

   Its hexadecimal value is:

      FFFFFFFF FFFFFFFF C90FDAA2 2168C234 C4C6628B 80DC1CD1
      29024E08 8A67CC74 020BBEA6 3B139B22 514A0879 8E3404DD
      EF9519B3 CD3A431B 302B0A6D F25F1437 4FE1356D 6D51C245
      E485B576 625E7EC6 F44C42E9 A637ED6B 0BFF5CB6 F406B7ED
      EE386BFB 5A899FA5 AE9F2411 7C4B1FE6 49286651 ECE45B3D
      C2007CB8 A163BF05 98DA4836 1C55D39A 69163FA8 FD24CF5F
      83655D23 DCA3AD96 1C62F356 208552BB 9ED52907 7096966D
      670C354E 4ABC9804 F1746C08 CA18217C 32905E46 2E36CE3B
      E39E772C 180E8603 9B2783A2 EC07A28F B5C55DF0 6F4C52C9
      DE2BCBF6 95581718 3995497C EA956AE5 15D22618 98FA0510
      15728E5A 8AACAA68 FFFFFFFF FFFFFFFF

   The generator is: 2.

Kivinen & Kojo              Standards Track                     [Page 3]
```

---

```

[RFC 3526](./rfc3526)           MODP Diffie-Hellman groups for IKE           May 2003

[4](#section-4).  3072-bit MODP Group

   This group is assigned id 15.

   This prime is: 2^3072 - 2^3008 - 1 + 2^64 * { [2^2942 pi] + 1690314 }

   Its hexadecimal value is:

      FFFFFFFF FFFFFFFF C90FDAA2 2168C234 C4C6628B 80DC1CD1
      29024E08 8A67CC74 020BBEA6 3B139B22 514A0879 8E3404DD
      EF9519B3 CD3A431B 302B0A6D F25F1437 4FE1356D 6D51C245
      E485B576 625E7EC6 F44C42E9 A637ED6B 0BFF5CB6 F406B7ED
      EE386BFB 5A899FA5 AE9F2411 7C4B1FE6 49286651 ECE45B3D
      C2007CB8 A163BF05 98DA4836 1C55D39A 69163FA8 FD24CF5F
      83655D23 DCA3AD96 1C62F356 208552BB 9ED52907 7096966D
      670C354E 4ABC9804 F1746C08 CA18217C 32905E46 2E36CE3B
      E39E772C 180E8603 9B2783A2 EC07A28F B5C55DF0 6F4C52C9
      DE2BCBF6 95581718 3995497C EA956AE5 15D22618 98FA0510
      15728E5A 8AAAC42D AD33170D 04507A33 A85521AB DF1CBA64
      ECFB8504 58DBEF0A 8AEA7157 5D060C7D B3970F85 A6E1E4C7
      ABF5AE8C DB0933D7 1E8C94E0 4A25619D CEE3D226 1AD2EE6B
      F12FFA06 D98A0864 D8760273 3EC86A64 521F2B18 177B200C
      BBE11757 7A615D6C 770988C0 BAD946E2 08E24FA0 74E5AB31
      43DB5BFC E0FD108E 4B82D120 A93AD2CA FFFFFFFF FFFFFFFF

   The generator is: 2.

Kivinen & Kojo              Standards Track                     [Page 4]
```

---

```

[RFC 3526](./rfc3526)           MODP Diffie-Hellman groups for IKE           May 2003

[5](#section-5).  4096-bit MODP Group

   This group is assigned id 16.

   This prime is: 2^4096 - 2^4032 - 1 + 2^64 * { [2^3966 pi] + 240904 }

   Its hexadecimal value is:

      FFFFFFFF FFFFFFFF C90FDAA2 2168C234 C4C6628B 80DC1CD1
      29024E08 8A67CC74 020BBEA6 3B139B22 514A0879 8E3404DD
      EF9519B3 CD3A431B 302B0A6D F25F1437 4FE1356D 6D51C245
      E485B576 625E7EC6 F44C42E9 A637ED6B 0BFF5CB6 F406B7ED
      EE386BFB 5A899FA5 AE9F2411 7C4B1FE6 49286651 ECE45B3D
      C2007CB8 A163BF05 98DA4836 1C55D39A 69163FA8 FD24CF5F
      83655D23 DCA3AD96 1C62F356 208552BB 9ED52907 7096966D
      670C354E 4ABC9804 F1746C08 CA18217C 32905E46 2E36CE3B
      E39E772C 180E8603 9B2783A2 EC07A28F B5C55DF0 6F4C52C9
      DE2BCBF6 95581718 3995497C EA956AE5 15D22618 98FA0510
      15728E5A 8AAAC42D AD33170D 04507A33 A85521AB DF1CBA64
      ECFB8504 58DBEF0A 8AEA7157 5D060C7D B3970F85 A6E1E4C7
      ABF5AE8C DB0933D7 1E8C94E0 4A25619D CEE3D226 1AD2EE6B
      F12FFA06 D98A0864 D8760273 3EC86A64 521F2B18 177B200C
      BBE11757 7A615D6C 770988C0 BAD946E2 08E24FA0 74E5AB31
      43DB5BFC E0FD108E 4B82D120 A9210801 1A723C12 A787E6D7
      88719A10 BDBA5B26 99C32718 6AF4E23C 1A946834 B6150BDA
      2583E9CA 2AD44CE8 DBBBC2DB 04DE8EF9 2E8EFC14 1FBECAA6
      287C5947 4E6BC05D 99B2964F A090C3A2 233BA186 515BE7ED
      1F612970 CEE2D7AF B81BDD76 2170481C D0069127 D5B05AA9
      93B4EA98 8D8FDDC1 86FFB7DC 90A6C08F 4DF435C9 34063199
      FFFFFFFF FFFFFFFF

   The generator is: 2.

Kivinen & Kojo              Standards Track                     [Page 5]
```

---

```

[RFC 3526](./rfc3526)           MODP Diffie-Hellman groups for IKE           May 2003

[6](#section-6).  6144-bit MODP Group

   This group is assigned id 17.

   This prime is: 2^6144 - 2^6080 - 1 + 2^64 * { [2^6014 pi] + 929484 }

   Its hexadecimal value is:

   FFFFFFFF FFFFFFFF C90FDAA2 2168C234 C4C6628B 80DC1CD1 29024E08
   8A67CC74 020BBEA6 3B139B22 514A0879 8E3404DD EF9519B3 CD3A431B
   302B0A6D F25F1437 4FE1356D 6D51C245 E485B576 625E7EC6 F44C42E9
   A637ED6B 0BFF5CB6 F406B7ED EE386BFB 5A899FA5 AE9F2411 7C4B1FE6
   49286651 ECE45B3D C2007CB8 A163BF05 98DA4836 1C55D39A 69163FA8
   FD24CF5F 83655D23 DCA3AD96 1C62F356 208552BB 9ED52907 7096966D
   670C354E 4ABC9804 F1746C08 CA18217C 32905E46 2E36CE3B E39E772C
   180E8603 9B2783A2 EC07A28F B5C55DF0 6F4C52C9 DE2BCBF6 95581718
   3995497C EA956AE5 15D22618 98FA0510 15728E5A 8AAAC42D AD33170D
   04507A33 A85521AB DF1CBA64 ECFB8504 58DBEF0A 8AEA7157 5D060C7D
   B3970F85 A6E1E4C7 ABF5AE8C DB0933D7 1E8C94E0 4A25619D CEE3D226
   1AD2EE6B F12FFA06 D98A0864 D8760273 3EC86A64 521F2B18 177B200C
   BBE11757 7A615D6C 770988C0 BAD946E2 08E24FA0 74E5AB31 43DB5BFC
   E0FD108E 4B82D120 A9210801 1A723C12 A787E6D7 88719A10 BDBA5B26
   99C32718 6AF4E23C 1A946834 B6150BDA 2583E9CA 2AD44CE8 DBBBC2DB
   04DE8EF9 2E8EFC14 1FBECAA6 287C5947 4E6BC05D 99B2964F A090C3A2
   233BA186 515BE7ED 1F612970 CEE2D7AF B81BDD76 2170481C D0069127
   D5B05AA9 93B4EA98 8D8FDDC1 86FFB7DC 90A6C08F 4DF435C9 34028492
   36C3FAB4 D27C7026 C1D4DCB2 602646DE C9751E76 3DBA37BD F8FF9406
   AD9E530E E5DB382F 413001AE B06A53ED 9027D831 179727B0 865A8918
   DA3EDBEB CF9B14ED 44CE6CBA CED4BB1B DB7F1447 E6CC254B 33205151
   2BD7AF42 6FB8F401 378CD2BF 5983CA01 C64B92EC F032EA15 D1721D03
   F482D7CE 6E74FEF6 D55E702F 46980C82 B5A84031 900B1C9E 59E7C97F
   BEC7E8F3 23A97A7E 36CC88BE 0F1D45B7 FF585AC5 4BD407B2 2B4154AA
   CC8F6D7E BF48E1D8 14CC5ED2 0F8037E0 A79715EE F29BE328 06A1D58B
   B7C5DA76 F550AA3D 8A1FBFF0 EB19CCB1 A313D55C DA56C9EC 2EF29632
   387FE8D7 6E3C0468 043E8F66 3F4860EE 12BF2D5B 0B7474D6 E694F91E
   6DCC4024 FFFFFFFF FFFFFFFF

   The generator is: 2.

[7](#section-7).  8192-bit MODP Group

   This group is assigned id 18.

   This prime is: 2^8192 - 2^8128 - 1 + 2^64 * { [2^8062 pi] + 4743158 }

Kivinen & Kojo              Standards Track                     [Page 6]
```

---

```

[RFC 3526](./rfc3526)           MODP Diffie-Hellman groups for IKE           May 2003

   Its hexadecimal value is:

      FFFFFFFF FFFFFFFF C90FDAA2 2168C234 C4C6628B 80DC1CD1
      29024E08 8A67CC74 020BBEA6 3B139B22 514A0879 8E3404DD
      EF9519B3 CD3A431B 302B0A6D F25F1437 4FE1356D 6D51C245
      E485B576 625E7EC6 F44C42E9 A637ED6B 0BFF5CB6 F406B7ED
      EE386BFB 5A899FA5 AE9F2411 7C4B1FE6 49286651 ECE45B3D
      C2007CB8 A163BF05 98DA4836 1C55D39A 69163FA8 FD24CF5F
      83655D23 DCA3AD96 1C62F356 208552BB 9ED52907 7096966D
      670C354E 4ABC9804 F1746C08 CA18217C 32905E46 2E36CE3B
      E39E772C 180E8603 9B2783A2 EC07A28F B5C55DF0 6F4C52C9
      DE2BCBF6 95581718 3995497C EA956AE5 15D22618 98FA0510
      15728E5A 8AAAC42D AD33170D 04507A33 A85521AB DF1CBA64
      ECFB8504 58DBEF0A 8AEA7157 5D060C7D B3970F85 A6E1E4C7
      ABF5AE8C DB0933D7 1E8C94E0 4A25619D CEE3D226 1AD2EE6B
      F12FFA06 D98A0864 D8760273 3EC86A64 521F2B18 177B200C
      BBE11757 7A615D6C 770988C0 BAD946E2 08E24FA0 74E5AB31
      43DB5BFC E0FD108E 4B82D120 A9210801 1A723C12 A787E6D7
      88719A10 BDBA5B26 99C32718 6AF4E23C 1A946834 B6150BDA
      2583E9CA 2AD44CE8 DBBBC2DB 04DE8EF9 2E8EFC14 1FBECAA6
      287C5947 4E6BC05D 99B2964F A090C3A2 233BA186 515BE7ED
      1F612970 CEE2D7AF B81BDD76 2170481C D0069127 D5B05AA9
      93B4EA98 8D8FDDC1 86FFB7DC 90A6C08F 4DF435C9 34028492
      36C3FAB4 D27C7026 C1D4DCB2 602646DE C9751E76 3DBA37BD
      F8FF9406 AD9E530E E5DB382F 413001AE B06A53ED 9027D831
      179727B0 865A8918 DA3EDBEB CF9B14ED 44CE6CBA CED4BB1B
      DB7F1447 E6CC254B 33205151 2BD7AF42 6FB8F401 378CD2BF
      5983CA01 C64B92EC F032EA15 D1721D03 F482D7CE 6E74FEF6
      D55E702F 46980C82 B5A84031 900B1C9E 59E7C97F BEC7E8F3
      23A97A7E 36CC88BE 0F1D45B7 FF585AC5 4BD407B2 2B4154AA
      CC8F6D7E BF48E1D8 14CC5ED2 0F8037E0 A79715EE F29BE328
      06A1D58B B7C5DA76 F550AA3D 8A1FBFF0 EB19CCB1 A313D55C
      DA56C9EC 2EF29632 387FE8D7 6E3C0468 043E8F66 3F4860EE
      12BF2D5B 0B7474D6 E694F91E 6DBE1159 74A3926F 12FEE5E4
      38777CB6 A932DF8C D8BEC4D0 73B931BA 3BC832B6 8D9DD300
      741FA7BF 8AFC47ED 2576F693 6BA42466 3AAB639C 5AE4F568
      3423B474 2BF1C978 238F16CB E39D652D E3FDB8BE FC848AD9
      22222E04 A4037C07 13EB57A8 1A23F0C7 3473FC64 6CEA306B
      4BCBC886 2F8385DD FA9D4B7F A2C087E8 79683303 ED5BDD3A
      062B3CF5 B3A278A6 6D2A13F8 3F44F82D DF310EE0 74AB6A36
      4597E899 A0255DC1 64F31CC5 0846851D F9AB4819 5DED7EA1
      B1D510BD 7EE74D73 FAF36BC3 1ECFA268 359046F4 EB879F92
      4009438B 481C6CD7 889A002E D5EE382B C9190DA6 FC026E47
      9558E447 5677E9AA 9E3050E2 765694DF C81F56E8 80B96E71
      60C980DD 98EDD3DF FFFFFFFF FFFFFFFF

   The generator is: 2.

Kivinen & Kojo              Standards Track                     [Page 7]
```

---

```

[RFC 3526](./rfc3526)           MODP Diffie-Hellman groups for IKE           May 2003

[8](#section-8).  Security Considerations

   This document describes new stronger groups to be used in IKE.  The
   strengths of the groups defined here are always estimates and there
   are as many methods to estimate them as there are cryptographers.
   For the strength estimates below we took the both ends of the scale
   so the actual strength estimate is likely between the two numbers
   given here.

   +--------+----------+---------------------+---------------------+
   | Group  | Modulus  | Strength Estimate 1 | Strength Estimate 2 |
   |        |          +----------+----------+----------+----------+
   |        |          |          | exponent |          | exponent |
   |        |          | in bits  | size     | in bits  | size     |
   +--------+----------+----------+----------+----------+----------+
   |   5    | 1536-bit |       90 |     180- |      120 |     240- |
   |  14    | 2048-bit |      110 |     220- |      160 |     320- |
   |  15    | 3072-bit |      130 |     260- |      210 |     420- |
   |  16    | 4096-bit |      150 |     300- |      240 |     480- |
   |  17    | 6144-bit |      170 |     340- |      270 |     540- |
   |  18    | 8192-bit |      190 |     380- |      310 |     620- |
   +--------+----------+---------------------+---------------------+

[9](#section-9).  IANA Considerations

   IKE [[RFC-2409](./rfc2409 "\"The Internet Key Exchange (IKE)\"")] defines 4 Diffie-Hellman Groups, numbered 1 through 4.

   This document defines a new group 5, and new groups from 14 to 18.
   Requests for additional assignment are via "IETF Consensus" as
   defined in [RFC 2434](./rfc2434) [[RFC-2434](./rfc2434)].  Specifically, new groups are
   expected to be documented in a Standards Track RFC.

[10](#section-10).  Normative References

   [RFC-2409]   Harkins, D. and D. Carrel, "The Internet Key Exchange
                (IKE)", [RFC 2409](./rfc2409), November 1998.

   [RFC-2434]   Narten, T. and H. Alvestrand, "Guidelines for Writing an
                IANA Considerations Section in RFCs", [BCP 26](https://www.rfc-editor.org/bcp/bcp26), [RFC 2434](./rfc2434),
                October 1998.

[11](#section-11).  Non-Normative References

   [AES]        NIST, FIPS PUB 197, "Advanced Encryption Standard
                (AES)," November 2001.
                [http://csrc.nist.gov/publications/fips/fips197/fips-](http://csrc.nist.gov/publications/fips/fips197/fips-197)
                [197](http://csrc.nist.gov/publications/fips/fips197/fips-197).{ps,pdf}

Kivinen & Kojo              Standards Track                     [Page 8]
```

---

```

[RFC 3526](./rfc3526)           MODP Diffie-Hellman groups for IKE           May 2003

   [RFC-2412]   Orman, H., "The OAKLEY Key Determination Protocol", [RFC](./rfc2412)
                [2412](./rfc2412), November 1998.

   [Orman01]    Orman, H. and P. Hoffman, "Determining Strengths For
                Public Keys Used For Exchanging Symmetric Keys", Work in
                progress.

   [RSA13]      Silverman, R. "RSA Bulleting #13: A Cost-Based Security
                Analysis of Symmetric and Asymmetric Key Lengths", April
                2000, [http://www.rsasecurity.com/rsalabs/bulletins/](http://www.rsasecurity.com/rsalabs/bulletins/bulletin13.html)
                [bulletin13.html](http://www.rsasecurity.com/rsalabs/bulletins/bulletin13.html)

   [Rousseau00] Rousseau, F. "New Time and Space Based Key Size
                Equivalents for RSA and Diffie-Hellman", December 2000,
                [http://www.sandelman.ottawa.on.ca/ipsec/2000/12/](http://www.sandelman.ottawa.on.ca/ipsec/2000/12/msg00045.html)
                [msg00045.html](http://www.sandelman.ottawa.on.ca/ipsec/2000/12/msg00045.html)

[12](#section-12).  Authors' Addresses

   Tero Kivinen
   SSH Communications Security Corp
   Fredrikinkatu 42
   FIN-00100 HELSINKI
   Finland

   EMail: kivinen@ssh.fi

   Mika Kojo
   HELSINKI
   Finland

   EMail: mika.kojo@helsinki.fi

Kivinen & Kojo              Standards Track                     [Page 9]
```

---

```

[RFC 3526](./rfc3526)           MODP Diffie-Hellman groups for IKE           May 2003

[13](#section-13).  Full Copyright Statement

   Copyright (C) The Internet Society (2003).  All Rights Reserved.

   This document and translations of it may be copied and furnished to
   others, and derivative works that comment on or otherwise explain it
   or assist in its implementation may be prepared, copied, published
   and distributed, in whole or in part, without restriction of any
   kind, provided that the above copyright notice and this paragraph are
   included on all such copies and derivative works.  However, this
   document itself may not be modified in any way, such as by removing
   the copyright notice or references to the Internet Society or other
   Internet organizations, except as needed for the purpose of
   developing Internet standards in which case the procedures for
   copyrights defined in the Internet Standards process must be
   followed, or as required to translate it into languages other than
   English.

   The limited permissions granted above are perpetual and will not be
   revoked by the Internet Society or its successors or assigns.

   This document and the information contained herein is provided on an
   "AS IS" basis and THE INTERNET SOCIETY AND THE INTERNET ENGINEERING
   TASK FORCE DISCLAIMS ALL WARRANTIES, EXPRESS OR IMPLIED, INCLUDING
   BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF THE INFORMATION
   HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED WARRANTIES OF
   MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.

Acknowledgement

   Funding for the RFC Editor function is currently provided by the
   Internet Society.

Kivinen & Kojo              Standards Track                    [Page 10]

```


=== Content from www.rfc-editor.org_9375f557_20250108_141356.html ===

[[RFC Home](https://www.rfc-editor.org "RFC Editor")] [[TEXT](/rfc/rfc7919.txt)|[PDF](/rfc/pdfrfc/rfc7919.txt.pdf)|[HTML](/rfc/rfc7919.html)] [[Tracker](https://datatracker.ietf.org/doc/rfc7919 "IETF Datatracker information for this document")] [[IPR](https://datatracker.ietf.org/ipr/search/?rfc=7919&submit=rfc "IPR disclosures related to this document")] [[Errata](/errata/rfc7919)] [[Info page](https://www.rfc-editor.org/info/rfc7919 "Info page")]

 PROPOSED STANDARD
 Errata Exist
```
Internet Engineering Task Force (IETF)                        D. Gillmor
Request for Comments: 7919                                          ACLU
Updates: [2246](./rfc2246), [4346](./rfc4346), [4492](./rfc4492), [5246](./rfc5246)                              August 2016
Category: Standards Track
ISSN: 2070-1721

      Negotiated Finite Field Diffie-Hellman Ephemeral Parameters
                   for Transport Layer Security (TLS)

Abstract

   Traditional finite-field-based Diffie-Hellman (DH) key exchange
   during the Transport Layer Security (TLS) handshake suffers from a
   number of security, interoperability, and efficiency shortcomings.
   These shortcomings arise from lack of clarity about which DH group
   parameters TLS servers should offer and clients should accept.  This
   document offers a solution to these shortcomings for compatible peers
   by using a section of the TLS "Supported Groups Registry" (renamed
   from "EC Named Curve Registry" by this document) to establish common
   finite field DH parameters with known structure and a mechanism for
   peers to negotiate support for these groups.

   This document updates TLS versions 1.0 ([RFC 2246](./rfc2246)), 1.1 ([RFC 4346](./rfc4346)),
   and 1.2 ([RFC 5246](./rfc5246)), as well as the TLS Elliptic Curve Cryptography
   (ECC) extensions ([RFC 4492](./rfc4492)).

Status of This Memo

   This is an Internet Standards Track document.

   This document is a product of the Internet Engineering Task Force
   (IETF).  It represents the consensus of the IETF community.  It has
   received public review and has been approved for publication by the
   Internet Engineering Steering Group (IESG).  Further information on
   Internet Standards is available in [Section 2 of RFC 7841](./rfc7841#section-2).

   Information about the current status of this document, any errata,
   and how to provide feedback on it may be obtained at
   [http://www.rfc-editor.org/info/rfc7919](https://www.rfc-editor.org/info/rfc7919).

Gillmor                      Standards Track                    [Page 1]
```

---

```

[RFC 7919](./rfc7919)                Negotiated FFDHE for TLS             August 2016

Copyright Notice

   Copyright (c) 2016 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to [BCP 78](https://www.rfc-editor.org/bcp/bcp78) and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (<http://trustee.ietf.org/license-info>) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.

Gillmor                      Standards Track                    [Page 2]
```

---

```

[RFC 7919](./rfc7919)                Negotiated FFDHE for TLS             August 2016

Table of Contents

   [1](#section-1).  Introduction  . . . . . . . . . . . . . . . . . . . . . . . .   [4](#page-4)
     [1.1](#section-1.1).  Requirements Language . . . . . . . . . . . . . . . . . .   [5](#page-5)
     [1.2](#section-1.2).  Vocabulary  . . . . . . . . . . . . . . . . . . . . . . .   [5](#page-5)
   [2](#section-2).  Named Group Overview  . . . . . . . . . . . . . . . . . . . .   [5](#page-5)
   [3](#section-3).  Client Behavior . . . . . . . . . . . . . . . . . . . . . . .   [6](#page-6)
     [3.1](#section-3.1).  Client Local Policy on Custom Groups  . . . . . . . . . .   [7](#page-7)
   [4](#section-4).  Server Behavior . . . . . . . . . . . . . . . . . . . . . . .   [8](#page-8)
   [5](#section-5).  Optimizations . . . . . . . . . . . . . . . . . . . . . . . .   [9](#page-9)
     [5.1](#section-5.1).  Checking the Peer's Public Key  . . . . . . . . . . . . .   [9](#page-9)
     [5.2](#section-5.2).  Short Exponents . . . . . . . . . . . . . . . . . . . . .   [9](#page-9)
     [5.3](#section-5.3).  Table Acceleration  . . . . . . . . . . . . . . . . . . .  [10](#page-10)
   [6](#section-6).  Operational Considerations  . . . . . . . . . . . . . . . . .  [10](#page-10)
     [6.1](#section-6.1).  Preference Ordering . . . . . . . . . . . . . . . . . . .  [10](#page-10)
   [7](#section-7).  IANA Considerations . . . . . . . . . . . . . . . . . . . . .  [11](#page-11)
   [8](#section-8).  Security Considerations . . . . . . . . . . . . . . . . . . .  [12](#page-12)
     [8.1](#section-8.1).  Negotiation Resistance to Active Attacks  . . . . . . . .  [12](#page-12)
     [8.2](#section-8.2).  Group Strength Considerations . . . . . . . . . . . . . .  [13](#page-13)
     [8.3](#section-8.3).  Finite Field DHE Only . . . . . . . . . . . . . . . . . .  [13](#page-13)
     [8.4](#section-8.4).  Deprecating Weak Groups . . . . . . . . . . . . . . . . .  [14](#page-14)
     [8.5](#section-8.5).  Choice of Groups  . . . . . . . . . . . . . . . . . . . .  [14](#page-14)
     [8.6](#section-8.6).  Timing Attacks  . . . . . . . . . . . . . . . . . . . . .  [14](#page-14)
     [8.7](#section-8.7).  Replay Attacks from Non-negotiated FFDHE  . . . . . . . .  [15](#page-15)
     [8.8](#section-8.8).  Forward Secrecy . . . . . . . . . . . . . . . . . . . . .  [15](#page-15)
     [8.9](#section-8.9).  False Start . . . . . . . . . . . . . . . . . . . . . . .  [15](#page-15)
   [9](#section-9).  Privacy Considerations  . . . . . . . . . . . . . . . . . . .  [16](#page-16)
     [9.1](#section-9.1).  Client Fingerprinting . . . . . . . . . . . . . . . . . .  [16](#page-16)
   [10](#section-10). References  . . . . . . . . . . . . . . . . . . . . . . . . .  [16](#page-16)
     [10.1](#section-10.1).  Normative References . . . . . . . . . . . . . . . . . .  [16](#page-16)
     [10.2](#section-10.2).  Informative References . . . . . . . . . . . . . . . . .  [17](#page-17)
   [Appendix A](#appendix-A).  Supported Groups Registry (Formerly "EC Named Curve
                Registry") . . . . . . . . . . . . . . . . . . . . .  [19](#page-19)
     [A.1](#appendix-A.1).  ffdhe2048 . . . . . . . . . . . . . . . . . . . . . . . .  [19](#page-19)
     [A.2](#appendix-A.2).  ffdhe3072 . . . . . . . . . . . . . . . . . . . . . . . .  [20](#page-20)
     [A.3](#appendix-A.3).  ffdhe4096 . . . . . . . . . . . . . . . . . . . . . . . .  [22](#page-22)
     [A.4](#appendix-A.4).  ffdhe6144 . . . . . . . . . . . . . . . . . . . . . . . .  [23](#page-23)
     [A.5](#appendix-A.5).  ffdhe8192 . . . . . . . . . . . . . . . . . . . . . . . .  [26](#page-26)
   Acknowledgements  . . . . . . . . . . . . . . . . . . . . . . . .  [29](#page-29)
   Author's Address  . . . . . . . . . . . . . . . . . . . . . . . .  [29](#page-29)

Gillmor                      Standards Track                    [Page 3]
```

---

```

[RFC 7919](./rfc7919)                Negotiated FFDHE for TLS             August 2016

[1](#section-1).  Introduction

   Traditional TLS [[RFC5246](./rfc5246 "\"The Transport Layer Security (TLS) Protocol Version 1.2\"")] offers a Diffie-Hellman Ephemeral (DHE) key
   exchange mode that provides forward secrecy for the connection.  The
   client offers a cipher suite in the ClientHello that includes DHE,
   and the server offers the client group parameters generator g and
   modulus p.  If the client does not consider the group strong enough
   (e.g., p is too small, p is not prime, or there are small subgroups
   that cannot be easily avoided) or if it is unable to process the
   group for other reasons, the client has no recourse but to terminate
   the connection.

   Conversely, when a TLS server receives a suggestion for a DHE cipher
   suite from a client, it has no way of knowing what kinds of DH groups
   the client is capable of handling or what the client's security
   requirements are for this key exchange session.  For example, some
   widely distributed TLS clients are not capable of DH groups where p >
   1024 bits.  Other TLS clients may, by policy, wish to use DHE only if
   the server can offer a stronger group (and are willing to use a non-
   PFS (Perfect Forward Secrecy) key exchange mechanism otherwise).  The
   server has no way of knowing which type of client is connecting but
   must select DH parameters with insufficient knowledge.

   Additionally, the DH parameters selected by the server may have a
   known structure that renders them secure against a small subgroup
   attack, but a client receiving an arbitrary p and g has no efficient
   way to verify that the structure of a new group is reasonable for
   use.

   This modification to TLS solves these problems by using a section of
   the "Supported Groups Registry" (renamed from "EC Named Curve
   Registry" by this document) to select common DH groups with known
   structure and defining the use of the "elliptic_curves(10)" extension
   (described here as the Supported Groups extension) for clients
   advertising support for DHE with these groups.  This document also
   provides guidance for compatible peers to take advantage of the
   additional security, availability, and efficiency offered.

   The use of this mechanism by one compatible peer when interacting
   with a non-compatible peer should have no detrimental effects.

   This document updates TLS versions 1.0 [[RFC2246](./rfc2246 "\"The TLS Protocol Version 1.0\"")], 1.1 [[RFC4346](./rfc4346 "\"The Transport Layer Security (TLS) Protocol Version 1.1\"")], and
   1.2 [[RFC5246](./rfc5246 "\"The Transport Layer Security (TLS) Protocol Version 1.2\"")], as well as the TLS ECC extensions [[RFC4492](./rfc4492 "\"Elliptic Curve Cryptography (ECC) Cipher Suites for Transport Layer Security (TLS)\"")].

Gillmor                      Standards Track                    [Page 4]
```

---

```

[RFC 7919](./rfc7919)                Negotiated FFDHE for TLS             August 2016

[1.1](#section-1.1).  Requirements Language

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in [[RFC2119](./rfc2119 "\"Key words for use in RFCs to Indicate Requirement Levels\"")].

[1.2](#section-1.2).  Vocabulary

   The terms "DHE" or "FFDHE" are used in this document to refer to the
   finite-field-based Diffie-Hellman ephemeral key exchange mechanism in
   TLS.  TLS also supports Elliptic Curve Diffie-Hellman Ephemeral
   (ECDHE) key exchanges [[RFC4492](./rfc4492 "\"Elliptic Curve Cryptography (ECC) Cipher Suites for Transport Layer Security (TLS)\"")], but this document does not document
   their use.  A registry previously used only by ECDHE-capable
   implementations is expanded in this document to cover FFDHE groups as
   well.  "FFDHE cipher suites" is used in this document to refer
   exclusively to cipher suites with FFDHE key exchange mechanisms, but
   note that these suites are typically labeled with a TLS_DHE_ prefix.

[2](#section-2).  Named Group Overview

   We use previously unallocated codepoints within the extension
   currently known as "elliptic_curves" ([Section 5.1.1. of [RFC4492]](./rfc4492#section-5.1.1)) to
   indicate known finite field groups.  The extension's semantics are
   expanded from "Supported Elliptic Curves" to "Supported Groups".  The
   enum datatype used in the extension has been renamed from NamedCurve
   to NamedGroup.  Its semantics are likewise expanded from "named
   curve" to "named group".

   Additionally, we explicitly relax the requirement about when the
   Supported Groups extension can be sent.  This extension MAY be sent
   by the client when either FFDHE or ECDHE cipher suites are listed.

   Codepoints in the "Supported Groups Registry" with a high byte of
   0x01 (that is, between 256 and 511, inclusive) are set aside for
   FFDHE groups, though only a small number of them are initially
   defined and we do not expect many other FFDHE groups to be added to
   this range.  No codepoints outside of this range will be allocated to
   FFDHE groups.  The new codepoints for the "Supported Groups Registry"
   are:

           enum {
           // other already defined elliptic curves (see [RFC 4492](./rfc4492))
               ffdhe2048(256), ffdhe3072(257), ffdhe4096(258),
               ffdhe6144(259), ffdhe8192(260),
           //
           } NamedGroup;

Gillmor                      Standards Track                    [Page 5]
```

---

```

[RFC 7919](./rfc7919)                Negotiated FFDHE for TLS             August 2016

   These additions to the "Supported Groups Registry" are described in
   detail in [Appendix A](#appendix-A).  They are all safe primes derived from the base
   of the natural logarithm ("e"), with the high and low 64 bits set to
   1 for efficient Montgomery or Barrett reduction.

   The use of the base of the natural logarithm here is as a "nothing-
   up-my-sleeve" number.  The goal is to guarantee that the bits in the
   middle of the modulus are effectively random, while avoiding any
   suspicion that the primes have secretly been selected to be weak
   according to some secret criteria.  [[RFC3526](./rfc3526 "\"More Modular Exponential (MODP) Diffie-Hellman groups for Internet Key Exchange (IKE)\"")] used pi for this value.
   See [Section 8.5](#section-8.5) for reasons that this document does not reuse pi.

[3](#section-3).  Client Behavior

   A TLS client that is capable of using strong finite field Diffie-
   Hellman groups can advertise its capabilities and its preferences for
   stronger key exchange by using this mechanism.

   The compatible client that wants to be able to negotiate strong FFDHE
   sends a Supported Groups extension (identified by type
   elliptic_curves(10) in [[RFC4492](./rfc4492 "\"Elliptic Curve Cryptography (ECC) Cipher Suites for Transport Layer Security (TLS)\"")]) in the ClientHello and includes a
   list of known FFDHE groups in the extension data, ordered from most
   preferred to least preferred.  If the client also supports and wants
   to offer ECDHE key exchange, it MUST use a single Supported Groups
   extension to include all supported groups (both ECDHE and FFDHE
   groups).  The ordering SHOULD be based on client preference, but see
   [Section 6.1](#section-6.1) for more nuance.

   A client that offers a Supported Groups extension containing an FFDHE
   group SHOULD also include at least one FFDHE cipher suite in the
   ClientHello.

   A client that offers a group MUST be able and willing to perform a DH
   key exchange using that group.

   A client that offers one or more FFDHE groups in the Supported Groups
   extension and an FFDHE cipher suite and that receives an FFDHE cipher
   suite from the server SHOULD take the following steps upon receiving
   the ServerKeyExchange:

   o  For non-anonymous cipher suites where the offered certificate is
      valid and appropriate for the peer, validate the signature over
      the ServerDHParams.  If not valid, terminate the connection.

Gillmor                      Standards Track                    [Page 6]
```

---

```

[RFC 7919](./rfc7919)                Negotiated FFDHE for TLS             August 2016

   o  If the signature over ServerDHParams is valid, compare the
      selected dh_p and dh_g with the FFDHE groups offered by the
      client.  If none of the offered groups match, the server is not
      compatible with this document.  The client MAY decide to continue
      the connection if the selected group is acceptable under local
      policy, or it MAY decide to terminate the connection with a fatal
      insufficient_security(71) alert.

   o  If the client continues (either because the server offered a
      matching group or because local policy permits the offered custom
      group), the client MUST verify that dh_Ys is in the range 1 <
      dh_Ys < dh_p - 1.  If dh_Ys is not in this range, the client MUST
      terminate the connection with a fatal handshake_failure(40) alert.

   o  If dh_Ys is in range, then the client SHOULD continue with the
      connection as usual.

[3.1](#section-3.1).  Client Local Policy on Custom Groups

   Compatible clients that are willing to accept FFDHE cipher suites
   from non-compatible servers may have local policy about what custom
   FFDHE groups they are willing to accept.  This local policy presents
   a risk to clients, who may accept weakly protected communications
   from misconfigured servers.

   This document cannot enumerate all possible safe local policy (the
   safest may be to simply reject all custom groups), but compatible
   clients that accept some custom groups from the server MUST do at
   least cursory checks on group size and may take other properties into
   consideration as well.

   A compatible client that accepts FFDHE cipher suites using custom
   groups from non-compatible servers MUST reject any group with |dh_p|
   < 768 bits and SHOULD reject any group with |dh_p| < 1024 bits.

   A compatible client that rejects a non-compatible server's custom
   group may decide to retry the connection while omitting all FFDHE
   cipher suites from the ClientHello.  A client SHOULD only use this
   approach if it successfully verified the server's expected signature
   over the ServerDHParams, to avoid being forced by an active attacker
   into a non-preferred cipher suite.

Gillmor                      Standards Track                    [Page 7]
```

---

```

[RFC 7919](./rfc7919)                Negotiated FFDHE for TLS             August 2016

[4](#section-4).  Server Behavior

   If a compatible TLS server receives a Supported Groups extension from
   a client that includes any FFDHE group (i.e., any codepoint between
   256 and 511, inclusive, even if unknown to the server), and if none
   of the client-proposed FFDHE groups are known and acceptable to the
   server, then the server MUST NOT select an FFDHE cipher suite.  In
   this case, the server SHOULD select an acceptable non-FFDHE cipher
   suite from the client's offered list.  If the extension is present
   with FFDHE groups, none of the client's offered groups are acceptable
   by the server, and none of the client's proposed non-FFDHE cipher
   suites are acceptable to the server, the server MUST end the
   connection with a fatal TLS alert of type insufficient_security(71).

   If at least one FFDHE cipher suite is present in the client cipher
   suite list and the Supported Groups extension is either absent from
   the ClientHello entirely or contains no FFDHE groups (i.e., no
   codepoints between 256 and 511, inclusive), then the server knows
   that the client is not compatible with this document.  In this
   scenario, a server MAY select a non-FFDHE cipher suite, or it MAY
   select an FFDHE cipher suite and offer an FFDHE group of its choice
   to the client as part of a traditional ServerKeyExchange.

   A compatible TLS server that receives the Supported Groups extension
   with FFDHE codepoints in it and that selects an FFDHE cipher suite
   MUST select one of the client's offered groups.  The server indicates
   the choice of group to the client by sending the group's parameters
   as usual in the ServerKeyExchange as described in [Section 7.4.3 of
   [RFC5246]](./rfc5246#section-7.4.3).

   A TLS server MUST NOT select a named FFDHE group that was not offered
   by a compatible client.

   A TLS server MUST NOT select an FFDHE cipher suite if the client did
   not offer one, even if the client offered an FFDHE group in the
   Supported Groups extension.

   If a non-anonymous FFDHE cipher suite is selected and the TLS client
   has used this extension to offer an FFDHE group of comparable or
   greater strength than the server's public key, the server SHOULD
   select an FFDHE group at least as strong as the server's public key.
   For example, if the server has a 3072-bit RSA key and the client
   offers only ffdhe2048 and ffdhe4096, the server SHOULD select
   ffdhe4096.

Gillmor                      Standards Track                    [Page 8]
```

---

```

[RFC 7919](./rfc7919)                Negotiated FFDHE for TLS             August 2016

   When an FFDHE cipher suite is selected and the client sends a
   ClientKeyExchange, the server MUST verify that 1 < dh_Yc < dh_p - 1.
   If dh_Yc is out of range, the server MUST terminate the connection
   with a fatal handshake_failure(40) alert.

[5](#section-5).  Optimizations

   In a key exchange with a successfully negotiated known FFDHE group,
   both peers know that the group in question uses a safe prime as a
   modulus and that the group in use is of size p-1 or (p-1)/2.  This
   allows at least three optimizations that can be used to improve
   performance.

[5.1](#section-5.1).  Checking the Peer's Public Key

   Peers MUST validate each other's public key Y (dh_Ys offered by the
   server or dh_Yc offered by the client) by ensuring that 1 < Y < p-1.
   This simple check ensures that the remote peer is properly behaved
   and isn't forcing the local system into the 2-element subgroup.

   To reach the same assurance with an unknown group, the client would
   need to verify the primality of the modulus, learn the factors of
   p-1, and test both the generator g and Y against each factor to avoid
   small subgroup attacks.

[5.2](#section-5.2).  Short Exponents

   Traditional finite field Diffie-Hellman has each peer choose their
   secret exponent from the range [2, p-2].  Using exponentiation by
   squaring, this means each peer must do roughly 2*log_2(p)
   multiplications, twice (once for the generator and once for the
   peer's public key).

   Peers concerned with performance may also prefer to choose their
   secret exponent from a smaller range, doing fewer multiplications,
   while retaining the same level of overall security.  Each named group
   indicates its approximate security level and provides a lower bound
   on the range of secret exponents that should preserve it.  For
   example, rather than doing 2*2*3072 multiplications for an ffdhe3072
   handshake, each peer can choose to do 2*2*275 multiplications by
   choosing their secret exponent from the range [2^274, 2^275] (that
   is, an m-bit integer where m is at least 275) and still keep the same
   approximate security level.

   A similar short-exponent approach is suggested in a Secure SHell
   (SSH) Diffie-Hellman key exchange (see [Section 6.2 of [RFC4419]](./rfc4419#section-6.2)).

Gillmor                      Standards Track                    [Page 9]
```

---

```

[RFC 7919](./rfc7919)                Negotiated FFDHE for TLS             August 2016

[5.3](#section-5.3).  Table Acceleration

   Peers wishing to further accelerate FFDHE key exchange can also pre-
   compute a table of powers of the generator of a known group.  This is
   a memory vs. time trade-off, and it only accelerates the first
   exponentiation of the ephemeral DH exchange (the fixed-base
   exponentiation).  The variable-base exponentiation (using the peer's
   public exponent as a base) still needs to be calculated as normal.

[6](#section-6).  Operational Considerations

[6.1](#section-6.1).  Preference Ordering

   The ordering of named groups in the Supported Groups extension may
   contain some ECDHE groups and some FFDHE groups.  These SHOULD be
   ranked in the order preferred by the client.

   However, the ClientHello also contains a list of desired cipher
   suites, also ranked in preference order.  This presents the
   possibility of conflicted preferences.  For example, if the
   ClientHello contains a cipher_suite field with two choices in order
   <TLS_DHE_RSA_WITH_AES_128_CBC_SHA,
   TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA> and the Supported Groups
   extension contains two choices in order <secp256r1,ffdhe3072>, then
   there is a clear contradiction.  Clients SHOULD NOT present such a
   contradiction since it does not represent a sensible ordering.  A
   server that encounters such a contradiction when selecting between an
   ECDHE or FFDHE key exchange mechanism while trying to respect client
   preferences SHOULD give priority to the Supported Groups extension
   (in the example case, it should select
   TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA with secp256r1) but MAY resolve
   the contradiction any way it sees fit.

   More subtly, clients MAY interleave preferences between ECDHE and
   FFDHE groups; for example, if stronger groups are preferred
   regardless of cost, but weaker groups are acceptable, the Supported
   Groups extension could consist of
   <ffdhe8192,secp384p1,ffdhe3072,secp256r1>.  In this example, with the
   same cipher_suite field offered as the previous example, a server
   configured to respect client preferences and with support for all
   listed groups SHOULD select TLS_DHE_RSA_WITH_AES_128_CBC_SHA with
   ffdhe8192.  A server configured to respect client preferences and
   with support for only secp384p1 and ffdhe3072 SHOULD select
   TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA with secp384p1.

Gillmor                      Standards Track                   [Page 10]
```

---

```

[RFC 7919](./rfc7919)                Negotiated FFDHE for TLS             August 2016

[7](#section-7).  IANA Considerations

   This document renames the "EC Named Curve Registry" (originally
   defined in [[RFC4492](./rfc4492 "\"Elliptic Curve Cryptography (ECC) Cipher Suites for Transport Layer Security (TLS)\"")] and updated by [[RFC7027](./rfc7027 "\"Elliptic Curve Cryptography (ECC) Brainpool Curves for Transport Layer Security (TLS)\"")]) to the "Supported
   Groups Registry".  See
   <<https://www.iana.org/assignments/tls-parameters>>.

   This document expands the semantics of this registry to include
   groups based on finite fields in addition to groups based on elliptic
   curves.  IANA has added a range designation to the registry,
   indicating that values from 256-511 (inclusive) are set aside for
   "Finite Field Diffie-Hellman groups" and that all other entries in
   the registry are "Elliptic curve groups".

   This document allocates five well-defined codepoints in the registry
   for specific finite field Diffie-Hellman groups defined in
   [Appendix A](#appendix-A).

   In addition, the four highest codepoints in the range 508-511,
   inclusive, are designated for Private Use [[RFC5226](./rfc5226)] by peers who have
   privately developed finite field Diffie-Hellman groups that they wish
   to signal internally.

   The updated registry section is as follows:

   +---------+-------------+---------+-----------+
   | Value   | Description | DTLS-OK | Reference |
   +---------+-------------+---------+-----------+
   | 256     | ffdhe2048   | Y       | [RFC 7919](./rfc7919)  |
   | 257     | ffdhe3072   | Y       | [RFC 7919](./rfc7919)  |
   | 258     | ffdhe4096   | Y       | [RFC 7919](./rfc7919)  |
   | 259     | ffdhe6144   | Y       | [RFC 7919](./rfc7919)  |
   | 260     | ffdhe8192   | Y       | [RFC 7919](./rfc7919)  |
   | 508-511 | Private Use | -       | [RFC 7919](./rfc7919)  |
   +---------+-------------+---------+-----------+

   IANA has also renamed the "elliptic_curves" extension as
   "supported_groups" and added a reference to this document in the
   "ExtensionType Values" registry.  See
   <<http://www.iana.org/assignments/tls-extensiontype-values>>.

Gillmor                      Standards Track                   [Page 11]
```

---

```

[RFC 7919](./rfc7919)                Negotiated FFDHE for TLS             August 2016

[8](#section-8).  Security Considerations

[8.1](#section-8.1).  Negotiation Resistance to Active Attacks

   Because the contents of the Supported Groups extension are hashed in
   the Finished message, an active Man in the Middle (MITM) that tries
   to filter or omit groups will cause the handshake to fail, but
   possibly not before getting the peer to do something it would not
   otherwise have done.

   An attacker who impersonates the server can try to do any of the
   following:

   o  Pretend that a non-compatible server is actually capable of this
      extension and select a group from the client's list, causing the
      client to select a group it is willing to negotiate.  It is
      unclear how this would be an effective attack.

   o  Pretend that a compatible server is actually non-compatible by
      negotiating a non-FFDHE cipher suite.  This is no different than
      MITM cipher suite filtering.

   o  Pretend that a compatible server is actually non-compatible by
      negotiating a DHE cipher suite with a custom (perhaps weak) group
      selected by the attacker.  This is no worse than the current
      scenario and would require the attacker to be able to sign the
      ServerDHParams, which should not be possible without access to the
      server's secret key.

   An attacker who impersonates the client can try to do the following:

   o  Pretend that a compatible client is not compatible (e.g., by not
      offering the Supported Groups extension or by replacing the
      Supported Groups extension with one that includes no FFDHE
      groups).  This could cause the server to negotiate a weaker DHE
      group during the handshake or to select a non-FFDHE cipher suite,
      but it would fail to complete during the final check of the
      Finished message.

   o  Pretend that a non-compatible client is compatible (e.g., by
      adding the Supported Groups extension or by adding FFDHE groups to
      the extension).  This could cause the server to select a
      particular named group in the ServerKeyExchange or to avoid
      selecting an FFDHE cipher suite.  The peers would fail to compute
      the final check of the Finished message.

Gillmor                      Standards Track                   [Page 12]
```

---

```

[RFC 7919](./rfc7919)                Negotiated FFDHE for TLS             August 2016

   o  Change the list of groups offered by the client (e.g., by removing
      the stronger of the set of groups offered).  This could cause the
      server to negotiate a weaker group than desired, but again, should
      be caught by the check in the Finished message.

[8.2](#section-8.2).  Group Strength Considerations

   TLS implementations using FFDHE key exchange should consider the
   strength of the group they negotiate.  The strength of the selected
   group is one of the factors that define the connection's resilience
   against attacks on the session's confidentiality and integrity, since
   the session keys are derived from the DHE handshake.

   While attacks on integrity must generally happen while the session is
   in progress, attacks against session confidentiality can happen
   significantly later if the entire TLS session is stored for offline
   analysis.  Therefore, FFDHE groups should be selected by clients and
   servers based on confidentiality guarantees they need.  Sessions that
   need extremely long-term confidentiality should prefer stronger
   groups.

   [ENISA] provides rough estimates of group resistance to attack and
   recommends that forward-looking implementations ("future systems")
   should use FFDHE group sizes of at least 3072 bits.  ffdhe3072 is
   intended for use in these implementations.

   Other sources (e.g., [[NIST](#ref-NIST "\"Recommendation for Key Management - Part 1: General\"")]) estimate the security levels of the
   Discrete Log (DLOG) problem to be slightly more difficult than
   [[ENISA](#ref-ENISA "\"Algorithms, Key Sizes and Parameters Report - 2014\"")].  This document's suggested minimum exponent sizes in
   [Appendix A](#appendix-A) for implementations that use the short-exponent
   optimization ([Section 5.2](#section-5.2)) are deliberately conservative to account
   for the range of these estimates.

[8.3](#section-8.3).  Finite Field DHE Only

   Note that this document specifically targets only finite field
   Diffie-Hellman ephemeral key exchange mechanisms.  It does not cover
   the non-ephemeral DH key exchange mechanisms, nor does it address
   ECDHE key exchange, which is defined in [[RFC4492](./rfc4492 "\"Elliptic Curve Cryptography (ECC) Cipher Suites for Transport Layer Security (TLS)\"")].

   Measured by computational cost to the TLS peers, ECDHE appears today
   to offer a much stronger key exchange mechanism than FFDHE.

Gillmor                      Standards Track                   [Page 13]
```

---

```

[RFC 7919](./rfc7919)                Negotiated FFDHE for TLS             August 2016

[8.4](#section-8.4).  Deprecating Weak Groups

   Advances in hardware or in finite field cryptanalysis may cause some
   of the negotiated groups to not provide the desired security margins,
   as indicated by the estimated work factor of an adversary to discover
   the premaster secret (and may therefore compromise the
   confidentiality and integrity of the TLS session).

   Revisions of this document should mark known weak groups as
   explicitly deprecated for use in TLS and should update the estimated
   work factor needed to break the group if the cryptanalysis has
   changed.  Implementations that require strong confidentiality and
   integrity guarantees should avoid using deprecated groups and should
   be updated when the estimated security margins are updated.

[8.5](#section-8.5).  Choice of Groups

   Other lists of named finite field Diffie-Hellman groups
   [[STRONGSWAN-IKE](#ref-STRONGSWAN-IKE)] exist.  This document chooses to not reuse them for
   several reasons:

   o  Using the same groups in multiple protocols increases the value
      for an attacker with the resources to crack any single group.

   o  The Internet Key Exchange Protocol (IKE) groups include weak
      groups like MODP768 that are unacceptable for secure TLS traffic.

   o  Mixing group parameters across multiple implementations leaves
      open the possibility of some sort of cross-protocol attack.  This
      shouldn't be relevant for ephemeral scenarios, and even with non-
      ephemeral keying, services shouldn't share keys; however, using
      different groups avoids these failure modes entirely.

[8.6](#section-8.6).  Timing Attacks

   Any implementation of finite field Diffie-Hellman key exchange should
   use constant-time modular-exponentiation implementations.  This is
   particularly true for those implementations that ever reuse DHE
   secret keys (so-called "semi-static" ephemeral keying) or share DHE
   secret keys across a multiple machines (e.g., in a load-balancer
   situation).

Gillmor                      Standards Track                   [Page 14]
```

---

```

[RFC 7919](./rfc7919)                Negotiated FFDHE for TLS             August 2016

[8.7](#section-8.7).  Replay Attacks from Non-negotiated FFDHE

   [[SECURE-RESUMPTION](#ref-SECURE-RESUMPTION)], [[CROSS-PROTOCOL](#ref-CROSS-PROTOCOL)], and [[SSL3-ANALYSIS](#ref-SSL3-ANALYSIS)] all show a
   malicious peer using a bad FFDHE group to maneuver a client into
   selecting a premaster secret of the peer's choice, which can be
   replayed to another server using a non-FFDHE key exchange and can
   then be bootstrapped to replay client authentication.

   To prevent this attack (barring the session hash fix documented in
   [[RFC7627](./rfc7627 "\"Transport Layer Security (TLS) Session Hash and Extended Master Secret Extension\"")]), a client would need not only to implement this document,
   but also to reject non-negotiated FFDHE cipher suites whose group
   structure it cannot afford to verify.  Such a client would need to
   abort the initial handshake and reconnect to the server in question
   without listing any FFDHE cipher suites on the subsequent connection.

   This trade-off may be too costly for most TLS clients today but may
   be a reasonable choice for clients performing client certificate
   authentication or for clients who have other reasons to be concerned
   about server-controlled premaster secrets.

[8.8](#section-8.8).  Forward Secrecy

   One of the main reasons to prefer FFDHE ciphersuites is forward
   secrecy, the ability to resist decryption even if the endpoint's
   long-term secret key (usually RSA) is revealed in the future.

   This property depends on both sides of the connection discarding
   their ephemeral keys promptly.  Implementations should wipe their
   FFDHE secret key material from memory as soon as it is no longer
   needed and should never store it in persistent storage.

   Forward secrecy also depends on the strength of the Diffie-Hellman
   group; using a very strong symmetric cipher like AES256 with a
   forward-secret cipher suite but generating the keys with a much
   weaker group like dhe2048 simply moves the adversary's cost from
   attacking the symmetric cipher to attacking the dh_Ys or dh_Yc
   ephemeral key shares.

   If the goal is to provide forward secrecy, attention should be paid
   to all parts of the cipher suite selection process, both key exchange
   and symmetric cipher choice.

[8.9](#section-8.9).  False Start

   Clients capable of TLS False Start [[RFC7918](./rfc7918 "\"Transport Layer Security (TLS) False Start\"")] may receive a proposed
   FFDHE group from a server that is attacker controlled.  In
   particular, the attacker can modify the ClientHello to strip the
   proposed FFDHE groups, which may cause the server to offer a weaker

Gillmor                      Standards Track                   [Page 15]
```

---

```

[RFC 7919](./rfc7919)                Negotiated FFDHE for TLS             August 2016

   FFDHE group than it should, and this will not be detected until
   receipt of the server's Finished message.  This could cause a client
   using the False Start protocol modification to send data encrypted
   under a weak key agreement.

   Clients should have their own classification of FFDHE groups that are
   "cryptographically strong" in the same sense described in the
   description of symmetric ciphers in [[RFC7918](./rfc7918 "\"Transport Layer Security (TLS) False Start\"")] and SHOULD offer at
   least one of these in the initial handshake if they contemplate using
   the False Start protocol modification with an FFDHE cipher suite.

   Compatible clients performing a full handshake MUST NOT use the False
   Start protocol modification if the server selects an FFDHE cipher
   suite but sends a group that is not cryptographically strong from the
   client's perspective.

[9](#section-9).  Privacy Considerations

[9.1](#section-9.1).  Client Fingerprinting

   This extension provides a few additional bits of information to
   distinguish between classes of TLS clients (e.g., see
   [[PANOPTICLICK](#ref-PANOPTICLICK)]).  To minimize this sort of fingerprinting, clients
   SHOULD support all named groups at or above their minimum security
   threshold.  New groups SHOULD NOT be added to the "Supported Groups
   Registry" without consideration of the cost of browser
   fingerprinting.

[10](#section-10).  References

[10.1](#section-10.1).  Normative References

   [RFC2119]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", [BCP 14](https://www.rfc-editor.org/bcp/bcp14), [RFC 2119](./rfc2119),
              DOI 10.17487/RFC2119, March 1997,
              <[http://www.rfc-editor.org/info/rfc2119](https://www.rfc-editor.org/info/rfc2119)>.

   [RFC4492]  Blake-Wilson, S., Bolyard, N., Gupta, V., Hawk, C., and B.
              Moeller, "Elliptic Curve Cryptography (ECC) Cipher Suites
              for Transport Layer Security (TLS)", [RFC 4492](./rfc4492),
              DOI 10.17487/RFC4492, May 2006,
              <[http://www.rfc-editor.org/info/rfc4492](https://www.rfc-editor.org/info/rfc4492)>.

   [RFC5226]  Narten, T. and H. Alvestrand, "Guidelines for Writing an
              IANA Considerations Section in RFCs", [BCP 26](https://www.rfc-editor.org/bcp/bcp26), [RFC 5226](./rfc5226),
              DOI 10.17487/RFC5226, May 2008,
              <[http://www.rfc-editor.org/info/rfc5226](https://www.rfc-editor.org/info/rfc5226)>.

Gillmor                      Standards Track                   [Page 16]
```

---

```

[RFC 7919](./rfc7919)                Negotiated FFDHE for TLS             August 2016

   [RFC5246]  Dierks, T. and E. Rescorla, "The Transport Layer Security
              (TLS) Protocol Version 1.2", [RFC 5246](./rfc5246),
              DOI 10.17487/RFC5246, August 2008,
              <[http://www.rfc-editor.org/info/rfc5246](https://www.rfc-editor.org/info/rfc5246)>.

   [RFC7918]  Langley, A., Modadugu, N., and B. Moeller, "Transport
              Layer Security (TLS) False Start", DOI 10.17487/RFC7918,
              June 2016, <[http://www.rfc-editor.org/info/rfc7918](https://www.rfc-editor.org/info/rfc7918)>.

[10.2](#section-10.2).  Informative References

   [CROSS-PROTOCOL]
              Mavrogiannopolous, N., Vercauteren, F., Velichkov, V., and
              B. Preneel, "A Cross-Protocol Attack on the TLS Protocol",
              In Proceedings of the 2012 ACM Conference on Computer and
              Communications Security, DOI 10.1145/2382196.2382206,
              October 2012, <[http://www.cosic.esat.kuleuven.be/](http://www.cosic.esat.kuleuven.be/publications/article-2216.pdf)
              [publications/article-2216.pdf](http://www.cosic.esat.kuleuven.be/publications/article-2216.pdf)>.

   [ECRYPTII]
              European Network of Excellence in Cryptology II, "ECRYPT
              II Yearly Report on Algorithms and Keysizes (2011-2012)",
              Revision 1.0, September 2012,
              <<http://www.ecrypt.eu.org/ecrypt2/documents/D.SPA.20.pdf>>.

   [ENISA]    European Union Agency for Network and Information Security
              (ENISA), "Algorithms, Key Sizes and Parameters Report -
              2014", November 2014,
              <[https://www.enisa.europa.eu/publications/](https://www.enisa.europa.eu/publications/algorithms-key-size-and-parameters-report-2014)
              [algorithms-key-size-and-parameters-report-2014](https://www.enisa.europa.eu/publications/algorithms-key-size-and-parameters-report-2014)>.

   [NIST]     National Institute of Standards and Technology,
              "Recommendation for Key Management - Part 1: General",
              NIST Special Publication 800-57, Revision 4,
              DOI 10.6028/NIST.SP.800-57pt1r4, January 2016,
              <[http://nvlpubs.nist.gov/nistpubs/SpecialPublications/](http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-57pt1r4.pdf)
              [NIST.SP.800-57pt1r4.pdf](http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-57pt1r4.pdf)>.

   [PANOPTICLICK]
              Electronic Frontier Foundation, "Panopticlick: Is your
              browser safe against tracking?",
              <<https://panopticlick.eff.org/>>.

   [RFC2246]  Dierks, T. and C. Allen, "The TLS Protocol Version 1.0",
              [RFC 2246](./rfc2246), DOI 10.17487/RFC2246, January 1999,
              <[http://www.rfc-editor.org/info/rfc2246](https://www.rfc-editor.org/info/rfc2246)>.

Gillmor                      Standards Track                   [Page 17]
```

---

```

[RFC 7919](./rfc7919)                Negotiated FFDHE for TLS             August 2016

   [RFC3526]  Kivinen, T. and M. Kojo, "More Modular Exponential (MODP)
              Diffie-Hellman groups for Internet Key Exchange (IKE)",
              [RFC 3526](./rfc3526), DOI 10.17487/RFC3526, May 2003,
              <[http://www.rfc-editor.org/info/rfc3526](https://www.rfc-editor.org/info/rfc3526)>.

   [RFC4346]  Dierks, T. and E. Rescorla, "The Transport Layer Security
              (TLS) Protocol Version 1.1", [RFC 4346](./rfc4346),
              DOI 10.17487/RFC4346, April 2006,
              <[http://www.rfc-editor.org/info/rfc4346](https://www.rfc-editor.org/info/rfc4346)>.

   [RFC4419]  Friedl, M., Provos, N., and W. Simpson, "Diffie-Hellman
              Group Exchange for the Secure Shell (SSH) Transport Layer
              Protocol", [RFC 4419](./rfc4419), DOI 10.17487/RFC4419, March 2006,
              <[http://www.rfc-editor.org/info/rfc4419](https://www.rfc-editor.org/info/rfc4419)>.

   [RFC7027]  Merkle, J. and M. Lochter, "Elliptic Curve Cryptography
              (ECC) Brainpool Curves for Transport Layer Security
              (TLS)", [RFC 7027](./rfc7027), DOI 10.17487/RFC7027, October 2013,
              <[http://www.rfc-editor.org/info/rfc7027](https://www.rfc-editor.org/info/rfc7027)>.

   [RFC7627]  Bhargavan, K., Ed., Delignat-Lavaud, A., Pironti, A.,
              Langley, A., and M. Ray, "Transport Layer Security (TLS)
              Session Hash and Extended Master Secret Extension",
              [RFC 7627](./rfc7627), DOI 10.17487/RFC7627, September 2015,
              <[http://www.rfc-editor.org/info/rfc7627](https://www.rfc-editor.org/info/rfc7627)>.

   [SECURE-RESUMPTION]
              Delignat-Lavaud, A., Bhargavan, K., and A. Pironti,
              "Triple Handshakes Considered Harmful: Breaking and Fixing
              Authentication over TLS", 2014 IEEE Symposium on
              Security and Privacy, DOI 10.1109/SP.2014.14, March 2014,
              <<https://secure-resumption.com/>>.

   [SSL3-ANALYSIS]
              Schneier, B. and D. Wagner, "Analysis of the SSL 3.0
              protocol", In Proceedings of the Second UNIX Workshop
              on Electronic Commerce, 1996,
              <<https://www.schneier.com/paper-ssl.pdf>>.

   [STRONGSWAN-IKE]
              Brunner, T. and A. Steffen, "IKEv2 Cipher Suites: Diffie
              Hellman Groups", October 2013,
              <[https://wiki.strongswan.org/projects/strongswan/wiki/](https://wiki.strongswan.org/projects/strongswan/wiki/IKEv2CipherSuites#Diffie-Hellman-Groups)
              [IKEv2CipherSuites#Diffie-Hellman-Groups](https://wiki.strongswan.org/projects/strongswan/wiki/IKEv2CipherSuites#Diffie-Hellman-Groups)>.

Gillmor                      Standards Track                   [Page 18]
```

---

```

[RFC 7919](./rfc7919)                Negotiated FFDHE for TLS             August 2016

[Appendix A](#appendix-A).  Supported Groups Registry (Formerly "EC Named Curve
             Registry")

   Each description below indicates the group itself, its derivation,
   its expected strength (estimated roughly from guidelines in
   [[ECRYPTII](#ref-ECRYPTII)]), and whether it is recommended for use in TLS key
   exchange at the given security level.  It is not recommended to add
   further finite field groups to the "Supported Groups Registry"; any
   attempt to do so should consider [Section 9.1](#section-9.1).

   The primes in these finite field groups are all safe primes; that is,
   a prime p is a safe prime when q = (p-1)/2 is also prime.  Where e is
   the base of the natural logarithm and square brackets denote the
   floor operation, the groups that initially populate this registry are
   derived for a given bit length b by finding the lowest positive
   integer X that creates a safe prime p where:

    p = 2^b - 2^{b-64} + {[2^{b-130} e] + X } * 2^64 - 1

   New additions of FFDHE groups to this registry may use this same
   derivation (e.g., with different bit lengths) or may choose their
   parameters in a different way, but they must be clear about how the
   parameters were derived.

   New additions of FFDHE groups MUST use a safe prime as the modulus to
   enable the inexpensive peer verification described in [Section 5.1](#section-5.1).

[A.1](#appendix-A.1).  ffdhe2048

   The 2048-bit group has registry value 256 and is calculated from the
   following formula:

   The modulus is:

   p = 2^2048 - 2^1984 + {[2^1918 * e] + 560316 } * 2^64 - 1

Gillmor                      Standards Track                   [Page 19]
```

---

```

[RFC 7919](./rfc7919)                Negotiated FFDHE for TLS             August 2016

   The hexadecimal representation of p is:

    FFFFFFFF FFFFFFFF ADF85458 A2BB4A9A AFDC5620 273D3CF1
    D8B9C583 CE2D3695 A9E13641 146433FB CC939DCE 249B3EF9
    7D2FE363 630C75D8 F681B202 AEC4617A D3DF1ED5 D5FD6561
    2433F51F 5F066ED0 85636555 3DED1AF3 B557135E 7F57C935
    984F0C70 E0E68B77 E2A689DA F3EFE872 1DF158A1 36ADE735
    30ACCA4F 483A797A BC0AB182 B324FB61 D108A94B B2C8E3FB
    B96ADAB7 60D7F468 1D4F42A3 DE394DF4 AE56EDE7 6372BB19
    0B07A7C8 EE0A6D70 9E02FCE1 CDF7E2EC C03404CD 28342F61
    9172FE9C E98583FF 8E4F1232 EEF28183 C3FE3B1B 4C6FAD73
    3BB5FCBC 2EC22005 C58EF183 7D1683B2 C6F34A26 C1B2EFFA
    886B4238 61285C97 FFFFFFFF FFFFFFFF

   The generator is: g = 2

   The group size is: q = (p-1)/2

   The hexadecimal representation of q is:

    7FFFFFFF FFFFFFFF D6FC2A2C 515DA54D 57EE2B10 139E9E78
    EC5CE2C1 E7169B4A D4F09B20 8A3219FD E649CEE7 124D9F7C
    BE97F1B1 B1863AEC 7B40D901 576230BD 69EF8F6A EAFEB2B0
    9219FA8F AF833768 42B1B2AA 9EF68D79 DAAB89AF 3FABE49A
    CC278638 707345BB F15344ED 79F7F439 0EF8AC50 9B56F39A
    98566527 A41D3CBD 5E0558C1 59927DB0 E88454A5 D96471FD
    DCB56D5B B06BFA34 0EA7A151 EF1CA6FA 572B76F3 B1B95D8C
    8583D3E4 770536B8 4F017E70 E6FBF176 601A0266 941A17B0
    C8B97F4E 74C2C1FF C7278919 777940C1 E1FF1D8D A637D6B9
    9DDAFE5E 17611002 E2C778C1 BE8B41D9 6379A513 60D977FD
    4435A11C 30942E4B FFFFFFFF FFFFFFFF

   The estimated symmetric-equivalent strength of this group is 103
   bits.

   Peers using ffdhe2048 that want to optimize their key exchange with a
   short exponent ([Section 5.2](#section-5.2)) should choose a secret key of at least
   225 bits.

[A.2](#appendix-A.2).  ffdhe3072

   The 3072-bit prime has registry value 257 and is calculated from the
   following formula:

   The modulus is:

   p = 2^3072 - 2^3008 + {[2^2942 * e] + 2625351} * 2^64 - 1

Gillmor                      Standards Track                   [Page 20]
```

---

```

[RFC 7919](./rfc7919)                Negotiated FFDHE for TLS             August 2016

   The hexadecimal representation of p is:

    FFFFFFFF FFFFFFFF ADF85458 A2BB4A9A AFDC5620 273D3CF1
    D8B9C583 CE2D3695 A9E13641 146433FB CC939DCE 249B3EF9
    7D2FE363 630C75D8 F681B202 AEC4617A D3DF1ED5 D5FD6561
    2433F51F 5F066ED0 85636555 3DED1AF3 B557135E 7F57C935
    984F0C70 E0E68B77 E2A689DA F3EFE872 1DF158A1 36ADE735
    30ACCA4F 483A797A BC0AB182 B324FB61 D108A94B B2C8E3FB
    B96ADAB7 60D7F468 1D4F42A3 DE394DF4 AE56EDE7 6372BB19
    0B07A7C8 EE0A6D70 9E02FCE1 CDF7E2EC C03404CD 28342F61
    9172FE9C E98583FF 8E4F1232 EEF28183 C3FE3B1B 4C6FAD73
    3BB5FCBC 2EC22005 C58EF183 7D1683B2 C6F34A26 C1B2EFFA
    886B4238 611FCFDC DE355B3B 6519035B BC34F4DE F99C0238
    61B46FC9 D6E6C907 7AD91D26 91F7F7EE 598CB0FA C186D91C
    AEFE1309 85139270 B4130C93 BC437944 F4FD4452 E2D74DD3
    64F2E21E 71F54BFF 5CAE82AB 9C9DF69E E86D2BC5 22363A0D
    ABC52197 9B0DEADA 1DBF9A42 D5C4484E 0ABCD06B FA53DDEF
    3C1B20EE 3FD59D7C 25E41D2B 66C62E37 FFFFFFFF FFFFFFFF

   The generator is: g = 2

   The group size is: q = (p-1)/2

   The hexadecimal representation of q is:

    7FFFFFFF FFFFFFFF D6FC2A2C 515DA54D 57EE2B10 139E9E78
    EC5CE2C1 E7169B4A D4F09B20 8A3219FD E649CEE7 124D9F7C
    BE97F1B1 B1863AEC 7B40D901 576230BD 69EF8F6A EAFEB2B0
    9219FA8F AF833768 42B1B2AA 9EF68D79 DAAB89AF 3FABE49A
    CC278638 707345BB F15344ED 79F7F439 0EF8AC50 9B56F39A
    98566527 A41D3CBD 5E0558C1 59927DB0 E88454A5 D96471FD
    DCB56D5B B06BFA34 0EA7A151 EF1CA6FA 572B76F3 B1B95D8C
    8583D3E4 770536B8 4F017E70 E6FBF176 601A0266 941A17B0
    C8B97F4E 74C2C1FF C7278919 777940C1 E1FF1D8D A637D6B9
    9DDAFE5E 17611002 E2C778C1 BE8B41D9 6379A513 60D977FD
    4435A11C 308FE7EE 6F1AAD9D B28C81AD DE1A7A6F 7CCE011C
    30DA37E4 EB736483 BD6C8E93 48FBFBF7 2CC6587D 60C36C8E
    577F0984 C289C938 5A098649 DE21BCA2 7A7EA229 716BA6E9
    B279710F 38FAA5FF AE574155 CE4EFB4F 743695E2 911B1D06
    D5E290CB CD86F56D 0EDFCD21 6AE22427 055E6835 FD29EEF7
    9E0D9077 1FEACEBE 12F20E95 B363171B FFFFFFFF FFFFFFFF

   The estimated symmetric-equivalent strength of this group is 125
   bits.

   Peers using ffdhe3072 that want to optimize their key exchange with a
   short exponent ([Section 5.2](#section-5.2)) should choose a secret key of at least
   275 bits.

Gillmor                      Standards Track                   [Page 21]
```

---

```

[RFC 7919](./rfc7919)                Negotiated FFDHE for TLS             August 2016

[A.3](#appendix-A.3).  ffdhe4096

   The 4096-bit group has registry value 258 and is calculated from the
   following formula:

   The modulus is:

   p = 2^4096 - 2^4032 + {[2^3966 * e] + 5736041} * 2^64 - 1

   The hexadecimal representation of p is:

    FFFFFFFF FFFFFFFF ADF85458 A2BB4A9A AFDC5620 273D3CF1
    D8B9C583 CE2D3695 A9E13641 146433FB CC939DCE 249B3EF9
    7D2FE363 630C75D8 F681B202 AEC4617A D3DF1ED5 D5FD6561
    2433F51F 5F066ED0 85636555 3DED1AF3 B557135E 7F57C935
    984F0C70 E0E68B77 E2A689DA F3EFE872 1DF158A1 36ADE735
    30ACCA4F 483A797A BC0AB182 B324FB61 D108A94B B2C8E3FB
    B96ADAB7 60D7F468 1D4F42A3 DE394DF4 AE56EDE7 6372BB19
    0B07A7C8 EE0A6D70 9E02FCE1 CDF7E2EC C03404CD 28342F61
    9172FE9C E98583FF 8E4F1232 EEF28183 C3FE3B1B 4C6FAD73
    3BB5FCBC 2EC22005 C58EF183 7D1683B2 C6F34A26 C1B2EFFA
    886B4238 611FCFDC DE355B3B 6519035B BC34F4DE F99C0238
    61B46FC9 D6E6C907 7AD91D26 91F7F7EE 598CB0FA C186D91C
    AEFE1309 85139270 B4130C93 BC437944 F4FD4452 E2D74DD3
    64F2E21E 71F54BFF 5CAE82AB 9C9DF69E E86D2BC5 22363A0D
    ABC52197 9B0DEADA 1DBF9A42 D5C4484E 0ABCD06B FA53DDEF
    3C1B20EE 3FD59D7C 25E41D2B 669E1EF1 6E6F52C3 164DF4FB
    7930E9E4 E58857B6 AC7D5F42 D69F6D18 7763CF1D 55034004
    87F55BA5 7E31CC7A 7135C886 EFB4318A ED6A1E01 2D9E6832
    A907600A 918130C4 6DC778F9 71AD0038 092999A3 33CB8B7A
    1A1DB93D 7140003C 2A4ECEA9 F98D0ACC 0A8291CD CEC97DCF
    8EC9B55A 7F88A46B 4DB5A851 F44182E1 C68A007E 5E655F6A
    FFFFFFFF FFFFFFFF

   The generator is: g = 2

   The group size is: q = (p-1)/2

Gillmor                      Standards Track                   [Page 22]
```

---

```

[RFC 7919](./rfc7919)                Negotiated FFDHE for TLS             August 2016

   The hexadecimal representation of q is:

    7FFFFFFF FFFFFFFF D6FC2A2C 515DA54D 57EE2B10 139E9E78
    EC5CE2C1 E7169B4A D4F09B20 8A3219FD E649CEE7 124D9F7C
    BE97F1B1 B1863AEC 7B40D901 576230BD 69EF8F6A EAFEB2B0
    9219FA8F AF833768 42B1B2AA 9EF68D79 DAAB89AF 3FABE49A
    CC278638 707345BB F15344ED 79F7F439 0EF8AC50 9B56F39A
    98566527 A41D3CBD 5E0558C1 59927DB0 E88454A5 D96471FD
    DCB56D5B B06BFA34 0EA7A151 EF1CA6FA 572B76F3 B1B95D8C
    8583D3E4 770536B8 4F017E70 E6FBF176 601A0266 941A17B0
    C8B97F4E 74C2C1FF C7278919 777940C1 E1FF1D8D A637D6B9
    9DDAFE5E 17611002 E2C778C1 BE8B41D9 6379A513 60D977FD
    4435A11C 308FE7EE 6F1AAD9D B28C81AD DE1A7A6F 7CCE011C
    30DA37E4 EB736483 BD6C8E93 48FBFBF7 2CC6587D 60C36C8E
    577F0984 C289C938 5A098649 DE21BCA2 7A7EA229 716BA6E9
    B279710F 38FAA5FF AE574155 CE4EFB4F 743695E2 911B1D06
    D5E290CB CD86F56D 0EDFCD21 6AE22427 055E6835 FD29EEF7
    9E0D9077 1FEACEBE 12F20E95 B34F0F78 B737A961 8B26FA7D
    BC9874F2 72C42BDB 563EAFA1 6B4FB68C 3BB1E78E AA81A002
    43FAADD2 BF18E63D 389AE443 77DA18C5 76B50F00 96CF3419
    5483B005 48C09862 36E3BC7C B8D6801C 0494CCD1 99E5C5BD
    0D0EDC9E B8A0001E 15276754 FCC68566 054148E6 E764BEE7
    C764DAAD 3FC45235 A6DAD428 FA20C170 E345003F 2F32AFB5
    7FFFFFFF FFFFFFFF

   The estimated symmetric-equivalent strength of this group is 150
   bits.

   Peers using ffdhe4096 that want to optimize their key exchange with a
   short exponent ([Section 5.2](#section-5.2)) should choose a secret key of at least
   325 bits.

[A.4](#appendix-A.4).  ffdhe6144

   The 6144-bit group has registry value 259 and is calculated from the
   following formula:

   The modulus is:

   p = 2^6144 - 2^6080 + {[2^6014 * e] + 15705020} * 2^64 - 1

Gillmor                      Standards Track                   [Page 23]
```

---

```

[RFC 7919](./rfc7919)                Negotiated FFDHE for TLS             August 2016

   The hexadecimal representation of p is:

    FFFFFFFF FFFFFFFF ADF85458 A2BB4A9A AFDC5620 273D3CF1
    D8B9C583 CE2D3695 A9E13641 146433FB CC939DCE 249B3EF9
    7D2FE363 630C75D8 F681B202 AEC4617A D3DF1ED5 D5FD6561
    2433F51F 5F066ED0 85636555 3DED1AF3 B557135E 7F57C935
    984F0C70 E0E68B77 E2A689DA F3EFE872 1DF158A1 36ADE735
    30ACCA4F 483A797A BC0AB182 B324FB61 D108A94B B2C8E3FB
    B96ADAB7 60D7F468 1D4F42A3 DE394DF4 AE56EDE7 6372BB19
    0B07A7C8 EE0A6D70 9E02FCE1 CDF7E2EC C03404CD 28342F61
    9172FE9C E98583FF 8E4F1232 EEF28183 C3FE3B1B 4C6FAD73
    3BB5FCBC 2EC22005 C58EF183 7D1683B2 C6F34A26 C1B2EFFA
    886B4238 611FCFDC DE355B3B 6519035B BC34F4DE F99C0238
    61B46FC9 D6E6C907 7AD91D26 91F7F7EE 598CB0FA C186D91C
    AEFE1309 85139270 B4130C93 BC437944 F4FD4452 E2D74DD3
    64F2E21E 71F54BFF 5CAE82AB 9C9DF69E E86D2BC5 22363A0D
    ABC52197 9B0DEADA 1DBF9A42 D5C4484E 0ABCD06B FA53DDEF
    3C1B20EE 3FD59D7C 25E41D2B 669E1EF1 6E6F52C3 164DF4FB
    7930E9E4 E58857B6 AC7D5F42 D69F6D18 7763CF1D 55034004
    87F55BA5 7E31CC7A 7135C886 EFB4318A ED6A1E01 2D9E6832
    A907600A 918130C4 6DC778F9 71AD0038 092999A3 33CB8B7A
    1A1DB93D 7140003C 2A4ECEA9 F98D0ACC 0A8291CD CEC97DCF
    8EC9B55A 7F88A46B 4DB5A851 F44182E1 C68A007E 5E0DD902
    0BFD64B6 45036C7A 4E677D2C 38532A3A 23BA4442 CAF53EA6
    3BB45432 9B7624C8 917BDD64 B1C0FD4C B38E8C33 4C701C3A
    CDAD0657 FCCFEC71 9B1F5C3E 4E46041F 388147FB 4CFDB477
    A52471F7 A9A96910 B855322E DB6340D8 A00EF092 350511E3
    0ABEC1FF F9E3A26E 7FB29F8C 183023C3 587E38DA 0077D9B4
    763E4E4B 94B2BBC1 94C6651E 77CAF992 EEAAC023 2A281BF6
    B3A739C1 22611682 0AE8DB58 47A67CBE F9C9091B 462D538C
    D72B0374 6AE77F5E 62292C31 1562A846 505DC82D B854338A
    E49F5235 C95B9117 8CCF2DD5 CACEF403 EC9D1810 C6272B04
    5B3B71F9 DC6B80D6 3FDD4A8E 9ADB1E69 62A69526 D43161C1
    A41D570D 7938DAD4 A40E329C D0E40E65 FFFFFFFF FFFFFFFF

   The generator is: g = 2

   The group size is: q = (p-1)/2

Gillmor                      Standards Track                   [Page 24]
```

---

```

[RFC 7919](./rfc7919)                Negotiated FFDHE for TLS             August 2016

   The hexadecimal representation of q is:

    7FFFFFFF FFFFFFFF D6FC2A2C 515DA54D 57EE2B10 139E9E78
    EC5CE2C1 E7169B4A D4F09B20 8A3219FD E649CEE7 124D9F7C
    BE97F1B1 B1863AEC 7B40D901 576230BD 69EF8F6A EAFEB2B0
    9219FA8F AF833768 42B1B2AA 9EF68D79 DAAB89AF 3FABE49A
    CC278638 707345BB F15344ED 79F7F439 0EF8AC50 9B56F39A
    98566527 A41D3CBD 5E0558C1 59927DB0 E88454A5 D96471FD
    DCB56D5B B06BFA34 0EA7A151 EF1CA6FA 572B76F3 B1B95D8C
    8583D3E4 770536B8 4F017E70 E6FBF176 601A0266 941A17B0
    C8B97F4E 74C2C1FF C7278919 777940C1 E1FF1D8D A637D6B9
    9DDAFE5E 17611002 E2C778C1 BE8B41D9 6379A513 60D977FD
    4435A11C 308FE7EE 6F1AAD9D B28C81AD DE1A7A6F 7CCE011C
    30DA37E4 EB736483 BD6C8E93 48FBFBF7 2CC6587D 60C36C8E
    577F0984 C289C938 5A098649 DE21BCA2 7A7EA229 716BA6E9
    B279710F 38FAA5FF AE574155 CE4EFB4F 743695E2 911B1D06
    D5E290CB CD86F56D 0EDFCD21 6AE22427 055E6835 FD29EEF7
    9E0D9077 1FEACEBE 12F20E95 B34F0F78 B737A961 8B26FA7D
    BC9874F2 72C42BDB 563EAFA1 6B4FB68C 3BB1E78E AA81A002
    43FAADD2 BF18E63D 389AE443 77DA18C5 76B50F00 96CF3419
    5483B005 48C09862 36E3BC7C B8D6801C 0494CCD1 99E5C5BD
    0D0EDC9E B8A0001E 15276754 FCC68566 054148E6 E764BEE7
    C764DAAD 3FC45235 A6DAD428 FA20C170 E345003F 2F06EC81
    05FEB25B 2281B63D 2733BE96 1C29951D 11DD2221 657A9F53
    1DDA2A19 4DBB1264 48BDEEB2 58E07EA6 59C74619 A6380E1D
    66D6832B FE67F638 CD8FAE1F 2723020F 9C40A3FD A67EDA3B
    D29238FB D4D4B488 5C2A9917 6DB1A06C 50077849 1A8288F1
    855F60FF FCF1D137 3FD94FC6 0C1811E1 AC3F1C6D 003BECDA
    3B1F2725 CA595DE0 CA63328F 3BE57CC9 77556011 95140DFB
    59D39CE0 91308B41 05746DAC 23D33E5F 7CE4848D A316A9C6
    6B9581BA 3573BFAF 31149618 8AB15423 282EE416 DC2A19C5
    724FA91A E4ADC88B C66796EA E5677A01 F64E8C08 63139582
    2D9DB8FC EE35C06B 1FEEA547 4D6D8F34 B1534A93 6A18B0E0
    D20EAB86 BC9C6D6A 5207194E 68720732 FFFFFFFF FFFFFFFF

   The estimated symmetric-equivalent strength of this group is 175
   bits.

   Peers using ffdhe6144 that want to optimize their key exchange with a
   short exponent ([Section 5.2](#section-5.2)) should choose a secret key of at least
   375 bits.

Gillmor                      Standards Track                   [Page 25]
```

---

```

[RFC 7919](./rfc7919)                Negotiated FFDHE for TLS             August 2016

[A.5](#appendix-A.5).  ffdhe8192

   The 8192-bit group has registry value 260 and is calculated from the
   following formula:

   The modulus is:

   p = 2^8192 - 2^8128 + {[2^8062 * e] + 10965728} * 2^64 - 1

Gillmor                      Standards Track                   [Page 26]
```

---

```

[RFC 7919](./rfc7919)                Negotiated FFDHE for TLS             August 2016

   The hexadecimal representation of p is:

    FFFFFFFF FFFFFFFF ADF85458 A2BB4A9A AFDC5620 273D3CF1
    D8B9C583 CE2D3695 A9E13641 146433FB CC939DCE 249B3EF9
    7D2FE363 630C75D8 F681B202 AEC4617A D3DF1ED5 D5FD6561
    2433F51F 5F066ED0 85636555 3DED1AF3 B557135E 7F57C935
    984F0C70 E0E68B77 E2A689DA F3EFE872 1DF158A1 36ADE735
    30ACCA4F 483A797A BC0AB182 B324FB61 D108A94B B2C8E3FB
    B96ADAB7 60D7F468 1D4F42A3 DE394DF4 AE56EDE7 6372BB19
    0B07A7C8 EE0A6D70 9E02FCE1 CDF7E2EC C03404CD 28342F61
    9172FE9C E98583FF 8E4F1232 EEF28183 C3FE3B1B 4C6FAD73
    3BB5FCBC 2EC22005 C58EF183 7D1683B2 C6F34A26 C1B2EFFA
    886B4238 611FCFDC DE355B3B 6519035B BC34F4DE F99C0238
    61B46FC9 D6E6C907 7AD91D26 91F7F7EE 598CB0FA C186D91C
    AEFE1309 85139270 B4130C93 BC437944 F4FD4452 E2D74DD3
    64F2E21E 71F54BFF 5CAE82AB 9C9DF69E E86D2BC5 22363A0D
    ABC52197 9B0DEADA 1DBF9A42 D5C4484E 0ABCD06B FA53DDEF
    3C1B20EE 3FD59D7C 25E41D2B 669E1EF1 6E6F52C3 164DF4FB
    7930E9E4 E58857B6 AC7D5F42 D69F6D18 7763CF1D 55034004
    87F55BA5 7E31CC7A 7135C886 EFB4318A ED6A1E01 2D9E6832
    A907600A 918130C4 6DC778F9 71AD0038 092999A3 33CB8B7A
    1A1DB93D 7140003C 2A4ECEA9 F98D0ACC 0A8291CD CEC97DCF
    8EC9B55A 7F88A46B 4DB5A851 F44182E1 C68A007E 5E0DD902
    0BFD64B6 45036C7A 4E677D2C 38532A3A 23BA4442 CAF53EA6
    3BB45432 9B7624C8 917BDD64 B1C0FD4C B38E8C33 4C701C3A
    CDAD0657 FCCFEC71 9B1F5C3E 4E46041F 388147FB 4CFDB477
    A52471F7 A9A96910 B855322E DB6340D8 A00EF092 350511E3
    0ABEC1FF F9E3A26E 7FB29F8C 183023C3 587E38DA 0077D9B4
    763E4E4B 94B2BBC1 94C6651E 77CAF992 EEAAC023 2A281BF6
    B3A739C1 22611682 0AE8DB58 47A67CBE F9C9091B 462D538C
    D72B0374 6AE77F5E 62292C31 1562A846 505DC82D B854338A
    E49F5235 C95B9117 8CCF2DD5 CACEF403 EC9D1810 C6272B04
    5B3B71F9 DC6B80D6 3FDD4A8E 9ADB1E69 62A69526 D43161C1
    A41D570D 7938DAD4 A40E329C CFF46AAA 36AD004C F600C838
    1E425A31 D951AE64 FDB23FCE C9509D43 687FEB69 EDD1CC5E
    0B8CC3BD F64B10EF 86B63142 A3AB8829 555B2F74 7C932665
    CB2C0F1C C01BD702 29388839 D2AF05E4 54504AC7 8B758282
    2846C0BA 35C35F5C 59160CC0 46FD8251 541FC68C 9C86B022
    BB709987 6A460E74 51A8A931 09703FEE 1C217E6C 3826E52C
    51AA691E 0E423CFC 99E9E316 50C1217B 624816CD AD9A95F9
    D5B80194 88D9C0A0 A1FE3075 A577E231 83F81D4A 3F2FA457
    1EFC8CE0 BA8A4FE8 B6855DFE 72B0A66E DED2FBAB FBE58A30
    FAFABE1C 5D71A87E 2F741EF8 C1FE86FE A6BBFDE5 30677F0D
    97D11D49 F7A8443D 0822E506 A9F4614E 011E2A94 838FF88C
    D68C8BB7 C5C6424C FFFFFFFF FFFFFFFF

   The generator is: g = 2

Gillmor                      Standards Track                   [Page 27]
```

---

```

[RFC 7919](./rfc7919)                Negotiated FFDHE for TLS             August 2016

   The group size is: q = (p-1)/2

   The hexadecimal representation of q is:

    7FFFFFFF FFFFFFFF D6FC2A2C 515DA54D 57EE2B10 139E9E78
    EC5CE2C1 E7169B4A D4F09B20 8A3219FD E649CEE7 124D9F7C
    BE97F1B1 B1863AEC 7B40D901 576230BD 69EF8F6A EAFEB2B0
    9219FA8F AF833768 42B1B2AA 9EF68D79 DAAB89AF 3FABE49A
    CC278638 707345BB F15344ED 79F7F439 0EF8AC50 9B56F39A
    98566527 A41D3CBD 5E0558C1 59927DB0 E88454A5 D96471FD
    DCB56D5B B06BFA34 0EA7A151 EF1CA6FA 572B76F3 B1B95D8C
    8583D3E4 770536B8 4F017E70 E6FBF176 601A0266 941A17B0
    C8B97F4E 74C2C1FF C7278919 777940C1 E1FF1D8D A637D6B9
    9DDAFE5E 17611002 E2C778C1 BE8B41D9 6379A513 60D977FD
    4435A11C 308FE7EE 6F1AAD9D B28C81AD DE1A7A6F 7CCE011C
    30DA37E4 EB736483 BD6C8E93 48FBFBF7 2CC6587D 60C36C8E
    577F0984 C289C938 5A098649 DE21BCA2 7A7EA229 716BA6E9
    B279710F 38FAA5FF AE574155 CE4EFB4F 743695E2 911B1D06
    D5E290CB CD86F56D 0EDFCD21 6AE22427 055E6835 FD29EEF7
    9E0D9077 1FEACEBE 12F20E95 B34F0F78 B737A961 8B26FA7D
    BC9874F2 72C42BDB 563EAFA1 6B4FB68C 3BB1E78E AA81A002
    43FAADD2 BF18E63D 389AE443 77DA18C5 76B50F00 96CF3419
    5483B005 48C09862 36E3BC7C B8D6801C 0494CCD1 99E5C5BD
    0D0EDC9E B8A0001E 15276754 FCC68566 054148E6 E764BEE7
    C764DAAD 3FC45235 A6DAD428 FA20C170 E345003F 2F06EC81
    05FEB25B 2281B63D 2733BE96 1C29951D 11DD2221 657A9F53
    1DDA2A19 4DBB1264 48BDEEB2 58E07EA6 59C74619 A6380E1D
    66D6832B FE67F638 CD8FAE1F 2723020F 9C40A3FD A67EDA3B
    D29238FB D4D4B488 5C2A9917 6DB1A06C 50077849 1A8288F1
    855F60FF FCF1D137 3FD94FC6 0C1811E1 AC3F1C6D 003BECDA
    3B1F2725 CA595DE0 CA63328F 3BE57CC9 77556011 95140DFB
    59D39CE0 91308B41 05746DAC 23D33E5F 7CE4848D A316A9C6
    6B9581BA 3573BFAF 31149618 8AB15423 282EE416 DC2A19C5
    724FA91A E4ADC88B C66796EA E5677A01 F64E8C08 63139582
    2D9DB8FC EE35C06B 1FEEA547 4D6D8F34 B1534A93 6A18B0E0
    D20EAB86 BC9C6D6A 5207194E 67FA3555 1B568026 7B00641C
    0F212D18 ECA8D732 7ED91FE7 64A84EA1 B43FF5B4 F6E8E62F
    05C661DE FB258877 C35B18A1 51D5C414 AAAD97BA 3E499332
    E596078E 600DEB81 149C441C E95782F2 2A282563 C5BAC141
    1423605D 1AE1AFAE 2C8B0660 237EC128 AA0FE346 4E435811
    5DB84CC3 B523073A 28D45498 84B81FF7 0E10BF36 1C137296
    28D5348F 07211E7E 4CF4F18B 286090BD B1240B66 D6CD4AFC
    EADC00CA 446CE050 50FF183A D2BBF118 C1FC0EA5 1F97D22B
    8F7E4670 5D4527F4 5B42AEFF 39585337 6F697DD5 FDF2C518
    7D7D5F0E 2EB8D43F 17BA0F7C 60FF437F 535DFEF2 9833BF86
    CBE88EA4 FBD4221E 84117283 54FA30A7 008F154A 41C7FC46
    6B4645DB E2E32126 7FFFFFFF FFFFFFFF

Gillmor                      Standards Track                   [Page 28]
```

---

```

[RFC 7919](./rfc7919)                Negotiated FFDHE for TLS             August 2016

   The estimated symmetric-equivalent strength of this group is 192
   bits.

   Peers using ffdhe8192 that want to optimize their key exchange with a
   short exponent ([Section 5.2](#section-5.2)) should choose a secret key of at least
   400 bits.

Acknowledgements

   Thanks to Fedor Brunner, Dave Fergemann, Niels Ferguson, Sandy
   Harris, Tero Kivinen, Watson Ladd, Nikos Mavrogiannopolous, Niels
   Moeller, Bodo Moeller, Kenny Paterson, Eric Rescorla, Tom Ritter,
   Rene Struik, Martin Thomson, Sean Turner, and other members of the
   TLS Working Group for their comments and suggestions on this
   document.  Any mistakes here are not theirs.

Author's Address

   Daniel Kahn Gillmor
   ACLU
   125 Broad Street, 18th Floor
   New York, NY  10004
   United States of America

   Email: dkg@fifthhorseman.net

Gillmor                      Standards Track                   [Page 29]

```


=== Content from github.com_ee686467_20250108_162307.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fadvisories%2FGHSA-jx4r-qc68-xjr5)

**CVE-2002-20001**

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fadvisories%2FGHSA-jx4r-qc68-xjr5)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2Fadvisories%2F%3Cid%3E&source=header)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

1. [GitHub Advisory Database](/advisories)
2. [Unreviewed](/advisories?query=type%3Aunreviewed)
3. [CVE-2002-20001](/advisories/GHSA-jx4r-qc68-xjr5)

## The Diffie-Hellman Key Agreement Protocol allows remote...

High severity

Unreviewed

Published
Apr 21, 2022
to the GitHub Advisory Database
•
Updated May 3, 2024

## Package

No package listed—
[Suggest a package](/advisories/GHSA-jx4r-qc68-xjr5/improve)

## Affected versions

Unknown

## Patched versions

Unknown

## Description

The Diffie-Hellman Key Agreement Protocol allows remote attackers (from the client side) to send arbitrary numbers that are actually not public keys, and trigger expensive server-side DHE modular-exponentiation calculations, aka a D(HE)ater attack. The client needs very little CPU resources and network bandwidth. The attack may be more disruptive in cases where a client can require a server to select its largest supported key size. The basic attack scenario is that the client must claim that it can only communicate with DHE, and the server must be configured to allow DHE.

### References

* <https://nvd.nist.gov/vuln/detail/CVE-2002-20001>
* [mozilla/ssl-config-generator#162](https://github.com/mozilla/ssl-config-generator/issues/162)
* <https://github.com/Balasys/dheater>
* <https://www.researchgate.net/profile/Anton-Stiglic-2/publication/2401745_Security_Issues_in_the_Diffie-Hellman_Key_Agreement_Protocol>
* <https://cert-portal.siemens.com/productcert/pdf/ssa-506569.pdf>
* <https://dheatattack.com>
* <https://support.f5.com/csp/article/K83120834>
* <https://www.arubanetworks.com/assets/alert/ARUBA-PSA-2022-004.txt>
* <https://www.suse.com/support/kb/doc/?id=000020510>
* <https://gitlab.com/dheatattack/dheater>
* <https://dheatattack.gitlab.io>
* <https://ieeexplore.ieee.org/document/10374117>
* <https://www.openssl.org/blog/blog/2022/10/21/tls-groups-configuration>
* <https://www.reddit.com/r/netsec/comments/qdoosy/server_overload_by_enforcing_dhe_key_exchange>

Published by the [National Vulnerability Database](https://nvd.nist.gov/vuln/detail/CVE-2002-20001)
Nov 11, 2021

Published to the GitHub Advisory Database
Apr 21, 2022

Last updated
May 3, 2024

### Severity

High

7.5

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Network

Attack complexity
Low

Privileges required
None

User interaction
None

Scope
Unchanged

Confidentiality
None

Integrity
None

Availability
High

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H

### [EPSS score](https://www.first.org/epss/user-guide)

1.824%
 (88th percentile)

### Weaknesses

[CWE-400](/advisories?query=cwe%3A400)

### CVE ID

CVE-2002-20001

### GHSA ID

GHSA-jx4r-qc68-xjr5

### Source code

No known source code

Dependabot alerts are not supported on this advisory because it does not have a package from a supported ecosystem with an affected and fixed version.

[Learn more about GitHub language support](https://docs.github.com/get-started/learning-about-github/github-language-support#about-supported-languages)

 Loading

Checking history

See something to contribute?
[Suggest improvements for this vulnerability](/advisories/GHSA-jx4r-qc68-xjr5/improve).

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from ieeexplore.ieee.org_d57de08d_20250108_141354.html ===


### IEEE Account

* [Change Username/Password](https://www.ieee.org/profile/changeusrpwd/showChangeUsrPwdPage.html?refSite=https://ieeexplore.ieee.org&refSiteName=IEEE Xplore)
* [Update Address](https://www.ieee.org/profile/address/getAddrInfoPage.html?refSite=https://ieeexplore.ieee.org&refSiteName=IEEE Xplore)

### Purchase Details

* [Payment Options](https://www.ieee.org/profile/payment/showPaymentHome.html?refSite=https://ieeexplore.ieee.org&refSiteName=IEEE Xplore)
* [Order History](https://www.ieee.org/profile/vieworder/showOrderHistory.html?refSite=https://ieeexplore.ieee.org&refSiteName=IEEE Xplore)
* [View Purchased Documents](/articleSale/purchaseHistory.jsp)

### Profile Information

* [Communications Preferences](https://www.ieee.org/ieee-privacyportal/app/ibp?refSite=https://ieeexplore.ieee.org&refSiteName=IEEE Xplore)
* [Profession and Education](https://www.ieee.org/profile/profedu/getProfEduInformation.html?refSite=https://ieeexplore.ieee.org&refSiteName=IEEE Xplore)
* [Technical Interests](https://www.ieee.org/profile/tips/getTipsInfo.html?refSite=https://ieeexplore.ieee.org&refSiteName=IEEE Xplore)

### Need Help?

* **US & Canada:** +1 800 678 4333
* **Worldwide:**  +1 732 981 0060
* [Contact & Support](/xpl/contact)

* [About IEEE *Xplore*](/Xplorehelp/overview-of-ieee-xplore/about-ieee-xplore)
* [Contact Us](/xpl/contact)
* [Help](/Xplorehelp)
* [Accessibility](/Xplorehelp/overview-of-ieee-xplore/accessibility-statement)
* [Terms of Use](/Xplorehelp/overview-of-ieee-xplore/terms-of-use)
* [Nondiscrimination Policy](http://www.ieee.org/web/aboutus/whatis/policies/p9-26.html)
* [Sitemap](/xpl/sitemap.jsp)
* [Privacy & Opting Out of Cookies](http://www.ieee.org/about/help/security_privacy.html)

A not-for-profit organization, IEEE is the world's largest technical professional organization dedicated to advancing technology for the benefit of humanity.
© Copyright 2025 IEEE - All rights reserved. Use of this web site signifies your agreement to the terms and conditions.


