[Open in app](https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F425ba3212fb6&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderUser&source=---top_nav_layout_nav----------------------------------)

Sign up

[Sign in](/m/signin?operation=login&redirect=https%3A%2F%2Fmedium.com%2F%40proflamyt%2Fcve-2024-25506-425ba3212fb6&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

[Write](/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---top_nav_layout_nav-----------------------new_post_topnav-----------)

Sign up

[Sign in](/m/signin?operation=login&redirect=https%3A%2F%2Fmedium.com%2F%40proflamyt%2Fcve-2024-25506-425ba3212fb6&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

![](https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png)
# CVE-2024–25506

[![Proflamyt](https://miro.medium.com/v2/resize:fill:88:88/0*IVbeV-_W3mWfTJAh.jpg)](/%40proflamyt?source=post_page---byline--425ba3212fb6--------------------------------)

[Proflamyt](/%40proflamyt?source=post_page---byline--425ba3212fb6--------------------------------)

·

[Follow](/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F247fe16080db&operation=register&redirect=https%3A%2F%2Fmedium.com%2F%40proflamyt%2Fcve-2024-25506-425ba3212fb6&user=Proflamyt&userId=247fe16080db&source=post_page-247fe16080db--byline--425ba3212fb6---------------------post_header-----------)

2 min read·Mar 25, 2024

--

Listen

Share

**ProcessMaker** — Cookie Based XSS

**Version:** Below 4.0

**Description :**

ProcessMaker was discovered to have an XSS vulnerability due to vulnerable implementation of how the workspace parameter is stored as a cookie value

The vulnerability occurs when the JavaScript tries to access a cookie named ‘pm\_sys\_sys’ and convert its contents to an object using the eval function.

As seen in the provided code snippet, they attempt to assign a JSON object to the ‘obj’ variable using the eval function. The insecure use of eval in this snippet enables a potential attacker, who has control over the “pm\_sys\_sys” cookie, to execute arbitrary JavaScript code.

![]()
## **Crafting an exploit**

A JavaScript eval function executes the string argument as a JavaScript body. By creating a JSON with a value containing a JavaScript function, an attacker can execute arbitrary JavaScript code on the vulnerable web application. To enhance the stealthiness of the attack, the perpetrator can structure the payload to mimic the intended behavior of the code snippet, thereby enabling the “sys\_sys” argument to be accessible as an argument to ‘obj’.

**Final payload** :
By setting the cookie “pm\_sys\_sys” to

```
json
{"sys_sys": "workflow", "ola": alert(1)}
```

An attacker can execute arbitrary js code, while setting the workspace field to the intended workspace for unsuspecting users.

## **Possible Exploitation Scenario**

An attacker finds an XSS , subdomain takeover or CRLF vulnerability on a domain “\*.example.com”, he uses the vulnerability to set the cookie “pm\_sys\_sys” as {“sys\_sys”: “workflow”, “ola”: alert(1)}
with domain set to the subdomain or main domain the processmaker is hosted on

```
// example payload
document.cookie='pm_sys_sys={"sys_sys": "workflow", "ola": alert(1)};domain=example.com;path=/;expires=2070-01-01'
```
![]()

Ones the infected user visits the vulnerable processmaker subdomain page “sys/en/\*/login/login”, the xss triggers

> Note: The exploit could be a key logger as this is the login page

[Cve](/tag/cve?source=post_page-----425ba3212fb6--------------------------------)[Xss Vulnerability](/tag/xss-vulnerability?source=post_page-----425ba3212fb6--------------------------------)

--

--

[![Proflamyt](https://miro.medium.com/v2/resize:fill:96:96/0*IVbeV-_W3mWfTJAh.jpg)](/%40proflamyt?source=post_page---post_author_info--425ba3212fb6--------------------------------)[![Proflamyt](https://miro.medium.com/v2/resize:fill:128:128/0*IVbeV-_W3mWfTJAh.jpg)](/%40proflamyt?source=post_page---post_author_info--425ba3212fb6--------------------------------)Follow[## Written by Proflamyt](/%40proflamyt?source=post_page---post_author_info--425ba3212fb6--------------------------------)0 Followers·[5 Following](/%40proflamyt/following?source=post_page---post_author_info--425ba3212fb6--------------------------------)Follow
## No responses yet

[Help](https://help.medium.com/hc/en-us?source=post_page-----425ba3212fb6--------------------------------)[Status](https://medium.statuspage.io/?source=post_page-----425ba3212fb6--------------------------------)[About](/about?autoplay=1&source=post_page-----425ba3212fb6--------------------------------)[Careers](/jobs-at-medium/work-at-medium-959d1a85284e?source=post_page-----425ba3212fb6--------------------------------)[Press](pressinquiries%40medium.com?source=post_page-----425ba3212fb6--------------------------------)[Blog](https://blog.medium.com/?source=post_page-----425ba3212fb6--------------------------------)[Privacy](https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----425ba3212fb6--------------------------------)[Terms](https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----425ba3212fb6--------------------------------)[Text to speech](https://speechify.com/medium?source=post_page-----425ba3212fb6--------------------------------)[Teams](/business?source=post_page-----425ba3212fb6--------------------------------)

