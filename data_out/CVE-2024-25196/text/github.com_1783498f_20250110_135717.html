
[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fros-navigation%2Fnavigation2%2Fissues%2F4005)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fros-navigation%2Fnavigation2%2Fissues%2F4005)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=ros-navigation%2Fnavigation2)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[ros-navigation](/ros-navigation)
/
**[navigation2](/ros-navigation/navigation2)**
Public

* [Notifications](/login?return_to=%2Fros-navigation%2Fnavigation2) You must be signed in to change notification settings
* [Fork
  1.3k](/login?return_to=%2Fros-navigation%2Fnavigation2)
* [Star
   2.7k](/login?return_to=%2Fros-navigation%2Fnavigation2)

* [Code](/ros-navigation/navigation2)
* [Issues
  75](/ros-navigation/navigation2/issues)
* [Pull requests
  31](/ros-navigation/navigation2/pulls)
* [Discussions](/ros-navigation/navigation2/discussions)
* [Actions](/ros-navigation/navigation2/actions)
* [Projects
  0](/ros-navigation/navigation2/projects)
* [Wiki](/ros-navigation/navigation2/wiki)
* [Security](/ros-navigation/navigation2/security)
* [Insights](/ros-navigation/navigation2/pulse)

Additional navigation options

* [Code](/ros-navigation/navigation2)
* [Issues](/ros-navigation/navigation2/issues)
* [Pull requests](/ros-navigation/navigation2/pulls)
* [Discussions](/ros-navigation/navigation2/discussions)
* [Actions](/ros-navigation/navigation2/actions)
* [Projects](/ros-navigation/navigation2/projects)
* [Wiki](/ros-navigation/navigation2/wiki)
* [Security](/ros-navigation/navigation2/security)
* [Insights](/ros-navigation/navigation2/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fros-navigation%2Fnavigation2%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fros-navigation%2Fnavigation2%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# User misconfiguration of parameters may cause instantaneous crashs #4005

Open

[GoesM](/GoesM) opened this issue
Dec 11, 2023
· 8 comments

Open

# [User misconfiguration of parameters may cause instantaneous crashs](#top) #4005

[GoesM](/GoesM) opened this issue
Dec 11, 2023
· 8 comments

Labels
[3 - Low](/ros-navigation/navigation2/labels/3%20-%20Low)
Low Priority

## Comments

[![@GoesM](https://avatars.githubusercontent.com/u/130988564?s=80&u=7ca190cae5cd403a5e12a7648f358242d312e465&v=4)](/GoesM)

Copy link

Contributor

### **[GoesM](/GoesM)** commented [Dec 11, 2023](#issue-2035464590) • edited Loading

| Bug report **Required Info:**   * Operating System:   + Ubuntu 22.04 * ROS2 Version:   + humble * Version or commit hash:   + [1134569](https://github.com/ros-planning/navigation2/commit/113564965f54009686d521902ff3fcc9d101c5b5) * DDS implementation:   + default  Steps to reproduce issue launch the navigation2 within defaulted `tb3_simulation_launch.py` as following commands  ``` source install/setup.bash source /opt/ros/humble/setup.bash export TURTLEBOT3_MODEL=waffle export GAZEBO_MODEL_PATH=$GAZEBO_MODEL_PATH:/opt/ros/humble/share/turtlebot3_gazebo/models ros2 launch nav2_bringup tb3_simulation_launch.py params_file:=my_nav2_params.yaml  ```  there's only one difference between `my_nav2_params.yaml` and defaulted `nav2_params.yaml`, (we wrongly set the height of local\_costmap as -20), as following:  ``` ... ... local_costmap:   local_costmap:     ros__parameters:       ...       ...       height: -20 ... ...  ```  and then , try to set an /initial\_pose in rviz by `2D_estimate_pose` or send a msg into /initial\_pose in another terminal Expected behavior  * process should not crash / at least, it should not make the user's computer unable to continue working * the memory usage should not be too high  Actual behavior  * process crashed when launching   specifically, during the startup process of nav2, there may be computer lag, terminal crashes, or even a blue screen   [dbd3b31c83f94342cc9af850a9a897df_](https://private-user-images.githubusercontent.com/130988564/289531861-8f80a7cd-959e-482c-8d53-95e9d36bcec3.jpg?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1MTc3MzYsIm5iZiI6MTczNjUxNzQzNiwicGF0aCI6Ii8xMzA5ODg1NjQvMjg5NTMxODYxLThmODBhN2NkLTk1OWUtNDgyYy04ZDUzLTk1ZTlkMzZiY2VjMy5qcGc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjUwMTEwJTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI1MDExMFQxMzU3MTZaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT02ZDMxZjgyNTZkNmU5NTgwYmVjMGJkZDQyYzBkZDQ5MjcxOWIxYmQ4Y2UzNGI5MTFjZGE1NzhkNjc3ZTM3ZTIwJlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.ELwFkKKJHjVmN7aN5zpdCnXkvLBCSMHvAhVMGnuNY8w) * abnormal memory usage   we found that nav2\_controller process occupies a very large amount of memory (up to 10G, sometimes even exceeding 20G, which is very abnormal), as following:   [db3537365059f4ae705cd6d092537db](https://private-user-images.githubusercontent.com/130988564/289531935-7a088ebb-4e78-464d-a539-8362ed3537ac.jpg?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1MTc3MzYsIm5iZiI6MTczNjUxNzQzNiwicGF0aCI6Ii8xMzA5ODg1NjQvMjg5NTMxOTM1LTdhMDg4ZWJiLTRlNzgtNDY0ZC1hNTM5LTgzNjJlZDM1MzdhYy5qcGc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjUwMTEwJTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI1MDExMFQxMzU3MTZaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT0zN2FhZmZkMzUzOWExYjY4Mzc5Y2IzZWRiNTg5MDU1MmQxMThhYmU5MTcwYjY1OTI1YTAwODgxMDkxZGI0ZmZiJlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.DqlBBdC7U-YXizWDGyf4oe6Q4dymgHpXkr46DCPYBjM)   here's a normal memory usage when we use the defaulted `nav2_params.yaml`, which is for comparision.   [normal](https://private-user-images.githubusercontent.com/130988564/289532067-c7825214-5d0c-408a-a6c1-b16bb88d0e5b.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1MTc3MzYsIm5iZiI6MTczNjUxNzQzNiwicGF0aCI6Ii8xMzA5ODg1NjQvMjg5NTMyMDY3LWM3ODI1MjE0LTVkMGMtNDA4YS1hNmMxLWIxNmJiODhkMGU1Yi5wbmc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjUwMTEwJTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI1MDExMFQxMzU3MTZaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT00YzEwMzI5YTlkNjM1MmMyOWVkNWQ3MzE1ZGUzNWFlM2ZhYTBjODI2ODgwNWRlMmNjYjlmNzY0Y2U3OTI0M2JmJlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.0-D6ZxBUyOItl_jytywZ2fDZTwhPfIh6pYa-lOH9UWo)   the max memory usage of whole nav2 is below 1G. |
| --- |
| The text was updated successfully, but these errors were encountered: |

All reactions

[![@SteveMacenski](https://avatars.githubusercontent.com/u/14944147?s=80&u=0925d37e9d3569c71d930114b66e6394c2efb3c6&v=4)](/SteveMacenski)

Copy link

Member

### **[SteveMacenski](/SteveMacenski)** commented [Dec 11, 2023](#issuecomment-1850787542)

| Thanks for the report - in general its not planned for us to protect users from themselves with every parameter if they choose something impossible. We try where we can, but the codebase would balloon to 2x the size for checking every single parameter for every way that it could be misinterpreted.  I don't disagree with you that you could make the system crash on initialization if you set the width/height to a negative value. I put that in the category of "fair" since its not a crash mid-execution, non-deterministically, or during operations. That is a crash you would see immediately when you tried to bring the system up, every time, that could be debugged before proceeding. I take crashes very seriously, but for parameter misconfiguration of this nature, its not realistic today that we're going to protect users from making errors on every one of a thousand parameters.  However, that's not an unreasonable ask, so I'm going to rename the ticket in line with that and it'll stay in the tracker so that perhaps in the future when we're better resourced we can potentially have some interns do this, but no promises / commitments. |
| --- |

All reactions

Sorry, something went wrong.

[![@SteveMacenski](https://avatars.githubusercontent.com/u/14944147?s=40&u=0925d37e9d3569c71d930114b66e6394c2efb3c6&v=4)](/SteveMacenski)
[SteveMacenski](/SteveMacenski)
changed the title
~~user-misconfiuration may cause system memory crash~~
User misconfiguration of parameters may cause instantaneous crashs
[Dec 11, 2023](#event-11215212716)

[![@SteveMacenski](https://avatars.githubusercontent.com/u/14944147?s=80&u=0925d37e9d3569c71d930114b66e6394c2efb3c6&v=4)](/SteveMacenski)

Copy link

Member

### **[SteveMacenski](/SteveMacenski)** commented [Dec 11, 2023](#issuecomment-1850790044)

| [@GoesM](https://github.com/GoesM) perhaps your extra memory problems are related to your misconfigurations 😉  Ask on Robotics stack exchange with your config file changes and I'll follow up there on that topic. I don't want tickets to become > 1 topic, so I don't want to pollute this thread with that discussion. I hope that makes sense |
| --- |

All reactions

Sorry, something went wrong.

[![@SteveMacenski](https://avatars.githubusercontent.com/u/14944147?s=40&u=0925d37e9d3569c71d930114b66e6394c2efb3c6&v=4)](/SteveMacenski)
[SteveMacenski](/SteveMacenski)
added
the
[3 - Low](/ros-navigation/navigation2/labels/3%20-%20Low)
Low Priority
label
[Dec 11, 2023](#event-11215226549)

[![@GoesM](https://avatars.githubusercontent.com/u/130988564?s=80&u=7ca190cae5cd403a5e12a7648f358242d312e465&v=4)](/GoesM)

Copy link

Contributor

Author

### **[GoesM](/GoesM)** commented [Dec 12, 2023](#issuecomment-1851464813)

| I've forwarded this issue to the Robotics stack exchange stack: [question 106008](https://robotics.stackexchange.com/questions/106008/ros2nav2user-misconfiguration-of-parameters-may-cause-instantaneous-crashs). Thanks for your feedback. 🙂 |
| --- |

All reactions

Sorry, something went wrong.

[![@GoesM](https://avatars.githubusercontent.com/u/130988564?s=40&u=7ca190cae5cd403a5e12a7648f358242d312e465&v=4)](/GoesM)
[GoesM](/GoesM)
mentioned this issue
[Dec 19, 2023](#ref-pullrequest-2048212696)

[check params of costmap to avoid abnormal memory usage caused by user-misconfiguration mentioned in issue #4005
#4017](/ros-navigation/navigation2/pull/4017)
 Merged

[![@Ryanf55](https://avatars.githubusercontent.com/u/25047695?s=80&v=4)](/Ryanf55)

Copy link

Contributor

### **[Ryanf55](/Ryanf55)** commented [Feb 2, 2024](#issuecomment-1922592528)

| Keep an eye on this thread for potential solutions to add parameter validation without ballooning the code. <https://discourse.ros.org/t/simplifying-how-to-declare-parameters-in-ros-2/33272> |
| --- |

All reactions

Sorry, something went wrong.

[![@SteveMacenski](https://avatars.githubusercontent.com/u/14944147?s=80&u=0925d37e9d3569c71d930114b66e6394c2efb3c6&v=4)](/SteveMacenski)

Copy link

Member

### **[SteveMacenski](/SteveMacenski)** commented [Feb 2, 2024](#issuecomment-1922695179) • edited Loading

| It is already possible with parameter descriptions. It is more a matter of time / inclination to set bounds on all N params in the stack (and make sure the dynamic parameter callbacks are respecting them too). The blockage isn’t the tech, it’s the value proposition of time.  You should see the amount of code is required per-parameter in this case. Certainly some can be abstracted into Utils, but still. |
| --- |

All reactions

Sorry, something went wrong.

[![@SteveMacenski](https://avatars.githubusercontent.com/u/14944147?s=80&u=0925d37e9d3569c71d930114b66e6394c2efb3c6&v=4)](/SteveMacenski)

Copy link

Member

### **[SteveMacenski](/SteveMacenski)** commented [Feb 29, 2024](#issuecomment-1971507589) • edited Loading

| Another example [#4157](https://github.com/ros-navigation/navigation2/issues/4157)  & impl note: [#4157 (comment)](https://github.com/ros-navigation/navigation2/issues/4157#issuecomment-1973580361) |
| --- |

All reactions

Sorry, something went wrong.

[![@SteveMacenski](https://avatars.githubusercontent.com/u/14944147?s=40&u=0925d37e9d3569c71d930114b66e6394c2efb3c6&v=4)](/SteveMacenski)
[SteveMacenski](/SteveMacenski)
mentioned this issue
[Feb 29, 2024](#ref-issue-2160798872)

[user-misconfiguration may cause a heap-buffer-overflow bug in nav2\_amcl
#4157](/ros-navigation/navigation2/issues/4157)

Closed

This was referenced May 13, 2024

[heap-buffer-overflow bug caused by user misconfiguration (amcl:max\_particles=a large value)
#4335](/ros-navigation/navigation2/issues/4335)

Closed

[heap-buffer-overflow bug caused by user misconfiguration (amcl:min\_particles=a large value)
#4336](/ros-navigation/navigation2/issues/4336)

Closed

[![@GoesM](https://avatars.githubusercontent.com/u/130988564?s=80&u=7ca190cae5cd403a5e12a7648f358242d312e465&v=4)](/GoesM)

Copy link

Contributor

Author

### **[GoesM](/GoesM)** commented [May 13, 2024](#issuecomment-2107076125) • edited Loading

| add tickets:   * [#4062](https://github.com/ros-navigation/navigation2/issues/4062) * [#4335](https://github.com/ros-navigation/navigation2/issues/4335) * [#4336](https://github.com/ros-navigation/navigation2/issues/4336) * [#4337](https://github.com/ros-navigation/navigation2/issues/4337) * [#4338](https://github.com/ros-navigation/navigation2/issues/4338) * [#4339](https://github.com/ros-navigation/navigation2/issues/4339) |
| --- |

All reactions

Sorry, something went wrong.

This was referenced May 13, 2024

[A large value for the inflation-radius parameter in globalcostmap could cause WRITE-memory-access-error.
#4062](/ros-navigation/navigation2/issues/4062)

Closed

[heap-buffer-overflow bug caused by user misconfiguration (amcl:laser\_likelihood\_max\_dist= -nan)
#4337](/ros-navigation/navigation2/issues/4337)

Closed

[heap-buffer-overflow bug caused by user misconfiguration (amcl:max\_particles=a negative value)
#4338](/ros-navigation/navigation2/issues/4338)

Closed

[heap-buffer-overflow bug caused by user misconfiguration (amcl:min\_particles=a negative value)
#4339](/ros-navigation/navigation2/issues/4339)

Closed

[![@GoesM](https://avatars.githubusercontent.com/u/130988564?s=80&u=7ca190cae5cd403a5e12a7648f358242d312e465&v=4)](/GoesM)

Copy link

Contributor

Author

### **[GoesM](/GoesM)** commented [May 13, 2024](#issuecomment-2107188021) • edited Loading

| [NOTICE] I think here're two issue which needs to be focused on:   * [#4338](https://github.com/ros-navigation/navigation2/issues/4338) * [#4339](https://github.com/ros-navigation/navigation2/issues/4339)   they show a result that the API `get_parameter()` may read a wrong value sometimes (different from the value in `nav2_params.yaml` ) |
| --- |

All reactions

Sorry, something went wrong.

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fros-navigation%2Fnavigation2%2Fissues%2F4005)

Assignees

No one assigned

Labels

[3 - Low](/ros-navigation/navigation2/labels/3%20-%20Low)
Low Priority

Projects

None yet

Milestone

No milestone

Development

No branches or pull requests

3 participants

[![@SteveMacenski](https://avatars.githubusercontent.com/u/14944147?s=52&v=4)](/SteveMacenski) [![@Ryanf55](https://avatars.githubusercontent.com/u/25047695?s=52&v=4)](/Ryanf55) [![@GoesM](https://avatars.githubusercontent.com/u/130988564?s=52&v=4)](/GoesM)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.

