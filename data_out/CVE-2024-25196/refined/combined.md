=== Content from github.com_1783498f_20250110_135717.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fros-navigation%2Fnavigation2%2Fissues%2F4005)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fros-navigation%2Fnavigation2%2Fissues%2F4005)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=ros-navigation%2Fnavigation2)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[ros-navigation](/ros-navigation)
/
**[navigation2](/ros-navigation/navigation2)**
Public

* [Notifications](/login?return_to=%2Fros-navigation%2Fnavigation2) You must be signed in to change notification settings
* [Fork
  1.3k](/login?return_to=%2Fros-navigation%2Fnavigation2)
* [Star
   2.7k](/login?return_to=%2Fros-navigation%2Fnavigation2)

* [Code](/ros-navigation/navigation2)
* [Issues
  75](/ros-navigation/navigation2/issues)
* [Pull requests
  31](/ros-navigation/navigation2/pulls)
* [Discussions](/ros-navigation/navigation2/discussions)
* [Actions](/ros-navigation/navigation2/actions)
* [Projects
  0](/ros-navigation/navigation2/projects)
* [Wiki](/ros-navigation/navigation2/wiki)
* [Security](/ros-navigation/navigation2/security)
* [Insights](/ros-navigation/navigation2/pulse)

Additional navigation options

* [Code](/ros-navigation/navigation2)
* [Issues](/ros-navigation/navigation2/issues)
* [Pull requests](/ros-navigation/navigation2/pulls)
* [Discussions](/ros-navigation/navigation2/discussions)
* [Actions](/ros-navigation/navigation2/actions)
* [Projects](/ros-navigation/navigation2/projects)
* [Wiki](/ros-navigation/navigation2/wiki)
* [Security](/ros-navigation/navigation2/security)
* [Insights](/ros-navigation/navigation2/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fros-navigation%2Fnavigation2%2Fissues%2Fnew%2Fchoose)

By clicking â€œSign up for GitHubâ€, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). Weâ€™ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fros-navigation%2Fnavigation2%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# User misconfiguration of parameters may cause instantaneous crashs #4005

Open

[GoesM](/GoesM) opened this issue
Dec 11, 2023
Â· 8 comments

Open

# [User misconfiguration of parameters may cause instantaneous crashs](#top) #4005

[GoesM](/GoesM) opened this issue
Dec 11, 2023
Â· 8 comments

Labels
[3 - Low](/ros-navigation/navigation2/labels/3%20-%20Low)
Low Priority

## Comments

[![@GoesM](https://avatars.githubusercontent.com/u/130988564?s=80&u=7ca190cae5cd403a5e12a7648f358242d312e465&v=4)](/GoesM)

Copy link

Contributor

### **[GoesM](/GoesM)** commented [Dec 11, 2023](#issue-2035464590) â€¢ edited Loading

| Bug report **Required Info:**   * Operating System:   + Ubuntu 22.04 * ROS2 Version:   + humble * Version or commit hash:   + [1134569](https://github.com/ros-planning/navigation2/commit/113564965f54009686d521902ff3fcc9d101c5b5) * DDS implementation:   + default  Steps to reproduce issue launch the navigation2 within defaulted `tb3_simulation_launch.py` as following commands  ``` source install/setup.bash source /opt/ros/humble/setup.bash export TURTLEBOT3_MODEL=waffle export GAZEBO_MODEL_PATH=$GAZEBO_MODEL_PATH:/opt/ros/humble/share/turtlebot3_gazebo/models ros2 launch nav2_bringup tb3_simulation_launch.py params_file:=my_nav2_params.yaml  ```  there's only one difference between `my_nav2_params.yaml` and defaulted `nav2_params.yaml`, (we wrongly set the height of local\_costmap as -20), as following:  ``` ... ... local_costmap:   local_costmap:     ros__parameters:       ...       ...       height: -20 ... ...  ```  and then , try to set an /initial\_pose in rviz by `2D_estimate_pose` or send a msg into /initial\_pose in another terminal Expected behavior  * process should not crash / at least, it should not make the user's computer unable to continue working * the memory usage should not be too high  Actual behavior  * process crashed when launching   specifically, during the startup process of nav2, there may be computer lag, terminal crashes, or even a blue screen   [dbd3b31c83f94342cc9af850a9a897df_](https://private-user-images.githubusercontent.com/130988564/289531861-8f80a7cd-959e-482c-8d53-95e9d36bcec3.jpg?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1MTc3MzYsIm5iZiI6MTczNjUxNzQzNiwicGF0aCI6Ii8xMzA5ODg1NjQvMjg5NTMxODYxLThmODBhN2NkLTk1OWUtNDgyYy04ZDUzLTk1ZTlkMzZiY2VjMy5qcGc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjUwMTEwJTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI1MDExMFQxMzU3MTZaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT02ZDMxZjgyNTZkNmU5NTgwYmVjMGJkZDQyYzBkZDQ5MjcxOWIxYmQ4Y2UzNGI5MTFjZGE1NzhkNjc3ZTM3ZTIwJlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.ELwFkKKJHjVmN7aN5zpdCnXkvLBCSMHvAhVMGnuNY8w) * abnormal memory usage   we found that nav2\_controller process occupies a very large amount of memory (up to 10G, sometimes even exceeding 20G, which is very abnormal), as following:   [db3537365059f4ae705cd6d092537db](https://private-user-images.githubusercontent.com/130988564/289531935-7a088ebb-4e78-464d-a539-8362ed3537ac.jpg?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1MTc3MzYsIm5iZiI6MTczNjUxNzQzNiwicGF0aCI6Ii8xMzA5ODg1NjQvMjg5NTMxOTM1LTdhMDg4ZWJiLTRlNzgtNDY0ZC1hNTM5LTgzNjJlZDM1MzdhYy5qcGc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjUwMTEwJTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI1MDExMFQxMzU3MTZaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT0zN2FhZmZkMzUzOWExYjY4Mzc5Y2IzZWRiNTg5MDU1MmQxMThhYmU5MTcwYjY1OTI1YTAwODgxMDkxZGI0ZmZiJlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.DqlBBdC7U-YXizWDGyf4oe6Q4dymgHpXkr46DCPYBjM)   here's a normal memory usage when we use the defaulted `nav2_params.yaml`, which is for comparision.   [normal](https://private-user-images.githubusercontent.com/130988564/289532067-c7825214-5d0c-408a-a6c1-b16bb88d0e5b.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1MTc3MzYsIm5iZiI6MTczNjUxNzQzNiwicGF0aCI6Ii8xMzA5ODg1NjQvMjg5NTMyMDY3LWM3ODI1MjE0LTVkMGMtNDA4YS1hNmMxLWIxNmJiODhkMGU1Yi5wbmc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjUwMTEwJTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI1MDExMFQxMzU3MTZaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT00YzEwMzI5YTlkNjM1MmMyOWVkNWQ3MzE1ZGUzNWFlM2ZhYTBjODI2ODgwNWRlMmNjYjlmNzY0Y2U3OTI0M2JmJlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.0-D6ZxBUyOItl_jytywZ2fDZTwhPfIh6pYa-lOH9UWo)   the max memory usage of whole nav2 is below 1G. |
| --- |
| The text was updated successfully, but these errors were encountered: |

All reactions

[![@SteveMacenski](https://avatars.githubusercontent.com/u/14944147?s=80&u=0925d37e9d3569c71d930114b66e6394c2efb3c6&v=4)](/SteveMacenski)

Copy link

Member

### **[SteveMacenski](/SteveMacenski)** commented [Dec 11, 2023](#issuecomment-1850787542)

| Thanks for the report - in general its not planned for us to protect users from themselves with every parameter if they choose something impossible. We try where we can, but the codebase would balloon to 2x the size for checking every single parameter for every way that it could be misinterpreted.  I don't disagree with you that you could make the system crash on initialization if you set the width/height to a negative value. I put that in the category of "fair" since its not a crash mid-execution, non-deterministically, or during operations. That is a crash you would see immediately when you tried to bring the system up, every time, that could be debugged before proceeding. I take crashes very seriously, but for parameter misconfiguration of this nature, its not realistic today that we're going to protect users from making errors on every one of a thousand parameters.  However, that's not an unreasonable ask, so I'm going to rename the ticket in line with that and it'll stay in the tracker so that perhaps in the future when we're better resourced we can potentially have some interns do this, but no promises / commitments. |
| --- |

All reactions

Sorry, something went wrong.

[![@SteveMacenski](https://avatars.githubusercontent.com/u/14944147?s=40&u=0925d37e9d3569c71d930114b66e6394c2efb3c6&v=4)](/SteveMacenski)
[SteveMacenski](/SteveMacenski)
changed the title
~~user-misconfiuration may cause system memory crash~~
User misconfiguration of parameters may cause instantaneous crashs
[Dec 11, 2023](#event-11215212716)

[![@SteveMacenski](https://avatars.githubusercontent.com/u/14944147?s=80&u=0925d37e9d3569c71d930114b66e6394c2efb3c6&v=4)](/SteveMacenski)

Copy link

Member

### **[SteveMacenski](/SteveMacenski)** commented [Dec 11, 2023](#issuecomment-1850790044)

| [@GoesM](https://github.com/GoesM) perhaps your extra memory problems are related to your misconfigurations ðŸ˜‰  Ask on Robotics stack exchange with your config file changes and I'll follow up there on that topic. I don't want tickets to become > 1 topic, so I don't want to pollute this thread with that discussion. I hope that makes sense |
| --- |

All reactions

Sorry, something went wrong.

[![@SteveMacenski](https://avatars.githubusercontent.com/u/14944147?s=40&u=0925d37e9d3569c71d930114b66e6394c2efb3c6&v=4)](/SteveMacenski)
[SteveMacenski](/SteveMacenski)
added
the
[3 - Low](/ros-navigation/navigation2/labels/3%20-%20Low)
Low Priority
label
[Dec 11, 2023](#event-11215226549)

[![@GoesM](https://avatars.githubusercontent.com/u/130988564?s=80&u=7ca190cae5cd403a5e12a7648f358242d312e465&v=4)](/GoesM)

Copy link

Contributor

Author

### **[GoesM](/GoesM)** commented [Dec 12, 2023](#issuecomment-1851464813)

| I've forwarded this issue to the Robotics stack exchange stack: [question 106008](https://robotics.stackexchange.com/questions/106008/ros2nav2user-misconfiguration-of-parameters-may-cause-instantaneous-crashs). Thanks for your feedback. ðŸ™‚ |
| --- |

All reactions

Sorry, something went wrong.

[![@GoesM](https://avatars.githubusercontent.com/u/130988564?s=40&u=7ca190cae5cd403a5e12a7648f358242d312e465&v=4)](/GoesM)
[GoesM](/GoesM)
mentioned this issue
[Dec 19, 2023](#ref-pullrequest-2048212696)

[check params of costmap to avoid abnormal memory usage caused by user-misconfiguration mentioned in issue #4005
#4017](/ros-navigation/navigation2/pull/4017)
 Merged

[![@Ryanf55](https://avatars.githubusercontent.com/u/25047695?s=80&v=4)](/Ryanf55)

Copy link

Contributor

### **[Ryanf55](/Ryanf55)** commented [Feb 2, 2024](#issuecomment-1922592528)

| Keep an eye on this thread for potential solutions to add parameter validation without ballooning the code. <https://discourse.ros.org/t/simplifying-how-to-declare-parameters-in-ros-2/33272> |
| --- |

All reactions

Sorry, something went wrong.

[![@SteveMacenski](https://avatars.githubusercontent.com/u/14944147?s=80&u=0925d37e9d3569c71d930114b66e6394c2efb3c6&v=4)](/SteveMacenski)

Copy link

Member

### **[SteveMacenski](/SteveMacenski)** commented [Feb 2, 2024](#issuecomment-1922695179) â€¢ edited Loading

| It is already possible with parameter descriptions. It is more a matter of time / inclination to set bounds on all N params in the stack (and make sure the dynamic parameter callbacks are respecting them too). The blockage isnâ€™t the tech, itâ€™s the value proposition of time.  You should see the amount of code is required per-parameter in this case. Certainly some can be abstracted into Utils, but still. |
| --- |

All reactions

Sorry, something went wrong.

[![@SteveMacenski](https://avatars.githubusercontent.com/u/14944147?s=80&u=0925d37e9d3569c71d930114b66e6394c2efb3c6&v=4)](/SteveMacenski)

Copy link

Member

### **[SteveMacenski](/SteveMacenski)** commented [Feb 29, 2024](#issuecomment-1971507589) â€¢ edited Loading

| Another example [#4157](https://github.com/ros-navigation/navigation2/issues/4157)  & impl note: [#4157 (comment)](https://github.com/ros-navigation/navigation2/issues/4157#issuecomment-1973580361) |
| --- |

All reactions

Sorry, something went wrong.

[![@SteveMacenski](https://avatars.githubusercontent.com/u/14944147?s=40&u=0925d37e9d3569c71d930114b66e6394c2efb3c6&v=4)](/SteveMacenski)
[SteveMacenski](/SteveMacenski)
mentioned this issue
[Feb 29, 2024](#ref-issue-2160798872)

[user-misconfiguration may cause a heap-buffer-overflow bug in nav2\_amcl
#4157](/ros-navigation/navigation2/issues/4157)

Closed

This was referenced May 13, 2024

[heap-buffer-overflow bug caused by user misconfiguration (amcl:max\_particles=a large value)
#4335](/ros-navigation/navigation2/issues/4335)

Closed

[heap-buffer-overflow bug caused by user misconfiguration (amcl:min\_particles=a large value)
#4336](/ros-navigation/navigation2/issues/4336)

Closed

[![@GoesM](https://avatars.githubusercontent.com/u/130988564?s=80&u=7ca190cae5cd403a5e12a7648f358242d312e465&v=4)](/GoesM)

Copy link

Contributor

Author

### **[GoesM](/GoesM)** commented [May 13, 2024](#issuecomment-2107076125) â€¢ edited Loading

| add tickets:   * [#4062](https://github.com/ros-navigation/navigation2/issues/4062) * [#4335](https://github.com/ros-navigation/navigation2/issues/4335) * [#4336](https://github.com/ros-navigation/navigation2/issues/4336) * [#4337](https://github.com/ros-navigation/navigation2/issues/4337) * [#4338](https://github.com/ros-navigation/navigation2/issues/4338) * [#4339](https://github.com/ros-navigation/navigation2/issues/4339) |
| --- |

All reactions

Sorry, something went wrong.

This was referenced May 13, 2024

[A large value for the inflation-radius parameter in globalcostmap could cause WRITE-memory-access-error.
#4062](/ros-navigation/navigation2/issues/4062)

Closed

[heap-buffer-overflow bug caused by user misconfiguration (amcl:laser\_likelihood\_max\_dist= -nan)
#4337](/ros-navigation/navigation2/issues/4337)

Closed

[heap-buffer-overflow bug caused by user misconfiguration (amcl:max\_particles=a negative value)
#4338](/ros-navigation/navigation2/issues/4338)

Closed

[heap-buffer-overflow bug caused by user misconfiguration (amcl:min\_particles=a negative value)
#4339](/ros-navigation/navigation2/issues/4339)

Closed

[![@GoesM](https://avatars.githubusercontent.com/u/130988564?s=80&u=7ca190cae5cd403a5e12a7648f358242d312e465&v=4)](/GoesM)

Copy link

Contributor

Author

### **[GoesM](/GoesM)** commented [May 13, 2024](#issuecomment-2107188021) â€¢ edited Loading

| [NOTICE] I think here're two issue which needs to be focused on:   * [#4338](https://github.com/ros-navigation/navigation2/issues/4338) * [#4339](https://github.com/ros-navigation/navigation2/issues/4339)   they show a result that the API `get_parameter()` may read a wrong value sometimes (different from the value in `nav2_params.yaml` ) |
| --- |

All reactions

Sorry, something went wrong.

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fros-navigation%2Fnavigation2%2Fissues%2F4005)

Assignees

No one assigned

Labels

[3 - Low](/ros-navigation/navigation2/labels/3%20-%20Low)
Low Priority

Projects

None yet

Milestone

No milestone

Development

No branches or pull requests

3 participants

[![@SteveMacenski](https://avatars.githubusercontent.com/u/14944147?s=52&v=4)](/SteveMacenski) [![@Ryanf55](https://avatars.githubusercontent.com/u/25047695?s=52&v=4)](/Ryanf55) [![@GoesM](https://avatars.githubusercontent.com/u/130988564?s=52&v=4)](/GoesM)

## Footer

Â© 2025 GitHub,Â Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You canâ€™t perform that action at this time.



=== Content from robotics.stackexchange.com_e8b30d3b_20250110_135719.html ===


[Skip to main content](#content)

#### Stack Exchange Network

Stack Exchange network consists of 183 Q&A communities including [Stack Overflow](https://stackoverflow.com), the largest, most trusted online community for developers to learn, share their knowledge, and build their careers.

[Visit Stack Exchange](https://stackexchange.com)

Loadingâ€¦

* [Tour
  Start here for a quick overview of the site](/tour)
* [Help Center
  Detailed answers to any questions you might have](/help)
* [Meta
  Discuss the workings and policies of this site](https://robotics.meta.stackexchange.com)
* [About Us
  Learn more about Stack Overflow the company, and our products](https://stackoverflow.co/)

4. ### [current community](https://robotics.stackexchange.com)

   * [Robotics](https://robotics.stackexchange.com)

     [help](https://robotics.stackexchange.com/help)
     [chat](https://chat.stackexchange.com?tab=site&host=robotics.stackexchange.com)
   * [Robotics Meta](https://robotics.meta.stackexchange.com)
   ### your communities

   [Sign up](https://robotics.stackexchange.com/users/signup?ssrc=site_switcher&returnurl=https%3a%2f%2frobotics.stackexchange.com%2fquestions%2f106008%2fros2nav2-user-misconfiguration-of-parameters-may-bring-abnormal-memory-usage) or [log in](https://robotics.stackexchange.com/users/login?ssrc=site_switcher&returnurl=https%3a%2f%2frobotics.stackexchange.com%2fquestions%2f106008%2fros2nav2-user-misconfiguration-of-parameters-may-bring-abnormal-memory-usage) to customize your list.

   ### [more stack exchange communities](https://stackexchange.com/sites)

   [company blog](https://stackoverflow.blog)
6. [Log in](https://robotics.stackexchange.com/users/login?ssrc=head&returnurl=https%3a%2f%2frobotics.stackexchange.com%2fquestions%2f106008%2fros2nav2-user-misconfiguration-of-parameters-may-bring-abnormal-memory-usage)
7. [Sign up](https://robotics.stackexchange.com/users/signup?ssrc=head&returnurl=https%3a%2f%2frobotics.stackexchange.com%2fquestions%2f106008%2fros2nav2-user-misconfiguration-of-parameters-may-bring-abnormal-memory-usage)

[Robotics](https://robotics.stackexchange.com)

1. 1. [Home](/)
   2. [Questions](/questions)
   3. [Tags](/tags)
   5. [Users](/users)
   6. [Jobs](/jobs?source=so-left-nav)
   7. [Companies](https://stackoverflow.com/jobs/companies?so_medium=robotics&so_source=SiteNav)
   8. [Unanswered](/unanswered)
2. Teams
   ![](https://cdn.sstatic.net/Img/teams/teams-promo.svg?v=e507948b81bf)

   Ask questions, find answers and collaborate at work with Stack Overflow for Teams.

   [Try Teams for free](https://stackoverflowteams.com/teams/create/free/?utm_medium=referral&utm_source=robotics-community&utm_campaign=side-bar&utm_content=explore-teams)
   [Explore Teams](https://stackoverflow.co/teams/?utm_medium=referral&utm_source=robotics-community&utm_campaign=side-bar&utm_content=explore-teams)
3. Teams
4. Ask questions, find answers and collaborate at work with Stack Overflow for Teams.
   [Explore Teams](https://stackoverflow.co/teams/?utm_medium=referral&utm_source=robotics-community&utm_campaign=side-bar&utm_content=explore-teams-compact)

**Teams**

Q&A for work

Connect and share knowledge within a single location that is structured and easy to search.

[Learn more about Teams](https://stackoverflow.co/teams/)

# [[ROS2][NAV2] User misconfiguration of parameters may bring abnormal memory usage](/questions/106008/ros2nav2-user-misconfiguration-of-parameters-may-bring-abnormal-memory-usage)

[Ask Question](/questions/ask)

Asked
1 year, 1 month ago

Modified
[1 year ago](?lastactivity "2023-12-13 09:14:28Z")

Viewed
370 times

0

$\begingroup$
## Description

#### Based on:

* Operating System:
  + Ubuntu 22.04
* ROS2 Version:
  + humble
* Nav2 Version:
  + humble

#### Steps to reproduce issue

launch the navigation2 within defaulted `tb3_simulation_launch.py` as following commands

```
source install/setup.bash
source /opt/ros/humble/setup.bash
export TURTLEBOT3_MODEL=waffle
export GAZEBO_MODEL_PATH=$GAZEBO_MODEL_PATH:/opt/ros/humble/share/turtlebot3_gazebo/models
ros2 launch nav2_bringup tb3_simulation_launch.py params_file:=my_nav2_params.yaml

```

there's the content of `my_nav2_params.yaml`

```
amcl:
  ros__parameters:
    alpha1: 0.2
    alpha2: 0.2
    alpha3: 0.2
    alpha4: 0.2
    alpha5: 0.2
    base_frame_id: "base_footprint"
    beam_skip_distance: 0.5
    beam_skip_error_threshold: 0.9
    beam_skip_threshold: 0.3
    do_beamskip: false
    global_frame_id: "map"
    lambda_short: 0.1
    laser_likelihood_max_dist: 2.0
    laser_max_range: 100.0
    laser_min_range: -1.0
    laser_model_type: "likelihood_field"
    max_beams: 60
    max_particles: 2000
    min_particles: 500
    odom_frame_id: "odom"
    pf_err: 0.05
    pf_z: 0.99
    recovery_alpha_fast: 0.0
    recovery_alpha_slow: 0.0
    resample_interval: 1
    robot_model_type: "nav2_amcl::DifferentialMotionModel"
    save_pose_rate: 0.5
    sigma_hit: 0.2
    tf_broadcast: true
    transform_tolerance: 1.0
    update_min_a: 0.2
    update_min_d: 0.25
    z_hit: 0.5
    z_max: 0.05
    z_rand: 0.5
    z_short: 0.05
    scan_topic: scan

bt_navigator:
  ros__parameters:
    global_frame: map
    robot_base_frame: base_link
    odom_topic: /odom
    bt_loop_duration: 10
    default_server_timeout: 20
    wait_for_service_timeout: 1000
    action_server_result_timeout: 900.0
    navigators: ["navigate_to_pose", "navigate_through_poses"]
    navigate_to_pose:
      plugin: "nav2_bt_navigator/NavigateToPoseNavigator"
    navigate_through_poses:
      plugin: "nav2_bt_navigator/NavigateThroughPosesNavigator"
    # 'default_nav_through_poses_bt_xml' and 'default_nav_to_pose_bt_xml' are use defaults:
    # nav2_bt_navigator/navigate_to_pose_w_replanning_and_recovery.xml
    # nav2_bt_navigator/navigate_through_poses_w_replanning_and_recovery.xml
    # They can be set here or via a RewrittenYaml remap from a parent launch file to Nav2.
    plugin_lib_names:
      - nav2_compute_path_to_pose_action_bt_node
      - nav2_compute_path_through_poses_action_bt_node
      - nav2_smooth_path_action_bt_node
      - nav2_follow_path_action_bt_node
      - nav2_spin_action_bt_node
      - nav2_wait_action_bt_node
      - nav2_assisted_teleop_action_bt_node
      - nav2_back_up_action_bt_node
      - nav2_drive_on_heading_bt_node
      - nav2_clear_costmap_service_bt_node
      - nav2_is_stuck_condition_bt_node
      - nav2_goal_reached_condition_bt_node
      - nav2_goal_updated_condition_bt_node
      - nav2_globally_updated_goal_condition_bt_node
      - nav2_is_path_valid_condition_bt_node
      - nav2_are_error_codes_active_condition_bt_node
      - nav2_would_a_controller_recovery_help_condition_bt_node
      - nav2_would_a_planner_recovery_help_condition_bt_node
      - nav2_would_a_smoother_recovery_help_condition_bt_node
      - nav2_initial_pose_received_condition_bt_node
      - nav2_reinitialize_global_localization_service_bt_node
      - nav2_rate_controller_bt_node
      - nav2_distance_controller_bt_node
      - nav2_speed_controller_bt_node
      - nav2_truncate_path_action_bt_node
      - nav2_truncate_path_local_action_bt_node
      - nav2_goal_updater_node_bt_node
      - nav2_recovery_node_bt_node
      - nav2_pipeline_sequence_bt_node
      - nav2_round_robin_node_bt_node
      - nav2_transform_available_condition_bt_node
      - nav2_time_expired_condition_bt_node
      - nav2_path_expiring_timer_condition
      - nav2_distance_traveled_condition_bt_node
      - nav2_single_trigger_bt_node
      - nav2_goal_updated_controller_bt_node
      - nav2_is_battery_low_condition_bt_node
      - nav2_navigate_through_poses_action_bt_node
      - nav2_navigate_to_pose_action_bt_node
      - nav2_remove_passed_goals_action_bt_node
      - nav2_planner_selector_bt_node
      - nav2_controller_selector_bt_node
      - nav2_goal_checker_selector_bt_node
      - nav2_controller_cancel_bt_node
      - nav2_path_longer_on_approach_bt_node
      - nav2_wait_cancel_bt_node
      - nav2_spin_cancel_bt_node
      - nav2_back_up_cancel_bt_node
      - nav2_assisted_teleop_cancel_bt_node
      - nav2_drive_on_heading_cancel_bt_node
      - nav2_is_battery_charging_condition_bt_node
    error_code_names:
      - compute_path_error_code
      - follow_path_error_code

controller_server:
  ros__parameters:
    controller_frequency: 20.0
    min_x_velocity_threshold: 0.001
    min_y_velocity_threshold: 0.5
    min_theta_velocity_threshold: 0.001
    failure_tolerance: 0.3
    progress_checker_plugins: ["progress_checker"]
    goal_checker_plugins: ["general_goal_checker"] # "precise_goal_checker"
    controller_plugins: ["FollowPath"]
    use_realtime_priority: false

    # Progress checker parameters
    progress_checker:
      plugin: "nav2_controller::SimpleProgressChecker"
      required_movement_radius: 0.5
      movement_time_allowance: 10.0
    # Goal checker parameters
    #precise_goal_checker:
    #  plugin: "nav2_controller::SimpleGoalChecker"
    #  xy_goal_tolerance: 0.25
    #  yaw_goal_tolerance: 0.25
    #  stateful: True
    general_goal_checker:
      stateful: True
      plugin: "nav2_controller::SimpleGoalChecker"
      xy_goal_tolerance: 0.25
      yaw_goal_tolerance: 0.25
    # DWB parameters
    FollowPath:
      plugin: "dwb_core::DWBLocalPlanner"
      debug_trajectory_details: True
      min_vel_x: 0.0
      min_vel_y: 0.0
      max_vel_x: 0.26
      max_vel_y: 0.0
      max_vel_theta: 1.0
      min_speed_xy: 0.0
      max_speed_xy: 0.26
      min_speed_theta: 0.0
      # Add high threshold velocity for turtlebot 3 issue.
      # https://github.com/ROBOTIS-GIT/turtlebot3_simulations/issues/75
      acc_lim_x: 2.5
      acc_lim_y: 0.0
      acc_lim_theta: 3.2
      decel_lim_x: -2.5
      decel_lim_y: 0.0
      decel_lim_theta: -3.2
      vx_samples: 20
      vy_samples: 5
      vtheta_samples: 20
      sim_time: 1.7
      linear_granularity: 0.05
      angular_granularity: 0.025
      transform_tolerance: 0.2
      xy_goal_tolerance: 0.25
      trans_stopped_velocity: 0.25
      short_circuit_trajectory_evaluation: True
      stateful: True
      critics: ["RotateToGoal", "Oscillation", "BaseObstacle", "GoalAlign", "PathAlign", "PathDist", "GoalDist"]
      BaseObstacle.scale: 0.02
      PathAlign.scale: 32.0
      PathAlign.forward_point_distance: 0.1
      GoalAlign.scale: 24.0
      GoalAlign.forward_point_distance: 0.1
      PathDist.scale: 32.0
      GoalDist.scale: 24.0
      RotateToGoal.scale: 32.0
      RotateToGoal.slowing_factor: 5.0
      RotateToGoal.lookahead_time: -1.0

local_costmap:
  local_costmap:
    ros__parameters:
      update_frequency: 5.0
      publish_frequency: 2.0
      global_frame: odom
      robot_base_frame: base_link
      rolling_window: true
      width: 3
      height: -20
      resolution: 0.05
      robot_radius: 0.22
      plugins: ["voxel_layer", "inflation_layer"]
      inflation_layer:
        plugin: "nav2_costmap_2d::InflationLayer"
        cost_scaling_factor: 3.0
        inflation_radius: 0.55
      voxel_layer:
        plugin: "nav2_costmap_2d::VoxelLayer"
        enabled: True
        publish_voxel_map: True
        origin_z: 0.0
        z_resolution: 0.05
        z_voxels: 16
        max_obstacle_height: 2.0
        mark_threshold: 0
        observation_sources: scan
        scan:
          topic: /scan
          max_obstacle_height: 2.0
          clearing: True
          marking: True
          data_type: "LaserScan"
          raytrace_max_range: 3.0
          raytrace_min_range: 0.0
          obstacle_max_range: 2.5
          obstacle_min_range: 0.0
      static_layer:
        plugin: "nav2_costmap_2d::StaticLayer"
        map_subscribe_transient_local: True
      always_send_full_costmap: True

global_costmap:
  global_costmap:
    ros__parameters:
      update_frequency: 1.0
      publish_frequency: 1.0
      global_frame: map
      robot_base_frame: base_link
      robot_radius: 0.22
      resolution: 0.05
      track_unknown_space: true
      plugins: ["static_layer", "obstacle_layer", "inflation_layer"]
      obstacle_layer:
        plugin: "nav2_costmap_2d::ObstacleLayer"
        enabled: True
        observation_sources: scan
        scan:
          topic: /scan
          max_obstacle_height: 2.0
          clearing: True
          marking: True
          data_type: "LaserScan"
          raytrace_max_range: 3.0
          raytrace_min_range: 0.0
          obstacle_max_range: 2.5
          obstacle_min_range: 0.0
      static_layer:
        plugin: "nav2_costmap_2d::StaticLayer"
        map_subscribe_transient_local: True
      inflation_layer:
        plugin: "nav2_costmap_2d::InflationLayer"
        cost_scaling_factor: 3.0
        inflation_radius: 0.55
      always_send_full_costmap: True

# The yaml_filename does not need to be specified since it going to be set by defaults in launch.
# If you'd rather set it in the yaml, remove the default "map" value in the tb3_simulation_launch.py
# file & provide full path to map below. If CLI map configuration or launch default is provided, that will be used.
# map_server:
#   ros__parameters:
#     yaml_filename: ""

map_saver:
  ros__parameters:
    save_map_timeout: 5.0
    free_thresh_default: 0.25
    occupied_thresh_default: 0.65
    map_subscribe_transient_local: True

planner_server:
  ros__parameters:
    expected_planner_frequency: 20.0
    planner_plugins: ["GridBased"]
    GridBased:
      plugin: "nav2_navfn_planner/NavfnPlanner"
      tolerance: 0.5
      use_astar: false
      allow_unknown: true

smoother_server:
  ros__parameters:
    smoother_plugins: ["simple_smoother"]
    simple_smoother:
      plugin: "nav2_smoother::SimpleSmoother"
      tolerance: 1.0e-10
      max_its: 1000
      do_refinement: True

behavior_server:
  ros__parameters:
    local_costmap_topic: local_costmap/costmap_raw
    global_costmap_topic: global_costmap/costmap_raw
    local_footprint_topic: local_costmap/published_footprint
    global_footprint_topic: global_costmap/published_footprint
    cycle_frequency: 10.0
    behavior_plugins: ["spin", "backup", "drive_on_heading", "assisted_teleop", "wait"]
    spin:
      plugin: "nav2_behaviors/Spin"
    backup:
      plugin: "nav2_behaviors/BackUp"
    drive_on_heading:
      plugin: "nav2_behaviors/DriveOnHeading"
    wait:
      plugin: "nav2_behaviors/Wait"
    assisted_teleop:
      plugin: "nav2_behaviors/AssistedTeleop"
    local_frame: odom
    global_frame: map
    robot_base_frame: base_link
    transform_tolerance: 0.1
    simulate_ahead_time: 2.0
    max_rotational_vel: 1.0
    min_rotational_vel: 0.4
    rotational_acc_lim: 3.2

waypoint_follower:
  ros__parameters:
    loop_rate: 20
    stop_on_failure: false
    action_server_result_timeout: 900.0
    waypoint_task_executor_plugin: "wait_at_waypoint"
    wait_at_waypoint:
      plugin: "nav2_waypoint_follower::WaitAtWaypoint"
      enabled: True
      waypoint_pause_duration: 200

velocity_smoother:
  ros__parameters:
    smoothing_frequency: 20.0
    scale_velocities: False
    feedback: "OPEN_LOOP"
    max_velocity: [0.26, 0.0, 1.0]
    min_velocity: [-0.26, 0.0, -1.0]
    max_accel: [2.5, 0.0, 3.2]
    max_decel: [-2.5, 0.0, -3.2]
    odom_topic: "odom"
    odom_duration: 0.1
    deadband_velocity: [0.0, 0.0, 0.0]
    velocity_timeout: 1.0

collision_monitor:
  ros__parameters:
    base_frame_id: "base_footprint"
    odom_frame_id: "odom"
    cmd_vel_in_topic: "cmd_vel_smoothed"
    cmd_vel_out_topic: "cmd_vel"
    state_topic: "collision_monitor_state"
    transform_tolerance: 0.2
    source_timeout: 1.0
    base_shift_correction: True
    stop_pub_timeout: 2.0
    # Polygons represent zone around the robot for "stop", "slowdown" and "limit" action types,
    # and robot footprint for "approach" action type.
    polygons: ["FootprintApproach"]
    FootprintApproach:
      type: "polygon"
      action_type: "approach"
      footprint_topic: "/local_costmap/published_footprint"
      time_before_collision: 2.0
      simulation_time_step: 0.1
      min_points: 6
      visualize: False
      enabled: True
    observation_sources: ["scan"]
    scan:
      type: "scan"
      topic: "scan"
      min_height: 0.15
      max_height: 2.0
      enabled: True

```

and then , try to send a message into topic /initial\_pose or use the `2D_estimate_pose` option in rviz.

#### Unexpected Result: abnormal memory usage

we found that nav2\_controller process occupies a very large amount of memory (up to 10G, sometimes even exceeding 20G, which is very abnormal), as following:
![db3537365059f4ae705cd6d092537db](https://github.com/ros-planning/navigation2/assets/130988564/7a088ebb-4e78-464d-a539-8362ed3537ac)

there's the content of defaulted `nav2_params.yaml`:

```
amcl:
  ros__parameters:
    alpha1: 0.2
    alpha2: 0.2
    alpha3: 0.2
    alpha4: 0.2
    alpha5: 0.2
    base_frame_id: "base_footprint"
    beam_skip_distance: 0.5
    beam_skip_error_threshold: 0.9
    beam_skip_threshold: 0.3
    do_beamskip: false
    global_frame_id: "map"
    lambda_short: 0.1
    laser_likelihood_max_dist: 2.0
    laser_max_range: 100.0
    laser_min_range: -1.0
    laser_model_type: "likelihood_field"
    max_beams: 60
    max_particles: 2000
    min_particles: 500
    odom_frame_id: "odom"
    pf_err: 0.05
    pf_z: 0.99
    recovery_alpha_fast: 0.0
    recovery_alpha_slow: 0.0
    resample_interval: 1
    robot_model_type: "nav2_amcl::DifferentialMotionModel"
    save_pose_rate: 0.5
    sigma_hit: 0.2
    tf_broadcast: true
    transform_tolerance: 1.0
    update_min_a: 0.2
    update_min_d: 0.25
    z_hit: 0.5
    z_max: 0.05
    z_rand: 0.5
    z_short: 0.05
    scan_topic: scan

bt_navigator:
  ros__parameters:
    global_frame: map
    robot_base_frame: base_link
    odom_topic: /odom
    bt_loop_duration: 10
    default_server_timeout: 20
    wait_for_service_timeout: 1000
    action_server_result_timeout: 900.0
    navigators: ["navigate_to_pose", "navigate_through_poses"]
    navigate_to_pose:
      plugin: "nav2_bt_navigator/NavigateToPoseNavigator"
    navigate_through_poses:
      plugin: "nav2_bt_navigator/NavigateThroughPosesNavigator"
    # 'default_nav_through_poses_bt_xml' and 'default_nav_to_pose_bt_xml' are use defaults:
    # nav2_bt_navigator/navigate_to_pose_w_replanning_and_recovery.xml
    # nav2_bt_navigator/navigate_through_poses_w_replanning_and_recovery.xml
    # They can be set here or via a RewrittenYaml remap from a parent launch file to Nav2.
    plugin_lib_names:
      - nav2_compute_path_to_pose_action_bt_node
      - nav2_compute_path_through_poses_action_bt_node
      - nav2_smooth_path_action_bt_node
      - nav2_follow_path_action_bt_node
      - nav2_spin_action_bt_node
      - nav2_wait_action_bt_node
      - nav2_assisted_teleop_action_bt_node
      - nav2_back_up_action_bt_node
      - nav2_drive_on_heading_bt_node
      - nav2_clear_costmap_service_bt_node
      - nav2_is_stuck_condition_bt_node
      - nav2_goal_reached_condition_bt_node
      - nav2_goal_updated_condition_bt_node
      - nav2_globally_updated_goal_condition_bt_node
      - nav2_is_path_valid_condition_bt_node
      - nav2_are_error_codes_active_condition_bt_node
      - nav2_would_a_controller_recovery_help_condition_bt_node
      - nav2_would_a_planner_recovery_help_condition_bt_node
      - nav2_would_a_smoother_recovery_help_condition_bt_node
      - nav2_initial_pose_received_condition_bt_node
      - nav2_reinitialize_global_localization_service_bt_node
      - nav2_rate_controller_bt_node
      - nav2_distance_controller_bt_node
      - nav2_speed_controller_bt_node
      - nav2_truncate_path_action_bt_node
      - nav2_truncate_path_local_action_bt_node
      - nav2_goal_updater_node_bt_node
      - nav2_recovery_node_bt_node
      - nav2_pipeline_sequence_bt_node
      - nav2_round_robin_node_bt_node
      - nav2_transform_available_condition_bt_node
      - nav2_time_expired_condition_bt_node
      - nav2_path_expiring_timer_condition
      - nav2_distance_traveled_condition_bt_node
      - nav2_single_trigger_bt_node
      - nav2_goal_updated_controller_bt_node
      - nav2_is_battery_low_condition_bt_node
      - nav2_navigate_through_poses_action_bt_node
      - nav2_navigate_to_pose_action_bt_node
      - nav2_remove_passed_goals_action_bt_node
      - nav2_planner_selector_bt_node
      - nav2_controller_selector_bt_node
      - nav2_goal_checker_selector_bt_node
      - nav2_controller_cancel_bt_node
      - nav2_path_longer_on_approach_bt_node
      - nav2_wait_cancel_bt_node
      - nav2_spin_cancel_bt_node
      - nav2_back_up_cancel_bt_node
      - nav2_assisted_teleop_cancel_bt_node
      - nav2_drive_on_heading_cancel_bt_node
      - nav2_is_battery_charging_condition_bt_node
    error_code_names:
      - compute_path_error_code
      - follow_path_error_code

controller_server:
  ros__parameters:
    controller_frequency: 20.0
    min_x_velocity_threshold: 0.001
    min_y_velocity_threshold: 0.5
    min_theta_velocity_threshold: 0.001
    failure_tolerance: 0.3
    progress_checker_plugins: ["progress_checker"]
    goal_checker_plugins: ["general_goal_checker"] # "precise_goal_checker"
    controller_plugins: ["FollowPath"]
    use_realtime_priority: false

    # Progress checker parameters
    progress_checker:
      plugin: "nav2_controller::SimpleProgressChecker"
      required_movement_radius: 0.5
      movement_time_allowance: 10.0
    # Goal checker parameters
    #precise_goal_checker:
    #  plugin: "nav2_controller::SimpleGoalChecker"
    #  xy_goal_tolerance: 0.25
    #  yaw_goal_tolerance: 0.25
    #  stateful: True
    general_goal_checker:
      stateful: True
      plugin: "nav2_controller::SimpleGoalChecker"
      xy_goal_tolerance: 0.25
      yaw_goal_tolerance: 0.25
    # DWB parameters
    FollowPath:
      plugin: "dwb_core::DWBLocalPlanner"
      debug_trajectory_details: True
      min_vel_x: 0.0
      min_vel_y: 0.0
      max_vel_x: 0.26
      max_vel_y: 0.0
      max_vel_theta: 1.0
      min_speed_xy: 0.0
      max_speed_xy: 0.26
      min_speed_theta: 0.0
      # Add high threshold velocity for turtlebot 3 issue.
      # https://github.com/ROBOTIS-GIT/turtlebot3_simulations/issues/75
      acc_lim_x: 2.5
      acc_lim_y: 0.0
      acc_lim_theta: 3.2
      decel_lim_x: -2.5
      decel_lim_y: 0.0
      decel_lim_theta: -3.2
      vx_samples: 20
      vy_samples: 5
      vtheta_samples: 20
      sim_time: 1.7
      linear_granularity: 0.05
      angular_granularity: 0.025
      transform_tolerance: 0.2
      xy_goal_tolerance: 0.25
      trans_stopped_velocity: 0.25
      short_circuit_trajectory_evaluation: True
      stateful: True
      critics: ["RotateToGoal", "Oscillation", "BaseObstacle", "GoalAlign", "PathAlign", "PathDist", "GoalDist"]
      BaseObstacle.scale: 0.02
      PathAlign.scale: 32.0
      PathAlign.forward_point_distance: 0.1
      GoalAlign.scale: 24.0
      GoalAlign.forward_point_distance: 0.1
      PathDist.scale: 32.0
      GoalDist.scale: 24.0
      RotateToGoal.scale: 32.0
      RotateToGoal.slowing_factor: 5.0
      RotateToGoal.lookahead_time: -1.0

local_costmap:
  local_costmap:
    ros__parameters:
      update_frequency: 5.0
      publish_frequency: 2.0
      global_frame: odom
      robot_base_frame: base_link
      rolling_window: true
      width: 3
      height: 3
      resolution: 0.05
      robot_radius: 0.22
      plugins: ["voxel_layer", "inflation_layer"]
      inflation_layer:
        plugin: "nav2_costmap_2d::InflationLayer"
        cost_scaling_factor: 3.0
        inflation_radius: 0.55
      voxel_layer:
        plugin: "nav2_costmap_2d::VoxelLayer"
        enabled: True
        publish_voxel_map: True
        origin_z: 0.0
        z_resolution: 0.05
        z_voxels: 16
        max_obstacle_height: 2.0
        mark_threshold: 0
        observation_sources: scan
        scan:
          topic: /scan
          max_obstacle_height: 2.0
          clearing: True
          marking: True
          data_type: "LaserScan"
          raytrace_max_range: 3.0
          raytrace_min_range: 0.0
          obstacle_max_range: 2.5
          obstacle_min_range: 0.0
      static_layer:
        plugin: "nav2_costmap_2d::StaticLayer"
        map_subscribe_transient_local: True
      always_send_full_costmap: True

global_costmap:
  global_costmap:
    ros__parameters:
      update_frequency: 1.0
      publish_frequency: 1.0
      global_frame: map
      robot_base_frame: base_link
      robot_radius: 0.22
      resolution: 0.05
      track_unknown_space: true
      plugins: ["static_layer", "obstacle_layer", "inflation_layer"]
      obstacle_layer:
        plugin: "nav2_costmap_2d::ObstacleLayer"
        enabled: True
        observation_sources: scan
        scan:
          topic: /scan
          max_obstacle_height: 2.0
          clearing: True
          marking: True
          data_type: "LaserScan"
          raytrace_max_range: 3.0
          raytrace_min_range: 0.0
          obstacle_max_range: 2.5
          obstacle_min_range: 0.0
      static_layer:
        plugin: "nav2_costmap_2d::StaticLayer"
        map_subscribe_transient_local: True
      inflation_layer:
        plugin: "nav2_costmap_2d::InflationLayer"
        cost_scaling_factor: 3.0
        inflation_radius: 0.55
      always_send_full_costmap: True

# The yaml_filename does not need to be specified since it going to be set by defaults in launch.
# If you'd rather set it in the yaml, remove the default "map" value in the tb3_simulation_launch.py
# file & provide full path to map below. If CLI map configuration or launch default is provided, that will be used.
# map_server:
#   ros__parameters:
#     yaml_filename: ""

map_saver:
  ros__parameters:
    save_map_timeout: 5.0
    free_thresh_default: 0.25
    occupied_thresh_default: 0.65
    map_subscribe_transient_local: True

planner_server:
  ros__parameters:
    expected_planner_frequency: 20.0
    planner_plugins: ["GridBased"]
    GridBased:
      plugin: "nav2_navfn_planner/NavfnPlanner"
      tolerance: 0.5
      use_astar: false
      allow_unknown: true

smoother_server:
  ros__parameters:
    smoother_plugins: ["simple_smoother"]
    simple_smoother:
      plugin: "nav2_smoother::SimpleSmoother"
      tolerance: 1.0e-10
      max_its: 1000
      do_refinement: True

behavior_server:
  ros__parameters:
    local_costmap_topic: local_costmap/costmap_raw
    global_costmap_topic: global_costmap/costmap_raw
    local_footprint_topic: local_costmap/published_footprint
    global_footprint_topic: global_costmap/published_footprint
    cycle_frequency: 10.0
    behavior_plugins: ["spin", "backup", "drive_on_heading", "assisted_teleop", "wait"]
    spin:
      plugin: "nav2_behaviors/Spin"
    backup:
      plugin: "nav2_behaviors/BackUp"
    drive_on_heading:
      plugin: "nav2_behaviors/DriveOnHeading"
    wait:
      plugin: "nav2_behaviors/Wait"
    assisted_teleop:
      plugin: "nav2_behaviors/AssistedTeleop"
    local_frame: odom
    global_frame: map
    robot_base_frame: base_link
    transform_tolerance: 0.1
    simulate_ahead_time: 2.0
    max_rotational_vel: 1.0
    min_rotational_vel: 0.4
    rotational_acc_lim: 3.2

waypoint_follower:
  ros__parameters:
    loop_rate: 20
    stop_on_failure: false
    action_server_result_timeout: 900.0
    waypoint_task_executor_plugin: "wait_at_waypoint"
    wait_at_waypoint:
      plugin: "nav2_waypoint_follower::WaitAtWaypoint"
      enabled: True
      waypoint_pause_duration: 200

velocity_smoother:
  ros__parameters:
    smoothing_frequency: 20.0
    scale_velocities: False
    feedback: "OPEN_LOOP"
    max_velocity: [0.26, 0.0, 1.0]
    min_velocity: [-0.26, 0.0, -1.0]
    max_accel: [2.5, 0.0, 3.2]
    max_decel: [-2.5, 0.0, -3.2]
    odom_topic: "odom"
    odom_duration: 0.1
    deadband_velocity: [0.0, 0.0, 0.0]
    velocity_timeout: 1.0

collision_monitor:
  ros__parameters:
    base_frame_id: "base_footprint"
    odom_frame_id: "odom"
    cmd_vel_in_topic: "cmd_vel_smoothed"
    cmd_vel_out_topic: "cmd_vel"
    state_topic: "collision_monitor_state"
    transform_tolerance: 0.2
    source_timeout: 1.0
    base_shift_correction: True
    stop_pub_timeout: 2.0
    # Polygons represent zone around the robot for "stop", "slowdown" and "limit" action types,
    # and robot footprint for "approach" action type.
    polygons: ["FootprintApproach"]
    FootprintApproach:
      type: "polygon"
      action_type: "approach"
      footprint_topic: "/local_costmap/published_footprint"
      time_before_collision: 2.0
      simulation_time_step: 0.1
      min_points: 6
      visualize: False
      enabled: True
    observation_sources: ["scan"]
    scan:
      type: "scan"
      topic: "scan"
      min_height: 0.15
      max_height: 2.0
      enabled: True

```

in short, here's only one difference between two `params.yaml` file:
the height of local costmap is set as `-20` or `3`

* [ros2](/questions/tagged/ros2 "show questions tagged 'ros2'")
* [costmap](/questions/tagged/costmap "show questions tagged 'costmap'")
* [nav2](/questions/tagged/nav2 "show questions tagged 'nav2'")
* [local-costmap](/questions/tagged/local-costmap "show questions tagged 'local-costmap'")

[Share](/q/106008 "Short permalink to this question")

[Improve this question](/posts/106008/edit)

Follow

[edited Dec 13, 2023 at 9:14](/posts/106008/revisions "show all edits to this post")

GoesM

asked Dec 12, 2023 at 7:47

[![GoesM's user avatar](https://i.sstatic.net/dKohq.jpg?s=64)](/users/37693/goesm)

[GoesM](/users/37693/goesm)GoesM
133 bronze badges

$\endgroup$

2

* $\begingroup$
  A bug report would be better served in the [nav2 repository](https://github.com/ros-planning/navigation2). You'd have more people who work with the development of nav2 there. I suggest you cross post this as an issue on Nav2's GitHub repository
  $\endgroup$
  â€“Â [ssarkar](/users/21163/ssarkar "734 reputation")

  Commented
  Dec 12, 2023 at 8:51
* $\begingroup$
  Oh please instead remove the general -20 stuff we discussed in the ticket -- and lets focus on the memory issues. You didn't include your parameter files for comparison!
  $\endgroup$
  â€“Â [Steve Macenski](/users/30979/steve-macenski "6,402 reputation")

  Commented
  Dec 12, 2023 at 18:39

Add a comment
Â |

## 0

Sorted by:

[Reset to default](/questions/106008/ros2nav2-user-misconfiguration-of-parameters-may-bring-abnormal-memory-usage?answertab=scoredesc#tab-top)

Highest score (default)

Date modified (newest first)

Date created (oldest first)

## Know someone who can answer? Share a link to this [question](https://robotics.stackexchange.com/questions/106008/ros2nav2-user-misconfiguration-of-parameters-may-bring-abnormal-memory-usage) via [email](/cdn-cgi/l/email-protection#bf80cccaddd5dadccb82edd0ddd0cbd6dccc9a8d8feccbdedcd49a8d8ffac7dcd7ded1d8da9a8d8feecadacccbd6d0d199ded2cf84ddd0dbc6829a8addedf0ec8d9a8adb9a8addf1fee98d9a8adb9a8d8feaccdacd9a8d8fd2d6ccdcd0d1d9d6d8cacddecbd6d0d19a8d8fd0d99a8d8fcfdecdded2dacbdacdcc9a8d8fd2dec69a8d8fddcdd6d1d89a8d8fdeddd1d0cdd2ded39a8d8fd2dad2d0cdc69a8d8fcaccded8da9a8ffed7cbcbcfcc9a8cde9a8dd99a8dd9cdd0ddd0cbd6dccc91cccbdedcd4dac7dcd7ded1d8da91dcd0d29a8dd9ce9a8dd98e8f898f8f879a8cd9ccdad29a8cdb8d), [Twitter](https://twitter.com/share?url=https%3a%2f%2frobotics.stackexchange.com%2fq%2f106008%3fstw%3d2), or [Facebook](https://www.facebook.com/sharer.php?u=https%3a%2f%2frobotics.stackexchange.com%2fq%2f106008%3fsfb%3d2).

## Your Answer

Thanks for contributing an answer to Robotics Stack Exchange!

* Please be sure to *answer the question*. Provide details and share your research!

But *avoid* â€¦

* Asking for help, clarification, or responding to other answers.
* Making statements based on opinion; back them up with references or personal experience.

Use MathJax to format equations. [MathJax reference](https://robotics.meta.stackexchange.com/questions/130/how-can-i-format-mathematical-expressions-here-using-mathjax).

To learn more, see our [tips on writing great answers](/help/how-to-answer).

Draft saved
Draft discarded

### Sign up or [log in](/users/login?ssrc=question_page&returnurl=https%3a%2f%2frobotics.stackexchange.com%2fquestions%2f106008%2fros2nav2-user-misconfiguration-of-parameters-may-bring-abnormal-memory-usage%23new-answer)

 Sign up using Google

 Sign up using Email and Password

Submit
### Post as a guest

Name

Email

Required, but never shown

### Post as a guest

Name

Email

Required, but never shown

Post Your Answer

Discard

By clicking â€œPost Your Answerâ€, you agree to our [terms of service](https://stackoverflow.com/legal/terms-of-service/public) and acknowledge you have read our [privacy policy](https://stackoverflow.com/legal/privacy-policy).

## Browse other questions tagged * [ros2](/questions/tagged/ros2 "show questions tagged 'ros2'") * [costmap](/questions/tagged/costmap "show questions tagged 'costmap'") * [nav2](/questions/tagged/nav2 "show questions tagged 'nav2'") * [local-costmap](/questions/tagged/local-costmap "show questions tagged 'local-costmap'") or [ask your own question](/questions/ask).

* The Overflow Blog
* [Failing fast at scale: Rapid prototyping at Intuit](https://stackoverflow.blog/2025/01/08/failing-fast-at-scale-rapid-prototyping-at-intuit/)
* [â€œData is the keyâ€: Twilioâ€™s Head of R&D on the need for good data](https://stackoverflow.blog/2025/01/10/data-is-the-key-twilio-s-head-of-r-and-d-on-the-need-for-good-data/)
* Featured on Meta
* [The December 2024 Community Asks Sprint has been moved to March 2025 (and...](https://meta.stackexchange.com/questions/404724/the-december-2024-community-asks-sprint-has-been-moved-to-march-2025-and-length "The December 2024 Community Asks Sprint has been moved to March 2025 (and lengthened to 2 weeks to compensate)")

#### Related

[0](/q/54356 "Question score (upvotes - downvotes)")
[Global Costmap not visualized](/questions/54356/global-costmap-not-visualized)

[0](/q/57665 "Question score (upvotes - downvotes)")
[Problem with ros navigation](/questions/57665/problem-with-ros-navigation)

[0](/q/68718 "Question score (upvotes - downvotes)")
[Local costmap not centered on robot](/questions/68718/local-costmap-not-centered-on-robot)

[0](/q/78596 "Question score (upvotes - downvotes)")
[Problem with loading social navigation layer plugins on costmap](/questions/78596/problem-with-loading-social-navigation-layer-plugins-on-costmap)

[0](/q/80078 "Question score (upvotes - downvotes)")
[local\_cosmap remark but can't clear](/questions/80078/local-cosmap-remark-but-cant-clear)

[0](/q/95203 "Question score (upvotes - downvotes)")
[[solved] help needed: move\_base planner not publishing](/questions/95203/solved-help-needed-move-base-planner-not-publishing)

[0](/q/95845 "Question score (upvotes - downvotes)")
[Clearing the obstacles form local costmap](/questions/95845/clearing-the-obstacles-form-local-costmap)

[0](/q/101978 "Question score (upvotes - downvotes)")
[The obstacle is not on my cost map](/questions/101978/the-obstacle-is-not-on-my-cost-map)

[0](/q/105504 "Question score (upvotes - downvotes)")
[Nav2 bring up doesn't render turtlebot3](/questions/105504/nav2-bring-up-doesnt-render-turtlebot3)

[0](/q/111767 "Question score (upvotes - downvotes)")
[Tune Nav2 parameters - Ackermann vehicle](/questions/111767/tune-nav2-parameters-ackermann-vehicle)

#### [Hot Network Questions](https://stackexchange.com/questions?tab=hot)

* [Why am I not able to see mounted folder with Docker-Desktop with WSL2?](https://superuser.com/questions/1869971/why-am-i-not-able-to-see-mounted-folder-with-docker-desktop-with-wsl2)
* [How is heat loss related to heat source?](https://diy.stackexchange.com/questions/312774/how-is-heat-loss-related-to-heat-source)
* [Did the term "irrational number" initially have any derogatory intent?](https://hsm.stackexchange.com/questions/18201/did-the-term-irrational-number-initially-have-any-derogatory-intent)
* [Rail splitter with LM324](https://electronics.stackexchange.com/questions/735538/rail-splitter-with-lm324)
* [In a single elimination tournament, each match can end with 1 loser or two losers. What's the probability the tournament ends with no winner?](https://math.stackexchange.com/questions/5021105/in-a-single-elimination-tournament-each-match-can-end-with-1-loser-or-two-loser)
* [The Random Skipping Sequential (RSS) Monte Carlo algorithm](https://codereview.stackexchange.com/questions/294999/the-random-skipping-sequential-rss-monte-carlo-algorithm)
* [Slangã€Œè©°ã‚“ã ã€ and its source ã€Œè©°ã‚€ã€'s pitch](https://japanese.stackexchange.com/questions/106881/slang-%E8%A9%B0%E3%82%93%E3%81%A0-and-its-source-%E8%A9%B0%E3%82%80-s-pitch)
* [Can I use an A or D string on my violin in place of a G string?](https://music.stackexchange.com/questions/138533/can-i-use-an-a-or-d-string-on-my-violin-in-place-of-a-g-string)
* [After Joseph was accused of seducing Potiphar's wife, why was he sentenced to jail (for over 2 years) rather than executed?](https://judaism.stackexchange.com/questions/146929/after-joseph-was-accused-of-seducing-potiphars-wife-why-was-he-sentenced-to-ja)
* [Does a magnetic transducer buzzer need a resistor in series?](https://electronics.stackexchange.com/questions/735464/does-a-magnetic-transducer-buzzer-need-a-resistor-in-series)
* [Is it idiomatic to say "I just played" or "I was just playing" in response to the question "What did you do this morning"?](https://ell.stackexchange.com/questions/361067/is-it-idiomatic-to-say-i-just-played-or-i-was-just-playing-in-response-to-th)
* [Can I add a wood burning stove to radiant heat boiler system?](https://diy.stackexchange.com/questions/312654/can-i-add-a-wood-burning-stove-to-radiant-heat-boiler-system)
* [Is it possible to make a flight simulator that can model aerobatics and stalls accurately?](https://aviation.stackexchange.com/questions/107669/is-it-possible-to-make-a-flight-simulator-that-can-model-aerobatics-and-stalls-a)
* [Can equipment used in Alcohol distillation be used for the small-scale distillation of crude oil](https://chemistry.stackexchange.com/questions/186751/can-equipment-used-in-alcohol-distillation-be-used-for-the-small-scale-distillat)
* [How to understand structure of sentences in probability](https://stats.stackexchange.com/questions/659651/how-to-understand-structure-of-sentences-in-probability)
* [Would Canada be one of the poorer states if inducted into the United States?](https://skeptics.stackexchange.com/questions/57603/would-canada-be-one-of-the-poorer-states-if-inducted-into-the-united-states)
* [Possible Error in Mathematical Physics by Robert Geroch? (or critical misunderstanding by me)](https://math.stackexchange.com/questions/5021537/possible-error-in-mathematical-physics-by-robert-geroch-or-critical-misunderst)
* [Why do the A-4 Skyhawk and T-38 Talon have high roll rates?](https://aviation.stackexchange.com/questions/107667/why-do-the-a-4-skyhawk-and-t-38-talon-have-high-roll-rates)
* [Arduino Mega: is there a way to have additional interrupt pins?](https://arduino.stackexchange.com/questions/97248/arduino-mega-is-there-a-way-to-have-additional-interrupt-pins)
* [Are mathematics and science algorithmic?](https://philosophy.stackexchange.com/questions/121420/are-mathematics-and-science-algorithmic)
* [How to insert a monospace character-width space character in math mode?](https://tex.stackexchange.com/questions/734631/how-to-insert-a-monospace-character-width-space-character-in-math-mode)
* [How to interact with Dead Magic demiplane?](https://rpg.stackexchange.com/questions/214361/how-to-interact-with-dead-magic-demiplane)
* [How would you put a window screen here?](https://diy.stackexchange.com/questions/312771/how-would-you-put-a-window-screen-here)
* [What do you call the equivalent of "Cardinal directions" in a hex-grid?](https://boardgames.stackexchange.com/questions/61696/what-do-you-call-the-equivalent-of-cardinal-directions-in-a-hex-grid)

more hot questions

[Question feed](/feeds/question/106008 "Feed of this question and its answers")

# Subscribe to RSS

Question feed

To subscribe to this RSS feed, copy and paste this URL into your RSS reader.

![](/posts/106008/ivc/7873?prg=16a08a2f-e07c-4b46-9cc8-2145d8c70cfb)

##### [Robotics](/)

* [Tour](/tour)
* [Help](/help)
* [Chat](https://chat.stackexchange.com?tab=site&host=robotics.stackexchange.com)
* [Contact](/contact)
* [Feedback](https://robotics.meta.stackexchange.com)

##### [Company](https://stackoverflow.co/)

* [Stack Overflow](https://stackoverflow.com)
* [Teams](https://stackoverflow.co/teams/)
* [Advertising](https://stackoverflow.co/advertising/)
* [Talent](https://stackoverflow.co/advertising/employer-branding/)
* [About](https://stackoverflow.co/)
* [Press](https://stackoverflow.co/company/press/)
* [Legal](https://stackoverflow.com/legal)
* [Privacy Policy](https://stackoverflow.com/legal/privacy-policy)
* [Terms of Service](https://stackoverflow.com/legal/terms-of-service/public)
* Cookie Settings
* [Cookie Policy](https://stackoverflow.com/legal/cookie-policy)

##### [Stack Exchange Network](https://stackexchange.com)

* [Technology](https://stackexchange.com/sites#technology)
* [Culture & recreation](https://stackexchange.com/sites#culturerecreation)
* [Life & arts](https://stackexchange.com/sites#lifearts)
* [Science](https://stackexchange.com/sites#science)
* [Professional](https://stackexchange.com/sites#professional)
* [Business](https://stackexchange.com/sites#business)
* [API](https://api.stackexchange.com/)
* [Data](https://data.stackexchange.com/)

* [Blog](https://stackoverflow.blog?blb=1)
* [Facebook](https://www.facebook.com/officialstackoverflow/)
* [Twitter](https://twitter.com/stackoverflow)
* [LinkedIn](https://linkedin.com/company/stack-overflow)
* [Instagram](https://www.instagram.com/thestackoverflow)

Site design / logo Â© 2025 Stack Exchange Inc;
user contributions licensed under
[CC BY-SA](https://stackoverflow.com/help/licensing)
.
revÂ 2025.1.7.20880



=== Content from github.com_4573af5e_20250110_135718.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fros-navigation%2Fnavigation2%2Fpull%2F4017)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fros-navigation%2Fnavigation2%2Fpull%2F4017)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=ros-navigation%2Fnavigation2)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[ros-navigation](/ros-navigation)
/
**[navigation2](/ros-navigation/navigation2)**
Public

* [Notifications](/login?return_to=%2Fros-navigation%2Fnavigation2) You must be signed in to change notification settings
* [Fork
  1.3k](/login?return_to=%2Fros-navigation%2Fnavigation2)
* [Star
   2.7k](/login?return_to=%2Fros-navigation%2Fnavigation2)

* [Code](/ros-navigation/navigation2)
* [Issues
  75](/ros-navigation/navigation2/issues)
* [Pull requests
  31](/ros-navigation/navigation2/pulls)
* [Discussions](/ros-navigation/navigation2/discussions)
* [Actions](/ros-navigation/navigation2/actions)
* [Projects
  0](/ros-navigation/navigation2/projects)
* [Wiki](/ros-navigation/navigation2/wiki)
* [Security](/ros-navigation/navigation2/security)
* [Insights](/ros-navigation/navigation2/pulse)

Additional navigation options

* [Code](/ros-navigation/navigation2)
* [Issues](/ros-navigation/navigation2/issues)
* [Pull requests](/ros-navigation/navigation2/pulls)
* [Discussions](/ros-navigation/navigation2/discussions)
* [Actions](/ros-navigation/navigation2/actions)
* [Projects](/ros-navigation/navigation2/projects)
* [Wiki](/ros-navigation/navigation2/wiki)
* [Security](/ros-navigation/navigation2/security)
* [Insights](/ros-navigation/navigation2/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fros-navigation%2Fnavigation2%2Fissues%2Fnew%2Fchoose)

By clicking â€œSign up for GitHubâ€, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). Weâ€™ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fros-navigation%2Fnavigation2%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# check params of costmap to avoid abnormal memory usage caused by user-misconfiguration mentioned in issue #4005 #4017

 Merged

[SteveMacenski](/SteveMacenski)
merged 1 commit into
[ros-navigation:main](/ros-navigation/navigation2/tree/main "ros-navigation/navigation2:main")
from
GoesM:main

Dec 19, 2023

 Merged

# [check params of costmap to avoid abnormal memory usage caused by user-misconfiguration mentioned in issue #4005](#top) #4017

[SteveMacenski](/SteveMacenski)
merged 1 commit into
[ros-navigation:main](/ros-navigation/navigation2/tree/main "ros-navigation/navigation2:main")
from
GoesM:main

Dec 19, 2023

[Conversation
1](/ros-navigation/navigation2/pull/4017)
[Commits
1](/ros-navigation/navigation2/pull/4017/commits)
[Checks
5](/ros-navigation/navigation2/pull/4017/checks)
[Files changed](/ros-navigation/navigation2/pull/4017/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![GoesM](https://avatars.githubusercontent.com/u/130988564?s=60&v=4)](/GoesM)

Copy link

Contributor

### @GoesM **[GoesM](/GoesM)** commented [Dec 19, 2023](#issue-2048212696)

---

## Basic Info

| Info | Please fill out this column |
| --- | --- |
| Ticket(s) this addresses | [#4005](https://github.com/ros-navigation/navigation2/issues/4005) |
| Primary OS tested on | all |
| Robotic platform tested on | gazebo simulation of Tally |
| Does this PR contain AI generated software? | No |

---

## Description of contribution in a few bullet points

As the issue [#4005](https://github.com/ros-navigation/navigation2/issues/4005) showed:

If user-misconfiguration (user wrongly set the height or the width of costmap to be negative or zero) existed, the memory usage would sharply increase and even make user's equipment unable to continue working.

so I added some `if` condition in function `Costmap2DROS::getParameters()` in costmap\_2d\_ros to avoid such unexpected situation.

## Description of documentation updates required from your changes

---

## Future work that may be required in bullet points

I noticed that here's already some similar check in `dynamicParametersCallback()` :

[costmap\_2d\_ros.cppL740-L762](https://github.com/ros-planning/navigation2/blob/main/nav2_costmap_2d/src/costmap_2d_ros.cpp#L740-762)

It's obvious that the check needed in `dynamicParametersCallback` is also needed to add into `getParameters()` all the time,

So for clearer code, shall we create a `checkParameters()` function especially for check (which is being referenced by both `getParameters()` and `dynamicParametersCallback()`) ?

Sorry, something went wrong.

All reactions

`[check width&height params](/ros-navigation/navigation2/pull/4017/commits/5d0d2ae2ecf6f49789987f5003c07c6d31c384bb "check width&height params")`

`[5d0d2ae](/ros-navigation/navigation2/pull/4017/commits/5d0d2ae2ecf6f49789987f5003c07c6d31c384bb)`

[![@codecov](https://avatars.githubusercontent.com/in/254?s=80&v=4)](/apps/codecov)
[![Codecov](https://avatars.githubusercontent.com/in/254?s=40&u=c392dd7c2afc51fe2347d4296afa8494ac05772e&v=4)](https://github.com/apps/codecov)

Copy link

### **[codecov](/apps/codecov) bot** commented [Dec 19, 2023](#issuecomment-1862452812)

|  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- |
| [Codecov](https://app.codecov.io/gh/ros-planning/navigation2/pull/4017?src=pr&el=h1&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=ros-planning) Report Attention: `2 lines` in your changes are missing coverage. Please review.  Comparison is base [(`518b378`)](https://app.codecov.io/gh/ros-planning/navigation2/commit/518b3782fb5a78fc86426403f4e83820de093ebb?el=desc&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=ros-planning) 90.17% compared to head [(`5d0d2ae`)](https://app.codecov.io/gh/ros-planning/navigation2/pull/4017?src=pr&el=desc&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=ros-planning) 90.40%.   | [Files](https://app.codecov.io/gh/ros-planning/navigation2/pull/4017?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=ros-planning) | Patch % | Lines | | --- | --- | --- | | [nav2\_costmap\_2d/src/costmap\_2d\_ros.cpp](https://app.codecov.io/gh/ros-planning/navigation2/pull/4017?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=ros-planning#diff-bmF2Ml9jb3N0bWFwXzJkL3NyYy9jb3N0bWFwXzJkX3Jvcy5jcHA=) | 50.00% | [2 Missing âš ï¸](https://app.codecov.io/gh/ros-planning/navigation2/pull/4017?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=ros-planning) |   Additional details and impacted files ``` @@            Coverage Diff             @@ ##             main    #4017      +/-   ## ========================================== + Coverage   90.17%   90.40%   +0.22%      ==========================================   Files         415      415                 Lines       18579    18583       +4      ========================================== + Hits        16754    16800      +46      + Misses       1825     1783      -42      ```   [â˜” View full report in Codecov by Sentry](https://app.codecov.io/gh/ros-planning/navigation2/pull/4017?src=pr&el=continue&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=ros-planning). ðŸ“¢ Have feedback on the report? [Share it here](https://about.codecov.io/codecov-pr-comment-feedback/?utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=ros-planning). |

All reactions

Sorry, something went wrong.

[![SteveMacenski](https://avatars.githubusercontent.com/u/14944147?s=60&v=4)](/SteveMacenski)

**[SteveMacenski](/SteveMacenski)**
approved these changes
[Dec 19, 2023](#pullrequestreview-1789500075)

 [View reviewed changes](/ros-navigation/navigation2/pull/4017/files/5d0d2ae2ecf6f49789987f5003c07c6d31c384bb)

 Hide details
View details

[![@SteveMacenski](https://avatars.githubusercontent.com/u/14944147?s=40&u=0925d37e9d3569c71d930114b66e6394c2efb3c6&v=4)](/SteveMacenski)
[SteveMacenski](/SteveMacenski)
merged commit [`7872bfa`](/ros-navigation/navigation2/commit/7872bfae096ac548a4af72c12a72c025648050fa)
into
ros-navigation:main

[Dec 19, 2023](https://github.com/ros-navigation/navigation2/pull/4017#event-11293455645)
6 of 7 checks passed

[jwallace42](/jwallace42)
pushed a commit
to jwallace42/navigation2
that referenced
this pull request
[Jan 3, 2024](#ref-commit-97c7003)
[![@GoesM](https://avatars.githubusercontent.com/u/130988564?s=40&u=7ca190cae5cd403a5e12a7648f358242d312e465&v=4)](/GoesM) [![@jwallace42](https://avatars.githubusercontent.com/u/47819219?s=40&v=4)](/jwallace42)

`[check width&height params (](/jwallace42/navigation2/commit/97c70039e92c8cc154ae25bdd2083cb7314daadf "check width&height params (#4017)

Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: gg <josho.wallace@gmail.com>")[ros-navigation#4017](https://github.com/ros-navigation/navigation2/pull/4017)[)](/jwallace42/navigation2/commit/97c70039e92c8cc154ae25bdd2083cb7314daadf "check width&height params (#4017)

Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: gg <josho.wallace@gmail.com>")`
â€¦

`[97c7003](/jwallace42/navigation2/commit/97c70039e92c8cc154ae25bdd2083cb7314daadf)`

```
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: gg <josho.wallace@gmail.com>
```

[SteveMacenski](/SteveMacenski)
pushed a commit
that referenced
this pull request
[Jan 24, 2024](#ref-commit-8831248)
[![@GoesM](https://avatars.githubusercontent.com/u/130988564?s=40&u=7ca190cae5cd403a5e12a7648f358242d312e465&v=4)](/GoesM) [![@SteveMacenski](https://avatars.githubusercontent.com/u/14944147?s=40&v=4)](/SteveMacenski)

`[check width&height params (](/ros-navigation/navigation2/commit/8831248a1f4b72061806c6e7794beb22b7bfcbb6 "check width&height params (#4017)

Co-authored-by: GoesM <GoesM@buaa.edu.cn>")[#4017](https://github.com/ros-navigation/navigation2/pull/4017)[)](/ros-navigation/navigation2/commit/8831248a1f4b72061806c6e7794beb22b7bfcbb6 "check width&height params (#4017)

Co-authored-by: GoesM <GoesM@buaa.edu.cn>")`
â€¦

`[8831248](/ros-navigation/navigation2/commit/8831248a1f4b72061806c6e7794beb22b7bfcbb6)`

```
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
```

[SteveMacenski](/SteveMacenski)
added a commit
that referenced
this pull request
[Jan 24, 2024](#ref-commit-57093ec)
[![@SteveMacenski](https://avatars.githubusercontent.com/u/14944147?s=40&u=0925d37e9d3569c71d930114b66e6394c2efb3c6&v=4)](/SteveMacenski) [![@thandal](https://avatars.githubusercontent.com/u/2613832?s=40&v=4)](/thandal)
[![@antonkesy](https://avatars.githubusercontent.com/u/25124866?s=40&u=3083aaeb13978d3596bbe7798d56221aade670d5&v=4)](/antonkesy) [![@CihatAltiparmak](https://avatars.githubusercontent.com/u/35902471?s=40&u=0fd833e50b9c38b3aea34ac6f309e2e0a80cc1fc&v=4)](/CihatAltiparmak) [![@akchobby](https://avatars.githubusercontent.com/u/44644339?s=40&u=9c2b9d23034ba7075fe5bf72508882411f5bcd55&v=4)](/akchobby) [![@Plaqueoff](https://avatars.githubusercontent.com/u/44152820?s=40&v=4)](/Plaqueoff) [![@kfabian](https://avatars.githubusercontent.com/u/2228982?s=40&u=9073914168b6da0c261bfe5a1e71a9c97ceb3847&v=4)](/kfabian) [![@ladianchad](https://avatars.githubusercontent.com/u/60467877?s=40&u=165909f8e6e5923f22f3a1bc61aad3e4025b6927&v=4)](/ladianchad) [![@kevin-floatic](https://avatars.githubusercontent.com/u/89058869?s=40&v=4)](/kevin-floatic) [![@doisyg](https://avatars.githubusercontent.com/u/15727892?s=40&u=bcf5d93af97b66be57712058e85de22bcc578f7b&v=4)](/doisyg) [![@romi2002](https://avatars.githubusercontent.com/u/9159338?s=40&v=4)](/romi2002) [![@mikeferguson](https://avatars.githubusercontent.com/u/899410?s=40&v=4)](/mikeferguson) [![@Hao-Li-Bachelorarbeit](https://avatars.githubusercontent.com/u/141755843?s=40&v=4)](/Hao-Li-Bachelorarbeit) [![@GoesM](https://avatars.githubusercontent.com/u/130988564?s=40&u=7ca190cae5cd403a5e12a7648f358242d312e465&v=4)](/GoesM) [![@BriceRenaudeau](https://avatars.githubusercontent.com/u/48433002?s=40&u=f484cc224cf93759eb1d628ad2a87e10b8438caa&v=4)](/BriceRenaudeau) [![@jwallace42](https://avatars.githubusercontent.com/u/47819219?s=40&u=8eb61193dbc7c22207d38e5307e4360cfd8a3dc4&v=4)](/jwallace42) [![@Sunart24](https://avatars.githubusercontent.com/u/89881453?s=40&u=191851f5c619bef2829cd0bc41ac67bece95c61d&v=4)](/Sunart24) [![@renan028](https://avatars.githubusercontent.com/u/6097267?s=40&u=6e672c3ce822ed77b85a599bf08ec0945ffcb769&v=4)](/renan028)

`[Iron Sync 4: Jan 23, 2024 (](/ros-navigation/navigation2/commit/57093ecc475afce44869347a5dc0f56c567c3d60 "Iron Sync 4: Jan 23, 2024 (#4063)

* collision_monitor: dynamic polygon and source enable/disable (#3825)

* Rename PushRosNamespace to PushROSNamespace

* Fix min_points checking

* initial

* fix

* fix

* remove unrelated change

* reset

* fix format

* PR fixes

* Add test

* fix comments

* add to params

* publish only if enabled

* Add source dynamic enable/disable

* add enabled param to sources

* fix

* add same to collision detector

* Update README.md: fix typo (#3842)

* Update package.xml

* fix typo (#3850)

* adjust link to point to v3.8 of behavior tree docs (#3851)

BT.CPP_v3 is used, thereby the correct docs should be linked

* Fix bug in nav2_behavior_tree/bt_action_node (#3849)

* Fix bug in nav2_behavior_tree/bt_action_node

* Fixed the bug in halt function inside
  nav2_behavior_tree/plugin/action/bt_action_node.hpp

* Added new case to nav2_behavior_tree/plugin/action/bt_action_node.hpp
  for testing the scenario to cancel

* Refactored existing cases in
  nav2_behavior_tree/plugin/action/bt_action_node.hpp

Signed-off-by: CihatAltiparmak <cihataltiparmak1@gmail.com>

* Fix bug in nav2_behavior_tree/bt_action_node

* Fixed the bug in halt function inside
  nav2_behavior_tree/plugin/action/bt_action_node.hpp

* Added new case to nav2_behavior_tree/plugin/action/bt_action_node.hpp
  for testing the scenario to cancel

* Refactored existing cases in
  nav2_behavior_tree/plugin/action/bt_action_node.hpp

Signed-off-by: CihatAltiparmak <cihataltiparmak1@gmail.com>

---------

Signed-off-by: CihatAltiparmak <cihataltiparmak1@gmail.com>

* Fix action test failure due to rate after Rolling sync API change (#3852)

* Update CMakeLists.txt (#3843)

* add option for sse4 and avs512 (#3853)

* Remove all exit(-1) crash conditions (#3846)

* Update transform_available_condition.cpp

* wrapping all examples of get_plugin_type_param in exceptions and making that throw instead of crash

* some linting

* fix typo

* Update controller.cpp

* Update nav2_params.yaml

* Update nav2_params.yaml

* simplication of lattice_generator.py, fixes #3858 (#3859)

* simplification of equation to compute the max_value/outer edge of the lattice based on number of headings.

* Stop error diagnostics when pausing nav (#3830)

* Added nodestate enum and a variable to keep track of current state of managed nodes.

* Updating state_of_managed_nodes_ when switching states and using it to determine an accurate diagnostics message.

* Fixing bugs.

* Updated/added docstrings.

* Publishing OK status when nodes are unconfigured. Changed if-else chain to switch case.

* Renamed NodeState PAUSED to INACTIVE, state_of_managed_nodes_ to managed_nodes_state_ and replaced system_active_ with an inline method.

* Bugfix.

---------

Co-authored-by: Pekka Myller <pekka.myller@karelics.fi>

* Add a timeout to the wait for transforms step of the costmap activation. (#3866)

* Add a timeout to the wait for transforms step of the costmap activation.

Signed-off-by: Fabian KÃ¶nig <fabiankoenig@gmail.com>

* Rename wait_for_transforms_timeout to initial_transform_timeout

* Activate costmap publishers only after transforms are checked

* Check if controller server activation was succesful in planner_server

* Add unittest for costmap activation

Signed-off-by: Fabian KÃ¶nig <fabiankoenig@gmail.com>

---------

Signed-off-by: Fabian KÃ¶nig <fabiankoenig@gmail.com>

* Fix class doxygen

* fix minor typos (#3892)

Signed-off-by: Anton Kesy <antonkesy@gmail.com>

* Publish collision points for debug purposes (#3879)

* Rename PushRosNamespace to PushROSNamespace

* Fix min_points checking

* .

* fixes

* add to collision detector

* fix

* fix

* .

* fixes

* add namespace to topic

* fixes

* fix use after free (#3910)

* fix build mppi (#3927)

Signed-off-by: kevin <kevin@floatic.io>
Co-authored-by: kevin <kevin@floatic.io>

* Removing old TODOs

* protect invalid max_velocity min_velocity (#3953)

Co-authored-by: Guillaume Doisy <guillaume@dexory.com>

* protect properly max_accel and max_decel (#3952)

Co-authored-by: Guillaume Doisy <guillaume@dexory.com>

* Fixed links for install and build in README (#3963)

Currently the readme is linking to an invalida page in the docs (404 error).

* adding support for rotate in place cusps (#3934)

* Fix linting error (#3969)

* Fix linting error

* Update regulated_pure_pursuit_controller.cpp

* fix a few outdated comments in smac planners (#3978)

* adding soft realtime prioritization for collision monitor and velocity smoother (#3979)

* adding soft realtime prioritization for collision monitor and velocity smoother

* refactor simple action server to use new utils API

* Update README.md

* Synchronize map size information during map initialization (#4015)

* Update costmap size configuration

This commit updates the costmap_2d.cpp file to fix a bug where the costmap size wasn't appropriately updated. Two new lines of code have been added to ensure the size of the costmap is correctly configured each time it's instantiated.

* Refactor costmap size assignment in Costmap2D class

The code refactor eliminates the direct mutation of the size_x_ and size_y_ attributes in the Costmap2D class. Instead, the class uses the size of cells provided during initialization and calculation from map coordinates for better encapsulation and clarity.

* check width&height params (#4017)

Co-authored-by: GoesM <GoesM@buaa.edu.cn>

* Fix SimpleActionServer nullprt callback (#4025)

* add check before calling completion_callback_

* Fix lint

* footprint checks (#4030)

* footprint checks

Signed-off-by: gg <josho.wallace@gmail.com>

* lint fix

Signed-off-by: gg <josho.wallace@gmail.com>

---------

Signed-off-by: gg <josho.wallace@gmail.com>

* Is path valid doc (#4032)

* docs

Signed-off-by: gg <josho.wallace@gmail.com>

* update

Signed-off-by: gg <josho.wallace@gmail.com>

---------

Signed-off-by: gg <josho.wallace@gmail.com>

* Update vision_opencv's branch for rolling

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* handle dynamically changes in parameters. (#4046)

Signed-off-by: Sebastian Solarte <johan.solarte@kiwibot.com>

* Add inflation_layer_name param (#4047)

Signed-off-by: Renan Salles <renan028@gmail.com>

* missing urdf dep (#4050)

Signed-off-by: Guillaume Doisy <guillaume@dexory.com>
Co-authored-by: Guillaume Doisy <guillaume@dexory.com>

* bump to 1.2.6 for release

---------

Signed-off-by: CihatAltiparmak <cihataltiparmak1@gmail.com>
Signed-off-by: Fabian KÃ¶nig <fabiankoenig@gmail.com>
Signed-off-by: Anton Kesy <antonkesy@gmail.com>
Signed-off-by: kevin <kevin@floatic.io>
Signed-off-by: gg <josho.wallace@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Sebastian Solarte <johan.solarte@kiwibot.com>
Signed-off-by: Renan Salles <renan028@gmail.com>
Signed-off-by: Guillaume Doisy <guillaume@dexory.com>
Co-authored-by: Tony Najjar <tony.najjar@logivations.com>
Co-authored-by: thandal <than@timbrel.org>
Co-authored-by: Anton Kesy <antonkesy@gmail.com>
Co-authored-by: CihatAltiparmak <cihataltiparmak1@gmail.com>
Co-authored-by: Anil Kumar Chavali <44644339+akchobby@users.noreply.github.com>
Co-authored-by: Plaqueoff <44152820+Plaqueoff@users.noreply.github.com>
Co-authored-by: Pekka Myller <pekka.myller@karelics.fi>
Co-authored-by: Fabian KÃ¶nig <fabiankoenig@gmail.com>
Co-authored-by: ì •ì°¬í¬ <60467877+ladianchad@users.noreply.github.com>
Co-authored-by: kevin <kevin@floatic.io>
Co-authored-by: Guillaume Doisy <doisyg@users.noreply.github.com>
Co-authored-by: Guillaume Doisy <guillaume@dexory.com>
Co-authored-by: Abiel Fernandez <empoleom@gmail.com>
Co-authored-by: Michael Ferguson <mfergs7@gmail.com>
Co-authored-by: Hao-Li-Bachelorarbeit <141755843+Hao-Li-Bachelorarbeit@users.noreply.github.com>
Co-authored-by: GoesM <130988564+GoesM@users.noreply.github.com>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: BriceRenaudeau <48433002+BriceRenaudeau@users.noreply.github.com>
Co-authored-by: Joshua Wallace <josho.wallace@gmail.com>
Co-authored-by: Sebastian Solarte <89881453+Sunart24@users.noreply.github.com>
Co-authored-by: Renan Salles <renan028@gmail.com>")[#4063](https://github.com/ros-navigation/navigation2/pull/4063)[)](/ros-navigation/navigation2/commit/57093ecc475afce44869347a5dc0f56c567c3d60 "Iron Sync 4: Jan 23, 2024 (#4063)

* collision_monitor: dynamic polygon and source enable/disable (#3825)

* Rename PushRosNamespace to PushROSNamespace

* Fix min_points checking

* initial

* fix

* fix

* remove unrelated change

* reset

* fix format

* PR fixes

* Add test

* fix comments

* add to params

* publish only if enabled

* Add source dynamic enable/disable

* add enabled param to sources

* fix

* add same to collision detector

* Update README.md: fix typo (#3842)

* Update package.xml

* fix typo (#3850)

* adjust link to point to v3.8 of behavior tree docs (#3851)

BT.CPP_v3 is used, thereby the correct docs should be linked

* Fix bug in nav2_behavior_tree/bt_action_node (#3849)

* Fix bug in nav2_behavior_tree/bt_action_node

* Fixed the bug in halt function inside
  nav2_behavior_tree/plugin/action/bt_action_node.hpp

* Added new case to nav2_behavior_tree/plugin/action/bt_action_node.hpp
  for testing the scenario to cancel

* Refactored existing cases in
  nav2_behavior_tree/plugin/action/bt_action_node.hpp

Signed-off-by: CihatAltiparmak <cihataltiparmak1@gmail.com>

* Fix bug in nav2_behavior_tree/bt_action_node

* Fixed the bug in halt function inside
  nav2_behavior_tree/plugin/action/bt_action_node.hpp

* Added new case to nav2_behavior_tree/plugin/action/bt_action_node.hpp
  for testing the scenario to cancel

* Refactored existing cases in
  nav2_behavior_tree/plugin/action/bt_action_node.hpp

Signed-off-by: CihatAltiparmak <cihataltiparmak1@gmail.com>

---------

Signed-off-by: CihatAltiparmak <cihataltiparmak1@gmail.com>

* Fix action test failure due to rate after Rolling sync API change (#3852)

* Update CMakeLists.txt (#3843)

* add option for sse4 and avs512 (#3853)

* Remove all exit(-1) crash conditions (#3846)

* Update transform_available_condition.cpp

* wrapping all examples of get_plugin_type_param in exceptions and making that throw instead of crash

* some linting

* fix typo

* Update controller.cpp

* Update nav2_params.yaml

* Update nav2_params.yaml

* simplication of lattice_generator.py, fixes #3858 (#3859)

* simplification of equation to compute the max_value/outer edge of the lattice based on number of headings.

* Stop error diagnostics when pausing nav (#3830)

* Added nodestate enum and a variable to keep track of current state of managed nodes.

* Updating state_of_managed_nodes_ when switching states and using it to determine an accurate diagnostics message.

* Fixing bugs.

* Updated/added docstrings.

* Publishing OK status when nodes are unconfigured. Changed if-else chain to switch case.

* Renamed NodeState PAUSED to INACTIVE, state_of_managed_nodes_ to managed_nodes_state_ and replaced system_active_ with an inline method.

* Bugfix.

---------

Co-authored-by: Pekka Myller <pekka.myller@karelics.fi>

* Add a timeout to the wait for transforms step of the costmap activation. (#3866)

* Add a timeout to the wait for transforms step of the costmap activation.

Signed-off-by: Fabian KÃ¶nig <fabiankoenig@gmail.com>

* Rename wait_for_transforms_timeout to initial_transform_timeout

* Activate costmap publishers only after transforms are checked

* Check if controller server activation was succesful in planner_server

* Add unittest for costmap activation

Signed-off-by: Fabian KÃ¶nig <fabiankoenig@gmail.com>

---------

Signed-off-by: Fabian KÃ¶nig <fabiankoenig@gmail.com>

* Fix class doxygen

* fix minor typos (#3892)

Signed-off-by: Anton Kesy <antonkesy@gmail.com>

* Publish collision points for debug purposes (#3879)

* Rename PushRosNamespace to PushROSNamespace

* Fix min_points checking

* .

* fixes

* add to collision detector

* fix

* fix

* .

* fixes

* add namespace to topic

* fixes

* fix use after free (#3910)

* fix build mppi (#3927)

Signed-off-by: kevin <kevin@floatic.io>
Co-authored-by: kevin <kevin@floatic.io>

* Removing old TODOs

* protect invalid max_velocity min_velocity (#3953)

Co-authored-by: Guillaume Doisy <guillaume@dexory.com>

* protect properly max_accel and max_decel (#3952)

Co-authored-by: Guillaume Doisy <guillaume@dexory.com>

* Fixed links for install and build in README (#3963)

Currently the readme is linking to an invalida page in the docs (404 error).

* adding support for rotate in place cusps (#3934)

* Fix linting error (#3969)

* Fix linting error

* Update regulated_pure_pursuit_controller.cpp

* fix a few outdated comments in smac planners (#3978)

* adding soft realtime prioritization for collision monitor and velocity smoother (#3979)

* adding soft realtime prioritization for collision monitor and velocity smoother

* refactor simple action server to use new utils API

* Update README.md

* Synchronize map size information during map initialization (#4015)

* Update costmap size configuration

This commit updates the costmap_2d.cpp file to fix a bug where the costmap size wasn't appropriately updated. Two new lines of code have been added to ensure the size of the costmap is correctly configured each time it's instantiated.

* Refactor costmap size assignment in Costmap2D class

The code refactor eliminates the direct mutation of the size_x_ and size_y_ attributes in the Costmap2D class. Instead, the class uses the size of cells provided during initialization and calculation from map coordinates for better encapsulation and clarity.

* check width&height params (#4017)

Co-authored-by: GoesM <GoesM@buaa.edu.cn>

* Fix SimpleActionServer nullprt callback (#4025)

* add check before calling completion_callback_

* Fix lint

* footprint checks (#4030)

* footprint checks

Signed-off-by: gg <josho.wallace@gmail.com>

* lint fix

Signed-off-by: gg <josho.wallace@gmail.com>

---------

Signed-off-by: gg <josho.wallace@gmail.com>

* Is path valid doc (#4032)

* docs

Signed-off-by: gg <josho.wallace@gmail.com>

* update

Signed-off-by: gg <josho.wallace@gmail.com>

---------

Signed-off-by: gg <josho.wallace@gmail.com>

* Update vision_opencv's branch for rolling

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* handle dynamically changes in parameters. (#4046)

Signed-off-by: Sebastian Solarte <johan.solarte@kiwibot.com>

* Add inflation_layer_name param (#4047)

Signed-off-by: Renan Salles <renan028@gmail.com>

* missing urdf dep (#4050)

Signed-off-by: Guillaume Doisy <guillaume@dexory.com>
Co-authored-by: Guillaume Doisy <guillaume@dexory.com>

* bump to 1.2.6 for release

---------

Signed-off-by: CihatAltiparmak <cihataltiparmak1@gmail.com>
Signed-off-by: Fabian KÃ¶nig <fabiankoenig@gmail.com>
Signed-off-by: Anton Kesy <antonkesy@gmail.com>
Signed-off-by: kevin <kevin@floatic.io>
Signed-off-by: gg <josho.wallace@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Sebastian Solarte <johan.solarte@kiwibot.com>
Signed-off-by: Renan Salles <renan028@gmail.com>
Signed-off-by: Guillaume Doisy <guillaume@dexory.com>
Co-authored-by: Tony Najjar <tony.najjar@logivations.com>
Co-authored-by: thandal <than@timbrel.org>
Co-authored-by: Anton Kesy <antonkesy@gmail.com>
Co-authored-by: CihatAltiparmak <cihataltiparmak1@gmail.com>
Co-authored-by: Anil Kumar Chavali <44644339+akchobby@users.noreply.github.com>
Co-authored-by: Plaqueoff <44152820+Plaqueoff@users.noreply.github.com>
Co-authored-by: Pekka Myller <pekka.myller@karelics.fi>
Co-authored-by: Fabian KÃ¶nig <fabiankoenig@gmail.com>
Co-authored-by: ì •ì°¬í¬ <60467877+ladianchad@users.noreply.github.com>
Co-authored-by: kevin <kevin@floatic.io>
Co-authored-by: Guillaume Doisy <doisyg@users.noreply.github.com>
Co-authored-by: Guillaume Doisy <guillaume@dexory.com>
Co-authored-by: Abiel Fernandez <empoleom@gmail.com>
Co-authored-by: Michael Ferguson <mfergs7@gmail.com>
Co-authored-by: Hao-Li-Bachelorarbeit <141755843+Hao-Li-Bachelorarbeit@users.noreply.github.com>
Co-authored-by: GoesM <130988564+GoesM@users.noreply.github.com>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: BriceRenaudeau <48433002+BriceRenaudeau@users.noreply.github.com>
Co-authored-by: Joshua Wallace <josho.wallace@gmail.com>
Co-authored-by: Sebastian Solarte <89881453+Sunart24@users.noreply.github.com>
Co-authored-by: Renan Salles <renan028@gmail.com>")`
â€¦

`[57093ec](/ros-navigation/navigation2/commit/57093ecc475afce44869347a5dc0f56c567c3d60)`

```
* collision_monitor: dynamic polygon and source enable/disable ([#3825](https://github.com/ros-navigation/navigation2/pull/3825))

* Rename PushRosNamespace to PushROSNamespace

* Fix min_points checking

* initial

* fix

* fix

* remove unrelated change

* reset

* fix format

* PR fixes

* Add test

* fix comments

* add to params

* publish only if enabled

* Add source dynamic enable/disable

* add enabled param to sources

* fix

* add same to collision detector

* Update README.md: fix typo ([#3842](https://github.com/ros-navigation/navigation2/pull/3842))

* Update package.xml

* fix typo ([#3850](https://github.com/ros-navigation/navigation2/pull/3850))

* adjust link to point to v3.8 of behavior tree docs ([#3851](https://github.com/ros-navigation/navigation2/pull/3851))

BT.CPP_v3 is used, thereby the correct docs should be linked

* Fix bug in nav2_behavior_tree/bt_action_node ([#3849](https://github.com/ros-navigation/navigation2/pull/3849))

* Fix bug in nav2_behavior_tree/bt_action_node

* Fixed the bug in halt function inside
  nav2_behavior_tree/plugin/action/bt_action_node.hpp

* Added new case to nav2_behavior_tree/plugin/action/bt_action_node.hpp
  for testing the scenario to cancel

* Refactored existing cases in
  nav2_behavior_tree/plugin/action/bt_action_node.hpp

Signed-off-by: CihatAltiparmak <cihataltiparmak1@gmail.com>

* Fix bug in nav2_behavior_tree/bt_action_node

* Fixed the bug in halt function inside
  nav2_behavior_tree/plugin/action/bt_action_node.hpp

* Added new case to nav2_behavior_tree/plugin/action/bt_action_node.hpp
  for testing the scenario to cancel

* Refactored existing cases in
  nav2_behavior_tree/plugin/action/bt_action_node.hpp

Signed-off-by: CihatAltiparmak <cihataltiparmak1@gmail.com>

---------

Signed-off-by: CihatAltiparmak <cihataltiparmak1@gmail.com>

* Fix action test failure due to rate after Rolling sync API change ([#3852](https://github.com/ros-navigation/navigation2/pull/3852))

* Update CMakeLists.txt ([#3843](https://github.com/ros-navigation/navigation2/pull/3843))

* add option for sse4 and avs512 ([#3853](https://github.com/ros-navigation/navigation2/pull/3853))

* Remove all exit(-1) crash conditions ([#3846](https://github.com/ros-navigation/navigation2/pull/3846))

* Update transform_available_condition.cpp

* wrapping all examples of get_plugin_type_param in exceptions and making that throw instead of crash

* some linting

* fix typo

* Update controller.cpp

* Update nav2_params.yaml

* Update nav2_params.yaml

* simplication of lattice_generator.py, fixes [#3858](https://github.com/ros-navigation/navigation2/issues/3858) ([#3859](https://github.com/ros-navigation/navigation2/pull/3859))

* simplification of equation to compute the max_value/outer edge of the lattice based on number of headings.

* Stop error diagnostics when pausing nav ([#3830](https://github.com/ros-navigation/navigation2/pull/3830))

* Added nodestate enum and a variable to keep track of current state of managed nodes.

* Updating state_of_managed_nodes_ when switching states and using it to determine an accurate diagnostics message.

* Fixing bugs.

* Updated/added docstrings.

* Publishing OK status when nodes are unconfigured. Changed if-else chain to switch case.

* Renamed NodeState PAUSED to INACTIVE, state_of_managed_nodes_ to managed_nodes_state_ and replaced system_active_ with an inline method.

* Bugfix.

---------

Co-authored-by: Pekka Myller <pekka.myller@karelics.fi>

* Add a timeout to the wait for transforms step of the costmap activation. ([#3866](https://github.com/ros-navigation/navigation2/pull/3866))

* Add a timeout to the wait for transforms step of the costmap activation.

Signed-off-by: Fabian KÃ¶nig <fabiankoenig@gmail.com>

* Rename wait_for_transforms_timeout to initial_transform_timeout

* Activate costmap publishers only after transforms are checked

* Check if controller server activation was succesful in planner_server

* Add unittest for costmap activation

Signed-off-by: Fabian KÃ¶nig <fabiankoenig@gmail.com>

---------

Signed-off-by: Fabian KÃ¶nig <fabiankoenig@gmail.com>

* Fix class doxygen

* fix minor typos ([#3892](https://github.com/ros-navigation/navigation2/pull/3892))

Signed-off-by: Anton Kesy <antonkesy@gmail.com>

* Publish collision points for debug purposes ([#3879](https://github.com/ros-navigation/navigation2/pull/3879))

* Rename PushRosNamespace to PushROSNamespace

* Fix min_points checking

* .

* fixes

* add to collision detector

* fix

* fix

* .

* fixes

* add namespace to topic

* fixes

* fix use after free ([#3910](https://github.com/ros-navigation/navigation2/pull/3910))

* fix build mppi ([#3927](https://github.com/ros-navigation/navigation2/pull/3927))

Signed-off-by: kevin <kevin@floatic.io>
Co-authored-by: kevin <kevin@floatic.io>

* Removing old TODOs

* protect invalid max_velocity min_velocity ([#3953](https://github.com/ros-navigation/navigation2/pull/3953))

Co-authored-by: Guillaume Doisy <guillaume@dexory.com>

* protect properly max_accel and max_decel ([#3952](https://github.com/ros-navigation/navigation2/pull/3952))

Co-authored-by: Guillaume Doisy <guillaume@dexory.com>

* Fixed links for install and build in README ([#3963](https://github.com/ros-navigation/navigation2/pull/3963))

Currently the readme is linking to an invalida page in the docs (404 error).

* adding support for rotate in place cusps ([#3934](https://github.com/ros-navigation/navigation2/pull/3934))

* Fix linting error ([#3969](https://github.com/ros-navigation/navigation2/pull/3969))

* Fix linting error

* Update regulated_pure_pursuit_controller.cpp

* fix a few outdated comments in smac planners ([#3978](https://github.com/ros-navigation/navigation2/pull/3978))

* adding soft realtime prioritization for collision monitor and velocity smoother ([#3979](https://github.com/ros-navigation/navigation2/pull/3979))

* adding soft realtime prioritization for collision monitor and velocity smoother

* refactor simple action server to use new utils API

* Update README.md

* Synchronize map size information during map initialization ([#4015](https://github.com/ros-navigation/navigation2/pull/4015))

* Update costmap size configuration

This commit updates the costmap_2d.cpp file to fix a bug where the costmap size wasn't appropriately updated. Two new lines of code have been added to ensure the size of the costmap is correctly configured each time it's instantiated.

* Refactor costmap size assignment in Costmap2D class

The code refactor eliminates the direct mutation of the size_x_ and size_y_ attributes in the Costmap2D class. Instead, the class uses the size of cells provided during initialization and calculation from map coordinates for better encapsulation and clarity.

* check width&height params ([#4017](https://github.com/ros-navigation/navigation2/pull/4017))

Co-authored-by: GoesM <GoesM@buaa.edu.cn>

* Fix SimpleActionServer nullprt callback ([#4025](https://github.com/ros-navigation/navigation2/pull/4025))

* add check before calling completion_callback_

* Fix lint

* footprint checks ([#4030](https://github.com/ros-navigation/navigation2/pull/4030))

* footprint checks

Signed-off-by: gg <josho.wallace@gmail.com>

* lint fix

Signed-off-by: gg <josho.wallace@gmail.com>

---------

Signed-off-by: gg <josho.wallace@gmail.com>

* Is path valid doc ([#4032](https://github.com/ros-navigation/navigation2/pull/4032))

* docs

Signed-off-by: gg <josho.wallace@gmail.com>

* update

Signed-off-by: gg <josho.wallace@gmail.com>

---------

Signed-off-by: gg <josho.wallace@gmail.com>

* Update vision_opencv's branch for rolling

Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>

* handle dynamically changes in parameters. ([#4046](https://github.com/ros-navigation/navigation2/pull/4046))

Signed-off-by: Sebastian Solarte <johan.solarte@kiwibot.com>

* Add inflation_layer_name param ([#4047](https://github.com/ros-navigation/navigation2/pull/4047))

Signed-off-by: Renan Salles <renan028@gmail.com>

* missing urdf dep ([#4050](https://github.com/ros-navigation/navigation2/pull/4050))

Signed-off-by: Guillaume Doisy <guillaume@dexory.com>
Co-authored-by: Guillaume Doisy <guillaume@dexory.com>

* bump to 1.2.6 for release

---------

Signed-off-by: CihatAltiparmak <cihataltiparmak1@gmail.com>
Signed-off-by: Fabian KÃ¶nig <fabiankoenig@gmail.com>
Signed-off-by: Anton Kesy <antonkesy@gmail.com>
Signed-off-by: kevin <kevin@floatic.io>
Signed-off-by: gg <josho.wallace@gmail.com>
Signed-off-by: Steve Macenski <stevenmacenski@gmail.com>
Signed-off-by: Sebastian Solarte <johan.solarte@kiwibot.com>
Signed-off-by: Renan Salles <renan028@gmail.com>
Signed-off-by: Guillaume Doisy <guillaume@dexory.com>
Co-authored-by: Tony Najjar <tony.najjar@logivations.com>
Co-authored-by: thandal <than@timbrel.org>
Co-authored-by: Anton Kesy <antonkesy@gmail.com>
Co-authored-by: CihatAltiparmak <cihataltiparmak1@gmail.com>
Co-authored-by: Anil Kumar Chavali <44644339+akchobby@users.noreply.github.com>
Co-authored-by: Plaqueoff <44152820+Plaqueoff@users.noreply.github.com>
Co-authored-by: Pekka Myller <pekka.myller@karelics.fi>
Co-authored-by: Fabian KÃ¶nig <fabiankoenig@gmail.com>
Co-authored-by: ì •ì°¬í¬ <60467877+ladianchad@users.noreply.github.com>
Co-authored-by: kevin <kevin@floatic.io>
Co-authored-by: Guillaume Doisy <doisyg@users.noreply.github.com>
Co-authored-by: Guillaume Doisy <guillaume@dexory.com>
Co-authored-by: Abiel Fernandez <empoleom@gmail.com>
Co-authored-by: Michael Ferguson <mfergs7@gmail.com>
Co-authored-by: Hao-Li-Bachelorarbeit <141755843+Hao-Li-Bachelorarbeit@users.noreply.github.com>
Co-authored-by: GoesM <130988564+GoesM@users.noreply.github.com>
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Co-authored-by: BriceRenaudeau <48433002+BriceRenaudeau@users.noreply.github.com>
Co-authored-by: Joshua Wallace <josho.wallace@gmail.com>
Co-authored-by: Sebastian Solarte <89881453+Sunart24@users.noreply.github.com>
Co-authored-by: Renan Salles <renan028@gmail.com>
```

[enricosutera](/enricosutera)
pushed a commit
to enricosutera/navigation2
that referenced
this pull request
[May 19, 2024](#ref-commit-c64645a)
[![@GoesM](https://avatars.githubusercontent.com/u/130988564?s=40&u=7ca190cae5cd403a5e12a7648f358242d312e465&v=4)](/GoesM) [![@enricosutera](https://avatars.githubusercontent.com/u/51802424?s=40&v=4)](/enricosutera)

`[check width&height params (](/enricosutera/navigation2/commit/c64645a2a86d85d22095e012dbb7a52897f6e7ee "check width&height params (#4017)

Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: enricosutera <enricosutera@outlook.com>")[ros-navigation#4017](https://github.com/ros-navigation/navigation2/pull/4017)[)](/enricosutera/navigation2/commit/c64645a2a86d85d22095e012dbb7a52897f6e7ee "check width&height params (#4017)

Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: enricosutera <enricosutera@outlook.com>")`
â€¦

`[c64645a](/enricosutera/navigation2/commit/c64645a2a86d85d22095e012dbb7a52897f6e7ee)`

```
Co-authored-by: GoesM <GoesM@buaa.edu.cn>
Signed-off-by: enricosutera <enricosutera@outlook.com>
```

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fros-navigation%2Fnavigation2%2Fpull%2F4017)

Reviewers

[![@SteveMacenski](https://avatars.githubusercontent.com/u/14944147?s=40&v=4)](/SteveMacenski) [SteveMacenski](/SteveMacenski)

SteveMacenski approved these changes

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

Successfully merging this pull request may close these issues.

2 participants

[![@GoesM](https://avatars.githubusercontent.com/u/130988564?s=52&v=4)](/GoesM) [![@SteveMacenski](https://avatars.githubusercontent.com/u/14944147?s=52&v=4)](/SteveMacenski)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

Â© 2025 GitHub,Â Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You canâ€™t perform that action at this time.


