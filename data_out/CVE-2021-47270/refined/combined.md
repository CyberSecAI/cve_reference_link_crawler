=== Content from git.kernel.org_a5acb142_20250110_140028.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=8cd5f45c1b769e3e9e0f4325dd08b6c3749dc7ee)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=8cd5f45c1b769e3e9e0f4325dd08b6c3749dc7ee)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=8cd5f45c1b769e3e9e0f4325dd08b6c3749dc7ee)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=8cd5f45c1b769e3e9e0f4325dd08b6c3749dc7ee)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Maciej Żenczykowski <maze@google.com> | 2021-06-07 21:41:41 -0700 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2021-06-16 11:53:03 +0200 |
| commit | [8cd5f45c1b769e3e9e0f4325dd08b6c3749dc7ee](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=8cd5f45c1b769e3e9e0f4325dd08b6c3749dc7ee) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=8cd5f45c1b769e3e9e0f4325dd08b6c3749dc7ee)) | |
| tree | [94db51effc334eaaf478fc3076793aecef1d09c7](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=8cd5f45c1b769e3e9e0f4325dd08b6c3749dc7ee) | |
| parent | [29f13b2f28a6ab721aadb126878ed842ce278462](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=29f13b2f28a6ab721aadb126878ed842ce278462) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=8cd5f45c1b769e3e9e0f4325dd08b6c3749dc7ee&id2=29f13b2f28a6ab721aadb126878ed842ce278462)) | |
| download | [linux-8cd5f45c1b769e3e9e0f4325dd08b6c3749dc7ee.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-8cd5f45c1b769e3e9e0f4325dd08b6c3749dc7ee.tar.gz) | |

usb: fix various gadgets null ptr deref on 10gbps cabling.commit 90c4d05780d47e14a50e11a7f17373104cd47d25 upstream.
This avoids a null pointer dereference in
f\_{ecm,eem,hid,loopback,printer,rndis,serial,sourcesink,subset,tcm}
by simply reusing the 5gbps config for 10gbps.
Fixes: eaef50c76057 ("usb: gadget: Update usb\_assign\_descriptors for SuperSpeedPlus")
Cc: Christophe JAILLET <christophe.jaillet@wanadoo.fr>
Cc: Felipe Balbi <balbi@kernel.org>
Cc: Gustavo A. R. Silva <gustavoars@kernel.org>
Cc: Lorenzo Colitti <lorenzo@google.com>
Cc: Martin K. Petersen <martin.petersen@oracle.com>
Cc: Michael R Sweet <msweet@msweet.org>
Cc: Mike Christie <michael.christie@oracle.com>
Cc: Pawel Laszczak <pawell@cadence.com>
Cc: Peter Chen <peter.chen@nxp.com>
Cc: Sudhakar Panneerselvam <sudhakar.panneerselvam@oracle.com>
Cc: Wei Ming Chen <jj251510319013@gmail.com>
Cc: Will McVicker <willmcvicker@google.com>
Cc: Zqiang <qiang.zhang@windriver.com>
Reviewed-By: Lorenzo Colitti <lorenzo@google.com>
Cc: stable <stable@vger.kernel.org>
Signed-off-by: Maciej Żenczykowski <maze@google.com>
Link: [https://lore.kernel.org/r/20210608044141.3898496-1-zenczykowski@gmail.com](https://lore.kernel.org/r/20210608044141.3898496-1-zenczykowski%40gmail.com)
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=8cd5f45c1b769e3e9e0f4325dd08b6c3749dc7ee)

| -rw-r--r-- | [drivers/usb/gadget/function/f\_ecm.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/usb/gadget/function/f_ecm.c?id=8cd5f45c1b769e3e9e0f4325dd08b6c3749dc7ee) | 2 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |
| -rw-r--r-- | [drivers/usb/gadget/function/f\_eem.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/usb/gadget/function/f_eem.c?id=8cd5f45c1b769e3e9e0f4325dd08b6c3749dc7ee) | 2 | |  |  |  | | --- | --- | --- | |
| -rw-r--r-- | [drivers/usb/gadget/function/f\_hid.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/usb/gadget/function/f_hid.c?id=8cd5f45c1b769e3e9e0f4325dd08b6c3749dc7ee) | 3 | |  |  |  | | --- | --- | --- | |
| -rw-r--r-- | [drivers/usb/gadget/function/f\_loopback.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/usb/gadget/function/f_loopback.c?id=8cd5f45c1b769e3e9e0f4325dd08b6c3749dc7ee) | 2 | |  |  |  | | --- | --- | --- | |
| -rw-r--r-- | [drivers/usb/gadget/function/f\_printer.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/usb/gadget/function/f_printer.c?id=8cd5f45c1b769e3e9e0f4325dd08b6c3749dc7ee) | 3 | |  |  |  | | --- | --- | --- | |
| -rw-r--r-- | [drivers/usb/gadget/function/f\_rndis.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/usb/gadget/function/f_rndis.c?id=8cd5f45c1b769e3e9e0f4325dd08b6c3749dc7ee) | 2 | |  |  |  | | --- | --- | --- | |
| -rw-r--r-- | [drivers/usb/gadget/function/f\_serial.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/usb/gadget/function/f_serial.c?id=8cd5f45c1b769e3e9e0f4325dd08b6c3749dc7ee) | 2 | |  |  |  | | --- | --- | --- | |
| -rw-r--r-- | [drivers/usb/gadget/function/f\_sourcesink.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/usb/gadget/function/f_sourcesink.c?id=8cd5f45c1b769e3e9e0f4325dd08b6c3749dc7ee) | 3 | |  |  |  | | --- | --- | --- | |
| -rw-r--r-- | [drivers/usb/gadget/function/f\_subset.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/usb/gadget/function/f_subset.c?id=8cd5f45c1b769e3e9e0f4325dd08b6c3749dc7ee) | 2 | |  |  |  | | --- | --- | --- | |
| -rw-r--r-- | [drivers/usb/gadget/function/f\_tcm.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/usb/gadget/function/f_tcm.c?id=8cd5f45c1b769e3e9e0f4325dd08b6c3749dc7ee) | 3 | |  |  |  | | --- | --- | --- | |

10 files changed, 14 insertions, 10 deletions

| diff --git a/drivers/usb/gadget/function/f\_ecm.c b/drivers/usb/gadget/function/f\_ecm.cindex 8e3e443827854b..5bd80cb3635ce7 100644--- a/[drivers/usb/gadget/function/f\_ecm.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/usb/gadget/function/f_ecm.c?id=29f13b2f28a6ab721aadb126878ed842ce278462)+++ b/[drivers/usb/gadget/function/f\_ecm.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/usb/gadget/function/f_ecm.c?id=8cd5f45c1b769e3e9e0f4325dd08b6c3749dc7ee)@@ -793,7 +793,7 @@ ecm\_bind(struct usb\_configuration \*c, struct usb\_function \*f) fs\_ecm\_notify\_desc.bEndpointAddress;  status = usb\_assign\_descriptors(f, ecm\_fs\_function, ecm\_hs\_function,- ecm\_ss\_function, NULL);+ ecm\_ss\_function, ecm\_ss\_function); if (status) goto fail; diff --git a/drivers/usb/gadget/function/f\_eem.c b/drivers/usb/gadget/function/f\_eem.cindex 937038d3c97243..5abc27f12a418e 100644--- a/[drivers/usb/gadget/function/f\_eem.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/usb/gadget/function/f_eem.c?id=29f13b2f28a6ab721aadb126878ed842ce278462)+++ b/[drivers/usb/gadget/function/f\_eem.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/usb/gadget/function/f_eem.c?id=8cd5f45c1b769e3e9e0f4325dd08b6c3749dc7ee)@@ -309,7 +309,7 @@ static int eem\_bind(struct usb\_configuration \*c, struct usb\_function \*f) eem\_ss\_out\_desc.bEndpointAddress = eem\_fs\_out\_desc.bEndpointAddress;  status = usb\_assign\_descriptors(f, eem\_fs\_function, eem\_hs\_function,- eem\_ss\_function, NULL);+ eem\_ss\_function, eem\_ss\_function); if (status) goto fail; diff --git a/drivers/usb/gadget/function/f\_hid.c b/drivers/usb/gadget/function/f\_hid.cindex 63f6e344d5b01d..77d1183775efc6 100644--- a/[drivers/usb/gadget/function/f\_hid.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/usb/gadget/function/f_hid.c?id=29f13b2f28a6ab721aadb126878ed842ce278462)+++ b/[drivers/usb/gadget/function/f\_hid.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/usb/gadget/function/f_hid.c?id=8cd5f45c1b769e3e9e0f4325dd08b6c3749dc7ee)@@ -812,7 +812,8 @@ static int hidg\_bind(struct usb\_configuration \*c, struct usb\_function \*f) hidg\_fs\_out\_ep\_desc.bEndpointAddress;  status = usb\_assign\_descriptors(f, hidg\_fs\_descriptors,- hidg\_hs\_descriptors, hidg\_ss\_descriptors, NULL);+ hidg\_hs\_descriptors, hidg\_ss\_descriptors,+ hidg\_ss\_descriptors); if (status) goto fail; diff --git a/drivers/usb/gadget/function/f\_loopback.c b/drivers/usb/gadget/function/f\_loopback.cindex e70093835e14a2..8c1810d655983c 100644--- a/[drivers/usb/gadget/function/f\_loopback.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/usb/gadget/function/f_loopback.c?id=29f13b2f28a6ab721aadb126878ed842ce278462)+++ b/[drivers/usb/gadget/function/f\_loopback.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/usb/gadget/function/f_loopback.c?id=8cd5f45c1b769e3e9e0f4325dd08b6c3749dc7ee)@@ -211,7 +211,7 @@ autoconf\_fail: ss\_loop\_sink\_desc.bEndpointAddress = fs\_loop\_sink\_desc.bEndpointAddress;  ret = usb\_assign\_descriptors(f, fs\_loopback\_descs, hs\_loopback\_descs,- ss\_loopback\_descs, NULL);+ ss\_loopback\_descs, ss\_loopback\_descs); if (ret) return ret; diff --git a/drivers/usb/gadget/function/f\_printer.c b/drivers/usb/gadget/function/f\_printer.cindex fd2409d102d0e8..4e0afeabe8b8bd 100644--- a/[drivers/usb/gadget/function/f\_printer.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/usb/gadget/function/f_printer.c?id=29f13b2f28a6ab721aadb126878ed842ce278462)+++ b/[drivers/usb/gadget/function/f\_printer.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/usb/gadget/function/f_printer.c?id=8cd5f45c1b769e3e9e0f4325dd08b6c3749dc7ee)@@ -1067,7 +1067,8 @@ autoconf\_fail: ss\_ep\_out\_desc.bEndpointAddress = fs\_ep\_out\_desc.bEndpointAddress;  ret = usb\_assign\_descriptors(f, fs\_printer\_function,- hs\_printer\_function, ss\_printer\_function, NULL);+ hs\_printer\_function, ss\_printer\_function,+ ss\_printer\_function); if (ret) return ret; diff --git a/drivers/usb/gadget/function/f\_rndis.c b/drivers/usb/gadget/function/f\_rndis.cindex b35c1d27dc52b6..2a43c6395098f3 100644--- a/[drivers/usb/gadget/function/f\_rndis.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/usb/gadget/function/f_rndis.c?id=29f13b2f28a6ab721aadb126878ed842ce278462)+++ b/[drivers/usb/gadget/function/f\_rndis.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/usb/gadget/function/f_rndis.c?id=8cd5f45c1b769e3e9e0f4325dd08b6c3749dc7ee)@@ -793,7 +793,7 @@ rndis\_bind(struct usb\_configuration \*c, struct usb\_function \*f) ss\_notify\_desc.bEndpointAddress = fs\_notify\_desc.bEndpointAddress;  status = usb\_assign\_descriptors(f, eth\_fs\_function, eth\_hs\_function,- eth\_ss\_function, NULL);+ eth\_ss\_function, eth\_ss\_function); if (status) goto fail; diff --git a/drivers/usb/gadget/function/f\_serial.c b/drivers/usb/gadget/function/f\_serial.cindex cb00ada21d9c25..e1efb69c80badf 100644--- a/[drivers/usb/gadget/function/f\_serial.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/usb/gadget/function/f_serial.c?id=29f13b2f28a6ab721aadb126878ed842ce278462)+++ b/[drivers/usb/gadget/function/f\_serial.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/usb/gadget/function/f_serial.c?id=8cd5f45c1b769e3e9e0f4325dd08b6c3749dc7ee)@@ -236,7 +236,7 @@ static int gser\_bind(struct usb\_configuration \*c, struct usb\_function \*f) gser\_ss\_out\_desc.bEndpointAddress = gser\_fs\_out\_desc.bEndpointAddress;  status = usb\_assign\_descriptors(f, gser\_fs\_function, gser\_hs\_function,- gser\_ss\_function, NULL);+ gser\_ss\_function, gser\_ss\_function); if (status) goto fail; dev\_dbg(&cdev->gadget->dev, "generic ttyGS%d: %s speed IN/%s OUT/%s\n",diff --git a/drivers/usb/gadget/function/f\_sourcesink.c b/drivers/usb/gadget/function/f\_sourcesink.cindex 6e9d958004a0db..1c5745f7abea18 100644--- a/[drivers/usb/gadget/function/f\_sourcesink.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/usb/gadget/function/f_sourcesink.c?id=29f13b2f28a6ab721aadb126878ed842ce278462)+++ b/[drivers/usb/gadget/function/f\_sourcesink.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/usb/gadget/function/f_sourcesink.c?id=8cd5f45c1b769e3e9e0f4325dd08b6c3749dc7ee)@@ -435,7 +435,8 @@ no\_iso: ss\_iso\_sink\_desc.bEndpointAddress = fs\_iso\_sink\_desc.bEndpointAddress;  ret = usb\_assign\_descriptors(f, fs\_source\_sink\_descs,- hs\_source\_sink\_descs, ss\_source\_sink\_descs, NULL);+ hs\_source\_sink\_descs, ss\_source\_sink\_descs,+ ss\_source\_sink\_descs); if (ret) return ret; diff --git a/drivers/usb/gadget/function/f\_subset.c b/drivers/usb/gadget/function/f\_subset.cindex 434b983f3b4c24..055bd0706cdd06 100644--- a/[drivers/usb/gadget/function/f\_subset.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/usb/gadget/function/f_subset.c?id=29f13b2f28a6ab721aadb126878ed842ce278462)+++ b/[drivers/usb/gadget/function/f\_subset.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/usb/gadget/function/f_subset.c?id=8cd5f45c1b769e3e9e0f4325dd08b6c3749dc7ee)@@ -362,7 +362,7 @@ geth\_bind(struct usb\_configuration \*c, struct usb\_function \*f) fs\_subset\_out\_desc.bEndpointAddress;  status = usb\_assign\_descriptors(f, fs\_eth\_function, hs\_eth\_function,- ss\_eth\_function, NULL);+ ss\_eth\_function, ss\_eth\_function); if (status) goto fail; diff --git a/drivers/usb/gadget/function/f\_tcm.c b/drivers/usb/gadget/function/f\_tcm.cindex c41d09166a1d6d..864ed249ff8cf4 100644--- a/[drivers/usb/gadget/function/f\_tcm.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/usb/gadget/function/f_tcm.c?id=29f13b2f28a6ab721aadb126878ed842ce278462)+++ b/[drivers/usb/gadget/function/f\_tcm.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/usb/gadget/function/f_tcm.c?id=8cd5f45c1b769e3e9e0f4325dd08b6c3749dc7ee)@@ -2071,7 +2071,8 @@ static int tcm\_bind(struct usb\_configuration \*c, struct usb\_function \*f) uasp\_fs\_cmd\_desc.bEndpointAddress = uasp\_ss\_cmd\_desc.bEndpointAddress;  ret = usb\_assign\_descriptors(f, uasp\_fs\_function\_desc,- uasp\_hs\_function\_desc, uasp\_ss\_function\_desc, NULL);+ uasp\_hs\_function\_desc, uasp\_ss\_function\_desc,+ uasp\_ss\_function\_desc); if (ret) goto ep\_fail; |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-10 13:59:05 +0000



=== Content from git.kernel.org_d7077d82_20250110_140030.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=b4903f7fdc484628d0b8022daf86e2439d3ab4db)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=b4903f7fdc484628d0b8022daf86e2439d3ab4db)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=b4903f7fdc484628d0b8022daf86e2439d3ab4db)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=b4903f7fdc484628d0b8022daf86e2439d3ab4db)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Maciej Żenczykowski <maze@google.com> | 2021-06-07 21:41:41 -0700 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2021-06-16 11:59:43 +0200 |
| commit | [b4903f7fdc484628d0b8022daf86e2439d3ab4db](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=b4903f7fdc484628d0b8022daf86e2439d3ab4db) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=b4903f7fdc484628d0b8022daf86e2439d3ab4db)) | |
| tree | [4e52abd76ea7ab4bb05d27009c44df856d6d6de8](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=b4903f7fdc484628d0b8022daf86e2439d3ab4db) | |
| parent | [191144bcfe3a78b93bc4fd6b960d2bc488575c73](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=191144bcfe3a78b93bc4fd6b960d2bc488575c73) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=b4903f7fdc484628d0b8022daf86e2439d3ab4db&id2=191144bcfe3a78b93bc4fd6b960d2bc488575c73)) | |
| download | [linux-b4903f7fdc484628d0b8022daf86e2439d3ab4db.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-b4903f7fdc484628d0b8022daf86e2439d3ab4db.tar.gz) | |

usb: fix various gadgets null ptr deref on 10gbps cabling.commit 90c4d05780d47e14a50e11a7f17373104cd47d25 upstream.
This avoids a null pointer dereference in
f\_{ecm,eem,hid,loopback,printer,rndis,serial,sourcesink,subset,tcm}
by simply reusing the 5gbps config for 10gbps.
Fixes: eaef50c76057 ("usb: gadget: Update usb\_assign\_descriptors for SuperSpeedPlus")
Cc: Christophe JAILLET <christophe.jaillet@wanadoo.fr>
Cc: Felipe Balbi <balbi@kernel.org>
Cc: Gustavo A. R. Silva <gustavoars@kernel.org>
Cc: Lorenzo Colitti <lorenzo@google.com>
Cc: Martin K. Petersen <martin.petersen@oracle.com>
Cc: Michael R Sweet <msweet@msweet.org>
Cc: Mike Christie <michael.christie@oracle.com>
Cc: Pawel Laszczak <pawell@cadence.com>
Cc: Peter Chen <peter.chen@nxp.com>
Cc: Sudhakar Panneerselvam <sudhakar.panneerselvam@oracle.com>
Cc: Wei Ming Chen <jj251510319013@gmail.com>
Cc: Will McVicker <willmcvicker@google.com>
Cc: Zqiang <qiang.zhang@windriver.com>
Reviewed-By: Lorenzo Colitti <lorenzo@google.com>
Cc: stable <stable@vger.kernel.org>
Signed-off-by: Maciej Żenczykowski <maze@google.com>
Link: [https://lore.kernel.org/r/20210608044141.3898496-1-zenczykowski@gmail.com](https://lore.kernel.org/r/20210608044141.3898496-1-zenczykowski%40gmail.com)
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=b4903f7fdc484628d0b8022daf86e2439d3ab4db)

| -rw-r--r-- | [drivers/usb/gadget/function/f\_ecm.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/usb/gadget/function/f_ecm.c?id=b4903f7fdc484628d0b8022daf86e2439d3ab4db) | 2 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |
| -rw-r--r-- | [drivers/usb/gadget/function/f\_eem.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/usb/gadget/function/f_eem.c?id=b4903f7fdc484628d0b8022daf86e2439d3ab4db) | 2 | |  |  |  | | --- | --- | --- | |
| -rw-r--r-- | [drivers/usb/gadget/function/f\_hid.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/usb/gadget/function/f_hid.c?id=b4903f7fdc484628d0b8022daf86e2439d3ab4db) | 3 | |  |  |  | | --- | --- | --- | |
| -rw-r--r-- | [drivers/usb/gadget/function/f\_loopback.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/usb/gadget/function/f_loopback.c?id=b4903f7fdc484628d0b8022daf86e2439d3ab4db) | 2 | |  |  |  | | --- | --- | --- | |
| -rw-r--r-- | [drivers/usb/gadget/function/f\_printer.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/usb/gadget/function/f_printer.c?id=b4903f7fdc484628d0b8022daf86e2439d3ab4db) | 3 | |  |  |  | | --- | --- | --- | |
| -rw-r--r-- | [drivers/usb/gadget/function/f\_rndis.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/usb/gadget/function/f_rndis.c?id=b4903f7fdc484628d0b8022daf86e2439d3ab4db) | 2 | |  |  |  | | --- | --- | --- | |
| -rw-r--r-- | [drivers/usb/gadget/function/f\_serial.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/usb/gadget/function/f_serial.c?id=b4903f7fdc484628d0b8022daf86e2439d3ab4db) | 2 | |  |  |  | | --- | --- | --- | |
| -rw-r--r-- | [drivers/usb/gadget/function/f\_sourcesink.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/usb/gadget/function/f_sourcesink.c?id=b4903f7fdc484628d0b8022daf86e2439d3ab4db) | 3 | |  |  |  | | --- | --- | --- | |
| -rw-r--r-- | [drivers/usb/gadget/function/f\_subset.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/usb/gadget/function/f_subset.c?id=b4903f7fdc484628d0b8022daf86e2439d3ab4db) | 2 | |  |  |  | | --- | --- | --- | |
| -rw-r--r-- | [drivers/usb/gadget/function/f\_tcm.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/usb/gadget/function/f_tcm.c?id=b4903f7fdc484628d0b8022daf86e2439d3ab4db) | 3 | |  |  |  | | --- | --- | --- | |

10 files changed, 14 insertions, 10 deletions

| diff --git a/drivers/usb/gadget/function/f\_ecm.c b/drivers/usb/gadget/function/f\_ecm.cindex 7f5cf488b2b1ed..ffe2486fce71c9 100644--- a/[drivers/usb/gadget/function/f\_ecm.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/usb/gadget/function/f_ecm.c?id=191144bcfe3a78b93bc4fd6b960d2bc488575c73)+++ b/[drivers/usb/gadget/function/f\_ecm.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/usb/gadget/function/f_ecm.c?id=b4903f7fdc484628d0b8022daf86e2439d3ab4db)@@ -791,7 +791,7 @@ ecm\_bind(struct usb\_configuration \*c, struct usb\_function \*f) fs\_ecm\_notify\_desc.bEndpointAddress;  status = usb\_assign\_descriptors(f, ecm\_fs\_function, ecm\_hs\_function,- ecm\_ss\_function, NULL);+ ecm\_ss\_function, ecm\_ss\_function); if (status) goto fail; diff --git a/drivers/usb/gadget/function/f\_eem.c b/drivers/usb/gadget/function/f\_eem.cindex 0bbbbebae32007..801090de1f7b3e 100644--- a/[drivers/usb/gadget/function/f\_eem.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/usb/gadget/function/f_eem.c?id=191144bcfe3a78b93bc4fd6b960d2bc488575c73)+++ b/[drivers/usb/gadget/function/f\_eem.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/usb/gadget/function/f_eem.c?id=b4903f7fdc484628d0b8022daf86e2439d3ab4db)@@ -304,7 +304,7 @@ static int eem\_bind(struct usb\_configuration \*c, struct usb\_function \*f) eem\_ss\_out\_desc.bEndpointAddress = eem\_fs\_out\_desc.bEndpointAddress;  status = usb\_assign\_descriptors(f, eem\_fs\_function, eem\_hs\_function,- eem\_ss\_function, NULL);+ eem\_ss\_function, eem\_ss\_function); if (status) goto fail; diff --git a/drivers/usb/gadget/function/f\_hid.c b/drivers/usb/gadget/function/f\_hid.cindex f3816a5c861eee..0586229ac83deb 100644--- a/[drivers/usb/gadget/function/f\_hid.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/usb/gadget/function/f_hid.c?id=191144bcfe3a78b93bc4fd6b960d2bc488575c73)+++ b/[drivers/usb/gadget/function/f\_hid.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/usb/gadget/function/f_hid.c?id=b4903f7fdc484628d0b8022daf86e2439d3ab4db)@@ -808,7 +808,8 @@ static int hidg\_bind(struct usb\_configuration \*c, struct usb\_function \*f) hidg\_fs\_out\_ep\_desc.bEndpointAddress;  status = usb\_assign\_descriptors(f, hidg\_fs\_descriptors,- hidg\_hs\_descriptors, hidg\_ss\_descriptors, NULL);+ hidg\_hs\_descriptors, hidg\_ss\_descriptors,+ hidg\_ss\_descriptors); if (status) goto fail; diff --git a/drivers/usb/gadget/function/f\_loopback.c b/drivers/usb/gadget/function/f\_loopback.cindex 1803646b367805..90215a81c178bb 100644--- a/[drivers/usb/gadget/function/f\_loopback.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/usb/gadget/function/f_loopback.c?id=191144bcfe3a78b93bc4fd6b960d2bc488575c73)+++ b/[drivers/usb/gadget/function/f\_loopback.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/usb/gadget/function/f_loopback.c?id=b4903f7fdc484628d0b8022daf86e2439d3ab4db)@@ -207,7 +207,7 @@ autoconf\_fail: ss\_loop\_sink\_desc.bEndpointAddress = fs\_loop\_sink\_desc.bEndpointAddress;  ret = usb\_assign\_descriptors(f, fs\_loopback\_descs, hs\_loopback\_descs,- ss\_loopback\_descs, NULL);+ ss\_loopback\_descs, ss\_loopback\_descs); if (ret) return ret; diff --git a/drivers/usb/gadget/function/f\_printer.c b/drivers/usb/gadget/function/f\_printer.cindex 0f47cd398d60a6..2a1868b2d24cff 100644--- a/[drivers/usb/gadget/function/f\_printer.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/usb/gadget/function/f_printer.c?id=191144bcfe3a78b93bc4fd6b960d2bc488575c73)+++ b/[drivers/usb/gadget/function/f\_printer.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/usb/gadget/function/f_printer.c?id=b4903f7fdc484628d0b8022daf86e2439d3ab4db)@@ -1063,7 +1063,8 @@ autoconf\_fail: ss\_ep\_out\_desc.bEndpointAddress = fs\_ep\_out\_desc.bEndpointAddress;  ret = usb\_assign\_descriptors(f, fs\_printer\_function,- hs\_printer\_function, ss\_printer\_function, NULL);+ hs\_printer\_function, ss\_printer\_function,+ ss\_printer\_function); if (ret) return ret; diff --git a/drivers/usb/gadget/function/f\_rndis.c b/drivers/usb/gadget/function/f\_rndis.cindex cc1ff5b7b60c49..f20c55d42f2193 100644--- a/[drivers/usb/gadget/function/f\_rndis.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/usb/gadget/function/f_rndis.c?id=191144bcfe3a78b93bc4fd6b960d2bc488575c73)+++ b/[drivers/usb/gadget/function/f\_rndis.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/usb/gadget/function/f_rndis.c?id=b4903f7fdc484628d0b8022daf86e2439d3ab4db)@@ -789,7 +789,7 @@ rndis\_bind(struct usb\_configuration \*c, struct usb\_function \*f) ss\_notify\_desc.bEndpointAddress = fs\_notify\_desc.bEndpointAddress;  status = usb\_assign\_descriptors(f, eth\_fs\_function, eth\_hs\_function,- eth\_ss\_function, NULL);+ eth\_ss\_function, eth\_ss\_function); if (status) goto fail; diff --git a/drivers/usb/gadget/function/f\_serial.c b/drivers/usb/gadget/function/f\_serial.cindex c860f30a0ea2bb..6db973d0c252ee 100644--- a/[drivers/usb/gadget/function/f\_serial.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/usb/gadget/function/f_serial.c?id=191144bcfe3a78b93bc4fd6b960d2bc488575c73)+++ b/[drivers/usb/gadget/function/f\_serial.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/usb/gadget/function/f_serial.c?id=b4903f7fdc484628d0b8022daf86e2439d3ab4db)@@ -233,7 +233,7 @@ static int gser\_bind(struct usb\_configuration \*c, struct usb\_function \*f) gser\_ss\_out\_desc.bEndpointAddress = gser\_fs\_out\_desc.bEndpointAddress;  status = usb\_assign\_descriptors(f, gser\_fs\_function, gser\_hs\_function,- gser\_ss\_function, NULL);+ gser\_ss\_function, gser\_ss\_function); if (status) goto fail; dev\_dbg(&cdev->gadget->dev, "generic ttyGS%d: %s speed IN/%s OUT/%s\n",diff --git a/drivers/usb/gadget/function/f\_sourcesink.c b/drivers/usb/gadget/function/f\_sourcesink.cindex ed68a4860b7d87..282737e4609ce8 100644--- a/[drivers/usb/gadget/function/f\_sourcesink.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/usb/gadget/function/f_sourcesink.c?id=191144bcfe3a78b93bc4fd6b960d2bc488575c73)+++ b/[drivers/usb/gadget/function/f\_sourcesink.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/usb/gadget/function/f_sourcesink.c?id=b4903f7fdc484628d0b8022daf86e2439d3ab4db)@@ -431,7 +431,8 @@ no\_iso: ss\_iso\_sink\_desc.bEndpointAddress = fs\_iso\_sink\_desc.bEndpointAddress;  ret = usb\_assign\_descriptors(f, fs\_source\_sink\_descs,- hs\_source\_sink\_descs, ss\_source\_sink\_descs, NULL);+ hs\_source\_sink\_descs, ss\_source\_sink\_descs,+ ss\_source\_sink\_descs); if (ret) return ret; diff --git a/drivers/usb/gadget/function/f\_subset.c b/drivers/usb/gadget/function/f\_subset.cindex 4d945254905d91..51c1cae162d9b0 100644--- a/[drivers/usb/gadget/function/f\_subset.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/usb/gadget/function/f_subset.c?id=191144bcfe3a78b93bc4fd6b960d2bc488575c73)+++ b/[drivers/usb/gadget/function/f\_subset.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/usb/gadget/function/f_subset.c?id=b4903f7fdc484628d0b8022daf86e2439d3ab4db)@@ -358,7 +358,7 @@ geth\_bind(struct usb\_configuration \*c, struct usb\_function \*f) fs\_subset\_out\_desc.bEndpointAddress;  status = usb\_assign\_descriptors(f, fs\_eth\_function, hs\_eth\_function,- ss\_eth\_function, NULL);+ ss\_eth\_function, ss\_eth\_function); if (status) goto fail; diff --git a/drivers/usb/gadget/function/f\_tcm.c b/drivers/usb/gadget/function/f\_tcm.cindex f6d203fec4955b..41a10bcc2efccb 100644--- a/[drivers/usb/gadget/function/f\_tcm.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/usb/gadget/function/f_tcm.c?id=191144bcfe3a78b93bc4fd6b960d2bc488575c73)+++ b/[drivers/usb/gadget/function/f\_tcm.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/usb/gadget/function/f_tcm.c?id=b4903f7fdc484628d0b8022daf86e2439d3ab4db)@@ -2056,7 +2056,8 @@ static int tcm\_bind(struct usb\_configuration \*c, struct usb\_function \*f) uasp\_fs\_cmd\_desc.bEndpointAddress = uasp\_ss\_cmd\_desc.bEndpointAddress;  ret = usb\_assign\_descriptors(f, uasp\_fs\_function\_desc,- uasp\_hs\_function\_desc, uasp\_ss\_function\_desc, NULL);+ uasp\_hs\_function\_desc, uasp\_ss\_function\_desc,+ uasp\_ss\_function\_desc); if (ret) goto ep\_fail; |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-10 13:59:08 +0000



=== Content from git.kernel.org_e890a233_20250110_140029.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=90c4d05780d47e14a50e11a7f17373104cd47d25)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=90c4d05780d47e14a50e11a7f17373104cd47d25)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=90c4d05780d47e14a50e11a7f17373104cd47d25)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=90c4d05780d47e14a50e11a7f17373104cd47d25)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Maciej Żenczykowski <maze@google.com> | 2021-06-07 21:41:41 -0700 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2021-06-09 10:37:13 +0200 |
| commit | [90c4d05780d47e14a50e11a7f17373104cd47d25](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=90c4d05780d47e14a50e11a7f17373104cd47d25) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=90c4d05780d47e14a50e11a7f17373104cd47d25)) | |
| tree | [1c5aad8e27c721421bb570630f8ffeb6868cb213](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=90c4d05780d47e14a50e11a7f17373104cd47d25) | |
| parent | [d1658268e43980c071dbffc3d894f6f6c4b6732a](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=d1658268e43980c071dbffc3d894f6f6c4b6732a) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=90c4d05780d47e14a50e11a7f17373104cd47d25&id2=d1658268e43980c071dbffc3d894f6f6c4b6732a)) | |
| download | [linux-90c4d05780d47e14a50e11a7f17373104cd47d25.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-90c4d05780d47e14a50e11a7f17373104cd47d25.tar.gz) | |

usb: fix various gadgets null ptr deref on 10gbps cabling.This avoids a null pointer dereference in
f\_{ecm,eem,hid,loopback,printer,rndis,serial,sourcesink,subset,tcm}
by simply reusing the 5gbps config for 10gbps.
Fixes: eaef50c76057 ("usb: gadget: Update usb\_assign\_descriptors for SuperSpeedPlus")
Cc: Christophe JAILLET <christophe.jaillet@wanadoo.fr>
Cc: Felipe Balbi <balbi@kernel.org>
Cc: Gustavo A. R. Silva <gustavoars@kernel.org>
Cc: Lorenzo Colitti <lorenzo@google.com>
Cc: Martin K. Petersen <martin.petersen@oracle.com>
Cc: Michael R Sweet <msweet@msweet.org>
Cc: Mike Christie <michael.christie@oracle.com>
Cc: Pawel Laszczak <pawell@cadence.com>
Cc: Peter Chen <peter.chen@nxp.com>
Cc: Sudhakar Panneerselvam <sudhakar.panneerselvam@oracle.com>
Cc: Wei Ming Chen <jj251510319013@gmail.com>
Cc: Will McVicker <willmcvicker@google.com>
Cc: Zqiang <qiang.zhang@windriver.com>
Reviewed-By: Lorenzo Colitti <lorenzo@google.com>
Cc: stable <stable@vger.kernel.org>
Signed-off-by: Maciej Żenczykowski <maze@google.com>
Link: [https://lore.kernel.org/r/20210608044141.3898496-1-zenczykowski@gmail.com](https://lore.kernel.org/r/20210608044141.3898496-1-zenczykowski%40gmail.com)
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=90c4d05780d47e14a50e11a7f17373104cd47d25)

| -rw-r--r-- | [drivers/usb/gadget/function/f\_ecm.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/usb/gadget/function/f_ecm.c?id=90c4d05780d47e14a50e11a7f17373104cd47d25) | 2 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |
| -rw-r--r-- | [drivers/usb/gadget/function/f\_eem.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/usb/gadget/function/f_eem.c?id=90c4d05780d47e14a50e11a7f17373104cd47d25) | 2 | |  |  |  | | --- | --- | --- | |
| -rw-r--r-- | [drivers/usb/gadget/function/f\_hid.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/usb/gadget/function/f_hid.c?id=90c4d05780d47e14a50e11a7f17373104cd47d25) | 3 | |  |  |  | | --- | --- | --- | |
| -rw-r--r-- | [drivers/usb/gadget/function/f\_loopback.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/usb/gadget/function/f_loopback.c?id=90c4d05780d47e14a50e11a7f17373104cd47d25) | 2 | |  |  |  | | --- | --- | --- | |
| -rw-r--r-- | [drivers/usb/gadget/function/f\_printer.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/usb/gadget/function/f_printer.c?id=90c4d05780d47e14a50e11a7f17373104cd47d25) | 3 | |  |  |  | | --- | --- | --- | |
| -rw-r--r-- | [drivers/usb/gadget/function/f\_rndis.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/usb/gadget/function/f_rndis.c?id=90c4d05780d47e14a50e11a7f17373104cd47d25) | 2 | |  |  |  | | --- | --- | --- | |
| -rw-r--r-- | [drivers/usb/gadget/function/f\_serial.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/usb/gadget/function/f_serial.c?id=90c4d05780d47e14a50e11a7f17373104cd47d25) | 2 | |  |  |  | | --- | --- | --- | |
| -rw-r--r-- | [drivers/usb/gadget/function/f\_sourcesink.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/usb/gadget/function/f_sourcesink.c?id=90c4d05780d47e14a50e11a7f17373104cd47d25) | 3 | |  |  |  | | --- | --- | --- | |
| -rw-r--r-- | [drivers/usb/gadget/function/f\_subset.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/usb/gadget/function/f_subset.c?id=90c4d05780d47e14a50e11a7f17373104cd47d25) | 2 | |  |  |  | | --- | --- | --- | |
| -rw-r--r-- | [drivers/usb/gadget/function/f\_tcm.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/usb/gadget/function/f_tcm.c?id=90c4d05780d47e14a50e11a7f17373104cd47d25) | 3 | |  |  |  | | --- | --- | --- | |

10 files changed, 14 insertions, 10 deletions

| diff --git a/drivers/usb/gadget/function/f\_ecm.c b/drivers/usb/gadget/function/f\_ecm.cindex 7f5cf488b2b1ed..ffe2486fce71c9 100644--- a/[drivers/usb/gadget/function/f\_ecm.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/usb/gadget/function/f_ecm.c?id=d1658268e43980c071dbffc3d894f6f6c4b6732a)+++ b/[drivers/usb/gadget/function/f\_ecm.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/usb/gadget/function/f_ecm.c?id=90c4d05780d47e14a50e11a7f17373104cd47d25)@@ -791,7 +791,7 @@ ecm\_bind(struct usb\_configuration \*c, struct usb\_function \*f) fs\_ecm\_notify\_desc.bEndpointAddress;  status = usb\_assign\_descriptors(f, ecm\_fs\_function, ecm\_hs\_function,- ecm\_ss\_function, NULL);+ ecm\_ss\_function, ecm\_ss\_function); if (status) goto fail; diff --git a/drivers/usb/gadget/function/f\_eem.c b/drivers/usb/gadget/function/f\_eem.cindex cfcc4e81fb7765..e6cb38439c411e 100644--- a/[drivers/usb/gadget/function/f\_eem.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/usb/gadget/function/f_eem.c?id=d1658268e43980c071dbffc3d894f6f6c4b6732a)+++ b/[drivers/usb/gadget/function/f\_eem.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/usb/gadget/function/f_eem.c?id=90c4d05780d47e14a50e11a7f17373104cd47d25)@@ -302,7 +302,7 @@ static int eem\_bind(struct usb\_configuration \*c, struct usb\_function \*f) eem\_ss\_out\_desc.bEndpointAddress = eem\_fs\_out\_desc.bEndpointAddress;  status = usb\_assign\_descriptors(f, eem\_fs\_function, eem\_hs\_function,- eem\_ss\_function, NULL);+ eem\_ss\_function, eem\_ss\_function); if (status) goto fail; diff --git a/drivers/usb/gadget/function/f\_hid.c b/drivers/usb/gadget/function/f\_hid.cindex 1125f4715830de..e556993081170f 100644--- a/[drivers/usb/gadget/function/f\_hid.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/usb/gadget/function/f_hid.c?id=d1658268e43980c071dbffc3d894f6f6c4b6732a)+++ b/[drivers/usb/gadget/function/f\_hid.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/usb/gadget/function/f_hid.c?id=90c4d05780d47e14a50e11a7f17373104cd47d25)@@ -802,7 +802,8 @@ static int hidg\_bind(struct usb\_configuration \*c, struct usb\_function \*f) hidg\_fs\_out\_ep\_desc.bEndpointAddress;  status = usb\_assign\_descriptors(f, hidg\_fs\_descriptors,- hidg\_hs\_descriptors, hidg\_ss\_descriptors, NULL);+ hidg\_hs\_descriptors, hidg\_ss\_descriptors,+ hidg\_ss\_descriptors); if (status) goto fail; diff --git a/drivers/usb/gadget/function/f\_loopback.c b/drivers/usb/gadget/function/f\_loopback.cindex b56ad7c3838b86..ae41f556eb752b 100644--- a/[drivers/usb/gadget/function/f\_loopback.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/usb/gadget/function/f_loopback.c?id=d1658268e43980c071dbffc3d894f6f6c4b6732a)+++ b/[drivers/usb/gadget/function/f\_loopback.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/usb/gadget/function/f_loopback.c?id=90c4d05780d47e14a50e11a7f17373104cd47d25)@@ -207,7 +207,7 @@ autoconf\_fail: ss\_loop\_sink\_desc.bEndpointAddress = fs\_loop\_sink\_desc.bEndpointAddress;  ret = usb\_assign\_descriptors(f, fs\_loopback\_descs, hs\_loopback\_descs,- ss\_loopback\_descs, NULL);+ ss\_loopback\_descs, ss\_loopback\_descs); if (ret) return ret; diff --git a/drivers/usb/gadget/function/f\_printer.c b/drivers/usb/gadget/function/f\_printer.cindex f47fdc1fa7f138..59d382fe1bbfc6 100644--- a/[drivers/usb/gadget/function/f\_printer.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/usb/gadget/function/f_printer.c?id=d1658268e43980c071dbffc3d894f6f6c4b6732a)+++ b/[drivers/usb/gadget/function/f\_printer.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/usb/gadget/function/f_printer.c?id=90c4d05780d47e14a50e11a7f17373104cd47d25)@@ -1101,7 +1101,8 @@ autoconf\_fail: ss\_ep\_out\_desc.bEndpointAddress = fs\_ep\_out\_desc.bEndpointAddress;  ret = usb\_assign\_descriptors(f, fs\_printer\_function,- hs\_printer\_function, ss\_printer\_function, NULL);+ hs\_printer\_function, ss\_printer\_function,+ ss\_printer\_function); if (ret) return ret; diff --git a/drivers/usb/gadget/function/f\_rndis.c b/drivers/usb/gadget/function/f\_rndis.cindex 0739b05a0ef7b3..ee95e8f5f9d489 100644--- a/[drivers/usb/gadget/function/f\_rndis.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/usb/gadget/function/f_rndis.c?id=d1658268e43980c071dbffc3d894f6f6c4b6732a)+++ b/[drivers/usb/gadget/function/f\_rndis.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/usb/gadget/function/f_rndis.c?id=90c4d05780d47e14a50e11a7f17373104cd47d25)@@ -789,7 +789,7 @@ rndis\_bind(struct usb\_configuration \*c, struct usb\_function \*f) ss\_notify\_desc.bEndpointAddress = fs\_notify\_desc.bEndpointAddress;  status = usb\_assign\_descriptors(f, eth\_fs\_function, eth\_hs\_function,- eth\_ss\_function, NULL);+ eth\_ss\_function, eth\_ss\_function); if (status) goto fail; diff --git a/drivers/usb/gadget/function/f\_serial.c b/drivers/usb/gadget/function/f\_serial.cindex e6271384635045..1ed8ff0ac2d310 100644--- a/[drivers/usb/gadget/function/f\_serial.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/usb/gadget/function/f_serial.c?id=d1658268e43980c071dbffc3d894f6f6c4b6732a)+++ b/[drivers/usb/gadget/function/f\_serial.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/usb/gadget/function/f_serial.c?id=90c4d05780d47e14a50e11a7f17373104cd47d25)@@ -233,7 +233,7 @@ static int gser\_bind(struct usb\_configuration \*c, struct usb\_function \*f) gser\_ss\_out\_desc.bEndpointAddress = gser\_fs\_out\_desc.bEndpointAddress;  status = usb\_assign\_descriptors(f, gser\_fs\_function, gser\_hs\_function,- gser\_ss\_function, NULL);+ gser\_ss\_function, gser\_ss\_function); if (status) goto fail; dev\_dbg(&cdev->gadget->dev, "generic ttyGS%d: %s speed IN/%s OUT/%s\n",diff --git a/drivers/usb/gadget/function/f\_sourcesink.c b/drivers/usb/gadget/function/f\_sourcesink.cindex 5a201ba7b155bb..1abf08e5164af9 100644--- a/[drivers/usb/gadget/function/f\_sourcesink.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/usb/gadget/function/f_sourcesink.c?id=d1658268e43980c071dbffc3d894f6f6c4b6732a)+++ b/[drivers/usb/gadget/function/f\_sourcesink.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/usb/gadget/function/f_sourcesink.c?id=90c4d05780d47e14a50e11a7f17373104cd47d25)@@ -431,7 +431,8 @@ no\_iso: ss\_iso\_sink\_desc.bEndpointAddress = fs\_iso\_sink\_desc.bEndpointAddress;  ret = usb\_assign\_descriptors(f, fs\_source\_sink\_descs,- hs\_source\_sink\_descs, ss\_source\_sink\_descs, NULL);+ hs\_source\_sink\_descs, ss\_source\_sink\_descs,+ ss\_source\_sink\_descs); if (ret) return ret; diff --git a/drivers/usb/gadget/function/f\_subset.c b/drivers/usb/gadget/function/f\_subset.cindex 4d945254905d91..51c1cae162d9b0 100644--- a/[drivers/usb/gadget/function/f\_subset.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/usb/gadget/function/f_subset.c?id=d1658268e43980c071dbffc3d894f6f6c4b6732a)+++ b/[drivers/usb/gadget/function/f\_subset.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/usb/gadget/function/f_subset.c?id=90c4d05780d47e14a50e11a7f17373104cd47d25)@@ -358,7 +358,7 @@ geth\_bind(struct usb\_configuration \*c, struct usb\_function \*f) fs\_subset\_out\_desc.bEndpointAddress;  status = usb\_assign\_descriptors(f, fs\_eth\_function, hs\_eth\_function,- ss\_eth\_function, NULL);+ ss\_eth\_function, ss\_eth\_function); if (status) goto fail; diff --git a/drivers/usb/gadget/function/f\_tcm.c b/drivers/usb/gadget/function/f\_tcm.cindex 7acb507946e679..de161ee0b1f9b5 100644--- a/[drivers/usb/gadget/function/f\_tcm.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/usb/gadget/function/f_tcm.c?id=d1658268e43980c071dbffc3d894f6f6c4b6732a)+++ b/[drivers/usb/gadget/function/f\_tcm.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/usb/gadget/function/f_tcm.c?id=90c4d05780d47e14a50e11a7f17373104cd47d25)@@ -2057,7 +2057,8 @@ static int tcm\_bind(struct usb\_configuration \*c, struct usb\_function \*f) uasp\_fs\_cmd\_desc.bEndpointAddress = uasp\_ss\_cmd\_desc.bEndpointAddress;  ret = usb\_assign\_descriptors(f, uasp\_fs\_function\_desc,- uasp\_hs\_function\_desc, uasp\_ss\_function\_desc, NULL);+ uasp\_hs\_function\_desc, uasp\_ss\_function\_desc,+ uasp\_ss\_function\_desc); if (ret) goto ep\_fail; |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-10 13:59:06 +0000



=== Content from git.kernel.org_e8ae8786_20250110_140032.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=beb1e67a5ca8d69703c776db9000527f44c0c93c)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=beb1e67a5ca8d69703c776db9000527f44c0c93c)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=beb1e67a5ca8d69703c776db9000527f44c0c93c)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=beb1e67a5ca8d69703c776db9000527f44c0c93c)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Maciej Żenczykowski <maze@google.com> | 2021-06-07 21:41:41 -0700 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2021-06-16 11:36:35 +0200 |
| commit | [beb1e67a5ca8d69703c776db9000527f44c0c93c](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=beb1e67a5ca8d69703c776db9000527f44c0c93c) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=beb1e67a5ca8d69703c776db9000527f44c0c93c)) | |
| tree | [4843ca6f1f6d3e44ab27b4037b148cad64c65726](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=beb1e67a5ca8d69703c776db9000527f44c0c93c) | |
| parent | [1cf7c5a290a23563d1bd30f3643e5ac7857517f5](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=1cf7c5a290a23563d1bd30f3643e5ac7857517f5) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=beb1e67a5ca8d69703c776db9000527f44c0c93c&id2=1cf7c5a290a23563d1bd30f3643e5ac7857517f5)) | |
| download | [linux-beb1e67a5ca8d69703c776db9000527f44c0c93c.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-beb1e67a5ca8d69703c776db9000527f44c0c93c.tar.gz) | |

usb: fix various gadgets null ptr deref on 10gbps cabling.commit 90c4d05780d47e14a50e11a7f17373104cd47d25 upstream.
This avoids a null pointer dereference in
f\_{ecm,eem,hid,loopback,printer,rndis,serial,sourcesink,subset,tcm}
by simply reusing the 5gbps config for 10gbps.
Fixes: eaef50c76057 ("usb: gadget: Update usb\_assign\_descriptors for SuperSpeedPlus")
Cc: Christophe JAILLET <christophe.jaillet@wanadoo.fr>
Cc: Felipe Balbi <balbi@kernel.org>
Cc: Gustavo A. R. Silva <gustavoars@kernel.org>
Cc: Lorenzo Colitti <lorenzo@google.com>
Cc: Martin K. Petersen <martin.petersen@oracle.com>
Cc: Michael R Sweet <msweet@msweet.org>
Cc: Mike Christie <michael.christie@oracle.com>
Cc: Pawel Laszczak <pawell@cadence.com>
Cc: Peter Chen <peter.chen@nxp.com>
Cc: Sudhakar Panneerselvam <sudhakar.panneerselvam@oracle.com>
Cc: Wei Ming Chen <jj251510319013@gmail.com>
Cc: Will McVicker <willmcvicker@google.com>
Cc: Zqiang <qiang.zhang@windriver.com>
Reviewed-By: Lorenzo Colitti <lorenzo@google.com>
Cc: stable <stable@vger.kernel.org>
Signed-off-by: Maciej Żenczykowski <maze@google.com>
Link: [https://lore.kernel.org/r/20210608044141.3898496-1-zenczykowski@gmail.com](https://lore.kernel.org/r/20210608044141.3898496-1-zenczykowski%40gmail.com)
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=beb1e67a5ca8d69703c776db9000527f44c0c93c)

| -rw-r--r-- | [drivers/usb/gadget/function/f\_ecm.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/usb/gadget/function/f_ecm.c?id=beb1e67a5ca8d69703c776db9000527f44c0c93c) | 2 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |
| -rw-r--r-- | [drivers/usb/gadget/function/f\_eem.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/usb/gadget/function/f_eem.c?id=beb1e67a5ca8d69703c776db9000527f44c0c93c) | 2 | |  |  |  | | --- | --- | --- | |
| -rw-r--r-- | [drivers/usb/gadget/function/f\_loopback.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/usb/gadget/function/f_loopback.c?id=beb1e67a5ca8d69703c776db9000527f44c0c93c) | 2 | |  |  |  | | --- | --- | --- | |
| -rw-r--r-- | [drivers/usb/gadget/function/f\_printer.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/usb/gadget/function/f_printer.c?id=beb1e67a5ca8d69703c776db9000527f44c0c93c) | 3 | |  |  |  | | --- | --- | --- | |
| -rw-r--r-- | [drivers/usb/gadget/function/f\_rndis.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/usb/gadget/function/f_rndis.c?id=beb1e67a5ca8d69703c776db9000527f44c0c93c) | 2 | |  |  |  | | --- | --- | --- | |
| -rw-r--r-- | [drivers/usb/gadget/function/f\_serial.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/usb/gadget/function/f_serial.c?id=beb1e67a5ca8d69703c776db9000527f44c0c93c) | 2 | |  |  |  | | --- | --- | --- | |
| -rw-r--r-- | [drivers/usb/gadget/function/f\_sourcesink.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/usb/gadget/function/f_sourcesink.c?id=beb1e67a5ca8d69703c776db9000527f44c0c93c) | 3 | |  |  |  | | --- | --- | --- | |
| -rw-r--r-- | [drivers/usb/gadget/function/f\_subset.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/usb/gadget/function/f_subset.c?id=beb1e67a5ca8d69703c776db9000527f44c0c93c) | 2 | |  |  |  | | --- | --- | --- | |
| -rw-r--r-- | [drivers/usb/gadget/function/f\_tcm.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/usb/gadget/function/f_tcm.c?id=beb1e67a5ca8d69703c776db9000527f44c0c93c) | 3 | |  |  |  | | --- | --- | --- | |

9 files changed, 12 insertions, 9 deletions

| diff --git a/drivers/usb/gadget/function/f\_ecm.c b/drivers/usb/gadget/function/f\_ecm.cindex 8e3e443827854b..5bd80cb3635ce7 100644--- a/[drivers/usb/gadget/function/f\_ecm.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/usb/gadget/function/f_ecm.c?id=1cf7c5a290a23563d1bd30f3643e5ac7857517f5)+++ b/[drivers/usb/gadget/function/f\_ecm.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/usb/gadget/function/f_ecm.c?id=beb1e67a5ca8d69703c776db9000527f44c0c93c)@@ -793,7 +793,7 @@ ecm\_bind(struct usb\_configuration \*c, struct usb\_function \*f) fs\_ecm\_notify\_desc.bEndpointAddress;  status = usb\_assign\_descriptors(f, ecm\_fs\_function, ecm\_hs\_function,- ecm\_ss\_function, NULL);+ ecm\_ss\_function, ecm\_ss\_function); if (status) goto fail; diff --git a/drivers/usb/gadget/function/f\_eem.c b/drivers/usb/gadget/function/f\_eem.cindex 937038d3c97243..5abc27f12a418e 100644--- a/[drivers/usb/gadget/function/f\_eem.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/usb/gadget/function/f_eem.c?id=1cf7c5a290a23563d1bd30f3643e5ac7857517f5)+++ b/[drivers/usb/gadget/function/f\_eem.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/usb/gadget/function/f_eem.c?id=beb1e67a5ca8d69703c776db9000527f44c0c93c)@@ -309,7 +309,7 @@ static int eem\_bind(struct usb\_configuration \*c, struct usb\_function \*f) eem\_ss\_out\_desc.bEndpointAddress = eem\_fs\_out\_desc.bEndpointAddress;  status = usb\_assign\_descriptors(f, eem\_fs\_function, eem\_hs\_function,- eem\_ss\_function, NULL);+ eem\_ss\_function, eem\_ss\_function); if (status) goto fail; diff --git a/drivers/usb/gadget/function/f\_loopback.c b/drivers/usb/gadget/function/f\_loopback.cindex e70093835e14a2..8c1810d655983c 100644--- a/[drivers/usb/gadget/function/f\_loopback.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/usb/gadget/function/f_loopback.c?id=1cf7c5a290a23563d1bd30f3643e5ac7857517f5)+++ b/[drivers/usb/gadget/function/f\_loopback.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/usb/gadget/function/f_loopback.c?id=beb1e67a5ca8d69703c776db9000527f44c0c93c)@@ -211,7 +211,7 @@ autoconf\_fail: ss\_loop\_sink\_desc.bEndpointAddress = fs\_loop\_sink\_desc.bEndpointAddress;  ret = usb\_assign\_descriptors(f, fs\_loopback\_descs, hs\_loopback\_descs,- ss\_loopback\_descs, NULL);+ ss\_loopback\_descs, ss\_loopback\_descs); if (ret) return ret; diff --git a/drivers/usb/gadget/function/f\_printer.c b/drivers/usb/gadget/function/f\_printer.cindex b3d036d06553c4..c347fe13d45ddb 100644--- a/[drivers/usb/gadget/function/f\_printer.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/usb/gadget/function/f_printer.c?id=1cf7c5a290a23563d1bd30f3643e5ac7857517f5)+++ b/[drivers/usb/gadget/function/f\_printer.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/usb/gadget/function/f_printer.c?id=beb1e67a5ca8d69703c776db9000527f44c0c93c)@@ -1057,7 +1057,8 @@ autoconf\_fail: ss\_ep\_out\_desc.bEndpointAddress = fs\_ep\_out\_desc.bEndpointAddress;  ret = usb\_assign\_descriptors(f, fs\_printer\_function,- hs\_printer\_function, ss\_printer\_function, NULL);+ hs\_printer\_function, ss\_printer\_function,+ ss\_printer\_function); if (ret) return ret; diff --git a/drivers/usb/gadget/function/f\_rndis.c b/drivers/usb/gadget/function/f\_rndis.cindex 2f310973155a53..d48b14a3dfa62c 100644--- a/[drivers/usb/gadget/function/f\_rndis.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/usb/gadget/function/f_rndis.c?id=1cf7c5a290a23563d1bd30f3643e5ac7857517f5)+++ b/[drivers/usb/gadget/function/f\_rndis.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/usb/gadget/function/f_rndis.c?id=beb1e67a5ca8d69703c776db9000527f44c0c93c)@@ -789,7 +789,7 @@ rndis\_bind(struct usb\_configuration \*c, struct usb\_function \*f) ss\_notify\_desc.bEndpointAddress = fs\_notify\_desc.bEndpointAddress;  status = usb\_assign\_descriptors(f, eth\_fs\_function, eth\_hs\_function,- eth\_ss\_function, NULL);+ eth\_ss\_function, eth\_ss\_function); if (status) goto fail; diff --git a/drivers/usb/gadget/function/f\_serial.c b/drivers/usb/gadget/function/f\_serial.cindex cb00ada21d9c25..e1efb69c80badf 100644--- a/[drivers/usb/gadget/function/f\_serial.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/usb/gadget/function/f_serial.c?id=1cf7c5a290a23563d1bd30f3643e5ac7857517f5)+++ b/[drivers/usb/gadget/function/f\_serial.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/usb/gadget/function/f_serial.c?id=beb1e67a5ca8d69703c776db9000527f44c0c93c)@@ -236,7 +236,7 @@ static int gser\_bind(struct usb\_configuration \*c, struct usb\_function \*f) gser\_ss\_out\_desc.bEndpointAddress = gser\_fs\_out\_desc.bEndpointAddress;  status = usb\_assign\_descriptors(f, gser\_fs\_function, gser\_hs\_function,- gser\_ss\_function, NULL);+ gser\_ss\_function, gser\_ss\_function); if (status) goto fail; dev\_dbg(&cdev->gadget->dev, "generic ttyGS%d: %s speed IN/%s OUT/%s\n",diff --git a/drivers/usb/gadget/function/f\_sourcesink.c b/drivers/usb/gadget/function/f\_sourcesink.cindex 6e9d958004a0db..1c5745f7abea18 100644--- a/[drivers/usb/gadget/function/f\_sourcesink.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/usb/gadget/function/f_sourcesink.c?id=1cf7c5a290a23563d1bd30f3643e5ac7857517f5)+++ b/[drivers/usb/gadget/function/f\_sourcesink.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/usb/gadget/function/f_sourcesink.c?id=beb1e67a5ca8d69703c776db9000527f44c0c93c)@@ -435,7 +435,8 @@ no\_iso: ss\_iso\_sink\_desc.bEndpointAddress = fs\_iso\_sink\_desc.bEndpointAddress;  ret = usb\_assign\_descriptors(f, fs\_source\_sink\_descs,- hs\_source\_sink\_descs, ss\_source\_sink\_descs, NULL);+ hs\_source\_sink\_descs, ss\_source\_sink\_descs,+ ss\_source\_sink\_descs); if (ret) return ret; diff --git a/drivers/usb/gadget/function/f\_subset.c b/drivers/usb/gadget/function/f\_subset.cindex 434b983f3b4c24..055bd0706cdd06 100644--- a/[drivers/usb/gadget/function/f\_subset.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/usb/gadget/function/f_subset.c?id=1cf7c5a290a23563d1bd30f3643e5ac7857517f5)+++ b/[drivers/usb/gadget/function/f\_subset.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/usb/gadget/function/f_subset.c?id=beb1e67a5ca8d69703c776db9000527f44c0c93c)@@ -362,7 +362,7 @@ geth\_bind(struct usb\_configuration \*c, struct usb\_function \*f) fs\_subset\_out\_desc.bEndpointAddress;  status = usb\_assign\_descriptors(f, fs\_eth\_function, hs\_eth\_function,- ss\_eth\_function, NULL);+ ss\_eth\_function, ss\_eth\_function); if (status) goto fail; diff --git a/drivers/usb/gadget/function/f\_tcm.c b/drivers/usb/gadget/function/f\_tcm.cindex 7e8e262b36297a..821f470c6a2f95 100644--- a/[drivers/usb/gadget/function/f\_tcm.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/usb/gadget/function/f_tcm.c?id=1cf7c5a290a23563d1bd30f3643e5ac7857517f5)+++ b/[drivers/usb/gadget/function/f\_tcm.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/usb/gadget/function/f_tcm.c?id=beb1e67a5ca8d69703c776db9000527f44c0c93c)@@ -2071,7 +2071,8 @@ static int tcm\_bind(struct usb\_configuration \*c, struct usb\_function \*f) uasp\_fs\_cmd\_desc.bEndpointAddress = uasp\_ss\_cmd\_desc.bEndpointAddress;  ret = usb\_assign\_descriptors(f, uasp\_fs\_function\_desc,- uasp\_hs\_function\_desc, uasp\_ss\_function\_desc, NULL);+ uasp\_hs\_function\_desc, uasp\_ss\_function\_desc,+ uasp\_ss\_function\_desc); if (ret) goto ep\_fail; |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-10 13:59:09 +0000



=== Content from git.kernel.org_cb24468e_20250110_140033.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=f17aae7c4009160f0630a91842a281773976a5bc)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=f17aae7c4009160f0630a91842a281773976a5bc)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=f17aae7c4009160f0630a91842a281773976a5bc)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=f17aae7c4009160f0630a91842a281773976a5bc)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Maciej Żenczykowski <maze@google.com> | 2021-06-07 21:41:41 -0700 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2021-06-16 12:05:10 +0200 |
| commit | [f17aae7c4009160f0630a91842a281773976a5bc](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=f17aae7c4009160f0630a91842a281773976a5bc) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=f17aae7c4009160f0630a91842a281773976a5bc)) | |
| tree | [462cbc7a07d2876e1ad9ca7c18c0f4a3ca60a99c](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=f17aae7c4009160f0630a91842a281773976a5bc) | |
| parent | [0ee582bcc78615a95b45a793815909c30ca0d981](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=0ee582bcc78615a95b45a793815909c30ca0d981) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=f17aae7c4009160f0630a91842a281773976a5bc&id2=0ee582bcc78615a95b45a793815909c30ca0d981)) | |
| download | [linux-f17aae7c4009160f0630a91842a281773976a5bc.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-f17aae7c4009160f0630a91842a281773976a5bc.tar.gz) | |

usb: fix various gadgets null ptr deref on 10gbps cabling.commit 90c4d05780d47e14a50e11a7f17373104cd47d25 upstream.
This avoids a null pointer dereference in
f\_{ecm,eem,hid,loopback,printer,rndis,serial,sourcesink,subset,tcm}
by simply reusing the 5gbps config for 10gbps.
Fixes: eaef50c76057 ("usb: gadget: Update usb\_assign\_descriptors for SuperSpeedPlus")
Cc: Christophe JAILLET <christophe.jaillet@wanadoo.fr>
Cc: Felipe Balbi <balbi@kernel.org>
Cc: Gustavo A. R. Silva <gustavoars@kernel.org>
Cc: Lorenzo Colitti <lorenzo@google.com>
Cc: Martin K. Petersen <martin.petersen@oracle.com>
Cc: Michael R Sweet <msweet@msweet.org>
Cc: Mike Christie <michael.christie@oracle.com>
Cc: Pawel Laszczak <pawell@cadence.com>
Cc: Peter Chen <peter.chen@nxp.com>
Cc: Sudhakar Panneerselvam <sudhakar.panneerselvam@oracle.com>
Cc: Wei Ming Chen <jj251510319013@gmail.com>
Cc: Will McVicker <willmcvicker@google.com>
Cc: Zqiang <qiang.zhang@windriver.com>
Reviewed-By: Lorenzo Colitti <lorenzo@google.com>
Cc: stable <stable@vger.kernel.org>
Signed-off-by: Maciej Żenczykowski <maze@google.com>
Link: [https://lore.kernel.org/r/20210608044141.3898496-1-zenczykowski@gmail.com](https://lore.kernel.org/r/20210608044141.3898496-1-zenczykowski%40gmail.com)
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=f17aae7c4009160f0630a91842a281773976a5bc)

| -rw-r--r-- | [drivers/usb/gadget/function/f\_ecm.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/usb/gadget/function/f_ecm.c?id=f17aae7c4009160f0630a91842a281773976a5bc) | 2 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |
| -rw-r--r-- | [drivers/usb/gadget/function/f\_eem.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/usb/gadget/function/f_eem.c?id=f17aae7c4009160f0630a91842a281773976a5bc) | 2 | |  |  |  | | --- | --- | --- | |
| -rw-r--r-- | [drivers/usb/gadget/function/f\_hid.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/usb/gadget/function/f_hid.c?id=f17aae7c4009160f0630a91842a281773976a5bc) | 3 | |  |  |  | | --- | --- | --- | |
| -rw-r--r-- | [drivers/usb/gadget/function/f\_loopback.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/usb/gadget/function/f_loopback.c?id=f17aae7c4009160f0630a91842a281773976a5bc) | 2 | |  |  |  | | --- | --- | --- | |
| -rw-r--r-- | [drivers/usb/gadget/function/f\_printer.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/usb/gadget/function/f_printer.c?id=f17aae7c4009160f0630a91842a281773976a5bc) | 3 | |  |  |  | | --- | --- | --- | |
| -rw-r--r-- | [drivers/usb/gadget/function/f\_rndis.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/usb/gadget/function/f_rndis.c?id=f17aae7c4009160f0630a91842a281773976a5bc) | 2 | |  |  |  | | --- | --- | --- | |
| -rw-r--r-- | [drivers/usb/gadget/function/f\_serial.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/usb/gadget/function/f_serial.c?id=f17aae7c4009160f0630a91842a281773976a5bc) | 2 | |  |  |  | | --- | --- | --- | |
| -rw-r--r-- | [drivers/usb/gadget/function/f\_sourcesink.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/usb/gadget/function/f_sourcesink.c?id=f17aae7c4009160f0630a91842a281773976a5bc) | 3 | |  |  |  | | --- | --- | --- | |
| -rw-r--r-- | [drivers/usb/gadget/function/f\_subset.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/usb/gadget/function/f_subset.c?id=f17aae7c4009160f0630a91842a281773976a5bc) | 2 | |  |  |  | | --- | --- | --- | |
| -rw-r--r-- | [drivers/usb/gadget/function/f\_tcm.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/usb/gadget/function/f_tcm.c?id=f17aae7c4009160f0630a91842a281773976a5bc) | 3 | |  |  |  | | --- | --- | --- | |

10 files changed, 14 insertions, 10 deletions

| diff --git a/drivers/usb/gadget/function/f\_ecm.c b/drivers/usb/gadget/function/f\_ecm.cindex 7f5cf488b2b1ed..ffe2486fce71c9 100644--- a/[drivers/usb/gadget/function/f\_ecm.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/usb/gadget/function/f_ecm.c?id=0ee582bcc78615a95b45a793815909c30ca0d981)+++ b/[drivers/usb/gadget/function/f\_ecm.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/usb/gadget/function/f_ecm.c?id=f17aae7c4009160f0630a91842a281773976a5bc)@@ -791,7 +791,7 @@ ecm\_bind(struct usb\_configuration \*c, struct usb\_function \*f) fs\_ecm\_notify\_desc.bEndpointAddress;  status = usb\_assign\_descriptors(f, ecm\_fs\_function, ecm\_hs\_function,- ecm\_ss\_function, NULL);+ ecm\_ss\_function, ecm\_ss\_function); if (status) goto fail; diff --git a/drivers/usb/gadget/function/f\_eem.c b/drivers/usb/gadget/function/f\_eem.cindex 28dd5f1fd10613..2cd9942707b46a 100644--- a/[drivers/usb/gadget/function/f\_eem.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/usb/gadget/function/f_eem.c?id=0ee582bcc78615a95b45a793815909c30ca0d981)+++ b/[drivers/usb/gadget/function/f\_eem.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/usb/gadget/function/f_eem.c?id=f17aae7c4009160f0630a91842a281773976a5bc)@@ -302,7 +302,7 @@ static int eem\_bind(struct usb\_configuration \*c, struct usb\_function \*f) eem\_ss\_out\_desc.bEndpointAddress = eem\_fs\_out\_desc.bEndpointAddress;  status = usb\_assign\_descriptors(f, eem\_fs\_function, eem\_hs\_function,- eem\_ss\_function, NULL);+ eem\_ss\_function, eem\_ss\_function); if (status) goto fail; diff --git a/drivers/usb/gadget/function/f\_hid.c b/drivers/usb/gadget/function/f\_hid.cindex 1125f4715830de..e556993081170f 100644--- a/[drivers/usb/gadget/function/f\_hid.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/usb/gadget/function/f_hid.c?id=0ee582bcc78615a95b45a793815909c30ca0d981)+++ b/[drivers/usb/gadget/function/f\_hid.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/usb/gadget/function/f_hid.c?id=f17aae7c4009160f0630a91842a281773976a5bc)@@ -802,7 +802,8 @@ static int hidg\_bind(struct usb\_configuration \*c, struct usb\_function \*f) hidg\_fs\_out\_ep\_desc.bEndpointAddress;  status = usb\_assign\_descriptors(f, hidg\_fs\_descriptors,- hidg\_hs\_descriptors, hidg\_ss\_descriptors, NULL);+ hidg\_hs\_descriptors, hidg\_ss\_descriptors,+ hidg\_ss\_descriptors); if (status) goto fail; diff --git a/drivers/usb/gadget/function/f\_loopback.c b/drivers/usb/gadget/function/f\_loopback.cindex b56ad7c3838b86..ae41f556eb752b 100644--- a/[drivers/usb/gadget/function/f\_loopback.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/usb/gadget/function/f_loopback.c?id=0ee582bcc78615a95b45a793815909c30ca0d981)+++ b/[drivers/usb/gadget/function/f\_loopback.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/usb/gadget/function/f_loopback.c?id=f17aae7c4009160f0630a91842a281773976a5bc)@@ -207,7 +207,7 @@ autoconf\_fail: ss\_loop\_sink\_desc.bEndpointAddress = fs\_loop\_sink\_desc.bEndpointAddress;  ret = usb\_assign\_descriptors(f, fs\_loopback\_descs, hs\_loopback\_descs,- ss\_loopback\_descs, NULL);+ ss\_loopback\_descs, ss\_loopback\_descs); if (ret) return ret; diff --git a/drivers/usb/gadget/function/f\_printer.c b/drivers/usb/gadget/function/f\_printer.cindex 61ce8e68f7a304..61bbf27b520374 100644--- a/[drivers/usb/gadget/function/f\_printer.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/usb/gadget/function/f_printer.c?id=0ee582bcc78615a95b45a793815909c30ca0d981)+++ b/[drivers/usb/gadget/function/f\_printer.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/usb/gadget/function/f_printer.c?id=f17aae7c4009160f0630a91842a281773976a5bc)@@ -1101,7 +1101,8 @@ autoconf\_fail: ss\_ep\_out\_desc.bEndpointAddress = fs\_ep\_out\_desc.bEndpointAddress;  ret = usb\_assign\_descriptors(f, fs\_printer\_function,- hs\_printer\_function, ss\_printer\_function, NULL);+ hs\_printer\_function, ss\_printer\_function,+ ss\_printer\_function); if (ret) return ret; diff --git a/drivers/usb/gadget/function/f\_rndis.c b/drivers/usb/gadget/function/f\_rndis.cindex 0739b05a0ef7b3..ee95e8f5f9d489 100644--- a/[drivers/usb/gadget/function/f\_rndis.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/usb/gadget/function/f_rndis.c?id=0ee582bcc78615a95b45a793815909c30ca0d981)+++ b/[drivers/usb/gadget/function/f\_rndis.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/usb/gadget/function/f_rndis.c?id=f17aae7c4009160f0630a91842a281773976a5bc)@@ -789,7 +789,7 @@ rndis\_bind(struct usb\_configuration \*c, struct usb\_function \*f) ss\_notify\_desc.bEndpointAddress = fs\_notify\_desc.bEndpointAddress;  status = usb\_assign\_descriptors(f, eth\_fs\_function, eth\_hs\_function,- eth\_ss\_function, NULL);+ eth\_ss\_function, eth\_ss\_function); if (status) goto fail; diff --git a/drivers/usb/gadget/function/f\_serial.c b/drivers/usb/gadget/function/f\_serial.cindex e6271384635045..1ed8ff0ac2d310 100644--- a/[drivers/usb/gadget/function/f\_serial.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/usb/gadget/function/f_serial.c?id=0ee582bcc78615a95b45a793815909c30ca0d981)+++ b/[drivers/usb/gadget/function/f\_serial.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/usb/gadget/function/f_serial.c?id=f17aae7c4009160f0630a91842a281773976a5bc)@@ -233,7 +233,7 @@ static int gser\_bind(struct usb\_configuration \*c, struct usb\_function \*f) gser\_ss\_out\_desc.bEndpointAddress = gser\_fs\_out\_desc.bEndpointAddress;  status = usb\_assign\_descriptors(f, gser\_fs\_function, gser\_hs\_function,- gser\_ss\_function, NULL);+ gser\_ss\_function, gser\_ss\_function); if (status) goto fail; dev\_dbg(&cdev->gadget->dev, "generic ttyGS%d: %s speed IN/%s OUT/%s\n",diff --git a/drivers/usb/gadget/function/f\_sourcesink.c b/drivers/usb/gadget/function/f\_sourcesink.cindex 5a201ba7b155bb..1abf08e5164af9 100644--- a/[drivers/usb/gadget/function/f\_sourcesink.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/usb/gadget/function/f_sourcesink.c?id=0ee582bcc78615a95b45a793815909c30ca0d981)+++ b/[drivers/usb/gadget/function/f\_sourcesink.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/usb/gadget/function/f_sourcesink.c?id=f17aae7c4009160f0630a91842a281773976a5bc)@@ -431,7 +431,8 @@ no\_iso: ss\_iso\_sink\_desc.bEndpointAddress = fs\_iso\_sink\_desc.bEndpointAddress;  ret = usb\_assign\_descriptors(f, fs\_source\_sink\_descs,- hs\_source\_sink\_descs, ss\_source\_sink\_descs, NULL);+ hs\_source\_sink\_descs, ss\_source\_sink\_descs,+ ss\_source\_sink\_descs); if (ret) return ret; diff --git a/drivers/usb/gadget/function/f\_subset.c b/drivers/usb/gadget/function/f\_subset.cindex 4d945254905d91..51c1cae162d9b0 100644--- a/[drivers/usb/gadget/function/f\_subset.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/usb/gadget/function/f_subset.c?id=0ee582bcc78615a95b45a793815909c30ca0d981)+++ b/[drivers/usb/gadget/function/f\_subset.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/usb/gadget/function/f_subset.c?id=f17aae7c4009160f0630a91842a281773976a5bc)@@ -358,7 +358,7 @@ geth\_bind(struct usb\_configuration \*c, struct usb\_function \*f) fs\_subset\_out\_desc.bEndpointAddress;  status = usb\_assign\_descriptors(f, fs\_eth\_function, hs\_eth\_function,- ss\_eth\_function, NULL);+ ss\_eth\_function, ss\_eth\_function); if (status) goto fail; diff --git a/drivers/usb/gadget/function/f\_tcm.c b/drivers/usb/gadget/function/f\_tcm.cindex 410fa89eae8f65..5a2e9ce2bc352e 100644--- a/[drivers/usb/gadget/function/f\_tcm.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/usb/gadget/function/f_tcm.c?id=0ee582bcc78615a95b45a793815909c30ca0d981)+++ b/[drivers/usb/gadget/function/f\_tcm.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/usb/gadget/function/f_tcm.c?id=f17aae7c4009160f0630a91842a281773976a5bc)@@ -2061,7 +2061,8 @@ static int tcm\_bind(struct usb\_configuration \*c, struct usb\_function \*f) uasp\_fs\_cmd\_desc.bEndpointAddress = uasp\_ss\_cmd\_desc.bEndpointAddress;  ret = usb\_assign\_descriptors(f, uasp\_fs\_function\_desc,- uasp\_hs\_function\_desc, uasp\_ss\_function\_desc, NULL);+ uasp\_hs\_function\_desc, uasp\_ss\_function\_desc,+ uasp\_ss\_function\_desc); if (ret) goto ep\_fail; |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-10 13:59:11 +0000



=== Content from git.kernel.org_77c6def5_20250110_140025.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=10770d2ac0094b053c8897d96d7b2737cd72f7c5)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=10770d2ac0094b053c8897d96d7b2737cd72f7c5)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=10770d2ac0094b053c8897d96d7b2737cd72f7c5)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=10770d2ac0094b053c8897d96d7b2737cd72f7c5)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Maciej Żenczykowski <maze@google.com> | 2021-06-07 21:41:41 -0700 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2021-06-16 11:55:00 +0200 |
| commit | [10770d2ac0094b053c8897d96d7b2737cd72f7c5](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=10770d2ac0094b053c8897d96d7b2737cd72f7c5) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=10770d2ac0094b053c8897d96d7b2737cd72f7c5)) | |
| tree | [0955205a3485d1833b3b655d47b0fd688df4c0b4](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=10770d2ac0094b053c8897d96d7b2737cd72f7c5) | |
| parent | [e76cb5c8837d213a90899f6aff53e3ab57c442f1](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=e76cb5c8837d213a90899f6aff53e3ab57c442f1) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=10770d2ac0094b053c8897d96d7b2737cd72f7c5&id2=e76cb5c8837d213a90899f6aff53e3ab57c442f1)) | |
| download | [linux-10770d2ac0094b053c8897d96d7b2737cd72f7c5.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-10770d2ac0094b053c8897d96d7b2737cd72f7c5.tar.gz) | |

usb: fix various gadgets null ptr deref on 10gbps cabling.commit 90c4d05780d47e14a50e11a7f17373104cd47d25 upstream.
This avoids a null pointer dereference in
f\_{ecm,eem,hid,loopback,printer,rndis,serial,sourcesink,subset,tcm}
by simply reusing the 5gbps config for 10gbps.
Fixes: eaef50c76057 ("usb: gadget: Update usb\_assign\_descriptors for SuperSpeedPlus")
Cc: Christophe JAILLET <christophe.jaillet@wanadoo.fr>
Cc: Felipe Balbi <balbi@kernel.org>
Cc: Gustavo A. R. Silva <gustavoars@kernel.org>
Cc: Lorenzo Colitti <lorenzo@google.com>
Cc: Martin K. Petersen <martin.petersen@oracle.com>
Cc: Michael R Sweet <msweet@msweet.org>
Cc: Mike Christie <michael.christie@oracle.com>
Cc: Pawel Laszczak <pawell@cadence.com>
Cc: Peter Chen <peter.chen@nxp.com>
Cc: Sudhakar Panneerselvam <sudhakar.panneerselvam@oracle.com>
Cc: Wei Ming Chen <jj251510319013@gmail.com>
Cc: Will McVicker <willmcvicker@google.com>
Cc: Zqiang <qiang.zhang@windriver.com>
Reviewed-By: Lorenzo Colitti <lorenzo@google.com>
Cc: stable <stable@vger.kernel.org>
Signed-off-by: Maciej Żenczykowski <maze@google.com>
Link: [https://lore.kernel.org/r/20210608044141.3898496-1-zenczykowski@gmail.com](https://lore.kernel.org/r/20210608044141.3898496-1-zenczykowski%40gmail.com)
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=10770d2ac0094b053c8897d96d7b2737cd72f7c5)

| -rw-r--r-- | [drivers/usb/gadget/function/f\_ecm.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/usb/gadget/function/f_ecm.c?id=10770d2ac0094b053c8897d96d7b2737cd72f7c5) | 2 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |
| -rw-r--r-- | [drivers/usb/gadget/function/f\_eem.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/usb/gadget/function/f_eem.c?id=10770d2ac0094b053c8897d96d7b2737cd72f7c5) | 2 | |  |  |  | | --- | --- | --- | |
| -rw-r--r-- | [drivers/usb/gadget/function/f\_hid.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/usb/gadget/function/f_hid.c?id=10770d2ac0094b053c8897d96d7b2737cd72f7c5) | 3 | |  |  |  | | --- | --- | --- | |
| -rw-r--r-- | [drivers/usb/gadget/function/f\_loopback.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/usb/gadget/function/f_loopback.c?id=10770d2ac0094b053c8897d96d7b2737cd72f7c5) | 2 | |  |  |  | | --- | --- | --- | |
| -rw-r--r-- | [drivers/usb/gadget/function/f\_printer.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/usb/gadget/function/f_printer.c?id=10770d2ac0094b053c8897d96d7b2737cd72f7c5) | 3 | |  |  |  | | --- | --- | --- | |
| -rw-r--r-- | [drivers/usb/gadget/function/f\_rndis.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/usb/gadget/function/f_rndis.c?id=10770d2ac0094b053c8897d96d7b2737cd72f7c5) | 2 | |  |  |  | | --- | --- | --- | |
| -rw-r--r-- | [drivers/usb/gadget/function/f\_serial.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/usb/gadget/function/f_serial.c?id=10770d2ac0094b053c8897d96d7b2737cd72f7c5) | 2 | |  |  |  | | --- | --- | --- | |
| -rw-r--r-- | [drivers/usb/gadget/function/f\_sourcesink.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/usb/gadget/function/f_sourcesink.c?id=10770d2ac0094b053c8897d96d7b2737cd72f7c5) | 3 | |  |  |  | | --- | --- | --- | |
| -rw-r--r-- | [drivers/usb/gadget/function/f\_subset.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/usb/gadget/function/f_subset.c?id=10770d2ac0094b053c8897d96d7b2737cd72f7c5) | 2 | |  |  |  | | --- | --- | --- | |
| -rw-r--r-- | [drivers/usb/gadget/function/f\_tcm.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/usb/gadget/function/f_tcm.c?id=10770d2ac0094b053c8897d96d7b2737cd72f7c5) | 3 | |  |  |  | | --- | --- | --- | |

10 files changed, 14 insertions, 10 deletions

| diff --git a/drivers/usb/gadget/function/f\_ecm.c b/drivers/usb/gadget/function/f\_ecm.cindex 7f5cf488b2b1ed..ffe2486fce71c9 100644--- a/[drivers/usb/gadget/function/f\_ecm.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/usb/gadget/function/f_ecm.c?id=e76cb5c8837d213a90899f6aff53e3ab57c442f1)+++ b/[drivers/usb/gadget/function/f\_ecm.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/usb/gadget/function/f_ecm.c?id=10770d2ac0094b053c8897d96d7b2737cd72f7c5)@@ -791,7 +791,7 @@ ecm\_bind(struct usb\_configuration \*c, struct usb\_function \*f) fs\_ecm\_notify\_desc.bEndpointAddress;  status = usb\_assign\_descriptors(f, ecm\_fs\_function, ecm\_hs\_function,- ecm\_ss\_function, NULL);+ ecm\_ss\_function, ecm\_ss\_function); if (status) goto fail; diff --git a/drivers/usb/gadget/function/f\_eem.c b/drivers/usb/gadget/function/f\_eem.cindex 0d74e561607dbc..bdd964ac9fa9ad 100644--- a/[drivers/usb/gadget/function/f\_eem.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/usb/gadget/function/f_eem.c?id=e76cb5c8837d213a90899f6aff53e3ab57c442f1)+++ b/[drivers/usb/gadget/function/f\_eem.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/usb/gadget/function/f_eem.c?id=10770d2ac0094b053c8897d96d7b2737cd72f7c5)@@ -305,7 +305,7 @@ static int eem\_bind(struct usb\_configuration \*c, struct usb\_function \*f) eem\_ss\_out\_desc.bEndpointAddress = eem\_fs\_out\_desc.bEndpointAddress;  status = usb\_assign\_descriptors(f, eem\_fs\_function, eem\_hs\_function,- eem\_ss\_function, NULL);+ eem\_ss\_function, eem\_ss\_function); if (status) goto fail; diff --git a/drivers/usb/gadget/function/f\_hid.c b/drivers/usb/gadget/function/f\_hid.cindex 492bb44153b346..bc0a693c3260dc 100644--- a/[drivers/usb/gadget/function/f\_hid.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/usb/gadget/function/f_hid.c?id=e76cb5c8837d213a90899f6aff53e3ab57c442f1)+++ b/[drivers/usb/gadget/function/f\_hid.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/usb/gadget/function/f_hid.c?id=10770d2ac0094b053c8897d96d7b2737cd72f7c5)@@ -808,7 +808,8 @@ static int hidg\_bind(struct usb\_configuration \*c, struct usb\_function \*f) hidg\_fs\_out\_ep\_desc.bEndpointAddress;  status = usb\_assign\_descriptors(f, hidg\_fs\_descriptors,- hidg\_hs\_descriptors, hidg\_ss\_descriptors, NULL);+ hidg\_hs\_descriptors, hidg\_ss\_descriptors,+ hidg\_ss\_descriptors); if (status) goto fail; diff --git a/drivers/usb/gadget/function/f\_loopback.c b/drivers/usb/gadget/function/f\_loopback.cindex 1803646b367805..90215a81c178bb 100644--- a/[drivers/usb/gadget/function/f\_loopback.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/usb/gadget/function/f_loopback.c?id=e76cb5c8837d213a90899f6aff53e3ab57c442f1)+++ b/[drivers/usb/gadget/function/f\_loopback.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/usb/gadget/function/f_loopback.c?id=10770d2ac0094b053c8897d96d7b2737cd72f7c5)@@ -207,7 +207,7 @@ autoconf\_fail: ss\_loop\_sink\_desc.bEndpointAddress = fs\_loop\_sink\_desc.bEndpointAddress;  ret = usb\_assign\_descriptors(f, fs\_loopback\_descs, hs\_loopback\_descs,- ss\_loopback\_descs, NULL);+ ss\_loopback\_descs, ss\_loopback\_descs); if (ret) return ret; diff --git a/drivers/usb/gadget/function/f\_printer.c b/drivers/usb/gadget/function/f\_printer.cindex 0f47cd398d60a6..2a1868b2d24cff 100644--- a/[drivers/usb/gadget/function/f\_printer.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/usb/gadget/function/f_printer.c?id=e76cb5c8837d213a90899f6aff53e3ab57c442f1)+++ b/[drivers/usb/gadget/function/f\_printer.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/usb/gadget/function/f_printer.c?id=10770d2ac0094b053c8897d96d7b2737cd72f7c5)@@ -1063,7 +1063,8 @@ autoconf\_fail: ss\_ep\_out\_desc.bEndpointAddress = fs\_ep\_out\_desc.bEndpointAddress;  ret = usb\_assign\_descriptors(f, fs\_printer\_function,- hs\_printer\_function, ss\_printer\_function, NULL);+ hs\_printer\_function, ss\_printer\_function,+ ss\_printer\_function); if (ret) return ret; diff --git a/drivers/usb/gadget/function/f\_rndis.c b/drivers/usb/gadget/function/f\_rndis.cindex cc1ff5b7b60c49..f20c55d42f2193 100644--- a/[drivers/usb/gadget/function/f\_rndis.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/usb/gadget/function/f_rndis.c?id=e76cb5c8837d213a90899f6aff53e3ab57c442f1)+++ b/[drivers/usb/gadget/function/f\_rndis.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/usb/gadget/function/f_rndis.c?id=10770d2ac0094b053c8897d96d7b2737cd72f7c5)@@ -789,7 +789,7 @@ rndis\_bind(struct usb\_configuration \*c, struct usb\_function \*f) ss\_notify\_desc.bEndpointAddress = fs\_notify\_desc.bEndpointAddress;  status = usb\_assign\_descriptors(f, eth\_fs\_function, eth\_hs\_function,- eth\_ss\_function, NULL);+ eth\_ss\_function, eth\_ss\_function); if (status) goto fail; diff --git a/drivers/usb/gadget/function/f\_serial.c b/drivers/usb/gadget/function/f\_serial.cindex c860f30a0ea2bb..6db973d0c252ee 100644--- a/[drivers/usb/gadget/function/f\_serial.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/usb/gadget/function/f_serial.c?id=e76cb5c8837d213a90899f6aff53e3ab57c442f1)+++ b/[drivers/usb/gadget/function/f\_serial.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/usb/gadget/function/f_serial.c?id=10770d2ac0094b053c8897d96d7b2737cd72f7c5)@@ -233,7 +233,7 @@ static int gser\_bind(struct usb\_configuration \*c, struct usb\_function \*f) gser\_ss\_out\_desc.bEndpointAddress = gser\_fs\_out\_desc.bEndpointAddress;  status = usb\_assign\_descriptors(f, gser\_fs\_function, gser\_hs\_function,- gser\_ss\_function, NULL);+ gser\_ss\_function, gser\_ss\_function); if (status) goto fail; dev\_dbg(&cdev->gadget->dev, "generic ttyGS%d: %s speed IN/%s OUT/%s\n",diff --git a/drivers/usb/gadget/function/f\_sourcesink.c b/drivers/usb/gadget/function/f\_sourcesink.cindex ed68a4860b7d87..282737e4609ce8 100644--- a/[drivers/usb/gadget/function/f\_sourcesink.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/usb/gadget/function/f_sourcesink.c?id=e76cb5c8837d213a90899f6aff53e3ab57c442f1)+++ b/[drivers/usb/gadget/function/f\_sourcesink.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/usb/gadget/function/f_sourcesink.c?id=10770d2ac0094b053c8897d96d7b2737cd72f7c5)@@ -431,7 +431,8 @@ no\_iso: ss\_iso\_sink\_desc.bEndpointAddress = fs\_iso\_sink\_desc.bEndpointAddress;  ret = usb\_assign\_descriptors(f, fs\_source\_sink\_descs,- hs\_source\_sink\_descs, ss\_source\_sink\_descs, NULL);+ hs\_source\_sink\_descs, ss\_source\_sink\_descs,+ ss\_source\_sink\_descs); if (ret) return ret; diff --git a/drivers/usb/gadget/function/f\_subset.c b/drivers/usb/gadget/function/f\_subset.cindex 4d945254905d91..51c1cae162d9b0 100644--- a/[drivers/usb/gadget/function/f\_subset.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/usb/gadget/function/f_subset.c?id=e76cb5c8837d213a90899f6aff53e3ab57c442f1)+++ b/[drivers/usb/gadget/function/f\_subset.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/usb/gadget/function/f_subset.c?id=10770d2ac0094b053c8897d96d7b2737cd72f7c5)@@ -358,7 +358,7 @@ geth\_bind(struct usb\_configuration \*c, struct usb\_function \*f) fs\_subset\_out\_desc.bEndpointAddress;  status = usb\_assign\_descriptors(f, fs\_eth\_function, hs\_eth\_function,- ss\_eth\_function, NULL);+ ss\_eth\_function, ss\_eth\_function); if (status) goto fail; diff --git a/drivers/usb/gadget/function/f\_tcm.c b/drivers/usb/gadget/function/f\_tcm.cindex 785826ab5348ed..3c68b3ccb8a824 100644--- a/[drivers/usb/gadget/function/f\_tcm.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/usb/gadget/function/f_tcm.c?id=e76cb5c8837d213a90899f6aff53e3ab57c442f1)+++ b/[drivers/usb/gadget/function/f\_tcm.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/usb/gadget/function/f_tcm.c?id=10770d2ac0094b053c8897d96d7b2737cd72f7c5)@@ -2071,7 +2071,8 @@ static int tcm\_bind(struct usb\_configuration \*c, struct usb\_function \*f) uasp\_fs\_cmd\_desc.bEndpointAddress = uasp\_ss\_cmd\_desc.bEndpointAddress;  ret = usb\_assign\_descriptors(f, uasp\_fs\_function\_desc,- uasp\_hs\_function\_desc, uasp\_ss\_function\_desc, NULL);+ uasp\_hs\_function\_desc, uasp\_ss\_function\_desc,+ uasp\_ss\_function\_desc); if (ret) goto ep\_fail; |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-10 13:59:02 +0000



=== Content from git.kernel.org_e192a761_20250110_140027.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=4b289a0f3033f465b4fd51ba995251a7867a2aa2)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=4b289a0f3033f465b4fd51ba995251a7867a2aa2)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=4b289a0f3033f465b4fd51ba995251a7867a2aa2)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=4b289a0f3033f465b4fd51ba995251a7867a2aa2)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Maciej Żenczykowski <maze@google.com> | 2021-06-07 21:41:41 -0700 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2021-06-16 12:01:42 +0200 |
| commit | [4b289a0f3033f465b4fd51ba995251a7867a2aa2](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=4b289a0f3033f465b4fd51ba995251a7867a2aa2) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=4b289a0f3033f465b4fd51ba995251a7867a2aa2)) | |
| tree | [b241b6074559f0cc0e3e5ddb712f7d87079732d0](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=4b289a0f3033f465b4fd51ba995251a7867a2aa2) | |
| parent | [6bf8ff7d05204f0ec1842016280fedc00dd6b4d1](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=6bf8ff7d05204f0ec1842016280fedc00dd6b4d1) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=4b289a0f3033f465b4fd51ba995251a7867a2aa2&id2=6bf8ff7d05204f0ec1842016280fedc00dd6b4d1)) | |
| download | [linux-4b289a0f3033f465b4fd51ba995251a7867a2aa2.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-4b289a0f3033f465b4fd51ba995251a7867a2aa2.tar.gz) | |

usb: fix various gadgets null ptr deref on 10gbps cabling.commit 90c4d05780d47e14a50e11a7f17373104cd47d25 upstream.
This avoids a null pointer dereference in
f\_{ecm,eem,hid,loopback,printer,rndis,serial,sourcesink,subset,tcm}
by simply reusing the 5gbps config for 10gbps.
Fixes: eaef50c76057 ("usb: gadget: Update usb\_assign\_descriptors for SuperSpeedPlus")
Cc: Christophe JAILLET <christophe.jaillet@wanadoo.fr>
Cc: Felipe Balbi <balbi@kernel.org>
Cc: Gustavo A. R. Silva <gustavoars@kernel.org>
Cc: Lorenzo Colitti <lorenzo@google.com>
Cc: Martin K. Petersen <martin.petersen@oracle.com>
Cc: Michael R Sweet <msweet@msweet.org>
Cc: Mike Christie <michael.christie@oracle.com>
Cc: Pawel Laszczak <pawell@cadence.com>
Cc: Peter Chen <peter.chen@nxp.com>
Cc: Sudhakar Panneerselvam <sudhakar.panneerselvam@oracle.com>
Cc: Wei Ming Chen <jj251510319013@gmail.com>
Cc: Will McVicker <willmcvicker@google.com>
Cc: Zqiang <qiang.zhang@windriver.com>
Reviewed-By: Lorenzo Colitti <lorenzo@google.com>
Cc: stable <stable@vger.kernel.org>
Signed-off-by: Maciej Żenczykowski <maze@google.com>
Link: [https://lore.kernel.org/r/20210608044141.3898496-1-zenczykowski@gmail.com](https://lore.kernel.org/r/20210608044141.3898496-1-zenczykowski%40gmail.com)
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=4b289a0f3033f465b4fd51ba995251a7867a2aa2)

| -rw-r--r-- | [drivers/usb/gadget/function/f\_ecm.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/usb/gadget/function/f_ecm.c?id=4b289a0f3033f465b4fd51ba995251a7867a2aa2) | 2 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |
| -rw-r--r-- | [drivers/usb/gadget/function/f\_eem.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/usb/gadget/function/f_eem.c?id=4b289a0f3033f465b4fd51ba995251a7867a2aa2) | 2 | |  |  |  | | --- | --- | --- | |
| -rw-r--r-- | [drivers/usb/gadget/function/f\_hid.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/usb/gadget/function/f_hid.c?id=4b289a0f3033f465b4fd51ba995251a7867a2aa2) | 3 | |  |  |  | | --- | --- | --- | |
| -rw-r--r-- | [drivers/usb/gadget/function/f\_loopback.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/usb/gadget/function/f_loopback.c?id=4b289a0f3033f465b4fd51ba995251a7867a2aa2) | 2 | |  |  |  | | --- | --- | --- | |
| -rw-r--r-- | [drivers/usb/gadget/function/f\_printer.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/usb/gadget/function/f_printer.c?id=4b289a0f3033f465b4fd51ba995251a7867a2aa2) | 3 | |  |  |  | | --- | --- | --- | |
| -rw-r--r-- | [drivers/usb/gadget/function/f\_rndis.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/usb/gadget/function/f_rndis.c?id=4b289a0f3033f465b4fd51ba995251a7867a2aa2) | 2 | |  |  |  | | --- | --- | --- | |
| -rw-r--r-- | [drivers/usb/gadget/function/f\_serial.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/usb/gadget/function/f_serial.c?id=4b289a0f3033f465b4fd51ba995251a7867a2aa2) | 2 | |  |  |  | | --- | --- | --- | |
| -rw-r--r-- | [drivers/usb/gadget/function/f\_sourcesink.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/usb/gadget/function/f_sourcesink.c?id=4b289a0f3033f465b4fd51ba995251a7867a2aa2) | 3 | |  |  |  | | --- | --- | --- | |
| -rw-r--r-- | [drivers/usb/gadget/function/f\_subset.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/usb/gadget/function/f_subset.c?id=4b289a0f3033f465b4fd51ba995251a7867a2aa2) | 2 | |  |  |  | | --- | --- | --- | |
| -rw-r--r-- | [drivers/usb/gadget/function/f\_tcm.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/usb/gadget/function/f_tcm.c?id=4b289a0f3033f465b4fd51ba995251a7867a2aa2) | 3 | |  |  |  | | --- | --- | --- | |

10 files changed, 14 insertions, 10 deletions

| diff --git a/drivers/usb/gadget/function/f\_ecm.c b/drivers/usb/gadget/function/f\_ecm.cindex 7f5cf488b2b1ed..ffe2486fce71c9 100644--- a/[drivers/usb/gadget/function/f\_ecm.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/usb/gadget/function/f_ecm.c?id=6bf8ff7d05204f0ec1842016280fedc00dd6b4d1)+++ b/[drivers/usb/gadget/function/f\_ecm.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/usb/gadget/function/f_ecm.c?id=4b289a0f3033f465b4fd51ba995251a7867a2aa2)@@ -791,7 +791,7 @@ ecm\_bind(struct usb\_configuration \*c, struct usb\_function \*f) fs\_ecm\_notify\_desc.bEndpointAddress;  status = usb\_assign\_descriptors(f, ecm\_fs\_function, ecm\_hs\_function,- ecm\_ss\_function, NULL);+ ecm\_ss\_function, ecm\_ss\_function); if (status) goto fail; diff --git a/drivers/usb/gadget/function/f\_eem.c b/drivers/usb/gadget/function/f\_eem.cindex 28dd5f1fd10613..2cd9942707b46a 100644--- a/[drivers/usb/gadget/function/f\_eem.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/usb/gadget/function/f_eem.c?id=6bf8ff7d05204f0ec1842016280fedc00dd6b4d1)+++ b/[drivers/usb/gadget/function/f\_eem.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/usb/gadget/function/f_eem.c?id=4b289a0f3033f465b4fd51ba995251a7867a2aa2)@@ -302,7 +302,7 @@ static int eem\_bind(struct usb\_configuration \*c, struct usb\_function \*f) eem\_ss\_out\_desc.bEndpointAddress = eem\_fs\_out\_desc.bEndpointAddress;  status = usb\_assign\_descriptors(f, eem\_fs\_function, eem\_hs\_function,- eem\_ss\_function, NULL);+ eem\_ss\_function, eem\_ss\_function); if (status) goto fail; diff --git a/drivers/usb/gadget/function/f\_hid.c b/drivers/usb/gadget/function/f\_hid.cindex 1125f4715830de..e556993081170f 100644--- a/[drivers/usb/gadget/function/f\_hid.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/usb/gadget/function/f_hid.c?id=6bf8ff7d05204f0ec1842016280fedc00dd6b4d1)+++ b/[drivers/usb/gadget/function/f\_hid.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/usb/gadget/function/f_hid.c?id=4b289a0f3033f465b4fd51ba995251a7867a2aa2)@@ -802,7 +802,8 @@ static int hidg\_bind(struct usb\_configuration \*c, struct usb\_function \*f) hidg\_fs\_out\_ep\_desc.bEndpointAddress;  status = usb\_assign\_descriptors(f, hidg\_fs\_descriptors,- hidg\_hs\_descriptors, hidg\_ss\_descriptors, NULL);+ hidg\_hs\_descriptors, hidg\_ss\_descriptors,+ hidg\_ss\_descriptors); if (status) goto fail; diff --git a/drivers/usb/gadget/function/f\_loopback.c b/drivers/usb/gadget/function/f\_loopback.cindex 1803646b367805..90215a81c178bb 100644--- a/[drivers/usb/gadget/function/f\_loopback.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/usb/gadget/function/f_loopback.c?id=6bf8ff7d05204f0ec1842016280fedc00dd6b4d1)+++ b/[drivers/usb/gadget/function/f\_loopback.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/usb/gadget/function/f_loopback.c?id=4b289a0f3033f465b4fd51ba995251a7867a2aa2)@@ -207,7 +207,7 @@ autoconf\_fail: ss\_loop\_sink\_desc.bEndpointAddress = fs\_loop\_sink\_desc.bEndpointAddress;  ret = usb\_assign\_descriptors(f, fs\_loopback\_descs, hs\_loopback\_descs,- ss\_loopback\_descs, NULL);+ ss\_loopback\_descs, ss\_loopback\_descs); if (ret) return ret; diff --git a/drivers/usb/gadget/function/f\_printer.c b/drivers/usb/gadget/function/f\_printer.cindex 2f1eb2e81d306b..236ecc96899854 100644--- a/[drivers/usb/gadget/function/f\_printer.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/usb/gadget/function/f_printer.c?id=6bf8ff7d05204f0ec1842016280fedc00dd6b4d1)+++ b/[drivers/usb/gadget/function/f\_printer.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/usb/gadget/function/f_printer.c?id=4b289a0f3033f465b4fd51ba995251a7867a2aa2)@@ -1099,7 +1099,8 @@ autoconf\_fail: ss\_ep\_out\_desc.bEndpointAddress = fs\_ep\_out\_desc.bEndpointAddress;  ret = usb\_assign\_descriptors(f, fs\_printer\_function,- hs\_printer\_function, ss\_printer\_function, NULL);+ hs\_printer\_function, ss\_printer\_function,+ ss\_printer\_function); if (ret) return ret; diff --git a/drivers/usb/gadget/function/f\_rndis.c b/drivers/usb/gadget/function/f\_rndis.cindex 0739b05a0ef7b3..ee95e8f5f9d489 100644--- a/[drivers/usb/gadget/function/f\_rndis.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/usb/gadget/function/f_rndis.c?id=6bf8ff7d05204f0ec1842016280fedc00dd6b4d1)+++ b/[drivers/usb/gadget/function/f\_rndis.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/usb/gadget/function/f_rndis.c?id=4b289a0f3033f465b4fd51ba995251a7867a2aa2)@@ -789,7 +789,7 @@ rndis\_bind(struct usb\_configuration \*c, struct usb\_function \*f) ss\_notify\_desc.bEndpointAddress = fs\_notify\_desc.bEndpointAddress;  status = usb\_assign\_descriptors(f, eth\_fs\_function, eth\_hs\_function,- eth\_ss\_function, NULL);+ eth\_ss\_function, eth\_ss\_function); if (status) goto fail; diff --git a/drivers/usb/gadget/function/f\_serial.c b/drivers/usb/gadget/function/f\_serial.cindex e6271384635045..1ed8ff0ac2d310 100644--- a/[drivers/usb/gadget/function/f\_serial.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/usb/gadget/function/f_serial.c?id=6bf8ff7d05204f0ec1842016280fedc00dd6b4d1)+++ b/[drivers/usb/gadget/function/f\_serial.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/usb/gadget/function/f_serial.c?id=4b289a0f3033f465b4fd51ba995251a7867a2aa2)@@ -233,7 +233,7 @@ static int gser\_bind(struct usb\_configuration \*c, struct usb\_function \*f) gser\_ss\_out\_desc.bEndpointAddress = gser\_fs\_out\_desc.bEndpointAddress;  status = usb\_assign\_descriptors(f, gser\_fs\_function, gser\_hs\_function,- gser\_ss\_function, NULL);+ gser\_ss\_function, gser\_ss\_function); if (status) goto fail; dev\_dbg(&cdev->gadget->dev, "generic ttyGS%d: %s speed IN/%s OUT/%s\n",diff --git a/drivers/usb/gadget/function/f\_sourcesink.c b/drivers/usb/gadget/function/f\_sourcesink.cindex ed68a4860b7d87..282737e4609ce8 100644--- a/[drivers/usb/gadget/function/f\_sourcesink.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/usb/gadget/function/f_sourcesink.c?id=6bf8ff7d05204f0ec1842016280fedc00dd6b4d1)+++ b/[drivers/usb/gadget/function/f\_sourcesink.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/usb/gadget/function/f_sourcesink.c?id=4b289a0f3033f465b4fd51ba995251a7867a2aa2)@@ -431,7 +431,8 @@ no\_iso: ss\_iso\_sink\_desc.bEndpointAddress = fs\_iso\_sink\_desc.bEndpointAddress;  ret = usb\_assign\_descriptors(f, fs\_source\_sink\_descs,- hs\_source\_sink\_descs, ss\_source\_sink\_descs, NULL);+ hs\_source\_sink\_descs, ss\_source\_sink\_descs,+ ss\_source\_sink\_descs); if (ret) return ret; diff --git a/drivers/usb/gadget/function/f\_subset.c b/drivers/usb/gadget/function/f\_subset.cindex 4d945254905d91..51c1cae162d9b0 100644--- a/[drivers/usb/gadget/function/f\_subset.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/usb/gadget/function/f_subset.c?id=6bf8ff7d05204f0ec1842016280fedc00dd6b4d1)+++ b/[drivers/usb/gadget/function/f\_subset.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/usb/gadget/function/f_subset.c?id=4b289a0f3033f465b4fd51ba995251a7867a2aa2)@@ -358,7 +358,7 @@ geth\_bind(struct usb\_configuration \*c, struct usb\_function \*f) fs\_subset\_out\_desc.bEndpointAddress;  status = usb\_assign\_descriptors(f, fs\_eth\_function, hs\_eth\_function,- ss\_eth\_function, NULL);+ ss\_eth\_function, ss\_eth\_function); if (status) goto fail; diff --git a/drivers/usb/gadget/function/f\_tcm.c b/drivers/usb/gadget/function/f\_tcm.cindex 410fa89eae8f65..5a2e9ce2bc352e 100644--- a/[drivers/usb/gadget/function/f\_tcm.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/usb/gadget/function/f_tcm.c?id=6bf8ff7d05204f0ec1842016280fedc00dd6b4d1)+++ b/[drivers/usb/gadget/function/f\_tcm.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/usb/gadget/function/f_tcm.c?id=4b289a0f3033f465b4fd51ba995251a7867a2aa2)@@ -2061,7 +2061,8 @@ static int tcm\_bind(struct usb\_configuration \*c, struct usb\_function \*f) uasp\_fs\_cmd\_desc.bEndpointAddress = uasp\_ss\_cmd\_desc.bEndpointAddress;  ret = usb\_assign\_descriptors(f, uasp\_fs\_function\_desc,- uasp\_hs\_function\_desc, uasp\_ss\_function\_desc, NULL);+ uasp\_hs\_function\_desc, uasp\_ss\_function\_desc,+ uasp\_ss\_function\_desc); if (ret) goto ep\_fail; |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-10 13:59:04 +0000


