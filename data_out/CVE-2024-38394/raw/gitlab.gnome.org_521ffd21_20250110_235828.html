



<!DOCTYPE html>
<html class="gl-light ui-gray with-top-bar with-header " lang="en">
<head prefix="og: http://ogp.me/ns#">
<meta charset="utf-8">
<meta content="IE=edge" http-equiv="X-UA-Compatible">
<meta content="width=device-width, initial-scale=1" name="viewport">
<title>New Security Issue: USBGuard and device spoofing (#780) · Issues · GNOME / gnome-settings-daemon · GitLab</title>
<script>
//<![CDATA[
window.gon={};gon.api_version="v4";gon.default_avatar_url="https://gitlab.gnome.org/assets/no_avatar-849f9c04a3a0d0cea2424ae97b27447dc64a7dbfae83c036c45b403392f0e8ba.png";gon.max_file_size=500;gon.asset_host=null;gon.webpack_public_path="/assets/webpack/";gon.relative_url_root="";gon.user_color_mode="gl-light";gon.user_color_scheme="white";gon.markdown_surround_selection=null;gon.markdown_automatic_lists=null;gon.math_rendering_limits_enabled=true;gon.recaptcha_api_server_url="https://www.recaptcha.net/recaptcha/api.js";gon.recaptcha_sitekey="6Lfhei8UAAAAAKwEVuEwxJX09r0AGdMm-DUTWNAQ";gon.gitlab_url="https://gitlab.gnome.org";gon.promo_url="https://about.gitlab.com";gon.forum_url="https://forum.gitlab.com";gon.docs_url="https://docs.gitlab.com";gon.revision="065e0c2f057";gon.feature_category="team_planning";gon.gitlab_logo="/assets/gitlab_logo-2957169c8ef64c58616a1ac3f4fc626e8a35ce4eb3ed31bb0d873712f2a041a0.png";gon.secure=true;gon.sprite_icons="/assets/icons-8791a66659d025e0a4c801978c79a1fbd82db1d27d85f044a35728ea7cf0ae80.svg";gon.sprite_file_icons="/assets/file_icons/file_icons-7cd3d6c3b29a6d972895f36472978a4b5adb4b37f9b5d0716a380e82389f7e0e.svg";gon.emoji_sprites_css_path="/assets/emoji_sprites-d746ae2450a3e9c626d338d77a101b84ff33a47c0c281b676d75c4a6ed2948a4.css";gon.emoji_backend_version=4;gon.gridstack_css_path="/assets/lazy_bundles/gridstack-5fcfd4ffbea1db04eaf7f16521bcab19ae3af042c8b4afe8d16781eda5a70799.css";gon.test_env=false;gon.disable_animations=null;gon.suggested_label_colors={"#cc338b":"Magenta-pink","#dc143c":"Crimson","#c21e56":"Rose red","#cd5b45":"Dark coral","#ed9121":"Carrot orange","#eee600":"Titanium yellow","#009966":"Green-cyan","#8fbc8f":"Dark sea green","#6699cc":"Blue-gray","#e6e6fa":"Lavender","#9400d3":"Dark violet","#330066":"Deep violet","#36454f":"Charcoal grey","#808080":"Gray"};gon.first_day_of_week=1;gon.time_display_relative=true;gon.time_display_format=0;gon.ee=false;gon.jh=false;gon.dot_com=false;gon.uf_error_prefix="UF";gon.pat_prefix="ggopat";gon.keyboard_shortcuts_enabled=true;gon.diagramsnet_url="https://embed.diagrams.net";gon.features={"sourceEditorToolbar":false,"vscodeWebIde":true,"uiForOrganizations":false,"organizationSwitching":false,"findAndReplace":false,"removeMonitorMetrics":true,"workItemsViewPreference":false,"searchButtonTopRight":false,"asyncSidebarCounts":false,"preserveMarkdown":false,"issuesGridView":false,"serviceDeskTicket":false,"issuesListDrawer":false,"notificationsTodosButtons":false,"glqlIntegration":false,"workItems":true,"workItemsBeta":false,"workItemsAlpha":false,"epicWidgetEditConfirmation":false,"namespaceLevelWorkItems":false};
//]]>
</script>


<script>
//<![CDATA[
var gl = window.gl || {};
gl.startup_calls = {"/GNOME/gnome-settings-daemon/-/issues/780/related_branches":{},"/GNOME/gnome-settings-daemon/-/issues/780/discussions.json?per_page=20":{},"/GNOME/gnome-settings-daemon/-/issues/780.json?serializer=sidebar_extras":{}};
gl.startup_graphql_calls = null;

if (gl.startup_calls && window.fetch) {
  Object.keys(gl.startup_calls).forEach(apiCall => {
   gl.startup_calls[apiCall] = {
      fetchCall: fetch(apiCall, {
        // Emulate XHR for Rails AJAX request checks
        headers: {
          'X-Requested-With': 'XMLHttpRequest'
        },
        // fetch won’t send cookies in older browsers, unless you set the credentials init option.
        // We set to `same-origin` which is default value in modern browsers.
        // See https://github.com/whatwg/fetch/pull/585 for more information.
        credentials: 'same-origin'
      })
    };
  });
}
if (gl.startup_graphql_calls && window.fetch) {
  const headers = {"X-CSRF-Token":"bySmM0a9q6G0vTk-daidTyApgjAZD1m02P1N0B7SXSKxYL74qf3KBlJ65HFh4fGp-qcYdfVe0a6OQ6wexXi7rA","x-gitlab-feature-category":"team_planning"};
  const url = `https://gitlab.gnome.org/api/graphql`

  const opts = {
    method: "POST",
    headers: {
      "Content-Type": "application/json",
      ...headers,
    }
  };

  gl.startup_graphql_calls = gl.startup_graphql_calls.map(call => ({
    ...call,
    fetchCall: fetch(url, {
      ...opts,
      credentials: 'same-origin',
      body: JSON.stringify(call)
    })
  }))
}


//]]>
</script>



<link rel="stylesheet" href="/assets/application-2e69a08e74e113997b5ba7fc5cd3e020a6f407d9ad552675adc6d78c2b23d0f7.css" />
<link rel="stylesheet" href="/assets/page_bundles/design_management-55b7f0d1f8549b24ba19c0b5aaf18a17a8d3828677fad074d37dd2e69d08da2b.css" /><link rel="stylesheet" href="/assets/page_bundles/incidents-6598dbf61fe32a8ddb1b06150f2301451ad41554975581e771efc5f890d0443f.css" /><link rel="stylesheet" href="/assets/page_bundles/issuable-01914381150850b46ac12e613a08df1d9b815aa305882ef8482ccd64eda0773f.css" /><link rel="stylesheet" href="/assets/page_bundles/notes_shared-caf98f77b75b4b5399bdde69c069ee023fefdaa986d687c937e8010218785f51.css" /><link rel="stylesheet" href="/assets/page_bundles/issues_show-785541c300108b8ecf7c08fd02bd67f4d6b9d59c86918ecfbf91bae5e1c8ffa8.css" /><link rel="stylesheet" href="/assets/page_bundles/work_items-cbc6a2e1633c4e847a617e35cc4833b85b80816db688d3d6dd3cd31d4251bc53.css" /><link rel="stylesheet" href="/assets/page_bundles/labels-3508460b8d6f839e9d60de1f2065fdaf7f057efab04cf71966acef6a86fe9b41.css" /><link rel="stylesheet" href="/assets/page_bundles/commit_description-1e2cba4dda3c7b30dd84924809020c569f1308dea51520fe1dd5d4ce31403195.css" />
<link rel="stylesheet" href="/assets/application_utilities-0bfb919a8a7eb0e89544dfe328e69461ccb276a565685fdb6ae3b14f3db3f41b.css" />
<link rel="stylesheet" href="/assets/tailwind-016e83140c37d97dbdff0cef9c063fcd43d214866665fb783774776747928853.css" />


<link rel="stylesheet" href="/assets/fonts-fae5d3f79948bd85f18b6513a025f863b19636e85b09a1492907eb4b1bb0557b.css" />
<link rel="stylesheet" href="/assets/highlight/themes/white-5ffbb706faebead681b01c8b52e92c6c0d35ad5b1c11d39012c90bcaf7892ca8.css" />


<link rel="preload" href="/assets/application_utilities-0bfb919a8a7eb0e89544dfe328e69461ccb276a565685fdb6ae3b14f3db3f41b.css" as="style" type="text/css">
<link rel="preload" href="/assets/application-2e69a08e74e113997b5ba7fc5cd3e020a6f407d9ad552675adc6d78c2b23d0f7.css" as="style" type="text/css">
<link rel="preload" href="/assets/highlight/themes/white-5ffbb706faebead681b01c8b52e92c6c0d35ad5b1c11d39012c90bcaf7892ca8.css" as="style" type="text/css">




<script src="/assets/webpack/runtime.68fcb180.bundle.js" defer="defer"></script>
<script src="/assets/webpack/main.a4c9ae4f.chunk.js" defer="defer"></script>
<script src="/assets/webpack/commons-pages.admin.abuse_reports.show-pages.admin.topics.edit-pages.admin.topics.new-pages.dashboar-c8f1318b.54872cef.chunk.js" defer="defer"></script>
<script src="/assets/webpack/commons-pages.admin.abuse_reports.show-pages.dashboard.issues-pages.dashboard.milestones.show-pages.-13e11bbf.1a73330b.chunk.js" defer="defer"></script>
<script src="/assets/webpack/commons-pages.admin.abuse_reports.show-pages.dashboard.issues-pages.groups.boards-pages.groups.issue-8dfa5f96.20262e8b.chunk.js" defer="defer"></script>
<script src="/assets/webpack/commons-pages.admin.abuse_reports.show-pages.dashboard.issues-pages.groups.boards-pages.groups.issue-f804d6c2.d4f467df.chunk.js" defer="defer"></script>
<script src="/assets/webpack/commons-pages.groups.new-pages.import.gitlab_projects.new-pages.import.manifest.new-pages.projects.n-44c6c18e.800b02b5.chunk.js" defer="defer"></script>
<script src="/assets/webpack/commons-pages.search.show-super_sidebar.98a5daf8.chunk.js" defer="defer"></script>
<script src="/assets/webpack/super_sidebar.839aed14.chunk.js" defer="defer"></script>
<script src="/assets/webpack/commons-pages.projects-pages.projects.activity-pages.projects.alert_management.details-pages.project-2cf3f004.cf930f47.chunk.js" defer="defer"></script>
<script src="/assets/webpack/commons-pages.admin.abuse_reports.show-pages.admin.topics.edit-pages.admin.topics.new-pages.groups.m-b59cd8e6.af19401d.chunk.js" defer="defer"></script>
<script src="/assets/webpack/5.7a5f7362.chunk.js" defer="defer"></script>
<script src="/assets/webpack/commons-pages.admin.abuse_reports.show-pages.admin.topics.edit-pages.admin.topics.new-pages.groups.m-bfc75f5d.bc5ed18e.chunk.js" defer="defer"></script>
<script src="/assets/webpack/9.bc4d8be7.chunk.js" defer="defer"></script>
<script src="/assets/webpack/commons-pages.admin.abuse_reports.show-pages.admin.topics.edit-pages.admin.topics.new-pages.groups.m-74b1dcb9.25b64210.chunk.js" defer="defer"></script>
<script src="/assets/webpack/commons-pages.admin.abuse_reports-pages.admin.abuse_reports.show-pages.admin.groups.index-pages.admi-e271b53c.4fcbe683.chunk.js" defer="defer"></script>
<script src="/assets/webpack/commons-pages.admin.topics.edit-pages.admin.topics.new-pages.groups.milestones.edit-pages.groups.mil-2f72a3d7.5269b7ea.chunk.js" defer="defer"></script>
<script src="/assets/webpack/commons-pages.admin.abuse_reports.show-pages.dashboard.milestones.show-pages.groups.merge_requests-p-6152ef8e.1d43fc45.chunk.js" defer="defer"></script>
<script src="/assets/webpack/commons-pages.dashboard.milestones.show-pages.groups.merge_requests-pages.groups.milestones.edit-pag-8e438287.4a86321e.chunk.js" defer="defer"></script>
<script src="/assets/webpack/commons-pages.dashboard.issues-pages.groups.issues-pages.groups.merge_requests-pages.groups.work_ite-dc744cb1.d70eece9.chunk.js" defer="defer"></script>
<script src="/assets/webpack/commons-pages.groups.issues-pages.groups.merge_requests-pages.groups.work_items-pages.groups.work_it-ed595783.87e56f63.chunk.js" defer="defer"></script>
<script src="/assets/webpack/commons-pages.groups.milestones.edit-pages.groups.milestones.new-pages.groups.milestones.show-pages.-7486cfee.c1a8fe55.chunk.js" defer="defer"></script>
<script src="/assets/webpack/commons-pages.groups.merge_requests-pages.groups.work_items-pages.groups.work_items.show-pages.proje-a6a6c699.b1ed2339.chunk.js" defer="defer"></script>
<script src="/assets/webpack/pages.projects.issues.show.af28b7e0.chunk.js" defer="defer"></script>

<meta content="object" property="og:type">
<meta content="GitLab" property="og:site_name">
<meta content="New Security Issue: USBGuard and device spoofing (#780) · Issues · GNOME / gnome-settings-daemon · GitLab" property="og:title">
<meta content="Original reporter: Michael Fincham Area: Platform component (libraries, tools)  Message Hi Gnome security, " property="og:description">
<meta content="https://gitlab.gnome.org/uploads/-/system/project/avatar/664/logo.png" property="og:image">
<meta content="64" property="og:image:width">
<meta content="64" property="og:image:height">
<meta content="https://gitlab.gnome.org/GNOME/gnome-settings-daemon/-/issues/780" property="og:url">
<meta content="summary" property="twitter:card">
<meta content="New Security Issue: USBGuard and device spoofing (#780) · Issues · GNOME / gnome-settings-daemon · GitLab" property="twitter:title">
<meta content="Original reporter: Michael Fincham Area: Platform component (libraries, tools)  Message Hi Gnome security, " property="twitter:description">
<meta content="https://gitlab.gnome.org/uploads/-/system/project/avatar/664/logo.png" property="twitter:image">
<meta property="twitter:label1" content="Author"><meta property="twitter:data1" content="GitLab Support Bot">
<meta name="csrf-param" content="authenticity_token" />
<meta name="csrf-token" content="DP42szcsmKUiSW8KMC1WYmUdjVWk_b7ed_SfW8hhzTDSui542Gz5AsSOskUkZDqEv5MXEEisNsQhSn6VE8srvg" />
<meta name="csp-nonce" />
<meta name="action-cable-url" content="/-/cable" />
<link href="/-/manifest.json" rel="manifest">
<link rel="icon" type="image/png" href="/uploads/-/system/appearance/favicon/1/GnomeLogoVertical.svg.png" id="favicon" data-original-href="/uploads/-/system/appearance/favicon/1/GnomeLogoVertical.svg.png" />
<link rel="apple-touch-icon" type="image/x-icon" href="/assets/apple-touch-icon-b049d4bc0dd9626f31db825d61880737befc7835982586d015bded10b4435460.png" />
<link href="/search/opensearch.xml" rel="search" title="Search GitLab" type="application/opensearchdescription+xml">




<meta content="Original reporter: Michael Fincham Area: Platform component (libraries, tools)  Message Hi Gnome security, " name="description">
<meta content="#28272d" name="theme-color">
</head>

<body class="tab-width-8 gl-browser-chrome gl-platform-windows" data-find-file="/GNOME/gnome-settings-daemon/-/find_file/master" data-group="GNOME" data-group-full-path="GNOME" data-namespace-id="8" data-page="projects:issues:show" data-page-type-id="780" data-project="gnome-settings-daemon" data-project-full-path="GNOME/gnome-settings-daemon" data-project-id="664">
<script>
//<![CDATA[
gl = window.gl || {};
gl.GfmAutoComplete = gl.GfmAutoComplete || {};
gl.GfmAutoComplete.dataSources = {"members":"/GNOME/gnome-settings-daemon/-/autocomplete_sources/members?type=Issue\u0026type_id=780","issues":"/GNOME/gnome-settings-daemon/-/autocomplete_sources/issues","mergeRequests":"/GNOME/gnome-settings-daemon/-/autocomplete_sources/merge_requests","labels":"/GNOME/gnome-settings-daemon/-/autocomplete_sources/labels?type=Issue\u0026type_id=780","milestones":"/GNOME/gnome-settings-daemon/-/autocomplete_sources/milestones","commands":"/GNOME/gnome-settings-daemon/-/autocomplete_sources/commands?type=Issue\u0026type_id=780","snippets":"/GNOME/gnome-settings-daemon/-/autocomplete_sources/snippets","contacts":"/GNOME/gnome-settings-daemon/-/autocomplete_sources/contacts?type=Issue\u0026type_id=780","wikis":null};


//]]>
</script>
<script>
//<![CDATA[
gl = window.gl || {};
gl.client = {"isChrome":true,"isWindows":true};


//]]>
</script>


<header class="header-logged-out" data-testid="navbar">
<a class="gl-sr-only gl-accessibility" href="#content-body">Skip to content</a>
<div class="container-fluid">
<nav aria-label="Explore GitLab" class="header-logged-out-nav gl-flex gl-gap-3 gl-justify-between">
<div class="gl-flex gl-items-center gl-gap-1">
<span class="gl-sr-only">GitLab</span>
<a title="Homepage" id="logo" class="header-logged-out-logo has-tooltip" aria-label="Homepage" href="/"><img class="brand-header-logo lazy" alt="" data-src="/uploads/-/system/appearance/header_logo/1/GnomeLogoHorizontal.svg" src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" />
</a></div>
<ul class="gl-list-none gl-p-0 gl-m-0 gl-flex gl-gap-3 gl-items-center gl-grow">
<li class="header-logged-out-nav-item">
<a class="" href="/explore">Explore</a>
</li>
</ul>
<ul class="gl-list-none gl-p-0 gl-m-0 gl-flex gl-gap-3 gl-items-center gl-justify-end">
<li class="header-logged-out-nav-item">
<a href="/users/sign_in?redirect_to_referer=yes">Sign in</a>
</li>
</ul>
</nav>
</div>
</header>

<div class="layout-page page-gutter right-sidebar-expanded page-with-super-sidebar">
<aside class="js-super-sidebar super-sidebar super-sidebar-loading" data-command-palette="{&quot;project_files_url&quot;:&quot;/GNOME/gnome-settings-daemon/-/files/master?format=json&quot;,&quot;project_blob_url&quot;:&quot;/GNOME/gnome-settings-daemon/-/blob/master&quot;}" data-force-desktop-expanded-sidebar="" data-is-saas="false" data-root-path="/" data-sidebar="{&quot;is_logged_in&quot;:false,&quot;context_switcher_links&quot;:[{&quot;title&quot;:&quot;Explore&quot;,&quot;link&quot;:&quot;/explore&quot;,&quot;icon&quot;:&quot;compass&quot;}],&quot;current_menu_items&quot;:[{&quot;id&quot;:&quot;project_overview&quot;,&quot;title&quot;:&quot;gnome-settings-daemon&quot;,&quot;avatar&quot;:&quot;/uploads/-/system/project/avatar/664/logo.png&quot;,&quot;entity_id&quot;:664,&quot;link&quot;:&quot;/GNOME/gnome-settings-daemon&quot;,&quot;link_classes&quot;:&quot;shortcuts-project&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;manage_menu&quot;,&quot;title&quot;:&quot;Manage&quot;,&quot;icon&quot;:&quot;users&quot;,&quot;avatar_shape&quot;:&quot;rect&quot;,&quot;link&quot;:&quot;/GNOME/gnome-settings-daemon/activity&quot;,&quot;is_active&quot;:false,&quot;items&quot;:[{&quot;id&quot;:&quot;activity&quot;,&quot;title&quot;:&quot;Activity&quot;,&quot;link&quot;:&quot;/GNOME/gnome-settings-daemon/activity&quot;,&quot;link_classes&quot;:&quot;shortcuts-project-activity&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;members&quot;,&quot;title&quot;:&quot;Members&quot;,&quot;link&quot;:&quot;/GNOME/gnome-settings-daemon/-/project_members&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;labels&quot;,&quot;title&quot;:&quot;Labels&quot;,&quot;link&quot;:&quot;/GNOME/gnome-settings-daemon/-/labels&quot;,&quot;is_active&quot;:false}],&quot;separated&quot;:false},{&quot;id&quot;:&quot;plan_menu&quot;,&quot;title&quot;:&quot;Plan&quot;,&quot;icon&quot;:&quot;planning&quot;,&quot;avatar_shape&quot;:&quot;rect&quot;,&quot;link&quot;:&quot;/GNOME/gnome-settings-daemon/-/issues&quot;,&quot;is_active&quot;:true,&quot;items&quot;:[{&quot;id&quot;:&quot;project_issue_list&quot;,&quot;title&quot;:&quot;Issues&quot;,&quot;link&quot;:&quot;/GNOME/gnome-settings-daemon/-/issues&quot;,&quot;pill_count&quot;:&quot;331&quot;,&quot;link_classes&quot;:&quot;shortcuts-issues has-sub-items&quot;,&quot;is_active&quot;:true},{&quot;id&quot;:&quot;boards&quot;,&quot;title&quot;:&quot;Issue boards&quot;,&quot;link&quot;:&quot;/GNOME/gnome-settings-daemon/-/boards&quot;,&quot;link_classes&quot;:&quot;shortcuts-issue-boards&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;milestones&quot;,&quot;title&quot;:&quot;Milestones&quot;,&quot;link&quot;:&quot;/GNOME/gnome-settings-daemon/-/milestones&quot;,&quot;is_active&quot;:false}],&quot;separated&quot;:false},{&quot;id&quot;:&quot;code_menu&quot;,&quot;title&quot;:&quot;Code&quot;,&quot;icon&quot;:&quot;code&quot;,&quot;avatar_shape&quot;:&quot;rect&quot;,&quot;link&quot;:&quot;/GNOME/gnome-settings-daemon/-/merge_requests&quot;,&quot;is_active&quot;:false,&quot;items&quot;:[{&quot;id&quot;:&quot;project_merge_request_list&quot;,&quot;title&quot;:&quot;Merge requests&quot;,&quot;link&quot;:&quot;/GNOME/gnome-settings-daemon/-/merge_requests&quot;,&quot;pill_count&quot;:&quot;48&quot;,&quot;link_classes&quot;:&quot;shortcuts-merge_requests&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;files&quot;,&quot;title&quot;:&quot;Repository&quot;,&quot;link&quot;:&quot;/GNOME/gnome-settings-daemon/-/tree/master&quot;,&quot;link_classes&quot;:&quot;shortcuts-tree&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;branches&quot;,&quot;title&quot;:&quot;Branches&quot;,&quot;link&quot;:&quot;/GNOME/gnome-settings-daemon/-/branches&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;commits&quot;,&quot;title&quot;:&quot;Commits&quot;,&quot;link&quot;:&quot;/GNOME/gnome-settings-daemon/-/commits/master?ref_type=heads&quot;,&quot;link_classes&quot;:&quot;shortcuts-commits&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;tags&quot;,&quot;title&quot;:&quot;Tags&quot;,&quot;link&quot;:&quot;/GNOME/gnome-settings-daemon/-/tags&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;graphs&quot;,&quot;title&quot;:&quot;Repository graph&quot;,&quot;link&quot;:&quot;/GNOME/gnome-settings-daemon/-/network/master?ref_type=heads&quot;,&quot;link_classes&quot;:&quot;shortcuts-network&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;compare&quot;,&quot;title&quot;:&quot;Compare revisions&quot;,&quot;link&quot;:&quot;/GNOME/gnome-settings-daemon/-/compare?from=master\u0026to=master&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;project_snippets&quot;,&quot;title&quot;:&quot;Snippets&quot;,&quot;link&quot;:&quot;/GNOME/gnome-settings-daemon/-/snippets&quot;,&quot;link_classes&quot;:&quot;shortcuts-snippets&quot;,&quot;is_active&quot;:false}],&quot;separated&quot;:false},{&quot;id&quot;:&quot;build_menu&quot;,&quot;title&quot;:&quot;Build&quot;,&quot;icon&quot;:&quot;rocket&quot;,&quot;avatar_shape&quot;:&quot;rect&quot;,&quot;link&quot;:&quot;/GNOME/gnome-settings-daemon/-/pipelines&quot;,&quot;is_active&quot;:false,&quot;items&quot;:[{&quot;id&quot;:&quot;pipelines&quot;,&quot;title&quot;:&quot;Pipelines&quot;,&quot;link&quot;:&quot;/GNOME/gnome-settings-daemon/-/pipelines&quot;,&quot;link_classes&quot;:&quot;shortcuts-pipelines&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;jobs&quot;,&quot;title&quot;:&quot;Jobs&quot;,&quot;link&quot;:&quot;/GNOME/gnome-settings-daemon/-/jobs&quot;,&quot;link_classes&quot;:&quot;shortcuts-builds&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;pipeline_schedules&quot;,&quot;title&quot;:&quot;Pipeline schedules&quot;,&quot;link&quot;:&quot;/GNOME/gnome-settings-daemon/-/pipeline_schedules&quot;,&quot;link_classes&quot;:&quot;shortcuts-builds&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;artifacts&quot;,&quot;title&quot;:&quot;Artifacts&quot;,&quot;link&quot;:&quot;/GNOME/gnome-settings-daemon/-/artifacts&quot;,&quot;link_classes&quot;:&quot;shortcuts-builds&quot;,&quot;is_active&quot;:false}],&quot;separated&quot;:false},{&quot;id&quot;:&quot;deploy_menu&quot;,&quot;title&quot;:&quot;Deploy&quot;,&quot;icon&quot;:&quot;deployments&quot;,&quot;avatar_shape&quot;:&quot;rect&quot;,&quot;link&quot;:&quot;/GNOME/gnome-settings-daemon/-/releases&quot;,&quot;is_active&quot;:false,&quot;items&quot;:[{&quot;id&quot;:&quot;releases&quot;,&quot;title&quot;:&quot;Releases&quot;,&quot;link&quot;:&quot;/GNOME/gnome-settings-daemon/-/releases&quot;,&quot;link_classes&quot;:&quot;shortcuts-deployments-releases&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;container_registry&quot;,&quot;title&quot;:&quot;Container Registry&quot;,&quot;link&quot;:&quot;/GNOME/gnome-settings-daemon/container_registry&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;model_registry&quot;,&quot;title&quot;:&quot;Model registry&quot;,&quot;link&quot;:&quot;/GNOME/gnome-settings-daemon/-/ml/models&quot;,&quot;is_active&quot;:false}],&quot;separated&quot;:false},{&quot;id&quot;:&quot;operations_menu&quot;,&quot;title&quot;:&quot;Operate&quot;,&quot;icon&quot;:&quot;cloud-pod&quot;,&quot;avatar_shape&quot;:&quot;rect&quot;,&quot;link&quot;:&quot;/GNOME/gnome-settings-daemon/-/environments&quot;,&quot;is_active&quot;:false,&quot;items&quot;:[{&quot;id&quot;:&quot;environments&quot;,&quot;title&quot;:&quot;Environments&quot;,&quot;link&quot;:&quot;/GNOME/gnome-settings-daemon/-/environments&quot;,&quot;link_classes&quot;:&quot;shortcuts-environments&quot;,&quot;is_active&quot;:false}],&quot;separated&quot;:false},{&quot;id&quot;:&quot;monitor_menu&quot;,&quot;title&quot;:&quot;Monitor&quot;,&quot;icon&quot;:&quot;monitor&quot;,&quot;avatar_shape&quot;:&quot;rect&quot;,&quot;link&quot;:&quot;/GNOME/gnome-settings-daemon/-/incidents&quot;,&quot;is_active&quot;:false,&quot;items&quot;:[{&quot;id&quot;:&quot;incidents&quot;,&quot;title&quot;:&quot;Incidents&quot;,&quot;link&quot;:&quot;/GNOME/gnome-settings-daemon/-/incidents&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;service_desk&quot;,&quot;title&quot;:&quot;Service Desk&quot;,&quot;link&quot;:&quot;/GNOME/gnome-settings-daemon/-/issues/service_desk&quot;,&quot;is_active&quot;:false}],&quot;separated&quot;:false},{&quot;id&quot;:&quot;analyze_menu&quot;,&quot;title&quot;:&quot;Analyze&quot;,&quot;icon&quot;:&quot;chart&quot;,&quot;avatar_shape&quot;:&quot;rect&quot;,&quot;link&quot;:&quot;/GNOME/gnome-settings-daemon/-/value_stream_analytics&quot;,&quot;is_active&quot;:false,&quot;items&quot;:[{&quot;id&quot;:&quot;cycle_analytics&quot;,&quot;title&quot;:&quot;Value stream analytics&quot;,&quot;link&quot;:&quot;/GNOME/gnome-settings-daemon/-/value_stream_analytics&quot;,&quot;link_classes&quot;:&quot;shortcuts-project-cycle-analytics&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;contributors&quot;,&quot;title&quot;:&quot;Contributor analytics&quot;,&quot;link&quot;:&quot;/GNOME/gnome-settings-daemon/-/graphs/master?ref_type=heads&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;ci_cd_analytics&quot;,&quot;title&quot;:&quot;CI/CD analytics&quot;,&quot;link&quot;:&quot;/GNOME/gnome-settings-daemon/-/pipelines/charts&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;repository_analytics&quot;,&quot;title&quot;:&quot;Repository analytics&quot;,&quot;link&quot;:&quot;/GNOME/gnome-settings-daemon/-/graphs/master/charts&quot;,&quot;link_classes&quot;:&quot;shortcuts-repository-charts&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;model_experiments&quot;,&quot;title&quot;:&quot;Model experiments&quot;,&quot;link&quot;:&quot;/GNOME/gnome-settings-daemon/-/ml/experiments&quot;,&quot;is_active&quot;:false}],&quot;separated&quot;:false}],&quot;current_context_header&quot;:&quot;Project&quot;,&quot;support_path&quot;:&quot;https://about.gitlab.com/get-help/&quot;,&quot;docs_path&quot;:&quot;/help/docs&quot;,&quot;display_whats_new&quot;:false,&quot;show_version_check&quot;:null,&quot;search&quot;:{&quot;search_path&quot;:&quot;/search&quot;,&quot;issues_path&quot;:&quot;/dashboard/issues&quot;,&quot;mr_path&quot;:&quot;/dashboard/merge_requests&quot;,&quot;autocomplete_path&quot;:&quot;/search/autocomplete&quot;,&quot;settings_path&quot;:&quot;/search/settings&quot;,&quot;search_context&quot;:{&quot;group&quot;:{&quot;id&quot;:8,&quot;name&quot;:&quot;GNOME&quot;,&quot;full_name&quot;:&quot;GNOME&quot;},&quot;group_metadata&quot;:{&quot;issues_path&quot;:&quot;/groups/GNOME/-/issues&quot;,&quot;mr_path&quot;:&quot;/groups/GNOME/-/merge_requests&quot;},&quot;project&quot;:{&quot;id&quot;:664,&quot;name&quot;:&quot;gnome-settings-daemon&quot;},&quot;project_metadata&quot;:{&quot;mr_path&quot;:&quot;/GNOME/gnome-settings-daemon/-/merge_requests&quot;,&quot;issues_path&quot;:&quot;/GNOME/gnome-settings-daemon/-/issues&quot;},&quot;code_search&quot;:false,&quot;scope&quot;:&quot;issues&quot;,&quot;for_snippets&quot;:null}},&quot;panel_type&quot;:&quot;project&quot;,&quot;shortcut_links&quot;:[{&quot;title&quot;:&quot;Snippets&quot;,&quot;href&quot;:&quot;/explore/snippets&quot;,&quot;css_class&quot;:&quot;dashboard-shortcuts-snippets&quot;},{&quot;title&quot;:&quot;Groups&quot;,&quot;href&quot;:&quot;/explore/groups&quot;,&quot;css_class&quot;:&quot;dashboard-shortcuts-groups&quot;},{&quot;title&quot;:&quot;Projects&quot;,&quot;href&quot;:&quot;/explore/projects/starred&quot;,&quot;css_class&quot;:&quot;dashboard-shortcuts-projects&quot;}],&quot;terms&quot;:&quot;/-/users/terms&quot;}"></aside>

<div class="content-wrapper">
<div class="broadcast-wrapper">




</div>
<div class="alert-wrapper alert-wrapper-top-space gl-flex gl-flex-col gl-gap-3 container-fluid container-limited">

























</div>
<div class="top-bar-fixed container-fluid" data-testid="top-bar">
<div class="top-bar-container gl-flex gl-items-center gl-gap-2">
<div class="gl-grow gl-basis-0 gl-flex gl-items-center gl-justify-start">
<button class="gl-button btn btn-icon btn-md btn-default btn-default-tertiary js-super-sidebar-toggle-expand super-sidebar-toggle -gl-ml-3" aria-controls="super-sidebar" aria-expanded="false" aria-label="Primary navigation sidebar" type="button"><svg class="s16 gl-icon gl-button-icon " data-testid="sidebar-icon"><use href="/assets/icons-8791a66659d025e0a4c801978c79a1fbd82db1d27d85f044a35728ea7cf0ae80.svg#sidebar"></use></svg>

</button>
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"GNOME","item":"https://gitlab.gnome.org/GNOME"},{"@type":"ListItem","position":2,"name":"gnome-settings-daemon","item":"https://gitlab.gnome.org/GNOME/gnome-settings-daemon"},{"@type":"ListItem","position":3,"name":"Issues","item":"https://gitlab.gnome.org/GNOME/gnome-settings-daemon/-/issues"},{"@type":"ListItem","position":4,"name":"#780","item":"https://gitlab.gnome.org/GNOME/gnome-settings-daemon/-/issues/780"}]}


</script>
<div data-testid="breadcrumb-links" id="js-vue-page-breadcrumbs-wrapper">
<div data-breadcrumbs-json="[{&quot;text&quot;:&quot;GNOME&quot;,&quot;href&quot;:&quot;/GNOME&quot;,&quot;avatarPath&quot;:&quot;/uploads/-/system/group/avatar/8/gnomelogo.png&quot;},{&quot;text&quot;:&quot;gnome-settings-daemon&quot;,&quot;href&quot;:&quot;/GNOME/gnome-settings-daemon&quot;,&quot;avatarPath&quot;:&quot;/uploads/-/system/project/avatar/664/logo.png&quot;},{&quot;text&quot;:&quot;Issues&quot;,&quot;href&quot;:&quot;/GNOME/gnome-settings-daemon/-/issues&quot;,&quot;avatarPath&quot;:null},{&quot;text&quot;:&quot;#780&quot;,&quot;href&quot;:&quot;/GNOME/gnome-settings-daemon/-/issues/780&quot;,&quot;avatarPath&quot;:null}]" id="js-vue-page-breadcrumbs"></div>
<div id="js-injected-page-breadcrumbs"></div>
</div>


</div>
<div class="gl-flex-none gl-flex gl-items-center gl-justify-center">
<div id="js-advanced-search-modal"></div>

</div>
<div class="gl-grow gl-basis-0 gl-flex gl-items-center gl-justify-end">
<div id="js-work-item-feedback"></div>


</div>
</div>
</div>

<div class="container-fluid container-limited limit-container-width project-highlight-puc">
<main class="content" id="content-body" itemscope itemtype="http://schema.org/SoftwareSourceCode">
<div class="flash-container flash-container-page sticky" data-testid="flash-container">
<div id="js-global-alerts"></div>
</div>







<div class="issue-details issuable-details js-issue-details">
<div class="detail-page-description content-block js-detail-page-description gl-pt-3 gl-pb-0 gl-border-none">
<div data-header-actions-data="{&quot;can_create_issue&quot;:&quot;true&quot;,&quot;can_create_incident&quot;:&quot;false&quot;,&quot;can_destroy_issue&quot;:&quot;false&quot;,&quot;can_reopen_issue&quot;:&quot;false&quot;,&quot;can_report_spam&quot;:&quot;&quot;,&quot;can_update_issue&quot;:&quot;false&quot;,&quot;is_issue_author&quot;:&quot;false&quot;,&quot;issue_path&quot;:&quot;/GNOME/gnome-settings-daemon/-/issues/780&quot;,&quot;new_issue_path&quot;:&quot;/GNOME/gnome-settings-daemon/-/issues/new?add_related_issue=780&quot;,&quot;project_path&quot;:&quot;GNOME/gnome-settings-daemon&quot;,&quot;report_abuse_path&quot;:&quot;/-/abuse_reports/add_category&quot;,&quot;reported_user_id&quot;:39851,&quot;reported_from_url&quot;:&quot;https://gitlab.gnome.org/GNOME/gnome-settings-daemon/-/issues/780&quot;,&quot;submit_as_spam_path&quot;:&quot;/GNOME/gnome-settings-daemon/-/issues/780/mark_as_spam&quot;,&quot;issuable_email_address&quot;:null}" data-initial="{&quot;endpoint&quot;:&quot;/GNOME/gnome-settings-daemon/-/issues/780&quot;,&quot;updateEndpoint&quot;:&quot;/GNOME/gnome-settings-daemon/-/issues/780.json&quot;,&quot;canUpdate&quot;:false,&quot;canDestroy&quot;:false,&quot;issuableRef&quot;:&quot;#780&quot;,&quot;imported&quot;:false,&quot;markdownPreviewPath&quot;:&quot;/GNOME/gnome-settings-daemon/-/preview_markdown?target_id=780\u0026target_type=Issue&quot;,&quot;markdownDocsPath&quot;:&quot;/help/user/markdown.md&quot;,&quot;lockVersion&quot;:1,&quot;issuableTemplateNamesPath&quot;:&quot;/GNOME/gnome-settings-daemon/description_templates/names/issue&quot;,&quot;initialTitleHtml&quot;:&quot;New Security Issue: USBGuard and device spoofing&quot;,&quot;initialTitleText&quot;:&quot;New Security Issue: USBGuard and device spoofing&quot;,&quot;initialDescriptionHtml&quot;:&quot;\u003cp data-sourcepos=\&quot;1:1-1:80\&quot; dir=\&quot;auto\&quot;\u003eOriginal reporter: \u003ca data-sourcepos=\&quot;1:20-1:80\&quot; href=\&quot;mailto:michael.fincham@pulsesecurity.co.nz\&quot;\u003eMichael Fincham\u003c/a\u003e\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;3:1-3:43\&quot; dir=\&quot;auto\&quot;\u003eArea: Platform component (libraries, tools)\u003c/p\u003e\u0026#x000A;\u003ch2 data-sourcepos=\&quot;5:1-5:10\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003ca id=\&quot;user-content-message\&quot; class=\&quot;anchor\&quot; href=\&quot;#message\&quot; aria-hidden=\&quot;true\&quot;\u003e\u003c/a\u003eMessage\u003c/h2\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;7:1-7:18\&quot; dir=\&quot;auto\&quot;\u003eHi Gnome security,\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;9:1-9:91\&quot; dir=\&quot;auto\&quot;\u003eWe&#39;ve discovered a security issue affecting the Gnome Settings Daemon USBGuard integration.\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;11:1-11:211\&quot; dir=\&quot;auto\&quot;\u003eAs implemented, regardless of the level of protection applied (either \&quot;Always\&quot; or \&quot;Lockscreen\&quot;), GSD allows all USB devices with a class of 0x03 (HID) or 0x09 (Hub). This code is in gsd-usb-protection-manager.c:\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;13:1-13:143\&quot; dir=\&quot;auto\&quot;\u003e\u003ca href=\&quot;https://gitlab.gnome.org/GNOME/gnome-settings-daemon/-/blob/master/plugins/usb-protection/gsd-usb-protection-manager.c?ref_type=heads#L472-L473\&quot;\u003ehttps://gitlab.gnome.org/GNOME/gnome-settings-daemon/-/blob/master/plugins/usb-protection/gsd-usb-protection-manager.c?ref_type=heads#L472-L473\u003c/a\u003e\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;15:1-15:662\&quot; dir=\&quot;auto\&quot;\u003eThis implementation causes GSD to allow all USB devices that present a hub or HID device class to be authorized and then handled by the kernel. The kernel does not strictly validate that the USB device class matches the actual device, instead matching the device based on its PID and VID after failing to probe it with the hub or HID drivers. A device may claim to be a hub or HID but actually implement mass storage or a number of other device types and the kernel will load the relevant module and communicate with the device. This allows bypassing Gnome&#39;s USB protection and attacking the kernel over USB for a significant number of USB driver kernel modules.\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;17:1-17:334\&quot; dir=\&quot;auto\&quot;\u003eWe have demonstrated this using a Linux USB mass storage device gadget on a PocketCHIP patched to present either the HID or hub USB classes. When the GSD USB protection level was set to \&quot;Always\&quot; or \&quot;Lockscreen\&quot; and the USB gadget connected the volume presented over USB was still auto-mounted by Gnome, effectively bypassing USBGuard.\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;19:1-19:194\&quot; dir=\&quot;auto\&quot;\u003eThe following short screencast shows a demonstration against Debian Bookworm running Gnome 3.43, however the current Gnome GitLab repository for GSD seems as though it would still be vulnerable:\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;21:1-21:106\&quot; dir=\&quot;auto\&quot;\u003e\u003ca href=\&quot;https://pulsesec-static-a.s3.ap-southeast-2.amazonaws.com/a3a73b73e9a8e3e4e69f870a55c1b2ce-gnome/demo.webm\&quot; rel=\&quot;nofollow noreferrer noopener\&quot; target=\&quot;_blank\&quot;\u003ehttps://pulsesec-static-a.s3.ap-southeast-2.amazonaws.com/a3a73b73e9a8e3e4e69f870a55c1b2ce-gnome/demo.webm\u003c/a\u003e\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;23:1-23:295\&quot; dir=\&quot;auto\&quot;\u003eWe were further able to present a raw USB gadget as a Yurex device and a USB CAN bus adapter and cause the relevant Linux kernel modules to be loaded, including the creation of a can0 network device in the latter case. Many other modules could be loaded and interacted with over USB in this way.\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;25:1-25:180\&quot; dir=\&quot;auto\&quot;\u003eBare USBGuard is not affected by this vulnerability when policy rules are in place that explicity specify allowed VIDs and PIDs. A sample USBGuard rule that would be vulnerable is:\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;27:1-27:38\&quot; dir=\&quot;auto\&quot;\u003eallow with-interface equals { 03:\u003cem data-sourcepos=\&quot;27:34-27:36\&quot;\u003e:\u003c/em\u003e }\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;29:1-29:165\&quot; dir=\&quot;auto\&quot;\u003eWe intend to publish a blog post about this vulnerability soon. Are you able to advise on a public disclosure timeline that would be acceptable to the Gnome project?\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;31:1-31:131\&quot; dir=\&quot;auto\&quot;\u003eAt this stage a CVE has not been applied for, but we would welcome Gnome undertaking this and advising a CVE number for this issue.\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;33:1-33:76\&quot; dir=\&quot;auto\&quot;\u003eLet me know if you have any questions or would like further PoC information.\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;35:1-38:23\&quot; dir=\&quot;auto\&quot;\u003eThanks,\u0026#x000A;Michael Fincham\u0026#x000A;Pulse Security\u0026#x000A;\u003ca href=\&quot;http://www.pulsesecurity.co.nz\&quot; rel=\&quot;nofollow noreferrer noopener\&quot; target=\&quot;_blank\&quot;\u003ewww.pulsesecurity.co.nz\u003c/a\u003e\u003c/p\u003e&quot;,&quot;initialDescriptionText&quot;:&quot;Original reporter: [Michael Fincham](mailto:michael.fincham@pulsesecurity.co.nz)\n\nArea: Platform component (libraries, tools)\n\n## Message\n\nHi Gnome security,\n\nWe&#39;ve discovered a security issue affecting the Gnome Settings Daemon USBGuard integration.\n\nAs implemented, regardless of the level of protection applied (either \&quot;Always\&quot; or \&quot;Lockscreen\&quot;), GSD allows all USB devices with a class of 0x03 (HID) or 0x09 (Hub). This code is in gsd-usb-protection-manager.c:\n\nhttps://gitlab.gnome.org/GNOME/gnome-settings-daemon/-/blob/master/plugins/usb-protection/gsd-usb-protection-manager.c?ref_type=heads#L472-L473\n\nThis implementation causes GSD to allow all USB devices that present a hub or HID device class to be authorized and then handled by the kernel. The kernel does not strictly validate that the USB device class matches the actual device, instead matching the device based on its PID and VID after failing to probe it with the hub or HID drivers. A device may claim to be a hub or HID but actually implement mass storage or a number of other device types and the kernel will load the relevant module and communicate with the device. This allows bypassing Gnome&#39;s USB protection and attacking the kernel over USB for a significant number of USB driver kernel modules.\n\nWe have demonstrated this using a Linux USB mass storage device gadget on a PocketCHIP patched to present either the HID or hub USB classes. When the GSD USB protection level was set to \&quot;Always\&quot; or \&quot;Lockscreen\&quot; and the USB gadget connected the volume presented over USB was still auto-mounted by Gnome, effectively bypassing USBGuard.\n\nThe following short screencast shows a demonstration against Debian Bookworm running Gnome 3.43, however the current Gnome GitLab repository for GSD seems as though it would still be vulnerable:\n\nhttps://pulsesec-static-a.s3.ap-southeast-2.amazonaws.com/a3a73b73e9a8e3e4e69f870a55c1b2ce-gnome/demo.webm\n\nWe were further able to present a raw USB gadget as a Yurex device and a USB CAN bus adapter and cause the relevant Linux kernel modules to be loaded, including the creation of a can0 network device in the latter case. Many other modules could be loaded and interacted with over USB in this way.\n\nBare USBGuard is not affected by this vulnerability when policy rules are in place that explicity specify allowed VIDs and PIDs. A sample USBGuard rule that would be vulnerable is:\n\nallow with-interface equals { 03:*:* }\n\nWe intend to publish a blog post about this vulnerability soon. Are you able to advise on a public disclosure timeline that would be acceptable to the Gnome project?\n\nAt this stage a CVE has not been applied for, but we would welcome Gnome undertaking this and advising a CVE number for this issue.\n\nLet me know if you have any questions or would like further PoC information.\n\nThanks,\nMichael Fincham\nPulse Security\nwww.pulsesecurity.co.nz&quot;,&quot;initialTaskCompletionStatus&quot;:{&quot;count&quot;:0,&quot;completed_count&quot;:0},&quot;canCreateIncident&quot;:false,&quot;fullPath&quot;:&quot;GNOME/gnome-settings-daemon&quot;,&quot;iid&quot;:780,&quot;issuableId&quot;:195250,&quot;issueType&quot;:&quot;issue&quot;,&quot;isHidden&quot;:false,&quot;zoomMeetingUrl&quot;:null,&quot;authorId&quot;:39851,&quot;authorName&quot;:&quot;GitLab Support Bot&quot;,&quot;authorUsername&quot;:&quot;support-bot&quot;,&quot;authorWebUrl&quot;:&quot;/support-bot&quot;,&quot;createdAt&quot;:&quot;2024-02-26T02:07:20+00:00&quot;,&quot;isFirstContribution&quot;:false,&quot;serviceDeskReplyTo&quot;:&quot;mi*****@p*****.n**&quot;,&quot;registerPath&quot;:&quot;/users/sign_up?redirect_to_referer=yes&quot;,&quot;signInPath&quot;:&quot;/users/sign_in?redirect_to_referer=yes&quot;,&quot;projectPath&quot;:&quot;gnome-settings-daemon&quot;,&quot;projectId&quot;:664,&quot;projectNamespace&quot;:&quot;GNOME&quot;}" id="js-issuable-app">
<div class="title-container">
<h1 class="gl-heading-1 !gl-m-0">New Security Issue: USBGuard and device spoofing</h1>
</div>
<div class="description">
<div class="md"><p data-sourcepos="1:1-1:80" dir="auto">Original reporter: <a data-sourcepos="1:20-1:80" href="mailto:michael.fincham@pulsesecurity.co.nz">Michael Fincham</a></p>&#x000A;<p data-sourcepos="3:1-3:43" dir="auto">Area: Platform component (libraries, tools)</p>&#x000A;<h2 data-sourcepos="5:1-5:10" dir="auto">&#x000A;<a id="user-content-message" class="anchor" href="#message" aria-hidden="true"></a>Message</h2>&#x000A;<p data-sourcepos="7:1-7:18" dir="auto">Hi Gnome security,</p>&#x000A;<p data-sourcepos="9:1-9:91" dir="auto">We've discovered a security issue affecting the Gnome Settings Daemon USBGuard integration.</p>&#x000A;<p data-sourcepos="11:1-11:211" dir="auto">As implemented, regardless of the level of protection applied (either "Always" or "Lockscreen"), GSD allows all USB devices with a class of 0x03 (HID) or 0x09 (Hub). This code is in gsd-usb-protection-manager.c:</p>&#x000A;<p data-sourcepos="13:1-13:143" dir="auto"><a href="https://gitlab.gnome.org/GNOME/gnome-settings-daemon/-/blob/master/plugins/usb-protection/gsd-usb-protection-manager.c?ref_type=heads#L472-L473">https://gitlab.gnome.org/GNOME/gnome-settings-daemon/-/blob/master/plugins/usb-protection/gsd-usb-protection-manager.c?ref_type=heads#L472-L473</a></p>&#x000A;<p data-sourcepos="15:1-15:662" dir="auto">This implementation causes GSD to allow all USB devices that present a hub or HID device class to be authorized and then handled by the kernel. The kernel does not strictly validate that the USB device class matches the actual device, instead matching the device based on its PID and VID after failing to probe it with the hub or HID drivers. A device may claim to be a hub or HID but actually implement mass storage or a number of other device types and the kernel will load the relevant module and communicate with the device. This allows bypassing Gnome's USB protection and attacking the kernel over USB for a significant number of USB driver kernel modules.</p>&#x000A;<p data-sourcepos="17:1-17:334" dir="auto">We have demonstrated this using a Linux USB mass storage device gadget on a PocketCHIP patched to present either the HID or hub USB classes. When the GSD USB protection level was set to "Always" or "Lockscreen" and the USB gadget connected the volume presented over USB was still auto-mounted by Gnome, effectively bypassing USBGuard.</p>&#x000A;<p data-sourcepos="19:1-19:194" dir="auto">The following short screencast shows a demonstration against Debian Bookworm running Gnome 3.43, however the current Gnome GitLab repository for GSD seems as though it would still be vulnerable:</p>&#x000A;<p data-sourcepos="21:1-21:106" dir="auto"><a href="https://pulsesec-static-a.s3.ap-southeast-2.amazonaws.com/a3a73b73e9a8e3e4e69f870a55c1b2ce-gnome/demo.webm" rel="nofollow noreferrer noopener" target="_blank">https://pulsesec-static-a.s3.ap-southeast-2.amazonaws.com/a3a73b73e9a8e3e4e69f870a55c1b2ce-gnome/demo.webm</a></p>&#x000A;<p data-sourcepos="23:1-23:295" dir="auto">We were further able to present a raw USB gadget as a Yurex device and a USB CAN bus adapter and cause the relevant Linux kernel modules to be loaded, including the creation of a can0 network device in the latter case. Many other modules could be loaded and interacted with over USB in this way.</p>&#x000A;<p data-sourcepos="25:1-25:180" dir="auto">Bare USBGuard is not affected by this vulnerability when policy rules are in place that explicity specify allowed VIDs and PIDs. A sample USBGuard rule that would be vulnerable is:</p>&#x000A;<p data-sourcepos="27:1-27:38" dir="auto">allow with-interface equals { 03:<em data-sourcepos="27:34-27:36">:</em> }</p>&#x000A;<p data-sourcepos="29:1-29:165" dir="auto">We intend to publish a blog post about this vulnerability soon. Are you able to advise on a public disclosure timeline that would be acceptable to the Gnome project?</p>&#x000A;<p data-sourcepos="31:1-31:131" dir="auto">At this stage a CVE has not been applied for, but we would welcome Gnome undertaking this and advising a CVE number for this issue.</p>&#x000A;<p data-sourcepos="33:1-33:76" dir="auto">Let me know if you have any questions or would like further PoC information.</p>&#x000A;<p data-sourcepos="35:1-38:23" dir="auto">Thanks,&#x000A;Michael Fincham&#x000A;Pulse Security&#x000A;<a href="http://www.pulsesecurity.co.nz" rel="nofollow noreferrer noopener" target="_blank">www.pulsesecurity.co.nz</a></p></div>
</div>

</div>
<div class="js-issue-widgets">
<div class="emoji-block emoji-block-sticky">
<div class="row gl-m-0 gl-justify-between">
<div class="js-noteable-awards">
<div class="gl-flex gl-flex-wrap gl-justify-between gl-pt-3">
<div data-can-award-emoji="false" data-path="/api/v4/projects/664/issues/780/award_emoji" data-show-default-award-emojis="true" id="js-vue-awards-block"></div>

</div>

</div>
<div class="new-branch-col gl-font-size-0 gl-my-2">

</div>
</div>
</div>

</div>
</div>
<div class="js-issue-widgets">

<div class="gl-border-solid gl-border-1 gl-border-gray-100 gl-rounded-base gl-mt-5 gl-p-3 gl-text-center">
To upload designs, you'll need to enable LFS and have an admin enable hashed storage. <a href="/help/user/project/issues/design_management.md#prerequisites" target="_blank" rel="noopener noreferrer">More information</a>
</div>

<div class="js-work-item-links-root" data-full-path="GNOME/gnome-settings-daemon" data-issuable-id="195250" data-issuable-iid="780" data-register-path="/users/sign_up?redirect_to_referer=yes" data-sign-in-path="/users/sign_in?redirect_to_referer=yes" data-wi-autocomplete-award-emojis-path="/-/autocomplete/award_emojis" data-wi-can-admin-label="false" data-wi-default-branch="master" data-wi-full-path="GNOME/gnome-settings-daemon" data-wi-group-path="GNOME" data-wi-is-signed-in="false" data-wi-issues-list-path="/GNOME/gnome-settings-daemon/-/issues" data-wi-labels-manage-path="/GNOME/gnome-settings-daemon/-/labels" data-wi-new-comment-template-paths="[{&quot;text&quot;:&quot;Your comment templates&quot;,&quot;href&quot;:&quot;/-/profile/comment_templates&quot;}]" data-wi-register-path="/users/sign_up?redirect_to_referer=yes" data-wi-report-abuse-path="/-/abuse_reports/add_category" data-wi-show-new-issue-link="false" data-wi-sign-in-path="/users/sign_in?redirect_to_referer=yes"></div>


<div class="js-related-issues-root" data-can-add-related-issues="false" data-endpoint="/GNOME/gnome-settings-daemon/-/issues/780/links" data-full-path="GNOME/gnome-settings-daemon" data-has-issue-weights-feature="false" data-has-iterations-feature="false" data-help-path="/help/user/project/issues/related_issues.md" data-is-group="false" data-issuable-type="issue" data-show-categorized-issues="false" data-wi-autocomplete-award-emojis-path="/-/autocomplete/award_emojis" data-wi-can-admin-label="false" data-wi-default-branch="master" data-wi-full-path="GNOME/gnome-settings-daemon" data-wi-group-path="GNOME" data-wi-is-signed-in="false" data-wi-issues-list-path="/GNOME/gnome-settings-daemon/-/issues" data-wi-labels-manage-path="/GNOME/gnome-settings-daemon/-/labels" data-wi-new-comment-template-paths="[{&quot;text&quot;:&quot;Your comment templates&quot;,&quot;href&quot;:&quot;/-/profile/comment_templates&quot;}]" data-wi-register-path="/users/sign_up?redirect_to_referer=yes" data-wi-report-abuse-path="/-/abuse_reports/add_category" data-wi-show-new-issue-link="false" data-wi-sign-in-path="/users/sign_in?redirect_to_referer=yes"></div>

<div data-has-closing-merge-request="false" data-iid="780" data-project-path="GNOME/gnome-settings-daemon" id="js-related-merge-requests"></div>
<div data-url="/GNOME/gnome-settings-daemon/-/issues/780/related_branches" id="related-branches">
</div>
</div>
<div class="js-issue-widgets">
<section class="issuable-discussion js-vue-notes-event">
<div data-can-add-timeline-events="false" data-current-user-data="null" data-new-comment-template-paths="[{&quot;text&quot;:&quot;Your comment templates&quot;,&quot;href&quot;:&quot;/-/profile/comment_templates&quot;}]" data-noteable-data="{&quot;id&quot;:195250,&quot;iid&quot;:780,&quot;description&quot;:&quot;Original reporter: [Michael Fincham](mailto:michael.fincham@pulsesecurity.co.nz)\n\nArea: Platform component (libraries, tools)\n\n## Message\n\nHi Gnome security,\n\nWe&#39;ve discovered a security issue affecting the Gnome Settings Daemon USBGuard integration.\n\nAs implemented, regardless of the level of protection applied (either \&quot;Always\&quot; or \&quot;Lockscreen\&quot;), GSD allows all USB devices with a class of 0x03 (HID) or 0x09 (Hub). This code is in gsd-usb-protection-manager.c:\n\nhttps://gitlab.gnome.org/GNOME/gnome-settings-daemon/-/blob/master/plugins/usb-protection/gsd-usb-protection-manager.c?ref_type=heads#L472-L473\n\nThis implementation causes GSD to allow all USB devices that present a hub or HID device class to be authorized and then handled by the kernel. The kernel does not strictly validate that the USB device class matches the actual device, instead matching the device based on its PID and VID after failing to probe it with the hub or HID drivers. A device may claim to be a hub or HID but actually implement mass storage or a number of other device types and the kernel will load the relevant module and communicate with the device. This allows bypassing Gnome&#39;s USB protection and attacking the kernel over USB for a significant number of USB driver kernel modules.\n\nWe have demonstrated this using a Linux USB mass storage device gadget on a PocketCHIP patched to present either the HID or hub USB classes. When the GSD USB protection level was set to \&quot;Always\&quot; or \&quot;Lockscreen\&quot; and the USB gadget connected the volume presented over USB was still auto-mounted by Gnome, effectively bypassing USBGuard.\n\nThe following short screencast shows a demonstration against Debian Bookworm running Gnome 3.43, however the current Gnome GitLab repository for GSD seems as though it would still be vulnerable:\n\nhttps://pulsesec-static-a.s3.ap-southeast-2.amazonaws.com/a3a73b73e9a8e3e4e69f870a55c1b2ce-gnome/demo.webm\n\nWe were further able to present a raw USB gadget as a Yurex device and a USB CAN bus adapter and cause the relevant Linux kernel modules to be loaded, including the creation of a can0 network device in the latter case. Many other modules could be loaded and interacted with over USB in this way.\n\nBare USBGuard is not affected by this vulnerability when policy rules are in place that explicity specify allowed VIDs and PIDs. A sample USBGuard rule that would be vulnerable is:\n\nallow with-interface equals { 03:*:* }\n\nWe intend to publish a blog post about this vulnerability soon. Are you able to advise on a public disclosure timeline that would be acceptable to the Gnome project?\n\nAt this stage a CVE has not been applied for, but we would welcome Gnome undertaking this and advising a CVE number for this issue.\n\nLet me know if you have any questions or would like further PoC information.\n\nThanks,\nMichael Fincham\nPulse Security\nwww.pulsesecurity.co.nz&quot;,&quot;title&quot;:&quot;New Security Issue: USBGuard and device spoofing&quot;,&quot;time_estimate&quot;:0,&quot;total_time_spent&quot;:0,&quot;human_time_estimate&quot;:null,&quot;human_total_time_spent&quot;:null,&quot;state&quot;:&quot;opened&quot;,&quot;milestone_id&quot;:null,&quot;updated_by_id&quot;:20,&quot;created_at&quot;:&quot;2024-02-26T02:07:20Z&quot;,&quot;updated_at&quot;:&quot;2024-12-23T17:52:32Z&quot;,&quot;milestone&quot;:null,&quot;labels&quot;:[{&quot;id&quot;:330,&quot;title&quot;:&quot;1. Security&quot;,&quot;color&quot;:&quot;#ccc063&quot;,&quot;description&quot;:&quot;Security, privacy or safety issues&quot;,&quot;text_color&quot;:&quot;#1F1E24&quot;,&quot;created_at&quot;:&quot;2017-10-18T10:15:04.167Z&quot;,&quot;updated_at&quot;:&quot;2017-10-18T16:35:03.428Z&quot;,&quot;group_id&quot;:8,&quot;project_id&quot;:null,&quot;template&quot;:false}],&quot;lock_version&quot;:1,&quot;author_id&quot;:39851,&quot;confidential&quot;:false,&quot;discussion_locked&quot;:null,&quot;assignees&quot;:[],&quot;due_date&quot;:null,&quot;project_id&quot;:664,&quot;moved_to_id&quot;:null,&quot;duplicated_to_id&quot;:null,&quot;web_url&quot;:&quot;/GNOME/gnome-settings-daemon/-/issues/780&quot;,&quot;current_user&quot;:{&quot;can_create_note&quot;:false,&quot;can_create_confidential_note&quot;:false,&quot;can_update&quot;:false,&quot;can_set_issue_metadata&quot;:false,&quot;can_award_emoji&quot;:false},&quot;create_note_path&quot;:&quot;/GNOME/gnome-settings-daemon/notes?target_id=195250\u0026target_type=issue&quot;,&quot;preview_note_path&quot;:&quot;/GNOME/gnome-settings-daemon/-/preview_markdown?target_id=780\u0026target_type=Issue&quot;,&quot;is_project_archived&quot;:false,&quot;issue_email_participants&quot;:[{&quot;email&quot;:&quot;mi*****@p*****.n**&quot;}],&quot;type&quot;:&quot;ISSUE&quot;}" data-noteable-type="Issue" data-notes-data="{&quot;noteableType&quot;:&quot;issue&quot;,&quot;noteableId&quot;:195250,&quot;projectId&quot;:664,&quot;groupId&quot;:null,&quot;discussionsPath&quot;:&quot;/GNOME/gnome-settings-daemon/-/issues/780/discussions.json&quot;,&quot;registerPath&quot;:&quot;/users/sign_up?redirect_to_referer=yes&quot;,&quot;newSessionPath&quot;:&quot;/users/sign_in?redirect_to_referer=yes&quot;,&quot;markdownDocsPath&quot;:&quot;/help/user/markdown.md&quot;,&quot;quickActionsDocsPath&quot;:&quot;/help/user/project/quick_actions.md&quot;,&quot;closePath&quot;:&quot;/GNOME/gnome-settings-daemon/-/issues/780.json?issue%5Bstate_event%5D=close&quot;,&quot;reopenPath&quot;:&quot;/GNOME/gnome-settings-daemon/-/issues/780.json?issue%5Bstate_event%5D=reopen&quot;,&quot;notesPath&quot;:&quot;/GNOME/gnome-settings-daemon/noteable/issue/195250/notes&quot;,&quot;prerenderedNotesCount&quot;:10,&quot;lastFetchedAt&quot;:1736553508000000,&quot;notesFilter&quot;:null}" data-notes-filters="{&quot;Show all activity&quot;:0,&quot;Show comments only&quot;:1,&quot;Show history only&quot;:2}" data-report-abuse-path="/-/abuse_reports/add_category" data-show-timeline-view-toggle="false" data-target-type="issue" id="js-vue-notes"></div>
</section>

</div>
</div>
<aside aria-label="issue" aria-live="polite" class="right-sidebar js-right-sidebar js-issuable-sidebar right-sidebar-expanded" data-always-show-toggle data-auto-collapse data-issuable-type="issue">
<div class="issuable-sidebar">
<div class="issuable-sidebar-header">
<button class="gl-button btn btn-md btn-default gutter-toggle gl-float-right js-sidebar-toggle has-tooltip !gl-shadow-none gl-block " type="button" aria-label="Toggle sidebar" title="Collapse sidebar" data-container="body" data-placement="left" data-boundary="viewport" type="button"><span class="gl-button-text">
<span class="js-sidebar-toggle-container gl-button-text" data-is-expanded="true"><svg class="s16 js-sidebar-expand hidden" data-testid="chevron-double-lg-left-icon"><use href="/assets/icons-8791a66659d025e0a4c801978c79a1fbd82db1d27d85f044a35728ea7cf0ae80.svg#chevron-double-lg-left"></use></svg><svg class="s16 js-sidebar-collapse " data-testid="chevron-double-lg-right-icon"><use href="/assets/icons-8791a66659d025e0a4c801978c79a1fbd82db1d27d85f044a35728ea7cf0ae80.svg#chevron-double-lg-right"></use></svg></span>

</span>

</button></div>
<form class="issuable-context-form inline-update js-issuable-update " action="/GNOME/gnome-settings-daemon/-/issues/780.json" accept-charset="UTF-8" data-remote="true" method="post"><div class="block assignee gl-mt-3" data-testid="assignee-block-container">
<div class="js-sidebar-assignees-root" data-field="issue" data-max-assignees="1">
<div class="title hide-collapsed gl-flex gl-justify-between gl-items-center !gl-mb-0">
<span class="gl-font-bold">Assignee</span>
<span class="gl-spinner-container" role="status"><span aria-hidden class="gl-spinner gl-spinner-sm gl-spinner-dark !gl-align-text-bottom"></span><span class="gl-sr-only !gl-absolute">Loading</span>
</span>
</div>
</div>

</div>

<div class="js-sidebar-labels-widget-root" data-allow-label-create="" data-allow-scoped-labels="" data-can-edit="" data-iid="780" data-issuable-type="issue" data-labels-fetch-path="/GNOME/gnome-settings-daemon/-/labels.json?include_ancestor_groups=true" data-labels-manage-path="/GNOME/gnome-settings-daemon/-/labels" data-project-issues-path="/GNOME/gnome-settings-daemon/-/issues" data-project-path="GNOME/gnome-settings-daemon" data-selected-labels="[{&quot;id&quot;:330,&quot;title&quot;:&quot;1. Security&quot;,&quot;color&quot;:&quot;#ccc063&quot;,&quot;description&quot;:&quot;Security, privacy or safety issues&quot;,&quot;text_color&quot;:&quot;#1F1E24&quot;,&quot;created_at&quot;:&quot;2017-10-18T10:15:04.167Z&quot;,&quot;updated_at&quot;:&quot;2017-10-18T16:35:03.428Z&quot;,&quot;group_id&quot;:8,&quot;project_id&quot;:null,&quot;template&quot;:false}]"></div>
<div class="block milestone" data-testid="sidebar-milestones">
<div class="js-sidebar-milestone-widget-root" data-can-edit="" data-issue-iid="780" data-project-path="GNOME/gnome-settings-daemon"></div>
</div>

<div class="js-sidebar-due-date-widget-root"></div>
<div class="js-sidebar-time-tracking-root block">
<!-- / Fallback while content is loading -->
<div class="title hide-collapsed gl-flex gl-justify-between gl-items-center !gl-mb-0">
<span class="gl-font-bold">Time tracking</span>
<span class="gl-spinner-container" role="status"><span aria-hidden class="gl-spinner gl-spinner-sm gl-spinner-dark !gl-align-text-bottom"></span><span class="gl-sr-only !gl-absolute">Loading</span>
</span>
</div>
</div>
<script id="js-confidential-issue-data" type="application/json">{"is_confidential":false,"is_editable":null}</script>
<div class="js-sidebar-confidential-widget-root"></div>

<div class="js-sidebar-participants-widget-root"></div>
</form><script class="js-sidebar-options" type="application/json">{"endpoint":"/GNOME/gnome-settings-daemon/-/issues/780.json?serializer=sidebar_extras","toggleSubscriptionEndpoint":"/GNOME/gnome-settings-daemon/-/issues/780/toggle_subscription","moveIssueEndpoint":"/GNOME/gnome-settings-daemon/-/issues/780/move","projectsAutocompleteEndpoint":"/-/autocomplete/projects?project_id=664","editable":"","currentUser":{},"rootPath":"/","fullPath":"GNOME/gnome-settings-daemon","iid":780,"id":195250,"severity":"unknown","timeTrackingLimitToHours":false,"canCreateTimelogs":null,"createNoteEmail":null,"issuableType":"issue","directlyInviteMembers":"false"}</script>
</div>
</aside>



</main>
</div>


</div>
</div>


<script>
//<![CDATA[
if ('loading' in HTMLImageElement.prototype) {
  document.querySelectorAll('img.lazy').forEach(img => {
    img.loading = 'lazy';
    let imgUrl = img.dataset.src;
    // Only adding width + height for avatars for now
    if (imgUrl.indexOf('/avatar/') > -1 && imgUrl.indexOf('?') === -1) {
      const targetWidth = img.getAttribute('width') || img.width;
      imgUrl += `?width=${targetWidth}`;
    }
    img.src = imgUrl;
    img.removeAttribute('data-src');
    img.classList.remove('lazy');
    img.classList.add('js-lazy-loaded');
    img.dataset.testid = 'js-lazy-loaded-content';
  });
}

//]]>
</script>
<script>
//<![CDATA[
gl = window.gl || {};
gl.experiments = {};


//]]>
</script>

</body>
</html>

