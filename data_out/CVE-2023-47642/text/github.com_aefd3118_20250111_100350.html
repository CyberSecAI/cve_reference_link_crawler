
[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fzulip%2Fzulip%2Fcommit%2F6336322d2f9bbccaacfc80cba83a3c62eefd5737)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fzulip%2Fzulip%2Fcommit%2F6336322d2f9bbccaacfc80cba83a3c62eefd5737)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=zulip%2Fzulip)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[zulip](/zulip)
/
**[zulip](/zulip/zulip)**
Public

* [Notifications](/login?return_to=%2Fzulip%2Fzulip) You must be signed in to change notification settings
* [Fork
  8.1k](/login?return_to=%2Fzulip%2Fzulip)
* [Star
   21.9k](/login?return_to=%2Fzulip%2Fzulip)

* [Code](/zulip/zulip)
* [Issues
  1.6k](/zulip/zulip/issues)
* [Pull requests
  872](/zulip/zulip/pulls)
* [Actions](/zulip/zulip/actions)
* [Projects
  2](/zulip/zulip/projects)
* [Security](/zulip/zulip/security)
* [Insights](/zulip/zulip/pulse)

Additional navigation options

* [Code](/zulip/zulip)
* [Issues](/zulip/zulip/issues)
* [Pull requests](/zulip/zulip/pulls)
* [Actions](/zulip/zulip/actions)
* [Projects](/zulip/zulip/projects)
* [Security](/zulip/zulip/security)
* [Insights](/zulip/zulip/pulse)

## Commit

[Permalink](/zulip/zulip/commit/6336322d2f9bbccaacfc80cba83a3c62eefd5737)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

CVE-2023-47642: Invalid metadata access for formerly subscribed streams.

[Browse files](/zulip/zulip/tree/6336322d2f9bbccaacfc80cba83a3c62eefd5737)
Browse the repository at this point in the history

```
It was discovered by the Zulip development team that active users who
had previously been subscribed to a stream incorrectly continued being
able to use the Zulip API to access metadata for that stream. As a
result, users who had been removed from a stream, but still had an
account in the organization, could still view metadata for that
stream (including the stream name, description, settings, and an email
address used to send emails into the stream via the incoming email
integration). This potentially allowed users to see changes to a
stream’s metadata after they had lost access to the stream.

This bug was present in all Zulip releases prior to today's Zulip
Server 7.5.
```

* Loading branch information

[![@sahil839](https://avatars.githubusercontent.com/u/35494118?s=40&v=4)](/sahil839) [![@alexmv](https://avatars.githubusercontent.com/u/28347?s=40&v=4)](/alexmv)

[sahil839](/zulip/zulip/commits?author=sahil839 "View all commits by sahil839")
authored and
[alexmv](/zulip/zulip/commits?author=alexmv "View all commits by alexmv")
committed
Nov 16, 2023

1 parent
[6e11984](/zulip/zulip/commit/6e119842bd7eb722342fea5563ecc1c1820c4362)

commit 6336322

 Show file tree

 Hide file tree

Showing
**4 changed files**
with
**136 additions**
and
**24 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* zerver

  + actions

    - zerver/actions/streams.py
      [streams.py](#diff-945213715bbf7f62741e80dbd3f5482e5145fc9f76ace2b870719d6234208633)
  + lib

    - zerver/lib/events.py
      [events.py](#diff-281435c9530a781f0c30611dd87dd2f859a8ba812048ca59fecc0b515a27ebb6)
    - zerver/lib/subscription\_info.py
      [subscription\_info.py](#diff-641dcbed325ff59fa6948bc83d2af0ce19ad545bb18b6ff206915615b70329ff)
  + tests

    - zerver/tests/test\_subs.py
      [test\_subs.py](#diff-700e48fae89da13e8a8efa5bcc79f0cea59ee83f0581de6e11fb5e3b0666bbbe)

## There are no files selected for viewing

15 changes: 4 additions & 11 deletions

15
[zerver/actions/streams.py](#diff-945213715bbf7f62741e80dbd3f5482e5145fc9f76ace2b870719d6234208633 "zerver/actions/streams.py")

Show comments

[View file](/zulip/zulip/blob/6336322d2f9bbccaacfc80cba83a3c62eefd5737/zerver/actions/streams.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -1028,21 +1028,14 @@ def do\_change\_stream\_permission( |
|  |  | if old\_invite\_only\_value and not stream.invite\_only: |
|  |  | # We need to send stream creation event to users who can access the |
|  |  | # stream now but were not able to do so previously. So, we can exclude |
|  |  | # subscribers, users who were previously subscribed to the stream and |
|  |  | # realm admins from the non-guest user list. |
|  |  | assert stream.recipient\_id is not None |
|  |  | previously\_subscribed\_user\_ids = Subscription.objects.filter( |
|  |  | recipient\_id=stream.recipient\_id, active=False, is\_user\_active=True |
|  |  | ).values\_list("user\_profile\_id", flat=True) |
|  |  | # subscribers and realm admins from the non-guest user list. |
|  |  | stream\_subscriber\_user\_ids = get\_active\_subscriptions\_for\_stream\_id( |
|  |  | stream.id, include\_deactivated\_users=False |
|  |  | ).values\_list("user\_profile\_id", flat=True) |
|  |  |  |
|  |  | old\_can\_access\_stream\_user\_ids = ( |
|  |  | set(stream\_subscriber\_user\_ids) |
|  |  | | set(previously\_subscribed\_user\_ids) |
|  |  | | {user.id for user in stream.realm.get\_admin\_users\_and\_bots()} |
|  |  | ) |
|  |  | old\_can\_access\_stream\_user\_ids = set(stream\_subscriber\_user\_ids) | { |
|  |  | user.id for user in stream.realm.get\_admin\_users\_and\_bots() |
|  |  | } |
|  |  | non\_guest\_user\_ids = set(active\_non\_guest\_user\_ids(stream.realm\_id)) |
|  |  | notify\_stream\_creation\_ids = non\_guest\_user\_ids - old\_can\_access\_stream\_user\_ids |
|  |  | send\_stream\_creation\_event(stream, list(notify\_stream\_creation\_ids)) |
| Expand Down | |  |

50 changes: 42 additions & 8 deletions

50
[zerver/lib/events.py](#diff-281435c9530a781f0c30611dd87dd2f859a8ba812048ca59fecc0b515a27ebb6 "zerver/lib/events.py")

Show comments

[View file](/zulip/zulip/blob/6336322d2f9bbccaacfc80cba83a3c62eefd5737/zerver/lib/events.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -45,7 +45,11 @@ |
|  |  | from zerver.lib.sounds import get\_available\_notification\_sounds |
|  |  | from zerver.lib.stream\_subscription import handle\_stream\_notifications\_compatibility |
|  |  | from zerver.lib.streams import do\_get\_streams, get\_web\_public\_streams |
|  |  | from zerver.lib.subscription\_info import gather\_subscriptions\_helper, get\_web\_public\_subs |
|  |  | from zerver.lib.subscription\_info import ( |
|  |  | build\_unsubscribed\_sub\_from\_stream\_dict, |
|  |  | gather\_subscriptions\_helper, |
|  |  | get\_web\_public\_subs, |
|  |  | ) |
|  |  | from zerver.lib.timestamp import datetime\_to\_timestamp |
|  |  | from zerver.lib.timezone import canonicalize\_timezone |
|  |  | from zerver.lib.topic import TOPIC\_NAME |
| Expand All | | @@ -61,7 +65,9 @@ |
|  |  | Message, |
|  |  | Realm, |
|  |  | RealmUserDefault, |
|  |  | Recipient, |
|  |  | Stream, |
|  |  | Subscription, |
|  |  | UserMessage, |
|  |  | UserProfile, |
|  |  | UserStatus, |
| Expand Down  Expand Up | | @@ -1001,17 +1007,45 @@ def \_draft\_update\_action(i: int) -> None: |
|  |  | if include\_subscribers: |
|  |  | stream\_data["subscribers"] = [] |
|  |  |  |
|  |  | # We know the stream has no traffic, and this |
|  |  | # field is not present in the event. |
|  |  | # |
|  |  | # TODO: Probably this should just be added to the event. |
|  |  | stream\_data["stream\_weekly\_traffic"] = None |
|  |  | # Here we need to query the database to check whether the |
|  |  | # user was previously subscribed. If they were, we need to |
|  |  | # include the stream in the unsubscribed list after adding |
|  |  | # personal subscription metadata (such as configured stream |
|  |  | # color; most of the other personal setting have no effect |
|  |  | # when not subscribed). |
|  |  | unsubscribed\_stream\_sub = Subscription.objects.filter( |
|  |  | user\_profile=user\_profile, |
|  |  | recipient\_\_type\_id=stream["stream\_id"], |
|  |  | recipient\_\_type=Recipient.STREAM, |
|  |  | ).values( |
|  |  | \*Subscription.API\_FIELDS, |
|  |  | "recipient\_id", |
|  |  | "active", |
|  |  | ) |
|  |  |  |
|  |  | if len(unsubscribed\_stream\_sub) == 1: |
|  |  | unsubscribed\_stream\_dict = build\_unsubscribed\_sub\_from\_stream\_dict( |
|  |  | user\_profile, unsubscribed\_stream\_sub[0], stream\_data |
|  |  | ) |
|  |  | if include\_subscribers: |
|  |  | unsubscribed\_stream\_dict["subscribers"] = [] |
|  |  |  |
|  |  | # The stream might have traffic, but we do not have the |
|  |  | # data to compute it in the event, so we just set to |
|  |  | # "None" here like we would do for newly created streams. |
|  |  | # |
|  |  | # TODO: Probably this should just be added to the event. |
|  |  | unsubscribed\_stream\_dict["stream\_weekly\_traffic"] = None |
|  |  | state["unsubscribed"].append(unsubscribed\_stream\_dict) |
|  |  | else: |
|  |  | assert len(unsubscribed\_stream\_sub) == 0 |
|  |  | stream\_data["stream\_weekly\_traffic"] = None |
|  |  | state["never\_subscribed"].append(stream\_data) |
|  |  |  |
|  |  | # Add stream to never\_subscribed (if not invite\_only) |
|  |  | state["never\_subscribed"].append(stream\_data) |
|  |  | if "streams" in state: |
|  |  | state["streams"].append(stream) |
|  |  |  |
|  |  | state["unsubscribed"].sort(key=lambda elt: elt["name"]) |
|  |  | state["never\_subscribed"].sort(key=lambda elt: elt["name"]) |
|  |  | if "streams" in state: |
|  |  | state["streams"].sort(key=lambda elt: elt["name"]) |
| Expand Down | |  |

56 changes: 54 additions & 2 deletions

56
[zerver/lib/subscription\_info.py](#diff-641dcbed325ff59fa6948bc83d2af0ce19ad545bb18b6ff206915615b70329ff "zerver/lib/subscription_info.py")

Show comments

[View file](/zulip/zulip/blob/6336322d2f9bbccaacfc80cba83a3c62eefd5737/zerver/lib/subscription_info.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -16,8 +16,9 @@ |
|  |  | ) |
|  |  | from zerver.lib.stream\_traffic import get\_average\_weekly\_stream\_traffic, get\_streams\_traffic |
|  |  | from zerver.lib.streams import get\_web\_public\_streams\_queryset, subscribed\_to\_stream |
|  |  | from zerver.lib.timestamp import datetime\_to\_timestamp |
|  |  | from zerver.lib.timestamp import datetime\_to\_timestamp, timestamp\_to\_datetime |
|  |  | from zerver.lib.types import ( |
|  |  | APIStreamDict, |
|  |  | NeverSubscribedStreamDict, |
|  |  | RawStreamDict, |
|  |  | RawSubscriptionDict, |
| Expand Down  Expand Up | | @@ -102,6 +103,34 @@ def get\_next\_color() -> str: |
|  |  | ) |
|  |  |  |
|  |  |  |
|  |  | def build\_unsubscribed\_sub\_from\_stream\_dict( |
|  |  | user: UserProfile, sub\_dict: RawSubscriptionDict, stream\_dict: APIStreamDict |
|  |  | ) -> SubscriptionStreamDict: |
|  |  | # This function is only called from `apply\_event` code. |
|  |  | raw\_stream\_dict = RawStreamDict( |
|  |  | can\_remove\_subscribers\_group\_id=stream\_dict["can\_remove\_subscribers\_group\_id"], |
|  |  | date\_created=timestamp\_to\_datetime(stream\_dict["date\_created"]), |
|  |  | description=stream\_dict["description"], |
|  |  | first\_message\_id=stream\_dict["first\_message\_id"], |
|  |  | history\_public\_to\_subscribers=stream\_dict["history\_public\_to\_subscribers"], |
|  |  | invite\_only=stream\_dict["invite\_only"], |
|  |  | is\_web\_public=stream\_dict["is\_web\_public"], |
|  |  | message\_retention\_days=stream\_dict["message\_retention\_days"], |
|  |  | name=stream\_dict["name"], |
|  |  | rendered\_description=stream\_dict["rendered\_description"], |
|  |  | id=stream\_dict["stream\_id"], |
|  |  | stream\_post\_policy=stream\_dict["stream\_post\_policy"], |
|  |  | ) |
|  |  |  |
|  |  | # We pass recent\_traffic as an empty objecy and avoid extra database |
|  |  | # query since we would just set it to None later. |
|  |  | subscription\_stream\_dict = build\_stream\_dict\_for\_sub( |
|  |  | user, sub\_dict, raw\_stream\_dict, recent\_traffic={} |
|  |  | ) |
|  |  |  |
|  |  | return subscription\_stream\_dict |
|  |  |  |
|  |  |  |
|  |  | def build\_stream\_dict\_for\_sub( |
|  |  | user: UserProfile, |
|  |  | sub\_dict: RawSubscriptionDict, |
| Expand Down  Expand Up | | @@ -378,6 +407,21 @@ def get\_subscribers\_query( |
|  |  | return get\_active\_subscriptions\_for\_stream\_id(stream.id, include\_deactivated\_users=False) |
|  |  |  |
|  |  |  |
|  |  | def has\_metadata\_access\_to\_previously\_subscribed\_stream( |
|  |  | user\_profile: UserProfile, stream\_dict: SubscriptionStreamDict |
|  |  | ) -> bool: |
|  |  | if stream\_dict["is\_web\_public"]: |
|  |  | return True |
|  |  |  |
|  |  | if not user\_profile.can\_access\_public\_streams(): |
|  |  | return False |
|  |  |  |
|  |  | if stream\_dict["invite\_only"]: |
|  |  | return user\_profile.is\_realm\_admin |
|  |  |  |
|  |  | return True |
|  |  |  |
|  |  |  |
|  |  | # In general, it's better to avoid using .values() because it makes |
|  |  | # the code pretty ugly, but in this case, it has significant |
|  |  | # performance impact for loading / for users with large numbers of |
| Expand Down  Expand Up | | @@ -445,7 +489,15 @@ def get\_stream\_id(sub\_dict: RawSubscriptionDict) -> int: |
|  |  | if is\_active: |
|  |  | subscribed.append(stream\_dict) |
|  |  | else: |
|  |  | unsubscribed.append(stream\_dict) |
|  |  | if has\_metadata\_access\_to\_previously\_subscribed\_stream(user\_profile, stream\_dict): |
|  |  | """ |
|  |  | User who are no longer subscribed to a stream that they don't have |
|  |  | metadata access to will not receive metadata related to this stream |
|  |  | and their clients will see it as an unkown stream if referenced |
|  |  | somewhere (e.g. a markdown stream link), just like they would see |
|  |  | a reference to a private stream they had never been subscribed to. |
|  |  | """ |
|  |  | unsubscribed.append(stream\_dict) |
|  |  |  |
|  |  | if user\_profile.can\_access\_public\_streams(): |
|  |  | never\_subscribed\_stream\_ids = set(all\_streams\_map) - sub\_unsub\_stream\_ids |
| Expand Down | |  |

39 changes: 36 additions & 3 deletions

39
[zerver/tests/test\_subs.py](#diff-700e48fae89da13e8a8efa5bcc79f0cea59ee83f0581de6e11fb5e3b0666bbbe "zerver/tests/test_subs.py")

Show comments

[View file](/zulip/zulip/blob/6336322d2f9bbccaacfc80cba83a3c62eefd5737/zerver/tests/test_subs.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -6135,14 +6135,47 @@ def test\_previously\_subscribed\_private\_streams(self) -> None: |
|  |  | sub\_data = gather\_subscriptions\_helper(non\_admin\_user) |
|  |  | self.verify\_sub\_fields(sub\_data) |
|  |  | unsubscribed\_streams = sub\_data.unsubscribed |
|  |  | self.assert\_length(unsubscribed\_streams, 1) |
|  |  | self.assertEqual(unsubscribed\_streams[0]["subscribers"], []) |
|  |  | self.assert\_length(unsubscribed\_streams, 0) |
|  |  |  |
|  |  | sub\_data = gather\_subscriptions\_helper(guest\_user) |
|  |  | self.verify\_sub\_fields(sub\_data) |
|  |  | unsubscribed\_streams = sub\_data.unsubscribed |
|  |  | self.assert\_length(unsubscribed\_streams, 0) |
|  |  |  |
|  |  | def test\_previously\_subscribed\_public\_streams(self) -> None: |
|  |  | public\_stream\_name = "public\_stream" |
|  |  | web\_public\_stream\_name = "web\_public\_stream" |
|  |  | guest\_user = self.example\_user("polonius") |
|  |  | member\_user = self.example\_user("hamlet") |
|  |  |  |
|  |  | self.make\_stream(public\_stream\_name, realm=get\_realm("zulip")) |
|  |  | self.make\_stream(web\_public\_stream\_name, realm=get\_realm("zulip"), is\_web\_public=True) |
|  |  |  |
|  |  | for stream\_name in [public\_stream\_name, web\_public\_stream\_name]: |
|  |  | self.subscribe(guest\_user, stream\_name) |
|  |  | self.subscribe(member\_user, stream\_name) |
|  |  | self.subscribe(self.example\_user("othello"), stream\_name) |
|  |  |  |
|  |  | for stream\_name in [public\_stream\_name, web\_public\_stream\_name]: |
|  |  | self.unsubscribe(guest\_user, stream\_name) |
|  |  | self.unsubscribe(member\_user, stream\_name) |
|  |  |  |
|  |  | # Test member user gets previously subscribed public stream and its subscribers. |
|  |  | sub\_data = gather\_subscriptions\_helper(member\_user) |
|  |  | self.verify\_sub\_fields(sub\_data) |
|  |  | unsubscribed\_streams = sub\_data.unsubscribed |
|  |  | self.assert\_length(unsubscribed\_streams, 2) |
|  |  | self.assert\_length(unsubscribed\_streams[0]["subscribers"], 1) |
|  |  | self.assert\_length(unsubscribed\_streams[1]["subscribers"], 1) |
|  |  |  |
|  |  | # Test guest users cannot get previously subscribed public stream but can get |
|  |  | # web-public stream and its subscribers. |
|  |  | sub\_data = gather\_subscriptions\_helper(guest\_user) |
|  |  | self.verify\_sub\_fields(sub\_data) |
|  |  | unsubscribed\_streams = sub\_data.unsubscribed |
|  |  | self.assert\_length(unsubscribed\_streams, 1) |
|  |  | self.assertEqual(unsubscribed\_streams[0]["subscribers"], []) |
|  |  | self.assertEqual(unsubscribed\_streams[0]["is\_web\_public"], True) |
|  |  | self.assert\_length(unsubscribed\_streams[0]["subscribers"], 1) |
|  |  |  |
|  |  | def test\_gather\_subscriptions\_mit(self) -> None: |
|  |  | """ |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `6336322`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fzulip%2Fzulip%2Fcommit%2F6336322d2f9bbccaacfc80cba83a3c62eefd5737) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.

