<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>oss-security - CVE-2017-16231: PCRE 8.41 match() stack overflow; CVE-2017-16232: LibTIFF 4.0.8 memory leaks</title>

<link href="/style.css" type="text/css" rel="stylesheet">
<style type="text/css">
.calendar { text-align: center; }
.ccell { background: #ccc; width: 5ex; padding: 2px; }

.cal_brief { text-align: center; }
.cal_brief td:first-child { background: inherit; }
.cal_brief td { background: #ccc; width: 5ex; padding: 2px; }
.cal_big { text-align: center; padding: 0; margin: 0; }
.cal_big td { padding: 0 2px; }
.cal_mon { text-align: center; }
.cal_mon th { font-size: small; padding: 0; margin: 0; }
.cal_mon td { background: #ccc; width: 5ex; height: 1.5em;
	padding: 2px; text-align: right; }
.cal_mon td[colspan] { background: inherit; }
.cal_mon sup { color: #F0F0F0; text-align: left; float: left;
	margin-top: -2pt; font-weight: bold; }
.cal_mon a { text-align: right; margin-left: -4em; float: right; }
</style>
</head>

<BODY bgcolor="#E0E0E0" text="black" link="blue" alink="red" vlink="navy">


<table bgcolor="#ffffff" width="100%" border="0" cellspacing="0" cellpadding="0">
<tr>

<td>
<a href="/"><img class="logo" src="/logo.png" border="0" width="182" height="80" alt="Openwall"></a>
<td width="100%">
<div class="nav">
<ul>
<li><a href="/">Products</a>
<ul>
<li><a href="/Owl/">Openwall GNU/*/Linux &nbsp; <i>server OS</i></a>
<li><a href="/lkrg/">Linux Kernel Runtime Guard</a>
<li><a href="/john/">John the Ripper &nbsp; <i>password cracker</i></a>
<ul>
<li><a href="/john/">Free &amp; Open Source for any platform</a>
<li><a href="/john/cloud/">in the cloud</a>
<li><a href="/john/pro/linux/">Pro for Linux</a>
<li><a href="/john/pro/macosx/">Pro for macOS</a>
</ul>
<li><a href="/wordlists/">Wordlists &nbsp; <i>for password cracking</i></a>
<li><a href="/passwdqc/">passwdqc &nbsp; <i>policy enforcement</i></a>
<ul>
<li><a href="/passwdqc/">Free &amp; Open Source for Unix</a>
<li><a href="/passwdqc/windows/">Pro for Windows (Active Directory)</a>
</ul>
<li><a href="/yescrypt/">yescrypt &nbsp; <i>KDF &amp; password hashing</i></a>
<li><a href="/yespower/">yespower &nbsp; <i>Proof-of-Work (PoW)</i></a>
<li><a href="/crypt/">crypt_blowfish &nbsp; <i>password hashing</i></a>
<li><a href="/phpass/">phpass &nbsp; <i>ditto in PHP</i></a>
<li><a href="/tcb/">tcb &nbsp; <i>better password shadowing</i></a>
<li><a href="/pam/">Pluggable Authentication Modules</a>
<li><a href="/scanlogd/">scanlogd &nbsp; <i>port scan detector</i></a>
<li><a href="/popa3d/">popa3d &nbsp; <i>tiny POP3 daemon</i></a>
<li><a href="/blists/">blists &nbsp; <i>web interface to mailing lists</i></a>
<li><a href="/msulogin/">msulogin &nbsp; <i>single user mode login</i></a>
<li><a href="/php_mt_seed/">php_mt_seed &nbsp; <i>mt_rand() cracker</i></a>
</ul>
<li><a href="/services/">Services</a>
<li id="narrow-li-1"><a>Publications</a>
<ul>
<li><a href="/articles/">Articles</a>
<li><a href="/presentations/">Presentations</a>
</ul>
<li><a>Resources</a>
<ul>
<li><a href="/lists/">Mailing lists</a>
<li><a href="https://openwall.info/wiki/">Community wiki</a>
<li><a href="https://github.com/openwall">Source code repositories (GitHub)</a>
<li><a href="https://cvsweb.openwall.com">Source code repositories (CVSweb)</a>
<li><a href="/mirrors/">File archive &amp; mirrors</a>
<li><a href="/signatures/">How to verify digital signatures</a>
<li><a href="/ove/">OVE IDs</a>
</ul>
<li id="last-li"><a href="/news">What's new</a>
</ul>
</div>


</table>


<TABLE bgcolor="#B4D0DC" width="100%" border="0" cellspacing="0" cellpadding="1">
<TR><TD>
<TABLE width="100%" border="0" cellspacing="0" cellpadding="2">
<TR><TD bgcolor="#ECF8FF">
<a href="https://hashsuite.openwall.net">
Hash Suite - Windows password security audit tool. GUI, reports in PDF.</a>

</TABLE>
</TABLE>

<a href="2">[&lt;prev]</a> <a href="4">[next&gt;]</a> <a href="7">[thread-next&gt;]</a> <a href=".">[day]</a> <a href="..">[month]</a> <a href="../..">[year]</a> <a href="../../..">[list]</a>
<pre style="white-space: pre-wrap">
Message-ID: &lt;tencent_C577451864B1690107062CD83581D6BE5708&#64;qq.com&gt;
Date: Wed, 1 Nov 2017 10:26:56 +0800
From: "旺仔" &lt;16362505&#64;...com&gt;
To: "oss-security" &lt;oss-security&#64;...ts.openwall.com&gt;
Subject: CVE-2017-16231: PCRE 8.41 match() stack overflow; CVE-2017-16232: LibTIFF 4.0.8 memory leaks

------------------ Original ------------------
From:  "cve-request"&lt;cve-request&#64;...re.org&gt;;
Date:  Mon, Oct 30, 2017 08:36 PM
To:  "zhangjw"&lt;zhangjw&#64;...t.org.cn&gt;; 
Cc:  "cve-request"&lt;cve-request&#64;...re.org&gt;; 
Subject:  Re: [scr412063] PCRE; LibTIFF

 
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

The two CVE IDs are below. Please note that CVE can cover a memory
leak within a library (such as any file in the tiff-4.0.8/libtiff
subdirectory), but cannot cover a memory leak in a command-line
program. Therefore, please omit reports about a memory leak affecting
tools/tiff2bw.c or a different tools/*.c file.


&gt; [Suggested description]
&gt; In PCRE 8.41,
&gt; after compiling, a pcretest load test PoC produces a crash overflow
&gt; in the function match() in pcre_exec.c because of a self-recursive call.
&gt; 
&gt; ------------------------------------------
&gt; 
&gt; [Vulnerability Type]
&gt; Buffer Overflow
&gt; 
&gt; ------------------------------------------
&gt; 
&gt; [Vendor of Product]
&gt; Perl Compatible Regular Expressions
&gt; 
&gt; ------------------------------------------
&gt; 
&gt; [Affected Product Code Base]
&gt; PCRE - 8.41
&gt; 
&gt; ------------------------------------------
&gt; 
&gt; [Affected Component]
&gt; file:pcre_exec.c
&gt; function match() line 983 and line 2061
&gt; 
&gt; ------------------------------------------
&gt; 
&gt; [Attack Type]
&gt; Local
&gt; 
&gt; ------------------------------------------
&gt; 
&gt; [Impact Denial of Service]
&gt; true
&gt; 
&gt; ------------------------------------------
&gt; 
&gt; [Attack Vectors]
&gt; A crash file
&gt; 
&gt; ------------------------------------------
&gt; 
&gt; [Discoverer]
&gt; ZHANG JIAWANG from cncert

Use CVE-2017-16231.


&gt; [Suggested description]
&gt; LibTIFF 4.0.8 has multiple memory leak vulnerabilities, which allow
&gt; attackers to cause a denial of service (memory consumption), as demonstrated
&gt; by tif_open.c, tif_lzw.c, and tif_aux.c
&gt; 
&gt; ------------------------------------------
&gt; 
&gt; [Additional Information]
&gt; /tiff2bw ../../../../libtiff_4.0.8_afl/2bw_output/crashes/poc.tif 222.tif
&gt; LZWDecode: Not enough data at scanline 0 (short 6442443006 bytes).
&gt; /usr/local/bin/llvm-symbolizer: /lib/x86_64-linux-gnu/libtinfo.so.5: no version information available (required by /usr/local/bin/llvm-symbolizer)
&gt; 
&gt; =================================================================
&gt; ==25328==ERROR: LeakSanitizer: detected memory leaks
&gt; 
&gt; Direct leak of 6442451106 byte(s) in 1 object(s) allocated from:
&gt;     #0 0x4bbfd3 in __interceptor_malloc /home/brian/final/llvm.src/projects/compiler-rt/lib/asan/asan_malloc_linux.cc:67:3
&gt;     #1 0x4e88be in main /home/zzt/Fuzzing/Victims/ASAN/tiff-4.0.8/tools/tiff2bw.c:258:28
&gt;     #2 0x7f293f0fdabf in __libc_start_main /build/glibc-qbmteM/glibc-2.21/csu/libc-start.c:289
&gt; 
&gt; Direct leak of 1137 byte(s) in 1 object(s) allocated from:
&gt;     #0 0x4bbfd3 in __interceptor_malloc /home/brian/final/llvm.src/projects/compiler-rt/lib/asan/asan_malloc_linux.cc:67:3
&gt;     #1 0x54d6b6 in TIFFClientOpen /home/zzt/Fuzzing/Victims/tiff-4.0.8/libtiff/tif_open.c:119
&gt; 
&gt; Indirect leak of 81904 byte(s) in 1 object(s) allocated from:
&gt;     #0 0x4bbfd3 in __interceptor_malloc /home/brian/final/llvm.src/projects/compiler-rt/lib/asan/asan_malloc_linux.cc:67:3
&gt;     #1 0x5ea2e9 in LZWSetupDecode /home/zzt/Fuzzing/Victims/tiff-4.0.8/libtiff/tif_lzw.c:232
&gt; 
&gt; Indirect leak of 2273 byte(s) in 5 object(s) allocated from:
&gt;     #0 0x4bc3d7 in realloc /home/brian/final/llvm.src/projects/compiler-rt/lib/asan/asan_malloc_linux.cc:98:3
&gt;     #1 0x56f5db in _TIFFCheckRealloc /home/zzt/Fuzzing/Victims/tiff-4.0.8/libtiff/tif_aux.c:73
&gt;     #2 0x56f5db in _TIFFCheckMalloc /home/zzt/Fuzzing/Victims/tiff-4.0.8/libtiff/tif_aux.c:88
&gt; 
&gt; Indirect leak of 1240 byte(s) in 2 object(s) allocated from:
&gt;     #0 0x4bc3d7 in realloc /home/brian/final/llvm.src/projects/compiler-rt/lib/asan/asan_malloc_linux.cc:98:3
&gt;     #1 0x56f430 in _TIFFCheckRealloc /home/zzt/Fuzzing/Victims/tiff-4.0.8/libtiff/tif_aux.c:73
&gt; 
&gt; ------------------------------------------
&gt; 
&gt; [Vendor of Product]
&gt; TIFF Library and Utilities
&gt; 
&gt; ------------------------------------------
&gt; 
&gt; [Affected Product Code Base]
&gt; LibTIFF tiff2bw - 4.0.8
&gt; 
&gt; ------------------------------------------
&gt; 
&gt; [Affected Component]
&gt; multi memory leak vulnerabilities in files as tiff2bw.c tif_open.c and so on
&gt; 
&gt; ------------------------------------------
&gt; 
&gt; [Attack Type]
&gt; Local
&gt; 
&gt; ------------------------------------------
&gt; 
&gt; [Impact Denial of Service]
&gt; true
&gt; 
&gt; ------------------------------------------
&gt; 
&gt; [Attack Vectors]
&gt; to open a poc file
&gt; 
&gt; ------------------------------------------
&gt; 
&gt; [Discoverer]
&gt; ZHANG JIAWANG from cncert

Use CVE-2017-16232.


- -- 
CVE Assignment Team
M/S M300, 202 Burlington Road, Bedford, MA 01730 USA
[ A PGP key is available for encrypted communications at
  <a href="http://cve.mitre.org/cve/request_id.html" rel="nofollow">http://cve.mitre.org/cve/request_id.html</a> ]
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1

iQIcBAEBCAAGBQJZ9xyjAAoJEHb/MwWLVhi2UroP/28YC8ygYKkoMyb161Vf4KWR
31U5G6fhAy4vogtjc17NQOcAxFElc1hopqgdSBjzsfFKJHhpAlegs5mn7oyMtUfS
UoiC92LuiasCi9h2/AS+CBqbh2ZleTpWChvqxjgGM/WFvUJ3jpSexErUrf4x/H+T
ZGhNZE1hCuTEkuUo4Yxu/qWdvtlcZ2N2TanrbntA7XaTiar/C8MGgfVf8YrNaj63
PX/XcGV1sQxUVh9M8hudByvejgzXCYdLcrb4XfeFqZUeki2Qjxa2hJYBRAgKUWKZ
MwMDzQScI/rKMgsEmPeWrLqw88kiyFIl/V65YY8NYsZrZS8V92JlJQHWfPw/Rs5W
JtKDwp5eK5X4FEb9OX/Ox1MEU/Hp/mFl3an/0c+kumKz34Jn2T/SErpdfTml/yTN
clTRHbnid3nAlxfI9U7uUszuv8H0rYgV4v4Vsis37K7rS4Kxl2nucUv4T0/9rVtQ
O16piFmIkwNuLfJvipJQXR7F2BOLNgZ3hiIDwfOUNnkEKEcRLyo1Dyyft42WufpR
tL8JyTonMQqNee3lvgmlz/LHBjnCJafyF/2OSyGmIYubpmUbUWkhsshkYRSIyhaQ
/1z7GP7Iez4QkbxhlF+4gxprxtrt+mHbINPRXM4vJQB/RRvvV81DAKjVfoZzeJLM
l9qmqrROzVkGXO9eQLkP
=PcOO
-----END PGP SIGNATURE-----
<span style="font-family: times;"><strong>Content of type "</strong>text/html<strong>" skipped</strong></span>

<span style="font-family: times;"><strong>Download attachment "</strong><a href="3/1" rel="nofollow" download>pcre_poc.txt</a><strong>" of type "</strong>application/octet-stream<strong>" (23850 bytes)</strong></span>

<span style="font-family: times;"><strong>Download attachment "</strong><a href="3/2" rel="nofollow" download>libtiff_poc.tif</a><strong>" of type "</strong>application/octet-stream<strong>" (6684 bytes)</strong></span>
</pre>
<p><a href="https://www.openwall.com/blists/">Powered by blists</a> - <a href="https://lists.openwall.net">more mailing lists</a>


<p>
Please check out the
<a href="https://oss-security.openwall.org/wiki/">
Open Source Software Security Wiki</a>, which is counterpart to this
<a href="https://oss-security.openwall.org/wiki/mailing-lists/oss-security">mailing list</a>.
<p>
Confused about <a href="/lists/">mailing lists</a> and their use?
<a href="https://en.wikipedia.org/wiki/Electronic_mailing_list">Read about mailing lists on Wikipedia</a>
and check out these
<a href="https://www.complang.tuwien.ac.at/anton/mail-news-errors.html">guidelines on proper formatting of your messages</a>.
<p>

</body>
</html>
