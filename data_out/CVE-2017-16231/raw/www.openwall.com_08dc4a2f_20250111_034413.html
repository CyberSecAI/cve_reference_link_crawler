<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>oss-security - Re: CVE-2017-16231: PCRE 8.41 match() stack overflow; CVE-2017-16232: LibTIFF 4.0.8 memory leaks</title>

<link href="/style.css" type="text/css" rel="stylesheet">
<style type="text/css">
.calendar { text-align: center; }
.ccell { background: #ccc; width: 5ex; padding: 2px; }

.cal_brief { text-align: center; }
.cal_brief td:first-child { background: inherit; }
.cal_brief td { background: #ccc; width: 5ex; padding: 2px; }
.cal_big { text-align: center; padding: 0; margin: 0; }
.cal_big td { padding: 0 2px; }
.cal_mon { text-align: center; }
.cal_mon th { font-size: small; padding: 0; margin: 0; }
.cal_mon td { background: #ccc; width: 5ex; height: 1.5em;
	padding: 2px; text-align: right; }
.cal_mon td[colspan] { background: inherit; }
.cal_mon sup { color: #F0F0F0; text-align: left; float: left;
	margin-top: -2pt; font-weight: bold; }
.cal_mon a { text-align: right; margin-left: -4em; float: right; }
</style>
</head>

<BODY bgcolor="#E0E0E0" text="black" link="blue" alink="red" vlink="navy">


<table bgcolor="#ffffff" width="100%" border="0" cellspacing="0" cellpadding="0">
<tr>

<td>
<a href="/"><img class="logo" src="/logo.png" border="0" width="182" height="80" alt="Openwall"></a>
<td width="100%">
<div class="nav">
<ul>
<li><a href="/">Products</a>
<ul>
<li><a href="/Owl/">Openwall GNU/*/Linux &nbsp; <i>server OS</i></a>
<li><a href="/lkrg/">Linux Kernel Runtime Guard</a>
<li><a href="/john/">John the Ripper &nbsp; <i>password cracker</i></a>
<ul>
<li><a href="/john/">Free &amp; Open Source for any platform</a>
<li><a href="/john/cloud/">in the cloud</a>
<li><a href="/john/pro/linux/">Pro for Linux</a>
<li><a href="/john/pro/macosx/">Pro for macOS</a>
</ul>
<li><a href="/wordlists/">Wordlists &nbsp; <i>for password cracking</i></a>
<li><a href="/passwdqc/">passwdqc &nbsp; <i>policy enforcement</i></a>
<ul>
<li><a href="/passwdqc/">Free &amp; Open Source for Unix</a>
<li><a href="/passwdqc/windows/">Pro for Windows (Active Directory)</a>
</ul>
<li><a href="/yescrypt/">yescrypt &nbsp; <i>KDF &amp; password hashing</i></a>
<li><a href="/yespower/">yespower &nbsp; <i>Proof-of-Work (PoW)</i></a>
<li><a href="/crypt/">crypt_blowfish &nbsp; <i>password hashing</i></a>
<li><a href="/phpass/">phpass &nbsp; <i>ditto in PHP</i></a>
<li><a href="/tcb/">tcb &nbsp; <i>better password shadowing</i></a>
<li><a href="/pam/">Pluggable Authentication Modules</a>
<li><a href="/scanlogd/">scanlogd &nbsp; <i>port scan detector</i></a>
<li><a href="/popa3d/">popa3d &nbsp; <i>tiny POP3 daemon</i></a>
<li><a href="/blists/">blists &nbsp; <i>web interface to mailing lists</i></a>
<li><a href="/msulogin/">msulogin &nbsp; <i>single user mode login</i></a>
<li><a href="/php_mt_seed/">php_mt_seed &nbsp; <i>mt_rand() cracker</i></a>
</ul>
<li><a href="/services/">Services</a>
<li id="narrow-li-1"><a>Publications</a>
<ul>
<li><a href="/articles/">Articles</a>
<li><a href="/presentations/">Presentations</a>
</ul>
<li><a>Resources</a>
<ul>
<li><a href="/lists/">Mailing lists</a>
<li><a href="https://openwall.info/wiki/">Community wiki</a>
<li><a href="https://github.com/openwall">Source code repositories (GitHub)</a>
<li><a href="https://cvsweb.openwall.com">Source code repositories (CVSweb)</a>
<li><a href="/mirrors/">File archive &amp; mirrors</a>
<li><a href="/signatures/">How to verify digital signatures</a>
<li><a href="/ove/">OVE IDs</a>
</ul>
<li id="last-li"><a href="/news">What's new</a>
</ul>
</div>


</table>


<TABLE bgcolor="#B4D0DC" width="100%" border="0" cellspacing="0" cellpadding="1">
<TR><TD>
<TABLE width="100%" border="0" cellspacing="0" cellpadding="2">
<TR><TD bgcolor="#ECF8FF">
<a href="https://twitter.com/openwall">
Follow @Openwall on Twitter for new release announcements and other news</a>

</TABLE>
</TABLE>

<a href="10">[&lt;prev]</a> <a href="12">[next&gt;]</a> <a href="8">[&lt;thread-prev]</a> <a href=".">[day]</a> <a href="..">[month]</a> <a href="../..">[year]</a> <a href="../../..">[list]</a>
<pre style="white-space: pre-wrap">
Message-ID: &lt;20171101161136.GA20860&#64;openwall.com&gt;
Date: Wed, 1 Nov 2017 17:11:36 +0100
From: Solar Designer &lt;solar&#64;...nwall.com&gt;
To: oss-security&#64;...ts.openwall.com
Cc: 16362505&#64;...com
Subject: Re: CVE-2017-16231: PCRE 8.41 match() stack overflow; CVE-2017-16232: LibTIFF 4.0.8 memory leaks

On Wed, Nov 01, 2017 at 04:29:32PM +0100, Agostino Sarubbo wrote:
&gt; On mercoled?? 1 novembre 2017 03:26:56 CET ?????? wrote:
&gt; &gt; &gt; [Suggested description]
&gt; &gt; &gt; In PCRE 8.41,
&gt; &gt; &gt; after compiling, a pcretest load test PoC produces a crash overflow
&gt; &gt; &gt; in the function match() in pcre_exec.c because of a self-recursive call.
[...]
&gt; &gt; Use CVE-2017-16231.
&gt; 
&gt; I guess that this bug is similar or the same described here:
&gt; <a href="https://bugs.exim.org/show_bug.cgi?id=2047" rel="nofollow">https://bugs.exim.org/show_bug.cgi?id=2047</a>
&gt; 
&gt; Based on the upstream comment I'd suggest to reject the CVE.

Let's quote that comment in here for discussion and archival:

"Philip Hazel 2017-02-24 15:53:50 GMT

It is very easy to write patterns that have extremely large search
trees, and these can consume a lot of time and/or stack in the current
implementation of pcre2_match(). There are options (*LIMIT_MATCH) and
(*LIMIT_RECURSION) that can be used to limit the amount of stack that is
used. The limits can also be set from pcretest and from programs that
call the library directly. This is all well documented. Fuzzers should
always set these limits much lower than the defaults. See, for example,
the file src/pcre2_fuzzsupport.c in PCRE2.

Also, as I have said several times recently on the list, there will soon
be a new implementation of pcre2_match() that uses heap storage rather
than the stack. The same limits are available to control the amount of
resource used. This should avoid stack overflows, but there will always
be patterns that will take a lot of resources if you don't limit them."

I'm not sure I agree with Philip on this.  Based on the comment above,
this is documented behavior and there are limits in place that a program
could use.  However, the suggestion that "Fuzzers should always set
these limits much lower than the defaults." might mean that the defaults
are inadequate for safe production use as well, if a pattern might be
untrusted.  If fuzzers could hit stack overflow with default limits,
then so could untrusted patterns in production, no?  If so, that would
keep this a security issue, and probably a CVE-worthy one, unless the
documentation also states that only trusted patterns are supported.

Alexander

P.S. The original message arrived to oss-security with a Subject of
"Re: [scr412063] PCRE; LibTIFF" preceded by some probably Chinese
characters.  As a moderator, I edited the Subject to what it currently
is before approving the message.  I regret that the message combines
issues in two unrelated packages, but I never edit message bodies as me
doing so would certainly be too much and potentially inappropriate
(misrepresentation of what someone else posted; even fixing the Subjects
is borderline in that respect).  I can only hope that future postings by
16362505 will be better, given this little note. ;-)
</pre>
<p><a href="https://www.openwall.com/blists/">Powered by blists</a> - <a href="https://lists.openwall.net">more mailing lists</a>


<p>
Please check out the
<a href="https://oss-security.openwall.org/wiki/">
Open Source Software Security Wiki</a>, which is counterpart to this
<a href="https://oss-security.openwall.org/wiki/mailing-lists/oss-security">mailing list</a>.
<p>
Confused about <a href="/lists/">mailing lists</a> and their use?
<a href="https://en.wikipedia.org/wiki/Electronic_mailing_list">Read about mailing lists on Wikipedia</a>
and check out these
<a href="https://www.complang.tuwien.ac.at/anton/mail-news-errors.html">guidelines on proper formatting of your messages</a>.
<p>

</body>
</html>
