=== Content from git.kernel.org_03fb2ec8_20250111_160308.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=02e368eb1444a4af649b73cbe2edd51780511d86)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=02e368eb1444a4af649b73cbe2edd51780511d86)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=02e368eb1444a4af649b73cbe2edd51780511d86)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=02e368eb1444a4af649b73cbe2edd51780511d86)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | John Fastabend <john.fastabend@gmail.com> | 2024-01-12 16:32:57 -0800 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-01-25 15:35:58 -0800 |
| commit | [02e368eb1444a4af649b73cbe2edd51780511d86](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=02e368eb1444a4af649b73cbe2edd51780511d86) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=02e368eb1444a4af649b73cbe2edd51780511d86)) | |
| tree | [88e84528277b0cd01d232a9b11e46debcbb10337](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=02e368eb1444a4af649b73cbe2edd51780511d86) | |
| parent | [7dc290d787ae495c2e91f4ca6bedca666d8c8b8a](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=7dc290d787ae495c2e91f4ca6bedca666d8c8b8a) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=02e368eb1444a4af649b73cbe2edd51780511d86&id2=7dc290d787ae495c2e91f4ca6bedca666d8c8b8a)) | |
| download | [linux-02e368eb1444a4af649b73cbe2edd51780511d86.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-02e368eb1444a4af649b73cbe2edd51780511d86.tar.gz) | |

net: tls, fix WARNIING in \_\_sk\_msg\_free[ Upstream commit dc9dfc8dc629e42f2234e3327b75324ffc752bc9 ]
A splice with MSG\_SPLICE\_PAGES will cause tls code to use the
tls\_sw\_sendmsg\_splice path in the TLS sendmsg code to move the user
provided pages from the msg into the msg\_pl. This will loop over the
msg until msg\_pl is full, checked by sk\_msg\_full(msg\_pl). The user
can also set the MORE flag to hint stack to delay sending until receiving
more pages and ideally a full buffer.
If the user adds more pages to the msg than can fit in the msg\_pl
scatterlist (MAX\_MSG\_FRAGS) we should ignore the MORE flag and send
the buffer anyways.
What actually happens though is we abort the msg to msg\_pl scatterlist
setup and then because we forget to set 'full record' indicating we
can no longer consume data without a send we fallthrough to the 'continue'
path which will check if msg\_data\_left(msg) has more bytes to send and
then attempts to fit them in the already full msg\_pl. Then next
iteration of sender doing send will encounter a full msg\_pl and throw
the warning in the syzbot report.
To fix simply check if we have a full\_record in splice code path and
if not send the msg regardless of MORE flag.
Reported-and-tested-by: syzbot+f2977222e0e95cec15c8@syzkaller.appspotmail.com
Reported-by: Edward Adam Davis <eadavis@qq.com>
Fixes: fe1e81d4f73b ("tls/sw: Support MSG\_SPLICE\_PAGES")
Reviewed-by: Jakub Kicinski <kuba@kernel.org>
Signed-off-by: John Fastabend <john.fastabend@gmail.com>
Signed-off-by: David S. Miller <davem@davemloft.net>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=02e368eb1444a4af649b73cbe2edd51780511d86)

| -rw-r--r-- | [net/tls/tls\_sw.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/net/tls/tls_sw.c?id=02e368eb1444a4af649b73cbe2edd51780511d86) | 6 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 5 insertions, 1 deletions

| diff --git a/net/tls/tls\_sw.c b/net/tls/tls\_sw.cindex 27cc0f0a90e1fd..dba523cdc73da4 100644--- a/[net/tls/tls\_sw.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/tls/tls_sw.c?id=7dc290d787ae495c2e91f4ca6bedca666d8c8b8a)+++ b/[net/tls/tls\_sw.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/tls/tls_sw.c?id=02e368eb1444a4af649b73cbe2edd51780511d86)@@ -1052,7 +1052,11 @@ alloc\_encrypted: if (ret < 0) goto send\_end; tls\_ctx->pending\_open\_record\_frags = true;- if (full\_record || eor || sk\_msg\_full(msg\_pl))++ if (sk\_msg\_full(msg\_pl))+ full\_record = true;++ if (full\_record || eor) goto copied; continue; } |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 16:01:45 +0000



=== Content from git.kernel.org_b95136dd_20250111_160309.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=dc9dfc8dc629e42f2234e3327b75324ffc752bc9)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=dc9dfc8dc629e42f2234e3327b75324ffc752bc9)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=dc9dfc8dc629e42f2234e3327b75324ffc752bc9)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=dc9dfc8dc629e42f2234e3327b75324ffc752bc9)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | John Fastabend <john.fastabend@gmail.com> | 2024-01-12 16:32:57 -0800 |
| --- | --- | --- |
| committer | David S. Miller <davem@davemloft.net> | 2024-01-14 12:17:14 +0000 |
| commit | [dc9dfc8dc629e42f2234e3327b75324ffc752bc9](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=dc9dfc8dc629e42f2234e3327b75324ffc752bc9) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=dc9dfc8dc629e42f2234e3327b75324ffc752bc9)) | |
| tree | [717da531c7a9aa22d9e9c5d053c9008760fc6481](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=dc9dfc8dc629e42f2234e3327b75324ffc752bc9) | |
| parent | [894d7508316e7ad722df597d68b4b1797a9eee11](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=894d7508316e7ad722df597d68b4b1797a9eee11) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=dc9dfc8dc629e42f2234e3327b75324ffc752bc9&id2=894d7508316e7ad722df597d68b4b1797a9eee11)) | |
| download | [linux-dc9dfc8dc629e42f2234e3327b75324ffc752bc9.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-dc9dfc8dc629e42f2234e3327b75324ffc752bc9.tar.gz) | |

net: tls, fix WARNIING in \_\_sk\_msg\_freeA splice with MSG\_SPLICE\_PAGES will cause tls code to use the
tls\_sw\_sendmsg\_splice path in the TLS sendmsg code to move the user
provided pages from the msg into the msg\_pl. This will loop over the
msg until msg\_pl is full, checked by sk\_msg\_full(msg\_pl). The user
can also set the MORE flag to hint stack to delay sending until receiving
more pages and ideally a full buffer.
If the user adds more pages to the msg than can fit in the msg\_pl
scatterlist (MAX\_MSG\_FRAGS) we should ignore the MORE flag and send
the buffer anyways.
What actually happens though is we abort the msg to msg\_pl scatterlist
setup and then because we forget to set 'full record' indicating we
can no longer consume data without a send we fallthrough to the 'continue'
path which will check if msg\_data\_left(msg) has more bytes to send and
then attempts to fit them in the already full msg\_pl. Then next
iteration of sender doing send will encounter a full msg\_pl and throw
the warning in the syzbot report.
To fix simply check if we have a full\_record in splice code path and
if not send the msg regardless of MORE flag.
Reported-and-tested-by: syzbot+f2977222e0e95cec15c8@syzkaller.appspotmail.com
Reported-by: Edward Adam Davis <eadavis@qq.com>
Fixes: fe1e81d4f73b ("tls/sw: Support MSG\_SPLICE\_PAGES")
Reviewed-by: Jakub Kicinski <kuba@kernel.org>
Signed-off-by: John Fastabend <john.fastabend@gmail.com>
Signed-off-by: David S. Miller <davem@davemloft.net>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=dc9dfc8dc629e42f2234e3327b75324ffc752bc9)

| -rw-r--r-- | [net/tls/tls\_sw.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/net/tls/tls_sw.c?id=dc9dfc8dc629e42f2234e3327b75324ffc752bc9) | 6 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 5 insertions, 1 deletions

| diff --git a/net/tls/tls\_sw.c b/net/tls/tls\_sw.cindex e37b4d2e2acde2..31e8a94dfc111b 100644--- a/[net/tls/tls\_sw.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/tls/tls_sw.c?id=894d7508316e7ad722df597d68b4b1797a9eee11)+++ b/[net/tls/tls\_sw.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/tls/tls_sw.c?id=dc9dfc8dc629e42f2234e3327b75324ffc752bc9)@@ -1052,7 +1052,11 @@ alloc\_encrypted: if (ret < 0) goto send\_end; tls\_ctx->pending\_open\_record\_frags = true;- if (full\_record || eor || sk\_msg\_full(msg\_pl))++ if (sk\_msg\_full(msg\_pl))+ full\_record = true;++ if (full\_record || eor) goto copied; continue; } |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 16:01:46 +0000



=== Content from git.kernel.org_d36f343f_20250111_160309.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=294e7ea85f34748f04e5f3f9dba6f6b911d31aa8)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=294e7ea85f34748f04e5f3f9dba6f6b911d31aa8)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=294e7ea85f34748f04e5f3f9dba6f6b911d31aa8)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=294e7ea85f34748f04e5f3f9dba6f6b911d31aa8)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | John Fastabend <john.fastabend@gmail.com> | 2024-01-12 16:32:57 -0800 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-01-25 15:45:28 -0800 |
| commit | [294e7ea85f34748f04e5f3f9dba6f6b911d31aa8](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=294e7ea85f34748f04e5f3f9dba6f6b911d31aa8) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=294e7ea85f34748f04e5f3f9dba6f6b911d31aa8)) | |
| tree | [7898ffa28c02d469404c9fb7ef55fc9d9e4b3c84](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=294e7ea85f34748f04e5f3f9dba6f6b911d31aa8) | |
| parent | [d1d27950cdb92314d4aa2ffc1dbdf36028e7f12d](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=d1d27950cdb92314d4aa2ffc1dbdf36028e7f12d) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=294e7ea85f34748f04e5f3f9dba6f6b911d31aa8&id2=d1d27950cdb92314d4aa2ffc1dbdf36028e7f12d)) | |
| download | [linux-294e7ea85f34748f04e5f3f9dba6f6b911d31aa8.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-294e7ea85f34748f04e5f3f9dba6f6b911d31aa8.tar.gz) | |

net: tls, fix WARNIING in \_\_sk\_msg\_free[ Upstream commit dc9dfc8dc629e42f2234e3327b75324ffc752bc9 ]
A splice with MSG\_SPLICE\_PAGES will cause tls code to use the
tls\_sw\_sendmsg\_splice path in the TLS sendmsg code to move the user
provided pages from the msg into the msg\_pl. This will loop over the
msg until msg\_pl is full, checked by sk\_msg\_full(msg\_pl). The user
can also set the MORE flag to hint stack to delay sending until receiving
more pages and ideally a full buffer.
If the user adds more pages to the msg than can fit in the msg\_pl
scatterlist (MAX\_MSG\_FRAGS) we should ignore the MORE flag and send
the buffer anyways.
What actually happens though is we abort the msg to msg\_pl scatterlist
setup and then because we forget to set 'full record' indicating we
can no longer consume data without a send we fallthrough to the 'continue'
path which will check if msg\_data\_left(msg) has more bytes to send and
then attempts to fit them in the already full msg\_pl. Then next
iteration of sender doing send will encounter a full msg\_pl and throw
the warning in the syzbot report.
To fix simply check if we have a full\_record in splice code path and
if not send the msg regardless of MORE flag.
Reported-and-tested-by: syzbot+f2977222e0e95cec15c8@syzkaller.appspotmail.com
Reported-by: Edward Adam Davis <eadavis@qq.com>
Fixes: fe1e81d4f73b ("tls/sw: Support MSG\_SPLICE\_PAGES")
Reviewed-by: Jakub Kicinski <kuba@kernel.org>
Signed-off-by: John Fastabend <john.fastabend@gmail.com>
Signed-off-by: David S. Miller <davem@davemloft.net>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=294e7ea85f34748f04e5f3f9dba6f6b911d31aa8)

| -rw-r--r-- | [net/tls/tls\_sw.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/net/tls/tls_sw.c?id=294e7ea85f34748f04e5f3f9dba6f6b911d31aa8) | 6 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 5 insertions, 1 deletions

| diff --git a/net/tls/tls\_sw.c b/net/tls/tls\_sw.cindex e37b4d2e2acde2..31e8a94dfc111b 100644--- a/[net/tls/tls\_sw.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/tls/tls_sw.c?id=d1d27950cdb92314d4aa2ffc1dbdf36028e7f12d)+++ b/[net/tls/tls\_sw.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/tls/tls_sw.c?id=294e7ea85f34748f04e5f3f9dba6f6b911d31aa8)@@ -1052,7 +1052,11 @@ alloc\_encrypted: if (ret < 0) goto send\_end; tls\_ctx->pending\_open\_record\_frags = true;- if (full\_record || eor || sk\_msg\_full(msg\_pl))++ if (sk\_msg\_full(msg\_pl))+ full\_record = true;++ if (full\_record || eor) goto copied; continue; } |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 16:01:46 +0000


