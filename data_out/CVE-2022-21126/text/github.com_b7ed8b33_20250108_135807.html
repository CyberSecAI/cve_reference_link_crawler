
[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsamtools%2Fhtsjdk%2Fcommit%2F4a4024a97ee3e87096df6ad9b22c8260bd527772)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsamtools%2Fhtsjdk%2Fcommit%2F4a4024a97ee3e87096df6ad9b22c8260bd527772)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=samtools%2Fhtsjdk)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[samtools](/samtools)
/
**[htsjdk](/samtools/htsjdk)**
Public

* [Notifications](/login?return_to=%2Fsamtools%2Fhtsjdk) You must be signed in to change notification settings
* [Fork
  245](/login?return_to=%2Fsamtools%2Fhtsjdk)
* [Star
   285](/login?return_to=%2Fsamtools%2Fhtsjdk)

* [Code](/samtools/htsjdk)
* [Issues
  266](/samtools/htsjdk/issues)
* [Pull requests
  46](/samtools/htsjdk/pulls)
* [Discussions](/samtools/htsjdk/discussions)
* [Actions](/samtools/htsjdk/actions)
* [Projects
  0](/samtools/htsjdk/projects)
* [Wiki](/samtools/htsjdk/wiki)
* [Security](/samtools/htsjdk/security)
* [Insights](/samtools/htsjdk/pulse)

Additional navigation options

* [Code](/samtools/htsjdk)
* [Issues](/samtools/htsjdk/issues)
* [Pull requests](/samtools/htsjdk/pulls)
* [Discussions](/samtools/htsjdk/discussions)
* [Actions](/samtools/htsjdk/actions)
* [Projects](/samtools/htsjdk/projects)
* [Wiki](/samtools/htsjdk/wiki)
* [Security](/samtools/htsjdk/security)
* [Insights](/samtools/htsjdk/pulse)

## Commit

[Permalink](/samtools/htsjdk/commit/4a4024a97ee3e87096df6ad9b22c8260bd527772)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Fix temporary directory hijacking or temporary directory information …

[Browse files](/samtools/htsjdk/tree/4a4024a97ee3e87096df6ad9b22c8260bd527772)
Browse the repository at this point in the history

```
…disclosure ([#1621](https://github.com/samtools/htsjdk/pull/1621))

This replaces and closes [#1617](https://github.com/samtools/htsjdk/pull/1617).

Fix a vulnerability which allows a malicious user access files created in a temp directory if it was created using IOUtils.createTempDir.
The implementation has been changed to use the more secure Files.createTemporaryDirectory(). This has a side effect of making the second "suffix" argument no longer usable and it is now simply appended to the existing prefix.
Deprecating IOUtils.createTempDir(String, String) and adding a new single argument version instead which returns a Path.

This potentially exposed data created by CoordinateSortedPairInfoMaps on shared systems to a malicious users with access to the global temp directory.

It is recommended that user upgrade if they use CoordinateSortedPairInfoMap or IOUTils.createTempDir() in their code.

* vuln-fix: Temporary Directory Hijacking or Information Disclosure

This fixes either Temporary Directory Hijacking, or Temporary Directory Local Information Disclosure.

Weakness: CWE-379: Creation of Temporary File in Directory with Insecure Permissions
Severity: High
CVSSS: 7.3
Detection: CodeQL & OpenRewrite (<https://public.moderne.io/recipes/org.openrewrite.java.security.UseFilesCreateTempDirectory>)

Reported-by: Jonathan Leitschuh <Jonathan.Leitschuh@gmail.com>
Signed-off-by: Jonathan Leitschuh <Jonathan.Leitschuh@gmail.com>

Bug-tracker: [JLLeitschuh/security-research#10](https://github.com/JLLeitschuh/security-research/issues/10)

Co-authored-by: Jonathan Leitschuh <Jonathan.Leitschuh@gmail.com>
Co-authored-by: Moderne <team@moderne.io>
```

* Loading branch information

[![@lbergelson](https://avatars.githubusercontent.com/u/4700332?s=40&v=4)](/lbergelson) [![@JLLeitschuh](https://avatars.githubusercontent.com/u/1323708?s=40&v=4)](/JLLeitschuh) [![@TeamModerne](https://avatars.githubusercontent.com/u/85364911?s=40&v=4)](/TeamModerne)

3 people

authored
Sep 23, 2022

1 parent
[9fd0ecf](/samtools/htsjdk/commit/9fd0ecf212219d252ab273db0f7b845a59073d64)

commit 4a4024a

 Show file tree

 Hide file tree

Showing
**13 changed files**
with
**41 additions**
and
**33 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* src

  + main/java/htsjdk/samtools

    - src/main/java/htsjdk/samtools/CoordinateSortedPairInfoMap.java
      [CoordinateSortedPairInfoMap.java](#diff-4b6fefcff13e682cf821b88e326649ff06613a013d238e46c326682242951335)
    - util

      * src/main/java/htsjdk/samtools/util/IOUtil.java
        [IOUtil.java](#diff-03ed4833b01400de6f41d7b9db62cc9300ac1488081751f010ffb633ff954e62)
  + test/java/htsjdk

    - samtools

      * src/test/java/htsjdk/samtools/BAMMergerTest.java
        [BAMMergerTest.java](#diff-265bd147324b9cb09227d5308a822e5b6bcb28ed4a52af2a8202c28aa27c9762)
      * src/test/java/htsjdk/samtools/CRAMFileWriterTest.java
        [CRAMFileWriterTest.java](#diff-8276fd2b8b832760e9cb26b05cf182b65af2f294aec29d1a68256bcd1758f9c6)
      * src/test/java/htsjdk/samtools/CRAMMergerTest.java
        [CRAMMergerTest.java](#diff-0f8429d2712d4493af278623417a15173ae4cc7f0f3a5d925b7478cbf8d9c2c1)
      * reference

        + src/test/java/htsjdk/samtools/reference/FastaSequenceIndexCreatorTest.java
          [FastaSequenceIndexCreatorTest.java](#diff-e592132a3218aabf2b4490704e6fe6c548b7df27ae42bdd9d89e35175b0a934b)
      * seekablestream

        + src/test/java/htsjdk/samtools/seekablestream/SeekableStreamFactoryTest.java
          [SeekableStreamFactoryTest.java](#diff-6ac2c09855c37a272a0daea6d26df8c964753a489031c013a68aa44f4379d11e)
      * util

        + src/test/java/htsjdk/samtools/util/IOUtilTest.java
          [IOUtilTest.java](#diff-287f86807f35d6a90b30754c7595b0b54d3e87a3db085e5c2d33abddc9385c90)
    - tribble/index

      * src/test/java/htsjdk/tribble/index/IndexFactoryTest.java
        [IndexFactoryTest.java](#diff-5a3802a9d51339dad82f8a7a39fdcc001b58e22448bc04009da3c0f9b5bbf8f1)
      * src/test/java/htsjdk/tribble/index/IndexTest.java
        [IndexTest.java](#diff-d3172308840c5601c107c57234145711a05cece9cc64ee01384d3dfa9a1b9f04)
      * tabix

        + src/test/java/htsjdk/tribble/index/tabix/TabixIndexTest.java
          [TabixIndexTest.java](#diff-43085fa0b7e83fa07c2ec3b375d09e35fa4e90f96e8815a6657ff5750f8595bd)
    - variant/vcf

      * src/test/java/htsjdk/variant/vcf/VCFFileReaderTest.java
        [VCFFileReaderTest.java](#diff-ea97e5345e03019d6f4224ab91801419956d68c971932d868f9f906d136a1f87)
      * src/test/java/htsjdk/variant/vcf/VCFMergerTest.java
        [VCFMergerTest.java](#diff-702420d3f15dc0ff43c501ce2438a5f2f5d2d14cf1c84a8e60fef9fb2efba533)

## There are no files selected for viewing

2 changes: 1 addition & 1 deletion

2
[src/main/java/htsjdk/samtools/CoordinateSortedPairInfoMap.java](#diff-4b6fefcff13e682cf821b88e326649ff06613a013d238e46c326682242951335 "src/main/java/htsjdk/samtools/CoordinateSortedPairInfoMap.java")

Show comments

[View file](/samtools/htsjdk/blob/4a4024a97ee3e87096df6ad9b22c8260bd527772/src/main/java/htsjdk/samtools/CoordinateSortedPairInfoMap.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -56,7 +56,7 @@ public class CoordinateSortedPairInfoMap<KEY, REC> implements Iterable<Map.Entry |
|  |  | /\*\* |
|  |  | \* directory where files will go |
|  |  | \*/ |
|  |  | private final File workDir = IOUtil.createTempDir("CSPI.", null); |
|  |  | private final File workDir = IOUtil.createTempDir("CSPI.tmp").toFile(); |
|  |  | private int sequenceIndexOfMapInRam = INVALID\_SEQUENCE\_INDEX; |
|  |  | private Map<KEY, REC> mapInRam = null; |
|  |  | private final FileAppendStreamLRUCache outputStreams; |
| Expand Down | |  |

35 changes: 22 additions & 13 deletions

35
[src/main/java/htsjdk/samtools/util/IOUtil.java](#diff-03ed4833b01400de6f41d7b9db62cc9300ac1488081751f010ffb633ff954e62 "src/main/java/htsjdk/samtools/util/IOUtil.java")

100755 → 100644

Show comments

[View file](/samtools/htsjdk/blob/4a4024a97ee3e87096df6ad9b22c8260bd527772/src/main/java/htsjdk/samtools/util/IOUtil.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -974,25 +974,34 @@ public static void copyDirectoryTree(final File fileOrDirectory, final File dest |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Create a temporary subdirectory in the default temporary-file directory, using the given prefix and suffix to generate the name. |
|  |  | \* Create a temporary subdirectory in the default temporary-file directory, using the given prefix and morePrefix to generate the name. |
|  |  | \* Note that this method is not completely safe, because it create a temporary file, deletes it, and then creates |
|  |  | \* a directory with the same name as the file. Should be good enough. |
|  |  | \* |
|  |  | \* @param prefix The prefix string to be used in generating the file's name; must be at least three characters long |
|  |  | \* @param suffix The suffix string to be used in generating the file's name; may be null, in which case the suffix ".tmp" will be used |
|  |  | \* This has been updated to avoid the problem in https://github.com/samtools/htsjdk/pull/1617 |
|  |  | \* |
|  |  | \* @param prefix The prefix string to be used in generating the file's name; |
|  |  | \* @param morePrefix This was previously a suffix but the implementation changed; may be null, in which case the morePrefix ".tmp" will be used |
|  |  | \* @return File object for new directory |
|  |  | \* @deprecated Use {@link #createTempDir(String)} instead. |
|  |  | \* It turns out the mechanism was not "good enough" and caused security issues, the new implementation |
|  |  | \* combines the prefix/morePrefix into a single prefix. The security flaw is fixed but due to the now |
|  |  | \* extraneous morePrefix argument it is recommended to use the 1 argument form. |
|  |  | \*/ |
|  |  | @Deprecated |
|  |  | public static File createTempDir(final String prefix, final String morePrefix) { |
|  |  | final String dotSeparatedSuffix = morePrefix == null ? ".tmp" : morePrefix.startsWith(".") ? morePrefix : "." + morePrefix; |
|  |  | return createTempDir(prefix + dotSeparatedSuffix).toFile() ; |
|  |  | } |
|  |  |  |
|  |  | /\* |
|  |  | \* Create a temporary subdirectory in the default temporary-file directory, using the given prefix and suffix to generate the name. |
|  |  | \* @param prefix The prefix string to be used in generating the file's name, may be null |
|  |  | \*/ |
|  |  | public static File createTempDir(final String prefix, final String suffix) { |
|  |  | public static Path createTempDir(final String prefix) { |
|  |  | try { |
|  |  | final File tmp = File.createTempFile(prefix, suffix); |
|  |  | if (!tmp.delete()) { |
|  |  | throw new SAMException("Could not delete temporary file " + tmp); |
|  |  | } |
|  |  | if (!tmp.mkdir()) { |
|  |  | throw new SAMException("Could not create temporary directory " + tmp); |
|  |  | } |
|  |  | return tmp; |
|  |  | } catch (IOException e) { |
|  |  | return Files.createTempDirectory(prefix); |
|  |  | } catch (final IOException e) { |
|  |  | throw new SAMException("Exception creating temporary directory.", e); |
|  |  | } |
|  |  | } |
| Expand Down | |  |

2 changes: 1 addition & 1 deletion

2
[src/test/java/htsjdk/samtools/BAMMergerTest.java](#diff-265bd147324b9cb09227d5308a822e5b6bcb28ed4a52af2a8202c28aa27c9762 "src/test/java/htsjdk/samtools/BAMMergerTest.java")

Show comments

[View file](/samtools/htsjdk/blob/4a4024a97ee3e87096df6ad9b22c8260bd527772/src/test/java/htsjdk/samtools/BAMMergerTest.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -222,7 +222,7 @@ private static Path textIndexBai(Path bai) { |
|  |  |  |
|  |  | @Test |
|  |  | public void test() throws IOException { |
|  |  | final Path outputDir = IOUtil.createTempDir(this.getClass().getSimpleName() + ".", ".tmp").toPath(); |
|  |  | final Path outputDir = IOUtil.createTempDir(this.getClass().getSimpleName() + ".tmp"); |
|  |  | IOUtil.deleteOnExit(outputDir); |
|  |  |  |
|  |  | final Path outputBam = File.createTempFile(this.getClass().getSimpleName() + ".", ".bam").toPath(); |
| Expand Down | |  |

4 changes: 2 additions & 2 deletions

4
[src/test/java/htsjdk/samtools/CRAMFileWriterTest.java](#diff-8276fd2b8b832760e9cb26b05cf182b65af2f294aec29d1a68256bcd1758f9c6 "src/test/java/htsjdk/samtools/CRAMFileWriterTest.java")

Show comments

[View file](/samtools/htsjdk/blob/4a4024a97ee3e87096df6ad9b22c8260bd527772/src/test/java/htsjdk/samtools/CRAMFileWriterTest.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -271,11 +271,11 @@ public void test\_roundtrip\_tlen\_preserved() throws IOException { |
|  |  | public void test\_roundtrip\_many\_reads() throws IOException { |
|  |  |  |
|  |  | // Create the input file |
|  |  | final File outputDir = IOUtil.createTempDir(this.getClass().getSimpleName() + ".", ".tmp"); |
|  |  | final File outputDir = IOUtil.createTempDir(this.getClass().getSimpleName() + ".tmp").toFile(); |
|  |  | outputDir.deleteOnExit(); |
|  |  | final Path output = new File(outputDir, "input.cram").toPath(); |
|  |  | IOUtil.deleteOnExit(output); |
|  |  | final Path fastaDir = IOUtil.createTempDir("CRAMFileWriterTest", "").toPath(); |
|  |  | final Path fastaDir = IOUtil.createTempDir("CRAMFileWriterTest"); |
|  |  | IOUtil.deleteOnExit(fastaDir); |
|  |  | final Path newFasta = fastaDir.resolve("input.fasta"); |
|  |  | IOUtil.deleteOnExit(newFasta); |
| Expand Down | |  |

2 changes: 1 addition & 1 deletion

2
[src/test/java/htsjdk/samtools/CRAMMergerTest.java](#diff-0f8429d2712d4493af278623417a15173ae4cc7f0f3a5d925b7478cbf8d9c2c1 "src/test/java/htsjdk/samtools/CRAMMergerTest.java")

Show comments

[View file](/samtools/htsjdk/blob/4a4024a97ee3e87096df6ad9b22c8260bd527772/src/test/java/htsjdk/samtools/CRAMMergerTest.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -193,7 +193,7 @@ private static Path indexCram(Path cram, Path crai) throws IOException { |
|  |  |  |
|  |  | @Test |
|  |  | public void test() throws IOException { |
|  |  | final Path outputDir = IOUtil.createTempDir(this.getClass().getSimpleName() + ".", ".tmp").toPath(); |
|  |  | final Path outputDir = IOUtil.createTempDir(this.getClass().getSimpleName() + ".tmp"); |
|  |  | IOUtil.deleteOnExit(outputDir); |
|  |  |  |
|  |  | final Path outputCram = File.createTempFile(this.getClass().getSimpleName() + ".", FileExtensions.CRAM).toPath(); |
| Expand Down | |  |

2 changes: 1 addition & 1 deletion

2
[src/test/java/htsjdk/samtools/reference/FastaSequenceIndexCreatorTest.java](#diff-e592132a3218aabf2b4490704e6fe6c548b7df27ae42bdd9d89e35175b0a934b "src/test/java/htsjdk/samtools/reference/FastaSequenceIndexCreatorTest.java")

Show comments

[View file](/samtools/htsjdk/blob/4a4024a97ee3e87096df6ad9b22c8260bd527772/src/test/java/htsjdk/samtools/reference/FastaSequenceIndexCreatorTest.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -63,7 +63,7 @@ public void testBuildFromFasta(final File indexedFile) throws Exception { |
|  |  | @Test(dataProvider = "indexedSequences") |
|  |  | public void testCreate(final File indexedFile) throws Exception { |
|  |  | // copy the file to index |
|  |  | final File tempDir = IOUtil.createTempDir("FastaSequenceIndexCreatorTest", "testCreate"); |
|  |  | final File tempDir = IOUtil.createTempDir("FastaSequenceIndexCreatorTest.testCreate").toFile(); |
|  |  | final File copied = new File(tempDir, indexedFile.getName()); |
|  |  | copied.deleteOnExit(); |
|  |  | Files.copy(indexedFile.toPath(), copied.toPath()); |
| Expand Down | |  |

2 changes: 1 addition & 1 deletion

2
[src/test/java/htsjdk/samtools/seekablestream/SeekableStreamFactoryTest.java](#diff-6ac2c09855c37a272a0daea6d26df8c964753a489031c013a68aa44f4379d11e "src/test/java/htsjdk/samtools/seekablestream/SeekableStreamFactoryTest.java")

Show comments

[View file](/samtools/htsjdk/blob/4a4024a97ee3e87096df6ad9b22c8260bd527772/src/test/java/htsjdk/samtools/seekablestream/SeekableStreamFactoryTest.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -52,7 +52,7 @@ public void testPathWithEmbeddedSpace() throws IOException { |
|  |  | final File testBam = new File(TEST\_DATA\_DIR, "BAMFileIndexTest/index\_test.bam"); |
|  |  |  |
|  |  | //create a temp dir with a space in the name and copy the test file there |
|  |  | final File tempDir = IOUtil.createTempDir("test spaces", ""); |
|  |  | final File tempDir = IOUtil.createTempDir("test spaces").toFile(); |
|  |  | Assert.assertTrue(tempDir.getAbsolutePath().contains(" ")); |
|  |  | tempDir.deleteOnExit(); |
|  |  | final File inputBam = new File(tempDir, "index\_test.bam"); |
| Expand Down | |  |

11 changes: 5 additions & 6 deletions

11
[src/test/java/htsjdk/samtools/util/IOUtilTest.java](#diff-287f86807f35d6a90b30754c7595b0b54d3e87a3db085e5c2d33abddc9385c90 "src/test/java/htsjdk/samtools/util/IOUtilTest.java")

Show comments

[View file](/samtools/htsjdk/blob/4a4024a97ee3e87096df6ad9b22c8260bd527772/src/test/java/htsjdk/samtools/util/IOUtilTest.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -312,7 +312,7 @@ public void testGetDefaultTmpDirPath() throws Exception { |
|  |  |  |
|  |  | @Test(dataProvider = "fileNamesForDelete") |
|  |  | public void testDeletePathLocal(final List<String> fileNames) throws Exception { |
|  |  | final File tmpDir = IOUtil.createTempDir("testDeletePath", ""); |
|  |  | final Path tmpDir = IOUtil.createTempDir("testDeletePath"); |
|  |  | final List<Path> paths = createLocalFiles(tmpDir, fileNames); |
|  |  | testDeletePaths(paths); |
|  |  | } |
| Expand Down  Expand Up | | @@ -341,7 +341,7 @@ public void testDeletePathJims(final List<String> fileNames) throws Exception { |
|  |  |  |
|  |  | @Test(dataProvider = "fileNamesForDelete") |
|  |  | public void testDeleteArrayPathLocal(final List<String> fileNames) throws Exception { |
|  |  | final File tmpDir = IOUtil.createTempDir("testDeletePath", ""); |
|  |  | final Path tmpDir = IOUtil.createTempDir("testDeletePath"); |
|  |  | final List<Path> paths = createLocalFiles(tmpDir, fileNames); |
|  |  | testDeletePathArray(paths); |
|  |  | } |
| Expand All | | @@ -365,12 +365,11 @@ private static void testDeletePathArray(final List<Path> paths) { |
|  |  | paths.forEach(p -> Assert.assertFalse(Files.exists(p))); |
|  |  | } |
|  |  |  |
|  |  | private static List<Path> createLocalFiles(final File tmpDir, final List<String> fileNames) throws Exception { |
|  |  | private static List<Path> createLocalFiles(final Path tmpDir, final List<String> fileNames) throws Exception { |
|  |  | final List<Path> paths = new ArrayList<>(fileNames.size()); |
|  |  | for (final String f: fileNames) { |
|  |  | final File file = new File(tmpDir, f); |
|  |  | Assert.assertTrue(file.createNewFile(), "failed to create test file" +file); |
|  |  | paths.add(file.toPath()); |
|  |  | final Path file = Files.createFile(tmpDir.resolve(f)); |
|  |  | paths.add(file); |
|  |  | } |
|  |  | return paths; |
|  |  | } |
| Expand Down | |  |

6 changes: 3 additions & 3 deletions

6
[src/test/java/htsjdk/tribble/index/IndexFactoryTest.java](#diff-5a3802a9d51339dad82f8a7a39fdcc001b58e22448bc04009da3c0f9b5bbf8f1 "src/test/java/htsjdk/tribble/index/IndexFactoryTest.java")

Show comments

[View file](/samtools/htsjdk/blob/4a4024a97ee3e87096df6ad9b22c8260bd527772/src/test/java/htsjdk/tribble/index/IndexFactoryTest.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -166,7 +166,7 @@ public void testCreateTabixIndexFromVCF( |
|  |  | final File inputVCF, |
|  |  | final Interval queryInterval) throws IOException { |
|  |  | // copy the original file and create the index for the copy |
|  |  | final File tempDir = IOUtil.createTempDir("testCreateTabixIndexFromVCF", null); |
|  |  | final File tempDir = IOUtil.createTempDir("testCreateTabixIndexFromVCF").toFile(); |
|  |  | tempDir.deleteOnExit(); |
|  |  | final File tmpVCF = new File(tempDir, inputVCF.getName()); |
|  |  | Files.copy(inputVCF, tmpVCF); |
| Expand Down  Expand Up | | @@ -208,7 +208,7 @@ public Object[][] getBCFData(){ |
|  |  | @Test(dataProvider = "bcfDataFactory") |
|  |  | public void testCreateLinearIndexFromBCF(final File inputBCF) throws IOException { |
|  |  | // copy the original file and create the index for the copy |
|  |  | final File tempDir = IOUtil.createTempDir("testCreateIndexFromBCF", null); |
|  |  | final File tempDir = IOUtil.createTempDir("testCreateIndexFromBCF").toFile(); |
|  |  | tempDir.deleteOnExit(); |
|  |  | final File tmpBCF = new File(tempDir, inputBCF.getName()); |
|  |  | Files.copy(inputBCF, tmpBCF); |
| Expand Down  Expand Up | | @@ -250,7 +250,7 @@ public Object[][] getRedirectFiles(){ |
|  |  | @Test(dataProvider = "getRedirectFiles") |
|  |  | public void testIndexRedirectedFiles(String input, IndexFactory.IndexType type) throws IOException { |
|  |  | final VCFRedirectCodec codec = new VCFRedirectCodec(); |
|  |  | final File dir = IOUtil.createTempDir("redirec-test", "dir"); |
|  |  | final File dir = IOUtil.createTempDir("redirec-test.dir").toFile(); |
|  |  | try { |
|  |  | final File tmpInput = new File(dir, new File(input).getName()); |
|  |  | Files.copy(new File(input), tmpInput); |
| Expand Down | |  |

2 changes: 1 addition & 1 deletion

2
[src/test/java/htsjdk/tribble/index/IndexTest.java](#diff-d3172308840c5601c107c57234145711a05cece9cc64ee01384d3dfa9a1b9f04 "src/test/java/htsjdk/tribble/index/IndexTest.java")

Show comments

[View file](/samtools/htsjdk/blob/4a4024a97ee3e87096df6ad9b22c8260bd527772/src/test/java/htsjdk/tribble/index/IndexTest.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -131,7 +131,7 @@ public void testWritePathIndex(final File inputFile, final IndexFactory.IndexTyp |
|  |  |  |
|  |  | @Test(dataProvider = "writeIndexData") |
|  |  | public void testWriteBasedOnNonRegularFeatureFile(final File inputFile, final IndexFactory.IndexType type, final FeatureCodec codec) throws Exception { |
|  |  | final File tmpFolder = IOUtil.createTempDir("NonRegultarFeatureFile", null); |
|  |  | final File tmpFolder = IOUtil.createTempDir("NonRegultarFeatureFile").toFile(); |
|  |  | // create the index |
|  |  | final Index index = IndexFactory.createIndex(inputFile, codec, type); |
|  |  | // try to write based on the tmpFolder |
| Expand Down | |  |

2 changes: 1 addition & 1 deletion

2
[src/test/java/htsjdk/tribble/index/tabix/TabixIndexTest.java](#diff-43085fa0b7e83fa07c2ec3b375d09e35fa4e90f96e8815a6657ff5750f8595bd "src/test/java/htsjdk/tribble/index/tabix/TabixIndexTest.java")

Show comments

[View file](/samtools/htsjdk/blob/4a4024a97ee3e87096df6ad9b22c8260bd527772/src/test/java/htsjdk/tribble/index/tabix/TabixIndexTest.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -190,7 +190,7 @@ public void testBedTabixIndex( |
|  |  | final List<Interval> queryIntervals |
|  |  | ) throws Exception { |
|  |  | // copy the input file and create an index for the copy |
|  |  | final File tempDir = IOUtil.createTempDir("testBedTabixIndex", null); |
|  |  | final File tempDir = IOUtil.createTempDir("testBedTabixIndex.tmp").toFile(); |
|  |  | tempDir.deleteOnExit(); |
|  |  | final File tmpBed = new File(tempDir, inputBed.getName()); |
|  |  | Files.copy(inputBed, tmpBed); |
| Expand Down | |  |

2 changes: 1 addition & 1 deletion

2
[src/test/java/htsjdk/variant/vcf/VCFFileReaderTest.java](#diff-ea97e5345e03019d6f4224ab91801419956d68c971932d868f9f906d136a1f87 "src/test/java/htsjdk/variant/vcf/VCFFileReaderTest.java")

Show comments

[View file](/samtools/htsjdk/blob/4a4024a97ee3e87096df6ad9b22c8260bd527772/src/test/java/htsjdk/variant/vcf/VCFFileReaderTest.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -110,7 +110,7 @@ public void testTabixFileWithEmbeddedSpaces() throws IOException { |
|  |  | // Copy the input files into a temporary directory with embedded spaces in the name. |
|  |  | // This test needs to include the associated .tbi file because we want to force execution |
|  |  | // of the tabix code path. |
|  |  | final File tempDir = IOUtil.createTempDir("test spaces", ""); |
|  |  | final File tempDir = IOUtil.createTempDir("test spaces").toFile(); |
|  |  | Assert.assertTrue(tempDir.getAbsolutePath().contains(" ")); |
|  |  | tempDir.deleteOnExit(); |
|  |  | final File inputVCF = new File(tempDir, "HiSeq.10000.vcf.bgz"); |
| Expand Down | |  |

2 changes: 1 addition & 1 deletion

2
[src/test/java/htsjdk/variant/vcf/VCFMergerTest.java](#diff-702420d3f15dc0ff43c501ce2438a5f2f5d2d14cf1c84a8e60fef9fb2efba533 "src/test/java/htsjdk/variant/vcf/VCFMergerTest.java")

Show comments

[View file](/samtools/htsjdk/blob/4a4024a97ee3e87096df6ad9b22c8260bd527772/src/test/java/htsjdk/variant/vcf/VCFMergerTest.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -206,7 +206,7 @@ private static Path indexVcf(Path vcf, Path tbi) throws IOException { |
|  |  |  |
|  |  | @Test |
|  |  | public void test() throws IOException { |
|  |  | final Path outputDir = IOUtil.createTempDir(this.getClass().getSimpleName() + ".", ".tmp").toPath(); |
|  |  | final Path outputDir = IOUtil.createTempDir(this.getClass().getSimpleName() + ".tmp"); |
|  |  | IOUtil.deleteOnExit(outputDir); |
|  |  |  |
|  |  | final Path outputVcf = File.createTempFile(this.getClass().getSimpleName() + ".", FileExtensions.COMPRESSED\_VCF).toPath(); |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `4a4024a`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsamtools%2Fhtsjdk%2Fcommit%2F4a4024a97ee3e87096df6ad9b22c8260bd527772) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.

