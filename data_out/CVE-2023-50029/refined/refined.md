**Root cause of vulnerability:**
The vulnerability stems from the `M4PDF::saveTemplate()` method in the "M4 PDF Extensions" module, which allows arbitrary PHP code injection due to insufficient input validation and a predictable token protecting the method.

**Weaknesses/vulnerabilities present:**
- **CWE-94:** Improper Control of Generation of Code ('Code Injection').
- Insecure handling of user input in the `saveTemplate()` method.
- Use of a predictable token for protection, which can be easily bypassed.

**Impact of exploitation:**
- Arbitrary PHP code execution on the server.
- Potential for complete system compromise.
- Obtain admin access.
- Data removal from the associated PrestaShop.
- Copy/paste sensitive data from tables to FRONT to expose tokens.
- Hijacking emails by rewriting SMTP settings.
- Deployment of web skimmers to steal credit cards.

**Attack vectors:**
- Network-based attack.
- Exploitation via a trivial HTTP POST request to the vulnerable endpoint.
- The module's controller path can be concealed during exploitation, making it hard to identify in conventional frontend logs, only showing POST / requests.

**Required attacker capabilities/position:**
- The attacker does not require any privileges or user interaction.
- The attacker only needs network access to the vulnerable PrestaShop installation.
- Ability to send a crafted HTTP POST request.