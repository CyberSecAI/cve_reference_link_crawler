=== Content from git.kernel.org_17ddc130_20250111_175501.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=3b4e76ceae5b5a46c968bd952f551ce173809f63)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=3b4e76ceae5b5a46c968bd952f551ce173809f63)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=3b4e76ceae5b5a46c968bd952f551ce173809f63)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=3b4e76ceae5b5a46c968bd952f551ce173809f63)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Dan Carpenter <dan.carpenter@linaro.org> | 2024-08-20 11:44:08 +0300 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-08-29 17:30:48 +0200 |
| commit | [3b4e76ceae5b5a46c968bd952f551ce173809f63](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=3b4e76ceae5b5a46c968bd952f551ce173809f63) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=3b4e76ceae5b5a46c968bd952f551ce173809f63)) | |
| tree | [21fe6c99b3949aec95fab9cc3179aca10c22d80d](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=3b4e76ceae5b5a46c968bd952f551ce173809f63) | |
| parent | [7ecf85542169012765e4c2817cd3be6c2e009962](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=7ecf85542169012765e4c2817cd3be6c2e009962) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=3b4e76ceae5b5a46c968bd952f551ce173809f63&id2=7ecf85542169012765e4c2817cd3be6c2e009962)) | |
| download | [linux-3b4e76ceae5b5a46c968bd952f551ce173809f63.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-3b4e76ceae5b5a46c968bd952f551ce173809f63.tar.gz) | |

mmc: mmc\_test: Fix NULL dereference on allocation failure[ Upstream commit a1e627af32ed60713941cbfc8075d44cad07f6dd ]
If the "test->highmem = alloc\_pages()" allocation fails then calling
\_\_free\_pages(test->highmem) will result in a NULL dereference. Also
change the error code to -ENOMEM instead of returning success.
Fixes: 2661081f5ab9 ("mmc\_test: highmem tests")
Signed-off-by: Dan Carpenter <dan.carpenter@linaro.org>
Link: [https://lore.kernel.org/r/8c90be28-67b4-4b0d-a105-034dc72a0b31@stanley.mountain](https://lore.kernel.org/r/8c90be28-67b4-4b0d-a105-034dc72a0b31%40stanley.mountain)
Signed-off-by: Ulf Hansson <ulf.hansson@linaro.org>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=3b4e76ceae5b5a46c968bd952f551ce173809f63)

| -rw-r--r-- | [drivers/mmc/core/mmc\_test.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/mmc/core/mmc_test.c?id=3b4e76ceae5b5a46c968bd952f551ce173809f63) | 9 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 5 insertions, 4 deletions

| diff --git a/drivers/mmc/core/mmc\_test.c b/drivers/mmc/core/mmc\_test.cindex 155ce2bdfe6220..dbbcbdeab6c516 100644--- a/[drivers/mmc/core/mmc\_test.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/mmc/core/mmc_test.c?id=7ecf85542169012765e4c2817cd3be6c2e009962)+++ b/[drivers/mmc/core/mmc\_test.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/mmc/core/mmc_test.c?id=3b4e76ceae5b5a46c968bd952f551ce173809f63)@@ -3109,13 +3109,13 @@ static ssize\_t mtf\_test\_write(struct file \*file, const char \_\_user \*buf, test->buffer = kzalloc(BUFFER\_SIZE, GFP\_KERNEL); #ifdef CONFIG\_HIGHMEM test->highmem = alloc\_pages(GFP\_KERNEL | \_\_GFP\_HIGHMEM, BUFFER\_ORDER);+ if (!test->highmem) {+ count = -ENOMEM;+ goto free\_test\_buffer;+ } #endif -#ifdef CONFIG\_HIGHMEM- if (test->buffer && test->highmem) {-#else if (test->buffer) {-#endif mutex\_lock(&mmc\_test\_lock); mmc\_test\_run(test, testcase); mutex\_unlock(&mmc\_test\_lock);@@ -3123,6 +3123,7 @@ static ssize\_t mtf\_test\_write(struct file \*file, const char \_\_user \*buf,  #ifdef CONFIG\_HIGHMEM \_\_free\_pages(test->highmem, BUFFER\_ORDER);+free\_test\_buffer: #endif kfree(test->buffer); kfree(test); |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 17:53:38 +0000



=== Content from git.kernel.org_ec4f2ad7_20250111_175503.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=e40515582141a9e7c84b269be699c05236a499a6)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=e40515582141a9e7c84b269be699c05236a499a6)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=e40515582141a9e7c84b269be699c05236a499a6)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=e40515582141a9e7c84b269be699c05236a499a6)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Dan Carpenter <dan.carpenter@linaro.org> | 2024-08-20 11:44:08 +0300 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-09-04 13:23:35 +0200 |
| commit | [e40515582141a9e7c84b269be699c05236a499a6](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=e40515582141a9e7c84b269be699c05236a499a6) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=e40515582141a9e7c84b269be699c05236a499a6)) | |
| tree | [b3d3b68faee3911e3b29259e0c7b2e5defca6e42](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=e40515582141a9e7c84b269be699c05236a499a6) | |
| parent | [9b8b65211a880af8fe8330a101e1e239a2d4008f](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=9b8b65211a880af8fe8330a101e1e239a2d4008f) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=e40515582141a9e7c84b269be699c05236a499a6&id2=9b8b65211a880af8fe8330a101e1e239a2d4008f)) | |
| download | [linux-e40515582141a9e7c84b269be699c05236a499a6.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-e40515582141a9e7c84b269be699c05236a499a6.tar.gz) | |

mmc: mmc\_test: Fix NULL dereference on allocation failure[ Upstream commit a1e627af32ed60713941cbfc8075d44cad07f6dd ]
If the "test->highmem = alloc\_pages()" allocation fails then calling
\_\_free\_pages(test->highmem) will result in a NULL dereference. Also
change the error code to -ENOMEM instead of returning success.
Fixes: 2661081f5ab9 ("mmc\_test: highmem tests")
Signed-off-by: Dan Carpenter <dan.carpenter@linaro.org>
Link: [https://lore.kernel.org/r/8c90be28-67b4-4b0d-a105-034dc72a0b31@stanley.mountain](https://lore.kernel.org/r/8c90be28-67b4-4b0d-a105-034dc72a0b31%40stanley.mountain)
Signed-off-by: Ulf Hansson <ulf.hansson@linaro.org>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=e40515582141a9e7c84b269be699c05236a499a6)

| -rw-r--r-- | [drivers/mmc/core/mmc\_test.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/mmc/core/mmc_test.c?id=e40515582141a9e7c84b269be699c05236a499a6) | 9 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 5 insertions, 4 deletions

| diff --git a/drivers/mmc/core/mmc\_test.c b/drivers/mmc/core/mmc\_test.cindex 4052f828f75e73..e03d4405cda366 100644--- a/[drivers/mmc/core/mmc\_test.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/mmc/core/mmc_test.c?id=9b8b65211a880af8fe8330a101e1e239a2d4008f)+++ b/[drivers/mmc/core/mmc\_test.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/mmc/core/mmc_test.c?id=e40515582141a9e7c84b269be699c05236a499a6)@@ -3111,13 +3111,13 @@ static ssize\_t mtf\_test\_write(struct file \*file, const char \_\_user \*buf, test->buffer = kzalloc(BUFFER\_SIZE, GFP\_KERNEL); #ifdef CONFIG\_HIGHMEM test->highmem = alloc\_pages(GFP\_KERNEL | \_\_GFP\_HIGHMEM, BUFFER\_ORDER);+ if (!test->highmem) {+ count = -ENOMEM;+ goto free\_test\_buffer;+ } #endif -#ifdef CONFIG\_HIGHMEM- if (test->buffer && test->highmem) {-#else if (test->buffer) {-#endif mutex\_lock(&mmc\_test\_lock); mmc\_test\_run(test, testcase); mutex\_unlock(&mmc\_test\_lock);@@ -3125,6 +3125,7 @@ static ssize\_t mtf\_test\_write(struct file \*file, const char \_\_user \*buf,  #ifdef CONFIG\_HIGHMEM \_\_free\_pages(test->highmem, BUFFER\_ORDER);+free\_test\_buffer: #endif kfree(test->buffer); kfree(test); |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 17:53:40 +0000



=== Content from git.kernel.org_53e4b0af_20250111_175504.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=ecb15b8ca12c0cbdab81e307e9795214d8b90890)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=ecb15b8ca12c0cbdab81e307e9795214d8b90890)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=ecb15b8ca12c0cbdab81e307e9795214d8b90890)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=ecb15b8ca12c0cbdab81e307e9795214d8b90890)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Dan Carpenter <dan.carpenter@linaro.org> | 2024-08-20 11:44:08 +0300 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-08-29 17:36:04 +0200 |
| commit | [ecb15b8ca12c0cbdab81e307e9795214d8b90890](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=ecb15b8ca12c0cbdab81e307e9795214d8b90890) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=ecb15b8ca12c0cbdab81e307e9795214d8b90890)) | |
| tree | [fe93eaf30a1bf8bb135f330bb9188e6f64ca2f65](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=ecb15b8ca12c0cbdab81e307e9795214d8b90890) | |
| parent | [6194025525585cb38f17abfe2c3ecaa010e04b00](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=6194025525585cb38f17abfe2c3ecaa010e04b00) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=ecb15b8ca12c0cbdab81e307e9795214d8b90890&id2=6194025525585cb38f17abfe2c3ecaa010e04b00)) | |
| download | [linux-ecb15b8ca12c0cbdab81e307e9795214d8b90890.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-ecb15b8ca12c0cbdab81e307e9795214d8b90890.tar.gz) | |

mmc: mmc\_test: Fix NULL dereference on allocation failure[ Upstream commit a1e627af32ed60713941cbfc8075d44cad07f6dd ]
If the "test->highmem = alloc\_pages()" allocation fails then calling
\_\_free\_pages(test->highmem) will result in a NULL dereference. Also
change the error code to -ENOMEM instead of returning success.
Fixes: 2661081f5ab9 ("mmc\_test: highmem tests")
Signed-off-by: Dan Carpenter <dan.carpenter@linaro.org>
Link: [https://lore.kernel.org/r/8c90be28-67b4-4b0d-a105-034dc72a0b31@stanley.mountain](https://lore.kernel.org/r/8c90be28-67b4-4b0d-a105-034dc72a0b31%40stanley.mountain)
Signed-off-by: Ulf Hansson <ulf.hansson@linaro.org>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=ecb15b8ca12c0cbdab81e307e9795214d8b90890)

| -rw-r--r-- | [drivers/mmc/core/mmc\_test.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/mmc/core/mmc_test.c?id=ecb15b8ca12c0cbdab81e307e9795214d8b90890) | 9 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 5 insertions, 4 deletions

| diff --git a/drivers/mmc/core/mmc\_test.c b/drivers/mmc/core/mmc\_test.cindex 8f7f587a0025b3..b7f627a9fdeab9 100644--- a/[drivers/mmc/core/mmc\_test.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/mmc/core/mmc_test.c?id=6194025525585cb38f17abfe2c3ecaa010e04b00)+++ b/[drivers/mmc/core/mmc\_test.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/mmc/core/mmc_test.c?id=ecb15b8ca12c0cbdab81e307e9795214d8b90890)@@ -3125,13 +3125,13 @@ static ssize\_t mtf\_test\_write(struct file \*file, const char \_\_user \*buf, test->buffer = kzalloc(BUFFER\_SIZE, GFP\_KERNEL); #ifdef CONFIG\_HIGHMEM test->highmem = alloc\_pages(GFP\_KERNEL | \_\_GFP\_HIGHMEM, BUFFER\_ORDER);+ if (!test->highmem) {+ count = -ENOMEM;+ goto free\_test\_buffer;+ } #endif -#ifdef CONFIG\_HIGHMEM- if (test->buffer && test->highmem) {-#else if (test->buffer) {-#endif mutex\_lock(&mmc\_test\_lock); mmc\_test\_run(test, testcase); mutex\_unlock(&mmc\_test\_lock);@@ -3139,6 +3139,7 @@ static ssize\_t mtf\_test\_write(struct file \*file, const char \_\_user \*buf,  #ifdef CONFIG\_HIGHMEM \_\_free\_pages(test->highmem, BUFFER\_ORDER);+free\_test\_buffer: #endif kfree(test->buffer); kfree(test); |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 17:53:41 +0000



=== Content from git.kernel.org_a6cd7a3e_20250111_175502.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=a1e627af32ed60713941cbfc8075d44cad07f6dd)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=a1e627af32ed60713941cbfc8075d44cad07f6dd)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=a1e627af32ed60713941cbfc8075d44cad07f6dd)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=a1e627af32ed60713941cbfc8075d44cad07f6dd)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Dan Carpenter <dan.carpenter@linaro.org> | 2024-08-20 11:44:08 +0300 |
| --- | --- | --- |
| committer | Ulf Hansson <ulf.hansson@linaro.org> | 2024-08-20 13:47:36 +0200 |
| commit | [a1e627af32ed60713941cbfc8075d44cad07f6dd](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=a1e627af32ed60713941cbfc8075d44cad07f6dd) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=a1e627af32ed60713941cbfc8075d44cad07f6dd)) | |
| tree | [773e7ecbd92375991974b84283bfcd79b85c5081](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=a1e627af32ed60713941cbfc8075d44cad07f6dd) | |
| parent | [6275c7bc8dd07644ea8142a1773d826800f0f3f7](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=6275c7bc8dd07644ea8142a1773d826800f0f3f7) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=a1e627af32ed60713941cbfc8075d44cad07f6dd&id2=6275c7bc8dd07644ea8142a1773d826800f0f3f7)) | |
| download | [linux-a1e627af32ed60713941cbfc8075d44cad07f6dd.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-a1e627af32ed60713941cbfc8075d44cad07f6dd.tar.gz) | |

mmc: mmc\_test: Fix NULL dereference on allocation failureIf the "test->highmem = alloc\_pages()" allocation fails then calling
\_\_free\_pages(test->highmem) will result in a NULL dereference. Also
change the error code to -ENOMEM instead of returning success.
Fixes: 2661081f5ab9 ("mmc\_test: highmem tests")
Signed-off-by: Dan Carpenter <dan.carpenter@linaro.org>
Link: [https://lore.kernel.org/r/8c90be28-67b4-4b0d-a105-034dc72a0b31@stanley.mountain](https://lore.kernel.org/r/8c90be28-67b4-4b0d-a105-034dc72a0b31%40stanley.mountain)
Signed-off-by: Ulf Hansson <ulf.hansson@linaro.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=a1e627af32ed60713941cbfc8075d44cad07f6dd)

| -rw-r--r-- | [drivers/mmc/core/mmc\_test.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/mmc/core/mmc_test.c?id=a1e627af32ed60713941cbfc8075d44cad07f6dd) | 9 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 5 insertions, 4 deletions

| diff --git a/drivers/mmc/core/mmc\_test.c b/drivers/mmc/core/mmc\_test.cindex 8f7f587a0025b3..b7f627a9fdeab9 100644--- a/[drivers/mmc/core/mmc\_test.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/mmc/core/mmc_test.c?id=6275c7bc8dd07644ea8142a1773d826800f0f3f7)+++ b/[drivers/mmc/core/mmc\_test.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/mmc/core/mmc_test.c?id=a1e627af32ed60713941cbfc8075d44cad07f6dd)@@ -3125,13 +3125,13 @@ static ssize\_t mtf\_test\_write(struct file \*file, const char \_\_user \*buf, test->buffer = kzalloc(BUFFER\_SIZE, GFP\_KERNEL); #ifdef CONFIG\_HIGHMEM test->highmem = alloc\_pages(GFP\_KERNEL | \_\_GFP\_HIGHMEM, BUFFER\_ORDER);+ if (!test->highmem) {+ count = -ENOMEM;+ goto free\_test\_buffer;+ } #endif -#ifdef CONFIG\_HIGHMEM- if (test->buffer && test->highmem) {-#else if (test->buffer) {-#endif mutex\_lock(&mmc\_test\_lock); mmc\_test\_run(test, testcase); mutex\_unlock(&mmc\_test\_lock);@@ -3139,6 +3139,7 @@ static ssize\_t mtf\_test\_write(struct file \*file, const char \_\_user \*buf,  #ifdef CONFIG\_HIGHMEM \_\_free\_pages(test->highmem, BUFFER\_ORDER);+free\_test\_buffer: #endif kfree(test->buffer); kfree(test); |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 17:53:39 +0000



=== Content from git.kernel.org_fff4c1ff_20250111_175500.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=2b507b03991f44dfb202fc2a82c9874d1b1f0c06)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=2b507b03991f44dfb202fc2a82c9874d1b1f0c06)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=2b507b03991f44dfb202fc2a82c9874d1b1f0c06)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=2b507b03991f44dfb202fc2a82c9874d1b1f0c06)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Dan Carpenter <dan.carpenter@linaro.org> | 2024-08-20 11:44:08 +0300 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-09-04 13:15:00 +0200 |
| commit | [2b507b03991f44dfb202fc2a82c9874d1b1f0c06](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=2b507b03991f44dfb202fc2a82c9874d1b1f0c06) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=2b507b03991f44dfb202fc2a82c9874d1b1f0c06)) | |
| tree | [4564564cce735924998738c1fad81a6821aa969c](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=2b507b03991f44dfb202fc2a82c9874d1b1f0c06) | |
| parent | [6590c49e987bffed9a5e324cf1166b0938998176](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=6590c49e987bffed9a5e324cf1166b0938998176) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=2b507b03991f44dfb202fc2a82c9874d1b1f0c06&id2=6590c49e987bffed9a5e324cf1166b0938998176)) | |
| download | [linux-2b507b03991f44dfb202fc2a82c9874d1b1f0c06.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-2b507b03991f44dfb202fc2a82c9874d1b1f0c06.tar.gz) | |

mmc: mmc\_test: Fix NULL dereference on allocation failure[ Upstream commit a1e627af32ed60713941cbfc8075d44cad07f6dd ]
If the "test->highmem = alloc\_pages()" allocation fails then calling
\_\_free\_pages(test->highmem) will result in a NULL dereference. Also
change the error code to -ENOMEM instead of returning success.
Fixes: 2661081f5ab9 ("mmc\_test: highmem tests")
Signed-off-by: Dan Carpenter <dan.carpenter@linaro.org>
Link: [https://lore.kernel.org/r/8c90be28-67b4-4b0d-a105-034dc72a0b31@stanley.mountain](https://lore.kernel.org/r/8c90be28-67b4-4b0d-a105-034dc72a0b31%40stanley.mountain)
Signed-off-by: Ulf Hansson <ulf.hansson@linaro.org>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=2b507b03991f44dfb202fc2a82c9874d1b1f0c06)

| -rw-r--r-- | [drivers/mmc/core/mmc\_test.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/mmc/core/mmc_test.c?id=2b507b03991f44dfb202fc2a82c9874d1b1f0c06) | 9 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 5 insertions, 4 deletions

| diff --git a/drivers/mmc/core/mmc\_test.c b/drivers/mmc/core/mmc\_test.cindex cd64e0f23ae544..8fcaec5544ff49 100644--- a/[drivers/mmc/core/mmc\_test.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/mmc/core/mmc_test.c?id=6590c49e987bffed9a5e324cf1166b0938998176)+++ b/[drivers/mmc/core/mmc\_test.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/mmc/core/mmc_test.c?id=2b507b03991f44dfb202fc2a82c9874d1b1f0c06)@@ -3097,13 +3097,13 @@ static ssize\_t mtf\_test\_write(struct file \*file, const char \_\_user \*buf, test->buffer = kzalloc(BUFFER\_SIZE, GFP\_KERNEL); #ifdef CONFIG\_HIGHMEM test->highmem = alloc\_pages(GFP\_KERNEL | \_\_GFP\_HIGHMEM, BUFFER\_ORDER);+ if (!test->highmem) {+ count = -ENOMEM;+ goto free\_test\_buffer;+ } #endif -#ifdef CONFIG\_HIGHMEM- if (test->buffer && test->highmem) {-#else if (test->buffer) {-#endif mutex\_lock(&mmc\_test\_lock); mmc\_test\_run(test, testcase); mutex\_unlock(&mmc\_test\_lock);@@ -3111,6 +3111,7 @@ static ssize\_t mtf\_test\_write(struct file \*file, const char \_\_user \*buf,  #ifdef CONFIG\_HIGHMEM \_\_free\_pages(test->highmem, BUFFER\_ORDER);+free\_test\_buffer: #endif kfree(test->buffer); kfree(test); |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 17:53:38 +0000



=== Content from git.kernel.org_a107e48b_20250111_175502.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=cac2815f49d343b2f0acc4973d2c14918ac3ab0c)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=cac2815f49d343b2f0acc4973d2c14918ac3ab0c)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=cac2815f49d343b2f0acc4973d2c14918ac3ab0c)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=cac2815f49d343b2f0acc4973d2c14918ac3ab0c)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Dan Carpenter <dan.carpenter@linaro.org> | 2024-08-20 11:44:08 +0300 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-08-29 17:33:52 +0200 |
| commit | [cac2815f49d343b2f0acc4973d2c14918ac3ab0c](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=cac2815f49d343b2f0acc4973d2c14918ac3ab0c) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=cac2815f49d343b2f0acc4973d2c14918ac3ab0c)) | |
| tree | [8d971ef66cb6f7a54e048621994134d519b8d6d5](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=cac2815f49d343b2f0acc4973d2c14918ac3ab0c) | |
| parent | [88c232fd06297cdb388c8455c22c6caf5f786eb9](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=88c232fd06297cdb388c8455c22c6caf5f786eb9) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=cac2815f49d343b2f0acc4973d2c14918ac3ab0c&id2=88c232fd06297cdb388c8455c22c6caf5f786eb9)) | |
| download | [linux-cac2815f49d343b2f0acc4973d2c14918ac3ab0c.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-cac2815f49d343b2f0acc4973d2c14918ac3ab0c.tar.gz) | |

mmc: mmc\_test: Fix NULL dereference on allocation failure[ Upstream commit a1e627af32ed60713941cbfc8075d44cad07f6dd ]
If the "test->highmem = alloc\_pages()" allocation fails then calling
\_\_free\_pages(test->highmem) will result in a NULL dereference. Also
change the error code to -ENOMEM instead of returning success.
Fixes: 2661081f5ab9 ("mmc\_test: highmem tests")
Signed-off-by: Dan Carpenter <dan.carpenter@linaro.org>
Link: [https://lore.kernel.org/r/8c90be28-67b4-4b0d-a105-034dc72a0b31@stanley.mountain](https://lore.kernel.org/r/8c90be28-67b4-4b0d-a105-034dc72a0b31%40stanley.mountain)
Signed-off-by: Ulf Hansson <ulf.hansson@linaro.org>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=cac2815f49d343b2f0acc4973d2c14918ac3ab0c)

| -rw-r--r-- | [drivers/mmc/core/mmc\_test.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/mmc/core/mmc_test.c?id=cac2815f49d343b2f0acc4973d2c14918ac3ab0c) | 9 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 5 insertions, 4 deletions

| diff --git a/drivers/mmc/core/mmc\_test.c b/drivers/mmc/core/mmc\_test.cindex 0f6a563103fd23..d780880ddd14b4 100644--- a/[drivers/mmc/core/mmc\_test.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/mmc/core/mmc_test.c?id=88c232fd06297cdb388c8455c22c6caf5f786eb9)+++ b/[drivers/mmc/core/mmc\_test.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/mmc/core/mmc_test.c?id=cac2815f49d343b2f0acc4973d2c14918ac3ab0c)@@ -3104,13 +3104,13 @@ static ssize\_t mtf\_test\_write(struct file \*file, const char \_\_user \*buf, test->buffer = kzalloc(BUFFER\_SIZE, GFP\_KERNEL); #ifdef CONFIG\_HIGHMEM test->highmem = alloc\_pages(GFP\_KERNEL | \_\_GFP\_HIGHMEM, BUFFER\_ORDER);+ if (!test->highmem) {+ count = -ENOMEM;+ goto free\_test\_buffer;+ } #endif -#ifdef CONFIG\_HIGHMEM- if (test->buffer && test->highmem) {-#else if (test->buffer) {-#endif mutex\_lock(&mmc\_test\_lock); mmc\_test\_run(test, testcase); mutex\_unlock(&mmc\_test\_lock);@@ -3118,6 +3118,7 @@ static ssize\_t mtf\_test\_write(struct file \*file, const char \_\_user \*buf,  #ifdef CONFIG\_HIGHMEM \_\_free\_pages(test->highmem, BUFFER\_ORDER);+free\_test\_buffer: #endif kfree(test->buffer); kfree(test); |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 17:53:40 +0000



=== Content from git.kernel.org_4db0aead_20250111_175501.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=9b9ba386d7bfdbc38445932c90fa9444c0524bea)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=9b9ba386d7bfdbc38445932c90fa9444c0524bea)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=9b9ba386d7bfdbc38445932c90fa9444c0524bea)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=9b9ba386d7bfdbc38445932c90fa9444c0524bea)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Dan Carpenter <dan.carpenter@linaro.org> | 2024-08-20 11:44:08 +0300 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-09-04 13:17:42 +0200 |
| commit | [9b9ba386d7bfdbc38445932c90fa9444c0524bea](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=9b9ba386d7bfdbc38445932c90fa9444c0524bea) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=9b9ba386d7bfdbc38445932c90fa9444c0524bea)) | |
| tree | [ec6c26cea4711615a25e06fba1b64075340fb17e](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=9b9ba386d7bfdbc38445932c90fa9444c0524bea) | |
| parent | [4370448fca3aa61fdba8fb94cd49b0595641e664](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=4370448fca3aa61fdba8fb94cd49b0595641e664) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=9b9ba386d7bfdbc38445932c90fa9444c0524bea&id2=4370448fca3aa61fdba8fb94cd49b0595641e664)) | |
| download | [linux-9b9ba386d7bfdbc38445932c90fa9444c0524bea.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-9b9ba386d7bfdbc38445932c90fa9444c0524bea.tar.gz) | |

mmc: mmc\_test: Fix NULL dereference on allocation failure[ Upstream commit a1e627af32ed60713941cbfc8075d44cad07f6dd ]
If the "test->highmem = alloc\_pages()" allocation fails then calling
\_\_free\_pages(test->highmem) will result in a NULL dereference. Also
change the error code to -ENOMEM instead of returning success.
Fixes: 2661081f5ab9 ("mmc\_test: highmem tests")
Signed-off-by: Dan Carpenter <dan.carpenter@linaro.org>
Link: [https://lore.kernel.org/r/8c90be28-67b4-4b0d-a105-034dc72a0b31@stanley.mountain](https://lore.kernel.org/r/8c90be28-67b4-4b0d-a105-034dc72a0b31%40stanley.mountain)
Signed-off-by: Ulf Hansson <ulf.hansson@linaro.org>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=9b9ba386d7bfdbc38445932c90fa9444c0524bea)

| -rw-r--r-- | [drivers/mmc/core/mmc\_test.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/mmc/core/mmc_test.c?id=9b9ba386d7bfdbc38445932c90fa9444c0524bea) | 9 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 5 insertions, 4 deletions

| diff --git a/drivers/mmc/core/mmc\_test.c b/drivers/mmc/core/mmc\_test.cindex b9b6f000154bb8..9ebd5cebd4e132 100644--- a/[drivers/mmc/core/mmc\_test.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/mmc/core/mmc_test.c?id=4370448fca3aa61fdba8fb94cd49b0595641e664)+++ b/[drivers/mmc/core/mmc\_test.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/mmc/core/mmc_test.c?id=9b9ba386d7bfdbc38445932c90fa9444c0524bea)@@ -3125,13 +3125,13 @@ static ssize\_t mtf\_test\_write(struct file \*file, const char \_\_user \*buf, test->buffer = kzalloc(BUFFER\_SIZE, GFP\_KERNEL); #ifdef CONFIG\_HIGHMEM test->highmem = alloc\_pages(GFP\_KERNEL | \_\_GFP\_HIGHMEM, BUFFER\_ORDER);+ if (!test->highmem) {+ count = -ENOMEM;+ goto free\_test\_buffer;+ } #endif -#ifdef CONFIG\_HIGHMEM- if (test->buffer && test->highmem) {-#else if (test->buffer) {-#endif mutex\_lock(&mmc\_test\_lock); mmc\_test\_run(test, testcase); mutex\_unlock(&mmc\_test\_lock);@@ -3139,6 +3139,7 @@ static ssize\_t mtf\_test\_write(struct file \*file, const char \_\_user \*buf,  #ifdef CONFIG\_HIGHMEM \_\_free\_pages(test->highmem, BUFFER\_ORDER);+free\_test\_buffer: #endif kfree(test->buffer); kfree(test); |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 17:53:39 +0000



=== Content from git.kernel.org_1d288de4_20250111_175503.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=e97be13a9f51284da450dd2a592e3fa87b49cdc9)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=e97be13a9f51284da450dd2a592e3fa87b49cdc9)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=e97be13a9f51284da450dd2a592e3fa87b49cdc9)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=e97be13a9f51284da450dd2a592e3fa87b49cdc9)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Dan Carpenter <dan.carpenter@linaro.org> | 2024-08-20 11:44:08 +0300 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-09-04 13:13:05 +0200 |
| commit | [e97be13a9f51284da450dd2a592e3fa87b49cdc9](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=e97be13a9f51284da450dd2a592e3fa87b49cdc9) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=e97be13a9f51284da450dd2a592e3fa87b49cdc9)) | |
| tree | [ed13c1b6b58d94509382f1ddca94f03ee972580a](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=e97be13a9f51284da450dd2a592e3fa87b49cdc9) | |
| parent | [a996a9abce790d5bd417fac336117f0436b9f87c](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=a996a9abce790d5bd417fac336117f0436b9f87c) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=e97be13a9f51284da450dd2a592e3fa87b49cdc9&id2=a996a9abce790d5bd417fac336117f0436b9f87c)) | |
| download | [linux-e97be13a9f51284da450dd2a592e3fa87b49cdc9.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-e97be13a9f51284da450dd2a592e3fa87b49cdc9.tar.gz) | |

mmc: mmc\_test: Fix NULL dereference on allocation failure[ Upstream commit a1e627af32ed60713941cbfc8075d44cad07f6dd ]
If the "test->highmem = alloc\_pages()" allocation fails then calling
\_\_free\_pages(test->highmem) will result in a NULL dereference. Also
change the error code to -ENOMEM instead of returning success.
Fixes: 2661081f5ab9 ("mmc\_test: highmem tests")
Signed-off-by: Dan Carpenter <dan.carpenter@linaro.org>
Link: [https://lore.kernel.org/r/8c90be28-67b4-4b0d-a105-034dc72a0b31@stanley.mountain](https://lore.kernel.org/r/8c90be28-67b4-4b0d-a105-034dc72a0b31%40stanley.mountain)
Signed-off-by: Ulf Hansson <ulf.hansson@linaro.org>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=e97be13a9f51284da450dd2a592e3fa87b49cdc9)

| -rw-r--r-- | [drivers/mmc/core/mmc\_test.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/mmc/core/mmc_test.c?id=e97be13a9f51284da450dd2a592e3fa87b49cdc9) | 9 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 5 insertions, 4 deletions

| diff --git a/drivers/mmc/core/mmc\_test.c b/drivers/mmc/core/mmc\_test.cindex ef18daeaa4cc6f..164b4e43050e70 100644--- a/[drivers/mmc/core/mmc\_test.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/mmc/core/mmc_test.c?id=a996a9abce790d5bd417fac336117f0436b9f87c)+++ b/[drivers/mmc/core/mmc\_test.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/mmc/core/mmc_test.c?id=e97be13a9f51284da450dd2a592e3fa87b49cdc9)@@ -3101,13 +3101,13 @@ static ssize\_t mtf\_test\_write(struct file \*file, const char \_\_user \*buf, test->buffer = kzalloc(BUFFER\_SIZE, GFP\_KERNEL); #ifdef CONFIG\_HIGHMEM test->highmem = alloc\_pages(GFP\_KERNEL | \_\_GFP\_HIGHMEM, BUFFER\_ORDER);+ if (!test->highmem) {+ count = -ENOMEM;+ goto free\_test\_buffer;+ } #endif -#ifdef CONFIG\_HIGHMEM- if (test->buffer && test->highmem) {-#else if (test->buffer) {-#endif mutex\_lock(&mmc\_test\_lock); mmc\_test\_run(test, testcase); mutex\_unlock(&mmc\_test\_lock);@@ -3115,6 +3115,7 @@ static ssize\_t mtf\_test\_write(struct file \*file, const char \_\_user \*buf,  #ifdef CONFIG\_HIGHMEM \_\_free\_pages(test->highmem, BUFFER\_ORDER);+free\_test\_buffer: #endif kfree(test->buffer); kfree(test); |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 17:53:40 +0000


