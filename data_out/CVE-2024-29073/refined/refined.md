- **Root cause of vulnerability:** The vulnerability stems from an incomplete blocklist of LaTeX commands in Ankitects Anki. Specifically, the `verbatim` package, which is included in most LaTeX distributions, was overlooked. This allows the execution of arbitrary commands via the `verbatiminput` command.
- **Weaknesses/vulnerabilities present:** Incomplete input sanitization/validation for LaTeX commands, specifically for the `verbatim` package.
- **Impact of exploitation:** Arbitrary file read, system information disclosure and listing directories/files can be achieved. The attacker can also exfiltrate the read content to a server controlled by the attacker, by adding a javascript in the template.
- **Attack vectors:** A malicious user can create a specially crafted flashcard containing LaTeX code using the `verbatim` package and share it with other users.
- **Required attacker capabilities/position:** The attacker needs to be able to create and share flashcards, and the victim needs to import and use the malicious flashcard in the application.