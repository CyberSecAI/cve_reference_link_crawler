Based on the provided content, here's a breakdown of the vulnerability associated with CVE-2016-3721:

**Root Cause of Vulnerability:**

The root cause is that Jenkins, by default, passes build parameters to build scripts as environment variables. Some plugins allowed passing arbitrary (undeclared) parameters that were not explicitly defined in the job configuration.

**Weaknesses/Vulnerabilities Present:**

*   **Unfiltered Environment Variables:** The primary weakness was the lack of filtering or sanitization of build parameters before they were passed as environment variables to build scripts. This allowed malicious users to inject arbitrary environment variables.
*   **Plugin Vulnerability:** Some plugins inadvertently allowed passing of arbitrary parameters that were not part of job's intended configurations

**Impact of Exploitation:**

*   **Arbitrary Code Execution:** By injecting malicious environment variables (like `PATH`), an attacker could modify the behavior of build scripts, potentially leading to arbitrary code execution on the Jenkins server or build agents.
*   **Build Manipulation:** Attackers could manipulate build processes by altering the environment variables used by build tools and scripts, leading to unexpected and potentially harmful results.

**Attack Vectors:**

*   **Maliciously crafted build parameters:** An attacker would need to find a plugin that allows arbitrary build parameters to be passed, and trigger a build, passing malicious environment variables as parameters.

**Required Attacker Capabilities/Position:**

*   **Jenkins Access:** The attacker needs to have at least the ability to trigger builds. Depending on the plugin used, the attacker might require permissions to configure builds or utilize specific plugin functionalities.
*  **Understanding of Jenkins Build Process:** The attacker would need a basic understanding of how Jenkins injects environment variables into build processes, and be familiar with some plugins that allow arbitrary parameters.

**Additional details from the content:**
*   The fix in Jenkins 1.651.2 and 2.3 filters build parameters by default, only allowing explicitly defined parameters to be passed as environment variables.
*   A workaround to temporarily revert to the old behavior is possible by setting the system property `hudson.model.ParametersAction.keepUndefinedParameters` to `true` (but is marked as unsafe).
*  A more controlled workaround to allow specific parameter names is by setting the `hudson.model.ParametersAction.safeParameters` system property.
*  The advisory mentions a number of plugins that were impacted by the fix, as they relied on the ability to pass arbitrary, undefined parameters to builds.

In summary, CVE-2016-3721 allowed attackers to inject arbitrary environment variables into Jenkins builds due to a lack of parameter filtering, potentially leading to arbitrary code execution by altering the execution environment.