<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><title>PAX Paydroid Vulnerabilities Advisory 2022 - wr3nchsr</title><meta name=Description content="This advisory shows the results of a vulnerability research which was conducted on PayDroid_7.1.1_Virgo_V04.3.26T1_20210419 running on the A930 terminal. As a result of this research 4 vulnerabilities were identified (CVE-2022-26579, CVE-2022-26580, CVE-2022-26581, CVE-2022-26582)."><meta property="og:title" content="PAX Paydroid Vulnerabilities Advisory 2022"><meta property="og:description" content="This advisory shows the results of a vulnerability research which was conducted on PayDroid_7.1.1_Virgo_V04.3.26T1_20210419 running on the A930 terminal. As a result of this research 4 vulnerabilities were identified (CVE-2022-26579, CVE-2022-26580, CVE-2022-26581, CVE-2022-26582)."><meta property="og:type" content="article"><meta property="og:url" content="https://wr3nchsr.github.io/pax-paydroid-vulnerabilities-advisory-2022/"><meta property="og:image" content="https://wr3nchsr.github.io/images/avatar.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-12-12T00:00:00+02:00"><meta property="article:modified_time" content="2022-12-12T00:00:00+02:00"><meta property="og:site_name" content="wr3nchsr"><meta name=twitter:card content="summary"><meta name=twitter:image content="https://wr3nchsr.github.io/images/avatar.png"><meta name=twitter:title content="PAX Paydroid Vulnerabilities Advisory 2022"><meta name=twitter:description content="This advisory shows the results of a vulnerability research which was conducted on PayDroid_7.1.1_Virgo_V04.3.26T1_20210419 running on the A930 terminal. As a result of this research 4 vulnerabilities were identified (CVE-2022-26579, CVE-2022-26580, CVE-2022-26581, CVE-2022-26582)."><meta name=twitter:site content="@wr3nchsr"><meta name=application-name content="wr3nchsr"><meta name=apple-mobile-web-app-title content="wr3nchsr"><meta name=theme-color content="#ffffff"><meta name=msapplication-TileColor content="#e25555"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico?><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#e25555><link rel=manifest href=/site.webmanifest><link rel=canonical href=https://wr3nchsr.github.io/pax-paydroid-vulnerabilities-advisory-2022/><link rel=prev href=https://wr3nchsr.github.io/dragon-ctf-no-eeeeeeeeeeeemoji-writeup/><link rel=next href=https://wr3nchsr.github.io/backdoor-ctf-susalloc-writeup/><link rel=stylesheet href=/css/style.min.css><link rel=preload href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css></noscript><link rel=preload href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css></noscript><meta name=google-site-verification content="WapKEVOt_alwvxKMt6VFrx8oiTOEVYLPJrK6s9N8k5M"><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"PAX Paydroid Vulnerabilities Advisory 2022","inLanguage":"en","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/wr3nchsr.github.io\/pax-paydroid-vulnerabilities-advisory-2022\/"},"image":[{"@type":"ImageObject","url":"https:\/\/wr3nchsr.github.io\/images\/avatar.png","width":400,"height":400}],"genre":"posts","wordcount":568,"url":"https:\/\/wr3nchsr.github.io\/pax-paydroid-vulnerabilities-advisory-2022\/","datePublished":"2022-12-12T00:00:00+02:00","dateModified":"2022-12-12T00:00:00+02:00","publisher":{"@type":"Organization","name":"Saif Aziz","logo":{"@type":"ImageObject","url":"https:\/\/wr3nchsr.github.io\/images\/avatar.png","width":400,"height":400}},"author":{"@type":"Person","name":" Saif Aziz"},"description":"This advisory shows the results of a vulnerability research which was conducted on PayDroid_7.1.1_Virgo_V04.3.26T1_20210419 running on the A930 terminal. As a result of this research 4 vulnerabilities were identified (CVE-2022-26579, CVE-2022-26580, CVE-2022-26581, CVE-2022-26582)."}</script></head><body data-header-desktop=normal data-header-mobile=auto><script type=text/javascript>(window.localStorage&&localStorage.getItem("theme")?localStorage.getItem("theme")==="dark":"auto"==="auto"?window.matchMedia("(prefers-color-scheme: dark)").matches:"auto"==="dark")&&document.body.setAttribute("theme","dark")</script><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=/ title=wr3nchsr><span class=header-title-pre><i class='far fa-face-dizzy fa-fw' aria-hidden=true></i></span>wr3nchsr</a></div><div class=menu><div class=menu-inner><a class=menu-item href=/posts/>Posts </a><a class=menu-item href=/vulnerabilities/>Vulnerabilities </a><span class="menu-item delimiter"></span><span class="menu-item search" id=search-desktop>
<input type=text placeholder="Search titles or contents..." id=search-input-desktop>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-desktop title=Search><i class="fas fa-search fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-desktop title=Clear><i class="fas fa-times-circle fa-fw" aria-hidden=true></i></a>
<span class="search-button search-loading" id=search-loading-desktop><i class="fas fa-spinner fa-fw fa-spin" aria-hidden=true></i></span>
</span><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme"><i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title=wr3nchsr><span class=header-title-pre><i class='far fa-face-dizzy fa-fw' aria-hidden=true></i></span>wr3nchsr</a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><div class=search-wrapper><div class="search mobile" id=search-mobile><input type=text placeholder="Search titles or contents..." id=search-input-mobile>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-mobile title=Search><i class="fas fa-search fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-mobile title=Clear><i class="fas fa-times-circle fa-fw" aria-hidden=true></i></a>
<span class="search-button search-loading" id=search-loading-mobile><i class="fas fa-spinner fa-fw fa-spin" aria-hidden=true></i></span></div><a href=javascript:void(0); class=search-cancel id=search-cancel-mobile>Cancel</a></div><a class=menu-item href=/posts/ title>Posts</a><a class=menu-item href=/vulnerabilities/ title>Vulnerabilities</a><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme">
<i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=main><div class=container><div class=toc id=toc-auto><h2 class=toc-title>Contents</h2><div class="toc-content always-active" id=toc-content-auto></div></div><article class="page single"><h1 class=single-title>PAX Paydroid Vulnerabilities Advisory 2022</h1><div class=post-meta><div class=post-meta-line></div><div class=post-meta-line><i class="far fa-calendar-alt fa-fw" aria-hidden=true></i>&nbsp;<time datetime="Dec 12, 2022">Dec 12, 2022</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden=true></i>&nbsp;568 words&nbsp;</div></div><div class="details toc" id=toc-static data-kept><div class="details-summary toc-title"><span>Contents</span>
<span><i class="details-icon fas fa-angle-right" aria-hidden=true></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#summary>Summary</a></li><li><a href=#exploit-chain-showcase>Exploit Chain Showcase</a></li><li><a href=#vulnerabilities>Vulnerabilities</a><ul><li><a href=#application-signature-verification-bypass>Application Signature Verification Bypass</a></li><li><a href=#command-injection-in-adb-daemon>Command Injection in ADB Daemon</a></li><li><a href=#multiple-unauthorized-backdoor-functionalities-in-adb-daemon>Multiple Unauthorized Backdoor Functionalities in ADB Daemon</a></li><li><a href=#privilege-escalation-through-command-injection-in-systool-client>Privilege Escalation Through Command Injection in Systool Client</a></li></ul></li><li><a href=#affected-systems-and-mitigations>Affected Systems and Mitigations</a></li><li><a href=#disclosure-timeline>Disclosure Timeline</a></li><li><a href=#acknowledgement>Acknowledgement</a></li><li><a href=#disclaimer>Disclaimer</a></li></ul></nav></div></div><div class=content id=content><h2 id=summary>Summary</h2><p>This advisory shows the results of a vulnerability research which was conducted on PayDroid_7.1.1_Virgo_V04.3.26T1_20210419 running on the <a href=https://www.pax.com.cn/androidsmartpos/A930 target=_blank rel="noopener noreffer">A930 terminal</a>. As a result of this research 4 vulnerabilities were identified (CVE-2022-26579, CVE-2022-26580, CVE-2022-26581, CVE-2022-26582).</p><p>The impact of those vulnerabilities varies between unauthorized command execution, privilege escalation and signature check bypass. An attacker who is able to chain some of those vulnerabilities is able to gain RCE as root and install unsigned applications (ex: credit card sniffer) on a production mode POS.</p><h2 id=exploit-chain-showcase>Exploit Chain Showcase</h2><div class=video><video controls style=width:-webkit-fill-available><source src=poc.mp4 type=video/mp4></video></div><h2 id=vulnerabilities>Vulnerabilities</h2><h3 id=application-signature-verification-bypass>Application Signature Verification Bypass</h3><p><strong>CVE ID</strong>: <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-26579" target=_blank rel="noopener noreffer">CVE-2022-26579</a></p><p><strong>CVSS Score</strong>: <a href="https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?calculator&amp;version=3.1&amp;vector=AV:L/AC:L/PR:H/UI:N/S:C/C:H/I:H/A:N" target=_blank rel="noopener noreffer">7.9 (AV:L/AC:L/PR:H/UI:N/S:C/C:H/I:H/A:N)</a></p><p><strong>Category</strong>: CWE-345: Insufficient Verification of Data Authenticity</p><p>PAX A930 device with PayDroid_7.1.1_Virgo_V04.3.26T1_20210419 can allow a root privileged attacker to install unsigned packages. The attacker must have shell access to the device and gain root privileges in order to exploit this vulnerability.</p><h3 id=command-injection-in-adb-daemon>Command Injection in ADB Daemon</h3><p><strong>CVE ID</strong>: <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-26580" target=_blank rel="noopener noreffer">CVE-2022-26580</a></p><p><strong>CVSS Score</strong>: <a href="https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?calculator&amp;version=3.1&amp;vector=AV:P/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L" target=_blank rel="noopener noreffer">4.3 (AV:P/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L)</a></p><p><strong>Category</strong>: CWE-78: Improper Neutralization of Special Elements used in an OS Command (&lsquo;OS Command Injection&rsquo;)</p><p>PAX A930 device with PayDroid_7.1.1_Virgo_V04.3.26T1_20210419 can allow the execution of specific command injections on selected binaries in the ADB daemon shell service. The attacker must have physical USB access to the device in order to exploit this vulnerability.</p><h3 id=multiple-unauthorized-backdoor-functionalities-in-adb-daemon>Multiple Unauthorized Backdoor Functionalities in ADB Daemon</h3><p><strong>CVE ID</strong>: <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-26581" target=_blank rel="noopener noreffer">CVE-2022-26581</a></p><p><strong>CVSS Score</strong>: <a href="https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?calculator&amp;version=3.1&amp;vector=AV:P/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:L" target=_blank rel="noopener noreffer">3.5 (AV:P/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:L)</a></p><p><strong>Category</strong>: CWE-912: Hidden Functionality, CWE-862: Missing Authorization</p><p>PAX A930 device with PayDroid_7.1.1_Virgo_V04.3.26T1_20210419 can allow an unauthorized attacker to perform privileged actions through the execution of specific binaries listed in ADB daemon. The attacker must have physical USB access to the device in order to exploit this vulnerability.</p><h3 id=privilege-escalation-through-command-injection-in-systool-client>Privilege Escalation Through Command Injection in Systool Client</h3><p><strong>CVE ID</strong>: <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-26582" target=_blank rel="noopener noreffer">CVE-2022-26582</a></p><p><strong>CVSS Score</strong>: <a href="https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?calculator&amp;version=3.1&amp;vector=AV:L/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H" target=_blank rel="noopener noreffer">8.4 (AV:L/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)</a></p><p><strong>Category</strong>: CWE-78: Improper Neutralization of Special Elements used in an OS Command (&lsquo;OS Command Injection&rsquo;)</p><p>PAX A930 device with PayDroid_7.1.1_Virgo_V04.3.26T1_20210419 can allow an attacker to gain root access through command injection in systool client. The attacker must have shell access to the device in order to exploit this vulnerability.</p><h2 id=affected-systems-and-mitigations>Affected Systems and Mitigations</h2><p>These vulnerabilities were discovered on PAX A930 running PayDroid_7.1.1_Virgo_V04.3.26T1_20210419. However, they may affect other terminals and versions. Please refer to PAX Technology for clarification on vulnerable terminals and/or versions and their respective patched version.</p><h2 id=disclosure-timeline>Disclosure Timeline</h2><ul><li>Discovery: November 01, 2021</li><li>Vendor Meeting: November 17, 2021</li><li>Patching: November 25, 2021 - January 09, 2022</li><li>Disclosure: December 12, 2022</li></ul><h2 id=acknowledgement>Acknowledgement</h2><p>Saif Aziz (<a href=http://twitter.com/wr3nchsr target=_blank rel="noopener noreffer">@wr3nchsr</a>) of CyShield</p><h2 id=disclaimer>Disclaimer</h2><p>CYSHIELD FOR TECHNOLOGY S.A.E (CYSHIELD) are keen to share our expertise widely and to enrich public knowledge, through disseminating cyber security culture awareness. CYSHEILD relies on information provided by the vendor / product manufacturer when listing fixed versions, products or releases. CYSHIELD does not verify this contained information, except otherwise when specifically stipulated in the advisory text and contractually required or explicitly agreed in a written form by the vendor / product manufacturer to undertake as such. Unconfirmed vendor / product manufacturer fixes might be ineffective, incomplete, inaccurate or easy to bypass and it is the vendor’s / product manufacturer&rsquo;s liability to ensure all the discovered vulnerabilities found by CYSHIELD are resolved properly. CYSHIELD accepts zero liability, financial or otherwise, from any material and consequential losses, loss of life or reputational loss arising from or as a result of misuse of the information or code contained or mentioned in its advisories. It is the vendor&rsquo;s / product manufacturer’s liability not CYSHIELD to ensure their products&rsquo; security before, during and after release to market.</p></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span>Updated on Dec 12, 2022</span></div></div><div class=post-info-line><div class=post-info-md></div><div class=post-info-share><span><a href=javascript:void(0); title="Share on Twitter" data-sharer=twitter data-url=https://wr3nchsr.github.io/pax-paydroid-vulnerabilities-advisory-2022/ data-title="PAX Paydroid Vulnerabilities Advisory 2022" data-via=wr3nchsr><i class="fab fa-twitter fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Facebook" data-sharer=facebook data-url=https://wr3nchsr.github.io/pax-paydroid-vulnerabilities-advisory-2022/><i class="fab fa-facebook-square fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Linkedin" data-sharer=linkedin data-url=https://wr3nchsr.github.io/pax-paydroid-vulnerabilities-advisory-2022/><i class="fab fa-linkedin fa-fw" aria-hidden=true></i></a></span></div></div></div><div class=post-info-more><section class=post-tags></section><section><span><a href=javascript:void(0); onclick=window.history.back()>Back</a></span>&nbsp;|&nbsp;<span><a href=/>Home</a></span></section></div><div class=post-nav><a href=/dragon-ctf-no-eeeeeeeeeeeemoji-writeup/ class=prev rel=prev title="Dragon CTF 2020 - no-eeeeeeeeeeeemoji Writeup"><i class="fas fa-angle-left fa-fw" aria-hidden=true></i>Dragon CTF 2020 - no-eeeeeeeeeeeemoji Writeup</a>
<a href=/backdoor-ctf-susalloc-writeup/ class=next rel=next title="Backdoor CTF 2022 - susalloc Writeup">Backdoor CTF 2022 - susalloc Writeup<i class="fas fa-angle-right fa-fw" aria-hidden=true></i></a></div></div></article></div></main><footer class=footer><div class=footer-container><div class=footer-line><i class="far fa-copyright fa-fw" aria-hidden=true></i><span itemprop=copyrightYear>
2024 • </span>Powered by <a href=https://gohugo.io/ target=_blank rel="noopener noreffer" title="Hugo 0.114.0">Hugo</a> and <a href=https://github.com/dillonzq/LoveIt target=_blank rel="noopener noreffer" title="LoveIt 0.2.11"><i class="far fa-kiss-wink-heart fa-fw" aria-hidden=true></i> LoveIt</a></div></div></footer></div><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title="Back to Top"><i class="fas fa-arrow-up fa-fw" aria-hidden=true></i>
</a><a href=# id=view-comments class=fixed-button title="View Comments"><i class="fas fa-comment fa-fw" aria-hidden=true></i></a></div><script type=text/javascript src=https://cdn.jsdelivr.net/npm/autocomplete.js@0.38.1/dist/autocomplete.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lunr@2.3.9/lunr.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lazysizes@5.3.2/lazysizes.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/clipboard@2.0.11/dist/clipboard.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/sharer.js@0.5.1/sharer.min.js></script><script type=text/javascript>window.config={code:{copyTitle:"Copy to clipboard",maxShownLines:100},comment:{},search:{highlightTag:"em",lunrIndexURL:"/index.json",maxResultLength:10,noResultsFound:"No results found",snippetLength:30,type:"lunr"}}</script><script type=text/javascript src=/js/theme.min.js></script><script type=text/javascript>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-86CNTM5M5F",{anonymize_ip:!0})</script><script type=text/javascript src="https://www.googletagmanager.com/gtag/js?id=G-86CNTM5M5F" async></script></body></html>