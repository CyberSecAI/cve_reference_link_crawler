<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="NanoBlogger 3.5-RC1" />
<meta name="description" content="We found a security related issue in most recent CrowdStrike Falcon Sensor. The bug itself is not worth a blogpost, as the severity is pretty low. However, we'd like to shed some light on a vulnerability submission and disclosure process with CrowdStrike: It was pretty weird." />
<meta name="robots" content="all" />
<meta name="revisit-after" content="31 days" />

<title>Ridiculous vulnerability disclosure process with CrowdStrike Falcon Sensor | mod%log</title>

<link rel="stylesheet" href="../../../../../styles/modzero.css" type="text/css" media="all" />
<link rel="stylesheet" href="../../../../../styles/print.css" type="text/css" media="print" />
<link rel="shortcut icon" href="../../../../../images/favicon.ico" />
<link rel="alternate" type="application/atom+xml"
title="Atom 1.0"
href="../../../../../atom.xml"
/>
<link rel="alternate" type="application/rss+xml"
title="RSS 2.0"
href="../../../../../rss.xml"
/>

</head>


<body>

<div id="banner">
	<h1><a href="../../../../../index.html" accesskey="1">mod%log</a></h1>
	<span class="description">modzero AG</span>
</div><!-- /banner div -->

<div id="container">

	<div class="archives">

		<a id="top"></a>
		<div id="menu">
			<a href="../../../../../index.html">Main</a> &#62;
			<a href="../../../../../archives/index.html">Archives</a> &#62;
			<a href="../../../../../archives/2022/index.html">2022</a> &#62;
			<!-- comment out next line when month archives are disabled -->
			<a href="../../../../../archives/2022/08/index.html">08</a> &#62;
			<!-- uncomment next line when day archives are enabled -->
			<!-- <a href="../../../../../archives/2022/08/22/index.html">22</a> &#62; -->
			<br />
<a href="../../../../../archives/2022/05/31/en_hoot_hoot_pwn/index.html">&#60;</a>
			<!-- uncomment next line when month or day archives are disabled -->
			<!-- 08/22 -->
			10:01:23
<a href="../../../../../archives/2022/12/19/better_make_sure_your_password_manager_is_secure/index.html">&#62;</a>
		</div>
		<h2 class="date">
	2022-08-22
</h2>
<div class="blogbody">
	<a id="e2022-08-22T10_01_23.txt"></a>
	<h3 class="title">Ridiculous vulnerability disclosure process with CrowdStrike Falcon Sensor</h3>
	        
        <p>
            <a href="https://www.modzero.com/advisories/MZ-22-02-CrowdStrike-FalconSensor.txt">Today, we publish a new advisory</a> for a vulnerability in the <a href="https://www.crowdstrike.com">CrowdStrike</a> Falcon Sensor, that was found by our team-mate <a href="https://twitter.com/parzel2">Pascal Zenker</a> as part of a recent red-teaming engagement.
        </p>
        
        <p>
            The vulnerability is a case of <a href="https://cwe.mitre.org/data/definitions/691.html">insufficient control flow management</a>, that allows an attacker with administrative privileges to bypass the <a href="https://www.crowdstrike.com/blog/tech-center/uninstall-protection-for-the-falcon-agent/"><i>Falcon Agent Uninstall Protection</i></a> feature of CrowdStrike. As the exploit needs high privileges, the overall risk of the vulnerability is very <u>limited</u>.
        </p>
        
        <p>
            While the vulnerability itself might not be worth a blog post, we'd like to write a few lines about the <b>ridiculous disclosure process</b>.
        </p>
        
        <p>
            CrowdStrike is a major vendor in the area of IT security and we expected a straightforward coordinated disclosure process. To our surprise, the communication and disclosure with CrowdStrike was tedious and turned unprofessional in the end. Throughout the whole process, CrowdStrike pushed us repeatedly to disclose the vulnerability through their <a href="https://www.hackerone.com/"<i>HackerOne</i></a> bug bounty program, which would have forced us to agree on the <i>HackerOne</i> Disclosure terms.
        </p>
        
        <p>
            We communicated early on that we are neither willing to participate in any bug bounty program nor sign an <a href="https://en.wikipedia.org/wiki/Non-disclosure_agreement">NDA</a>, because we are the ones, providing information to them. After providing CrowdStrike with a draft of the security advisory and exploit source code we were informed that they could not replicate the issue with an updated version of the sensor. Our request for a 14-day trial version to verify that ourselves was denied.
        </p>
        
        <p>
            As the issue was not considered valid, we informed CrowdStrike that we would release the advisory to the public. In response, CrowdStrike tried again to set up a bug bounty disclosure meeting between "<i>modzero's Sr Leadership</i>" and CrowdStrike CISO "<i>[...] to discuss next steps related to <b>the</b> bug bounty disclosure</i>" in contrast to our previously stated disclosure rules. 
        </p>

        <p>
            Sometime later, we were able to acquire an updated version of the sensor and discovered that parts of the formerly provided exploit code and a specific <i>msiexec</i> call, are now flagged as malicious behaviour by the sensor. This leads us to conclude that CrowdStrike tried to "fix" the issue, while being told the issue didn't exist. Which is pretty <b>disrespectful</b> to us.
        </p>
        
        <p>
            We were able to circumvent the countermeasures introduced silently by CrowdStrike. With small changes to the exploit, it is now working again (tested with version 6.42.15610 of the CrowdStrike Falcon software).
        </p>
        
        <p>
            We believe that vulnerability disclosure is a two-way street. Vendors, as well as researchers, should act responsibly and show mutual goodwill and transparency. Mutual non-disclosure agreements and restrictions imposed by bug bounty programs limit the disclosure process. Remember, just because no CVE-IDs are publicly known, does not mean bugs haven't been reported and fixed. Many bug bounty reports never assign CVE-IDs, leading to a false perception of security and software quality. 
        </p>
        
        
        <h2>References</h2>
        
        <p>
            <ul>
            <li>Proof of Concept screencast: <a href="https://youtu.be/3If-Fqwx-4s">https://youtu.be/3If-Fqwx-4s</a></li>
            <li>modzero Security Advisory MZ-22-02: <a href="https://www.modzero.com/advisories/MZ-22-02-CrowdStrike-FalconSensor.txt">https://www.modzero.com/advisories/MZ-22-02-CrowdStrike-FalconSensor.txt</a></li>
    
            </ul>
        </p>

        <h2>
            Disclosure Timeline
        </h2>

<pre>

2022/04    - Found   vulnerability  in   CrowdStrike  Falcon   Sensor
             (6.31.14505.0)
             
2022/06/04 - modzero  asked  for   security  contact  @  CrowdStrike,
             because their "report a  security bug" page only refered
             to the hackerone Bug Bounty program.
             
2022/06/06 - CS  answered   that  modzero   can  use   the  hackerone
             submission page, or  send an E-Mail to  their support at
             support@crowdstrike.com.
             
2022/06/06 - modzero  asked   if  it   is  okay  to   send  sensitive
             information  about  0day  vulnerabilities  to  support@.
             modzero also told  CS that we are not  willing to accept
             terms & conditions  of hackerone, which is  why we asked
             for a direct security contact.
             
2022/06/06 - CS offered  to enroll  modzero in  a private  bug bounty
             program at  hackerone, under the conditions  that we are
             willing to sign a mutual non-disclosure agreement.
             
2022/06/07 - to  prevent further  misunderstandings, modzero  told CS
             again, that:

             * we would like to submit a security related bug.
             * we  don't  want  to  participate  in  any  bug  bounty
             programs.
             * we are not willing to  sign any NDA because WE are the
             ones, providing information to CS.
             * we are  not  willing  to accept  any sort  of terms  &
             conditions that  are out of  scope of well  known hacker
             ethics.
             * we  only want  to get a  reliable security  contact on
             their side.

             Aditionally,  modzero  sent  a  link  to  their  current
             vulnerability disclosure policy.

2022/06/07 - CS told us to send the report to bugs@ for review.
             
2022/06/13 - CS asked for the report.
             
2022/06/13 - modzero told CS  that we need a little bit  more time to
             finish and double check everything before submitting.
             
2022/06/29 - modzero sent Security Advisory (draft), Proof of Concept
             exploit sourcecode, executable and a Screencast video of
             the PoC to CS.
             
2022/06/29 - CS  told  us,  that  we   were  testing  using  only  an
             unsupported  version of  the Falcon  Sensor. CS  told us
             about the  error message and  that they are not  able to
             reproduce.
             
2022/07/05 - modzero told  CS that the  error message can  be ignored
             and refered to their PoC screencast video. We also asked
             for a recent (14-day trial)  version of Falcon Sensor to
             provide reliable information if  the most recent version
             is still vulnerable or not.
             
2022/07/05 - CS answered: "We  do not provide trial  licenses as part
             of this  process, however having  tested the PoC  on our
             end with  a modern sensor this  does not appear to  be a
             valid issue."
             
2022/07/05 - modzero  announced publishing  the advisory  and exploit
             code by end  of week, asking if the quote  of CS "Having
             tested the PoC on our end with a modern sensor this does
             not  appear to  be a  valid issue"  can be  used in  our
             report.
             
2022/07/06 - CS asking for a  meeting between modzero's Sr Leadership
             and CS to  discuss next steps related to  the bug bounty
             disclosure.
             
2022/07/07 - modzero, again,  told CS, that we  are not participating
             in any bug  bounty program and that there is  no need to
             discuss NDAs or bug bounty programs.
             
2022/08/12 - modzero managed to acquire a recent version (6.42.15610)
             of CrowdStrike  Falcon and verified, that  the attack is
             still  possible. Furthermore,  modzero figured  out that
             the  vulnerability  (that  was rejected  by  CrowdStrike
             first) has  been silently fixed:  The PoC that  has been
             sent  to  CrowdStrike  was  flagged  as  malicious.  The
             msiexec  call of  the  deinstaller was  also flagged  as
             malicious.  Both "countermeasures"  can be  circumvented
             easily, we updated the exploit accordingly.
             
2022/08/22 - modzero   publishes   Security  Advisory   and   exploit
             code,  because  CrowdStrike  was  unwilling  to  set  up
             a  cooperative  information  exchange outside  of  their
             NDA-ridden BugBounty program  to discuss vulnerabilities
             in their products.
</pre>
</div>

<div class="posted">
	<br />Posted by modzero
| <a class="link" href="../../../../../archives/2022/08/22/ridiculous_vulnerability_disclosure_process_with_crowdstrike_falcon_sensor/index.html">Permanent link</a>
| File under: <!-- security --><a href="../../../../../archives/security/index.html">security</a>,
<!-- software --><a href="../../../../../archives/software/index.html">software</a>,
<!-- hacking --><a href="../../../../../archives/hacking/index.html">hacking</a>,
<!-- modzero --><a href="../../../../../archives/modzero/index.html">modzero</a>,
<!-- exploit --><a href="../../../../../archives/exploit/index.html">exploit</a>,
<!-- redteam --><a href="../../../../../archives/redteam/index.html">redteam</a>,
<!-- rant --><a href="../../../../../archives/rant/index.html">rant</a>,
<!-- advisory --><a href="../../../../../archives/advisory/index.html">advisory</a>
<!-- <br /><a href="../../../../../archives/2022/08/22/ridiculous_vulnerability_disclosure_process_with_crowdstrike_falcon_sensor/index.html#comments">Comments</a> -->
</div>
		<div class="menu">
			<a href="#top">&#47;&#92;</a>
		</div>

	</div><!-- /archives div -->

</div><!-- /container div -->

</body>
</html>
