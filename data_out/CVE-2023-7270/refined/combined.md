=== Content from www.freeoffice.com_4a88aee0_20250111_091152.html ===


[![](/images/logo/freeoffice_logo.svg)](https://www.freeoffice.com/)

* [Home](/de/)
* [Download](/de/download/programme)
  + [Programme](/de/download/programme)
  + [Servicepacks](/de/download/servicepacks)
  + [Handbücher](/de/download/handbuecher)
* [Features](/de/features/freeoffice)
  + [Übersicht](/de/features/freeoffice)
  + [TextMaker](/de/features/freeoffice-textmaker)
  + [PlanMaker](/de/features/freeoffice-planmaker)
  + [Presentations](/de/features/freeoffice-presentations)
  + [Mehr ...](https://www.softmaker.de/softmaker-office-entdecken)
* [Presse](/de/presse)
* [Service](/de/service)
  + [Tipps & Tricks](/de/service/tipps-und-tricks/textmaker)
  + [Supportforum](https://forum.softmaker.de)
  + [Blog](https://www.softmaker.de/blog)
* [Über uns](/de/ueber-uns)

![Deutsch](/media/mod_falang/images/de_de.gif "Deutsch")

* [![English](/media/mod_falang/images/en_gb.gif "English") English](/en/download/servicepacks)
* [![Deutsch](/media/mod_falang/images/de_de.gif "Deutsch") Deutsch](/de/download/servicepacks)
* [![Français](/media/mod_falang/images/fr_fr.gif "Français") Français](/fr/telecharger/servicepacks)
* [![Italiano](/media/mod_falang/images/it_it.gif "Italiano") Italiano](/it/scarica/servicepack)
* [![Español](/media/mod_falang/images/es_es.gif "Español") Español](/es/descargar/paquetes-de-servicio)
* [![Português](/media/mod_falang/images/pt_br.gif "Português") Português](/pt/baixar/servicepacks)
* [![Nederlands](/media/mod_falang/images/nl_nl.gif "Nederlands") Nederlands](/nl/downloaden/servicepacks)
* [![Svenska](/media/mod_falang/images/sv_se.gif "Svenska") Svenska](/sv/laddaned/servicepaket)
* [![Polski](/media/mod_falang/images/pl_pl.gif "Polski") Polski](/pl/pobieranie/pakiety-serwisowe)
* [![Magyar](/media/mod_falang/images/hu_hu.gif "Magyar") Magyar](/hu/letoltes/szervizcsomagok)
* [![Türkçe](/media/mod_falang/images/tr_tr.gif "Türkçe") Türkçe](/tr/indir/servisyamalari)
* [![Русский](/media/mod_falang/images/ru_ru.gif "Русский") Русский](/ru/download/servicepacks)
* [![简体中文](/media/mod_falang/images/zh_cn.gif "简体中文") 简体中文](/zh/download/servicepacks)
* [![日本語](/media/mod_falang/images/ja_jp.gif "日本語") 日本語](/ja/download/servicepacks)
* [![한국어](/media/mod_falang/images/ko_kr.gif "한국어") 한국어](/ko/download/servicepacks)

# FreeOffice 2024

## Kostenlose Servicepacks

### Wie Sie FreeOffice aktuell halten

Wir verbessern FreeOffice 2024, die beste kostenlose Alternative zu Microsoft Office, kontinuierlich mit Fehlerkorrekturen und Funktionsverbesserungen. Bitte lesen Sie die folgenden Hinweise durch, um sicherzustellen, dass Ihre Installation stets aktuell ist.

#### FreeOffice 2024 für Windows

Standardmäßig hält sich FreeOffice für Windows selbst aktuell, indem es Servicepacks automatisch von unseren Servern herunterlädt.

Wenn Sie den automatischen Updater nicht installiert haben oder einfach nur wissen wollen, ob Ihre Version von FreeOffice aktuell ist, können Sie auch von Hand nach Updates suchen.

Starten Sie eines der FreeOffice-Programme, klicken Sie auf das Symbol „?“ im Ribbon und wählen Sie den Befehl **Nach Updates suchen** aus.

#### FreeOffice 2024 für Mac

Sie können FreeOffice für Mac **[hier](https://www.softmaker.net/down/softmaker-freeoffice-2024.pkg)** herunterladen.

#### FreeOffice 2024 für Linux

Anweisungen zum Installieren und Aktualisieren von FreeOffice für Linux finden Sie **[hier](/de/service/tipps-und-tricks/linux)**.

---

### 30.11.2024: Revision 1222

Fehlerkorrekturen

---

### 22.11.2024: Revision 1220

Fehlerkorrekturen

---

### 29.08.2024: Revision 1218

Fehlerkorrekturen

---

### 12.07.2024: Revision 1216

* **Mac:** Das Installationspaket enthält jetzt nicht nur eine Version für Intel-CPUs, sondern auch für Apple-Silicon-CPUs, und nutzt damit die Geschwindigkeit moderner Apple-CPUs voll aus.
* **Windows:** Die Fehlermeldung bei der Deinstallation, dass das Programm syspin64.exe nicht gefunden wurde, erscheint nicht mehr. Die Meldung konnte aber auch ohne Probleme ignoriert werden.
* In bestimmten Situationen erschien beim Programmstart ein Titelbild, das nicht erscheinen sollte.

---

### 18.06.2024: Revision 1215

Revision 1215 ist die erste ausgelieferte Revision von FreeOffice 2024.

Wir verwenden Cookies. Einige von ihnen sind für das Funktionieren dieser Website notwendig, andere ermöglichen uns, Besuchsstatistiken zu erheben.

[Datenschutzerklärung](/de/datenschutz)
Alle Cookies akzeptieren

Cookie-Einstellungen anpassen

## Datenschutzeinstellungen anpassen

* Für die Funktionsweise der Website erforderliche Cookies zulassen.

  Einige Cookies sind notwendig, um Ihnen die grundlegenden Funktionen dieser Website bereitzustellen, und können daher nicht deaktiviert werden.

  [Erläuterungen zu erforderlichen Cookies](/de/datenschutz#CookieDocumentation)
* Statistik-Cookies zulassen

  Wir nutzen auf unseren Websites die Open-Source-Software Matomo zur Erhebung von Besuchsstatistiken. Mit Matomo werden keine Daten an Server übermittelt, die außerhalb unserer Kontrolle liegen.

  Matomo verwendet Cookies. Mit diesen Cookies können wir Besuche zählen und die Nutzung unserer Websites analysieren.

  Wenn Sie mit der Auswertung Ihrer Daten einverstanden sind, dann lassen Sie bitte diese Cookies zu.

  [Weitere Informationen zur Nutzung von Matomo](/de/datenschutz#MatomoDocumentation)

  Schließen

Copyright ©  [SoftMaker](https://www.softmaker.de) | [Impressum](/de/ueber-uns) | [Datenschutz](/de/datenschutz)



=== Content from softmaker.de_9fd2341c_20250111_091152.html ===


* [Home](/)
* [Shop](/shop/uebersicht)
* [Produkte](/produkte)
  + [SoftMaker Office für Windows, Mac und Linux](/produkte/softmaker-office)
  + [SoftMaker Office für iOS und Android](/produkte/softmaker-office-ios-android)
  + [NEU: FlexiPDF NX und 2025](/produkte/flexipdf)
  + [Schriften](/produkte/schriften)
* [Download](/download/programme)
  + [Programme](/download/programme)
  + [Servicepacks](/download/servicepacks)
  + [Alte Versionen](/download/alte-versionen)
  + [Handbücher](/download/handbuecher)
* [Support](/support)
  + [Installation](/support/installation/windows)
  + [Forum](https://forum.softmaker.de/)
  + [Kundendienst](/support/kundendienst)
  + [Handbücher](/support/handbuecher)
  + [Feedback](/support/feedback)
  + [Newsletter](/support/newsletter)
  + [Tipps und Tricks](/support/tipps-und-tricks/textmaker)
* [Blog](/blog)
  + [Bytes und mehr](/blog/bytes-und-mehr)
  + [SoftMaker Office](/blog/softmaker-office)
  + [FlexiPDF](/blog/flexipdf)
  + [Typografie](/blog/typografie)
* [Mein Konto](/mein-konto)
* [![Einkaufswagen](https://eshop.softmaker.de/cart-image)](/einkaufswagen)

* [Mein Konto](/mein-konto)
* [![Einkaufswagen](https://eshop.softmaker.de/cart-image)](/einkaufswagen)

![Deutsch](/media/mod_falang/images/de_de.gif "Deutsch")

* [![English](/media/mod_falang/images/en_gb.gif "English") English](http://www.softmaker.com/en/download/servicepacks)
* [![Deutsch](/media/mod_falang/images/de_de.gif "Deutsch") Deutsch](/download/servicepacks)
* [![Français](/media/mod_falang/images/fr_fr.gif "Français") Français](http://www.softmaker.com/fr/telechargement/servicepacks)
* [![Italiano](/media/mod_falang/images/it_it.gif "Italiano") Italiano](http://www.softmaker.com/it/download/servicepack)
* [![Español](/media/mod_falang/images/es_es.gif "Español") Español](http://www.softmaker.com/es/descargar/paquetes-de-servicio)
* [![Português](/media/mod_falang/images/pt_br.gif "Português") Português](http://www.softmaker.com/pt/baixar/servicepacks)
* [![Nederlands](/media/mod_falang/images/nl_nl.gif "Nederlands") Nederlands](http://www.softmaker.com/nl/downloaden/servicepacks)
* [![Svenska](/media/mod_falang/images/sv_se.gif "Svenska") Svenska](http://www.softmaker.com/sv/laddaned/servicepaket)
* [![Polski](/media/mod_falang/images/pl_pl.gif "Polski") Polski](http://www.softmaker.com/pl/pobieranie/pakiety-serwisowe)
* [![Русский](/media/mod_falang/images/ru_ru.gif "Русский") Русский](http://www.softmaker.com/ru/download/servicepacks)

# Servicepacks

**Mit kostenlosen Servicepacks bringen Sie Ihre Software auf den neuesten Stand. Diese korrigieren Probleme in der Software und fügen neue Funktionen hinzu.**

Das aktuelle Servicepack für ein Programm enthält stets auch alle vorhergehenden Servicepacks. Sie müssen also lediglich das aktuelle Servicepack installieren.

| Programm | Revision | Datum |  |
| --- | --- | --- | --- |
| SoftMaker Office NX für Windows, Mac und Linux | 1222 | 30.11.2024 | [Weiterlesen](/download/servicepacks/servicepacks-softmaker-office-nx) |
| SoftMaker Office NX für iOS und Android | 1216 | 12.07.2024 | [Weiterlesen](/download/servicepacks/servicepacks-softmaker-office-nx) |
| SoftMaker Office 2024 für Windows, Mac und Linux | 1222 | 30.11.2024 | [Weiterlesen](/download/servicepacks/servicepacks-softmaker-office-2024) |
| FlexiPDF NX und 2025 für Windows | 404 | 15.11.2024 | [Weiterlesen](/download/servicepacks/servicepacks-flexipdf) |

# Vielen Dank.

Das Produkt wurde in den Einkaufswagen gelegt.

Weiter stöbern [Bestellung abschließen](/einkaufswagen)

# Sprache

Der SoftMaker-Blog ist nicht in Ihrer Sprache verfügbar. Möchten Sie den Blog auf Englisch lesen?
[Ja](/en/blog) Nein

# Sprache

Der SoftMaker-Blog ist nicht in Ihrer Sprache verfügbar. Möchten Sie den Blog auf Englisch lesen?
[Ja](/en/blog/bytes-and-beyond) Nein

# Sprache

Der SoftMaker-Blog ist nicht in Ihrer Sprache verfügbar. Möchten Sie den Blog auf Englisch lesen?
[Ja](/en/blog/softmaker-office) Nein

# Sprache

Der SoftMaker-Blog ist nicht in Ihrer Sprache verfügbar. Möchten Sie den Blog auf Englisch lesen?
[Ja](/en/blog/flexipdf) Nein

# Sprache

Der SoftMaker-Blog ist nicht in Ihrer Sprache verfügbar. Möchten Sie den Blog auf Englisch lesen?
[Ja](/en/blog/typography) Nein

# Sprache

Der SoftMaker-Blog ist nicht in Ihrer Sprache verfügbar.

Möchten Sie zur Homepage in Ihrer Sprache wechseln?

[Ja](https://www.softmaker.com) Nein

Wir verwenden Cookies. Einige von ihnen sind für das Funktionieren dieser Website notwendig, andere ermöglichen uns, Besuchsstatistiken zu erheben.

[Datenschutzerklärung](/datenschutz)
Alle Cookies akzeptieren

Cookie-Einstellungen anpassen

## Datenschutzeinstellungen anpassen

* Für die Funktionsweise der Website erforderliche Cookies zulassen

  Einige Cookies sind notwendig, um Ihnen die grundlegenden Funktionen dieser Website bereitzustellen, und können daher nicht deaktiviert werden.

  [Erläuterungen zu erforderlichen Cookies](/datenschutz#CookieDocumentation)
* Statistik-Cookies zulassen

  Wir nutzen auf unseren Websites die Open-Source-Software Matomo zur Erhebung von Besuchsstatistiken. Mit Matomo werden keine Daten an Server übermittelt, die außerhalb unserer Kontrolle liegen.

  Matomo verwendet Cookies. Mit diesen Cookies können wir Besuche zählen und die Nutzung unserer Websites analysieren.

  Wenn Sie mit der Auswertung Ihrer Daten einverstanden sind, dann lassen Sie bitte diese Cookies zu.

  [Weitere Informationen zur Nutzung von Matomo](/datenschutz#MatomoDocumentation)

  Schließen

Folgen Sie uns auf

* SoftMaker
* [Über uns](/ueber-uns)
* [Produktgeschichte](/produktgeschichte)
* [Pressebereich](/pressebereich)
* [Stellenangebote](/stellenangebote)
* [Händler werden](/haendler-werden)

* Rechtliches
* [Datenschutzerklärung](/datenschutz)
* [Allgemeine Geschäftsbedingungen](/allgemeine-geschaeftsbedingungen)
* [Impressum](/impressum)

* Sprechen Sie mit uns
* [Feedback](/feedback)
* [Forum](https://forum.softmaker.de)
* [Kontakt](/kontakt)
* [Kundendienst](/support/kundendienst)



=== Content from seclists.org_68cee429_20250111_091150.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![fulldisclosure logo](/images/fulldisclosure-logo.png)](/fulldisclosure/)
## [Full Disclosure](/fulldisclosure/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](4)
[By Date](date.html#5)
[![Next](/images/right-icon-16x16.png)](6)

[![Previous](/images/left-icon-16x16.png)](4)
[By Thread](index.html#5)
[![Next](/images/right-icon-16x16.png)](6)

![](/shared/images/nst-icons.svg#search)

# SEC Consult SA-20240627-0 :: Local Privilege Escalation via MSI installer in SoftMaker Office / FreeOffice

---

*From*: SEC Consult Vulnerability Lab via Fulldisclosure <fulldisclosure () seclists org>

*Date*: Thu, 27 Jun 2024 10:18:16 +0000

---

```
SEC Consult Vulnerability Lab Security Advisory < 20240627-0 >
=======================================================================
               title: Local Privilege Escalation via MSI installer
             product: SoftMaker Office / FreeOffice
  vulnerable version: SoftMaker Office 2024 / NX before revision 1214
                      FreeOffice 2021 Revision 1068
                      FreeOffice 2024 before revision 1215
       fixed version: SoftMaker Office 2024 / NX - revision 1214
                      FreeOffice 2024 - revision 1215
          CVE number: CVE-2023-7270
              impact: high
            homepage: <https://www.softmaker.com/en/>
               found: 2023-11-27
                  by: Michael Baer (Office Fürth)
                      SEC Consult Vulnerability Lab

                      An integrated part of SEC Consult, an Eviden business
                      Europe | Asia

                      <https://www.sec-consult.com>

=======================================================================

Vendor description:
-------------------
"SoftMaker Office makes working with documents, spreadsheets and presentations
a breeze – whether you're on Windows, Linux, Mac, iOS or Android."

Source: <https://www.softmaker.com/en/products/softmaker-office>

Business recommendation:
------------------------
The vendor provides a patch which should be installed immediately.

SEC Consult highly recommends to perform a thorough security review of the
product conducted by security professionals to identify and resolve potential
further security issues.

Vulnerability overview/description:
-----------------------------------
1) Local Privilege Escalation via MSI installer (CVE-2023-7270)
The SoftMaker Office and FreeOffice MSI installer files were found to produce
a visible conhost.exe window running as the SYSTEM user when using the repair
function of msiexec.exe.

This allows a local, low-privileged attacker to use a chain of actions,
to open a fully functional cmd.exe with the privileges of the SYSTEM user.

Note:
This attack does not work using a recent version of the Edge Browser or
Internet Explorer. A different browser, such as Chrome or Firefox, needs to be
used. Also make sure, that Edge or IE have not been set as default browser
and that Firefox or Chrome are not running before attempting to exploit it.
Otherwise, the spawned process would be running with your own permissions and
the installer will just add a new tab to the browser, instead of spawning a
new process with SYSTEM.

Proof of concept:
-----------------
1) Local Privilege Escalation via MSI installer (CVE-2023-7270)
For the exploit to work, SoftMaker Office or FreeOffice have to be installed
via the MSI file. Afterwards, any low-privileged user can start the
repair of the software by double-clicking the installer and trigger
the vulnerable actions without a UAC popup. The installer, if deleted from it's
original location, can be found in C:\Windows\Installer with a randomized name.

During the repair process, a console application gets called with SYSTEM
privileges and performs a read action on some files.

SoftMaker Office: Executes 7z.exe, which reads
C:\Program Files\SoftMaker Office 2024\tb\7z.exe

FreeOffice: Executes syspin.exe, which reads
C:\Windows\SysWOW64\OneCoreCommonProxyStub.dll

This can be used by an attacker by simply setting an oplock on the files
mentioned before.

As soon as it gets read, the process is blocked until the lock is released.

To do that, one can use the 'SetOpLock.exe' tool from
"[https://github.com/googleprojectzero/symboliclink-testing-tools"](https://github.com/googleprojectzero/symboliclink-testing-tools%22);
with the following parameters:

while ($true) { SetOpLock.exe "C:\Program Files\SoftMaker Office 2024\tb\7z.exe" x }
while ($true) { SetOpLock.exe "C:\Windows\SysWOW64\OneCoreCommonProxyStub.dll" x }

See figure 1 [soft_lock.png] and figure 2 [lock.png]

During the repair process, the locked file is accessed multiple times. The lock
has to be released by pressing ENTER several times before the window opens.

If the window appears, the lock should not be released to keep the
window open. The window that gets opened when the console program is
executed doesn't close and can then be interacted with.

Note 1: The syspin.exe window is minimized. When the lock is triggered, it
is advised to check the taskbar whether a window with a blue arrow,
see figure 7 [taskbar.png], exists.

The attacker can then perform the following actions to spawn a SYSTEM shell:
- Right click on the top bar of the window
- Click on properties, see figure 3 [soft_openbrowser.png] and figure 4 [openbrowser.png]
- Under options, click on the "new console features" link
- Open the link with e.g. firefox
- In the opened browser window press the key combination CTRL+o
- Type cmd.exe in the top bar and press Enter, see figure 5 [soft_cmd.png] and figure 6 [cmd.png]

Note 2: This does not work using a recent version of the Edge Browser.

Note 3: The program syspin.exe is invoked several times, sometimes without
elevated privileges. If the final cmd.exe is not elevated, release the lock
and wait for the next syspin.exe invocation. During our test, the fifth
window was run with elevated privileges.

Vulnerable / tested versions:
-----------------------------
The following versions have been tested by SEC Consult which were the most recent
versions available at the time of the test:
* SoftMaker Office 2024 - 24.0.6034
* FreeOffice 2021 Revision 1068

According to the vendor, all versions of SoftMaker Office NX/2024 before revision 1214
and FreeOffice 2024 before revision 1215 with the MSI installer are affected.

FreeOffice 2021 is unsupported and will not be fixed according to the vendor.

Vendor contact timeline:
------------------------
2023-12-02: Contacting vendor through sales () softmaker de,
             asking for security contact.
2023-12-07: Contacting vendor through <https://www.softmaker.com/en/support/customer-support>
             asking for security contact.
2024-01-11: Contacting vendor through <https://www.softmaker.com/en/support/customer-support>
             asking for security contact.
2024-01-11: Vendor provides security contact and asks for advisory
             unencrypted
2024-01-12: Sending advisory draft unencrypted to security contact
2024-02-17: Asking for status of vulnerability, no response
2024-03-06: Asking for status of vulnerability, no response
2024-04-08: Asking for a status update, setting release date to
             17th April.
2024-04-08: Vendor response, seems not to have received our previous mails.
             Asking for deadline extension as a release it already planned.
2024-04-09: Sending advisory draft again, extending deadline.
2024-04-11: Asking whether email was received, confirmed. Sent proposed
             solution.
2024-04-22: Asking when new release is planned and whether fixes could be
             incorporated.
2024-04-23: Vendor response, current service pack update not including fixes,
             planned in about 6 weeks.
2024-05-27: Vendor response, service pack / revision 1214 was published which fixes
             the issue for Office 2024 and Office NX. FreeOffice 2024 will
             be fixed in the next release mid June. FreeOffice 2021 is unsupported.
2024-06-11: Vendor: FreeOffice 2024 will be patched on 18th June, asks for advisory
             release to be postponed a bit.
2024-06-17: Setting advisory release date for 27th June, reserving CVE.
2024-06-18: Vendor releases FreeOffice 2024 revision 1215.
2024-06-27: Release of security advisory.

Solution:
---------
The vendor provides a service pack version 1214 for SoftMaker Office 2024 and
SofMaker Office NX, which can be downloaded from:
<https://softmaker.de/download/servicepacks>

FreeOffice 2024 revision 1215:
<https://www.freeoffice.com/de/download/servicepacks>

FreeOffice 2021 is unsupported and will not be fixed according to the vendor.

Workaround:
-----------
None

Advisory URL:
-------------
<https://sec-consult.com/vulnerability-lab/>

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

SEC Consult Vulnerability Lab
An integrated part of SEC Consult, an Eviden business
Europe | Asia

About SEC Consult Vulnerability Lab
The SEC Consult Vulnerability Lab is an integrated part of SEC Consult, an
Eviden business. It ensures the continued knowledge gain of SEC Consult in the
field of network and application security to stay ahead of the attacker. The
SEC Consult Vulnerability Lab supports high-quality penetration testing and
the evaluation of new offensive and defensive technologies for our customers.
Hence our customers obtain the most current information about vulnerabilities
and valid recommendation about the risk profile of new technologies.

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Interested to work with the experts of SEC Consult?
Send us your application <https://sec-consult.com/career/>

Interested in improving your cyber security with the experts of SEC Consult?
Contact our local offices <https://sec-consult.com/contact/>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Mail: security-research at sec-consult dot com
Web: <https://www.sec-consult.com>
Blog: <https://blog.sec-consult.com>
Twitter: <https://twitter.com/sec_consult>

EOF Michael Baer / 2024
```

[![](att-5/lock.png)](att-5/lock.png)

[![](att-5/soft_openbrowser.png)](att-5/soft_openbrowser.png)

[![](att-5/soft_cmd.png)](att-5/soft_cmd.png)

[![](att-5/openbrowser.png)](att-5/openbrowser.png)

[![](att-5/taskbar.png)](att-5/taskbar.png)

[![](att-5/soft_lock.png)](att-5/soft_lock.png)

[![](att-5/cmd.png)](att-5/cmd.png)

```
_______________________________________________
Sent through the Full Disclosure mailing list
<https://nmap.org/mailman/listinfo/fulldisclosure>
Web Archives & RSS: <https://seclists.org/fulldisclosure/>
```

---

[![Previous](/images/left-icon-16x16.png)](4)
[By Date](date.html#5)
[![Next](/images/right-icon-16x16.png)](6)

[![Previous](/images/left-icon-16x16.png)](4)
[By Thread](index.html#5)
[![Next](/images/right-icon-16x16.png)](6)

### Current thread:

* **SEC Consult SA-20240627-0 :: Local Privilege Escalation via MSI installer in SoftMaker Office / FreeOffice** *SEC Consult Vulnerability Lab via Fulldisclosure (Jul 03)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")



=== Content from r.sec-consult.com_d8646fc4_20250111_091151.html ===

Toggle Navbar

* [Career](/career/)
* [About us](/about-us/)
* [Contact](/contact/)

* EN
  + [DE](/de/vulnerability-lab/advisory/local-privilege-escalation-ueber-msi-installer-in-softmaker-office-freeoffice/ "German")
Search

* Security Testing
  + [Web Application Security](/security-testing/web-application-security/)
  + [Penetration Testing](/security-testing/penetration-testing/)
  + [Mobile Security](/security-testing/mobile-security/)
  + [Cloud Security](/security-testing/cloud-security/)
  + [IT Infrastructure Security](/security-testing/it-infrastructure-security/)
  + [Security for SAP Services](/security-testing/security-for-sap-services/)
  + [IoT and Embedded Systems Security](/security-testing/iot-and-embedded-systems-security/)
  + [Red Teaming](/security-testing/red-teaming/)
* Processes & Organisation
  + [Information Security Management (ISM)](/processes-organisation/information-security-management-ism/)
  + [Network and Information Systems Security (NIS)](/processes-organisation/network-and-information-systems-security-nis/)
  + [OT Security](/processes-organisation/ot-security/)
  + [Secure Software Development Consulting](/processes-organisation/secure-software-development/)
  + [Red Teaming](/security-testing/red-teaming/)
  + [SEC Trainings](/processes-organisation/sec-trainings/)
  + [Project- und Program Management](/processes-organisation/project-und-program-management/)
* Incident Response
  + [SEC Defence](/incident-response/sec-defence/)
* [Vulnerability Lab](/vulnerability-lab/)
* [Blog](/blog/)
 [Incident?
Breached?
Report an incident](/incident-response/sec-defence/)

1. [Home](/)
2. [Vulnerability Lab](/vulnerability-lab/)
3. Local Privilege Escalation via MSI installer in SoftMaker Office / FreeOffice
# Local Privilege Escalation via MSI installer in SoftMaker Office / FreeOffice

Title

Local Privilege Escalation via MSI installer

Product

SoftMaker Office / FreeOffice

Vulnerable Version

SoftMaker Office 2024 / NX before revision 1214, FreeOffice 2021 Revision 1068, FreeOffice 2024 before revision 1215

Fixed Version

SoftMaker Office 2024 / NX - revision 1214, FreeOffice 2024 - revision 1215

CVE Number

CVE-2023-7270

Impact

high

Homepage

[https://www.softmaker.com/en/](https://www.softmaker.com/en/ "https://www.softmaker.com/en/")

Found

27.11.2023

By

Michael Baer (Office Fürth) | SEC Consult Vulnerability Lab

The MSI installers of SoftMaker Office and FreeOffice (SoftMaker) contained a privilege escalation vulnerability. This enabled a local, low-privileged attacker with GUI access to a system, where SoftMaker Office or FreeOffice are installed via MSI, to escalate the privileges to SYSTEM level.

## Vendor description

"*SoftMaker Office makes working with documents, spreadsheets and presentations a breeze – whether you're on Windows, Linux, Mac, iOS or Android.*"

Source: <https://www.softmaker.com/en/products/softmaker-office>

## Business recommendation

The vendor provides a patch which should be installed immediately.

SEC Consult highly recommends to perform a thorough security review of the product conducted by security professionals to identify and resolve potential further security issues.

## Vulnerability overview/description

### 1) Local Privilege Escalation via MSI installer (CVE-2023-7270)

The SoftMaker Office and FreeOffice MSI installer files were found to produce a visible conhost.exe window running as the SYSTEM user when using the repair function of msiexec.exe.

This allows a local, low-privileged attacker to use a chain of actions, to open a fully functional cmd.exe with the privileges of the SYSTEM user.

*Note*:
 This attack does not work using a recent version of the Edge Browser or Internet Explorer. A different browser, such as Chrome or Firefox, needs to be used. Also make sure, that Edge or IE have not been set as default browser and that Firefox or Chrome are not running before attempting to exploit it. Otherwise, the spawned process would be running with your own permissions and the installer will just add a new tab to the browser, instead of spawning a new process with SYSTEM.

## Proof of concept

### 1) Local Privilege Escalation via MSI installer (CVE-2023-7270)

For the exploit to work, SoftMaker Office or FreeOffice have to be installed via the MSI file. Afterwards, any low-privileged user can start the repair of the software by double-clicking the installer and trigger the vulnerable actions without a UAC popup. The installer, if deleted from it's original location, can be found in C:\Windows\Installer with a randomized name.

During the repair process, a console application gets called with SYSTEM privileges and performs a read action on some files.

SoftMaker Office: Executes 7z.exe, which reads

```
C:\Program Files\SoftMaker Office 2024\tb\7z.exe
```

FreeOffice: Executes syspin.exe, which reads

```
C:\Windows\SysWOW64\OneCoreCommonProxyStub.dll
```

This can be used by an attacker by simply setting an oplock on the files mentioned before.

As soon as it gets read, the process is blocked until the lock is released.

To do that, one can use the 'SetOpLock.exe' tool from "<https://github.com/googleprojectzero/symboliclink-testing-tools>" with the following parameters:

```
while ($true) { SetOpLock.exe "C:\Program Files\SoftMaker Office 2024\tb\7z.exe" x }
while ($true) { SetOpLock.exe "C:\Windows\SysWOW64\OneCoreCommonProxyStub.dll" x }
```
![](/fileadmin/_processed_/1/e/csm_sec-consult-c-softmaker-soft_lock_d08dbe5371.png)

Figure 1: Executing msiexec.exe to repair the SoftMaker Office MSI file, running "SetOpLock.exe" to set a lock

![](/fileadmin/_processed_/6/b/csm_sec-consult-c-softmaker-lock_7dc3203d7f.png)

Figure 2: Executing msiexec.exe to repair the FreeOffice MSI file, running "SetOpLock.exe" to set a lock

![](/fileadmin/user_upload/sec-consult/Dynamisch/Advisories/2024_06/sec-consult-c-softmaker-soft_openbrowser.png)

Figure 3: Console window properties, clicking on "new console features", opening the browser "Firefox" (or Chrome), but others won't work

![](/fileadmin/user_upload/sec-consult/Dynamisch/Advisories/2024_06/sec-consult-c-softmaker-openbrowser.png)

Figure 4: Same for FreeOffice 2021, just a different console window

![](/fileadmin/user_upload/sec-consult/Dynamisch/Advisories/2024_06/sec-consult-c-softmaker-soft_cmd.png)

Figure 5: Gaining SYSTEM access rights via SoftMaker Office MSI installer

![](/fileadmin/user_upload/sec-consult/Dynamisch/Advisories/2024_06/sec-consult-c-softmaker-sec-consult-c-softmaker-cmd.png)

Figure 6: Gaining SYSTEM access rights via FreeOffice MSI installer

![](/fileadmin/user_upload/sec-consult/Dynamisch/Advisories/2024_06/sec-consult-c-softmaker-taskbar.png)

Figure 7: Taskbar icon to look out for because the syspin.exe window is minimized

During the repair process, the locked file is accessed multiple times. The lock has to be released by pressing ENTER several times before the window opens.

If the window appears, the lock should not be released to keep the window open. The window that gets opened when the console program is executed doesn't close and can then be interacted with.

Note 1: The syspin.exe window is minimized. When the lock is triggered, it is advised to check the taskbar whether a window with a blue arrow [see figure 7] exists.

The attacker can then perform the following actions to spawn a SYSTEM shell:

* Right click on the top bar of the window
* Click on properties (see figure 3 and figure 4).
* Under options, click on the "new console features" link
* Open the link with e.g. firefox
* In the opened browser window press the key combination CTRL+o
* Type cmd.exe in the top bar and press Enter, see figure 5 and figure 6.

*Note 2*: This does not work using a recent version of the Edge Browser.

*Note 3*: The program syspin.exe is invoked several times, sometimes without elevated privileges. If the final cmd.exe is not elevated, release the lock and wait for the next syspin.exe invocation. During our test, the fifth window was run with elevated privileges.

## Vulnerable / tested versions

The following versions have been tested by SEC Consult which were the most recent versions available at the time of the test:

* SoftMaker Office 2024 - 24.0.6034
* FreeOffice 2021 Revision 1068

According to the vendor, all versions of SoftMaker Office NX/2024 before revision 1214 and FreeOffice 2024 before revision 1215 with the MSI installer are affected.

FreeOffice 2021 is unsupported and will not be fixed according to the vendor.

## Vendor contact timeline

| 2023-12-02 | Contacting vendor through sales@softmaker.de, asking for security contact. |
| --- | --- |
| 2023-12-07 | Contacting vendor through https://www.softmaker.com/en/support/customer-support asking for security contact. |
| 2024-01-11 | Contacting vendor through https://www.softmaker.com/en/support/customer-support asking for security contact. |
| 2024-01-11 | Vendor provides security contact and asks for advisory unencrypted |
| 2024-01-12 | Sending advisory draft unencrypted to security contact |
| 2024-02-17 | Asking for status of vulnerability, no response |
| 2024-03-06 | Asking for status of vulnerability, no response |
| 2024-04-08 | Asking for a status update, setting release date to 17th April. |
| 2024-04-08 | Vendor response, seems not to have received our previous mails. Asking for deadline extension as a release it already planned. |
| 2024-04-09 | Sending advisory draft again, extending deadline. |
| 2024-04-11 | Asking whether email was received, confirmed. Sent proposed solution. |
| 2024-04-22 | Asking when new release is planned and whether fixes could be incorporated. |
| 2024-04-23 | Vendor response, current service pack update not including fixes, planned in about 6 weeks. |
| 2024-05-27 | Vendor response, service pack / revision 1214 was published which fixes the issue for Office 2024 and Office NX. FreeOffice 2024 will be fixed in the next release mid June. FreeOffice 2021 is unsupported. |
| 2024-06-11 | Vendor: FreeOffice 2024 will be patched on 18th June, asks for advisory release to be postponed a bit. |
| 2024-06-17 | Setting advisory release date for 27th June, reserving CVE. |
| 2024-06-18 | Vendor releases FreeOffice 2024 revision 1215. |
| 2024-06-27 | Release of security advisory. |

## Solution

The vendor provides a service pack version 1214 for SoftMaker Office 2024 and SofMaker Office NX, which can be downloaded from:
<https://softmaker.de/download/servicepacks>

FreeOffice 2024 revision 1215:
<https://www.freeoffice.com/de/download/servicepacks>

FreeOffice 2021 is unsupported and will not be fixed according to the vendor.

## Workaround

None

## Advisory URL

<https://sec-consult.com/vulnerability-lab/>

EOF Michael Baer  @2024

*Interested to work with the experts of SEC Consult? Send us your [application](https://sec-consult.com/career/)*

*Interested in improving your cyber security with the experts of SEC Consult? Contact our [local offices](https://sec-consult.com/contact/)*

[Back](/vulnerability-lab/)

* [Legal Notice](/legalnotice/)
* [Privacy Statement](/privacy-statement/)
* [Jobs](/career/)

SEC Consult is one of the leading consultancies in the field of cyber and [application security](/security-testing/web-application-security/ "Web Application Security"). The company specializes in [information security management](/processes-organisation/information-security-management-ism/ "Information Security Management (ISM)"), [NIS security audits](/processes-organisation/network-and-information-systems-security-nis/ "NIS security audits"), [penetration testing](/security-testing/penetration-testing/ "Pentesting (Pentest)"), ISO 27001 certification support, [Cyber Defence](/incident-response/sec-defence/ "Cyber Defence") and [secure software certification](/processes-organisation/secure-software-development/ "Secure Software Development Consulting"). SEC Consult is part of [Eviden](https://eviden.com/ "Link to Eviden website").

[![bsi ISO/IEC 27001 Information Security Management CERTIFIED](/typo3temp/assets/_processed_/c/2/csm_bsi_9a24e74563.png)](/about-us/ "About us")[![ISO 27001 CREST certified](/typo3temp/assets/_processed_/0/6/csm_crest_0eb9c5864d.png)](/about-us/ "About us")[![Great Place To Work AT certified](/typo3temp/assets/_processed_/0/3/csm_great-place-to-work-at_773b265aa6.png)](/about-us/ "About us")[![Great Place To Work DE certified](/typo3temp/assets/_processed_/d/6/csm_great-place-to-work-de_2fcb537270.png)](/about-us/ "About us")

## We use Cookies

We use cookies to offer you a perfect visit experience. These include cookies that are necessary for the operation of the site and for the control of our commercial corporate goals, as well as those that are only used for anonymous statistical purposes, for convenience settings or to display personalized content. Decide for yourself which categories you want to allow. Please note that based on your settings, not all functions of the site may be available.

**[Legal Notice](/legalnotice/)** •  **[Privacy Statement](/privacy-statement/)**

### Technically required

(
0
Service
)

no

Technically required (
0
Service
)

yes

### Analysis / statistics

(
1
Service
)

Anonymous evaluation for troubleshooting and further development

no

Analysis / statistics (
1
Service
)

yes

#### Matomo

no

Matomo

yes

Matomo.org
Show details

Hide details

**Purpose**: Error analysis, statistical evaluation of our website accesses, campaign analysis, conversion tracking.
 **Processing operations**: collection of access data, data from your browser and data about the content accessed; execution of analysis software and storage of data on your terminal device, anonymization of the data collected; evaluation of the anonymous data in the form of statistics.
 **Storage period**: 1 year.
 **Joint controller**: LimeSoda Interactive Marketing GmbH.
 **Legal basis for data processing**: Art. 6 para. 1 lit. f of the DSGVO.
 **Consequences of non-consent**: This basic tracking is absolutely necessary for the operation of our website.
 **Data transfer**: The data collected with Matomo is stored on our own servers. It is not passed on to third parties.

Accept selected

Reject all

Accept all


