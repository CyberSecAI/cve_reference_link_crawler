=== Content from git.kernel.org_cfab88ef_20250110_232853.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=007180fcb6cc4a93211d4cc45fef3f5ccccd56ae)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=007180fcb6cc4a93211d4cc45fef3f5ccccd56ae)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=007180fcb6cc4a93211d4cc45fef3f5ccccd56ae)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=007180fcb6cc4a93211d4cc45fef3f5ccccd56ae)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | T.J. Mercier <tjmercier@google.com> | 2024-08-30 19:26:26 +0000 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-10-17 15:07:34 +0200 |
| commit | [007180fcb6cc4a93211d4cc45fef3f5ccccd56ae](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=007180fcb6cc4a93211d4cc45fef3f5ccccd56ae) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=007180fcb6cc4a93211d4cc45fef3f5ccccd56ae)) | |
| tree | [bde062c2f74489c4fd4aa5a438dfd57f867b5a2f](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=007180fcb6cc4a93211d4cc45fef3f5ccccd56ae) | |
| parent | [5a2cc2bb81399e9ebc72560541137eb04d61dc3d](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=5a2cc2bb81399e9ebc72560541137eb04d61dc3d) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=007180fcb6cc4a93211d4cc45fef3f5ccccd56ae&id2=5a2cc2bb81399e9ebc72560541137eb04d61dc3d)) | |
| download | [linux-007180fcb6cc4a93211d4cc45fef3f5ccccd56ae.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-007180fcb6cc4a93211d4cc45fef3f5ccccd56ae.tar.gz) | |

dma-buf: heaps: Fix off-by-one in CMA heap fault handlercommit ea5ff5d351b520524019f7ff7f9ce418de2dad87 upstream.
Until VM\_DONTEXPAND was added in commit 1c1914d6e8c6 ("dma-buf: heaps:
Don't track CMA dma-buf pages under RssFile") it was possible to obtain
a mapping larger than the buffer size via mremap and bypass the overflow
check in dma\_buf\_mmap\_internal. When using such a mapping to attempt to
fault past the end of the buffer, the CMA heap fault handler also checks
the fault offset against the buffer size, but gets the boundary wrong by
1. Fix the boundary check so that we don't read off the end of the pages
array and insert an arbitrary page in the mapping.
Reported-by: Xingyu Jin <xingyuj@google.com>
Fixes: a5d2d29e24be ("dma-buf: heaps: Move heap-helper logic into the cma\_heap implementation")
Cc: stable@vger.kernel.org # Applicable >= 5.10. Needs adjustments only for 5.10.
Signed-off-by: T.J. Mercier <tjmercier@google.com>
Acked-by: John Stultz <jstultz@google.com>
Signed-off-by: Sumit Semwal <sumit.semwal@linaro.org>
Link: [https://patchwork.freedesktop.org/patch/msgid/20240830192627.2546033-1-tjmercier@google.com](https://patchwork.freedesktop.org/patch/msgid/20240830192627.2546033-1-tjmercier%40google.com)
[ TJ: Backport to 5.10. On this kernel the bug is located in
dma\_heap\_vm\_fault which is used by both the CMA and system heaps. ]
Signed-off-by: T.J. Mercier <tjmercier@google.com>
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=007180fcb6cc4a93211d4cc45fef3f5ccccd56ae)

| -rw-r--r-- | [drivers/dma-buf/heaps/heap-helpers.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/dma-buf/heaps/heap-helpers.c?id=007180fcb6cc4a93211d4cc45fef3f5ccccd56ae) | 2 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 1 insertions, 1 deletions

| diff --git a/drivers/dma-buf/heaps/heap-helpers.c b/drivers/dma-buf/heaps/heap-helpers.cindex d0696cf937af34..a852b5e8122fac 100644--- a/[drivers/dma-buf/heaps/heap-helpers.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/dma-buf/heaps/heap-helpers.c?id=5a2cc2bb81399e9ebc72560541137eb04d61dc3d)+++ b/[drivers/dma-buf/heaps/heap-helpers.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/dma-buf/heaps/heap-helpers.c?id=007180fcb6cc4a93211d4cc45fef3f5ccccd56ae)@@ -161,7 +161,7 @@ static vm\_fault\_t dma\_heap\_vm\_fault(struct vm\_fault \*vmf) struct vm\_area\_struct \*vma = vmf->vma; struct heap\_helper\_buffer \*buffer = vma->vm\_private\_data; - if (vmf->pgoff > buffer->pagecount)+ if (vmf->pgoff >= buffer->pagecount) return VM\_FAULT\_SIGBUS;  vmf->page = buffer->pages[vmf->pgoff]; |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-10 23:27:30 +0000



=== Content from git.kernel.org_88efd9d6_20250110_232854.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=84175dc5b2c932266a50c04e5ce342c30f817a2f)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=84175dc5b2c932266a50c04e5ce342c30f817a2f)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=84175dc5b2c932266a50c04e5ce342c30f817a2f)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=84175dc5b2c932266a50c04e5ce342c30f817a2f)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | T.J. Mercier <tjmercier@google.com> | 2024-08-30 19:26:26 +0000 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-09-18 19:23:06 +0200 |
| commit | [84175dc5b2c932266a50c04e5ce342c30f817a2f](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=84175dc5b2c932266a50c04e5ce342c30f817a2f) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=84175dc5b2c932266a50c04e5ce342c30f817a2f)) | |
| tree | [46285e676d0491e40dea36321fc77a180f0b9d05](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=84175dc5b2c932266a50c04e5ce342c30f817a2f) | |
| parent | [94c705fb4dfee363586e0b8e8f7f73b0a69bd8f1](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=94c705fb4dfee363586e0b8e8f7f73b0a69bd8f1) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=84175dc5b2c932266a50c04e5ce342c30f817a2f&id2=94c705fb4dfee363586e0b8e8f7f73b0a69bd8f1)) | |
| download | [linux-84175dc5b2c932266a50c04e5ce342c30f817a2f.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-84175dc5b2c932266a50c04e5ce342c30f817a2f.tar.gz) | |

dma-buf: heaps: Fix off-by-one in CMA heap fault handlercommit ea5ff5d351b520524019f7ff7f9ce418de2dad87 upstream.
Until VM\_DONTEXPAND was added in commit 1c1914d6e8c6 ("dma-buf: heaps:
Don't track CMA dma-buf pages under RssFile") it was possible to obtain
a mapping larger than the buffer size via mremap and bypass the overflow
check in dma\_buf\_mmap\_internal. When using such a mapping to attempt to
fault past the end of the buffer, the CMA heap fault handler also checks
the fault offset against the buffer size, but gets the boundary wrong by
1. Fix the boundary check so that we don't read off the end of the pages
array and insert an arbitrary page in the mapping.
Reported-by: Xingyu Jin <xingyuj@google.com>
Fixes: a5d2d29e24be ("dma-buf: heaps: Move heap-helper logic into the cma\_heap implementation")
Cc: stable@vger.kernel.org # Applicable >= 5.10. Needs adjustments only for 5.10.
Signed-off-by: T.J. Mercier <tjmercier@google.com>
Acked-by: John Stultz <jstultz@google.com>
Signed-off-by: Sumit Semwal <sumit.semwal@linaro.org>
Link: [https://patchwork.freedesktop.org/patch/msgid/20240830192627.2546033-1-tjmercier@google.com](https://patchwork.freedesktop.org/patch/msgid/20240830192627.2546033-1-tjmercier%40google.com)
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=84175dc5b2c932266a50c04e5ce342c30f817a2f)

| -rw-r--r-- | [drivers/dma-buf/heaps/cma\_heap.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/dma-buf/heaps/cma_heap.c?id=84175dc5b2c932266a50c04e5ce342c30f817a2f) | 2 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 1 insertions, 1 deletions

| diff --git a/drivers/dma-buf/heaps/cma\_heap.c b/drivers/dma-buf/heaps/cma\_heap.cindex 28fb04eccdd0ca..ec2a2a1560a472 100644--- a/[drivers/dma-buf/heaps/cma\_heap.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/dma-buf/heaps/cma_heap.c?id=94c705fb4dfee363586e0b8e8f7f73b0a69bd8f1)+++ b/[drivers/dma-buf/heaps/cma\_heap.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/dma-buf/heaps/cma_heap.c?id=84175dc5b2c932266a50c04e5ce342c30f817a2f)@@ -165,7 +165,7 @@ static vm\_fault\_t cma\_heap\_vm\_fault(struct vm\_fault \*vmf) struct vm\_area\_struct \*vma = vmf->vma; struct cma\_heap\_buffer \*buffer = vma->vm\_private\_data; - if (vmf->pgoff > buffer->pagecount)+ if (vmf->pgoff >= buffer->pagecount) return VM\_FAULT\_SIGBUS;  vmf->page = buffer->pages[vmf->pgoff]; |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-10 23:27:31 +0000



=== Content from git.kernel.org_3b421013_20250110_232853.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=79cce5e81d20fa9ad553be439d665ac3302d3c95)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=79cce5e81d20fa9ad553be439d665ac3302d3c95)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=79cce5e81d20fa9ad553be439d665ac3302d3c95)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=79cce5e81d20fa9ad553be439d665ac3302d3c95)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | T.J. Mercier <tjmercier@google.com> | 2024-08-30 19:26:26 +0000 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-10-17 15:10:37 +0200 |
| commit | [79cce5e81d20fa9ad553be439d665ac3302d3c95](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=79cce5e81d20fa9ad553be439d665ac3302d3c95) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=79cce5e81d20fa9ad553be439d665ac3302d3c95)) | |
| tree | [a2b324a46a67959ece1834ea95845d79871889d7](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=79cce5e81d20fa9ad553be439d665ac3302d3c95) | |
| parent | [16b3e7addd5b50e08afe3f34867a99f74e9bed8a](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=16b3e7addd5b50e08afe3f34867a99f74e9bed8a) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=79cce5e81d20fa9ad553be439d665ac3302d3c95&id2=16b3e7addd5b50e08afe3f34867a99f74e9bed8a)) | |
| download | [linux-79cce5e81d20fa9ad553be439d665ac3302d3c95.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-79cce5e81d20fa9ad553be439d665ac3302d3c95.tar.gz) | |

dma-buf: heaps: Fix off-by-one in CMA heap fault handlercommit ea5ff5d351b520524019f7ff7f9ce418de2dad87 upstream.
Until VM\_DONTEXPAND was added in commit 1c1914d6e8c6 ("dma-buf: heaps:
Don't track CMA dma-buf pages under RssFile") it was possible to obtain
a mapping larger than the buffer size via mremap and bypass the overflow
check in dma\_buf\_mmap\_internal. When using such a mapping to attempt to
fault past the end of the buffer, the CMA heap fault handler also checks
the fault offset against the buffer size, but gets the boundary wrong by
1. Fix the boundary check so that we don't read off the end of the pages
array and insert an arbitrary page in the mapping.
Reported-by: Xingyu Jin <xingyuj@google.com>
Fixes: a5d2d29e24be ("dma-buf: heaps: Move heap-helper logic into the cma\_heap implementation")
Cc: stable@vger.kernel.org # Applicable >= 5.10. Needs adjustments only for 5.10.
Signed-off-by: T.J. Mercier <tjmercier@google.com>
Acked-by: John Stultz <jstultz@google.com>
Signed-off-by: Sumit Semwal <sumit.semwal@linaro.org>
Link: [https://patchwork.freedesktop.org/patch/msgid/20240830192627.2546033-1-tjmercier@google.com](https://patchwork.freedesktop.org/patch/msgid/20240830192627.2546033-1-tjmercier%40google.com)
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=79cce5e81d20fa9ad553be439d665ac3302d3c95)

| -rw-r--r-- | [drivers/dma-buf/heaps/cma\_heap.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/dma-buf/heaps/cma_heap.c?id=79cce5e81d20fa9ad553be439d665ac3302d3c95) | 2 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 1 insertions, 1 deletions

| diff --git a/drivers/dma-buf/heaps/cma\_heap.c b/drivers/dma-buf/heaps/cma\_heap.cindex 83f02bd51dda62..00adde9b5b6984 100644--- a/[drivers/dma-buf/heaps/cma\_heap.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/dma-buf/heaps/cma_heap.c?id=16b3e7addd5b50e08afe3f34867a99f74e9bed8a)+++ b/[drivers/dma-buf/heaps/cma\_heap.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/dma-buf/heaps/cma_heap.c?id=79cce5e81d20fa9ad553be439d665ac3302d3c95)@@ -165,7 +165,7 @@ static vm\_fault\_t cma\_heap\_vm\_fault(struct vm\_fault \*vmf) struct vm\_area\_struct \*vma = vmf->vma; struct cma\_heap\_buffer \*buffer = vma->vm\_private\_data; - if (vmf->pgoff > buffer->pagecount)+ if (vmf->pgoff >= buffer->pagecount) return VM\_FAULT\_SIGBUS;  vmf->page = buffer->pages[vmf->pgoff]; |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-10 23:27:31 +0000



=== Content from git.kernel.org_2805b796_20250110_232855.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=e79050882b857c37634baedbdcf7c2047c24cbff)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=e79050882b857c37634baedbdcf7c2047c24cbff)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=e79050882b857c37634baedbdcf7c2047c24cbff)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=e79050882b857c37634baedbdcf7c2047c24cbff)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | T.J. Mercier <tjmercier@google.com> | 2024-08-30 19:26:26 +0000 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-09-18 19:25:16 +0200 |
| commit | [e79050882b857c37634baedbdcf7c2047c24cbff](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=e79050882b857c37634baedbdcf7c2047c24cbff) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=e79050882b857c37634baedbdcf7c2047c24cbff)) | |
| tree | [bb3bd2a87186202e4c664b82f145e86f46a10745](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=e79050882b857c37634baedbdcf7c2047c24cbff) | |
| parent | [73333816cf2ab602060c6d2da33652c4cd8d4666](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=73333816cf2ab602060c6d2da33652c4cd8d4666) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=e79050882b857c37634baedbdcf7c2047c24cbff&id2=73333816cf2ab602060c6d2da33652c4cd8d4666)) | |
| download | [linux-e79050882b857c37634baedbdcf7c2047c24cbff.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-e79050882b857c37634baedbdcf7c2047c24cbff.tar.gz) | |

dma-buf: heaps: Fix off-by-one in CMA heap fault handlercommit ea5ff5d351b520524019f7ff7f9ce418de2dad87 upstream.
Until VM\_DONTEXPAND was added in commit 1c1914d6e8c6 ("dma-buf: heaps:
Don't track CMA dma-buf pages under RssFile") it was possible to obtain
a mapping larger than the buffer size via mremap and bypass the overflow
check in dma\_buf\_mmap\_internal. When using such a mapping to attempt to
fault past the end of the buffer, the CMA heap fault handler also checks
the fault offset against the buffer size, but gets the boundary wrong by
1. Fix the boundary check so that we don't read off the end of the pages
array and insert an arbitrary page in the mapping.
Reported-by: Xingyu Jin <xingyuj@google.com>
Fixes: a5d2d29e24be ("dma-buf: heaps: Move heap-helper logic into the cma\_heap implementation")
Cc: stable@vger.kernel.org # Applicable >= 5.10. Needs adjustments only for 5.10.
Signed-off-by: T.J. Mercier <tjmercier@google.com>
Acked-by: John Stultz <jstultz@google.com>
Signed-off-by: Sumit Semwal <sumit.semwal@linaro.org>
Link: [https://patchwork.freedesktop.org/patch/msgid/20240830192627.2546033-1-tjmercier@google.com](https://patchwork.freedesktop.org/patch/msgid/20240830192627.2546033-1-tjmercier%40google.com)
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=e79050882b857c37634baedbdcf7c2047c24cbff)

| -rw-r--r-- | [drivers/dma-buf/heaps/cma\_heap.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/dma-buf/heaps/cma_heap.c?id=e79050882b857c37634baedbdcf7c2047c24cbff) | 2 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 1 insertions, 1 deletions

| diff --git a/drivers/dma-buf/heaps/cma\_heap.c b/drivers/dma-buf/heaps/cma\_heap.cindex 4a63567e93bae3..20dbe9265ad7ca 100644--- a/[drivers/dma-buf/heaps/cma\_heap.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/dma-buf/heaps/cma_heap.c?id=73333816cf2ab602060c6d2da33652c4cd8d4666)+++ b/[drivers/dma-buf/heaps/cma\_heap.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/dma-buf/heaps/cma_heap.c?id=e79050882b857c37634baedbdcf7c2047c24cbff)@@ -165,7 +165,7 @@ static vm\_fault\_t cma\_heap\_vm\_fault(struct vm\_fault \*vmf) struct vm\_area\_struct \*vma = vmf->vma; struct cma\_heap\_buffer \*buffer = vma->vm\_private\_data; - if (vmf->pgoff > buffer->pagecount)+ if (vmf->pgoff >= buffer->pagecount) return VM\_FAULT\_SIGBUS;  return vmf\_insert\_pfn(vma, vmf->address, page\_to\_pfn(buffer->pages[vmf->pgoff])); |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-10 23:27:32 +0000



=== Content from git.kernel.org_d529b886_20250110_232856.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=eb7fc8b65cea22f9038c52398c8b22849e9620ea)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=eb7fc8b65cea22f9038c52398c8b22849e9620ea)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=eb7fc8b65cea22f9038c52398c8b22849e9620ea)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=eb7fc8b65cea22f9038c52398c8b22849e9620ea)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | T.J. Mercier <tjmercier@google.com> | 2024-08-30 19:26:26 +0000 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-09-18 19:24:09 +0200 |
| commit | [eb7fc8b65cea22f9038c52398c8b22849e9620ea](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=eb7fc8b65cea22f9038c52398c8b22849e9620ea) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=eb7fc8b65cea22f9038c52398c8b22849e9620ea)) | |
| tree | [32f1bf46b8eb86fca781464b22c714212f2a2743](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=eb7fc8b65cea22f9038c52398c8b22849e9620ea) | |
| parent | [8e1ffb257982974352e9153eddcbaf01f949f700](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=8e1ffb257982974352e9153eddcbaf01f949f700) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=eb7fc8b65cea22f9038c52398c8b22849e9620ea&id2=8e1ffb257982974352e9153eddcbaf01f949f700)) | |
| download | [linux-eb7fc8b65cea22f9038c52398c8b22849e9620ea.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-eb7fc8b65cea22f9038c52398c8b22849e9620ea.tar.gz) | |

dma-buf: heaps: Fix off-by-one in CMA heap fault handlercommit ea5ff5d351b520524019f7ff7f9ce418de2dad87 upstream.
Until VM\_DONTEXPAND was added in commit 1c1914d6e8c6 ("dma-buf: heaps:
Don't track CMA dma-buf pages under RssFile") it was possible to obtain
a mapping larger than the buffer size via mremap and bypass the overflow
check in dma\_buf\_mmap\_internal. When using such a mapping to attempt to
fault past the end of the buffer, the CMA heap fault handler also checks
the fault offset against the buffer size, but gets the boundary wrong by
1. Fix the boundary check so that we don't read off the end of the pages
array and insert an arbitrary page in the mapping.
Reported-by: Xingyu Jin <xingyuj@google.com>
Fixes: a5d2d29e24be ("dma-buf: heaps: Move heap-helper logic into the cma\_heap implementation")
Cc: stable@vger.kernel.org # Applicable >= 5.10. Needs adjustments only for 5.10.
Signed-off-by: T.J. Mercier <tjmercier@google.com>
Acked-by: John Stultz <jstultz@google.com>
Signed-off-by: Sumit Semwal <sumit.semwal@linaro.org>
Link: [https://patchwork.freedesktop.org/patch/msgid/20240830192627.2546033-1-tjmercier@google.com](https://patchwork.freedesktop.org/patch/msgid/20240830192627.2546033-1-tjmercier%40google.com)
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=eb7fc8b65cea22f9038c52398c8b22849e9620ea)

| -rw-r--r-- | [drivers/dma-buf/heaps/cma\_heap.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/dma-buf/heaps/cma_heap.c?id=eb7fc8b65cea22f9038c52398c8b22849e9620ea) | 2 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 1 insertions, 1 deletions

| diff --git a/drivers/dma-buf/heaps/cma\_heap.c b/drivers/dma-buf/heaps/cma\_heap.cindex ee899f8e67215f..bea7e574f916e1 100644--- a/[drivers/dma-buf/heaps/cma\_heap.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/dma-buf/heaps/cma_heap.c?id=8e1ffb257982974352e9153eddcbaf01f949f700)+++ b/[drivers/dma-buf/heaps/cma\_heap.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/dma-buf/heaps/cma_heap.c?id=eb7fc8b65cea22f9038c52398c8b22849e9620ea)@@ -165,7 +165,7 @@ static vm\_fault\_t cma\_heap\_vm\_fault(struct vm\_fault \*vmf) struct vm\_area\_struct \*vma = vmf->vma; struct cma\_heap\_buffer \*buffer = vma->vm\_private\_data; - if (vmf->pgoff > buffer->pagecount)+ if (vmf->pgoff >= buffer->pagecount) return VM\_FAULT\_SIGBUS;  vmf->page = buffer->pages[vmf->pgoff]; |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-10 23:27:33 +0000



=== Content from git.kernel.org_f1d26349_20250110_232855.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=ea5ff5d351b520524019f7ff7f9ce418de2dad87)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=ea5ff5d351b520524019f7ff7f9ce418de2dad87)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=ea5ff5d351b520524019f7ff7f9ce418de2dad87)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=ea5ff5d351b520524019f7ff7f9ce418de2dad87)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | T.J. Mercier <tjmercier@google.com> | 2024-08-30 19:26:26 +0000 |
| --- | --- | --- |
| committer | Sumit Semwal <sumit.semwal@linaro.org> | 2024-09-09 15:37:20 +0530 |
| commit | [ea5ff5d351b520524019f7ff7f9ce418de2dad87](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=ea5ff5d351b520524019f7ff7f9ce418de2dad87) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=ea5ff5d351b520524019f7ff7f9ce418de2dad87)) | |
| tree | [3af6269f1a4623669dd50b1179821f5486f6b0b9](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=ea5ff5d351b520524019f7ff7f9ce418de2dad87) | |
| parent | [5a498d4d06d6d9bad76d8a50a7f8fe01670ad46f](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=5a498d4d06d6d9bad76d8a50a7f8fe01670ad46f) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=ea5ff5d351b520524019f7ff7f9ce418de2dad87&id2=5a498d4d06d6d9bad76d8a50a7f8fe01670ad46f)) | |
| download | [linux-ea5ff5d351b520524019f7ff7f9ce418de2dad87.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-ea5ff5d351b520524019f7ff7f9ce418de2dad87.tar.gz) | |

dma-buf: heaps: Fix off-by-one in CMA heap fault handlerUntil VM\_DONTEXPAND was added in commit 1c1914d6e8c6 ("dma-buf: heaps:
Don't track CMA dma-buf pages under RssFile") it was possible to obtain
a mapping larger than the buffer size via mremap and bypass the overflow
check in dma\_buf\_mmap\_internal. When using such a mapping to attempt to
fault past the end of the buffer, the CMA heap fault handler also checks
the fault offset against the buffer size, but gets the boundary wrong by
1. Fix the boundary check so that we don't read off the end of the pages
array and insert an arbitrary page in the mapping.
Reported-by: Xingyu Jin <xingyuj@google.com>
Fixes: a5d2d29e24be ("dma-buf: heaps: Move heap-helper logic into the cma\_heap implementation")
Cc: stable@vger.kernel.org # Applicable >= 5.10. Needs adjustments only for 5.10.
Signed-off-by: T.J. Mercier <tjmercier@google.com>
Acked-by: John Stultz <jstultz@google.com>
Signed-off-by: Sumit Semwal <sumit.semwal@linaro.org>
Link: [https://patchwork.freedesktop.org/patch/msgid/20240830192627.2546033-1-tjmercier@google.com](https://patchwork.freedesktop.org/patch/msgid/20240830192627.2546033-1-tjmercier%40google.com)
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=ea5ff5d351b520524019f7ff7f9ce418de2dad87)

| -rw-r--r-- | [drivers/dma-buf/heaps/cma\_heap.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/dma-buf/heaps/cma_heap.c?id=ea5ff5d351b520524019f7ff7f9ce418de2dad87) | 2 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 1 insertions, 1 deletions

| diff --git a/drivers/dma-buf/heaps/cma\_heap.c b/drivers/dma-buf/heaps/cma\_heap.cindex c384004b918e23..93be88b805fe78 100644--- a/[drivers/dma-buf/heaps/cma\_heap.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/dma-buf/heaps/cma_heap.c?id=5a498d4d06d6d9bad76d8a50a7f8fe01670ad46f)+++ b/[drivers/dma-buf/heaps/cma\_heap.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/dma-buf/heaps/cma_heap.c?id=ea5ff5d351b520524019f7ff7f9ce418de2dad87)@@ -165,7 +165,7 @@ static vm\_fault\_t cma\_heap\_vm\_fault(struct vm\_fault \*vmf) struct vm\_area\_struct \*vma = vmf->vma; struct cma\_heap\_buffer \*buffer = vma->vm\_private\_data; - if (vmf->pgoff > buffer->pagecount)+ if (vmf->pgoff >= buffer->pagecount) return VM\_FAULT\_SIGBUS;  return vmf\_insert\_pfn(vma, vmf->address, page\_to\_pfn(buffer->pages[vmf->pgoff])); |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-10 23:27:32 +0000


