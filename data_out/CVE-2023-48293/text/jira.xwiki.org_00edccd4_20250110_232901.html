

[Log in](/login.jsp?os_destination=%2Fbrowse%2FADMINTOOL-92)[Skip to main content](#main)[Skip to sidebar](#sidebar)Linked ApplicationsLoadingâ€¦[![XWiki.org JIRA](/s/-65z3d2/930000/8ws80b/_/jira-logo-scaled.png)](https://jira.xwiki.org/secure/MyJiraHome.jspa)

* [Dashboards](/secure/Dashboard.jspa "View and manage your dashboards")
* [Projects](/secure/BrowseProjects.jspa "View recent projects and browse a list of projects")
* [Issues](/issues/ "Search for issues and view recent issues")

* Give feedback to Atlassian
* [Help](https://docs.atlassian.com/jira/jcore-docs-093/ "Help")
  + [Jira Core help](https://docs.atlassian.com/jira/jcore-docs-093/ "Go to the online documentation for Jira Core")
  + [Keyboard Shortcuts](/secure/ViewKeyboardShortcuts%21default.jspa "Get more information about Jira's Keyboard Shortcuts")
  + [About Jira](/secure/AboutPage.jspa "Get more information about Jira")
  + [Jira Credits](/secure/credits/AroundTheWorld%21default.jspa "See who did what")
* [Log In](/login.jsp?os_destination=%2Fbrowse%2FADMINTOOL-92)

![Uploaded image for project: 'Admin Tools Application'](https://jira.xwiki.org/secure/projectavatar?pid=11435&avatarId=10011)

1. [Admin Tools Application](/browse/ADMINTOOL)
2. [ADMINTOOL-92](/browse/ADMINTOOL-92)

# CSRF with QueryOnXWiki allows arbitrary database queries

[Log In](/login.jsp?os_destination=%2Fbrowse%2FADMINTOOL-92 "Log In")ClosedExportnull

XMLWordPrintable
#### Details

* **Type:**
  ![](/secure/viewavatar?size=xsmall&avatarId=13503&avatarType=issuetype "Bug - A problem which impairs or prevents the functions of the product.") Bug
* **Resolution:**
  Fixed
* **Priority:**
  ![](/images/icons/priorities/blocker.svg "Blocker - Blocks development and/or testing work, production could not run.") Blocker
* **Fix Version/s:**
  [4.5.1](/issues/?jql=project+%3D+ADMINTOOL+AND+fixVersion+%3D+4.5.1 "4.5.1 ")
* **Affects Version/s:**
  1.x
* **Component/s:**
  [Data altering tool](/issues/?jql=project+%3D+ADMINTOOL+AND+component+%3D+%22Data+altering+tool%22 "Data altering tool Tools to alter the data of the wiki in an advanced mode.")
* **Labels:**
  + [attack\_edit](/issues/?jql=labels+%3D+attack_edit "attack_edit")
  + [attack\_escalation](/issues/?jql=labels+%3D+attack_escalation "attack_escalation")
  + [attacker\_comment](/issues/?jql=labels+%3D+attacker_comment "attacker_comment")
  + [security](/issues/?jql=labels+%3D+security "security")

* **Difficulty:**
  Unknown
* **Documentation:**
  N/A
* **Documentation in Release Notes:**
  N/A
* **Similar issues:**

#### Description

**Steps to reproduce:**

1. Add a comment with an image [[image:path:/xwiki/bin/view/Admin/QueryOnXWiki?query=DELETE%20FROM%20xwikidoc]].
2. Wait for an admin to view the comment.

**Expected result:**

The wiki continues to work.

**Actual result:**

All documents are deleted from the database, the wiki is empty after a restart or after emptying caches. Note that the same mechanism could also be used to grant admin rights to the user with an appropriate database query.

#### Attachments

#### Activity

#### People

Assignee:

![MichaelHamann](https://jira.xwiki.org/secure/useravatar?size=small&avatarId=10222)
Michael Hamann

Reporter:

![MichaelHamann](https://jira.xwiki.org/secure/useravatar?size=small&avatarId=10222)
Michael Hamann

Votes:
0
Vote for this issue

Watchers:
1
Start watching this issue

#### Dates

Created:

03/Aug/23 18:08

Updated:

17/Nov/23 13:03

Resolved:

03/Aug/23 18:12

* Atlassian Jira [Project Management Software](https://www.atlassian.com/software/jira)
* [About Jira](/secure/AboutPage.jspa/secure/AboutPage.jspa)
* [Report a problem](/secure/CreateIssue%21default.jspa)

Powered by a free Atlassian [Jira](http://www.atlassian.com/software/jira) open source license for XWiki.org. Try Jira - [bug tracking software](http://www.atlassian.com/software/jira) for *your* team.

[Atlassian](http://www.atlassian.com/)

