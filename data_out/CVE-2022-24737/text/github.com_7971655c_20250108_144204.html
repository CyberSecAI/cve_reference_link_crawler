
[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fhttpie%2Fcli%2Fcommit%2F65ab7d5caaaf2f95e61f9dd65441801c2ddee38b)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fhttpie%2Fcli%2Fcommit%2F65ab7d5caaaf2f95e61f9dd65441801c2ddee38b)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=httpie%2Fcli)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[httpie](/httpie)
/
**[cli](/httpie/cli)**
Public

* [Notifications](/login?return_to=%2Fhttpie%2Fcli) You must be signed in to change notification settings
* [Fork
  3.7k](/login?return_to=%2Fhttpie%2Fcli)
* [Star
   34.3k](/login?return_to=%2Fhttpie%2Fcli)

* [Code](/httpie/cli)
* [Issues
  159](/httpie/cli/issues)
* [Pull requests
  19](/httpie/cli/pulls)
* [Actions](/httpie/cli/actions)
* [Security](/httpie/cli/security)
* [Insights](/httpie/cli/pulse)

Additional navigation options

* [Code](/httpie/cli)
* [Issues](/httpie/cli/issues)
* [Pull requests](/httpie/cli/pulls)
* [Actions](/httpie/cli/actions)
* [Security](/httpie/cli/security)
* [Insights](/httpie/cli/pulse)

## Commit

[Permalink](/httpie/cli/commit/65ab7d5caaaf2f95e61f9dd65441801c2ddee38b)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Implement new style cookies

[Browse files](/httpie/cli/tree/65ab7d5caaaf2f95e61f9dd65441801c2ddee38b)
Browse the repository at this point in the history

* Loading branch information

[![@isidentical](https://avatars.githubusercontent.com/u/47358913?s=40&v=4)](/isidentical)

[isidentical](/httpie/cli/commits?author=isidentical "View all commits by isidentical")
committed
Mar 7, 2022

1 parent
[b5623cc](/httpie/cli/commit/b5623ccc8797312de60e4ca37dea249fa0a1ea39)

commit 65ab7d5

 Show file tree

 Hide file tree

Showing
**27 changed files**
with
**1,406 additions**
and
**117 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* docs

  + docs/README.md
    [README.md](#diff-0b5ca119d2be595aa307d34512d9679e49186307ef94201e4b3dfa079aa89938)
* httpie

  + httpie/client.py
    [client.py](#diff-b3273e8417e9579741debf0a2ffbf781f1ed6bb9728ce412e2f8a19fd0285cb0)
  + httpie/config.py
    [config.py](#diff-0d33ca52851c6cc6ec984ecc532c5fdc5951f377dd8286559f978d27088395a5)
  + manager

    - httpie/manager/cli.py
      [cli.py](#diff-ca1a9054abddb8c79f1a3d3059d0994d479e804166cdc24bc280ad9c40222649)
    - httpie/manager/core.py
      [core.py](#diff-dac79540e831e09bfb12b56d1f2443df79949400c5abed572e886435bc5f7c74)
    - httpie/manager/tasks.py
      [tasks.py](#diff-d94e6fee09db2c6f244d1c095ba353f8ef0ba02a739cdb6b593fb2bcbc388974)
  + httpie/sessions.py
    [sessions.py](#diff-b520a77f2155d96ff447b4dac359b2c09c5a62ef024feb16044c61be58258ed2)
  + httpie/utils.py
    [utils.py](#diff-5190227d2919d8d7bd2c9ba3ba78ff9a73d4a938c3f0b33f94869d744de3b3ff)
* setup.py
  [setup.py](#diff-60f61ab7a8d1910d86d9fda2261620314edcae5894d5aaa236b821c7256badd7)
* tests

  + tests/conftest.py
    [conftest.py](#diff-e52e4ddd58b7ef887ab03c04116e676f6280b824ab7469d5d3080e5cba4f2128)
  + fixtures

    - tests/fixtures/\_\_init\_\_.py
      [\_\_init\_\_.py](#diff-c00a86757c0c5042cf12eb1753bd9cac9aca5a15eea3e9c367f36d151fe3ced5)
    - session\_data

      * new

        + tests/fixtures/session\_data/new/cookies\_dict.json
          [cookies\_dict.json](#diff-8938a42f23dd811a8b8b45c385fc7ff5a964224b0bb74203e99e99b594784685)
        + tests/fixtures/session\_data/new/cookies\_dict\_dev\_version.json
          [cookies\_dict\_dev\_version.json](#diff-6c63f93651245644b66fdd6e6037ee18a447366ae6a38f22ddff1278eb897518)
        + tests/fixtures/session\_data/new/cookies\_dict\_with\_extras.json
          [cookies\_dict\_with\_extras.json](#diff-218ef46f7aaf93480eba1ee737088c0f6c9ecf37c7d31c8c42cdc1df70c239f9)
        + tests/fixtures/session\_data/new/empty\_cookies\_dict.json
          [empty\_cookies\_dict.json](#diff-fb1ebd84c3233ec58c690af40e0bdbe475d857b52a68968ab51f7c6d4821c0dd)
        + tests/fixtures/session\_data/new/empty\_cookies\_list.json
          [empty\_cookies\_list.json](#diff-1a1fba4466de48dc2eca83fcde5b4c9d227063728bb26557affb1f87db6b505a)
      * old

        + tests/fixtures/session\_data/old/cookies\_dict.json
          [cookies\_dict.json](#diff-34d750674339ac24c64e7072aa374732d5a8a642d2b4997196d41d08d98f0dfb)
        + tests/fixtures/session\_data/old/cookies\_dict\_dev\_version.json
          [cookies\_dict\_dev\_version.json](#diff-4600e9b42c6c5c34ae55b263f073fd4f10916aee39b203b0146dedd2d0374765)
        + tests/fixtures/session\_data/old/cookies\_dict\_with\_extras.json
          [cookies\_dict\_with\_extras.json](#diff-574cc96172693971731354d8f6d1b134ca4d0e65630c1bb3618c8f0f9bbee348)
        + tests/fixtures/session\_data/old/empty\_cookies\_dict.json
          [empty\_cookies\_dict.json](#diff-b661467a44d73b0dcd4b768ad4985c2f59c411eb2ae176199a0d6cb8694ae071)
        + tests/fixtures/session\_data/old/empty\_cookies\_list.json
          [empty\_cookies\_list.json](#diff-b01f5716e38d3f3bc696eab21fdc4956c8c7a0ada84bb0888f2921a488fdfa56)
  + tests/test\_cookie\_on\_redirects.py
    [test\_cookie\_on\_redirects.py](#diff-ecb5b65d01e1f842876ade6e9bf04d9885b6f3ce155dcbfd8ae063ad70faec4f)
  + tests/test\_httpie\_cli.py
    [test\_httpie\_cli.py](#diff-c7848b886d48a9b5b2ba0e77b3765e009d14bfa81da7bad2adefa467052e0ebe)
  + tests/test\_plugins\_cli.py
    [test\_plugins\_cli.py](#diff-aa9f0512a90d021ca217e681750ebe93af0a4beae7941fae079a9d903ba54ab0)
  + tests/test\_sessions.py
    [test\_sessions.py](#diff-ec16ff38dc1f97817bb79c4670e3b78aa29fd80d8cda5e7051ebd68213430e55)
  + utils

    - tests/utils/\_\_init\_\_.py
      [\_\_init\_\_.py](#diff-e83d4ce58211688fdd3f132906c3c4ff02b28e14a069c7516df75eeb2478a904)
    - tests/utils/http\_server.py
      [http\_server.py](#diff-abc014fc394ae493363db3697eacf0699e9e0dd12268a5e769366563744eb914)

## There are no files selected for viewing

140 changes: 140 additions & 0 deletions

140
[docs/README.md](#diff-0b5ca119d2be595aa307d34512d9679e49186307ef94201e4b3dfa079aa89938 "docs/README.md")

Show comments

[View file](/httpie/cli/blob/65ab7d5caaaf2f95e61f9dd65441801c2ddee38b/docs/README.md)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |

| Expand Up | | @@ -2157,6 +2157,85 @@ $ http --session-read-only=./ro-session.json pie.dev/headers Custom-Header:orig- |
|  |  | $ http --session-read-only=./ro-session.json pie.dev/headers Custom-Header:new-value |
|  |  | ``` |
|  |  |  |
|  |  | ### Host-based Cookie Policy |
|  |  |  |
|  |  | Cookies in stored HTTPie sessions have a `domain` field which is binding them to the |
|  |  | specified hostname. For example, in the following session: |
|  |  |  |
|  |  | ```json |
|  |  | { |
|  |  | "cookies": [ |
|  |  | { |
|  |  | "domain": "pie.dev", |
|  |  | "name": "secret\_cookie", |
|  |  | "value": "value\_1" |
|  |  | }, |
|  |  | { |
|  |  | "domain": "httpbin.org", |
|  |  | "name": "secret\_cookie", |
|  |  | "value": "value\_2" |
|  |  | } |
|  |  | ] |
|  |  | } |
|  |  | ``` |
|  |  |  |
|  |  | we will send `Cookie:secret\_cookie=value\_1` only when you are making a request against `pie.dev` (it |
|  |  | also includes the domains, like `api.pie.dev`), and `Cookie:secret\_cookie=value\_2` when you use `httpbin.org`. |
|  |  |  |
|  |  | ```bash |
|  |  | $ http --session=./session.json pie.dev/cookies |
|  |  | ``` |
|  |  |  |
|  |  | ```json |
|  |  | { |
|  |  | "cookies": { |
|  |  | "secret\_cookie": "value\_1" |
|  |  | } |
|  |  | } |
|  |  | ``` |
|  |  |  |
|  |  | ```bash |
|  |  | $ http --session=./session.json httpbin.org/cookies |
|  |  | ``` |
|  |  |  |
|  |  | ```json |
|  |  | { |
|  |  | "cookies": { |
|  |  | "secret\_cookie": "value\_2" |
|  |  | } |
|  |  | } |
|  |  | ``` |
|  |  |  |
|  |  | If you want to make a cookie domain unbound, you can simply set the `domain` |
|  |  | field to `null` by editing the session file directly: |
|  |  |  |
|  |  | ```json |
|  |  | { |
|  |  | "cookies": [ |
|  |  | { |
|  |  | "domain": null, |
|  |  | "expires": null, |
|  |  | "name": "generic\_cookie", |
|  |  | "path": "/", |
|  |  | "secure": false, |
|  |  | "value": "generic\_value" |
|  |  | } |
|  |  | ] |
|  |  | } |
|  |  | ``` |
|  |  |  |
|  |  | ```bash |
|  |  | $ http --session=./session.json pie.dev/cookies |
|  |  | ``` |
|  |  |  |
|  |  | ```json |
|  |  | { |
|  |  | "cookies": { |
|  |  | "generic\_cookie": "generic\_value" |
|  |  | } |
|  |  | } |
|  |  | ``` |
|  |  |  |
|  |  | ### Cookie Storage Behavior |
|  |  |  |
|  |  | \*\*TL;DR:\*\* Cookie storage priority: Server response > Command line request > Session file |
| Expand Down  Expand Up | | @@ -2208,6 +2287,50 @@ Expired cookies are never stored. |
|  |  | If a cookie in a session file expires, it will be removed before sending a new request. |
|  |  | If the server expires an existing cookie, it will also be removed from the session file. |
|  |  |  |
|  |  | ### Upgrading Sessions |
|  |  |  |
|  |  | In rare circumstances, HTTPie makes changes in it's session layout. For allowing a smoother transition of existing files |
|  |  | from the old layout to the new layout we offer 2 interfaces: |
|  |  |  |
|  |  | - `httpie cli sessions upgrade` |
|  |  | - `httpie cli sessions upgrade-all` |
|  |  |  |
|  |  |  |
|  |  | With `httpie cli sessions upgrade`, you can upgrade a single session with it's name (or it's path, if it is an |
|  |  | [anonymous session](#anonymous-sessions)) and the hostname it belongs to. For example: |
|  |  |  |
|  |  | ([named session](#named-sessions)) |
|  |  |  |
|  |  | ```bash |
|  |  | $ httpie cli sessions upgrade pie.dev api\_auth |
|  |  | Refactored 'api\_auth' (for 'pie.dev') to the version 3.1.0. |
|  |  | ``` |
|  |  |  |
|  |  | ([anonymous session](#anonymous-sessions)) |
|  |  |  |
|  |  | ```bash |
|  |  | $ httpie cli sessions upgrade pie.dev ./session.json |
|  |  | Refactored 'session' (for 'pie.dev') to the version 3.1.0. |
|  |  | ``` |
|  |  |  |
|  |  | If you want to upgrade every existing [named session](#named-sessions), you can use `httpie cli sessions upgrade-all` (be aware |
|  |  | that this won't upgrade [anonymous sessions](#anonymous-sessions)): |
|  |  |  |
|  |  | ```bash |
|  |  | $ httpie cli sessions upgrade-all |
|  |  | Refactored 'api\_auth' (for 'pie.dev') to the version 3.1.0. |
|  |  | Refactored 'login\_cookies' (for 'httpie.io') to the version 3.1.0. |
|  |  | ``` |
|  |  |  |
|  |  | #### Additional Customizations |
|  |  |  |
|  |  | | Flag | Description | |
|  |  | |------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------| |
|  |  | | `--bind-cookies` | Bind all the unbound cookies to the hostname that session belongs. By default, if the cookie is unbound (the `domain` attribute does not exist / set to an empty string) then it will still continue to be a generic cookie. | |
|  |  |  |
|  |  | These flags can be used to customize the defaults during an `upgrade` operation. They can |
|  |  | be used in both `sessions upgrade` and `sessions upgrade-all`. |
|  |  |  |
|  |  | ## Config |
|  |  |  |
|  |  | HTTPie uses a simple `config.json` file. |
| Expand Down  Expand Up | | @@ -2299,6 +2422,23 @@ And since there’s neither data nor `EOF`, it will get stuck. So unless you’r |
|  |  |  |
|  |  | Also, it might be good to set a connection `--timeout` limit to prevent your program from hanging if the server never responds. |
|  |  |  |
|  |  | ### Security |
|  |  |  |
|  |  | #### Exposure of Cookies To The 3rd Party Hosts On Redirects |
|  |  |  |
|  |  | \*Vulnerability Type\*: [CWE-200](https://cwe.mitre.org/data/definitions/200.html) |
|  |  | \*Severity Level\*: LOW |
|  |  | \*Affected Versions\*: `<3.1.0` |
|  |  |  |
|  |  | The handling of [cookies](#cookies) was not compatible with the [RFC 6265](https://datatracker.ietf.org/doc/html/rfc6265) |
|  |  | on the point of handling the `Domain` attribute when they were saved into [session](#sessions) files. All cookies were shared |
|  |  | across all hosts during the runtime, including redirects to the 3rd party hosts. |
|  |  |  |
|  |  | This vulnerability has been fixed in [3.1.0](https://github.com/httpie/httpie/releases/tag/3.1.0) and the |
|  |  | [`httpie cli sessions upgrade`](#upgrading-sessions)/[`httpie cli sessions upgrade-all`]((#upgrading-sessions) commands |
|  |  | have been put in place in order to allow a smooth transition to the new session layout from the existing [session](#sessions) |
|  |  | files. |
|  |  |  |
|  |  | ## Plugin manager |
|  |  |  |
|  |  | HTTPie offers extensibility through a [plugin API](https://github.com/httpie/httpie/blob/master/httpie/plugins/base.py), |
| Expand Down | |  |

6 changes: 2 additions & 4 deletions

6
[httpie/client.py](#diff-b3273e8417e9579741debf0a2ffbf781f1ed6bb9728ce412e2f8a19fd0285cb0 "httpie/client.py")

Show comments

[View file](/httpie/cli/blob/65ab7d5caaaf2f95e61f9dd65441801c2ddee38b/httpie/client.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -44,6 +44,7 @@ def collect\_messages( |
|  |  | httpie\_session\_headers = None |
|  |  | if args.session or args.session\_read\_only: |
|  |  | httpie\_session = get\_httpie\_session( |
|  |  | env=env, |
|  |  | config\_dir=env.config.directory, |
|  |  | session\_name=args.session or args.session\_read\_only, |
|  |  | host=args.headers.get('Host'), |
| Expand Down  Expand Up | | @@ -130,10 +131,7 @@ def collect\_messages( |
|  |  | if httpie\_session: |
|  |  | if httpie\_session.is\_new() or not args.session\_read\_only: |
|  |  | httpie\_session.cookies = requests\_session.cookies |
|  |  | httpie\_session.remove\_cookies( |
|  |  | # TODO: take path & domain into account? |
|  |  | cookie['name'] for cookie in expired\_cookies |
|  |  | ) |
|  |  | httpie\_session.remove\_cookies(expired\_cookies) |
|  |  | httpie\_session.save() |
|  |  |  |
|  |  |  |
| Expand Down | |  |

60 changes: 40 additions & 20 deletions

60
[httpie/config.py](#diff-0d33ca52851c6cc6ec984ecc532c5fdc5951f377dd8286559f978d27088395a5 "httpie/config.py")

Show comments

[View file](/httpie/cli/blob/65ab7d5caaaf2f95e61f9dd65441801c2ddee38b/httpie/config.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1,7 +1,7 @@ |
|  |  | import json |
|  |  | import os |
|  |  | from pathlib import Path |
|  |  | from typing import Union |
|  |  | from typing import Any, Dict, Union |
|  |  |  |
|  |  | from . import \_\_version\_\_ |
|  |  | from .compat import is\_windows |
| Expand Down  Expand Up | | @@ -62,6 +62,21 @@ class ConfigFileError(Exception): |
|  |  | pass |
|  |  |  |
|  |  |  |
|  |  | def read\_raw\_config(config\_type: str, path: Path) -> Dict[str, Any]: |
|  |  | try: |
|  |  | with path.open(encoding=UTF8) as f: |
|  |  | try: |
|  |  | return json.load(f) |
|  |  | except ValueError as e: |
|  |  | raise ConfigFileError( |
|  |  | f'invalid {config\_type} file: {e} [{path}]' |
|  |  | ) |
|  |  | except FileNotFoundError: |
|  |  | pass |
|  |  | except OSError as e: |
|  |  | raise ConfigFileError(f'cannot read {config\_type} file: {e}') |
|  |  |  |
|  |  |  |
|  |  | class BaseConfigDict(dict): |
|  |  | name = None |
|  |  | helpurl = None |
| Expand All | | @@ -77,26 +92,25 @@ def ensure\_directory(self): |
|  |  | def is\_new(self) -> bool: |
|  |  | return not self.path.exists() |
|  |  |  |
|  |  | def pre\_process\_data(self, data: Dict[str, Any]) -> Dict[str, Any]: |
|  |  | """Hook for processing the incoming config data.""" |
|  |  | return data |
|  |  |  |
|  |  | def post\_process\_data(self, data: Dict[str, Any]) -> Dict[str, Any]: |
|  |  | """Hook for processing the outgoing config data.""" |
|  |  | return data |
|  |  |  |
|  |  | def load(self): |
|  |  | config\_type = type(self).\_\_name\_\_.lower() |
|  |  | try: |
|  |  | with self.path.open(encoding=UTF8) as f: |
|  |  | try: |
|  |  | data = json.load(f) |
|  |  | except ValueError as e: |
|  |  | raise ConfigFileError( |
|  |  | f'invalid {config\_type} file: {e} [{self.path}]' |
|  |  | ) |
|  |  | self.update(data) |
|  |  | except FileNotFoundError: |
|  |  | pass |
|  |  | except OSError as e: |
|  |  | raise ConfigFileError(f'cannot read {config\_type} file: {e}') |
|  |  |  |
|  |  | def save(self): |
|  |  | self['\_\_meta\_\_'] = { |
|  |  | 'httpie': \_\_version\_\_ |
|  |  | } |
|  |  | data = read\_raw\_config(config\_type, self.path) |
|  |  | if data is not None: |
|  |  | data = self.pre\_process\_data(data) |
|  |  | self.update(data) |
|  |  |  |
|  |  | def save(self, \*, bump\_version: bool = False): |
|  |  | self.setdefault('\_\_meta\_\_', {}) |
|  |  | if bump\_version or 'httpie' not in self['\_\_meta\_\_']: |
|  |  | self['\_\_meta\_\_']['httpie'] = \_\_version\_\_ |
|  |  | if self.helpurl: |
|  |  | self['\_\_meta\_\_']['help'] = self.helpurl |
|  |  |  |
| Expand All | | @@ -106,13 +120,19 @@ def save(self): |
|  |  | self.ensure\_directory() |
|  |  |  |
|  |  | json\_string = json.dumps( |
|  |  | obj=self, |
|  |  | obj=self.post\_process\_data(self), |
|  |  | indent=4, |
|  |  | sort\_keys=True, |
|  |  | ensure\_ascii=True, |
|  |  | ) |
|  |  | self.path.write\_text(json\_string + '\n', encoding=UTF8) |
|  |  |  |
|  |  | @property |
|  |  | def version(self): |
|  |  | return self.get( |
|  |  | '\_\_meta\_\_', {} |
|  |  | ).get('httpie', \_\_version\_\_) |
|  |  |  |
|  |  |  |
|  |  | class Config(BaseConfigDict): |
|  |  | FILENAME = 'config.json' |
| Expand Down | |  |

43 changes: 42 additions & 1 deletion

43
[httpie/manager/cli.py](#diff-ca1a9054abddb8c79f1a3d3059d0994d479e804166cdc24bc280ad9c40222649 "httpie/manager/cli.py")

Show comments

[View file](/httpie/cli/blob/65ab7d5caaaf2f95e61f9dd65441801c2ddee38b/httpie/manager/cli.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -2,6 +2,15 @@ |
|  |  | from httpie.cli.argparser import HTTPieManagerArgumentParser |
|  |  | from httpie import \_\_version\_\_ |
|  |  |  |
|  |  | CLI\_SESSION\_UPGRADE\_FLAGS = [ |
|  |  | { |
|  |  | 'variadic': ['--bind-cookies'], |
|  |  | 'action': 'store\_true', |
|  |  | 'default': False, |
|  |  | 'help': 'Bind domainless cookies to the host that session belongs.' |
|  |  | } |
|  |  | ] |
|  |  |  |
|  |  | COMMANDS = { |
|  |  | 'plugins': { |
|  |  | 'help': 'Manage HTTPie plugins.', |
| Expand Down  Expand Up | | @@ -34,6 +43,34 @@ |
|  |  | 'List all installed HTTPie plugins.' |
|  |  | ], |
|  |  | }, |
|  |  | 'cli': { |
|  |  | 'help': 'Manage HTTPie for Terminal', |
|  |  | 'sessions': { |
|  |  | 'help': 'Manage HTTPie sessions', |
|  |  | 'upgrade': [ |
|  |  | 'Upgrade the given HTTPie session with the latest ' |
|  |  | 'layout. A list of changes between different session versions ' |
|  |  | 'can be found in the official documentation.', |
|  |  | { |
|  |  | 'dest': 'hostname', |
|  |  | 'metavar': 'HOSTNAME', |
|  |  | 'help': 'The host this session belongs.' |
|  |  | }, |
|  |  | { |
|  |  | 'dest': 'session', |
|  |  | 'metavar': 'SESSION\_NAME\_OR\_PATH', |
|  |  | 'help': 'The name or the path for the session that will be upgraded.' |
|  |  | }, |
|  |  | \*CLI\_SESSION\_UPGRADE\_FLAGS |
|  |  | ], |
|  |  | 'upgrade-all': [ |
|  |  | 'Upgrade all named sessions with the latest layout. A list of ' |
|  |  | 'changes between different session versions can be found in the official ' |
|  |  | 'documentation.', |
|  |  | \*CLI\_SESSION\_UPGRADE\_FLAGS |
|  |  | ], |
|  |  | } |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  |  |
| Expand All | | @@ -54,6 +91,8 @@ def generate\_subparsers(root, parent\_parser, definitions): |
|  |  | ) |
|  |  | for command, properties in definitions.items(): |
|  |  | is\_subparser = isinstance(properties, dict) |
|  |  | properties = properties.copy() |
|  |  |  |
|  |  | descr = properties.pop('help', None) if is\_subparser else properties.pop(0) |
|  |  | command\_parser = actions.add\_parser(command, description=descr) |
|  |  | command\_parser.root = root |
| Expand All | | @@ -62,7 +101,9 @@ def generate\_subparsers(root, parent\_parser, definitions): |
|  |  | continue |
|  |  |  |
|  |  | for argument in properties: |
|  |  | command\_parser.add\_argument(\*\*argument) |
|  |  | argument = argument.copy() |
|  |  | variadic = argument.pop('variadic', []) |
|  |  | command\_parser.add\_argument(\*variadic, \*\*argument) |
|  |  |  |
|  |  |  |
|  |  | parser = HTTPieManagerArgumentParser( |
| Expand Down | |  |

11 changes: 11 additions & 0 deletions

11
[httpie/manager/core.py](#diff-dac79540e831e09bfb12b56d1f2443df79949400c5abed572e886435bc5f7c74 "httpie/manager/core.py")

Show comments

[View file](/httpie/cli/blob/65ab7d5caaaf2f95e61f9dd65441801c2ddee38b/httpie/manager/core.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1,9 +1,11 @@ |
|  |  | import argparse |
|  |  | from typing import Optional |
|  |  |  |
|  |  | from httpie.context import Environment |
|  |  | from httpie.manager.plugins import PluginInstaller |
|  |  | from httpie.status import ExitStatus |
|  |  | from httpie.manager.cli import missing\_subcommand, parser |
|  |  | from httpie.manager.tasks import CLI\_TASKS |
|  |  |  |
|  |  | MSG\_COMMAND\_CONFUSION = '''\ |
|  |  | This command is only for managing HTTPie plugins. |
| Expand All | | @@ -22,12 +24,21 @@ |
|  |  | '''.rstrip("\n").format(args='POST pie.dev/post hello=world') |
|  |  |  |
|  |  |  |
|  |  | def dispatch\_cli\_task(env: Environment, action: Optional[str], args: argparse.Namespace) -> ExitStatus: |
|  |  | if action is None: |
|  |  | parser.error(missing\_subcommand('cli')) |
|  |  |  |
|  |  | return CLI\_TASKS[action](env, args) |
|  |  |  |
|  |  |  |
|  |  | def program(args: argparse.Namespace, env: Environment) -> ExitStatus: |
|  |  | if args.action is None: |
|  |  | parser.error(MSG\_NAKED\_INVOCATION) |
|  |  |  |
|  |  | if args.action == 'plugins': |
|  |  | plugins = PluginInstaller(env, debug=args.debug) |
|  |  | return plugins.run(args.plugins\_action, args) |
|  |  | elif args.action == 'cli': |
|  |  | return dispatch\_cli\_task(env, args.cli\_action, args) |
|  |  |  |
|  |  | return ExitStatus.SUCCESS |

 Loading

Oops, something went wrong.
 Retry

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `65ab7d5`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fhttpie%2Fcli%2Fcommit%2F65ab7d5caaaf2f95e61f9dd65441801c2ddee38b) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.

