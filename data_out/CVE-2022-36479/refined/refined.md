The provided content details a command injection vulnerability in TOTOLINK N350RT router firmware version V9.3.5u.6139_B20201216.

**Root cause of vulnerability:**
The vulnerability lies in the `NTPSyncWithHost` function, where the "host_time" parameter is directly passed into the `dosystem` function without proper sanitization. The `dosystem` function, which is implemented using the system function, executes the provided input as a system command.

**Weaknesses/vulnerabilities present:**
- Command injection: The "host_time" parameter allows injection of arbitrary shell commands.
- Lack of input sanitization: The input provided via the `host_time` parameter is not sanitized before being passed to the `dosystem` function.
- Direct execution with system: The `dosystem` function uses the `system` function, making it vulnerable to command injection.

**Impact of exploitation:**
- Arbitrary command execution: An attacker can execute arbitrary system commands on the router's operating system.
- Potential for full system compromise: Successful exploitation can lead to a complete compromise of the router.
- Unauthorized access: An attacker can potentially gain unauthorized access to the router.
- Root shell access: The attacker can obtain a stable root shell without authorization.

**Attack vectors:**
- HTTP POST request: The vulnerability can be exploited by sending a specially crafted HTTP POST request to `/cgi-bin/cstecgi.cgi`.
- `host_time` parameter: The malicious payload is injected through the `host_time` parameter.

**Required attacker capabilities/position:**
- Network access to the router: The attacker needs to have network access to the vulnerable router, typically within the same network.
- Ability to send HTTP requests: The attacker needs to be able to send HTTP POST requests to the router.

**Additional Details**
- The vulnerable firmware version is TOTOLINK N350RT V9.3.5u.6139_B20201216
- The provided POC demonstrates injecting the `ps` command through the `host_time` parameter to execute on the device.
- The attacker can achieve a stable root shell via command injection.