- **Root cause of vulnerability**: The `pb_adv_handle_transaction_cont` function in `src/mesh/pb_adv.c` doesn't properly validate the segment number in a received provisioning PDU, which allows an attacker to manipulate the `msg_pos` variable, causing an out-of-bounds write to `pb_adv_msg_in_buffer`.
- **Weaknesses/vulnerabilities present**:
    - **Buffer overflow**: The primary vulnerability is a buffer overflow in the `memcpy` operation. The attacker controls the segment number within a PDU, which is used to calculate `msg_pos`. This attacker-controlled `msg_pos` value, when added to the `pb_adv_msg_in_buffer` base address, allows writing data beyond the allocated buffer.
    - **Lack of input validation**: The code lacks proper validation of the segment number (`seg`) to ensure `msg_pos` remains within bounds.
- **Impact of exploitation**:
    - **Crash of the BLE mesh provisioner**: By sending a crafted Generic Provisioning PDU, a malicious BLE mesh device can cause a buffer overflow, which results in a crash of the provisioner.
    - **Potential for code execution**: An attacker may potentially overwrite variables after the `pb_adv_msg_in_buffer` using carefully crafted data and control the program flow to achieve code execution.
- **Attack vectors**:
    - **Malicious BLE mesh device**: An attacker can exploit this vulnerability by sending a crafted Generic Provisioning PDU via a malicious BLE mesh device, using the PB-ADV provisioning method.
- **Required attacker capabilities/position**:
    - **Proximity**: The attacker needs to be within BLE range of the vulnerable device to transmit the malicious PDU.
    - **Understanding of mesh protocol**: The attacker needs to have knowledge of the BLE mesh provisioning protocol to craft the malicious PDU.