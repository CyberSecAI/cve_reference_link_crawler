- **Root cause of vulnerability**: The plugin prioritizes obtaining a visitor's IP address from specific HTTP headers (like `HTTP_X_REAL_IP`) over the PHP `REMOTE_ADDR` variable.
- **Weaknesses/vulnerabilities present**: IP spoofing. The plugin trusts the `HTTP_X_REAL_IP` header, which can be easily manipulated by an attacker.
- **Impact of exploitation**: Attackers can bypass access restrictions and gain access to restricted content by spoofing their IP address to one on the allowlist.
- **Attack vectors**: The attacker manipulates the `HTTP_X_REAL_IP` header in their HTTP request.
- **Required attacker capabilities/position**: The attacker needs to be able to send HTTP requests to the server hosting the vulnerable plugin and be aware of IP addresses on the allow list.