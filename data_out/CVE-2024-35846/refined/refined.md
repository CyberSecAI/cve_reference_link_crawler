The provided content relates to CVE-2024-35846.

**Root cause of vulnerability:**
The vulnerability is a NULL pointer dereference in the zswap shrinker within the Linux kernel. This occurs when memory cgroups (memcg) are disabled using the `cgroup_disable=memory` boot flag. In this scenario, the zswap shrinker may be invoked with `sc->memcg` being NULL. While this is acceptable in some parts of the code, it leads to a crash within `memcg_page_state()` because this function expects a valid `memcg` pointer.

**Weaknesses/vulnerabilities present:**
- NULL pointer dereference: The `memcg_page_state()` function is called on a potentially NULL `memcg` pointer, leading to a crash.
- Improper handling of disabled memory cgroups: The zswap shrinker does not properly handle the case where memory cgroups are disabled, resulting in a NULL pointer when attempting to access memcg stats.

**Impact of exploitation:**
- Kernel crash: The NULL pointer dereference in `memcg_page_state()` causes a kernel crash, leading to a denial-of-service condition.
- System instability: The kernel crash can disrupt system operations and may result in data loss or corruption.

**Attack vectors:**
- Boot-time configuration: The attacker can trigger this vulnerability by disabling memory cgroups using the `cgroup_disable=memory` boot flag.
- Memory pressure: The vulnerability is triggered when the zswap shrinker is called due to memory pressure.

**Required attacker capabilities/position:**
- The attacker needs to be able to control the boot parameters of the system to disable memory cgroups.
- The attacker needs to create memory pressure that causes the zswap shrinker to be invoked, leading to the NULL pointer dereference.