
[![](/images/me.png)](/)
[Aecous](/)

* [Home](/)
* [Archives](/archives/)
* [Friends](/friends/)
* [About](/about/)

Dreamer-CMS后台模板任意文件读取编辑

2023-09-22 18:19:12

<https://gitee.com/iteachyou/dreamer_cms>
<http://cms.iteachyou.cc/>

模板管理
template management
![image.png](https://cdn.nlark.com/yuque/0/2023/png/35213294/1694960237159-5ca5d89c-1c2a-4406-8ba9-c2885a50e1f0.png#averageHue=%23c6bd79&clientId=u84a67996-b778-4&from=paste&height=877&id=u380be6cf&originHeight=1316&originWidth=2306&originalType=binary&ratio=1.5&rotation=0&showTitle=false&size=133654&status=done&style=none&taskId=ud26f767a-736e-4be2-85f8-fdd53e67da2&title=&width=1537.3333333333333)
![image.png](https://cdn.nlark.com/yuque/0/2023/png/35213294/1694960428661-07bb0262-ecb1-42b2-9747-9fa6a27084bd.png#averageHue=%232d2d2c&clientId=u84a67996-b778-4&from=paste&height=467&id=u9d2c5369&originHeight=701&originWidth=1465&originalType=binary&ratio=1.5&rotation=0&showTitle=false&size=168181&status=done&style=none&taskId=u13d3b1f7-3956-4611-a80b-be6c3b47c86&title=&width=976.6666666666666)
观察源码可知，会对访问的目录或文件进行一个判断，要求必须从themeDir的绝对路径开始，否则抛出异常
Observing the source code, it can be seen that a judgment is made on the directory or file being accessed, requiring that it must start from the absolute path of themeDir, otherwise an exception will be thrown
![image.png](https://cdn.nlark.com/yuque/0/2023/png/35213294/1694960582443-203077f8-aeb7-4960-908d-f6ddc866ca26.png#averageHue=%236a5d43&clientId=u84a67996-b778-4&from=paste&height=158&id=u7edf3e1d&originHeight=237&originWidth=1358&originalType=binary&ratio=1.5&rotation=0&showTitle=false&size=68802&status=done&style=none&taskId=u75d20d95-d427-464b-a15c-e14d639062b&title=&width=905.3333333333334)
themeDir来源于themePath，themePath由多个参数拼接，其中有一个参数为currentThemePath.getThemePath()
The themeDir comes from the themePath, which is composed of multiple parameters, including one parameter called currentThemePath.getThemePath().
![image.png](https://cdn.nlark.com/yuque/0/2023/png/35213294/1694960695565-0e46636f-0bcf-41db-a0ac-0c53838c46a5.png#averageHue=%23312d2b&clientId=u84a67996-b778-4&from=paste&height=120&id=u6baf9ed1&originHeight=180&originWidth=1199&originalType=binary&ratio=1.5&rotation=0&showTitle=false&size=59640&status=done&style=none&taskId=uc866dc92-e5cf-4b28-b65c-1d5cb5ffd20&title=&width=799.3333333333334)
currentThemePath.getThemePath()发现来源于theme的设置
currentThemePath.getThemePath() finds settings that originate from theme
![image.png](https://cdn.nlark.com/yuque/0/2023/png/35213294/1694960743029-fcaf6f54-1727-4922-8169-06416bcd8191.png#averageHue=%232e2c2b&clientId=u84a67996-b778-4&from=paste&height=273&id=KZwso&originHeight=410&originWidth=833&originalType=binary&ratio=1.5&rotation=0&showTitle=false&size=51526&status=done&style=none&taskId=u56d9a620-fae1-46e9-96ad-17a0b2ffc55&title=&width=555.3333333333334)
模板默认值为default\_v2
The default value of the template is default\_ v2
![image.png](https://cdn.nlark.com/yuque/0/2023/png/35213294/1694960836538-0d284ed8-1aaa-4b31-bb44-4d00376b8746.png#averageHue=%237b6d4d&clientId=u84a67996-b778-4&from=paste&height=280&id=u6db4debd&originHeight=420&originWidth=1117&originalType=binary&ratio=1.5&rotation=0&showTitle=false&size=107742&status=done&style=none&taskId=uaa1136fb-cd66-44f6-a885-3d16de28605&title=&width=744.6666666666666)

风格管理功能，其后端处理实现是ThemesController
The backend implementation for the style management feature is ThemesController.
![image.png](https://cdn.nlark.com/yuque/0/2023/png/35213294/1694960147456-97b8cf3e-5758-47cc-ae97-c620b0a0d394.png#averageHue=%23a9b86d&clientId=u84a67996-b778-4&from=paste&height=813&id=u3ca86b57&originHeight=1220&originWidth=2041&originalType=binary&ratio=1.5&rotation=0&showTitle=false&size=237247&status=done&style=none&taskId=u909cb166-73ec-4f6d-855c-4009ba624d6&title=&width=1360.6666666666667)
观察ThemesController，我可以通过上传一个新的模板，并设置其themePath的值
In the ThemesController，I can upload a new theme pack to set up themepath ![image.png](https://cdn.nlark.com/yuque/0/2023/png/35213294/1694960993357-95a667b3-c581-401d-be15-e2d4500ba755.png#averageHue=%232f2c2b&clientId=u84a67996-b778-4&from=paste&height=362&id=Hhw3c&originHeight=543&originWidth=1522&originalType=binary&ratio=1.5&rotation=0&showTitle=false&size=171259&status=done&style=none&taskId=ud535c329-5725-4a45-a3ec-368c4803c4c&title=&width=1014.6666666666666)
![image.png](https://cdn.nlark.com/yuque/0/2023/png/35213294/1694960950006-cf0831c4-e84c-4d1c-898d-e00db2a43765.png#averageHue=%23796245&clientId=u84a67996-b778-4&from=paste&height=470&id=u9881bf6c&originHeight=705&originWidth=1314&originalType=binary&ratio=1.5&rotation=0&showTitle=false&size=170735&status=done&style=none&taskId=uce1c2e9b-c5bb-48c9-9545-699d33c73c2&title=&width=876)
![image.png](https://cdn.nlark.com/yuque/0/2023/png/35213294/1694960111370-aa4fa5d5-2fdf-4baa-b6aa-c760df521f12.png#averageHue=%23f2f1f1&clientId=u84a67996-b778-4&from=paste&height=209&id=ubd731e7b&originHeight=314&originWidth=825&originalType=binary&ratio=1.5&rotation=0&showTitle=false&size=15117&status=done&style=none&taskId=u5633f012-0b20-45f6-bd14-44fff769b87&title=&width=550)
使用新的主题包
use new theme pack
![image.png](https://cdn.nlark.com/yuque/0/2023/png/35213294/1694961045009-66633314-eef3-470c-b121-412a350f3722.png#averageHue=%23afb46e&clientId=u84a67996-b778-4&from=paste&height=518&id=u5d533dab&originHeight=777&originWidth=1456&originalType=binary&ratio=1.5&rotation=0&showTitle=false&size=185241&status=done&style=none&taskId=u5e6f0427-d188-477b-8e6b-d5105a9330d&title=&width=970.6666666666666)

回到模板管理，我就可以看见自己D盘目录下的所有内容，并且可以编辑
Returning to template management, I can see all the content in my D drive directory and edit it
![image.png](https://cdn.nlark.com/yuque/0/2023/png/35213294/1694961121668-f8aa1f32-6792-4d61-b82c-1bc770e55a85.png#averageHue=%23ccc17d&clientId=u84a67996-b778-4&from=paste&height=909&id=u9bd2a612&originHeight=1363&originWidth=1851&originalType=binary&ratio=1.5&rotation=0&showTitle=false&size=127487&status=done&style=none&taskId=ua15f336e-2da6-4530-bf6e-88dba830702&title=&width=1234)
![image.png](https://cdn.nlark.com/yuque/0/2023/png/35213294/1694961219781-69c5a0cb-f0ec-4182-98be-6a202ceeca07.png#averageHue=%23272822&clientId=u84a67996-b778-4&from=paste&height=771&id=MJkcm&originHeight=1156&originWidth=1908&originalType=binary&ratio=1.5&rotation=0&showTitle=false&size=41164&status=done&style=none&taskId=ue9cf849a-05fc-4859-82ef-6e8f4234a3f&title=&width=1272)
观察源码，可以发现themePath进行了拼接
Observing the source code, it can be observed that the themePath has been concatenated
![image.png](https://cdn.nlark.com/yuque/0/2023/png/35213294/1694961166823-15a5b22a-27dd-4dda-973c-7162cbb506bc.png#averageHue=%232f2c2b&clientId=u84a67996-b778-4&from=paste&height=271&id=ucc3a9736&originHeight=406&originWidth=1305&originalType=binary&ratio=1.5&rotation=0&showTitle=false&size=105730&status=done&style=none&taskId=u13669157-6492-4e5f-a16a-bfaad0c3004&title=&width=870)

[Prev](/2023/09/15/SICTF-%E5%87%BA%E9%A2%98%E8%AE%B0%E5%BD%95/)

2023-09-22 18:19:12

[Next](/2023/09/28/LFI-tools/)

[Copyright © 2024 Oranges](https://github.com/zchengsite/hexo-theme-oranges)

[Theme by Oranges | Powered by Hexo](https://github.com/zchengsite/hexo-theme-oranges)

