```
{
  "cve": "CVE-2023-52597",
  "description": "The Linux kernel KVM subsystem on s390 architecture has a vulnerability where the `kvm_arch_vcpu_ioctl_set_fpu()` function, used to set the floating-point control (fpc) register of a guest CPU, temporarily loads the new value into the host's fpc register for validation. If an interrupt occurs during this temporary load, and floating-point or vector registers are used within the interrupt context, the host's fpc register can be corrupted. The original value is restored, but this restoration is discarded when returning to user space, causing the host process to run with the guest's fpc value. This is fixed by removing the temporary validation load and relying on the validation performed before entering the SIE context. This change allows invalid values, which will be replaced by zero at a later stage, to be set without returning an error.",
  "affected_components": [
    "Linux Kernel",
    "KVM subsystem",
    "s390 architecture"
  ],
  "root_cause": "The root cause is the temporary loading of the guest's FPC register value into the host's FPC register within the `kvm_arch_vcpu_ioctl_set_fpu()` function. This temporary load for validation leads to a race condition if an interrupt occurs and uses floating point registers during that time.",
  "vulnerabilities": [
    "Race condition",
    "FPC register corruption"
  ],
  "impact": "The vulnerability can cause the host process to operate with an incorrect fpc register value, which could lead to incorrect calculations, application malfunctions or system instability.",
  "attack_vectors": [
    "Exploiting the `kvm_arch_vcpu_ioctl_set_fpu()` ioctl interface to set a specific fpc register value",
    "Triggering an interrupt while the guest FPC value is temporarily loaded into the host's FPC register"
  ],
  "required_capabilities": [
      "The attacker needs to be able to control the fpc register value of a guest vm via the kvm_arch_vcpu_ioctl_set_fpu ioctl.",
      "The attacker would need to time their attack with a suitable interrupt"
  ]
}
```