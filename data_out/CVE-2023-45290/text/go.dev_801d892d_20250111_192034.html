
[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fgolang%2Fgo%2Fissues%2F65383)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fgolang%2Fgo%2Fissues%2F65383)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=golang%2Fgo)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[golang](/golang)
/
**[go](/golang/go)**
Public

* [Notifications](/login?return_to=%2Fgolang%2Fgo) You must be signed in to change notification settings
* [Fork
  17.8k](/login?return_to=%2Fgolang%2Fgo)
* [Star
   125k](/login?return_to=%2Fgolang%2Fgo)

* [Code](/golang/go)
* [Issues
  5k+](/golang/go/issues)
* [Pull requests
  508](/golang/go/pulls)
* [Discussions](/golang/go/discussions)
* [Actions](/golang/go/actions)
* [Projects
  4](/golang/go/projects)
* [Wiki](/golang/go/wiki)
* [Security](/golang/go/security)
* [Insights](/golang/go/pulse)

Additional navigation options

* [Code](/golang/go)
* [Issues](/golang/go/issues)
* [Pull requests](/golang/go/pulls)
* [Discussions](/golang/go/discussions)
* [Actions](/golang/go/actions)
* [Projects](/golang/go/projects)
* [Wiki](/golang/go/wiki)
* [Security](/golang/go/security)
* [Insights](/golang/go/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fgolang%2Fgo%2Fissues%2Fnew%2Fchoose)

By clicking ‚ÄúSign up for GitHub‚Äù, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We‚Äôll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fgolang%2Fgo%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# net/http: memory exhaustion in Request.ParseMultipartForm [CVE-2023-45290] #65383

Closed

[neild](/neild) opened this issue
Jan 30, 2024
¬∑ 8 comments

Closed

# [net/http: memory exhaustion in Request.ParseMultipartForm [CVE-2023-45290]](#top) #65383

[neild](/neild) opened this issue
Jan 30, 2024
¬∑ 8 comments

Assignees
[![@neild](https://avatars.githubusercontent.com/u/52544?s=40&v=4)](/neild)

Labels
[release-blocker](/golang/go/labels/release-blocker)
[Security](/golang/go/labels/Security)

Milestone
[Go1.23](/golang/go/milestone/212 "Go1.23")

## Comments

[![@neild](https://avatars.githubusercontent.com/u/52544?s=80&u=41bff20219d93918578944360c3930f30df4693b&v=4)](/neild)

Copy link

Contributor

### **[neild](/neild)** commented [Jan 30, 2024](#issue-2108879976) ‚Ä¢ edited by mknyszek Loading

| When parsing a multipart form (either explicitly with Request.ParseMultipartForm or implicitly with Request.FormValue, Request.PostFormValue, or Request.FormFile), limits on the total size of the parsed form were not applied to the memory consumed while reading a single form line. This permitted a maliciously crafted input containing very long lines to cause allocation of arbitrarily large amounts of memory, potentially leading to memory exhaustion.  ParseMultipartForm now correctly limits the maximum size of form lines.  Thanks to Bartek Nowotarski for reporting this issue. This is [CVE-2023-45290](https://github.com/advisories/GHSA-rr6r-cfgf-gc6h "CVE-2023-45290"). |
| --- |
| The text was updated successfully, but these errors were encountered: |

 üëÄ
1
 Jyny reacted with eyes emoji

All reactions

* üëÄ
  1 reaction

[![@neild](https://avatars.githubusercontent.com/u/52544?s=40&u=41bff20219d93918578944360c3930f30df4693b&v=4)](/neild)
[neild](/neild)
self-assigned this
[Jan 30, 2024](#event-11648154740)

[![@neild](https://avatars.githubusercontent.com/u/52544?s=40&u=41bff20219d93918578944360c3930f30df4693b&v=4)](/neild)
[neild](/neild)
added
[Security](/golang/go/labels/Security)
[release-blocker](/golang/go/labels/release-blocker)
labels
[Jan 30, 2024](#event-11648155976)

[![@neild](https://avatars.githubusercontent.com/u/52544?s=40&u=41bff20219d93918578944360c3930f30df4693b&v=4)](/neild)
[neild](/neild)
added this to the [Go1.22](/golang/go/milestone/298) milestone
[Jan 30, 2024](#event-11648156657)

[![@neild](https://avatars.githubusercontent.com/u/52544?s=80&u=41bff20219d93918578944360c3930f30df4693b&v=4)](/neild)

Copy link

Contributor

Author

### **[neild](/neild)** commented [Jan 30, 2024](#issuecomment-1917986548)

| [@gopherbot](https://github.com/gopherbot) please open backport issues for this security fix. |
| --- |

All reactions

Sorry, something went wrong.

This was referenced Jan 30, 2024

[security: fix CVE-2023-45290 [1.20 backport]
#65388](/golang/go/issues/65388)

Closed

[security: fix CVE-2023-45290 [1.21 backport]
#65389](/golang/go/issues/65389)

Closed

[![@gopherbot](https://avatars.githubusercontent.com/u/8566911?s=80&u=be84be2341a1a28dc2ede61150f7ceaaf470b8ba&v=4)](/gopherbot)

Copy link

Contributor

### **[gopherbot](/gopherbot)** commented [Jan 30, 2024](#issuecomment-1917987591)

| Backport issue(s) opened: [#65388](https://github.com/golang/go/issues/65388) (for 1.20), [#65389](https://github.com/golang/go/issues/65389) (for 1.21).  Remember to create the cherry-pick CL(s) as soon as the patch is submitted to master, according to <https://go.dev/wiki/MinorReleases>. |
| --- |

All reactions

Sorry, something went wrong.

[![@mknyszek](https://avatars.githubusercontent.com/u/1248668?s=40&u=43d1280f5d30cfd450e4b47693153b22a86ec893&v=4)](/mknyszek)
[mknyszek](/mknyszek)
modified the milestones:
[Go1.22](/golang/go/milestone/298),
[Go1.23](/golang/go/milestone/212)
[Feb 2, 2024](#event-11687598130)

[![@mknyszek](https://avatars.githubusercontent.com/u/1248668?s=80&u=43d1280f5d30cfd450e4b47693153b22a86ec893&v=4)](/mknyszek)

Copy link

Contributor

### **[mknyszek](/mknyszek)** commented [Feb 2, 2024](#issuecomment-1924436967)

| [@gopherbot](https://github.com/gopherbot) Please open a backport issue for Go 1.22 as well. |
| --- |

All reactions

Sorry, something went wrong.

[![@dmitshur](https://avatars.githubusercontent.com/u/1924134?s=80&u=db52e479359b3b7237ca14e22f87ff067e231769&v=4)](/dmitshur)

Copy link

Contributor

### **[dmitshur](/dmitshur)** commented [Feb 2, 2024](#issuecomment-1924450037)

| [@mknyszek](https://github.com/mknyszek) gopherbot is sorry but it can't do that yet: [#25574](https://github.com/golang/go/issues/25574). |
| --- |

 üëç
1
 mknyszek reacted with thumbs up emoji
 üòÑ
1
 mknyszek reacted with laugh emoji

All reactions

* üëç
  1 reaction
* üòÑ
  1 reaction

Sorry, something went wrong.

[![@mknyszek](https://avatars.githubusercontent.com/u/1248668?s=80&u=43d1280f5d30cfd450e4b47693153b22a86ec893&v=4)](/mknyszek)

Copy link

Contributor

### **[mknyszek](/mknyszek)** commented [Feb 2, 2024](#issuecomment-1924455438)

| I'll leave a note for the next release rotation person to do this after the release goes out, so it doesn't get lost. |
| --- |

All reactions

Sorry, something went wrong.

[![@neild](https://avatars.githubusercontent.com/u/52544?s=40&u=41bff20219d93918578944360c3930f30df4693b&v=4)](/neild)
[neild](/neild)
mentioned this issue
[Feb 21, 2024](#ref-issue-2147250734)

[security: fix CVE-2023-45290 [1.22 backport]
#65850](/golang/go/issues/65850)

Closed

[![@gopherbot](https://avatars.githubusercontent.com/u/8566911?s=80&u=be84be2341a1a28dc2ede61150f7ceaaf470b8ba&v=4)](/gopherbot)

Copy link

Contributor

### **[gopherbot](/gopherbot)** commented [Mar 5, 2024](#issuecomment-1979103726)

| Change <https://go.dev/cl/569237> mentions this issue: `[release-branch.go1.22] net/textproto, mime/multipart: avoid unbounded read in MIME header` |
| --- |

All reactions

Sorry, something went wrong.

[![@gopherbot](https://avatars.githubusercontent.com/u/8566911?s=80&u=be84be2341a1a28dc2ede61150f7ceaaf470b8ba&v=4)](/gopherbot)

Copy link

Contributor

### **[gopherbot](/gopherbot)** commented [Mar 5, 2024](#issuecomment-1979103822)

| Change <https://go.dev/cl/569240> mentions this issue: `[release-branch.go1.21] net/textproto, mime/multipart: avoid unbounded read in MIME header` |
| --- |

All reactions

Sorry, something went wrong.

[gopherbot](/gopherbot)
pushed a commit
that referenced
this issue
[Mar 5, 2024](#ref-commit-041a477)
[![@neild](https://avatars.githubusercontent.com/u/52544?s=40&u=41bff20219d93918578944360c3930f30df4693b&v=4)](/neild) [![@gopherbot](https://avatars.githubusercontent.com/u/8566911?s=40&v=4)](/gopherbot)

`[[release-branch.go1.22] net/textproto, mime/multipart: avoid unbounde‚Ä¶](/golang/go/commit/041a47712e765e94f86d841c3110c840e76d8f82 "[release-branch.go1.22] net/textproto, mime/multipart: avoid unbounded read in MIME header

mime/multipart.Reader.ReadForm allows specifying the maximum amount
of memory that will be consumed by the form. While this limit is
correctly applied to the parsed form data structure, it was not
being applied to individual header lines in a form.

For example, when presented with a form containing a header line
that never ends, ReadForm will continue to read the line until it
runs out of memory.

Limit the amount of data consumed when reading a header.

Fixes CVE-2023-45290
Fixes #65850
For #65383

Change-Id: I7f9264d25752009e95f6b2c80e3d76aaf321d658
Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/2134435
Reviewed-by: Roland Shoemaker <bracewell@google.com>
Reviewed-by: Tatiana Bradley <tatianabradley@google.com>
Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/2174345
Reviewed-by: Carlos Amedee <amedee@google.com>
Reviewed-on: https://go-review.googlesource.com/c/go/+/569237
Reviewed-by: Carlos Amedee <carlos@golang.org>
LUCI-TryBot-Result: Go LUCI <golang-scoped@luci-project-accounts.iam.gserviceaccount.com>
Auto-Submit: Michael Knyszek <mknyszek@google.com>")`
‚Ä¶

`[041a477](/golang/go/commit/041a47712e765e94f86d841c3110c840e76d8f82)`

```
‚Ä¶d read in MIME header

mime/multipart.Reader.ReadForm allows specifying the maximum amount
of memory that will be consumed by the form. While this limit is
correctly applied to the parsed form data structure, it was not
being applied to individual header lines in a form.

For example, when presented with a form containing a header line
that never ends, ReadForm will continue to read the line until it
runs out of memory.

Limit the amount of data consumed when reading a header.

Fixes [CVE-2023-45290](https://github.com/advisories/GHSA-rr6r-cfgf-gc6h "CVE-2023-45290")
Fixes [#65850](https://github.com/golang/go/issues/65850)
For [#65383](https://github.com/golang/go/issues/65383)

Change-Id: I7f9264d25752009e95f6b2c80e3d76aaf321d658
Reviewed-on: [https://team-review.git.corp.google.com/c/golang/go-private/+/2134435](https://team-review.git.corp.google.com/c/golang/go-private/%2B/2134435)
Reviewed-by: Roland Shoemaker <bracewell@google.com>
Reviewed-by: Tatiana Bradley <tatianabradley@google.com>
Reviewed-on: [https://team-review.git.corp.google.com/c/golang/go-private/+/2174345](https://team-review.git.corp.google.com/c/golang/go-private/%2B/2174345)
Reviewed-by: Carlos Amedee <amedee@google.com>
Reviewed-on: [https://go-review.googlesource.com/c/go/+/569237](https://go-review.googlesource.com/c/go/%2B/569237)
Reviewed-by: Carlos Amedee <carlos@golang.org>
LUCI-TryBot-Result: Go LUCI <golang-scoped@luci-project-accounts.iam.gserviceaccount.com>
Auto-Submit: Michael Knyszek <mknyszek@google.com>
```

[gopherbot](/gopherbot)
pushed a commit
that referenced
this issue
[Mar 5, 2024](#ref-commit-bf80213)
[![@neild](https://avatars.githubusercontent.com/u/52544?s=40&u=41bff20219d93918578944360c3930f30df4693b&v=4)](/neild) [![@gopherbot](https://avatars.githubusercontent.com/u/8566911?s=40&v=4)](/gopherbot)

`[[release-branch.go1.21] net/textproto, mime/multipart: avoid unbounde‚Ä¶](/golang/go/commit/bf80213b121074f4ad9b449410a4d13bae5e9be0 "[release-branch.go1.21] net/textproto, mime/multipart: avoid unbounded read in MIME header

mime/multipart.Reader.ReadForm allows specifying the maximum amount
of memory that will be consumed by the form. While this limit is
correctly applied to the parsed form data structure, it was not
being applied to individual header lines in a form.

For example, when presented with a form containing a header line
that never ends, ReadForm will continue to read the line until it
runs out of memory.

Limit the amount of data consumed when reading a header.

Fixes CVE-2023-45290
Fixes #65389
For #65383

Change-Id: I7f9264d25752009e95f6b2c80e3d76aaf321d658
Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/2134435
Reviewed-by: Roland Shoemaker <bracewell@google.com>
Reviewed-by: Tatiana Bradley <tatianabradley@google.com>
Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/2173776
Reviewed-by: Carlos Amedee <amedee@google.com>
Reviewed-on: https://go-review.googlesource.com/c/go/+/569240
Auto-Submit: Michael Knyszek <mknyszek@google.com>
LUCI-TryBot-Result: Go LUCI <golang-scoped@luci-project-accounts.iam.gserviceaccount.com>
Reviewed-by: Carlos Amedee <carlos@golang.org>")`
‚Ä¶

`[bf80213](/golang/go/commit/bf80213b121074f4ad9b449410a4d13bae5e9be0)`

```
‚Ä¶d read in MIME header

mime/multipart.Reader.ReadForm allows specifying the maximum amount
of memory that will be consumed by the form. While this limit is
correctly applied to the parsed form data structure, it was not
being applied to individual header lines in a form.

For example, when presented with a form containing a header line
that never ends, ReadForm will continue to read the line until it
runs out of memory.

Limit the amount of data consumed when reading a header.

Fixes [CVE-2023-45290](https://github.com/advisories/GHSA-rr6r-cfgf-gc6h "CVE-2023-45290")
Fixes [#65389](https://github.com/golang/go/issues/65389)
For [#65383](https://github.com/golang/go/issues/65383)

Change-Id: I7f9264d25752009e95f6b2c80e3d76aaf321d658
Reviewed-on: [https://team-review.git.corp.google.com/c/golang/go-private/+/2134435](https://team-review.git.corp.google.com/c/golang/go-private/%2B/2134435)
Reviewed-by: Roland Shoemaker <bracewell@google.com>
Reviewed-by: Tatiana Bradley <tatianabradley@google.com>
Reviewed-on: [https://team-review.git.corp.google.com/c/golang/go-private/+/2173776](https://team-review.git.corp.google.com/c/golang/go-private/%2B/2173776)
Reviewed-by: Carlos Amedee <amedee@google.com>
Reviewed-on: [https://go-review.googlesource.com/c/go/+/569240](https://go-review.googlesource.com/c/go/%2B/569240)
Auto-Submit: Michael Knyszek <mknyszek@google.com>
LUCI-TryBot-Result: Go LUCI <golang-scoped@luci-project-accounts.iam.gserviceaccount.com>
Reviewed-by: Carlos Amedee <carlos@golang.org>
```

[![@mknyszek](https://avatars.githubusercontent.com/u/1248668?s=40&u=43d1280f5d30cfd450e4b47693153b22a86ec893&v=4)](/mknyszek)
[mknyszek](/mknyszek)
changed the title
~~security: fix CVE-2023-45290~~
net/http: memory exhaustion in Request.ParseMultipartForm [CVE-2023-45290]
[Mar 5, 2024](#event-12017762086)

[bradfitz](/bradfitz)
pushed a commit
to tailscale/go
that referenced
this issue
[Mar 5, 2024](#ref-commit-56c3d20)
[![@neild](https://avatars.githubusercontent.com/u/52544?s=40&u=41bff20219d93918578944360c3930f30df4693b&v=4)](/neild) [![@bradfitz](https://avatars.githubusercontent.com/u/2621?s=40&v=4)](/bradfitz)

`[[release-branch.go1.22] net/textproto, mime/multipart: avoid unbounde‚Ä¶](/tailscale/go/commit/56c3d20caa59376f9d5f79756b96e37e5124ac49 "[release-branch.go1.22] net/textproto, mime/multipart: avoid unbounded read in MIME header

mime/multipart.Reader.ReadForm allows specifying the maximum amount
of memory that will be consumed by the form. While this limit is
correctly applied to the parsed form data structure, it was not
being applied to individual header lines in a form.

For example, when presented with a form containing a header line
that never ends, ReadForm will continue to read the line until it
runs out of memory.

Limit the amount of data consumed when reading a header.

Fixes CVE-2023-45290
Fixes #65850
For #65383

Change-Id: I7f9264d25752009e95f6b2c80e3d76aaf321d658
Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/2134435
Reviewed-by: Roland Shoemaker <bracewell@google.com>
Reviewed-by: Tatiana Bradley <tatianabradley@google.com>
Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/2174345
Reviewed-by: Carlos Amedee <amedee@google.com>
Reviewed-on: https://go-review.googlesource.com/c/go/+/569237
Reviewed-by: Carlos Amedee <carlos@golang.org>
LUCI-TryBot-Result: Go LUCI <golang-scoped@luci-project-accounts.iam.gserviceaccount.com>
Auto-Submit: Michael Knyszek <mknyszek@google.com>")`
‚Ä¶

`[56c3d20](/tailscale/go/commit/56c3d20caa59376f9d5f79756b96e37e5124ac49)`

```
‚Ä¶d read in MIME header

mime/multipart.Reader.ReadForm allows specifying the maximum amount
of memory that will be consumed by the form. While this limit is
correctly applied to the parsed form data structure, it was not
being applied to individual header lines in a form.

For example, when presented with a form containing a header line
that never ends, ReadForm will continue to read the line until it
runs out of memory.

Limit the amount of data consumed when reading a header.

Fixes [CVE-2023-45290](https://github.com/advisories/GHSA-rr6r-cfgf-gc6h "CVE-2023-45290")
Fixes [golang#65850](https://github.com/golang/go/issues/65850)
For [golang#65383](https://github.com/golang/go/issues/65383)

Change-Id: I7f9264d25752009e95f6b2c80e3d76aaf321d658
Reviewed-on: [https://team-review.git.corp.google.com/c/golang/go-private/+/2134435](https://team-review.git.corp.google.com/c/golang/go-private/%2B/2134435)
Reviewed-by: Roland Shoemaker <bracewell@google.com>
Reviewed-by: Tatiana Bradley <tatianabradley@google.com>
Reviewed-on: [https://team-review.git.corp.google.com/c/golang/go-private/+/2174345](https://team-review.git.corp.google.com/c/golang/go-private/%2B/2174345)
Reviewed-by: Carlos Amedee <amedee@google.com>
Reviewed-on: [https://go-review.googlesource.com/c/go/+/569237](https://go-review.googlesource.com/c/go/%2B/569237)
Reviewed-by: Carlos Amedee <carlos@golang.org>
LUCI-TryBot-Result: Go LUCI <golang-scoped@luci-project-accounts.iam.gserviceaccount.com>
Auto-Submit: Michael Knyszek <mknyszek@google.com>
```

[![@gopherbot](https://avatars.githubusercontent.com/u/8566911?s=80&u=be84be2341a1a28dc2ede61150f7ceaaf470b8ba&v=4)](/gopherbot)

Copy link

Contributor

### **[gopherbot](/gopherbot)** commented [Mar 5, 2024](#issuecomment-1979358902)

| Change <https://go.dev/cl/569341> mentions this issue: `net/textproto, mime/multipart: avoid unbounded read in MIME header` |
| --- |

All reactions

Sorry, something went wrong.

[![@gopherbot](https://avatars.githubusercontent.com/u/8566911?s=40&u=be84be2341a1a28dc2ede61150f7ceaaf470b8ba&v=4)](/gopherbot)
[gopherbot](/gopherbot)
closed this as [completed](/golang/go/issues?q=is%3Aissue+is%3Aclosed+archived%3Afalse+reason%3Acompleted)
in
`[16e5d24](/golang/go/commit/16e5d24480dca7ddcbdffb78a8ed5de3e5155dec)`
[Mar 5, 2024](#event-12018132668)

[romaindoumenc](/romaindoumenc)
pushed a commit
to TroutSoftware/go
that referenced
this issue
[Mar 6, 2024](#ref-commit-c1324bf)
[![@neild](https://avatars.githubusercontent.com/u/52544?s=40&u=41bff20219d93918578944360c3930f30df4693b&v=4)](/neild) [![@romaindoumenc](https://avatars.githubusercontent.com/u/4268844?s=40&v=4)](/romaindoumenc)

`[[release-branch.go1.22] net/textproto, mime/multipart: avoid unbounde‚Ä¶](/TroutSoftware/go/commit/c1324bf38d29fd5910b0ef96a7f5cd1ad7ecd27c "[release-branch.go1.22] net/textproto, mime/multipart: avoid unbounded read in MIME header

mime/multipart.Reader.ReadForm allows specifying the maximum amount
of memory that will be consumed by the form. While this limit is
correctly applied to the parsed form data structure, it was not
being applied to individual header lines in a form.

For example, when presented with a form containing a header line
that never ends, ReadForm will continue to read the line until it
runs out of memory.

Limit the amount of data consumed when reading a header.

Fixes CVE-2023-45290
Fixes #65850
For #65383

Change-Id: I7f9264d25752009e95f6b2c80e3d76aaf321d658
Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/2134435
Reviewed-by: Roland Shoemaker <bracewell@google.com>
Reviewed-by: Tatiana Bradley <tatianabradley@google.com>
Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/2174345
Reviewed-by: Carlos Amedee <amedee@google.com>
Reviewed-on: https://go-review.googlesource.com/c/go/+/569237
Reviewed-by: Carlos Amedee <carlos@golang.org>
LUCI-TryBot-Result: Go LUCI <golang-scoped@luci-project-accounts.iam.gserviceaccount.com>
Auto-Submit: Michael Knyszek <mknyszek@google.com>")`
‚Ä¶

`[c1324bf](/TroutSoftware/go/commit/c1324bf38d29fd5910b0ef96a7f5cd1ad7ecd27c)`

```
‚Ä¶d read in MIME header

mime/multipart.Reader.ReadForm allows specifying the maximum amount
of memory that will be consumed by the form. While this limit is
correctly applied to the parsed form data structure, it was not
being applied to individual header lines in a form.

For example, when presented with a form containing a header line
that never ends, ReadForm will continue to read the line until it
runs out of memory.

Limit the amount of data consumed when reading a header.

Fixes [CVE-2023-45290](https://github.com/advisories/GHSA-rr6r-cfgf-gc6h "CVE-2023-45290")
Fixes [golang#65850](https://github.com/golang/go/issues/65850)
For [golang#65383](https://github.com/golang/go/issues/65383)

Change-Id: I7f9264d25752009e95f6b2c80e3d76aaf321d658
Reviewed-on: [https://team-review.git.corp.google.com/c/golang/go-private/+/2134435](https://team-review.git.corp.google.com/c/golang/go-private/%2B/2134435)
Reviewed-by: Roland Shoemaker <bracewell@google.com>
Reviewed-by: Tatiana Bradley <tatianabradley@google.com>
Reviewed-on: [https://team-review.git.corp.google.com/c/golang/go-private/+/2174345](https://team-review.git.corp.google.com/c/golang/go-private/%2B/2174345)
Reviewed-by: Carlos Amedee <amedee@google.com>
Reviewed-on: [https://go-review.googlesource.com/c/go/+/569237](https://go-review.googlesource.com/c/go/%2B/569237)
Reviewed-by: Carlos Amedee <carlos@golang.org>
LUCI-TryBot-Result: Go LUCI <golang-scoped@luci-project-accounts.iam.gserviceaccount.com>
Auto-Submit: Michael Knyszek <mknyszek@google.com>
```

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fgolang%2Fgo%2Fissues%2F65383)

Assignees

[![@neild](https://avatars.githubusercontent.com/u/52544?s=40&v=4)](/neild) [neild](/neild)

Labels

[release-blocker](/golang/go/labels/release-blocker)
[Security](/golang/go/labels/Security)

Projects

None yet

Milestone

 [**Go1.23**](/golang/go/milestone/212 "Go1.23")

Development

No branches or pull requests

4 participants

[![@neild](https://avatars.githubusercontent.com/u/52544?s=52&v=4)](/neild) [![@mknyszek](https://avatars.githubusercontent.com/u/1248668?s=52&v=4)](/mknyszek) [![@dmitshur](https://avatars.githubusercontent.com/u/1924134?s=52&v=4)](/dmitshur) [![@gopherbot](https://avatars.githubusercontent.com/u/8566911?s=52&v=4)](/gopherbot)

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.

