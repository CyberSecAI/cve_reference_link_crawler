=== Content from tekfused.com_3a2c7fbb_20250108_152545.html ===

[Skip to content](#fl-main-content)

[![tekfused-logo_255x32](https://tekfused.com/wp-content/uploads/2016/12/TEKFused-Logo_255x32.png "tekfused-logo_255x32")](https://tekfused.com)

* [About](https://tekfused.com/about/)
* [Blog](https://tekfused.com/blog/)
* Services
  + [Courses](https://tekfused.com/courses/)
  + WordPress
    - [Design](https://tekfused.com/wordpress-website-design/)
    - [Hosting](https://tekfused.com/managed-wordpress-hosting/)
    - [Support Plans](https://tekfused.com/wordpress-support-plans/)
    - [Portfolio](https://tekfused.com/wordpress-website-design/portfolio/)
* [Contact](https://tekfused.com/contact/)
* Clients
  + [Billing](https://books.zoho.com/portal/tekfused/login)
  + [Support](https://support.tekfused.com/portal/newticket)

 ×

* [About](https://tekfused.com/about/)
* [Blog](https://tekfused.com/blog/)
* Services
  + [Courses](https://tekfused.com/courses/)
  + WordPress
    - [Design](https://tekfused.com/wordpress-website-design/)
    - [Hosting](https://tekfused.com/managed-wordpress-hosting/)
    - [Support Plans](https://tekfused.com/wordpress-support-plans/)
    - [Portfolio](https://tekfused.com/wordpress-website-design/portfolio/)
* [Contact](https://tekfused.com/contact/)
* Clients
  + [Billing](https://books.zoho.com/portal/tekfused/login)
  + [Support](https://support.tekfused.com/portal/newticket)

[Home](https://tekfused.com) / Vulnerability Research

# Posts

[![](https://tekfused.com/wp-content/uploads/2021/10/shutterstock_1698488101-1024x576.jpg)](https://tekfused.com/tek/vulnerability-research/beaver-builder-vulnerabilities-visibility-conditional-logic-cve/ "Beaver Builder Vulnerabilities – Visibility and Conditional Logic (CVE-2021-42748 & CVE-2021-42749)")

### [Beaver Builder Vulnerabilities – Visibility and Conditional Logic (CVE-2021-42748 & CVE-2021-42749)](https://tekfused.com/tek/vulnerability-research/beaver-builder-vulnerabilities-visibility-conditional-logic-cve/ "Beaver Builder Vulnerabilities – Visibility and Conditional Logic (CVE-2021-42748 & CVE-2021-42749)")

Bottom line up front I discovered two sensitive information disclosure vulnerabilities that affect Beaver Builder's element visibility and Beaver Themer's conditional logic controls. These vulnerabilities ...

[Privacy Policy](https://tekfused.com/privacy)



=== Content from tekfused.com_b7772c27_20250108_121145.html ===

[Skip to content](#fl-main-content)

[![tekfused-logo_255x32](https://tekfused.com/wp-content/uploads/2016/12/TEKFused-Logo_255x32.png "tekfused-logo_255x32")](https://tekfused.com)

* [About](https://tekfused.com/about/)
* [Blog](https://tekfused.com/blog/)
* Services
  + [Courses](https://tekfused.com/courses/)
  + WordPress
    - [Design](https://tekfused.com/wordpress-website-design/)
    - [Hosting](https://tekfused.com/managed-wordpress-hosting/)
    - [Support Plans](https://tekfused.com/wordpress-support-plans/)
    - [Portfolio](https://tekfused.com/wordpress-website-design/portfolio/)
* [Contact](https://tekfused.com/contact/)
* Clients
  + [Billing](https://books.zoho.com/portal/tekfused/login)
  + [Support](https://support.tekfused.com/portal/newticket)

 ×

* [About](https://tekfused.com/about/)
* [Blog](https://tekfused.com/blog/)
* Services
  + [Courses](https://tekfused.com/courses/)
  + WordPress
    - [Design](https://tekfused.com/wordpress-website-design/)
    - [Hosting](https://tekfused.com/managed-wordpress-hosting/)
    - [Support Plans](https://tekfused.com/wordpress-support-plans/)
    - [Portfolio](https://tekfused.com/wordpress-website-design/portfolio/)
* [Contact](https://tekfused.com/contact/)
* Clients
  + [Billing](https://books.zoho.com/portal/tekfused/login)
  + [Support](https://support.tekfused.com/portal/newticket)

[Home](https://tekfused.com) / [Vulnerability Research](https://tekfused.com/category/tek/vulnerability-research/) / Beaver Builder Vulnerabilities – Visibility and Conditional Logic (CVE-2021-42748 & CVE-2021-42749)

# Beaver Builder Vulnerabilities – Visibility and Conditional Logic (CVE-2021-42748 & CVE-2021-42749)

December 9, 2021/[Jacob Hill](https://tekfused.com/author/jakerhill-2/)

## Bottom line up front

I discovered two sensitive information disclosure vulnerabilities that affect **Beaver Builder’s** [element visibility](https://docs.wpbeaverbuilder.com/beaver-builder/styles/visibility/change-element-visibility-by-user-login-and-capability/) and **Beaver Themer’s** [conditional logic](https://docs.wpbeaverbuilder.com/beaver-themer/conditional-logic/beaver-themer-conditional-logic/) controls. These vulnerabilities are resolved in Beaver Builder 2.5.1!

These vulnerabilities allow ANY user to view content that is hidden via the visibility or conditional logic controls.

**NOTE:** these vulnerabilities have been resolved by the Beaver Builder team, however, 3rd parties that have built their own modules (ie post archive /search modules) must update their module’s code so that their modules do not leak sensitive information. The Beaver Builder team has notified many of the 3rd party developers. The Beaver Builder team has also posted a [developer oriented article](https://docs.wpbeaverbuilder.com/beaver-builder/developer/conditionally-hidden-content/) about this issue.

### The Issues

Content protected with visibility or conditional logic controls is accessible:

* to ANY user via the **WordPress REST API** *([CVE-2021-42748](https://nvd.nist.gov/vuln/detail/CVE-2021-42748))*
* if a Beaver Themer layout is applied, and the post excerpt field is not set, the protected content may be shown in *([CVE-2021-42749](https://nvd.nist.gov/vuln/detail/CVE-2021-42749))*:
  + **post archive**
  + **search results**
  + potentially in **Google Search**

### What is affected

#### Beaver Builder

The **lite** (2.5.0.3 and older) and **professional** versions (2.5.0.3 and older) of the Beaver Builder page builder are affected. The [lite version](https://wordpress.org/plugins/beaver-builder-lite-version/) of Beaver Builder is installed on more than **200,000** websites.

**NOTE:** at the time of this writing, the Beaver Builder team hasn’t released an update for the lite version of Beaver Builder. They plan to release the Beaver Builder Lite update the week of 12/12/2021.

#### Beaver Themer

[Beaver Themer](https://www.wpbeaverbuilder.com/beaver-themer/) is also affected. Beaver Themer is an add-on to the [professional version](https://www.wpbeaverbuilder.com/page-builder/) of the Beaver Builder page builder which allows you to design every front-end area of WordPress.

The fix for the Beaver Themer vulnerability is included in Beaver Builder 2.5.1. Beaver Themer’s Conditional Logic feature is functionally separate from Beaver Builder’s visibility feature, but Beaver Themer uses a filter to hook into Beaver Builder’s codebase. The Beaver Builder 2.5.1 patch addresses both vulnerabilities.

## Timeline

The Beaver Builder team was extremely responsive and professional as they developed a fix to remediate these vulnerabilities!

* **Notification Sent to Beaver Builder**
  + Sunday, 10/17/2021
* **1st Response from Beaver Builder**
  + Monday, 10/18/2021
* **Patch Sent to Me for Testing**
  + Tuesday, 11/16/2021
* **Patch for Beaver Builder Professional Released**
  + Thursday, 12/9/2021

## Vulnerability Summary

The **lite** & **professional** versions of **Beaver Builder** include **visibility settings** which allow you to limit the visibility of content based on the user’s login status. You can even specify a WordPress capability (aka permission) that the user must have to see the content.

![](https://tekfused.com/wp-content/uploads/2021/10/image-12.png)

Beaver Builder Lite visibility settings

**Beaver Themer** extends the visibility controls by adding **conditional logic**. Conditional logic allows you to create complex if-then-this conditions to control the visibility of content. A simple example would be “show the content only IF the user is a customer.”

![](https://tekfused.com/wp-content/uploads/2021/10/Conditional-Logic-2.png)

Beaver Themer Conditional Logic

Visibility rules & conditional logic are checked on the server side before delivering the rendered page. As such, these features should be able to be used to control access to sensitive content on a page.

The Beaver Builder team gave the following explanation:

> The Post modules and the search module used the native WP the\_excerpt() which looks at the saved data in post\_content. The fix we implemented is to bypass that and use our layout functions. BB mirrors text based modules text in normal post content as a block so if you deactivate no text data or images are lost. So when WP looks up the excerpt it sees that data. As a result of that, it isn’t that we fixed a bug per se, more that we had to change default behavior.

### The Test Page

The **first row** is hidden by using the visibility control “Display -> Logged In User” setting:

![](https://tekfused.com/wp-content/uploads/2021/10/image-1.png)

Row 1 settings

---

The **second row** is hidden by using the Conditional Logic setting (user role equals “Customer”):

![](https://tekfused.com/wp-content/uploads/2021/10/image-14.png)

Row 2 settings

---

The **third row** is visible to all users.

![](https://tekfused.com/wp-content/uploads/2021/10/image-4.png)

Row 3 settings

---

The page displays the “Content for the world!” text module for anonymous users as expected.

![](https://tekfused.com/wp-content/uploads/2021/10/image-8.png)

Test page seen as an unauthenticated user

## The Vulnerabilities

### Content Exposed in the WordPress REST API ([CVE-2021-42748](https://nvd.nist.gov/vuln/detail/CVE-2021-42748))

*This vulnerability affects **Beaver Builder** (Lite & Professional) and **Beaver Themer**.*

I sent a request to the “Posts” WordPress REST API endpoint as an unauthenticated (ie not logged in) user, and observed the protected content.

![](https://tekfused.com/wp-content/uploads/2021/10/image-6.png)

Unathenticated REST API call to WordPress

### Content Exposed in the Post Archive ([CVE-2021-42749](https://nvd.nist.gov/vuln/detail/CVE-2021-42749))

 *This vulnerability affects **Beaver Themer**.*

If:

* A Beaver Themer layout is applied to the post/search archive
* The post’s “Excerpt” field is not set
* The protected content is at the top of the post’s content

The protected content will be displayed under the post’s title.

![](https://tekfused.com/wp-content/uploads/2021/10/image-9.png)

Post archive showing protected content

### Content Exposed in Google Search ([CVE-2021-42749](https://nvd.nist.gov/vuln/detail/CVE-2021-42749))

*This vulnerability affects **Beaver Themer**.*

Google lists the protected content in the Google SERP as it is displayed in the post category archive.

![](https://tekfused.com/wp-content/uploads/2021/10/image-10.png)

Google SERP showing protected content

![](https://tekfused.com/wp-content/uploads/2021/10/image-11.png)

 Link shown in Google SERP

## RSS Feeds

I tested the RSS feeds as an unauthenticated user, and they did **NOT** show the protected content.

## Conclusion

The solution to these vulnerabilities is to update to Beaver Builder **2.5.1**!

The principle of least functionality applies here – if you do not utilize the REST API, disable it – at least for unauthenticated users.

Posted in [Vulnerability Research](https://tekfused.com/category/tek/vulnerability-research/), [TEK](https://tekfused.com/category/tek/)

## Posts navigation

[← Beaver Themer, The Events Calendar, & Gutenberg](https://tekfused.com/wordpress/beaver-themer-the-events-calendar-gutenberg/)

### Leave a Comment [Cancel Reply](/tek/vulnerability-research/beaver-builder-vulnerabilities-visibility-conditional-logic-cve/#respond)

Comment
Name (required)

Email (will not be published) (required)

Website

Table of Contents

[Privacy Policy](https://tekfused.com/privacy)



=== Content from docs.wpbeaverbuilder.com_62e5fe91_20250108_121144.html ===

[Skip to main content](#__docusaurus_skipToContent_fallback)🎉 New [Beaver Builder template marketplace!](https://app.assistant.pro/community) Get started for FREE at [Assistant.Pro](https://assistant.pro/).[![Return to Beaver Builder](/bb-logo-inline.png)![Return to Beaver Builder](/bb-logo-inline.png)](https://www.wpbeaverbuilder.com/)[Beaver Builder 2.9](/beaver-builder/)

* [Beaver Builder 2.9](/beaver-builder/developer/conditionally-hidden-content)
* [Beaver Builder 2.8](/beaver-builder/2.8/developer/conditionally-hidden-content)
[Beaver Themer 1.4](/beaver-themer/1.4/)

* [Beaver Themer 1.5](/beaver-themer/)
* [Beaver Themer 1.4](/beaver-themer/1.4/)
[BB Theme](/bb-theme/)[Assistant](/assistant/)[Courses](https://courses.wpbeaverbuilder.com/)Search

* [Introduction](/beaver-builder/)
* [Account](/beaver-builder/account/)
* [Getting Started](/beaver-builder/category/getting-started)
* [User Interface (UI)](/beaver-builder/user-interface/)
* [Settings & Tools](/beaver-builder/settings/)
* [Builder Basics](/beaver-builder/basics/)
* [Layouts](/beaver-builder/category/layouts)
* [Shortcode](/beaver-builder/shortcode/)
* [Integrations](/beaver-builder/integrations/)
* [Advanced](/beaver-builder/advanced/)
* [Troubleshooting](/beaver-builder/category/troubleshooting)
* [Developer](/beaver-builder/category/developer)
  + [Custom Modules](/beaver-builder/developer/custom-modules/)
  + [Responsive iFrame UI](/beaver-builder/developer/iframe-ui)
  + [ACF Blocks](/beaver-builder/developer/acf-blocks)
  + [Module Blocks](/beaver-builder/developer/module-blocks)
  + [Container Modules](/beaver-builder/developer/container-modules)
  + [Module Deprecations](/beaver-builder/developer/module-deprecations)
  + [How to's & Tips](/beaver-builder/category/how-tos--tips)
  + [Tutorials & Guides](/beaver-builder/category/tutorials--guides)
  + [Conditionally Hidden Content](/beaver-builder/developer/conditionally-hidden-content)
  + [Hooks](https://hooks.wpbeaverbuilder.com/bb-plugin/)
This is unreleased documentation for Beaver Builder Knowledge Base **Beaver Builder 2.9** version.For up-to-date documentation, see the **[latest version](/beaver-builder/2.8/developer/conditionally-hidden-content)** (Beaver Builder 2.8).

* [Developer](/beaver-builder/category/developer)
* Conditionally Hidden Content
Version: Beaver Builder 2.9On this page
# The Problem with Conditionally Hidden Content

We were alerted to an issue with content that is hidden by Beaver Builder's visibility options or Beaver Themer's conditional logic. When viewed via the REST API or on archive layouts with modules that show a post loop, content that should be hidden was being displayed to all.

## How did this happen?[​](#how-did-this-happen "Direct link to How did this happen?")

When you add a text-based or image-based module to a page, the raw text and image data are saved to the native WordPress `post_content`. This ensure that if you deactivate Beaver Builder you will still have that data for WordPress to display.

Up until now, visibility settings were ignored when you published your layout. This meant that when WordPress displayed the post excerpt, it used everything it found in the `post_content`, which included anything that was supposed to be hidden.

## The Fixes We Implemented[​](#the-fixes-we-implemented "Direct link to The Fixes We Implemented")

We added some clever filters for the REST API so it respects any node visibility settings, so from 2.5.1 onwards, only visible text is added to the backup `post_content`.

## How To Get The Fixes[​](#how-to-get-the-fixes "Direct link to How To Get The Fixes")

Update to Beaver Builder 2.5.1. All of the fixes with conditionally hidden content are contained within the Beaver Builder Plugin 2.5.1 release.

If you are using hidden content in your layouts and hidden text is showing up in post modules or archives, we have a small utility plugin that removes the hidden content from the `post_content`. This does not change your layouts in any way.

### Download the utility plugin[​](#download-the-utility-plugin "Direct link to Download the utility plugin")

Download here: <https://updates.wpbeaverbuilder.com/public/bb-excerpt-data-fix.zip>

### How to use the plugin[​](#how-to-use-the-plugin "Direct link to How to use the plugin")

1. Make a full backup of your site, following best practice before updating WordPress, plugins or themes or adding new themes or plugins.
2. Install and activate the `Beaver Builder Excerpt Fix` plugin. Upon activation, it will fix your data to make sure the hidden content is not in `post_content`.
3. Check your post modules and archives and make sure the hidden data is not showing in the excerpt.
4. After the plugin runs, it deactivates itself and you can then delete it.
[PreviousAdd a custom shape layer](/beaver-builder/developer/tutorials-guides/add-a-custom-shape-layer)

* [How did this happen?](#how-did-this-happen)
* [The Fixes We Implemented](#the-fixes-we-implemented)
* [How To Get The Fixes](#how-to-get-the-fixes)
  + [Download the utility plugin](#download-the-utility-plugin)
  + [How to use the plugin](#how-to-use-the-plugin)
Docs

* [Beaver Builder](/beaver-builder)
* [Beaver Themer](/beaver-themer)
* [BB Theme](/bb-theme)
* [Assistant](/assistant)
Resources

* [Blog](https://www.wpbeaverbuilder.com/blog/)
* [Pricing](https://www.wpbeaverbuilder.com/pricing/)
* [Courses](https://courses.wpbeaverbuilder.com/)
* [YouTube](https://www.youtube.com/c/BeaverBuilderWP)
Community

* [Facebook](https://www.facebook.com/groups/beaverbuilders/)
* [Slack](https://beaverbuilders.slack.com/join/shared_invite/zt-p4cb3bl0-gACU3QD8r25RPlaIoh3YAA#/shared-invite/email)
* [Forums](https://community.wpbeaverbuilder.com/)
* [Discord](https://www.wpbeaverbuilder.com/discord/)
Legal

* [Privacy](https://www.wpbeaverbuilder.com/privacy-policy/)
* [Terms](https://www.wpbeaverbuilder.com/terms-and-conditions/)
[![Beaver Builder Logo](/img/bb-logo-light.png)![Beaver Builder Logo](/img/bb-logo-light.png)](https://www.wpbeaverbuilder.com/)Copyright © 2024 Beaver Builder.


