

[Skip to main content](#site-main)
[Homepage](/)

Mobile Menu

* Search Coalfire.com
* Services

  ## Back to Parent Menu Services

  [### Advisory

  Advisory services for FedRAMP, global compliance, cloud engineering, & healthcare risk](https://coalfire.com/services/advisory)

  [### Assessment

  Compliance automation platform and audit services that simplify managing multiple compliance frameworks](https://coalfire.com/services/assessment)

  [### Security

  Threat-focused cybersecurity services with hacker and defender expertise](https://coalfire.com/services/security)

  [### Federal

  CMMC advisory and assessment services from an experienced C3PAO](https://coalfirefederal.com)
* Industries

  ## Back to Parent Menu Industries

  [### Financial Services

  FinTech, payment processors, and banks decrease vulnerabilities using our services and to monitor 24/7](https://coalfire.com/industries/financial-services)

  [### Healthcare & Life Sciences

  To remain HIPAA compliant, our cybersecurity services help you protect customer data 24/7](https://coalfire.com/industries/healthcare-life-sciences)

  [### Retail

  Retailers use our compliance services to improve security, assess cardholder data, and leverage a risk-based strategy approach to protect their customers](https://coalfire.com/industries/retail)

  [### Tech & Software

  Leading SaaS and IaaS companies achieve FedRAMP and implement GRC in less time](https://coalfire.com/industries/tech-software)
* Resources

  ## Back to Parent Menu Resources

  [### Resources

  View all resources](https://coalfire.com/insights/resources)

  + By Topic
  + [Cybersecurity](/insights/resources?topic=offensive-security)
  + [Corporate](/insights/resources?topic=corporate)
  + [Cyber Risk](/insights/resources?topic=strategy-privacy-and-risk)
  + [Application security](/insights/resources?topic=application-security)
  + [Cloud](/insights/resources?topic=cloud)
  + [Compliance](/insights/resources?topic=compliance)
  + [Compliance Essentials](/insights/resources?topic=compliance-essentials)
  + [HexeonÂ®](/insights/resources?topic=hexeon)
  + [FedRAMPÂ®](/insights/resources?topic=fedramp)
  + By Type
  + [Case Studies](https://coalfire.com/insights/resources?type=case-studies)
  + [Data Sheets](https://coalfire.com/insights/resources?type=data-sheet)
  + [Video](https://coalfire.com/insights/resources?type=video)
  + [Webinars](https://coalfire.com/insights/resources?type=webinars)
  + [White Papers](https://coalfire.com/insights/resources?type=white-papers)
  + [Reports](https://coalfire.com/insights/resources?type=reports)
* About

  ## Back to Parent Menu About

  ### Company

  + [The Coalfire Story](https://coalfire.com/about/our-story)
  + [Leadership](https://coalfire.com/about/leadership)
  + [Diversity & Inclusion](https://coalfire.com/about/diversity-and-inclusion)
  + [Research & Development](https://coalfire.com/about/research-and-development)
  + [Education: Coalfire Academy](https://coalfire.com/insights/resources/coalfire-academy-education/ai-risk-1)
  + [Richard E. Dakin Fund](https://coalfire.com/about/richard-dakin-fund)
  + [Partners](https://coalfire.com/about/partners)
  + [Contact Us](https://coalfire.com/about/contact-us)
  + [Careers](https://coalfire.com/about/careers)
  ### News & Events

  + [Press Releases](https://coalfire.com/insights/news-and-events/press-releases)
  + [In the News](https://coalfire.com/insights/news-and-events/in-the-news)
  + [Coalfire Articles](https://coalfire.com/the-coalfire-blog)
  + [Events](https://coalfire.com/insights/news-and-events/events)

## Menu

* Services

  [### Advisory

  Advisory services for FedRAMP, global compliance, cloud engineering, & healthcare risk](https://coalfire.com/services/advisory)

  [### Assessment

  Compliance automation platform and audit services that simplify managing multiple compliance frameworks](https://coalfire.com/services/assessment)

  [### Security

  Threat-focused cybersecurity services with hacker and defender expertise](https://coalfire.com/services/security)

  [### Federal

  CMMC advisory and assessment services from an experienced C3PAO](https://coalfirefederal.com)
* Industries

  [### Financial Services

  FinTech, payment processors, and banks decrease vulnerabilities using our services and to monitor 24/7](https://coalfire.com/industries/financial-services)

  [### Healthcare & Life Sciences

  To remain HIPAA compliant, our cybersecurity services help you protect customer data 24/7](https://coalfire.com/industries/healthcare-life-sciences)

  [### Retail

  Retailers use our compliance services to improve security, assess cardholder data, and leverage a risk-based strategy approach to protect their customers](https://coalfire.com/industries/retail)

  [### Tech & Software

  Leading SaaS and IaaS companies achieve FedRAMP and implement GRC in less time](https://coalfire.com/industries/tech-software)
* Resources

  [### Resources

  View all resources](https://coalfire.com/insights/resources)

  + By Topic
  + [Cybersecurity](/insights/resources?topic=offensive-security)
  + [Corporate](/insights/resources?topic=corporate)
  + [Cyber Risk](/insights/resources?topic=strategy-privacy-and-risk)
  + [Application security](/insights/resources?topic=application-security)
  + [Cloud](/insights/resources?topic=cloud)
  + [Compliance](/insights/resources?topic=compliance)
  + [Compliance Essentials](/insights/resources?topic=compliance-essentials)
  + [HexeonÂ®](/insights/resources?topic=hexeon)
  + [FedRAMPÂ®](/insights/resources?topic=fedramp)
  + By Type
  + [Case Studies](https://coalfire.com/insights/resources?type=case-studies)
  + [Data Sheets](https://coalfire.com/insights/resources?type=data-sheet)
  + [Video](https://coalfire.com/insights/resources?type=video)
  + [Webinars](https://coalfire.com/insights/resources?type=webinars)
  + [White Papers](https://coalfire.com/insights/resources?type=white-papers)
  + [Reports](https://coalfire.com/insights/resources?type=reports)
* About

  ### Company

  + [The Coalfire Story](https://coalfire.com/about/our-story)
  + [Leadership](https://coalfire.com/about/leadership)
  + [Diversity & Inclusion](https://coalfire.com/about/diversity-and-inclusion)
  + [Research & Development](https://coalfire.com/about/research-and-development)
  + [Education: Coalfire Academy](https://coalfire.com/insights/resources/coalfire-academy-education/ai-risk-1)
  + [Richard E. Dakin Fund](https://coalfire.com/about/richard-dakin-fund)
  + [Partners](https://coalfire.com/about/partners)
  + [Contact Us](https://coalfire.com/about/contact-us)
  + [Careers](https://coalfire.com/about/careers)
  ### News & Events

  + [Press Releases](https://coalfire.com/insights/news-and-events/press-releases)
  + [In the News](https://coalfire.com/insights/news-and-events/in-the-news)
  + [Coalfire Articles](https://coalfire.com/the-coalfire-blog)
  + [Events](https://coalfire.com/insights/news-and-events/events)

## Menu

* Search

  Search Coalfire.com

  Close Dialog
  X
* [Customer Login](https://account.coalfire.com/dashboard)
* [Contact Us](https://coalfire.com/about/contact-us)

Cybersecurity

# Hacking Ham Radio: WinAPRS â Part 1

Coalfire Cybersecurity Team

March 29, 2022

![Blog Images 2022 Ham tile](data:image/svg+xml;utf8...)

**Key takeaways:**

* Ham radios are still used today in emergency communications during times of war and disaster
* To this day they still can be used in binary exploitation
* The vulnerabilities of older technologies can be leveraged with todayâs hacking fundamentals

Ham radios are still used to this day in emergency communications during times of warÂ and disaster, and can still be used in binary exploitation.

Hackers have been breaching computer system defenses for more than half a century, and the networks they use to exploit those weaknesses have been around for far longer than that. With the internet replacing most wirelines and wavelengths, and with the rise of cybercrime sophistication from petty thieves to organized nation-states, the threat landscape has exploded over the last 20 years. Yet one of the oldest network protocols â amateur or âhamâ radio â is still used to this day in emergency communications during times of war and disaster, and to this day can still be used in binary exploitation.

Ham radio evokes an image of old guys turning knobs on vintage, tube radios and talking to other hobbyists about their configurations. Nowadays, radios are getting much more complicated, and with the built-in ability to perform digital communications, the possibilities are almost limitless. You can hook them up to computers to do anything from text messaging and email to sharing images and tracking weather balloons. Thereâs still something magical about connecting to a device or contacting someone across the planet without being hooked up to the internet or a phone line.

I recently passed the [Offensive Security Exploit Developer](https://www.offensive-security.com/exp301-osed/) (OSED) exam and wanted to apply what Iâd learned to real-world security problems. Iâm always looking for ways to improve my threat modeling, attack simulation, and penetration testing skills, and thought that ham radio would be a fun environment to explore. Amateur radio equipment and frequency spectrums are accessible all over the world and are instructive for a blog series that shows how the vulnerabilities of older technologies can be leveraged with todayâs hacking fundamentals. With ham radio as our testing and proving ground, weâll look at reverse engineering, the creation of custom exploits, and developing skills to bypass security mitigations. Weâll also take a look at writing handmade Windows shellcode and adopting older techniques to more modern versions of Windows.

## Packet Radio

I've been messing around with packet radio and various digital modes on and off for years and have wondered if any vulnerabilities exist that could allow an attacker to obtain remote code execution through the airwaves. I always thought it was a fun idea to be able to hack a computer that isn't even hooked up to the internet. Many ham programs are written by enthusiasts and are quite old, so it seemed likely that there would be exploitable vulnerabilities. In my research I decided to focus mainly on vulnerabilities that could lead to remote code or command execution, though if I found other vulnerabilities, I didn't ignore them. I also decided to start by focusing on Windows software, since the OSED exam focused on Windows user-mode exploitation and it's where I have the most experience. I started this project with a specific goal in mind: get a remote shell over ham radio.

As a hacker, I am most interested in the various digital modes that ham radio has to offer. There are many, and for my research I decided to focus on software that uses the AX.25 protocol.

"Packet radio" generally refers to a very specific digital mode of operation that uses the AX.25 protocol. AX.25 is a data-link layer protocol (layer 2 of the OSI model). In this mode, data is split into packets and transmitted over the air. AX.25 has support for different packet types and includes modes that are similar to Transmission Control Protocol (TCP) and User Datagram Protocol (UDP) on Ethernet. In some cases, the protocol can do some error correcting, like TCP. Another mode will just send packets out into the air without waiting for any kind of acknowledgement, like UDP. Windows does not have any built-in way to handle AX.25 traffic, so end-user software would have to do this on its own or it must be abstracted away. The Linux kernel has built-in support for AX.25, so you can potentially set up AX.25 network interfaces that have callsigns for addresses instead of IP addresses.

AX.25 is commonly used today for Automatic Packet Reporting System (APRS), Winlink email over ham radio, Bulletin Board Systems (BBS) operations, and more. It seems it is more generally used for a ham to make a contact with a computer, as opposed to making live contacts with other hams. More information about the AX.25 protocol can be found here: <http://www.ax25.net/AX25.2.2-Jul%2098-2.pdf>

## Automatic Packet Reporting System (APRS)

The most common use of AX.25 is with the Automatic Packet Reporting System (APRS). Therefore, I decided to focus first on APRS software for this research project. APRS allows hams to transmit telemetry data such as GPS coordinates, weather data, small generic messages, and more. An APRS station can send out a broadcast message, or it can send a message addressed to another specific station. Since the range on the 2m band isnât that great, APRS stations can âdigipeatâ the packets out again. This means that if one station receives a packet, it will retransmit it to send it further away. There are also âIGateâ systems which are bridged to the internet via the APRS Internet Service (APRS-IS) backbone (<http://www.aprs-is.net>). This adds extra usability to the APRS system and means you can transmit data globally using the internet if desired. In fact, you can view APRS traffic anywhere in the world at <https://aprs.fi> and you donât even need a license to check it out.

![](https://assets.coalfire.com/prod/images/imported/Blog-Images-2022-Ham-1.jpg)

How do APRS stations find each other? How does one station find an IGate to bridge to the internet? You can transmit APRS on basically any amateur frequency for which you are licensed, but around the globe each region generally has an allotted frequency where this traffic is used. In the US, that frequency is 144.390 MHz. Just about anywhere in the country you can tune a radio to this frequency and hear data being transmitted at least every minute or so.

APRS is a protocol that runs on top of AX.25, like how HTTP runs on top of TCP. APRS packets make use of the AX.25 unnumbered information (UI) frames. Since I was going to be reverse engineering APRS software, it made sense to examine APRS data frames to understand their structure. AX.25 UI frames look like this:

![](https://assets.coalfire.com/prod/images/imported/Blog-Images-2022-Ham-2.jpg)
**Image** [**source**](http://www.aprs.org/doc/APRS101.PDF)

In an AX.25 UI frame, all addresses will be ham radio callsigns with an optional SSID appended to them. If your callsign was K7HAX, your address could be something like K7HAX-14. The digipeater addresses field can contain up to eight digipeater addresses to specify the path the packet should take. A digipeater is a radio station that listens for packets and then retransmits those packets to extend the range. The information field contains user-specified data. APRS makes heavy use of this field and itâs likely to be the most interesting field to play with.

The APRS specification allows for various data types, formats, and encodings. Most of this information is stored in the information field of the AX.25 packet. A generic APRS information field structure looks like this:

![](https://assets.coalfire.com/prod/images/imported/Blog-Images-2022-Ham-3.jpg)
**Image** [**source**](http://www.aprs.org/doc/APRS101.PDF)

The data type specifies what kind of APRS data follows. Options include GPS position, direction finding, weather information, messages, and more. Hereâs a real APRS message I pulled from [here](https://aprs.fi).

:Are you working tonight?

The colon denotes that the APRS data contains a message. The rest of the data is just the plaintext message. In this case the APRS data extension and comment fields are unused. Hereâs another example:

=3319.44S/06012.46W#Â 144.930MHz.Â SNDigi

The equal sign denotes that the data contains position data without a timestamp. Immediately following that is the actual position data. Between the two coordinates is a forward slash and immediately following the data is a hash symbol. Combined, these symbols would make â/#â. This data tells the receiving station what type of station sent the message and what symbol or icon to use to display the station on a map.

APRS has two tables full of different symbols (car, truck, bicycle, balloon, etc.). The forward slash specifies which table to use. The hash tells which symbol to use in that table. After the hash symbol is some additional message data which appears to list the transmitting frequency and probably the software or device used to transmit (SNDigi). Thereâs so much more to APRS than just this but it gives a rough idea of how the packets look and what we can expect APRS software to be doing when decoding messages. More information about the APRS protocol can be found [here](http://www.aprs.org/doc/APRS101.PDF).

Since APRS is probably the most common packet protocol in use today, and there is no shortage of APRS software to choose from, I decided to start my research here. I focused on Windows-based APRS software that was written in C or C++ so I could continue honing my IDA and WinDbg reversing skills.

## Hardware for Packet Radio

There is a huge number of combinations of hardware to get on the air with packet, but in general youâll need three main components: a transceiver, a terminal node controller (TNC), and a computer. You use the computer to interact with the various packet radio software you want to use. The transceiver sends and receives the communications over the radio. The TNC is basically a packet radio modem that sits between the two, converting the data into sound. It works similarly to a dial-up modem, but for radio instead of telephone lines. A TNC is typically a little box thatâs hooked up to the computer and the radio. A TNC will often have a built-in microcomputer with its own operating system so you can open a terminal and send and receive messages right from the TNC. My TNC has a built-in mailbox where other hams can leave messages. It can decode APRS messages with its own software and display them in a human-readable format via serial console. Hereâs a photo of the hardware Iâm using for my receiving station:

###

## Keep It Simple, Stupid! (KISS)

Each TNC make and model has its own set of commands you must use to send packets, and they may display packets differently to the user. The computer software must therefore understand how to interface with each make and model, which is cumbersome. To remedy this, most TNCs support a mode called KISS (Keep It Simple, Stupid). This mode disables all the âsmartâ features of the TNC and turns it into a dumb modem. The TNC will simply demodulate the signals from the radio and transmit the raw data back to your PC and vice versa. To simplify things, Iâll be placing my TNC into KISS mode for testing and using it wherever possible.

The important bit to know about the KISS protocol is that the TNC will add a 0xC0 control character to the beginning and end of each packet, and it will expect those characters to be there for any outgoing transmissions. There are also a few other special control characters the TNC will watch for, which is important to be aware of when writing shellcode later. These characters would be considered âbad charactersâ when writing shellcode and must be avoided. A full description of the KISS protocol can be found [here](http://www.ax25.net/kiss.aspx).

## Choosing an APRS Program

The [aprs-is.net](http://www.aprs-is.net/) website has a list of some known APRS client software.

![](https://assets.coalfire.com/prod/images/imported/Blog-Images-2022-Ham-5b.jpg)

Looking over the list, I figured an older client would be the most likely to contain exploitable memory corruption vulnerabilities. Looking at the various options, I found that the WinAPRS download page said it hadn't been updated since January 14, 2013. I figured that was a good sign that the software was likely not maintained and would therefore contain vulnerabilities. I downloaded the latest version (2.9.0) and got to work.

## Next Steps

The next post in this series will discuss the reverse engineering process using WinDbg. Weâll dive into the nitty gritty technical details of an exploitable memory corruption vulnerability in WinAPRS including how it was found and why itâs exploitable.

### Related Articles

* [Hacking Ham Radio: WinAPRS â Part 2](https://coalfire.com/the-coalfire-blog/hacking-ham-radio-winaprs-part-2)
* [Hacking Ham Radio: WinAPRS â Part 3](https://coalfire.com/the-coalfire-blog/hacking-ham-radio-winaprs-part-3)
* [Hacking Ham Radio: WinAPRS â Part 4](https://coalfire.com/the-coalfire-blog/hacking-ham-radio-winaprs-part-4)

### Related Resources

* Managed services for attack surface management
* [Penetration Risk Report](https://coalfire.com/insights/resources/reports/penetration-risk-report)

### Related Solutions

* [Cybersecurity](https://coalfire.com/the-coalfire-blog?category=offensive-security)
* [Application security](https://coalfire.com/the-coalfire-blog?category=application-security)

### Share this story

* Facebook
* X / Twitter
* Instagram
* LinkedIn

[Homepage](/)

* [Privacy Policy](https://coalfire.com/privacy)
* [Cookie Policy](https://coalfire.com/cookies)
* [Accessibility](https://coalfire.com/agreements/accessibility-statement)
* [Legal](https://coalfire.com/legal)
* [Terms of Use](https://coalfire.com/coalfire-website-terms-of-use)
* [Contact](https://coalfire.com/about/contact-us)

Copyright Â© 2024 Coalfire Systems, Inc. All rights reserved. Coalfire, the Coalfire Logo, CoalfireOne, the Coalfire|Talks Logo, the Hexagon Logo, Hexeon, Neuralys, RAMP/pak, RAMP/pak+, RAMPcon, the RAMPcon Logo, and ThreadFix are trademarks or registered trademarks of Coalfire Systems, Inc. or its affiliates in the United States and other countries. Other names may be trademarks of their respective owners.

* [Facebook](https://www.facebook.com/coalfiresys/)
* [X Twitter](https://twitter.com/coalfire)
* [Linkedin](https://www.linkedin.com/company/coalfire-systems-inc-/)
* [YouTube](https://www.youtube.com/channel/UC94x12L8MJJP70afk6FRrOg)

