<!DOCTYPE html>
<html lang='en'>
<head>
<title>x86/coco: Require seeding RNG with RDRAND on CoCo systems - kernel/git/stable/linux.git - Linux kernel stable tree</title>
<meta name='generator' content='cgit 1.2.3-korg'/>
<meta name='robots' content='noindex, nofollow'/>
<link rel='stylesheet' type='text/css' href='/cgit-data/cgit.css'/>
<script type='text/javascript' src='/cgit-data/cgit.js'></script>
<link rel='shortcut icon' href='/favicon.ico'/>
<link rel='alternate' title='Atom feed' href='https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/atom/?h=master' type='application/atom+xml'/>
<link rel='vcs-git' href='git://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git' title='kernel/git/stable/linux.git Git repository'/>
<link rel='vcs-git' href='https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git' title='kernel/git/stable/linux.git Git repository'/>
<link rel='vcs-git' href='https://kernel.googlesource.com/pub/scm/linux/kernel/git/stable/linux.git' title='kernel/git/stable/linux.git Git repository'/>
</head>
<body>
<div id='cgit'><table id='header'>
<tr>
<td class='logo' rowspan='2'><a href='/'><img src='/cgit-data/cgit.png' alt='cgit logo'/></a></td>
<td class='main'><a href='/'>index</a> : <a href='/pub/scm/linux/kernel/git/stable/linux.git/'>kernel/git/stable/linux.git</a></td><td class='form'><form method='get'>
<input type='hidden' name='id' value='22943e4fe4b3a2dcbadc3d38d5bf840bbdbfe374'/><select name='h' onchange='this.form.submit();'>
<option value='linux-2.6.11.y'>linux-2.6.11.y</option>
<option value='linux-2.6.12.y'>linux-2.6.12.y</option>
<option value='linux-2.6.13.y'>linux-2.6.13.y</option>
<option value='linux-2.6.14.y'>linux-2.6.14.y</option>
<option value='linux-2.6.15.y'>linux-2.6.15.y</option>
<option value='linux-2.6.16.y'>linux-2.6.16.y</option>
<option value='linux-2.6.17.y'>linux-2.6.17.y</option>
<option value='linux-2.6.18.y'>linux-2.6.18.y</option>
<option value='linux-2.6.19.y'>linux-2.6.19.y</option>
<option value='linux-2.6.20.y'>linux-2.6.20.y</option>
<option value='linux-2.6.21.y'>linux-2.6.21.y</option>
<option value='linux-2.6.22.y'>linux-2.6.22.y</option>
<option value='linux-2.6.23.y'>linux-2.6.23.y</option>
<option value='linux-2.6.24.y'>linux-2.6.24.y</option>
<option value='linux-2.6.25.y'>linux-2.6.25.y</option>
<option value='linux-2.6.26.y'>linux-2.6.26.y</option>
<option value='linux-2.6.27.y'>linux-2.6.27.y</option>
<option value='linux-2.6.28.y'>linux-2.6.28.y</option>
<option value='linux-2.6.29.y'>linux-2.6.29.y</option>
<option value='linux-2.6.30.y'>linux-2.6.30.y</option>
<option value='linux-2.6.31.y'>linux-2.6.31.y</option>
<option value='linux-2.6.32.y'>linux-2.6.32.y</option>
<option value='linux-2.6.33.y'>linux-2.6.33.y</option>
<option value='linux-2.6.34.y'>linux-2.6.34.y</option>
<option value='linux-2.6.35.y'>linux-2.6.35.y</option>
<option value='linux-2.6.36.y'>linux-2.6.36.y</option>
<option value='linux-2.6.37.y'>linux-2.6.37.y</option>
<option value='linux-2.6.38.y'>linux-2.6.38.y</option>
<option value='linux-2.6.39.y'>linux-2.6.39.y</option>
<option value='linux-3.0.y'>linux-3.0.y</option>
<option value='linux-3.1.y'>linux-3.1.y</option>
<option value='linux-3.10.y'>linux-3.10.y</option>
<option value='linux-3.11.y'>linux-3.11.y</option>
<option value='linux-3.12.y'>linux-3.12.y</option>
<option value='linux-3.13.y'>linux-3.13.y</option>
<option value='linux-3.14.y'>linux-3.14.y</option>
<option value='linux-3.15.y'>linux-3.15.y</option>
<option value='linux-3.16.y'>linux-3.16.y</option>
<option value='linux-3.17.y'>linux-3.17.y</option>
<option value='linux-3.18.y'>linux-3.18.y</option>
<option value='linux-3.19.y'>linux-3.19.y</option>
<option value='linux-3.2.y'>linux-3.2.y</option>
<option value='linux-3.3.y'>linux-3.3.y</option>
<option value='linux-3.4.y'>linux-3.4.y</option>
<option value='linux-3.5.y'>linux-3.5.y</option>
<option value='linux-3.6.y'>linux-3.6.y</option>
<option value='linux-3.7.y'>linux-3.7.y</option>
<option value='linux-3.8.y'>linux-3.8.y</option>
<option value='linux-3.9.y'>linux-3.9.y</option>
<option value='linux-4.0.y'>linux-4.0.y</option>
<option value='linux-4.1.y'>linux-4.1.y</option>
<option value='linux-4.10.y'>linux-4.10.y</option>
<option value='linux-4.11.y'>linux-4.11.y</option>
<option value='linux-4.12.y'>linux-4.12.y</option>
<option value='linux-4.13.y'>linux-4.13.y</option>
<option value='linux-4.14.y'>linux-4.14.y</option>
<option value='linux-4.15.y'>linux-4.15.y</option>
<option value='linux-4.16.y'>linux-4.16.y</option>
<option value='linux-4.17.y'>linux-4.17.y</option>
<option value='linux-4.18.y'>linux-4.18.y</option>
<option value='linux-4.19.y'>linux-4.19.y</option>
<option value='linux-4.2.y'>linux-4.2.y</option>
<option value='linux-4.20.y'>linux-4.20.y</option>
<option value='linux-4.3.y'>linux-4.3.y</option>
<option value='linux-4.4.y'>linux-4.4.y</option>
<option value='linux-4.5.y'>linux-4.5.y</option>
<option value='linux-4.6.y'>linux-4.6.y</option>
<option value='linux-4.7.y'>linux-4.7.y</option>
<option value='linux-4.8.y'>linux-4.8.y</option>
<option value='linux-4.9.y'>linux-4.9.y</option>
<option value='linux-5.0.y'>linux-5.0.y</option>
<option value='linux-5.1.y'>linux-5.1.y</option>
<option value='linux-5.10.y'>linux-5.10.y</option>
<option value='linux-5.11.y'>linux-5.11.y</option>
<option value='linux-5.12.y'>linux-5.12.y</option>
<option value='linux-5.13.y'>linux-5.13.y</option>
<option value='linux-5.14.y'>linux-5.14.y</option>
<option value='linux-5.15.y'>linux-5.15.y</option>
<option value='linux-5.16.y'>linux-5.16.y</option>
<option value='linux-5.17.y'>linux-5.17.y</option>
<option value='linux-5.18.y'>linux-5.18.y</option>
<option value='linux-5.19.y'>linux-5.19.y</option>
<option value='linux-5.2.y'>linux-5.2.y</option>
<option value='linux-5.3.y'>linux-5.3.y</option>
<option value='linux-5.4.y'>linux-5.4.y</option>
<option value='linux-5.5.y'>linux-5.5.y</option>
<option value='linux-5.6.y'>linux-5.6.y</option>
<option value='linux-5.7.y'>linux-5.7.y</option>
<option value='linux-5.8.y'>linux-5.8.y</option>
<option value='linux-5.9.y'>linux-5.9.y</option>
<option value='linux-6.0.y'>linux-6.0.y</option>
<option value='linux-6.1.y'>linux-6.1.y</option>
<option value='linux-6.10.y'>linux-6.10.y</option>
<option value='linux-6.11.y'>linux-6.11.y</option>
<option value='linux-6.12.y'>linux-6.12.y</option>
<option value='linux-6.2.y'>linux-6.2.y</option>
<option value='linux-6.3.y'>linux-6.3.y</option>
<option value='linux-6.4.y'>linux-6.4.y</option>
<option value='linux-6.5.y'>linux-6.5.y</option>
<option value='linux-6.6.y'>linux-6.6.y</option>
<option value='linux-6.7.y'>linux-6.7.y</option>
<option value='linux-6.8.y'>linux-6.8.y</option>
<option value='linux-6.9.y'>linux-6.9.y</option>
<option value='linux-rolling-lts'>linux-rolling-lts</option>
<option value='linux-rolling-stable'>linux-rolling-stable</option>
<option value='master' selected='selected'>master</option>
</select> <input type='submit' value='switch'/></form></td></tr>
<tr><td class='sub'>Linux kernel stable tree</td><td class='sub right'>Stable Group</td></tr></table>
<table class='tabs'><tr><td>
<a href='/pub/scm/linux/kernel/git/stable/linux.git/about/'>about</a><a href='/pub/scm/linux/kernel/git/stable/linux.git/'>summary</a><a href='/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=22943e4fe4b3a2dcbadc3d38d5bf840bbdbfe374'>refs</a><a href='/pub/scm/linux/kernel/git/stable/linux.git/log/'>log</a><a href='/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=22943e4fe4b3a2dcbadc3d38d5bf840bbdbfe374'>tree</a><a class='active' href='/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=22943e4fe4b3a2dcbadc3d38d5bf840bbdbfe374'>commit</a><a href='/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=22943e4fe4b3a2dcbadc3d38d5bf840bbdbfe374'>diff</a><a href='/pub/scm/linux/kernel/git/stable/linux.git/stats/'>stats</a></td><td class='form'><form class='right' method='get' action='/pub/scm/linux/kernel/git/stable/linux.git/log/'>
<input type='hidden' name='id' value='22943e4fe4b3a2dcbadc3d38d5bf840bbdbfe374'/><select name='qt'>
<option value='grep'>log msg</option>
<option value='author'>author</option>
<option value='committer'>committer</option>
<option value='range'>range</option>
</select>
<input class='txt' type='search' size='10' name='q' value=''/>
<input type='submit' value='search'/>
</form>
</td></tr></table>
<div class='content'><div class='cgit-panel'><b>diff options</b><form method='get'><input type='hidden' name='id' value='22943e4fe4b3a2dcbadc3d38d5bf840bbdbfe374'/><table><tr><td colspan='2'/></tr><tr><td class='label'>context:</td><td class='ctrl'><select name='context' onchange='this.form.submit();'><option value='1'>1</option><option value='2'>2</option><option value='3' selected='selected'>3</option><option value='4'>4</option><option value='5'>5</option><option value='6'>6</option><option value='7'>7</option><option value='8'>8</option><option value='9'>9</option><option value='10'>10</option><option value='15'>15</option><option value='20'>20</option><option value='25'>25</option><option value='30'>30</option><option value='35'>35</option><option value='40'>40</option></select></td></tr><tr><td class='label'>space:</td><td class='ctrl'><select name='ignorews' onchange='this.form.submit();'><option value='0' selected='selected'>include</option><option value='1'>ignore</option></select></td></tr><tr><td class='label'>mode:</td><td class='ctrl'><select name='dt' onchange='this.form.submit();'><option value='0' selected='selected'>unified</option><option value='1'>ssdiff</option><option value='2'>stat only</option></select></td></tr><tr><td/><td class='ctrl'><noscript><input type='submit' value='reload'/></noscript></td></tr></table></form></div><table summary='commit info' class='commit-info'>
<tr><th>author</th><td>Jason A. Donenfeld &lt;Jason@zx2c4.com&gt;</td><td class='right'>2024-03-26 17:07:35 +0100</td></tr>
<tr><th>committer</th><td>Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;</td><td class='right'>2024-04-10 16:28:33 +0200</td></tr>
<tr><th>commit</th><td colspan='2' class='oid'><a href='/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=22943e4fe4b3a2dcbadc3d38d5bf840bbdbfe374'>22943e4fe4b3a2dcbadc3d38d5bf840bbdbfe374</a> (<a href='/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=22943e4fe4b3a2dcbadc3d38d5bf840bbdbfe374'>patch</a>)</td></tr>
<tr><th>tree</th><td colspan='2' class='oid'><a href='/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=22943e4fe4b3a2dcbadc3d38d5bf840bbdbfe374'>a8c0e450726189164d3574c320fb865edf1cf7b3</a></td></tr>
<tr><th>parent</th><td colspan='2' class='oid'><a href='/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=20a915154ccb88da08986ab6c9fc4c1cf6259de2'>20a915154ccb88da08986ab6c9fc4c1cf6259de2</a> (<a href='/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=22943e4fe4b3a2dcbadc3d38d5bf840bbdbfe374&amp;id2=20a915154ccb88da08986ab6c9fc4c1cf6259de2'>diff</a>)</td></tr><tr><th>download</th><td colspan='2' class='oid'><a href='/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-22943e4fe4b3a2dcbadc3d38d5bf840bbdbfe374.tar.gz'>linux-22943e4fe4b3a2dcbadc3d38d5bf840bbdbfe374.tar.gz</a><br/></td></tr></table>
<div class='commit-subject'>x86/coco: Require seeding RNG with RDRAND on CoCo systems</div><div class='commit-msg'>commit 99485c4c026f024e7cb82da84c7951dbe3deb584 upstream.

There are few uses of CoCo that don't rely on working cryptography and
hence a working RNG. Unfortunately, the CoCo threat model means that the
VM host cannot be trusted and may actively work against guests to
extract secrets or manipulate computation. Since a malicious host can
modify or observe nearly all inputs to guests, the only remaining source
of entropy for CoCo guests is RDRAND.

If RDRAND is broken -- due to CPU hardware fault -- the RNG as a whole
is meant to gracefully continue on gathering entropy from other sources,
but since there aren't other sources on CoCo, this is catastrophic.
This is mostly a concern at boot time when initially seeding the RNG, as
after that the consequences of a broken RDRAND are much more
theoretical.

So, try at boot to seed the RNG using 256 bits of RDRAND output. If this
fails, panic(). This will also trigger if the system is booted without
RDRAND, as RDRAND is essential for a safe CoCo boot.

Add this deliberately to be "just a CoCo x86 driver feature" and not
part of the RNG itself. Many device drivers and platforms have some
desire to contribute something to the RNG, and add_device_randomness()
is specifically meant for this purpose.

Any driver can call it with seed data of any quality, or even garbage
quality, and it can only possibly make the quality of the RNG better or
have no effect, but can never make it worse.

Rather than trying to build something into the core of the RNG, consider
the particular CoCo issue just a CoCo issue, and therefore separate it
all out into driver (well, arch/platform) code.

  [ bp: Massage commit message. ]

Signed-off-by: Jason A. Donenfeld &lt;Jason@zx2c4.com&gt;
Signed-off-by: Borislav Petkov (AMD) &lt;bp@alien8.de&gt;
Reviewed-by: Elena Reshetova &lt;elena.reshetova@intel.com&gt;
Reviewed-by: Kirill A. Shutemov &lt;kirill.shutemov@linux.intel.com&gt;
Reviewed-by: Theodore Ts'o &lt;tytso@mit.edu&gt;
Cc: stable@vger.kernel.org
Link: <a href="https://lore.kernel.org/r/20240326160735.73531-1-Jason@zx2c4.com">https://lore.kernel.org/r/20240326160735.73531-1-Jason@zx2c4.com</a>
Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;
</div><div class='diffstat-header'><a href='/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=22943e4fe4b3a2dcbadc3d38d5bf840bbdbfe374'>Diffstat</a></div><table summary='diffstat' class='diffstat'><tr><td class='mode'>-rw-r--r--</td><td class='upd'><a href='/pub/scm/linux/kernel/git/stable/linux.git/diff/arch/x86/coco/core.c?id=22943e4fe4b3a2dcbadc3d38d5bf840bbdbfe374'>arch/x86/coco/core.c</a></td><td class='right'>41</td><td class='graph'><table summary='file diffstat' width='41%'><tr><td class='add' style='width: 100.0%;'/><td class='rem' style='width: 0.0%;'/><td class='none' style='width: 0.0%;'/></tr></table></td></tr>
<tr><td class='mode'>-rw-r--r--</td><td class='upd'><a href='/pub/scm/linux/kernel/git/stable/linux.git/diff/arch/x86/include/asm/coco.h?id=22943e4fe4b3a2dcbadc3d38d5bf840bbdbfe374'>arch/x86/include/asm/coco.h</a></td><td class='right'>2</td><td class='graph'><table summary='file diffstat' width='41%'><tr><td class='add' style='width: 4.9%;'/><td class='rem' style='width: 0.0%;'/><td class='none' style='width: 95.1%;'/></tr></table></td></tr>
<tr><td class='mode'>-rw-r--r--</td><td class='upd'><a href='/pub/scm/linux/kernel/git/stable/linux.git/diff/arch/x86/kernel/setup.c?id=22943e4fe4b3a2dcbadc3d38d5bf840bbdbfe374'>arch/x86/kernel/setup.c</a></td><td class='right'>2</td><td class='graph'><table summary='file diffstat' width='41%'><tr><td class='add' style='width: 4.9%;'/><td class='rem' style='width: 0.0%;'/><td class='none' style='width: 95.1%;'/></tr></table></td></tr>
</table><div class='diffstat-summary'>3 files changed, 45 insertions, 0 deletions</div><table summary='diff' class='diff'><tr><td><div class='head'>diff --git a/arch/x86/coco/core.c b/arch/x86/coco/core.c<br/>index 1d3ad275c36643..801e943fd2b29d 100644<br/>--- a/<a href='/pub/scm/linux/kernel/git/stable/linux.git/tree/arch/x86/coco/core.c?id=20a915154ccb88da08986ab6c9fc4c1cf6259de2'>arch/x86/coco/core.c</a><br/>+++ b/<a href='/pub/scm/linux/kernel/git/stable/linux.git/tree/arch/x86/coco/core.c?id=22943e4fe4b3a2dcbadc3d38d5bf840bbdbfe374'>arch/x86/coco/core.c</a></div><div class='hunk'>@@ -3,13 +3,17 @@</div><div class='ctx'>  * Confidential Computing Platform Capability checks</div><div class='ctx'>  *</div><div class='ctx'>  * Copyright (C) 2021 Advanced Micro Devices, Inc.</div><div class='add'>+ * Copyright (C) 2024 Jason A. Donenfeld &lt;Jason@zx2c4.com&gt;. All Rights Reserved.</div><div class='ctx'>  *</div><div class='ctx'>  * Author: Tom Lendacky &lt;thomas.lendacky@amd.com&gt;</div><div class='ctx'>  */</div><div class='ctx'> </div><div class='ctx'> #include &lt;linux/export.h&gt;</div><div class='ctx'> #include &lt;linux/cc_platform.h&gt;</div><div class='add'>+#include &lt;linux/string.h&gt;</div><div class='add'>+#include &lt;linux/random.h&gt;</div><div class='ctx'> </div><div class='add'>+#include &lt;asm/archrandom.h&gt;</div><div class='ctx'> #include &lt;asm/coco.h&gt;</div><div class='ctx'> #include &lt;asm/processor.h&gt;</div><div class='ctx'> </div><div class='hunk'>@@ -128,3 +132,40 @@ u64 cc_mkdec(u64 val)</div><div class='ctx'> 	}</div><div class='ctx'> }</div><div class='ctx'> EXPORT_SYMBOL_GPL(cc_mkdec);</div><div class='add'>+</div><div class='add'>+__init void cc_random_init(void)</div><div class='add'>+{</div><div class='add'>+	/*</div><div class='add'>+	 * The seed is 32 bytes (in units of longs), which is 256 bits, which</div><div class='add'>+	 * is the security level that the RNG is targeting.</div><div class='add'>+	 */</div><div class='add'>+	unsigned long rng_seed[32 / sizeof(long)];</div><div class='add'>+	size_t i, longs;</div><div class='add'>+</div><div class='add'>+	if (!cc_platform_has(CC_ATTR_GUEST_MEM_ENCRYPT))</div><div class='add'>+		return;</div><div class='add'>+</div><div class='add'>+	/*</div><div class='add'>+	 * Since the CoCo threat model includes the host, the only reliable</div><div class='add'>+	 * source of entropy that can be neither observed nor manipulated is</div><div class='add'>+	 * RDRAND. Usually, RDRAND failure is considered tolerable, but since</div><div class='add'>+	 * CoCo guests have no other unobservable source of entropy, it's</div><div class='add'>+	 * important to at least ensure the RNG gets some initial random seeds.</div><div class='add'>+	 */</div><div class='add'>+	for (i = 0; i &lt; ARRAY_SIZE(rng_seed); i += longs) {</div><div class='add'>+		longs = arch_get_random_longs(&amp;rng_seed[i], ARRAY_SIZE(rng_seed) - i);</div><div class='add'>+</div><div class='add'>+		/*</div><div class='add'>+		 * A zero return value means that the guest doesn't have RDRAND</div><div class='add'>+		 * or the CPU is physically broken, and in both cases that</div><div class='add'>+		 * means most crypto inside of the CoCo instance will be</div><div class='add'>+		 * broken, defeating the purpose of CoCo in the first place. So</div><div class='add'>+		 * just panic here because it's absolutely unsafe to continue</div><div class='add'>+		 * executing.</div><div class='add'>+		 */</div><div class='add'>+		if (longs == 0)</div><div class='add'>+			panic("RDRAND is defective.");</div><div class='add'>+	}</div><div class='add'>+	add_device_randomness(rng_seed, sizeof(rng_seed));</div><div class='add'>+	memzero_explicit(rng_seed, sizeof(rng_seed));</div><div class='add'>+}</div><div class='head'>diff --git a/arch/x86/include/asm/coco.h b/arch/x86/include/asm/coco.h<br/>index 60bb26097da1a2..1f97d00ad85885 100644<br/>--- a/<a href='/pub/scm/linux/kernel/git/stable/linux.git/tree/arch/x86/include/asm/coco.h?id=20a915154ccb88da08986ab6c9fc4c1cf6259de2'>arch/x86/include/asm/coco.h</a><br/>+++ b/<a href='/pub/scm/linux/kernel/git/stable/linux.git/tree/arch/x86/include/asm/coco.h?id=22943e4fe4b3a2dcbadc3d38d5bf840bbdbfe374'>arch/x86/include/asm/coco.h</a></div><div class='hunk'>@@ -23,6 +23,7 @@ static inline void cc_set_mask(u64 mask)</div><div class='ctx'> </div><div class='ctx'> u64 cc_mkenc(u64 val);</div><div class='ctx'> u64 cc_mkdec(u64 val);</div><div class='add'>+void cc_random_init(void);</div><div class='ctx'> #else</div><div class='ctx'> static inline u64 cc_mkenc(u64 val)</div><div class='ctx'> {</div><div class='hunk'>@@ -33,6 +34,7 @@ static inline u64 cc_mkdec(u64 val)</div><div class='ctx'> {</div><div class='ctx'> 	return val;</div><div class='ctx'> }</div><div class='add'>+static inline void cc_random_init(void) { }</div><div class='ctx'> #endif</div><div class='ctx'> </div><div class='ctx'> #endif /* _ASM_X86_COCO_H */</div><div class='head'>diff --git a/arch/x86/kernel/setup.c b/arch/x86/kernel/setup.c<br/>index d1ffac9ad611da..18a034613d94d6 100644<br/>--- a/<a href='/pub/scm/linux/kernel/git/stable/linux.git/tree/arch/x86/kernel/setup.c?id=20a915154ccb88da08986ab6c9fc4c1cf6259de2'>arch/x86/kernel/setup.c</a><br/>+++ b/<a href='/pub/scm/linux/kernel/git/stable/linux.git/tree/arch/x86/kernel/setup.c?id=22943e4fe4b3a2dcbadc3d38d5bf840bbdbfe374'>arch/x86/kernel/setup.c</a></div><div class='hunk'>@@ -33,6 +33,7 @@</div><div class='ctx'> #include &lt;asm/numa.h&gt;</div><div class='ctx'> #include &lt;asm/bios_ebda.h&gt;</div><div class='ctx'> #include &lt;asm/bugs.h&gt;</div><div class='add'>+#include &lt;asm/coco.h&gt;</div><div class='ctx'> #include &lt;asm/cpu.h&gt;</div><div class='ctx'> #include &lt;asm/efi.h&gt;</div><div class='ctx'> #include &lt;asm/gart.h&gt;</div><div class='hunk'>@@ -1132,6 +1133,7 @@ void __init setup_arch(char **cmdline_p)</div><div class='ctx'> 	 * memory size.</div><div class='ctx'> 	 */</div><div class='ctx'> 	sev_setup_arch();</div><div class='add'>+	cc_random_init();</div><div class='ctx'> </div><div class='ctx'> 	efi_fake_memmap();</div><div class='ctx'> 	efi_find_mirror();</div></td></tr></table></div> <!-- class=content -->
<div class='footer'>generated by <a href='https://git.zx2c4.com/cgit/about/'>cgit 1.2.3-korg</a> (<a href='https://git-scm.com/'>git 2.43.0</a>) at 2025-01-10 12:28:05 +0000</div>
</div> <!-- id=cgit -->
</body>
</html>
