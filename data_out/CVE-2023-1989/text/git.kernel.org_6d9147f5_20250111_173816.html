

| [cgit logo](/) | [index](/) : [kernel/git/bluetooth/bluetooth-next.git](/pub/scm/linux/kernel/git/bluetooth/bluetooth-next.git/) | bluetooth-next for-upstream master |
| --- | --- | --- |
| Bluetooth kernel development tree | Bluetooth group |

| [about](/pub/scm/linux/kernel/git/bluetooth/bluetooth-next.git/about/)[summary](/pub/scm/linux/kernel/git/bluetooth/bluetooth-next.git/)[refs](/pub/scm/linux/kernel/git/bluetooth/bluetooth-next.git/refs/?id=f132c2d13088)[log](/pub/scm/linux/kernel/git/bluetooth/bluetooth-next.git/log/)[tree](/pub/scm/linux/kernel/git/bluetooth/bluetooth-next.git/tree/?id=f132c2d13088)[commit](/pub/scm/linux/kernel/git/bluetooth/bluetooth-next.git/commit/?id=f132c2d13088)[diff](/pub/scm/linux/kernel/git/bluetooth/bluetooth-next.git/diff/?id=f132c2d13088)[stats](/pub/scm/linux/kernel/git/bluetooth/bluetooth-next.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Zheng Wang <zyytlz.wz@163.com> | 2023-03-09 16:07:39 +0800 |
| --- | --- | --- |
| committer | Luiz Augusto von Dentz <luiz.von.dentz@intel.com> | 2023-03-14 16:01:41 -0700 |
| commit | [f132c2d1308895b0a10e0f0c5f9f25e680777913](/pub/scm/linux/kernel/git/bluetooth/bluetooth-next.git/commit/?id=f132c2d1308895b0a10e0f0c5f9f25e680777913) ([patch](/pub/scm/linux/kernel/git/bluetooth/bluetooth-next.git/patch/?id=f132c2d1308895b0a10e0f0c5f9f25e680777913)) | |
| tree | [7f1273a5eee919b697036cc5757df1b5c4a3110f](/pub/scm/linux/kernel/git/bluetooth/bluetooth-next.git/tree/?id=f132c2d13088) | |
| parent | [b8e482d02513a9e6cd5208dfe615fb69727e9d82](/pub/scm/linux/kernel/git/bluetooth/bluetooth-next.git/commit/?id=b8e482d02513a9e6cd5208dfe615fb69727e9d82) ([diff](/pub/scm/linux/kernel/git/bluetooth/bluetooth-next.git/diff/?id=f132c2d13088&id2=b8e482d02513a9e6cd5208dfe615fb69727e9d82)) | |
| download | [bluetooth-next-f132c2d13088.tar.gz](/pub/scm/linux/kernel/git/bluetooth/bluetooth-next.git/snapshot/bluetooth-next-f132c2d13088.tar.gz) | |

Bluetooth: btsdio: fix use after free bug in btsdio\_remove due to unfinished workNotice: this object is not reachable from any branch.
In btsdio\_probe, &data->work was bound with btsdio\_work.In
btsdio\_send\_frame, it was started by schedule\_work.
If we call btsdio\_remove with an unfinished job, there may
be a race condition and cause UAF bug on hdev.
Fixes: ddbaf13e3609 ("[Bluetooth] Add generic driver for Bluetooth SDIO devices")
Signed-off-by: Zheng Wang <zyytlz.wz@163.com>
Signed-off-by: Luiz Augusto von Dentz <luiz.von.dentz@intel.com>
Notice: this object is not reachable from any branch.
[Diffstat](/pub/scm/linux/kernel/git/bluetooth/bluetooth-next.git/diff/?id=f132c2d13088)

| -rw-r--r-- | [drivers/bluetooth/btsdio.c](/pub/scm/linux/kernel/git/bluetooth/bluetooth-next.git/diff/drivers/bluetooth/btsdio.c?id=f132c2d13088) | 1 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 1 insertions, 0 deletions

| diff --git a/drivers/bluetooth/btsdio.c b/drivers/bluetooth/btsdio.cindex f19d31ee37ea89..51000320e1ea89 100644--- a/[drivers/bluetooth/btsdio.c](/pub/scm/linux/kernel/git/bluetooth/bluetooth-next.git/tree/drivers/bluetooth/btsdio.c?id=b8e482d02513a9e6cd5208dfe615fb69727e9d82)+++ b/[drivers/bluetooth/btsdio.c](/pub/scm/linux/kernel/git/bluetooth/bluetooth-next.git/tree/drivers/bluetooth/btsdio.c?id=f132c2d1308895b0a10e0f0c5f9f25e680777913)@@ -354,6 +354,7 @@ static void btsdio\_remove(struct sdio\_func \*func)  BT\_DBG("func %p", func); + cancel\_work\_sync(&data->work); if (!data) return; |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 17:36:54 +0000

