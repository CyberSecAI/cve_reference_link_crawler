The provided content describes a Remote Command Execution (RCE) vulnerability in Tenda AC18 routers.

**Root cause of vulnerability:**
The vulnerability stems from the router's web server (`/bin/httpd`) improperly handling the `mac` parameter in POST requests to `/goform/WriteFacMac`. The value of the `mac` parameter is directly passed to the `doSystem` function without proper sanitization, allowing an attacker to inject and execute arbitrary commands.

**Weaknesses/vulnerabilities present:**
- **Command Injection:** The primary vulnerability is command injection. The lack of input sanitization on the `mac` parameter allows an attacker to insert malicious commands into the system's shell.

**Impact of exploitation:**
- **Remote Command Execution:** Successful exploitation allows an attacker to execute arbitrary commands on the router's operating system with the privileges of the web server. This can lead to full control of the device.
- **Full control of device**: The ability to execute arbitrary commands can lead to full control of the device. This includes actions such as:
   - Modifying router settings
   - Intercepting and modifying network traffic
   - Deploying malware
   - Using the router as part of a botnet
   - Accessing sensitive data
   - Denial of service

**Attack vectors:**
- **HTTP POST Request:** The vulnerability is triggered by sending a crafted POST request to the `/goform/WriteFacMac` endpoint. The `mac` parameter in this request is used to inject the malicious payload.
- **Network Access:** An attacker needs network access to the router's web interface to exploit this vulnerability. This can be either local network access or, if the router's web interface is exposed to the internet, remote access.

**Required attacker capabilities/position:**
- **Network Connectivity:** The attacker needs to be on the same network or have access to the network where the vulnerable Tenda AC18 router is connected, or the router's management interface should be accessible from the internet.
- **Knowledge of vulnerable endpoint**: The attacker should know about `/goform/WriteFacMac` endpoint and the `mac` parameter.
- **HTTP Request skills**: Ability to craft an HTTP POST request to the router.
- **Authentication Cookie**: The attacker requires a valid `password` cookie.

**Additional Information:**
- The provided Proof of Concept (PoC) demonstrates how to exploit the vulnerability using a Python script.
- The PoC utilizes telnet to establish a shell on the router through command injection.
- The vulnerability affects Tenda AC18 routers running firmware versions V15.03.05.19 and V15.03.05.05.