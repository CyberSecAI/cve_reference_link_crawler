The provided content relates to CVE-2021-47368.

**Root Cause:**
The vulnerability lies in the `enetc` driver's interrupt setup. The `irq_set_affinity_hint()` function stores a reference to a `cpumask_t` parameter within the irq descriptor. However, the `cpu_mask` variable, which is passed to `irq_set_affinity_hint()`, is allocated on the stack and thus has temporary storage. When `irq_affinity_hint_proc_show()` attempts to access this reference later (e.g., when reading from the `/proc` filesystem), it leads to an illegal memory access.

**Vulnerability/Weakness:**
- **Use-after-free**: The code stores a pointer to a stack variable, and this memory is no longer valid when accessed later.

**Impact:**
- **Kernel Oops/Crash:** Reading the `affinity_hint` file in the procfs can lead to a kernel oops, effectively causing a crash.

**Attack Vector:**
- Accessing the `/proc` filesystem file for `affinity_hint` after the `enetc_setup_irqs` function has executed.

**Attacker Capabilities/Position:**
- An attacker needs the ability to read files from the `/proc` filesystem, which could be a user with some privileges or an application trying to debug.