Based on the provided content, here's a breakdown of the vulnerability:

**CVE ID:** CVE-2024-3520

**Root Cause:** The vulnerability stems from a missing authorization check in the `tc_csca_patch_settings` function within the Country State City Dropdown CF7 plugin for WordPress.

**Weaknesses/Vulnerabilities:**
* **Missing Authorization:** The `tc_csca_patch_settings` function, which is responsible for adding or updating state and city data, lacks a proper capability check. This allows any authenticated user, including those with subscriber-level access, to call this function.
* **Insecure AJAX Handling**: The plugin uses AJAX to perform actions, but does not validate user permissions before allowing modifications.

**Impact of Exploitation:**
* **Unauthorized Data Modification:** Attackers with low-level privileges (like subscriber access) can add or modify states and cities in the plugin's dropdown lists, which can lead to altered form data, incorrect information, and potential disruption of the website's functionality.

**Attack Vectors:**
* **Network-based:** The vulnerability can be exploited remotely.
* **AJAX Request:** The attacker sends a crafted AJAX request to the `wp_ajax_tc_csca_patch_settings` endpoint.

**Required Attacker Capabilities/Position:**
* **Authenticated User:** The attacker needs to have an account on the vulnerable WordPress website.
* **Subscriber Role or higher:** The attacker needs to be logged in with a minimum role of "subscriber."
* **Knowledge of the AJAX endpoint:** The attacker needs to know the AJAX action `tc_csca_patch_settings`.

**Additional Details:**
* The `tc_csca_patch_settings` function is intended to update city tables based on states, but it can also be used to insert new states and their respective cities.
* The provided code diffs show the addition of a capability check in the `tc_csca_patch_settings` function in version 2.7.2, addressing the vulnerability by only allowing users with `manage_options` capability to use it.
* The vulnerability was addressed in version 2.7.2 of the plugin.