```
{
  "vulnerability_details": {
    "root_cause": "The vulnerability was caused by a lack of input validation on user-provided data used to generate QR codes, combined with the use of `exec` to run the `qrencode` binary with user-controlled input.",
    "weaknesses": [
      "Insufficient input validation on user-provided data.",
      "Use of `exec` with user-controlled input to execute a system binary.",
      "Enabling the QR code module even when two-factor authentication is disabled."
    ],
    "impact": "An attacker could potentially execute arbitrary commands on the server by crafting malicious input to the QR code generation endpoint. This was made possible by a new `-r` (read from file) option added to the qrencode binary.  The vulnerability could allow for complete system compromise, depending on the permissions of the webserver process.",
    "attack_vectors": "An attacker could exploit the vulnerability by sending a crafted request to the `/qr?qr_text` endpoint with malicious input designed to leverage the `-r` parameter of qrencode to read a file as a qr text.",
    "attacker_capabilities": "An attacker needs to have valid login credentials to the VPN portal (i.e. be a legitimate user of the service)."
  },
  "additional_notes": "The vulnerability was introduced in vpn-user-portal version 2.3.2 and fixed in version 2.3.14. It was exploitable because the qrencode tool was updated with a `-r` flag allowing it to read content from a file. The vulnerability was present on Debian 10, Debian 11 and Fedora, but not on Debian 9 and CentOS 7 due to their versions of qrencode."
}
```