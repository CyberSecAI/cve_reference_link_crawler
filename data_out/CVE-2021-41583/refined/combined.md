=== Content from list.surfnet.nl_39dcefd9_20250108_135638.html ===

# [eduVPN-deploy] Details Security Issue 2021-08-25

**François Kooman**
fkooman at tuxed.net

*Wed Sep 1 16:21:01 CEST 2021*

* Next message: [[eduVPN-deploy] Installing Updates](000353.html)
* **Messages sorted by:**
  [[ date ]](date.html#352)
  [[ thread ]](thread.html#352)
  [[ subject ]](subject.html#352)
  [[ author ]](author.html#352)

---

```
Hi all,

On August 25, 2021 we were made aware of a security issue in the eduVPN
/ Let's Connect! server by Nick Aquina, an eduVPN for Android
application contributor. All servers we are aware of were updated in the
last days.

** Vulnerability **

The vulnerability was a classic "input validation" issue. We did not
verify user input. Due to this problem, the potential for a
vulnerability was always there, but it became exploitable after an
update to one of the tools we depend on for generating QR codes. These
QR codes are used for two-factor enrollment.

The server software was VULNERABLE on Debian 10, Debian 11 and Fedora.
The server software was NOT vulnerable on Debian 9 and CentOS 7.

The vulnerability was first introduced in vpn-user-portal 2.3.2 released
on 2020-07-27.

** Scope **

The attack could have been executed by anyone able to login to the VPN
portal. This typically means all your users.

** Fix **

The vulnerability was fixed in vpn-user-portal 2.3.14 released on
2021-08-26.

** Description **

The vulnerability became exploitable because of an unfortunate number of
circumstances:

1. We did not perform adequate input validation on the potentially user
provided data to generate a QR codes;
2. We use "exec" to run a binary on the system which is risky,
especially when using user input;
3. The qrencode binary in distributions got updated and introduced a
"read from file" parameter that did not previously exist;
4. We enabled the QR module _even_ when two factor authentication was
not enabled.

We did not perform input validation for the QR code generation as it
seemed not that important at the time and the "Key URI format" [1] was
quite complicated to validate correctly. Of course, it was a mistake not
to do that anyway.

The reason we used "exec" to run an executable (2) was that it was much
faster and we could use a binary already available on all operating
systems we support [2] and thus remove a few PHP dependencies.

The qrencode tool as mentioned in (3) got the new flag `-r` in version
4.0.0. Because CentOS 7 [3] and Debian 9 [4] never had/got this version
I didn't notice the `-r` flag when reviewing the man-page.

Reason (4) was another oversight: we enabled code that was not used
which is better to avoid. It would have reduced impact substantially.

** Implemented Fixes **

In the current production release we solved (4) by only enabling it when
two factor authentication is enabled. This reduces the potential attack
surface. Furthermore, we only allow the TOTP secret to be specified. It
can be strictly validated as it only uses the Base32 alphabet. This
solves (1). It is still not the perfect solution. In the next (major)
release of eduVPN/Let's Connect! we'll avoid exposing a "QR endpoint"
altogether and directly embed the QR code. Another fix already
implemented is a strict requirement in the code to always specify a
validation function when using external input, that will prevent
"forgetting" to validate input.

** Exploitation **

We did NOT see or hear any indication of exploitation in the field.
However, you can verify your web server log files and check for
occurrences of requests to "/qr?qr_text" that look suspicious and e.g.
point to a file with the "-r" flag. You can check the log files in
/var/log/apache2 (Debian) or /var/log/httpd (Fedora). If you find
something, or are not sure, please let us know!

** Recovery **

In case you want to "reset" your server, you can do that, but make sure
you first install the updates. Note that all users will have to login
again using the eduVPN/Let's Connect! apps and/or download a new
configuration file from the portal as ALL data (including local user
accounts), but no configuration, pertaining to the VPN server will be
deleted. For single server VPNs:

     $ sudo vpn-maint-reset-system

** Final Thoughts **

It took a few days to get servers updated, which in the end is not so
bad. We did have to contact some server operators a few times in order
to get them to update their servers. It is not exactly sure how to
improve this process. However, it could have been a lot worse...

Let us know if you have any questions!

Regards,
François

[1] <https://github.com/google/google-authenticator/wiki/Key-Uri-Format>
[2] <https://github.com/Bacon/BaconQrCode/issues/70>
[3] <https://git.centos.org/rpms/qrencode/blob/c7/f/SPECS/qrencode.spec>
[4] <https://packages.debian.org/stretch/qrencode>

```

---

* Next message: [[eduVPN-deploy] Installing Updates](000353.html)
* **Messages sorted by:**
  [[ date ]](date.html#352)
  [[ thread ]](thread.html#352)
  [[ subject ]](subject.html#352)
  [[ author ]](author.html#352)

---

[More information about the eduVPN-deploy
mailing list](https://list.surfnet.nl/mailman/listinfo/eduvpn-deploy)



=== Content from github.com_7155e3e1_20250108_135638.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Feduvpn%2Fvpn-user-portal%2Freleases)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Feduvpn%2Fvpn-user-portal%2Freleases)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Freleases%2Findex&source=header-repo&source_repo=eduvpn%2Fvpn-user-portal)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

This repository has been archived by the owner on May 27, 2024. It is now read-only.

[eduvpn](/eduvpn)
/
**[vpn-user-portal](/eduvpn/vpn-user-portal)**
Public archive

* [Notifications](/login?return_to=%2Feduvpn%2Fvpn-user-portal) You must be signed in to change notification settings
* [Fork
  38](/login?return_to=%2Feduvpn%2Fvpn-user-portal)
* [Star
   30](/login?return_to=%2Feduvpn%2Fvpn-user-portal)

* [Code](/eduvpn/vpn-user-portal)
* [Pull requests
  4](/eduvpn/vpn-user-portal/pulls)
* [Actions](/eduvpn/vpn-user-portal/actions)
* [Wiki](/eduvpn/vpn-user-portal/wiki)
* [Security](/eduvpn/vpn-user-portal/security)
* [Insights](/eduvpn/vpn-user-portal/pulse)

Additional navigation options

* [Code](/eduvpn/vpn-user-portal)
* [Pull requests](/eduvpn/vpn-user-portal/pulls)
* [Actions](/eduvpn/vpn-user-portal/actions)
* [Wiki](/eduvpn/vpn-user-portal/wiki)
* [Security](/eduvpn/vpn-user-portal/security)
* [Insights](/eduvpn/vpn-user-portal/pulse)

# Releases: eduvpn/vpn-user-portal

[Releases](/eduvpn/vpn-user-portal/releases)
[Tags](/eduvpn/vpn-user-portal/tags)

Releases · eduvpn/vpn-user-portal
## 2.3.3

28 Jul 20:28

[2.3.3](/eduvpn/vpn-user-portal/tree/2.3.3)

[`a1f9ec2`](/eduvpn/vpn-user-portal/commit/a1f9ec2b472def12c6c7ea1dbb00c50b8b6829d7)

 Compare

Choose a tag to compare

Could not load tags

Nothing to show

[{{ refName }}
default](/eduvpn/vpn-user-portal/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...2.3.3)

 Loading

[View all tags](/eduvpn/vpn-user-portal/tags)

[2.3.3](/eduvpn/vpn-user-portal/releases/tag/2.3.3)
[Latest](/eduvpn/vpn-user-portal/releases/latest)

[Latest](/eduvpn/vpn-user-portal/releases/latest)

```
2.3.3
```

 Assets
5

 Loading

All reactions

## 2.3.2

27 Jul 06:55

[2.3.2](/eduvpn/vpn-user-portal/tree/2.3.2)

[`3a850e1`](/eduvpn/vpn-user-portal/commit/3a850e1df3b81811623ffcce7823359915661fba)

 Compare

Choose a tag to compare

Could not load tags

Nothing to show

[{{ refName }}
default](/eduvpn/vpn-user-portal/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...2.3.2)

 Loading

[View all tags](/eduvpn/vpn-user-portal/tags)

[2.3.2](/eduvpn/vpn-user-portal/releases/tag/2.3.2)

```
2.3.2
```

 Assets
5

 Loading

All reactions

## 2.3.1

10 Jul 08:49

[2.3.1](/eduvpn/vpn-user-portal/tree/2.3.1)

[`f0617f2`](/eduvpn/vpn-user-portal/commit/f0617f24768006bb9be32bcea1045c134ec56ce2)

 Compare

Choose a tag to compare

Could not load tags

Nothing to show

[{{ refName }}
default](/eduvpn/vpn-user-portal/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...2.3.1)

 Loading

[View all tags](/eduvpn/vpn-user-portal/tags)

[2.3.1](/eduvpn/vpn-user-portal/releases/tag/2.3.1)

```
2.3.1
```

 Assets
5

 Loading

All reactions

## 2.3.0

29 Jun 13:22

[2.3.0](/eduvpn/vpn-user-portal/tree/2.3.0)

[`58cf9cb`](/eduvpn/vpn-user-portal/commit/58cf9cbf8870d1fb747a9972c1c0a3be6d5b3043)

 Compare

Choose a tag to compare

Could not load tags

Nothing to show

[{{ refName }}
default](/eduvpn/vpn-user-portal/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...2.3.0)

 Loading

[View all tags](/eduvpn/vpn-user-portal/tags)

[2.3.0](/eduvpn/vpn-user-portal/releases/tag/2.3.0)

```
2.3.0
```

 Assets
5

 Loading

All reactions

## 2.2.8

26 May 07:35

[2.2.8](/eduvpn/vpn-user-portal/tree/2.2.8)

[`5b01b89`](/eduvpn/vpn-user-portal/commit/5b01b89181c50916d1e8f72dc675b641e3d91418)

 Compare

Choose a tag to compare

Could not load tags

Nothing to show

[{{ refName }}
default](/eduvpn/vpn-user-portal/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...2.2.8)

 Loading

[View all tags](/eduvpn/vpn-user-portal/tags)

[2.2.8](/eduvpn/vpn-user-portal/releases/tag/2.2.8)

```
2.2.8
```

 Assets
5

 Loading

All reactions

## 2.2.7

21 May 09:12

[2.2.7](/eduvpn/vpn-user-portal/tree/2.2.7)

[`a00af3e`](/eduvpn/vpn-user-portal/commit/a00af3ee35a09fea1868f24e79c925f1a170028f)

 Compare

Choose a tag to compare

Could not load tags

Nothing to show

[{{ refName }}
default](/eduvpn/vpn-user-portal/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...2.2.7)

 Loading

[View all tags](/eduvpn/vpn-user-portal/tags)

[2.2.7](/eduvpn/vpn-user-portal/releases/tag/2.2.7)

```
2.2.7
```

 Assets
5

 Loading

All reactions

## 2.2.6

12 May 09:34

[2.2.6](/eduvpn/vpn-user-portal/tree/2.2.6)

[`1f5b07c`](/eduvpn/vpn-user-portal/commit/1f5b07c9870a34c9bf46a823fdf8d9a9f8bb32fc)

 Compare

Choose a tag to compare

Could not load tags

Nothing to show

[{{ refName }}
default](/eduvpn/vpn-user-portal/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...2.2.6)

 Loading

[View all tags](/eduvpn/vpn-user-portal/tags)

[2.2.6](/eduvpn/vpn-user-portal/releases/tag/2.2.6)

```
2.2.6
```

 Assets
5

 Loading

All reactions

## 2.2.5

05 Apr 20:25

[2.2.5](/eduvpn/vpn-user-portal/tree/2.2.5)

[`59553cd`](/eduvpn/vpn-user-portal/commit/59553cdd1f1cbc6641f37c89e9db738a473f96c4)

 Compare

Choose a tag to compare

Could not load tags

Nothing to show

[{{ refName }}
default](/eduvpn/vpn-user-portal/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...2.2.5)

 Loading

[View all tags](/eduvpn/vpn-user-portal/tags)

[2.2.5](/eduvpn/vpn-user-portal/releases/tag/2.2.5)

```
2.2.5
```

 Assets
5

 Loading

All reactions

## 2.2.4

30 Mar 15:18

[2.2.4](/eduvpn/vpn-user-portal/tree/2.2.4)

[`4993eab`](/eduvpn/vpn-user-portal/commit/4993eabd24887d5e3c5e3bce310536acfa91574d)

 Compare

Choose a tag to compare

Could not load tags

Nothing to show

[{{ refName }}
default](/eduvpn/vpn-user-portal/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...2.2.4)

 Loading

[View all tags](/eduvpn/vpn-user-portal/tags)

[2.2.4](/eduvpn/vpn-user-portal/releases/tag/2.2.4)

```
2.2.4
```

 Assets
5

 Loading

All reactions

## 2.2.3

23 Mar 16:28

[2.2.3](/eduvpn/vpn-user-portal/tree/2.2.3)

[`108afa0`](/eduvpn/vpn-user-portal/commit/108afa0bc8faf6d533d3e45ece048d94e54e4b64)

 Compare

Choose a tag to compare

Could not load tags

Nothing to show

[{{ refName }}
default](/eduvpn/vpn-user-portal/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...2.2.3)

 Loading

[View all tags](/eduvpn/vpn-user-portal/tags)

[2.2.3](/eduvpn/vpn-user-portal/releases/tag/2.2.3)

```
2.2.3
```

 Assets
5

 Loading

All reactions

Previous *1* [2](/eduvpn/vpn-user-portal/releases?page=2) [3](/eduvpn/vpn-user-portal/releases?page=3) [4](/eduvpn/vpn-user-portal/releases?page=4) [5](/eduvpn/vpn-user-portal/releases?page=5) [Next](/eduvpn/vpn-user-portal/releases?page=2)

Previous [Next](/eduvpn/vpn-user-portal/releases?page=2)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


