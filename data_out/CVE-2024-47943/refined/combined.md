=== Content from r.sec-consult.com_74957361_20250111_195058.html ===

Toggle Navbar

* [Career](/career/)
* [About us](/about-us/)
* [Contact](/contact/)

* EN
  + [DE](/de/vulnerability-lab/advisory/zahlreiche-schwachstellen-im-rittal-iot-interface-cmc-iii-processing-unit/ "German")
Search

* Security Testing
  + [Web Application Security](/security-testing/web-application-security/)
  + [Penetration Testing](/security-testing/penetration-testing/)
  + [Mobile Security](/security-testing/mobile-security/)
  + [Cloud Security](/security-testing/cloud-security/)
  + [IT Infrastructure Security](/security-testing/it-infrastructure-security/)
  + [Security for SAP Services](/security-testing/security-for-sap-services/)
  + [IoT and Embedded Systems Security](/security-testing/iot-and-embedded-systems-security/)
  + [Red Teaming](/security-testing/red-teaming/)
* Processes & Organisation
  + [Information Security Management (ISM)](/processes-organisation/information-security-management-ism/)
  + [Network and Information Systems Security (NIS)](/processes-organisation/network-and-information-systems-security-nis/)
  + [OT Security](/processes-organisation/ot-security/)
  + [Secure Software Development Consulting](/processes-organisation/secure-software-development/)
  + [Red Teaming](/security-testing/red-teaming/)
  + [SEC Trainings](/processes-organisation/sec-trainings/)
  + [Project- und Program Management](/processes-organisation/project-und-program-management/)
* Incident Response
  + [SEC Defence](/incident-response/sec-defence/)
* [Vulnerability Lab](/vulnerability-lab/)
* [Blog](/blog/)
 [Incident?
Breached?
Report an incident](/incident-response/sec-defence/)

1. [Home](/)
2. [Vulnerability Lab](/vulnerability-lab/)
3. Multiple Vulnerabilities in Rittal IoT Interface & CMC III Processing Unit
# Multiple Vulnerabilities in Rittal IoT Interface & CMC III Processing Unit

Title

Multiple Vulnerabilities

Product

Rittal IoT Interface & CMC III Processing Unit

Vulnerable Version

<6.21.00.2

Fixed Version

6.21.00.2

CVE Number

CVE-2024-47943, CVE-2024-47944, CVE-2024-47945

Impact

critical

Homepage

[https://www.rittal.com](https://www.rittal.com "https://www.rittal.com")

Found

03.06.2024

By

Johannes Kruchem (Office Vienna) | SEC Consult Vulnerability Lab

Multiple security vulnerabilities have been identified in the Rittal IoT Interface and the CMC III Processing Unit, which could allow attackers to compromise the system and gain unauthorized access. These included improper verification of firmware updates, the lack of protection mechanisms for hardware interfaces, and predictable session ID generation. Together, these flaws enabled authenticated remote code execution or physical unauthenticated code execution, session hijacking, and unauthorized access, putting the system at risk of being controlled by malicious actors.

## Vendor description

*"Innovative strength has been woven into the Rittal DNA since its foundation. In 1961, Rudolf Loh Elektrogerätebau was founded in Rittershausen by the entrepreneur Rudolf Loh, with one simple guiding principle:  'Enclosures off the shelf, immediately.' In its founding year it launched the world's first standard enclosure on the market. In 1969, the company was renamed Rittal, in honour of its roots in Rittershausen in Dietzhölztal. Within just a few years, Rittal enclosures had become established as a global standard, and have remained so to this day."*

Source: [www.rittal.com/com-en/Company](https://www.rittal.com/com-en/Company)

## Business recommendation

The vendor provides a patch which should be installed immediately on the affected devices.

SEC Consult highly recommends to perform a thorough security review of the product conducted by security professionals to identify and resolve potential further security issues.

## Vulnerability overview/description

### 1) Improper signature verification of firmware upgrade files (CVE-2024-47943)

The firmware upgrade function in the admin web interface checks if the patch files are signed before executing the containing run.sh script. The signing process is kind of an HMAC with a long string as key which is hard-coded in the firmware and is freely available for download. This allows crafting malicious "signed" .patch files in order to compromise the device and execute arbitrary code.

### 2) Missing Protection Mechanism for Alternate Hardware Interface (CVE-2024-47944)

The device directly executes .patch files on a USB stick without any authentication. This leads to an unauthenticated code execution in combination with 1).

### 3) Predictable Session ID (CVE-2024-47945)

The device is vulnerable to session hijacking due to insufficient entropy in its session ID generation algorithm. The session IDs are predictable, with only 32,768 possible values per user, which allows attackers to pre-generate valid session IDs, leading to unauthorized access to user sessions. This is not only due to the use of an (insecure) rand() function call but also because of missing initialization via srand(). As a result only the PIDs are effectively used as seed.

## Proof of concept

### 1) Improper signature verification of firmware upgrade files (CVE-2024-47943)

To create a firmware or patch file passing the signature verification the following steps are necessary:

* Store SHA512sum of all files of the fake firmware (needs run.sh) in file "rittal"
* Append hardcoded key "8ab4ce0f72bce9b3837281b7928732c5abfc43103a681214942dec2cc91f236ce8e9263f5778cc6db253ade368b0db4a9ff2adb9cc9f76c5114fe3ffcaf38bba" to the file
* Store SHA512sum of the file "rittal" in rittal.sig (delete "rittal" file if in directory)
* Create .tar of fake firmware files (e.g. run.sh & rittal.sig)
* Rename to <name>.patch
* Apply firmware upgrade (needs admin session in web interface)
* Profit

The [attached PoC code](/fileadmin/user_upload/sec-consult/Dynamisch/Advisories/2024_10/create_signed_firmware.py) creates a new valid .patch file which will be executed with root privileges when the firmware upgrade will be applied.

### 2) Missing Protection Mechanism for Alternate Hardware Interface (CVE-2024-47944)

This PoC describes the exploit from 1) without authentication but physical access. For exploitation a signed (see 1)) firmware or .patch file is needed. A script checks for new content of plugged-in USB sticks or SD cards. If there is a .patch file available, the signature verification process will be triggered.

The [attached PoC code](/fileadmin/user_upload/sec-consult/Dynamisch/Advisories/2024_10/create_signed_firmware.py) can also be used to generate signed firmware files.

### 3) Predictable Session ID (CVE-2024-47945)

The following function generates the sessionID for the web interface. The code is part of the json.cgi script, which is invoked by the Lighttpd web server:

```
  generate_sessionID(int a1, int UserID)
  {
    int pid; // r5
    int seed; // r0

    pid = getpid();
    seed = rand();
    srand(pid + seed);
    return ((rand() + 123) & 0xFFFFF00F) + 16 * UserID;
  }
```

It has been identified that the rand() function used in the sessionID generation has a complexity of 2^31, which is inherently weak. However, the practical implications for online brute-force attacks are limited due to additional factors.

The Process ID (PID) can range between 0 and 32768, and the UserID can vary from 0 to 256, which slightly increases the complexity. The primary issue lies in the initial call to rand(), which always returns 1804289383 because it is not initialized with srand(). Since json.cgi is invoked for every request, the subsequent initialization does not take effect. This results in the seed being essentially ineffective, leaving only the PID to function as the seed.

The UserID value is dependent on the user, with "admin" having a UserID of 0 and "user" having a UserID of 1. Consequently, the sessionID has an entropy of only 32768, making it highly susceptible to exploitation within a few minutes.

The [attached PoC code](/fileadmin/user_upload/sec-consult/Dynamisch/Advisories/2024_10/sessionID_online_Brute_Forcer.py) takes a [list of sessionIDs](/fileadmin/user_upload/sec-consult/Dynamisch/Advisories/2024_10/sessionIDs.txt) and performs an online brute-force attack. A valid session needs to be active.

## Vulnerable / tested versions

The following versions have been tested which were the latest version available at the time of the test:

* 6.17.00
* 6.19.00.1

It is assumed that all previous versions <V6.21.00.2 are affected.

The vendor confirmed that the products 3124.300 IoT Interface and 7030.000 CMC III Processing Unit are affected.

## Vendor contact timeline

| 2024-06-21: Contacting vendor through info@rittal.de; no response. |
| --- |
| 2024-07-01: Contacting vendor through LinkedIn. |
| 2024-07-02: Received contact for embedded devices. |
| 2024-07-03: Sent advisory to Rittal contact. |
| 2024-07-12: Response from vendor that V6.21.00.2 with fixed vulnerabilities will be released on 2024-09-30. |
| 2024-10-07: Reserving CVE numbers. |
| 2024-10-08: Informing Rittal about upcoming security conference talk having Rittal as an example regarding SessionID entropy, sending CVE numbers to vendor, asking again about affected products. |
| 2024-10-11: Vendor confirms affected products, security fixes have already been published. |
| 2024-10-15: Coordinated release of security advisory. |

## Solution

The vendor provides a patched version V6.21.00.2 which can be downloaded from the following URL:
[www.rittal.com/de-de/products/deep/3124300](https://www.rittal.com/de-de/products/deep/3124300)

## Workaround

None

## Advisory URL

[sec-consult.com/vulnerability-lab/](https://sec-consult.com/vulnerability-lab/)

EOF Johannes Kruchem / @2024

*Interested to work with the experts of SEC Consult? Send us your [application](https://sec-consult.com/career/)
 Interested in improving your cyber security with the experts of SEC Consult? Contact our [local offices](https://sec-consult.com/contact/)*

[Back](/vulnerability-lab/)

* [Legal Notice](/legalnotice/)
* [Privacy Statement](/privacy-statement/)
* [Jobs](/career/)

SEC Consult is one of the leading consultancies in the field of cyber and [application security](/security-testing/web-application-security/ "Web Application Security"). The company specializes in [information security management](/processes-organisation/information-security-management-ism/ "Information Security Management (ISM)"), [NIS security audits](/processes-organisation/network-and-information-systems-security-nis/ "NIS security audits"), [penetration testing](/security-testing/penetration-testing/ "Pentesting (Pentest)"), ISO 27001 certification support, [Cyber Defence](/incident-response/sec-defence/ "Cyber Defence") and [secure software certification](/processes-organisation/secure-software-development/ "Secure Software Development Consulting"). SEC Consult is part of [Eviden](https://eviden.com/ "Link to Eviden website").

[![bsi ISO/IEC 27001 Information Security Management CERTIFIED](/typo3temp/assets/_processed_/c/2/csm_bsi_9a24e74563.png)](/about-us/ "About us")[![ISO 27001 CREST certified](/typo3temp/assets/_processed_/0/6/csm_crest_0eb9c5864d.png)](/about-us/ "About us")[![Great Place To Work AT certified](/typo3temp/assets/_processed_/0/3/csm_great-place-to-work-at_773b265aa6.png)](/about-us/ "About us")[![Great Place To Work DE certified](/typo3temp/assets/_processed_/d/6/csm_great-place-to-work-de_2fcb537270.png)](/about-us/ "About us")

## We use Cookies

We use cookies to offer you a perfect visit experience. These include cookies that are necessary for the operation of the site and for the control of our commercial corporate goals, as well as those that are only used for anonymous statistical purposes, for convenience settings or to display personalized content. Decide for yourself which categories you want to allow. Please note that based on your settings, not all functions of the site may be available.

**[Legal Notice](/legalnotice/)** •  **[Privacy Statement](/privacy-statement/)**

### Technically required

(
0
Service
)

no

Technically required (
0
Service
)

yes

### Analysis / statistics

(
1
Service
)

Anonymous evaluation for troubleshooting and further development

no

Analysis / statistics (
1
Service
)

yes

#### Matomo

no

Matomo

yes

Matomo.org
Show details

Hide details

**Purpose**: Error analysis, statistical evaluation of our website accesses, campaign analysis, conversion tracking.
 **Processing operations**: collection of access data, data from your browser and data about the content accessed; execution of analysis software and storage of data on your terminal device, anonymization of the data collected; evaluation of the anonymous data in the form of statistics.
 **Storage period**: 1 year.
 **Joint controller**: LimeSoda Interactive Marketing GmbH.
 **Legal basis for data processing**: Art. 6 para. 1 lit. f of the DSGVO.
 **Consequences of non-consent**: This basic tracking is absolutely necessary for the operation of our website.
 **Data transfer**: The data collected with Matomo is stored on our own servers. It is not passed on to third parties.

Accept selected

Reject all

Accept all



=== Content from www.rittal.com_76486789_20250111_195059.html ===


# IoT Interface

## Artikel-Nummer: SK 3124.300

Das IoT Interface ist zentraler Bestandteil zur intelligenten Vernetzung von Rittal Kühllösungen oder Sensoren zur Überwachung von physikalischen Umgebungsbedingungen. Ausgestattet mit einer großen Vielfalt an Schnittstellen und Protokollen dient es der Datensammlung und -übertragung an übergeordnete IT-Systeme oder an Systeme zur lokalen Überwachung von Maschinenzuständen.

[Diese Seite als PDF ansehen](https://www.rittal.com/pdf-creator/variant/de-de/3124300)

[Produkt im E-Book ansehen](https://www.rittal.com/de-de/ebook/de_cat36/html5.html?lbpage=554)

Bestell-Nr.: 7030.110

CMC III Sensoren

[Mehr Details](/de-de/products/deep/7030110)

Bestell-Nr.: 7030.111

CMC III Sensoren

[Mehr Details](/de-de/products/deep/7030111)

Bestell-Nr.: 7030.120

CMC III Sensoren

[Mehr Details](/de-de/products/deep/7030120)

Bestell-Nr.: 7030.130

CMC III Sensoren

[Mehr Details](/de-de/products/deep/7030130)

Bestell-Nr.: 7030.400

CMC III Sensoren

[Mehr Details](/de-de/products/deep/7030400)

Bestell-Nr.: 7030.091

CMC III CAN-Bus Verbindungskabel

[Mehr Details](/de-de/products/deep/7030091)

Artikel-Nummer:
SK 3124.300

Produktbeschreibung
Das IoT Interface ist zentraler Bestandteil zur intelligenten Vernetzung von Rittal Kühllösungen oder Sensoren zur Überwachung von physikalischen Umgebungsbedingungen. Ausgestattet mit einer großen Vielfalt an Schnittstellen und Protokollen dient es der Datensammlung und -übertragung an übergeordnete IT-Systeme oder an Systeme zur lokalen Überwachung von Maschinenzuständen.

Nutzen
Digitalisierung und Vernetzung bieten große Chancen für jedes Unternehmen. Mit dem IoT Interface ist die Anbindung von Rittal Kühllösungen und Sensoren zur Überwachung von physikalischen Umgebungsbedingungen an Industrie 4.0-Umgebungen einfach realisierbar, ohne in die Automatisierungslogik einzugreifen.
Plug and run: Die Konfiguration und Inbetriebnahme des IoT Interface erfolgt schnell, komfortabel und völlig programmierfrei über den integrierten Webserver.

Material
Kunststoff nach UL 94-V0

Farbe
RAL 7016

Lieferumfang
IoT Interface
USB-Kabel (USB-A Stecker auf Micro-USB-B Stecker)
Haltewinkel für Blue e+ Kühlgerät

Anschlussart (elektrisch)
Push-in-Federanschlussklemme (24 V DC)

Schnittstellen Bus-System
2 x RJ45 CAN-Bus

Netzwerk-Schnittstelle
Ethernet IPv4/IPv6
Ethernet nach IEEE 802.3 über 10BASE-T, 100BASE-T und 1000BASE-T

Schnittstellen
1 x Micro USB Typ B (device) für USB 2.0
1 x Micro-SD Speicherkarten-Slot für SD 2.0
1 x USB 2.0 High-Speed Funktionen (EHCI)
1 x Quittier-Taste
1 x Push-in-Federanschlussklemme für NTC-Sensor
2 x RJ45 Buchse für RS 485 Schnittstelle (Schnittstelle Klimagerät)

Montagehinweis
Das IoT Interface kann durch eine gefederte Metallklemme auf einer Hutschiene 35 x 7,5 nach DIN EN 60715 befestigt werden oder mittels Haltewinkel an der Rückseite eines Blue e+ Kühlgerätes.

Hinweis
Das IoT Interface wird von den Blue e+ Kühlgeräten erst ab Firmware 1.11.0 unterstützt.
Für das Vernetzen von Kühlgeräten der Serie Blue e ist zusätzlich der Blue e IoT Adapter (3124.310) erforderlich.

Protokolle
OPC-UA
SNMPv1
SNMPv2c
SNMPv3
Modbus/TCP
TCP/IPv4
TCP/IPv6
Radius
Telnet
SSH
FTP
SFTP
HTTP
HTTPS
NTP
DHCP
DNS
SMTP
Syslog
LDAP

Abmessung
Breite: 18 mm
Höhe: 117 mm
Tiefe: 120 mm

Betriebstemperaturbereich
0 °C...70 °C

Schutzart IP nach IEC 60 529
IP 20

Verpackungseinheit
1 Stück

Nettogewicht
0,27 kg

Bruttogewicht
0,28 kg

Zolltarifnummer
85234920

EAN
4028177924369

ETIM 9
EC001099

ETIM 8
EC001099

ECLASS 8.0
27143136

Produktbeschreibung
SK IoT Interface, zur Vernetzung von Rittal Komponenten, für Blue e+ Kühlgeräte/Chiller, BHT: 18 x 117 x 120 mm

Approbationen
UL + C-UL (listed)

* [EN](https://www.rittal.com/imf/none/20_1684/3124300_UL__C_UL_listed__EN)

Zertifikate
EAC

* [RU](https://www.rittal.com/imf/none/20_1781/3124300_EAC_RU)

Erklärungen
Konformitätserklärung

* [DE, EN](https://www.rittal.com/imf/none/20_1501/3124300_Konformit_auml_tserkl_auml_rung_DE_EN)

Dokumentationen
Anleitung

* [DE](https://www.rittal.com/imf/none/3_7559/3124300_Anleitung_DE)
* [EN](https://www.rittal.com/imf/none/3_7560/3124300_Anleitung_EN)
* [FR](https://www.rittal.com/imf/none/3_7988/3124300_Anleitung_FR)
Kurzanleitung

* [DE, EN, FR](https://www.rittal.com/imf/none/3_7815/3124300_Kurzanleitung_DE_EN_FR)
Zusätzliche Anleitung

* [DE](https://www.rittal.com/imf/none/3_7561/3124300_Zus_auml_tzliche_Anleitung_DE)
* [EN](https://www.rittal.com/imf/none/3_7562/3124300_Zus_auml_tzliche_Anleitung_EN)
* [FR](https://www.rittal.com/imf/none/3_11511/3124300_Zus_auml_tzliche_Anleitung_FR)

Datenblätter
Technisches Systemhandbuch

* [DE](https://www.rittal.com/imf/none/3_6104/3124300_Technisches_Systemhandbuch_DE)
* [EN](https://www.rittal.com/imf/none/3_8419/3124300_Technisches_Systemhandbuch_EN)
* [JA](https://www.rittal.com/imf/none/3_8420/3124300_Technisches_Systemhandbuch_JA)

Software
Software

* [DE](https://www.rittal.com/imf/none/3_6734/3124300_Software_DE)
* [EN](https://www.rittal.com/imf/none/3_6735/3124300_Software_EN)
Treiber

* [DE, EN](https://www.rittal.com/imf/none/3_6736/3124300_Treiber_DE_EN)

**SK 3124.300
Das IoT Interface ist zentraler Bestandteil zur intelligenten Vernetzung
von Rittal Kühllösungen oder Sensoren zur Überwachung von physikalischen
Umgebungsbedingungen. Ausgestattet mit einer großen Vielfalt an
Schnittstellen und Protokollen dient es der Datensammlung und
-übertragung an übergeordnete IT-Systeme oder an Systeme zur lokalen
Überwachung von Maschinenzuständen.**

Nutzen:


