=== Content from plugins.trac.wordpress.org_c51a1eb9_20250111_150827.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fbrowser%2Fwpextended%2Ftrunk%2Fadmin%2Fclass-wp-extended-admin.php)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Revision](/browser/wpextended/trunk/admin/class-wp-extended-admin.php?rev=3193235 "Revision 3193235")
* Next Revision →
* [Blame](/browser/wpextended/trunk/admin/class-wp-extended-admin.php?annotate=blame "Annotate each line with the last changed revision (this can be time consuming...)")
* [Revision Log](/log/wpextended/trunk/admin/class-wp-extended-admin.php)

---

# [source:](/browser?order=name "Go to repository root") [wpextended](/browser/wpextended?order=name "View wpextended")/[trunk](/browser/wpextended/trunk?order=name "View trunk")/[admin](/browser/wpextended/trunk/admin?order=name "View admin")/[class-wp-extended-admin.php](/browser/wpextended/trunk/admin/class-wp-extended-admin.php?order=name "View class-wp-extended-admin.php")

View diff against:

View revision:

| [Last change](/changeset/3213331/wpextended/trunk/admin/class-wp-extended-admin.php "View differences") on this file was [3213331](/changeset/3213331/ "View changeset 3213331"), checked in by wpextended, [2 weeks ago](/timeline?from=2024-12-26T13%3A01%3A46Z&precision=second "See timeline at 12/26/2024 01:01:46 PM") |
| --- |
| * Security Fix: Missing Authorization to Authenticated (Subscriber+) Remote Code Execution. * Fix: Menu Editor - The disabled menu does not go away (in the WP Bakery plugin). * Fix: Menu Editor - Fix/undefined user login * Improvement: Export Posts & Pages - Fixed escaping issue with download URL * Update: Tested with [WordPress](/wiki/WordPress) 6.7.1 |
| * Property **svn:executable** set to   *`*`* | |
| **File size:** 39.1 KB | |

| Line |  |
| --- | --- |
| [1](#L1) | <?php |
| [2](#L2) |  |
| [3](#L3) | /\*\* |
| [4](#L4) | \* The admin-specific functionality of the plugin. |
| [5](#L5) | \* |
| [6](#L6) | \* @link       http://wearenrcm.com |
| [7](#L7) | \* @since      1.0.0 |
| [8](#L8) | \* |
| [9](#L9) | \* @package    wp\_extended |
| [10](#L10) | \* @subpackage wp\_extended/admin |
| [11](#L11) | \*/ |
| [12](#L12) |  |
| [13](#L13) | /\*\* |
| [14](#L14) | \* The admin-specific functionality of the plugin. |
| [15](#L15) | \* |
| [16](#L16) | \* Defines the plugin name, version, and two examples hooks for how to |
| [17](#L17) | \* enqueue the admin-specific stylesheet and JavaScript. |
| [18](#L18) | \* |
| [19](#L19) | \* @package    wp\_extended |
| [20](#L20) | \* @subpackage wp\_extended/admin |
| [21](#L21) | \* @author     NRCM Web Design <hello@wearenrcm.com> |
| [22](#L22) | \*/ |
| [23](#L23) | class Wp\_Extended\_admin extends Wp\_Extended { |
| [24](#L24) | const WPEXT\_CHECK\_LICENSE\_STSTUS = 'wpext\_license\_key'; |
| [25](#L25) |  |
| [26](#L26) | /\*\* |
| [27](#L27) | \* Initialize the class and set its properties. |
| [28](#L28) | \* |
| [29](#L29) | \* @since    1.0.0 |
| [30](#L30) | \* @param      string    $wp\_extended       The name of this plugin. |
| [31](#L31) | \* @param      string    $version    The version of this plugin. |
| [32](#L32) | \*/ |
| [33](#L33) | public function \_\_construct( $wp\_extended, $version ) { |
| [34](#L34) |  |
| [35](#L35) | parent::\_\_construct( $wp\_extended, $version ); |
| [36](#L36) |  |
| [37](#L37) | add\_action('admin\_menu', array( $this, 'menu' ) ); |
| [38](#L38) |  |
| [39](#L39) | add\_action('admin\_init',    array( $this, 'options\_init' ) ); |
| [40](#L40) | add\_action('rest\_api\_init', array( $this, 'options\_init' ) ); |
| [41](#L41) | add\_action('admin\_enqueue\_scripts', array( $this, 'enqueue\_styles' ) ); |
| [42](#L42) | add\_action('admin\_enqueue\_scripts', array( $this, 'enqueue\_scripts' ), 99 ); |
| [43](#L43) | add\_action('wp\_ajax\_wp-extended-module-toggle',   array( $this, 'module\_toggle\_ajax') ); |
| [44](#L44) | add\_action('admin\_plugin\_top\_info', array( $this, 'wpext\_admin\_plugin\_top\_info' ), 100 ); |
| [45](#L45) |  |
| [46](#L46) | add\_filter( 'plugin\_action\_links\_' . WP\_EXTENDED\_PLUGIN\_BASE, array( $this,'add\_pro\_action\_links') ); |
| [47](#L47) | add\_action('wp\_ajax\_wpext\_reset\_plugin\_settings', array( $this, 'wpext\_reset\_plugin\_settings') ); |
| [48](#L48) | add\_action('wp\_ajax\_wpext\_admin\_menu\_favorite', array( $this, 'wpext\_admin\_menu\_favorite\_callback') ); |
| [49](#L49) | add\_action('wp\_ajax\_wpext\_show\_plugin\_menu', array( $this, 'wpext\_show\_plugin\_menu') ); |
| [50](#L50) |  |
| [51](#L51) | add\_action('wp\_ajax\_wpext\_import\_json\_data', array( $this, 'wpext\_import\_json\_data\_callback') ); |
| [52](#L52) | add\_action('wp\_ajax\_nopriv\_wpext\_import\_json\_data', array( $this, 'wpext\_import\_json\_data\_callback') ); |
| [53](#L53) |  |
| [54](#L54) | add\_action('wp\_ajax\_wpext\_export\_options\_to\_json', array( $this, 'wpext\_export\_options\_to\_json') ); |
| [55](#L55) | add\_action('wp\_ajax\_nopriv\_wpext\_export\_options\_to\_json', array( $this, 'wpext\_export\_options\_to\_json') ); |
| [56](#L56) | add\_filter('upload\_mimes', array( $this,'wpext\_allow\_json\_upload') ); |
| [57](#L57) |  |
| [58](#L58) | add\_action('wpext\_plugin\_top\_header', array( $this, 'wpext\_plugin\_top\_header' ), 100 ); |
| [59](#L59) | add\_action('wpext\_plugin\_footer', array( $this, 'wpext\_plugin\_footer' ), 100 ); |
| [60](#L60) | add\_action('wpext\_module\_save\_btn\_header', array( $this, 'wpext\_module\_save\_btn\_header' ), 100,1 ); |
| [61](#L61) |  |
| [62](#L62) | add\_action('wp\_ajax\_wpext\_active\_modules', array( $this, 'wpext\_active\_modules\_callback') ); |
| [63](#L63) | add\_action('wp\_ajax\_nopriv\_wpext\_active\_modules',   array( $this, 'wpext\_active\_modules\_callback') ); |
| [64](#L64) | } |
| [65](#L65) |  |
| [66](#L66) | public static function init(){ |
| [67](#L67) | static $instance = null; |
| [68](#L68) | if ( is\_null( $instance ) ) { |
| [69](#L69) | $instance = new Wp\_Extended\_admin( get\_called\_class(), WP\_EXTENDED\_VERSION ); |
| [70](#L70) | } |
| [71](#L71) | return $instance; |
| [72](#L72) | } // init |
| [73](#L73) |  |
| [74](#L74) | /\* |
| [75](#L75) | \* Register options, used by plugin |
| [76](#L76) | \*/ |
| [77](#L77) |  |
| [78](#L78) | public function options\_init(){ |
| [79](#L79) | register\_setting( 'wp-extended', self::OPTION\_MODULES, array( 'type' => 'array' ) ); |
| [80](#L80) | register\_setting( self::WPEXT\_CHECK\_LICENSE\_STSTUS, self::WPEXT\_CHECK\_LICENSE\_STSTUS,  array( 'type' => 'array' ) ); |
| [81](#L81) |  |
| [82](#L82) | } // options\_init |
| [83](#L83) |  |
| [84](#L84) |  |
| [85](#L85) | public function ver(){ |
| [86](#L86) | return $this->version; |
| [87](#L87) | } |
| [88](#L88) |  |
| [89](#L89) | /\*\* |
| [90](#L90) | \* Register the stylesheets for the admin area. |
| [91](#L91) | \* |
| [92](#L92) | \* @since    1.0.0 |
| [93](#L93) | \*/ |
| [94](#L94) | public function enqueue\_styles() { |
| [95](#L95) |  |
| [96](#L96) | /\*\* |
| [97](#L97) | \* This function is provided for demonstration purposes only. |
| [98](#L98) | \* |
| [99](#L99) | \* An instance of this class should be passed to the run() function |
| [100](#L100) | \* defined in wp\_extended\_Loader as all of the hooks are defined |
| [101](#L101) | \* in that particular class. |
| [102](#L102) | \* |
| [103](#L103) | \* The wp\_extended\_Loader will then create the relationship |
| [104](#L104) | \* between the defined hooks and the functions defined in this |
| [105](#L105) | \* class. |
| [106](#L106) | \*/ |
| [107](#L107) |  |
| [108](#L108) | $screen = get\_current\_screen(); |
| [109](#L109) |  |
| [110](#L110) | if( isset($\_GET['page']) && preg\_match( '/^wp-extended/', $\_GET['page'] )) { |
| [111](#L111) | wp\_enqueue\_style( 'wp-extended-bootstrap-css', plugin\_dir\_url( \_\_FILE\_\_ ) . "css/bootstrap.min.css", array(), WP\_EXTENDED\_VERSION ); |
| [112](#L112) |  |
| [113](#L113) | remove\_all\_actions('admin\_notices'); |
| [114](#L114) | } |
| [115](#L115) | add\_filter('admin\_body\_class', array($this,'wpext\_body\_class'), 1); |
| [116](#L116) | wp\_enqueue\_style( 'wp-extended-global', plugin\_dir\_url( \_\_FILE\_\_ ) . "css/wpext\_global\_admin.css", array(), WP\_EXTENDED\_VERSION); |
| [117](#L117) | wp\_enqueue\_style( 'wp-extended-css', plugin\_dir\_url( \_\_FILE\_\_ ) . "css/options.css" , array(), WP\_EXTENDED\_VERSION); |
| [118](#L118) |  |
| [119](#L119) | if ( get\_current\_screen()->id === 'plugins' ) { |
| [120](#L120) | wp\_enqueue\_script( 'wpext\_deactivation\_survey',plugin\_dir\_url( \_\_FILE\_\_ ) . 'js/deactivation-survey.js', array( |
| [121](#L121) | 'jquery' |
| [122](#L122) | ), WP\_EXTENDED\_VERSION ); |
| [123](#L123) |  |
| [124](#L124) | wp\_enqueue\_style( 'wpext\_deactivation\_survey', plugin\_dir\_url( \_\_FILE\_\_ ) . 'css/deactivation-survey.css', null, WP\_EXTENDED\_VERSION ); |
| [125](#L125) |  |
| [126](#L126) | add\_action( 'admin\_footer', [ $this, 'deactivation\_survey\_modal' ] ); |
| [127](#L127) | } |
| [128](#L128) | } |
| [129](#L129) |  |
| [130](#L130) |  |
| [131](#L131) | /\*\* |
| [132](#L132) | \* Plugin action links. |
| [133](#L133) | \* |
| [134](#L134) | \* Adds action links to the plugin list table |
| [135](#L135) | \* |
| [136](#L136) | \* Fired by `plugin\_action\_links` filter. |
| [137](#L137) | \* |
| [138](#L138) | \* @since 2.1.1 |
| [139](#L139) | \* @access public |
| [140](#L140) | \* |
| [141](#L141) | \* @param array $links An array of plugin action links. |
| [142](#L142) | \* |
| [143](#L143) | \* @return array An array of plugin action links. |
| [144](#L144) | \*/ |
| [145](#L145) | public function add\_pro\_action\_links ( $links ) { |
| [146](#L146) | $pro\_action\_links = array( |
| [147](#L147) | '<a href="https://wpextended.io/pricing" target="\_blank" |
| [148](#L148) | class="wpext-plugins-gopro" style=" color: #00947E !important; font-weight: 600; ">'.esc\_html\_\_( 'Go Pro', WP\_EXTENDED\_TEXT\_DOMAIN ).'</a>', |
| [149](#L149) | ); |
| [150](#L150) | return array\_merge( $links, $pro\_action\_links ); |
| [151](#L151) | } |
| [152](#L152) |  |
| [153](#L153) | /\*\* |
| [154](#L154) | \* Register the JavaScript for the admin area. |
| [155](#L155) | \* |
| [156](#L156) | \* @since    1.0.0 |
| [157](#L157) | \*/ |
| [158](#L158) | public function enqueue\_scripts() { |
| [159](#L159) |  |
| [160](#L160) | /\*\* |
| [161](#L161) | \* This function is provided for demonstration purposes only. |
| [162](#L162) | \* |
| [163](#L163) | \* An instance of this class should be passed to the run() function |
| [164](#L164) | \* defined in wp\_extended\_Loader as all of the hooks are defined |
| [165](#L165) | \* in that particular class. |
| [166](#L166) | \* |
| [167](#L167) | \* The wp\_extended\_Loader will then create the relationship |
| [168](#L168) | \* between the defined hooks and the functions defined in this |
| [169](#L169) | \* class. |
| [170](#L170) | \*/ |
| [171](#L171) |  |
| [172](#L172) | $screen = get\_current\_screen(); |
| [173](#L173) | wp\_enqueue\_script( 'wp\_extended-admin', plugin\_dir\_url( \_\_FILE\_\_ ) . 'js/wp\_extended-admin.js', |
| [174](#L174) | array( 'jquery' ), WP\_EXTENDED\_VERSION, false ); |
| [175](#L175) |  |
| [176](#L176) | $wpext\_extended\_obj  = array( |
| [177](#L177) | 'ajax\_url' => admin\_url( 'admin-ajax.php' ), |
| [178](#L178) | 'ajax\_nonce' => wp\_create\_nonce( 'extended\_obj' ), |
| [179](#L179) | ); |
| [180](#L180) | wp\_localize\_script( 'wp\_extended-admin', 'wpext\_extended\_obj', $wpext\_extended\_obj); |
| [181](#L181) |  |
| [182](#L182) | wp\_register\_script( 'wpext-edit-main-button',  plugin\_dir\_url( \_\_FILE\_\_ ) . 'js/edit-main-button.js', |
| [183](#L183) | array('wp-element', 'wp-edit-post','wp-plugins', 'wp-i18n' ),  WP\_EXTENDED\_VERSION,  true ); |
| [184](#L184) |  |
| [185](#L185) | $id = get\_the\_ID(); |
| [186](#L186) | $post = get\_post( $id ); |
| [187](#L187) | $p = array( |
| [188](#L188) | 'ID'          => $id, |
| [189](#L189) | 'post\_title'  => html\_entity\_decode( get\_the\_title($id) ), |
| [190](#L190) | 'post\_type'   => $post ? $post->post\_type : null, |
| [191](#L191) | 'post\_status' => $post ? $post->post\_status : null |
| [192](#L192) | ); |
| [193](#L193) | wp\_add\_inline\_script( 'wpext-edit-main-button', |
| [194](#L194) | 'const wpext\_post = ' . json\_encode( $p ), |
| [195](#L195) | 'before' ); |
| [196](#L196) |  |
| [197](#L197) | if( preg\_match( '/^(post|page)/', $screen->id ) ) { |
| [198](#L198) | wp\_enqueue\_script( 'wpext-edit-main-button' ); |
| [199](#L199) | wp\_enqueue\_style( 'wpext-main-button' ); |
| [200](#L200) | } |
| [201](#L201) |  |
| [202](#L202) | if( isset($\_GET['page']) && preg\_match( '/^wp-extended/', $\_GET['page'] )) { |
| [203](#L203) | wp\_enqueue\_script( 'wp-extended-bootstrap-js', plugin\_dir\_url( \_\_FILE\_\_ ) ."js/bootstrap.bundle.min.js", array(), WP\_EXTENDED\_VERSION ); |
| [204](#L204) | } |
| [205](#L205) |  |
| [206](#L206) | } |
| [207](#L207) | public function menu(){ |
| [208](#L208) | add\_menu\_page( |
| [209](#L209) | \_\_('WP Extended Settings', WP\_EXTENDED\_TEXT\_DOMAIN ), |
| [210](#L210) | \_\_('WP Extended', WP\_EXTENDED\_TEXT\_DOMAIN ), |
| [211](#L211) | 'manage\_options', |
| [212](#L212) | 'wp-extended', |
| [213](#L213) | array( $this, 'admin\_display' ) , |
| [214](#L214) | 'data:image/svg+xml;base64,' . base64\_encode('<svg version="1.0" xmlns="http://www.w3.org/2000/svg" |
| [215](#L215) | width="50.000000pt" height="50.000000pt" viewBox="0 0 500.000000 500.000000" |
| [216](#L216) | preserveAspectRatio="xMidYMid meet"><g transform="translate(0.000000,500.000000) scale(0.100000,-0.100000)" |
| [217](#L217) | fill="#2e47a7" stroke="none"><path d="M1335 4865 c-631 -100 -1104 -577 -1201 -1210 -20 -132 -20 -2178 0 |
| [218](#L218) | -2310 98 -638 573 -1113 1211 -1211 72 -11 300 -14 1155 -14 1115 0 1140 1 |
| [219](#L219) | 1310 44 496 127 899 530 1026 1026 43 170 44 195 44 1310 0 855 -3 1083 -14 |
| [220](#L220) | 1155 -98 638 -573 1113 -1211 1211 -126 19 -2198 18 -2320 -1z m1655 -938 |
| [221](#L221) | c220 -65 398 -244 455 -457 9 -32 15 -101 15 -167 0 -92 -4 -126 -25 -192 -31 |
| [222](#L222) | -98 -105 -211 -183 -281 -65 -58 -209 -133 -290 -149 -33 -7 -205 -11 -455 |
| [223](#L223) | -11 -325 0 -414 3 -467 16 -215 50 -400 229 -466 449 -25 83 -25 258 0 340 76 |
| [224](#L224) | 252 281 431 535 466 31 4 229 6 441 5 320 -3 394 -6 440 -19z m-30 -1613 c215 |
| [225](#L225) | -50 400 -228 466 -449 13 -43 18 -92 18 -175 0 -102 -4 -125 -30 -200 -61 |
| [226](#L226) | -174 -182 -305 -348 -380 -118 -53 -139 -55 -576 -55 -452 0 -460 1 -599 67 |
| [227](#L227) | -157 75 -291 237 -336 408 -9 32 -15 101 -15 167 0 92 4 126 25 192 31 98 105 |
| [228](#L228) | 211 183 281 64 57 193 126 274 145 83 21 851 20 938 -1z"/><path d="M2097 3689 c-90 -21 -178 -83 -232 -164 -50 -77 -68 -141 -63 -239 8 |
| [229](#L229) | -186 141 -336 324 -366 95 -16 706 -12 784 4 247 53 380 320 273 547 -50 108 |
| [230](#L230) | -142 184 -258 215 -58 16 -763 18 -828 3z m201 -168 c50 -25 109 -93 122 -140 |
| [231](#L231) | 34 -123 -26 -251 -140 -299 -53 -22 -141 -18 -195 9 -145 73 -179 264 -67 382 |
| [232](#L232) | 72 76 187 95 280 48z"/><path d="M2085 2075 c-242 -53 -374 -321 -268 -546 34 -74 105 -150 172 -183 |
| [233](#L233) | 87 -44 131 -48 536 -44 l380 3 58 27 c80 38 128 78 172 143 50 77 68 141 63 |
| [234](#L234) | 239 -8 186 -141 336 -324 366 -92 15 -716 11 -789 -5z m834 -168 c111 -54 161 |
| [235](#L235) | -194 110 -307 -43 -96 -117 -144 -219 -144 -79 0 -131 24 -184 86 -117 136 |
| [236](#L236) | -40 354 136 387 56 10 103 4 157 -22z"/></g></svg>'), |
| [237](#L237) | ); |
| [238](#L238) | add\_submenu\_page( |
| [239](#L239) | 'wp-extended', |
| [240](#L240) | \_\_('Modules', WP\_EXTENDED\_TEXT\_DOMAIN ),\_\_('Modules', WP\_EXTENDED\_TEXT\_DOMAIN ),'manage\_options','wp-extended'); |
| [241](#L241) | } |
| [242](#L242) |  |
| [243](#L243) | /\* |
| [244](#L244) | \* Display admin page |
| [245](#L245) | \*/ |
| [246](#L246) | public function admin\_display(){ |
| [247](#L247) | add\_action('wpext\_module\_save\_btn\_header', array( $this, 'wpext\_module\_save\_btn\_header' ), 10,1 ); |
| [248](#L248) |  |
| [249](#L249) | $groups = $this->groups(); |
| [250](#L250) | $modules = $this->modules(); |
| [251](#L251) |  |
| [252](#L252) | include \_\_DIR\_\_ . '/partials/wp-extend-admin-display.php'; |
| [253](#L253) | } // admin\_display |
| [254](#L254) |  |
| [255](#L255) | /\* |
| [256](#L256) | \* AJAX endpoint for module activation |
| [257](#L257) | \*/ |
| [258](#L258) | public function module\_toggle\_ajax() { |
| [259](#L259) | // Verify the nonce |
| [260](#L260) | check\_ajax\_referer('extended\_obj', 'nonce'); |
| [261](#L261) |  |
| [262](#L262) | $module = isset($\_POST['module']) ? $\_POST['module'] : null; |
| [263](#L263) | $status = isset($\_POST['status']) ? (bool) $\_POST['status'] : false; |
| [264](#L264) |  |
| [265](#L265) | // Toggle the module |
| [266](#L266) | $result = $this->module\_toggle($module, $status); |
| [267](#L267) |  |
| [268](#L268) | wp\_send\_json($result); |
| [269](#L269) |  |
| [270](#L270) | wp\_die(); |
| [271](#L271) | } |
| [272](#L272) |  |
| [273](#L273) | // module\_toggle\_ajax |
| [274](#L274) | /\*\* |
| [275](#L275) | \* Activate single module |
| [276](#L276) | \*/ |
| [277](#L277) | public function module\_toggle( $module = null, $new\_status = false ){ |
| [278](#L278) | $tmp = plugin\_dir\_path( \_\_FILE\_\_ ) . '\_\_saving\_options.tmp'; |
| [279](#L279) |  |
| [280](#L280) | try { |
| [281](#L281) | if( !current\_user\_can('manage\_options') ) { |
| [282](#L282) | throw new \Exception( "Not allowed" ); |
| [283](#L283) | } |
| [284](#L284) |  |
| [285](#L285) | if( empty($module) ) { |
| [286](#L286) | throw new \Exception( "Module not specified" ); |
| [287](#L287) | } |
| [288](#L288) | $exists = $this->module( $module ); |
| [289](#L289) |  |
| [290](#L290) | if( !$exists ) { |
| [291](#L291) | throw new \Exception( "Module does not exists") ; |
| [292](#L292) | } |
| [293](#L293) |  |
| [294](#L294) | // check tmp file for existing over 30s |
| [295](#L295) | if( file\_exists( $tmp ) && time() - filemtime( $tmp ) >= 30 ) { |
| [296](#L296) | @unlink( $tmp ); |
| [297](#L297) | } |
| [298](#L298) |  |
| [299](#L299) | $n = 0; |
| [300](#L300) | while( file\_exists( $tmp ) ) { |
| [301](#L301) | // wait for other process to end |
| [302](#L302) | usleep( 250 ); |
| [303](#L303) |  |
| [304](#L304) | if( $n > 20 ) { |
| [305](#L305) | throw new \Exception( "Operation timeout" ); |
| [306](#L306) | } |
| [307](#L307) |  |
| [308](#L308) | $n++; |
| [309](#L309) | }; |
| [310](#L310) |  |
| [311](#L311) | // create file to show that option is in-use |
| [312](#L312) | @touch( $tmp ); |
| [313](#L313) |  |
| [314](#L314) | try { |
| [315](#L315) | global $wpdb; |
| [316](#L316) | $row = $wpdb->get\_row( |
| [317](#L317) | $wpdb->prepare( "SELECT option\_value FROM $wpdb->options WHERE option\_name = %s LIMIT 1", self::OPTION\_MODULES ) |
| [318](#L318) | ); |
| [319](#L319) |  |
| [320](#L320) | $option = null; |
| [321](#L321) | if ( is\_object( $row ) ) { |
| [322](#L322) | $option = maybe\_unserialize( $row->option\_value ); |
| [323](#L323) | } |
| [324](#L324) |  |
| [325](#L325) | if( empty($option) ) { |
| [326](#L326) | $option = array(); |
| [327](#L327) | } |
| [328](#L328) |  |
| [329](#L329) | // $option = get\_option( self::OPTION\_MODULES, array() ); |
| [330](#L330) |  |
| [331](#L331) | $status = isset($option[ $module ]) ? $option[ $module ] : false; |
| [332](#L332) |  |
| [333](#L333) | if( $status === $new\_status ) { |
| [334](#L334) | throw new \Exception( "Module is already " . ( $new\_status ? 'active' : 'inactive' ) ); |
| [335](#L335) | } |
| [336](#L336) |  |
| [337](#L337) | // SET NEW STATUS |
| [338](#L338) | $option[ $module ] = $new\_status; |
| [339](#L339) |  |
| [340](#L340) | $updated = update\_option( self::OPTION\_MODULES, $option ); |
| [341](#L341) |  |
| [342](#L342) | if( !$updated ) { |
| [343](#L343) | throw new \Exception( "Failed to update database record" ); |
| [344](#L344) | } |
| [345](#L345) | } |
| [346](#L346) | catch( \Exception $e ) { |
| [347](#L347) | @unlink( $tmp ); |
| [348](#L348) |  |
| [349](#L349) | throw new \Exception( $e->getMessage() ); |
| [350](#L350) | } |
| [351](#L351) |  |
| [352](#L352) | @unlink( $tmp ); |
| [353](#L353) |  |
| [354](#L354) | $result = array( |
| [355](#L355) | 'status'        => true, |
| [356](#L356) | 'module\_status' => $this->module\_status( $module ), |
| [357](#L357) | 'module\_info'   => $exists, |
| [358](#L358) | 'n' => $n |
| [359](#L359) | ); |
| [360](#L360) |  |
| [361](#L361) |  |
| [362](#L362) | // check if there's an activation/deactivation script |
| [363](#L363) | try { |
| [364](#L364) | $hook = $new\_status ? '\_\_activate' : '\_\_deactivate'; |
| [365](#L365) |  |
| [366](#L366) | $dir = $this->folder\_modules(); |
| [367](#L367) | $path = $dir . $exists['group'] . "/" . $exists['dirname'] . "/" . $hook . ".php"; |
| [368](#L368) |  |
| [369](#L369) | if( is\_file( $path ) ) { |
| [370](#L370) | require\_once( $path ); |
| [371](#L371) | $result['module' . $hook ] = true; |
| [372](#L372) | } |
| [373](#L373) | } |
| [374](#L374) | catch( \Exception $e ) { |
| [375](#L375) | $result['module' . $hook ] = $e->getMessage(); |
| [376](#L376) | } |
| [377](#L377) |  |
| [378](#L378) | } |
| [379](#L379) | catch( \Exception $e ) { |
| [380](#L380) | $result = array( |
| [381](#L381) | 'status' => false, |
| [382](#L382) | 'error' => \_\_( $e->getMessage(), WP\_EXTENDED\_TEXT\_DOMAIN ) |
| [383](#L383) | ); |
| [384](#L384) | } |
| [385](#L385) |  |
| [386](#L386) | $result['module'] = $module; |
| [387](#L387) |  |
| [388](#L388) | return $result; |
| [389](#L389) | } // module\_status\_set |
| [390](#L390) |  |
| [391](#L391) | /\* Feedback and upgrade button \*/ |
| [392](#L392) |  |
| [393](#L393) | public function wpext\_admin\_plugin\_top\_info(){ |
| [394](#L394) | include\_once \_\_DIR\_\_ . "/partials/wp-extend-top-info.php"; |
| [395](#L395) | } |
| [396](#L396) |  |
| [397](#L397) | public function wpext\_body\_class($classes){ |
| [398](#L398) | $classes = 'wpext-base'; |
| [399](#L399) | return $classes; |
| [400](#L400) | } |
| [401](#L401) |  |
| [402](#L402) | public function deactivation\_survey\_modal(){ |
| [403](#L403) |  |
| [404](#L404) | $current\_user = wp\_get\_current\_user(); |
| [405](#L405) | $email = (string) $current\_user->user\_email; |
| [406](#L406) |  |
| [407](#L407) | echo '<div class="wpext-deactivation-survey container is-fluid css-wp-extend"> |
| [408](#L408) | <div class="wpext-survey-inner columns"> |
| [409](#L409) | <div class="column is-two-thirds-widescreen"> |
| [410](#L410) | <div class="box"> |
| [411](#L411) | <div class="wp-ext\_heading"> |
| [412](#L412) | <h3 class="title is-4">' . \_\_( 'Sorry to see you go!', WP\_EXTENDED\_TEXT\_DOMAIN ) . '</h3> |
| [413](#L413) | <p class="heading-text">' . sprintf( \_\_( 'We would appreciate if you let us know why you\'re deactivating WP Extended.', WP\_EXTENDED\_TEXT\_DOMAIN ), WP\_EXTENDED\_TEXT\_DOMAIN ) . '</p> |
| [414](#L414) | </div> |
| [415](#L415) | <form action="" method="POST" class="feedback-form"> |
| [416](#L416) | <label class="feedback-lable"> |
| [417](#L417) | <input type="radio" name="wpext\_reason" value="I no longer use this plugin" /> |
| [418](#L418) | ' . \_\_( 'I no longer use this plugin.', WP\_EXTENDED\_TEXT\_DOMAIN ) . ' |
| [419](#L419) | </label> |
| [420](#L420) | <label class="feedback-lable"> |
| [421](#L421) | <input type="radio" name="wpext\_reason" value="The plugin caused my site to crash" /> |
| [422](#L422) | ' . \_\_( 'The plugin caused my site to crash.', WP\_EXTENDED\_TEXT\_DOMAIN) . ' |
| [423](#L423) | </label> |
| [424](#L424) | <label class="feedback-lable"> |
| [425](#L425) | <input type="radio" name="wpext\_reason" value="The plugin caused errors and conflicts with other plugins" /> |
| [426](#L426) | ' . \_\_( 'The plugin caused errors and conflicts with other plugins.', WP\_EXTENDED\_TEXT\_DOMAIN ) . ' |
| [427](#L427) | </label> |
| [428](#L428) | <label class="feedback-lable"> |
| [429](#L429) | <input type="radio" name="wpext\_reason" value="I found a better solution" /> |
| [430](#L430) | ' . \_\_( 'I found a better solution.', WP\_EXTENDED\_TEXT\_DOMAIN) . ' |
| [431](#L431) | </label> |
| [432](#L432) | <label class="feedback-lable"> |
| [433](#L433) | <input type="radio" name="wpext\_reason" value="I am temporarily disabling the plugin" /> |
| [434](#L434) | ' . \_\_( 'I am temporarily disabling the plugin.', WP\_EXTENDED\_TEXT\_DOMAIN) . ' |
| [435](#L435) | </label> |
| [436](#L436) | <label class="other\_issues"> |
| [437](#L437) | <input type="radio" name="wpext\_reason" value="Other" /> |
| [438](#L438) | ' . \_\_( 'Other (Please tell us more)', WP\_EXTENDED\_TEXT\_DOMAIN ) . ' |
| [439](#L439) | </label> |
| [440](#L440) | <label class="other-issues-textarea" style="display:none;"> |
| [441](#L441) | <textarea name="wpext\_deactivation\_description" class="widefat" placeholder="' . \_\_( 'Details (optional)', WP\_EXTENDED\_TEXT\_DOMAIN ) . '"></textarea> |
| [442](#L442) | </label> |
| [443](#L443) | <input type="hidden" name="wpext\_site\_url" value="' . site\_url() . '" /> |
| [444](#L444) | <input type="hidden" name="wpext\_version" value="' . WP\_EXTENDED\_VERSION . '" /> |
| [445](#L445) | <div class="wpext-uninstall-feedback-privacy-policy"> |
| [446](#L446) | We do not collect any personal data when you submit this form. It\'s your feedback that we value. |
| [447](#L447) | <a href="https://wpextended.io/privacy-policy/" target="\_blank">'.\_\_('Privacy Policy', WP\_EXTENDED\_TEXT\_DOMAIN ).'</a> |
| [448](#L448) | </div> |
| [449](#L449) | <hr> |
| [450](#L450) | <div class="wpext-deactivate-buttons-wrapper"> |
| [451](#L451) | <button class="button button-primary submit-and-deactivate" disabled="disabled">' . \_\_( 'Submit & Deactivate', WP\_EXTENDED\_TEXT\_DOMAIN ) . '</button> |
| [452](#L452) | <button class="button button-secondary deactivate-plugin" type="button">' . \_\_( 'Skip & Deactivate', WP\_EXTENDED\_TEXT\_DOMAIN) . '</button> |
| [453](#L453) | <button class="button button-secondary cancel-deactivation-survey" type="button">' . \_\_( 'Cancel', WP\_EXTENDED\_TEXT\_DOMAIN) . '</button> |
| [454](#L454) | </div> |
| [455](#L455) | </form> |
| [456](#L456) | </div> |
| [457](#L457) | </div> |
| [458](#L458) | </div> |
| [459](#L459) | </div>'; |
| [460](#L460) |  |
| [461](#L461) | } |
| [462](#L462) |  |
| [463](#L463) | /\* Storing action for reset data via ajax\*/ |
| [464](#L464) | public function wpext\_reset\_plugin\_settings() { |
| [465](#L465) | check\_ajax\_referer('extended\_obj', 'nonce'); |
| [466](#L466) |  |
| [467](#L467) | // Check user capability |
| [468](#L468) | if (!current\_user\_can('manage\_options')) { |
| [469](#L469) | wp\_send\_json\_error(\_\_('Unauthorized access.', WP\_EXTENDED\_TEXT\_DOMAIN), 403); |
| [470](#L470) | wp\_die(); |
| [471](#L471) | } |
| [472](#L472) |  |
| [473](#L473) | $status = sanitize\_text\_field($\_POST['status']); |
| [474](#L474) | $response = array(); |
| [475](#L475) | if (!empty($status)) { |
| [476](#L476) | update\_option('wpext\_plugin\_reset\_action', $status); |
| [477](#L477) | if ($status == 'true') { |
| [478](#L478) | $message = \_\_('Delete all plugin data <strong>Activated</strong>', WP\_EXTENDED\_TEXT\_DOMAIN); |
| [479](#L479) | } else { |
| [480](#L480) | $message = \_\_('Delete all plugin data <strong>Deactivated</strong>', WP\_EXTENDED\_TEXT\_DOMAIN); |
| [481](#L481) | } |
| [482](#L482) | $response['status'] = $status; |
| [483](#L483) | $response['message'] = $message; |
| [484](#L484) | } else { |
| [485](#L485) | $response['status'] = 'false'; |
| [486](#L486) | $response['message'] = \_\_('Status not provided', WP\_EXTENDED\_TEXT\_DOMAIN); |
| [487](#L487) | } |
| [488](#L488) | wp\_send\_json(json\_encode($response)); |
| [489](#L489) | die; |
| [490](#L490) | } |
| [491](#L491) |  |
| [492](#L492) |  |
| [493](#L493) | public function wpext\_show\_plugin\_menu(){ |
| [494](#L494) | check\_ajax\_referer('extended\_obj', 'nonce'); |
| [495](#L495) | if (!current\_user\_can('manage\_options')) { |
| [496](#L496) | wp\_send\_json\_error(\_\_('Unauthorized access.', WP\_EXTENDED\_TEXT\_DOMAIN), 403); |
| [497](#L497) | wp\_die(); |
| [498](#L498) | } |
| [499](#L499) |  |
| [500](#L500) | $status = sanitize\_text\_field($\_POST['status']); |
| [501](#L501) | $response = array(); |
| [502](#L502) | if (!empty($status)) { |
| [503](#L503) | update\_option('wpext\_show\_plugin\_menu\_action', $status); |
| [504](#L504) | if ($status == 'true') { |
| [505](#L505) | $message = \_\_('Show plugin menu <strong>Activated</strong>', WP\_EXTENDED\_TEXT\_DOMAIN); |
| [506](#L506) |  |
| [507](#L507) | $current\_data = get\_option('wpext\_admin\_menu\_favorite'); |
| [508](#L508) |  |
| [509](#L509) | // Check if all values are false |
| [510](#L510) | if (empty($current\_data)) { |
| [511](#L511) | $favArrValue = Array ( |
| [512](#L512) | 'wpext\_admin\_columns' => 'true', |
| [513](#L513) | 'wpext\_admin\_color\_picker' => 'true', |
| [514](#L514) | 'wpext\_duplicate\_menu' => 'true', |
| [515](#L515) | 'wpext\_snippets' => 'true', |
| [516](#L516) | 'wpext\_pixel\_tag\_manager' => 'true', |
| [517](#L517) | 'wpext\_smtp\_email' => 'true', |
| [518](#L518) | 'wpext\_block\_user\_name\_admin' => 'true', |
| [519](#L519) | 'wpext\_change\_wp\_admin\_url' => 'true', |
| [520](#L520) | 'wpext\_hide\_notices' => 'true', |
| [521](#L521) | 'wpext\_limit\_login\_attempts' => 'true', |
| [522](#L522) | 'wpext\_maintenance\_mode' => 'true', |
| [523](#L523) | 'wpext\_external\_permalinks' => 'true', |
| [524](#L524) | 'wpext\_post\_order' => 'true', |
| [525](#L525) | 'wpext\_user\_sections' => 'true', |
| [526](#L526) | 'wpext\_quick\_image\_replace' => 'true', |
| [527](#L527) | 'wpext\_disable\_dashboard\_widget' => 'true', |
| [528](#L528) | 'wpext\_disable\_gutenberg' => 'true', |
| [529](#L529) | 'wpext\_hide\_admin\_bar' => 'true', |
| [530](#L530) | 'wpext\_tidy\_nav' => 'true'); |
| [531](#L531) |  |
| [532](#L532) | // Store updated data in the database |
| [533](#L533) | update\_option('wpext\_admin\_menu\_favorite', $favArrValue); |
| [534](#L534) | } |
| [535](#L535) |  |
| [536](#L536) | } else { |
| [537](#L537) | $message = \_\_('Show plugin menu <strong>Deactivated</strong>', WP\_EXTENDED\_TEXT\_DOMAIN); |
| [538](#L538) | $current\_data = ""; |
| [539](#L539) | } |
| [540](#L540) | $response['status'] = $status; |
| [541](#L541) | $response['message'] = $message; |
| [542](#L542) | $response['favorite\_data'] = $current\_data; |
| [543](#L543) | } else { |
| [544](#L544) | $response['status'] = 'false'; |
| [545](#L545) | $response['message'] = \_\_('Status not provided', WP\_EXTENDED\_TEXT\_DOMAIN); |
| [546](#L546) | } |
| [547](#L547) | wp\_send\_json(json\_encode($response)); |
| [548](#L548) | die; |
| [549](#L549) | } |
| [550](#L550) |  |
| [551](#L551) | public function wpext\_admin\_menu\_favorite\_callback(){ |
| [552](#L552) | check\_ajax\_referer('extended\_obj', 'nonce'); |
| [553](#L553) | if (!current\_user\_can('manage\_options')) { |
| [554](#L554) | wp\_send\_json\_error(\_\_('Unauthorized access.', WP\_EXTENDED\_TEXT\_DOMAIN), 403); |
| [555](#L555) | wp\_die(); |
| [556](#L556) | } |
| [557](#L557) |  |
| [558](#L558) | $status = sanitize\_text\_field($\_POST['status']); |
| [559](#L559) | $dataSlug = sanitize\_text\_field($\_POST['dataSlug']); |
| [560](#L560) | $dataName = sanitize\_text\_field($\_POST['dataName']); |
| [561](#L561) |  |
| [562](#L562) | $response = array(); |
| [563](#L563) | if (!empty($dataSlug)) { |
| [564](#L564) | $current\_data = get\_option('wpext\_admin\_menu\_favorite'); |
| [565](#L565) | // If the option doesn't exist or is not an array, initialize an empty array |
| [566](#L566) | if (!is\_array($current\_data)) { |
| [567](#L567) | $current\_data = array(); |
| [568](#L568) | } |
| [569](#L569) |  |
| [570](#L570) | // Check if the key already exists |
| [571](#L571) | if (array\_key\_exists($dataSlug, $current\_data)) { |
| [572](#L572) | $current\_data[$dataSlug] = $status; |
| [573](#L573) | } else { |
| [574](#L574) | $current\_data[$dataSlug] = $status; |
| [575](#L575) | } |
| [576](#L576) | update\_option('wpext\_admin\_menu\_favorite', $current\_data); |
| [577](#L577) |  |
| [578](#L578) | if ($status == 'true') { |
| [579](#L579) | $message = \_\_('Favourites '.$dataName.' Submenu <strong>Activated</strong>', WP\_EXTENDED\_TEXT\_DOMAIN); |
| [580](#L580) | } else { |
| [581](#L581) | $message = \_\_('Favourites '.$dataName.' Submenu <strong>Deactivated</strong>', WP\_EXTENDED\_TEXT\_DOMAIN); |
| [582](#L582) | } |
| [583](#L583) | $response['message'] = $message; |
| [584](#L584) | } else { |
| [585](#L585) | $response['message'] = \_\_('Status not provided', WP\_EXTENDED\_TEXT\_DOMAIN); |
| [586](#L586) | } |
| [587](#L587) | wp\_send\_json(json\_encode($response)); |
| [588](#L588) | die; |
| [589](#L589) | } |
| [590](#L590) |  |
| [591](#L591) | /\*\* Import setting via JSON file \*\*/ |
| [592](#L592) | /\*\* Function for Import all plugin setting \*\*/ |
| [593](#L593) | public function wpext\_import\_json\_data\_callback() { |
| [594](#L594) | check\_ajax\_referer('extended\_obj', 'security'); |
| [595](#L595) | if (!current\_user\_can('manage\_options')) { |
| [596](#L596) | wp\_send\_json\_error(\_\_('Unauthorized access.', WP\_EXTENDED\_TEXT\_DOMAIN), 403); |
| [597](#L597) | wp\_die(); |
| [598](#L598) | } |
| [599](#L599) | $response = array(); |
| [600](#L600) | if (!empty($\_FILES['file\_data']['name'])) { |
| [601](#L601) | $uploaded\_file = $\_FILES['file\_data']; |
| [602](#L602) | $file\_extension = pathinfo($\_FILES['file\_data']['name'], PATHINFO\_EXTENSION); |
| [603](#L603) | if ($file\_extension != 'json') { |
| [604](#L604) | $response['message'] = \_\_('Please upload a JSON file.', WP\_EXTENDED\_TEXT\_DOMAIN); |
| [605](#L605) | } |
| [606](#L606) | $file = wp\_handle\_upload($uploaded\_file, array('test\_form' => false)); |
| [607](#L607) | if ($file && !isset($file['error'])) { |
| [608](#L608) | $file\_url = $file['file']; |
| [609](#L609) | $json\_data = file\_get\_contents($file\_url); |
| [610](#L610) | $decoded\_data = json\_decode($json\_data, true); |
| [611](#L611) | if ($decoded\_data !== null) { |
| [612](#L612) | foreach ($decoded\_data as $key => $value) { |
| [613](#L613) | if (strpos($key, 'wp-extended') === 0 || strpos($key, 'wpext') === 0) { |
| [614](#L614) | update\_option($key, $value); |
| [615](#L615) | //snippet data |
| [616](#L616) | if($key == 'wpext-snippets'){ |
| [617](#L617) | foreach ($value as $snippet) { |
| [618](#L618) | // Prepare post data |
| [619](#L619) | $post\_data = array( |
| [620](#L620) | 'post\_title'    => $snippet['label'], |
| [621](#L621) | 'post\_content'  => $snippet['code'], |
| [622](#L622) | 'post\_status'   => 'publish', |
| [623](#L623) | 'post\_type'     => 'snippet', |
| [624](#L624) | ); |
| [625](#L625) |  |
| [626](#L626) | // Insert the post into the database |
| [627](#L627) | $post\_id = wp\_insert\_post($post\_data); |
| [628](#L628) |  |
| [629](#L629) | // Check for errors |
| [630](#L630) | if (is\_wp\_error($post\_id)) { |
| [631](#L631) | // Handle the error |
| [632](#L632) | echo 'Error: ' . $post\_id->get\_error\_message(); |
| [633](#L633) | continue; |
| [634](#L634) | } |
| [635](#L635) |  |
| [636](#L636) | // Add post meta data |
| [637](#L637) | add\_post\_meta($post\_id, 'snippet\_position', $snippet['position']); |
| [638](#L638) | add\_post\_meta($post\_id, 'snippet\_code\_type', $snippet['code\_type']); |
| [639](#L639) | $snippet\_active = $snippet['active']; |
| [640](#L640) | if($snippet['code\_type'] == 'PHP'){ |
| [641](#L641) | $snippet\_active = 0; |
| [642](#L642) | } |
| [643](#L643) | add\_post\_meta($post\_id, 'snippet\_active', $snippet\_active); |
| [644](#L644) | add\_post\_meta($post\_id, 'snippet\_code\_sesc', $snippet['description']); |
| [645](#L645) | } |
| [646](#L646) | } |
| [647](#L647) | } |
| [648](#L648) | } |
| [649](#L649) | $response['success'] = \_\_('Data imported successfully!', WP\_EXTENDED\_TEXT\_DOMAIN); |
| [650](#L650) | } else { |
| [651](#L651) | $response['message'] = \_\_('Invalid JSON format', WP\_EXTENDED\_TEXT\_DOMAIN); |
| [652](#L652) | } |
| [653](#L653) | } else { |
| [654](#L654) | $response['message'] = \_\_('Error uploading file.', WP\_EXTENDED\_TEXT\_DOMAIN); |
| [655](#L655) | } |
| [656](#L656) | } else { |
| [657](#L657) | $response['message'] = \_\_('Please choose a file to import proceed', WP\_EXTENDED\_TEXT\_DOMAIN); |
| [658](#L658) | } |
| [659](#L659) | wp\_send\_json(json\_encode($response)); |
| [660](#L660) | wp\_die(); |
| [661](#L661) | } |
| [662](#L662) |  |
| [663](#L663) | /\*\* Function for Import all plugin setting \*\*/ |
| [664](#L664) | public function wpext\_export\_options\_to\_json() { |
| [665](#L665) | check\_ajax\_referer('extended\_obj', 'security'); |
| [666](#L666) | if (!current\_user\_can('manage\_options')) { |
| [667](#L667) | wp\_send\_json\_error(\_\_('Unauthorized access.', WP\_EXTENDED\_TEXT\_DOMAIN), 403); |
| [668](#L668) | wp\_die(); |
| [669](#L669) | } |
| [670](#L670) | // Array of option names you want to export |
| [671](#L671) | $response = array(); |
| [672](#L672) | $option\_names = [ |
| [673](#L673) | 'wp-extended-modules', |
| [674](#L674) | 'wpext\_pixel\_tag\_manager', |
| [675](#L675) | 'wpext\_plugin\_and\_theme\_rollback', |
| [676](#L676) | 'wpext\_block\_user\_name\_admin', |
| [677](#L677) | 'wpext\_change\_wp\_admin\_url', |
| [678](#L678) | 'wpext\_disable\_user\_numeration', |
| [679](#L679) | 'wpext\_hide\_the\_wordPress\_version', |
| [680](#L680) | 'wpext-hide\_admin\_bar', |
| [681](#L681) | 'wpext\_last\_login\_status', |
| [682](#L682) | 'wpext\_maintenance\_mode', |
| [683](#L683) | 'wpext-maintanance\_mode', |
| [684](#L684) | 'wpext\_limit\_login\_attempts', |
| [685](#L685) | 'wpext\_disable\_dashboard\_widget', |
| [686](#L686) | 'wpext\_post\_order', |
| [687](#L687) | 'wpext\_disable\_widgets\_gutenberg', |
| [688](#L688) | 'wpext\_disable\_gutenberg', |
| [689](#L689) | 'wpext-post-type-order', |
| [690](#L690) | 'wpext-external-permalink-url', |
| [691](#L691) | 'wpext\_login\_url', |
| [692](#L692) | 'wpext-user-sections', |
| [693](#L693) | 'wpext\_indexing\_notice' |
| [694](#L694) | ]; |
| [695](#L695) | $status = sanitize\_text\_field($\_POST['status']); |
| [696](#L696) | if(!empty($status) && $status == 'true'){ |
| [697](#L697) | $option\_snippet = ['wpext-snippets']; |
| [698](#L698) | $option\_names = array\_merge($option\_names, $option\_snippet); |
| [699](#L699) | } |
| [700](#L700) | $options = array(); |
| [701](#L701) | foreach ($option\_names as $name) { |
| [702](#L702) |  |
| [703](#L703) | if($name == 'wpext-snippets'){ |
| [704](#L704) | $args = array( |
| [705](#L705) | 'post\_type'      => 'snippet', |
| [706](#L706) | 'posts\_per\_page' => -1, |
| [707](#L707) | ); |
| [708](#L708) |  |
| [709](#L709) | $query = new WP\_Query($args); |
| [710](#L710) |  |
| [711](#L711) | if ($query->have\_posts()) { |
| [712](#L712) | while ($query->have\_posts()) { $query->the\_post(); |
| [713](#L713) | $post\_id = get\_the\_ID(); |
| [714](#L714) | $title = get\_the\_title(); |
| [715](#L715) | $content = get\_the\_content(); |
| [716](#L716) |  |
| [717](#L717) | // Get the custom meta data |
| [718](#L718) | $snippet\_position   = get\_post\_meta($post\_id, 'snippet\_position', true); |
| [719](#L719) | $snippet\_code\_type  = get\_post\_meta($post\_id, 'snippet\_code\_type', true); |
| [720](#L720) | $snippet\_active     = get\_post\_meta($post\_id, 'snippet\_active', true); |
| [721](#L721) | $snippet\_code\_sesc  = get\_post\_meta($post\_id, 'snippet\_code\_sesc', true); |
| [722](#L722) |  |
| [723](#L723) | // Prepare the snippet data |
| [724](#L724) | $snippet\_data = array( |
| [725](#L725) | 'code'     => $content, |
| [726](#L726) | 'label'    => $title, |
| [727](#L727) | 'position' => $snippet\_position, |
| [728](#L728) | 'code\_type' => $snippet\_code\_type, |
| [729](#L729) | 'active' => $snippet\_active, |
| [730](#L730) | 'description' => $snippet\_code\_sesc |
| [731](#L731) | ); |
| [732](#L732) |  |
| [733](#L733) | // Store the snippet data in the options array |
| [734](#L734) | $options['wpext-snippets'][] = $snippet\_data; |
| [735](#L735) | } |
| [736](#L736) | } |
| [737](#L737) |  |
| [738](#L738) | // Restore original snippet Data |
| [739](#L739) | wp\_reset\_postdata(); |
| [740](#L740) |  |
| [741](#L741) | }else{ |
| [742](#L742) | $option\_value = get\_option($name); |
| [743](#L743) | if (is\_array($option\_value)) { |
| [744](#L744) | $options[$name] = $option\_value; |
| [745](#L745) | } else { |
| [746](#L746) | $options[$name] = maybe\_unserialize($option\_value); |
| [747](#L747) | } |
| [748](#L748) | } |
| [749](#L749) | } |
| [750](#L750) | if (!empty($options)) { |
| [751](#L751) | $json\_data = json\_encode($options, JSON\_PRETTY\_PRINT); |
| [752](#L752) | header('Content-disposition: attachment; filename=options\_export.json'); |
| [753](#L753) | header('Content-type: application/json'); |
| [754](#L754) | echo $json\_data; |
| [755](#L755) | } else { |
| [756](#L756) | \_e('No options found for export.', WP\_EXTENDED\_TEXT\_DOMAIN); |
| [757](#L757) | } |
| [758](#L758) | wp\_die(); |
| [759](#L759) | } |
| [760](#L760) | public function wpext\_allow\_json\_upload($mimes) { |
| [761](#L761) | $mimes['json'] = 'application/json'; |
| [762](#L762) | return $mimes; |
| [763](#L763) | } |
| [764](#L764) | /\* Inner Header \*/ |
| [765](#L765) | public function wpext\_plugin\_top\_header(){ |
| [766](#L766) | include\_once \_\_DIR\_\_ . "/partials/wp-extend-header-display.php"; |
| [767](#L767) | } |
| [768](#L768) |  |
| [769](#L769) | /\*Save Button global \*/ |
| [770](#L770) |  |
| [771](#L771) | public function wpext\_module\_save\_btn\_header($save\_button\_text){ |
| [772](#L772) | include\_once \_\_DIR\_\_ . "/partials/wp-extend-save-btn-header.php"; |
| [773](#L773) | } |
| [774](#L774) | public function wpext\_plugin\_footer(){ |
| [775](#L775) | include\_once \_\_DIR\_\_ . "/partials/wp-extend-footer.php"; |
| [776](#L776) | } |
| [777](#L777) |  |
| [778](#L778) | public function wpext\_license\_page() { ?> |
| [779](#L779) |  |
| [780](#L780) | <!-- start code --> |
| [781](#L781) | <div class="row"> |
| [782](#L782) | <?php |
| [783](#L783) | $wpext\_tabSettingGroups = array( 'license\_and\_settings' => 'Settings', 'system\_info' => 'System Info', 'support' => 'Support'); |
| [784](#L784) | ?> |
| [785](#L785) | <div class="tab col-sm-3"> |
| [786](#L786) | <?php foreach($wpext\_tabSettingGroups as $key => $tbgroup): ?> |
| [787](#L787) | <button class="tablinksSetting <?php if($key == "license\_and\_settings"){ echo "active";} ?>" data-tab="<?php echo $key; ?>"><?php \_e($tbgroup, WP\_EXTENDED\_TEXT\_DOMAIN); ?></button> |
| [788](#L788) | <?php endforeach; ?> |
| [789](#L789) | </div> |
| [790](#L790) | <div class="tab-content col-sm-9"> |
| [791](#L791) | <!-- start License & Settings --> |
| [792](#L792) | <?php $status = get\_option('wpext\_plugin\_reset\_action'); ?> |
| [793](#L793) | <div class="container bg-white text-dark px-0 wpe\_sidebar tab-content-setting" id="license\_and\_settings" style="display:block;"> |
| [794](#L794) | <div class="row"> |
| [795](#L795) | <h5 class="text-black wpext\_mb20 settings\_tab\_title"><?php \_e('Settings', WP\_EXTENDED\_TEXT\_DOMAIN); ?></h5> |
| [796](#L796) | </div> |
| [797](#L797) | <div class="row g-3"> |
| [798](#L798) | <div class="field form-switch form-switch-md mt-1 mb-2 wpext\_resetaction"> |
| [799](#L799) | <input id="wpext\_reset\_settings" name="wpext\_reset\_settings" type="checkbox"  <?php if(!empty($status) && $status == 'true') { echo "checked"; } ?> class="form-check-input" role="switch"> |
| [800](#L800) | <label for="wpext\_reset\_settings" role="button" class="wpext\_font\_size"><?php \_e('Delete all plugin data on plugin removal', WP\_EXTENDED\_TEXT\_DOMAIN); ?></label> |
| [801](#L801) | </div> |
| [802](#L802) |  |
| [803](#L803) | <div class="field form-switch form-switch-md mt-0 mb-2 wpext\_resetaction"> |
| [804](#L804) | <?php $menustatus = get\_option('wpext\_show\_plugin\_menu\_action'); ?> |
| [805](#L805) | <input id="wpext\_show\_submenu" name="wpext\_show\_submenu" type="checkbox" |
| [806](#L806) | <?php if(!empty($menustatus) && $menustatus == 'true') { echo "checked"; } ?> |
| [807](#L807) | class="form-check-input" role="switch"> |
| [808](#L808) | <label for="wpext\_show\_submenu" role="button" class="wpext\_font\_size"> <?php \_e('Display Modules in the Submenu', WP\_EXTENDED\_TEXT\_DOMAIN) ?></label> |
| [809](#L809) | </div> |
| [810](#L810) |  |
| [811](#L811) | <!-- start enable sub module display --> |
| [812](#L812) | <?php |
| [813](#L813) | $wpext\_admin\_menu\_favorite = get\_option('wpext\_admin\_menu\_favorite'); |
| [814](#L814) | $wpext\_tabGroups = array( 'snippets' => 'Utilities', 'security' => 'Security', |
| [815](#L815) | 'post-page' => 'Posts & Pages', 'users' => 'Users', 'media' => 'Images & Media', |
| [816](#L816) | 'disable' => 'Disable & Organise'); |
| [817](#L817) | $modules = $this->modules(); |
| [818](#L818) | foreach($wpext\_tabGroups as $grpkey => $tbgroup): |
| [819](#L819) | foreach ($modules as $slug => $module\_group): |
| [820](#L820) | foreach ($module\_group as $key => $module): |
| [821](#L821) | if( isset($module['action']) &&  $module['action'] != '' ){ |
| [822](#L822) | if (!empty($module['group']) && $module['group'] == $grpkey ){ ?> |
| [823](#L823) | <div class="form-check form-check-inline wpext\_menu\_favorite"> |
| [824](#L824) | <input class="form-check-input wpext\_admin\_menu\_favorite mt-1" type="checkbox" id="<?php echo $module['dirname']."\_favorite"; ?>" name="wpext\_admin\_menu\_favorite[<?php echo $module['dirname']; ?>]" <?php if(!empty($wpext\_admin\_menu\_favorite[$module['dirname']]) && $wpext\_admin\_menu\_favorite[$module['dirname']] == 'true') { echo "checked"; } ?> data-slug="<?php echo $module['dirname']; ?>" data-name="<?php echo $module['name']; ?>"> |
| [825](#L825) | <label class="form-check-label" role="button" for="<?php echo $module['dirname']."\_favorite"; ?>"><?php \_e($module['name'], WP\_EXTENDED\_TEXT\_DOMAIN); ?></label> |
| [826](#L826) | </div> |
| [827](#L827) | <?php } |
| [828](#L828) | } |
| [829](#L829) | endforeach; |
| [830](#L830) | endforeach; |
| [831](#L831) | endforeach; ?> |
| [832](#L832) | <!-- end enable sub module display --> |
| [833](#L833) |  |
| [834](#L834) | </div> |
| [835](#L835) | </div> |
| [836](#L836) | <!-- end License & Settings --> |
| [837](#L837) | <!-- start System Info --> |
| [838](#L838) |  |
| [839](#L839) | <div class="container bg-white text-dark p-0 pt-0 wpe\_sidebar tab-content-setting" id="system\_info" style="display:none;"> |
| [840](#L840) | <div class="container bg-white text-dark p-0"> |
| [841](#L841) | <h5 class="text-black wpext\_mb20">System Information</h5> |
| [842](#L842) | <ul class="list-group list-group-flush px-0"> |
| [843](#L843) | <li class="fs-6 px-0"><?php \_e('License:', WP\_EXTENDED\_TEXT\_DOMAIN);?> <span class="fw-bold"><?php \_e('Free', WP\_EXTENDED\_TEXT\_DOMAIN); ?></span></li> |
| [844](#L844) | <li class="fs-6 px-0"><?php \_e('Plugin Version:', WP\_EXTENDED\_TEXT\_DOMAIN);?> <span class="fw-bold"><?php echo $this->ver();?></span></li> |
| [845](#L845) | <li class="fs-6 px-0"><?php \_e('PHP Version:', WP\_EXTENDED\_TEXT\_DOMAIN);?> <span class="fw-bold"> |
| [846](#L846) | <?php |
| [847](#L847) | if (strnatcmp(phpversion(),'7.4.0') < 0) |
| [848](#L848) | { |
| [849](#L849) | echo phpversion().'<span class="has-tooltip-arrow wpext-help wp-extended-alert" data-tooltip="You should consider updating your PHP version"><span class="icon"><i class="fa-solid fa-circle-exclamation"></i></span></span>'; |
| [850](#L850) | } |
| [851](#L851) | else |
| [852](#L852) | { |
| [853](#L853) | echo phpversion(); |
| [854](#L854) | } |
| [855](#L855) | ?> |
| [856](#L856) | </li> |
| [857](#L857) | <?php |
| [858](#L858) | $active\_page\_builder = ''; |
| [859](#L859) | if ( is\_plugin\_active( 'elementor/elementor.php' ) ) { |
| [860](#L860) | // Elementor is active |
| [861](#L861) | $active\_page\_builder .= 'Elementor'; |
| [862](#L862) | } |
| [863](#L863) | if ( is\_plugin\_active( 'oxygen/functions.php' ) ) { |
| [864](#L864) | // oxygen is active |
| [865](#L865) | if($active\_page\_builder){ |
| [866](#L866) | $active\_page\_builder .= ', Oxygen'; |
| [867](#L867) | }else{ |
| [868](#L868) | $active\_page\_builder .= 'Oxygen'; |
| [869](#L869) | } |
| [870](#L870) | } |
| [871](#L871) | if ( is\_plugin\_active( 'breakdance/plugin.php' ) ) { |
| [872](#L872) | // breakdance is active |
| [873](#L873) | if($active\_page\_builder){ |
| [874](#L874) | $active\_page\_builder .= ', Breakdance'; |
| [875](#L875) | }else{ |
| [876](#L876) | $active\_page\_builder .= 'Breakdance'; |
| [877](#L877) | } |
| [878](#L878) | } |
| [879](#L879) | if ( is\_plugin\_active( 'visualcomposer/plugin-wordpress.php' ) ) { |
| [880](#L880) | // visualcomposer is active |
| [881](#L881) | if($active\_page\_builder){ |
| [882](#L882) | $active\_page\_builder .= ', Visual Composer'; |
| [883](#L883) | }else{ |
| [884](#L884) | $active\_page\_builder .= 'Visual Composer'; |
| [885](#L885) | } |
| [886](#L886) | } |
| [887](#L887) | if($active\_page\_builder){ |
| [888](#L888) | ?> |
| [889](#L889) | <li class="fs-6 px-0"> |
| [890](#L890) | <?php \_e('Active Page Builder:', WP\_EXTENDED\_TEXT\_DOMAIN);?> <span class="fw-bold"><?php \_e($active\_page\_builder, WP\_EXTENDED\_TEXT\_DOMAIN);?></span> |
| [891](#L891) | </li> |
| [892](#L892) | <?php |
| [893](#L893) | } |
| [894](#L894) | ?> |
| [895](#L895) | <li class="fs-6 px-0"><?php \_e('WordPress Version:', WP\_EXTENDED\_TEXT\_DOMAIN);?> <span class="fw-bold"><?php bloginfo( 'version' ); ?></span></li> |
| [896](#L896) | </ul> |
| [897](#L897) | </div> |
| [898](#L898) | </div> |
| [899](#L899) | <!-- end System Info --> |
| [900](#L900) |  |
| [901](#L901) | <!-- start support --> |
| [902](#L902) | <div class="container bg-white text-dark p-0 pt-0 wpe\_sidebar tab-content-setting" id="support" style="display:none;"> |
| [903](#L903) | <!-- Sidebar --> |
| [904](#L904) | <div class="container bg-white text-dark p-0"> |
| [905](#L905) | <h5 class="text-black wpext\_mb20"><?php \_e('Support', WP\_EXTENDED\_TEXT\_DOMAIN);?></h5> |
| [906](#L906) | <ul class="list-group list-group-flush wpext\_support\_link"> |
| [907](#L907) | <li class="fs-6 px-0"> |
| [908](#L908) | <a href="mailto:support@wpextended.io"><?php \_e('support@wpextended.io ', WP\_EXTENDED\_TEXT\_DOMAIN);?></a> |
| [909](#L909) | </li> |
| [910](#L910) | <li class="fs-6 px-0"> |
| [911](#L911) | <a href="https://www.facebook.com/groups/wpextended" target="\_blank"><?php \_e('Facebook Group', WP\_EXTENDED\_TEXT\_DOMAIN);?></a> |
| [912](#L912) | </li> |
| [913](#L913) | <li class="fs-6 px-0"> |
| [914](#L914) | <a href="https://wpextended.io/docs" target="\_blank"><?php \_e('Documentation', WP\_EXTENDED\_TEXT\_DOMAIN);?></a> |
| [915](#L915) | </li> |
| [916](#L916) | <li class="fs-6 px-0"> |
| [917](#L917) | <a href="https://wpextended.io/changelog/" target="\_blank"><?php \_e('Changelog', WP\_EXTENDED\_TEXT\_DOMAIN);?></a> |
| [918](#L918) | </li> |
| [919](#L919) | <li class="fs-6 px-0"> |
| [920](#L920) | <a href="https://wpextended.io/blog/" target="\_blank"><?php \_e('Blog', WP\_EXTENDED\_TEXT\_DOMAIN);?></a> |
| [921](#L921) | </li> |
| [922](#L922) | </ul> |
| [923](#L923) | </div> |
| [924](#L924) | <!-- Sidebar End here --> |
| [925](#L925) | </div> |
| [926](#L926) | <!-- end support --> |
| [927](#L927) | </div> |
| [928](#L928) | </div> |
| [929](#L929) | <!-- </div>    --> |
| [930](#L930) | <!-- end code --> |
| [931](#L931) | <?php |
| [932](#L932) | } |
| [933](#L933) |  |
| [934](#L934) | public function wpext\_active\_modules\_callback(){ |
| [935](#L935) | check\_ajax\_referer('extended\_obj', 'nonce'); |
| [936](#L936) | // Check user capability |
| [937](#L937) | if (!current\_user\_can('manage\_options')) { |
| [938](#L938) | wp\_send\_json\_error(\_\_('Unauthorized access.', WP\_EXTENDED\_TEXT\_DOMAIN), 403); |
| [939](#L939) | wp\_die(); |
| [940](#L940) | } |
| [941](#L941) | $module\_action = sanitize\_text\_field($\_REQUEST['status']); |
| [942](#L942) | if(isset($module\_action)){ |
| [943](#L943) | update\_option('wpext\_active\_modules\_status',$module\_action); |
| [944](#L944) | } |
| [945](#L945) | } |
| [946](#L946) |  |
| [947](#L947) | } |

**Note:** See [TracBrowser](/wiki/TracBrowser)
for help on using the repository browser.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Plain Text](/browser/wpextended/trunk/admin/class-wp-extended-admin.php?format=txt)
* [Original Format](/export/3220753/wpextended/trunk/admin/class-wp-extended-admin.php)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)



=== Content from www.wordfence.com_b3a0053e_20250111_150830.html ===


[![](https://www.wordfence.com/img/wordfence-intelligence-logo.svg)](/threat-intel/)

Have you found a vulnerability in a WordPress plugin or theme? Report vulnerabilities in WordPress plugins and themes through our [bug bounty program](https://www.wordfence.com/threat-intel/bug-bounty-program) and earn a bounty on all in-scope submissions, while we handle the responsible disclosure process on your behalf.

As a reminder, the Wordfence Intelligence Vulnerability Database API is completely free to query and utilize, both personally and commercially, and contains all the same vulnerability data as the user interface. Please review the API documentation and Webhook documentation for more information on how to query the vulnerability API endpoints and configure webhooks utilizing all the same data present in the Wordfence Intelligence user interface.

# The Ultimate WordPress Toolkit – WP Extended <= 3.0.8 - Authenticated (Subscriber+) Arbitrary Options Update

 [Wordfence Intelligence](https://www.wordfence.com/threat-intel)   >    [Vulnerability Database](https://www.wordfence.com/threat-intel/vulnerabilities)   >   The Ultimate WordPress Toolkit – WP Extended <= 3.0.8 - Authenticated (Subscriber+) Arbitrary Options Update

8.8

**Missing Authorization**
**CVSS Vector**
[CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H)

| CVE | [CVE-2024-8102](https://www.cve.org/CVERecord?id=CVE-2024-8102) |
| --- | --- |
| CVSS | 8.8 (High) |
| Publicly Published | September 3, 2024 |
| Last Updated | September 6, 2024 |
| Researcher | [Marco Wotschka - Wordfence](https://www.wordfence.com/threat-intel/vulnerabilities/researchers/marco-wotschka) |

### Description

The The Ultimate WordPress Toolkit – WP Extended plugin for WordPress is vulnerable to unauthorized modification of data that can lead to privilege escalation due to a missing capability check on the module\_all\_toggle\_ajax() function in all versions up to, and including, 3.0.8. This makes it possible for authenticated attackers, with Subscriber-level access and above, to update arbitrary options on the WordPress site. This can be leveraged to update the default role for registration to administrator and enable user registration for attackers to gain administrative user access to a vulnerable site.

#### References

* [plugins.trac.wordpress.org](https://plugins.trac.wordpress.org/browser/wpextended/trunk/admin/class-wp-extended-admin.php#L262)
* [plugins.trac.wordpress.org](https://plugins.trac.wordpress.org/changeset?sfp_email=&sfph_mail=&reponame=&new=3145430%40wpextended%2Ftrunk&old=3134345%40wpextended%2Ftrunk&sfp_email=&sfph_mail=)

#### Share

[Facebook](https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fwpextended%2Fthe-ultimate-wordpress-toolkit-wp-extended-308-authenticated-subscriber-arbitrary-options-update&t=The%20Ultimate%20WordPress%20Toolkit%20%E2%80%93%20WP%20Extended%20%3C%3D%203.0.8%20-%20Authenticated%20%28Subscriber%2B%29%20Arbitrary%20Options%20Update "Facebook")
[Twitter](https://twitter.com/share?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fwpextended%2Fthe-ultimate-wordpress-toolkit-wp-extended-308-authenticated-subscriber-arbitrary-options-update&text=The%20Ultimate%20WordPress%20Toolkit%20%E2%80%93%20WP%20Extended%20%3C%3D%203.0.8%20-%20Authenticated%20%28Subscriber%2B%29%20Arbitrary%20Options%20Update "Twitter")
[LinkedIn](https://www.linkedin.com/shareArticle?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fwpextended%2Fthe-ultimate-wordpress-toolkit-wp-extended-308-authenticated-subscriber-arbitrary-options-update "LinkedIn")
Email

## Vulnerability Details for The Ultimate WordPress Toolkit – WP Extended

#### [The Ultimate WordPress Toolkit – WP Extended](https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/wpextended)

| Software Type | Plugin |
| --- | --- |
| Software Slug | wpextended [(view on wordpress.org)](https://wordpress.org/plugins/wpextended) |
| Patched? | Yes |
| Remediation | Update to version 3.0.9, or a newer patched version |
| Affected Version | * <= 3.0.8 |
| Patched Version | * 3.0.9 |

This record contains material that is subject to copyright.

**Copyright 2012-2025 Defiant Inc.**

**License:**
Defiant hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute this software vulnerability information. Any copy of the software vulnerability information you make for such purposes is authorized provided that you include a hyperlink to this vulnerability record and reproduce Defiant's copyright designation and this license in any such copy.
**[Read more.](https://www.wordfence.com/wordfence-intelligence-terms-and-conditions/)**

**Copyright 1999-2025 The MITRE Corporation**

**License:**
CVE Usage: MITRE hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute Common Vulnerabilities and Exposures (CVE®). Any copy you make for such purposes is authorized provided that you reproduce MITRE's copyright designation and this license in any such copy.
**[Read more.](https://www.cve.org/Legal/TermsOfUse)**

Have information to add, or spot any errors? Contact us at wfi-support@wordfence.com so we can make any appropriate adjustments.

Did you know Wordfence Intelligence provides free personal and commercial API access to our comprehensive WordPress vulnerability database, along with a free webhook integration to stay on top of the latest vulnerabilities added and updated in the database? Get started today!

Learn more

Want to get notified of the latest vulnerabilities that may affect your WordPress site?
 Install Wordfence on your site today to get notified immediately if your site is affected by a vulnerability that has been added to our database.

Get Wordfence

The Wordfence Intelligence WordPress vulnerability database is completely free to access and query via API. Please review the documentation on how to access and consume the vulnerability data via API.

Documentation



=== Content from plugins.trac.wordpress.org_6008f119_20250111_150828.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fchangeset%3Fnew%3D3145430%2540wpextended%252Ftrunk%26old%3D3134345%2540wpextended%252Ftrunk)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* [Reverse Diff](/changeset/3134345/wpextended/trunk?old=3145430&old_path=%2Fwpextended%2Ftrunk)

---

# Changes in [wpextended/trunk](/browser/wpextended/trunk?rev=3145430 "Show entry in browser") [[3134345:3145430]](/log/wpextended/trunk?rev=3145430&stop_rev=3134345 "Show revision log")

View differences
inline
side by side

Show
lines around each change

Show the changes in full context

Ignore:

Blank lines

Case changes

White space changes

Location:
[wpextended/trunk](/browser/wpextended/trunk?rev=3145430)
Files:

23 edited

* [admin/class-wp-extended-admin.php](/browser/wpextended/trunk/admin/class-wp-extended-admin.php?rev=3145393 "Show entry in browser")
  (modified)
  ([2 diffs](#file0 "Show differences"))
* [admin/js/wp\_extended-admin.js](/browser/wpextended/trunk/admin/js/wp_extended-admin.js?rev=3145393 "Show entry in browser")
  (modified)
  ([4 diffs](#file1 "Show differences"))
* [admin/partials/wp-extend-admin-display.php](/browser/wpextended/trunk/admin/partials/wp-extend-admin-display.php?rev=3145393 "Show entry in browser")
  (modified)
  ([1 diff](#file2 "Show differences"))
* [includes/libraries/wpext\_export/wpext\_export.php](/browser/wpextended/trunk/includes/libraries/wpext_export/wpext_export.php?rev=3145393 "Show entry in browser")
  (modified)
  ([2 diffs](#file3 "Show differences"))
* [includes/modules/core\_extensions/wpext\_block\_user\_name\_admin/wpext\_block\_user\_name\_admin.php](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_block_user_name_admin/wpext_block_user_name_admin.php?rev=3145430 "Show entry in browser")
  (modified)
  ([2 diffs](#file4 "Show differences"))
* [includes/modules/core\_extensions/wpext\_change\_wp\_admin\_url/wpext\_change\_wp\_admin\_url.php](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_change_wp_admin_url/wpext_change_wp_admin_url.php?rev=3145393 "Show entry in browser")
  (modified)
  ([1 diff](#file5 "Show differences"))
* [includes/modules/core\_extensions/wpext\_duplicate\_menu/wpext\_duplicate\_menu.php](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_duplicate_menu/wpext_duplicate_menu.php?rev=3145393 "Show entry in browser")
  (modified)
  ([1 diff](#file6 "Show differences"))
* [includes/modules/core\_extensions/wpext\_duplicator/wpext\_duplicator.php](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_duplicator/wpext_duplicator.php?rev=3145393 "Show entry in browser")
  (modified)
  ([4 diffs](#file7 "Show differences"))
* [includes/modules/core\_extensions/wpext\_export\_users/wpext\_export\_users.php](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_export_users/wpext_export_users.php?rev=3145393 "Show entry in browser")
  (modified)
  ([2 diffs](#file8 "Show differences"))
* [includes/modules/core\_extensions/wpext\_external\_permalinks/wpext\_external\_permalinks.php](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_external_permalinks/wpext_external_permalinks.php?rev=3145393 "Show entry in browser")
  (modified)
  ([1 diff](#file9 "Show differences"))
* [includes/modules/core\_extensions/wpext\_hide\_admin\_bar/wpext\_hide\_admin\_bar.php](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_hide_admin_bar/wpext_hide_admin_bar.php?rev=3145393 "Show entry in browser")
  (modified)
  ([1 diff](#file10 "Show differences"))
* [includes/modules/core\_extensions/wpext\_limit\_login\_attempts/wpext\_limit\_login\_attempts.php](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_limit_login_attempts/wpext_limit_login_attempts.php?rev=3145393 "Show entry in browser")
  (modified)
  ([1 diff](#file11 "Show differences"))
* [includes/modules/core\_extensions/wpext\_maintenance\_mode/wpext\_maintenance\_mode.php](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_maintenance_mode/wpext_maintenance_mode.php?rev=3145393 "Show entry in browser")
  (modified)
  ([1 diff](#file12 "Show differences"))
* [includes/modules/core\_extensions/wpext\_pixel\_tag\_manager/wpext\_pixel\_tag\_manager.php](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_pixel_tag_manager/wpext_pixel_tag_manager.php?rev=3145393 "Show entry in browser")
  (modified)
  ([1 diff](#file13 "Show differences"))
* [includes/modules/core\_extensions/wpext\_post\_order/wpext\_post\_order.php](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_post_order/wpext_post_order.php?rev=3145393 "Show entry in browser")
  (modified)
  ([1 diff](#file14 "Show differences"))
* [includes/modules/core\_extensions/wpext\_smtp\_email/wpext\_smtp\_email.php](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_smtp_email/wpext_smtp_email.php?rev=3145393 "Show entry in browser")
  (modified)
  ([1 diff](#file15 "Show differences"))
* [includes/modules/core\_extensions/wpext\_snippets/old/wpext\_snippets.php](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_snippets/old/wpext_snippets.php?rev=3145393 "Show entry in browser")
  (modified)
  ([2 diffs](#file16 "Show differences"))
* [includes/modules/core\_extensions/wpext\_snippets/wp-extend-module-listing.php](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_snippets/wp-extend-module-listing.php?rev=3145393 "Show entry in browser")
  (modified)
  ([3 diffs](#file17 "Show differences"))
* [includes/modules/core\_extensions/wpext\_snippets/wpext\_snippets.php](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_snippets/wpext_snippets.php?rev=3145393 "Show entry in browser")
  (modified)
  ([4 diffs](#file18 "Show differences"))
* [includes/modules/core\_extensions/wpext\_tidy\_nav/wpext\_tidy\_nav.php](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_tidy_nav/wpext_tidy_nav.php?rev=3145393 "Show entry in browser")
  (modified)
  ([1 diff](#file19 "Show differences"))
* [includes/modules/core\_extensions/wpext\_user\_sections/wpext\_user\_sections.php](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_user_sections/wpext_user_sections.php?rev=3145393 "Show entry in browser")
  (modified)
  ([1 diff](#file20 "Show differences"))
* [readme.txt](/browser/wpextended/trunk/readme.txt?rev=3145393 "Show entry in browser")
  (modified)
  ([3 diffs](#file21 "Show differences"))
* [wp-extended.php](/browser/wpextended/trunk/wp-extended.php?rev=3145393 "Show entry in browser")
  (modified)
  ([2 diffs](#file22 "Show differences"))

### Legend:

Unmodified
Added
Removed

* ## [wpextended/trunk/admin/class-wp-extended-admin.php](/changeset/3145393/wpextended/trunk/admin/class-wp-extended-admin.php?old=3131199&old_path=wpextended%2Ftrunk%2Fadmin%2Fclass-wp-extended-admin.php "Show the [3134345:3145430] differences restricted to wpextended/trunk/admin/class-wp-extended-admin.php")

  | [r3134345](/browser/wpextended/trunk/admin/class-wp-extended-admin.php?rev=3131199#L41 "Show revision 3134345 of this file in browser") | [r3145430](/browser/wpextended/trunk/admin/class-wp-extended-admin.php?rev=3145393#L41 "Show revision 3145430 of this file in browser") |  |
  | --- | --- | --- |
  | 41 | 41 | add\_action('admin\_enqueue\_scripts', array( $this, 'enqueue\_styles' ) ); |
  | 42 | 42 | add\_action('admin\_enqueue\_scripts', array( $this, 'enqueue\_scripts' ), 99 ); |
  | 43 |  |  |
  | 44 | 43 | add\_action('wp\_ajax\_wp-extended-module-toggle',   array( $this, 'module\_toggle\_ajax') ); |
  | 45 |  | ~~add\_action('wp\_ajax\_wp-extended-module-all-toggle',   array( $this, 'module\_all\_toggle\_ajax') );~~ |
  | 46 | 44 | add\_action('wpext\_plugin\_sidebar', array( $this, 'admin\_plugin\_info\_sidebar' ), 100 ); |
  | 47 | 45 | add\_action('admin\_plugin\_top\_info', array( $this, 'wpext\_admin\_plugin\_top\_info' ), 100 ); |
  | […](/browser/wpextended/trunk/admin/class-wp-extended-admin.php?rev=3131199#L255) | […](/browser/wpextended/trunk/admin/class-wp-extended-admin.php?rev=3145393#L253) |  |
  | 255 | 253 | include \_\_DIR\_\_ . '/partials/wp-extend-admin-display.php'; |
  | 256 | 254 | } // admin\_display |
  | 257 |  |  |
  | 258 |  | /\* |
  | 259 |  | \* AJAX endpoint for all module activation/dectivation |
  | 260 |  | \*/ |
  | 261 |  |  |
  | 262 |  | public function module\_all\_toggle\_ajax(){ |
  | 263 |  |  |
  | 264 |  | $status = $\_POST['status']; |
  | 265 |  | $allaction = $\_POST['allaction']; |
  | 266 |  |  |
  | 267 |  | $groups = $this->groups(); |
  | 268 |  | $modules = $this->modules(); |
  | 269 |  |  |
  | 270 |  | update\_option( $allaction, $status); |
  | 271 |  | $response = get\_option( $allaction); |
  | 272 |  |  |
  | 273 |  | foreach ($modules['core\_extensions'] as  $modulename) { |
  | 274 |  | $module = $modulename['dirname']; |
  | 275 |  | if ($modulename['available']){ |
  | 276 |  | $this->module\_toggle( $module, $status ); |
  | 277 |  | } |
  | 278 |  | } |
  | 279 |  | wp\_send\_json( $response ); |
  | 280 |  | die('0'); |
  | 281 |  | } |
  |  | 255 |  |
  | 282 | 256 | /\* |
  | 283 | 257 | \* AJAX endpoint for module activation |
* ## [wpextended/trunk/admin/js/wp\_extended-admin.js](/changeset/3145393/wpextended/trunk/admin/js/wp_extended-admin.js?old=3131199&old_path=wpextended%2Ftrunk%2Fadmin%2Fjs%2Fwp_extended-admin.js "Show the [3134345:3145430] differences restricted to wpextended/trunk/admin/js/wp_extended-admin.js")

  | [r3134345](/browser/wpextended/trunk/admin/js/wp_extended-admin.js?rev=3131199#L541 "Show revision 3134345 of this file in browser") | [r3145430](/browser/wpextended/trunk/admin/js/wp_extended-admin.js?rev=3145393#L541 "Show revision 3145430 of this file in browser") |  |
  | --- | --- | --- |
  | 541 | 541 | .attr('onclick') |
  | 542 | 542 | .match(/'([^']+)'/)[1]; |
  | 543 |  |  |
  |  | 543 |  |
  | 544 | 544 | jQuery('.item.list-group-item, .item.grid-group-item').each(function () { |
  | 545 | 545 | var checkbox = jQuery(this).find('.form-check-input'); |
  | […](/browser/wpextended/trunk/admin/js/wp_extended-admin.js?rev=3131199#L582) | […](/browser/wpextended/trunk/admin/js/wp_extended-admin.js?rev=3145393#L582) |  |
  | 582 | 582 |  |
  | 583 | 583 | var urlParams = new URLSearchParams(window.location.search); |
  | 584 |  | if (urlParams.get('page') === 'wp-extended') { |
  |  | 584 | if (urlParams.get('page') === 'wp-extended') { |
  | 585 | 585 | // Attach the change event listener to the Active Modules checkbox |
  | 586 | 586 | jQuery('#wpext\_active\_modules').change(function () { |
  | […](/browser/wpextended/trunk/admin/js/wp_extended-admin.js?rev=3131199#L595) | […](/browser/wpextended/trunk/admin/js/wp_extended-admin.js?rev=3145393#L595) |  |
  | 595 | 595 | } |
  | 596 | 596 |  |
  |  | 597 | // Delay the visibility toggle when the page reloads |
  |  | 598 | setTimeout(function() { |
  |  | 599 | toggleItemsVisibility(); |
  |  | 600 | }, 100); |
  |  | 601 |  |
  | 597 | 602 | jQuery('#wpext\_active\_modules').on('change', function () { |
  | 598 | 603 | var isChecked = this.checked; |
  | […](/browser/wpextended/trunk/admin/js/wp_extended-admin.js?rev=3131199#L608) | […](/browser/wpextended/trunk/admin/js/wp_extended-admin.js?rev=3145393#L613) |  |
  | 608 | 613 | }); |
  | 609 | 614 | }); |
  |  | 615 |  |
  |  | 616 | /\*Hide show active module \*/ |
  |  | 617 | jQuery(document).ready(function($) { |
  |  | 618 | // Function to toggle visibility of the container based on checkboxes' state |
  |  | 619 | function toggleActiveModulesContainer() { |
  |  | 620 | var $checkboxes = $('.wpext\_toggle\_settings .card-footer input[type="checkbox"]'); |
  |  | 621 | var $activeModulesContainer = $('.wpext\_toggle\_settings .wpext\_active\_modules\_container'); |
  |  | 622 | var anyChecked = $checkboxes.is(':checked'); |
  |  | 623 | if (anyChecked) { |
  |  | 624 | $activeModulesContainer.show(); |
  |  | 625 | } else { |
  |  | 626 | $activeModulesContainer.hide(); |
  |  | 627 | } |
  |  | 628 | } |
  |  | 629 | $('.wpext\_toggle\_settings .card-footer input[type="checkbox"]').click(function() { |
  |  | 630 | toggleActiveModulesContainer(); |
  |  | 631 | }); |
  |  | 632 |  |
  |  | 633 | // Initial call to set the correct visibility based on checkbox states |
  |  | 634 | toggleActiveModulesContainer(); |
  |  | 635 | }); |
  |  | 636 | /\*Hide show active module end here \*/ |
* ## [wpextended/trunk/admin/partials/wp-extend-admin-display.php](/changeset/3145393/wpextended/trunk/admin/partials/wp-extend-admin-display.php?old=3131199&old_path=wpextended%2Ftrunk%2Fadmin%2Fpartials%2Fwp-extend-admin-display.php "Show the [3134345:3145430] differences restricted to wpextended/trunk/admin/partials/wp-extend-admin-display.php")

  | [r3134345](/browser/wpextended/trunk/admin/partials/wp-extend-admin-display.php?rev=3131199#L72 "Show revision 3134345 of this file in browser") | [r3145430](/browser/wpextended/trunk/admin/partials/wp-extend-admin-display.php?rev=3145393#L72 "Show revision 3145430 of this file in browser") |  |
  | --- | --- | --- |
  | 72 | 72 | </div> |
  | 73 | 73 | <div class="wpext\_active\_modules\_container me-lg-3"> |
  | 74 |  | <label for="wpext\_active\_modules" class="mt-1"><?php \_e('Active Modules',WP\_EXTENDED\_TEXT\_DOMAIN); ?></label> |
  | 75 |  | <div class="field form-check form-switch form-switch-md"> |
  | 76 |  | <?php |
  | 77 |  | $action\_module\_status = get\_option('wpext\_active\_modules\_status'); |
  | 78 |  |  |
  | 79 |  | if($action\_module\_status == 'true'){ |
  | 80 |  | $status = 'checked'; |
  | 81 |  | }else{ |
  | 82 |  | $status = ''; |
  | 83 |  | } |
  | 84 |  | ?> |
  | 85 |  | <input id="wpext\_active\_modules" name="wpext\_active\_modules" type="checkbox" class="form-check-input" <?php echo $status; ?> role="switch"> |
  | 86 |  | </div> |
  | 87 |  | </div> |
  |  | 74 | <?php |
  |  | 75 | $wpext\_module\_status = get\_option('wp-extended-modules'); |
  |  | 76 | $has\_displayed = false; |
  |  | 77 | foreach($wpext\_module\_status as $key => $module\_status) { |
  |  | 78 | if(!empty($module\_status) && !$has\_displayed) { ?> |
  |  | 79 | <label for="wpext\_active\_modules" class="mt-1"><?php \_e('Active Modules', WP\_EXTENDED\_TEXT\_DOMAIN); ?></label> |
  |  | 80 | <div class="field form-check form-switch form-switch-md"> |
  |  | 81 | <?php |
  |  | 82 | $action\_module\_status = get\_option('wpext\_active\_modules\_status'); |
  |  | 83 | if($action\_module\_status == 'true'){ |
  |  | 84 | $status = 'checked'; |
  |  | 85 | } else { |
  |  | 86 | $status = ''; |
  |  | 87 | } |
  |  | 88 | ?> |
  |  | 89 | <input id="wpext\_active\_modules" name="wpext\_active\_modules" type="checkbox" class="form-check-input" <?php echo $status; ?>  role="switch"> |
  |  | 90 | </div> |
  |  | 91 | <?php |
  |  | 92 | $has\_displayed = true; // Set the flag to true to prevent further display |
  |  | 93 | } |
  |  | 94 | } ?> |
  |  | 95 | </div> |
  | 88 | 96 | </div> |
  | 89 | 97 | <!-- end grid section --> |
* ## [wpextended/trunk/includes/libraries/wpext\_export/wpext\_export.php](/changeset/3145393/wpextended/trunk/includes/libraries/wpext_export/wpext_export.php?old=3134252&old_path=wpextended%2Ftrunk%2Fincludes%2Flibraries%2Fwpext_export%2Fwpext_export.php "Show the [3134345:3145430] differences restricted to wpextended/trunk/includes/libraries/wpext_export/wpext_export.php")

  | [r3134345](/browser/wpextended/trunk/includes/libraries/wpext_export/wpext_export.php?rev=3134252#L136 "Show revision 3134345 of this file in browser") | [r3145430](/browser/wpextended/trunk/includes/libraries/wpext_export/wpext_export.php?rev=3145393#L136 "Show revision 3145430 of this file in browser") |  |
  | --- | --- | --- |
  | 136 | 136 |  |
  | 137 | 137 | public function download\_file\_ajax(){ |
  | 138 |  | $filename = $\_GET['filename']; |
  | 139 |  |  |
  |  | 138 |  |
  |  | 139 | /\* Security Issues fixed \*/ |
  |  | 140 | if ( ! current\_user\_can( 'manage\_options' ) ) { |
  |  | 141 | wp\_send\_json\_error( \_\_( 'You do not have permission to access this file.', WP\_EXTENDED\_TEXT\_DOMAIN ) ); |
  |  | 142 | wp\_die(); |
  |  | 143 | } |
  |  | 144 | // Verify the nonce for security. |
  |  | 145 | check\_ajax\_referer( 'wpext-ajax-nonce', 'wpext\_nonce' ); |
  |  | 146 |  |
  |  | 147 | // Sanitize the filename. |
  |  | 148 | $filename = isset( $\_GET['filename'] ) ? sanitize\_file\_name( $\_GET['filename'] ) : ''; |
  |  | 149 |  |
  |  | 150 | if ( empty( $filename ) ) { |
  |  | 151 | wp\_send\_json\_error( \_\_( 'Invalid file request.', WP\_EXTENDED\_TEXT\_DOMAIN ) ); |
  |  | 152 | wp\_die(); |
  |  | 153 | } |
  |  | 154 | /\* Security Issues fixed end here\*/ |
  |  | 155 |  |
  | 140 | 156 | $sent = $this->download\_file( $filename ); |
  | 141 |  |  |
  | 142 | 157 | if( $sent !== true ) { |
  | 143 | 158 | wp\_send\_json( $sent ); |
  | […](/browser/wpextended/trunk/includes/libraries/wpext_export/wpext_export.php?rev=3134252#L152) | […](/browser/wpextended/trunk/includes/libraries/wpext_export/wpext_export.php?rev=3145393#L167) |  |
  | 152 | 167 | try { |
  | 153 | 168 | $dir = $this->\_get\_files\_dir(); |
  | 154 |  |  |
  | 155 |  |  |
  | 156 |  | $file\_path = $dir . "/" . $filename; |
  | 157 |  |  |
  | 158 |  |  |
  |  | 169 | $file\_path = realpath( $dir . '/' . $filename ); |
  |  | 170 |  |
  | 159 | 171 | if( !file\_exists( $file\_path ) ) { |
  | 160 | 172 | throw new \Exception( "File not found" ); |
* ## [wpextended/trunk/includes/modules/core\_extensions/wpext\_block\_user\_name\_admin/wpext\_block\_user\_name\_admin.php](/changeset/3145430/wpextended/trunk/includes/modules/core_extensions/wpext_block_user_name_admin/wpext_block_user_name_admin.php?old=3099195&old_path=wpextended%2Ftrunk%2Fincludes%2Fmodules%2Fcore_extensions%2Fwpext_block_user_name_admin%2Fwpext_block_user_name_admin.php "Show the [3134345:3145430] differences restricted to wpextended/trunk/includes/modules/core_extensions/wpext_block_user_name_admin/wpext_block_user_name_admin.php")

  | [r3134345](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_block_user_name_admin/wpext_block_user_name_admin.php?rev=3099195#L21 "Show revision 3134345 of this file in browser") | [r3145430](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_block_user_name_admin/wpext_block_user_name_admin.php?rev=3145430#L21 "Show revision 3145430 of this file in browser") |  |
  | --- | --- | --- |
  | 21 | 21 | } |
  | 22 | 22 |  |
  | 23 |  | public function wpext\_check\_the\_current\_username(){ |
  | 24 |  | $admin\_user = get\_user\_by('login', 'admin'); |
  | 25 |  | if ($admin\_user) { |
  | 26 |  | add\_action('admin\_notices', array($this, 'wpext\_admin\_notice')); |
  | 27 |  | } |
  |  | 23 | public function wpext\_check\_the\_current\_username() { |
  |  | 24 | $admin\_user = get\_user\_by('login', 'admin'); |
  |  | 25 | $user = wp\_get\_current\_user(); |
  |  | 26 | $roles = is\_array($user->roles) ? $user->roles : array(); |
  |  | 27 | // Validate that the current user is an administrator and the 'admin' user exists |
  |  | 28 | if ($admin\_user && isset($roles[0]) && sanitize\_text\_field($roles[0]) === 'administrator') { |
  |  | 29 | add\_action('admin\_notices', array($this, 'wpext\_admin\_notice')); |
  |  | 30 | } |
  | 28 | 31 | } |
  | 29 | 32 |  |
  | […](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_block_user_name_admin/wpext_block_user_name_admin.php?rev=3099195#L49) | […](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_block_user_name_admin/wpext_block_user_name_admin.php?rev=3145430#L52) |  |
  | 49 | 52 | public function wpext\_change\_admin\_name(){ |
  | 50 | 53 | global $wpdb; |
  | 51 |  | if( ! wp\_verify\_nonce(sanitize\_text\_field($\_REQUEST['nonce']), 'wpext-nonce' ) ) { |
  | 52 |  | $result = array( |
  | 53 |  | 'status' => false, |
  | 54 |  | 'error' => \_\_( 'Invalid nonce!', WP\_EXTENDED\_TEXT\_DOMAIN ) |
  | 55 |  | ); |
  | 56 |  | wp\_send\_json( $result ); |
  | 57 |  | die(); |
  |  | 54 |  |
  |  | 55 | // Verify nonce |
  |  | 56 |  |
  |  | 57 | if ( ! isset( $\_REQUEST['nonce'] ) || ! wp\_verify\_nonce( sanitize\_text\_field( $\_REQUEST['nonce'] ), 'wpext-nonce' ) ) { |
  |  | 58 | wp\_send\_json( array( 'status' => false, 'error' => \_\_( 'Invalid nonce!', WP\_EXTENDED\_TEXT\_DOMAIN ) ) ); |
  |  | 59 | die(); |
  | 58 | 60 | } |
  |  | 61 |  |
  |  | 62 | // Capability check: Allow only administrators |
  |  | 63 |  |
  |  | 64 | if ( ! current\_user\_can( 'manage\_options' ) ) { |
  |  | 65 | wp\_send\_json( array( 'status' => false, 'error' => \_\_( 'You do not have sufficient permissions to perform this action.', WP\_EXTENDED\_TEXT\_DOMAIN ) ) ); |
  |  | 66 | die(); |
  |  | 67 | } |
  |  | 68 |  |
  | 59 | 69 | $new\_username = sanitize\_text\_field($\_POST['username']); |
  | 60 | 70 | $admin\_user = get\_user\_by('login', 'admin'); |
* ## [wpextended/trunk/includes/modules/core\_extensions/wpext\_change\_wp\_admin\_url/wpext\_change\_wp\_admin\_url.php](/changeset/3145393/wpextended/trunk/includes/modules/core_extensions/wpext_change_wp_admin_url/wpext_change_wp_admin_url.php?old=3099195&old_path=wpextended%2Ftrunk%2Fincludes%2Fmodules%2Fcore_extensions%2Fwpext_change_wp_admin_url%2Fwpext_change_wp_admin_url.php "Show the [3134345:3145430] differences restricted to wpextended/trunk/includes/modules/core_extensions/wpext_change_wp_admin_url/wpext_change_wp_admin_url.php")

  | [r3134345](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_change_wp_admin_url/wpext_change_wp_admin_url.php?rev=3099195#L93 "Show revision 3134345 of this file in browser") | [r3145430](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_change_wp_admin_url/wpext_change_wp_admin_url.php?rev=3145393#L93 "Show revision 3145430 of this file in browser") |  |
  | --- | --- | --- |
  | 93 | 93 | $slug = 'wp-extended-changes-wp-admin-url'; |
  | 94 | 94 | $callback = [ get\_called\_class(), 'settings\_changes\_wp\_admin\_url']; |
  | 95 |  | add\_submenu\_page(~~null~~, '', '', $capability, $slug, $callback); |
  |  | 95 | add\_submenu\_page('', '', '', $capability, $slug, $callback); |
  | 96 | 96 | add\_rewrite\_rule('^wp-extended-changes-wp-admin-url/?', 'index.php?wp\_extended\_changes\_wp\_admin-url=1', 'top'); |
  | 97 | 97 | add\_rewrite\_tag('%wp\_extended\_changes\_wp\_admin%', '([^&]+)'); |
* ## [wpextended/trunk/includes/modules/core\_extensions/wpext\_duplicate\_menu/wpext\_duplicate\_menu.php](/changeset/3145393/wpextended/trunk/includes/modules/core_extensions/wpext_duplicate_menu/wpext_duplicate_menu.php?old=3112929&old_path=wpextended%2Ftrunk%2Fincludes%2Fmodules%2Fcore_extensions%2Fwpext_duplicate_menu%2Fwpext_duplicate_menu.php "Show the [3134345:3145430] differences restricted to wpextended/trunk/includes/modules/core_extensions/wpext_duplicate_menu/wpext_duplicate_menu.php")

  | [r3134345](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_duplicate_menu/wpext_duplicate_menu.php?rev=3112929#L62 "Show revision 3134345 of this file in browser") | [r3145430](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_duplicate_menu/wpext_duplicate_menu.php?rev=3145393#L62 "Show revision 3145430 of this file in browser") |  |
  | --- | --- | --- |
  | 62 | 62 | $capability = 'manage\_options'; |
  | 63 | 63 | $callback = [get\_called\_class(), 'settings\_duplicate\_menu']; |
  | 64 |  | add\_submenu\_page(~~null~~, '', '', $capability, $slug, $callback); |
  |  | 64 | add\_submenu\_page('', '', '', $capability, $slug, $callback); |
  | 65 | 65 | add\_rewrite\_rule('^wp-extended-duplicate-menu/?', 'index.php?wp\_extended\_duplicate\_menu=1', 'top'); |
  | 66 | 66 | add\_rewrite\_tag('%wp\_extended\_duplicate\_menu%', '([^&]+)'); |
* ## [wpextended/trunk/includes/modules/core\_extensions/wpext\_duplicator/wpext\_duplicator.php](/changeset/3145393/wpextended/trunk/includes/modules/core_extensions/wpext_duplicator/wpext_duplicator.php?old=3099195&old_path=wpextended%2Ftrunk%2Fincludes%2Fmodules%2Fcore_extensions%2Fwpext_duplicator%2Fwpext_duplicator.php "Show the [3134345:3145430] differences restricted to wpextended/trunk/includes/modules/core_extensions/wpext_duplicator/wpext_duplicator.php")

  | [r3134345](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_duplicator/wpext_duplicator.php?rev=3099195#L24 "Show revision 3134345 of this file in browser") | [r3145430](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_duplicator/wpext_duplicator.php?rev=3145393#L24 "Show revision 3145430 of this file in browser") |  |
  | --- | --- | --- |
  | 24 | 24 |  |
  | 25 | 25 | try { |
  | 26 |  | if ( ! wp\_verify\_nonce( $\_REQUEST['wpext\_nonce'], 'wpext-ajax-nonce' ) ) { |
  | 27 |  | throw new \Exception( "Invalid nonce!" ); |
  | 28 |  | } |
  | 29 |  | $post\_ID = intval($\_REQUEST['post\_ID']); |
  | 30 |  | if( empty($post\_ID) ) { |
  | 31 |  | throw new \Exception( "Post ID not specified" ); |
  | 32 |  | } |
  | 33 |  | $duplicate = $this->duplicate\_post( $post\_ID ); |
  | 34 |  | if( is\_wp\_error( $duplicate ) ) { |
  | 35 |  | throw new \Exception( $duplicate->get\_error\_message() ); |
  | 36 |  | } |
  | 37 |  | $duplicate->url = get\_the\_permalink( $duplicate->ID ); |
  | 38 |  | $duplicate->edit\_url = get\_edit\_post\_link( $duplicate, 'json' ); |
  | 39 |  | $result = array( 'status' => true, 'duplicate' => $duplicate ); |
  |  | 26 | if ( ! current\_user\_can( 'edit\_post', $post\_ID ) ) { |
  |  | 27 | throw new \Exception( \_\_( "You are not allowed to duplicate this post.", WP\_EXTENDED\_TEXT\_DOMAIN ) ); |
  |  | 28 | } |
  |  | 29 | if ( ! wp\_verify\_nonce( $\_REQUEST['wpext\_nonce'], 'wpext-ajax-nonce' ) ) { |
  |  | 30 | throw new \Exception( "Invalid nonce!" ); |
  |  | 31 | } |
  |  | 32 | $post\_ID = intval($\_REQUEST['post\_ID']); |
  |  | 33 | if( empty($post\_ID) ) { |
  |  | 34 | throw new \Exception( "Post ID not specified" ); |
  |  | 35 | } |
  |  | 36 | $duplicate = $this->duplicate\_post( $post\_ID ); |
  |  | 37 | if( is\_wp\_error( $duplicate ) ) { |
  |  | 38 | throw new \Exception( $duplicate->get\_error\_message() ); |
  |  | 39 | } |
  |  | 40 | $duplicate->url = get\_the\_permalink( $duplicate->ID ); |
  |  | 41 | $duplicate->edit\_url = get\_edit\_post\_link( $duplicate, 'json' ); |
  |  | 42 | $result = array( 'status' => true, 'duplicate' => $duplicate ); |
  | 40 | 43 | } |
  | 41 | 44 | catch( \Exception $e ) { |
  | […](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_duplicator/wpext_duplicator.php?rev=3099195#L47) | […](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_duplicator/wpext_duplicator.php?rev=3145393#L50) |  |
  | 47 | 50 |  |
  | 48 | 51 | public function duplicate\_post( $post\_ID ) { |
  |  | 52 |  |
  | 49 | 53 | try { |
  | 50 |  | if~~( !current\_user\_can('edit\_posts'~~) ) { |
  | 51 |  | throw new \Exception( ~~"Not allowed"~~ ); |
  |  | 54 | if ( ! current\_user\_can( 'edit\_post', $post\_ID ) ) { |
  |  | 55 | throw new \Exception( \_\_( "You are not allowed to duplicate this post.", WP\_EXTENDED\_TEXT\_DOMAIN ) ); |
  | 52 | 56 | } |
  | 53 | 57 | if( empty($post\_ID) ) { |
  | […](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_duplicator/wpext_duplicator.php?rev=3099195#L58) | […](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_duplicator/wpext_duplicator.php?rev=3145393#L62) |  |
  | 58 | 62 | throw new \Exception( "Source post not found" ); |
  | 59 | 63 | } |
  |  | 64 | // Ensure that contributors can't duplicate password-protected posts. |
  |  | 65 | if ( 'private' === $post->post\_status && ! current\_user\_can( 'read\_private\_posts' ) ) { |
  |  | 66 | throw new \Exception( \_\_( "You cannot duplicate this private post.", WP\_EXTENDED\_TEXT\_DOMAIN ) ); |
  |  | 67 | } |
  |  | 68 |  |
  | 60 | 69 | // copy |
  | 61 | 70 | $newPost = json\_decode( json\_encode($post), true ); |
  | […](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_duplicator/wpext_duplicator.php?rev=3099195#L64) | […](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_duplicator/wpext_duplicator.php?rev=3145393#L73) |  |
  | 64 | 73 | 'comment\_status' => $post->comment\_status, |
  | 65 | 74 | 'ping\_status'    => $post->ping\_status, |
  | 66 |  | 'post\_author'    => ~~$new\_post\_author~~, |
  |  | 75 | 'post\_author'    => get\_current\_user\_id(), |
  | 67 | 76 | 'post\_content'   => $post->post\_content, |
  | 68 | 77 | 'post\_excerpt'   => $post->post\_excerpt, |
* ## [wpextended/trunk/includes/modules/core\_extensions/wpext\_export\_users/wpext\_export\_users.php](/changeset/3145393/wpextended/trunk/includes/modules/core_extensions/wpext_export_users/wpext_export_users.php?old=3112929&old_path=wpextended%2Ftrunk%2Fincludes%2Fmodules%2Fcore_extensions%2Fwpext_export_users%2Fwpext_export_users.php "Show the [3134345:3145430] differences restricted to wpextended/trunk/includes/modules/core_extensions/wpext_export_users/wpext_export_users.php")

  | [r3134345](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_export_users/wpext_export_users.php?rev=3112929#L53 "Show revision 3134345 of this file in browser") | [r3145430](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_export_users/wpext_export_users.php?rev=3145393#L53 "Show revision 3145430 of this file in browser") |  |
  | --- | --- | --- |
  | 53 | 53 | } // get\_items |
  | 54 | 54 | public function download\_user\_ajax(){ |
  |  | 55 | check\_ajax\_referer('wpext-ajax-nonce', 'wpext\_nonce'); |
  |  | 56 | if (!current\_user\_can('export')) { |
  |  | 57 | wp\_send\_json\_error(\_\_('You do not have permission to export users.', WP\_EXTENDED\_TEXT\_DOMAIN)); |
  |  | 58 | wp\_die(); |
  |  | 59 | } |
  | 55 | 60 | try { |
  | 56 |  | $id = $\_GET['id']; |
  | 57 |  | $format = !empty($\_GET['format']) ? $\_GET['format'] : 'csv'; |
  |  | 61 | $id = isset($\_GET['id']) ? intval($\_GET['id']) : 0; |
  |  | 62 | $format = !empty($\_GET['format']) ? sanitize\_text\_field($\_GET['format']) : 'csv'; |
  |  | 63 |  |
  | 58 | 64 | $user = get\_userdata( $id ); |
  | 59 | 65 | if( !$user ) { |
  | […](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_export_users/wpext_export_users.php?rev=3112929#L79) | […](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_export_users/wpext_export_users.php?rev=3145393#L85) |  |
  | 79 | 85 | wp\_die(); |
  | 80 | 86 | } // download\_user\_ajax |
  |  | 87 |  |
  | 81 | 88 | public function profile\_button( $user ) { |
  |  | 89 | if (!current\_user\_can('edit\_user', $user->ID)) { |
  |  | 90 | return; |
  |  | 91 | } |
  | 82 | 92 | $actions = $this->add\_export\_action( array(), $user ); |
  | 83 | 93 | ?> |
* ## [wpextended/trunk/includes/modules/core\_extensions/wpext\_external\_permalinks/wpext\_external\_permalinks.php](/changeset/3145393/wpextended/trunk/includes/modules/core_extensions/wpext_external_permalinks/wpext_external_permalinks.php?old=3105485&old_path=wpextended%2Ftrunk%2Fincludes%2Fmodules%2Fcore_extensions%2Fwpext_external_permalinks%2Fwpext_external_permalinks.php "Show the [3134345:3145430] differences restricted to wpextended/trunk/includes/modules/core_extensions/wpext_external_permalinks/wpext_external_permalinks.php")

  | [r3134345](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_external_permalinks/wpext_external_permalinks.php?rev=3105485#L58 "Show revision 3134345 of this file in browser") | [r3145430](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_external_permalinks/wpext_external_permalinks.php?rev=3145393#L58 "Show revision 3145430 of this file in browser") |  |
  | --- | --- | --- |
  | 58 | 58 | $slug = 'wp-extended-external\_permalink'; |
  | 59 | 59 | $callback = [ get\_called\_class(), 'wpext\_external\_permalink\_interface']; |
  | 60 |  | add\_submenu\_page(~~null~~, '', '', $capability, $slug, $callback); |
  |  | 60 | add\_submenu\_page('', '', '', $capability, $slug, $callback); |
  | 61 | 61 | add\_rewrite\_rule('^wp-extended-external\_permalink/?', 'index.php?wp\_extended\_external\_permalink=1', 'top'); |
  | 62 | 62 | add\_rewrite\_tag('%wp\_extended\_external\_permalink%', '([^&]+)'); |
* ## [wpextended/trunk/includes/modules/core\_extensions/wpext\_hide\_admin\_bar/wpext\_hide\_admin\_bar.php](/changeset/3145393/wpextended/trunk/includes/modules/core_extensions/wpext_hide_admin_bar/wpext_hide_admin_bar.php?old=3099195&old_path=wpextended%2Ftrunk%2Fincludes%2Fmodules%2Fcore_extensions%2Fwpext_hide_admin_bar%2Fwpext_hide_admin_bar.php "Show the [3134345:3145430] differences restricted to wpextended/trunk/includes/modules/core_extensions/wpext_hide_admin_bar/wpext_hide_admin_bar.php")

  | [r3134345](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_hide_admin_bar/wpext_hide_admin_bar.php?rev=3099195#L48 "Show revision 3134345 of this file in browser") | [r3145430](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_hide_admin_bar/wpext_hide_admin_bar.php?rev=3145393#L48 "Show revision 3145430 of this file in browser") |  |
  | --- | --- | --- |
  | 48 | 48 | $slug = 'wp-extended-hide-adminbar'; |
  | 49 | 49 | $callback = [ get\_called\_class(), 'settings\_hide\_admin\_bar']; |
  | 50 |  | add\_submenu\_page(~~null~~, '', '', $capability, $slug, $callback); |
  |  | 50 | add\_submenu\_page('', '', '', $capability, $slug, $callback); |
  | 51 | 51 | add\_rewrite\_rule('^wp-extended-hide-adminbar/?', 'index.php?wp\_extended\_hide\_adminbar=1', 'top'); |
  | 52 | 52 | add\_rewrite\_tag('%wp\_extended\_hide\_adminbar%', '([^&]+)'); |
* ## [wpextended/trunk/includes/modules/core\_extensions/wpext\_limit\_login\_attempts/wpext\_limit\_login\_attempts.php](/changeset/3145393/wpextended/trunk/includes/modules/core_extensions/wpext_limit_login_attempts/wpext_limit_login_attempts.php?old=3109167&old_path=wpextended%2Ftrunk%2Fincludes%2Fmodules%2Fcore_extensions%2Fwpext_limit_login_attempts%2Fwpext_limit_login_attempts.php "Show the [3134345:3145430] differences restricted to wpextended/trunk/includes/modules/core_extensions/wpext_limit_login_attempts/wpext_limit_login_attempts.php")

  | [r3134345](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_limit_login_attempts/wpext_limit_login_attempts.php?rev=3109167#L56 "Show revision 3134345 of this file in browser") | [r3145430](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_limit_login_attempts/wpext_limit_login_attempts.php?rev=3145393#L56 "Show revision 3145430 of this file in browser") |  |
  | --- | --- | --- |
  | 56 | 56 | $slug = 'wp-extended\_login\_attempt'; |
  | 57 | 57 | $callback = [ get\_called\_class(), 'settings\_admin\_login\_attempt']; |
  | 58 |  | add\_submenu\_page(~~null~~, '', '', $capability, $slug, $callback); |
  |  | 58 | add\_submenu\_page('', '', '', $capability, $slug, $callback); |
  | 59 | 59 | add\_rewrite\_rule('^wp-extended\_login\_attempt/?', 'index.php?wp\_extended\_login\_attempt=1', 'top'); |
  | 60 | 60 | add\_rewrite\_tag('%wp\_extended\_login\_attempt%', '([^&]+)'); |
* ## [wpextended/trunk/includes/modules/core\_extensions/wpext\_maintenance\_mode/wpext\_maintenance\_mode.php](/changeset/3145393/wpextended/trunk/includes/modules/core_extensions/wpext_maintenance_mode/wpext_maintenance_mode.php?old=3112929&old_path=wpextended%2Ftrunk%2Fincludes%2Fmodules%2Fcore_extensions%2Fwpext_maintenance_mode%2Fwpext_maintenance_mode.php "Show the [3134345:3145430] differences restricted to wpextended/trunk/includes/modules/core_extensions/wpext_maintenance_mode/wpext_maintenance_mode.php")

  | [r3134345](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_maintenance_mode/wpext_maintenance_mode.php?rev=3112929#L92 "Show revision 3134345 of this file in browser") | [r3145430](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_maintenance_mode/wpext_maintenance_mode.php?rev=3145393#L92 "Show revision 3145430 of this file in browser") |  |
  | --- | --- | --- |
  | 92 | 92 | $slug = 'wp-extended-maintenance-mode'; |
  | 93 | 93 | $callback = [ get\_called\_class(), 'settings\_admin\_maintenance\_mode']; |
  | 94 |  | add\_submenu\_page(~~null~~, '', '', $capability, $slug, $callback); |
  |  | 94 | add\_submenu\_page('', '', '', $capability, $slug, $callback); |
  | 95 | 95 | add\_rewrite\_rule('^wp-extended-maintenance-mode/?', 'index.php?wp\_extended\_maintenance\_mode=1', 'top'); |
  | 96 | 96 | add\_rewrite\_tag('%wp\_extended\_maintenance\_mode%', '([^&]+)'); |
* ## [wpextended/trunk/includes/modules/core\_extensions/wpext\_pixel\_tag\_manager/wpext\_pixel\_tag\_manager.php](/changeset/3145393/wpextended/trunk/includes/modules/core_extensions/wpext_pixel_tag_manager/wpext_pixel_tag_manager.php?old=3099195&old_path=wpextended%2Ftrunk%2Fincludes%2Fmodules%2Fcore_extensions%2Fwpext_pixel_tag_manager%2Fwpext_pixel_tag_manager.php "Show the [3134345:3145430] differences restricted to wpextended/trunk/includes/modules/core_extensions/wpext_pixel_tag_manager/wpext_pixel_tag_manager.php")

  | [r3134345](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_pixel_tag_manager/wpext_pixel_tag_manager.php?rev=3099195#L48 "Show revision 3134345 of this file in browser") | [r3145430](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_pixel_tag_manager/wpext_pixel_tag_manager.php?rev=3145393#L48 "Show revision 3145430 of this file in browser") |  |
  | --- | --- | --- |
  | 48 | 48 | $capability = 'manage\_options'; |
  | 49 | 49 | $callback = [get\_called\_class(), 'settings\_pixel\_tag\_manager']; |
  | 50 |  | add\_submenu\_page(~~null~~, '', '', $capability, $slug, $callback); |
  |  | 50 | add\_submenu\_page('', '', '', $capability, $slug, $callback); |
  | 51 | 51 | add\_rewrite\_rule('^wp-extended-pixel-tag-manager/?', 'index.php?wp\_extended\_pixel\_tag\_manager=1', 'top'); |
  | 52 | 52 | add\_rewrite\_tag('%wp\_extended\_pixel\_tag\_manager%', '([^&]+)'); |
* ## [wpextended/trunk/includes/modules/core\_extensions/wpext\_post\_order/wpext\_post\_order.php](/changeset/3145393/wpextended/trunk/includes/modules/core_extensions/wpext_post_order/wpext_post_order.php?old=3099195&old_path=wpextended%2Ftrunk%2Fincludes%2Fmodules%2Fcore_extensions%2Fwpext_post_order%2Fwpext_post_order.php "Show the [3134345:3145430] differences restricted to wpextended/trunk/includes/modules/core_extensions/wpext_post_order/wpext_post_order.php")

  | [r3134345](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_post_order/wpext_post_order.php?rev=3099195#L80 "Show revision 3134345 of this file in browser") | [r3145430](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_post_order/wpext_post_order.php?rev=3145393#L80 "Show revision 3145430 of this file in browser") |  |
  | --- | --- | --- |
  | 80 | 80 | $query .= ( $query ? "&" : "" ) . $extra; |
  | 81 | 81 | $url = $path . "?" . $query; |
  | 82 |  | wp\_redirect( $url, 302, 'WP-Extended-Post-order' ); |
  | 83 |  | exit; |
  |  | 82 | if($screen->post\_type != 'page'){ |
  |  | 83 | wp\_redirect($url, 302, 'WP-Extended-Post-order'); |
  |  | 84 | exit; |
  |  | 85 | } |
  | 84 | 86 | } |
  | 85 | 87 | else if( $\_REQUEST['orderby'] === 'menu\_order' ) { |
* ## [wpextended/trunk/includes/modules/core\_extensions/wpext\_smtp\_email/wpext\_smtp\_email.php](/changeset/3145393/wpextended/trunk/includes/modules/core_extensions/wpext_smtp_email/wpext_smtp_email.php?old=3131199&old_path=wpextended%2Ftrunk%2Fincludes%2Fmodules%2Fcore_extensions%2Fwpext_smtp_email%2Fwpext_smtp_email.php "Show the [3134345:3145430] differences restricted to wpextended/trunk/includes/modules/core_extensions/wpext_smtp_email/wpext_smtp_email.php")

  | [r3134345](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_smtp_email/wpext_smtp_email.php?rev=3131199#L37 "Show revision 3134345 of this file in browser") | [r3145430](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_smtp_email/wpext_smtp_email.php?rev=3145393#L37 "Show revision 3145430 of this file in browser") |  |
  | --- | --- | --- |
  | 37 | 37 | $callback = [$this, 'wp\_extended\_smtp\_settings\_page']; |
  | 38 | 38 | $icon = 'dashicons-admin-plugins'; |
  | 39 |  | add\_submenu\_page(~~null~~, '', '', $capability, $slug, $callback); |
  |  | 39 | add\_submenu\_page('', '', '', $capability, $slug, $callback); |
  | 40 | 40 | add\_rewrite\_rule('^wp-extended\_smtp-settings/?', 'index.php?wp\_extended\_smtp-settings=1', 'top'); |
  | 41 | 41 | add\_rewrite\_tag('%wp\_extended\_smtp-settings%', '([^&]+)'); |
* ## [wpextended/trunk/includes/modules/core\_extensions/wpext\_snippets/old/wpext\_snippets.php](/changeset/3145393/wpextended/trunk/includes/modules/core_extensions/wpext_snippets/old/wpext_snippets.php?old=3128457&old_path=wpextended%2Ftrunk%2Fincludes%2Fmodules%2Fcore_extensions%2Fwpext_snippets%2Fold%2Fwpext_snippets.php "Show the [3134345:3145430] differences restricted to wpextended/trunk/includes/modules/core_extensions/wpext_snippets/old/wpext_snippets.php")

  | [r3134345](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_snippets/old/wpext_snippets.php?rev=3128457#L42 "Show revision 3134345 of this file in browser") | [r3145430](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_snippets/old/wpext_snippets.php?rev=3145393#L42 "Show revision 3145430 of this file in browser") |  |
  | --- | --- | --- |
  | 42 | 42 | if((isset($menustatus) && $menustatus == 'true') && !empty($flagfavorite) ) { |
  | 43 | 43 | add\_submenu\_page( |
  | 44 |  | ~~null~~, |
  |  | 44 | '', |
  | 45 | 45 | \_\_( 'Code Snippets Old', WP\_EXTENDED\_TEXT\_DOMAIN ), // page title |
  | 46 | 46 | \_\_( 'Code Snippets Old', WP\_EXTENDED\_TEXT\_DOMAIN ), // menu title |
  | […](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_snippets/old/wpext_snippets.php?rev=3128457#L52) | […](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_snippets/old/wpext_snippets.php?rev=3145393#L52) |  |
  | 52 | 52 | $slug = 'wp-extended-snippets-old'; |
  | 53 | 53 | $callback = [ $this, 'page\_cb\_old']; |
  | 54 |  | add\_submenu\_page(~~null~~, '', '', $capability, $slug, $callback); |
  |  | 54 | add\_submenu\_page('', '', '', $capability, $slug, $callback); |
  | 55 | 55 | add\_rewrite\_rule('^wp-extended-snippets-old/?', 'index.php?wp\_extended\_snippets=1', 'top'); |
  | 56 | 56 | add\_rewrite\_tag('%wp\_extended\_snippets%', '([^&]+)'); |
* ## [wpextended/trunk/includes/modules/core\_extensions/wpext\_snippets/wp-extend-module-listing.php](/changeset/3145393/wpextended/trunk/includes/modules/core_extensions/wpext_snippets/wp-extend-module-listing.php?old=3134252&old_path=wpextended%2Ftrunk%2Fincludes%2Fmodules%2Fcore_extensions%2Fwpext_snippets%2Fwp-extend-module-listing.php "Show the [3134345:3145430] differences restricted to wpextended/trunk/includes/modules/core_extensions/wpext_snippets/wp-extend-module-listing.php")

  | [r3134345](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_snippets/wp-extend-module-listing.php?rev=3134252#L113 "Show revision 3134345 of this file in browser") | [r3145430](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_snippets/wp-extend-module-listing.php?rev=3145393#L113 "Show revision 3145430 of this file in browser") |  |
  | --- | --- | --- |
  | 113 | 113 | if ('duplicate' === $this->current\_action() && isset($\_GET['snippet\_id'])) { |
  | 114 | 114 | $nonce = $\_REQUEST['\_wpnonce']; |
  | 115 |  | if (~~!wp\_verify\_nonce($nonce, 'duplicate\_snippet\_' . $\_GET['snippet\_id'])~~) { |
  |  | 115 | if ( !wp\_verify\_nonce( $nonce, 'duplicate\_snippet\_' . sanitize\_text\_field( $\_GET['snippet\_id'] ) ) ) { |
  | 116 | 116 | die('Security check failed'); |
  | 117 | 117 | } |
  | 118 |  | $this->duplicate\_snippet(~~$\_GET['snippet\_id']~~); |
  |  | 118 | $this->duplicate\_snippet( sanitize\_text\_field($\_GET['snippet\_id']) ); |
  | 119 | 119 | } |
  | 120 | 120 | } |
  | […](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_snippets/wp-extend-module-listing.php?rev=3134252#L155) | […](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_snippets/wp-extend-module-listing.php?rev=3145393#L155) |  |
  | 155 | 155 | public function current\_action() { |
  | 156 | 156 | if (isset($\_REQUEST['action']) && $\_REQUEST['action'] !== -1) { |
  | 157 |  | return ~~$\_REQUEST['action']~~; |
  |  | 157 | return sanitize\_key($\_REQUEST['action']); |
  | 158 | 158 | } |
  | 159 | 159 |  |
  | 160 | 160 | if (isset($\_REQUEST['action2']) && $\_REQUEST['action2'] !== -1) { |
  | 161 |  | return ~~$\_REQUEST['action2']~~; |
  |  | 161 | return sanitize\_key($\_REQUEST['action2']); |
  | 162 | 162 | } |
  | 163 | 163 |  |
  | […](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_snippets/wp-extend-module-listing.php?rev=3134252#L214) | […](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_snippets/wp-extend-module-listing.php?rev=3145393#L214) |  |
  | 214 | 214 | $items = $custom\_list\_table->get\_items(); ?> |
  | 215 | 215 | <form method="get"> |
  | 216 |  | <input type="hidden" name="page" value="<?php echo ~~$\_REQUEST['page']~~; ?>"> |
  |  | 216 | <input type="hidden" name="page" value="<?php echo esc\_attr( sanitize\_text\_field( $\_REQUEST['page'] ) ); ?>"> |
  | 217 | 217 | <?php $custom\_list\_table->search\_box('Search Snippets', 'search\_id'); ?> |
  | 218 | 218 | </form> |
* ## [wpextended/trunk/includes/modules/core\_extensions/wpext\_snippets/wpext\_snippets.php](/changeset/3145393/wpextended/trunk/includes/modules/core_extensions/wpext_snippets/wpext_snippets.php?old=3128457&old_path=wpextended%2Ftrunk%2Fincludes%2Fmodules%2Fcore_extensions%2Fwpext_snippets%2Fwpext_snippets.php "Show the [3134345:3145430] differences restricted to wpextended/trunk/includes/modules/core_extensions/wpext_snippets/wpext_snippets.php")

  | [r3134345](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_snippets/wpext_snippets.php?rev=3128457#L104 "Show revision 3134345 of this file in browser") | [r3145430](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_snippets/wpext_snippets.php?rev=3145393#L104 "Show revision 3145430 of this file in browser") |  |
  | --- | --- | --- |
  | 104 | 104 | $slug = 'wp-extended-snippets'; |
  | 105 | 105 | $callback = [ $this, 'list\_snippets\_page']; |
  | 106 |  | add\_submenu\_page(~~null~~, '', '', $capability, $slug, $callback); |
  |  | 106 | add\_submenu\_page('', '', '', $capability, $slug, $callback); |
  | 107 | 107 | add\_rewrite\_rule('^wp-extended-snippets/?', 'index.php?wp\_extended\_snippets=1', 'top'); |
  | 108 | 108 | add\_rewrite\_tag('%wp\_extended\_snippets%', '([^&]+)'); |
  | 109 | 109 | } |
  | 110 |  | add\_submenu\_page(~~null~~, \_\_('Add New Snippet', 'wp-extended-snippets'), \_\_('Add New Snippet', 'wp-extended-snippets'), 'manage\_options', 'wp-extended-add-snippet', array($this, 'wpext\_add\_snippet\_page')); |
  | 111 |  | add\_submenu\_page(~~null~~, \_\_('Edit Snippet', 'wp-extended-snippets'), \_\_('Edit Snippet', 'wp-extended-snippets'), 'manage\_options', 'wp-extended-edit-snippet', array($this, 'edit\_snippet\_page')); |
  |  | 110 | add\_submenu\_page('', \_\_('Add New Snippet', 'wp-extended-snippets'), \_\_('Add New Snippet', 'wp-extended-snippets'), 'manage\_options', 'wp-extended-add-snippet', array($this, 'wpext\_add\_snippet\_page')); |
  |  | 111 | add\_submenu\_page('', \_\_('Edit Snippet', 'wp-extended-snippets'), \_\_('Edit Snippet', 'wp-extended-snippets'), 'manage\_options', 'wp-extended-edit-snippet', array($this, 'edit\_snippet\_page')); |
  | 112 | 112 | } |
  | 113 | 113 |  |
  | […](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_snippets/wpext_snippets.php?rev=3128457#L291) | […](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_snippets/wpext_snippets.php?rev=3145393#L291) |  |
  | 291 | 291 | <div class="wpext\_snippet\_top\_section d-flex mb-3"> |
  | 292 | 292 | <div class="col-3"> |
  | 293 |  | <h2 class="wpext\_snippet\_title"> <?php echo $selected\_option = isset($\_GET['selected\_option']) ? $\_GET['selected\_option'] : ''; ?></h2> |
  |  | 293 | <h2 class="wpext\_snippet\_title"> |
  |  | 294 | <?php |
  |  | 295 | $selected\_option = isset($\_GET['selected\_option']) ? sanitize\_text\_field($\_GET['selected\_option']) : ''; |
  |  | 296 | echo esc\_html($selected\_option); |
  |  | 297 | ?> |
  |  | 298 | </h2> |
  | 294 | 299 | <?php self::wpext\_custom\_css\_content($selected\_option); ?> |
  | 295 | 300 | <input type="hidden" name="snippet\_position" value="<?php echo $selected\_option; ?>" id="snippet\_code\_type"> |
  | […](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_snippets/wpext_snippets.php?rev=3128457#L548) | […](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_snippets/wpext_snippets.php?rev=3145393#L553) |  |
  | 548 | 553 | } |
  | 549 | 554 | // Additional check for the specific snippets page |
  | 550 |  | if ($pagenow === 'admin.php' && isset($\_GET['page']) && ~~$\_GET['page']~~ === 'wp-extended-snippets') { |
  |  | 555 | if ($pagenow === 'admin.php' && isset($\_GET['page']) && sanitize\_text\_field($\_GET['page']) === 'wp-extended-snippets') { |
  | 551 | 556 | return false; |
  | 552 | 557 | } |
  | […](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_snippets/wpext_snippets.php?rev=3128457#L680) | […](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_snippets/wpext_snippets.php?rev=3145393#L685) |  |
  | 680 | 685 | <div class="col-lg-6 wp\_brand\_sub\_header\_right mx-lg-0 px-2"> |
  | 681 | 686 | <div class="wpext-return-module-wrap wpext\_snippet\_action"> |
  | 682 |  | <?php if(isset($\_GET['page']) && ~~$\_GET['page']~~ == 'wp-extended-snippets') { ?> |
  |  | 687 | <?php if(isset($\_GET['page']) && sanitize\_text\_field($\_GET['page']) == 'wp-extended-snippets') { ?> |
  | 683 | 688 | <button class="page-title-action wp-ext-btn-prim" ><?php \_e('Add New', WP\_EXTENDED\_TEXT\_DOMAIN);?></button> |
  | 684 | 689 | <?php } ?> |
  | 685 |  | <?php if(isset($\_GET['page']) && ~~$\_GET['page']~~ == 'wp-extended-add-snippet') { ?> |
  |  | 690 | <?php if(isset($\_GET['page']) && sanitize\_text\_field($\_GET['page']) == 'wp-extended-add-snippet') { ?> |
  | 686 | 691 | <a href='<?php echo admin\_url('admin.php?page=wp-extended-snippets'); ?>' class="wp-ext-btn-sec"><?php \_e('Back to Snippets', WP\_EXTENDED\_TEXT\_DOMAIN);?></a> |
  | 687 | 692 | <button class="wpext\_module\_action wp-ext-btn-prim wpext\_save\_snippet" ><?php \_e('Save', WP\_EXTENDED\_TEXT\_DOMAIN);?></button> |
  | 688 | 693 | <?php } |
  | 689 |  | if(isset($\_GET['page']) && ~~$\_GET['page']~~ == 'wp-extended-edit-snippet') { ?> |
  |  | 694 | if(isset($\_GET['page']) && sanitize\_text\_field($\_GET['page']) == 'wp-extended-edit-snippet') { ?> |
  | 690 | 695 | <a href='<?php echo admin\_url('admin.php?page=wp-extended-snippets'); ?>' class="wp-ext-btn-sec"><?php \_e('Back to Snippets', WP\_EXTENDED\_TEXT\_DOMAIN);?></a> |
  | 691 | 696 | <button class="wpext\_module\_action wp-ext-btn-prim wpext\_updeate\_code\_snippets" ><?php \_e('Save', WP\_EXTENDED\_TEXT\_DOMAIN);?></button> |
* ## [wpextended/trunk/includes/modules/core\_extensions/wpext\_tidy\_nav/wpext\_tidy\_nav.php](/changeset/3145393/wpextended/trunk/includes/modules/core_extensions/wpext_tidy_nav/wpext_tidy_nav.php?old=3112929&old_path=wpextended%2Ftrunk%2Fincludes%2Fmodules%2Fcore_extensions%2Fwpext_tidy_nav%2Fwpext_tidy_nav.php "Show the [3134345:3145430] differences restricted to wpextended/trunk/includes/modules/core_extensions/wpext_tidy_nav/wpext_tidy_nav.php")

  | [r3134345](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_tidy_nav/wpext_tidy_nav.php?rev=3112929#L79 "Show revision 3134345 of this file in browser") | [r3145430](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_tidy_nav/wpext_tidy_nav.php?rev=3145393#L79 "Show revision 3145430 of this file in browser") |  |
  | --- | --- | --- |
  | 79 | 79 | $slug = 'wp-extended-tidymenu'; |
  | 80 | 80 | $callback = [ get\_called\_class(), 'settings\_tidy\_menu']; |
  | 81 |  | add\_submenu\_page(~~null~~, '', '', $capability, $slug, $callback); |
  |  | 81 | add\_submenu\_page('', '', '', $capability, $slug, $callback); |
  | 82 | 82 | add\_rewrite\_rule('^wp-extended-tidymenu/?', 'index.php?wp\_extended\_tidymenu=1', 'top'); |
  | 83 | 83 | add\_rewrite\_tag('%wp\_extended\_tidymenu%', '([^&]+)'); |
* ## [wpextended/trunk/includes/modules/core\_extensions/wpext\_user\_sections/wpext\_user\_sections.php](/changeset/3145393/wpextended/trunk/includes/modules/core_extensions/wpext_user_sections/wpext_user_sections.php?old=3099195&old_path=wpextended%2Ftrunk%2Fincludes%2Fmodules%2Fcore_extensions%2Fwpext_user_sections%2Fwpext_user_sections.php "Show the [3134345:3145430] differences restricted to wpextended/trunk/includes/modules/core_extensions/wpext_user_sections/wpext_user_sections.php")

  | [r3134345](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_user_sections/wpext_user_sections.php?rev=3099195#L76 "Show revision 3134345 of this file in browser") | [r3145430](/browser/wpextended/trunk/includes/modules/core_extensions/wpext_user_sections/wpext_user_sections.php?rev=3145393#L76 "Show revision 3145430 of this file in browser") |  |
  | --- | --- | --- |
  | 76 | 76 | $slug = 'wp-extended-user-sections'; |
  | 77 | 77 | $callback = [ $this, 'page\_cb']; |
  | 78 |  | add\_submenu\_page(~~null~~, '', '', $capability, $slug, $callback); |
  |  | 78 | add\_submenu\_page('', '', '', $capability, $slug, $callback); |
  | 79 | 79 | add\_rewrite\_rule('^wp-extended-user-sections/?', 'index.php?wp\_extended\_user\_sections=1', 'top'); |
  | 80 | 80 | add\_rewrite\_tag('%wp\_extended\_user\_sections%', '([^&]+)'); |
* ## [wpextended/trunk/readme.txt](/changeset/3145393/wpextended/trunk/readme.txt?old=3134345&old_path=wpextended%2Ftrunk%2Freadme.txt "Show the [3134345:3145430] differences restricted to wpextended/trunk/readme.txt")

  | [r3134345](/browser/wpextended/trunk/readme.txt?rev=3134345#L4 "Show revision 3134345 of this file in browser") | [r3145430](/browser/wpextended/trunk/readme.txt?rev=3145393#L4 "Show revision 3145430 of this file in browser") |  |
  | --- | --- | --- |
  | 4 | 4 | Requires at least: 5.6 |
  | 5 | 5 | Tested up to: 6.6.1 |
  | 6 |  | Stable tag: 3.0.~~8~~ |
  |  | 6 | Stable tag: 3.0.9 |
  | 7 | 7 | Requires PHP: 7.4 |
  | 8 | 8 | License: GPLv2 or later |
  | […](/browser/wpextended/trunk/readme.txt?rev=3134345#L141) | […](/browser/wpextended/trunk/readme.txt?rev=3145393#L141) |  |
  | 141 | 141 | == Changelog == |
  | 142 | 142 |  |
  |  | 143 | = 3.0.9 - 02 September 2024 = |
  |  | 144 | \* Improvement: Hide "Active Modules" until enabled any one module. |
  |  | 145 | \* Update: Part of the Patchstack VDP Program. |
  |  | 146 | \* Fix: Post Type Order - Post type order not working with hierarchical parent/children. |
  |  | 147 | \* Fix: Warnings fixed for PHP 8.\* |
  |  | 148 | \* Security Fix: Code snippet module - Escaping and sanitising output. |
  |  | 149 | \* Security Fix: Duplicate Duplicate Pages/Posts module - Added user capability checks. |
  |  | 150 | \* Security Fix: Block username module - Added user capability checks. |
  |  | 151 |  |
  | 143 | 152 | = 3.0.8 - 12 August 2024 = |
  | 144 | 153 | \* Improvement: Code snippet - Duplicate functionality. |
  | 145 |  | \* Improvement:  Quick Add Post - Updated module description. |
  |  | 154 | \* Improvement: Hide "Active Modules" until active any one module. |
  |  | 155 | \* Improvement:  Quick Add Post - Updated module description |
  | 146 | 156 | \* Fix: mkdir issue on some servers. |
  | 147 |  | \* Fix: Duplicate Menu - Updated correct Read Documentation link~~.~~ |
  |  | 157 | \* Fix: Duplicate Menu - Updated correct Read Documentation link |
  | 148 | 158 |  |
  | 149 | 159 | = 3.0.7 - 5 August 2024 = |
  | […](/browser/wpextended/trunk/readme.txt?rev=3134345#L409) | […](/browser/wpextended/trunk/readme.txt?rev=3145393#L419) |  |
  | 409 | 419 | The "Disable Blog" module is designed for websites that don't require a blog feature. By disabling blog-related functionalities, this module helps streamline your admin area. |
  | 410 | 420 |  |
  |  | 421 | = How can I report security bugs? = |
  |  | 422 |  |
  |  | 423 | You can report security bugs through the Patchstack Vulnerability Disclosure Program. The Patchstack team help validate, triage and handle any security vulnerabilities. [Report a security vulnerability.](https://patchstack.com/database/vdp/wpextended) |
* ## [wpextended/trunk/wp-extended.php](/changeset/3145393/wpextended/trunk/wp-extended.php?old=3134252&old_path=wpextended%2Ftrunk%2Fwp-extended.php "Show the [3134345:3145430] differences restricted to wpextended/trunk/wp-extended.php")

  | [r3134345](/browser/wpextended/trunk/wp-extended.php?rev=3134252#L4 "Show revision 3134345 of this file in browser") | [r3145430](/browser/wpextended/trunk/wp-extended.php?rev=3145393#L4 "Show revision 3145430 of this file in browser") |  |
  | --- | --- | --- |
  | 4 | 4 | \* Plugin URI: https://wordpress.org/plugins/wpextended |
  | 5 | 5 | \* Description: Many of your favourite plugins rolled up into 1 modular plugin making your WordPress faster and easier to manage. |
  | 6 |  | \* Version: 3.0.~~8~~ |
  |  | 6 | \* Version: 3.0.9 |
  | 7 | 7 | \* Requires at least: 5.6 |
  | 8 | 8 | \* Requires PHP:      7.4 |
  | […](/browser/wpextended/trunk/wp-extended.php?rev=3134252#L28) | […](/browser/wpextended/trunk/wp-extended.php?rev=3145393#L28) |  |
  | 28 | 28 |  |
  | 29 | 29 | }else{ |
  | 30 |  | define( 'WP\_EXTENDED\_VERSION', '3.0.~~8~~' ); |
  |  | 30 | define( 'WP\_EXTENDED\_VERSION', '3.0.9' ); |
  | 31 | 31 | define( 'WP\_EXTENDED\_TEXT\_DOMAIN', 'wp-extended' ); |
  | 32 | 32 | define( 'WP\_EXTENDED\_PATH', plugin\_dir\_path( \_\_FILE\_\_ ) ); |

**Note:** See [TracChangeset](/wiki/TracChangeset)
for help on using the changeset viewer.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Unified Diff](?format=diff&new=3145430&old=3134345&new_path=%2Fwpextended%2Ftrunk&old_path=%2Fwpextended%2Ftrunk)
* [Zip Archive](?format=zip&new=3145430&old=3134345&new_path=%2Fwpextended%2Ftrunk&old_path=%2Fwpextended%2Ftrunk)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)


