```
{
  "vulnerability_details": {
    "root_cause": "A heap-based buffer write overflow was discovered in UPX's PackTmt::pack function.",
    "weaknesses": [
      "Heap-based buffer overflow"
    ],
    "impact": "Memory corruption leading to undefined behavior, ranging from denial-of-service (application abort) to potential code execution.",
     "attack_vectors": [
        "Crafted input file processed by UPX"
    ],
    "required_capabilities": "An attacker needs to provide a specially crafted file as input to the UPX executable."
  },
  "affected_software": [
    {
      "name": "upx-ucl",
      "versions": [
          "prior to 3.96-2+deb11u1 (Debian)",
          "prior to 4.0.1-2.fc37 (Fedora 37)",
          "prior to 4.0.1-2.fc36 (Fedora 36)",
          "4.0.1 (Vulnerable version reported on Github issue)"
        ]
    }
  ],
  "references": [
    "https://www.debian.org/lts/security/",
    "https://wiki.debian.org/LTS",
    "https://security-tracker.debian.org/tracker/upx-ucl",
    "https://bugzilla.redhat.com/show_bug.cgi?id=2160383",
    "https://bugzilla.redhat.com/show_bug.cgi?id=2160385",
    "https://github.com/upx/upx/issues/632",
    "https://github.com/upx/upx/commit/510505a85cbe45e51fbd470f1aa8b02157c429d4",
    "https://github.com/upx/upx/commit/3e6e17980af856f71ab213cdefeb8ba8fd487eea"
  ],
    "additional_notes": "The vulnerability was triggered by an attempt to allocate zero bytes for a MemBuffer, leading to a failed assertion in mem.cpp, and subsequent heap buffer overflow due to incorrect handling of file metadata. The fix involves more robust input validation, particularly of the image size, entry point, and relocation size, to prevent an attempt to allocate zero bytes, along with improved checks for already compressed files to avoid triggering the vulnerable code path."
}
```