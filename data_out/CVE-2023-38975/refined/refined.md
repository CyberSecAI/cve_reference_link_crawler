- **Root cause of vulnerability**: The vulnerability stems from improper handling of the vector dimension (`dim`) during collection creation in the Qdrant vector database. Specifically, the system fails to validate or limit the size of the vector dimension, leading to division by zero errors or excessive memory allocation, causing a denial of service.
- **Weaknesses/vulnerabilities present**:
    - **Division by zero**: When the calculated `vector_size` becomes zero (due to an excessively large `dim`), a division by zero error occurs in `chunked_vectors.rs#L28`, causing a crash.
    - **Out-of-memory (OOM)**: When an excessively large `dim` is provided, the system tries to allocate an enormous amount of memory (e.g., `2**59` bytes), leading to memory allocation failure and service termination.
- **Impact of exploitation**:
    - **Denial of service (DoS)**: Exploiting this vulnerability can lead to the service crashing, making the vector database unavailable. Users cannot use the vector database normally.
- **Attack vectors**:
    - **API calls**: By crafting specific API requests with an extremely large `dim` when creating a collection, an attacker can trigger the vulnerability. In the provided PoC, the `recreate_collection` method of the `qdrant_client` is used with a large vector size.
- **Required attacker capabilities/position**:
    - The attacker needs to have the ability to interact with the Qdrant API, i.e. create collections via an API.