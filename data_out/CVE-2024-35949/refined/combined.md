=== Content from lists.fedoraproject.org_ed8eb6b2_20250110_182049.html ===


[![Fedora Mailing-Lists](/static/logo-hyperkitty-fedora.png)](/archives/ "Fedora Mailing-Lists")

[Sign In](/accounts/login/?next=/archives/list/package-announce%40lists.fedoraproject.org/message/OTB4HWU2PTVW5NEYHHLOCXDKG3PYA534/)
[Sign Up](/accounts/signup/?next=/archives/list/package-announce%40lists.fedoraproject.org/message/OTB4HWU2PTVW5NEYHHLOCXDKG3PYA534/)

* [Sign In](/accounts/login/?next=/archives/list/package-announce%40lists.fedoraproject.org/message/OTB4HWU2PTVW5NEYHHLOCXDKG3PYA534/)
* [Sign Up](/accounts/signup/?next=/archives/list/package-announce%40lists.fedoraproject.org/message/OTB4HWU2PTVW5NEYHHLOCXDKG3PYA534/)

* [Manage this list](/admin/lists/package-announce.lists.fedoraproject.org/)

Ã—
#### Keyboard Shortcuts

### Thread View

* `j`: Next unread message
* `k`: Previous unread message
* `j a`: Jump to all threads* `j l`: Jump to MailingList overview

### 2025

* [January](/archives/list/package-announce%40lists.fedoraproject.org/2025/1/)

### 2024

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2024/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2024/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2024/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2024/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2024/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2024/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2024/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2024/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2024/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2024/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2024/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2024/1/)

### 2023

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2023/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2023/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2023/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2023/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2023/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2023/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2023/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2023/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2023/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2023/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2023/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2023/1/)

### 2022

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2022/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2022/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2022/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2022/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2022/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2022/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2022/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2022/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2022/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2022/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2022/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2022/1/)

### 2021

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2021/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2021/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2021/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2021/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2021/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2021/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2021/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2021/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2021/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2021/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2021/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2021/1/)

### 2020

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2020/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2020/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2020/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2020/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2020/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2020/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2020/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2020/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2020/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2020/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2020/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2020/1/)

### 2019

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2019/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2019/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2019/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2019/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2019/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2019/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2019/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2019/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2019/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2019/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2019/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2019/1/)

### 2018

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2018/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2018/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2018/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2018/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2018/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2018/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2018/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2018/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2018/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2018/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2018/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2018/1/)

### 2017

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2017/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2017/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2017/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2017/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2017/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2017/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2017/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2017/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2017/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2017/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2017/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2017/1/)

### 2016

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2016/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2016/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2016/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2016/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2016/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2016/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2016/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2016/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2016/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2016/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2016/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2016/1/)

### 2015

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2015/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2015/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2015/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2015/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2015/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2015/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2015/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2015/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2015/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2015/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2015/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2015/1/)

### 2014

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2014/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2014/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2014/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2014/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2014/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2014/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2014/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2014/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2014/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2014/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2014/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2014/1/)

### 2013

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2013/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2013/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2013/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2013/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2013/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2013/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2013/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2013/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2013/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2013/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2013/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2013/1/)

### 2012

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2012/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2012/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2012/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2012/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2012/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2012/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2012/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2012/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2012/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2012/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2012/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2012/1/)

### 2011

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2011/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2011/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2011/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2011/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2011/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2011/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2011/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2011/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2011/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2011/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2011/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2011/1/)

### 2010

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2010/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2010/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2010/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2010/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2010/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2010/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2010/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2010/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2010/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2010/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2010/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2010/1/)

### 2009

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2009/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2009/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2009/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2009/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2009/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2009/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2009/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2009/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2009/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2009/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2009/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2009/1/)

### 2008

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2008/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2008/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2008/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2008/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2008/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2008/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2008/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2008/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2008/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2008/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2008/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2008/1/)

### 2007

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2007/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2007/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2007/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2007/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2007/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2007/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2007/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2007/5/)
* [April](/archives/list/package-announce%40lists.fedoraproject.org/2007/4/)
* [March](/archives/list/package-announce%40lists.fedoraproject.org/2007/3/)
* [February](/archives/list/package-announce%40lists.fedoraproject.org/2007/2/)
* [January](/archives/list/package-announce%40lists.fedoraproject.org/2007/1/)

### 2006

* [December](/archives/list/package-announce%40lists.fedoraproject.org/2006/12/)
* [November](/archives/list/package-announce%40lists.fedoraproject.org/2006/11/)
* [October](/archives/list/package-announce%40lists.fedoraproject.org/2006/10/)
* [September](/archives/list/package-announce%40lists.fedoraproject.org/2006/9/)
* [August](/archives/list/package-announce%40lists.fedoraproject.org/2006/8/)
* [July](/archives/list/package-announce%40lists.fedoraproject.org/2006/7/)
* [June](/archives/list/package-announce%40lists.fedoraproject.org/2006/6/)
* [May](/archives/list/package-announce%40lists.fedoraproject.org/2006/5/)

[List overview](/archives/list/package-announce%40lists.fedoraproject.org/)

[Download](/archives/list/package-announce%40lists.fedoraproject.org/export/package-announce%40lists.fedoraproject.org-OTB4HWU2PTVW5NEYHHLOCXDKG3PYA534.mbox.gz?message=OTB4HWU2PTVW5NEYHHLOCXDKG3PYA534 "This message in gzipped mbox format")

[thread](/archives/list/package-announce%40lists.fedoraproject.org/thread/OTB4HWU2PTVW5NEYHHLOCXDKG3PYA534/#OTB4HWU2PTVW5NEYHHLOCXDKG3PYA534)

# [SECURITY] Fedora 40 Update: kernel-6.8.10-300.fc40

![](https://seccdn.libravatar.org/avatar/be256568dfce45c1862b55e6cf3f2726.jpg?s=120&d=retro&r=g)

[updatesï¼ fedoraproject.org](/archives/users/3d8bb2e4c1d843beb492d4f8a7c44761/ "See the profile for updatesï¼ fedoraproject.org")

21 May
2024

21 May
'24

8:28 p.m.

--------------------------------------------------------------------------------
Fedora Update Notification
FEDORA-2024-92664ae6fe
2024-05-22 01:26:21.009294
--------------------------------------------------------------------------------

Name : kernel
Product : Fedora 40
Version : 6.8.10
Release : 300.fc40
URL : <https://www.kernel.org/>
Summary : The Linux kernel
Description :
The kernel meta package

--------------------------------------------------------------------------------
Update Information:

The 6.8.10 stable kernel update contains a number of important fixes across the
tree
--------------------------------------------------------------------------------
ChangeLog:

\* Fri May 17 2024 Augusto Caringi acaringi@redhat.com [6.8.10-0]
- redhat/configs: Enable CONFIG\_DEBUG\_INFO\_BTF\_MODULES (Augusto Caringi)
- Add bugs to BugsFixed for 6.8.10 (Justin M. Forbes)
- Turn on INIT\_ON\_ALLOC\_DEFAULT\_ON for Fedora (Justin M. Forbes)
- Reapply "drm/qxl: simplify qxl\_fence\_wait" (Linus Torvalds)
- BugsFixed updates for 6.8.10 (Justin M. Forbes)
- e1000e: change usleep\_range to udelay in PHY mdic access (Vitaly Lifshits)
- Linux v6.8.10
--------------------------------------------------------------------------------
References:

[ 1 ] Bug #2276325 - Lenovo M910Q hardware boot fails with "Bug: scheduling while atomic" when ethernet connected
<https://bugzilla.redhat.com/show_bug.cgi?id=2276325>
[ 2 ] Bug #2279678 - Missing automatic memory initialization: enable CONFIG\_INIT\_ON\_ALLOC\_DEFAULT\_ON=y
<https://bugzilla.redhat.com/show_bug.cgi?id=2279678>
[ 3 ] Bug #2279734 - Kernel 6.8.8 deadlocks with 100% cpu when run in qemu/kvm
<https://bugzilla.redhat.com/show_bug.cgi?id=2279734>
[ 4 ] Bug #2280396 - CVE-2024-21823 kernel: dmaengine/idxd: hardware erratum allows potential security problem with direct access by untrusted application [fedora-all]
<https://bugzilla.redhat.com/show_bug.cgi?id=2280396>
[ 5 ] Bug #2280408 - CVE-2024-27401 kernel: firewire: nosy: ensure user\_length is taken into account when fetching packet contents [fedora-all]
<https://bugzilla.redhat.com/show_bug.cgi?id=2280408>
[ 6 ] Bug #2280461 - CVE-2024-27400 kernel: drm/amdgpu: once more fix the call oder in amdgpu\_ttm\_move() v2 [fedora-all]
<https://bugzilla.redhat.com/show_bug.cgi?id=2280461>
[ 7 ] Bug #2280463 - CVE-2024-27399 kernel: Bluetooth: l2cap: fix null-ptr-deref in l2cap\_chan\_timeout [fedora-all]
<https://bugzilla.redhat.com/show_bug.cgi?id=2280463>
[ 8 ] Bug #2280465 - CVE-2024-27398 kernel: Bluetooth: Fix use-after-free bugs caused by sco\_sock\_timeout [fedora-all]
<https://bugzilla.redhat.com/show_bug.cgi?id=2280465>
[ 9 ] Bug #2281511 - CVE-2024-35947 kernel: dyndbg: fix old BUG\_ON in &gt;control parser [fedora-all]
<https://bugzilla.redhat.com/show_bug.cgi?id=2281511>
[ 10 ] Bug #2281946 - CVE-2024-35949 kernel: btrfs: make sure that WRITTEN is set on all metadata blocks [fedora-all]
<https://bugzilla.redhat.com/show_bug.cgi?id=2281946>
--------------------------------------------------------------------------------

This update can be installed with the "dnf" update program. Use
su -c 'dnf upgrade --advisory FEDORA-2024-92664ae6fe' at the command
line. For more information, refer to the dnf documentation available at
<http://dnf.readthedocs.io/en/latest/command_ref.html#upgrade-command-label>

All packages are signed with the Fedora Project GPG key. More details on the
GPG keys used by the Fedora Project can be found at
<https://fedoraproject.org/keys>
--------------------------------------------------------------------------------

[0](#like "You must be logged-in to vote.")
[0](#dislike "You must be logged-in to vote.")

Reply

[Back to the thread](/archives/list/package-announce%40lists.fedoraproject.org/thread/OTB4HWU2PTVW5NEYHHLOCXDKG3PYA534/#OTB4HWU2PTVW5NEYHHLOCXDKG3PYA534)

[Back to the list](/archives/list/package-announce%40lists.fedoraproject.org/)

Powered by [HyperKitty](http://hyperkitty.readthedocs.org) version 1.3.7.



=== Content from git.kernel.org_c155e7a7_20250110_182048.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=e03418abde871314e1a3a550f4c8afb7b89cb273)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=e03418abde871314e1a3a550f4c8afb7b89cb273)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=e03418abde871314e1a3a550f4c8afb7b89cb273)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=e03418abde871314e1a3a550f4c8afb7b89cb273)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Josef Bacik <josef@toxicpanda.com> | 2024-04-29 09:03:35 -0400 |
| --- | --- | --- |
| committer | David Sterba <dsterba@suse.com> | 2024-05-02 22:11:13 +0200 |
| commit | [e03418abde871314e1a3a550f4c8afb7b89cb273](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=e03418abde871314e1a3a550f4c8afb7b89cb273) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=e03418abde871314e1a3a550f4c8afb7b89cb273)) | |
| tree | [759bbcbe5cd41239fe91b382929c493532cb6709](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=e03418abde871314e1a3a550f4c8afb7b89cb273) | |
| parent | [b5357cb268c41b4e2b7383d2759fc562f5b58c33](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=b5357cb268c41b4e2b7383d2759fc562f5b58c33) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=e03418abde871314e1a3a550f4c8afb7b89cb273&id2=b5357cb268c41b4e2b7383d2759fc562f5b58c33)) | |
| download | [linux-e03418abde871314e1a3a550f4c8afb7b89cb273.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-e03418abde871314e1a3a550f4c8afb7b89cb273.tar.gz) | |

btrfs: make sure that WRITTEN is set on all metadata blocksWe previously would call btrfs\_check\_leaf() if we had the check
integrity code enabled, which meant that we could only run the extended
leaf checks if we had WRITTEN set on the header flags.
This leaves a gap in our checking, because we could end up with
corruption on disk where WRITTEN isn't set on the leaf, and then the
extended leaf checks don't get run which we rely on to validate all of
the item pointers to make sure we don't access memory outside of the
extent buffer.
However, since 732fab95abe2 ("btrfs: check-integrity: remove
CONFIG\_BTRFS\_FS\_CHECK\_INTEGRITY option") we no longer call
btrfs\_check\_leaf() from btrfs\_mark\_buffer\_dirty(), which means we only
ever call it on blocks that are being written out, and thus have WRITTEN
set, or that are being read in, which should have WRITTEN set.
Add checks to make sure we have WRITTEN set appropriately, and then make
sure \_\_btrfs\_check\_leaf() always does the item checking. This will
protect us from file systems that have been corrupted and no longer have
WRITTEN set on some of the blocks.
This was hit on a crafted image tweaking the WRITTEN bit and reported by
KASAN as out-of-bound access in the eb accessors. The example is a dir
item at the end of an eb.
[2.042] BTRFS warning (device loop1): bad eb member start: ptr 0x3fff start 30572544 member offset 16410 size 2
[2.040] general protection fault, probably for non-canonical address 0xe0009d1000000003: 0000 [#1] PREEMPT SMP KASAN NOPTI
[2.537] KASAN: maybe wild-memory-access in range [0x0005088000000018-0x000508800000001f]
[2.729] CPU: 0 PID: 2587 Comm: mount Not tainted 6.8.2 #1
[2.729] Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.15.0-1 04/01/2014
[2.621] RIP: 0010:btrfs\_get\_16+0x34b/0x6d0
[2.621] RSP: 0018:ffff88810871fab8 EFLAGS: 00000206
[2.621] RAX: 0000a11000000003 RBX: ffff888104ff8720 RCX: ffff88811b2288c0
[2.621] RDX: dffffc0000000000 RSI: ffffffff81dd8aca RDI: ffff88810871f748
[2.621] RBP: 000000000000401a R08: 0000000000000001 R09: ffffed10210e3ee9
[2.621] R10: ffff88810871f74f R11: 205d323430333737 R12: 000000000000001a
[2.621] R13: 000508800000001a R14: 1ffff110210e3f5d R15: ffffffff850011e8
[2.621] FS: 00007f56ea275840(0000) GS:ffff88811b200000(0000) knlGS:0000000000000000
[2.621] CS: 0010 DS: 0000 ES: 0000 CR0: 0000000080050033
[2.621] CR2: 00007febd13b75c0 CR3: 000000010bb50000 CR4: 00000000000006f0
[2.621] Call Trace:
[2.621] <TASK>
[2.621] ? show\_regs+0x74/0x80
[2.621] ? die\_addr+0x46/0xc0
[2.621] ? exc\_general\_protection+0x161/0x2a0
[2.621] ? asm\_exc\_general\_protection+0x26/0x30
[2.621] ? btrfs\_get\_16+0x33a/0x6d0
[2.621] ? btrfs\_get\_16+0x34b/0x6d0
[2.621] ? btrfs\_get\_16+0x33a/0x6d0
[2.621] ? \_\_pfx\_btrfs\_get\_16+0x10/0x10
[2.621] ? \_\_pfx\_mutex\_unlock+0x10/0x10
[2.621] btrfs\_match\_dir\_item\_name+0x101/0x1a0
[2.621] btrfs\_lookup\_dir\_item+0x1f3/0x280
[2.621] ? \_\_pfx\_btrfs\_lookup\_dir\_item+0x10/0x10
[2.621] btrfs\_get\_tree+0xd25/0x1910
Reported-by: lei lu <llfamsec@gmail.com>
CC: stable@vger.kernel.org # 6.7+
Reviewed-by: Qu Wenruo <wqu@suse.com>
Signed-off-by: Josef Bacik <josef@toxicpanda.com>
Reviewed-by: David Sterba <dsterba@suse.com>
[ copy more details from report ]
Signed-off-by: David Sterba <dsterba@suse.com>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=e03418abde871314e1a3a550f4c8afb7b89cb273)

| -rw-r--r-- | [fs/btrfs/tree-checker.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/fs/btrfs/tree-checker.c?id=e03418abde871314e1a3a550f4c8afb7b89cb273) | 30 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |
| -rw-r--r-- | [fs/btrfs/tree-checker.h](/pub/scm/linux/kernel/git/stable/linux.git/diff/fs/btrfs/tree-checker.h?id=e03418abde871314e1a3a550f4c8afb7b89cb273) | 1 | |  |  |  | | --- | --- | --- | |

2 files changed, 16 insertions, 15 deletions

| diff --git a/fs/btrfs/tree-checker.c b/fs/btrfs/tree-checker.cindex c8fbcae4e88ea5..32604e9b31c3ee 100644--- a/[fs/btrfs/tree-checker.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/fs/btrfs/tree-checker.c?id=b5357cb268c41b4e2b7383d2759fc562f5b58c33)+++ b/[fs/btrfs/tree-checker.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/fs/btrfs/tree-checker.c?id=e03418abde871314e1a3a550f4c8afb7b89cb273)@@ -1797,6 +1797,11 @@ enum btrfs\_tree\_block\_status \_\_btrfs\_check\_leaf(struct extent\_buffer \*leaf) return BTRFS\_TREE\_BLOCK\_INVALID\_LEVEL; } + if (unlikely(!btrfs\_header\_flag(leaf, BTRFS\_HEADER\_FLAG\_WRITTEN))) {+ generic\_err(leaf, 0, "invalid flag for leaf, WRITTEN not set");+ return BTRFS\_TREE\_BLOCK\_WRITTEN\_NOT\_SET;+ }+ /\* \* Extent buffers from a relocation tree have a owner field that \* corresponds to the subvolume tree they are based on. So just from an@@ -1858,6 +1863,7 @@ enum btrfs\_tree\_block\_status \_\_btrfs\_check\_leaf(struct extent\_buffer \*leaf) for (slot = 0; slot < nritems; slot++) { u32 item\_end\_expected; u64 item\_data\_end;+ enum btrfs\_tree\_block\_status ret;  btrfs\_item\_key\_to\_cpu(leaf, &key, slot); @@ -1913,21 +1919,10 @@ enum btrfs\_tree\_block\_status \_\_btrfs\_check\_leaf(struct extent\_buffer \*leaf) return BTRFS\_TREE\_BLOCK\_INVALID\_OFFSETS; } - /\*- \* We only want to do this if WRITTEN is set, otherwise the leaf- \* may be in some intermediate state and won't appear valid.- \*/- if (btrfs\_header\_flag(leaf, BTRFS\_HEADER\_FLAG\_WRITTEN)) {- enum btrfs\_tree\_block\_status ret;-- /\*- \* Check if the item size and content meet other- \* criteria- \*/- ret = check\_leaf\_item(leaf, &key, slot, &prev\_key);- if (unlikely(ret != BTRFS\_TREE\_BLOCK\_CLEAN))- return ret;- }+ /\* Check if the item size and content meet other criteria. \*/+ ret = check\_leaf\_item(leaf, &key, slot, &prev\_key);+ if (unlikely(ret != BTRFS\_TREE\_BLOCK\_CLEAN))+ return ret;  prev\_key.objectid = key.objectid; prev\_key.type = key.type;@@ -1957,6 +1952,11 @@ enum btrfs\_tree\_block\_status \_\_btrfs\_check\_node(struct extent\_buffer \*node) int level = btrfs\_header\_level(node); u64 bytenr; + if (unlikely(!btrfs\_header\_flag(node, BTRFS\_HEADER\_FLAG\_WRITTEN))) {+ generic\_err(node, 0, "invalid flag for node, WRITTEN not set");+ return BTRFS\_TREE\_BLOCK\_WRITTEN\_NOT\_SET;+ }+ if (unlikely(level <= 0 || level >= BTRFS\_MAX\_LEVEL)) { generic\_err(node, 0, "invalid level for node, have %d expect [1, %d]",diff --git a/fs/btrfs/tree-checker.h b/fs/btrfs/tree-checker.hindex 5c809b50b2d09b..01669cfa6578de 100644--- a/[fs/btrfs/tree-checker.h](/pub/scm/linux/kernel/git/stable/linux.git/tree/fs/btrfs/tree-checker.h?id=b5357cb268c41b4e2b7383d2759fc562f5b58c33)+++ b/[fs/btrfs/tree-checker.h](/pub/scm/linux/kernel/git/stable/linux.git/tree/fs/btrfs/tree-checker.h?id=e03418abde871314e1a3a550f4c8afb7b89cb273)@@ -53,6 +53,7 @@ enum btrfs\_tree\_block\_status { BTRFS\_TREE\_BLOCK\_INVALID\_BLOCKPTR, BTRFS\_TREE\_BLOCK\_INVALID\_ITEM, BTRFS\_TREE\_BLOCK\_INVALID\_OWNER,+ BTRFS\_TREE\_BLOCK\_WRITTEN\_NOT\_SET, };  /\* |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-10 18:19:25 +0000



=== Content from git.kernel.org_a4a7b1bf_20250110_182049.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=ef3ba8ce8cf7075b716aa4afcefc3034215878ee)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=ef3ba8ce8cf7075b716aa4afcefc3034215878ee)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=ef3ba8ce8cf7075b716aa4afcefc3034215878ee)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=ef3ba8ce8cf7075b716aa4afcefc3034215878ee)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Josef Bacik <josef@toxicpanda.com> | 2024-04-29 09:03:35 -0400 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-05-17 12:15:01 +0200 |
| commit | [ef3ba8ce8cf7075b716aa4afcefc3034215878ee](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=ef3ba8ce8cf7075b716aa4afcefc3034215878ee) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=ef3ba8ce8cf7075b716aa4afcefc3034215878ee)) | |
| tree | [acdf5a59e3f8610c9b636ae1794dde68a63ad7d0](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=ef3ba8ce8cf7075b716aa4afcefc3034215878ee) | |
| parent | [c839f73a70f312f477225b64020364e108f08231](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=c839f73a70f312f477225b64020364e108f08231) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=ef3ba8ce8cf7075b716aa4afcefc3034215878ee&id2=c839f73a70f312f477225b64020364e108f08231)) | |
| download | [linux-ef3ba8ce8cf7075b716aa4afcefc3034215878ee.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-ef3ba8ce8cf7075b716aa4afcefc3034215878ee.tar.gz) | |

btrfs: make sure that WRITTEN is set on all metadata blockscommit e03418abde871314e1a3a550f4c8afb7b89cb273 upstream.
We previously would call btrfs\_check\_leaf() if we had the check
integrity code enabled, which meant that we could only run the extended
leaf checks if we had WRITTEN set on the header flags.
This leaves a gap in our checking, because we could end up with
corruption on disk where WRITTEN isn't set on the leaf, and then the
extended leaf checks don't get run which we rely on to validate all of
the item pointers to make sure we don't access memory outside of the
extent buffer.
However, since 732fab95abe2 ("btrfs: check-integrity: remove
CONFIG\_BTRFS\_FS\_CHECK\_INTEGRITY option") we no longer call
btrfs\_check\_leaf() from btrfs\_mark\_buffer\_dirty(), which means we only
ever call it on blocks that are being written out, and thus have WRITTEN
set, or that are being read in, which should have WRITTEN set.
Add checks to make sure we have WRITTEN set appropriately, and then make
sure \_\_btrfs\_check\_leaf() always does the item checking. This will
protect us from file systems that have been corrupted and no longer have
WRITTEN set on some of the blocks.
This was hit on a crafted image tweaking the WRITTEN bit and reported by
KASAN as out-of-bound access in the eb accessors. The example is a dir
item at the end of an eb.
[2.042] BTRFS warning (device loop1): bad eb member start: ptr 0x3fff start 30572544 member offset 16410 size 2
[2.040] general protection fault, probably for non-canonical address 0xe0009d1000000003: 0000 [#1] PREEMPT SMP KASAN NOPTI
[2.537] KASAN: maybe wild-memory-access in range [0x0005088000000018-0x000508800000001f]
[2.729] CPU: 0 PID: 2587 Comm: mount Not tainted 6.8.2 #1
[2.729] Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.15.0-1 04/01/2014
[2.621] RIP: 0010:btrfs\_get\_16+0x34b/0x6d0
[2.621] RSP: 0018:ffff88810871fab8 EFLAGS: 00000206
[2.621] RAX: 0000a11000000003 RBX: ffff888104ff8720 RCX: ffff88811b2288c0
[2.621] RDX: dffffc0000000000 RSI: ffffffff81dd8aca RDI: ffff88810871f748
[2.621] RBP: 000000000000401a R08: 0000000000000001 R09: ffffed10210e3ee9
[2.621] R10: ffff88810871f74f R11: 205d323430333737 R12: 000000000000001a
[2.621] R13: 000508800000001a R14: 1ffff110210e3f5d R15: ffffffff850011e8
[2.621] FS: 00007f56ea275840(0000) GS:ffff88811b200000(0000) knlGS:0000000000000000
[2.621] CS: 0010 DS: 0000 ES: 0000 CR0: 0000000080050033
[2.621] CR2: 00007febd13b75c0 CR3: 000000010bb50000 CR4: 00000000000006f0
[2.621] Call Trace:
[2.621] <TASK>
[2.621] ? show\_regs+0x74/0x80
[2.621] ? die\_addr+0x46/0xc0
[2.621] ? exc\_general\_protection+0x161/0x2a0
[2.621] ? asm\_exc\_general\_protection+0x26/0x30
[2.621] ? btrfs\_get\_16+0x33a/0x6d0
[2.621] ? btrfs\_get\_16+0x34b/0x6d0
[2.621] ? btrfs\_get\_16+0x33a/0x6d0
[2.621] ? \_\_pfx\_btrfs\_get\_16+0x10/0x10
[2.621] ? \_\_pfx\_mutex\_unlock+0x10/0x10
[2.621] btrfs\_match\_dir\_item\_name+0x101/0x1a0
[2.621] btrfs\_lookup\_dir\_item+0x1f3/0x280
[2.621] ? \_\_pfx\_btrfs\_lookup\_dir\_item+0x10/0x10
[2.621] btrfs\_get\_tree+0xd25/0x1910
Reported-by: lei lu <llfamsec@gmail.com>
CC: stable@vger.kernel.org # 6.7+
Reviewed-by: Qu Wenruo <wqu@suse.com>
Signed-off-by: Josef Bacik <josef@toxicpanda.com>
Reviewed-by: David Sterba <dsterba@suse.com>
[ copy more details from report ]
Signed-off-by: David Sterba <dsterba@suse.com>
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=ef3ba8ce8cf7075b716aa4afcefc3034215878ee)

| -rw-r--r-- | [fs/btrfs/tree-checker.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/fs/btrfs/tree-checker.c?id=ef3ba8ce8cf7075b716aa4afcefc3034215878ee) | 30 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |
| -rw-r--r-- | [fs/btrfs/tree-checker.h](/pub/scm/linux/kernel/git/stable/linux.git/diff/fs/btrfs/tree-checker.h?id=ef3ba8ce8cf7075b716aa4afcefc3034215878ee) | 1 | |  |  |  | | --- | --- | --- | |

2 files changed, 16 insertions, 15 deletions

| diff --git a/fs/btrfs/tree-checker.c b/fs/btrfs/tree-checker.cindex 6eccf8496486c0..75c78a5556c5b6 100644--- a/[fs/btrfs/tree-checker.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/fs/btrfs/tree-checker.c?id=c839f73a70f312f477225b64020364e108f08231)+++ b/[fs/btrfs/tree-checker.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/fs/btrfs/tree-checker.c?id=ef3ba8ce8cf7075b716aa4afcefc3034215878ee)@@ -1793,6 +1793,11 @@ enum btrfs\_tree\_block\_status \_\_btrfs\_check\_leaf(struct extent\_buffer \*leaf) return BTRFS\_TREE\_BLOCK\_INVALID\_LEVEL; } + if (unlikely(!btrfs\_header\_flag(leaf, BTRFS\_HEADER\_FLAG\_WRITTEN))) {+ generic\_err(leaf, 0, "invalid flag for leaf, WRITTEN not set");+ return BTRFS\_TREE\_BLOCK\_WRITTEN\_NOT\_SET;+ }+ /\* \* Extent buffers from a relocation tree have a owner field that \* corresponds to the subvolume tree they are based on. So just from an@@ -1854,6 +1859,7 @@ enum btrfs\_tree\_block\_status \_\_btrfs\_check\_leaf(struct extent\_buffer \*leaf) for (slot = 0; slot < nritems; slot++) { u32 item\_end\_expected; u64 item\_data\_end;+ enum btrfs\_tree\_block\_status ret;  btrfs\_item\_key\_to\_cpu(leaf, &key, slot); @@ -1909,21 +1915,10 @@ enum btrfs\_tree\_block\_status \_\_btrfs\_check\_leaf(struct extent\_buffer \*leaf) return BTRFS\_TREE\_BLOCK\_INVALID\_OFFSETS; } - /\*- \* We only want to do this if WRITTEN is set, otherwise the leaf- \* may be in some intermediate state and won't appear valid.- \*/- if (btrfs\_header\_flag(leaf, BTRFS\_HEADER\_FLAG\_WRITTEN)) {- enum btrfs\_tree\_block\_status ret;-- /\*- \* Check if the item size and content meet other- \* criteria- \*/- ret = check\_leaf\_item(leaf, &key, slot, &prev\_key);- if (unlikely(ret != BTRFS\_TREE\_BLOCK\_CLEAN))- return ret;- }+ /\* Check if the item size and content meet other criteria. \*/+ ret = check\_leaf\_item(leaf, &key, slot, &prev\_key);+ if (unlikely(ret != BTRFS\_TREE\_BLOCK\_CLEAN))+ return ret;  prev\_key.objectid = key.objectid; prev\_key.type = key.type;@@ -1953,6 +1948,11 @@ enum btrfs\_tree\_block\_status \_\_btrfs\_check\_node(struct extent\_buffer \*node) int level = btrfs\_header\_level(node); u64 bytenr; + if (unlikely(!btrfs\_header\_flag(node, BTRFS\_HEADER\_FLAG\_WRITTEN))) {+ generic\_err(node, 0, "invalid flag for node, WRITTEN not set");+ return BTRFS\_TREE\_BLOCK\_WRITTEN\_NOT\_SET;+ }+ if (unlikely(level <= 0 || level >= BTRFS\_MAX\_LEVEL)) { generic\_err(node, 0, "invalid level for node, have %d expect [1, %d]",diff --git a/fs/btrfs/tree-checker.h b/fs/btrfs/tree-checker.hindex 14b9fbe82da474..580ec4fde01a36 100644--- a/[fs/btrfs/tree-checker.h](/pub/scm/linux/kernel/git/stable/linux.git/tree/fs/btrfs/tree-checker.h?id=c839f73a70f312f477225b64020364e108f08231)+++ b/[fs/btrfs/tree-checker.h](/pub/scm/linux/kernel/git/stable/linux.git/tree/fs/btrfs/tree-checker.h?id=ef3ba8ce8cf7075b716aa4afcefc3034215878ee)@@ -51,6 +51,7 @@ enum btrfs\_tree\_block\_status { BTRFS\_TREE\_BLOCK\_INVALID\_BLOCKPTR, BTRFS\_TREE\_BLOCK\_INVALID\_ITEM, BTRFS\_TREE\_BLOCK\_INVALID\_OWNER,+ BTRFS\_TREE\_BLOCK\_WRITTEN\_NOT\_SET, };  /\* |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-10 18:19:26 +0000


