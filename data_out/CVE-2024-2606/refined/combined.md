=== Content from www.mozilla.org_1388573f_20250111_171708.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    #### Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [#### Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    #### Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    #### Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    #### Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    #### Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    #### MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    #### Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    #### Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [#### About Mozilla](/en-US/about/)
  + [#### The Mozilla Manifesto](/en-US/about/manifesto/)
  + [#### Get Involved](/en-US/contribute/)
  + [#### Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [#### Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2024-12

## Security Vulnerabilities fixed in Firefox 124

Announced
March 19, 2024
Impact
high
Products
Firefox
Fixed in

* Firefox 124

#### [#CVE-2024-2605: Windows Error Reporter could be used as a Sandbox escape vector](#CVE-2024-2605)

Reporter
goodbyeselene
Impact
high
##### Description

An attacker could have leveraged the Windows Error Reporter to run arbitrary code on the system escaping the sandbox. *Note:* This issue only affected Windows operating systems. Other operating systems are unaffected.

##### References

* [Bug 1872920](https://bugzilla.mozilla.org/show_bug.cgi?id=1872920)

#### [#CVE-2024-2606: Mishandling of WASM register values](#CVE-2024-2606)

Reporter
P1umer
Impact
high
##### Description

Passing invalid data could have led to invalid wasm values being created, such as arbitrary integers turning into pointer values.

##### References

* [Bug 1879237](https://bugzilla.mozilla.org/show_bug.cgi?id=1879237)

#### [#CVE-2024-2607: JIT code failed to save return registers on Armv7-A](#CVE-2024-2607)

Reporter
Gary Kwong
Impact
high
##### Description

Return registers were overwritten which could have allowed an attacker to execute arbitrary code. *Note:* This issue only affected Armv7-A systems. Other operating systems are unaffected.

##### References

* [Bug 1879939](https://bugzilla.mozilla.org/show_bug.cgi?id=1879939)

#### [#CVE-2024-2608: Integer overflow could have led to out of bounds write](#CVE-2024-2608)

Reporter
Ronald Crane
Impact
high
##### Description

`AppendEncodedAttributeValue(), ExtraSpaceNeededForAttrEncoding()` and `AppendEncodedCharacters()` could have experienced integer overflows, causing underallocation of an output buffer leading to an out of bounds write.

##### References

* [Bug 1880692](https://bugzilla.mozilla.org/show_bug.cgi?id=1880692)

#### [#CVE-2023-5388: NSS susceptible to timing attack against RSA decryption](#CVE-2023-5388)

Reporter
Hubert Kario
Impact
moderate
##### Description

NSS was susceptible to a timing side-channel attack when performing RSA decryption. This attack could potentially allow an attacker to recover the private data.

##### References

* [Bug 1780432](https://bugzilla.mozilla.org/show_bug.cgi?id=1780432)

#### [#CVE-2024-2609: Permission prompt input delay could expire when not in focus](#CVE-2024-2609)

Reporter
Shaheen Fazim
Impact
moderate
##### Description

The permission prompt input delay could have expired while the window is not in focus, which made the prompt vulnerable to clickjacking by malicious websites.

##### References

* [Bug 1866100](https://bugzilla.mozilla.org/show_bug.cgi?id=1866100)

#### [#CVE-2024-2610: Improper handling of html and body tags enabled CSP nonce leakage](#CVE-2024-2610)

Reporter
Georg Felber and Marco Squarcina (TU Wien)
Impact
moderate
##### Description

Using a markup injection an attacker could have stolen nonce values. This could have been used to bypass strict content security policies.

##### References

* [Bug 1871112](https://bugzilla.mozilla.org/show_bug.cgi?id=1871112)

#### [#CVE-2024-2611: Clickjacking vulnerability could have led to a user accidentally granting permissions](#CVE-2024-2611)

Reporter
Hafiizh
Impact
moderate
##### Description

A missing delay on when pointer lock was used could have allowed a malicious page to trick a user into granting permissions.

##### References

* [Bug 1876675](https://bugzilla.mozilla.org/show_bug.cgi?id=1876675)

#### [#CVE-2024-2612: Self referencing object could have potentially led to a use-after-free](#CVE-2024-2612)

Reporter
Ronald Crane
Impact
moderate
##### Description

If an attacker could find a way to trigger a particular code path in `SafeRefPtr`, it could have triggered a crash or potentially be leveraged to achieve code execution.

##### References

* [Bug 1879444](https://bugzilla.mozilla.org/show_bug.cgi?id=1879444)

#### [#CVE-2024-2613: Improper handling of QUIC ACK frame data could have led to OOM](#CVE-2024-2613)

Reporter
Max Inden
Impact
low
##### Description

Data was not properly sanitized when decoding a QUIC ACK frame; this could have led to unrestricted memory consumption and a crash.

##### References

* [Bug 1875701](https://bugzilla.mozilla.org/show_bug.cgi?id=1875701)

#### [#CVE-2024-2614: Memory safety bugs fixed in Firefox 124, Firefox ESR 115.9, and Thunderbird 115.9](#CVE-2024-2614)

Reporter
Noah Lokocz, Kevin Brosnan, Ryan VanderMeulen and the Mozilla Fuzzing Team
Impact
high
##### Description

Memory safety bugs present in Firefox 123, Firefox ESR 115.8, and Thunderbird 115.8. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 124, Firefox ESR 115.9, and Thunderbird 115.9](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1685358%2C1861016%2C1880405%2C1881093)

#### [#CVE-2024-2615: Memory safety bugs fixed in Firefox 124](#CVE-2024-2615)

Reporter
Paul Bone and the Mozilla Fuzzing Team
Impact
critical
##### Description

Memory safety bugs present in Firefox 123. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 124](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1881074%2C1882438%2C1881650)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from bugzilla.mozilla.org_a624f79c_20250111_171707.html ===


![](/static/v20250108.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1879237)
* [XML](/show_bug.cgi?ctype=xml&id=1879237)

Closed
[Bug 1879237](/show_bug.cgi?id=1879237)
(CVE-2024-2606)

Opened 11 months ago
Closed 11 months ago

# [WASM] MOZ\_ASSERT(v.isMem() == result.onStack());

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

[WASM] MOZ\_ASSERT(v.isMem() == result.onStack());

## Categories

### (Core :: JavaScript: WebAssembly, defect, P1)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=JavaScript%3A%20WebAssembly#JavaScript%3A%20WebAssembly)

JavaScript: WebAssembly
▾

Core :: JavaScript: WebAssembly
Implementation of the WebAssembly (wasm) standard, including compilation and runtime support.
[See Open Bugs in This Component](/buglist.cgi?product=Core&component=JavaScript%3A%20WebAssembly&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=JavaScript%3A%20WebAssembly&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=JavaScript%3A%20WebAssembly)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

unspecified

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

P1

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

S2

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

125 Branch

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Webcompat Score | --- |
| --- | --- |
| Performance Impact | --- |
| Accessibility Severity | --- |
| Webcompat Priority | --- |
| a11y-review | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr115 | --- | [unaffected](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=unaffected) |
| firefox123 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox123&o1=equals&v1=wontfix) |
| firefox124 | [+](/buglist.cgi?f1=cf_tracking_firefox124&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox124&o1=equals&v1=fixed) |
| firefox125 | [+](/buglist.cgi?f1=cf_tracking_firefox125&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox125&o1=equals&v1=fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr115 | --- | unaffected |
| firefox-esr128 | --- | --- |
| firefox123 |  | wontfix |
| firefox124 | + | fixed |
| firefox125 | + | fixed |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: cz18811105578, Assigned: bvisness)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/3ef267ebbb5f160ff0810f3787be9a4e?d=mm&size=40)  [bvisness](/user_profile?user_id=594477)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/5234924b8b444d0bde8e2ed373f8fd0a?d=mm&size=40)  [cz18811105578](/user_profile?user_id=724227)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/8db6b22eadf9c098ae78e6d0d0615e29?d=mm&size=40)  [rhunt](/user_profile?user_id=573202)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

7 people

## References

### (Blocks 1 open bug, Regression)

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

[wasm-lang](/show_bug.cgi?id=1729512 "NEW - [meta] WebAssembly Language")

Dependency [tree](/showdependencytree.cgi?id=1879237&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=1879237)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

[1817782](/show_bug.cgi?id=1817782 "RESOLVED FIXED - Kotlin example crashes with Wasm GC")

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Keywords: regression, reporter-external, sec-high, Whiteboard: [adv-main124+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2024-2606

[Keywords:](/describekeywords.cgi)

[regression](/buglist.cgi?keywords=regression&resolution=---),
[reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---),
[sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[adv-main124+]

QA Whiteboard:

[post-critsmash-triage]

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [dveditz](/user_profile?user_id=1689) | [sec-bounty](#a2310318_1689 "10 months ago") | + |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | sec-bounty | + |
| --- | --- | --- |
| [RyanVM](/user_profile?user_id=75935) | [in-testsuite](#c15 "11 months ago") | ? |
| --- | --- | --- |
| [RyanVM](/user_profile?user_id=75935) | in-testsuite | ? |
| --- | --- | --- |
| [avaida](/user_profile?user_id=488993) | [qe-verify](#a2261540_488993 "10 months ago") | - |
| --- | --- | --- |
| [avaida](/user_profile?user_id=488993) | qe-verify | - |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (4 files)

| [poc0208.js](/attachment.cgi?id=9378912)  [11 months ago](#c0)  [P1umer](/user_profile?user_id=724227)   8.35 KB, text/javascript |  | [Details](/attachment.cgi?id=9378912&action=edit) |
| --- | --- | --- |
| [Bug 1879237: Consolidate wasm cast code. r=rhunt](/attachment.cgi?id=9379984)  [11 months ago](#c3)  [Ben Visness [:bvisness]](/user_profile?user_id=594477)   48 bytes, text/x-phabricator-request | tjr : [sec-approval+](#c11 "11 months ago") | [Details](/attachment.cgi?id=9379984&action=edit) | [Review](/attachment.cgi?id=9379984) |
| [Bug 1879237: Consolidate wasm cast code. r=rhunt](/attachment.cgi?id=9387903)  [11 months ago](#c13)  [Ben Visness [:bvisness]](/user_profile?user_id=594477)   48 bytes, text/x-phabricator-request | phab-bot : [approval-mozilla-beta+](#a2037408_600971 "11 months ago") | [Details](/attachment.cgi?id=9387903&action=edit) | [Review](/attachment.cgi?id=9387903) |
| [advisory.txt](/attachment.cgi?id=9391525)  [10 months ago](#c18)  [Tyson Smith [:tsmith]](/user_profile?user_id=486634)   184 bytes, text/plain |  | [Details](/attachment.cgi?id=9391525&action=edit) |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [P1umer](/user_profile?user_id=724227)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1879237#c0)• 11 months ago |
|  | |

Attached file
[poc0208.js](attachment.cgi?id=9378912)
— [Details](attachment.cgi?id=9378912&action=edit)

User Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10\_15\_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36

Steps to reproduce:

OS : Linux ubuntu 5.11.10 #1 SMP Sat Oct 30 23:40:08 CST 2021 x86\_64 x86\_64 x86\_64 GNU/Linux

Commit : 719b4a8853b449674c018178f85b3667afe4f193

Build :

ac\_add\_options --enable-project=js

ac\_add\_options --disable-optimize

ac\_add\_options --disable-unified-build

ac\_add\_options --enable-debug

ac\_add\_options --disable-jemalloc

Running:

./js --wasm-memory-control --wasm-compiler=baseline --wasm-exnref poc.js

Actual results:

```
Stopped reason: SIGSEGV
0x0000555559313036 in js::wasm::BaseCompiler::shuffleStackResultsBeforeBranch (this=0x7fffffff2be8, srcHeight=..., destHeight=..., type=...) at gecko-dev-latest/js/src/wasm/WasmBaselineCompile.cpp:1298
1298	      MOZ_ASSERT(v.isMem() == result.onStack());
gdb-peda$ bt
#0  0x0000555559313036 in js::wasm::BaseCompiler::shuffleStackResultsBeforeBranch(js::wasm::StackHeight, js::wasm::StackHeight, js::wasm::ResultType)
    (this=0x7fffffff2be8, srcHeight=..., destHeight=..., type=...) at gecko-dev-latest/js/src/wasm/WasmBaselineCompile.cpp:1298
#1  0x0000555559319a19 in js::wasm::BaseCompiler::jumpConditionalWithResults(js::wasm::BranchState*, js::wasm::RegRef, js::wasm::RefType, js::wasm::RefType, bool) (this=0x7fffffff2be8, b=0x7ffffffee658, object=..., sourceType=..., destType=..., onSuccess=0x0)
    at gecko-dev-latest/js/src/wasm/WasmBaselineCompile.cpp:3245
#2  0x000055555932e8a1 in js::wasm::BaseCompiler::emitBrOnCastCommon(bool, unsigned int, js::wasm::ResultType const&, js::wasm::RefType, js::wasm::RefType) (this=0x7fffffff2be8, onSuccess=0x0, labelRelativeDepth=0x0, labelType=..., sourceType=..., destType=...)
    at gecko-dev-latest/js/src/wasm/WasmBaselineCompile.cpp:8392
#3  0x000055555932ea8d in js::wasm::BaseCompiler::emitBrOnCast(bool) (this=0x7fffffff2be8, onSuccess=0x0)
    at gecko-dev-latest/js/src/wasm/WasmBaselineCompile.cpp:8418
#4  0x0000555559343057 in js::wasm::BaseCompiler::emitBody() (this=0x7fffffff2be8)
    at gecko-dev-latest/js/src/wasm/WasmBaselineCompile.cpp:10629
#5  0x000055555936831a in js::wasm::BaseCompiler::emitFunction() (this=0x7fffffff2be8)
    at gecko-dev-latest/js/src/wasm/WasmBaselineCompile.cpp:11740
#6  0x0000555559369669 in js::wasm::BaselineCompileFunctions(js::wasm::ModuleEnvironment const&, js::wasm::CompilerEnvironment const&, js::LifoAlloc&, mozilla::Vector<js::wasm::FuncCompileInput, 8ul, js::SystemAllocPolicy> const&, js::wasm::CompiledCode*, mozilla::UniquePtr<char [], JS::FreePolicy>*)
     (moduleEnv=..., compilerEnv=..., lifo=..., inputs=..., code=0x55555a0b1280, error=0x7fffffff5658)
    at gecko-dev-latest/js/src/wasm/WasmBaselineCompile.cpp:11917
#7  0x000055555943b9e4 in ExecuteCompileTask(js::wasm::CompileTask*, mozilla::UniquePtr<char [], JS::FreePolicy>*)
    (task=0x55555a0b0ed0, error=0x7fffffff5658) at gecko-dev-latest/js/src/wasm/WasmGenerator.cpp:735
#8  0x000055555943bbe4 in js::wasm::ModuleGenerator::locallyCompileCurrentTask() (this=0x7fffffff4560)
    at gecko-dev-latest/js/src/wasm/WasmGenerator.cpp:784
#9  0x000055555943c777 in js::wasm::ModuleGenerator::finishFuncDefs() (this=0x7fffffff4560)
    at gecko-dev-latest/js/src/wasm/WasmGenerator.cpp:915
#10 0x0000555559414106 in DecodeCodeSection<js::wasm::Decoder>(js::wasm::ModuleEnvironment const&, js::wasm::Decoder&, js::wasm::ModuleGenerator&)
    (env=..., d=..., mg=...) at gecko-dev-latest/js/src/wasm/WasmCompile.cpp:785
#11 0x0000555559413e32 in js::wasm::CompileBuffer(js::wasm::CompileArgs const&, js::wasm::ShareableBytes const&, mozilla::UniquePtr<char [], JS::FreePolicy>*, mozilla::Vector<mozilla::UniquePtr<char [], JS::FreePolicy>, 0ul, js::SystemAllocPolicy>*, JS::OptimizedEncodingListener*)
    (args=..., bytecode=..., error=0x7fffffff5658, warnings=0x7fffffff56a0, listener=0x0)
    at gecko-dev-latest/js/src/wasm/WasmCompile.cpp:807
#12 0x00005555594fe1ce in js::WasmModuleObject::construct(JSContext*, unsigned int, JS::Value*) (cx=0x555559f66060, argc=0x1, vp=0x55555a0731c8)
    at gecko-dev-latest/js/src/wasm/WasmJS.cpp:1494
#13 0x0000555557982f26 in CallJSNative(JSContext*, bool (*)(JSContext*, unsigned int, JS::Value*), js::CallReason, JS::CallArgs const&)
    (cx=0x555559f66060, native=0x5555594fddd0 <js::WasmModuleObject::construct(JSContext*, unsigned int, JS::Value*)>, reason=js::CallReason::Call, args=...) at gecko-dev-latest/js/src/vm/Interpreter.cpp:480
#14 0x00005555579940ea in CallJSNativeConstructor(JSContext*, bool (*)(JSContext*, unsigned int, JS::Value*), JS::CallArgs const&)
    (cx=0x555559f66060, native=0x5555594fddd0 <js::WasmModuleObject::construct(JSContext*, unsigned int, JS::Value*)>, args=...)
    at gecko-dev-latest/js/src/vm/Interpreter.cpp:496
#15 0x000055555794a3ae in InternalConstruct(JSContext*, js::AnyConstructArgs const&, js::CallReason)
    (cx=0x555559f66060, args=..., reason=js::CallReason::Call) at gecko-dev-latest/js/src/vm/Interpreter.cpp:702
#16 0x0000555557949dc1 in js::ConstructFromStack(JSContext*, JS::CallArgs const&, js::CallReason)
    (cx=0x555559f66060, args=..., reason=js::CallReason::Call) at gecko-dev-latest/js/src/vm/Interpreter.cpp:749
#17 0x000055555795f13e in js::Interpret(JSContext*, js::RunState&) (cx=0x555559f66060, state=...)
    at gecko-dev-latest/js/src/vm/Interpreter.cpp:3046
#18 0x00005555579488ac in MaybeEnterInterpreterTrampoline(JSContext*, js::RunState&) (cx=0x555559f66060, state=...)
    at gecko-dev-latest/js/src/vm/Interpreter.cpp:394
#19 0x0000555557948492 in js::RunScript(JSContext*, js::RunState&) (cx=0x555559f66060, state=...)
    at gecko-dev-latest/js/src/vm/Interpreter.cpp:452
#20 0x000055555794b257 in js::ExecuteKernel(JSContext*, JS::Handle<JSScript*>, JS::Handle<JSObject*>, js::AbstractFramePtr, JS::MutableHandle<JS::Value>)
    (cx=0x555559f66060, script=0xc92dfd66060, envChainArg=(JSObject * const) 0xc92dfd3f038 [object LexicalEnvironment], evalInFrame=AbstractFramePtr ((js::InterpreterFrame *) 0x0) = {...}, result=$JS::UndefinedValue()) at gecko-dev-latest/js/src/vm/Interpreter.cpp:839
#21 0x000055555794b65c in js::Execute(JSContext*, JS::Handle<JSScript*>, JS::Handle<JSObject*>, JS::MutableHandle<JS::Value>)
    (cx=0x555559f66060, script=0xc92dfd66060, envChain=(JSObject * const) 0xc92dfd3f038 [object LexicalEnvironment], rval=$JS::UndefinedValue())
    at gecko-dev-latest/js/src/vm/Interpreter.cpp:871
#22 0x0000555557dca0df in ExecuteScript(JSContext*, JS::Handle<JSObject*>, JS::Handle<JSScript*>, JS::MutableHandle<JS::Value>)
    (cx=0x555559f66060, envChain=(JSObject * const) 0xc92dfd3f038 [object LexicalEnvironment], script=0xc92dfd66060, rval=$JS::UndefinedValue())
    at gecko-dev-latest/js/src/vm/CompilationAndEvaluation.cpp:494
#23 0x0000555557dca206 in JS_ExecuteScript(JSContext*, JS::Handle<JSScript*>) (cx=0x555559f66060, scriptArg=0xc92dfd66060)
    at gecko-dev-latest/js/src/vm/CompilationAndEvaluation.cpp:518
#24 0x00005555577d0527 in RunFile(JSContext*, char const*, _IO_FILE*, CompileUtf8, bool, bool)
    (cx=0x555559f66060, filename=0x55555a07a5a0 "/tmp/crash3.js", file=0x555559ffe250, compileMethod=CompileUtf8::DontInflate, compileOnly=0x0, fullParse=0x0) at gecko-dev-latest/js/src/shell/js.cpp:1221
#25 0x00005555577cfba0 in Process(JSContext*, char const*, bool, FileKind)
    (cx=0x555559f66060, filename=0x55555a07a5a0 "/tmp/crash3.js", forceTTY=0x0, kind=FileScript)
    at gecko-dev-latest/js/src/shell/js.cpp:1801
#26 0x000055555779bb7b in ProcessArgs(JSContext*, js::cli::OptionParser*) (cx=0x555559f66060, op=0x7fffffffdec0)
    at gecko-dev-latest/js/src/shell/js.cpp:10905
#27 0x0000555557792c57 in Shell(JSContext*, js::cli::OptionParser*) (cx=0x555559f66060, op=0x7fffffffdec0)
    at gecko-dev-latest/js/src/shell/js.cpp:11167
#28 0x000055555778d969 in main(int, char**) (argc=0x5, argv=0x7fffffffe118) at gecko-dev-latest/js/src/shell/js.cpp:11571
#29 0x00007ffff7a48083 in __libc_start_main () at /lib/x86_64-linux-gnu/libc.so.6
#30 0x0000555557753b79 in _start ()

```

|  | [P1umer](/user_profile?user_id=724227)  Reporter |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1879237#c1)• 11 months ago |
|  | |

This is the GIT commit hash(719b4a8853b449674c018178f85b3667afe4f193).

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1879237#a46765_406194)• 11 months ago |

Group: core-security → javascript-core-security

|  | [Ryan Hunt [:rhunt]](/user_profile?user_id=573202) |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1879237#c2)• 11 months ago |
|  | |

This seems like it's possibly the same root cause as [bug 1879238](/show_bug.cgi?id=1879238 "RESOLVED FIXED - [WASM] Segmentation fault: unknown type hierarchy in cast").

|  | [Ben Visness [:bvisness]](/user_profile?user_id=594477)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1879237#a56971_594477)• 11 months ago |

Assignee: nobody → bvisness

|  | [Ben Visness [:bvisness]](/user_profile?user_id=594477)  Assignee |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1879237#c3)• 11 months ago |
|  | |

Attached file
[Bug 1879237: Consolidate wasm cast code. r=rhunt](attachment.cgi?id=9379984)
— [Details](attachment.cgi?id=9379984&action=edit)

|  | [Steven DeTar [:sdetar]](/user_profile?user_id=607698) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1879237#a488409_607698)• 11 months ago |

Severity: -- → S3Status: UNCONFIRMED → NEWEver confirmed: truePriority: -- → P1

|  | [Steven DeTar [:sdetar]](/user_profile?user_id=607698) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1879237#a488511_607698)• 11 months ago |

Blocks: [wasm-lang](/show_bug.cgi?id=1729512 "NEW - [meta] WebAssembly Language")

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1879237#a490862_600971)• 11 months ago |

[Attachment #9379984](/attachment.cgi?id=9379984&action=edit "Bug 1879237: Consolidate wasm cast code. r=rhunt") -
Attachment description: WIP: Bug 1879237: Consolidate wasm cast code. → Bug 1879237: Consolidate wasm cast code. r=rhunt

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1879237#c4)• 11 months ago |
|  | |

(In reply to Ryan Hunt [:rhunt] from [comment #2](/show_bug.cgi?id=1879237#c2 "RESOLVED FIXED - [WASM] MOZ_ASSERT(v.isMem() == result.onStack());"))

> This seems like it's possibly the same root cause as [bug 1879238](/show_bug.cgi?id=1879238 "RESOLVED FIXED - [WASM] Segmentation fault: unknown type hierarchy in cast").

That bug was deemed to be not a security bug, but largely because the MOZ\_CRASH(). This one will keep executing after the assert. How bad is it?

Flags: needinfo?(rhunt)

|  | [Ryan Hunt [:rhunt]](/user_profile?user_id=573202) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1879237#c5)• 11 months ago |
|  | |

This one is different from [bug 1879238](/show_bug.cgi?id=1879238 "RESOLVED FIXED - [WASM] Segmentation fault: unknown type hierarchy in cast"). We're messing up our register allocation in wasm baseline during a cast+branch operation which has params. I'm not sure the full impact yet or if there is some mitigating factor. I'm reviewing the patch now. This is probably higher than an S3.

Flags: needinfo?(rhunt)

|  | [Ryan Hunt [:rhunt]](/user_profile?user_id=573202) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1879237#a1112814_573202)• 11 months ago |

Severity: S3 → S2

|  | [Ryan Hunt [:rhunt]](/user_profile?user_id=573202) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1879237#c6)• 11 months ago |
|  | |

This one is tricky, I'm not sure if it's exploitable or not.

The issue was that when doing a `br_on_cast $label` instruction to a `(block $label)` we can pass extra params in addition to the value we're casting. Our baseline compiler uses an ABI for passing block parameters, with the first value in a register and extra ones passed in the stack. Our code before this patch would first move all the params to the right regs/stack slots but then could accidentally call `needResultRegs` which would spill the reg params to the stack before performing the branch. The assert we ran into was checking that this doesn't happen.

The tricky part is that the old reg params will still be in registers, even if we spill them to the stack. So we won't be passing an invalid value. We also do a stack shuffle that looks like it could be messed up by the unexpected push, but it does all addressing relative to FP, so it should still be valid.

There could be something I'm missing though, so we should be conservative and assume there's a chance someone could figure a way to pass an invalid value to a block param.

|  | [Ryan Hunt [:rhunt]](/user_profile?user_id=573202) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1879237#c7)• 11 months ago |
|  | |

This was caused by [bug 1817782](/show_bug.cgi?id=1817782 "RESOLVED FIXED - Kotlin example crashes with Wasm GC") being an incomplete fix for the root problem.

[status-firefox123](/buglist.cgi?f1=cf_status_firefox123&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox123&o1=equals&v1=affected)
[status-firefox124](/buglist.cgi?f1=cf_status_firefox124&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox124&o1=equals&v1=affected)
[status-firefox125](/buglist.cgi?f1=cf_status_firefox125&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox125&o1=equals&v1=affected)
[status-firefox-esr115](/buglist.cgi?f1=cf_status_firefox_esr115&o1=isnotempty):
--- → [unaffected](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=unaffected)Keywords: [regression](/buglist.cgi?keywords=regression&resolution=---)Regressed by: [1817782](/show_bug.cgi?id=1817782 "RESOLVED FIXED - Kotlin example crashes with Wasm GC")

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1879237#c8)• 11 months ago |
|  | |

I'm a little confused about the security severity, but it sounds bad and Ryan rated it an "S2" worry.

Keywords: [sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

|  | [Ryan Hunt [:rhunt]](/user_profile?user_id=573202) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1879237#c9)• 11 months ago |
|  | |

(In reply to Daniel Veditz [:dveditz] from [comment #8](/show_bug.cgi?id=1879237#c8 "RESOLVED FIXED - [WASM] MOZ_ASSERT(v.isMem() == result.onStack());"))

> I'm a little confused about the security severity, but it sounds bad and Ryan rated it an "S2" worry.

Yeah, I'm just not sure. It seems like there are mitigating factors that could prevent this from going bad, but I'm not 100% sure so conservatively labeling sec-high seems safe to me.

|  | [Ryan Hunt [:rhunt]](/user_profile?user_id=573202) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1879237#c10)• 11 months ago |
|  | |

Comment on [attachment 9379984](/attachment.cgi?id=9379984 "Bug 1879237: Consolidate wasm cast code. r=rhunt") [[details]](/attachment.cgi?id=9379984&action=edit "Bug 1879237: Consolidate wasm cast code. r=rhunt")

[Bug 1879237](/show_bug.cgi?id=1879237 "RESOLVED FIXED - [WASM] MOZ_ASSERT(v.isMem() == result.onStack());"): Consolidate wasm cast code. r=rhunt

### Security Approval Request

* **How easily could an exploit be constructed based on the patch?**: Not easily. The important change in the baseline compiler is masked by refactoring to centralize some of the register allocation logic. As noted above, it's not clear if this is exploitable either, but seems possible.
* **Do comments in the patch, the check-in comment, or tests included in the patch paint a bulls-eye on the security problem?**: No
* **Which branches (beta, release, and/or ESR) are affected by this flaw, and do the release status flags reflect this affected/unaffected state correctly?**: Beta and release
* **If not all supported branches, which bug introduced the flaw?**: 1817782, but not enabled until wasm-GC enabled in [bug 1845373](/show_bug.cgi?id=1845373 "RESOLVED FIXED - Let the Wasm-GC proposal ride the trains to release") (Fx120)
* **Do you have backports for the affected branches?**: Yes
* **If not, how different, hard to create, and risky will they be?**:
* **How likely is this patch to cause regressions; how much testing does it need?**: This is tricky code, but we do have some good tests for it (with more added for this case). We've also done some manual testing on known Wasm-GC websites.
* **Is the patch ready to land after security approval is given?**: Yes
* **Is Android affected?**: Yes
[Attachment #9379984](/attachment.cgi?id=9379984&action=edit "Bug 1879237: Consolidate wasm cast code. r=rhunt") -
Flags: sec-approval?

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1879237#c11)• 11 months ago |
|  | |

Comment on [attachment 9379984](/attachment.cgi?id=9379984 "Bug 1879237: Consolidate wasm cast code. r=rhunt") [[details]](/attachment.cgi?id=9379984&action=edit "Bug 1879237: Consolidate wasm cast code. r=rhunt")

[Bug 1879237](/show_bug.cgi?id=1879237 "RESOLVED FIXED - [WASM] MOZ_ASSERT(v.isMem() == result.onStack());"): Consolidate wasm cast code. r=rhunt

approved to land anduplift

[Attachment #9379984](/attachment.cgi?id=9379984&action=edit "Bug 1879237: Consolidate wasm cast code. r=rhunt") -
Flags: sec-approval? → sec-approval+

|  | [Pulsebot](/user_profile?user_id=510726) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1879237#c12)• 11 months ago |
|  | |

Pushed by bvisness@mozilla.com:
<https://hg.mozilla.org/integration/autoland/rev/d20d0f5e7849>
Consolidate wasm cast code. r=rhunt

|  | [Ben Visness [:bvisness]](/user_profile?user_id=594477)  Assignee |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1879237#c13)• 11 months ago |
|  | |

Attached file
[Bug 1879237: Consolidate wasm cast code. r=rhunt](attachment.cgi?id=9387903)
— [Details](attachment.cgi?id=9387903&action=edit)

The code for tracking register allocation in wasm casts was getting very

unwieldy. This patch replaces several switches with a single function

that checks which registers are necessary, and simplifies the allocation

logic in both baseline and ion to use this result.

Original Revision: <https://phabricator.services.mozilla.com/D201734>

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1879237#a1702377_600971)• 11 months ago |

[Attachment #9387903](/attachment.cgi?id=9387903&action=edit "Bug 1879237: Consolidate wasm cast code. r=rhunt") -
Flags: approval-mozilla-beta?

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1879237#c14)• 11 months ago |
|  | |

# Uplift Approval Request

* **User impact if declined**: This issue may be discovered to be exploitable, resulting in invalid wasm values being created, such as arbitrary integers turning into pointer values.
* **Steps to reproduce for manual QE testing**: None
* **Code covered by automated testing**: yes
* **Is Android affected?**: yes
* **Fix verified in Nightly**: yes
* **Needs manual QE test**: no
* **Explanation of risk level**: This is difficult code that has already seen an incomplete fix before. We've improved our test coverage in response and done manual testing on real world sites with this patch to mitigate the risk.
* **Risk associated with taking this patch**: Medium
* **String changes made/needed**: None

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1879237#c15)• 11 months ago |
|  | |

<https://hg.mozilla.org/mozilla-central/rev/d20d0f5e7849>

Group: javascript-core-security → core-security-releaseStatus: NEW → RESOLVEDClosed: 11 months ago
[status-firefox123](/buglist.cgi?f1=cf_status_firefox123&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox123&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox123&o1=equals&v1=wontfix)
[status-firefox125](/buglist.cgi?f1=cf_status_firefox125&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox125&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox125&o1=equals&v1=fixed)
[tracking-firefox124](/buglist.cgi?f1=cf_tracking_firefox124&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox124&o1=equals&v1=%2B)
[tracking-firefox125](/buglist.cgi?f1=cf_tracking_firefox125&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox125&o1=equals&v1=%2B)Flags: in-testsuite?Resolution: --- → FIXEDTarget Milestone: --- → 125 Branch

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1879237#a2037408_600971)• 11 months ago |

[Attachment #9387903](/attachment.cgi?id=9387903&action=edit "Bug 1879237: Consolidate wasm cast code. r=rhunt") -
Flags: approval-mozilla-beta? → approval-mozilla-beta+

|  | [Lando Automation](/user_profile?user_id=640478) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1879237#a2037630_640478)• 11 months ago |

[status-firefox124](/buglist.cgi?f1=cf_status_firefox124&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox124&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox124&o1=equals&v1=fixed)

|  | [Pulsebot](/user_profile?user_id=510726) |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1879237#c16)• 11 months ago |
| uplift | |

<https://hg.mozilla.org/releases/mozilla-beta/rev/e28c70d1db21>

|  | [P1umer](/user_profile?user_id=724227)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1879237#a2228180_724227)• 10 months ago |

Flags: sec-bounty?

|  | [Andrei Vaida [:avaida]](/user_profile?user_id=488993) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1879237#a2261540_488993)• 10 months ago |

QA Whiteboard: [post-critsmash-triage]Flags: qe-verify-

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1879237#a2310318_1689)• 10 months ago |

Flags: sec-bounty? → sec-bounty+

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1879237#c17)• 10 months ago |
|  | |

We're awarding a bounty on the lower end of the "sec-high" spectrum, because it's entirely unclear whether this can be exploited and how. We're happy to re-evaluate if you can find out more.

|  | [Tyson Smith [:tsmith]](/user_profile?user_id=486634) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1879237#a3016443_486634)• 10 months ago |

Whiteboard: [adv-main124+]

|  | [Tyson Smith [:tsmith]](/user_profile?user_id=486634) |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1879237#c18)• 10 months ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9391525)
— [Details](attachment.cgi?id=9391525&action=edit)

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1879237#a3420456_428608)• 10 months ago |

Alias: CVE-2024-2606

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1879237#a9734731_5898)• 8 months ago |

Keywords: [reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1879237#a19113147_1689)• 4 months ago |

Group: core-security-release
You need to [log in](/show_bug.cgi?id=1879237&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [P1umer](/user_profile?user_id=724227)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review


