- **Root cause of vulnerability**: Improper neutralization of SQL parameter in the `ConfiguratorAttachment::getAttachmentByToken` method.
- **Weaknesses/vulnerabilities present**: SQL Injection (CWE-89)
- **Impact of exploitation**:
    - Obtain admin access
    - Remove data from the associated PrestaShop
    - Copy/paste data from sensitive tables to FRONT to expose tokens and unlock adminsâ€™s ajax scripts
    - Rewrite SMTP settings to hijack emails
    - Massively steal credit cards using a webskimmer.
- **Attack vectors**: Network-based attack using a trivial HTTP call
- **Required attacker capabilities/position**: No privileges or user interaction is required. The attacker can be remote.

The vulnerability lies in the lack of proper sanitization of the `$token` parameter within the `ConfiguratorAttachment::getAttachmentByToken` method before it is used in a SQL query. This allows an attacker to inject malicious SQL code, which can lead to various malicious actions. The advisory also provides a patch that uses `pSQL` function to sanitize the token, preventing SQL injection.