The provided content relates to CVE-2024-27103.

**Root cause of vulnerability:**
The vulnerability stems from the usage of `dangerouslySetInnerHTML` without proper sanitization of user-supplied data, specifically within search result highlighting and table name auto-suggestions.

**Weaknesses/vulnerabilities present:**
- **Cross-Site Scripting (XSS):** The application uses `dangerouslySetInnerHTML` to render highlighted search results and table names in auto-suggestions, without sanitizing user-provided input. This allows an attacker to inject malicious JavaScript code which can execute in the context of other users' browsers.
- **Improper Input Sanitization:** The application fails to sanitize the input used in the highlighted search results and table name auto-suggestions.

**Impact of exploitation:**
- **Privilege Elevation:** By injecting malicious scripts, an attacker could potentially elevate their privileges by taking actions on behalf of another user if they view a crafted search result or query auto-suggestion. This could include data theft, account manipulation, or other malicious actions.
- **Arbitrary Code Execution:** Malicious scripts embedded within the search results or query auto-suggestions can be executed in the user's browser. This could lead to various attacks, including session hijacking and data exfiltration.

**Attack vectors:**
- **Search Results:** A malicious user could craft a query, datadoc, table, or list containing XSS payloads. When other users search for this content, the malicious code would be rendered and executed in their browsers.
- **Table Names:** A malicious user could create a table with a name containing an XSS payload. When other users use the auto-suggestion feature while querying the database, the malicious code would be rendered and executed.

**Required attacker capabilities/position:**
- An attacker needs to be a user able to create or manipulate data that is indexed by the search feature or create tables that would be subject to the auto-suggestion functionality.
- The attacker must be able to inject malicious code into data that is later displayed to other users through the vulnerable functionality.