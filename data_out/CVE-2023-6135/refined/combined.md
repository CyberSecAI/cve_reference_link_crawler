=== Content from security.gentoo.org_897e22ca_20250111_104907.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# Mozilla Firefox: Multiple Vulnerabilities — GLSA **202401-10**

Multiple vulnerabilities have been found in Mozilla Firefox, the worst of which could lead to remote code execution.

### Affected packages

| Package | **www-client/firefox** on all architectures |
| --- | --- |
| Affected versions | < **121.0**< **115.6.0** |
| Unaffected versions | >= **121.0**>= **115.6.0** |

| Package | **www-client/firefox-bin** on all architectures |
| --- | --- |
| Affected versions | < **121.0**< **115.6.0** |
| Unaffected versions | >= **121.0**>= **115.6.0** |

### Background

Mozilla Firefox is a popular open-source web browser from the Mozilla project.

### Description

Multiple vulnerabilities have been discovered in Mozilla Firefox. Please review the CVE identifiers referenced below for details.

### Impact

Please review the referenced CVE identifiers for details.

### Workaround

There is no known workaround at this time.

### Resolution

All Mozilla Firefox ESR binary users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=www-client/firefox-bin-115.6.0:esr"

```

All Mozilla Firefox ESR users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=www-client/firefox-115.6.0:esr"

```

All Mozilla Firefox binary users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=www-client/firefox-bin-121.0:rapid"

```

All Mozilla Firefox users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=www-client/firefox-121.0:rapid"

```
### References

* [CVE-2023-3482](https://nvd.nist.gov/vuln/detail/CVE-2023-3482)
* [CVE-2023-4058](https://nvd.nist.gov/vuln/detail/CVE-2023-4058)
* [CVE-2023-4579](https://nvd.nist.gov/vuln/detail/CVE-2023-4579)
* [CVE-2023-4863](https://nvd.nist.gov/vuln/detail/CVE-2023-4863)
* [CVE-2023-5129](https://nvd.nist.gov/vuln/detail/CVE-2023-5129)
* [CVE-2023-5170](https://nvd.nist.gov/vuln/detail/CVE-2023-5170)
* [CVE-2023-5172](https://nvd.nist.gov/vuln/detail/CVE-2023-5172)
* [CVE-2023-5173](https://nvd.nist.gov/vuln/detail/CVE-2023-5173)
* [CVE-2023-5175](https://nvd.nist.gov/vuln/detail/CVE-2023-5175)
* [CVE-2023-5722](https://nvd.nist.gov/vuln/detail/CVE-2023-5722)
* [CVE-2023-5723](https://nvd.nist.gov/vuln/detail/CVE-2023-5723)
* [CVE-2023-5729](https://nvd.nist.gov/vuln/detail/CVE-2023-5729)
* [CVE-2023-5731](https://nvd.nist.gov/vuln/detail/CVE-2023-5731)
* [CVE-2023-5758](https://nvd.nist.gov/vuln/detail/CVE-2023-5758)
* [CVE-2023-6135](https://nvd.nist.gov/vuln/detail/CVE-2023-6135)
* [CVE-2023-6210](https://nvd.nist.gov/vuln/detail/CVE-2023-6210)
* [CVE-2023-6211](https://nvd.nist.gov/vuln/detail/CVE-2023-6211)
* [CVE-2023-6213](https://nvd.nist.gov/vuln/detail/CVE-2023-6213)
* [CVE-2023-6856](https://nvd.nist.gov/vuln/detail/CVE-2023-6856)
* [CVE-2023-6857](https://nvd.nist.gov/vuln/detail/CVE-2023-6857)
* [CVE-2023-6858](https://nvd.nist.gov/vuln/detail/CVE-2023-6858)
* [CVE-2023-6859](https://nvd.nist.gov/vuln/detail/CVE-2023-6859)
* [CVE-2023-6860](https://nvd.nist.gov/vuln/detail/CVE-2023-6860)
* [CVE-2023-6861](https://nvd.nist.gov/vuln/detail/CVE-2023-6861)
* [CVE-2023-6862](https://nvd.nist.gov/vuln/detail/CVE-2023-6862)
* [CVE-2023-6863](https://nvd.nist.gov/vuln/detail/CVE-2023-6863)
* [CVE-2023-6864](https://nvd.nist.gov/vuln/detail/CVE-2023-6864)
* [CVE-2023-6865](https://nvd.nist.gov/vuln/detail/CVE-2023-6865)
* [CVE-2023-6866](https://nvd.nist.gov/vuln/detail/CVE-2023-6866)
* [CVE-2023-6867](https://nvd.nist.gov/vuln/detail/CVE-2023-6867)
* [CVE-2023-6868](https://nvd.nist.gov/vuln/detail/CVE-2023-6868)
* [CVE-2023-6869](https://nvd.nist.gov/vuln/detail/CVE-2023-6869)
* [CVE-2023-6870](https://nvd.nist.gov/vuln/detail/CVE-2023-6870)
* [CVE-2023-6871](https://nvd.nist.gov/vuln/detail/CVE-2023-6871)
* [CVE-2023-6872](https://nvd.nist.gov/vuln/detail/CVE-2023-6872)
* [CVE-2023-6873](https://nvd.nist.gov/vuln/detail/CVE-2023-6873)
* [CVE-2023-32205](https://nvd.nist.gov/vuln/detail/CVE-2023-32205)
* [CVE-2023-32206](https://nvd.nist.gov/vuln/detail/CVE-2023-32206)
* [CVE-2023-32207](https://nvd.nist.gov/vuln/detail/CVE-2023-32207)
* [CVE-2023-32208](https://nvd.nist.gov/vuln/detail/CVE-2023-32208)
* [CVE-2023-32209](https://nvd.nist.gov/vuln/detail/CVE-2023-32209)
* [CVE-2023-32210](https://nvd.nist.gov/vuln/detail/CVE-2023-32210)
* [CVE-2023-32211](https://nvd.nist.gov/vuln/detail/CVE-2023-32211)
* [CVE-2023-32212](https://nvd.nist.gov/vuln/detail/CVE-2023-32212)
* [CVE-2023-32213](https://nvd.nist.gov/vuln/detail/CVE-2023-32213)
* [CVE-2023-32214](https://nvd.nist.gov/vuln/detail/CVE-2023-32214)
* [CVE-2023-32215](https://nvd.nist.gov/vuln/detail/CVE-2023-32215)
* [CVE-2023-32216](https://nvd.nist.gov/vuln/detail/CVE-2023-32216)
* [CVE-2023-34414](https://nvd.nist.gov/vuln/detail/CVE-2023-34414)
* [CVE-2023-34415](https://nvd.nist.gov/vuln/detail/CVE-2023-34415)
* [CVE-2023-34416](https://nvd.nist.gov/vuln/detail/CVE-2023-34416)
* [CVE-2023-34417](https://nvd.nist.gov/vuln/detail/CVE-2023-34417)
* [CVE-2023-37203](https://nvd.nist.gov/vuln/detail/CVE-2023-37203)
* [CVE-2023-37204](https://nvd.nist.gov/vuln/detail/CVE-2023-37204)
* [CVE-2023-37205](https://nvd.nist.gov/vuln/detail/CVE-2023-37205)
* [CVE-2023-37206](https://nvd.nist.gov/vuln/detail/CVE-2023-37206)
* [CVE-2023-37209](https://nvd.nist.gov/vuln/detail/CVE-2023-37209)
* [CVE-2023-37210](https://nvd.nist.gov/vuln/detail/CVE-2023-37210)
* [CVE-2023-37212](https://nvd.nist.gov/vuln/detail/CVE-2023-37212)
* MFSA-2023-40
* MFSA-TMP-2023-0002

**Release date**

January 07, 2024

**Latest revision**

January 07, 2024: 1

**Severity**

high

**Exploitable**

remote

**Bugzilla entries**

* [908245](https://bugs.gentoo.org/show_bug.cgi?id=908245)
* [914073](https://bugs.gentoo.org/show_bug.cgi?id=914073)
* [918433](https://bugs.gentoo.org/show_bug.cgi?id=918433)
* [920507](https://bugs.gentoo.org/show_bug.cgi?id=920507)

### Questions or comments?

Please feel free to contact us.

**© 2001–2020 Gentoo Foundation, Inc.**



=== Content from bugzilla.mozilla.org_04efd49d_20250111_104907.html ===


![](/static/v20250108.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1853908)
* [XML](/show_bug.cgi?ctype=xml&id=1853908)

Closed
[Bug 1853908](/show_bug.cgi?id=1853908)
(CVE-2023-6135)

Opened 1 year ago
Closed 1 year ago

# Minerva attack on P-256 and P-384 in NSS

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Minerva attack on P-256 and P-384 in NSS

## Categories

### (NSS :: Libraries, defect, P1)

[Product:](/describecomponents.cgi?product=NSS)

NSS
▾

NSS
Network Security Services - a cross-platform
security library ([more info](http://www.mozilla.org/projects/security/pki/nss/))
[See Open Bugs in This Product](/buglist.cgi?product=NSS&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=NSS)
Watch This Product

[Component:](/describecomponents.cgi?product=NSS&component=Libraries#Libraries)

Libraries
▾

NSS :: Libraries
Libraries for client support of SSL v2 and v3, TLS, PKCS #5,
PKCS #7, PKCS #11, PKCS #12, S/MIME, X.509 v3 certificates,
and other security standards
[See Open Bugs in This Component](/buglist.cgi?product=NSS&component=Libraries&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=NSS&component=Libraries&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=NSS&component=Libraries)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

other

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

P1

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

S2

## Tracking

### (firefox-esr115 wontfix, firefox120 wontfix, firefox121 fixed)

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

3.95

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Accessibility Severity | --- |
| --- | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr115 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=wontfix) |
| firefox120 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox120&o1=equals&v1=wontfix) |
| firefox121 | --- | [fixed](/buglist.cgi?f1=cf_status_firefox121&o1=equals&v1=fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| firefox-esr115 | --- | wontfix |
| firefox-esr128 | --- | --- |
| firefox120 |  | wontfix |
| firefox121 |  | fixed |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: gpantela, Assigned: jschanck)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/291ff310b7805a4159d7f46af196813e?d=mm&size=40)  [jschanck](/user_profile?user_id=689878)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/086bd981b6b3a9a29539de07445d5301?d=mm&size=40)  [gpantela](/user_profile?user_id=734632)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/38f561698d679a724938d4600c0f8b52?d=mm&size=40)  [beurdouche](/user_profile?user_id=622637)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

14 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

[1861728](/show_bug.cgi?id=1861728 "RESOLVED FIXED - Include P-256 Scalar Validation from HACL*"), [1863605](/show_bug.cgi?id=1863605 "RESOLVED FIXED - Include P-384 and P-521 Scalar Validation from HACL*")

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

Dependency [tree](/showdependencytree.cgi?id=1853908&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=1853908)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Keywords: csectype-side-channel, reporter-external, sec-high, Whiteboard: [post-critsmash-triage][adv-main121+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2023-6135

[Keywords:](/describekeywords.cgi)

[csectype-side-channel](/buglist.cgi?keywords=csectype-side-channel&resolution=---),
[reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---),
[sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[post-critsmash-triage][adv-main121+]

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [avaida](/user_profile?user_id=488993) | [qe-verify](#a6547164_488993 "1 year ago") | - |
| --- | --- | --- |
| [avaida](/user_profile?user_id=488993) | qe-verify | - |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (6 files)

| [In this zip file there are 2 png images. One is called conf\_interval\_plot\_median\_before\_K\_generation and the other conf\_interval\_plot\_median\_K\_generation](/attachment.cgi?id=9353882)  [1 year ago](#c0)  [gpantela](/user_profile?user_id=734632)   80.59 KB, application/zip |  | [Details](/attachment.cgi?id=9353882&action=edit) |
| --- | --- | --- |
| [Minerva\_timing.zip](/attachment.cgi?id=9362322)  [1 year ago](#c11)  [gpantela](/user_profile?user_id=734632)   116.45 KB, application/octet-stream |  | [Details](/attachment.cgi?id=9362322&action=edit) |
| [conf\_interval\_plot\_all\_k\_sizes\_median\_0-10.png](/attachment.cgi?id=9364858)  [1 year ago](#c15)  [gpantela](/user_profile?user_id=734632)   53.41 KB, image/png |  | [Details](/attachment.cgi?id=9364858&action=edit) |
| [P-521.diff](/attachment.cgi?id=9365211)  [1 year ago](#c17)  [Alicja Kario](/user_profile?user_id=487652)   649.74 KB, patch |  | [Details](/attachment.cgi?id=9365211&action=edit) | [Diff](/attachment.cgi?id=9365211&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1853908&attachment=9365211) |
| [Plot of the amount of time need for nss to sign data with ecdsa. No side channel detected.](/attachment.cgi?id=9366886)  [1 year ago](#c19)  [gpantela](/user_profile?user_id=734632)   59.79 KB, image/png |  | [Details](/attachment.cgi?id=9366886&action=edit) |
| [advisory.txt](/attachment.cgi?id=9367976)  [1 year ago](#c21)  [Jason Kratzer [:jkratzer]](/user_profile?user_id=586683)   210 bytes, text/plain |  | [Details](/attachment.cgi?id=9367976&action=edit) |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [gpantela](/user_profile?user_id=734632)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1853908#c0)• 1 year ago |
|  | |

Attached file
[In this zip file there are 2 png images. One is called conf\_interval\_plot\_median\_before\_K\_generation and the other conf\_interval\_plot\_median\_K\_generation](attachment.cgi?id=9353882)
— [Details](attachment.cgi?id=9353882&action=edit)

Steps to reproduce:

My team and I have tested NSS and we found that it is vulnerable to the Minerva attack and we have now identified the first piece of code that contributes to the side channel.

The test scenario is that we are signing random messages using the SEC\_SignData API and then using the private key to extract the K value from the signatures. Then based on the bit size of the extracted nonce we compare full-sized nonces to smaller ones and use the statistical tests to compare the signature times.

Actual results:

Now we have executed the test to verify that all the code from SEC\_SignData up to line <https://github.com/nss-dev/nss/blob/master/lib/freebl/ec.c#L978> is not leaky and then we have verified that the code in lines <https://github.com/nss-dev/nss/blob/master/lib/freebl/ec.c#L979-L986> does leak. We suspect that the side channel is caused by the fact that K is an MPI object, and thus subject to normalization (automatic memory management based on bit size). You can see the results of the analysis below.

For testing, we built nss statically from hg and used the master checkout from 2023-09-14 for both nss and nspr.

The result in the attachment namedconf\_interval\_plot\_median\_before\_K\_generation.png represents code from SEC\_SignData up to line 978 of file lib/freebl/ec.c and as you can see in this code there is no leak found. The sample tested has 102,723,896 observations.

The result in the attachment named conf\_interval\_plot\_median\_K\_generation.png represents code from line 979 to line 986 in file lib/freebl/ec.c and we can clearly see that there is a leak: there is a clear dependency between the bit size of K and the size of the side channel. The sample tested has 129,438,263 observations.

Because we have identified this piece of code as leaky we won't be able to exclude the possibility of a side-channel in the subsequent code. We will need to run the test again after the leaking piece of code is fixed to be able to verify that NSS is not valuable to Minerva anymore (overall we have found a side-channel of ~50 ns and in the k-generating piece of code is only ~45 ns, although the extra 5 ns could be the effect of this piece of code not being side-channel free on the subsequent signature code).

Expected results:

The code should have no side-channels.

|  | [Dana Keeler (she/her) (use needinfo) [:keeler]](/user_profile?user_id=349244) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1853908#a10659_349244)• 1 year ago |

Component: Tools → Libraries

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1853908#a118665_1689)• 1 year ago |

Flags: needinfo?(bbeurdouche)

|  | [Benjamin Beurdouche [:beurdouche]](/user_profile?user_id=622637) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1853908#a177836_622637)• 1 year ago |

Flags: needinfo?(bbeurdouche)

|  | [John Schanck [:jschanck]](/user_profile?user_id=689878)  Assignee |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1853908#c1)• 1 year ago |
|  | |

Thanks for this report. We're working on a fix.

Severity: -- → S2Status: UNCONFIRMED → NEWEver confirmed: truePriority: -- → P2

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1853908#c2)• 1 year ago |
|  | |

John: how bad is this attack for Firefox users in practice? sec-high? sec-moderate?

Flags: needinfo?(jschanck)

|  | [John Schanck [:jschanck]](/user_profile?user_id=689878)  Assignee |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1853908#c3)• 1 year ago |
|  | |

This code is accessible from WebCrypto and ipcclientcerts, so Firefox is affected. A 50ns difference is going to be difficult to observe over the network. However, reliable observation leads to the disclosure of signing keys, so I think it's a sec-high.

Flags: needinfo?(jschanck)

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1853908#a2364055_406194)• 1 year ago |

Keywords: [csectype-side-channel](/buglist.cgi?keywords=csectype-side-channel&resolution=---),
[sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

|  | [John Schanck [:jschanck]](/user_profile?user_id=689878)  Assignee |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1853908#c4)• 1 year ago |
|  | |

Our partners at Cryspen are going to fix this. I'm self-assigning as they don't have access to sec bugs, and the patch will not be attached to this bug.

Assignee: nobody → jschanckStatus: NEW → ASSIGNEDPriority: P2 → P1

|  | [John Schanck [:jschanck]](/user_profile?user_id=689878)  Assignee |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1853908#c5)• 1 year ago |
|  | |

This is being handled as part of ongoing work on integrating formally verified implementations of the NIST P-curves into NSS ([Bug 1615555](/show_bug.cgi?id=1615555 "RESOLVED FIXED - Integration of HACL* P-256"), [Bug 1854438](/show_bug.cgi?id=1854438 "RESOLVED FIXED - Integrate HACL* P-384"), [Bug 1854439](/show_bug.cgi?id=1854439 "RESOLVED FIXED - Integrate HACL* P-521")), which will be finished soon.

|  | [Alicja Kario](/user_profile?user_id=487652) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1853908#c6)• 1 year ago |
|  | |

@John, but we've tested the P-256 code *after* <https://hg.mozilla.org/projects/nss/rev/88262a8e60126b5168d0b96306ed5fd2de4867bb> was merged...

|  | [John Schanck [:jschanck]](/user_profile?user_id=689878)  Assignee |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1853908#c7)• 1 year ago |
|  | |

It's being done as part of that line of work. The fix is not part of that patch.

|  | [John Schanck [:jschanck]](/user_profile?user_id=689878)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1853908#a3307672_689878)• 1 year ago |

Depends on: [1861728](/show_bug.cgi?id=1861728 "RESOLVED FIXED - Include P-256 Scalar Validation from HACL*")

|  | [John Schanck [:jschanck]](/user_profile?user_id=689878)  Assignee |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1853908#c8)• 1 year ago |
|  | |

Hubert, the fix for P-256 has been merged to NSS trunk <https://hg.mozilla.org/projects/nss/rev/e68b42b773657000078d104aaccbe26e71a1e0be>.

Depends on: [1854438](/show_bug.cgi?id=1854438 "RESOLVED FIXED - Integrate HACL* P-384"), [1854439](/show_bug.cgi?id=1854439 "RESOLVED FIXED - Integrate HACL* P-521")

|  | [Robert Relyea](/user_profile?user_id=11099) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1853908#c9)• 1 year ago |
|  | |

re [comment 8](/show_bug.cgi?id=1853908#c8 "RESOLVED FIXED - Minerva attack on P-256 and P-384 in NSS"): That looks like the code that we thought was the issue.

|  | [John Schanck [:jschanck]](/user_profile?user_id=689878)  Assignee |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1853908#c10)• 1 year ago |
|  | |

It seems likely that Cryspen won't have the other curves ready in time for the next NSS release. So I'll write patches for those.

@gpantela, I'd like to confirm our fix for P-256 and also evaluate the size of the side channel for the other curves. Could you share your timing code?

Flags: needinfo?(gpantela)

|  | [gpantela](/user_profile?user_id=734632)  Reporter |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1853908#c11)• 1 year ago |
|  | |

Attached file
[Minerva\_timing.zip](attachment.cgi?id=9362322)
— [Details](attachment.cgi?id=9362322&action=edit)

Hello, I am attaching Minerva\_timing.zip which includes result graphs from the fix on NIST256p and the requested scripts.

For the scripts, there is a readme.md file that explains how to use them.

To elaborate more on the fix. Unfortunately, we do not have enough data yet to say with absolute certainty that the side channel was eliminated completely but the side channel was reduced after the fix to single-digit ns. This means that the fix is improving the situation. We will continue to collect the data and will provide you with additional information later. When you do have the patches for NIST384p and NIST521p feel free to send them to us so we can test them.

Flags: needinfo?(gpantela)

|  | [John Schanck [:jschanck]](/user_profile?user_id=689878)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1853908#a4261757_689878)• 1 year ago |

Depends on: [1863605](/show_bug.cgi?id=1863605 "RESOLVED FIXED - Include P-384 and P-521 Scalar Validation from HACL*")

|  | [John Schanck [:jschanck]](/user_profile?user_id=689878)  Assignee |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1853908#c12)• 1 year ago |
|  | |

Thanks! I've attached a patch for P-384 and P-521 to [Bug 1863605](/show_bug.cgi?id=1863605 "RESOLVED FIXED - Include P-384 and P-521 Scalar Validation from HACL*").

|  | [John Schanck [:jschanck]](/user_profile?user_id=689878)  Assignee |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1853908#c13)• 1 year ago |
|  | |

The patch for P-384 and P-521 has landed in NSS trunk. I'm confident, from inspection of the code and from the timing tests, that there's no longer a network observable timing side-channel here.

Status: ASSIGNED → RESOLVEDClosed: 1 year agoResolution: --- → FIXED

|  | [John Schanck [:jschanck]](/user_profile?user_id=689878)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1853908#a4440559_689878)• 1 year ago |

No longer depends on: [1854438](/show_bug.cgi?id=1854438 "RESOLVED FIXED - Integrate HACL* P-384"), [1854439](/show_bug.cgi?id=1854439 "RESOLVED FIXED - Integrate HACL* P-521")

|  | [gpantela](/user_profile?user_id=734632)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1853908#a4499476_734632)• 1 year ago |

Status: RESOLVED → REOPENEDResolution: FIXED → ---

|  | [Alicja Kario](/user_profile?user_id=487652) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1853908#c14)• 1 year ago |
|  | |

1. testing for P-256 is not finished
2. This is a security issue, we need a CVE assigned
3. We even haven't started testing P-384 or P-521

So, no, I don't think we can consider Minerva to be done and finished as a topic.

Flags: needinfo?(jschanck)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1853908#a4870154_578488)• 1 year ago |

Alias: CVE-2023-6135

|  | [gpantela](/user_profile?user_id=734632)  Reporter |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1853908#c15)• 1 year ago |
|  | |

Attached image
[conf\_interval\_plot\_all\_k\_sizes\_median\_0-10.png](attachment.cgi?id=9364858)
— [Details](attachment.cgi?id=9364858&action=edit)

Hello,

We have tested the fixed version on P-521 and we found out that the fix did NOT work fully. It has definitely helped the side channel's size but the side channel is still there. Also in the P-521 curve, there is a "step" from 513 to 512 that needs a bit more attention.

I am attaching a graph with the first 10 nonce sizes that show the side channels and the "step".

Thank you very much for all your time and efforts!

For reference, the p-values of the first 10 nonce sizes are:

K size of 521: n=25992110, pvalue=0.1773705822345769

K size of 520: n=118800233, pvalue=1.1532642817636213e-06

K size of 519: n=69254593, pvalue=0.0006259390728389119

K size of 518: n=37681393, pvalue=7.724653206901568e-09

K size of 517: n=19696178, pvalue=5.492816419730179e-06

K size of 516: n=10082674, pvalue=7.63628467844954e-08

K size of 515: n=5092416, pvalue=0.6586284140275034

K size of 514: n=2561652, pvalue=0.9357608648292923

K size of 513: n=1284527, pvalue=0.04931945934013337

K size of 512: n=642243, pvalue=8.043381228577995e-05

K size of 511: n=322084, pvalue=0.07956264294715022

For any questions feel free to contact us!

Sincerely,

George and Hubert

|  | [gpantela](/user_profile?user_id=734632)  Reporter |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1853908#c16)• 1 year ago |
|  | |

As a follow-up to the previous comment:

The version we tested was the head of mercurial on 15/11/2023. It seems to us that the patches for P-384 and P-521 are not integrated completely. There are some changes but the code from bugs 1854438, and 1854439 is not there yet. We tried to apply the patches but they were not applied cleanly. Perhaps a rebase if needed to apply the patches. When you do rebase, we can retest it to verify that the side channels are eliminated before it is merged.

|  | [Alicja Kario](/user_profile?user_id=487652) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1853908#c17)• 1 year ago |
|  | |

Attached patch

[P-521.diff](attachment.cgi?id=9365211&action=diff)
— [Details](attachment.cgi?id=9365211&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1853908&attachment=9365211)

Since we're most worried about P-521 (as the non multiple of 64 size makes implementation tricky), I've done a quick rebase of the patch from [bug 1854439](/show_bug.cgi?id=1854439 "RESOLVED FIXED - Integrate HACL* P-521"). We'll start testing it.

|  | [John Schanck [:jschanck]](/user_profile?user_id=689878)  Assignee |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1853908#c18)• 1 year ago |
|  | |

Thanks for the update. We are aware of timing side-channels in the existing P-384 and P-521 code, and we're also aware of timing side-channels in the work-in-progress replacements from [Bug 1854438](/show_bug.cgi?id=1854438 "RESOLVED FIXED - Integrate HACL* P-384") and [Bug 1854439](/show_bug.cgi?id=1854439 "RESOLVED FIXED - Integrate HACL* P-521"). The Cryspen team is working on resolving the known issues and plans to have those patches ready early next year.

Given the very low prevalence of P-521 in deployment, and the fact that the timing side-channel is visible in only 1 in 512 nonces, I would not rank the remaining defect as a sec-high. It's important to track that there was a sec-high for P-256 here, so I'm going to split the remaining P-521 defect off into a new bug ([Bug 1866848](/show_bug.cgi?id=1866848 "REOPENED")). Feel free to split P-384 off into a new bug if you find that you are still able to detect a side-channel.

Status: REOPENED → RESOLVEDClosed: 1 year ago → 1 year agoFlags: needinfo?(jschanck)Resolution: --- → FIXEDSummary: Minerva attack on NSS → Minerva attack on P-256 and P-384 in NSS

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1853908#a5992117_75935)• 1 year ago |

Group: crypto-core-security → core-security-release
[status-firefox120](/buglist.cgi?f1=cf_status_firefox120&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox120&o1=equals&v1=wontfix)
[status-firefox121](/buglist.cgi?f1=cf_status_firefox121&o1=isnotempty):
--- → [fixed](/buglist.cgi?f1=cf_status_firefox121&o1=equals&v1=fixed)
[status-firefox-esr115](/buglist.cgi?f1=cf_status_firefox_esr115&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=wontfix)Target Milestone: --- → 3.95

|  | [Andrei Vaida [:avaida]](/user_profile?user_id=488993) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1853908#a6547164_488993)• 1 year ago |

Flags: qe-verify-Whiteboard: [post-critsmash-triage]

|  | [gpantela](/user_profile?user_id=734632)  Reporter |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1853908#c19)• 1 year ago |
|  | |

Attached image
[Plot of the amount of time need for nss to sign data with ecdsa. No side channel detected.](attachment.cgi?id=9366886)
— [Details](attachment.cgi?id=9366886&action=edit)

Hello, my team and I have gathered 701,794,739 samples of singing with NSS ECDSA keys and we can verify that the fix for the NIST256p curve eliminated the side channel in x86\_64 architecture.

Also, attaching a plot that shows that there is no visible side channel.

|  | [gpantela](/user_profile?user_id=734632)  Reporter |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1853908#c20)• 1 year ago |
|  | |

Follow up on [Comment 19](/show_bug.cgi?id=1853908#c19 "RESOLVED FIXED - Minerva attack on P-256 and P-384 in NSS"):

The version of NSS tested was commit 3e25d69ba6b2 for nspr and 46a7d596d718 for nss. Default branch. The gatherer run on 28-11-2023.

|  | [Jason Kratzer [:jkratzer]](/user_profile?user_id=586683) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1853908#a7179229_586683)• 1 year ago |

Whiteboard: [post-critsmash-triage] → [post-critsmash-triage][adv-main121+]

|  | [Jason Kratzer [:jkratzer]](/user_profile?user_id=586683) |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=1853908#c21)• 1 year ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9367976)
— [Details](attachment.cgi?id=9367976&action=edit)

|  | [Mike Hommey [:glandium]](/user_profile?user_id=47192) |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=1853908#c22)• 1 year ago |
|  | |

This CVE is not listed on <https://www.mozilla.org/en-US/security/known-vulnerabilities/nss/>

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=1853908#c23)• 9 months ago |
|  | |

Bulk-unhiding security bugs fixed in Firefox 119-121 (Fall 2023). Use "moo-doctrine-subsidy" to filter

Group: core-security-release

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=1853908#c24)• 7 months ago |
|  | |

Sorry for the burst of bugspam: filter on tinkling-glitter-filtrate

Adding `reporter-external` keyword to security bugs found by non-employees for accounting reasons

Keywords: [reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)
You need to [log in](/show_bug.cgi?id=1853908&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [gpantela](/user_profile?user_id=734632)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from www.mozilla.org_49d17580_20250111_104908.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    #### Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    #### Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [#### Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    #### Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    #### Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    #### Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    #### Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    #### MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    #### Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    #### Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [#### About Mozilla](/en-US/about/)
  + [#### The Mozilla Manifesto](/en-US/about/manifesto/)
  + [#### Get Involved](/en-US/contribute/)
  + [#### Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [#### Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [#### Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2023-56

## Security Vulnerabilities fixed in Firefox 121

Announced
December 19, 2023
Impact
high
Products
Firefox
Fixed in

* Firefox 121

#### [#CVE-2023-6856: Heap-buffer-overflow affecting WebGL DrawElementsInstanced method with Mesa VM driver](#CVE-2023-6856)

Reporter
DoHyun Lee
Impact
high
##### Description

The WebGL `DrawElementsInstanced` method was susceptible to a heap buffer overflow when used on systems with the Mesa VM driver. This issue could allow an attacker to perform remote code execution and sandbox escape.

##### References

* [Bug 1843782](https://bugzilla.mozilla.org/show_bug.cgi?id=1843782)

#### [#CVE-2023-6135: NSS susceptible to "Minerva" attack](#CVE-2023-6135)

Reporter
George Pantela (Red Hat) and Hubert Kario (Red Hat)
Impact
high
##### Description

Multiple NSS NIST curves were susceptible to a side-channel attack known as "Minerva". This attack could potentially allow an attacker to recover the private key.

##### References

* [Bug 1853908](https://bugzilla.mozilla.org/show_bug.cgi?id=1853908)

#### [#CVE-2023-6865: Potential exposure of uninitialized data in EncryptingOutputStream](#CVE-2023-6865)

Reporter
Jan Varga
Impact
high
##### Description

`EncryptingOutputStream` was susceptible to exposing uninitialized data. This issue could only be abused in order to write data to a local disk which may have implications for private browsing mode.

##### References

* [Bug 1864123](https://bugzilla.mozilla.org/show_bug.cgi?id=1864123)

#### [#CVE-2023-6857: Symlinks may resolve to smaller than expected buffers](#CVE-2023-6857)

Reporter
Jed Davis
Impact
moderate
##### Description

When resolving a symlink, a race may occur where the buffer passed to `readlink` may actually be smaller than necessary.
*This bug only affects Firefox on Unix-based operating systems (Android, Linux, MacOS). Windows is unaffected.*

##### References

* [Bug 1796023](https://bugzilla.mozilla.org/show_bug.cgi?id=1796023)

#### [#CVE-2023-6858: Heap buffer overflow in nsTextFragment](#CVE-2023-6858)

Reporter
Irvan Kurniawan
Impact
moderate
##### Description

Firefox was susceptible to a heap buffer overflow in `nsTextFragment` due to insufficient OOM handling.

##### References

* [Bug 1826791](https://bugzilla.mozilla.org/show_bug.cgi?id=1826791)

#### [#CVE-2023-6859: Use-after-free in PR\_GetIdentitiesLayer](#CVE-2023-6859)

Reporter
Irvan Kurniawan
Impact
moderate
##### Description

A use-after-free condition affected TLS socket creation when under memory pressure.

##### References

* [Bug 1840144](https://bugzilla.mozilla.org/show_bug.cgi?id=1840144)

#### [#CVE-2023-6866: TypedArrays lack sufficient exception handling](#CVE-2023-6866)

Reporter
Tom Schuster
Impact
moderate
##### Description

TypedArrays can be fallible and lacked proper exception handling. This could lead to abuse in other APIs which expect TypedArrays to always succeed.

##### References

* [Bug 1849037](https://bugzilla.mozilla.org/show_bug.cgi?id=1849037)

#### [#CVE-2023-6860: Potential sandbox escape due to VideoBridge lack of texture validation](#CVE-2023-6860)

Reporter
Andrew Osmond
Impact
moderate
##### Description

The `VideoBridge` allowed any content process to use textures produced by remote decoders. This could be abused to escape the sandbox.

##### References

* [Bug 1854669](https://bugzilla.mozilla.org/show_bug.cgi?id=1854669)

#### [#CVE-2023-6867: Clickjacking permission prompts using the popup transition](#CVE-2023-6867)

Reporter
Hafiizh
Impact
moderate
##### Description

The timing of a button click causing a popup to disappear was approximately the same length as the anti-clickjacking delay on permission prompts. It was possible to use this fact to surprise users by luring them to click where the permission grant button would be about to appear.

##### References

* [Bug 1863863](https://bugzilla.mozilla.org/show_bug.cgi?id=1863863)

#### [#CVE-2023-6861: Heap buffer overflow affected nsWindow::PickerOpen(void) in headless mode](#CVE-2023-6861)

Reporter
Yangkang of 360 ATA Team
Impact
moderate
##### Description

The `nsWindow::PickerOpen(void)` method was susceptible to a heap buffer overflow when running in headless mode.

##### References

* [Bug 1864118](https://bugzilla.mozilla.org/show_bug.cgi?id=1864118)

#### [#CVE-2023-6868: WebPush requests on Firefox for Android did not require VAPID key](#CVE-2023-6868)

Reporter
John-Mark Gurney
Impact
moderate
##### Description

In some instances, the user-agent would allow push requests which lacked a valid VAPID even though the push manager subscription defined one. This could allow empty messages to be sent from unauthorized parties.
*This bug only affects Firefox on Android.*

##### References

* [Bug 1865488](https://bugzilla.mozilla.org/show_bug.cgi?id=1865488)

#### [#CVE-2023-6869: Content can paint outside of sandboxed iframe](#CVE-2023-6869)

Reporter
Oriol Brufau
Impact
low
##### Description

A `<dialog>` element could have been manipulated to paint content outside of a sandboxed iframe. This could allow untrusted content to display under the guise of trusted content.

##### References

* [Bug 1799036](https://bugzilla.mozilla.org/show_bug.cgi?id=1799036)

#### [#CVE-2023-6870: Android Toast notifications may obscure fullscreen event notifications](#CVE-2023-6870)

Reporter
Hafiizh
Impact
low
##### Description

Applications which spawn a Toast notification in a background thread may have obscured fullscreen notifications displayed by Firefox.
*This issue only affects Android versions of Firefox and Firefox Focus.*

##### References

* [Bug 1823316](https://bugzilla.mozilla.org/show_bug.cgi?id=1823316)

#### [#CVE-2023-6871: Lack of protocol handler warning in some instances](#CVE-2023-6871)

Reporter
Edward "JankhJankh" Prior
Impact
low
##### Description

Under certain conditions, Firefox did not display a warning when a user attempted to navigate to a new protocol handler.

##### References

* [Bug 1828334](https://bugzilla.mozilla.org/show_bug.cgi?id=1828334)

#### [#CVE-2023-6872: Browsing history leaked to syslogs via GNOME](#CVE-2023-6872)

Reporter
honorton via Tor Browser
Impact
low
##### Description

Browser tab titles were being leaked by GNOME to system logs. This could potentially expose the browsing habits of users running in a private tab.

##### References

* [Bug 1849186](https://bugzilla.mozilla.org/show_bug.cgi?id=1849186)

#### [#CVE-2023-6863: Undefined behavior in ShutdownObserver()](#CVE-2023-6863)

Reporter
Ronald Crane
Impact
low
##### Description

The `ShutdownObserver()` was susceptible to potentially undefined behavior due to its reliance on a dynamic type that lacked a virtual destructor.

##### References

* [Bug 1868901](https://bugzilla.mozilla.org/show_bug.cgi?id=1868901)

#### [#CVE-2023-6864: Memory safety bugs fixed in Firefox 121, Firefox ESR 115.6, and Thunderbird 115.6](#CVE-2023-6864)

Reporter
Andrew McCreight, Randell Jesup, Valentin Gosu, Karl Tomlinson, and the Mozilla Fuzzing Team,
Impact
high
##### Description

Memory safety bugs present in Firefox 120, Firefox ESR 115.5, and Thunderbird 115.5. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 121, Firefox ESR 115.6, and Thunderbird 115.6](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1736385%2C1810805%2C1846328%2C1856090%2C1858033%2C1858509%2C1862777%2C1864015)

#### [#CVE-2023-6873: Memory safety bugs fixed in Firefox 121](#CVE-2023-6873)

Reporter
Andrew McCreight, Yury Delendik
Impact
high
##### Description

Memory safety bugs present in Firefox 120. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 121](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1855327%2C1862089%2C1862723)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)


