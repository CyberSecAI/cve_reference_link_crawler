- **Root cause of vulnerability**: The `sprintf` function is used to construct a string using a user-supplied `page` parameter without proper bounds checking. The destination buffer `v11` is smaller than the potential size of the string formed, which leads to a stack buffer overflow.
- **Weaknesses/vulnerabilities present**: Stack buffer overflow in the `fromP2pListFilter` function. The `sprintf` function is used to write user supplied data into a fixed size buffer `v11`. There is no validation of the size of the `page` parameter and it is directly written to the stack using `sprintf`
- **Impact of exploitation**: By overflowing the buffer, an attacker can overwrite adjacent data on the stack, potentially leading to arbitrary code execution, denial of service or other undefined behavior.
- **Attack vectors**: The vulnerability is triggered by sending a POST request to the `/goform/P2pListFilter` endpoint, with a large string provided in the `page` parameter.
- **Required attacker capabilities/position**: An attacker must be able to send HTTP POST requests to the vulnerable device, which means they must be able to reach the device on the network.