[Open in app](https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fdb992a01686a&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---top_nav_layout_nav----------------------------------)

[Sign up](https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Finfosecwriteups.com%2Fcve-2023-39308-wordpress-plugin-user-feedback-1-0-7-unauthenticated-stored-xss-db992a01686a&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

[Sign in](https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Finfosecwriteups.com%2Fcve-2023-39308-wordpress-plugin-user-feedback-1-0-7-unauthenticated-stored-xss-db992a01686a&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

[Write](https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---top_nav_layout_nav-----------------------new_post_topnav-----------)

[Sign up](https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Finfosecwriteups.com%2Fcve-2023-39308-wordpress-plugin-user-feedback-1-0-7-unauthenticated-stored-xss-db992a01686a&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

[Sign in](https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Finfosecwriteups.com%2Fcve-2023-39308-wordpress-plugin-user-feedback-1-0-7-unauthenticated-stored-xss-db992a01686a&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

![](https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png)
# CVE-2023–39308: User Feedback <= 1.0.7 — Unauthenticated Stored XSS

[![Revan A](https://miro.medium.com/v2/resize:fill:88:88/1*zcEfSVZsF5xT4rSLv-ze4w.jpeg)](https://revan-ar.medium.com/?source=post_page---byline--db992a01686a--------------------------------)[![InfoSec Write-ups](https://miro.medium.com/v2/resize:fill:48:48/1*SWJxYWGZzgmBP1D0Qg_3zQ.png)](https://infosecwriteups.com/?source=post_page---byline--db992a01686a--------------------------------)

[Revan A](https://revan-ar.medium.com/?source=post_page---byline--db992a01686a--------------------------------)

·

[Follow](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Feed5aed6c540&operation=register&redirect=https%3A%2F%2Finfosecwriteups.com%2Fcve-2023-39308-wordpress-plugin-user-feedback-1-0-7-unauthenticated-stored-xss-db992a01686a&user=Revan+A&userId=eed5aed6c540&source=post_page-eed5aed6c540--byline--db992a01686a---------------------post_header-----------)

Published in[InfoSec Write-ups](https://infosecwriteups.com/?source=post_page---byline--db992a01686a--------------------------------)·4 min read·Sep 6, 2023

--

Listen

Share

![]()

CVE-2023–39308: Wordpress Plugin User Feedback <= 1.0.7 — Unauthenticated Stored XSS

# Summary

Submit Feedback feature doesn’t filter submitted Text. So, Attacker can submit malicious script. For example, the malicious script can be use to steal cookie or other information with Cross Site Scripting (XSS) Attack.

# About Plugins

![]()

User Feedback — Create Interactive Feedback Form, User Surveys, and Polls in Seconds

* Pugin Name: User Feedback — Create Interactive Feedback Form, User Surveys, and Polls in Seconds
* Affected version: <= 1.0.7
* Plugins Home Page: <https://wordpress.org/plugins/userfeedback-lite>

# Vulnerable Code

* Filename: **wp-content/plugins/userfeedback-lite/includes/db/class-userfeedback-frontend.php**
* Code:

```
public function save_survey_response(WP_REST_Request $request)
{

    if (!wp_verify_nonce($request->get_param('nonce'), "userfeedback_survey_submission-{$request['id']}")) {

        return new WP_REST_Response(null, 403);

    }

    $survey_id = $request['id'];

    $id_address = UserFeedback_Device_Detect::ip();

    $os      = UserFeedback_Device_Detect::os();

    $browser = UserFeedback_Device_Detect::browser();

    $device = UserFeedback_Device_Detect::deviceType();

    // Validate Answers
    $validation = $this->validate_response_answers($request->get_json_params()['answers'], $survey_id);

    if (!$validation['success']) {
        $status = isset($validation['status']) ? $validation['status'] : 400;
        return new WP_REST_Response(
            array(
                'success' => false,
                'errors'  => $validation['errors'],
            ),
            $status
        );
    }

    $response_id = UserFeedback_Response::create(
        array_merge(
            $request->get_json_params(),
            array(
                'survey_id'    => sanitize_text_field($survey_id),

                'user_ip'      => $id_address,

                'user_browser' => $browser,

                'user_os'      => $os,

                'user_device'  => $device,
            )
        )
    );

    do_action('userfeedback_survey_response', $survey_id, $response_id, $request->get_json_params());

    return new WP_REST_Response(
        array(
            'success'     => true,
            'response_id' => $response_id,
        )
    );

}
```

When a user or visitor submits their feedback, the code will run the function **save\_survey\_response()** and capture the submission from the visitor/user with thefunction **$request->get\_json\_params()**. After that, the code will call the **create()** function from the class **UserFeedback\_Response.** See the code below..

* Filename: **wp-content/plugins/userfeedback-lite/includes/db/class-userfeedback-db.php**
* Code:

```
public static function create( $args, $new_timestamps = true ) {
    global $wpdb;

    $instance = new static();// self::get_instance();
    $table    = $instance->get_table();

    foreach ( $args as $key => $value ) {

        if ( ! in_array( $key, $instance->get_columns() ) ) {
            unset( $args[ $key ] );
        }
    }

    $params = $args;
    if ( $new_timestamps ) {
        $params = array_merge(
            $params,
            array(
                $instance->timestamp_column => current_time( 'mysql' ),
            )
        );
    }

    $params = $instance->encode_entity_attributes( $params );

    $wpdb->insert( $table, $params );
    return $wpdb->insert_id;

}
```

If we look at the code above, the **create()** function will process the input from the visitor to the database with the **$wpdb->insert()**. However during this process, the input from the visitor is not filtered, so the visitor can send malicious code/scripts.

# PATCH

This vulnerability has been patched on version **1.0.8**, before the submitted text from users/visitor is saved to database, it will be sanitized using **sanitize\_text\_field()**

![]()

Sanitize User Input

# Attack Scenario

1. Install wordpress and run on your local server. Then install **UserFeedback <= 1.0.7 Plugin**

2. Setup New Surveys with **Long Answer** question type.

![]()

Setup new Surveys/Feedback

3. Logout from admin account.

4. Open home page and click a Post.

5. Fill the feedback form with XSS payload and click submit. We can submit survey as Visitor/Guest.

## Payload:

```
<img src=x onerror=”alert(document.cookie)” />
```
![]()

Feeback form

6. Login with admin account and check the results page -> click surveys -> individual response.

![]()

Results Page

![]()

Individual Response Button

7. Alert popup will be shown

![]()

Stored XSS

# Timeline

* 09 August, 2023: Reported to [Patchstack](https://patchstack.com/database/vulnerability/userfeedback-lite/wordpress-userfeedback-lite-plugin-1-0-7-cross-site-scripting-xss-vulnerability)
* 14 August, 2023: Vulnerability Fixed
* 04 September, 2023: Publicly Disclosed

# Support

[![]()](https://www.buymeacoffee.com/revan.ar)[Cross Site Scripting](https://medium.com/tag/cross-site-scripting?source=post_page-----db992a01686a--------------------------------)[Infosec](https://medium.com/tag/infosec?source=post_page-----db992a01686a--------------------------------)[Vulnerability Research](https://medium.com/tag/vulnerability-research?source=post_page-----db992a01686a--------------------------------)[Bug Bounty](https://medium.com/tag/bug-bounty?source=post_page-----db992a01686a--------------------------------)

--

--

[![InfoSec Write-ups](https://miro.medium.com/v2/resize:fill:96:96/1*SWJxYWGZzgmBP1D0Qg_3zQ.png)](https://infosecwriteups.com/?source=post_page---post_publication_info--db992a01686a--------------------------------)[![InfoSec Write-ups](https://miro.medium.com/v2/resize:fill:128:128/1*SWJxYWGZzgmBP1D0Qg_3zQ.png)](https://infosecwriteups.com/?source=post_page---post_publication_info--db992a01686a--------------------------------)[## Published in InfoSec Write-ups](https://infosecwriteups.com/?source=post_page---post_publication_info--db992a01686a--------------------------------)[50K Followers](/followers?source=post_page---post_publication_info--db992a01686a--------------------------------)·[Last published 13 hours ago](/hacking-cicada-on-hackthebox-an-oscp-step-by-step-journey-abd7e56ab53e?source=post_page---post_publication_info--db992a01686a--------------------------------)

A collection of write-ups from the best hackers in the world on topics ranging from bug bounties and CTFs to vulnhub machines, hardware challenges and real life encounters. Subscribe to our weekly newsletter for the coolest infosec updates: <https://weekly.infosecwriteups.com/>

[![Revan A](https://miro.medium.com/v2/resize:fill:96:96/1*zcEfSVZsF5xT4rSLv-ze4w.jpeg)](https://revan-ar.medium.com/?source=post_page---post_author_info--db992a01686a--------------------------------)[![Revan A](https://miro.medium.com/v2/resize:fill:128:128/1*zcEfSVZsF5xT4rSLv-ze4w.jpeg)](https://revan-ar.medium.com/?source=post_page---post_author_info--db992a01686a--------------------------------)[Follow](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Feed5aed6c540&operation=register&redirect=https%3A%2F%2Finfosecwriteups.com%2Fcve-2023-39308-wordpress-plugin-user-feedback-1-0-7-unauthenticated-stored-xss-db992a01686a&user=Revan+A&userId=eed5aed6c540&source=post_page-eed5aed6c540--post_author_info--db992a01686a---------------------follow_profile-----------)[## Written by Revan A](https://revan-ar.medium.com/?source=post_page---post_author_info--db992a01686a--------------------------------)[105 Followers](https://revan-ar.medium.com/followers?source=post_page---post_author_info--db992a01686a--------------------------------)·[15 Following](https://medium.com/%40revan-ar/following?source=post_page---post_author_info--db992a01686a--------------------------------)

IT Security Analyst | Red Team | Security Researcher

[Follow](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Feed5aed6c540&operation=register&redirect=https%3A%2F%2Finfosecwriteups.com%2Fcve-2023-39308-wordpress-plugin-user-feedback-1-0-7-unauthenticated-stored-xss-db992a01686a&user=Revan+A&userId=eed5aed6c540&source=post_page-eed5aed6c540--post_author_info--db992a01686a---------------------follow_profile-----------)
## No responses yet

[Help](https://help.medium.com/hc/en-us?source=post_page-----db992a01686a--------------------------------)[Status](https://medium.statuspage.io/?source=post_page-----db992a01686a--------------------------------)[About](https://medium.com/about?autoplay=1&source=post_page-----db992a01686a--------------------------------)[Careers](https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=post_page-----db992a01686a--------------------------------)[Press](pressinquiries%40medium.com?source=post_page-----db992a01686a--------------------------------)[Blog](https://blog.medium.com/?source=post_page-----db992a01686a--------------------------------)[Privacy](https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----db992a01686a--------------------------------)[Terms](https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----db992a01686a--------------------------------)[Text to speech](https://speechify.com/medium?source=post_page-----db992a01686a--------------------------------)[Teams](https://medium.com/business?source=post_page-----db992a01686a--------------------------------)

