

| [cgit logo](/) | [index](/) : [kernel/git/bpf/bpf-next.git](/pub/scm/linux/kernel/git/bpf/bpf-next.git/) | for-next master net |
| --- | --- | --- |
| BPF next kernel tree | BPF Group |

| [about](/pub/scm/linux/kernel/git/bpf/bpf-next.git/about/)[summary](/pub/scm/linux/kernel/git/bpf/bpf-next.git/)[refs](/pub/scm/linux/kernel/git/bpf/bpf-next.git/refs/?id=12aece8b01507a2d357a1861f470e83621fbb6f2)[log](/pub/scm/linux/kernel/git/bpf/bpf-next.git/log/)[tree](/pub/scm/linux/kernel/git/bpf/bpf-next.git/tree/?id=12aece8b01507a2d357a1861f470e83621fbb6f2)[commit](/pub/scm/linux/kernel/git/bpf/bpf-next.git/commit/?id=12aece8b01507a2d357a1861f470e83621fbb6f2)[diff](/pub/scm/linux/kernel/git/bpf/bpf-next.git/diff/?id=12aece8b01507a2d357a1861f470e83621fbb6f2)[stats](/pub/scm/linux/kernel/git/bpf/bpf-next.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Zheng Wang <zyytlz.wz@163.com> | 2022-10-01 01:57:25 +0800 |
| --- | --- | --- |
| committer | David S. Miller <davem@davemloft.net> | 2022-10-03 12:47:42 +0100 |
| commit | [12aece8b01507a2d357a1861f470e83621fbb6f2](/pub/scm/linux/kernel/git/bpf/bpf-next.git/commit/?id=12aece8b01507a2d357a1861f470e83621fbb6f2) ([patch](/pub/scm/linux/kernel/git/bpf/bpf-next.git/patch/?id=12aece8b01507a2d357a1861f470e83621fbb6f2)) | |
| tree | [bb9bc5292f1be8f5ea9513c2ba198c481e905968](/pub/scm/linux/kernel/git/bpf/bpf-next.git/tree/?id=12aece8b01507a2d357a1861f470e83621fbb6f2) | |
| parent | [b43f9acbb8942b05252be83ac25a81cec70cc192](/pub/scm/linux/kernel/git/bpf/bpf-next.git/commit/?id=b43f9acbb8942b05252be83ac25a81cec70cc192) ([diff](/pub/scm/linux/kernel/git/bpf/bpf-next.git/diff/?id=12aece8b01507a2d357a1861f470e83621fbb6f2&id2=b43f9acbb8942b05252be83ac25a81cec70cc192)) | |
| download | [bpf-next-12aece8b01507a2d357a1861f470e83621fbb6f2.tar.gz](/pub/scm/linux/kernel/git/bpf/bpf-next.git/snapshot/bpf-next-12aece8b01507a2d357a1861f470e83621fbb6f2.tar.gz) | |

eth: sp7021: fix use after free bug in spl2sw\_nvmem\_get\_mac\_addressThis frees "mac" and tries to display its address as part of the error
message on the next line. Swap the order.
Fixes: fd3040b9394c ("net: ethernet: Add driver for Sunplus SP7021")
Signed-off-by: Zheng Wang <zyytlz.wz@163.com>
Signed-off-by: David S. Miller <davem@davemloft.net>
[Diffstat](/pub/scm/linux/kernel/git/bpf/bpf-next.git/diff/?id=12aece8b01507a2d357a1861f470e83621fbb6f2)

| -rw-r--r-- | [drivers/net/ethernet/sunplus/spl2sw\_driver.c](/pub/scm/linux/kernel/git/bpf/bpf-next.git/diff/drivers/net/ethernet/sunplus/spl2sw_driver.c?id=12aece8b01507a2d357a1861f470e83621fbb6f2) | 2 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 1 insertions, 1 deletions

| diff --git a/drivers/net/ethernet/sunplus/spl2sw\_driver.c b/drivers/net/ethernet/sunplus/spl2sw\_driver.cindex 546206640492b3..61d1d07dc07044 100644--- a/[drivers/net/ethernet/sunplus/spl2sw\_driver.c](/pub/scm/linux/kernel/git/bpf/bpf-next.git/tree/drivers/net/ethernet/sunplus/spl2sw_driver.c?id=b43f9acbb8942b05252be83ac25a81cec70cc192)+++ b/[drivers/net/ethernet/sunplus/spl2sw\_driver.c](/pub/scm/linux/kernel/git/bpf/bpf-next.git/tree/drivers/net/ethernet/sunplus/spl2sw_driver.c?id=12aece8b01507a2d357a1861f470e83621fbb6f2)@@ -248,8 +248,8 @@ static int spl2sw\_nvmem\_get\_mac\_address(struct device \*dev, struct device\_node \*  /\* Check if mac address is valid \*/ if (!is\_valid\_ether\_addr(mac)) {- kfree(mac); dev\_info(dev, "Invalid mac address in nvmem (%pM)!\n", mac);+ kfree(mac); return -EINVAL; } |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-08 14:37:59 +0000

