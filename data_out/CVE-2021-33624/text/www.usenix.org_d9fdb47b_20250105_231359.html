

 [usenix\_logo\_notag\_white](/)

* [Sign In](/user?destination=conference/usenixsecurity21/presentation/kirzner)
* [Conferences](/conferences)

 [![](https://www.usenix.org/sites/default/files/styles/neat_conference_menu_logo/public/sec21_wordmark_stacked_ol.png?itok=ekl4YSFW)](/conference/usenixsecurity21)

* [Attend](/conference/usenixsecurity21#registration)
  + [Registration Information](/conference/usenixsecurity21/registration-information)
  + [Student Grant Application](/conference/usenixsecurity21/student-grant-application)
  + [Diversity Grant Application](/conference/usenixsecurity21/diversity-grants-application)
  + [Grants for Black Computer Science Students Application](/conference/usenixsecurity21/grant-application-black-students)
* [Program](/conference/usenixsecurity21/technical-sessions)
  + [Technical Sessions](/conference/usenixsecurity21/technical-sessions)
  + [Summer Accepted Papers](/conference/usenixsecurity21/summer-accepted-papers)
  + [Fall Accepted Papers](/conference/usenixsecurity21/fall-accepted-papers)
* [Participate](/conference/usenixsecurity21/call-for-papers)
  + [Call for Papers](/conference/usenixsecurity21/call-for-papers)
  + [Submission Policies and Instructions](/conference/usenixsecurity21/submission-policies-and-instructions)

  + [Call for Artifacts](/conference/usenixsecurity21/call-for-artifacts)
  + [Artifact Evaluation Information](/conference/usenixsecurity21/artifact-evaluation-information)

  + [Instructions for Presenters](/conference/usenixsecurity21/instructions-presenters)
  + [Hack@Sec](https://hackatevent.org/hacksec21/)
* [Sponsors](/conference/usenixsecurity21#sponsorship)
  + [Sponsor Events](/conference/usenixsecurity21/sponsor-events)

  + [Sponsor and Exhibitor Info](/conference/usenixsecurity21/sponsor-exhibitor-info)
* [About](/conference/usenixsecurity21#marquee)
  + [Symposium Organizers](/conference/usenixsecurity21#organizers)
  + [Past Symposia](https://www.usenix.org/conferences/byname/108)

  + [Conference Policies](https://www.usenix.org/policies)
  + [Code of Conduct](https://www.usenix.org/conferences/coc)
  + [Questions](/conference/usenixsecurity21#questions)

# An Analysis of Speculative Type Confusion Vulnerabilities in the Wild

Authors:

Ofek Kirzner and Adam Morrison, *Tel Aviv University*

Distinguished Paper Award Winner and First Prize winner of the 2021 Internet Defense Prize

Abstract:

Spectre v1 attacks, which exploit conditional branch misprediction, are often identified with attacks that bypass array bounds checking to leak data from a victim's memory. Generally, however, Spectre v1 attacks can exploit *any* conditional branch misprediction that makes the victim execute code incorrectly. In this paper, we investigate *speculative type confusion*, a Spectre v1 attack vector in which branch mispredictions make the victim execute with variables holding values of the wrong type and thereby leak memory content.

We observe that speculative type confusion can be inadvertently introduced by a compiler, making it extremely hard for programmers to reason about security and manually apply Spectre mitigations. We thus set out to determine the extent to which speculative type confusion affects the Linux kernel. Our analysis finds exploitable and potentially-exploitable *arbitrary* memory disclosure vulnerabilities. We also find many *latent* vulnerabilities, which could become exploitable due to innocuous system changes, such as coding style changes.

Our results suggest that Spectre mitigations which rely on statically/manually identifying "bad" code patterns need to be rethought, and more comprehensive mitigations are needed.

## [Ofek Kirzner, Tel Aviv University](/conference/usenixsecurity21/speaker-or-organizer/ofek-kirzner-tel-aviv-university)

## [Adam Morrison, Tel Aviv University](/conference/usenixsecurity21/speaker-or-organizer/adam-morrison-tel-aviv-university)

## Open Access Media

USENIX is committed to Open Access to the research presented at our events. Papers and proceedings are freely available to everyone once the event begins. Any video, audio, and/or slides that are posted after the event are also free and open to everyone. [Support USENIX](/annual-fund) and our commitment to Open Access.

BibTeX@inproceedings {263784,

author = {Ofek Kirzner and Adam Morrison},

title = {An Analysis of Speculative Type Confusion Vulnerabilities in the Wild},

booktitle = {30th USENIX Security Symposium (USENIX Security 21)},

year = {2021},

isbn = {978-1-939133-24-3},

pages = {2399--2416},

url = {https://www.usenix.org/conference/usenixsecurity21/presentation/kirzner},

publisher = {USENIX Association},

month = aug

}

[Download](/biblio/export/bibtex/263784)![PDF icon](/modules/file/icons/application-pdf.png "application/pdf") [Kirzner PDF](https://www.usenix.org/system/files/sec21-kirzner.pdf "sec21-kirzner.pdf")![PDF icon](/modules/file/icons/application-pdf.png "application/pdf") [Kirzner Paper (Prepublication) PDF](https://www.usenix.org/system/files/sec21summer_kirzner.pdf "sec21summer_kirzner.pdf")![](https://www.usenix.org/sites/all/modules/usenix/usenix_files/images/usenix-unlocked.png)[View the slides](https://www.usenix.org/system/files/sec21_slides_kirzner.pdf)
## Presentation Video

* [Attend](/conference/usenixsecurity21#registration)
  + [Registration Information](/conference/usenixsecurity21/registration-information)
  + [Student Grant Application](/conference/usenixsecurity21/student-grant-application)
  + [Diversity Grant Application](/conference/usenixsecurity21/diversity-grants-application)
  + [Grants for Black Computer Science Students Application](/conference/usenixsecurity21/grant-application-black-students)
* [Program](/conference/usenixsecurity21/technical-sessions)
  + [Technical Sessions](/conference/usenixsecurity21/technical-sessions)
  + [Summer Accepted Papers](/conference/usenixsecurity21/summer-accepted-papers)
  + [Fall Accepted Papers](/conference/usenixsecurity21/fall-accepted-papers)
* [Participate](/conference/usenixsecurity21/call-for-papers)
  + [Call for Papers](/conference/usenixsecurity21/call-for-papers)
  + [Submission Policies and Instructions](/conference/usenixsecurity21/submission-policies-and-instructions)
  + [Call for Artifacts](/conference/usenixsecurity21/call-for-artifacts)
  + [Artifact Evaluation Information](/conference/usenixsecurity21/artifact-evaluation-information)
  + [Instructions for Presenters](/conference/usenixsecurity21/instructions-presenters)
  + [Hack@Sec](https://hackatevent.org/hacksec21/)
* [Sponsors](/conference/usenixsecurity21#sponsorship)
  + [Sponsor Events](/conference/usenixsecurity21/sponsor-events)
  + [Sponsor and Exhibitor Info](/conference/usenixsecurity21/sponsor-exhibitor-info)
* [About](/conference/usenixsecurity21#marquee)
  + [Symposium Organizers](/conference/usenixsecurity21#organizers)
  + [Past Symposia](https://www.usenix.org/conferences/byname/108)
  + [Conference Policies](https://www.usenix.org/policies)
  + [Code of Conduct](https://www.usenix.org/conferences/coc)
  + [Questions](/conference/usenixsecurity21#questions)

[Twitter](http://twitter.com/usenixsecurity)[Facebook](https://www.facebook.com/USENIX-Security-Symposium-13544602263)[Youtube](http://www.youtube.com/user/USENIXAssociation)

* [Privacy Policy](/privacy-policy)
* [Contact Us](/contact)

Â© USENIX

