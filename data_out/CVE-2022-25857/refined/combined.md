=== Content from lists.debian.org_4c5cb098_20250108_122602.html ===


---

[[Date Prev](msg00000.html)][[Date Next](msg00002.html)]
[[Thread Prev](msg00000.html)][[Thread Next](msg00002.html)]
[[Date Index](maillist.html#00001)]
[[Thread Index](threads.html#00001)]

# [SECURITY] [DLA 3132-1] snakeyaml security update

---

* *To*: debian-lts-announce <debian-lts-announce@lists.debian.org>
* *Subject*: [SECURITY] [DLA 3132-1] snakeyaml security update
* *From*: Markus Koschany <apo@debian.org>
* *Date*: Mon, 03 Oct 2022 00:06:40 +0200
* *Message-id*: <[[üîé]](/msgid-search/d08f07b19ea636828f4c03dfb1483e008078cdbc.camel%40debian.org)¬†[d08f07b19ea636828f4c03dfb1483e008078cdbc.camel@debian.org](msg00001.html)>
* *Mail-followup-to*: debian-lts@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
-------------------------------------------------------------------------
Debian LTS Advisory DLA-3132-1                debian-lts@lists.debian.org
<https://www.debian.org/lts/security/>                      Markus Koschany
October 03, 2022                              <https://wiki.debian.org/LTS>
-------------------------------------------------------------------------

Package        : snakeyaml
Version        : 1.23-1+deb10u1
CVE ID         : CVE-2022-25857 CVE-2022-38749 CVE-2022-38750 CVE-2022-38751
Debian Bug     : 1019218

Several security vulnerabilities have been discovered in SnakeYaml, a YAML
parser for Java, which could facilitate a denial of service attack whenever
maliciously crafted input files are processed by SnakeYaml.

For Debian 10 buster, these problems have been fixed in version
1.23-1+deb10u1.

We recommend that you upgrade your snakeyaml packages.

For the detailed security status of snakeyaml please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/snakeyaml>

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>

```

**Attachment:
[signature.asc](pgp1J3HFhgWJF.pgp)**

*Description:* This is a digitally signed message part

---



=== Content from bitbucket.org_6f1fc0d1_20250108_122600.html ===




=== Content from github.com_a1b25e4b_20250108_122602.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsnakeyaml%2Fsnakeyaml%2Fcommit%2Ffc300780da21f4bb92c148bc90257201220cf174)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsnakeyaml%2Fsnakeyaml%2Fcommit%2Ffc300780da21f4bb92c148bc90257201220cf174)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=snakeyaml%2Fsnakeyaml)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[snakeyaml](/snakeyaml)
/
**[snakeyaml](/snakeyaml/snakeyaml)**
Public

* [Notifications](/login?return_to=%2Fsnakeyaml%2Fsnakeyaml) You must be signed in to change notification settings
* [Fork
  44](/login?return_to=%2Fsnakeyaml%2Fsnakeyaml)
* [Star
   108](/login?return_to=%2Fsnakeyaml%2Fsnakeyaml)

* [Code](/snakeyaml/snakeyaml)
* [Pull requests
  0](/snakeyaml/snakeyaml/pulls)
* [Actions](/snakeyaml/snakeyaml/actions)
* [Security](/snakeyaml/snakeyaml/security)
* [Insights](/snakeyaml/snakeyaml/pulse)

Additional navigation options

* [Code](/snakeyaml/snakeyaml)
* [Pull requests](/snakeyaml/snakeyaml/pulls)
* [Actions](/snakeyaml/snakeyaml/actions)
* [Security](/snakeyaml/snakeyaml/security)
* [Insights](/snakeyaml/snakeyaml/pulse)

## Commit

[Permalink](/snakeyaml/snakeyaml/commit/fc300780da21f4bb92c148bc90257201220cf174)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Restrict nested depth for collections to avoid DoS attacks

[Browse files](/snakeyaml/snakeyaml/tree/fc300780da21f4bb92c148bc90257201220cf174)
Browse the repository at this point in the history

* Loading branch information

[![@asomov](https://avatars.githubusercontent.com/u/1632547?s=40&v=4)](/asomov)

[asomov](/snakeyaml/snakeyaml/commits?author=asomov "View all commits by asomov")
committed
Apr 28, 2022

1 parent
[4b8d1af](/snakeyaml/snakeyaml/commit/4b8d1af4bd422a015fbb07d235f282412c863220)

commit fc30078

 Show file tree

 Hide file tree

Showing
**7 changed files**
with
**93 additions**
and
**22 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* src

  + changes

    - src/changes/changes.xml
      [changes.xml](#diff-480762ed7e0cb6175cb14bd289b7167eeac7ae35cf253725155eed73398da621)
  + main/java/org/yaml/snakeyaml

    - src/main/java/org/yaml/snakeyaml/LoaderOptions.java
      [LoaderOptions.java](#diff-4d9d990d9ecb78a90c74289252e5f5493e7096f33f1d6251938685025ca5f3ae)
    - composer

      * src/main/java/org/yaml/snakeyaml/composer/Composer.java
        [Composer.java](#diff-d645970c4981f4cbbafc90b4600944908e0fe069f06e07cbc151d786e1077e07)
  + test/java/org/yaml/snakeyaml/issues

    - issue377

      * src/test/java/org/yaml/snakeyaml/issues/issue377/ReferencesTest.java
        [ReferencesTest.java](#diff-a44a39e797dd560e8272ecb3c617f2caabcf731ec5e4ef5a4297e5d8f0a886d2)
    - issue525

      * src/test/java/org/yaml/snakeyaml/issues/issue525/FuzzyStackOverflowTest.java
        [FuzzyStackOverflowTest.java](#diff-9255d72e092b9b7a6cfc0dec57d2205129caf9505436f85af92aaf15905a4ed2)
    - issue526

      * src/test/java/org/yaml/snakeyaml/issues/issue526/Fuzzy47027Test.java
        [Fuzzy47027Test.java](#diff-7c69dfeee1858ad8e2b1f52222312df41137657ab41d8a5999a9be71db1a8e60)
    - issue527

      * src/test/java/org/yaml/snakeyaml/issues/issue527/Fuzzy47047Test.java
        [Fuzzy47047Test.java](#diff-83ca651453ae071cd47c8dc0037f8cfa5c8e310eae9f3c139731ba3a61aa8cc1)

## There are no files selected for viewing

3 changes: 3 additions & 0 deletions

3
[src/changes/changes.xml](#diff-480762ed7e0cb6175cb14bd289b7167eeac7ae35cf253725155eed73398da621 "src/changes/changes.xml")

Show comments

[View file](/snakeyaml/snakeyaml/blob/fc300780da21f4bb92c148bc90257201220cf174/src/changes/changes.xml)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -6,6 +6,9 @@ |
|  |  | </properties> |
|  |  | <body> |
|  |  | <release version="1.31" date="in Git" description="Maintenance"> |
|  |  | <action dev="asomov" type="fix" issue="525"> |
|  |  | Restrict nested depth for collections to avoid DoS attacks (detected by OSS-Fuzz) |
|  |  | </action> |
|  |  | <action dev="asomov" type="add" issue="525"> |
|  |  | Add test for stackoverflow |
|  |  | </action> |
| Expand Down | |  |

20 changes: 18 additions & 2 deletions

20
[src/main/java/org/yaml/snakeyaml/LoaderOptions.java](#diff-4d9d990d9ecb78a90c74289252e5f5493e7096f33f1d6251938685025ca5f3ae "src/main/java/org/yaml/snakeyaml/LoaderOptions.java")

Show comments

[View file](/snakeyaml/snakeyaml/blob/fc300780da21f4bb92c148bc90257201220cf174/src/main/java/org/yaml/snakeyaml/LoaderOptions.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -23,6 +23,7 @@ public class LoaderOptions { |
|  |  | private boolean allowRecursiveKeys = false; |
|  |  | private boolean processComments = false; |
|  |  | private boolean enumCaseSensitive = true; |
|  |  | private int nestingDepthLimit = 50; |
|  |  |  |
|  |  | public boolean isAllowDuplicateKeys() { |
|  |  | return allowDuplicateKeys; |
| Expand Down  Expand Up | | @@ -67,15 +68,16 @@ public int getMaxAliasesForCollections() { |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Restrict the amount of aliases for collections (sequences and mappings) to avoid https://en.wikipedia.org/wiki/Billion\_laughs\_attack |
|  |  | \* Restrict the amount of aliases for collections (sequences and mappings) |
|  |  | \* to avoid https://en.wikipedia.org/wiki/Billion\_laughs\_attack |
|  |  | \* @param maxAliasesForCollections set max allowed value (50 by default) |
|  |  | \*/ |
|  |  | public void setMaxAliasesForCollections(int maxAliasesForCollections) { |
|  |  | this.maxAliasesForCollections = maxAliasesForCollections; |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Allow recursive keys for mappings. By default it is not allowed. |
|  |  | \* Allow recursive keys for mappings. By default, it is not allowed. |
|  |  | \* This setting only prevents the case when the key is the value. If the key is only a part of the value |
|  |  | \* (the value is a sequence or a mapping) then this case is not recognized and always allowed. |
|  |  | \* @param allowRecursiveKeys - false to disable recursive keys |
| Expand Down  Expand Up | | @@ -114,4 +116,18 @@ public boolean isEnumCaseSensitive() { |
|  |  | public void setEnumCaseSensitive(boolean enumCaseSensitive) { |
|  |  | this.enumCaseSensitive = enumCaseSensitive; |
|  |  | } |
|  |  |  |
|  |  | public int getNestingDepthLimit() { |
|  |  | return nestingDepthLimit; |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Set max depth of nested collections. When the limit is exceeded an exception is thrown. |
|  |  | \* Aliases/Anchors are not counted. |
|  |  | \* This is to prevent a DoS attack |
|  |  | \* @param nestingDepthLimit - depth to be accepted (50 by default) |
|  |  | \*/ |
|  |  | public void setNestingDepthLimit(int nestingDepthLimit) { |
|  |  | this.nestingDepthLimit = nestingDepthLimit; |
|  |  | } |
|  |  | } |

28 changes: 27 additions & 1 deletion

28
[src/main/java/org/yaml/snakeyaml/composer/Composer.java](#diff-d645970c4981f4cbbafc90b4600944908e0fe069f06e07cbc151d786e1077e07 "src/main/java/org/yaml/snakeyaml/composer/Composer.java")

Show comments

[View file](/snakeyaml/snakeyaml/blob/fc300780da21f4bb92c148bc90257201220cf174/src/main/java/org/yaml/snakeyaml/composer/Composer.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -36,7 +36,6 @@ |
|  |  | import org.yaml.snakeyaml.events.NodeEvent; |
|  |  | import org.yaml.snakeyaml.events.ScalarEvent; |
|  |  | import org.yaml.snakeyaml.events.SequenceStartEvent; |
|  |  | import org.yaml.snakeyaml.nodes.AnchorNode; |
|  |  | import org.yaml.snakeyaml.nodes.MappingNode; |
|  |  | import org.yaml.snakeyaml.nodes.Node; |
|  |  | import org.yaml.snakeyaml.nodes.NodeId; |
| Expand All | | @@ -63,6 +62,9 @@ public class Composer { |
|  |  | private final LoaderOptions loadingConfig; |
|  |  | private final CommentEventsCollector blockCommentsCollector; |
|  |  | private final CommentEventsCollector inlineCommentsCollector; |
|  |  | // keep the nesting of collections inside other collections |
|  |  | private int nestingDepth = 0; |
|  |  | private final int nestingDepthLimit; |
|  |  |  |
|  |  | public Composer(Parser parser, Resolver resolver) { |
|  |  | this(parser, resolver, new LoaderOptions()); |
| Expand All | | @@ -78,6 +80,7 @@ public Composer(Parser parser, Resolver resolver, LoaderOptions loadingConfig) { |
|  |  | CommentType.BLANK\_LINE, CommentType.BLOCK); |
|  |  | this.inlineCommentsCollector = new CommentEventsCollector(parser, |
|  |  | CommentType.IN\_LINE); |
|  |  | nestingDepthLimit = loadingConfig.getNestingDepthLimit(); |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
| Expand Down  Expand Up | | @@ -182,6 +185,7 @@ private Node composeNode(Node parent) { |
|  |  | } else { |
|  |  | NodeEvent event = (NodeEvent) parser.peekEvent(); |
|  |  | String anchor = event.getAnchor(); |
|  |  | increaseNestingDepth(); |
|  |  | // the check for duplicate anchors has been removed (issue 174) |
|  |  | if (parser.checkEvent(Event.ID.Scalar)) { |
|  |  | node = composeScalarNode(anchor, blockCommentsCollector.consume()); |
| Expand All | | @@ -190,6 +194,7 @@ private Node composeNode(Node parent) { |
|  |  | } else { |
|  |  | node = composeMappingNode(anchor); |
|  |  | } |
|  |  | decreaseNestingDepth(); |
|  |  | } |
|  |  | recursiveNodes.remove(parent); |
|  |  | return node; |
| Expand Down  Expand Up | | @@ -316,4 +321,25 @@ protected Node composeKeyNode(MappingNode node) { |
|  |  | protected Node composeValueNode(MappingNode node) { |
|  |  | return composeNode(node); |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Increase nesting depth and fail when it exceeds the denied limit |
|  |  | \*/ |
|  |  | private void increaseNestingDepth() { |
|  |  | if (nestingDepth > nestingDepthLimit) { |
|  |  | throw new YAMLException("Nesting Depth exceeded max " + nestingDepthLimit); |
|  |  | } |
|  |  | nestingDepth++; |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Indicate that the collection is finished and the nesting is decreased |
|  |  | \*/ |
|  |  | private void decreaseNestingDepth() { |
|  |  | if (nestingDepth > 0) { |
|  |  | nestingDepth--; |
|  |  | } else { |
|  |  | throw new YAMLException("Nesting Depth cannot be negative"); |
|  |  | } |
|  |  | } |
|  |  | } |

10 changes: 6 additions & 4 deletions

10
[src/test/java/org/yaml/snakeyaml/issues/issue377/ReferencesTest.java](#diff-a44a39e797dd560e8272ecb3c617f2caabcf731ec5e4ef5a4297e5d8f0a886d2 "src/test/java/org/yaml/snakeyaml/issues/issue377/ReferencesTest.java")

Show comments

[View file](/snakeyaml/snakeyaml/blob/fc300780da21f4bb92c148bc90257201220cf174/src/test/java/org/yaml/snakeyaml/issues/issue377/ReferencesTest.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -118,20 +118,22 @@ public void parseManyAliasesForCollections() { |
|  |  | } |
|  |  |  |
|  |  | @Test |
|  |  | public void referencesWithRestrictedAliases() { |
|  |  | public void referencesWithRestrictedNesting() { |
|  |  | // without alias restriction this size should occupy tons of CPU, memory and time to parse |
|  |  | String bigYAML = createDump(35); |
|  |  | int depth = 35; |
|  |  | String bigYAML = createDump(depth); |
|  |  | // Load |
|  |  | long time1 = System.currentTimeMillis(); |
|  |  | LoaderOptions settings = new LoaderOptions(); |
|  |  | settings.setMaxAliasesForCollections(40); |
|  |  | settings.setMaxAliasesForCollections(1000); |
|  |  | settings.setAllowRecursiveKeys(true); |
|  |  | settings.setNestingDepthLimit(depth); |
|  |  | Yaml yaml = new Yaml(settings); |
|  |  | try { |
|  |  | yaml.load(bigYAML); |
|  |  | fail(); |
|  |  | } catch (Exception e) { |
|  |  | assertEquals("Number of aliases for non-scalar nodes exceeds the specified max=40", e.getMessage()); |
|  |  | assertEquals("Nesting Depth exceeded max 35", e.getMessage()); |
|  |  | } |
|  |  | long time2 = System.currentTimeMillis(); |
|  |  | float duration = (time2 - time1) / 1000; |
| Expand Down | |  |

21 changes: 17 additions & 4 deletions

21
[src/test/java/org/yaml/snakeyaml/issues/issue525/FuzzyStackOverflowTest.java](#diff-9255d72e092b9b7a6cfc0dec57d2205129caf9505436f85af92aaf15905a4ed2 "src/test/java/org/yaml/snakeyaml/issues/issue525/FuzzyStackOverflowTest.java")

Show comments

[View file](/snakeyaml/snakeyaml/blob/fc300780da21f4bb92c148bc90257201220cf174/src/test/java/org/yaml/snakeyaml/issues/issue525/FuzzyStackOverflowTest.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -15,16 +15,17 @@ |
|  |  | \*/ |
|  |  | package org.yaml.snakeyaml.issues.issue525; |
|  |  |  |
|  |  | import static org.junit.Assert.assertEquals; |
|  |  | import static org.junit.Assert.assertTrue; |
|  |  | import static org.junit.Assert.fail; |
|  |  |  |
|  |  | import org.junit.Test; |
|  |  | import org.yaml.snakeyaml.LoaderOptions; |
|  |  | import org.yaml.snakeyaml.Util; |
|  |  | import org.yaml.snakeyaml.Yaml; |
|  |  | import org.yaml.snakeyaml.error.YAMLException; |
|  |  |  |
|  |  | public class FuzzyStackOverflowTest { |
|  |  |  |
|  |  | @Test |
|  |  | public void parseOpenUnmatchedMappings() { |
|  |  | try { |
| Expand All | | @@ -33,9 +34,21 @@ public void parseOpenUnmatchedMappings() { |
|  |  | yaml.load(strYaml); |
|  |  | fail("Should report invalid YAML"); |
|  |  | } catch (YAMLException e) { |
|  |  | assertTrue(false); |
|  |  | } catch (Error e) { |
|  |  | //TODO FIXME stackoverflow |
|  |  | assertEquals("Nesting Depth exceeded max 50", e.getMessage()); |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | @Test |
|  |  | public void parseOpenUnmatchedMappingsWithCustomLimit() { |
|  |  | try { |
|  |  | LoaderOptions options = new LoaderOptions(); |
|  |  | options.setNestingDepthLimit(1000); |
|  |  | Yaml yaml = new Yaml(options); |
|  |  | String strYaml = Util.getLocalResource("fuzzer/YamlFuzzer-4626423186325504"); |
|  |  | yaml.load(strYaml); |
|  |  | fail("Should report invalid YAML"); |
|  |  | } catch (YAMLException e) { |
|  |  | assertEquals("Nesting Depth exceeded max 1000", e.getMessage()); |
|  |  | } |
|  |  | } |
|  |  | } |

21 changes: 17 additions & 4 deletions

21
[src/test/java/org/yaml/snakeyaml/issues/issue526/Fuzzy47027Test.java](#diff-7c69dfeee1858ad8e2b1f52222312df41137657ab41d8a5999a9be71db1a8e60 "src/test/java/org/yaml/snakeyaml/issues/issue526/Fuzzy47027Test.java")

Show comments

[View file](/snakeyaml/snakeyaml/blob/fc300780da21f4bb92c148bc90257201220cf174/src/test/java/org/yaml/snakeyaml/issues/issue526/Fuzzy47027Test.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -15,10 +15,11 @@ |
|  |  | \*/ |
|  |  | package org.yaml.snakeyaml.issues.issue526; |
|  |  |  |
|  |  | import static org.junit.Assert.assertTrue; |
|  |  | import static org.junit.Assert.assertEquals; |
|  |  | import static org.junit.Assert.fail; |
|  |  |  |
|  |  | import org.junit.Test; |
|  |  | import org.yaml.snakeyaml.LoaderOptions; |
|  |  | import org.yaml.snakeyaml.Util; |
|  |  | import org.yaml.snakeyaml.Yaml; |
|  |  | import org.yaml.snakeyaml.error.YAMLException; |
| Expand All | | @@ -34,9 +35,21 @@ public void parseOpenUnmatchedSequences\_47027() { |
|  |  | yaml.load(strYaml); |
|  |  | fail("Should report invalid YAML"); |
|  |  | } catch (YAMLException e) { |
|  |  | assertTrue(false); |
|  |  | } catch (Error e) { |
|  |  | //TODO FIXME stackoverflow |
|  |  | assertEquals("Nesting Depth exceeded max 50", e.getMessage()); |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | @Test |
|  |  | public void setCustomLimit100() { |
|  |  | try { |
|  |  | LoaderOptions options = new LoaderOptions(); |
|  |  | options.setNestingDepthLimit(100); |
|  |  | Yaml yaml = new Yaml(options); |
|  |  | String strYaml = Util.getLocalResource("fuzzer/YamlFuzzer-5427149240139776"); |
|  |  | yaml.load(strYaml); |
|  |  | fail("Should report invalid YAML"); |
|  |  | } catch (YAMLException e) { |
|  |  | assertEquals("Nesting Depth exceeded max 100", e.getMessage()); |
|  |  | } |
|  |  | } |
|  |  | } |

12 changes: 5 additions & 7 deletions

12
[src/test/java/org/yaml/snakeyaml/issues/issue527/Fuzzy47047Test.java](#diff-83ca651453ae071cd47c8dc0037f8cfa5c8e310eae9f3c139731ba3a61aa8cc1 "src/test/java/org/yaml/snakeyaml/issues/issue527/Fuzzy47047Test.java")

Show comments

[View file](/snakeyaml/snakeyaml/blob/fc300780da21f4bb92c148bc90257201220cf174/src/test/java/org/yaml/snakeyaml/issues/issue527/Fuzzy47047Test.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -15,7 +15,7 @@ |
|  |  | \*/ |
|  |  | package org.yaml.snakeyaml.issues.issue527; |
|  |  |  |
|  |  | import static org.junit.Assert.assertTrue; |
|  |  | import static org.junit.Assert.assertEquals; |
|  |  | import static org.junit.Assert.fail; |
|  |  |  |
|  |  | import org.junit.Test; |
| Expand All | | @@ -27,16 +27,14 @@ |
|  |  | public class Fuzzy47047Test { |
|  |  |  |
|  |  | @Test |
|  |  | public void parseOpenUnmatchedSequences\_47047() { |
|  |  | public void parseKeyIndicators\_47047() { |
|  |  | try { |
|  |  | Yaml yaml = new Yaml(); |
|  |  | String strYaml = Util.getLocalResource("fuzzer/YamlFuzzer-5868638424399872"); |
|  |  | yaml.load(strYaml); |
|  |  | fail("Should report invalid YAML"); |
|  |  | //yaml.load(strYaml); |
|  |  | //TODO FIXME fail("Should report invalid YAML"); |
|  |  | } catch (YAMLException e) { |
|  |  | assertTrue(false); |
|  |  | } catch (Error e) { |
|  |  | //TODO FIXME it runs for 35 seconds !!! |
|  |  | assertEquals("Nesting Depth exceeded max 25", e.getMessage()); |
|  |  | } |
|  |  | } |
|  |  | } |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `fc30078`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsnakeyaml%2Fsnakeyaml%2Fcommit%2Ffc300780da21f4bb92c148bc90257201220cf174) to comment.

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.



=== Content from security.netapp.com_d106abf4_20250108_122602.html ===

[Skip to main content](#n-main-content)

* [NetApp.com](https://www.netapp.com/)
* [Support](https://mysupport.netapp.com)
* [Community](https://community.netapp.com)
* [Training](https://www.netapp.com/support-and-training/netapp-learning-services/)

* [Contact Us](https://www.netapp.com/company/contact-us/)

English
√¶¬ó¬•√¶¬ú¬¨√®¬™¬û

[netapp-mark

NetApp

## Product Security](https://security.netapp.com)

Search

Search

* Search

Search

Search

* [Home](https://security.netapp.com/en)
* [Advisories](https://security.netapp.com/advisory/)
* [Bulletins](https://security.netapp.com/bulletins/)
* [Contact](https://security.netapp.com/contact/)
* [Policy](https://security.netapp.com/policy/)
* [Resources](https://security.netapp.com/resources/)
* [Certifications](https://security.netapp.com/certs/)

* [Home](https://security.netapp.com/en)
* [Advisory](https://security.netapp.com/advisory)
* [SnakeYAML 1.31 Vulnerabilities in NetApp Products](https://security.netapp.com/advisory/ntap-20240315-0010)

## SnakeYAML 1.31 Vulnerabilities in NetApp Products

circle-info

NetApp will continue to update this advisory as additional information becomes available.

This advisory should be considered the single source of current, up-to-date, authorized and accurate information from NetApp regarding Full Support products and versions.

close √ó

#### Subscribe to NTAP-20240315-0010 updates

Email

Yes, please send me emails when NetApp Security Advisories are posted or updated.

 By filling and submitting this form, I understand and agree with the [NetApp privacy policy](https://www.netapp.com/company/legal/privacy-policy/ "Privacy Policy") and understand that I can unsubscribe from NetApp Security Advisory communications at any time.

Subscribe

#### Subscribe to NTAP-20240315-0010 advisory updates

OTP

Confirm

ionicons-v5-e

Confirmed your subscription to advisory alerts

close √ó

#### Unsubscribe from NTAP-20240315-0010 advisory updates

Email

Unsubscribe

#### Unsubscribe from NTAP-20240315-0010 advisory updates

Email

Confirm

ionicons-v5-e

Unsubscribed successfully from advisory alerts

Subscribe to receive email updates

**Advisory ID:** NTAP-20240315-0010
**Version:**
7.0

**Last updated:**
06/03/2024

**Status:**
Interim.

**CVEs:** CVE-2022-38749, CVE-2022-38751, CVE-2022-38750, CVE-2022-25857

Overview
#### Summary

Multiple NetApp products incorporate SnakeYAML. SnakeYAML versions prior to 1.31 are susceptible to vulnerabilities which when successfully exploited could lead to Denial of Service (DoS).

#### Impact

Successful exploitation of these vulnerabilities could lead to Denial of Service (DoS).

#### Vulnerability Scoring Details

| **CVE** | **Score** | **Vector** |
| --- | --- | --- |
| [CVE-2022-25857](https://nvd.nist.gov/vuln/detail/CVE-2022-25857) | 7.5 (HIGH) | CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H |
| [CVE-2022-38749](https://nvd.nist.gov/vuln/detail/CVE-2022-38749) | 6.5 (MEDIUM) | CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H |
| [CVE-2022-38750](https://nvd.nist.gov/vuln/detail/CVE-2022-38750) | 5.5 (MEDIUM) | CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:N/I:N/A:H |
| [CVE-2022-38751](https://nvd.nist.gov/vuln/detail/CVE-2022-38751) | 6.5 (MEDIUM) | CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H |

#### Exploitation and Public Announcements

NetApp is aware of public discussion of this vulnerability.

#### References

* <https://www.ibm.com/support/pages/security-bulletin-multiple-vulnerabilities-open-source-libraries-affect-ibm%C2%AE-db2%C2%AE-federated-0>

Affected Products
#### Affected Products

* NetApp BlueXP

#### Products Under Investigation

* NetApp HCI Compute Node (Bootstrap OS)
* NetApp SolidFire & HCI Management Node
* NetApp SolidFire & HCI Storage Node (Element Software)
* ONTAP tools for VMware vSphere 10

#### Products Not Affected

* AFF BIOS - A700s
* AFF Baseboard Management Controller (BMC) - A700s
* ATTO FibreBridge - 7500N
* ATTO FibreBridge - 7600N
* Active IQ Unified Manager for Linux
* Active IQ Unified Manager for Microsoft Windows
* Active IQ Unified Manager for VMware vSphere
* Active IQ mobile app
* Astra Control Center
* Astra Control Center - NetApp Kubernetes Monitoring Operator
* Astra Control Provisioner
* Astra Trident
* Astra Trident Autosupport
* BlueXP Classification
* Brocade Fabric Operating System Firmware
* Brocade SAN Navigator (SANnav)
* Cloud Insights Acquisition Unit
* Cloud Insights Storage Workload Security Agent
* Cloud Insights Telegraf Agent
* Cloud Volumes ONTAP Mediator
* E-Series BIOS
* E-Series SANtricity OS Controller Software 11.x
* E-Series SANtricity Unified Manager and Web Services Proxy
* Element .NET SDK
* Element HealthTools
* Element JAVA SDK
* Element Plug-in for vCenter Server
* Element Powershell Tools
* Element Python SDK
* FAS/AFF BIOS - 2820
* FAS/AFF BIOS - 8300/8700/A400/C400
* FAS/AFF BIOS - A250/500f/C250
* FAS/AFF BIOS - A300/8200/A200/2650/2620/C190/A220/2720/2750/A150
* FAS/AFF BIOS - A320
* FAS/AFF BIOS - A700/9000
* FAS/AFF BIOS - A800/C800
* FAS/AFF BIOS - A900/9500
* FAS/AFF Baseboard Management Controller (BMC) - 8300/8700/A400/C400
* FAS/AFF Baseboard Management Controller (BMC) - A250/500f/C250
* FAS/AFF Baseboard Management Controller (BMC) - A320
* FAS/AFF Baseboard Management Controller (BMC) - A800/C800
* FAS/AFF Baseboard Management Controller (BMC) - A900/9500
* FAS/AFF Baseboard Management Controller (BMC) - C190/A150/A220/FAS2720/FAS2750
* FAS/AFF Baseboard Management Controller (BMC) - FAS2820
* FAS/AFF Service Processor - A300/8200/A200/2650/2620
* FAS/AFF Service Processor - A700/9000
* Global File Cache
* Host Utilities - SAN for Linux
* Host Utilities - SAN for Windows
* IOM12 SAS Disk Shelf Firmware
* IOM12B SAS Disk Shelf Firmware
* IOM12E SAS Disk Shelf Firmware
* IOM12F SAS Disk Shelf Firmware
* IOM12G SAS Disk Shelf Firmware
* IOM6 SAS Disk Shelf Firmware
* IOM6E SAS Disk Shelf Firmware
* Management Services for Element Software and NetApp HCI
* MetroCluster DataCollector
* MetroCluster Tiebreaker for clustered Data ONTAP
* Multipath I/O (SANtricity DSM for Windows MPIO)
* NetApp Converged Systems Advisor Agent
* NetApp E-Series Host Collection
* NetApp E-Series SANtricity Collection
* NetApp HCI Baseboard Management Controller (BMC) - H300S/H500S/H700S/H410S
* NetApp HCI Baseboard Management Controller (BMC) - H410C
* NetApp HCI Baseboard Management Controller (BMC) - H610C
* NetApp HCI Baseboard Management Controller (BMC) - H610S
* NetApp HCI Baseboard Management Controller (BMC) - H615C
* NetApp HCI Compute Node BIOS
* NetApp HCI Storage Node BIOS
* NetApp Kubernetes Monitoring Operator
* NetApp Manageability SDK
* NetApp NFS Plug-in for VMware VAAI
* NetApp ONTAP PowerShell Toolkit (PSTK)
* NetApp SolidFire Plug-in for vRealize Orchestrator (SolidFire vRO)
* NetApp XCP NFS
* NetApp XCP SMB
* ONTAP 9 (formerly Clustered Data ONTAP)
* ONTAP Antivirus Connector
* ONTAP Mediator
* ONTAP Select Deploy administration utility
* ONTAP tools for VMware vSphere 9
* OnCommand Insight
* OnCommand Workflow Automation
* RcfFileGenerator for MetroCluster IP
* SANtricity Storage Plugin for vCenter
* SRA Plugin for Linux
* SRA Plugin for Windows
* Single Mailbox Recovery
* Snap Creator Framework
* SnapCenter
* SnapCenter Plug-in for VMware vSphere/BlueXP backup and Recovery for Virtual Machine
* SnapGathers
* SnapManager for Hyper-V
* SolidFire Storage Replication Adapter
* StorageGRID (formerly StorageGRID Webscale)
* StorageGRID BIOS SG1000/SG100/SG1100/SG110
* StorageGRID BIOS SG5660/SG5612/SG5760/SG5712
* StorageGRID BIOS SG6060/SGF6024/SGF6112/SG6160
* StorageGRID Baseboard Management Controller (BMC) - SG6060/SG6160/SGF6024/SGF6112/SG100/SG110/SG1000/SG1100
* System Manager 9.x
* Terraform Provider for ONTAP

Remediation
#### Software Versions and Fixes

None.

This section will be updated as patches are released.

#### Workarounds

None at this time.

#### Obtaining Software Fixes

Software fixes will be made available through the NetApp Support website in the Software Download section.

<https://mysupport.netapp.com/site/downloads/>

Customers who do not have access to the Support website should contact Technical Support at the number below to obtain the patches.

#### Contact Information

Check <http://mysupport.netapp.com> for further
updates.

**Technical Support**

mysupport.netapp.com

1 888 4 NETAPP (1 888 463 8277) (U.S. and Canada)

+00 800 44 638277 (EMEA/Europe)

+800 800 80 800 (Asia/Pacific)

Revision History
#### Status of This Notice

**Interim.**

NetApp will continue to update this advisory as additional information becomes available.

This advisory should be considered the single source of current, up-to-date, authorized and accurate information from NetApp regarding Full Support products and versions.

This advisory is posted at the following link:

<https://security.netapp.com/advisory/NTAP-20240315-0010>
#### Revision History

| **Revision #** | **Date** | **Comments** |
| --- | --- | --- |
| 1.0 | 20240315 | Initial Public Release |
| 2.0 | 20240315 | Snap Creator Framework moved to Products Not Affected and OnCommand Insight moved to Affected Products |
| 3.0 | 20240405 | ONTAP tools for VMware vSphere 9, OnCommand Workflow Automation moved to Products Not Affected and NetApp BlueXP moved to Affected Products |
| 4.0 | 20240411 | Active IQ Unified Manager for Microsoft Windows, Active IQ Unified Manager for VMware vSphere, and Active IQ Unified Manager for Linux moved to Products Not Affected |
| 5.0 | 20240501 | After additional review OnCommand Insight moved to Products Not Affected |
| 6.0 | 20240508 | MetroCluster Tiebreaker for clustered Data ONTAP moved to Products Not Affected |
| 7.0 | 20240603 | SnapCenter Plug-in for VMware vSphere/BlueXP backup and Recovery for Virtual Machine moved to Products Not Affected |

This document is provided solely for informational purposes. All information is based upon NetApp√¢¬Ä¬ôs current knowledge and understanding of the hardware and software products tested by NetApp, and the methodology and assumptions used by NetApp. NetApp is not responsible for any errors or omissions that may be contained herein, and no warranty, representation, or other legal commitment or obligation is being provided by NetApp. √Ç¬© 2025 NetApp, Inc. All rights reserved. No portions of this document may be reproduced without prior written consent of NetApp, Inc.

 ¬©  NetApp

Have feedback for our website?
[Let us know](https://www.netapp.com/forms/site-feedback/)



=== Content from github.com_3168922a_20250108_153134.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fspring-projects%2Fspring-boot%2Fissues%2F20366%29.)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fspring-projects%2Fspring-boot%2Fissues%2F20366%29.)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fissues%2Findex&source=header-repo&source_repo=spring-projects%2Fspring-boot)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[spring-projects](/spring-projects)
/
**[spring-boot](/spring-projects/spring-boot)**
Public

* [Notifications](/login?return_to=%2Fspring-projects%2Fspring-boot) You must be signed in to change notification settings
* [Fork
  40.8k](/login?return_to=%2Fspring-projects%2Fspring-boot)
* [Star
   75.8k](/login?return_to=%2Fspring-projects%2Fspring-boot)

* [Code](/spring-projects/spring-boot)
* [Issues
  533](/spring-projects/spring-boot/issues)
* [Pull requests
  28](/spring-projects/spring-boot/pulls)
* [Actions](/spring-projects/spring-boot/actions)
* [Projects
  0](/spring-projects/spring-boot/projects)
* [Wiki](/spring-projects/spring-boot/wiki)
* [Security](/spring-projects/spring-boot/security)
* [Insights](/spring-projects/spring-boot/pulse)

Additional navigation options

* [Code](/spring-projects/spring-boot)
* [Issues](/spring-projects/spring-boot/issues)
* [Pull requests](/spring-projects/spring-boot/pulls)
* [Actions](/spring-projects/spring-boot/actions)
* [Projects](/spring-projects/spring-boot/projects)
* [Wiki](/spring-projects/spring-boot/wiki)
* [Security](/spring-projects/spring-boot/security)
* [Insights](/spring-projects/spring-boot/pulse)

# Issues: spring-projects/spring-boot

[NoClassDefFoundError org/reactivestreams/Publisher in Spring ...](/spring-projects/spring-boot/issues/43260)

#43260
by [UkonnRa](/spring-projects/spring-boot/issues?q=is%3Aissue+author%3AUkonnRa "issues opened by UkonnRa")
was closed Nov 22, 2024

Closed
[1](/spring-projects/spring-boot/issues/43260)

[Spring Boot 3.4.0 and 3.3.6 native Image fails on Netty netty...](/spring-projects/spring-boot/issues/43273)

#43273
by [rowi1de](/spring-projects/spring-boot/issues?q=is%3Aissue+author%3Arowi1de "issues opened by rowi1de")
was closed Nov 23, 2024

Closed
[6](/spring-projects/spring-boot/issues/43273)

[Labels
47](/spring-projects/spring-boot/labels) [Milestones
13](/spring-projects/spring-boot/milestones)

[Labels
47](/spring-projects/spring-boot/labels) [Milestones
13](/spring-projects/spring-boot/milestones)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fspring-projects%2Fspring-boot%2Fissues%2Fnew%2Fchoose)

By clicking ‚ÄúSign up for GitHub‚Äù, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We‚Äôll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fspring-projects%2Fspring-boot%2Fissues%2Fnew%2Fchoose)
to your account

[Clear current search query, filters, and sorts](/spring-projects/spring-boot/issues?q=is%3Aissue+is%3Aopen)
[0 Open](/spring-projects/spring-boot/issues?q=is%3Aissue+author%3A20366%29.+is%3Aopen)
[0 Closed](/spring-projects/spring-boot/issues?q=is%3Aissue+author%3A20366%29.+is%3Aclosed)

[0 Open](/spring-projects/spring-boot/issues?q=is%3Aissue+author%3A20366%29.+is%3Aopen)
[0 Closed](/spring-projects/spring-boot/issues?q=is%3Aissue+author%3A20366%29.+is%3Aclosed)

Author

Filter by author

 Loading

author:
Filter by this user

Label

Filter by label

 Loading

Use `alt` + `click/return` to exclude labels

or `‚áß` + `click/return` for logical OR

 Projects

Filter by project

 Loading

 Milestones

Filter by milestone

 Loading

Assignee

Filter by who‚Äôs assigned

[**Assigned to nobody**](/spring-projects/spring-boot/issues?q=is%3Aopen+is%3Aissue+author%3A20366%29.+no%3Aassignee)

 Loading

assignee:
Filter by this user

Sort

Sort by

[Newest](/spring-projects/spring-boot/issues?q=is%3Aopen+is%3Aissue+author%3A20366%29.)
[Oldest](/spring-projects/spring-boot/issues?q=is%3Aopen+is%3Aissue+author%3A20366%29.+sort%3Acreated-asc)
[Most commented](/spring-projects/spring-boot/issues?q=is%3Aopen+is%3Aissue+author%3A20366%29.+sort%3Acomments-desc)
[Least commented](/spring-projects/spring-boot/issues?q=is%3Aopen+is%3Aissue+author%3A20366%29.+sort%3Acomments-asc)
[Recently updated](/spring-projects/spring-boot/issues?q=is%3Aopen+is%3Aissue+author%3A20366%29.+sort%3Aupdated-desc)
[Least recently updated](/spring-projects/spring-boot/issues?q=is%3Aopen+is%3Aissue+author%3A20366%29.+sort%3Aupdated-asc)
[Best match](/spring-projects/spring-boot/issues?q=is%3Aopen+is%3Aissue+author%3A20366%29.+sort%3Arelevance-desc)
Most reactions
[üëç](/spring-projects/spring-boot/issues?q=is%3Aopen+is%3Aissue+author%3A20366%29.+sort%3Areactions-%2B1-desc)
[üëé](/spring-projects/spring-boot/issues?q=is%3Aopen+is%3Aissue+author%3A20366%29.+sort%3Areactions--1-desc)
[üòÑ](/spring-projects/spring-boot/issues?q=is%3Aopen+is%3Aissue+author%3A20366%29.+sort%3Areactions-smile-desc)
[üéâ](/spring-projects/spring-boot/issues?q=is%3Aopen+is%3Aissue+author%3A20366%29.+sort%3Areactions-tada-desc)
[üòï](/spring-projects/spring-boot/issues?q=is%3Aopen+is%3Aissue+author%3A20366%29.+sort%3Areactions-thinking_face-desc)
[‚ù§Ô∏è](/spring-projects/spring-boot/issues?q=is%3Aopen+is%3Aissue+author%3A20366%29.+sort%3Areactions-heart-desc)
[üöÄ](/spring-projects/spring-boot/issues?q=is%3Aopen+is%3Aissue+author%3A20366%29.+sort%3Areactions-rocket-desc)
[üëÄ](/spring-projects/spring-boot/issues?q=is%3Aopen+is%3Aissue+author%3A20366%29.+sort%3Areactions-eyes-desc)

## No results matched your search.

You could search [all of GitHub](/search) or try an [advanced search](/search/advanced).

**ProTip!**
Type `g` `p` on any issue or pull request to go back to the pull request listing page.

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.



=== Content from security.snyk.io_8d0a5a32_20250108_122603.html ===
[![Homepage](/_nuxt/header-logo.Dk_X-iWD.svg)](/)

2. [Snyk Vulnerability Database](/vuln)
3. [Maven](/vuln/maven)
4. org.yaml:snakeyaml
# Denial of Service (DoS) Affecting [org.yaml:snakeyaml](/package/maven/org.yaml%3Asnakeyaml) package, versions **[0,1.31)**

---

### Severity

 Recommended 0.0high010

CVSS assessment made by Snyk's Security Team. [Learn more](/vuln/SNYK-JAVA-ORGYAML-2806360#cvss)

### Threat Intelligence

EPSS

The probability is the direct output of the EPSS model, and conveys an overall sense of the threat of
exploitation in the wild. The percentile measures the EPSS probability relative to all known EPSS scores.
Note: This data is updated daily, relying on the latest available EPSS model version.
Check out the EPSS
[documentation](https://www.first.org/epss/articles/prob_percentile_bins)
for more details.

**0.42% (75th percentile)**
### Do your applications use this vulnerable package?

In a few clicks we can analyze your entire application and see what components are vulnerable in your application, and suggest you quick fixes.

[Test your applications](https://app.snyk.io/login?cta=sign-up&loc=banner&page=vuln-vuln)
### Snyk Learn

Learn about Denial of Service (DoS) vulnerabilities in an interactive lesson.

 [Start learning](https://learn.snyk.io/lesson/redos/)

* Snyk ID**SNYK-JAVA-ORGYAML-2806360**
* published**29 Aug 2022**
* disclosed**1 May 2022**
* credit**unknown**

[Report a new vulnerability](https://snyk.io/vulnerability-disclosure/) [Found a mistake?](https://support.snyk.io/s/contactsupport)
#### Introduced: 1 May 2022

[CVE-2022-25857 ¬†(opens in a new tab)](https://www.cve.org/CVERecord?id=CVE-2022-25857) Common Vulnerabilities and Exposures (CVE) are common identifiers for publicly known security vulnerabilities[CWE-400 ¬†(opens in a new tab)](https://cwe.mitre.org/data/definitions/400.html) Common Weakness Enumeration (CWE) is a category system for software weaknesses First added by Snyk
## How to fix?

Upgrade `org.yaml:snakeyaml` to version 1.31 or higher.

## Overview

[org.yaml:snakeyaml](https://code.google.com/p/snakeyaml/source/browse/) is a YAML 1.1 parser and emitter for Java.

Affected versions of this package are vulnerable to Denial of Service (DoS) due to missing nested depth limitation for collections.

**NOTE:** This vulnerability has also been identified as: [CVE-2022-38749](https://security.snyk.io/vuln/SNYK-JAVA-ORGYAML-6056527)

## Details

Denial of Service (DoS) describes a family of attacks, all aimed at making a system inaccessible to its intended and legitimate users.

Unlike other vulnerabilities, DoS attacks usually do not aim at breaching security. Rather, they are focused on making websites and services unavailable to genuine users resulting in downtime.

One popular Denial of Service vulnerability is DDoS (a Distributed Denial of Service), an attack that attempts to clog network pipes to the system by generating a large volume of traffic from many machines.

When it comes to open source libraries, DoS vulnerabilities allow attackers to trigger such a crash or crippling of the service by using a flaw either in the application code or from the use of open source libraries.

Two common types of DoS vulnerabilities:

* High CPU/Memory Consumption- An attacker sending crafted requests that could cause the system to take a disproportionate amount of time to process. For example, [commons-fileupload:commons-fileupload](https://security.snyk.io/vuln/SNYK-JAVA-COMMONSFILEUPLOAD-30082).
* Crash - An attacker sending crafted requests that could cause the system to crash. For Example, [npm `ws` package](https://snyk.io/vuln/npm%3Aws%3A20171108)
## References

* [Bitbucket Commit](https://bitbucket.org/snakeyaml/snakeyaml/commits/fc300780da21f4bb92c148bc90257201220cf174)
* [BitBucket Issues](https://bitbucket.org/snakeyaml/snakeyaml/issues/525)
* [GitHub Commit](https://github.com/snakeyaml/snakeyaml/commit/fc300780da21f4bb92c148bc90257201220cf174)
### CVSS Scores

version 3.1
### Snyk

7.5¬†high

* Attack Vector (AV)

  The vulnerable component is bound to the network stack and the set of possible attackers extends beyond the other options listed below, up to and including the entire Internet. Such a vulnerability is often termed ‚Äúremotely exploitable‚Äù and can be thought of as an attack being exploitable *at the protocol level* one or more network hops away (e.g., across one or more routers).

  **Network**
* Attack Complexity (AC)

  Specialized access conditions or extenuating circumstances do not exist. An attacker can expect repeatable success when attacking the vulnerable component.

  **Low**
* Privileges Required (PR)

  The attacker is unauthorized prior to attack, and therefore does not require any access to settings or files of the vulnerable system to carry out an attack.

  **None**
* User Interaction (UI)

  The vulnerable system can be exploited without interaction from any user.

  **None**

* Scope (S)

  An exploited vulnerability can only affect resources managed by the same security authority. In this case, the vulnerable component and the impacted component are either the same, or both are managed by the same security authority.

  **Unchanged**

* Confidentiality (C)

  There is no loss of confidentiality within the impacted component.

  **None**
* Integrity (I)

  There is no loss of integrity within the impacted component.

  **None**
* Availability (A)

  There is a total loss of availability, resulting in the attacker being able to fully deny access to resources in the impacted component; this loss is either sustained (while the attacker continues to deliver the attack) or persistent (the condition persists even after the attack has completed). Alternatively, the attacker has the ability to deny some availability, but the loss of availability presents a direct, serious consequence to the impacted component (e.g., the attacker cannot disrupt existing connections, but can prevent new connections; the attacker can repeatedly exploit a vulnerability that, in each instance of a successful attack, leaks a only small amount of memory, but after repeated exploitation causes a service to become completely unavailable).

  **High**
### NVD

7.5¬†high
### SUSE

6.2¬†medium
### Red Hat

7.5¬†high
### Product

* [Snyk Open Source](https://snyk.io/product/open-source-security-management/)
* [Snyk Code](https://snyk.io/product/snyk-code/)
* [Snyk Container](https://snyk.io/product/container-vulnerability-management/)
* [Snyk Infrastructure as Code](https://snyk.io/product/infrastructure-as-code-security/)
* [Snyk AppRisk](https://snyk.io/product/snyk-apprisk/)
### Resources

* [Vulnerability DB](https://security.snyk.io/)
* [Documentation](https://docs.snyk.io/)
* [Disclosed Vulnerabilities](/disclosed-vulnerabilities)
* [Blog](https://snyk.io/blog/)
* [FAQs](https://support.snyk.io/)
### Company

* [About](https://snyk.io/about)
* [Jobs](https://snyk.io/careers/)
* Contact
* [Policies](https://snyk.io/policies/terms-of-service/)
* [Do Not Sell My Personal Information](https://preferences.snyk.io/dont_sell)
### Contact Us

* Support
* [Report a new vuln](https://snyk.io/vulnerability-disclosure)
* [Events](https://snyk.io/events)
### Find us online

### Track our development

[![DevSecOps Community Podcast](data:image/svg+xml;base64...)](https://www.devseccon.com/the-secure-developer-podcast/)

¬© 2025 Snyk Limited

Registered in England and Wales. Company number: 09677925

Registered address: Highlands House, Basingstoke Road, Spencers Wood, Reading, Berkshire, RG7 1NT.



=== Content from github.com_10cb2cea_20250108_153134.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fspring-projects%2Fspring-boot%2Fissues%2F32221%29.)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fspring-projects%2Fspring-boot%2Fissues%2F32221%29.)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fissues%2Findex&source=header-repo&source_repo=spring-projects%2Fspring-boot)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[spring-projects](/spring-projects)
/
**[spring-boot](/spring-projects/spring-boot)**
Public

* [Notifications](/login?return_to=%2Fspring-projects%2Fspring-boot) You must be signed in to change notification settings
* [Fork
  40.8k](/login?return_to=%2Fspring-projects%2Fspring-boot)
* [Star
   75.8k](/login?return_to=%2Fspring-projects%2Fspring-boot)

* [Code](/spring-projects/spring-boot)
* [Issues
  533](/spring-projects/spring-boot/issues)
* [Pull requests
  28](/spring-projects/spring-boot/pulls)
* [Actions](/spring-projects/spring-boot/actions)
* [Projects
  0](/spring-projects/spring-boot/projects)
* [Wiki](/spring-projects/spring-boot/wiki)
* [Security](/spring-projects/spring-boot/security)
* [Insights](/spring-projects/spring-boot/pulse)

Additional navigation options

* [Code](/spring-projects/spring-boot)
* [Issues](/spring-projects/spring-boot/issues)
* [Pull requests](/spring-projects/spring-boot/pulls)
* [Actions](/spring-projects/spring-boot/actions)
* [Projects](/spring-projects/spring-boot/projects)
* [Wiki](/spring-projects/spring-boot/wiki)
* [Security](/spring-projects/spring-boot/security)
* [Insights](/spring-projects/spring-boot/pulse)

# Issues: spring-projects/spring-boot

[NoClassDefFoundError org/reactivestreams/Publisher in Spring ...](/spring-projects/spring-boot/issues/43260)

#43260
by [UkonnRa](/spring-projects/spring-boot/issues?q=is%3Aissue+author%3AUkonnRa "issues opened by UkonnRa")
was closed Nov 22, 2024

Closed
[1](/spring-projects/spring-boot/issues/43260)

[Spring Boot 3.4.0 and 3.3.6 native Image fails on Netty netty...](/spring-projects/spring-boot/issues/43273)

#43273
by [rowi1de](/spring-projects/spring-boot/issues?q=is%3Aissue+author%3Arowi1de "issues opened by rowi1de")
was closed Nov 23, 2024

Closed
[6](/spring-projects/spring-boot/issues/43273)

[Labels
47](/spring-projects/spring-boot/labels) [Milestones
13](/spring-projects/spring-boot/milestones)

[Labels
47](/spring-projects/spring-boot/labels) [Milestones
13](/spring-projects/spring-boot/milestones)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fspring-projects%2Fspring-boot%2Fissues%2Fnew%2Fchoose)

By clicking ‚ÄúSign up for GitHub‚Äù, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We‚Äôll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fspring-projects%2Fspring-boot%2Fissues%2Fnew%2Fchoose)
to your account

[Clear current search query, filters, and sorts](/spring-projects/spring-boot/issues?q=is%3Aissue+is%3Aopen)
[0 Open](/spring-projects/spring-boot/issues?q=is%3Aissue+author%3A32221%29.+is%3Aopen)
[0 Closed](/spring-projects/spring-boot/issues?q=is%3Aissue+author%3A32221%29.+is%3Aclosed)

[0 Open](/spring-projects/spring-boot/issues?q=is%3Aissue+author%3A32221%29.+is%3Aopen)
[0 Closed](/spring-projects/spring-boot/issues?q=is%3Aissue+author%3A32221%29.+is%3Aclosed)

Author

Filter by author

 Loading

author:
Filter by this user

Label

Filter by label

 Loading

Use `alt` + `click/return` to exclude labels

or `‚áß` + `click/return` for logical OR

 Projects

Filter by project

 Loading

 Milestones

Filter by milestone

 Loading

Assignee

Filter by who‚Äôs assigned

[**Assigned to nobody**](/spring-projects/spring-boot/issues?q=is%3Aopen+is%3Aissue+author%3A32221%29.+no%3Aassignee)

 Loading

assignee:
Filter by this user

Sort

Sort by

[Newest](/spring-projects/spring-boot/issues?q=is%3Aopen+is%3Aissue+author%3A32221%29.)
[Oldest](/spring-projects/spring-boot/issues?q=is%3Aopen+is%3Aissue+author%3A32221%29.+sort%3Acreated-asc)
[Most commented](/spring-projects/spring-boot/issues?q=is%3Aopen+is%3Aissue+author%3A32221%29.+sort%3Acomments-desc)
[Least commented](/spring-projects/spring-boot/issues?q=is%3Aopen+is%3Aissue+author%3A32221%29.+sort%3Acomments-asc)
[Recently updated](/spring-projects/spring-boot/issues?q=is%3Aopen+is%3Aissue+author%3A32221%29.+sort%3Aupdated-desc)
[Least recently updated](/spring-projects/spring-boot/issues?q=is%3Aopen+is%3Aissue+author%3A32221%29.+sort%3Aupdated-asc)
[Best match](/spring-projects/spring-boot/issues?q=is%3Aopen+is%3Aissue+author%3A32221%29.+sort%3Arelevance-desc)
Most reactions
[üëç](/spring-projects/spring-boot/issues?q=is%3Aopen+is%3Aissue+author%3A32221%29.+sort%3Areactions-%2B1-desc)
[üëé](/spring-projects/spring-boot/issues?q=is%3Aopen+is%3Aissue+author%3A32221%29.+sort%3Areactions--1-desc)
[üòÑ](/spring-projects/spring-boot/issues?q=is%3Aopen+is%3Aissue+author%3A32221%29.+sort%3Areactions-smile-desc)
[üéâ](/spring-projects/spring-boot/issues?q=is%3Aopen+is%3Aissue+author%3A32221%29.+sort%3Areactions-tada-desc)
[üòï](/spring-projects/spring-boot/issues?q=is%3Aopen+is%3Aissue+author%3A32221%29.+sort%3Areactions-thinking_face-desc)
[‚ù§Ô∏è](/spring-projects/spring-boot/issues?q=is%3Aopen+is%3Aissue+author%3A32221%29.+sort%3Areactions-heart-desc)
[üöÄ](/spring-projects/spring-boot/issues?q=is%3Aopen+is%3Aissue+author%3A32221%29.+sort%3Areactions-rocket-desc)
[üëÄ](/spring-projects/spring-boot/issues?q=is%3Aopen+is%3Aissue+author%3A32221%29.+sort%3Areactions-eyes-desc)

## No results matched your search.

You could search [all of GitHub](/search) or try an [advanced search](/search/advanced).

**ProTip!**
Type `g` `p` on any issue or pull request to go back to the pull request listing page.

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.



=== Content from bitbucket.org_7578ac28_20250108_122600.html ===


1. [![snakeyaml Avatar](https://bbc-object-storage--frontbucket.us-east-1.prod.public.atl-paas.net/d08b93e25c14/img/default_workspace_avatar/workspace_code.svg)

   snakeyaml](/snakeyaml/)
2. [snakeyaml](/snakeyaml/workspace/projects/SNAK)
3. [snakeyaml](/snakeyaml/snakeyaml)
4. [Issues](/snakeyaml/snakeyaml/issues?status=new&status=open)

# Got StackOverflowError for many open unmatched brackets

Issue #525

[resolved](/snakeyaml/snakeyaml/issues?status=resolved)

![](https://bbc-object-storage--frontbucket.us-east-1.prod.public.atl-paas.net/d08b93e25c14/img/default_avatar/user_blue.svg)

Andrey Somov
created an issue
2022-04-26

*No description provided.*

* [clusterfuzz-testcase-minimized-YamlFuzzer-4626423186325504](/snakeyaml/snakeyaml/issues/attachments/525/snakeyaml/snakeyaml/1650972242.99/525/clusterfuzz-testcase-minimized-YamlFuzzer-4626423186325504 "clusterfuzz-testcase-minimized-YamlFuzzer-4626423186325504")

## Comments (17)

1. ![](https://bbc-object-storage--frontbucket.us-east-1.prod.public.atl-paas.net/d08b93e25c14/img/default_avatar/user_blue.svg)

   Andrey Somov
   reporter
   * attached [clusterfuzz-testcase-minimized-YamlFuzzer-4626423186325504](/snakeyaml/snakeyaml/issues/attachments/525/snakeyaml/snakeyaml/1650972242.99/525/clusterfuzz-testcase-minimized-YamlFuzzer-4626423186325504)
   * [2022-04-26T11:24:03+00:00](#comment-62347553 "Link directly to this comment")
2. ![](https://bbc-object-storage--frontbucket.us-east-1.prod.public.atl-paas.net/d08b93e25c14/img/default_avatar/user_blue.svg)

   Andrey Somov
   reporter
   * changed status to
     [open](/snakeyaml/snakeyaml/issues?status=open)
   * [2022-04-28T09:33:54+00:00](#comment-62358392 "Link directly to this comment")
3. ![](https://bbc-object-storage--frontbucket.us-east-1.prod.public.atl-paas.net/d08b93e25c14/img/default_avatar/user_blue.svg)

   Andrey Somov
   reporter
   * changed status to
     [resolved](/snakeyaml/snakeyaml/issues?status=resolved)

   it will be delivered in 1.31

   * [2022-04-29T07:40:39+00:00](#comment-62363467 "Link directly to this comment")
4. ![](https://bbc-object-storage--frontbucket.us-east-1.prod.public.atl-paas.net/d08b93e25c14/img/default_avatar/user_blue.svg)

   Maximilian Tews

   Hi @Andrey Somov , this issue is related to CVE-2022-25857, right? Could you please share a little bit more information about the vulnerability such that others that use this library can assess if they are affected or not.

   I am specifically interested to the following:

   * The first thing I am wondering about is the file attached to this issue. It does not look like a yaml file to me. Could you provide a yaml file with that the issue could be reproduced?
   * What needs to be done to exploit this vulnerability? Do I need to hand over a yaml file that specifies a list within a list within a list within a list‚Ä¶ to org.yaml.snakeyaml.Yaml.load()?
   * What are the consequences if the issue occurs? Is the only consequence a StackOverflowError that is thrown? That alone does not sound like a vulnerability to me. Are there other consequences like CPU/Memory consumption? Why was a CVE requested for this issue?

   ‚Äå

   ‚Äå

   * [2022-09-05T14:40:08+00:00](#comment-64044265 "Link directly to this comment")
5. ![](https://bbc-object-storage--frontbucket.us-east-1.prod.public.atl-paas.net/d08b93e25c14/img/default_avatar/user_blue.svg)

   Andrey Somov
   reporter

   You should probably contact the `OSS-Fuzz` team. They provided the file with the message that SnakeYAML should fail quickly for such a file. It was of cause failing, but now it fails quicker, without an attempt to allocate the resources mentioned in the file.

   * [2022-09-05T15:04:03+00:00](#comment-64044385 "Link directly to this comment")
6. ![](https://bbc-object-storage--frontbucket.us-east-1.prod.public.atl-paas.net/d08b93e25c14/img/default_avatar/user_blue.svg)

   Robert Schaft

   CVE-2022-25857 ist [classified by the NIST with a CVSS 3.x base score of 7.5](https://nvd.nist.gov/vuln/detail/CVE-2022-25857). The high score is based on the assumption, that it is used to parse Network data.

   This leads to a ‚ÄúHigh Risk‚Äù warning in some dependency scanners (e.g. Sonatype Nexus IQ).

   In most spring boot applications, snakeyaml is only used indirectly by spring to parse local trusted configuration files and would. So the warning is a false positive. But this is hard to prove without checking the whole code and configuration, that yaml format is indeed not used for untrusted data.

   Nevertheless, the spring boot team has a stabiliy policy to not update the dependency to the fixed Version 1.31 to avoid breaking changes: [CVE-2022-25857 - Upgrade to SnakeYAML 1.31 ¬∑ Issue #32221 ¬∑ spring-projects/spring-boot (github.com)](https://github.com/spring-projects/spring-boot/issues/32221). This was already an [issue with Version 1.26](https://github.com/spring-projects/spring-boot/issues/20366).

   You can be proud, that your lib becomes a cornerstone of many applications in the internet. But that in turn requires some more support from you:

   I kindly ask to overthink the release strategy of snakeyaml and provide long term support releases with hotfixes. For example version 1.30 could be marked as LTS release. And releasing this fix as Version 1.30.1 would allow the spring team to include it.

   ‚Äå

   ‚Äå

   * [2022-09-06T08:30:30+00:00](#comment-64046789 "Link directly to this comment")
7. ![](https://bbc-object-storage--frontbucket.us-east-1.prod.public.atl-paas.net/d08b93e25c14/img/default_avatar/user_blue.svg)

   Andrey Somov
   reporter

   To give a binary another name or version does not have any effect on its contents.

   The fact that a Spring team will accept 1.30.1 but does not accept 1.31 is not an issue for SnakeYAML.

   There is no hotfix because **nothing was broken.**

   Please correct me where I am wrong. I am disappointed with the quality of the NIST database and its classification.

   * [2022-09-06T09:23:47+00:00](#comment-64047117 "Link directly to this comment")
8. ![](https://bbc-object-storage--frontbucket.us-east-1.prod.public.atl-paas.net/d08b93e25c14/img/default_avatar/user_blue.svg)

   Robert Schaft
   > There is no hotfix because **nothing was broken.**

   I can see some commits regarding this issue.:

   * `fc30078` - Restrict nested depth for collections to avoid DoS attacks
   * `5150df1` - Add test for issue 525
   * `bc7869b` - Make billionLaughsAttackTest.billionLaughsAttackExpanded() robust

   They seem to fix something broken/vulnerable to me. I assume, that a release, that contains only the fixes for the worst issues and is declared as thus will be accepted by the spring team.

   On the other hand, there are a few potential breaking changes in 1.31:

   * `0468784` - force keyNode to be String for JavaBeans fixes issue [#522](https://bitbucket.org/snakeyaml/snakeyaml/issues/522/deserializing-key-on-fails-with-exception)
   * `467bcc9` - expect node to be scalar when enforcings String keys
   * `f46c45e` - fix build because some test dependency are Java 8 now

   I don‚Äôt see any hotfix releases in the history of snakeyaml. Are there issues related to creating a hotfix release?

   > It was of cause failing, but now it fails quicker,

   I would like to get more details on how it failed. An out of memory exception crashing the whole JVM is different to a Runtime Exception that is thrown when processing the document reached a certain reasonable CPU/Memory threshold. And ‚Äúfail earlier‚Äù could be after one second instead of one hour CPU consumption.

   I agree with you about the NIST classification. Since it is your component, you might be able to request an update to lower the severity. Unfortunately, I lack the experience on how to do that.

   * [2022-09-06T10:13:47+00:00](#comment-64047386 "Link directly to this comment")
9. ![](https://bbc-object-storage--frontbucket.us-east-1.prod.public.atl-paas.net/d08b93e25c14/img/default_avatar/user_blue.svg)

   Andrey Somov
   reporter

   The fact that commits are present does NOT indicate that something was broken.

   The message ‚Äúmake the test robust‚Äú does NOT improve the code.

   Please check the code, not the message.

   I do not have the details about the false positive. They said it is **potentially** broken and I fixed it. The fact that SnakeYAML added the restriction for depth does NOT improve the quality because users may set it to a very high value and still fail.

   Can you please address the question to the appropriate team ?

   * [2022-09-06T10:37:45+00:00](#comment-64047492 "Link directly to this comment")
10. ![](https://bbc-object-storage--frontbucket.us-east-1.prod.public.atl-paas.net/d08b93e25c14/img/default_avatar/user_blue.svg)

    Maximilian Tews

    Hi @Andrey Somov thanks for your answers. How do I contact the ‚ÄúOSS-Fuzz‚Äù team? It is unclear to me who the ‚ÄúOSS-Fuzz‚Äù team is and how it relates to snakeyaml. Who can I answer my questions?

    * The first thing I am wondering about is the file attached to this issue. It does not look like a yaml file to me. Could you provide a yaml file with that the issue could be reproduced?
    * What needs to be done to exploit this vulnerability? Do I need to hand over a yaml file that specifies a list within a list within a list within a list‚Ä¶ to org.yaml.snakeyaml.Yaml.load()?
    * What are the consequences if the issue occurs? Is the only consequence a StackOverflowError that is thrown? That alone does not sound like a vulnerability to me. Are there other consequences like CPU/Memory consumption? Why was a CVE requested for this issue?

    ‚Äå

    * [2022-09-07T10:43:28+00:00](#comment-64052057 "Link directly to this comment")
11. ![](https://bbc-object-storage--frontbucket.us-east-1.prod.public.atl-paas.net/d08b93e25c14/img/default_avatar/user_blue.svg)

    Andrey Somov
    reporter

    ‚Äå

    1. I hope that a member of the OSS-Fuzz team can come and answer the questions.
    2. The whole point is that the input is not YAML. It is trash. But trash may confuse the parser.
    3. Most probably you are not affected at all (I do not know a single **real use case** when somebody is affected)

    If you do not blindly open a socket to read any trash from any incoming input - you are totally safe.

    * [2022-09-07T12:22:16+00:00](#comment-64052488 "Link directly to this comment")
12. ![](https://bbc-object-storage--frontbucket.us-east-1.prod.public.atl-paas.net/d08b93e25c14/img/default_avatar/user_blue.svg)

    Robert Schaft

    To my understanding, this finding here is the source of the CVE:

    [47024 - snakeyaml:YamlFuzzer: Uncaught exception in org.yaml.snakeyaml.composer.Composer.composeSequenceNode - oss-fuzz (chromium.org)](https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=47024)

    The CVE score seems to be based on the assumption, that you read any trash from incoming input, because it is marked as ‚ÄúNetwork accessible‚Äù, which is just wrong, because snakeyaml doesn‚Äôt provide or use a network interface (AFAIK). So the CVE score can use an update.

    ‚Äå

    ‚Äå

    * [2022-09-07T13:53:50+00:00](#comment-64052983 "Link directly to this comment")
13. ![](https://bbc-object-storage--frontbucket.us-east-1.prod.public.atl-paas.net/d08b93e25c14/img/default_avatar/user_blue.svg)

    Robert Schaft
    > If you do not blindly open a socket to read any trash from any incoming input - you are totally safe.

    But how should the code look like, that can decide, if a file is trash? The usual approach is, to feed it to a parser-library and check if the library yields a nice Object or throws a ThisIsTrashException.

    The best choice of library for a spring-boot based project with yaml used input would be snakeyaml. But snakeyaml throws only an OutOfMemoryException (which shouldn‚Äôt be catched) - correct me if I am wrong. So snakeyaml is not totally free of liability to handle trash in an ordered fashion.

    * [2022-09-07T14:02:33+00:00](#comment-64053021 "Link directly to this comment")
14. ![](https://bbc-object-storage--frontbucket.us-east-1.prod.public.atl-paas.net/d08b93e25c14/img/default_avatar/user_blue.svg)

    Andrey Somov
    reporter

    [https://bitbucket.org/snakeyaml/snakeyaml/wiki/CVE & NIST](https://bitbucket.org/snakeyaml/snakeyaml/wiki/CVE%20%26%20NIST)

    * [2022-09-07T15:06:12+00:00](#comment-64053299 "Link directly to this comment")
15. ![](https://bbc-object-storage--frontbucket.us-east-1.prod.public.atl-paas.net/d08b93e25c14/img/default_avatar/user_blue.svg)

    Robert Schaft

    Looks similar to [snakeyaml / snakeyaml / wiki / Billion laughs attack ‚Äî Bitbucket](https://bitbucket.org/snakeyaml/snakeyaml/wiki/Billion%20laughs%20attack). Maybe you can merge them.

    But from security perspective it is not good to document those statements somewhere in a wiki.

    A warning on the project entry page would help more. Something along:

    > snakeyaml is not intended to process untrusted content. If fed with untrusted content, it might delete your data and kill all your processes!

    After that, you can ask the OSS-Fuzz team to stop fuzzing around snakeyaml. Because fuzzing is all about generating ugly ‚Äúuntrusted‚Äù content.

    * [2022-09-07T15:16:58+00:00](#comment-64053346 "Link directly to this comment")
16. ![](https://bbc-object-storage--frontbucket.us-east-1.prod.public.atl-paas.net/d08b93e25c14/img/default_avatar/user_blue.svg)

    Andrey Somov
    reporter

    I wish SnakeYAML is able to delete all the data and kill all the processes‚Ä¶ Unfortunately, we are not there yet.

    * [2022-09-07T15:35:47+00:00](#comment-64053407 "Link directly to this comment")
17. ![](https://bbc-object-storage--frontbucket.us-east-1.prod.public.atl-paas.net/d08b93e25c14/img/default_avatar/user_blue.svg)

    Alexander Maslov

    I thought this issue has been resolved already, but conversation seems to continue.

    @Robert Schaft , IMHO you are correct (I also thought about the point of how to decide if it is a trash or not before feeding it to parser) and I don‚Äôt see a better place than the parser itself :)

    We are not denying existence of those reported issues. But we are NOT GOING to rush fixing those, sorry. It maybe unfortunate for many, but it is what it is.

    Whenever we have wiliness, time and courage to do something to remove those CVEs we do it.

    But there is no ETA.

    And, btw, any PRs are very much appreciated ;)

    * [2022-09-08T06:49:54+00:00](#comment-64055555 "Link directly to this comment")
18. [Log in to comment](/account/signin/?next=/snakeyaml/snakeyaml/issues/525)

Assignee
![](https://bbc-object-storage--frontbucket.us-east-1.prod.public.atl-paas.net/d08b93e25c14/img/default_avatar/user_blue.svg)

[Andrey Somov](/snakeyaml/snakeyaml/issues?responsible=557058:26b2b144-0865-42ea-ab97-e718812c8217)

Type
[bug](/snakeyaml/snakeyaml/issues?kind=bug)

Priority
[major](/snakeyaml/snakeyaml/issues?priority=major)

Status
[resolved](/snakeyaml/snakeyaml/issues?status=resolved)

Votes
0

Watchers
2

[![Jira: the preferred issue tracker for Bitbucket. Join the team!](https://bbc-object-storage--frontbucket.us-east-1.prod.public.atl-paas.net/d08b93e25c14/img/promos/jira-promo-issue.png)](https://www.atlassian.com/software/jira/bitbucket-integration?utm_source=bitbucket&utm_medium=in_product_ad&utm_campaign=bitbucket_issues&utm_content=issues_view)


