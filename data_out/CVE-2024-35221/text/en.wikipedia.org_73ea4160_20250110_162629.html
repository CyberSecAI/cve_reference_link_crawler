[Jump to content](#bodyContent)

Main menu

Main menu
move to sidebar
hide

Navigation

* [Main page](/wiki/Main_Page "Visit the main page [z]")
* [Contents](/wiki/Wikipedia%3AContents "Guides to browsing Wikipedia")
* [Current events](/wiki/Portal%3ACurrent_events "Articles related to current events")
* [Random article](/wiki/Special%3ARandom "Visit a randomly selected article [x]")
* [About Wikipedia](/wiki/Wikipedia%3AAbout "Learn about Wikipedia and how it works")
* [Contact us](//en.wikipedia.org/wiki/Wikipedia%3AContact_us "How to contact Wikipedia")

Contribute

* [Help](/wiki/Help%3AContents "Guidance on how to use and edit Wikipedia")
* [Learn to edit](/wiki/Help%3AIntroduction "Learn how to edit Wikipedia")
* [Community portal](/wiki/Wikipedia%3ACommunity_portal "The hub for editors")
* [Recent changes](/wiki/Special%3ARecentChanges "A list of recent changes to Wikipedia [r]")
* [Upload file](/wiki/Wikipedia%3AFile_upload_wizard "Add images or other media for use on Wikipedia")

[![](/static/images/icons/wikipedia.png)
![Wikipedia](/static/images/mobile/copyright/wikipedia-wordmark-en.svg)
![The Free Encyclopedia](/static/images/mobile/copyright/wikipedia-tagline-en.svg)](/wiki/Main_Page)

[Search](/wiki/Special%3ASearch "Search Wikipedia [f]")

Search

Appearance

* [Donate](https://donate.wikimedia.org/?wmf_source=donate&wmf_medium=sidebar&wmf_campaign=en.wikipedia.org&uselang=en)
* [Create account](/w/index.php?title=Special:CreateAccount&returnto=Billion+laughs+attack "You are encouraged to create an account and log in; however, it is not mandatory")
* [Log in](/w/index.php?title=Special:UserLogin&returnto=Billion+laughs+attack "You're encouraged to log in; however, it's not mandatory. [o]")

Personal tools

* [Donate](https://donate.wikimedia.org/?wmf_source=donate&wmf_medium=sidebar&wmf_campaign=en.wikipedia.org&uselang=en)
* [Create account](/w/index.php?title=Special:CreateAccount&returnto=Billion+laughs+attack "You are encouraged to create an account and log in; however, it is not mandatory")
* [Log in](/w/index.php?title=Special:UserLogin&returnto=Billion+laughs+attack "You're encouraged to log in; however, it's not mandatory. [o]")

Pages for logged out editors [learn more](/wiki/Help%3AIntroduction)

* [Contributions](/wiki/Special%3AMyContributions "A list of edits made from this IP address [y]")
* [Talk](/wiki/Special%3AMyTalk "Discussion about edits from this IP address [n]")

## Contents

move to sidebar
hide

* (Top)
* [1
  Details](#Details)
* [2
  Code example](#Code_example)
* [3
  Variations](#Variations)
* [4
  See also](#See_also)
* [5
  References](#References)

Toggle the table of contents

# Billion laughs attack

6 languages

* [Deutsch](https://de.wikipedia.org/wiki/Entit%C3%A4tsexpansion "Entitätsexpansion – German")
* [Español](https://es.wikipedia.org/wiki/Mil_millones_de_risas "Mil millones de risas – Spanish")
* [Esperanto](https://eo.wikipedia.org/wiki/Miliard-rida_atako "Miliard-rida atako – Esperanto")
* [Français](https://fr.wikipedia.org/wiki/XML_entity_expansion "XML entity expansion – French")
* [日本語](https://ja.wikipedia.org/wiki/Billion_laughs%E6%94%BB%E6%92%83 "Billion laughs攻撃 – Japanese")
* [Українська](https://uk.wikipedia.org/wiki/%D0%9A%D0%B2%D0%B0%D0%B4%D1%80%D0%B0%D1%82%D0%B8%D1%87%D0%BD%D0%B8%D0%B9_%D0%B2%D0%B8%D0%B1%D1%83%D1%85 "Квадратичний вибух – Ukrainian")

[Edit links](https://www.wikidata.org/wiki/Special%3AEntityPage/Q3570419#sitelinks-wikipedia "Edit interlanguage links")

* [Article](/wiki/Billion_laughs_attack "View the content page [c]")
* [Talk](/wiki/Talk%3ABillion_laughs_attack "Discuss improvements to the content page [t]")

English

* [Read](/wiki/Billion_laughs_attack)
* [Edit](/w/index.php?title=Billion_laughs_attack&action=edit "Edit this page [e]")
* [View history](/w/index.php?title=Billion_laughs_attack&action=history "Past revisions of this page [h]")

Tools

Tools
move to sidebar
hide

Actions

* [Read](/wiki/Billion_laughs_attack)
* [Edit](/w/index.php?title=Billion_laughs_attack&action=edit "Edit this page [e]")
* [View history](/w/index.php?title=Billion_laughs_attack&action=history)

General

* [What links here](/wiki/Special%3AWhatLinksHere/Billion_laughs_attack "List of all English Wikipedia pages containing links to this page [j]")
* [Related changes](/wiki/Special%3ARecentChangesLinked/Billion_laughs_attack "Recent changes in pages linked from this page [k]")
* [Upload file](/wiki/Wikipedia%3AFile_Upload_Wizard "Upload files [u]")
* [Special pages](/wiki/Special%3ASpecialPages "A list of all special pages [q]")
* [Permanent link](/w/index.php?title=Billion_laughs_attack&oldid=1244434409 "Permanent link to this revision of this page")
* [Page information](/w/index.php?title=Billion_laughs_attack&action=info "More information about this page")
* [Cite this page](/w/index.php?title=Special:CiteThisPage&page=Billion_laughs_attack&id=1244434409&wpFormIdentifier=titleform "Information on how to cite this page")
* [Get shortened URL](/w/index.php?title=Special:UrlShortener&url=https%3A%2F%2Fen.wikipedia.org%2Fwiki%2FBillion_laughs_attack)
* [Download QR code](/w/index.php?title=Special:QrCode&url=https%3A%2F%2Fen.wikipedia.org%2Fwiki%2FBillion_laughs_attack)

Print/export

* [Download as PDF](/w/index.php?title=Special:DownloadAsPdf&page=Billion_laughs_attack&action=show-download-screen "Download this page as a PDF file")
* [Printable version](/w/index.php?title=Billion_laughs_attack&printable=yes "Printable version of this page [p]")

In other projects

* [Wikidata item](https://www.wikidata.org/wiki/Special%3AEntityPage/Q3570419 "Structured data on this page hosted by Wikidata [g]")

Appearance
move to sidebar
hide

From Wikipedia, the free encyclopedia

Denial-of-service attack at XML parsers, exploiting entity expansion

In [computer security](/wiki/Computer_security "Computer security"), a **billion laughs attack** is a type of [denial-of-service (DoS) attack](/wiki/Denial-of-service_attack "Denial-of-service attack") which is aimed at [parsers](/wiki/Parser "Parser") of [XML](/wiki/XML "XML") documents.[[1]](#cite_note-harold-2005-1)

It is also referred to as an **XML bomb** or as an exponential entity expansion attack.[[2]](#cite_note-2)

## Details

[[edit](/w/index.php?title=Billion_laughs_attack&action=edit&section=1 "Edit section: Details")]

The example attack consists of defining 10 entities, each defined as consisting of 10 of the previous entity, with the document consisting of a single instance of the largest entity, which expands to one [billion](/wiki/1000000000_%28number%29 "1000000000 (number)") copies of the first entity.

In the most frequently cited example, the first entity is the [string](/wiki/String_%28computer_science%29 "String (computer science)") "[lol](/wiki/Lol "Lol")", hence the name "billion laughs". At the time this vulnerability was first reported, the [computer memory](/wiki/Computer_memory "Computer memory") used by a billion instances of the string "lol" would likely exceed that available to the process parsing the XML.

While the original form of the attack was aimed specifically at XML parsers, the term may be applicable to similar subjects as well.[[1]](#cite_note-harold-2005-1)

The problem was first reported as early as 2002,[[3]](#cite_note-3) but began to be widely addressed in 2008.[[4]](#cite_note-4)

Defenses against this kind of attack include capping the memory allocated in an individual parser if loss of the document is acceptable, or treating entities symbolically and expanding them lazily only when (and to the extent) their content is to be used.

## Code example

[[edit](/w/index.php?title=Billion_laughs_attack&action=edit&section=2 "Edit section: Code example")]
```
<?xml version="1.0"?>
<!DOCTYPE lolz [
 <!ENTITY lol "lol">
 <!ELEMENT lolz (#PCDATA)>
 <!ENTITY lol1 "&lol;&lol;&lol;&lol;&lol;&lol;&lol;&lol;&lol;&lol;">
 <!ENTITY lol2 "&lol1;&lol1;&lol1;&lol1;&lol1;&lol1;&lol1;&lol1;&lol1;&lol1;">
 <!ENTITY lol3 "&lol2;&lol2;&lol2;&lol2;&lol2;&lol2;&lol2;&lol2;&lol2;&lol2;">
 <!ENTITY lol4 "&lol3;&lol3;&lol3;&lol3;&lol3;&lol3;&lol3;&lol3;&lol3;&lol3;">
 <!ENTITY lol5 "&lol4;&lol4;&lol4;&lol4;&lol4;&lol4;&lol4;&lol4;&lol4;&lol4;">
 <!ENTITY lol6 "&lol5;&lol5;&lol5;&lol5;&lol5;&lol5;&lol5;&lol5;&lol5;&lol5;">
 <!ENTITY lol7 "&lol6;&lol6;&lol6;&lol6;&lol6;&lol6;&lol6;&lol6;&lol6;&lol6;">
 <!ENTITY lol8 "&lol7;&lol7;&lol7;&lol7;&lol7;&lol7;&lol7;&lol7;&lol7;&lol7;">
 <!ENTITY lol9 "&lol8;&lol8;&lol8;&lol8;&lol8;&lol8;&lol8;&lol8;&lol8;&lol8;">
]>
<lolz>&lol9;</lolz>

```

When an XML parser loads this document, it sees that it includes one root element, "lolz", that contains the text "&lol9;". However, "&lol9;" is a defined entity that expands to a string containing ten "&lol8;" strings. Each "&lol8;" string is a defined entity that expands to ten "&lol7;" strings, and so on. After all the entity expansions have been processed, this small (< 1 KB) block of XML will actually contain 109 = a billion "lol"s, taking up almost 3 [gigabytes](/wiki/Gigabyte "Gigabyte") of memory.[[5]](#cite_note-5)

## Variations

[[edit](/w/index.php?title=Billion_laughs_attack&action=edit&section=3 "Edit section: Variations")]

The billion laughs attack described above can take an [exponential](/wiki/Exponential_growth "Exponential growth") amount of space or time. The **quadratic blowup** variation causes [quadratic growth](/wiki/Quadratic_growth "Quadratic growth") in resource requirements by simply repeating a large entity over and over again, to avoid countermeasures that detect heavily nested entities.[[6]](#cite_note-6) (See [computational complexity theory](/wiki/Computational_complexity_theory "Computational complexity theory") for comparisons of different growth classes.)

A "billion laughs" attack could exist for any file format that can contain macro expansions, for example this [YAML](/wiki/YAML "YAML") bomb:

```
a: &a ["lol","lol","lol","lol","lol","lol","lol","lol","lol"]
b: &b [*a,*a,*a,*a,*a,*a,*a,*a,*a]
c: &c [*b,*b,*b,*b,*b,*b,*b,*b,*b]
d: &d [*c,*c,*c,*c,*c,*c,*c,*c,*c]
e: &e [*d,*d,*d,*d,*d,*d,*d,*d,*d]
f: &f [*e,*e,*e,*e,*e,*e,*e,*e,*e]
g: &g [*f,*f,*f,*f,*f,*f,*f,*f,*f]
h: &h [*g,*g,*g,*g,*g,*g,*g,*g,*g]
i: &i [*h,*h,*h,*h,*h,*h,*h,*h,*h]

```

This crashed earlier versions of [Go](/wiki/Go_%28programming_language%29 "Go (programming language)") because the Go YAML processor (contrary to the YAML spec) expands references as if they were macros. The Go YAML processor was modified to fail parsing if the result object becomes too large.

Enterprise software like [Kubernetes](/wiki/Kubernetes "Kubernetes") has been affected by this attack through its YAML parser.[[7]](#cite_note-7)[[8]](#cite_note-8) For this reason, either a parser with intentionally limited capabilities is preferred (like StrictYAML) or file formats that do not allow references are often preferred for data arriving from untrusted sources.[[9]](#cite_note-9)[*[failed verification](/wiki/Wikipedia%3AVerifiability "Wikipedia:Verifiability")*]

## See also

[[edit](/w/index.php?title=Billion_laughs_attack&action=edit&section=4 "Edit section: See also")]
[![](//upload.wikimedia.org/wikipedia/commons/thumb/9/99/Wiktionary-logo-en-v2.svg/40px-Wiktionary-logo-en-v2.svg.png)](/wiki/File%3AWiktionary-logo-en-v2.svg)
Look up ***[billion laughs](https://en.wiktionary.org/wiki/billion_laughs "wiktionary:billion laughs")*** in Wiktionary, the free dictionary.

* [Fork bomb](/wiki/Fork_bomb "Fork bomb"): a similar method to exhaust a system's resources through [recursion](/wiki/Recursion "Recursion")
* [Zip bomb](/wiki/Zip_bomb "Zip bomb"): a similar attack utilizing zip archives
* [XML external entity attack](/wiki/XML_external_entity_attack "XML external entity attack"): an XML attack to return arbitrary server files
* [Document type definition](/wiki/Document_type_definition "Document type definition"): a template for validating XML files

## References

[[edit](/w/index.php?title=Billion_laughs_attack&action=edit&section=5 "Edit section: References")]

1. ^ [***a***](#cite_ref-harold-2005_1-0) [***b***](#cite_ref-harold-2005_1-1) [Harold, Elliotte Rusty](/wiki/Elliotte_Rusty_Harold "Elliotte Rusty Harold") (27 May 2005). ["Tip: Configure SAX parsers for secure processing"](https://web.archive.org/web/20101005080451/http%3A//www.ibm.com/developerworks/xml/library/x-tipcfsx.html). *IBM developerWorks*. Archived from [the original](http://www.ibm.com/developerworks/xml/library/x-tipcfsx.html) on 5 October 2010. Retrieved 4 March 2011.
2. **[^](#cite_ref-2)** Sullivan, Bryan (November 2009). ["XML Denial of Service Attacks and Defenses"](http://msdn.microsoft.com/en-us/magazine/ee335713.aspx). *MSDN Magazine*. [Microsoft Corporation](/wiki/Microsoft_Corporation "Microsoft Corporation"). Retrieved 2011-05-31.
3. **[^](#cite_ref-3)** ["SecurityFocus"](https://web.archive.org/web/20210416172456/https%3A//www.securityfocus.com/archive/1/303509). 2002-12-16. Archived from [the original](http://www.securityfocus.com/archive/1/303509) on 2021-04-16. Retrieved 2015-07-03.
4. **[^](#cite_ref-4)** ["CVE-2003-1564"](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2003-1564). *Common Vulnerabilities and Exposures*. The MITRE Corporation. 2003-02-02. Retrieved 2011-06-01.
5. **[^](#cite_ref-5)** Bryan Sullivan. ["XML Denial of Service Attacks and Defenses"](http://msdn.microsoft.com/en-us/magazine/ee335713.aspx). Retrieved 2011-12-21.
6. **[^](#cite_ref-6)** ["19.5. XML Processing Modules — Python 2.7.18 documentation"](https://docs.python.org/2/library/xml.html#xml-vulnerabilities).
7. **[^](#cite_ref-7)** ["CVE-2019-11253: Kubernetes API Server JSON/YAML parsing vulnerable to resource exhaustion attack · Issue #83253 · kubernetes/Kubernetes"](https://github.com/kubernetes/kubernetes/issues/83253). *[GitHub](/wiki/GitHub "GitHub")*.
8. **[^](#cite_ref-8)** Wallen, Jack (9 October 2019). ["Kubernetes 'Billion Laughs' Vulnerability Is No Laughing Matter"](https://thenewstack.io/kubernetes-billion-laughs-vulnerability-is-no-laughing-matter/). *The New Stack*.
9. **[^](#cite_ref-9)** ["XML is toast, long live JSON"](https://www.cio.com/article/238300/xml-is-toast-long-live-json.html). 9 June 2016.

![](https://login.wikimedia.org/wiki/Special:CentralAutoLogin/start?useformat=desktop&type=1x1&usesul3=0)
Retrieved from "<https://en.wikipedia.org/w/index.php?title=Billion_laughs_attack&oldid=1244434409>"
[Categories](/wiki/Help%3ACategory "Help:Category"):

* [Algorithmic complexity attacks](/wiki/Category%3AAlgorithmic_complexity_attacks "Category:Algorithmic complexity attacks")
* [Denial-of-service attacks](/wiki/Category%3ADenial-of-service_attacks "Category:Denial-of-service attacks")
* [XML](/wiki/Category%3AXML "Category:XML")
Hidden categories:

* [Articles with short description](/wiki/Category%3AArticles_with_short_description "Category:Articles with short description")
* [Short description matches Wikidata](/wiki/Category%3AShort_description_matches_Wikidata "Category:Short description matches Wikidata")
* [All articles with failed verification](/wiki/Category%3AAll_articles_with_failed_verification "Category:All articles with failed verification")
* [Articles with failed verification from November 2018](/wiki/Category%3AArticles_with_failed_verification_from_November_2018 "Category:Articles with failed verification from November 2018")

* This page was last edited on 7 September 2024, at 02:43 (UTC).
* Text is available under the [Creative Commons Attribution-ShareAlike 4.0 License](/wiki/Wikipedia%3AText_of_the_Creative_Commons_Attribution-ShareAlike_4.0_International_License "Wikipedia:Text of the Creative Commons Attribution-ShareAlike 4.0 International License");
  additional terms may apply. By using this site, you agree to the [Terms of Use](https://foundation.wikimedia.org/wiki/Special%3AMyLanguage/Policy%3ATerms_of_Use "foundation:Special:MyLanguage/Policy:Terms of Use") and [Privacy Policy](https://foundation.wikimedia.org/wiki/Special%3AMyLanguage/Policy%3APrivacy_policy "foundation:Special:MyLanguage/Policy:Privacy policy"). Wikipedia® is a registered trademark of the [Wikimedia Foundation, Inc.](https://wikimediafoundation.org/), a non-profit organization.

* [Privacy policy](https://foundation.wikimedia.org/wiki/Special%3AMyLanguage/Policy%3APrivacy_policy)
* [About Wikipedia](/wiki/Wikipedia%3AAbout)
* [Disclaimers](/wiki/Wikipedia%3AGeneral_disclaimer)
* [Contact Wikipedia](//en.wikipedia.org/wiki/Wikipedia%3AContact_us)
* [Code of Conduct](https://foundation.wikimedia.org/wiki/Special%3AMyLanguage/Policy%3AUniversal_Code_of_Conduct)
* [Developers](https://developer.wikimedia.org)
* [Statistics](https://stats.wikimedia.org/#/en.wikipedia.org)
* [Cookie statement](https://foundation.wikimedia.org/wiki/Special%3AMyLanguage/Policy%3ACookie_statement)
* [Mobile view](//en.m.wikipedia.org/w/index.php?title=Billion_laughs_attack&mobileaction=toggle_view_mobile)

* [![Wikimedia Foundation](/static/images/footer/wikimedia-button.svg)](https://wikimediafoundation.org/)
* [![Powered by MediaWiki](/w/resources/assets/poweredby_mediawiki.svg)](https://www.mediawiki.org/)

