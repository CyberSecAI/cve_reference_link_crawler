

# Re: [LInux Kernel Crash] "WARNING: kmalloc bug in ctl\_ioctl"

[[Date Prev](msg56693.html)][[Date Next](msg56695.html)][[Thread Prev](msg56693.html)][[Thread Next](msg56576.html)][[Date Index](maillist.html#56694)][[Thread Index](threads.html#56694)]

---

* *Subject*: Re: [LInux Kernel Crash] "WARNING: kmalloc bug in ctl\_ioctl"
* *From*: Linus Torvalds <torvalds@xxxxxxxxxxxxxxxxxxxx>
* *Date*: Wed, 3 Jan 2024 11:21:19 -0800
* *Cc*: Greg KH <gregkh@xxxxxxxxxxxxxxxxxxx>, "Yang, Chenyuan" <cy54@xxxxxxxxxxxx>, "security@xxxxxxxxxx" <security@xxxxxxxxxx>, "dm-devel@xxxxxxxxxxxxxxx" <dm-devel@xxxxxxxxxxxxxxx>, "agk@xxxxxxxxxx" <agk@xxxxxxxxxx>, "snitzer@xxxxxxxxxx" <snitzer@xxxxxxxxxx>, "syzkaller@xxxxxxxxxxxxxxxx" <syzkaller@xxxxxxxxxxxxxxxx>, "Zhang, Lingming" <lingming@xxxxxxxxxxxx>, "Marinov, Darko" <marinov@xxxxxxxxxxxx>, "Zhao, Zijie" <zijie4@xxxxxxxxxxxx>
* *In-reply-to*: <[b7e39bbd-356e-8bae-7fca-e71ff067149@redhat.com](msg56693.html)>
* *References*: <[PH7PR11MB576877FF72A9B2D43EAA1AEBA093A@PH7PR11MB5768.namprd11.prod.outlook.com](msg56574.html)> <2023121655-exporter-deed-6fcb@gregkh> <[b7e39bbd-356e-8bae-7fca-e71ff067149@redhat.com](msg56693.html)>

---

```
On Wed, 3 Jan 2024 at 11:15, Mikulas Patocka <mpatocka@xxxxxxxxxx> wrote:
>
> Should we use __GFP_NOWARN? (but this would shut up also genuine
> warnings).

This can only be fixed in the *caller*, which need to either

 (a) have saen limit checking that checks for an obviously safe limit
(please don't just make it INT_MAX to handle this one case - make it
something *reasonable*)

_or_

 (b) the __GPF_NOWARN with a very obvious "I handle a failed return
gracefully" handling all the way out to user space (error returns
and/or things like "fall back to smaller sizes")./

because a caller that just passes in a random value to kmalloc()
should continue to warn if that random value is unreasonable.

Exactly *because* we want all those crazy random tester robots to
actually find cases where people just randomly take untrusted lengths
from user space.

                     Linus

```

---

* **References**:
  + **[[LInux Kernel Crash] "WARNING: kmalloc bug in ctl\_ioctl"](msg56574.html)**
    - *From:* Yang, Chenyuan
  + **[Re: [LInux Kernel Crash] "WARNING: kmalloc bug in ctl\_ioctl"](msg56588.html)**
    - *From:* Greg KH
  + **[Re: [LInux Kernel Crash] "WARNING: kmalloc bug in ctl\_ioctl"](msg56693.html)**
    - *From:* Mikulas Patocka

* Prev by Date:
  **[Re: [LInux Kernel Crash] "WARNING: kmalloc bug in ctl\_ioctl"](msg56693.html)**
* Next by Date:
  **[[PATCH] libmultipath: fix ANA prioritizer enablement logic](msg56695.html)**
* Previous by thread:
  **[Re: [LInux Kernel Crash] "WARNING: kmalloc bug in ctl\_ioctl"](msg56693.html)**
* Next by thread:
  **[[PATCH] multipath-tools: update ml](msg56576.html)**
* Index(es):
  + [**Date**](maillist.html#56694)
  + [**Thread**](threads.html#56694)

[[Index of Archives]](/lists/)

[[DM Crypt]](/lists/dm-crypt/)

[[Fedora Desktop]](/lists/fedora-desktop/)

[[ATA RAID]](/lists/ataraid/)

[[Fedora Marketing]](/lists/fedora-marketing/)

[[Fedora Packaging]](/lists/fedora-packaging/)

[[Fedora SELinux]](/lists/fedora-selinux/)

[[Yosemite Discussion]](https://yosemitenews.info)

[[KDE Users]](/lists/kde/)

[[Fedora Docs]](/lists/fedora-docs/)

---

|  | [Powered by Linux](/lists/) |
| --- | --- |

