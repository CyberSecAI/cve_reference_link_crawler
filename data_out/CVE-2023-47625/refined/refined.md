The provided content relates to CVE-2023-47625.

**Root cause of vulnerability:**
The vulnerability is caused by an incorrect size check in the `CrsfParser_TryParseCrsfPacket` function when handling unknown CRSF packets. Specifically, when the packet type is not 0x16 or 0x14, the size calculation for the working segment does not account for the CRC, leading to a potential buffer overflow.

**Weaknesses/vulnerabilities present:**
- **Global Buffer Overflow (CWE-120):** The `process_buffer` has a fixed size of 64 bytes, but the `memcpy` operation can attempt to write more than 64 bytes into this buffer due to the size calculation error in `CrsfParser_TryParseCrsfPacket`.
- Incorrect size calculation for unknown packets.

**Impact of exploitation:**
- A successful exploit can lead to a global buffer overflow, potentially causing unexpected behavior in the drone, including crashes or erratic flight patterns.
- The vulnerability can be exploited to overwrite memory, leading to unpredictable and potentially malicious behavior of the affected system.

**Attack vectors:**
- The primary attack vector involves sending a crafted CRSF packet to the affected device. This can be done by manipulating the RC input.
- The vulnerability is triggered when the device receives and parses the crafted CRSF packet through the `crsf_rc` driver.

**Required attacker capabilities/position:**
- The attacker needs to be able to send arbitrary CRSF packets to the affected device by controlling the RC input.
- No special privileges are required to trigger the vulnerability.
- The attacker needs to know the structure of the CRSF protocol to send specific crafted packets.
- Local access to the device is required.

**Additional Notes:**
- The vulnerability occurs because the length check for unknown packets did not include the `PACKET_SIZE_TYPE_SIZE` and `CRC_SIZE`, which allows the `working_index` variable to exceed `CRSF_MAX_PACKET_LEN`.
- The fix involves adding a check to ensure the `working_index + CRC_SIZE` does not exceed the maximum packet length `CRSF_MAX_PACKET_LEN`.
- The provided information includes a proof-of-concept (PoC) to reproduce the issue and a patch recommendation.
- The vulnerability is assigned a low severity.
- The vulnerability was found by Pwn9uin