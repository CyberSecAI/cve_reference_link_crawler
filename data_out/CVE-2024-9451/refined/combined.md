=== Content from plugins.trac.wordpress.org_a35a9f4e_20250110_162211.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fbrowser%2Fembed-pdf-viewer%2Ftrunk%2Fembed-pdf-viewer.php)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Revision](/browser/embed-pdf-viewer/trunk/embed-pdf-viewer.php?rev=3164573 "Revision 3164573")
* Next Revision →
* [Blame](/browser/embed-pdf-viewer/trunk/embed-pdf-viewer.php?annotate=blame "Annotate each line with the last changed revision (this can be time consuming...)")
* [Revision Log](/log/embed-pdf-viewer/trunk/embed-pdf-viewer.php)

---

# [source:](/browser?order=name "Go to repository root") [embed-pdf-viewer](/browser/embed-pdf-viewer?order=name "View embed-pdf-viewer")/[trunk](/browser/embed-pdf-viewer/trunk?order=name "View trunk")/[embed-pdf-viewer.php](/browser/embed-pdf-viewer/trunk/embed-pdf-viewer.php?order=name "View embed-pdf-viewer.php")

View diff against:

View revision:

| [Last change](/changeset/3180138/embed-pdf-viewer/trunk/embed-pdf-viewer.php "View differences") on this file was [3180138](/changeset/3180138/ "View changeset 3180138"), checked in by afragen, [2 months ago](/timeline?from=2024-11-01T18%3A21%3A53Z&precision=second "See timeline at 11/01/2024 06:21:53 PM") |
| --- |
| Update to version 2.4.6 from GitHub |
| **File size:** 7.6 KB | |

| Line |  |
| --- | --- |
| [1](#L1) | <?php |
| [2](#L2) | /\*\* |
| [3](#L3) | \* Embed PDF Viewer |
| [4](#L4) | \* |
| [5](#L5) | \* @author  Andy Fragen |
| [6](#L6) | \* @license GPL-2.0+ |
| [7](#L7) | \* @link    https://github.com/afragen/embed-pdf-viewer |
| [8](#L8) | \* @package embed-pdf-viewer |
| [9](#L9) | \*/ |
| [10](#L10) |  |
| [11](#L11) | /\*\* |
| [12](#L12) | \* Plugin Name:       Embed PDF Viewer |
| [13](#L13) | \* Plugin URI:        https://github.com/afragen/embed-pdf-viewer |
| [14](#L14) | \* Description:       Embed a PDF from the Media Library or elsewhere via oEmbed or as a block into an `iframe` tag. |
| [15](#L15) | \* Author:            Andy Fragen |
| [16](#L16) | \* Author URI:        https://github.com/afragen |
| [17](#L17) | \* Version:           2.4.6 |
| [18](#L18) | \* License:           GPLv2+ |
| [19](#L19) | \* Domain Path:       /languages |
| [20](#L20) | \* Text Domain:       embed-pdf-viewer |
| [21](#L21) | \* License URI:       http://www.gnu.org/licenses/gpl-2.0.html |
| [22](#L22) | \* GitHub Plugin URI: https://github.com/afragen/embed-pdf-viewer |
| [23](#L23) | \* Requires PHP:      7.4 |
| [24](#L24) | \* Requires at least: 6.0 |
| [25](#L25) | \*/ |
| [26](#L26) |  |
| [27](#L27) | /\*\* |
| [28](#L28) | \* Exit if called directly. |
| [29](#L29) | \*/ |
| [30](#L30) | if ( ! defined( 'WPINC' ) ) { |
| [31](#L31) | die; |
| [32](#L32) | } |
| [33](#L33) |  |
| [34](#L34) | $epd\_version = get\_file\_data( \_\_FILE\_\_, [ 'Version' => 'version' ] )['Version']; |
| [35](#L35) | add\_filter( 'media\_send\_to\_editor', [ Embed\_PDF\_Viewer::instance( $epd\_version ), 'embed\_pdf\_media\_editor' ], 20, 2 ); |
| [36](#L36) | wp\_embed\_register\_handler( |
| [37](#L37) | 'oembed\_pdf\_viewer', |
| [38](#L38) | '#(^(https?)\:\/\/.+\.pdf$)#i', |
| [39](#L39) | [ |
| [40](#L40) | Embed\_PDF\_Viewer::instance( $epd\_version ), |
| [41](#L41) | 'oembed\_pdf\_viewer', |
| [42](#L42) | ] |
| [43](#L43) | ); |
| [44](#L44) | add\_action( |
| [45](#L45) | 'init', |
| [46](#L46) | function () use ( $epd\_version ) { |
| [47](#L47) | wp\_set\_script\_translations( 'embed-pdf-viewer-scripts', 'embed-pdf-viewer' ); |
| [48](#L48) |  |
| [49](#L49) | // phpcs:ignore WordPress.WP.EnqueuedResourceParameters.NoExplicitVersion |
| [50](#L50) | wp\_enqueue\_style( |
| [51](#L51) | 'embed-pdf-viewer', |
| [52](#L52) | plugins\_url( 'css/embed-pdf-viewer.css', \_\_FILE\_\_ ), |
| [53](#L53) | [], |
| [54](#L54) | $epd\_version, |
| [55](#L55) | 'screen' |
| [56](#L56) | ); |
| [57](#L57) | } |
| [58](#L58) | ); |
| [59](#L59) | add\_action( 'init', [ Embed\_PDF\_Viewer::instance( $epd\_version ), 'register\_block' ] ); |
| [60](#L60) |  |
| [61](#L61) | /\*\* |
| [62](#L62) | \* Class Embed\_PDF\_Viewer |
| [63](#L63) | \*/ |
| [64](#L64) | class Embed\_PDF\_Viewer { |
| [65](#L65) | /\*\* |
| [66](#L66) | \* For singleton. |
| [67](#L67) | \* |
| [68](#L68) | \* @var bool |
| [69](#L69) | \*/ |
| [70](#L70) | private static $instance = false; |
| [71](#L71) |  |
| [72](#L72) | /\*\* |
| [73](#L73) | \* Plugin version number. |
| [74](#L74) | \* |
| [75](#L75) | \* @var string |
| [76](#L76) | \*/ |
| [77](#L77) | private static $version = ''; |
| [78](#L78) |  |
| [79](#L79) | /\*\* |
| [80](#L80) | \* Create singleton. |
| [81](#L81) | \* |
| [82](#L82) | \* @param string $version Plugin version number. |
| [83](#L83) | \* @return bool |
| [84](#L84) | \*/ |
| [85](#L85) | public static function instance( $version ) { |
| [86](#L86) | static::$version = $version; |
| [87](#L87) | if ( false === static::$instance ) { |
| [88](#L88) | static::$instance = new self( $version ); |
| [89](#L89) | } |
| [90](#L90) |  |
| [91](#L91) | return static::$instance; |
| [92](#L92) | } |
| [93](#L93) |  |
| [94](#L94) | /\*\* |
| [95](#L95) | \* Register block. |
| [96](#L96) | \* |
| [97](#L97) | \* @return void |
| [98](#L98) | \*/ |
| [99](#L99) | public function register\_block() { |
| [100](#L100) | if ( ! function\_exists( 'register\_block\_type' ) ) { |
| [101](#L101) | return; |
| [102](#L102) | } |
| [103](#L103) |  |
| [104](#L104) | // phpcs:ignore WordPress.WP.EnqueuedResourceParameters.NoExplicitVersion |
| [105](#L105) | wp\_register\_script( |
| [106](#L106) | 'embed-pdf-viewer', |
| [107](#L107) | plugins\_url( 'blocks/build/index.js', \_\_FILE\_\_ ), |
| [108](#L108) | [ 'wp-i18n', 'wp-blocks', 'wp-block-editor', 'wp-element', 'wp-components', 'wp-compose', 'wp-blob' ], |
| [109](#L109) | static::$version, |
| [110](#L110) | true |
| [111](#L111) | ); |
| [112](#L112) |  |
| [113](#L113) | register\_block\_type( |
| [114](#L114) | 'embed-pdf-viewer/pdf', |
| [115](#L115) | [ |
| [116](#L116) | 'editor\_script'   => 'embed-pdf-viewer', |
| [117](#L117) | 'render\_callback' => [ static::$instance, 'dynamic\_render\_callback' ], |
| [118](#L118) | ] |
| [119](#L119) | ); |
| [120](#L120) | } |
| [121](#L121) |  |
| [122](#L122) | /\*\* |
| [123](#L123) | \* Dynamically render callback based on browser. |
| [124](#L124) | \* |
| [125](#L125) | \* @global bool $is\_chrome Tests for Chrome browser. |
| [126](#L126) | \* |
| [127](#L127) | \* @param array $attributes Array of attributes. |
| [128](#L128) | \* |
| [129](#L129) | \* @return string |
| [130](#L130) | \*/ |
| [131](#L131) | public function dynamic\_render\_callback( $attributes ) { |
| [132](#L132) | global $is\_chrome; |
| [133](#L133) |  |
| [134](#L134) | $url = $attributes['url'] ?? null; |
| [135](#L135) | if ( ! $url ) { |
| [136](#L136) | return ''; |
| [137](#L137) | } |
| [138](#L138) |  |
| [139](#L139) | $classes     = 'embed-pdf-viewer'; |
| [140](#L140) | $src         = $is\_chrome || wp\_is\_mobile() ? 'https://docs.google.com/viewer?url=' . rawurlencode( $url ) . '&embedded=true' : $url; |
| [141](#L141) | $description = $attributes['title'] ?? ''; |
| [142](#L142) | $description = $attributes['description'] ?? $description; |
| [143](#L143) | $width       = $attributes['width'] ?? '600'; |
| [144](#L144) | $height      = $attributes['height'] ?? '600'; |
| [145](#L145) | return sprintf( |
| [146](#L146) | '<iframe class="%1$s" src="%2$s" height="%3$s" width="%4$s" title="%5$s"%6$s></iframe>', |
| [147](#L147) | $classes, |
| [148](#L148) | sanitize\_url( $src ), |
| [149](#L149) | esc\_attr( $width ), |
| [150](#L150) | esc\_attr( $height ), |
| [151](#L151) | esc\_attr( $description ), |
| [152](#L152) | $is\_chrome || wp\_is\_mobile() ? ' frameborder="0"' : '' |
| [153](#L153) | ); |
| [154](#L154) | } |
| [155](#L155) |  |
| [156](#L156) | /\*\* |
| [157](#L157) | \* Insert URL to PDF from Media Library, then render as oEmbed. |
| [158](#L158) | \* |
| [159](#L159) | \* @param string  $html an href link to the media. |
| [160](#L160) | \* @param integer $id   post\_id. |
| [161](#L161) | \* |
| [162](#L162) | \* @return string |
| [163](#L163) | \*/ |
| [164](#L164) | public function embed\_pdf\_media\_editor( $html, $id ) { |
| [165](#L165) | $post = get\_post( $id ); |
| [166](#L166) | if ( 'application/pdf' !== $post->post\_mime\_type ) { |
| [167](#L167) | return $html; |
| [168](#L168) | } |
| [169](#L169) |  |
| [170](#L170) | return $post->guid . "\n\n"; |
| [171](#L171) | } |
| [172](#L172) |  |
| [173](#L173) | /\*\* |
| [174](#L174) | \* Create oEmbed code. |
| [175](#L175) | \* |
| [176](#L176) | \* @param array  $matches Regex matches. |
| [177](#L177) | \* @param array  $atts    array of media height/width. |
| [178](#L178) | \* @param string $url     URI for media file. |
| [179](#L179) | \* |
| [180](#L180) | \* @return string|WP\_Error |
| [181](#L181) | \*/ |
| [182](#L182) | public function oembed\_pdf\_viewer( $matches, $atts, $url ) { |
| [183](#L183) | $attachment\_id = $this->get\_attachment\_id\_by\_url( $url ); |
| [184](#L184) | if ( ! empty( $attachment\_id ) ) { |
| [185](#L185) | $post = get\_post( $this->get\_attachment\_id\_by\_url( $url ) ); |
| [186](#L186) | } else { |
| [187](#L187) | /\* |
| [188](#L188) | \* URL is from outside of the Media Library. |
| [189](#L189) | \*/ |
| [190](#L190) | $response = wp\_remote\_get( $url ); |
| [191](#L191) | if ( is\_wp\_error( $response ) ) { |
| [192](#L192) | return $response; |
| [193](#L193) | } |
| [194](#L194) | $post                 = new WP\_Post( new stdClass() ); |
| [195](#L195) | $post->guid           = $matches[0]; |
| [196](#L196) | $post->post\_mime\_type = wp\_remote\_retrieve\_header( $response, 'content-type' ); |
| [197](#L197) | $post->post\_name      = preg\_replace( '/\.pdf$/', '', basename( $matches[0] ) ); |
| [198](#L198) | } |
| [199](#L199) |  |
| [200](#L200) | return $this->create\_output( $post, $atts ); |
| [201](#L201) | } |
| [202](#L202) |  |
| [203](#L203) | /\*\* |
| [204](#L204) | \* Create output for iframe and/or Google Doc Viewer and href link to file. |
| [205](#L205) | \* |
| [206](#L206) | \* @param \WP\_Post     $post Current post. |
| [207](#L207) | \* @param array|string $atts array of media height/width or |
| [208](#L208) | \*                           href to media library asset. |
| [209](#L209) | \* |
| [210](#L210) | \* @return bool|string |
| [211](#L211) | \*/ |
| [212](#L212) | private function create\_output( WP\_Post $post, $atts = [] ) { |
| [213](#L213) | global $is\_chrome; |
| [214](#L214) |  |
| [215](#L215) | if ( 'application/pdf' !== $post->post\_mime\_type ) { |
| [216](#L216) | return $atts; |
| [217](#L217) | } |
| [218](#L218) |  |
| [219](#L219) | $default = [ |
| [220](#L220) | 'height'      => 500, |
| [221](#L221) | 'width'       => 800, |
| [222](#L222) | 'title'       => $post->post\_title, |
| [223](#L223) | 'description' => $post->post\_content, |
| [224](#L224) | ]; |
| [225](#L225) |  |
| [226](#L226) | /\* |
| [227](#L227) | \* Ensure $atts isn't the href. |
| [228](#L228) | \*/ |
| [229](#L229) | $atts = is\_array( $atts ) ? $atts : []; |
| [230](#L230) |  |
| [231](#L231) | if ( isset( $atts['width'] ) ) { |
| [232](#L232) | $atts['width'] = '100%'; |
| [233](#L233) | } |
| [234](#L234) | $atts = array\_merge( $default, $atts ); |
| [235](#L235) |  |
| [236](#L236) | /\*\* |
| [237](#L237) | \* Filter PDF attributes. |
| [238](#L238) | \* |
| [239](#L239) | \* @since 1.6.0 |
| [240](#L240) | \* @param  array $atts Array of PDF attributes. |
| [241](#L241) | \* @return array $atts |
| [242](#L242) | \*/ |
| [243](#L243) | $atts = apply\_filters( 'embed\_pdf\_viewer\_pdf\_attributes', $atts ); |
| [244](#L244) |  |
| [245](#L245) | // Fix title or create from filename. |
| [246](#L246) | $atts['title'] = empty( $atts['title'] ) |
| [247](#L247) | ? ucwords( preg\_replace( '/(-|\_)/', ' ', $post->post\_name ) ) |
| [248](#L248) | : ucwords( preg\_replace( '/(-|\_)/', ' ', $atts['title'] ) ); |
| [249](#L249) |  |
| [250](#L250) | $description   = ! empty( $atts['description'] ) ? $atts['description'] : $atts['title']; |
| [251](#L251) | $sanitized\_url = sanitize\_url( $post->guid ); |
| [252](#L252) |  |
| [253](#L253) | if ( $is\_chrome || wp\_is\_mobile() ) { |
| [254](#L254) | $iframe  = '<iframe class="embed-pdf-viewer" src="https://docs.google.com/viewer?url=' . rawurlencode( $sanitized\_url ); |
| [255](#L255) | $iframe .= '&amp;embedded=true" frameborder="0" '; |
| [256](#L256) | } else { |
| [257](#L257) | $iframe = '<iframe class="embed-pdf-viewer" src="' . $sanitized\_url . '" '; |
| [258](#L258) | } |
| [259](#L259) | $iframe .= 'height="' . esc\_attr( $atts['height'] ) . '" width="' . esc\_attr( $atts['width'] ) . '" '; |
| [260](#L260) | $iframe .= 'title="' . esc\_attr( $description ) . '"></iframe>' . "\n"; |
| [261](#L261) |  |
| [262](#L262) | $embed  = '<div>'; |
| [263](#L263) | $embed .= $iframe; |
| [264](#L264) | $embed .= '<p><a href="' . $sanitized\_url . '" title="' . esc\_attr( $description ) . '">' . esc\_html( $description ) . '</a></p>'; |
| [265](#L265) | $embed .= '</div>'; |
| [266](#L266) |  |
| [267](#L267) | return $embed; |
| [268](#L268) | } |
| [269](#L269) |  |
| [270](#L270) | /\*\* |
| [271](#L271) | \* Get attachment id by url. Thanks Pippin. |
| [272](#L272) | \* |
| [273](#L273) | \* @link  https://pippinsplugins.com/retrieve-attachment-id-from-image-url/ |
| [274](#L274) | \* |
| [275](#L275) | \* @param string $url URI of attachment. |
| [276](#L276) | \* |
| [277](#L277) | \* @return mixed |
| [278](#L278) | \*/ |
| [279](#L279) | private function get\_attachment\_id\_by\_url( $url ) { |
| [280](#L280) | global $wpdb; |
| [281](#L281) | // phpcs:ignore WordPress.DB |
| [282](#L282) | $attachment = $wpdb->get\_col( $wpdb->prepare( "SELECT ID FROM $wpdb->posts WHERE guid='%s';", $url ) ); |
| [283](#L283) |  |
| [284](#L284) | if ( empty( $attachment ) ) { |
| [285](#L285) | return null; |
| [286](#L286) | } |
| [287](#L287) |  |
| [288](#L288) | return $attachment[0]; |
| [289](#L289) | } |
| [290](#L290) | } |

**Note:** See [TracBrowser](/wiki/TracBrowser)
for help on using the repository browser.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Plain Text](/browser/embed-pdf-viewer/trunk/embed-pdf-viewer.php?format=txt)
* [Original Format](/export/3220326/embed-pdf-viewer/trunk/embed-pdf-viewer.php)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)



=== Content from plugins.trac.wordpress.org_6490f098_20250110_162212.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fchangeset%2F3164573)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Changeset](/changeset/3164572 "Changeset 3164572")
* [Next Changeset](/changeset/3164574 "Changeset 3164574") →

---

# Changeset 3164573

View differences
inline
side by side

Show
lines around each change

Show the changes in full context

Ignore:

Blank lines

Case changes

White space changes

Timestamp:
10/08/2024 12:48:13 AM
([3 months](/timeline?from=2024-10-08T00%3A48%3A13Z&precision=second "See timeline at 10/08/2024 12:48:13 AM") ago)

Author:
afragen
Message:

Update to version 2.4.5 from GitHub

Location:
[embed-pdf-viewer](/browser/embed-pdf-viewer?rev=3164573)
Files:

6 edited
1 copied

* [tags/2.4.5](/browser/embed-pdf-viewer/tags/2.4.5?rev=3164573 "Show entry in browser")
  (copied)
  *(copied from [embed-pdf-viewer/trunk](/browser/embed-pdf-viewer/trunk?rev=3136695 "Show original file (revision 3164572)"))*
* [tags/2.4.5/CHANGES.md](/browser/embed-pdf-viewer/tags/2.4.5/CHANGES.md?rev=3164573 "Show entry in browser")
  (modified)
  ([1 diff](#file1 "Show differences"))
* [tags/2.4.5/embed-pdf-viewer.php](/browser/embed-pdf-viewer/tags/2.4.5/embed-pdf-viewer.php?rev=3164573 "Show entry in browser")
  (modified)
  ([3 diffs](#file2 "Show differences"))
* [tags/2.4.5/readme.txt](/browser/embed-pdf-viewer/tags/2.4.5/readme.txt?rev=3164573 "Show entry in browser")
  (modified)
  ([2 diffs](#file3 "Show differences"))
* [trunk/CHANGES.md](/browser/embed-pdf-viewer/trunk/CHANGES.md?rev=3164573 "Show entry in browser")
  (modified)
  ([1 diff](#file4 "Show differences"))
* [trunk/embed-pdf-viewer.php](/browser/embed-pdf-viewer/trunk/embed-pdf-viewer.php?rev=3164573 "Show entry in browser")
  (modified)
  ([3 diffs](#file5 "Show differences"))
* [trunk/readme.txt](/browser/embed-pdf-viewer/trunk/readme.txt?rev=3164573 "Show entry in browser")
  (modified)
  ([2 diffs](#file6 "Show differences"))

### Legend:

Unmodified
Added
Removed

* ## [embed-pdf-viewer/tags/2.4.5/CHANGES.md](/changeset/3164573/embed-pdf-viewer/tags/2.4.5/CHANGES.md "Show the changeset 3164573 restricted to embed-pdf-viewer/tags/2.4.5/CHANGES.md")

  | [r3136695](/browser/embed-pdf-viewer/trunk/CHANGES.md?rev=3136695#L1 "Show revision 3136695 of this file in browser") | [r3164573](/browser/embed-pdf-viewer/tags/2.4.5/CHANGES.md?rev=3164573#L1 "Show revision 3164573 of this file in browser") |  |
  | --- | --- | --- |
  | 1 | 1 | #### [unreleased] |
  |  | 2 |  |
  |  | 3 | #### 2.4.5 / 2024-10-7 |
  |  | 4 | \* escape block parameters |
  | 2 | 5 |  |
  | 3 | 6 | #### 2.4.4 / 2024-08-16 |
* ## [embed-pdf-viewer/tags/2.4.5/embed-pdf-viewer.php](/changeset/3164573/embed-pdf-viewer/tags/2.4.5/embed-pdf-viewer.php "Show the changeset 3164573 restricted to embed-pdf-viewer/tags/2.4.5/embed-pdf-viewer.php")

  | [r3136695](/browser/embed-pdf-viewer/trunk/embed-pdf-viewer.php?rev=3136695#L15 "Show revision 3136695 of this file in browser") | [r3164573](/browser/embed-pdf-viewer/tags/2.4.5/embed-pdf-viewer.php?rev=3164573#L15 "Show revision 3164573 of this file in browser") |  |
  | --- | --- | --- |
  | 15 | 15 | \* Author:            Andy Fragen |
  | 16 | 16 | \* Author URI:        https://github.com/afragen |
  | 17 |  | \* Version:           2.4.~~4~~ |
  |  | 17 | \* Version:           2.4.5 |
  | 18 | 18 | \* License:           GPLv2+ |
  | 19 | 19 | \* Domain Path:       /languages |
  | […](/browser/embed-pdf-viewer/trunk/embed-pdf-viewer.php?rev=3136695#L142) | […](/browser/embed-pdf-viewer/tags/2.4.5/embed-pdf-viewer.php?rev=3164573#L142) |  |
  | 142 | 142 | $description = $attributes['title'] ?? ''; |
  | 143 | 143 | $description = $attributes['description'] ?? $description; |
  |  | 144 | $width       = $attributes['width'] ?? '600'; |
  |  | 145 | $height      = $attributes['height'] ?? '600'; |
  | 144 | 146 | return sprintf( |
  | 145 | 147 | '<iframe class="%1$s" src="%2$s" height="%3$s" width="%4$s" title="%5$s"%6$s></iframe>', |
  | 146 | 148 | $classes, |
  | 147 | 149 | sanitize\_url( $src ), |
  | 148 |  | ~~$attributes['width'] ?? '600'~~, |
  | 149 |  | ~~$attributes['height'] ?? '600'~~, |
  |  | 150 | esc\_attr( $width ), |
  |  | 151 | esc\_attr( $height ), |
  | 150 | 152 | esc\_attr( $description ), |
  | 151 | 153 | $is\_chrome || wp\_is\_mobile() ? ' frameborder="0"' : '' |
  | […](/browser/embed-pdf-viewer/trunk/embed-pdf-viewer.php?rev=3136695#L256) | […](/browser/embed-pdf-viewer/tags/2.4.5/embed-pdf-viewer.php?rev=3164573#L258) |  |
  | 256 | 258 | $iframe = '<iframe class="embed-pdf-viewer" src="' . $sanitized\_url . '" '; |
  | 257 | 259 | } |
  | 258 |  | $iframe .= 'height="' . ~~$atts['height'] . '" width="' . $atts['width']~~ . '" '; |
  |  | 260 | $iframe .= 'height="' . esc\_attr( $atts['height'] ) . '" width="' . esc\_attr( $atts['width'] ) . '" '; |
  | 259 | 261 | $iframe .= 'title="' . esc\_attr( $description ) . '"></iframe>' . "\n"; |
  | 260 | 262 |  |
* ## [embed-pdf-viewer/tags/2.4.5/readme.txt](/changeset/3164573/embed-pdf-viewer/tags/2.4.5/readme.txt "Show the changeset 3164573 restricted to embed-pdf-viewer/tags/2.4.5/readme.txt")

  | [r3136695](/browser/embed-pdf-viewer/trunk/readme.txt?rev=3136695#L6 "Show revision 3136695 of this file in browser") | [r3164573](/browser/embed-pdf-viewer/tags/2.4.5/readme.txt?rev=3164573#L6 "Show revision 3164573 of this file in browser") |  |
  | --- | --- | --- |
  | 6 | 6 | Tested up to: 6.6 |
  | 7 | 7 | Requires PHP: 7.4 |
  | 8 |  | Stable tag: 2.4.~~4~~ |
  |  | 8 | Stable tag: 2.4.5 |
  | 9 | 9 | License: GPL v2+ |
  | 10 | 10 | License URI: https://www.gnu.org/licenses/gpl-2.0.html |
  | […](/browser/embed-pdf-viewer/trunk/readme.txt?rev=3136695#L30) | […](/browser/embed-pdf-viewer/tags/2.4.5/readme.txt?rev=3164573#L30) |  |
  | 30 | 30 |  |
  | 31 | 31 | ## Changelog |
  |  | 32 |  |
  |  | 33 | #### 2.4.5 / 2024-10-7 |
  |  | 34 | \* escape block parameters |
  | 32 | 35 |  |
  | 33 | 36 | #### 2.4.4 / 2024-08-16 |
* ## [embed-pdf-viewer/trunk/CHANGES.md](/changeset/3164573/embed-pdf-viewer/trunk/CHANGES.md "Show the changeset 3164573 restricted to embed-pdf-viewer/trunk/CHANGES.md")

  | [r3136695](/browser/embed-pdf-viewer/trunk/CHANGES.md?rev=3136695#L1 "Show revision 3136695 of this file in browser") | [r3164573](/browser/embed-pdf-viewer/trunk/CHANGES.md?rev=3164573#L1 "Show revision 3164573 of this file in browser") |  |
  | --- | --- | --- |
  | 1 | 1 | #### [unreleased] |
  |  | 2 |  |
  |  | 3 | #### 2.4.5 / 2024-10-7 |
  |  | 4 | \* escape block parameters |
  | 2 | 5 |  |
  | 3 | 6 | #### 2.4.4 / 2024-08-16 |
* ## [embed-pdf-viewer/trunk/embed-pdf-viewer.php](/changeset/3164573/embed-pdf-viewer/trunk/embed-pdf-viewer.php "Show the changeset 3164573 restricted to embed-pdf-viewer/trunk/embed-pdf-viewer.php")

  | [r3136695](/browser/embed-pdf-viewer/trunk/embed-pdf-viewer.php?rev=3136695#L15 "Show revision 3136695 of this file in browser") | [r3164573](/browser/embed-pdf-viewer/trunk/embed-pdf-viewer.php?rev=3164573#L15 "Show revision 3164573 of this file in browser") |  |
  | --- | --- | --- |
  | 15 | 15 | \* Author:            Andy Fragen |
  | 16 | 16 | \* Author URI:        https://github.com/afragen |
  | 17 |  | \* Version:           2.4.~~4~~ |
  |  | 17 | \* Version:           2.4.5 |
  | 18 | 18 | \* License:           GPLv2+ |
  | 19 | 19 | \* Domain Path:       /languages |
  | […](/browser/embed-pdf-viewer/trunk/embed-pdf-viewer.php?rev=3136695#L142) | […](/browser/embed-pdf-viewer/trunk/embed-pdf-viewer.php?rev=3164573#L142) |  |
  | 142 | 142 | $description = $attributes['title'] ?? ''; |
  | 143 | 143 | $description = $attributes['description'] ?? $description; |
  |  | 144 | $width       = $attributes['width'] ?? '600'; |
  |  | 145 | $height      = $attributes['height'] ?? '600'; |
  | 144 | 146 | return sprintf( |
  | 145 | 147 | '<iframe class="%1$s" src="%2$s" height="%3$s" width="%4$s" title="%5$s"%6$s></iframe>', |
  | 146 | 148 | $classes, |
  | 147 | 149 | sanitize\_url( $src ), |
  | 148 |  | ~~$attributes['width'] ?? '600'~~, |
  | 149 |  | ~~$attributes['height'] ?? '600'~~, |
  |  | 150 | esc\_attr( $width ), |
  |  | 151 | esc\_attr( $height ), |
  | 150 | 152 | esc\_attr( $description ), |
  | 151 | 153 | $is\_chrome || wp\_is\_mobile() ? ' frameborder="0"' : '' |
  | […](/browser/embed-pdf-viewer/trunk/embed-pdf-viewer.php?rev=3136695#L256) | […](/browser/embed-pdf-viewer/trunk/embed-pdf-viewer.php?rev=3164573#L258) |  |
  | 256 | 258 | $iframe = '<iframe class="embed-pdf-viewer" src="' . $sanitized\_url . '" '; |
  | 257 | 259 | } |
  | 258 |  | $iframe .= 'height="' . ~~$atts['height'] . '" width="' . $atts['width']~~ . '" '; |
  |  | 260 | $iframe .= 'height="' . esc\_attr( $atts['height'] ) . '" width="' . esc\_attr( $atts['width'] ) . '" '; |
  | 259 | 261 | $iframe .= 'title="' . esc\_attr( $description ) . '"></iframe>' . "\n"; |
  | 260 | 262 |  |
* ## [embed-pdf-viewer/trunk/readme.txt](/changeset/3164573/embed-pdf-viewer/trunk/readme.txt "Show the changeset 3164573 restricted to embed-pdf-viewer/trunk/readme.txt")

  | [r3136695](/browser/embed-pdf-viewer/trunk/readme.txt?rev=3136695#L6 "Show revision 3136695 of this file in browser") | [r3164573](/browser/embed-pdf-viewer/trunk/readme.txt?rev=3164573#L6 "Show revision 3164573 of this file in browser") |  |
  | --- | --- | --- |
  | 6 | 6 | Tested up to: 6.6 |
  | 7 | 7 | Requires PHP: 7.4 |
  | 8 |  | Stable tag: 2.4.~~4~~ |
  |  | 8 | Stable tag: 2.4.5 |
  | 9 | 9 | License: GPL v2+ |
  | 10 | 10 | License URI: https://www.gnu.org/licenses/gpl-2.0.html |
  | […](/browser/embed-pdf-viewer/trunk/readme.txt?rev=3136695#L30) | […](/browser/embed-pdf-viewer/trunk/readme.txt?rev=3164573#L30) |  |
  | 30 | 30 |  |
  | 31 | 31 | ## Changelog |
  |  | 32 |  |
  |  | 33 | #### 2.4.5 / 2024-10-7 |
  |  | 34 | \* escape block parameters |
  | 32 | 35 |  |
  | 33 | 36 | #### 2.4.4 / 2024-08-16 |

**Note:** See [TracChangeset](/wiki/TracChangeset)
for help on using the changeset viewer.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Unified Diff](?format=diff&new=3164573)
* [Zip Archive](?format=zip&new=3164573)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)



=== Content from wordpress.org_c5d8cfac_20250110_162213.html ===


[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Showcase](https://wordpress.org/showcase/)
* [Hosting](https://wordpress.org/hosting/)
* Extend
  + [Themes](https://wordpress.org/themes/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Blocks](https://wordpress.org/blocks/)
  + [Openverse ↗︎](https://openverse.org/)
* Learn
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* Community
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [Events](https://events.wordpress.org/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* About
  + [About WordPress](https://wordpress.org/about/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
* [Get WordPress](https://wordpress.org/download/)

Search in WordPress.org

[Get WordPress](https://wordpress.org/download/)

[WordPress.org](https://wordpress.org/)

[Plugin Directory](https://wordpress.org/plugins/)

Embed PDF Viewer

* [Submit a plugin](https://wordpress.org/plugins/developers/)
* [My favorites](https://wordpress.org/plugins/browse/favorites/)
* [Log in](https://login.wordpress.org/?redirect_to=https%3A%2F%2Fwordpress.org%2Fplugins%2Fembed-pdf-viewer&locale=en_US)

* [Submit a plugin](https://wordpress.org/plugins/developers/)
* [My favorites](https://wordpress.org/plugins/browse/favorites/)
* [Log in](https://login.wordpress.org/?redirect_to=https%3A%2F%2Fwordpress.org%2Fplugins%2Fembed-pdf-viewer&locale=en_US)

Search plugins

![](https://ps.w.org/embed-pdf-viewer/assets/banner-772x250.png?rev=2560197)
![](https://ps.w.org/embed-pdf-viewer/assets/icon.svg?rev=2883712)
# Embed PDF Viewer

By [Andy Fragen](https://github.com/afragen)

[Download](https://downloads.wordpress.org/plugin/embed-pdf-viewer.2.4.6.zip)

* [Details](https://wordpress.org/plugins/embed-pdf-viewer/#description)
* [Reviews](https://wordpress.org/plugins/embed-pdf-viewer/#reviews)
* [Development](https://wordpress.org/plugins/embed-pdf-viewer/#developers)

[Support](https://wordpress.org/support/plugin/embed-pdf-viewer/)

## Description

Embed a PDF from the Media Library or elsewhere via oEmbed or as a block into an `iframe` tag. The URL only has to be world reachable link. Chrome uses Google Doc Viewer as Chrome seems to automatically rendered embedded JS in PDFs automatically. Uses Google Doc Viewer with mobile.

Inspired by [Embed PDF](https://wordpress.org/plugins/dirtysuds-embed-pdf/) and [RV Embed PDF](https://wordpress.org/plugins/rv-embed-pdf/).

Many thanks to [Alex Kirk](https://github.com/akirk) for making Embed PDF Viewer compatible with the new block editor.

Development on [GitHub](https://github.com/afragen/embed-pdf-viewer). Pull requests are welcome against the `develop` branch.

### Known Issues

Occasionally Google Doc Viewer will not correctly load the PDF. Reloading the page should correct the issue, though this may need to be done several times.

## Screenshots

* [![](https://ps.w.org/embed-pdf-viewer/assets/screenshot-1.png?rev=2560197)](https://ps.w.org/embed-pdf-viewer/assets/screenshot-1.png?rev=2560197)

  Embed PDF Viewer block
* [![](https://ps.w.org/embed-pdf-viewer/assets/screenshot-2.png?rev=2560197)](https://ps.w.org/embed-pdf-viewer/assets/screenshot-2.png?rev=2560197)

  Select PDF
* [![](https://ps.w.org/embed-pdf-viewer/assets/screenshot-3.png?rev=2560197)](https://ps.w.org/embed-pdf-viewer/assets/screenshot-3.png?rev=2560197)

  PDF block and attributes

## Blocks

This plugin provides 1 block.

* PDF

## Reviews

![](https://secure.gravatar.com/avatar/2c70c3a93b5c86a6c741a8f87e00743a7b3e1581878b5792760d784e954549c2?s=60&d=retro&r=g)
### [Amazing plugin](https://wordpress.org/support/topic/amazing-plugin-2614/)

[hajiabdul](https://profiles.wordpress.org/hajiabdul/ "Posts by hajiabdul")
July 31, 2024

This plugin save my 2 days coding task. If this plugin is not there i have to code this.

![](https://secure.gravatar.com/avatar/215457ed6ea4c4c72b0299070fe0682ae59d4d7a1255037d9e911c3f24309954?s=60&d=retro&r=g)
### [Works Great but no preview on mobile](https://wordpress.org/support/topic/works-great-but-no-preview-on-mobile/)

[yu4nf3n](https://profiles.wordpress.org/yu4nf3n/ "Posts by yu4nf3n")
March 12, 2024
1 reply

Works great on web but when I try to access the website via mobile browser, the pdf has no preview available. BTW, I’m using Wordpress 6.4.3.
Thank you for your effort with this PDF plugin it is a big help and easy to use.

![](https://secure.gravatar.com/avatar/ca3f78c2506a1c61e67fc02fdc4113d6a3dcbcd2de7f0b51ac877fc448e70783?s=60&d=retro&r=g)
### [Perfect!](https://wordpress.org/support/topic/perfect-10126/)

[melissajclark](https://profiles.wordpress.org/melissajclark/ "Posts by melissajclark")
November 20, 2023

Love how easy it is to embed a PDF using the Block Editor and this plugin. It’s perfect.

![](https://secure.gravatar.com/avatar/7dbb5c54a04617bb06e1e2ca533c15e008403f33626538d79d67da14c29aa4ea?s=60&d=retro&r=g)
### [This is the one!](https://wordpress.org/support/topic/this-is-the-one-47/)

[grunk1905](https://profiles.wordpress.org/grunk1905/ "Posts by grunk1905")
May 6, 2023

Having tried with a few other PDF embed viewers, this was the one that didn’t add a watermark (EmbedPress), require some sort of paid upgrade (3d flipbook), add an unnecessary ‘Download” button (wordpress inbuilt viewer), or involve technical skills using the shortcode feature (PDF Viewer and PDF.js Viewer).
Really glad to have found it, and thanks to those who developed it!

![](https://secure.gravatar.com/avatar/7a0fd818983c9497fbe45adcf0dd9c4250850da0e036e48a6e668f112ce24cec?s=60&d=retro&r=g)
### [Fantastic](https://wordpress.org/support/topic/fantastic-3181/)

[Masum Billah](https://profiles.wordpress.org/masumwp/ "Posts by Masum Billah")
April 24, 2023

Very Useful

![](https://secure.gravatar.com/avatar/16563fa6d316c0cc07da8669e4a1f380a78b8335515d260014ff872e9ede2305?s=60&d=retro&r=g)
### [Works great](https://wordpress.org/support/topic/works-great-8632/)

[pwhenderson](https://profiles.wordpress.org/pwhenderson/ "Posts by pwhenderson")
January 14, 2023

Simple is what we were looking for. Simple is what we got. Works great. Tku

[Read all 19 reviews](https://wordpress.org/support/plugin/embed-pdf-viewer/reviews/)
## Contributors & Developers

“Embed PDF Viewer” is open source software. The following people have contributed to this plugin.

Contributors

* ![](https://secure.gravatar.com/avatar/82779a185fccde41e1dd3b914bde84cd6be76c8dcb8f6b983f461c8f5687a87e?s=32&d=mm&r=g) [Andy Fragen](https://profiles.wordpress.org/afragen/)
* ![](https://secure.gravatar.com/avatar/12b93d2a2baed035aa99f0cfbc4f00f3ed5d8a59563694910bcdffbccb5fa256?s=32&d=mm&r=g) [Alex Kirk](https://profiles.wordpress.org/akirk/)
* ![](https://secure.gravatar.com/avatar/737c2df3eecd59128718fa1f089e99f9463e664b51920f15bf781b2578015a2f?s=32&d=mm&r=g) [Colin Stewart](https://profiles.wordpress.org/costdev/)

“Embed PDF Viewer” has been translated into 10 locales. Thank you to [the translators](https://translate.wordpress.org/projects/wp-plugins/embed-pdf-viewer/contributors) for their contributions.

[Translate “Embed PDF Viewer” into your language.](https://translate.wordpress.org/projects/wp-plugins/embed-pdf-viewer)

### Interested in development?

[Browse the code](https://plugins.trac.wordpress.org/browser/embed-pdf-viewer/), check out the [SVN repository](https://plugins.svn.wordpress.org/embed-pdf-viewer/), or subscribe to the [development log](https://plugins.trac.wordpress.org/log/embed-pdf-viewer/) by [RSS](https://plugins.trac.wordpress.org/log/embed-pdf-viewer/?limit=100&mode=stop_on_copy&format=rss).

## Changelog

#### 2.4.6 / 2024-11-01

* remove `load_plugin_textdomain()`

#### 2.4.5 / 2024-10-7

* escape block parameters

#### 2.4.4 / 2024-08-16

* refactor `$description` in `dynamic_render_callback()`, who knew the title attribute could be not set
* update requirements, PHP 7.4+, WP 6.0

#### 2.4.1 – 2.4.3 / 2024-08-08

* more sanitizing of URL
* fix typos and update readme
* use media file description for title if present
* escape description in render

#### 2.4.0 / 2024-08-06

* convert to only use `iframe`
* use Google Doc Viewer for Chrome and mobile
* dynamically render `iframe` in block based on browser
* mitigate [Chromium issue](https://issues.chromium.org/issues/40063550) by rendering PDF with Google Doc Viewer
* thanks to @costdev for helping with dynamic block rendering

#### 2.3.1 / 2023-09-10

* update GA
* update tested to

#### 2.3.0 / 2021-07-07

* add @10up GitHub Actions integration for WordPress SVN

#### 2.2.0 / 2021-03-05

* update Toolbar to ToolbarGroup and ToolbarButton
* add limited support for block alignment toolbar
* fixes for i18n in block
* exclude `/build` from `make-pot` in `composer.json`, doesn’t work with minimized JS

#### 2.1.2 / 2020-09-15

* use same *block name* for oembed
* add additional dependencies to enqueue

### 2.1.1 / 2020-07-20

* update block for deprecated items and minor errors
* update media selector for only PDFs

#### 2.1.0 / 2020-07-20

* update block build process
* add title and description attributes for a11y
* add PDF svg for block

#### 2.0.5 / 2020-03-09

* minor updates to plugin structure on GitHub
* update tested to

#### 2.0.4 / 2019-10-05

* fixed [PDF upload within block](https://wordpress.org/support/topic/uploading-from-within-block-doesnt-work/)

#### 2.0.3 / 2019-04-25

* move block registration to it’s own function and hook
* WPCS updates

#### 2.0.2 / 2019-02-03

* update WordPress requirements

#### 2.0.1 / 2019-01-11

* added `composer.json` and automatically create POT with `composer update`
* added check for `register_block_type()` for WP 4.9.x and below

#### 2.0.0 / 2018-12-20 🎂

* a proper PDF block was added with much help from [Alex Kirk](https://github.com/akirk), many thanks

#### 1.6.1 / 2018-11-25

* properly initialize `load_plugin_textdomain()`

#### 1.6.0 / 2018-07-22

* added filter `embed_pdf_viewer_pdf_attributes`
* updated `readme.txt` to include `Requires PHP` header
* added paragraph tag around link to PDF

#### 1.5.0 / 2016-12-17

* added CSS to fallback to `iframe` on iOS as `object` isn’t scrollable 😛

#### 1.4.0

* switch to using `object` tag, with `iframe` as fallback display method

#### 1.3.0

* inserting anything other than PDF from Media Library now works as expected.

#### 1.2.1

* fixed a couple of PHP warnings

#### 1.2.0

* inserting a PDF from the Media Library now simply inserts the URL for oEmbed
* oEmbed a PDF from any source

#### 1.1.2

* simplify `instance()` just a little more

#### 1.1.1

* rename instance variable to `$instance` and make private
* update DocBlocks
* ensure `$atts` is an array

#### 1.1

* bugfix for not returning media item when not PDF, Bad Andy 🙁

#### 1.0.1

* add to DocBlocks

#### 1.0

* refactor to put embed code in one function
* add assets

#### 0.1

* initial commit

## Meta

* Version **2.4.6**
* Last updated **2 months ago**
* Active installations **20,000+**
* WordPress version **6.0 or higher**
* Tested up to **6.7.1**
* PHP version **7.4 or higher**
* Languages
  See all 11

  Close

  [Chinese (China)](https://cn.wordpress.org/plugins/embed-pdf-viewer/), [Chinese (Taiwan)](https://tw.wordpress.org/plugins/embed-pdf-viewer/), [Danish](https://da.wordpress.org/plugins/embed-pdf-viewer/), [Dutch](https://nl.wordpress.org/plugins/embed-pdf-viewer/), [English (US)](https://wordpress.org/plugins/embed-pdf-viewer/), [Italian](https://it.wordpress.org/plugins/embed-pdf-viewer/), [Japanese](https://ja.wordpress.org/plugins/embed-pdf-viewer/), [Russian](https://ru.wordpress.org/plugins/embed-pdf-viewer/), [Spanish (Spain)](https://es.wordpress.org/plugins/embed-pdf-viewer/), [Swedish](https://sv.wordpress.org/plugins/embed-pdf-viewer/), and [Ukrainian](https://uk.wordpress.org/plugins/embed-pdf-viewer/).

  [Translate into your language](https://translate.wordpress.org/projects/wp-plugins/embed-pdf-viewer)
* Tags [block](https://wordpress.org/plugins/tags/block/)[embed](https://wordpress.org/plugins/tags/embed/)[oembed](https://wordpress.org/plugins/tags/oembed/)[pdf](https://wordpress.org/plugins/tags/pdf/)[viewer](https://wordpress.org/plugins/tags/viewer/)
* [Advanced View](https://wordpress.org/plugins/embed-pdf-viewer/advanced/)

## Ratings

4.7 out of 5 stars.

* [16 5-star reviews
  5 stars

  16](https://wordpress.org/support/plugin/embed-pdf-viewer/reviews/?filter=5)
* [1 4-star review
  4 stars

  1](https://wordpress.org/support/plugin/embed-pdf-viewer/reviews/?filter=4)
* [2 3-star reviews
  3 stars

  2](https://wordpress.org/support/plugin/embed-pdf-viewer/reviews/?filter=3)
* [0 2-star reviews
  2 stars

  0](https://wordpress.org/support/plugin/embed-pdf-viewer/reviews/?filter=2)
* [0 1-star reviews
  1 star

  0](https://wordpress.org/support/plugin/embed-pdf-viewer/reviews/?filter=1)

[Add my review](https://wordpress.org/support/plugin/embed-pdf-viewer/reviews/#new-post)

[See all reviews](https://wordpress.org/support/plugin/embed-pdf-viewer/reviews/)

## Contributors

* ![](https://secure.gravatar.com/avatar/82779a185fccde41e1dd3b914bde84cd6be76c8dcb8f6b983f461c8f5687a87e?s=32&d=mm&r=g) [Andy Fragen](https://profiles.wordpress.org/afragen/)
* ![](https://secure.gravatar.com/avatar/12b93d2a2baed035aa99f0cfbc4f00f3ed5d8a59563694910bcdffbccb5fa256?s=32&d=mm&r=g) [Alex Kirk](https://profiles.wordpress.org/akirk/)
* ![](https://secure.gravatar.com/avatar/737c2df3eecd59128718fa1f089e99f9463e664b51920f15bf781b2578015a2f?s=32&d=mm&r=g) [Colin Stewart](https://profiles.wordpress.org/costdev/)
## Support

Issues resolved in last two months:

0 out of 1

[View support forum](https://wordpress.org/support/plugin/embed-pdf-viewer/)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Privacy](https://wordpress.org/about/privacy/)

* [Showcase](https://wordpress.org/showcase/)
* [Themes](https://wordpress.org/themes/)
* [Plugins](https://wordpress.org/plugins/)
* [Patterns](https://wordpress.org/patterns/)

* [Learn](https://learn.wordpress.org/)
* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [WordPress.tv ↗](https://wordpress.tv/)

* [Get Involved](https://make.wordpress.org/)
* [Events](https://events.wordpress.org/)
* [Donate ↗](https://wordpressfoundation.org/donate/)
* [Five for the Future](https://wordpress.org/five-for-the-future/)

* [WordPress.com ↗](https://wordpress.com/?ref=wporg-footer)
* [Matt ↗](https://ma.tt/)
* [bbPress ↗](https://bbpress.org/)
* [BuddyPress ↗](https://buddypress.org/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our X (formerly Twitter) account](https://www.x.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)
* [Visit our YouTube channel](https://www.youtube.com/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)



=== Content from www.wordfence.com_1a045c0d_20250110_162214.html ===


[![](https://www.wordfence.com/img/wordfence-intelligence-logo.svg)](/threat-intel/)

Have you found a vulnerability in a WordPress plugin or theme? Report vulnerabilities in WordPress plugins and themes through our [bug bounty program](https://www.wordfence.com/threat-intel/bug-bounty-program) and earn a bounty on all in-scope submissions, while we handle the responsible disclosure process on your behalf.

As a reminder, the Wordfence Intelligence Vulnerability Database API is completely free to query and utilize, both personally and commercially, and contains all the same vulnerability data as the user interface. Please review the API documentation and Webhook documentation for more information on how to query the vulnerability API endpoints and configure webhooks utilizing all the same data present in the Wordfence Intelligence user interface.

# Embed PDF Viewer <= 2.4.4 - Authenticated (Contributor+) Stored Cross-Site Scripting via height and width Parameters

 [Wordfence Intelligence](https://www.wordfence.com/threat-intel)   >    [Vulnerability Database](https://www.wordfence.com/threat-intel/vulnerabilities)   >   Embed PDF Viewer <= 2.4.4 - Authenticated (Contributor+) Stored Cross-Site Scripting via height and width Parameters

6.4

**Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')**
**CVSS Vector**
[CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:N)

| CVE | [CVE-2024-9451](https://www.cve.org/CVERecord?id=CVE-2024-9451) |
| --- | --- |
| CVSS | 6.4 (Medium) |
| Publicly Published | October 8, 2024 |
| Last Updated | October 9, 2024 |
| Researcher | [tjoffe](https://www.wordfence.com/threat-intel/vulnerabilities/researchers/christofer-roth) |

### Description

The Embed PDF Viewer plugin for WordPress is vulnerable to Stored Cross-Site Scripting via the 'height' and 'width' parameters in all versions up to, and including, 2.4.4 due to insufficient input sanitization and output escaping. This makes it possible for authenticated attackers, with Contributor-level access and above, to inject arbitrary web scripts in pages that will execute whenever a user accesses an injected page.

#### References

* [plugins.trac.wordpress.org](https://plugins.trac.wordpress.org/browser/embed-pdf-viewer/trunk/embed-pdf-viewer.php#L258)
* [plugins.trac.wordpress.org](https://plugins.trac.wordpress.org/browser/embed-pdf-viewer/trunk/embed-pdf-viewer.php#L144)
* [wordpress.org](https://wordpress.org/plugins/embed-pdf-viewer/#developers)
* [plugins.trac.wordpress.org](https://plugins.trac.wordpress.org/changeset/3164573/)

#### Share

[Facebook](https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fembed-pdf-viewer%2Fembed-pdf-viewer-244-authenticated-contributor-stored-cross-site-scripting-via-height-and-width-parameters&t=Embed%20PDF%20Viewer%20%3C%3D%202.4.4%20-%20Authenticated%20%28Contributor%2B%29%20Stored%20Cross-Site%20Scripting%20via%20height%20and%20width%20Parameters "Facebook")
[Twitter](https://twitter.com/share?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fembed-pdf-viewer%2Fembed-pdf-viewer-244-authenticated-contributor-stored-cross-site-scripting-via-height-and-width-parameters&text=Embed%20PDF%20Viewer%20%3C%3D%202.4.4%20-%20Authenticated%20%28Contributor%2B%29%20Stored%20Cross-Site%20Scripting%20via%20height%20and%20width%20Parameters "Twitter")
[LinkedIn](https://www.linkedin.com/shareArticle?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fembed-pdf-viewer%2Fembed-pdf-viewer-244-authenticated-contributor-stored-cross-site-scripting-via-height-and-width-parameters "LinkedIn")
Email

## Vulnerability Details for Embed PDF Viewer

#### [Embed PDF Viewer](https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/embed-pdf-viewer)

| Software Type | Plugin |
| --- | --- |
| Software Slug | embed-pdf-viewer [(view on wordpress.org)](https://wordpress.org/plugins/embed-pdf-viewer) |
| Patched? | Yes |
| Remediation | Update to version 2.4.5, or a newer patched version |
| Affected Version | * <= 2.4.4 |
| Patched Version | * 2.4.5 |

This record contains material that is subject to copyright.

**Copyright 2012-2025 Defiant Inc.**

**License:**
Defiant hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute this software vulnerability information. Any copy of the software vulnerability information you make for such purposes is authorized provided that you include a hyperlink to this vulnerability record and reproduce Defiant's copyright designation and this license in any such copy.
**[Read more.](https://www.wordfence.com/wordfence-intelligence-terms-and-conditions/)**

**Copyright 1999-2025 The MITRE Corporation**

**License:**
CVE Usage: MITRE hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute Common Vulnerabilities and Exposures (CVE®). Any copy you make for such purposes is authorized provided that you reproduce MITRE's copyright designation and this license in any such copy.
**[Read more.](https://www.cve.org/Legal/TermsOfUse)**

Have information to add, or spot any errors? Contact us at wfi-support@wordfence.com so we can make any appropriate adjustments.

Did you know Wordfence Intelligence provides free personal and commercial API access to our comprehensive WordPress vulnerability database, along with a free webhook integration to stay on top of the latest vulnerabilities added and updated in the database? Get started today!

Learn more

Want to get notified of the latest vulnerabilities that may affect your WordPress site?
 Install Wordfence on your site today to get notified immediately if your site is affected by a vulnerability that has been added to our database.

Get Wordfence

The Wordfence Intelligence WordPress vulnerability database is completely free to access and query via API. Please review the documentation on how to access and consume the vulnerability data via API.

Documentation



=== Content from plugins.trac.wordpress.org_b8ea56aa_20250110_162211.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fbrowser%2Fembed-pdf-viewer%2Ftrunk%2Fembed-pdf-viewer.php)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Revision](/browser/embed-pdf-viewer/trunk/embed-pdf-viewer.php?rev=3164573 "Revision 3164573")
* Next Revision →
* [Blame](/browser/embed-pdf-viewer/trunk/embed-pdf-viewer.php?annotate=blame "Annotate each line with the last changed revision (this can be time consuming...)")
* [Revision Log](/log/embed-pdf-viewer/trunk/embed-pdf-viewer.php)

---

# [source:](/browser?order=name "Go to repository root") [embed-pdf-viewer](/browser/embed-pdf-viewer?order=name "View embed-pdf-viewer")/[trunk](/browser/embed-pdf-viewer/trunk?order=name "View trunk")/[embed-pdf-viewer.php](/browser/embed-pdf-viewer/trunk/embed-pdf-viewer.php?order=name "View embed-pdf-viewer.php")

View diff against:

View revision:

| [Last change](/changeset/3180138/embed-pdf-viewer/trunk/embed-pdf-viewer.php "View differences") on this file was [3180138](/changeset/3180138/ "View changeset 3180138"), checked in by afragen, [2 months ago](/timeline?from=2024-11-01T18%3A21%3A53Z&precision=second "See timeline at 11/01/2024 06:21:53 PM") |
| --- |
| Update to version 2.4.6 from GitHub |
| **File size:** 7.6 KB | |

| Line |  |
| --- | --- |
| [1](#L1) | <?php |
| [2](#L2) | /\*\* |
| [3](#L3) | \* Embed PDF Viewer |
| [4](#L4) | \* |
| [5](#L5) | \* @author  Andy Fragen |
| [6](#L6) | \* @license GPL-2.0+ |
| [7](#L7) | \* @link    https://github.com/afragen/embed-pdf-viewer |
| [8](#L8) | \* @package embed-pdf-viewer |
| [9](#L9) | \*/ |
| [10](#L10) |  |
| [11](#L11) | /\*\* |
| [12](#L12) | \* Plugin Name:       Embed PDF Viewer |
| [13](#L13) | \* Plugin URI:        https://github.com/afragen/embed-pdf-viewer |
| [14](#L14) | \* Description:       Embed a PDF from the Media Library or elsewhere via oEmbed or as a block into an `iframe` tag. |
| [15](#L15) | \* Author:            Andy Fragen |
| [16](#L16) | \* Author URI:        https://github.com/afragen |
| [17](#L17) | \* Version:           2.4.6 |
| [18](#L18) | \* License:           GPLv2+ |
| [19](#L19) | \* Domain Path:       /languages |
| [20](#L20) | \* Text Domain:       embed-pdf-viewer |
| [21](#L21) | \* License URI:       http://www.gnu.org/licenses/gpl-2.0.html |
| [22](#L22) | \* GitHub Plugin URI: https://github.com/afragen/embed-pdf-viewer |
| [23](#L23) | \* Requires PHP:      7.4 |
| [24](#L24) | \* Requires at least: 6.0 |
| [25](#L25) | \*/ |
| [26](#L26) |  |
| [27](#L27) | /\*\* |
| [28](#L28) | \* Exit if called directly. |
| [29](#L29) | \*/ |
| [30](#L30) | if ( ! defined( 'WPINC' ) ) { |
| [31](#L31) | die; |
| [32](#L32) | } |
| [33](#L33) |  |
| [34](#L34) | $epd\_version = get\_file\_data( \_\_FILE\_\_, [ 'Version' => 'version' ] )['Version']; |
| [35](#L35) | add\_filter( 'media\_send\_to\_editor', [ Embed\_PDF\_Viewer::instance( $epd\_version ), 'embed\_pdf\_media\_editor' ], 20, 2 ); |
| [36](#L36) | wp\_embed\_register\_handler( |
| [37](#L37) | 'oembed\_pdf\_viewer', |
| [38](#L38) | '#(^(https?)\:\/\/.+\.pdf$)#i', |
| [39](#L39) | [ |
| [40](#L40) | Embed\_PDF\_Viewer::instance( $epd\_version ), |
| [41](#L41) | 'oembed\_pdf\_viewer', |
| [42](#L42) | ] |
| [43](#L43) | ); |
| [44](#L44) | add\_action( |
| [45](#L45) | 'init', |
| [46](#L46) | function () use ( $epd\_version ) { |
| [47](#L47) | wp\_set\_script\_translations( 'embed-pdf-viewer-scripts', 'embed-pdf-viewer' ); |
| [48](#L48) |  |
| [49](#L49) | // phpcs:ignore WordPress.WP.EnqueuedResourceParameters.NoExplicitVersion |
| [50](#L50) | wp\_enqueue\_style( |
| [51](#L51) | 'embed-pdf-viewer', |
| [52](#L52) | plugins\_url( 'css/embed-pdf-viewer.css', \_\_FILE\_\_ ), |
| [53](#L53) | [], |
| [54](#L54) | $epd\_version, |
| [55](#L55) | 'screen' |
| [56](#L56) | ); |
| [57](#L57) | } |
| [58](#L58) | ); |
| [59](#L59) | add\_action( 'init', [ Embed\_PDF\_Viewer::instance( $epd\_version ), 'register\_block' ] ); |
| [60](#L60) |  |
| [61](#L61) | /\*\* |
| [62](#L62) | \* Class Embed\_PDF\_Viewer |
| [63](#L63) | \*/ |
| [64](#L64) | class Embed\_PDF\_Viewer { |
| [65](#L65) | /\*\* |
| [66](#L66) | \* For singleton. |
| [67](#L67) | \* |
| [68](#L68) | \* @var bool |
| [69](#L69) | \*/ |
| [70](#L70) | private static $instance = false; |
| [71](#L71) |  |
| [72](#L72) | /\*\* |
| [73](#L73) | \* Plugin version number. |
| [74](#L74) | \* |
| [75](#L75) | \* @var string |
| [76](#L76) | \*/ |
| [77](#L77) | private static $version = ''; |
| [78](#L78) |  |
| [79](#L79) | /\*\* |
| [80](#L80) | \* Create singleton. |
| [81](#L81) | \* |
| [82](#L82) | \* @param string $version Plugin version number. |
| [83](#L83) | \* @return bool |
| [84](#L84) | \*/ |
| [85](#L85) | public static function instance( $version ) { |
| [86](#L86) | static::$version = $version; |
| [87](#L87) | if ( false === static::$instance ) { |
| [88](#L88) | static::$instance = new self( $version ); |
| [89](#L89) | } |
| [90](#L90) |  |
| [91](#L91) | return static::$instance; |
| [92](#L92) | } |
| [93](#L93) |  |
| [94](#L94) | /\*\* |
| [95](#L95) | \* Register block. |
| [96](#L96) | \* |
| [97](#L97) | \* @return void |
| [98](#L98) | \*/ |
| [99](#L99) | public function register\_block() { |
| [100](#L100) | if ( ! function\_exists( 'register\_block\_type' ) ) { |
| [101](#L101) | return; |
| [102](#L102) | } |
| [103](#L103) |  |
| [104](#L104) | // phpcs:ignore WordPress.WP.EnqueuedResourceParameters.NoExplicitVersion |
| [105](#L105) | wp\_register\_script( |
| [106](#L106) | 'embed-pdf-viewer', |
| [107](#L107) | plugins\_url( 'blocks/build/index.js', \_\_FILE\_\_ ), |
| [108](#L108) | [ 'wp-i18n', 'wp-blocks', 'wp-block-editor', 'wp-element', 'wp-components', 'wp-compose', 'wp-blob' ], |
| [109](#L109) | static::$version, |
| [110](#L110) | true |
| [111](#L111) | ); |
| [112](#L112) |  |
| [113](#L113) | register\_block\_type( |
| [114](#L114) | 'embed-pdf-viewer/pdf', |
| [115](#L115) | [ |
| [116](#L116) | 'editor\_script'   => 'embed-pdf-viewer', |
| [117](#L117) | 'render\_callback' => [ static::$instance, 'dynamic\_render\_callback' ], |
| [118](#L118) | ] |
| [119](#L119) | ); |
| [120](#L120) | } |
| [121](#L121) |  |
| [122](#L122) | /\*\* |
| [123](#L123) | \* Dynamically render callback based on browser. |
| [124](#L124) | \* |
| [125](#L125) | \* @global bool $is\_chrome Tests for Chrome browser. |
| [126](#L126) | \* |
| [127](#L127) | \* @param array $attributes Array of attributes. |
| [128](#L128) | \* |
| [129](#L129) | \* @return string |
| [130](#L130) | \*/ |
| [131](#L131) | public function dynamic\_render\_callback( $attributes ) { |
| [132](#L132) | global $is\_chrome; |
| [133](#L133) |  |
| [134](#L134) | $url = $attributes['url'] ?? null; |
| [135](#L135) | if ( ! $url ) { |
| [136](#L136) | return ''; |
| [137](#L137) | } |
| [138](#L138) |  |
| [139](#L139) | $classes     = 'embed-pdf-viewer'; |
| [140](#L140) | $src         = $is\_chrome || wp\_is\_mobile() ? 'https://docs.google.com/viewer?url=' . rawurlencode( $url ) . '&embedded=true' : $url; |
| [141](#L141) | $description = $attributes['title'] ?? ''; |
| [142](#L142) | $description = $attributes['description'] ?? $description; |
| [143](#L143) | $width       = $attributes['width'] ?? '600'; |
| [144](#L144) | $height      = $attributes['height'] ?? '600'; |
| [145](#L145) | return sprintf( |
| [146](#L146) | '<iframe class="%1$s" src="%2$s" height="%3$s" width="%4$s" title="%5$s"%6$s></iframe>', |
| [147](#L147) | $classes, |
| [148](#L148) | sanitize\_url( $src ), |
| [149](#L149) | esc\_attr( $width ), |
| [150](#L150) | esc\_attr( $height ), |
| [151](#L151) | esc\_attr( $description ), |
| [152](#L152) | $is\_chrome || wp\_is\_mobile() ? ' frameborder="0"' : '' |
| [153](#L153) | ); |
| [154](#L154) | } |
| [155](#L155) |  |
| [156](#L156) | /\*\* |
| [157](#L157) | \* Insert URL to PDF from Media Library, then render as oEmbed. |
| [158](#L158) | \* |
| [159](#L159) | \* @param string  $html an href link to the media. |
| [160](#L160) | \* @param integer $id   post\_id. |
| [161](#L161) | \* |
| [162](#L162) | \* @return string |
| [163](#L163) | \*/ |
| [164](#L164) | public function embed\_pdf\_media\_editor( $html, $id ) { |
| [165](#L165) | $post = get\_post( $id ); |
| [166](#L166) | if ( 'application/pdf' !== $post->post\_mime\_type ) { |
| [167](#L167) | return $html; |
| [168](#L168) | } |
| [169](#L169) |  |
| [170](#L170) | return $post->guid . "\n\n"; |
| [171](#L171) | } |
| [172](#L172) |  |
| [173](#L173) | /\*\* |
| [174](#L174) | \* Create oEmbed code. |
| [175](#L175) | \* |
| [176](#L176) | \* @param array  $matches Regex matches. |
| [177](#L177) | \* @param array  $atts    array of media height/width. |
| [178](#L178) | \* @param string $url     URI for media file. |
| [179](#L179) | \* |
| [180](#L180) | \* @return string|WP\_Error |
| [181](#L181) | \*/ |
| [182](#L182) | public function oembed\_pdf\_viewer( $matches, $atts, $url ) { |
| [183](#L183) | $attachment\_id = $this->get\_attachment\_id\_by\_url( $url ); |
| [184](#L184) | if ( ! empty( $attachment\_id ) ) { |
| [185](#L185) | $post = get\_post( $this->get\_attachment\_id\_by\_url( $url ) ); |
| [186](#L186) | } else { |
| [187](#L187) | /\* |
| [188](#L188) | \* URL is from outside of the Media Library. |
| [189](#L189) | \*/ |
| [190](#L190) | $response = wp\_remote\_get( $url ); |
| [191](#L191) | if ( is\_wp\_error( $response ) ) { |
| [192](#L192) | return $response; |
| [193](#L193) | } |
| [194](#L194) | $post                 = new WP\_Post( new stdClass() ); |
| [195](#L195) | $post->guid           = $matches[0]; |
| [196](#L196) | $post->post\_mime\_type = wp\_remote\_retrieve\_header( $response, 'content-type' ); |
| [197](#L197) | $post->post\_name      = preg\_replace( '/\.pdf$/', '', basename( $matches[0] ) ); |
| [198](#L198) | } |
| [199](#L199) |  |
| [200](#L200) | return $this->create\_output( $post, $atts ); |
| [201](#L201) | } |
| [202](#L202) |  |
| [203](#L203) | /\*\* |
| [204](#L204) | \* Create output for iframe and/or Google Doc Viewer and href link to file. |
| [205](#L205) | \* |
| [206](#L206) | \* @param \WP\_Post     $post Current post. |
| [207](#L207) | \* @param array|string $atts array of media height/width or |
| [208](#L208) | \*                           href to media library asset. |
| [209](#L209) | \* |
| [210](#L210) | \* @return bool|string |
| [211](#L211) | \*/ |
| [212](#L212) | private function create\_output( WP\_Post $post, $atts = [] ) { |
| [213](#L213) | global $is\_chrome; |
| [214](#L214) |  |
| [215](#L215) | if ( 'application/pdf' !== $post->post\_mime\_type ) { |
| [216](#L216) | return $atts; |
| [217](#L217) | } |
| [218](#L218) |  |
| [219](#L219) | $default = [ |
| [220](#L220) | 'height'      => 500, |
| [221](#L221) | 'width'       => 800, |
| [222](#L222) | 'title'       => $post->post\_title, |
| [223](#L223) | 'description' => $post->post\_content, |
| [224](#L224) | ]; |
| [225](#L225) |  |
| [226](#L226) | /\* |
| [227](#L227) | \* Ensure $atts isn't the href. |
| [228](#L228) | \*/ |
| [229](#L229) | $atts = is\_array( $atts ) ? $atts : []; |
| [230](#L230) |  |
| [231](#L231) | if ( isset( $atts['width'] ) ) { |
| [232](#L232) | $atts['width'] = '100%'; |
| [233](#L233) | } |
| [234](#L234) | $atts = array\_merge( $default, $atts ); |
| [235](#L235) |  |
| [236](#L236) | /\*\* |
| [237](#L237) | \* Filter PDF attributes. |
| [238](#L238) | \* |
| [239](#L239) | \* @since 1.6.0 |
| [240](#L240) | \* @param  array $atts Array of PDF attributes. |
| [241](#L241) | \* @return array $atts |
| [242](#L242) | \*/ |
| [243](#L243) | $atts = apply\_filters( 'embed\_pdf\_viewer\_pdf\_attributes', $atts ); |
| [244](#L244) |  |
| [245](#L245) | // Fix title or create from filename. |
| [246](#L246) | $atts['title'] = empty( $atts['title'] ) |
| [247](#L247) | ? ucwords( preg\_replace( '/(-|\_)/', ' ', $post->post\_name ) ) |
| [248](#L248) | : ucwords( preg\_replace( '/(-|\_)/', ' ', $atts['title'] ) ); |
| [249](#L249) |  |
| [250](#L250) | $description   = ! empty( $atts['description'] ) ? $atts['description'] : $atts['title']; |
| [251](#L251) | $sanitized\_url = sanitize\_url( $post->guid ); |
| [252](#L252) |  |
| [253](#L253) | if ( $is\_chrome || wp\_is\_mobile() ) { |
| [254](#L254) | $iframe  = '<iframe class="embed-pdf-viewer" src="https://docs.google.com/viewer?url=' . rawurlencode( $sanitized\_url ); |
| [255](#L255) | $iframe .= '&amp;embedded=true" frameborder="0" '; |
| [256](#L256) | } else { |
| [257](#L257) | $iframe = '<iframe class="embed-pdf-viewer" src="' . $sanitized\_url . '" '; |
| [258](#L258) | } |
| [259](#L259) | $iframe .= 'height="' . esc\_attr( $atts['height'] ) . '" width="' . esc\_attr( $atts['width'] ) . '" '; |
| [260](#L260) | $iframe .= 'title="' . esc\_attr( $description ) . '"></iframe>' . "\n"; |
| [261](#L261) |  |
| [262](#L262) | $embed  = '<div>'; |
| [263](#L263) | $embed .= $iframe; |
| [264](#L264) | $embed .= '<p><a href="' . $sanitized\_url . '" title="' . esc\_attr( $description ) . '">' . esc\_html( $description ) . '</a></p>'; |
| [265](#L265) | $embed .= '</div>'; |
| [266](#L266) |  |
| [267](#L267) | return $embed; |
| [268](#L268) | } |
| [269](#L269) |  |
| [270](#L270) | /\*\* |
| [271](#L271) | \* Get attachment id by url. Thanks Pippin. |
| [272](#L272) | \* |
| [273](#L273) | \* @link  https://pippinsplugins.com/retrieve-attachment-id-from-image-url/ |
| [274](#L274) | \* |
| [275](#L275) | \* @param string $url URI of attachment. |
| [276](#L276) | \* |
| [277](#L277) | \* @return mixed |
| [278](#L278) | \*/ |
| [279](#L279) | private function get\_attachment\_id\_by\_url( $url ) { |
| [280](#L280) | global $wpdb; |
| [281](#L281) | // phpcs:ignore WordPress.DB |
| [282](#L282) | $attachment = $wpdb->get\_col( $wpdb->prepare( "SELECT ID FROM $wpdb->posts WHERE guid='%s';", $url ) ); |
| [283](#L283) |  |
| [284](#L284) | if ( empty( $attachment ) ) { |
| [285](#L285) | return null; |
| [286](#L286) | } |
| [287](#L287) |  |
| [288](#L288) | return $attachment[0]; |
| [289](#L289) | } |
| [290](#L290) | } |

**Note:** See [TracBrowser](/wiki/TracBrowser)
for help on using the repository browser.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Plain Text](/browser/embed-pdf-viewer/trunk/embed-pdf-viewer.php?format=txt)
* [Original Format](/export/3220326/embed-pdf-viewer/trunk/embed-pdf-viewer.php)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)


