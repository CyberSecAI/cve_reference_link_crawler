This document contains vulnerability information for CVE-2022-40997.

**Root cause of vulnerability:**
The root cause is a stack-based buffer overflow vulnerability in the `DetranCLI` command parsing functionality. Specifically, the `sprintf` function is used to format command parameters into a stack buffer without proper size checks, leading to a buffer overflow when the input parameter's length exceeds the buffer's capacity.

**Weaknesses/vulnerabilities present:**
The weakness is a classic buffer overflow (CWE-120). The `sprintf` function is used to construct a string on the stack, with parameters taken directly from user input. No validation on the size of the input is performed before copying it to the stack buffer.

**Impact of exploitation:**
Successful exploitation can lead to arbitrary command execution on the device. An attacker can potentially gain full control of the router.

**Attack vectors:**
The attack vector is sending a specially crafted network packet to the device to trigger the vulnerable command. Specifically, the `gre index` command with a long string as the description parameter.

**Required attacker capabilities/position:**
An attacker needs to be able to send network packets to the device and have the ability to issue commands through the `DetranCLI` interface. The CVSS score indicates that the attacker needs high privileges to exploit this.

**Details specific to CVE-2022-40997:**
The specific vulnerable command is:

```
gre index <1-8> destination A.B.C.D/M description (WORD|null)
```
The vulnerable code snippet is:
```
sprintf(buff_0x80,"%d<%s<%s<%s>",1,*argv,argv[1],argv[2]);
```
The `argv[2]` parameter, corresponding to the `description` parameter in the command, is copied into `buff_0x80` without size checks.