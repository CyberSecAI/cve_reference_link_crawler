=== Content from hoyahaxa.blogspot.com_11ae1bec_20250108_131500.html ===


[![HoyaHaxa: A Security Research Blog](https://blogger.googleusercontent.com/img/a/AVvXsEhUCgr_s5i1lLMG8jSrZDgwfmOD0xvQEZ_4EtG19YgYDsjMJAV6B6IZErmSF8wXxJ4410IGeo2zlsVErr1Bwn2wjLVmIfGC4Bz4IFNS-fut8rnTuYn59wu61C0IMcEcEeUBd149LUZmCZ-SIcaLSXxunTA5_tCsc4kTCzQkd4hRjDFzCJolIAbvHVFQ=s1181)](https://www.hoyahaxa.com/)

## Monday, March 6, 2023

### Authentication Bypass Vulnerability in Mura CMS and Masa CMS (CVE-2022-47003 and CVE-2022-47002)

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhOQY-qrrnbfMWzR93XoKgbXWkV4a2AY7NtcOlk9T69mPuow6nU6l3Ua9ApVPaT7Cv97i97nhGR1E682W9eGsEKAZI12eOe6qHwtOPK5nqZ9YsdmwViDlcNsAByWAIyS_ggbhBvAVjjbTwSfCEMtZIMR-wOSuV63AEGjwarXTT7eR7tp69yEaA77A85/w523-h152/mura-masa.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhOQY-qrrnbfMWzR93XoKgbXWkV4a2AY7NtcOlk9T69mPuow6nU6l3Ua9ApVPaT7Cv97i97nhGR1E682W9eGsEKAZI12eOe6qHwtOPK5nqZ9YsdmwViDlcNsAByWAIyS_ggbhBvAVjjbTwSfCEMtZIMR-wOSuV63AEGjwarXTT7eR7tp69yEaA77A85/s1028/mura-masa.png)
###

### Background

[Mura CMS](https://www.murasoftware.com/mura-cms/) is a popular content management system written in ColdFusion/CFML. While it was originally a commercial open source product, it was re-licensed as a closed source application with the release of Mura CMS v10 in 2020.  There are forked open source projects based on the last open source release of Mura CMS, including [Masa CMS](https://www.masacms.com/) - which is actively maintained.
Multiple versions of Mura CMS and Masa CMS contain an authentication bypass vulnerability that can allow an unauthenticated attacker to login as any Site Member or System User.

### **Vulnerability Summary**

**[CVE-2022-47003](https://nvd.nist.gov/vuln/detail/CVE-2022-47003)** - Authentication Bypass Vulnerability in Mura CMS**Impact:**  An unauthenticated attacker is able to login as any Mura Site Member or Mura System User**Fixed Version(s):** Mura CMS v10.0.580 and later
**[CVE-2022-47002](https://nvd.nist.gov/vuln/detail/CVE-2022-47002)** - Authentication Bypass Vulnerability in Masa CMS**Impact:** An unauthenticated attacker is able to login as any Masa Site Member or Masa System User**Fixed Version(s):** Masa CMS v7.2.5, Masa CMS v7.3.10, Masa v7.4.0-beta.3 and later

### Technical Details

The root cause of the authentication bypass vulnerability is a conditional logic flaw in the “remember me” functionality.  The "remember me" functionality is designed to create a cookie with an encrypted value after a successful login, that will be validated at a later time and automatically log the user back into a site after their session has expired:
[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgPBARAry21B63Ui9ULeM6JpC33rCWCqEGwGlNBjA-2BCIC8KN9hvU_iocIv7v-IYxS-kDGz5LlXIeSGj7Rhl4itjKu5QyFpXb1YwZ4t3QRHBoaobtP4_8Wg41u7LastW7f9Dfb4LqFG6U3BdEfa4Z-eEzz-vGZXw1nymoMar4IE8FvSVRo9Pb6AB3S/w333-h281/rememberme.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgPBARAry21B63Ui9ULeM6JpC33rCWCqEGwGlNBjA-2BCIC8KN9hvU_iocIv7v-IYxS-kDGz5LlXIeSGj7Rhl4itjKu5QyFpXb1YwZ4t3QRHBoaobtP4_8Wg41u7LastW7f9Dfb4LqFG6U3BdEfa4Z-eEzz-vGZXw1nymoMar4IE8FvSVRo9Pb6AB3S/s528/rememberme.png)
Moving between Mura and Masa, open source and closed source, and version to version – there are likely to be subtle and not-so-subtle differences in the codebases.  However, the relevant portions should all be the same, even if the line numbers are different.
Let’s first identify all the relevant code, starting with /core/appcfc/onRequestStart\_include.cfm, using the following branch as an example:  <https://github.com/MasaCMS/MasaCMS/blob/ea9dd65d88ba55d5b41131cf355778a6529ff42a/core/appcfc/onRequestStart_include.cfm#L223-L224>

[...] if ( isDefined('cookie.userid') && cookie.userid != '' && !sessionData.mura.isLoggedIn ) {application.loginManager.rememberMe(cookie.userid, decrypt(cookie.userHash,application.userManager.readUserPassword(cookie.userid),"cfmx\_compat",'hex')); } [...]

And the rememberMe() function, from /core/mura/login/loginManager.cfc, using this branch: <https://github.com/MasaCMS/MasaCMS/blob/ea9dd65d88ba55d5b41131cf355778a6529ff42a/core/mura/login/loginManager.cfc#L90-L106>
[...] public boolean function rememberMe(required string userid="", required string userHash="") output=false { var rsUser=variables.userDAO.readUserHash(arguments.userid); var isLoggedin=0; var sessionData=getSession();if ( !len(arguments.userHash) || arguments.userHash == rsUser.userHash ) {
          isloggedin=variables.userUtility.loginByUserID(rsUser.userID,          rsUser.siteID); } if ( isloggedin ) { sessionData.rememberMe=1; return true; } else { variables.globalUtility.deleteCookie(name="userHash"); variables.globalUtility.deleteCookie(name="userid"); sessionData.rememberMe=0; return false; } }[...]

Now let’s figure out what’s going on, starting at this portion of onRequestStart\_include.cfm:
if ( isDefined('cookie.userid') && cookie.userid != '' && !sessionData.mura.isLoggedIn ) {
We should flow into the code above if our request has a non-empty “userid” cookie and if our session isn’t logged in.
Next –
application.loginManager.rememberMe(cookie.userid, decrypt(cookie.userHash,application.userManager.readUserPassword(cookie.userid),"cfmx\_compat",'hex'));

We’ll pass in our “userid” cookie and the result of the decrypt() call to the rememberMe() function.  The decrypt() call will attempt to decrypt the value “userHash” cookie, using the password for the user identified in the “userid” cookie (assuming a valid user) as the key.
And what does the rememberMe() function do?  First it creates the rsUser object (again, based on the value of the “userid” cookie) and sets up some other variables -
 var rsUser=variables.userDAO.readUserHash(arguments.userid); var isLoggedin=0; var sessionData=getSession();

and then we wind up here:
if ( !len(arguments.userHash) || arguments.userHash == rsUser.userHash )
This is the conditional logic flaw that we’ll be exploiting – specifically, the highlighted left half of the conditional.  In order to exploit the vulnerability, we need the highlighted conditional to be true – which will happen if arguments.userHash has a length of zero bytes.  And as we recall, argument.userHash is the result of the decrypt() call shown above.
But first let’s take a slight detour and consider some simplified CFML code that is still representative of the application flow that we want to exploit:
<cfscript>myCookie = '';val1 = decrypt(myCookie,'irrelevant', 'cfmx\_compat', 'hex');val2 = 'theRealHashDoesntMatter';
if (!len(val1) || val1 == val2) {   writedump('oops');}</cfscript>

If we can make the length of “val1” (our passed-in arguments.userHash in the real application code) be zero, then we can exploit the application and break the assumed logic here.  If we pass in an empty value for "myCookie", this results in a zero-length decrypted value for "val1".   But will this work?
The Lucee decrypt() function will happily take an empty string for the input to decrypt, and therefore exploitation is possible:

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhLWoBwRle7qnTYd29BoOtk2Y2YWOHdyHDgMt6VUybquPL_yYXtdpY66VdbRS7c08dMC9bOSfqI3D3DzaFhbDYC7fUm1qGIy0lIgOZF27T_-d4DGtgCoX_jBVoM_Yg-5WuQFJudlElDELW8YcsWHZcANh341-Kmoe-_6vcWfnw2Q6I1znoa5-epBdPo/w612-h109/oops2.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhLWoBwRle7qnTYd29BoOtk2Y2YWOHdyHDgMt6VUybquPL_yYXtdpY66VdbRS7c08dMC9bOSfqI3D3DzaFhbDYC7fUm1qGIy0lIgOZF27T_-d4DGtgCoX_jBVoM_Yg-5WuQFJudlElDELW8YcsWHZcANh341-Kmoe-_6vcWfnw2Q6I1znoa5-epBdPo/s1138/oops2.png)

But in Adobe ColdFusion (ACF) we’re out of luck here, since decrypt() will fail if we pass in an empty string:

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhkbNC_KYOOz-8ZibzTso87ZyadNMarwbEszTZClxkwxoff65Z0FHauozV6C_lDjyDeu2WY16xK_OkWN5N1I6BOuy1Ck-R4NSZBF00TsnCBKSITAPfb3XlVfowBMkuKHGkoGzLyi22YhHSsFdsF0Vfoap49SJV81k2FHtZqnMYO0gdG6fpx3Ln7Z5ui/w660-h433/acf-stacktrace.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhkbNC_KYOOz-8ZibzTso87ZyadNMarwbEszTZClxkwxoff65Z0FHauozV6C_lDjyDeu2WY16xK_OkWN5N1I6BOuy1Ck-R4NSZBF00TsnCBKSITAPfb3XlVfowBMkuKHGkoGzLyi22YhHSsFdsF0Vfoap49SJV81k2FHtZqnMYO0gdG6fpx3Ln7Z5ui/s1710/acf-stacktrace.png)
But cross-platform support is important, and wouldn't it be nice if we could get this working against ACF too?  As it turns out, there are a handful of payloads (such as single-character strings) that *will* work in ACF, and result in the decrypted "val1" being a zero-byte string.  Success! *(Note: These payloads do not work on Lucee, because decrypt() complains that they are not valid hexadecimal strings.)*
So if we run our modified sample code in ACF, we see that it now works:
<cfscript>myCookie = 'A';val1 = decrypt(myCookie,'irrelevant', 'cfmx\_compat', 'hex');val2 = 'theRealHashDoesntMatter';
if (!len(val1) || val1 == val2) {   writedump('oops');}</cfscript>

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhLWoBwRle7qnTYd29BoOtk2Y2YWOHdyHDgMt6VUybquPL_yYXtdpY66VdbRS7c08dMC9bOSfqI3D3DzaFhbDYC7fUm1qGIy0lIgOZF27T_-d4DGtgCoX_jBVoM_Yg-5WuQFJudlElDELW8YcsWHZcANh341-Kmoe-_6vcWfnw2Q6I1znoa5-epBdPo/w619-h110/oops2.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhLWoBwRle7qnTYd29BoOtk2Y2YWOHdyHDgMt6VUybquPL_yYXtdpY66VdbRS7c08dMC9bOSfqI3D3DzaFhbDYC7fUm1qGIy0lIgOZF27T_-d4DGtgCoX_jBVoM_Yg-5WuQFJudlElDELW8YcsWHZcANh341-Kmoe-_6vcWfnw2Q6I1znoa5-epBdPo/s1138/oops2.png)

Let’s now go back to the real application code.  If we send a request with a valid "userid" cookie and a blank userHash cookie (assuming Lucee; or with another specially-crafted value for ACF), and we wind up here in the rememberMe() function:
isloggedin=variables.userUtility.loginByUserID(rsUser.userID,rsUser.siteID);
And with that – the application will log us in as the userid passed in the "userid" cookie.
The Mura userid values are randomly generated UUIDs.  While [it’s](https://littlemaninmyhead.wordpress.com/2015/11/22/cautionary-note-uuids-should-generally-not-be-used-for-authentication-tokens/) [well](https://www.coalfire.com/the-coalfire-blog/appsec-concerns-uuid-generation) [established](https://research.nccgroup.com/2021/05/10/using-uuids-for-authorization-is-dangerous-even-if-theyre-cryptographically-random/) that UUIDs alone should not be used as the sole means of authorization, let’s see how practical and likely exploitation can be.  With a large enough user population, we might get lucky and hit on some valid UUIDs via automated requests.  And there may be ways that we can shrink the UUID space or make our guesses more efficient.  But having to brute-force UUIDs isn’t ideal.  However, we can do even better, courtesy of the in the Mura JSON API, which provides an unauthenticated way to extract userid UUIDs:
[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEirmF3-q8cBQM_WpuLpwuzzCyybTfv8Dy6DIwhvQQwEqcVUHUXWWSmEJDenxUmZoyPa75WyhI4LAZdeW2yrjReZ8U8XXwTcWUJc5rRBX4VAR0QXguGEmpAxlRdElK3T_XRapYG9e1GluGo5oMpiek0nK1UOhYSeQr8IJAfjBpnfk7kaGtQ__DOSoQ0i/w629-h215/mura-json.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEirmF3-q8cBQM_WpuLpwuzzCyybTfv8Dy6DIwhvQQwEqcVUHUXWWSmEJDenxUmZoyPa75WyhI4LAZdeW2yrjReZ8U8XXwTcWUJc5rRBX4VAR0QXguGEmpAxlRdElK3T_XRapYG9e1GluGo5oMpiek0nK1UOhYSeQr8IJAfjBpnfk7kaGtQ__DOSoQ0i/s643/mura-json.png)
(And it’s also always a possibility that additional custom application functionality could leak userids in metadata, client-side source code, other locations that would be visible to users.)
We can then use the obtained userid values to send an application request with a valid "userid" cookie and a blank "userHash" cookie (assuming Lucee), and the application will treat this as an authenticated request as that user.  This technique can be used to make an authenticated request to any application page, action, or asset.  As an example, we can now successfully access an Admin User profile page:
**REQUEST:**
GET /admin/?muraAction=cEditProfile.edit HTTP/1.1Host: some.mura.siteCookie: userid=userid-uuid-goes-here; userhash=

 [![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEigiZxW0-7yOBZb7kjwF9HhvQrUt9KvjEFVaXjfxCRf-URiKuqOCzzKAfT5RzdkK7UHrOZi8l-H_lCE4jxYtbquk7q8zNETHK1EbWzPn_OG6XfqVJTQXOc1kP_MO2fISv5ZUMlCQ9A_FjyS3bnd2evS-mwgKl1S_J5NPjeU3I3f2_0JIkl84JBQOyW9/w839-h474/burpsuite.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEigiZxW0-7yOBZb7kjwF9HhvQrUt9KvjEFVaXjfxCRf-URiKuqOCzzKAfT5RzdkK7UHrOZi8l-H_lCE4jxYtbquk7q8zNETHK1EbWzPn_OG6XfqVJTQXOc1kP_MO2fISv5ZUMlCQ9A_FjyS3bnd2evS-mwgKl1S_J5NPjeU3I3f2_0JIkl84JBQOyW9/s1292/burpsuite.png)

### Remediation Recommendations

* Current Mura Software customers should upgrade to a fixed version of Mura CMS (Mura CMS v10.0.580 or later)
* Sites running older, unmaintained versions of Mura CMS should plan to migrate to a fixed version of Masa CMS or contact Mura Software regarding patch availability *(see the next section below for additional guidance)*
* Sites running Masa CMS should upgrade to a fixed version of Masa CMS.  Masa CMS patches are available from:

+ <https://github.com/MasaCMS/MasaCMS/releases/tag/7.2.5>
+ <https://github.com/MasaCMS/MasaCMS/releases/tag/7.3.10>
+ <https://github.com/MasaCMS/MasaCMS/releases/tag/7.4.0-beta.3>

### Help! I Need to Quickly Patch an Old Version of Mura CMS and Can't Upgrade to Masa CMS Immediately (and Don't Have $5000)

Prior to reporting this vulnerability to Mura Software and the Masa CMS team, I was curious and concerned about the options that organizations running older, unsupported versions of open source Mura CMS would have to remediate it.  I have spent time playing defense in organizations that were understaffed and underfunded.  If cost and limited budgets were a factor in initially selecting a free Mura CMS, it’s unlikely these organizations would now be able to pony up cash for a security fix.  It's great to see that the Masa CMS team is maintaining an open source fork, but often single security patches are much easier and quicker to deploy than doing something like a full system migration from Mura to Masa.
When I reported this vulnerability to Mura Software, it was my original understanding that Mura Software would be making a do-it-yourself patch for this vulnerability available at no cost upon request, for organizations running older versions of open source Mura CMS.  But at this point I’m not sure if that is actually an option, as [I have heard that Mura Software is selling a standalone patch for $5000](https://groups.google.com/g/mura-cms-developers/c/MpjNlYcs1MI/m/8S9sWzb1AgAJ).
***Five grand just for a security patch?***  **You cannot be serious.**  So – I want to at least share some guidance for a potential quick-and-dirty fix.  And if you paid $5000 for just a security patch, you have my sympathy.  Find me at a [conference](https://carahevents.carahsoft.com/Event/Details/341389-adobe) or on a [bar](https://www.tombs.com/) [stool](https://jgmelon-nyc.com/), show me a paid invoice, and I’ll buy you a drink.  But in the meantime, Johnny Mac is here to help.  This code is pulled from the public [Masa CMS “remember me” patch](https://github.com/MasaCMS/MasaCMS/commit/e5ef29fbc2ef827fee39343f262b64e76d6aa25d):

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhpuP3SOaI-9zYlbH5p_xFewE1JLmgrjUzvId0HMPJkmahsCA-uQNPo6CQdTA31v58M4qCWL0ma4XbItIqrs0CglaOhBNNRP4jYdzEKC9HUy_Z7-BFkbXBHoUJGsjUQMctdyNQTuHt7jt7Q6NUFlZZWQgmDE_wxRf7EUPjlrbD4KkycDaaE1jal1Cyt/w844-h488/johnnymac.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhpuP3SOaI-9zYlbH5p_xFewE1JLmgrjUzvId0HMPJkmahsCA-uQNPo6CQdTA31v58M4qCWL0ma4XbItIqrs0CglaOhBNNRP4jYdzEKC9HUy_Z7-BFkbXBHoUJGsjUQMctdyNQTuHt7jt7Q6NUFlZZWQgmDE_wxRf7EUPjlrbD4KkycDaaE1jal1Cyt/s1330/johnnymac.png)
For easier copypasta -
***Vulnerable:*****if ( !len(arguments.userHash) || arguments.userHash == rsUser.userHash ) {**
***Fixed:*****if ( len(arguments.userid) && len(arguments.userHash) && arguments.userHash == rsUser.userHash ) {**
Find the **red** in loginManager.cfc and change it to the **green**.  I’ve tested the fix above on Mura CMS 7.0.7029 running on Lucee, and it will successfully stop exploitation.  **Obviously – take this code with the same level of guarantee as you would for any other meme-delivered code.  Test, test, test and have a rollback plan before making this change in production environments or anywhere else that matters.**
Note that there will also be some variation between Mura versions.  Providing a complete picture of past versions is tough since the official Mura CMS repos are private and I'm only working off of what's available in public forks, but here's what I know:

* In some *later* versions of Mura 7.0.x and later, loginManager.cfc should be [core/mura/login/](https://github.com/MSU-NatSci/MuraCMS/blob/7.1/core/mura/login/loginManager.cfc#L62)
* In some *earlier* versions of Mura 7.0.x, loginManager.cfc should be in [requirements/mura/login/](https://github.com/MSU-NatSci/MuraCMS/blob/7.0/requirements/mura/login/loginManager.cfc#L65)
> *(Solving for the exact values of x is an exercise left for the reader. Check your codebases.)*

And Mura 6.x looks like it's vulnerable too, but while the "remember me" code is functionality similar, it uses tag-based CFML and not the CFScript-based CFML in Mura 7.0 and later.  loginManager.cfc should be in [requirements/mura/login/](https://github.com/MSU-NatSci/MuraCMS/blob/6.2/requirements/mura/login/loginManager.cfc#L71), and you'll want to change:

<cfif not len(arguments.userHash) or arguments.userHash eq rsUser.userHash>        <cfset isloggedin=variables.userUtility.loginByUserID(rsUser.userID,rsUser.siteID)>
to:
<cfif len(arguments.userHash) and arguments.userHash eq rsUser.userHash>        <cfset isloggedin=variables.userUtility.loginByUserID(rsUser.userID,rsUser.siteID)>
(remove the ***not***,  change the ***or*** to an ***and***)
Plus Mura CMS 6.x has [other](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-15639) [security](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-8302) [vulnerabilities](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-7486), so if you’re running it you should really plan to migrate to a later, supported platform regardless of this vulnerability.
**A final note on the patches:**There’s a lot of code overlap between Masa CMS and Mura CMS 7.x, and I’ve read some reports of people successfully dropping the Masa patch in its entirety into Mura environments.  I don’t fully understand how the configBean/MFA stuff works within the Masa patch (and what specific Mura versions it would or wouldn’t apply to) – which is why I’ve scaled down the code in the “quick” fix.  Anyone who is more familiar with Mura/Masa internals and can provide more guidance, please feel free to leave a comment or drop me a line.  But the crux of the vulnerability is the portion of the conditional in loginManager.cfc that evaluates true for a zero-length arguments.userHash value (decrypt() result).
###

### A Few More Closing Thoughts

* This vulnerability is a good reminder that user-controlled ciphertext is still untrusted input.  User-controlled ciphertext should always include an HMAC or other cryptographic integrity check that is validated prior to decryption.  If the integrity validation fails, decryption should not even be attempted.

* The CFMX\_COMPAT algorithm is very insecure.  While no practical cryptographic attacks are demonstrated in this scenario, a more secure algorithm should ideally be used. (And in the case of an exposed "userHash" cookie, cracking/decrypting the ciphertext provides limited additional value.)

* There are some information leakage vulnerabilities in the Mura/Masa JSON API, such as the means to extract valid userid UUIDs.  As standalone issues they may be low risk and have limited impact, but they become much more significant as part of our exploit chain.

* The “Remember me” functionality is driven by code that is evaluated server-side.  Just removing the front-end web UI “Remember me” toggle switch on the login forms without a backend code change will not remediate the underlying vulnerability.
###

### Timeline

2022-11-28 - Reported the vulnerability to Mura Software and Masa CMS team
2022-11-28 - Received confirmation of receipt from Mura Software
2022-11-29 - Received confirmation of receipt from Masa CMS team
2022-12-06 - Established a timeframe for technical disclosure 90 days after patch release
2022-12-06 - Masa CMS team releases fixed versions of Masa CMS, and announces fixes via mailing list, LinkedIn, Twitter and Slack
2022-12-06 - Mura Software notifies customers
*Around* 2022-12-22 - [Mura Software appears to send emails to former customers and prospects, in which they take credit for my vulnerability research and make a clumsy attempt to upsell.  While also apparently having trouble with the difference between *{{recipientName}}* and *{{senderName}}* in email templates.](https://groups.google.com/g/mura-cms-developers/c/MpjNlYcs1MI/m/8S9sWzb1AgAJ)[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEh1u3OtE3t35tcQcVq0-CwZ9BSZMk1I_vegjwLhB3QEAteOPbS1plQne2JDGXDqdAnOtly9tI4hpEt8musHWkvTmH8uw7Ydem1Rf2LJPrqGQ3JXvUwKsJyuMpPp6_mSUY8VZNQGxOIdJ6z-B4o1_cAlAed-EnxWz1q_dHPwHuAQIrW9ZL6vi-R05edS/w177-h162/blink-wtf.gif)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEh1u3OtE3t35tcQcVq0-CwZ9BSZMk1I_vegjwLhB3QEAteOPbS1plQne2JDGXDqdAnOtly9tI4hpEt8musHWkvTmH8uw7Ydem1Rf2LJPrqGQ3JXvUwKsJyuMpPp6_mSUY8VZNQGxOIdJ6z-B4o1_cAlAed-EnxWz1q_dHPwHuAQIrW9ZL6vi-R05edS/s370/blink-wtf.gif)
2023-01-11 - [Phewwwww.  Exhale.  Ommmmm.  We cool.](https://groups.google.com/g/mura-cms-developers/c/aZzYSPQNbi4/m/M9Lc35wUAAAJ)  *(It was my pleasure to work with Matt at Mura Software on the triage and remediation of this vulnerability.)*[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiw-RBGhsPS2qhCbqDNGGExS6xmYg4ryZb7wXKLP5UCOXD0d1ehY_5agTp5wrkxcZF010FiPpGmyia336D19G8GV6cgkFS7W0Nblr3Qgfvy-Qy6E79vU1CmmL3Lf4jCvSUbGAOViZaKUnvi6XV2J5jzPc1ppdkBjkoPazQKd1ZqhF1RGZ4_CXTnHRAo/w169-h168/draper-meditate.gif)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiw-RBGhsPS2qhCbqDNGGExS6xmYg4ryZb7wXKLP5UCOXD0d1ehY_5agTp5wrkxcZF010FiPpGmyia336D19G8GV6cgkFS7W0Nblr3Qgfvy-Qy6E79vU1CmmL3Lf4jCvSUbGAOViZaKUnvi6XV2J5jzPc1ppdkBjkoPazQKd1ZqhF1RGZ4_CXTnHRAo/s480/draper-meditate.gif)
2023-01-28 - [Preliminary Security Advisory published](https://hoyahaxa.blogspot.com/2023/01/preliminary-security-advisory.html)
2023-02-01 - [CVE-2022-47002](https://nvd.nist.gov/vuln/detail/CVE-2022-47002) and [CVE-2022-47003](https://nvd.nist.gov/vuln/detail/CVE-2022-47003) published
2023-03-06 - Blog post published

By

[Brian](https://www.blogger.com/profile/11469146940904500468 "author profile")

at

[March 06, 2023](https://www.hoyahaxa.com/2023/03/authentication-bypass-mura-masa.html "permanent link")

[Email This](https://www.blogger.com/share-post.g?blogID=8150770822327173457&postID=3470615547448014298&target=email "Email This")[BlogThis!](https://www.blogger.com/share-post.g?blogID=8150770822327173457&postID=3470615547448014298&target=blog "BlogThis!")[Share to X](https://www.blogger.com/share-post.g?blogID=8150770822327173457&postID=3470615547448014298&target=twitter "Share to X")[Share to Facebook](https://www.blogger.com/share-post.g?blogID=8150770822327173457&postID=3470615547448014298&target=facebook "Share to Facebook")[Share to Pinterest](https://www.blogger.com/share-post.g?blogID=8150770822327173457&postID=3470615547448014298&target=pinterest "Share to Pinterest")

Labels:
[cfml](https://www.hoyahaxa.com/search/label/cfml),
[coldfusion](https://www.hoyahaxa.com/search/label/coldfusion),
[security](https://www.hoyahaxa.com/search/label/security)

#### 2 comments:

1. ![](//resources.blogblog.com/img/blank.gif)T G[March 8, 2023 at 9:38 AM](https://www.hoyahaxa.com/2023/03/authentication-bypass-mura-masa.html?showComment=1678286308710#c95026919596953547)

   Wow! Thank you for the patch info!

   Reply[Delete](https://www.blogger.com/delete-comment.g?blogID=8150770822327173457&postID=95026919596953547)Replies
   Reply
2. ![](//resources.blogblog.com/img/blank.gif)Paul[March 15, 2023 at 10:04 AM](https://www.hoyahaxa.com/2023/03/authentication-bypass-mura-masa.html?showComment=1678889078123#c711587411560312822)

   Thank you so much for finding and patching this vulnerability!

   Reply[Delete](https://www.blogger.com/delete-comment.g?blogID=8150770822327173457&postID=711587411560312822)Replies
   Reply

Add commentLoad more...

[Newer Post](https://www.hoyahaxa.com/2023/04/slides-from-coldfusion-summit-east-2023.html "Newer Post")

[Older Post](https://www.hoyahaxa.com/2023/01/preliminary-security-advisory.html "Older Post")

[Home](https://www.hoyahaxa.com/)

Subscribe to:
[Post Comments (Atom)](https://www.hoyahaxa.com/feeds/3470615547448014298/comments/default)

## Blog Archive

* ►
  [2024](https://www.hoyahaxa.com/2024/)
  (10)
  + ►
    [December](https://www.hoyahaxa.com/2024/12/)
    (1)
  + ►
    [August](https://www.hoyahaxa.com/2024/08/)
    (1)
  + ►
    [July](https://www.hoyahaxa.com/2024/07/)
    (2)
  + ►
    [March](https://www.hoyahaxa.com/2024/03/)
    (4)
  + ►
    [February](https://www.hoyahaxa.com/2024/02/)
    (2)

* ▼
  [2023](https://www.hoyahaxa.com/2023/)
  (11)
  + ►
    [December](https://www.hoyahaxa.com/2023/12/)
    (1)
  + ►
    [November](https://www.hoyahaxa.com/2023/11/)
    (1)
  + ►
    [October](https://www.hoyahaxa.com/2023/10/)
    (2)
  + ►
    [September](https://www.hoyahaxa.com/2023/09/)
    (1)
  + ►
    [August](https://www.hoyahaxa.com/2023/08/)
    (1)
  + ►
    [July](https://www.hoyahaxa.com/2023/07/)
    (1)
  + ►
    [May](https://www.hoyahaxa.com/2023/05/)
    (1)
  + ►
    [April](https://www.hoyahaxa.com/2023/04/)
    (1)
  + ▼
    [March](https://www.hoyahaxa.com/2023/03/)
    (1)
    - [Authentication Bypass Vulnerability in Mura CMS an...](https://www.hoyahaxa.com/2023/03/authentication-bypass-mura-masa.html)
  + ►
    [January](https://www.hoyahaxa.com/2023/01/)
    (1)

* ►
  [2022](https://www.hoyahaxa.com/2022/)
  (3)
  + ►
    [November](https://www.hoyahaxa.com/2022/11/)
    (1)
  + ►
    [October](https://www.hoyahaxa.com/2022/10/)
    (1)
  + ►
    [May](https://www.hoyahaxa.com/2022/05/)
    (1)

* ►
  [2021](https://www.hoyahaxa.com/2021/)
  (6)
  + ►
    [June](https://www.hoyahaxa.com/2021/06/)
    (2)
  + ►
    [May](https://www.hoyahaxa.com/2021/05/)
    (2)
  + ►
    [April](https://www.hoyahaxa.com/2021/04/)
    (2)

## Labels

* [security](https://www.hoyahaxa.com/search/label/security)
  (26)
* [cfml](https://www.hoyahaxa.com/search/label/cfml)
  (21)
* [coldfusion](https://www.hoyahaxa.com/search/label/coldfusion)
  (20)
* [encryption](https://www.hoyahaxa.com/search/label/encryption)
  (3)
* [stupidunixtricks](https://www.hoyahaxa.com/search/label/stupidunixtricks)
  (2)
* [xxe](https://www.hoyahaxa.com/search/label/xxe)
  (2)
* [oracle](https://www.hoyahaxa.com/search/label/oracle)
  (1)
* [ssrf](https://www.hoyahaxa.com/search/label/ssrf)
  (1)
* [waf](https://www.hoyahaxa.com/search/label/waf)
  (1)

## About

Hi - I'm Brian. This blog is a place for some of my personal security research and related topics I feel compelled to write about. Web application security, secure coding, offense, exploitation, stupid Unix tricks, ColdFusion/CFML, attic salt.

Available for select application security consulting, including web/mobile penetration testing, secure code reviews, secure SDLC, and product security services. Inquiries welcome.

## Links

* Contact
* [Twitter](https://twitter.com/hoyahaxa)

![](https://blogger.googleusercontent.com/img/a/AVvXsEhRrp9b6_mLLzseVcNtrSv4Wzf8brUVrFA2PN3ALbOpK8FFFgxHXRsuOjqfE2kQ5LHEoQXDbvJo4zKMftbDHCK9_P4K6C2fHemKB32wxIzAh4_ujhjDpGEmQdS5PTNB0_PuJfl9OOMpzxQ0PYNX0LIgPMKc1tDXoirS5bmL1Y9kzV2D9g1GakDH0FaAT0M=s252)

© Copyright 2021-2025 HoyaHaxa - All Rights Reserved. Powered by [Blogger](https://www.blogger.com).



=== Content from www.murasoftware.com_e2508d7d_20250108_131502.html ===


[![Mura Software](/themes/getmura3/images/mura-logo-lockup.svg)](/ "Mura Software")

* [Home](https://www.murasoftware.com)
* [Features](/cms-features/)
* [Schedule Demo](https://www.murasoftware.com/request-demo/)

###### Contact

* ---

  [Request Demo](/request-demo/)
* [Contact Us](/contact/)

###### SUPPORT

* ---

  [Resources](https://www.murasoftware.com/mura-cms/resources/)
* [Documentation](https://docs.murasoftware.com/v10/)

###### About

* ---

  [About Us](https://www.murasoftware.com/about/)
* [Careers](/careers)

Copyright © 2024 Mura. All Rights Reserved. [Privacy Policy](/privacy-policy/)



=== Content from hoyahaxa.blogspot.com_8d23ef71_20250108_131500.html ===


[![HoyaHaxa: A Security Research Blog](https://blogger.googleusercontent.com/img/a/AVvXsEhUCgr_s5i1lLMG8jSrZDgwfmOD0xvQEZ_4EtG19YgYDsjMJAV6B6IZErmSF8wXxJ4410IGeo2zlsVErr1Bwn2wjLVmIfGC4Bz4IFNS-fut8rnTuYn59wu61C0IMcEcEeUBd149LUZmCZ-SIcaLSXxunTA5_tCsc4kTCzQkd4hRjDFzCJolIAbvHVFQ=s1181)](https://www.hoyahaxa.com/)

## Saturday, January 28, 2023

### Preliminary Security Advisory - Authentication Bypass Vulnerability in Mura CMS and Masa CMS (CVE-2022-47003 and CVE-2022-47002)

***Update March 6, 2023** - the full security advisory has been posted here:**<https://hoyahaxa.blogspot.com/2023/03/authentication-bypass-mura-masa.html>*

*This is a preliminary security advisory, and is being shared so that impacted organizations can update and patch as needed.  Additional technical details will be released on March 6, 2023.*

**Background:**

Mura CMS is a popular content management system written in ColdFusion/CFML. While it was originally a commercial open source product, it was re-licensed as a closed source application with the release of Mura CMS v10 in 2020.  There are forked open source projects based on the last open source release of Mura CMS, including Masa CMS - which is actively maintained.

Multiple versions of Mura CMS and Masa CMS contain an authentication bypass vulnerability that can allow an  unauthenticated attacker to login as any Site Member or System User.

The following CVEs have been assigned for this vulnerability:

**CVE:** CVE-2022-47003

**Description:** Authentication Bypass Vulnerability in Mura CMS

**Impact:** An unauthenticated attacker is able to login as any Mura Site Member or Mura System User

**Fixed Version(s):** Mura CMS v10.0.580 and later

**CVE:** CVE-2022-47002

**Description:**  Authentication Bypass Vulnerability in Masa CMS

**Impact:** An unauthenticated attacker is able to login as any Masa Site Member or Masa System User

**Fixed Version(s):** Masa CMS v7.2.5, Masa CMS v7.3.10, Masa v7.4.0-beta.3 and later

**Recommendations:**

* Current Mura Software customers should upgrade to a fixed version of Mura CMS
* Sites running older, unmaintained versions of Mura CMS should plan to migrate to a fixed version of Masa CMS or contact Mura Software regarding patch availability.
* Sites running Masa CMS should upgrade to a fixed version of Masa CMS

**Additional References:**

*Mura CMS:*

* <https://groups.google.com/g/mura-cms-developers/c/MpjNlYcs1MI>
* <https://groups.google.com/g/mura-cms-developers/c/aZzYSPQNbi4>

*Masa CMS:*

* <https://github.com/MasaCMS/MasaCMS/releases/tag/7.2.5>
* <https://github.com/MasaCMS/MasaCMS/releases/tag/7.3.10>
* <https://github.com/MasaCMS/MasaCMS/releases/tag/7.4.0-beta.3>

By

[Brian](https://www.blogger.com/profile/11469146940904500468 "author profile")

at

[January 28, 2023](https://www.hoyahaxa.com/2023/01/preliminary-security-advisory.html "permanent link")

[Email This](https://www.blogger.com/share-post.g?blogID=8150770822327173457&postID=3409905566561206263&target=email "Email This")[BlogThis!](https://www.blogger.com/share-post.g?blogID=8150770822327173457&postID=3409905566561206263&target=blog "BlogThis!")[Share to X](https://www.blogger.com/share-post.g?blogID=8150770822327173457&postID=3409905566561206263&target=twitter "Share to X")[Share to Facebook](https://www.blogger.com/share-post.g?blogID=8150770822327173457&postID=3409905566561206263&target=facebook "Share to Facebook")[Share to Pinterest](https://www.blogger.com/share-post.g?blogID=8150770822327173457&postID=3409905566561206263&target=pinterest "Share to Pinterest")

Labels:
[cfml](https://www.hoyahaxa.com/search/label/cfml),
[coldfusion](https://www.hoyahaxa.com/search/label/coldfusion),
[security](https://www.hoyahaxa.com/search/label/security)

#### No comments:

#### Post a Comment

[Newer Post](https://www.hoyahaxa.com/2023/03/authentication-bypass-mura-masa.html "Newer Post")

[Older Post](https://www.hoyahaxa.com/2022/11/on-coldfusion-xxe-and-other-xml-attacks.html "Older Post")

[Home](https://www.hoyahaxa.com/)

Subscribe to:
[Post Comments (Atom)](https://www.hoyahaxa.com/feeds/3409905566561206263/comments/default)

## Blog Archive

* ►
  [2024](https://www.hoyahaxa.com/2024/)
  (10)
  + ►
    [December](https://www.hoyahaxa.com/2024/12/)
    (1)
  + ►
    [August](https://www.hoyahaxa.com/2024/08/)
    (1)
  + ►
    [July](https://www.hoyahaxa.com/2024/07/)
    (2)
  + ►
    [March](https://www.hoyahaxa.com/2024/03/)
    (4)
  + ►
    [February](https://www.hoyahaxa.com/2024/02/)
    (2)

* ▼
  [2023](https://www.hoyahaxa.com/2023/)
  (11)
  + ►
    [December](https://www.hoyahaxa.com/2023/12/)
    (1)
  + ►
    [November](https://www.hoyahaxa.com/2023/11/)
    (1)
  + ►
    [October](https://www.hoyahaxa.com/2023/10/)
    (2)
  + ►
    [September](https://www.hoyahaxa.com/2023/09/)
    (1)
  + ►
    [August](https://www.hoyahaxa.com/2023/08/)
    (1)
  + ►
    [July](https://www.hoyahaxa.com/2023/07/)
    (1)
  + ►
    [May](https://www.hoyahaxa.com/2023/05/)
    (1)
  + ►
    [April](https://www.hoyahaxa.com/2023/04/)
    (1)
  + ►
    [March](https://www.hoyahaxa.com/2023/03/)
    (1)
  + ▼
    [January](https://www.hoyahaxa.com/2023/01/)
    (1)
    - [Preliminary Security Advisory - Authentication Byp...](https://www.hoyahaxa.com/2023/01/preliminary-security-advisory.html)

* ►
  [2022](https://www.hoyahaxa.com/2022/)
  (3)
  + ►
    [November](https://www.hoyahaxa.com/2022/11/)
    (1)
  + ►
    [October](https://www.hoyahaxa.com/2022/10/)
    (1)
  + ►
    [May](https://www.hoyahaxa.com/2022/05/)
    (1)

* ►
  [2021](https://www.hoyahaxa.com/2021/)
  (6)
  + ►
    [June](https://www.hoyahaxa.com/2021/06/)
    (2)
  + ►
    [May](https://www.hoyahaxa.com/2021/05/)
    (2)
  + ►
    [April](https://www.hoyahaxa.com/2021/04/)
    (2)

## Labels

* [security](https://www.hoyahaxa.com/search/label/security)
  (26)
* [cfml](https://www.hoyahaxa.com/search/label/cfml)
  (21)
* [coldfusion](https://www.hoyahaxa.com/search/label/coldfusion)
  (20)
* [encryption](https://www.hoyahaxa.com/search/label/encryption)
  (3)
* [stupidunixtricks](https://www.hoyahaxa.com/search/label/stupidunixtricks)
  (2)
* [xxe](https://www.hoyahaxa.com/search/label/xxe)
  (2)
* [oracle](https://www.hoyahaxa.com/search/label/oracle)
  (1)
* [ssrf](https://www.hoyahaxa.com/search/label/ssrf)
  (1)
* [waf](https://www.hoyahaxa.com/search/label/waf)
  (1)

## About

Hi - I'm Brian. This blog is a place for some of my personal security research and related topics I feel compelled to write about. Web application security, secure coding, offense, exploitation, stupid Unix tricks, ColdFusion/CFML, attic salt.

Available for select application security consulting, including web/mobile penetration testing, secure code reviews, secure SDLC, and product security services. Inquiries welcome.

## Links

* Contact
* [Twitter](https://twitter.com/hoyahaxa)

![](https://blogger.googleusercontent.com/img/a/AVvXsEhRrp9b6_mLLzseVcNtrSv4Wzf8brUVrFA2PN3ALbOpK8FFFgxHXRsuOjqfE2kQ5LHEoQXDbvJo4zKMftbDHCK9_P4K6C2fHemKB32wxIzAh4_ujhjDpGEmQdS5PTNB0_PuJfl9OOMpzxQ0PYNX0LIgPMKc1tDXoirS5bmL1Y9kzV2D9g1GakDH0FaAT0M=s252)

© Copyright 2021-2025 HoyaHaxa - All Rights Reserved. Powered by [Blogger](https://www.blogger.com).



=== Content from mura.com_c090a1ac_20250108_131459.html ===

# KYA groupã¯ã³ã³ãã¥ã¼ã¿ç°å¢ãæ¯æ´ããåµä½éå£ã§ã

å¯è½æ§ï¼ã¿ããï¼ã
å¼ãå¯ããç¢ºããªæè¡ï¼ã¡ããï¼ã
ããªãã«

* [æ°çæå ±](hot.html)
* [åäººåãã®è£½åã»ãµã¼ãã¹ã«ã¤ãã¦ã®æå ±](personal.html)
* [ä¼æ¥­åãã®è£½åã»ãµã¼ãã¹ã«ã¤ãã¦ã®æå ±](enterprise.html)
* [äººæåéã«é¢ããæå ±](jobs.html)
* [ä¼æ¥­æå ±](profile.html)
* [ãåãåãã](contact.html)
* [ãã®Webãµã¤ãã«ã¤ãã¦](#about)

# ãã®Webãµã¤ãã¯...

[æéä¼ç¤¾ã±ã¤ã»ã¯ã¤ã»ã¨ã¤ã»ã°ã«ã¼ã](profile.html)ãéå¶ãã¦ããæå ±ãµã¤ãã§ãã
### Acknowledgements

Icons made by Icons8 and Freepik from [www.flaticon.com](http://www.flaticon.com "Flaticon") are licensed by [CC BY 3.0](http://creativecommons.org/licenses/by/3.0/ "Creative Commons BY 3.0")



=== Content from www.masacms.com_68555e67_20250108_131501.html ===


# MASA CMS

[![MASA CMS](/themes/masacms/assets/images/site-logo.png)](/)

Home
[Features](/features/)
[Support](/support/)
[Docs](/docs1/)
[Download](/download/)

## What is MASA ?

MASA CMS is an Enterprise Content Management platform based on open source technology. MASA CMS allows you, quickly and efficiently, to deliver personalised internet and intranet sites and mobile applications. It allows for easy deployment on your infrastructure of choice (AWS, GCP, Azure, own hardware). MASA CMS is ideally suited to organisations looking to be compliant with privacy laws such as GDPR.

The roots of MASA CMS lie in the last version of MuraTM CMS which was available as open source.

Why MASA?

We truly believe that something that was great deserves to be continued for you - the community. The roots of MASA CMS lie in the last version of the well known MuraTM CMS that was available for many years as open source software. MuraTM CMS is now proprietary software and we - being a consortium of long term supporters of the platform and of open source - decided to fork the open source version and continue to make it available to everyone.

## WHAT'S THE PLAN?

Like the quote from the famous TV show the A-Team “I love it when a plan comes together!” Over the past months we worked on creating the first public release of MASA CMS. Going forward we will be working on fixing known bugs, providing security patches and delivering continuous performance improvements. On top of this we will actively work on releasing a new public roadmap that listens to the community.

We aim for multiple releases a year. Security and bug fixes will be done continuously.

![](/index.cfm/_api/render/file/?fileID=6AD737DF-B446-4AE7-83CF0745D4EEA9F1&fileEXT=svg)
Lift off
We've launched MASA CMS!

So we’ve done the first part: we created an initial version of the platform under the new name. You can [go and get it now!](https://github.com/MasaCMS) Even better - you can replace your previous version of MuraTM with MASA and you are good to go - [find out how](https://docs.masacms.com/getting-started/upgrade-from-mura-to-masa-cms/).

Foundations
Building a strong base

Over the past few months we've introduced a new file browser, improved the admin interface for editing content ([v7.3](https://github.com/MasaCMS/MasaCMS/releases/tag/7.3)), added multiple new front end modules ([v7.4](https://github.com/MasaCMS/MasaCMS/releases/tag/7.4.0)), updated the default theme to [Bootstrap 5](https://github.com/MasaCMS/MasaBootstrap5), released multiple [plugins](https://www.forgebox.io/?search=masa) and much more! We will continue to do this to further clean up the code, remove redundant and other deprecated code.

![](/index.cfm/_api/render/file/?fileID=36A6FF71-FE25-4D11-86A40973B8E16ACE&fileEXT=svg)

![](/index.cfm/_api/render/file/?fileID=BD58EEA1-2789-4592-BFBEE22F270F00AB&fileEXT=svg)
Room for more?
Cool new features

We will be launching cool new integrations to support you in dealing with matters like 1st and 3rd party data tracking.

The future
The moon, Alice & beyond!

So what is next? Well that depends on two things: what is the community looking for? Let us know what you think should be on the roadmap! Do you have a great plugin to share with the community let us know as well. We will also be working on releasing a variety of plugins that allow for integrations with tools for marketing automation and personalization, analytics, etc.

![](/index.cfm/_api/render/file/?fileID=F2E0212A-7A7F-4FA0-851C9038B923BC74&fileEXT=svg)

WANT TO KNOW MORE?

© MASA CMS 2025
[Contact us](/contact-us/)
[Privacy policy](/privacy-policy/)
[Legal information](/legal-information/)
[![We Are North](/themes/masacms/assets/images/WAN_Logo_Mono_White.png)](https://www.wearenorth.eu/ "We Are Orange")

Masa CMS is not affiliated with MuraTM CMS, whose trademarks are acknowledged. For more information see our [Legal information](/legal-information/).


