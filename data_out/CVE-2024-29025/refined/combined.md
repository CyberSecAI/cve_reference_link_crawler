=== Content from github.com_544e60b5_20250111_191204.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fnetty%2Fnetty%2Fcommit%2F0d0c6ed782d13d423586ad0c71737b2c7d02058c)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fnetty%2Fnetty%2Fcommit%2F0d0c6ed782d13d423586ad0c71737b2c7d02058c)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fcommit%2Fshow&source=header-repo&source_repo=netty%2Fnetty)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[netty](/netty)
/
**[netty](/netty/netty)**
Public

* [Notifications](/login?return_to=%2Fnetty%2Fnetty) You must be signed in to change notification settings
* [Fork
  16k](/login?return_to=%2Fnetty%2Fnetty)
* [Star
   33.7k](/login?return_to=%2Fnetty%2Fnetty)

* [Code](/netty/netty)
* [Issues
  575](/netty/netty/issues)
* [Pull requests
  39](/netty/netty/pulls)
* [Discussions](/netty/netty/discussions)
* [Actions](/netty/netty/actions)
* [Projects
  0](/netty/netty/projects)
* [Wiki](/netty/netty/wiki)
* [Security](/netty/netty/security)
* [Insights](/netty/netty/pulse)

Additional navigation options

* [Code](/netty/netty)
* [Issues](/netty/netty/issues)
* [Pull requests](/netty/netty/pulls)
* [Discussions](/netty/netty/discussions)
* [Actions](/netty/netty/actions)
* [Projects](/netty/netty/projects)
* [Wiki](/netty/netty/wiki)
* [Security](/netty/netty/security)
* [Insights](/netty/netty/pulse)

## Commit

[Permalink](/netty/netty/commit/0d0c6ed782d13d423586ad0c71737b2c7d02058c)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Merge pull request from [GHSA-5jpm-x58v-624v](https://github.com/advisories/GHSA-5jpm-x58v-624v "GHSA-5jpm-x58v-624v")

[Browse files](/netty/netty/tree/0d0c6ed782d13d423586ad0c71737b2c7d02058c)
Browse the repository at this point in the history

```
* The InterfaceHttpPostRequestDecoder form implementations does not provide hard limits for the number of fields a form can have and the number of accumulated bytes. The former can be used by sending a large amount of fields that will fill the bodyListHttpData list, the later can be used by sending a very large field filling the undecodedChunk buffer since the decoder implementation buffers the field before handling it.

This provides hard limits for both: maxFields defines the maximum number of fields the form can have, maxBufferedBytes defines the maximum number of bytes a field can cumulate. When a limit is reached, a decoder exception is thrown, letting the decoder controller take care of it.

* Set default limits for maxFields/maxUnbufferedBytes (breaking change)

* Update codec-http/src/main/java/io/netty/handler/codec/http/multipart/HttpPostRequestDecoder.java

* Update codec-http/src/main/java/io/netty/handler/codec/http/multipart/HttpPostRequestDecoder.java

---------

Co-authored-by: Julien Viet <julien@julienviet.com>
```

* Loading branch information

[![@normanmaurer](https://avatars.githubusercontent.com/u/439362?s=40&v=4)](/normanmaurer) [![@vietj](https://avatars.githubusercontent.com/u/225674?s=40&v=4)](/vietj)

[normanmaurer](/netty/netty/commits?author=normanmaurer "View all commits by normanmaurer")
and
[vietj](/netty/netty/commits?author=vietj "View all commits by vietj")
authored
Mar 21, 2024

1 parent
[d4a640d](/netty/netty/commit/d4a640d23f228fde5b6d14dadaee05da33ca86cb)

commit 0d0c6ed

 Show file tree

 Hide file tree

Showing
**4 changed files**
with
**256 additions**
and
**0 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* codec-http/src

  + main/java/io/netty/handler/codec/http/multipart

    - codec-http/src/main/java/io/netty/handler/codec/http/multipart/HttpPostMultipartRequestDecoder.java
      [HttpPostMultipartRequestDecoder.java](#diff-1981c1ca5715a1cd7927b58a47b70e5360fedb3309d457ed4cc9ff24028f5047)
    - codec-http/src/main/java/io/netty/handler/codec/http/multipart/HttpPostRequestDecoder.java
      [HttpPostRequestDecoder.java](#diff-5c97eb94e04c24e516f51dd3b4dfcb574b472b444a1acf76f71b1289d4c30302)
    - codec-http/src/main/java/io/netty/handler/codec/http/multipart/HttpPostStandardRequestDecoder.java
      [HttpPostStandardRequestDecoder.java](#diff-ea666445e8d907590228ef400896991e396b2bd0affb832b9c18e64df28a2041)
  + test/java/io/netty/handler/codec/http/multipart

    - codec-http/src/test/java/io/netty/handler/codec/http/multipart/HttpPostRequestDecoderTest.java
      [HttpPostRequestDecoderTest.java](#diff-36eecd099979b5691efe93d972144bef7d825af8850ab576450bd902ab168b60)

## There are no files selected for viewing

41 changes: 41 additions & 0 deletions

41
[.../src/main/java/io/netty/handler/codec/http/multipart/HttpPostMultipartRequestDecoder.java](#diff-1981c1ca5715a1cd7927b58a47b70e5360fedb3309d457ed4cc9ff24028f5047 "codec-http/src/main/java/io/netty/handler/codec/http/multipart/HttpPostMultipartRequestDecoder.java")

Show comments

[View file](/netty/netty/blob/0d0c6ed782d13d423586ad0c71737b2c7d02058c/codec-http/src/main/java/io/netty/handler/codec/http/multipart/HttpPostMultipartRequestDecoder.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -64,6 +64,16 @@ public class HttpPostMultipartRequestDecoder implements InterfaceHttpPostRequest |
|  |  | \*/ |
|  |  | private final HttpRequest request; |
|  |  |  |
|  |  | /\*\* |
|  |  | \* The maximum number of fields allows by the form |
|  |  | \*/ |
|  |  | private final int maxFields; |
|  |  |  |
|  |  | /\*\* |
|  |  | \* The maximum number of accumulated bytes when decoding a field |
|  |  | \*/ |
|  |  | private final int maxBufferedBytes; |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Default charset to use |
|  |  | \*/ |
| Expand Down  Expand Up | | @@ -175,9 +185,34 @@ public HttpPostMultipartRequestDecoder(HttpDataFactory factory, HttpRequest requ |
|  |  | \* errors |
|  |  | \*/ |
|  |  | public HttpPostMultipartRequestDecoder(HttpDataFactory factory, HttpRequest request, Charset charset) { |
|  |  | this(factory, request, charset, HttpPostRequestDecoder.DEFAULT\_MAX\_FIELDS, HttpPostRequestDecoder.DEFAULT\_MAX\_BUFFERED\_BYTES); |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
|  |  | \* |
|  |  | \* @param factory |
|  |  | \* the factory used to create InterfaceHttpData |
|  |  | \* @param request |
|  |  | \* the request to decode |
|  |  | \* @param charset |
|  |  | \* the charset to use as default |
|  |  | \* @param maxFields |
|  |  | \* the maximum number of fields the form can have, {@code -1} to disable |
|  |  | \* @param maxBufferedBytes |
|  |  | \* the maximum number of bytes the decoder can buffer when decoding a field, {@code -1} to disable |
|  |  | \* @throws NullPointerException |
|  |  | \* for request or charset or factory |
|  |  | \* @throws ErrorDataDecoderException |
|  |  | \* if the default charset was wrong when decoding or other |
|  |  | \* errors |
|  |  | \*/ |
|  |  | public HttpPostMultipartRequestDecoder(HttpDataFactory factory, HttpRequest request, Charset charset, |
|  |  | int maxFields, int maxBufferedBytes) { |
|  |  | this.request = checkNotNull(request, "request"); |
|  |  | this.charset = checkNotNull(charset, "charset"); |
|  |  | this.factory = checkNotNull(factory, "factory"); |
|  |  | this.maxFields = maxFields; |
|  |  | this.maxBufferedBytes = maxBufferedBytes; |
|  |  | // Fill default values |
|  |  |  |
|  |  | String contentTypeValue = this.request.headers().get(HttpHeaderNames.CONTENT\_TYPE); |
| Expand Down  Expand Up | | @@ -346,6 +381,9 @@ public HttpPostMultipartRequestDecoder offer(HttpContent content) { |
|  |  | undecodedChunk.writeBytes(buf); |
|  |  | } |
|  |  | parseBody(); |
|  |  | if (maxBufferedBytes > 0 && undecodedChunk != null && undecodedChunk.readableBytes() > maxBufferedBytes) { |
|  |  | throw new HttpPostRequestDecoder.TooLongFormFieldException(); |
|  |  | } |
|  |  | if (undecodedChunk != null && undecodedChunk.writerIndex() > discardThreshold) { |
|  |  | if (undecodedChunk.refCnt() == 1) { |
|  |  | // It's safe to call discardBytes() as we are the only owner of the buffer. |
| Expand Down  Expand Up | | @@ -440,6 +478,9 @@ protected void addHttpData(InterfaceHttpData data) { |
|  |  | if (data == null) { |
|  |  | return; |
|  |  | } |
|  |  | if (maxFields > 0 && bodyListHttpData.size() >= maxFields) { |
|  |  | throw new HttpPostRequestDecoder.TooManyFormFieldsException(); |
|  |  | } |
|  |  | List<InterfaceHttpData> datas = bodyMapHttpData.get(data.getName()); |
|  |  | if (datas == null) { |
|  |  | datas = new ArrayList<InterfaceHttpData>(1); |
| Expand Down | |  |

69 changes: 69 additions & 0 deletions

69
[codec-http/src/main/java/io/netty/handler/codec/http/multipart/HttpPostRequestDecoder.java](#diff-5c97eb94e04c24e516f51dd3b4dfcb574b472b444a1acf76f71b1289d4c30302 "codec-http/src/main/java/io/netty/handler/codec/http/multipart/HttpPostRequestDecoder.java")

Show comments

[View file](/netty/netty/blob/0d0c6ed782d13d423586ad0c71737b2c7d02058c/codec-http/src/main/java/io/netty/handler/codec/http/multipart/HttpPostRequestDecoder.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -37,6 +37,10 @@ public class HttpPostRequestDecoder implements InterfaceHttpPostRequestDecoder { |
|  |  |  |
|  |  | static final int DEFAULT\_DISCARD\_THRESHOLD = 10 \* 1024 \* 1024; |
|  |  |  |
|  |  | static final int DEFAULT\_MAX\_FIELDS = 128; |
|  |  |  |
|  |  | static final int DEFAULT\_MAX\_BUFFERED\_BYTES = 1024; |
|  |  |  |
|  |  | private final InterfaceHttpPostRequestDecoder decoder; |
|  |  |  |
|  |  | /\*\* |
| Expand All | | @@ -53,6 +57,25 @@ public HttpPostRequestDecoder(HttpRequest request) { |
|  |  | this(new DefaultHttpDataFactory(DefaultHttpDataFactory.MINSIZE), request, HttpConstants.DEFAULT\_CHARSET); |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
|  |  | \* |
|  |  | \* @param request |
|  |  | \* the request to decode |
|  |  | \* @param maxFields |
|  |  | \* the maximum number of fields the form can have, {@code -1} to disable |
|  |  | \* @param maxBufferedBytes |
|  |  | \* the maximum number of bytes the decoder can buffer when decoding a field, {@code -1} to disable |
|  |  | \* @throws NullPointerException |
|  |  | \* for request |
|  |  | \* @throws ErrorDataDecoderException |
|  |  | \* if the default charset was wrong when decoding or other |
|  |  | \* errors |
|  |  | \*/ |
|  |  | public HttpPostRequestDecoder(HttpRequest request, int maxFields, int maxBufferedBytes) { |
|  |  | this(new DefaultHttpDataFactory(DefaultHttpDataFactory.MINSIZE), request, HttpConstants.DEFAULT\_CHARSET, |
|  |  | maxFields, maxBufferedBytes); |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
|  |  | \* |
|  |  | \* @param factory |
| Expand Down  Expand Up | | @@ -96,6 +119,38 @@ public HttpPostRequestDecoder(HttpDataFactory factory, HttpRequest request, Char |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
|  |  | \* |
|  |  | \* @param factory |
|  |  | \* the factory used to create InterfaceHttpData |
|  |  | \* @param request |
|  |  | \* the request to decode |
|  |  | \* @param charset |
|  |  | \* the charset to use as default |
|  |  | \* @param maxFields |
|  |  | \* the maximum number of fields the form can have, {@code -1} to disable |
|  |  | \* @param maxBufferedBytes |
|  |  | \* the maximum number of bytes the decoder can buffer when decoding a field, {@code -1} to disable |
|  |  | \* @throws NullPointerException |
|  |  | \* for request or charset or factory |
|  |  | \* @throws ErrorDataDecoderException |
|  |  | \* if the default charset was wrong when decoding or other |
|  |  | \* errors |
|  |  | \*/ |
|  |  | public HttpPostRequestDecoder(HttpDataFactory factory, HttpRequest request, Charset charset, |
|  |  | int maxFields, int maxBufferedBytes) { |
|  |  | ObjectUtil.checkNotNull(factory, "factory"); |
|  |  | ObjectUtil.checkNotNull(request, "request"); |
|  |  | ObjectUtil.checkNotNull(charset, "charset"); |
|  |  |  |
|  |  | // Fill default values |
|  |  | if (isMultipart(request)) { |
|  |  | decoder = new HttpPostMultipartRequestDecoder(factory, request, charset, maxFields, maxBufferedBytes); |
|  |  | } else { |
|  |  | decoder = new HttpPostStandardRequestDecoder(factory, request, charset, maxFields, maxBufferedBytes); |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
|  |  | \* states follow NOTSTARTED PREAMBLE ( (HEADERDELIMITER DISPOSITION (FIELD | |
|  |  | \* FILEUPLOAD))\* (HEADERDELIMITER DISPOSITION MIXEDPREAMBLE (MIXEDDELIMITER |
| Expand Down  Expand Up | | @@ -338,4 +393,18 @@ public ErrorDataDecoderException(String msg, Throwable cause) { |
|  |  | super(msg, cause); |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Exception when the maximum number of fields for a given form is reached |
|  |  | \*/ |
|  |  | public static final class TooManyFormFieldsException extends DecoderException { |
|  |  | private static final long serialVersionUID = 1336267941020800769L; |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Exception when a field content is too long |
|  |  | \*/ |
|  |  | public static final class TooLongFormFieldException extends DecoderException { |
|  |  | private static final long serialVersionUID = 1336267941020800769L; |
|  |  | } |
|  |  | } |

44 changes: 44 additions & 0 deletions

44
[...p/src/main/java/io/netty/handler/codec/http/multipart/HttpPostStandardRequestDecoder.java](#diff-ea666445e8d907590228ef400896991e396b2bd0affb832b9c18e64df28a2041 "codec-http/src/main/java/io/netty/handler/codec/http/multipart/HttpPostStandardRequestDecoder.java")

Show comments

[View file](/netty/netty/blob/0d0c6ed782d13d423586ad0c71737b2c7d02058c/codec-http/src/main/java/io/netty/handler/codec/http/multipart/HttpPostStandardRequestDecoder.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -17,6 +17,7 @@ |
|  |  |  |
|  |  | import io.netty.buffer.ByteBuf; |
|  |  | import io.netty.buffer.Unpooled; |
|  |  | import io.netty.handler.codec.DecoderException; |
|  |  | import io.netty.handler.codec.http.HttpConstants; |
|  |  | import io.netty.handler.codec.http.HttpContent; |
|  |  | import io.netty.handler.codec.http.HttpRequest; |
| Expand All | | @@ -27,6 +28,8 @@ |
|  |  | import io.netty.handler.codec.http.multipart.HttpPostRequestDecoder.ErrorDataDecoderException; |
|  |  | import io.netty.handler.codec.http.multipart.HttpPostRequestDecoder.MultiPartStatus; |
|  |  | import io.netty.handler.codec.http.multipart.HttpPostRequestDecoder.NotEnoughDataDecoderException; |
|  |  | import io.netty.handler.codec.http.multipart.HttpPostRequestDecoder.TooManyFormFieldsException; |
|  |  | import io.netty.handler.codec.http.multipart.HttpPostRequestDecoder.TooLongFormFieldException; |
|  |  | import io.netty.util.ByteProcessor; |
|  |  | import io.netty.util.internal.PlatformDependent; |
|  |  | import io.netty.util.internal.StringUtil; |
| Expand Down  Expand Up | | @@ -63,6 +66,16 @@ public class HttpPostStandardRequestDecoder implements InterfaceHttpPostRequestD |
|  |  | \*/ |
|  |  | private final Charset charset; |
|  |  |  |
|  |  | /\*\* |
|  |  | \* The maximum number of fields allows by the form |
|  |  | \*/ |
|  |  | private final int maxFields; |
|  |  |  |
|  |  | /\*\* |
|  |  | \* The maximum number of accumulated bytes when decoding a field |
|  |  | \*/ |
|  |  | private final int maxBufferedBytes; |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Does the last chunk already received |
|  |  | \*/ |
| Expand Down  Expand Up | | @@ -148,9 +161,34 @@ public HttpPostStandardRequestDecoder(HttpDataFactory factory, HttpRequest reque |
|  |  | \* errors |
|  |  | \*/ |
|  |  | public HttpPostStandardRequestDecoder(HttpDataFactory factory, HttpRequest request, Charset charset) { |
|  |  | this(factory, request, charset, HttpPostRequestDecoder.DEFAULT\_MAX\_FIELDS, HttpPostRequestDecoder.DEFAULT\_MAX\_BUFFERED\_BYTES); |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
|  |  | \* |
|  |  | \* @param factory |
|  |  | \* the factory used to create InterfaceHttpData |
|  |  | \* @param request |
|  |  | \* the request to decode |
|  |  | \* @param charset |
|  |  | \* the charset to use as default |
|  |  | \* @param maxFields |
|  |  | \* the maximum number of fields the form can have, {@code -1} to disable |
|  |  | \* @param maxBufferedBytes |
|  |  | \* the maximum number of bytes the decoder can buffer when decoding a field, {@code -1} to disable |
|  |  | \* @throws NullPointerException |
|  |  | \* for request or charset or factory |
|  |  | \* @throws ErrorDataDecoderException |
|  |  | \* if the default charset was wrong when decoding or other |
|  |  | \* errors |
|  |  | \*/ |
|  |  | public HttpPostStandardRequestDecoder(HttpDataFactory factory, HttpRequest request, Charset charset, |
|  |  | int maxFields, int maxBufferedBytes) { |
|  |  | this.request = checkNotNull(request, "request"); |
|  |  | this.charset = checkNotNull(charset, "charset"); |
|  |  | this.factory = checkNotNull(factory, "factory"); |
|  |  | this.maxFields = maxFields; |
|  |  | this.maxBufferedBytes = maxBufferedBytes; |
|  |  | try { |
|  |  | if (request instanceof HttpContent) { |
|  |  | // Offer automatically if the given request is as type of HttpContent |
| Expand Down  Expand Up | | @@ -297,6 +335,9 @@ public HttpPostStandardRequestDecoder offer(HttpContent content) { |
|  |  | undecodedChunk.writeBytes(buf); |
|  |  | } |
|  |  | parseBody(); |
|  |  | if (maxBufferedBytes > 0 && undecodedChunk != null && undecodedChunk.readableBytes() > maxBufferedBytes) { |
|  |  | throw new TooLongFormFieldException(); |
|  |  | } |
|  |  | if (undecodedChunk != null && undecodedChunk.writerIndex() > discardThreshold) { |
|  |  | if (undecodedChunk.refCnt() == 1) { |
|  |  | // It's safe to call discardBytes() as we are the only owner of the buffer. |
| Expand Down  Expand Up | | @@ -387,6 +428,9 @@ protected void addHttpData(InterfaceHttpData data) { |
|  |  | if (data == null) { |
|  |  | return; |
|  |  | } |
|  |  | if (maxFields > 0 && bodyListHttpData.size() >= maxFields) { |
|  |  | throw new TooManyFormFieldsException(); |
|  |  | } |
|  |  | List<InterfaceHttpData> datas = bodyMapHttpData.get(data.getName()); |
|  |  | if (datas == null) { |
|  |  | datas = new ArrayList<InterfaceHttpData>(1); |
| Expand Down | |  |

102 changes: 102 additions & 0 deletions

102
[...-http/src/test/java/io/netty/handler/codec/http/multipart/HttpPostRequestDecoderTest.java](#diff-36eecd099979b5691efe93d972144bef7d825af8850ab576450bd902ab168b60 "codec-http/src/test/java/io/netty/handler/codec/http/multipart/HttpPostRequestDecoderTest.java")

Show comments

[View file](/netty/netty/blob/0d0c6ed782d13d423586ad0c71737b2c7d02058c/codec-http/src/test/java/io/netty/handler/codec/http/multipart/HttpPostRequestDecoderTest.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -19,6 +19,7 @@ |
|  |  | import io.netty.buffer.ByteBufAllocator; |
|  |  | import io.netty.buffer.Unpooled; |
|  |  | import io.netty.buffer.UnpooledByteBufAllocator; |
|  |  | import io.netty.handler.codec.DecoderException; |
|  |  | import io.netty.handler.codec.DecoderResult; |
|  |  | import io.netty.handler.codec.http.DefaultFullHttpRequest; |
|  |  | import io.netty.handler.codec.http.DefaultHttpContent; |
| Expand Down  Expand Up | | @@ -1040,4 +1041,105 @@ void testHttpPostStandardRequestDecoderToDiskNameContainingUnauthorizedChar() th |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | @Test |
|  |  | public void testTooManyFormFieldsPostStandardDecoder() { |
|  |  | HttpRequest req = new DefaultHttpRequest(HttpVersion.HTTP\_1\_1, HttpMethod.POST, "/"); |
|  |  |  |
|  |  | HttpPostRequestDecoder decoder = new HttpPostRequestDecoder(req, 1024, -1); |
|  |  |  |
|  |  | int num = 0; |
|  |  | while (true) { |
|  |  | try { |
|  |  | decoder.offer(new DefaultHttpContent(Unpooled.wrappedBuffer("foo=bar&".getBytes()))); |
|  |  | } catch (DecoderException e) { |
|  |  | assertEquals(HttpPostRequestDecoder.TooManyFormFieldsException.class, e.getClass()); |
|  |  | break; |
|  |  | } |
|  |  | assertTrue(num++ < 1024); |
|  |  | } |
|  |  | assertEquals(1024, num); |
|  |  | } |
|  |  |  |
|  |  | @Test |
|  |  | public void testTooManyFormFieldsPostMultipartDecoder() { |
|  |  | HttpRequest req = new DefaultHttpRequest(HttpVersion.HTTP\_1\_1, HttpMethod.POST, "/"); |
|  |  | req.headers().add("Content-Type", "multipart/form-data;boundary=be38b42a9ad2713f"); |
|  |  |  |
|  |  | HttpPostRequestDecoder decoder = new HttpPostRequestDecoder(req, 1024, -1); |
|  |  | decoder.offer(new DefaultHttpContent(Unpooled.wrappedBuffer("--be38b42a9ad2713f\n".getBytes()))); |
|  |  |  |
|  |  | int num = 0; |
|  |  | while (true) { |
|  |  | try { |
|  |  | byte[] bodyBytes = ("content-disposition: form-data; name=\"title\"\n" + |
|  |  | "content-length: 10\n" + |
|  |  | "content-type: text/plain; charset=UTF-8\n" + |
|  |  | "\n" + |
|  |  | "bar-stream\n" + |
|  |  | "--be38b42a9ad2713f\n").getBytes(); |
|  |  | ByteBuf content = Unpooled.wrappedBuffer(bodyBytes); |
|  |  | decoder.offer(new DefaultHttpContent(content)); |
|  |  | } catch (DecoderException e) { |
|  |  | assertEquals(HttpPostRequestDecoder.TooManyFormFieldsException.class, e.getClass()); |
|  |  | break; |
|  |  | } |
|  |  | assertTrue(num++ < 1024); |
|  |  | } |
|  |  | assertEquals(1024, num); |
|  |  | } |
|  |  |  |
|  |  | @Test |
|  |  | public void testTooLongFormFieldStandardDecoder() { |
|  |  | HttpRequest req = new DefaultHttpRequest(HttpVersion.HTTP\_1\_1, HttpMethod.POST, "/"); |
|  |  |  |
|  |  | HttpPostRequestDecoder decoder = new HttpPostRequestDecoder(req, -1, 16 \* 1024); |
|  |  |  |
|  |  | try { |
|  |  | decoder.offer(new DefaultHttpContent(Unpooled.wrappedBuffer(new byte[16 \* 1024 + 1]))); |
|  |  | fail(); |
|  |  | } catch (DecoderException e) { |
|  |  | assertEquals(HttpPostRequestDecoder.TooLongFormFieldException.class, e.getClass()); |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | @Test |
|  |  | public void testFieldGreaterThanMaxBufferedBytesStandardDecoder() { |
|  |  | HttpRequest req = new DefaultHttpRequest(HttpVersion.HTTP\_1\_1, HttpMethod.POST, "/"); |
|  |  |  |
|  |  | HttpPostRequestDecoder decoder = new HttpPostRequestDecoder(req, -1, 6); |
|  |  |  |
|  |  | decoder.offer(new DefaultHttpContent(Unpooled.wrappedBuffer("foo=bar".getBytes()))); |
|  |  | } |
|  |  |  |
|  |  | @Test |
|  |  | public void testTooLongFormFieldMultipartDecoder() { |
|  |  | HttpRequest req = new DefaultHttpRequest(HttpVersion.HTTP\_1\_1, HttpMethod.POST, "/"); |
|  |  | req.headers().add("Content-Type", "multipart/form-data;boundary=be38b42a9ad2713f"); |
|  |  |  |
|  |  | HttpPostRequestDecoder decoder = new HttpPostRequestDecoder(req, -1, 16 \* 1024); |
|  |  |  |
|  |  | try { |
|  |  | decoder.offer(new DefaultHttpContent(Unpooled.wrappedBuffer(new byte[16 \* 1024 + 1]))); |
|  |  | fail(); |
|  |  | } catch (DecoderException e) { |
|  |  | assertEquals(HttpPostRequestDecoder.TooLongFormFieldException.class, e.getClass()); |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | @Test |
|  |  | public void testFieldGreaterThanMaxBufferedBytesMultipartDecoder() { |
|  |  | HttpRequest req = new DefaultHttpRequest(HttpVersion.HTTP\_1\_1, HttpMethod.POST, "/"); |
|  |  | req.headers().add("Content-Type", "multipart/form-data;boundary=be38b42a9ad2713f"); |
|  |  |  |
|  |  | byte[] bodyBytes = ("content-disposition: form-data; name=\"title\"\n" + |
|  |  | "content-length: 10\n" + |
|  |  | "content-type: text/plain; charset=UTF-8\n" + |
|  |  | "\n" + |
|  |  | "bar-stream\n" + |
|  |  | "--be38b42a9ad2713f\n").getBytes(); |
|  |  |  |
|  |  | HttpPostRequestDecoder decoder = new HttpPostRequestDecoder(req, -1, bodyBytes.length - 1); |
|  |  |  |
|  |  | decoder.offer(new DefaultHttpContent(Unpooled.wrappedBuffer(bodyBytes))); |
|  |  | } |
|  |  | } |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `0d0c6ed`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fnetty%2Fnetty%2Fcommit%2F0d0c6ed782d13d423586ad0c71737b2c7d02058c) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from gist.github.com_90ceda02_20250111_191203.html ===

[Skip to content](#start-of-content)

[All gists](/discover)
[Back to GitHub](https://github.com)
[Sign in](https://gist.github.com/auth/github?return_to=https%3A%2F%2Fgist.github.com%2Fvietj%2Ff558b8ea81ec6505f1e9a6ca283c9ae3)
[Sign up](/join?return_to=https%3A%2F%2Fgist.github.com%2Fvietj%2Ff558b8ea81ec6505f1e9a6ca283c9ae3&source=header-gist)

[Sign in](https://gist.github.com/auth/github?return_to=https%3A%2F%2Fgist.github.com%2Fvietj%2Ff558b8ea81ec6505f1e9a6ca283c9ae3) [Sign up](/join?return_to=https%3A%2F%2Fgist.github.com%2Fvietj%2Ff558b8ea81ec6505f1e9a6ca283c9ae3&source=header-gist)

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

Instantly share code, notes, and snippets.

[![@vietj](https://avatars.githubusercontent.com/u/225674?s=64&v=4)](/vietj)

# [vietj](/vietj)/**[Reproducer.java](/vietj/f558b8ea81ec6505f1e9a6ca283c9ae3)** Secret

Created
March 16, 2024 11:35

Show Gist options

* [Download ZIP](/vietj/f558b8ea81ec6505f1e9a6ca283c9ae3/archive/e31e116af89e912a4e82e6fdd739abe0d62947ac.zip)

* [Star
  (0)
  0](/login?return_to=https%3A%2F%2Fgist.github.com%2Fvietj%2Ff558b8ea81ec6505f1e9a6ca283c9ae3)You must be signed in to star a gist
* [Fork
  (0)
  0](/login?return_to=https%3A%2F%2Fgist.github.com%2Fvietj%2Ff558b8ea81ec6505f1e9a6ca283c9ae3)You must be signed in to fork a gist

* Embed

  + Embed
     Embed this gist in your website.
  + Share
     Copy sharable link for this gist.
  + Clone via HTTPS
     Clone using the web URL.
  + [Learn more about clone URLs](https://docs.github.com/articles/which-remote-url-should-i-use)

  Clone this repository at &lt;script src=&quot;https://gist.github.com/vietj/f558b8ea81ec6505f1e9a6ca283c9ae3.js&quot;&gt;&lt;/script&gt;
* Save vietj/f558b8ea81ec6505f1e9a6ca283c9ae3 to your computer and use it in GitHub Desktop.

[Code](/vietj/f558b8ea81ec6505f1e9a6ca283c9ae3)
[Revisions
1](/vietj/f558b8ea81ec6505f1e9a6ca283c9ae3/revisions)

Embed

* Embed
   Embed this gist in your website.
* Share
   Copy sharable link for this gist.
* Clone via HTTPS
   Clone using the web URL.
* [Learn more about clone URLs](https://docs.github.com/articles/which-remote-url-should-i-use)

Clone this repository at &lt;script src=&quot;https://gist.github.com/vietj/f558b8ea81ec6505f1e9a6ca283c9ae3.js&quot;&gt;&lt;/script&gt;

Save vietj/f558b8ea81ec6505f1e9a6ca283c9ae3 to your computer and use it in GitHub Desktop.

[Download ZIP](/vietj/f558b8ea81ec6505f1e9a6ca283c9ae3/archive/e31e116af89e912a4e82e6fdd739abe0d62947ac.zip)

 [Raw](/vietj/f558b8ea81ec6505f1e9a6ca283c9ae3/raw/e31e116af89e912a4e82e6fdd739abe0d62947ac/Reproducer.java)

[**Reproducer.java**](#file-reproducer-java)

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

|  | public class Reproducer { |
| --- | --- |
|  |  |
|  | HttpServer server = vertx.createHttpServer(); |
|  | server.requestHandler(req -> { |
|  | req.setExpectMultipart(true); |
|  | req.endHandler(v -> { |
|  | System.out.println(req.formAttributes().size()); |
|  | req.response().end(); |
|  | }); |
|  | }); |
|  | server.listen(8080, "localhost").toCompletionStage().toCompletableFuture().get(); |
|  |  |
|  | HttpClient client = vertx.createHttpClient(); |
|  |  |
|  | client.request(new RequestOptions() |
|  | .setMethod(HttpMethod.POST) |
|  | .setHost("localhost") |
|  | .setPort(8080)).onComplete(onSuccess(req -> { |
|  | req.setChunked(true); |
|  | req.putHeader("content-type", "application/x-www-form-urlencoded"); |
|  | req.write("framework=vertx"); |
|  | send(req, 32\_000\_000 |
|  | ); |
|  | req |
|  | .response() |
|  | .compose(resp -> resp.body()) |
|  | .onComplete(onSuccess(v -> testComplete())); |
|  | })); |
|  |  |
|  | vertx.setPeriodic(1000, id -> { |
|  | System.out.println(Runtime.getRuntime().freeMemory()); |
|  | }); |
|  |  |
|  | await(); |
|  | } |
|  |  |
|  | private int seq = 0; |
|  | private Buffer buffer = Buffer.buffer(TestUtils.randomAlphaString(2048)); |
|  |  |
|  | private void send(HttpClientRequest req, int amount) { |
|  | int num = Math.min(64, amount); |
|  | for (int i = 0;i < num;i++) { |
|  | req.write("&item-" + seq++ + "="); |
|  | req.write(buffer); |
|  | } |
|  | int remaining = amount - num; |
|  | if (req.writeQueueFull()) { |
|  | req.drainHandler(v -> { |
|  | send(req, remaining); |
|  | }); |
|  | return; |
|  | } |
|  | if (remaining == 0) { |
|  | req.end(); |
|  | } else { |
|  | vertx.runOnContext(v -> send(req, remaining)); |
|  | } |
|  | } |
|  |  |
|  | } |

[Sign up for free](/join?source=comment-gist)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgist.github.com%2Fvietj%2Ff558b8ea81ec6505f1e9a6ca283c9ae3)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from lists.debian.org_e1d7978a_20250111_191205.html ===


---

[[Date Prev](msg00014.html)][[Date Next](msg00016.html)]
[[Thread Prev](msg00014.html)][[Thread Next](msg00016.html)]
[[Date Index](maillist.html#00015)]
[[Thread Index](threads.html#00015)]

# [SECURITY] [DLA 3834-1] netty security update

---

* *To*: debian-lts-announce <debian-lts-announce@lists.debian.org>
* *Subject*: [SECURITY] [DLA 3834-1] netty security update
* *From*: Markus Koschany <apo@debian.org>
* *Date*: Fri, 21 Jun 2024 23:34:04 +0200
* *Message-id*: <[[🔎]](/msgid-search/df5ed34d74fcfa5fa17bf4639976b69bc4331087.camel%40debian.org) [df5ed34d74fcfa5fa17bf4639976b69bc4331087.camel@debian.org](msg00015.html)>
* *Mail-followup-to*: debian-lts@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
-------------------------------------------------------------------------
Debian LTS Advisory DLA-3834-1                debian-lts@lists.debian.org
<https://www.debian.org/lts/security/>                      Markus Koschany
June 21, 2024                                 <https://wiki.debian.org/LTS>
-------------------------------------------------------------------------

Package        : netty
Version        : 1:4.1.33-1+deb10u5
CVE ID         : CVE-2024-29025
Debian Bug     : 1068110

Julien Viet discovered that Netty, a Java NIO client/server socket framework,
was vulnerable to allocation of resources without limits or throttling due to
the accumulation of data in the HttpPostRequestDecoder. This would allow an
attacker to cause a denial of service.

For Debian 10 buster, this problem has been fixed in version
1:4.1.33-1+deb10u5.

We recommend that you upgrade your netty packages.

For the detailed security status of netty please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/netty>

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>

```

**Attachment:
[signature.asc](pgphw82Y1YsRt.pgp)**

*Description:* This is a digitally signed message part

---



=== Content from github.com_71ea99b3_20250111_191205.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fnetty%2Fnetty%2Fsecurity%2Fadvisories%2FGHSA-5jpm-x58v-624v)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fnetty%2Fnetty%2Fsecurity%2Fadvisories%2FGHSA-5jpm-x58v-624v)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=netty%2Fnetty)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[netty](/netty)
/
**[netty](/netty/netty)**
Public

* [Notifications](/login?return_to=%2Fnetty%2Fnetty) You must be signed in to change notification settings
* [Fork
  16k](/login?return_to=%2Fnetty%2Fnetty)
* [Star
   33.7k](/login?return_to=%2Fnetty%2Fnetty)

* [Code](/netty/netty)
* [Issues
  575](/netty/netty/issues)
* [Pull requests
  39](/netty/netty/pulls)
* [Discussions](/netty/netty/discussions)
* [Actions](/netty/netty/actions)
* [Projects
  0](/netty/netty/projects)
* [Wiki](/netty/netty/wiki)
* [Security](/netty/netty/security)
* [Insights](/netty/netty/pulse)

Additional navigation options

* [Code](/netty/netty)
* [Issues](/netty/netty/issues)
* [Pull requests](/netty/netty/pulls)
* [Discussions](/netty/netty/discussions)
* [Actions](/netty/netty/actions)
* [Projects](/netty/netty/projects)
* [Wiki](/netty/netty/wiki)
* [Security](/netty/netty/security)
* [Insights](/netty/netty/pulse)

# HttpPostRequestDecoder can OOM

Moderate

[normanmaurer](/normanmaurer)
published
GHSA-5jpm-x58v-624v
Mar 25, 2024

## Package

maven

io.netty:netty-codec-http
([Maven](/advisories?query=ecosystem%3Amaven))

## Affected versions

< 4.1.108.Final

## Patched versions

4.1.108.Final

## Description

### Summary

The `HttpPostRequestDecoder` can be tricked to accumulate data. I have spotted currently two attack vectors

### Details

1. While the decoder can store items on the disk if configured so, there are no limits to the number of fields the form can have, an attacher can send a chunked post consisting of many small fields that will be accumulated in the `bodyListHttpData` list.
2. The decoder cumulates bytes in the `undecodedChunk` buffer until it can decode a field, this field can cumulate data without limits

### PoC

Here is a Netty branch that provides a fix + tests : <https://github.com/vietj/netty/tree/post-request-decoder>

Here is a reproducer with Vert.x (which uses this decoder) <https://gist.github.com/vietj/f558b8ea81ec6505f1e9a6ca283c9ae3>

### Impact

Any Netty based HTTP server that uses the `HttpPostRequestDecoder` to decode a form.

### Severity

Moderate

### CVE ID

CVE-2024-29025

### Weaknesses

No CWEs

### Credits

* [![@vietj](https://avatars.githubusercontent.com/u/225674?s=40&v=4)](/vietj)
  [vietj](/vietj)
  Reporter

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


