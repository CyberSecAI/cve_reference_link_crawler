

| [Powered by Foswiki, The Free and Open Source Wiki](https://foswiki.org/Home/WebHome) | * Default Български Čeština Dansk Deutsch Ελληνικά English Español Suomi Français Italiano 日本語 한글 Nederlands Norsk Polski Português Português brasileiro Русский Svenska tlhIngan Hol Türkçe Українська 简体中文 正體中文 |
| --- | --- |

* [About](https://foswiki.org/About/WebHome)
* [Blog](http://blog.foswiki.org)
* [Extensions](https://foswiki.org/Extensions/WebHome)
* [Documentation](https://foswiki.org/System/WebHome)
* [Community](https://foswiki.org/Community/WebHome)
* [Development](https://foswiki.org/Development/WebHome)
* [Tasks](https://foswiki.org/Tasks/WebHome)
* [Download](https://foswiki.org/Download/FoswikiRelease02x01x09)
* [Support](https://foswiki.org/Support/WebHome)
* [Sandbox](https://foswiki.org/Sandbox/WebHome)

You are here: [Foswiki](/)>[Support Web](/Support/WebHome)>[KnownIssuesOfFoswiki01x01](/Support/KnownIssuesOfFoswiki01x01)>[SecurityAlerts](/Support/SecurityAlerts)>[SecurityAlert-CVE-2023-24698](/Support/SecurityAlert-CVE-2023-24698 "Topic revision: 3 (06 Aug 2023 - 15:15:56)") (06 Aug 2023, [MichaelDaum](/Main/MichaelDaum))[Edit](/bin/edit/Support/SecurityAlert-CVE-2023-24698?t=1736515486 "Edit this topic text") [Attach](/bin/attach/Support/SecurityAlert-CVE-2023-24698 "Attach an image or document to this topic")  [![txt](/pub/System/DocumentGraphics/txt.png) plain text](/Support/SecurityAlert-CVE-2023-24698?skin=plain;template=SecurityAlertTextView)
# Security Alert: Local file inclusion vulnerability in viewfile

 ![IDEA!](/pub/System/DocumentGraphics/tip.png "IDEA!") ***Get Alerted:*** *to get immediate alerts* of high priority security issues, please join the low-volume `foswiki-announce` list - details at [Mailing Lists](/Community/MailingLists) The filename parameter isn't validated sufficiently and may be used to read any file on the server.

* [Severity Level](#Severity_Level)
* [MITRE Name for this Vulnerability](#MITRE_Name_for_this_Vulnerability)
* [Vulnerable Software Versions](#Vulnerable_Software_Versions)
## Severity Level

Severity 1 issue: The web server can be compromisedThe severity level was assigned by the Foswiki [SecurityTaskTeam](/Community/SecurityTaskTeam) as documented in [SecurityAlertProcess](/Development/SecurityAlertProcess)
## MITRE Name for this Vulnerability

The Common Vulnerabilities and Exposures project has assigned the name [CVE-2023-24698](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-24698) to this vulnerability.
## Vulnerable Software Versions

* [Foswiki 2.0.0](/Download/FoswikiRelease02x00x00), [Foswiki 2.0.0-RC1](/Download/FoswikiRelease02x00x00RC1), [Foswiki 2.0.0-RC2](/Download/FoswikiRelease02x00x00RC2), [Foswiki 2.0.1](/Download/FoswikiRelease02x00x01), [Foswiki 2.0.2](/Download/FoswikiRelease02x00x02), [Foswiki 2.0.3](/Download/FoswikiRelease02x00x03), [Foswiki 2.1.0](/Download/FoswikiRelease02x01x00), [Foswiki 2.1.0-Beta1](/Download/FoswikiRelease02x01x00Beta1), [Foswiki 2.1.1](/Download/FoswikiRelease02x01x01), [Foswiki 2.1.1-RC1](/Download/FoswikiRelease02x01x01-RC1), [Foswiki 2.1.1-RC2](/Download/FoswikiRelease02x01x01-RC2), [Foswiki 2.1.2](/Download/FoswikiRelease02x01x02), [Foswiki 2.1.3](/Download/FoswikiRelease02x01x03), [Foswiki 2.1.3-Beta1](/Download/FoswikiRelease02x01x03-Beta1), [Foswiki 2.1.3-Beta2](/Download/FoswikiRelease02x01x03-Beta2), [Foswiki 2.1.3-RC1](/Download/FoswikiRelease02x01x03-RC1), [Foswiki 2.1.4](/Download/FoswikiRelease02x01x04), [Foswiki 2.1.4-RC1](/Download/FoswikiRelease02x01x04-RC1), [Foswiki 2.1.4-RC2](/Download/FoswikiRelease02x01x04-RC2), [Foswiki 2.1.4-RC3](/Download/FoswikiRelease02x01x04-RC3), [Foswiki 2.1.5](/Download/FoswikiRelease02x01x05), [Foswiki 2.1.5-RC](/Download/FoswikiRelease02x01x05-RC), [Foswiki 2.1.6](/Download/FoswikiRelease02x01x06), [Foswiki 2.1.7](/Download/FoswikiRelease02x01x07)

Fixed in [Foswiki 2.1.8](/Download/FoswikiRelease02x01x08)
## Attack Vectors

A proof of concept isn't included here for security reasons. The attack can be scripted using `curl`.
The POC submitted by Steffen Weinreich allowed to read `/etc/passwd` but basically
any file could be accessed such as `lib/LocalSite.cfg` containing sensitive information like passwords and configiration details.
## Impact

Any file accessible by the user running the foswiki services (e.g. `www-data`) can be accessed using a specially crafted
http request to the viewfile endpoint.
## Details

The `filename` parameter isn't validated sufficiently in `Foswiki::Sandbox`
Basically any component using Foswiki::Sandbox::validateAttachmentName will be affected, not only viewfile. Yet viewfile is the most obvious vector.
## Countermeasures

* Apply hotfix in [Item15163](/Tasks/Item15163)
* Upgrade to the latest patched production [FoswikiRelease02x01x08](/Download/FoswikiRelease02x01x08).

## Authors and Credits

* Steffen Weinreich <steve@weinreich.org>

## Action Plan with Timeline

* 2022-08-05: Michael Daum was contacted by Steffen Weinreich <steve@weinreich.org>
* 2022-08-05: The POC was confirmed and the bug was analysed
* 2022-08-05: a preliminary patch was applied to foswiki.org and blog.foswiki.org to secure the system
* 2022-08-05: hotfix made available, security ML was informed
* 2022-08-06: updated hotfix
* 2022-10-22: CVE Request 1349733 for CVE ID Request ... first attempt
* 2023-01-26: CVE Request 1397709 for CVE ID Request ... second attempt
* 2023-03-08: CVE-2023-24698 approved
* 2023-08-06: fix released in Foswiki-2.1.8

[Edit](/bin/edit/Support/SecurityAlert-CVE-2023-24698?t=1736515486 "Edit this topic text")  | [Attach](/bin/attach/Support/SecurityAlert-CVE-2023-24698 "Attach an image or document to this topic") | [Print version](/Support/SecurityAlert-CVE-2023-24698?cover=print; "Printable version of this topic") | [History](/bin/oops/Support/SecurityAlert-CVE-2023-24698?template=oopshistory "View complete topic history"): r3 [<](/bin/compare/Support/SecurityAlert-CVE-2023-24698?rev1=2;rev2=3) [r2](/Support/SecurityAlert-CVE-2023-24698?rev=2) [<](/bin/compare/Support/SecurityAlert-CVE-2023-24698?rev1=1;rev2=2) [r1](/Support/SecurityAlert-CVE-2023-24698?rev=1) | [Backlinks](/Support/SecurityAlert-CVE-2023-24698?template=backlinksweb "Search the Support Web for topics that link to here") | [View wiki text](/Support/SecurityAlert-CVE-2023-24698?raw=on "View without formatting") | [Edit wiki text](/bin/edit/Support/SecurityAlert-CVE-2023-24698?t=1736515486;nowysiwyg=1 "Edit Wiki text") | [More topic actions](/Support/SecurityAlert-CVE-2023-24698?template=more&currrev=3 "Delete or rename this topic; set parent topic; view and compare revisions")Topic revision: r3 - 06 Aug 2023, [MichaelDaum](/Main/MichaelDaum)

[Support](/Support/WebHome)

* ![key](/pub/System/FamFamFamSilkIcons/key.png)[Log In](/bin/login?foswiki_origin=GET%2cview%2c/Support/SecurityAlert-CVE-2023-24698)
* ![add](/pub/System/FamFamFamSilkIcons/add.png)[Register](/System/UserRegistration)
## Quick Links

* [Support questions](/Support/SupportQuestions)
* [FAQ's](/Support/FAQ)
* [Tips](/Support/BestPracticeTips)
* [Extensions support](/Support/Extensions)
* [Supplemental documents](/Support/SupplementalDocuments)
* [Wiki consultants](/Support/WikiConsultants)

## Tools

* [![newtopic](/pub/System/DocumentGraphics/newtopic.png) Create New Topic](/Support/WebCreateNewTopic?topicparent=SecurityAlert-CVE-2023-24698)
* [![index](/pub/System/DocumentGraphics/index.png) Index](/Support/WebTopicList)
* [![searchtopic](/pub/System/DocumentGraphics/searchtopic.png) Search](/Support/WebSearch)
* [![changes](/pub/System/DocumentGraphics/changes.png) Changes](/Support/WebChanges)
* [![notify](/pub/System/DocumentGraphics/notify.png) Notifications](/Support/WebNotify)
* [![feed](/pub/System/DocumentGraphics/feed.png) RSS Feed](/Support/WebRss)
* [![statistics](/pub/System/DocumentGraphics/statistics.png) Statistics](/Support/WebStatistics)
* [![wrench](/pub/System/DocumentGraphics/wrench.png) Preferences](/Support/WebPreferences)

The copyright of the content on this website is held by the contributing authors, except where stated elsewhere. See [Copyright Statement](/Community/CopyrightStatement). [![Creative Commons License](https://foswiki.org/pub/System/SiteGraphics/cc-by-sa-3.0-88x31.png)](http://creativecommons.org/licenses/by-sa/3.0/)    [Legal Imprint](/About/LegalImprint)    [Privacy Policy](/Community/PrivacyPolicy)

