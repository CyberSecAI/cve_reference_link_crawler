

[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fchangeset%3Fnew%3D3115602%2540inpost-for-woocommerce%252Ftrunk%26old%3D3110579%2540inpost-for-woocommerce%252Ftrunk)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* [Reverse Diff](/changeset/3110579/inpost-for-woocommerce/trunk?old=3115602&old_path=%2Finpost-for-woocommerce%2Ftrunk)

---

# Changes in [inpost-for-woocommerce/trunk](/browser/inpost-for-woocommerce/trunk?rev=3115602 "Show entry in browser") [[3110579:3115602]](/log/inpost-for-woocommerce/trunk?rev=3115602&stop_rev=3110579 "Show revision log")

View differences
inline
side by side

Show
lines around each change

Show the changes in full context

Ignore:

Blank lines

Case changes

White space changes

Location:
[inpost-for-woocommerce/trunk](/browser/inpost-for-woocommerce/trunk?rev=3115602)
Files:

1 deleted
15 edited

* [languages/woocommerce-inpost-pl\_PL.mo](/browser/inpost-for-woocommerce/trunk/languages/woocommerce-inpost-pl_PL.mo?rev=3115602 "Show entry in browser")
  (modified)
  ([previous](/browser/inpost-for-woocommerce/trunk/languages/woocommerce-inpost-pl_PL.mo?rev=3110579 "Show previous version in browser"))
* [languages/woocommerce-inpost-pl\_PL.po](/browser/inpost-for-woocommerce/trunk/languages/woocommerce-inpost-pl_PL.po?rev=3115602 "Show entry in browser")
  (modified)
  ([2 diffs](#file1 "Show differences"))
* [lib](/browser/inpost-for-woocommerce/trunk/lib?rev=2819589 "Show what was removed (content at revision 3110579)")
  (deleted)
* [readme.txt](/browser/inpost-for-woocommerce/trunk/readme.txt?rev=3115602 "Show entry in browser")
  (modified)
  ([2 diffs](#file3 "Show differences"))
* [resources/assets/css/admin.css](/browser/inpost-for-woocommerce/trunk/resources/assets/css/admin.css?rev=3115602 "Show entry in browser")
  (modified)
  ([1 diff](#file4 "Show differences"))
* [resources/assets/js/front-blocks.js](/browser/inpost-for-woocommerce/trunk/resources/assets/js/front-blocks.js?rev=3115602 "Show entry in browser")
  (modified)
  ([1 diff](#file5 "Show differences"))
* [src/InspireLabs/WoocommerceInpost/EasyPack.php](/browser/inpost-for-woocommerce/trunk/src/InspireLabs/WoocommerceInpost/EasyPack.php?rev=3115602 "Show entry in browser")
  (modified)
  ([3 diffs](#file6 "Show differences"))
* [src/InspireLabs/WoocommerceInpost/EasyPack\_Helper.php](/browser/inpost-for-woocommerce/trunk/src/InspireLabs/WoocommerceInpost/EasyPack_Helper.php?rev=3115602 "Show entry in browser")
  (modified)
  ([4 diffs](#file7 "Show differences"))
* [src/InspireLabs/WoocommerceInpost/shipping/EasyPack\_Shipping\_Method\_Courier.php](/browser/inpost-for-woocommerce/trunk/src/InspireLabs/WoocommerceInpost/shipping/EasyPack_Shipping_Method_Courier.php?rev=3115602 "Show entry in browser")
  (modified)
  ([2 diffs](#file8 "Show differences"))
* [src/InspireLabs/WoocommerceInpost/shipping/EasyPack\_Shipping\_Method\_EsmartMix.php](/browser/inpost-for-woocommerce/trunk/src/InspireLabs/WoocommerceInpost/shipping/EasyPack_Shipping_Method_EsmartMix.php?rev=3115602 "Show entry in browser")
  (modified)
  ([1 diff](#file9 "Show differences"))
* [src/InspireLabs/WoocommerceInpost/shipping/EasyPack\_Shippng\_Parcel\_Machines.php](/browser/inpost-for-woocommerce/trunk/src/InspireLabs/WoocommerceInpost/shipping/EasyPack_Shippng_Parcel_Machines.php?rev=3115602 "Show entry in browser")
  (modified)
  ([4 diffs](#file10 "Show differences"))
* [src/InspireLabs/WoocommerceInpost/shipping/views/html-courier-parcel-dimensions.php](/browser/inpost-for-woocommerce/trunk/src/InspireLabs/WoocommerceInpost/shipping/views/html-courier-parcel-dimensions.php?rev=3115602 "Show entry in browser")
  (modified)
  ([2 diffs](#file11 "Show differences"))
* [src/InspireLabs/WoocommerceInpost/shipping/views/html-order-metabox-courier.php](/browser/inpost-for-woocommerce/trunk/src/InspireLabs/WoocommerceInpost/shipping/views/html-order-metabox-courier.php?rev=3115602 "Show entry in browser")
  (modified)
  ([5 diffs](#file12 "Show differences"))
* [src/InspireLabs/WoocommerceInpost/shipx/services/shipment/ShipX\_Shipment\_Service.php](/browser/inpost-for-woocommerce/trunk/src/InspireLabs/WoocommerceInpost/shipx/services/shipment/ShipX_Shipment_Service.php?rev=3115602 "Show entry in browser")
  (modified)
  ([1 diff](#file13 "Show differences"))
* [src/InspireLabs/WoocommerceInpost/shipx/services/shipment/ShipX\_Shipment\_Status\_Service.php](/browser/inpost-for-woocommerce/trunk/src/InspireLabs/WoocommerceInpost/shipx/services/shipment/ShipX_Shipment_Status_Service.php?rev=3115602 "Show entry in browser")
  (modified)
  ([2 diffs](#file14 "Show differences"))
* [woocommerce-inpost.php](/browser/inpost-for-woocommerce/trunk/woocommerce-inpost.php?rev=3115602 "Show entry in browser")
  (modified)
  ([1 diff](#file15 "Show differences"))

### Legend:

Unmodified
Added
Removed

* ## [inpost-for-woocommerce/trunk/languages/woocommerce-inpost-pl\_PL.po](/changeset/3115602/inpost-for-woocommerce/trunk/languages/woocommerce-inpost-pl_PL.po?old=3110579&old_path=inpost-for-woocommerce%2Ftrunk%2Flanguages%2Fwoocommerce-inpost-pl_PL.po "Show the [3110579:3115602] differences restricted to inpost-for-woocommerce/trunk/languages/woocommerce-inpost-pl_PL.po")

  | [r3110579](/browser/inpost-for-woocommerce/trunk/languages/woocommerce-inpost-pl_PL.po?rev=3110579#L6 "Show revision 3110579 of this file in browser") | [r3115602](/browser/inpost-for-woocommerce/trunk/languages/woocommerce-inpost-pl_PL.po?rev=3115602#L6 "Show revision 3115602 of this file in browser") |  |
  | --- | --- | --- |
  | 6 | 6 | "Report-Msgid-Bugs-To: https://wordpress.org/support/plugin/woocommerce-inpost\n" |
  | 7 | 7 | "POT-Creation-Date: 2018-08-24 13:01:34+00:00\n" |
  | 8 |  | "PO-Revision-Date: 2024-07-~~01 11:14~~+0300\n" |
  |  | 8 | "PO-Revision-Date: 2024-07-10 15:02+0300\n" |
  | 9 | 9 | "Last-Translator: \n" |
  | 10 | 10 | "Language-Team: \n" |
  | […](/browser/inpost-for-woocommerce/trunk/languages/woocommerce-inpost-pl_PL.po?rev=3110579#L1909) | […](/browser/inpost-for-woocommerce/trunk/languages/woocommerce-inpost-pl_PL.po?rev=3115602#L1909) |  |
  | 1909 | 1909 | msgid "Order has too long note, please check it and create shipment from order page." |
  | 1910 | 1910 | msgstr "Zamówienie ma zbyt długą notatkę. Sprawdź ją i utwórz przesyłkę na stronie zamówienia." |
  |  | 1911 |  |
  |  | 1912 | msgid "Send as several packages" |
  |  | 1913 | msgstr "Przesyłka wielopaczkowa" |
  |  | 1914 |  |
  |  | 1915 | msgid "Parcel id" |
  |  | 1916 | msgstr "ID wielo-paczki" |
* ## [inpost-for-woocommerce/trunk/readme.txt](/changeset/3115602/inpost-for-woocommerce/trunk/readme.txt?old=3110579&old_path=inpost-for-woocommerce%2Ftrunk%2Freadme.txt "Show the [3110579:3115602] differences restricted to inpost-for-woocommerce/trunk/readme.txt")

  | [r3110579](/browser/inpost-for-woocommerce/trunk/readme.txt?rev=3110579#L5 "Show revision 3110579 of this file in browser") | [r3115602](/browser/inpost-for-woocommerce/trunk/readme.txt?rev=3115602#L5 "Show revision 3115602 of this file in browser") |  |
  | --- | --- | --- |
  | 5 | 5 | Tested up to: 6.5 |
  | 6 | 6 | Requires PHP: 7.2 |
  | 7 |  | Stable tag: 1.4.~~4~~ |
  |  | 7 | Stable tag: 1.4.5 |
  | 8 | 8 | License: GPLv2 or later |
  | 9 | 9 | License URI: http://www.gnu.org/licenses/gpl-2.0.html |
  | […](/browser/inpost-for-woocommerce/trunk/readme.txt?rev=3110579#L42) | […](/browser/inpost-for-woocommerce/trunk/readme.txt?rev=3115602#L42) |  |
  | 42 | 42 | == Changelog == |
  | 43 | 43 |  |
  |  | 44 | = 1.4.5 = |
  |  | 45 | \* Fix: error on order status change |
  |  | 46 | \* Feat: add feature "Przesyłka wielopaczkowa" for method Courier standard |
  |  | 47 |  |
  | 44 | 48 | = 1.4.4 = |
  | 45 | 49 | \* Fix: integration with Flexible Shipping for feature "Druga paczka" |
* ## [inpost-for-woocommerce/trunk/resources/assets/css/admin.css](/changeset/3115602/inpost-for-woocommerce/trunk/resources/assets/css/admin.css?old=3053305&old_path=inpost-for-woocommerce%2Ftrunk%2Fresources%2Fassets%2Fcss%2Fadmin.css "Show the [3110579:3115602] differences restricted to inpost-for-woocommerce/trunk/resources/assets/css/admin.css")

  | [r3110579](/browser/inpost-for-woocommerce/trunk/resources/assets/css/admin.css?rev=3053305#L274 "Show revision 3110579 of this file in browser") | [r3115602](/browser/inpost-for-woocommerce/trunk/resources/assets/css/admin.css?rev=3115602#L274 "Show revision 3115602 of this file in browser") |  |
  | --- | --- | --- |
  | 274 | 274 | border: 3px solid #273ce8; |
  | 275 | 275 | } |
  |  | 276 |  |
  |  | 277 | .easypack-courier-repeat-block.divided { |
  |  | 278 | border: 2px solid #cecece; |
  |  | 279 | display: block; |
  |  | 280 | padding: 19px; |
  |  | 281 | border-radius: 10px; |
  |  | 282 | margin-bottom: 6px; |
  |  | 283 | } |
  |  | 284 |  |
  |  | 285 | .easypack-repeat-block-title { |
  |  | 286 | display: block; |
  |  | 287 | } |
  |  | 288 |  |
  |  | 289 | .easypack-courier-repeat-block-title { |
  |  | 290 | display: none; |
  |  | 291 | } |
  |  | 292 |  |
  |  | 293 | .easypack-courier-repeat-block-title.divided { |
  |  | 294 | display: block; |
  |  | 295 | } |
  |  | 296 |  |
  |  | 297 |  |
  |  | 298 | .easypack-courier-repeat-block-btn-close { |
  |  | 299 | background: #e5e3e3; |
  |  | 300 | font-size: 18px; |
  |  | 301 | border: 1px solid #000; |
  |  | 302 | border-radius: 3px; |
  |  | 303 | text-align: center; |
  |  | 304 | width:26px; |
  |  | 305 | height:26px; |
  |  | 306 | display:none; |
  |  | 307 | float:right; |
  |  | 308 | margin-bottom: 10px; |
  |  | 309 | } |
  |  | 310 | .easypack-courier-repeat-block-btn-close.divided { |
  |  | 311 | display: block; |
  |  | 312 | } |
  |  | 313 | .easypack-courier-repeat-block-btn-close:hover { |
  |  | 314 | cursor:pointer; |
  |  | 315 | } |
  |  | 316 | .easypack\_divide\_parcel { |
  |  | 317 | display: none; |
  |  | 318 | margin: auto; |
  |  | 319 | width: 100%; |
  |  | 320 | margin-bottom: 10px; |
  |  | 321 | } |
  |  | 322 | .easypack\_divide\_parcel.divided { |
  |  | 323 | display: flex; |
  |  | 324 | } |
  |  | 325 | .easypack\_divide\_parcel:hover { |
  |  | 326 | cursor:pointer; |
  |  | 327 | } |
  |  | 328 | .easypack\_divide\_parcel\_title { |
  |  | 329 | margin: auto; |
  |  | 330 | padding-bottom: 3px; |
  |  | 331 | } |
  |  | 332 | .easypack\_parcel input { |
  |  | 333 | line-height: normal; |
  |  | 334 | } |
  |  | 335 |  |
  |  | 336 | #easypack\_wielopak\_label { |
  |  | 337 | background: #f5f5cc; |
  |  | 338 | padding: 2px; |
  |  | 339 | } |
* ## [inpost-for-woocommerce/trunk/resources/assets/js/front-blocks.js](/changeset/3115602/inpost-for-woocommerce/trunk/resources/assets/js/front-blocks.js?old=3087656&old_path=inpost-for-woocommerce%2Ftrunk%2Fresources%2Fassets%2Fjs%2Ffront-blocks.js "Show the [3110579:3115602] differences restricted to inpost-for-woocommerce/trunk/resources/assets/js/front-blocks.js")

  | [r3110579](/browser/inpost-for-woocommerce/trunk/resources/assets/js/front-blocks.js?rev=3087656#L289 "Show revision 3110579 of this file in browser") | [r3115602](/browser/inpost-for-woocommerce/trunk/resources/assets/js/front-blocks.js?rev=3115602#L289 "Show revision 3115602 of this file in browser") |  |
  | --- | --- | --- |
  | 289 | 289 |  |
  | 290 | 290 |  |
  | 291 |  | }, ~~5~~00 ); |
  |  | 291 | }, 1200 ); |
  | 292 | 292 | }); |
  | 293 | 293 |  |
* ## [inpost-for-woocommerce/trunk/src/InspireLabs/WoocommerceInpost/EasyPack.php](/changeset/3115602/inpost-for-woocommerce/trunk/src/InspireLabs/WoocommerceInpost/EasyPack.php?old=3087656&old_path=inpost-for-woocommerce%2Ftrunk%2Fsrc%2FInspireLabs%2FWoocommerceInpost%2FEasyPack.php "Show the [3110579:3115602] differences restricted to inpost-for-woocommerce/trunk/src/InspireLabs/WoocommerceInpost/EasyPack.php")

  | [r3110579](/browser/inpost-for-woocommerce/trunk/src/InspireLabs/WoocommerceInpost/EasyPack.php?rev=3087656#L562 "Show revision 3110579 of this file in browser") | [r3115602](/browser/inpost-for-woocommerce/trunk/src/InspireLabs/WoocommerceInpost/EasyPack.php?rev=3115602#L562 "Show revision 3115602 of this file in browser") |  |
  | --- | --- | --- |
  | 562 | 562 | $current\_screen = get\_current\_screen(); |
  | 563 | 563 |  |
  |  | 564 | $admin\_css\_path = $this->\_pluginPath . '/resources/assets/css/admin.css'; |
  |  | 565 | $admin\_css\_path\_ver = file\_exists( $admin\_css\_path ) ? filemtime( $admin\_css\_path ) : '1.4.5'; |
  |  | 566 |  |
  | 564 | 567 | if ( is\_a( $current\_screen, 'WP\_Screen' ) && 'inpost\_page\_easypack\_shipment' === $current\_screen->id ) { |
  | 565 |  | wp\_enqueue\_style('easypack-admin', $this->getPluginCss() . 'admin.css'); |
  |  | 568 | wp\_enqueue\_style('easypack-admin', $this->getPluginCss() . 'admin.css', [], $admin\_css\_path\_ver ); |
  | 566 | 569 | } |
  | 567 | 570 |  |
  | […](/browser/inpost-for-woocommerce/trunk/src/InspireLabs/WoocommerceInpost/EasyPack.php?rev=3087656#L574) | […](/browser/inpost-for-woocommerce/trunk/src/InspireLabs/WoocommerceInpost/EasyPack.php?rev=3115602#L577) |  |
  | 574 | 577 |  |
  | 575 | 578 | if ('shop\_order\_placehold' === $post\_type) { |
  | 576 |  | wp\_enqueue\_style('easypack-admin', $this->getPluginCss() . 'admin.css'); |
  |  | 579 | wp\_enqueue\_style('easypack-admin', $this->getPluginCss() . 'admin.css', [], $admin\_css\_path\_ver); |
  | 577 | 580 | } |
  | 578 | 581 | } else { |
  | 579 | 582 |  |
  | 580 | 583 | if ( is\_a( $current\_screen, 'WP\_Screen' ) && 'woocommerce\_page\_wc-orders' === $current\_screen->id ) { |
  | 581 |  | wp\_enqueue\_style('easypack-admin', $this->getPluginCss() . 'admin.css'); |
  |  | 584 | wp\_enqueue\_style('easypack-admin', $this->getPluginCss() . 'admin.css', [], $admin\_css\_path\_ver); |
  | 582 | 585 | } |
  | 583 | 586 | } |
  | […](/browser/inpost-for-woocommerce/trunk/src/InspireLabs/WoocommerceInpost/EasyPack.php?rev=3087656#L591) | […](/browser/inpost-for-woocommerce/trunk/src/InspireLabs/WoocommerceInpost/EasyPack.php?rev=3115602#L594) |  |
  | 591 | 594 |  |
  | 592 | 595 | if ( 'shop\_order' === $post\_type ) { |
  | 593 |  | wp\_enqueue\_style('easypack-admin', $this->getPluginCss() . 'admin.css'); |
  |  | 596 | wp\_enqueue\_style('easypack-admin', $this->getPluginCss() . 'admin.css', [], $admin\_css\_path\_ver); |
  | 594 | 597 | } |
  | 595 | 598 | } |
* ## [inpost-for-woocommerce/trunk/src/InspireLabs/WoocommerceInpost/EasyPack\_Helper.php](/changeset/3115602/inpost-for-woocommerce/trunk/src/InspireLabs/WoocommerceInpost/EasyPack_Helper.php?old=3110579&old_path=inpost-for-woocommerce%2Ftrunk%2Fsrc%2FInspireLabs%2FWoocommerceInpost%2FEasyPack_Helper.php "Show the [3110579:3115602] differences restricted to inpost-for-woocommerce/trunk/src/InspireLabs/WoocommerceInpost/EasyPack_Helper.php")

  | [r3110579](/browser/inpost-for-woocommerce/trunk/src/InspireLabs/WoocommerceInpost/EasyPack_Helper.php?rev=3110579#L3 "Show revision 3110579 of this file in browser") | [r3115602](/browser/inpost-for-woocommerce/trunk/src/InspireLabs/WoocommerceInpost/EasyPack_Helper.php?rev=3115602#L3 "Show revision 3115602 of this file in browser") |  |
  | --- | --- | --- |
  | 3 | 3 | namespace InspireLabs\WoocommerceInpost; |
  | 4 | 4 |  |
  | 5 |  | use ConcatPdf; |
  |  | 5 |  |
  | 6 | 6 | use InspireLabs\WoocommerceInpost\EasyPack; |
  | 7 | 7 | use Exception; |
  | […](/browser/inpost-for-woocommerce/trunk/src/InspireLabs/WoocommerceInpost/EasyPack_Helper.php?rev=3110579#L28) | […](/browser/inpost-for-woocommerce/trunk/src/InspireLabs/WoocommerceInpost/EasyPack_Helper.php?rev=3115602#L28) |  |
  | 28 | 28 |  |
  | 29 | 29 | public function \_\_construct() { |
  | 30 |  | add\_filter( 'query\_vars', [ $this, 'query\_vars' ] ); |
  | 31 |  | add\_action( 'parse\_request', [ $this, 'parse\_request' ] ); |
  |  | 30 | add\_filter( 'query\_vars', [ $this, 'query\_vars' ] ); |
  | 32 | 31 |  |
  | 33 | 32 | add\_action( 'woocommerce\_before\_my\_account', [ $this, 'woocommerce\_before\_my\_account' ] ); |
  | […](/browser/inpost-for-woocommerce/trunk/src/InspireLabs/WoocommerceInpost/EasyPack_Helper.php?rev=3110579#L43) | […](/browser/inpost-for-woocommerce/trunk/src/InspireLabs/WoocommerceInpost/EasyPack_Helper.php?rev=3115602#L42) |  |
  | 43 | 42 | } |
  | 44 | 43 |  |
  | 45 |  | ~~public function write\_stickers\_to\_file( $stickers = [] ) {~~ |
  | 46 |  | ~~$temp\_dir = trailingslashit( get\_temp\_dir() );~~ |
  | 47 |  | ~~if ( sizeof( $stickers ) == 1 ) {~~ |
  | 48 |  | ~~$temp\_file = tempnam( $temp\_dir, 'ep' );~~ |
  | 49 |  | ~~$fp        = fopen( $temp\_file, 'w' );~~ |
  | 50 |  | ~~fwrite( $fp, $stickers[0] );~~ |
  | 51 |  | ~~fclose( $fp );~~ |
  | 52 |  | ~~} else {~~ |
  | 53 |  | ~~$files = [];~~ |
  | 54 |  | ~~foreach ( $stickers as $sticker ) {~~ |
  | 55 |  | ~~$temp\_file = tempnam( $temp\_dir, 'ep' );~~ |
  | 56 |  | ~~$fp        = fopen( $temp\_file, 'w' );~~ |
  | 57 |  | ~~fwrite( $fp, $sticker );~~ |
  | 58 |  | ~~fclose( $fp );~~ |
  | 59 |  | ~~$files[] = $temp\_file;~~ |
  | 60 |  | ~~}~~ |
  | 61 |  |  |
  | 62 |  | ~~$temp\_file = tempnam( $temp\_dir, 'ep' );~~ |
  | 63 |  | ~~$pdf       = new ConcatPdf();~~ |
  | 64 |  | ~~$pdf->setFiles( $files );~~ |
  | 65 |  | ~~$pdf->concat();~~ |
  | 66 |  | ~~$pdf->Output( $temp\_file, 'F' );~~ |
  | 67 |  | ~~foreach ( $files as $file ) {~~ |
  | 68 |  | ~~unlink( $file );~~ |
  | 69 |  | ~~}~~ |
  | 70 |  | ~~}~~ |
  | 71 |  |  |
  | 72 |  | ~~return $temp\_file;~~ |
  | 73 |  | ~~}~~ |
  | 74 |  |  |
  | 75 |  | ~~public function get\_file( $file, $file\_name, $content\_type = '' ) {~~ |
  | 76 |  |  |
  | 77 |  | ~~header( 'Content-type: ' . $content\_type );~~ |
  | 78 |  | ~~header( 'Content-Disposition: attachment; filename="' . $file\_name~~ |
  | 79 |  | ~~. '"' );~~ |
  | 80 |  | ~~header( 'Content-Transfer-Encoding: binary' );~~ |
  | 81 |  | ~~header( 'Content-Length: ' . filesize( $file ) );~~ |
  | 82 |  | ~~header( 'Accept-Ranges: bytes' );~~ |
  | 83 |  |  |
  | 84 |  | ~~@readfile( $file );~~ |
  | 85 |  |  |
  | 86 |  | ~~unlink( $file );~~ |
  | 87 |  |  |
  | 88 |  | ~~}~~ |
  | 89 | 44 |  |
  | 90 | 45 |  |
  | […](/browser/inpost-for-woocommerce/trunk/src/InspireLabs/WoocommerceInpost/EasyPack_Helper.php?rev=3110579#L260) | […](/browser/inpost-for-woocommerce/trunk/src/InspireLabs/WoocommerceInpost/EasyPack_Helper.php?rev=3115602#L215) |  |
  | 260 | 215 |  |
  | 261 | 216 | return $query\_vars; |
  | 262 |  | ~~}~~ |
  | 263 |  |  |
  | 264 |  | ~~/\*\*~~ |
  | 265 |  | ~~\* Parse the request~~ |
  | 266 |  | ~~\*/~~ |
  | 267 |  | ~~public function parse\_request( &$wp ) {~~ |
  | 268 |  | ~~if ( array\_key\_exists( 'easypack\_download', $wp->query\_vars ) ) {~~ |
  | 269 |  | ~~if ( isset( $\_GET['easypack\_parcel\_machines\_stickers'] )~~ |
  | 270 |  | ~~&& $\_GET['easypack\_parcel\_machines\_stickers'] == '1'~~ |
  | 271 |  | ~~) {~~ |
  | 272 |  | ~~EasyPack\_Shippng\_Parcel\_Machines::get\_stickers();~~ |
  | 273 |  | ~~}~~ |
  | 274 |  | ~~if ( isset( $\_GET['easypack\_file'] ) ) {~~ |
  | 275 |  | ~~$temp\_dir = trailingslashit( get\_temp\_dir() );~~ |
  | 276 |  | ~~$file     = $temp\_dir . sanitize\_text\_field( $\_GET['easypack\_file'] );~~ |
  | 277 |  | ~~$this->get\_file( $file,~~ |
  | 278 |  | ~~\_\_( 'stickers', 'woocommerce-inpost' ) . '\_' . time()~~ |
  | 279 |  | ~~. '.pdf', 'application/pdf' );~~ |
  | 280 |  | ~~}~~ |
  | 281 |  |  |
  | 282 |  | ~~exit;~~ |
  | 283 |  | ~~}~~ |
  | 284 | 217 | } |
  | 285 | 218 |  |
* ## [inpost-for-woocommerce/trunk/src/InspireLabs/WoocommerceInpost/shipping/EasyPack\_Shipping\_Method\_Courier.php](/changeset/3115602/inpost-for-woocommerce/trunk/src/InspireLabs/WoocommerceInpost/shipping/EasyPack_Shipping_Method_Courier.php?old=3110579&old_path=inpost-for-woocommerce%2Ftrunk%2Fsrc%2FInspireLabs%2FWoocommerceInpost%2Fshipping%2FEasyPack_Shipping_Method_Courier.php "Show the [3110579:3115602] differences restricted to inpost-for-woocommerce/trunk/src/InspireLabs/WoocommerceInpost/shipping/EasyPack_Shipping_Method_Courier.php")

  | [r3110579](/browser/inpost-for-woocommerce/trunk/src/InspireLabs/WoocommerceInpost/shipping/EasyPack_Shipping_Method_Courier.php?rev=3110579#L252 "Show revision 3110579 of this file in browser") | [r3115602](/browser/inpost-for-woocommerce/trunk/src/InspireLabs/WoocommerceInpost/shipping/EasyPack_Shipping_Method_Courier.php?rev=3115602#L252 "Show revision 3115602 of this file in browser") |  |
  | --- | --- | --- |
  | 252 | 252 |  |
  | 253 | 253 | $courier\_parcel\_data = array(); |
  |  | 254 |  |
  | 254 | 255 | // if Bulk create shipments |
  | 255 | 256 | if( isset( $\_POST['action']) && $\_POST['action'] === 'easypack\_bulk\_create\_shipments' ) { |
  | […](/browser/inpost-for-woocommerce/trunk/src/InspireLabs/WoocommerceInpost/shipping/EasyPack_Shipping_Method_Courier.php?rev=3110579#L308) | […](/browser/inpost-for-woocommerce/trunk/src/InspireLabs/WoocommerceInpost/shipping/EasyPack_Shipping_Method_Courier.php?rev=3115602#L309) |  |
  | 308 | 309 | : $order\_id; |
  | 309 | 310 |  |
  | 310 |  | $parcels = isset( $\_POST['parcels'] ) |
  | 311 |  | ? array\_map( 'sanitize\_text\_field', $\_POST['parcels'] ) |
  | 312 |  | : array( get\_option( 'easypack\_default\_package\_size' ) ); |
  |  | 311 | $parcels = []; |
  |  | 312 | if( isset( $\_POST['parcel\_mode']) && $\_POST['parcel\_mode'] === 'wielopaki' ) { |
  |  | 313 | if (isset($\_POST['parcels']) && is\_array($\_POST['parcels'])) { |
  |  | 314 | foreach ($\_POST['parcels'] as $i => $p) { |
  |  | 315 | $parcels[$i]['id'] = isset($p['id']) ? sanitize\_text\_field($p['id']) : ''; |
  |  | 316 | $parcels[$i]['is\_non\_standard'] = isset($p['is\_non\_standard']) ? sanitize\_text\_field($p['is\_non\_standard']) : ''; |
  |  | 317 | $parcels[$i]['weight']['amount'] = isset($p['weight']['amount']) ? sanitize\_text\_field($p['weight']['amount']) : ''; |
  |  | 318 | $parcels[$i]['dimensions']['length'] = isset($p['dimensions']['length']) ? sanitize\_text\_field($p['dimensions']['length']) : ''; |
  |  | 319 | $parcels[$i]['dimensions']['width'] = isset($p['dimensions']['width']) ? sanitize\_text\_field($p['dimensions']['width']) : ''; |
  |  | 320 | $parcels[$i]['dimensions']['height'] = isset($p['dimensions']['height'])  ? sanitize\_text\_field($p['dimensions']['height']) : ''; |
  |  | 321 | } |
  |  | 322 | } |
  |  | 323 | } |
  | 313 | 324 | } |
  | 314 | 325 |  |
* ## [inpost-for-woocommerce/trunk/src/InspireLabs/WoocommerceInpost/shipping/EasyPack\_Shipping\_Method\_EsmartMix.php](/changeset/3115602/inpost-for-woocommerce/trunk/src/InspireLabs/WoocommerceInpost/shipping/EasyPack_Shipping_Method_EsmartMix.php?old=3110579&old_path=inpost-for-woocommerce%2Ftrunk%2Fsrc%2FInspireLabs%2FWoocommerceInpost%2Fshipping%2FEasyPack_Shipping_Method_EsmartMix.php "Show the [3110579:3115602] differences restricted to inpost-for-woocommerce/trunk/src/InspireLabs/WoocommerceInpost/shipping/EasyPack_Shipping_Method_EsmartMix.php")

  | [r3110579](/browser/inpost-for-woocommerce/trunk/src/InspireLabs/WoocommerceInpost/shipping/EasyPack_Shipping_Method_EsmartMix.php?rev=3110579#L366 "Show revision 3110579 of this file in browser") | [r3115602](/browser/inpost-for-woocommerce/trunk/src/InspireLabs/WoocommerceInpost/shipping/EasyPack_Shipping_Method_EsmartMix.php?rev=3115602#L366 "Show revision 3115602 of this file in browser") |  |
  | --- | --- | --- |
  | 366 | 366 | unset( $shipment\_array['commercial\_product\_identifier']); |
  | 367 | 367 |  |
  | 368 |  | ~~//            error\_log(print\_r(\_\_METHOD\_\_ . ": " . \_\_LINE\_\_, true));~~ |
  | 369 |  | ~~//            error\_log(print\_r($\_POST, true));~~ |
  | 370 |  | ~~//~~ |
  | 371 |  | ~~//            error\_log(print\_r( 'SmartCourier ajax\_create\_package', true));~~ |
  | 372 |  | ~~//            error\_log(print\_r( $shipment\_array, true));~~ |
  | 373 |  | ~~//            die;~~ |
  | 374 | 368 |  |
  | 375 | 369 | try { |
* ## [inpost-for-woocommerce/trunk/src/InspireLabs/WoocommerceInpost/shipping/EasyPack\_Shippng\_Parcel\_Machines.php](/changeset/3115602/inpost-for-woocommerce/trunk/src/InspireLabs/WoocommerceInpost/shipping/EasyPack_Shippng_Parcel_Machines.php?old=3110579&old_path=inpost-for-woocommerce%2Ftrunk%2Fsrc%2FInspireLabs%2FWoocommerceInpost%2Fshipping%2FEasyPack_Shippng_Parcel_Machines.php "Show the [3110579:3115602] differences restricted to inpost-for-woocommerce/trunk/src/InspireLabs/WoocommerceInpost/shipping/EasyPack_Shippng_Parcel_Machines.php")

  | [r3110579](/browser/inpost-for-woocommerce/trunk/src/InspireLabs/WoocommerceInpost/shipping/EasyPack_Shippng_Parcel_Machines.php?rev=3110579#L1299 "Show revision 3110579 of this file in browser") | [r3115602](/browser/inpost-for-woocommerce/trunk/src/InspireLabs/WoocommerceInpost/shipping/EasyPack_Shippng_Parcel_Machines.php?rev=3115602#L1299 "Show revision 3115602 of this file in browser") |  |
  | --- | --- | --- |
  | 1299 | 1299 | } |
  | 1300 | 1300 |  |
  | 1301 |  | public static function get\_stickers() { |
  | 1302 |  |  |
  | 1303 |  | $nonce = $\_GET['security']; |
  | 1304 |  | if ( ! wp\_verify\_nonce( $nonce, 'easypack\_nonce' ) ) { |
  | 1305 |  | echo \_\_( 'Security check - bad nonce!', 'woocommerce-inpost' ); |
  | 1306 |  | return; |
  | 1307 |  | } |
  | 1308 |  |  |
  | 1309 |  | $order\_id = sanitize\_text\_field( $\_GET['order\_id'] ); |
  | 1310 |  | $order    = wc\_get\_order( $order\_id ); |
  | 1311 |  | //$post     = get\_post( $order\_id ); |
  | 1312 |  |  |
  | 1313 |  | $status = get\_post\_meta( $order\_id, '\_easypack\_status', true ); |
  | 1314 |  |  |
  | 1315 |  | $easypack\_parcels = get\_post\_meta( $order\_id, '\_easypack\_parcels', true ); |
  | 1316 |  |  |
  | 1317 |  | $stickers = []; |
  | 1318 |  |  |
  | 1319 |  | if ( $easypack\_parcels ) { |
  | 1320 |  | foreach ( $easypack\_parcels as $key => $parcel ) { |
  | 1321 |  | try { |
  | 1322 |  | $easypack\_data = EasyPack\_API()->customer\_parcel( $parcel['easypack\_data']['id'] ); |
  | 1323 |  | if ( $parcel['easypack\_data']['status'] != $easypack\_data['status'] ) { |
  | 1324 |  | $parcel['easypack\_data']  = $easypack\_data; |
  | 1325 |  | $easypack\_parcels[ $key ] = $parcel; |
  | 1326 |  | update\_post\_meta( $order\_id, '\_easypack\_parcels', $easypack\_parcels ); |
  | 1327 |  | } |
  | 1328 |  | if ( $parcel['easypack\_data']['status'] == 'created' ) { |
  | 1329 |  | $easypack\_data = EasyPack\_API()->customer\_parcel\_pay( $parcel['easypack\_data']['id'] ); |
  | 1330 |  | $easypack\_parcels[ $key ]['easypack\_data'] = $easypack\_data; |
  | 1331 |  | update\_post\_meta( $order\_id, '\_easypack\_parcels', $easypack\_parcels ); |
  | 1332 |  | } |
  | 1333 |  | $stickers[] = EasyPack\_API()->customer\_parcel\_sticker( $parcel['easypack\_data']['id'] ); |
  | 1334 |  | } catch ( Exception $e ) { |
  | 1335 |  | echo $e->getMessage(); |
  | 1336 |  |  |
  | 1337 |  | return; |
  | 1338 |  | } |
  | 1339 |  | } |
  | 1340 |  | } |
  | 1341 |  |  |
  | 1342 |  | $file = EasyPack\_Helper()->write\_stickers\_to\_file( $stickers ); |
  | 1343 |  | if ( $status == 'created' ) { |
  | 1344 |  | update\_post\_meta( $order\_id, '\_easypack\_status', 'prepared' ); |
  | 1345 |  | } |
  | 1346 |  | EasyPack\_Helper()->get\_file( $file, |
  | 1347 |  | \_\_( 'stickers', 'woocommerce-inpost' ) . '\_' |
  | 1348 |  | . $order->get\_id() |
  | 1349 |  | . '.pdf', 'application/pdf' ); |
  | 1350 |  | } |
  |  | 1301 |  |
  | 1351 | 1302 |  |
  | 1352 | 1303 | function woocommerce\_cart\_shipping\_method\_full\_label( $label, $method ) { |
  | […](/browser/inpost-for-woocommerce/trunk/src/InspireLabs/WoocommerceInpost/shipping/EasyPack_Shippng_Parcel_Machines.php?rev=3110579#L1955) | […](/browser/inpost-for-woocommerce/trunk/src/InspireLabs/WoocommerceInpost/shipping/EasyPack_Shippng_Parcel_Machines.php?rev=3115602#L1906) |  |
  | 1955 | 1906 | sleep(1); |
  | 1956 | 1907 | //$search\_in\_api = EasyPack\_API()->customer\_parcel\_get\_by\_id( $shipment\_model->getInternalData()->getInpostId() ); |
  | 1957 |  | $search\_in\_api = EasyPack\_API()->customer\_parcel\_get\_by\_id($response['id']); |
  |  | 1908 | $search\_in\_api = EasyPack\_API()->customer\_parcel\_get\_by\_id( $response['id'] ); |
  |  | 1909 |  |
  | 1958 | 1910 | if (isset($search\_in\_api['items'][0]['tracking\_number'])) { |
  | 1959 | 1911 | $shipment\_data['tracking'] = $search\_in\_api['items'][0]['tracking\_number']; |
  | […](/browser/inpost-for-woocommerce/trunk/src/InspireLabs/WoocommerceInpost/shipping/EasyPack_Shippng_Parcel_Machines.php?rev=3110579#L1992) | […](/browser/inpost-for-woocommerce/trunk/src/InspireLabs/WoocommerceInpost/shipping/EasyPack_Shippng_Parcel_Machines.php?rev=3115602#L1944) |  |
  | 1992 | 1944 | } |
  | 1993 | 1945 |  |
  | 1994 |  | if( isset($shipment\_data['~~tracking']) && ! empty( $shipment\_data['tracking~~'] ) ) { |
  |  | 1946 | if( isset($shipment\_data['inpost\_id']) && ! empty( $shipment\_data['inpost\_id'] ) ) { |
  | 1995 | 1947 |  |
  | 1996 | 1948 | if( ! $is\_additional\_package\_processing ) { |
  | 1997 |  | $shipment\_model->getInternalData()->setTrackingNumber($shipment\_data['tracking']); |
  | 1998 |  | update\_post\_meta( $order\_id, '\_easypack\_parcel\_tracking', $shipment\_data['tracking'] ); |
  | 1999 |  | if( $order && ! is\_wp\_error($order) ) { |
  | 2000 |  | $order->update\_meta\_data('\_easypack\_parcel\_tracking', $shipment\_data['tracking']); |
  | 2001 |  | $order->save(); |
  | 2002 |  | } |
  | 2003 |  |  |
  | 2004 |  | /\*if ('yes' === get\_option('woocommerce\_custom\_orders\_table\_enabled')) { |
  |  | 1949 | if( isset($shipment\_data['tracking']) && ! empty( $shipment\_data['tracking'] ) ) { |
  |  | 1950 | $shipment\_model->getInternalData()->setTrackingNumber($shipment\_data['tracking']); |
  |  | 1951 | update\_post\_meta($order\_id, '\_easypack\_parcel\_tracking', $shipment\_data['tracking']); |
  | 2005 | 1952 | if ($order && !is\_wp\_error($order)) { |
  | 2006 | 1953 | $order->update\_meta\_data('\_easypack\_parcel\_tracking', $shipment\_data['tracking']); |
  | 2007 | 1954 | $order->save(); |
  | 2008 | 1955 | } |
  | 2009 |  | }\*/ |
  |  | 1956 | } |
  |  | 1957 |  |
  | 2010 | 1958 | } else { |
  | 2011 |  | $additional\_package[$inpost\_method]['tracking'] = ~~$shipment\_data['tracking']~~; |
  |  | 1959 | $additional\_package[$inpost\_method]['tracking'] = isset($shipment\_data['tracking']) ? $shipment\_data['tracking'] : ''; |
  | 2012 | 1960 | $additional\_packages[] = $additional\_package; |
  | 2013 | 1961 |  |
  | […](/browser/inpost-for-woocommerce/trunk/src/InspireLabs/WoocommerceInpost/shipping/EasyPack_Shippng_Parcel_Machines.php?rev=3110579#L2017) | […](/browser/inpost-for-woocommerce/trunk/src/InspireLabs/WoocommerceInpost/shipping/EasyPack_Shippng_Parcel_Machines.php?rev=3115602#L1965) |  |
  | 2017 | 1965 | $order->save(); |
  | 2018 | 1966 | } |
  | 2019 |  | ~~/\*if( 'yes' === get\_option('woocommerce\_custom\_orders\_table\_enabled') ) {~~ |
  | 2020 |  | ~~if ( $order && !is\_wp\_error($order) ) {~~ |
  | 2021 |  | ~~$order->update\_meta\_data( '\_easypack\_additional\_packages', $additional\_packages );~~ |
  | 2022 |  | ~~$order->save();~~ |
  | 2023 |  | ~~}~~ |
  | 2024 |  | ~~}\*/~~ |
  | 2025 | 1967 | } |
  | 2026 | 1968 | } |
* ## [inpost-for-woocommerce/trunk/src/InspireLabs/WoocommerceInpost/shipping/views/html-courier-parcel-dimensions.php](/changeset/3115602/inpost-for-woocommerce/trunk/src/InspireLabs/WoocommerceInpost/shipping/views/html-courier-parcel-dimensions.php?old=3087656&old_path=inpost-for-woocommerce%2Ftrunk%2Fsrc%2FInspireLabs%2FWoocommerceInpost%2Fshipping%2Fviews%2Fhtml-courier-parcel-dimensions.php "Show the [3110579:3115602] differences restricted to inpost-for-woocommerce/trunk/src/InspireLabs/WoocommerceInpost/shipping/views/html-courier-parcel-dimensions.php")

  | [r3110579](/browser/inpost-for-woocommerce/trunk/src/InspireLabs/WoocommerceInpost/shipping/views/html-courier-parcel-dimensions.php?rev=3087656#L39 "Show revision 3110579 of this file in browser") | [r3115602](/browser/inpost-for-woocommerce/trunk/src/InspireLabs/WoocommerceInpost/shipping/views/html-courier-parcel-dimensions.php?rev=3115602#L39 "Show revision 3115602 of this file in browser") |  |
  | --- | --- | --- |
  | 39 | 39 | ? $size\_from\_main\_settings['height'] |
  | 40 | 40 | : $parcel->getDimensions()->getHeight(); |
  | 41 |  | } |
  | 42 |  |  |
  |  | 41 | }?> |
  |  | 42 | <span class="easypack-courier-repeat-block"> |
  |  | 43 | <span class="easypack-courier-repeat-block-btn-close">X</span> |
  |  | 44 | <span class="easypack-courier-repeat-block-title"> |
  |  | 45 | <label for="easypack\_courier\_parcel\_id"> |
  |  | 46 | <?php echo esc\_html\_\_('Parcel id', 'woocommerce-inpost'); ?> |
  |  | 47 | <input id="easypack\_courier\_parcel\_id" class="easypack-repeat-block-title" type="text" value="" name="easypack\_courier\_parcel\_id[]"> |
  |  | 48 | </label> |
  |  | 49 | </span> |
  |  | 50 | <?php |
  | 43 | 51 | woocommerce\_form\_field('parcel\_length', $length, $length\_value); |
  | 44 | 52 | woocommerce\_form\_field('parcel\_width', $width, $width\_value); |
  | […](/browser/inpost-for-woocommerce/trunk/src/InspireLabs/WoocommerceInpost/shipping/views/html-courier-parcel-dimensions.php?rev=3087656#L88) | […](/browser/inpost-for-woocommerce/trunk/src/InspireLabs/WoocommerceInpost/shipping/views/html-courier-parcel-dimensions.php?rev=3115602#L96) |  |
  | 88 | 96 | if( 'InPost SmartCourier' === $selected\_service ) return; |
  | 89 | 97 |  |
  | 90 |  | woocommerce\_form\_field('parcel\_non\_standard', $non\_standard, $non\_standard\_value); |
  |  | 98 | woocommerce\_form\_field('parcel\_non\_standard', $non\_standard, $non\_standard\_value);?> |
  |  | 99 | </span> |
* ## [inpost-for-woocommerce/trunk/src/InspireLabs/WoocommerceInpost/shipping/views/html-order-metabox-courier.php](/changeset/3115602/inpost-for-woocommerce/trunk/src/InspireLabs/WoocommerceInpost/shipping/views/html-order-metabox-courier.php?old=3053305&old_path=inpost-for-woocommerce%2Ftrunk%2Fsrc%2FInspireLabs%2FWoocommerceInpost%2Fshipping%2Fviews%2Fhtml-order-metabox-courier.php "Show the [3110579:3115602] differences restricted to inpost-for-woocommerce/trunk/src/InspireLabs/WoocommerceInpost/shipping/views/html-order-metabox-courier.php")

  | [r3110579](/browser/inpost-for-woocommerce/trunk/src/InspireLabs/WoocommerceInpost/shipping/views/html-order-metabox-courier.php?rev=3053305#L105 "Show revision 3110579 of this file in browser") | [r3115602](/browser/inpost-for-woocommerce/trunk/src/InspireLabs/WoocommerceInpost/shipping/views/html-order-metabox-courier.php?rev=3115602#L105 "Show revision 3115602 of this file in browser") |  |
  | --- | --- | --- |
  | 105 | 105 | <?php include('costs/html-order-metabox-costs.php'); ?> |
  | 106 | 106 |  |
  | 107 |  | <p><?php \_e('Attributes:', 'woocommerce-inpost'); ?> |
  | 108 |  | <ul id="easypack\_parcels" style="list-style: none"> |
  | 109 |  | <?php /\*\* @var ShipX\_Shipment\_Parcel\_Model $parcel \*/ ?> |
  | 110 |  | <?php /\*\* @var ShipX\_Shipment\_Parcel\_Model[] $parcels \*/ ?> |
  | 111 |  |  |
  | 112 |  | <?php foreach ($parcels as $parcel) : ?> |
  | 113 |  | <li> |
  | 114 |  | <?php if ($status == 'new' || $additional\_package) : ?> |
  | 115 |  | <?php |
  | 116 |  | $length = [ |
  | 117 |  | 'type' => 'number', |
  | 118 |  | 'class' => ['easypack\_parcel'], |
  | 119 |  | 'input\_class' => ['easypack\_parcel'], |
  | 120 |  | 'label' => \_\_('Length:', 'woocommerce-inpost') |
  | 121 |  | . ' (' . $parcel->getDimensions()->getUnit() . ')', |
  | 122 |  | 'required' => true, |
  | 123 |  | ]; |
  | 124 |  | $width = [ |
  | 125 |  | 'type' => 'number', |
  | 126 |  | 'class' => ['easypack\_parcel'], |
  | 127 |  | 'input\_class' => ['easypack\_parcel'], |
  | 128 |  | 'label' => \_\_('Width:', 'woocommerce-inpost') |
  | 129 |  | . ' (' . $parcel->getDimensions()->getUnit() . ')', |
  | 130 |  | 'required' => true, |
  | 131 |  | ]; |
  | 132 |  | $height = [ |
  | 133 |  | 'type' => 'number', |
  | 134 |  | 'class' => ['easypack\_parcel'], |
  | 135 |  | 'input\_class' => ['easypack\_parcel'], |
  | 136 |  | 'label' => \_\_('Height:', 'woocommerce-inpost') |
  | 137 |  | . ' (' . $parcel->getDimensions()->getUnit() . ')', |
  | 138 |  | 'required' => true, |
  | 139 |  | ]; ?> |
  | 140 |  |  |
  | 141 |  | <?php // Parcel dimensions block for courier shipments ?> |
  | 142 |  | <?php include('html-courier-parcel-dimensions.php'); ?> |
  | 143 |  |  |
  | 144 |  | <?php if ($status == 'new' && !$first\_parcel) : ?> |
  | 145 |  | <button class="button easypack\_remove\_parcel"><?php \_e('Remove', 'woocommerce-inpost' ); ?></button> |
  | 146 |  | <?php endif; ?> |
  | 147 |  |  |
  | 148 |  | <?php else : ?> |
  | 149 |  | <?php \_e('Length', 'woocommerce-inpost' ); ?>: <?php echo esc\_html( $parcel->getDimensions()->getLength() ); ?> |
  | 150 |  |  |
  | 151 |  | <?php echo esc\_html( $parcel->getDimensions()->getUnit() ); ?> |
  | 152 |  | <br> |
  | 153 |  | <?php \_e('Width', 'woocommerce-inpost' ); ?>: <?php echo esc\_html( $parcel->getDimensions()->getWidth() ); ?> |
  | 154 |  |  |
  | 155 |  | <?php echo esc\_html( $parcel->getDimensions()->getUnit() ); ?> |
  | 156 |  | <br> |
  | 157 |  | <?php \_e('Height', 'woocommerce-inpost' ); ?>: <?php echo esc\_html( $parcel->getDimensions()->getHeight() ); ?> |
  | 158 |  |  |
  | 159 |  | <?php echo esc\_html( $parcel->getDimensions()->getUnit() ); ?> |
  | 160 |  | <br> |
  | 161 |  | <?php \_e('Non standard', 'woocommerce-inpost' ); ?>: <?php echo $parcel->is\_non\_standard() === true |
  | 162 |  | ? \_\_('yes', 'woocommerce-inpost' ) |
  | 163 |  | : \_\_('no', 'woocommerce-inpost' ); ?> |
  | 164 |  | <br> |
  | 165 |  | <?php \_e('Weight', 'woocommerce-inpost' ); ?>: <?php echo esc\_html( $parcel->getWeight()->getAmount() ); ?> |
  | 166 |  |  |
  | 167 |  | <?php echo esc\_html( $parcel->getWeight()->getUnit() ); ?> |
  | 168 |  | <?php endif; ?> |
  | 169 |  | </li> |
  | 170 |  |  |
  | 171 |  |  |
  | 172 |  | <?php $first\_parcel = false; ?> |
  | 173 |  | <?php endforeach; ?> |
  | 174 |  | </ul> |
  | 175 |  |  |
  | 176 |  | </p> |
  |  | 107 | <div> |
  |  | 108 | <?php \_e('Attributes:', 'woocommerce-inpost'); ?> |
  |  | 109 |  |
  |  | 110 |  |
  |  | 111 | <?php /\*\* @var ShipX\_Shipment\_Parcel\_Model $parcel \*/ ?> |
  |  | 112 | <?php /\*\* @var ShipX\_Shipment\_Parcel\_Model[] $parcels \*/ ?> |
  |  | 113 | <?php |
  |  | 114 | $wielopak = false; |
  |  | 115 | if( is\_array($parcels) && ( count($parcels) > 1) ) { |
  |  | 116 | $wielopak = true; |
  |  | 117 | } |
  |  | 118 | if ( $wielopak && $status !== 'new' && ! $additional\_package ) : ?> |
  |  | 119 | <span id="easypack\_wielopak\_label"> |
  |  | 120 | <?php echo esc\_html\_\_('Wielopak', 'woocommerce-inpost'); ?> |
  |  | 121 | </span> |
  |  | 122 | <?php endif; |
  |  | 123 | foreach ($parcels as $parcel) : ?> |
  |  | 124 | <?php if ( $status == 'new' || $additional\_package ) : ?> |
  |  | 125 | <p> |
  |  | 126 | <label for="easypack\_send\_method\_many"> |
  |  | 127 | <input name="easypack\_send\_method\_many" id="easypack\_send\_method\_many" type="checkbox" class="" value="1"> |
  |  | 128 | <?php echo esc\_html\_\_('Send as several packages', 'woocommerce-inpost'); ?> |
  |  | 129 | </label> |
  |  | 130 | </p> |
  |  | 131 | <ul id="easypack\_parcels" class="easypack\_courier\_std" style="list-style:none"> |
  |  | 132 | <li> |
  |  | 133 | <?php |
  |  | 134 | $length = [ |
  |  | 135 | 'type' => 'number', |
  |  | 136 | 'class' => ['easypack\_parcel'], |
  |  | 137 | 'input\_class' => ['easypack\_parcel'], |
  |  | 138 | 'label' => \_\_('Length:', 'woocommerce-inpost') |
  |  | 139 | . ' (' . $parcel->getDimensions()->getUnit() . ')', |
  |  | 140 | 'required' => true, |
  |  | 141 | ]; |
  |  | 142 | $width = [ |
  |  | 143 | 'type' => 'number', |
  |  | 144 | 'class' => ['easypack\_parcel'], |
  |  | 145 | 'input\_class' => ['easypack\_parcel'], |
  |  | 146 | 'label' => \_\_('Width:', 'woocommerce-inpost') |
  |  | 147 | . ' (' . $parcel->getDimensions()->getUnit() . ')', |
  |  | 148 | 'required' => true, |
  |  | 149 | ]; |
  |  | 150 | $height = [ |
  |  | 151 | 'type' => 'number', |
  |  | 152 | 'class' => ['easypack\_parcel'], |
  |  | 153 | 'input\_class' => ['easypack\_parcel'], |
  |  | 154 | 'label' => \_\_('Height:', 'woocommerce-inpost') |
  |  | 155 | . ' (' . $parcel->getDimensions()->getUnit() . ')', |
  |  | 156 | 'required' => true, |
  |  | 157 | ]; ?> |
  |  | 158 |  |
  |  | 159 | <?php // Parcel dimensions block for courier shipments ?> |
  |  | 160 | <?php include('html-courier-parcel-dimensions.php'); ?> |
  |  | 161 |  |
  |  | 162 | <?php if ($status == 'new' && !$first\_parcel) : ?> |
  |  | 163 | <button class="button easypack\_remove\_parcel"><?php \_e('Remove', 'woocommerce-inpost' ); ?></button> |
  |  | 164 | <?php endif; ?> |
  |  | 165 | </li></ul> |
  |  | 166 | <?php else : ?> |
  |  | 167 | <ul id="easypack\_parcels" class="easypack\_courier\_std" style="list-style:none"> |
  |  | 168 |  |
  |  | 169 | <li> |
  |  | 170 | <?php \_e('Length', 'woocommerce-inpost' ); ?>: <?php echo esc\_html( $parcel->getDimensions()->getLength() ); ?> |
  |  | 171 |  |
  |  | 172 | <?php echo esc\_html( $parcel->getDimensions()->getUnit() ); ?> |
  |  | 173 | <br> |
  |  | 174 | <?php \_e('Width', 'woocommerce-inpost' ); ?>: <?php echo esc\_html( $parcel->getDimensions()->getWidth() ); ?> |
  |  | 175 |  |
  |  | 176 | <?php echo esc\_html( $parcel->getDimensions()->getUnit() ); ?> |
  |  | 177 | <br> |
  |  | 178 | <?php \_e('Height', 'woocommerce-inpost' ); ?>: <?php echo esc\_html( $parcel->getDimensions()->getHeight() ); ?> |
  |  | 179 |  |
  |  | 180 | <?php echo esc\_html( $parcel->getDimensions()->getUnit() ); ?> |
  |  | 181 | <br> |
  |  | 182 | <?php \_e('Non standard', 'woocommerce-inpost' ); ?>: <?php echo $parcel->is\_non\_standard() === true |
  |  | 183 | ? \_\_('yes', 'woocommerce-inpost' ) |
  |  | 184 | : \_\_('no', 'woocommerce-inpost' ); ?> |
  |  | 185 | <br> |
  |  | 186 | <?php \_e('Weight', 'woocommerce-inpost' ); ?>: <?php echo esc\_html( $parcel->getWeight()->getAmount() ); ?> |
  |  | 187 |  |
  |  | 188 | <?php echo esc\_html( $parcel->getWeight()->getUnit() ); ?> |
  |  | 189 | </li></ul> |
  |  | 190 | <?php endif; ?> |
  |  | 191 | <?php $first\_parcel = false; ?> |
  |  | 192 | <?php endforeach; ?> |
  |  | 193 | </div> |
  | 177 | 194 |  |
  | 178 | 195 |  |
  | […](/browser/inpost-for-woocommerce/trunk/src/InspireLabs/WoocommerceInpost/shipping/views/html-order-metabox-courier.php?rev=3053305#L228) | […](/browser/inpost-for-woocommerce/trunk/src/InspireLabs/WoocommerceInpost/shipping/views/html-order-metabox-courier.php?rev=3115602#L245) |  |
  | 228 | 245 |  |
  | 229 | 246 | <script type="text/javascript"> |
  | 230 |  |  |
  | 231 |  |  |
  | 232 |  | if (jQuery().select2) { |
  | 233 |  | jQuery("#parcel\_machine\_id").select2(); |
  | 234 |  | } |
  | 235 |  |  |
  |  | 247 | document.addEventListener('click', function (e) { |
  |  | 248 | e = e || window.event; |
  |  | 249 | var target = e.target || e.srcElement; |
  |  | 250 | if ( target.classList.contains( 'easypack-courier-repeat-block-btn-close' ) ) { |
  |  | 251 |  |
  |  | 252 | let repeat\_block = target.closest('.easypack-courier-repeat-block'); |
  |  | 253 | repeat\_block.remove(); |
  |  | 254 | let repeat\_blocks\_left = document.querySelectorAll('.easypack-courier-repeat-block').length; |
  |  | 255 | if( repeat\_blocks\_left === 1 ) { |
  |  | 256 | jQuery('#easypack\_send\_method\_many').prop('checked', false); |
  |  | 257 | jQuery('.easypack-courier-repeat-block').each(function(ind, elem) { |
  |  | 258 | jQuery(elem).removeClass('divided'); |
  |  | 259 | if(ind > 0) { |
  |  | 260 | jQuery(elem).remove(); |
  |  | 261 | } |
  |  | 262 | jQuery('.easypack-courier-repeat-block-title').each(function(ind, elem) { |
  |  | 263 | jQuery(elem).removeClass('divided'); |
  |  | 264 | }); |
  |  | 265 | }); |
  |  | 266 | } |
  |  | 267 | } |
  |  | 268 |  |
  |  | 269 | if (target.hasAttribute('id') && target.getAttribute('id') == 'easypack\_send\_method\_many') { |
  |  | 270 | let repeat = jQuery('.easypack-courier-repeat-block'); |
  |  | 271 | if( jQuery(target).is(':checked') ) { |
  |  | 272 | var limit = 4; |
  |  | 273 | let repeat\_blocks\_qty = document.querySelectorAll('.easypack-courier-repeat-block').length; |
  |  | 274 |  |
  |  | 275 | while(repeat\_blocks\_qty <= limit) { |
  |  | 276 | jQuery(repeat).clone().insertAfter(repeat); |
  |  | 277 | repeat\_blocks\_qty++; |
  |  | 278 | } |
  |  | 279 |  |
  |  | 280 | jQuery('.easypack-courier-repeat-block-btn-close').each(function(ind, elem) { |
  |  | 281 | if(ind > 0) { |
  |  | 282 | jQuery(elem).addClass('divided'); |
  |  | 283 | } |
  |  | 284 | }); |
  |  | 285 | let order\_id = '<?php echo esc\_attr( $order\_id ); ?>'; |
  |  | 286 | jQuery('.easypack-courier-repeat-block-title').each(function(ind, elem) { |
  |  | 287 | jQuery(elem).addClass('divided'); |
  |  | 288 | let num = ind + 1; |
  |  | 289 | let divided\_parcel\_id = '#' + order\_id + ' ' + num + '/5'; |
  |  | 290 | jQuery(elem).find('.easypack-repeat-block-title').val(divided\_parcel\_id); |
  |  | 291 | }); |
  |  | 292 | jQuery('.easypack-courier-repeat-block').each(function(ind, elem) { |
  |  | 293 | jQuery(elem).addClass('divided'); |
  |  | 294 | }); |
  |  | 295 |  |
  |  | 296 | } else { |
  |  | 297 | jQuery('.easypack-courier-repeat-block-title').each(function(ind, elem) { |
  |  | 298 | jQuery(elem).removeClass('divided'); |
  |  | 299 | }); |
  |  | 300 | jQuery('.easypack-courier-repeat-block').each(function(ind, elem) { |
  |  | 301 | jQuery(elem).removeClass('divided'); |
  |  | 302 | if(ind > 0) { |
  |  | 303 | jQuery(elem).remove(); |
  |  | 304 | } |
  |  | 305 | }); |
  |  | 306 | } |
  |  | 307 | } |
  |  | 308 | }); |
  | 236 | 309 |  |
  | 237 | 310 | jQuery('#easypack\_send\_parcels').click(function (e) { |
  | 238 |  |  |
  | 239 | 311 | var metabox = jQuery(this).closest('.postbox'); |
  | 240 | 312 | var is\_additional\_package = '<?php echo esc\_html( $additional\_package ); ?>'; |
  | 241 |  |  |
  | 242 | 313 | jQuery(metabox).find('#easypack\_error').html(''); |
  | 243 | 314 | jQuery(this).attr('disabled', true); |
  | […](/browser/inpost-for-woocommerce/trunk/src/InspireLabs/WoocommerceInpost/shipping/views/html-order-metabox-courier.php?rev=3053305#L257) | […](/browser/inpost-for-woocommerce/trunk/src/InspireLabs/WoocommerceInpost/shipping/views/html-order-metabox-courier.php?rev=3115602#L328) |  |
  | 257 | 328 | insurance\_amounts[i] = jQuery(this).val(); |
  | 258 | 329 | }); |
  | 259 |  |  |
  | 260 |  | var order\_id = '<?php echo esc\_attr( $order\_id ); ?>'; |
  | 261 |  |  |
  | 262 |  | var data = { |
  | 263 |  | action: 'easypack', |
  | 264 |  | easypack\_action: '<?php echo sanitize\_text\_field( $wp\_ajax\_action\_create ); ?>', |
  | 265 |  | security: easypack\_nonce, |
  | 266 |  | order\_id: order\_id, |
  | 267 |  | parcel\_machine\_id: jQuery(metabox).find('#parcel\_machine\_id').val(), |
  | 268 |  | parcel\_length: jQuery(metabox).find('#parcel\_length').val(), |
  | 269 |  | parcel\_width: jQuery(metabox).find('#parcel\_width').val(), |
  | 270 |  | parcel\_height: jQuery(metabox).find('#parcel\_height').val(), |
  | 271 |  | parcel\_weight: jQuery(metabox).find('#parcel\_weight').val(), |
  | 272 |  | parcel\_non\_standard: jQuery(metabox).find('#parcel\_non\_standard').val(), |
  | 273 |  | //parcels: parcels, |
  | 274 |  | send\_method: jQuery(metabox).find('#easypack\_send\_method').val(), |
  | 275 |  | insurance\_amounts: insurance\_amounts, |
  | 276 |  | reference\_number: jQuery(metabox).find('#reference\_number').val(), |
  | 277 |  | easypack\_additional\_package: jQuery(metabox).find('#easypack\_additional\_package').val() |
  | 278 |  | }; |
  |  | 330 | var order\_id = '<?php echo esc\_attr( $order\_id ); ?>'; |
  |  | 331 | var data = {}; |
  |  | 332 | if( jQuery('#easypack\_send\_method\_many').is(':checked') ) { |
  |  | 333 | let wielopak = []; |
  |  | 334 | jQuery('.easypack-courier-repeat-block').each(function(ind, elem) { |
  |  | 335 | wielopak.push( { |
  |  | 336 | weight: { |
  |  | 337 | unit: 'kg', |
  |  | 338 | amount: jQuery(elem).find('#parcel\_weight').val() |
  |  | 339 | }, |
  |  | 340 | is\_non\_standard: jQuery(elem).find('#parcel\_non\_standard').val(), |
  |  | 341 | id: jQuery(elem).find('.easypack-repeat-block-title').val(), |
  |  | 342 | dimensions: { |
  |  | 343 | unit: 'mm', |
  |  | 344 | length: jQuery(elem).find('#parcel\_length').val(), |
  |  | 345 | width: jQuery(elem).find('#parcel\_width').val(), |
  |  | 346 | height: jQuery(elem).find('#parcel\_height').val(), |
  |  | 347 | } |
  |  | 348 | }); |
  |  | 349 | }); |
  |  | 350 |  |
  |  | 351 | data = { |
  |  | 352 | action: 'easypack', |
  |  | 353 | easypack\_action: '<?php echo sanitize\_text\_field($wp\_ajax\_action\_create); ?>', |
  |  | 354 | security: easypack\_nonce, |
  |  | 355 | order\_id: order\_id, |
  |  | 356 | parcel\_mode: 'wielopaki', |
  |  | 357 | parcels : wielopak, |
  |  | 358 | send\_method: jQuery(metabox).find('#easypack\_send\_method').val(), |
  |  | 359 | insurance\_amounts: insurance\_amounts, |
  |  | 360 | reference\_number: jQuery(metabox).find('#reference\_number').val(), |
  |  | 361 | easypack\_additional\_package: jQuery(metabox).find('#easypack\_additional\_package').val() |
  |  | 362 | }; |
  |  | 363 |  |
  |  | 364 | } else { |
  |  | 365 |  |
  |  | 366 | data = { |
  |  | 367 | action: 'easypack', |
  |  | 368 | easypack\_action: '<?php echo sanitize\_text\_field($wp\_ajax\_action\_create); ?>', |
  |  | 369 | security: easypack\_nonce, |
  |  | 370 | order\_id: order\_id, |
  |  | 371 | parcel\_machine\_id: jQuery(metabox).find('#parcel\_machine\_id').val(), |
  |  | 372 | parcel\_length: jQuery(metabox).find('#parcel\_length').val(), |
  |  | 373 | parcel\_width: jQuery(metabox).find('#parcel\_width').val(), |
  |  | 374 | parcel\_height: jQuery(metabox).find('#parcel\_height').val(), |
  |  | 375 | parcel\_weight: jQuery(metabox).find('#parcel\_weight').val(), |
  |  | 376 | parcel\_non\_standard: jQuery(metabox).find('#parcel\_non\_standard').val(), |
  |  | 377 | send\_method: jQuery(metabox).find('#easypack\_send\_method').val(), |
  |  | 378 | insurance\_amounts: insurance\_amounts, |
  |  | 379 | reference\_number: jQuery(metabox).find('#reference\_number').val(), |
  |  | 380 | easypack\_additional\_package: jQuery(metabox).find('#easypack\_additional\_package').val() |
  |  | 381 | }; |
  |  | 382 | } |
  |  | 383 |  |
  | 279 | 384 | jQuery.post(ajaxurl, data, function (response) { |
  | 280 | 385 | //console.log(response); |
  | 281 |  | if (response !== 0) { |
  |  | 386 | if (response !== 0 && response !== '') { |
  | 282 | 387 | response = JSON.parse(response); |
  | 283 |  | ~~//console.log(response);~~ |
  | 284 | 388 | //console.log(response.status); |
  | 285 | 389 | if (response.status === 'ok') { |
  | […](/browser/inpost-for-woocommerce/trunk/src/InspireLabs/WoocommerceInpost/shipping/views/html-order-metabox-courier.php?rev=3053305#L290) | […](/browser/inpost-for-woocommerce/trunk/src/InspireLabs/WoocommerceInpost/shipping/views/html-order-metabox-courier.php?rev=3115602#L394) |  |
  | 290 | 394 | additional\_package\_data += '<p><span style="font-weight: bold">Usługa: </span>\n' + |
  | 291 | 395 | '<span title="">'+ response.service +'</span></p>'; |
  | 292 |  |  |
  | 293 | 396 |  |
  | 294 | 397 | additional\_package\_data += '<p><span style="font-weight: bold">Status: </span>\n' + |
  | […](/browser/inpost-for-woocommerce/trunk/src/InspireLabs/WoocommerceInpost/shipping/views/html-order-metabox-courier.php?rev=3053305#L344) | […](/browser/inpost-for-woocommerce/trunk/src/InspireLabs/WoocommerceInpost/shipping/views/html-order-metabox-courier.php?rev=3115602#L447) |  |
  | 344 | 447 | }); |
  | 345 | 448 | return false; |
  | 346 |  |  |
  | 347 | 449 | }); |
  | 348 |  |  |
  | 349 | 450 | </script> |
  | 350 | 451 |  |
* ## [inpost-for-woocommerce/trunk/src/InspireLabs/WoocommerceInpost/shipx/services/shipment/ShipX\_Shipment\_Service.php](/changeset/3115602/inpost-for-woocommerce/trunk/src/InspireLabs/WoocommerceInpost/shipx/services/shipment/ShipX_Shipment_Service.php?old=3087656&old_path=inpost-for-woocommerce%2Ftrunk%2Fsrc%2FInspireLabs%2FWoocommerceInpost%2Fshipx%2Fservices%2Fshipment%2FShipX_Shipment_Service.php "Show the [3110579:3115602] differences restricted to inpost-for-woocommerce/trunk/src/InspireLabs/WoocommerceInpost/shipx/services/shipment/ShipX_Shipment_Service.php")

  | [r3110579](/browser/inpost-for-woocommerce/trunk/src/InspireLabs/WoocommerceInpost/shipx/services/shipment/ShipX_Shipment_Service.php?rev=3087656#L241 "Show revision 3110579 of this file in browser") | [r3115602](/browser/inpost-for-woocommerce/trunk/src/InspireLabs/WoocommerceInpost/shipx/services/shipment/ShipX_Shipment_Service.php?rev=3115602#L241 "Show revision 3115602 of this file in browser") |  |
  | --- | --- | --- |
  | 241 | 241 | $parcelsCollection = []; |
  | 242 | 242 |  |
  | 243 |  |  |
  | 244 | 243 | if (true === $is\_service\_courier\_type) { |
  | 245 |  | $parcel = new ShipX\_Shipment\_Parcel\_Model(); |
  | 246 |  | $parcel->setIsNonstandard(false); |
  | 247 |  | $parcel->setId($order\_id.'\_1'); |
  | 248 |  | $dimensions = new ShipX\_Shipment\_Parcel\_Dimensions\_Model(); |
  | 249 |  | $dimensions->setUnit('mm'); |
  | 250 |  | $dimensions->setLength($sizes['length']); |
  | 251 |  | $dimensions->setWidth($sizes['width']); |
  | 252 |  | $dimensions->setHeight($sizes['height']); |
  | 253 |  | $parcel->setDimensions($dimensions); |
  | 254 |  | $weight = new ShipX\_Shipment\_Parcel\_Weight\_Model(); |
  | 255 |  | $weight->setUnit('kg'); |
  | 256 |  | $weight->setAmount($sizes['weight']); |
  | 257 |  | $parcel->setWeight($weight); |
  | 258 |  | if ($sizes['non\_standard'] === 'yes') { |
  | 259 |  | $non\_standard = true; |
  |  | 244 | if( isset( $\_POST['parcel\_mode']) && $\_POST['parcel\_mode'] === 'wielopaki' ) { |
  |  | 245 | if( is\_array($parcels) ) { |
  |  | 246 | foreach ($parcels as $counter\_id => $p) { |
  |  | 247 | $parcel = new ShipX\_Shipment\_Parcel\_Model(); |
  |  | 248 |  |
  |  | 249 | $parcel->setId($p['id']); |
  |  | 250 | $isNonstandard = isset($p['is\_non\_standard']) && 'yes' === $p['is\_non\_standard'] ? true: false; |
  |  | 251 | $parcel->setIsNonstandard($isNonstandard ); |
  |  | 252 |  |
  |  | 253 | $dimensions = new ShipX\_Shipment\_Parcel\_Dimensions\_Model(); |
  |  | 254 | $dimensions->setUnit('mm'); |
  |  | 255 | $dimensions->setLength($p['dimensions']['length']); |
  |  | 256 | $dimensions->setWidth($p['dimensions']['width']); |
  |  | 257 | $dimensions->setHeight($p['dimensions']['height']); |
  |  | 258 | $parcel->setDimensions($dimensions); |
  |  | 259 |  |
  |  | 260 | $weight = new ShipX\_Shipment\_Parcel\_Weight\_Model(); |
  |  | 261 | $weight->setUnit('kg'); |
  |  | 262 | $weight->setAmount($p['weight']['amount']); |
  |  | 263 | $parcel->setWeight($weight); |
  |  | 264 |  |
  |  | 265 | $parcelsCollection[] = $parcel; |
  |  | 266 | } |
  |  | 267 | } |
  |  | 268 |  |
  | 260 | 269 | } else { |
  | 261 |  | $non\_standard = false; |
  | 262 |  | } |
  | 263 |  | $parcel->setIsNonstandard($non\_standard); |
  | 264 |  | $parcelsCollection[] = $parcel; |
  |  | 270 |  |
  |  | 271 | $parcel = new ShipX\_Shipment\_Parcel\_Model(); |
  |  | 272 | $parcel->setIsNonstandard(false); |
  |  | 273 | $parcel->setId($order\_id.'\_1'); |
  |  | 274 | $dimensions = new ShipX\_Shipment\_Parcel\_Dimensions\_Model(); |
  |  | 275 | $dimensions->setUnit('mm'); |
  |  | 276 | $dimensions->setLength($sizes['length']); |
  |  | 277 | $dimensions->setWidth($sizes['width']); |
  |  | 278 | $dimensions->setHeight($sizes['height']); |
  |  | 279 | $parcel->setDimensions($dimensions); |
  |  | 280 | $weight = new ShipX\_Shipment\_Parcel\_Weight\_Model(); |
  |  | 281 | $weight->setUnit('kg'); |
  |  | 282 | $weight->setAmount($sizes['weight']); |
  |  | 283 | $parcel->setWeight($weight); |
  |  | 284 | if ($sizes['non\_standard'] === 'yes') { |
  |  | 285 | $non\_standard = true; |
  |  | 286 | } else { |
  |  | 287 | $non\_standard = false; |
  |  | 288 | } |
  |  | 289 | $parcel->setIsNonstandard($non\_standard); |
  |  | 290 | $parcelsCollection[] = $parcel; |
  |  | 291 | } |
  |  | 292 |  |
  | 265 | 293 | } else { |
  | 266 | 294 |  |
* ## [inpost-for-woocommerce/trunk/src/InspireLabs/WoocommerceInpost/shipx/services/shipment/ShipX\_Shipment\_Status\_Service.php](/changeset/3115602/inpost-for-woocommerce/trunk/src/InspireLabs/WoocommerceInpost/shipx/services/shipment/ShipX_Shipment_Status_Service.php?old=3087656&old_path=inpost-for-woocommerce%2Ftrunk%2Fsrc%2FInspireLabs%2FWoocommerceInpost%2Fshipx%2Fservices%2Fshipment%2FShipX_Shipment_Status_Service.php "Show the [3110579:3115602] differences restricted to inpost-for-woocommerce/trunk/src/InspireLabs/WoocommerceInpost/shipx/services/shipment/ShipX_Shipment_Status_Service.php")

  | [r3110579](/browser/inpost-for-woocommerce/trunk/src/InspireLabs/WoocommerceInpost/shipx/services/shipment/ShipX_Shipment_Status_Service.php?rev=3087656#L130 "Show revision 3110579 of this file in browser") | [r3115602](/browser/inpost-for-woocommerce/trunk/src/InspireLabs/WoocommerceInpost/shipx/services/shipment/ShipX_Shipment_Status_Service.php?rev=3115602#L130 "Show revision 3115602 of this file in browser") |  |
  | --- | --- | --- |
  | 130 | 130 | } |
  | 131 | 131 |  |
  | 132 |  | $this->shipment\_service->update\_shipment\_to\_db( $shipment ); |
  | 133 |  |  |
  | 134 |  |  |
  | 135 |  | if( isset($search\_results['tracking\_number']) |
  | 136 |  | && ! empty($search\_results['tracking\_number']) |
  | 137 |  | && is\_numeric( $search\_results['tracking\_number'] ) |
  | 138 |  | ) { |
  | 139 |  | $this->update\_tracking\_if\_empty( $search\_results['tracking\_number'] ); |
  | 140 |  | } |
  |  | 132 | $this->shipment\_service->update\_shipment\_to\_db( $shipment ); |
  | 141 | 133 |  |
  | 142 | 134 | } |
  | […](/browser/inpost-for-woocommerce/trunk/src/InspireLabs/WoocommerceInpost/shipx/services/shipment/ShipX_Shipment_Status_Service.php?rev=3087656#L155) | […](/browser/inpost-for-woocommerce/trunk/src/InspireLabs/WoocommerceInpost/shipx/services/shipment/ShipX_Shipment_Status_Service.php?rev=3115602#L147) |  |
  | 155 | 147 |  |
  | 156 | 148 |  |
  | 157 |  | } |
  | 158 |  |  |
  | 159 |  |  |
  | 160 |  | private function update\_tracking\_if\_empty( $tracking\_number ) { |
  | 161 |  |  |
  | 162 |  | $order\_id = null; |
  | 163 |  |  |
  | 164 |  | if( function\_exists('get\_current\_screen')) { |
  | 165 |  | $current\_screen = get\_current\_screen(); |
  | 166 |  | if( 'woocommerce\_page\_wc-orders' === $current\_screen->id || 'shop\_order' === $current\_screen->id ) { |
  | 167 |  |  |
  | 168 |  | if( isset($\_GET['action']) && 'edit' === $\_GET['action'] && isset($\_GET['id']) ) { |
  | 169 |  | $order\_id = sanitize\_text\_field( $\_GET['id'] ); |
  | 170 |  | } else if( isset($\_GET['action']) && 'edit' === $\_GET['action'] && isset($\_GET['post']) ) { |
  | 171 |  | $order\_id = sanitize\_text\_field( $\_GET['post'] ); |
  | 172 |  | } |
  | 173 |  |  |
  | 174 |  | if( $order\_id && is\_numeric( $order\_id ) ) { |
  | 175 |  | update\_post\_meta( $order\_id, '\_easypack\_parcel\_tracking', sanitize\_text\_field( $tracking\_number ) ); |
  | 176 |  | $order = wc\_get\_order( $order\_id ); |
  | 177 |  | if( $order && ! is\_wp\_error( $order ) ) { |
  | 178 |  | $order->update\_meta\_data( '\_easypack\_parcel\_tracking', sanitize\_text\_field( $tracking\_number ) ); |
  | 179 |  | $order->save(); |
  | 180 |  | } |
  | 181 |  | } |
  | 182 |  | } |
  | 183 |  | } |
  | 184 |  | } |
  |  | 149 | } |
  | 185 | 150 |  |
  | 186 | 151 |  |
* ## [inpost-for-woocommerce/trunk/woocommerce-inpost.php](/changeset/3115602/inpost-for-woocommerce/trunk/woocommerce-inpost.php?old=3110579&old_path=inpost-for-woocommerce%2Ftrunk%2Fwoocommerce-inpost.php "Show the [3110579:3115602] differences restricted to inpost-for-woocommerce/trunk/woocommerce-inpost.php")

  | [r3110579](/browser/inpost-for-woocommerce/trunk/woocommerce-inpost.php?rev=3110579#L4 "Show revision 3110579 of this file in browser") | [r3115602](/browser/inpost-for-woocommerce/trunk/woocommerce-inpost.php?rev=3115602#L4 "Show revision 3115602 of this file in browser") |  |
  | --- | --- | --- |
  | 4 | 4 | Plugin URI: https://wordpress.org/plugins/inpost-for-woocommerce/ |
  | 5 | 5 | Description: InPost for WooCommerce is a dedicated integration plugin, designed for small and medium-sized businesses that want to quickly and conveniently integrate with InPost services. |
  | 6 |  | Version: 1.4.~~4~~ |
  |  | 6 | Version: 1.4.5 |
  | 7 | 7 | Author: iLabs.dev |
  | 8 | 8 | Author URI: https://ilabs.dev/ |

**Note:** See [TracChangeset](/wiki/TracChangeset)
for help on using the changeset viewer.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Unified Diff](?format=diff&new=3115602&old=3110579&new_path=%2Finpost-for-woocommerce%2Ftrunk&old_path=%2Finpost-for-woocommerce%2Ftrunk)
* [Zip Archive](?format=zip&new=3115602&old=3110579&new_path=%2Finpost-for-woocommerce%2Ftrunk&old_path=%2Finpost-for-woocommerce%2Ftrunk)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)

