

* [Home](https://www.rafaybaloch.com/)
* [About](https://www.rafaybaloch.com/p/about-me.html)
* [Disclaimer](https://www.rafaybaloch.com/p/disclaimer.html)
* [Privacy Policy](https://www.rafaybaloch.com/p/privacy-policy.html)
* [Publications](https://www.rafaybaloch.com/p/publications.html)
* [Contact](/cdn-cgi/l/email-protection#60120106011902010c0f030820070d01090c4e030f0d)

[![Miscellaneous Ramblings of a Cyber Security Researcher](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEil0y7er6Mwno5r_j_tTYaWOQYiAUl6Bks_QljjxuTAPDryJ3c6gT8odFzMDnmkOFyo-VLRel1BXTYXdmfp_sQWuxiVLMNr_2uqbRFSNZftzpmGml02KSKJ-NjfYP6FKF_xdCA9bVnuYAQ/s221/logo-png.png)](https://www.rafaybaloch.com/)

Hi, I am Rafay Baloch, a security researcher, author and a public speaker.

[Home](https://www.rafaybaloch.com/)
Unlabelled
Multiple Critical Vulnerabilities in PureVPN - Remote Code Execution + IP Leak

# Multiple Critical Vulnerabilities in PureVPN - Remote Code Execution + IP Leak

[10:55 AM](https://www.rafaybaloch.com/2023/11/Multiple%20Critical-Vulnerabilities-in-PureVPN.html "permanent link")

###

### Introduction

This blog
post highlights two vulnerabilities found in PureVPN, one being an IP leak,
which is as bad as an RCE in the VPN world, and the other being Remote Code
Execution in certain conditions. PureVPN is a very popular VPN that has been in
the game for more than a decade and has slowly started entering into other
security products.

### PureVPN DNS Leak Issue

#

The first
vulnerability is straight forward in PureVPN’s Desktop client for Linux. DNS
leaks, a common concern among VPN’s, which can inadvertently expose a user's
browsing history to their Internet Service Provider (ISP) or other prying
entities, even when the user is securely connected to a VPN.

This
vulnerability arises because the PureVPN Linux client fails to properly handle
DNS queries, allowing them to bypass the VPN tunnel and be sent directly to the
ISP or default DNS servers. This flaw was effectively demonstrated using
Ipleak.net, a tool designed to detect IP and DNS leaks.

[![](https://blogger.googleusercontent.com/img/a/AVvXsEgxQZlE7Zjk17ZRQFz6mVWJWABb0O2ApHgbywy5DvZTfr-a87XpW6Ftb8QBesK3rtP9fhT647iEbud8HTxKKEr8Asi67DXTrcraY1DNhEkDSByNPoSqQaZUI3BsbYdp7Ocx7kyaz1hpB1eMhqmS5x8d9hRpZTvtkmeOvGMwMUG4fIUDKsW_j_3T2mDaNXc=w640-h298)](https://blogger.googleusercontent.com/img/a/AVvXsEgxQZlE7Zjk17ZRQFz6mVWJWABb0O2ApHgbywy5DvZTfr-a87XpW6Ftb8QBesK3rtP9fhT647iEbud8HTxKKEr8Asi67DXTrcraY1DNhEkDSByNPoSqQaZUI3BsbYdp7Ocx7kyaz1hpB1eMhqmS5x8d9hRpZTvtkmeOvGMwMUG4fIUDKsW_j_3T2mDaNXc)
### Code Execution via missing lib file

#

During a
dynamic analysis of the PureVPN Linux client, we noticed that when the login
button is activated, a system call called 'opennat()' is initiated. This system
call aims to load the 'libnssckbi.so' shared library file from a location that
allows user-writable access. Dynamic loading is a mechanism that allows an
application to load a library into its address space during runtime, rather
than at compile time. However, it is essential to note that the specified path
lacks the existence of the 'libnssckbi.so' file.

[![](https://blogger.googleusercontent.com/img/a/AVvXsEj1R2wiAsiOOzDVWrWGHDJpQBeBKyfYyXEtK2xfuKJLcwhMkQ-7euKGmOIwLBWxUna3g1Kj2Y0IiTkAYKW9y2sQ3KcpKySRj2GgB_9plVYwSkXypJ6rByfJ30Dmeus4Hwghe4uNsfakzouEG9lw7iNzPFgGiOfY05si_KN-SGjohA7niOT16TWMCDzbJoE=w640-h98)](https://blogger.googleusercontent.com/img/a/AVvXsEj1R2wiAsiOOzDVWrWGHDJpQBeBKyfYyXEtK2xfuKJLcwhMkQ-7euKGmOIwLBWxUna3g1Kj2Y0IiTkAYKW9y2sQ3KcpKySRj2GgB_9plVYwSkXypJ6rByfJ30Dmeus4Hwghe4uNsfakzouEG9lw7iNzPFgGiOfY05si_KN-SGjohA7niOT16TWMCDzbJoE)This
presents a security vulnerability, potentially enabling malicious actors to
execute arbitrary code by placing a file named 'libnssckbi.so' in the
designated path. Furthermore, the root cause analysis has unveiled a broader
issue affecting applications that rely on the Chromium engine. Any such
application, when used on an Ubuntu-based system, becomes susceptible to this
issue.
### Potential Implications:

**Malicious Code Execution:** By exploiting this vulnerability an
attacker can inject, and execute, malicious code. The attacker can use this behaviour
to bypass the application whitelisting rules.

**Denial of Service (DoS) Attack:** Substituting the 'libnssckbi.so'
file not only exposes users to security risks but also disrupts the
functionality of the PureVPN application. This dual impact makes it a serious
concern.

**Phishing Threats:** As an extension of this vulnerability, an
attacker could potentially create fake login prompts for PureVPN, tricking
users into revealing sensitive information, falling victim to phishing
attempts.

### Proof of Concept (PoC)

## **PureVPN’s Response**

PureVPN
responded by acknowledging the IP leak vulnerability and fixed it in the
subsequent release. Whereas, the RCE, PureVPN termed as “Won’t Fix” and
responded with the following:

“*We appreciate your efforts and responsibly
sharing your findings. We looked at your report thoroughly to find the root
cause of the problem in our code.*

*Our Linux application is based on Electron
which uses Chromium engine. While we have been able to reproduce your finding,
we were not able to find the vulnerable code in our repository. Upon initial
analysis, we have identified that the lookup for 'libnssckbi.so' from the path
'/home/$username/.pki/nssdb/libnssckbi.so' is done by Chromium itself and the
same behaviour has been observed in other applications using Chromium such as
Google Chrome and Slack (Screenshots / video attached for your reference).*

*Based on your POC, it appears that the PureVPN
app itself does not provide any vector for injection or remote code execution
attack unless the system is already breached and running this app. Same goes
with Slack and Google Chrome as well. Please see the below snippets and
attached screen recording for reference.*

*Reported issue does not require any action from
our side as it has to be fixed in the Chromium project. We would appreciate it
if you also may provide any recommendation for the current scenario.”*

## **Google’s Response**

It is worth
noting that this issue was responsibly reported to the Chromium project;
however, the response was not entirely satisfactory, as they deemed such
vulnerabilities as low impact and local attacks are normally not part of their
threat model.

[![](https://blogger.googleusercontent.com/img/a/AVvXsEhINtpE8SjTkng3-aREw60op5ylvY1O7FMG88rleMYsU2w6yijEX-ZTlFXrfoRv9Bs7_9BKok-57atIciW1d2xayfX7hmOrf2gZigFHc0irg9pqbzvRw54SXoUUT6UW-Y6CYlDLLRwHahn7niPdumKyH6jXJtu7DOz4zlZbkuZ_QThi4NrxGxcL3MAOwbc=w640-h98)](https://blogger.googleusercontent.com/img/a/AVvXsEhINtpE8SjTkng3-aREw60op5ylvY1O7FMG88rleMYsU2w6yijEX-ZTlFXrfoRv9Bs7_9BKok-57atIciW1d2xayfX7hmOrf2gZigFHc0irg9pqbzvRw54SXoUUT6UW-Y6CYlDLLRwHahn7niPdumKyH6jXJtu7DOz4zlZbkuZ_QThi4NrxGxcL3MAOwbc)
**Credits**The vulnerability was discovered by "**[Rafay Baloch](https://twitter.com/rafaybaloch)"** and "**Muhammad Samaak"**.
## Conclusion

In case of PureVPN, the impact of this vulnerability is notably
higher due to the potential for a Denial of Service (DoS) attack. A malicious
actor could replace the 'libnssckbi.so' file, rendering the PureVPN application
unusable. While it is true that each application has its own threat model, and
just because a vulnerability exists in one application does not mean it is
acceptable in another, especially in a VPN, which users rely on for enhanced
privacy and security.

[![](http://img2.blogblog.com/img/icon18_edit_allbkg.gif)](https://www.blogger.com/post-edit.g?blogID=2219569080572207173&postID=6247579165131070754&from=pencil "Edit Post")

SHARES

[Share](https://www.facebook.com/share.php?v=4&u=http://www.rafaybaloch.com/2023/11/Multiple%20Critical-Vulnerabilities-in-PureVPN.html&t=Multiple Critical Vulnerabilities in PureVPN - Remote Code Execution + IP Leak "Share on Facebook!")

[Pin it](https://pinterest.com/pin/create/button/?url=http://www.rafaybaloch.com/2023/11/Multiple%20Critical-Vulnerabilities-in-PureVPN.html&media=https://blogger.googleusercontent.com/img/a/AVvXsEg-oRpTQmrED-qIsaMdLjz9EJWxSiOHLdgwcTUB3qcz9hyh_dpNVRhTdYzQ7v0j0cVYAx2m6-nfLZxg2xH55npgiRvEsb51LsYfCjd_tnw64r5ZJ6I5-NX01S7gWDxqa7yi1JcQ8CBwDND1p4ym9tQ_Q9w4cgYIJRKVxk0NotrzhEPfj2UGdxneLuVxlazZ=s72-w474-c-h317&description=Multiple Critical Vulnerabilities in PureVPN - Remote Code Execution + IP Leak "Pin it!")

[Tweet](https://twitter.com/home?status=Multiple Critical Vulnerabilities in PureVPN - Remote Code Execution + IP Leak-http://www.rafaybaloch.com/2023/11/Multiple%20Critical-Vulnerabilities-in-PureVPN.html "Share on Twitter!")

[Share](http://www.linkedin.com/shareArticle?mini=true&url=http://www.rafaybaloch.com/2023/11/Multiple%20Critical-Vulnerabilities-in-PureVPN.html "Share on Linkedin!")

[Share](https://plus.google.com/share?url=http://www.rafaybaloch.com/2023/11/Multiple%20Critical-Vulnerabilities-in-PureVPN.html "Share on Google Plus!")

[Share](http://www.stumbleupon.com/submit?url=http://www.rafaybaloch.com/2023/11/Multiple%20Critical-Vulnerabilities-in-PureVPN.html "Stumble it!")

[![](https://3.bp.blogspot.com/-eYyUk4KGuBg/Vs-oFm656VI/AAAAAAAAQfE/maUNyJ9PWqE/s1600/logo-icon.png)Buffer](https://buffer.com/add?url=http://www.rafaybaloch.com/2023/11/Multiple%20Critical-Vulnerabilities-in-PureVPN.html&picture=https://blogger.googleusercontent.com/img/a/AVvXsEg-oRpTQmrED-qIsaMdLjz9EJWxSiOHLdgwcTUB3qcz9hyh_dpNVRhTdYzQ7v0j0cVYAx2m6-nfLZxg2xH55npgiRvEsb51LsYfCjd_tnw64r5ZJ6I5-NX01S7gWDxqa7yi1JcQ8CBwDND1p4ym9tQ_Q9w4cgYIJRKVxk0NotrzhEPfj2UGdxneLuVxlazZ=s72-w474-c-h317&text=Multiple Critical Vulnerabilities in PureVPN - Remote Code Execution + IP Leak&via=stc_network "Share on Buffer!")

SMS

![]( https://2.bp.blogspot.com/-Q4pj1x7tFUA/VtIrtKRuDPI/AAAAAAAAQfY/pYMexHW1HqY/s1600/Icon_small.png)Share

Print

* **Next**
  You are viewing Most Recent Post

## Cyber Security Services

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhu-6P6KiduTUzNW8nyRPHDYh4KQOQP_lXaPW1DoX41AK8dA_Lgg0Qv__aupD0LMOOxySi4s8MOGjhAk1kOmZtuFqjkE5alC2ZxxrOKkO-ofJP7Imw-MnvdCNscn5brygR753GJYZMBLrOCaILtufM_YqCQt3ch1AcArkGgczc3qduTQnTIR7WzSLBH8Jf4/s1024/tmgm.jpeg)](https://redseclabs.com)

## Book

[![](https://m.media-amazon.com/images/I/81sBOm8txNL._SL1500_.jpg)](https://www.amazon.com/Ethical-Hacking-Penetration-Testing-Guide-ebook/dp/B00MMOJ7CY/?_encoding=UTF8&pd_rd_w=2ZLZy&content-id=amzn1.sym.da24a24a-8edd-4b61-8b08-8da82b8fa54e%3Aamzn1.symc.0be80b80-fece-46bc-88bd-c8e6394f049e&pf_rd_p=da24a24a-8edd-4b61-8b08-8da82b8fa54e&pf_rd_r=EXR4DDZYJZVPCHT312F1&pd_rd_wg=MsLha&pd_rd_r=93a9f8fc-d3d4-41c7-9cc7-23acaba96a0e&ref_=pd_gw_ci_mcx_mr_hp_atf_m)

## Rafay's Blackhat Talk

## Categories

[Vulnerabilities](https://www.rafaybaloch.com/search/label/Vulnerabilities)
(32)

[POC](https://www.rafaybaloch.com/search/label/POC)
(21)

[Breaches](https://www.rafaybaloch.com/search/label/Breaches)
(12)

[Bug Bounty](https://www.rafaybaloch.com/search/label/Bug%20Bounty)
(11)

[Security Flaws](https://www.rafaybaloch.com/search/label/Security%20Flaws)
(9)

[Ethical Hacking](https://www.rafaybaloch.com/search/label/Ethical%20Hacking)
(7)

[Mobile Security](https://www.rafaybaloch.com/search/label/Mobile%20Security)
(7)

[Web App Security](https://www.rafaybaloch.com/search/label/Web%20App%20Security)
(5)

[Web Server Security](https://www.rafaybaloch.com/search/label/Web%20Server%20Security)
(5)

[Cyber Attacks](https://www.rafaybaloch.com/search/label/Cyber%20Attacks)
(4)

[Penetration Testing](https://www.rafaybaloch.com/search/label/Penetration%20Testing)
(4)

[Website Security](https://www.rafaybaloch.com/search/label/Website%20Security)
(4)

[Courses](https://www.rafaybaloch.com/search/label/Courses)
(3)

[Cyber Security](https://www.rafaybaloch.com/search/label/Cyber%20Security)
(3)

[Security Forensics](https://www.rafaybaloch.com/search/label/Security%20Forensics)
(3)

[Technical Analysis](https://www.rafaybaloch.com/search/label/Technical%20Analysis)
(3)

[espionage](https://www.rafaybaloch.com/search/label/espionage)
(3)

[Online Security](https://www.rafaybaloch.com/search/label/Online%20Security)
(2)

[Presentations](https://www.rafaybaloch.com/search/label/Presentations)
(2)

[Tools](https://www.rafaybaloch.com/search/label/Tools)
(2)

[Website Hacking](https://www.rafaybaloch.com/search/label/Website%20Hacking)
(2)

[Achievements](https://www.rafaybaloch.com/search/label/Achievements)
(1)

[Cheatsheets](https://www.rafaybaloch.com/search/label/Cheatsheets)
(1)

[Manifesto](https://www.rafaybaloch.com/search/label/Manifesto)
(1)

[Network Security](https://www.rafaybaloch.com/search/label/Network%20Security)
(1)

[OS Security](https://www.rafaybaloch.com/search/label/OS%20Security)
(1)

[surveillance](https://www.rafaybaloch.com/search/label/surveillance)
(1)

SIGN UP FOR MY FREE NEWSLETTERLearn How to Excel In Penetration Testing & Become an Expert Security Researcher.

Contact us

 © 2023 All Rights Reserved by [RHA Info Sec.](https://www.rafaybaloch.com/)
[Top](#top)

## Contact Form

Name

Email
\*

Message
\*

Powered by [Blogger](https://www.blogger.com).

