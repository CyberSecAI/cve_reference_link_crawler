
[![JFrog Security Research](/assets/static/jfrog-logo-svg.5788598.74a3bea875bf053c65a0663c9ec9a0fd.svg)](/)JFrog Security Research

* [Discover](/vulnerabilities/)
* [Follow JFrog Security
  ![twitter](/assets/static/twitter.e0519be.9769aec62433fd58c76ad32c2d613842.svg)](https://twitter.com/JFrogSecurity)
![Menu](/assets/static/hamburger.a58a0fd.dc5087fee70346d455e75c87bc430716.svg)![Menu](data:image/svg+xml...)![Menu](/assets/static/close.5cd2673.91b568c73f917f773ea7915d69802829.svg)

* [Home](/)
* [Discover](/vulnerabilities/)
* [Follow JFrog Security](https://twitter.com/JFrogSecurity)
[< Back](/vulnerabilities/)
# JFSA-2024-001035518 - H2O Model Deserialization RCE

CVE-2024-6960
| CVSS 7.5

 JFrog Severity:high

Discovered By**Ori Hollander**of the JFrog Security Research Team

Published 21 Jul, 2024 | Last updated 21 Jul, 2024

## [Summary](#summary)

H2O deserializes ML models without filtering, potentially allowing execution of malicious code

## [Component](#component)

[h2o-core](https://mvnrepository.com/artifact/ai.h2o/h2o-core)

## [Affected versions](#affected-versions)

(,)

## [Description](#description)

The H2O machine learning platform uses "Iced" classes as the primary means of moving Java Objects around the cluster. The Iced format supports inclusion of serialized Java objects. When a model is deserialized, any class is allowed to be deserialized (no class whitelist). An attacker can construct a crafted Iced model that uses Java gadgets and leads to arbitrary code execution when imported to the H2O platform.

## [PoC](#poc)

An appropriate malicious serialized object can be created with the [ysoserial](https://github.com/frohoff/ysoserial/tree/master) tool, using the `CommonsBeanutils1` payload.

The serialized binary can then be embedded within an Iced model in the proper format.

Loading the model using the Web UI's "Import Model" command (or an equivalent API) will trigger code execution

## [Vulnerability Mitigations](#vulnerability-mitigations)

No mitigations are supplied for this issue

## [References](#references)

No references are supplied for this issue

[< Back](/vulnerabilities/)[![JFrog Security Research](/assets/static/jfrog-logo-svg.5788598.74a3bea875bf053c65a0663c9ec9a0fd.svg)](/)

* [Terms of Use](https://jfrog.com/terms-of-use/)
* [Cookies Policy](https://jfrog.com/jfrog-cookies-policy/)
* [Privacy Policy](https://jfrog.com/privacy-policy/)
* Cookies Settings

Â©2025 All Rights Reserved. JFrog Ltd.

