```
{
  "cveId": "CVE-2021-47103",
  "related": true,
  "cpe": [],
  "vulnerability": {
    "rootCause": "The `sk->sk_rx_dst` pointer was being used with RCU protection, but it was not properly handled according to RCU rules in  `tcp_v4_do_rcv()` and `tcp_v6_do_rcv()`. The code would sometimes free the `dst` object before clearing the `sk->sk_rx_dst` pointer.",
    "weaknesses": [
      "Use-after-free due to incorrect RCU handling"
    ],
    "impact": "A use-after-free vulnerability could lead to a crash or other undefined behavior.",
    "attackVectors": [
      "Network traffic that triggers the vulnerable code paths.",
      "Local network traffic via virtual network devices."
    ],
    "requiredCapabilities": "The attacker needs to be able to send network packets that trigger the vulnerable code paths.",
      "position": "Attacker must be able to send packets to trigger the vulnerable code. This can be from a remote host or a local VM."
  },
  "patches": [
    {
      "commitId": "92e6e36ecd16808866ac6172b9491b5097cde449",
      "description": "The patch modifies the handling of `sk->sk_rx_dst` to use RCU primitives correctly: the pointer is cleared before calling `dst_release()`, and `rcu_assign_pointer()` and `rcu_dereference_protected()` are used for access. This prevents the use-after-free."
    },
        {
      "commitId": "75a578000ae5e511e5d0e8433c94a14d9c99c412",
      "description": "The patch modifies the handling of `sk->sk_rx_dst` to use RCU primitives correctly: the pointer is cleared before calling `dst_release()`, and `rcu_assign_pointer()` and `rcu_dereference_protected()` are used for access. This prevents the use-after-free."
    },
        {
      "commitId": "68c34ce11ef23328692aa35fa6aaafdd75913100",
      "description": "The patch modifies the handling of `sk->sk_rx_dst` to use RCU primitives correctly: the pointer is cleared before calling `dst_release()`, and `rcu_assign_pointer()` and `rcu_dereference_protected()` are used for access. This prevents the use-after-free."
    },
        {
      "commitId": "c3bb4a7e8cbc984e1cdac0fe6af60e880214ed6e",
      "description": "The patch modifies the handling of `sk->sk_rx_dst` to use RCU primitives correctly: the pointer is cleared before calling `dst_release()`, and `rcu_assign_pointer()` and `rcu_dereference_protected()` are used for access. This prevents the use-after-free."
    },
      {
      "commitId": "f039b43cbaea5e0700980c2f0052da05a70782e0",
      "description": "The patch modifies the handling of `sk->sk_rx_dst` to use RCU primitives correctly: the pointer is cleared before calling `dst_release()`, and `rcu_assign_pointer()` and `rcu_dereference_protected()` are used for access. This prevents the use-after-free."
    },
     {
      "commitId": "8f905c0e7354ef261360fb7535ea079b1082c105",
        "description": "The patch modifies the handling of `sk->sk_rx_dst` to use RCU primitives correctly: the pointer is cleared before calling `dst_release()`, and `rcu_assign_pointer()` and `rcu_dereference_protected()` are used for access. This prevents the use-after-free."
    },
         {
      "commitId": "0249a4b8a554f2eb6a27b62516fa50168584faa4",
        "description": "The patch modifies the handling of `sk->sk_rx_dst` to use RCU primitives correctly: the pointer is cleared before calling `dst_release()`, and `rcu_assign_pointer()` and `rcu_dereference_protected()` are used for access. This prevents the use-after-free."
    }
  ]
}
```