
[Mbed TLS](../../)

Contents

* [Getting Started](../../getting_started/)
* [API Reference](https://mbed-tls.readthedocs.io/projects/api)
* [Project](../../project/)
* [Reviews](../../reviews/)
* [Security Advisories](../)
  + [Buffer underrun in pkwrite when writing an opaque key pair](../mbedtls-security-advisory-2024-10-1/)
  + [Limited authentication bypass in TLS 1.3 optional client authentication](../mbedtls-security-advisory-2024-08-3/)
  + [Stack buffer overflow in ECDSA signature conversion functions](../mbedtls-security-advisory-2024-08-2/)
  + CTR\_DRBG prioritized over HMAC\_DRBG as the PSA DRBG
    - [Vulnerability](#vulnerability)
    - [Impact](#impact)
    - [Resolution](#resolution)
    - [Work-around](#work-around)
  + [Insecure handling of shared memory in PSA Crypto APIs](../mbedtls-security-advisory-2024-03/)
  + [Buffer overflow in mbedtls\_x509\_set\_extension()](../mbedtls-security-advisory-2024-01-2/)
  + [Timing side channel in private key RSA operations.](../mbedtls-security-advisory-2024-01-1/)
  + [Buffer overflow in TLS handshake parsing with ECDH](../mbedtls-security-advisory-2023-10-2/)
  + [Buffer overread in TLS stream cipher suites](../mbedtls-security-advisory-2023-10-1/)
  + [Buffer overread in DTLS ClientHello parsing](../mbedtls-security-advisory-2022-07/)
  + [Double Free in `mbedtls_ssl_set_session()` in an error case.](../mbedtls-security-advisory-2021-12/)
  + [Local side channel attack on static Diffie-Hellman with Montgomery curves](../mbedtls-security-advisory-2021-07-2/)
  + [Local side channel attack on RSA](../mbedtls-security-advisory-2021-07-1/)
  + [Protocol weakness in DHE-PSK key exchange](../mbedtls-security-advisory-2020-09-3/)
  + [Local side channel attack on RSA and static Diffie-Hellman](../mbedtls-security-advisory-2020-09-2/)
  + [Local side channel attack on classical CBC decryption in (D)TLS](../mbedtls-security-advisory-2020-09-1/)
  + [Side-channel attack on ECC key import and validation](../mbedtls-security-advisory-2020-07/)
  + [Side channel attack on ECDSA](../mbedtls-security-advisory-2020-04/)
  + [Cache attack against RSA key import in SGX](../mbedtls-security-advisory-2020-02/)
  + [Side channel attack on ECDSA](../mbedtls-security-advisory-2019-12/)
  + [Side channel attack on deterministic ECDSA](../mbedtls-security-advisory-2019-10/)
  + [Mbed TLS Security Advisory 2018-03](../mbedtls-security-advisory-2018-03/)
  + [Mbed TLS Security Advisory 2018-02](../mbedtls-security-advisory-2018-02/)
  + [mbed TLS Security Advisory 2018-01](../mbedtls-security-advisory-2018-01/)
  + [mbed TLS Security Advisory 2017-02](../mbedtls-security-advisory-2017-02/)
  + [mbed TLS Security Advisory 2017-01](../mbedtls-security-advisory-2017-01/)
  + [mbed TLS Security Advisory 2015-01](../mbedtls-security-advisory-2015-01/)
  + [PolarSSL Security Advisory 2014-04](../polarssl-security-advisory-2014-04/)
  + [PolarSSL Security Advisory 2014-03](../polarssl-security-advisory-2014-03-poodle-attack-on-ssl-v3/)
  + [PolarSSL Security Advisory 2014-02](../polarssl-security-advisory-2014-02/)
  + [PolarSSL Security Advisory 2014-01](../polarssl-security-advisory-2014-01/)
  + [PolarSSL Security Advisory 2013-05](../polarssl-security-advisory-2013-05/)
  + [PolarSSL Security Advisory 2013-04](../polarssl-security-advisory-2013-04/)
  + [PolarSSL Security Advisory 2013-03](../polarssl-security-advisory-2013-03/)
  + [PolarSSL Security Advisory 2013-02](../polarssl-security-advisory-2013-02/)
  + [PolarSSL Security Advisory 2013-01](../polarssl-security-advisory-2013-01/)
  + [PolarSSL Security Advisory 2012-01](../polarssl-security-advisory-2012-01/)
  + [PolarSSL Security Advisory 2011-02](../polarssl-security-advisory-2011-02/)
  + [PolarSSL Security Advisory 2011-01](../polarssl-security-advisory-2011-01/)
* [Contributing to This Documentation](../../CONTRIBUTING/)
* [Knowledge Base](../../kb/)

[Mbed TLS](../../)

* [Security Advisories](../)
* CTR\_DRBG prioritized over HMAC\_DRBG as the PSA DRBG
* [View page source](../../_sources/security-advisories/mbedtls-security-advisory-2024-08-1.md.txt)

---

# CTR\_DRBG prioritized over HMAC\_DRBG as the PSA DRBG[](#ctr-drbg-prioritized-over-hmac-drbg-as-the-psa-drbg "Permalink to this heading")

| **Title** | CTR\_DRBG prioritized over HMAC\_DRBG as the PSA DRBG |
| --- | --- |
| **CVE** | CVE-2024-45157 |
| **Date** | 30 August 2024 |
| **Affects** | All versions of Mbed TLS since 2.26.0 |
| **Severity** | Low |

## Vulnerability[](#vulnerability "Permalink to this heading")

Mbed TLS 2.26.0 introduced the configuration option `MBEDTLS_PSA_HMAC_DRBG_MD_TYPE` and documented that enabling it explicitly would cause the PSA cryptography subsystem to use HMAC\_DRBG as its pseudorandom generator component. However, this feature was accidentally documented but not implemented. In fact, all versions of Mbed TLS and Mbed Crypto have used CTR\_DRBG in the PSA subsystem if `MBEDTLS_CTR_DRBG_C` is enabled, regardless of whether `MBEDTLS_PSA_HMAC_DRBG_MD_TYPE` is set.

## Impact[](#impact "Permalink to this heading")

Both HMAC\_DRBG (using a hash such as SHA-256 or SHA-512) and CTR\_DRBG (using AES) are generally acceptable choices as pseudorandom generators, and both are secure in terms of the quality of their output. However, they have different security postures with respect to side channels. In particular, when AES is implemented in software, it is more prone to timing and power side channels than hashes, so CTR\_DRBG is weaker against side channel attacks than HMAC\_DRBG. Hence some users may prefer to use HMAC\_DRBG.

## Resolution[](#resolution "Permalink to this heading")

Starting with Mbed TLS 3.6.1 and 2.28.9, the documentation accurately represents the behavior. The behavior does not change: `MBEDTLS_PSA_HMAC_DRBG_MD_TYPE` is ignored when PSA uses CTR\_DRBG.

## Work-around[](#work-around "Permalink to this heading")

To use HMAC\_DRBG as the pseudorandom generator in the PSA subsystem, make sure that the compile-time option `MBEDTLS_CTR_DRBG_C` is disabled.

 [Previous](../mbedtls-security-advisory-2024-08-2/ "Stack buffer overflow in ECDSA signature conversion functions")
[Next](../mbedtls-security-advisory-2024-03/ "Insecure handling of shared memory in PSA Crypto APIs")

---

© Copyright The Mbed TLS Contributors.

Built with [Sphinx](https://www.sphinx-doc.org/) using a
[theme](https://github.com/readthedocs/sphinx_rtd_theme)
provided by [Read the Docs](https://readthedocs.org).

