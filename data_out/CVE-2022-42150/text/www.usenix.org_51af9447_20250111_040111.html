

 [usenix\_logo\_notag\_white](/)

* [Sign In](/user?destination=conference/usenixsecurity23/presentation/he)
* [Conferences](/conferences)

 [![](https://www.usenix.org/sites/default/files/styles/neat_conference_menu_logo/public/sec23_wordmark_stacked_yellow_soldout_400x164.png?itok=nM4vC5Pi)](/conference/usenixsecurity23)

* [Attend](/conference/usenixsecurity23#registration)
  + [Registration Information](/conference/usenixsecurity23/registration-information)
  + [Registration Discounts](/conference/usenixsecurity23/registration-discounts)
  + [Grant Opportunities](/conference/usenixsecurity23/grants)

  + [Venue, Hotel, and Travel](/conference/usenixsecurity23/venue-hotel-and-travel)
* [Program](/conference/usenixsecurity23/glance)
  + [Program at a Glance](/conference/usenixsecurity23/glance)
  + [Technical Sessions](/conference/usenixsecurity23/technical-sessions)

  + [Summer Accepted Papers](/conference/usenixsecurity23/summer-accepted-papers)
  + [Fall Accepted Papers](/conference/usenixsecurity23/fall-accepted-papers)

  + [Poster Session and Happy Hour](/conference/usenixsecurity23/poster-session)
  + [Activities](/conference/usenixsecurity23/activities)
* [Participate](/conference/usenixsecurity23/call-for-papers)
  + [Call for Papers](/conference/usenixsecurity23/call-for-papers)
  + [Submission Policies and Instructions](/conference/usenixsecurity23/submission-policies-and-instructions)

  + [Call for Artifacts](/conference/usenixsecurity23/call-for-artifacts)

  + [Instructions for Presenters](/conference/usenixsecurity23/instructions-presenters)
* [Sponsors](/conference/usenixsecurity23#sponsors)
  + [Exhibitor Services](/conference/usenixsecurity23/exhibitor-services)
* [About](/conference/usenixsecurity23#marquee)
  + [Symposium Organizers](/conference/usenixsecurity23#organizers)
  + [Past Symposia](https://www.usenix.org/conferences/byname/108)

  + [Conference Policies](https://www.usenix.org/policies)
  + [Code of Conduct](https://www.usenix.org/conferences/coc)
  + [Questions](/conference/usenixsecurity23#questions)

# Cross Container Attacks: The Bewildered eBPF on Clouds

Authors:

Yi He and Roland Guo, *Tsinghua University and BNRist;* Yunlong Xing, *George Mason University;* Xijia Che, *Tsinghua University and BNRist;* Kun Sun, *George Mason University;* Zhuotao Liu, Ke Xu, and Qi Li, *Tsinghua University*

Abstract:

The extended Berkeley Packet Filter (eBPF) provides powerful and flexible kernel interfaces to extend the kernel functions for user space programs via running bytecode directly in the kernel space. It has been widely used by cloud services to enhance container security, network management, and system observability. However, we discover that the offensive eBPF that have been extensively discussed in Linux hosts can bring new attack surfaces to containers. With eBPF tracing features, attackers can break the container's isolation and attack the host, e.g., steal sensitive data, DoS, and even escape the container. In this paper, we study the eBPF-based cross container attacks and reveal their security impacts in real world services. With eBPF attacks, we successfully compromise five online Jupyter/Interactive Shell services and the Cloud Shell of Google Cloud Platform. Furthermore, we find that the Kubernetes services offered by three leading cloud vendors can be exploited to launch cross-node attacks after the attackers escape the container via eBPF. Specifically, in Alibaba's Kubernetes services, attackers can compromise the whole cluster by abusing their over-privileged cloud metrics or management Pods. Unfortunately, the eBPF attacks on containers are seldom known and can hardly be discovered by existing intrusion detection systems. Also, the existing eBPF permission model cannot confine the eBPF and ensure secure usage in shared-kernel container environments. To this end, we propose a new eBPF permission model to counter the eBPF attacks in containers.

## [Yi He, Tsinghua University and BNRist](/conference/usenixsecurity23/speaker-or-organizer/yi-he-tsinghua-university-and-bnrist)

## [Roland Guo, Tsinghua University and BNRist](/conference/usenixsecurity23/speaker-or-organizer/roland-guo-tsinghua-university-and-bnrist)

## [Yunlong Xing, George Mason University](/conference/usenixsecurity23/speaker-or-organizer/yunlong-xing-george-mason-university)

## [Xijia Che, Tsinghua University and BNRist](/conference/usenixsecurity23/speaker-or-organizer/xijia-che-tsinghua-university-and-bnrist)

## [Kun Sun, George Mason University](/conference/usenixsecurity23/speaker-or-organizer/kun-sun-george-mason-university)

## [Zhuotao Liu, Tsinghua University and Zhongguancun Laboratory](/conference/usenixsecurity23/speaker-or-organizer/zhuotao-liu-tsinghua-university-and-zhongguancun)

## [Ke Xu, Tsinghua University and Zhongguancun Laboratory](/conference/usenixsecurity23/speaker-or-organizer/ke-xu-tsinghua-university-and-zhongguancun)

## [Qi Li, Tsinghua University and Zhongguancun Laboratory](/conference/usenixsecurity23/speaker-or-organizer/qi-li-tsinghua-university-and-zhongguancun)

## Open Access Media

USENIX is committed to Open Access to the research presented at our events. Papers and proceedings are freely available to everyone once the event begins. Any video, audio, and/or slides that are posted after the event are also free and open to everyone. [Support USENIX](/annual-fund) and our commitment to Open Access.

![](https://www.usenix.org/sites/all/modules/usenix/usenix_files/images/usenix-locked.png)BibTeX@inproceedings {291134,

author = {Yi He and Roland Guo and Yunlong Xing and Xijia Che and Kun Sun and Zhuotao Liu and Ke Xu and Qi Li},

title = {Cross Container Attacks: The Bewildered {eBPF} on Clouds},

booktitle = {32nd USENIX Security Symposium (USENIX Security 23)},

year = {2023},

isbn = {978-1-939133-37-3},

address = {Anaheim, CA},

pages = {5971--5988},

url = {https://www.usenix.org/conference/usenixsecurity23/presentation/he},

publisher = {USENIX Association},

month = aug

}

[Download](/biblio/export/bibtex/291134)![PDF icon](/modules/file/icons/application-pdf.png "application/pdf") [He PDF](https://www.usenix.org/system/files/usenixsecurity23-he.pdf "usenixsecurity23-he.pdf")![](https://www.usenix.org/sites/all/modules/usenix/usenix_files/images/usenix-unlocked.png)[View the slides](https://www.usenix.org/system/files/sec23_slides_he.pdf)
## Presentation Video

* [Attend](/conference/usenixsecurity23#registration)
  + [Registration Information](/conference/usenixsecurity23/registration-information)
  + [Registration Discounts](/conference/usenixsecurity23/registration-discounts)
  + [Grant Opportunities](/conference/usenixsecurity23/grants)
  + [Venue, Hotel, and Travel](/conference/usenixsecurity23/venue-hotel-and-travel)
* [Program](/conference/usenixsecurity23/glance)
  + [Program at a Glance](/conference/usenixsecurity23/glance)
  + [Technical Sessions](/conference/usenixsecurity23/technical-sessions)
  + [Summer Accepted Papers](/conference/usenixsecurity23/summer-accepted-papers)
  + [Fall Accepted Papers](/conference/usenixsecurity23/fall-accepted-papers)
  + [Poster Session and Happy Hour](/conference/usenixsecurity23/poster-session)
  + [Activities](/conference/usenixsecurity23/activities)
* [Participate](/conference/usenixsecurity23/call-for-papers)
  + [Call for Papers](/conference/usenixsecurity23/call-for-papers)
  + [Submission Policies and Instructions](/conference/usenixsecurity23/submission-policies-and-instructions)
  + [Call for Artifacts](/conference/usenixsecurity23/call-for-artifacts)
  + [Instructions for Presenters](/conference/usenixsecurity23/instructions-presenters)
* [Sponsors](/conference/usenixsecurity23#sponsors)
  + [Exhibitor Services](/conference/usenixsecurity23/exhibitor-services)
* [About](/conference/usenixsecurity23#marquee)
  + [Symposium Organizers](/conference/usenixsecurity23#organizers)
  + [Past Symposia](https://www.usenix.org/conferences/byname/108)
  + [Conference Policies](https://www.usenix.org/policies)
  + [Code of Conduct](https://www.usenix.org/conferences/coc)
  + [Questions](/conference/usenixsecurity23#questions)

[Twitter](http://twitter.com/usenixsecurity)[Facebook](https://www.facebook.com/USENIX-Security-Symposium-13544602263)[Youtube](http://www.youtube.com/user/USENIXAssociation)

* [Privacy Policy](/privacy-policy)
* [Contact Us](/contact)

© USENIX

