- **Root cause of vulnerability:** The DouHaoCMS application lacks proper CSRF protection when adding new administrator accounts. Specifically, the application does not include any token verification during the account creation process.
- **Weaknesses/vulnerabilities present:** Cross-Site Request Forgery (CSRF). The vulnerability is in the `adminAction.class.php` file, where the application handles the addition of new administrator accounts. The code does not include CSRF protection measures such as tokens.
- **Impact of exploitation:** An attacker can exploit this vulnerability to add a new administrator account to the system. With a new administrator account, the attacker gains full control of the application.
- **Attack vectors:** An attacker can craft a malicious HTML page that contains a form to add an administrator account. If an authenticated administrator visits this malicious page, their browser will automatically submit the crafted form to the vulnerable application, resulting in a new administrator account being added.
- **Required attacker capabilities/position:** The attacker needs to lure an authenticated administrator to visit a malicious web page. The attacker does not need prior authentication on the target system.