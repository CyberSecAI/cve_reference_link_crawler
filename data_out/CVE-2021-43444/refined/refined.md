```
{
  "cve": "CVE-2021-43444",
  "description": "The provided content describes a series of vulnerabilities in ONLYOFFICE that lead to unauthenticated remote code execution. The vulnerabilities are: 1. Unauthenticated WebSocket: The ONLYOFFICE WebSocket does not require authentication, allowing anyone to connect. 2. Default JWT signing key: ONLYOFFICE uses a default signing key ('secret') for JWT, making authentication bypass trivial, even if enabled. 3. Default download URL signing key: The MD5 signed URLs are signed using the default string 'verysecretstring', enabling direct downloads with a known document ID. 4. WebSocket tampering: Usernames can be set via the 'auth' command in the WebSocket, allowing impersonation. 5. XSS in macros: JavaScript macros are evaluated using eval(), allowing arbitrary JavaScript execution. 6. SSRF in the “auth” websocket command: The document converter downloads and converts any URL provided to it. These vulnerabilities can be chained to achieve remote code execution. An attacker can use a cross-site scripting vulnerability in a document management system that uses ONLYOFFICE to steal document IDs, then use the unauthenticated websocket to download and modify the document. Modified documents containing malicious macros can then be uploaded, and when opened by a user can execute arbitrary code.",
  "vulnerabilities": [
    {
      "root_cause": "The ONLYOFFICE WebSocket does not require authentication.",
      "weaknesses": [
        "Unauthenticated WebSocket access."
      ],
      "impact": "Allows unauthorized access to document data and functionality, including document downloads, modification, chat and macro injection.",
      "attack_vectors": [
        "Direct connection to the websocket endpoint without authentication"
      ],
      "required_capabilities": "Network access to the vulnerable ONLYOFFICE server."
    },
    {
      "root_cause": "ONLYOFFICE uses a default signing key ('secret') for JWT.",
      "weaknesses": [
        "Weak default JWT signing key"
      ],
      "impact": "Trivial authentication bypass even if JWT signing is enabled.",
       "attack_vectors": [
        "Crafted JWT tokens using the default key."
      ],
      "required_capabilities": "Network access to the vulnerable ONLYOFFICE server."
    },
    {
      "root_cause": "The MD5 signed URLs are signed using the default string 'verysecretstring'.",
      "weaknesses": [
          "Weak default URL signing key"
      ],
        "impact": "Allows direct downloads of documents with a known document ID without needing to connect to the websocket.",
       "attack_vectors": [
          "Exploitation of weak signing key to generate valid download URLs for documents with known IDs."
        ],
      "required_capabilities":"Knowledge of a valid document ID."
    },
     {
      "root_cause": "Usernames can be set via the 'auth' command in the WebSocket.",
      "weaknesses": [
          "Lack of validation of WebSocket 'auth' command."
      ],
        "impact": "Allows impersonation within chat and document collaboration features.",
         "attack_vectors": [
          "Send a crafted 'auth' command via the unauthenticated websocket connection."
        ],
      "required_capabilities":"Network access to the vulnerable ONLYOFFICE server."
    },
    {
      "root_cause": "JavaScript macros are evaluated using eval().",
      "weaknesses": [
          "Use of eval() to execute macros."
      ],
        "impact": "Allows arbitrary JavaScript execution in the browser context when a document with a malicious macro is opened.",
       "attack_vectors": [
           "Injection of malicious JavaScript code within the macro definition through unauthenticated websocket connection."
        ],
      "required_capabilities":"Network access to the vulnerable ONLYOFFICE server and the ability to modify a document."
    },
      {
        "root_cause": "The document converter downloads and converts any URL provided to it.",
      "weaknesses": [
           "Server-Side Request Forgery (SSRF) via the document converter."
        ],
      "impact": "Allows an attacker to download and convert any URL available to the server, potentially exposing internal resources and metadata. It can also be used to write arbitrary files to the server due to path traversal vulnerability.",
      "attack_vectors":[
           "Send a crafted message to websocket server providing an arbitrary URL to download and convert."
        ],
        "required_capabilities":"Network access to the vulnerable ONLYOFFICE server."
     },
       {
          "root_cause": "Path traversal vulnerability in the MS Office document parser",
          "weaknesses": [
            "Improper handling of file paths when extracting files from within a ZIP archive (MS Office format). This allows writing to arbitrary locations on the server."
          ],
          "impact": "Arbitrary file write on the server, leading to arbitrary code execution.",
          "attack_vectors":[
            "Craft a malicious document with path traversal sequences in file names and provide it to the document converter via websocket"
            ],
          "required_capabilities":"Network access to the vulnerable ONLYOFFICE server and the ability to craft a malicious document."
        }
  ],
  "additional_details": "This content provides a detailed explanation of the vulnerabilities, the steps to exploit them, and the remediation steps. It also provides a tool (pwnlyoffice) that can be used to exploit these vulnerabilities. The content provides more detail than the official CVE description."
}
```