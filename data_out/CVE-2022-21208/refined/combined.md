=== Content from github.com_69fc337e_20250108_120529.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fnode-opcua%2Fnode-opcua%2Fcommit%2Fdbcb5d5191118c22ee9c89332a94b94e6553d76b)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fnode-opcua%2Fnode-opcua%2Fcommit%2Fdbcb5d5191118c22ee9c89332a94b94e6553d76b)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=node-opcua%2Fnode-opcua)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[node-opcua](/node-opcua)
/
**[node-opcua](/node-opcua/node-opcua)**
Public

* [Notifications](/login?return_to=%2Fnode-opcua%2Fnode-opcua) You must be signed in to change notification settings
* [Fork
  484](/login?return_to=%2Fnode-opcua%2Fnode-opcua)
* [Star
   1.5k](/login?return_to=%2Fnode-opcua%2Fnode-opcua)

* [Code](/node-opcua/node-opcua)
* [Issues
  34](/node-opcua/node-opcua/issues)
* [Pull requests
  3](/node-opcua/node-opcua/pulls)
* [Actions](/node-opcua/node-opcua/actions)
* [Wiki](/node-opcua/node-opcua/wiki)
* [Security](/node-opcua/node-opcua/security)
* [Insights](/node-opcua/node-opcua/pulse)

Additional navigation options

* [Code](/node-opcua/node-opcua)
* [Issues](/node-opcua/node-opcua/issues)
* [Pull requests](/node-opcua/node-opcua/pulls)
* [Actions](/node-opcua/node-opcua/actions)
* [Wiki](/node-opcua/node-opcua/wiki)
* [Security](/node-opcua/node-opcua/security)
* [Insights](/node-opcua/node-opcua/pulse)

## Commit

[Permalink](/node-opcua/node-opcua/commit/dbcb5d5191118c22ee9c89332a94b94e6553d76b)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

PacketAssembler add chunksize verification & refactor

[Browse files](/node-opcua/node-opcua/tree/dbcb5d5191118c22ee9c89332a94b94e6553d76b)
Browse the repository at this point in the history

* Loading branch information

[![@erossignon](https://avatars.githubusercontent.com/u/680220?s=40&v=4)](/erossignon)

[erossignon](/node-opcua/node-opcua/commits?author=erossignon "View all commits by erossignon")
committed
Jun 2, 2022

1 parent
[e43bc5b](/node-opcua/node-opcua/commit/e43bc5b455ba88239098243a99db44b2a61a7105)

commit dbcb5d5

 Show file tree

 Hide file tree

Showing
**3 changed files**
with
**180 additions**
and
**83 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* packages/node-opcua-packet-assembler

  + packages/node-opcua-packet-assembler/package.json
    [package.json](#diff-154af4cd562186011f1a33991e9a42be1633bae537b3a00313cbdea6a9a473c4)
  + source

    - packages/node-opcua-packet-assembler/source/packet\_assembler.ts
      [packet\_assembler.ts](#diff-221caa6056fa788e3f1d9ab94771f33809a04badc39662e7124c4a2d2082c1e7)
  + test

    - packages/node-opcua-packet-assembler/test/test\_packet\_assembler.js
      [test\_packet\_assembler.js](#diff-8ef77e8ad8fa21e3b6f37fc7b79c7ea449d42d64c2519d03a7319f31f559be81)

## There are no files selected for viewing

3 changes: 2 additions & 1 deletion

3
[packages/node-opcua-packet-assembler/package.json](#diff-154af4cd562186011f1a33991e9a42be1633bae537b3a00313cbdea6a9a473c4 "packages/node-opcua-packet-assembler/package.json")

Show comments

[View file](/node-opcua/node-opcua/blob/dbcb5d5191118c22ee9c89332a94b94e6553d76b/packages/node-opcua-packet-assembler/package.json)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -12,7 +12,8 @@ |
|  |  | "author": "Etienne Rossignon", |
|  |  | "license": "MIT", |
|  |  | "dependencies": { |
|  |  | "node-opcua-assert": "2.66.0" |
|  |  | "node-opcua-assert": "2.66.0", |
|  |  | "node-opcua-debug": "2.66.0" |
|  |  | }, |
|  |  | "devDependencies": { |
|  |  | "should": "^13.2.3" |
| Expand Down | |  |

59 changes: 46 additions & 13 deletions

59
[packages/node-opcua-packet-assembler/source/packet\_assembler.ts](#diff-221caa6056fa788e3f1d9ab94771f33809a04badc39662e7124c4a2d2082c1e7 "packages/node-opcua-packet-assembler/source/packet_assembler.ts")

Show comments

[View file](/node-opcua/node-opcua/blob/dbcb5d5191118c22ee9c89332a94b94e6553d76b/packages/node-opcua-packet-assembler/source/packet_assembler.ts)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1,7 +1,9 @@ |
|  |  | import { EventEmitter } from "events"; |
|  |  | import { assert } from "node-opcua-assert"; |
|  |  | import { make\_warningLog } from "node-opcua-debug"; |
|  |  |  |
|  |  | const doDebug = false; |
|  |  | const warningLog = make\_warningLog("PacketAssembler"); |
|  |  |  |
|  |  | /\*\*\* |
|  |  | \* @class PacketAssembler |
| Expand All | | @@ -20,20 +22,35 @@ export interface PacketInfo { |
|  |  | extra: string; |
|  |  | } |
|  |  |  |
|  |  | export type ReadMessageFuncType = (data: Buffer) => PacketInfo; |
|  |  | export type ReadChunkFuncType = (data: Buffer) => PacketInfo; |
|  |  |  |
|  |  | export interface PacketAssemblerOptions { |
|  |  | readMessageFunc: ReadMessageFuncType; |
|  |  |  |
|  |  | // the minimum number of bytes that need to be received before the readMessageFunc can be called |
|  |  | readChunkFunc: ReadChunkFuncType; |
|  |  | // the minimum number of bytes that need to be received before the readChunkFunc can be called |
|  |  | minimumSizeInBytes: number; |
|  |  | maxChunkSize: number; |
|  |  | } |
|  |  |  |
|  |  | export interface PacketAssembler { |
|  |  | on(eventName: "startChunk", eventHandler: (packetInfo: PacketInfo, partial: Buffer) => void): this; |
|  |  | on(eventName: "chunk", eventHandler: (chunk: Buffer) => void): this; |
|  |  | on(eventName: "error", eventHandler: (err: Error) => void): this; |
|  |  | } |
|  |  | /\*\* |
|  |  | \* this class is used to assemble partial data from the tranport layer |
|  |  | \* into message chunks |
|  |  | \*/ |
|  |  | export class PacketAssembler extends EventEmitter { |
|  |  | public static defaultMaxChunkCount = 777; |
|  |  | public static defaultMaxMessageSize = 1024 \* 64 - 7; |
|  |  |  |
|  |  | private readonly \_stack: Buffer[]; |
|  |  | private expectedLength: number; |
|  |  | private currentLength: number; |
|  |  | private readonly readMessageFunc: ReadMessageFuncType; |
|  |  |  |
|  |  | private maxChunkSize: number; |
|  |  |  |
|  |  | private readonly readChunkFunc: ReadChunkFuncType; |
|  |  | private readonly minimumSizeInBytes: number; |
|  |  | private packetInfo?: PacketInfo; |
|  |  |  |
| Expand All | | @@ -42,9 +59,15 @@ export class PacketAssembler extends EventEmitter { |
|  |  | this.\_stack = []; |
|  |  | this.expectedLength = 0; |
|  |  | this.currentLength = 0; |
|  |  | this.readMessageFunc = options.readMessageFunc; |
|  |  | this.readChunkFunc = options.readChunkFunc; |
|  |  | this.minimumSizeInBytes = options.minimumSizeInBytes || 8; |
|  |  | assert(typeof this.readMessageFunc === "function", "packet assembler requires a readMessageFunc"); |
|  |  | assert(typeof this.readChunkFunc === "function", "packet assembler requires a readChunkFunc"); |
|  |  |  |
|  |  | // istanbul ignore next |
|  |  | assert(options.maxChunkSize === undefined || options.maxChunkSize !== 0); |
|  |  |  |
|  |  | this.maxChunkSize = options.maxChunkSize || PacketAssembler.defaultMaxMessageSize; |
|  |  | assert(this.maxChunkSize >= this.minimumSizeInBytes); |
|  |  | } |
|  |  |  |
|  |  | public feed(data: Buffer) { |
| Expand All | | @@ -60,12 +83,22 @@ export class PacketAssembler extends EventEmitter { |
|  |  |  |
|  |  | // we can extract the expected length here |
|  |  | this.packetInfo = this.\_readPacketInfo(data); |
|  |  | this.expectedLength = this.packetInfo.length; |
|  |  |  |
|  |  | assert(this.currentLength === 0); |
|  |  | assert(this.expectedLength > 0); |
|  |  | if (this.packetInfo.length < this.minimumSizeInBytes) { |
|  |  | this.emit("error", new Error("maximum message size exceeded")); |
|  |  | return; |
|  |  | } |
|  |  |  |
|  |  | if (this.packetInfo.length > this.maxChunkSize) { |
|  |  | const message = `maximum chunk size exceeded (maxChunkSize=${this.maxChunkSize} current chunk size = ${this.packetInfo.length})`; |
|  |  | warningLog(message); |
|  |  | this.emit("error", new Error(message)); |
|  |  | return; |
|  |  | } |
|  |  | // we can now emit an event to signal the start of a new packet |
|  |  | this.emit("newMessage", this.packetInfo, data); |
|  |  | this.emit("startChunk", this.packetInfo, data); |
|  |  | this.expectedLength = this.packetInfo.length; |
|  |  | } |
|  |  |  |
|  |  | if (this.expectedLength === 0 || this.currentLength + data.length < this.expectedLength) { |
| Expand All | | @@ -87,7 +120,7 @@ export class PacketAssembler extends EventEmitter { |
|  |  | this.currentLength = 0; |
|  |  | this.expectedLength = 0; |
|  |  |  |
|  |  | this.emit("message", messageChunk); |
|  |  | this.emit("chunk", messageChunk); |
|  |  | } else { |
|  |  | // there is more data in this chunk than expected... |
|  |  | // the chunk need to be split |
| Expand All | | @@ -104,10 +137,10 @@ export class PacketAssembler extends EventEmitter { |
|  |  | } |
|  |  |  |
|  |  | private \_readPacketInfo(data: Buffer) { |
|  |  | return this.readMessageFunc(data); |
|  |  | return this.readChunkFunc(data); |
|  |  | } |
|  |  |  |
|  |  | private \_buildData(data: Buffer) { |
|  |  | private \_buildData(data: Buffer): Buffer { |
|  |  | if (data && this.\_stack.length === 0) { |
|  |  | return data; |
|  |  | } |
| Expand Down | |  |

201 changes: 132 additions & 69 deletions

201
[packages/node-opcua-packet-assembler/test/test\_packet\_assembler.js](#diff-8ef77e8ad8fa21e3b6f37fc7b79c7ea449d42d64c2519d03a7319f31f559be81 "packages/node-opcua-packet-assembler/test/test_packet_assembler.js")

Show comments

[View file](/node-opcua/node-opcua/blob/dbcb5d5191118c22ee9c89332a94b94e6553d76b/packages/node-opcua-packet-assembler/test/test_packet_assembler.js)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1,8 +1,8 @@ |
|  |  | const PacketAssembler = require("..").PacketAssembler; |
|  |  | const should = require("should"); |
|  |  | const sinon = require("sinon"); |
|  |  | const { PacketAssembler } = require(".."); |
|  |  |  |
|  |  | function makeMessage(msgType, length) { |
|  |  |  |
|  |  | function makeChunk(msgType, length) { |
|  |  | const total\_length = length + 4 + 1; |
|  |  |  |
|  |  | total\_length.should.be.greaterThan(0); |
| Expand All | | @@ -19,107 +19,170 @@ function makeMessage(msgType, length) { |
|  |  | return buf; |
|  |  | } |
|  |  |  |
|  |  | function readerHeader(data) { |
|  |  | function readChunkHeader(data) { |
|  |  | const msgType = String.fromCharCode(data.readUInt8(0)); |
|  |  | const length = data.readUInt32LE(1); |
|  |  | return {length: length, extra: msgType}; |
|  |  | return { length: length, extra: msgType }; |
|  |  | } |
|  |  |  |
|  |  |  |
|  |  | describe("PacketAssembler", function () { |
|  |  |  |
|  |  | it("should assemble a single packet", function (done) { |
|  |  |  |
|  |  |  |
|  |  | const packet\_assembler = new PacketAssembler({readMessageFunc: readerHeader, minimumSizeInBytes: 5}) |
|  |  | .on("message", function (message) { |
|  |  |  |
|  |  | const info = readerHeader(message); |
|  |  | info.length.should.equal(message.length); |
|  |  |  |
|  |  | it("should assemble a single packet", (done) => { |
|  |  | const packetAssembler = new PacketAssembler({ readChunkFunc: readChunkHeader, minimumSizeInBytes: 5 }); |
|  |  | packetAssembler.on( |
|  |  | "chunk", |
|  |  | (chunk) => { |
|  |  | const info = readChunkHeader(chunk); |
|  |  | info.length.should.equal(chunk.length); |
|  |  |  |
|  |  | done(); |
|  |  | }); |
|  |  |  |
|  |  | packet\_assembler.feed(makeMessage("A", 200)); |
|  |  | } |
|  |  | ); |
|  |  |  |
|  |  | packetAssembler.feed(makeChunk("A", 200)); |
|  |  | }); |
|  |  |  |
|  |  |  |
|  |  | it("should assemble a message sent over several packets", function (done) { |
|  |  |  |
|  |  | const packet\_assembler = new PacketAssembler({readMessageFunc: readerHeader, minimumSizeInBytes: 5}) |
|  |  | .on("message", function (message) { |
|  |  |  |
|  |  | const info = readerHeader(message); |
|  |  | info.length.should.equal(message.length); |
|  |  | it("should assemble a chunk sent over several packets", (done) => { |
|  |  | const packetAssembler = new PacketAssembler({ readChunkFunc: readChunkHeader, minimumSizeInBytes: 5 }); |
|  |  | packetAssembler.on( |
|  |  | "chunk", |
|  |  | (chunk) => { |
|  |  | const info = readChunkHeader(chunk); |
|  |  | info.length.should.equal(chunk.length); |
|  |  | info.length.should.equal(2000 + 5); |
|  |  | done(); |
|  |  | }); |
|  |  |  |
|  |  | const message1 = makeMessage("A", 2000); |
|  |  | } |
|  |  | ); |
|  |  |  |
|  |  | const packet1 = message1.slice(0, 100); |
|  |  | const packet2 = message1.slice(100, 200); |
|  |  | const packet3 = message1.slice(200); |
|  |  | const chunk1 = makeChunk("A", 2000); |
|  |  |  |
|  |  | packet\_assembler.feed(packet1); |
|  |  | packet\_assembler.feed(packet2); |
|  |  | packet\_assembler.feed(packet3); |
|  |  | const packet1 = chunk1.slice(0, 100); |
|  |  | const packet2 = chunk1.slice(100, 200); |
|  |  | const packet3 = chunk1.slice(200); |
|  |  |  |
|  |  | packetAssembler.feed(packet1); |
|  |  | packetAssembler.feed(packet2); |
|  |  | packetAssembler.feed(packet3); |
|  |  | }); |
|  |  |  |
|  |  | it("should assemble a message sent one byte at a time", function (done) { |
|  |  |  |
|  |  | const packet\_assembler = new PacketAssembler({readMessageFunc: readerHeader, minimumSizeInBytes: 5}) |
|  |  | .on("message", function (message) { |
|  |  |  |
|  |  | const info = readerHeader(message); |
|  |  | info.length.should.equal(message.length); |
|  |  |  |
|  |  | done(); |
|  |  | }); |
|  |  |  |
|  |  | const message = makeMessage("A", 200); |
|  |  |  |
|  |  | for (let i = 0; i < message.length; i++) { |
|  |  | const single\_byte\_chunk = message.slice(i, i + 1); |
|  |  | packet\_assembler.feed(single\_byte\_chunk); |
|  |  | it("should assemble a chunk sent one byte at a time", () => { |
|  |  | const packetAssembler = new PacketAssembler({ |
|  |  | readChunkFunc: readChunkHeader, |
|  |  | minimumSizeInBytes: 5, |
|  |  | maxChunkCount: 10000 |
|  |  | }); |
|  |  | packetAssembler.on( |
|  |  | "chunk", |
|  |  | (chunk) => { |
|  |  | const info = readChunkHeader(chunk); |
|  |  | info.length.should.equal(chunk.length); |
|  |  | } |
|  |  | ); |
|  |  | const onChunkSpy = sinon.spy(); |
|  |  | const errorSpy = sinon.spy(); |
|  |  | packetAssembler.on("chunk", onChunkSpy); |
|  |  | packetAssembler.on("error", errorSpy); |
|  |  |  |
|  |  |  |
|  |  | const chunk = makeChunk("A", 200); |
|  |  |  |
|  |  | for (let i = 0; i < chunk.length; i++) { |
|  |  | const single\_byte\_chunk = chunk.slice(i, i + 1); |
|  |  | packetAssembler.feed(single\_byte\_chunk); |
|  |  | } |
|  |  |  |
|  |  | }); |
|  |  | errorSpy.callCount.should.equal(0); |
|  |  | onChunkSpy.callCount.should.equal(1); |
|  |  |  |
|  |  | it("should deal with packets containing data from 2 different messages", function (done) { |
|  |  | }); |
|  |  |  |
|  |  | it("should deal with packets containing data from 2 different chunks", () => { |
|  |  | let counter = 0; |
|  |  | const packet\_assembler = new PacketAssembler({readMessageFunc: readerHeader, minimumSizeInBytes: 5}) |
|  |  | .on("message", function (message) { |
|  |  |  |
|  |  | const info = readerHeader(message); |
|  |  | info.length.should.equal(message.length); |
|  |  |  |
|  |  | const packetAssembler = new PacketAssembler({ |
|  |  | readChunkFunc: readChunkHeader, |
|  |  | minimumSizeInBytes: 5 |
|  |  | }); |
|  |  |  |
|  |  | packetAssembler.on( |
|  |  | "chunk", |
|  |  | (chunk) => { |
|  |  | const info = readChunkHeader(chunk); |
|  |  | info.length.should.equal(chunk.length); |
|  |  | info.length.should.equal(200 + 5); |
|  |  | counter += 1; |
|  |  | if (counter === 1) { |
|  |  | info.extra.should.equal("A"); |
|  |  | } |
|  |  | if (counter === 2) { |
|  |  | info.extra.should.equal("B"); |
|  |  | done(); |
|  |  | } |
|  |  | }); |
|  |  | } |
|  |  | ); |
|  |  |  |
|  |  | const onChunkSpy = sinon.spy(); |
|  |  | const errorSpy = sinon.spy(); |
|  |  | packetAssembler.on("chunk", onChunkSpy); |
|  |  | packetAssembler.on("error", errorSpy); |
|  |  |  |
|  |  | const message1 = makeMessage("A", 200); |
|  |  | const message2 = makeMessage("B", 200); |
|  |  |  |
|  |  | const packet1 = message1.slice(0, 150); |
|  |  | const packet2\_a = message1.slice(150); |
|  |  | const packet2\_b = message2.slice(0, 150); |
|  |  | const chunk1 = makeChunk("A", 200); |
|  |  | const chunk2 = makeChunk("B", 200); |
|  |  |  |
|  |  | const packet1 = chunk1.slice(0, 150); |
|  |  | const packet2\_a = chunk1.slice(150); |
|  |  | const packet2\_b = chunk2.slice(0, 150); |
|  |  | const packet2 = Buffer.concat([packet2\_a, packet2\_b]); |
|  |  | const packet3 = message2.slice(150); |
|  |  | const packet3 = chunk2.slice(150); |
|  |  |  |
|  |  | packetAssembler.feed(packet1); |
|  |  | packetAssembler.feed(packet2); |
|  |  | packetAssembler.feed(packet3); |
|  |  |  |
|  |  | packet\_assembler.feed(packet1); |
|  |  | packet\_assembler.feed(packet2); |
|  |  | packet\_assembler.feed(packet3); |
|  |  | errorSpy.callCount.should.equal(0); |
|  |  | onChunkSpy.callCount.should.equal(2); |
|  |  |  |
|  |  | }); |
|  |  |  |
|  |  | it("limits: max chunk size exceeded", () => { |
|  |  | const packetAssembler = new PacketAssembler({ |
|  |  | readChunkFunc: readChunkHeader, |
|  |  | minimumSizeInBytes: 5, |
|  |  | maxChunkSize: 100 |
|  |  | }); |
|  |  |  |
|  |  | const onChunkSpy = sinon.spy(); |
|  |  | const errorSpy = sinon.spy(); |
|  |  | packetAssembler.on("chunk", onChunkSpy); |
|  |  | packetAssembler.on("error", errorSpy); |
|  |  |  |
|  |  | let counter = 0; |
|  |  | packetAssembler.on("chunk", (chunk) => { |
|  |  | const info = readChunkHeader(chunk); |
|  |  | info.length.should.equal(chunk.length); |
|  |  | info.length.should.equal(200 + 5); |
|  |  | counter += 1; |
|  |  | if (counter === 1) { |
|  |  | info.extra.should.equal("A"); |
|  |  | } |
|  |  | if (counter === 2) { |
|  |  | info.extra.should.equal("B"); |
|  |  | } |
|  |  | }); |
|  |  | let errorCount = 0; |
|  |  | packetAssembler.on("error", (err) => { |
|  |  | err.message.should.match(/maximum chunk size exceeded/); |
|  |  | errorCount += 1; |
|  |  | }); |
|  |  | const chunk1 = makeChunk("A", 200); |
|  |  | const chunk2 = makeChunk("B", 200); |
|  |  | packetAssembler.feed(chunk1); |
|  |  | packetAssembler.feed(chunk2); |
|  |  |  |
|  |  | errorCount.should.eql(2); |
|  |  |  |
|  |  | onChunkSpy.callCount.should.eql(0); |
|  |  | errorSpy.callCount.should.eql(2); |
|  |  | }); |
|  |  |  |
|  |  | }); |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `dbcb5d5`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fnode-opcua%2Fnode-opcua%2Fcommit%2Fdbcb5d5191118c22ee9c89332a94b94e6553d76b) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_ff0087eb_20250108_120528.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fnode-opcua%2Fnode-opcua%2Fcommit%2F33ca3bab4ab781392a2f8d8f5a14de9a0aa0e410)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fnode-opcua%2Fnode-opcua%2Fcommit%2F33ca3bab4ab781392a2f8d8f5a14de9a0aa0e410)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=node-opcua%2Fnode-opcua)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[node-opcua](/node-opcua)
/
**[node-opcua](/node-opcua/node-opcua)**
Public

* [Notifications](/login?return_to=%2Fnode-opcua%2Fnode-opcua) You must be signed in to change notification settings
* [Fork
  484](/login?return_to=%2Fnode-opcua%2Fnode-opcua)
* [Star
   1.5k](/login?return_to=%2Fnode-opcua%2Fnode-opcua)

* [Code](/node-opcua/node-opcua)
* [Issues
  34](/node-opcua/node-opcua/issues)
* [Pull requests
  3](/node-opcua/node-opcua/pulls)
* [Actions](/node-opcua/node-opcua/actions)
* [Wiki](/node-opcua/node-opcua/wiki)
* [Security](/node-opcua/node-opcua/security)
* [Insights](/node-opcua/node-opcua/pulse)

Additional navigation options

* [Code](/node-opcua/node-opcua)
* [Issues](/node-opcua/node-opcua/issues)
* [Pull requests](/node-opcua/node-opcua/pulls)
* [Actions](/node-opcua/node-opcua/actions)
* [Wiki](/node-opcua/node-opcua/wiki)
* [Security](/node-opcua/node-opcua/security)
* [Insights](/node-opcua/node-opcua/pulse)

## Commit

[Permalink](/node-opcua/node-opcua/commit/33ca3bab4ab781392a2f8d8f5a14de9a0aa0e410)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

fix message chunk overflow detection

[Browse files](/node-opcua/node-opcua/tree/33ca3bab4ab781392a2f8d8f5a14de9a0aa0e410)
Browse the repository at this point in the history

* Loading branch information

[![@erossignon](https://avatars.githubusercontent.com/u/680220?s=40&v=4)](/erossignon)

[erossignon](/node-opcua/node-opcua/commits?author=erossignon "View all commits by erossignon")
committed
Jun 2, 2022

1 parent
[dbcb5d5](/node-opcua/node-opcua/commit/dbcb5d5191118c22ee9c89332a94b94e6553d76b)

commit 33ca3ba

 Show file tree

 Hide file tree

Showing
**38 changed files**
with
**1,093 additions**
and
**439 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* packages

  + node-opcua-client

    - source

      * packages/node-opcua-client/source/client\_base.ts
        [client\_base.ts](#diff-df9310347b2c9a4f111ceadedee3a25c04a80da21044286d566c507252e0203b)
      * private

        + packages/node-opcua-client/source/private/client\_base\_impl.ts
          [client\_base\_impl.ts](#diff-0606b43fcdf7b027fd5f5eb47b880d7c8a869f685b4e5cc697b86a2fb79e6f5d)
    - test

      * packages/node-opcua-client/test/test\_x509\_signature.ts
        [test\_x509\_signature.ts](#diff-61375df9915b585943402e92a80c38a667ac8df7bf0fbf015222768039aae830)
  + node-opcua-end2end-test/test/end\_to\_end

    - packages/node-opcua-end2end-test/test/end\_to\_end/test\_e2e\_issue896\_execute\_method\_access\_control.ts
      [test\_e2e\_issue896\_execute\_method\_access\_control.ts](#diff-b3b08ade6e33f6f261880a46b4ab8889356549f780fcc33584b8482741bfa80b)
    - packages/node-opcua-end2end-test/test/end\_to\_end/u\_test\_e2e\_SubscriptionDiagnostics.js
      [u\_test\_e2e\_SubscriptionDiagnostics.js](#diff-e5c75dacd4501047d4af900b77d5004f575d22e3fc8f18530cc1278c265d6ddd)
    - packages/node-opcua-end2end-test/test/end\_to\_end/u\_test\_e2e\_call\_service.js
      [u\_test\_e2e\_call\_service.js](#diff-e61903b270939c3ed747cabab97eb596ee2e1ff9f5b276a5cb013f0696a2f45b)
    - packages/node-opcua-end2end-test/test/end\_to\_end/u\_test\_e2e\_issue445\_currentSessionCount.js
      [u\_test\_e2e\_issue445\_currentSessionCount.js](#diff-e81b07704a96ab84b5da9ced2fcbed4128615ff97bf1d94d845891a89322abbc)
    - packages/node-opcua-end2end-test/test/end\_to\_end/u\_test\_e2e\_monitoring\_larger\_number2.ts
      [u\_test\_e2e\_monitoring\_larger\_number2.ts](#diff-037a550e3b2e96bd240b8528bce8821a08a3e28344624a6d107df9bf4228fe97)
  + node-opcua-packet-assembler/source

    - packages/node-opcua-packet-assembler/source/packet\_assembler.ts
      [packet\_assembler.ts](#diff-221caa6056fa788e3f1d9ab94771f33809a04badc39662e7124c4a2d2082c1e7)
  + node-opcua-samples/bin

    - packages/node-opcua-samples/bin/opcua\_interceptor.js
      [opcua\_interceptor.js](#diff-443e002c1b5246cfbb61fe585dac88d33bfd3fd4bb62b916f220d32ba4385e49)
  + node-opcua-secure-channel

    - source

      * client

        + packages/node-opcua-secure-channel/source/client/client\_secure\_channel\_layer.ts
          [client\_secure\_channel\_layer.ts](#diff-3d524fa5a490fce68c27a56604af5a669ed3d8bf650a5042d5e0d64882be27fe)
      * packages/node-opcua-secure-channel/source/message\_builder.ts
        [message\_builder.ts](#diff-17677eeeeccbd607c94c6fe20737a5e0edfd9f6436e6f58abf61801fb979a7a8)
      * packages/node-opcua-secure-channel/source/message\_chunker.ts
        [message\_chunker.ts](#diff-53871099a212f26bc4ecbe6b2098a0fc4f049d6208bf24710d5cf9d9aa6030b5)
      * server

        + packages/node-opcua-secure-channel/source/server/server\_secure\_channel\_layer.ts
          [server\_secure\_channel\_layer.ts](#diff-1f9fd0972d3ae0376dccbd412b6766bba4b87a9ea7a73edacfb7da61eee24ac3)
    - test

      * packages/node-opcua-secure-channel/test/test\_decrypt\_unsign.js
        [test\_decrypt\_unsign.js](#diff-d4c87166a6445041942cc09573094e8bb5f20c667518f146927bb3229b7a214b)
      * packages/node-opcua-secure-channel/test/test\_message\_builder.js
        [test\_message\_builder.js](#diff-ad7e0a3afb52eda1888089bf4a2d518167a78bdb299ead1dc1eb86f8d380b1b1)
      * packages/node-opcua-secure-channel/test/test\_message\_builder\_with\_sign\_chunks.js
        [test\_message\_builder\_with\_sign\_chunks.js](#diff-90d15ca13f478ae8a54503ec5a4c6cbf8ebc39252d3b1a9b2a17f8fdccace353)
      * packages/node-opcua-secure-channel/test/test\_secure\_channel\_layer.js
        [test\_secure\_channel\_layer.js](#diff-42ba493c29e06092499955e10ff8a2513039e2dbd05f431ea14a29c2b72a7459)
      * packages/node-opcua-secure-channel/test/test\_secure\_channel\_service.js
        [test\_secure\_channel\_service.js](#diff-eacfe6a9486513fe3c1cf8513fbabc7c08b7754953a0af4e57b3a9a43a8b4795)
      * packages/node-opcua-secure-channel/test/test\_security.ts
        [test\_security.ts](#diff-7536d69663f0a900c56f5821cb8e969b0db594e484469bccc72ce197a438e710)
      * packages/node-opcua-secure-channel/test/test\_server\_secure\_channel\_layer.js
        [test\_server\_secure\_channel\_layer.js](#diff-9bb5b7b3d2d7ae0309781016617751b7d1241613390cf50b97a8e6b567172427)
      * packages/node-opcua-secure-channel/test/test\_various\_packets.js
        [test\_various\_packets.js](#diff-5ea3aa856409326ce20ef7738f80efdc950a3a9c82db1969baa29a80c3b17a7d)
    - test\_fixtures

      * packages/node-opcua-secure-channel/test\_fixtures/fixture\_problematic\_ReadResponse.js
        [fixture\_problematic\_ReadResponse.js](#diff-aed81114cddf8c9dc7c29214012f9d8223165a9c9b3054af713ce5c7121376a3)
    - test\_helpers

      * packages/node-opcua-secure-channel/test\_helpers/fake\_message\_chunk\_factory.ts
        [fake\_message\_chunk\_factory.ts](#diff-f5189e9c32869927da4597fe84c5c3f22fb13a181e2d5f87d0b73278f6b9010e)
      * packages/node-opcua-secure-channel/test\_helpers/verify\_message\_chunk.ts
        [verify\_message\_chunk.ts](#diff-aa9c8d034150d51810079b894fb3a12605564c8875cf4ca356d0230553aafc79)
  + node-opcua-server/source

    - packages/node-opcua-server/source/opcua\_server.ts
      [opcua\_server.ts](#diff-de57b4c1c9864c114145519b8ea509a3d5c5c0ea3a2362d2147a6e94fce5536d)
  + node-opcua-transport

    - source

      * packages/node-opcua-transport/source/client\_tcp\_transport.ts
        [client\_tcp\_transport.ts](#diff-4af587cb40e9322de047f197e270e1b1f233c35458a9f25eb97a7baed5162c0c)
      * packages/node-opcua-transport/source/index.ts
        [index.ts](#diff-9221aa63a2167d181d725fa8ea3a4069b2d253b30ee352f8ae31e18bf685c856)
      * packages/node-opcua-transport/source/message\_builder\_base.ts
        [message\_builder\_base.ts](#diff-762944ed50d024dd5ffc0efa1d208824c58e2b859b5d9b481f3478058307b848)
      * packages/node-opcua-transport/source/server\_tcp\_transport.ts
        [server\_tcp\_transport.ts](#diff-51bbd73b902c8af1f32825053dc6553a8b604ddebe4d07670bbcd478b5988d62)
      * packages/node-opcua-transport/source/status\_codes.ts
        [status\_codes.ts](#diff-67ea6716fa119b532242442e3a400ac57b170a50c9ca134238accec5f489cd73)
      * packages/node-opcua-transport/source/tcp\_transport.ts
        [tcp\_transport.ts](#diff-5a0f653b80ec0c523345e2f37d4428e7490d15f866dfbe1011d18eb789661e68)
      * packages/node-opcua-transport/source/utils.ts
        [utils.ts](#diff-e7f0b6cd9034ccabd717e748d284048b60f086298c84555774b0f31e5bccff99)
    - test

      * packages/node-opcua-transport/test/test\_client\_tcp\_transport.js
        [test\_client\_tcp\_transport.js](#diff-fe78e9efcfbcf48e618c5d51026d5591d83d0a5a5ecb5f1acbd09749e8178215)
      * packages/node-opcua-transport/test/test\_message\_builder\_base.js
        [test\_message\_builder\_base.js](#diff-46f265ef958bc995d91c9cf55501bf243420de9ea54d4d309d893143207f1771)
      * packages/node-opcua-transport/test/test\_server\_tcp\_transport.js
        [test\_server\_tcp\_transport.js](#diff-e915dcedebbda924cf39759bea66808df5deee1b337188092b2f7de3b33b52eb)
    - test\_helpers

      * packages/node-opcua-transport/test\_helpers/direct\_transport.ts
        [direct\_transport.ts](#diff-0b7dd557d4d542d091777820ca99ab60d78f9ffc740210d372842a5278f69128)
      * packages/node-opcua-transport/test\_helpers/half\_com\_channel.ts
        [half\_com\_channel.ts](#diff-4ae058f1d219ec424538b3b0ba30185813c8c99ccf4bf6d295f22fe7cf3bc4f7)

## There are no files selected for viewing

36 changes: 23 additions & 13 deletions

36
[packages/node-opcua-client/source/client\_base.ts](#diff-df9310347b2c9a4f111ceadedee3a25c04a80da21044286d566c507252e0203b "packages/node-opcua-client/source/client_base.ts")

Show comments

[View file](/node-opcua/node-opcua/blob/33ca3bab4ab781392a2f8d8f5a14de9a0aa0e410/packages/node-opcua-client/source/client_base.ts)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -8,19 +8,9 @@ import { OPCUACertificateManager } from "node-opcua-certificate-manager"; |
|  |  | import { OPCUASecureObject } from "node-opcua-common"; |
|  |  | import { Certificate } from "node-opcua-crypto"; |
|  |  | import { ObjectRegistry } from "node-opcua-object-registry"; |
|  |  | import { |
|  |  | ClientSecureChannelLayer, |
|  |  | ConnectionStrategy, |
|  |  | ConnectionStrategyOptions, |
|  |  | SecurityPolicy} from "node-opcua-secure-channel"; |
|  |  | import { |
|  |  | FindServersOnNetworkRequestOptions, |
|  |  | FindServersRequestOptions, |
|  |  | ServerOnNetwork |
|  |  | } from "node-opcua-service-discovery"; |
|  |  | import { |
|  |  | ApplicationDescription, |
|  |  | EndpointDescription} from "node-opcua-service-endpoints"; |
|  |  | import { ClientSecureChannelLayer, ConnectionStrategy, ConnectionStrategyOptions, SecurityPolicy } from "node-opcua-secure-channel"; |
|  |  | import { FindServersOnNetworkRequestOptions, FindServersRequestOptions, ServerOnNetwork } from "node-opcua-service-discovery"; |
|  |  | import { ApplicationDescription, EndpointDescription } from "node-opcua-service-endpoints"; |
|  |  | import { ChannelSecurityToken, MessageSecurityMode } from "node-opcua-service-secure-channel"; |
|  |  | import { ErrorCallback } from "node-opcua-status-code"; |
|  |  |  |
| Expand Down  Expand Up | | @@ -49,6 +39,22 @@ export interface FindEndpointResult { |
|  |  |  |
|  |  | export type FindEndpointCallback = (err: Error | null, result?: FindEndpointResult) => void; |
|  |  |  |
|  |  | export interface TransportSettings { |
|  |  | maxChunkCount?: number; |
|  |  | /\*\* |
|  |  | \* @advanced |
|  |  | \*/ |
|  |  | maxMessageSize?: number; |
|  |  | /\*\* |
|  |  | \* @advanced |
|  |  | \*/ |
|  |  | sendBufferSize?: number; |
|  |  | /\*\* |
|  |  | \* @advanced |
|  |  | \*/ |
|  |  | receiveBufferSize?: number; |
|  |  | } |
|  |  |  |
|  |  | export interface OPCUAClientBaseOptions { |
|  |  | /\*\* |
|  |  | \* the client application name |
| Expand Down  Expand Up | | @@ -131,6 +137,10 @@ export interface OPCUAClientBaseOptions { |
|  |  | \* discovery url: |
|  |  | \*/ |
|  |  | discoveryUrl?: string; |
|  |  | /\*\* |
|  |  | \* @advanced |
|  |  | \*/ |
|  |  | transportSetting?: TransportSettings |
|  |  | } |
|  |  |  |
|  |  | export interface GetEndpointsOptions { |
| Expand Down | |  |

5 changes: 4 additions & 1 deletion

5
[packages/node-opcua-client/source/private/client\_base\_impl.ts](#diff-0606b43fcdf7b027fd5f5eb47b880d7c8a869f685b4e5cc697b86a2fb79e6f5d "packages/node-opcua-client/source/private/client_base_impl.ts")

Show comments

[View file](/node-opcua/node-opcua/blob/33ca3bab4ab781392a2f8d8f5a14de9a0aa0e410/packages/node-opcua-client/source/private/client_base_impl.ts)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -622,7 +622,10 @@ export class ClientBaseImpl extends OPCUASecureObject implements OPCUAClientBase |
|  |  | securityMode: this.securityMode, |
|  |  | securityPolicy: this.securityPolicy, |
|  |  | serverCertificate: this.serverCertificate, |
|  |  | tokenRenewalInterval: this.tokenRenewalInterval |
|  |  | tokenRenewalInterval: this.tokenRenewalInterval, |
|  |  |  |
|  |  | // transportTimeout: |
|  |  |  |
|  |  | }); |
|  |  | secureChannel.protocolVersion = this.protocolVersion; |
|  |  |  |
| Expand Down | |  |

15 changes: 8 additions & 7 deletions

15
[packages/node-opcua-client/test/test\_x509\_signature.ts](#diff-61375df9915b585943402e92a80c38a667ac8df7bf0fbf015222768039aae830 "packages/node-opcua-client/test/test_x509_signature.ts")

Show comments

[View file](/node-opcua/node-opcua/blob/33ca3bab4ab781392a2f8d8f5a14de9a0aa0e410/packages/node-opcua-client/test/test_x509_signature.ts)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -10,7 +10,7 @@ import { decodeExpandedNodeId } from "node-opcua-basic-types"; |
|  |  | import { BinaryStream } from "node-opcua-binary-stream"; |
|  |  | import { Certificate, PrivateKeyPEM, readCertificate, readPrivateKeyPEM, split\_der } from "node-opcua-crypto"; |
|  |  | import { makeBufferFromTrace } from "node-opcua-debug"; |
|  |  | import { constructObject } from "node-opcua-factory"; |
|  |  | import { BaseUAObject, constructObject } from "node-opcua-factory"; |
|  |  | import { |
|  |  | computeSignature, |
|  |  | getCryptoFactory, |
| Expand Down  Expand Up | | @@ -39,13 +39,14 @@ function readMessage(name: string): Buffer { |
|  |  | } |
|  |  |  |
|  |  | async function decodeMessage(buffer: Buffer): Promise<any> { |
|  |  | /\* |
|  |  | const offset = 16 \* 3 + 6; |
|  |  | buffer = buffer.slice(offset); |
|  |  | \*/ |
|  |  | const messageBuilder = new MessageBuilder({}); |
|  |  | const messageBuilder = new MessageBuilder({ |
|  |  | maxChunkCount: 1, |
|  |  | maxChunkSize: buffer.length + 100, |
|  |  | maxMessageSize: buffer.length + 100 |
|  |  | }); |
|  |  |  |
|  |  | messageBuilder.setSecurity(MessageSecurityMode.None, SecurityPolicy.None); |
|  |  | let objMessage: any = null; |
|  |  | let objMessage: BaseUAObject | null = null; |
|  |  | messageBuilder.once("full\_message\_body", (fullMessageBody: Buffer) => { |
|  |  | const stream = new BinaryStream(fullMessageBody); |
|  |  | const id = decodeExpandedNodeId(stream); |
| Expand Down | |  |

56 changes: 29 additions & 27 deletions

56
[...ode-opcua-end2end-test/test/end\_to\_end/test\_e2e\_issue896\_execute\_method\_access\_control.ts](#diff-b3b08ade6e33f6f261880a46b4ab8889356549f780fcc33584b8482741bfa80b "packages/node-opcua-end2end-test/test/end_to_end/test_e2e_issue896_execute_method_access_control.ts")

Show comments

[View file](/node-opcua/node-opcua/blob/33ca3bab4ab781392a2f8d8f5a14de9a0aa0e410/packages/node-opcua-end2end-test/test/end_to_end/test_e2e_issue896_execute_method_access_control.ts)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1,29 +1,29 @@ |
|  |  | import {allPermissions, OPCUAClient, OPCUAServer, StatusCodes, UserTokenType, WellKnownRoles, makeRoles} from "node-opcua"; |
|  |  | import { allPermissions, OPCUAClient, OPCUAServer, StatusCodes, UserTokenType, WellKnownRoles, makeRoles } from "node-opcua"; |
|  |  | import "should"; |
|  |  |  |
|  |  | const describe = require("node-opcua-leak-detector").describeWithLeakDetector; |
|  |  | describe("Issue #896: Check Authorization for UAMethods", () => { |
|  |  | const users = [ |
|  |  | {username: "Gandalf", password: "g", roles: makeRoles([WellKnownRoles.AuthenticatedUser,WellKnownRoles.ConfigureAdmin])}, |
|  |  | {username: "Frodo", password: "f", roles:  makeRoles([WellKnownRoles.AuthenticatedUser])}, |
|  |  | { username: "Gandalf", password: "g", roles: makeRoles([WellKnownRoles.AuthenticatedUser, WellKnownRoles.ConfigureAdmin]) }, |
|  |  | { username: "Frodo", password: "f", roles: makeRoles([WellKnownRoles.AuthenticatedUser]) } |
|  |  | ]; |
|  |  |  |
|  |  | const port = 2226; |
|  |  | const server = new OPCUAServer({ |
|  |  | port, |
|  |  | userManager: { |
|  |  | getUserRoles: username => users.find(user => user.username === username)!.roles, |
|  |  |  |
|  |  | isValidUser(username, password) { |
|  |  | const user = users.find(user => user.username === username); |
|  |  | getUserRoles: (username) => users.find((user) => user.username === username)!.roles, |
|  |  |  |
|  |  | isValidUser: (username: string, password: string) => { |
|  |  | const user = users.find((user) => user.username === username); |
|  |  | if (!user) return false; |
|  |  | return user.password === password; |
|  |  | } |
|  |  | } |
|  |  | }) |
|  |  | }); |
|  |  |  |
|  |  | const client = OPCUAClient.create({ |
|  |  | endpointMustExist: false, |
|  |  | endpointMustExist: false |
|  |  | }); |
|  |  |  |
|  |  | let wasExecuted: boolean; |
| Expand All | | @@ -36,24 +36,26 @@ describe("Issue #896: Check Authorization for UAMethods", () => { |
|  |  | browseName: "e2e", |
|  |  | nodeId: "ns=1;s=e2e" |
|  |  | }); |
|  |  | namespace.addMethod(folder, { |
|  |  | browseName: "doIt", |
|  |  | nodeId: "ns=1;s=doIt", |
|  |  | rolePermissions: [ |
|  |  | { |
|  |  | roleId: WellKnownRoles.ConfigureAdmin, |
|  |  | permissions: allPermissions |
|  |  | } |
|  |  | ] |
|  |  | /\* |
|  |  | namespace |
|  |  | .addMethod(folder, { |
|  |  | browseName: "doIt", |
|  |  | nodeId: "ns=1;s=doIt", |
|  |  | rolePermissions: [ |
|  |  | { |
|  |  | roleId: WellKnownRoles.ConfigureAdmin, |
|  |  | permissions: allPermissions |
|  |  | } |
|  |  | ] |
|  |  | /\* |
|  |  | permissions: { |
|  |  | [Permission.Call]: ["!\*", WellKnownRoles.ConfigureAdmin] |
|  |  | } |
|  |  | \*/ |
|  |  | }).bindMethod((inputArguments, context, callback) => { |
|  |  | wasExecuted = true; |
|  |  | callback(null, {statusCode: StatusCodes.Good}) |
|  |  | }); |
|  |  | }) |
|  |  | .bindMethod((inputArguments, context, callback) => { |
|  |  | wasExecuted = true; |
|  |  | callback(null, { statusCode: StatusCodes.Good }); |
|  |  | }); |
|  |  | await server.start(); |
|  |  | return client.connect(`opc.tcp://localhost:${port}/UA/NodeOPCUA`); |
|  |  | }); |
| Expand All | | @@ -63,7 +65,7 @@ describe("Issue #896: Check Authorization for UAMethods", () => { |
|  |  | await server.shutdown(); |
|  |  | }); |
|  |  |  |
|  |  | beforeEach(() => wasExecuted = false); |
|  |  | beforeEach(() => (wasExecuted = false)); |
|  |  |  |
|  |  | it("should allow Gandalf to execute the method", async () => { |
|  |  | const clientSession = await client.createSession({ |
| Expand All | | @@ -74,7 +76,7 @@ describe("Issue #896: Check Authorization for UAMethods", () => { |
|  |  | const result = await clientSession.call({ |
|  |  | methodId: "ns=1;s=doIt", |
|  |  | objectId: "ns=1;s=e2e", |
|  |  | inputArguments: [], |
|  |  | inputArguments: [] |
|  |  | }); |
|  |  | await clientSession.close(); |
|  |  | result.statusCode.should.eql(StatusCodes.Good); |
| Expand All | | @@ -90,10 +92,10 @@ describe("Issue #896: Check Authorization for UAMethods", () => { |
|  |  | const result = await clientSession.call({ |
|  |  | methodId: "ns=1;s=doIt", |
|  |  | objectId: "ns=1;s=e2e", |
|  |  | inputArguments: [], |
|  |  | inputArguments: [] |
|  |  | }); |
|  |  | await clientSession.close(); |
|  |  | result.statusCode.should.eql(StatusCodes.BadUserAccessDenied); |
|  |  | wasExecuted.should.eql(false); |
|  |  | }); |
|  |  | }); |
|  |  | }); |

5 changes: 0 additions & 5 deletions

5
[packages/node-opcua-end2end-test/test/end\_to\_end/u\_test\_e2e\_SubscriptionDiagnostics.js](#diff-e5c75dacd4501047d4af900b77d5004f575d22e3fc8f18530cc1278c265d6ddd "packages/node-opcua-end2end-test/test/end_to_end/u_test_e2e_SubscriptionDiagnostics.js")

Show comments

[View file](/node-opcua/node-opcua/blob/33ca3bab4ab781392a2f8d8f5a14de9a0aa0e410/packages/node-opcua-end2end-test/test/end_to_end/u_test_e2e_SubscriptionDiagnostics.js)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1,10 +1,5 @@ |
|  |  | /\*global xit,it,describe,before,after,beforeEach,afterEach\*/ |
|  |  | "use strict"; |
|  |  |  |
|  |  |  |
|  |  |  |
|  |  |  |
|  |  | const { assert } = require("node-opcua-assert"); |
|  |  | const async = require("async"); |
|  |  | const should = require("should"); |
|  |  | const sinon = require("sinon"); |
| Expand Down | |  |

4 changes: 2 additions & 2 deletions

4
[packages/node-opcua-end2end-test/test/end\_to\_end/u\_test\_e2e\_call\_service.js](#diff-e61903b270939c3ed747cabab97eb596ee2e1ff9f5b276a5cb013f0696a2f45b "packages/node-opcua-end2end-test/test/end_to_end/u_test_e2e_call_service.js")

Show comments

[View file](/node-opcua/node-opcua/blob/33ca3bab4ab781392a2f8d8f5a14de9a0aa0e410/packages/node-opcua-end2end-test/test/end_to_end/u_test_e2e_call_service.js)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -34,7 +34,7 @@ module.exports = function (test) { |
|  |  |  |
|  |  | beforeEach(function (done) { |
|  |  | client = OPCUAClient.create({ |
|  |  | requestedSessionTimeout: 600 \* 1000 // use long session time out |
|  |  | requestedSessionTimeout: 600 \* 1000, // use long session time out |
|  |  | }); |
|  |  | endpointUrl = test.endpointUrl; |
|  |  | done(); |
| Expand Down  Expand Up | | @@ -270,7 +270,7 @@ module.exports = function (test) { |
|  |  | }); |
|  |  |  |
|  |  | it("Q3-5 should return BadTooManyOperations when CallRequest has too many methods to call", function (done) { |
|  |  | const too\_many = 50000; |
|  |  | const too\_many = 5000; |
|  |  | const methodToCalls = []; |
|  |  | for (let i = 0; i < too\_many; i++) { |
|  |  | methodToCalls.push({ |
| Expand Down | |  |

22 changes: 14 additions & 8 deletions

22
[packages/node-opcua-end2end-test/test/end\_to\_end/u\_test\_e2e\_issue445\_currentSessionCount.js](#diff-e81b07704a96ab84b5da9ced2fcbed4128615ff97bf1d94d845891a89322abbc "packages/node-opcua-end2end-test/test/end_to_end/u_test_e2e_issue445_currentSessionCount.js")

Show comments

[View file](/node-opcua/node-opcua/blob/33ca3bab4ab781392a2f8d8f5a14de9a0aa0e410/packages/node-opcua-end2end-test/test/end_to_end/u_test_e2e_issue445_currentSessionCount.js)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1,18 +1,16 @@ |
|  |  | const async = require("async"); |
|  |  | const should = require("should"); |
|  |  | const chalk = require("chalk"); |
|  |  | const { |
|  |  | AttributeIds, |
|  |  | VariableIds, |
|  |  | OPCUAClient, |
|  |  | resolveNodeId, |
|  |  | ClientMonitoredItem, |
|  |  | StatusCodes, |
|  |  | TimestampsToReturn, |
|  |  | MonitoringMode |
|  |  | } = require("node-opcua"); |
|  |  | const { make\_debugLog, make\_errorLog, checkDebugFlag } = require("node-opcua-debug"); |
|  |  | const { make\_debugLog, checkDebugFlag } = require("node-opcua-debug"); |
|  |  | const { perform\_operation\_on\_subscription\_async } = require("../../test\_helpers/perform\_operation\_on\_client\_session"); |
|  |  | const { pause } = require("../discovery/\_helper"); |
|  |  |  |
|  |  | function f(func) { |
|  |  | return function (callback) { |
| Expand All | | @@ -27,6 +25,9 @@ const doDebug = checkDebugFlag("TEST"); |
|  |  |  |
|  |  | let sessionCounter = 0; |
|  |  | async function connectAndCreateSession(endpointUrl) { |
|  |  |  |
|  |  | await pause(100); |
|  |  |  |
|  |  | const client = OPCUAClient.create({ |
|  |  | name: "client" + sessionCounter++, |
|  |  | }); |
| Expand All | | @@ -36,6 +37,7 @@ async function connectAndCreateSession(endpointUrl) { |
|  |  | } |
|  |  |  |
|  |  | async function closeSessionAndDisconnect({ client, session }) { |
|  |  | await pause(100); |
|  |  | await session.close(); |
|  |  | await client.disconnect(); |
|  |  | } |
| Expand Down  Expand Up | | @@ -65,8 +67,9 @@ async function installMonitoredItem(subscription, nodeId) { |
|  |  | }); |
|  |  | return await new Promise((resolve, reject) => { |
|  |  | const timer = setTimeout(() => { |
|  |  | console.log(monitoredItem); |
|  |  | reject(new Error("Never received changedx for id" + nodeId.toString())); |
|  |  | }, 5000); |
|  |  | }, 15000); |
|  |  |  |
|  |  | monitoredItem.once("changed", function (dataValue) { |
|  |  | clearTimeout(timer); |
| Expand All | | @@ -85,17 +88,19 @@ async function installCumulatedSessionCounter(subscription) { |
|  |  |  |
|  |  | async function waitSessionCountChange(currentSessionCountMonitoredItem) { |
|  |  |  |
|  |  | return await new Promise((resolve,reject) => { |
|  |  | return await new Promise((resolve, reject) => { |
|  |  | const timer = setTimeout(() => { |
|  |  | console.log(currentSessionCountMonitoredItem); |
|  |  | reject(new Error("Never received ", currentSessionCountMonitoredItem.toString())); |
|  |  | }, 5000); |
|  |  | }, 15000); |
|  |  |  |
|  |  | currentSessionCountMonitoredItem.once("changed", function (dataValue) { |
|  |  | clearTimeout(timer); |
|  |  | const new\_currentSessionCount = dataValue.value.value; |
|  |  | debugLog("new currentSessionCount=", dataValue.toString()); |
|  |  | resolve(new\_currentSessionCount); |
|  |  | }); |
|  |  |  |
|  |  | }); |
|  |  | } |
|  |  |  |
| Expand All | | @@ -106,7 +111,7 @@ module.exports = function (test) { |
|  |  |  |
|  |  | const client = OPCUAClient.create({}); |
|  |  |  |
|  |  | await perform\_operation\_on\_subscription\_async(client, endpointUrl, async function (session, subscription) { |
|  |  | await perform\_operation\_on\_subscription\_async(client, endpointUrl, async (session, subscription) => { |
|  |  | const [recordedCurrentSessionCountValues, currentSessionCountMonitoredItem] = await installCurrentSessionCounter( |
|  |  | subscription |
|  |  | ); |
| Expand All | | @@ -124,6 +129,7 @@ module.exports = function (test) { |
|  |  | const promises = [waitSessionCountChange(currentSessionCountMonitoredItem), connectAndCreateSession(endpointUrl)]; |
|  |  | return await Promise.all(promises); |
|  |  | } |
|  |  |  |
|  |  | async function disconnectAndWaitCurrentSessionCountChange({ client, session }) { |
|  |  | debugLog("disconnecting", session.name); |
|  |  |  |
| Expand Down | |  |

16 changes: 11 additions & 5 deletions

16
[packages/node-opcua-end2end-test/test/end\_to\_end/u\_test\_e2e\_monitoring\_larger\_number2.ts](#diff-037a550e3b2e96bd240b8528bce8821a08a3e28344624a6d107df9bf4228fe97 "packages/node-opcua-end2end-test/test/end_to_end/u_test_e2e_monitoring_larger_number2.ts")

Show comments

[View file](/node-opcua/node-opcua/blob/33ca3bab4ab781392a2f8d8f5a14de9a0aa0e410/packages/node-opcua-end2end-test/test/end_to_end/u_test_e2e_monitoring_larger_number2.ts)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1,3 +1,4 @@ |
|  |  | import { clearTimeout } from "timers"; |
|  |  | import { |
|  |  | AddressSpace, |
|  |  | assert, |
| Expand All | | @@ -18,12 +19,10 @@ import { |
|  |  | StatusCode, |
|  |  | TimestampsToReturn |
|  |  | } from "node-opcua"; |
|  |  | import sinon = require("sinon"); |
|  |  | import should = require("should"); |
|  |  | import \* as should from "should"; |
|  |  |  |
|  |  | import { make\_debugLog, checkDebugFlag } from "node-opcua-debug"; |
|  |  | import { itemsToMonitor1 } from "./\_helpers\_items\_to\_monitor"; |
|  |  | import { clearTimeout } from "timers"; |
|  |  | const debugLog = make\_debugLog("TEST"); |
|  |  | const doDebug = checkDebugFlag("TEST"); |
|  |  |  |
| Expand Down  Expand Up | | @@ -118,12 +117,16 @@ export function t(test: any) { |
|  |  | it("Should monitor a large number of node efficiently", async () => { |
|  |  | const { session, subscription, publishEngine } = s; |
|  |  |  |
|  |  | session.on("session\_closed", ()=>{ |
|  |  | console.log("session\_closed"); |
|  |  | }); |
|  |  |  |
|  |  | const namespaceArray = await session.readNamespaceArray(); |
|  |  | const simulationNamespaceIndex = namespaceArray.indexOf("urn://node-opcua-simulator"); |
|  |  | console.log("simulationNamespaceIndex = ", simulationNamespaceIndex); |
|  |  |  |
|  |  | let itemToMonitors: ReadValueIdOptions[] = itemsToMonitor1; |
|  |  | while (itemToMonitors.length + itemsToMonitor1.length < 10000) { |
|  |  | while (itemToMonitors.length + itemsToMonitor1.length < 2200) { |
|  |  | itemToMonitors = itemToMonitors.concat([...itemsToMonitor1]); |
|  |  | } |
|  |  |  |
| Expand Down  Expand Up | | @@ -156,7 +159,10 @@ export function t(test: any) { |
|  |  | console.time("B"); |
|  |  |  |
|  |  | await new Promise<void>((resolve) => { |
|  |  | const timerId = setTimeout(() => resolve(), 12000); |
|  |  |  |
|  |  |  |
|  |  | const timerId = setTimeout(() => resolve(), 5000); |
|  |  |  |
|  |  | group.on("changed", (monitoredItem, dataValue, index) => { |
|  |  | counter++; |
|  |  | if (counter === itemToMonitors.length) { |
| Expand Down | |  |

 Loading

Oops, something went wrong.
 Retry

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `33ca3ba`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fnode-opcua%2Fnode-opcua%2Fcommit%2F33ca3bab4ab781392a2f8d8f5a14de9a0aa0e410) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_862326ac_20250108_120530.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fnode-opcua%2Fnode-opcua%2Fpull%2F1149)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fnode-opcua%2Fnode-opcua%2Fpull%2F1149)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=node-opcua%2Fnode-opcua)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[node-opcua](/node-opcua)
/
**[node-opcua](/node-opcua/node-opcua)**
Public

* [Notifications](/login?return_to=%2Fnode-opcua%2Fnode-opcua) You must be signed in to change notification settings
* [Fork
  484](/login?return_to=%2Fnode-opcua%2Fnode-opcua)
* [Star
   1.5k](/login?return_to=%2Fnode-opcua%2Fnode-opcua)

* [Code](/node-opcua/node-opcua)
* [Issues
  34](/node-opcua/node-opcua/issues)
* [Pull requests
  3](/node-opcua/node-opcua/pulls)
* [Actions](/node-opcua/node-opcua/actions)
* [Wiki](/node-opcua/node-opcua/wiki)
* [Security](/node-opcua/node-opcua/security)
* [Insights](/node-opcua/node-opcua/pulse)

Additional navigation options

* [Code](/node-opcua/node-opcua)
* [Issues](/node-opcua/node-opcua/issues)
* [Pull requests](/node-opcua/node-opcua/pulls)
* [Actions](/node-opcua/node-opcua/actions)
* [Wiki](/node-opcua/node-opcua/wiki)
* [Security](/node-opcua/node-opcua/security)
* [Insights](/node-opcua/node-opcua/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fnode-opcua%2Fnode-opcua%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fnode-opcua%2Fnode-opcua%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Feature/mm #1149

 Merged

[erossignon](/erossignon)
merged 24 commits into
[master](/node-opcua/node-opcua/tree/master "node-opcua/node-opcua:master")
from
[Feature/MM](/node-opcua/node-opcua/tree/Feature/MM "node-opcua/node-opcua:Feature/MM")

Jun 2, 2022

 Merged

# [Feature/mm](#top) #1149

[erossignon](/erossignon)
merged 24 commits into
[master](/node-opcua/node-opcua/tree/master "node-opcua/node-opcua:master")
from
[Feature/MM](/node-opcua/node-opcua/tree/Feature/MM "node-opcua/node-opcua:Feature/MM")

Jun 2, 2022

[Conversation
0](/node-opcua/node-opcua/pull/1149)
[Commits
24](/node-opcua/node-opcua/pull/1149/commits)
[Checks
0](/node-opcua/node-opcua/pull/1149/checks)
[Files changed](/node-opcua/node-opcua/pull/1149/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![erossignon](https://avatars.githubusercontent.com/u/680220?s=60&v=4)](/erossignon)

Copy link

Member

### @erossignon **[erossignon](/erossignon)** commented [Jun 2, 2022](#issue-1257908672)

 *No description provided.*

Sorry, something went wrong.

All reactions

 [erossignon](/erossignon)
added 24 commits
[May 15, 2022 18:56](#commits-pushed-d0ed6b0)

[![@erossignon](https://avatars.githubusercontent.com/u/680220?s=40&v=4)](/erossignon)

`[silent warning message](/node-opcua/node-opcua/pull/1149/commits/d0ed6b0c1c77537ac88d3be66f847cbc2e3efddf "silent warning message")`

`[d0ed6b0](/node-opcua/node-opcua/pull/1149/commits/d0ed6b0c1c77537ac88d3be66f847cbc2e3efddf)`

[![@erossignon](https://avatars.githubusercontent.com/u/680220?s=40&v=4)](/erossignon)

`[improve promoteToMandatory](/node-opcua/node-opcua/pull/1149/commits/d90eb2a2720f99746fbc3a024dccdafaee3bc445 "improve promoteToMandatory
 - children are now cloned and
    modelling rules are preserved.")`
 …

`[d90eb2a](/node-opcua/node-opcua/pull/1149/commits/d90eb2a2720f99746fbc3a024dccdafaee3bc445)`

```
 - children are now cloned and
    modelling rules are preserved.
```

[![@erossignon](https://avatars.githubusercontent.com/u/680220?s=40&v=4)](/erossignon)

`[remove console output](/node-opcua/node-opcua/pull/1149/commits/aad6f4d26f49d797157031657dfbd021e7d7fa24 "remove console output")`

`[aad6f4d](/node-opcua/node-opcua/pull/1149/commits/aad6f4d26f49d797157031657dfbd021e7d7fa24)`

[![@erossignon](https://avatars.githubusercontent.com/u/680220?s=40&v=4)](/erossignon)

`[improve promoteToMandatory & displayNode](/node-opcua/node-opcua/pull/1149/commits/c46bed8ff61cbc9c17a3651f14680683c42f595f "improve promoteToMandatory & displayNode")`

`[c46bed8](/node-opcua/node-opcua/pull/1149/commits/c46bed8ff61cbc9c17a3651f14680683c42f595f)`

[![@erossignon](https://avatars.githubusercontent.com/u/680220?s=40&v=4)](/erossignon)

`[chore(variant) array of extension object can be null](/node-opcua/node-opcua/pull/1149/commits/4a11f3a144184271523fa929a0d0bebf99cf936f "chore(variant) array of extension object can be null")`

`[4a11f3a](/node-opcua/node-opcua/pull/1149/commits/4a11f3a144184271523fa929a0d0bebf99cf936f)`

[![@erossignon](https://avatars.githubusercontent.com/u/680220?s=40&v=4)](/erossignon)

`[pin pnpm version to 6](/node-opcua/node-opcua/pull/1149/commits/53e472ea9f7175dc33857e06a22a6d5d79d33e5b "pin pnpm version to 6")`

`[53e472e](/node-opcua/node-opcua/pull/1149/commits/53e472ea9f7175dc33857e06a22a6d5d79d33e5b)`

[![@erossignon](https://avatars.githubusercontent.com/u/680220?s=40&v=4)](/erossignon)

`[chore: update typedoc](/node-opcua/node-opcua/pull/1149/commits/60b34b739de713645f9a4042d802e172a57cad9d "chore: update typedoc")`

`[60b34b7](/node-opcua/node-opcua/pull/1149/commits/60b34b739de713645f9a4042d802e172a57cad9d)`

[![@erossignon](https://avatars.githubusercontent.com/u/680220?s=40&v=4)](/erossignon)

`[chore: turn test to async](/node-opcua/node-opcua/pull/1149/commits/4fa0459fe682711705e22dc8320ded5c2c17e6b2 "chore: turn test to async")`

`[4fa0459](/node-opcua/node-opcua/pull/1149/commits/4fa0459fe682711705e22dc8320ded5c2c17e6b2)`

[![@erossignon](https://avatars.githubusercontent.com/u/680220?s=40&v=4)](/erossignon)

`[chore: turn test to async](/node-opcua/node-opcua/pull/1149/commits/9c4960fbcabb4bf04b9ce0c2721d42e6fa261956 "chore: turn test to async")`

`[9c4960f](/node-opcua/node-opcua/pull/1149/commits/9c4960fbcabb4bf04b9ce0c2721d42e6fa261956)`

[![@erossignon](https://avatars.githubusercontent.com/u/680220?s=40&v=4)](/erossignon)

`[refactor DiscoveryServer test](/node-opcua/node-opcua/pull/1149/commits/477118dbc85087c2c36ed78771d9904154ad4d9c "refactor DiscoveryServer test")`

`[477118d](/node-opcua/node-opcua/pull/1149/commits/477118dbc85087c2c36ed78771d9904154ad4d9c)`

[![@erossignon](https://avatars.githubusercontent.com/u/680220?s=40&v=4)](/erossignon)

`[.gitlab-ci use slow test](/node-opcua/node-opcua/pull/1149/commits/3aee33f2e2459d35fd23da615aa1c764efed3b16 ".gitlab-ci use slow test")`

`[3aee33f](/node-opcua/node-opcua/pull/1149/commits/3aee33f2e2459d35fd23da615aa1c764efed3b16)`

[![@erossignon](https://avatars.githubusercontent.com/u/680220?s=40&v=4)](/erossignon)

`[fix bonjour issue](/node-opcua/node-opcua/pull/1149/commits/63051e8eabc9cf74c9a691d056e771b4ba1b7dfa "fix bonjour issue")`

`[63051e8](/node-opcua/node-opcua/pull/1149/commits/63051e8eabc9cf74c9a691d056e771b4ba1b7dfa)`

[![@erossignon](https://avatars.githubusercontent.com/u/680220?s=40&v=4)](/erossignon)

`[force nodejs on gitlab-ci](/node-opcua/node-opcua/pull/1149/commits/2564605e81ecc107ce9f2bb018967e712441b281 "force nodejs on gitlab-ci")`

`[2564605](/node-opcua/node-opcua/pull/1149/commits/2564605e81ecc107ce9f2bb018967e712441b281)`

[![@erossignon](https://avatars.githubusercontent.com/u/680220?s=40&v=4)](/erossignon)

`[fix package version consistency](/node-opcua/node-opcua/pull/1149/commits/3c3ee3efbcd96745d2e0dce0768344104ee93453 "fix package version consistency")`

`[3c3ee3e](/node-opcua/node-opcua/pull/1149/commits/3c3ee3efbcd96745d2e0dce0768344104ee93453)`

[![@erossignon](https://avatars.githubusercontent.com/u/680220?s=40&v=4)](/erossignon)

`[remove redundant --if-present](/node-opcua/node-opcua/pull/1149/commits/39e1c42c397ded62fb73b63f334e8aacd5fdf116 "remove redundant --if-present")`

`[39e1c42](/node-opcua/node-opcua/pull/1149/commits/39e1c42c397ded62fb73b63f334e8aacd5fdf116)`

[![@erossignon](https://avatars.githubusercontent.com/u/680220?s=40&v=4)](/erossignon)

`[fix secure channel failing test](/node-opcua/node-opcua/pull/1149/commits/ef927e699fffa3760c1ec8a3a3201df554de6440 "fix secure channel failing test")`

`[ef927e6](/node-opcua/node-opcua/pull/1149/commits/ef927e699fffa3760c1ec8a3a3201df554de6440)`

[![@erossignon](https://avatars.githubusercontent.com/u/680220?s=40&v=4)](/erossignon)

`[fix interface management in object instantiate](/node-opcua/node-opcua/pull/1149/commits/20dc2866acbfcc2d055bb4a600937091904365cf "fix interface management in object instantiate")`

`[20dc286](/node-opcua/node-opcua/pull/1149/commits/20dc2866acbfcc2d055bb4a600937091904365cf)`

[![@erossignon](https://avatars.githubusercontent.com/u/680220?s=40&v=4)](/erossignon)

`[refactor: move promote_opaque_structure_in_notification_data](/node-opcua/node-opcua/pull/1149/commits/92914bc9bf1927feab7bd1b6083f8733fc471843 "refactor: move promote_opaque_structure_in_notification_data")`

`[92914bc](/node-opcua/node-opcua/pull/1149/commits/92914bc9bf1927feab7bd1b6083f8733fc471843)`

[![@erossignon](https://avatars.githubusercontent.com/u/680220?s=40&v=4)](/erossignon)

`[PacketAssembler add chunksize verification & refactor](/node-opcua/node-opcua/pull/1149/commits/8f346964713f56288915a8618fdea9c79236a639 "PacketAssembler add chunksize verification & refactor")`

`[8f34696](/node-opcua/node-opcua/pull/1149/commits/8f346964713f56288915a8618fdea9c79236a639)`

[![@erossignon](https://avatars.githubusercontent.com/u/680220?s=40&v=4)](/erossignon)

`[fix message chunk overflow detection](/node-opcua/node-opcua/pull/1149/commits/90a687d5453b1be5debeac2d44007d0cbe946bb2 "fix message chunk overflow detection")`

`[90a687d](/node-opcua/node-opcua/pull/1149/commits/90a687d5453b1be5debeac2d44007d0cbe946bb2)`

[![@erossignon](https://avatars.githubusercontent.com/u/680220?s=40&v=4)](/erossignon)

`[update packages](/node-opcua/node-opcua/pull/1149/commits/8b5227260c13c7daa313dd8f51f2aec99b78b20d "update packages")`

`[8b52272](/node-opcua/node-opcua/pull/1149/commits/8b5227260c13c7daa313dd8f51f2aec99b78b20d)`

[![@erossignon](https://avatars.githubusercontent.com/u/680220?s=40&v=4)](/erossignon)

`[make addresSpace & serverEngine shutdown tasks async](/node-opcua/node-opcua/pull/1149/commits/2f7a280bc06fd84c658a57af3960a8d8c77b66b2 "make addresSpace & serverEngine shutdown tasks async")`

`[2f7a280](/node-opcua/node-opcua/pull/1149/commits/2f7a280bc06fd84c658a57af3960a8d8c77b66b2)`

[![@erossignon](https://avatars.githubusercontent.com/u/680220?s=40&v=4)](/erossignon)

`[rename consistency script](/node-opcua/node-opcua/pull/1149/commits/3551a6d58d9f2736dda5122632564b97cbcbe424 "rename consistency script")`

`[3551a6d](/node-opcua/node-opcua/pull/1149/commits/3551a6d58d9f2736dda5122632564b97cbcbe424)`

[![@erossignon](https://avatars.githubusercontent.com/u/680220?s=40&v=4)](/erossignon)

`[upgrade node version on ci/cd](/node-opcua/node-opcua/pull/1149/commits/fe16f1b04e8c1811c703f80dad384e2e231dd2ee "upgrade node version on ci/cd")`

`[fe16f1b](/node-opcua/node-opcua/pull/1149/commits/fe16f1b04e8c1811c703f80dad384e2e231dd2ee)`

 [![@erossignon](https://avatars.githubusercontent.com/u/680220?s=40&v=4)](/erossignon)
[erossignon](/erossignon)
[force-pushed](/node-opcua/node-opcua/compare/e3122bf4b8df5987771be69fa9f643ed3341bb1a..fe16f1b04e8c1811c703f80dad384e2e231dd2ee)
the
Feature/MM

branch
from
[`e3122bf`](/node-opcua/node-opcua/commit/e3122bf4b8df5987771be69fa9f643ed3341bb1a) to
[`fe16f1b`](/node-opcua/node-opcua/commit/fe16f1b04e8c1811c703f80dad384e2e231dd2ee)  [Compare](/node-opcua/node-opcua/compare/e3122bf4b8df5987771be69fa9f643ed3341bb1a..fe16f1b04e8c1811c703f80dad384e2e231dd2ee)
[June 2, 2022 10:00](#event-6727073216)

[![@erossignon](https://avatars.githubusercontent.com/u/680220?s=40&v=4)](/erossignon)
[erossignon](/erossignon)
merged commit [`45a8e4c`](/node-opcua/node-opcua/commit/45a8e4c223d5f5555d742103e1e9930152157548)
into
master

[Jun 2, 2022](https://github.com/node-opcua/node-opcua/pull/1149#event-6727465964)

 [![@erossignon](https://avatars.githubusercontent.com/u/680220?s=40&v=4)](/erossignon)
[erossignon](/erossignon)
deleted the
Feature/MM

branch
[August 13, 2022 09:39](#event-7183060698)

[![@github-actions](https://avatars.githubusercontent.com/in/15368?s=40&v=4)](/apps/github-actions)
[github-actions](/apps/github-actions)
bot
mentioned this pull request
[Feb 14, 2023](#ref-issue-1584730832)

[High severity - Denial of Service (DoS) vulnerability in node-opcua (frontend/package.json)
snyk-playground/demo\_actions#19](/snyk-playground/demo_actions/issues/19)

Open

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fnode-opcua%2Fnode-opcua%2Fpull%2F1149)

Reviewers

No reviews

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

Successfully merging this pull request may close these issues.

1 participant

[![@erossignon](https://avatars.githubusercontent.com/u/680220?s=52&v=4)](/erossignon)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from security.snyk.io_1f639479_20250108_120531.html ===
[![Homepage](/_nuxt/header-logo.Dk_X-iWD.svg)](/)

2. [Snyk Vulnerability Database](/vuln)
3. [npm](/vuln/npm)
4. node-opcua
# Denial of Service (DoS) Affecting [node-opcua](/package/npm/node-opcua) package, versions **<2.74.0**

---

### Severity

 Recommended 0.0high010

CVSS assessment made by Snyk's Security Team. [Learn more](/vuln/SNYK-JS-NODEOPCUA-2988723#cvss)

### Threat Intelligence

Exploit Maturity

Snyk has a proof-of-concept or detailed explanation of how to exploit this vulnerability.

Proof of conceptEPSS

The probability is the direct output of the EPSS model, and conveys an overall sense of the threat of
exploitation in the wild. The percentile measures the EPSS probability relative to all known EPSS scores.
Note: This data is updated daily, relying on the latest available EPSS model version.
Check out the EPSS
[documentation](https://www.first.org/epss/articles/prob_percentile_bins)
for more details.

**0.15% (52nd percentile)**
### Do your applications use this vulnerable package?

In a few clicks we can analyze your entire application and see what components are vulnerable in your application, and suggest you quick fixes.

[Test your applications](https://app.snyk.io/login?cta=sign-up&loc=banner&page=vuln-vuln)
### Snyk Learn

Learn about Denial of Service (DoS) vulnerabilities in an interactive lesson.

 [Start learning](https://learn.snyk.io/lesson/redos/)

* Snyk ID**SNYK-JS-NODEOPCUA-2988723**
* published**22 Aug 2022**
* disclosed**22 Aug 2022**
* credit**Vera Mens, Uri Katz, Sharon Brizinov of Team82 (Claroty Research)**

[Report a new vulnerability](https://snyk.io/vulnerability-disclosure/) [Found a mistake?](https://support.snyk.io/s/contactsupport)
#### Introduced: 22 Aug 2022

[CVE-2022-21208  (opens in a new tab)](https://www.cve.org/CVERecord?id=CVE-2022-21208) Common Vulnerabilities and Exposures (CVE) are common identifiers for publicly known security vulnerabilities[CWE-400  (opens in a new tab)](https://cwe.mitre.org/data/definitions/400.html) Common Weakness Enumeration (CWE) is a category system for software weaknesses First added by Snyk
## How to fix?

Upgrade `node-opcua` to version 2.74.0 or higher.

## Overview

[node-opcua](https://www.npmjs.com/package/node-opcua) is an implementation of a OPC UA stack fully written in javascript and nodejs

Affected versions of this package are vulnerable to Denial of Service (DoS) due to a missing limitation on the number of received chunks - per single session or in total for all concurrent sessions.

An attacker can exploit this vulnerability by sending an unlimited number of huge chunks (e.g. 2GB each) without sending the `Final` closing chunk.

## Details

Denial of Service (DoS) describes a family of attacks, all aimed at making a system inaccessible to its intended and legitimate users.

Unlike other vulnerabilities, DoS attacks usually do not aim at breaching security. Rather, they are focused on making websites and services unavailable to genuine users resulting in downtime.

One popular Denial of Service vulnerability is DDoS (a Distributed Denial of Service), an attack that attempts to clog network pipes to the system by generating a large volume of traffic from many machines.

When it comes to open source libraries, DoS vulnerabilities allow attackers to trigger such a crash or crippling of the service by using a flaw either in the application code or from the use of open source libraries.

Two common types of DoS vulnerabilities:

* High CPU/Memory Consumption- An attacker sending crafted requests that could cause the system to take a disproportionate amount of time to process. For example, [commons-fileupload:commons-fileupload](https://security.snyk.io/vuln/SNYK-JAVA-COMMONSFILEUPLOAD-30082).
* Crash - An attacker sending crafted requests that could cause the system to crash. For Example, [npm `ws` package](https://snyk.io/vuln/npm%3Aws%3A20171108)
## References

* [GitHub Commit](https://github.com/node-opcua/node-opcua/commit/33ca3bab4ab781392a2f8d8f5a14de9a0aa0e410)
* [GitHub Commit](https://github.com/node-opcua/node-opcua/commit/dbcb5d5191118c22ee9c89332a94b94e6553d76b)
* [GitHub PR](https://github.com/node-opcua/node-opcua/pull/1149)
### CVSS Scores

version 3.1
### Snyk

7.5 high

* Attack Vector (AV)

  The vulnerable component is bound to the network stack and the set of possible attackers extends beyond the other options listed below, up to and including the entire Internet. Such a vulnerability is often termed “remotely exploitable” and can be thought of as an attack being exploitable *at the protocol level* one or more network hops away (e.g., across one or more routers).

  **Network**
* Attack Complexity (AC)

  Specialized access conditions or extenuating circumstances do not exist. An attacker can expect repeatable success when attacking the vulnerable component.

  **Low**
* Privileges Required (PR)

  The attacker is unauthorized prior to attack, and therefore does not require any access to settings or files of the vulnerable system to carry out an attack.

  **None**
* User Interaction (UI)

  The vulnerable system can be exploited without interaction from any user.

  **None**

* Scope (S)

  An exploited vulnerability can only affect resources managed by the same security authority. In this case, the vulnerable component and the impacted component are either the same, or both are managed by the same security authority.

  **Unchanged**

* Confidentiality (C)

  There is no loss of confidentiality within the impacted component.

  **None**
* Integrity (I)

  There is no loss of integrity within the impacted component.

  **None**
* Availability (A)

  There is a total loss of availability, resulting in the attacker being able to fully deny access to resources in the impacted component; this loss is either sustained (while the attacker continues to deliver the attack) or persistent (the condition persists even after the attack has completed). Alternatively, the attacker has the ability to deny some availability, but the loss of availability presents a direct, serious consequence to the impacted component (e.g., the attacker cannot disrupt existing connections, but can prevent new connections; the attacker can repeatedly exploit a vulnerability that, in each instance of a successful attack, leaks a only small amount of memory, but after repeated exploitation causes a service to become completely unavailable).

  **High**
### NVD

7.5 high
### Product

* [Snyk Open Source](https://snyk.io/product/open-source-security-management/)
* [Snyk Code](https://snyk.io/product/snyk-code/)
* [Snyk Container](https://snyk.io/product/container-vulnerability-management/)
* [Snyk Infrastructure as Code](https://snyk.io/product/infrastructure-as-code-security/)
* [Snyk AppRisk](https://snyk.io/product/snyk-apprisk/)
### Resources

* [Vulnerability DB](https://security.snyk.io/)
* [Documentation](https://docs.snyk.io/)
* [Disclosed Vulnerabilities](/disclosed-vulnerabilities)
* [Blog](https://snyk.io/blog/)
* [FAQs](https://support.snyk.io/)
### Company

* [About](https://snyk.io/about)
* [Jobs](https://snyk.io/careers/)
* Contact
* [Policies](https://snyk.io/policies/terms-of-service/)
* [Do Not Sell My Personal Information](https://preferences.snyk.io/dont_sell)
### Contact Us

* Support
* [Report a new vuln](https://snyk.io/vulnerability-disclosure)
* [Events](https://snyk.io/events)
### Find us online

### Track our development

[![DevSecOps Community Podcast](data:image/svg+xml;base64...)](https://www.devseccon.com/the-secure-developer-podcast/)

© 2025 Snyk Limited

Registered in England and Wales. Company number: 09677925

Registered address: Highlands House, Basingstoke Road, Spencers Wood, Reading, Berkshire, RG7 1NT.


