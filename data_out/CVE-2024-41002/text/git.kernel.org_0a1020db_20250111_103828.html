

| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=a886bcb0f67d1e3d6b2da25b3519de59098200c2)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=a886bcb0f67d1e3d6b2da25b3519de59098200c2)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=a886bcb0f67d1e3d6b2da25b3519de59098200c2)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=a886bcb0f67d1e3d6b2da25b3519de59098200c2)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Chenghai Huang <huangchenghai2@huawei.com> | 2024-04-07 15:59:58 +0800 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-07-05 09:14:24 +0200 |
| commit | [a886bcb0f67d1e3d6b2da25b3519de59098200c2](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=a886bcb0f67d1e3d6b2da25b3519de59098200c2) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=a886bcb0f67d1e3d6b2da25b3519de59098200c2)) | |
| tree | [e10d092fe13ef4e460908938e1414266730a8120](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=a886bcb0f67d1e3d6b2da25b3519de59098200c2) | |
| parent | [ec7afa254367fe310c48f8c970d5e97b17d6d6b5](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=ec7afa254367fe310c48f8c970d5e97b17d6d6b5) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=a886bcb0f67d1e3d6b2da25b3519de59098200c2&id2=ec7afa254367fe310c48f8c970d5e97b17d6d6b5)) | |
| download | [linux-a886bcb0f67d1e3d6b2da25b3519de59098200c2.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-a886bcb0f67d1e3d6b2da25b3519de59098200c2.tar.gz) | |

crypto: hisilicon/sec - Fix memory leak for sec resource release[ Upstream commit bba4250757b4ae1680fea435a358d8093f254094 ]
The AIV is one of the SEC resources. When releasing resources,
it need to release the AIV resources at the same time.
Otherwise, memory leakage occurs.
The aiv resource release is added to the sec resource release
function.
Signed-off-by: Chenghai Huang <huangchenghai2@huawei.com>
Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=a886bcb0f67d1e3d6b2da25b3519de59098200c2)

| -rw-r--r-- | [drivers/crypto/hisilicon/sec2/sec\_crypto.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/crypto/hisilicon/sec2/sec_crypto.c?id=a886bcb0f67d1e3d6b2da25b3519de59098200c2) | 4 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 3 insertions, 1 deletions

| diff --git a/drivers/crypto/hisilicon/sec2/sec\_crypto.c b/drivers/crypto/hisilicon/sec2/sec\_crypto.cindex 0d26eda36a526d..28c167e1be4263 100644--- a/[drivers/crypto/hisilicon/sec2/sec\_crypto.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/crypto/hisilicon/sec2/sec_crypto.c?id=ec7afa254367fe310c48f8c970d5e97b17d6d6b5)+++ b/[drivers/crypto/hisilicon/sec2/sec\_crypto.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/crypto/hisilicon/sec2/sec_crypto.c?id=a886bcb0f67d1e3d6b2da25b3519de59098200c2)@@ -463,8 +463,10 @@ static void sec\_alg\_resource\_free(struct sec\_ctx \*ctx,  if (ctx->pbuf\_supported) sec\_free\_pbuf\_resource(dev, qp\_ctx->res);- if (ctx->alg\_type == SEC\_AEAD)+ if (ctx->alg\_type == SEC\_AEAD) { sec\_free\_mac\_resource(dev, qp\_ctx->res);+ sec\_free\_aiv\_resource(dev, qp\_ctx->res);+ } }  static int sec\_create\_qp\_ctx(struct hisi\_qm \*qm, struct sec\_ctx \*ctx, |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 10:37:05 +0000

