

| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=36810d2db3496bb8b4db7ccda666674a5efc7b47)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=36810d2db3496bb8b4db7ccda666674a5efc7b47)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=36810d2db3496bb8b4db7ccda666674a5efc7b47)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=36810d2db3496bb8b4db7ccda666674a5efc7b47)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Chenghai Huang <huangchenghai2@huawei.com> | 2024-04-07 15:59:58 +0800 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-06-27 13:52:11 +0200 |
| commit | [36810d2db3496bb8b4db7ccda666674a5efc7b47](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=36810d2db3496bb8b4db7ccda666674a5efc7b47) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=36810d2db3496bb8b4db7ccda666674a5efc7b47)) | |
| tree | [0eca2b8151685283ab13cffa9c71a4b53392b202](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=36810d2db3496bb8b4db7ccda666674a5efc7b47) | |
| parent | [c0643d07f84c310521686f3f3a373257439b6fa2](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=c0643d07f84c310521686f3f3a373257439b6fa2) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=36810d2db3496bb8b4db7ccda666674a5efc7b47&id2=c0643d07f84c310521686f3f3a373257439b6fa2)) | |
| download | [linux-36810d2db3496bb8b4db7ccda666674a5efc7b47.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-36810d2db3496bb8b4db7ccda666674a5efc7b47.tar.gz) | |

crypto: hisilicon/sec - Fix memory leak for sec resource release[ Upstream commit bba4250757b4ae1680fea435a358d8093f254094 ]
The AIV is one of the SEC resources. When releasing resources,
it need to release the AIV resources at the same time.
Otherwise, memory leakage occurs.
The aiv resource release is added to the sec resource release
function.
Signed-off-by: Chenghai Huang <huangchenghai2@huawei.com>
Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=36810d2db3496bb8b4db7ccda666674a5efc7b47)

| -rw-r--r-- | [drivers/crypto/hisilicon/sec2/sec\_crypto.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/crypto/hisilicon/sec2/sec_crypto.c?id=36810d2db3496bb8b4db7ccda666674a5efc7b47) | 4 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 3 insertions, 1 deletions

| diff --git a/drivers/crypto/hisilicon/sec2/sec\_crypto.c b/drivers/crypto/hisilicon/sec2/sec\_crypto.cindex 93a972fcbf6386..0558f98e221f63 100644--- a/[drivers/crypto/hisilicon/sec2/sec\_crypto.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/crypto/hisilicon/sec2/sec_crypto.c?id=c0643d07f84c310521686f3f3a373257439b6fa2)+++ b/[drivers/crypto/hisilicon/sec2/sec\_crypto.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/crypto/hisilicon/sec2/sec_crypto.c?id=36810d2db3496bb8b4db7ccda666674a5efc7b47)@@ -481,8 +481,10 @@ static void sec\_alg\_resource\_free(struct sec\_ctx \*ctx,  if (ctx->pbuf\_supported) sec\_free\_pbuf\_resource(dev, qp\_ctx->res);- if (ctx->alg\_type == SEC\_AEAD)+ if (ctx->alg\_type == SEC\_AEAD) { sec\_free\_mac\_resource(dev, qp\_ctx->res);+ sec\_free\_aiv\_resource(dev, qp\_ctx->res);+ } }  static int sec\_alloc\_qp\_ctx\_resource(struct sec\_ctx \*ctx, struct sec\_qp\_ctx \*qp\_ctx) |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-11 10:37:03 +0000

