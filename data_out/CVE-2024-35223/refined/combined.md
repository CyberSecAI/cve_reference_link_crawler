=== Content from github.com_34c88831_20250110_180053.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fdapr%2Fdapr%2Fissues%2F7344)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fdapr%2Fdapr%2Fissues%2F7344)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=dapr%2Fdapr)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[dapr](/dapr)
/
**[dapr](/dapr/dapr)**
Public

* [Notifications](/login?return_to=%2Fdapr%2Fdapr) You must be signed in to change notification settings
* [Fork
  1.9k](/login?return_to=%2Fdapr%2Fdapr)
* [Star
   24.3k](/login?return_to=%2Fdapr%2Fdapr)

* [Code](/dapr/dapr)
* [Issues
  380](/dapr/dapr/issues)
* [Pull requests
  42](/dapr/dapr/pulls)
* [Actions](/dapr/dapr/actions)
* [Security](/dapr/dapr/security)
* [Insights](/dapr/dapr/pulse)

Additional navigation options

* [Code](/dapr/dapr)
* [Issues](/dapr/dapr/issues)
* [Pull requests](/dapr/dapr/pulls)
* [Actions](/dapr/dapr/actions)
* [Security](/dapr/dapr/security)
* [Insights](/dapr/dapr/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fdapr%2Fdapr%2Fissues%2Fnew%2Fchoose)

By clicking ‚ÄúSign up for GitHub‚Äù, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We‚Äôll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fdapr%2Fdapr%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# dapr-api-token passed back to the application 'as-is' when proxying #7344

Closed

[vermillionsword](/vermillionsword) opened this issue
Jan 3, 2024
¬∑ 8 comments

Closed

# [dapr-api-token passed back to the application 'as-is' when proxying](#top) #7344

[vermillionsword](/vermillionsword) opened this issue
Jan 3, 2024
¬∑ 8 comments

Assignees
[![@vermillionsword](https://avatars.githubusercontent.com/u/5043416?s=40&v=4)](/vermillionsword)

Labels
[kind/bug](/dapr/dapr/labels/kind/bug)
Something isn't working

Milestone
[v1.13](/dapr/dapr/milestone/20 "v1.13")

## Comments

[![@vermillionsword](https://avatars.githubusercontent.com/u/5043416?s=80&v=4)](/vermillionsword)

Copy link

Contributor

### **[vermillionsword](/vermillionsword)** commented [Jan 3, 2024](#issue-2064148534) ‚Ä¢ edited Loading

| In what area(s)? /area runtime What version of Dapr? 1.11.2 1.12.2 Expected Behavior I expect that when I proxy a service invocation through dapr using gRPC that the dapr-api-token header is updated to use the app-token-secret instead of the api-token-secret that I sent with my request. Actual Behavior I am instead receiving the same value I sent on the dapr-api-token header to the sidecar in the receiving service. Steps to Reproduce the Problem Setup:   * Run the latest dapr installation * Run a plain gRPC service (C# preferably, though I assume this will happen with any proxied call) * Turn on both `dapr.io/app-token-secret: "app-api-token"` and `dapr.io/api-token-secret: "dapr-api-token"` * Create secrets as described in the documentation   Steps:   * Make a call to the service through dapr transparently (service proxying) * Add `dapr-api-token` header to the request using the `dapi-api-token` secret * Observe the dapr-api-token header, it will not be the `app-api-token` secret, instead it will still be the `dapr-api-token` secret  Release Note RELEASE NOTE: **FIX** dapr-api-token header population for proxied calls |
| --- |
| The text was updated successfully, but these errors were encountered: |

All reactions

[![@vermillionsword](https://avatars.githubusercontent.com/u/5043416?s=40&v=4)](/vermillionsword)
[vermillionsword](/vermillionsword)
added
the
[kind/bug](/dapr/dapr/labels/kind/bug)
Something isn't working
label
[Jan 3, 2024](#event-11379896085)

[![@vermillionsword](https://avatars.githubusercontent.com/u/5043416?s=80&v=4)](/vermillionsword)

Copy link

Contributor

Author

### **[vermillionsword](/vermillionsword)** commented [Jan 17, 2024](#issuecomment-1897168169)

| The issue seems to be around line 138 of <https://github.com/dapr/dapr/blob/master/pkg/messaging/grpc_proxy.go>  Notice how the outgoing context does not get the `dapr-api-token` appended to it from security.GetAppToken() unlike  <https://github.com/dapr/dapr/blob/master/pkg/channel/grpc/grpc_channel.go> |
| --- |

All reactions

Sorry, something went wrong.

[![@yaron2](https://avatars.githubusercontent.com/u/16295283?s=40&u=b2731bf74a0788a2e547178f28d57e6871d8e5e8&v=4)](/yaron2)
[yaron2](/yaron2)
added this to the [v1.13](/dapr/dapr/milestone/20) milestone
[Jan 18, 2024](#event-11518340024)

[![@yaron2](https://avatars.githubusercontent.com/u/16295283?s=80&u=b2731bf74a0788a2e547178f28d57e6871d8e5e8&v=4)](/yaron2)

Copy link

Member

### **[yaron2](/yaron2)** commented [Jan 18, 2024](#issuecomment-1897563394)

| The issue seems to be around line 138 of <https://github.com/dapr/dapr/blob/master/pkg/messaging/grpc_proxy.go>  Notice how the outgoing context does not get the `dapr-api-token` appended to it from security.GetAppToken() unlike  <https://github.com/dapr/dapr/blob/master/pkg/channel/grpc/grpc_channel.go>  Yes, you've correctly identified where the token needs to be added. Would you be interested in opening a PR for this? |
| --- |

All reactions

Sorry, something went wrong.

[![@vermillionsword](https://avatars.githubusercontent.com/u/5043416?s=80&v=4)](/vermillionsword)

Copy link

Contributor

Author

### **[vermillionsword](/vermillionsword)** commented [Jan 18, 2024](#issuecomment-1897759011)

| [@yaron2](https://github.com/yaron2) sure. I think I can do that. |
| --- |

All reactions

Sorry, something went wrong.

[![@yaron2](https://avatars.githubusercontent.com/u/16295283?s=80&u=b2731bf74a0788a2e547178f28d57e6871d8e5e8&v=4)](/yaron2)

Copy link

Member

### **[yaron2](/yaron2)** commented [Jan 18, 2024](#issuecomment-1897783087)

| Great. I've triaged it to 1.13 and we can accept this PR after our code freeze (already in effect) due to the security fix. cc [@JoshVanL](https://github.com/JoshVanL) |
| --- |

All reactions

Sorry, something went wrong.

[![@vermillionsword](https://avatars.githubusercontent.com/u/5043416?s=40&v=4)](/vermillionsword)
[vermillionsword](/vermillionsword)
mentioned this issue
[Jan 18, 2024](#ref-pullrequest-2087490794)

[append app token to outgoing calls, if it is provided
#7404](/dapr/dapr/pull/7404)
 Merged

7 tasks

[![@JoshVanL](https://avatars.githubusercontent.com/u/15893072?s=80&u=697209335688e07013a902cb47780ed2c5c98216&v=4)](/JoshVanL)

Copy link

Contributor

### **[JoshVanL](/JoshVanL)** commented [Feb 3, 2024](#issuecomment-1925437696)

| Fixed in [#7404](https://github.com/dapr/dapr/pull/7404) |
| --- |

All reactions

Sorry, something went wrong.

[![@JoshVanL](https://avatars.githubusercontent.com/u/15893072?s=40&u=697209335688e07013a902cb47780ed2c5c98216&v=4)](/JoshVanL)
[JoshVanL](/JoshVanL)
closed this as [completed](/dapr/dapr/issues?q=is%3Aissue+is%3Aclosed+archived%3Afalse+reason%3Acompleted)
[Feb 3, 2024](#event-11693355553)

[![@yaron2](https://avatars.githubusercontent.com/u/16295283?s=40&u=b2731bf74a0788a2e547178f28d57e6871d8e5e8&v=4)](/yaron2)
[yaron2](/yaron2)
assigned [vermillionsword](/vermillionsword)
[Feb 3, 2024](#event-11693357882)

[![@GoVulnBot](https://avatars.githubusercontent.com/u/96493708?s=40&v=4)](/GoVulnBot)
[GoVulnBot](/GoVulnBot)
mentioned this issue
[May 23, 2024](#ref-issue-2312488007)

[x/vulndb: potential Go vuln in github.com/dapr/dapr: CVE-2024-35223
golang/vulndb#2879](/golang/vulndb/issues/2879)

Closed

[![@marcel-tomate](https://avatars.githubusercontent.com/u/153595649?s=80&v=4)](/marcel-tomate)

Copy link

### **[marcel-tomate](/marcel-tomate)** commented [Jun 5, 2024](#issuecomment-2149998143)

| I'm still facing this issue on runtime 1.13.4 during local development with multiapp run `dapr run -f .`. `APP_API_TOKEN` seems to have no effect at all (setting it either on receiver/caller or both). Only receiving the `dapr-api-token` in my grpc handler, if I add the `DAPR_API_TOKEN` environment variable to the caller service - but the value is from `DAPR_API_TOKEN`.   * I don't expect it to be set on my grpc handler at all (since it is the dapr api token, set on the caller service) * Expect it to be set/overwritten by my specified `APP_API_TOKEN` for this service.   What do I get wrong? [@JoshVanL](https://github.com/JoshVanL) |
| --- |

All reactions

Sorry, something went wrong.

[![@vermillionsword](https://avatars.githubusercontent.com/u/5043416?s=80&v=4)](/vermillionsword)

Copy link

Contributor

Author

### **[vermillionsword](/vermillionsword)** commented [Jun 6, 2024](#issuecomment-2151331948)

| I'm still facing this issue on runtime 1.13.4 during local development with multiapp run `dapr run -f .`. `APP_API_TOKEN` seems to have no effect at all (setting it either on receiver/caller or both). Only receiving the `dapr-api-token` in my grpc handler, if I add the `DAPR_API_TOKEN` environment variable to the caller service - but the value is from `DAPR_API_TOKEN`.   * I don't expect it to be set on my grpc handler at all (since it is the dapr api token, set on the caller service) * Expect it to be set/overwritten by my specified `APP_API_TOKEN` for this service.   What do I get wrong? [@JoshVanL](https://github.com/JoshVanL)  I was confused about this too initially. Setting the env var DAPR\_API\_TOKEN on your services sends the token to dapr for authentication against the secret dapr-api-token. Then the app-api-token secret is sent back to your service and YOU must authenticate the call by hand, which the documentation recommends using an environment variable called APP\_API\_TOKEN for, but could be any env var. |
| --- |

All reactions

Sorry, something went wrong.

[![@marcel-tomate](https://avatars.githubusercontent.com/u/153595649?s=80&v=4)](/marcel-tomate)

Copy link

### **[marcel-tomate](/marcel-tomate)** commented [Jun 6, 2024](#issuecomment-2151587986) ‚Ä¢ edited Loading

| [@vermillionsword](https://github.com/vermillionsword) Thanks for your response, I'm still not sure I fully understand this.  **Then the app-api-token secret is sent back**  Are you referring to the value of the DAPR\_API\_TOKEN?  **YOU must authenticate the call by hand**  I understand this, but it did take me some time to grasp it too.  **using an environment variable called APP\_API\_TOKEN for, but could be any env var.**  I think I‚Äôm starting to get it, but just to clarify, why not use the same DAPR\_API\_TOKEN again? EDIT: I don‚Äôt think the last statement is correct, as the source code explicitly references APP\_API\_TOKEN. |
| --- |

All reactions

Sorry, something went wrong.

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fdapr%2Fdapr%2Fissues%2F7344)

Assignees

[![@vermillionsword](https://avatars.githubusercontent.com/u/5043416?s=40&v=4)](/vermillionsword) [vermillionsword](/vermillionsword)

Labels

[kind/bug](/dapr/dapr/labels/kind/bug)
Something isn't working

Projects

None yet

Milestone

 [**v1.13**](/dapr/dapr/milestone/20 "v1.13")

Development

No branches or pull requests

4 participants

[![@vermillionsword](https://avatars.githubusercontent.com/u/5043416?s=52&v=4)](/vermillionsword) [![@JoshVanL](https://avatars.githubusercontent.com/u/15893072?s=52&v=4)](/JoshVanL) [![@yaron2](https://avatars.githubusercontent.com/u/16295283?s=52&v=4)](/yaron2) [![@marcel-tomate](https://avatars.githubusercontent.com/u/153595649?s=52&v=4)](/marcel-tomate)

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.



=== Content from github.com_27f20a72_20250110_180055.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fdapr%2Fdapr%2Freleases%2Ftag%2Fv1.13.3)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fdapr%2Fdapr%2Freleases%2Ftag%2Fv1.13.3)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Freleases%2Fshow&source=header-repo&source_repo=dapr%2Fdapr)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[dapr](/dapr)
/
**[dapr](/dapr/dapr)**
Public

* [Notifications](/login?return_to=%2Fdapr%2Fdapr) You must be signed in to change notification settings
* [Fork
  1.9k](/login?return_to=%2Fdapr%2Fdapr)
* [Star
   24.3k](/login?return_to=%2Fdapr%2Fdapr)

* [Code](/dapr/dapr/tree/v1.13.3)
* [Issues
  380](/dapr/dapr/issues)
* [Pull requests
  42](/dapr/dapr/pulls)
* [Actions](/dapr/dapr/actions)
* [Security](/dapr/dapr/security)
* [Insights](/dapr/dapr/pulse)

Additional navigation options

* [Code](/dapr/dapr/tree/v1.13.3)
* [Issues](/dapr/dapr/issues)
* [Pull requests](/dapr/dapr/pulls)
* [Actions](/dapr/dapr/actions)
* [Security](/dapr/dapr/security)
* [Insights](/dapr/dapr/pulse)

1. [Releases](/dapr/dapr/releases)
2. [v1.13.3](/dapr/dapr/releases/tag/v1.13.3)

# Dapr Runtime v1.13.3

 Compare

Choose a tag to compare

Could not load tags

Nothing to show

[{{ refName }}
default](/dapr/dapr/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...v1.13.3)

 Loading

[View all tags](/dapr/dapr/tags)

![@dapr-bot](https://avatars.githubusercontent.com/u/56698301?s=40&v=4)
[dapr-bot](/dapr-bot)
released this
21 May 13:16

¬∑
[712 commits](/dapr/dapr/compare/v1.13.3...master)
to master
since this release

[v1.13.3](/dapr/dapr/tree/v1.13.3)

[`4c359b5`](/dapr/dapr/commit/4c359b561a1ce92f50b7c336daa575e196fa9464)

This commit was created on GitHub.com and signed with GitHub‚Äôs **verified signature**.

GPG key ID: B5690EEEBB952194

[Learn about vigilant mode](https://docs.github.com/github/authenticating-to-github/displaying-verification-statuses-for-all-of-your-commits).

# Dapr 1.13.3

This update includes bug fixes:

* [App API token forwarded from caller to receiving app](#app-api-token-forwarded-from-caller-to-receiving-app)
* [Upgrade Go version to 1.21.9](#upgrade-go-version-to-1219)
* [Placement server fails to disseminate placement tables](#placement-server-fails-to-disseminate-placement-tables)
* [Restore dapr\_http\_server\_response\_count HTTP metric](#restore-dapr_http_server_response_count-http-metric)

## App API token forwarded from caller to receiving app

### Problem

The caller sidecar is appending the *local* app API token to the *egress* request, thereby leaking the API token protecting the local app to the foreign sidecar.

### Impact

Receiving app can have access to the calling app's API token and make unauthorized calls directly to the originating app - in case it is listening on 0.0.0.0 or an accessible IP address.

### Root cause

A pull request accidentally added this change.

### Solution

Fixed the issue and added integration tests to verify and avoid future regressions.

## Upgrade Go version to 1.21.9

### Problem

Go version 1.21.8 or older are impacted by [CVE-2023-45288](https://github.com/advisories/GHSA-4v7x-pqxf-cx7m "CVE-2023-45288").

### Impact

See <https://nvd.nist.gov/vuln/detail/CVE-2023-45288>

### Root cause

See <https://nvd.nist.gov/vuln/detail/CVE-2023-45288>

### Solution

Update Go version used to build Dapr.

## Placement server fails to disseminate placement tables

### Problem

In case of an error during dissemination of placement table to a sidecar instance, the dissemination to the remaining instances do not complete. See [#7031](https://github.com/dapr/dapr/issues/7031)

### Impact

Sidecars can run with an old copy of the dissemination table and cannot invoke the correct Dapr sidecar for a given actor instance.

### Root cause

During shutdown, all publish calls to the application where being cancelled.

### Solution

Check the return value of performTableDissemination for errors.

## Restore `dapr_http_server_response_count` HTTP metric

### Problem

An existing metrics was removed without deprecation notice, affecting users that relied on it. See [#7642](https://github.com/dapr/dapr/issues/7642)

### Impact

Users did not have this specific metric available anymore, potentially impacting their alerts and monitoring.

### Root cause

Metric removed without deprecation notice.

### Solution

Added the metric back.

 Assets
74

 Loading

 üöÄ
3
 KrylixZA, mukundansundar, and yaron2 reacted with rocket emoji

All reactions

* üöÄ
  3 reactions

 3 people reacted

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.



=== Content from github.com_9f89be14_20250110_180055.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fdapr%2Fdapr%2Fpull%2F7404)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fdapr%2Fdapr%2Fpull%2F7404)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=dapr%2Fdapr)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[dapr](/dapr)
/
**[dapr](/dapr/dapr)**
Public

* [Notifications](/login?return_to=%2Fdapr%2Fdapr) You must be signed in to change notification settings
* [Fork
  1.9k](/login?return_to=%2Fdapr%2Fdapr)
* [Star
   24.3k](/login?return_to=%2Fdapr%2Fdapr)

* [Code](/dapr/dapr)
* [Issues
  380](/dapr/dapr/issues)
* [Pull requests
  42](/dapr/dapr/pulls)
* [Actions](/dapr/dapr/actions)
* [Security](/dapr/dapr/security)
* [Insights](/dapr/dapr/pulse)

Additional navigation options

* [Code](/dapr/dapr)
* [Issues](/dapr/dapr/issues)
* [Pull requests](/dapr/dapr/pulls)
* [Actions](/dapr/dapr/actions)
* [Security](/dapr/dapr/security)
* [Insights](/dapr/dapr/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fdapr%2Fdapr%2Fissues%2Fnew%2Fchoose)

By clicking ‚ÄúSign up for GitHub‚Äù, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We‚Äôll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fdapr%2Fdapr%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# append app token to outgoing calls, if it is provided #7404

 Merged

[yaron2](/yaron2)
merged 2 commits into
[dapr:master](/dapr/dapr/tree/master "dapr/dapr:master")
from
vermillionsword:7344-append-app-token

Jan 18, 2024

 Merged

# [append app token to outgoing calls, if it is provided](#top) #7404

[yaron2](/yaron2)
merged 2 commits into
[dapr:master](/dapr/dapr/tree/master "dapr/dapr:master")
from
vermillionsword:7344-append-app-token

Jan 18, 2024

[Conversation
5](/dapr/dapr/pull/7404)
[Commits
2](/dapr/dapr/pull/7404/commits)
[Checks
20](/dapr/dapr/pull/7404/checks)
[Files changed](/dapr/dapr/pull/7404/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![vermillionsword](https://avatars.githubusercontent.com/u/5043416?s=60&v=4)](/vermillionsword)

Copy link

Contributor

### @vermillionsword **[vermillionsword](/vermillionsword)** commented [Jan 18, 2024](#issue-2087490794)

# Description

This PR appends the App API Token to calls made using the transparent proxy functionality provided in grpc\_proxy.go

It will only be appended if the environment variable exists

## Issue reference

[#7344](https://github.com/dapr/dapr/issues/7344)

## Checklist

Please make sure you've completed the relevant tasks for this PR, out of the following list:

* Code compiles correctly
* Created/updated tests
* Unit tests passing
* End-to-end tests passing
* Extended the documentation / Created issue in the <https://github.com/dapr/docs/> repo: dapr/docs#*[issue number]*
* Specification has been updated / Created issue in the <https://github.com/dapr/docs/> repo: dapr/docs#*[issue number]*
* Provided sample for the feature / Created issue in the <https://github.com/dapr/docs/> repo: dapr/docs#*[issue number]*

Sorry, something went wrong.

All reactions

`[append app token to outgoing calls, if it is provided](/dapr/dapr/pull/7404/commits/4caa6f4bec9be67dff315a26998c71ca7b52c455 "append app token to outgoing calls, if it is provided

Signed-off-by: Ryan Kelly <gatedlogic@live.com>")`
 ‚Ä¶

`[4caa6f4](/dapr/dapr/pull/7404/commits/4caa6f4bec9be67dff315a26998c71ca7b52c455)`

```
Signed-off-by: Ryan Kelly <gatedlogic@live.com>
```

 [![@vermillionsword](https://avatars.githubusercontent.com/u/5043416?s=40&v=4)](/vermillionsword)
[vermillionsword](/vermillionsword)
requested review from
a team
as [code owners](/dapr/dapr/blob/8ff62acc4e47c5d6359bfc733b7a409c0600f7a6/CODEOWNERS#L2)
[January 18, 2024 04:48](#event-11520193399)

[![@yaron2](https://avatars.githubusercontent.com/u/16295283?s=80&u=b2731bf74a0788a2e547178f28d57e6871d8e5e8&v=4)](/yaron2)

Copy link

Member

### **[yaron2](/yaron2)** commented [Jan 18, 2024](#issuecomment-1897806547)

| [@vermillionsword](https://github.com/vermillionsword) see the minor linter error |
| --- |

 üëç
1
 vermillionsword reacted with thumbs up emoji

All reactions

* üëç
  1 reaction

Sorry, something went wrong.

[![daixiang0](https://avatars.githubusercontent.com/u/26538619?s=60&v=4)](/daixiang0)

**[daixiang0](/daixiang0)**
approved these changes
[Jan 18, 2024](#pullrequestreview-1828845983)

 [View reviewed changes](/dapr/dapr/pull/7404/files/0c4285e2e21858688be20fc324815f579f62e9fb)

Copy link

Member

### @daixiang0 **[daixiang0](/daixiang0)** left a comment

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

LGTM

Sorry, something went wrong.

All reactions

[![@daixiang0](https://avatars.githubusercontent.com/u/26538619?s=80&u=6261612ded324edb4ce57dce98e40413276aeb74&v=4)](/daixiang0)

Copy link

Member

### **[daixiang0](/daixiang0)** commented [Jan 18, 2024](#issuecomment-1897824603)

| [@vermillionsword](https://github.com/vermillionsword) please fix DCO. |
| --- |

All reactions

Sorry, something went wrong.

`[use declare and assign syntax](/dapr/dapr/pull/7404/commits/0c4285e2e21858688be20fc324815f579f62e9fb "use declare and assign syntax

Signed-off-by: Ryan Kelly <gatedlogic@live.com>")`
 ‚Ä¶

`[0c4285e](/dapr/dapr/pull/7404/commits/0c4285e2e21858688be20fc324815f579f62e9fb)`

```
Signed-off-by: Ryan Kelly <gatedlogic@live.com>
```

[![@vermillionsword](https://avatars.githubusercontent.com/u/5043416?s=80&v=4)](/vermillionsword)

Copy link

Contributor

Author

### **[vermillionsword](/vermillionsword)** commented [Jan 18, 2024](#issuecomment-1897826449)

| [@vermillionsword](https://github.com/vermillionsword) please fix DCO.  Fixed |
| --- |

All reactions

Sorry, something went wrong.

[![@codecov](https://avatars.githubusercontent.com/in/254?s=80&v=4)](/apps/codecov)
[![Codecov](https://avatars.githubusercontent.com/in/254?s=40&u=c392dd7c2afc51fe2347d4296afa8494ac05772e&v=4)](https://github.com/apps/codecov)

Copy link

### **[codecov](/apps/codecov) bot** commented [Jan 18, 2024](#issuecomment-1897834085)

| [Codecov](https://app.codecov.io/gh/dapr/dapr/pull/7404?src=pr&el=h1&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=dapr) Report All modified and coverable lines are covered by tests ‚úÖ  Comparison is base [(`8ff62ac`)](https://app.codecov.io/gh/dapr/dapr/commit/8ff62acc4e47c5d6359bfc733b7a409c0600f7a6?el=desc&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=dapr) 62.39% compared to head [(`65f9183`)](https://app.codecov.io/gh/dapr/dapr/pull/7404?src=pr&el=desc&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=dapr) 62.36%.  ‚ùó Current head [65f9183](https://github.com/dapr/dapr/commit/65f9183c6004dbb381db6b1ccc2239135ce96cf4) differs from pull request most recent head [0c4285e](https://github.com/dapr/dapr/commit/0c4285e2e21858688be20fc324815f579f62e9fb). Consider uploading reports for the commit [0c4285e](https://github.com/dapr/dapr/commit/0c4285e2e21858688be20fc324815f579f62e9fb) to get more accurate results Additional details and impacted files ``` @@            Coverage Diff             @@ ##           master    #7404      +/-   ## ========================================== - Coverage   62.39%   62.36%   -0.04%      ==========================================   Files         240      240                 Lines       22156    22159       +3      ========================================== - Hits        13825    13820       -5      - Misses       7173     7179       +6      - Partials     1158     1160       +2      ```   [‚òî View full report in Codecov by Sentry](https://app.codecov.io/gh/dapr/dapr/pull/7404?src=pr&el=continue&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=dapr). üì¢ Have feedback on the report? [Share it here](https://about.codecov.io/codecov-pr-comment-feedback/?utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=dapr). |
| --- |

All reactions

Sorry, something went wrong.

[![ItalyPaleAle](https://avatars.githubusercontent.com/u/43508?s=60&v=4)](/ItalyPaleAle)

**[ItalyPaleAle](/ItalyPaleAle)**
approved these changes
[Jan 18, 2024](#pullrequestreview-1828905158)

 [View reviewed changes](/dapr/dapr/pull/7404/files/0c4285e2e21858688be20fc324815f579f62e9fb)

 Hide details
View details

[![@yaron2](https://avatars.githubusercontent.com/u/16295283?s=40&u=b2731bf74a0788a2e547178f28d57e6871d8e5e8&v=4)](/yaron2)
[yaron2](/yaron2)
merged commit [`aff656e`](/dapr/dapr/commit/aff656ef026c7c02b931cd300fa17703e567bba9)
into
dapr:master

[Jan 18, 2024](https://github.com/dapr/dapr/pull/7404#event-11521149887)
16 of 20 checks passed

[![@ItalyPaleAle](https://avatars.githubusercontent.com/u/43508?s=40&v=4)](/ItalyPaleAle)
[ItalyPaleAle](/ItalyPaleAle)
added this to the [v1.13](/dapr/dapr/milestone/20) milestone
[Jan 18, 2024](#event-11526434407)

[whytem](/whytem)
pushed a commit
to whytem/dapr
that referenced
this pull request
[Jan 22, 2024](#ref-commit-36a8e27)
[![@vermillionsword](https://avatars.githubusercontent.com/u/5043416?s=40&v=4)](/vermillionsword) [![@whytem](https://avatars.githubusercontent.com/u/12710820?s=40&v=4)](/whytem)

`[append app token to outgoing calls, if it is provided (](/whytem/dapr/commit/36a8e27971ccd5fa619d0f6bb8ae82c1a52123ce "append app token to outgoing calls, if it is provided (#7404)

* append app token to outgoing calls, if it is provided

Signed-off-by: Ryan Kelly <gatedlogic@live.com>

* use declare and assign syntax

Signed-off-by: Ryan Kelly <gatedlogic@live.com>

---------

Signed-off-by: Ryan Kelly <gatedlogic@live.com>
Co-authored-by: Ryan Kelly <gatedlogic@live.com>")[dapr#7404](https://github.com/dapr/dapr/pull/7404)[)](/whytem/dapr/commit/36a8e27971ccd5fa619d0f6bb8ae82c1a52123ce "append app token to outgoing calls, if it is provided (#7404)

* append app token to outgoing calls, if it is provided

Signed-off-by: Ryan Kelly <gatedlogic@live.com>

* use declare and assign syntax

Signed-off-by: Ryan Kelly <gatedlogic@live.com>

---------

Signed-off-by: Ryan Kelly <gatedlogic@live.com>
Co-authored-by: Ryan Kelly <gatedlogic@live.com>")`
‚Ä¶

`[36a8e27](/whytem/dapr/commit/36a8e27971ccd5fa619d0f6bb8ae82c1a52123ce)`

```
* append app token to outgoing calls, if it is provided

Signed-off-by: Ryan Kelly <gatedlogic@live.com>

* use declare and assign syntax

Signed-off-by: Ryan Kelly <gatedlogic@live.com>

---------

Signed-off-by: Ryan Kelly <gatedlogic@live.com>
Co-authored-by: Ryan Kelly <gatedlogic@live.com>
```

 [![@vermillionsword](https://avatars.githubusercontent.com/u/5043416?s=40&v=4)](/vermillionsword)
[vermillionsword](/vermillionsword)
deleted the
7344-append-app-token

branch
[January 23, 2024 03:10](#event-11564358222)

[elena-kolevska](/elena-kolevska)
pushed a commit
to elena-kolevska/dapr
that referenced
this pull request
[Jan 24, 2024](#ref-commit-b1215d5)
[![@vermillionsword](https://avatars.githubusercontent.com/u/5043416?s=40&v=4)](/vermillionsword) [![@elena-kolevska](https://avatars.githubusercontent.com/u/2369210?s=40&v=4)](/elena-kolevska)

`[append app token to outgoing calls, if it is provided (](/elena-kolevska/dapr/commit/b1215d58f3ed2215a75967d1d71d37cee6ce30e6 "append app token to outgoing calls, if it is provided (#7404)

* append app token to outgoing calls, if it is provided

Signed-off-by: Ryan Kelly <gatedlogic@live.com>

* use declare and assign syntax

Signed-off-by: Ryan Kelly <gatedlogic@live.com>

---------

Signed-off-by: Ryan Kelly <gatedlogic@live.com>
Co-authored-by: Ryan Kelly <gatedlogic@live.com>")[dapr#7404](https://github.com/dapr/dapr/pull/7404)[)](/elena-kolevska/dapr/commit/b1215d58f3ed2215a75967d1d71d37cee6ce30e6 "append app token to outgoing calls, if it is provided (#7404)

* append app token to outgoing calls, if it is provided

Signed-off-by: Ryan Kelly <gatedlogic@live.com>

* use declare and assign syntax

Signed-off-by: Ryan Kelly <gatedlogic@live.com>

---------

Signed-off-by: Ryan Kelly <gatedlogic@live.com>
Co-authored-by: Ryan Kelly <gatedlogic@live.com>")`
‚Ä¶

`[b1215d5](/elena-kolevska/dapr/commit/b1215d58f3ed2215a75967d1d71d37cee6ce30e6)`

```
* append app token to outgoing calls, if it is provided

Signed-off-by: Ryan Kelly <gatedlogic@live.com>

* use declare and assign syntax

Signed-off-by: Ryan Kelly <gatedlogic@live.com>

---------

Signed-off-by: Ryan Kelly <gatedlogic@live.com>
Co-authored-by: Ryan Kelly <gatedlogic@live.com>
```

[elena-kolevska](/elena-kolevska)
added a commit
to elena-kolevska/dapr
that referenced
this pull request
[Jan 24, 2024](#ref-commit-12406b9)
[![@elena-kolevska](https://avatars.githubusercontent.com/u/2369210?s=40&u=06b877f6aad5dee25c238cfb6115d42f279cb05c&v=4)](/elena-kolevska)

`[Revert "append app token to outgoing calls, if it is provided (](/elena-kolevska/dapr/commit/12406b9137b4c8bfa63d8efee9cca3664ec68f02 "Revert \"append app token to outgoing calls, if it is provided (#7404)\"

This reverts commit b1215d58f3ed2215a75967d1d71d37cee6ce30e6.")[dapr#7404](https://github.com/dapr/dapr/pull/7404)`
‚Ä¶

`[12406b9](/elena-kolevska/dapr/commit/12406b9137b4c8bfa63d8efee9cca3664ec68f02)`

```
)"

This reverts commit [b1215d5](https://github.com/elena-kolevska/dapr/commit/b1215d58f3ed2215a75967d1d71d37cee6ce30e6).
```

[elena-kolevska](/elena-kolevska)
added a commit
to elena-kolevska/dapr
that referenced
this pull request
[Jan 24, 2024](#ref-commit-c9381b9)
[![@elena-kolevska](https://avatars.githubusercontent.com/u/2369210?s=40&u=06b877f6aad5dee25c238cfb6115d42f279cb05c&v=4)](/elena-kolevska)

`[Revert "Revert "append app token to outgoing calls, if it is provided (](/elena-kolevska/dapr/commit/c9381b9112691f2e5a1df2f5a6f1a873cbdc63ff "Revert \"Revert \"append app token to outgoing calls, if it is provided (#7404)\"\"

This reverts commit 12406b9137b4c8bfa63d8efee9cca3664ec68f02.")[‚Ä¶](https://github.com/dapr/dapr/pull/7404)`
‚Ä¶

`[c9381b9](/elena-kolevska/dapr/commit/c9381b9112691f2e5a1df2f5a6f1a873cbdc63ff)`

```
[‚Ä¶dapr#7404](https://github.com/dapr/dapr/pull/7404))""

This reverts commit [12406b9](https://github.com/elena-kolevska/dapr/commit/12406b9137b4c8bfa63d8efee9cca3664ec68f02).
```

[elena-kolevska](/elena-kolevska)
added a commit
to elena-kolevska/dapr
that referenced
this pull request
[Jan 24, 2024](#ref-commit-4b6f699)
[![@elena-kolevska](https://avatars.githubusercontent.com/u/2369210?s=40&u=06b877f6aad5dee25c238cfb6115d42f279cb05c&v=4)](/elena-kolevska)

`[Revert "Revert "Revert "append app token to outgoing calls, if it is ‚Ä¶](/elena-kolevska/dapr/commit/4b6f699fc4c99564c287b36763f9b885521f4818 "Revert \"Revert \"Revert \"append app token to outgoing calls, if it is provided (#7404)\"\"\"

This reverts commit c9381b9112691f2e5a1df2f5a6f1a873cbdc63ff.")`
‚Ä¶

`[4b6f699](/elena-kolevska/dapr/commit/4b6f699fc4c99564c287b36763f9b885521f4818)`

```
‚Ä¶provided ([dapr#7404](https://github.com/dapr/dapr/pull/7404))"""

This reverts commit [c9381b9](https://github.com/elena-kolevska/dapr/commit/c9381b9112691f2e5a1df2f5a6f1a873cbdc63ff).
```

[elena-kolevska](/elena-kolevska)
pushed a commit
to elena-kolevska/dapr
that referenced
this pull request
[Jan 25, 2024](#ref-commit-84d50e4)
[![@vermillionsword](https://avatars.githubusercontent.com/u/5043416?s=40&v=4)](/vermillionsword) [![@elena-kolevska](https://avatars.githubusercontent.com/u/2369210?s=40&v=4)](/elena-kolevska)

`[append app token to outgoing calls, if it is provided (](/elena-kolevska/dapr/commit/84d50e4d10c0b98d46226e87c39053e15bdcda51 "append app token to outgoing calls, if it is provided (#7404)

* append app token to outgoing calls, if it is provided

Signed-off-by: Ryan Kelly <gatedlogic@live.com>

* use declare and assign syntax

Signed-off-by: Ryan Kelly <gatedlogic@live.com>

---------

Signed-off-by: Ryan Kelly <gatedlogic@live.com>
Co-authored-by: Ryan Kelly <gatedlogic@live.com>
Signed-off-by: Elena Kolevska <elena@kolevska.com>")[dapr#7404](https://github.com/dapr/dapr/pull/7404)[)](/elena-kolevska/dapr/commit/84d50e4d10c0b98d46226e87c39053e15bdcda51 "append app token to outgoing calls, if it is provided (#7404)

* append app token to outgoing calls, if it is provided

Signed-off-by: Ryan Kelly <gatedlogic@live.com>

* use declare and assign syntax

Signed-off-by: Ryan Kelly <gatedlogic@live.com>

---------

Signed-off-by: Ryan Kelly <gatedlogic@live.com>
Co-authored-by: Ryan Kelly <gatedlogic@live.com>
Signed-off-by: Elena Kolevska <elena@kolevska.com>")`
‚Ä¶

`[84d50e4](/elena-kolevska/dapr/commit/84d50e4d10c0b98d46226e87c39053e15bdcda51)`

```
* append app token to outgoing calls, if it is provided

Signed-off-by: Ryan Kelly <gatedlogic@live.com>

* use declare and assign syntax

Signed-off-by: Ryan Kelly <gatedlogic@live.com>

---------

Signed-off-by: Ryan Kelly <gatedlogic@live.com>
Co-authored-by: Ryan Kelly <gatedlogic@live.com>
Signed-off-by: Elena Kolevska <elena@kolevska.com>
```

[elena-kolevska](/elena-kolevska)
added a commit
to elena-kolevska/dapr
that referenced
this pull request
[Jan 25, 2024](#ref-commit-c9fb747)
[![@elena-kolevska](https://avatars.githubusercontent.com/u/2369210?s=40&u=06b877f6aad5dee25c238cfb6115d42f279cb05c&v=4)](/elena-kolevska)

`[Revert "append app token to outgoing calls, if it is provided (](/elena-kolevska/dapr/commit/c9fb747f4918ab08d8f4f9140da829fe92022644 "Revert \"append app token to outgoing calls, if it is provided (#7404)\"

This reverts commit b1215d58f3ed2215a75967d1d71d37cee6ce30e6.

Signed-off-by: Elena Kolevska <elena@kolevska.com>")[dapr#7404](https://github.com/dapr/dapr/pull/7404)`
‚Ä¶

`[c9fb747](/elena-kolevska/dapr/commit/c9fb747f4918ab08d8f4f9140da829fe92022644)`

```
)"

This reverts commit [b1215d5](https://github.com/elena-kolevska/dapr/commit/b1215d58f3ed2215a75967d1d71d37cee6ce30e6).

Signed-off-by: Elena Kolevska <elena@kolevska.com>
```

[elena-kolevska](/elena-kolevska)
added a commit
to elena-kolevska/dapr
that referenced
this pull request
[Jan 25, 2024](#ref-commit-3d5a9b1)
[![@elena-kolevska](https://avatars.githubusercontent.com/u/2369210?s=40&u=06b877f6aad5dee25c238cfb6115d42f279cb05c&v=4)](/elena-kolevska)

`[Revert "Revert "append app token to outgoing calls, if it is provided (](/elena-kolevska/dapr/commit/3d5a9b12e3713992c300ce91c311f2e7acb41594 "Revert \"Revert \"append app token to outgoing calls, if it is provided (#7404)\"\"

This reverts commit 12406b9137b4c8bfa63d8efee9cca3664ec68f02.

Signed-off-by: Elena Kolevska <elena@kolevska.com>")[‚Ä¶](https://github.com/dapr/dapr/pull/7404)`
‚Ä¶

`[3d5a9b1](/elena-kolevska/dapr/commit/3d5a9b12e3713992c300ce91c311f2e7acb41594)`

```
[‚Ä¶dapr#7404](https://github.com/dapr/dapr/pull/7404))""

This reverts commit [12406b9](https://github.com/elena-kolevska/dapr/commit/12406b9137b4c8bfa63d8efee9cca3664ec68f02).

Signed-off-by: Elena Kolevska <elena@kolevska.com>
```

[elena-kolevska](/elena-kolevska)
added a commit
to elena-kolevska/dapr
that referenced
this pull request
[Jan 25, 2024](#ref-commit-a393115)
[![@elena-kolevska](https://avatars.githubusercontent.com/u/2369210?s=40&u=06b877f6aad5dee25c238cfb6115d42f279cb05c&v=4)](/elena-kolevska)

`[Revert "Revert "Revert "append app token to outgoing calls, if it is ‚Ä¶](/elena-kolevska/dapr/commit/a3931156ebcff70a2a779773215025ad1f70035a "Revert \"Revert \"Revert \"append app token to outgoing calls, if it is provided (#7404)\"\"\"

This reverts commit c9381b9112691f2e5a1df2f5a6f1a873cbdc63ff.

Signed-off-by: Elena Kolevska <elena@kolevska.com>")`
‚Ä¶

`[a393115](/elena-kolevska/dapr/commit/a3931156ebcff70a2a779773215025ad1f70035a)`

```
‚Ä¶provided ([dapr#7404](https://github.com/dapr/dapr/pull/7404))"""

This reverts commit [c9381b9](https://github.com/elena-kolevska/dapr/commit/c9381b9112691f2e5a1df2f5a6f1a873cbdc63ff).

Signed-off-by: Elena Kolevska <elena@kolevska.com>
```

[elena-kolevska](/elena-kolevska)
pushed a commit
to elena-kolevska/dapr
that referenced
this pull request
[Jan 25, 2024](#ref-commit-50bea43)
[![@vermillionsword](https://avatars.githubusercontent.com/u/5043416?s=40&v=4)](/vermillionsword) [![@elena-kolevska](https://avatars.githubusercontent.com/u/2369210?s=40&v=4)](/elena-kolevska)

`[append app token to outgoing calls, if it is provided (](/elena-kolevska/dapr/commit/50bea43c84c22838b79a4a1fd2ff6dfb18aa1a97 "append app token to outgoing calls, if it is provided (#7404)

* append app token to outgoing calls, if it is provided

Signed-off-by: Ryan Kelly <gatedlogic@live.com>

* use declare and assign syntax

Signed-off-by: Ryan Kelly <gatedlogic@live.com>

---------

Signed-off-by: Ryan Kelly <gatedlogic@live.com>
Co-authored-by: Ryan Kelly <gatedlogic@live.com>")[dapr#7404](https://github.com/dapr/dapr/pull/7404)[)](/elena-kolevska/dapr/commit/50bea43c84c22838b79a4a1fd2ff6dfb18aa1a97 "append app token to outgoing calls, if it is provided (#7404)

* append app token to outgoing calls, if it is provided

Signed-off-by: Ryan Kelly <gatedlogic@live.com>

* use declare and assign syntax

Signed-off-by: Ryan Kelly <gatedlogic@live.com>

---------

Signed-off-by: Ryan Kelly <gatedlogic@live.com>
Co-authored-by: Ryan Kelly <gatedlogic@live.com>")`
‚Ä¶

`[50bea43](/elena-kolevska/dapr/commit/50bea43c84c22838b79a4a1fd2ff6dfb18aa1a97)`

```
* append app token to outgoing calls, if it is provided

Signed-off-by: Ryan Kelly <gatedlogic@live.com>

* use declare and assign syntax

Signed-off-by: Ryan Kelly <gatedlogic@live.com>

---------

Signed-off-by: Ryan Kelly <gatedlogic@live.com>
Co-authored-by: Ryan Kelly <gatedlogic@live.com>
```

[![@JoshVanL](https://avatars.githubusercontent.com/u/15893072?s=40&v=4)](/JoshVanL)
[JoshVanL](/JoshVanL)
mentioned this pull request
[Feb 3, 2024](#ref-issue-2064148534)

[dapr-api-token passed back to the application 'as-is' when proxying
#7344](/dapr/dapr/issues/7344)

Closed

[![@chrislewis555](https://avatars.githubusercontent.com/u/135693663?s=40&v=4)](/chrislewis555)
[chrislewis555](/chrislewis555)
mentioned this pull request
[May 2, 2024](#ref-issue-2234651519)

[Feature Request: Enable API token authentication in Dapr
microsoft/azure-container-apps#1143](/microsoft/azure-container-apps/issues/1143)

Open

[![@GoVulnBot](https://avatars.githubusercontent.com/u/96493708?s=40&v=4)](/GoVulnBot)
[GoVulnBot](/GoVulnBot)
mentioned this pull request
[May 23, 2024](#ref-issue-2312488007)

[x/vulndb: potential Go vuln in github.com/dapr/dapr: CVE-2024-35223
golang/vulndb#2879](/golang/vulndb/issues/2879)

Closed

[cicoyle](/cicoyle)
pushed a commit
to cicoyle/dapr
that referenced
this pull request
[May 24, 2024](#ref-commit-4eb0b8f)
[![@vermillionsword](https://avatars.githubusercontent.com/u/5043416?s=40&v=4)](/vermillionsword) [![@cicoyle](https://avatars.githubusercontent.com/u/25733780?s=40&v=4)](/cicoyle)

`[append app token to outgoing calls, if it is provided (](/cicoyle/dapr/commit/4eb0b8f31eb062fcb55227dba1e7e5719b2a692b "append app token to outgoing calls, if it is provided (#7404)

* append app token to outgoing calls, if it is provided

Signed-off-by: Ryan Kelly <gatedlogic@live.com>

* use declare and assign syntax

Signed-off-by: Ryan Kelly <gatedlogic@live.com>

---------

Signed-off-by: Ryan Kelly <gatedlogic@live.com>
Co-authored-by: Ryan Kelly <gatedlogic@live.com>
Signed-off-by: Cassandra Coyle <cassie@diagrid.io>")[dapr#7404](https://github.com/dapr/dapr/pull/7404)[)](/cicoyle/dapr/commit/4eb0b8f31eb062fcb55227dba1e7e5719b2a692b "append app token to outgoing calls, if it is provided (#7404)

* append app token to outgoing calls, if it is provided

Signed-off-by: Ryan Kelly <gatedlogic@live.com>

* use declare and assign syntax

Signed-off-by: Ryan Kelly <gatedlogic@live.com>

---------

Signed-off-by: Ryan Kelly <gatedlogic@live.com>
Co-authored-by: Ryan Kelly <gatedlogic@live.com>
Signed-off-by: Cassandra Coyle <cassie@diagrid.io>")`
‚Ä¶

`[4eb0b8f](/cicoyle/dapr/commit/4eb0b8f31eb062fcb55227dba1e7e5719b2a692b)`

```
* append app token to outgoing calls, if it is provided

Signed-off-by: Ryan Kelly <gatedlogic@live.com>

* use declare and assign syntax

Signed-off-by: Ryan Kelly <gatedlogic@live.com>

---------

Signed-off-by: Ryan Kelly <gatedlogic@live.com>
Co-authored-by: Ryan Kelly <gatedlogic@live.com>
Signed-off-by: Cassandra Coyle <cassie@diagrid.io>
```

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fdapr%2Fdapr%2Fpull%2F7404)

Reviewers

[![@daixiang0](https://avatars.githubusercontent.com/u/26538619?s=40&v=4)](/daixiang0) [daixiang0](/daixiang0)

daixiang0 approved these changes

[![@ItalyPaleAle](https://avatars.githubusercontent.com/u/43508?s=40&v=4)](/ItalyPaleAle) [ItalyPaleAle](/ItalyPaleAle)

ItalyPaleAle approved these changes

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

 [**v1.13**](/dapr/dapr/milestone/20 "v1.13")

Development

Successfully merging this pull request may close these issues.

4 participants

[![@vermillionsword](https://avatars.githubusercontent.com/u/5043416?s=52&v=4)](/vermillionsword) [![@yaron2](https://avatars.githubusercontent.com/u/16295283?s=52&v=4)](/yaron2) [![@daixiang0](https://avatars.githubusercontent.com/u/26538619?s=52&v=4)](/daixiang0) [![@ItalyPaleAle](https://avatars.githubusercontent.com/u/43508?s=52&v=4)](/ItalyPaleAle)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.



=== Content from github.com_aa3ab3a6_20250110_180052.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fdapr%2Fdapr%2Fcommit%2Fe0591e43d0cdfd30a2f2960dce5d9892dc98bc2c)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fdapr%2Fdapr%2Fcommit%2Fe0591e43d0cdfd30a2f2960dce5d9892dc98bc2c)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=dapr%2Fdapr)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[dapr](/dapr)
/
**[dapr](/dapr/dapr)**
Public

* [Notifications](/login?return_to=%2Fdapr%2Fdapr) You must be signed in to change notification settings
* [Fork
  1.9k](/login?return_to=%2Fdapr%2Fdapr)
* [Star
   24.3k](/login?return_to=%2Fdapr%2Fdapr)

* [Code](/dapr/dapr)
* [Issues
  380](/dapr/dapr/issues)
* [Pull requests
  42](/dapr/dapr/pulls)
* [Actions](/dapr/dapr/actions)
* [Security](/dapr/dapr/security)
* [Insights](/dapr/dapr/pulse)

Additional navigation options

* [Code](/dapr/dapr)
* [Issues](/dapr/dapr/issues)
* [Pull requests](/dapr/dapr/pulls)
* [Actions](/dapr/dapr/actions)
* [Security](/dapr/dapr/security)
* [Insights](/dapr/dapr/pulse)

## Commit

[Permalink](/dapr/dapr/commit/e0591e43d0cdfd30a2f2960dce5d9892dc98bc2c)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Merge pull request from [GHSA-284c-x8m7-9w5h](https://github.com/advisories/GHSA-284c-x8m7-9w5h "GHSA-284c-x8m7-9w5h")

[Browse files](/dapr/dapr/tree/e0591e43d0cdfd30a2f2960dce5d9892dc98bc2c)
Browse the repository at this point in the history

```
* api token fix

Signed-off-by: Elena Kolevska <elena@kolevska.com>

* Add released notes for 1.13.3

Signed-off-by: Artur Souza <asouza.pro@gmail.com>

---------

Signed-off-by: Elena Kolevska <elena@kolevska.com>
Signed-off-by: Artur Souza <asouza.pro@gmail.com>
Co-authored-by: Elena Kolevska <elena@kolevska.com>
```

* Loading branch information

[![@artursouza](https://avatars.githubusercontent.com/u/130954?s=40&v=4)](/artursouza) [![@elena-kolevska](https://avatars.githubusercontent.com/u/2369210?s=40&v=4)](/elena-kolevska)

[artursouza](/dapr/dapr/commits?author=artursouza "View all commits by artursouza")
and
[elena-kolevska](/dapr/dapr/commits?author=elena-kolevska "View all commits by elena-kolevska")
authored
May 20, 2024

1 parent
[3cc0fc0](/dapr/dapr/commit/3cc0fc07c34f2abe132ead0bbc8515962dcd8f51)

commit e0591e4

 Show file tree

 Hide file tree

Showing
**17 changed files**
with
**1,114 additions**
and
**7 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* docs/release\_notes

  + docs/release\_notes/v1.13.3.md
    [v1.13.3.md](#diff-8c3fb6532db8f7517425a58828b6e07cc02cc9b837a28318dfa4d69f63f83608)
* pkg/messaging

  + pkg/messaging/grpc\_proxy.go
    [grpc\_proxy.go](#diff-7b789bd4dec23bd7c5647d606ba7a2658c59a44eff77755398868c24927fd277)
  + pkg/messaging/grpc\_proxy\_test.go
    [grpc\_proxy\_test.go](#diff-538c2b1f9050385b03b2a8b8c44f55c732766976b49a0628764bcc289c341b4c)
* tests/integration

  + framework/process/daprd

    - tests/integration/framework/process/daprd/options.go
      [options.go](#diff-3e31ae83284f1a74ccccccf2f22991afe86674a5b227464f1283cf5b815bf2c8)
  + suite/daprd/serviceinvocation

    - grpc

      * appapitoken

        + tests/integration/suite/daprd/serviceinvocation/grpc/appapitoken/remotebothtokens.go
          [remotebothtokens.go](#diff-d94954acbf69ca3b1743bbb44ad3c5d9e6a91717b0b14a80d9fb2a7d6e15d9ff)
        + tests/integration/suite/daprd/serviceinvocation/grpc/appapitoken/remotereceiverhastoken.go
          [remotereceiverhastoken.go](#diff-182be62a3cf77e843b03be664a1b163053c9d30947f14aaaa088d617b0de0659)
        + tests/integration/suite/daprd/serviceinvocation/grpc/appapitoken/remotereceivernotoken.go
          [remotereceivernotoken.go](#diff-b5a5a8d5b979fbf745f8c48a5c5639c9b3d37f3cac863084233f0ab1c1eb756f)
        + tests/integration/suite/daprd/serviceinvocation/grpc/appapitoken/selfnotoken.go
          [selfnotoken.go](#diff-c9e302a18853cbd01e16e0b227e6b7cb7d0f091576b46542049bbb243f12bd8e)
        + tests/integration/suite/daprd/serviceinvocation/grpc/appapitoken/selfwithtoken.go
          [selfwithtoken.go](#diff-a19a53275c8f6396b8f4b78740ac8a6f82843fde34f61413a154e184ededbd01)
        + tests/integration/suite/daprd/serviceinvocation/grpc/appapitoken/server.go
          [server.go](#diff-68960705c38ff21edb9655731aa47190d2b679e586a0dbbfc98501756ef424c3)
      * tests/integration/suite/daprd/serviceinvocation/grpc/grpc.go
        [grpc.go](#diff-6a978ba56800c6dc329f69cddbd9899de9e8c6e37a477aabec2665e70747b59d)
    - http

      * appapitoken

        + tests/integration/suite/daprd/serviceinvocation/http/appapitoken/remotebothtokens.go
          [remotebothtokens.go](#diff-a7a6fab3745888e2e6d00e079b69c672830b411c884d218ced2bfdc0b4ec35a8)
        + tests/integration/suite/daprd/serviceinvocation/http/appapitoken/remotereceiverhastoken.go
          [remotereceiverhastoken.go](#diff-d19dfd271662b4144d7eafad5a86d06ce17dbf417a9d748b15b15aa2f34a6002)
        + tests/integration/suite/daprd/serviceinvocation/http/appapitoken/remotereceivernotoken.go
          [remotereceivernotoken.go](#diff-2a30cc82051db820ae618febdafd128ad8675a8c03d854d691171592bc353cd2)
        + tests/integration/suite/daprd/serviceinvocation/http/appapitoken/selfnotoken.go
          [selfnotoken.go](#diff-127da3fea20e1351de9dfc6d584526e6fca83c56f26ffa74d3c0c831e33a5c9b)
        + tests/integration/suite/daprd/serviceinvocation/http/appapitoken/selfwithtoken.go
          [selfwithtoken.go](#diff-21cd226cd9d50c362f19a5181b42b4776b98eca70f9eed9fe6b0a57ea013f636)
      * tests/integration/suite/daprd/serviceinvocation/http/http.go
        [http.go](#diff-9ef0e8797b240742bad25ad156b32ac6e76dd5dd6432827d2fd2d5f7367776be)

## There are no files selected for viewing

80 changes: 80 additions & 0 deletions

80
[docs/release\_notes/v1.13.3.md](#diff-8c3fb6532db8f7517425a58828b6e07cc02cc9b837a28318dfa4d69f63f83608 "docs/release_notes/v1.13.3.md")

Show comments

[View file](/dapr/dapr/blob/e0591e43d0cdfd30a2f2960dce5d9892dc98bc2c/docs/release_notes/v1.13.3.md)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |

|  |  | @@ -0,0 +1,80 @@ |
|  |  | # Dapr 1.13.3 |
|  |  |  |
|  |  | This update includes bug fixes: |
|  |  |  |
|  |  | - [App API token forwarded from caller to receiving app](#app-api-token-forwarded-from-caller-to-receiving-app) |
|  |  | - [Upgrade Go version to 1.21.9](#upgrade-go-version-to-1219) |
|  |  | - [Placement server fails to disseminate placement tables](#placement-server-fails-to-disseminate-placement-tables) |
|  |  | - [Restore dapr\_http\_server\_response\_count HTTP metric](#restore-dapr\_http\_server\_response\_count-http-metric) |
|  |  |  |
|  |  | ## App API token forwarded from caller to receiving app |
|  |  |  |
|  |  | ### Problem |
|  |  |  |
|  |  | The caller sidecar is appending the \*local\* app API token to the \*egress\* request, thereby leaking the API token protecting the local app to the foreign sidecar. |
|  |  |  |
|  |  | ### Impact |
|  |  |  |
|  |  | Receiving app can have access to the calling app's API token and make unauthorized calls directly to the originating app - in case it is listening on 0.0.0.0 or an accessible IP address. |
|  |  |  |
|  |  | ### Root cause |
|  |  |  |
|  |  | A pull request accidentally added this change. |
|  |  |  |
|  |  | ### Solution |
|  |  |  |
|  |  | Fixed the issue and added integration tests to verify and avoid future regressions. |
|  |  |  |
|  |  | ## Upgrade Go version to 1.21.9 |
|  |  |  |
|  |  | ### Problem |
|  |  |  |
|  |  | Go version 1.21.8 or older are impacted by CVE-2023-45288. |
|  |  |  |
|  |  | ### Impact |
|  |  |  |
|  |  | See https://nvd.nist.gov/vuln/detail/CVE-2023-45288 |
|  |  |  |
|  |  | ### Root cause |
|  |  |  |
|  |  | See https://nvd.nist.gov/vuln/detail/CVE-2023-45288 |
|  |  |  |
|  |  | ### Solution |
|  |  |  |
|  |  | Update Go version used to build Dapr. |
|  |  |  |
|  |  | ## Placement server fails to disseminate placement tables |
|  |  |  |
|  |  | ### Problem |
|  |  |  |
|  |  | In case of an error during dissemination of placement table to a sidecar instance, the dissemination to the remaining instances do not complete. See https://github.com/dapr/dapr/issues/7031 |
|  |  |  |
|  |  | ### Impact |
|  |  |  |
|  |  | Sidecars can run with an old copy of the dissemination table and cannot invoke the correct Dapr sidecar for a given actor instance. |
|  |  |  |
|  |  | ### Root cause |
|  |  |  |
|  |  | During shutdown, all publish calls to the application where being cancelled. |
|  |  |  |
|  |  | ### Solution |
|  |  |  |
|  |  | Check the return value of performTableDissemination for errors. |
|  |  |  |
|  |  | ## Restore `dapr\_http\_server\_response\_count` HTTP metric |
|  |  |  |
|  |  | ### Problem |
|  |  |  |
|  |  | An existing metrics was removed without deprecation notice, affecting users that relied on it. See https://github.com/dapr/dapr/issues/7642 |
|  |  |  |
|  |  | ### Impact |
|  |  |  |
|  |  | Users did not have this specific metric available anymore, potentially impacting their alerts and monitoring. |
|  |  |  |
|  |  | ### Root cause |
|  |  |  |
|  |  | Metric removed without deprecation notice. |
|  |  |  |
|  |  | ### Solution |
|  |  |  |
|  |  | Added the metric back. |

11 changes: 6 additions & 5 deletions

11
[pkg/messaging/grpc\_proxy.go](#diff-7b789bd4dec23bd7c5647d606ba7a2658c59a44eff77755398868c24927fd277 "pkg/messaging/grpc_proxy.go")

Show comments

[View file](/dapr/dapr/blob/e0591e43d0cdfd30a2f2960dce5d9892dc98bc2c/pkg/messaging/grpc_proxy.go)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -129,6 +129,12 @@ func (p \*proxy) intercept(ctx context.Context, fullName string) (context.Context |
|  |  | if err != nil { |
|  |  | return ctx, nil, nil, nopTeardown, err |
|  |  | } |
|  |  |  |
|  |  | appMetadataToken := security.GetAppToken() |
|  |  | if appMetadataToken != "" { |
|  |  | outCtx = metadata.AppendToOutgoingContext(outCtx, securityConsts.APITokenHeader, appMetadataToken) |
|  |  | } |
|  |  |  |
|  |  | return outCtx, appClient.(\*grpc.ClientConn), nil, nopTeardown, nil |
|  |  | } |
|  |  |  |
| Expand All | | @@ -139,11 +145,6 @@ func (p \*proxy) intercept(ctx context.Context, fullName string) (context.Context |
|  |  | outCtx = p.telemetryFn(outCtx) |
|  |  | outCtx = metadata.AppendToOutgoingContext(outCtx, invokev1.CallerIDHeader, p.appID, invokev1.CalleeIDHeader, target.id) |
|  |  |  |
|  |  | appMetadataToken := security.GetAppToken() |
|  |  | if appMetadataToken != "" { |
|  |  | outCtx = metadata.AppendToOutgoingContext(outCtx, securityConsts.APITokenHeader, appMetadataToken) |
|  |  | } |
|  |  |  |
|  |  | pt := &grpcProxy.ProxyTarget{ |
|  |  | ID: target.id, |
|  |  | Namespace: target.namespace, |
| Expand Down | |  |

9 changes: 7 additions & 2 deletions

9
[pkg/messaging/grpc\_proxy\_test.go](#diff-538c2b1f9050385b03b2a8b8c44f55c732766976b49a0628764bcc289c341b4c "pkg/messaging/grpc_proxy_test.go")

Show comments

[View file](/dapr/dapr/blob/e0591e43d0cdfd30a2f2960dce5d9892dc98bc2c/pkg/messaging/grpc_proxy_test.go)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -188,14 +188,19 @@ func TestIntercept(t \*testing.T) { |
|  |  | }, nil |
|  |  | }) |
|  |  |  |
|  |  | t.Setenv(securityConsts.AppAPITokenEnvVar, "token1") |
|  |  |  |
|  |  | ctx := metadata.NewIncomingContext(context.TODO(), metadata.MD{diagnostics.GRPCProxyAppIDKey: []string{"a"}}) |
|  |  | proxy := p.(\*proxy) |
|  |  | \_, conn, \_, teardown, err := proxy.intercept(ctx, "/test") |
|  |  | ctx, conn, \_, teardown, err := proxy.intercept(ctx, "/test") |
|  |  | defer teardown(true) |
|  |  |  |
|  |  | require.NoError(t, err) |
|  |  | assert.NotNil(t, conn) |
|  |  | assert.Equal(t, "a", conn.Target()) |
|  |  |  |
|  |  | md, \_ := metadata.FromOutgoingContext(ctx) |
|  |  | assert.Equal(t, "token1", md[securityConsts.APITokenHeader][0]) |
|  |  | }) |
|  |  |  |
|  |  | t.Run("proxy to a remote app", func(t \*testing.T) { |
| Expand Down  Expand Up | | @@ -231,7 +236,7 @@ func TestIntercept(t \*testing.T) { |
|  |  | assert.Equal(t, "b", md["a"][0]) |
|  |  | assert.Equal(t, "a", md[invokev1.CallerIDHeader][0]) |
|  |  | assert.Equal(t, "b", md[invokev1.CalleeIDHeader][0]) |
|  |  | assert.Equal(t, "token1", md[securityConsts.APITokenHeader][0]) |
|  |  | assert.NotContains(t, md, securityConsts.APITokenHeader) |
|  |  | }) |
|  |  |  |
|  |  | t.Run("access policies applied", func(t \*testing.T) { |
| Expand Down | |  |

6 changes: 6 additions & 0 deletions

6
[tests/integration/framework/process/daprd/options.go](#diff-3e31ae83284f1a74ccccccf2f22991afe86674a5b227464f1283cf5b815bf2c8 "tests/integration/framework/process/daprd/options.go")

Show comments

[View file](/dapr/dapr/blob/e0591e43d0cdfd30a2f2960dce5d9892dc98bc2c/tests/integration/framework/process/daprd/options.go)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -287,3 +287,9 @@ func WithSocket(t \*testing.T, socket \*socket.Socket) Option { |
|  |  | "DAPR\_COMPONENTS\_SOCKETS\_FOLDER", socket.Directory(), |
|  |  | )) |
|  |  | } |
|  |  |  |
|  |  | func WithAppAPIToken(t \*testing.T, token string) Option { |
|  |  | return WithExecOptions(exec.WithEnvVars(t, |
|  |  | "APP\_API\_TOKEN", token, |
|  |  | )) |
|  |  | } |

108 changes: 108 additions & 0 deletions

108
[tests/integration/suite/daprd/serviceinvocation/grpc/appapitoken/remotebothtokens.go](#diff-d94954acbf69ca3b1743bbb44ad3c5d9e6a91717b0b14a80d9fb2a7d6e15d9ff "tests/integration/suite/daprd/serviceinvocation/grpc/appapitoken/remotebothtokens.go")

Show comments

[View file](/dapr/dapr/blob/e0591e43d0cdfd30a2f2960dce5d9892dc98bc2c/tests/integration/suite/daprd/serviceinvocation/grpc/appapitoken/remotebothtokens.go)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -0,0 +1,108 @@ |
|  |  | /\* |
|  |  | Copyright 2024 The Dapr Authors |
|  |  | Licensed under the Apache License, Version 2.0 (the "License"); |
|  |  | you may not use this file except in compliance with the License. |
|  |  | You may obtain a copy of the License at |
|  |  | http://www.apache.org/licenses/LICENSE-2.0 |
|  |  | Unless required by applicable law or agreed to in writing, software |
|  |  | distributed under the License is distributed on an "AS IS" BASIS, |
|  |  | WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implieh. |
|  |  | See the License for the specific language governing permissions and |
|  |  | limitations under the License. |
|  |  | \*/ |
|  |  |  |
|  |  | package appapitoken |
|  |  |  |
|  |  | import ( |
|  |  | "context" |
|  |  | "testing" |
|  |  | "time" |
|  |  |  |
|  |  | "github.com/stretchr/testify/assert" |
|  |  | "github.com/stretchr/testify/require" |
|  |  | "google.golang.org/grpc/metadata" |
|  |  | "google.golang.org/protobuf/types/known/anypb" |
|  |  |  |
|  |  | commonv1 "github.com/dapr/dapr/pkg/proto/common/v1" |
|  |  | runtimev1 "github.com/dapr/dapr/pkg/proto/runtime/v1" |
|  |  | "github.com/dapr/dapr/tests/integration/framework" |
|  |  | "github.com/dapr/dapr/tests/integration/framework/process/daprd" |
|  |  | "github.com/dapr/dapr/tests/integration/framework/process/grpc/app" |
|  |  | "github.com/dapr/dapr/tests/integration/suite" |
|  |  | testpb "github.com/dapr/dapr/tests/integration/suite/daprd/serviceinvocation/grpc/proto" |
|  |  | ) |
|  |  |  |
|  |  | func init() { |
|  |  | suite.Register(new(remotebothtokens)) |
|  |  | } |
|  |  |  |
|  |  | type remotebothtokens struct { |
|  |  | daprd1 \*daprd.Daprd |
|  |  | daprd2 \*daprd.Daprd |
|  |  | ch chan metadata.MD |
|  |  | } |
|  |  |  |
|  |  | func (b \*remotebothtokens) Setup(t \*testing.T) []framework.Option { |
|  |  | fn, ch := newServer() |
|  |  | b.ch = ch |
|  |  | app := app.New(t, |
|  |  | app.WithRegister(fn), |
|  |  | app.WithOnInvokeFn(func(ctx context.Context, \_ \*commonv1.InvokeRequest) (\*commonv1.InvokeResponse, error) { |
|  |  | md, ok := metadata.FromIncomingContext(ctx) |
|  |  | require.True(t, ok) |
|  |  | b.ch <- md |
|  |  | return new(commonv1.InvokeResponse), nil |
|  |  | }), |
|  |  | ) |
|  |  |  |
|  |  | b.daprd1 = daprd.New(t, |
|  |  | daprd.WithAppID("app1"), |
|  |  | daprd.WithAppProtocol("grpc"), |
|  |  | daprd.WithAppAPIToken(t, "abc"), |
|  |  | ) |
|  |  |  |
|  |  | b.daprd2 = daprd.New(t, |
|  |  | daprd.WithAppProtocol("grpc"), |
|  |  | daprd.WithAppAPIToken(t, "def"), |
|  |  | daprd.WithAppPort(app.Port(t)), |
|  |  | ) |
|  |  |  |
|  |  | return []framework.Option{ |
|  |  | framework.WithProcesses(app, b.daprd1, b.daprd2), |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | func (b \*remotebothtokens) Run(t \*testing.T, ctx context.Context) { |
|  |  | b.daprd1.WaitUntilRunning(t, ctx) |
|  |  | b.daprd2.WaitUntilRunning(t, ctx) |
|  |  |  |
|  |  | client := testpb.NewTestServiceClient(b.daprd1.GRPCConn(t, ctx)) |
|  |  | ctx = metadata.AppendToOutgoingContext(ctx, "dapr-app-id", b.daprd2.AppID()) |
|  |  | \_, err := client.Ping(ctx, new(testpb.PingRequest)) |
|  |  | require.NoError(t, err) |
|  |  |  |
|  |  | select { |
|  |  | case md := <-b.ch: |
|  |  | require.Equal(t, []string{"def"}, md.Get("dapr-api-token")) |
|  |  | case <-time.After(10 \* time.Second): |
|  |  | assert.Fail(t, "timed out waiting for metadata") |
|  |  | } |
|  |  |  |
|  |  | dclient := b.daprd1.GRPCClient(t, ctx) |
|  |  | \_, err = dclient.InvokeService(ctx, &runtimev1.InvokeServiceRequest{ |
|  |  | Id: b.daprd2.AppID(), |
|  |  | Message: &commonv1.InvokeRequest{ |
|  |  | Method: "helloworld", |
|  |  | Data: new(anypb.Any), |
|  |  | HttpExtension: &commonv1.HTTPExtension{Verb: commonv1.HTTPExtension\_GET}, |
|  |  | }, |
|  |  | }) |
|  |  | require.NoError(t, err) |
|  |  |  |
|  |  | select { |
|  |  | case md := <-b.ch: |
|  |  | require.Equal(t, []string{"def"}, md.Get("dapr-api-token")) |
|  |  | case <-time.After(5 \* time.Second): |
|  |  | assert.Fail(t, "timed out waiting for metadata") |
|  |  | } |
|  |  | } |

103 changes: 103 additions & 0 deletions

103
[tests/integration/suite/daprd/serviceinvocation/grpc/appapitoken/remotereceiverhastoken.go](#diff-182be62a3cf77e843b03be664a1b163053c9d30947f14aaaa088d617b0de0659 "tests/integration/suite/daprd/serviceinvocation/grpc/appapitoken/remotereceiverhastoken.go")

Show comments

[View file](/dapr/dapr/blob/e0591e43d0cdfd30a2f2960dce5d9892dc98bc2c/tests/integration/suite/daprd/serviceinvocation/grpc/appapitoken/remotereceiverhastoken.go)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -0,0 +1,103 @@ |
|  |  | /\* |
|  |  | Copyright 2024 The Dapr Authors |
|  |  | Licensed under the Apache License, Version 2.0 (the "License"); |
|  |  | you may not use this file except in compliance with the License. |
|  |  | You may obtain a copy of the License at |
|  |  | http://www.apache.org/licenses/LICENSE-2.0 |
|  |  | Unless required by applicable law or agreed to in writing, software |
|  |  | distributed under the License is distributed on an "AS IS" BASIS, |
|  |  | WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implieh. |
|  |  | See the License for the specific language governing permissions and |
|  |  | limitations under the License. |
|  |  | \*/ |
|  |  |  |
|  |  | package appapitoken |
|  |  |  |
|  |  | import ( |
|  |  | "context" |
|  |  | "testing" |
|  |  | "time" |
|  |  |  |
|  |  | "github.com/stretchr/testify/assert" |
|  |  | "github.com/stretchr/testify/require" |
|  |  | "google.golang.org/grpc/metadata" |
|  |  | "google.golang.org/protobuf/types/known/anypb" |
|  |  |  |
|  |  | commonv1 "github.com/dapr/dapr/pkg/proto/common/v1" |
|  |  | runtimev1 "github.com/dapr/dapr/pkg/proto/runtime/v1" |
|  |  | "github.com/dapr/dapr/tests/integration/framework" |
|  |  | "github.com/dapr/dapr/tests/integration/framework/process/daprd" |
|  |  | "github.com/dapr/dapr/tests/integration/framework/process/grpc/app" |
|  |  | "github.com/dapr/dapr/tests/integration/suite" |
|  |  | testpb "github.com/dapr/dapr/tests/integration/suite/daprd/serviceinvocation/grpc/proto" |
|  |  | ) |
|  |  |  |
|  |  | func init() { |
|  |  | suite.Register(new(remotereceiverhastoken)) |
|  |  | } |
|  |  |  |
|  |  | type remotereceiverhastoken struct { |
|  |  | daprd1 \*daprd.Daprd |
|  |  | daprd2 \*daprd.Daprd |
|  |  | ch chan metadata.MD |
|  |  | } |
|  |  |  |
|  |  | func (r \*remotereceiverhastoken) Setup(t \*testing.T) []framework.Option { |
|  |  | fn, ch := newServer() |
|  |  | r.ch = ch |
|  |  | app := app.New(t, |
|  |  | app.WithRegister(fn), |
|  |  | app.WithOnInvokeFn(func(ctx context.Context, \_ \*commonv1.InvokeRequest) (\*commonv1.InvokeResponse, error) { |
|  |  | md, ok := metadata.FromIncomingContext(ctx) |
|  |  | require.True(t, ok) |
|  |  | r.ch <- md |
|  |  | return new(commonv1.InvokeResponse), nil |
|  |  | }), |
|  |  | ) |
|  |  |  |
|  |  | r.daprd1 = daprd.New(t) |
|  |  | r.daprd2 = daprd.New(t, |
|  |  | daprd.WithAppProtocol("grpc"), |
|  |  | daprd.WithAppAPIToken(t, "abc"), |
|  |  | daprd.WithAppPort(app.Port(t)), |
|  |  | ) |
|  |  |  |
|  |  | return []framework.Option{ |
|  |  | framework.WithProcesses(app, r.daprd1, r.daprd2), |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | func (r \*remotereceiverhastoken) Run(t \*testing.T, ctx context.Context) { |
|  |  | r.daprd1.WaitUntilRunning(t, ctx) |
|  |  | r.daprd2.WaitUntilRunning(t, ctx) |
|  |  |  |
|  |  | client := testpb.NewTestServiceClient(r.daprd1.GRPCConn(t, ctx)) |
|  |  | ctx = metadata.AppendToOutgoingContext(ctx, "dapr-app-id", r.daprd2.AppID()) |
|  |  | \_, err := client.Ping(ctx, new(testpb.PingRequest)) |
|  |  | require.NoError(t, err) |
|  |  |  |
|  |  | select { |
|  |  | case md := <-r.ch: |
|  |  | require.Equal(t, []string{"abc"}, md.Get("dapr-api-token")) |
|  |  | case <-time.After(5 \* time.Second): |
|  |  | assert.Fail(t, "timed out waiting for metadata") |
|  |  | } |
|  |  |  |
|  |  | dclient := r.daprd1.GRPCClient(t, ctx) |
|  |  | \_, err = dclient.InvokeService(ctx, &runtimev1.InvokeServiceRequest{ |
|  |  | Id: r.daprd2.AppID(), |
|  |  | Message: &commonv1.InvokeRequest{ |
|  |  | Method: "helloworld", |
|  |  | Data: new(anypb.Any), |
|  |  | HttpExtension: &commonv1.HTTPExtension{Verb: commonv1.HTTPExtension\_GET}, |
|  |  | }, |
|  |  | }) |
|  |  | require.NoError(t, err) |
|  |  |  |
|  |  | select { |
|  |  | case md := <-r.ch: |
|  |  | require.Equal(t, []string{"abc"}, md.Get("dapr-api-token")) |
|  |  | case <-time.After(5 \* time.Second): |
|  |  | assert.Fail(t, "timed out waiting for metadata") |
|  |  | } |
|  |  | } |

 Loading

Oops, something went wrong.
 Retry

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `e0591e4`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fdapr%2Fdapr%2Fcommit%2Fe0591e43d0cdfd30a2f2960dce5d9892dc98bc2c) to comment.

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.



=== Content from github.com_a56a6b80_20250110_180056.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fdapr%2Fdapr%2Fsecurity%2Fadvisories%2FGHSA-284c-x8m7-9w5h)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fdapr%2Fdapr%2Fsecurity%2Fadvisories%2FGHSA-284c-x8m7-9w5h)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=dapr%2Fdapr)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[dapr](/dapr)
/
**[dapr](/dapr/dapr)**
Public

* [Notifications](/login?return_to=%2Fdapr%2Fdapr) You must be signed in to change notification settings
* [Fork
  1.9k](/login?return_to=%2Fdapr%2Fdapr)
* [Star
   24.3k](/login?return_to=%2Fdapr%2Fdapr)

* [Code](/dapr/dapr)
* [Issues
  380](/dapr/dapr/issues)
* [Pull requests
  42](/dapr/dapr/pulls)
* [Actions](/dapr/dapr/actions)
* [Security](/dapr/dapr/security)
* [Insights](/dapr/dapr/pulse)

Additional navigation options

* [Code](/dapr/dapr)
* [Issues](/dapr/dapr/issues)
* [Pull requests](/dapr/dapr/pulls)
* [Actions](/dapr/dapr/actions)
* [Security](/dapr/dapr/security)
* [Insights](/dapr/dapr/pulse)

# Dapr API token CVE

Moderate

[artursouza](/artursouza)
published
GHSA-284c-x8m7-9w5h
May 22, 2024

## Package

No package listed

## Affected versions

1.13.0;1.13.1;1.13.2

## Patched versions

1.13.3

## Description

### **Summary**

A vulnerability has been found in Dapr that causes a leak of the application token of the invoker app to the invoked app when using Dapr as a gRPC proxy for remote service invocation. This issue arises because Dapr sends the app token of the invoker app instead of the app token of the invoked app.

Users who leverage Dapr for gRPC proxy service invocation and are using the app API token feature are encouraged to upgrade Dapr to version [1.13.3](https://github.com/dapr/dapr/releases/tag/v1.13.3).

### Impact

This vulnerability impacts Dapr users who use Dapr as a gRPC proxy for remote service invocation as well as the [Dapr App API token](https://docs.dapr.io/operations/security/app-api-token/) functionality. An attacker could exploit this vulnerability to gain access to the app token of the invoker app, potentially compromising security and authentication mechanisms.

### Patches

The issue has been fixed in Dapr version [1.13.3](https://github.com/dapr/dapr/releases/tag/v1.13.3).

### Details

Dapr uses two types of tokens for authentication:

* `APP_API_TOKEN`: Used by Dapr to authenticate to the app.
* `DAPR_API_TOKEN`: Used by the app to authenticate to Dapr.

Dapr uses the `dapr-api-token` metadata in gRPC calls (or header, for HTTP calls) for authentication.

* In communication from dapr to the app, the `dapr-api-token` metadata field will carry the `APP_API_TOKEN`.
* In communication from the app to daprd, the `dapr-api-token` metadata field will carry the `DAPR_API_TOKEN`.

Before version 1.13.0, the `APP_API_TOKEN` was not being sent to the invoked app for authentication, as reported in [this issue](https://github.com/dapr/dapr/issues/7344). Instead, Dapr was incorrectly using the same `DAPR_API_TOKEN` that the invoker app had passed to Dapr. This was addressed in [PR #7404](https://github.com/dapr/dapr/pull/7404), but the fix only worked for self-invocation scenarios.

When Dapr needed to communicate with another instance, it would mistakenly include the `APP_API_TOKEN` of the invoker app in the request. This behavior is incorrect, app tokens should never be included in requests between Dapr sidecars. This vulnerability allows the receiving app to see the app token of the invoker app, leading to potential misuse and security breaches.

The vulnerability is addressed by ensuring that Dapr uses the correct app token (of the invoked app) during gRPC proxy service invocation.

### References

* <https://docs.dapr.io/operations/security/app-api-token/>
* [#7344](https://github.com/dapr/dapr/issues/7344)
* [#7404](https://github.com/dapr/dapr/pull/7404)

### Credits

Thanks to Benjamin Delay for reporting this issue.

### Severity

Moderate

### CVE ID

CVE-2024-35223

### Weaknesses

[CWE-200](/advisories?query=cwe%3A200)

### Credits

* [![@elena-kolevska](https://avatars.githubusercontent.com/u/2369210?s=40&v=4)](/elena-kolevska)
  [elena-kolevska](/elena-kolevska)
  Remediation developer
* [![@yaron2](https://avatars.githubusercontent.com/u/16295283?s=40&v=4)](/yaron2)
  [yaron2](/yaron2)
  Coordinator
* [![@artursouza](https://avatars.githubusercontent.com/u/130954?s=40&v=4)](/artursouza)
  [artursouza](/artursouza)
  Coordinator

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.


