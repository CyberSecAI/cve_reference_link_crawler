
[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fdapr%2Fdapr%2Fsecurity%2Fadvisories%2FGHSA-284c-x8m7-9w5h)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fdapr%2Fdapr%2Fsecurity%2Fadvisories%2FGHSA-284c-x8m7-9w5h)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=dapr%2Fdapr)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[dapr](/dapr)
/
**[dapr](/dapr/dapr)**
Public

* [Notifications](/login?return_to=%2Fdapr%2Fdapr) You must be signed in to change notification settings
* [Fork
  1.9k](/login?return_to=%2Fdapr%2Fdapr)
* [Star
   24.3k](/login?return_to=%2Fdapr%2Fdapr)

* [Code](/dapr/dapr)
* [Issues
  380](/dapr/dapr/issues)
* [Pull requests
  42](/dapr/dapr/pulls)
* [Actions](/dapr/dapr/actions)
* [Security](/dapr/dapr/security)
* [Insights](/dapr/dapr/pulse)

Additional navigation options

* [Code](/dapr/dapr)
* [Issues](/dapr/dapr/issues)
* [Pull requests](/dapr/dapr/pulls)
* [Actions](/dapr/dapr/actions)
* [Security](/dapr/dapr/security)
* [Insights](/dapr/dapr/pulse)

# Dapr API token CVE

Moderate

[artursouza](/artursouza)
published
GHSA-284c-x8m7-9w5h
May 22, 2024

## Package

No package listed

## Affected versions

1.13.0;1.13.1;1.13.2

## Patched versions

1.13.3

## Description

### **Summary**

A vulnerability has been found in Dapr that causes a leak of the application token of the invoker app to the invoked app when using Dapr as a gRPC proxy for remote service invocation. This issue arises because Dapr sends the app token of the invoker app instead of the app token of the invoked app.

Users who leverage Dapr for gRPC proxy service invocation and are using the app API token feature are encouraged to upgrade Dapr to version [1.13.3](https://github.com/dapr/dapr/releases/tag/v1.13.3).

### Impact

This vulnerability impacts Dapr users who use Dapr as a gRPC proxy for remote service invocation as well as the [Dapr App API token](https://docs.dapr.io/operations/security/app-api-token/) functionality. An attacker could exploit this vulnerability to gain access to the app token of the invoker app, potentially compromising security and authentication mechanisms.

### Patches

The issue has been fixed in Dapr version [1.13.3](https://github.com/dapr/dapr/releases/tag/v1.13.3).

### Details

Dapr uses two types of tokens for authentication:

* `APP_API_TOKEN`: Used by Dapr to authenticate to the app.
* `DAPR_API_TOKEN`: Used by the app to authenticate to Dapr.

Dapr uses the `dapr-api-token` metadata in gRPC calls (or header, for HTTP calls) for authentication.

* In communication from dapr to the app, the `dapr-api-token` metadata field will carry the `APP_API_TOKEN`.
* In communication from the app to daprd, the `dapr-api-token` metadata field will carry the `DAPR_API_TOKEN`.

Before version 1.13.0, the `APP_API_TOKEN` was not being sent to the invoked app for authentication, as reported in [this issue](https://github.com/dapr/dapr/issues/7344). Instead, Dapr was incorrectly using the same `DAPR_API_TOKEN` that the invoker app had passed to Dapr. This was addressed in [PR #7404](https://github.com/dapr/dapr/pull/7404), but the fix only worked for self-invocation scenarios.

When Dapr needed to communicate with another instance, it would mistakenly include the `APP_API_TOKEN` of the invoker app in the request. This behavior is incorrect, app tokens should never be included in requests between Dapr sidecars. This vulnerability allows the receiving app to see the app token of the invoker app, leading to potential misuse and security breaches.

The vulnerability is addressed by ensuring that Dapr uses the correct app token (of the invoked app) during gRPC proxy service invocation.

### References

* <https://docs.dapr.io/operations/security/app-api-token/>
* [#7344](https://github.com/dapr/dapr/issues/7344)
* [#7404](https://github.com/dapr/dapr/pull/7404)

### Credits

Thanks to Benjamin Delay for reporting this issue.

### Severity

Moderate

### CVE ID

CVE-2024-35223

### Weaknesses

[CWE-200](/advisories?query=cwe%3A200)

### Credits

* [![@elena-kolevska](https://avatars.githubusercontent.com/u/2369210?s=40&v=4)](/elena-kolevska)
  [elena-kolevska](/elena-kolevska)
  Remediation developer
* [![@yaron2](https://avatars.githubusercontent.com/u/16295283?s=40&v=4)](/yaron2)
  [yaron2](/yaron2)
  Coordinator
* [![@artursouza](https://avatars.githubusercontent.com/u/130954?s=40&v=4)](/artursouza)
  [artursouza](/artursouza)
  Coordinator

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.

