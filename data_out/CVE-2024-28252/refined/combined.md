=== Content from github.com_4bcd9a9f_20250111_204343.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FCoreWCF%2FCoreWCF%2Fissues%2F1345)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FCoreWCF%2FCoreWCF%2Fissues%2F1345)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=CoreWCF%2FCoreWCF)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[CoreWCF](/CoreWCF)
/
**[CoreWCF](/CoreWCF/CoreWCF)**
Public

* [Notifications](/login?return_to=%2FCoreWCF%2FCoreWCF) You must be signed in to change notification settings
* [Fork
  298](/login?return_to=%2FCoreWCF%2FCoreWCF)
* [Star
   1.7k](/login?return_to=%2FCoreWCF%2FCoreWCF)

* [Code](/CoreWCF/CoreWCF)
* [Issues
  326](/CoreWCF/CoreWCF/issues)
* [Pull requests
  35](/CoreWCF/CoreWCF/pulls)
* [Discussions](/CoreWCF/CoreWCF/discussions)
* [Actions](/CoreWCF/CoreWCF/actions)
* [Projects
  0](/CoreWCF/CoreWCF/projects)
* [Wiki](/CoreWCF/CoreWCF/wiki)
* [Security](/CoreWCF/CoreWCF/security)
* [Insights](/CoreWCF/CoreWCF/pulse)

Additional navigation options

* [Code](/CoreWCF/CoreWCF)
* [Issues](/CoreWCF/CoreWCF/issues)
* [Pull requests](/CoreWCF/CoreWCF/pulls)
* [Discussions](/CoreWCF/CoreWCF/discussions)
* [Actions](/CoreWCF/CoreWCF/actions)
* [Projects](/CoreWCF/CoreWCF/projects)
* [Wiki](/CoreWCF/CoreWCF/wiki)
* [Security](/CoreWCF/CoreWCF/security)
* [Insights](/CoreWCF/CoreWCF/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2FCoreWCF%2FCoreWCF%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2FCoreWCF%2FCoreWCF%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# [Bug]: NetTCP connection doesn't send RST packet when timeout #1345

Closed

1 task done

[mkopacka](/mkopacka) opened this issue
Feb 29, 2024
· 11 comments
 · Fixed by [#1348](https://github.com/CoreWCF/CoreWCF/pull/1348)

Closed

1 task done

# [[Bug]: NetTCP connection doesn't send RST packet when timeout](#top) #1345

[mkopacka](/mkopacka) opened this issue
Feb 29, 2024
· 11 comments
 · Fixed by [#1348](https://github.com/CoreWCF/CoreWCF/pull/1348)

Labels
[bug](/CoreWCF/CoreWCF/labels/bug)
Something isn't working

## Comments

[![@mkopacka](https://avatars.githubusercontent.com/u/48550785?s=80&v=4)](/mkopacka)

Copy link

### **[mkopacka](/mkopacka)** commented [Feb 29, 2024](#issue-2160738587)

| Duplicate ?  * I have searched issues/discussions and did not find other issues/discussions reporting this bug.  Product version 1.5.1 Describe expected behavior When server (service) timeouts (disconnects / closes connection) then RST packet should be sent to the client so it knows about being disconnected. Describe actual behavior When server timeouts then no RST packet is sent so client thinks it is still connected. but if it tries to get any data from the server, it timeouts (after client timeout).  I have tried to create server and client in NET6 using CoreWCF and also in Framework 4.7.2 to compare behaviour.  **Framework 4.7.2 behaviour:**   * Server starts, client connects - no problem * I set timeout of server to 10 seconds. Timeout of client to 5 seconds. * If I do nothing for 10 seconds, server timeouts and informs client about it   + Client disconnects   + It is visible in Wireshark   [image](https://private-user-images.githubusercontent.com/48550785/308857666-cfa3dd43-a19c-4d8f-a695-e407c7d2cb19.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY2Mjg1MjIsIm5iZiI6MTczNjYyODIyMiwicGF0aCI6Ii80ODU1MDc4NS8zMDg4NTc2NjYtY2ZhM2RkNDMtYTE5Yy00ZDhmLWE2OTUtZTQwN2M3ZDJjYjE5LnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDIwNDM0MlomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTFkZWE1OTJiNjNlNmYyYWNjNzA0NDZkOGU4NzhhYjJhNWIyZGIyNTMyMjgyMzkzNDY5YThkYzM1ZGViNTA1YzAmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.iLLSi2TMCUOnTZqTLEXuAVdNpbUaMSOnyUCV2qHTu8c)  Events on server side:  [image](https://private-user-images.githubusercontent.com/48550785/308857760-1e0336b0-cb48-4f65-a5f4-b55a152ac666.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY2Mjg1MjIsIm5iZiI6MTczNjYyODIyMiwicGF0aCI6Ii80ODU1MDc4NS8zMDg4NTc3NjAtMWUwMzM2YjAtY2I0OC00ZjY1LWE1ZjQtYjU1YTE1MmFjNjY2LnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDIwNDM0MlomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWZiMjJjM2JhMmY0NGJiYjI0M2U1NDVjOTFjOWIxNGQ2MDcyYThiMTBhODBkMWI2YjYzZjViOWU4NzBlYTAyYjcmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.BTqjBJa4W14Eha13jrTFv-Jwb2C5RhF-xlF5kB22RCc)  **NET6 behaviour:**   * Server starts, client connects - no problem * Timeouts are again - 10 seconds at server side, 5 seconds at client side * If I do nothing for 10 seconds, I see that server closes connection, but nothing is sent to the client and therefore connection looks active, even though, it is not.   + If client tries to call something from service, it doesn't reach it because connection is off and timeouts in 5 seconds as not reachable.   Server side events: [image](https://private-user-images.githubusercontent.com/48550785/308857949-cb09a928-3eee-46ed-9563-a1806bb14a61.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY2Mjg1MjIsIm5iZiI6MTczNjYyODIyMiwicGF0aCI6Ii80ODU1MDc4NS8zMDg4NTc5NDktY2IwOWE5MjgtM2VlZS00NmVkLTk1NjMtYTE4MDZiYjE0YTYxLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDIwNDM0MlomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWY0OGFlMmEzOGQyYmE0YzA1NWE3NWY5MzNlOWQwMjI1MWZkMDQyZmYyZWY3YjhhNzg0MTJjZTgzMzg4YjVkMmMmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.WhBrcte4NzooHHOuIO61MuxrxxZ4FtNIZjJh5TqUL8g)  But nothing is sent to the client and therefore connection looks still on:  [image](https://private-user-images.githubusercontent.com/48550785/308858035-083b305d-7123-43cd-b88c-b9ec22ac8944.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY2Mjg1MjIsIm5iZiI6MTczNjYyODIyMiwicGF0aCI6Ii80ODU1MDc4NS8zMDg4NTgwMzUtMDgzYjMwNWQtNzEyMy00M2NkLWI4OGMtYjllYzIyYWM4OTQ0LnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDIwNDM0MlomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTBmNTU0M2VmNDIwYjNiYTUxNTc4NTMwNDc3OWQwOGJmYWU0M2Y3NGFhYWYxNDZjNjk3ZGY1ODY3MGM4Zjk5YjAmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.0384fgdm4i_yFXjSr4iep0XzyAOgDMlGyjh3xLe2ikc)  But, if I try to call method from client again, it doesn't reach it. And timeouts in 5 seconds (client timeout)  [image](https://private-user-images.githubusercontent.com/48550785/308858104-fa49f365-b43f-44b1-977f-42cdcd504997.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY2Mjg1MjIsIm5iZiI6MTczNjYyODIyMiwicGF0aCI6Ii80ODU1MDc4NS8zMDg4NTgxMDQtZmE0OWYzNjUtYjQzZi00NGIxLTk3N2YtNDJjZGNkNTA0OTk3LnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDIwNDM0MlomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTBmYjFiMTcxZDI0N2ViZGRhZGQ3N2JlNTIyZGFjYjczOTc5NzAyNmNmNjgxMTVhZDg4NjQyM2IzMGE4ODhhNjImWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.oQ4A3rM-5DtWbn0xzJWz5HWi8xdUUKp_utEymt1Plmg) [image](https://private-user-images.githubusercontent.com/48550785/308858140-37557467-bf6f-4f05-82ba-7d687d4eaab9.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY2Mjg1MjIsIm5iZiI6MTczNjYyODIyMiwicGF0aCI6Ii80ODU1MDc4NS8zMDg4NTgxNDAtMzc1NTc0NjctYmY2Zi00ZjA1LTgyYmEtN2Q2ODdkNGVhYWI5LnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDIwNDM0MlomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWJkYTQ4M2JmZGFjOTdlY2JhZTUyMDcxMWE1OTRlMzJlOGQ1NDQ1NzRmNjYyY2MyM2VjMTU3MzdlMGVjNTZhZTkmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.-_GjQrodYzQqu-uVM0EHzwhWJmhjFzJnZ1Z-okTF-m8)  We can see in the server logs that it didn't reach it at all so connection was closed. Client just didn't know: [image](https://private-user-images.githubusercontent.com/48550785/308858212-c4233edd-0fd5-47d7-9901-9ef36ff02bf4.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY2Mjg1MjIsIm5iZiI6MTczNjYyODIyMiwicGF0aCI6Ii80ODU1MDc4NS8zMDg4NTgyMTItYzQyMzNlZGQtMGZkNS00N2Q3LTk5MDEtOWVmMzZmZjAyYmY0LnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDIwNDM0MlomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTE2MzkzMzRjNzc1NmNlZjk1N2I2MGJjYTI1MTI5YTc2ZjA2NmFlNjg4YWZiODhmOGI1OGQyNTFhNDE1MzBmNzkmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.5NFh4XJqBNoYgdFlwV2kkJAKLcqYv9naRbDtpaKUQyc) Which binding NetTcp security Transport Which .NET version .NET 6 Which os platform Windows Code snippet used to reproduce the issue ``` // WCF Service  [ServiceContract] public interface ITestWcfService {     [OperationContract]     string GetData(int value); }  [ServiceBehavior(InstanceContextMode = InstanceContextMode.PerSession, ConcurrencyMode = ConcurrencyMode.Multiple)] public class TestWcfService : ITestWcfService {     public TestWcfService() //only instantiated by WCF     {         Console.WriteLine("Constructor - NET6");         OperationContext.Current.InstanceContext.Faulted += Channel_Faulted;         OperationContext.Current.InstanceContext.Closed += Channel_Closed;         OperationContext.Current.InstanceContext.Opened += InstanceContext_Opened;     }      public string GetData(int value)     {         Console.WriteLine("GetData - NET6");         try         {             return $"{value}";         }         catch (Exception ex)         {             throw;         }     }      private void InstanceContext_Opened(object sender, EventArgs e)     {         Console.WriteLine("Opened - NET6");     }      private void Channel_Faulted(object sender, EventArgs e)     {         Console.WriteLine("Faulted - NET6");     }      private void Channel_Closed(object sender, EventArgs e)     {         Console.WriteLine("Closed - NET6");     } }  // Server:  private static WebApplication _app; public Form1() {     InitializeComponent();      var builder = WebApplication.CreateBuilder();     builder.WebHost.UseNetTcp(11999);     builder.Services.AddServiceModelServices();     builder.Services.AddServiceModelMetadata();      _app = builder.Build();      var binding = new NetTcpBinding(SecurityMode.Transport)     {         CloseTimeout = TimeSpan.FromSeconds(10),         OpenTimeout = TimeSpan.FromSeconds(10),         ReceiveTimeout = new TimeSpan(0, 0, 0, 10),         SendTimeout = TimeSpan.FromSeconds(10)     };          _app.UseServiceModel(serviceBuilder =>     {         serviceBuilder.AddService<TestWcfService>(options =>         {             options.DebugBehavior.IncludeExceptionDetailInFaults = true;         });          serviceBuilder.AddServiceEndpoint<TestWcfService, ITestWcfService>(binding, "net.tcp://localhost:11999/TestWcfService2");     });      _app.StartAsync().Wait(); }  // Client:  private ITestWcfService client; public Form1() {     InitializeComponent();      IClientChannel channel = null;     var binding = new NetTcpBinding()     {         CloseTimeout = TimeSpan.FromSeconds(5),         OpenTimeout = TimeSpan.FromSeconds(5),         ReceiveTimeout = new TimeSpan(0, 0, 0, 5),         SendTimeout = TimeSpan.FromSeconds(5),     };      var factory = new ChannelFactory<ITestWcfService>(binding, new EndpointAddress("net.tcp://localhost:11999/TestWcfService2"));     factory.Open();     try     {         client = factory.CreateChannel();     }     finally     {     } }  private void button1_Click(object sender, EventArgs e) {     client.GetData(4); } ``` Stacktrace if any *No response* |
| --- |
| The text was updated successfully, but these errors were encountered: |

 👍
4
 DenisDoroshko, rikardhansson, JunoGonzalezfisglobalcom, and xrcdev reacted with thumbs up emoji

All reactions

* 👍
  4 reactions

[![@mkopacka](https://avatars.githubusercontent.com/u/48550785?s=40&v=4)](/mkopacka)
[mkopacka](/mkopacka)
added
the
[bug](/CoreWCF/CoreWCF/labels/bug)
Something isn't working
label
[Feb 29, 2024](#event-11962766385)

[![@mconnew](https://avatars.githubusercontent.com/u/8648390?s=80&v=4)](/mconnew)

Copy link

Member

### **[mconnew](/mconnew)** commented [Mar 4, 2024](#issuecomment-1977429395)

| If I do nothing for 10 seconds, I see that server closes connection, but nothing is sent to the client and therefore connection looks active, even though, it is not.  What do you mean by server closes connection? Do you mean `OperationContext.Current.InstanceContext.Closed` is called to notify you but nothing happens on the network? Or do you mean that a FIN packet is sent (as opposed to RST)?  What happens if you attach event handlers to OperationContext.Current.Channel? Does the Closed event handler fire?  If you call `OperationContext.Current.Channel.Abort()` does it send a RST? |
| --- |

All reactions

Sorry, something went wrong.

[![@mkopacka](https://avatars.githubusercontent.com/u/48550785?s=80&v=4)](/mkopacka)

Copy link

Author

### **[mkopacka](/mkopacka)** commented [Mar 5, 2024](#issuecomment-1978159372)

| If I do nothing for 10 seconds, I see that server closes connection, but nothing is sent to the client and therefore connection looks active, even though, it is not.  What do you mean by server closes connection? Do you mean `OperationContext.Current.InstanceContext.Closed` is called to notify you but nothing happens on the network? Or do you mean that a FIN packet is sent (as opposed to RST)?  Yes, exactly (first option) - `OperationContext.Current.InstanceContext.Closed` is executed but nothing happens on the network - neither RST nor FIN packet is sent.  [image](https://private-user-images.githubusercontent.com/48550785/310016416-46d9eb3a-736e-4803-9c47-d0a51a868dc9.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY2Mjg1MjIsIm5iZiI6MTczNjYyODIyMiwicGF0aCI6Ii80ODU1MDc4NS8zMTAwMTY0MTYtNDZkOWViM2EtNzM2ZS00ODAzLTljNDctZDBhNTFhODY4ZGM5LnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDIwNDM0MlomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWI5NzllMTNhM2IyNzZkNmE3MzZiNTZkOTFkNjI1NGQ5MTQ5NTQwMGFkNGI5MWE4ZTFkZDY4NjE1M2JmMGFhOGMmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.OV1osuBBD_UxWA58gy8ZMvHqFvc14K4KqpgyF0tJNnI)  What happens if you attach event handlers to OperationContext.Current.Channel? Does the Closed event handler fire?  I am not sure here. If you mean at service side (CoreWCF) then `OperationContext.Current.Channel` is not available. It would be in System.ServiceModel which is eventually only at client side.  [image](https://private-user-images.githubusercontent.com/48550785/310020403-f85411d7-4e22-4709-9422-86a65050e189.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY2Mjg1MjIsIm5iZiI6MTczNjYyODIyMiwicGF0aCI6Ii80ODU1MDc4NS8zMTAwMjA0MDMtZjg1NDExZDctNGUyMi00NzA5LTk0MjItODZhNjUwNTBlMTg5LnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDIwNDM0MlomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTdkZTY2NDhjZjdiZGNhMGU5ODg5ODhkZGU3MDkwOGNjYzMxYWNiNTc3ZDJiZjFiMDU2NDQ0Y2VlMGZlYzE5YWQmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.kJXlW-EfbR0sFi7W8yM4DLU9xpNS5SAz8JBZOMRsy0g)  If you call `OperationContext.Current.Channel.Abort()` does it send a RST?  And here same answer as above, `OperationContext.Current.Channel.` is not available. I tried to call `OperationContext.Current.InstanceContext.Abort()` as test now but it crashes on exception.  [image](https://private-user-images.githubusercontent.com/48550785/310021291-3ed78abb-e4c8-4e82-856b-ba355fdbc440.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY2Mjg1MjIsIm5iZiI6MTczNjYyODIyMiwicGF0aCI6Ii80ODU1MDc4NS8zMTAwMjEyOTEtM2VkNzhhYmItZTRjOC00ZTgyLTg1NmItYmEzNTVmZGJjNDQwLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTExVDIwNDM0MlomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTM2MmIyZTU5MmM5YTJiZjg3YjhiYjAyYzQ4NDEwYjgxNmE5NTA5MjI3MGQ5YmI5ODg4YWM5NDY2NmJhZWIyZTcmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.Hd7vQNJE8IKScpLGgdaGiLUmJ29-9ZZkXjfCQIb4Mw4)  Here is a zip with simple examples to easier/faster reproduction. It contains servers and clients in NET6 and framework472. [WcfTest.zip](https://github.com/CoreWCF/CoreWCF/files/14491979/WcfTest.zip)  I tried to connect to these servers also from Windows Telnet client. In both cases it doesn't instantiate the service class but in case of framework server, telnet gets disconnected after a while. However in case of NET6 server, it stays connected for eternity. |
| --- |

All reactions

Sorry, something went wrong.

[![@JunoGonzalezfisglobalcom](https://avatars.githubusercontent.com/u/54582497?s=80&v=4)](/JunoGonzalezfisglobalcom)

Copy link

### **[JunoGonzalezfisglobalcom](/JunoGonzalezfisglobalcom)** commented [Mar 5, 2024](#issuecomment-1979066099)

| Hello, We are getting a very similar issue after we migrated our wcf services to core wcf. We replicate by calling a singleton service on the migrated core wcf web services, wait for the CoreWCF.Channels.ServiceChannel.SessionIdleManager to abort the channel when the ReceiveTimeout (<https://learn.microsoft.com/en-us/dotnet/framework/wcf/feature-details/configuring-timeout-values-on-a-binding>) from the NetTcpBinding is reached, then we try to call the same service again and for the client, the channel seems to be valid but when the server tries to send the response back to the client we get error below server side and the client service request times out. CoreWCF.CommunicationObjectAbortedException: The communication object, CoreWCF.Channels.ServerFramingDuplexSessionChannel, cannot be used for communication because it has been Aborted. at CoreWCF.Channels.CommunicationObject.ThrowIfDisposedOrNotOpen() at CoreWCF.Channels.OutputChannel.SendAsync(Message message, CancellationToken token) at CoreWCF.Dispatcher.DuplexChannelBinder.DuplexRequestContext.OnReplyAsync(Message message, CancellationToken token) at CoreWCF.Channels.RequestContextBase.ReplyAsync(Message message, CancellationToken token) at CoreWCF.Dispatcher.ImmutableDispatchRuntime.ReplyAsync(MessageRpc rpc) I have checked on IServiceBehavior we use on the server side that the channel is closed and tried to do something so the client realizes the channel is not valid and triggers the channel repair policy client side but nothing has worked so far, public object AfterReceiveRequest(ref Message request, IClientChannel channel, InstanceContext instanceContext) { if (channel.State == CommunicationState.Closed || channel.State == CommunicationState.Closing || channel.State == CommunicationState.Faulted) throw new System.ServiceModel.CommunicationException(); I have pointed the client to the legacy wcf web services and for the same scenario it fails trying to send the request (at System.ServiceModel.Channels.StreamConnection.Write, the socket connection is closed) after the channel is closed for inactivity (ReceiveTimeout) on the server side, because a CommunicationException is thrown client side the repair policy is triggered, the channel gets repaired and the service request goes thru. For the migrated core wcf web services we are getting timeouts on the web app side and CommunicationObjectAbortedException server side. Is this related to core wcf not sending the RST or FIN when the channel is aborted by CoreWCF.Channels.ServiceChannel.SessionIdleManager because of inactivity (NetTcpBinding ReceiveTimeout)? Any recommendation to workaround/fix this issue? Thanks, Juno |
| --- |

All reactions

Sorry, something went wrong.

[![@mirek-kopacka](https://avatars.githubusercontent.com/u/144328427?s=80&v=4)](/mirek-kopacka)

Copy link

### **[mirek-kopacka](/mirek-kopacka)** commented [Mar 11, 2024](#issuecomment-1987796028) • edited Loading

| I'd like to add some additional information to this. This time I only started a server and connected Telnet client to it. In this way, WcfTestService is not instantiated, so there are not any events. Reason of this check was to see netstat and ports state.   1. So, started WCF Service - everything as expected, port is listening    [image](https://private-user-images.githubusercontent.com/144328427/311621226-cc115fb6-12ed-4ee9-a193-aef6a2b83579.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY2Mjg1MjIsIm5iZiI6MTczNjYyODIyMiwicGF0aCI6Ii8xNDQzMjg0MjcvMzExNjIxMjI2LWNjMTE1ZmI2LTEyZWQtNGVlOS1hMTkzLWFlZjZhMmI4MzU3OS5wbmc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjUwMTExJTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI1MDExMVQyMDQzNDJaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT00NDgwOGVhYTFiN2VjZTQ3NmNlMDM5MzBlYjA2NTQzOWJmOWVhOWZmMGI2ZDZlMjI0NmRjZDkzMjY0N2MwYWUxJlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.2hqoXkqGLj2mNLkn1JljoijB6hFGG6wFIqgUt06_I40) 2. Connected telnet client to it    [image](https://private-user-images.githubusercontent.com/144328427/311621315-f3659b71-5f56-4bf4-b51e-682c3dfe0b16.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY2Mjg1MjIsIm5iZiI6MTczNjYyODIyMiwicGF0aCI6Ii8xNDQzMjg0MjcvMzExNjIxMzE1LWYzNjU5YjcxLTVmNTYtNGJmNC1iNTFlLTY4MmMzZGZlMGIxNi5wbmc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjUwMTExJTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI1MDExMVQyMDQzNDJaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT1jYmE3NTU5ZTE1NjMwYjVjNWFjYmI3MTU2OGVlYzc2ZWRkM2E2OWU3MjBkNTUyNGZlM2Y4NzBmZGEzZjUwOWNlJlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.Y7M7qUfLVHZT07HAYQCbGSwikcqug3T7rMNaNpXfHec)    [image](https://private-user-images.githubusercontent.com/144328427/311621345-21ece5d5-bfc0-4671-b1a4-d44222aeaf7d.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY2Mjg1MjIsIm5iZiI6MTczNjYyODIyMiwicGF0aCI6Ii8xNDQzMjg0MjcvMzExNjIxMzQ1LTIxZWNlNWQ1LWJmYzAtNDY3MS1iMWE0LWQ0NDIyMmFlYWY3ZC5wbmc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjUwMTExJTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI1MDExMVQyMDQzNDJaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT03NDkwODE3NTgwZDVlODYzZmE3MzU5OWE3NzNjMjhhNWZmOWQyZDk0YTRmYzczZGRmODBmMGNlYjViZWU4NjdiJlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.T-PhbbOf7_FN1ErzH7uR3U9d5EwWWmJL75O-oSWo_Mc) 3. And now I waited for timeouts again. It doesn't come, which means that port is Established for as long as client doesn't initiate to close connection. So I can connect more and more    [image](https://private-user-images.githubusercontent.com/144328427/311621594-2381a96a-4b48-4243-afb3-3931b85d25f0.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY2Mjg1MjIsIm5iZiI6MTczNjYyODIyMiwicGF0aCI6Ii8xNDQzMjg0MjcvMzExNjIxNTk0LTIzODFhOTZhLTRiNDgtNDI0My1hZmIzLTM5MzFiODVkMjVmMC5wbmc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjUwMTExJTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI1MDExMVQyMDQzNDJaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT01MjE1YThmNGI5YjZkY2E1ZWJhYzI5OGI1OTJhNTk5ODlmNzAyYWQwNjUzNjY3MTc5ZDc2Y2JmMjcxMDNjOWY0JlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.puZ69hJssjgbdE919N8gWpLgML6G9WbuQd0jnY40dwk)   That basically leads to possibility of Denial of Service (DoS) attack. |
| --- |

All reactions

Sorry, something went wrong.

[![@mconnew](https://avatars.githubusercontent.com/u/8648390?s=80&v=4)](/mconnew)

Copy link

Member

### **[mconnew](/mconnew)** commented [Mar 11, 2024](#issuecomment-1989283037)

| I believe I found the missing line of code. ServerFramingDuplexSessionChannel.ReturnConnectionIfNecessary has an abort argument. In .NET Framework, the sessionReader was responsible for handling connection reuse, but in CoreWCF it's an aspnetcore middleware component that handles it. I believe it just needs:  ```             if (abort)             {                 Connection.Abort();             } ```  Adding at the top of the method. I'm going to write a test to validate the client goes into the expected state then should have a PR available pretty quickly after that. |
| --- |

 ❤️
2
 mkopacka and andradf reacted with heart emoji

All reactions

* ❤️
  2 reactions

Sorry, something went wrong.

[![@mconnew](https://avatars.githubusercontent.com/u/8648390?s=80&v=4)](/mconnew)

Copy link

Member

### **[mconnew](/mconnew)** commented [Mar 11, 2024](#issuecomment-1989293117)

| BTW, I believe a DoS attack isn't possible with this issue because it requires an authenticated connection in the first place. If a malicious client has valid credentials to a service, there are potentially a lot worse things you need to worry about. Having said that, I'm going to release a fix for this with some urgency. I'll keep this thread updated. |
| --- |

 👍
1
 mkopacka reacted with thumbs up emoji

All reactions

* 👍
  1 reaction

Sorry, something went wrong.

[![@mconnew](https://avatars.githubusercontent.com/u/8648390?s=40&v=4)](/mconnew)
[mconnew](/mconnew)
mentioned this issue
[Mar 12, 2024](#ref-pullrequest-2180491201)

[Fix NetFramingBase based transports Abort code path
#1348](/CoreWCF/CoreWCF/pull/1348)
 Merged

[![@mconnew](https://avatars.githubusercontent.com/u/8648390?s=80&v=4)](/mconnew)

Copy link

Member

### **[mconnew](/mconnew)** commented [Mar 12, 2024](#issuecomment-1989719776)

| [@mirek-kopacka](https://github.com/mirek-kopacka), I initially misread what you wrote, I'm making another change to address that. It's a change I've been wanting to do for a while, it's a pattern I created for named pipes where there's an options class to specify connection specific parameters, as the Binding isn't known until too late. The default connection timeout is 30 seconds on .NET Framework. If you want to change it, you would do something like this:  ``` builder.UseNetTcp(options => {     options.Listen("net.tcp://localhost:11999" listenOptions =>     {         listenOptions.ChannelInitializationTimeout = TimeSpan.FromSeconds(10);     } }); ```  If you are happy with the default of 30 seconds, the current api's will still work. |
| --- |

All reactions

Sorry, something went wrong.

[![@mkopacka](https://avatars.githubusercontent.com/u/48550785?s=80&v=4)](/mkopacka)

Copy link

Author

### **[mkopacka](/mkopacka)** commented [Mar 12, 2024](#issuecomment-1990929089)

| I believe I found the missing line of code. ServerFramingDuplexSessionChannel.ReturnConnectionIfNecessary has an abort argument. In .NET Framework, the sessionReader was responsible for handling connection reuse, but in CoreWCF it's an aspnetcore middleware component that handles it. I believe it just needs:  ```             if (abort)             {                 Connection.Abort();             } ```  Adding at the top of the method. I'm going to write a test to validate the client goes into the expected state then should have a PR available pretty quickly after that.  Thank you [@mconnew](https://github.com/mconnew) for such quick fix!  BTW, I believe a DoS attack isn't possible with this issue because it requires an authenticated connection in the first place. If a malicious client has valid credentials to a service, there are potentially a lot worse things you need to worry about. Having said that, I'm going to release a fix for this with some urgency. I'll keep this thread updated.  Yes, you are right, it would be (most likely) my least problem in such case  [@mirek-kopacka](https://github.com/mirek-kopacka), I initially misread what you wrote, I'm making another change to address that. It's a change I've been wanting to do for a while, it's a pattern I created for named pipes where there's an options class to specify connection specific parameters, as the Binding isn't known until too late. The default connection timeout is 30 seconds on .NET Framework. If you want to change it, you would do something like this:  ``` builder.UseNetTcp(options => {     options.Listen("net.tcp://localhost:11999" listenOptions =>     {         listenOptions.ChannelInitializationTimeout = TimeSpan.FromSeconds(10);     } }); ```  If you are happy with the default of 30 seconds, the current api's will still work.  Noted, thank you for a tip! |
| --- |

All reactions

Sorry, something went wrong.

[![@rikardhansson](https://avatars.githubusercontent.com/u/70533983?s=80&v=4)](/rikardhansson)

Copy link

### **[rikardhansson](/rikardhansson)** commented [Mar 12, 2024](#issuecomment-1992095870)

| [@mconnew](https://github.com/mconnew) Thank you for investigating!  BTW, I believe a DoS attack isn't possible with this issue because it requires an authenticated connection in the first place. If a malicious client has valid credentials to a service, there are potentially a lot worse things you need to worry about. Having said that, I'm going to release a fix for this with some urgency. I'll keep this thread updated.  A generic TCP client can open a connection that stays in Established until closed by the client, according to what I see with *netstat*. .NET Framework times out and closes on server side, but I don't get a timeout on CoreWCF / .NET 6.  No credentials involved, so this might be a risk for DoS attack. Client code:  ``` using System.Net; using System.Net.Sockets;  var address = IPAddress.Parse("127.0.0.1"); var ipEndPoint = new IPEndPoint(address, 11999); using var client = new Socket(ipEndPoint.AddressFamily, SocketType.Stream, ProtocolType.Tcp); await client.ConnectAsync(ipEndPoint); await Task.Delay(TimeSpan.FromMinutes(20));  ``` |
| --- |

All reactions

Sorry, something went wrong.

[![@mconnew](https://avatars.githubusercontent.com/u/8648390?s=80&v=4)](/mconnew)

Copy link

Member

### **[mconnew](/mconnew)** commented [Mar 15, 2024](#issuecomment-1998748068)

| I've just released v1.4.2 and v1.5.2 fixing both of the timeout connection closing problems. I'm going to close this issue even though a large/better fix (configurable timeouts) is in progress. The released fixes are the minimum change required to fix the problem.  [@mirek-kopacka](https://github.com/mirek-kopacka), in future it's generally best to report potential security issues privately. We have a published security policy detailing how to do this [here](https://github.com/CoreWCF/CoreWCF/security/policy). It's important to report it privately so that there isn't a publicly known vulnerability without any fixes that could be exploited to harm companies or individuals. There's a good write up about why to do responsible disclosure in the [first few paragraphs of this blog post](https://snyk.io/blog/responsible-disclosure/). |
| --- |

 ❤️
1
 mirek-kopacka reacted with heart emoji

All reactions

* ❤️
  1 reaction

Sorry, something went wrong.

[![@mconnew](https://avatars.githubusercontent.com/u/8648390?s=40&v=4)](/mconnew)
[mconnew](/mconnew)
closed this as [completed](/CoreWCF/CoreWCF/issues?q=is%3Aissue+is%3Aclosed+archived%3Afalse+reason%3Acompleted)
[Mar 15, 2024](#event-12125678969)

[![@mirek-kopacka](https://avatars.githubusercontent.com/u/144328427?s=80&v=4)](/mirek-kopacka)

Copy link

### **[mirek-kopacka](/mirek-kopacka)** commented [Mar 15, 2024](#issuecomment-1999054904)

| I've just released v1.4.2 and v1.5.2 fixing both of the timeout connection closing problems. I'm going to close this issue even though a large/better fix (configurable timeouts) is in progress. The released fixes are the minimum change required to fix the problem.  [@mirek-kopacka](https://github.com/mirek-kopacka), in future it's generally best to report potential security issues privately. We have a published security policy detailing how to do this [here](https://github.com/CoreWCF/CoreWCF/security/policy). It's important to report it privately so that there isn't a publicly known vulnerability without any fixes that could be exploited to harm companies or individuals. There's a good write up about why to do responsible disclosure in the [first few paragraphs of this blog post](https://snyk.io/blog/responsible-disclosure/).  Thank you for really quick fix! Gonna test it now!  And noted, I even didn't think about that possibility and I am sorry for that. If will have "luck" in the future, I'll do it privately for sure! |
| --- |

All reactions

Sorry, something went wrong.

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2FCoreWCF%2FCoreWCF%2Fissues%2F1345)

Assignees

No one assigned

Labels

[bug](/CoreWCF/CoreWCF/labels/bug)
Something isn't working

Projects

None yet

Milestone

No milestone

Development

Successfully merging a pull request may close this issue.

 [Fix NetFramingBase based transports Abort code path](/CoreWCF/CoreWCF/pull/1348)
 [mconnew/CoreWCF](/mconnew/CoreWCF)

5 participants

[![@mconnew](https://avatars.githubusercontent.com/u/8648390?s=52&v=4)](/mconnew) [![@mkopacka](https://avatars.githubusercontent.com/u/48550785?s=52&v=4)](/mkopacka) [![@JunoGonzalezfisglobalcom](https://avatars.githubusercontent.com/u/54582497?s=52&v=4)](/JunoGonzalezfisglobalcom) [![@rikardhansson](https://avatars.githubusercontent.com/u/70533983?s=52&v=4)](/rikardhansson) [![@mirek-kopacka](https://avatars.githubusercontent.com/u/144328427?s=52&v=4)](/mirek-kopacka)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_1d4301c6_20250111_204343.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FCoreWCF%2FCoreWCF%2Fsecurity%2Fadvisories%2FGHSA-32jq-mv89-5rx7)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FCoreWCF%2FCoreWCF%2Fsecurity%2Fadvisories%2FGHSA-32jq-mv89-5rx7)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=CoreWCF%2FCoreWCF)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[CoreWCF](/CoreWCF)
/
**[CoreWCF](/CoreWCF/CoreWCF)**
Public

* [Notifications](/login?return_to=%2FCoreWCF%2FCoreWCF) You must be signed in to change notification settings
* [Fork
  298](/login?return_to=%2FCoreWCF%2FCoreWCF)
* [Star
   1.7k](/login?return_to=%2FCoreWCF%2FCoreWCF)

* [Code](/CoreWCF/CoreWCF)
* [Issues
  326](/CoreWCF/CoreWCF/issues)
* [Pull requests
  35](/CoreWCF/CoreWCF/pulls)
* [Discussions](/CoreWCF/CoreWCF/discussions)
* [Actions](/CoreWCF/CoreWCF/actions)
* [Projects
  0](/CoreWCF/CoreWCF/projects)
* [Wiki](/CoreWCF/CoreWCF/wiki)
* [Security](/CoreWCF/CoreWCF/security)
* [Insights](/CoreWCF/CoreWCF/pulse)

Additional navigation options

* [Code](/CoreWCF/CoreWCF)
* [Issues](/CoreWCF/CoreWCF/issues)
* [Pull requests](/CoreWCF/CoreWCF/pulls)
* [Discussions](/CoreWCF/CoreWCF/discussions)
* [Actions](/CoreWCF/CoreWCF/actions)
* [Projects](/CoreWCF/CoreWCF/projects)
* [Wiki](/CoreWCF/CoreWCF/wiki)
* [Security](/CoreWCF/CoreWCF/security)
* [Insights](/CoreWCF/CoreWCF/pulse)

# CoreWCF NetFraming based services can leave connections open when they should be closed

High

[mconnew](/mconnew)
published
GHSA-32jq-mv89-5rx7
Mar 15, 2024

## Package

nuget

CoreWCF.NetFramingBase
([NuGet](/advisories?query=ecosystem%3Anuget))

## Affected versions

1.4.1
1.5.1

## Patched versions

1.4.2
1.5.2

## Description

### Impact

If you have a NetFraming based CoreWCF service, extra system resources could be consumed by connections being left established instead of closing or aborting them. There are two scenarios when this can happen. When a client established a connection to the service and sends no data, the service will wait indefinitely for the client to initiate the NetFraming session handshake. Additionally, once a client has established a session, if the client doesn't send any requests for the period of time configured in the binding ReceiveTimeout, the connection is not properly closed as part of the session being aborted.

The bindings affected by this behavior are NetTcpBinding, NetNamedPipeBinding, and UnixDomainSocketBinding. Only NetTcpBinding has the ability to accept non local connections.

### Patches

The currently supported versions of CoreWCF are v1.4.x and v1.5.x. The fix can be found in v1.4.2 and v1.5.2 of the CoreWCF packages.

### Workarounds

There are no workarounds.

### References

[#1345](https://github.com/CoreWCF/CoreWCF/issues/1345)

### Severity

High

7.5

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Network

Attack complexity
Low

Privileges required
None

User interaction
None

Scope
Unchanged

Confidentiality
None

Integrity
None

Availability
High

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H

### CVE ID

CVE-2024-28252

### Weaknesses

No CWEs

### Credits

* [![@mirek-kopacka](https://avatars.githubusercontent.com/u/144328427?s=40&v=4)](/mirek-kopacka)
  [mirek-kopacka](/mirek-kopacka)
  Finder
* [![@birojnayak](https://avatars.githubusercontent.com/u/49173255?s=40&v=4)](/birojnayak)
  [birojnayak](/birojnayak)
  Remediation reviewer
* [![@mconnew](https://avatars.githubusercontent.com/u/8648390?s=40&v=4)](/mconnew)
  [mconnew](/mconnew)
  Remediation developer

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


