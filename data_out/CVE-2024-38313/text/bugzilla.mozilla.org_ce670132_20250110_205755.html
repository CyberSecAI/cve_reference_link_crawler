

![](/static/v20250108.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1878489)
* [XML](/show_bug.cgi?ctype=xml&id=1878489)

Closed
[Bug 1878489](/show_bug.cgi?id=1878489)
(CVE-2024-38313)

Opened 11 months ago
Closed 8 months ago

# URL spoofing by abusing auto hide URL bar feature (FxiOS)

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

URL spoofing by abusing auto hide URL bar feature (FxiOS)

## Categories

### (Firefox for iOS :: Browser, defect)

[Product:](/describecomponents.cgi?product=Firefox%20for%20iOS)

Firefox for iOS
▾

Firefox for iOS
Firefox for iOS is the Firefox mobile experience developed for the iOS platform.
[See Open Bugs in This Product](/buglist.cgi?product=Firefox%20for%20iOS&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Firefox%20for%20iOS)
Watch This Product

[Component:](/describecomponents.cgi?product=Firefox%20for%20iOS&component=Browser#Browser)

Browser
▾

Firefox for iOS :: Browser
The UI for browsing the web.
[See Open Bugs in This Component](/buglist.cgi?product=Firefox%20for%20iOS&component=Browser&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Firefox%20for%20iOS&component=Browser&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Firefox%20for%20iOS&component=Browser)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

unspecified

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

--

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

---

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| a11y-review | --- |
| --- | --- |
| Webcompat Priority | --- |
| Webcompat Score | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| fxios | [127](/buglist.cgi?f1=cf_tracking_fxios&o1=equals&v1=127) | --- |

|  | Tracking | Status |
| --- | --- | --- |
| fxios | 127 |  |

## People

### (Reporter: sdna.muneaki.nishimura, Unassigned)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

*Unassigned*

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/7e8b2996acb6304c9b7b7000f408632a?d=mm&size=40)  [sdna.muneaki.nishimura](/user_profile?user_id=507051)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/481f85b35d45ebad6d41f98cae68ccbf?d=mm&size=40)  [jeevans](/user_profile?user_id=654438)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

10 people

## References

### ( [URL](https://csrf.jp/2024/fxios-url-spoofing/open_new_window.php "https://csrf.jp/2024/fxios-url-spoofing/open_new_window.php") )

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[csrf.jp/2024/fxios-url-spoofing/open\_...](https://csrf.jp/2024/fxios-url-spoofing/open_new_window.php "https://csrf.jp/2024/fxios-url-spoofing/open_new_window.php")

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

[mozilla-hub.atlassian.net/browse/FXIO...](https://mozilla-hub.atlassian.net/browse/FXIOS-8928 "https://mozilla-hub.atlassian.net/browse/FXIOS-8928")

[github.com/mozilla-mobile/firefox-ios...](https://github.com/mozilla-mobile/firefox-ios/pull/20014 "https://github.com/mozilla-mobile/firefox-ios/pull/20014")

## Details

### (Keywords: csectype-spoof, reporter-external, sec-high, Whiteboard: [reporter-external] [client-bounty-form] [verif?])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2024-38313

[Keywords:](/describekeywords.cgi)

[csectype-spoof](/buglist.cgi?keywords=csectype-spoof&resolution=---),
[reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---),
[sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[reporter-external] [client-bounty-form] [verif?]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

Bug Flags:

| [dveditz](/user_profile?user_id=1689) | [sec-bounty](#a9356328_1689 "11 months ago") | + |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | sec-bounty | + |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | sec-bounty-hof |  |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (2 files)

| [fxios\_url\_bar\_spoofing.gif](/attachment.cgi?id=9378117)  [11 months ago](#c0)  [Muneaki Nishimura](/user_profile?user_id=507051)   1.79 MB, image/gif |  | [Details](/attachment.cgi?id=9378117&action=edit) |
| --- | --- | --- |
| [advisory.txt](/attachment.cgi?id=9406710)  [7 months ago](#c6)  [mreagan](/user_profile?user_id=734598)   230 bytes, text/plain |  | [Details](/attachment.cgi?id=9406710&action=edit) |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Muneaki Nishimura](/user_profile?user_id=507051)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1878489#c0)• 11 months ago |
|  | |

Attached image
[fxios\_url\_bar\_spoofing.gif](attachment.cgi?id=9378117)
— [Details](attachment.cgi?id=9378117&action=edit)

When you scroll a page vertically, the URL bar is automatically hidden. And when you open a new window in this condition, the URL bar in the new window is sometimes kept hidden as well.

If the page content opened in the new window is long enough, the URL bar will reappear as you repeatedly scroll up and down. However, if the content is short, the URL bar is never displayed again until the page is reloaded.

This behavior can be abused for showing a fake address bar.

There are two ways to reproduce this attack scenario. One is easy but unstable, the other one requires some steps but stable.

Reproduction case #1 (unstable)

(1) Visit <https://csrf.jp/2024/fxios-url-spoofing/>

(2) Scroll down the page and tap the "Open Google" button

(3) Fake Google login page is shown in new tab but the address bar says this is "www.google.com"

Reproduction case #2 (stable)

(1) Visit <https://csrf.jp/2024/fxios-url-spoofing/open_new_window.php>

(2) Scroll down the page and long tap the text link

(3) Tap "Open New Tab" and "Switch"

(4) Fake Google login page is shown in new tab but the address bar says this is "www.google.com"

Flags: sec-bounty?

|  | [Sergey Galich [:serg]](/user_profile?user_id=691597) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1878489#a23735_691597)• 11 months ago |

Group: firefox-core-security → mobile-core-securityComponent: Security → BrowserProduct: Firefox → Firefox for iOS

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1878489#c1)• 11 months ago |
|  | |

I haven't verified this, but the spoof looks convincing from the movie.

Keywords: [csectype-spoof](/buglist.cgi?keywords=csectype-spoof&resolution=---),
[sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

|  | [lmarceau](/user_profile?user_id=694570) |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1878489#c2)• 11 months ago |
|  | |

For context, there's a rework project in the pipeline to redo the whole URL bar/toolbar area. I shared this ticket with the responsible engineer working on that project, as this could be fixed at the same time.

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1878489#a7446454_159069)• 9 months ago |

See Also: → <https://mozilla-hub.atlassian.net/browse/FXIOS-8928>

|  | [mreagan](/user_profile?user_id=734598) |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1878489#c3)• 9 months ago |
|  | |

PR <https://github.com/mozilla-mobile/firefox-ios/pull/20014> has been merged; the fix will target v127 release of Firefox iOS.

|  | [Muneaki Nishimura](/user_profile?user_id=507051)  Reporter |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1878489#c4)• 8 months ago |
|  | |

Thanks for the correction. I confirmed that it has been correctly fixed.

|  | [mreagan](/user_profile?user_id=734598) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1878489#a8753763_734598)• 8 months ago |

Status: NEW → RESOLVEDClosed: 8 months agoResolution: --- → FIXED

|  | [mreagan](/user_profile?user_id=734598) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1878489#a8753947_734598)• 8 months ago |

[tracking-fxios](/buglist.cgi?f1=cf_tracking_fxios&o1=isnotempty):
--- → [127](/buglist.cgi?f1=cf_tracking_fxios&o1=equals&v1=127)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1878489#a8754227_1689)• 8 months ago |

Group: mobile-core-security → core-security-release

|  | [Andrei Bodea[:andrei]](/user_profile?user_id=616105) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1878489#c5)• 8 months ago |
|  | |

Verified as fixed on v127 (41813) with iPhone 13 Pro (15.7.1).

For both cases present in the description I was able to verify that the original and iOS toolbar is correctly displayed at the top.

Status: RESOLVED → VERIFIED

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1878489#a9355910_1689)• 8 months ago |

See Also: → <https://github.com/mozilla-mobile/firefox-ios/pull/20014>

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1878489#a9356328_1689)• 8 months ago |

Flags: sec-bounty? → sec-bounty+

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1878489#a10133522_5898)• 8 months ago |

Keywords: [reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)

|  | [mreagan](/user_profile?user_id=734598) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1878489#c6)• 7 months ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9406710)
— [Details](attachment.cgi?id=9406710&action=edit)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1878489#a11344449_1689)• 7 months ago |

Alias: CVE-2024-38313

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1878489#a26202587_1689)• 1 month ago |

Group: core-security-release
You need to [log in](/show_bug.cgi?id=1878489&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Muneaki Nishimura](/user_profile?user_id=507051)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review

