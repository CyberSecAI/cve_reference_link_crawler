- **Root cause of vulnerability**: The Vilo router's hostname, configurable through the Vilo app, is directly inserted into a `udhcpc` command executed using C's `system()` function, without proper sanitization. This allows for command injection by setting the hostname to a malicious string.
- **Weaknesses/vulnerabilities present**:
  - Command injection vulnerability due to unsanitized user input being passed to `system()`
  - Lack of input validation or sanitization on the Vilo name field
- **Impact of exploitation**:
  - Arbitrary code execution as root on the underlying operating system of the Vilo router.
  - An attacker can gain complete control of the device by injecting malicious commands
- **Attack vectors**:
  - Network-based attack by exploiting the Vilo app functionality to change the router's name
  - Physical access can be leveraged for debugging through UART, which provides visibility into executed commands.
- **Required attacker capabilities/position**:
  - An attacker needs to have access to the Vilo app and be able to modify the Vilo router name setting.
  - The attacker must know how to exploit a command injection vulnerability.
- **Additional details**:
   - The command injection has a 32-character limit. This limitation can be bypassed by performing multiple injections to construct and execute more complex commands.
   - The vulnerability exists because the Vilo name is used within a `udhcpc` command string that is passed to the `system()` function.
   - The `sysconf` binary executes the vulnerable `udhcpc` command at boot.
   - The provided steps to reproduce details how to create and execute a shell script after multiple injections.