- **Root cause of vulnerability**: A missing bounds check in the `tif_processing_dng_channel_count` function when processing a malformed TIFF file leads to a stack-based buffer overflow. Specifically, the `max_loop` variable, derived from the `SamplesPerPixel` tag and controlled by the attacker, determines the number of writes to a fixed-size stack buffer, causing it to overflow.
- **Weaknesses/vulnerabilities present**: Stack-based buffer overflow (CWE-121) due to a missing bounds check when writing to the stack.
- **Impact of exploitation**: Memory corruption leading to a crash. The report mentions the stack being overwritten with a constant value, which indicates the possibility for code execution by overwriting return addresses or other critical data on the stack.
- **Attack vectors**: A specially crafted, malicious TIFF file.
- **Required attacker capabilities/position**: The attacker needs the ability to provide a malicious TIFF file to be processed by the vulnerable application. The attacker can fully control the amount of writes performed in the stack, by manipulating the `SamplesPerPixel` tag, as long as the `DNGVersion` and `SubIFDs` tags are also present.