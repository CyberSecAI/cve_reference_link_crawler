- **Root cause of vulnerability:** The `DelL2tpLNSList` function in the H3C GR-1200W router firmware uses the `snprintf` function to format the user-controlled `param` parameter and then passes the result to the `system` function without proper sanitization.
- **Weaknesses/vulnerabilities present:** Command injection vulnerability. The router is vulnerable to command injection due to the lack of proper input validation on the `param` parameter, which allows an attacker to inject and execute arbitrary shell commands.
- **Impact of exploitation:** An attacker can execute arbitrary commands on the router with root privileges, potentially leading to complete system compromise, data exfiltration, or denial of service.
- **Attack vectors:** The attack vector is via an HTTP POST request to the `/goform/aspForm` endpoint with the `CMD` parameter set to `DelL2tpLNSList` and the `param` parameter containing the malicious payload.
- **Required attacker capabilities/position:** The attacker needs to be able to send HTTP requests to the router's web interface. The attacker must also have knowledge of the vulnerable endpoint and how to form a valid request.