Meeting Owl

Versioning

Disclosure Timeline

CVEs

Credits

▪
▪
▪
▪
▪
▪

Contents

1 Overview

1.1 Management Summary

1.2 Extended Summary

2 Background

2.1 System Overview

▪
▪
▪
▪
▪

BarnComms

BarnClientService

WhiteboardSharingService

BarnClientService

2.2 Extracting Firmware Updates

Documents/XXXXXX_otaUpdate_2

payload.bin

sudo losetup -Pf system.img

losetup -l | grep system.img

sudo mount /dev/dev/loop4 /mnt/loop

loop4

/mnt/loop

/mnt/loop

system/privapps/

grep -r "com.owllabs"

bin/meetingOwl

1 payload_dumper_tool_by_ius.zip -
https://drive.google.com/file/d/1QpsywAbNroDKEDz4TytQl8UlK6v2gJSi/view - last
visited 2021-12-08
2 How to Extract Android OTA Payload.bin File - https://www.thecustomdroid.com/how-
to-extract-android-payload-bin-file/ - last visited 2021-12-08
3 JADX - https://github.com/skylot/jadx – last visited 2021-12-08

3 Findings

3.1 On Device/Local

3.1.1 AP / Tethering Mode with Hardcoded Credentials

Summary

Requirements

Details

192.168.108.66

-a

{"c":150}

39D6B333-ADAD-

45C8-B6EE-EAC6C4CD0101

-a

192.168.43.1

traceroute

traceroute

Recommendation

3.1.2 In Access Point Mode, the Internal Switchboard Port Is Exposed

Summary

Requirements

Details

nmap

-a

Recommendation

3.1.3 The Passcode Is Not Required for Bluetooth Commands

Summary

Requirements

Details

Recommendation

3.1.4 Hardcoded Backdoor Passcode

Summary

Requirements

Details

XXXXa884588XXXX

Recommendation

3.1.5 Deactivation of Passcode Without Authentication

Summary

Requirements

Details

{"c":"11","v":{"p":"<HASH>","reset":0}}

p

{"c":"11","v":{"p":"","reset":1}}

reset

–r

Recommendation

3.1.6 Passcode Hash Can Be Retrieved via Bluetooth

Summary

Requirements

Details

39D6B333-ADAD-45C8-B6EE-EAC6C4CD0101

{"c":10}

39D6B333-ADAD-45C8-B6EE-EAC6C4CD0001

1

2

3

4

5

6

7

8

9

$ hashcat -O -m 100 -a 3 hash-1234.txt "?d?d?d?d"

hashcat (v6.1.1) starting...

[...]

7110eda4d09e062aa5e4a390b0a572ac0d2c0220:1234

Session..........: hashcat

Status...........: Cracked

Hash.Name........: SHA1

Hash.Target......: 7110eda4d09e062aa5e4a390b0a572ac0d2c0220

10  Time.Started.....: Wed Apr  7 10:53:07 2021 (0 secs)

11  Time.Estimated...: Wed Apr  7 10:53:07 2021 (0 secs)

12  Guess.Mask.......: ?d?d?d?d [4]

13  Guess.Queue......: 1/1 (100.00%)

14  Speed.#1.........:  5100.1 kH/s (0.20ms) @ Accel:1024 Loops:10 Thr:1 Vec:8

15  Recovered........: 1/1 (100.00%) Digests

16  Progress.........: 10000/10000 (100.00%)

17  Rejected.........: 0/10000 (0.00%)

18  Restore.Point....: 0/1000 (0.00%)

19  Restore.Sub.#1...: Salt:0 Amplifier:0-10 Iteration:0-10

20  Candidates.#1....: 1234 -> 6764

21

22  Started: Wed Apr  7 10:53:05 2021

23  Stopped: Wed Apr  7 10:53:09 2021

Recommendation

3.1.7 Potential Copyright Infringement

Summary

Requirements

Details

media/Owllabs

10-8.wav

Recommendation

3.2 Backend Infrastructure

3.2.1 Excessive Lifetime for Client Keys

Summary

Requirements

Details

1

2

3

4

5

6

7

8

9

POST / HTTP/1.1

Host: fingerprint.owllabs.com

User-Agent: okhttp/3.0.0

Accept-Encoding: gzip, deflate

Accept: */*

Connection: close

version: 1

Content-Length: 119

Content-Type: application/json

10  Authorization: Basic XXXX

11

12  {"mac_address": "BC:D7:13:82:81:F7", "fingerprint":

"fbb31617e1752a6298ff67ce0febc461fa3fb6739641cbab519878b22fbffb2e"}

1

2

3

4

5

6

7

8

9

Certificate:

    Data:

        Version: 3 (0x2)

        Serial Number:

            53:4c:a5:0b:09:8f:3a:a5:51:d3:58:13:97:88:0e:d1:2f:74:49:c6

        Signature Algorithm: sha256WithRSAEncryption

        Issuer: OU = Amazon Web Services O=Amazon.com Inc. L=Seattle

ST=Washington C=US

        Validity

            Not Before: Apr  1 12:01:32 2021 GMT

10              Not After : Dec 31 23:59:59 2049 GMT

11          Subject: CN = AWS IoT Certificate

openssl

openssl

Recommendation

4 The Legion of the BouncyCastle: https://www.bouncycastle.org/java.html – last
accessed 2021-10-25

3.2.2 Access to MQTT Server Has No Authorization Mechanism

Summary

Requirements

Details

Recommendation

3.2.3 The MQTT Broker Is Disclosing PINs for the Whiteboard Sharing

Sessions to All Connected Clients

Summary

Requirements

Details

Recommendation

3.2.4 Arbitrary File Upload to AWS S3 Bucket

Summary

Requirements

Details

com.owllabs.wbimg.encryption.production

Recommendation

5 Amazon S3 pricing - https://aws.amazon.com/s3/pricing/ - last visited 2021-12-08

3.3 User-Facing Infrastructure

3.3.1 Barn API Returns Customer’s Data When Provided a Software

Serial

Summary

Requirements

Details

▪
▪
▪
▪
▪

1

2

3

4

5

6

1

2

3

4

GET /devices/d49XXXX/registrations HTTP/1.1

Host: api.barn.owllabs.com

Authorization: Basic XXX

User-Agent: curl/7.68.0

Accept: */*

Connection: close

HTTP/1.1 200 OK

Content-Type: application/json; charset=utf-8

Date: Fri, 10 Sep 2021 14:46:07 GMT

ETag: W/"714-j/ho0Vu5MHkxMbjj/MhqsNducvs"

5

6

7

8

9

Server: nginx/1.16.1

Vary: Accept-Encoding

X-Powered-By: Express

Content-Length: 1812

Connection: Close

10

11  {

12    "id": "120870",

13    "DeviceUUID": "c1xuyXXXXXX",

14    "DeviceHardwareSerial": "XXXXXX203110",

15    "source": "1",

16    "createdAt": "2021-04-02T08:33:43.693Z",

17    […]

18    "User": {

19      "id": "83766",

20      "name": "Peter ",

21      "email": "Peter@XXXXXXX.XX",

22      […]

23      "UserCompany": {

24        "id": "51573",

25        "name": "XXXXXX ",

26        "domains": "XXXXXXX.se",

27        […]

28      }

29    },

30    "Device": {

31      "softwareVersion": 2050009,

32      […]

33      "alias": "Peter",

34      "serial": "XXXXXX23",

35      "hardwareSerial": "XXXXXX203110",

36      […]

37      "macAddress": "BC:D7:13:82:89:43",

38      […]

39      "activated": "2021-04-02T08:34:58.314Z",

40      "checkedInAt": "2021-04-09T06:52:02.953Z",

41      […]

42      "lastIP": "90.228.XXX.XXX",

43      "lastLocation": {

44        "type": "Point",

45        "coordinates": [

46          18.XXXX,

47          59.XXXX

48        ]

49      },

50      "lastGeo": "Nacka|AB|SE|18.XXXX|59.XXXX|CEST",

51      […]

52      "Product": {

53        "id": "9",

54        "name": "Meeting Owl Pro",

55        "description": "Meeting Owl Pro",

56        "sku": "OWLV2",

57        "settings": {},

58        "createdAt": "2019-06-24T15:18:21.000Z",

59        […]

60      }

61    },

62    "DeviceSerial": "D49XXXX"

63  }

Recommendation

3.3.2 Public API Returns Owl's Name and Company

Summary

Requirements

Details

1

2

3

4

5

6

7

8

9

GET /transfer/find/serial/M2FN45XXXXXX HTTP/1.1

Host: api.nest.owllabs.com

User-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:87.0) Gecko/20100101

Firefox/87.0

Accept: application/json

Accept-Language: en-US,en;q=0.5

Accept-Encoding: gzip, deflate

xsrf-token: Failxt18-jiRxfrpa9gPPIA48rJybnFDlXKk

X-XSRF-TOKEN: Failxt18-jiRxfrpa9gPPIA48rJybnFDlXKk

Origin: https://nest.owllabs.com

10  Connection: close

11  Referer: https://nest.owllabs.com/

12  Cookie: _ga_LDXFPF3FCH=XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX;

_ga=XXXXXXXXXXXXXXXXXXXXXXXXXXX; connect.sid=XXX;

mp_c960a779916a2fb9109173b103dfe9f7_mixpanel=YYY; XSRF-TOKEN=ZZZZZ

1
2
3
4
5
6
7
8
9

HTTP/1.1 200 OK
Access-Control-Allow-Credentials: true
Access-Control-Allow-Origin: https://nest.owllabs.com
Access-Control-Expose-Headers: x-xsrf-token,XSRF-TOKEN
Content-Type: application/json; charset=utf-8
Date: Fri, 09 Apr 2021 11:09:50 GMT
ETag: W/"48-RuXcb341HVzMt732wZeKTA2+8ps"
Server: nginx/1.14.1
Set-Cookie: XSRF-TOKEN=HJJqtbQw-r3lTFd1b6WWGIvgLsG0u2bD2PeA;
Domain=nest.owllabs.com; Path=/; Secure

10  Vary: Origin
11  X-Powered-By: Express
12  XSRF-TOKEN: HJJqtbQw-r3lTFd1b6WWGIvgLsG0u2bD2PeA
13  Content-Length: 72
14  Connection: Close
15
16  {"source":"1","name":"Peter","company_name":"Owl labs","company_id":"1"}

Recommendation

4 Leak of Device Details

4.1 YouTube and Google

▪

▪

▪

▪

4.2 Owl Labs Infrastructure

<head>

1

2

3

4

5

6

7

8

9

[

  {

    "softwareVersionString": "2.9.0.0",

    […]

    "alias": "Collards-Owl",

    "serial": "XXXXX05b",

    "hardwareSerial": "XXXXX7106O",

    "uuid": "xpNxlPFOyK4",

   […]

10      "UserDeviceRegistration": {

11        "id": 636,

12        […]

13        "User": {

14          "id": 598,

15          "name": "Jeremy XXXX",

16          "email": "jeremy@XXXXXX", […]

6 Screenshot of the companion app revealing a software serial -
https://d33v4339jhl8k0.cloudfront.net/docs/assets/5e45cc562c7d3a7e9ae7b957/images/5
eb03a512c7d3a5ea54a6aff/img-12266-1588356826-490876084.jpg – last visited 2021-12-
09

5 Appendix

5.1 Disclosure Details

▪
▪

▪

▪

▪

▪

▪

▪

