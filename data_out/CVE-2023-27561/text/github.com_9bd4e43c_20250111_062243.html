
[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fopencontainers%2Frunc%2Fissues%2F3751)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fopencontainers%2Frunc%2Fissues%2F3751)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=opencontainers%2Frunc)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[opencontainers](/opencontainers)
/
**[runc](/opencontainers/runc)**
Public

* [Notifications](/login?return_to=%2Fopencontainers%2Frunc) You must be signed in to change notification settings
* [Fork
  2.1k](/login?return_to=%2Fopencontainers%2Frunc)
* [Star
   12k](/login?return_to=%2Fopencontainers%2Frunc)

* [Code](/opencontainers/runc)
* [Issues
  278](/opencontainers/runc/issues)
* [Pull requests
  86](/opencontainers/runc/pulls)
* [Discussions](/opencontainers/runc/discussions)
* [Actions](/opencontainers/runc/actions)
* [Projects
  0](/opencontainers/runc/projects)
* [Wiki](/opencontainers/runc/wiki)
* [Security](/opencontainers/runc/security)
* [Insights](/opencontainers/runc/pulse)

Additional navigation options

* [Code](/opencontainers/runc)
* [Issues](/opencontainers/runc/issues)
* [Pull requests](/opencontainers/runc/pulls)
* [Discussions](/opencontainers/runc/discussions)
* [Actions](/opencontainers/runc/actions)
* [Projects](/opencontainers/runc/projects)
* [Wiki](/opencontainers/runc/wiki)
* [Security](/opencontainers/runc/security)
* [Insights](/opencontainers/runc/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fopencontainers%2Frunc%2Fissues%2Fnew%2Fchoose)

By clicking ‚ÄúSign up for GitHub‚Äù, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We‚Äôll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fopencontainers%2Frunc%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# CVE-2019-19921 re-introduction/regression #3751

Closed

[Beuc](/Beuc) opened this issue
Feb 24, 2023
¬∑ 11 comments
 ¬∑ Fixed by [#3773](https://github.com/opencontainers/runc/pull/3773) or [kubernetes-sigs/vsphere-csi-driver#2326](https://github.com/kubernetes-sigs/vsphere-csi-driver/pull/2326)

Closed

# [CVE-2019-19921 re-introduction/regression](#top) #3751

[Beuc](/Beuc) opened this issue
Feb 24, 2023
¬∑ 11 comments
 ¬∑ Fixed by [#3773](https://github.com/opencontainers/runc/pull/3773) or [kubernetes-sigs/vsphere-csi-driver#2326](https://github.com/kubernetes-sigs/vsphere-csi-driver/pull/2326)

Labels
[kind/bug](/opencontainers/runc/labels/kind/bug)
[regression](/opencontainers/runc/labels/regression)

## Comments

[![@Beuc](https://avatars.githubusercontent.com/u/980977?s=80&u=ebd1a7b491cae0a6c408db9296b6739bd5c423ad&v=4)](/Beuc)

Copy link

### **[Beuc](/Beuc)** commented [Feb 24, 2023](#issue-1599144908)

| Hi,  I'm part of the Debian Long Term Support (LTS) team, and I'm currently working on an update for package [runc](https://security-tracker.debian.org/tracker/source-package/runc).  As explained in [#2197 (comment)](https://github.com/opencontainers/runc/issues/2197#issuecomment-1437617334) , while working on fixing [CVE-2019-19921](https://github.com/advisories/GHSA-fh74-hm69-rqjw "CVE-2019-19921"), I noticed the fix was apparently broken by the one for [CVE-2021-30465](https://github.com/advisories/GHSA-c3xm-pvg7-gh7r "CVE-2021-30465") ([0ca91f4](https://github.com/opencontainers/runc/commit/0ca91f44f1664da834bc61115a849b56d22f595f)).  I can reproduce the issue with branch `main`, using the [original reproducer](https://gist.github.com/LiveOverflow/c937820b688922eb127fb760ce06dab9) from [#2197](https://github.com/opencontainers/runc/issues/2197) (host's `proc/sys/kernel/core_pattern` overwritten from `container-2` after a few tries).  Because various GNU/Linux distributions have incorporated the initial fix (or upgraded runc), and marked the security issue "fixed", I would recommend registering a new CVE to indicate that a follow-up fix is needed. Do you confirm?  Thanks and best regards. |
| --- |
| The text was updated successfully, but these errors were encountered: |

All reactions

[![@thaJeztah](https://avatars.githubusercontent.com/u/1804568?s=80&u=ebc86d007fefd2b388d2a8da5f0e3d6f239ede2f&v=4)](/thaJeztah)

Copy link

Member

### **[thaJeztah](/thaJeztah)** commented [Feb 24, 2023](#issuecomment-1444275304)

| /cc [@samuelkarp](https://github.com/samuelkarp) @opencontainers/runc-maintainers |
| --- |

All reactions

Sorry, something went wrong.

[![@AkihiroSuda](https://avatars.githubusercontent.com/u/9248427?s=40&v=4)](/AkihiroSuda)
[AkihiroSuda](/AkihiroSuda)
added
[kind/bug](/opencontainers/runc/labels/kind/bug)
[regression](/opencontainers/runc/labels/regression)
labels
[Mar 1, 2023](#event-8635524350)

[![@carnil](https://avatars.githubusercontent.com/u/773068?s=80&u=54a9fd1cfc2b1abb34a487f17e07eb8a03cecdae&v=4)](/carnil)

Copy link

### **[carnil](/carnil)** commented [Mar 4, 2023](#issuecomment-1454756961)

| [CVE-2023-27561](https://www.cve.org/CVERecord?id=CVE-2023-27561) is the new CVE. |
| --- |

All reactions

Sorry, something went wrong.

[![@AkihiroSuda](https://avatars.githubusercontent.com/u/9248427?s=80&v=4)](/AkihiroSuda)

Copy link

Member

### **[AkihiroSuda](/AkihiroSuda)** commented [Mar 4, 2023](#issuecomment-1454757846)

| Thank you for reporting this, but next time please follow <https://github.com/opencontainers/runc/blob/main/SECURITY.md> before disclosure. |
| --- |

 üëç
1
 Kyslik reacted with thumbs up emoji

All reactions

* üëç
  1 reaction

Sorry, something went wrong.

[![@AkihiroSuda](https://avatars.githubusercontent.com/u/9248427?s=80&v=4)](/AkihiroSuda)

Copy link

Member

### **[AkihiroSuda](/AkihiroSuda)** commented [Mar 4, 2023](#issuecomment-1454886649) ‚Ä¢ edited Loading

| Trying to follow the repro steps in <https://gist.github.com/LiveOverflow/c937820b688922eb127fb760ce06dab9> , but still I ~~can't repro locally.~~ (**EDIT**: reproducible on Ubuntu too, after attempting hundreds of times)  Tested the current main branch [69225fa](https://github.com/opencontainers/runc/commit/69225fa9199431bf3656766c8a1274473e4bb923) and v1.1.4, on Ubuntu 22.10 (kernel 5.19.0-31-generic), amd64. |
| --- |

All reactions

Sorry, something went wrong.

[![@AkihiroSuda](https://avatars.githubusercontent.com/u/9248427?s=40&v=4)](/AkihiroSuda)
[AkihiroSuda](/AkihiroSuda)
added
the
[status/needs-more-information](/opencontainers/runc/labels/status/needs-more-information)
label
[Mar 4, 2023](#event-8666790685)

[![@AkihiroSuda](https://avatars.githubusercontent.com/u/9248427?s=80&v=4)](/AkihiroSuda)

Copy link

Member

### **[AkihiroSuda](/AkihiroSuda)** commented [Mar 4, 2023](#issuecomment-1454899437) ‚Ä¢ edited Loading

| Seems reproducible on Debian 11 (kernel 5.10.0-21-amd64). Maybe related to the kernel version? (**EDIT**: reproducible on Ubuntu too, after attempting hundreds of times) |
| --- |

All reactions

Sorry, something went wrong.

[![@AkihiroSuda](https://avatars.githubusercontent.com/u/9248427?s=40&v=4)](/AkihiroSuda)
[AkihiroSuda](/AkihiroSuda)
removed
the
[status/needs-more-information](/opencontainers/runc/labels/status/needs-more-information)
label
[Mar 4, 2023](#event-8666882874)

[![@g0dA](https://avatars.githubusercontent.com/u/17951763?s=80&u=742a4c56b6fc00d6ef4a9a182948c2bd9f59ce42&v=4)](/g0dA)

Copy link

### **[g0dA](/g0dA)** commented [Mar 5, 2023](#issuecomment-1454994181)

| No, I don't think it has anything to do with the kernel version, it's just because SYS\_renameat2 was successfully executed through competition before the execution of readonlyPath()   1. Delay the execution of readonlyPath() by modifying the source code 2. Executing SYS\_renameat2 twice can successfully reproduce |
| --- |

All reactions

Sorry, something went wrong.

[![@g0dA](https://avatars.githubusercontent.com/u/17951763?s=80&u=742a4c56b6fc00d6ef4a9a182948c2bd9f59ce42&v=4)](/g0dA)

Copy link

### **[g0dA](/g0dA)** commented [Mar 5, 2023](#issuecomment-1454997320)

| Ps. Add the test steps that I did not modify the code  v1.1.4, on Arch(kernel 6.1.9-arch1-1) follow the repro steps in <https://gist.github.com/LiveOverflow/c937820b688922eb127fb760ce06dab9>   1. run pwn in container-1 2. then create container-2 in other shell  ``` for i in {0..150} sudo runc create test-${i}  ```  3. runc list  ``` ID            PID         STATUS      BUNDLE                                    CREATED                          OWNER container-1   3094        created     /home/lang/Desktop/seccheck/container-1   2023-03-05T04:41:32.637528085Z   root test-132      11887       created     /home/lang/Desktop/seccheck/container-2   2023-03-05T05:35:55.707083185Z   root test-137      11972       created     /home/lang/Desktop/seccheck/container-2   2023-03-05T05:35:55.822176563Z   root test-33       0           stopped     /home/lang/Desktop/seccheck/container-2   2023-03-05T05:35:53.207528822Z   root test-82       0           stopped     /home/lang/Desktop/seccheck/container-2   2023-03-05T05:35:54.477270492Z   root test-96       0           stopped     /home/lang/Desktop/seccheck/container-2   2023-03-05T05:35:54.831671262Z   root  ```  There are two things to note:   1. The permissions of /tmp/poc will cause SYS\_renameat2 to fail 2. The continuous operation of pwn will affect the already created container-2 to fail |
| --- |

All reactions

Sorry, something went wrong.

[![@AkihiroSuda](https://avatars.githubusercontent.com/u/9248427?s=40&v=4)](/AkihiroSuda)
[AkihiroSuda](/AkihiroSuda)
mentioned this issue
[Mar 6, 2023](#ref-pullrequest-1610531203)

[rootfs: prohibit symlinks that conflicts with `readonlyPaths` and/or `maskedPaths` to prevent CVE-2023-27561
#3756](/opencontainers/runc/pull/3756)
 Closed

[![@AkihiroSuda](https://avatars.githubusercontent.com/u/9248427?s=80&v=4)](/AkihiroSuda)

Copy link

Member

### **[AkihiroSuda](/AkihiroSuda)** commented [Mar 6, 2023](#issuecomment-1455331587) ‚Ä¢ edited Loading

| PR:   * [rootfs: prohibit symlinks that conflicts with `readonlyPaths` and/or `maskedPaths` to prevent CVE-2023-27561¬†#3756](https://github.com/opencontainers/runc/pull/3756)   **EDIT**: replaced by   * [Prohibit /proc and /sys to be symlinks¬†#3773](https://github.com/opencontainers/runc/pull/3773) |
| --- |

All reactions

Sorry, something went wrong.

[![@ssst0n3](https://avatars.githubusercontent.com/u/16935049?s=80&u=e6179f68a9fbe99f4fd2cbe80211efb0862769b4&v=4)](/ssst0n3)

Copy link

### **[ssst0n3](/ssst0n3)** commented [Mar 6, 2023](#issuecomment-1455713526)

| Why there's no advisory under <https://github.com/opencontainers/runc/security/advisories> ? |
| --- |

All reactions

Sorry, something went wrong.

[![@AkihiroSuda](https://avatars.githubusercontent.com/u/9248427?s=80&v=4)](/AkihiroSuda)

Copy link

Member

### **[AkihiroSuda](/AkihiroSuda)** commented [Mar 6, 2023](#issuecomment-1455729550) ‚Ä¢ edited Loading

| Why there's no advisory under <https://github.com/opencontainers/runc/security/advisories> ?  Because the CVE was published by somebody outside us, and we haven't released the fix (~~[#3756](https://github.com/opencontainers/runc/pull/3756)~~ [#3773](https://github.com/opencontainers/runc/pull/3773)) yet. |
| --- |

All reactions

Sorry, something went wrong.

[![@johnsonjh](https://avatars.githubusercontent.com/u/61629094?s=40&v=4)](/johnsonjh)
[johnsonjh](/johnsonjh)
mentioned this issue
[Mar 9, 2023](#ref-issue-1610474098)

[CVE-2023-27561 (High) detected in github.com/opencontainers/runc-v1.1.4
johnsonjh/gfpsgo#164](/johnsonjh/gfpsgo/issues/164)

Closed

[![@alexeykiselev](https://avatars.githubusercontent.com/u/374639?s=40&v=4)](/alexeykiselev)
[alexeykiselev](/alexeykiselev)
mentioned this issue
[Mar 9, 2023](#ref-pullrequest-1616667907)

[Version of runc updated to 1.1.5
wavesplatform/gowaves#1047](/wavesplatform/gowaves/pull/1047)
 Merged

[![@kolyshkin](https://avatars.githubusercontent.com/u/4522509?s=40&v=4)](/kolyshkin)
[kolyshkin](/kolyshkin)
mentioned this issue
[Mar 16, 2023](#ref-pullrequest-1628480308)

[Prohibit /proc and /sys to be symlinks
#3773](/opencontainers/runc/pull/3773)
 Merged

[![@AkihiroSuda](https://avatars.githubusercontent.com/u/9248427?s=40&v=4)](/AkihiroSuda)
[AkihiroSuda](/AkihiroSuda)
closed this as [completed](/opencontainers/runc/issues?q=is%3Aissue+is%3Aclosed+archived%3Afalse+reason%3Acompleted)
in
[#3773](/opencontainers/runc/pull/3773)
[Mar 25, 2023](#event-8845428646)

[![@thaJeztah](https://avatars.githubusercontent.com/u/1804568?s=40&u=ebc86d007fefd2b388d2a8da5f0e3d6f239ede2f&v=4)](/thaJeztah)
[thaJeztah](/thaJeztah)
mentioned this issue
[Mar 25, 2023](#ref-pullrequest-1640540101)

[[1.1 backport] Prohibit /proc and /sys to be symlinks
#3785](/opencontainers/runc/pull/3785)
 Merged

[![@Beuc](https://avatars.githubusercontent.com/u/980977?s=80&u=ebd1a7b491cae0a6c408db9296b6739bd5c423ad&v=4)](/Beuc)

Copy link

Author

### **[Beuc](/Beuc)** commented [Mar 25, 2023](#issuecomment-1483864716)

| Works for me (behavior back to `filesystem \\\\\\\"proc\\\\\\\" must be mounted on ordinary directory`), thanks! |
| --- |

All reactions

Sorry, something went wrong.

[![@mpatlasov](https://avatars.githubusercontent.com/u/8080263?s=40&v=4)](/mpatlasov)
[mpatlasov](/mpatlasov)
mentioned this issue
[Apr 5, 2023](#ref-pullrequest-1654763167)

[Fix [CVE-2023-27561](https://github.com/advisories/GHSA-vpvm-3wq2-2wvm)
kubernetes-sigs/vsphere-csi-driver#2326](/kubernetes-sigs/vsphere-csi-driver/pull/2326)
 Merged

[![@eshafaq1](https://avatars.githubusercontent.com/u/133929829?s=40&v=4)](/eshafaq1)
[eshafaq1](/eshafaq1)
mentioned this issue
[Aug 10, 2023](#ref-issue-1840569317)

[gosu binary Vuln with thirdparty github.com/opencontainers/runc (CVE-2023-27561)
tianon/gosu#130](/tianon/gosu/issues/130)

Closed

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fopencontainers%2Frunc%2Fissues%2F3751)

Assignees

No one assigned

Labels

[kind/bug](/opencontainers/runc/labels/kind/bug)
[regression](/opencontainers/runc/labels/regression)

Projects

None yet

Milestone

No milestone

Development

Successfully merging a pull request may close this issue.

 [Prohibit /proc and /sys to be symlinks](/opencontainers/runc/pull/3773)
 [kolyshkin/runc](/kolyshkin/runc)

 [Fix [CVE-2023-27561](https://github.com/advisories/GHSA-vpvm-3wq2-2wvm)](/kubernetes-sigs/vsphere-csi-driver/pull/2326)
 [mpatlasov/vmware-vsphere-csi-driver](/mpatlasov/vmware-vsphere-csi-driver)

 [rootfs: prohibit symlinks that conflicts with `readonlyPaths` and/or `maskedPaths` to prevent CVE-2023-27561](/opencontainers/runc/pull/3756)
 [AkihiroSuda/runc](/AkihiroSuda/runc)

6 participants

[![@carnil](https://avatars.githubusercontent.com/u/773068?s=52&v=4)](/carnil) [![@Beuc](https://avatars.githubusercontent.com/u/980977?s=52&v=4)](/Beuc) [![@thaJeztah](https://avatars.githubusercontent.com/u/1804568?s=52&v=4)](/thaJeztah) [![@AkihiroSuda](https://avatars.githubusercontent.com/u/9248427?s=52&v=4)](/AkihiroSuda) [![@ssst0n3](https://avatars.githubusercontent.com/u/16935049?s=52&v=4)](/ssst0n3) [![@g0dA](https://avatars.githubusercontent.com/u/17951763?s=52&v=4)](/g0dA)

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.

