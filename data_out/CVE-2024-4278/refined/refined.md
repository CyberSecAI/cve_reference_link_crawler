**Root cause of vulnerability:**
The vulnerability lies in the way GitLab handles updates to the Dependency Proxy settings, specifically the `mavenExternalRegistryUrl`. Although precautions were in place to prevent direct exposure of the password, they could be bypassed by modifying the URL through the `updateDependencyProxyPackagesSettings` GraphQL mutation, and subsequently triggering a request to the modified URL. The credentials were then sent to the attacker-controlled server.

**Weaknesses/vulnerabilities present:**
- Insecure handling of the Dependency Proxy URL update process.
- Lack of proper validation or sanitization of the `mavenExternalRegistryUrl` during updates.
- Leaking of sensitive information (username and password) in the Authorization header when accessing the dependency proxy with the changed URL.

**Impact of exploitation:**
- Maintainers of a project can leak the Dependency Proxy authentication credentials of the project owners. These credentials include the username and password originally configured for the Dependency Proxy.

**Attack vectors:**
- The attack vector is through the `updateDependencyProxyPackagesSettings` GraphQL mutation by a user with `Maintainer` role.

**Required attacker capabilities/position:**
- The attacker needs to have the Maintainer role within a GitLab project that has the Dependency Proxy enabled.
- The attacker needs to have the ability to make GraphQL requests (e.g. using the GraphQL explorer or through an API call)
- The attacker needs to control a server that can receive the authentication information sent by GitLab when a dependency proxy request is made.
- The attacker needs to know how to trigger a dependency proxy request.