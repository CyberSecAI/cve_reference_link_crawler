

⚲

### Project

### General

### Profile

* [Sign in](/login)
* [Register](/account/register)

* [Home](/)
* [Projects](/projects)
* [Help](https://www.redmine.org/guide)

[Search](/projects/suricata/search?scope=subprojects):

 Suricata[All Projects](/projects?jump=issues)
# Suricata

* [Overview](/projects/suricata)
* [Activity](/projects/suricata/activity)
* [Roadmap](/projects/suricata/roadmap)
* [Issues](/projects/suricata/issues)
* [Wiki](/projects/suricata/wiki)
* [Files](/projects/suricata/files)

### Custom queries

* [8.0.0 Stories](/projects/suricata/issues?query_id=90)
* [Good First Issues](/projects/suricata/issues?query_id=41)
* [OISF community](/projects/suricata/issues?query_id=3)

Actions
Copy link
## Security #7195

closed

### datasets: rule with unset makes suricata abort

Added by [Philippe Antoine](/users/1820) [5 months](/projects/suricata/activity?from=2024-08-01 "08/01/2024 06:44 PM") ago.
Updated [3 months](/projects/suricata/activity?from=2024-10-16 "10/16/2024 06:49 PM") ago.

Status:ClosedPriority:NormalAssignee:[Philippe Antoine](/users/1820)Target version:[8.0.0-beta1](/versions/163 "04/01/2025")
Affected Versions:Label:CVE:[2024-45795](https://nvd.nist.gov/vuln/detail/CVE-2024-45795)Git IDs:

e47598110a557bb9f87ea498d85ba91a45bb0cb6

Severity:HIGHDisclosure Date:

---

**Description**

Running SV datasets-03-set test with added rule
```
diff --git a/tests/datasets-03-set/test.rules b/tests/datasets-03-set/test.rules
index 1d99df9d..327c774a 100644
--- a/tests/datasets-03-set/test.rules
+++ b/tests/datasets-03-set/test.rules
@@ -1 +1,2 @@
 alert dns any any -> any any (dns.query; dataset:set,dns-seen, type string; sid:1;)
+alert dns any any -> any any (dns.query; content: "example"; dataset:unset,dns-seen, type string; sid:2;)

```

triggers the abort in `DetectDatasetBufferMatch` because we get `DETECT_DATASET_CMD_UNSET`

---

**Subtasks**
[1](/issues?parent_id=~7195&set_filter=true&status_id=%2A) (0 open — [1 closed](/issues?parent_id=~7195&set_filter=true&status_id=c))

|  | [Security #7196](/issues/7196): datasets: rule with unset makes suricata abort (7.0.x backport) | Closed | [Philippe Antoine](/users/1820) |  |  |  | Actions |
| --- | --- | --- | --- | --- | --- | --- | --- |

---

**Related issues**
[1](/issues?issue_id=5576&set_filter=true&status_id=%2A) ([1 open](/issues?issue_id=5576&set_filter=true&status_id=o) — 0 closed)

|  | Related to Suricata - [Bug #5576](/issues/5576): Dataset is setting data despite the signature being a complete match | In Review | [Philippe Antoine](/users/1820) |  |  |  | Actions |
| --- | --- | --- | --- | --- | --- | --- | --- |

Related to
Is duplicate of
Has duplicate
Blocks
Blocked by
Precedes
Follows
Copied to
Copied from
Issue #
Delay:  days

Cancel

* [History](/issues/7195?tab=history)
* [Notes](/issues/7195?tab=notes)
* [Property changes](/issues/7195?tab=properties)

ActionsCopy link
[#1](#note-1)
#### Updated by [Philippe Antoine](/users/1820) [5 months](/projects/suricata/activity?from=2024-08-01 "08/01/2024 06:44 PM") ago

* **Related to** *[Bug #5576](/issues/5576): Dataset is setting data despite the signature being a complete match* added

ActionsCopy link
[#2](#note-2)
#### Updated by [OISF Ticketbot](/users/7712) [5 months](/projects/suricata/activity?from=2024-08-01 "08/01/2024 06:45 PM") ago

* **Subtask** *#7196* added

ActionsCopy link
[#3](#note-3)
#### Updated by [OISF Ticketbot](/users/7712) [5 months](/projects/suricata/activity?from=2024-08-01 "08/01/2024 06:45 PM") ago

* **Label** deleted (~~*Needs backport to 7.0*~~)

ActionsCopy link
[#4](#note-4)
#### Updated by [Philippe Antoine](/users/1820) [5 months](/projects/suricata/activity?from=2024-08-01 "08/01/2024 06:52 PM") ago

* **Status** changed from *New* to *In Review*

Gitlab MR

ActionsCopy link
[#5](#note-5)
#### Updated by [Philippe Antoine](/users/1820) [5 months](/projects/suricata/activity?from=2024-08-27 "08/27/2024 12:39 PM") ago

unset support in datasets was half-done.

A fix can be implementing the missing support

Another fix can be to reject such rules for now

ActionsCopy link
[#6](#note-6)
#### Updated by [Victor Julien](/users/4) [4 months](/projects/suricata/activity?from=2024-09-09 "09/09/2024 02:21 PM") ago

* **Severity** changed from *MODERATE* to *HIGH*

HIGH as it requires a bad rule, but then it aborts in defined way.

ActionsCopy link
[#7](#note-7)
#### Updated by [Juliana Fajardini Reichow](/users/6858) [4 months](/projects/suricata/activity?from=2024-09-16 "09/16/2024 05:30 PM") ago

* **CVE** set to *2024-45795*

<https://github.com/OISF/suricata/security/advisories/GHSA-6r8w-fpw6-cp9g>

ActionsCopy link
[#8](#note-8)
#### Updated by [Philippe Antoine](/users/1820) [4 months](/projects/suricata/activity?from=2024-09-24 "09/24/2024 08:36 PM") ago

* **Status** changed from *In Review* to *Resolved*

<https://github.com/OISF/suricata/pull/11815>

ActionsCopy link
[#9](#note-9)
#### Updated by [Philippe Antoine](/users/1820) [4 months](/projects/suricata/activity?from=2024-09-26 "09/26/2024 07:18 PM") ago

Still SV test to merge before closing <https://github.com/OISF/suricata-verify/pull/2065>

ActionsCopy link
[#10](#note-10)
#### Updated by [Philippe Antoine](/users/1820) [3 months](/projects/suricata/activity?from=2024-10-01 "10/01/2024 11:30 AM") ago

* **Git IDs** updated ([diff](/journals/36287/diff?detail_id=36874 "View differences"))

ActionsCopy link
[#11](#note-11)
#### Updated by [Victor Julien](/users/4) [3 months](/projects/suricata/activity?from=2024-10-16 "10/16/2024 07:50 AM") ago

* **Private** changed from *Yes* to *No*

ActionsCopy link
[#12](#note-12)
#### Updated by [Philippe Antoine](/users/1820) [3 months](/projects/suricata/activity?from=2024-10-16 "10/16/2024 06:49 PM") ago

* **Status** changed from *Resolved* to *Closed*

<https://github.com/OISF/suricata-verify/pull/2071>

Actions
Copy link

Also available in: [Atom](/issues/7195.atom)
[PDF](/issues/7195.pdf)

Powered by [Redmine](https://www.redmine.org/) © 2006-2024 Jean-Philippe Lang

Loading...

