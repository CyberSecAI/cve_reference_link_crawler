
[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fte5tb99%2FFor-submitting%2Fwiki%2FCommand-Execution-Vulnerability-in-China-Mobile-Intelligent-Home-Gateway-HG6543C4)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fte5tb99%2FFor-submitting%2Fwiki%2FCommand-Execution-Vulnerability-in-China-Mobile-Intelligent-Home-Gateway-HG6543C4)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fwiki%2Fshow&source=header-repo&source_repo=te5tb99%2FFor-submitting)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[te5tb99](/te5tb99)
/
**[For-submitting](/te5tb99/For-submitting)**
Public

* [Notifications](/login?return_to=%2Fte5tb99%2FFor-submitting) You must be signed in to change notification settings
* [Fork
  0](/login?return_to=%2Fte5tb99%2FFor-submitting)
* [Star
   3](/login?return_to=%2Fte5tb99%2FFor-submitting)

* [Code](/te5tb99/For-submitting)
* [Issues
  0](/te5tb99/For-submitting/issues)
* [Pull requests
  0](/te5tb99/For-submitting/pulls)
* [Discussions](/te5tb99/For-submitting/discussions)
* [Actions](/te5tb99/For-submitting/actions)
* [Projects
  0](/te5tb99/For-submitting/projects)
* [Wiki](/te5tb99/For-submitting/wiki)
* [Security](/te5tb99/For-submitting/security)
* [Insights](/te5tb99/For-submitting/pulse)

Additional navigation options

* [Code](/te5tb99/For-submitting)
* [Issues](/te5tb99/For-submitting/issues)
* [Pull requests](/te5tb99/For-submitting/pulls)
* [Discussions](/te5tb99/For-submitting/discussions)
* [Actions](/te5tb99/For-submitting/actions)
* [Projects](/te5tb99/For-submitting/projects)
* [Wiki](/te5tb99/For-submitting/wiki)
* [Security](/te5tb99/For-submitting/security)
* [Insights](/te5tb99/For-submitting/pulse)

# Command Execution Vulnerability in China Mobile Intelligent Home Gateway HG6543C4

[Jump to bottom](#wiki-pages-box)

01dGu0 edited this page Aug 21, 2023
·
[1 revision](/te5tb99/For-submitting/wiki/Command-Execution-Vulnerability-in-China-Mobile-Intelligent-Home-Gateway-HG6543C4/_history)

Command Execution Vulnerability in China Mobile Intelligent Home Gateway HG6543C4
Device default information:
Equipment model: HG6543C4
Default wireless network name: CMCC-hXtx
Default wireless network password: f6qgriu4
Default terminal configuration address: 192.168.1.1
Default terminal configuration account: dr7u2tvn
Command execution POC: <http://192.168.1.1/cgi-bin/shortcut_telnet.cgi?whoami>
![image](https://private-user-images.githubusercontent.com/48084662/261969413-f75ce133-f84d-4ed7-996b-2198548176ed.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1MDk5MzQsIm5iZiI6MTczNjUwOTYzNCwicGF0aCI6Ii80ODA4NDY2Mi8yNjE5Njk0MTMtZjc1Y2UxMzMtZjg0ZC00ZWQ3LTk5NmItMjE5ODU0ODE3NmVkLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTAlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTEwVDExNDcxNFomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWI5M2IyMGEwOWQ2Y2VmN2VjMDBjNzBlMzA1ZmM5MTMyMGIzNTAyMDFlODBmMGMxNTY4ZTgyM2FlNTcxNWQ2OTYmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.NvfA9ZUSS9fIivFw0d7qS5NvtHf6hKYhLFy6Z4ntm0o)
![image](https://private-user-images.githubusercontent.com/48084662/261969472-101fcb22-0f7e-4a45-aa71-29299a79db9b.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1MDk5MzQsIm5iZiI6MTczNjUwOTYzNCwicGF0aCI6Ii80ODA4NDY2Mi8yNjE5Njk0NzItMTAxZmNiMjItMGY3ZS00YTQ1LWFhNzEtMjkyOTlhNzlkYjliLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTAlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTEwVDExNDcxNFomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWY5MWM3ZWY3NTQ5NmYyODc2NjliNzk2OTFkMDdiNmRiM2ZkMTNhMWUzOGQ1YTkwNTMzZWI5NDY2ODllYzI2YmMmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.Q6rB9Jwz_ZlaMjm6RJExHwIcMwYl3KB-l8rS5LHXpS0)
![image](https://private-user-images.githubusercontent.com/48084662/261969516-e2c3912d-0b3b-4622-8076-415454f1bda4.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1MDk5MzQsIm5iZiI6MTczNjUwOTYzNCwicGF0aCI6Ii80ODA4NDY2Mi8yNjE5Njk1MTYtZTJjMzkxMmQtMGIzYi00NjIyLTgwNzYtNDE1NDU0ZjFiZGE0LnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTAlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTEwVDExNDcxNFomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTAwYzgxZjIyNDkxMjE2NjZlZGM4YTQwNmFjYTY2ZTcxNGI2N2Y3NjNkYTM5NGNjZGIzNmZjNmM1Y2UxNTJiZGQmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.c0V1dITOtOv3LJLFr99pXIT-wQbUgFJHUheCm0ZZuNs)

Shortcut\_ Telnet.cgi file code:

![image](https://private-user-images.githubusercontent.com/48084662/261969912-d1f07245-f7c0-4b09-8cc4-531d85a5338f.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1MDk5MzQsIm5iZiI6MTczNjUwOTYzNCwicGF0aCI6Ii80ODA4NDY2Mi8yNjE5Njk5MTItZDFmMDcyNDUtZjdjMC00YjA5LThjYzQtNTMxZDg1YTUzMzhmLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTAlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTEwVDExNDcxNFomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTM0NWYyYWFkMDYyMzM3MjI1M2MyZmZhYTY3Y2NjM2MzMzFjMDFkNmZmMjZmY2I5ZDMzYmE0OWJhNmFmNzQ5MWUmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.gM0UlwPCiJg6843kGiq04rstoeQO5rYh-ZAddrJSh1A)

Shortcut\_ The purpose of the telnet.cgi file is to enable and disable the telnet service. This code is a shell script used to execute telnet commands on a web page and display the results. Its general logic is as follows:
Firstly, it outputs a text type HTTP header.
Then, it defines two file name variables, each used to store commands and results.
Next, it calls the.../cgi bin/urldecode. cgi script to decode the commands in the query string and assign them to the CMD variable. If the command is top, then adding the - n 1 parameter indicates that it will only be displayed once.
Then, it creates a temporary shell script file, writes the values of CMD variables to it, and grants executable permissions.
Next, it executes this temporary shell script and redirects the output to the result file.
Then, it reads each line in the result file and concatenates it into a string, separated by
.
Next, it deletes the temporary shell script and result files.
Finally, it outputs the concatenated string.

中国移动智能家庭网关HG6543C4存在命令执行漏洞
设备默认信息:
设备型号:HG6543C4
默认无线网络名称:CMCC-hXtx
默认无线网络密码:f6qgriu4
默认终端配置地址:192.168.1.1
默认终端配置账号:dr7u2tvn

命令执行POC:<http://192.168.1.1/cgi-bin/shortcut_telnet.cgi?whoami>
![image](https://private-user-images.githubusercontent.com/48084662/261969413-f75ce133-f84d-4ed7-996b-2198548176ed.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1MDk5MzQsIm5iZiI6MTczNjUwOTYzNCwicGF0aCI6Ii80ODA4NDY2Mi8yNjE5Njk0MTMtZjc1Y2UxMzMtZjg0ZC00ZWQ3LTk5NmItMjE5ODU0ODE3NmVkLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTAlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTEwVDExNDcxNFomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWI5M2IyMGEwOWQ2Y2VmN2VjMDBjNzBlMzA1ZmM5MTMyMGIzNTAyMDFlODBmMGMxNTY4ZTgyM2FlNTcxNWQ2OTYmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.NvfA9ZUSS9fIivFw0d7qS5NvtHf6hKYhLFy6Z4ntm0o)
![image](https://private-user-images.githubusercontent.com/48084662/261969472-101fcb22-0f7e-4a45-aa71-29299a79db9b.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1MDk5MzQsIm5iZiI6MTczNjUwOTYzNCwicGF0aCI6Ii80ODA4NDY2Mi8yNjE5Njk0NzItMTAxZmNiMjItMGY3ZS00YTQ1LWFhNzEtMjkyOTlhNzlkYjliLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTAlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTEwVDExNDcxNFomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWY5MWM3ZWY3NTQ5NmYyODc2NjliNzk2OTFkMDdiNmRiM2ZkMTNhMWUzOGQ1YTkwNTMzZWI5NDY2ODllYzI2YmMmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.Q6rB9Jwz_ZlaMjm6RJExHwIcMwYl3KB-l8rS5LHXpS0)
![image](https://private-user-images.githubusercontent.com/48084662/261969516-e2c3912d-0b3b-4622-8076-415454f1bda4.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1MDk5MzQsIm5iZiI6MTczNjUwOTYzNCwicGF0aCI6Ii80ODA4NDY2Mi8yNjE5Njk1MTYtZTJjMzkxMmQtMGIzYi00NjIyLTgwNzYtNDE1NDU0ZjFiZGE0LnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTAlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTEwVDExNDcxNFomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTAwYzgxZjIyNDkxMjE2NjZlZGM4YTQwNmFjYTY2ZTcxNGI2N2Y3NjNkYTM5NGNjZGIzNmZjNmM1Y2UxNTJiZGQmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.c0V1dITOtOv3LJLFr99pXIT-wQbUgFJHUheCm0ZZuNs)
shortcut\_telnet.cgi文件代码:

![image](https://private-user-images.githubusercontent.com/48084662/261969912-d1f07245-f7c0-4b09-8cc4-531d85a5338f.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY1MDk5MzQsIm5iZiI6MTczNjUwOTYzNCwicGF0aCI6Ii80ODA4NDY2Mi8yNjE5Njk5MTItZDFmMDcyNDUtZjdjMC00YjA5LThjYzQtNTMxZDg1YTUzMzhmLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTAlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTEwVDExNDcxNFomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTM0NWYyYWFkMDYyMzM3MjI1M2MyZmZhYTY3Y2NjM2MzMzFjMDFkNmZmMjZmY2I5ZDMzYmE0OWJhNmFmNzQ5MWUmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.gM0UlwPCiJg6843kGiq04rstoeQO5rYh-ZAddrJSh1A)

shortcut\_telnet.cgi文件的目的是开启会关闭telnet服务,这段代码是一个shell脚本，用于在web页面上执行telnet命令并显示结果。它的大致逻辑如下：

首先，它输出一个文本类型的http头部。
然后，它定义了两个文件名变量，分别用于存储命令和结果。
接着，它调用…/cgi-bin/urldecode.cgi脚本来解码查询字符串中的命令，并赋给CMD变量。如果命令是top，那么它加上-n 1参数，表示只显示一次。
然后，它创建一个临时的shell脚本文件，将CMD变量的值写入其中，并赋予可执行权限。
接着，它执行这个临时的shell脚本，并将输出重定向到结果文件中。
然后，它读取结果文件中的每一行，并将其拼接成一个字符串，每行之间用
分隔。
接着，它删除临时的shell脚本和结果文件。
最后，它输出拼接好的字符串。

### Toggle table of contents Pages 7

* Loading

  [Home](/te5tb99/For-submitting/wiki)
* Loading

  [China Mobile Intelligent Home Gateway HG6543C4 has an identity verification mechanism defect](/te5tb99/For-submitting/wiki/China-Mobile-Intelligent-Home-Gateway-HG6543C4-has-an-identity-verification-mechanism-defect)
* Loading

  [China Telecom Tianyi Home Gateway TEWA‐700G](/te5tb99/For-submitting/wiki/China-Telecom-Tianyi-Home-Gateway-TEWA%E2%80%90700G)
* Loading

  [Command Execution Vulnerability in China Mobile Intelligent Home Gateway HG6543C4](/te5tb99/For-submitting/wiki/Command-Execution-Vulnerability-in-China-Mobile-Intelligent-Home-Gateway-HG6543C4)
* Loading

  [Command Execution Vulnerability in China Mobile Intelligent Home Gateway HG6543C4 Identity verification has design flaws](/te5tb99/For-submitting/wiki/Command-Execution-Vulnerability-in-China-Mobile-Intelligent-Home-Gateway-HG6543C4-Identity-verification-has-design-flaws)
* Loading

  [CVE‐2023‐3346‐记录](/te5tb99/For-submitting/wiki/CVE%E2%80%902023%E2%80%903346%E2%80%90%E8%AE%B0%E5%BD%95)
* Loading

  [CVE‐2023‐4088【记录备忘】](/te5tb99/For-submitting/wiki/CVE%E2%80%902023%E2%80%904088%E3%80%90%E8%AE%B0%E5%BD%95%E5%A4%87%E5%BF%98%E3%80%91)

##### Clone this wiki locally

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.

