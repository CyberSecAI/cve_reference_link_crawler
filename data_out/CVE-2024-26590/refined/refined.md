Based on the provided information, this content relates to **CVE-2024-26590**.

**Root Cause:**
The vulnerability stems from inconsistent per-file compression format handling in the EROFS (Enhanced Read-Only File System) driver. The EROFS driver allows selection of compression algorithms on a per-file basis. However, the on-disk superblock needs to be initialized to reflect the available compression algorithms. The vulnerability arises when a crafted image uses an unsupported compression algorithm for a specific inode. For example, it may use the MicroLZMA algorithm, even if it's not listed in `sbi->available_compr_algs`. This inconsistency can lead to a kernel NULL pointer dereference if the corresponding decompressor is not built-in.

**Weaknesses/Vulnerabilities:**
- Inconsistent compression algorithm selection: The code fails to validate the requested per-file compression algorithm against the available algorithms specified in the superblock.
- Potential for NULL pointer dereference: If an unsupported decompressor is used, it results in a NULL pointer dereference, leading to a kernel crash.

**Impact of Exploitation:**
- Kernel crash: A crafted EROFS image with inconsistent compression settings can trigger a kernel NULL pointer dereference.
- Denial of Service: By exploiting this vulnerability, an attacker can cause a system to become unstable and unusable by causing a kernel crash.

**Attack Vectors:**
- Crafted EROFS image: An attacker needs to create a specially crafted EROFS image with inconsistent compression settings to trigger the vulnerability.
- Image mounting: The vulnerability is triggered when the affected system mounts the malicious EROFS image.

**Required Attacker Capabilities/Position:**
- Ability to create and provide a specially crafted EROFS image.
- The attacker needs to have the ability to mount a malicious EROFS image on a system running a vulnerable kernel.

**Additional Details:**
- The fix involves adding a check to ensure that the requested compression algorithm for a file is present in the superblock's `available_compr_algs` list.
- The fix also corrects an incorrect preset bitmap for `!erofs_sb_has_compr_cfgs`.
- The vulnerability was reported by <bugreport@ubisectech.com>.
- The issue affects versions of the Linux kernel prior to the fix.