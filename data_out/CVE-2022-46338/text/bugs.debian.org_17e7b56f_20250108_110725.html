
# Debian Bug report logs - #1024998 g810-led: Security risk: Leaves /dev/input/event\* with read and write permissions for all users (CVE-2022-46338)

[![version graph](version.cgi?absolute=0;fixed=0.3.3-2%2Bdeb10u1;fixed=g810-led%2F0.4.2-3;fixed=g810-led%2F0.4.2-1%2Bdeb11u1;height=2;found=g810-led%2F0.4.2-1;found=0.4.2-2.1;found=g810-led%2F0.3.3-2;found=g810-led%2F0.4.2-2;collapse=1;width=2;package=g810-led)](version.cgi?package=g810-led;collapse=1;found=g810-led%2F0.4.2-1;found=0.4.2-2.1;found=g810-led%2F0.3.3-2;found=g810-led%2F0.4.2-2;fixed=0.3.3-2%2Bdeb10u1;fixed=g810-led%2F0.4.2-3;fixed=g810-led%2F0.4.2-1%2Bdeb11u1;info=1;absolute=0)

Package:
[g810-led](pkgreport.cgi?package=g810-led);
Maintainer for [g810-led](pkgreport.cgi?package=g810-led) is [Stephen Kitt <skitt@debian.org>](pkgreport.cgi?maint=skitt%40debian.org); Source for [g810-led](pkgreport.cgi?package=g810-led) is [src:g810-led](pkgreport.cgi?src=g810-led) ([PTS](https://tracker.debian.org/pkg/g810-led), [buildd](https://buildd.debian.org/g810-led), [popcon](https://qa.debian.org/popcon.php?package=g810-led)).

Reported by: [Xavi Drudis Ferran <xdrudis@tinet.cat>](pkgreport.cgi?submitter=xdrudis%40tinet.cat)

Date: Mon, 28 Nov 2022 15:03:02 UTC

Severity: *critical*

Tags: patch, security, upstream

Found in versions g810-led/0.4.2-1, 0.4.2-2.1, g810-led/0.3.3-2, g810-led/0.4.2-2

Fixed in versions 0.3.3-2+deb10u1, g810-led/0.4.2-3, g810-led/0.4.2-1+deb11u1

**Done:** Stephen Kitt <skitt@debian.org>

Bug is archived. No further changes may be made.

Forwarded to <https://github.com/MatMoul/g810-led/pull/297>

Display info messages

View this report as an [mbox folder](bugreport.cgi?bug=1024998;mbox=yes), [status mbox](bugreport.cgi?bug=1024998;mbox=yes;mboxstatus=yes), [maintainer mbox](bugreport.cgi?bug=1024998;mbox=yes;mboxmaint=yes)

---

**Report forwarded**
to `debian-bugs-dist@lists.debian.org, xdrudis@tinet.cat, team@security.debian.org, Stephen Kitt <skitt@debian.org>`:

`Bug#1024998`; Package `g810-led`.
(Mon, 28 Nov 2022 15:03:04 GMT) ([full text](bugreport.cgi?bug=1024998;msg=2), [mbox](bugreport.cgi?bug=1024998;mbox=yes;msg=2), [link](#1)).

---

**Acknowledgement sent**
to `Xavi Drudis Ferran <xdrudis@tinet.cat>`:

New Bug report received and forwarded. Copy sent to `xdrudis@tinet.cat, team@security.debian.org, Stephen Kitt <skitt@debian.org>`.
(Mon, 28 Nov 2022 15:03:04 GMT) ([full text](bugreport.cgi?bug=1024998;msg=4), [mbox](bugreport.cgi?bug=1024998;mbox=yes;msg=4), [link](#3)).

---

[Message #5](#5) received at submit@bugs.debian.org ([full text](bugreport.cgi?bug=1024998;msg=5), [mbox](bugreport.cgi?bug=1024998;mbox=yes;msg=5), reply):

![](/cgi-bin/libravatar.cgi?email=xdrudis%40tinet.cat)
From: Xavi Drudis Ferran <xdrudis@tinet.cat>
To: Debian Bug Tracking System <submit@bugs.debian.org>
Subject: g810-led: Security risk: Leaves /dev/input/event\* with read and
write permissions for all users
Date: Mon, 28 Nov 2022 15:45:16 +0100
```
Package: g810-led
Version: 0.4.2-2.1
Severity: critical
Tags: patch upstream security
Justification: root security hole
X-Debbugs-Cc: xdrudis@tinet.cat, Debian Security Team <team@security.debian.org>

Dear Maintainer,

I hesitate to file as critical, but I came across a bug report in
upstream that looked serious enough since it would allow all local
processes to eavesdrop on keyboard input, including passwords, etc. I
haven't tried an exploit, but it seemed better to just restrict
/dev/input/event* permissions to those of other event dev files.

Without this patch, I can read /dev/input/event2 and /dev/input/event3 as a
normal user. I see bytes in /dev/input/event2 when typing as a normal
user and also typing in another terminal (Konsole) typing as
root. event3 only shows the characters typed by the normal user.

With the patch I can't read /dev/input/event* as a normal user.

And the bug is publically reported upstream (some 10 days ago).

   * What led up to the situation?

Reviewing upstream bugs, found <https://github.com/MatMoul/g810-led/issues/293>

   * What exactly did you do (or not do) that was effective (or
     ineffective)?

Nothing really. I wrote the patch, rebuilt, and observed the
permissions were fixed. My keyboard seems to work both with and
without the patch (needs a kernel with CONFIG_HIDRAW), when calling
g810-led as root. As normal user it doesn't work (both with or without
patch), due to no permission for /dev/hidraw2.

It should really be fixed upstream, but maybe it's worth fixing meanwhile
or removing the package temporarily ?

-- System Information:
Debian Release: 11.5
  APT prefers stable-security
  APT policy: (500, 'stable-security'), (500, 'stable')
Architecture: arm64 (aarch64)

Kernel: Linux 5.19.4-gnu-eowyn21so-gc9d5f2140717-dirty (SMP w/6 CPU threads; PREEMPT)
Kernel taint flags: TAINT_CRAP
Locale: LANG=ca_ES.UTF-8, LC_CTYPE=ca_ES.UTF-8 (charmap=UTF-8), LANGUAGE not set
Shell: /bin/sh linked to /usr/bin/dash
Init: systemd (via /run/systemd/system)

Versions of packages g810-led depends on:
ii  libc6         2.31-13+deb11u4
ii  libg810-led0  0.4.2-2.1
ii  libgcc-s1     10.2.1-6
ii  libstdc++6    10.2.1-6

g810-led recommends no packages.

g810-led suggests no packages.

-- Configuration Files:
/etc/g810-led/profile changed [not included]

-- no debconf information

*** /home/xdrudis/g810-led/debian/patches/correct_permissions_in_event_device_files.patch
--- a/udev/g810-led.rules
+++ b/udev/g810-led.rules
@@ -1,25 +1,25 @@
-ACTION=="add", SUBSYSTEMS=="usb", ATTRS{idVendor}=="046d", ATTRS{idProduct}=="c336", MODE="666" RUN+="/usr/bin/g213-led -p /etc/g810-led/profile"
-ACTION=="add", SUBSYSTEMS=="usb", ATTRS{idVendor}=="046d", ATTRS{idProduct}=="c330", MODE="666" RUN+="/usr/bin/g410-led -p /etc/g810-led/profile"
-ACTION=="add", SUBSYSTEMS=="usb", ATTRS{idVendor}=="046d", ATTRS{idProduct}=="c33a", MODE="666" RUN+="/usr/bin/g413-led -p /etc/g810-led/profile"
-ACTION=="add", SUBSYSTEMS=="usb", ATTRS{idVendor}=="046d", ATTRS{idProduct}=="c342", MODE="666" RUN+="/usr/bin/g512-led -p /etc/g810-led/profile"
-ACTION=="add", SUBSYSTEMS=="usb", ATTRS{idVendor}=="046d", ATTRS{idProduct}=="c33c", MODE="666" RUN+="/usr/bin/g513-led -p /etc/g810-led/profile"
-ACTION=="add", SUBSYSTEMS=="usb", ATTRS{idVendor}=="046d", ATTRS{idProduct}=="c333", MODE="666" RUN+="/usr/bin/g610-led -p /etc/g810-led/profile"
-ACTION=="add", SUBSYSTEMS=="usb", ATTRS{idVendor}=="046d", ATTRS{idProduct}=="c338", MODE="666" RUN+="/usr/bin/g610-led -p /etc/g810-led/profile"
-ACTION=="add", SUBSYSTEMS=="usb", ATTRS{idVendor}=="046d", ATTRS{idProduct}=="c331", MODE="666" RUN+="/usr/bin/g810-led -p /etc/g810-led/profile"
-ACTION=="add", SUBSYSTEMS=="usb", ATTRS{idVendor}=="046d", ATTRS{idProduct}=="c337", MODE="666" RUN+="/usr/bin/g810-led -p /etc/g810-led/profile"
-ACTION=="add", SUBSYSTEMS=="usb", ATTRS{idVendor}=="046d", ATTRS{idProduct}=="c33f", MODE="666" RUN+="/usr/bin/g815-led -p /etc/g810-led/profile"
-ACTION=="add", SUBSYSTEMS=="usb", ATTRS{idVendor}=="046d", ATTRS{idProduct}=="c32b", MODE="666" RUN+="/usr/bin/g910-led -p /etc/g810-led/profile"
-ACTION=="add", SUBSYSTEMS=="usb", ATTRS{idVendor}=="046d", ATTRS{idProduct}=="c335", MODE="666" RUN+="/usr/bin/g910-led -p /etc/g810-led/profile"
-ACTION=="add", SUBSYSTEMS=="usb", ATTRS{idVendor}=="046d", ATTRS{idProduct}=="c339", MODE="666" RUN+="/usr/bin/gpro-led -p /etc/g810-led/profile"
-ACTION=="add", SUBSYSTEM=="usb", ATTRS{idVendor}=="046d", ATTRS{idProduct}=="c336", MODE="666" RUN+="/usr/bin/g213-led -p /etc/g810-led/profile"
-ACTION=="add", SUBSYSTEM=="usb", ATTRS{idVendor}=="046d", ATTRS{idProduct}=="c330", MODE="666" RUN+="/usr/bin/g410-led -p /etc/g810-led/profile"
-ACTION=="add", SUBSYSTEM=="usb", ATTRS{idVendor}=="046d", ATTRS{idProduct}=="c33a", MODE="666" RUN+="/usr/bin/g413-led -p /etc/g810-led/profile"
-ACTION=="add", SUBSYSTEM=="usb", ATTRS{idVendor}=="046d", ATTRS{idProduct}=="c342", MODE="666" RUN+="/usr/bin/g512-led -p /etc/g810-led/profile"
-ACTION=="add", SUBSYSTEM=="usb", ATTRS{idVendor}=="046d", ATTRS{idProduct}=="c33c", MODE="666" RUN+="/usr/bin/g513-led -p /etc/g810-led/profile"
-ACTION=="add", SUBSYSTEM=="usb", ATTRS{idVendor}=="046d", ATTRS{idProduct}=="c333", MODE="666" RUN+="/usr/bin/g610-led -p /etc/g810-led/profile"
-ACTION=="add", SUBSYSTEM=="usb", ATTRS{idVendor}=="046d", ATTRS{idProduct}=="c338", MODE="666" RUN+="/usr/bin/g610-led -p /etc/g810-led/profile"
-ACTION=="add", SUBSYSTEM=="usb", ATTRS{idVendor}=="046d", ATTRS{idProduct}=="c331", MODE="666" RUN+="/usr/bin/g810-led -p /etc/g810-led/profile"
-ACTION=="add", SUBSYSTEM=="usb", ATTRS{idVendor}=="046d", ATTRS{idProduct}=="c337", MODE="666" RUN+="/usr/bin/g810-led -p /etc/g810-led/profile"
-ACTION=="add", SUBSYSTEM=="usb", ATTRS{idVendor}=="046d", ATTRS{idProduct}=="c32b", MODE="666" RUN+="/usr/bin/g910-led -p /etc/g810-led/profile"
-ACTION=="add", SUBSYSTEM=="usb", ATTRS{idVendor}=="046d", ATTRS{idProduct}=="c335", MODE="666" RUN+="/usr/bin/g910-led -p /etc/g810-led/profile"
-ACTION=="add", SUBSYSTEM=="usb", ATTRS{idVendor}=="046d", ATTRS{idProduct}=="c339", MODE="666" RUN+="/usr/bin/gpro-led -p /etc/g810-led/profile"
+ACTION=="add", SUBSYSTEMS=="usb", ATTRS{idVendor}=="046d", ATTRS{idProduct}=="c336", MODE="660" RUN+="/usr/bin/g213-led -p /etc/g810-led/profile"
+ACTION=="add", SUBSYSTEMS=="usb", ATTRS{idVendor}=="046d", ATTRS{idProduct}=="c330", MODE="660" RUN+="/usr/bin/g410-led -p /etc/g810-led/profile"
+ACTION=="add", SUBSYSTEMS=="usb", ATTRS{idVendor}=="046d", ATTRS{idProduct}=="c33a", MODE="660" RUN+="/usr/bin/g413-led -p /etc/g810-led/profile"
+ACTION=="add", SUBSYSTEMS=="usb", ATTRS{idVendor}=="046d", ATTRS{idProduct}=="c342", MODE="660" RUN+="/usr/bin/g512-led -p /etc/g810-led/profile"
+ACTION=="add", SUBSYSTEMS=="usb", ATTRS{idVendor}=="046d", ATTRS{idProduct}=="c33c", MODE="660" RUN+="/usr/bin/g513-led -p /etc/g810-led/profile"
+ACTION=="add", SUBSYSTEMS=="usb", ATTRS{idVendor}=="046d", ATTRS{idProduct}=="c333", MODE="660" RUN+="/usr/bin/g610-led -p /etc/g810-led/profile"
+ACTION=="add", SUBSYSTEMS=="usb", ATTRS{idVendor}=="046d", ATTRS{idProduct}=="c338", MODE="660" RUN+="/usr/bin/g610-led -p /etc/g810-led/profile"
+ACTION=="add", SUBSYSTEMS=="usb", ATTRS{idVendor}=="046d", ATTRS{idProduct}=="c331", MODE="660" RUN+="/usr/bin/g810-led -p /etc/g810-led/profile"
+ACTION=="add", SUBSYSTEMS=="usb", ATTRS{idVendor}=="046d", ATTRS{idProduct}=="c337", MODE="660" RUN+="/usr/bin/g810-led -p /etc/g810-led/profile"
+ACTION=="add", SUBSYSTEMS=="usb", ATTRS{idVendor}=="046d", ATTRS{idProduct}=="c33f", MODE="660" RUN+="/usr/bin/g815-led -p /etc/g810-led/profile"
+ACTION=="add", SUBSYSTEMS=="usb", ATTRS{idVendor}=="046d", ATTRS{idProduct}=="c32b", MODE="660" RUN+="/usr/bin/g910-led -p /etc/g810-led/profile"
+ACTION=="add", SUBSYSTEMS=="usb", ATTRS{idVendor}=="046d", ATTRS{idProduct}=="c335", MODE="660" RUN+="/usr/bin/g910-led -p /etc/g810-led/profile"
+ACTION=="add", SUBSYSTEMS=="usb", ATTRS{idVendor}=="046d", ATTRS{idProduct}=="c339", MODE="660" RUN+="/usr/bin/gpro-led -p /etc/g810-led/profile"
+ACTION=="add", SUBSYSTEM=="usb", ATTRS{idVendor}=="046d", ATTRS{idProduct}=="c336", MODE="660" RUN+="/usr/bin/g213-led -p /etc/g810-led/profile"
+ACTION=="add", SUBSYSTEM=="usb", ATTRS{idVendor}=="046d", ATTRS{idProduct}=="c330", MODE="660" RUN+="/usr/bin/g410-led -p /etc/g810-led/profile"
+ACTION=="add", SUBSYSTEM=="usb", ATTRS{idVendor}=="046d", ATTRS{idProduct}=="c33a", MODE="660" RUN+="/usr/bin/g413-led -p /etc/g810-led/profile"
+ACTION=="add", SUBSYSTEM=="usb", ATTRS{idVendor}=="046d", ATTRS{idProduct}=="c342", MODE="660" RUN+="/usr/bin/g512-led -p /etc/g810-led/profile"
+ACTION=="add", SUBSYSTEM=="usb", ATTRS{idVendor}=="046d", ATTRS{idProduct}=="c33c", MODE="660" RUN+="/usr/bin/g513-led -p /etc/g810-led/profile"
+ACTION=="add", SUBSYSTEM=="usb", ATTRS{idVendor}=="046d", ATTRS{idProduct}=="c333", MODE="660" RUN+="/usr/bin/g610-led -p /etc/g810-led/profile"
+ACTION=="add", SUBSYSTEM=="usb", ATTRS{idVendor}=="046d", ATTRS{idProduct}=="c338", MODE="660" RUN+="/usr/bin/g610-led -p /etc/g810-led/profile"
+ACTION=="add", SUBSYSTEM=="usb", ATTRS{idVendor}=="046d", ATTRS{idProduct}=="c331", MODE="660" RUN+="/usr/bin/g810-led -p /etc/g810-led/profile"
+ACTION=="add", SUBSYSTEM=="usb", ATTRS{idVendor}=="046d", ATTRS{idProduct}=="c337", MODE="660" RUN+="/usr/bin/g810-led -p /etc/g810-led/profile"
+ACTION=="add", SUBSYSTEM=="usb", ATTRS{idVendor}=="046d", ATTRS{idProduct}=="c32b", MODE="660" RUN+="/usr/bin/g910-led -p /etc/g810-led/profile"
+ACTION=="add", SUBSYSTEM=="usb", ATTRS{idVendor}=="046d", ATTRS{idProduct}=="c335", MODE="660" RUN+="/usr/bin/g910-led -p /etc/g810-led/profile"
+ACTION=="add", SUBSYSTEM=="usb", ATTRS{idVendor}=="046d", ATTRS{idProduct}=="c339", MODE="660" RUN+="/usr/bin/gpro-led -p /etc/g810-led/profile"

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org`:

`Bug#1024998`; Package `g810-led`.
(Mon, 28 Nov 2022 20:15:09 GMT) ([full text](bugreport.cgi?bug=1024998;msg=7), [mbox](bugreport.cgi?bug=1024998;mbox=yes;msg=7), [link](#6)).

---

**Acknowledgement sent**
to `Stephen Kitt <skitt@debian.org>`:

Extra info received and forwarded to list.
(Mon, 28 Nov 2022 20:15:10 GMT) ([full text](bugreport.cgi?bug=1024998;msg=9), [mbox](bugreport.cgi?bug=1024998;mbox=yes;msg=9), [link](#8)).

---

[Message #10](#10) received at 1024998@bugs.debian.org ([full text](bugreport.cgi?bug=1024998;msg=10), [mbox](bugreport.cgi?bug=1024998;mbox=yes;msg=10), reply):

![](/cgi-bin/libravatar.cgi?email=skitt%40debian.org)
From: Stephen Kitt <skitt@debian.org>
To: Xavi Drudis Ferran <xdrudis@tinet.cat>, 1024998@bugs.debian.org
Cc: team@security.debian.org
Subject: Re: Bug#1024998: g810-led: Security risk: Leaves /dev/input/event\*
with read and write permissions for all users
Date: Mon, 28 Nov 2022 21:13:03 +0100
```
[[Message part 1](bugreport.cgi?att=0;bug=1024998;msg=10) (text/plain, inline)]
```
```
Hi,

On Mon, 28 Nov 2022 15:45:16 +0100, Xavi Drudis Ferran <xdrudis@tinet.cat>
wrote:
> I hesitate to file as critical, but I came across a bug report in
> upstream that looked serious enough since it would allow all local
> processes to eavesdrop on keyboard input, including passwords, etc. I
> haven't tried an exploit, but it seemed better to just restrict
> /dev/input/event* permissions to those of other event dev files.
>
> Without this patch, I can read /dev/input/event2 and /dev/input/event3 as a
> normal user. I see bytes in /dev/input/event2 when typing as a normal
> user and also typing in another terminal (Konsole) typing as
> root. event3 only shows the characters typed by the normal user.
>
> With the patch I can't read /dev/input/event* as a normal user.

Thanks for bringing this up! I’d rather use uaccess, see
<https://github.com/MatMoul/g810-led/pull/297>

I’ll upload a fixed package shortly and see about a security update for
stable.

Regards,

Stephen

```
```
[[Message part 2](bugreport.cgi?att=1;bug=1024998;msg=10) (application/pgp-signature, inline)]
```

---

**Reply sent**
to `Stephen Kitt <skitt@debian.org>`:

You have taken responsibility.
(Mon, 28 Nov 2022 22:21:06 GMT) ([full text](bugreport.cgi?bug=1024998;msg=12), [mbox](bugreport.cgi?bug=1024998;mbox=yes;msg=12), [link](#11)).

---

**Notification sent**
to `Xavi Drudis Ferran <xdrudis@tinet.cat>`:

Bug acknowledged by developer.
(Mon, 28 Nov 2022 22:21:06 GMT) ([full text](bugreport.cgi?bug=1024998;msg=14), [mbox](bugreport.cgi?bug=1024998;mbox=yes;msg=14), [link](#13)).

---

[Message #15](#15) received at 1024998-close@bugs.debian.org ([full text](bugreport.cgi?bug=1024998;msg=15), [mbox](bugreport.cgi?bug=1024998;mbox=yes;msg=15), reply):

![](/cgi-bin/libravatar.cgi?email=ftpmaster%40ftp-master.debian.org)
From: Debian FTP Masters <ftpmaster@ftp-master.debian.org>
To: 1024998-close@bugs.debian.org
Subject: Bug#1024998: fixed in g810-led 0.4.2-3
Date: Mon, 28 Nov 2022 22:20:03 +0000
```
Source: g810-led
Source-Version: 0.4.2-3
Done: Stephen Kitt <skitt@debian.org>

We believe that the bug you reported is fixed in the latest version of
g810-led, which is due to be installed in the Debian FTP archive.

A summary of the changes between this version and the previous one is
attached.

Thank you for reporting the bug, which will now be closed.  If you
have further comments please address them to 1024998@bugs.debian.org,
and the maintainer will reopen the bug report if appropriate.

Debian distribution maintenance software
pp.
Stephen Kitt <skitt@debian.org> (supplier of updated g810-led package)

(This message was generated automatically at their request; if you
believe that there is a problem with it please contact the archive
administrators by mailing ftpmaster@ftp-master.debian.org)

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

Format: 1.8
Date: Mon, 28 Nov 2022 23:05:53 +0100
Source: g810-led
Architecture: source
Version: 0.4.2-3
Distribution: unstable
Urgency: medium
Maintainer: Stephen Kitt <skitt@debian.org>
Changed-By: Stephen Kitt <skitt@debian.org>
Closes: [1024998](bugreport.cgi?bug=1024998)
Changes:
 g810-led (0.4.2-3) unstable; urgency=medium
 .
   * Control device access with uaccess instead of making everything
     world-writable. Thanks to Xavi Drudis Ferran for the report!
     Closes:#[1024998](bugreport.cgi?bug=1024998).
Checksums-Sha1:
 9f3e2c60803bb66c973562d02c80dcaa023ac60a 1953 g810-led_0.4.2-3.dsc
 22f06a4b2ac624c45370f63dc9d6f8553f5b228c 6200 g810-led_0.4.2-3.debian.tar.xz
 8fb0ed1e0dbe91536cfbc888827041acf48f8a0e 6480 g810-led_0.4.2-3_source.buildinfo
Checksums-Sha256:
 d8adfbbfec49690dabbe3093f6dc4e53d1f6faa7d7c34b69acfeb64cbda6d608 1953 g810-led_0.4.2-3.dsc
 b939940c191378d7df1c36eab41c963776432184d1bbf0e35e54e5e48d74e5e6 6200 g810-led_0.4.2-3.debian.tar.xz
 fc6384f1c45a14e0d53a155a3ad58c3c611804b30489c8cb86df14bc5e3e286b 6480 g810-led_0.4.2-3_source.buildinfo
Files:
 70c18dfdcd4c8a9d3e457b2ba302a983 1953 utils optional g810-led_0.4.2-3.dsc
 5f090856daafba8787d7d27f7c345dd1 6200 utils optional g810-led_0.4.2-3.debian.tar.xz
 b359f192e656bd2dd8d531b75d8e001b 6480 utils optional g810-led_0.4.2-3_source.buildinfo

-----BEGIN PGP SIGNATURE-----

iQIzBAEBCgAdFiEEnPVX/hPLkMoq7x0ggNMC9Yhtg5wFAmOFMPAACgkQgNMC9Yht
g5zatRAAh7me3OV/Bhbx2PoNWbXN9mLO6hb5HmcmPk+ybQqKH8T+varCkYq96/fT
bRZBjQgI6+7L53xcfPRsuaN64i4lwW/32LToSFQMkLUu6bFFihDwCTqX+KaeYjFM
NUrcRYHmWKDUtvmbJ6L+n9LEw27zD7PB3oB+H+E/k5Hv2FvnZ2DuViIUsnuRLffN
tW1JDpWggtG4xBlqsVhVMWt+xZ9j4eA/nnWWNMX32NipnQxJmFF8dQp3z3MlNnNt
37ig7APSwNkdlnHORLYNqTHuMK8eYw4InaEDiCqM1dxAIPjMFPas0nqeiIU64Tqj
iGq5D32G8XYMRl4fxZfctPQli70BHc1TMbD5JJHN4EgkVrwOvomkKbhHJ0px9JGg
V+3uxQNIWlYvZhDQJBKAyxvXsSU1klwX7L4qr/j8TjIam7b9LR6b0c2mbgT2fF93
NPkyR0aXaaay7sUQKOZlDy1ROHJIRwaqN7pI3IERB2bHNr8eOZM7H08HXDoawa7O
P5MS4Gt8YB4XNjfRo7I7I5GoFAWw/e+GmzahMKAxwRgkQfBxrzkszWOZK3bVo29A
Xdyk+6ptBhoLpb2+ZMIda5KLTREbRV4EmgU2HUwp1YDGJAa90co3J+JKGFcpXdQz
Y+CwC+F3jtsEdnH7bs0POXZx2xfZ4H8VF/2YaW+wSVdtj86XcxU=
=TxFx
-----END PGP SIGNATURE-----

```

---

**Set Bug forwarded-to-address to '<https://github.com/MatMoul/g810-led/pull/297>'.**
Request was from `Salvatore Bonaccorso <carnil@debian.org>`
to `control@bugs.debian.org`.
(Tue, 29 Nov 2022 09:24:02 GMT) ([full text](bugreport.cgi?bug=1024998;msg=17), [mbox](bugreport.cgi?bug=1024998;mbox=yes;msg=17), [link](#16)).

---

**Marked as found in versions g810-led/0.4.2-2.**
Request was from `Salvatore Bonaccorso <carnil@debian.org>`
to `control@bugs.debian.org`.
(Tue, 29 Nov 2022 20:12:04 GMT) ([full text](bugreport.cgi?bug=1024998;msg=19), [mbox](bugreport.cgi?bug=1024998;mbox=yes;msg=19), [link](#18)).

---

**Marked as found in versions g810-led/0.4.2-1.**
Request was from `Salvatore Bonaccorso <carnil@debian.org>`
to `control@bugs.debian.org`.
(Tue, 29 Nov 2022 20:12:05 GMT) ([full text](bugreport.cgi?bug=1024998;msg=21), [mbox](bugreport.cgi?bug=1024998;mbox=yes;msg=21), [link](#20)).

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Stephen Kitt <skitt@debian.org>`:

`Bug#1024998`; Package `g810-led`.
(Wed, 30 Nov 2022 06:03:03 GMT) ([full text](bugreport.cgi?bug=1024998;msg=23), [mbox](bugreport.cgi?bug=1024998;mbox=yes;msg=23), [link](#22)).

---

**Acknowledgement sent**
to `Salvatore Bonaccorso <carnil@debian.org>`:

Extra info received and forwarded to list. Copy sent to `Stephen Kitt <skitt@debian.org>`.
(Wed, 30 Nov 2022 06:03:03 GMT) ([full text](bugreport.cgi?bug=1024998;msg=25), [mbox](bugreport.cgi?bug=1024998;mbox=yes;msg=25), [link](#24)).

---

[Message #26](#26) received at 1024998@bugs.debian.org ([full text](bugreport.cgi?bug=1024998;msg=26), [mbox](bugreport.cgi?bug=1024998;mbox=yes;msg=26), reply):

![](/cgi-bin/libravatar.cgi?email=carnil%40debian.org)
From: Salvatore Bonaccorso <carnil@debian.org>
To: Xavi Drudis Ferran <xdrudis@tinet.cat>, 1024998@bugs.debian.org
Cc: Debian Security Team <team@security.debian.org>
Subject: Re: Bug#1024998: g810-led: Security risk: Leaves /dev/input/event\*
with read and write permissions for all users
Date: Wed, 30 Nov 2022 06:59:41 +0100
```
Control: retitle -1 g810-led: Security risk: Leaves /dev/input/event* with read and write permissions for all users ([CVE-2022-46338](https://security-tracker.debian.org/tracker/CVE-2022-46338))

On Mon, Nov 28, 2022 at 03:45:16PM +0100, Xavi Drudis Ferran wrote:
> Package: g810-led
> Version: 0.4.2-2.1
> Severity: critical
> Tags: patch upstream security
> Justification: root security hole
> X-Debbugs-Cc: xdrudis@tinet.cat, Debian Security Team <team@security.debian.org>
>
> Dear Maintainer,
>
> I hesitate to file as critical, but I came across a bug report in
> upstream that looked serious enough since it would allow all local
> processes to eavesdrop on keyboard input, including passwords, etc. I
> haven't tried an exploit, but it seemed better to just restrict
> /dev/input/event* permissions to those of other event dev files.
>
> Without this patch, I can read /dev/input/event2 and /dev/input/event3 as a
> normal user. I see bytes in /dev/input/event2 when typing as a normal
> user and also typing in another terminal (Konsole) typing as
> root. event3 only shows the characters typed by the normal user.
>
> With the patch I can't read /dev/input/event* as a normal user.
>
> And the bug is publically reported upstream (some 10 days ago).
>
>    * What led up to the situation?
>
> Reviewing upstream bugs, found <https://github.com/MatMoul/g810-led/issues/293>
>
>    * What exactly did you do (or not do) that was effective (or
>      ineffective)?
>
> Nothing really. I wrote the patch, rebuilt, and observed the
> permissions were fixed. My keyboard seems to work both with and
> without the patch (needs a kernel with CONFIG_HIDRAW), when calling
> g810-led as root. As normal user it doesn't work (both with or without
> patch), due to no permission for /dev/hidraw2.
>
> It should really be fixed upstream, but maybe it's worth fixing meanwhile
> or removing the package temporarily ?

The issue got [CVE-2022-46338](https://security-tracker.debian.org/tracker/CVE-2022-46338) assigned by MITRE.

Stephen, the issue is marked no-dsa for bullseye, but a fix might go
still trough the upcoming point release (scheduled for 17th december).

Regards,
Salvatore

```

---

**Changed Bug title to 'g810-led: Security risk: Leaves /dev/input/event\* with read and write permissions for all users (CVE-2022-46338)' from 'g810-led: Security risk: Leaves /dev/input/event\* with read and write permissions for all users'.**
Request was from `Salvatore Bonaccorso <carnil@debian.org>`
to `1024998-submit@bugs.debian.org`.
(Wed, 30 Nov 2022 06:03:03 GMT) ([full text](bugreport.cgi?bug=1024998;msg=28), [mbox](bugreport.cgi?bug=1024998;mbox=yes;msg=28), [link](#27)).

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org`:

`Bug#1024998`; Package `g810-led`.
(Wed, 30 Nov 2022 07:30:07 GMT) ([full text](bugreport.cgi?bug=1024998;msg=30), [mbox](bugreport.cgi?bug=1024998;mbox=yes;msg=30), [link](#29)).

---

**Acknowledgement sent**
to `Stephen Kitt <skitt@debian.org>`:

Extra info received and forwarded to list.
(Wed, 30 Nov 2022 07:30:07 GMT) ([full text](bugreport.cgi?bug=1024998;msg=32), [mbox](bugreport.cgi?bug=1024998;mbox=yes;msg=32), [link](#31)).

---

[Message #33](#33) received at 1024998@bugs.debian.org ([full text](bugreport.cgi?bug=1024998;msg=33), [mbox](bugreport.cgi?bug=1024998;mbox=yes;msg=33), reply):

![](/cgi-bin/libravatar.cgi?email=skitt%40debian.org)
From: Stephen Kitt <skitt@debian.org>
To: Salvatore Bonaccorso <carnil@debian.org>
Cc: 1024998@bugs.debian.org, Xavi Drudis Ferran <xdrudis@tinet.cat>, Debian
Security Team <team@security.debian.org>
Subject: Re: Bug#1024998: g810-led: Security risk: Leaves /dev/input/event\*
with read and write permissions for all users
Date: Wed, 30 Nov 2022 08:26:46 +0100
```
[[Message part 1](bugreport.cgi?att=0;bug=1024998;msg=33) (text/plain, inline)]
```
```
On Wed, 30 Nov 2022 06:59:41 +0100, Salvatore Bonaccorso <carnil@debian.org>
wrote:
> The issue got [CVE-2022-46338](https://security-tracker.debian.org/tracker/CVE-2022-46338) assigned by MITRE.
>
> Stephen, the issue is marked no-dsa for bullseye, but a fix might go
> still trough the upcoming point release (scheduled for 17th december).

Thanks, I’ll submit a stable update.

Regards,

Stephen

```
```
[[Message part 2](bugreport.cgi?att=1;bug=1024998;msg=33) (application/pgp-signature, inline)]
```

---

**Marked as found in versions g810-led/0.3.3-2.**
Request was from `Stephen Kitt <skitt@debian.org>`
to `control@bugs.debian.org`.
(Wed, 07 Dec 2022 22:21:05 GMT) ([full text](bugreport.cgi?bug=1024998;msg=35), [mbox](bugreport.cgi?bug=1024998;mbox=yes;msg=35), [link](#34)).

---

**Marked as fixed in versions 0.3.3-2+deb10u1.**
Request was from `Stephen Kitt <skitt@debian.org>`
to `control@bugs.debian.org`.
(Wed, 07 Dec 2022 22:21:06 GMT) ([full text](bugreport.cgi?bug=1024998;msg=37), [mbox](bugreport.cgi?bug=1024998;mbox=yes;msg=37), [link](#36)).

---

**Reply sent**
to `Stephen Kitt <skitt@debian.org>`:

You have taken responsibility.
(Fri, 09 Dec 2022 19:57:12 GMT) ([full text](bugreport.cgi?bug=1024998;msg=39), [mbox](bugreport.cgi?bug=1024998;mbox=yes;msg=39), [link](#38)).

---

**Notification sent**
to `Xavi Drudis Ferran <xdrudis@tinet.cat>`:

Bug acknowledged by developer.
(Fri, 09 Dec 2022 19:57:12 GMT) ([full text](bugreport.cgi?bug=1024998;msg=41), [mbox](bugreport.cgi?bug=1024998;mbox=yes;msg=41), [link](#40)).

---

[Message #42](#42) received at 1024998-close@bugs.debian.org ([full text](bugreport.cgi?bug=1024998;msg=42), [mbox](bugreport.cgi?bug=1024998;mbox=yes;msg=42), reply):

![](/cgi-bin/libravatar.cgi?email=ftpmaster%40ftp-master.debian.org)
From: Debian FTP Masters <ftpmaster@ftp-master.debian.org>
To: 1024998-close@bugs.debian.org
Subject: Bug#1024998: fixed in g810-led 0.4.2-1+deb11u1
Date: Fri, 09 Dec 2022 19:52:58 +0000
```
Source: g810-led
Source-Version: 0.4.2-1+deb11u1
Done: Stephen Kitt <skitt@debian.org>

We believe that the bug you reported is fixed in the latest version of
g810-led, which is due to be installed in the Debian FTP archive.

A summary of the changes between this version and the previous one is
attached.

Thank you for reporting the bug, which will now be closed.  If you
have further comments please address them to 1024998@bugs.debian.org,
and the maintainer will reopen the bug report if appropriate.

Debian distribution maintenance software
pp.
Stephen Kitt <skitt@debian.org> (supplier of updated g810-led package)

(This message was generated automatically at their request; if you
believe that there is a problem with it please contact the archive
administrators by mailing ftpmaster@ftp-master.debian.org)

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

Format: 1.8
Date: Wed, 30 Nov 2022 08:24:25 +0100
Source: g810-led
Architecture: source
Version: 0.4.2-1+deb11u1
Distribution: bullseye
Urgency: medium
Maintainer: Stephen Kitt <skitt@debian.org>
Changed-By: Stephen Kitt <skitt@debian.org>
Closes: [1024998](bugreport.cgi?bug=1024998)
Changes:
 g810-led (0.4.2-1+deb11u1) bullseye; urgency=medium
 .
   * Control device access with uaccess instead of making everything
     world-writable. Thanks to Xavi Drudis Ferran for the report!
     Closes:#[1024998](bugreport.cgi?bug=1024998). ([CVE-2022-46338](https://security-tracker.debian.org/tracker/CVE-2022-46338).)
Checksums-Sha1:
 324e8f67c0fb0559b96828aafac5010effff1ecf 1985 g810-led_0.4.2-1+deb11u1.dsc
 1a1c31f63d9811064cd22decbad1a58017bc81ac 5940 g810-led_0.4.2-1+deb11u1.debian.tar.xz
 10211d53d2724742bcf27d7dfa0cb9ab707613a5 6512 g810-led_0.4.2-1+deb11u1_source.buildinfo
Checksums-Sha256:
 e3a9c3c83954f4a2d5653619b79871e34d71a7bfc9f6e11e3136f5aa0408d5af 1985 g810-led_0.4.2-1+deb11u1.dsc
 8641a1d6d7babbd866ed8b25c285b1a5e62f7ae794584c1422df2619e89bf697 5940 g810-led_0.4.2-1+deb11u1.debian.tar.xz
 c93b42b926823a1aee0590886c8f81f2b6f6671f3360c3a66ead284c4027901c 6512 g810-led_0.4.2-1+deb11u1_source.buildinfo
Files:
 b0c2e7f9a689447f03dcd2f691692ca7 1985 utils optional g810-led_0.4.2-1+deb11u1.dsc
 945a484164d2b38052d360beb94336ce 5940 utils optional g810-led_0.4.2-1+deb11u1.debian.tar.xz
 8f4e98b9c7ecfba6bb0019e7119faa73 6512 utils optional g810-led_0.4.2-1+deb11u1_source.buildinfo

-----BEGIN PGP SIGNATURE-----

iQIzBAEBCgAdFiEEnPVX/hPLkMoq7x0ggNMC9Yhtg5wFAmOHBY4ACgkQgNMC9Yht
g5zFMxAAnlvMZoC5pVTjeNM/dthXrpNetQWjP9SoeTnCvsbNwiaXy/4QxdBMM3uH
MDkkEOeK2K4Z1txEKLsW6AKwDiHQhG3YHVS6O+GXODPQN80Ubul1gxjsJdW26LST
hAvKA7mOQTb6yUeD4x101zdtxLT79jLUPY6n8Wd7hEZYKjGH87Ofmbh2CElX4wuO
Ge9jNbu/kkiZ0lJ8ReewUcABqADRNuuX0oio1Y1yzS548en8+ssOQv72QFfkfMCn
iTmP0W+2RlTO6ZDtCk52Evo8PAOIvjs71ILgYHqBsBcjbdlYPrCOTxv1vesJ1CL/
qEWTYcWMoxkqGTXnrgCRuF5sVmwrde4eWCjATv1y8eEsvw52rGB97/ak9FWp0eIs
Ft61l/mqs+gDGtZ+FTUII/Wtu3LSkxa7wrUW0o8E0s9++oN3HHUrWgARojaS7/jO
Sf4q2dVRzyYCh+JeJue3UHL0F3H6Vm3WpOwyNIs1WQngBa/ZiInMekK+DolbYcP0
pAC2xmOnrNY06FXbgipFUkfGTuVoUCNn+oZn8oAduA0ybualGWkaga9tTAw5OFRJ
roBOL3jSdZ8BsQDZ2+KKtAjYn5okOhbrV95uykkloqXltY8vMLv5UXs3oNRBHF+6
tVZ7F+9Z8D+xorDsHEyoNUqWEKS4noTfwrrEvTOL3H1EqthndMA=
=YO1Q
-----END PGP SIGNATURE-----

```

---

**Bug archived.**
Request was from `Debbugs Internal Request <owner@bugs.debian.org>`
to `internal_control@bugs.debian.org`.
(Sat, 07 Jan 2023 07:30:31 GMT) ([full text](bugreport.cgi?bug=1024998;msg=44), [mbox](bugreport.cgi?bug=1024998;mbox=yes;msg=44), [link](#43)).

---

Send a report that [this bug log contains spam](https://bugs.debian.org/cgi-bin/bugspam.cgi?bug=1024998).

---

Debian bug tracking system administrator <owner@bugs.debian.org>.
Last modified:
Wed Jan 8 11:07:25 2025;
Machine Name:
bembo

[Debian Bug tracking system](https://www.debian.org/Bugs/)

Debbugs is free software and licensed under the terms of the GNU General
Public License version 2. The current version can be obtained
from <https://bugs.debian.org/debbugs-source/>.

Copyright © 1999 Darren O. Benham,
1997,2003 nCipher Corporation Ltd,
1994-97 Ian Jackson,
2005-2017 Don Armstrong, and many other contributors.

