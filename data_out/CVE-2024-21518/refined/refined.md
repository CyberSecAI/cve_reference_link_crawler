- **Root cause of vulnerability**: Improper sanitization of the target path during archive extraction within the marketplace installer. This allows files within a malicious archive to traverse the filesystem and be extracted to arbitrary locations.
- **Weaknesses/vulnerabilities present**: Zip Slip vulnerability, which allows writing files to arbitrary locations due to insufficient path sanitization during archive extraction.
- **Impact of exploitation**: An attacker can create arbitrary files in the web root of the application, overwrite existing files, and potentially achieve remote code execution.
- **Attack vectors**: The attacker uploads a malicious zip archive through the marketplace installer. This is achieved by exploiting a reflected XSS vulnerability in the admin panel to inject JavaScript which will automatically upload and install the malicious extension zip.
- **Required attacker capabilities/position**:
    - The attacker needs to exploit an XSS vulnerability in the admin panel.
    - The attacker needs to craft a malicious zip file to be uploaded.
    - The attacker needs to know a valid user token.
    - The attacker needs network access to the vulnerable application.