- **Root cause of vulnerability:** A stack-based buffer overflow in the `decodePwd` function.
- **Weaknesses/vulnerabilities present:** The `decodePwd` function copies data from a user-controlled input (`PPPOEPassword`) into a fixed-size buffer (`v52`). It does not perform adequate bounds checking, leading to a buffer overflow if the user-supplied password exceeds the buffer's capacity.
- **Impact of exploitation:** A successful exploit can lead to arbitrary code execution on the affected device, potentially giving an attacker full control of the router.
- **Attack vectors:** A malicious actor sends a crafted POST request to the `/goform/AdvSetWan` endpoint. The request includes the `wanmode` parameter set to "2" and an excessively long `PPPOEPassword` parameter.
- **Required attacker capabilities/position:** The attacker needs to be able to send HTTP POST requests to the router. This could be achieved through a network connected to the router, either directly or remotely if the router's web interface is exposed to the internet or if the attacker has already compromised another device on the LAN.