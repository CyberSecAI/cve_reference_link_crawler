- **Root cause of vulnerability:** The TP-Link router model TL-7DR5130 with firmware version 1.0.23 improperly verifies the source of ICMP redirect messages, making it vulnerable to forged ICMP redirect attacks.
- **Weaknesses/vulnerabilities present:** The router does not properly validate the source of ICMP redirect messages, allowing an attacker to send forged messages that can alter a victim's routing table. This is categorized as CWE-940: Improper Verification of Source of a Communication Channel.
- **Impact of exploitation:** An attacker can hijack the traffic between a victim and any remote server by sending forged ICMP redirect messages. This allows the attacker to perform man-in-the-middle attacks, sniffing and potentially manipulating traffic.
- **Attack vectors:** The attacker must be on the same WLAN network as the victim. The attack involves sending forged ICMP redirect messages through the router to the victim.
- **Required attacker capabilities/position:** The attacker needs to be on the same WLAN as the victim and have the ability to send network packets, typically using a tool like Scapy. Additionally, the victim's machine needs to be configured to accept ICMP redirects, which is the default behavior on many Linux systems.